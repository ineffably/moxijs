(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("pixi.js"));
	else if(typeof define === 'function' && define.amd)
		define(["pixi.js"], factory);
	else if(typeof exports === 'object')
		exports["moxi"] = factory(require("pixi.js"));
	else
		root["moxi"] = factory(root["PIXI"]);
})(self, (__WEBPACK_EXTERNAL_MODULE_pixi_js__) => {
return /******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js":
/*!**************************************************************************!*\
  !*** ../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js ***!
  \**************************************************************************/
/***/ ((module) => {

/* Font Face Observer v2.3.0 - Â© Bram Stein. License: BSD-3-Clause */(function(){function p(a,c){document.addEventListener?a.addEventListener("scroll",c,!1):a.attachEvent("scroll",c)}function u(a){document.body?a():document.addEventListener?document.addEventListener("DOMContentLoaded",function b(){document.removeEventListener("DOMContentLoaded",b);a()}):document.attachEvent("onreadystatechange",function g(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",g),a()})};function w(a){this.g=document.createElement("div");this.g.setAttribute("aria-hidden","true");this.g.appendChild(document.createTextNode(a));this.h=document.createElement("span");this.i=document.createElement("span");this.m=document.createElement("span");this.j=document.createElement("span");this.l=-1;this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.h.appendChild(this.m);this.i.appendChild(this.j);this.g.appendChild(this.h);this.g.appendChild(this.i)}
function x(a,c){a.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+c+";"}function B(a){var c=a.g.offsetWidth,b=c+100;a.j.style.width=b+"px";a.i.scrollLeft=b;a.h.scrollLeft=a.h.scrollWidth+100;return a.l!==c?(a.l=c,!0):!1}function C(a,c){function b(){var e=g;B(e)&&null!==e.g.parentNode&&c(e.l)}var g=a;p(a.h,b);p(a.i,b);B(a)};function D(a,c,b){c=c||{};b=b||window;this.family=a;this.style=c.style||"normal";this.weight=c.weight||"normal";this.stretch=c.stretch||"normal";this.context=b}var E=null,F=null,G=null,H=null;function I(a){null===F&&(M(a)&&/Apple/.test(window.navigator.vendor)?(a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),F=!!a&&603>parseInt(a[1],10)):F=!1);return F}function M(a){null===H&&(H=!!a.document.fonts);return H}
function N(a,c){var b=a.style,g=a.weight;if(null===G){var e=document.createElement("div");try{e.style.font="condensed 100px sans-serif"}catch(q){}G=""!==e.style.font}return[b,g,G?a.stretch:"","100px",c].join(" ")}
D.prototype.load=function(a,c){var b=this,g=a||"BESbswy",e=0,q=c||3E3,J=(new Date).getTime();return new Promise(function(K,L){if(M(b.context)&&!I(b.context)){var O=new Promise(function(r,t){function h(){(new Date).getTime()-J>=q?t(Error(""+q+"ms timeout exceeded")):b.context.document.fonts.load(N(b,'"'+b.family+'"'),g).then(function(n){1<=n.length?r():setTimeout(h,25)},t)}h()}),P=new Promise(function(r,t){e=setTimeout(function(){t(Error(""+q+"ms timeout exceeded"))},q)});Promise.race([P,O]).then(function(){clearTimeout(e);
K(b)},L)}else u(function(){function r(){var d;if(d=-1!=k&&-1!=l||-1!=k&&-1!=m||-1!=l&&-1!=m)(d=k!=l&&k!=m&&l!=m)||(null===E&&(d=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),E=!!d&&(536>parseInt(d[1],10)||536===parseInt(d[1],10)&&11>=parseInt(d[2],10))),d=E&&(k==y&&l==y&&m==y||k==z&&l==z&&m==z||k==A&&l==A&&m==A)),d=!d;d&&(null!==f.parentNode&&f.parentNode.removeChild(f),clearTimeout(e),K(b))}function t(){if((new Date).getTime()-J>=q)null!==f.parentNode&&f.parentNode.removeChild(f),
L(Error(""+q+"ms timeout exceeded"));else{var d=b.context.document.hidden;if(!0===d||void 0===d)k=h.g.offsetWidth,l=n.g.offsetWidth,m=v.g.offsetWidth,r();e=setTimeout(t,50)}}var h=new w(g),n=new w(g),v=new w(g),k=-1,l=-1,m=-1,y=-1,z=-1,A=-1,f=document.createElement("div");f.dir="ltr";x(h,N(b,"sans-serif"));x(n,N(b,"serif"));x(v,N(b,"monospace"));f.appendChild(h.g);f.appendChild(n.g);f.appendChild(v.g);b.context.document.body.appendChild(f);y=h.g.offsetWidth;z=n.g.offsetWidth;A=v.g.offsetWidth;t();
C(h,function(d){k=d;r()});x(h,N(b,'"'+b.family+'",sans-serif'));C(n,function(d){l=d;r()});x(n,N(b,'"'+b.family+'",serif'));C(v,function(d){m=d;r()});x(v,N(b,'"'+b.family+'",monospace'))})})}; true?module.exports=D:(0);}());


/***/ }),

/***/ "../../node_modules/planck/dist/planck.js":
/*!************************************************!*\
  !*** ../../node_modules/planck/dist/planck.js ***!
  \************************************************/
/***/ (function(__unused_webpack_module, exports) {

(function(global, factory) {
   true ? factory(exports) : 0;
})(this, function(exports2) {
  "use strict";/**
 * Planck.js v1.4.2
 * @license The MIT license
 * @copyright Copyright (c) 2025 Erin Catto, Ali Shakiba
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

  /*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */
  var extendStatics = function(d2, b2) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d3, b3) {
      d3.__proto__ = b3;
    } || function(d3, b3) {
      for (var p in b3) if (Object.prototype.hasOwnProperty.call(b3, p)) d3[p] = b3[p];
    };
    return extendStatics(d2, b2);
  };
  function __extends(d2, b2) {
    if (typeof b2 !== "function" && b2 !== null)
      throw new TypeError("Class extends value " + String(b2) + " is not a constructor or null");
    extendStatics(d2, b2);
    function __() {
      this.constructor = d2;
    }
    d2.prototype = b2 === null ? Object.create(b2) : (__.prototype = b2.prototype, new __());
  }
  var __assign = function() {
    __assign = Object.assign || function __assign2(t) {
      for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
        s2 = arguments[i];
        for (var p in s2) if (Object.prototype.hasOwnProperty.call(s2, p)) t[p] = s2[p];
      }
      return t;
    };
    return __assign.apply(this, arguments);
  };
  var options = function(input2, defaults) {
    if (input2 === null || typeof input2 === "undefined") {
      input2 = {};
    }
    var output2 = __assign({}, input2);
    for (var key in defaults) {
      if (defaults.hasOwnProperty(key) && typeof input2[key] === "undefined") {
        output2[key] = defaults[key];
      }
    }
    if (typeof Object.getOwnPropertySymbols === "function") {
      var symbols = Object.getOwnPropertySymbols(defaults);
      for (var i = 0; i < symbols.length; i++) {
        var symbol = symbols[i];
        if (defaults.propertyIsEnumerable(symbol) && typeof input2[symbol] === "undefined") {
          output2[symbol] = defaults[symbol];
        }
      }
    }
    return output2;
  };
  var math_random = Math.random;
  var EPSILON = 1e-9;
  var isFinite = Number.isFinite;
  function nextPowerOfTwo(x2) {
    x2 |= x2 >> 1;
    x2 |= x2 >> 2;
    x2 |= x2 >> 4;
    x2 |= x2 >> 8;
    x2 |= x2 >> 16;
    return x2 + 1;
  }
  function isPowerOfTwo(x2) {
    return x2 > 0 && (x2 & x2 - 1) === 0;
  }
  function mod(num, min, max) {
    if (typeof min === "undefined") {
      max = 1;
      min = 0;
    } else if (typeof max === "undefined") {
      max = min;
      min = 0;
    }
    if (max > min) {
      num = (num - min) % (max - min);
      return num + (num < 0 ? max : min);
    } else {
      num = (num - max) % (min - max);
      return num + (num <= 0 ? min : max);
    }
  }
  function clamp(num, min, max) {
    if (num < min) {
      return min;
    } else if (num > max) {
      return max;
    } else {
      return num;
    }
  }
  function random(min, max) {
    if (typeof min === "undefined") {
      max = 1;
      min = 0;
    } else if (typeof max === "undefined") {
      max = min;
      min = 0;
    }
    return min === max ? min : math_random() * (max - min) + min;
  }
  var math = Object.create(Math);
  math.EPSILON = EPSILON;
  math.isFinite = isFinite;
  math.nextPowerOfTwo = nextPowerOfTwo;
  math.isPowerOfTwo = isPowerOfTwo;
  math.mod = mod;
  math.clamp = clamp;
  math.random = random;
  var math_abs$9 = Math.abs;
  var math_sqrt$5 = Math.sqrt;
  var math_max$8 = Math.max;
  var math_min$8 = Math.min;
  var Vec2 = (
    /** @class */
    function() {
      function Vec22(x2, y) {
        if (!(this instanceof Vec22)) {
          return new Vec22(x2, y);
        }
        if (typeof x2 === "undefined") {
          this.x = 0;
          this.y = 0;
        } else if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
        } else {
          this.x = x2;
          this.y = y;
        }
      }
      Vec22.prototype._serialize = function() {
        return {
          x: this.x,
          y: this.y
        };
      };
      Vec22._deserialize = function(data) {
        var obj = Object.create(Vec22.prototype);
        obj.x = data.x;
        obj.y = data.y;
        return obj;
      };
      Vec22.zero = function() {
        var obj = Object.create(Vec22.prototype);
        obj.x = 0;
        obj.y = 0;
        return obj;
      };
      Vec22.neo = function(x2, y) {
        var obj = Object.create(Vec22.prototype);
        obj.x = x2;
        obj.y = y;
        return obj;
      };
      Vec22.clone = function(v3) {
        return Vec22.neo(v3.x, v3.y);
      };
      Vec22.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Vec22.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.x) && Number.isFinite(obj.y);
      };
      Vec22.assert = function(o) {
      };
      Vec22.prototype.clone = function() {
        return Vec22.clone(this);
      };
      Vec22.prototype.setZero = function() {
        this.x = 0;
        this.y = 0;
        return this;
      };
      Vec22.prototype.set = function(x2, y) {
        if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
        } else {
          this.x = x2;
          this.y = y;
        }
        return this;
      };
      Vec22.prototype.setNum = function(x2, y) {
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.setVec2 = function(value) {
        this.x = value.x;
        this.y = value.y;
        return this;
      };
      Vec22.prototype.wSet = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.setCombine(a2, v3, b2, w);
        } else {
          return this.setMul(a2, v3);
        }
      };
      Vec22.prototype.setCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.setMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.add = function(w) {
        this.x += w.x;
        this.y += w.y;
        return this;
      };
      Vec22.prototype.wAdd = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.addCombine(a2, v3, b2, w);
        } else {
          return this.addMul(a2, v3);
        }
      };
      Vec22.prototype.addCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x += x2;
        this.y += y;
        return this;
      };
      Vec22.prototype.addMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x += x2;
        this.y += y;
        return this;
      };
      Vec22.prototype.wSub = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.subCombine(a2, v3, b2, w);
        } else {
          return this.subMul(a2, v3);
        }
      };
      Vec22.prototype.subCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x -= x2;
        this.y -= y;
        return this;
      };
      Vec22.prototype.subMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x -= x2;
        this.y -= y;
        return this;
      };
      Vec22.prototype.sub = function(w) {
        this.x -= w.x;
        this.y -= w.y;
        return this;
      };
      Vec22.prototype.mul = function(m) {
        this.x *= m;
        this.y *= m;
        return this;
      };
      Vec22.prototype.length = function() {
        return Vec22.lengthOf(this);
      };
      Vec22.prototype.lengthSquared = function() {
        return Vec22.lengthSquared(this);
      };
      Vec22.prototype.normalize = function() {
        var length = this.length();
        if (length < EPSILON) {
          return 0;
        }
        var invLength = 1 / length;
        this.x *= invLength;
        this.y *= invLength;
        return length;
      };
      Vec22.normalize = function(v3) {
        var length = Vec22.lengthOf(v3);
        if (length < EPSILON) {
          return Vec22.zero();
        }
        var invLength = 1 / length;
        return Vec22.neo(v3.x * invLength, v3.y * invLength);
      };
      Vec22.lengthOf = function(v3) {
        return math_sqrt$5(v3.x * v3.x + v3.y * v3.y);
      };
      Vec22.lengthSquared = function(v3) {
        return v3.x * v3.x + v3.y * v3.y;
      };
      Vec22.distance = function(v3, w) {
        var dx = v3.x - w.x;
        var dy = v3.y - w.y;
        return math_sqrt$5(dx * dx + dy * dy);
      };
      Vec22.distanceSquared = function(v3, w) {
        var dx = v3.x - w.x;
        var dy = v3.y - w.y;
        return dx * dx + dy * dy;
      };
      Vec22.areEqual = function(v3, w) {
        return v3 === w || typeof w === "object" && w !== null && v3.x === w.x && v3.y === w.y;
      };
      Vec22.skew = function(v3) {
        return Vec22.neo(-v3.y, v3.x);
      };
      Vec22.dot = function(v3, w) {
        return v3.x * w.x + v3.y * w.y;
      };
      Vec22.cross = function(v3, w) {
        if (typeof w === "number") {
          return Vec22.neo(w * v3.y, -w * v3.x);
        } else if (typeof v3 === "number") {
          return Vec22.neo(-v3 * w.y, v3 * w.x);
        } else {
          return v3.x * w.y - v3.y * w.x;
        }
      };
      Vec22.crossVec2Vec2 = function(v3, w) {
        return v3.x * w.y - v3.y * w.x;
      };
      Vec22.crossVec2Num = function(v3, w) {
        return Vec22.neo(w * v3.y, -w * v3.x);
      };
      Vec22.crossNumVec2 = function(v3, w) {
        return Vec22.neo(-v3 * w.y, v3 * w.x);
      };
      Vec22.addCross = function(a2, v3, w) {
        if (typeof w === "number") {
          return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);
        } else if (typeof v3 === "number") {
          return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);
        }
      };
      Vec22.addCrossVec2Num = function(a2, v3, w) {
        return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);
      };
      Vec22.addCrossNumVec2 = function(a2, v3, w) {
        return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);
      };
      Vec22.add = function(v3, w) {
        return Vec22.neo(v3.x + w.x, v3.y + w.y);
      };
      Vec22.wAdd = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return Vec22.combine(a2, v3, b2, w);
        } else {
          return Vec22.mulNumVec2(a2, v3);
        }
      };
      Vec22.combine = function(a2, v3, b2, w) {
        return Vec22.zero().setCombine(a2, v3, b2, w);
      };
      Vec22.sub = function(v3, w) {
        return Vec22.neo(v3.x - w.x, v3.y - w.y);
      };
      Vec22.mul = function(a2, b2) {
        if (typeof a2 === "object") {
          return Vec22.neo(a2.x * b2, a2.y * b2);
        } else if (typeof b2 === "object") {
          return Vec22.neo(a2 * b2.x, a2 * b2.y);
        }
      };
      Vec22.mulVec2Num = function(a2, b2) {
        return Vec22.neo(a2.x * b2, a2.y * b2);
      };
      Vec22.mulNumVec2 = function(a2, b2) {
        return Vec22.neo(a2 * b2.x, a2 * b2.y);
      };
      Vec22.prototype.neg = function() {
        this.x = -this.x;
        this.y = -this.y;
        return this;
      };
      Vec22.neg = function(v3) {
        return Vec22.neo(-v3.x, -v3.y);
      };
      Vec22.abs = function(v3) {
        return Vec22.neo(math_abs$9(v3.x), math_abs$9(v3.y));
      };
      Vec22.mid = function(v3, w) {
        return Vec22.neo((v3.x + w.x) * 0.5, (v3.y + w.y) * 0.5);
      };
      Vec22.upper = function(v3, w) {
        return Vec22.neo(math_max$8(v3.x, w.x), math_max$8(v3.y, w.y));
      };
      Vec22.lower = function(v3, w) {
        return Vec22.neo(math_min$8(v3.x, w.x), math_min$8(v3.y, w.y));
      };
      Vec22.prototype.clamp = function(max) {
        var lengthSqr = this.x * this.x + this.y * this.y;
        if (lengthSqr > max * max) {
          var scale = max / math_sqrt$5(lengthSqr);
          this.x *= scale;
          this.y *= scale;
        }
        return this;
      };
      Vec22.clamp = function(v3, max) {
        var r = Vec22.neo(v3.x, v3.y);
        r.clamp(max);
        return r;
      };
      Vec22.clampVec2 = function(v3, min, max) {
        return {
          x: clamp(v3.x, min === null || min === void 0 ? void 0 : min.x, max === null || max === void 0 ? void 0 : max.x),
          y: clamp(v3.y, min === null || min === void 0 ? void 0 : min.y, max === null || max === void 0 ? void 0 : max.y)
        };
      };
      Vec22.scaleFn = function(x2, y) {
        return function(v3) {
          return Vec22.neo(v3.x * x2, v3.y * y);
        };
      };
      Vec22.translateFn = function(x2, y) {
        return function(v3) {
          return Vec22.neo(v3.x + x2, v3.y + y);
        };
      };
      return Vec22;
    }()
  );
  var math_max$7 = Math.max;
  var math_min$7 = Math.min;
  var AABB = (
    /** @class */
    function() {
      function AABB2(lower, upper) {
        if (!(this instanceof AABB2)) {
          return new AABB2(lower, upper);
        }
        this.lowerBound = Vec2.zero();
        this.upperBound = Vec2.zero();
        if (typeof lower === "object") {
          this.lowerBound.setVec2(lower);
        }
        if (typeof upper === "object") {
          this.upperBound.setVec2(upper);
        } else if (typeof lower === "object") {
          this.upperBound.setVec2(lower);
        }
      }
      AABB2.prototype.isValid = function() {
        return AABB2.isValid(this);
      };
      AABB2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.lowerBound) && Vec2.isValid(obj.upperBound) && Vec2.sub(obj.upperBound, obj.lowerBound).lengthSquared() >= 0;
      };
      AABB2.assert = function(o) {
      };
      AABB2.prototype.getCenter = function() {
        return Vec2.neo((this.lowerBound.x + this.upperBound.x) * 0.5, (this.lowerBound.y + this.upperBound.y) * 0.5);
      };
      AABB2.prototype.getExtents = function() {
        return Vec2.neo((this.upperBound.x - this.lowerBound.x) * 0.5, (this.upperBound.y - this.lowerBound.y) * 0.5);
      };
      AABB2.prototype.getPerimeter = function() {
        return 2 * (this.upperBound.x - this.lowerBound.x + this.upperBound.y - this.lowerBound.y);
      };
      AABB2.prototype.combine = function(a2, b2) {
        b2 = b2 || this;
        var lowerA = a2.lowerBound;
        var upperA = a2.upperBound;
        var lowerB = b2.lowerBound;
        var upperB = b2.upperBound;
        var lowerX = math_min$7(lowerA.x, lowerB.x);
        var lowerY = math_min$7(lowerA.y, lowerB.y);
        var upperX = math_max$7(upperB.x, upperA.x);
        var upperY = math_max$7(upperB.y, upperA.y);
        this.lowerBound.setNum(lowerX, lowerY);
        this.upperBound.setNum(upperX, upperY);
      };
      AABB2.prototype.combinePoints = function(a2, b2) {
        this.lowerBound.setNum(math_min$7(a2.x, b2.x), math_min$7(a2.y, b2.y));
        this.upperBound.setNum(math_max$7(a2.x, b2.x), math_max$7(a2.y, b2.y));
      };
      AABB2.prototype.set = function(aabb) {
        this.lowerBound.setNum(aabb.lowerBound.x, aabb.lowerBound.y);
        this.upperBound.setNum(aabb.upperBound.x, aabb.upperBound.y);
      };
      AABB2.prototype.contains = function(aabb) {
        var result = true;
        result = result && this.lowerBound.x <= aabb.lowerBound.x;
        result = result && this.lowerBound.y <= aabb.lowerBound.y;
        result = result && aabb.upperBound.x <= this.upperBound.x;
        result = result && aabb.upperBound.y <= this.upperBound.y;
        return result;
      };
      AABB2.prototype.extend = function(value) {
        AABB2.extend(this, value);
        return this;
      };
      AABB2.extend = function(out, value) {
        out.lowerBound.x -= value;
        out.lowerBound.y -= value;
        out.upperBound.x += value;
        out.upperBound.y += value;
        return out;
      };
      AABB2.testOverlap = function(a2, b2) {
        var d1x = b2.lowerBound.x - a2.upperBound.x;
        var d2x = a2.lowerBound.x - b2.upperBound.x;
        var d1y = b2.lowerBound.y - a2.upperBound.y;
        var d2y = a2.lowerBound.y - b2.upperBound.y;
        if (d1x > 0 || d1y > 0 || d2x > 0 || d2y > 0) {
          return false;
        }
        return true;
      };
      AABB2.areEqual = function(a2, b2) {
        return Vec2.areEqual(a2.lowerBound, b2.lowerBound) && Vec2.areEqual(a2.upperBound, b2.upperBound);
      };
      AABB2.diff = function(a2, b2) {
        var wD = math_max$7(0, math_min$7(a2.upperBound.x, b2.upperBound.x) - math_max$7(b2.lowerBound.x, a2.lowerBound.x));
        var hD = math_max$7(0, math_min$7(a2.upperBound.y, b2.upperBound.y) - math_max$7(b2.lowerBound.y, a2.lowerBound.y));
        var wA = a2.upperBound.x - a2.lowerBound.x;
        var hA = a2.upperBound.y - a2.lowerBound.y;
        var wB = b2.upperBound.x - b2.lowerBound.x;
        var hB = b2.upperBound.y - b2.lowerBound.y;
        return wA * hA + wB * hB - wD * hD;
      };
      AABB2.prototype.rayCast = function(output2, input2) {
        var tmin = -Infinity;
        var tmax = Infinity;
        var p = input2.p1;
        var d2 = Vec2.sub(input2.p2, input2.p1);
        var absD = Vec2.abs(d2);
        var normal3 = Vec2.zero();
        {
          if (absD.x < EPSILON) {
            if (p.x < this.lowerBound.x || this.upperBound.x < p.x) {
              return false;
            }
          } else {
            var inv_d = 1 / d2.x;
            var t1 = (this.lowerBound.x - p.x) * inv_d;
            var t2 = (this.upperBound.x - p.x) * inv_d;
            var s2 = -1;
            if (t1 > t2) {
              var temp3 = t1;
              t1 = t2;
              t2 = temp3;
              s2 = 1;
            }
            if (t1 > tmin) {
              normal3.setZero();
              normal3.x = s2;
              tmin = t1;
            }
            tmax = math_min$7(tmax, t2);
            if (tmin > tmax) {
              return false;
            }
          }
        }
        {
          if (absD.y < EPSILON) {
            if (p.y < this.lowerBound.y || this.upperBound.y < p.y) {
              return false;
            }
          } else {
            var inv_d = 1 / d2.y;
            var t1 = (this.lowerBound.y - p.y) * inv_d;
            var t2 = (this.upperBound.y - p.y) * inv_d;
            var s2 = -1;
            if (t1 > t2) {
              var temp3 = t1;
              t1 = t2;
              t2 = temp3;
              s2 = 1;
            }
            if (t1 > tmin) {
              normal3.setZero();
              normal3.y = s2;
              tmin = t1;
            }
            tmax = math_min$7(tmax, t2);
            if (tmin > tmax) {
              return false;
            }
          }
        }
        if (tmin < 0 || input2.maxFraction < tmin) {
          return false;
        }
        output2.fraction = tmin;
        output2.normal = normal3;
        return true;
      };
      AABB2.prototype.toString = function() {
        return JSON.stringify(this);
      };
      AABB2.combinePoints = function(out, a2, b2) {
        out.lowerBound.x = math_min$7(a2.x, b2.x);
        out.lowerBound.y = math_min$7(a2.y, b2.y);
        out.upperBound.x = math_max$7(a2.x, b2.x);
        out.upperBound.y = math_max$7(a2.y, b2.y);
        return out;
      };
      AABB2.combinedPerimeter = function(a2, b2) {
        var lx = math_min$7(a2.lowerBound.x, b2.lowerBound.x);
        var ly = math_min$7(a2.lowerBound.y, b2.lowerBound.y);
        var ux = math_max$7(a2.upperBound.x, b2.upperBound.x);
        var uy = math_max$7(a2.upperBound.y, b2.upperBound.y);
        return 2 * (ux - lx + uy - ly);
      };
      return AABB2;
    }()
  );
  var math_PI$6 = Math.PI;
  var Settings = (
    /** @class */
    function() {
      function Settings2() {
      }
      Object.defineProperty(Settings2, "polygonRadius", {
        /**
         * The radius of the polygon/edge shape skin. This should not be modified.
         * Making this smaller means polygons will have an insufficient buffer for
         * continuous collision. Making it larger may create artifacts for vertex
         * collision.
         */
        get: function() {
          return 2 * Settings2.linearSlop;
        },
        enumerable: false,
        configurable: true
      });
      Settings2.lengthUnitsPerMeter = 1;
      Settings2.maxManifoldPoints = 2;
      Settings2.maxPolygonVertices = 12;
      Settings2.aabbExtension = 0.1;
      Settings2.aabbMultiplier = 2;
      Settings2.linearSlop = 5e-3;
      Settings2.angularSlop = 2 / 180 * math_PI$6;
      Settings2.maxSubSteps = 8;
      Settings2.maxTOIContacts = 32;
      Settings2.maxTOIIterations = 20;
      Settings2.maxDistanceIterations = 20;
      Settings2.velocityThreshold = 1;
      Settings2.maxLinearCorrection = 0.2;
      Settings2.maxAngularCorrection = 8 / 180 * math_PI$6;
      Settings2.maxTranslation = 2;
      Settings2.maxRotation = 0.5 * math_PI$6;
      Settings2.baumgarte = 0.2;
      Settings2.toiBaugarte = 0.75;
      Settings2.timeToSleep = 0.5;
      Settings2.linearSleepTolerance = 0.01;
      Settings2.angularSleepTolerance = 2 / 180 * math_PI$6;
      return Settings2;
    }()
  );
  var SettingsInternal = (
    /** @class */
    function() {
      function SettingsInternal2() {
      }
      Object.defineProperty(SettingsInternal2, "maxManifoldPoints", {
        get: function() {
          return Settings.maxManifoldPoints;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxPolygonVertices", {
        get: function() {
          return Settings.maxPolygonVertices;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "aabbExtension", {
        get: function() {
          return Settings.aabbExtension * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "aabbMultiplier", {
        get: function() {
          return Settings.aabbMultiplier;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSlop", {
        get: function() {
          return Settings.linearSlop * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSlopSquared", {
        get: function() {
          return Settings.linearSlop * Settings.lengthUnitsPerMeter * Settings.linearSlop * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSlop", {
        get: function() {
          return Settings.angularSlop;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "polygonRadius", {
        get: function() {
          return 2 * Settings.linearSlop;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxSubSteps", {
        get: function() {
          return Settings.maxSubSteps;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTOIContacts", {
        get: function() {
          return Settings.maxTOIContacts;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTOIIterations", {
        get: function() {
          return Settings.maxTOIIterations;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxDistanceIterations", {
        get: function() {
          return Settings.maxDistanceIterations;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "velocityThreshold", {
        get: function() {
          return Settings.velocityThreshold * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxLinearCorrection", {
        get: function() {
          return Settings.maxLinearCorrection * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxAngularCorrection", {
        get: function() {
          return Settings.maxAngularCorrection;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTranslation", {
        get: function() {
          return Settings.maxTranslation * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTranslationSquared", {
        get: function() {
          return Settings.maxTranslation * Settings.lengthUnitsPerMeter * Settings.maxTranslation * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxRotation", {
        get: function() {
          return Settings.maxRotation;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxRotationSquared", {
        get: function() {
          return Settings.maxRotation * Settings.maxRotation;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "baumgarte", {
        get: function() {
          return Settings.baumgarte;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "toiBaugarte", {
        get: function() {
          return Settings.toiBaugarte;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "timeToSleep", {
        get: function() {
          return Settings.timeToSleep;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSleepTolerance", {
        get: function() {
          return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSleepToleranceSqr", {
        get: function() {
          return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter * Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSleepTolerance", {
        get: function() {
          return Settings.angularSleepTolerance;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSleepToleranceSqr", {
        get: function() {
          return Settings.angularSleepTolerance * Settings.angularSleepTolerance;
        },
        enumerable: false,
        configurable: true
      });
      return SettingsInternal2;
    }()
  );
  var Pool = (
    /** @class */
    function() {
      function Pool2(opts) {
        this._list = [];
        this._max = Infinity;
        this._hasCreateFn = false;
        this._createCount = 0;
        this._hasAllocateFn = false;
        this._allocateCount = 0;
        this._hasReleaseFn = false;
        this._releaseCount = 0;
        this._hasDisposeFn = false;
        this._disposeCount = 0;
        this._list = [];
        this._max = opts.max || this._max;
        this._createFn = opts.create;
        this._hasCreateFn = typeof this._createFn === "function";
        this._allocateFn = opts.allocate;
        this._hasAllocateFn = typeof this._allocateFn === "function";
        this._releaseFn = opts.release;
        this._hasReleaseFn = typeof this._releaseFn === "function";
        this._disposeFn = opts.dispose;
        this._hasDisposeFn = typeof this._disposeFn === "function";
      }
      Pool2.prototype.max = function(n2) {
        if (typeof n2 === "number") {
          this._max = n2;
          return this;
        }
        return this._max;
      };
      Pool2.prototype.size = function() {
        return this._list.length;
      };
      Pool2.prototype.allocate = function() {
        var item;
        if (this._list.length > 0) {
          item = this._list.shift();
        } else {
          this._createCount++;
          if (this._hasCreateFn) {
            item = this._createFn();
          } else {
            item = {};
          }
        }
        this._allocateCount++;
        if (this._hasAllocateFn) {
          this._allocateFn(item);
        }
        return item;
      };
      Pool2.prototype.release = function(item) {
        if (this._list.length < this._max) {
          this._releaseCount++;
          if (this._hasReleaseFn) {
            this._releaseFn(item);
          }
          this._list.push(item);
        } else {
          this._disposeCount++;
          if (this._hasDisposeFn) {
            item = this._disposeFn(item);
          }
        }
      };
      Pool2.prototype.toString = function() {
        return " +" + this._createCount + " >" + this._allocateCount + " <" + this._releaseCount + " -" + this._disposeCount + " =" + this._list.length + "/" + this._max;
      };
      return Pool2;
    }()
  );
  var math_abs$8 = Math.abs;
  var math_max$6 = Math.max;
  var TreeNode = (
    /** @class */
    function() {
      function TreeNode2(id) {
        this.aabb = new AABB();
        this.userData = null;
        this.parent = null;
        this.child1 = null;
        this.child2 = null;
        this.height = -1;
        this.id = id;
      }
      TreeNode2.prototype.toString = function() {
        return this.id + ": " + this.userData;
      };
      TreeNode2.prototype.isLeaf = function() {
        return this.child1 == null;
      };
      return TreeNode2;
    }()
  );
  var poolTreeNode = new Pool({
    create: function() {
      return new TreeNode();
    },
    release: function(node) {
      node.userData = null;
      node.parent = null;
      node.child1 = null;
      node.child2 = null;
      node.height = -1;
      node.id = void 0;
    }
  });
  var DynamicTree = (
    /** @class */
    function() {
      function DynamicTree2() {
        this.inputPool = new Pool({
          create: function() {
            return {};
          },
          release: function(stack) {
          }
        });
        this.stackPool = new Pool({
          create: function() {
            return [];
          },
          release: function(stack) {
            stack.length = 0;
          }
        });
        this.iteratorPool = new Pool({
          create: function() {
            return new Iterator();
          },
          release: function(iterator) {
            iterator.close();
          }
        });
        this.m_root = null;
        this.m_nodes = {};
        this.m_lastProxyId = 0;
      }
      DynamicTree2.prototype.getUserData = function(id) {
        var node = this.m_nodes[id];
        return node.userData;
      };
      DynamicTree2.prototype.getFatAABB = function(id) {
        var node = this.m_nodes[id];
        return node.aabb;
      };
      DynamicTree2.prototype.allocateNode = function() {
        var node = poolTreeNode.allocate();
        node.id = ++this.m_lastProxyId;
        this.m_nodes[node.id] = node;
        return node;
      };
      DynamicTree2.prototype.freeNode = function(node) {
        delete this.m_nodes[node.id];
        poolTreeNode.release(node);
      };
      DynamicTree2.prototype.createProxy = function(aabb, userData) {
        var node = this.allocateNode();
        node.aabb.set(aabb);
        AABB.extend(node.aabb, SettingsInternal.aabbExtension);
        node.userData = userData;
        node.height = 0;
        this.insertLeaf(node);
        return node.id;
      };
      DynamicTree2.prototype.destroyProxy = function(id) {
        var node = this.m_nodes[id];
        this.removeLeaf(node);
        this.freeNode(node);
      };
      DynamicTree2.prototype.moveProxy = function(id, aabb, d2) {
        var node = this.m_nodes[id];
        if (node.aabb.contains(aabb)) {
          return false;
        }
        this.removeLeaf(node);
        node.aabb.set(aabb);
        aabb = node.aabb;
        AABB.extend(aabb, SettingsInternal.aabbExtension);
        if (d2.x < 0) {
          aabb.lowerBound.x += d2.x * SettingsInternal.aabbMultiplier;
        } else {
          aabb.upperBound.x += d2.x * SettingsInternal.aabbMultiplier;
        }
        if (d2.y < 0) {
          aabb.lowerBound.y += d2.y * SettingsInternal.aabbMultiplier;
        } else {
          aabb.upperBound.y += d2.y * SettingsInternal.aabbMultiplier;
        }
        this.insertLeaf(node);
        return true;
      };
      DynamicTree2.prototype.insertLeaf = function(leaf) {
        if (this.m_root == null) {
          this.m_root = leaf;
          this.m_root.parent = null;
          return;
        }
        var leafAABB = leaf.aabb;
        var index = this.m_root;
        while (!index.isLeaf()) {
          var child1 = index.child1;
          var child2 = index.child2;
          var area = index.aabb.getPerimeter();
          var combinedArea = AABB.combinedPerimeter(index.aabb, leafAABB);
          var cost = 2 * combinedArea;
          var inheritanceCost = 2 * (combinedArea - area);
          var newArea1 = AABB.combinedPerimeter(leafAABB, child1.aabb);
          var cost1 = newArea1 + inheritanceCost;
          if (!child1.isLeaf()) {
            var oldArea = child1.aabb.getPerimeter();
            cost1 -= oldArea;
          }
          var newArea2 = AABB.combinedPerimeter(leafAABB, child2.aabb);
          var cost2 = newArea2 + inheritanceCost;
          if (!child2.isLeaf()) {
            var oldArea = child2.aabb.getPerimeter();
            cost2 -= oldArea;
          }
          if (cost < cost1 && cost < cost2) {
            break;
          }
          if (cost1 < cost2) {
            index = child1;
          } else {
            index = child2;
          }
        }
        var sibling = index;
        var oldParent = sibling.parent;
        var newParent = this.allocateNode();
        newParent.parent = oldParent;
        newParent.userData = null;
        newParent.aabb.combine(leafAABB, sibling.aabb);
        newParent.height = sibling.height + 1;
        if (oldParent != null) {
          if (oldParent.child1 === sibling) {
            oldParent.child1 = newParent;
          } else {
            oldParent.child2 = newParent;
          }
          newParent.child1 = sibling;
          newParent.child2 = leaf;
          sibling.parent = newParent;
          leaf.parent = newParent;
        } else {
          newParent.child1 = sibling;
          newParent.child2 = leaf;
          sibling.parent = newParent;
          leaf.parent = newParent;
          this.m_root = newParent;
        }
        index = leaf.parent;
        while (index != null) {
          index = this.balance(index);
          var child1 = index.child1;
          var child2 = index.child2;
          index.height = 1 + math_max$6(child1.height, child2.height);
          index.aabb.combine(child1.aabb, child2.aabb);
          index = index.parent;
        }
      };
      DynamicTree2.prototype.removeLeaf = function(leaf) {
        if (leaf === this.m_root) {
          this.m_root = null;
          return;
        }
        var parent = leaf.parent;
        var grandParent = parent.parent;
        var sibling;
        if (parent.child1 === leaf) {
          sibling = parent.child2;
        } else {
          sibling = parent.child1;
        }
        if (grandParent != null) {
          if (grandParent.child1 === parent) {
            grandParent.child1 = sibling;
          } else {
            grandParent.child2 = sibling;
          }
          sibling.parent = grandParent;
          this.freeNode(parent);
          var index = grandParent;
          while (index != null) {
            index = this.balance(index);
            var child1 = index.child1;
            var child2 = index.child2;
            index.aabb.combine(child1.aabb, child2.aabb);
            index.height = 1 + math_max$6(child1.height, child2.height);
            index = index.parent;
          }
        } else {
          this.m_root = sibling;
          sibling.parent = null;
          this.freeNode(parent);
        }
      };
      DynamicTree2.prototype.balance = function(iA) {
        var A = iA;
        if (A.isLeaf() || A.height < 2) {
          return iA;
        }
        var B = A.child1;
        var C = A.child2;
        var balance = C.height - B.height;
        if (balance > 1) {
          var F = C.child1;
          var G = C.child2;
          C.child1 = A;
          C.parent = A.parent;
          A.parent = C;
          if (C.parent != null) {
            if (C.parent.child1 === iA) {
              C.parent.child1 = C;
            } else {
              C.parent.child2 = C;
            }
          } else {
            this.m_root = C;
          }
          if (F.height > G.height) {
            C.child2 = F;
            A.child2 = G;
            G.parent = A;
            A.aabb.combine(B.aabb, G.aabb);
            C.aabb.combine(A.aabb, F.aabb);
            A.height = 1 + math_max$6(B.height, G.height);
            C.height = 1 + math_max$6(A.height, F.height);
          } else {
            C.child2 = G;
            A.child2 = F;
            F.parent = A;
            A.aabb.combine(B.aabb, F.aabb);
            C.aabb.combine(A.aabb, G.aabb);
            A.height = 1 + math_max$6(B.height, F.height);
            C.height = 1 + math_max$6(A.height, G.height);
          }
          return C;
        }
        if (balance < -1) {
          var D = B.child1;
          var E = B.child2;
          B.child1 = A;
          B.parent = A.parent;
          A.parent = B;
          if (B.parent != null) {
            if (B.parent.child1 === A) {
              B.parent.child1 = B;
            } else {
              B.parent.child2 = B;
            }
          } else {
            this.m_root = B;
          }
          if (D.height > E.height) {
            B.child2 = D;
            A.child1 = E;
            E.parent = A;
            A.aabb.combine(C.aabb, E.aabb);
            B.aabb.combine(A.aabb, D.aabb);
            A.height = 1 + math_max$6(C.height, E.height);
            B.height = 1 + math_max$6(A.height, D.height);
          } else {
            B.child2 = E;
            A.child1 = D;
            D.parent = A;
            A.aabb.combine(C.aabb, D.aabb);
            B.aabb.combine(A.aabb, E.aabb);
            A.height = 1 + math_max$6(C.height, D.height);
            B.height = 1 + math_max$6(A.height, E.height);
          }
          return B;
        }
        return A;
      };
      DynamicTree2.prototype.getHeight = function() {
        if (this.m_root == null) {
          return 0;
        }
        return this.m_root.height;
      };
      DynamicTree2.prototype.getAreaRatio = function() {
        if (this.m_root == null) {
          return 0;
        }
        var root = this.m_root;
        var rootArea = root.aabb.getPerimeter();
        var totalArea = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height < 0) {
            continue;
          }
          totalArea += node.aabb.getPerimeter();
        }
        this.iteratorPool.release(it);
        return totalArea / rootArea;
      };
      DynamicTree2.prototype.computeHeight = function(id) {
        var node;
        if (typeof id !== "undefined") {
          node = this.m_nodes[id];
        } else {
          node = this.m_root;
        }
        if (node.isLeaf()) {
          return 0;
        }
        var height1 = this.computeHeight(node.child1.id);
        var height2 = this.computeHeight(node.child2.id);
        return 1 + math_max$6(height1, height2);
      };
      DynamicTree2.prototype.validateStructure = function(node) {
        if (node == null) {
          return;
        }
        if (node === this.m_root) ;
        var child1 = node.child1;
        var child2 = node.child2;
        if (node.isLeaf()) {
          return;
        }
        this.validateStructure(child1);
        this.validateStructure(child2);
      };
      DynamicTree2.prototype.validateMetrics = function(node) {
        if (node == null) {
          return;
        }
        var child1 = node.child1;
        var child2 = node.child2;
        if (node.isLeaf()) {
          return;
        }
        this.validateMetrics(child1);
        this.validateMetrics(child2);
      };
      DynamicTree2.prototype.validate = function() {
        return;
      };
      DynamicTree2.prototype.getMaxBalance = function() {
        var maxBalance = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height <= 1) {
            continue;
          }
          var balance = math_abs$8(node.child2.height - node.child1.height);
          maxBalance = math_max$6(maxBalance, balance);
        }
        this.iteratorPool.release(it);
        return maxBalance;
      };
      DynamicTree2.prototype.rebuildBottomUp = function() {
        var nodes = [];
        var count = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height < 0) {
            continue;
          }
          if (node.isLeaf()) {
            node.parent = null;
            nodes[count] = node;
            ++count;
          } else {
            this.freeNode(node);
          }
        }
        this.iteratorPool.release(it);
        while (count > 1) {
          var minCost = Infinity;
          var iMin = -1;
          var jMin = -1;
          for (var i = 0; i < count; ++i) {
            var aabbi = nodes[i].aabb;
            for (var j = i + 1; j < count; ++j) {
              var aabbj = nodes[j].aabb;
              var cost = AABB.combinedPerimeter(aabbi, aabbj);
              if (cost < minCost) {
                iMin = i;
                jMin = j;
                minCost = cost;
              }
            }
          }
          var child1 = nodes[iMin];
          var child2 = nodes[jMin];
          var parent_1 = this.allocateNode();
          parent_1.child1 = child1;
          parent_1.child2 = child2;
          parent_1.height = 1 + math_max$6(child1.height, child2.height);
          parent_1.aabb.combine(child1.aabb, child2.aabb);
          parent_1.parent = null;
          child1.parent = parent_1;
          child2.parent = parent_1;
          nodes[jMin] = nodes[count - 1];
          nodes[iMin] = parent_1;
          --count;
        }
        this.m_root = nodes[0];
      };
      DynamicTree2.prototype.shiftOrigin = function(newOrigin) {
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          var aabb = node.aabb;
          aabb.lowerBound.x -= newOrigin.x;
          aabb.lowerBound.y -= newOrigin.y;
          aabb.upperBound.x -= newOrigin.x;
          aabb.upperBound.y -= newOrigin.y;
        }
        this.iteratorPool.release(it);
      };
      DynamicTree2.prototype.query = function(aabb, queryCallback) {
        var stack = this.stackPool.allocate();
        stack.push(this.m_root);
        while (stack.length > 0) {
          var node = stack.pop();
          if (node == null) {
            continue;
          }
          if (AABB.testOverlap(node.aabb, aabb)) {
            if (node.isLeaf()) {
              var proceed = queryCallback(node.id);
              if (proceed === false) {
                return;
              }
            } else {
              stack.push(node.child1);
              stack.push(node.child2);
            }
          }
        }
        this.stackPool.release(stack);
      };
      DynamicTree2.prototype.rayCast = function(input2, rayCastCallback) {
        var p1 = input2.p1;
        var p2 = input2.p2;
        var r = Vec2.sub(p2, p1);
        r.normalize();
        var v3 = Vec2.crossNumVec2(1, r);
        var abs_v = Vec2.abs(v3);
        var maxFraction = input2.maxFraction;
        var segmentAABB = new AABB();
        var t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);
        segmentAABB.combinePoints(p1, t);
        var stack = this.stackPool.allocate();
        var subInput = this.inputPool.allocate();
        stack.push(this.m_root);
        while (stack.length > 0) {
          var node = stack.pop();
          if (node == null) {
            continue;
          }
          if (AABB.testOverlap(node.aabb, segmentAABB) === false) {
            continue;
          }
          var c2 = node.aabb.getCenter();
          var h = node.aabb.getExtents();
          var separation = math_abs$8(Vec2.dot(v3, Vec2.sub(p1, c2))) - Vec2.dot(abs_v, h);
          if (separation > 0) {
            continue;
          }
          if (node.isLeaf()) {
            subInput.p1 = Vec2.clone(input2.p1);
            subInput.p2 = Vec2.clone(input2.p2);
            subInput.maxFraction = maxFraction;
            var value = rayCastCallback(subInput, node.id);
            if (value === 0) {
              break;
            } else if (value > 0) {
              maxFraction = value;
              t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);
              segmentAABB.combinePoints(p1, t);
            }
          } else {
            stack.push(node.child1);
            stack.push(node.child2);
          }
        }
        this.stackPool.release(stack);
        this.inputPool.release(subInput);
      };
      return DynamicTree2;
    }()
  );
  var Iterator = (
    /** @class */
    function() {
      function Iterator2() {
        this.parents = [];
        this.states = [];
      }
      Iterator2.prototype.preorder = function(root) {
        this.parents.length = 0;
        this.parents.push(root);
        this.states.length = 0;
        this.states.push(0);
        return this;
      };
      Iterator2.prototype.next = function() {
        while (this.parents.length > 0) {
          var i = this.parents.length - 1;
          var node = this.parents[i];
          if (this.states[i] === 0) {
            this.states[i] = 1;
            return node;
          }
          if (this.states[i] === 1) {
            this.states[i] = 2;
            if (node.child1) {
              this.parents.push(node.child1);
              this.states.push(1);
              return node.child1;
            }
          }
          if (this.states[i] === 2) {
            this.states[i] = 3;
            if (node.child2) {
              this.parents.push(node.child2);
              this.states.push(1);
              return node.child2;
            }
          }
          this.parents.pop();
          this.states.pop();
        }
      };
      Iterator2.prototype.close = function() {
        this.parents.length = 0;
      };
      return Iterator2;
    }()
  );
  var math_max$5 = Math.max;
  var math_min$6 = Math.min;
  var BroadPhase = (
    /** @class */
    function() {
      function BroadPhase2() {
        var _this = this;
        this.m_tree = new DynamicTree();
        this.m_moveBuffer = [];
        this.query = function(aabb, queryCallback) {
          _this.m_tree.query(aabb, queryCallback);
        };
        this.queryCallback = function(proxyId) {
          if (proxyId === _this.m_queryProxyId) {
            return true;
          }
          var proxyIdA = math_min$6(proxyId, _this.m_queryProxyId);
          var proxyIdB = math_max$5(proxyId, _this.m_queryProxyId);
          var userDataA = _this.m_tree.getUserData(proxyIdA);
          var userDataB = _this.m_tree.getUserData(proxyIdB);
          _this.m_callback(userDataA, userDataB);
          return true;
        };
      }
      BroadPhase2.prototype.getUserData = function(proxyId) {
        return this.m_tree.getUserData(proxyId);
      };
      BroadPhase2.prototype.testOverlap = function(proxyIdA, proxyIdB) {
        var aabbA = this.m_tree.getFatAABB(proxyIdA);
        var aabbB = this.m_tree.getFatAABB(proxyIdB);
        return AABB.testOverlap(aabbA, aabbB);
      };
      BroadPhase2.prototype.getFatAABB = function(proxyId) {
        return this.m_tree.getFatAABB(proxyId);
      };
      BroadPhase2.prototype.getProxyCount = function() {
        return this.m_moveBuffer.length;
      };
      BroadPhase2.prototype.getTreeHeight = function() {
        return this.m_tree.getHeight();
      };
      BroadPhase2.prototype.getTreeBalance = function() {
        return this.m_tree.getMaxBalance();
      };
      BroadPhase2.prototype.getTreeQuality = function() {
        return this.m_tree.getAreaRatio();
      };
      BroadPhase2.prototype.rayCast = function(input2, rayCastCallback) {
        this.m_tree.rayCast(input2, rayCastCallback);
      };
      BroadPhase2.prototype.shiftOrigin = function(newOrigin) {
        this.m_tree.shiftOrigin(newOrigin);
      };
      BroadPhase2.prototype.createProxy = function(aabb, userData) {
        var proxyId = this.m_tree.createProxy(aabb, userData);
        this.bufferMove(proxyId);
        return proxyId;
      };
      BroadPhase2.prototype.destroyProxy = function(proxyId) {
        this.unbufferMove(proxyId);
        this.m_tree.destroyProxy(proxyId);
      };
      BroadPhase2.prototype.moveProxy = function(proxyId, aabb, displacement2) {
        var changed = this.m_tree.moveProxy(proxyId, aabb, displacement2);
        if (changed) {
          this.bufferMove(proxyId);
        }
      };
      BroadPhase2.prototype.touchProxy = function(proxyId) {
        this.bufferMove(proxyId);
      };
      BroadPhase2.prototype.bufferMove = function(proxyId) {
        this.m_moveBuffer.push(proxyId);
      };
      BroadPhase2.prototype.unbufferMove = function(proxyId) {
        for (var i = 0; i < this.m_moveBuffer.length; ++i) {
          if (this.m_moveBuffer[i] === proxyId) {
            this.m_moveBuffer[i] = null;
          }
        }
      };
      BroadPhase2.prototype.updatePairs = function(addPairCallback) {
        this.m_callback = addPairCallback;
        while (this.m_moveBuffer.length > 0) {
          this.m_queryProxyId = this.m_moveBuffer.pop();
          if (this.m_queryProxyId === null) {
            continue;
          }
          var fatAABB = this.m_tree.getFatAABB(this.m_queryProxyId);
          this.m_tree.query(fatAABB, this.queryCallback);
        }
      };
      return BroadPhase2;
    }()
  );
  var math_sin$2 = Math.sin;
  var math_cos$2 = Math.cos;
  var math_sqrt$4 = Math.sqrt;
  function vec2(x2, y) {
    return { x: x2, y };
  }
  function rotation(angle) {
    return { s: math_sin$2(angle), c: math_cos$2(angle) };
  }
  function setVec2(out, x2, y) {
    out.x = x2;
    out.y = y;
    return out;
  }
  function copyVec2(out, w) {
    out.x = w.x;
    out.y = w.y;
    return out;
  }
  function zeroVec2(out) {
    out.x = 0;
    out.y = 0;
    return out;
  }
  function negVec2(out) {
    out.x = -out.x;
    out.y = -out.y;
    return out;
  }
  function plusVec2(out, w) {
    out.x += w.x;
    out.y += w.y;
    return out;
  }
  function addVec2(out, v3, w) {
    out.x = v3.x + w.x;
    out.y = v3.x + w.y;
    return out;
  }
  function minusVec2(out, w) {
    out.x -= w.x;
    out.y -= w.y;
    return out;
  }
  function subVec2(out, v3, w) {
    out.x = v3.x - w.x;
    out.y = v3.y - w.y;
    return out;
  }
  function mulVec2(out, m) {
    out.x *= m;
    out.y *= m;
    return out;
  }
  function scaleVec2(out, m, w) {
    out.x = m * w.x;
    out.y = m * w.y;
    return out;
  }
  function plusScaleVec2(out, m, w) {
    out.x += m * w.x;
    out.y += m * w.y;
    return out;
  }
  function minusScaleVec2(out, m, w) {
    out.x -= m * w.x;
    out.y -= m * w.y;
    return out;
  }
  function combine2Vec2(out, am, a2, bm, b2) {
    out.x = am * a2.x + bm * b2.x;
    out.y = am * a2.y + bm * b2.y;
    return out;
  }
  function combine3Vec2(out, am, a2, bm, b2, cm, c2) {
    out.x = am * a2.x + bm * b2.x + cm * c2.x;
    out.y = am * a2.y + bm * b2.y + cm * c2.y;
    return out;
  }
  function normalizeVec2Length(out) {
    var length = math_sqrt$4(out.x * out.x + out.y * out.y);
    if (length !== 0) {
      var invLength = 1 / length;
      out.x *= invLength;
      out.y *= invLength;
    }
    return length;
  }
  function normalizeVec2(out) {
    var length = math_sqrt$4(out.x * out.x + out.y * out.y);
    if (length > 0) {
      var invLength = 1 / length;
      out.x *= invLength;
      out.y *= invLength;
    }
    return out;
  }
  function crossVec2Num(out, v3, w) {
    var x2 = w * v3.y;
    var y = -w * v3.x;
    out.x = x2;
    out.y = y;
    return out;
  }
  function crossNumVec2(out, w, v3) {
    var x2 = -w * v3.y;
    var y = w * v3.x;
    out.x = x2;
    out.y = y;
    return out;
  }
  function crossVec2Vec2(a2, b2) {
    return a2.x * b2.y - a2.y * b2.x;
  }
  function dotVec2(a2, b2) {
    return a2.x * b2.x + a2.y * b2.y;
  }
  function lengthSqrVec2(a2) {
    return a2.x * a2.x + a2.y * a2.y;
  }
  function distVec2(a2, b2) {
    var dx = a2.x - b2.x;
    var dy = a2.y - b2.y;
    return math_sqrt$4(dx * dx + dy * dy);
  }
  function distSqrVec2(a2, b2) {
    var dx = a2.x - b2.x;
    var dy = a2.y - b2.y;
    return dx * dx + dy * dy;
  }
  function setRotAngle(out, a2) {
    out.c = math_cos$2(a2);
    out.s = math_sin$2(a2);
    return out;
  }
  function rotVec2(out, q, v3) {
    out.x = q.c * v3.x - q.s * v3.y;
    out.y = q.s * v3.x + q.c * v3.y;
    return out;
  }
  function derotVec2(out, q, v3) {
    var x2 = q.c * v3.x + q.s * v3.y;
    var y = -q.s * v3.x + q.c * v3.y;
    out.x = x2;
    out.y = y;
    return out;
  }
  function rerotVec2(out, before, after, v3) {
    var x0 = before.c * v3.x + before.s * v3.y;
    var y0 = -before.s * v3.x + before.c * v3.y;
    var x2 = after.c * x0 - after.s * y0;
    var y = after.s * x0 + after.c * y0;
    out.x = x2;
    out.y = y;
    return out;
  }
  function transform(x2, y, a2) {
    return { p: vec2(x2, y), q: rotation(a2) };
  }
  function copyTransform(out, transform2) {
    out.p.x = transform2.p.x;
    out.p.y = transform2.p.y;
    out.q.s = transform2.q.s;
    out.q.c = transform2.q.c;
    return out;
  }
  function transformVec2(out, xf2, v3) {
    var x2 = xf2.q.c * v3.x - xf2.q.s * v3.y + xf2.p.x;
    var y = xf2.q.s * v3.x + xf2.q.c * v3.y + xf2.p.y;
    out.x = x2;
    out.y = y;
    return out;
  }
  function detransformVec2(out, xf2, v3) {
    var px = v3.x - xf2.p.x;
    var py = v3.y - xf2.p.y;
    var x2 = xf2.q.c * px + xf2.q.s * py;
    var y = -xf2.q.s * px + xf2.q.c * py;
    out.x = x2;
    out.y = y;
    return out;
  }
  function retransformVec2(out, from, to, v3) {
    var x0 = from.q.c * v3.x - from.q.s * v3.y + from.p.x;
    var y0 = from.q.s * v3.x + from.q.c * v3.y + from.p.y;
    var px = x0 - to.p.x;
    var py = y0 - to.p.y;
    var x2 = to.q.c * px + to.q.s * py;
    var y = -to.q.s * px + to.q.c * py;
    out.x = x2;
    out.y = y;
    return out;
  }
  function detransformTransform(out, a2, b2) {
    var c2 = a2.q.c * b2.q.c + a2.q.s * b2.q.s;
    var s2 = a2.q.c * b2.q.s - a2.q.s * b2.q.c;
    var x2 = a2.q.c * (b2.p.x - a2.p.x) + a2.q.s * (b2.p.y - a2.p.y);
    var y = -a2.q.s * (b2.p.x - a2.p.x) + a2.q.c * (b2.p.y - a2.p.y);
    out.q.c = c2;
    out.q.s = s2;
    out.p.x = x2;
    out.p.y = y;
    return out;
  }
  var math_sin$1 = Math.sin;
  var math_cos$1 = Math.cos;
  var math_atan2$1 = Math.atan2;
  var Rot = (
    /** @class */
    function() {
      function Rot2(angle) {
        if (!(this instanceof Rot2)) {
          return new Rot2(angle);
        }
        if (typeof angle === "number") {
          this.setAngle(angle);
        } else if (typeof angle === "object") {
          this.setRot(angle);
        } else {
          this.setIdentity();
        }
      }
      Rot2.neo = function(angle) {
        var obj = Object.create(Rot2.prototype);
        obj.setAngle(angle);
        return obj;
      };
      Rot2.clone = function(rot) {
        var obj = Object.create(Rot2.prototype);
        obj.s = rot.s;
        obj.c = rot.c;
        return obj;
      };
      Rot2.identity = function() {
        var obj = Object.create(Rot2.prototype);
        obj.s = 0;
        obj.c = 1;
        return obj;
      };
      Rot2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.s) && Number.isFinite(obj.c);
      };
      Rot2.assert = function(o) {
      };
      Rot2.prototype.setIdentity = function() {
        this.s = 0;
        this.c = 1;
      };
      Rot2.prototype.set = function(angle) {
        if (typeof angle === "object") {
          this.s = angle.s;
          this.c = angle.c;
        } else {
          this.s = math_sin$1(angle);
          this.c = math_cos$1(angle);
        }
      };
      Rot2.prototype.setRot = function(angle) {
        this.s = angle.s;
        this.c = angle.c;
      };
      Rot2.prototype.setAngle = function(angle) {
        this.s = math_sin$1(angle);
        this.c = math_cos$1(angle);
      };
      Rot2.prototype.getAngle = function() {
        return math_atan2$1(this.s, this.c);
      };
      Rot2.prototype.getXAxis = function() {
        return Vec2.neo(this.c, this.s);
      };
      Rot2.prototype.getYAxis = function() {
        return Vec2.neo(-this.s, this.c);
      };
      Rot2.mul = function(rot, m) {
        if ("c" in m && "s" in m) {
          var qr = Rot2.identity();
          qr.s = rot.s * m.c + rot.c * m.s;
          qr.c = rot.c * m.c - rot.s * m.s;
          return qr;
        } else if ("x" in m && "y" in m) {
          return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);
        }
      };
      Rot2.mulRot = function(rot, m) {
        var qr = Rot2.identity();
        qr.s = rot.s * m.c + rot.c * m.s;
        qr.c = rot.c * m.c - rot.s * m.s;
        return qr;
      };
      Rot2.mulVec2 = function(rot, m) {
        return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);
      };
      Rot2.mulSub = function(rot, v3, w) {
        var x2 = rot.c * (v3.x - w.x) - rot.s * (v3.y - w.y);
        var y = rot.s * (v3.x - w.x) + rot.c * (v3.y - w.y);
        return Vec2.neo(x2, y);
      };
      Rot2.mulT = function(rot, m) {
        if ("c" in m && "s" in m) {
          var qr = Rot2.identity();
          qr.s = rot.c * m.s - rot.s * m.c;
          qr.c = rot.c * m.c + rot.s * m.s;
          return qr;
        } else if ("x" in m && "y" in m) {
          return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);
        }
      };
      Rot2.mulTRot = function(rot, m) {
        var qr = Rot2.identity();
        qr.s = rot.c * m.s - rot.s * m.c;
        qr.c = rot.c * m.c + rot.s * m.s;
        return qr;
      };
      Rot2.mulTVec2 = function(rot, m) {
        return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);
      };
      return Rot2;
    }()
  );
  var math_atan2 = Math.atan2;
  var math_PI$5 = Math.PI;
  var temp$7 = vec2(0, 0);
  var Sweep = (
    /** @class */
    function() {
      function Sweep2() {
        this.localCenter = Vec2.zero();
        this.c = Vec2.zero();
        this.a = 0;
        this.alpha0 = 0;
        this.c0 = Vec2.zero();
        this.a0 = 0;
      }
      Sweep2.prototype.recycle = function() {
        zeroVec2(this.localCenter);
        zeroVec2(this.c);
        this.a = 0;
        this.alpha0 = 0;
        zeroVec2(this.c0);
        this.a0 = 0;
      };
      Sweep2.prototype.setTransform = function(xf2) {
        transformVec2(temp$7, xf2, this.localCenter);
        copyVec2(this.c, temp$7);
        copyVec2(this.c0, temp$7);
        this.a = this.a0 = math_atan2(xf2.q.s, xf2.q.c);
      };
      Sweep2.prototype.setLocalCenter = function(localCenter2, xf2) {
        copyVec2(this.localCenter, localCenter2);
        transformVec2(temp$7, xf2, this.localCenter);
        copyVec2(this.c, temp$7);
        copyVec2(this.c0, temp$7);
      };
      Sweep2.prototype.getTransform = function(xf2, beta) {
        if (beta === void 0) {
          beta = 0;
        }
        setRotAngle(xf2.q, (1 - beta) * this.a0 + beta * this.a);
        combine2Vec2(xf2.p, 1 - beta, this.c0, beta, this.c);
        minusVec2(xf2.p, rotVec2(temp$7, xf2.q, this.localCenter));
      };
      Sweep2.prototype.advance = function(alpha) {
        var beta = (alpha - this.alpha0) / (1 - this.alpha0);
        combine2Vec2(this.c0, beta, this.c, 1 - beta, this.c0);
        this.a0 = beta * this.a + (1 - beta) * this.a0;
        this.alpha0 = alpha;
      };
      Sweep2.prototype.forward = function() {
        this.a0 = this.a;
        copyVec2(this.c0, this.c);
      };
      Sweep2.prototype.normalize = function() {
        var a0 = mod(this.a0, -math_PI$5, +math_PI$5);
        this.a -= this.a0 - a0;
        this.a0 = a0;
      };
      Sweep2.prototype.set = function(that) {
        copyVec2(this.localCenter, that.localCenter);
        copyVec2(this.c, that.c);
        this.a = that.a;
        this.alpha0 = that.alpha0;
        copyVec2(this.c0, that.c0);
        this.a0 = that.a0;
      };
      return Sweep2;
    }()
  );
  var Transform = (
    /** @class */
    function() {
      function Transform2(position, rotation2) {
        if (!(this instanceof Transform2)) {
          return new Transform2(position, rotation2);
        }
        this.p = Vec2.zero();
        this.q = Rot.identity();
        if (typeof position !== "undefined") {
          this.p.setVec2(position);
        }
        if (typeof rotation2 !== "undefined") {
          this.q.setAngle(rotation2);
        }
      }
      Transform2.clone = function(xf2) {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.clone(xf2.p);
        obj.q = Rot.clone(xf2.q);
        return obj;
      };
      Transform2.neo = function(position, rotation2) {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.clone(position);
        obj.q = Rot.clone(rotation2);
        return obj;
      };
      Transform2.identity = function() {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.zero();
        obj.q = Rot.identity();
        return obj;
      };
      Transform2.prototype.setIdentity = function() {
        this.p.setZero();
        this.q.setIdentity();
      };
      Transform2.prototype.set = function(a2, b2) {
        if (typeof b2 === "undefined") {
          this.p.set(a2.p);
          this.q.set(a2.q);
        } else {
          this.p.set(a2);
          this.q.set(b2);
        }
      };
      Transform2.prototype.setNum = function(position, rotation2) {
        this.p.setVec2(position);
        this.q.setAngle(rotation2);
      };
      Transform2.prototype.setTransform = function(xf2) {
        this.p.setVec2(xf2.p);
        this.q.setRot(xf2.q);
      };
      Transform2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.p) && Rot.isValid(obj.q);
      };
      Transform2.assert = function(o) {
      };
      Transform2.mul = function(a2, b2) {
        if (Array.isArray(b2)) {
          var arr = [];
          for (var i = 0; i < b2.length; i++) {
            arr[i] = Transform2.mul(a2, b2[i]);
          }
          return arr;
        } else if ("x" in b2 && "y" in b2) {
          return Transform2.mulVec2(a2, b2);
        } else if ("p" in b2 && "q" in b2) {
          return Transform2.mulXf(a2, b2);
        }
      };
      Transform2.mulAll = function(a2, b2) {
        var arr = [];
        for (var i = 0; i < b2.length; i++) {
          arr[i] = Transform2.mul(a2, b2[i]);
        }
        return arr;
      };
      Transform2.mulFn = function(a2) {
        return function(b2) {
          return Transform2.mul(a2, b2);
        };
      };
      Transform2.mulVec2 = function(a2, b2) {
        var x2 = a2.q.c * b2.x - a2.q.s * b2.y + a2.p.x;
        var y = a2.q.s * b2.x + a2.q.c * b2.y + a2.p.y;
        return Vec2.neo(x2, y);
      };
      Transform2.mulXf = function(a2, b2) {
        var xf2 = Transform2.identity();
        xf2.q = Rot.mulRot(a2.q, b2.q);
        xf2.p = Vec2.add(Rot.mulVec2(a2.q, b2.p), a2.p);
        return xf2;
      };
      Transform2.mulT = function(a2, b2) {
        if ("x" in b2 && "y" in b2) {
          return Transform2.mulTVec2(a2, b2);
        } else if ("p" in b2 && "q" in b2) {
          return Transform2.mulTXf(a2, b2);
        }
      };
      Transform2.mulTVec2 = function(a2, b2) {
        var px = b2.x - a2.p.x;
        var py = b2.y - a2.p.y;
        var x2 = a2.q.c * px + a2.q.s * py;
        var y = -a2.q.s * px + a2.q.c * py;
        return Vec2.neo(x2, y);
      };
      Transform2.mulTXf = function(a2, b2) {
        var xf2 = Transform2.identity();
        xf2.q.setRot(Rot.mulTRot(a2.q, b2.q));
        xf2.p.setVec2(Rot.mulTVec2(a2.q, Vec2.sub(b2.p, a2.p)));
        return xf2;
      };
      return Transform2;
    }()
  );
  var Velocity = (
    /** @class */
    /* @__PURE__ */ function() {
      function Velocity2() {
        this.v = Vec2.zero();
        this.w = 0;
      }
      return Velocity2;
    }()
  );
  var math_sin = Math.sin;
  var math_cos = Math.cos;
  var Position = (
    /** @class */
    function() {
      function Position2() {
        this.c = Vec2.zero();
        this.a = 0;
      }
      Position2.prototype.getTransform = function(xf2, p) {
        xf2.q.c = math_cos(this.a);
        xf2.q.s = math_sin(this.a);
        xf2.p.x = this.c.x - (xf2.q.c * p.x - xf2.q.s * p.y);
        xf2.p.y = this.c.y - (xf2.q.s * p.x + xf2.q.c * p.y);
        return xf2;
      };
      return Position2;
    }()
  );
  function getTransform(xf2, p, c2, a2) {
    xf2.q.c = math_cos(a2);
    xf2.q.s = math_sin(a2);
    xf2.p.x = c2.x - (xf2.q.c * p.x - xf2.q.s * p.y);
    xf2.p.y = c2.y - (xf2.q.s * p.x + xf2.q.c * p.y);
    return xf2;
  }
  var Shape = (
    /** @class */
    function() {
      function Shape2() {
        this.style = {};
        this.appData = {};
      }
      Shape2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return typeof obj.m_type === "string" && typeof obj.m_radius === "number";
      };
      return Shape2;
    }()
  );
  var synchronize_aabb1 = new AABB();
  var synchronize_aabb2 = new AABB();
  var displacement = vec2(0, 0);
  var FixtureDefDefault = {
    userData: null,
    friction: 0.2,
    restitution: 0,
    density: 0,
    isSensor: false,
    filterGroupIndex: 0,
    filterCategoryBits: 1,
    filterMaskBits: 65535
  };
  var FixtureProxy = (
    /** @class */
    /* @__PURE__ */ function() {
      function FixtureProxy2(fixture, childIndex) {
        this.aabb = new AABB();
        this.fixture = fixture;
        this.childIndex = childIndex;
      }
      return FixtureProxy2;
    }()
  );
  var Fixture = (
    /** @class */
    function() {
      function Fixture2(body, shape, def) {
        this.style = {};
        this.appData = {};
        if (shape.shape) {
          def = shape;
          shape = shape.shape;
        } else if (typeof def === "number") {
          def = { density: def };
        }
        def = options(def, FixtureDefDefault);
        this.m_body = body;
        this.m_friction = def.friction;
        this.m_restitution = def.restitution;
        this.m_density = def.density;
        this.m_isSensor = def.isSensor;
        this.m_filterGroupIndex = def.filterGroupIndex;
        this.m_filterCategoryBits = def.filterCategoryBits;
        this.m_filterMaskBits = def.filterMaskBits;
        this.m_shape = shape;
        this.m_next = null;
        this.m_proxies = [];
        this.m_proxyCount = 0;
        var childCount = this.m_shape.getChildCount();
        for (var i = 0; i < childCount; ++i) {
          this.m_proxies[i] = new FixtureProxy(this, i);
        }
        this.m_userData = def.userData;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Fixture2.prototype._reset = function() {
        var body = this.getBody();
        var broadPhase = body.m_world.m_broadPhase;
        this.destroyProxies(broadPhase);
        if (this.m_shape._reset) {
          this.m_shape._reset();
        }
        var childCount = this.m_shape.getChildCount();
        for (var i = 0; i < childCount; ++i) {
          this.m_proxies[i] = new FixtureProxy(this, i);
        }
        this.createProxies(broadPhase, body.m_xf);
        body.resetMassData();
      };
      Fixture2.prototype._serialize = function() {
        return {
          friction: this.m_friction,
          restitution: this.m_restitution,
          density: this.m_density,
          isSensor: this.m_isSensor,
          filterGroupIndex: this.m_filterGroupIndex,
          filterCategoryBits: this.m_filterCategoryBits,
          filterMaskBits: this.m_filterMaskBits,
          shape: this.m_shape
        };
      };
      Fixture2._deserialize = function(data, body, restore) {
        var shape = restore(Shape, data.shape);
        var fixture = shape && new Fixture2(body, shape, data);
        return fixture;
      };
      Fixture2.prototype.getType = function() {
        return this.m_shape.m_type;
      };
      Fixture2.prototype.getShape = function() {
        return this.m_shape;
      };
      Fixture2.prototype.isSensor = function() {
        return this.m_isSensor;
      };
      Fixture2.prototype.setSensor = function(sensor) {
        if (sensor != this.m_isSensor) {
          this.m_body.setAwake(true);
          this.m_isSensor = sensor;
        }
      };
      Fixture2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Fixture2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Fixture2.prototype.getBody = function() {
        return this.m_body;
      };
      Fixture2.prototype.getNext = function() {
        return this.m_next;
      };
      Fixture2.prototype.getDensity = function() {
        return this.m_density;
      };
      Fixture2.prototype.setDensity = function(density) {
        this.m_density = density;
      };
      Fixture2.prototype.getFriction = function() {
        return this.m_friction;
      };
      Fixture2.prototype.setFriction = function(friction) {
        this.m_friction = friction;
      };
      Fixture2.prototype.getRestitution = function() {
        return this.m_restitution;
      };
      Fixture2.prototype.setRestitution = function(restitution) {
        this.m_restitution = restitution;
      };
      Fixture2.prototype.testPoint = function(p) {
        return this.m_shape.testPoint(this.m_body.getTransform(), p);
      };
      Fixture2.prototype.rayCast = function(output2, input2, childIndex) {
        return this.m_shape.rayCast(output2, input2, this.m_body.getTransform(), childIndex);
      };
      Fixture2.prototype.getMassData = function(massData) {
        this.m_shape.computeMass(massData, this.m_density);
      };
      Fixture2.prototype.getAABB = function(childIndex) {
        return this.m_proxies[childIndex].aabb;
      };
      Fixture2.prototype.createProxies = function(broadPhase, xf2) {
        this.m_proxyCount = this.m_shape.getChildCount();
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          this.m_shape.computeAABB(proxy.aabb, xf2, i);
          proxy.proxyId = broadPhase.createProxy(proxy.aabb, proxy);
        }
      };
      Fixture2.prototype.destroyProxies = function(broadPhase) {
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          broadPhase.destroyProxy(proxy.proxyId);
          proxy.proxyId = null;
        }
        this.m_proxyCount = 0;
      };
      Fixture2.prototype.synchronize = function(broadPhase, xf1, xf2) {
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          this.m_shape.computeAABB(synchronize_aabb1, xf1, proxy.childIndex);
          this.m_shape.computeAABB(synchronize_aabb2, xf2, proxy.childIndex);
          proxy.aabb.combine(synchronize_aabb1, synchronize_aabb2);
          subVec2(displacement, xf2.p, xf1.p);
          broadPhase.moveProxy(proxy.proxyId, proxy.aabb, displacement);
        }
      };
      Fixture2.prototype.setFilterData = function(filter) {
        this.m_filterGroupIndex = filter.groupIndex;
        this.m_filterCategoryBits = filter.categoryBits;
        this.m_filterMaskBits = filter.maskBits;
        this.refilter();
      };
      Fixture2.prototype.getFilterGroupIndex = function() {
        return this.m_filterGroupIndex;
      };
      Fixture2.prototype.setFilterGroupIndex = function(groupIndex) {
        this.m_filterGroupIndex = groupIndex;
        this.refilter();
      };
      Fixture2.prototype.getFilterCategoryBits = function() {
        return this.m_filterCategoryBits;
      };
      Fixture2.prototype.setFilterCategoryBits = function(categoryBits) {
        this.m_filterCategoryBits = categoryBits;
        this.refilter();
      };
      Fixture2.prototype.getFilterMaskBits = function() {
        return this.m_filterMaskBits;
      };
      Fixture2.prototype.setFilterMaskBits = function(maskBits) {
        this.m_filterMaskBits = maskBits;
        this.refilter();
      };
      Fixture2.prototype.refilter = function() {
        if (this.m_body == null) {
          return;
        }
        var edge = this.m_body.getContactList();
        while (edge) {
          var contact = edge.contact;
          var fixtureA = contact.getFixtureA();
          var fixtureB = contact.getFixtureB();
          if (fixtureA == this || fixtureB == this) {
            contact.flagForFiltering();
          }
          edge = edge.next;
        }
        var world = this.m_body.getWorld();
        if (world == null) {
          return;
        }
        var broadPhase = world.m_broadPhase;
        for (var i = 0; i < this.m_proxyCount; ++i) {
          broadPhase.touchProxy(this.m_proxies[i].proxyId);
        }
      };
      Fixture2.prototype.shouldCollide = function(that) {
        if (that.m_filterGroupIndex === this.m_filterGroupIndex && that.m_filterGroupIndex !== 0) {
          return that.m_filterGroupIndex > 0;
        }
        var collideA = (that.m_filterMaskBits & this.m_filterCategoryBits) !== 0;
        var collideB = (that.m_filterCategoryBits & this.m_filterMaskBits) !== 0;
        var collide = collideA && collideB;
        return collide;
      };
      return Fixture2;
    }()
  );
  var STATIC = "static";
  var KINEMATIC = "kinematic";
  var DYNAMIC = "dynamic";
  var oldCenter = vec2(0, 0);
  var localCenter = vec2(0, 0);
  var shift = vec2(0, 0);
  var temp$6 = vec2(0, 0);
  var xf$2 = transform(0, 0, 0);
  var BodyDefDefault = {
    type: STATIC,
    position: Vec2.zero(),
    angle: 0,
    linearVelocity: Vec2.zero(),
    angularVelocity: 0,
    linearDamping: 0,
    angularDamping: 0,
    fixedRotation: false,
    bullet: false,
    gravityScale: 1,
    allowSleep: true,
    awake: true,
    active: true,
    userData: null
  };
  var Body = (
    /** @class */
    function() {
      function Body2(world, def) {
        this.style = {};
        this.appData = {};
        def = options(def, BodyDefDefault);
        this.m_world = world;
        this.m_awakeFlag = def.awake;
        this.m_autoSleepFlag = def.allowSleep;
        this.m_bulletFlag = def.bullet;
        this.m_fixedRotationFlag = def.fixedRotation;
        this.m_activeFlag = def.active;
        this.m_islandFlag = false;
        this.m_toiFlag = false;
        this.m_userData = def.userData;
        this.m_type = def.type;
        if (this.m_type == DYNAMIC) {
          this.m_mass = 1;
          this.m_invMass = 1;
        } else {
          this.m_mass = 0;
          this.m_invMass = 0;
        }
        this.m_I = 0;
        this.m_invI = 0;
        this.m_xf = Transform.identity();
        this.m_xf.p.setVec2(def.position);
        this.m_xf.q.setAngle(def.angle);
        this.m_sweep = new Sweep();
        this.m_sweep.setTransform(this.m_xf);
        this.c_velocity = new Velocity();
        this.c_position = new Position();
        this.m_force = Vec2.zero();
        this.m_torque = 0;
        this.m_linearVelocity = Vec2.clone(def.linearVelocity);
        this.m_angularVelocity = def.angularVelocity;
        this.m_linearDamping = def.linearDamping;
        this.m_angularDamping = def.angularDamping;
        this.m_gravityScale = def.gravityScale;
        this.m_sleepTime = 0;
        this.m_jointList = null;
        this.m_contactList = null;
        this.m_fixtureList = null;
        this.m_prev = null;
        this.m_next = null;
        this.m_destroyed = false;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Body2.prototype._serialize = function() {
        var fixtures = [];
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          fixtures.push(f);
        }
        return {
          type: this.m_type,
          bullet: this.m_bulletFlag,
          position: this.m_xf.p,
          angle: this.m_xf.q.getAngle(),
          linearVelocity: this.m_linearVelocity,
          angularVelocity: this.m_angularVelocity,
          fixtures
        };
      };
      Body2._deserialize = function(data, world, restore) {
        var body = new Body2(world, data);
        if (data.fixtures) {
          for (var i = data.fixtures.length - 1; i >= 0; i--) {
            var fixture = restore(Fixture, data.fixtures[i], body);
            body._addFixture(fixture);
          }
        }
        return body;
      };
      Body2.prototype.isWorldLocked = function() {
        return this.m_world && this.m_world.isLocked() ? true : false;
      };
      Body2.prototype.getWorld = function() {
        return this.m_world;
      };
      Body2.prototype.getNext = function() {
        return this.m_next;
      };
      Body2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Body2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Body2.prototype.getFixtureList = function() {
        return this.m_fixtureList;
      };
      Body2.prototype.getJointList = function() {
        return this.m_jointList;
      };
      Body2.prototype.getContactList = function() {
        return this.m_contactList;
      };
      Body2.prototype.isStatic = function() {
        return this.m_type == STATIC;
      };
      Body2.prototype.isDynamic = function() {
        return this.m_type == DYNAMIC;
      };
      Body2.prototype.isKinematic = function() {
        return this.m_type == KINEMATIC;
      };
      Body2.prototype.setStatic = function() {
        this.setType(STATIC);
        return this;
      };
      Body2.prototype.setDynamic = function() {
        this.setType(DYNAMIC);
        return this;
      };
      Body2.prototype.setKinematic = function() {
        this.setType(KINEMATIC);
        return this;
      };
      Body2.prototype.getType = function() {
        return this.m_type;
      };
      Body2.prototype.setType = function(type) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_type == type) {
          return;
        }
        this.m_type = type;
        this.resetMassData();
        if (this.m_type == STATIC) {
          this.m_linearVelocity.setZero();
          this.m_angularVelocity = 0;
          this.m_sweep.forward();
          this.synchronizeFixtures();
        }
        this.setAwake(true);
        this.m_force.setZero();
        this.m_torque = 0;
        var ce = this.m_contactList;
        while (ce) {
          var ce0 = ce;
          ce = ce.next;
          this.m_world.destroyContact(ce0.contact);
        }
        this.m_contactList = null;
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          for (var i = 0; i < f.m_proxyCount; ++i) {
            broadPhase.touchProxy(f.m_proxies[i].proxyId);
          }
        }
      };
      Body2.prototype.isBullet = function() {
        return this.m_bulletFlag;
      };
      Body2.prototype.setBullet = function(flag) {
        this.m_bulletFlag = !!flag;
      };
      Body2.prototype.isSleepingAllowed = function() {
        return this.m_autoSleepFlag;
      };
      Body2.prototype.setSleepingAllowed = function(flag) {
        this.m_autoSleepFlag = !!flag;
        if (this.m_autoSleepFlag == false) {
          this.setAwake(true);
        }
      };
      Body2.prototype.isAwake = function() {
        return this.m_awakeFlag;
      };
      Body2.prototype.setAwake = function(flag) {
        if (flag) {
          this.m_awakeFlag = true;
          this.m_sleepTime = 0;
        } else {
          this.m_awakeFlag = false;
          this.m_sleepTime = 0;
          this.m_linearVelocity.setZero();
          this.m_angularVelocity = 0;
          this.m_force.setZero();
          this.m_torque = 0;
        }
      };
      Body2.prototype.isActive = function() {
        return this.m_activeFlag;
      };
      Body2.prototype.setActive = function(flag) {
        if (flag == this.m_activeFlag) {
          return;
        }
        this.m_activeFlag = !!flag;
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          for (var f = this.m_fixtureList; f; f = f.m_next) {
            f.createProxies(broadPhase, this.m_xf);
          }
          this.m_world.m_newFixture = true;
        } else {
          var broadPhase = this.m_world.m_broadPhase;
          for (var f = this.m_fixtureList; f; f = f.m_next) {
            f.destroyProxies(broadPhase);
          }
          var ce = this.m_contactList;
          while (ce) {
            var ce0 = ce;
            ce = ce.next;
            this.m_world.destroyContact(ce0.contact);
          }
          this.m_contactList = null;
        }
      };
      Body2.prototype.isFixedRotation = function() {
        return this.m_fixedRotationFlag;
      };
      Body2.prototype.setFixedRotation = function(flag) {
        if (this.m_fixedRotationFlag == flag) {
          return;
        }
        this.m_fixedRotationFlag = !!flag;
        this.m_angularVelocity = 0;
        this.resetMassData();
      };
      Body2.prototype.getTransform = function() {
        return this.m_xf;
      };
      Body2.prototype.setTransform = function(a2, b2) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (typeof b2 === "number") {
          this.m_xf.setNum(a2, b2);
        } else {
          this.m_xf.setTransform(a2);
        }
        this.m_sweep.setTransform(this.m_xf);
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          f.synchronize(broadPhase, this.m_xf, this.m_xf);
        }
        this.setAwake(true);
      };
      Body2.prototype.synchronizeTransform = function() {
        this.m_sweep.getTransform(this.m_xf, 1);
      };
      Body2.prototype.synchronizeFixtures = function() {
        this.m_sweep.getTransform(xf$2, 0);
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          f.synchronize(broadPhase, xf$2, this.m_xf);
        }
      };
      Body2.prototype.advance = function(alpha) {
        this.m_sweep.advance(alpha);
        copyVec2(this.m_sweep.c, this.m_sweep.c0);
        this.m_sweep.a = this.m_sweep.a0;
        this.m_sweep.getTransform(this.m_xf, 1);
      };
      Body2.prototype.getPosition = function() {
        return this.m_xf.p;
      };
      Body2.prototype.setPosition = function(p) {
        this.setTransform(p, this.m_sweep.a);
      };
      Body2.prototype.getAngle = function() {
        return this.m_sweep.a;
      };
      Body2.prototype.setAngle = function(angle) {
        this.setTransform(this.m_xf.p, angle);
      };
      Body2.prototype.getWorldCenter = function() {
        return this.m_sweep.c;
      };
      Body2.prototype.getLocalCenter = function() {
        return this.m_sweep.localCenter;
      };
      Body2.prototype.getLinearVelocity = function() {
        return this.m_linearVelocity;
      };
      Body2.prototype.getLinearVelocityFromWorldPoint = function(worldPoint) {
        var localCenter2 = Vec2.sub(worldPoint, this.m_sweep.c);
        return Vec2.add(this.m_linearVelocity, Vec2.crossNumVec2(this.m_angularVelocity, localCenter2));
      };
      Body2.prototype.getLinearVelocityFromLocalPoint = function(localPoint) {
        return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(localPoint));
      };
      Body2.prototype.setLinearVelocity = function(v3) {
        if (this.m_type == STATIC) {
          return;
        }
        if (Vec2.dot(v3, v3) > 0) {
          this.setAwake(true);
        }
        this.m_linearVelocity.setVec2(v3);
      };
      Body2.prototype.getAngularVelocity = function() {
        return this.m_angularVelocity;
      };
      Body2.prototype.setAngularVelocity = function(w) {
        if (this.m_type == STATIC) {
          return;
        }
        if (w * w > 0) {
          this.setAwake(true);
        }
        this.m_angularVelocity = w;
      };
      Body2.prototype.getLinearDamping = function() {
        return this.m_linearDamping;
      };
      Body2.prototype.setLinearDamping = function(linearDamping) {
        this.m_linearDamping = linearDamping;
      };
      Body2.prototype.getAngularDamping = function() {
        return this.m_angularDamping;
      };
      Body2.prototype.setAngularDamping = function(angularDamping) {
        this.m_angularDamping = angularDamping;
      };
      Body2.prototype.getGravityScale = function() {
        return this.m_gravityScale;
      };
      Body2.prototype.setGravityScale = function(scale) {
        this.m_gravityScale = scale;
      };
      Body2.prototype.getMass = function() {
        return this.m_mass;
      };
      Body2.prototype.getInertia = function() {
        return this.m_I + this.m_mass * Vec2.dot(this.m_sweep.localCenter, this.m_sweep.localCenter);
      };
      Body2.prototype.getMassData = function(data) {
        data.mass = this.m_mass;
        data.I = this.getInertia();
        copyVec2(data.center, this.m_sweep.localCenter);
      };
      Body2.prototype.resetMassData = function() {
        this.m_mass = 0;
        this.m_invMass = 0;
        this.m_I = 0;
        this.m_invI = 0;
        zeroVec2(this.m_sweep.localCenter);
        if (this.isStatic() || this.isKinematic()) {
          copyVec2(this.m_sweep.c0, this.m_xf.p);
          copyVec2(this.m_sweep.c, this.m_xf.p);
          this.m_sweep.a0 = this.m_sweep.a;
          return;
        }
        zeroVec2(localCenter);
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          if (f.m_density == 0) {
            continue;
          }
          var massData = {
            mass: 0,
            center: vec2(0, 0),
            I: 0
          };
          f.getMassData(massData);
          this.m_mass += massData.mass;
          plusScaleVec2(localCenter, massData.mass, massData.center);
          this.m_I += massData.I;
        }
        if (this.m_mass > 0) {
          this.m_invMass = 1 / this.m_mass;
          scaleVec2(localCenter, this.m_invMass, localCenter);
        } else {
          this.m_mass = 1;
          this.m_invMass = 1;
        }
        if (this.m_I > 0 && this.m_fixedRotationFlag == false) {
          this.m_I -= this.m_mass * dotVec2(localCenter, localCenter);
          this.m_invI = 1 / this.m_I;
        } else {
          this.m_I = 0;
          this.m_invI = 0;
        }
        copyVec2(oldCenter, this.m_sweep.c);
        this.m_sweep.setLocalCenter(localCenter, this.m_xf);
        subVec2(shift, this.m_sweep.c, oldCenter);
        crossNumVec2(temp$6, this.m_angularVelocity, shift);
        plusVec2(this.m_linearVelocity, temp$6);
      };
      Body2.prototype.setMassData = function(massData) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        this.m_invMass = 0;
        this.m_I = 0;
        this.m_invI = 0;
        this.m_mass = massData.mass;
        if (this.m_mass <= 0) {
          this.m_mass = 1;
        }
        this.m_invMass = 1 / this.m_mass;
        if (massData.I > 0 && this.m_fixedRotationFlag == false) {
          this.m_I = massData.I - this.m_mass * dotVec2(massData.center, massData.center);
          this.m_invI = 1 / this.m_I;
        }
        copyVec2(oldCenter, this.m_sweep.c);
        this.m_sweep.setLocalCenter(massData.center, this.m_xf);
        subVec2(shift, this.m_sweep.c, oldCenter);
        crossNumVec2(temp$6, this.m_angularVelocity, shift);
        plusVec2(this.m_linearVelocity, temp$6);
      };
      Body2.prototype.applyForce = function(force, point2, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_force.add(force);
          this.m_torque += Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), force);
        }
      };
      Body2.prototype.applyForceToCenter = function(force, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_force.add(force);
        }
      };
      Body2.prototype.applyTorque = function(torque, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_torque += torque;
        }
      };
      Body2.prototype.applyLinearImpulse = function(impulse, point2, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_linearVelocity.addMul(this.m_invMass, impulse);
          this.m_angularVelocity += this.m_invI * Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), impulse);
        }
      };
      Body2.prototype.applyAngularImpulse = function(impulse, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_angularVelocity += this.m_invI * impulse;
        }
      };
      Body2.prototype.shouldCollide = function(that) {
        if (this.m_type != DYNAMIC && that.m_type != DYNAMIC) {
          return false;
        }
        for (var jn = this.m_jointList; jn; jn = jn.next) {
          if (jn.other == that) {
            if (jn.joint.m_collideConnected == false) {
              return false;
            }
          }
        }
        return true;
      };
      Body2.prototype._addFixture = function(fixture) {
        if (this.isWorldLocked() == true) {
          return null;
        }
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          fixture.createProxies(broadPhase, this.m_xf);
        }
        fixture.m_next = this.m_fixtureList;
        this.m_fixtureList = fixture;
        if (fixture.m_density > 0) {
          this.resetMassData();
        }
        this.m_world.m_newFixture = true;
        return fixture;
      };
      Body2.prototype.createFixture = function(shape, fixdef) {
        if (this.isWorldLocked() == true) {
          return null;
        }
        var fixture = new Fixture(this, shape, fixdef);
        this._addFixture(fixture);
        return fixture;
      };
      Body2.prototype.destroyFixture = function(fixture) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_fixtureList === fixture) {
          this.m_fixtureList = fixture.m_next;
        } else {
          var node = this.m_fixtureList;
          while (node != null) {
            if (node.m_next === fixture) {
              node.m_next = fixture.m_next;
              break;
            }
            node = node.m_next;
          }
        }
        var edge = this.m_contactList;
        while (edge) {
          var c2 = edge.contact;
          edge = edge.next;
          var fixtureA = c2.getFixtureA();
          var fixtureB = c2.getFixtureB();
          if (fixture == fixtureA || fixture == fixtureB) {
            this.m_world.destroyContact(c2);
          }
        }
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          fixture.destroyProxies(broadPhase);
        }
        fixture.m_body = null;
        fixture.m_next = null;
        this.m_world.publish("remove-fixture", fixture);
        this.resetMassData();
      };
      Body2.prototype.getWorldPoint = function(localPoint) {
        return Transform.mulVec2(this.m_xf, localPoint);
      };
      Body2.prototype.getWorldVector = function(localVector) {
        return Rot.mulVec2(this.m_xf.q, localVector);
      };
      Body2.prototype.getLocalPoint = function(worldPoint) {
        return Transform.mulTVec2(this.m_xf, worldPoint);
      };
      Body2.prototype.getLocalVector = function(worldVector) {
        return Rot.mulTVec2(this.m_xf.q, worldVector);
      };
      Body2.STATIC = "static";
      Body2.KINEMATIC = "kinematic";
      Body2.DYNAMIC = "dynamic";
      return Body2;
    }()
  );
  var JointEdge = (
    /** @class */
    /* @__PURE__ */ function() {
      function JointEdge2() {
        this.other = null;
        this.joint = null;
        this.prev = null;
        this.next = null;
      }
      return JointEdge2;
    }()
  );
  var Joint = (
    /** @class */
    function() {
      function Joint2(def, bodyA, bodyB) {
        this.m_type = "unknown-joint";
        this.m_prev = null;
        this.m_next = null;
        this.m_edgeA = new JointEdge();
        this.m_edgeB = new JointEdge();
        this.m_islandFlag = false;
        this.style = {};
        this.appData = {};
        bodyA = "bodyA" in def ? def.bodyA : bodyA;
        bodyB = "bodyB" in def ? def.bodyB : bodyB;
        this.m_bodyA = bodyA;
        this.m_bodyB = bodyB;
        this.m_collideConnected = !!def.collideConnected;
        this.m_userData = def.userData;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Joint2.prototype.isActive = function() {
        return this.m_bodyA.isActive() && this.m_bodyB.isActive();
      };
      Joint2.prototype.getType = function() {
        return this.m_type;
      };
      Joint2.prototype.getBodyA = function() {
        return this.m_bodyA;
      };
      Joint2.prototype.getBodyB = function() {
        return this.m_bodyB;
      };
      Joint2.prototype.getNext = function() {
        return this.m_next;
      };
      Joint2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Joint2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Joint2.prototype.getCollideConnected = function() {
        return this.m_collideConnected;
      };
      Joint2.prototype.shiftOrigin = function(newOrigin) {
      };
      Joint2.prototype._resetAnchors = function(def) {
        return this._reset(def);
      };
      return Joint2;
    }()
  );
  var stats = {
    gjkCalls: 0,
    gjkIters: 0,
    gjkMaxIters: 0,
    toiTime: 0,
    toiMaxTime: 0,
    toiCalls: 0,
    toiIters: 0,
    toiMaxIters: 0,
    toiRootIters: 0,
    toiMaxRootIters: 0,
    toString: function(newline) {
      newline = typeof newline === "string" ? newline : "\n";
      var string = "";
      for (var name_1 in this) {
        if (typeof this[name_1] !== "function" && typeof this[name_1] !== "object") {
          string += name_1 + ": " + this[name_1] + newline;
        }
      }
      return string;
    }
  };
  var now = function() {
    return Date.now();
  };
  var diff = function(time) {
    return Date.now() - time;
  };
  const Timer = {
    now,
    diff
  };
  var math_max$4 = Math.max;
  var temp$5 = vec2(0, 0);
  var normal$4 = vec2(0, 0);
  var e12 = vec2(0, 0);
  var e13 = vec2(0, 0);
  var e23 = vec2(0, 0);
  var temp1 = vec2(0, 0);
  var temp2 = vec2(0, 0);
  stats.gjkCalls = 0;
  stats.gjkIters = 0;
  stats.gjkMaxIters = 0;
  var DistanceInput = (
    /** @class */
    function() {
      function DistanceInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.transformA = Transform.identity();
        this.transformB = Transform.identity();
        this.useRadii = false;
      }
      DistanceInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.transformA.setIdentity();
        this.transformB.setIdentity();
        this.useRadii = false;
      };
      return DistanceInput2;
    }()
  );
  var DistanceOutput = (
    /** @class */
    function() {
      function DistanceOutput2() {
        this.pointA = vec2(0, 0);
        this.pointB = vec2(0, 0);
        this.distance = 0;
        this.iterations = 0;
      }
      DistanceOutput2.prototype.recycle = function() {
        zeroVec2(this.pointA);
        zeroVec2(this.pointB);
        this.distance = 0;
        this.iterations = 0;
      };
      return DistanceOutput2;
    }()
  );
  var SimplexCache = (
    /** @class */
    function() {
      function SimplexCache2() {
        this.metric = 0;
        this.indexA = [];
        this.indexB = [];
        this.count = 0;
      }
      SimplexCache2.prototype.recycle = function() {
        this.metric = 0;
        this.indexA.length = 0;
        this.indexB.length = 0;
        this.count = 0;
      };
      return SimplexCache2;
    }()
  );
  var Distance = function(output2, cache2, input2) {
    ++stats.gjkCalls;
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var xfA2 = input2.transformA;
    var xfB2 = input2.transformB;
    simplex.recycle();
    simplex.readCache(cache2, proxyA, xfA2, proxyB, xfB2);
    var vertices = simplex.m_v;
    var k_maxIters = SettingsInternal.maxDistanceIterations;
    var saveA = [];
    var saveB = [];
    var saveCount = 0;
    var iter = 0;
    while (iter < k_maxIters) {
      saveCount = simplex.m_count;
      for (var i = 0; i < saveCount; ++i) {
        saveA[i] = vertices[i].indexA;
        saveB[i] = vertices[i].indexB;
      }
      simplex.solve();
      if (simplex.m_count === 3) {
        break;
      }
      var d2 = simplex.getSearchDirection();
      if (lengthSqrVec2(d2) < EPSILON * EPSILON) {
        break;
      }
      var vertex = vertices[simplex.m_count];
      vertex.indexA = proxyA.getSupport(derotVec2(temp$5, xfA2.q, scaleVec2(temp$5, -1, d2)));
      transformVec2(vertex.wA, xfA2, proxyA.getVertex(vertex.indexA));
      vertex.indexB = proxyB.getSupport(derotVec2(temp$5, xfB2.q, d2));
      transformVec2(vertex.wB, xfB2, proxyB.getVertex(vertex.indexB));
      subVec2(vertex.w, vertex.wB, vertex.wA);
      ++iter;
      ++stats.gjkIters;
      var duplicate = false;
      for (var i = 0; i < saveCount; ++i) {
        if (vertex.indexA === saveA[i] && vertex.indexB === saveB[i]) {
          duplicate = true;
          break;
        }
      }
      if (duplicate) {
        break;
      }
      ++simplex.m_count;
    }
    stats.gjkMaxIters = math_max$4(stats.gjkMaxIters, iter);
    simplex.getWitnessPoints(output2.pointA, output2.pointB);
    output2.distance = distVec2(output2.pointA, output2.pointB);
    output2.iterations = iter;
    simplex.writeCache(cache2);
    if (input2.useRadii) {
      var rA2 = proxyA.m_radius;
      var rB2 = proxyB.m_radius;
      if (output2.distance > rA2 + rB2 && output2.distance > EPSILON) {
        output2.distance -= rA2 + rB2;
        subVec2(normal$4, output2.pointB, output2.pointA);
        normalizeVec2(normal$4);
        plusScaleVec2(output2.pointA, rA2, normal$4);
        minusScaleVec2(output2.pointB, rB2, normal$4);
      } else {
        var p = subVec2(temp$5, output2.pointA, output2.pointB);
        copyVec2(output2.pointA, p);
        copyVec2(output2.pointB, p);
        output2.distance = 0;
      }
    }
  };
  var DistanceProxy = (
    /** @class */
    function() {
      function DistanceProxy2() {
        this.m_vertices = [];
        this.m_count = 0;
        this.m_radius = 0;
      }
      DistanceProxy2.prototype.recycle = function() {
        this.m_vertices.length = 0;
        this.m_count = 0;
        this.m_radius = 0;
      };
      DistanceProxy2.prototype.getVertexCount = function() {
        return this.m_count;
      };
      DistanceProxy2.prototype.getVertex = function(index) {
        return this.m_vertices[index];
      };
      DistanceProxy2.prototype.getSupport = function(d2) {
        var bestIndex = -1;
        var bestValue = -Infinity;
        for (var i = 0; i < this.m_count; ++i) {
          var value = dotVec2(this.m_vertices[i], d2);
          if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
          }
        }
        return bestIndex;
      };
      DistanceProxy2.prototype.getSupportVertex = function(d2) {
        return this.m_vertices[this.getSupport(d2)];
      };
      DistanceProxy2.prototype.set = function(shape, index) {
        shape.computeDistanceProxy(this, index);
      };
      DistanceProxy2.prototype.setVertices = function(vertices, count, radius) {
        this.m_vertices = vertices;
        this.m_count = count;
        this.m_radius = radius;
      };
      return DistanceProxy2;
    }()
  );
  var SimplexVertex = (
    /** @class */
    function() {
      function SimplexVertex2() {
        this.wA = vec2(0, 0);
        this.indexA = 0;
        this.wB = vec2(0, 0);
        this.indexB = 0;
        this.w = vec2(0, 0);
        this.a = 0;
      }
      SimplexVertex2.prototype.recycle = function() {
        this.indexA = 0;
        this.indexB = 0;
        zeroVec2(this.wA);
        zeroVec2(this.wB);
        zeroVec2(this.w);
        this.a = 0;
      };
      SimplexVertex2.prototype.set = function(v3) {
        this.indexA = v3.indexA;
        this.indexB = v3.indexB;
        copyVec2(this.wA, v3.wA);
        copyVec2(this.wB, v3.wB);
        copyVec2(this.w, v3.w);
        this.a = v3.a;
      };
      return SimplexVertex2;
    }()
  );
  var searchDirection_reuse = vec2(0, 0);
  var closestPoint_reuse = vec2(0, 0);
  var Simplex = (
    /** @class */
    function() {
      function Simplex2() {
        this.m_v1 = new SimplexVertex();
        this.m_v2 = new SimplexVertex();
        this.m_v3 = new SimplexVertex();
        this.m_v = [this.m_v1, this.m_v2, this.m_v3];
      }
      Simplex2.prototype.recycle = function() {
        this.m_v1.recycle();
        this.m_v2.recycle();
        this.m_v3.recycle();
        this.m_count = 0;
      };
      Simplex2.prototype.toString = function() {
        if (this.m_count === 3) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y,
            this.m_v2.a,
            this.m_v2.wA.x,
            this.m_v2.wA.y,
            this.m_v2.wB.x,
            this.m_v2.wB.y,
            this.m_v3.a,
            this.m_v3.wA.x,
            this.m_v3.wA.y,
            this.m_v3.wB.x,
            this.m_v3.wB.y
          ].toString();
        } else if (this.m_count === 2) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y,
            this.m_v2.a,
            this.m_v2.wA.x,
            this.m_v2.wA.y,
            this.m_v2.wB.x,
            this.m_v2.wB.y
          ].toString();
        } else if (this.m_count === 1) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y
          ].toString();
        } else {
          return "+" + this.m_count;
        }
      };
      Simplex2.prototype.readCache = function(cache2, proxyA, transformA, proxyB, transformB) {
        this.m_count = cache2.count;
        for (var i = 0; i < this.m_count; ++i) {
          var v3 = this.m_v[i];
          v3.indexA = cache2.indexA[i];
          v3.indexB = cache2.indexB[i];
          var wALocal = proxyA.getVertex(v3.indexA);
          var wBLocal = proxyB.getVertex(v3.indexB);
          transformVec2(v3.wA, transformA, wALocal);
          transformVec2(v3.wB, transformB, wBLocal);
          subVec2(v3.w, v3.wB, v3.wA);
          v3.a = 0;
        }
        if (this.m_count > 1) {
          var metric1 = cache2.metric;
          var metric2 = this.getMetric();
          if (metric2 < 0.5 * metric1 || 2 * metric1 < metric2 || metric2 < EPSILON) {
            this.m_count = 0;
          }
        }
        if (this.m_count === 0) {
          var v3 = this.m_v[0];
          v3.indexA = 0;
          v3.indexB = 0;
          var wALocal = proxyA.getVertex(0);
          var wBLocal = proxyB.getVertex(0);
          transformVec2(v3.wA, transformA, wALocal);
          transformVec2(v3.wB, transformB, wBLocal);
          subVec2(v3.w, v3.wB, v3.wA);
          v3.a = 1;
          this.m_count = 1;
        }
      };
      Simplex2.prototype.writeCache = function(cache2) {
        cache2.metric = this.getMetric();
        cache2.count = this.m_count;
        for (var i = 0; i < this.m_count; ++i) {
          cache2.indexA[i] = this.m_v[i].indexA;
          cache2.indexB[i] = this.m_v[i].indexB;
        }
      };
      Simplex2.prototype.getSearchDirection = function() {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        switch (this.m_count) {
          case 1:
            return setVec2(searchDirection_reuse, -v13.w.x, -v13.w.y);
          case 2: {
            subVec2(e12, v22.w, v13.w);
            var sgn = -crossVec2Vec2(e12, v13.w);
            if (sgn > 0) {
              return setVec2(searchDirection_reuse, -e12.y, e12.x);
            } else {
              return setVec2(searchDirection_reuse, e12.y, -e12.x);
            }
          }
          default:
            return zeroVec2(searchDirection_reuse);
        }
      };
      Simplex2.prototype.getClosestPoint = function() {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        switch (this.m_count) {
          case 0:
            return zeroVec2(closestPoint_reuse);
          case 1:
            return copyVec2(closestPoint_reuse, v13.w);
          case 2:
            return combine2Vec2(closestPoint_reuse, v13.a, v13.w, v22.a, v22.w);
          case 3:
            return zeroVec2(closestPoint_reuse);
          default:
            return zeroVec2(closestPoint_reuse);
        }
      };
      Simplex2.prototype.getWitnessPoints = function(pA2, pB2) {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        var v3 = this.m_v3;
        switch (this.m_count) {
          case 0:
            break;
          case 1:
            copyVec2(pA2, v13.wA);
            copyVec2(pB2, v13.wB);
            break;
          case 2:
            combine2Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA);
            combine2Vec2(pB2, v13.a, v13.wB, v22.a, v22.wB);
            break;
          case 3:
            combine3Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA, v3.a, v3.wA);
            copyVec2(pB2, pA2);
            break;
        }
      };
      Simplex2.prototype.getMetric = function() {
        switch (this.m_count) {
          case 0:
            return 0;
          case 1:
            return 0;
          case 2:
            return distVec2(this.m_v1.w, this.m_v2.w);
          case 3:
            return crossVec2Vec2(subVec2(temp1, this.m_v2.w, this.m_v1.w), subVec2(temp2, this.m_v3.w, this.m_v1.w));
          default:
            return 0;
        }
      };
      Simplex2.prototype.solve = function() {
        switch (this.m_count) {
          case 1:
            break;
          case 2:
            this.solve2();
            break;
          case 3:
            this.solve3();
            break;
        }
      };
      Simplex2.prototype.solve2 = function() {
        var w1 = this.m_v1.w;
        var w2 = this.m_v2.w;
        subVec2(e12, w2, w1);
        var d12_2 = -dotVec2(w1, e12);
        if (d12_2 <= 0) {
          this.m_v1.a = 1;
          this.m_count = 1;
          return;
        }
        var d12_1 = dotVec2(w2, e12);
        if (d12_1 <= 0) {
          this.m_v2.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v2);
          return;
        }
        var inv_d12 = 1 / (d12_1 + d12_2);
        this.m_v1.a = d12_1 * inv_d12;
        this.m_v2.a = d12_2 * inv_d12;
        this.m_count = 2;
      };
      Simplex2.prototype.solve3 = function() {
        var w1 = this.m_v1.w;
        var w2 = this.m_v2.w;
        var w3 = this.m_v3.w;
        subVec2(e12, w2, w1);
        var w1e12 = dotVec2(w1, e12);
        var w2e12 = dotVec2(w2, e12);
        var d12_1 = w2e12;
        var d12_2 = -w1e12;
        subVec2(e13, w3, w1);
        var w1e13 = dotVec2(w1, e13);
        var w3e13 = dotVec2(w3, e13);
        var d13_1 = w3e13;
        var d13_2 = -w1e13;
        subVec2(e23, w3, w2);
        var w2e23 = dotVec2(w2, e23);
        var w3e23 = dotVec2(w3, e23);
        var d23_1 = w3e23;
        var d23_2 = -w2e23;
        var n123 = crossVec2Vec2(e12, e13);
        var d123_1 = n123 * crossVec2Vec2(w2, w3);
        var d123_2 = n123 * crossVec2Vec2(w3, w1);
        var d123_3 = n123 * crossVec2Vec2(w1, w2);
        if (d12_2 <= 0 && d13_2 <= 0) {
          this.m_v1.a = 1;
          this.m_count = 1;
          return;
        }
        if (d12_1 > 0 && d12_2 > 0 && d123_3 <= 0) {
          var inv_d12 = 1 / (d12_1 + d12_2);
          this.m_v1.a = d12_1 * inv_d12;
          this.m_v2.a = d12_2 * inv_d12;
          this.m_count = 2;
          return;
        }
        if (d13_1 > 0 && d13_2 > 0 && d123_2 <= 0) {
          var inv_d13 = 1 / (d13_1 + d13_2);
          this.m_v1.a = d13_1 * inv_d13;
          this.m_v3.a = d13_2 * inv_d13;
          this.m_count = 2;
          this.m_v2.set(this.m_v3);
          return;
        }
        if (d12_1 <= 0 && d23_2 <= 0) {
          this.m_v2.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v2);
          return;
        }
        if (d13_1 <= 0 && d23_1 <= 0) {
          this.m_v3.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v3);
          return;
        }
        if (d23_1 > 0 && d23_2 > 0 && d123_1 <= 0) {
          var inv_d23 = 1 / (d23_1 + d23_2);
          this.m_v2.a = d23_1 * inv_d23;
          this.m_v3.a = d23_2 * inv_d23;
          this.m_count = 2;
          this.m_v1.set(this.m_v3);
          return;
        }
        var inv_d123 = 1 / (d123_1 + d123_2 + d123_3);
        this.m_v1.a = d123_1 * inv_d123;
        this.m_v2.a = d123_2 * inv_d123;
        this.m_v3.a = d123_3 * inv_d123;
        this.m_count = 3;
      };
      return Simplex2;
    }()
  );
  var simplex = new Simplex();
  var input$1 = new DistanceInput();
  var cache$1 = new SimplexCache();
  var output$1 = new DistanceOutput();
  var testOverlap = function(shapeA, indexA, shapeB, indexB, xfA2, xfB2) {
    input$1.recycle();
    input$1.proxyA.set(shapeA, indexA);
    input$1.proxyB.set(shapeB, indexB);
    copyTransform(input$1.transformA, xfA2);
    copyTransform(input$1.transformB, xfB2);
    input$1.useRadii = true;
    output$1.recycle();
    cache$1.recycle();
    Distance(output$1, cache$1, input$1);
    return output$1.distance < 10 * EPSILON;
  };
  Distance.testOverlap = testOverlap;
  Distance.Input = DistanceInput;
  Distance.Output = DistanceOutput;
  Distance.Proxy = DistanceProxy;
  Distance.Cache = SimplexCache;
  var ShapeCastInput = (
    /** @class */
    function() {
      function ShapeCastInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.transformA = Transform.identity();
        this.transformB = Transform.identity();
        this.translationB = Vec2.zero();
      }
      ShapeCastInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.transformA.setIdentity();
        this.transformB.setIdentity();
        zeroVec2(this.translationB);
      };
      return ShapeCastInput2;
    }()
  );
  var ShapeCastOutput = (
    /** @class */
    /* @__PURE__ */ function() {
      function ShapeCastOutput2() {
        this.point = Vec2.zero();
        this.normal = Vec2.zero();
        this.lambda = 1;
        this.iterations = 0;
      }
      return ShapeCastOutput2;
    }()
  );
  var ShapeCast = function(output2, input2) {
    output2.iterations = 0;
    output2.lambda = 1;
    output2.normal.setZero();
    output2.point.setZero();
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var radiusA = math_max$4(proxyA.m_radius, SettingsInternal.polygonRadius);
    var radiusB = math_max$4(proxyB.m_radius, SettingsInternal.polygonRadius);
    var radius = radiusA + radiusB;
    var xfA2 = input2.transformA;
    var xfB2 = input2.transformB;
    var r = input2.translationB;
    var n2 = Vec2.zero();
    var lambda = 0;
    var simplex2 = new Simplex();
    simplex2.m_count = 0;
    var vertices = simplex2.m_v;
    var indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(r)));
    var wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));
    var indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, r));
    var wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));
    var v3 = Vec2.sub(wA, wB);
    var sigma = math_max$4(SettingsInternal.polygonRadius, radius - SettingsInternal.polygonRadius);
    var tolerance = 0.5 * SettingsInternal.linearSlop;
    var k_maxIters = 20;
    var iter = 0;
    while (iter < k_maxIters && v3.length() - sigma > tolerance) {
      output2.iterations += 1;
      indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(v3)));
      wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));
      indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, v3));
      wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));
      var p = Vec2.sub(wA, wB);
      v3.normalize();
      var vp = Vec2.dot(v3, p);
      var vr = Vec2.dot(v3, r);
      if (vp - sigma > lambda * vr) {
        if (vr <= 0) {
          return false;
        }
        lambda = (vp - sigma) / vr;
        if (lambda > 1) {
          return false;
        }
        n2.setMul(-1, v3);
        simplex2.m_count = 0;
      }
      var vertex = vertices[simplex2.m_count];
      vertex.indexA = indexB;
      vertex.wA = Vec2.combine(1, wB, lambda, r);
      vertex.indexB = indexA;
      vertex.wB = wA;
      vertex.w = Vec2.sub(vertex.wB, vertex.wA);
      vertex.a = 1;
      simplex2.m_count += 1;
      switch (simplex2.m_count) {
        case 1:
          break;
        case 2:
          simplex2.solve2();
          break;
        case 3:
          simplex2.solve3();
          break;
      }
      if (simplex2.m_count == 3) {
        return false;
      }
      v3.setVec2(simplex2.getClosestPoint());
      ++iter;
    }
    if (iter == 0) {
      return false;
    }
    var pointA2 = Vec2.zero();
    var pointB2 = Vec2.zero();
    simplex2.getWitnessPoints(pointB2, pointA2);
    if (v3.lengthSquared() > 0) {
      n2.setMul(-1, v3);
      n2.normalize();
    }
    output2.point = Vec2.combine(1, pointA2, radiusA, n2);
    output2.normal = n2;
    output2.lambda = lambda;
    output2.iterations = iter;
    return true;
  };
  var math_abs$7 = Math.abs;
  var math_max$3 = Math.max;
  var TOIInput = (
    /** @class */
    function() {
      function TOIInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.sweepA = new Sweep();
        this.sweepB = new Sweep();
      }
      TOIInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.sweepA.recycle();
        this.sweepB.recycle();
        this.tMax = -1;
      };
      return TOIInput2;
    }()
  );
  exports2.TOIOutputState = void 0;
  (function(TOIOutputState2) {
    TOIOutputState2[TOIOutputState2["e_unset"] = -1] = "e_unset";
    TOIOutputState2[TOIOutputState2["e_unknown"] = 0] = "e_unknown";
    TOIOutputState2[TOIOutputState2["e_failed"] = 1] = "e_failed";
    TOIOutputState2[TOIOutputState2["e_overlapped"] = 2] = "e_overlapped";
    TOIOutputState2[TOIOutputState2["e_touching"] = 3] = "e_touching";
    TOIOutputState2[TOIOutputState2["e_separated"] = 4] = "e_separated";
  })(exports2.TOIOutputState || (exports2.TOIOutputState = {}));
  var TOIOutput = (
    /** @class */
    function() {
      function TOIOutput2() {
        this.state = exports2.TOIOutputState.e_unset;
        this.t = -1;
      }
      TOIOutput2.prototype.recycle = function() {
        this.state = exports2.TOIOutputState.e_unset;
        this.t = -1;
      };
      return TOIOutput2;
    }()
  );
  stats.toiTime = 0;
  stats.toiMaxTime = 0;
  stats.toiCalls = 0;
  stats.toiIters = 0;
  stats.toiMaxIters = 0;
  stats.toiRootIters = 0;
  stats.toiMaxRootIters = 0;
  var distanceInput = new DistanceInput();
  var distanceOutput = new DistanceOutput();
  var cache = new SimplexCache();
  var xfA$1 = transform(0, 0, 0);
  var xfB$1 = transform(0, 0, 0);
  var temp$4 = vec2(0, 0);
  var pointA$2 = vec2(0, 0);
  var pointB$2 = vec2(0, 0);
  var normal$3 = vec2(0, 0);
  var axisA = vec2(0, 0);
  var axisB = vec2(0, 0);
  var localPointA = vec2(0, 0);
  var localPointB = vec2(0, 0);
  var TimeOfImpact = function(output2, input2) {
    var timer = Timer.now();
    ++stats.toiCalls;
    output2.state = exports2.TOIOutputState.e_unknown;
    output2.t = input2.tMax;
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var sweepA = input2.sweepA;
    var sweepB = input2.sweepB;
    sweepA.normalize();
    sweepB.normalize();
    var tMax = input2.tMax;
    var totalRadius = proxyA.m_radius + proxyB.m_radius;
    var target = math_max$3(SettingsInternal.linearSlop, totalRadius - 3 * SettingsInternal.linearSlop);
    var tolerance = 0.25 * SettingsInternal.linearSlop;
    var t1 = 0;
    var k_maxIterations = SettingsInternal.maxTOIIterations;
    var iter = 0;
    cache.recycle();
    distanceInput.proxyA.setVertices(proxyA.m_vertices, proxyA.m_count, proxyA.m_radius);
    distanceInput.proxyB.setVertices(proxyB.m_vertices, proxyB.m_count, proxyB.m_radius);
    distanceInput.useRadii = false;
    while (true) {
      sweepA.getTransform(xfA$1, t1);
      sweepB.getTransform(xfB$1, t1);
      copyTransform(distanceInput.transformA, xfA$1);
      copyTransform(distanceInput.transformB, xfB$1);
      Distance(distanceOutput, cache, distanceInput);
      if (distanceOutput.distance <= 0) {
        output2.state = exports2.TOIOutputState.e_overlapped;
        output2.t = 0;
        break;
      }
      if (distanceOutput.distance < target + tolerance) {
        output2.state = exports2.TOIOutputState.e_touching;
        output2.t = t1;
        break;
      }
      separationFunction.initialize(cache, proxyA, sweepA, proxyB, sweepB, t1);
      var done = false;
      var t2 = tMax;
      var pushBackIter = 0;
      while (true) {
        var s2 = separationFunction.findMinSeparation(t2);
        if (s2 > target + tolerance) {
          output2.state = exports2.TOIOutputState.e_separated;
          output2.t = tMax;
          done = true;
          break;
        }
        if (s2 > target - tolerance) {
          t1 = t2;
          break;
        }
        var s1 = separationFunction.evaluate(t1);
        if (s1 < target - tolerance) {
          output2.state = exports2.TOIOutputState.e_failed;
          output2.t = t1;
          done = true;
          break;
        }
        if (s1 <= target + tolerance) {
          output2.state = exports2.TOIOutputState.e_touching;
          output2.t = t1;
          done = true;
          break;
        }
        var rootIterCount = 0;
        var a1 = t1;
        var a2 = t2;
        while (true) {
          var t = void 0;
          if (rootIterCount & 1) {
            t = a1 + (target - s1) * (a2 - a1) / (s2 - s1);
          } else {
            t = 0.5 * (a1 + a2);
          }
          ++rootIterCount;
          ++stats.toiRootIters;
          var s3 = separationFunction.evaluate(t);
          if (math_abs$7(s3 - target) < tolerance) {
            t2 = t;
            break;
          }
          if (s3 > target) {
            a1 = t;
            s1 = s3;
          } else {
            a2 = t;
            s2 = s3;
          }
          if (rootIterCount === 50) {
            break;
          }
        }
        stats.toiMaxRootIters = math_max$3(stats.toiMaxRootIters, rootIterCount);
        ++pushBackIter;
        if (pushBackIter === SettingsInternal.maxPolygonVertices) {
          break;
        }
      }
      ++iter;
      ++stats.toiIters;
      if (done) {
        break;
      }
      if (iter === k_maxIterations) {
        output2.state = exports2.TOIOutputState.e_failed;
        output2.t = t1;
        break;
      }
    }
    stats.toiMaxIters = math_max$3(stats.toiMaxIters, iter);
    var time = Timer.diff(timer);
    stats.toiMaxTime = math_max$3(stats.toiMaxTime, time);
    stats.toiTime += time;
    separationFunction.recycle();
  };
  var SeparationFunctionType;
  (function(SeparationFunctionType2) {
    SeparationFunctionType2[SeparationFunctionType2["e_unset"] = -1] = "e_unset";
    SeparationFunctionType2[SeparationFunctionType2["e_points"] = 1] = "e_points";
    SeparationFunctionType2[SeparationFunctionType2["e_faceA"] = 2] = "e_faceA";
    SeparationFunctionType2[SeparationFunctionType2["e_faceB"] = 3] = "e_faceB";
  })(SeparationFunctionType || (SeparationFunctionType = {}));
  var SeparationFunction = (
    /** @class */
    function() {
      function SeparationFunction2() {
        this.m_proxyA = null;
        this.m_proxyB = null;
        this.m_sweepA = null;
        this.m_sweepB = null;
        this.m_type = SeparationFunctionType.e_unset;
        this.m_localPoint = vec2(0, 0);
        this.m_axis = vec2(0, 0);
        this.indexA = -1;
        this.indexB = -1;
      }
      SeparationFunction2.prototype.recycle = function() {
        this.m_proxyA = null;
        this.m_proxyB = null;
        this.m_sweepA = null;
        this.m_sweepB = null;
        this.m_type = SeparationFunctionType.e_unset;
        zeroVec2(this.m_localPoint);
        zeroVec2(this.m_axis);
        this.indexA = -1;
        this.indexB = -1;
      };
      SeparationFunction2.prototype.initialize = function(cache2, proxyA, sweepA, proxyB, sweepB, t1) {
        var count = cache2.count;
        this.m_proxyA = proxyA;
        this.m_proxyB = proxyB;
        this.m_sweepA = sweepA;
        this.m_sweepB = sweepB;
        this.m_sweepA.getTransform(xfA$1, t1);
        this.m_sweepB.getTransform(xfB$1, t1);
        if (count === 1) {
          this.m_type = SeparationFunctionType.e_points;
          var localPointA_1 = this.m_proxyA.getVertex(cache2.indexA[0]);
          var localPointB_1 = this.m_proxyB.getVertex(cache2.indexB[0]);
          transformVec2(pointA$2, xfA$1, localPointA_1);
          transformVec2(pointB$2, xfB$1, localPointB_1);
          subVec2(this.m_axis, pointB$2, pointA$2);
          var s2 = normalizeVec2Length(this.m_axis);
          return s2;
        } else if (cache2.indexA[0] === cache2.indexA[1]) {
          this.m_type = SeparationFunctionType.e_faceB;
          var localPointB1 = proxyB.getVertex(cache2.indexB[0]);
          var localPointB2 = proxyB.getVertex(cache2.indexB[1]);
          crossVec2Num(this.m_axis, subVec2(temp$4, localPointB2, localPointB1), 1);
          normalizeVec2(this.m_axis);
          rotVec2(normal$3, xfB$1.q, this.m_axis);
          combine2Vec2(this.m_localPoint, 0.5, localPointB1, 0.5, localPointB2);
          transformVec2(pointB$2, xfB$1, this.m_localPoint);
          var localPointA_2 = proxyA.getVertex(cache2.indexA[0]);
          var pointA_1 = Transform.mulVec2(xfA$1, localPointA_2);
          var s2 = dotVec2(pointA_1, normal$3) - dotVec2(pointB$2, normal$3);
          if (s2 < 0) {
            negVec2(this.m_axis);
            s2 = -s2;
          }
          return s2;
        } else {
          this.m_type = SeparationFunctionType.e_faceA;
          var localPointA1 = this.m_proxyA.getVertex(cache2.indexA[0]);
          var localPointA2 = this.m_proxyA.getVertex(cache2.indexA[1]);
          crossVec2Num(this.m_axis, subVec2(temp$4, localPointA2, localPointA1), 1);
          normalizeVec2(this.m_axis);
          rotVec2(normal$3, xfA$1.q, this.m_axis);
          combine2Vec2(this.m_localPoint, 0.5, localPointA1, 0.5, localPointA2);
          transformVec2(pointA$2, xfA$1, this.m_localPoint);
          var localPointB_2 = this.m_proxyB.getVertex(cache2.indexB[0]);
          transformVec2(pointB$2, xfB$1, localPointB_2);
          var s2 = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);
          if (s2 < 0) {
            negVec2(this.m_axis);
            s2 = -s2;
          }
          return s2;
        }
      };
      SeparationFunction2.prototype.compute = function(find, t) {
        this.m_sweepA.getTransform(xfA$1, t);
        this.m_sweepB.getTransform(xfB$1, t);
        switch (this.m_type) {
          case SeparationFunctionType.e_points: {
            if (find) {
              derotVec2(axisA, xfA$1.q, this.m_axis);
              derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, this.m_axis));
              this.indexA = this.m_proxyA.getSupport(axisA);
              this.indexB = this.m_proxyB.getSupport(axisB);
            }
            copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));
            copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));
            transformVec2(pointA$2, xfA$1, localPointA);
            transformVec2(pointB$2, xfB$1, localPointB);
            var sep = dotVec2(pointB$2, this.m_axis) - dotVec2(pointA$2, this.m_axis);
            return sep;
          }
          case SeparationFunctionType.e_faceA: {
            rotVec2(normal$3, xfA$1.q, this.m_axis);
            transformVec2(pointA$2, xfA$1, this.m_localPoint);
            if (find) {
              derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, normal$3));
              this.indexA = -1;
              this.indexB = this.m_proxyB.getSupport(axisB);
            }
            copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));
            transformVec2(pointB$2, xfB$1, localPointB);
            var sep = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);
            return sep;
          }
          case SeparationFunctionType.e_faceB: {
            rotVec2(normal$3, xfB$1.q, this.m_axis);
            transformVec2(pointB$2, xfB$1, this.m_localPoint);
            if (find) {
              derotVec2(axisA, xfA$1.q, scaleVec2(temp$4, -1, normal$3));
              this.indexB = -1;
              this.indexA = this.m_proxyA.getSupport(axisA);
            }
            copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));
            transformVec2(pointA$2, xfA$1, localPointA);
            var sep = dotVec2(pointA$2, normal$3) - dotVec2(pointB$2, normal$3);
            return sep;
          }
          default:
            if (find) {
              this.indexA = -1;
              this.indexB = -1;
            }
            return 0;
        }
      };
      SeparationFunction2.prototype.findMinSeparation = function(t) {
        return this.compute(true, t);
      };
      SeparationFunction2.prototype.evaluate = function(t) {
        return this.compute(false, t);
      };
      return SeparationFunction2;
    }()
  );
  var separationFunction = new SeparationFunction();
  TimeOfImpact.Input = TOIInput;
  TimeOfImpact.Output = TOIOutput;
  var math_abs$6 = Math.abs;
  var math_sqrt$3 = Math.sqrt;
  var math_min$5 = Math.min;
  var TimeStep = (
    /** @class */
    function() {
      function TimeStep2() {
        this.dt = 0;
        this.inv_dt = 0;
        this.velocityIterations = 0;
        this.positionIterations = 0;
        this.warmStarting = false;
        this.blockSolve = true;
        this.inv_dt0 = 0;
        this.dtRatio = 1;
      }
      TimeStep2.prototype.reset = function(dt) {
        if (this.dt > 0) {
          this.inv_dt0 = this.inv_dt;
        }
        this.dt = dt;
        this.inv_dt = dt == 0 ? 0 : 1 / dt;
        this.dtRatio = dt * this.inv_dt0;
      };
      return TimeStep2;
    }()
  );
  var s_subStep = new TimeStep();
  var c = vec2(0, 0);
  var v = vec2(0, 0);
  var translation = vec2(0, 0);
  var input = new TOIInput();
  var output = new TOIOutput();
  var backup = new Sweep();
  var backup1 = new Sweep();
  var backup2 = new Sweep();
  var ContactImpulse = (
    /** @class */
    function() {
      function ContactImpulse2(contact) {
        this.contact = contact;
        this.normals = [];
        this.tangents = [];
      }
      ContactImpulse2.prototype.recycle = function() {
        this.normals.length = 0;
        this.tangents.length = 0;
      };
      Object.defineProperty(ContactImpulse2.prototype, "normalImpulses", {
        get: function() {
          var contact = this.contact;
          var normals = this.normals;
          normals.length = 0;
          for (var p = 0; p < contact.v_points.length; ++p) {
            normals.push(contact.v_points[p].normalImpulse);
          }
          return normals;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(ContactImpulse2.prototype, "tangentImpulses", {
        get: function() {
          var contact = this.contact;
          var tangents = this.tangents;
          tangents.length = 0;
          for (var p = 0; p < contact.v_points.length; ++p) {
            tangents.push(contact.v_points[p].tangentImpulse);
          }
          return tangents;
        },
        enumerable: false,
        configurable: true
      });
      return ContactImpulse2;
    }()
  );
  var Solver = (
    /** @class */
    function() {
      function Solver2(world) {
        this.m_world = world;
        this.m_stack = [];
        this.m_bodies = [];
        this.m_contacts = [];
        this.m_joints = [];
      }
      Solver2.prototype.clear = function() {
        this.m_stack.length = 0;
        this.m_bodies.length = 0;
        this.m_contacts.length = 0;
        this.m_joints.length = 0;
      };
      Solver2.prototype.addBody = function(body) {
        this.m_bodies.push(body);
      };
      Solver2.prototype.addContact = function(contact) {
        this.m_contacts.push(contact);
      };
      Solver2.prototype.addJoint = function(joint) {
        this.m_joints.push(joint);
      };
      Solver2.prototype.solveWorld = function(step) {
        var world = this.m_world;
        for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {
          b2.m_islandFlag = false;
        }
        for (var c_1 = world.m_contactList; c_1; c_1 = c_1.m_next) {
          c_1.m_islandFlag = false;
        }
        for (var j = world.m_jointList; j; j = j.m_next) {
          j.m_islandFlag = false;
        }
        var stack = this.m_stack;
        for (var seed = world.m_bodyList; seed; seed = seed.m_next) {
          if (seed.m_islandFlag) {
            continue;
          }
          if (seed.isAwake() == false || seed.isActive() == false) {
            continue;
          }
          if (seed.isStatic()) {
            continue;
          }
          this.clear();
          stack.push(seed);
          seed.m_islandFlag = true;
          while (stack.length > 0) {
            var b2 = stack.pop();
            this.addBody(b2);
            b2.m_awakeFlag = true;
            if (b2.isStatic()) {
              continue;
            }
            for (var ce = b2.m_contactList; ce; ce = ce.next) {
              var contact = ce.contact;
              if (contact.m_islandFlag) {
                continue;
              }
              if (contact.isEnabled() == false || contact.isTouching() == false) {
                continue;
              }
              var sensorA = contact.m_fixtureA.m_isSensor;
              var sensorB = contact.m_fixtureB.m_isSensor;
              if (sensorA || sensorB) {
                continue;
              }
              this.addContact(contact);
              contact.m_islandFlag = true;
              var other = ce.other;
              if (other.m_islandFlag) {
                continue;
              }
              stack.push(other);
              other.m_islandFlag = true;
            }
            for (var je = b2.m_jointList; je; je = je.next) {
              if (je.joint.m_islandFlag == true) {
                continue;
              }
              var other = je.other;
              if (other.isActive() == false) {
                continue;
              }
              this.addJoint(je.joint);
              je.joint.m_islandFlag = true;
              if (other.m_islandFlag) {
                continue;
              }
              stack.push(other);
              other.m_islandFlag = true;
            }
          }
          this.solveIsland(step);
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var b2 = this.m_bodies[i];
            if (b2.isStatic()) {
              b2.m_islandFlag = false;
            }
          }
        }
      };
      Solver2.prototype.solveIsland = function(step) {
        var world = this.m_world;
        var gravity = world.m_gravity;
        var allowSleep = world.m_allowSleep;
        var h = step.dt;
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.m_sweep.c);
          var a2 = body.m_sweep.a;
          copyVec2(v, body.m_linearVelocity);
          var w = body.m_angularVelocity;
          copyVec2(body.m_sweep.c0, body.m_sweep.c);
          body.m_sweep.a0 = body.m_sweep.a;
          if (body.isDynamic()) {
            plusScaleVec2(v, h * body.m_gravityScale, gravity);
            plusScaleVec2(v, h * body.m_invMass, body.m_force);
            w += h * body.m_invI * body.m_torque;
            scaleVec2(v, 1 / (1 + h * body.m_linearDamping), v);
            w *= 1 / (1 + h * body.m_angularDamping);
          }
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initConstraint(step);
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initVelocityConstraint(step);
        }
        if (step.warmStarting) {
          for (var i = 0; i < this.m_contacts.length; ++i) {
            var contact = this.m_contacts[i];
            contact.warmStartConstraint(step);
          }
        }
        for (var i = 0; i < this.m_joints.length; ++i) {
          var joint = this.m_joints[i];
          joint.initVelocityConstraints(step);
        }
        for (var i = 0; i < step.velocityIterations; ++i) {
          for (var j = 0; j < this.m_joints.length; ++j) {
            var joint = this.m_joints[j];
            joint.solveVelocityConstraints(step);
          }
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            contact.solveVelocityConstraint(step);
          }
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.storeConstraintImpulses(step);
        }
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.c_position.c);
          var a2 = body.c_position.a;
          copyVec2(v, body.c_velocity.v);
          var w = body.c_velocity.w;
          scaleVec2(translation, h, v);
          var translationLengthSqr = lengthSqrVec2(translation);
          if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {
            var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);
            mulVec2(v, ratio);
          }
          var rotation2 = h * w;
          if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {
            var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);
            w *= ratio;
          }
          plusScaleVec2(c, h, v);
          a2 += h * w;
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
        }
        var positionSolved = false;
        for (var i = 0; i < step.positionIterations; ++i) {
          var minSeparation = 0;
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            var separation = contact.solvePositionConstraint(step);
            minSeparation = math_min$5(minSeparation, separation);
          }
          var contactsOkay = minSeparation >= -3 * SettingsInternal.linearSlop;
          var jointsOkay = true;
          for (var j = 0; j < this.m_joints.length; ++j) {
            var joint = this.m_joints[j];
            var jointOkay = joint.solvePositionConstraints(step);
            jointsOkay = jointsOkay && jointOkay;
          }
          if (contactsOkay && jointsOkay) {
            positionSolved = true;
            break;
          }
        }
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(body.m_sweep.c, body.c_position.c);
          body.m_sweep.a = body.c_position.a;
          copyVec2(body.m_linearVelocity, body.c_velocity.v);
          body.m_angularVelocity = body.c_velocity.w;
          body.synchronizeTransform();
        }
        this.postSolveIsland();
        if (allowSleep) {
          var minSleepTime = Infinity;
          var linTolSqr = SettingsInternal.linearSleepToleranceSqr;
          var angTolSqr = SettingsInternal.angularSleepToleranceSqr;
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var body = this.m_bodies[i];
            if (body.isStatic()) {
              continue;
            }
            if (body.m_autoSleepFlag == false || body.m_angularVelocity * body.m_angularVelocity > angTolSqr || lengthSqrVec2(body.m_linearVelocity) > linTolSqr) {
              body.m_sleepTime = 0;
              minSleepTime = 0;
            } else {
              body.m_sleepTime += h;
              minSleepTime = math_min$5(minSleepTime, body.m_sleepTime);
            }
          }
          if (minSleepTime >= SettingsInternal.timeToSleep && positionSolved) {
            for (var i = 0; i < this.m_bodies.length; ++i) {
              var body = this.m_bodies[i];
              body.setAwake(false);
            }
          }
        }
      };
      Solver2.prototype.solveWorldTOI = function(step) {
        var world = this.m_world;
        if (world.m_stepComplete) {
          for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {
            b2.m_islandFlag = false;
            b2.m_sweep.alpha0 = 0;
          }
          for (var c_2 = world.m_contactList; c_2; c_2 = c_2.m_next) {
            c_2.m_toiFlag = false;
            c_2.m_islandFlag = false;
            c_2.m_toiCount = 0;
            c_2.m_toi = 1;
          }
        }
        while (true) {
          var minContact = null;
          var minAlpha = 1;
          for (var c_3 = world.m_contactList; c_3; c_3 = c_3.m_next) {
            if (c_3.isEnabled() == false) {
              continue;
            }
            if (c_3.m_toiCount > SettingsInternal.maxSubSteps) {
              continue;
            }
            var alpha = 1;
            if (c_3.m_toiFlag) {
              alpha = c_3.m_toi;
            } else {
              var fA_1 = c_3.getFixtureA();
              var fB_1 = c_3.getFixtureB();
              if (fA_1.isSensor() || fB_1.isSensor()) {
                continue;
              }
              var bA_1 = fA_1.getBody();
              var bB_1 = fB_1.getBody();
              var activeA = bA_1.isAwake() && !bA_1.isStatic();
              var activeB = bB_1.isAwake() && !bB_1.isStatic();
              if (activeA == false && activeB == false) {
                continue;
              }
              var collideA = bA_1.isBullet() || !bA_1.isDynamic();
              var collideB = bB_1.isBullet() || !bB_1.isDynamic();
              if (collideA == false && collideB == false) {
                continue;
              }
              var alpha0 = bA_1.m_sweep.alpha0;
              if (bA_1.m_sweep.alpha0 < bB_1.m_sweep.alpha0) {
                alpha0 = bB_1.m_sweep.alpha0;
                bA_1.m_sweep.advance(alpha0);
              } else if (bB_1.m_sweep.alpha0 < bA_1.m_sweep.alpha0) {
                alpha0 = bA_1.m_sweep.alpha0;
                bB_1.m_sweep.advance(alpha0);
              }
              var indexA = c_3.getChildIndexA();
              var indexB = c_3.getChildIndexB();
              input.proxyA.set(fA_1.getShape(), indexA);
              input.proxyB.set(fB_1.getShape(), indexB);
              input.sweepA.set(bA_1.m_sweep);
              input.sweepB.set(bB_1.m_sweep);
              input.tMax = 1;
              TimeOfImpact(output, input);
              var beta = output.t;
              if (output.state == exports2.TOIOutputState.e_touching) {
                alpha = math_min$5(alpha0 + (1 - alpha0) * beta, 1);
              } else {
                alpha = 1;
              }
              c_3.m_toi = alpha;
              c_3.m_toiFlag = true;
            }
            if (alpha < minAlpha) {
              minContact = c_3;
              minAlpha = alpha;
            }
          }
          if (minContact == null || 1 - 10 * EPSILON < minAlpha) {
            world.m_stepComplete = true;
            break;
          }
          var fA = minContact.getFixtureA();
          var fB = minContact.getFixtureB();
          var bA = fA.getBody();
          var bB = fB.getBody();
          backup1.set(bA.m_sweep);
          backup2.set(bB.m_sweep);
          bA.advance(minAlpha);
          bB.advance(minAlpha);
          minContact.update(world);
          minContact.m_toiFlag = false;
          ++minContact.m_toiCount;
          if (minContact.isEnabled() == false || minContact.isTouching() == false) {
            minContact.setEnabled(false);
            bA.m_sweep.set(backup1);
            bB.m_sweep.set(backup2);
            bA.synchronizeTransform();
            bB.synchronizeTransform();
            continue;
          }
          bA.setAwake(true);
          bB.setAwake(true);
          this.clear();
          this.addBody(bA);
          this.addBody(bB);
          this.addContact(minContact);
          bA.m_islandFlag = true;
          bB.m_islandFlag = true;
          minContact.m_islandFlag = true;
          var bodies = [bA, bB];
          for (var i = 0; i < bodies.length; ++i) {
            var body = bodies[i];
            if (body.isDynamic()) {
              for (var ce = body.m_contactList; ce; ce = ce.next) {
                var contact = ce.contact;
                if (contact.m_islandFlag) {
                  continue;
                }
                var other = ce.other;
                if (other.isDynamic() && !body.isBullet() && !other.isBullet()) {
                  continue;
                }
                var sensorA = contact.m_fixtureA.m_isSensor;
                var sensorB = contact.m_fixtureB.m_isSensor;
                if (sensorA || sensorB) {
                  continue;
                }
                backup.set(other.m_sweep);
                if (other.m_islandFlag == false) {
                  other.advance(minAlpha);
                }
                contact.update(world);
                if (contact.isEnabled() == false || contact.isTouching() == false) {
                  other.m_sweep.set(backup);
                  other.synchronizeTransform();
                  continue;
                }
                contact.m_islandFlag = true;
                this.addContact(contact);
                if (other.m_islandFlag) {
                  continue;
                }
                other.m_islandFlag = true;
                if (!other.isStatic()) {
                  other.setAwake(true);
                }
                this.addBody(other);
              }
            }
          }
          s_subStep.reset((1 - minAlpha) * step.dt);
          s_subStep.dtRatio = 1;
          s_subStep.positionIterations = 20;
          s_subStep.velocityIterations = step.velocityIterations;
          s_subStep.warmStarting = false;
          this.solveIslandTOI(s_subStep, bA, bB);
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var body = this.m_bodies[i];
            body.m_islandFlag = false;
            if (!body.isDynamic()) {
              continue;
            }
            body.synchronizeFixtures();
            for (var ce = body.m_contactList; ce; ce = ce.next) {
              ce.contact.m_toiFlag = false;
              ce.contact.m_islandFlag = false;
            }
          }
          world.findNewContacts();
          if (world.m_subStepping) {
            world.m_stepComplete = false;
            break;
          }
        }
      };
      Solver2.prototype.solveIslandTOI = function(subStep, toiA, toiB) {
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(body.c_position.c, body.m_sweep.c);
          body.c_position.a = body.m_sweep.a;
          copyVec2(body.c_velocity.v, body.m_linearVelocity);
          body.c_velocity.w = body.m_angularVelocity;
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initConstraint(subStep);
        }
        for (var i = 0; i < subStep.positionIterations; ++i) {
          var minSeparation = 0;
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            var separation = contact.solvePositionConstraintTOI(subStep, toiA, toiB);
            minSeparation = math_min$5(minSeparation, separation);
          }
          var contactsOkay = minSeparation >= -1.5 * SettingsInternal.linearSlop;
          if (contactsOkay) {
            break;
          }
        }
        var i;
        copyVec2(toiA.m_sweep.c0, toiA.c_position.c);
        toiA.m_sweep.a0 = toiA.c_position.a;
        copyVec2(toiB.m_sweep.c0, toiB.c_position.c);
        toiB.m_sweep.a0 = toiB.c_position.a;
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initVelocityConstraint(subStep);
        }
        for (var i = 0; i < subStep.velocityIterations; ++i) {
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            contact.solveVelocityConstraint(subStep);
          }
        }
        var h = subStep.dt;
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.c_position.c);
          var a2 = body.c_position.a;
          copyVec2(v, body.c_velocity.v);
          var w = body.c_velocity.w;
          scaleVec2(translation, h, v);
          var translationLengthSqr = lengthSqrVec2(translation);
          if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {
            var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);
            mulVec2(v, ratio);
          }
          var rotation2 = h * w;
          if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {
            var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);
            w *= ratio;
          }
          plusScaleVec2(c, h, v);
          a2 += h * w;
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
          copyVec2(body.m_sweep.c, c);
          body.m_sweep.a = a2;
          copyVec2(body.m_linearVelocity, v);
          body.m_angularVelocity = w;
          body.synchronizeTransform();
        }
        this.postSolveIsland();
      };
      Solver2.prototype.postSolveIsland = function() {
        for (var c_5 = 0; c_5 < this.m_contacts.length; ++c_5) {
          var contact = this.m_contacts[c_5];
          this.m_world.postSolve(contact, contact.m_impulse);
        }
      };
      return Solver2;
    }()
  );
  Solver.TimeStep = TimeStep;
  var Mat22 = (
    /** @class */
    function() {
      function Mat222(a2, b2, c2, d2) {
        if (typeof a2 === "object" && a2 !== null) {
          this.ex = Vec2.clone(a2);
          this.ey = Vec2.clone(b2);
        } else if (typeof a2 === "number") {
          this.ex = Vec2.neo(a2, c2);
          this.ey = Vec2.neo(b2, d2);
        } else {
          this.ex = Vec2.zero();
          this.ey = Vec2.zero();
        }
      }
      Mat222.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Mat222.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.ex) && Vec2.isValid(obj.ey);
      };
      Mat222.assert = function(o) {
      };
      Mat222.prototype.set = function(a2, b2, c2, d2) {
        if (typeof a2 === "number" && typeof b2 === "number" && typeof c2 === "number" && typeof d2 === "number") {
          this.ex.setNum(a2, c2);
          this.ey.setNum(b2, d2);
        } else if (typeof a2 === "object" && typeof b2 === "object") {
          this.ex.setVec2(a2);
          this.ey.setVec2(b2);
        } else if (typeof a2 === "object") {
          this.ex.setVec2(a2.ex);
          this.ey.setVec2(a2.ey);
        } else ;
      };
      Mat222.prototype.setIdentity = function() {
        this.ex.x = 1;
        this.ey.x = 0;
        this.ex.y = 0;
        this.ey.y = 1;
      };
      Mat222.prototype.setZero = function() {
        this.ex.x = 0;
        this.ey.x = 0;
        this.ex.y = 0;
        this.ey.y = 0;
      };
      Mat222.prototype.getInverse = function() {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        var imx = new Mat222();
        imx.ex.x = det * d2;
        imx.ey.x = -det * b2;
        imx.ex.y = -det * c2;
        imx.ey.y = det * a2;
        return imx;
      };
      Mat222.prototype.solve = function(v3) {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        var w = Vec2.zero();
        w.x = det * (d2 * v3.x - b2 * v3.y);
        w.y = det * (a2 * v3.y - c2 * v3.x);
        return w;
      };
      Mat222.mul = function(mx, v3) {
        if (v3 && "x" in v3 && "y" in v3) {
          var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;
          var y = mx.ex.y * v3.x + mx.ey.y * v3.y;
          return Vec2.neo(x2, y);
        } else if (v3 && "ex" in v3 && "ey" in v3) {
          var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;
          var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;
          var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;
          var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;
          return new Mat222(a2, b2, c2, d2);
        }
      };
      Mat222.mulVec2 = function(mx, v3) {
        var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;
        var y = mx.ex.y * v3.x + mx.ey.y * v3.y;
        return Vec2.neo(x2, y);
      };
      Mat222.mulMat22 = function(mx, v3) {
        var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;
        var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;
        var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;
        var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;
        return new Mat222(a2, b2, c2, d2);
      };
      Mat222.mulT = function(mx, v3) {
        if (v3 && "x" in v3 && "y" in v3) {
          return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));
        } else if (v3 && "ex" in v3 && "ey" in v3) {
          var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));
          var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));
          return new Mat222(c1, c2);
        }
      };
      Mat222.mulTVec2 = function(mx, v3) {
        return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));
      };
      Mat222.mulTMat22 = function(mx, v3) {
        var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));
        var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));
        return new Mat222(c1, c2);
      };
      Mat222.abs = function(mx) {
        return new Mat222(Vec2.abs(mx.ex), Vec2.abs(mx.ey));
      };
      Mat222.add = function(mx1, mx2) {
        return new Mat222(Vec2.add(mx1.ex, mx2.ex), Vec2.add(mx1.ey, mx2.ey));
      };
      return Mat222;
    }()
  );
  var math_sqrt$2 = Math.sqrt;
  var pointA$1 = vec2(0, 0);
  var pointB$1 = vec2(0, 0);
  var temp$3 = vec2(0, 0);
  var cA$1 = vec2(0, 0);
  var cB$1 = vec2(0, 0);
  var dist = vec2(0, 0);
  var planePoint$2 = vec2(0, 0);
  var clipPoint$1 = vec2(0, 0);
  exports2.ManifoldType = void 0;
  (function(ManifoldType2) {
    ManifoldType2[ManifoldType2["e_unset"] = -1] = "e_unset";
    ManifoldType2[ManifoldType2["e_circles"] = 0] = "e_circles";
    ManifoldType2[ManifoldType2["e_faceA"] = 1] = "e_faceA";
    ManifoldType2[ManifoldType2["e_faceB"] = 2] = "e_faceB";
  })(exports2.ManifoldType || (exports2.ManifoldType = {}));
  exports2.ContactFeatureType = void 0;
  (function(ContactFeatureType2) {
    ContactFeatureType2[ContactFeatureType2["e_unset"] = -1] = "e_unset";
    ContactFeatureType2[ContactFeatureType2["e_vertex"] = 0] = "e_vertex";
    ContactFeatureType2[ContactFeatureType2["e_face"] = 1] = "e_face";
  })(exports2.ContactFeatureType || (exports2.ContactFeatureType = {}));
  exports2.PointState = void 0;
  (function(PointState2) {
    PointState2[PointState2["nullState"] = 0] = "nullState";
    PointState2[PointState2["addState"] = 1] = "addState";
    PointState2[PointState2["persistState"] = 2] = "persistState";
    PointState2[PointState2["removeState"] = 3] = "removeState";
  })(exports2.PointState || (exports2.PointState = {}));
  var ClipVertex = (
    /** @class */
    function() {
      function ClipVertex2() {
        this.v = vec2(0, 0);
        this.id = new ContactID();
      }
      ClipVertex2.prototype.set = function(o) {
        copyVec2(this.v, o.v);
        this.id.set(o.id);
      };
      ClipVertex2.prototype.recycle = function() {
        zeroVec2(this.v);
        this.id.recycle();
      };
      return ClipVertex2;
    }()
  );
  var Manifold = (
    /** @class */
    function() {
      function Manifold2() {
        this.localNormal = vec2(0, 0);
        this.localPoint = vec2(0, 0);
        this.points = [new ManifoldPoint(), new ManifoldPoint()];
        this.pointCount = 0;
      }
      Manifold2.prototype.set = function(that) {
        this.type = that.type;
        copyVec2(this.localNormal, that.localNormal);
        copyVec2(this.localPoint, that.localPoint);
        this.pointCount = that.pointCount;
        this.points[0].set(that.points[0]);
        this.points[1].set(that.points[1]);
      };
      Manifold2.prototype.recycle = function() {
        this.type = exports2.ManifoldType.e_unset;
        zeroVec2(this.localNormal);
        zeroVec2(this.localPoint);
        this.pointCount = 0;
        this.points[0].recycle();
        this.points[1].recycle();
      };
      Manifold2.prototype.getWorldManifold = function(wm, xfA2, radiusA, xfB2, radiusB) {
        if (this.pointCount == 0) {
          return wm;
        }
        wm = wm || new WorldManifold();
        wm.pointCount = this.pointCount;
        var normal3 = wm.normal;
        var points = wm.points;
        var separations = wm.separations;
        switch (this.type) {
          case exports2.ManifoldType.e_circles: {
            setVec2(normal3, 1, 0);
            var manifoldPoint = this.points[0];
            transformVec2(pointA$1, xfA2, this.localPoint);
            transformVec2(pointB$1, xfB2, manifoldPoint.localPoint);
            subVec2(dist, pointB$1, pointA$1);
            var lengthSqr = lengthSqrVec2(dist);
            if (lengthSqr > EPSILON * EPSILON) {
              var length_1 = math_sqrt$2(lengthSqr);
              scaleVec2(normal3, 1 / length_1, dist);
            }
            combine2Vec2(cA$1, 1, pointA$1, radiusA, normal3);
            combine2Vec2(cB$1, 1, pointB$1, -radiusB, normal3);
            combine2Vec2(points[0], 0.5, cA$1, 0.5, cB$1);
            separations[0] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);
            break;
          }
          case exports2.ManifoldType.e_faceA: {
            rotVec2(normal3, xfA2.q, this.localNormal);
            transformVec2(planePoint$2, xfA2, this.localPoint);
            for (var i = 0; i < this.pointCount; ++i) {
              var manifoldPoint = this.points[i];
              transformVec2(clipPoint$1, xfB2, manifoldPoint.localPoint);
              combine2Vec2(cA$1, 1, clipPoint$1, radiusA - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);
              combine2Vec2(cB$1, 1, clipPoint$1, -radiusB, normal3);
              combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);
              separations[i] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);
            }
            break;
          }
          case exports2.ManifoldType.e_faceB: {
            rotVec2(normal3, xfB2.q, this.localNormal);
            transformVec2(planePoint$2, xfB2, this.localPoint);
            for (var i = 0; i < this.pointCount; ++i) {
              var manifoldPoint = this.points[i];
              transformVec2(clipPoint$1, xfA2, manifoldPoint.localPoint);
              combine2Vec2(cB$1, 1, clipPoint$1, radiusB - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);
              combine2Vec2(cA$1, 1, clipPoint$1, -radiusA, normal3);
              combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);
              separations[i] = dotVec2(subVec2(temp$3, cA$1, cB$1), normal3);
            }
            negVec2(normal3);
            break;
          }
        }
        return wm;
      };
      Manifold2.clipSegmentToLine = clipSegmentToLine;
      Manifold2.ClipVertex = ClipVertex;
      Manifold2.getPointStates = getPointStates;
      Manifold2.PointState = exports2.PointState;
      return Manifold2;
    }()
  );
  var ManifoldPoint = (
    /** @class */
    function() {
      function ManifoldPoint2() {
        this.localPoint = vec2(0, 0);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.id = new ContactID();
      }
      ManifoldPoint2.prototype.set = function(that) {
        copyVec2(this.localPoint, that.localPoint);
        this.normalImpulse = that.normalImpulse;
        this.tangentImpulse = that.tangentImpulse;
        this.id.set(that.id);
      };
      ManifoldPoint2.prototype.recycle = function() {
        zeroVec2(this.localPoint);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.id.recycle();
      };
      return ManifoldPoint2;
    }()
  );
  var ContactID = (
    /** @class */
    function() {
      function ContactID2() {
        this.key = -1;
        this.indexA = -1;
        this.indexB = -1;
        this.typeA = exports2.ContactFeatureType.e_unset;
        this.typeB = exports2.ContactFeatureType.e_unset;
      }
      ContactID2.prototype.setFeatures = function(indexA, typeA, indexB, typeB) {
        this.indexA = indexA;
        this.indexB = indexB;
        this.typeA = typeA;
        this.typeB = typeB;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.set = function(that) {
        this.indexA = that.indexA;
        this.indexB = that.indexB;
        this.typeA = that.typeA;
        this.typeB = that.typeB;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.swapFeatures = function() {
        var indexA = this.indexA;
        var indexB = this.indexB;
        var typeA = this.typeA;
        var typeB = this.typeB;
        this.indexA = indexB;
        this.indexB = indexA;
        this.typeA = typeB;
        this.typeB = typeA;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.recycle = function() {
        this.indexA = 0;
        this.indexB = 0;
        this.typeA = exports2.ContactFeatureType.e_unset;
        this.typeB = exports2.ContactFeatureType.e_unset;
        this.key = -1;
      };
      return ContactID2;
    }()
  );
  var WorldManifold = (
    /** @class */
    function() {
      function WorldManifold2() {
        this.normal = vec2(0, 0);
        this.points = [vec2(0, 0), vec2(0, 0)];
        this.separations = [0, 0];
        this.pointCount = 0;
      }
      WorldManifold2.prototype.recycle = function() {
        zeroVec2(this.normal);
        zeroVec2(this.points[0]);
        zeroVec2(this.points[1]);
        this.separations[0] = 0;
        this.separations[1] = 0;
        this.pointCount = 0;
      };
      return WorldManifold2;
    }()
  );
  function getPointStates(state1, state2, manifold1, manifold2) {
    for (var i = 0; i < manifold1.pointCount; ++i) {
      var id = manifold1.points[i].id;
      state1[i] = exports2.PointState.removeState;
      for (var j = 0; j < manifold2.pointCount; ++j) {
        if (manifold2.points[j].id.key === id.key) {
          state1[i] = exports2.PointState.persistState;
          break;
        }
      }
    }
    for (var i = 0; i < manifold2.pointCount; ++i) {
      var id = manifold2.points[i].id;
      state2[i] = exports2.PointState.addState;
      for (var j = 0; j < manifold1.pointCount; ++j) {
        if (manifold1.points[j].id.key === id.key) {
          state2[i] = exports2.PointState.persistState;
          break;
        }
      }
    }
  }
  function clipSegmentToLine(vOut, vIn, normal3, offset, vertexIndexA) {
    var numOut = 0;
    var distance0 = dotVec2(normal3, vIn[0].v) - offset;
    var distance1 = dotVec2(normal3, vIn[1].v) - offset;
    if (distance0 <= 0)
      vOut[numOut++].set(vIn[0]);
    if (distance1 <= 0)
      vOut[numOut++].set(vIn[1]);
    if (distance0 * distance1 < 0) {
      var interp = distance0 / (distance0 - distance1);
      combine2Vec2(vOut[numOut].v, 1 - interp, vIn[0].v, interp, vIn[1].v);
      vOut[numOut].id.setFeatures(vertexIndexA, exports2.ContactFeatureType.e_vertex, vIn[0].id.indexB, exports2.ContactFeatureType.e_face);
      ++numOut;
    }
    return numOut;
  }
  var math_sqrt$1 = Math.sqrt;
  var math_max$2 = Math.max;
  var math_min$4 = Math.min;
  var contactPool = new Pool({
    create: function() {
      return new Contact();
    },
    release: function(contact) {
      contact.recycle();
    }
  });
  var oldManifold = new Manifold();
  var worldManifold = new WorldManifold();
  var ContactEdge = (
    /** @class */
    function() {
      function ContactEdge2(contact) {
        this.prev = null;
        this.next = null;
        this.other = null;
        this.contact = contact;
      }
      ContactEdge2.prototype.recycle = function() {
        this.prev = null;
        this.next = null;
        this.other = null;
      };
      return ContactEdge2;
    }()
  );
  function mixFriction(friction1, friction2) {
    return math_sqrt$1(friction1 * friction2);
  }
  function mixRestitution(restitution1, restitution2) {
    return restitution1 > restitution2 ? restitution1 : restitution2;
  }
  var s_registers = [];
  var VelocityConstraintPoint = (
    /** @class */
    function() {
      function VelocityConstraintPoint2() {
        this.rA = vec2(0, 0);
        this.rB = vec2(0, 0);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.normalMass = 0;
        this.tangentMass = 0;
        this.velocityBias = 0;
      }
      VelocityConstraintPoint2.prototype.recycle = function() {
        zeroVec2(this.rA);
        zeroVec2(this.rB);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.normalMass = 0;
        this.tangentMass = 0;
        this.velocityBias = 0;
      };
      return VelocityConstraintPoint2;
    }()
  );
  var cA = vec2(0, 0);
  var vA = vec2(0, 0);
  var cB = vec2(0, 0);
  var vB = vec2(0, 0);
  var tangent$1 = vec2(0, 0);
  var xfA = transform(0, 0, 0);
  var xfB = transform(0, 0, 0);
  var pointA = vec2(0, 0);
  var pointB = vec2(0, 0);
  var clipPoint = vec2(0, 0);
  var planePoint$1 = vec2(0, 0);
  var rA = vec2(0, 0);
  var rB = vec2(0, 0);
  var P$1 = vec2(0, 0);
  var normal$2 = vec2(0, 0);
  var point = vec2(0, 0);
  var dv = vec2(0, 0);
  var dv1 = vec2(0, 0);
  var dv2 = vec2(0, 0);
  var b = vec2(0, 0);
  var a = vec2(0, 0);
  var x = vec2(0, 0);
  var d = vec2(0, 0);
  var P1 = vec2(0, 0);
  var P2 = vec2(0, 0);
  var temp$2 = vec2(0, 0);
  var Contact = (
    /** @class */
    function() {
      function Contact2() {
        this.m_nodeA = new ContactEdge(this);
        this.m_nodeB = new ContactEdge(this);
        this.m_fixtureA = null;
        this.m_fixtureB = null;
        this.m_indexA = -1;
        this.m_indexB = -1;
        this.m_evaluateFcn = null;
        this.m_manifold = new Manifold();
        this.m_prev = null;
        this.m_next = null;
        this.m_toi = 1;
        this.m_toiCount = 0;
        this.m_toiFlag = false;
        this.m_friction = 0;
        this.m_restitution = 0;
        this.m_tangentSpeed = 0;
        this.m_enabledFlag = true;
        this.m_islandFlag = false;
        this.m_touchingFlag = false;
        this.m_filterFlag = false;
        this.m_bulletHitFlag = false;
        this.m_impulse = new ContactImpulse(this);
        this.v_points = [new VelocityConstraintPoint(), new VelocityConstraintPoint()];
        this.v_normal = vec2(0, 0);
        this.v_normalMass = new Mat22();
        this.v_K = new Mat22();
        this.v_pointCount = 0;
        this.v_tangentSpeed = 0;
        this.v_friction = 0;
        this.v_restitution = 0;
        this.v_invMassA = 0;
        this.v_invMassB = 0;
        this.v_invIA = 0;
        this.v_invIB = 0;
        this.p_localPoints = [vec2(0, 0), vec2(0, 0)];
        this.p_localNormal = vec2(0, 0);
        this.p_localPoint = vec2(0, 0);
        this.p_localCenterA = vec2(0, 0);
        this.p_localCenterB = vec2(0, 0);
        this.p_type = exports2.ManifoldType.e_unset;
        this.p_radiusA = 0;
        this.p_radiusB = 0;
        this.p_pointCount = 0;
        this.p_invMassA = 0;
        this.p_invMassB = 0;
        this.p_invIA = 0;
        this.p_invIB = 0;
      }
      Contact2.prototype.initialize = function(fA, indexA, fB, indexB, evaluateFcn) {
        this.m_fixtureA = fA;
        this.m_fixtureB = fB;
        this.m_indexA = indexA;
        this.m_indexB = indexB;
        this.m_evaluateFcn = evaluateFcn;
        this.m_friction = mixFriction(this.m_fixtureA.m_friction, this.m_fixtureB.m_friction);
        this.m_restitution = mixRestitution(this.m_fixtureA.m_restitution, this.m_fixtureB.m_restitution);
      };
      Contact2.prototype.recycle = function() {
        this.m_nodeA.recycle();
        this.m_nodeB.recycle();
        this.m_fixtureA = null;
        this.m_fixtureB = null;
        this.m_indexA = -1;
        this.m_indexB = -1;
        this.m_evaluateFcn = null;
        this.m_manifold.recycle();
        this.m_prev = null;
        this.m_next = null;
        this.m_toi = 1;
        this.m_toiCount = 0;
        this.m_toiFlag = false;
        this.m_friction = 0;
        this.m_restitution = 0;
        this.m_tangentSpeed = 0;
        this.m_enabledFlag = true;
        this.m_islandFlag = false;
        this.m_touchingFlag = false;
        this.m_filterFlag = false;
        this.m_bulletHitFlag = false;
        this.m_impulse.recycle();
        for (var _i = 0, _a2 = this.v_points; _i < _a2.length; _i++) {
          var point_1 = _a2[_i];
          point_1.recycle();
        }
        zeroVec2(this.v_normal);
        this.v_normalMass.setZero();
        this.v_K.setZero();
        this.v_pointCount = 0;
        this.v_tangentSpeed = 0;
        this.v_friction = 0;
        this.v_restitution = 0;
        this.v_invMassA = 0;
        this.v_invMassB = 0;
        this.v_invIA = 0;
        this.v_invIB = 0;
        for (var _b = 0, _c = this.p_localPoints; _b < _c.length; _b++) {
          var point_2 = _c[_b];
          zeroVec2(point_2);
        }
        zeroVec2(this.p_localNormal);
        zeroVec2(this.p_localPoint);
        zeroVec2(this.p_localCenterA);
        zeroVec2(this.p_localCenterB);
        this.p_type = exports2.ManifoldType.e_unset;
        this.p_radiusA = 0;
        this.p_radiusB = 0;
        this.p_pointCount = 0;
        this.p_invMassA = 0;
        this.p_invMassB = 0;
        this.p_invIA = 0;
        this.p_invIB = 0;
      };
      Contact2.prototype.initConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        var manifold = this.m_manifold;
        var pointCount = manifold.pointCount;
        this.v_invMassA = bodyA.m_invMass;
        this.v_invMassB = bodyB.m_invMass;
        this.v_invIA = bodyA.m_invI;
        this.v_invIB = bodyB.m_invI;
        this.v_friction = this.m_friction;
        this.v_restitution = this.m_restitution;
        this.v_tangentSpeed = this.m_tangentSpeed;
        this.v_pointCount = pointCount;
        this.v_K.setZero();
        this.v_normalMass.setZero();
        this.p_invMassA = bodyA.m_invMass;
        this.p_invMassB = bodyB.m_invMass;
        this.p_invIA = bodyA.m_invI;
        this.p_invIB = bodyB.m_invI;
        copyVec2(this.p_localCenterA, bodyA.m_sweep.localCenter);
        copyVec2(this.p_localCenterB, bodyB.m_sweep.localCenter);
        this.p_radiusA = shapeA.m_radius;
        this.p_radiusB = shapeB.m_radius;
        this.p_type = manifold.type;
        copyVec2(this.p_localNormal, manifold.localNormal);
        copyVec2(this.p_localPoint, manifold.localPoint);
        this.p_pointCount = pointCount;
        for (var j = 0; j < SettingsInternal.maxManifoldPoints; ++j) {
          this.v_points[j].recycle();
          zeroVec2(this.p_localPoints[j]);
        }
        for (var j = 0; j < pointCount; ++j) {
          var cp = manifold.points[j];
          var vcp = this.v_points[j];
          if (step.warmStarting) {
            vcp.normalImpulse = step.dtRatio * cp.normalImpulse;
            vcp.tangentImpulse = step.dtRatio * cp.tangentImpulse;
          }
          copyVec2(this.p_localPoints[j], cp.localPoint);
        }
      };
      Contact2.prototype.getManifold = function() {
        return this.m_manifold;
      };
      Contact2.prototype.getWorldManifold = function(worldManifold2) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        return this.m_manifold.getWorldManifold(worldManifold2, bodyA.getTransform(), shapeA.m_radius, bodyB.getTransform(), shapeB.m_radius);
      };
      Contact2.prototype.setEnabled = function(flag) {
        this.m_enabledFlag = !!flag;
      };
      Contact2.prototype.isEnabled = function() {
        return this.m_enabledFlag;
      };
      Contact2.prototype.isTouching = function() {
        return this.m_touchingFlag;
      };
      Contact2.prototype.getNext = function() {
        return this.m_next;
      };
      Contact2.prototype.getFixtureA = function() {
        return this.m_fixtureA;
      };
      Contact2.prototype.getFixtureB = function() {
        return this.m_fixtureB;
      };
      Contact2.prototype.getChildIndexA = function() {
        return this.m_indexA;
      };
      Contact2.prototype.getChildIndexB = function() {
        return this.m_indexB;
      };
      Contact2.prototype.flagForFiltering = function() {
        this.m_filterFlag = true;
      };
      Contact2.prototype.setFriction = function(friction) {
        this.m_friction = friction;
      };
      Contact2.prototype.getFriction = function() {
        return this.m_friction;
      };
      Contact2.prototype.resetFriction = function() {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_friction = mixFriction(fixtureA.m_friction, fixtureB.m_friction);
      };
      Contact2.prototype.setRestitution = function(restitution) {
        this.m_restitution = restitution;
      };
      Contact2.prototype.getRestitution = function() {
        return this.m_restitution;
      };
      Contact2.prototype.resetRestitution = function() {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_restitution = mixRestitution(fixtureA.m_restitution, fixtureB.m_restitution);
      };
      Contact2.prototype.setTangentSpeed = function(speed) {
        this.m_tangentSpeed = speed;
      };
      Contact2.prototype.getTangentSpeed = function() {
        return this.m_tangentSpeed;
      };
      Contact2.prototype.evaluate = function(manifold, xfA2, xfB2) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_evaluateFcn(manifold, xfA2, fixtureA, this.m_indexA, xfB2, fixtureB, this.m_indexB);
      };
      Contact2.prototype.update = function(listener) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        this.m_enabledFlag = true;
        var touching = false;
        var wasTouching = this.m_touchingFlag;
        var sensorA = fixtureA.m_isSensor;
        var sensorB = fixtureB.m_isSensor;
        var sensor = sensorA || sensorB;
        var xfA2 = bodyA.m_xf;
        var xfB2 = bodyB.m_xf;
        if (sensor) {
          touching = testOverlap(shapeA, this.m_indexA, shapeB, this.m_indexB, xfA2, xfB2);
          this.m_manifold.pointCount = 0;
        } else {
          oldManifold.recycle();
          oldManifold.set(this.m_manifold);
          this.m_manifold.recycle();
          this.evaluate(this.m_manifold, xfA2, xfB2);
          touching = this.m_manifold.pointCount > 0;
          for (var i = 0; i < this.m_manifold.pointCount; ++i) {
            var nmp = this.m_manifold.points[i];
            nmp.normalImpulse = 0;
            nmp.tangentImpulse = 0;
            for (var j = 0; j < oldManifold.pointCount; ++j) {
              var omp = oldManifold.points[j];
              if (omp.id.key === nmp.id.key) {
                nmp.normalImpulse = omp.normalImpulse;
                nmp.tangentImpulse = omp.tangentImpulse;
                break;
              }
            }
          }
          if (touching !== wasTouching) {
            bodyA.setAwake(true);
            bodyB.setAwake(true);
          }
        }
        this.m_touchingFlag = touching;
        var hasListener = typeof listener === "object" && listener !== null;
        if (!wasTouching && touching && hasListener) {
          listener.beginContact(this);
        }
        if (wasTouching && !touching && hasListener) {
          listener.endContact(this);
        }
        if (!sensor && touching && hasListener && oldManifold) {
          listener.preSolve(this, oldManifold);
        }
      };
      Contact2.prototype.solvePositionConstraint = function(step) {
        return this._solvePositionConstraint(step, null, null);
      };
      Contact2.prototype.solvePositionConstraintTOI = function(step, toiA, toiB) {
        return this._solvePositionConstraint(step, toiA, toiB);
      };
      Contact2.prototype._solvePositionConstraint = function(step, toiA, toiB) {
        var toi = toiA !== null && toiB !== null ? true : false;
        var minSeparation = 0;
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return minSeparation;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return minSeparation;
        var positionA = bodyA.c_position;
        var positionB = bodyB.c_position;
        var localCenterA = this.p_localCenterA;
        var localCenterB = this.p_localCenterB;
        var mA = 0;
        var iA = 0;
        if (!toi || bodyA === toiA || bodyA === toiB) {
          mA = this.p_invMassA;
          iA = this.p_invIA;
        }
        var mB = 0;
        var iB = 0;
        if (!toi || bodyB === toiA || bodyB === toiB) {
          mB = this.p_invMassB;
          iB = this.p_invIB;
        }
        copyVec2(cA, positionA.c);
        var aA = positionA.a;
        copyVec2(cB, positionB.c);
        var aB = positionB.a;
        for (var j = 0; j < this.p_pointCount; ++j) {
          getTransform(xfA, localCenterA, cA, aA);
          getTransform(xfB, localCenterB, cB, aB);
          var separation = void 0;
          switch (this.p_type) {
            case exports2.ManifoldType.e_circles: {
              transformVec2(pointA, xfA, this.p_localPoint);
              transformVec2(pointB, xfB, this.p_localPoints[0]);
              subVec2(normal$2, pointB, pointA);
              normalizeVec2(normal$2);
              combine2Vec2(point, 0.5, pointA, 0.5, pointB);
              separation = dotVec2(pointB, normal$2) - dotVec2(pointA, normal$2) - this.p_radiusA - this.p_radiusB;
              break;
            }
            case exports2.ManifoldType.e_faceA: {
              rotVec2(normal$2, xfA.q, this.p_localNormal);
              transformVec2(planePoint$1, xfA, this.p_localPoint);
              transformVec2(clipPoint, xfB, this.p_localPoints[j]);
              separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;
              copyVec2(point, clipPoint);
              break;
            }
            case exports2.ManifoldType.e_faceB: {
              rotVec2(normal$2, xfB.q, this.p_localNormal);
              transformVec2(planePoint$1, xfB, this.p_localPoint);
              transformVec2(clipPoint, xfA, this.p_localPoints[j]);
              separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;
              copyVec2(point, clipPoint);
              negVec2(normal$2);
              break;
            }
            default: {
              return minSeparation;
            }
          }
          subVec2(rA, point, cA);
          subVec2(rB, point, cB);
          minSeparation = math_min$4(minSeparation, separation);
          var baumgarte = toi ? SettingsInternal.toiBaugarte : SettingsInternal.baumgarte;
          var linearSlop = SettingsInternal.linearSlop;
          var maxLinearCorrection = SettingsInternal.maxLinearCorrection;
          var C = clamp(baumgarte * (separation + linearSlop), -maxLinearCorrection, 0);
          var rnA = crossVec2Vec2(rA, normal$2);
          var rnB = crossVec2Vec2(rB, normal$2);
          var K = mA + mB + iA * rnA * rnA + iB * rnB * rnB;
          var impulse = K > 0 ? -C / K : 0;
          scaleVec2(P$1, impulse, normal$2);
          minusScaleVec2(cA, mA, P$1);
          aA -= iA * crossVec2Vec2(rA, P$1);
          plusScaleVec2(cB, mB, P$1);
          aB += iB * crossVec2Vec2(rB, P$1);
        }
        copyVec2(positionA.c, cA);
        positionA.a = aA;
        copyVec2(positionB.c, cB);
        positionB.a = aB;
        return minSeparation;
      };
      Contact2.prototype.initVelocityConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var positionA = bodyA.c_position;
        var positionB = bodyB.c_position;
        var radiusA = this.p_radiusA;
        var radiusB = this.p_radiusB;
        var manifold = this.m_manifold;
        var mA = this.v_invMassA;
        var mB = this.v_invMassB;
        var iA = this.v_invIA;
        var iB = this.v_invIB;
        var localCenterA = this.p_localCenterA;
        var localCenterB = this.p_localCenterB;
        copyVec2(cA, positionA.c);
        var aA = positionA.a;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(cB, positionB.c);
        var aB = positionB.a;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        getTransform(xfA, localCenterA, cA, aA);
        getTransform(xfB, localCenterB, cB, aB);
        worldManifold.recycle();
        manifold.getWorldManifold(worldManifold, xfA, radiusA, xfB, radiusB);
        copyVec2(this.v_normal, worldManifold.normal);
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          var wmp = worldManifold.points[j];
          subVec2(vcp.rA, wmp, cA);
          subVec2(vcp.rB, wmp, cB);
          var rnA = crossVec2Vec2(vcp.rA, this.v_normal);
          var rnB = crossVec2Vec2(vcp.rB, this.v_normal);
          var kNormal = mA + mB + iA * rnA * rnA + iB * rnB * rnB;
          vcp.normalMass = kNormal > 0 ? 1 / kNormal : 0;
          crossVec2Num(tangent$1, this.v_normal, 1);
          var rtA = crossVec2Vec2(vcp.rA, tangent$1);
          var rtB = crossVec2Vec2(vcp.rB, tangent$1);
          var kTangent = mA + mB + iA * rtA * rtA + iB * rtB * rtB;
          vcp.tangentMass = kTangent > 0 ? 1 / kTangent : 0;
          vcp.velocityBias = 0;
          var vRel = 0;
          vRel += dotVec2(this.v_normal, vB);
          vRel += dotVec2(this.v_normal, crossNumVec2(temp$2, wB, vcp.rB));
          vRel -= dotVec2(this.v_normal, vA);
          vRel -= dotVec2(this.v_normal, crossNumVec2(temp$2, wA, vcp.rA));
          if (vRel < -SettingsInternal.velocityThreshold) {
            vcp.velocityBias = -this.v_restitution * vRel;
          }
        }
        if (this.v_pointCount == 2 && step.blockSolve) {
          var vcp1 = this.v_points[0];
          var vcp2 = this.v_points[1];
          var rn1A = crossVec2Vec2(vcp1.rA, this.v_normal);
          var rn1B = crossVec2Vec2(vcp1.rB, this.v_normal);
          var rn2A = crossVec2Vec2(vcp2.rA, this.v_normal);
          var rn2B = crossVec2Vec2(vcp2.rB, this.v_normal);
          var k11 = mA + mB + iA * rn1A * rn1A + iB * rn1B * rn1B;
          var k22 = mA + mB + iA * rn2A * rn2A + iB * rn2B * rn2B;
          var k12 = mA + mB + iA * rn1A * rn2A + iB * rn1B * rn2B;
          var k_maxConditionNumber = 1e3;
          if (k11 * k11 < k_maxConditionNumber * (k11 * k22 - k12 * k12)) {
            this.v_K.ex.setNum(k11, k12);
            this.v_K.ey.setNum(k12, k22);
            var a_1 = this.v_K.ex.x;
            var b_1 = this.v_K.ey.x;
            var c2 = this.v_K.ex.y;
            var d_1 = this.v_K.ey.y;
            var det = a_1 * d_1 - b_1 * c2;
            if (det !== 0) {
              det = 1 / det;
            }
            this.v_normalMass.ex.x = det * d_1;
            this.v_normalMass.ey.x = -det * b_1;
            this.v_normalMass.ex.y = -det * c2;
            this.v_normalMass.ey.y = det * a_1;
          } else {
            this.v_pointCount = 1;
          }
        }
        copyVec2(positionA.c, cA);
        positionA.a = aA;
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(positionB.c, cB);
        positionB.a = aB;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.prototype.warmStartConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var mA = this.v_invMassA;
        var iA = this.v_invIA;
        var mB = this.v_invMassB;
        var iB = this.v_invIB;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        copyVec2(normal$2, this.v_normal);
        crossVec2Num(tangent$1, normal$2, 1);
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          combine2Vec2(P$1, vcp.normalImpulse, normal$2, vcp.tangentImpulse, tangent$1);
          wA -= iA * crossVec2Vec2(vcp.rA, P$1);
          minusScaleVec2(vA, mA, P$1);
          wB += iB * crossVec2Vec2(vcp.rB, P$1);
          plusScaleVec2(vB, mB, P$1);
        }
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.prototype.storeConstraintImpulses = function(step) {
        var manifold = this.m_manifold;
        for (var j = 0; j < this.v_pointCount; ++j) {
          manifold.points[j].normalImpulse = this.v_points[j].normalImpulse;
          manifold.points[j].tangentImpulse = this.v_points[j].tangentImpulse;
        }
      };
      Contact2.prototype.solveVelocityConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var mA = this.v_invMassA;
        var iA = this.v_invIA;
        var mB = this.v_invMassB;
        var iB = this.v_invIB;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        copyVec2(normal$2, this.v_normal);
        crossVec2Num(tangent$1, normal$2, 1);
        var friction = this.v_friction;
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          zeroVec2(dv);
          plusVec2(dv, vB);
          plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));
          minusVec2(dv, vA);
          minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));
          var vt = dotVec2(dv, tangent$1) - this.v_tangentSpeed;
          var lambda = vcp.tangentMass * -vt;
          var maxFriction = friction * vcp.normalImpulse;
          var newImpulse = clamp(vcp.tangentImpulse + lambda, -maxFriction, maxFriction);
          lambda = newImpulse - vcp.tangentImpulse;
          vcp.tangentImpulse = newImpulse;
          scaleVec2(P$1, lambda, tangent$1);
          minusScaleVec2(vA, mA, P$1);
          wA -= iA * crossVec2Vec2(vcp.rA, P$1);
          plusScaleVec2(vB, mB, P$1);
          wB += iB * crossVec2Vec2(vcp.rB, P$1);
        }
        if (this.v_pointCount == 1 || step.blockSolve == false) {
          for (var i = 0; i < this.v_pointCount; ++i) {
            var vcp = this.v_points[i];
            zeroVec2(dv);
            plusVec2(dv, vB);
            plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));
            minusVec2(dv, vA);
            minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));
            var vn = dotVec2(dv, normal$2);
            var lambda = -vcp.normalMass * (vn - vcp.velocityBias);
            var newImpulse = math_max$2(vcp.normalImpulse + lambda, 0);
            lambda = newImpulse - vcp.normalImpulse;
            vcp.normalImpulse = newImpulse;
            scaleVec2(P$1, lambda, normal$2);
            minusScaleVec2(vA, mA, P$1);
            wA -= iA * crossVec2Vec2(vcp.rA, P$1);
            plusScaleVec2(vB, mB, P$1);
            wB += iB * crossVec2Vec2(vcp.rB, P$1);
          }
        } else {
          var vcp1 = this.v_points[0];
          var vcp2 = this.v_points[1];
          setVec2(a, vcp1.normalImpulse, vcp2.normalImpulse);
          zeroVec2(dv1);
          plusVec2(dv1, vB);
          plusVec2(dv1, crossNumVec2(temp$2, wB, vcp1.rB));
          minusVec2(dv1, vA);
          minusVec2(dv1, crossNumVec2(temp$2, wA, vcp1.rA));
          zeroVec2(dv2);
          plusVec2(dv2, vB);
          plusVec2(dv2, crossNumVec2(temp$2, wB, vcp2.rB));
          minusVec2(dv2, vA);
          minusVec2(dv2, crossNumVec2(temp$2, wA, vcp2.rA));
          var vn1 = dotVec2(dv1, normal$2);
          var vn2 = dotVec2(dv2, normal$2);
          setVec2(b, vn1 - vcp1.velocityBias, vn2 - vcp2.velocityBias);
          b.x -= this.v_K.ex.x * a.x + this.v_K.ey.x * a.y;
          b.y -= this.v_K.ex.y * a.x + this.v_K.ey.y * a.y;
          while (true) {
            zeroVec2(x);
            x.x = -(this.v_normalMass.ex.x * b.x + this.v_normalMass.ey.x * b.y);
            x.y = -(this.v_normalMass.ex.y * b.x + this.v_normalMass.ey.y * b.y);
            if (x.x >= 0 && x.y >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = -vcp1.normalMass * b.x;
            x.y = 0;
            vn1 = 0;
            vn2 = this.v_K.ex.y * x.x + b.y;
            if (x.x >= 0 && vn2 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = 0;
            x.y = -vcp2.normalMass * b.y;
            vn1 = this.v_K.ey.x * x.y + b.x;
            vn2 = 0;
            if (x.y >= 0 && vn1 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = 0;
            x.y = 0;
            vn1 = b.x;
            vn2 = b.y;
            if (vn1 >= 0 && vn2 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            break;
          }
        }
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.addType = function(type1, type2, callback) {
        s_registers[type1] = s_registers[type1] || {};
        s_registers[type1][type2] = callback;
      };
      Contact2.create = function(fixtureA, indexA, fixtureB, indexB) {
        var typeA = fixtureA.m_shape.m_type;
        var typeB = fixtureB.m_shape.m_type;
        var contact = contactPool.allocate();
        var evaluateFcn;
        if (evaluateFcn = s_registers[typeA] && s_registers[typeA][typeB]) {
          contact.initialize(fixtureA, indexA, fixtureB, indexB, evaluateFcn);
        } else if (evaluateFcn = s_registers[typeB] && s_registers[typeB][typeA]) {
          contact.initialize(fixtureB, indexB, fixtureA, indexA, evaluateFcn);
        } else {
          return null;
        }
        fixtureA = contact.m_fixtureA;
        fixtureB = contact.m_fixtureB;
        indexA = contact.getChildIndexA();
        indexB = contact.getChildIndexB();
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        contact.m_nodeA.contact = contact;
        contact.m_nodeA.other = bodyB;
        contact.m_nodeA.prev = null;
        contact.m_nodeA.next = bodyA.m_contactList;
        if (bodyA.m_contactList != null) {
          bodyA.m_contactList.prev = contact.m_nodeA;
        }
        bodyA.m_contactList = contact.m_nodeA;
        contact.m_nodeB.contact = contact;
        contact.m_nodeB.other = bodyA;
        contact.m_nodeB.prev = null;
        contact.m_nodeB.next = bodyB.m_contactList;
        if (bodyB.m_contactList != null) {
          bodyB.m_contactList.prev = contact.m_nodeB;
        }
        bodyB.m_contactList = contact.m_nodeB;
        if (fixtureA.isSensor() == false && fixtureB.isSensor() == false) {
          bodyA.setAwake(true);
          bodyB.setAwake(true);
        }
        return contact;
      };
      Contact2.destroy = function(contact, listener) {
        var fixtureA = contact.m_fixtureA;
        var fixtureB = contact.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        if (contact.isTouching()) {
          listener.endContact(contact);
        }
        if (contact.m_nodeA.prev) {
          contact.m_nodeA.prev.next = contact.m_nodeA.next;
        }
        if (contact.m_nodeA.next) {
          contact.m_nodeA.next.prev = contact.m_nodeA.prev;
        }
        if (contact.m_nodeA == bodyA.m_contactList) {
          bodyA.m_contactList = contact.m_nodeA.next;
        }
        if (contact.m_nodeB.prev) {
          contact.m_nodeB.prev.next = contact.m_nodeB.next;
        }
        if (contact.m_nodeB.next) {
          contact.m_nodeB.next.prev = contact.m_nodeB.prev;
        }
        if (contact.m_nodeB == bodyB.m_contactList) {
          bodyB.m_contactList = contact.m_nodeB.next;
        }
        if (contact.m_manifold.pointCount > 0 && !fixtureA.m_isSensor && !fixtureB.m_isSensor) {
          bodyA.setAwake(true);
          bodyB.setAwake(true);
        }
        contactPool.release(contact);
      };
      return Contact2;
    }()
  );
  var DEFAULTS$b = {
    gravity: Vec2.zero(),
    allowSleep: true,
    warmStarting: true,
    continuousPhysics: true,
    subStepping: false,
    blockSolve: true,
    velocityIterations: 8,
    positionIterations: 3
  };
  var World = (
    /** @class */
    function() {
      function World2(def) {
        if (!(this instanceof World2)) {
          return new World2(def);
        }
        this.s_step = new TimeStep();
        if (!def) {
          def = {};
        } else if (Vec2.isValid(def)) {
          def = { gravity: def };
        }
        def = options(def, DEFAULTS$b);
        this.m_solver = new Solver(this);
        this.m_broadPhase = new BroadPhase();
        this.m_contactList = null;
        this.m_contactCount = 0;
        this.m_bodyList = null;
        this.m_bodyCount = 0;
        this.m_jointList = null;
        this.m_jointCount = 0;
        this.m_stepComplete = true;
        this.m_allowSleep = def.allowSleep;
        this.m_gravity = Vec2.clone(def.gravity);
        this.m_clearForces = true;
        this.m_newFixture = false;
        this.m_locked = false;
        this.m_warmStarting = def.warmStarting;
        this.m_continuousPhysics = def.continuousPhysics;
        this.m_subStepping = def.subStepping;
        this.m_blockSolve = def.blockSolve;
        this.m_velocityIterations = def.velocityIterations;
        this.m_positionIterations = def.positionIterations;
        this.m_t = 0;
        this.m_step_callback = [];
      }
      World2.prototype._serialize = function() {
        var bodies = [];
        var joints = [];
        for (var b2 = this.getBodyList(); b2; b2 = b2.getNext()) {
          bodies.push(b2);
        }
        for (var j = this.getJointList(); j; j = j.getNext()) {
          if (typeof j._serialize === "function") {
            joints.push(j);
          }
        }
        return {
          gravity: this.m_gravity,
          bodies,
          joints
        };
      };
      World2._deserialize = function(data, context, restore) {
        if (!data) {
          return new World2();
        }
        var world = new World2(data.gravity);
        if (data.bodies) {
          for (var i = data.bodies.length - 1; i >= 0; i -= 1) {
            world._addBody(restore(Body, data.bodies[i], world));
          }
        }
        if (data.joints) {
          for (var i = data.joints.length - 1; i >= 0; i--) {
            world.createJoint(restore(Joint, data.joints[i], world));
          }
        }
        return world;
      };
      World2.prototype.getBodyList = function() {
        return this.m_bodyList;
      };
      World2.prototype.getJointList = function() {
        return this.m_jointList;
      };
      World2.prototype.getContactList = function() {
        return this.m_contactList;
      };
      World2.prototype.getBodyCount = function() {
        return this.m_bodyCount;
      };
      World2.prototype.getJointCount = function() {
        return this.m_jointCount;
      };
      World2.prototype.getContactCount = function() {
        return this.m_contactCount;
      };
      World2.prototype.setGravity = function(gravity) {
        this.m_gravity.set(gravity);
      };
      World2.prototype.getGravity = function() {
        return this.m_gravity;
      };
      World2.prototype.isLocked = function() {
        return this.m_locked;
      };
      World2.prototype.setAllowSleeping = function(flag) {
        if (flag == this.m_allowSleep) {
          return;
        }
        this.m_allowSleep = flag;
        if (this.m_allowSleep == false) {
          for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {
            b2.setAwake(true);
          }
        }
      };
      World2.prototype.getAllowSleeping = function() {
        return this.m_allowSleep;
      };
      World2.prototype.setWarmStarting = function(flag) {
        this.m_warmStarting = flag;
      };
      World2.prototype.getWarmStarting = function() {
        return this.m_warmStarting;
      };
      World2.prototype.setContinuousPhysics = function(flag) {
        this.m_continuousPhysics = flag;
      };
      World2.prototype.getContinuousPhysics = function() {
        return this.m_continuousPhysics;
      };
      World2.prototype.setSubStepping = function(flag) {
        this.m_subStepping = flag;
      };
      World2.prototype.getSubStepping = function() {
        return this.m_subStepping;
      };
      World2.prototype.setAutoClearForces = function(flag) {
        this.m_clearForces = flag;
      };
      World2.prototype.getAutoClearForces = function() {
        return this.m_clearForces;
      };
      World2.prototype.clearForces = function() {
        for (var body = this.m_bodyList; body; body = body.getNext()) {
          body.m_force.setZero();
          body.m_torque = 0;
        }
      };
      World2.prototype.queryAABB = function(aabb, callback) {
        var broadPhase = this.m_broadPhase;
        this.m_broadPhase.query(aabb, function(proxyId) {
          var proxy = broadPhase.getUserData(proxyId);
          return callback(proxy.fixture);
        });
      };
      World2.prototype.rayCast = function(point1, point2, callback) {
        var broadPhase = this.m_broadPhase;
        this.m_broadPhase.rayCast({
          maxFraction: 1,
          p1: point1,
          p2: point2
        }, function(input2, proxyId) {
          var proxy = broadPhase.getUserData(proxyId);
          var fixture = proxy.fixture;
          var index = proxy.childIndex;
          var output2 = {};
          var hit = fixture.rayCast(output2, input2, index);
          if (hit) {
            var fraction = output2.fraction;
            var point3 = Vec2.add(Vec2.mulNumVec2(1 - fraction, input2.p1), Vec2.mulNumVec2(fraction, input2.p2));
            return callback(fixture, point3, output2.normal, fraction);
          }
          return input2.maxFraction;
        });
      };
      World2.prototype.getProxyCount = function() {
        return this.m_broadPhase.getProxyCount();
      };
      World2.prototype.getTreeHeight = function() {
        return this.m_broadPhase.getTreeHeight();
      };
      World2.prototype.getTreeBalance = function() {
        return this.m_broadPhase.getTreeBalance();
      };
      World2.prototype.getTreeQuality = function() {
        return this.m_broadPhase.getTreeQuality();
      };
      World2.prototype.shiftOrigin = function(newOrigin) {
        if (this.isLocked()) {
          return;
        }
        for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {
          b2.m_xf.p.sub(newOrigin);
          b2.m_sweep.c0.sub(newOrigin);
          b2.m_sweep.c.sub(newOrigin);
        }
        for (var j = this.m_jointList; j; j = j.m_next) {
          j.shiftOrigin(newOrigin);
        }
        this.m_broadPhase.shiftOrigin(newOrigin);
      };
      World2.prototype._addBody = function(body) {
        if (this.isLocked()) {
          return;
        }
        body.m_prev = null;
        body.m_next = this.m_bodyList;
        if (this.m_bodyList) {
          this.m_bodyList.m_prev = body;
        }
        this.m_bodyList = body;
        ++this.m_bodyCount;
      };
      World2.prototype.createBody = function(arg1, arg2) {
        if (this.isLocked()) {
          return null;
        }
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        var body = new Body(this, def);
        this._addBody(body);
        return body;
      };
      World2.prototype.createDynamicBody = function(arg1, arg2) {
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        def.type = "dynamic";
        return this.createBody(def);
      };
      World2.prototype.createKinematicBody = function(arg1, arg2) {
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        def.type = "kinematic";
        return this.createBody(def);
      };
      World2.prototype.destroyBody = function(b2) {
        if (this.isLocked()) {
          return;
        }
        if (b2.m_destroyed) {
          return false;
        }
        var je = b2.m_jointList;
        while (je) {
          var je0 = je;
          je = je.next;
          this.publish("remove-joint", je0.joint);
          this.destroyJoint(je0.joint);
          b2.m_jointList = je;
        }
        b2.m_jointList = null;
        var ce = b2.m_contactList;
        while (ce) {
          var ce0 = ce;
          ce = ce.next;
          this.destroyContact(ce0.contact);
          b2.m_contactList = ce;
        }
        b2.m_contactList = null;
        var f = b2.m_fixtureList;
        while (f) {
          var f0 = f;
          f = f.m_next;
          this.publish("remove-fixture", f0);
          f0.destroyProxies(this.m_broadPhase);
          b2.m_fixtureList = f;
        }
        b2.m_fixtureList = null;
        if (b2.m_prev) {
          b2.m_prev.m_next = b2.m_next;
        }
        if (b2.m_next) {
          b2.m_next.m_prev = b2.m_prev;
        }
        if (b2 == this.m_bodyList) {
          this.m_bodyList = b2.m_next;
        }
        b2.m_destroyed = true;
        --this.m_bodyCount;
        this.publish("remove-body", b2);
        return true;
      };
      World2.prototype.createJoint = function(joint) {
        if (this.isLocked()) {
          return null;
        }
        joint.m_prev = null;
        joint.m_next = this.m_jointList;
        if (this.m_jointList) {
          this.m_jointList.m_prev = joint;
        }
        this.m_jointList = joint;
        ++this.m_jointCount;
        joint.m_edgeA.joint = joint;
        joint.m_edgeA.other = joint.m_bodyB;
        joint.m_edgeA.prev = null;
        joint.m_edgeA.next = joint.m_bodyA.m_jointList;
        if (joint.m_bodyA.m_jointList)
          joint.m_bodyA.m_jointList.prev = joint.m_edgeA;
        joint.m_bodyA.m_jointList = joint.m_edgeA;
        joint.m_edgeB.joint = joint;
        joint.m_edgeB.other = joint.m_bodyA;
        joint.m_edgeB.prev = null;
        joint.m_edgeB.next = joint.m_bodyB.m_jointList;
        if (joint.m_bodyB.m_jointList)
          joint.m_bodyB.m_jointList.prev = joint.m_edgeB;
        joint.m_bodyB.m_jointList = joint.m_edgeB;
        if (joint.m_collideConnected == false) {
          for (var edge = joint.m_bodyB.getContactList(); edge; edge = edge.next) {
            if (edge.other == joint.m_bodyA) {
              edge.contact.flagForFiltering();
            }
          }
        }
        return joint;
      };
      World2.prototype.destroyJoint = function(joint) {
        if (this.isLocked()) {
          return;
        }
        if (joint.m_prev) {
          joint.m_prev.m_next = joint.m_next;
        }
        if (joint.m_next) {
          joint.m_next.m_prev = joint.m_prev;
        }
        if (joint == this.m_jointList) {
          this.m_jointList = joint.m_next;
        }
        var bodyA = joint.m_bodyA;
        var bodyB = joint.m_bodyB;
        bodyA.setAwake(true);
        bodyB.setAwake(true);
        if (joint.m_edgeA.prev) {
          joint.m_edgeA.prev.next = joint.m_edgeA.next;
        }
        if (joint.m_edgeA.next) {
          joint.m_edgeA.next.prev = joint.m_edgeA.prev;
        }
        if (joint.m_edgeA == bodyA.m_jointList) {
          bodyA.m_jointList = joint.m_edgeA.next;
        }
        joint.m_edgeA.prev = null;
        joint.m_edgeA.next = null;
        if (joint.m_edgeB.prev) {
          joint.m_edgeB.prev.next = joint.m_edgeB.next;
        }
        if (joint.m_edgeB.next) {
          joint.m_edgeB.next.prev = joint.m_edgeB.prev;
        }
        if (joint.m_edgeB == bodyB.m_jointList) {
          bodyB.m_jointList = joint.m_edgeB.next;
        }
        joint.m_edgeB.prev = null;
        joint.m_edgeB.next = null;
        --this.m_jointCount;
        if (joint.m_collideConnected == false) {
          var edge = bodyB.getContactList();
          while (edge) {
            if (edge.other == bodyA) {
              edge.contact.flagForFiltering();
            }
            edge = edge.next;
          }
        }
        this.publish("remove-joint", joint);
      };
      World2.prototype.step = function(timeStep, velocityIterations, positionIterations) {
        this.publish("pre-step", timeStep);
        if ((velocityIterations | 0) !== velocityIterations) {
          velocityIterations = 0;
        }
        velocityIterations = velocityIterations || this.m_velocityIterations;
        positionIterations = positionIterations || this.m_positionIterations;
        if (this.m_newFixture) {
          this.findNewContacts();
          this.m_newFixture = false;
        }
        this.m_locked = true;
        this.s_step.reset(timeStep);
        this.s_step.velocityIterations = velocityIterations;
        this.s_step.positionIterations = positionIterations;
        this.s_step.warmStarting = this.m_warmStarting;
        this.s_step.blockSolve = this.m_blockSolve;
        this.updateContacts();
        if (this.m_stepComplete && timeStep > 0) {
          this.m_solver.solveWorld(this.s_step);
          for (var b2 = this.m_bodyList; b2; b2 = b2.getNext()) {
            if (b2.m_islandFlag == false) {
              continue;
            }
            if (b2.isStatic()) {
              continue;
            }
            b2.synchronizeFixtures();
          }
          this.findNewContacts();
        }
        if (this.m_continuousPhysics && timeStep > 0) {
          this.m_solver.solveWorldTOI(this.s_step);
        }
        if (this.m_clearForces) {
          this.clearForces();
        }
        this.m_locked = false;
        var callback;
        while (callback = this.m_step_callback.shift()) {
          callback(this);
        }
        this.publish("post-step", timeStep);
      };
      World2.prototype.queueUpdate = function(callback) {
        if (!this.isLocked()) {
          callback(this);
        } else {
          this.m_step_callback.push(callback);
        }
      };
      World2.prototype.findNewContacts = function() {
        var _this = this;
        this.m_broadPhase.updatePairs(function(proxyA, proxyB) {
          return _this.createContact(proxyA, proxyB);
        });
      };
      World2.prototype.createContact = function(proxyA, proxyB) {
        var fixtureA = proxyA.fixture;
        var fixtureB = proxyB.fixture;
        var indexA = proxyA.childIndex;
        var indexB = proxyB.childIndex;
        var bodyA = fixtureA.getBody();
        var bodyB = fixtureB.getBody();
        if (bodyA == bodyB) {
          return;
        }
        var edge = bodyB.getContactList();
        while (edge) {
          if (edge.other == bodyA) {
            var fA = edge.contact.getFixtureA();
            var fB = edge.contact.getFixtureB();
            var iA = edge.contact.getChildIndexA();
            var iB = edge.contact.getChildIndexB();
            if (fA == fixtureA && fB == fixtureB && iA == indexA && iB == indexB) {
              return;
            }
            if (fA == fixtureB && fB == fixtureA && iA == indexB && iB == indexA) {
              return;
            }
          }
          edge = edge.next;
        }
        if (bodyB.shouldCollide(bodyA) == false) {
          return;
        }
        if (fixtureB.shouldCollide(fixtureA) == false) {
          return;
        }
        var contact = Contact.create(fixtureA, indexA, fixtureB, indexB);
        if (contact == null) {
          return;
        }
        contact.m_prev = null;
        if (this.m_contactList != null) {
          contact.m_next = this.m_contactList;
          this.m_contactList.m_prev = contact;
        }
        this.m_contactList = contact;
        ++this.m_contactCount;
      };
      World2.prototype.updateContacts = function() {
        var c2;
        var next_c = this.m_contactList;
        while (c2 = next_c) {
          next_c = c2.getNext();
          var fixtureA = c2.getFixtureA();
          var fixtureB = c2.getFixtureB();
          var indexA = c2.getChildIndexA();
          var indexB = c2.getChildIndexB();
          var bodyA = fixtureA.getBody();
          var bodyB = fixtureB.getBody();
          if (c2.m_filterFlag) {
            if (bodyB.shouldCollide(bodyA) == false) {
              this.destroyContact(c2);
              continue;
            }
            if (fixtureB.shouldCollide(fixtureA) == false) {
              this.destroyContact(c2);
              continue;
            }
            c2.m_filterFlag = false;
          }
          var activeA = bodyA.isAwake() && !bodyA.isStatic();
          var activeB = bodyB.isAwake() && !bodyB.isStatic();
          if (activeA == false && activeB == false) {
            continue;
          }
          var proxyIdA = fixtureA.m_proxies[indexA].proxyId;
          var proxyIdB = fixtureB.m_proxies[indexB].proxyId;
          var overlap = this.m_broadPhase.testOverlap(proxyIdA, proxyIdB);
          if (overlap == false) {
            this.destroyContact(c2);
            continue;
          }
          c2.update(this);
        }
      };
      World2.prototype.destroyContact = function(contact) {
        if (contact.m_prev) {
          contact.m_prev.m_next = contact.m_next;
        }
        if (contact.m_next) {
          contact.m_next.m_prev = contact.m_prev;
        }
        if (contact == this.m_contactList) {
          this.m_contactList = contact.m_next;
        }
        Contact.destroy(contact, this);
        --this.m_contactCount;
      };
      World2.prototype.on = function(name, listener) {
        if (typeof name !== "string" || typeof listener !== "function") {
          return this;
        }
        if (!this._listeners) {
          this._listeners = {};
        }
        if (!this._listeners[name]) {
          this._listeners[name] = [];
        }
        this._listeners[name].push(listener);
        return this;
      };
      World2.prototype.off = function(name, listener) {
        if (typeof name !== "string" || typeof listener !== "function") {
          return this;
        }
        var listeners = this._listeners && this._listeners[name];
        if (!listeners || !listeners.length) {
          return this;
        }
        var index = listeners.indexOf(listener);
        if (index >= 0) {
          listeners.splice(index, 1);
        }
        return this;
      };
      World2.prototype.publish = function(name, arg1, arg2, arg3) {
        var listeners = this._listeners && this._listeners[name];
        if (!listeners || !listeners.length) {
          return 0;
        }
        for (var l = 0; l < listeners.length; l++) {
          listeners[l].call(this, arg1, arg2, arg3);
        }
        return listeners.length;
      };
      World2.prototype.beginContact = function(contact) {
        this.publish("begin-contact", contact);
      };
      World2.prototype.endContact = function(contact) {
        this.publish("end-contact", contact);
      };
      World2.prototype.preSolve = function(contact, oldManifold2) {
        this.publish("pre-solve", contact, oldManifold2);
      };
      World2.prototype.postSolve = function(contact, impulse) {
        this.publish("post-solve", contact, impulse);
      };
      return World2;
    }()
  );
  var Vec3 = (
    /** @class */
    function() {
      function Vec32(x2, y, z) {
        if (!(this instanceof Vec32)) {
          return new Vec32(x2, y, z);
        }
        if (typeof x2 === "undefined") {
          this.x = 0;
          this.y = 0;
          this.z = 0;
        } else if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
          this.z = x2.z;
        } else {
          this.x = x2;
          this.y = y;
          this.z = z;
        }
      }
      Vec32.prototype._serialize = function() {
        return {
          x: this.x,
          y: this.y,
          z: this.z
        };
      };
      Vec32._deserialize = function(data) {
        var obj = Object.create(Vec32.prototype);
        obj.x = data.x;
        obj.y = data.y;
        obj.z = data.z;
        return obj;
      };
      Vec32.neo = function(x2, y, z) {
        var obj = Object.create(Vec32.prototype);
        obj.x = x2;
        obj.y = y;
        obj.z = z;
        return obj;
      };
      Vec32.zero = function() {
        var obj = Object.create(Vec32.prototype);
        obj.x = 0;
        obj.y = 0;
        obj.z = 0;
        return obj;
      };
      Vec32.clone = function(v3) {
        return Vec32.neo(v3.x, v3.y, v3.z);
      };
      Vec32.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Vec32.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.x) && Number.isFinite(obj.y) && Number.isFinite(obj.z);
      };
      Vec32.assert = function(o) {
      };
      Vec32.prototype.setZero = function() {
        this.x = 0;
        this.y = 0;
        this.z = 0;
        return this;
      };
      Vec32.prototype.set = function(x2, y, z) {
        this.x = x2;
        this.y = y;
        this.z = z;
        return this;
      };
      Vec32.prototype.add = function(w) {
        this.x += w.x;
        this.y += w.y;
        this.z += w.z;
        return this;
      };
      Vec32.prototype.sub = function(w) {
        this.x -= w.x;
        this.y -= w.y;
        this.z -= w.z;
        return this;
      };
      Vec32.prototype.mul = function(m) {
        this.x *= m;
        this.y *= m;
        this.z *= m;
        return this;
      };
      Vec32.areEqual = function(v3, w) {
        return v3 === w || typeof v3 === "object" && v3 !== null && typeof w === "object" && w !== null && v3.x === w.x && v3.y === w.y && v3.z === w.z;
      };
      Vec32.dot = function(v3, w) {
        return v3.x * w.x + v3.y * w.y + v3.z * w.z;
      };
      Vec32.cross = function(v3, w) {
        return new Vec32(v3.y * w.z - v3.z * w.y, v3.z * w.x - v3.x * w.z, v3.x * w.y - v3.y * w.x);
      };
      Vec32.add = function(v3, w) {
        return new Vec32(v3.x + w.x, v3.y + w.y, v3.z + w.z);
      };
      Vec32.sub = function(v3, w) {
        return new Vec32(v3.x - w.x, v3.y - w.y, v3.z - w.z);
      };
      Vec32.mul = function(v3, m) {
        return new Vec32(m * v3.x, m * v3.y, m * v3.z);
      };
      Vec32.prototype.neg = function() {
        this.x = -this.x;
        this.y = -this.y;
        this.z = -this.z;
        return this;
      };
      Vec32.neg = function(v3) {
        return new Vec32(-v3.x, -v3.y, -v3.z);
      };
      return Vec32;
    }()
  );
  var v1$2 = vec2(0, 0);
  var v2$1 = vec2(0, 0);
  var EdgeShape = (
    /** @class */
    function(_super) {
      __extends(EdgeShape2, _super);
      function EdgeShape2(v122, v22) {
        var _this = this;
        if (!(_this instanceof EdgeShape2)) {
          return new EdgeShape2(v122, v22);
        }
        _this = _super.call(this) || this;
        _this.m_type = EdgeShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_vertex1 = v122 ? Vec2.clone(v122) : Vec2.zero();
        _this.m_vertex2 = v22 ? Vec2.clone(v22) : Vec2.zero();
        _this.m_vertex0 = Vec2.zero();
        _this.m_vertex3 = Vec2.zero();
        _this.m_hasVertex0 = false;
        _this.m_hasVertex3 = false;
        return _this;
      }
      EdgeShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          vertex1: this.m_vertex1,
          vertex2: this.m_vertex2,
          vertex0: this.m_vertex0,
          vertex3: this.m_vertex3,
          hasVertex0: this.m_hasVertex0,
          hasVertex3: this.m_hasVertex3
        };
      };
      EdgeShape2._deserialize = function(data) {
        var shape = new EdgeShape2(data.vertex1, data.vertex2);
        if (shape.m_hasVertex0) {
          shape.setPrevVertex(data.vertex0);
        }
        if (shape.m_hasVertex3) {
          shape.setNextVertex(data.vertex3);
        }
        return shape;
      };
      EdgeShape2.prototype._reset = function() {
      };
      EdgeShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      EdgeShape2.prototype.getType = function() {
        return this.m_type;
      };
      EdgeShape2.prototype.setNext = function(v3) {
        return this.setNextVertex(v3);
      };
      EdgeShape2.prototype.setNextVertex = function(v3) {
        if (v3) {
          this.m_vertex3.setVec2(v3);
          this.m_hasVertex3 = true;
        } else {
          this.m_vertex3.setZero();
          this.m_hasVertex3 = false;
        }
        return this;
      };
      EdgeShape2.prototype.getNextVertex = function() {
        return this.m_vertex3;
      };
      EdgeShape2.prototype.setPrev = function(v3) {
        return this.setPrevVertex(v3);
      };
      EdgeShape2.prototype.setPrevVertex = function(v3) {
        if (v3) {
          this.m_vertex0.setVec2(v3);
          this.m_hasVertex0 = true;
        } else {
          this.m_vertex0.setZero();
          this.m_hasVertex0 = false;
        }
        return this;
      };
      EdgeShape2.prototype.getPrevVertex = function() {
        return this.m_vertex0;
      };
      EdgeShape2.prototype._set = function(v122, v22) {
        this.m_vertex1.setVec2(v122);
        this.m_vertex2.setVec2(v22);
        this.m_hasVertex0 = false;
        this.m_hasVertex3 = false;
        return this;
      };
      EdgeShape2.prototype._clone = function() {
        var clone = new EdgeShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_vertex1.setVec2(this.m_vertex1);
        clone.m_vertex2.setVec2(this.m_vertex2);
        clone.m_vertex0.setVec2(this.m_vertex0);
        clone.m_vertex3.setVec2(this.m_vertex3);
        clone.m_hasVertex0 = this.m_hasVertex0;
        clone.m_hasVertex3 = this.m_hasVertex3;
        return clone;
      };
      EdgeShape2.prototype.getChildCount = function() {
        return 1;
      };
      EdgeShape2.prototype.testPoint = function(xf2, p) {
        return false;
      };
      EdgeShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));
        var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));
        var d2 = Vec2.sub(p2, p1);
        var v122 = this.m_vertex1;
        var v22 = this.m_vertex2;
        var e3 = Vec2.sub(v22, v122);
        var normal3 = Vec2.neo(e3.y, -e3.x);
        normal3.normalize();
        var numerator = Vec2.dot(normal3, Vec2.sub(v122, p1));
        var denominator = Vec2.dot(normal3, d2);
        if (denominator == 0) {
          return false;
        }
        var t = numerator / denominator;
        if (t < 0 || input2.maxFraction < t) {
          return false;
        }
        var q = Vec2.add(p1, Vec2.mulNumVec2(t, d2));
        var r = Vec2.sub(v22, v122);
        var rr = Vec2.dot(r, r);
        if (rr == 0) {
          return false;
        }
        var s2 = Vec2.dot(Vec2.sub(q, v122), r) / rr;
        if (s2 < 0 || 1 < s2) {
          return false;
        }
        output2.fraction = t;
        if (numerator > 0) {
          output2.normal = Rot.mulVec2(xf2.q, normal3).neg();
        } else {
          output2.normal = Rot.mulVec2(xf2.q, normal3);
        }
        return true;
      };
      EdgeShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        transformVec2(v1$2, xf2, this.m_vertex1);
        transformVec2(v2$1, xf2, this.m_vertex2);
        AABB.combinePoints(aabb, v1$2, v2$1);
        AABB.extend(aabb, this.m_radius);
      };
      EdgeShape2.prototype.computeMass = function(massData, density) {
        massData.mass = 0;
        combine2Vec2(massData.center, 0.5, this.m_vertex1, 0.5, this.m_vertex2);
        massData.I = 0;
      };
      EdgeShape2.prototype.computeDistanceProxy = function(proxy) {
        proxy.m_vertices[0] = this.m_vertex1;
        proxy.m_vertices[1] = this.m_vertex2;
        proxy.m_vertices.length = 2;
        proxy.m_count = 2;
        proxy.m_radius = this.m_radius;
      };
      EdgeShape2.TYPE = "edge";
      return EdgeShape2;
    }(Shape)
  );
  var v1$1 = vec2(0, 0);
  var v2 = vec2(0, 0);
  var ChainShape = (
    /** @class */
    function(_super) {
      __extends(ChainShape2, _super);
      function ChainShape2(vertices, loop) {
        var _this = this;
        if (!(_this instanceof ChainShape2)) {
          return new ChainShape2(vertices, loop);
        }
        _this = _super.call(this) || this;
        _this.m_type = ChainShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_vertices = [];
        _this.m_count = 0;
        _this.m_prevVertex = null;
        _this.m_nextVertex = null;
        _this.m_hasPrevVertex = false;
        _this.m_hasNextVertex = false;
        _this.m_isLoop = !!loop;
        if (vertices && vertices.length) {
          if (loop) {
            _this._createLoop(vertices);
          } else {
            _this._createChain(vertices);
          }
        }
        return _this;
      }
      ChainShape2.prototype._serialize = function() {
        var data = {
          type: this.m_type,
          vertices: this.m_isLoop ? this.m_vertices.slice(0, this.m_vertices.length - 1) : this.m_vertices,
          isLoop: this.m_isLoop,
          hasPrevVertex: this.m_hasPrevVertex,
          hasNextVertex: this.m_hasNextVertex,
          prevVertex: null,
          nextVertex: null
        };
        if (this.m_prevVertex) {
          data.prevVertex = this.m_prevVertex;
        }
        if (this.m_nextVertex) {
          data.nextVertex = this.m_nextVertex;
        }
        return data;
      };
      ChainShape2._deserialize = function(data, fixture, restore) {
        var vertices = [];
        if (data.vertices) {
          for (var i = 0; i < data.vertices.length; i++) {
            vertices.push(restore(Vec2, data.vertices[i]));
          }
        }
        var shape = new ChainShape2(vertices, data.isLoop);
        if (data.prevVertex) {
          shape.setPrevVertex(data.prevVertex);
        }
        if (data.nextVertex) {
          shape.setNextVertex(data.nextVertex);
        }
        return shape;
      };
      ChainShape2.prototype.getType = function() {
        return this.m_type;
      };
      ChainShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      ChainShape2.prototype._createLoop = function(vertices) {
        if (vertices.length < 3) {
          return;
        }
        var i;
        this.m_vertices = [];
        this.m_count = vertices.length + 1;
        for (var i = 0; i < vertices.length; ++i) {
          this.m_vertices[i] = Vec2.clone(vertices[i]);
        }
        this.m_vertices[vertices.length] = Vec2.clone(vertices[0]);
        this.m_prevVertex = this.m_vertices[this.m_count - 2];
        this.m_nextVertex = this.m_vertices[1];
        this.m_hasPrevVertex = true;
        this.m_hasNextVertex = true;
        return this;
      };
      ChainShape2.prototype._createChain = function(vertices) {
        var i;
        this.m_vertices = [];
        this.m_count = vertices.length;
        for (var i = 0; i < vertices.length; ++i) {
          this.m_vertices[i] = Vec2.clone(vertices[i]);
        }
        this.m_prevVertex = null;
        this.m_nextVertex = null;
        this.m_hasPrevVertex = false;
        this.m_hasNextVertex = false;
        return this;
      };
      ChainShape2.prototype._reset = function() {
        if (this.m_isLoop) {
          this._createLoop(this.m_vertices.slice(0, this.m_vertices.length - 1));
        } else {
          this._createChain(this.m_vertices);
        }
      };
      ChainShape2.prototype.setPrevVertex = function(prevVertex) {
        this.m_prevVertex = prevVertex;
        this.m_hasPrevVertex = true;
      };
      ChainShape2.prototype.getPrevVertex = function() {
        return this.m_prevVertex;
      };
      ChainShape2.prototype.setNextVertex = function(nextVertex) {
        this.m_nextVertex = nextVertex;
        this.m_hasNextVertex = true;
      };
      ChainShape2.prototype.getNextVertex = function() {
        return this.m_nextVertex;
      };
      ChainShape2.prototype._clone = function() {
        var clone = new ChainShape2();
        clone._createChain(this.m_vertices);
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_prevVertex = this.m_prevVertex;
        clone.m_nextVertex = this.m_nextVertex;
        clone.m_hasPrevVertex = this.m_hasPrevVertex;
        clone.m_hasNextVertex = this.m_hasNextVertex;
        return clone;
      };
      ChainShape2.prototype.getChildCount = function() {
        return this.m_count - 1;
      };
      ChainShape2.prototype.getChildEdge = function(edge, childIndex) {
        edge.m_type = EdgeShape.TYPE;
        edge.m_radius = this.m_radius;
        edge.m_vertex1 = this.m_vertices[childIndex];
        edge.m_vertex2 = this.m_vertices[childIndex + 1];
        if (childIndex > 0) {
          edge.m_vertex0 = this.m_vertices[childIndex - 1];
          edge.m_hasVertex0 = true;
        } else {
          edge.m_vertex0 = this.m_prevVertex;
          edge.m_hasVertex0 = this.m_hasPrevVertex;
        }
        if (childIndex < this.m_count - 2) {
          edge.m_vertex3 = this.m_vertices[childIndex + 2];
          edge.m_hasVertex3 = true;
        } else {
          edge.m_vertex3 = this.m_nextVertex;
          edge.m_hasVertex3 = this.m_hasNextVertex;
        }
      };
      ChainShape2.prototype.getVertex = function(index) {
        if (index < this.m_count) {
          return this.m_vertices[index];
        } else {
          return this.m_vertices[0];
        }
      };
      ChainShape2.prototype.isLoop = function() {
        return this.m_isLoop;
      };
      ChainShape2.prototype.testPoint = function(xf2, p) {
        return false;
      };
      ChainShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var edgeShape = new EdgeShape(this.getVertex(childIndex), this.getVertex(childIndex + 1));
        return edgeShape.rayCast(output2, input2, xf2, 0);
      };
      ChainShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        transformVec2(v1$1, xf2, this.getVertex(childIndex));
        transformVec2(v2, xf2, this.getVertex(childIndex + 1));
        AABB.combinePoints(aabb, v1$1, v2);
      };
      ChainShape2.prototype.computeMass = function(massData, density) {
        massData.mass = 0;
        zeroVec2(massData.center);
        massData.I = 0;
      };
      ChainShape2.prototype.computeDistanceProxy = function(proxy, childIndex) {
        proxy.m_vertices[0] = this.getVertex(childIndex);
        proxy.m_vertices[1] = this.getVertex(childIndex + 1);
        proxy.m_count = 2;
        proxy.m_radius = this.m_radius;
      };
      ChainShape2.TYPE = "chain";
      return ChainShape2;
    }(Shape)
  );
  var math_max$1 = Math.max;
  var math_min$3 = Math.min;
  var temp$1 = vec2(0, 0);
  var e$1 = vec2(0, 0);
  var e1$1 = vec2(0, 0);
  var e2$1 = vec2(0, 0);
  var center = vec2(0, 0);
  var s = vec2(0, 0);
  var PolygonShape = (
    /** @class */
    function(_super) {
      __extends(PolygonShape2, _super);
      function PolygonShape2(vertices) {
        var _this = this;
        if (!(_this instanceof PolygonShape2)) {
          return new PolygonShape2(vertices);
        }
        _this = _super.call(this) || this;
        _this.m_type = PolygonShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_centroid = Vec2.zero();
        _this.m_vertices = [];
        _this.m_normals = [];
        _this.m_count = 0;
        if (vertices && vertices.length) {
          _this._set(vertices);
        }
        return _this;
      }
      PolygonShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          vertices: this.m_vertices
        };
      };
      PolygonShape2._deserialize = function(data, fixture, restore) {
        var vertices = [];
        if (data.vertices) {
          for (var i = 0; i < data.vertices.length; i++) {
            vertices.push(restore(Vec2, data.vertices[i]));
          }
        }
        var shape = new PolygonShape2(vertices);
        return shape;
      };
      PolygonShape2.prototype.getType = function() {
        return this.m_type;
      };
      PolygonShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      PolygonShape2.prototype._clone = function() {
        var clone = new PolygonShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_count = this.m_count;
        clone.m_centroid.setVec2(this.m_centroid);
        for (var i = 0; i < this.m_count; i++) {
          clone.m_vertices.push(this.m_vertices[i].clone());
        }
        for (var i = 0; i < this.m_normals.length; i++) {
          clone.m_normals.push(this.m_normals[i].clone());
        }
        return clone;
      };
      PolygonShape2.prototype.getChildCount = function() {
        return 1;
      };
      PolygonShape2.prototype._reset = function() {
        this._set(this.m_vertices);
      };
      PolygonShape2.prototype._set = function(vertices) {
        if (vertices.length < 3) {
          this._setAsBox(1, 1);
          return;
        }
        var n2 = math_min$3(vertices.length, SettingsInternal.maxPolygonVertices);
        var ps = [];
        for (var i = 0; i < n2; ++i) {
          var v3 = vertices[i];
          var unique = true;
          for (var j = 0; j < ps.length; ++j) {
            if (Vec2.distanceSquared(v3, ps[j]) < 0.25 * SettingsInternal.linearSlopSquared) {
              unique = false;
              break;
            }
          }
          if (unique) {
            ps.push(Vec2.clone(v3));
          }
        }
        n2 = ps.length;
        if (n2 < 3) {
          this._setAsBox(1, 1);
          return;
        }
        var i0 = 0;
        var x0 = ps[0].x;
        for (var i = 1; i < n2; ++i) {
          var x2 = ps[i].x;
          if (x2 > x0 || x2 === x0 && ps[i].y < ps[i0].y) {
            i0 = i;
            x0 = x2;
          }
        }
        var hull = [];
        var m = 0;
        var ih = i0;
        while (true) {
          hull[m] = ih;
          var ie2 = 0;
          for (var j = 1; j < n2; ++j) {
            if (ie2 === ih) {
              ie2 = j;
              continue;
            }
            var r = Vec2.sub(ps[ie2], ps[hull[m]]);
            var v3 = Vec2.sub(ps[j], ps[hull[m]]);
            var c2 = Vec2.crossVec2Vec2(r, v3);
            if (c2 < 0) {
              ie2 = j;
            }
            if (c2 === 0 && v3.lengthSquared() > r.lengthSquared()) {
              ie2 = j;
            }
          }
          ++m;
          ih = ie2;
          if (ie2 === i0) {
            break;
          }
        }
        if (m < 3) {
          this._setAsBox(1, 1);
          return;
        }
        this.m_count = m;
        this.m_vertices = [];
        for (var i = 0; i < m; ++i) {
          this.m_vertices[i] = ps[hull[i]];
        }
        for (var i = 0; i < m; ++i) {
          var i1 = i;
          var i2 = i + 1 < m ? i + 1 : 0;
          var edge = Vec2.sub(this.m_vertices[i2], this.m_vertices[i1]);
          this.m_normals[i] = Vec2.crossVec2Num(edge, 1);
          this.m_normals[i].normalize();
        }
        this.m_centroid = computeCentroid(this.m_vertices, m);
      };
      PolygonShape2.prototype._setAsBox = function(hx, hy, center2, angle) {
        this.m_vertices[0] = Vec2.neo(hx, -hy);
        this.m_vertices[1] = Vec2.neo(hx, hy);
        this.m_vertices[2] = Vec2.neo(-hx, hy);
        this.m_vertices[3] = Vec2.neo(-hx, -hy);
        this.m_normals[0] = Vec2.neo(1, 0);
        this.m_normals[1] = Vec2.neo(0, 1);
        this.m_normals[2] = Vec2.neo(-1, 0);
        this.m_normals[3] = Vec2.neo(0, -1);
        this.m_count = 4;
        if (center2 && Vec2.isValid(center2)) {
          angle = angle || 0;
          copyVec2(this.m_centroid, center2);
          var xf2 = Transform.identity();
          xf2.p.setVec2(center2);
          xf2.q.setAngle(angle);
          for (var i = 0; i < this.m_count; ++i) {
            this.m_vertices[i] = Transform.mulVec2(xf2, this.m_vertices[i]);
            this.m_normals[i] = Rot.mulVec2(xf2.q, this.m_normals[i]);
          }
        }
      };
      PolygonShape2.prototype.testPoint = function(xf2, p) {
        var pLocal = detransformVec2(temp$1, xf2, p);
        for (var i = 0; i < this.m_count; ++i) {
          var dot = dotVec2(this.m_normals[i], pLocal) - dotVec2(this.m_normals[i], this.m_vertices[i]);
          if (dot > 0) {
            return false;
          }
        }
        return true;
      };
      PolygonShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));
        var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));
        var d2 = Vec2.sub(p2, p1);
        var lower = 0;
        var upper = input2.maxFraction;
        var index = -1;
        for (var i = 0; i < this.m_count; ++i) {
          var numerator = Vec2.dot(this.m_normals[i], Vec2.sub(this.m_vertices[i], p1));
          var denominator = Vec2.dot(this.m_normals[i], d2);
          if (denominator == 0) {
            if (numerator < 0) {
              return false;
            }
          } else {
            if (denominator < 0 && numerator < lower * denominator) {
              lower = numerator / denominator;
              index = i;
            } else if (denominator > 0 && numerator < upper * denominator) {
              upper = numerator / denominator;
            }
          }
          if (upper < lower) {
            return false;
          }
        }
        if (index >= 0) {
          output2.fraction = lower;
          output2.normal = Rot.mulVec2(xf2.q, this.m_normals[index]);
          return true;
        }
        return false;
      };
      PolygonShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        var minX = Infinity;
        var minY = Infinity;
        var maxX = -Infinity;
        var maxY = -Infinity;
        for (var i = 0; i < this.m_count; ++i) {
          var v3 = transformVec2(temp$1, xf2, this.m_vertices[i]);
          minX = math_min$3(minX, v3.x);
          maxX = math_max$1(maxX, v3.x);
          minY = math_min$3(minY, v3.y);
          maxY = math_max$1(maxY, v3.y);
        }
        setVec2(aabb.lowerBound, minX - this.m_radius, minY - this.m_radius);
        setVec2(aabb.upperBound, maxX + this.m_radius, maxY + this.m_radius);
      };
      PolygonShape2.prototype.computeMass = function(massData, density) {
        zeroVec2(center);
        var area = 0;
        var I = 0;
        zeroVec2(s);
        for (var i = 0; i < this.m_count; ++i) {
          plusVec2(s, this.m_vertices[i]);
        }
        scaleVec2(s, 1 / this.m_count, s);
        var k_inv3 = 1 / 3;
        for (var i = 0; i < this.m_count; ++i) {
          subVec2(e1$1, this.m_vertices[i], s);
          if (i + 1 < this.m_count) {
            subVec2(e2$1, this.m_vertices[i + 1], s);
          } else {
            subVec2(e2$1, this.m_vertices[0], s);
          }
          var D = crossVec2Vec2(e1$1, e2$1);
          var triangleArea = 0.5 * D;
          area += triangleArea;
          combine2Vec2(temp$1, triangleArea * k_inv3, e1$1, triangleArea * k_inv3, e2$1);
          plusVec2(center, temp$1);
          var ex1 = e1$1.x;
          var ey1 = e1$1.y;
          var ex2 = e2$1.x;
          var ey2 = e2$1.y;
          var intx2 = ex1 * ex1 + ex2 * ex1 + ex2 * ex2;
          var inty2 = ey1 * ey1 + ey2 * ey1 + ey2 * ey2;
          I += 0.25 * k_inv3 * D * (intx2 + inty2);
        }
        massData.mass = density * area;
        scaleVec2(center, 1 / area, center);
        addVec2(massData.center, center, s);
        massData.I = density * I;
        massData.I += massData.mass * (dotVec2(massData.center, massData.center) - dotVec2(center, center));
      };
      PolygonShape2.prototype.validate = function() {
        for (var i = 0; i < this.m_count; ++i) {
          var i1 = i;
          var i2 = i < this.m_count - 1 ? i1 + 1 : 0;
          var p = this.m_vertices[i1];
          subVec2(e$1, this.m_vertices[i2], p);
          for (var j = 0; j < this.m_count; ++j) {
            if (j == i1 || j == i2) {
              continue;
            }
            var c2 = crossVec2Vec2(e$1, subVec2(temp$1, this.m_vertices[j], p));
            if (c2 < 0) {
              return false;
            }
          }
        }
        return true;
      };
      PolygonShape2.prototype.computeDistanceProxy = function(proxy) {
        for (var i = 0; i < this.m_count; ++i) {
          proxy.m_vertices[i] = this.m_vertices[i];
        }
        proxy.m_vertices.length = this.m_count;
        proxy.m_count = this.m_count;
        proxy.m_radius = this.m_radius;
      };
      PolygonShape2.TYPE = "polygon";
      return PolygonShape2;
    }(Shape)
  );
  function computeCentroid(vs, count) {
    var c2 = Vec2.zero();
    var area = 0;
    var pRef = Vec2.zero();
    var i;
    var inv3 = 1 / 3;
    for (var i = 0; i < count; ++i) {
      var p1 = pRef;
      var p2 = vs[i];
      var p3 = i + 1 < count ? vs[i + 1] : vs[0];
      var e1_1 = Vec2.sub(p2, p1);
      var e2_1 = Vec2.sub(p3, p1);
      var D = Vec2.crossVec2Vec2(e1_1, e2_1);
      var triangleArea = 0.5 * D;
      area += triangleArea;
      combine3Vec2(temp$1, 1, p1, 1, p2, 1, p3);
      plusScaleVec2(c2, triangleArea * inv3, temp$1);
    }
    c2.mul(1 / area);
    return c2;
  }
  var math_sqrt = Math.sqrt;
  var math_PI$4 = Math.PI;
  var temp = vec2(0, 0);
  var CircleShape = (
    /** @class */
    function(_super) {
      __extends(CircleShape2, _super);
      function CircleShape2(a2, b2) {
        var _this = this;
        if (!(_this instanceof CircleShape2)) {
          return new CircleShape2(a2, b2);
        }
        _this = _super.call(this) || this;
        _this.m_type = CircleShape2.TYPE;
        _this.m_p = Vec2.zero();
        _this.m_radius = 1;
        if (typeof a2 === "object" && Vec2.isValid(a2)) {
          _this.m_p.setVec2(a2);
          if (typeof b2 === "number") {
            _this.m_radius = b2;
          }
        } else if (typeof a2 === "number") {
          _this.m_radius = a2;
        }
        return _this;
      }
      CircleShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          p: this.m_p,
          radius: this.m_radius
        };
      };
      CircleShape2._deserialize = function(data) {
        return new CircleShape2(data.p, data.radius);
      };
      CircleShape2.prototype._reset = function() {
      };
      CircleShape2.prototype.getType = function() {
        return this.m_type;
      };
      CircleShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      CircleShape2.prototype.getCenter = function() {
        return this.m_p;
      };
      CircleShape2.prototype._clone = function() {
        var clone = new CircleShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_p = this.m_p.clone();
        return clone;
      };
      CircleShape2.prototype.getChildCount = function() {
        return 1;
      };
      CircleShape2.prototype.testPoint = function(xf2, p) {
        var center2 = transformVec2(temp, xf2, this.m_p);
        return distSqrVec2(p, center2) <= this.m_radius * this.m_radius;
      };
      CircleShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var position = Vec2.add(xf2.p, Rot.mulVec2(xf2.q, this.m_p));
        var s2 = Vec2.sub(input2.p1, position);
        var b2 = Vec2.dot(s2, s2) - this.m_radius * this.m_radius;
        var r = Vec2.sub(input2.p2, input2.p1);
        var c2 = Vec2.dot(s2, r);
        var rr = Vec2.dot(r, r);
        var sigma = c2 * c2 - rr * b2;
        if (sigma < 0 || rr < EPSILON) {
          return false;
        }
        var a2 = -(c2 + math_sqrt(sigma));
        if (0 <= a2 && a2 <= input2.maxFraction * rr) {
          a2 /= rr;
          output2.fraction = a2;
          output2.normal = Vec2.add(s2, Vec2.mulNumVec2(a2, r));
          output2.normal.normalize();
          return true;
        }
        return false;
      };
      CircleShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        var p = transformVec2(temp, xf2, this.m_p);
        setVec2(aabb.lowerBound, p.x - this.m_radius, p.y - this.m_radius);
        setVec2(aabb.upperBound, p.x + this.m_radius, p.y + this.m_radius);
      };
      CircleShape2.prototype.computeMass = function(massData, density) {
        massData.mass = density * math_PI$4 * this.m_radius * this.m_radius;
        copyVec2(massData.center, this.m_p);
        massData.I = massData.mass * (0.5 * this.m_radius * this.m_radius + lengthSqrVec2(this.m_p));
      };
      CircleShape2.prototype.computeDistanceProxy = function(proxy) {
        proxy.m_vertices[0] = this.m_p;
        proxy.m_vertices.length = 1;
        proxy.m_count = 1;
        proxy.m_radius = this.m_radius;
      };
      CircleShape2.TYPE = "circle";
      return CircleShape2;
    }(Shape)
  );
  var math_abs$5 = Math.abs;
  var math_PI$3 = Math.PI;
  var DEFAULTS$a = {
    frequencyHz: 0,
    dampingRatio: 0
  };
  var DistanceJoint = (
    /** @class */
    function(_super) {
      __extends(DistanceJoint2, _super);
      function DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB) {
        var _this = this;
        if (!(_this instanceof DistanceJoint2)) {
          return new DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB);
        }
        if (bodyB && anchorA && "m_type" in anchorA && "x" in bodyB && "y" in bodyB) {
          var temp3 = bodyB;
          bodyB = anchorA;
          anchorA = temp3;
        }
        def = options(def, DEFAULTS$a);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = DistanceJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.zero());
        _this.m_length = Number.isFinite(def.length) ? def.length : Vec2.distance(bodyA.getWorldPoint(_this.m_localAnchorA), bodyB.getWorldPoint(_this.m_localAnchorB));
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_impulse = 0;
        _this.m_gamma = 0;
        _this.m_bias = 0;
        return _this;
      }
      DistanceJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          length: this.m_length,
          impulse: this.m_impulse,
          gamma: this.m_gamma,
          bias: this.m_bias
        };
      };
      DistanceJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new DistanceJoint2(data);
        return joint;
      };
      DistanceJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.length > 0) {
          this.m_length = +def.length;
        } else if (def.length < 0) ;
        else if (def.anchorA || def.anchorA || def.anchorA || def.anchorA) {
          this.m_length = Vec2.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA), this.m_bodyB.getWorldPoint(this.m_localAnchorB));
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      DistanceJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      DistanceJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      DistanceJoint2.prototype.setLength = function(length) {
        this.m_length = length;
      };
      DistanceJoint2.prototype.getLength = function() {
        return this.m_length;
      };
      DistanceJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      DistanceJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      DistanceJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      DistanceJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      DistanceJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      DistanceJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      DistanceJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);
      };
      DistanceJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      DistanceJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        this.m_u = Vec2.sub(Vec2.add(cB2, this.m_rB), Vec2.add(cA2, this.m_rA));
        var length = this.m_u.length();
        if (length > SettingsInternal.linearSlop) {
          this.m_u.mul(1 / length);
        } else {
          this.m_u.setNum(0, 0);
        }
        var crAu = Vec2.crossVec2Vec2(this.m_rA, this.m_u);
        var crBu = Vec2.crossVec2Vec2(this.m_rB, this.m_u);
        var invMass = this.m_invMassA + this.m_invIA * crAu * crAu + this.m_invMassB + this.m_invIB * crBu * crBu;
        this.m_mass = invMass != 0 ? 1 / invMass : 0;
        if (this.m_frequencyHz > 0) {
          var C = length - this.m_length;
          var omega = 2 * math_PI$3 * this.m_frequencyHz;
          var d2 = 2 * this.m_mass * this.m_dampingRatio * omega;
          var k = this.m_mass * omega * omega;
          var h = step.dt;
          this.m_gamma = h * (d2 + h * k);
          this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;
          this.m_bias = C * h * k * this.m_gamma;
          invMass += this.m_gamma;
          this.m_mass = invMass != 0 ? 1 / invMass : 0;
        } else {
          this.m_gamma = 0;
          this.m_bias = 0;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      DistanceJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));
        var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));
        var Cdot = Vec2.dot(this.m_u, vpB) - Vec2.dot(this.m_u, vpA);
        var impulse = -this.m_mass * (Cdot + this.m_bias + this.m_gamma * this.m_impulse);
        this.m_impulse += impulse;
        var P3 = Vec2.mulNumVec2(impulse, this.m_u);
        vA2.subMul(this.m_invMassA, P3);
        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
        vB2.addMul(this.m_invMassB, P3);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      DistanceJoint2.prototype.solvePositionConstraints = function(step) {
        if (this.m_frequencyHz > 0) {
          return true;
        }
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        var u = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));
        var length = u.normalize();
        var C = clamp(length - this.m_length, -SettingsInternal.maxLinearCorrection, SettingsInternal.maxLinearCorrection);
        var impulse = -this.m_mass * C;
        var P3 = Vec2.mulNumVec2(impulse, u);
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return math_abs$5(C) < SettingsInternal.linearSlop;
      };
      DistanceJoint2.TYPE = "distance-joint";
      return DistanceJoint2;
    }(Joint)
  );
  var DEFAULTS$9 = {
    maxForce: 0,
    maxTorque: 0
  };
  var FrictionJoint = (
    /** @class */
    function(_super) {
      __extends(FrictionJoint2, _super);
      function FrictionJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof FrictionJoint2)) {
          return new FrictionJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$9);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = FrictionJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_linearImpulse = Vec2.zero();
        _this.m_angularImpulse = 0;
        _this.m_maxForce = def.maxForce;
        _this.m_maxTorque = def.maxTorque;
        return _this;
      }
      FrictionJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          maxForce: this.m_maxForce,
          maxTorque: this.m_maxTorque,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB
        };
      };
      FrictionJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new FrictionJoint2(data);
        return joint;
      };
      FrictionJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.maxTorque)) {
          this.m_maxTorque = def.maxTorque;
        }
      };
      FrictionJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      FrictionJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      FrictionJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      FrictionJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      FrictionJoint2.prototype.setMaxTorque = function(torque) {
        this.m_maxTorque = torque;
      };
      FrictionJoint2.prototype.getMaxTorque = function() {
        return this.m_maxTorque;
      };
      FrictionJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      FrictionJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      FrictionJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);
      };
      FrictionJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_angularImpulse;
      };
      FrictionJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat22();
        K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;
        K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;
        this.m_linearMass = K.getInverse();
        this.m_angularMass = iA + iB;
        if (this.m_angularMass > 0) {
          this.m_angularMass = 1 / this.m_angularMass;
        }
        if (step.warmStarting) {
          this.m_linearImpulse.mul(step.dtRatio);
          this.m_angularImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);
        } else {
          this.m_linearImpulse.setZero();
          this.m_angularImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      FrictionJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var h = step.dt;
        {
          var Cdot = wB - wA;
          var impulse = -this.m_angularMass * Cdot;
          var oldImpulse = this.m_angularImpulse;
          var maxImpulse = h * this.m_maxTorque;
          this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_angularImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.sub(Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB)), Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA)));
          var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));
          var oldImpulse = this.m_linearImpulse;
          this.m_linearImpulse.add(impulse);
          var maxImpulse = h * this.m_maxForce;
          if (this.m_linearImpulse.lengthSquared() > maxImpulse * maxImpulse) {
            this.m_linearImpulse.normalize();
            this.m_linearImpulse.mul(maxImpulse);
          }
          impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      FrictionJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      FrictionJoint2.TYPE = "friction-joint";
      return FrictionJoint2;
    }(Joint)
  );
  var Mat33 = (
    /** @class */
    function() {
      function Mat332(a2, b2, c2) {
        if (typeof a2 === "object" && a2 !== null) {
          this.ex = Vec3.clone(a2);
          this.ey = Vec3.clone(b2);
          this.ez = Vec3.clone(c2);
        } else {
          this.ex = Vec3.zero();
          this.ey = Vec3.zero();
          this.ez = Vec3.zero();
        }
      }
      Mat332.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Mat332.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec3.isValid(obj.ex) && Vec3.isValid(obj.ey) && Vec3.isValid(obj.ez);
      };
      Mat332.assert = function(o) {
      };
      Mat332.prototype.setZero = function() {
        this.ex.setZero();
        this.ey.setZero();
        this.ez.setZero();
        return this;
      };
      Mat332.prototype.solve33 = function(v3) {
        var cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;
        var cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;
        var cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;
        var det = this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z;
        if (det !== 0) {
          det = 1 / det;
        }
        var r = new Vec3();
        cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;
        cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;
        cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;
        r.x = det * (v3.x * cross_x + v3.y * cross_y + v3.z * cross_z);
        cross_x = v3.y * this.ez.z - v3.z * this.ez.y;
        cross_y = v3.z * this.ez.x - v3.x * this.ez.z;
        cross_z = v3.x * this.ez.y - v3.y * this.ez.x;
        r.y = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);
        cross_x = this.ey.y * v3.z - this.ey.z * v3.y;
        cross_y = this.ey.z * v3.x - this.ey.x * v3.z;
        cross_z = this.ey.x * v3.y - this.ey.y * v3.x;
        r.z = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);
        return r;
      };
      Mat332.prototype.solve22 = function(v3) {
        var a11 = this.ex.x;
        var a12 = this.ey.x;
        var a21 = this.ex.y;
        var a22 = this.ey.y;
        var det = a11 * a22 - a12 * a21;
        if (det !== 0) {
          det = 1 / det;
        }
        var r = Vec2.zero();
        r.x = det * (a22 * v3.x - a12 * v3.y);
        r.y = det * (a11 * v3.y - a21 * v3.x);
        return r;
      };
      Mat332.prototype.getInverse22 = function(M) {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        M.ex.x = det * d2;
        M.ey.x = -det * b2;
        M.ex.z = 0;
        M.ex.y = -det * c2;
        M.ey.y = det * a2;
        M.ey.z = 0;
        M.ez.x = 0;
        M.ez.y = 0;
        M.ez.z = 0;
      };
      Mat332.prototype.getSymInverse33 = function(M) {
        var det = Vec3.dot(this.ex, Vec3.cross(this.ey, this.ez));
        if (det !== 0) {
          det = 1 / det;
        }
        var a11 = this.ex.x;
        var a12 = this.ey.x;
        var a13 = this.ez.x;
        var a22 = this.ey.y;
        var a23 = this.ez.y;
        var a33 = this.ez.z;
        M.ex.x = det * (a22 * a33 - a23 * a23);
        M.ex.y = det * (a13 * a23 - a12 * a33);
        M.ex.z = det * (a12 * a23 - a13 * a22);
        M.ey.x = M.ex.y;
        M.ey.y = det * (a11 * a33 - a13 * a13);
        M.ey.z = det * (a13 * a12 - a11 * a23);
        M.ez.x = M.ex.z;
        M.ez.y = M.ey.z;
        M.ez.z = det * (a11 * a22 - a12 * a12);
      };
      Mat332.mul = function(a2, b2) {
        if (b2 && "z" in b2 && "y" in b2 && "x" in b2) {
          var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;
          var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;
          var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;
          return new Vec3(x2, y, z);
        } else if (b2 && "y" in b2 && "x" in b2) {
          var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;
          var y = a2.ex.y * b2.x + a2.ey.y * b2.y;
          return Vec2.neo(x2, y);
        }
      };
      Mat332.mulVec3 = function(a2, b2) {
        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;
        var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;
        var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;
        return new Vec3(x2, y, z);
      };
      Mat332.mulVec2 = function(a2, b2) {
        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;
        var y = a2.ex.y * b2.x + a2.ey.y * b2.y;
        return Vec2.neo(x2, y);
      };
      Mat332.add = function(a2, b2) {
        return new Mat332(Vec3.add(a2.ex, b2.ex), Vec3.add(a2.ey, b2.ey), Vec3.add(a2.ez, b2.ez));
      };
      return Mat332;
    }()
  );
  var math_abs$4 = Math.abs;
  var LimitState$2;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState$2 || (LimitState$2 = {}));
  var DEFAULTS$8 = {
    lowerAngle: 0,
    upperAngle: 0,
    maxMotorTorque: 0,
    motorSpeed: 0,
    enableLimit: false,
    enableMotor: false
  };
  var RevoluteJoint = (
    /** @class */
    function(_super) {
      __extends(RevoluteJoint2, _super);
      function RevoluteJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        var _a2, _b, _c, _d, _e, _f;
        if (!(_this instanceof RevoluteJoint2)) {
          return new RevoluteJoint2(def, bodyA, bodyB, anchor);
        }
        def = def !== null && def !== void 0 ? def : {};
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_mass = new Mat33();
        _this.m_limitState = LimitState$2.inactiveLimit;
        _this.m_type = RevoluteJoint2.TYPE;
        if (Vec2.isValid(anchor)) {
          _this.m_localAnchorA = bodyA.getLocalPoint(anchor);
        } else if (Vec2.isValid(def.localAnchorA)) {
          _this.m_localAnchorA = Vec2.clone(def.localAnchorA);
        } else {
          _this.m_localAnchorA = Vec2.zero();
        }
        if (Vec2.isValid(anchor)) {
          _this.m_localAnchorB = bodyB.getLocalPoint(anchor);
        } else if (Vec2.isValid(def.localAnchorB)) {
          _this.m_localAnchorB = Vec2.clone(def.localAnchorB);
        } else {
          _this.m_localAnchorB = Vec2.zero();
        }
        if (Number.isFinite(def.referenceAngle)) {
          _this.m_referenceAngle = def.referenceAngle;
        } else {
          _this.m_referenceAngle = bodyB.getAngle() - bodyA.getAngle();
        }
        _this.m_impulse = new Vec3();
        _this.m_motorImpulse = 0;
        _this.m_lowerAngle = (_a2 = def.lowerAngle) !== null && _a2 !== void 0 ? _a2 : DEFAULTS$8.lowerAngle;
        _this.m_upperAngle = (_b = def.upperAngle) !== null && _b !== void 0 ? _b : DEFAULTS$8.upperAngle;
        _this.m_maxMotorTorque = (_c = def.maxMotorTorque) !== null && _c !== void 0 ? _c : DEFAULTS$8.maxMotorTorque;
        _this.m_motorSpeed = (_d = def.motorSpeed) !== null && _d !== void 0 ? _d : DEFAULTS$8.motorSpeed;
        _this.m_enableLimit = (_e = def.enableLimit) !== null && _e !== void 0 ? _e : DEFAULTS$8.enableLimit;
        _this.m_enableMotor = (_f = def.enableMotor) !== null && _f !== void 0 ? _f : DEFAULTS$8.enableMotor;
        return _this;
      }
      RevoluteJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          lowerAngle: this.m_lowerAngle,
          upperAngle: this.m_upperAngle,
          maxMotorTorque: this.m_maxMotorTorque,
          motorSpeed: this.m_motorSpeed,
          enableLimit: this.m_enableLimit,
          enableMotor: this.m_enableMotor,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          referenceAngle: this.m_referenceAngle
        };
      };
      RevoluteJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new RevoluteJoint2(data);
        return joint;
      };
      RevoluteJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.referenceAngle)) {
          this.m_referenceAngle = def.referenceAngle;
        }
        if (def.enableLimit !== void 0) {
          this.m_enableLimit = def.enableLimit;
        }
        if (Number.isFinite(def.lowerAngle)) {
          this.m_lowerAngle = def.lowerAngle;
        }
        if (Number.isFinite(def.upperAngle)) {
          this.m_upperAngle = def.upperAngle;
        }
        if (Number.isFinite(def.maxMotorTorque)) {
          this.m_maxMotorTorque = def.maxMotorTorque;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
        if (def.enableMotor !== void 0) {
          this.m_enableMotor = def.enableMotor;
        }
      };
      RevoluteJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      RevoluteJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      RevoluteJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      RevoluteJoint2.prototype.getJointAngle = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        return bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
      };
      RevoluteJoint2.prototype.getJointSpeed = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        return bB.m_angularVelocity - bA.m_angularVelocity;
      };
      RevoluteJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      RevoluteJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      RevoluteJoint2.prototype.getMotorTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      RevoluteJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      RevoluteJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      RevoluteJoint2.prototype.setMaxMotorTorque = function(torque) {
        if (torque == this.m_maxMotorTorque)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorTorque = torque;
      };
      RevoluteJoint2.prototype.getMaxMotorTorque = function() {
        return this.m_maxMotorTorque;
      };
      RevoluteJoint2.prototype.isLimitEnabled = function() {
        return this.m_enableLimit;
      };
      RevoluteJoint2.prototype.enableLimit = function(flag) {
        if (flag != this.m_enableLimit) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_enableLimit = flag;
          this.m_impulse.z = 0;
        }
      };
      RevoluteJoint2.prototype.getLowerLimit = function() {
        return this.m_lowerAngle;
      };
      RevoluteJoint2.prototype.getUpperLimit = function() {
        return this.m_upperAngle;
      };
      RevoluteJoint2.prototype.setLimits = function(lower, upper) {
        if (lower != this.m_lowerAngle || upper != this.m_upperAngle) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_impulse.z = 0;
          this.m_lowerAngle = lower;
          this.m_upperAngle = upper;
        }
      };
      RevoluteJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      RevoluteJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      RevoluteJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);
      };
      RevoluteJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.z;
      };
      RevoluteJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var fixedRotation = iA + iB === 0;
        this.m_mass.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;
        this.m_mass.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;
        this.m_mass.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;
        this.m_mass.ex.y = this.m_mass.ey.x;
        this.m_mass.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;
        this.m_mass.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;
        this.m_mass.ex.z = this.m_mass.ez.x;
        this.m_mass.ey.z = this.m_mass.ez.y;
        this.m_mass.ez.z = iA + iB;
        this.m_motorMass = iA + iB;
        if (this.m_motorMass > 0) {
          this.m_motorMass = 1 / this.m_motorMass;
        }
        if (this.m_enableMotor == false || fixedRotation) {
          this.m_motorImpulse = 0;
        }
        if (this.m_enableLimit && fixedRotation == false) {
          var jointAngle = aB - aA - this.m_referenceAngle;
          if (math_abs$4(this.m_upperAngle - this.m_lowerAngle) < 2 * SettingsInternal.angularSlop) {
            this.m_limitState = LimitState$2.equalLimits;
          } else if (jointAngle <= this.m_lowerAngle) {
            if (this.m_limitState != LimitState$2.atLowerLimit) {
              this.m_impulse.z = 0;
            }
            this.m_limitState = LimitState$2.atLowerLimit;
          } else if (jointAngle >= this.m_upperAngle) {
            if (this.m_limitState != LimitState$2.atUpperLimit) {
              this.m_impulse.z = 0;
            }
            this.m_limitState = LimitState$2.atUpperLimit;
          } else {
            this.m_limitState = LimitState$2.inactiveLimit;
            this.m_impulse.z = 0;
          }
        } else {
          this.m_limitState = LimitState$2.inactiveLimit;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_motorImpulse + this.m_impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_motorImpulse + this.m_impulse.z);
        } else {
          this.m_impulse.setZero();
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RevoluteJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var fixedRotation = iA + iB === 0;
        if (this.m_enableMotor && this.m_limitState != LimitState$2.equalLimits && fixedRotation == false) {
          var Cdot = wB - wA - this.m_motorSpeed;
          var impulse = -this.m_motorMass * Cdot;
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorTorque;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var Cdot2 = wB - wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var impulse = Vec3.neg(this.m_mass.solve33(Cdot));
          if (this.m_limitState == LimitState$2.equalLimits) {
            this.m_impulse.add(impulse);
          } else if (this.m_limitState == LimitState$2.atLowerLimit) {
            var newImpulse = this.m_impulse.z + impulse.z;
            if (newImpulse < 0) {
              var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));
              var reduced = this.m_mass.solve22(rhs);
              impulse.x = reduced.x;
              impulse.y = reduced.y;
              impulse.z = -this.m_impulse.z;
              this.m_impulse.x += reduced.x;
              this.m_impulse.y += reduced.y;
              this.m_impulse.z = 0;
            } else {
              this.m_impulse.add(impulse);
            }
          } else if (this.m_limitState == LimitState$2.atUpperLimit) {
            var newImpulse = this.m_impulse.z + impulse.z;
            if (newImpulse > 0) {
              var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));
              var reduced = this.m_mass.solve22(rhs);
              impulse.x = reduced.x;
              impulse.y = reduced.y;
              impulse.z = -this.m_impulse.z;
              this.m_impulse.x += reduced.x;
              this.m_impulse.y += reduced.y;
              this.m_impulse.z = 0;
            } else {
              this.m_impulse.add(impulse);
            }
          }
          var P3 = Vec2.neo(impulse.x, impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);
        } else {
          var Cdot = Vec2.zero();
          Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var impulse = this.m_mass.solve22(Vec2.neg(Cdot));
          this.m_impulse.x += impulse.x;
          this.m_impulse.y += impulse.y;
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RevoluteJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var angularError = 0;
        var positionError = 0;
        var fixedRotation = this.m_invIA + this.m_invIB == 0;
        if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {
          var angle = aB - aA - this.m_referenceAngle;
          var limitImpulse = 0;
          if (this.m_limitState == LimitState$2.equalLimits) {
            var C = clamp(angle - this.m_lowerAngle, -SettingsInternal.maxAngularCorrection, SettingsInternal.maxAngularCorrection);
            limitImpulse = -this.m_motorMass * C;
            angularError = math_abs$4(C);
          } else if (this.m_limitState == LimitState$2.atLowerLimit) {
            var C = angle - this.m_lowerAngle;
            angularError = -C;
            C = clamp(C + SettingsInternal.angularSlop, -SettingsInternal.maxAngularCorrection, 0);
            limitImpulse = -this.m_motorMass * C;
          } else if (this.m_limitState == LimitState$2.atUpperLimit) {
            var C = angle - this.m_upperAngle;
            angularError = C;
            C = clamp(C - SettingsInternal.angularSlop, 0, SettingsInternal.maxAngularCorrection);
            limitImpulse = -this.m_motorMass * C;
          }
          aA -= this.m_invIA * limitImpulse;
          aB += this.m_invIB * limitImpulse;
        }
        {
          qA.setAngle(aA);
          qB.setAngle(aB);
          var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
          var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
          var C = Vec2.zero();
          C.addCombine(1, cB2, 1, rB2);
          C.subCombine(1, cA2, 1, rA2);
          positionError = C.length();
          var mA = this.m_invMassA;
          var mB = this.m_invMassB;
          var iA = this.m_invIA;
          var iB = this.m_invIB;
          var K = new Mat22();
          K.ex.x = mA + mB + iA * rA2.y * rA2.y + iB * rB2.y * rB2.y;
          K.ex.y = -iA * rA2.x * rA2.y - iB * rB2.x * rB2.y;
          K.ey.x = K.ex.y;
          K.ey.y = mA + mB + iA * rA2.x * rA2.x + iB * rB2.x * rB2.x;
          var impulse = Vec2.neg(K.solve(C));
          cA2.subMul(mA, impulse);
          aA -= iA * Vec2.crossVec2Vec2(rA2, impulse);
          cB2.addMul(mB, impulse);
          aB += iB * Vec2.crossVec2Vec2(rB2, impulse);
        }
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      RevoluteJoint2.TYPE = "revolute-joint";
      return RevoluteJoint2;
    }(Joint)
  );
  var math_abs$3 = Math.abs;
  var math_max = Math.max;
  var math_min$2 = Math.min;
  var LimitState$1;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState$1 || (LimitState$1 = {}));
  var DEFAULTS$7 = {
    enableLimit: false,
    lowerTranslation: 0,
    upperTranslation: 0,
    enableMotor: false,
    maxMotorForce: 0,
    motorSpeed: 0
  };
  var PrismaticJoint = (
    /** @class */
    function(_super) {
      __extends(PrismaticJoint2, _super);
      function PrismaticJoint2(def, bodyA, bodyB, anchor, axis) {
        var _this = this;
        if (!(_this instanceof PrismaticJoint2)) {
          return new PrismaticJoint2(def, bodyA, bodyB, anchor, axis);
        }
        def = options(def, DEFAULTS$7);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = PrismaticJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_localXAxisA = Vec2.clone(axis ? bodyA.getLocalVector(axis) : def.localAxisA || Vec2.neo(1, 0));
        _this.m_localXAxisA.normalize();
        _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);
        _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();
        _this.m_impulse = new Vec3();
        _this.m_motorMass = 0;
        _this.m_motorImpulse = 0;
        _this.m_lowerTranslation = def.lowerTranslation;
        _this.m_upperTranslation = def.upperTranslation;
        _this.m_maxMotorForce = def.maxMotorForce;
        _this.m_motorSpeed = def.motorSpeed;
        _this.m_enableLimit = def.enableLimit;
        _this.m_enableMotor = def.enableMotor;
        _this.m_limitState = LimitState$1.inactiveLimit;
        _this.m_axis = Vec2.zero();
        _this.m_perp = Vec2.zero();
        _this.m_K = new Mat33();
        return _this;
      }
      PrismaticJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          lowerTranslation: this.m_lowerTranslation,
          upperTranslation: this.m_upperTranslation,
          maxMotorForce: this.m_maxMotorForce,
          motorSpeed: this.m_motorSpeed,
          enableLimit: this.m_enableLimit,
          enableMotor: this.m_enableMotor,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          localAxisA: this.m_localXAxisA,
          referenceAngle: this.m_referenceAngle
        };
      };
      PrismaticJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.localAxisA = Vec2.clone(data.localAxisA);
        var joint = new PrismaticJoint2(data);
        return joint;
      };
      PrismaticJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.localAxisA) {
          this.m_localXAxisA.setVec2(def.localAxisA);
          this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));
        }
        if (Number.isFinite(def.referenceAngle)) {
          this.m_referenceAngle = def.referenceAngle;
        }
        if (typeof def.enableLimit !== "undefined") {
          this.m_enableLimit = !!def.enableLimit;
        }
        if (Number.isFinite(def.lowerTranslation)) {
          this.m_lowerTranslation = def.lowerTranslation;
        }
        if (Number.isFinite(def.upperTranslation)) {
          this.m_upperTranslation = def.upperTranslation;
        }
        if (typeof def.enableMotor !== "undefined") {
          this.m_enableMotor = !!def.enableMotor;
        }
        if (Number.isFinite(def.maxMotorForce)) {
          this.m_maxMotorForce = def.maxMotorForce;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
      };
      PrismaticJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      PrismaticJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      PrismaticJoint2.prototype.getLocalAxisA = function() {
        return this.m_localXAxisA;
      };
      PrismaticJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      PrismaticJoint2.prototype.getJointTranslation = function() {
        var pA2 = this.m_bodyA.getWorldPoint(this.m_localAnchorA);
        var pB2 = this.m_bodyB.getWorldPoint(this.m_localAnchorB);
        var d2 = Vec2.sub(pB2, pA2);
        var axis = this.m_bodyA.getWorldVector(this.m_localXAxisA);
        var translation2 = Vec2.dot(d2, axis);
        return translation2;
      };
      PrismaticJoint2.prototype.getJointSpeed = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        var rA2 = Rot.mulVec2(bA.m_xf.q, Vec2.sub(this.m_localAnchorA, bA.m_sweep.localCenter));
        var rB2 = Rot.mulVec2(bB.m_xf.q, Vec2.sub(this.m_localAnchorB, bB.m_sweep.localCenter));
        var p1 = Vec2.add(bA.m_sweep.c, rA2);
        var p2 = Vec2.add(bB.m_sweep.c, rB2);
        var d2 = Vec2.sub(p2, p1);
        var axis = Rot.mulVec2(bA.m_xf.q, this.m_localXAxisA);
        var vA2 = bA.m_linearVelocity;
        var vB2 = bB.m_linearVelocity;
        var wA = bA.m_angularVelocity;
        var wB = bB.m_angularVelocity;
        var speed = Vec2.dot(d2, Vec2.crossNumVec2(wA, axis)) + Vec2.dot(axis, Vec2.sub(Vec2.addCrossNumVec2(vB2, wB, rB2), Vec2.addCrossNumVec2(vA2, wA, rA2)));
        return speed;
      };
      PrismaticJoint2.prototype.isLimitEnabled = function() {
        return this.m_enableLimit;
      };
      PrismaticJoint2.prototype.enableLimit = function(flag) {
        if (flag != this.m_enableLimit) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_enableLimit = flag;
          this.m_impulse.z = 0;
        }
      };
      PrismaticJoint2.prototype.getLowerLimit = function() {
        return this.m_lowerTranslation;
      };
      PrismaticJoint2.prototype.getUpperLimit = function() {
        return this.m_upperTranslation;
      };
      PrismaticJoint2.prototype.setLimits = function(lower, upper) {
        if (lower != this.m_lowerTranslation || upper != this.m_upperTranslation) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_lowerTranslation = lower;
          this.m_upperTranslation = upper;
          this.m_impulse.z = 0;
        }
      };
      PrismaticJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      PrismaticJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      PrismaticJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      PrismaticJoint2.prototype.setMaxMotorForce = function(force) {
        if (force == this.m_maxMotorForce)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorForce = force;
      };
      PrismaticJoint2.prototype.getMaxMotorForce = function() {
        return this.m_maxMotorForce;
      };
      PrismaticJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      PrismaticJoint2.prototype.getMotorForce = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      PrismaticJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      PrismaticJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      PrismaticJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis).mul(inv_dt);
      };
      PrismaticJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.y;
      };
      PrismaticJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        {
          this.m_axis = Rot.mulVec2(qA, this.m_localXAxisA);
          this.m_a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_axis);
          this.m_a2 = Vec2.crossVec2Vec2(rB2, this.m_axis);
          this.m_motorMass = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;
          if (this.m_motorMass > 0) {
            this.m_motorMass = 1 / this.m_motorMass;
          }
        }
        {
          this.m_perp = Rot.mulVec2(qA, this.m_localYAxisA);
          this.m_s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_perp);
          this.m_s2 = Vec2.crossVec2Vec2(rB2, this.m_perp);
          Vec2.crossVec2Vec2(rA2, this.m_perp);
          var k11 = mA + mB + iA * this.m_s1 * this.m_s1 + iB * this.m_s2 * this.m_s2;
          var k12 = iA * this.m_s1 + iB * this.m_s2;
          var k13 = iA * this.m_s1 * this.m_a1 + iB * this.m_s2 * this.m_a2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var k23 = iA * this.m_a1 + iB * this.m_a2;
          var k33 = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;
          this.m_K.ex.set(k11, k12, k13);
          this.m_K.ey.set(k12, k22, k23);
          this.m_K.ez.set(k13, k23, k33);
        }
        if (this.m_enableLimit) {
          var jointTranslation = Vec2.dot(this.m_axis, d2);
          if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * SettingsInternal.linearSlop) {
            this.m_limitState = LimitState$1.equalLimits;
          } else if (jointTranslation <= this.m_lowerTranslation) {
            if (this.m_limitState != LimitState$1.atLowerLimit) {
              this.m_limitState = LimitState$1.atLowerLimit;
              this.m_impulse.z = 0;
            }
          } else if (jointTranslation >= this.m_upperTranslation) {
            if (this.m_limitState != LimitState$1.atUpperLimit) {
              this.m_limitState = LimitState$1.atUpperLimit;
              this.m_impulse.z = 0;
            }
          } else {
            this.m_limitState = LimitState$1.inactiveLimit;
            this.m_impulse.z = 0;
          }
        } else {
          this.m_limitState = LimitState$1.inactiveLimit;
          this.m_impulse.z = 0;
        }
        if (this.m_enableMotor == false) {
          this.m_motorImpulse = 0;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis);
          var LA = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1;
          var LB = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        } else {
          this.m_impulse.setZero();
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      PrismaticJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        if (this.m_enableMotor && this.m_limitState != LimitState$1.equalLimits) {
          var Cdot = Vec2.dot(this.m_axis, Vec2.sub(vB2, vA2)) + this.m_a2 * wB - this.m_a1 * wA;
          var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorForce;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_axis);
          var LA = impulse * this.m_a1;
          var LB = impulse * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        var Cdot1 = Vec2.zero();
        Cdot1.x += Vec2.dot(this.m_perp, vB2) + this.m_s2 * wB;
        Cdot1.x -= Vec2.dot(this.m_perp, vA2) + this.m_s1 * wA;
        Cdot1.y = wB - wA;
        if (this.m_enableLimit && this.m_limitState != LimitState$1.inactiveLimit) {
          var Cdot2 = 0;
          Cdot2 += Vec2.dot(this.m_axis, vB2) + this.m_a2 * wB;
          Cdot2 -= Vec2.dot(this.m_axis, vA2) + this.m_a1 * wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var f1 = Vec3.clone(this.m_impulse);
          var df = this.m_K.solve33(Vec3.neg(Cdot));
          this.m_impulse.add(df);
          if (this.m_limitState == LimitState$1.atLowerLimit) {
            this.m_impulse.z = math_max(this.m_impulse.z, 0);
          } else if (this.m_limitState == LimitState$1.atUpperLimit) {
            this.m_impulse.z = math_min$2(this.m_impulse.z, 0);
          }
          var b2 = Vec2.combine(-1, Cdot1, -(this.m_impulse.z - f1.z), Vec2.neo(this.m_K.ez.x, this.m_K.ez.y));
          var f2r = Vec2.add(this.m_K.solve22(b2), Vec2.neo(f1.x, f1.y));
          this.m_impulse.x = f2r.x;
          this.m_impulse.y = f2r.y;
          df = Vec3.sub(this.m_impulse, f1);
          var P3 = Vec2.combine(df.x, this.m_perp, df.z, this.m_axis);
          var LA = df.x * this.m_s1 + df.y + df.z * this.m_a1;
          var LB = df.x * this.m_s2 + df.y + df.z * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        } else {
          var df = this.m_K.solve22(Vec2.neg(Cdot1));
          this.m_impulse.x += df.x;
          this.m_impulse.y += df.y;
          var P3 = Vec2.mulNumVec2(df.x, this.m_perp);
          var LA = df.x * this.m_s1 + df.y;
          var LB = df.x * this.m_s2 + df.y;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PrismaticJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));
        var axis = Rot.mulVec2(qA, this.m_localXAxisA);
        var a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), axis);
        var a2 = Vec2.crossVec2Vec2(rB2, axis);
        var perp2 = Rot.mulVec2(qA, this.m_localYAxisA);
        var s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), perp2);
        var s2 = Vec2.crossVec2Vec2(rB2, perp2);
        var impulse = new Vec3();
        var C1 = Vec2.zero();
        C1.x = Vec2.dot(perp2, d2);
        C1.y = aB - aA - this.m_referenceAngle;
        var linearError = math_abs$3(C1.x);
        var angularError = math_abs$3(C1.y);
        var linearSlop = SettingsInternal.linearSlop;
        var maxLinearCorrection = SettingsInternal.maxLinearCorrection;
        var active = false;
        var C2 = 0;
        if (this.m_enableLimit) {
          var translation2 = Vec2.dot(axis, d2);
          if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * linearSlop) {
            C2 = clamp(translation2, -maxLinearCorrection, maxLinearCorrection);
            linearError = math_max(linearError, math_abs$3(translation2));
            active = true;
          } else if (translation2 <= this.m_lowerTranslation) {
            C2 = clamp(translation2 - this.m_lowerTranslation + linearSlop, -maxLinearCorrection, 0);
            linearError = Math.max(linearError, this.m_lowerTranslation - translation2);
            active = true;
          } else if (translation2 >= this.m_upperTranslation) {
            C2 = clamp(translation2 - this.m_upperTranslation - linearSlop, 0, maxLinearCorrection);
            linearError = Math.max(linearError, translation2 - this.m_upperTranslation);
            active = true;
          }
        }
        if (active) {
          var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;
          var k12 = iA * s1 + iB * s2;
          var k13 = iA * s1 * a1 + iB * s2 * a2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var k23 = iA * a1 + iB * a2;
          var k33 = mA + mB + iA * a1 * a1 + iB * a2 * a2;
          var K = new Mat33();
          K.ex.set(k11, k12, k13);
          K.ey.set(k12, k22, k23);
          K.ez.set(k13, k23, k33);
          var C = new Vec3();
          C.x = C1.x;
          C.y = C1.y;
          C.z = C2;
          impulse = K.solve33(Vec3.neg(C));
        } else {
          var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;
          var k12 = iA * s1 + iB * s2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var K = new Mat22();
          K.ex.setNum(k11, k12);
          K.ey.setNum(k12, k22);
          var impulse1 = K.solve(Vec2.neg(C1));
          impulse.x = impulse1.x;
          impulse.y = impulse1.y;
          impulse.z = 0;
        }
        var P3 = Vec2.combine(impulse.x, perp2, impulse.z, axis);
        var LA = impulse.x * s1 + impulse.y + impulse.z * a1;
        var LB = impulse.x * s2 + impulse.y + impulse.z * a2;
        cA2.subMul(mA, P3);
        aA -= iA * LA;
        cB2.addMul(mB, P3);
        aB += iB * LB;
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return linearError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      PrismaticJoint2.TYPE = "prismatic-joint";
      return PrismaticJoint2;
    }(Joint)
  );
  var DEFAULTS$6 = {
    ratio: 1
  };
  var GearJoint = (
    /** @class */
    function(_super) {
      __extends(GearJoint2, _super);
      function GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio) {
        var _this = this;
        if (!(_this instanceof GearJoint2)) {
          return new GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio);
        }
        def = options(def, DEFAULTS$6);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = GearJoint2.TYPE;
        _this.m_joint1 = joint1 ? joint1 : def.joint1;
        _this.m_joint2 = joint2 ? joint2 : def.joint2;
        _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;
        _this.m_type1 = _this.m_joint1.getType();
        _this.m_type2 = _this.m_joint2.getType();
        var coordinateA;
        var coordinateB;
        _this.m_bodyC = _this.m_joint1.getBodyA();
        _this.m_bodyA = _this.m_joint1.getBodyB();
        var xfA2 = _this.m_bodyA.m_xf;
        var aA = _this.m_bodyA.m_sweep.a;
        var xfC = _this.m_bodyC.m_xf;
        var aC = _this.m_bodyC.m_sweep.a;
        if (_this.m_type1 === RevoluteJoint.TYPE) {
          var revolute = _this.m_joint1;
          _this.m_localAnchorC = revolute.m_localAnchorA;
          _this.m_localAnchorA = revolute.m_localAnchorB;
          _this.m_referenceAngleA = revolute.m_referenceAngle;
          _this.m_localAxisC = Vec2.zero();
          coordinateA = aA - aC - _this.m_referenceAngleA;
        } else {
          var prismatic = _this.m_joint1;
          _this.m_localAnchorC = prismatic.m_localAnchorA;
          _this.m_localAnchorA = prismatic.m_localAnchorB;
          _this.m_referenceAngleA = prismatic.m_referenceAngle;
          _this.m_localAxisC = prismatic.m_localXAxisA;
          var pC = _this.m_localAnchorC;
          var pA2 = Rot.mulTVec2(xfC.q, Vec2.add(Rot.mulVec2(xfA2.q, _this.m_localAnchorA), Vec2.sub(xfA2.p, xfC.p)));
          coordinateA = Vec2.dot(pA2, _this.m_localAxisC) - Vec2.dot(pC, _this.m_localAxisC);
        }
        _this.m_bodyD = _this.m_joint2.getBodyA();
        _this.m_bodyB = _this.m_joint2.getBodyB();
        var xfB2 = _this.m_bodyB.m_xf;
        var aB = _this.m_bodyB.m_sweep.a;
        var xfD = _this.m_bodyD.m_xf;
        var aD = _this.m_bodyD.m_sweep.a;
        if (_this.m_type2 === RevoluteJoint.TYPE) {
          var revolute = _this.m_joint2;
          _this.m_localAnchorD = revolute.m_localAnchorA;
          _this.m_localAnchorB = revolute.m_localAnchorB;
          _this.m_referenceAngleB = revolute.m_referenceAngle;
          _this.m_localAxisD = Vec2.zero();
          coordinateB = aB - aD - _this.m_referenceAngleB;
        } else {
          var prismatic = _this.m_joint2;
          _this.m_localAnchorD = prismatic.m_localAnchorA;
          _this.m_localAnchorB = prismatic.m_localAnchorB;
          _this.m_referenceAngleB = prismatic.m_referenceAngle;
          _this.m_localAxisD = prismatic.m_localXAxisA;
          var pD = _this.m_localAnchorD;
          var pB2 = Rot.mulTVec2(xfD.q, Vec2.add(Rot.mulVec2(xfB2.q, _this.m_localAnchorB), Vec2.sub(xfB2.p, xfD.p)));
          coordinateB = Vec2.dot(pB2, _this.m_localAxisD) - Vec2.dot(pD, _this.m_localAxisD);
        }
        _this.m_constant = coordinateA + _this.m_ratio * coordinateB;
        _this.m_impulse = 0;
        return _this;
      }
      GearJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          joint1: this.m_joint1,
          joint2: this.m_joint2,
          ratio: this.m_ratio
          // _constant: this.m_constant,
        };
      };
      GearJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.joint1 = restore(Joint, data.joint1, world);
        data.joint2 = restore(Joint, data.joint2, world);
        var joint = new GearJoint2(data);
        return joint;
      };
      GearJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.ratio)) {
          this.m_ratio = def.ratio;
        }
      };
      GearJoint2.prototype.getJoint1 = function() {
        return this.m_joint1;
      };
      GearJoint2.prototype.getJoint2 = function() {
        return this.m_joint2;
      };
      GearJoint2.prototype.setRatio = function(ratio) {
        this.m_ratio = ratio;
      };
      GearJoint2.prototype.getRatio = function() {
        return this.m_ratio;
      };
      GearJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      GearJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      GearJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_JvAC).mul(inv_dt);
      };
      GearJoint2.prototype.getReactionTorque = function(inv_dt) {
        var L = this.m_impulse * this.m_JwA;
        return inv_dt * L;
      };
      GearJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_lcA = this.m_bodyA.m_sweep.localCenter;
        this.m_lcB = this.m_bodyB.m_sweep.localCenter;
        this.m_lcC = this.m_bodyC.m_sweep.localCenter;
        this.m_lcD = this.m_bodyD.m_sweep.localCenter;
        this.m_mA = this.m_bodyA.m_invMass;
        this.m_mB = this.m_bodyB.m_invMass;
        this.m_mC = this.m_bodyC.m_invMass;
        this.m_mD = this.m_bodyD.m_invMass;
        this.m_iA = this.m_bodyA.m_invI;
        this.m_iB = this.m_bodyB.m_invI;
        this.m_iC = this.m_bodyC.m_invI;
        this.m_iD = this.m_bodyD.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var aC = this.m_bodyC.c_position.a;
        var vC = this.m_bodyC.c_velocity.v;
        var wC = this.m_bodyC.c_velocity.w;
        var aD = this.m_bodyD.c_position.a;
        var vD = this.m_bodyD.c_velocity.v;
        var wD = this.m_bodyD.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var qC = Rot.neo(aC);
        var qD = Rot.neo(aD);
        this.m_mass = 0;
        if (this.m_type1 == RevoluteJoint.TYPE) {
          this.m_JvAC = Vec2.zero();
          this.m_JwA = 1;
          this.m_JwC = 1;
          this.m_mass += this.m_iA + this.m_iC;
        } else {
          var u = Rot.mulVec2(qC, this.m_localAxisC);
          var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);
          var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);
          this.m_JvAC = u;
          this.m_JwC = Vec2.crossVec2Vec2(rC, u);
          this.m_JwA = Vec2.crossVec2Vec2(rA2, u);
          this.m_mass += this.m_mC + this.m_mA + this.m_iC * this.m_JwC * this.m_JwC + this.m_iA * this.m_JwA * this.m_JwA;
        }
        if (this.m_type2 == RevoluteJoint.TYPE) {
          this.m_JvBD = Vec2.zero();
          this.m_JwB = this.m_ratio;
          this.m_JwD = this.m_ratio;
          this.m_mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);
        } else {
          var u = Rot.mulVec2(qD, this.m_localAxisD);
          var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);
          var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);
          this.m_JvBD = Vec2.mulNumVec2(this.m_ratio, u);
          this.m_JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);
          this.m_JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);
          this.m_mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * this.m_JwD * this.m_JwD + this.m_iB * this.m_JwB * this.m_JwB;
        }
        this.m_mass = this.m_mass > 0 ? 1 / this.m_mass : 0;
        if (step.warmStarting) {
          vA2.addMul(this.m_mA * this.m_impulse, this.m_JvAC);
          wA += this.m_iA * this.m_impulse * this.m_JwA;
          vB2.addMul(this.m_mB * this.m_impulse, this.m_JvBD);
          wB += this.m_iB * this.m_impulse * this.m_JwB;
          vC.subMul(this.m_mC * this.m_impulse, this.m_JvAC);
          wC -= this.m_iC * this.m_impulse * this.m_JwC;
          vD.subMul(this.m_mD * this.m_impulse, this.m_JvBD);
          wD -= this.m_iD * this.m_impulse * this.m_JwD;
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
        this.m_bodyC.c_velocity.v.setVec2(vC);
        this.m_bodyC.c_velocity.w = wC;
        this.m_bodyD.c_velocity.v.setVec2(vD);
        this.m_bodyD.c_velocity.w = wD;
      };
      GearJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vC = this.m_bodyC.c_velocity.v;
        var wC = this.m_bodyC.c_velocity.w;
        var vD = this.m_bodyD.c_velocity.v;
        var wD = this.m_bodyD.c_velocity.w;
        var Cdot = Vec2.dot(this.m_JvAC, vA2) - Vec2.dot(this.m_JvAC, vC) + Vec2.dot(this.m_JvBD, vB2) - Vec2.dot(this.m_JvBD, vD);
        Cdot += this.m_JwA * wA - this.m_JwC * wC + (this.m_JwB * wB - this.m_JwD * wD);
        var impulse = -this.m_mass * Cdot;
        this.m_impulse += impulse;
        vA2.addMul(this.m_mA * impulse, this.m_JvAC);
        wA += this.m_iA * impulse * this.m_JwA;
        vB2.addMul(this.m_mB * impulse, this.m_JvBD);
        wB += this.m_iB * impulse * this.m_JwB;
        vC.subMul(this.m_mC * impulse, this.m_JvAC);
        wC -= this.m_iC * impulse * this.m_JwC;
        vD.subMul(this.m_mD * impulse, this.m_JvBD);
        wD -= this.m_iD * impulse * this.m_JwD;
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
        this.m_bodyC.c_velocity.v.setVec2(vC);
        this.m_bodyC.c_velocity.w = wC;
        this.m_bodyD.c_velocity.v.setVec2(vD);
        this.m_bodyD.c_velocity.w = wD;
      };
      GearJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var cC = this.m_bodyC.c_position.c;
        var aC = this.m_bodyC.c_position.a;
        var cD = this.m_bodyD.c_position.c;
        var aD = this.m_bodyD.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var qC = Rot.neo(aC);
        var qD = Rot.neo(aD);
        var linearError = 0;
        var coordinateA;
        var coordinateB;
        var JvAC;
        var JvBD;
        var JwA;
        var JwB;
        var JwC;
        var JwD;
        var mass = 0;
        if (this.m_type1 == RevoluteJoint.TYPE) {
          JvAC = Vec2.zero();
          JwA = 1;
          JwC = 1;
          mass += this.m_iA + this.m_iC;
          coordinateA = aA - aC - this.m_referenceAngleA;
        } else {
          var u = Rot.mulVec2(qC, this.m_localAxisC);
          var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);
          var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);
          JvAC = u;
          JwC = Vec2.crossVec2Vec2(rC, u);
          JwA = Vec2.crossVec2Vec2(rA2, u);
          mass += this.m_mC + this.m_mA + this.m_iC * JwC * JwC + this.m_iA * JwA * JwA;
          var pC = Vec2.sub(this.m_localAnchorC, this.m_lcC);
          var pA2 = Rot.mulTVec2(qC, Vec2.add(rA2, Vec2.sub(cA2, cC)));
          coordinateA = Vec2.dot(Vec2.sub(pA2, pC), this.m_localAxisC);
        }
        if (this.m_type2 == RevoluteJoint.TYPE) {
          JvBD = Vec2.zero();
          JwB = this.m_ratio;
          JwD = this.m_ratio;
          mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);
          coordinateB = aB - aD - this.m_referenceAngleB;
        } else {
          var u = Rot.mulVec2(qD, this.m_localAxisD);
          var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);
          var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);
          JvBD = Vec2.mulNumVec2(this.m_ratio, u);
          JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);
          JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);
          mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * JwD * JwD + this.m_iB * JwB * JwB;
          var pD = Vec2.sub(this.m_localAnchorD, this.m_lcD);
          var pB2 = Rot.mulTVec2(qD, Vec2.add(rB2, Vec2.sub(cB2, cD)));
          coordinateB = Vec2.dot(pB2, this.m_localAxisD) - Vec2.dot(pD, this.m_localAxisD);
        }
        var C = coordinateA + this.m_ratio * coordinateB - this.m_constant;
        var impulse = 0;
        if (mass > 0) {
          impulse = -C / mass;
        }
        cA2.addMul(this.m_mA * impulse, JvAC);
        aA += this.m_iA * impulse * JwA;
        cB2.addMul(this.m_mB * impulse, JvBD);
        aB += this.m_iB * impulse * JwB;
        cC.subMul(this.m_mC * impulse, JvAC);
        aC -= this.m_iC * impulse * JwC;
        cD.subMul(this.m_mD * impulse, JvBD);
        aD -= this.m_iD * impulse * JwD;
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        this.m_bodyC.c_position.c.setVec2(cC);
        this.m_bodyC.c_position.a = aC;
        this.m_bodyD.c_position.c.setVec2(cD);
        this.m_bodyD.c_position.a = aD;
        return linearError < SettingsInternal.linearSlop;
      };
      GearJoint2.TYPE = "gear-joint";
      return GearJoint2;
    }(Joint)
  );
  var DEFAULTS$5 = {
    maxForce: 1,
    maxTorque: 1,
    correctionFactor: 0.3
  };
  var MotorJoint = (
    /** @class */
    function(_super) {
      __extends(MotorJoint2, _super);
      function MotorJoint2(def, bodyA, bodyB) {
        var _this = this;
        if (!(_this instanceof MotorJoint2)) {
          return new MotorJoint2(def, bodyA, bodyB);
        }
        def = options(def, DEFAULTS$5);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = MotorJoint2.TYPE;
        _this.m_linearOffset = Vec2.isValid(def.linearOffset) ? Vec2.clone(def.linearOffset) : bodyA.getLocalPoint(bodyB.getPosition());
        _this.m_angularOffset = Number.isFinite(def.angularOffset) ? def.angularOffset : bodyB.getAngle() - bodyA.getAngle();
        _this.m_linearImpulse = Vec2.zero();
        _this.m_angularImpulse = 0;
        _this.m_maxForce = def.maxForce;
        _this.m_maxTorque = def.maxTorque;
        _this.m_correctionFactor = def.correctionFactor;
        return _this;
      }
      MotorJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          maxForce: this.m_maxForce,
          maxTorque: this.m_maxTorque,
          correctionFactor: this.m_correctionFactor,
          linearOffset: this.m_linearOffset,
          angularOffset: this.m_angularOffset
        };
      };
      MotorJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new MotorJoint2(data);
        return joint;
      };
      MotorJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.angularOffset)) {
          this.m_angularOffset = def.angularOffset;
        }
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.maxTorque)) {
          this.m_maxTorque = def.maxTorque;
        }
        if (Number.isFinite(def.correctionFactor)) {
          this.m_correctionFactor = def.correctionFactor;
        }
        if (Vec2.isValid(def.linearOffset)) {
          this.m_linearOffset.set(def.linearOffset);
        }
      };
      MotorJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      MotorJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      MotorJoint2.prototype.setMaxTorque = function(torque) {
        this.m_maxTorque = torque;
      };
      MotorJoint2.prototype.getMaxTorque = function() {
        return this.m_maxTorque;
      };
      MotorJoint2.prototype.setCorrectionFactor = function(factor) {
        this.m_correctionFactor = factor;
      };
      MotorJoint2.prototype.getCorrectionFactor = function() {
        return this.m_correctionFactor;
      };
      MotorJoint2.prototype.setLinearOffset = function(linearOffset) {
        if (linearOffset.x != this.m_linearOffset.x || linearOffset.y != this.m_linearOffset.y) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_linearOffset.set(linearOffset);
        }
      };
      MotorJoint2.prototype.getLinearOffset = function() {
        return this.m_linearOffset;
      };
      MotorJoint2.prototype.setAngularOffset = function(angularOffset) {
        if (angularOffset != this.m_angularOffset) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_angularOffset = angularOffset;
        }
      };
      MotorJoint2.prototype.getAngularOffset = function() {
        return this.m_angularOffset;
      };
      MotorJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getPosition();
      };
      MotorJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getPosition();
      };
      MotorJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);
      };
      MotorJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_angularImpulse;
      };
      MotorJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_linearOffset, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.neg(this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat22();
        K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;
        K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;
        this.m_linearMass = K.getInverse();
        this.m_angularMass = iA + iB;
        if (this.m_angularMass > 0) {
          this.m_angularMass = 1 / this.m_angularMass;
        }
        this.m_linearError = Vec2.zero();
        this.m_linearError.addCombine(1, cB2, 1, this.m_rB);
        this.m_linearError.subCombine(1, cA2, 1, this.m_rA);
        this.m_angularError = aB - aA - this.m_angularOffset;
        if (step.warmStarting) {
          this.m_linearImpulse.mul(step.dtRatio);
          this.m_angularImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);
        } else {
          this.m_linearImpulse.setZero();
          this.m_angularImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      MotorJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var h = step.dt;
        var inv_h = step.inv_dt;
        {
          var Cdot = wB - wA + inv_h * this.m_correctionFactor * this.m_angularError;
          var impulse = -this.m_angularMass * Cdot;
          var oldImpulse = this.m_angularImpulse;
          var maxImpulse = h * this.m_maxTorque;
          this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_angularImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.zero();
          Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          Cdot.addMul(inv_h * this.m_correctionFactor, this.m_linearError);
          var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));
          var oldImpulse = Vec2.clone(this.m_linearImpulse);
          this.m_linearImpulse.add(impulse);
          var maxImpulse = h * this.m_maxForce;
          this.m_linearImpulse.clamp(maxImpulse);
          impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      MotorJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      MotorJoint2.TYPE = "motor-joint";
      return MotorJoint2;
    }(Joint)
  );
  var math_PI$2 = Math.PI;
  var DEFAULTS$4 = {
    maxForce: 0,
    frequencyHz: 5,
    dampingRatio: 0.7
  };
  var MouseJoint = (
    /** @class */
    function(_super) {
      __extends(MouseJoint2, _super);
      function MouseJoint2(def, bodyA, bodyB, target) {
        var _this = this;
        if (!(_this instanceof MouseJoint2)) {
          return new MouseJoint2(def, bodyA, bodyB, target);
        }
        def = options(def, DEFAULTS$4);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = MouseJoint2.TYPE;
        if (Vec2.isValid(target)) {
          _this.m_targetA = Vec2.clone(target);
        } else if (Vec2.isValid(def.target)) {
          _this.m_targetA = Vec2.clone(def.target);
        } else {
          _this.m_targetA = Vec2.zero();
        }
        _this.m_localAnchorB = Transform.mulTVec2(bodyB.getTransform(), _this.m_targetA);
        _this.m_maxForce = def.maxForce;
        _this.m_impulse = Vec2.zero();
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_beta = 0;
        _this.m_gamma = 0;
        _this.m_rB = Vec2.zero();
        _this.m_localCenterB = Vec2.zero();
        _this.m_invMassB = 0;
        _this.m_invIB = 0;
        _this.m_mass = new Mat22();
        _this.m_C = Vec2.zero();
        return _this;
      }
      MouseJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          target: this.m_targetA,
          maxForce: this.m_maxForce,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          _localAnchorB: this.m_localAnchorB
        };
      };
      MouseJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.target = Vec2.clone(data.target);
        var joint = new MouseJoint2(data);
        if (data._localAnchorB) {
          joint.m_localAnchorB = data._localAnchorB;
        }
        return joint;
      };
      MouseJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      MouseJoint2.prototype.setTarget = function(target) {
        if (Vec2.areEqual(target, this.m_targetA))
          return;
        this.m_bodyB.setAwake(true);
        this.m_targetA.set(target);
      };
      MouseJoint2.prototype.getTarget = function() {
        return this.m_targetA;
      };
      MouseJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      MouseJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      MouseJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      MouseJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      MouseJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      MouseJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      MouseJoint2.prototype.getAnchorA = function() {
        return Vec2.clone(this.m_targetA);
      };
      MouseJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      MouseJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_impulse);
      };
      MouseJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * 0;
      };
      MouseJoint2.prototype.shiftOrigin = function(newOrigin) {
        this.m_targetA.sub(newOrigin);
      };
      MouseJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIB = this.m_bodyB.m_invI;
        var position = this.m_bodyB.c_position;
        var velocity = this.m_bodyB.c_velocity;
        var cB2 = position.c;
        var aB = position.a;
        var vB2 = velocity.v;
        var wB = velocity.w;
        var qB = Rot.neo(aB);
        var mass = this.m_bodyB.getMass();
        var omega = 2 * math_PI$2 * this.m_frequencyHz;
        var d2 = 2 * mass * this.m_dampingRatio * omega;
        var k = mass * (omega * omega);
        var h = step.dt;
        this.m_gamma = h * (d2 + h * k);
        if (this.m_gamma != 0) {
          this.m_gamma = 1 / this.m_gamma;
        }
        this.m_beta = h * k * this.m_gamma;
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var K = new Mat22();
        K.ex.x = this.m_invMassB + this.m_invIB * this.m_rB.y * this.m_rB.y + this.m_gamma;
        K.ex.y = -this.m_invIB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = this.m_invMassB + this.m_invIB * this.m_rB.x * this.m_rB.x + this.m_gamma;
        this.m_mass = K.getInverse();
        this.m_C.setVec2(cB2);
        this.m_C.addCombine(1, this.m_rB, -1, this.m_targetA);
        this.m_C.mul(this.m_beta);
        wB *= 0.98;
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          vB2.addMul(this.m_invMassB, this.m_impulse);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, this.m_impulse);
        } else {
          this.m_impulse.setZero();
        }
        velocity.v.setVec2(vB2);
        velocity.w = wB;
      };
      MouseJoint2.prototype.solveVelocityConstraints = function(step) {
        var velocity = this.m_bodyB.c_velocity;
        var vB2 = Vec2.clone(velocity.v);
        var wB = velocity.w;
        var Cdot = Vec2.crossNumVec2(wB, this.m_rB);
        Cdot.add(vB2);
        Cdot.addCombine(1, this.m_C, this.m_gamma, this.m_impulse);
        Cdot.neg();
        var impulse = Mat22.mulVec2(this.m_mass, Cdot);
        var oldImpulse = Vec2.clone(this.m_impulse);
        this.m_impulse.add(impulse);
        var maxImpulse = step.dt * this.m_maxForce;
        this.m_impulse.clamp(maxImpulse);
        impulse = Vec2.sub(this.m_impulse, oldImpulse);
        vB2.addMul(this.m_invMassB, impulse);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        velocity.v.setVec2(vB2);
        velocity.w = wB;
      };
      MouseJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      MouseJoint2.TYPE = "mouse-joint";
      return MouseJoint2;
    }(Joint)
  );
  var math_abs$2 = Math.abs;
  var DEFAULTS$3 = {
    collideConnected: true
  };
  var PulleyJoint = (
    /** @class */
    function(_super) {
      __extends(PulleyJoint2, _super);
      function PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio) {
        var _this = this;
        if (!(_this instanceof PulleyJoint2)) {
          return new PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio);
        }
        def = options(def, DEFAULTS$3);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = PulleyJoint2.TYPE;
        _this.m_groundAnchorA = Vec2.clone(groundA ? groundA : def.groundAnchorA || Vec2.neo(-1, 1));
        _this.m_groundAnchorB = Vec2.clone(groundB ? groundB : def.groundAnchorB || Vec2.neo(1, 1));
        _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.neo(-1, 0));
        _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.neo(1, 0));
        _this.m_lengthA = Number.isFinite(def.lengthA) ? def.lengthA : Vec2.distance(anchorA, groundA);
        _this.m_lengthB = Number.isFinite(def.lengthB) ? def.lengthB : Vec2.distance(anchorB, groundB);
        _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;
        _this.m_constant = _this.m_lengthA + _this.m_ratio * _this.m_lengthB;
        _this.m_impulse = 0;
        return _this;
      }
      PulleyJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          groundAnchorA: this.m_groundAnchorA,
          groundAnchorB: this.m_groundAnchorB,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          lengthA: this.m_lengthA,
          lengthB: this.m_lengthB,
          ratio: this.m_ratio
        };
      };
      PulleyJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new PulleyJoint2(data);
        return joint;
      };
      PulleyJoint2.prototype._reset = function(def) {
        if (Vec2.isValid(def.groundAnchorA)) {
          this.m_groundAnchorA.set(def.groundAnchorA);
        }
        if (Vec2.isValid(def.groundAnchorB)) {
          this.m_groundAnchorB.set(def.groundAnchorB);
        }
        if (Vec2.isValid(def.localAnchorA)) {
          this.m_localAnchorA.set(def.localAnchorA);
        } else if (Vec2.isValid(def.anchorA)) {
          this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(def.anchorA));
        }
        if (Vec2.isValid(def.localAnchorB)) {
          this.m_localAnchorB.set(def.localAnchorB);
        } else if (Vec2.isValid(def.anchorB)) {
          this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(def.anchorB));
        }
        if (Number.isFinite(def.lengthA)) {
          this.m_lengthA = def.lengthA;
        }
        if (Number.isFinite(def.lengthB)) {
          this.m_lengthB = def.lengthB;
        }
        if (Number.isFinite(def.ratio)) {
          this.m_ratio = def.ratio;
        }
      };
      PulleyJoint2.prototype.getGroundAnchorA = function() {
        return this.m_groundAnchorA;
      };
      PulleyJoint2.prototype.getGroundAnchorB = function() {
        return this.m_groundAnchorB;
      };
      PulleyJoint2.prototype.getLengthA = function() {
        return this.m_lengthA;
      };
      PulleyJoint2.prototype.getLengthB = function() {
        return this.m_lengthB;
      };
      PulleyJoint2.prototype.getRatio = function() {
        return this.m_ratio;
      };
      PulleyJoint2.prototype.getCurrentLengthA = function() {
        var p = this.m_bodyA.getWorldPoint(this.m_localAnchorA);
        var s2 = this.m_groundAnchorA;
        return Vec2.distance(p, s2);
      };
      PulleyJoint2.prototype.getCurrentLengthB = function() {
        var p = this.m_bodyB.getWorldPoint(this.m_localAnchorB);
        var s2 = this.m_groundAnchorB;
        return Vec2.distance(p, s2);
      };
      PulleyJoint2.prototype.shiftOrigin = function(newOrigin) {
        this.m_groundAnchorA.sub(newOrigin);
        this.m_groundAnchorB.sub(newOrigin);
      };
      PulleyJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      PulleyJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      PulleyJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_uB).mul(inv_dt);
      };
      PulleyJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      PulleyJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        this.m_uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);
        this.m_uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);
        var lengthA = this.m_uA.length();
        var lengthB = this.m_uB.length();
        if (lengthA > 10 * SettingsInternal.linearSlop) {
          this.m_uA.mul(1 / lengthA);
        } else {
          this.m_uA.setZero();
        }
        if (lengthB > 10 * SettingsInternal.linearSlop) {
          this.m_uB.mul(1 / lengthB);
        } else {
          this.m_uB.setZero();
        }
        var ruA = Vec2.crossVec2Vec2(this.m_rA, this.m_uA);
        var ruB = Vec2.crossVec2Vec2(this.m_rB, this.m_uB);
        var mA = this.m_invMassA + this.m_invIA * ruA * ruA;
        var mB = this.m_invMassB + this.m_invIB * ruB * ruB;
        this.m_mass = mA + this.m_ratio * this.m_ratio * mB;
        if (this.m_mass > 0) {
          this.m_mass = 1 / this.m_mass;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var PA = Vec2.mulNumVec2(-this.m_impulse, this.m_uA);
          var PB = Vec2.mulNumVec2(-this.m_ratio * this.m_impulse, this.m_uB);
          vA2.addMul(this.m_invMassA, PA);
          wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);
          vB2.addMul(this.m_invMassB, PB);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PulleyJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));
        var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));
        var Cdot = -Vec2.dot(this.m_uA, vpA) - this.m_ratio * Vec2.dot(this.m_uB, vpB);
        var impulse = -this.m_mass * Cdot;
        this.m_impulse += impulse;
        var PA = Vec2.mulNumVec2(-impulse, this.m_uA);
        var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, this.m_uB);
        vA2.addMul(this.m_invMassA, PA);
        wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);
        vB2.addMul(this.m_invMassB, PB);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PulleyJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);
        var uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);
        var lengthA = uA.length();
        var lengthB = uB.length();
        if (lengthA > 10 * SettingsInternal.linearSlop) {
          uA.mul(1 / lengthA);
        } else {
          uA.setZero();
        }
        if (lengthB > 10 * SettingsInternal.linearSlop) {
          uB.mul(1 / lengthB);
        } else {
          uB.setZero();
        }
        var ruA = Vec2.crossVec2Vec2(rA2, uA);
        var ruB = Vec2.crossVec2Vec2(rB2, uB);
        var mA = this.m_invMassA + this.m_invIA * ruA * ruA;
        var mB = this.m_invMassB + this.m_invIB * ruB * ruB;
        var mass = mA + this.m_ratio * this.m_ratio * mB;
        if (mass > 0) {
          mass = 1 / mass;
        }
        var C = this.m_constant - lengthA - this.m_ratio * lengthB;
        var linearError = math_abs$2(C);
        var impulse = -mass * C;
        var PA = Vec2.mulNumVec2(-impulse, uA);
        var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, uB);
        cA2.addMul(this.m_invMassA, PA);
        aA += this.m_invIA * Vec2.crossVec2Vec2(rA2, PA);
        cB2.addMul(this.m_invMassB, PB);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, PB);
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return linearError < SettingsInternal.linearSlop;
      };
      PulleyJoint2.TYPE = "pulley-joint";
      return PulleyJoint2;
    }(Joint)
  );
  var math_min$1 = Math.min;
  var LimitState;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState || (LimitState = {}));
  var DEFAULTS$2 = {
    maxLength: 0
  };
  var RopeJoint = (
    /** @class */
    function(_super) {
      __extends(RopeJoint2, _super);
      function RopeJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof RopeJoint2)) {
          return new RopeJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$2);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = RopeJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.neo(-1, 0));
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.neo(1, 0));
        _this.m_maxLength = def.maxLength;
        _this.m_mass = 0;
        _this.m_impulse = 0;
        _this.m_length = 0;
        _this.m_state = LimitState.inactiveLimit;
        return _this;
      }
      RopeJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          maxLength: this.m_maxLength
        };
      };
      RopeJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new RopeJoint2(data);
        return joint;
      };
      RopeJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.maxLength)) {
          this.m_maxLength = def.maxLength;
        }
      };
      RopeJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      RopeJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      RopeJoint2.prototype.setMaxLength = function(length) {
        this.m_maxLength = length;
      };
      RopeJoint2.prototype.getMaxLength = function() {
        return this.m_maxLength;
      };
      RopeJoint2.prototype.getLimitState = function() {
        return this.m_state;
      };
      RopeJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      RopeJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      RopeJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);
      };
      RopeJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      RopeJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        this.m_rB = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        this.m_u = Vec2.zero();
        this.m_u.addCombine(1, cB2, 1, this.m_rB);
        this.m_u.subCombine(1, cA2, 1, this.m_rA);
        this.m_length = this.m_u.length();
        var C = this.m_length - this.m_maxLength;
        if (C > 0) {
          this.m_state = LimitState.atUpperLimit;
        } else {
          this.m_state = LimitState.inactiveLimit;
        }
        if (this.m_length > SettingsInternal.linearSlop) {
          this.m_u.mul(1 / this.m_length);
        } else {
          this.m_u.setZero();
          this.m_mass = 0;
          this.m_impulse = 0;
          return;
        }
        var crA = Vec2.crossVec2Vec2(this.m_rA, this.m_u);
        var crB = Vec2.crossVec2Vec2(this.m_rB, this.m_u);
        var invMass = this.m_invMassA + this.m_invIA * crA * crA + this.m_invMassB + this.m_invIB * crB * crB;
        this.m_mass = invMass != 0 ? 1 / invMass : 0;
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      RopeJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.addCrossNumVec2(vA2, wA, this.m_rA);
        var vpB = Vec2.addCrossNumVec2(vB2, wB, this.m_rB);
        var C = this.m_length - this.m_maxLength;
        var Cdot = Vec2.dot(this.m_u, Vec2.sub(vpB, vpA));
        if (C < 0) {
          Cdot += step.inv_dt * C;
        }
        var impulse = -this.m_mass * Cdot;
        var oldImpulse = this.m_impulse;
        this.m_impulse = math_min$1(0, this.m_impulse + impulse);
        impulse = this.m_impulse - oldImpulse;
        var P3 = Vec2.mulNumVec2(impulse, this.m_u);
        vA2.subMul(this.m_invMassA, P3);
        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
        vB2.addMul(this.m_invMassB, P3);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RopeJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        var u = Vec2.zero();
        u.addCombine(1, cB2, 1, rB2);
        u.subCombine(1, cA2, 1, rA2);
        var length = u.normalize();
        var C = length - this.m_maxLength;
        C = clamp(C, 0, SettingsInternal.maxLinearCorrection);
        var impulse = -this.m_mass * C;
        var P3 = Vec2.mulNumVec2(impulse, u);
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return length - this.m_maxLength < SettingsInternal.linearSlop;
      };
      RopeJoint2.TYPE = "rope-joint";
      return RopeJoint2;
    }(Joint)
  );
  var math_abs$1 = Math.abs;
  var math_PI$1 = Math.PI;
  var DEFAULTS$1 = {
    frequencyHz: 0,
    dampingRatio: 0
  };
  var WeldJoint = (
    /** @class */
    function(_super) {
      __extends(WeldJoint2, _super);
      function WeldJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof WeldJoint2)) {
          return new WeldJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$1);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = WeldJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_impulse = new Vec3();
        _this.m_bias = 0;
        _this.m_gamma = 0;
        _this.m_mass = new Mat33();
        return _this;
      }
      WeldJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          referenceAngle: this.m_referenceAngle
        };
      };
      WeldJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new WeldJoint2(data);
        return joint;
      };
      WeldJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      WeldJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      WeldJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      WeldJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      WeldJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      WeldJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      WeldJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      WeldJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      WeldJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      WeldJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      WeldJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);
      };
      WeldJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.z;
      };
      WeldJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat33();
        K.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;
        K.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;
        K.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;
        K.ex.y = K.ey.x;
        K.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;
        K.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;
        K.ex.z = K.ez.x;
        K.ey.z = K.ez.y;
        K.ez.z = iA + iB;
        if (this.m_frequencyHz > 0) {
          K.getInverse22(this.m_mass);
          var invM = iA + iB;
          var m = invM > 0 ? 1 / invM : 0;
          var C = aB - aA - this.m_referenceAngle;
          var omega = 2 * math_PI$1 * this.m_frequencyHz;
          var d2 = 2 * m * this.m_dampingRatio * omega;
          var k = m * omega * omega;
          var h = step.dt;
          this.m_gamma = h * (d2 + h * k);
          this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;
          this.m_bias = C * h * k * this.m_gamma;
          invM += this.m_gamma;
          this.m_mass.ez.z = invM != 0 ? 1 / invM : 0;
        } else if (K.ez.z == 0) {
          K.getInverse22(this.m_mass);
          this.m_gamma = 0;
          this.m_bias = 0;
        } else {
          K.getSymInverse33(this.m_mass);
          this.m_gamma = 0;
          this.m_bias = 0;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_impulse.z);
        } else {
          this.m_impulse.setZero();
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      WeldJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        if (this.m_frequencyHz > 0) {
          var Cdot2 = wB - wA;
          var impulse2 = -this.m_mass.ez.z * (Cdot2 + this.m_bias + this.m_gamma * this.m_impulse.z);
          this.m_impulse.z += impulse2;
          wA -= iA * impulse2;
          wB += iB * impulse2;
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var impulse1 = Vec2.neg(Mat33.mulVec2(this.m_mass, Cdot1));
          this.m_impulse.x += impulse1.x;
          this.m_impulse.y += impulse1.y;
          var P3 = Vec2.clone(impulse1);
          vA2.subMul(mA, P3);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(mB, P3);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var Cdot2 = wB - wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var impulse = Vec3.neg(Mat33.mulVec3(this.m_mass, Cdot));
          this.m_impulse.add(impulse);
          var P3 = Vec2.neo(impulse.x, impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      WeldJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var positionError;
        var angularError;
        var K = new Mat33();
        K.ex.x = mA + mB + rA2.y * rA2.y * iA + rB2.y * rB2.y * iB;
        K.ey.x = -rA2.y * rA2.x * iA - rB2.y * rB2.x * iB;
        K.ez.x = -rA2.y * iA - rB2.y * iB;
        K.ex.y = K.ey.x;
        K.ey.y = mA + mB + rA2.x * rA2.x * iA + rB2.x * rB2.x * iB;
        K.ez.y = rA2.x * iA + rB2.x * iB;
        K.ex.z = K.ez.x;
        K.ey.z = K.ez.y;
        K.ez.z = iA + iB;
        if (this.m_frequencyHz > 0) {
          var C1 = Vec2.zero();
          C1.addCombine(1, cB2, 1, rB2);
          C1.subCombine(1, cA2, 1, rA2);
          positionError = C1.length();
          angularError = 0;
          var P3 = Vec2.neg(K.solve22(C1));
          cA2.subMul(mA, P3);
          aA -= iA * Vec2.crossVec2Vec2(rA2, P3);
          cB2.addMul(mB, P3);
          aB += iB * Vec2.crossVec2Vec2(rB2, P3);
        } else {
          var C1 = Vec2.zero();
          C1.addCombine(1, cB2, 1, rB2);
          C1.subCombine(1, cA2, 1, rA2);
          var C2 = aB - aA - this.m_referenceAngle;
          positionError = C1.length();
          angularError = math_abs$1(C2);
          var C = new Vec3(C1.x, C1.y, C2);
          var impulse = new Vec3();
          if (K.ez.z > 0) {
            impulse = Vec3.neg(K.solve33(C));
          } else {
            var impulse2 = Vec2.neg(K.solve22(C1));
            impulse.set(impulse2.x, impulse2.y, 0);
          }
          var P3 = Vec2.neo(impulse.x, impulse.y);
          cA2.subMul(mA, P3);
          aA -= iA * (Vec2.crossVec2Vec2(rA2, P3) + impulse.z);
          cB2.addMul(mB, P3);
          aB += iB * (Vec2.crossVec2Vec2(rB2, P3) + impulse.z);
        }
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      WeldJoint2.TYPE = "weld-joint";
      return WeldJoint2;
    }(Joint)
  );
  var math_abs = Math.abs;
  var math_PI = Math.PI;
  var DEFAULTS = {
    enableMotor: false,
    maxMotorTorque: 0,
    motorSpeed: 0,
    frequencyHz: 2,
    dampingRatio: 0.7
  };
  var WheelJoint = (
    /** @class */
    function(_super) {
      __extends(WheelJoint2, _super);
      function WheelJoint2(def, bodyA, bodyB, anchor, axis) {
        var _this = this;
        if (!(_this instanceof WheelJoint2)) {
          return new WheelJoint2(def, bodyA, bodyB, anchor, axis);
        }
        def = options(def, DEFAULTS);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_ax = Vec2.zero();
        _this.m_ay = Vec2.zero();
        _this.m_type = WheelJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        if (Vec2.isValid(axis)) {
          _this.m_localXAxisA = bodyA.getLocalVector(axis);
        } else if (Vec2.isValid(def.localAxisA)) {
          _this.m_localXAxisA = Vec2.clone(def.localAxisA);
        } else if (Vec2.isValid(def.localAxis)) {
          _this.m_localXAxisA = Vec2.clone(def.localAxis);
        } else {
          _this.m_localXAxisA = Vec2.neo(1, 0);
        }
        _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);
        _this.m_mass = 0;
        _this.m_impulse = 0;
        _this.m_motorMass = 0;
        _this.m_motorImpulse = 0;
        _this.m_springMass = 0;
        _this.m_springImpulse = 0;
        _this.m_maxMotorTorque = def.maxMotorTorque;
        _this.m_motorSpeed = def.motorSpeed;
        _this.m_enableMotor = def.enableMotor;
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_bias = 0;
        _this.m_gamma = 0;
        return _this;
      }
      WheelJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          enableMotor: this.m_enableMotor,
          maxMotorTorque: this.m_maxMotorTorque,
          motorSpeed: this.m_motorSpeed,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          localAxisA: this.m_localXAxisA
        };
      };
      WheelJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new WheelJoint2(data);
        return joint;
      };
      WheelJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.localAxisA) {
          this.m_localXAxisA.setVec2(def.localAxisA);
          this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));
        }
        if (def.enableMotor !== void 0) {
          this.m_enableMotor = def.enableMotor;
        }
        if (Number.isFinite(def.maxMotorTorque)) {
          this.m_maxMotorTorque = def.maxMotorTorque;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      WheelJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      WheelJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      WheelJoint2.prototype.getLocalAxisA = function() {
        return this.m_localXAxisA;
      };
      WheelJoint2.prototype.getJointTranslation = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        var pA2 = bA.getWorldPoint(this.m_localAnchorA);
        var pB2 = bB.getWorldPoint(this.m_localAnchorB);
        var d2 = Vec2.sub(pB2, pA2);
        var axis = bA.getWorldVector(this.m_localXAxisA);
        var translation2 = Vec2.dot(d2, axis);
        return translation2;
      };
      WheelJoint2.prototype.getJointSpeed = function() {
        var wA = this.m_bodyA.m_angularVelocity;
        var wB = this.m_bodyB.m_angularVelocity;
        return wB - wA;
      };
      WheelJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      WheelJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      WheelJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      WheelJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      WheelJoint2.prototype.setMaxMotorTorque = function(torque) {
        if (torque == this.m_maxMotorTorque)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorTorque = torque;
      };
      WheelJoint2.prototype.getMaxMotorTorque = function() {
        return this.m_maxMotorTorque;
      };
      WheelJoint2.prototype.getMotorTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      WheelJoint2.prototype.setSpringFrequencyHz = function(hz) {
        this.m_frequencyHz = hz;
      };
      WheelJoint2.prototype.getSpringFrequencyHz = function() {
        return this.m_frequencyHz;
      };
      WheelJoint2.prototype.setSpringDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      WheelJoint2.prototype.getSpringDampingRatio = function() {
        return this.m_dampingRatio;
      };
      WheelJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      WheelJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      WheelJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax).mul(inv_dt);
      };
      WheelJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      WheelJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        {
          this.m_ay = Rot.mulVec2(qA, this.m_localYAxisA);
          this.m_sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ay);
          this.m_sBy = Vec2.crossVec2Vec2(rB2, this.m_ay);
          this.m_mass = mA + mB + iA * this.m_sAy * this.m_sAy + iB * this.m_sBy * this.m_sBy;
          if (this.m_mass > 0) {
            this.m_mass = 1 / this.m_mass;
          }
        }
        this.m_springMass = 0;
        this.m_bias = 0;
        this.m_gamma = 0;
        if (this.m_frequencyHz > 0) {
          this.m_ax = Rot.mulVec2(qA, this.m_localXAxisA);
          this.m_sAx = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ax);
          this.m_sBx = Vec2.crossVec2Vec2(rB2, this.m_ax);
          var invMass = mA + mB + iA * this.m_sAx * this.m_sAx + iB * this.m_sBx * this.m_sBx;
          if (invMass > 0) {
            this.m_springMass = 1 / invMass;
            var C = Vec2.dot(d2, this.m_ax);
            var omega = 2 * math_PI * this.m_frequencyHz;
            var damp = 2 * this.m_springMass * this.m_dampingRatio * omega;
            var k = this.m_springMass * omega * omega;
            var h = step.dt;
            this.m_gamma = h * (damp + h * k);
            if (this.m_gamma > 0) {
              this.m_gamma = 1 / this.m_gamma;
            }
            this.m_bias = C * h * k * this.m_gamma;
            this.m_springMass = invMass + this.m_gamma;
            if (this.m_springMass > 0) {
              this.m_springMass = 1 / this.m_springMass;
            }
          }
        } else {
          this.m_springImpulse = 0;
        }
        if (this.m_enableMotor) {
          this.m_motorMass = iA + iB;
          if (this.m_motorMass > 0) {
            this.m_motorMass = 1 / this.m_motorMass;
          }
        } else {
          this.m_motorMass = 0;
          this.m_motorImpulse = 0;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          this.m_springImpulse *= step.dtRatio;
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax);
          var LA = this.m_impulse * this.m_sAy + this.m_springImpulse * this.m_sAx + this.m_motorImpulse;
          var LB = this.m_impulse * this.m_sBy + this.m_springImpulse * this.m_sBx + this.m_motorImpulse;
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * LA;
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * LB;
        } else {
          this.m_impulse = 0;
          this.m_springImpulse = 0;
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      WheelJoint2.prototype.solveVelocityConstraints = function(step) {
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        {
          var Cdot = Vec2.dot(this.m_ax, vB2) - Vec2.dot(this.m_ax, vA2) + this.m_sBx * wB - this.m_sAx * wA;
          var impulse = -this.m_springMass * (Cdot + this.m_bias + this.m_gamma * this.m_springImpulse);
          this.m_springImpulse += impulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_ax);
          var LA = impulse * this.m_sAx;
          var LB = impulse * this.m_sBx;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        {
          var Cdot = wB - wA - this.m_motorSpeed;
          var impulse = -this.m_motorMass * Cdot;
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorTorque;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.dot(this.m_ay, vB2) - Vec2.dot(this.m_ay, vA2) + this.m_sBy * wB - this.m_sAy * wA;
          var impulse = -this.m_mass * Cdot;
          this.m_impulse += impulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_ay);
          var LA = impulse * this.m_sAy;
          var LB = impulse * this.m_sBy;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      WheelJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        var ay = Rot.mulVec2(qA, this.m_localYAxisA);
        var sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), ay);
        var sBy = Vec2.crossVec2Vec2(rB2, ay);
        var C = Vec2.dot(d2, ay);
        var k = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_sAy * this.m_sAy + this.m_invIB * this.m_sBy * this.m_sBy;
        var impulse = k != 0 ? -C / k : 0;
        var P3 = Vec2.mulNumVec2(impulse, ay);
        var LA = impulse * sAy;
        var LB = impulse * sBy;
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * LA;
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * LB;
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return math_abs(C) <= SettingsInternal.linearSlop;
      };
      WheelJoint2.TYPE = "wheel-joint";
      return WheelJoint2;
    }(Joint)
  );
  var _a;
  var SID = 0;
  var SERIALIZE_REF_TYPES = {
    "World": World,
    "Body": Body,
    "Joint": Joint,
    "Fixture": Fixture,
    "Shape": Shape
  };
  var DESERIALIZE_BY_REF_TYPE = {
    "Vec2": Vec2,
    "Vec3": Vec3,
    "World": World,
    "Body": Body,
    "Joint": Joint,
    "Fixture": Fixture,
    "Shape": Shape
  };
  var DESERIALIZE_BY_TYPE_FIELD = (_a = {}, _a[Body.STATIC] = Body, _a[Body.DYNAMIC] = Body, _a[Body.KINEMATIC] = Body, _a[ChainShape.TYPE] = ChainShape, // [BoxShape.TYPE]: BoxShape,
  _a[PolygonShape.TYPE] = PolygonShape, _a[EdgeShape.TYPE] = EdgeShape, _a[CircleShape.TYPE] = CircleShape, _a[DistanceJoint.TYPE] = DistanceJoint, _a[FrictionJoint.TYPE] = FrictionJoint, _a[GearJoint.TYPE] = GearJoint, _a[MotorJoint.TYPE] = MotorJoint, _a[MouseJoint.TYPE] = MouseJoint, _a[PrismaticJoint.TYPE] = PrismaticJoint, _a[PulleyJoint.TYPE] = PulleyJoint, _a[RevoluteJoint.TYPE] = RevoluteJoint, _a[RopeJoint.TYPE] = RopeJoint, _a[WeldJoint.TYPE] = WeldJoint, _a[WheelJoint.TYPE] = WheelJoint, _a);
  var DEFAULT_OPTIONS = {
    rootClass: World,
    preSerialize: function(obj) {
      return obj;
    },
    postSerialize: function(data, obj) {
      return data;
    },
    preDeserialize: function(data) {
      return data;
    },
    postDeserialize: function(obj, data) {
      return obj;
    }
  };
  var Serializer = (
    /** @class */
    /* @__PURE__ */ function() {
      function Serializer2(options2) {
        var _this = this;
        this.toJson = function(root) {
          var preSerialize = _this.options.preSerialize;
          var postSerialize = _this.options.postSerialize;
          var json = [];
          var refQueue = [root];
          var refMemoById = {};
          function addToRefQueue(value, typeName) {
            value.__sid = value.__sid || ++SID;
            if (!refMemoById[value.__sid]) {
              refQueue.push(value);
              var index = json.length + refQueue.length;
              var ref = {
                refIndex: index,
                refType: typeName
              };
              refMemoById[value.__sid] = ref;
            }
            return refMemoById[value.__sid];
          }
          function serializeWithHooks(obj2) {
            obj2 = preSerialize(obj2);
            var data = obj2._serialize();
            data = postSerialize(data, obj2);
            return data;
          }
          function traverse(value, noRefType) {
            if (noRefType === void 0) {
              noRefType = false;
            }
            if (typeof value !== "object" || value === null) {
              return value;
            }
            if (typeof value._serialize === "function") {
              if (!noRefType) {
                for (var typeName in SERIALIZE_REF_TYPES) {
                  if (value instanceof SERIALIZE_REF_TYPES[typeName]) {
                    return addToRefQueue(value, typeName);
                  }
                }
              }
              value = serializeWithHooks(value);
            }
            if (Array.isArray(value)) {
              var newValue = [];
              for (var key = 0; key < value.length; key++) {
                newValue[key] = traverse(value[key]);
              }
              value = newValue;
            } else {
              var newValue = {};
              for (var key in value) {
                if (value.hasOwnProperty(key)) {
                  newValue[key] = traverse(value[key]);
                }
              }
              value = newValue;
            }
            return value;
          }
          while (refQueue.length) {
            var obj = refQueue.shift();
            var str = traverse(obj, true);
            json.push(str);
          }
          return json;
        };
        this.fromJson = function(json) {
          var preDeserialize = _this.options.preDeserialize;
          var postDeserialize = _this.options.postDeserialize;
          var rootClass = _this.options.rootClass;
          var deserializedRefMemoByIndex = {};
          function deserializeWithHooks(classHint, data, context) {
            if (!classHint || !classHint._deserialize) {
              classHint = DESERIALIZE_BY_TYPE_FIELD[data.type];
            }
            var deserializer = classHint && classHint._deserialize;
            if (!deserializer) {
              return;
            }
            data = preDeserialize(data);
            var classDeserializeFn = classHint._deserialize;
            var obj = classDeserializeFn(data, context, deserializeChild);
            obj = postDeserialize(obj, data);
            return obj;
          }
          function deserializeChild(classHint, dataOrRef, context) {
            var isRefObject = dataOrRef.refIndex && dataOrRef.refType;
            if (!isRefObject) {
              return deserializeWithHooks(classHint, dataOrRef, context);
            }
            var ref = dataOrRef;
            if (DESERIALIZE_BY_REF_TYPE[ref.refType]) {
              classHint = DESERIALIZE_BY_REF_TYPE[ref.refType];
            }
            var refIndex = ref.refIndex;
            if (!deserializedRefMemoByIndex[refIndex]) {
              var data = json[refIndex];
              var obj = deserializeWithHooks(classHint, data, context);
              deserializedRefMemoByIndex[refIndex] = obj;
            }
            return deserializedRefMemoByIndex[refIndex];
          }
          var root = deserializeWithHooks(rootClass, json[0], null);
          return root;
        };
        this.options = __assign(__assign({}, DEFAULT_OPTIONS), options2);
      }
      return Serializer2;
    }()
  );
  var worldSerializer = new Serializer({
    rootClass: World
  });
  Serializer.fromJson = worldSerializer.fromJson;
  Serializer.toJson = worldSerializer.toJson;
  var Testbed = (
    /** @class */
    function() {
      function Testbed2() {
      }
      Testbed2.mount = function(options2) {
        throw new Error("Not implemented");
      };
      Testbed2.start = function(world) {
        var testbed2 = Testbed2.mount();
        testbed2.start(world);
        return testbed2;
      };
      return Testbed2;
    }()
  );
  function testbed(a2, b2) {
    var callback;
    var options2;
    if (typeof a2 === "function") {
      callback = a2;
      options2 = b2;
    } else if (typeof b2 === "function") {
      callback = b2;
      options2 = a2;
    } else {
      options2 = a2 !== null && a2 !== void 0 ? a2 : b2;
    }
    var testbed2 = Testbed.mount(options2);
    if (callback) {
      var world = callback(testbed2) || testbed2.world;
      testbed2.start(world);
    } else {
      return testbed2;
    }
  }
  var BoxShape = (
    /** @class */
    function(_super) {
      __extends(BoxShape2, _super);
      function BoxShape2(halfWidth, halfHeight, center2, angle) {
        var _this = this;
        if (!(_this instanceof BoxShape2)) {
          return new BoxShape2(halfWidth, halfHeight, center2, angle);
        }
        _this = _super.call(this) || this;
        _this._setAsBox(halfWidth, halfHeight, center2, angle);
        return _this;
      }
      BoxShape2.TYPE = "polygon";
      return BoxShape2;
    }(PolygonShape)
  );
  Contact.addType(CircleShape.TYPE, CircleShape.TYPE, CircleCircleContact);
  function CircleCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollideCircles(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  var pA = vec2(0, 0);
  var pB = vec2(0, 0);
  var CollideCircles = function(manifold, circleA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    transformVec2(pA, xfA2, circleA.m_p);
    transformVec2(pB, xfB2, circleB.m_p);
    var distSqr = distSqrVec2(pB, pA);
    var rA2 = circleA.m_radius;
    var rB2 = circleB.m_radius;
    var radius = rA2 + rB2;
    if (distSqr > radius * radius) {
      return;
    }
    manifold.type = exports2.ManifoldType.e_circles;
    copyVec2(manifold.localPoint, circleA.m_p);
    zeroVec2(manifold.localNormal);
    manifold.pointCount = 1;
    copyVec2(manifold.points[0].localPoint, circleB.m_p);
    manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
  };
  Contact.addType(EdgeShape.TYPE, CircleShape.TYPE, EdgeCircleContact);
  Contact.addType(ChainShape.TYPE, CircleShape.TYPE, ChainCircleContact);
  function EdgeCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    var shapeA = fixtureA.getShape();
    var shapeB = fixtureB.getShape();
    CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);
  }
  function ChainCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    var chain = fixtureA.getShape();
    var edge = new EdgeShape();
    chain.getChildEdge(edge, indexA);
    var shapeA = edge;
    var shapeB = fixtureB.getShape();
    CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);
  }
  var e = vec2(0, 0);
  var e1 = vec2(0, 0);
  var e2 = vec2(0, 0);
  var Q = vec2(0, 0);
  var P = vec2(0, 0);
  var n$2 = vec2(0, 0);
  var CollideEdgeCircle = function(manifold, edgeA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    retransformVec2(Q, xfB2, xfA2, circleB.m_p);
    var A = edgeA.m_vertex1;
    var B = edgeA.m_vertex2;
    subVec2(e, B, A);
    var u = dotVec2(e, B) - dotVec2(e, Q);
    var v3 = dotVec2(e, Q) - dotVec2(e, A);
    var radius = edgeA.m_radius + circleB.m_radius;
    if (v3 <= 0) {
      copyVec2(P, A);
      var dd_1 = distSqrVec2(Q, A);
      if (dd_1 > radius * radius) {
        return;
      }
      if (edgeA.m_hasVertex0) {
        var A1 = edgeA.m_vertex0;
        var B1 = A;
        subVec2(e1, B1, A1);
        var u1 = dotVec2(e1, B1) - dotVec2(e1, Q);
        if (u1 > 0) {
          return;
        }
      }
      manifold.type = exports2.ManifoldType.e_circles;
      zeroVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, P);
      manifold.pointCount = 1;
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    if (u <= 0) {
      copyVec2(P, B);
      var dd_2 = distSqrVec2(Q, P);
      if (dd_2 > radius * radius) {
        return;
      }
      if (edgeA.m_hasVertex3) {
        var B2 = edgeA.m_vertex3;
        var A2 = B;
        subVec2(e2, B2, A2);
        var v22 = dotVec2(e2, Q) - dotVec2(e2, A2);
        if (v22 > 0) {
          return;
        }
      }
      manifold.type = exports2.ManifoldType.e_circles;
      zeroVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, P);
      manifold.pointCount = 1;
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(1, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    var den = lengthSqrVec2(e);
    combine2Vec2(P, u / den, A, v3 / den, B);
    var dd = distSqrVec2(Q, P);
    if (dd > radius * radius) {
      return;
    }
    crossNumVec2(n$2, 1, e);
    if (dotVec2(n$2, Q) - dotVec2(n$2, A) < 0) {
      negVec2(n$2);
    }
    normalizeVec2(n$2);
    manifold.type = exports2.ManifoldType.e_faceA;
    copyVec2(manifold.localNormal, n$2);
    copyVec2(manifold.localPoint, A);
    manifold.pointCount = 1;
    copyVec2(manifold.points[0].localPoint, circleB.m_p);
    manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_face, 0, exports2.ContactFeatureType.e_vertex);
  };
  var incidentEdge = [new ClipVertex(), new ClipVertex()];
  var clipPoints1$1 = [new ClipVertex(), new ClipVertex()];
  var clipPoints2$1 = [new ClipVertex(), new ClipVertex()];
  var clipSegmentToLineNormal = vec2(0, 0);
  var v1 = vec2(0, 0);
  var n$1 = vec2(0, 0);
  var xf$1 = transform(0, 0, 0);
  var v11 = vec2(0, 0);
  var v12 = vec2(0, 0);
  var localTangent = vec2(0, 0);
  var localNormal = vec2(0, 0);
  var planePoint = vec2(0, 0);
  var tangent = vec2(0, 0);
  var normal$1 = vec2(0, 0);
  var normal1$1 = vec2(0, 0);
  Contact.addType(PolygonShape.TYPE, PolygonShape.TYPE, PolygonContact);
  function PolygonContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollidePolygons(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  function findMaxSeparation(poly1, xf1, poly2, xf2, output2) {
    var count1 = poly1.m_count;
    var count2 = poly2.m_count;
    var n1s = poly1.m_normals;
    var v1s = poly1.m_vertices;
    var v2s = poly2.m_vertices;
    detransformTransform(xf$1, xf2, xf1);
    var bestIndex = 0;
    var maxSeparation2 = -Infinity;
    for (var i = 0; i < count1; ++i) {
      rotVec2(n$1, xf$1.q, n1s[i]);
      transformVec2(v1, xf$1, v1s[i]);
      var si = Infinity;
      for (var j = 0; j < count2; ++j) {
        var sij = dotVec2(n$1, v2s[j]) - dotVec2(n$1, v1);
        if (sij < si) {
          si = sij;
        }
      }
      if (si > maxSeparation2) {
        maxSeparation2 = si;
        bestIndex = i;
      }
    }
    output2.maxSeparation = maxSeparation2;
    output2.bestIndex = bestIndex;
  }
  function findIncidentEdge(clipVertex, poly1, xf1, edge12, poly2, xf2) {
    var normals1 = poly1.m_normals;
    var count2 = poly2.m_count;
    var vertices2 = poly2.m_vertices;
    var normals2 = poly2.m_normals;
    rerotVec2(normal1$1, xf2.q, xf1.q, normals1[edge12]);
    var index = 0;
    var minDot = Infinity;
    for (var i = 0; i < count2; ++i) {
      var dot = dotVec2(normal1$1, normals2[i]);
      if (dot < minDot) {
        minDot = dot;
        index = i;
      }
    }
    var i1 = index;
    var i2 = i1 + 1 < count2 ? i1 + 1 : 0;
    transformVec2(clipVertex[0].v, xf2, vertices2[i1]);
    clipVertex[0].id.setFeatures(edge12, exports2.ContactFeatureType.e_face, i1, exports2.ContactFeatureType.e_vertex);
    transformVec2(clipVertex[1].v, xf2, vertices2[i2]);
    clipVertex[1].id.setFeatures(edge12, exports2.ContactFeatureType.e_face, i2, exports2.ContactFeatureType.e_vertex);
  }
  var maxSeparation = {
    maxSeparation: 0,
    bestIndex: 0
  };
  var CollidePolygons = function(manifold, polyA, xfA2, polyB, xfB2) {
    manifold.pointCount = 0;
    var totalRadius = polyA.m_radius + polyB.m_radius;
    findMaxSeparation(polyA, xfA2, polyB, xfB2, maxSeparation);
    var edgeA = maxSeparation.bestIndex;
    var separationA = maxSeparation.maxSeparation;
    if (separationA > totalRadius)
      return;
    findMaxSeparation(polyB, xfB2, polyA, xfA2, maxSeparation);
    var edgeB = maxSeparation.bestIndex;
    var separationB = maxSeparation.maxSeparation;
    if (separationB > totalRadius)
      return;
    var poly1;
    var poly2;
    var xf1;
    var xf2;
    var edge12;
    var flip;
    var k_tol = 0.1 * SettingsInternal.linearSlop;
    if (separationB > separationA + k_tol) {
      poly1 = polyB;
      poly2 = polyA;
      xf1 = xfB2;
      xf2 = xfA2;
      edge12 = edgeB;
      manifold.type = exports2.ManifoldType.e_faceB;
      flip = true;
    } else {
      poly1 = polyA;
      poly2 = polyB;
      xf1 = xfA2;
      xf2 = xfB2;
      edge12 = edgeA;
      manifold.type = exports2.ManifoldType.e_faceA;
      flip = false;
    }
    incidentEdge[0].recycle();
    incidentEdge[1].recycle();
    findIncidentEdge(incidentEdge, poly1, xf1, edge12, poly2, xf2);
    var count1 = poly1.m_count;
    var vertices1 = poly1.m_vertices;
    var iv1 = edge12;
    var iv2 = edge12 + 1 < count1 ? edge12 + 1 : 0;
    copyVec2(v11, vertices1[iv1]);
    copyVec2(v12, vertices1[iv2]);
    subVec2(localTangent, v12, v11);
    normalizeVec2(localTangent);
    crossVec2Num(localNormal, localTangent, 1);
    combine2Vec2(planePoint, 0.5, v11, 0.5, v12);
    rotVec2(tangent, xf1.q, localTangent);
    crossVec2Num(normal$1, tangent, 1);
    transformVec2(v11, xf1, v11);
    transformVec2(v12, xf1, v12);
    var frontOffset = dotVec2(normal$1, v11);
    var sideOffset1 = -dotVec2(tangent, v11) + totalRadius;
    var sideOffset2 = dotVec2(tangent, v12) + totalRadius;
    clipPoints1$1[0].recycle();
    clipPoints1$1[1].recycle();
    clipPoints2$1[0].recycle();
    clipPoints2$1[1].recycle();
    setVec2(clipSegmentToLineNormal, -tangent.x, -tangent.y);
    var np1 = clipSegmentToLine(clipPoints1$1, incidentEdge, clipSegmentToLineNormal, sideOffset1, iv1);
    if (np1 < 2) {
      return;
    }
    setVec2(clipSegmentToLineNormal, tangent.x, tangent.y);
    var np2 = clipSegmentToLine(clipPoints2$1, clipPoints1$1, clipSegmentToLineNormal, sideOffset2, iv2);
    if (np2 < 2) {
      return;
    }
    copyVec2(manifold.localNormal, localNormal);
    copyVec2(manifold.localPoint, planePoint);
    var pointCount = 0;
    for (var i = 0; i < clipPoints2$1.length; ++i) {
      var separation = dotVec2(normal$1, clipPoints2$1[i].v) - frontOffset;
      if (separation <= totalRadius) {
        var cp = manifold.points[pointCount];
        detransformVec2(cp.localPoint, xf2, clipPoints2$1[i].v);
        cp.id.set(clipPoints2$1[i].id);
        if (flip) {
          cp.id.swapFeatures();
        }
        ++pointCount;
      }
    }
    manifold.pointCount = pointCount;
  };
  Contact.addType(PolygonShape.TYPE, CircleShape.TYPE, PolygonCircleContact);
  function PolygonCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollidePolygonCircle(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  var cLocal = vec2(0, 0);
  var faceCenter = vec2(0, 0);
  var CollidePolygonCircle = function(manifold, polygonA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    retransformVec2(cLocal, xfB2, xfA2, circleB.m_p);
    var normalIndex = 0;
    var separation = -Infinity;
    var radius = polygonA.m_radius + circleB.m_radius;
    var vertexCount = polygonA.m_count;
    var vertices = polygonA.m_vertices;
    var normals = polygonA.m_normals;
    for (var i = 0; i < vertexCount; ++i) {
      var s2 = dotVec2(normals[i], cLocal) - dotVec2(normals[i], vertices[i]);
      if (s2 > radius) {
        return;
      }
      if (s2 > separation) {
        separation = s2;
        normalIndex = i;
      }
    }
    var vertIndex1 = normalIndex;
    var vertIndex2 = vertIndex1 + 1 < vertexCount ? vertIndex1 + 1 : 0;
    var v13 = vertices[vertIndex1];
    var v22 = vertices[vertIndex2];
    if (separation < EPSILON) {
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      copyVec2(manifold.localNormal, normals[normalIndex]);
      combine2Vec2(manifold.localPoint, 0.5, v13, 0.5, v22);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    var u1 = dotVec2(cLocal, v22) - dotVec2(cLocal, v13) - dotVec2(v13, v22) + dotVec2(v13, v13);
    var u2 = dotVec2(cLocal, v13) - dotVec2(cLocal, v22) - dotVec2(v22, v13) + dotVec2(v22, v22);
    if (u1 <= 0) {
      if (distSqrVec2(cLocal, v13) > radius * radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      subVec2(manifold.localNormal, cLocal, v13);
      normalizeVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, v13);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    } else if (u2 <= 0) {
      if (distSqrVec2(cLocal, v22) > radius * radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      subVec2(manifold.localNormal, cLocal, v22);
      normalizeVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, v22);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    } else {
      combine2Vec2(faceCenter, 0.5, v13, 0.5, v22);
      var separation_1 = dotVec2(cLocal, normals[vertIndex1]) - dotVec2(faceCenter, normals[vertIndex1]);
      if (separation_1 > radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      copyVec2(manifold.localNormal, normals[vertIndex1]);
      copyVec2(manifold.localPoint, faceCenter);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    }
  };
  var math_min = Math.min;
  Contact.addType(EdgeShape.TYPE, PolygonShape.TYPE, EdgePolygonContact);
  Contact.addType(ChainShape.TYPE, PolygonShape.TYPE, ChainPolygonContact);
  function EdgePolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {
    CollideEdgePolygon(manifold, fA.getShape(), xfA2, fB.getShape(), xfB2);
  }
  var edge_reuse = new EdgeShape();
  function ChainPolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {
    var chain = fA.getShape();
    chain.getChildEdge(edge_reuse, indexA);
    CollideEdgePolygon(manifold, edge_reuse, xfA2, fB.getShape(), xfB2);
  }
  var EPAxisType;
  (function(EPAxisType2) {
    EPAxisType2[EPAxisType2["e_unknown"] = -1] = "e_unknown";
    EPAxisType2[EPAxisType2["e_edgeA"] = 1] = "e_edgeA";
    EPAxisType2[EPAxisType2["e_edgeB"] = 2] = "e_edgeB";
  })(EPAxisType || (EPAxisType = {}));
  var VertexType;
  (function(VertexType2) {
    VertexType2[VertexType2["e_isolated"] = 0] = "e_isolated";
    VertexType2[VertexType2["e_concave"] = 1] = "e_concave";
    VertexType2[VertexType2["e_convex"] = 2] = "e_convex";
  })(VertexType || (VertexType = {}));
  var EPAxis = (
    /** @class */
    /* @__PURE__ */ function() {
      function EPAxis2() {
      }
      return EPAxis2;
    }()
  );
  var TempPolygon = (
    /** @class */
    /* @__PURE__ */ function() {
      function TempPolygon2() {
        this.vertices = [];
        this.normals = [];
        this.count = 0;
        for (var i = 0; i < SettingsInternal.maxPolygonVertices; i++) {
          this.vertices.push(vec2(0, 0));
          this.normals.push(vec2(0, 0));
        }
      }
      return TempPolygon2;
    }()
  );
  var ReferenceFace = (
    /** @class */
    function() {
      function ReferenceFace2() {
        this.v1 = vec2(0, 0);
        this.v2 = vec2(0, 0);
        this.normal = vec2(0, 0);
        this.sideNormal1 = vec2(0, 0);
        this.sideNormal2 = vec2(0, 0);
      }
      ReferenceFace2.prototype.recycle = function() {
        zeroVec2(this.v1);
        zeroVec2(this.v2);
        zeroVec2(this.normal);
        zeroVec2(this.sideNormal1);
        zeroVec2(this.sideNormal2);
      };
      return ReferenceFace2;
    }()
  );
  var clipPoints1 = [new ClipVertex(), new ClipVertex()];
  var clipPoints2 = [new ClipVertex(), new ClipVertex()];
  var ie = [new ClipVertex(), new ClipVertex()];
  var edgeAxis = new EPAxis();
  var polygonAxis = new EPAxis();
  var polygonBA = new TempPolygon();
  var rf = new ReferenceFace();
  var centroidB = vec2(0, 0);
  var edge0 = vec2(0, 0);
  var edge1 = vec2(0, 0);
  var edge2 = vec2(0, 0);
  var xf = transform(0, 0, 0);
  var normal = vec2(0, 0);
  var normal0 = vec2(0, 0);
  var normal1 = vec2(0, 0);
  var normal2 = vec2(0, 0);
  var lowerLimit = vec2(0, 0);
  var upperLimit = vec2(0, 0);
  var perp = vec2(0, 0);
  var n = vec2(0, 0);
  var CollideEdgePolygon = function(manifold, edgeA, xfA2, polygonB, xfB2) {
    detransformTransform(xf, xfA2, xfB2);
    transformVec2(centroidB, xf, polygonB.m_centroid);
    var v0 = edgeA.m_vertex0;
    var v13 = edgeA.m_vertex1;
    var v22 = edgeA.m_vertex2;
    var v3 = edgeA.m_vertex3;
    var hasVertex0 = edgeA.m_hasVertex0;
    var hasVertex3 = edgeA.m_hasVertex3;
    subVec2(edge1, v22, v13);
    normalizeVec2(edge1);
    setVec2(normal1, edge1.y, -edge1.x);
    var offset1 = dotVec2(normal1, centroidB) - dotVec2(normal1, v13);
    var offset0 = 0;
    var offset2 = 0;
    var convex1 = false;
    var convex2 = false;
    zeroVec2(normal0);
    zeroVec2(normal2);
    if (hasVertex0) {
      subVec2(edge0, v13, v0);
      normalizeVec2(edge0);
      setVec2(normal0, edge0.y, -edge0.x);
      convex1 = crossVec2Vec2(edge0, edge1) >= 0;
      offset0 = Vec2.dot(normal0, centroidB) - Vec2.dot(normal0, v0);
    }
    if (hasVertex3) {
      subVec2(edge2, v3, v22);
      normalizeVec2(edge2);
      setVec2(normal2, edge2.y, -edge2.x);
      convex2 = Vec2.crossVec2Vec2(edge1, edge2) > 0;
      offset2 = Vec2.dot(normal2, centroidB) - Vec2.dot(normal2, v22);
    }
    var front;
    zeroVec2(normal);
    zeroVec2(lowerLimit);
    zeroVec2(upperLimit);
    if (hasVertex0 && hasVertex3) {
      if (convex1 && convex2) {
        front = offset0 >= 0 || offset1 >= 0 || offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else if (convex1) {
        front = offset0 >= 0 || offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else if (convex2) {
        front = offset2 >= 0 || offset0 >= 0 && offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          scaleVec2(upperLimit, -1, normal0);
        }
      } else {
        front = offset0 >= 0 && offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          scaleVec2(upperLimit, -1, normal0);
        }
      }
    } else if (hasVertex0) {
      if (convex1) {
        front = offset0 >= 0 || offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          scaleVec2(upperLimit, -1, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else {
        front = offset0 >= 0 && offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal0);
        }
      }
    } else if (hasVertex3) {
      if (convex2) {
        front = offset1 >= 0 || offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal1);
        }
      } else {
        front = offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          copyVec2(upperLimit, normal1);
        }
      }
    } else {
      front = offset1 >= 0;
      if (front) {
        copyVec2(normal, normal1);
        scaleVec2(lowerLimit, -1, normal1);
        scaleVec2(upperLimit, -1, normal1);
      } else {
        scaleVec2(normal, -1, normal1);
        copyVec2(lowerLimit, normal1);
        copyVec2(upperLimit, normal1);
      }
    }
    polygonBA.count = polygonB.m_count;
    for (var i = 0; i < polygonB.m_count; ++i) {
      transformVec2(polygonBA.vertices[i], xf, polygonB.m_vertices[i]);
      rotVec2(polygonBA.normals[i], xf.q, polygonB.m_normals[i]);
    }
    var radius = polygonB.m_radius + edgeA.m_radius;
    manifold.pointCount = 0;
    {
      edgeAxis.type = EPAxisType.e_edgeA;
      edgeAxis.index = front ? 0 : 1;
      edgeAxis.separation = Infinity;
      for (var i = 0; i < polygonBA.count; ++i) {
        var v4 = polygonBA.vertices[i];
        var s2 = dotVec2(normal, v4) - dotVec2(normal, v13);
        if (s2 < edgeAxis.separation) {
          edgeAxis.separation = s2;
        }
      }
    }
    if (edgeAxis.type == EPAxisType.e_unknown) {
      return;
    }
    if (edgeAxis.separation > radius) {
      return;
    }
    {
      polygonAxis.type = EPAxisType.e_unknown;
      polygonAxis.index = -1;
      polygonAxis.separation = -Infinity;
      setVec2(perp, -normal.y, normal.x);
      for (var i = 0; i < polygonBA.count; ++i) {
        scaleVec2(n, -1, polygonBA.normals[i]);
        var s1 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v13);
        var s22 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v22);
        var s2 = math_min(s1, s22);
        if (s2 > radius) {
          polygonAxis.type = EPAxisType.e_edgeB;
          polygonAxis.index = i;
          polygonAxis.separation = s2;
          break;
        }
        if (dotVec2(n, perp) >= 0) {
          if (dotVec2(n, normal) - dotVec2(upperLimit, normal) < -SettingsInternal.angularSlop) {
            continue;
          }
        } else {
          if (dotVec2(n, normal) - dotVec2(lowerLimit, normal) < -SettingsInternal.angularSlop) {
            continue;
          }
        }
        if (s2 > polygonAxis.separation) {
          polygonAxis.type = EPAxisType.e_edgeB;
          polygonAxis.index = i;
          polygonAxis.separation = s2;
        }
      }
    }
    if (polygonAxis.type != EPAxisType.e_unknown && polygonAxis.separation > radius) {
      return;
    }
    var k_relativeTol = 0.98;
    var k_absoluteTol = 1e-3;
    var primaryAxis;
    if (polygonAxis.type == EPAxisType.e_unknown) {
      primaryAxis = edgeAxis;
    } else if (polygonAxis.separation > k_relativeTol * edgeAxis.separation + k_absoluteTol) {
      primaryAxis = polygonAxis;
    } else {
      primaryAxis = edgeAxis;
    }
    ie[0].recycle();
    ie[1].recycle();
    if (primaryAxis.type == EPAxisType.e_edgeA) {
      manifold.type = exports2.ManifoldType.e_faceA;
      var bestIndex = 0;
      var bestValue = dotVec2(normal, polygonBA.normals[0]);
      for (var i = 1; i < polygonBA.count; ++i) {
        var value = dotVec2(normal, polygonBA.normals[i]);
        if (value < bestValue) {
          bestValue = value;
          bestIndex = i;
        }
      }
      var i1 = bestIndex;
      var i2 = i1 + 1 < polygonBA.count ? i1 + 1 : 0;
      copyVec2(ie[0].v, polygonBA.vertices[i1]);
      ie[0].id.setFeatures(0, exports2.ContactFeatureType.e_face, i1, exports2.ContactFeatureType.e_vertex);
      copyVec2(ie[1].v, polygonBA.vertices[i2]);
      ie[1].id.setFeatures(0, exports2.ContactFeatureType.e_face, i2, exports2.ContactFeatureType.e_vertex);
      if (front) {
        rf.i1 = 0;
        rf.i2 = 1;
        copyVec2(rf.v1, v13);
        copyVec2(rf.v2, v22);
        copyVec2(rf.normal, normal1);
      } else {
        rf.i1 = 1;
        rf.i2 = 0;
        copyVec2(rf.v1, v22);
        copyVec2(rf.v2, v13);
        scaleVec2(rf.normal, -1, normal1);
      }
    } else {
      manifold.type = exports2.ManifoldType.e_faceB;
      copyVec2(ie[0].v, v13);
      ie[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, primaryAxis.index, exports2.ContactFeatureType.e_face);
      copyVec2(ie[1].v, v22);
      ie[1].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, primaryAxis.index, exports2.ContactFeatureType.e_face);
      rf.i1 = primaryAxis.index;
      rf.i2 = rf.i1 + 1 < polygonBA.count ? rf.i1 + 1 : 0;
      copyVec2(rf.v1, polygonBA.vertices[rf.i1]);
      copyVec2(rf.v2, polygonBA.vertices[rf.i2]);
      copyVec2(rf.normal, polygonBA.normals[rf.i1]);
    }
    setVec2(rf.sideNormal1, rf.normal.y, -rf.normal.x);
    setVec2(rf.sideNormal2, -rf.sideNormal1.x, -rf.sideNormal1.y);
    rf.sideOffset1 = dotVec2(rf.sideNormal1, rf.v1);
    rf.sideOffset2 = dotVec2(rf.sideNormal2, rf.v2);
    clipPoints1[0].recycle();
    clipPoints1[1].recycle();
    clipPoints2[0].recycle();
    clipPoints2[1].recycle();
    var np1 = clipSegmentToLine(clipPoints1, ie, rf.sideNormal1, rf.sideOffset1, rf.i1);
    if (np1 < SettingsInternal.maxManifoldPoints) {
      return;
    }
    var np2 = clipSegmentToLine(clipPoints2, clipPoints1, rf.sideNormal2, rf.sideOffset2, rf.i2);
    if (np2 < SettingsInternal.maxManifoldPoints) {
      return;
    }
    if (primaryAxis.type == EPAxisType.e_edgeA) {
      copyVec2(manifold.localNormal, rf.normal);
      copyVec2(manifold.localPoint, rf.v1);
    } else {
      copyVec2(manifold.localNormal, polygonB.m_normals[rf.i1]);
      copyVec2(manifold.localPoint, polygonB.m_vertices[rf.i1]);
    }
    var pointCount = 0;
    for (var i = 0; i < SettingsInternal.maxManifoldPoints; ++i) {
      var separation = dotVec2(rf.normal, clipPoints2[i].v) - dotVec2(rf.normal, rf.v1);
      if (separation <= radius) {
        var cp = manifold.points[pointCount];
        if (primaryAxis.type == EPAxisType.e_edgeA) {
          detransformVec2(cp.localPoint, xf, clipPoints2[i].v);
          cp.id.set(clipPoints2[i].id);
        } else {
          copyVec2(cp.localPoint, clipPoints2[i].v);
          cp.id.set(clipPoints2[i].id);
          cp.id.swapFeatures();
        }
        ++pointCount;
      }
    }
    manifold.pointCount = pointCount;
  };
  var internal = {
    CollidePolygons,
    Settings,
    Sweep,
    Manifold,
    Distance,
    TimeOfImpact,
    DynamicTree,
    stats
  };
  var DataDriver = (
    /** @class */
    function() {
      function DataDriver2(key, listener) {
        this._refMap = {};
        this._map = {};
        this._xmap = {};
        this._data = [];
        this._entered = [];
        this._exited = [];
        this._key = key;
        this._listener = listener;
      }
      DataDriver2.prototype.update = function(data) {
        if (!Array.isArray(data))
          throw "Invalid data: " + data;
        this._entered.length = 0;
        this._exited.length = 0;
        this._data.length = data.length;
        for (var i = 0; i < data.length; i++) {
          if (typeof data[i] !== "object" || data[i] === null)
            continue;
          var d2 = data[i];
          var id = this._key(d2);
          if (!this._map[id]) {
            this._entered.push(d2);
          } else {
            delete this._map[id];
          }
          this._data[i] = d2;
          this._xmap[id] = d2;
        }
        for (var id in this._map) {
          this._exited.push(this._map[id]);
          delete this._map[id];
        }
        var temp3 = this._map;
        this._map = this._xmap;
        this._xmap = temp3;
        for (var i = 0; i < this._exited.length; i++) {
          var d2 = this._exited[i];
          var key = this._key(d2);
          var ref = this._refMap[key];
          this._listener.exit(d2, ref);
          delete this._refMap[key];
        }
        for (var i = 0; i < this._entered.length; i++) {
          var d2 = this._entered[i];
          var key = this._key(d2);
          var ref = this._listener.enter(d2);
          if (ref) {
            this._refMap[key] = ref;
          }
        }
        for (var i = 0; i < this._data.length; i++) {
          if (typeof data[i] !== "object" || data[i] === null)
            continue;
          var d2 = this._data[i];
          var key = this._key(d2);
          var ref = this._refMap[key];
          this._listener.update(d2, ref);
        }
        this._entered.length = 0;
        this._exited.length = 0;
        this._data.length = 0;
      };
      DataDriver2.prototype.ref = function(d2) {
        return this._refMap[this._key(d2)];
      };
      return DataDriver2;
    }()
  );
  const planck = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
    __proto__: null,
    AABB,
    Body,
    Box: BoxShape,
    BoxShape,
    BroadPhase,
    Chain: ChainShape,
    ChainShape,
    Circle: CircleShape,
    CircleShape,
    ClipVertex,
    CollideCircles,
    CollideEdgeCircle,
    CollideEdgePolygon,
    CollidePolygonCircle,
    CollidePolygons,
    Contact,
    ContactEdge,
    get ContactFeatureType() {
      return exports2.ContactFeatureType;
    },
    ContactID,
    ContactImpulse,
    DataDriver,
    Distance,
    DistanceInput,
    DistanceJoint,
    DistanceOutput,
    DistanceProxy,
    DynamicTree,
    Edge: EdgeShape,
    EdgeShape,
    Fixture,
    FixtureProxy,
    FrictionJoint,
    GearJoint,
    Joint,
    JointEdge,
    Manifold,
    ManifoldPoint,
    get ManifoldType() {
      return exports2.ManifoldType;
    },
    Mat22,
    Mat33,
    Math: math,
    MotorJoint,
    MouseJoint,
    get PointState() {
      return exports2.PointState;
    },
    Polygon: PolygonShape,
    PolygonShape,
    PrismaticJoint,
    PulleyJoint,
    RevoluteJoint,
    RopeJoint,
    Rot,
    Serializer,
    Settings,
    SettingsInternal,
    Shape,
    ShapeCast,
    ShapeCastInput,
    ShapeCastOutput,
    SimplexCache,
    Solver,
    Sweep,
    TOIInput,
    TOIOutput,
    get TOIOutputState() {
      return exports2.TOIOutputState;
    },
    Testbed,
    TimeOfImpact,
    TimeStep,
    Transform,
    TreeNode,
    Vec2,
    Vec3,
    VelocityConstraintPoint,
    WeldJoint,
    WheelJoint,
    World,
    WorldManifold,
    clipSegmentToLine,
    getPointStates,
    internal,
    mixFriction,
    mixRestitution,
    stats,
    testOverlap,
    testbed
  }, Symbol.toStringTag, { value: "Module" }));
  exports2.AABB = AABB;
  exports2.Body = Body;
  exports2.Box = BoxShape;
  exports2.BoxShape = BoxShape;
  exports2.BroadPhase = BroadPhase;
  exports2.Chain = ChainShape;
  exports2.ChainShape = ChainShape;
  exports2.Circle = CircleShape;
  exports2.CircleShape = CircleShape;
  exports2.ClipVertex = ClipVertex;
  exports2.CollideCircles = CollideCircles;
  exports2.CollideEdgeCircle = CollideEdgeCircle;
  exports2.CollideEdgePolygon = CollideEdgePolygon;
  exports2.CollidePolygonCircle = CollidePolygonCircle;
  exports2.CollidePolygons = CollidePolygons;
  exports2.Contact = Contact;
  exports2.ContactEdge = ContactEdge;
  exports2.ContactID = ContactID;
  exports2.ContactImpulse = ContactImpulse;
  exports2.DataDriver = DataDriver;
  exports2.Distance = Distance;
  exports2.DistanceInput = DistanceInput;
  exports2.DistanceJoint = DistanceJoint;
  exports2.DistanceOutput = DistanceOutput;
  exports2.DistanceProxy = DistanceProxy;
  exports2.DynamicTree = DynamicTree;
  exports2.Edge = EdgeShape;
  exports2.EdgeShape = EdgeShape;
  exports2.Fixture = Fixture;
  exports2.FixtureProxy = FixtureProxy;
  exports2.FrictionJoint = FrictionJoint;
  exports2.GearJoint = GearJoint;
  exports2.Joint = Joint;
  exports2.JointEdge = JointEdge;
  exports2.Manifold = Manifold;
  exports2.ManifoldPoint = ManifoldPoint;
  exports2.Mat22 = Mat22;
  exports2.Mat33 = Mat33;
  exports2.Math = math;
  exports2.MotorJoint = MotorJoint;
  exports2.MouseJoint = MouseJoint;
  exports2.Polygon = PolygonShape;
  exports2.PolygonShape = PolygonShape;
  exports2.PrismaticJoint = PrismaticJoint;
  exports2.PulleyJoint = PulleyJoint;
  exports2.RevoluteJoint = RevoluteJoint;
  exports2.RopeJoint = RopeJoint;
  exports2.Rot = Rot;
  exports2.Serializer = Serializer;
  exports2.Settings = Settings;
  exports2.SettingsInternal = SettingsInternal;
  exports2.Shape = Shape;
  exports2.ShapeCast = ShapeCast;
  exports2.ShapeCastInput = ShapeCastInput;
  exports2.ShapeCastOutput = ShapeCastOutput;
  exports2.SimplexCache = SimplexCache;
  exports2.Solver = Solver;
  exports2.Sweep = Sweep;
  exports2.TOIInput = TOIInput;
  exports2.TOIOutput = TOIOutput;
  exports2.Testbed = Testbed;
  exports2.TimeOfImpact = TimeOfImpact;
  exports2.TimeStep = TimeStep;
  exports2.Transform = Transform;
  exports2.TreeNode = TreeNode;
  exports2.Vec2 = Vec2;
  exports2.Vec3 = Vec3;
  exports2.VelocityConstraintPoint = VelocityConstraintPoint;
  exports2.WeldJoint = WeldJoint;
  exports2.WheelJoint = WheelJoint;
  exports2.World = World;
  exports2.WorldManifold = WorldManifold;
  exports2.clipSegmentToLine = clipSegmentToLine;
  exports2.default = planck;
  exports2.getPointStates = getPointStates;
  exports2.internal = internal;
  exports2.mixFriction = mixFriction;
  exports2.mixRestitution = mixRestitution;
  exports2.stats = stats;
  exports2.testOverlap = testOverlap;
  exports2.testbed = testbed;
  Object.defineProperties(exports2, { __esModule: { value: true }, [Symbol.toStringTag]: { value: "Module" } });
});
//# sourceMappingURL=planck.js.map


/***/ }),

/***/ "./src/core/asset-loader.ts":
/*!**********************************!*\
  !*** ./src/core/asset-loader.ts ***!
  \**********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.AssetLoader = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const event_system_1 = __webpack_require__(/*! ./event-system */ "./src/core/event-system.ts");
class AssetLoader {
    PIXIAssets = pixi_js_1.default.Assets;
    textures = [];
    isLoading = false;
    events = new event_system_1.EventEmitter();
    on(event, listener) {
        this.events.on(event, listener);
    }
    off(event, listener) {
        this.events.off(event, listener);
    }
    loadAssets = async (assets) => {
        const { PIXIAssets } = this;
        const failedAssets = [];
        this.isLoading = true;
        this.events.emit('loading:start');
        try {
            for (let i = 0; i < assets.length; i++) {
                const { src, alias } = assets[i];
                try {
                    if (alias) {
                        if (!PIXIAssets.cache.has(alias)) {
                            const texture = await PIXIAssets.load({ alias, src });
                            this.textures.push(texture);
                        }
                    }
                    else {
                        const texture = await PIXIAssets.load(src);
                        this.textures.push(texture);
                    }
                }
                catch (error) {
                    console.error(`Failed to load asset: ${src}`, error);
                    failedAssets.push(src);
                }
            }
            if (failedAssets.length > 0) {
                console.warn(`${failedAssets.length} asset(s) failed to load:`, failedAssets);
            }
            return this;
        }
        finally {
            this.isLoading = false;
            this.events.emit('loading:end');
        }
    };
}
exports.AssetLoader = AssetLoader;


/***/ }),

/***/ "./src/core/camera.ts":
/*!****************************!*\
  !*** ./src/core/camera.ts ***!
  \****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Camera = exports.CameraLogic = void 0;
const pixi_js_1 = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const logic_1 = __webpack_require__(/*! ./logic */ "./src/core/logic.ts");
const moxi_entity_1 = __webpack_require__(/*! ./moxi-entity */ "./src/core/moxi-entity.ts");
const utils_1 = __webpack_require__(/*! ../library/utils */ "./src/library/utils.ts");
class CameraLogic extends logic_1.Logic {
    name = 'CameraLogic';
    speed = 0.1;
    target = null;
    entity;
    renderer;
    init(entity, renderer) {
        this.entity = entity;
        this.renderer = renderer;
    }
    update(entity, deltaTime) {
        const { speed } = this;
        const deltaSpeed = Math.min(deltaTime * speed, 1);
        const isZooming = Math.abs(entity.scale.x - entity.desiredScale.x) > 0.01 ||
            Math.abs(entity.scale.y - entity.desiredScale.y) > 0.01;
        if (entity.desiredScale !== entity.scale) {
            entity.scale.x = (0, utils_1.lerp)(entity.scale.x, entity.desiredScale.x, deltaSpeed);
            entity.scale.y = (0, utils_1.lerp)(entity.scale.y, entity.desiredScale.y, deltaSpeed);
        }
        if (this.target) {
            const screenCenterX = this.renderer.width / 2;
            const screenCenterY = this.renderer.height / 2;
            const desiredX = -(this.target.position.x * entity.scale.x) + screenCenterX;
            const desiredY = -(this.target.position.y * entity.scale.y) + screenCenterY;
            entity.desiredPosition.set(-desiredX, -desiredY);
        }
        if (entity.desiredPosition !== entity.position) {
            if (isZooming) {
                entity.position.copyFrom(entity.desiredPosition);
            }
            else {
                entity.position.x = (0, utils_1.lerp)(entity.position.x, entity.desiredPosition.x, deltaSpeed);
                entity.position.y = (0, utils_1.lerp)(entity.position.y, entity.desiredPosition.y, deltaSpeed);
            }
        }
        entity.scene.scale.set(entity.scale.x, entity.scale.y);
        entity.scene.position.set(-entity.position.x, -entity.position.y);
    }
}
exports.CameraLogic = CameraLogic;
class Camera extends pixi_js_1.default.Container {
    scene;
    renderer;
    speed = 0.1;
    moxiEntity;
    desiredScale = new pixi_js_1.Point(1, 1);
    desiredPosition = new pixi_js_1.Point(0, 0);
    constructor(scene, renderer, logic = {}) {
        super();
        this.scene = scene;
        this.renderer = renderer;
        const cameraLogic = new CameraLogic();
        cameraLogic.init(this, renderer);
        this.moxiEntity = new moxi_entity_1.MoxiEntity(this, logic);
        this.moxiEntity.addLogic(cameraLogic);
        this.scene.addChild(this);
    }
}
exports.Camera = Camera;


/***/ }),

/***/ "./src/core/engine.ts":
/*!****************************!*\
  !*** ./src/core/engine.ts ***!
  \****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Engine = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
class Engine {
    ticker;
    root;
    physicsWorld;
    logger;
    loggerFrequencyMs;
    nextLogTime;
    constructor(stage = null) {
        this.root = stage;
        const ticker = pixi_js_1.default.Ticker.shared;
        ticker.autoStart = false;
        ticker.add(this.gameLoop);
        this.ticker = ticker;
        this.loggerFrequencyMs = 500;
        this.nextLogTime = 0;
        this.logger = (msg) => null;
    }
    start() {
        this.ticker.start();
        return this;
    }
    stop() {
        this.ticker.stop();
        return this;
    }
    addPhysicsWorld(physicsWorld) {
        this.physicsWorld = physicsWorld;
        return this;
    }
    gameLoop = (tikerTime) => {
        if (this.root) {
            const { deltaTime, deltaMS } = tikerTime;
            if (this.physicsWorld) {
                const deltaSeconds = deltaMS / 1000;
                this.physicsWorld.step(deltaSeconds);
            }
            this.root.update(deltaTime);
            this.root.draw(deltaTime);
        }
    };
    loadStage(stage) {
        this.root = stage;
        return this;
    }
}
exports.Engine = Engine;


/***/ }),

/***/ "./src/core/event-system.ts":
/*!**********************************!*\
  !*** ./src/core/event-system.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.EventEmitter = void 0;
class EventEmitter {
    listeners = {};
    static instance = null;
    on(event, listener) {
        (this.listeners[event] || (this.listeners[event] = [])).push(listener);
    }
    off(event, listener) {
        const eventListeners = this.listeners[event];
        if (eventListeners) {
            this.listeners[event] = eventListeners.filter(l => l !== listener);
        }
    }
    emit(event, ...args) {
        (this.listeners[event] || []).forEach(listener => listener(...args));
    }
    once(event, listener) {
        const onceListener = (...args) => {
            listener(...args);
            this.off(event, listener);
        };
        this.on(event, onceListener);
    }
    static getInstance() {
        if (!EventEmitter.instance) {
            EventEmitter.instance = new EventEmitter();
        }
        return EventEmitter.instance;
    }
}
exports.EventEmitter = EventEmitter;


/***/ }),

/***/ "./src/core/logic.ts":
/*!***************************!*\
  !*** ./src/core/logic.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.InstancedLogic = exports.Logic = void 0;
class Logic {
    name;
    active = true;
    init(entity, renderer, ...args) { }
    update(entity, deltaTime) { }
}
exports.Logic = Logic;
class InstancedLogic extends Logic {
}
exports.InstancedLogic = InstancedLogic;


/***/ }),

/***/ "./src/core/moxi-entity.ts":
/*!*********************************!*\
  !*** ./src/core/moxi-entity.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.MoxiEntity = void 0;
exports.asEntity = asEntity;
class MoxiEntity {
    logic = {};
    entity;
    constructor(entity, logic = {}) {
        this.logic = logic;
        this.entity = entity;
    }
    update(deltaTime) {
        if (!this.entity)
            return;
        for (const className in this.logic) {
            const logicComponent = this.logic[className];
            if (logicComponent && logicComponent.active && logicComponent.update) {
                logicComponent.update(this.entity, deltaTime);
            }
        }
    }
    init(renderer, ...args) {
        if (!this.entity)
            return;
        for (const className in this.logic) {
            const logicComponent = this.logic[className];
            if (logicComponent && logicComponent.init) {
                logicComponent.init(this.entity, renderer, ...args);
            }
        }
    }
    addLogic(logic) {
        const logicName = logic.name || logic.constructor.name;
        this.logic[logicName] = logic;
    }
    getLogic(name) {
        return this.logic[name];
    }
}
exports.MoxiEntity = MoxiEntity;
function asEntity(entity, logic = {}) {
    const target = entity;
    target.isInteractive = () => false;
    target.moxiEntity = new MoxiEntity(target, logic);
    return entity;
}


/***/ }),

/***/ "./src/core/render-manager.ts":
/*!************************************!*\
  !*** ./src/core/render-manager.ts ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.RenderManager = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
class RenderManager {
    static getRenderer;
    static create;
    htmlRoot;
    renderer;
    fitToWindow = false;
    constructor(htmlRoot, renderer) {
        this.htmlRoot = htmlRoot;
        this.renderer = renderer;
        htmlRoot.appendChild(this.renderer.canvas);
        window.addEventListener('resize', () => this.onResize());
        this.onResize();
    }
    render(stage) {
        this.renderer.render(stage);
    }
    onResize = () => {
        const { renderer, htmlRoot: root } = this;
        const canvas = renderer.canvas;
        const parentWidth = root.clientWidth;
        const parentHeight = root.clientHeight;
        const canvasWidth = renderer.width;
        const canvasHeight = renderer.height;
        const scale = Math.min(parentWidth / canvasWidth, parentHeight / canvasHeight);
        canvas.style.width = `${Math.floor(canvasWidth * scale)}px`;
        canvas.style.height = `${Math.floor(canvasHeight * scale)}px`;
    };
}
exports.RenderManager = RenderManager;
RenderManager.getRenderer = async (options) => (await pixi_js_1.default.autoDetectRenderer(options));
RenderManager.create = async (htmlRoot, options) => (new RenderManager(htmlRoot, await RenderManager.getRenderer(options)));


/***/ }),

/***/ "./src/core/scene.ts":
/*!***************************!*\
  !*** ./src/core/scene.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Scene = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function isMoxiEntity(entity) {
    return entity != null && typeof entity === 'object' && 'moxiEntity' in entity;
}
class Scene extends pixi_js_1.default.Container {
    renderer;
    constructor(renderer) {
        super();
        this.renderer = renderer;
    }
    init() {
        this.children.forEach((child) => {
            if (isMoxiEntity(child)) {
                child.moxiEntity.init(this.renderer);
            }
        });
    }
    update(deltaTime) {
        this.children.forEach((child) => {
            if (isMoxiEntity(child)) {
                child.moxiEntity.update(deltaTime);
            }
        });
    }
    draw(deltaTime) {
        this.renderer.render(this);
    }
}
exports.Scene = Scene;


/***/ }),

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.FlexDirection = exports.FlexContainer = exports.UIFocusManager = exports.UIComponent = exports.EdgeInsets = exports.applyMaterial = exports.PhysicsMaterials = exports.createShapeFromSprite = exports.getPhysicsBody = exports.hasPhysics = exports.asPhysicsEntity = exports.CollisionManager = exports.CollisionRegistry = exports.PhysicsDebugRenderer = exports.PhysicsBodyLogic = exports.PhysicsWorld = exports.StateLogic = exports.StateMachine = exports.utils = exports.TilingParallaxLayer = exports.TextureFrameSequences = exports.setupResponsiveCanvas = exports.Scene = exports.RenderManager = exports.setupMoxi = exports.FallingSquaresAnimation = exports.LoadingScene = exports.ParallaxLayer = exports.ParallaxBackgroundLogic = exports.ParallaxBackground = exports.MoxiEntity = exports.loadFonts = exports.getTextureRange = exports.EventEmitter = exports.Engine = exports.defaultRenderOptions = exports.createTileGrid = exports.createResizeHandler = exports.ClientEvents = exports.CameraLogic = exports.Camera = exports.Logic = exports.asContainer = exports.asGraphics = exports.asText = exports.asSprite = exports.asBitmapText = exports.asTextureFrames = exports.asEntity = exports.AssetLoader = void 0;
exports.ActionManager = exports.createBorderConfig = exports.BORDER = exports.GRID = exports.units = exports.px = exports.PixelGrid = exports.svgToTexture = exports.UIScaleMode = exports.UILayer = exports.UITabs = exports.UIScrollContainer = exports.UITextArea = exports.UITextInput = exports.UISelect = exports.ButtonState = exports.UIButton = exports.UIPanel = exports.UILabel = exports.UIBox = exports.FlexAlign = exports.FlexJustify = void 0;
const utils = __importStar(__webpack_require__(/*! ./library/utils */ "./src/library/utils.ts"));
exports.utils = utils;
const render_manager_1 = __webpack_require__(/*! ./core/render-manager */ "./src/core/render-manager.ts");
Object.defineProperty(exports, "RenderManager", ({ enumerable: true, get: function () { return render_manager_1.RenderManager; } }));
const scene_1 = __webpack_require__(/*! ./core/scene */ "./src/core/scene.ts");
Object.defineProperty(exports, "Scene", ({ enumerable: true, get: function () { return scene_1.Scene; } }));
const engine_1 = __webpack_require__(/*! ./core/engine */ "./src/core/engine.ts");
Object.defineProperty(exports, "Engine", ({ enumerable: true, get: function () { return engine_1.Engine; } }));
const event_system_1 = __webpack_require__(/*! ./core/event-system */ "./src/core/event-system.ts");
Object.defineProperty(exports, "EventEmitter", ({ enumerable: true, get: function () { return event_system_1.EventEmitter; } }));
const client_events_1 = __webpack_require__(/*! ./library/client-events */ "./src/library/client-events.ts");
Object.defineProperty(exports, "ClientEvents", ({ enumerable: true, get: function () { return client_events_1.ClientEvents; } }));
const asset_loader_1 = __webpack_require__(/*! ./core/asset-loader */ "./src/core/asset-loader.ts");
Object.defineProperty(exports, "AssetLoader", ({ enumerable: true, get: function () { return asset_loader_1.AssetLoader; } }));
const logic_1 = __webpack_require__(/*! ./core/logic */ "./src/core/logic.ts");
Object.defineProperty(exports, "Logic", ({ enumerable: true, get: function () { return logic_1.Logic; } }));
const setup_1 = __webpack_require__(/*! ./library/setup */ "./src/library/setup.ts");
Object.defineProperty(exports, "defaultRenderOptions", ({ enumerable: true, get: function () { return setup_1.defaultRenderOptions; } }));
Object.defineProperty(exports, "setupMoxi", ({ enumerable: true, get: function () { return setup_1.setupMoxi; } }));
const font_loader_1 = __webpack_require__(/*! ./library/font-loader */ "./src/library/font-loader.ts");
Object.defineProperty(exports, "loadFonts", ({ enumerable: true, get: function () { return font_loader_1.loadFonts; } }));
const moxi_entity_1 = __webpack_require__(/*! ./core/moxi-entity */ "./src/core/moxi-entity.ts");
Object.defineProperty(exports, "asEntity", ({ enumerable: true, get: function () { return moxi_entity_1.asEntity; } }));
Object.defineProperty(exports, "MoxiEntity", ({ enumerable: true, get: function () { return moxi_entity_1.MoxiEntity; } }));
const camera_1 = __webpack_require__(/*! ./core/camera */ "./src/core/camera.ts");
Object.defineProperty(exports, "Camera", ({ enumerable: true, get: function () { return camera_1.Camera; } }));
Object.defineProperty(exports, "CameraLogic", ({ enumerable: true, get: function () { return camera_1.CameraLogic; } }));
const texture_frames_1 = __webpack_require__(/*! ./library/texture-frames */ "./src/library/texture-frames.ts");
Object.defineProperty(exports, "asTextureFrames", ({ enumerable: true, get: function () { return texture_frames_1.asTextureFrames; } }));
const as_pixi_1 = __webpack_require__(/*! ./library/as-pixi */ "./src/library/as-pixi.ts");
Object.defineProperty(exports, "asBitmapText", ({ enumerable: true, get: function () { return as_pixi_1.asBitmapText; } }));
Object.defineProperty(exports, "asSprite", ({ enumerable: true, get: function () { return as_pixi_1.asSprite; } }));
Object.defineProperty(exports, "asText", ({ enumerable: true, get: function () { return as_pixi_1.asText; } }));
Object.defineProperty(exports, "asGraphics", ({ enumerable: true, get: function () { return as_pixi_1.asGraphics; } }));
Object.defineProperty(exports, "asContainer", ({ enumerable: true, get: function () { return as_pixi_1.asContainer; } }));
const texture_frame_sequences_1 = __webpack_require__(/*! ./library/texture-frame-sequences */ "./src/library/texture-frame-sequences.ts");
Object.defineProperty(exports, "TextureFrameSequences", ({ enumerable: true, get: function () { return texture_frame_sequences_1.TextureFrameSequences; } }));
const resize_handler_1 = __webpack_require__(/*! ./library/resize-handler */ "./src/library/resize-handler.ts");
Object.defineProperty(exports, "createResizeHandler", ({ enumerable: true, get: function () { return resize_handler_1.createResizeHandler; } }));
Object.defineProperty(exports, "setupResponsiveCanvas", ({ enumerable: true, get: function () { return resize_handler_1.setupResponsiveCanvas; } }));
const edge_insets_1 = __webpack_require__(/*! ./ui/core/edge-insets */ "./src/ui/core/edge-insets.ts");
Object.defineProperty(exports, "EdgeInsets", ({ enumerable: true, get: function () { return edge_insets_1.EdgeInsets; } }));
const ui_component_1 = __webpack_require__(/*! ./ui/core/ui-component */ "./src/ui/core/ui-component.ts");
Object.defineProperty(exports, "UIComponent", ({ enumerable: true, get: function () { return ui_component_1.UIComponent; } }));
const ui_focus_manager_1 = __webpack_require__(/*! ./ui/core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
Object.defineProperty(exports, "UIFocusManager", ({ enumerable: true, get: function () { return ui_focus_manager_1.UIFocusManager; } }));
const flex_container_1 = __webpack_require__(/*! ./ui/layout/flex-container */ "./src/ui/layout/flex-container.ts");
Object.defineProperty(exports, "FlexContainer", ({ enumerable: true, get: function () { return flex_container_1.FlexContainer; } }));
Object.defineProperty(exports, "FlexDirection", ({ enumerable: true, get: function () { return flex_container_1.FlexDirection; } }));
Object.defineProperty(exports, "FlexJustify", ({ enumerable: true, get: function () { return flex_container_1.FlexJustify; } }));
Object.defineProperty(exports, "FlexAlign", ({ enumerable: true, get: function () { return flex_container_1.FlexAlign; } }));
const ui_box_1 = __webpack_require__(/*! ./ui/components/ui-box */ "./src/ui/components/ui-box.ts");
Object.defineProperty(exports, "UIBox", ({ enumerable: true, get: function () { return ui_box_1.UIBox; } }));
const ui_label_1 = __webpack_require__(/*! ./ui/components/ui-label */ "./src/ui/components/ui-label.ts");
Object.defineProperty(exports, "UILabel", ({ enumerable: true, get: function () { return ui_label_1.UILabel; } }));
const ui_panel_1 = __webpack_require__(/*! ./ui/components/ui-panel */ "./src/ui/components/ui-panel.ts");
Object.defineProperty(exports, "UIPanel", ({ enumerable: true, get: function () { return ui_panel_1.UIPanel; } }));
const ui_button_1 = __webpack_require__(/*! ./ui/components/ui-button */ "./src/ui/components/ui-button.ts");
Object.defineProperty(exports, "UIButton", ({ enumerable: true, get: function () { return ui_button_1.UIButton; } }));
Object.defineProperty(exports, "ButtonState", ({ enumerable: true, get: function () { return ui_button_1.ButtonState; } }));
const ui_select_1 = __webpack_require__(/*! ./ui/components/ui-select */ "./src/ui/components/ui-select.ts");
Object.defineProperty(exports, "UISelect", ({ enumerable: true, get: function () { return ui_select_1.UISelect; } }));
const ui_text_input_1 = __webpack_require__(/*! ./ui/components/ui-text-input */ "./src/ui/components/ui-text-input.ts");
Object.defineProperty(exports, "UITextInput", ({ enumerable: true, get: function () { return ui_text_input_1.UITextInput; } }));
const ui_textarea_1 = __webpack_require__(/*! ./ui/components/ui-textarea */ "./src/ui/components/ui-textarea.ts");
Object.defineProperty(exports, "UITextArea", ({ enumerable: true, get: function () { return ui_textarea_1.UITextArea; } }));
const ui_scroll_container_1 = __webpack_require__(/*! ./ui/components/ui-scroll-container */ "./src/ui/components/ui-scroll-container.ts");
Object.defineProperty(exports, "UIScrollContainer", ({ enumerable: true, get: function () { return ui_scroll_container_1.UIScrollContainer; } }));
const ui_tabs_1 = __webpack_require__(/*! ./ui/components/ui-tabs */ "./src/ui/components/ui-tabs.ts");
Object.defineProperty(exports, "UITabs", ({ enumerable: true, get: function () { return ui_tabs_1.UITabs; } }));
const UILayer_1 = __webpack_require__(/*! ./ui/UILayer */ "./src/ui/UILayer.ts");
Object.defineProperty(exports, "UILayer", ({ enumerable: true, get: function () { return UILayer_1.UILayer; } }));
const UIScaleMode_1 = __webpack_require__(/*! ./ui/UIScaleMode */ "./src/ui/UIScaleMode.ts");
Object.defineProperty(exports, "UIScaleMode", ({ enumerable: true, get: function () { return UIScaleMode_1.UIScaleMode; } }));
const state_machine_1 = __webpack_require__(/*! ./library/state-machine */ "./src/library/state-machine.ts");
Object.defineProperty(exports, "StateMachine", ({ enumerable: true, get: function () { return state_machine_1.StateMachine; } }));
const state_logic_1 = __webpack_require__(/*! ./library/state-logic */ "./src/library/state-logic.ts");
Object.defineProperty(exports, "StateLogic", ({ enumerable: true, get: function () { return state_logic_1.StateLogic; } }));
const grid_generator_1 = __webpack_require__(/*! ./library/grid-generator */ "./src/library/grid-generator.ts");
Object.defineProperty(exports, "createTileGrid", ({ enumerable: true, get: function () { return grid_generator_1.createTileGrid; } }));
Object.defineProperty(exports, "getTextureRange", ({ enumerable: true, get: function () { return grid_generator_1.getTextureRange; } }));
const svg_to_texture_1 = __webpack_require__(/*! ./library/svg-utils/svg-to-texture */ "./src/library/svg-utils/svg-to-texture.ts");
Object.defineProperty(exports, "svgToTexture", ({ enumerable: true, get: function () { return svg_to_texture_1.svgToTexture; } }));
const pixel_grid_1 = __webpack_require__(/*! ./ui/pixel-grid */ "./src/ui/pixel-grid.ts");
Object.defineProperty(exports, "PixelGrid", ({ enumerable: true, get: function () { return pixel_grid_1.PixelGrid; } }));
Object.defineProperty(exports, "px", ({ enumerable: true, get: function () { return pixel_grid_1.px; } }));
Object.defineProperty(exports, "units", ({ enumerable: true, get: function () { return pixel_grid_1.units; } }));
Object.defineProperty(exports, "GRID", ({ enumerable: true, get: function () { return pixel_grid_1.GRID; } }));
Object.defineProperty(exports, "BORDER", ({ enumerable: true, get: function () { return pixel_grid_1.BORDER; } }));
Object.defineProperty(exports, "createBorderConfig", ({ enumerable: true, get: function () { return pixel_grid_1.createBorderConfig; } }));
const parallax_background_1 = __webpack_require__(/*! ./library/parallax-background */ "./src/library/parallax-background.ts");
Object.defineProperty(exports, "ParallaxBackground", ({ enumerable: true, get: function () { return parallax_background_1.ParallaxBackground; } }));
Object.defineProperty(exports, "ParallaxBackgroundLogic", ({ enumerable: true, get: function () { return parallax_background_1.ParallaxBackgroundLogic; } }));
const parallax_layer_1 = __webpack_require__(/*! ./library/parallax-layer */ "./src/library/parallax-layer.ts");
Object.defineProperty(exports, "ParallaxLayer", ({ enumerable: true, get: function () { return parallax_layer_1.ParallaxLayer; } }));
Object.defineProperty(exports, "TilingParallaxLayer", ({ enumerable: true, get: function () { return parallax_layer_1.TilingParallaxLayer; } }));
const loading_scene_1 = __webpack_require__(/*! ./library/loading-scene */ "./src/library/loading-scene.ts");
Object.defineProperty(exports, "LoadingScene", ({ enumerable: true, get: function () { return loading_scene_1.LoadingScene; } }));
Object.defineProperty(exports, "FallingSquaresAnimation", ({ enumerable: true, get: function () { return loading_scene_1.FallingSquaresAnimation; } }));
const action_manager_1 = __webpack_require__(/*! ./library/action-manager */ "./src/library/action-manager.ts");
Object.defineProperty(exports, "ActionManager", ({ enumerable: true, get: function () { return action_manager_1.ActionManager; } }));
const physics_1 = __webpack_require__(/*! ./library/physics */ "./src/library/physics/index.ts");
Object.defineProperty(exports, "PhysicsWorld", ({ enumerable: true, get: function () { return physics_1.PhysicsWorld; } }));
Object.defineProperty(exports, "PhysicsBodyLogic", ({ enumerable: true, get: function () { return physics_1.PhysicsBodyLogic; } }));
Object.defineProperty(exports, "PhysicsDebugRenderer", ({ enumerable: true, get: function () { return physics_1.PhysicsDebugRenderer; } }));
Object.defineProperty(exports, "CollisionRegistry", ({ enumerable: true, get: function () { return physics_1.CollisionRegistry; } }));
Object.defineProperty(exports, "CollisionManager", ({ enumerable: true, get: function () { return physics_1.CollisionManager; } }));
Object.defineProperty(exports, "asPhysicsEntity", ({ enumerable: true, get: function () { return physics_1.asPhysicsEntity; } }));
Object.defineProperty(exports, "hasPhysics", ({ enumerable: true, get: function () { return physics_1.hasPhysics; } }));
Object.defineProperty(exports, "getPhysicsBody", ({ enumerable: true, get: function () { return physics_1.getPhysicsBody; } }));
Object.defineProperty(exports, "createShapeFromSprite", ({ enumerable: true, get: function () { return physics_1.createShapeFromSprite; } }));
Object.defineProperty(exports, "PhysicsMaterials", ({ enumerable: true, get: function () { return physics_1.PhysicsMaterials; } }));
Object.defineProperty(exports, "applyMaterial", ({ enumerable: true, get: function () { return physics_1.applyMaterial; } }));
const exportedObjects = {
    AssetLoader: asset_loader_1.AssetLoader,
    asEntity: moxi_entity_1.asEntity,
    asTextureFrames: texture_frames_1.asTextureFrames,
    asBitmapText: as_pixi_1.asBitmapText,
    asSprite: as_pixi_1.asSprite,
    asText: as_pixi_1.asText,
    asGraphics: as_pixi_1.asGraphics,
    asContainer: as_pixi_1.asContainer,
    Logic: logic_1.Logic,
    Camera: camera_1.Camera,
    CameraLogic: camera_1.CameraLogic,
    ClientEvents: client_events_1.ClientEvents,
    createResizeHandler: resize_handler_1.createResizeHandler,
    createTileGrid: grid_generator_1.createTileGrid,
    defaultRenderOptions: setup_1.defaultRenderOptions,
    Engine: engine_1.Engine,
    EventEmitter: event_system_1.EventEmitter,
    getTextureRange: grid_generator_1.getTextureRange,
    loadFonts: font_loader_1.loadFonts,
    MoxiEntity: moxi_entity_1.MoxiEntity,
    ParallaxBackground: parallax_background_1.ParallaxBackground,
    ParallaxBackgroundLogic: parallax_background_1.ParallaxBackgroundLogic,
    ParallaxLayer: parallax_layer_1.ParallaxLayer,
    LoadingScene: loading_scene_1.LoadingScene,
    FallingSquaresAnimation: loading_scene_1.FallingSquaresAnimation,
    setupMoxi: setup_1.setupMoxi,
    RenderManager: render_manager_1.RenderManager,
    Scene: scene_1.Scene,
    setupResponsiveCanvas: resize_handler_1.setupResponsiveCanvas,
    TextureFrameSequences: texture_frame_sequences_1.TextureFrameSequences,
    TilingParallaxLayer: parallax_layer_1.TilingParallaxLayer,
    utils,
    StateMachine: state_machine_1.StateMachine,
    StateLogic: state_logic_1.StateLogic,
    PhysicsWorld: physics_1.PhysicsWorld,
    PhysicsBodyLogic: physics_1.PhysicsBodyLogic,
    PhysicsDebugRenderer: physics_1.PhysicsDebugRenderer,
    CollisionRegistry: physics_1.CollisionRegistry,
    CollisionManager: physics_1.CollisionManager,
    asPhysicsEntity: physics_1.asPhysicsEntity,
    hasPhysics: physics_1.hasPhysics,
    getPhysicsBody: physics_1.getPhysicsBody,
    createShapeFromSprite: physics_1.createShapeFromSprite,
    PhysicsMaterials: physics_1.PhysicsMaterials,
    applyMaterial: physics_1.applyMaterial,
    EdgeInsets: edge_insets_1.EdgeInsets,
    UIComponent: ui_component_1.UIComponent,
    UIFocusManager: ui_focus_manager_1.UIFocusManager,
    FlexContainer: flex_container_1.FlexContainer,
    FlexDirection: flex_container_1.FlexDirection,
    FlexJustify: flex_container_1.FlexJustify,
    FlexAlign: flex_container_1.FlexAlign,
    UIBox: ui_box_1.UIBox,
    UILabel: ui_label_1.UILabel,
    UIPanel: ui_panel_1.UIPanel,
    UIButton: ui_button_1.UIButton,
    ButtonState: ui_button_1.ButtonState,
    UISelect: ui_select_1.UISelect,
    UITextInput: ui_text_input_1.UITextInput,
    UITextArea: ui_textarea_1.UITextArea,
    UIScrollContainer: ui_scroll_container_1.UIScrollContainer,
    UITabs: ui_tabs_1.UITabs,
    UILayer: UILayer_1.UILayer,
    UIScaleMode: UIScaleMode_1.UIScaleMode,
    svgToTexture: svg_to_texture_1.svgToTexture,
    PixelGrid: pixel_grid_1.PixelGrid,
    px: pixel_grid_1.px,
    units: pixel_grid_1.units,
    GRID: pixel_grid_1.GRID,
    BORDER: pixel_grid_1.BORDER,
    createBorderConfig: pixel_grid_1.createBorderConfig,
    ActionManager: action_manager_1.ActionManager
};
exports["default"] = exportedObjects;


/***/ }),

/***/ "./src/library/action-manager.ts":
/*!***************************************!*\
  !*** ./src/library/action-manager.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.ActionManager = void 0;
class ActionManager {
    actions = new Set();
    add(target, type, handler, options) {
        const action = { target, type, handler, options };
        target.addEventListener(type, handler, options);
        this.actions.add(action);
        return action;
    }
    remove(action) {
        if (this.actions.has(action)) {
            action.target.removeEventListener(action.type, action.handler, action.options);
            this.actions.delete(action);
        }
    }
    removeAll() {
        this.actions.forEach(action => {
            action.target.removeEventListener(action.type, action.handler, action.options);
        });
        this.actions.clear();
    }
    getCount() {
        return this.actions.size;
    }
    hasAction(action) {
        return this.actions.has(action);
    }
}
exports.ActionManager = ActionManager;


/***/ }),

/***/ "./src/library/as-pixi.ts":
/*!********************************!*\
  !*** ./src/library/as-pixi.ts ***!
  \********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asBitmapText = asBitmapText;
exports.asSprite = asSprite;
exports.asText = asText;
exports.asGraphics = asGraphics;
exports.asContainer = asContainer;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function applyProps(obj, props) {
    if (!props)
        return obj;
    if (props.x !== undefined)
        obj.x = props.x;
    if (props.y !== undefined)
        obj.y = props.y;
    if (props.anchor !== undefined) {
        if (typeof props.anchor === 'number') {
            if ('anchor' in obj && typeof obj.anchor === 'object' && obj.anchor !== null) {
                obj.anchor.set(props.anchor);
            }
        }
        else {
            if ('anchor' in obj && typeof obj.anchor === 'object' && obj.anchor !== null) {
                const anchor = obj.anchor;
                if (props.anchor.x !== undefined)
                    anchor.x = props.anchor.x;
                if (props.anchor.y !== undefined)
                    anchor.y = props.anchor.y;
            }
        }
    }
    if (props.scale !== undefined) {
        if (typeof props.scale === 'number') {
            if ('scale' in obj && typeof obj.scale === 'object' && obj.scale !== null) {
                obj.scale.set(props.scale);
            }
        }
        else {
            if ('scale' in obj && typeof obj.scale === 'object' && obj.scale !== null) {
                const scale = obj.scale;
                if (props.scale.x !== undefined)
                    scale.x = props.scale.x;
                if (props.scale.y !== undefined)
                    scale.y = props.scale.y;
            }
        }
    }
    if (props.rotation !== undefined)
        obj.rotation = props.rotation;
    if (props.tint !== undefined && 'tint' in obj)
        obj.tint = props.tint;
    if (props.alpha !== undefined)
        obj.alpha = props.alpha;
    if (props.visible !== undefined)
        obj.visible = props.visible;
    if (props.eventMode !== undefined && 'eventMode' in obj)
        obj.eventMode = props.eventMode;
    if (props.pivot !== undefined) {
        if (typeof props.pivot === 'number') {
            if ('pivot' in obj && typeof obj.pivot === 'object' && obj.pivot !== null) {
                obj.pivot.set(props.pivot);
            }
        }
        else {
            if ('pivot' in obj && typeof obj.pivot === 'object' && obj.pivot !== null) {
                const pivot = obj.pivot;
                if (props.pivot.x !== undefined)
                    pivot.x = props.pivot.x;
                if (props.pivot.y !== undefined)
                    pivot.y = props.pivot.y;
            }
        }
    }
    return obj;
}
function asBitmapText(constructorArgs, props) {
    const { pixelPerfect, ...textArgs } = constructorArgs;
    const text = new pixi_js_1.default.BitmapText(textArgs);
    if (pixelPerfect) {
        text.roundPixels = true;
    }
    return applyProps(text, props);
}
function asSprite(constructorArgs, props) {
    const sprite = new pixi_js_1.default.Sprite(constructorArgs);
    return applyProps(sprite, props);
}
function asText(constructorArgs, props) {
    const text = new pixi_js_1.default.Text(constructorArgs);
    return applyProps(text, props);
}
function asGraphics(props) {
    const graphics = new pixi_js_1.default.Graphics();
    return applyProps(graphics, props);
}
function asContainer(props) {
    const container = new pixi_js_1.default.Container();
    return applyProps(container, props);
}


/***/ }),

/***/ "./src/library/client-events.ts":
/*!**************************************!*\
  !*** ./src/library/client-events.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.ClientEvents = void 0;
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
class ClientEvents {
    wheelDelta;
    mouseUpEvent;
    mouseDownEvent;
    lastMouseDown;
    lastMouseUp;
    keyDownEvent;
    keyUpEvent;
    keydown;
    wheelOffsets;
    movePosition;
    lastMovePosition;
    moveDelta;
    static instance = null;
    static getInstance(options = {}) {
        if (!ClientEvents.instance) {
            ClientEvents.instance = new ClientEvents(options);
        }
        return ClientEvents.instance;
    }
    constructor({ initWheelOffset = new pixi_js_1.Point(), onAnyEvent = (ev) => { } } = {}) {
        if (ClientEvents.instance) {
            return ClientEvents.instance;
        }
        this.wheelOffsets = initWheelOffset;
        this.keydown = {};
        this.movePosition = new pixi_js_1.Point();
        const anyEvent = (ev) => {
            onAnyEvent(ev);
        };
        document.addEventListener('wheel', (event) => {
            const wheelDelta = this.wheelOffsets || new pixi_js_1.Point();
            const xValue = wheelDelta.x + event.deltaX;
            const yValue = wheelDelta.y + event.deltaY;
            this.wheelOffsets = new pixi_js_1.Point(xValue, yValue);
            anyEvent({ eventType: 'wheel', event });
        });
        document.addEventListener('mousemove', (event) => {
            this.lastMovePosition = this.movePosition;
            this.movePosition = new pixi_js_1.Point(event.clientX, event.clientY);
            this.moveDelta = new pixi_js_1.Point(this.movePosition.x - this.lastMovePosition.x, this.movePosition.y - this.lastMovePosition.y);
            anyEvent({ eventType: 'mousemove', event });
        });
        document.addEventListener('mousedown', (event) => {
            this.mouseDownEvent = event;
            this.lastMouseDown = event;
            this.mouseUpEvent = null;
            anyEvent({ eventType: 'mousedown', event });
        });
        document.addEventListener('mouseup', (event) => {
            this.mouseUpEvent = event;
            this.lastMouseUp = event;
            this.mouseDownEvent = null;
            anyEvent({ eventType: 'mouseup', event });
        });
        document.addEventListener('keydown', (event) => {
            const { key } = event;
            this.keyDownEvent = event;
            this.keyUpEvent = null;
            this.keydown[key] = event;
            anyEvent({ eventType: 'keydown', event });
        });
        document.addEventListener('keyup', (event) => {
            const { key } = event;
            this.keyUpEvent = event;
            this.keyDownEvent = null;
            delete this.keydown[key];
            anyEvent({ eventType: 'keyup', event });
        });
        ClientEvents.instance = this;
    }
    isKeyDown(key) {
        return Boolean(this.keydown[key]);
    }
    isKeyUp(key) {
        return !this.keydown[key];
    }
}
exports.ClientEvents = ClientEvents;


/***/ }),

/***/ "./src/library/falling-squares-animation.ts":
/*!**************************************************!*\
  !*** ./src/library/falling-squares-animation.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.FallingSquaresAnimation = void 0;
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
const DEFAULT_PALETTE = [0xf0dab1, 0xe39aac, 0xc45d9f, 0x634b7d, 0x6461c2, 0x2ba9b4, 0x93d4b5, 0xf0f6e8];
class FallingSquaresAnimation {
    particles = [];
    container = null;
    nextSpawn = 0;
    time = 0;
    squareSize;
    maxParticles;
    palette;
    spawnInterval;
    constructor(options = {}) {
        this.squareSize = options.squareSize ?? 20;
        this.maxParticles = options.maxParticles ?? 30;
        this.palette = options.palette ?? DEFAULT_PALETTE;
        this.spawnInterval = options.spawnInterval ?? 0.5;
    }
    init(container) {
        this.container = container;
    }
    update(context) {
        if (!this.container)
            return;
        this.time = context.time;
        const { width, height, textElement } = context;
        this.spawnParticle(width, height, textElement);
        this.particles = this.particles.filter(p => {
            const elapsed = this.time - p.spawnTime;
            const progress = elapsed / p.duration;
            if (progress < 0 || progress > 1) {
                p.sprite.destroy();
                return false;
            }
            p.sprite.x = p.startX;
            p.sprite.y = p.startY + (p.endY - p.startY) * progress;
            p.sprite.rotation = this.time * p.spinRate * Math.PI * 2;
            p.sprite.alpha = progress < 0.1 ? progress / 0.1 : progress > 0.85 ? (1 - progress) / 0.15 : 1;
            return true;
        });
    }
    spawnParticle(width, height, textElement) {
        if (!this.container)
            return;
        if (this.particles.length >= this.maxParticles || this.time < this.nextSpawn)
            return;
        const size = this.squareSize * (0.7 + Math.random() * 0.6);
        const sprite = new pixi_js_1.Graphics();
        sprite.rect(0, 0, size, size);
        sprite.fill({ color: this.palette[Math.floor(Math.random() * this.palette.length)] });
        sprite.pivot.set(size / 2, size / 2);
        this.container.addChild(sprite);
        const textY = textElement.y;
        const textWidth = textElement.width || 200;
        const textCenterX = width / 2;
        this.particles.push({
            sprite,
            spawnTime: this.time,
            duration: 1 + Math.random() * 2.5,
            spinRate: (0.05 + Math.random() * 1.075) * (Math.random() < 0.5 ? 1 : -1),
            startX: textCenterX - textWidth / 2 + Math.random() * textWidth - 4,
            startY: textY - 100,
            endY: textY - 40,
        });
        this.nextSpawn = this.time + Math.random() * this.spawnInterval;
    }
    reset() {
        this.time = 0;
        this.nextSpawn = 0;
        this.particles.forEach(p => p.sprite.destroy());
        this.particles = [];
    }
    destroy() {
        this.particles.forEach(p => p.sprite.destroy());
        this.particles = [];
        this.container = null;
    }
}
exports.FallingSquaresAnimation = FallingSquaresAnimation;


/***/ }),

/***/ "./src/library/font-loader.ts":
/*!************************************!*\
  !*** ./src/library/font-loader.ts ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.loadFonts = void 0;
const fontfaceobserver_1 = __importDefault(__webpack_require__(/*! fontfaceobserver */ "../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js"));
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
const loadFonts = async () => {
    const fontKenfutureThin = new fontfaceobserver_1.default('kenfuture-thin');
    return new Promise((resolve) => {
        fontKenfutureThin.load().then(() => {
            pixi_js_1.BitmapFont.install({
                name: 'kenfuture-thin',
                style: {
                    fontFamily: 'kenfuture-thin'
                }
            });
            resolve({ fontKenfutureThin });
        });
    });
};
exports.loadFonts = loadFonts;


/***/ }),

/***/ "./src/library/grid-generator.ts":
/*!***************************************!*\
  !*** ./src/library/grid-generator.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createTileGrid = createTileGrid;
exports.getTextureRange = getTextureRange;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function createTileGrid(options, textures, selector) {
    const { width, height, cellWidth, cellHeight, centered = false } = options;
    const defaultSelector = () => Math.floor(Math.random() * textures.length);
    const getTextureIndex = selector || defaultSelector;
    const container = new pixi_js_1.default.Container();
    const totalCells = width * height;
    for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
            const pixelX = x * cellWidth;
            const pixelY = y * cellHeight;
            const index = y * width + x;
            const position = {
                x, y, pixelX, pixelY, index, total: totalCells
            };
            const textureIndex = getTextureIndex(position);
            const cell = new pixi_js_1.default.Sprite(textures[textureIndex]);
            cell.position.set(pixelX, pixelY);
            container.addChild(cell);
        }
    }
    if (centered) {
        const gridWidth = width * cellWidth;
        const gridHeight = height * cellHeight;
        container.position.set(-gridWidth / 2, -gridHeight / 2);
    }
    return container;
}
function getTextureRange(textures, startIndex, count) {
    return textures.slice(startIndex, startIndex + count);
}


/***/ }),

/***/ "./src/library/loading-scene.ts":
/*!**************************************!*\
  !*** ./src/library/loading-scene.ts ***!
  \**************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.LoadingScene = exports.FallingSquaresAnimation = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const pixi_js_2 = __webpack_require__(/*! pixi.js */ "pixi.js");
const falling_squares_animation_1 = __webpack_require__(/*! ./falling-squares-animation */ "./src/library/falling-squares-animation.ts");
Object.defineProperty(exports, "FallingSquaresAnimation", ({ enumerable: true, get: function () { return falling_squares_animation_1.FallingSquaresAnimation; } }));
class LoadingScene extends pixi_js_2.Container {
    text;
    background;
    animationContainer;
    animation;
    ticker;
    renderer = null;
    time = 0;
    backgroundColor;
    constructor(options = {}) {
        super();
        const { backgroundColor = 0x1a1a1a, text = 'LOADING...', textStyle = {}, animation, fallingSquaresOptions } = options;
        this.backgroundColor = backgroundColor;
        this.animation = animation ?? new falling_squares_animation_1.FallingSquaresAnimation(fallingSquaresOptions);
        this.background = new pixi_js_2.Graphics();
        this.addChild(this.background);
        this.animationContainer = new pixi_js_2.Container();
        this.addChild(this.animationContainer);
        this.text = new pixi_js_2.Text({
            text,
            style: {
                fontFamily: 'Courier New, monospace',
                fontSize: 16,
                fill: 0xffffff,
                fontWeight: 'bold',
                ...textStyle
            }
        });
        this.text.anchor.set(0.5);
        this.addChild(this.text);
        this.animation.init(this.animationContainer);
        this.ticker = new pixi_js_1.default.Ticker();
        this.ticker.autoStart = false;
        this.ticker.add(() => {
            if (this.visible && this.renderer) {
                const deltaTime = this.ticker.deltaTime / 60;
                this.time += deltaTime;
                this.update(this.renderer.width, this.renderer.height, deltaTime);
                this.renderer.render(this);
            }
        });
    }
    update(width, height, deltaTime) {
        this.background.clear();
        this.background.rect(0, 0, width, height);
        this.background.fill({ color: this.backgroundColor });
        this.text.x = width / 2 - 4;
        this.text.y = height / 2 + 60;
        this.animation.update({
            time: this.time,
            deltaTime,
            width,
            height,
            textElement: this.text
        });
    }
    init(renderer) {
        this.renderer = renderer;
    }
    show() {
        this.visible = true;
        this.time = 0;
        this.animation.reset();
        if (!this.ticker.started) {
            this.ticker.start();
        }
    }
    hide() {
        this.visible = false;
        if (this.ticker.started) {
            this.ticker.stop();
        }
    }
    destroy() {
        if (this.ticker.started) {
            this.ticker.stop();
        }
        this.ticker.destroy();
        this.animation.destroy();
        super.destroy();
    }
}
exports.LoadingScene = LoadingScene;


/***/ }),

/***/ "./src/library/parallax-background.ts":
/*!********************************************!*\
  !*** ./src/library/parallax-background.ts ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.ParallaxBackgroundLogic = exports.ParallaxBackground = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const moxi_entity_1 = __webpack_require__(/*! ../core/moxi-entity */ "./src/core/moxi-entity.ts");
const logic_1 = __webpack_require__(/*! ../core/logic */ "./src/core/logic.ts");
const camera_1 = __webpack_require__(/*! ../core/camera */ "./src/core/camera.ts");
const parallax_layer_1 = __webpack_require__(/*! ./parallax-layer */ "./src/library/parallax-layer.ts");
class ParallaxBackground extends PIXI.Container {
    moxiEntity;
    camera = null;
    scrollOffset = new PIXI.Point(0, 0);
    scrollBaseScale = new PIXI.Point(1, 1);
    scrollIgnoreCameraZoom = false;
    autoscroll = new PIXI.Point(0, 0);
    constructor(options = {}) {
        super();
        this.camera = options.camera ?? null;
        this.scrollOffset = options.scrollOffset ?? new PIXI.Point(0, 0);
        this.scrollBaseScale = options.scrollBaseScale ?? new PIXI.Point(1, 1);
        this.scrollIgnoreCameraZoom = options.scrollIgnoreCameraZoom ?? false;
        this.autoscroll = options.autoscroll ?? new PIXI.Point(0, 0);
        const entity = (0, moxi_entity_1.asEntity)(this);
        entity.moxiEntity.addLogic(new ParallaxBackgroundLogic());
        this.moxiEntity = entity.moxiEntity;
    }
    addLayer(layer) {
        this.addChild(layer);
    }
    detectCamera() {
        let current = this.parent;
        while (current) {
            if (current instanceof camera_1.Camera) {
                return current;
            }
            current = current.parent;
        }
        return null;
    }
    getCameraPosition() {
        const camera = this.camera ?? this.detectCamera();
        if (!camera) {
            return new PIXI.Point(0, 0);
        }
        return new PIXI.Point(camera.position.x, camera.position.y);
    }
    getCameraScale() {
        if (this.scrollIgnoreCameraZoom) {
            return new PIXI.Point(1, 1);
        }
        const camera = this.camera ?? this.detectCamera();
        if (!camera) {
            return new PIXI.Point(1, 1);
        }
        return new PIXI.Point(camera.scale.x, camera.scale.y);
    }
}
exports.ParallaxBackground = ParallaxBackground;
class ParallaxBackgroundLogic extends logic_1.Logic {
    name = 'ParallaxBackgroundLogic';
    update(entity, deltaTime) {
        if (entity.autoscroll.x !== 0 || entity.autoscroll.y !== 0) {
            entity.scrollOffset.x += entity.autoscroll.x * deltaTime;
            entity.scrollOffset.y += entity.autoscroll.y * deltaTime;
        }
        const cameraPos = entity.getCameraPosition();
        const cameraScale = entity.getCameraScale();
        const scene = entity.parent;
        if (scene) {
            entity.position.x = cameraPos.x / scene.scale.x;
            entity.position.y = cameraPos.y / scene.scale.y;
            entity.scale.x = 1 / scene.scale.x;
            entity.scale.y = 1 / scene.scale.y;
        }
        else {
            entity.position.x = cameraPos.x;
            entity.position.y = cameraPos.y;
            entity.scale.set(1, 1);
        }
        entity.children.forEach((child) => {
            if (child instanceof parallax_layer_1.ParallaxLayer) {
                child.updateParallax(cameraPos, cameraScale, entity.scrollOffset);
            }
        });
    }
}
exports.ParallaxBackgroundLogic = ParallaxBackgroundLogic;


/***/ }),

/***/ "./src/library/parallax-layer.ts":
/*!***************************************!*\
  !*** ./src/library/parallax-layer.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.TilingParallaxLayer = exports.ParallaxLayer = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const moxi_entity_1 = __webpack_require__(/*! ../core/moxi-entity */ "./src/core/moxi-entity.ts");
class ParallaxLayer extends PIXI.Container {
    moxiEntity;
    scrollScale = new PIXI.Point(1, 1);
    scrollOffset = new PIXI.Point(0, 0);
    repeatSize = new PIXI.Point(0, 0);
    mirroring = false;
    _lastCameraPos = new PIXI.Point(0, 0);
    constructor(options = {}) {
        super();
        this.scrollScale = options.scrollScale ?? new PIXI.Point(1, 1);
        this.scrollOffset = options.scrollOffset ?? new PIXI.Point(0, 0);
        this.repeatSize = options.repeatSize ?? new PIXI.Point(0, 0);
        this.mirroring = options.mirroring ?? false;
        const entity = (0, moxi_entity_1.asEntity)(this);
        this.moxiEntity = entity.moxiEntity;
    }
    updateParallax(cameraPos, cameraScale, backgroundOffset) {
        const scrollX = (cameraPos.x + backgroundOffset.x) * this.scrollScale.x;
        const scrollY = (cameraPos.y + backgroundOffset.y) * this.scrollScale.y;
        this.position.x = -scrollX + this.scrollOffset.x;
        this.position.y = -scrollY + this.scrollOffset.y;
        if (this.mirroring) {
            if (this.repeatSize.x > 0) {
                this.position.x = this.position.x % this.repeatSize.x;
                if (this.position.x > 0)
                    this.position.x -= this.repeatSize.x;
            }
            if (this.repeatSize.y > 0) {
                this.position.y = this.position.y % this.repeatSize.y;
                if (this.position.y > 0)
                    this.position.y -= this.repeatSize.y;
            }
        }
        this._lastCameraPos.copyFrom(cameraPos);
    }
}
exports.ParallaxLayer = ParallaxLayer;
class TilingParallaxLayer extends ParallaxLayer {
    tilingSprite;
    _autoSized = false;
    constructor(options) {
        super(options);
        options.texture.source.style.addressMode = 'repeat';
        const width = options.width ?? 1;
        const height = options.height ?? 1;
        this.tilingSprite = new PIXI.TilingSprite({
            texture: options.texture,
            width: width,
            height: height,
        });
        this.tilingSprite.position.set(0, 0);
        this.addChild(this.tilingSprite);
        this._autoSized = !options.width && !options.height;
    }
    autoDetectDimensions() {
        if (!this._autoSized)
            return;
        let current = this.parent;
        while (current) {
            if (current.renderer) {
                this.resize(current.renderer.width, current.renderer.height);
                this._autoSized = false;
                return;
            }
            current = current.parent;
        }
    }
    updateParallax(cameraPos, cameraScale, backgroundOffset) {
        this.autoDetectDimensions();
        const renderer = this.parent?.parent;
        if (renderer?.renderer) {
            const baseWidth = renderer.renderer.width;
            const baseHeight = renderer.renderer.height;
            this.tilingSprite.width = baseWidth;
            this.tilingSprite.height = baseHeight;
            this.tilingSprite.pivot.set(0, 0);
            this.tilingSprite.position.set(0, 0);
        }
        const scrollX = (cameraPos.x + backgroundOffset.x) * this.scrollScale.x;
        const scrollY = (cameraPos.y + backgroundOffset.y) * this.scrollScale.y;
        this.tilingSprite.tilePosition.x = -scrollX + this.scrollOffset.x;
        this.tilingSprite.tilePosition.y = -scrollY + this.scrollOffset.y;
        this.position.set(0, 0);
    }
    resize(width, height) {
        this.tilingSprite.width = width;
        this.tilingSprite.height = height;
    }
}
exports.TilingParallaxLayer = TilingParallaxLayer;


/***/ }),

/***/ "./src/library/physics/index.ts":
/*!**************************************!*\
  !*** ./src/library/physics/index.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.applyMaterial = exports.PhysicsMaterials = exports.createShapeFromSprite = exports.getPhysicsBody = exports.hasPhysics = exports.asPhysicsEntity = exports.PhysicsDebugRenderer = exports.CollisionManager = exports.CollisionRegistry = exports.PhysicsBodyLogic = exports.PhysicsWorld = void 0;
var physics_world_1 = __webpack_require__(/*! ./physics-world */ "./src/library/physics/physics-world.ts");
Object.defineProperty(exports, "PhysicsWorld", ({ enumerable: true, get: function () { return physics_world_1.PhysicsWorld; } }));
var physics_body_logic_1 = __webpack_require__(/*! ./physics-body-logic */ "./src/library/physics/physics-body-logic.ts");
Object.defineProperty(exports, "PhysicsBodyLogic", ({ enumerable: true, get: function () { return physics_body_logic_1.PhysicsBodyLogic; } }));
var physics_collision_1 = __webpack_require__(/*! ./physics-collision */ "./src/library/physics/physics-collision.ts");
Object.defineProperty(exports, "CollisionRegistry", ({ enumerable: true, get: function () { return physics_collision_1.CollisionRegistry; } }));
Object.defineProperty(exports, "CollisionManager", ({ enumerable: true, get: function () { return physics_collision_1.CollisionManager; } }));
var physics_debug_renderer_1 = __webpack_require__(/*! ./physics-debug-renderer */ "./src/library/physics/physics-debug-renderer.ts");
Object.defineProperty(exports, "PhysicsDebugRenderer", ({ enumerable: true, get: function () { return physics_debug_renderer_1.PhysicsDebugRenderer; } }));
var physics_utils_1 = __webpack_require__(/*! ./physics-utils */ "./src/library/physics/physics-utils.ts");
Object.defineProperty(exports, "asPhysicsEntity", ({ enumerable: true, get: function () { return physics_utils_1.asPhysicsEntity; } }));
Object.defineProperty(exports, "hasPhysics", ({ enumerable: true, get: function () { return physics_utils_1.hasPhysics; } }));
Object.defineProperty(exports, "getPhysicsBody", ({ enumerable: true, get: function () { return physics_utils_1.getPhysicsBody; } }));
Object.defineProperty(exports, "createShapeFromSprite", ({ enumerable: true, get: function () { return physics_utils_1.createShapeFromSprite; } }));
var physics_materials_1 = __webpack_require__(/*! ./physics-materials */ "./src/library/physics/physics-materials.ts");
Object.defineProperty(exports, "PhysicsMaterials", ({ enumerable: true, get: function () { return physics_materials_1.PhysicsMaterials; } }));
Object.defineProperty(exports, "applyMaterial", ({ enumerable: true, get: function () { return physics_materials_1.applyMaterial; } }));


/***/ }),

/***/ "./src/library/physics/physics-body-logic.ts":
/*!***************************************************!*\
  !*** ./src/library/physics/physics-body-logic.ts ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsBodyLogic = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const logic_1 = __webpack_require__(/*! ../../core/logic */ "./src/core/logic.ts");
const physics_graphics_parser_1 = __webpack_require__(/*! ./physics-graphics-parser */ "./src/library/physics/physics-graphics-parser.ts");
class PhysicsBodyLogic extends logic_1.Logic {
    name = 'PhysicsBodyLogic';
    body;
    world;
    options;
    onCollisionBegin;
    onCollisionEnd;
    constructor(world, options = {}) {
        super();
        this.world = world;
        this.options = {
            type: 'dynamic',
            syncMode: 'physics-driven',
            syncPosition: true,
            syncRotation: true,
            density: 1.0,
            friction: 0.3,
            restitution: 0.0,
            fixedRotation: false,
            isSensor: false,
            bullet: false,
            ...options
        };
    }
    init(entity, renderer) {
        this.createPhysicsBody(entity);
        this.body.setUserData(this);
        this.world.registerBody(this.body, this);
    }
    update(entity, deltaTime) {
        if (!this.body)
            return;
        switch (this.options.syncMode) {
            case 'physics-driven':
                this.syncFromPhysics(entity);
                break;
            case 'sprite-driven':
                this.syncToPhysics(entity);
                break;
            case 'manual':
                break;
        }
    }
    destroy() {
        if (this.body) {
            this.world.destroyBody(this.body);
        }
    }
    syncFromPhysics(entity) {
        if (!this.body)
            return;
        const pos = this.body.getPosition();
        if (this.options.syncPosition) {
            entity.x = this.world.toPixels(pos.x);
            entity.y = this.world.toPixels(pos.y);
        }
        if (this.options.syncRotation) {
            entity.rotation = this.body.getAngle();
        }
    }
    syncToPhysics(entity) {
        if (!this.body)
            return;
        if (this.options.syncPosition) {
            const x = this.world.toPhysics(entity.x);
            const y = this.world.toPhysics(entity.y);
            this.body.setPosition(planck.Vec2(x, y));
        }
        if (this.options.syncRotation) {
            this.body.setAngle(entity.rotation);
        }
    }
    createPhysicsBody(entity) {
        let bodyType;
        switch (this.options.type) {
            case 'static':
                bodyType = 'static';
                break;
            case 'kinematic':
                bodyType = 'kinematic';
                break;
            case 'dynamic':
            default:
                bodyType = 'dynamic';
                break;
        }
        const bodyDef = {
            type: bodyType,
            position: this.options.position
                ? this.world.toPhysicsPoint(this.options.position)
                : planck.Vec2(this.world.toPhysics(entity.x), this.world.toPhysics(entity.y)),
            angle: this.options.rotation ?? entity.rotation,
            linearVelocity: this.options.linearVelocity
                ? this.world.toPhysicsPoint(this.options.linearVelocity)
                : planck.Vec2(0, 0),
            angularVelocity: this.options.angularVelocity ?? 0,
            fixedRotation: this.options.fixedRotation ?? false,
            bullet: this.options.bullet ?? false
        };
        this.body = this.world.createBody(bodyDef);
        this.createFixture(entity);
        if (this.options.linearVelocity) {
            this.setVelocity(this.options.linearVelocity);
        }
        if (this.options.angularVelocity) {
            this.setAngularVelocity(this.options.angularVelocity);
        }
    }
    createFixture(entity) {
        const shape = this.createShape(entity);
        const categoryBits = this.options.collisionTags
            ? this.world.collisionRegistry.tagsToBits(this.options.collisionTags)
            : this.world.collisionRegistry.getBit('default');
        const maskBits = this.options.collidesWith
            ? this.world.collisionRegistry.tagsToBits(this.options.collidesWith)
            : 0xFFFF;
        const groupIndex = this.options.collisionGroup ?? 0;
        this.body.createFixture({
            shape: shape,
            density: this.options.density ?? 1.0,
            friction: this.options.friction ?? 0.3,
            restitution: this.options.restitution ?? 0.0,
            isSensor: this.options.isSensor ?? false,
            filterCategoryBits: categoryBits,
            filterMaskBits: maskBits,
            filterGroupIndex: groupIndex
        });
    }
    createShape(entity) {
        if (this.options.collisionShape) {
            const parsed = (0, physics_graphics_parser_1.parseGraphicsShape)(this.options.collisionShape, this.world);
            return parsed.shape;
        }
        if (entity instanceof PIXI.Graphics) {
            const parsed = (0, physics_graphics_parser_1.parseGraphicsShape)(entity, this.world);
            return parsed.shape;
        }
        if (this.options.shape) {
            return this.createShapeFromType(this.options.shape);
        }
        throw new Error('Collision shape required for non-Graphics entities. ' +
            'Either provide a Graphics entity, or specify options.collisionShape, ' +
            'or use legacy options.shape with dimensions.');
    }
    createShapeFromType(shapeType) {
        switch (shapeType) {
            case 'circle':
                const radius = this.options.radius ?? 25;
                return planck.Circle(this.world.toPhysics(radius));
            case 'rectangle':
                const width = this.options.width ?? 50;
                const height = this.options.height ?? 50;
                return planck.Box(this.world.toPhysics(width / 2), this.world.toPhysics(height / 2));
            case 'polygon':
                if (!this.options.vertices || this.options.vertices.length < 3) {
                    throw new Error('Polygon shape requires at least 3 vertices');
                }
                const vertices = this.options.vertices.map(v => planck.Vec2(this.world.toPhysics(v.x), this.world.toPhysics(v.y)));
                return planck.Polygon(vertices);
            default:
                throw new Error(`Unknown shape type: ${shapeType}`);
        }
    }
    autoDetectShape(entity) {
        const bounds = entity.getLocalBounds();
        return planck.Box(this.world.toPhysics(bounds.width / 2), this.world.toPhysics(bounds.height / 2));
    }
    applyForce(force, point) {
        const forceVec = this.world.toPhysicsPoint(force);
        const pointVec = point
            ? this.world.toPhysicsPoint(point)
            : this.body.getWorldCenter();
        this.body.applyForce(forceVec, pointVec);
    }
    applyImpulse(impulse, point) {
        const impulseVec = this.world.toPhysicsPoint(impulse);
        const pointVec = point
            ? this.world.toPhysicsPoint(point)
            : this.body.getWorldCenter();
        this.body.applyLinearImpulse(impulseVec, pointVec);
    }
    applyTorque(torque) {
        this.body.applyTorque(torque);
    }
    setVelocity(velocity) {
        const velocityVec = this.world.toPhysicsPoint(velocity);
        this.body.setLinearVelocity(velocityVec);
    }
    setAngularVelocity(omega) {
        this.body.setAngularVelocity(omega);
    }
    getVelocity() {
        const vel = this.body.getLinearVelocity();
        return this.world.toPixelsPoint(vel);
    }
    getAngularVelocity() {
        return this.body.getAngularVelocity();
    }
    getMass() {
        return this.body.getMass();
    }
    isAwake() {
        return this.body.isAwake();
    }
    isSleeping() {
        return !this.body.isAwake();
    }
    setAwake(awake) {
        this.body.setAwake(awake);
    }
}
exports.PhysicsBodyLogic = PhysicsBodyLogic;


/***/ }),

/***/ "./src/library/physics/physics-collision.ts":
/*!**************************************************!*\
  !*** ./src/library/physics/physics-collision.ts ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.CollisionManager = exports.CollisionRegistry = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
class CollisionRegistry {
    tagToBit = new Map();
    bitToTag = new Map();
    nextBit = 1;
    constructor() {
        this.register('default');
    }
    register(tag) {
        if (this.tagToBit.has(tag))
            return;
        if (this.nextBit > 0x8000) {
            throw new Error('Maximum collision tags reached (16 tags)');
        }
        this.tagToBit.set(tag, this.nextBit);
        this.bitToTag.set(this.nextBit, tag);
        this.nextBit <<= 1;
    }
    getBit(tag) {
        if (!this.tagToBit.has(tag)) {
            this.register(tag);
        }
        return this.tagToBit.get(tag);
    }
    getTag(bit) {
        return this.bitToTag.get(bit);
    }
    tagsToBits(tags) {
        if (!tags || tags.length === 0) {
            return this.getBit('default');
        }
        return tags.reduce((bits, tag) => bits | this.getBit(tag), 0);
    }
    bitsToTags(bits) {
        const tags = [];
        for (const [bit, tag] of this.bitToTag) {
            if (bits & bit) {
                tags.push(tag);
            }
        }
        return tags;
    }
}
exports.CollisionRegistry = CollisionRegistry;
function isPhysicsBodyUserData(obj) {
    return (obj !== null &&
        typeof obj === 'object' &&
        'options' in obj &&
        typeof obj.options === 'object');
}
class CollisionManager {
    world;
    registry;
    callbacks = new Map();
    constructor(world, registry) {
        this.world = world;
        this.registry = registry;
        this.setupListeners();
    }
    setupListeners() {
        this.world.world.on('begin-contact', (contact) => {
            this.handleBeginContact(contact);
        });
        this.world.world.on('end-contact', (contact) => {
            this.handleEndContact(contact);
        });
    }
    onCollision(tagA, tagB, callback) {
        const key = this.makeKey(tagA, tagB);
        if (!this.callbacks.has(key)) {
            this.callbacks.set(key, new Set());
        }
        this.callbacks.get(key).add(callback);
    }
    offCollision(tagA, tagB, callback) {
        const key = this.makeKey(tagA, tagB);
        this.callbacks.get(key)?.delete(callback);
    }
    makeKey(tagA, tagB) {
        return tagA < tagB ? `${tagA}:${tagB}` : `${tagB}:${tagA}`;
    }
    handleBeginContact(contact) {
        const bodyA = contact.getFixtureA().getBody().getUserData();
        const bodyB = contact.getFixtureB().getBody().getUserData();
        if (!isPhysicsBodyUserData(bodyA) || !isPhysicsBodyUserData(bodyB))
            return;
        bodyA.onCollisionBegin?.(bodyB, contact);
        bodyB.onCollisionBegin?.(bodyA, contact);
        this.triggerTagCallbacks(bodyA, bodyB, contact);
    }
    handleEndContact(contact) {
        const bodyA = contact.getFixtureA().getBody().getUserData();
        const bodyB = contact.getFixtureB().getBody().getUserData();
        if (!isPhysicsBodyUserData(bodyA) || !isPhysicsBodyUserData(bodyB))
            return;
        bodyA.onCollisionEnd?.(bodyB, contact);
        bodyB.onCollisionEnd?.(bodyA, contact);
    }
    triggerTagCallbacks(bodyA, bodyB, contact) {
        const tagsA = bodyA.options.collisionTags || [];
        const tagsB = bodyB.options.collisionTags || [];
        for (const tagA of tagsA) {
            for (const tagB of tagsB) {
                const key = this.makeKey(tagA, tagB);
                const callbacks = this.callbacks.get(key);
                if (callbacks) {
                    const event = {
                        bodyA,
                        bodyB,
                        contact,
                        normal: new PIXI.Point(0, 0),
                        impulse: 0
                    };
                    callbacks.forEach(cb => cb(event));
                }
            }
        }
    }
}
exports.CollisionManager = CollisionManager;


/***/ }),

/***/ "./src/library/physics/physics-debug-renderer.ts":
/*!*******************************************************!*\
  !*** ./src/library/physics/physics-debug-renderer.ts ***!
  \*******************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsDebugRenderer = void 0;
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const logic_1 = __webpack_require__(/*! ../../core/logic */ "./src/core/logic.ts");
class PhysicsDebugRenderer extends logic_1.Logic {
    name = 'PhysicsDebugRenderer';
    world;
    graphics;
    options;
    isVisible = true;
    constructor(world, options = {}) {
        super();
        this.world = world;
        this.options = {
            showShapes: options.showShapes ?? true,
            showVelocities: options.showVelocities ?? false,
            showAABBs: options.showAABBs ?? false,
            showCenterOfMass: options.showCenterOfMass ?? false,
            showContactPoints: options.showContactPoints ?? false,
            showJoints: options.showJoints ?? false,
            colorStatic: options.colorStatic ?? 0x00FF00,
            colorDynamic: options.colorDynamic ?? 0xFF0000,
            colorKinematic: options.colorKinematic ?? 0x0000FF,
            colorSleeping: options.colorSleeping ?? 0xAAAAAA,
            colorSensor: options.colorSensor ?? 0xFFFF00,
            alpha: options.alpha ?? 0.5,
            lineWidth: options.lineWidth ?? 2
        };
    }
    init(entity, renderer) {
        this.graphics = entity;
    }
    update(entity, deltaTime) {
        if (!this.isVisible) {
            this.graphics.clear();
            return;
        }
        this.graphics.clear();
        if (this.options.showShapes) {
            for (let body = this.world.world.getBodyList(); body; body = body.getNext()) {
                this.drawBody(body);
            }
        }
        if (this.options.showContactPoints) {
            this.drawContacts();
        }
    }
    drawBody(body) {
        const transform = body.getTransform();
        let color;
        if (!body.isAwake() && body.isDynamic()) {
            color = this.options.colorSleeping;
        }
        else if (body.isStatic()) {
            color = this.options.colorStatic;
        }
        else if (body.isKinematic()) {
            color = this.options.colorKinematic;
        }
        else {
            color = this.options.colorDynamic;
        }
        for (let fixture = body.getFixtureList(); fixture; fixture = fixture.getNext()) {
            const shape = fixture.getShape();
            const fixtureColor = fixture.isSensor() ? this.options.colorSensor : color;
            const alpha = fixture.isSensor() ? this.options.alpha * 0.5 : this.options.alpha;
            this.drawShape(shape, transform, fixtureColor, alpha);
        }
        if (this.options.showVelocities && body.isDynamic()) {
            this.drawVelocity(body);
        }
        if (this.options.showAABBs) {
            this.drawAABB(body);
        }
        if (this.options.showCenterOfMass) {
            this.drawCenterOfMass(body);
        }
    }
    drawShape(shape, transform, color, alpha) {
        this.graphics.stroke({
            width: this.options.lineWidth,
            color: color,
            alpha: alpha
        });
        const shapeType = shape.getType();
        if (shapeType === 'circle') {
            const circle = shape;
            const center = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, circle.getCenter()));
            const radius = circle.getRadius();
            const pixelCenter = this.world.toPixelsPoint(center);
            const pixelRadius = this.world.toPixels(radius);
            this.graphics.circle(pixelCenter.x, pixelCenter.y, pixelRadius);
            this.graphics.stroke();
            const angle = transform.q.getAngle();
            const endX = pixelCenter.x + Math.cos(angle) * pixelRadius;
            const endY = pixelCenter.y + Math.sin(angle) * pixelRadius;
            this.graphics.moveTo(pixelCenter.x, pixelCenter.y);
            this.graphics.lineTo(endX, endY);
            this.graphics.stroke();
        }
        else if (shapeType === 'polygon') {
            const poly = shape;
            const vertices = poly.m_vertices;
            if (vertices && vertices.length > 0) {
                const firstVertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[0]));
                const pixelFirst = this.world.toPixelsPoint(firstVertex);
                this.graphics.moveTo(pixelFirst.x, pixelFirst.y);
                for (let i = 1; i < vertices.length; i++) {
                    const vertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[i]));
                    const pixelVertex = this.world.toPixelsPoint(vertex);
                    this.graphics.lineTo(pixelVertex.x, pixelVertex.y);
                }
                this.graphics.lineTo(pixelFirst.x, pixelFirst.y);
                this.graphics.stroke();
            }
        }
        else if (shapeType === 'edge') {
            const edge = shape;
            const v1 = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, edge.m_vertex1));
            const v2 = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, edge.m_vertex2));
            const p1 = this.world.toPixelsPoint(v1);
            const p2 = this.world.toPixelsPoint(v2);
            this.graphics.moveTo(p1.x, p1.y);
            this.graphics.lineTo(p2.x, p2.y);
            this.graphics.stroke();
        }
        else if (shapeType === 'chain') {
            const chain = shape;
            const vertices = chain.m_vertices;
            if (vertices && vertices.length > 0) {
                const firstVertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[0]));
                const pixelFirst = this.world.toPixelsPoint(firstVertex);
                this.graphics.moveTo(pixelFirst.x, pixelFirst.y);
                for (let i = 1; i < vertices.length; i++) {
                    const vertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[i]));
                    const pixelVertex = this.world.toPixelsPoint(vertex);
                    this.graphics.lineTo(pixelVertex.x, pixelVertex.y);
                }
                this.graphics.stroke();
            }
        }
    }
    drawVelocity(body) {
        const position = body.getPosition();
        const velocity = body.getLinearVelocity();
        const scale = 0.5;
        const endPoint = planck.Vec2.add(position, planck.Vec2.mul(velocity, scale));
        const pixelStart = this.world.toPixelsPoint(position);
        const pixelEnd = this.world.toPixelsPoint(endPoint);
        this.graphics.stroke({
            width: 2,
            color: 0x00FFFF,
            alpha: 0.8
        });
        this.graphics.moveTo(pixelStart.x, pixelStart.y);
        this.graphics.lineTo(pixelEnd.x, pixelEnd.y);
        this.graphics.stroke();
        const angle = Math.atan2(pixelEnd.y - pixelStart.y, pixelEnd.x - pixelStart.x);
        const arrowSize = 5;
        const angle1 = angle + Math.PI * 0.8;
        const angle2 = angle - Math.PI * 0.8;
        this.graphics.moveTo(pixelEnd.x, pixelEnd.y);
        this.graphics.lineTo(pixelEnd.x + Math.cos(angle1) * arrowSize, pixelEnd.y + Math.sin(angle1) * arrowSize);
        this.graphics.moveTo(pixelEnd.x, pixelEnd.y);
        this.graphics.lineTo(pixelEnd.x + Math.cos(angle2) * arrowSize, pixelEnd.y + Math.sin(angle2) * arrowSize);
        this.graphics.stroke();
    }
    drawAABB(body) {
        for (let fixture = body.getFixtureList(); fixture; fixture = fixture.getNext()) {
            const aabb = fixture.getAABB(0);
            const lowerBound = this.world.toPixelsPoint(aabb.lowerBound);
            const upperBound = this.world.toPixelsPoint(aabb.upperBound);
            this.graphics.stroke({
                width: 1,
                color: 0xFF00FF,
                alpha: 0.3
            });
            this.graphics.rect(lowerBound.x, lowerBound.y, upperBound.x - lowerBound.x, upperBound.y - lowerBound.y);
            this.graphics.stroke();
        }
    }
    drawCenterOfMass(body) {
        const position = body.getWorldCenter();
        const pixelPos = this.world.toPixelsPoint(position);
        this.graphics.stroke({
            width: 1,
            color: 0xFFFFFF,
            alpha: 1
        });
        const size = 5;
        this.graphics.moveTo(pixelPos.x - size, pixelPos.y);
        this.graphics.lineTo(pixelPos.x + size, pixelPos.y);
        this.graphics.moveTo(pixelPos.x, pixelPos.y - size);
        this.graphics.lineTo(pixelPos.x, pixelPos.y + size);
        this.graphics.stroke();
    }
    drawContacts() {
        for (let contact = this.world.world.getContactList(); contact; contact = contact.getNext()) {
            if (!contact.isTouching())
                continue;
            const manifold = contact.getManifold();
            if (!manifold)
                continue;
            const worldManifold = contact.getWorldManifold(null);
            if (!worldManifold)
                continue;
            for (let i = 0; i < manifold.pointCount; i++) {
                const point = worldManifold.points[i];
                if (!point)
                    continue;
                const pixelPoint = this.world.toPixelsPoint(planck.Vec2(point.x, point.y));
                this.graphics.circle(pixelPoint.x, pixelPoint.y, 3);
                this.graphics.fill({ color: 0xFF0000, alpha: 0.8 });
            }
        }
    }
    setVisible(visible) {
        this.isVisible = visible;
        if (!visible) {
            this.graphics.clear();
        }
    }
    toggle() {
        this.setVisible(!this.isVisible);
    }
    getVisible() {
        return this.isVisible;
    }
}
exports.PhysicsDebugRenderer = PhysicsDebugRenderer;


/***/ }),

/***/ "./src/library/physics/physics-graphics-parser.ts":
/*!********************************************************!*\
  !*** ./src/library/physics/physics-graphics-parser.ts ***!
  \********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.setGraphicsPhysicsShape = setGraphicsPhysicsShape;
exports.initGraphicsPhysicsTracking = initGraphicsPhysicsTracking;
exports.parseGraphicsShape = parseGraphicsShape;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const PHYSICS_SHAPE_KEY = '__physicsShape__';
function setGraphicsPhysicsShape(graphics, metadata) {
    graphics[PHYSICS_SHAPE_KEY] = metadata;
}
function initGraphicsPhysicsTracking() {
    const originalRect = PIXI.Graphics.prototype.rect;
    const originalCircle = PIXI.Graphics.prototype.circle;
    const originalPoly = PIXI.Graphics.prototype.poly;
    PIXI.Graphics.prototype.rect = function (x, y, w, h) {
        setGraphicsPhysicsShape(this, {
            type: 'rectangle',
            width: w,
            height: h
        });
        return originalRect.call(this, x, y, w, h);
    };
    PIXI.Graphics.prototype.circle = function (x, y, radius) {
        setGraphicsPhysicsShape(this, {
            type: 'circle',
            radius: radius
        });
        return originalCircle.call(this, x, y, radius);
    };
    PIXI.Graphics.prototype.poly = function (points) {
        const flatPoints = Array.isArray(points[0]) ? points.flat() : points;
        setGraphicsPhysicsShape(this, {
            type: 'polygon',
            vertices: flatPoints
        });
        return originalPoly.call(this, points);
    };
}
function parseGraphicsShape(graphics, world) {
    const metadata = graphics[PHYSICS_SHAPE_KEY];
    if (metadata) {
        switch (metadata.type) {
            case 'circle':
                if (!metadata.radius) {
                    throw new Error('Circle metadata missing radius');
                }
                return {
                    type: 'circle',
                    shape: planck.Circle(world.toPhysics(metadata.radius))
                };
            case 'rectangle':
                if (!metadata.width || !metadata.height) {
                    throw new Error('Rectangle metadata missing width/height');
                }
                return {
                    type: 'rectangle',
                    shape: planck.Box(world.toPhysics(metadata.width / 2), world.toPhysics(metadata.height / 2))
                };
            case 'polygon':
                if (!metadata.vertices || metadata.vertices.length < 6) {
                    throw new Error('Polygon metadata missing vertices (need at least 3 points = 6 values)');
                }
                const vertices = [];
                for (let i = 0; i < metadata.vertices.length; i += 2) {
                    vertices.push(planck.Vec2(world.toPhysics(metadata.vertices[i]), world.toPhysics(metadata.vertices[i + 1])));
                }
                return {
                    type: 'polygon',
                    shape: planck.Polygon(vertices)
                };
        }
    }
    const bounds = graphics.getLocalBounds();
    if (bounds.width === 0 || bounds.height === 0) {
        throw new Error('Graphics has no dimensions. Either draw shapes using rect(), circle(), or poly(), ' +
            'or provide an explicit collisionShape option.');
    }
    return {
        type: 'rectangle',
        shape: planck.Box(world.toPhysics(bounds.width / 2), world.toPhysics(bounds.height / 2))
    };
}


/***/ }),

/***/ "./src/library/physics/physics-materials.ts":
/*!**************************************************!*\
  !*** ./src/library/physics/physics-materials.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsMaterials = void 0;
exports.applyMaterial = applyMaterial;
exports.PhysicsMaterials = {
    bouncy: {
        density: 0.5,
        friction: 0.1,
        restitution: 0.9
    },
    wood: {
        density: 0.7,
        friction: 0.4,
        restitution: 0.2
    },
    metal: {
        density: 1.5,
        friction: 0.3,
        restitution: 0.1
    },
    ice: {
        density: 0.9,
        friction: 0.02,
        restitution: 0.05
    },
    rubber: {
        density: 1.0,
        friction: 0.9,
        restitution: 0.7
    },
    character: {
        density: 1.0,
        friction: 0.5,
        restitution: 0.0,
        fixedRotation: true
    },
    terrain: {
        density: 0,
        friction: 0.6,
        restitution: 0.0
    }
};
function applyMaterial(options, material) {
    return {
        ...options,
        ...exports.PhysicsMaterials[material]
    };
}


/***/ }),

/***/ "./src/library/physics/physics-utils.ts":
/*!**********************************************!*\
  !*** ./src/library/physics/physics-utils.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asPhysicsEntity = asPhysicsEntity;
exports.hasPhysics = hasPhysics;
exports.getPhysicsBody = getPhysicsBody;
exports.createShapeFromSprite = createShapeFromSprite;
const moxi_entity_1 = __webpack_require__(/*! ../../core/moxi-entity */ "./src/core/moxi-entity.ts");
const physics_body_logic_1 = __webpack_require__(/*! ./physics-body-logic */ "./src/library/physics/physics-body-logic.ts");
function asPhysicsEntity(pixiObject, world, options = {}) {
    const entity = (0, moxi_entity_1.asEntity)(pixiObject);
    const physicsLogic = new physics_body_logic_1.PhysicsBodyLogic(world, options);
    entity.moxiEntity.addLogic(physicsLogic);
    return entity;
}
function hasPhysics(entity) {
    if (!entity.moxiEntity)
        return false;
    return entity.moxiEntity.getLogic('PhysicsBodyLogic') !== undefined;
}
function getPhysicsBody(entity) {
    if (!entity.moxiEntity)
        return undefined;
    return entity.moxiEntity.getLogic('PhysicsBodyLogic');
}
function createShapeFromSprite(sprite, type = 'auto') {
    const bounds = sprite.getLocalBounds();
    if (type === 'auto') {
        const ratio = bounds.width / bounds.height;
        type = (ratio > 0.8 && ratio < 1.2) ? 'circle' : 'rectangle';
    }
    if (type === 'circle') {
        return {
            shape: 'circle',
            radius: Math.max(bounds.width, bounds.height) / 2
        };
    }
    else {
        return {
            shape: 'rectangle',
            width: bounds.width,
            height: bounds.height
        };
    }
}


/***/ }),

/***/ "./src/library/physics/physics-world.ts":
/*!**********************************************!*\
  !*** ./src/library/physics/physics-world.ts ***!
  \**********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsWorld = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const physics_collision_1 = __webpack_require__(/*! ./physics-collision */ "./src/library/physics/physics-collision.ts");
const physics_debug_renderer_1 = __webpack_require__(/*! ./physics-debug-renderer */ "./src/library/physics/physics-debug-renderer.ts");
const moxi_entity_1 = __webpack_require__(/*! ../../core/moxi-entity */ "./src/core/moxi-entity.ts");
const physics_graphics_parser_1 = __webpack_require__(/*! ./physics-graphics-parser */ "./src/library/physics/physics-graphics-parser.ts");
class PhysicsWorld {
    world;
    pixelsPerMeter = 30;
    timestep = 1 / 60;
    collisionRegistry;
    collisionManager;
    velocityIterations = 8;
    positionIterations = 3;
    accumulator = 0;
    bodies = new Map();
    debugRenderer;
    debugGraphics;
    constructor(options = {}) {
        (0, physics_graphics_parser_1.initGraphicsPhysicsTracking)();
        const { gravity = { x: 0, y: 9.8 }, pixelsPerMeter = 30, velocityIterations = 8, positionIterations = 3, enableSleeping = true, timestep = 1 / 60 } = options;
        this.pixelsPerMeter = pixelsPerMeter;
        this.velocityIterations = velocityIterations;
        this.positionIterations = positionIterations;
        this.timestep = timestep;
        this.world = planck.World({
            gravity: planck.Vec2(gravity.x, gravity.y)
        });
        this.world.setAllowSleeping(enableSleeping);
        this.collisionRegistry = new physics_collision_1.CollisionRegistry();
        this.collisionManager = new physics_collision_1.CollisionManager(this, this.collisionRegistry);
    }
    step(deltaTime) {
        this.accumulator += deltaTime;
        while (this.accumulator >= this.timestep) {
            this.world.step(this.timestep, this.velocityIterations, this.positionIterations);
            this.accumulator -= this.timestep;
        }
    }
    createBody(def) {
        return this.world.createBody(def);
    }
    destroyBody(body) {
        this.bodies.delete(body);
        this.world.destroyBody(body);
    }
    registerBody(body, logic) {
        this.bodies.set(body, logic);
    }
    getBodyLogic(body) {
        return this.bodies.get(body);
    }
    raycast(from, to, callback) {
        const p1 = this.toPhysicsPoint(from);
        const p2 = this.toPhysicsPoint(to);
        this.world.rayCast(p1, p2, (fixture, point, normal, fraction) => {
            const pixelPoint = this.toPixelsPoint(point);
            const pixelNormal = new PIXI.Point(normal.x, normal.y);
            return callback(fixture, pixelPoint, pixelNormal, fraction);
        });
    }
    queryAABB(bounds, callback) {
        const lowerBound = this.toPhysicsPoint(new PIXI.Point(bounds.x, bounds.y));
        const upperBound = this.toPhysicsPoint(new PIXI.Point(bounds.x + bounds.width, bounds.y + bounds.height));
        this.world.queryAABB(planck.AABB(lowerBound, upperBound), (fixture) => {
            return callback(fixture.getBody());
        });
    }
    queryPoint(point, callback) {
        const physicsPoint = this.toPhysicsPoint(point);
        this.world.queryAABB(planck.AABB(planck.Vec2(physicsPoint.x - 0.001, physicsPoint.y - 0.001), planck.Vec2(physicsPoint.x + 0.001, physicsPoint.y + 0.001)), (fixture) => {
            if (fixture.testPoint(physicsPoint)) {
                return callback(fixture);
            }
            return true;
        });
    }
    toPhysics(pixels) {
        return pixels / this.pixelsPerMeter;
    }
    toPixels(meters) {
        return meters * this.pixelsPerMeter;
    }
    toPhysicsPoint(point) {
        return planck.Vec2(this.toPhysics(point.x), this.toPhysics(point.y));
    }
    toPixelsPoint(vec) {
        return new PIXI.Point(this.toPixels(vec.x), this.toPixels(vec.y));
    }
    enableDebugRenderer(scene, options = {}) {
        if (this.debugRenderer) {
            this.disableDebugRenderer();
        }
        this.debugGraphics = new PIXI.Graphics();
        this.debugRenderer = new physics_debug_renderer_1.PhysicsDebugRenderer(this, options);
        const debugEntity = (0, moxi_entity_1.asEntity)(this.debugGraphics);
        debugEntity.moxiEntity.addLogic(this.debugRenderer);
        debugEntity.zIndex = 10000;
        scene.sortableChildren = true;
        scene.addChild(debugEntity);
        console.log('Physics debug renderer enabled. Press "P" to toggle visibility.');
        return this.debugRenderer;
    }
    disableDebugRenderer() {
        if (this.debugRenderer && this.debugGraphics) {
            if (this.debugGraphics.parent) {
                this.debugGraphics.parent.removeChild(this.debugGraphics);
            }
            this.debugGraphics.destroy();
            this.debugGraphics = undefined;
            this.debugRenderer = undefined;
        }
    }
    getDebugRenderer() {
        return this.debugRenderer;
    }
    getBodies() {
        const bodies = [];
        for (let body = this.world.getBodyList(); body; body = body.getNext()) {
            bodies.push(body);
        }
        return bodies;
    }
    destroy() {
        const bodies = this.getBodies();
        bodies.forEach(body => this.world.destroyBody(body));
        this.bodies.clear();
        this.debugRenderer = undefined;
    }
}
exports.PhysicsWorld = PhysicsWorld;


/***/ }),

/***/ "./src/library/resize-handler.ts":
/*!***************************************!*\
  !*** ./src/library/resize-handler.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createResizeHandler = createResizeHandler;
exports.setupResponsiveCanvas = setupResponsiveCanvas;
const DEFAULT_ROOT_STYLES = {
    display: 'flex',
    justifyContent: 'center',
    alignItems: 'center',
    overflow: 'hidden'
};
const PIXEL_ART_CANVAS_STYLES = {
    imageRendering: 'pixelated'
};
function createResizeHandler(options) {
    const { rootElement, width, height, rootStyles = DEFAULT_ROOT_STYLES, canvasStyles = {}, pixelArtMode = false } = options;
    Object.entries(rootStyles).forEach(([key, value]) => {
        rootElement.style.setProperty(key, value);
    });
    const finalCanvasStyles = pixelArtMode
        ? { ...PIXEL_ART_CANVAS_STYLES, ...canvasStyles }
        : canvasStyles;
    return () => {
        const parentWidth = rootElement.clientWidth;
        const parentHeight = rootElement.clientHeight;
        const ratio = Math.min(parentWidth / width, parentHeight / height);
        if (rootElement.firstElementChild instanceof HTMLCanvasElement) {
            const canvas = rootElement.firstElementChild;
            canvas.style.width = `${Math.round(width * ratio)}px`;
            canvas.style.height = `${Math.round(height * ratio)}px`;
            canvas.style.display = 'block';
            Object.entries(finalCanvasStyles).forEach(([key, value]) => {
                canvas.style.setProperty(key, value);
            });
        }
    };
}
function setupResponsiveCanvas(options) {
    const resizeHandler = createResizeHandler(options);
    resizeHandler();
    window.addEventListener('resize', resizeHandler);
    return () => {
        window.removeEventListener('resize', resizeHandler);
    };
}


/***/ }),

/***/ "./src/library/setup.ts":
/*!******************************!*\
  !*** ./src/library/setup.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.defaultRenderOptions = void 0;
exports.setupMoxi = setupMoxi;
const asset_loader_1 = __webpack_require__(/*! ../core/asset-loader */ "./src/core/asset-loader.ts");
const camera_1 = __webpack_require__(/*! ../core/camera */ "./src/core/camera.ts");
const engine_1 = __webpack_require__(/*! ../core/engine */ "./src/core/engine.ts");
const render_manager_1 = __webpack_require__(/*! ../core/render-manager */ "./src/core/render-manager.ts");
const scene_1 = __webpack_require__(/*! ../core/scene */ "./src/core/scene.ts");
const physics_1 = __webpack_require__(/*! ./physics */ "./src/library/physics/index.ts");
const loading_scene_1 = __webpack_require__(/*! ./loading-scene */ "./src/library/loading-scene.ts");
exports.defaultRenderOptions = {
    width: 1280,
    height: 720,
    backgroundColor: 0x1099bb,
    resolution: window.devicePixelRatio || 1,
    autoDensity: true,
    antialias: true
};
async function setupMoxi({ hostElement, renderOptions = exports.defaultRenderOptions, backgroundColor, physics, showLoadingScene = false, loadingSceneOptions = {}, pixelPerfect } = {}) {
    let finalRenderOptions = { ...renderOptions };
    let applyImageRendering = false;
    if (pixelPerfect) {
        const ppOptions = typeof pixelPerfect === 'boolean'
            ? { enabled: true, imageRendering: true }
            : pixelPerfect;
        if (ppOptions.enabled !== false) {
            finalRenderOptions = {
                ...finalRenderOptions,
                resolution: 1,
                antialias: false,
                roundPixels: true
            };
        }
        applyImageRendering = ppOptions.imageRendering !== false;
    }
    const { renderer } = await render_manager_1.RenderManager.create(hostElement, finalRenderOptions);
    if (backgroundColor !== undefined) {
        renderer.background.color = backgroundColor;
    }
    if (applyImageRendering) {
        const canvas = renderer.canvas;
        canvas.style.imageRendering = 'pixelated';
        canvas.style.imageRendering = '-moz-crisp-edges';
        canvas.style.imageRendering = 'crisp-edges';
    }
    const scene = new scene_1.Scene(renderer);
    const engine = new engine_1.Engine(scene);
    const assetLoader = new asset_loader_1.AssetLoader();
    const { PIXIAssets, loadAssets } = assetLoader;
    const camera = new camera_1.Camera(scene, renderer);
    let physicsWorld;
    if (physics) {
        const physicsOptions = typeof physics === 'boolean'
            ? {}
            : physics;
        physicsWorld = new physics_1.PhysicsWorld(physicsOptions);
        engine.addPhysicsWorld(physicsWorld);
    }
    let loadingScene;
    if (showLoadingScene) {
        loadingScene = new loading_scene_1.LoadingScene(loadingSceneOptions);
        loadingScene.zIndex = 10000;
        loadingScene.init(renderer);
        scene.addChild(loadingScene);
        loadingScene.hide();
        assetLoader.on('loading:start', () => {
            if (loadingScene) {
                loadingScene.show();
            }
        });
        assetLoader.on('loading:end', () => {
            if (loadingScene) {
                loadingScene.hide();
            }
        });
    }
    return {
        scene,
        engine,
        PIXIAssets,
        renderer,
        loadAssets,
        camera,
        physicsWorld,
        loadingScene
    };
}


/***/ }),

/***/ "./src/library/state-logic.ts":
/*!************************************!*\
  !*** ./src/library/state-logic.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.StateLogic = void 0;
const logic_1 = __webpack_require__(/*! ../core/logic */ "./src/core/logic.ts");
class StateLogic extends logic_1.Logic {
    _entity;
    constructor(name) {
        super();
        this.name = name;
    }
    get entity() {
        return this._entity;
    }
    init(entity, renderer) {
        this._entity = entity;
        super.init(entity, renderer);
    }
    onEnter(state) {
    }
    onExit(state) {
    }
    update(entity, deltaTime) {
    }
}
exports.StateLogic = StateLogic;


/***/ }),

/***/ "./src/library/state-machine.ts":
/*!**************************************!*\
  !*** ./src/library/state-machine.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.StateMachine = void 0;
class StateMachine extends EventTarget {
    _states = {};
    _currentState = null;
    _currentStateName = null;
    constructor(states = {}) {
        super();
        this._states = states;
    }
    update(deltaTime) {
        if (this._currentState) {
            this._currentState.update(this._currentState.entity, deltaTime);
        }
    }
    setState(stateName) {
        const nextState = this._states[stateName];
        if (!nextState)
            return;
        const prevStateName = this._currentStateName;
        if (this._currentState) {
            this._currentState.onExit(stateName);
        }
        this._currentState = this._states[stateName];
        this._currentStateName = stateName;
        this._currentState.onEnter(stateName);
        const event = new CustomEvent('stateChange', {
            detail: {
                prevState: prevStateName,
                newState: stateName
            }
        });
        this.dispatchEvent(event);
    }
    addState(state) {
        this._states[state.name] = state;
    }
    get currentState() {
        return this._currentStateName;
    }
}
exports.StateMachine = StateMachine;


/***/ }),

/***/ "./src/library/svg-utils/svg-to-texture.ts":
/*!*************************************************!*\
  !*** ./src/library/svg-utils/svg-to-texture.ts ***!
  \*************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.svgToTexture = svgToTexture;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
async function svgToTexture(options) {
    const { svgString, width, height, color = 0x000000 } = options;
    const colorHex = '#' + color.toString(16).padStart(6, '0');
    const processedSVG = svgString.replace(/currentColor/g, colorHex);
    const blob = new Blob([processedSVG], { type: 'image/svg+xml' });
    const url = URL.createObjectURL(blob);
    const img = new Image();
    img.width = width;
    img.height = height;
    await new Promise((resolve, reject) => {
        img.onload = () => resolve();
        img.onerror = reject;
        img.src = url;
    });
    const canvas = document.createElement('canvas');
    canvas.width = width;
    canvas.height = height;
    const ctx = canvas.getContext('2d');
    if (!ctx) {
        URL.revokeObjectURL(url);
        throw new Error('Failed to get canvas context');
    }
    ctx.drawImage(img, 0, 0, width, height);
    URL.revokeObjectURL(url);
    const texture = PIXI.Texture.from(canvas);
    texture.source.scaleMode = 'linear';
    return texture;
}


/***/ }),

/***/ "./src/library/texture-frame-sequences.ts":
/*!************************************************!*\
  !*** ./src/library/texture-frame-sequences.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.TextureFrameSequences = void 0;
class TextureFrameSequences {
    frames = [];
    sequences = {};
    constructor(frames, sequences = {}) {
        this.frames = frames;
        this.sequences = sequences;
    }
    addSequence(name, frameIndices, animationSpeed = 1) {
        this.sequences[name] = {
            frames: frameIndices,
            animationSpeed
        };
    }
    getSequence(name) {
        return this.sequences[name] || null;
    }
    getFrame(index) {
        return this.frames[index] || null;
    }
    getFrameFromSequence(sequenceName, frameIndex) {
        const sequence = this.getSequence(sequenceName);
        if (!sequence)
            return null;
        const sequenceFrameIndex = sequence.frames[frameIndex % sequence.frames.length];
        return this.frames[sequenceFrameIndex] || null;
    }
    getFrameSequence(name) {
        const sequence = this.getSequence(name);
        if (!sequence)
            return [];
        return sequence.frames.map(index => this.frames[index]).filter(Boolean);
    }
}
exports.TextureFrameSequences = TextureFrameSequences;


/***/ }),

/***/ "./src/library/texture-frames.ts":
/*!***************************************!*\
  !*** ./src/library/texture-frames.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asTextureFrames = asTextureFrames;
const defaultOptions = {
    frameWidth: 48,
    frameHeight: 48,
    columns: 4,
    rows: 4
};
function asTextureFrames(PIXI, textureSource, options = defaultOptions) {
    const { frameWidth, frameHeight, columns, rows } = options;
    const frames = [];
    if (!textureSource) {
        console.error('Invalid texture source provided to asTextureFrames');
        return frames;
    }
    for (let y = 0; y < rows; y++) {
        for (let x = 0; x < columns; x++) {
            const frame = new PIXI.Rectangle(x * frameWidth, y * frameHeight, frameWidth, frameHeight);
            const frametexture = new PIXI.Texture({
                source: textureSource,
                frame: frame,
            });
            frames.push(frametexture);
        }
    }
    return frames;
}


/***/ }),

/***/ "./src/library/utils.ts":
/*!******************************!*\
  !*** ./src/library/utils.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.deg2rad = exports.rad2deg = exports.fetchXml = exports.lerp = exports.roundTo = exports.getRandomInt = exports.pr = exports.padRight = exports.lc = exports.uc = exports.ONE_POINT = exports.ZERO_POINT = exports.createPoint = void 0;
exports.metersToPixels = metersToPixels;
exports.pixelsToMeters = pixelsToMeters;
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
const createPoint = (x = 0, y = 0) => new pixi_js_1.Point(x, y);
exports.createPoint = createPoint;
const ZERO_POINT = () => new pixi_js_1.Point(0, 0);
exports.ZERO_POINT = ZERO_POINT;
const ONE_POINT = () => new pixi_js_1.Point(1, 1);
exports.ONE_POINT = ONE_POINT;
const uc = (s = '') => s.toUpperCase();
exports.uc = uc;
const lc = (s = '') => s.toLowerCase();
exports.lc = lc;
const padRight = (val = '', length = 0, padWith = ' ') => {
    let result = val + '';
    while (result.length < length) {
        result += padWith;
    }
    return result;
};
exports.padRight = padRight;
exports.pr = exports.padRight;
const getRandomInt = (min, max) => (Math.floor(Math.random() * (max + 1 - min)) + min);
exports.getRandomInt = getRandomInt;
const roundTo = (places, value) => (Math.round(value * Math.pow(10, places)) / Math.pow(10, places));
exports.roundTo = roundTo;
const lerp = (begin, end, mag) => ((1 - mag) * begin + mag * end);
exports.lerp = lerp;
function metersToPixels(m) { return m * 20; }
function pixelsToMeters(p) { return p * 0.05; }
const fetchXml = async (url) => (await (await fetch(url)).text());
exports.fetchXml = fetchXml;
const rad2deg = (rad) => rad * (180 / Math.PI);
exports.rad2deg = rad2deg;
const deg2rad = (deg) => deg * (Math.PI / 180);
exports.deg2rad = deg2rad;


/***/ }),

/***/ "./src/ui/UILayer.ts":
/*!***************************!*\
  !*** ./src/ui/UILayer.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UILayer = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const UIScaleMode_1 = __webpack_require__(/*! ./UIScaleMode */ "./src/ui/UIScaleMode.ts");
class UILayer extends PIXI.Container {
    scaleMode;
    targetWidth;
    targetHeight;
    initialBoundsRecorded = false;
    constructor(options = {}) {
        super();
        this.scaleMode = options.scaleMode ?? UIScaleMode_1.UIScaleMode.None;
        this.targetWidth = options.targetWidth;
        this.targetHeight = options.targetHeight;
    }
    updateScale(canvasWidth, canvasHeight) {
        if (this.scaleMode === UIScaleMode_1.UIScaleMode.None) {
            this.scale.set(1, 1);
            return;
        }
        if (!this.initialBoundsRecorded && this.children.length > 0) {
            if (!this.targetWidth || !this.targetHeight) {
                const bounds = this.getLocalBounds();
                this.targetWidth = this.targetWidth ?? bounds.width;
                this.targetHeight = this.targetHeight ?? bounds.height;
            }
            this.initialBoundsRecorded = true;
        }
        if (!this.targetWidth || !this.targetHeight) {
            return;
        }
        const scaleX = canvasWidth / this.targetWidth;
        const scaleY = canvasHeight / this.targetHeight;
        switch (this.scaleMode) {
            case UIScaleMode_1.UIScaleMode.ScaleUI:
                this.scale.set(scaleX, scaleY);
                break;
            case UIScaleMode_1.UIScaleMode.LockRatio:
                const scale = Math.min(scaleX, scaleY);
                this.scale.set(scale, scale);
                this.position.set((canvasWidth - this.targetWidth * scale) / 2, (canvasHeight - this.targetHeight * scale) / 2);
                break;
        }
    }
    addChild(...children) {
        const result = super.addChild(...children);
        this.initialBoundsRecorded = false;
        return result;
    }
}
exports.UILayer = UILayer;


/***/ }),

/***/ "./src/ui/UIScaleMode.ts":
/*!*******************************!*\
  !*** ./src/ui/UIScaleMode.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIScaleMode = void 0;
var UIScaleMode;
(function (UIScaleMode) {
    UIScaleMode["None"] = "none";
    UIScaleMode["ScaleUI"] = "scaleUI";
    UIScaleMode["LockRatio"] = "lockRatio";
})(UIScaleMode || (exports.UIScaleMode = UIScaleMode = {}));


/***/ }),

/***/ "./src/ui/components/button-background-strategy.ts":
/*!*********************************************************!*\
  !*** ./src/ui/components/button-background-strategy.ts ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.SpriteBackgroundStrategy = exports.SolidColorBackgroundStrategy = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_button_1 = __webpack_require__(/*! ./ui-button */ "./src/ui/components/ui-button.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
class SolidColorBackgroundStrategy {
    panel;
    normalColor;
    hoverColor;
    pressedColor;
    disabledColor;
    width;
    height;
    borderRadius;
    constructor(backgroundColor, width, height, borderRadius) {
        this.normalColor = backgroundColor;
        this.hoverColor = this.darkenColor(backgroundColor, 0.9);
        this.pressedColor = this.darkenColor(backgroundColor, 0.8);
        this.disabledColor = 0x888888;
        this.width = width;
        this.height = height;
        this.borderRadius = borderRadius;
    }
    create(width, height) {
        this.panel = new ui_panel_1.UIPanel({
            backgroundColor: this.normalColor,
            width,
            height,
            borderRadius: this.borderRadius
        });
        this.panel.layout(width, height);
        return this.panel.container;
    }
    updateState(state) {
        if (!this.panel)
            return;
        let color;
        switch (state) {
            case ui_button_1.ButtonState.Normal:
                color = this.normalColor;
                break;
            case ui_button_1.ButtonState.Hover:
                color = this.hoverColor;
                break;
            case ui_button_1.ButtonState.Pressed:
                color = this.pressedColor;
                break;
            case ui_button_1.ButtonState.Disabled:
                color = this.disabledColor;
                break;
        }
        this.panel.setBackgroundColor(color);
    }
    getActualHeight() {
        return this.height;
    }
    destroy() {
    }
    darkenColor(color, factor) {
        const r = ((color >> 16) & 0xff) * factor;
        const g = ((color >> 8) & 0xff) * factor;
        const b = (color & 0xff) * factor;
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
}
exports.SolidColorBackgroundStrategy = SolidColorBackgroundStrategy;
class SpriteBackgroundStrategy {
    container;
    spriteLeft;
    spriteMid;
    spriteRight;
    nineSliceSprite;
    nineSliceSpritePressed;
    iconSprite;
    config;
    width;
    height;
    constructor(config, width, height) {
        this.config = config;
        this.width = width;
        this.height = height;
    }
    create(width, height) {
        this.container = new pixi_js_1.default.Container();
        const { spritesheet, texturePattern, color, pixelPerfect, useNineSlice, nineSliceBorders, pressedTexturePattern, icon } = this.config;
        if (pixelPerfect && spritesheet.textureSource) {
            spritesheet.textureSource.scaleMode = 'nearest';
        }
        if (useNineSlice && nineSliceBorders) {
            const textureName = texturePattern.includes('{color}')
                ? texturePattern.replace('{color}', color)
                : texturePattern;
            const texture = spritesheet.textures[textureName];
            this.nineSliceSprite = new pixi_js_1.default.NineSliceSprite({
                texture,
                leftWidth: nineSliceBorders.left,
                topHeight: nineSliceBorders.top,
                rightWidth: nineSliceBorders.right,
                bottomHeight: nineSliceBorders.bottom,
                width,
                height
            });
            this.container.addChild(this.nineSliceSprite);
            if (pressedTexturePattern) {
                const pressedTextureName = pressedTexturePattern.includes('{color}')
                    ? pressedTexturePattern.replace('{color}', color)
                    : pressedTexturePattern;
                const pressedTexture = spritesheet.textures[pressedTextureName];
                this.nineSliceSpritePressed = new pixi_js_1.default.NineSliceSprite({
                    texture: pressedTexture,
                    leftWidth: nineSliceBorders.left,
                    topHeight: nineSliceBorders.top,
                    rightWidth: nineSliceBorders.right,
                    bottomHeight: nineSliceBorders.bottom,
                    width,
                    height
                });
                this.nineSliceSpritePressed.y = 4;
                this.nineSliceSpritePressed.visible = false;
                this.container.addChild(this.nineSliceSpritePressed);
            }
        }
        else {
            const leftTextureName = this.getTextureName(texturePattern, color, 'left');
            const midTextureName = this.getTextureName(texturePattern, color, 'mid');
            const rightTextureName = this.getTextureName(texturePattern, color, 'right');
            this.spriteLeft = new pixi_js_1.default.Sprite(spritesheet.textures[leftTextureName]);
            this.spriteMid = new pixi_js_1.default.Sprite(spritesheet.textures[midTextureName]);
            this.spriteRight = new pixi_js_1.default.Sprite(spritesheet.textures[rightTextureName]);
            const scaleY = height / this.spriteLeft.height;
            this.spriteLeft.scale.y = scaleY;
            this.spriteMid.scale.y = scaleY;
            this.spriteRight.scale.y = scaleY;
            this.spriteLeft.x = 0;
            const middleWidth = width - this.spriteLeft.width - this.spriteRight.width;
            this.spriteMid.width = middleWidth;
            this.spriteMid.x = this.spriteLeft.width;
            this.spriteRight.x = this.spriteLeft.width + middleWidth;
            this.container.addChild(this.spriteLeft);
            this.container.addChild(this.spriteMid);
            this.container.addChild(this.spriteRight);
        }
        if (icon) {
            const iconTexture = icon.spritesheet.textures[icon.textureName];
            this.iconSprite = new pixi_js_1.default.Sprite(iconTexture);
            if (icon.pixelPerfect && icon.spritesheet.textureSource) {
                icon.spritesheet.textureSource.scaleMode = 'nearest';
            }
            if (icon.scale) {
                this.iconSprite.scale.set(icon.scale);
            }
            this.iconSprite.anchor.set(0.5);
            this.iconSprite.x = width / 2;
            this.iconSprite.y = height / 2;
            this.container.addChild(this.iconSprite);
        }
        return this.container;
    }
    updateState(state) {
        if (this.nineSliceSprite && this.nineSliceSpritePressed) {
            const isPressed = state === ui_button_1.ButtonState.Pressed;
            this.nineSliceSprite.visible = !isPressed;
            this.nineSliceSpritePressed.visible = isPressed;
            if (this.iconSprite) {
                this.iconSprite.y = (this.height / 2) + (isPressed ? 4 : 0);
            }
        }
        else {
            let tint;
            switch (state) {
                case ui_button_1.ButtonState.Normal:
                    tint = 0xffffff;
                    break;
                case ui_button_1.ButtonState.Hover:
                    tint = 0xcccccc;
                    break;
                case ui_button_1.ButtonState.Pressed:
                    tint = 0x999999;
                    break;
                case ui_button_1.ButtonState.Disabled:
                    tint = 0x888888;
                    break;
            }
            if (this.nineSliceSprite) {
                this.nineSliceSprite.tint = tint;
            }
            else if (this.spriteLeft && this.spriteMid && this.spriteRight) {
                this.spriteLeft.tint = tint;
                this.spriteMid.tint = tint;
                this.spriteRight.tint = tint;
            }
        }
    }
    getActualHeight() {
        if (this.nineSliceSprite) {
            return this.nineSliceSprite.height;
        }
        return this.spriteLeft?.height ?? this.height;
    }
    destroy() {
        this.container?.destroy({ children: true });
    }
    getTextureName(pattern, color, part) {
        let name = pattern.replace('{color}', color);
        name = name.replace(/_(?:left|mid|right)\.png$/, `_${part}.png`);
        return name;
    }
}
exports.SpriteBackgroundStrategy = SpriteBackgroundStrategy;


/***/ }),

/***/ "./src/ui/components/ui-box.ts":
/*!*************************************!*\
  !*** ./src/ui/components/ui-box.ts ***!
  \*************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIBox = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UIBox extends ui_component_1.UIComponent {
    props;
    graphics;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            backgroundColor: 0x000000,
            backgroundAlpha: 1,
            borderWidth: 0,
            borderRadius: 0,
            ...props
        };
        this.graphics = new pixi_js_1.default.Graphics();
        this.container.addChild(this.graphics);
        if (props.width !== undefined) {
            this.boxModel.width = props.width;
        }
        if (props.height !== undefined) {
            this.boxModel.height = props.height;
        }
    }
    measure() {
        const padding = this.boxModel.padding;
        const border = this.boxModel.border;
        let contentWidth = 0;
        let contentHeight = 0;
        if (typeof this.boxModel.width === 'number') {
            contentWidth = this.boxModel.width;
        }
        else if (this.props.width !== undefined) {
            contentWidth = this.props.width;
        }
        if (typeof this.boxModel.height === 'number') {
            contentHeight = this.boxModel.height;
        }
        else if (this.props.height !== undefined) {
            contentHeight = this.props.height;
        }
        const totalWidth = contentWidth + padding.horizontal + (border?.horizontal ?? 0);
        const totalHeight = contentHeight + padding.vertical + (border?.vertical ?? 0);
        return {
            width: Math.max(totalWidth, this.boxModel.minWidth ?? 0),
            height: Math.max(totalHeight, this.boxModel.minHeight ?? 0)
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        const padding = this.boxModel.padding;
        const border = this.boxModel.border ?? { horizontal: 0, vertical: 0, top: 0, right: 0, bottom: 0, left: 0 };
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        if (this.boxModel.maxWidth !== undefined) {
            finalWidth = Math.min(finalWidth, this.boxModel.maxWidth);
        }
        if (this.boxModel.maxHeight !== undefined) {
            finalHeight = Math.min(finalHeight, this.boxModel.maxHeight);
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left + border.left;
        this.computedLayout.contentY = padding.top + border.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal - border.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical - border.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        this.graphics.clear();
        const { width, height } = this.computedLayout;
        const { backgroundColor, backgroundAlpha, borderColor, borderWidth, borderRadius } = this.props;
        if (borderWidth && borderWidth > 0 && borderColor !== undefined) {
            this.graphics.rect(0, 0, width, height);
            this.graphics.stroke({ color: borderColor, width: borderWidth });
        }
        if (backgroundColor !== undefined) {
            if (borderRadius && borderRadius > 0) {
                this.graphics.roundRect(0, 0, width, height, borderRadius);
            }
            else {
                this.graphics.rect(0, 0, width, height);
            }
            this.graphics.fill({ color: backgroundColor, alpha: backgroundAlpha });
        }
    }
    setBackgroundColor(color, alpha = 1) {
        this.props.backgroundColor = color;
        this.props.backgroundAlpha = alpha;
        this.render();
    }
    setBorder(color, width) {
        this.props.borderColor = color;
        this.props.borderWidth = width;
        this.render();
    }
}
exports.UIBox = UIBox;


/***/ }),

/***/ "./src/ui/components/ui-button.ts":
/*!****************************************!*\
  !*** ./src/ui/components/ui-button.ts ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIButton = exports.ButtonState = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
const button_background_strategy_1 = __webpack_require__(/*! ./button-background-strategy */ "./src/ui/components/button-background-strategy.ts");
var ButtonState;
(function (ButtonState) {
    ButtonState["Normal"] = "normal";
    ButtonState["Hover"] = "hover";
    ButtonState["Pressed"] = "pressed";
    ButtonState["Disabled"] = "disabled";
})(ButtonState || (exports.ButtonState = ButtonState = {}));
class UIButton extends ui_component_1.UIComponent {
    props;
    useBitmapText;
    bitmapFontFamily;
    onClick;
    onHover;
    state = ButtonState.Normal;
    backgroundStrategy;
    label;
    bitmapLabel;
    labelCenterX = 0;
    labelCenterY = 0;
    keydownHandler;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            label: props.label ?? '',
            width: props.width ?? 120,
            height: props.height ?? 40,
            backgroundColor: props.backgroundColor ?? 0x4a90e2,
            textColor: props.textColor ?? 0xffffff,
            fontSize: props.fontSize ?? 16,
            borderRadius: props.borderRadius ?? 4,
            padding: props.padding ?? edge_insets_1.EdgeInsets.symmetric(8, 16),
            enabled: props.enabled ?? true
        };
        this.useBitmapText = props.useBitmapText ?? false;
        this.bitmapFontFamily = props.bitmapFontFamily;
        this.onClick = props.onClick;
        this.onHover = props.onHover;
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.tabIndex = 0;
        if (props.spriteBackground) {
            this.backgroundStrategy = new button_background_strategy_1.SpriteBackgroundStrategy(props.spriteBackground, this.props.width, this.props.height);
        }
        else {
            this.backgroundStrategy = new button_background_strategy_1.SolidColorBackgroundStrategy(this.props.backgroundColor, this.props.width, this.props.height, this.props.borderRadius);
        }
        const backgroundContainer = this.backgroundStrategy.create(this.props.width, this.props.height);
        this.container.addChild(backgroundContainer);
        if (this.props.label) {
            if (this.useBitmapText && this.bitmapFontFamily) {
                this.createBitmapLabel();
            }
            else {
                this.label = new ui_label_1.UILabel({
                    text: this.props.label,
                    fontSize: this.props.fontSize,
                    color: this.props.textColor,
                    align: 'center'
                }, {
                    padding: edge_insets_1.EdgeInsets.zero()
                });
                this.container.addChild(this.label.container);
            }
        }
        this.setupInteractivity();
        if (!this.props.enabled) {
            this.setState(ButtonState.Disabled);
        }
    }
    createBitmapLabel() {
        if (!this.bitmapFontFamily)
            return;
        this.bitmapLabel = new pixi_js_1.default.BitmapText({
            text: this.props.label,
            style: {
                fontFamily: this.bitmapFontFamily,
                fontSize: this.props.fontSize,
                fill: this.props.textColor
            }
        });
        this.container.addChild(this.bitmapLabel);
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'pointer';
        this.container.on('pointerover', this.handlePointerOver.bind(this));
        this.container.on('pointerout', this.handlePointerOut.bind(this));
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        this.container.on('pointerup', this.handlePointerUp.bind(this));
        this.container.on('pointerupoutside', this.handlePointerUpOutside.bind(this));
        if (typeof window !== 'undefined') {
            this.keydownHandler = (e) => {
                if (this.isFocused() && this.props.enabled) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.setState(ButtonState.Pressed);
                        this.onClick?.();
                        setTimeout(() => {
                            if (this.props.enabled) {
                                this.setState(ButtonState.Normal);
                            }
                        }, 100);
                    }
                }
            };
            window.addEventListener('keydown', this.keydownHandler);
        }
    }
    handlePointerOver() {
        if (this.props.enabled && this.state === ButtonState.Normal) {
            this.setState(ButtonState.Hover);
            this.onHover?.();
        }
    }
    handlePointerOut() {
        if (this.props.enabled && this.state !== ButtonState.Pressed) {
            this.setState(ButtonState.Normal);
        }
    }
    handlePointerDown() {
        if (this.props.enabled) {
            this.setState(ButtonState.Pressed);
            if (this.canFocus()) {
                const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
                if (focusManager) {
                    focusManager.requestFocus(this);
                }
                else {
                    this.onFocus();
                }
            }
        }
    }
    handlePointerUp() {
        if (this.props.enabled) {
            this.setState(ButtonState.Hover);
            this.onClick?.();
        }
    }
    handlePointerUpOutside() {
        if (this.props.enabled) {
            this.setState(ButtonState.Normal);
        }
    }
    setState(newState) {
        this.state = newState;
        this.updateVisuals();
    }
    updateVisuals() {
        this.backgroundStrategy.updateState(this.state);
        const yOffset = this.state === ButtonState.Pressed ? 2 : 0;
        if (this.state === ButtonState.Disabled) {
            this.container.cursor = 'default';
        }
        else {
            this.container.cursor = 'pointer';
        }
        if (this.label) {
            this.label.setPosition(this.labelCenterX, this.labelCenterY + yOffset);
        }
        else if (this.bitmapLabel) {
            this.bitmapLabel.x = this.labelCenterX;
            this.bitmapLabel.y = this.labelCenterY + yOffset;
        }
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        const actualHeight = this.backgroundStrategy.getActualHeight();
        if (this.label) {
            this.label.layout(measured.width, measured.height);
            const labelLayout = this.label.getLayout();
            this.labelCenterX = (measured.width - labelLayout.width) / 2;
            this.labelCenterY = (actualHeight - labelLayout.height) / 2;
            this.label.setPosition(this.labelCenterX, this.labelCenterY);
        }
        else if (this.bitmapLabel) {
            this.labelCenterX = (measured.width - this.bitmapLabel.width) / 2;
            this.labelCenterY = (actualHeight - this.bitmapLabel.height) / 2;
            this.bitmapLabel.x = this.labelCenterX;
            this.bitmapLabel.y = this.labelCenterY;
        }
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setLabel(text) {
        if (this.label) {
            this.label.setText(text);
            this.markLayoutDirty();
        }
        else if (this.bitmapLabel) {
            this.bitmapLabel.text = text;
            this.markLayoutDirty();
        }
    }
    setEnabled(enabled) {
        this.props.enabled = enabled;
        this.setState(enabled ? ButtonState.Normal : ButtonState.Disabled);
    }
    getState() {
        return this.state;
    }
    destroy() {
        if (typeof window !== 'undefined' && this.keydownHandler) {
            window.removeEventListener('keydown', this.keydownHandler);
        }
        super.destroy();
    }
}
exports.UIButton = UIButton;


/***/ }),

/***/ "./src/ui/components/ui-label.ts":
/*!***************************************!*\
  !*** ./src/ui/components/ui-label.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UILabel = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UILabel extends ui_component_1.UIComponent {
    props;
    textObject;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            text: props.text,
            fontSize: props.fontSize ?? 16,
            fontFamily: props.fontFamily ?? 'Arial',
            color: props.color ?? 0xffffff,
            align: props.align ?? 'left',
            wordWrap: props.wordWrap ?? false,
            wordWrapWidth: props.wordWrapWidth ?? 0,
            fontWeight: props.fontWeight ?? 'normal',
            lineHeight: props.lineHeight ?? 1.2
        };
        this.textObject = new pixi_js_1.default.Text({
            text: this.props.text,
            style: this.getTextStyle(),
            resolution: window.devicePixelRatio || 2
        });
        this.container.addChild(this.textObject);
    }
    getTextStyle() {
        const style = {
            fontFamily: this.props.fontFamily,
            fontSize: this.props.fontSize,
            fill: this.props.color,
            align: this.props.align,
            fontWeight: this.props.fontWeight,
            lineHeight: this.props.fontSize * this.props.lineHeight
        };
        if (this.props.wordWrap) {
            style.wordWrap = true;
            style.wordWrapWidth = this.props.wordWrapWidth;
        }
        return style;
    }
    measure() {
        const padding = this.boxModel.padding;
        const metrics = this.textObject;
        const textWidth = metrics.width;
        const textHeight = metrics.height;
        return {
            width: textWidth + padding.horizontal,
            height: textHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const padding = this.boxModel.padding;
        if (this.props.wordWrap && this.props.wordWrapWidth === 0) {
            const wrapWidth = availableWidth - padding.horizontal;
            this.props.wordWrapWidth = wrapWidth;
            this.textObject.style = this.getTextStyle();
        }
        const measured = this.measure();
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        else if (typeof this.boxModel.width === 'number') {
            finalWidth = this.boxModel.width + padding.horizontal;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        else if (typeof this.boxModel.height === 'number') {
            finalHeight = this.boxModel.height + padding.vertical;
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        const padding = this.boxModel.padding;
        this.textObject.position.set(padding.left, padding.top);
    }
    setText(text) {
        this.props.text = text;
        this.textObject.text = text;
        this.markLayoutDirty();
    }
    setColor(color) {
        this.props.color = color;
        this.textObject.style.fill = color;
    }
    setFontSize(size) {
        this.props.fontSize = size;
        this.textObject.style.fontSize = size;
        this.markLayoutDirty();
    }
    getText() {
        return this.props.text;
    }
}
exports.UILabel = UILabel;


/***/ }),

/***/ "./src/ui/components/ui-panel.ts":
/*!***************************************!*\
  !*** ./src/ui/components/ui-panel.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIPanel = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UIPanel extends ui_component_1.UIComponent {
    props;
    background;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            backgroundAlpha: props.backgroundAlpha ?? 1,
            ...props
        };
        if (props.width !== undefined) {
            this.boxModel.width = props.width;
        }
        if (props.height !== undefined) {
            this.boxModel.height = props.height;
        }
        this.createBackground();
    }
    createBackground() {
        if (this.props.texture && this.props.nineSlice) {
            const { leftWidth, topHeight, rightWidth, bottomHeight } = this.props.nineSlice;
            this.background = new pixi_js_1.default.NineSliceSprite({
                texture: this.props.texture,
                leftWidth,
                topHeight,
                rightWidth,
                bottomHeight
            });
            this.background.alpha = this.props.backgroundAlpha ?? 1;
            this.container.addChild(this.background);
        }
        else if (this.props.backgroundColor !== undefined) {
            this.background = new pixi_js_1.default.Graphics();
            this.container.addChild(this.background);
        }
    }
    measure() {
        const padding = this.boxModel.padding;
        let contentWidth = 0;
        let contentHeight = 0;
        if (typeof this.boxModel.width === 'number') {
            contentWidth = this.boxModel.width;
        }
        else if (this.props.width !== undefined) {
            contentWidth = this.props.width;
        }
        if (typeof this.boxModel.height === 'number') {
            contentHeight = this.boxModel.height;
        }
        else if (this.props.height !== undefined) {
            contentHeight = this.props.height;
        }
        return {
            width: contentWidth + padding.horizontal,
            height: contentHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        const padding = this.boxModel.padding;
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        if (this.boxModel.maxWidth !== undefined) {
            finalWidth = Math.min(finalWidth, this.boxModel.maxWidth);
        }
        if (this.boxModel.maxHeight !== undefined) {
            finalHeight = Math.min(finalHeight, this.boxModel.maxHeight);
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        if (!this.background)
            return;
        const { width, height } = this.computedLayout;
        if (this.background instanceof pixi_js_1.default.NineSliceSprite) {
            this.background.width = width;
            this.background.height = height;
        }
        else if (this.background instanceof pixi_js_1.default.Graphics) {
            this.background.clear();
            if (this.props.borderRadius && this.props.borderRadius > 0) {
                this.background.roundRect(0, 0, width, height, this.props.borderRadius);
            }
            else {
                this.background.rect(0, 0, width, height);
            }
            if (this.props.backgroundColor !== undefined) {
                this.background.fill({
                    color: this.props.backgroundColor,
                    alpha: this.props.backgroundAlpha
                });
            }
        }
    }
    setBackgroundColor(color, alpha = 1) {
        if (this.background instanceof pixi_js_1.default.Graphics) {
            this.props.backgroundColor = color;
            this.props.backgroundAlpha = alpha;
            this.render();
        }
    }
    setTexture(texture) {
        if (this.background instanceof pixi_js_1.default.NineSliceSprite) {
            this.background.texture = texture;
        }
    }
}
exports.UIPanel = UIPanel;


/***/ }),

/***/ "./src/ui/components/ui-scroll-container.ts":
/*!**************************************************!*\
  !*** ./src/ui/components/ui-scroll-container.ts ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIScrollContainer = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
class UIScrollContainer extends ui_component_1.UIComponent {
    props;
    background;
    contentContainer;
    contentMask;
    scrollbarTrack;
    scrollbarThumb;
    children = [];
    scrollY = 0;
    maxScrollY = 0;
    contentHeight = 0;
    isDragging = false;
    dragStartY = 0;
    dragStartScrollY = 0;
    isHoveringThumb = false;
    boundGlobalPointerMove = null;
    boundGlobalPointerUp = null;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            width: props.width,
            height: props.height,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            borderRadius: props.borderRadius ?? 0,
            scrollbarWidth: props.scrollbarWidth ?? 12,
            scrollbarTrackColor: props.scrollbarTrackColor ?? 0xe0e0e0,
            scrollbarThumbColor: props.scrollbarThumbColor ?? 0x888888,
            scrollbarThumbHoverColor: props.scrollbarThumbHoverColor ?? 0x555555,
            scrollbarAutoHide: props.scrollbarAutoHide ?? false,
            padding: props.padding ?? edge_insets_1.EdgeInsets.all(0)
        };
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new pixi_js_1.default.Graphics();
        this.updateBackground();
        this.container.addChild(this.background);
        this.contentContainer = new pixi_js_1.default.Container();
        this.contentContainer.x = this.props.padding.left;
        this.contentContainer.y = this.props.padding.top;
        this.container.addChild(this.contentContainer);
        this.contentMask = new pixi_js_1.default.Graphics();
        this.updateMask();
        this.container.addChild(this.contentMask);
        this.contentContainer.mask = this.contentMask;
        this.scrollbarTrack = new pixi_js_1.default.Graphics();
        this.scrollbarTrack.eventMode = 'static';
        this.scrollbarTrack.cursor = 'pointer';
        this.container.addChild(this.scrollbarTrack);
        this.scrollbarThumb = new pixi_js_1.default.Graphics();
        this.scrollbarThumb.eventMode = 'static';
        this.scrollbarThumb.cursor = 'pointer';
        this.container.addChild(this.scrollbarThumb);
        this.setupInteractivity();
        this.updateScrollbar();
    }
    updateBackground() {
        this.background.clear();
        this.background.roundRect(0, 0, this.props.width, this.props.height, this.props.borderRadius);
        this.background.fill({ color: this.props.backgroundColor });
    }
    updateMask() {
        const contentWidth = this.props.width - this.props.padding.left - this.props.padding.right - this.props.scrollbarWidth;
        const contentHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        this.contentMask.clear();
        this.contentMask.rect(this.props.padding.left, this.props.padding.top, contentWidth, contentHeight);
        this.contentMask.fill({ color: 0xffffff });
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.on('wheel', this.handleWheel.bind(this));
        this.scrollbarThumb.on('pointerdown', this.handleThumbPointerDown.bind(this));
        this.scrollbarThumb.on('pointerover', () => {
            this.isHoveringThumb = true;
            this.updateScrollbar();
        });
        this.scrollbarThumb.on('pointerout', () => {
            if (!this.isDragging) {
                this.isHoveringThumb = false;
                this.updateScrollbar();
            }
        });
        this.scrollbarTrack.on('pointerdown', this.handleTrackPointerDown.bind(this));
        if (typeof window !== 'undefined') {
            this.boundGlobalPointerMove = this.handleGlobalPointerMove.bind(this);
            this.boundGlobalPointerUp = this.handleGlobalPointerUp.bind(this);
            window.addEventListener('pointermove', this.boundGlobalPointerMove);
            window.addEventListener('pointerup', this.boundGlobalPointerUp);
        }
    }
    handleWheel(e) {
        e.preventDefault();
        const delta = e.deltaY;
        this.scrollY += delta;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleThumbPointerDown(e) {
        this.isDragging = true;
        this.dragStartY = e.globalY;
        this.dragStartScrollY = this.scrollY;
        e.stopPropagation();
    }
    handleTrackPointerDown(e) {
        const localY = e.globalY - this.container.worldTransform.ty;
        const thumbHeight = this.getThumbHeight();
        const trackTop = 0;
        const trackBottom = this.props.height;
        const clickRatio = (localY - trackTop) / (trackBottom - trackTop);
        this.scrollY = clickRatio * this.maxScrollY;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleGlobalPointerMove(e) {
        if (!this.isDragging)
            return;
        const deltaY = e.clientY - this.dragStartY;
        const trackHeight = this.props.height;
        const thumbHeight = this.getThumbHeight();
        const scrollableTrackHeight = trackHeight - thumbHeight;
        if (scrollableTrackHeight <= 0)
            return;
        const scrollDelta = (deltaY / scrollableTrackHeight) * this.maxScrollY;
        this.scrollY = this.dragStartScrollY + scrollDelta;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleGlobalPointerUp() {
        if (this.isDragging) {
            this.isDragging = false;
            if (!this.isHoveringThumb) {
                this.updateScrollbar();
            }
        }
    }
    updateContentPosition() {
        this.contentContainer.y = this.props.padding.top - this.scrollY;
    }
    getThumbHeight() {
        if (this.contentHeight <= 0)
            return 0;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        const ratio = viewportHeight / this.contentHeight;
        const thumbHeight = Math.max(30, this.props.height * ratio);
        return Math.min(thumbHeight, this.props.height);
    }
    getThumbY() {
        if (this.maxScrollY <= 0)
            return 0;
        const trackHeight = this.props.height;
        const thumbHeight = this.getThumbHeight();
        const scrollableTrackHeight = trackHeight - thumbHeight;
        const scrollRatio = this.scrollY / this.maxScrollY;
        return scrollRatio * scrollableTrackHeight;
    }
    updateScrollbar() {
        const trackX = this.props.width - this.props.scrollbarWidth;
        const trackWidth = this.props.scrollbarWidth;
        const trackHeight = this.props.height;
        this.scrollbarTrack.clear();
        this.scrollbarTrack.rect(trackX, 0, trackWidth, trackHeight);
        this.scrollbarTrack.fill({ color: this.props.scrollbarTrackColor });
        const thumbHeight = this.getThumbHeight();
        const thumbY = this.getThumbY();
        const thumbColor = (this.isHoveringThumb || this.isDragging)
            ? this.props.scrollbarThumbHoverColor
            : this.props.scrollbarThumbColor;
        this.scrollbarThumb.clear();
        if (this.maxScrollY > 0) {
            this.scrollbarThumb.roundRect(trackX + 2, thumbY + 2, trackWidth - 4, thumbHeight - 4, 4);
            this.scrollbarThumb.fill({ color: thumbColor });
            this.scrollbarThumb.visible = true;
        }
        else {
            this.scrollbarThumb.visible = false;
        }
        if (this.props.scrollbarAutoHide && !this.isDragging && !this.isHoveringThumb) {
            this.scrollbarTrack.alpha = 0;
            this.scrollbarThumb.alpha = 0;
        }
        else {
            this.scrollbarTrack.alpha = 1;
            this.scrollbarThumb.alpha = 1;
        }
    }
    updateContentBounds() {
        let maxHeight = 0;
        this.contentContainer.children.forEach((child) => {
            if (child && typeof child.y === 'number' && typeof child.height === 'number') {
                const childBottom = child.y + child.height;
                if (childBottom > maxHeight) {
                    maxHeight = childBottom;
                }
            }
        });
        this.contentHeight = maxHeight;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        this.maxScrollY = Math.max(0, this.contentHeight - viewportHeight);
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    addChild(child) {
        child.parent = this;
        this.children.push(child);
        this.contentContainer.addChild(child.container);
        const contentWidth = this.props.width - this.props.padding.left - this.props.padding.right - this.props.scrollbarWidth;
        const contentHeight = 999999;
        child.layout(contentWidth, contentHeight);
        this.updateContentBounds();
    }
    removeChild(child) {
        child.parent = undefined;
        const index = this.children.indexOf(child);
        if (index !== -1) {
            this.children.splice(index, 1);
        }
        this.contentContainer.removeChild(child.container);
        this.updateContentBounds();
    }
    scrollTo(y) {
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, y));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    scrollToTop() {
        this.scrollTo(0);
    }
    scrollToBottom() {
        this.scrollTo(this.maxScrollY);
    }
    getScrollY() {
        return this.scrollY;
    }
    getMaxScrollY() {
        return this.maxScrollY;
    }
    scrollToComponent(component) {
        const componentBounds = component.getGlobalBounds();
        const containerBounds = this.getGlobalBounds();
        const relativeY = componentBounds.y - containerBounds.y - this.props.padding.top + this.scrollY;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        if (relativeY < this.scrollY) {
            this.scrollTo(relativeY);
        }
        else if (relativeY + componentBounds.height > this.scrollY + viewportHeight) {
            const targetScroll = relativeY + componentBounds.height - viewportHeight;
            this.scrollTo(targetScroll);
        }
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.updateContentBounds();
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    destroy() {
        if (typeof window !== 'undefined') {
            if (this.boundGlobalPointerMove) {
                window.removeEventListener('pointermove', this.boundGlobalPointerMove);
                this.boundGlobalPointerMove = null;
            }
            if (this.boundGlobalPointerUp) {
                window.removeEventListener('pointerup', this.boundGlobalPointerUp);
                this.boundGlobalPointerUp = null;
            }
        }
        super.destroy();
    }
}
exports.UIScrollContainer = UIScrollContainer;


/***/ }),

/***/ "./src/ui/components/ui-select.ts":
/*!****************************************!*\
  !*** ./src/ui/components/ui-select.ts ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UISelect = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
class UISelect extends ui_component_1.UIComponent {
    props;
    onChange;
    selectedValue;
    background;
    label;
    dropdownContainer;
    dropdownPanel;
    optionLabels = [];
    isOpen = false;
    hoverColor;
    selectedColor;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            options: props.options ?? [],
            placeholder: props.placeholder ?? 'Select...',
            width: props.width ?? 200,
            height: props.height ?? 36,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            borderRadius: props.borderRadius ?? 4
        };
        this.onChange = props.onChange;
        this.selectedValue = props.value ?? props.defaultValue;
        this.hoverColor = this.darkenColor(this.props.backgroundColor, 0.95);
        this.selectedColor = this.darkenColor(this.props.backgroundColor, 0.9);
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        const displayText = this.getDisplayText();
        this.label = new ui_label_1.UILabel({
            text: displayText,
            fontSize: 14,
            color: this.selectedValue ? this.props.textColor : 0x999999,
            align: 'left'
        }, {
            padding: edge_insets_1.EdgeInsets.symmetric(8, 12)
        });
        this.container.addChild(this.label.container);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (!this.selectedValue) {
            return this.props.placeholder;
        }
        const option = this.props.options.find(opt => opt.value === this.selectedValue);
        return option ? option.label : this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'pointer';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
    }
    handlePointerDown() {
        if (this.props.disabled)
            return;
        if (this.isOpen) {
            this.closeDropdown();
        }
        else {
            this.openDropdown();
        }
    }
    openDropdown() {
        this.isOpen = true;
        this.dropdownContainer = new pixi_js_1.default.Container();
        this.dropdownContainer.position.set(0, this.props.height + 4);
        const dropdownHeight = Math.min(this.props.options.length * 32, 200);
        this.dropdownPanel = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: dropdownHeight,
            borderRadius: this.props.borderRadius
        });
        this.dropdownContainer.addChild(this.dropdownPanel.container);
        this.optionLabels = [];
        this.props.options.forEach((option, index) => {
            const optionContainer = new pixi_js_1.default.Container();
            optionContainer.position.set(0, index * 32);
            const optionBg = new pixi_js_1.default.Graphics();
            optionBg.rect(0, 0, this.props.width, 32);
            optionBg.fill({ color: this.props.backgroundColor, alpha: 0 });
            optionContainer.addChild(optionBg);
            const optionLabel = new ui_label_1.UILabel({
                text: option.label,
                fontSize: 14,
                color: option.disabled ? 0x999999 : this.props.textColor,
                align: 'left'
            }, {
                padding: edge_insets_1.EdgeInsets.symmetric(8, 12)
            });
            optionLabel.layout(this.props.width, 32);
            optionContainer.addChild(optionLabel.container);
            if (!option.disabled) {
                optionContainer.eventMode = 'static';
                optionContainer.cursor = 'pointer';
                optionContainer.on('pointerover', () => {
                    optionBg.clear();
                    optionBg.rect(0, 0, this.props.width, 32);
                    optionBg.fill({ color: this.hoverColor });
                });
                optionContainer.on('pointerout', () => {
                    optionBg.clear();
                    optionBg.rect(0, 0, this.props.width, 32);
                    optionBg.fill({ color: this.props.backgroundColor, alpha: 0 });
                });
                optionContainer.on('pointerdown', () => {
                    this.selectOption(option.value);
                });
            }
            this.dropdownContainer.addChild(optionContainer);
            this.optionLabels.push(optionLabel);
        });
        this.container.addChild(this.dropdownContainer);
        this.setupClickOutside();
    }
    closeDropdown() {
        this.isOpen = false;
        if (this.dropdownContainer) {
            this.container.removeChild(this.dropdownContainer);
            this.dropdownContainer = undefined;
            this.dropdownPanel = undefined;
            this.optionLabels = [];
        }
        this.removeClickOutside();
    }
    selectOption(value) {
        this.selectedValue = value;
        this.label.setText(this.getDisplayText());
        this.label.setColor(this.props.textColor);
        this.onChange?.(value);
        this.closeDropdown();
    }
    setupClickOutside() {
        const stage = this.container.parent;
        if (stage) {
            stage.eventMode = 'static';
            stage.once('pointerdown', (e) => {
                const point = e.global;
                const bounds = this.container.getBounds();
                if (point.x < bounds.x || point.x > bounds.x + bounds.width ||
                    point.y < bounds.y || point.y > bounds.y + bounds.height) {
                    this.closeDropdown();
                }
            });
        }
    }
    removeClickOutside() {
    }
    darkenColor(color, factor) {
        const r = ((color >> 16) & 0xff) * factor;
        const g = ((color >> 8) & 0xff) * factor;
        const b = (color & 0xff) * factor;
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.label.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.selectedValue = value;
        this.label.setText(this.getDisplayText());
        this.label.setColor(this.props.textColor);
    }
    getValue() {
        return this.selectedValue;
    }
    setOptions(options) {
        this.props.options = options;
        if (this.isOpen) {
            this.closeDropdown();
        }
    }
}
exports.UISelect = UISelect;


/***/ }),

/***/ "./src/ui/components/ui-tabs.ts":
/*!**************************************!*\
  !*** ./src/ui/components/ui-tabs.ts ***!
  \**************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITabs = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
class UITabs extends ui_component_1.UIComponent {
    items;
    activeKey;
    onChange;
    type;
    tabPosition;
    width;
    height;
    tabBarBackgroundColor;
    tabBarHeight;
    activeTabColor;
    inactiveTabColor;
    textColor;
    activeTextColor;
    hashPrefix;
    tabBar;
    contentArea;
    tabButtons = new Map();
    activeIndicator;
    hashChangeHandler;
    constructor(props, boxModel) {
        super(boxModel);
        this.items = props.items || [];
        this.onChange = props.onChange;
        this.type = props.type || 'line';
        this.tabPosition = props.tabPosition || 'top';
        this.tabBarBackgroundColor = props.tabBarBackgroundColor ?? 0x2d2d44;
        this.tabBarHeight = props.tabBarHeight ?? 48;
        this.activeTabColor = props.activeTabColor ?? 0x1890ff;
        this.inactiveTabColor = props.inactiveTabColor ?? 0x3d3d54;
        this.textColor = props.textColor ?? 0xaaaaaa;
        this.activeTextColor = props.activeTextColor ?? 0xffffff;
        this.hashPrefix = props.hashPrefix;
        let initialKey = props.activeKey || props.defaultActiveKey || (this.items.length > 0 ? this.items[0].key : '');
        if (this.hashPrefix && !props.activeKey) {
            const hashKey = this.getKeyFromHash();
            if (hashKey && this.items.find(item => item.key === hashKey)) {
                initialKey = hashKey;
            }
        }
        this.activeKey = initialKey;
        this.width = props.width ?? 800;
        this.height = props.height ?? 600;
        this.tabBar = new PIXI.Container();
        this.contentArea = new PIXI.Container();
        this.container.addChild(this.tabBar);
        this.container.addChild(this.contentArea);
        this.buildTabs();
        this.showActiveTab();
        if (this.hashPrefix) {
            this.setupHashListener();
            this.updateHash(this.activeKey);
        }
    }
    getKeyFromHash() {
        if (!this.hashPrefix)
            return null;
        const hash = window.location.hash.slice(1);
        const prefix = `${this.hashPrefix}/`;
        if (hash.startsWith(prefix)) {
            return hash.slice(prefix.length);
        }
        return null;
    }
    updateHash(key) {
        if (!this.hashPrefix)
            return;
        const newHash = `#${this.hashPrefix}/${key}`;
        if (window.location.hash !== newHash) {
            window.location.hash = newHash;
        }
    }
    setupHashListener() {
        this.hashChangeHandler = () => {
            const hashKey = this.getKeyFromHash();
            if (hashKey && hashKey !== this.activeKey) {
                this.setActiveKey(hashKey, false);
            }
        };
        window.addEventListener('hashchange', this.hashChangeHandler);
    }
    destroy() {
        if (this.hashChangeHandler) {
            window.removeEventListener('hashchange', this.hashChangeHandler);
        }
    }
    buildTabs() {
        this.tabBar.removeChildren();
        this.tabButtons.clear();
        const tabBarBg = new PIXI.Graphics();
        tabBarBg.rect(0, 0, this.width, this.tabBarHeight);
        tabBarBg.fill({ color: this.tabBarBackgroundColor });
        this.tabBar.addChild(tabBarBg);
        if (this.type === 'line') {
            const borderLine = new PIXI.Graphics();
            borderLine.rect(0, this.tabBarHeight - 2, this.width, 2);
            borderLine.fill({ color: 0x3d3d54, alpha: 0.5 });
            this.tabBar.addChild(borderLine);
        }
        if (this.tabPosition === 'bottom') {
            this.tabBar.y = this.height - this.tabBarHeight;
            this.contentArea.y = 0;
        }
        else {
            this.tabBar.y = 0;
            this.contentArea.y = this.tabBarHeight;
        }
        let xOffset = 8;
        const tabPadding = 24;
        const tabGap = 8;
        for (const item of this.items) {
            if (item.disabled)
                continue;
            const tabContainer = new PIXI.Container();
            tabContainer.x = xOffset;
            const isActive = this.activeKey === item.key;
            const label = new ui_label_1.UILabel({
                text: item.label,
                fontSize: 15,
                fontWeight: isActive ? 'bold' : 'normal',
                color: isActive ? this.activeTextColor : this.textColor
            });
            label.measure();
            label.layout(this.width, this.tabBarHeight);
            const labelBounds = label.container.getLocalBounds();
            const tabWidth = labelBounds.width + (tabPadding * 2);
            let bg;
            if (this.type === 'card') {
                bg = new PIXI.Graphics();
                bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                bg.fill({ color: isActive ? this.activeTabColor : this.inactiveTabColor });
                bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                bg.stroke({ color: isActive ? this.activeTabColor : 0x4d4d64, width: 2 });
                tabContainer.addChild(bg);
            }
            else {
                bg = new PIXI.Graphics();
                bg.rect(0, 0, tabWidth, this.tabBarHeight);
                bg.fill({ color: 0x000000, alpha: 0 });
                tabContainer.addChild(bg);
            }
            label.container.x = tabPadding;
            label.container.y = (this.tabBarHeight - labelBounds.height) / 2;
            tabContainer.addChild(label.container);
            tabContainer.eventMode = 'static';
            tabContainer.cursor = 'pointer';
            const tabKey = item.key;
            tabContainer.on('pointerdown', () => {
                this.setActiveKey(tabKey);
            });
            tabContainer.on('pointerover', () => {
                if (this.activeKey !== tabKey) {
                    if (this.type === 'card') {
                        bg.clear();
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.fill({ color: this.activeTabColor, alpha: 0.5 });
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.stroke({ color: this.activeTabColor, width: 2 });
                    }
                    else {
                        label.setColor(this.activeTextColor);
                    }
                }
            });
            tabContainer.on('pointerout', () => {
                if (this.activeKey !== tabKey) {
                    if (this.type === 'card') {
                        bg.clear();
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.fill({ color: this.inactiveTabColor });
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.stroke({ color: 0x4d4d64, width: 2 });
                    }
                    else {
                        label.setColor(this.textColor);
                    }
                }
            });
            this.tabBar.addChild(tabContainer);
            this.tabButtons.set(item.key, { container: tabContainer, label, bg });
            xOffset += tabWidth + tabGap;
        }
        if (this.type === 'line') {
            this.activeIndicator = new PIXI.Graphics();
            this.tabBar.addChild(this.activeIndicator);
            this.updateActiveIndicator();
        }
    }
    updateActiveIndicator() {
        if (!this.activeIndicator || this.type !== 'line')
            return;
        this.activeIndicator.clear();
        const activeTab = this.tabButtons.get(this.activeKey);
        if (!activeTab)
            return;
        const tabX = activeTab.container.x;
        const tabBounds = activeTab.bg.getLocalBounds();
        const tabWidth = tabBounds.width;
        const indicatorHeight = 3;
        const indicatorY = this.tabBarHeight - indicatorHeight;
        this.activeIndicator.roundRect(tabX + 8, indicatorY, tabWidth - 16, indicatorHeight, 1.5);
        this.activeIndicator.fill({ color: this.activeTabColor });
    }
    showActiveTab() {
        this.contentArea.removeChildren();
        const activeItem = this.items.find(item => item.key === this.activeKey);
        if (!activeItem)
            return;
        const contentHeight = this.height - this.tabBarHeight;
        activeItem.content.layout(this.width, contentHeight);
        this.contentArea.addChild(activeItem.content.container);
        this.tabButtons.forEach((tab, key) => {
            const isActive = key === this.activeKey;
            const tabBounds = tab.bg.getLocalBounds();
            if (this.type === 'card') {
                tab.bg.clear();
                tab.bg.roundRect(0, 0, tabBounds.width, this.tabBarHeight - 2, 6);
                tab.bg.fill({ color: isActive ? this.activeTabColor : this.inactiveTabColor });
                tab.bg.roundRect(0, 0, tabBounds.width, this.tabBarHeight - 2, 6);
                tab.bg.stroke({ color: isActive ? this.activeTabColor : 0x4d4d64, width: 2 });
            }
            else {
                tab.bg.clear();
                tab.bg.rect(0, 0, tabBounds.width, this.tabBarHeight);
                tab.bg.fill({ color: 0x000000, alpha: 0 });
            }
            tab.label.setColor(isActive ? this.activeTextColor : this.textColor);
            tab.label.container.alpha = 1;
        });
        if (this.type === 'line') {
            this.updateActiveIndicator();
        }
    }
    setActiveKey(key, updateHash = true) {
        if (this.activeKey === key)
            return;
        const item = this.items.find(item => item.key === key);
        if (!item || item.disabled)
            return;
        this.activeKey = key;
        this.showActiveTab();
        if (updateHash && this.hashPrefix) {
            this.updateHash(key);
        }
        if (this.onChange) {
            this.onChange(key);
        }
    }
    getActiveKey() {
        return this.activeKey;
    }
    setItems(items) {
        this.items = items;
        if (!this.items.find(item => item.key === this.activeKey)) {
            this.activeKey = this.items.length > 0 ? this.items[0].key : '';
        }
        this.buildTabs();
        this.showActiveTab();
    }
    measure() {
        return {
            width: this.width,
            height: this.height
        };
    }
    layout(width, height) {
        this.width = width;
        this.height = height;
        this.buildTabs();
        this.showActiveTab();
    }
    render() {
    }
}
exports.UITabs = UITabs;


/***/ }),

/***/ "./src/ui/components/ui-text-input.ts":
/*!********************************************!*\
  !*** ./src/ui/components/ui-text-input.ts ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITextInput = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
class UITextInput extends ui_component_1.UIComponent {
    props;
    onChange;
    currentValue;
    background;
    textDisplay;
    cursor;
    cursorPosition = 0;
    cursorBlinkInterval;
    cursorVisible = true;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            placeholder: props.placeholder ?? '',
            maxLength: props.maxLength ?? 100,
            width: props.width ?? 200,
            height: props.height ?? 36,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            placeholderColor: props.placeholderColor ?? 0x999999,
            borderRadius: props.borderRadius ?? 4,
            fontSize: props.fontSize ?? 14,
            type: props.type ?? 'text'
        };
        this.onChange = props.onChange;
        this.currentValue = props.value ?? props.defaultValue ?? '';
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        this.textDisplay = new pixi_js_1.default.Text({
            text: this.getDisplayText(),
            style: {
                fontFamily: 'Arial',
                fontSize: this.props.fontSize,
                fill: this.currentValue ? this.props.textColor : this.props.placeholderColor,
                align: 'left'
            },
            resolution: window.devicePixelRatio || 2
        });
        this.textDisplay.position.set(12, (this.props.height - this.props.fontSize) / 2);
        this.container.addChild(this.textDisplay);
        this.cursor = new pixi_js_1.default.Graphics();
        this.cursor.visible = false;
        this.container.addChild(this.cursor);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (this.currentValue) {
            return this.currentValue;
        }
        return this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'text';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        if (typeof window !== 'undefined') {
            window.addEventListener('keydown', this.handleKeyDown.bind(this));
        }
    }
    handlePointerDown(e) {
        if (this.props.disabled)
            return;
        const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
        if (focusManager) {
            focusManager.requestFocus(this);
        }
        else {
            this.onFocus();
        }
        e.stopPropagation();
    }
    onFocus() {
        if (this.focused)
            return;
        super.onFocus();
        this.cursorPosition = this.currentValue.length;
        this.cursor.visible = true;
        this.updateCursor();
        this.startCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.lightenColor(this.props.backgroundColor, 0.95),
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    onBlur() {
        if (!this.focused)
            return;
        super.onBlur();
        this.cursor.visible = false;
        this.stopCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    handleKeyDown(e) {
        if (!this.focused || this.props.disabled)
            return;
        e.preventDefault();
        e.stopPropagation();
        const key = e.key;
        if (key === 'Enter') {
            this.onBlur();
            return;
        }
        if (key === 'Escape') {
            this.onBlur();
            return;
        }
        if (key === 'Backspace') {
            if (this.cursorPosition > 0) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition - 1) +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition--;
                this.updateText();
            }
            return;
        }
        if (key === 'Delete') {
            if (this.cursorPosition < this.currentValue.length) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        this.currentValue.substring(this.cursorPosition + 1);
                this.updateText();
            }
            return;
        }
        if (key === 'ArrowLeft') {
            if (this.cursorPosition > 0) {
                this.cursorPosition--;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowRight') {
            if (this.cursorPosition < this.currentValue.length) {
                this.cursorPosition++;
                this.updateCursor();
            }
            return;
        }
        if (key === 'Home') {
            this.cursorPosition = 0;
            this.updateCursor();
            return;
        }
        if (key === 'End') {
            this.cursorPosition = this.currentValue.length;
            this.updateCursor();
            return;
        }
        if (key.length === 1 && !e.ctrlKey && !e.metaKey) {
            if (this.props.type === 'number' && !/[0-9.-]/.test(key)) {
                return;
            }
            if (this.currentValue.length >= this.props.maxLength) {
                return;
            }
            this.currentValue =
                this.currentValue.substring(0, this.cursorPosition) +
                    key +
                    this.currentValue.substring(this.cursorPosition);
            this.cursorPosition++;
            this.updateText();
        }
    }
    updateText() {
        this.textDisplay.text = this.getDisplayText();
        this.textDisplay.style.fill = this.currentValue ? this.props.textColor : this.props.placeholderColor;
        this.updateCursor();
        this.onChange?.(this.currentValue);
    }
    updateCursor() {
        const textUpToCursor = this.currentValue.substring(0, this.cursorPosition);
        const tempText = new pixi_js_1.default.Text({
            text: textUpToCursor,
            style: this.textDisplay.style
        });
        const cursorX = 12 + tempText.width;
        const cursorY = (this.props.height - this.props.fontSize) / 2;
        this.cursor.clear();
        this.cursor.rect(cursorX, cursorY, 1, this.props.fontSize);
        this.cursor.fill({ color: this.props.textColor });
        tempText.destroy();
    }
    startCursorBlink() {
        this.stopCursorBlink();
        this.cursorVisible = true;
        this.cursorBlinkInterval = window.setInterval(() => {
            this.cursorVisible = !this.cursorVisible;
            this.cursor.visible = this.cursorVisible;
        }, 530);
    }
    stopCursorBlink() {
        if (this.cursorBlinkInterval) {
            window.clearInterval(this.cursorBlinkInterval);
            this.cursorBlinkInterval = undefined;
        }
    }
    lightenColor(color, factor) {
        const r = Math.min(255, ((color >> 16) & 0xff) / factor);
        const g = Math.min(255, ((color >> 8) & 0xff) / factor);
        const b = Math.min(255, (color & 0xff) / factor);
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.currentValue = value;
        this.cursorPosition = value.length;
        this.updateText();
    }
    getValue() {
        return this.currentValue;
    }
    destroy() {
        this.stopCursorBlink();
        if (typeof window !== 'undefined') {
            window.removeEventListener('keydown', this.handleKeyDown.bind(this));
        }
        super.destroy();
    }
}
exports.UITextInput = UITextInput;


/***/ }),

/***/ "./src/ui/components/ui-textarea.ts":
/*!******************************************!*\
  !*** ./src/ui/components/ui-textarea.ts ***!
  \******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITextArea = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
class UITextArea extends ui_component_1.UIComponent {
    props;
    onChange;
    currentValue;
    background;
    textDisplay;
    cursor;
    cursorPosition = 0;
    cursorBlinkInterval;
    cursorVisible = true;
    constructor(props, boxModel) {
        super(boxModel);
        const defaultHeight = (props.rows ?? 4) * (props.fontSize ?? 14) * (props.lineHeight ?? 1.5) + 24;
        this.props = {
            placeholder: props.placeholder ?? '',
            maxLength: props.maxLength ?? 1000,
            width: props.width ?? 400,
            height: props.height ?? defaultHeight,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            placeholderColor: props.placeholderColor ?? 0x999999,
            borderRadius: props.borderRadius ?? 4,
            fontSize: props.fontSize ?? 14,
            lineHeight: props.lineHeight ?? 1.5,
            rows: props.rows ?? 4
        };
        this.onChange = props.onChange;
        this.currentValue = props.value ?? props.defaultValue ?? '';
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        this.textDisplay = new pixi_js_1.default.Text({
            text: this.getDisplayText(),
            style: {
                fontFamily: 'Arial',
                fontSize: this.props.fontSize,
                fill: this.currentValue ? this.props.textColor : this.props.placeholderColor,
                align: 'left',
                wordWrap: true,
                wordWrapWidth: this.props.width - 24,
                lineHeight: this.props.fontSize * this.props.lineHeight
            },
            resolution: window.devicePixelRatio || 2
        });
        this.textDisplay.position.set(12, 12);
        this.container.addChild(this.textDisplay);
        this.cursor = new pixi_js_1.default.Graphics();
        this.cursor.visible = false;
        this.container.addChild(this.cursor);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (this.currentValue) {
            return this.currentValue;
        }
        return this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'text';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        if (typeof window !== 'undefined') {
            window.addEventListener('keydown', this.handleKeyDown.bind(this));
        }
    }
    handlePointerDown(e) {
        if (this.props.disabled)
            return;
        const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
        if (focusManager) {
            focusManager.requestFocus(this);
        }
        else {
            this.onFocus();
        }
        e.stopPropagation();
    }
    onFocus() {
        if (this.focused)
            return;
        super.onFocus();
        this.cursorPosition = this.currentValue.length;
        this.cursor.visible = true;
        this.updateCursor();
        this.startCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.lightenColor(this.props.backgroundColor, 0.95),
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    onBlur() {
        if (!this.focused)
            return;
        super.onBlur();
        this.cursor.visible = false;
        this.stopCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    handleKeyDown(e) {
        if (!this.focused || this.props.disabled)
            return;
        if (e.key !== 'Tab') {
            e.preventDefault();
            e.stopPropagation();
        }
        const key = e.key;
        if (key === 'Enter') {
            if (this.currentValue.length < this.props.maxLength) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        '\n' +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition++;
                this.updateText();
            }
            return;
        }
        if (key === 'Escape') {
            this.onBlur();
            return;
        }
        if (key === 'Backspace') {
            if (this.cursorPosition > 0) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition - 1) +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition--;
                this.updateText();
            }
            return;
        }
        if (key === 'Delete') {
            if (this.cursorPosition < this.currentValue.length) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        this.currentValue.substring(this.cursorPosition + 1);
                this.updateText();
            }
            return;
        }
        if (key === 'ArrowLeft') {
            if (this.cursorPosition > 0) {
                this.cursorPosition--;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowRight') {
            if (this.cursorPosition < this.currentValue.length) {
                this.cursorPosition++;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowUp') {
            this.moveCursorVertically(-1);
            return;
        }
        if (key === 'ArrowDown') {
            this.moveCursorVertically(1);
            return;
        }
        if (key === 'Home') {
            const lineStart = this.currentValue.lastIndexOf('\n', this.cursorPosition - 1) + 1;
            this.cursorPosition = lineStart;
            this.updateCursor();
            return;
        }
        if (key === 'End') {
            let lineEnd = this.currentValue.indexOf('\n', this.cursorPosition);
            if (lineEnd === -1)
                lineEnd = this.currentValue.length;
            this.cursorPosition = lineEnd;
            this.updateCursor();
            return;
        }
        if (key.length === 1 && !e.ctrlKey && !e.metaKey) {
            if (this.currentValue.length >= this.props.maxLength) {
                return;
            }
            this.currentValue =
                this.currentValue.substring(0, this.cursorPosition) +
                    key +
                    this.currentValue.substring(this.cursorPosition);
            this.cursorPosition++;
            this.updateText();
        }
    }
    moveCursorVertically(direction) {
        const lines = this.currentValue.split('\n');
        let currentLine = 0;
        let positionInLine = 0;
        let charCount = 0;
        for (let i = 0; i < lines.length; i++) {
            if (charCount + lines[i].length >= this.cursorPosition) {
                currentLine = i;
                positionInLine = this.cursorPosition - charCount;
                break;
            }
            charCount += lines[i].length + 1;
        }
        const targetLine = Math.max(0, Math.min(lines.length - 1, currentLine + direction));
        if (targetLine === currentLine)
            return;
        let newPosition = 0;
        for (let i = 0; i < targetLine; i++) {
            newPosition += lines[i].length + 1;
        }
        newPosition += Math.min(positionInLine, lines[targetLine].length);
        this.cursorPosition = newPosition;
        this.updateCursor();
    }
    updateText() {
        this.textDisplay.text = this.getDisplayText();
        this.textDisplay.style.fill = this.currentValue ? this.props.textColor : this.props.placeholderColor;
        this.updateCursor();
        this.onChange?.(this.currentValue);
    }
    updateCursor() {
        const textUpToCursor = this.currentValue.substring(0, this.cursorPosition);
        const tempText = new pixi_js_1.default.Text({
            text: textUpToCursor,
            style: {
                ...this.textDisplay.style,
                wordWrap: true,
                wordWrapWidth: this.props.width - 24
            }
        });
        const metrics = tempText.getLocalBounds();
        const lines = textUpToCursor.split('\n');
        const lastLine = lines[lines.length - 1];
        const lastLineText = new pixi_js_1.default.Text({
            text: lastLine,
            style: this.textDisplay.style
        });
        const cursorX = 12 + lastLineText.width;
        const cursorY = 12 + (lines.length - 1) * (this.props.fontSize * this.props.lineHeight);
        this.cursor.clear();
        this.cursor.rect(cursorX, cursorY, 1, this.props.fontSize);
        this.cursor.fill({ color: this.props.textColor });
        tempText.destroy();
        lastLineText.destroy();
    }
    startCursorBlink() {
        this.stopCursorBlink();
        this.cursorVisible = true;
        this.cursorBlinkInterval = window.setInterval(() => {
            this.cursorVisible = !this.cursorVisible;
            this.cursor.visible = this.cursorVisible;
        }, 530);
    }
    stopCursorBlink() {
        if (this.cursorBlinkInterval) {
            window.clearInterval(this.cursorBlinkInterval);
            this.cursorBlinkInterval = undefined;
        }
    }
    lightenColor(color, factor) {
        const r = Math.min(255, ((color >> 16) & 0xff) / factor);
        const g = Math.min(255, ((color >> 8) & 0xff) / factor);
        const b = Math.min(255, (color & 0xff) / factor);
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.currentValue = value;
        this.cursorPosition = value.length;
        this.updateText();
    }
    getValue() {
        return this.currentValue;
    }
    destroy() {
        this.stopCursorBlink();
        if (typeof window !== 'undefined') {
            window.removeEventListener('keydown', this.handleKeyDown.bind(this));
        }
        super.destroy();
    }
}
exports.UITextArea = UITextArea;


/***/ }),

/***/ "./src/ui/core/box-model.ts":
/*!**********************************!*\
  !*** ./src/ui/core/box-model.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createDefaultBoxModel = createDefaultBoxModel;
const edge_insets_1 = __webpack_require__(/*! ./edge-insets */ "./src/ui/core/edge-insets.ts");
function createDefaultBoxModel(overrides) {
    return {
        width: 'auto',
        height: 'auto',
        padding: edge_insets_1.EdgeInsets.zero(),
        margin: edge_insets_1.EdgeInsets.zero(),
        ...overrides
    };
}


/***/ }),

/***/ "./src/ui/core/edge-insets.ts":
/*!************************************!*\
  !*** ./src/ui/core/edge-insets.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.EdgeInsets = void 0;
class EdgeInsets {
    top;
    right;
    bottom;
    left;
    constructor(top, right, bottom, left) {
        this.top = top;
        this.right = right;
        this.bottom = bottom;
        this.left = left;
    }
    static all(value) {
        return new EdgeInsets(value, value, value, value);
    }
    static symmetric(vertical, horizontal) {
        return new EdgeInsets(vertical, horizontal, vertical, horizontal);
    }
    static only(edges) {
        return new EdgeInsets(edges.top ?? 0, edges.right ?? 0, edges.bottom ?? 0, edges.left ?? 0);
    }
    static zero() {
        return new EdgeInsets(0, 0, 0, 0);
    }
    get horizontal() {
        return this.left + this.right;
    }
    get vertical() {
        return this.top + this.bottom;
    }
    clone() {
        return new EdgeInsets(this.top, this.right, this.bottom, this.left);
    }
}
exports.EdgeInsets = EdgeInsets;


/***/ }),

/***/ "./src/ui/core/ui-component.ts":
/*!*************************************!*\
  !*** ./src/ui/core/ui-component.ts ***!
  \*************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIComponent = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const box_model_1 = __webpack_require__(/*! ./box-model */ "./src/ui/core/box-model.ts");
class UIComponent {
    container;
    boxModel;
    focusRing;
    computedLayout;
    parent;
    visible = true;
    enabled = true;
    layoutDirty = true;
    tabIndex = -1;
    focused = false;
    constructor(boxModel) {
        this.container = new pixi_js_1.default.Container();
        this.boxModel = (0, box_model_1.createDefaultBoxModel)(boxModel);
        this.computedLayout = {
            x: 0,
            y: 0,
            width: 0,
            height: 0,
            contentX: 0,
            contentY: 0,
            contentWidth: 0,
            contentHeight: 0
        };
        this.createFocusRing();
    }
    createFocusRing() {
        this.focusRing = new pixi_js_1.default.Graphics();
        this.focusRing.visible = false;
        this.container.addChildAt(this.focusRing, 0);
    }
    updateFocusRing() {
        if (!this.focusRing)
            return;
        this.focusRing.clear();
        const width = this.computedLayout.width;
        const height = this.computedLayout.height;
        if (width <= 0 || height <= 0)
            return;
        const offset = 4;
        const strokeWidth = 3;
        this.focusRing.roundRect(-offset - 2, -offset - 2, width + (offset + 2) * 2, height + (offset + 2) * 2, 8);
        this.focusRing.stroke({
            color: 0x00d9ff,
            width: strokeWidth + 2,
            alpha: 0.3
        });
        this.focusRing.roundRect(-offset, -offset, width + offset * 2, height + offset * 2, 8);
        this.focusRing.stroke({
            color: 0x00d9ff,
            width: strokeWidth
        });
        this.focusRing.roundRect(-offset + strokeWidth, -offset + strokeWidth, width + (offset - strokeWidth) * 2, height + (offset - strokeWidth) * 2, 6);
        this.focusRing.stroke({
            color: 0xffffff,
            width: 1,
            alpha: 0.6
        });
    }
    markLayoutDirty() {
        this.layoutDirty = true;
        if (this.parent) {
            this.parent.markLayoutDirty();
        }
    }
    getLayout() {
        return this.computedLayout;
    }
    getBoxModel() {
        return this.boxModel;
    }
    getGlobalBounds() {
        const globalPos = this.container.getGlobalPosition();
        return {
            x: globalPos.x,
            y: globalPos.y,
            width: this.computedLayout.width,
            height: this.computedLayout.height
        };
    }
    setPosition(x, y) {
        this.computedLayout.x = x;
        this.computedLayout.y = y;
        this.container.position.set(x, y);
    }
    show() {
        this.visible = true;
        this.container.visible = true;
    }
    hide() {
        this.visible = false;
        this.container.visible = false;
    }
    canFocus() {
        return this.enabled && this.visible && this.tabIndex >= 0;
    }
    isFocused() {
        return this.focused;
    }
    onFocus() {
        this.focused = true;
        this.showFocusRing();
        this.scrollIntoView();
    }
    showFocusRing() {
        if (this.focusRing) {
            this.updateFocusRing();
            this.focusRing.visible = true;
        }
    }
    scrollIntoView() {
        let currentParent = this.parent;
        while (currentParent) {
            if ('scrollToComponent' in currentParent && typeof currentParent.scrollToComponent === 'function') {
                currentParent.scrollToComponent(this);
                break;
            }
            currentParent = currentParent.parent;
        }
    }
    onBlur() {
        this.focused = false;
        this.hideFocusRing();
    }
    hideFocusRing() {
        if (this.focusRing) {
            this.focusRing.visible = false;
        }
    }
    destroy() {
        this.container.destroy({ children: true });
    }
}
exports.UIComponent = UIComponent;


/***/ }),

/***/ "./src/ui/core/ui-focus-manager.ts":
/*!*****************************************!*\
  !*** ./src/ui/core/ui-focus-manager.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIFocusManager = void 0;
class UIFocusManager {
    static instance = null;
    focusableComponents = [];
    currentFocusIndex = -1;
    keydownHandler = null;
    constructor() {
        this.setupKeyboardListeners();
        UIFocusManager.instance = this;
    }
    static getInstance() {
        return UIFocusManager.instance;
    }
    setupKeyboardListeners() {
        if (typeof window === 'undefined')
            return;
        if (this.keydownHandler) {
            window.removeEventListener('keydown', this.keydownHandler);
        }
        this.keydownHandler = (e) => {
            if (e.key === 'Tab') {
                e.preventDefault();
                if (e.shiftKey) {
                    this.focusPrevious();
                }
                else {
                    this.focusNext();
                }
            }
        };
        window.addEventListener('keydown', this.keydownHandler);
    }
    register(component) {
        if (!this.focusableComponents.includes(component)) {
            this.focusableComponents.push(component);
            this.sortByTabIndex();
        }
    }
    registerContainer(container) {
        this.discoverFocusableComponents(container);
        this.sortByTabIndex();
    }
    discoverFocusableComponents(component) {
        if (this.isFocusableComponent(component)) {
            this.register(component);
        }
        if ('children' in component && Array.isArray(component.children)) {
            const children = component.children;
            children.forEach(child => this.discoverFocusableComponents(child));
        }
    }
    isFocusableComponent(component) {
        return (typeof component.tabIndex === 'number' &&
            component.tabIndex >= 0 &&
            typeof component.canFocus === 'function' &&
            typeof component.onFocus === 'function' &&
            typeof component.onBlur === 'function' &&
            typeof component.isFocused === 'function');
    }
    unregister(component) {
        const index = this.focusableComponents.indexOf(component);
        if (index !== -1) {
            if (index === this.currentFocusIndex) {
                this.blur();
            }
            this.focusableComponents.splice(index, 1);
            if (this.currentFocusIndex > index) {
                this.currentFocusIndex--;
            }
        }
    }
    sortByTabIndex() {
        this.focusableComponents.sort((a, b) => a.tabIndex - b.tabIndex);
    }
    focus(component) {
        if (!component.canFocus()) {
            return;
        }
        const index = this.focusableComponents.indexOf(component);
        if (index === -1) {
            return;
        }
        if (this.currentFocusIndex !== -1 && this.currentFocusIndex !== index) {
            const current = this.focusableComponents[this.currentFocusIndex];
            if (current) {
                current.onBlur();
            }
        }
        this.currentFocusIndex = index;
        component.onFocus();
    }
    requestFocus(component) {
        this.focus(component);
    }
    blur() {
        if (this.currentFocusIndex !== -1) {
            const current = this.focusableComponents[this.currentFocusIndex];
            if (current) {
                current.onBlur();
            }
            this.currentFocusIndex = -1;
        }
    }
    focusNext() {
        if (this.focusableComponents.length === 0)
            return;
        let nextIndex = this.currentFocusIndex + 1;
        let attempts = 0;
        while (attempts < this.focusableComponents.length) {
            if (nextIndex >= this.focusableComponents.length) {
                nextIndex = 0;
            }
            const component = this.focusableComponents[nextIndex];
            if (component && component.canFocus()) {
                this.focus(component);
                return;
            }
            nextIndex++;
            attempts++;
        }
    }
    focusPrevious() {
        if (this.focusableComponents.length === 0)
            return;
        let prevIndex = this.currentFocusIndex - 1;
        let attempts = 0;
        while (attempts < this.focusableComponents.length) {
            if (prevIndex < 0) {
                prevIndex = this.focusableComponents.length - 1;
            }
            const component = this.focusableComponents[prevIndex];
            if (component && component.canFocus()) {
                this.focus(component);
                return;
            }
            prevIndex--;
            attempts++;
        }
    }
    focusFirst() {
        if (this.focusableComponents.length === 0)
            return;
        for (const component of this.focusableComponents) {
            if (component.canFocus()) {
                this.focus(component);
                return;
            }
        }
    }
    focusLast() {
        if (this.focusableComponents.length === 0)
            return;
        for (let i = this.focusableComponents.length - 1; i >= 0; i--) {
            const component = this.focusableComponents[i];
            if (component.canFocus()) {
                this.focus(component);
                return;
            }
        }
    }
    getCurrentFocus() {
        if (this.currentFocusIndex === -1)
            return null;
        return this.focusableComponents[this.currentFocusIndex] || null;
    }
    getFocusableComponents() {
        return [...this.focusableComponents];
    }
    clear() {
        this.blur();
        this.focusableComponents = [];
        this.currentFocusIndex = -1;
    }
    destroy() {
        if (typeof window !== 'undefined' && this.keydownHandler) {
            window.removeEventListener('keydown', this.keydownHandler);
        }
        this.clear();
    }
}
exports.UIFocusManager = UIFocusManager;


/***/ }),

/***/ "./src/ui/layout/flex-container.ts":
/*!*****************************************!*\
  !*** ./src/ui/layout/flex-container.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.FlexContainer = exports.FlexAlign = exports.FlexJustify = exports.FlexDirection = void 0;
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
var FlexDirection;
(function (FlexDirection) {
    FlexDirection["Row"] = "row";
    FlexDirection["RowReverse"] = "row-reverse";
    FlexDirection["Column"] = "column";
    FlexDirection["ColumnReverse"] = "column-reverse";
})(FlexDirection || (exports.FlexDirection = FlexDirection = {}));
var FlexJustify;
(function (FlexJustify) {
    FlexJustify["Start"] = "start";
    FlexJustify["End"] = "end";
    FlexJustify["Center"] = "center";
    FlexJustify["SpaceBetween"] = "space-between";
    FlexJustify["SpaceAround"] = "space-around";
    FlexJustify["SpaceEvenly"] = "space-evenly";
})(FlexJustify || (exports.FlexJustify = FlexJustify = {}));
var FlexAlign;
(function (FlexAlign) {
    FlexAlign["Start"] = "start";
    FlexAlign["End"] = "end";
    FlexAlign["Center"] = "center";
    FlexAlign["Stretch"] = "stretch";
})(FlexAlign || (exports.FlexAlign = FlexAlign = {}));
class FlexContainer extends ui_component_1.UIComponent {
    props;
    children = [];
    constructor(props = {}) {
        const boxModel = {
            padding: props.padding ?? edge_insets_1.EdgeInsets.zero(),
            width: props.width ?? 'auto',
            height: props.height ?? 'auto'
        };
        super(boxModel);
        this.props = {
            direction: props.direction ?? FlexDirection.Row,
            justify: props.justify ?? FlexJustify.Start,
            align: props.align ?? FlexAlign.Start,
            gap: props.gap ?? 0,
            wrap: props.wrap ?? false
        };
    }
    addChild(child) {
        child.parent = this;
        this.children.push(child);
        this.container.addChild(child.container);
        this.markLayoutDirty();
    }
    removeChild(child) {
        const index = this.children.indexOf(child);
        if (index !== -1) {
            this.children.splice(index, 1);
            this.container.removeChild(child.container);
            child.parent = undefined;
            this.markLayoutDirty();
        }
    }
    measure() {
        if (this.children.length === 0) {
            const padding = this.boxModel.padding;
            return {
                width: padding.horizontal,
                height: padding.vertical
            };
        }
        const childSizes = this.children.map(child => child.measure());
        const { direction, gap } = this.props;
        const padding = this.boxModel.padding;
        const isRow = direction === FlexDirection.Row || direction === FlexDirection.RowReverse;
        const totalGap = gap * (this.children.length - 1);
        let measuredWidth = 0;
        let measuredHeight = 0;
        if (isRow) {
            measuredWidth = childSizes.reduce((sum, size) => sum + size.width, 0) + totalGap;
            measuredHeight = Math.max(...childSizes.map(size => size.height));
        }
        else {
            measuredWidth = Math.max(...childSizes.map(size => size.width));
            measuredHeight = childSizes.reduce((sum, size) => sum + size.height, 0) + totalGap;
        }
        return {
            width: measuredWidth + padding.horizontal,
            height: measuredHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const padding = this.boxModel.padding;
        const { direction, justify, align, gap } = this.props;
        let containerWidth;
        let containerHeight;
        if (this.boxModel.width === 'fill') {
            containerWidth = availableWidth;
        }
        else if (typeof this.boxModel.width === 'number') {
            containerWidth = this.boxModel.width;
        }
        else {
            const measured = this.measure();
            containerWidth = measured.width;
        }
        if (this.boxModel.height === 'fill') {
            containerHeight = availableHeight;
        }
        else if (typeof this.boxModel.height === 'number') {
            containerHeight = this.boxModel.height;
        }
        else {
            const measured = this.measure();
            containerHeight = measured.height;
        }
        this.computedLayout.width = containerWidth;
        this.computedLayout.height = containerHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = containerWidth - padding.horizontal;
        this.computedLayout.contentHeight = containerHeight - padding.vertical;
        if (this.children.length > 0) {
            this.layoutChildren();
        }
        this.layoutDirty = false;
        this.render();
    }
    layoutChildren() {
        const { direction, justify, align, gap } = this.props;
        const padding = this.boxModel.padding;
        const contentWidth = this.computedLayout.contentWidth;
        const contentHeight = this.computedLayout.contentHeight;
        const isRow = direction === FlexDirection.Row || direction === FlexDirection.RowReverse;
        const childSizes = this.children.map(child => child.measure());
        const totalGap = gap * (this.children.length - 1);
        const totalChildSize = isRow
            ? childSizes.reduce((sum, size) => sum + size.width, 0)
            : childSizes.reduce((sum, size) => sum + size.height, 0);
        const mainAxisSize = isRow ? contentWidth : contentHeight;
        const crossAxisSize = isRow ? contentHeight : contentWidth;
        const freeSpace = mainAxisSize - totalChildSize - totalGap;
        let mainAxisOffset = 0;
        let spaceBetween = 0;
        switch (justify) {
            case FlexJustify.Start:
                mainAxisOffset = 0;
                break;
            case FlexJustify.End:
                mainAxisOffset = freeSpace;
                break;
            case FlexJustify.Center:
                mainAxisOffset = freeSpace / 2;
                break;
            case FlexJustify.SpaceBetween:
                spaceBetween = this.children.length > 1 ? freeSpace / (this.children.length - 1) : 0;
                break;
            case FlexJustify.SpaceAround:
                spaceBetween = freeSpace / this.children.length;
                mainAxisOffset = spaceBetween / 2;
                break;
            case FlexJustify.SpaceEvenly:
                spaceBetween = freeSpace / (this.children.length + 1);
                mainAxisOffset = spaceBetween;
                break;
        }
        let currentPosition = mainAxisOffset;
        this.children.forEach((child, index) => {
            const childSize = childSizes[index];
            child.layout(childSize.width, childSize.height);
            let crossAxisPosition = 0;
            switch (align) {
                case FlexAlign.Start:
                    crossAxisPosition = 0;
                    break;
                case FlexAlign.End:
                    crossAxisPosition = crossAxisSize - (isRow ? childSize.height : childSize.width);
                    break;
                case FlexAlign.Center:
                    crossAxisPosition = (crossAxisSize - (isRow ? childSize.height : childSize.width)) / 2;
                    break;
                case FlexAlign.Stretch:
                    crossAxisPosition = 0;
                    break;
            }
            if (isRow) {
                child.setPosition(padding.left + currentPosition, padding.top + crossAxisPosition);
                currentPosition += childSize.width + gap + spaceBetween;
            }
            else {
                child.setPosition(padding.left + crossAxisPosition, padding.top + currentPosition);
                currentPosition += childSize.height + gap + spaceBetween;
            }
        });
    }
    render() {
    }
}
exports.FlexContainer = FlexContainer;


/***/ }),

/***/ "./src/ui/pixel-grid.ts":
/*!******************************!*\
  !*** ./src/ui/pixel-grid.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.BORDER = exports.GRID = exports.units = exports.px = exports.DEFAULT_PIXEL_GRID = exports.PixelGrid = void 0;
exports.createBorderConfig = createBorderConfig;
class PixelGrid {
    unit;
    scale;
    border;
    padding;
    gap;
    margin;
    fontScale;
    constructor(config = {}) {
        this.unit = config.unit ?? 1;
        this.scale = config.scale ?? 4;
        this.border = config.border ?? 1;
        this.padding = config.padding ?? 1;
        this.gap = config.gap ?? 1;
        this.margin = config.margin ?? 5;
        this.fontScale = config.fontScale ?? (this.scale / 16);
    }
    px(units) {
        return units * this.unit * this.scale;
    }
    units(pixels) {
        return Math.round(pixels / (this.unit * this.scale));
    }
}
exports.PixelGrid = PixelGrid;
exports.DEFAULT_PIXEL_GRID = (() => {
    const tempScale = typeof localStorage !== 'undefined'
        ? localStorage.getItem('temp-grid-scale')
        : null;
    if (tempScale) {
        const scale = parseInt(tempScale, 10);
        if (!isNaN(scale) && scale >= 1 && scale <= 4) {
            return new PixelGrid({ scale });
        }
    }
    return new PixelGrid();
})();
const px = (units) => exports.DEFAULT_PIXEL_GRID.px(units);
exports.px = px;
const units = (pixels) => exports.DEFAULT_PIXEL_GRID.units(pixels);
exports.units = units;
exports.GRID = {
    unit: exports.DEFAULT_PIXEL_GRID.unit,
    scale: exports.DEFAULT_PIXEL_GRID.scale,
    border: exports.DEFAULT_PIXEL_GRID.border,
    padding: exports.DEFAULT_PIXEL_GRID.padding,
    gap: exports.DEFAULT_PIXEL_GRID.gap,
    margin: exports.DEFAULT_PIXEL_GRID.margin,
    fontScale: exports.DEFAULT_PIXEL_GRID.fontScale
};
exports.BORDER = {
    outer: 1,
    middle: 1,
    inner: 1,
    total: 3
};
function createBorderConfig(config = {}) {
    const outer = config.outer ?? 1;
    const middle = config.middle ?? 1;
    const inner = config.inner ?? 1;
    const total = outer + middle + inner;
    return {
        outer,
        middle,
        inner,
        total
    };
}


/***/ }),

/***/ "pixi.js":
/*!*******************************************************************************************!*\
  !*** external {"commonjs":"pixi.js","commonjs2":"pixi.js","amd":"pixi.js","root":"PIXI"} ***!
  \*******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_pixi_js__;

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.ts");
/******/ 	
/******/ 	return __webpack_exports__;
/******/ })()
;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixXQUFXO0FBQ3JDO0FBQ0EsZ0NBQWdDLFdBQVc7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsOEJBQThCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixlQUFlO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Ysa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnQkFBZ0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsR0FBRztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsUUFBUTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLEdBQUc7QUFDNUMsMEJBQTBCLG9CQUFvQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxHQUFHO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLDJDQUEyQyxHQUFHO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLEdBQUc7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsR0FBRztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxHQUFHO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLElBQUk7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGVBQWU7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixlQUFlO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLDBEQUEwRDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyx3REFBd0Q7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNkJBQTZCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNkJBQTZCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLElBQUk7QUFDNUM7QUFDQTtBQUNBLDRDQUE0QyxLQUFLO0FBQ2pEO0FBQ0E7QUFDQSx3Q0FBd0MsR0FBRztBQUMzQztBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsTUFBTTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxJQUFJO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxJQUFJO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNEJBQTRCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw0QkFBNEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNEJBQTRCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkJBQTZCO0FBQ3JELDBCQUEwQiwwQkFBMEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw0QkFBNEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkJBQTZCO0FBQ3JEO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBCQUEwQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDBCQUEwQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsSUFBSTtBQUM5QztBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsbUJBQW1CO0FBQzdDO0FBQ0E7QUFDQSxnREFBZ0QsSUFBSTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxJQUFJO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDRCQUE0QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0NBQWdDO0FBQ3hEO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDRCQUE0QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0NBQWdDO0FBQ3hELDBCQUEwQiw0QkFBNEI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsOEJBQThCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxzREFBc0Q7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsa0VBQWtFO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsa0RBQWtEO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIscUJBQXFCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixxQkFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esb0JBQW9CLDBCQUEwQjtBQUM5QztBQUNBO0FBQ0Esc0JBQXNCLDBCQUEwQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsMEJBQTBCO0FBQzlDO0FBQ0E7QUFDQSxzQkFBc0IsMEJBQTBCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxpQkFBaUI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxnQkFBZ0I7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3Q0FBd0M7QUFDaEU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixnQ0FBZ0M7QUFDMUQ7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDRCQUE0QjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHVCQUF1QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxJQUFJO0FBQzlDO0FBQ0E7QUFDQSwwQ0FBMEMsR0FBRztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxRQUFRO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFFBQVE7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxJQUFJO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsTUFBTTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLElBQUk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsR0FBRztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQixVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsTUFBTTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsSUFBSTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNCQUFzQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBCQUEwQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixxQkFBcUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBLHdCQUF3QiwyQkFBMkI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixRQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsT0FBTztBQUMvQjtBQUNBO0FBQ0Esd0JBQXdCLE9BQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGtCQUFrQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsa0JBQWtCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixXQUFXO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsb0NBQW9DO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLG9DQUFvQztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLGdDQUFnQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msb0JBQW9CO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsWUFBWTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDBCQUEwQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLGdDQUFnQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnQ0FBZ0M7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUNBQXlDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzQkFBc0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHFCQUFxQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IscUJBQXFCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixxQkFBcUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isd0NBQXdDO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlCQUFpQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlCQUF5QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMEJBQTBCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyx3QkFBd0IsaUJBQWlCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUVBO1VBQ0E7VUFDQTs7OztVRXRCQTtVQUNBO1VBQ0E7VUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL21veGkvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL21veGkvLi4vLi4vbm9kZV9tb2R1bGVzL2ZvbnRmYWNlb2JzZXJ2ZXIvZm9udGZhY2VvYnNlcnZlci5zdGFuZGFsb25lLmpzIiwid2VicGFjazovL21veGkvLi4vLi4vbm9kZV9tb2R1bGVzL3BsYW5jay9kaXN0L3BsYW5jay5qcyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvYXNzZXQtbG9hZGVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9jYW1lcmEudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9jb3JlL2VuZ2luZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvZXZlbnQtc3lzdGVtLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9sb2dpYy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvbW94aS1lbnRpdHkudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9jb3JlL3JlbmRlci1tYW5hZ2VyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9zY2VuZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9hY3Rpb24tbWFuYWdlci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvYXMtcGl4aS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvY2xpZW50LWV2ZW50cy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvZmFsbGluZy1zcXVhcmVzLWFuaW1hdGlvbi50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvZm9udC1sb2FkZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L2dyaWQtZ2VuZXJhdG9yLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9sb2FkaW5nLXNjZW5lLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9wYXJhbGxheC1iYWNrZ3JvdW5kLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9wYXJhbGxheC1sYXllci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGh5c2ljcy9pbmRleC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGh5c2ljcy9waHlzaWNzLWJvZHktbG9naWMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BoeXNpY3MvcGh5c2ljcy1jb2xsaXNpb24udHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BoeXNpY3MvcGh5c2ljcy1kZWJ1Zy1yZW5kZXJlci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGh5c2ljcy9waHlzaWNzLWdyYXBoaWNzLXBhcnNlci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGh5c2ljcy9waHlzaWNzLW1hdGVyaWFscy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGh5c2ljcy9waHlzaWNzLXV0aWxzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3Mtd29ybGQudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3Jlc2l6ZS1oYW5kbGVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9zZXR1cC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvc3RhdGUtbG9naWMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3N0YXRlLW1hY2hpbmUudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3N2Zy11dGlscy9zdmctdG8tdGV4dHVyZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvdGV4dHVyZS1mcmFtZS1zZXF1ZW5jZXMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3RleHR1cmUtZnJhbWVzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS91dGlscy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL1VJTGF5ZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9VSVNjYWxlTW9kZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvYnV0dG9uLWJhY2tncm91bmQtc3RyYXRlZ3kudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL3VpLWJveC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktYnV0dG9uLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS1sYWJlbC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktcGFuZWwudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL3VpLXNjcm9sbC1jb250YWluZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL3VpLXNlbGVjdC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktdGFicy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktdGV4dC1pbnB1dC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktdGV4dGFyZWEudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb3JlL2JveC1tb2RlbC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvcmUvZWRnZS1pbnNldHMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb3JlL3VpLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvcmUvdWktZm9jdXMtbWFuYWdlci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2xheW91dC9mbGV4LWNvbnRhaW5lci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL3BpeGVsLWdyaWQudHMiLCJ3ZWJwYWNrOi8vbW94aS9leHRlcm5hbCB1bWQge1wiY29tbW9uanNcIjpcInBpeGkuanNcIixcImNvbW1vbmpzMlwiOlwicGl4aS5qc1wiLFwiYW1kXCI6XCJwaXhpLmpzXCIsXCJyb290XCI6XCJQSVhJXCJ9Iiwid2VicGFjazovL21veGkvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vbW94aS93ZWJwYWNrL2JlZm9yZS1zdGFydHVwIiwid2VicGFjazovL21veGkvd2VicGFjay9zdGFydHVwIiwid2VicGFjazovL21veGkvd2VicGFjay9hZnRlci1zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcInBpeGkuanNcIikpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW1wicGl4aS5qc1wiXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJtb3hpXCJdID0gZmFjdG9yeShyZXF1aXJlKFwicGl4aS5qc1wiKSk7XG5cdGVsc2Vcblx0XHRyb290W1wibW94aVwiXSA9IGZhY3Rvcnkocm9vdFtcIlBJWElcIl0pO1xufSkoc2VsZiwgKF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfcGl4aV9qc19fKSA9PiB7XG5yZXR1cm4gIiwiLyogRm9udCBGYWNlIE9ic2VydmVyIHYyLjMuMCAtIMKpIEJyYW0gU3RlaW4uIExpY2Vuc2U6IEJTRC0zLUNsYXVzZSAqLyhmdW5jdGlvbigpe2Z1bmN0aW9uIHAoYSxjKXtkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyP2EuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLGMsITEpOmEuYXR0YWNoRXZlbnQoXCJzY3JvbGxcIixjKX1mdW5jdGlvbiB1KGEpe2RvY3VtZW50LmJvZHk/YSgpOmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXI/ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIixmdW5jdGlvbiBiKCl7ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIixiKTthKCl9KTpkb2N1bWVudC5hdHRhY2hFdmVudChcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiLGZ1bmN0aW9uIGcoKXtpZihcImludGVyYWN0aXZlXCI9PWRvY3VtZW50LnJlYWR5U3RhdGV8fFwiY29tcGxldGVcIj09ZG9jdW1lbnQucmVhZHlTdGF0ZSlkb2N1bWVudC5kZXRhY2hFdmVudChcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiLGcpLGEoKX0pfTtmdW5jdGlvbiB3KGEpe3RoaXMuZz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RoaXMuZy5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLFwidHJ1ZVwiKTt0aGlzLmcuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoYSkpO3RoaXMuaD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTt0aGlzLmk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7dGhpcy5tPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO3RoaXMuaj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTt0aGlzLmw9LTE7dGhpcy5oLnN0eWxlLmNzc1RleHQ9XCJtYXgtd2lkdGg6bm9uZTtkaXNwbGF5OmlubGluZS1ibG9jaztwb3NpdGlvbjphYnNvbHV0ZTtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO292ZXJmbG93OnNjcm9sbDtmb250LXNpemU6MTZweDtcIjt0aGlzLmkuc3R5bGUuY3NzVGV4dD1cIm1heC13aWR0aDpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7b3ZlcmZsb3c6c2Nyb2xsO2ZvbnQtc2l6ZToxNnB4O1wiO1xudGhpcy5qLnN0eWxlLmNzc1RleHQ9XCJtYXgtd2lkdGg6bm9uZTtkaXNwbGF5OmlubGluZS1ibG9jaztwb3NpdGlvbjphYnNvbHV0ZTtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO292ZXJmbG93OnNjcm9sbDtmb250LXNpemU6MTZweDtcIjt0aGlzLm0uc3R5bGUuY3NzVGV4dD1cImRpc3BsYXk6aW5saW5lLWJsb2NrO3dpZHRoOjIwMCU7aGVpZ2h0OjIwMCU7Zm9udC1zaXplOjE2cHg7bWF4LXdpZHRoOm5vbmU7XCI7dGhpcy5oLmFwcGVuZENoaWxkKHRoaXMubSk7dGhpcy5pLmFwcGVuZENoaWxkKHRoaXMuaik7dGhpcy5nLmFwcGVuZENoaWxkKHRoaXMuaCk7dGhpcy5nLmFwcGVuZENoaWxkKHRoaXMuaSl9XG5mdW5jdGlvbiB4KGEsYyl7YS5nLnN0eWxlLmNzc1RleHQ9XCJtYXgtd2lkdGg6bm9uZTttaW4td2lkdGg6MjBweDttaW4taGVpZ2h0OjIwcHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7b3ZlcmZsb3c6aGlkZGVuO3Bvc2l0aW9uOmFic29sdXRlO3dpZHRoOmF1dG87bWFyZ2luOjA7cGFkZGluZzowO3RvcDotOTk5cHg7d2hpdGUtc3BhY2U6bm93cmFwO2ZvbnQtc3ludGhlc2lzOm5vbmU7Zm9udDpcIitjK1wiO1wifWZ1bmN0aW9uIEIoYSl7dmFyIGM9YS5nLm9mZnNldFdpZHRoLGI9YysxMDA7YS5qLnN0eWxlLndpZHRoPWIrXCJweFwiO2EuaS5zY3JvbGxMZWZ0PWI7YS5oLnNjcm9sbExlZnQ9YS5oLnNjcm9sbFdpZHRoKzEwMDtyZXR1cm4gYS5sIT09Yz8oYS5sPWMsITApOiExfWZ1bmN0aW9uIEMoYSxjKXtmdW5jdGlvbiBiKCl7dmFyIGU9ZztCKGUpJiZudWxsIT09ZS5nLnBhcmVudE5vZGUmJmMoZS5sKX12YXIgZz1hO3AoYS5oLGIpO3AoYS5pLGIpO0IoYSl9O2Z1bmN0aW9uIEQoYSxjLGIpe2M9Y3x8e307Yj1ifHx3aW5kb3c7dGhpcy5mYW1pbHk9YTt0aGlzLnN0eWxlPWMuc3R5bGV8fFwibm9ybWFsXCI7dGhpcy53ZWlnaHQ9Yy53ZWlnaHR8fFwibm9ybWFsXCI7dGhpcy5zdHJldGNoPWMuc3RyZXRjaHx8XCJub3JtYWxcIjt0aGlzLmNvbnRleHQ9Yn12YXIgRT1udWxsLEY9bnVsbCxHPW51bGwsSD1udWxsO2Z1bmN0aW9uIEkoYSl7bnVsbD09PUYmJihNKGEpJiYvQXBwbGUvLnRlc3Qod2luZG93Lm5hdmlnYXRvci52ZW5kb3IpPyhhPS9BcHBsZVdlYktpdFxcLyhbMC05XSspKD86XFwuKFswLTldKykpKD86XFwuKFswLTldKykpLy5leGVjKHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KSxGPSEhYSYmNjAzPnBhcnNlSW50KGFbMV0sMTApKTpGPSExKTtyZXR1cm4gRn1mdW5jdGlvbiBNKGEpe251bGw9PT1IJiYoSD0hIWEuZG9jdW1lbnQuZm9udHMpO3JldHVybiBIfVxuZnVuY3Rpb24gTihhLGMpe3ZhciBiPWEuc3R5bGUsZz1hLndlaWdodDtpZihudWxsPT09Ryl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTt0cnl7ZS5zdHlsZS5mb250PVwiY29uZGVuc2VkIDEwMHB4IHNhbnMtc2VyaWZcIn1jYXRjaChxKXt9Rz1cIlwiIT09ZS5zdHlsZS5mb250fXJldHVybltiLGcsRz9hLnN0cmV0Y2g6XCJcIixcIjEwMHB4XCIsY10uam9pbihcIiBcIil9XG5ELnByb3RvdHlwZS5sb2FkPWZ1bmN0aW9uKGEsYyl7dmFyIGI9dGhpcyxnPWF8fFwiQkVTYnN3eVwiLGU9MCxxPWN8fDNFMyxKPShuZXcgRGF0ZSkuZ2V0VGltZSgpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihLLEwpe2lmKE0oYi5jb250ZXh0KSYmIUkoYi5jb250ZXh0KSl7dmFyIE89bmV3IFByb21pc2UoZnVuY3Rpb24ocix0KXtmdW5jdGlvbiBoKCl7KG5ldyBEYXRlKS5nZXRUaW1lKCktSj49cT90KEVycm9yKFwiXCIrcStcIm1zIHRpbWVvdXQgZXhjZWVkZWRcIikpOmIuY29udGV4dC5kb2N1bWVudC5mb250cy5sb2FkKE4oYiwnXCInK2IuZmFtaWx5KydcIicpLGcpLnRoZW4oZnVuY3Rpb24obil7MTw9bi5sZW5ndGg/cigpOnNldFRpbWVvdXQoaCwyNSl9LHQpfWgoKX0pLFA9bmV3IFByb21pc2UoZnVuY3Rpb24ocix0KXtlPXNldFRpbWVvdXQoZnVuY3Rpb24oKXt0KEVycm9yKFwiXCIrcStcIm1zIHRpbWVvdXQgZXhjZWVkZWRcIikpfSxxKX0pO1Byb21pc2UucmFjZShbUCxPXSkudGhlbihmdW5jdGlvbigpe2NsZWFyVGltZW91dChlKTtcbksoYil9LEwpfWVsc2UgdShmdW5jdGlvbigpe2Z1bmN0aW9uIHIoKXt2YXIgZDtpZihkPS0xIT1rJiYtMSE9bHx8LTEhPWsmJi0xIT1tfHwtMSE9bCYmLTEhPW0pKGQ9ayE9bCYmayE9bSYmbCE9bSl8fChudWxsPT09RSYmKGQ9L0FwcGxlV2ViS2l0XFwvKFswLTldKykoPzpcXC4oWzAtOV0rKSkvLmV4ZWMod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpLEU9ISFkJiYoNTM2PnBhcnNlSW50KGRbMV0sMTApfHw1MzY9PT1wYXJzZUludChkWzFdLDEwKSYmMTE+PXBhcnNlSW50KGRbMl0sMTApKSksZD1FJiYoaz09eSYmbD09eSYmbT09eXx8az09eiYmbD09eiYmbT09enx8az09QSYmbD09QSYmbT09QSkpLGQ9IWQ7ZCYmKG51bGwhPT1mLnBhcmVudE5vZGUmJmYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmKSxjbGVhclRpbWVvdXQoZSksSyhiKSl9ZnVuY3Rpb24gdCgpe2lmKChuZXcgRGF0ZSkuZ2V0VGltZSgpLUo+PXEpbnVsbCE9PWYucGFyZW50Tm9kZSYmZi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGYpLFxuTChFcnJvcihcIlwiK3ErXCJtcyB0aW1lb3V0IGV4Y2VlZGVkXCIpKTtlbHNle3ZhciBkPWIuY29udGV4dC5kb2N1bWVudC5oaWRkZW47aWYoITA9PT1kfHx2b2lkIDA9PT1kKWs9aC5nLm9mZnNldFdpZHRoLGw9bi5nLm9mZnNldFdpZHRoLG09di5nLm9mZnNldFdpZHRoLHIoKTtlPXNldFRpbWVvdXQodCw1MCl9fXZhciBoPW5ldyB3KGcpLG49bmV3IHcoZyksdj1uZXcgdyhnKSxrPS0xLGw9LTEsbT0tMSx5PS0xLHo9LTEsQT0tMSxmPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7Zi5kaXI9XCJsdHJcIjt4KGgsTihiLFwic2Fucy1zZXJpZlwiKSk7eChuLE4oYixcInNlcmlmXCIpKTt4KHYsTihiLFwibW9ub3NwYWNlXCIpKTtmLmFwcGVuZENoaWxkKGguZyk7Zi5hcHBlbmRDaGlsZChuLmcpO2YuYXBwZW5kQ2hpbGQodi5nKTtiLmNvbnRleHQuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmKTt5PWguZy5vZmZzZXRXaWR0aDt6PW4uZy5vZmZzZXRXaWR0aDtBPXYuZy5vZmZzZXRXaWR0aDt0KCk7XG5DKGgsZnVuY3Rpb24oZCl7az1kO3IoKX0pO3goaCxOKGIsJ1wiJytiLmZhbWlseSsnXCIsc2Fucy1zZXJpZicpKTtDKG4sZnVuY3Rpb24oZCl7bD1kO3IoKX0pO3gobixOKGIsJ1wiJytiLmZhbWlseSsnXCIsc2VyaWYnKSk7Qyh2LGZ1bmN0aW9uKGQpe209ZDtyKCl9KTt4KHYsTihiLCdcIicrYi5mYW1pbHkrJ1wiLG1vbm9zcGFjZScpKX0pfSl9O1wib2JqZWN0XCI9PT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPUQ6KHdpbmRvdy5Gb250RmFjZU9ic2VydmVyPUQsd2luZG93LkZvbnRGYWNlT2JzZXJ2ZXIucHJvdG90eXBlLmxvYWQ9RC5wcm90b3R5cGUubG9hZCk7fSgpKTtcbiIsIihmdW5jdGlvbihnbG9iYWwsIGZhY3RvcnkpIHtcbiAgdHlwZW9mIGV4cG9ydHMgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIiA/IGZhY3RvcnkoZXhwb3J0cykgOiB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShbXCJleHBvcnRzXCJdLCBmYWN0b3J5KSA6IChnbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFRoaXMgOiBnbG9iYWwgfHwgc2VsZiwgZmFjdG9yeShnbG9iYWwucGxhbmNrID0ge30pKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKGV4cG9ydHMyKSB7XG4gIFwidXNlIHN0cmljdFwiOy8qKlxuICogUGxhbmNrLmpzIHYxLjQuMlxuICogQGxpY2Vuc2UgVGhlIE1JVCBsaWNlbnNlXG4gKiBAY29weXJpZ2h0IENvcHlyaWdodCAoYykgMjAyNSBFcmluIENhdHRvLCBBbGkgU2hha2liYVxuICpcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKlxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxuICogU09GVFdBUkUuXG4gKi9cblxuICAvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxuICBcbiAgICAgIFBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxuICAgICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxuICBcbiAgICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcbiAgICAgIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxuICAgICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxuICAgICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXG4gICAgICBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxuICAgICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxuICAgICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cbiAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXG4gIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZDIsIGIyKSB7XG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uKGQzLCBiMykge1xuICAgICAgZDMuX19wcm90b19fID0gYjM7XG4gICAgfSB8fCBmdW5jdGlvbihkMywgYjMpIHtcbiAgICAgIGZvciAodmFyIHAgaW4gYjMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYjMsIHApKSBkM1twXSA9IGIzW3BdO1xuICAgIH07XG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZDIsIGIyKTtcbiAgfTtcbiAgZnVuY3Rpb24gX19leHRlbmRzKGQyLCBiMikge1xuICAgIGlmICh0eXBlb2YgYjIgIT09IFwiZnVuY3Rpb25cIiAmJiBiMiAhPT0gbnVsbClcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIyKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgZXh0ZW5kU3RhdGljcyhkMiwgYjIpO1xuICAgIGZ1bmN0aW9uIF9fKCkge1xuICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQyO1xuICAgIH1cbiAgICBkMi5wcm90b3R5cGUgPSBiMiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYjIpIDogKF9fLnByb3RvdHlwZSA9IGIyLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICB9XG4gIHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbjIodCkge1xuICAgICAgZm9yICh2YXIgczIsIGkgPSAxLCBuMiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuMjsgaSsrKSB7XG4gICAgICAgIHMyID0gYXJndW1lbnRzW2ldO1xuICAgICAgICBmb3IgKHZhciBwIGluIHMyKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMyLCBwKSkgdFtwXSA9IHMyW3BdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHQ7XG4gICAgfTtcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcbiAgdmFyIG9wdGlvbnMgPSBmdW5jdGlvbihpbnB1dDIsIGRlZmF1bHRzKSB7XG4gICAgaWYgKGlucHV0MiA9PT0gbnVsbCB8fCB0eXBlb2YgaW5wdXQyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBpbnB1dDIgPSB7fTtcbiAgICB9XG4gICAgdmFyIG91dHB1dDIgPSBfX2Fzc2lnbih7fSwgaW5wdXQyKTtcbiAgICBmb3IgKHZhciBrZXkgaW4gZGVmYXVsdHMpIHtcbiAgICAgIGlmIChkZWZhdWx0cy5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIHR5cGVvZiBpbnB1dDJba2V5XSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICBvdXRwdXQyW2tleV0gPSBkZWZhdWx0c1trZXldO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGRlZmF1bHRzKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3ltYm9scy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgc3ltYm9sID0gc3ltYm9sc1tpXTtcbiAgICAgICAgaWYgKGRlZmF1bHRzLnByb3BlcnR5SXNFbnVtZXJhYmxlKHN5bWJvbCkgJiYgdHlwZW9mIGlucHV0MltzeW1ib2xdID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgb3V0cHV0MltzeW1ib2xdID0gZGVmYXVsdHNbc3ltYm9sXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0cHV0MjtcbiAgfTtcbiAgdmFyIG1hdGhfcmFuZG9tID0gTWF0aC5yYW5kb207XG4gIHZhciBFUFNJTE9OID0gMWUtOTtcbiAgdmFyIGlzRmluaXRlID0gTnVtYmVyLmlzRmluaXRlO1xuICBmdW5jdGlvbiBuZXh0UG93ZXJPZlR3byh4Mikge1xuICAgIHgyIHw9IHgyID4+IDE7XG4gICAgeDIgfD0geDIgPj4gMjtcbiAgICB4MiB8PSB4MiA+PiA0O1xuICAgIHgyIHw9IHgyID4+IDg7XG4gICAgeDIgfD0geDIgPj4gMTY7XG4gICAgcmV0dXJuIHgyICsgMTtcbiAgfVxuICBmdW5jdGlvbiBpc1Bvd2VyT2ZUd28oeDIpIHtcbiAgICByZXR1cm4geDIgPiAwICYmICh4MiAmIHgyIC0gMSkgPT09IDA7XG4gIH1cbiAgZnVuY3Rpb24gbW9kKG51bSwgbWluLCBtYXgpIHtcbiAgICBpZiAodHlwZW9mIG1pbiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgbWF4ID0gMTtcbiAgICAgIG1pbiA9IDA7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbWF4ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBtYXggPSBtaW47XG4gICAgICBtaW4gPSAwO1xuICAgIH1cbiAgICBpZiAobWF4ID4gbWluKSB7XG4gICAgICBudW0gPSAobnVtIC0gbWluKSAlIChtYXggLSBtaW4pO1xuICAgICAgcmV0dXJuIG51bSArIChudW0gPCAwID8gbWF4IDogbWluKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbnVtID0gKG51bSAtIG1heCkgJSAobWluIC0gbWF4KTtcbiAgICAgIHJldHVybiBudW0gKyAobnVtIDw9IDAgPyBtaW4gOiBtYXgpO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBjbGFtcChudW0sIG1pbiwgbWF4KSB7XG4gICAgaWYgKG51bSA8IG1pbikge1xuICAgICAgcmV0dXJuIG1pbjtcbiAgICB9IGVsc2UgaWYgKG51bSA+IG1heCkge1xuICAgICAgcmV0dXJuIG1heDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gcmFuZG9tKG1pbiwgbWF4KSB7XG4gICAgaWYgKHR5cGVvZiBtaW4gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIG1heCA9IDE7XG4gICAgICBtaW4gPSAwO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIG1heCA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgbWF4ID0gbWluO1xuICAgICAgbWluID0gMDtcbiAgICB9XG4gICAgcmV0dXJuIG1pbiA9PT0gbWF4ID8gbWluIDogbWF0aF9yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluO1xuICB9XG4gIHZhciBtYXRoID0gT2JqZWN0LmNyZWF0ZShNYXRoKTtcbiAgbWF0aC5FUFNJTE9OID0gRVBTSUxPTjtcbiAgbWF0aC5pc0Zpbml0ZSA9IGlzRmluaXRlO1xuICBtYXRoLm5leHRQb3dlck9mVHdvID0gbmV4dFBvd2VyT2ZUd287XG4gIG1hdGguaXNQb3dlck9mVHdvID0gaXNQb3dlck9mVHdvO1xuICBtYXRoLm1vZCA9IG1vZDtcbiAgbWF0aC5jbGFtcCA9IGNsYW1wO1xuICBtYXRoLnJhbmRvbSA9IHJhbmRvbTtcbiAgdmFyIG1hdGhfYWJzJDkgPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfc3FydCQ1ID0gTWF0aC5zcXJ0O1xuICB2YXIgbWF0aF9tYXgkOCA9IE1hdGgubWF4O1xuICB2YXIgbWF0aF9taW4kOCA9IE1hdGgubWluO1xuICB2YXIgVmVjMiA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBWZWMyMih4MiwgeSkge1xuICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgVmVjMjIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBWZWMyMih4MiwgeSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB4MiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHRoaXMueCA9IDA7XG4gICAgICAgICAgdGhpcy55ID0gMDtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgeDIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLnggPSB4Mi54O1xuICAgICAgICAgIHRoaXMueSA9IHgyLnk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy54ID0geDI7XG4gICAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgVmVjMjIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB4OiB0aGlzLngsXG4gICAgICAgICAgeTogdGhpcy55XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgVmVjMjIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShWZWMyMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoueCA9IGRhdGEueDtcbiAgICAgICAgb2JqLnkgPSBkYXRhLnk7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVmVjMjIuemVybyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShWZWMyMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoueCA9IDA7XG4gICAgICAgIG9iai55ID0gMDtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBWZWMyMi5uZW8gPSBmdW5jdGlvbih4MiwgeSkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShWZWMyMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoueCA9IHgyO1xuICAgICAgICBvYmoueSA9IHk7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVmVjMjIuY2xvbmUgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKHYzLngsIHYzLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShvYmoueCkgJiYgTnVtYmVyLmlzRmluaXRlKG9iai55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5hc3NlcnQgPSBmdW5jdGlvbihvKSB7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5jbG9uZSh0aGlzKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc2V0WmVybyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnggPSAwO1xuICAgICAgICB0aGlzLnkgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24oeDIsIHkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB4MiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMueCA9IHgyLng7XG4gICAgICAgICAgdGhpcy55ID0geDIueTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnggPSB4MjtcbiAgICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zZXROdW0gPSBmdW5jdGlvbih4MiwgeSkge1xuICAgICAgICB0aGlzLnggPSB4MjtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnNldFZlYzIgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB0aGlzLnggPSB2YWx1ZS54O1xuICAgICAgICB0aGlzLnkgPSB2YWx1ZS55O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUud1NldCA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiMiAhPT0gXCJ1bmRlZmluZWRcIiB8fCB0eXBlb2YgdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiB0aGlzLnNldENvbWJpbmUoYTIsIHYzLCBiMiwgdyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2V0TXVsKGEyLCB2Myk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc2V0Q29tYmluZSA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgdmFyIHgyID0gYTIgKiB2My54ICsgYjIgKiB3Lng7XG4gICAgICAgIHZhciB5ID0gYTIgKiB2My55ICsgYjIgKiB3Lnk7XG4gICAgICAgIHRoaXMueCA9IHgyO1xuICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc2V0TXVsID0gZnVuY3Rpb24oYTIsIHYzKSB7XG4gICAgICAgIHZhciB4MiA9IGEyICogdjMueDtcbiAgICAgICAgdmFyIHkgPSBhMiAqIHYzLnk7XG4gICAgICAgIHRoaXMueCA9IHgyO1xuICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24odykge1xuICAgICAgICB0aGlzLnggKz0gdy54O1xuICAgICAgICB0aGlzLnkgKz0gdy55O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUud0FkZCA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiMiAhPT0gXCJ1bmRlZmluZWRcIiB8fCB0eXBlb2YgdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiB0aGlzLmFkZENvbWJpbmUoYTIsIHYzLCBiMiwgdyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuYWRkTXVsKGEyLCB2Myk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuYWRkQ29tYmluZSA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgdmFyIHgyID0gYTIgKiB2My54ICsgYjIgKiB3Lng7XG4gICAgICAgIHZhciB5ID0gYTIgKiB2My55ICsgYjIgKiB3Lnk7XG4gICAgICAgIHRoaXMueCArPSB4MjtcbiAgICAgICAgdGhpcy55ICs9IHk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5hZGRNdWwgPSBmdW5jdGlvbihhMiwgdjMpIHtcbiAgICAgICAgdmFyIHgyID0gYTIgKiB2My54O1xuICAgICAgICB2YXIgeSA9IGEyICogdjMueTtcbiAgICAgICAgdGhpcy54ICs9IHgyO1xuICAgICAgICB0aGlzLnkgKz0geTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLndTdWIgPSBmdW5jdGlvbihhMiwgdjMsIGIyLCB3KSB7XG4gICAgICAgIGlmICh0eXBlb2YgYjIgIT09IFwidW5kZWZpbmVkXCIgfHwgdHlwZW9mIHcgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zdWJDb21iaW5lKGEyLCB2MywgYjIsIHcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLnN1Yk11bChhMiwgdjMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnN1YkNvbWJpbmUgPSBmdW5jdGlvbihhMiwgdjMsIGIyLCB3KSB7XG4gICAgICAgIHZhciB4MiA9IGEyICogdjMueCArIGIyICogdy54O1xuICAgICAgICB2YXIgeSA9IGEyICogdjMueSArIGIyICogdy55O1xuICAgICAgICB0aGlzLnggLT0geDI7XG4gICAgICAgIHRoaXMueSAtPSB5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc3ViTXVsID0gZnVuY3Rpb24oYTIsIHYzKSB7XG4gICAgICAgIHZhciB4MiA9IGEyICogdjMueDtcbiAgICAgICAgdmFyIHkgPSBhMiAqIHYzLnk7XG4gICAgICAgIHRoaXMueCAtPSB4MjtcbiAgICAgICAgdGhpcy55IC09IHk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zdWIgPSBmdW5jdGlvbih3KSB7XG4gICAgICAgIHRoaXMueCAtPSB3Lng7XG4gICAgICAgIHRoaXMueSAtPSB3Lnk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5tdWwgPSBmdW5jdGlvbihtKSB7XG4gICAgICAgIHRoaXMueCAqPSBtO1xuICAgICAgICB0aGlzLnkgKj0gbTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLmxlbmd0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVmVjMjIubGVuZ3RoT2YodGhpcyk7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLmxlbmd0aFNxdWFyZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLmxlbmd0aFNxdWFyZWQodGhpcyk7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTtcbiAgICAgICAgaWYgKGxlbmd0aCA8IEVQU0lMT04pIHtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW52TGVuZ3RoID0gMSAvIGxlbmd0aDtcbiAgICAgICAgdGhpcy54ICo9IGludkxlbmd0aDtcbiAgICAgICAgdGhpcy55ICo9IGludkxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGxlbmd0aDtcbiAgICAgIH07XG4gICAgICBWZWMyMi5ub3JtYWxpemUgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICB2YXIgbGVuZ3RoID0gVmVjMjIubGVuZ3RoT2YodjMpO1xuICAgICAgICBpZiAobGVuZ3RoIDwgRVBTSUxPTikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi56ZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGludkxlbmd0aCA9IDEgLyBsZW5ndGg7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8odjMueCAqIGludkxlbmd0aCwgdjMueSAqIGludkxlbmd0aCk7XG4gICAgICB9O1xuICAgICAgVmVjMjIubGVuZ3RoT2YgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICByZXR1cm4gbWF0aF9zcXJ0JDUodjMueCAqIHYzLnggKyB2My55ICogdjMueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIubGVuZ3RoU3F1YXJlZCA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiB2My54ICogdjMueCArIHYzLnkgKiB2My55O1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmRpc3RhbmNlID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgdmFyIGR4ID0gdjMueCAtIHcueDtcbiAgICAgICAgdmFyIGR5ID0gdjMueSAtIHcueTtcbiAgICAgICAgcmV0dXJuIG1hdGhfc3FydCQ1KGR4ICogZHggKyBkeSAqIGR5KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5kaXN0YW5jZVNxdWFyZWQgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICB2YXIgZHggPSB2My54IC0gdy54O1xuICAgICAgICB2YXIgZHkgPSB2My55IC0gdy55O1xuICAgICAgICByZXR1cm4gZHggKiBkeCArIGR5ICogZHk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuYXJlRXF1YWwgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gdjMgPT09IHcgfHwgdHlwZW9mIHcgPT09IFwib2JqZWN0XCIgJiYgdyAhPT0gbnVsbCAmJiB2My54ID09PSB3LnggJiYgdjMueSA9PT0gdy55O1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnNrZXcgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKC12My55LCB2My54KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5kb3QgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gdjMueCAqIHcueCArIHYzLnkgKiB3Lnk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuY3Jvc3MgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICBpZiAodHlwZW9mIHcgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIubmVvKHcgKiB2My55LCAtdyAqIHYzLngpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2MyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8oLXYzICogdy55LCB2MyAqIHcueCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHYzLnggKiB3LnkgLSB2My55ICogdy54O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVmVjMjIuY3Jvc3NWZWMyVmVjMiA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiB2My54ICogdy55IC0gdjMueSAqIHcueDtcbiAgICAgIH07XG4gICAgICBWZWMyMi5jcm9zc1ZlYzJOdW0gPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKHcgKiB2My55LCAtdyAqIHYzLngpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmNyb3NzTnVtVmVjMiA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8oLXYzICogdy55LCB2MyAqIHcueCk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuYWRkQ3Jvc3MgPSBmdW5jdGlvbihhMiwgdjMsIHcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3ID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh3ICogdjMueSArIGEyLngsIC13ICogdjMueCArIGEyLnkpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2MyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8oLXYzICogdy55ICsgYTIueCwgdjMgKiB3LnggKyBhMi55KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFZlYzIyLmFkZENyb3NzVmVjMk51bSA9IGZ1bmN0aW9uKGEyLCB2Mywgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKHcgKiB2My55ICsgYTIueCwgLXcgKiB2My54ICsgYTIueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuYWRkQ3Jvc3NOdW1WZWMyID0gZnVuY3Rpb24oYTIsIHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8oLXYzICogdy55ICsgYTIueCwgdjMgKiB3LnggKyBhMi55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5hZGQgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKHYzLnggKyB3LngsIHYzLnkgKyB3LnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLndBZGQgPSBmdW5jdGlvbihhMiwgdjMsIGIyLCB3KSB7XG4gICAgICAgIGlmICh0eXBlb2YgYjIgIT09IFwidW5kZWZpbmVkXCIgfHwgdHlwZW9mIHcgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIuY29tYmluZShhMiwgdjMsIGIyLCB3KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIubXVsTnVtVmVjMihhMiwgdjMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVmVjMjIuY29tYmluZSA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLnplcm8oKS5zZXRDb21iaW5lKGEyLCB2MywgYjIsIHcpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnN1YiA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8odjMueCAtIHcueCwgdjMueSAtIHcueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIubXVsID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYTIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIubmVvKGEyLnggKiBiMiwgYTIueSAqIGIyKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYjIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIubmVvKGEyICogYjIueCwgYTIgKiBiMi55KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFZlYzIyLm11bFZlYzJOdW0gPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyhhMi54ICogYjIsIGEyLnkgKiBiMik7XG4gICAgICB9O1xuICAgICAgVmVjMjIubXVsTnVtVmVjMiA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKGEyICogYjIueCwgYTIgKiBiMi55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUubmVnID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMueCA9IC10aGlzLng7XG4gICAgICAgIHRoaXMueSA9IC10aGlzLnk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLm5lZyA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8oLXYzLngsIC12My55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5hYnMgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKG1hdGhfYWJzJDkodjMueCksIG1hdGhfYWJzJDkodjMueSkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLm1pZCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8oKHYzLnggKyB3LngpICogMC41LCAodjMueSArIHcueSkgKiAwLjUpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnVwcGVyID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyhtYXRoX21heCQ4KHYzLngsIHcueCksIG1hdGhfbWF4JDgodjMueSwgdy55KSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIubG93ZXIgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKG1hdGhfbWluJDgodjMueCwgdy54KSwgbWF0aF9taW4kOCh2My55LCB3LnkpKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuY2xhbXAgPSBmdW5jdGlvbihtYXgpIHtcbiAgICAgICAgdmFyIGxlbmd0aFNxciA9IHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueTtcbiAgICAgICAgaWYgKGxlbmd0aFNxciA+IG1heCAqIG1heCkge1xuICAgICAgICAgIHZhciBzY2FsZSA9IG1heCAvIG1hdGhfc3FydCQ1KGxlbmd0aFNxcik7XG4gICAgICAgICAgdGhpcy54ICo9IHNjYWxlO1xuICAgICAgICAgIHRoaXMueSAqPSBzY2FsZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5jbGFtcCA9IGZ1bmN0aW9uKHYzLCBtYXgpIHtcbiAgICAgICAgdmFyIHIgPSBWZWMyMi5uZW8odjMueCwgdjMueSk7XG4gICAgICAgIHIuY2xhbXAobWF4KTtcbiAgICAgICAgcmV0dXJuIHI7XG4gICAgICB9O1xuICAgICAgVmVjMjIuY2xhbXBWZWMyID0gZnVuY3Rpb24odjMsIG1pbiwgbWF4KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgeDogY2xhbXAodjMueCwgbWluID09PSBudWxsIHx8IG1pbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbWluLngsIG1heCA9PT0gbnVsbCB8fCBtYXggPT09IHZvaWQgMCA/IHZvaWQgMCA6IG1heC54KSxcbiAgICAgICAgICB5OiBjbGFtcCh2My55LCBtaW4gPT09IG51bGwgfHwgbWluID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtaW4ueSwgbWF4ID09PSBudWxsIHx8IG1heCA9PT0gdm9pZCAwID8gdm9pZCAwIDogbWF4LnkpXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgVmVjMjIuc2NhbGVGbiA9IGZ1bmN0aW9uKHgyLCB5KSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih2Mykge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8odjMueCAqIHgyLCB2My55ICogeSk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgVmVjMjIudHJhbnNsYXRlRm4gPSBmdW5jdGlvbih4MiwgeSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIubmVvKHYzLnggKyB4MiwgdjMueSArIHkpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIHJldHVybiBWZWMyMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfbWF4JDcgPSBNYXRoLm1heDtcbiAgdmFyIG1hdGhfbWluJDcgPSBNYXRoLm1pbjtcbiAgdmFyIEFBQkIgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gQUFCQjIobG93ZXIsIHVwcGVyKSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBBQUJCMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEFBQkIyKGxvd2VyLCB1cHBlcik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sb3dlckJvdW5kID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMudXBwZXJCb3VuZCA9IFZlYzIuemVybygpO1xuICAgICAgICBpZiAodHlwZW9mIGxvd2VyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy5sb3dlckJvdW5kLnNldFZlYzIobG93ZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdXBwZXIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLnVwcGVyQm91bmQuc2V0VmVjMih1cHBlcik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGxvd2VyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy51cHBlckJvdW5kLnNldFZlYzIobG93ZXIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBBQUJCMi5wcm90b3R5cGUuaXNWYWxpZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gQUFCQjIuaXNWYWxpZCh0aGlzKTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5pc1ZhbGlkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gVmVjMi5pc1ZhbGlkKG9iai5sb3dlckJvdW5kKSAmJiBWZWMyLmlzVmFsaWQob2JqLnVwcGVyQm91bmQpICYmIFZlYzIuc3ViKG9iai51cHBlckJvdW5kLCBvYmoubG93ZXJCb3VuZCkubGVuZ3RoU3F1YXJlZCgpID49IDA7XG4gICAgICB9O1xuICAgICAgQUFCQjIuYXNzZXJ0ID0gZnVuY3Rpb24obykge1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5nZXRDZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKCh0aGlzLmxvd2VyQm91bmQueCArIHRoaXMudXBwZXJCb3VuZC54KSAqIDAuNSwgKHRoaXMubG93ZXJCb3VuZC55ICsgdGhpcy51cHBlckJvdW5kLnkpICogMC41KTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUuZ2V0RXh0ZW50cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oKHRoaXMudXBwZXJCb3VuZC54IC0gdGhpcy5sb3dlckJvdW5kLngpICogMC41LCAodGhpcy51cHBlckJvdW5kLnkgLSB0aGlzLmxvd2VyQm91bmQueSkgKiAwLjUpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5nZXRQZXJpbWV0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIDIgKiAodGhpcy51cHBlckJvdW5kLnggLSB0aGlzLmxvd2VyQm91bmQueCArIHRoaXMudXBwZXJCb3VuZC55IC0gdGhpcy5sb3dlckJvdW5kLnkpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5jb21iaW5lID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIGIyID0gYjIgfHwgdGhpcztcbiAgICAgICAgdmFyIGxvd2VyQSA9IGEyLmxvd2VyQm91bmQ7XG4gICAgICAgIHZhciB1cHBlckEgPSBhMi51cHBlckJvdW5kO1xuICAgICAgICB2YXIgbG93ZXJCID0gYjIubG93ZXJCb3VuZDtcbiAgICAgICAgdmFyIHVwcGVyQiA9IGIyLnVwcGVyQm91bmQ7XG4gICAgICAgIHZhciBsb3dlclggPSBtYXRoX21pbiQ3KGxvd2VyQS54LCBsb3dlckIueCk7XG4gICAgICAgIHZhciBsb3dlclkgPSBtYXRoX21pbiQ3KGxvd2VyQS55LCBsb3dlckIueSk7XG4gICAgICAgIHZhciB1cHBlclggPSBtYXRoX21heCQ3KHVwcGVyQi54LCB1cHBlckEueCk7XG4gICAgICAgIHZhciB1cHBlclkgPSBtYXRoX21heCQ3KHVwcGVyQi55LCB1cHBlckEueSk7XG4gICAgICAgIHRoaXMubG93ZXJCb3VuZC5zZXROdW0obG93ZXJYLCBsb3dlclkpO1xuICAgICAgICB0aGlzLnVwcGVyQm91bmQuc2V0TnVtKHVwcGVyWCwgdXBwZXJZKTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUuY29tYmluZVBvaW50cyA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB0aGlzLmxvd2VyQm91bmQuc2V0TnVtKG1hdGhfbWluJDcoYTIueCwgYjIueCksIG1hdGhfbWluJDcoYTIueSwgYjIueSkpO1xuICAgICAgICB0aGlzLnVwcGVyQm91bmQuc2V0TnVtKG1hdGhfbWF4JDcoYTIueCwgYjIueCksIG1hdGhfbWF4JDcoYTIueSwgYjIueSkpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihhYWJiKSB7XG4gICAgICAgIHRoaXMubG93ZXJCb3VuZC5zZXROdW0oYWFiYi5sb3dlckJvdW5kLngsIGFhYmIubG93ZXJCb3VuZC55KTtcbiAgICAgICAgdGhpcy51cHBlckJvdW5kLnNldE51bShhYWJiLnVwcGVyQm91bmQueCwgYWFiYi51cHBlckJvdW5kLnkpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5jb250YWlucyA9IGZ1bmN0aW9uKGFhYmIpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiB0aGlzLmxvd2VyQm91bmQueCA8PSBhYWJiLmxvd2VyQm91bmQueDtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIHRoaXMubG93ZXJCb3VuZC55IDw9IGFhYmIubG93ZXJCb3VuZC55O1xuICAgICAgICByZXN1bHQgPSByZXN1bHQgJiYgYWFiYi51cHBlckJvdW5kLnggPD0gdGhpcy51cHBlckJvdW5kLng7XG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiBhYWJiLnVwcGVyQm91bmQueSA8PSB0aGlzLnVwcGVyQm91bmQueTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUuZXh0ZW5kID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgQUFCQjIuZXh0ZW5kKHRoaXMsIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgQUFCQjIuZXh0ZW5kID0gZnVuY3Rpb24ob3V0LCB2YWx1ZSkge1xuICAgICAgICBvdXQubG93ZXJCb3VuZC54IC09IHZhbHVlO1xuICAgICAgICBvdXQubG93ZXJCb3VuZC55IC09IHZhbHVlO1xuICAgICAgICBvdXQudXBwZXJCb3VuZC54ICs9IHZhbHVlO1xuICAgICAgICBvdXQudXBwZXJCb3VuZC55ICs9IHZhbHVlO1xuICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnRlc3RPdmVybGFwID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciBkMXggPSBiMi5sb3dlckJvdW5kLnggLSBhMi51cHBlckJvdW5kLng7XG4gICAgICAgIHZhciBkMnggPSBhMi5sb3dlckJvdW5kLnggLSBiMi51cHBlckJvdW5kLng7XG4gICAgICAgIHZhciBkMXkgPSBiMi5sb3dlckJvdW5kLnkgLSBhMi51cHBlckJvdW5kLnk7XG4gICAgICAgIHZhciBkMnkgPSBhMi5sb3dlckJvdW5kLnkgLSBiMi51cHBlckJvdW5kLnk7XG4gICAgICAgIGlmIChkMXggPiAwIHx8IGQxeSA+IDAgfHwgZDJ4ID4gMCB8fCBkMnkgPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLmFyZUVxdWFsID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHJldHVybiBWZWMyLmFyZUVxdWFsKGEyLmxvd2VyQm91bmQsIGIyLmxvd2VyQm91bmQpICYmIFZlYzIuYXJlRXF1YWwoYTIudXBwZXJCb3VuZCwgYjIudXBwZXJCb3VuZCk7XG4gICAgICB9O1xuICAgICAgQUFCQjIuZGlmZiA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgd0QgPSBtYXRoX21heCQ3KDAsIG1hdGhfbWluJDcoYTIudXBwZXJCb3VuZC54LCBiMi51cHBlckJvdW5kLngpIC0gbWF0aF9tYXgkNyhiMi5sb3dlckJvdW5kLngsIGEyLmxvd2VyQm91bmQueCkpO1xuICAgICAgICB2YXIgaEQgPSBtYXRoX21heCQ3KDAsIG1hdGhfbWluJDcoYTIudXBwZXJCb3VuZC55LCBiMi51cHBlckJvdW5kLnkpIC0gbWF0aF9tYXgkNyhiMi5sb3dlckJvdW5kLnksIGEyLmxvd2VyQm91bmQueSkpO1xuICAgICAgICB2YXIgd0EgPSBhMi51cHBlckJvdW5kLnggLSBhMi5sb3dlckJvdW5kLng7XG4gICAgICAgIHZhciBoQSA9IGEyLnVwcGVyQm91bmQueSAtIGEyLmxvd2VyQm91bmQueTtcbiAgICAgICAgdmFyIHdCID0gYjIudXBwZXJCb3VuZC54IC0gYjIubG93ZXJCb3VuZC54O1xuICAgICAgICB2YXIgaEIgPSBiMi51cHBlckJvdW5kLnkgLSBiMi5sb3dlckJvdW5kLnk7XG4gICAgICAgIHJldHVybiB3QSAqIGhBICsgd0IgKiBoQiAtIHdEICogaEQ7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLnJheUNhc3QgPSBmdW5jdGlvbihvdXRwdXQyLCBpbnB1dDIpIHtcbiAgICAgICAgdmFyIHRtaW4gPSAtSW5maW5pdHk7XG4gICAgICAgIHZhciB0bWF4ID0gSW5maW5pdHk7XG4gICAgICAgIHZhciBwID0gaW5wdXQyLnAxO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihpbnB1dDIucDIsIGlucHV0Mi5wMSk7XG4gICAgICAgIHZhciBhYnNEID0gVmVjMi5hYnMoZDIpO1xuICAgICAgICB2YXIgbm9ybWFsMyA9IFZlYzIuemVybygpO1xuICAgICAgICB7XG4gICAgICAgICAgaWYgKGFic0QueCA8IEVQU0lMT04pIHtcbiAgICAgICAgICAgIGlmIChwLnggPCB0aGlzLmxvd2VyQm91bmQueCB8fCB0aGlzLnVwcGVyQm91bmQueCA8IHAueCkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBpbnZfZCA9IDEgLyBkMi54O1xuICAgICAgICAgICAgdmFyIHQxID0gKHRoaXMubG93ZXJCb3VuZC54IC0gcC54KSAqIGludl9kO1xuICAgICAgICAgICAgdmFyIHQyID0gKHRoaXMudXBwZXJCb3VuZC54IC0gcC54KSAqIGludl9kO1xuICAgICAgICAgICAgdmFyIHMyID0gLTE7XG4gICAgICAgICAgICBpZiAodDEgPiB0Mikge1xuICAgICAgICAgICAgICB2YXIgdGVtcDMgPSB0MTtcbiAgICAgICAgICAgICAgdDEgPSB0MjtcbiAgICAgICAgICAgICAgdDIgPSB0ZW1wMztcbiAgICAgICAgICAgICAgczIgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHQxID4gdG1pbikge1xuICAgICAgICAgICAgICBub3JtYWwzLnNldFplcm8oKTtcbiAgICAgICAgICAgICAgbm9ybWFsMy54ID0gczI7XG4gICAgICAgICAgICAgIHRtaW4gPSB0MTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRtYXggPSBtYXRoX21pbiQ3KHRtYXgsIHQyKTtcbiAgICAgICAgICAgIGlmICh0bWluID4gdG1heCkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICBpZiAoYWJzRC55IDwgRVBTSUxPTikge1xuICAgICAgICAgICAgaWYgKHAueSA8IHRoaXMubG93ZXJCb3VuZC55IHx8IHRoaXMudXBwZXJCb3VuZC55IDwgcC55KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGludl9kID0gMSAvIGQyLnk7XG4gICAgICAgICAgICB2YXIgdDEgPSAodGhpcy5sb3dlckJvdW5kLnkgLSBwLnkpICogaW52X2Q7XG4gICAgICAgICAgICB2YXIgdDIgPSAodGhpcy51cHBlckJvdW5kLnkgLSBwLnkpICogaW52X2Q7XG4gICAgICAgICAgICB2YXIgczIgPSAtMTtcbiAgICAgICAgICAgIGlmICh0MSA+IHQyKSB7XG4gICAgICAgICAgICAgIHZhciB0ZW1wMyA9IHQxO1xuICAgICAgICAgICAgICB0MSA9IHQyO1xuICAgICAgICAgICAgICB0MiA9IHRlbXAzO1xuICAgICAgICAgICAgICBzMiA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodDEgPiB0bWluKSB7XG4gICAgICAgICAgICAgIG5vcm1hbDMuc2V0WmVybygpO1xuICAgICAgICAgICAgICBub3JtYWwzLnkgPSBzMjtcbiAgICAgICAgICAgICAgdG1pbiA9IHQxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdG1heCA9IG1hdGhfbWluJDcodG1heCwgdDIpO1xuICAgICAgICAgICAgaWYgKHRtaW4gPiB0bWF4KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRtaW4gPCAwIHx8IGlucHV0Mi5tYXhGcmFjdGlvbiA8IHRtaW4pIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0Mi5mcmFjdGlvbiA9IHRtaW47XG4gICAgICAgIG91dHB1dDIubm9ybWFsID0gbm9ybWFsMztcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5jb21iaW5lUG9pbnRzID0gZnVuY3Rpb24ob3V0LCBhMiwgYjIpIHtcbiAgICAgICAgb3V0Lmxvd2VyQm91bmQueCA9IG1hdGhfbWluJDcoYTIueCwgYjIueCk7XG4gICAgICAgIG91dC5sb3dlckJvdW5kLnkgPSBtYXRoX21pbiQ3KGEyLnksIGIyLnkpO1xuICAgICAgICBvdXQudXBwZXJCb3VuZC54ID0gbWF0aF9tYXgkNyhhMi54LCBiMi54KTtcbiAgICAgICAgb3V0LnVwcGVyQm91bmQueSA9IG1hdGhfbWF4JDcoYTIueSwgYjIueSk7XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgICB9O1xuICAgICAgQUFCQjIuY29tYmluZWRQZXJpbWV0ZXIgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIGx4ID0gbWF0aF9taW4kNyhhMi5sb3dlckJvdW5kLngsIGIyLmxvd2VyQm91bmQueCk7XG4gICAgICAgIHZhciBseSA9IG1hdGhfbWluJDcoYTIubG93ZXJCb3VuZC55LCBiMi5sb3dlckJvdW5kLnkpO1xuICAgICAgICB2YXIgdXggPSBtYXRoX21heCQ3KGEyLnVwcGVyQm91bmQueCwgYjIudXBwZXJCb3VuZC54KTtcbiAgICAgICAgdmFyIHV5ID0gbWF0aF9tYXgkNyhhMi51cHBlckJvdW5kLnksIGIyLnVwcGVyQm91bmQueSk7XG4gICAgICAgIHJldHVybiAyICogKHV4IC0gbHggKyB1eSAtIGx5KTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gQUFCQjI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX1BJJDYgPSBNYXRoLlBJO1xuICB2YXIgU2V0dGluZ3MgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2V0dGluZ3MyKCkge1xuICAgICAgfVxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzMiwgXCJwb2x5Z29uUmFkaXVzXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSByYWRpdXMgb2YgdGhlIHBvbHlnb24vZWRnZSBzaGFwZSBza2luLiBUaGlzIHNob3VsZCBub3QgYmUgbW9kaWZpZWQuXG4gICAgICAgICAqIE1ha2luZyB0aGlzIHNtYWxsZXIgbWVhbnMgcG9seWdvbnMgd2lsbCBoYXZlIGFuIGluc3VmZmljaWVudCBidWZmZXIgZm9yXG4gICAgICAgICAqIGNvbnRpbnVvdXMgY29sbGlzaW9uLiBNYWtpbmcgaXQgbGFyZ2VyIG1heSBjcmVhdGUgYXJ0aWZhY3RzIGZvciB2ZXJ0ZXhcbiAgICAgICAgICogY29sbGlzaW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gMiAqIFNldHRpbmdzMi5saW5lYXJTbG9wO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIFNldHRpbmdzMi5sZW5ndGhVbml0c1Blck1ldGVyID0gMTtcbiAgICAgIFNldHRpbmdzMi5tYXhNYW5pZm9sZFBvaW50cyA9IDI7XG4gICAgICBTZXR0aW5nczIubWF4UG9seWdvblZlcnRpY2VzID0gMTI7XG4gICAgICBTZXR0aW5nczIuYWFiYkV4dGVuc2lvbiA9IDAuMTtcbiAgICAgIFNldHRpbmdzMi5hYWJiTXVsdGlwbGllciA9IDI7XG4gICAgICBTZXR0aW5nczIubGluZWFyU2xvcCA9IDVlLTM7XG4gICAgICBTZXR0aW5nczIuYW5ndWxhclNsb3AgPSAyIC8gMTgwICogbWF0aF9QSSQ2O1xuICAgICAgU2V0dGluZ3MyLm1heFN1YlN0ZXBzID0gODtcbiAgICAgIFNldHRpbmdzMi5tYXhUT0lDb250YWN0cyA9IDMyO1xuICAgICAgU2V0dGluZ3MyLm1heFRPSUl0ZXJhdGlvbnMgPSAyMDtcbiAgICAgIFNldHRpbmdzMi5tYXhEaXN0YW5jZUl0ZXJhdGlvbnMgPSAyMDtcbiAgICAgIFNldHRpbmdzMi52ZWxvY2l0eVRocmVzaG9sZCA9IDE7XG4gICAgICBTZXR0aW5nczIubWF4TGluZWFyQ29ycmVjdGlvbiA9IDAuMjtcbiAgICAgIFNldHRpbmdzMi5tYXhBbmd1bGFyQ29ycmVjdGlvbiA9IDggLyAxODAgKiBtYXRoX1BJJDY7XG4gICAgICBTZXR0aW5nczIubWF4VHJhbnNsYXRpb24gPSAyO1xuICAgICAgU2V0dGluZ3MyLm1heFJvdGF0aW9uID0gMC41ICogbWF0aF9QSSQ2O1xuICAgICAgU2V0dGluZ3MyLmJhdW1nYXJ0ZSA9IDAuMjtcbiAgICAgIFNldHRpbmdzMi50b2lCYXVnYXJ0ZSA9IDAuNzU7XG4gICAgICBTZXR0aW5nczIudGltZVRvU2xlZXAgPSAwLjU7XG4gICAgICBTZXR0aW5nczIubGluZWFyU2xlZXBUb2xlcmFuY2UgPSAwLjAxO1xuICAgICAgU2V0dGluZ3MyLmFuZ3VsYXJTbGVlcFRvbGVyYW5jZSA9IDIgLyAxODAgKiBtYXRoX1BJJDY7XG4gICAgICByZXR1cm4gU2V0dGluZ3MyO1xuICAgIH0oKVxuICApO1xuICB2YXIgU2V0dGluZ3NJbnRlcm5hbCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTZXR0aW5nc0ludGVybmFsMigpIHtcbiAgICAgIH1cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhNYW5pZm9sZFBvaW50c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heE1hbmlmb2xkUG9pbnRzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhQb2x5Z29uVmVydGljZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhQb2x5Z29uVmVydGljZXM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImFhYmJFeHRlbnNpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5hYWJiRXh0ZW5zaW9uICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwiYWFiYk11bHRpcGxpZXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5hYWJiTXVsdGlwbGllcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibGluZWFyU2xvcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmxpbmVhclNsb3AgKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJsaW5lYXJTbG9wU3F1YXJlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmxpbmVhclNsb3AgKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyICogU2V0dGluZ3MubGluZWFyU2xvcCAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImFuZ3VsYXJTbG9wXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MuYW5ndWxhclNsb3A7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcInBvbHlnb25SYWRpdXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiAyICogU2V0dGluZ3MubGluZWFyU2xvcDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4U3ViU3RlcHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhTdWJTdGVwcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4VE9JQ29udGFjdHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhUT0lDb250YWN0cztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4VE9JSXRlcmF0aW9uc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFRPSUl0ZXJhdGlvbnM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heERpc3RhbmNlSXRlcmF0aW9uc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heERpc3RhbmNlSXRlcmF0aW9ucztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwidmVsb2NpdHlUaHJlc2hvbGRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy52ZWxvY2l0eVRocmVzaG9sZCAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heExpbmVhckNvcnJlY3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhMaW5lYXJDb3JyZWN0aW9uICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4QW5ndWxhckNvcnJlY3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhBbmd1bGFyQ29ycmVjdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4VHJhbnNsYXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhUcmFuc2xhdGlvbiAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heFRyYW5zbGF0aW9uU3F1YXJlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFRyYW5zbGF0aW9uICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlciAqIFNldHRpbmdzLm1heFRyYW5zbGF0aW9uICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4Um90YXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhSb3RhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4Um90YXRpb25TcXVhcmVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4Um90YXRpb24gKiBTZXR0aW5ncy5tYXhSb3RhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwiYmF1bWdhcnRlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MuYmF1bWdhcnRlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJ0b2lCYXVnYXJ0ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLnRvaUJhdWdhcnRlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJ0aW1lVG9TbGVlcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLnRpbWVUb1NsZWVwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJsaW5lYXJTbGVlcFRvbGVyYW5jZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmxpbmVhclNsZWVwVG9sZXJhbmNlICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibGluZWFyU2xlZXBUb2xlcmFuY2VTcXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5saW5lYXJTbGVlcFRvbGVyYW5jZSAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXIgKiBTZXR0aW5ncy5saW5lYXJTbGVlcFRvbGVyYW5jZSAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImFuZ3VsYXJTbGVlcFRvbGVyYW5jZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmFuZ3VsYXJTbGVlcFRvbGVyYW5jZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwiYW5ndWxhclNsZWVwVG9sZXJhbmNlU3FyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MuYW5ndWxhclNsZWVwVG9sZXJhbmNlICogU2V0dGluZ3MuYW5ndWxhclNsZWVwVG9sZXJhbmNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBTZXR0aW5nc0ludGVybmFsMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFBvb2wgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gUG9vbDIob3B0cykge1xuICAgICAgICB0aGlzLl9saXN0ID0gW107XG4gICAgICAgIHRoaXMuX21heCA9IEluZmluaXR5O1xuICAgICAgICB0aGlzLl9oYXNDcmVhdGVGbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jcmVhdGVDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuX2hhc0FsbG9jYXRlRm4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fYWxsb2NhdGVDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuX2hhc1JlbGVhc2VGbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9yZWxlYXNlQ291bnQgPSAwO1xuICAgICAgICB0aGlzLl9oYXNEaXNwb3NlRm4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fZGlzcG9zZUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5fbGlzdCA9IFtdO1xuICAgICAgICB0aGlzLl9tYXggPSBvcHRzLm1heCB8fCB0aGlzLl9tYXg7XG4gICAgICAgIHRoaXMuX2NyZWF0ZUZuID0gb3B0cy5jcmVhdGU7XG4gICAgICAgIHRoaXMuX2hhc0NyZWF0ZUZuID0gdHlwZW9mIHRoaXMuX2NyZWF0ZUZuID09PSBcImZ1bmN0aW9uXCI7XG4gICAgICAgIHRoaXMuX2FsbG9jYXRlRm4gPSBvcHRzLmFsbG9jYXRlO1xuICAgICAgICB0aGlzLl9oYXNBbGxvY2F0ZUZuID0gdHlwZW9mIHRoaXMuX2FsbG9jYXRlRm4gPT09IFwiZnVuY3Rpb25cIjtcbiAgICAgICAgdGhpcy5fcmVsZWFzZUZuID0gb3B0cy5yZWxlYXNlO1xuICAgICAgICB0aGlzLl9oYXNSZWxlYXNlRm4gPSB0eXBlb2YgdGhpcy5fcmVsZWFzZUZuID09PSBcImZ1bmN0aW9uXCI7XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2VGbiA9IG9wdHMuZGlzcG9zZTtcbiAgICAgICAgdGhpcy5faGFzRGlzcG9zZUZuID0gdHlwZW9mIHRoaXMuX2Rpc3Bvc2VGbiA9PT0gXCJmdW5jdGlvblwiO1xuICAgICAgfVxuICAgICAgUG9vbDIucHJvdG90eXBlLm1heCA9IGZ1bmN0aW9uKG4yKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbjIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICB0aGlzLl9tYXggPSBuMjtcbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fbWF4O1xuICAgICAgfTtcbiAgICAgIFBvb2wyLnByb3RvdHlwZS5zaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9saXN0Lmxlbmd0aDtcbiAgICAgIH07XG4gICAgICBQb29sMi5wcm90b3R5cGUuYWxsb2NhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGl0ZW07XG4gICAgICAgIGlmICh0aGlzLl9saXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBpdGVtID0gdGhpcy5fbGlzdC5zaGlmdCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX2NyZWF0ZUNvdW50Kys7XG4gICAgICAgICAgaWYgKHRoaXMuX2hhc0NyZWF0ZUZuKSB7XG4gICAgICAgICAgICBpdGVtID0gdGhpcy5fY3JlYXRlRm4oKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaXRlbSA9IHt9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9hbGxvY2F0ZUNvdW50Kys7XG4gICAgICAgIGlmICh0aGlzLl9oYXNBbGxvY2F0ZUZuKSB7XG4gICAgICAgICAgdGhpcy5fYWxsb2NhdGVGbihpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgIH07XG4gICAgICBQb29sMi5wcm90b3R5cGUucmVsZWFzZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgaWYgKHRoaXMuX2xpc3QubGVuZ3RoIDwgdGhpcy5fbWF4KSB7XG4gICAgICAgICAgdGhpcy5fcmVsZWFzZUNvdW50Kys7XG4gICAgICAgICAgaWYgKHRoaXMuX2hhc1JlbGVhc2VGbikge1xuICAgICAgICAgICAgdGhpcy5fcmVsZWFzZUZuKGl0ZW0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLl9saXN0LnB1c2goaXRlbSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fZGlzcG9zZUNvdW50Kys7XG4gICAgICAgICAgaWYgKHRoaXMuX2hhc0Rpc3Bvc2VGbikge1xuICAgICAgICAgICAgaXRlbSA9IHRoaXMuX2Rpc3Bvc2VGbihpdGVtKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBQb29sMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFwiICtcIiArIHRoaXMuX2NyZWF0ZUNvdW50ICsgXCIgPlwiICsgdGhpcy5fYWxsb2NhdGVDb3VudCArIFwiIDxcIiArIHRoaXMuX3JlbGVhc2VDb3VudCArIFwiIC1cIiArIHRoaXMuX2Rpc3Bvc2VDb3VudCArIFwiID1cIiArIHRoaXMuX2xpc3QubGVuZ3RoICsgXCIvXCIgKyB0aGlzLl9tYXg7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFBvb2wyO1xuICAgIH0oKVxuICApO1xuICB2YXIgbWF0aF9hYnMkOCA9IE1hdGguYWJzO1xuICB2YXIgbWF0aF9tYXgkNiA9IE1hdGgubWF4O1xuICB2YXIgVHJlZU5vZGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVHJlZU5vZGUyKGlkKSB7XG4gICAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7XG4gICAgICAgIHRoaXMudXNlckRhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XG4gICAgICAgIHRoaXMuY2hpbGQxID0gbnVsbDtcbiAgICAgICAgdGhpcy5jaGlsZDIgPSBudWxsO1xuICAgICAgICB0aGlzLmhlaWdodCA9IC0xO1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICB9XG4gICAgICBUcmVlTm9kZTIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlkICsgXCI6IFwiICsgdGhpcy51c2VyRGF0YTtcbiAgICAgIH07XG4gICAgICBUcmVlTm9kZTIucHJvdG90eXBlLmlzTGVhZiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGlsZDEgPT0gbnVsbDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVHJlZU5vZGUyO1xuICAgIH0oKVxuICApO1xuICB2YXIgcG9vbFRyZWVOb2RlID0gbmV3IFBvb2woe1xuICAgIGNyZWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbmV3IFRyZWVOb2RlKCk7XG4gICAgfSxcbiAgICByZWxlYXNlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICBub2RlLnVzZXJEYXRhID0gbnVsbDtcbiAgICAgIG5vZGUucGFyZW50ID0gbnVsbDtcbiAgICAgIG5vZGUuY2hpbGQxID0gbnVsbDtcbiAgICAgIG5vZGUuY2hpbGQyID0gbnVsbDtcbiAgICAgIG5vZGUuaGVpZ2h0ID0gLTE7XG4gICAgICBub2RlLmlkID0gdm9pZCAwO1xuICAgIH1cbiAgfSk7XG4gIHZhciBEeW5hbWljVHJlZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBEeW5hbWljVHJlZTIoKSB7XG4gICAgICAgIHRoaXMuaW5wdXRQb29sID0gbmV3IFBvb2woe1xuICAgICAgICAgIGNyZWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZWxlYXNlOiBmdW5jdGlvbihzdGFjaykge1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc3RhY2tQb29sID0gbmV3IFBvb2woe1xuICAgICAgICAgIGNyZWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZWxlYXNlOiBmdW5jdGlvbihzdGFjaykge1xuICAgICAgICAgICAgc3RhY2subGVuZ3RoID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLml0ZXJhdG9yUG9vbCA9IG5ldyBQb29sKHtcbiAgICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBJdGVyYXRvcigpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVsZWFzZTogZnVuY3Rpb24oaXRlcmF0b3IpIHtcbiAgICAgICAgICAgIGl0ZXJhdG9yLmNsb3NlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5tX3Jvb3QgPSBudWxsO1xuICAgICAgICB0aGlzLm1fbm9kZXMgPSB7fTtcbiAgICAgICAgdGhpcy5tX2xhc3RQcm94eUlkID0gMDtcbiAgICAgIH1cbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuZ2V0VXNlckRhdGEgPSBmdW5jdGlvbihpZCkge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMubV9ub2Rlc1tpZF07XG4gICAgICAgIHJldHVybiBub2RlLnVzZXJEYXRhO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuZ2V0RmF0QUFCQiA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5tX25vZGVzW2lkXTtcbiAgICAgICAgcmV0dXJuIG5vZGUuYWFiYjtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmFsbG9jYXRlTm9kZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbm9kZSA9IHBvb2xUcmVlTm9kZS5hbGxvY2F0ZSgpO1xuICAgICAgICBub2RlLmlkID0gKyt0aGlzLm1fbGFzdFByb3h5SWQ7XG4gICAgICAgIHRoaXMubV9ub2Rlc1tub2RlLmlkXSA9IG5vZGU7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuZnJlZU5vZGUgPSBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLm1fbm9kZXNbbm9kZS5pZF07XG4gICAgICAgIHBvb2xUcmVlTm9kZS5yZWxlYXNlKG5vZGUpO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuY3JlYXRlUHJveHkgPSBmdW5jdGlvbihhYWJiLCB1c2VyRGF0YSkge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuYWxsb2NhdGVOb2RlKCk7XG4gICAgICAgIG5vZGUuYWFiYi5zZXQoYWFiYik7XG4gICAgICAgIEFBQkIuZXh0ZW5kKG5vZGUuYWFiYiwgU2V0dGluZ3NJbnRlcm5hbC5hYWJiRXh0ZW5zaW9uKTtcbiAgICAgICAgbm9kZS51c2VyRGF0YSA9IHVzZXJEYXRhO1xuICAgICAgICBub2RlLmhlaWdodCA9IDA7XG4gICAgICAgIHRoaXMuaW5zZXJ0TGVhZihub2RlKTtcbiAgICAgICAgcmV0dXJuIG5vZGUuaWQ7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5kZXN0cm95UHJveHkgPSBmdW5jdGlvbihpZCkge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMubV9ub2Rlc1tpZF07XG4gICAgICAgIHRoaXMucmVtb3ZlTGVhZihub2RlKTtcbiAgICAgICAgdGhpcy5mcmVlTm9kZShub2RlKTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLm1vdmVQcm94eSA9IGZ1bmN0aW9uKGlkLCBhYWJiLCBkMikge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMubV9ub2Rlc1tpZF07XG4gICAgICAgIGlmIChub2RlLmFhYmIuY29udGFpbnMoYWFiYikpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW1vdmVMZWFmKG5vZGUpO1xuICAgICAgICBub2RlLmFhYmIuc2V0KGFhYmIpO1xuICAgICAgICBhYWJiID0gbm9kZS5hYWJiO1xuICAgICAgICBBQUJCLmV4dGVuZChhYWJiLCBTZXR0aW5nc0ludGVybmFsLmFhYmJFeHRlbnNpb24pO1xuICAgICAgICBpZiAoZDIueCA8IDApIHtcbiAgICAgICAgICBhYWJiLmxvd2VyQm91bmQueCArPSBkMi54ICogU2V0dGluZ3NJbnRlcm5hbC5hYWJiTXVsdGlwbGllcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhYWJiLnVwcGVyQm91bmQueCArPSBkMi54ICogU2V0dGluZ3NJbnRlcm5hbC5hYWJiTXVsdGlwbGllcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZDIueSA8IDApIHtcbiAgICAgICAgICBhYWJiLmxvd2VyQm91bmQueSArPSBkMi55ICogU2V0dGluZ3NJbnRlcm5hbC5hYWJiTXVsdGlwbGllcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhYWJiLnVwcGVyQm91bmQueSArPSBkMi55ICogU2V0dGluZ3NJbnRlcm5hbC5hYWJiTXVsdGlwbGllcjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluc2VydExlYWYobm9kZSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuaW5zZXJ0TGVhZiA9IGZ1bmN0aW9uKGxlYWYpIHtcbiAgICAgICAgaWYgKHRoaXMubV9yb290ID09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLm1fcm9vdCA9IGxlYWY7XG4gICAgICAgICAgdGhpcy5tX3Jvb3QucGFyZW50ID0gbnVsbDtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxlYWZBQUJCID0gbGVhZi5hYWJiO1xuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLm1fcm9vdDtcbiAgICAgICAgd2hpbGUgKCFpbmRleC5pc0xlYWYoKSkge1xuICAgICAgICAgIHZhciBjaGlsZDEgPSBpbmRleC5jaGlsZDE7XG4gICAgICAgICAgdmFyIGNoaWxkMiA9IGluZGV4LmNoaWxkMjtcbiAgICAgICAgICB2YXIgYXJlYSA9IGluZGV4LmFhYmIuZ2V0UGVyaW1ldGVyKCk7XG4gICAgICAgICAgdmFyIGNvbWJpbmVkQXJlYSA9IEFBQkIuY29tYmluZWRQZXJpbWV0ZXIoaW5kZXguYWFiYiwgbGVhZkFBQkIpO1xuICAgICAgICAgIHZhciBjb3N0ID0gMiAqIGNvbWJpbmVkQXJlYTtcbiAgICAgICAgICB2YXIgaW5oZXJpdGFuY2VDb3N0ID0gMiAqIChjb21iaW5lZEFyZWEgLSBhcmVhKTtcbiAgICAgICAgICB2YXIgbmV3QXJlYTEgPSBBQUJCLmNvbWJpbmVkUGVyaW1ldGVyKGxlYWZBQUJCLCBjaGlsZDEuYWFiYik7XG4gICAgICAgICAgdmFyIGNvc3QxID0gbmV3QXJlYTEgKyBpbmhlcml0YW5jZUNvc3Q7XG4gICAgICAgICAgaWYgKCFjaGlsZDEuaXNMZWFmKCkpIHtcbiAgICAgICAgICAgIHZhciBvbGRBcmVhID0gY2hpbGQxLmFhYmIuZ2V0UGVyaW1ldGVyKCk7XG4gICAgICAgICAgICBjb3N0MSAtPSBvbGRBcmVhO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgbmV3QXJlYTIgPSBBQUJCLmNvbWJpbmVkUGVyaW1ldGVyKGxlYWZBQUJCLCBjaGlsZDIuYWFiYik7XG4gICAgICAgICAgdmFyIGNvc3QyID0gbmV3QXJlYTIgKyBpbmhlcml0YW5jZUNvc3Q7XG4gICAgICAgICAgaWYgKCFjaGlsZDIuaXNMZWFmKCkpIHtcbiAgICAgICAgICAgIHZhciBvbGRBcmVhID0gY2hpbGQyLmFhYmIuZ2V0UGVyaW1ldGVyKCk7XG4gICAgICAgICAgICBjb3N0MiAtPSBvbGRBcmVhO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY29zdCA8IGNvc3QxICYmIGNvc3QgPCBjb3N0Mikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjb3N0MSA8IGNvc3QyKSB7XG4gICAgICAgICAgICBpbmRleCA9IGNoaWxkMTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5kZXggPSBjaGlsZDI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBzaWJsaW5nID0gaW5kZXg7XG4gICAgICAgIHZhciBvbGRQYXJlbnQgPSBzaWJsaW5nLnBhcmVudDtcbiAgICAgICAgdmFyIG5ld1BhcmVudCA9IHRoaXMuYWxsb2NhdGVOb2RlKCk7XG4gICAgICAgIG5ld1BhcmVudC5wYXJlbnQgPSBvbGRQYXJlbnQ7XG4gICAgICAgIG5ld1BhcmVudC51c2VyRGF0YSA9IG51bGw7XG4gICAgICAgIG5ld1BhcmVudC5hYWJiLmNvbWJpbmUobGVhZkFBQkIsIHNpYmxpbmcuYWFiYik7XG4gICAgICAgIG5ld1BhcmVudC5oZWlnaHQgPSBzaWJsaW5nLmhlaWdodCArIDE7XG4gICAgICAgIGlmIChvbGRQYXJlbnQgIT0gbnVsbCkge1xuICAgICAgICAgIGlmIChvbGRQYXJlbnQuY2hpbGQxID09PSBzaWJsaW5nKSB7XG4gICAgICAgICAgICBvbGRQYXJlbnQuY2hpbGQxID0gbmV3UGFyZW50O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvbGRQYXJlbnQuY2hpbGQyID0gbmV3UGFyZW50O1xuICAgICAgICAgIH1cbiAgICAgICAgICBuZXdQYXJlbnQuY2hpbGQxID0gc2libGluZztcbiAgICAgICAgICBuZXdQYXJlbnQuY2hpbGQyID0gbGVhZjtcbiAgICAgICAgICBzaWJsaW5nLnBhcmVudCA9IG5ld1BhcmVudDtcbiAgICAgICAgICBsZWFmLnBhcmVudCA9IG5ld1BhcmVudDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdQYXJlbnQuY2hpbGQxID0gc2libGluZztcbiAgICAgICAgICBuZXdQYXJlbnQuY2hpbGQyID0gbGVhZjtcbiAgICAgICAgICBzaWJsaW5nLnBhcmVudCA9IG5ld1BhcmVudDtcbiAgICAgICAgICBsZWFmLnBhcmVudCA9IG5ld1BhcmVudDtcbiAgICAgICAgICB0aGlzLm1fcm9vdCA9IG5ld1BhcmVudDtcbiAgICAgICAgfVxuICAgICAgICBpbmRleCA9IGxlYWYucGFyZW50O1xuICAgICAgICB3aGlsZSAoaW5kZXggIT0gbnVsbCkge1xuICAgICAgICAgIGluZGV4ID0gdGhpcy5iYWxhbmNlKGluZGV4KTtcbiAgICAgICAgICB2YXIgY2hpbGQxID0gaW5kZXguY2hpbGQxO1xuICAgICAgICAgIHZhciBjaGlsZDIgPSBpbmRleC5jaGlsZDI7XG4gICAgICAgICAgaW5kZXguaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoY2hpbGQxLmhlaWdodCwgY2hpbGQyLmhlaWdodCk7XG4gICAgICAgICAgaW5kZXguYWFiYi5jb21iaW5lKGNoaWxkMS5hYWJiLCBjaGlsZDIuYWFiYik7XG4gICAgICAgICAgaW5kZXggPSBpbmRleC5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLnJlbW92ZUxlYWYgPSBmdW5jdGlvbihsZWFmKSB7XG4gICAgICAgIGlmIChsZWFmID09PSB0aGlzLm1fcm9vdCkge1xuICAgICAgICAgIHRoaXMubV9yb290ID0gbnVsbDtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhcmVudCA9IGxlYWYucGFyZW50O1xuICAgICAgICB2YXIgZ3JhbmRQYXJlbnQgPSBwYXJlbnQucGFyZW50O1xuICAgICAgICB2YXIgc2libGluZztcbiAgICAgICAgaWYgKHBhcmVudC5jaGlsZDEgPT09IGxlYWYpIHtcbiAgICAgICAgICBzaWJsaW5nID0gcGFyZW50LmNoaWxkMjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzaWJsaW5nID0gcGFyZW50LmNoaWxkMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ3JhbmRQYXJlbnQgIT0gbnVsbCkge1xuICAgICAgICAgIGlmIChncmFuZFBhcmVudC5jaGlsZDEgPT09IHBhcmVudCkge1xuICAgICAgICAgICAgZ3JhbmRQYXJlbnQuY2hpbGQxID0gc2libGluZztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ3JhbmRQYXJlbnQuY2hpbGQyID0gc2libGluZztcbiAgICAgICAgICB9XG4gICAgICAgICAgc2libGluZy5wYXJlbnQgPSBncmFuZFBhcmVudDtcbiAgICAgICAgICB0aGlzLmZyZWVOb2RlKHBhcmVudCk7XG4gICAgICAgICAgdmFyIGluZGV4ID0gZ3JhbmRQYXJlbnQ7XG4gICAgICAgICAgd2hpbGUgKGluZGV4ICE9IG51bGwpIHtcbiAgICAgICAgICAgIGluZGV4ID0gdGhpcy5iYWxhbmNlKGluZGV4KTtcbiAgICAgICAgICAgIHZhciBjaGlsZDEgPSBpbmRleC5jaGlsZDE7XG4gICAgICAgICAgICB2YXIgY2hpbGQyID0gaW5kZXguY2hpbGQyO1xuICAgICAgICAgICAgaW5kZXguYWFiYi5jb21iaW5lKGNoaWxkMS5hYWJiLCBjaGlsZDIuYWFiYik7XG4gICAgICAgICAgICBpbmRleC5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihjaGlsZDEuaGVpZ2h0LCBjaGlsZDIuaGVpZ2h0KTtcbiAgICAgICAgICAgIGluZGV4ID0gaW5kZXgucGFyZW50O1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fcm9vdCA9IHNpYmxpbmc7XG4gICAgICAgICAgc2libGluZy5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgIHRoaXMuZnJlZU5vZGUocGFyZW50KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuYmFsYW5jZSA9IGZ1bmN0aW9uKGlBKSB7XG4gICAgICAgIHZhciBBID0gaUE7XG4gICAgICAgIGlmIChBLmlzTGVhZigpIHx8IEEuaGVpZ2h0IDwgMikge1xuICAgICAgICAgIHJldHVybiBpQTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgQiA9IEEuY2hpbGQxO1xuICAgICAgICB2YXIgQyA9IEEuY2hpbGQyO1xuICAgICAgICB2YXIgYmFsYW5jZSA9IEMuaGVpZ2h0IC0gQi5oZWlnaHQ7XG4gICAgICAgIGlmIChiYWxhbmNlID4gMSkge1xuICAgICAgICAgIHZhciBGID0gQy5jaGlsZDE7XG4gICAgICAgICAgdmFyIEcgPSBDLmNoaWxkMjtcbiAgICAgICAgICBDLmNoaWxkMSA9IEE7XG4gICAgICAgICAgQy5wYXJlbnQgPSBBLnBhcmVudDtcbiAgICAgICAgICBBLnBhcmVudCA9IEM7XG4gICAgICAgICAgaWYgKEMucGFyZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChDLnBhcmVudC5jaGlsZDEgPT09IGlBKSB7XG4gICAgICAgICAgICAgIEMucGFyZW50LmNoaWxkMSA9IEM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBDLnBhcmVudC5jaGlsZDIgPSBDO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1fcm9vdCA9IEM7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChGLmhlaWdodCA+IEcuaGVpZ2h0KSB7XG4gICAgICAgICAgICBDLmNoaWxkMiA9IEY7XG4gICAgICAgICAgICBBLmNoaWxkMiA9IEc7XG4gICAgICAgICAgICBHLnBhcmVudCA9IEE7XG4gICAgICAgICAgICBBLmFhYmIuY29tYmluZShCLmFhYmIsIEcuYWFiYik7XG4gICAgICAgICAgICBDLmFhYmIuY29tYmluZShBLmFhYmIsIEYuYWFiYik7XG4gICAgICAgICAgICBBLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KEIuaGVpZ2h0LCBHLmhlaWdodCk7XG4gICAgICAgICAgICBDLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KEEuaGVpZ2h0LCBGLmhlaWdodCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIEMuY2hpbGQyID0gRztcbiAgICAgICAgICAgIEEuY2hpbGQyID0gRjtcbiAgICAgICAgICAgIEYucGFyZW50ID0gQTtcbiAgICAgICAgICAgIEEuYWFiYi5jb21iaW5lKEIuYWFiYiwgRi5hYWJiKTtcbiAgICAgICAgICAgIEMuYWFiYi5jb21iaW5lKEEuYWFiYiwgRy5hYWJiKTtcbiAgICAgICAgICAgIEEuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoQi5oZWlnaHQsIEYuaGVpZ2h0KTtcbiAgICAgICAgICAgIEMuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoQS5oZWlnaHQsIEcuaGVpZ2h0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIEM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJhbGFuY2UgPCAtMSkge1xuICAgICAgICAgIHZhciBEID0gQi5jaGlsZDE7XG4gICAgICAgICAgdmFyIEUgPSBCLmNoaWxkMjtcbiAgICAgICAgICBCLmNoaWxkMSA9IEE7XG4gICAgICAgICAgQi5wYXJlbnQgPSBBLnBhcmVudDtcbiAgICAgICAgICBBLnBhcmVudCA9IEI7XG4gICAgICAgICAgaWYgKEIucGFyZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChCLnBhcmVudC5jaGlsZDEgPT09IEEpIHtcbiAgICAgICAgICAgICAgQi5wYXJlbnQuY2hpbGQxID0gQjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIEIucGFyZW50LmNoaWxkMiA9IEI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV9yb290ID0gQjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKEQuaGVpZ2h0ID4gRS5oZWlnaHQpIHtcbiAgICAgICAgICAgIEIuY2hpbGQyID0gRDtcbiAgICAgICAgICAgIEEuY2hpbGQxID0gRTtcbiAgICAgICAgICAgIEUucGFyZW50ID0gQTtcbiAgICAgICAgICAgIEEuYWFiYi5jb21iaW5lKEMuYWFiYiwgRS5hYWJiKTtcbiAgICAgICAgICAgIEIuYWFiYi5jb21iaW5lKEEuYWFiYiwgRC5hYWJiKTtcbiAgICAgICAgICAgIEEuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoQy5oZWlnaHQsIEUuaGVpZ2h0KTtcbiAgICAgICAgICAgIEIuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoQS5oZWlnaHQsIEQuaGVpZ2h0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgQi5jaGlsZDIgPSBFO1xuICAgICAgICAgICAgQS5jaGlsZDEgPSBEO1xuICAgICAgICAgICAgRC5wYXJlbnQgPSBBO1xuICAgICAgICAgICAgQS5hYWJiLmNvbWJpbmUoQy5hYWJiLCBELmFhYmIpO1xuICAgICAgICAgICAgQi5hYWJiLmNvbWJpbmUoQS5hYWJiLCBFLmFhYmIpO1xuICAgICAgICAgICAgQS5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihDLmhlaWdodCwgRC5oZWlnaHQpO1xuICAgICAgICAgICAgQi5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihBLmhlaWdodCwgRS5oZWlnaHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gQjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gQTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5tX3Jvb3QgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm1fcm9vdC5oZWlnaHQ7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5nZXRBcmVhUmF0aW8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMubV9yb290ID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcm9vdCA9IHRoaXMubV9yb290O1xuICAgICAgICB2YXIgcm9vdEFyZWEgPSByb290LmFhYmIuZ2V0UGVyaW1ldGVyKCk7XG4gICAgICAgIHZhciB0b3RhbEFyZWEgPSAwO1xuICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgdmFyIGl0ID0gdGhpcy5pdGVyYXRvclBvb2wuYWxsb2NhdGUoKS5wcmVvcmRlcih0aGlzLm1fcm9vdCk7XG4gICAgICAgIHdoaWxlIChub2RlID0gaXQubmV4dCgpKSB7XG4gICAgICAgICAgaWYgKG5vZGUuaGVpZ2h0IDwgMCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRvdGFsQXJlYSArPSBub2RlLmFhYmIuZ2V0UGVyaW1ldGVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVyYXRvclBvb2wucmVsZWFzZShpdCk7XG4gICAgICAgIHJldHVybiB0b3RhbEFyZWEgLyByb290QXJlYTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmNvbXB1dGVIZWlnaHQgPSBmdW5jdGlvbihpZCkge1xuICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgaWYgKHR5cGVvZiBpZCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIG5vZGUgPSB0aGlzLm1fbm9kZXNbaWRdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5vZGUgPSB0aGlzLm1fcm9vdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZS5pc0xlYWYoKSkge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciBoZWlnaHQxID0gdGhpcy5jb21wdXRlSGVpZ2h0KG5vZGUuY2hpbGQxLmlkKTtcbiAgICAgICAgdmFyIGhlaWdodDIgPSB0aGlzLmNvbXB1dGVIZWlnaHQobm9kZS5jaGlsZDIuaWQpO1xuICAgICAgICByZXR1cm4gMSArIG1hdGhfbWF4JDYoaGVpZ2h0MSwgaGVpZ2h0Mik7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS52YWxpZGF0ZVN0cnVjdHVyZSA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZSA9PT0gdGhpcy5tX3Jvb3QpIDtcbiAgICAgICAgdmFyIGNoaWxkMSA9IG5vZGUuY2hpbGQxO1xuICAgICAgICB2YXIgY2hpbGQyID0gbm9kZS5jaGlsZDI7XG4gICAgICAgIGlmIChub2RlLmlzTGVhZigpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFsaWRhdGVTdHJ1Y3R1cmUoY2hpbGQxKTtcbiAgICAgICAgdGhpcy52YWxpZGF0ZVN0cnVjdHVyZShjaGlsZDIpO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUudmFsaWRhdGVNZXRyaWNzID0gZnVuY3Rpb24obm9kZSkge1xuICAgICAgICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGlsZDEgPSBub2RlLmNoaWxkMTtcbiAgICAgICAgdmFyIGNoaWxkMiA9IG5vZGUuY2hpbGQyO1xuICAgICAgICBpZiAobm9kZS5pc0xlYWYoKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbGlkYXRlTWV0cmljcyhjaGlsZDEpO1xuICAgICAgICB0aGlzLnZhbGlkYXRlTWV0cmljcyhjaGlsZDIpO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuZ2V0TWF4QmFsYW5jZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbWF4QmFsYW5jZSA9IDA7XG4gICAgICAgIHZhciBub2RlO1xuICAgICAgICB2YXIgaXQgPSB0aGlzLml0ZXJhdG9yUG9vbC5hbGxvY2F0ZSgpLnByZW9yZGVyKHRoaXMubV9yb290KTtcbiAgICAgICAgd2hpbGUgKG5vZGUgPSBpdC5uZXh0KCkpIHtcbiAgICAgICAgICBpZiAobm9kZS5oZWlnaHQgPD0gMSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBiYWxhbmNlID0gbWF0aF9hYnMkOChub2RlLmNoaWxkMi5oZWlnaHQgLSBub2RlLmNoaWxkMS5oZWlnaHQpO1xuICAgICAgICAgIG1heEJhbGFuY2UgPSBtYXRoX21heCQ2KG1heEJhbGFuY2UsIGJhbGFuY2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXRlcmF0b3JQb29sLnJlbGVhc2UoaXQpO1xuICAgICAgICByZXR1cm4gbWF4QmFsYW5jZTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLnJlYnVpbGRCb3R0b21VcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbm9kZXMgPSBbXTtcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgIHZhciBpdCA9IHRoaXMuaXRlcmF0b3JQb29sLmFsbG9jYXRlKCkucHJlb3JkZXIodGhpcy5tX3Jvb3QpO1xuICAgICAgICB3aGlsZSAobm9kZSA9IGl0Lm5leHQoKSkge1xuICAgICAgICAgIGlmIChub2RlLmhlaWdodCA8IDApIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobm9kZS5pc0xlYWYoKSkge1xuICAgICAgICAgICAgbm9kZS5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgICAgbm9kZXNbY291bnRdID0gbm9kZTtcbiAgICAgICAgICAgICsrY291bnQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZnJlZU5vZGUobm9kZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXRlcmF0b3JQb29sLnJlbGVhc2UoaXQpO1xuICAgICAgICB3aGlsZSAoY291bnQgPiAxKSB7XG4gICAgICAgICAgdmFyIG1pbkNvc3QgPSBJbmZpbml0eTtcbiAgICAgICAgICB2YXIgaU1pbiA9IC0xO1xuICAgICAgICAgIHZhciBqTWluID0gLTE7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgYWFiYmkgPSBub2Rlc1tpXS5hYWJiO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IGkgKyAxOyBqIDwgY291bnQ7ICsraikge1xuICAgICAgICAgICAgICB2YXIgYWFiYmogPSBub2Rlc1tqXS5hYWJiO1xuICAgICAgICAgICAgICB2YXIgY29zdCA9IEFBQkIuY29tYmluZWRQZXJpbWV0ZXIoYWFiYmksIGFhYmJqKTtcbiAgICAgICAgICAgICAgaWYgKGNvc3QgPCBtaW5Db3N0KSB7XG4gICAgICAgICAgICAgICAgaU1pbiA9IGk7XG4gICAgICAgICAgICAgICAgak1pbiA9IGo7XG4gICAgICAgICAgICAgICAgbWluQ29zdCA9IGNvc3Q7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGNoaWxkMSA9IG5vZGVzW2lNaW5dO1xuICAgICAgICAgIHZhciBjaGlsZDIgPSBub2Rlc1tqTWluXTtcbiAgICAgICAgICB2YXIgcGFyZW50XzEgPSB0aGlzLmFsbG9jYXRlTm9kZSgpO1xuICAgICAgICAgIHBhcmVudF8xLmNoaWxkMSA9IGNoaWxkMTtcbiAgICAgICAgICBwYXJlbnRfMS5jaGlsZDIgPSBjaGlsZDI7XG4gICAgICAgICAgcGFyZW50XzEuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoY2hpbGQxLmhlaWdodCwgY2hpbGQyLmhlaWdodCk7XG4gICAgICAgICAgcGFyZW50XzEuYWFiYi5jb21iaW5lKGNoaWxkMS5hYWJiLCBjaGlsZDIuYWFiYik7XG4gICAgICAgICAgcGFyZW50XzEucGFyZW50ID0gbnVsbDtcbiAgICAgICAgICBjaGlsZDEucGFyZW50ID0gcGFyZW50XzE7XG4gICAgICAgICAgY2hpbGQyLnBhcmVudCA9IHBhcmVudF8xO1xuICAgICAgICAgIG5vZGVzW2pNaW5dID0gbm9kZXNbY291bnQgLSAxXTtcbiAgICAgICAgICBub2Rlc1tpTWluXSA9IHBhcmVudF8xO1xuICAgICAgICAgIC0tY291bnQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3Jvb3QgPSBub2Rlc1swXTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLnNoaWZ0T3JpZ2luID0gZnVuY3Rpb24obmV3T3JpZ2luKSB7XG4gICAgICAgIHZhciBub2RlO1xuICAgICAgICB2YXIgaXQgPSB0aGlzLml0ZXJhdG9yUG9vbC5hbGxvY2F0ZSgpLnByZW9yZGVyKHRoaXMubV9yb290KTtcbiAgICAgICAgd2hpbGUgKG5vZGUgPSBpdC5uZXh0KCkpIHtcbiAgICAgICAgICB2YXIgYWFiYiA9IG5vZGUuYWFiYjtcbiAgICAgICAgICBhYWJiLmxvd2VyQm91bmQueCAtPSBuZXdPcmlnaW4ueDtcbiAgICAgICAgICBhYWJiLmxvd2VyQm91bmQueSAtPSBuZXdPcmlnaW4ueTtcbiAgICAgICAgICBhYWJiLnVwcGVyQm91bmQueCAtPSBuZXdPcmlnaW4ueDtcbiAgICAgICAgICBhYWJiLnVwcGVyQm91bmQueSAtPSBuZXdPcmlnaW4ueTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLml0ZXJhdG9yUG9vbC5yZWxlYXNlKGl0KTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLnF1ZXJ5ID0gZnVuY3Rpb24oYWFiYiwgcXVlcnlDYWxsYmFjaykge1xuICAgICAgICB2YXIgc3RhY2sgPSB0aGlzLnN0YWNrUG9vbC5hbGxvY2F0ZSgpO1xuICAgICAgICBzdGFjay5wdXNoKHRoaXMubV9yb290KTtcbiAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2YXIgbm9kZSA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgIGlmIChub2RlID09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoQUFCQi50ZXN0T3ZlcmxhcChub2RlLmFhYmIsIGFhYmIpKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5pc0xlYWYoKSkge1xuICAgICAgICAgICAgICB2YXIgcHJvY2VlZCA9IHF1ZXJ5Q2FsbGJhY2sobm9kZS5pZCk7XG4gICAgICAgICAgICAgIGlmIChwcm9jZWVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc3RhY2sucHVzaChub2RlLmNoaWxkMSk7XG4gICAgICAgICAgICAgIHN0YWNrLnB1c2gobm9kZS5jaGlsZDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0YWNrUG9vbC5yZWxlYXNlKHN0YWNrKTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLnJheUNhc3QgPSBmdW5jdGlvbihpbnB1dDIsIHJheUNhc3RDYWxsYmFjaykge1xuICAgICAgICB2YXIgcDEgPSBpbnB1dDIucDE7XG4gICAgICAgIHZhciBwMiA9IGlucHV0Mi5wMjtcbiAgICAgICAgdmFyIHIgPSBWZWMyLnN1YihwMiwgcDEpO1xuICAgICAgICByLm5vcm1hbGl6ZSgpO1xuICAgICAgICB2YXIgdjMgPSBWZWMyLmNyb3NzTnVtVmVjMigxLCByKTtcbiAgICAgICAgdmFyIGFic192ID0gVmVjMi5hYnModjMpO1xuICAgICAgICB2YXIgbWF4RnJhY3Rpb24gPSBpbnB1dDIubWF4RnJhY3Rpb247XG4gICAgICAgIHZhciBzZWdtZW50QUFCQiA9IG5ldyBBQUJCKCk7XG4gICAgICAgIHZhciB0ID0gVmVjMi5jb21iaW5lKDEgLSBtYXhGcmFjdGlvbiwgcDEsIG1heEZyYWN0aW9uLCBwMik7XG4gICAgICAgIHNlZ21lbnRBQUJCLmNvbWJpbmVQb2ludHMocDEsIHQpO1xuICAgICAgICB2YXIgc3RhY2sgPSB0aGlzLnN0YWNrUG9vbC5hbGxvY2F0ZSgpO1xuICAgICAgICB2YXIgc3ViSW5wdXQgPSB0aGlzLmlucHV0UG9vbC5hbGxvY2F0ZSgpO1xuICAgICAgICBzdGFjay5wdXNoKHRoaXMubV9yb290KTtcbiAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2YXIgbm9kZSA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgIGlmIChub2RlID09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoQUFCQi50ZXN0T3ZlcmxhcChub2RlLmFhYmIsIHNlZ21lbnRBQUJCKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgYzIgPSBub2RlLmFhYmIuZ2V0Q2VudGVyKCk7XG4gICAgICAgICAgdmFyIGggPSBub2RlLmFhYmIuZ2V0RXh0ZW50cygpO1xuICAgICAgICAgIHZhciBzZXBhcmF0aW9uID0gbWF0aF9hYnMkOChWZWMyLmRvdCh2MywgVmVjMi5zdWIocDEsIGMyKSkpIC0gVmVjMi5kb3QoYWJzX3YsIGgpO1xuICAgICAgICAgIGlmIChzZXBhcmF0aW9uID4gMCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChub2RlLmlzTGVhZigpKSB7XG4gICAgICAgICAgICBzdWJJbnB1dC5wMSA9IFZlYzIuY2xvbmUoaW5wdXQyLnAxKTtcbiAgICAgICAgICAgIHN1YklucHV0LnAyID0gVmVjMi5jbG9uZShpbnB1dDIucDIpO1xuICAgICAgICAgICAgc3ViSW5wdXQubWF4RnJhY3Rpb24gPSBtYXhGcmFjdGlvbjtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHJheUNhc3RDYWxsYmFjayhzdWJJbnB1dCwgbm9kZS5pZCk7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IDApIHtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID4gMCkge1xuICAgICAgICAgICAgICBtYXhGcmFjdGlvbiA9IHZhbHVlO1xuICAgICAgICAgICAgICB0ID0gVmVjMi5jb21iaW5lKDEgLSBtYXhGcmFjdGlvbiwgcDEsIG1heEZyYWN0aW9uLCBwMik7XG4gICAgICAgICAgICAgIHNlZ21lbnRBQUJCLmNvbWJpbmVQb2ludHMocDEsIHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGFjay5wdXNoKG5vZGUuY2hpbGQxKTtcbiAgICAgICAgICAgIHN0YWNrLnB1c2gobm9kZS5jaGlsZDIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0YWNrUG9vbC5yZWxlYXNlKHN0YWNrKTtcbiAgICAgICAgdGhpcy5pbnB1dFBvb2wucmVsZWFzZShzdWJJbnB1dCk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIER5bmFtaWNUcmVlMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIEl0ZXJhdG9yID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEl0ZXJhdG9yMigpIHtcbiAgICAgICAgdGhpcy5wYXJlbnRzID0gW107XG4gICAgICAgIHRoaXMuc3RhdGVzID0gW107XG4gICAgICB9XG4gICAgICBJdGVyYXRvcjIucHJvdG90eXBlLnByZW9yZGVyID0gZnVuY3Rpb24ocm9vdCkge1xuICAgICAgICB0aGlzLnBhcmVudHMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5wYXJlbnRzLnB1c2gocm9vdCk7XG4gICAgICAgIHRoaXMuc3RhdGVzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuc3RhdGVzLnB1c2goMCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEl0ZXJhdG9yMi5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB3aGlsZSAodGhpcy5wYXJlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2YXIgaSA9IHRoaXMucGFyZW50cy5sZW5ndGggLSAxO1xuICAgICAgICAgIHZhciBub2RlID0gdGhpcy5wYXJlbnRzW2ldO1xuICAgICAgICAgIGlmICh0aGlzLnN0YXRlc1tpXSA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZXNbaV0gPSAxO1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0aGlzLnN0YXRlc1tpXSA9PT0gMSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZXNbaV0gPSAyO1xuICAgICAgICAgICAgaWYgKG5vZGUuY2hpbGQxKSB7XG4gICAgICAgICAgICAgIHRoaXMucGFyZW50cy5wdXNoKG5vZGUuY2hpbGQxKTtcbiAgICAgICAgICAgICAgdGhpcy5zdGF0ZXMucHVzaCgxKTtcbiAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuY2hpbGQxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5zdGF0ZXNbaV0gPT09IDIpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGVzW2ldID0gMztcbiAgICAgICAgICAgIGlmIChub2RlLmNoaWxkMikge1xuICAgICAgICAgICAgICB0aGlzLnBhcmVudHMucHVzaChub2RlLmNoaWxkMik7XG4gICAgICAgICAgICAgIHRoaXMuc3RhdGVzLnB1c2goMSk7XG4gICAgICAgICAgICAgIHJldHVybiBub2RlLmNoaWxkMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5wYXJlbnRzLnBvcCgpO1xuICAgICAgICAgIHRoaXMuc3RhdGVzLnBvcCgpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgSXRlcmF0b3IyLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnBhcmVudHMubGVuZ3RoID0gMDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gSXRlcmF0b3IyO1xuICAgIH0oKVxuICApO1xuICB2YXIgbWF0aF9tYXgkNSA9IE1hdGgubWF4O1xuICB2YXIgbWF0aF9taW4kNiA9IE1hdGgubWluO1xuICB2YXIgQnJvYWRQaGFzZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBCcm9hZFBoYXNlMigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5tX3RyZWUgPSBuZXcgRHluYW1pY1RyZWUoKTtcbiAgICAgICAgdGhpcy5tX21vdmVCdWZmZXIgPSBbXTtcbiAgICAgICAgdGhpcy5xdWVyeSA9IGZ1bmN0aW9uKGFhYmIsIHF1ZXJ5Q2FsbGJhY2spIHtcbiAgICAgICAgICBfdGhpcy5tX3RyZWUucXVlcnkoYWFiYiwgcXVlcnlDYWxsYmFjayk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucXVlcnlDYWxsYmFjayA9IGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgICBpZiAocHJveHlJZCA9PT0gX3RoaXMubV9xdWVyeVByb3h5SWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcHJveHlJZEEgPSBtYXRoX21pbiQ2KHByb3h5SWQsIF90aGlzLm1fcXVlcnlQcm94eUlkKTtcbiAgICAgICAgICB2YXIgcHJveHlJZEIgPSBtYXRoX21heCQ1KHByb3h5SWQsIF90aGlzLm1fcXVlcnlQcm94eUlkKTtcbiAgICAgICAgICB2YXIgdXNlckRhdGFBID0gX3RoaXMubV90cmVlLmdldFVzZXJEYXRhKHByb3h5SWRBKTtcbiAgICAgICAgICB2YXIgdXNlckRhdGFCID0gX3RoaXMubV90cmVlLmdldFVzZXJEYXRhKHByb3h5SWRCKTtcbiAgICAgICAgICBfdGhpcy5tX2NhbGxiYWNrKHVzZXJEYXRhQSwgdXNlckRhdGFCKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5nZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90cmVlLmdldFVzZXJEYXRhKHByb3h5SWQpO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS50ZXN0T3ZlcmxhcCA9IGZ1bmN0aW9uKHByb3h5SWRBLCBwcm94eUlkQikge1xuICAgICAgICB2YXIgYWFiYkEgPSB0aGlzLm1fdHJlZS5nZXRGYXRBQUJCKHByb3h5SWRBKTtcbiAgICAgICAgdmFyIGFhYmJCID0gdGhpcy5tX3RyZWUuZ2V0RmF0QUFCQihwcm94eUlkQik7XG4gICAgICAgIHJldHVybiBBQUJCLnRlc3RPdmVybGFwKGFhYmJBLCBhYWJiQik7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmdldEZhdEFBQkIgPSBmdW5jdGlvbihwcm94eUlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHJlZS5nZXRGYXRBQUJCKHByb3h5SWQpO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5nZXRQcm94eUNvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbW92ZUJ1ZmZlci5sZW5ndGg7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmdldFRyZWVIZWlnaHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90cmVlLmdldEhlaWdodCgpO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5nZXRUcmVlQmFsYW5jZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RyZWUuZ2V0TWF4QmFsYW5jZSgpO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5nZXRUcmVlUXVhbGl0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RyZWUuZ2V0QXJlYVJhdGlvKCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLnJheUNhc3QgPSBmdW5jdGlvbihpbnB1dDIsIHJheUNhc3RDYWxsYmFjaykge1xuICAgICAgICB0aGlzLm1fdHJlZS5yYXlDYXN0KGlucHV0MiwgcmF5Q2FzdENhbGxiYWNrKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuc2hpZnRPcmlnaW4gPSBmdW5jdGlvbihuZXdPcmlnaW4pIHtcbiAgICAgICAgdGhpcy5tX3RyZWUuc2hpZnRPcmlnaW4obmV3T3JpZ2luKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuY3JlYXRlUHJveHkgPSBmdW5jdGlvbihhYWJiLCB1c2VyRGF0YSkge1xuICAgICAgICB2YXIgcHJveHlJZCA9IHRoaXMubV90cmVlLmNyZWF0ZVByb3h5KGFhYmIsIHVzZXJEYXRhKTtcbiAgICAgICAgdGhpcy5idWZmZXJNb3ZlKHByb3h5SWQpO1xuICAgICAgICByZXR1cm4gcHJveHlJZDtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuZGVzdHJveVByb3h5ID0gZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICB0aGlzLnVuYnVmZmVyTW92ZShwcm94eUlkKTtcbiAgICAgICAgdGhpcy5tX3RyZWUuZGVzdHJveVByb3h5KHByb3h5SWQpO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5tb3ZlUHJveHkgPSBmdW5jdGlvbihwcm94eUlkLCBhYWJiLCBkaXNwbGFjZW1lbnQyKSB7XG4gICAgICAgIHZhciBjaGFuZ2VkID0gdGhpcy5tX3RyZWUubW92ZVByb3h5KHByb3h5SWQsIGFhYmIsIGRpc3BsYWNlbWVudDIpO1xuICAgICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICAgIHRoaXMuYnVmZmVyTW92ZShwcm94eUlkKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS50b3VjaFByb3h5ID0gZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICB0aGlzLmJ1ZmZlck1vdmUocHJveHlJZCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmJ1ZmZlck1vdmUgPSBmdW5jdGlvbihwcm94eUlkKSB7XG4gICAgICAgIHRoaXMubV9tb3ZlQnVmZmVyLnB1c2gocHJveHlJZCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLnVuYnVmZmVyTW92ZSA9IGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fbW92ZUJ1ZmZlci5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIGlmICh0aGlzLm1fbW92ZUJ1ZmZlcltpXSA9PT0gcHJveHlJZCkge1xuICAgICAgICAgICAgdGhpcy5tX21vdmVCdWZmZXJbaV0gPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS51cGRhdGVQYWlycyA9IGZ1bmN0aW9uKGFkZFBhaXJDYWxsYmFjaykge1xuICAgICAgICB0aGlzLm1fY2FsbGJhY2sgPSBhZGRQYWlyQ2FsbGJhY2s7XG4gICAgICAgIHdoaWxlICh0aGlzLm1fbW92ZUJ1ZmZlci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX3F1ZXJ5UHJveHlJZCA9IHRoaXMubV9tb3ZlQnVmZmVyLnBvcCgpO1xuICAgICAgICAgIGlmICh0aGlzLm1fcXVlcnlQcm94eUlkID09PSBudWxsKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGZhdEFBQkIgPSB0aGlzLm1fdHJlZS5nZXRGYXRBQUJCKHRoaXMubV9xdWVyeVByb3h5SWQpO1xuICAgICAgICAgIHRoaXMubV90cmVlLnF1ZXJ5KGZhdEFBQkIsIHRoaXMucXVlcnlDYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICByZXR1cm4gQnJvYWRQaGFzZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX3NpbiQyID0gTWF0aC5zaW47XG4gIHZhciBtYXRoX2NvcyQyID0gTWF0aC5jb3M7XG4gIHZhciBtYXRoX3NxcnQkNCA9IE1hdGguc3FydDtcbiAgZnVuY3Rpb24gdmVjMih4MiwgeSkge1xuICAgIHJldHVybiB7IHg6IHgyLCB5IH07XG4gIH1cbiAgZnVuY3Rpb24gcm90YXRpb24oYW5nbGUpIHtcbiAgICByZXR1cm4geyBzOiBtYXRoX3NpbiQyKGFuZ2xlKSwgYzogbWF0aF9jb3MkMihhbmdsZSkgfTtcbiAgfVxuICBmdW5jdGlvbiBzZXRWZWMyKG91dCwgeDIsIHkpIHtcbiAgICBvdXQueCA9IHgyO1xuICAgIG91dC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGNvcHlWZWMyKG91dCwgdykge1xuICAgIG91dC54ID0gdy54O1xuICAgIG91dC55ID0gdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gemVyb1ZlYzIob3V0KSB7XG4gICAgb3V0LnggPSAwO1xuICAgIG91dC55ID0gMDtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIG5lZ1ZlYzIob3V0KSB7XG4gICAgb3V0LnggPSAtb3V0Lng7XG4gICAgb3V0LnkgPSAtb3V0Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBwbHVzVmVjMihvdXQsIHcpIHtcbiAgICBvdXQueCArPSB3Lng7XG4gICAgb3V0LnkgKz0gdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gYWRkVmVjMihvdXQsIHYzLCB3KSB7XG4gICAgb3V0LnggPSB2My54ICsgdy54O1xuICAgIG91dC55ID0gdjMueCArIHcueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIG1pbnVzVmVjMihvdXQsIHcpIHtcbiAgICBvdXQueCAtPSB3Lng7XG4gICAgb3V0LnkgLT0gdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gc3ViVmVjMihvdXQsIHYzLCB3KSB7XG4gICAgb3V0LnggPSB2My54IC0gdy54O1xuICAgIG91dC55ID0gdjMueSAtIHcueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIG11bFZlYzIob3V0LCBtKSB7XG4gICAgb3V0LnggKj0gbTtcbiAgICBvdXQueSAqPSBtO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gc2NhbGVWZWMyKG91dCwgbSwgdykge1xuICAgIG91dC54ID0gbSAqIHcueDtcbiAgICBvdXQueSA9IG0gKiB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBwbHVzU2NhbGVWZWMyKG91dCwgbSwgdykge1xuICAgIG91dC54ICs9IG0gKiB3Lng7XG4gICAgb3V0LnkgKz0gbSAqIHcueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIG1pbnVzU2NhbGVWZWMyKG91dCwgbSwgdykge1xuICAgIG91dC54IC09IG0gKiB3Lng7XG4gICAgb3V0LnkgLT0gbSAqIHcueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGNvbWJpbmUyVmVjMihvdXQsIGFtLCBhMiwgYm0sIGIyKSB7XG4gICAgb3V0LnggPSBhbSAqIGEyLnggKyBibSAqIGIyLng7XG4gICAgb3V0LnkgPSBhbSAqIGEyLnkgKyBibSAqIGIyLnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBjb21iaW5lM1ZlYzIob3V0LCBhbSwgYTIsIGJtLCBiMiwgY20sIGMyKSB7XG4gICAgb3V0LnggPSBhbSAqIGEyLnggKyBibSAqIGIyLnggKyBjbSAqIGMyLng7XG4gICAgb3V0LnkgPSBhbSAqIGEyLnkgKyBibSAqIGIyLnkgKyBjbSAqIGMyLnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBub3JtYWxpemVWZWMyTGVuZ3RoKG91dCkge1xuICAgIHZhciBsZW5ndGggPSBtYXRoX3NxcnQkNChvdXQueCAqIG91dC54ICsgb3V0LnkgKiBvdXQueSk7XG4gICAgaWYgKGxlbmd0aCAhPT0gMCkge1xuICAgICAgdmFyIGludkxlbmd0aCA9IDEgLyBsZW5ndGg7XG4gICAgICBvdXQueCAqPSBpbnZMZW5ndGg7XG4gICAgICBvdXQueSAqPSBpbnZMZW5ndGg7XG4gICAgfVxuICAgIHJldHVybiBsZW5ndGg7XG4gIH1cbiAgZnVuY3Rpb24gbm9ybWFsaXplVmVjMihvdXQpIHtcbiAgICB2YXIgbGVuZ3RoID0gbWF0aF9zcXJ0JDQob3V0LnggKiBvdXQueCArIG91dC55ICogb3V0LnkpO1xuICAgIGlmIChsZW5ndGggPiAwKSB7XG4gICAgICB2YXIgaW52TGVuZ3RoID0gMSAvIGxlbmd0aDtcbiAgICAgIG91dC54ICo9IGludkxlbmd0aDtcbiAgICAgIG91dC55ICo9IGludkxlbmd0aDtcbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBjcm9zc1ZlYzJOdW0ob3V0LCB2Mywgdykge1xuICAgIHZhciB4MiA9IHcgKiB2My55O1xuICAgIHZhciB5ID0gLXcgKiB2My54O1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gY3Jvc3NOdW1WZWMyKG91dCwgdywgdjMpIHtcbiAgICB2YXIgeDIgPSAtdyAqIHYzLnk7XG4gICAgdmFyIHkgPSB3ICogdjMueDtcbiAgICBvdXQueCA9IHgyO1xuICAgIG91dC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGNyb3NzVmVjMlZlYzIoYTIsIGIyKSB7XG4gICAgcmV0dXJuIGEyLnggKiBiMi55IC0gYTIueSAqIGIyLng7XG4gIH1cbiAgZnVuY3Rpb24gZG90VmVjMihhMiwgYjIpIHtcbiAgICByZXR1cm4gYTIueCAqIGIyLnggKyBhMi55ICogYjIueTtcbiAgfVxuICBmdW5jdGlvbiBsZW5ndGhTcXJWZWMyKGEyKSB7XG4gICAgcmV0dXJuIGEyLnggKiBhMi54ICsgYTIueSAqIGEyLnk7XG4gIH1cbiAgZnVuY3Rpb24gZGlzdFZlYzIoYTIsIGIyKSB7XG4gICAgdmFyIGR4ID0gYTIueCAtIGIyLng7XG4gICAgdmFyIGR5ID0gYTIueSAtIGIyLnk7XG4gICAgcmV0dXJuIG1hdGhfc3FydCQ0KGR4ICogZHggKyBkeSAqIGR5KTtcbiAgfVxuICBmdW5jdGlvbiBkaXN0U3FyVmVjMihhMiwgYjIpIHtcbiAgICB2YXIgZHggPSBhMi54IC0gYjIueDtcbiAgICB2YXIgZHkgPSBhMi55IC0gYjIueTtcbiAgICByZXR1cm4gZHggKiBkeCArIGR5ICogZHk7XG4gIH1cbiAgZnVuY3Rpb24gc2V0Um90QW5nbGUob3V0LCBhMikge1xuICAgIG91dC5jID0gbWF0aF9jb3MkMihhMik7XG4gICAgb3V0LnMgPSBtYXRoX3NpbiQyKGEyKTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHJvdFZlYzIob3V0LCBxLCB2Mykge1xuICAgIG91dC54ID0gcS5jICogdjMueCAtIHEucyAqIHYzLnk7XG4gICAgb3V0LnkgPSBxLnMgKiB2My54ICsgcS5jICogdjMueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGRlcm90VmVjMihvdXQsIHEsIHYzKSB7XG4gICAgdmFyIHgyID0gcS5jICogdjMueCArIHEucyAqIHYzLnk7XG4gICAgdmFyIHkgPSAtcS5zICogdjMueCArIHEuYyAqIHYzLnk7XG4gICAgb3V0LnggPSB4MjtcbiAgICBvdXQueSA9IHk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiByZXJvdFZlYzIob3V0LCBiZWZvcmUsIGFmdGVyLCB2Mykge1xuICAgIHZhciB4MCA9IGJlZm9yZS5jICogdjMueCArIGJlZm9yZS5zICogdjMueTtcbiAgICB2YXIgeTAgPSAtYmVmb3JlLnMgKiB2My54ICsgYmVmb3JlLmMgKiB2My55O1xuICAgIHZhciB4MiA9IGFmdGVyLmMgKiB4MCAtIGFmdGVyLnMgKiB5MDtcbiAgICB2YXIgeSA9IGFmdGVyLnMgKiB4MCArIGFmdGVyLmMgKiB5MDtcbiAgICBvdXQueCA9IHgyO1xuICAgIG91dC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHRyYW5zZm9ybSh4MiwgeSwgYTIpIHtcbiAgICByZXR1cm4geyBwOiB2ZWMyKHgyLCB5KSwgcTogcm90YXRpb24oYTIpIH07XG4gIH1cbiAgZnVuY3Rpb24gY29weVRyYW5zZm9ybShvdXQsIHRyYW5zZm9ybTIpIHtcbiAgICBvdXQucC54ID0gdHJhbnNmb3JtMi5wLng7XG4gICAgb3V0LnAueSA9IHRyYW5zZm9ybTIucC55O1xuICAgIG91dC5xLnMgPSB0cmFuc2Zvcm0yLnEucztcbiAgICBvdXQucS5jID0gdHJhbnNmb3JtMi5xLmM7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiB0cmFuc2Zvcm1WZWMyKG91dCwgeGYyLCB2Mykge1xuICAgIHZhciB4MiA9IHhmMi5xLmMgKiB2My54IC0geGYyLnEucyAqIHYzLnkgKyB4ZjIucC54O1xuICAgIHZhciB5ID0geGYyLnEucyAqIHYzLnggKyB4ZjIucS5jICogdjMueSArIHhmMi5wLnk7XG4gICAgb3V0LnggPSB4MjtcbiAgICBvdXQueSA9IHk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBkZXRyYW5zZm9ybVZlYzIob3V0LCB4ZjIsIHYzKSB7XG4gICAgdmFyIHB4ID0gdjMueCAtIHhmMi5wLng7XG4gICAgdmFyIHB5ID0gdjMueSAtIHhmMi5wLnk7XG4gICAgdmFyIHgyID0geGYyLnEuYyAqIHB4ICsgeGYyLnEucyAqIHB5O1xuICAgIHZhciB5ID0gLXhmMi5xLnMgKiBweCArIHhmMi5xLmMgKiBweTtcbiAgICBvdXQueCA9IHgyO1xuICAgIG91dC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHJldHJhbnNmb3JtVmVjMihvdXQsIGZyb20sIHRvLCB2Mykge1xuICAgIHZhciB4MCA9IGZyb20ucS5jICogdjMueCAtIGZyb20ucS5zICogdjMueSArIGZyb20ucC54O1xuICAgIHZhciB5MCA9IGZyb20ucS5zICogdjMueCArIGZyb20ucS5jICogdjMueSArIGZyb20ucC55O1xuICAgIHZhciBweCA9IHgwIC0gdG8ucC54O1xuICAgIHZhciBweSA9IHkwIC0gdG8ucC55O1xuICAgIHZhciB4MiA9IHRvLnEuYyAqIHB4ICsgdG8ucS5zICogcHk7XG4gICAgdmFyIHkgPSAtdG8ucS5zICogcHggKyB0by5xLmMgKiBweTtcbiAgICBvdXQueCA9IHgyO1xuICAgIG91dC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGRldHJhbnNmb3JtVHJhbnNmb3JtKG91dCwgYTIsIGIyKSB7XG4gICAgdmFyIGMyID0gYTIucS5jICogYjIucS5jICsgYTIucS5zICogYjIucS5zO1xuICAgIHZhciBzMiA9IGEyLnEuYyAqIGIyLnEucyAtIGEyLnEucyAqIGIyLnEuYztcbiAgICB2YXIgeDIgPSBhMi5xLmMgKiAoYjIucC54IC0gYTIucC54KSArIGEyLnEucyAqIChiMi5wLnkgLSBhMi5wLnkpO1xuICAgIHZhciB5ID0gLWEyLnEucyAqIChiMi5wLnggLSBhMi5wLngpICsgYTIucS5jICogKGIyLnAueSAtIGEyLnAueSk7XG4gICAgb3V0LnEuYyA9IGMyO1xuICAgIG91dC5xLnMgPSBzMjtcbiAgICBvdXQucC54ID0geDI7XG4gICAgb3V0LnAueSA9IHk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICB2YXIgbWF0aF9zaW4kMSA9IE1hdGguc2luO1xuICB2YXIgbWF0aF9jb3MkMSA9IE1hdGguY29zO1xuICB2YXIgbWF0aF9hdGFuMiQxID0gTWF0aC5hdGFuMjtcbiAgdmFyIFJvdCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBSb3QyKGFuZ2xlKSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBSb3QyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgUm90MihhbmdsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBhbmdsZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHRoaXMuc2V0QW5nbGUoYW5nbGUpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhbmdsZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMuc2V0Um90KGFuZ2xlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnNldElkZW50aXR5KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFJvdDIubmVvID0gZnVuY3Rpb24oYW5nbGUpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoUm90Mi5wcm90b3R5cGUpO1xuICAgICAgICBvYmouc2V0QW5nbGUoYW5nbGUpO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFJvdDIuY2xvbmUgPSBmdW5jdGlvbihyb3QpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoUm90Mi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoucyA9IHJvdC5zO1xuICAgICAgICBvYmouYyA9IHJvdC5jO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFJvdDIuaWRlbnRpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoUm90Mi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoucyA9IDA7XG4gICAgICAgIG9iai5jID0gMTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBSb3QyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOdW1iZXIuaXNGaW5pdGUob2JqLnMpICYmIE51bWJlci5pc0Zpbml0ZShvYmouYyk7XG4gICAgICB9O1xuICAgICAgUm90Mi5hc3NlcnQgPSBmdW5jdGlvbihvKSB7XG4gICAgICB9O1xuICAgICAgUm90Mi5wcm90b3R5cGUuc2V0SWRlbnRpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zID0gMDtcbiAgICAgICAgdGhpcy5jID0gMTtcbiAgICAgIH07XG4gICAgICBSb3QyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihhbmdsZSkge1xuICAgICAgICBpZiAodHlwZW9mIGFuZ2xlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy5zID0gYW5nbGUucztcbiAgICAgICAgICB0aGlzLmMgPSBhbmdsZS5jO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucyA9IG1hdGhfc2luJDEoYW5nbGUpO1xuICAgICAgICAgIHRoaXMuYyA9IG1hdGhfY29zJDEoYW5nbGUpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUm90Mi5wcm90b3R5cGUuc2V0Um90ID0gZnVuY3Rpb24oYW5nbGUpIHtcbiAgICAgICAgdGhpcy5zID0gYW5nbGUucztcbiAgICAgICAgdGhpcy5jID0gYW5nbGUuYztcbiAgICAgIH07XG4gICAgICBSb3QyLnByb3RvdHlwZS5zZXRBbmdsZSA9IGZ1bmN0aW9uKGFuZ2xlKSB7XG4gICAgICAgIHRoaXMucyA9IG1hdGhfc2luJDEoYW5nbGUpO1xuICAgICAgICB0aGlzLmMgPSBtYXRoX2NvcyQxKGFuZ2xlKTtcbiAgICAgIH07XG4gICAgICBSb3QyLnByb3RvdHlwZS5nZXRBbmdsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbWF0aF9hdGFuMiQxKHRoaXMucywgdGhpcy5jKTtcbiAgICAgIH07XG4gICAgICBSb3QyLnByb3RvdHlwZS5nZXRYQXhpcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8odGhpcy5jLCB0aGlzLnMpO1xuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLmdldFlBeGlzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbygtdGhpcy5zLCB0aGlzLmMpO1xuICAgICAgfTtcbiAgICAgIFJvdDIubXVsID0gZnVuY3Rpb24ocm90LCBtKSB7XG4gICAgICAgIGlmIChcImNcIiBpbiBtICYmIFwic1wiIGluIG0pIHtcbiAgICAgICAgICB2YXIgcXIgPSBSb3QyLmlkZW50aXR5KCk7XG4gICAgICAgICAgcXIucyA9IHJvdC5zICogbS5jICsgcm90LmMgKiBtLnM7XG4gICAgICAgICAgcXIuYyA9IHJvdC5jICogbS5jIC0gcm90LnMgKiBtLnM7XG4gICAgICAgICAgcmV0dXJuIHFyO1xuICAgICAgICB9IGVsc2UgaWYgKFwieFwiIGluIG0gJiYgXCJ5XCIgaW4gbSkge1xuICAgICAgICAgIHJldHVybiBWZWMyLm5lbyhyb3QuYyAqIG0ueCAtIHJvdC5zICogbS55LCByb3QucyAqIG0ueCArIHJvdC5jICogbS55KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFJvdDIubXVsUm90ID0gZnVuY3Rpb24ocm90LCBtKSB7XG4gICAgICAgIHZhciBxciA9IFJvdDIuaWRlbnRpdHkoKTtcbiAgICAgICAgcXIucyA9IHJvdC5zICogbS5jICsgcm90LmMgKiBtLnM7XG4gICAgICAgIHFyLmMgPSByb3QuYyAqIG0uYyAtIHJvdC5zICogbS5zO1xuICAgICAgICByZXR1cm4gcXI7XG4gICAgICB9O1xuICAgICAgUm90Mi5tdWxWZWMyID0gZnVuY3Rpb24ocm90LCBtKSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyhyb3QuYyAqIG0ueCAtIHJvdC5zICogbS55LCByb3QucyAqIG0ueCArIHJvdC5jICogbS55KTtcbiAgICAgIH07XG4gICAgICBSb3QyLm11bFN1YiA9IGZ1bmN0aW9uKHJvdCwgdjMsIHcpIHtcbiAgICAgICAgdmFyIHgyID0gcm90LmMgKiAodjMueCAtIHcueCkgLSByb3QucyAqICh2My55IC0gdy55KTtcbiAgICAgICAgdmFyIHkgPSByb3QucyAqICh2My54IC0gdy54KSArIHJvdC5jICogKHYzLnkgLSB3LnkpO1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgfTtcbiAgICAgIFJvdDIubXVsVCA9IGZ1bmN0aW9uKHJvdCwgbSkge1xuICAgICAgICBpZiAoXCJjXCIgaW4gbSAmJiBcInNcIiBpbiBtKSB7XG4gICAgICAgICAgdmFyIHFyID0gUm90Mi5pZGVudGl0eSgpO1xuICAgICAgICAgIHFyLnMgPSByb3QuYyAqIG0ucyAtIHJvdC5zICogbS5jO1xuICAgICAgICAgIHFyLmMgPSByb3QuYyAqIG0uYyArIHJvdC5zICogbS5zO1xuICAgICAgICAgIHJldHVybiBxcjtcbiAgICAgICAgfSBlbHNlIGlmIChcInhcIiBpbiBtICYmIFwieVwiIGluIG0pIHtcbiAgICAgICAgICByZXR1cm4gVmVjMi5uZW8ocm90LmMgKiBtLnggKyByb3QucyAqIG0ueSwgLXJvdC5zICogbS54ICsgcm90LmMgKiBtLnkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUm90Mi5tdWxUUm90ID0gZnVuY3Rpb24ocm90LCBtKSB7XG4gICAgICAgIHZhciBxciA9IFJvdDIuaWRlbnRpdHkoKTtcbiAgICAgICAgcXIucyA9IHJvdC5jICogbS5zIC0gcm90LnMgKiBtLmM7XG4gICAgICAgIHFyLmMgPSByb3QuYyAqIG0uYyArIHJvdC5zICogbS5zO1xuICAgICAgICByZXR1cm4gcXI7XG4gICAgICB9O1xuICAgICAgUm90Mi5tdWxUVmVjMiA9IGZ1bmN0aW9uKHJvdCwgbSkge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8ocm90LmMgKiBtLnggKyByb3QucyAqIG0ueSwgLXJvdC5zICogbS54ICsgcm90LmMgKiBtLnkpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBSb3QyO1xuICAgIH0oKVxuICApO1xuICB2YXIgbWF0aF9hdGFuMiA9IE1hdGguYXRhbjI7XG4gIHZhciBtYXRoX1BJJDUgPSBNYXRoLlBJO1xuICB2YXIgdGVtcCQ3ID0gdmVjMigwLCAwKTtcbiAgdmFyIFN3ZWVwID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFN3ZWVwMigpIHtcbiAgICAgICAgdGhpcy5sb2NhbENlbnRlciA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLmMgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5hID0gMDtcbiAgICAgICAgdGhpcy5hbHBoYTAgPSAwO1xuICAgICAgICB0aGlzLmMwID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMuYTAgPSAwO1xuICAgICAgfVxuICAgICAgU3dlZXAyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubG9jYWxDZW50ZXIpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLmMpO1xuICAgICAgICB0aGlzLmEgPSAwO1xuICAgICAgICB0aGlzLmFscGhhMCA9IDA7XG4gICAgICAgIHplcm9WZWMyKHRoaXMuYzApO1xuICAgICAgICB0aGlzLmEwID0gMDtcbiAgICAgIH07XG4gICAgICBTd2VlcDIucHJvdG90eXBlLnNldFRyYW5zZm9ybSA9IGZ1bmN0aW9uKHhmMikge1xuICAgICAgICB0cmFuc2Zvcm1WZWMyKHRlbXAkNywgeGYyLCB0aGlzLmxvY2FsQ2VudGVyKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5jLCB0ZW1wJDcpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmMwLCB0ZW1wJDcpO1xuICAgICAgICB0aGlzLmEgPSB0aGlzLmEwID0gbWF0aF9hdGFuMih4ZjIucS5zLCB4ZjIucS5jKTtcbiAgICAgIH07XG4gICAgICBTd2VlcDIucHJvdG90eXBlLnNldExvY2FsQ2VudGVyID0gZnVuY3Rpb24obG9jYWxDZW50ZXIyLCB4ZjIpIHtcbiAgICAgICAgY29weVZlYzIodGhpcy5sb2NhbENlbnRlciwgbG9jYWxDZW50ZXIyKTtcbiAgICAgICAgdHJhbnNmb3JtVmVjMih0ZW1wJDcsIHhmMiwgdGhpcy5sb2NhbENlbnRlcik7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMuYywgdGVtcCQ3KTtcbiAgICAgICAgY29weVZlYzIodGhpcy5jMCwgdGVtcCQ3KTtcbiAgICAgIH07XG4gICAgICBTd2VlcDIucHJvdG90eXBlLmdldFRyYW5zZm9ybSA9IGZ1bmN0aW9uKHhmMiwgYmV0YSkge1xuICAgICAgICBpZiAoYmV0YSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgYmV0YSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgc2V0Um90QW5nbGUoeGYyLnEsICgxIC0gYmV0YSkgKiB0aGlzLmEwICsgYmV0YSAqIHRoaXMuYSk7XG4gICAgICAgIGNvbWJpbmUyVmVjMih4ZjIucCwgMSAtIGJldGEsIHRoaXMuYzAsIGJldGEsIHRoaXMuYyk7XG4gICAgICAgIG1pbnVzVmVjMih4ZjIucCwgcm90VmVjMih0ZW1wJDcsIHhmMi5xLCB0aGlzLmxvY2FsQ2VudGVyKSk7XG4gICAgICB9O1xuICAgICAgU3dlZXAyLnByb3RvdHlwZS5hZHZhbmNlID0gZnVuY3Rpb24oYWxwaGEpIHtcbiAgICAgICAgdmFyIGJldGEgPSAoYWxwaGEgLSB0aGlzLmFscGhhMCkgLyAoMSAtIHRoaXMuYWxwaGEwKTtcbiAgICAgICAgY29tYmluZTJWZWMyKHRoaXMuYzAsIGJldGEsIHRoaXMuYywgMSAtIGJldGEsIHRoaXMuYzApO1xuICAgICAgICB0aGlzLmEwID0gYmV0YSAqIHRoaXMuYSArICgxIC0gYmV0YSkgKiB0aGlzLmEwO1xuICAgICAgICB0aGlzLmFscGhhMCA9IGFscGhhO1xuICAgICAgfTtcbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUuZm9yd2FyZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmEwID0gdGhpcy5hO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmMwLCB0aGlzLmMpO1xuICAgICAgfTtcbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUubm9ybWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhMCA9IG1vZCh0aGlzLmEwLCAtbWF0aF9QSSQ1LCArbWF0aF9QSSQ1KTtcbiAgICAgICAgdGhpcy5hIC09IHRoaXMuYTAgLSBhMDtcbiAgICAgICAgdGhpcy5hMCA9IGEwO1xuICAgICAgfTtcbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24odGhhdCkge1xuICAgICAgICBjb3B5VmVjMih0aGlzLmxvY2FsQ2VudGVyLCB0aGF0LmxvY2FsQ2VudGVyKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5jLCB0aGF0LmMpO1xuICAgICAgICB0aGlzLmEgPSB0aGF0LmE7XG4gICAgICAgIHRoaXMuYWxwaGEwID0gdGhhdC5hbHBoYTA7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMuYzAsIHRoYXQuYzApO1xuICAgICAgICB0aGlzLmEwID0gdGhhdC5hMDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gU3dlZXAyO1xuICAgIH0oKVxuICApO1xuICB2YXIgVHJhbnNmb3JtID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFRyYW5zZm9ybTIocG9zaXRpb24sIHJvdGF0aW9uMikge1xuICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgVHJhbnNmb3JtMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFRyYW5zZm9ybTIocG9zaXRpb24sIHJvdGF0aW9uMik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMucSA9IFJvdC5pZGVudGl0eSgpO1xuICAgICAgICBpZiAodHlwZW9mIHBvc2l0aW9uICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgdGhpcy5wLnNldFZlYzIocG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygcm90YXRpb24yICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgdGhpcy5xLnNldEFuZ2xlKHJvdGF0aW9uMik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFRyYW5zZm9ybTIuY2xvbmUgPSBmdW5jdGlvbih4ZjIpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVHJhbnNmb3JtMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoucCA9IFZlYzIuY2xvbmUoeGYyLnApO1xuICAgICAgICBvYmoucSA9IFJvdC5jbG9uZSh4ZjIucSk7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5uZW8gPSBmdW5jdGlvbihwb3NpdGlvbiwgcm90YXRpb24yKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFRyYW5zZm9ybTIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnAgPSBWZWMyLmNsb25lKHBvc2l0aW9uKTtcbiAgICAgICAgb2JqLnEgPSBSb3QuY2xvbmUocm90YXRpb24yKTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLmlkZW50aXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFRyYW5zZm9ybTIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnAgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgb2JqLnEgPSBSb3QuaWRlbnRpdHkoKTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLnByb3RvdHlwZS5zZXRJZGVudGl0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnAuc2V0WmVybygpO1xuICAgICAgICB0aGlzLnEuc2V0SWRlbnRpdHkoKTtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiMiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHRoaXMucC5zZXQoYTIucCk7XG4gICAgICAgICAgdGhpcy5xLnNldChhMi5xKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnAuc2V0KGEyKTtcbiAgICAgICAgICB0aGlzLnEuc2V0KGIyKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIucHJvdG90eXBlLnNldE51bSA9IGZ1bmN0aW9uKHBvc2l0aW9uLCByb3RhdGlvbjIpIHtcbiAgICAgICAgdGhpcy5wLnNldFZlYzIocG9zaXRpb24pO1xuICAgICAgICB0aGlzLnEuc2V0QW5nbGUocm90YXRpb24yKTtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLnByb3RvdHlwZS5zZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbih4ZjIpIHtcbiAgICAgICAgdGhpcy5wLnNldFZlYzIoeGYyLnApO1xuICAgICAgICB0aGlzLnEuc2V0Um90KHhmMi5xKTtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBWZWMyLmlzVmFsaWQob2JqLnApICYmIFJvdC5pc1ZhbGlkKG9iai5xKTtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLmFzc2VydCA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm11bCA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShiMikpIHtcbiAgICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiMi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJyW2ldID0gVHJhbnNmb3JtMi5tdWwoYTIsIGIyW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGFycjtcbiAgICAgICAgfSBlbHNlIGlmIChcInhcIiBpbiBiMiAmJiBcInlcIiBpbiBiMikge1xuICAgICAgICAgIHJldHVybiBUcmFuc2Zvcm0yLm11bFZlYzIoYTIsIGIyKTtcbiAgICAgICAgfSBlbHNlIGlmIChcInBcIiBpbiBiMiAmJiBcInFcIiBpbiBiMikge1xuICAgICAgICAgIHJldHVybiBUcmFuc2Zvcm0yLm11bFhmKGEyLCBiMik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm11bEFsbCA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYjIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBhcnJbaV0gPSBUcmFuc2Zvcm0yLm11bChhMiwgYjJbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnI7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5tdWxGbiA9IGZ1bmN0aW9uKGEyKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihiMikge1xuICAgICAgICAgIHJldHVybiBUcmFuc2Zvcm0yLm11bChhMiwgYjIpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsVmVjMiA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgeDIgPSBhMi5xLmMgKiBiMi54IC0gYTIucS5zICogYjIueSArIGEyLnAueDtcbiAgICAgICAgdmFyIHkgPSBhMi5xLnMgKiBiMi54ICsgYTIucS5jICogYjIueSArIGEyLnAueTtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHgyLCB5KTtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm11bFhmID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciB4ZjIgPSBUcmFuc2Zvcm0yLmlkZW50aXR5KCk7XG4gICAgICAgIHhmMi5xID0gUm90Lm11bFJvdChhMi5xLCBiMi5xKTtcbiAgICAgICAgeGYyLnAgPSBWZWMyLmFkZChSb3QubXVsVmVjMihhMi5xLCBiMi5wKSwgYTIucCk7XG4gICAgICAgIHJldHVybiB4ZjI7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5tdWxUID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIGlmIChcInhcIiBpbiBiMiAmJiBcInlcIiBpbiBiMikge1xuICAgICAgICAgIHJldHVybiBUcmFuc2Zvcm0yLm11bFRWZWMyKGEyLCBiMik7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJwXCIgaW4gYjIgJiYgXCJxXCIgaW4gYjIpIHtcbiAgICAgICAgICByZXR1cm4gVHJhbnNmb3JtMi5tdWxUWGYoYTIsIGIyKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsVFZlYzIgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIHB4ID0gYjIueCAtIGEyLnAueDtcbiAgICAgICAgdmFyIHB5ID0gYjIueSAtIGEyLnAueTtcbiAgICAgICAgdmFyIHgyID0gYTIucS5jICogcHggKyBhMi5xLnMgKiBweTtcbiAgICAgICAgdmFyIHkgPSAtYTIucS5zICogcHggKyBhMi5xLmMgKiBweTtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHgyLCB5KTtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm11bFRYZiA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgeGYyID0gVHJhbnNmb3JtMi5pZGVudGl0eSgpO1xuICAgICAgICB4ZjIucS5zZXRSb3QoUm90Lm11bFRSb3QoYTIucSwgYjIucSkpO1xuICAgICAgICB4ZjIucC5zZXRWZWMyKFJvdC5tdWxUVmVjMihhMi5xLCBWZWMyLnN1YihiMi5wLCBhMi5wKSkpO1xuICAgICAgICByZXR1cm4geGYyO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBUcmFuc2Zvcm0yO1xuICAgIH0oKVxuICApO1xuICB2YXIgVmVsb2NpdHkgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIC8qIEBfX1BVUkVfXyAqLyBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFZlbG9jaXR5MigpIHtcbiAgICAgICAgdGhpcy52ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMudyA9IDA7XG4gICAgICB9XG4gICAgICByZXR1cm4gVmVsb2NpdHkyO1xuICAgIH0oKVxuICApO1xuICB2YXIgbWF0aF9zaW4gPSBNYXRoLnNpbjtcbiAgdmFyIG1hdGhfY29zID0gTWF0aC5jb3M7XG4gIHZhciBQb3NpdGlvbiA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBQb3NpdGlvbjIoKSB7XG4gICAgICAgIHRoaXMuYyA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLmEgPSAwO1xuICAgICAgfVxuICAgICAgUG9zaXRpb24yLnByb3RvdHlwZS5nZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbih4ZjIsIHApIHtcbiAgICAgICAgeGYyLnEuYyA9IG1hdGhfY29zKHRoaXMuYSk7XG4gICAgICAgIHhmMi5xLnMgPSBtYXRoX3Npbih0aGlzLmEpO1xuICAgICAgICB4ZjIucC54ID0gdGhpcy5jLnggLSAoeGYyLnEuYyAqIHAueCAtIHhmMi5xLnMgKiBwLnkpO1xuICAgICAgICB4ZjIucC55ID0gdGhpcy5jLnkgLSAoeGYyLnEucyAqIHAueCArIHhmMi5xLmMgKiBwLnkpO1xuICAgICAgICByZXR1cm4geGYyO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBQb3NpdGlvbjI7XG4gICAgfSgpXG4gICk7XG4gIGZ1bmN0aW9uIGdldFRyYW5zZm9ybSh4ZjIsIHAsIGMyLCBhMikge1xuICAgIHhmMi5xLmMgPSBtYXRoX2NvcyhhMik7XG4gICAgeGYyLnEucyA9IG1hdGhfc2luKGEyKTtcbiAgICB4ZjIucC54ID0gYzIueCAtICh4ZjIucS5jICogcC54IC0geGYyLnEucyAqIHAueSk7XG4gICAgeGYyLnAueSA9IGMyLnkgLSAoeGYyLnEucyAqIHAueCArIHhmMi5xLmMgKiBwLnkpO1xuICAgIHJldHVybiB4ZjI7XG4gIH1cbiAgdmFyIFNoYXBlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNoYXBlMigpIHtcbiAgICAgICAgdGhpcy5zdHlsZSA9IHt9O1xuICAgICAgICB0aGlzLmFwcERhdGEgPSB7fTtcbiAgICAgIH1cbiAgICAgIFNoYXBlMi5pc1ZhbGlkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHlwZW9mIG9iai5tX3R5cGUgPT09IFwic3RyaW5nXCIgJiYgdHlwZW9mIG9iai5tX3JhZGl1cyA9PT0gXCJudW1iZXJcIjtcbiAgICAgIH07XG4gICAgICByZXR1cm4gU2hhcGUyO1xuICAgIH0oKVxuICApO1xuICB2YXIgc3luY2hyb25pemVfYWFiYjEgPSBuZXcgQUFCQigpO1xuICB2YXIgc3luY2hyb25pemVfYWFiYjIgPSBuZXcgQUFCQigpO1xuICB2YXIgZGlzcGxhY2VtZW50ID0gdmVjMigwLCAwKTtcbiAgdmFyIEZpeHR1cmVEZWZEZWZhdWx0ID0ge1xuICAgIHVzZXJEYXRhOiBudWxsLFxuICAgIGZyaWN0aW9uOiAwLjIsXG4gICAgcmVzdGl0dXRpb246IDAsXG4gICAgZGVuc2l0eTogMCxcbiAgICBpc1NlbnNvcjogZmFsc2UsXG4gICAgZmlsdGVyR3JvdXBJbmRleDogMCxcbiAgICBmaWx0ZXJDYXRlZ29yeUJpdHM6IDEsXG4gICAgZmlsdGVyTWFza0JpdHM6IDY1NTM1XG4gIH07XG4gIHZhciBGaXh0dXJlUHJveHkgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIC8qIEBfX1BVUkVfXyAqLyBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEZpeHR1cmVQcm94eTIoZml4dHVyZSwgY2hpbGRJbmRleCkge1xuICAgICAgICB0aGlzLmFhYmIgPSBuZXcgQUFCQigpO1xuICAgICAgICB0aGlzLmZpeHR1cmUgPSBmaXh0dXJlO1xuICAgICAgICB0aGlzLmNoaWxkSW5kZXggPSBjaGlsZEluZGV4O1xuICAgICAgfVxuICAgICAgcmV0dXJuIEZpeHR1cmVQcm94eTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBGaXh0dXJlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEZpeHR1cmUyKGJvZHksIHNoYXBlLCBkZWYpIHtcbiAgICAgICAgdGhpcy5zdHlsZSA9IHt9O1xuICAgICAgICB0aGlzLmFwcERhdGEgPSB7fTtcbiAgICAgICAgaWYgKHNoYXBlLnNoYXBlKSB7XG4gICAgICAgICAgZGVmID0gc2hhcGU7XG4gICAgICAgICAgc2hhcGUgPSBzaGFwZS5zaGFwZTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZGVmID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgZGVmID0geyBkZW5zaXR5OiBkZWYgfTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgRml4dHVyZURlZkRlZmF1bHQpO1xuICAgICAgICB0aGlzLm1fYm9keSA9IGJvZHk7XG4gICAgICAgIHRoaXMubV9mcmljdGlvbiA9IGRlZi5mcmljdGlvbjtcbiAgICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gZGVmLnJlc3RpdHV0aW9uO1xuICAgICAgICB0aGlzLm1fZGVuc2l0eSA9IGRlZi5kZW5zaXR5O1xuICAgICAgICB0aGlzLm1faXNTZW5zb3IgPSBkZWYuaXNTZW5zb3I7XG4gICAgICAgIHRoaXMubV9maWx0ZXJHcm91cEluZGV4ID0gZGVmLmZpbHRlckdyb3VwSW5kZXg7XG4gICAgICAgIHRoaXMubV9maWx0ZXJDYXRlZ29yeUJpdHMgPSBkZWYuZmlsdGVyQ2F0ZWdvcnlCaXRzO1xuICAgICAgICB0aGlzLm1fZmlsdGVyTWFza0JpdHMgPSBkZWYuZmlsdGVyTWFza0JpdHM7XG4gICAgICAgIHRoaXMubV9zaGFwZSA9IHNoYXBlO1xuICAgICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9wcm94aWVzID0gW107XG4gICAgICAgIHRoaXMubV9wcm94eUNvdW50ID0gMDtcbiAgICAgICAgdmFyIGNoaWxkQ291bnQgPSB0aGlzLm1fc2hhcGUuZ2V0Q2hpbGRDb3VudCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkQ291bnQ7ICsraSkge1xuICAgICAgICAgIHRoaXMubV9wcm94aWVzW2ldID0gbmV3IEZpeHR1cmVQcm94eSh0aGlzLCBpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fdXNlckRhdGEgPSBkZWYudXNlckRhdGE7XG4gICAgICAgIGlmICh0eXBlb2YgZGVmLnN0eWxlID09PSBcIm9iamVjdFwiICYmIGRlZi5zdHlsZSAhPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuc3R5bGUgPSBkZWYuc3R5bGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGJvZHkgPSB0aGlzLmdldEJvZHkoKTtcbiAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSBib2R5Lm1fd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICB0aGlzLmRlc3Ryb3lQcm94aWVzKGJyb2FkUGhhc2UpO1xuICAgICAgICBpZiAodGhpcy5tX3NoYXBlLl9yZXNldCkge1xuICAgICAgICAgIHRoaXMubV9zaGFwZS5fcmVzZXQoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hpbGRDb3VudCA9IHRoaXMubV9zaGFwZS5nZXRDaGlsZENvdW50KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRDb3VudDsgKytpKSB7XG4gICAgICAgICAgdGhpcy5tX3Byb3hpZXNbaV0gPSBuZXcgRml4dHVyZVByb3h5KHRoaXMsIGkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3JlYXRlUHJveGllcyhicm9hZFBoYXNlLCBib2R5Lm1feGYpO1xuICAgICAgICBib2R5LnJlc2V0TWFzc0RhdGEoKTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZyaWN0aW9uOiB0aGlzLm1fZnJpY3Rpb24sXG4gICAgICAgICAgcmVzdGl0dXRpb246IHRoaXMubV9yZXN0aXR1dGlvbixcbiAgICAgICAgICBkZW5zaXR5OiB0aGlzLm1fZGVuc2l0eSxcbiAgICAgICAgICBpc1NlbnNvcjogdGhpcy5tX2lzU2Vuc29yLFxuICAgICAgICAgIGZpbHRlckdyb3VwSW5kZXg6IHRoaXMubV9maWx0ZXJHcm91cEluZGV4LFxuICAgICAgICAgIGZpbHRlckNhdGVnb3J5Qml0czogdGhpcy5tX2ZpbHRlckNhdGVnb3J5Qml0cyxcbiAgICAgICAgICBmaWx0ZXJNYXNrQml0czogdGhpcy5tX2ZpbHRlck1hc2tCaXRzLFxuICAgICAgICAgIHNoYXBlOiB0aGlzLm1fc2hhcGVcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCBib2R5LCByZXN0b3JlKSB7XG4gICAgICAgIHZhciBzaGFwZSA9IHJlc3RvcmUoU2hhcGUsIGRhdGEuc2hhcGUpO1xuICAgICAgICB2YXIgZml4dHVyZSA9IHNoYXBlICYmIG5ldyBGaXh0dXJlMihib2R5LCBzaGFwZSwgZGF0YSk7XG4gICAgICAgIHJldHVybiBmaXh0dXJlO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc2hhcGUubV90eXBlO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRTaGFwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3NoYXBlO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5pc1NlbnNvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2lzU2Vuc29yO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRTZW5zb3IgPSBmdW5jdGlvbihzZW5zb3IpIHtcbiAgICAgICAgaWYgKHNlbnNvciAhPSB0aGlzLm1faXNTZW5zb3IpIHtcbiAgICAgICAgICB0aGlzLm1fYm9keS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1faXNTZW5zb3IgPSBzZW5zb3I7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0VXNlckRhdGEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV91c2VyRGF0YTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0VXNlckRhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRhdGE7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldEJvZHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5O1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXROZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0RGVuc2l0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2RlbnNpdHk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldERlbnNpdHkgPSBmdW5jdGlvbihkZW5zaXR5KSB7XG4gICAgICAgIHRoaXMubV9kZW5zaXR5ID0gZGVuc2l0eTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0RnJpY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9mcmljdGlvbjtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0RnJpY3Rpb24gPSBmdW5jdGlvbihmcmljdGlvbikge1xuICAgICAgICB0aGlzLm1fZnJpY3Rpb24gPSBmcmljdGlvbjtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0UmVzdGl0dXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yZXN0aXR1dGlvbjtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0UmVzdGl0dXRpb24gPSBmdW5jdGlvbihyZXN0aXR1dGlvbikge1xuICAgICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSByZXN0aXR1dGlvbjtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUudGVzdFBvaW50ID0gZnVuY3Rpb24ocCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3NoYXBlLnRlc3RQb2ludCh0aGlzLm1fYm9keS5nZXRUcmFuc2Zvcm0oKSwgcCk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnJheUNhc3QgPSBmdW5jdGlvbihvdXRwdXQyLCBpbnB1dDIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9zaGFwZS5yYXlDYXN0KG91dHB1dDIsIGlucHV0MiwgdGhpcy5tX2JvZHkuZ2V0VHJhbnNmb3JtKCksIGNoaWxkSW5kZXgpO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRNYXNzRGF0YSA9IGZ1bmN0aW9uKG1hc3NEYXRhKSB7XG4gICAgICAgIHRoaXMubV9zaGFwZS5jb21wdXRlTWFzcyhtYXNzRGF0YSwgdGhpcy5tX2RlbnNpdHkpO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRBQUJCID0gZnVuY3Rpb24oY2hpbGRJbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3Byb3hpZXNbY2hpbGRJbmRleF0uYWFiYjtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuY3JlYXRlUHJveGllcyA9IGZ1bmN0aW9uKGJyb2FkUGhhc2UsIHhmMikge1xuICAgICAgICB0aGlzLm1fcHJveHlDb3VudCA9IHRoaXMubV9zaGFwZS5nZXRDaGlsZENvdW50KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX3Byb3h5Q291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciBwcm94eSA9IHRoaXMubV9wcm94aWVzW2ldO1xuICAgICAgICAgIHRoaXMubV9zaGFwZS5jb21wdXRlQUFCQihwcm94eS5hYWJiLCB4ZjIsIGkpO1xuICAgICAgICAgIHByb3h5LnByb3h5SWQgPSBicm9hZFBoYXNlLmNyZWF0ZVByb3h5KHByb3h5LmFhYmIsIHByb3h5KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5kZXN0cm95UHJveGllcyA9IGZ1bmN0aW9uKGJyb2FkUGhhc2UpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fcHJveHlDb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIHByb3h5ID0gdGhpcy5tX3Byb3hpZXNbaV07XG4gICAgICAgICAgYnJvYWRQaGFzZS5kZXN0cm95UHJveHkocHJveHkucHJveHlJZCk7XG4gICAgICAgICAgcHJveHkucHJveHlJZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3Byb3h5Q291bnQgPSAwO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zeW5jaHJvbml6ZSA9IGZ1bmN0aW9uKGJyb2FkUGhhc2UsIHhmMSwgeGYyKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX3Byb3h5Q291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciBwcm94eSA9IHRoaXMubV9wcm94aWVzW2ldO1xuICAgICAgICAgIHRoaXMubV9zaGFwZS5jb21wdXRlQUFCQihzeW5jaHJvbml6ZV9hYWJiMSwgeGYxLCBwcm94eS5jaGlsZEluZGV4KTtcbiAgICAgICAgICB0aGlzLm1fc2hhcGUuY29tcHV0ZUFBQkIoc3luY2hyb25pemVfYWFiYjIsIHhmMiwgcHJveHkuY2hpbGRJbmRleCk7XG4gICAgICAgICAgcHJveHkuYWFiYi5jb21iaW5lKHN5bmNocm9uaXplX2FhYmIxLCBzeW5jaHJvbml6ZV9hYWJiMik7XG4gICAgICAgICAgc3ViVmVjMihkaXNwbGFjZW1lbnQsIHhmMi5wLCB4ZjEucCk7XG4gICAgICAgICAgYnJvYWRQaGFzZS5tb3ZlUHJveHkocHJveHkucHJveHlJZCwgcHJveHkuYWFiYiwgZGlzcGxhY2VtZW50KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRGaWx0ZXJEYXRhID0gZnVuY3Rpb24oZmlsdGVyKSB7XG4gICAgICAgIHRoaXMubV9maWx0ZXJHcm91cEluZGV4ID0gZmlsdGVyLmdyb3VwSW5kZXg7XG4gICAgICAgIHRoaXMubV9maWx0ZXJDYXRlZ29yeUJpdHMgPSBmaWx0ZXIuY2F0ZWdvcnlCaXRzO1xuICAgICAgICB0aGlzLm1fZmlsdGVyTWFza0JpdHMgPSBmaWx0ZXIubWFza0JpdHM7XG4gICAgICAgIHRoaXMucmVmaWx0ZXIoKTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0RmlsdGVyR3JvdXBJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXg7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldEZpbHRlckdyb3VwSW5kZXggPSBmdW5jdGlvbihncm91cEluZGV4KSB7XG4gICAgICAgIHRoaXMubV9maWx0ZXJHcm91cEluZGV4ID0gZ3JvdXBJbmRleDtcbiAgICAgICAgdGhpcy5yZWZpbHRlcigpO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRGaWx0ZXJDYXRlZ29yeUJpdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9maWx0ZXJDYXRlZ29yeUJpdHM7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldEZpbHRlckNhdGVnb3J5Qml0cyA9IGZ1bmN0aW9uKGNhdGVnb3J5Qml0cykge1xuICAgICAgICB0aGlzLm1fZmlsdGVyQ2F0ZWdvcnlCaXRzID0gY2F0ZWdvcnlCaXRzO1xuICAgICAgICB0aGlzLnJlZmlsdGVyKCk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldEZpbHRlck1hc2tCaXRzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZmlsdGVyTWFza0JpdHM7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldEZpbHRlck1hc2tCaXRzID0gZnVuY3Rpb24obWFza0JpdHMpIHtcbiAgICAgICAgdGhpcy5tX2ZpbHRlck1hc2tCaXRzID0gbWFza0JpdHM7XG4gICAgICAgIHRoaXMucmVmaWx0ZXIoKTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUucmVmaWx0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMubV9ib2R5ID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVkZ2UgPSB0aGlzLm1fYm9keS5nZXRDb250YWN0TGlzdCgpO1xuICAgICAgICB3aGlsZSAoZWRnZSkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gZWRnZS5jb250YWN0O1xuICAgICAgICAgIHZhciBmaXh0dXJlQSA9IGNvbnRhY3QuZ2V0Rml4dHVyZUEoKTtcbiAgICAgICAgICB2YXIgZml4dHVyZUIgPSBjb250YWN0LmdldEZpeHR1cmVCKCk7XG4gICAgICAgICAgaWYgKGZpeHR1cmVBID09IHRoaXMgfHwgZml4dHVyZUIgPT0gdGhpcykge1xuICAgICAgICAgICAgY29udGFjdC5mbGFnRm9yRmlsdGVyaW5nKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVkZ2UgPSBlZGdlLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHdvcmxkID0gdGhpcy5tX2JvZHkuZ2V0V29ybGQoKTtcbiAgICAgICAgaWYgKHdvcmxkID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB3b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX3Byb3h5Q291bnQ7ICsraSkge1xuICAgICAgICAgIGJyb2FkUGhhc2UudG91Y2hQcm94eSh0aGlzLm1fcHJveGllc1tpXS5wcm94eUlkKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zaG91bGRDb2xsaWRlID0gZnVuY3Rpb24odGhhdCkge1xuICAgICAgICBpZiAodGhhdC5tX2ZpbHRlckdyb3VwSW5kZXggPT09IHRoaXMubV9maWx0ZXJHcm91cEluZGV4ICYmIHRoYXQubV9maWx0ZXJHcm91cEluZGV4ICE9PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIHRoYXQubV9maWx0ZXJHcm91cEluZGV4ID4gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29sbGlkZUEgPSAodGhhdC5tX2ZpbHRlck1hc2tCaXRzICYgdGhpcy5tX2ZpbHRlckNhdGVnb3J5Qml0cykgIT09IDA7XG4gICAgICAgIHZhciBjb2xsaWRlQiA9ICh0aGF0Lm1fZmlsdGVyQ2F0ZWdvcnlCaXRzICYgdGhpcy5tX2ZpbHRlck1hc2tCaXRzKSAhPT0gMDtcbiAgICAgICAgdmFyIGNvbGxpZGUgPSBjb2xsaWRlQSAmJiBjb2xsaWRlQjtcbiAgICAgICAgcmV0dXJuIGNvbGxpZGU7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIEZpeHR1cmUyO1xuICAgIH0oKVxuICApO1xuICB2YXIgU1RBVElDID0gXCJzdGF0aWNcIjtcbiAgdmFyIEtJTkVNQVRJQyA9IFwia2luZW1hdGljXCI7XG4gIHZhciBEWU5BTUlDID0gXCJkeW5hbWljXCI7XG4gIHZhciBvbGRDZW50ZXIgPSB2ZWMyKDAsIDApO1xuICB2YXIgbG9jYWxDZW50ZXIgPSB2ZWMyKDAsIDApO1xuICB2YXIgc2hpZnQgPSB2ZWMyKDAsIDApO1xuICB2YXIgdGVtcCQ2ID0gdmVjMigwLCAwKTtcbiAgdmFyIHhmJDIgPSB0cmFuc2Zvcm0oMCwgMCwgMCk7XG4gIHZhciBCb2R5RGVmRGVmYXVsdCA9IHtcbiAgICB0eXBlOiBTVEFUSUMsXG4gICAgcG9zaXRpb246IFZlYzIuemVybygpLFxuICAgIGFuZ2xlOiAwLFxuICAgIGxpbmVhclZlbG9jaXR5OiBWZWMyLnplcm8oKSxcbiAgICBhbmd1bGFyVmVsb2NpdHk6IDAsXG4gICAgbGluZWFyRGFtcGluZzogMCxcbiAgICBhbmd1bGFyRGFtcGluZzogMCxcbiAgICBmaXhlZFJvdGF0aW9uOiBmYWxzZSxcbiAgICBidWxsZXQ6IGZhbHNlLFxuICAgIGdyYXZpdHlTY2FsZTogMSxcbiAgICBhbGxvd1NsZWVwOiB0cnVlLFxuICAgIGF3YWtlOiB0cnVlLFxuICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICB1c2VyRGF0YTogbnVsbFxuICB9O1xuICB2YXIgQm9keSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBCb2R5Mih3b3JsZCwgZGVmKSB7XG4gICAgICAgIHRoaXMuc3R5bGUgPSB7fTtcbiAgICAgICAgdGhpcy5hcHBEYXRhID0ge307XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBCb2R5RGVmRGVmYXVsdCk7XG4gICAgICAgIHRoaXMubV93b3JsZCA9IHdvcmxkO1xuICAgICAgICB0aGlzLm1fYXdha2VGbGFnID0gZGVmLmF3YWtlO1xuICAgICAgICB0aGlzLm1fYXV0b1NsZWVwRmxhZyA9IGRlZi5hbGxvd1NsZWVwO1xuICAgICAgICB0aGlzLm1fYnVsbGV0RmxhZyA9IGRlZi5idWxsZXQ7XG4gICAgICAgIHRoaXMubV9maXhlZFJvdGF0aW9uRmxhZyA9IGRlZi5maXhlZFJvdGF0aW9uO1xuICAgICAgICB0aGlzLm1fYWN0aXZlRmxhZyA9IGRlZi5hY3RpdmU7XG4gICAgICAgIHRoaXMubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV90b2lGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRlZi51c2VyRGF0YTtcbiAgICAgICAgdGhpcy5tX3R5cGUgPSBkZWYudHlwZTtcbiAgICAgICAgaWYgKHRoaXMubV90eXBlID09IERZTkFNSUMpIHtcbiAgICAgICAgICB0aGlzLm1fbWFzcyA9IDE7XG4gICAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gMDtcbiAgICAgICAgICB0aGlzLm1faW52TWFzcyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX0kgPSAwO1xuICAgICAgICB0aGlzLm1faW52SSA9IDA7XG4gICAgICAgIHRoaXMubV94ZiA9IFRyYW5zZm9ybS5pZGVudGl0eSgpO1xuICAgICAgICB0aGlzLm1feGYucC5zZXRWZWMyKGRlZi5wb3NpdGlvbik7XG4gICAgICAgIHRoaXMubV94Zi5xLnNldEFuZ2xlKGRlZi5hbmdsZSk7XG4gICAgICAgIHRoaXMubV9zd2VlcCA9IG5ldyBTd2VlcCgpO1xuICAgICAgICB0aGlzLm1fc3dlZXAuc2V0VHJhbnNmb3JtKHRoaXMubV94Zik7XG4gICAgICAgIHRoaXMuY192ZWxvY2l0eSA9IG5ldyBWZWxvY2l0eSgpO1xuICAgICAgICB0aGlzLmNfcG9zaXRpb24gPSBuZXcgUG9zaXRpb24oKTtcbiAgICAgICAgdGhpcy5tX2ZvcmNlID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMubV90b3JxdWUgPSAwO1xuICAgICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkgPSBWZWMyLmNsb25lKGRlZi5saW5lYXJWZWxvY2l0eSk7XG4gICAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgPSBkZWYuYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICB0aGlzLm1fbGluZWFyRGFtcGluZyA9IGRlZi5saW5lYXJEYW1waW5nO1xuICAgICAgICB0aGlzLm1fYW5ndWxhckRhbXBpbmcgPSBkZWYuYW5ndWxhckRhbXBpbmc7XG4gICAgICAgIHRoaXMubV9ncmF2aXR5U2NhbGUgPSBkZWYuZ3Jhdml0eVNjYWxlO1xuICAgICAgICB0aGlzLm1fc2xlZXBUaW1lID0gMDtcbiAgICAgICAgdGhpcy5tX2pvaW50TGlzdCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9maXh0dXJlTGlzdCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9wcmV2ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX25leHQgPSBudWxsO1xuICAgICAgICB0aGlzLm1fZGVzdHJveWVkID0gZmFsc2U7XG4gICAgICAgIGlmICh0eXBlb2YgZGVmLnN0eWxlID09PSBcIm9iamVjdFwiICYmIGRlZi5zdHlsZSAhPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuc3R5bGUgPSBkZWYuc3R5bGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIEJvZHkyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBmaXh0dXJlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBmID0gdGhpcy5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgICBmaXh0dXJlcy5wdXNoKGYpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYnVsbGV0OiB0aGlzLm1fYnVsbGV0RmxhZyxcbiAgICAgICAgICBwb3NpdGlvbjogdGhpcy5tX3hmLnAsXG4gICAgICAgICAgYW5nbGU6IHRoaXMubV94Zi5xLmdldEFuZ2xlKCksXG4gICAgICAgICAgbGluZWFyVmVsb2NpdHk6IHRoaXMubV9saW5lYXJWZWxvY2l0eSxcbiAgICAgICAgICBhbmd1bGFyVmVsb2NpdHk6IHRoaXMubV9hbmd1bGFyVmVsb2NpdHksXG4gICAgICAgICAgZml4dHVyZXNcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICB2YXIgYm9keSA9IG5ldyBCb2R5Mih3b3JsZCwgZGF0YSk7XG4gICAgICAgIGlmIChkYXRhLmZpeHR1cmVzKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IGRhdGEuZml4dHVyZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBmaXh0dXJlID0gcmVzdG9yZShGaXh0dXJlLCBkYXRhLmZpeHR1cmVzW2ldLCBib2R5KTtcbiAgICAgICAgICAgIGJvZHkuX2FkZEZpeHR1cmUoZml4dHVyZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBib2R5O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc1dvcmxkTG9ja2VkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fd29ybGQgJiYgdGhpcy5tX3dvcmxkLmlzTG9ja2VkKCkgPyB0cnVlIDogZmFsc2U7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldFdvcmxkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fd29ybGQ7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldE5leHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgdGhpcy5tX3VzZXJEYXRhID0gZGF0YTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0VXNlckRhdGEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV91c2VyRGF0YTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0Rml4dHVyZUxpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9maXh0dXJlTGlzdDtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0Sm9pbnRMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fam9pbnRMaXN0O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRDb250YWN0TGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc1N0YXRpYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGUgPT0gU1RBVElDO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc0R5bmFtaWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlID09IERZTkFNSUM7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzS2luZW1hdGljID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZSA9PSBLSU5FTUFUSUM7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldFN0YXRpYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNldFR5cGUoU1RBVElDKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldER5bmFtaWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zZXRUeXBlKERZTkFNSUMpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0S2luZW1hdGljID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2V0VHlwZShLSU5FTUFUSUMpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldFR5cGUgPSBmdW5jdGlvbih0eXBlKSB7XG4gICAgICAgIGlmICh0aGlzLmlzV29ybGRMb2NrZWQoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSB0eXBlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV90eXBlID0gdHlwZTtcbiAgICAgICAgdGhpcy5yZXNldE1hc3NEYXRhKCk7XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSBTVEFUSUMpIHtcbiAgICAgICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgPSAwO1xuICAgICAgICAgIHRoaXMubV9zd2VlcC5mb3J3YXJkKCk7XG4gICAgICAgICAgdGhpcy5zeW5jaHJvbml6ZUZpeHR1cmVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2ZvcmNlLnNldFplcm8oKTtcbiAgICAgICAgdGhpcy5tX3RvcnF1ZSA9IDA7XG4gICAgICAgIHZhciBjZSA9IHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgICAgd2hpbGUgKGNlKSB7XG4gICAgICAgICAgdmFyIGNlMCA9IGNlO1xuICAgICAgICAgIGNlID0gY2UubmV4dDtcbiAgICAgICAgICB0aGlzLm1fd29ybGQuZGVzdHJveUNvbnRhY3QoY2UwLmNvbnRhY3QpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IG51bGw7XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmLm1fcHJveHlDb3VudDsgKytpKSB7XG4gICAgICAgICAgICBicm9hZFBoYXNlLnRvdWNoUHJveHkoZi5tX3Byb3hpZXNbaV0ucHJveHlJZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzQnVsbGV0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYnVsbGV0RmxhZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0QnVsbGV0ID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICB0aGlzLm1fYnVsbGV0RmxhZyA9ICEhZmxhZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNTbGVlcGluZ0FsbG93ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9hdXRvU2xlZXBGbGFnO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRTbGVlcGluZ0FsbG93ZWQgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIHRoaXMubV9hdXRvU2xlZXBGbGFnID0gISFmbGFnO1xuICAgICAgICBpZiAodGhpcy5tX2F1dG9TbGVlcEZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzQXdha2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9hd2FrZUZsYWc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEF3YWtlID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAoZmxhZykge1xuICAgICAgICAgIHRoaXMubV9hd2FrZUZsYWcgPSB0cnVlO1xuICAgICAgICAgIHRoaXMubV9zbGVlcFRpbWUgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9hd2FrZUZsYWcgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLm1fc2xlZXBUaW1lID0gMDtcbiAgICAgICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgPSAwO1xuICAgICAgICAgIHRoaXMubV9mb3JjZS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX3RvcnF1ZSA9IDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNBY3RpdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9hY3RpdmVGbGFnO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRBY3RpdmUgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnID09IHRoaXMubV9hY3RpdmVGbGFnKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9hY3RpdmVGbGFnID0gISFmbGFnO1xuICAgICAgICBpZiAodGhpcy5tX2FjdGl2ZUZsYWcpIHtcbiAgICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgICBmLmNyZWF0ZVByb3hpZXMoYnJvYWRQaGFzZSwgdGhpcy5tX3hmKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5tX3dvcmxkLm1fbmV3Rml4dHVyZSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICAgIGZvciAodmFyIGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgICAgZi5kZXN0cm95UHJveGllcyhicm9hZFBoYXNlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGNlID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgICAgICAgIHdoaWxlIChjZSkge1xuICAgICAgICAgICAgdmFyIGNlMCA9IGNlO1xuICAgICAgICAgICAgY2UgPSBjZS5uZXh0O1xuICAgICAgICAgICAgdGhpcy5tX3dvcmxkLmRlc3Ryb3lDb250YWN0KGNlMC5jb250YWN0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc0ZpeGVkUm90YXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9maXhlZFJvdGF0aW9uRmxhZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0Rml4ZWRSb3RhdGlvbiA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKHRoaXMubV9maXhlZFJvdGF0aW9uRmxhZyA9PSBmbGFnKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9maXhlZFJvdGF0aW9uRmxhZyA9ICEhZmxhZztcbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IDA7XG4gICAgICAgIHRoaXMucmVzZXRNYXNzRGF0YSgpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV94ZjtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0VHJhbnNmb3JtID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIGlmICh0aGlzLmlzV29ybGRMb2NrZWQoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgYjIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICB0aGlzLm1feGYuc2V0TnVtKGEyLCBiMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3hmLnNldFRyYW5zZm9ybShhMik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3N3ZWVwLnNldFRyYW5zZm9ybSh0aGlzLm1feGYpO1xuICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgIGZvciAodmFyIGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgIGYuc3luY2hyb25pemUoYnJvYWRQaGFzZSwgdGhpcy5tX3hmLCB0aGlzLm1feGYpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnN5bmNocm9uaXplVHJhbnNmb3JtID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV9zd2VlcC5nZXRUcmFuc2Zvcm0odGhpcy5tX3hmLCAxKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc3luY2hyb25pemVGaXh0dXJlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fc3dlZXAuZ2V0VHJhbnNmb3JtKHhmJDIsIDApO1xuICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgIGZvciAodmFyIGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgIGYuc3luY2hyb25pemUoYnJvYWRQaGFzZSwgeGYkMiwgdGhpcy5tX3hmKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5hZHZhbmNlID0gZnVuY3Rpb24oYWxwaGEpIHtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLmFkdmFuY2UoYWxwaGEpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLm1fc3dlZXAuYywgdGhpcy5tX3N3ZWVwLmMwKTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLmEgPSB0aGlzLm1fc3dlZXAuYTA7XG4gICAgICAgIHRoaXMubV9zd2VlcC5nZXRUcmFuc2Zvcm0odGhpcy5tX3hmLCAxKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0UG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV94Zi5wO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRQb3NpdGlvbiA9IGZ1bmN0aW9uKHApIHtcbiAgICAgICAgdGhpcy5zZXRUcmFuc2Zvcm0ocCwgdGhpcy5tX3N3ZWVwLmEpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRBbmdsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3N3ZWVwLmE7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEFuZ2xlID0gZnVuY3Rpb24oYW5nbGUpIHtcbiAgICAgICAgdGhpcy5zZXRUcmFuc2Zvcm0odGhpcy5tX3hmLnAsIGFuZ2xlKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0V29ybGRDZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9zd2VlcC5jO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRMb2NhbENlbnRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRMaW5lYXJWZWxvY2l0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xpbmVhclZlbG9jaXR5O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRMaW5lYXJWZWxvY2l0eUZyb21Xb3JsZFBvaW50ID0gZnVuY3Rpb24od29ybGRQb2ludCkge1xuICAgICAgICB2YXIgbG9jYWxDZW50ZXIyID0gVmVjMi5zdWIod29ybGRQb2ludCwgdGhpcy5tX3N3ZWVwLmMpO1xuICAgICAgICByZXR1cm4gVmVjMi5hZGQodGhpcy5tX2xpbmVhclZlbG9jaXR5LCBWZWMyLmNyb3NzTnVtVmVjMih0aGlzLm1fYW5ndWxhclZlbG9jaXR5LCBsb2NhbENlbnRlcjIpKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TGluZWFyVmVsb2NpdHlGcm9tTG9jYWxQb2ludCA9IGZ1bmN0aW9uKGxvY2FsUG9pbnQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TGluZWFyVmVsb2NpdHlGcm9tV29ybGRQb2ludCh0aGlzLmdldFdvcmxkUG9pbnQobG9jYWxQb2ludCkpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRMaW5lYXJWZWxvY2l0eSA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSBTVEFUSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFZlYzIuZG90KHYzLCB2MykgPiAwKSB7XG4gICAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkuc2V0VmVjMih2Myk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldEFuZ3VsYXJWZWxvY2l0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0QW5ndWxhclZlbG9jaXR5ID0gZnVuY3Rpb24odykge1xuICAgICAgICBpZiAodGhpcy5tX3R5cGUgPT0gU1RBVElDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3ICogdyA+IDApIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgPSB3O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRMaW5lYXJEYW1waW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbGluZWFyRGFtcGluZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0TGluZWFyRGFtcGluZyA9IGZ1bmN0aW9uKGxpbmVhckRhbXBpbmcpIHtcbiAgICAgICAgdGhpcy5tX2xpbmVhckRhbXBpbmcgPSBsaW5lYXJEYW1waW5nO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRBbmd1bGFyRGFtcGluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2FuZ3VsYXJEYW1waW5nO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRBbmd1bGFyRGFtcGluZyA9IGZ1bmN0aW9uKGFuZ3VsYXJEYW1waW5nKSB7XG4gICAgICAgIHRoaXMubV9hbmd1bGFyRGFtcGluZyA9IGFuZ3VsYXJEYW1waW5nO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRHcmF2aXR5U2NhbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ncmF2aXR5U2NhbGU7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEdyYXZpdHlTY2FsZSA9IGZ1bmN0aW9uKHNjYWxlKSB7XG4gICAgICAgIHRoaXMubV9ncmF2aXR5U2NhbGUgPSBzY2FsZTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TWFzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21hc3M7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldEluZXJ0aWEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9JICsgdGhpcy5tX21hc3MgKiBWZWMyLmRvdCh0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIsIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcik7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldE1hc3NEYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICBkYXRhLm1hc3MgPSB0aGlzLm1fbWFzcztcbiAgICAgICAgZGF0YS5JID0gdGhpcy5nZXRJbmVydGlhKCk7XG4gICAgICAgIGNvcHlWZWMyKGRhdGEuY2VudGVyLCB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5yZXNldE1hc3NEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV9tYXNzID0gMDtcbiAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAwO1xuICAgICAgICB0aGlzLm1fSSA9IDA7XG4gICAgICAgIHRoaXMubV9pbnZJID0gMDtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyKTtcbiAgICAgICAgaWYgKHRoaXMuaXNTdGF0aWMoKSB8fCB0aGlzLmlzS2luZW1hdGljKCkpIHtcbiAgICAgICAgICBjb3B5VmVjMih0aGlzLm1fc3dlZXAuYzAsIHRoaXMubV94Zi5wKTtcbiAgICAgICAgICBjb3B5VmVjMih0aGlzLm1fc3dlZXAuYywgdGhpcy5tX3hmLnApO1xuICAgICAgICAgIHRoaXMubV9zd2VlcC5hMCA9IHRoaXMubV9zd2VlcC5hO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB6ZXJvVmVjMihsb2NhbENlbnRlcik7XG4gICAgICAgIGZvciAodmFyIGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgIGlmIChmLm1fZGVuc2l0eSA9PSAwKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIG1hc3NEYXRhID0ge1xuICAgICAgICAgICAgbWFzczogMCxcbiAgICAgICAgICAgIGNlbnRlcjogdmVjMigwLCAwKSxcbiAgICAgICAgICAgIEk6IDBcbiAgICAgICAgICB9O1xuICAgICAgICAgIGYuZ2V0TWFzc0RhdGEobWFzc0RhdGEpO1xuICAgICAgICAgIHRoaXMubV9tYXNzICs9IG1hc3NEYXRhLm1hc3M7XG4gICAgICAgICAgcGx1c1NjYWxlVmVjMihsb2NhbENlbnRlciwgbWFzc0RhdGEubWFzcywgbWFzc0RhdGEuY2VudGVyKTtcbiAgICAgICAgICB0aGlzLm1fSSArPSBtYXNzRGF0YS5JO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fbWFzcyA+IDApIHtcbiAgICAgICAgICB0aGlzLm1faW52TWFzcyA9IDEgLyB0aGlzLm1fbWFzcztcbiAgICAgICAgICBzY2FsZVZlYzIobG9jYWxDZW50ZXIsIHRoaXMubV9pbnZNYXNzLCBsb2NhbENlbnRlcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSAxO1xuICAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX0kgPiAwICYmIHRoaXMubV9maXhlZFJvdGF0aW9uRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMubV9JIC09IHRoaXMubV9tYXNzICogZG90VmVjMihsb2NhbENlbnRlciwgbG9jYWxDZW50ZXIpO1xuICAgICAgICAgIHRoaXMubV9pbnZJID0gMSAvIHRoaXMubV9JO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9JID0gMDtcbiAgICAgICAgICB0aGlzLm1faW52SSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgY29weVZlYzIob2xkQ2VudGVyLCB0aGlzLm1fc3dlZXAuYyk7XG4gICAgICAgIHRoaXMubV9zd2VlcC5zZXRMb2NhbENlbnRlcihsb2NhbENlbnRlciwgdGhpcy5tX3hmKTtcbiAgICAgICAgc3ViVmVjMihzaGlmdCwgdGhpcy5tX3N3ZWVwLmMsIG9sZENlbnRlcik7XG4gICAgICAgIGNyb3NzTnVtVmVjMih0ZW1wJDYsIHRoaXMubV9hbmd1bGFyVmVsb2NpdHksIHNoaWZ0KTtcbiAgICAgICAgcGx1c1ZlYzIodGhpcy5tX2xpbmVhclZlbG9jaXR5LCB0ZW1wJDYpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRNYXNzRGF0YSA9IGZ1bmN0aW9uKG1hc3NEYXRhKSB7XG4gICAgICAgIGlmICh0aGlzLmlzV29ybGRMb2NrZWQoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBEWU5BTUlDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9pbnZNYXNzID0gMDtcbiAgICAgICAgdGhpcy5tX0kgPSAwO1xuICAgICAgICB0aGlzLm1faW52SSA9IDA7XG4gICAgICAgIHRoaXMubV9tYXNzID0gbWFzc0RhdGEubWFzcztcbiAgICAgICAgaWYgKHRoaXMubV9tYXNzIDw9IDApIHtcbiAgICAgICAgICB0aGlzLm1fbWFzcyA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAxIC8gdGhpcy5tX21hc3M7XG4gICAgICAgIGlmIChtYXNzRGF0YS5JID4gMCAmJiB0aGlzLm1fZml4ZWRSb3RhdGlvbkZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLm1fSSA9IG1hc3NEYXRhLkkgLSB0aGlzLm1fbWFzcyAqIGRvdFZlYzIobWFzc0RhdGEuY2VudGVyLCBtYXNzRGF0YS5jZW50ZXIpO1xuICAgICAgICAgIHRoaXMubV9pbnZJID0gMSAvIHRoaXMubV9JO1xuICAgICAgICB9XG4gICAgICAgIGNvcHlWZWMyKG9sZENlbnRlciwgdGhpcy5tX3N3ZWVwLmMpO1xuICAgICAgICB0aGlzLm1fc3dlZXAuc2V0TG9jYWxDZW50ZXIobWFzc0RhdGEuY2VudGVyLCB0aGlzLm1feGYpO1xuICAgICAgICBzdWJWZWMyKHNoaWZ0LCB0aGlzLm1fc3dlZXAuYywgb2xkQ2VudGVyKTtcbiAgICAgICAgY3Jvc3NOdW1WZWMyKHRlbXAkNiwgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSwgc2hpZnQpO1xuICAgICAgICBwbHVzVmVjMih0aGlzLm1fbGluZWFyVmVsb2NpdHksIHRlbXAkNik7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmFwcGx5Rm9yY2UgPSBmdW5jdGlvbihmb3JjZSwgcG9pbnQyLCB3YWtlKSB7XG4gICAgICAgIGlmICh3YWtlID09PSB2b2lkIDApIHtcbiAgICAgICAgICB3YWtlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX3R5cGUgIT0gRFlOQU1JQykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAod2FrZSAmJiB0aGlzLm1fYXdha2VGbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2F3YWtlRmxhZykge1xuICAgICAgICAgIHRoaXMubV9mb3JjZS5hZGQoZm9yY2UpO1xuICAgICAgICAgIHRoaXMubV90b3JxdWUgKz0gVmVjMi5jcm9zc1ZlYzJWZWMyKFZlYzIuc3ViKHBvaW50MiwgdGhpcy5tX3N3ZWVwLmMpLCBmb3JjZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuYXBwbHlGb3JjZVRvQ2VudGVyID0gZnVuY3Rpb24oZm9yY2UsIHdha2UpIHtcbiAgICAgICAgaWYgKHdha2UgPT09IHZvaWQgMCkge1xuICAgICAgICAgIHdha2UgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBEWU5BTUlDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3YWtlICYmIHRoaXMubV9hd2FrZUZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYXdha2VGbGFnKSB7XG4gICAgICAgICAgdGhpcy5tX2ZvcmNlLmFkZChmb3JjZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuYXBwbHlUb3JxdWUgPSBmdW5jdGlvbih0b3JxdWUsIHdha2UpIHtcbiAgICAgICAgaWYgKHdha2UgPT09IHZvaWQgMCkge1xuICAgICAgICAgIHdha2UgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBEWU5BTUlDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3YWtlICYmIHRoaXMubV9hd2FrZUZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYXdha2VGbGFnKSB7XG4gICAgICAgICAgdGhpcy5tX3RvcnF1ZSArPSB0b3JxdWU7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuYXBwbHlMaW5lYXJJbXB1bHNlID0gZnVuY3Rpb24oaW1wdWxzZSwgcG9pbnQyLCB3YWtlKSB7XG4gICAgICAgIGlmICh3YWtlID09PSB2b2lkIDApIHtcbiAgICAgICAgICB3YWtlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX3R5cGUgIT0gRFlOQU1JQykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAod2FrZSAmJiB0aGlzLm1fYXdha2VGbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2F3YWtlRmxhZykge1xuICAgICAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS5hZGRNdWwodGhpcy5tX2ludk1hc3MsIGltcHVsc2UpO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKz0gdGhpcy5tX2ludkkgKiBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5zdWIocG9pbnQyLCB0aGlzLm1fc3dlZXAuYyksIGltcHVsc2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmFwcGx5QW5ndWxhckltcHVsc2UgPSBmdW5jdGlvbihpbXB1bHNlLCB3YWtlKSB7XG4gICAgICAgIGlmICh3YWtlID09PSB2b2lkIDApIHtcbiAgICAgICAgICB3YWtlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX3R5cGUgIT0gRFlOQU1JQykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAod2FrZSAmJiB0aGlzLm1fYXdha2VGbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2F3YWtlRmxhZykge1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKz0gdGhpcy5tX2ludkkgKiBpbXB1bHNlO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNob3VsZENvbGxpZGUgPSBmdW5jdGlvbih0aGF0KSB7XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBEWU5BTUlDICYmIHRoYXQubV90eXBlICE9IERZTkFNSUMpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgam4gPSB0aGlzLm1fam9pbnRMaXN0OyBqbjsgam4gPSBqbi5uZXh0KSB7XG4gICAgICAgICAgaWYgKGpuLm90aGVyID09IHRoYXQpIHtcbiAgICAgICAgICAgIGlmIChqbi5qb2ludC5tX2NvbGxpZGVDb25uZWN0ZWQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuX2FkZEZpeHR1cmUgPSBmdW5jdGlvbihmaXh0dXJlKSB7XG4gICAgICAgIGlmICh0aGlzLmlzV29ybGRMb2NrZWQoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9hY3RpdmVGbGFnKSB7XG4gICAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICAgIGZpeHR1cmUuY3JlYXRlUHJveGllcyhicm9hZFBoYXNlLCB0aGlzLm1feGYpO1xuICAgICAgICB9XG4gICAgICAgIGZpeHR1cmUubV9uZXh0ID0gdGhpcy5tX2ZpeHR1cmVMaXN0O1xuICAgICAgICB0aGlzLm1fZml4dHVyZUxpc3QgPSBmaXh0dXJlO1xuICAgICAgICBpZiAoZml4dHVyZS5tX2RlbnNpdHkgPiAwKSB7XG4gICAgICAgICAgdGhpcy5yZXNldE1hc3NEYXRhKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3dvcmxkLm1fbmV3Rml4dHVyZSA9IHRydWU7XG4gICAgICAgIHJldHVybiBmaXh0dXJlO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5jcmVhdGVGaXh0dXJlID0gZnVuY3Rpb24oc2hhcGUsIGZpeGRlZikge1xuICAgICAgICBpZiAodGhpcy5pc1dvcmxkTG9ja2VkKCkgPT0gdHJ1ZSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmaXh0dXJlID0gbmV3IEZpeHR1cmUodGhpcywgc2hhcGUsIGZpeGRlZik7XG4gICAgICAgIHRoaXMuX2FkZEZpeHR1cmUoZml4dHVyZSk7XG4gICAgICAgIHJldHVybiBmaXh0dXJlO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5kZXN0cm95Rml4dHVyZSA9IGZ1bmN0aW9uKGZpeHR1cmUpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNXb3JsZExvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9maXh0dXJlTGlzdCA9PT0gZml4dHVyZSkge1xuICAgICAgICAgIHRoaXMubV9maXh0dXJlTGlzdCA9IGZpeHR1cmUubV9uZXh0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBub2RlID0gdGhpcy5tX2ZpeHR1cmVMaXN0O1xuICAgICAgICAgIHdoaWxlIChub2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChub2RlLm1fbmV4dCA9PT0gZml4dHVyZSkge1xuICAgICAgICAgICAgICBub2RlLm1fbmV4dCA9IGZpeHR1cmUubV9uZXh0O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vZGUgPSBub2RlLm1fbmV4dDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVkZ2UgPSB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICAgIHdoaWxlIChlZGdlKSB7XG4gICAgICAgICAgdmFyIGMyID0gZWRnZS5jb250YWN0O1xuICAgICAgICAgIGVkZ2UgPSBlZGdlLm5leHQ7XG4gICAgICAgICAgdmFyIGZpeHR1cmVBID0gYzIuZ2V0Rml4dHVyZUEoKTtcbiAgICAgICAgICB2YXIgZml4dHVyZUIgPSBjMi5nZXRGaXh0dXJlQigpO1xuICAgICAgICAgIGlmIChmaXh0dXJlID09IGZpeHR1cmVBIHx8IGZpeHR1cmUgPT0gZml4dHVyZUIpIHtcbiAgICAgICAgICAgIHRoaXMubV93b3JsZC5kZXN0cm95Q29udGFjdChjMik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYWN0aXZlRmxhZykge1xuICAgICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgICBmaXh0dXJlLmRlc3Ryb3lQcm94aWVzKGJyb2FkUGhhc2UpO1xuICAgICAgICB9XG4gICAgICAgIGZpeHR1cmUubV9ib2R5ID0gbnVsbDtcbiAgICAgICAgZml4dHVyZS5tX25leHQgPSBudWxsO1xuICAgICAgICB0aGlzLm1fd29ybGQucHVibGlzaChcInJlbW92ZS1maXh0dXJlXCIsIGZpeHR1cmUpO1xuICAgICAgICB0aGlzLnJlc2V0TWFzc0RhdGEoKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0V29ybGRQb2ludCA9IGZ1bmN0aW9uKGxvY2FsUG9pbnQpIHtcbiAgICAgICAgcmV0dXJuIFRyYW5zZm9ybS5tdWxWZWMyKHRoaXMubV94ZiwgbG9jYWxQb2ludCk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldFdvcmxkVmVjdG9yID0gZnVuY3Rpb24obG9jYWxWZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIFJvdC5tdWxWZWMyKHRoaXMubV94Zi5xLCBsb2NhbFZlY3Rvcik7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExvY2FsUG9pbnQgPSBmdW5jdGlvbih3b3JsZFBvaW50KSB7XG4gICAgICAgIHJldHVybiBUcmFuc2Zvcm0ubXVsVFZlYzIodGhpcy5tX3hmLCB3b3JsZFBvaW50KTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TG9jYWxWZWN0b3IgPSBmdW5jdGlvbih3b3JsZFZlY3Rvcikge1xuICAgICAgICByZXR1cm4gUm90Lm11bFRWZWMyKHRoaXMubV94Zi5xLCB3b3JsZFZlY3Rvcik7XG4gICAgICB9O1xuICAgICAgQm9keTIuU1RBVElDID0gXCJzdGF0aWNcIjtcbiAgICAgIEJvZHkyLktJTkVNQVRJQyA9IFwia2luZW1hdGljXCI7XG4gICAgICBCb2R5Mi5EWU5BTUlDID0gXCJkeW5hbWljXCI7XG4gICAgICByZXR1cm4gQm9keTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBKb2ludEVkZ2UgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIC8qIEBfX1BVUkVfXyAqLyBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEpvaW50RWRnZTIoKSB7XG4gICAgICAgIHRoaXMub3RoZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmpvaW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcmV2ID0gbnVsbDtcbiAgICAgICAgdGhpcy5uZXh0ID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBKb2ludEVkZ2UyO1xuICAgIH0oKVxuICApO1xuICB2YXIgSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCKSB7XG4gICAgICAgIHRoaXMubV90eXBlID0gXCJ1bmtub3duLWpvaW50XCI7XG4gICAgICAgIHRoaXMubV9wcmV2ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX25leHQgPSBudWxsO1xuICAgICAgICB0aGlzLm1fZWRnZUEgPSBuZXcgSm9pbnRFZGdlKCk7XG4gICAgICAgIHRoaXMubV9lZGdlQiA9IG5ldyBKb2ludEVkZ2UoKTtcbiAgICAgICAgdGhpcy5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zdHlsZSA9IHt9O1xuICAgICAgICB0aGlzLmFwcERhdGEgPSB7fTtcbiAgICAgICAgYm9keUEgPSBcImJvZHlBXCIgaW4gZGVmID8gZGVmLmJvZHlBIDogYm9keUE7XG4gICAgICAgIGJvZHlCID0gXCJib2R5QlwiIGluIGRlZiA/IGRlZi5ib2R5QiA6IGJvZHlCO1xuICAgICAgICB0aGlzLm1fYm9keUEgPSBib2R5QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCID0gYm9keUI7XG4gICAgICAgIHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkID0gISFkZWYuY29sbGlkZUNvbm5lY3RlZDtcbiAgICAgICAgdGhpcy5tX3VzZXJEYXRhID0gZGVmLnVzZXJEYXRhO1xuICAgICAgICBpZiAodHlwZW9mIGRlZi5zdHlsZSA9PT0gXCJvYmplY3RcIiAmJiBkZWYuc3R5bGUgIT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLnN0eWxlID0gZGVmLnN0eWxlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBKb2ludDIucHJvdG90eXBlLmlzQWN0aXZlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuaXNBY3RpdmUoKSAmJiB0aGlzLm1fYm9keUIuaXNBY3RpdmUoKTtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlO1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuZ2V0Qm9keUEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QTtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLmdldEJvZHlCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUI7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5nZXROZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLmdldFVzZXJEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdXNlckRhdGE7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5zZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgdGhpcy5tX3VzZXJEYXRhID0gZGF0YTtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLmdldENvbGxpZGVDb25uZWN0ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkO1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuc2hpZnRPcmlnaW4gPSBmdW5jdGlvbihuZXdPcmlnaW4pIHtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLl9yZXNldEFuY2hvcnMgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc2V0KGRlZik7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIEpvaW50MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIHN0YXRzID0ge1xuICAgIGdqa0NhbGxzOiAwLFxuICAgIGdqa0l0ZXJzOiAwLFxuICAgIGdqa01heEl0ZXJzOiAwLFxuICAgIHRvaVRpbWU6IDAsXG4gICAgdG9pTWF4VGltZTogMCxcbiAgICB0b2lDYWxsczogMCxcbiAgICB0b2lJdGVyczogMCxcbiAgICB0b2lNYXhJdGVyczogMCxcbiAgICB0b2lSb290SXRlcnM6IDAsXG4gICAgdG9pTWF4Um9vdEl0ZXJzOiAwLFxuICAgIHRvU3RyaW5nOiBmdW5jdGlvbihuZXdsaW5lKSB7XG4gICAgICBuZXdsaW5lID0gdHlwZW9mIG5ld2xpbmUgPT09IFwic3RyaW5nXCIgPyBuZXdsaW5lIDogXCJcXG5cIjtcbiAgICAgIHZhciBzdHJpbmcgPSBcIlwiO1xuICAgICAgZm9yICh2YXIgbmFtZV8xIGluIHRoaXMpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzW25hbWVfMV0gIT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgdGhpc1tuYW1lXzFdICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgc3RyaW5nICs9IG5hbWVfMSArIFwiOiBcIiArIHRoaXNbbmFtZV8xXSArIG5ld2xpbmU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfVxuICB9O1xuICB2YXIgbm93ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIERhdGUubm93KCk7XG4gIH07XG4gIHZhciBkaWZmID0gZnVuY3Rpb24odGltZSkge1xuICAgIHJldHVybiBEYXRlLm5vdygpIC0gdGltZTtcbiAgfTtcbiAgY29uc3QgVGltZXIgPSB7XG4gICAgbm93LFxuICAgIGRpZmZcbiAgfTtcbiAgdmFyIG1hdGhfbWF4JDQgPSBNYXRoLm1heDtcbiAgdmFyIHRlbXAkNSA9IHZlYzIoMCwgMCk7XG4gIHZhciBub3JtYWwkNCA9IHZlYzIoMCwgMCk7XG4gIHZhciBlMTIgPSB2ZWMyKDAsIDApO1xuICB2YXIgZTEzID0gdmVjMigwLCAwKTtcbiAgdmFyIGUyMyA9IHZlYzIoMCwgMCk7XG4gIHZhciB0ZW1wMSA9IHZlYzIoMCwgMCk7XG4gIHZhciB0ZW1wMiA9IHZlYzIoMCwgMCk7XG4gIHN0YXRzLmdqa0NhbGxzID0gMDtcbiAgc3RhdHMuZ2prSXRlcnMgPSAwO1xuICBzdGF0cy5namtNYXhJdGVycyA9IDA7XG4gIHZhciBEaXN0YW5jZUlucHV0ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIERpc3RhbmNlSW5wdXQyKCkge1xuICAgICAgICB0aGlzLnByb3h5QSA9IG5ldyBEaXN0YW5jZVByb3h5KCk7XG4gICAgICAgIHRoaXMucHJveHlCID0gbmV3IERpc3RhbmNlUHJveHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1BID0gVHJhbnNmb3JtLmlkZW50aXR5KCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtQiA9IFRyYW5zZm9ybS5pZGVudGl0eSgpO1xuICAgICAgICB0aGlzLnVzZVJhZGlpID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBEaXN0YW5jZUlucHV0Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnByb3h5QS5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMucHJveHlCLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1BLnNldElkZW50aXR5KCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtQi5zZXRJZGVudGl0eSgpO1xuICAgICAgICB0aGlzLnVzZVJhZGlpID0gZmFsc2U7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIERpc3RhbmNlSW5wdXQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgRGlzdGFuY2VPdXRwdXQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRGlzdGFuY2VPdXRwdXQyKCkge1xuICAgICAgICB0aGlzLnBvaW50QSA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMucG9pbnRCID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5kaXN0YW5jZSA9IDA7XG4gICAgICAgIHRoaXMuaXRlcmF0aW9ucyA9IDA7XG4gICAgICB9XG4gICAgICBEaXN0YW5jZU91dHB1dDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5wb2ludEEpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBvaW50Qik7XG4gICAgICAgIHRoaXMuZGlzdGFuY2UgPSAwO1xuICAgICAgICB0aGlzLml0ZXJhdGlvbnMgPSAwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBEaXN0YW5jZU91dHB1dDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBTaW1wbGV4Q2FjaGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2ltcGxleENhY2hlMigpIHtcbiAgICAgICAgdGhpcy5tZXRyaWMgPSAwO1xuICAgICAgICB0aGlzLmluZGV4QSA9IFtdO1xuICAgICAgICB0aGlzLmluZGV4QiA9IFtdO1xuICAgICAgICB0aGlzLmNvdW50ID0gMDtcbiAgICAgIH1cbiAgICAgIFNpbXBsZXhDYWNoZTIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tZXRyaWMgPSAwO1xuICAgICAgICB0aGlzLmluZGV4QS5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLmluZGV4Qi5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLmNvdW50ID0gMDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gU2ltcGxleENhY2hlMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIERpc3RhbmNlID0gZnVuY3Rpb24ob3V0cHV0MiwgY2FjaGUyLCBpbnB1dDIpIHtcbiAgICArK3N0YXRzLmdqa0NhbGxzO1xuICAgIHZhciBwcm94eUEgPSBpbnB1dDIucHJveHlBO1xuICAgIHZhciBwcm94eUIgPSBpbnB1dDIucHJveHlCO1xuICAgIHZhciB4ZkEyID0gaW5wdXQyLnRyYW5zZm9ybUE7XG4gICAgdmFyIHhmQjIgPSBpbnB1dDIudHJhbnNmb3JtQjtcbiAgICBzaW1wbGV4LnJlY3ljbGUoKTtcbiAgICBzaW1wbGV4LnJlYWRDYWNoZShjYWNoZTIsIHByb3h5QSwgeGZBMiwgcHJveHlCLCB4ZkIyKTtcbiAgICB2YXIgdmVydGljZXMgPSBzaW1wbGV4Lm1fdjtcbiAgICB2YXIga19tYXhJdGVycyA9IFNldHRpbmdzSW50ZXJuYWwubWF4RGlzdGFuY2VJdGVyYXRpb25zO1xuICAgIHZhciBzYXZlQSA9IFtdO1xuICAgIHZhciBzYXZlQiA9IFtdO1xuICAgIHZhciBzYXZlQ291bnQgPSAwO1xuICAgIHZhciBpdGVyID0gMDtcbiAgICB3aGlsZSAoaXRlciA8IGtfbWF4SXRlcnMpIHtcbiAgICAgIHNhdmVDb3VudCA9IHNpbXBsZXgubV9jb3VudDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2F2ZUNvdW50OyArK2kpIHtcbiAgICAgICAgc2F2ZUFbaV0gPSB2ZXJ0aWNlc1tpXS5pbmRleEE7XG4gICAgICAgIHNhdmVCW2ldID0gdmVydGljZXNbaV0uaW5kZXhCO1xuICAgICAgfVxuICAgICAgc2ltcGxleC5zb2x2ZSgpO1xuICAgICAgaWYgKHNpbXBsZXgubV9jb3VudCA9PT0gMykge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHZhciBkMiA9IHNpbXBsZXguZ2V0U2VhcmNoRGlyZWN0aW9uKCk7XG4gICAgICBpZiAobGVuZ3RoU3FyVmVjMihkMikgPCBFUFNJTE9OICogRVBTSUxPTikge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHZhciB2ZXJ0ZXggPSB2ZXJ0aWNlc1tzaW1wbGV4Lm1fY291bnRdO1xuICAgICAgdmVydGV4LmluZGV4QSA9IHByb3h5QS5nZXRTdXBwb3J0KGRlcm90VmVjMih0ZW1wJDUsIHhmQTIucSwgc2NhbGVWZWMyKHRlbXAkNSwgLTEsIGQyKSkpO1xuICAgICAgdHJhbnNmb3JtVmVjMih2ZXJ0ZXgud0EsIHhmQTIsIHByb3h5QS5nZXRWZXJ0ZXgodmVydGV4LmluZGV4QSkpO1xuICAgICAgdmVydGV4LmluZGV4QiA9IHByb3h5Qi5nZXRTdXBwb3J0KGRlcm90VmVjMih0ZW1wJDUsIHhmQjIucSwgZDIpKTtcbiAgICAgIHRyYW5zZm9ybVZlYzIodmVydGV4LndCLCB4ZkIyLCBwcm94eUIuZ2V0VmVydGV4KHZlcnRleC5pbmRleEIpKTtcbiAgICAgIHN1YlZlYzIodmVydGV4LncsIHZlcnRleC53QiwgdmVydGV4LndBKTtcbiAgICAgICsraXRlcjtcbiAgICAgICsrc3RhdHMuZ2prSXRlcnM7XG4gICAgICB2YXIgZHVwbGljYXRlID0gZmFsc2U7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNhdmVDb3VudDsgKytpKSB7XG4gICAgICAgIGlmICh2ZXJ0ZXguaW5kZXhBID09PSBzYXZlQVtpXSAmJiB2ZXJ0ZXguaW5kZXhCID09PSBzYXZlQltpXSkge1xuICAgICAgICAgIGR1cGxpY2F0ZSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChkdXBsaWNhdGUpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICArK3NpbXBsZXgubV9jb3VudDtcbiAgICB9XG4gICAgc3RhdHMuZ2prTWF4SXRlcnMgPSBtYXRoX21heCQ0KHN0YXRzLmdqa01heEl0ZXJzLCBpdGVyKTtcbiAgICBzaW1wbGV4LmdldFdpdG5lc3NQb2ludHMob3V0cHV0Mi5wb2ludEEsIG91dHB1dDIucG9pbnRCKTtcbiAgICBvdXRwdXQyLmRpc3RhbmNlID0gZGlzdFZlYzIob3V0cHV0Mi5wb2ludEEsIG91dHB1dDIucG9pbnRCKTtcbiAgICBvdXRwdXQyLml0ZXJhdGlvbnMgPSBpdGVyO1xuICAgIHNpbXBsZXgud3JpdGVDYWNoZShjYWNoZTIpO1xuICAgIGlmIChpbnB1dDIudXNlUmFkaWkpIHtcbiAgICAgIHZhciByQTIgPSBwcm94eUEubV9yYWRpdXM7XG4gICAgICB2YXIgckIyID0gcHJveHlCLm1fcmFkaXVzO1xuICAgICAgaWYgKG91dHB1dDIuZGlzdGFuY2UgPiByQTIgKyByQjIgJiYgb3V0cHV0Mi5kaXN0YW5jZSA+IEVQU0lMT04pIHtcbiAgICAgICAgb3V0cHV0Mi5kaXN0YW5jZSAtPSByQTIgKyByQjI7XG4gICAgICAgIHN1YlZlYzIobm9ybWFsJDQsIG91dHB1dDIucG9pbnRCLCBvdXRwdXQyLnBvaW50QSk7XG4gICAgICAgIG5vcm1hbGl6ZVZlYzIobm9ybWFsJDQpO1xuICAgICAgICBwbHVzU2NhbGVWZWMyKG91dHB1dDIucG9pbnRBLCByQTIsIG5vcm1hbCQ0KTtcbiAgICAgICAgbWludXNTY2FsZVZlYzIob3V0cHV0Mi5wb2ludEIsIHJCMiwgbm9ybWFsJDQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHAgPSBzdWJWZWMyKHRlbXAkNSwgb3V0cHV0Mi5wb2ludEEsIG91dHB1dDIucG9pbnRCKTtcbiAgICAgICAgY29weVZlYzIob3V0cHV0Mi5wb2ludEEsIHApO1xuICAgICAgICBjb3B5VmVjMihvdXRwdXQyLnBvaW50QiwgcCk7XG4gICAgICAgIG91dHB1dDIuZGlzdGFuY2UgPSAwO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgdmFyIERpc3RhbmNlUHJveHkgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRGlzdGFuY2VQcm94eTIoKSB7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlcyA9IFtdO1xuICAgICAgICB0aGlzLm1fY291bnQgPSAwO1xuICAgICAgICB0aGlzLm1fcmFkaXVzID0gMDtcbiAgICAgIH1cbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlcy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLm1fY291bnQgPSAwO1xuICAgICAgICB0aGlzLm1fcmFkaXVzID0gMDtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZVByb3h5Mi5wcm90b3R5cGUuZ2V0VmVydGV4Q291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jb3VudDtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZVByb3h5Mi5wcm90b3R5cGUuZ2V0VmVydGV4ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0aWNlc1tpbmRleF07XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VQcm94eTIucHJvdG90eXBlLmdldFN1cHBvcnQgPSBmdW5jdGlvbihkMikge1xuICAgICAgICB2YXIgYmVzdEluZGV4ID0gLTE7XG4gICAgICAgIHZhciBiZXN0VmFsdWUgPSAtSW5maW5pdHk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBkb3RWZWMyKHRoaXMubV92ZXJ0aWNlc1tpXSwgZDIpO1xuICAgICAgICAgIGlmICh2YWx1ZSA+IGJlc3RWYWx1ZSkge1xuICAgICAgICAgICAgYmVzdEluZGV4ID0gaTtcbiAgICAgICAgICAgIGJlc3RWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYmVzdEluZGV4O1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5nZXRTdXBwb3J0VmVydGV4ID0gZnVuY3Rpb24oZDIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0aWNlc1t0aGlzLmdldFN1cHBvcnQoZDIpXTtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZVByb3h5Mi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24oc2hhcGUsIGluZGV4KSB7XG4gICAgICAgIHNoYXBlLmNvbXB1dGVEaXN0YW5jZVByb3h5KHRoaXMsIGluZGV4KTtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZVByb3h5Mi5wcm90b3R5cGUuc2V0VmVydGljZXMgPSBmdW5jdGlvbih2ZXJ0aWNlcywgY291bnQsIHJhZGl1cykge1xuICAgICAgICB0aGlzLm1fdmVydGljZXMgPSB2ZXJ0aWNlcztcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gY291bnQ7XG4gICAgICAgIHRoaXMubV9yYWRpdXMgPSByYWRpdXM7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIERpc3RhbmNlUHJveHkyO1xuICAgIH0oKVxuICApO1xuICB2YXIgU2ltcGxleFZlcnRleCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTaW1wbGV4VmVydGV4MigpIHtcbiAgICAgICAgdGhpcy53QSA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gMDtcbiAgICAgICAgdGhpcy53QiA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gMDtcbiAgICAgICAgdGhpcy53ID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5hID0gMDtcbiAgICAgIH1cbiAgICAgIFNpbXBsZXhWZXJ0ZXgyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gMDtcbiAgICAgICAgdGhpcy5pbmRleEIgPSAwO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLndBKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy53Qik7XG4gICAgICAgIHplcm9WZWMyKHRoaXMudyk7XG4gICAgICAgIHRoaXMuYSA9IDA7XG4gICAgICB9O1xuICAgICAgU2ltcGxleFZlcnRleDIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gdjMuaW5kZXhBO1xuICAgICAgICB0aGlzLmluZGV4QiA9IHYzLmluZGV4QjtcbiAgICAgICAgY29weVZlYzIodGhpcy53QSwgdjMud0EpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLndCLCB2My53Qik7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMudywgdjMudyk7XG4gICAgICAgIHRoaXMuYSA9IHYzLmE7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFNpbXBsZXhWZXJ0ZXgyO1xuICAgIH0oKVxuICApO1xuICB2YXIgc2VhcmNoRGlyZWN0aW9uX3JldXNlID0gdmVjMigwLCAwKTtcbiAgdmFyIGNsb3Nlc3RQb2ludF9yZXVzZSA9IHZlYzIoMCwgMCk7XG4gIHZhciBTaW1wbGV4ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNpbXBsZXgyKCkge1xuICAgICAgICB0aGlzLm1fdjEgPSBuZXcgU2ltcGxleFZlcnRleCgpO1xuICAgICAgICB0aGlzLm1fdjIgPSBuZXcgU2ltcGxleFZlcnRleCgpO1xuICAgICAgICB0aGlzLm1fdjMgPSBuZXcgU2ltcGxleFZlcnRleCgpO1xuICAgICAgICB0aGlzLm1fdiA9IFt0aGlzLm1fdjEsIHRoaXMubV92MiwgdGhpcy5tX3YzXTtcbiAgICAgIH1cbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV92MS5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMubV92Mi5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMubV92My5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMubV9jb3VudCA9IDA7XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm1fY291bnQgPT09IDMpIHtcbiAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgXCIrXCIgKyB0aGlzLm1fY291bnQsXG4gICAgICAgICAgICB0aGlzLm1fdjEuYSxcbiAgICAgICAgICAgIHRoaXMubV92MS53QS54LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndBLnksXG4gICAgICAgICAgICB0aGlzLm1fdjEud0IueCxcbiAgICAgICAgICAgIHRoaXMubV92MS53Qi55LFxuICAgICAgICAgICAgdGhpcy5tX3YyLmEsXG4gICAgICAgICAgICB0aGlzLm1fdjIud0EueCxcbiAgICAgICAgICAgIHRoaXMubV92Mi53QS55LFxuICAgICAgICAgICAgdGhpcy5tX3YyLndCLngsXG4gICAgICAgICAgICB0aGlzLm1fdjIud0IueSxcbiAgICAgICAgICAgIHRoaXMubV92My5hLFxuICAgICAgICAgICAgdGhpcy5tX3YzLndBLngsXG4gICAgICAgICAgICB0aGlzLm1fdjMud0EueSxcbiAgICAgICAgICAgIHRoaXMubV92My53Qi54LFxuICAgICAgICAgICAgdGhpcy5tX3YzLndCLnlcbiAgICAgICAgICBdLnRvU3RyaW5nKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5tX2NvdW50ID09PSAyKSB7XG4gICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFwiK1wiICsgdGhpcy5tX2NvdW50LFxuICAgICAgICAgICAgdGhpcy5tX3YxLmEsXG4gICAgICAgICAgICB0aGlzLm1fdjEud0EueCxcbiAgICAgICAgICAgIHRoaXMubV92MS53QS55LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndCLngsXG4gICAgICAgICAgICB0aGlzLm1fdjEud0IueSxcbiAgICAgICAgICAgIHRoaXMubV92Mi5hLFxuICAgICAgICAgICAgdGhpcy5tX3YyLndBLngsXG4gICAgICAgICAgICB0aGlzLm1fdjIud0EueSxcbiAgICAgICAgICAgIHRoaXMubV92Mi53Qi54LFxuICAgICAgICAgICAgdGhpcy5tX3YyLndCLnlcbiAgICAgICAgICBdLnRvU3RyaW5nKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5tX2NvdW50ID09PSAxKSB7XG4gICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFwiK1wiICsgdGhpcy5tX2NvdW50LFxuICAgICAgICAgICAgdGhpcy5tX3YxLmEsXG4gICAgICAgICAgICB0aGlzLm1fdjEud0EueCxcbiAgICAgICAgICAgIHRoaXMubV92MS53QS55LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndCLngsXG4gICAgICAgICAgICB0aGlzLm1fdjEud0IueVxuICAgICAgICAgIF0udG9TdHJpbmcoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gXCIrXCIgKyB0aGlzLm1fY291bnQ7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUucmVhZENhY2hlID0gZnVuY3Rpb24oY2FjaGUyLCBwcm94eUEsIHRyYW5zZm9ybUEsIHByb3h5QiwgdHJhbnNmb3JtQikge1xuICAgICAgICB0aGlzLm1fY291bnQgPSBjYWNoZTIuY291bnQ7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgdjMgPSB0aGlzLm1fdltpXTtcbiAgICAgICAgICB2My5pbmRleEEgPSBjYWNoZTIuaW5kZXhBW2ldO1xuICAgICAgICAgIHYzLmluZGV4QiA9IGNhY2hlMi5pbmRleEJbaV07XG4gICAgICAgICAgdmFyIHdBTG9jYWwgPSBwcm94eUEuZ2V0VmVydGV4KHYzLmluZGV4QSk7XG4gICAgICAgICAgdmFyIHdCTG9jYWwgPSBwcm94eUIuZ2V0VmVydGV4KHYzLmluZGV4Qik7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMih2My53QSwgdHJhbnNmb3JtQSwgd0FMb2NhbCk7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMih2My53QiwgdHJhbnNmb3JtQiwgd0JMb2NhbCk7XG4gICAgICAgICAgc3ViVmVjMih2My53LCB2My53QiwgdjMud0EpO1xuICAgICAgICAgIHYzLmEgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fY291bnQgPiAxKSB7XG4gICAgICAgICAgdmFyIG1ldHJpYzEgPSBjYWNoZTIubWV0cmljO1xuICAgICAgICAgIHZhciBtZXRyaWMyID0gdGhpcy5nZXRNZXRyaWMoKTtcbiAgICAgICAgICBpZiAobWV0cmljMiA8IDAuNSAqIG1ldHJpYzEgfHwgMiAqIG1ldHJpYzEgPCBtZXRyaWMyIHx8IG1ldHJpYzIgPCBFUFNJTE9OKSB7XG4gICAgICAgICAgICB0aGlzLm1fY291bnQgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2NvdW50ID09PSAwKSB7XG4gICAgICAgICAgdmFyIHYzID0gdGhpcy5tX3ZbMF07XG4gICAgICAgICAgdjMuaW5kZXhBID0gMDtcbiAgICAgICAgICB2My5pbmRleEIgPSAwO1xuICAgICAgICAgIHZhciB3QUxvY2FsID0gcHJveHlBLmdldFZlcnRleCgwKTtcbiAgICAgICAgICB2YXIgd0JMb2NhbCA9IHByb3h5Qi5nZXRWZXJ0ZXgoMCk7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMih2My53QSwgdHJhbnNmb3JtQSwgd0FMb2NhbCk7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMih2My53QiwgdHJhbnNmb3JtQiwgd0JMb2NhbCk7XG4gICAgICAgICAgc3ViVmVjMih2My53LCB2My53QiwgdjMud0EpO1xuICAgICAgICAgIHYzLmEgPSAxO1xuICAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUud3JpdGVDYWNoZSA9IGZ1bmN0aW9uKGNhY2hlMikge1xuICAgICAgICBjYWNoZTIubWV0cmljID0gdGhpcy5nZXRNZXRyaWMoKTtcbiAgICAgICAgY2FjaGUyLmNvdW50ID0gdGhpcy5tX2NvdW50O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgY2FjaGUyLmluZGV4QVtpXSA9IHRoaXMubV92W2ldLmluZGV4QTtcbiAgICAgICAgICBjYWNoZTIuaW5kZXhCW2ldID0gdGhpcy5tX3ZbaV0uaW5kZXhCO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLmdldFNlYXJjaERpcmVjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdjEzID0gdGhpcy5tX3YxO1xuICAgICAgICB2YXIgdjIyID0gdGhpcy5tX3YyO1xuICAgICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHJldHVybiBzZXRWZWMyKHNlYXJjaERpcmVjdGlvbl9yZXVzZSwgLXYxMy53LngsIC12MTMudy55KTtcbiAgICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICAgIHN1YlZlYzIoZTEyLCB2MjIudywgdjEzLncpO1xuICAgICAgICAgICAgdmFyIHNnbiA9IC1jcm9zc1ZlYzJWZWMyKGUxMiwgdjEzLncpO1xuICAgICAgICAgICAgaWYgKHNnbiA+IDApIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHNldFZlYzIoc2VhcmNoRGlyZWN0aW9uX3JldXNlLCAtZTEyLnksIGUxMi54KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBzZXRWZWMyKHNlYXJjaERpcmVjdGlvbl9yZXVzZSwgZTEyLnksIC1lMTIueCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gemVyb1ZlYzIoc2VhcmNoRGlyZWN0aW9uX3JldXNlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5nZXRDbG9zZXN0UG9pbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHYxMyA9IHRoaXMubV92MTtcbiAgICAgICAgdmFyIHYyMiA9IHRoaXMubV92MjtcbiAgICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICByZXR1cm4gemVyb1ZlYzIoY2xvc2VzdFBvaW50X3JldXNlKTtcbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gY29weVZlYzIoY2xvc2VzdFBvaW50X3JldXNlLCB2MTMudyk7XG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmV0dXJuIGNvbWJpbmUyVmVjMihjbG9zZXN0UG9pbnRfcmV1c2UsIHYxMy5hLCB2MTMudywgdjIyLmEsIHYyMi53KTtcbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gemVyb1ZlYzIoY2xvc2VzdFBvaW50X3JldXNlKTtcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHplcm9WZWMyKGNsb3Nlc3RQb2ludF9yZXVzZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUuZ2V0V2l0bmVzc1BvaW50cyA9IGZ1bmN0aW9uKHBBMiwgcEIyKSB7XG4gICAgICAgIHZhciB2MTMgPSB0aGlzLm1fdjE7XG4gICAgICAgIHZhciB2MjIgPSB0aGlzLm1fdjI7XG4gICAgICAgIHZhciB2MyA9IHRoaXMubV92MztcbiAgICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBjb3B5VmVjMihwQTIsIHYxMy53QSk7XG4gICAgICAgICAgICBjb3B5VmVjMihwQjIsIHYxMy53Qik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBjb21iaW5lMlZlYzIocEEyLCB2MTMuYSwgdjEzLndBLCB2MjIuYSwgdjIyLndBKTtcbiAgICAgICAgICAgIGNvbWJpbmUyVmVjMihwQjIsIHYxMy5hLCB2MTMud0IsIHYyMi5hLCB2MjIud0IpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgY29tYmluZTNWZWMyKHBBMiwgdjEzLmEsIHYxMy53QSwgdjIyLmEsIHYyMi53QSwgdjMuYSwgdjMud0EpO1xuICAgICAgICAgICAgY29weVZlYzIocEIyLCBwQTIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUuZ2V0TWV0cmljID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5tX2NvdW50KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmV0dXJuIGRpc3RWZWMyKHRoaXMubV92MS53LCB0aGlzLm1fdjIudyk7XG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIGNyb3NzVmVjMlZlYzIoc3ViVmVjMih0ZW1wMSwgdGhpcy5tX3YyLncsIHRoaXMubV92MS53KSwgc3ViVmVjMih0ZW1wMiwgdGhpcy5tX3YzLncsIHRoaXMubV92MS53KSk7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLnNvbHZlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5tX2NvdW50KSB7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgdGhpcy5zb2x2ZTIoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHRoaXMuc29sdmUzKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5zb2x2ZTIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHcxID0gdGhpcy5tX3YxLnc7XG4gICAgICAgIHZhciB3MiA9IHRoaXMubV92Mi53O1xuICAgICAgICBzdWJWZWMyKGUxMiwgdzIsIHcxKTtcbiAgICAgICAgdmFyIGQxMl8yID0gLWRvdFZlYzIodzEsIGUxMik7XG4gICAgICAgIGlmIChkMTJfMiA8PSAwKSB7XG4gICAgICAgICAgdGhpcy5tX3YxLmEgPSAxO1xuICAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkMTJfMSA9IGRvdFZlYzIodzIsIGUxMik7XG4gICAgICAgIGlmIChkMTJfMSA8PSAwKSB7XG4gICAgICAgICAgdGhpcy5tX3YyLmEgPSAxO1xuICAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XG4gICAgICAgICAgdGhpcy5tX3YxLnNldCh0aGlzLm1fdjIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW52X2QxMiA9IDEgLyAoZDEyXzEgKyBkMTJfMik7XG4gICAgICAgIHRoaXMubV92MS5hID0gZDEyXzEgKiBpbnZfZDEyO1xuICAgICAgICB0aGlzLm1fdjIuYSA9IGQxMl8yICogaW52X2QxMjtcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gMjtcbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUuc29sdmUzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB3MSA9IHRoaXMubV92MS53O1xuICAgICAgICB2YXIgdzIgPSB0aGlzLm1fdjIudztcbiAgICAgICAgdmFyIHczID0gdGhpcy5tX3YzLnc7XG4gICAgICAgIHN1YlZlYzIoZTEyLCB3MiwgdzEpO1xuICAgICAgICB2YXIgdzFlMTIgPSBkb3RWZWMyKHcxLCBlMTIpO1xuICAgICAgICB2YXIgdzJlMTIgPSBkb3RWZWMyKHcyLCBlMTIpO1xuICAgICAgICB2YXIgZDEyXzEgPSB3MmUxMjtcbiAgICAgICAgdmFyIGQxMl8yID0gLXcxZTEyO1xuICAgICAgICBzdWJWZWMyKGUxMywgdzMsIHcxKTtcbiAgICAgICAgdmFyIHcxZTEzID0gZG90VmVjMih3MSwgZTEzKTtcbiAgICAgICAgdmFyIHczZTEzID0gZG90VmVjMih3MywgZTEzKTtcbiAgICAgICAgdmFyIGQxM18xID0gdzNlMTM7XG4gICAgICAgIHZhciBkMTNfMiA9IC13MWUxMztcbiAgICAgICAgc3ViVmVjMihlMjMsIHczLCB3Mik7XG4gICAgICAgIHZhciB3MmUyMyA9IGRvdFZlYzIodzIsIGUyMyk7XG4gICAgICAgIHZhciB3M2UyMyA9IGRvdFZlYzIodzMsIGUyMyk7XG4gICAgICAgIHZhciBkMjNfMSA9IHczZTIzO1xuICAgICAgICB2YXIgZDIzXzIgPSAtdzJlMjM7XG4gICAgICAgIHZhciBuMTIzID0gY3Jvc3NWZWMyVmVjMihlMTIsIGUxMyk7XG4gICAgICAgIHZhciBkMTIzXzEgPSBuMTIzICogY3Jvc3NWZWMyVmVjMih3MiwgdzMpO1xuICAgICAgICB2YXIgZDEyM18yID0gbjEyMyAqIGNyb3NzVmVjMlZlYzIodzMsIHcxKTtcbiAgICAgICAgdmFyIGQxMjNfMyA9IG4xMjMgKiBjcm9zc1ZlYzJWZWMyKHcxLCB3Mik7XG4gICAgICAgIGlmIChkMTJfMiA8PSAwICYmIGQxM18yIDw9IDApIHtcbiAgICAgICAgICB0aGlzLm1fdjEuYSA9IDE7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQxMl8xID4gMCAmJiBkMTJfMiA+IDAgJiYgZDEyM18zIDw9IDApIHtcbiAgICAgICAgICB2YXIgaW52X2QxMiA9IDEgLyAoZDEyXzEgKyBkMTJfMik7XG4gICAgICAgICAgdGhpcy5tX3YxLmEgPSBkMTJfMSAqIGludl9kMTI7XG4gICAgICAgICAgdGhpcy5tX3YyLmEgPSBkMTJfMiAqIGludl9kMTI7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMjtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQxM18xID4gMCAmJiBkMTNfMiA+IDAgJiYgZDEyM18yIDw9IDApIHtcbiAgICAgICAgICB2YXIgaW52X2QxMyA9IDEgLyAoZDEzXzEgKyBkMTNfMik7XG4gICAgICAgICAgdGhpcy5tX3YxLmEgPSBkMTNfMSAqIGludl9kMTM7XG4gICAgICAgICAgdGhpcy5tX3YzLmEgPSBkMTNfMiAqIGludl9kMTM7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMjtcbiAgICAgICAgICB0aGlzLm1fdjIuc2V0KHRoaXMubV92Myk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkMTJfMSA8PSAwICYmIGQyM18yIDw9IDApIHtcbiAgICAgICAgICB0aGlzLm1fdjIuYSA9IDE7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgICB0aGlzLm1fdjEuc2V0KHRoaXMubV92Mik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkMTNfMSA8PSAwICYmIGQyM18xIDw9IDApIHtcbiAgICAgICAgICB0aGlzLm1fdjMuYSA9IDE7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgICB0aGlzLm1fdjEuc2V0KHRoaXMubV92Myk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkMjNfMSA+IDAgJiYgZDIzXzIgPiAwICYmIGQxMjNfMSA8PSAwKSB7XG4gICAgICAgICAgdmFyIGludl9kMjMgPSAxIC8gKGQyM18xICsgZDIzXzIpO1xuICAgICAgICAgIHRoaXMubV92Mi5hID0gZDIzXzEgKiBpbnZfZDIzO1xuICAgICAgICAgIHRoaXMubV92My5hID0gZDIzXzIgKiBpbnZfZDIzO1xuICAgICAgICAgIHRoaXMubV9jb3VudCA9IDI7XG4gICAgICAgICAgdGhpcy5tX3YxLnNldCh0aGlzLm1fdjMpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW52X2QxMjMgPSAxIC8gKGQxMjNfMSArIGQxMjNfMiArIGQxMjNfMyk7XG4gICAgICAgIHRoaXMubV92MS5hID0gZDEyM18xICogaW52X2QxMjM7XG4gICAgICAgIHRoaXMubV92Mi5hID0gZDEyM18yICogaW52X2QxMjM7XG4gICAgICAgIHRoaXMubV92My5hID0gZDEyM18zICogaW52X2QxMjM7XG4gICAgICAgIHRoaXMubV9jb3VudCA9IDM7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFNpbXBsZXgyO1xuICAgIH0oKVxuICApO1xuICB2YXIgc2ltcGxleCA9IG5ldyBTaW1wbGV4KCk7XG4gIHZhciBpbnB1dCQxID0gbmV3IERpc3RhbmNlSW5wdXQoKTtcbiAgdmFyIGNhY2hlJDEgPSBuZXcgU2ltcGxleENhY2hlKCk7XG4gIHZhciBvdXRwdXQkMSA9IG5ldyBEaXN0YW5jZU91dHB1dCgpO1xuICB2YXIgdGVzdE92ZXJsYXAgPSBmdW5jdGlvbihzaGFwZUEsIGluZGV4QSwgc2hhcGVCLCBpbmRleEIsIHhmQTIsIHhmQjIpIHtcbiAgICBpbnB1dCQxLnJlY3ljbGUoKTtcbiAgICBpbnB1dCQxLnByb3h5QS5zZXQoc2hhcGVBLCBpbmRleEEpO1xuICAgIGlucHV0JDEucHJveHlCLnNldChzaGFwZUIsIGluZGV4Qik7XG4gICAgY29weVRyYW5zZm9ybShpbnB1dCQxLnRyYW5zZm9ybUEsIHhmQTIpO1xuICAgIGNvcHlUcmFuc2Zvcm0oaW5wdXQkMS50cmFuc2Zvcm1CLCB4ZkIyKTtcbiAgICBpbnB1dCQxLnVzZVJhZGlpID0gdHJ1ZTtcbiAgICBvdXRwdXQkMS5yZWN5Y2xlKCk7XG4gICAgY2FjaGUkMS5yZWN5Y2xlKCk7XG4gICAgRGlzdGFuY2Uob3V0cHV0JDEsIGNhY2hlJDEsIGlucHV0JDEpO1xuICAgIHJldHVybiBvdXRwdXQkMS5kaXN0YW5jZSA8IDEwICogRVBTSUxPTjtcbiAgfTtcbiAgRGlzdGFuY2UudGVzdE92ZXJsYXAgPSB0ZXN0T3ZlcmxhcDtcbiAgRGlzdGFuY2UuSW5wdXQgPSBEaXN0YW5jZUlucHV0O1xuICBEaXN0YW5jZS5PdXRwdXQgPSBEaXN0YW5jZU91dHB1dDtcbiAgRGlzdGFuY2UuUHJveHkgPSBEaXN0YW5jZVByb3h5O1xuICBEaXN0YW5jZS5DYWNoZSA9IFNpbXBsZXhDYWNoZTtcbiAgdmFyIFNoYXBlQ2FzdElucHV0ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNoYXBlQ2FzdElucHV0MigpIHtcbiAgICAgICAgdGhpcy5wcm94eUEgPSBuZXcgRGlzdGFuY2VQcm94eSgpO1xuICAgICAgICB0aGlzLnByb3h5QiA9IG5ldyBEaXN0YW5jZVByb3h5KCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtQSA9IFRyYW5zZm9ybS5pZGVudGl0eSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUIgPSBUcmFuc2Zvcm0uaWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2xhdGlvbkIgPSBWZWMyLnplcm8oKTtcbiAgICAgIH1cbiAgICAgIFNoYXBlQ2FzdElucHV0Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnByb3h5QS5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMucHJveHlCLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1BLnNldElkZW50aXR5KCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtQi5zZXRJZGVudGl0eSgpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnRyYW5zbGF0aW9uQik7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFNoYXBlQ2FzdElucHV0MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFNoYXBlQ2FzdE91dHB1dCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2hhcGVDYXN0T3V0cHV0MigpIHtcbiAgICAgICAgdGhpcy5wb2ludCA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLm5vcm1hbCA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLmxhbWJkYSA9IDE7XG4gICAgICAgIHRoaXMuaXRlcmF0aW9ucyA9IDA7XG4gICAgICB9XG4gICAgICByZXR1cm4gU2hhcGVDYXN0T3V0cHV0MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFNoYXBlQ2FzdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0Mikge1xuICAgIG91dHB1dDIuaXRlcmF0aW9ucyA9IDA7XG4gICAgb3V0cHV0Mi5sYW1iZGEgPSAxO1xuICAgIG91dHB1dDIubm9ybWFsLnNldFplcm8oKTtcbiAgICBvdXRwdXQyLnBvaW50LnNldFplcm8oKTtcbiAgICB2YXIgcHJveHlBID0gaW5wdXQyLnByb3h5QTtcbiAgICB2YXIgcHJveHlCID0gaW5wdXQyLnByb3h5QjtcbiAgICB2YXIgcmFkaXVzQSA9IG1hdGhfbWF4JDQocHJveHlBLm1fcmFkaXVzLCBTZXR0aW5nc0ludGVybmFsLnBvbHlnb25SYWRpdXMpO1xuICAgIHZhciByYWRpdXNCID0gbWF0aF9tYXgkNChwcm94eUIubV9yYWRpdXMsIFNldHRpbmdzSW50ZXJuYWwucG9seWdvblJhZGl1cyk7XG4gICAgdmFyIHJhZGl1cyA9IHJhZGl1c0EgKyByYWRpdXNCO1xuICAgIHZhciB4ZkEyID0gaW5wdXQyLnRyYW5zZm9ybUE7XG4gICAgdmFyIHhmQjIgPSBpbnB1dDIudHJhbnNmb3JtQjtcbiAgICB2YXIgciA9IGlucHV0Mi50cmFuc2xhdGlvbkI7XG4gICAgdmFyIG4yID0gVmVjMi56ZXJvKCk7XG4gICAgdmFyIGxhbWJkYSA9IDA7XG4gICAgdmFyIHNpbXBsZXgyID0gbmV3IFNpbXBsZXgoKTtcbiAgICBzaW1wbGV4Mi5tX2NvdW50ID0gMDtcbiAgICB2YXIgdmVydGljZXMgPSBzaW1wbGV4Mi5tX3Y7XG4gICAgdmFyIGluZGV4QSA9IHByb3h5QS5nZXRTdXBwb3J0KFJvdC5tdWxUVmVjMih4ZkEyLnEsIFZlYzIubmVnKHIpKSk7XG4gICAgdmFyIHdBID0gVHJhbnNmb3JtLm11bFZlYzIoeGZBMiwgcHJveHlBLmdldFZlcnRleChpbmRleEEpKTtcbiAgICB2YXIgaW5kZXhCID0gcHJveHlCLmdldFN1cHBvcnQoUm90Lm11bFRWZWMyKHhmQjIucSwgcikpO1xuICAgIHZhciB3QiA9IFRyYW5zZm9ybS5tdWxWZWMyKHhmQjIsIHByb3h5Qi5nZXRWZXJ0ZXgoaW5kZXhCKSk7XG4gICAgdmFyIHYzID0gVmVjMi5zdWIod0EsIHdCKTtcbiAgICB2YXIgc2lnbWEgPSBtYXRoX21heCQ0KFNldHRpbmdzSW50ZXJuYWwucG9seWdvblJhZGl1cywgcmFkaXVzIC0gU2V0dGluZ3NJbnRlcm5hbC5wb2x5Z29uUmFkaXVzKTtcbiAgICB2YXIgdG9sZXJhbmNlID0gMC41ICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgIHZhciBrX21heEl0ZXJzID0gMjA7XG4gICAgdmFyIGl0ZXIgPSAwO1xuICAgIHdoaWxlIChpdGVyIDwga19tYXhJdGVycyAmJiB2My5sZW5ndGgoKSAtIHNpZ21hID4gdG9sZXJhbmNlKSB7XG4gICAgICBvdXRwdXQyLml0ZXJhdGlvbnMgKz0gMTtcbiAgICAgIGluZGV4QSA9IHByb3h5QS5nZXRTdXBwb3J0KFJvdC5tdWxUVmVjMih4ZkEyLnEsIFZlYzIubmVnKHYzKSkpO1xuICAgICAgd0EgPSBUcmFuc2Zvcm0ubXVsVmVjMih4ZkEyLCBwcm94eUEuZ2V0VmVydGV4KGluZGV4QSkpO1xuICAgICAgaW5kZXhCID0gcHJveHlCLmdldFN1cHBvcnQoUm90Lm11bFRWZWMyKHhmQjIucSwgdjMpKTtcbiAgICAgIHdCID0gVHJhbnNmb3JtLm11bFZlYzIoeGZCMiwgcHJveHlCLmdldFZlcnRleChpbmRleEIpKTtcbiAgICAgIHZhciBwID0gVmVjMi5zdWIod0EsIHdCKTtcbiAgICAgIHYzLm5vcm1hbGl6ZSgpO1xuICAgICAgdmFyIHZwID0gVmVjMi5kb3QodjMsIHApO1xuICAgICAgdmFyIHZyID0gVmVjMi5kb3QodjMsIHIpO1xuICAgICAgaWYgKHZwIC0gc2lnbWEgPiBsYW1iZGEgKiB2cikge1xuICAgICAgICBpZiAodnIgPD0gMCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBsYW1iZGEgPSAodnAgLSBzaWdtYSkgLyB2cjtcbiAgICAgICAgaWYgKGxhbWJkYSA+IDEpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgbjIuc2V0TXVsKC0xLCB2Myk7XG4gICAgICAgIHNpbXBsZXgyLm1fY291bnQgPSAwO1xuICAgICAgfVxuICAgICAgdmFyIHZlcnRleCA9IHZlcnRpY2VzW3NpbXBsZXgyLm1fY291bnRdO1xuICAgICAgdmVydGV4LmluZGV4QSA9IGluZGV4QjtcbiAgICAgIHZlcnRleC53QSA9IFZlYzIuY29tYmluZSgxLCB3QiwgbGFtYmRhLCByKTtcbiAgICAgIHZlcnRleC5pbmRleEIgPSBpbmRleEE7XG4gICAgICB2ZXJ0ZXgud0IgPSB3QTtcbiAgICAgIHZlcnRleC53ID0gVmVjMi5zdWIodmVydGV4LndCLCB2ZXJ0ZXgud0EpO1xuICAgICAgdmVydGV4LmEgPSAxO1xuICAgICAgc2ltcGxleDIubV9jb3VudCArPSAxO1xuICAgICAgc3dpdGNoIChzaW1wbGV4Mi5tX2NvdW50KSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHNpbXBsZXgyLnNvbHZlMigpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgc2ltcGxleDIuc29sdmUzKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAoc2ltcGxleDIubV9jb3VudCA9PSAzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHYzLnNldFZlYzIoc2ltcGxleDIuZ2V0Q2xvc2VzdFBvaW50KCkpO1xuICAgICAgKytpdGVyO1xuICAgIH1cbiAgICBpZiAoaXRlciA9PSAwKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBwb2ludEEyID0gVmVjMi56ZXJvKCk7XG4gICAgdmFyIHBvaW50QjIgPSBWZWMyLnplcm8oKTtcbiAgICBzaW1wbGV4Mi5nZXRXaXRuZXNzUG9pbnRzKHBvaW50QjIsIHBvaW50QTIpO1xuICAgIGlmICh2My5sZW5ndGhTcXVhcmVkKCkgPiAwKSB7XG4gICAgICBuMi5zZXRNdWwoLTEsIHYzKTtcbiAgICAgIG4yLm5vcm1hbGl6ZSgpO1xuICAgIH1cbiAgICBvdXRwdXQyLnBvaW50ID0gVmVjMi5jb21iaW5lKDEsIHBvaW50QTIsIHJhZGl1c0EsIG4yKTtcbiAgICBvdXRwdXQyLm5vcm1hbCA9IG4yO1xuICAgIG91dHB1dDIubGFtYmRhID0gbGFtYmRhO1xuICAgIG91dHB1dDIuaXRlcmF0aW9ucyA9IGl0ZXI7XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG4gIHZhciBtYXRoX2FicyQ3ID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX21heCQzID0gTWF0aC5tYXg7XG4gIHZhciBUT0lJbnB1dCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBUT0lJbnB1dDIoKSB7XG4gICAgICAgIHRoaXMucHJveHlBID0gbmV3IERpc3RhbmNlUHJveHkoKTtcbiAgICAgICAgdGhpcy5wcm94eUIgPSBuZXcgRGlzdGFuY2VQcm94eSgpO1xuICAgICAgICB0aGlzLnN3ZWVwQSA9IG5ldyBTd2VlcCgpO1xuICAgICAgICB0aGlzLnN3ZWVwQiA9IG5ldyBTd2VlcCgpO1xuICAgICAgfVxuICAgICAgVE9JSW5wdXQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucHJveHlBLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5wcm94eUIucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnN3ZWVwQS5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMuc3dlZXBCLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy50TWF4ID0gLTE7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFRPSUlucHV0MjtcbiAgICB9KClcbiAgKTtcbiAgZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUgPSB2b2lkIDA7XG4gIChmdW5jdGlvbihUT0lPdXRwdXRTdGF0ZTIpIHtcbiAgICBUT0lPdXRwdXRTdGF0ZTJbVE9JT3V0cHV0U3RhdGUyW1wiZV91bnNldFwiXSA9IC0xXSA9IFwiZV91bnNldFwiO1xuICAgIFRPSU91dHB1dFN0YXRlMltUT0lPdXRwdXRTdGF0ZTJbXCJlX3Vua25vd25cIl0gPSAwXSA9IFwiZV91bmtub3duXCI7XG4gICAgVE9JT3V0cHV0U3RhdGUyW1RPSU91dHB1dFN0YXRlMltcImVfZmFpbGVkXCJdID0gMV0gPSBcImVfZmFpbGVkXCI7XG4gICAgVE9JT3V0cHV0U3RhdGUyW1RPSU91dHB1dFN0YXRlMltcImVfb3ZlcmxhcHBlZFwiXSA9IDJdID0gXCJlX292ZXJsYXBwZWRcIjtcbiAgICBUT0lPdXRwdXRTdGF0ZTJbVE9JT3V0cHV0U3RhdGUyW1wiZV90b3VjaGluZ1wiXSA9IDNdID0gXCJlX3RvdWNoaW5nXCI7XG4gICAgVE9JT3V0cHV0U3RhdGUyW1RPSU91dHB1dFN0YXRlMltcImVfc2VwYXJhdGVkXCJdID0gNF0gPSBcImVfc2VwYXJhdGVkXCI7XG4gIH0pKGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlIHx8IChleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZSA9IHt9KSk7XG4gIHZhciBUT0lPdXRwdXQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVE9JT3V0cHV0MigpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfdW5zZXQ7XG4gICAgICAgIHRoaXMudCA9IC0xO1xuICAgICAgfVxuICAgICAgVE9JT3V0cHV0Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV91bnNldDtcbiAgICAgICAgdGhpcy50ID0gLTE7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFRPSU91dHB1dDI7XG4gICAgfSgpXG4gICk7XG4gIHN0YXRzLnRvaVRpbWUgPSAwO1xuICBzdGF0cy50b2lNYXhUaW1lID0gMDtcbiAgc3RhdHMudG9pQ2FsbHMgPSAwO1xuICBzdGF0cy50b2lJdGVycyA9IDA7XG4gIHN0YXRzLnRvaU1heEl0ZXJzID0gMDtcbiAgc3RhdHMudG9pUm9vdEl0ZXJzID0gMDtcbiAgc3RhdHMudG9pTWF4Um9vdEl0ZXJzID0gMDtcbiAgdmFyIGRpc3RhbmNlSW5wdXQgPSBuZXcgRGlzdGFuY2VJbnB1dCgpO1xuICB2YXIgZGlzdGFuY2VPdXRwdXQgPSBuZXcgRGlzdGFuY2VPdXRwdXQoKTtcbiAgdmFyIGNhY2hlID0gbmV3IFNpbXBsZXhDYWNoZSgpO1xuICB2YXIgeGZBJDEgPSB0cmFuc2Zvcm0oMCwgMCwgMCk7XG4gIHZhciB4ZkIkMSA9IHRyYW5zZm9ybSgwLCAwLCAwKTtcbiAgdmFyIHRlbXAkNCA9IHZlYzIoMCwgMCk7XG4gIHZhciBwb2ludEEkMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBwb2ludEIkMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBub3JtYWwkMyA9IHZlYzIoMCwgMCk7XG4gIHZhciBheGlzQSA9IHZlYzIoMCwgMCk7XG4gIHZhciBheGlzQiA9IHZlYzIoMCwgMCk7XG4gIHZhciBsb2NhbFBvaW50QSA9IHZlYzIoMCwgMCk7XG4gIHZhciBsb2NhbFBvaW50QiA9IHZlYzIoMCwgMCk7XG4gIHZhciBUaW1lT2ZJbXBhY3QgPSBmdW5jdGlvbihvdXRwdXQyLCBpbnB1dDIpIHtcbiAgICB2YXIgdGltZXIgPSBUaW1lci5ub3coKTtcbiAgICArK3N0YXRzLnRvaUNhbGxzO1xuICAgIG91dHB1dDIuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX3Vua25vd247XG4gICAgb3V0cHV0Mi50ID0gaW5wdXQyLnRNYXg7XG4gICAgdmFyIHByb3h5QSA9IGlucHV0Mi5wcm94eUE7XG4gICAgdmFyIHByb3h5QiA9IGlucHV0Mi5wcm94eUI7XG4gICAgdmFyIHN3ZWVwQSA9IGlucHV0Mi5zd2VlcEE7XG4gICAgdmFyIHN3ZWVwQiA9IGlucHV0Mi5zd2VlcEI7XG4gICAgc3dlZXBBLm5vcm1hbGl6ZSgpO1xuICAgIHN3ZWVwQi5ub3JtYWxpemUoKTtcbiAgICB2YXIgdE1heCA9IGlucHV0Mi50TWF4O1xuICAgIHZhciB0b3RhbFJhZGl1cyA9IHByb3h5QS5tX3JhZGl1cyArIHByb3h5Qi5tX3JhZGl1cztcbiAgICB2YXIgdGFyZ2V0ID0gbWF0aF9tYXgkMyhTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3AsIHRvdGFsUmFkaXVzIC0gMyAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCk7XG4gICAgdmFyIHRvbGVyYW5jZSA9IDAuMjUgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgdmFyIHQxID0gMDtcbiAgICB2YXIga19tYXhJdGVyYXRpb25zID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhUT0lJdGVyYXRpb25zO1xuICAgIHZhciBpdGVyID0gMDtcbiAgICBjYWNoZS5yZWN5Y2xlKCk7XG4gICAgZGlzdGFuY2VJbnB1dC5wcm94eUEuc2V0VmVydGljZXMocHJveHlBLm1fdmVydGljZXMsIHByb3h5QS5tX2NvdW50LCBwcm94eUEubV9yYWRpdXMpO1xuICAgIGRpc3RhbmNlSW5wdXQucHJveHlCLnNldFZlcnRpY2VzKHByb3h5Qi5tX3ZlcnRpY2VzLCBwcm94eUIubV9jb3VudCwgcHJveHlCLm1fcmFkaXVzKTtcbiAgICBkaXN0YW5jZUlucHV0LnVzZVJhZGlpID0gZmFsc2U7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIHN3ZWVwQS5nZXRUcmFuc2Zvcm0oeGZBJDEsIHQxKTtcbiAgICAgIHN3ZWVwQi5nZXRUcmFuc2Zvcm0oeGZCJDEsIHQxKTtcbiAgICAgIGNvcHlUcmFuc2Zvcm0oZGlzdGFuY2VJbnB1dC50cmFuc2Zvcm1BLCB4ZkEkMSk7XG4gICAgICBjb3B5VHJhbnNmb3JtKGRpc3RhbmNlSW5wdXQudHJhbnNmb3JtQiwgeGZCJDEpO1xuICAgICAgRGlzdGFuY2UoZGlzdGFuY2VPdXRwdXQsIGNhY2hlLCBkaXN0YW5jZUlucHV0KTtcbiAgICAgIGlmIChkaXN0YW5jZU91dHB1dC5kaXN0YW5jZSA8PSAwKSB7XG4gICAgICAgIG91dHB1dDIuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX292ZXJsYXBwZWQ7XG4gICAgICAgIG91dHB1dDIudCA9IDA7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKGRpc3RhbmNlT3V0cHV0LmRpc3RhbmNlIDwgdGFyZ2V0ICsgdG9sZXJhbmNlKSB7XG4gICAgICAgIG91dHB1dDIuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX3RvdWNoaW5nO1xuICAgICAgICBvdXRwdXQyLnQgPSB0MTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBzZXBhcmF0aW9uRnVuY3Rpb24uaW5pdGlhbGl6ZShjYWNoZSwgcHJveHlBLCBzd2VlcEEsIHByb3h5Qiwgc3dlZXBCLCB0MSk7XG4gICAgICB2YXIgZG9uZSA9IGZhbHNlO1xuICAgICAgdmFyIHQyID0gdE1heDtcbiAgICAgIHZhciBwdXNoQmFja0l0ZXIgPSAwO1xuICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIHMyID0gc2VwYXJhdGlvbkZ1bmN0aW9uLmZpbmRNaW5TZXBhcmF0aW9uKHQyKTtcbiAgICAgICAgaWYgKHMyID4gdGFyZ2V0ICsgdG9sZXJhbmNlKSB7XG4gICAgICAgICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfc2VwYXJhdGVkO1xuICAgICAgICAgIG91dHB1dDIudCA9IHRNYXg7XG4gICAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHMyID4gdGFyZ2V0IC0gdG9sZXJhbmNlKSB7XG4gICAgICAgICAgdDEgPSB0MjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgczEgPSBzZXBhcmF0aW9uRnVuY3Rpb24uZXZhbHVhdGUodDEpO1xuICAgICAgICBpZiAoczEgPCB0YXJnZXQgLSB0b2xlcmFuY2UpIHtcbiAgICAgICAgICBvdXRwdXQyLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV9mYWlsZWQ7XG4gICAgICAgICAgb3V0cHV0Mi50ID0gdDE7XG4gICAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHMxIDw9IHRhcmdldCArIHRvbGVyYW5jZSkge1xuICAgICAgICAgIG91dHB1dDIuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX3RvdWNoaW5nO1xuICAgICAgICAgIG91dHB1dDIudCA9IHQxO1xuICAgICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHZhciByb290SXRlckNvdW50ID0gMDtcbiAgICAgICAgdmFyIGExID0gdDE7XG4gICAgICAgIHZhciBhMiA9IHQyO1xuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgIHZhciB0ID0gdm9pZCAwO1xuICAgICAgICAgIGlmIChyb290SXRlckNvdW50ICYgMSkge1xuICAgICAgICAgICAgdCA9IGExICsgKHRhcmdldCAtIHMxKSAqIChhMiAtIGExKSAvIChzMiAtIHMxKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdCA9IDAuNSAqIChhMSArIGEyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgKytyb290SXRlckNvdW50O1xuICAgICAgICAgICsrc3RhdHMudG9pUm9vdEl0ZXJzO1xuICAgICAgICAgIHZhciBzMyA9IHNlcGFyYXRpb25GdW5jdGlvbi5ldmFsdWF0ZSh0KTtcbiAgICAgICAgICBpZiAobWF0aF9hYnMkNyhzMyAtIHRhcmdldCkgPCB0b2xlcmFuY2UpIHtcbiAgICAgICAgICAgIHQyID0gdDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoczMgPiB0YXJnZXQpIHtcbiAgICAgICAgICAgIGExID0gdDtcbiAgICAgICAgICAgIHMxID0gczM7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGEyID0gdDtcbiAgICAgICAgICAgIHMyID0gczM7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChyb290SXRlckNvdW50ID09PSA1MCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN0YXRzLnRvaU1heFJvb3RJdGVycyA9IG1hdGhfbWF4JDMoc3RhdHMudG9pTWF4Um9vdEl0ZXJzLCByb290SXRlckNvdW50KTtcbiAgICAgICAgKytwdXNoQmFja0l0ZXI7XG4gICAgICAgIGlmIChwdXNoQmFja0l0ZXIgPT09IFNldHRpbmdzSW50ZXJuYWwubWF4UG9seWdvblZlcnRpY2VzKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgICsraXRlcjtcbiAgICAgICsrc3RhdHMudG9pSXRlcnM7XG4gICAgICBpZiAoZG9uZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmIChpdGVyID09PSBrX21heEl0ZXJhdGlvbnMpIHtcbiAgICAgICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfZmFpbGVkO1xuICAgICAgICBvdXRwdXQyLnQgPSB0MTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHN0YXRzLnRvaU1heEl0ZXJzID0gbWF0aF9tYXgkMyhzdGF0cy50b2lNYXhJdGVycywgaXRlcik7XG4gICAgdmFyIHRpbWUgPSBUaW1lci5kaWZmKHRpbWVyKTtcbiAgICBzdGF0cy50b2lNYXhUaW1lID0gbWF0aF9tYXgkMyhzdGF0cy50b2lNYXhUaW1lLCB0aW1lKTtcbiAgICBzdGF0cy50b2lUaW1lICs9IHRpbWU7XG4gICAgc2VwYXJhdGlvbkZ1bmN0aW9uLnJlY3ljbGUoKTtcbiAgfTtcbiAgdmFyIFNlcGFyYXRpb25GdW5jdGlvblR5cGU7XG4gIChmdW5jdGlvbihTZXBhcmF0aW9uRnVuY3Rpb25UeXBlMikge1xuICAgIFNlcGFyYXRpb25GdW5jdGlvblR5cGUyW1NlcGFyYXRpb25GdW5jdGlvblR5cGUyW1wiZV91bnNldFwiXSA9IC0xXSA9IFwiZV91bnNldFwiO1xuICAgIFNlcGFyYXRpb25GdW5jdGlvblR5cGUyW1NlcGFyYXRpb25GdW5jdGlvblR5cGUyW1wiZV9wb2ludHNcIl0gPSAxXSA9IFwiZV9wb2ludHNcIjtcbiAgICBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlMltTZXBhcmF0aW9uRnVuY3Rpb25UeXBlMltcImVfZmFjZUFcIl0gPSAyXSA9IFwiZV9mYWNlQVwiO1xuICAgIFNlcGFyYXRpb25GdW5jdGlvblR5cGUyW1NlcGFyYXRpb25GdW5jdGlvblR5cGUyW1wiZV9mYWNlQlwiXSA9IDNdID0gXCJlX2ZhY2VCXCI7XG4gIH0pKFNlcGFyYXRpb25GdW5jdGlvblR5cGUgfHwgKFNlcGFyYXRpb25GdW5jdGlvblR5cGUgPSB7fSkpO1xuICB2YXIgU2VwYXJhdGlvbkZ1bmN0aW9uID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNlcGFyYXRpb25GdW5jdGlvbjIoKSB7XG4gICAgICAgIHRoaXMubV9wcm94eUEgPSBudWxsO1xuICAgICAgICB0aGlzLm1fcHJveHlCID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQSA9IG51bGw7XG4gICAgICAgIHRoaXMubV9zd2VlcEIgPSBudWxsO1xuICAgICAgICB0aGlzLm1fdHlwZSA9IFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV91bnNldDtcbiAgICAgICAgdGhpcy5tX2xvY2FsUG9pbnQgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLm1fYXhpcyA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gLTE7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gLTE7XG4gICAgICB9XG4gICAgICBTZXBhcmF0aW9uRnVuY3Rpb24yLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV9wcm94eUEgPSBudWxsO1xuICAgICAgICB0aGlzLm1fcHJveHlCID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQSA9IG51bGw7XG4gICAgICAgIHRoaXMubV9zd2VlcEIgPSBudWxsO1xuICAgICAgICB0aGlzLm1fdHlwZSA9IFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV91bnNldDtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5tX2xvY2FsUG9pbnQpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLm1fYXhpcyk7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gLTE7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gLTE7XG4gICAgICB9O1xuICAgICAgU2VwYXJhdGlvbkZ1bmN0aW9uMi5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKGNhY2hlMiwgcHJveHlBLCBzd2VlcEEsIHByb3h5Qiwgc3dlZXBCLCB0MSkge1xuICAgICAgICB2YXIgY291bnQgPSBjYWNoZTIuY291bnQ7XG4gICAgICAgIHRoaXMubV9wcm94eUEgPSBwcm94eUE7XG4gICAgICAgIHRoaXMubV9wcm94eUIgPSBwcm94eUI7XG4gICAgICAgIHRoaXMubV9zd2VlcEEgPSBzd2VlcEE7XG4gICAgICAgIHRoaXMubV9zd2VlcEIgPSBzd2VlcEI7XG4gICAgICAgIHRoaXMubV9zd2VlcEEuZ2V0VHJhbnNmb3JtKHhmQSQxLCB0MSk7XG4gICAgICAgIHRoaXMubV9zd2VlcEIuZ2V0VHJhbnNmb3JtKHhmQiQxLCB0MSk7XG4gICAgICAgIGlmIChjb3VudCA9PT0gMSkge1xuICAgICAgICAgIHRoaXMubV90eXBlID0gU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZS5lX3BvaW50cztcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEFfMSA9IHRoaXMubV9wcm94eUEuZ2V0VmVydGV4KGNhY2hlMi5pbmRleEFbMF0pO1xuICAgICAgICAgIHZhciBsb2NhbFBvaW50Ql8xID0gdGhpcy5tX3Byb3h5Qi5nZXRWZXJ0ZXgoY2FjaGUyLmluZGV4QlswXSk7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEEkMiwgeGZBJDEsIGxvY2FsUG9pbnRBXzEpO1xuICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRCJDIsIHhmQiQxLCBsb2NhbFBvaW50Ql8xKTtcbiAgICAgICAgICBzdWJWZWMyKHRoaXMubV9heGlzLCBwb2ludEIkMiwgcG9pbnRBJDIpO1xuICAgICAgICAgIHZhciBzMiA9IG5vcm1hbGl6ZVZlYzJMZW5ndGgodGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHJldHVybiBzMjtcbiAgICAgICAgfSBlbHNlIGlmIChjYWNoZTIuaW5kZXhBWzBdID09PSBjYWNoZTIuaW5kZXhBWzFdKSB7XG4gICAgICAgICAgdGhpcy5tX3R5cGUgPSBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlLmVfZmFjZUI7XG4gICAgICAgICAgdmFyIGxvY2FsUG9pbnRCMSA9IHByb3h5Qi5nZXRWZXJ0ZXgoY2FjaGUyLmluZGV4QlswXSk7XG4gICAgICAgICAgdmFyIGxvY2FsUG9pbnRCMiA9IHByb3h5Qi5nZXRWZXJ0ZXgoY2FjaGUyLmluZGV4QlsxXSk7XG4gICAgICAgICAgY3Jvc3NWZWMyTnVtKHRoaXMubV9heGlzLCBzdWJWZWMyKHRlbXAkNCwgbG9jYWxQb2ludEIyLCBsb2NhbFBvaW50QjEpLCAxKTtcbiAgICAgICAgICBub3JtYWxpemVWZWMyKHRoaXMubV9heGlzKTtcbiAgICAgICAgICByb3RWZWMyKG5vcm1hbCQzLCB4ZkIkMS5xLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgY29tYmluZTJWZWMyKHRoaXMubV9sb2NhbFBvaW50LCAwLjUsIGxvY2FsUG9pbnRCMSwgMC41LCBsb2NhbFBvaW50QjIpO1xuICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRCJDIsIHhmQiQxLCB0aGlzLm1fbG9jYWxQb2ludCk7XG4gICAgICAgICAgdmFyIGxvY2FsUG9pbnRBXzIgPSBwcm94eUEuZ2V0VmVydGV4KGNhY2hlMi5pbmRleEFbMF0pO1xuICAgICAgICAgIHZhciBwb2ludEFfMSA9IFRyYW5zZm9ybS5tdWxWZWMyKHhmQSQxLCBsb2NhbFBvaW50QV8yKTtcbiAgICAgICAgICB2YXIgczIgPSBkb3RWZWMyKHBvaW50QV8xLCBub3JtYWwkMykgLSBkb3RWZWMyKHBvaW50QiQyLCBub3JtYWwkMyk7XG4gICAgICAgICAgaWYgKHMyIDwgMCkge1xuICAgICAgICAgICAgbmVnVmVjMih0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgICBzMiA9IC1zMjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHMyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV90eXBlID0gU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZS5lX2ZhY2VBO1xuICAgICAgICAgIHZhciBsb2NhbFBvaW50QTEgPSB0aGlzLm1fcHJveHlBLmdldFZlcnRleChjYWNoZTIuaW5kZXhBWzBdKTtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEEyID0gdGhpcy5tX3Byb3h5QS5nZXRWZXJ0ZXgoY2FjaGUyLmluZGV4QVsxXSk7XG4gICAgICAgICAgY3Jvc3NWZWMyTnVtKHRoaXMubV9heGlzLCBzdWJWZWMyKHRlbXAkNCwgbG9jYWxQb2ludEEyLCBsb2NhbFBvaW50QTEpLCAxKTtcbiAgICAgICAgICBub3JtYWxpemVWZWMyKHRoaXMubV9heGlzKTtcbiAgICAgICAgICByb3RWZWMyKG5vcm1hbCQzLCB4ZkEkMS5xLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgY29tYmluZTJWZWMyKHRoaXMubV9sb2NhbFBvaW50LCAwLjUsIGxvY2FsUG9pbnRBMSwgMC41LCBsb2NhbFBvaW50QTIpO1xuICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRBJDIsIHhmQSQxLCB0aGlzLm1fbG9jYWxQb2ludCk7XG4gICAgICAgICAgdmFyIGxvY2FsUG9pbnRCXzIgPSB0aGlzLm1fcHJveHlCLmdldFZlcnRleChjYWNoZTIuaW5kZXhCWzBdKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QiQyLCB4ZkIkMSwgbG9jYWxQb2ludEJfMik7XG4gICAgICAgICAgdmFyIHMyID0gZG90VmVjMihwb2ludEIkMiwgbm9ybWFsJDMpIC0gZG90VmVjMihwb2ludEEkMiwgbm9ybWFsJDMpO1xuICAgICAgICAgIGlmIChzMiA8IDApIHtcbiAgICAgICAgICAgIG5lZ1ZlYzIodGhpcy5tX2F4aXMpO1xuICAgICAgICAgICAgczIgPSAtczI7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBzMjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNlcGFyYXRpb25GdW5jdGlvbjIucHJvdG90eXBlLmNvbXB1dGUgPSBmdW5jdGlvbihmaW5kLCB0KSB7XG4gICAgICAgIHRoaXMubV9zd2VlcEEuZ2V0VHJhbnNmb3JtKHhmQSQxLCB0KTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQi5nZXRUcmFuc2Zvcm0oeGZCJDEsIHQpO1xuICAgICAgICBzd2l0Y2ggKHRoaXMubV90eXBlKSB7XG4gICAgICAgICAgY2FzZSBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlLmVfcG9pbnRzOiB7XG4gICAgICAgICAgICBpZiAoZmluZCkge1xuICAgICAgICAgICAgICBkZXJvdFZlYzIoYXhpc0EsIHhmQSQxLnEsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICAgICAgZGVyb3RWZWMyKGF4aXNCLCB4ZkIkMS5xLCBzY2FsZVZlYzIodGVtcCQ0LCAtMSwgdGhpcy5tX2F4aXMpKTtcbiAgICAgICAgICAgICAgdGhpcy5pbmRleEEgPSB0aGlzLm1fcHJveHlBLmdldFN1cHBvcnQoYXhpc0EpO1xuICAgICAgICAgICAgICB0aGlzLmluZGV4QiA9IHRoaXMubV9wcm94eUIuZ2V0U3VwcG9ydChheGlzQik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb3B5VmVjMihsb2NhbFBvaW50QSwgdGhpcy5tX3Byb3h5QS5nZXRWZXJ0ZXgodGhpcy5pbmRleEEpKTtcbiAgICAgICAgICAgIGNvcHlWZWMyKGxvY2FsUG9pbnRCLCB0aGlzLm1fcHJveHlCLmdldFZlcnRleCh0aGlzLmluZGV4QikpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEEkMiwgeGZBJDEsIGxvY2FsUG9pbnRBKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRCJDIsIHhmQiQxLCBsb2NhbFBvaW50Qik7XG4gICAgICAgICAgICB2YXIgc2VwID0gZG90VmVjMihwb2ludEIkMiwgdGhpcy5tX2F4aXMpIC0gZG90VmVjMihwb2ludEEkMiwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgICAgcmV0dXJuIHNlcDtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlLmVfZmFjZUE6IHtcbiAgICAgICAgICAgIHJvdFZlYzIobm9ybWFsJDMsIHhmQSQxLnEsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRBJDIsIHhmQSQxLCB0aGlzLm1fbG9jYWxQb2ludCk7XG4gICAgICAgICAgICBpZiAoZmluZCkge1xuICAgICAgICAgICAgICBkZXJvdFZlYzIoYXhpc0IsIHhmQiQxLnEsIHNjYWxlVmVjMih0ZW1wJDQsIC0xLCBub3JtYWwkMykpO1xuICAgICAgICAgICAgICB0aGlzLmluZGV4QSA9IC0xO1xuICAgICAgICAgICAgICB0aGlzLmluZGV4QiA9IHRoaXMubV9wcm94eUIuZ2V0U3VwcG9ydChheGlzQik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb3B5VmVjMihsb2NhbFBvaW50QiwgdGhpcy5tX3Byb3h5Qi5nZXRWZXJ0ZXgodGhpcy5pbmRleEIpKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRCJDIsIHhmQiQxLCBsb2NhbFBvaW50Qik7XG4gICAgICAgICAgICB2YXIgc2VwID0gZG90VmVjMihwb2ludEIkMiwgbm9ybWFsJDMpIC0gZG90VmVjMihwb2ludEEkMiwgbm9ybWFsJDMpO1xuICAgICAgICAgICAgcmV0dXJuIHNlcDtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlLmVfZmFjZUI6IHtcbiAgICAgICAgICAgIHJvdFZlYzIobm9ybWFsJDMsIHhmQiQxLnEsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRCJDIsIHhmQiQxLCB0aGlzLm1fbG9jYWxQb2ludCk7XG4gICAgICAgICAgICBpZiAoZmluZCkge1xuICAgICAgICAgICAgICBkZXJvdFZlYzIoYXhpc0EsIHhmQSQxLnEsIHNjYWxlVmVjMih0ZW1wJDQsIC0xLCBub3JtYWwkMykpO1xuICAgICAgICAgICAgICB0aGlzLmluZGV4QiA9IC0xO1xuICAgICAgICAgICAgICB0aGlzLmluZGV4QSA9IHRoaXMubV9wcm94eUEuZ2V0U3VwcG9ydChheGlzQSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb3B5VmVjMihsb2NhbFBvaW50QSwgdGhpcy5tX3Byb3h5QS5nZXRWZXJ0ZXgodGhpcy5pbmRleEEpKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRBJDIsIHhmQSQxLCBsb2NhbFBvaW50QSk7XG4gICAgICAgICAgICB2YXIgc2VwID0gZG90VmVjMihwb2ludEEkMiwgbm9ybWFsJDMpIC0gZG90VmVjMihwb2ludEIkMiwgbm9ybWFsJDMpO1xuICAgICAgICAgICAgcmV0dXJuIHNlcDtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGlmIChmaW5kKSB7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhBID0gLTE7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhCID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNlcGFyYXRpb25GdW5jdGlvbjIucHJvdG90eXBlLmZpbmRNaW5TZXBhcmF0aW9uID0gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21wdXRlKHRydWUsIHQpO1xuICAgICAgfTtcbiAgICAgIFNlcGFyYXRpb25GdW5jdGlvbjIucHJvdG90eXBlLmV2YWx1YXRlID0gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21wdXRlKGZhbHNlLCB0KTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gU2VwYXJhdGlvbkZ1bmN0aW9uMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIHNlcGFyYXRpb25GdW5jdGlvbiA9IG5ldyBTZXBhcmF0aW9uRnVuY3Rpb24oKTtcbiAgVGltZU9mSW1wYWN0LklucHV0ID0gVE9JSW5wdXQ7XG4gIFRpbWVPZkltcGFjdC5PdXRwdXQgPSBUT0lPdXRwdXQ7XG4gIHZhciBtYXRoX2FicyQ2ID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX3NxcnQkMyA9IE1hdGguc3FydDtcbiAgdmFyIG1hdGhfbWluJDUgPSBNYXRoLm1pbjtcbiAgdmFyIFRpbWVTdGVwID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFRpbWVTdGVwMigpIHtcbiAgICAgICAgdGhpcy5kdCA9IDA7XG4gICAgICAgIHRoaXMuaW52X2R0ID0gMDtcbiAgICAgICAgdGhpcy52ZWxvY2l0eUl0ZXJhdGlvbnMgPSAwO1xuICAgICAgICB0aGlzLnBvc2l0aW9uSXRlcmF0aW9ucyA9IDA7XG4gICAgICAgIHRoaXMud2FybVN0YXJ0aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYmxvY2tTb2x2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuaW52X2R0MCA9IDA7XG4gICAgICAgIHRoaXMuZHRSYXRpbyA9IDE7XG4gICAgICB9XG4gICAgICBUaW1lU3RlcDIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oZHQpIHtcbiAgICAgICAgaWYgKHRoaXMuZHQgPiAwKSB7XG4gICAgICAgICAgdGhpcy5pbnZfZHQwID0gdGhpcy5pbnZfZHQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kdCA9IGR0O1xuICAgICAgICB0aGlzLmludl9kdCA9IGR0ID09IDAgPyAwIDogMSAvIGR0O1xuICAgICAgICB0aGlzLmR0UmF0aW8gPSBkdCAqIHRoaXMuaW52X2R0MDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVGltZVN0ZXAyO1xuICAgIH0oKVxuICApO1xuICB2YXIgc19zdWJTdGVwID0gbmV3IFRpbWVTdGVwKCk7XG4gIHZhciBjID0gdmVjMigwLCAwKTtcbiAgdmFyIHYgPSB2ZWMyKDAsIDApO1xuICB2YXIgdHJhbnNsYXRpb24gPSB2ZWMyKDAsIDApO1xuICB2YXIgaW5wdXQgPSBuZXcgVE9JSW5wdXQoKTtcbiAgdmFyIG91dHB1dCA9IG5ldyBUT0lPdXRwdXQoKTtcbiAgdmFyIGJhY2t1cCA9IG5ldyBTd2VlcCgpO1xuICB2YXIgYmFja3VwMSA9IG5ldyBTd2VlcCgpO1xuICB2YXIgYmFja3VwMiA9IG5ldyBTd2VlcCgpO1xuICB2YXIgQ29udGFjdEltcHVsc2UgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gQ29udGFjdEltcHVsc2UyKGNvbnRhY3QpIHtcbiAgICAgICAgdGhpcy5jb250YWN0ID0gY29udGFjdDtcbiAgICAgICAgdGhpcy5ub3JtYWxzID0gW107XG4gICAgICAgIHRoaXMudGFuZ2VudHMgPSBbXTtcbiAgICAgIH1cbiAgICAgIENvbnRhY3RJbXB1bHNlMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm5vcm1hbHMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy50YW5nZW50cy5sZW5ndGggPSAwO1xuICAgICAgfTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb250YWN0SW1wdWxzZTIucHJvdG90eXBlLCBcIm5vcm1hbEltcHVsc2VzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMuY29udGFjdDtcbiAgICAgICAgICB2YXIgbm9ybWFscyA9IHRoaXMubm9ybWFscztcbiAgICAgICAgICBub3JtYWxzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgZm9yICh2YXIgcCA9IDA7IHAgPCBjb250YWN0LnZfcG9pbnRzLmxlbmd0aDsgKytwKSB7XG4gICAgICAgICAgICBub3JtYWxzLnB1c2goY29udGFjdC52X3BvaW50c1twXS5ub3JtYWxJbXB1bHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG5vcm1hbHM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnRhY3RJbXB1bHNlMi5wcm90b3R5cGUsIFwidGFuZ2VudEltcHVsc2VzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMuY29udGFjdDtcbiAgICAgICAgICB2YXIgdGFuZ2VudHMgPSB0aGlzLnRhbmdlbnRzO1xuICAgICAgICAgIHRhbmdlbnRzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgZm9yICh2YXIgcCA9IDA7IHAgPCBjb250YWN0LnZfcG9pbnRzLmxlbmd0aDsgKytwKSB7XG4gICAgICAgICAgICB0YW5nZW50cy5wdXNoKGNvbnRhY3Qudl9wb2ludHNbcF0udGFuZ2VudEltcHVsc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGFuZ2VudHM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIENvbnRhY3RJbXB1bHNlMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFNvbHZlciA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTb2x2ZXIyKHdvcmxkKSB7XG4gICAgICAgIHRoaXMubV93b3JsZCA9IHdvcmxkO1xuICAgICAgICB0aGlzLm1fc3RhY2sgPSBbXTtcbiAgICAgICAgdGhpcy5tX2JvZGllcyA9IFtdO1xuICAgICAgICB0aGlzLm1fY29udGFjdHMgPSBbXTtcbiAgICAgICAgdGhpcy5tX2pvaW50cyA9IFtdO1xuICAgICAgfVxuICAgICAgU29sdmVyMi5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX3N0YWNrLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMubV9ib2RpZXMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMubV9qb2ludHMubGVuZ3RoID0gMDtcbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5hZGRCb2R5ID0gZnVuY3Rpb24oYm9keSkge1xuICAgICAgICB0aGlzLm1fYm9kaWVzLnB1c2goYm9keSk7XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUuYWRkQ29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QpIHtcbiAgICAgICAgdGhpcy5tX2NvbnRhY3RzLnB1c2goY29udGFjdCk7XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUuYWRkSm9pbnQgPSBmdW5jdGlvbihqb2ludCkge1xuICAgICAgICB0aGlzLm1fam9pbnRzLnB1c2goam9pbnQpO1xuICAgICAgfTtcbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLnNvbHZlV29ybGQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB3b3JsZCA9IHRoaXMubV93b3JsZDtcbiAgICAgICAgZm9yICh2YXIgYjIgPSB3b3JsZC5tX2JvZHlMaXN0OyBiMjsgYjIgPSBiMi5tX25leHQpIHtcbiAgICAgICAgICBiMi5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBjXzEgPSB3b3JsZC5tX2NvbnRhY3RMaXN0OyBjXzE7IGNfMSA9IGNfMS5tX25leHQpIHtcbiAgICAgICAgICBjXzEubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaiA9IHdvcmxkLm1fam9pbnRMaXN0OyBqOyBqID0gai5tX25leHQpIHtcbiAgICAgICAgICBqLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdGFjayA9IHRoaXMubV9zdGFjaztcbiAgICAgICAgZm9yICh2YXIgc2VlZCA9IHdvcmxkLm1fYm9keUxpc3Q7IHNlZWQ7IHNlZWQgPSBzZWVkLm1fbmV4dCkge1xuICAgICAgICAgIGlmIChzZWVkLm1faXNsYW5kRmxhZykge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzZWVkLmlzQXdha2UoKSA9PSBmYWxzZSB8fCBzZWVkLmlzQWN0aXZlKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoc2VlZC5pc1N0YXRpYygpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5jbGVhcigpO1xuICAgICAgICAgIHN0YWNrLnB1c2goc2VlZCk7XG4gICAgICAgICAgc2VlZC5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgYjIgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQm9keShiMik7XG4gICAgICAgICAgICBiMi5tX2F3YWtlRmxhZyA9IHRydWU7XG4gICAgICAgICAgICBpZiAoYjIuaXNTdGF0aWMoKSkge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGNlID0gYjIubV9jb250YWN0TGlzdDsgY2U7IGNlID0gY2UubmV4dCkge1xuICAgICAgICAgICAgICB2YXIgY29udGFjdCA9IGNlLmNvbnRhY3Q7XG4gICAgICAgICAgICAgIGlmIChjb250YWN0Lm1faXNsYW5kRmxhZykge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChjb250YWN0LmlzRW5hYmxlZCgpID09IGZhbHNlIHx8IGNvbnRhY3QuaXNUb3VjaGluZygpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIHNlbnNvckEgPSBjb250YWN0Lm1fZml4dHVyZUEubV9pc1NlbnNvcjtcbiAgICAgICAgICAgICAgdmFyIHNlbnNvckIgPSBjb250YWN0Lm1fZml4dHVyZUIubV9pc1NlbnNvcjtcbiAgICAgICAgICAgICAgaWYgKHNlbnNvckEgfHwgc2Vuc29yQikge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHRoaXMuYWRkQ29udGFjdChjb250YWN0KTtcbiAgICAgICAgICAgICAgY29udGFjdC5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICB2YXIgb3RoZXIgPSBjZS5vdGhlcjtcbiAgICAgICAgICAgICAgaWYgKG90aGVyLm1faXNsYW5kRmxhZykge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHN0YWNrLnB1c2gob3RoZXIpO1xuICAgICAgICAgICAgICBvdGhlci5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgamUgPSBiMi5tX2pvaW50TGlzdDsgamU7IGplID0gamUubmV4dCkge1xuICAgICAgICAgICAgICBpZiAoamUuam9pbnQubV9pc2xhbmRGbGFnID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgb3RoZXIgPSBqZS5vdGhlcjtcbiAgICAgICAgICAgICAgaWYgKG90aGVyLmlzQWN0aXZlKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB0aGlzLmFkZEpvaW50KGplLmpvaW50KTtcbiAgICAgICAgICAgICAgamUuam9pbnQubV9pc2xhbmRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgaWYgKG90aGVyLm1faXNsYW5kRmxhZykge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHN0YWNrLnB1c2gob3RoZXIpO1xuICAgICAgICAgICAgICBvdGhlci5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnNvbHZlSXNsYW5kKHN0ZXApO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGIyID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICAgIGlmIChiMi5pc1N0YXRpYygpKSB7XG4gICAgICAgICAgICAgIGIyLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLnNvbHZlSXNsYW5kID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgd29ybGQgPSB0aGlzLm1fd29ybGQ7XG4gICAgICAgIHZhciBncmF2aXR5ID0gd29ybGQubV9ncmF2aXR5O1xuICAgICAgICB2YXIgYWxsb3dTbGVlcCA9IHdvcmxkLm1fYWxsb3dTbGVlcDtcbiAgICAgICAgdmFyIGggPSBzdGVwLmR0O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9ib2RpZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgYm9keSA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgY29weVZlYzIoYywgYm9keS5tX3N3ZWVwLmMpO1xuICAgICAgICAgIHZhciBhMiA9IGJvZHkubV9zd2VlcC5hO1xuICAgICAgICAgIGNvcHlWZWMyKHYsIGJvZHkubV9saW5lYXJWZWxvY2l0eSk7XG4gICAgICAgICAgdmFyIHcgPSBib2R5Lm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkubV9zd2VlcC5jMCwgYm9keS5tX3N3ZWVwLmMpO1xuICAgICAgICAgIGJvZHkubV9zd2VlcC5hMCA9IGJvZHkubV9zd2VlcC5hO1xuICAgICAgICAgIGlmIChib2R5LmlzRHluYW1pYygpKSB7XG4gICAgICAgICAgICBwbHVzU2NhbGVWZWMyKHYsIGggKiBib2R5Lm1fZ3Jhdml0eVNjYWxlLCBncmF2aXR5KTtcbiAgICAgICAgICAgIHBsdXNTY2FsZVZlYzIodiwgaCAqIGJvZHkubV9pbnZNYXNzLCBib2R5Lm1fZm9yY2UpO1xuICAgICAgICAgICAgdyArPSBoICogYm9keS5tX2ludkkgKiBib2R5Lm1fdG9ycXVlO1xuICAgICAgICAgICAgc2NhbGVWZWMyKHYsIDEgLyAoMSArIGggKiBib2R5Lm1fbGluZWFyRGFtcGluZyksIHYpO1xuICAgICAgICAgICAgdyAqPSAxIC8gKDEgKyBoICogYm9keS5tX2FuZ3VsYXJEYW1waW5nKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29weVZlYzIoYm9keS5jX3Bvc2l0aW9uLmMsIGMpO1xuICAgICAgICAgIGJvZHkuY19wb3NpdGlvbi5hID0gYTI7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5jX3ZlbG9jaXR5LnYsIHYpO1xuICAgICAgICAgIGJvZHkuY192ZWxvY2l0eS53ID0gdztcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2ldO1xuICAgICAgICAgIGNvbnRhY3QuaW5pdENvbnN0cmFpbnQoc3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tpXTtcbiAgICAgICAgICBjb250YWN0LmluaXRWZWxvY2l0eUNvbnN0cmFpbnQoc3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2ldO1xuICAgICAgICAgICAgY29udGFjdC53YXJtU3RhcnRDb25zdHJhaW50KHN0ZXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9qb2ludHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgam9pbnQgPSB0aGlzLm1fam9pbnRzW2ldO1xuICAgICAgICAgIGpvaW50LmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzKHN0ZXApO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnM7ICsraSkge1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5tX2pvaW50cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGpvaW50ID0gdGhpcy5tX2pvaW50c1tqXTtcbiAgICAgICAgICAgIGpvaW50LnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyhzdGVwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2pdO1xuICAgICAgICAgICAgY29udGFjdC5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludChzdGVwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tpXTtcbiAgICAgICAgICBjb250YWN0LnN0b3JlQ29uc3RyYWludEltcHVsc2VzKHN0ZXApO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICBjb3B5VmVjMihjLCBib2R5LmNfcG9zaXRpb24uYyk7XG4gICAgICAgICAgdmFyIGEyID0gYm9keS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgICAgY29weVZlYzIodiwgYm9keS5jX3ZlbG9jaXR5LnYpO1xuICAgICAgICAgIHZhciB3ID0gYm9keS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgICAgc2NhbGVWZWMyKHRyYW5zbGF0aW9uLCBoLCB2KTtcbiAgICAgICAgICB2YXIgdHJhbnNsYXRpb25MZW5ndGhTcXIgPSBsZW5ndGhTcXJWZWMyKHRyYW5zbGF0aW9uKTtcbiAgICAgICAgICBpZiAodHJhbnNsYXRpb25MZW5ndGhTcXIgPiBTZXR0aW5nc0ludGVybmFsLm1heFRyYW5zbGF0aW9uU3F1YXJlZCkge1xuICAgICAgICAgICAgdmFyIHJhdGlvID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhUcmFuc2xhdGlvbiAvIG1hdGhfc3FydCQzKHRyYW5zbGF0aW9uTGVuZ3RoU3FyKTtcbiAgICAgICAgICAgIG11bFZlYzIodiwgcmF0aW8pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcm90YXRpb24yID0gaCAqIHc7XG4gICAgICAgICAgaWYgKHJvdGF0aW9uMiAqIHJvdGF0aW9uMiA+IFNldHRpbmdzSW50ZXJuYWwubWF4Um90YXRpb25TcXVhcmVkKSB7XG4gICAgICAgICAgICB2YXIgcmF0aW8gPSBTZXR0aW5nc0ludGVybmFsLm1heFJvdGF0aW9uIC8gbWF0aF9hYnMkNihyb3RhdGlvbjIpO1xuICAgICAgICAgICAgdyAqPSByYXRpbztcbiAgICAgICAgICB9XG4gICAgICAgICAgcGx1c1NjYWxlVmVjMihjLCBoLCB2KTtcbiAgICAgICAgICBhMiArPSBoICogdztcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfcG9zaXRpb24uYywgYyk7XG4gICAgICAgICAgYm9keS5jX3Bvc2l0aW9uLmEgPSBhMjtcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfdmVsb2NpdHkudiwgdik7XG4gICAgICAgICAgYm9keS5jX3ZlbG9jaXR5LncgPSB3O1xuICAgICAgICB9XG4gICAgICAgIHZhciBwb3NpdGlvblNvbHZlZCA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ZXAucG9zaXRpb25JdGVyYXRpb25zOyArK2kpIHtcbiAgICAgICAgICB2YXIgbWluU2VwYXJhdGlvbiA9IDA7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2pdO1xuICAgICAgICAgICAgdmFyIHNlcGFyYXRpb24gPSBjb250YWN0LnNvbHZlUG9zaXRpb25Db25zdHJhaW50KHN0ZXApO1xuICAgICAgICAgICAgbWluU2VwYXJhdGlvbiA9IG1hdGhfbWluJDUobWluU2VwYXJhdGlvbiwgc2VwYXJhdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjb250YWN0c09rYXkgPSBtaW5TZXBhcmF0aW9uID49IC0zICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgICAgIHZhciBqb2ludHNPa2F5ID0gdHJ1ZTtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9qb2ludHMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIHZhciBqb2ludCA9IHRoaXMubV9qb2ludHNbal07XG4gICAgICAgICAgICB2YXIgam9pbnRPa2F5ID0gam9pbnQuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzKHN0ZXApO1xuICAgICAgICAgICAgam9pbnRzT2theSA9IGpvaW50c09rYXkgJiYgam9pbnRPa2F5O1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY29udGFjdHNPa2F5ICYmIGpvaW50c09rYXkpIHtcbiAgICAgICAgICAgIHBvc2l0aW9uU29sdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9ib2RpZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgYm9keSA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgY29weVZlYzIoYm9keS5tX3N3ZWVwLmMsIGJvZHkuY19wb3NpdGlvbi5jKTtcbiAgICAgICAgICBib2R5Lm1fc3dlZXAuYSA9IGJvZHkuY19wb3NpdGlvbi5hO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkubV9saW5lYXJWZWxvY2l0eSwgYm9keS5jX3ZlbG9jaXR5LnYpO1xuICAgICAgICAgIGJvZHkubV9hbmd1bGFyVmVsb2NpdHkgPSBib2R5LmNfdmVsb2NpdHkudztcbiAgICAgICAgICBib2R5LnN5bmNocm9uaXplVHJhbnNmb3JtKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wb3N0U29sdmVJc2xhbmQoKTtcbiAgICAgICAgaWYgKGFsbG93U2xlZXApIHtcbiAgICAgICAgICB2YXIgbWluU2xlZXBUaW1lID0gSW5maW5pdHk7XG4gICAgICAgICAgdmFyIGxpblRvbFNxciA9IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xlZXBUb2xlcmFuY2VTcXI7XG4gICAgICAgICAgdmFyIGFuZ1RvbFNxciA9IFNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsZWVwVG9sZXJhbmNlU3FyO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgICAgaWYgKGJvZHkuaXNTdGF0aWMoKSkge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChib2R5Lm1fYXV0b1NsZWVwRmxhZyA9PSBmYWxzZSB8fCBib2R5Lm1fYW5ndWxhclZlbG9jaXR5ICogYm9keS5tX2FuZ3VsYXJWZWxvY2l0eSA+IGFuZ1RvbFNxciB8fCBsZW5ndGhTcXJWZWMyKGJvZHkubV9saW5lYXJWZWxvY2l0eSkgPiBsaW5Ub2xTcXIpIHtcbiAgICAgICAgICAgICAgYm9keS5tX3NsZWVwVGltZSA9IDA7XG4gICAgICAgICAgICAgIG1pblNsZWVwVGltZSA9IDA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBib2R5Lm1fc2xlZXBUaW1lICs9IGg7XG4gICAgICAgICAgICAgIG1pblNsZWVwVGltZSA9IG1hdGhfbWluJDUobWluU2xlZXBUaW1lLCBib2R5Lm1fc2xlZXBUaW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG1pblNsZWVwVGltZSA+PSBTZXR0aW5nc0ludGVybmFsLnRpbWVUb1NsZWVwICYmIHBvc2l0aW9uU29sdmVkKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9ib2RpZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgICAgICBib2R5LnNldEF3YWtlKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5zb2x2ZVdvcmxkVE9JID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgd29ybGQgPSB0aGlzLm1fd29ybGQ7XG4gICAgICAgIGlmICh3b3JsZC5tX3N0ZXBDb21wbGV0ZSkge1xuICAgICAgICAgIGZvciAodmFyIGIyID0gd29ybGQubV9ib2R5TGlzdDsgYjI7IGIyID0gYjIubV9uZXh0KSB7XG4gICAgICAgICAgICBiMi5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIGIyLm1fc3dlZXAuYWxwaGEwID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yICh2YXIgY18yID0gd29ybGQubV9jb250YWN0TGlzdDsgY18yOyBjXzIgPSBjXzIubV9uZXh0KSB7XG4gICAgICAgICAgICBjXzIubV90b2lGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICBjXzIubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICBjXzIubV90b2lDb3VudCA9IDA7XG4gICAgICAgICAgICBjXzIubV90b2kgPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgIHZhciBtaW5Db250YWN0ID0gbnVsbDtcbiAgICAgICAgICB2YXIgbWluQWxwaGEgPSAxO1xuICAgICAgICAgIGZvciAodmFyIGNfMyA9IHdvcmxkLm1fY29udGFjdExpc3Q7IGNfMzsgY18zID0gY18zLm1fbmV4dCkge1xuICAgICAgICAgICAgaWYgKGNfMy5pc0VuYWJsZWQoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjXzMubV90b2lDb3VudCA+IFNldHRpbmdzSW50ZXJuYWwubWF4U3ViU3RlcHMpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYWxwaGEgPSAxO1xuICAgICAgICAgICAgaWYgKGNfMy5tX3RvaUZsYWcpIHtcbiAgICAgICAgICAgICAgYWxwaGEgPSBjXzMubV90b2k7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB2YXIgZkFfMSA9IGNfMy5nZXRGaXh0dXJlQSgpO1xuICAgICAgICAgICAgICB2YXIgZkJfMSA9IGNfMy5nZXRGaXh0dXJlQigpO1xuICAgICAgICAgICAgICBpZiAoZkFfMS5pc1NlbnNvcigpIHx8IGZCXzEuaXNTZW5zb3IoKSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhciBiQV8xID0gZkFfMS5nZXRCb2R5KCk7XG4gICAgICAgICAgICAgIHZhciBiQl8xID0gZkJfMS5nZXRCb2R5KCk7XG4gICAgICAgICAgICAgIHZhciBhY3RpdmVBID0gYkFfMS5pc0F3YWtlKCkgJiYgIWJBXzEuaXNTdGF0aWMoKTtcbiAgICAgICAgICAgICAgdmFyIGFjdGl2ZUIgPSBiQl8xLmlzQXdha2UoKSAmJiAhYkJfMS5pc1N0YXRpYygpO1xuICAgICAgICAgICAgICBpZiAoYWN0aXZlQSA9PSBmYWxzZSAmJiBhY3RpdmVCID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIGNvbGxpZGVBID0gYkFfMS5pc0J1bGxldCgpIHx8ICFiQV8xLmlzRHluYW1pYygpO1xuICAgICAgICAgICAgICB2YXIgY29sbGlkZUIgPSBiQl8xLmlzQnVsbGV0KCkgfHwgIWJCXzEuaXNEeW5hbWljKCk7XG4gICAgICAgICAgICAgIGlmIChjb2xsaWRlQSA9PSBmYWxzZSAmJiBjb2xsaWRlQiA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhciBhbHBoYTAgPSBiQV8xLm1fc3dlZXAuYWxwaGEwO1xuICAgICAgICAgICAgICBpZiAoYkFfMS5tX3N3ZWVwLmFscGhhMCA8IGJCXzEubV9zd2VlcC5hbHBoYTApIHtcbiAgICAgICAgICAgICAgICBhbHBoYTAgPSBiQl8xLm1fc3dlZXAuYWxwaGEwO1xuICAgICAgICAgICAgICAgIGJBXzEubV9zd2VlcC5hZHZhbmNlKGFscGhhMCk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoYkJfMS5tX3N3ZWVwLmFscGhhMCA8IGJBXzEubV9zd2VlcC5hbHBoYTApIHtcbiAgICAgICAgICAgICAgICBhbHBoYTAgPSBiQV8xLm1fc3dlZXAuYWxwaGEwO1xuICAgICAgICAgICAgICAgIGJCXzEubV9zd2VlcC5hZHZhbmNlKGFscGhhMCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIGluZGV4QSA9IGNfMy5nZXRDaGlsZEluZGV4QSgpO1xuICAgICAgICAgICAgICB2YXIgaW5kZXhCID0gY18zLmdldENoaWxkSW5kZXhCKCk7XG4gICAgICAgICAgICAgIGlucHV0LnByb3h5QS5zZXQoZkFfMS5nZXRTaGFwZSgpLCBpbmRleEEpO1xuICAgICAgICAgICAgICBpbnB1dC5wcm94eUIuc2V0KGZCXzEuZ2V0U2hhcGUoKSwgaW5kZXhCKTtcbiAgICAgICAgICAgICAgaW5wdXQuc3dlZXBBLnNldChiQV8xLm1fc3dlZXApO1xuICAgICAgICAgICAgICBpbnB1dC5zd2VlcEIuc2V0KGJCXzEubV9zd2VlcCk7XG4gICAgICAgICAgICAgIGlucHV0LnRNYXggPSAxO1xuICAgICAgICAgICAgICBUaW1lT2ZJbXBhY3Qob3V0cHV0LCBpbnB1dCk7XG4gICAgICAgICAgICAgIHZhciBiZXRhID0gb3V0cHV0LnQ7XG4gICAgICAgICAgICAgIGlmIChvdXRwdXQuc3RhdGUgPT0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV90b3VjaGluZykge1xuICAgICAgICAgICAgICAgIGFscGhhID0gbWF0aF9taW4kNShhbHBoYTAgKyAoMSAtIGFscGhhMCkgKiBiZXRhLCAxKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbHBoYSA9IDE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY18zLm1fdG9pID0gYWxwaGE7XG4gICAgICAgICAgICAgIGNfMy5tX3RvaUZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFscGhhIDwgbWluQWxwaGEpIHtcbiAgICAgICAgICAgICAgbWluQ29udGFjdCA9IGNfMztcbiAgICAgICAgICAgICAgbWluQWxwaGEgPSBhbHBoYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG1pbkNvbnRhY3QgPT0gbnVsbCB8fCAxIC0gMTAgKiBFUFNJTE9OIDwgbWluQWxwaGEpIHtcbiAgICAgICAgICAgIHdvcmxkLm1fc3RlcENvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgZkEgPSBtaW5Db250YWN0LmdldEZpeHR1cmVBKCk7XG4gICAgICAgICAgdmFyIGZCID0gbWluQ29udGFjdC5nZXRGaXh0dXJlQigpO1xuICAgICAgICAgIHZhciBiQSA9IGZBLmdldEJvZHkoKTtcbiAgICAgICAgICB2YXIgYkIgPSBmQi5nZXRCb2R5KCk7XG4gICAgICAgICAgYmFja3VwMS5zZXQoYkEubV9zd2VlcCk7XG4gICAgICAgICAgYmFja3VwMi5zZXQoYkIubV9zd2VlcCk7XG4gICAgICAgICAgYkEuYWR2YW5jZShtaW5BbHBoYSk7XG4gICAgICAgICAgYkIuYWR2YW5jZShtaW5BbHBoYSk7XG4gICAgICAgICAgbWluQ29udGFjdC51cGRhdGUod29ybGQpO1xuICAgICAgICAgIG1pbkNvbnRhY3QubV90b2lGbGFnID0gZmFsc2U7XG4gICAgICAgICAgKyttaW5Db250YWN0Lm1fdG9pQ291bnQ7XG4gICAgICAgICAgaWYgKG1pbkNvbnRhY3QuaXNFbmFibGVkKCkgPT0gZmFsc2UgfHwgbWluQ29udGFjdC5pc1RvdWNoaW5nKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIG1pbkNvbnRhY3Quc2V0RW5hYmxlZChmYWxzZSk7XG4gICAgICAgICAgICBiQS5tX3N3ZWVwLnNldChiYWNrdXAxKTtcbiAgICAgICAgICAgIGJCLm1fc3dlZXAuc2V0KGJhY2t1cDIpO1xuICAgICAgICAgICAgYkEuc3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgIGJCLnN5bmNocm9uaXplVHJhbnNmb3JtKCk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYkEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgYkIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5jbGVhcigpO1xuICAgICAgICAgIHRoaXMuYWRkQm9keShiQSk7XG4gICAgICAgICAgdGhpcy5hZGRCb2R5KGJCKTtcbiAgICAgICAgICB0aGlzLmFkZENvbnRhY3QobWluQ29udGFjdCk7XG4gICAgICAgICAgYkEubV9pc2xhbmRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICBiQi5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgIG1pbkNvbnRhY3QubV9pc2xhbmRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgYm9kaWVzID0gW2JBLCBiQl07XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib2RpZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBib2R5ID0gYm9kaWVzW2ldO1xuICAgICAgICAgICAgaWYgKGJvZHkuaXNEeW5hbWljKCkpIHtcbiAgICAgICAgICAgICAgZm9yICh2YXIgY2UgPSBib2R5Lm1fY29udGFjdExpc3Q7IGNlOyBjZSA9IGNlLm5leHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGFjdCA9IGNlLmNvbnRhY3Q7XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRhY3QubV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG90aGVyID0gY2Uub3RoZXI7XG4gICAgICAgICAgICAgICAgaWYgKG90aGVyLmlzRHluYW1pYygpICYmICFib2R5LmlzQnVsbGV0KCkgJiYgIW90aGVyLmlzQnVsbGV0KCkpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2Vuc29yQSA9IGNvbnRhY3QubV9maXh0dXJlQS5tX2lzU2Vuc29yO1xuICAgICAgICAgICAgICAgIHZhciBzZW5zb3JCID0gY29udGFjdC5tX2ZpeHR1cmVCLm1faXNTZW5zb3I7XG4gICAgICAgICAgICAgICAgaWYgKHNlbnNvckEgfHwgc2Vuc29yQikge1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJhY2t1cC5zZXQob3RoZXIubV9zd2VlcCk7XG4gICAgICAgICAgICAgICAgaWYgKG90aGVyLm1faXNsYW5kRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgb3RoZXIuYWR2YW5jZShtaW5BbHBoYSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnRhY3QudXBkYXRlKHdvcmxkKTtcbiAgICAgICAgICAgICAgICBpZiAoY29udGFjdC5pc0VuYWJsZWQoKSA9PSBmYWxzZSB8fCBjb250YWN0LmlzVG91Y2hpbmcoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgb3RoZXIubV9zd2VlcC5zZXQoYmFja3VwKTtcbiAgICAgICAgICAgICAgICAgIG90aGVyLnN5bmNocm9uaXplVHJhbnNmb3JtKCk7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGFjdC5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ29udGFjdChjb250YWN0KTtcbiAgICAgICAgICAgICAgICBpZiAob3RoZXIubV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb3RoZXIubV9pc2xhbmRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoIW90aGVyLmlzU3RhdGljKCkpIHtcbiAgICAgICAgICAgICAgICAgIG90aGVyLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJvZHkob3RoZXIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHNfc3ViU3RlcC5yZXNldCgoMSAtIG1pbkFscGhhKSAqIHN0ZXAuZHQpO1xuICAgICAgICAgIHNfc3ViU3RlcC5kdFJhdGlvID0gMTtcbiAgICAgICAgICBzX3N1YlN0ZXAucG9zaXRpb25JdGVyYXRpb25zID0gMjA7XG4gICAgICAgICAgc19zdWJTdGVwLnZlbG9jaXR5SXRlcmF0aW9ucyA9IHN0ZXAudmVsb2NpdHlJdGVyYXRpb25zO1xuICAgICAgICAgIHNfc3ViU3RlcC53YXJtU3RhcnRpbmcgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLnNvbHZlSXNsYW5kVE9JKHNfc3ViU3RlcCwgYkEsIGJCKTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9ib2RpZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICAgIGJvZHkubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIWJvZHkuaXNEeW5hbWljKCkpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBib2R5LnN5bmNocm9uaXplRml4dHVyZXMoKTtcbiAgICAgICAgICAgIGZvciAodmFyIGNlID0gYm9keS5tX2NvbnRhY3RMaXN0OyBjZTsgY2UgPSBjZS5uZXh0KSB7XG4gICAgICAgICAgICAgIGNlLmNvbnRhY3QubV90b2lGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICAgIGNlLmNvbnRhY3QubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHdvcmxkLmZpbmROZXdDb250YWN0cygpO1xuICAgICAgICAgIGlmICh3b3JsZC5tX3N1YlN0ZXBwaW5nKSB7XG4gICAgICAgICAgICB3b3JsZC5tX3N0ZXBDb21wbGV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUuc29sdmVJc2xhbmRUT0kgPSBmdW5jdGlvbihzdWJTdGVwLCB0b2lBLCB0b2lCKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfcG9zaXRpb24uYywgYm9keS5tX3N3ZWVwLmMpO1xuICAgICAgICAgIGJvZHkuY19wb3NpdGlvbi5hID0gYm9keS5tX3N3ZWVwLmE7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5jX3ZlbG9jaXR5LnYsIGJvZHkubV9saW5lYXJWZWxvY2l0eSk7XG4gICAgICAgICAgYm9keS5jX3ZlbG9jaXR5LncgPSBib2R5Lm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbaV07XG4gICAgICAgICAgY29udGFjdC5pbml0Q29uc3RyYWludChzdWJTdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1YlN0ZXAucG9zaXRpb25JdGVyYXRpb25zOyArK2kpIHtcbiAgICAgICAgICB2YXIgbWluU2VwYXJhdGlvbiA9IDA7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2pdO1xuICAgICAgICAgICAgdmFyIHNlcGFyYXRpb24gPSBjb250YWN0LnNvbHZlUG9zaXRpb25Db25zdHJhaW50VE9JKHN1YlN0ZXAsIHRvaUEsIHRvaUIpO1xuICAgICAgICAgICAgbWluU2VwYXJhdGlvbiA9IG1hdGhfbWluJDUobWluU2VwYXJhdGlvbiwgc2VwYXJhdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjb250YWN0c09rYXkgPSBtaW5TZXBhcmF0aW9uID49IC0xLjUgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgICAgICAgaWYgKGNvbnRhY3RzT2theSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBpO1xuICAgICAgICBjb3B5VmVjMih0b2lBLm1fc3dlZXAuYzAsIHRvaUEuY19wb3NpdGlvbi5jKTtcbiAgICAgICAgdG9pQS5tX3N3ZWVwLmEwID0gdG9pQS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIGNvcHlWZWMyKHRvaUIubV9zd2VlcC5jMCwgdG9pQi5jX3Bvc2l0aW9uLmMpO1xuICAgICAgICB0b2lCLm1fc3dlZXAuYTAgPSB0b2lCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tpXTtcbiAgICAgICAgICBjb250YWN0LmluaXRWZWxvY2l0eUNvbnN0cmFpbnQoc3ViU3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJTdGVwLnZlbG9jaXR5SXRlcmF0aW9uczsgKytpKSB7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2pdO1xuICAgICAgICAgICAgY29udGFjdC5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludChzdWJTdGVwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGggPSBzdWJTdGVwLmR0O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9ib2RpZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgYm9keSA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgY29weVZlYzIoYywgYm9keS5jX3Bvc2l0aW9uLmMpO1xuICAgICAgICAgIHZhciBhMiA9IGJvZHkuY19wb3NpdGlvbi5hO1xuICAgICAgICAgIGNvcHlWZWMyKHYsIGJvZHkuY192ZWxvY2l0eS52KTtcbiAgICAgICAgICB2YXIgdyA9IGJvZHkuY192ZWxvY2l0eS53O1xuICAgICAgICAgIHNjYWxlVmVjMih0cmFuc2xhdGlvbiwgaCwgdik7XG4gICAgICAgICAgdmFyIHRyYW5zbGF0aW9uTGVuZ3RoU3FyID0gbGVuZ3RoU3FyVmVjMih0cmFuc2xhdGlvbik7XG4gICAgICAgICAgaWYgKHRyYW5zbGF0aW9uTGVuZ3RoU3FyID4gU2V0dGluZ3NJbnRlcm5hbC5tYXhUcmFuc2xhdGlvblNxdWFyZWQpIHtcbiAgICAgICAgICAgIHZhciByYXRpbyA9IFNldHRpbmdzSW50ZXJuYWwubWF4VHJhbnNsYXRpb24gLyBtYXRoX3NxcnQkMyh0cmFuc2xhdGlvbkxlbmd0aFNxcik7XG4gICAgICAgICAgICBtdWxWZWMyKHYsIHJhdGlvKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHJvdGF0aW9uMiA9IGggKiB3O1xuICAgICAgICAgIGlmIChyb3RhdGlvbjIgKiByb3RhdGlvbjIgPiBTZXR0aW5nc0ludGVybmFsLm1heFJvdGF0aW9uU3F1YXJlZCkge1xuICAgICAgICAgICAgdmFyIHJhdGlvID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhSb3RhdGlvbiAvIG1hdGhfYWJzJDYocm90YXRpb24yKTtcbiAgICAgICAgICAgIHcgKj0gcmF0aW87XG4gICAgICAgICAgfVxuICAgICAgICAgIHBsdXNTY2FsZVZlYzIoYywgaCwgdik7XG4gICAgICAgICAgYTIgKz0gaCAqIHc7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5jX3Bvc2l0aW9uLmMsIGMpO1xuICAgICAgICAgIGJvZHkuY19wb3NpdGlvbi5hID0gYTI7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5jX3ZlbG9jaXR5LnYsIHYpO1xuICAgICAgICAgIGJvZHkuY192ZWxvY2l0eS53ID0gdztcbiAgICAgICAgICBjb3B5VmVjMihib2R5Lm1fc3dlZXAuYywgYyk7XG4gICAgICAgICAgYm9keS5tX3N3ZWVwLmEgPSBhMjtcbiAgICAgICAgICBjb3B5VmVjMihib2R5Lm1fbGluZWFyVmVsb2NpdHksIHYpO1xuICAgICAgICAgIGJvZHkubV9hbmd1bGFyVmVsb2NpdHkgPSB3O1xuICAgICAgICAgIGJvZHkuc3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBvc3RTb2x2ZUlzbGFuZCgpO1xuICAgICAgfTtcbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLnBvc3RTb2x2ZUlzbGFuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBmb3IgKHZhciBjXzUgPSAwOyBjXzUgPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2NfNSkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2NfNV07XG4gICAgICAgICAgdGhpcy5tX3dvcmxkLnBvc3RTb2x2ZShjb250YWN0LCBjb250YWN0Lm1faW1wdWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICByZXR1cm4gU29sdmVyMjtcbiAgICB9KClcbiAgKTtcbiAgU29sdmVyLlRpbWVTdGVwID0gVGltZVN0ZXA7XG4gIHZhciBNYXQyMiA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBNYXQyMjIoYTIsIGIyLCBjMiwgZDIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhMiA9PT0gXCJvYmplY3RcIiAmJiBhMiAhPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuZXggPSBWZWMyLmNsb25lKGEyKTtcbiAgICAgICAgICB0aGlzLmV5ID0gVmVjMi5jbG9uZShiMik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGEyID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgdGhpcy5leCA9IFZlYzIubmVvKGEyLCBjMik7XG4gICAgICAgICAgdGhpcy5leSA9IFZlYzIubmVvKGIyLCBkMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5leCA9IFZlYzIuemVybygpO1xuICAgICAgICAgIHRoaXMuZXkgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgTWF0MjIyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyk7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBWZWMyLmlzVmFsaWQob2JqLmV4KSAmJiBWZWMyLmlzVmFsaWQob2JqLmV5KTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIuYXNzZXJ0ID0gZnVuY3Rpb24obykge1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24oYTIsIGIyLCBjMiwgZDIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhMiA9PT0gXCJudW1iZXJcIiAmJiB0eXBlb2YgYjIgPT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGMyID09PSBcIm51bWJlclwiICYmIHR5cGVvZiBkMiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHRoaXMuZXguc2V0TnVtKGEyLCBjMik7XG4gICAgICAgICAgdGhpcy5leS5zZXROdW0oYjIsIGQyKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYTIgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIGIyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy5leC5zZXRWZWMyKGEyKTtcbiAgICAgICAgICB0aGlzLmV5LnNldFZlYzIoYjIpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhMiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMuZXguc2V0VmVjMihhMi5leCk7XG4gICAgICAgICAgdGhpcy5leS5zZXRWZWMyKGEyLmV5KTtcbiAgICAgICAgfSBlbHNlIDtcbiAgICAgIH07XG4gICAgICBNYXQyMjIucHJvdG90eXBlLnNldElkZW50aXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuZXgueCA9IDE7XG4gICAgICAgIHRoaXMuZXkueCA9IDA7XG4gICAgICAgIHRoaXMuZXgueSA9IDA7XG4gICAgICAgIHRoaXMuZXkueSA9IDE7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLnByb3RvdHlwZS5zZXRaZXJvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuZXgueCA9IDA7XG4gICAgICAgIHRoaXMuZXkueCA9IDA7XG4gICAgICAgIHRoaXMuZXgueSA9IDA7XG4gICAgICAgIHRoaXMuZXkueSA9IDA7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLnByb3RvdHlwZS5nZXRJbnZlcnNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhMiA9IHRoaXMuZXgueDtcbiAgICAgICAgdmFyIGIyID0gdGhpcy5leS54O1xuICAgICAgICB2YXIgYzIgPSB0aGlzLmV4Lnk7XG4gICAgICAgIHZhciBkMiA9IHRoaXMuZXkueTtcbiAgICAgICAgdmFyIGRldCA9IGEyICogZDIgLSBiMiAqIGMyO1xuICAgICAgICBpZiAoZGV0ICE9PSAwKSB7XG4gICAgICAgICAgZGV0ID0gMSAvIGRldDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW14ID0gbmV3IE1hdDIyMigpO1xuICAgICAgICBpbXguZXgueCA9IGRldCAqIGQyO1xuICAgICAgICBpbXguZXkueCA9IC1kZXQgKiBiMjtcbiAgICAgICAgaW14LmV4LnkgPSAtZGV0ICogYzI7XG4gICAgICAgIGlteC5leS55ID0gZGV0ICogYTI7XG4gICAgICAgIHJldHVybiBpbXg7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLnByb3RvdHlwZS5zb2x2ZSA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHZhciBhMiA9IHRoaXMuZXgueDtcbiAgICAgICAgdmFyIGIyID0gdGhpcy5leS54O1xuICAgICAgICB2YXIgYzIgPSB0aGlzLmV4Lnk7XG4gICAgICAgIHZhciBkMiA9IHRoaXMuZXkueTtcbiAgICAgICAgdmFyIGRldCA9IGEyICogZDIgLSBiMiAqIGMyO1xuICAgICAgICBpZiAoZGV0ICE9PSAwKSB7XG4gICAgICAgICAgZGV0ID0gMSAvIGRldDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdyA9IFZlYzIuemVybygpO1xuICAgICAgICB3LnggPSBkZXQgKiAoZDIgKiB2My54IC0gYjIgKiB2My55KTtcbiAgICAgICAgdy55ID0gZGV0ICogKGEyICogdjMueSAtIGMyICogdjMueCk7XG4gICAgICAgIHJldHVybiB3O1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5tdWwgPSBmdW5jdGlvbihteCwgdjMpIHtcbiAgICAgICAgaWYgKHYzICYmIFwieFwiIGluIHYzICYmIFwieVwiIGluIHYzKSB7XG4gICAgICAgICAgdmFyIHgyID0gbXguZXgueCAqIHYzLnggKyBteC5leS54ICogdjMueTtcbiAgICAgICAgICB2YXIgeSA9IG14LmV4LnkgKiB2My54ICsgbXguZXkueSAqIHYzLnk7XG4gICAgICAgICAgcmV0dXJuIFZlYzIubmVvKHgyLCB5KTtcbiAgICAgICAgfSBlbHNlIGlmICh2MyAmJiBcImV4XCIgaW4gdjMgJiYgXCJleVwiIGluIHYzKSB7XG4gICAgICAgICAgdmFyIGEyID0gbXguZXgueCAqIHYzLmV4LnggKyBteC5leS54ICogdjMuZXgueTtcbiAgICAgICAgICB2YXIgYjIgPSBteC5leC54ICogdjMuZXkueCArIG14LmV5LnggKiB2My5leS55O1xuICAgICAgICAgIHZhciBjMiA9IG14LmV4LnkgKiB2My5leC54ICsgbXguZXkueSAqIHYzLmV4Lnk7XG4gICAgICAgICAgdmFyIGQyID0gbXguZXgueSAqIHYzLmV5LnggKyBteC5leS55ICogdjMuZXkueTtcbiAgICAgICAgICByZXR1cm4gbmV3IE1hdDIyMihhMiwgYjIsIGMyLCBkMik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNYXQyMjIubXVsVmVjMiA9IGZ1bmN0aW9uKG14LCB2Mykge1xuICAgICAgICB2YXIgeDIgPSBteC5leC54ICogdjMueCArIG14LmV5LnggKiB2My55O1xuICAgICAgICB2YXIgeSA9IG14LmV4LnkgKiB2My54ICsgbXguZXkueSAqIHYzLnk7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh4MiwgeSk7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLm11bE1hdDIyID0gZnVuY3Rpb24obXgsIHYzKSB7XG4gICAgICAgIHZhciBhMiA9IG14LmV4LnggKiB2My5leC54ICsgbXguZXkueCAqIHYzLmV4Lnk7XG4gICAgICAgIHZhciBiMiA9IG14LmV4LnggKiB2My5leS54ICsgbXguZXkueCAqIHYzLmV5Lnk7XG4gICAgICAgIHZhciBjMiA9IG14LmV4LnkgKiB2My5leC54ICsgbXguZXkueSAqIHYzLmV4Lnk7XG4gICAgICAgIHZhciBkMiA9IG14LmV4LnkgKiB2My5leS54ICsgbXguZXkueSAqIHYzLmV5Lnk7XG4gICAgICAgIHJldHVybiBuZXcgTWF0MjIyKGEyLCBiMiwgYzIsIGQyKTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIubXVsVCA9IGZ1bmN0aW9uKG14LCB2Mykge1xuICAgICAgICBpZiAodjMgJiYgXCJ4XCIgaW4gdjMgJiYgXCJ5XCIgaW4gdjMpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMi5uZW8oVmVjMi5kb3QodjMsIG14LmV4KSwgVmVjMi5kb3QodjMsIG14LmV5KSk7XG4gICAgICAgIH0gZWxzZSBpZiAodjMgJiYgXCJleFwiIGluIHYzICYmIFwiZXlcIiBpbiB2Mykge1xuICAgICAgICAgIHZhciBjMSA9IFZlYzIubmVvKFZlYzIuZG90KG14LmV4LCB2My5leCksIFZlYzIuZG90KG14LmV5LCB2My5leCkpO1xuICAgICAgICAgIHZhciBjMiA9IFZlYzIubmVvKFZlYzIuZG90KG14LmV4LCB2My5leSksIFZlYzIuZG90KG14LmV5LCB2My5leSkpO1xuICAgICAgICAgIHJldHVybiBuZXcgTWF0MjIyKGMxLCBjMik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNYXQyMjIubXVsVFZlYzIgPSBmdW5jdGlvbihteCwgdjMpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKFZlYzIuZG90KHYzLCBteC5leCksIFZlYzIuZG90KHYzLCBteC5leSkpO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5tdWxUTWF0MjIgPSBmdW5jdGlvbihteCwgdjMpIHtcbiAgICAgICAgdmFyIGMxID0gVmVjMi5uZW8oVmVjMi5kb3QobXguZXgsIHYzLmV4KSwgVmVjMi5kb3QobXguZXksIHYzLmV4KSk7XG4gICAgICAgIHZhciBjMiA9IFZlYzIubmVvKFZlYzIuZG90KG14LmV4LCB2My5leSksIFZlYzIuZG90KG14LmV5LCB2My5leSkpO1xuICAgICAgICByZXR1cm4gbmV3IE1hdDIyMihjMSwgYzIpO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5hYnMgPSBmdW5jdGlvbihteCkge1xuICAgICAgICByZXR1cm4gbmV3IE1hdDIyMihWZWMyLmFicyhteC5leCksIFZlYzIuYWJzKG14LmV5KSk7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLmFkZCA9IGZ1bmN0aW9uKG14MSwgbXgyKSB7XG4gICAgICAgIHJldHVybiBuZXcgTWF0MjIyKFZlYzIuYWRkKG14MS5leCwgbXgyLmV4KSwgVmVjMi5hZGQobXgxLmV5LCBteDIuZXkpKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gTWF0MjIyO1xuICAgIH0oKVxuICApO1xuICB2YXIgbWF0aF9zcXJ0JDIgPSBNYXRoLnNxcnQ7XG4gIHZhciBwb2ludEEkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBwb2ludEIkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciB0ZW1wJDMgPSB2ZWMyKDAsIDApO1xuICB2YXIgY0EkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBjQiQxID0gdmVjMigwLCAwKTtcbiAgdmFyIGRpc3QgPSB2ZWMyKDAsIDApO1xuICB2YXIgcGxhbmVQb2ludCQyID0gdmVjMigwLCAwKTtcbiAgdmFyIGNsaXBQb2ludCQxID0gdmVjMigwLCAwKTtcbiAgZXhwb3J0czIuTWFuaWZvbGRUeXBlID0gdm9pZCAwO1xuICAoZnVuY3Rpb24oTWFuaWZvbGRUeXBlMikge1xuICAgIE1hbmlmb2xkVHlwZTJbTWFuaWZvbGRUeXBlMltcImVfdW5zZXRcIl0gPSAtMV0gPSBcImVfdW5zZXRcIjtcbiAgICBNYW5pZm9sZFR5cGUyW01hbmlmb2xkVHlwZTJbXCJlX2NpcmNsZXNcIl0gPSAwXSA9IFwiZV9jaXJjbGVzXCI7XG4gICAgTWFuaWZvbGRUeXBlMltNYW5pZm9sZFR5cGUyW1wiZV9mYWNlQVwiXSA9IDFdID0gXCJlX2ZhY2VBXCI7XG4gICAgTWFuaWZvbGRUeXBlMltNYW5pZm9sZFR5cGUyW1wiZV9mYWNlQlwiXSA9IDJdID0gXCJlX2ZhY2VCXCI7XG4gIH0pKGV4cG9ydHMyLk1hbmlmb2xkVHlwZSB8fCAoZXhwb3J0czIuTWFuaWZvbGRUeXBlID0ge30pKTtcbiAgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlID0gdm9pZCAwO1xuICAoZnVuY3Rpb24oQ29udGFjdEZlYXR1cmVUeXBlMikge1xuICAgIENvbnRhY3RGZWF0dXJlVHlwZTJbQ29udGFjdEZlYXR1cmVUeXBlMltcImVfdW5zZXRcIl0gPSAtMV0gPSBcImVfdW5zZXRcIjtcbiAgICBDb250YWN0RmVhdHVyZVR5cGUyW0NvbnRhY3RGZWF0dXJlVHlwZTJbXCJlX3ZlcnRleFwiXSA9IDBdID0gXCJlX3ZlcnRleFwiO1xuICAgIENvbnRhY3RGZWF0dXJlVHlwZTJbQ29udGFjdEZlYXR1cmVUeXBlMltcImVfZmFjZVwiXSA9IDFdID0gXCJlX2ZhY2VcIjtcbiAgfSkoZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlIHx8IChleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUgPSB7fSkpO1xuICBleHBvcnRzMi5Qb2ludFN0YXRlID0gdm9pZCAwO1xuICAoZnVuY3Rpb24oUG9pbnRTdGF0ZTIpIHtcbiAgICBQb2ludFN0YXRlMltQb2ludFN0YXRlMltcIm51bGxTdGF0ZVwiXSA9IDBdID0gXCJudWxsU3RhdGVcIjtcbiAgICBQb2ludFN0YXRlMltQb2ludFN0YXRlMltcImFkZFN0YXRlXCJdID0gMV0gPSBcImFkZFN0YXRlXCI7XG4gICAgUG9pbnRTdGF0ZTJbUG9pbnRTdGF0ZTJbXCJwZXJzaXN0U3RhdGVcIl0gPSAyXSA9IFwicGVyc2lzdFN0YXRlXCI7XG4gICAgUG9pbnRTdGF0ZTJbUG9pbnRTdGF0ZTJbXCJyZW1vdmVTdGF0ZVwiXSA9IDNdID0gXCJyZW1vdmVTdGF0ZVwiO1xuICB9KShleHBvcnRzMi5Qb2ludFN0YXRlIHx8IChleHBvcnRzMi5Qb2ludFN0YXRlID0ge30pKTtcbiAgdmFyIENsaXBWZXJ0ZXggPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gQ2xpcFZlcnRleDIoKSB7XG4gICAgICAgIHRoaXMudiA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMuaWQgPSBuZXcgQ29udGFjdElEKCk7XG4gICAgICB9XG4gICAgICBDbGlwVmVydGV4Mi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24obykge1xuICAgICAgICBjb3B5VmVjMih0aGlzLnYsIG8udik7XG4gICAgICAgIHRoaXMuaWQuc2V0KG8uaWQpO1xuICAgICAgfTtcbiAgICAgIENsaXBWZXJ0ZXgyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHplcm9WZWMyKHRoaXMudik7XG4gICAgICAgIHRoaXMuaWQucmVjeWNsZSgpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBDbGlwVmVydGV4MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIE1hbmlmb2xkID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIE1hbmlmb2xkMigpIHtcbiAgICAgICAgdGhpcy5sb2NhbE5vcm1hbCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMubG9jYWxQb2ludCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMucG9pbnRzID0gW25ldyBNYW5pZm9sZFBvaW50KCksIG5ldyBNYW5pZm9sZFBvaW50KCldO1xuICAgICAgICB0aGlzLnBvaW50Q291bnQgPSAwO1xuICAgICAgfVxuICAgICAgTWFuaWZvbGQyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih0aGF0KSB7XG4gICAgICAgIHRoaXMudHlwZSA9IHRoYXQudHlwZTtcbiAgICAgICAgY29weVZlYzIodGhpcy5sb2NhbE5vcm1hbCwgdGhhdC5sb2NhbE5vcm1hbCk7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMubG9jYWxQb2ludCwgdGhhdC5sb2NhbFBvaW50KTtcbiAgICAgICAgdGhpcy5wb2ludENvdW50ID0gdGhhdC5wb2ludENvdW50O1xuICAgICAgICB0aGlzLnBvaW50c1swXS5zZXQodGhhdC5wb2ludHNbMF0pO1xuICAgICAgICB0aGlzLnBvaW50c1sxXS5zZXQodGhhdC5wb2ludHNbMV0pO1xuICAgICAgfTtcbiAgICAgIE1hbmlmb2xkMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV91bnNldDtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5sb2NhbE5vcm1hbCk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubG9jYWxQb2ludCk7XG4gICAgICAgIHRoaXMucG9pbnRDb3VudCA9IDA7XG4gICAgICAgIHRoaXMucG9pbnRzWzBdLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5wb2ludHNbMV0ucmVjeWNsZSgpO1xuICAgICAgfTtcbiAgICAgIE1hbmlmb2xkMi5wcm90b3R5cGUuZ2V0V29ybGRNYW5pZm9sZCA9IGZ1bmN0aW9uKHdtLCB4ZkEyLCByYWRpdXNBLCB4ZkIyLCByYWRpdXNCKSB7XG4gICAgICAgIGlmICh0aGlzLnBvaW50Q291bnQgPT0gMCkge1xuICAgICAgICAgIHJldHVybiB3bTtcbiAgICAgICAgfVxuICAgICAgICB3bSA9IHdtIHx8IG5ldyBXb3JsZE1hbmlmb2xkKCk7XG4gICAgICAgIHdtLnBvaW50Q291bnQgPSB0aGlzLnBvaW50Q291bnQ7XG4gICAgICAgIHZhciBub3JtYWwzID0gd20ubm9ybWFsO1xuICAgICAgICB2YXIgcG9pbnRzID0gd20ucG9pbnRzO1xuICAgICAgICB2YXIgc2VwYXJhdGlvbnMgPSB3bS5zZXBhcmF0aW9ucztcbiAgICAgICAgc3dpdGNoICh0aGlzLnR5cGUpIHtcbiAgICAgICAgICBjYXNlIGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2NpcmNsZXM6IHtcbiAgICAgICAgICAgIHNldFZlYzIobm9ybWFsMywgMSwgMCk7XG4gICAgICAgICAgICB2YXIgbWFuaWZvbGRQb2ludCA9IHRoaXMucG9pbnRzWzBdO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEEkMSwgeGZBMiwgdGhpcy5sb2NhbFBvaW50KTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRCJDEsIHhmQjIsIG1hbmlmb2xkUG9pbnQubG9jYWxQb2ludCk7XG4gICAgICAgICAgICBzdWJWZWMyKGRpc3QsIHBvaW50QiQxLCBwb2ludEEkMSk7XG4gICAgICAgICAgICB2YXIgbGVuZ3RoU3FyID0gbGVuZ3RoU3FyVmVjMihkaXN0KTtcbiAgICAgICAgICAgIGlmIChsZW5ndGhTcXIgPiBFUFNJTE9OICogRVBTSUxPTikge1xuICAgICAgICAgICAgICB2YXIgbGVuZ3RoXzEgPSBtYXRoX3NxcnQkMihsZW5ndGhTcXIpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsMywgMSAvIGxlbmd0aF8xLCBkaXN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbWJpbmUyVmVjMihjQSQxLCAxLCBwb2ludEEkMSwgcmFkaXVzQSwgbm9ybWFsMyk7XG4gICAgICAgICAgICBjb21iaW5lMlZlYzIoY0IkMSwgMSwgcG9pbnRCJDEsIC1yYWRpdXNCLCBub3JtYWwzKTtcbiAgICAgICAgICAgIGNvbWJpbmUyVmVjMihwb2ludHNbMF0sIDAuNSwgY0EkMSwgMC41LCBjQiQxKTtcbiAgICAgICAgICAgIHNlcGFyYXRpb25zWzBdID0gZG90VmVjMihzdWJWZWMyKHRlbXAkMywgY0IkMSwgY0EkMSksIG5vcm1hbDMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhc2UgZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUE6IHtcbiAgICAgICAgICAgIHJvdFZlYzIobm9ybWFsMywgeGZBMi5xLCB0aGlzLmxvY2FsTm9ybWFsKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocGxhbmVQb2ludCQyLCB4ZkEyLCB0aGlzLmxvY2FsUG9pbnQpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBvaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgICB2YXIgbWFuaWZvbGRQb2ludCA9IHRoaXMucG9pbnRzW2ldO1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKGNsaXBQb2ludCQxLCB4ZkIyLCBtYW5pZm9sZFBvaW50LmxvY2FsUG9pbnQpO1xuICAgICAgICAgICAgICBjb21iaW5lMlZlYzIoY0EkMSwgMSwgY2xpcFBvaW50JDEsIHJhZGl1c0EgLSBkb3RWZWMyKHN1YlZlYzIodGVtcCQzLCBjbGlwUG9pbnQkMSwgcGxhbmVQb2ludCQyKSwgbm9ybWFsMyksIG5vcm1hbDMpO1xuICAgICAgICAgICAgICBjb21iaW5lMlZlYzIoY0IkMSwgMSwgY2xpcFBvaW50JDEsIC1yYWRpdXNCLCBub3JtYWwzKTtcbiAgICAgICAgICAgICAgY29tYmluZTJWZWMyKHBvaW50c1tpXSwgMC41LCBjQSQxLCAwLjUsIGNCJDEpO1xuICAgICAgICAgICAgICBzZXBhcmF0aW9uc1tpXSA9IGRvdFZlYzIoc3ViVmVjMih0ZW1wJDMsIGNCJDEsIGNBJDEpLCBub3JtYWwzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VCOiB7XG4gICAgICAgICAgICByb3RWZWMyKG5vcm1hbDMsIHhmQjIucSwgdGhpcy5sb2NhbE5vcm1hbCk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBsYW5lUG9pbnQkMiwgeGZCMiwgdGhpcy5sb2NhbFBvaW50KTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wb2ludENvdW50OyArK2kpIHtcbiAgICAgICAgICAgICAgdmFyIG1hbmlmb2xkUG9pbnQgPSB0aGlzLnBvaW50c1tpXTtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihjbGlwUG9pbnQkMSwgeGZBMiwgbWFuaWZvbGRQb2ludC5sb2NhbFBvaW50KTtcbiAgICAgICAgICAgICAgY29tYmluZTJWZWMyKGNCJDEsIDEsIGNsaXBQb2ludCQxLCByYWRpdXNCIC0gZG90VmVjMihzdWJWZWMyKHRlbXAkMywgY2xpcFBvaW50JDEsIHBsYW5lUG9pbnQkMiksIG5vcm1hbDMpLCBub3JtYWwzKTtcbiAgICAgICAgICAgICAgY29tYmluZTJWZWMyKGNBJDEsIDEsIGNsaXBQb2ludCQxLCAtcmFkaXVzQSwgbm9ybWFsMyk7XG4gICAgICAgICAgICAgIGNvbWJpbmUyVmVjMihwb2ludHNbaV0sIDAuNSwgY0EkMSwgMC41LCBjQiQxKTtcbiAgICAgICAgICAgICAgc2VwYXJhdGlvbnNbaV0gPSBkb3RWZWMyKHN1YlZlYzIodGVtcCQzLCBjQSQxLCBjQiQxKSwgbm9ybWFsMyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZWdWZWMyKG5vcm1hbDMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3bTtcbiAgICAgIH07XG4gICAgICBNYW5pZm9sZDIuY2xpcFNlZ21lbnRUb0xpbmUgPSBjbGlwU2VnbWVudFRvTGluZTtcbiAgICAgIE1hbmlmb2xkMi5DbGlwVmVydGV4ID0gQ2xpcFZlcnRleDtcbiAgICAgIE1hbmlmb2xkMi5nZXRQb2ludFN0YXRlcyA9IGdldFBvaW50U3RhdGVzO1xuICAgICAgTWFuaWZvbGQyLlBvaW50U3RhdGUgPSBleHBvcnRzMi5Qb2ludFN0YXRlO1xuICAgICAgcmV0dXJuIE1hbmlmb2xkMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIE1hbmlmb2xkUG9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gTWFuaWZvbGRQb2ludDIoKSB7XG4gICAgICAgIHRoaXMubG9jYWxQb2ludCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMubm9ybWFsSW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMudGFuZ2VudEltcHVsc2UgPSAwO1xuICAgICAgICB0aGlzLmlkID0gbmV3IENvbnRhY3RJRCgpO1xuICAgICAgfVxuICAgICAgTWFuaWZvbGRQb2ludDIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRoYXQpIHtcbiAgICAgICAgY29weVZlYzIodGhpcy5sb2NhbFBvaW50LCB0aGF0LmxvY2FsUG9pbnQpO1xuICAgICAgICB0aGlzLm5vcm1hbEltcHVsc2UgPSB0aGF0Lm5vcm1hbEltcHVsc2U7XG4gICAgICAgIHRoaXMudGFuZ2VudEltcHVsc2UgPSB0aGF0LnRhbmdlbnRJbXB1bHNlO1xuICAgICAgICB0aGlzLmlkLnNldCh0aGF0LmlkKTtcbiAgICAgIH07XG4gICAgICBNYW5pZm9sZFBvaW50Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB6ZXJvVmVjMih0aGlzLmxvY2FsUG9pbnQpO1xuICAgICAgICB0aGlzLm5vcm1hbEltcHVsc2UgPSAwO1xuICAgICAgICB0aGlzLnRhbmdlbnRJbXB1bHNlID0gMDtcbiAgICAgICAgdGhpcy5pZC5yZWN5Y2xlKCk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIE1hbmlmb2xkUG9pbnQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgQ29udGFjdElEID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIENvbnRhY3RJRDIoKSB7XG4gICAgICAgIHRoaXMua2V5ID0gLTE7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gLTE7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gLTE7XG4gICAgICAgIHRoaXMudHlwZUEgPSBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV91bnNldDtcbiAgICAgICAgdGhpcy50eXBlQiA9IGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3Vuc2V0O1xuICAgICAgfVxuICAgICAgQ29udGFjdElEMi5wcm90b3R5cGUuc2V0RmVhdHVyZXMgPSBmdW5jdGlvbihpbmRleEEsIHR5cGVBLCBpbmRleEIsIHR5cGVCKSB7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gaW5kZXhBO1xuICAgICAgICB0aGlzLmluZGV4QiA9IGluZGV4QjtcbiAgICAgICAgdGhpcy50eXBlQSA9IHR5cGVBO1xuICAgICAgICB0aGlzLnR5cGVCID0gdHlwZUI7XG4gICAgICAgIHRoaXMua2V5ID0gdGhpcy5pbmRleEEgKyB0aGlzLmluZGV4QiAqIDQgKyB0aGlzLnR5cGVBICogMTYgKyB0aGlzLnR5cGVCICogNjQ7XG4gICAgICB9O1xuICAgICAgQ29udGFjdElEMi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24odGhhdCkge1xuICAgICAgICB0aGlzLmluZGV4QSA9IHRoYXQuaW5kZXhBO1xuICAgICAgICB0aGlzLmluZGV4QiA9IHRoYXQuaW5kZXhCO1xuICAgICAgICB0aGlzLnR5cGVBID0gdGhhdC50eXBlQTtcbiAgICAgICAgdGhpcy50eXBlQiA9IHRoYXQudHlwZUI7XG4gICAgICAgIHRoaXMua2V5ID0gdGhpcy5pbmRleEEgKyB0aGlzLmluZGV4QiAqIDQgKyB0aGlzLnR5cGVBICogMTYgKyB0aGlzLnR5cGVCICogNjQ7XG4gICAgICB9O1xuICAgICAgQ29udGFjdElEMi5wcm90b3R5cGUuc3dhcEZlYXR1cmVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpbmRleEEgPSB0aGlzLmluZGV4QTtcbiAgICAgICAgdmFyIGluZGV4QiA9IHRoaXMuaW5kZXhCO1xuICAgICAgICB2YXIgdHlwZUEgPSB0aGlzLnR5cGVBO1xuICAgICAgICB2YXIgdHlwZUIgPSB0aGlzLnR5cGVCO1xuICAgICAgICB0aGlzLmluZGV4QSA9IGluZGV4QjtcbiAgICAgICAgdGhpcy5pbmRleEIgPSBpbmRleEE7XG4gICAgICAgIHRoaXMudHlwZUEgPSB0eXBlQjtcbiAgICAgICAgdGhpcy50eXBlQiA9IHR5cGVBO1xuICAgICAgICB0aGlzLmtleSA9IHRoaXMuaW5kZXhBICsgdGhpcy5pbmRleEIgKiA0ICsgdGhpcy50eXBlQSAqIDE2ICsgdGhpcy50eXBlQiAqIDY0O1xuICAgICAgfTtcbiAgICAgIENvbnRhY3RJRDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAwO1xuICAgICAgICB0aGlzLmluZGV4QiA9IDA7XG4gICAgICAgIHRoaXMudHlwZUEgPSBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV91bnNldDtcbiAgICAgICAgdGhpcy50eXBlQiA9IGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLmtleSA9IC0xO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBDb250YWN0SUQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgV29ybGRNYW5pZm9sZCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBXb3JsZE1hbmlmb2xkMigpIHtcbiAgICAgICAgdGhpcy5ub3JtYWwgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnBvaW50cyA9IFt2ZWMyKDAsIDApLCB2ZWMyKDAsIDApXTtcbiAgICAgICAgdGhpcy5zZXBhcmF0aW9ucyA9IFswLCAwXTtcbiAgICAgICAgdGhpcy5wb2ludENvdW50ID0gMDtcbiAgICAgIH1cbiAgICAgIFdvcmxkTWFuaWZvbGQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubm9ybWFsKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5wb2ludHNbMF0pO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBvaW50c1sxXSk7XG4gICAgICAgIHRoaXMuc2VwYXJhdGlvbnNbMF0gPSAwO1xuICAgICAgICB0aGlzLnNlcGFyYXRpb25zWzFdID0gMDtcbiAgICAgICAgdGhpcy5wb2ludENvdW50ID0gMDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gV29ybGRNYW5pZm9sZDI7XG4gICAgfSgpXG4gICk7XG4gIGZ1bmN0aW9uIGdldFBvaW50U3RhdGVzKHN0YXRlMSwgc3RhdGUyLCBtYW5pZm9sZDEsIG1hbmlmb2xkMikge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFuaWZvbGQxLnBvaW50Q291bnQ7ICsraSkge1xuICAgICAgdmFyIGlkID0gbWFuaWZvbGQxLnBvaW50c1tpXS5pZDtcbiAgICAgIHN0YXRlMVtpXSA9IGV4cG9ydHMyLlBvaW50U3RhdGUucmVtb3ZlU3RhdGU7XG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1hbmlmb2xkMi5wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgaWYgKG1hbmlmb2xkMi5wb2ludHNbal0uaWQua2V5ID09PSBpZC5rZXkpIHtcbiAgICAgICAgICBzdGF0ZTFbaV0gPSBleHBvcnRzMi5Qb2ludFN0YXRlLnBlcnNpc3RTdGF0ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hbmlmb2xkMi5wb2ludENvdW50OyArK2kpIHtcbiAgICAgIHZhciBpZCA9IG1hbmlmb2xkMi5wb2ludHNbaV0uaWQ7XG4gICAgICBzdGF0ZTJbaV0gPSBleHBvcnRzMi5Qb2ludFN0YXRlLmFkZFN0YXRlO1xuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBtYW5pZm9sZDEucG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgIGlmIChtYW5pZm9sZDEucG9pbnRzW2pdLmlkLmtleSA9PT0gaWQua2V5KSB7XG4gICAgICAgICAgc3RhdGUyW2ldID0gZXhwb3J0czIuUG9pbnRTdGF0ZS5wZXJzaXN0U3RhdGU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gY2xpcFNlZ21lbnRUb0xpbmUodk91dCwgdkluLCBub3JtYWwzLCBvZmZzZXQsIHZlcnRleEluZGV4QSkge1xuICAgIHZhciBudW1PdXQgPSAwO1xuICAgIHZhciBkaXN0YW5jZTAgPSBkb3RWZWMyKG5vcm1hbDMsIHZJblswXS52KSAtIG9mZnNldDtcbiAgICB2YXIgZGlzdGFuY2UxID0gZG90VmVjMihub3JtYWwzLCB2SW5bMV0udikgLSBvZmZzZXQ7XG4gICAgaWYgKGRpc3RhbmNlMCA8PSAwKVxuICAgICAgdk91dFtudW1PdXQrK10uc2V0KHZJblswXSk7XG4gICAgaWYgKGRpc3RhbmNlMSA8PSAwKVxuICAgICAgdk91dFtudW1PdXQrK10uc2V0KHZJblsxXSk7XG4gICAgaWYgKGRpc3RhbmNlMCAqIGRpc3RhbmNlMSA8IDApIHtcbiAgICAgIHZhciBpbnRlcnAgPSBkaXN0YW5jZTAgLyAoZGlzdGFuY2UwIC0gZGlzdGFuY2UxKTtcbiAgICAgIGNvbWJpbmUyVmVjMih2T3V0W251bU91dF0udiwgMSAtIGludGVycCwgdkluWzBdLnYsIGludGVycCwgdkluWzFdLnYpO1xuICAgICAgdk91dFtudW1PdXRdLmlkLnNldEZlYXR1cmVzKHZlcnRleEluZGV4QSwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCB2SW5bMF0uaWQuaW5kZXhCLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV9mYWNlKTtcbiAgICAgICsrbnVtT3V0O1xuICAgIH1cbiAgICByZXR1cm4gbnVtT3V0O1xuICB9XG4gIHZhciBtYXRoX3NxcnQkMSA9IE1hdGguc3FydDtcbiAgdmFyIG1hdGhfbWF4JDIgPSBNYXRoLm1heDtcbiAgdmFyIG1hdGhfbWluJDQgPSBNYXRoLm1pbjtcbiAgdmFyIGNvbnRhY3RQb29sID0gbmV3IFBvb2woe1xuICAgIGNyZWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbmV3IENvbnRhY3QoKTtcbiAgICB9LFxuICAgIHJlbGVhc2U6IGZ1bmN0aW9uKGNvbnRhY3QpIHtcbiAgICAgIGNvbnRhY3QucmVjeWNsZSgpO1xuICAgIH1cbiAgfSk7XG4gIHZhciBvbGRNYW5pZm9sZCA9IG5ldyBNYW5pZm9sZCgpO1xuICB2YXIgd29ybGRNYW5pZm9sZCA9IG5ldyBXb3JsZE1hbmlmb2xkKCk7XG4gIHZhciBDb250YWN0RWRnZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBDb250YWN0RWRnZTIoY29udGFjdCkge1xuICAgICAgICB0aGlzLnByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm5leHQgPSBudWxsO1xuICAgICAgICB0aGlzLm90aGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5jb250YWN0ID0gY29udGFjdDtcbiAgICAgIH1cbiAgICAgIENvbnRhY3RFZGdlMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm5leHQgPSBudWxsO1xuICAgICAgICB0aGlzLm90aGVyID0gbnVsbDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gQ29udGFjdEVkZ2UyO1xuICAgIH0oKVxuICApO1xuICBmdW5jdGlvbiBtaXhGcmljdGlvbihmcmljdGlvbjEsIGZyaWN0aW9uMikge1xuICAgIHJldHVybiBtYXRoX3NxcnQkMShmcmljdGlvbjEgKiBmcmljdGlvbjIpO1xuICB9XG4gIGZ1bmN0aW9uIG1peFJlc3RpdHV0aW9uKHJlc3RpdHV0aW9uMSwgcmVzdGl0dXRpb24yKSB7XG4gICAgcmV0dXJuIHJlc3RpdHV0aW9uMSA+IHJlc3RpdHV0aW9uMiA/IHJlc3RpdHV0aW9uMSA6IHJlc3RpdHV0aW9uMjtcbiAgfVxuICB2YXIgc19yZWdpc3RlcnMgPSBbXTtcbiAgdmFyIFZlbG9jaXR5Q29uc3RyYWludFBvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFZlbG9jaXR5Q29uc3RyYWludFBvaW50MigpIHtcbiAgICAgICAgdGhpcy5yQSA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMuckIgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLm5vcm1hbEltcHVsc2UgPSAwO1xuICAgICAgICB0aGlzLnRhbmdlbnRJbXB1bHNlID0gMDtcbiAgICAgICAgdGhpcy5ub3JtYWxNYXNzID0gMDtcbiAgICAgICAgdGhpcy50YW5nZW50TWFzcyA9IDA7XG4gICAgICAgIHRoaXMudmVsb2NpdHlCaWFzID0gMDtcbiAgICAgIH1cbiAgICAgIFZlbG9jaXR5Q29uc3RyYWludFBvaW50Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnJBKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5yQik7XG4gICAgICAgIHRoaXMubm9ybWFsSW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMudGFuZ2VudEltcHVsc2UgPSAwO1xuICAgICAgICB0aGlzLm5vcm1hbE1hc3MgPSAwO1xuICAgICAgICB0aGlzLnRhbmdlbnRNYXNzID0gMDtcbiAgICAgICAgdGhpcy52ZWxvY2l0eUJpYXMgPSAwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBWZWxvY2l0eUNvbnN0cmFpbnRQb2ludDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBjQSA9IHZlYzIoMCwgMCk7XG4gIHZhciB2QSA9IHZlYzIoMCwgMCk7XG4gIHZhciBjQiA9IHZlYzIoMCwgMCk7XG4gIHZhciB2QiA9IHZlYzIoMCwgMCk7XG4gIHZhciB0YW5nZW50JDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgeGZBID0gdHJhbnNmb3JtKDAsIDAsIDApO1xuICB2YXIgeGZCID0gdHJhbnNmb3JtKDAsIDAsIDApO1xuICB2YXIgcG9pbnRBID0gdmVjMigwLCAwKTtcbiAgdmFyIHBvaW50QiA9IHZlYzIoMCwgMCk7XG4gIHZhciBjbGlwUG9pbnQgPSB2ZWMyKDAsIDApO1xuICB2YXIgcGxhbmVQb2ludCQxID0gdmVjMigwLCAwKTtcbiAgdmFyIHJBID0gdmVjMigwLCAwKTtcbiAgdmFyIHJCID0gdmVjMigwLCAwKTtcbiAgdmFyIFAkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBub3JtYWwkMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBwb2ludCA9IHZlYzIoMCwgMCk7XG4gIHZhciBkdiA9IHZlYzIoMCwgMCk7XG4gIHZhciBkdjEgPSB2ZWMyKDAsIDApO1xuICB2YXIgZHYyID0gdmVjMigwLCAwKTtcbiAgdmFyIGIgPSB2ZWMyKDAsIDApO1xuICB2YXIgYSA9IHZlYzIoMCwgMCk7XG4gIHZhciB4ID0gdmVjMigwLCAwKTtcbiAgdmFyIGQgPSB2ZWMyKDAsIDApO1xuICB2YXIgUDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgUDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgdGVtcCQyID0gdmVjMigwLCAwKTtcbiAgdmFyIENvbnRhY3QgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gQ29udGFjdDIoKSB7XG4gICAgICAgIHRoaXMubV9ub2RlQSA9IG5ldyBDb250YWN0RWRnZSh0aGlzKTtcbiAgICAgICAgdGhpcy5tX25vZGVCID0gbmV3IENvbnRhY3RFZGdlKHRoaXMpO1xuICAgICAgICB0aGlzLm1fZml4dHVyZUEgPSBudWxsO1xuICAgICAgICB0aGlzLm1fZml4dHVyZUIgPSBudWxsO1xuICAgICAgICB0aGlzLm1faW5kZXhBID0gLTE7XG4gICAgICAgIHRoaXMubV9pbmRleEIgPSAtMTtcbiAgICAgICAgdGhpcy5tX2V2YWx1YXRlRmNuID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX21hbmlmb2xkID0gbmV3IE1hbmlmb2xkKCk7XG4gICAgICAgIHRoaXMubV9wcmV2ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX25leHQgPSBudWxsO1xuICAgICAgICB0aGlzLm1fdG9pID0gMTtcbiAgICAgICAgdGhpcy5tX3RvaUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5tX3RvaUZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gMDtcbiAgICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gMDtcbiAgICAgICAgdGhpcy5tX3RhbmdlbnRTcGVlZCA9IDA7XG4gICAgICAgIHRoaXMubV9lbmFibGVkRmxhZyA9IHRydWU7XG4gICAgICAgIHRoaXMubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV90b3VjaGluZ0ZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2J1bGxldEhpdEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSBuZXcgQ29udGFjdEltcHVsc2UodGhpcyk7XG4gICAgICAgIHRoaXMudl9wb2ludHMgPSBbbmV3IFZlbG9jaXR5Q29uc3RyYWludFBvaW50KCksIG5ldyBWZWxvY2l0eUNvbnN0cmFpbnRQb2ludCgpXTtcbiAgICAgICAgdGhpcy52X25vcm1hbCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMudl9ub3JtYWxNYXNzID0gbmV3IE1hdDIyKCk7XG4gICAgICAgIHRoaXMudl9LID0gbmV3IE1hdDIyKCk7XG4gICAgICAgIHRoaXMudl9wb2ludENvdW50ID0gMDtcbiAgICAgICAgdGhpcy52X3RhbmdlbnRTcGVlZCA9IDA7XG4gICAgICAgIHRoaXMudl9mcmljdGlvbiA9IDA7XG4gICAgICAgIHRoaXMudl9yZXN0aXR1dGlvbiA9IDA7XG4gICAgICAgIHRoaXMudl9pbnZNYXNzQSA9IDA7XG4gICAgICAgIHRoaXMudl9pbnZNYXNzQiA9IDA7XG4gICAgICAgIHRoaXMudl9pbnZJQSA9IDA7XG4gICAgICAgIHRoaXMudl9pbnZJQiA9IDA7XG4gICAgICAgIHRoaXMucF9sb2NhbFBvaW50cyA9IFt2ZWMyKDAsIDApLCB2ZWMyKDAsIDApXTtcbiAgICAgICAgdGhpcy5wX2xvY2FsTm9ybWFsID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5wX2xvY2FsUG9pbnQgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnBfbG9jYWxDZW50ZXJBID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5wX2xvY2FsQ2VudGVyQiA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMucF90eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfdW5zZXQ7XG4gICAgICAgIHRoaXMucF9yYWRpdXNBID0gMDtcbiAgICAgICAgdGhpcy5wX3JhZGl1c0IgPSAwO1xuICAgICAgICB0aGlzLnBfcG9pbnRDb3VudCA9IDA7XG4gICAgICAgIHRoaXMucF9pbnZNYXNzQSA9IDA7XG4gICAgICAgIHRoaXMucF9pbnZNYXNzQiA9IDA7XG4gICAgICAgIHRoaXMucF9pbnZJQSA9IDA7XG4gICAgICAgIHRoaXMucF9pbnZJQiA9IDA7XG4gICAgICB9XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKGZBLCBpbmRleEEsIGZCLCBpbmRleEIsIGV2YWx1YXRlRmNuKSB7XG4gICAgICAgIHRoaXMubV9maXh0dXJlQSA9IGZBO1xuICAgICAgICB0aGlzLm1fZml4dHVyZUIgPSBmQjtcbiAgICAgICAgdGhpcy5tX2luZGV4QSA9IGluZGV4QTtcbiAgICAgICAgdGhpcy5tX2luZGV4QiA9IGluZGV4QjtcbiAgICAgICAgdGhpcy5tX2V2YWx1YXRlRmNuID0gZXZhbHVhdGVGY247XG4gICAgICAgIHRoaXMubV9mcmljdGlvbiA9IG1peEZyaWN0aW9uKHRoaXMubV9maXh0dXJlQS5tX2ZyaWN0aW9uLCB0aGlzLm1fZml4dHVyZUIubV9mcmljdGlvbik7XG4gICAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IG1peFJlc3RpdHV0aW9uKHRoaXMubV9maXh0dXJlQS5tX3Jlc3RpdHV0aW9uLCB0aGlzLm1fZml4dHVyZUIubV9yZXN0aXR1dGlvbik7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX25vZGVBLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5tX25vZGVCLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5tX2ZpeHR1cmVBID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2ZpeHR1cmVCID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2luZGV4QSA9IC0xO1xuICAgICAgICB0aGlzLm1faW5kZXhCID0gLTE7XG4gICAgICAgIHRoaXMubV9ldmFsdWF0ZUZjbiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9tYW5pZm9sZC5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMubV9wcmV2ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX25leHQgPSBudWxsO1xuICAgICAgICB0aGlzLm1fdG9pID0gMTtcbiAgICAgICAgdGhpcy5tX3RvaUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5tX3RvaUZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gMDtcbiAgICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gMDtcbiAgICAgICAgdGhpcy5tX3RhbmdlbnRTcGVlZCA9IDA7XG4gICAgICAgIHRoaXMubV9lbmFibGVkRmxhZyA9IHRydWU7XG4gICAgICAgIHRoaXMubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV90b3VjaGluZ0ZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2J1bGxldEhpdEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UucmVjeWNsZSgpO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hMiA9IHRoaXMudl9wb2ludHM7IF9pIDwgX2EyLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgIHZhciBwb2ludF8xID0gX2EyW19pXTtcbiAgICAgICAgICBwb2ludF8xLnJlY3ljbGUoKTtcbiAgICAgICAgfVxuICAgICAgICB6ZXJvVmVjMih0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgdGhpcy52X25vcm1hbE1hc3Muc2V0WmVybygpO1xuICAgICAgICB0aGlzLnZfSy5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMudl9wb2ludENvdW50ID0gMDtcbiAgICAgICAgdGhpcy52X3RhbmdlbnRTcGVlZCA9IDA7XG4gICAgICAgIHRoaXMudl9mcmljdGlvbiA9IDA7XG4gICAgICAgIHRoaXMudl9yZXN0aXR1dGlvbiA9IDA7XG4gICAgICAgIHRoaXMudl9pbnZNYXNzQSA9IDA7XG4gICAgICAgIHRoaXMudl9pbnZNYXNzQiA9IDA7XG4gICAgICAgIHRoaXMudl9pbnZJQSA9IDA7XG4gICAgICAgIHRoaXMudl9pbnZJQiA9IDA7XG4gICAgICAgIGZvciAodmFyIF9iID0gMCwgX2MgPSB0aGlzLnBfbG9jYWxQb2ludHM7IF9iIDwgX2MubGVuZ3RoOyBfYisrKSB7XG4gICAgICAgICAgdmFyIHBvaW50XzIgPSBfY1tfYl07XG4gICAgICAgICAgemVyb1ZlYzIocG9pbnRfMik7XG4gICAgICAgIH1cbiAgICAgICAgemVyb1ZlYzIodGhpcy5wX2xvY2FsTm9ybWFsKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5wX2xvY2FsUG9pbnQpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBfbG9jYWxDZW50ZXJBKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5wX2xvY2FsQ2VudGVyQik7XG4gICAgICAgIHRoaXMucF90eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfdW5zZXQ7XG4gICAgICAgIHRoaXMucF9yYWRpdXNBID0gMDtcbiAgICAgICAgdGhpcy5wX3JhZGl1c0IgPSAwO1xuICAgICAgICB0aGlzLnBfcG9pbnRDb3VudCA9IDA7XG4gICAgICAgIHRoaXMucF9pbnZNYXNzQSA9IDA7XG4gICAgICAgIHRoaXMucF9pbnZNYXNzQiA9IDA7XG4gICAgICAgIHRoaXMucF9pbnZJQSA9IDA7XG4gICAgICAgIHRoaXMucF9pbnZJQiA9IDA7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmluaXRDb25zdHJhaW50ID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGlmIChib2R5QSA9PT0gbnVsbCB8fCBib2R5QiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBzaGFwZUEgPSBmaXh0dXJlQS5tX3NoYXBlO1xuICAgICAgICB2YXIgc2hhcGVCID0gZml4dHVyZUIubV9zaGFwZTtcbiAgICAgICAgaWYgKHNoYXBlQSA9PT0gbnVsbCB8fCBzaGFwZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgbWFuaWZvbGQgPSB0aGlzLm1fbWFuaWZvbGQ7XG4gICAgICAgIHZhciBwb2ludENvdW50ID0gbWFuaWZvbGQucG9pbnRDb3VudDtcbiAgICAgICAgdGhpcy52X2ludk1hc3NBID0gYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLnZfaW52TWFzc0IgPSBib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMudl9pbnZJQSA9IGJvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy52X2ludklCID0gYm9keUIubV9pbnZJO1xuICAgICAgICB0aGlzLnZfZnJpY3Rpb24gPSB0aGlzLm1fZnJpY3Rpb247XG4gICAgICAgIHRoaXMudl9yZXN0aXR1dGlvbiA9IHRoaXMubV9yZXN0aXR1dGlvbjtcbiAgICAgICAgdGhpcy52X3RhbmdlbnRTcGVlZCA9IHRoaXMubV90YW5nZW50U3BlZWQ7XG4gICAgICAgIHRoaXMudl9wb2ludENvdW50ID0gcG9pbnRDb3VudDtcbiAgICAgICAgdGhpcy52X0suc2V0WmVybygpO1xuICAgICAgICB0aGlzLnZfbm9ybWFsTWFzcy5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMucF9pbnZNYXNzQSA9IGJvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5wX2ludk1hc3NCID0gYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLnBfaW52SUEgPSBib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMucF9pbnZJQiA9IGJvZHlCLm1faW52STtcbiAgICAgICAgY29weVZlYzIodGhpcy5wX2xvY2FsQ2VudGVyQSwgYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcik7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMucF9sb2NhbENlbnRlckIsIGJvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXIpO1xuICAgICAgICB0aGlzLnBfcmFkaXVzQSA9IHNoYXBlQS5tX3JhZGl1cztcbiAgICAgICAgdGhpcy5wX3JhZGl1c0IgPSBzaGFwZUIubV9yYWRpdXM7XG4gICAgICAgIHRoaXMucF90eXBlID0gbWFuaWZvbGQudHlwZTtcbiAgICAgICAgY29weVZlYzIodGhpcy5wX2xvY2FsTm9ybWFsLCBtYW5pZm9sZC5sb2NhbE5vcm1hbCk7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMucF9sb2NhbFBvaW50LCBtYW5pZm9sZC5sb2NhbFBvaW50KTtcbiAgICAgICAgdGhpcy5wX3BvaW50Q291bnQgPSBwb2ludENvdW50O1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IFNldHRpbmdzSW50ZXJuYWwubWF4TWFuaWZvbGRQb2ludHM7ICsraikge1xuICAgICAgICAgIHRoaXMudl9wb2ludHNbal0ucmVjeWNsZSgpO1xuICAgICAgICAgIHplcm9WZWMyKHRoaXMucF9sb2NhbFBvaW50c1tqXSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBwb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICB2YXIgY3AgPSBtYW5pZm9sZC5wb2ludHNbal07XG4gICAgICAgICAgdmFyIHZjcCA9IHRoaXMudl9wb2ludHNbal07XG4gICAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgICB2Y3Aubm9ybWFsSW1wdWxzZSA9IHN0ZXAuZHRSYXRpbyAqIGNwLm5vcm1hbEltcHVsc2U7XG4gICAgICAgICAgICB2Y3AudGFuZ2VudEltcHVsc2UgPSBzdGVwLmR0UmF0aW8gKiBjcC50YW5nZW50SW1wdWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29weVZlYzIodGhpcy5wX2xvY2FsUG9pbnRzW2pdLCBjcC5sb2NhbFBvaW50KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXRNYW5pZm9sZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21hbmlmb2xkO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXRXb3JsZE1hbmlmb2xkID0gZnVuY3Rpb24od29ybGRNYW5pZm9sZDIpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgc2hhcGVBID0gZml4dHVyZUEubV9zaGFwZTtcbiAgICAgICAgdmFyIHNoYXBlQiA9IGZpeHR1cmVCLm1fc2hhcGU7XG4gICAgICAgIGlmIChzaGFwZUEgPT09IG51bGwgfHwgc2hhcGVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYW5pZm9sZC5nZXRXb3JsZE1hbmlmb2xkKHdvcmxkTWFuaWZvbGQyLCBib2R5QS5nZXRUcmFuc2Zvcm0oKSwgc2hhcGVBLm1fcmFkaXVzLCBib2R5Qi5nZXRUcmFuc2Zvcm0oKSwgc2hhcGVCLm1fcmFkaXVzKTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc2V0RW5hYmxlZCA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX2VuYWJsZWRGbGFnID0gISFmbGFnO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5pc0VuYWJsZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9lbmFibGVkRmxhZztcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuaXNUb3VjaGluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RvdWNoaW5nRmxhZztcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0TmV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX25leHQ7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldEZpeHR1cmVBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZml4dHVyZUE7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldEZpeHR1cmVCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZml4dHVyZUI7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldENoaWxkSW5kZXhBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1faW5kZXhBO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXRDaGlsZEluZGV4QiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2luZGV4QjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZmxhZ0ZvckZpbHRlcmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fZmlsdGVyRmxhZyA9IHRydWU7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnNldEZyaWN0aW9uID0gZnVuY3Rpb24oZnJpY3Rpb24pIHtcbiAgICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gZnJpY3Rpb247XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldEZyaWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZnJpY3Rpb247XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnJlc2V0RnJpY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9mcmljdGlvbiA9IG1peEZyaWN0aW9uKGZpeHR1cmVBLm1fZnJpY3Rpb24sIGZpeHR1cmVCLm1fZnJpY3Rpb24pO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zZXRSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uKHJlc3RpdHV0aW9uKSB7XG4gICAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IHJlc3RpdHV0aW9uO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXRSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3Jlc3RpdHV0aW9uO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5yZXNldFJlc3RpdHV0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSBtaXhSZXN0aXR1dGlvbihmaXh0dXJlQS5tX3Jlc3RpdHV0aW9uLCBmaXh0dXJlQi5tX3Jlc3RpdHV0aW9uKTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc2V0VGFuZ2VudFNwZWVkID0gZnVuY3Rpb24oc3BlZWQpIHtcbiAgICAgICAgdGhpcy5tX3RhbmdlbnRTcGVlZCA9IHNwZWVkO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXRUYW5nZW50U3BlZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90YW5nZW50U3BlZWQ7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmV2YWx1YXRlID0gZnVuY3Rpb24obWFuaWZvbGQsIHhmQTIsIHhmQjIpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ldmFsdWF0ZUZjbihtYW5pZm9sZCwgeGZBMiwgZml4dHVyZUEsIHRoaXMubV9pbmRleEEsIHhmQjIsIGZpeHR1cmVCLCB0aGlzLm1faW5kZXhCKTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24obGlzdGVuZXIpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgc2hhcGVBID0gZml4dHVyZUEubV9zaGFwZTtcbiAgICAgICAgdmFyIHNoYXBlQiA9IGZpeHR1cmVCLm1fc2hhcGU7XG4gICAgICAgIGlmIChzaGFwZUEgPT09IG51bGwgfHwgc2hhcGVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2VuYWJsZWRGbGFnID0gdHJ1ZTtcbiAgICAgICAgdmFyIHRvdWNoaW5nID0gZmFsc2U7XG4gICAgICAgIHZhciB3YXNUb3VjaGluZyA9IHRoaXMubV90b3VjaGluZ0ZsYWc7XG4gICAgICAgIHZhciBzZW5zb3JBID0gZml4dHVyZUEubV9pc1NlbnNvcjtcbiAgICAgICAgdmFyIHNlbnNvckIgPSBmaXh0dXJlQi5tX2lzU2Vuc29yO1xuICAgICAgICB2YXIgc2Vuc29yID0gc2Vuc29yQSB8fCBzZW5zb3JCO1xuICAgICAgICB2YXIgeGZBMiA9IGJvZHlBLm1feGY7XG4gICAgICAgIHZhciB4ZkIyID0gYm9keUIubV94ZjtcbiAgICAgICAgaWYgKHNlbnNvcikge1xuICAgICAgICAgIHRvdWNoaW5nID0gdGVzdE92ZXJsYXAoc2hhcGVBLCB0aGlzLm1faW5kZXhBLCBzaGFwZUIsIHRoaXMubV9pbmRleEIsIHhmQTIsIHhmQjIpO1xuICAgICAgICAgIHRoaXMubV9tYW5pZm9sZC5wb2ludENvdW50ID0gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvbGRNYW5pZm9sZC5yZWN5Y2xlKCk7XG4gICAgICAgICAgb2xkTWFuaWZvbGQuc2V0KHRoaXMubV9tYW5pZm9sZCk7XG4gICAgICAgICAgdGhpcy5tX21hbmlmb2xkLnJlY3ljbGUoKTtcbiAgICAgICAgICB0aGlzLmV2YWx1YXRlKHRoaXMubV9tYW5pZm9sZCwgeGZBMiwgeGZCMik7XG4gICAgICAgICAgdG91Y2hpbmcgPSB0aGlzLm1fbWFuaWZvbGQucG9pbnRDb3VudCA+IDA7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fbWFuaWZvbGQucG9pbnRDb3VudDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgbm1wID0gdGhpcy5tX21hbmlmb2xkLnBvaW50c1tpXTtcbiAgICAgICAgICAgIG5tcC5ub3JtYWxJbXB1bHNlID0gMDtcbiAgICAgICAgICAgIG5tcC50YW5nZW50SW1wdWxzZSA9IDA7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG9sZE1hbmlmb2xkLnBvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgICAgICB2YXIgb21wID0gb2xkTWFuaWZvbGQucG9pbnRzW2pdO1xuICAgICAgICAgICAgICBpZiAob21wLmlkLmtleSA9PT0gbm1wLmlkLmtleSkge1xuICAgICAgICAgICAgICAgIG5tcC5ub3JtYWxJbXB1bHNlID0gb21wLm5vcm1hbEltcHVsc2U7XG4gICAgICAgICAgICAgICAgbm1wLnRhbmdlbnRJbXB1bHNlID0gb21wLnRhbmdlbnRJbXB1bHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0b3VjaGluZyAhPT0gd2FzVG91Y2hpbmcpIHtcbiAgICAgICAgICAgIGJvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgICAgYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubV90b3VjaGluZ0ZsYWcgPSB0b3VjaGluZztcbiAgICAgICAgdmFyIGhhc0xpc3RlbmVyID0gdHlwZW9mIGxpc3RlbmVyID09PSBcIm9iamVjdFwiICYmIGxpc3RlbmVyICE9PSBudWxsO1xuICAgICAgICBpZiAoIXdhc1RvdWNoaW5nICYmIHRvdWNoaW5nICYmIGhhc0xpc3RlbmVyKSB7XG4gICAgICAgICAgbGlzdGVuZXIuYmVnaW5Db250YWN0KHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3YXNUb3VjaGluZyAmJiAhdG91Y2hpbmcgJiYgaGFzTGlzdGVuZXIpIHtcbiAgICAgICAgICBsaXN0ZW5lci5lbmRDb250YWN0KHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2Vuc29yICYmIHRvdWNoaW5nICYmIGhhc0xpc3RlbmVyICYmIG9sZE1hbmlmb2xkKSB7XG4gICAgICAgICAgbGlzdGVuZXIucHJlU29sdmUodGhpcywgb2xkTWFuaWZvbGQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50ID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc29sdmVQb3NpdGlvbkNvbnN0cmFpbnQoc3RlcCwgbnVsbCwgbnVsbCk7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50VE9JID0gZnVuY3Rpb24oc3RlcCwgdG9pQSwgdG9pQikge1xuICAgICAgICByZXR1cm4gdGhpcy5fc29sdmVQb3NpdGlvbkNvbnN0cmFpbnQoc3RlcCwgdG9pQSwgdG9pQik7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLl9zb2x2ZVBvc2l0aW9uQ29uc3RyYWludCA9IGZ1bmN0aW9uKHN0ZXAsIHRvaUEsIHRvaUIpIHtcbiAgICAgICAgdmFyIHRvaSA9IHRvaUEgIT09IG51bGwgJiYgdG9pQiAhPT0gbnVsbCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgdmFyIG1pblNlcGFyYXRpb24gPSAwO1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybiBtaW5TZXBhcmF0aW9uO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgaWYgKGJvZHlBID09PSBudWxsIHx8IGJvZHlCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybiBtaW5TZXBhcmF0aW9uO1xuICAgICAgICB2YXIgcG9zaXRpb25BID0gYm9keUEuY19wb3NpdGlvbjtcbiAgICAgICAgdmFyIHBvc2l0aW9uQiA9IGJvZHlCLmNfcG9zaXRpb247XG4gICAgICAgIHZhciBsb2NhbENlbnRlckEgPSB0aGlzLnBfbG9jYWxDZW50ZXJBO1xuICAgICAgICB2YXIgbG9jYWxDZW50ZXJCID0gdGhpcy5wX2xvY2FsQ2VudGVyQjtcbiAgICAgICAgdmFyIG1BID0gMDtcbiAgICAgICAgdmFyIGlBID0gMDtcbiAgICAgICAgaWYgKCF0b2kgfHwgYm9keUEgPT09IHRvaUEgfHwgYm9keUEgPT09IHRvaUIpIHtcbiAgICAgICAgICBtQSA9IHRoaXMucF9pbnZNYXNzQTtcbiAgICAgICAgICBpQSA9IHRoaXMucF9pbnZJQTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbUIgPSAwO1xuICAgICAgICB2YXIgaUIgPSAwO1xuICAgICAgICBpZiAoIXRvaSB8fCBib2R5QiA9PT0gdG9pQSB8fCBib2R5QiA9PT0gdG9pQikge1xuICAgICAgICAgIG1CID0gdGhpcy5wX2ludk1hc3NCO1xuICAgICAgICAgIGlCID0gdGhpcy5wX2ludklCO1xuICAgICAgICB9XG4gICAgICAgIGNvcHlWZWMyKGNBLCBwb3NpdGlvbkEuYyk7XG4gICAgICAgIHZhciBhQSA9IHBvc2l0aW9uQS5hO1xuICAgICAgICBjb3B5VmVjMihjQiwgcG9zaXRpb25CLmMpO1xuICAgICAgICB2YXIgYUIgPSBwb3NpdGlvbkIuYTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnBfcG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgZ2V0VHJhbnNmb3JtKHhmQSwgbG9jYWxDZW50ZXJBLCBjQSwgYUEpO1xuICAgICAgICAgIGdldFRyYW5zZm9ybSh4ZkIsIGxvY2FsQ2VudGVyQiwgY0IsIGFCKTtcbiAgICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IHZvaWQgMDtcbiAgICAgICAgICBzd2l0Y2ggKHRoaXMucF90eXBlKSB7XG4gICAgICAgICAgICBjYXNlIGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2NpcmNsZXM6IHtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEEsIHhmQSwgdGhpcy5wX2xvY2FsUG9pbnQpO1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QiwgeGZCLCB0aGlzLnBfbG9jYWxQb2ludHNbMF0pO1xuICAgICAgICAgICAgICBzdWJWZWMyKG5vcm1hbCQyLCBwb2ludEIsIHBvaW50QSk7XG4gICAgICAgICAgICAgIG5vcm1hbGl6ZVZlYzIobm9ybWFsJDIpO1xuICAgICAgICAgICAgICBjb21iaW5lMlZlYzIocG9pbnQsIDAuNSwgcG9pbnRBLCAwLjUsIHBvaW50Qik7XG4gICAgICAgICAgICAgIHNlcGFyYXRpb24gPSBkb3RWZWMyKHBvaW50Qiwgbm9ybWFsJDIpIC0gZG90VmVjMihwb2ludEEsIG5vcm1hbCQyKSAtIHRoaXMucF9yYWRpdXNBIC0gdGhpcy5wX3JhZGl1c0I7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQToge1xuICAgICAgICAgICAgICByb3RWZWMyKG5vcm1hbCQyLCB4ZkEucSwgdGhpcy5wX2xvY2FsTm9ybWFsKTtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwbGFuZVBvaW50JDEsIHhmQSwgdGhpcy5wX2xvY2FsUG9pbnQpO1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKGNsaXBQb2ludCwgeGZCLCB0aGlzLnBfbG9jYWxQb2ludHNbal0pO1xuICAgICAgICAgICAgICBzZXBhcmF0aW9uID0gZG90VmVjMihjbGlwUG9pbnQsIG5vcm1hbCQyKSAtIGRvdFZlYzIocGxhbmVQb2ludCQxLCBub3JtYWwkMikgLSB0aGlzLnBfcmFkaXVzQSAtIHRoaXMucF9yYWRpdXNCO1xuICAgICAgICAgICAgICBjb3B5VmVjMihwb2ludCwgY2xpcFBvaW50KTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VCOiB7XG4gICAgICAgICAgICAgIHJvdFZlYzIobm9ybWFsJDIsIHhmQi5xLCB0aGlzLnBfbG9jYWxOb3JtYWwpO1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBsYW5lUG9pbnQkMSwgeGZCLCB0aGlzLnBfbG9jYWxQb2ludCk7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIoY2xpcFBvaW50LCB4ZkEsIHRoaXMucF9sb2NhbFBvaW50c1tqXSk7XG4gICAgICAgICAgICAgIHNlcGFyYXRpb24gPSBkb3RWZWMyKGNsaXBQb2ludCwgbm9ybWFsJDIpIC0gZG90VmVjMihwbGFuZVBvaW50JDEsIG5vcm1hbCQyKSAtIHRoaXMucF9yYWRpdXNBIC0gdGhpcy5wX3JhZGl1c0I7XG4gICAgICAgICAgICAgIGNvcHlWZWMyKHBvaW50LCBjbGlwUG9pbnQpO1xuICAgICAgICAgICAgICBuZWdWZWMyKG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICAgIHJldHVybiBtaW5TZXBhcmF0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBzdWJWZWMyKHJBLCBwb2ludCwgY0EpO1xuICAgICAgICAgIHN1YlZlYzIockIsIHBvaW50LCBjQik7XG4gICAgICAgICAgbWluU2VwYXJhdGlvbiA9IG1hdGhfbWluJDQobWluU2VwYXJhdGlvbiwgc2VwYXJhdGlvbik7XG4gICAgICAgICAgdmFyIGJhdW1nYXJ0ZSA9IHRvaSA/IFNldHRpbmdzSW50ZXJuYWwudG9pQmF1Z2FydGUgOiBTZXR0aW5nc0ludGVybmFsLmJhdW1nYXJ0ZTtcbiAgICAgICAgICB2YXIgbGluZWFyU2xvcCA9IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgICAgICB2YXIgbWF4TGluZWFyQ29ycmVjdGlvbiA9IFNldHRpbmdzSW50ZXJuYWwubWF4TGluZWFyQ29ycmVjdGlvbjtcbiAgICAgICAgICB2YXIgQyA9IGNsYW1wKGJhdW1nYXJ0ZSAqIChzZXBhcmF0aW9uICsgbGluZWFyU2xvcCksIC1tYXhMaW5lYXJDb3JyZWN0aW9uLCAwKTtcbiAgICAgICAgICB2YXIgcm5BID0gY3Jvc3NWZWMyVmVjMihyQSwgbm9ybWFsJDIpO1xuICAgICAgICAgIHZhciBybkIgPSBjcm9zc1ZlYzJWZWMyKHJCLCBub3JtYWwkMik7XG4gICAgICAgICAgdmFyIEsgPSBtQSArIG1CICsgaUEgKiBybkEgKiBybkEgKyBpQiAqIHJuQiAqIHJuQjtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IEsgPiAwID8gLUMgLyBLIDogMDtcbiAgICAgICAgICBzY2FsZVZlYzIoUCQxLCBpbXB1bHNlLCBub3JtYWwkMik7XG4gICAgICAgICAgbWludXNTY2FsZVZlYzIoY0EsIG1BLCBQJDEpO1xuICAgICAgICAgIGFBIC09IGlBICogY3Jvc3NWZWMyVmVjMihyQSwgUCQxKTtcbiAgICAgICAgICBwbHVzU2NhbGVWZWMyKGNCLCBtQiwgUCQxKTtcbiAgICAgICAgICBhQiArPSBpQiAqIGNyb3NzVmVjMlZlYzIockIsIFAkMSk7XG4gICAgICAgIH1cbiAgICAgICAgY29weVZlYzIocG9zaXRpb25BLmMsIGNBKTtcbiAgICAgICAgcG9zaXRpb25BLmEgPSBhQTtcbiAgICAgICAgY29weVZlYzIocG9zaXRpb25CLmMsIGNCKTtcbiAgICAgICAgcG9zaXRpb25CLmEgPSBhQjtcbiAgICAgICAgcmV0dXJuIG1pblNlcGFyYXRpb247XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgaWYgKGJvZHlBID09PSBudWxsIHx8IGJvZHlCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHZlbG9jaXR5QSA9IGJvZHlBLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciB2ZWxvY2l0eUIgPSBib2R5Qi5jX3ZlbG9jaXR5O1xuICAgICAgICB2YXIgcG9zaXRpb25BID0gYm9keUEuY19wb3NpdGlvbjtcbiAgICAgICAgdmFyIHBvc2l0aW9uQiA9IGJvZHlCLmNfcG9zaXRpb247XG4gICAgICAgIHZhciByYWRpdXNBID0gdGhpcy5wX3JhZGl1c0E7XG4gICAgICAgIHZhciByYWRpdXNCID0gdGhpcy5wX3JhZGl1c0I7XG4gICAgICAgIHZhciBtYW5pZm9sZCA9IHRoaXMubV9tYW5pZm9sZDtcbiAgICAgICAgdmFyIG1BID0gdGhpcy52X2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLnZfaW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMudl9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy52X2ludklCO1xuICAgICAgICB2YXIgbG9jYWxDZW50ZXJBID0gdGhpcy5wX2xvY2FsQ2VudGVyQTtcbiAgICAgICAgdmFyIGxvY2FsQ2VudGVyQiA9IHRoaXMucF9sb2NhbENlbnRlckI7XG4gICAgICAgIGNvcHlWZWMyKGNBLCBwb3NpdGlvbkEuYyk7XG4gICAgICAgIHZhciBhQSA9IHBvc2l0aW9uQS5hO1xuICAgICAgICBjb3B5VmVjMih2QSwgdmVsb2NpdHlBLnYpO1xuICAgICAgICB2YXIgd0EgPSB2ZWxvY2l0eUEudztcbiAgICAgICAgY29weVZlYzIoY0IsIHBvc2l0aW9uQi5jKTtcbiAgICAgICAgdmFyIGFCID0gcG9zaXRpb25CLmE7XG4gICAgICAgIGNvcHlWZWMyKHZCLCB2ZWxvY2l0eUIudik7XG4gICAgICAgIHZhciB3QiA9IHZlbG9jaXR5Qi53O1xuICAgICAgICBnZXRUcmFuc2Zvcm0oeGZBLCBsb2NhbENlbnRlckEsIGNBLCBhQSk7XG4gICAgICAgIGdldFRyYW5zZm9ybSh4ZkIsIGxvY2FsQ2VudGVyQiwgY0IsIGFCKTtcbiAgICAgICAgd29ybGRNYW5pZm9sZC5yZWN5Y2xlKCk7XG4gICAgICAgIG1hbmlmb2xkLmdldFdvcmxkTWFuaWZvbGQod29ybGRNYW5pZm9sZCwgeGZBLCByYWRpdXNBLCB4ZkIsIHJhZGl1c0IpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLnZfbm9ybWFsLCB3b3JsZE1hbmlmb2xkLm5vcm1hbCk7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy52X3BvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgIHZhciB2Y3AgPSB0aGlzLnZfcG9pbnRzW2pdO1xuICAgICAgICAgIHZhciB3bXAgPSB3b3JsZE1hbmlmb2xkLnBvaW50c1tqXTtcbiAgICAgICAgICBzdWJWZWMyKHZjcC5yQSwgd21wLCBjQSk7XG4gICAgICAgICAgc3ViVmVjMih2Y3AuckIsIHdtcCwgY0IpO1xuICAgICAgICAgIHZhciBybkEgPSBjcm9zc1ZlYzJWZWMyKHZjcC5yQSwgdGhpcy52X25vcm1hbCk7XG4gICAgICAgICAgdmFyIHJuQiA9IGNyb3NzVmVjMlZlYzIodmNwLnJCLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgICB2YXIga05vcm1hbCA9IG1BICsgbUIgKyBpQSAqIHJuQSAqIHJuQSArIGlCICogcm5CICogcm5CO1xuICAgICAgICAgIHZjcC5ub3JtYWxNYXNzID0ga05vcm1hbCA+IDAgPyAxIC8ga05vcm1hbCA6IDA7XG4gICAgICAgICAgY3Jvc3NWZWMyTnVtKHRhbmdlbnQkMSwgdGhpcy52X25vcm1hbCwgMSk7XG4gICAgICAgICAgdmFyIHJ0QSA9IGNyb3NzVmVjMlZlYzIodmNwLnJBLCB0YW5nZW50JDEpO1xuICAgICAgICAgIHZhciBydEIgPSBjcm9zc1ZlYzJWZWMyKHZjcC5yQiwgdGFuZ2VudCQxKTtcbiAgICAgICAgICB2YXIga1RhbmdlbnQgPSBtQSArIG1CICsgaUEgKiBydEEgKiBydEEgKyBpQiAqIHJ0QiAqIHJ0QjtcbiAgICAgICAgICB2Y3AudGFuZ2VudE1hc3MgPSBrVGFuZ2VudCA+IDAgPyAxIC8ga1RhbmdlbnQgOiAwO1xuICAgICAgICAgIHZjcC52ZWxvY2l0eUJpYXMgPSAwO1xuICAgICAgICAgIHZhciB2UmVsID0gMDtcbiAgICAgICAgICB2UmVsICs9IGRvdFZlYzIodGhpcy52X25vcm1hbCwgdkIpO1xuICAgICAgICAgIHZSZWwgKz0gZG90VmVjMih0aGlzLnZfbm9ybWFsLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QiwgdmNwLnJCKSk7XG4gICAgICAgICAgdlJlbCAtPSBkb3RWZWMyKHRoaXMudl9ub3JtYWwsIHZBKTtcbiAgICAgICAgICB2UmVsIC09IGRvdFZlYzIodGhpcy52X25vcm1hbCwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0EsIHZjcC5yQSkpO1xuICAgICAgICAgIGlmICh2UmVsIDwgLVNldHRpbmdzSW50ZXJuYWwudmVsb2NpdHlUaHJlc2hvbGQpIHtcbiAgICAgICAgICAgIHZjcC52ZWxvY2l0eUJpYXMgPSAtdGhpcy52X3Jlc3RpdHV0aW9uICogdlJlbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudl9wb2ludENvdW50ID09IDIgJiYgc3RlcC5ibG9ja1NvbHZlKSB7XG4gICAgICAgICAgdmFyIHZjcDEgPSB0aGlzLnZfcG9pbnRzWzBdO1xuICAgICAgICAgIHZhciB2Y3AyID0gdGhpcy52X3BvaW50c1sxXTtcbiAgICAgICAgICB2YXIgcm4xQSA9IGNyb3NzVmVjMlZlYzIodmNwMS5yQSwgdGhpcy52X25vcm1hbCk7XG4gICAgICAgICAgdmFyIHJuMUIgPSBjcm9zc1ZlYzJWZWMyKHZjcDEuckIsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICAgIHZhciBybjJBID0gY3Jvc3NWZWMyVmVjMih2Y3AyLnJBLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgICB2YXIgcm4yQiA9IGNyb3NzVmVjMlZlYzIodmNwMi5yQiwgdGhpcy52X25vcm1hbCk7XG4gICAgICAgICAgdmFyIGsxMSA9IG1BICsgbUIgKyBpQSAqIHJuMUEgKiBybjFBICsgaUIgKiBybjFCICogcm4xQjtcbiAgICAgICAgICB2YXIgazIyID0gbUEgKyBtQiArIGlBICogcm4yQSAqIHJuMkEgKyBpQiAqIHJuMkIgKiBybjJCO1xuICAgICAgICAgIHZhciBrMTIgPSBtQSArIG1CICsgaUEgKiBybjFBICogcm4yQSArIGlCICogcm4xQiAqIHJuMkI7XG4gICAgICAgICAgdmFyIGtfbWF4Q29uZGl0aW9uTnVtYmVyID0gMWUzO1xuICAgICAgICAgIGlmIChrMTEgKiBrMTEgPCBrX21heENvbmRpdGlvbk51bWJlciAqIChrMTEgKiBrMjIgLSBrMTIgKiBrMTIpKSB7XG4gICAgICAgICAgICB0aGlzLnZfSy5leC5zZXROdW0oazExLCBrMTIpO1xuICAgICAgICAgICAgdGhpcy52X0suZXkuc2V0TnVtKGsxMiwgazIyKTtcbiAgICAgICAgICAgIHZhciBhXzEgPSB0aGlzLnZfSy5leC54O1xuICAgICAgICAgICAgdmFyIGJfMSA9IHRoaXMudl9LLmV5Lng7XG4gICAgICAgICAgICB2YXIgYzIgPSB0aGlzLnZfSy5leC55O1xuICAgICAgICAgICAgdmFyIGRfMSA9IHRoaXMudl9LLmV5Lnk7XG4gICAgICAgICAgICB2YXIgZGV0ID0gYV8xICogZF8xIC0gYl8xICogYzI7XG4gICAgICAgICAgICBpZiAoZGV0ICE9PSAwKSB7XG4gICAgICAgICAgICAgIGRldCA9IDEgLyBkZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnZfbm9ybWFsTWFzcy5leC54ID0gZGV0ICogZF8xO1xuICAgICAgICAgICAgdGhpcy52X25vcm1hbE1hc3MuZXkueCA9IC1kZXQgKiBiXzE7XG4gICAgICAgICAgICB0aGlzLnZfbm9ybWFsTWFzcy5leC55ID0gLWRldCAqIGMyO1xuICAgICAgICAgICAgdGhpcy52X25vcm1hbE1hc3MuZXkueSA9IGRldCAqIGFfMTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52X3BvaW50Q291bnQgPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb3B5VmVjMihwb3NpdGlvbkEuYywgY0EpO1xuICAgICAgICBwb3NpdGlvbkEuYSA9IGFBO1xuICAgICAgICBjb3B5VmVjMih2ZWxvY2l0eUEudiwgdkEpO1xuICAgICAgICB2ZWxvY2l0eUEudyA9IHdBO1xuICAgICAgICBjb3B5VmVjMihwb3NpdGlvbkIuYywgY0IpO1xuICAgICAgICBwb3NpdGlvbkIuYSA9IGFCO1xuICAgICAgICBjb3B5VmVjMih2ZWxvY2l0eUIudiwgdkIpO1xuICAgICAgICB2ZWxvY2l0eUIudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS53YXJtU3RhcnRDb25zdHJhaW50ID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGlmIChib2R5QSA9PT0gbnVsbCB8fCBib2R5QiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciB2ZWxvY2l0eUEgPSBib2R5QS5jX3ZlbG9jaXR5O1xuICAgICAgICB2YXIgdmVsb2NpdHlCID0gYm9keUIuY192ZWxvY2l0eTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy52X2ludk1hc3NBO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLnZfaW52SUE7XG4gICAgICAgIHZhciBtQiA9IHRoaXMudl9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlCID0gdGhpcy52X2ludklCO1xuICAgICAgICBjb3B5VmVjMih2QSwgdmVsb2NpdHlBLnYpO1xuICAgICAgICB2YXIgd0EgPSB2ZWxvY2l0eUEudztcbiAgICAgICAgY29weVZlYzIodkIsIHZlbG9jaXR5Qi52KTtcbiAgICAgICAgdmFyIHdCID0gdmVsb2NpdHlCLnc7XG4gICAgICAgIGNvcHlWZWMyKG5vcm1hbCQyLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgY3Jvc3NWZWMyTnVtKHRhbmdlbnQkMSwgbm9ybWFsJDIsIDEpO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMudl9wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICB2YXIgdmNwID0gdGhpcy52X3BvaW50c1tqXTtcbiAgICAgICAgICBjb21iaW5lMlZlYzIoUCQxLCB2Y3Aubm9ybWFsSW1wdWxzZSwgbm9ybWFsJDIsIHZjcC50YW5nZW50SW1wdWxzZSwgdGFuZ2VudCQxKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIGNyb3NzVmVjMlZlYzIodmNwLnJBLCBQJDEpO1xuICAgICAgICAgIG1pbnVzU2NhbGVWZWMyKHZBLCBtQSwgUCQxKTtcbiAgICAgICAgICB3QiArPSBpQiAqIGNyb3NzVmVjMlZlYzIodmNwLnJCLCBQJDEpO1xuICAgICAgICAgIHBsdXNTY2FsZVZlYzIodkIsIG1CLCBQJDEpO1xuICAgICAgICB9XG4gICAgICAgIGNvcHlWZWMyKHZlbG9jaXR5QS52LCB2QSk7XG4gICAgICAgIHZlbG9jaXR5QS53ID0gd0E7XG4gICAgICAgIGNvcHlWZWMyKHZlbG9jaXR5Qi52LCB2Qik7XG4gICAgICAgIHZlbG9jaXR5Qi53ID0gd0I7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnN0b3JlQ29uc3RyYWludEltcHVsc2VzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgbWFuaWZvbGQgPSB0aGlzLm1fbWFuaWZvbGQ7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy52X3BvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgIG1hbmlmb2xkLnBvaW50c1tqXS5ub3JtYWxJbXB1bHNlID0gdGhpcy52X3BvaW50c1tqXS5ub3JtYWxJbXB1bHNlO1xuICAgICAgICAgIG1hbmlmb2xkLnBvaW50c1tqXS50YW5nZW50SW1wdWxzZSA9IHRoaXMudl9wb2ludHNbal0udGFuZ2VudEltcHVsc2U7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgaWYgKGJvZHlBID09PSBudWxsIHx8IGJvZHlCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHZlbG9jaXR5QSA9IGJvZHlBLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciB2ZWxvY2l0eUIgPSBib2R5Qi5jX3ZlbG9jaXR5O1xuICAgICAgICB2YXIgbUEgPSB0aGlzLnZfaW52TWFzc0E7XG4gICAgICAgIHZhciBpQSA9IHRoaXMudl9pbnZJQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy52X2ludk1hc3NCO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLnZfaW52SUI7XG4gICAgICAgIGNvcHlWZWMyKHZBLCB2ZWxvY2l0eUEudik7XG4gICAgICAgIHZhciB3QSA9IHZlbG9jaXR5QS53O1xuICAgICAgICBjb3B5VmVjMih2QiwgdmVsb2NpdHlCLnYpO1xuICAgICAgICB2YXIgd0IgPSB2ZWxvY2l0eUIudztcbiAgICAgICAgY29weVZlYzIobm9ybWFsJDIsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICBjcm9zc1ZlYzJOdW0odGFuZ2VudCQxLCBub3JtYWwkMiwgMSk7XG4gICAgICAgIHZhciBmcmljdGlvbiA9IHRoaXMudl9mcmljdGlvbjtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnZfcG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgdmFyIHZjcCA9IHRoaXMudl9wb2ludHNbal07XG4gICAgICAgICAgemVyb1ZlYzIoZHYpO1xuICAgICAgICAgIHBsdXNWZWMyKGR2LCB2Qik7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdCLCB2Y3AuckIpKTtcbiAgICAgICAgICBtaW51c1ZlYzIoZHYsIHZBKTtcbiAgICAgICAgICBtaW51c1ZlYzIoZHYsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdBLCB2Y3AuckEpKTtcbiAgICAgICAgICB2YXIgdnQgPSBkb3RWZWMyKGR2LCB0YW5nZW50JDEpIC0gdGhpcy52X3RhbmdlbnRTcGVlZDtcbiAgICAgICAgICB2YXIgbGFtYmRhID0gdmNwLnRhbmdlbnRNYXNzICogLXZ0O1xuICAgICAgICAgIHZhciBtYXhGcmljdGlvbiA9IGZyaWN0aW9uICogdmNwLm5vcm1hbEltcHVsc2U7XG4gICAgICAgICAgdmFyIG5ld0ltcHVsc2UgPSBjbGFtcCh2Y3AudGFuZ2VudEltcHVsc2UgKyBsYW1iZGEsIC1tYXhGcmljdGlvbiwgbWF4RnJpY3Rpb24pO1xuICAgICAgICAgIGxhbWJkYSA9IG5ld0ltcHVsc2UgLSB2Y3AudGFuZ2VudEltcHVsc2U7XG4gICAgICAgICAgdmNwLnRhbmdlbnRJbXB1bHNlID0gbmV3SW1wdWxzZTtcbiAgICAgICAgICBzY2FsZVZlYzIoUCQxLCBsYW1iZGEsIHRhbmdlbnQkMSk7XG4gICAgICAgICAgbWludXNTY2FsZVZlYzIodkEsIG1BLCBQJDEpO1xuICAgICAgICAgIHdBIC09IGlBICogY3Jvc3NWZWMyVmVjMih2Y3AuckEsIFAkMSk7XG4gICAgICAgICAgcGx1c1NjYWxlVmVjMih2QiwgbUIsIFAkMSk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBjcm9zc1ZlYzJWZWMyKHZjcC5yQiwgUCQxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52X3BvaW50Q291bnQgPT0gMSB8fCBzdGVwLmJsb2NrU29sdmUgPT0gZmFsc2UpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudl9wb2ludENvdW50OyArK2kpIHtcbiAgICAgICAgICAgIHZhciB2Y3AgPSB0aGlzLnZfcG9pbnRzW2ldO1xuICAgICAgICAgICAgemVyb1ZlYzIoZHYpO1xuICAgICAgICAgICAgcGx1c1ZlYzIoZHYsIHZCKTtcbiAgICAgICAgICAgIHBsdXNWZWMyKGR2LCBjcm9zc051bVZlYzIodGVtcCQyLCB3QiwgdmNwLnJCKSk7XG4gICAgICAgICAgICBtaW51c1ZlYzIoZHYsIHZBKTtcbiAgICAgICAgICAgIG1pbnVzVmVjMihkdiwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0EsIHZjcC5yQSkpO1xuICAgICAgICAgICAgdmFyIHZuID0gZG90VmVjMihkdiwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgdmFyIGxhbWJkYSA9IC12Y3Aubm9ybWFsTWFzcyAqICh2biAtIHZjcC52ZWxvY2l0eUJpYXMpO1xuICAgICAgICAgICAgdmFyIG5ld0ltcHVsc2UgPSBtYXRoX21heCQyKHZjcC5ub3JtYWxJbXB1bHNlICsgbGFtYmRhLCAwKTtcbiAgICAgICAgICAgIGxhbWJkYSA9IG5ld0ltcHVsc2UgLSB2Y3Aubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICAgIHZjcC5ub3JtYWxJbXB1bHNlID0gbmV3SW1wdWxzZTtcbiAgICAgICAgICAgIHNjYWxlVmVjMihQJDEsIGxhbWJkYSwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgbWludXNTY2FsZVZlYzIodkEsIG1BLCBQJDEpO1xuICAgICAgICAgICAgd0EgLT0gaUEgKiBjcm9zc1ZlYzJWZWMyKHZjcC5yQSwgUCQxKTtcbiAgICAgICAgICAgIHBsdXNTY2FsZVZlYzIodkIsIG1CLCBQJDEpO1xuICAgICAgICAgICAgd0IgKz0gaUIgKiBjcm9zc1ZlYzJWZWMyKHZjcC5yQiwgUCQxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHZjcDEgPSB0aGlzLnZfcG9pbnRzWzBdO1xuICAgICAgICAgIHZhciB2Y3AyID0gdGhpcy52X3BvaW50c1sxXTtcbiAgICAgICAgICBzZXRWZWMyKGEsIHZjcDEubm9ybWFsSW1wdWxzZSwgdmNwMi5ub3JtYWxJbXB1bHNlKTtcbiAgICAgICAgICB6ZXJvVmVjMihkdjEpO1xuICAgICAgICAgIHBsdXNWZWMyKGR2MSwgdkIpO1xuICAgICAgICAgIHBsdXNWZWMyKGR2MSwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0IsIHZjcDEuckIpKTtcbiAgICAgICAgICBtaW51c1ZlYzIoZHYxLCB2QSk7XG4gICAgICAgICAgbWludXNWZWMyKGR2MSwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0EsIHZjcDEuckEpKTtcbiAgICAgICAgICB6ZXJvVmVjMihkdjIpO1xuICAgICAgICAgIHBsdXNWZWMyKGR2MiwgdkIpO1xuICAgICAgICAgIHBsdXNWZWMyKGR2MiwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0IsIHZjcDIuckIpKTtcbiAgICAgICAgICBtaW51c1ZlYzIoZHYyLCB2QSk7XG4gICAgICAgICAgbWludXNWZWMyKGR2MiwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0EsIHZjcDIuckEpKTtcbiAgICAgICAgICB2YXIgdm4xID0gZG90VmVjMihkdjEsIG5vcm1hbCQyKTtcbiAgICAgICAgICB2YXIgdm4yID0gZG90VmVjMihkdjIsIG5vcm1hbCQyKTtcbiAgICAgICAgICBzZXRWZWMyKGIsIHZuMSAtIHZjcDEudmVsb2NpdHlCaWFzLCB2bjIgLSB2Y3AyLnZlbG9jaXR5Qmlhcyk7XG4gICAgICAgICAgYi54IC09IHRoaXMudl9LLmV4LnggKiBhLnggKyB0aGlzLnZfSy5leS54ICogYS55O1xuICAgICAgICAgIGIueSAtPSB0aGlzLnZfSy5leC55ICogYS54ICsgdGhpcy52X0suZXkueSAqIGEueTtcbiAgICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgemVyb1ZlYzIoeCk7XG4gICAgICAgICAgICB4LnggPSAtKHRoaXMudl9ub3JtYWxNYXNzLmV4LnggKiBiLnggKyB0aGlzLnZfbm9ybWFsTWFzcy5leS54ICogYi55KTtcbiAgICAgICAgICAgIHgueSA9IC0odGhpcy52X25vcm1hbE1hc3MuZXgueSAqIGIueCArIHRoaXMudl9ub3JtYWxNYXNzLmV5LnkgKiBiLnkpO1xuICAgICAgICAgICAgaWYgKHgueCA+PSAwICYmIHgueSA+PSAwKSB7XG4gICAgICAgICAgICAgIHN1YlZlYzIoZCwgeCwgYSk7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMSwgZC54LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMiwgZC55LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QSwgLW1BLCBQMSwgLW1BLCBQMiwgMSwgdkEpO1xuICAgICAgICAgICAgICB3QSAtPSBpQSAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckEsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQSwgUDIpKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZCLCBtQiwgUDEsIG1CLCBQMiwgMSwgdkIpO1xuICAgICAgICAgICAgICB3QiArPSBpQiAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckIsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQiwgUDIpKTtcbiAgICAgICAgICAgICAgdmNwMS5ub3JtYWxJbXB1bHNlID0geC54O1xuICAgICAgICAgICAgICB2Y3AyLm5vcm1hbEltcHVsc2UgPSB4Lnk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeC54ID0gLXZjcDEubm9ybWFsTWFzcyAqIGIueDtcbiAgICAgICAgICAgIHgueSA9IDA7XG4gICAgICAgICAgICB2bjEgPSAwO1xuICAgICAgICAgICAgdm4yID0gdGhpcy52X0suZXgueSAqIHgueCArIGIueTtcbiAgICAgICAgICAgIGlmICh4LnggPj0gMCAmJiB2bjIgPj0gMCkge1xuICAgICAgICAgICAgICBzdWJWZWMyKGQsIHgsIGEpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIoUDEsIGQueCwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIoUDIsIGQueSwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgICBjb21iaW5lM1ZlYzIodkEsIC1tQSwgUDEsIC1tQSwgUDIsIDEsIHZBKTtcbiAgICAgICAgICAgICAgd0EgLT0gaUEgKiAoY3Jvc3NWZWMyVmVjMih2Y3AxLnJBLCBQMSkgKyBjcm9zc1ZlYzJWZWMyKHZjcDIuckEsIFAyKSk7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QiwgbUIsIFAxLCBtQiwgUDIsIDEsIHZCKTtcbiAgICAgICAgICAgICAgd0IgKz0gaUIgKiAoY3Jvc3NWZWMyVmVjMih2Y3AxLnJCLCBQMSkgKyBjcm9zc1ZlYzJWZWMyKHZjcDIuckIsIFAyKSk7XG4gICAgICAgICAgICAgIHZjcDEubm9ybWFsSW1wdWxzZSA9IHgueDtcbiAgICAgICAgICAgICAgdmNwMi5ub3JtYWxJbXB1bHNlID0geC55O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHgueCA9IDA7XG4gICAgICAgICAgICB4LnkgPSAtdmNwMi5ub3JtYWxNYXNzICogYi55O1xuICAgICAgICAgICAgdm4xID0gdGhpcy52X0suZXkueCAqIHgueSArIGIueDtcbiAgICAgICAgICAgIHZuMiA9IDA7XG4gICAgICAgICAgICBpZiAoeC55ID49IDAgJiYgdm4xID49IDApIHtcbiAgICAgICAgICAgICAgc3ViVmVjMihkLCB4LCBhKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKFAxLCBkLngsIG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKFAyLCBkLnksIG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZBLCAtbUEsIFAxLCAtbUEsIFAyLCAxLCB2QSk7XG4gICAgICAgICAgICAgIHdBIC09IGlBICogKGNyb3NzVmVjMlZlYzIodmNwMS5yQSwgUDEpICsgY3Jvc3NWZWMyVmVjMih2Y3AyLnJBLCBQMikpO1xuICAgICAgICAgICAgICBjb21iaW5lM1ZlYzIodkIsIG1CLCBQMSwgbUIsIFAyLCAxLCB2Qik7XG4gICAgICAgICAgICAgIHdCICs9IGlCICogKGNyb3NzVmVjMlZlYzIodmNwMS5yQiwgUDEpICsgY3Jvc3NWZWMyVmVjMih2Y3AyLnJCLCBQMikpO1xuICAgICAgICAgICAgICB2Y3AxLm5vcm1hbEltcHVsc2UgPSB4Lng7XG4gICAgICAgICAgICAgIHZjcDIubm9ybWFsSW1wdWxzZSA9IHgueTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4LnggPSAwO1xuICAgICAgICAgICAgeC55ID0gMDtcbiAgICAgICAgICAgIHZuMSA9IGIueDtcbiAgICAgICAgICAgIHZuMiA9IGIueTtcbiAgICAgICAgICAgIGlmICh2bjEgPj0gMCAmJiB2bjIgPj0gMCkge1xuICAgICAgICAgICAgICBzdWJWZWMyKGQsIHgsIGEpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIoUDEsIGQueCwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIoUDIsIGQueSwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgICBjb21iaW5lM1ZlYzIodkEsIC1tQSwgUDEsIC1tQSwgUDIsIDEsIHZBKTtcbiAgICAgICAgICAgICAgd0EgLT0gaUEgKiAoY3Jvc3NWZWMyVmVjMih2Y3AxLnJBLCBQMSkgKyBjcm9zc1ZlYzJWZWMyKHZjcDIuckEsIFAyKSk7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QiwgbUIsIFAxLCBtQiwgUDIsIDEsIHZCKTtcbiAgICAgICAgICAgICAgd0IgKz0gaUIgKiAoY3Jvc3NWZWMyVmVjMih2Y3AxLnJCLCBQMSkgKyBjcm9zc1ZlYzJWZWMyKHZjcDIuckIsIFAyKSk7XG4gICAgICAgICAgICAgIHZjcDEubm9ybWFsSW1wdWxzZSA9IHgueDtcbiAgICAgICAgICAgICAgdmNwMi5ub3JtYWxJbXB1bHNlID0geC55O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb3B5VmVjMih2ZWxvY2l0eUEudiwgdkEpO1xuICAgICAgICB2ZWxvY2l0eUEudyA9IHdBO1xuICAgICAgICBjb3B5VmVjMih2ZWxvY2l0eUIudiwgdkIpO1xuICAgICAgICB2ZWxvY2l0eUIudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLmFkZFR5cGUgPSBmdW5jdGlvbih0eXBlMSwgdHlwZTIsIGNhbGxiYWNrKSB7XG4gICAgICAgIHNfcmVnaXN0ZXJzW3R5cGUxXSA9IHNfcmVnaXN0ZXJzW3R5cGUxXSB8fCB7fTtcbiAgICAgICAgc19yZWdpc3RlcnNbdHlwZTFdW3R5cGUyXSA9IGNhbGxiYWNrO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLmNyZWF0ZSA9IGZ1bmN0aW9uKGZpeHR1cmVBLCBpbmRleEEsIGZpeHR1cmVCLCBpbmRleEIpIHtcbiAgICAgICAgdmFyIHR5cGVBID0gZml4dHVyZUEubV9zaGFwZS5tX3R5cGU7XG4gICAgICAgIHZhciB0eXBlQiA9IGZpeHR1cmVCLm1fc2hhcGUubV90eXBlO1xuICAgICAgICB2YXIgY29udGFjdCA9IGNvbnRhY3RQb29sLmFsbG9jYXRlKCk7XG4gICAgICAgIHZhciBldmFsdWF0ZUZjbjtcbiAgICAgICAgaWYgKGV2YWx1YXRlRmNuID0gc19yZWdpc3RlcnNbdHlwZUFdICYmIHNfcmVnaXN0ZXJzW3R5cGVBXVt0eXBlQl0pIHtcbiAgICAgICAgICBjb250YWN0LmluaXRpYWxpemUoZml4dHVyZUEsIGluZGV4QSwgZml4dHVyZUIsIGluZGV4QiwgZXZhbHVhdGVGY24pO1xuICAgICAgICB9IGVsc2UgaWYgKGV2YWx1YXRlRmNuID0gc19yZWdpc3RlcnNbdHlwZUJdICYmIHNfcmVnaXN0ZXJzW3R5cGVCXVt0eXBlQV0pIHtcbiAgICAgICAgICBjb250YWN0LmluaXRpYWxpemUoZml4dHVyZUIsIGluZGV4QiwgZml4dHVyZUEsIGluZGV4QSwgZXZhbHVhdGVGY24pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGZpeHR1cmVBID0gY29udGFjdC5tX2ZpeHR1cmVBO1xuICAgICAgICBmaXh0dXJlQiA9IGNvbnRhY3QubV9maXh0dXJlQjtcbiAgICAgICAgaW5kZXhBID0gY29udGFjdC5nZXRDaGlsZEluZGV4QSgpO1xuICAgICAgICBpbmRleEIgPSBjb250YWN0LmdldENoaWxkSW5kZXhCKCk7XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBjb250YWN0Lm1fbm9kZUEuY29udGFjdCA9IGNvbnRhY3Q7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQS5vdGhlciA9IGJvZHlCO1xuICAgICAgICBjb250YWN0Lm1fbm9kZUEucHJldiA9IG51bGw7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQS5uZXh0ID0gYm9keUEubV9jb250YWN0TGlzdDtcbiAgICAgICAgaWYgKGJvZHlBLm1fY29udGFjdExpc3QgIT0gbnVsbCkge1xuICAgICAgICAgIGJvZHlBLm1fY29udGFjdExpc3QucHJldiA9IGNvbnRhY3QubV9ub2RlQTtcbiAgICAgICAgfVxuICAgICAgICBib2R5QS5tX2NvbnRhY3RMaXN0ID0gY29udGFjdC5tX25vZGVBO1xuICAgICAgICBjb250YWN0Lm1fbm9kZUIuY29udGFjdCA9IGNvbnRhY3Q7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQi5vdGhlciA9IGJvZHlBO1xuICAgICAgICBjb250YWN0Lm1fbm9kZUIucHJldiA9IG51bGw7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQi5uZXh0ID0gYm9keUIubV9jb250YWN0TGlzdDtcbiAgICAgICAgaWYgKGJvZHlCLm1fY29udGFjdExpc3QgIT0gbnVsbCkge1xuICAgICAgICAgIGJvZHlCLm1fY29udGFjdExpc3QucHJldiA9IGNvbnRhY3QubV9ub2RlQjtcbiAgICAgICAgfVxuICAgICAgICBib2R5Qi5tX2NvbnRhY3RMaXN0ID0gY29udGFjdC5tX25vZGVCO1xuICAgICAgICBpZiAoZml4dHVyZUEuaXNTZW5zb3IoKSA9PSBmYWxzZSAmJiBmaXh0dXJlQi5pc1NlbnNvcigpID09IGZhbHNlKSB7XG4gICAgICAgICAgYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRhY3Q7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIuZGVzdHJveSA9IGZ1bmN0aW9uKGNvbnRhY3QsIGxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IGNvbnRhY3QubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gY29udGFjdC5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgaWYgKGJvZHlBID09PSBudWxsIHx8IGJvZHlCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKGNvbnRhY3QuaXNUb3VjaGluZygpKSB7XG4gICAgICAgICAgbGlzdGVuZXIuZW5kQ29udGFjdChjb250YWN0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdC5tX25vZGVBLnByZXYpIHtcbiAgICAgICAgICBjb250YWN0Lm1fbm9kZUEucHJldi5uZXh0ID0gY29udGFjdC5tX25vZGVBLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9ub2RlQS5uZXh0KSB7XG4gICAgICAgICAgY29udGFjdC5tX25vZGVBLm5leHQucHJldiA9IGNvbnRhY3QubV9ub2RlQS5wcmV2O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbm9kZUEgPT0gYm9keUEubV9jb250YWN0TGlzdCkge1xuICAgICAgICAgIGJvZHlBLm1fY29udGFjdExpc3QgPSBjb250YWN0Lm1fbm9kZUEubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdC5tX25vZGVCLnByZXYpIHtcbiAgICAgICAgICBjb250YWN0Lm1fbm9kZUIucHJldi5uZXh0ID0gY29udGFjdC5tX25vZGVCLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9ub2RlQi5uZXh0KSB7XG4gICAgICAgICAgY29udGFjdC5tX25vZGVCLm5leHQucHJldiA9IGNvbnRhY3QubV9ub2RlQi5wcmV2O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbm9kZUIgPT0gYm9keUIubV9jb250YWN0TGlzdCkge1xuICAgICAgICAgIGJvZHlCLm1fY29udGFjdExpc3QgPSBjb250YWN0Lm1fbm9kZUIubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdC5tX21hbmlmb2xkLnBvaW50Q291bnQgPiAwICYmICFmaXh0dXJlQS5tX2lzU2Vuc29yICYmICFmaXh0dXJlQi5tX2lzU2Vuc29yKSB7XG4gICAgICAgICAgYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29udGFjdFBvb2wucmVsZWFzZShjb250YWN0KTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gQ29udGFjdDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBERUZBVUxUUyRiID0ge1xuICAgIGdyYXZpdHk6IFZlYzIuemVybygpLFxuICAgIGFsbG93U2xlZXA6IHRydWUsXG4gICAgd2FybVN0YXJ0aW5nOiB0cnVlLFxuICAgIGNvbnRpbnVvdXNQaHlzaWNzOiB0cnVlLFxuICAgIHN1YlN0ZXBwaW5nOiBmYWxzZSxcbiAgICBibG9ja1NvbHZlOiB0cnVlLFxuICAgIHZlbG9jaXR5SXRlcmF0aW9uczogOCxcbiAgICBwb3NpdGlvbkl0ZXJhdGlvbnM6IDNcbiAgfTtcbiAgdmFyIFdvcmxkID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFdvcmxkMihkZWYpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFdvcmxkMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFdvcmxkMihkZWYpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc19zdGVwID0gbmV3IFRpbWVTdGVwKCk7XG4gICAgICAgIGlmICghZGVmKSB7XG4gICAgICAgICAgZGVmID0ge307XG4gICAgICAgIH0gZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGRlZikpIHtcbiAgICAgICAgICBkZWYgPSB7IGdyYXZpdHk6IGRlZiB9O1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyRiKTtcbiAgICAgICAgdGhpcy5tX3NvbHZlciA9IG5ldyBTb2x2ZXIodGhpcyk7XG4gICAgICAgIHRoaXMubV9icm9hZFBoYXNlID0gbmV3IEJyb2FkUGhhc2UoKTtcbiAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2NvbnRhY3RDb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV9ib2R5TGlzdCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9ib2R5Q291bnQgPSAwO1xuICAgICAgICB0aGlzLm1fam9pbnRMaXN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2pvaW50Q291bnQgPSAwO1xuICAgICAgICB0aGlzLm1fc3RlcENvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5tX2FsbG93U2xlZXAgPSBkZWYuYWxsb3dTbGVlcDtcbiAgICAgICAgdGhpcy5tX2dyYXZpdHkgPSBWZWMyLmNsb25lKGRlZi5ncmF2aXR5KTtcbiAgICAgICAgdGhpcy5tX2NsZWFyRm9yY2VzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5tX25ld0ZpeHR1cmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fd2FybVN0YXJ0aW5nID0gZGVmLndhcm1TdGFydGluZztcbiAgICAgICAgdGhpcy5tX2NvbnRpbnVvdXNQaHlzaWNzID0gZGVmLmNvbnRpbnVvdXNQaHlzaWNzO1xuICAgICAgICB0aGlzLm1fc3ViU3RlcHBpbmcgPSBkZWYuc3ViU3RlcHBpbmc7XG4gICAgICAgIHRoaXMubV9ibG9ja1NvbHZlID0gZGVmLmJsb2NrU29sdmU7XG4gICAgICAgIHRoaXMubV92ZWxvY2l0eUl0ZXJhdGlvbnMgPSBkZWYudmVsb2NpdHlJdGVyYXRpb25zO1xuICAgICAgICB0aGlzLm1fcG9zaXRpb25JdGVyYXRpb25zID0gZGVmLnBvc2l0aW9uSXRlcmF0aW9ucztcbiAgICAgICAgdGhpcy5tX3QgPSAwO1xuICAgICAgICB0aGlzLm1fc3RlcF9jYWxsYmFjayA9IFtdO1xuICAgICAgfVxuICAgICAgV29ybGQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBib2RpZXMgPSBbXTtcbiAgICAgICAgdmFyIGpvaW50cyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBiMiA9IHRoaXMuZ2V0Qm9keUxpc3QoKTsgYjI7IGIyID0gYjIuZ2V0TmV4dCgpKSB7XG4gICAgICAgICAgYm9kaWVzLnB1c2goYjIpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGogPSB0aGlzLmdldEpvaW50TGlzdCgpOyBqOyBqID0gai5nZXROZXh0KCkpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGouX3NlcmlhbGl6ZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBqb2ludHMucHVzaChqKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBncmF2aXR5OiB0aGlzLm1fZ3Jhdml0eSxcbiAgICAgICAgICBib2RpZXMsXG4gICAgICAgICAgam9pbnRzXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgV29ybGQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIGNvbnRleHQsIHJlc3RvcmUpIHtcbiAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBXb3JsZDIoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgd29ybGQgPSBuZXcgV29ybGQyKGRhdGEuZ3Jhdml0eSk7XG4gICAgICAgIGlmIChkYXRhLmJvZGllcykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSBkYXRhLmJvZGllcy5sZW5ndGggLSAxOyBpID49IDA7IGkgLT0gMSkge1xuICAgICAgICAgICAgd29ybGQuX2FkZEJvZHkocmVzdG9yZShCb2R5LCBkYXRhLmJvZGllc1tpXSwgd29ybGQpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGEuam9pbnRzKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IGRhdGEuam9pbnRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB3b3JsZC5jcmVhdGVKb2ludChyZXN0b3JlKEpvaW50LCBkYXRhLmpvaW50c1tpXSwgd29ybGQpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHdvcmxkO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0Qm9keUxpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5TGlzdDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldEpvaW50TGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2pvaW50TGlzdDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldENvbnRhY3RMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRCb2R5Q291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Q291bnQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRKb2ludENvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fam9pbnRDb3VudDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldENvbnRhY3RDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvbnRhY3RDb3VudDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnNldEdyYXZpdHkgPSBmdW5jdGlvbihncmF2aXR5KSB7XG4gICAgICAgIHRoaXMubV9ncmF2aXR5LnNldChncmF2aXR5KTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldEdyYXZpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ncmF2aXR5O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuaXNMb2NrZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NrZWQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zZXRBbGxvd1NsZWVwaW5nID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAoZmxhZyA9PSB0aGlzLm1fYWxsb3dTbGVlcCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYWxsb3dTbGVlcCA9IGZsYWc7XG4gICAgICAgIGlmICh0aGlzLm1fYWxsb3dTbGVlcCA9PSBmYWxzZSkge1xuICAgICAgICAgIGZvciAodmFyIGIyID0gdGhpcy5tX2JvZHlMaXN0OyBiMjsgYjIgPSBiMi5tX25leHQpIHtcbiAgICAgICAgICAgIGIyLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0QWxsb3dTbGVlcGluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2FsbG93U2xlZXA7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zZXRXYXJtU3RhcnRpbmcgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIHRoaXMubV93YXJtU3RhcnRpbmcgPSBmbGFnO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0V2FybVN0YXJ0aW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fd2FybVN0YXJ0aW5nO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuc2V0Q29udGludW91c1BoeXNpY3MgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIHRoaXMubV9jb250aW51b3VzUGh5c2ljcyA9IGZsYWc7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRDb250aW51b3VzUGh5c2ljcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvbnRpbnVvdXNQaHlzaWNzO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuc2V0U3ViU3RlcHBpbmcgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIHRoaXMubV9zdWJTdGVwcGluZyA9IGZsYWc7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRTdWJTdGVwcGluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3N1YlN0ZXBwaW5nO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuc2V0QXV0b0NsZWFyRm9yY2VzID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICB0aGlzLm1fY2xlYXJGb3JjZXMgPSBmbGFnO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0QXV0b0NsZWFyRm9yY2VzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY2xlYXJGb3JjZXM7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5jbGVhckZvcmNlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBmb3IgKHZhciBib2R5ID0gdGhpcy5tX2JvZHlMaXN0OyBib2R5OyBib2R5ID0gYm9keS5nZXROZXh0KCkpIHtcbiAgICAgICAgICBib2R5Lm1fZm9yY2Uuc2V0WmVybygpO1xuICAgICAgICAgIGJvZHkubV90b3JxdWUgPSAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5xdWVyeUFBQkIgPSBmdW5jdGlvbihhYWJiLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV9icm9hZFBoYXNlO1xuICAgICAgICB0aGlzLm1fYnJvYWRQaGFzZS5xdWVyeShhYWJiLCBmdW5jdGlvbihwcm94eUlkKSB7XG4gICAgICAgICAgdmFyIHByb3h5ID0gYnJvYWRQaGFzZS5nZXRVc2VyRGF0YShwcm94eUlkKTtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2socHJveHkuZml4dHVyZSk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKHBvaW50MSwgcG9pbnQyLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV9icm9hZFBoYXNlO1xuICAgICAgICB0aGlzLm1fYnJvYWRQaGFzZS5yYXlDYXN0KHtcbiAgICAgICAgICBtYXhGcmFjdGlvbjogMSxcbiAgICAgICAgICBwMTogcG9pbnQxLFxuICAgICAgICAgIHAyOiBwb2ludDJcbiAgICAgICAgfSwgZnVuY3Rpb24oaW5wdXQyLCBwcm94eUlkKSB7XG4gICAgICAgICAgdmFyIHByb3h5ID0gYnJvYWRQaGFzZS5nZXRVc2VyRGF0YShwcm94eUlkKTtcbiAgICAgICAgICB2YXIgZml4dHVyZSA9IHByb3h5LmZpeHR1cmU7XG4gICAgICAgICAgdmFyIGluZGV4ID0gcHJveHkuY2hpbGRJbmRleDtcbiAgICAgICAgICB2YXIgb3V0cHV0MiA9IHt9O1xuICAgICAgICAgIHZhciBoaXQgPSBmaXh0dXJlLnJheUNhc3Qob3V0cHV0MiwgaW5wdXQyLCBpbmRleCk7XG4gICAgICAgICAgaWYgKGhpdCkge1xuICAgICAgICAgICAgdmFyIGZyYWN0aW9uID0gb3V0cHV0Mi5mcmFjdGlvbjtcbiAgICAgICAgICAgIHZhciBwb2ludDMgPSBWZWMyLmFkZChWZWMyLm11bE51bVZlYzIoMSAtIGZyYWN0aW9uLCBpbnB1dDIucDEpLCBWZWMyLm11bE51bVZlYzIoZnJhY3Rpb24sIGlucHV0Mi5wMikpO1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGZpeHR1cmUsIHBvaW50Mywgb3V0cHV0Mi5ub3JtYWwsIGZyYWN0aW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGlucHV0Mi5tYXhGcmFjdGlvbjtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRQcm94eUNvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYnJvYWRQaGFzZS5nZXRQcm94eUNvdW50KCk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRUcmVlSGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYnJvYWRQaGFzZS5nZXRUcmVlSGVpZ2h0KCk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRUcmVlQmFsYW5jZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2Jyb2FkUGhhc2UuZ2V0VHJlZUJhbGFuY2UoKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldFRyZWVRdWFsaXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYnJvYWRQaGFzZS5nZXRUcmVlUXVhbGl0eSgpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuc2hpZnRPcmlnaW4gPSBmdW5jdGlvbihuZXdPcmlnaW4pIHtcbiAgICAgICAgaWYgKHRoaXMuaXNMb2NrZWQoKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBiMiA9IHRoaXMubV9ib2R5TGlzdDsgYjI7IGIyID0gYjIubV9uZXh0KSB7XG4gICAgICAgICAgYjIubV94Zi5wLnN1YihuZXdPcmlnaW4pO1xuICAgICAgICAgIGIyLm1fc3dlZXAuYzAuc3ViKG5ld09yaWdpbik7XG4gICAgICAgICAgYjIubV9zd2VlcC5jLnN1YihuZXdPcmlnaW4pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGogPSB0aGlzLm1fam9pbnRMaXN0OyBqOyBqID0gai5tX25leHQpIHtcbiAgICAgICAgICBqLnNoaWZ0T3JpZ2luKG5ld09yaWdpbik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2Jyb2FkUGhhc2Uuc2hpZnRPcmlnaW4obmV3T3JpZ2luKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLl9hZGRCb2R5ID0gZnVuY3Rpb24oYm9keSkge1xuICAgICAgICBpZiAodGhpcy5pc0xvY2tlZCgpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGJvZHkubV9wcmV2ID0gbnVsbDtcbiAgICAgICAgYm9keS5tX25leHQgPSB0aGlzLm1fYm9keUxpc3Q7XG4gICAgICAgIGlmICh0aGlzLm1fYm9keUxpc3QpIHtcbiAgICAgICAgICB0aGlzLm1fYm9keUxpc3QubV9wcmV2ID0gYm9keTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUxpc3QgPSBib2R5O1xuICAgICAgICArK3RoaXMubV9ib2R5Q291bnQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5jcmVhdGVCb2R5ID0gZnVuY3Rpb24oYXJnMSwgYXJnMikge1xuICAgICAgICBpZiAodGhpcy5pc0xvY2tlZCgpKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlZiA9IHt9O1xuICAgICAgICBpZiAoIWFyZzEpIDtcbiAgICAgICAgZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGFyZzEpKSB7XG4gICAgICAgICAgZGVmID0geyBwb3NpdGlvbjogYXJnMSwgYW5nbGU6IGFyZzIgfTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYXJnMSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIGRlZiA9IGFyZzE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJvZHkgPSBuZXcgQm9keSh0aGlzLCBkZWYpO1xuICAgICAgICB0aGlzLl9hZGRCb2R5KGJvZHkpO1xuICAgICAgICByZXR1cm4gYm9keTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmNyZWF0ZUR5bmFtaWNCb2R5ID0gZnVuY3Rpb24oYXJnMSwgYXJnMikge1xuICAgICAgICB2YXIgZGVmID0ge307XG4gICAgICAgIGlmICghYXJnMSkgO1xuICAgICAgICBlbHNlIGlmIChWZWMyLmlzVmFsaWQoYXJnMSkpIHtcbiAgICAgICAgICBkZWYgPSB7IHBvc2l0aW9uOiBhcmcxLCBhbmdsZTogYXJnMiB9O1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhcmcxID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgZGVmID0gYXJnMTtcbiAgICAgICAgfVxuICAgICAgICBkZWYudHlwZSA9IFwiZHluYW1pY1wiO1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVCb2R5KGRlZik7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5jcmVhdGVLaW5lbWF0aWNCb2R5ID0gZnVuY3Rpb24oYXJnMSwgYXJnMikge1xuICAgICAgICB2YXIgZGVmID0ge307XG4gICAgICAgIGlmICghYXJnMSkgO1xuICAgICAgICBlbHNlIGlmIChWZWMyLmlzVmFsaWQoYXJnMSkpIHtcbiAgICAgICAgICBkZWYgPSB7IHBvc2l0aW9uOiBhcmcxLCBhbmdsZTogYXJnMiB9O1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhcmcxID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgZGVmID0gYXJnMTtcbiAgICAgICAgfVxuICAgICAgICBkZWYudHlwZSA9IFwia2luZW1hdGljXCI7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUJvZHkoZGVmKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmRlc3Ryb3lCb2R5ID0gZnVuY3Rpb24oYjIpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNMb2NrZWQoKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYjIubV9kZXN0cm95ZWQpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGplID0gYjIubV9qb2ludExpc3Q7XG4gICAgICAgIHdoaWxlIChqZSkge1xuICAgICAgICAgIHZhciBqZTAgPSBqZTtcbiAgICAgICAgICBqZSA9IGplLm5leHQ7XG4gICAgICAgICAgdGhpcy5wdWJsaXNoKFwicmVtb3ZlLWpvaW50XCIsIGplMC5qb2ludCk7XG4gICAgICAgICAgdGhpcy5kZXN0cm95Sm9pbnQoamUwLmpvaW50KTtcbiAgICAgICAgICBiMi5tX2pvaW50TGlzdCA9IGplO1xuICAgICAgICB9XG4gICAgICAgIGIyLm1fam9pbnRMaXN0ID0gbnVsbDtcbiAgICAgICAgdmFyIGNlID0gYjIubV9jb250YWN0TGlzdDtcbiAgICAgICAgd2hpbGUgKGNlKSB7XG4gICAgICAgICAgdmFyIGNlMCA9IGNlO1xuICAgICAgICAgIGNlID0gY2UubmV4dDtcbiAgICAgICAgICB0aGlzLmRlc3Ryb3lDb250YWN0KGNlMC5jb250YWN0KTtcbiAgICAgICAgICBiMi5tX2NvbnRhY3RMaXN0ID0gY2U7XG4gICAgICAgIH1cbiAgICAgICAgYjIubV9jb250YWN0TGlzdCA9IG51bGw7XG4gICAgICAgIHZhciBmID0gYjIubV9maXh0dXJlTGlzdDtcbiAgICAgICAgd2hpbGUgKGYpIHtcbiAgICAgICAgICB2YXIgZjAgPSBmO1xuICAgICAgICAgIGYgPSBmLm1fbmV4dDtcbiAgICAgICAgICB0aGlzLnB1Ymxpc2goXCJyZW1vdmUtZml4dHVyZVwiLCBmMCk7XG4gICAgICAgICAgZjAuZGVzdHJveVByb3hpZXModGhpcy5tX2Jyb2FkUGhhc2UpO1xuICAgICAgICAgIGIyLm1fZml4dHVyZUxpc3QgPSBmO1xuICAgICAgICB9XG4gICAgICAgIGIyLm1fZml4dHVyZUxpc3QgPSBudWxsO1xuICAgICAgICBpZiAoYjIubV9wcmV2KSB7XG4gICAgICAgICAgYjIubV9wcmV2Lm1fbmV4dCA9IGIyLm1fbmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYjIubV9uZXh0KSB7XG4gICAgICAgICAgYjIubV9uZXh0Lm1fcHJldiA9IGIyLm1fcHJldjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYjIgPT0gdGhpcy5tX2JvZHlMaXN0KSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlMaXN0ID0gYjIubV9uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGIyLm1fZGVzdHJveWVkID0gdHJ1ZTtcbiAgICAgICAgLS10aGlzLm1fYm9keUNvdW50O1xuICAgICAgICB0aGlzLnB1Ymxpc2goXCJyZW1vdmUtYm9keVwiLCBiMik7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuY3JlYXRlSm9pbnQgPSBmdW5jdGlvbihqb2ludCkge1xuICAgICAgICBpZiAodGhpcy5pc0xvY2tlZCgpKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgam9pbnQubV9wcmV2ID0gbnVsbDtcbiAgICAgICAgam9pbnQubV9uZXh0ID0gdGhpcy5tX2pvaW50TGlzdDtcbiAgICAgICAgaWYgKHRoaXMubV9qb2ludExpc3QpIHtcbiAgICAgICAgICB0aGlzLm1fam9pbnRMaXN0Lm1fcHJldiA9IGpvaW50O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9qb2ludExpc3QgPSBqb2ludDtcbiAgICAgICAgKyt0aGlzLm1fam9pbnRDb3VudDtcbiAgICAgICAgam9pbnQubV9lZGdlQS5qb2ludCA9IGpvaW50O1xuICAgICAgICBqb2ludC5tX2VkZ2VBLm90aGVyID0gam9pbnQubV9ib2R5QjtcbiAgICAgICAgam9pbnQubV9lZGdlQS5wcmV2ID0gbnVsbDtcbiAgICAgICAgam9pbnQubV9lZGdlQS5uZXh0ID0gam9pbnQubV9ib2R5QS5tX2pvaW50TGlzdDtcbiAgICAgICAgaWYgKGpvaW50Lm1fYm9keUEubV9qb2ludExpc3QpXG4gICAgICAgICAgam9pbnQubV9ib2R5QS5tX2pvaW50TGlzdC5wcmV2ID0gam9pbnQubV9lZGdlQTtcbiAgICAgICAgam9pbnQubV9ib2R5QS5tX2pvaW50TGlzdCA9IGpvaW50Lm1fZWRnZUE7XG4gICAgICAgIGpvaW50Lm1fZWRnZUIuam9pbnQgPSBqb2ludDtcbiAgICAgICAgam9pbnQubV9lZGdlQi5vdGhlciA9IGpvaW50Lm1fYm9keUE7XG4gICAgICAgIGpvaW50Lm1fZWRnZUIucHJldiA9IG51bGw7XG4gICAgICAgIGpvaW50Lm1fZWRnZUIubmV4dCA9IGpvaW50Lm1fYm9keUIubV9qb2ludExpc3Q7XG4gICAgICAgIGlmIChqb2ludC5tX2JvZHlCLm1fam9pbnRMaXN0KVxuICAgICAgICAgIGpvaW50Lm1fYm9keUIubV9qb2ludExpc3QucHJldiA9IGpvaW50Lm1fZWRnZUI7XG4gICAgICAgIGpvaW50Lm1fYm9keUIubV9qb2ludExpc3QgPSBqb2ludC5tX2VkZ2VCO1xuICAgICAgICBpZiAoam9pbnQubV9jb2xsaWRlQ29ubmVjdGVkID09IGZhbHNlKSB7XG4gICAgICAgICAgZm9yICh2YXIgZWRnZSA9IGpvaW50Lm1fYm9keUIuZ2V0Q29udGFjdExpc3QoKTsgZWRnZTsgZWRnZSA9IGVkZ2UubmV4dCkge1xuICAgICAgICAgICAgaWYgKGVkZ2Uub3RoZXIgPT0gam9pbnQubV9ib2R5QSkge1xuICAgICAgICAgICAgICBlZGdlLmNvbnRhY3QuZmxhZ0ZvckZpbHRlcmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5kZXN0cm95Sm9pbnQgPSBmdW5jdGlvbihqb2ludCkge1xuICAgICAgICBpZiAodGhpcy5pc0xvY2tlZCgpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChqb2ludC5tX3ByZXYpIHtcbiAgICAgICAgICBqb2ludC5tX3ByZXYubV9uZXh0ID0gam9pbnQubV9uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChqb2ludC5tX25leHQpIHtcbiAgICAgICAgICBqb2ludC5tX25leHQubV9wcmV2ID0gam9pbnQubV9wcmV2O1xuICAgICAgICB9XG4gICAgICAgIGlmIChqb2ludCA9PSB0aGlzLm1fam9pbnRMaXN0KSB7XG4gICAgICAgICAgdGhpcy5tX2pvaW50TGlzdCA9IGpvaW50Lm1fbmV4dDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYm9keUEgPSBqb2ludC5tX2JvZHlBO1xuICAgICAgICB2YXIgYm9keUIgPSBqb2ludC5tX2JvZHlCO1xuICAgICAgICBib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIGlmIChqb2ludC5tX2VkZ2VBLnByZXYpIHtcbiAgICAgICAgICBqb2ludC5tX2VkZ2VBLnByZXYubmV4dCA9IGpvaW50Lm1fZWRnZUEubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbnQubV9lZGdlQS5uZXh0KSB7XG4gICAgICAgICAgam9pbnQubV9lZGdlQS5uZXh0LnByZXYgPSBqb2ludC5tX2VkZ2VBLnByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50Lm1fZWRnZUEgPT0gYm9keUEubV9qb2ludExpc3QpIHtcbiAgICAgICAgICBib2R5QS5tX2pvaW50TGlzdCA9IGpvaW50Lm1fZWRnZUEubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBqb2ludC5tX2VkZ2VBLnByZXYgPSBudWxsO1xuICAgICAgICBqb2ludC5tX2VkZ2VBLm5leHQgPSBudWxsO1xuICAgICAgICBpZiAoam9pbnQubV9lZGdlQi5wcmV2KSB7XG4gICAgICAgICAgam9pbnQubV9lZGdlQi5wcmV2Lm5leHQgPSBqb2ludC5tX2VkZ2VCLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50Lm1fZWRnZUIubmV4dCkge1xuICAgICAgICAgIGpvaW50Lm1fZWRnZUIubmV4dC5wcmV2ID0gam9pbnQubV9lZGdlQi5wcmV2O1xuICAgICAgICB9XG4gICAgICAgIGlmIChqb2ludC5tX2VkZ2VCID09IGJvZHlCLm1fam9pbnRMaXN0KSB7XG4gICAgICAgICAgYm9keUIubV9qb2ludExpc3QgPSBqb2ludC5tX2VkZ2VCLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgam9pbnQubV9lZGdlQi5wcmV2ID0gbnVsbDtcbiAgICAgICAgam9pbnQubV9lZGdlQi5uZXh0ID0gbnVsbDtcbiAgICAgICAgLS10aGlzLm1fam9pbnRDb3VudDtcbiAgICAgICAgaWYgKGpvaW50Lm1fY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZSkge1xuICAgICAgICAgIHZhciBlZGdlID0gYm9keUIuZ2V0Q29udGFjdExpc3QoKTtcbiAgICAgICAgICB3aGlsZSAoZWRnZSkge1xuICAgICAgICAgICAgaWYgKGVkZ2Uub3RoZXIgPT0gYm9keUEpIHtcbiAgICAgICAgICAgICAgZWRnZS5jb250YWN0LmZsYWdGb3JGaWx0ZXJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVkZ2UgPSBlZGdlLm5leHQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucHVibGlzaChcInJlbW92ZS1qb2ludFwiLCBqb2ludCk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zdGVwID0gZnVuY3Rpb24odGltZVN0ZXAsIHZlbG9jaXR5SXRlcmF0aW9ucywgcG9zaXRpb25JdGVyYXRpb25zKSB7XG4gICAgICAgIHRoaXMucHVibGlzaChcInByZS1zdGVwXCIsIHRpbWVTdGVwKTtcbiAgICAgICAgaWYgKCh2ZWxvY2l0eUl0ZXJhdGlvbnMgfCAwKSAhPT0gdmVsb2NpdHlJdGVyYXRpb25zKSB7XG4gICAgICAgICAgdmVsb2NpdHlJdGVyYXRpb25zID0gMDtcbiAgICAgICAgfVxuICAgICAgICB2ZWxvY2l0eUl0ZXJhdGlvbnMgPSB2ZWxvY2l0eUl0ZXJhdGlvbnMgfHwgdGhpcy5tX3ZlbG9jaXR5SXRlcmF0aW9ucztcbiAgICAgICAgcG9zaXRpb25JdGVyYXRpb25zID0gcG9zaXRpb25JdGVyYXRpb25zIHx8IHRoaXMubV9wb3NpdGlvbkl0ZXJhdGlvbnM7XG4gICAgICAgIGlmICh0aGlzLm1fbmV3Rml4dHVyZSkge1xuICAgICAgICAgIHRoaXMuZmluZE5ld0NvbnRhY3RzKCk7XG4gICAgICAgICAgdGhpcy5tX25ld0ZpeHR1cmUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fbG9ja2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zX3N0ZXAucmVzZXQodGltZVN0ZXApO1xuICAgICAgICB0aGlzLnNfc3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnMgPSB2ZWxvY2l0eUl0ZXJhdGlvbnM7XG4gICAgICAgIHRoaXMuc19zdGVwLnBvc2l0aW9uSXRlcmF0aW9ucyA9IHBvc2l0aW9uSXRlcmF0aW9ucztcbiAgICAgICAgdGhpcy5zX3N0ZXAud2FybVN0YXJ0aW5nID0gdGhpcy5tX3dhcm1TdGFydGluZztcbiAgICAgICAgdGhpcy5zX3N0ZXAuYmxvY2tTb2x2ZSA9IHRoaXMubV9ibG9ja1NvbHZlO1xuICAgICAgICB0aGlzLnVwZGF0ZUNvbnRhY3RzKCk7XG4gICAgICAgIGlmICh0aGlzLm1fc3RlcENvbXBsZXRlICYmIHRpbWVTdGVwID4gMCkge1xuICAgICAgICAgIHRoaXMubV9zb2x2ZXIuc29sdmVXb3JsZCh0aGlzLnNfc3RlcCk7XG4gICAgICAgICAgZm9yICh2YXIgYjIgPSB0aGlzLm1fYm9keUxpc3Q7IGIyOyBiMiA9IGIyLmdldE5leHQoKSkge1xuICAgICAgICAgICAgaWYgKGIyLm1faXNsYW5kRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiMi5pc1N0YXRpYygpKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYjIuc3luY2hyb25pemVGaXh0dXJlcygpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmZpbmROZXdDb250YWN0cygpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fY29udGludW91c1BoeXNpY3MgJiYgdGltZVN0ZXAgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX3NvbHZlci5zb2x2ZVdvcmxkVE9JKHRoaXMuc19zdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2NsZWFyRm9yY2VzKSB7XG4gICAgICAgICAgdGhpcy5jbGVhckZvcmNlcygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgdmFyIGNhbGxiYWNrO1xuICAgICAgICB3aGlsZSAoY2FsbGJhY2sgPSB0aGlzLm1fc3RlcF9jYWxsYmFjay5zaGlmdCgpKSB7XG4gICAgICAgICAgY2FsbGJhY2sodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wdWJsaXNoKFwicG9zdC1zdGVwXCIsIHRpbWVTdGVwKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnF1ZXVlVXBkYXRlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICBjYWxsYmFjayh0aGlzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fc3RlcF9jYWxsYmFjay5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZmluZE5ld0NvbnRhY3RzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMubV9icm9hZFBoYXNlLnVwZGF0ZVBhaXJzKGZ1bmN0aW9uKHByb3h5QSwgcHJveHlCKSB7XG4gICAgICAgICAgcmV0dXJuIF90aGlzLmNyZWF0ZUNvbnRhY3QocHJveHlBLCBwcm94eUIpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmNyZWF0ZUNvbnRhY3QgPSBmdW5jdGlvbihwcm94eUEsIHByb3h5Qikge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSBwcm94eUEuZml4dHVyZTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gcHJveHlCLmZpeHR1cmU7XG4gICAgICAgIHZhciBpbmRleEEgPSBwcm94eUEuY2hpbGRJbmRleDtcbiAgICAgICAgdmFyIGluZGV4QiA9IHByb3h5Qi5jaGlsZEluZGV4O1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5nZXRCb2R5KCk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLmdldEJvZHkoKTtcbiAgICAgICAgaWYgKGJvZHlBID09IGJvZHlCKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlZGdlID0gYm9keUIuZ2V0Q29udGFjdExpc3QoKTtcbiAgICAgICAgd2hpbGUgKGVkZ2UpIHtcbiAgICAgICAgICBpZiAoZWRnZS5vdGhlciA9PSBib2R5QSkge1xuICAgICAgICAgICAgdmFyIGZBID0gZWRnZS5jb250YWN0LmdldEZpeHR1cmVBKCk7XG4gICAgICAgICAgICB2YXIgZkIgPSBlZGdlLmNvbnRhY3QuZ2V0Rml4dHVyZUIoKTtcbiAgICAgICAgICAgIHZhciBpQSA9IGVkZ2UuY29udGFjdC5nZXRDaGlsZEluZGV4QSgpO1xuICAgICAgICAgICAgdmFyIGlCID0gZWRnZS5jb250YWN0LmdldENoaWxkSW5kZXhCKCk7XG4gICAgICAgICAgICBpZiAoZkEgPT0gZml4dHVyZUEgJiYgZkIgPT0gZml4dHVyZUIgJiYgaUEgPT0gaW5kZXhBICYmIGlCID09IGluZGV4Qikge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZkEgPT0gZml4dHVyZUIgJiYgZkIgPT0gZml4dHVyZUEgJiYgaUEgPT0gaW5kZXhCICYmIGlCID09IGluZGV4QSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGVkZ2UgPSBlZGdlLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJvZHlCLnNob3VsZENvbGxpZGUoYm9keUEpID09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaXh0dXJlQi5zaG91bGRDb2xsaWRlKGZpeHR1cmVBKSA9PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29udGFjdCA9IENvbnRhY3QuY3JlYXRlKGZpeHR1cmVBLCBpbmRleEEsIGZpeHR1cmVCLCBpbmRleEIpO1xuICAgICAgICBpZiAoY29udGFjdCA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRhY3QubV9wcmV2ID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMubV9jb250YWN0TGlzdCAhPSBudWxsKSB7XG4gICAgICAgICAgY29udGFjdC5tX25leHQgPSB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0Lm1fcHJldiA9IGNvbnRhY3Q7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gY29udGFjdDtcbiAgICAgICAgKyt0aGlzLm1fY29udGFjdENvdW50O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUudXBkYXRlQ29udGFjdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGMyO1xuICAgICAgICB2YXIgbmV4dF9jID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgICAgICB3aGlsZSAoYzIgPSBuZXh0X2MpIHtcbiAgICAgICAgICBuZXh0X2MgPSBjMi5nZXROZXh0KCk7XG4gICAgICAgICAgdmFyIGZpeHR1cmVBID0gYzIuZ2V0Rml4dHVyZUEoKTtcbiAgICAgICAgICB2YXIgZml4dHVyZUIgPSBjMi5nZXRGaXh0dXJlQigpO1xuICAgICAgICAgIHZhciBpbmRleEEgPSBjMi5nZXRDaGlsZEluZGV4QSgpO1xuICAgICAgICAgIHZhciBpbmRleEIgPSBjMi5nZXRDaGlsZEluZGV4QigpO1xuICAgICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLmdldEJvZHkoKTtcbiAgICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5nZXRCb2R5KCk7XG4gICAgICAgICAgaWYgKGMyLm1fZmlsdGVyRmxhZykge1xuICAgICAgICAgICAgaWYgKGJvZHlCLnNob3VsZENvbGxpZGUoYm9keUEpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIHRoaXMuZGVzdHJveUNvbnRhY3QoYzIpO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaXh0dXJlQi5zaG91bGRDb2xsaWRlKGZpeHR1cmVBKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3lDb250YWN0KGMyKTtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjMi5tX2ZpbHRlckZsYWcgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGFjdGl2ZUEgPSBib2R5QS5pc0F3YWtlKCkgJiYgIWJvZHlBLmlzU3RhdGljKCk7XG4gICAgICAgICAgdmFyIGFjdGl2ZUIgPSBib2R5Qi5pc0F3YWtlKCkgJiYgIWJvZHlCLmlzU3RhdGljKCk7XG4gICAgICAgICAgaWYgKGFjdGl2ZUEgPT0gZmFsc2UgJiYgYWN0aXZlQiA9PSBmYWxzZSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBwcm94eUlkQSA9IGZpeHR1cmVBLm1fcHJveGllc1tpbmRleEFdLnByb3h5SWQ7XG4gICAgICAgICAgdmFyIHByb3h5SWRCID0gZml4dHVyZUIubV9wcm94aWVzW2luZGV4Ql0ucHJveHlJZDtcbiAgICAgICAgICB2YXIgb3ZlcmxhcCA9IHRoaXMubV9icm9hZFBoYXNlLnRlc3RPdmVybGFwKHByb3h5SWRBLCBwcm94eUlkQik7XG4gICAgICAgICAgaWYgKG92ZXJsYXAgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdHJveUNvbnRhY3QoYzIpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGMyLnVwZGF0ZSh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZGVzdHJveUNvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0KSB7XG4gICAgICAgIGlmIChjb250YWN0Lm1fcHJldikge1xuICAgICAgICAgIGNvbnRhY3QubV9wcmV2Lm1fbmV4dCA9IGNvbnRhY3QubV9uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbmV4dCkge1xuICAgICAgICAgIGNvbnRhY3QubV9uZXh0Lm1fcHJldiA9IGNvbnRhY3QubV9wcmV2O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0ID09IHRoaXMubV9jb250YWN0TGlzdCkge1xuICAgICAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IGNvbnRhY3QubV9uZXh0O1xuICAgICAgICB9XG4gICAgICAgIENvbnRhY3QuZGVzdHJveShjb250YWN0LCB0aGlzKTtcbiAgICAgICAgLS10aGlzLm1fY29udGFjdENvdW50O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUub24gPSBmdW5jdGlvbihuYW1lLCBsaXN0ZW5lcikge1xuICAgICAgICBpZiAodHlwZW9mIG5hbWUgIT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGxpc3RlbmVyICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2xpc3RlbmVycykge1xuICAgICAgICAgIHRoaXMuX2xpc3RlbmVycyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5fbGlzdGVuZXJzW25hbWVdKSB7XG4gICAgICAgICAgdGhpcy5fbGlzdGVuZXJzW25hbWVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbGlzdGVuZXJzW25hbWVdLnB1c2gobGlzdGVuZXIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uKG5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgbGlzdGVuZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnMgJiYgdGhpcy5fbGlzdGVuZXJzW25hbWVdO1xuICAgICAgICBpZiAoIWxpc3RlbmVycyB8fCAhbGlzdGVuZXJzLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbmRleCA9IGxpc3RlbmVycy5pbmRleE9mKGxpc3RlbmVyKTtcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICBsaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnB1Ymxpc2ggPSBmdW5jdGlvbihuYW1lLCBhcmcxLCBhcmcyLCBhcmczKSB7XG4gICAgICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnMgJiYgdGhpcy5fbGlzdGVuZXJzW25hbWVdO1xuICAgICAgICBpZiAoIWxpc3RlbmVycyB8fCAhbGlzdGVuZXJzLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGwgPSAwOyBsIDwgbGlzdGVuZXJzLmxlbmd0aDsgbCsrKSB7XG4gICAgICAgICAgbGlzdGVuZXJzW2xdLmNhbGwodGhpcywgYXJnMSwgYXJnMiwgYXJnMyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpc3RlbmVycy5sZW5ndGg7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5iZWdpbkNvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0KSB7XG4gICAgICAgIHRoaXMucHVibGlzaChcImJlZ2luLWNvbnRhY3RcIiwgY29udGFjdCk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5lbmRDb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCkge1xuICAgICAgICB0aGlzLnB1Ymxpc2goXCJlbmQtY29udGFjdFwiLCBjb250YWN0KTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnByZVNvbHZlID0gZnVuY3Rpb24oY29udGFjdCwgb2xkTWFuaWZvbGQyKSB7XG4gICAgICAgIHRoaXMucHVibGlzaChcInByZS1zb2x2ZVwiLCBjb250YWN0LCBvbGRNYW5pZm9sZDIpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUucG9zdFNvbHZlID0gZnVuY3Rpb24oY29udGFjdCwgaW1wdWxzZSkge1xuICAgICAgICB0aGlzLnB1Ymxpc2goXCJwb3N0LXNvbHZlXCIsIGNvbnRhY3QsIGltcHVsc2UpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBXb3JsZDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBWZWMzID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFZlYzMyKHgyLCB5LCB6KSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBWZWMzMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFZlYzMyKHgyLCB5LCB6KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHgyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgdGhpcy54ID0gMDtcbiAgICAgICAgICB0aGlzLnkgPSAwO1xuICAgICAgICAgIHRoaXMueiA9IDA7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHgyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy54ID0geDIueDtcbiAgICAgICAgICB0aGlzLnkgPSB4Mi55O1xuICAgICAgICAgIHRoaXMueiA9IHgyLno7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy54ID0geDI7XG4gICAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgICB0aGlzLnogPSB6O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBWZWMzMi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHg6IHRoaXMueCxcbiAgICAgICAgICB5OiB0aGlzLnksXG4gICAgICAgICAgejogdGhpcy56XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgVmVjMzIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShWZWMzMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoueCA9IGRhdGEueDtcbiAgICAgICAgb2JqLnkgPSBkYXRhLnk7XG4gICAgICAgIG9iai56ID0gZGF0YS56O1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLm5lbyA9IGZ1bmN0aW9uKHgyLCB5LCB6KSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFZlYzMyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai54ID0geDI7XG4gICAgICAgIG9iai55ID0geTtcbiAgICAgICAgb2JqLnogPSB6O1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLnplcm8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVmVjMzIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnggPSAwO1xuICAgICAgICBvYmoueSA9IDA7XG4gICAgICAgIG9iai56ID0gMDtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBWZWMzMi5jbG9uZSA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBWZWMzMi5uZW8odjMueCwgdjMueSwgdjMueik7XG4gICAgICB9O1xuICAgICAgVmVjMzIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5pc1ZhbGlkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKG9iai54KSAmJiBOdW1iZXIuaXNGaW5pdGUob2JqLnkpICYmIE51bWJlci5pc0Zpbml0ZShvYmoueik7XG4gICAgICB9O1xuICAgICAgVmVjMzIuYXNzZXJ0ID0gZnVuY3Rpb24obykge1xuICAgICAgfTtcbiAgICAgIFZlYzMyLnByb3RvdHlwZS5zZXRaZXJvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMueCA9IDA7XG4gICAgICAgIHRoaXMueSA9IDA7XG4gICAgICAgIHRoaXMueiA9IDA7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih4MiwgeSwgeikge1xuICAgICAgICB0aGlzLnggPSB4MjtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgdGhpcy56ID0gejtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMzIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKHcpIHtcbiAgICAgICAgdGhpcy54ICs9IHcueDtcbiAgICAgICAgdGhpcy55ICs9IHcueTtcbiAgICAgICAgdGhpcy56ICs9IHcuejtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMzIucHJvdG90eXBlLnN1YiA9IGZ1bmN0aW9uKHcpIHtcbiAgICAgICAgdGhpcy54IC09IHcueDtcbiAgICAgICAgdGhpcy55IC09IHcueTtcbiAgICAgICAgdGhpcy56IC09IHcuejtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMzIucHJvdG90eXBlLm11bCA9IGZ1bmN0aW9uKG0pIHtcbiAgICAgICAgdGhpcy54ICo9IG07XG4gICAgICAgIHRoaXMueSAqPSBtO1xuICAgICAgICB0aGlzLnogKj0gbTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMzIuYXJlRXF1YWwgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gdjMgPT09IHcgfHwgdHlwZW9mIHYzID09PSBcIm9iamVjdFwiICYmIHYzICE9PSBudWxsICYmIHR5cGVvZiB3ID09PSBcIm9iamVjdFwiICYmIHcgIT09IG51bGwgJiYgdjMueCA9PT0gdy54ICYmIHYzLnkgPT09IHcueSAmJiB2My56ID09PSB3Lno7XG4gICAgICB9O1xuICAgICAgVmVjMzIuZG90ID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIHYzLnggKiB3LnggKyB2My55ICogdy55ICsgdjMueiAqIHcuejtcbiAgICAgIH07XG4gICAgICBWZWMzMi5jcm9zcyA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjMzIodjMueSAqIHcueiAtIHYzLnogKiB3LnksIHYzLnogKiB3LnggLSB2My54ICogdy56LCB2My54ICogdy55IC0gdjMueSAqIHcueCk7XG4gICAgICB9O1xuICAgICAgVmVjMzIuYWRkID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzMih2My54ICsgdy54LCB2My55ICsgdy55LCB2My56ICsgdy56KTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5zdWIgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gbmV3IFZlYzMyKHYzLnggLSB3LngsIHYzLnkgLSB3LnksIHYzLnogLSB3LnopO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLm11bCA9IGZ1bmN0aW9uKHYzLCBtKSB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjMzIobSAqIHYzLngsIG0gKiB2My55LCBtICogdjMueik7XG4gICAgICB9O1xuICAgICAgVmVjMzIucHJvdG90eXBlLm5lZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnggPSAtdGhpcy54O1xuICAgICAgICB0aGlzLnkgPSAtdGhpcy55O1xuICAgICAgICB0aGlzLnogPSAtdGhpcy56O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMzMi5uZWcgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICByZXR1cm4gbmV3IFZlYzMyKC12My54LCAtdjMueSwgLXYzLnopO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBWZWMzMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIHYxJDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgdjIkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBFZGdlU2hhcGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKEVkZ2VTaGFwZTIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBFZGdlU2hhcGUyKHYxMjIsIHYyMikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIEVkZ2VTaGFwZTIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBFZGdlU2hhcGUyKHYxMjIsIHYyMik7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBFZGdlU2hhcGUyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fcmFkaXVzID0gU2V0dGluZ3NJbnRlcm5hbC5wb2x5Z29uUmFkaXVzO1xuICAgICAgICBfdGhpcy5tX3ZlcnRleDEgPSB2MTIyID8gVmVjMi5jbG9uZSh2MTIyKSA6IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX3ZlcnRleDIgPSB2MjIgPyBWZWMyLmNsb25lKHYyMikgOiBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV92ZXJ0ZXgwID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fdmVydGV4MyA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX2hhc1ZlcnRleDAgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMubV9oYXNWZXJ0ZXgzID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICB2ZXJ0ZXgxOiB0aGlzLm1fdmVydGV4MSxcbiAgICAgICAgICB2ZXJ0ZXgyOiB0aGlzLm1fdmVydGV4MixcbiAgICAgICAgICB2ZXJ0ZXgwOiB0aGlzLm1fdmVydGV4MCxcbiAgICAgICAgICB2ZXJ0ZXgzOiB0aGlzLm1fdmVydGV4MyxcbiAgICAgICAgICBoYXNWZXJ0ZXgwOiB0aGlzLm1faGFzVmVydGV4MCxcbiAgICAgICAgICBoYXNWZXJ0ZXgzOiB0aGlzLm1faGFzVmVydGV4M1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICB2YXIgc2hhcGUgPSBuZXcgRWRnZVNoYXBlMihkYXRhLnZlcnRleDEsIGRhdGEudmVydGV4Mik7XG4gICAgICAgIGlmIChzaGFwZS5tX2hhc1ZlcnRleDApIHtcbiAgICAgICAgICBzaGFwZS5zZXRQcmV2VmVydGV4KGRhdGEudmVydGV4MCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNoYXBlLm1faGFzVmVydGV4Mykge1xuICAgICAgICAgIHNoYXBlLnNldE5leHRWZXJ0ZXgoZGF0YS52ZXJ0ZXgzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hhcGU7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuZ2V0UmFkaXVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLnNldE5leHQgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXROZXh0VmVydGV4KHYzKTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5zZXROZXh0VmVydGV4ID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgaWYgKHYzKSB7XG4gICAgICAgICAgdGhpcy5tX3ZlcnRleDMuc2V0VmVjMih2Myk7XG4gICAgICAgICAgdGhpcy5tX2hhc1ZlcnRleDMgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV92ZXJ0ZXgzLnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1faGFzVmVydGV4MyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmdldE5leHRWZXJ0ZXggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0ZXgzO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLnNldFByZXYgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXRQcmV2VmVydGV4KHYzKTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5zZXRQcmV2VmVydGV4ID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgaWYgKHYzKSB7XG4gICAgICAgICAgdGhpcy5tX3ZlcnRleDAuc2V0VmVjMih2Myk7XG4gICAgICAgICAgdGhpcy5tX2hhc1ZlcnRleDAgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV92ZXJ0ZXgwLnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1faGFzVmVydGV4MCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmdldFByZXZWZXJ0ZXggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0ZXgwO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLl9zZXQgPSBmdW5jdGlvbih2MTIyLCB2MjIpIHtcbiAgICAgICAgdGhpcy5tX3ZlcnRleDEuc2V0VmVjMih2MTIyKTtcbiAgICAgICAgdGhpcy5tX3ZlcnRleDIuc2V0VmVjMih2MjIpO1xuICAgICAgICB0aGlzLm1faGFzVmVydGV4MCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1faGFzVmVydGV4MyA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5fY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNsb25lID0gbmV3IEVkZ2VTaGFwZTIoKTtcbiAgICAgICAgY2xvbmUubV90eXBlID0gdGhpcy5tX3R5cGU7XG4gICAgICAgIGNsb25lLm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgICAgY2xvbmUubV92ZXJ0ZXgxLnNldFZlYzIodGhpcy5tX3ZlcnRleDEpO1xuICAgICAgICBjbG9uZS5tX3ZlcnRleDIuc2V0VmVjMih0aGlzLm1fdmVydGV4Mik7XG4gICAgICAgIGNsb25lLm1fdmVydGV4MC5zZXRWZWMyKHRoaXMubV92ZXJ0ZXgwKTtcbiAgICAgICAgY2xvbmUubV92ZXJ0ZXgzLnNldFZlYzIodGhpcy5tX3ZlcnRleDMpO1xuICAgICAgICBjbG9uZS5tX2hhc1ZlcnRleDAgPSB0aGlzLm1faGFzVmVydGV4MDtcbiAgICAgICAgY2xvbmUubV9oYXNWZXJ0ZXgzID0gdGhpcy5tX2hhc1ZlcnRleDM7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5nZXRDaGlsZENvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLnRlc3RQb2ludCA9IGZ1bmN0aW9uKHhmMiwgcCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0MiwgeGYyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHZhciBwMSA9IFJvdC5tdWxUVmVjMih4ZjIucSwgVmVjMi5zdWIoaW5wdXQyLnAxLCB4ZjIucCkpO1xuICAgICAgICB2YXIgcDIgPSBSb3QubXVsVFZlYzIoeGYyLnEsIFZlYzIuc3ViKGlucHV0Mi5wMiwgeGYyLnApKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi5zdWIocDIsIHAxKTtcbiAgICAgICAgdmFyIHYxMjIgPSB0aGlzLm1fdmVydGV4MTtcbiAgICAgICAgdmFyIHYyMiA9IHRoaXMubV92ZXJ0ZXgyO1xuICAgICAgICB2YXIgZTMgPSBWZWMyLnN1Yih2MjIsIHYxMjIpO1xuICAgICAgICB2YXIgbm9ybWFsMyA9IFZlYzIubmVvKGUzLnksIC1lMy54KTtcbiAgICAgICAgbm9ybWFsMy5ub3JtYWxpemUoKTtcbiAgICAgICAgdmFyIG51bWVyYXRvciA9IFZlYzIuZG90KG5vcm1hbDMsIFZlYzIuc3ViKHYxMjIsIHAxKSk7XG4gICAgICAgIHZhciBkZW5vbWluYXRvciA9IFZlYzIuZG90KG5vcm1hbDMsIGQyKTtcbiAgICAgICAgaWYgKGRlbm9taW5hdG9yID09IDApIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHQgPSBudW1lcmF0b3IgLyBkZW5vbWluYXRvcjtcbiAgICAgICAgaWYgKHQgPCAwIHx8IGlucHV0Mi5tYXhGcmFjdGlvbiA8IHQpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHEgPSBWZWMyLmFkZChwMSwgVmVjMi5tdWxOdW1WZWMyKHQsIGQyKSk7XG4gICAgICAgIHZhciByID0gVmVjMi5zdWIodjIyLCB2MTIyKTtcbiAgICAgICAgdmFyIHJyID0gVmVjMi5kb3Qociwgcik7XG4gICAgICAgIGlmIChyciA9PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzMiA9IFZlYzIuZG90KFZlYzIuc3ViKHEsIHYxMjIpLCByKSAvIHJyO1xuICAgICAgICBpZiAoczIgPCAwIHx8IDEgPCBzMikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXQyLmZyYWN0aW9uID0gdDtcbiAgICAgICAgaWYgKG51bWVyYXRvciA+IDApIHtcbiAgICAgICAgICBvdXRwdXQyLm5vcm1hbCA9IFJvdC5tdWxWZWMyKHhmMi5xLCBub3JtYWwzKS5uZWcoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvdXRwdXQyLm5vcm1hbCA9IFJvdC5tdWxWZWMyKHhmMi5xLCBub3JtYWwzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlQUFCQiA9IGZ1bmN0aW9uKGFhYmIsIHhmMiwgY2hpbGRJbmRleCkge1xuICAgICAgICB0cmFuc2Zvcm1WZWMyKHYxJDIsIHhmMiwgdGhpcy5tX3ZlcnRleDEpO1xuICAgICAgICB0cmFuc2Zvcm1WZWMyKHYyJDEsIHhmMiwgdGhpcy5tX3ZlcnRleDIpO1xuICAgICAgICBBQUJCLmNvbWJpbmVQb2ludHMoYWFiYiwgdjEkMiwgdjIkMSk7XG4gICAgICAgIEFBQkIuZXh0ZW5kKGFhYmIsIHRoaXMubV9yYWRpdXMpO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmNvbXB1dGVNYXNzID0gZnVuY3Rpb24obWFzc0RhdGEsIGRlbnNpdHkpIHtcbiAgICAgICAgbWFzc0RhdGEubWFzcyA9IDA7XG4gICAgICAgIGNvbWJpbmUyVmVjMihtYXNzRGF0YS5jZW50ZXIsIDAuNSwgdGhpcy5tX3ZlcnRleDEsIDAuNSwgdGhpcy5tX3ZlcnRleDIpO1xuICAgICAgICBtYXNzRGF0YS5JID0gMDtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlRGlzdGFuY2VQcm94eSA9IGZ1bmN0aW9uKHByb3h5KSB7XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXNbMF0gPSB0aGlzLm1fdmVydGV4MTtcbiAgICAgICAgcHJveHkubV92ZXJ0aWNlc1sxXSA9IHRoaXMubV92ZXJ0ZXgyO1xuICAgICAgICBwcm94eS5tX3ZlcnRpY2VzLmxlbmd0aCA9IDI7XG4gICAgICAgIHByb3h5Lm1fY291bnQgPSAyO1xuICAgICAgICBwcm94eS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5UWVBFID0gXCJlZGdlXCI7XG4gICAgICByZXR1cm4gRWRnZVNoYXBlMjtcbiAgICB9KFNoYXBlKVxuICApO1xuICB2YXIgdjEkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciB2MiA9IHZlYzIoMCwgMCk7XG4gIHZhciBDaGFpblNoYXBlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhDaGFpblNoYXBlMiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIENoYWluU2hhcGUyKHZlcnRpY2VzLCBsb29wKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgQ2hhaW5TaGFwZTIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBDaGFpblNoYXBlMih2ZXJ0aWNlcywgbG9vcCk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBDaGFpblNoYXBlMi5UWVBFO1xuICAgICAgICBfdGhpcy5tX3JhZGl1cyA9IFNldHRpbmdzSW50ZXJuYWwucG9seWdvblJhZGl1cztcbiAgICAgICAgX3RoaXMubV92ZXJ0aWNlcyA9IFtdO1xuICAgICAgICBfdGhpcy5tX2NvdW50ID0gMDtcbiAgICAgICAgX3RoaXMubV9wcmV2VmVydGV4ID0gbnVsbDtcbiAgICAgICAgX3RoaXMubV9uZXh0VmVydGV4ID0gbnVsbDtcbiAgICAgICAgX3RoaXMubV9oYXNQcmV2VmVydGV4ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLm1faGFzTmV4dFZlcnRleCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5tX2lzTG9vcCA9ICEhbG9vcDtcbiAgICAgICAgaWYgKHZlcnRpY2VzICYmIHZlcnRpY2VzLmxlbmd0aCkge1xuICAgICAgICAgIGlmIChsb29wKSB7XG4gICAgICAgICAgICBfdGhpcy5fY3JlYXRlTG9vcCh2ZXJ0aWNlcyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF90aGlzLl9jcmVhdGVDaGFpbih2ZXJ0aWNlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIHZlcnRpY2VzOiB0aGlzLm1faXNMb29wID8gdGhpcy5tX3ZlcnRpY2VzLnNsaWNlKDAsIHRoaXMubV92ZXJ0aWNlcy5sZW5ndGggLSAxKSA6IHRoaXMubV92ZXJ0aWNlcyxcbiAgICAgICAgICBpc0xvb3A6IHRoaXMubV9pc0xvb3AsXG4gICAgICAgICAgaGFzUHJldlZlcnRleDogdGhpcy5tX2hhc1ByZXZWZXJ0ZXgsXG4gICAgICAgICAgaGFzTmV4dFZlcnRleDogdGhpcy5tX2hhc05leHRWZXJ0ZXgsXG4gICAgICAgICAgcHJldlZlcnRleDogbnVsbCxcbiAgICAgICAgICBuZXh0VmVydGV4OiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLm1fcHJldlZlcnRleCkge1xuICAgICAgICAgIGRhdGEucHJldlZlcnRleCA9IHRoaXMubV9wcmV2VmVydGV4O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fbmV4dFZlcnRleCkge1xuICAgICAgICAgIGRhdGEubmV4dFZlcnRleCA9IHRoaXMubV9uZXh0VmVydGV4O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIGZpeHR1cmUsIHJlc3RvcmUpIHtcbiAgICAgICAgdmFyIHZlcnRpY2VzID0gW107XG4gICAgICAgIGlmIChkYXRhLnZlcnRpY2VzKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLnZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKHJlc3RvcmUoVmVjMiwgZGF0YS52ZXJ0aWNlc1tpXSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgc2hhcGUgPSBuZXcgQ2hhaW5TaGFwZTIodmVydGljZXMsIGRhdGEuaXNMb29wKTtcbiAgICAgICAgaWYgKGRhdGEucHJldlZlcnRleCkge1xuICAgICAgICAgIHNoYXBlLnNldFByZXZWZXJ0ZXgoZGF0YS5wcmV2VmVydGV4KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGF0YS5uZXh0VmVydGV4KSB7XG4gICAgICAgICAgc2hhcGUuc2V0TmV4dFZlcnRleChkYXRhLm5leHRWZXJ0ZXgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaGFwZTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmdldFJhZGl1cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuX2NyZWF0ZUxvb3AgPSBmdW5jdGlvbih2ZXJ0aWNlcykge1xuICAgICAgICBpZiAodmVydGljZXMubGVuZ3RoIDwgMykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaTtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIHRoaXMubV9jb3VudCA9IHZlcnRpY2VzLmxlbmd0aCArIDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGljZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB0aGlzLm1fdmVydGljZXNbaV0gPSBWZWMyLmNsb25lKHZlcnRpY2VzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fdmVydGljZXNbdmVydGljZXMubGVuZ3RoXSA9IFZlYzIuY2xvbmUodmVydGljZXNbMF0pO1xuICAgICAgICB0aGlzLm1fcHJldlZlcnRleCA9IHRoaXMubV92ZXJ0aWNlc1t0aGlzLm1fY291bnQgLSAyXTtcbiAgICAgICAgdGhpcy5tX25leHRWZXJ0ZXggPSB0aGlzLm1fdmVydGljZXNbMV07XG4gICAgICAgIHRoaXMubV9oYXNQcmV2VmVydGV4ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5tX2hhc05leHRWZXJ0ZXggPSB0cnVlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuX2NyZWF0ZUNoYWluID0gZnVuY3Rpb24odmVydGljZXMpIHtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlcyA9IFtdO1xuICAgICAgICB0aGlzLm1fY291bnQgPSB2ZXJ0aWNlcy5sZW5ndGg7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGljZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB0aGlzLm1fdmVydGljZXNbaV0gPSBWZWMyLmNsb25lKHZlcnRpY2VzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fcHJldlZlcnRleCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9uZXh0VmVydGV4ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2hhc1ByZXZWZXJ0ZXggPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2hhc05leHRWZXJ0ZXggPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5tX2lzTG9vcCkge1xuICAgICAgICAgIHRoaXMuX2NyZWF0ZUxvb3AodGhpcy5tX3ZlcnRpY2VzLnNsaWNlKDAsIHRoaXMubV92ZXJ0aWNlcy5sZW5ndGggLSAxKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fY3JlYXRlQ2hhaW4odGhpcy5tX3ZlcnRpY2VzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5zZXRQcmV2VmVydGV4ID0gZnVuY3Rpb24ocHJldlZlcnRleCkge1xuICAgICAgICB0aGlzLm1fcHJldlZlcnRleCA9IHByZXZWZXJ0ZXg7XG4gICAgICAgIHRoaXMubV9oYXNQcmV2VmVydGV4ID0gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuZ2V0UHJldlZlcnRleCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3ByZXZWZXJ0ZXg7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLnNldE5leHRWZXJ0ZXggPSBmdW5jdGlvbihuZXh0VmVydGV4KSB7XG4gICAgICAgIHRoaXMubV9uZXh0VmVydGV4ID0gbmV4dFZlcnRleDtcbiAgICAgICAgdGhpcy5tX2hhc05leHRWZXJ0ZXggPSB0cnVlO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXROZXh0VmVydGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbmV4dFZlcnRleDtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuX2Nsb25lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IG5ldyBDaGFpblNoYXBlMigpO1xuICAgICAgICBjbG9uZS5fY3JlYXRlQ2hhaW4odGhpcy5tX3ZlcnRpY2VzKTtcbiAgICAgICAgY2xvbmUubV90eXBlID0gdGhpcy5tX3R5cGU7XG4gICAgICAgIGNsb25lLm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgICAgY2xvbmUubV9wcmV2VmVydGV4ID0gdGhpcy5tX3ByZXZWZXJ0ZXg7XG4gICAgICAgIGNsb25lLm1fbmV4dFZlcnRleCA9IHRoaXMubV9uZXh0VmVydGV4O1xuICAgICAgICBjbG9uZS5tX2hhc1ByZXZWZXJ0ZXggPSB0aGlzLm1faGFzUHJldlZlcnRleDtcbiAgICAgICAgY2xvbmUubV9oYXNOZXh0VmVydGV4ID0gdGhpcy5tX2hhc05leHRWZXJ0ZXg7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuZ2V0Q2hpbGRDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvdW50IC0gMTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuZ2V0Q2hpbGRFZGdlID0gZnVuY3Rpb24oZWRnZSwgY2hpbGRJbmRleCkge1xuICAgICAgICBlZGdlLm1fdHlwZSA9IEVkZ2VTaGFwZS5UWVBFO1xuICAgICAgICBlZGdlLm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgICAgZWRnZS5tX3ZlcnRleDEgPSB0aGlzLm1fdmVydGljZXNbY2hpbGRJbmRleF07XG4gICAgICAgIGVkZ2UubV92ZXJ0ZXgyID0gdGhpcy5tX3ZlcnRpY2VzW2NoaWxkSW5kZXggKyAxXTtcbiAgICAgICAgaWYgKGNoaWxkSW5kZXggPiAwKSB7XG4gICAgICAgICAgZWRnZS5tX3ZlcnRleDAgPSB0aGlzLm1fdmVydGljZXNbY2hpbGRJbmRleCAtIDFdO1xuICAgICAgICAgIGVkZ2UubV9oYXNWZXJ0ZXgwID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlZGdlLm1fdmVydGV4MCA9IHRoaXMubV9wcmV2VmVydGV4O1xuICAgICAgICAgIGVkZ2UubV9oYXNWZXJ0ZXgwID0gdGhpcy5tX2hhc1ByZXZWZXJ0ZXg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoaWxkSW5kZXggPCB0aGlzLm1fY291bnQgLSAyKSB7XG4gICAgICAgICAgZWRnZS5tX3ZlcnRleDMgPSB0aGlzLm1fdmVydGljZXNbY2hpbGRJbmRleCArIDJdO1xuICAgICAgICAgIGVkZ2UubV9oYXNWZXJ0ZXgzID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlZGdlLm1fdmVydGV4MyA9IHRoaXMubV9uZXh0VmVydGV4O1xuICAgICAgICAgIGVkZ2UubV9oYXNWZXJ0ZXgzID0gdGhpcy5tX2hhc05leHRWZXJ0ZXg7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuZ2V0VmVydGV4ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgaWYgKGluZGV4IDwgdGhpcy5tX2NvdW50KSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0aWNlc1tpbmRleF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0aWNlc1swXTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5pc0xvb3AgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9pc0xvb3A7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLnRlc3RQb2ludCA9IGZ1bmN0aW9uKHhmMiwgcCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLnJheUNhc3QgPSBmdW5jdGlvbihvdXRwdXQyLCBpbnB1dDIsIHhmMiwgY2hpbGRJbmRleCkge1xuICAgICAgICB2YXIgZWRnZVNoYXBlID0gbmV3IEVkZ2VTaGFwZSh0aGlzLmdldFZlcnRleChjaGlsZEluZGV4KSwgdGhpcy5nZXRWZXJ0ZXgoY2hpbGRJbmRleCArIDEpKTtcbiAgICAgICAgcmV0dXJuIGVkZ2VTaGFwZS5yYXlDYXN0KG91dHB1dDIsIGlucHV0MiwgeGYyLCAwKTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZUFBQkIgPSBmdW5jdGlvbihhYWJiLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdHJhbnNmb3JtVmVjMih2MSQxLCB4ZjIsIHRoaXMuZ2V0VmVydGV4KGNoaWxkSW5kZXgpKTtcbiAgICAgICAgdHJhbnNmb3JtVmVjMih2MiwgeGYyLCB0aGlzLmdldFZlcnRleChjaGlsZEluZGV4ICsgMSkpO1xuICAgICAgICBBQUJCLmNvbWJpbmVQb2ludHMoYWFiYiwgdjEkMSwgdjIpO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlTWFzcyA9IGZ1bmN0aW9uKG1hc3NEYXRhLCBkZW5zaXR5KSB7XG4gICAgICAgIG1hc3NEYXRhLm1hc3MgPSAwO1xuICAgICAgICB6ZXJvVmVjMihtYXNzRGF0YS5jZW50ZXIpO1xuICAgICAgICBtYXNzRGF0YS5JID0gMDtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZURpc3RhbmNlUHJveHkgPSBmdW5jdGlvbihwcm94eSwgY2hpbGRJbmRleCkge1xuICAgICAgICBwcm94eS5tX3ZlcnRpY2VzWzBdID0gdGhpcy5nZXRWZXJ0ZXgoY2hpbGRJbmRleCk7XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXNbMV0gPSB0aGlzLmdldFZlcnRleChjaGlsZEluZGV4ICsgMSk7XG4gICAgICAgIHByb3h5Lm1fY291bnQgPSAyO1xuICAgICAgICBwcm94eS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIuVFlQRSA9IFwiY2hhaW5cIjtcbiAgICAgIHJldHVybiBDaGFpblNoYXBlMjtcbiAgICB9KFNoYXBlKVxuICApO1xuICB2YXIgbWF0aF9tYXgkMSA9IE1hdGgubWF4O1xuICB2YXIgbWF0aF9taW4kMyA9IE1hdGgubWluO1xuICB2YXIgdGVtcCQxID0gdmVjMigwLCAwKTtcbiAgdmFyIGUkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBlMSQxID0gdmVjMigwLCAwKTtcbiAgdmFyIGUyJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgY2VudGVyID0gdmVjMigwLCAwKTtcbiAgdmFyIHMgPSB2ZWMyKDAsIDApO1xuICB2YXIgUG9seWdvblNoYXBlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhQb2x5Z29uU2hhcGUyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gUG9seWdvblNoYXBlMih2ZXJ0aWNlcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIFBvbHlnb25TaGFwZTIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBQb2x5Z29uU2hhcGUyKHZlcnRpY2VzKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IFBvbHlnb25TaGFwZTIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9yYWRpdXMgPSBTZXR0aW5nc0ludGVybmFsLnBvbHlnb25SYWRpdXM7XG4gICAgICAgIF90aGlzLm1fY2VudHJvaWQgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV92ZXJ0aWNlcyA9IFtdO1xuICAgICAgICBfdGhpcy5tX25vcm1hbHMgPSBbXTtcbiAgICAgICAgX3RoaXMubV9jb3VudCA9IDA7XG4gICAgICAgIGlmICh2ZXJ0aWNlcyAmJiB2ZXJ0aWNlcy5sZW5ndGgpIHtcbiAgICAgICAgICBfdGhpcy5fc2V0KHZlcnRpY2VzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgdmVydGljZXM6IHRoaXMubV92ZXJ0aWNlc1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgZml4dHVyZSwgcmVzdG9yZSkge1xuICAgICAgICB2YXIgdmVydGljZXMgPSBbXTtcbiAgICAgICAgaWYgKGRhdGEudmVydGljZXMpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEudmVydGljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZlcnRpY2VzLnB1c2gocmVzdG9yZShWZWMyLCBkYXRhLnZlcnRpY2VzW2ldKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBzaGFwZSA9IG5ldyBQb2x5Z29uU2hhcGUyKHZlcnRpY2VzKTtcbiAgICAgICAgcmV0dXJuIHNoYXBlO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLmdldFJhZGl1cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5fY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNsb25lID0gbmV3IFBvbHlnb25TaGFwZTIoKTtcbiAgICAgICAgY2xvbmUubV90eXBlID0gdGhpcy5tX3R5cGU7XG4gICAgICAgIGNsb25lLm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgICAgY2xvbmUubV9jb3VudCA9IHRoaXMubV9jb3VudDtcbiAgICAgICAgY2xvbmUubV9jZW50cm9pZC5zZXRWZWMyKHRoaXMubV9jZW50cm9pZCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyBpKyspIHtcbiAgICAgICAgICBjbG9uZS5tX3ZlcnRpY2VzLnB1c2godGhpcy5tX3ZlcnRpY2VzW2ldLmNsb25lKCkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX25vcm1hbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjbG9uZS5tX25vcm1hbHMucHVzaCh0aGlzLm1fbm9ybWFsc1tpXS5jbG9uZSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuZ2V0Q2hpbGRDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fc2V0KHRoaXMubV92ZXJ0aWNlcyk7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuX3NldCA9IGZ1bmN0aW9uKHZlcnRpY2VzKSB7XG4gICAgICAgIGlmICh2ZXJ0aWNlcy5sZW5ndGggPCAzKSB7XG4gICAgICAgICAgdGhpcy5fc2V0QXNCb3goMSwgMSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuMiA9IG1hdGhfbWluJDModmVydGljZXMubGVuZ3RoLCBTZXR0aW5nc0ludGVybmFsLm1heFBvbHlnb25WZXJ0aWNlcyk7XG4gICAgICAgIHZhciBwcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG4yOyArK2kpIHtcbiAgICAgICAgICB2YXIgdjMgPSB2ZXJ0aWNlc1tpXTtcbiAgICAgICAgICB2YXIgdW5pcXVlID0gdHJ1ZTtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHBzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICBpZiAoVmVjMi5kaXN0YW5jZVNxdWFyZWQodjMsIHBzW2pdKSA8IDAuMjUgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3BTcXVhcmVkKSB7XG4gICAgICAgICAgICAgIHVuaXF1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHVuaXF1ZSkge1xuICAgICAgICAgICAgcHMucHVzaChWZWMyLmNsb25lKHYzKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG4yID0gcHMubGVuZ3RoO1xuICAgICAgICBpZiAobjIgPCAzKSB7XG4gICAgICAgICAgdGhpcy5fc2V0QXNCb3goMSwgMSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpMCA9IDA7XG4gICAgICAgIHZhciB4MCA9IHBzWzBdLng7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbjI7ICsraSkge1xuICAgICAgICAgIHZhciB4MiA9IHBzW2ldLng7XG4gICAgICAgICAgaWYgKHgyID4geDAgfHwgeDIgPT09IHgwICYmIHBzW2ldLnkgPCBwc1tpMF0ueSkge1xuICAgICAgICAgICAgaTAgPSBpO1xuICAgICAgICAgICAgeDAgPSB4MjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGh1bGwgPSBbXTtcbiAgICAgICAgdmFyIG0gPSAwO1xuICAgICAgICB2YXIgaWggPSBpMDtcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICBodWxsW21dID0gaWg7XG4gICAgICAgICAgdmFyIGllMiA9IDA7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBuMjsgKytqKSB7XG4gICAgICAgICAgICBpZiAoaWUyID09PSBpaCkge1xuICAgICAgICAgICAgICBpZTIgPSBqO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByID0gVmVjMi5zdWIocHNbaWUyXSwgcHNbaHVsbFttXV0pO1xuICAgICAgICAgICAgdmFyIHYzID0gVmVjMi5zdWIocHNbal0sIHBzW2h1bGxbbV1dKTtcbiAgICAgICAgICAgIHZhciBjMiA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyLCB2Myk7XG4gICAgICAgICAgICBpZiAoYzIgPCAwKSB7XG4gICAgICAgICAgICAgIGllMiA9IGo7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYzIgPT09IDAgJiYgdjMubGVuZ3RoU3F1YXJlZCgpID4gci5sZW5ndGhTcXVhcmVkKCkpIHtcbiAgICAgICAgICAgICAgaWUyID0gajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgKyttO1xuICAgICAgICAgIGloID0gaWUyO1xuICAgICAgICAgIGlmIChpZTIgPT09IGkwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0gPCAzKSB7XG4gICAgICAgICAgdGhpcy5fc2V0QXNCb3goMSwgMSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9jb3VudCA9IG07XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG07ICsraSkge1xuICAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXSA9IHBzW2h1bGxbaV1dO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbTsgKytpKSB7XG4gICAgICAgICAgdmFyIGkxID0gaTtcbiAgICAgICAgICB2YXIgaTIgPSBpICsgMSA8IG0gPyBpICsgMSA6IDA7XG4gICAgICAgICAgdmFyIGVkZ2UgPSBWZWMyLnN1Yih0aGlzLm1fdmVydGljZXNbaTJdLCB0aGlzLm1fdmVydGljZXNbaTFdKTtcbiAgICAgICAgICB0aGlzLm1fbm9ybWFsc1tpXSA9IFZlYzIuY3Jvc3NWZWMyTnVtKGVkZ2UsIDEpO1xuICAgICAgICAgIHRoaXMubV9ub3JtYWxzW2ldLm5vcm1hbGl6ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9jZW50cm9pZCA9IGNvbXB1dGVDZW50cm9pZCh0aGlzLm1fdmVydGljZXMsIG0pO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLl9zZXRBc0JveCA9IGZ1bmN0aW9uKGh4LCBoeSwgY2VudGVyMiwgYW5nbGUpIHtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzWzBdID0gVmVjMi5uZW8oaHgsIC1oeSk7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlc1sxXSA9IFZlYzIubmVvKGh4LCBoeSk7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlc1syXSA9IFZlYzIubmVvKC1oeCwgaHkpO1xuICAgICAgICB0aGlzLm1fdmVydGljZXNbM10gPSBWZWMyLm5lbygtaHgsIC1oeSk7XG4gICAgICAgIHRoaXMubV9ub3JtYWxzWzBdID0gVmVjMi5uZW8oMSwgMCk7XG4gICAgICAgIHRoaXMubV9ub3JtYWxzWzFdID0gVmVjMi5uZW8oMCwgMSk7XG4gICAgICAgIHRoaXMubV9ub3JtYWxzWzJdID0gVmVjMi5uZW8oLTEsIDApO1xuICAgICAgICB0aGlzLm1fbm9ybWFsc1szXSA9IFZlYzIubmVvKDAsIC0xKTtcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gNDtcbiAgICAgICAgaWYgKGNlbnRlcjIgJiYgVmVjMi5pc1ZhbGlkKGNlbnRlcjIpKSB7XG4gICAgICAgICAgYW5nbGUgPSBhbmdsZSB8fCAwO1xuICAgICAgICAgIGNvcHlWZWMyKHRoaXMubV9jZW50cm9pZCwgY2VudGVyMik7XG4gICAgICAgICAgdmFyIHhmMiA9IFRyYW5zZm9ybS5pZGVudGl0eSgpO1xuICAgICAgICAgIHhmMi5wLnNldFZlYzIoY2VudGVyMik7XG4gICAgICAgICAgeGYyLnEuc2V0QW5nbGUoYW5nbGUpO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXSA9IFRyYW5zZm9ybS5tdWxWZWMyKHhmMiwgdGhpcy5tX3ZlcnRpY2VzW2ldKTtcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWxzW2ldID0gUm90Lm11bFZlYzIoeGYyLnEsIHRoaXMubV9ub3JtYWxzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS50ZXN0UG9pbnQgPSBmdW5jdGlvbih4ZjIsIHApIHtcbiAgICAgICAgdmFyIHBMb2NhbCA9IGRldHJhbnNmb3JtVmVjMih0ZW1wJDEsIHhmMiwgcCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgZG90ID0gZG90VmVjMih0aGlzLm1fbm9ybWFsc1tpXSwgcExvY2FsKSAtIGRvdFZlYzIodGhpcy5tX25vcm1hbHNbaV0sIHRoaXMubV92ZXJ0aWNlc1tpXSk7XG4gICAgICAgICAgaWYgKGRvdCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0MiwgeGYyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHZhciBwMSA9IFJvdC5tdWxUVmVjMih4ZjIucSwgVmVjMi5zdWIoaW5wdXQyLnAxLCB4ZjIucCkpO1xuICAgICAgICB2YXIgcDIgPSBSb3QubXVsVFZlYzIoeGYyLnEsIFZlYzIuc3ViKGlucHV0Mi5wMiwgeGYyLnApKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi5zdWIocDIsIHAxKTtcbiAgICAgICAgdmFyIGxvd2VyID0gMDtcbiAgICAgICAgdmFyIHVwcGVyID0gaW5wdXQyLm1heEZyYWN0aW9uO1xuICAgICAgICB2YXIgaW5kZXggPSAtMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciBudW1lcmF0b3IgPSBWZWMyLmRvdCh0aGlzLm1fbm9ybWFsc1tpXSwgVmVjMi5zdWIodGhpcy5tX3ZlcnRpY2VzW2ldLCBwMSkpO1xuICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IFZlYzIuZG90KHRoaXMubV9ub3JtYWxzW2ldLCBkMik7XG4gICAgICAgICAgaWYgKGRlbm9taW5hdG9yID09IDApIHtcbiAgICAgICAgICAgIGlmIChudW1lcmF0b3IgPCAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGRlbm9taW5hdG9yIDwgMCAmJiBudW1lcmF0b3IgPCBsb3dlciAqIGRlbm9taW5hdG9yKSB7XG4gICAgICAgICAgICAgIGxvd2VyID0gbnVtZXJhdG9yIC8gZGVub21pbmF0b3I7XG4gICAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVub21pbmF0b3IgPiAwICYmIG51bWVyYXRvciA8IHVwcGVyICogZGVub21pbmF0b3IpIHtcbiAgICAgICAgICAgICAgdXBwZXIgPSBudW1lcmF0b3IgLyBkZW5vbWluYXRvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHVwcGVyIDwgbG93ZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICBvdXRwdXQyLmZyYWN0aW9uID0gbG93ZXI7XG4gICAgICAgICAgb3V0cHV0Mi5ub3JtYWwgPSBSb3QubXVsVmVjMih4ZjIucSwgdGhpcy5tX25vcm1hbHNbaW5kZXhdKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZUFBQkIgPSBmdW5jdGlvbihhYWJiLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdmFyIG1pblggPSBJbmZpbml0eTtcbiAgICAgICAgdmFyIG1pblkgPSBJbmZpbml0eTtcbiAgICAgICAgdmFyIG1heFggPSAtSW5maW5pdHk7XG4gICAgICAgIHZhciBtYXhZID0gLUluZmluaXR5O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIHYzID0gdHJhbnNmb3JtVmVjMih0ZW1wJDEsIHhmMiwgdGhpcy5tX3ZlcnRpY2VzW2ldKTtcbiAgICAgICAgICBtaW5YID0gbWF0aF9taW4kMyhtaW5YLCB2My54KTtcbiAgICAgICAgICBtYXhYID0gbWF0aF9tYXgkMShtYXhYLCB2My54KTtcbiAgICAgICAgICBtaW5ZID0gbWF0aF9taW4kMyhtaW5ZLCB2My55KTtcbiAgICAgICAgICBtYXhZID0gbWF0aF9tYXgkMShtYXhZLCB2My55KTtcbiAgICAgICAgfVxuICAgICAgICBzZXRWZWMyKGFhYmIubG93ZXJCb3VuZCwgbWluWCAtIHRoaXMubV9yYWRpdXMsIG1pblkgLSB0aGlzLm1fcmFkaXVzKTtcbiAgICAgICAgc2V0VmVjMihhYWJiLnVwcGVyQm91bmQsIG1heFggKyB0aGlzLm1fcmFkaXVzLCBtYXhZICsgdGhpcy5tX3JhZGl1cyk7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZU1hc3MgPSBmdW5jdGlvbihtYXNzRGF0YSwgZGVuc2l0eSkge1xuICAgICAgICB6ZXJvVmVjMihjZW50ZXIpO1xuICAgICAgICB2YXIgYXJlYSA9IDA7XG4gICAgICAgIHZhciBJID0gMDtcbiAgICAgICAgemVyb1ZlYzIocyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICBwbHVzVmVjMihzLCB0aGlzLm1fdmVydGljZXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHNjYWxlVmVjMihzLCAxIC8gdGhpcy5tX2NvdW50LCBzKTtcbiAgICAgICAgdmFyIGtfaW52MyA9IDEgLyAzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgc3ViVmVjMihlMSQxLCB0aGlzLm1fdmVydGljZXNbaV0sIHMpO1xuICAgICAgICAgIGlmIChpICsgMSA8IHRoaXMubV9jb3VudCkge1xuICAgICAgICAgICAgc3ViVmVjMihlMiQxLCB0aGlzLm1fdmVydGljZXNbaSArIDFdLCBzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3ViVmVjMihlMiQxLCB0aGlzLm1fdmVydGljZXNbMF0sIHMpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgRCA9IGNyb3NzVmVjMlZlYzIoZTEkMSwgZTIkMSk7XG4gICAgICAgICAgdmFyIHRyaWFuZ2xlQXJlYSA9IDAuNSAqIEQ7XG4gICAgICAgICAgYXJlYSArPSB0cmlhbmdsZUFyZWE7XG4gICAgICAgICAgY29tYmluZTJWZWMyKHRlbXAkMSwgdHJpYW5nbGVBcmVhICoga19pbnYzLCBlMSQxLCB0cmlhbmdsZUFyZWEgKiBrX2ludjMsIGUyJDEpO1xuICAgICAgICAgIHBsdXNWZWMyKGNlbnRlciwgdGVtcCQxKTtcbiAgICAgICAgICB2YXIgZXgxID0gZTEkMS54O1xuICAgICAgICAgIHZhciBleTEgPSBlMSQxLnk7XG4gICAgICAgICAgdmFyIGV4MiA9IGUyJDEueDtcbiAgICAgICAgICB2YXIgZXkyID0gZTIkMS55O1xuICAgICAgICAgIHZhciBpbnR4MiA9IGV4MSAqIGV4MSArIGV4MiAqIGV4MSArIGV4MiAqIGV4MjtcbiAgICAgICAgICB2YXIgaW50eTIgPSBleTEgKiBleTEgKyBleTIgKiBleTEgKyBleTIgKiBleTI7XG4gICAgICAgICAgSSArPSAwLjI1ICoga19pbnYzICogRCAqIChpbnR4MiArIGludHkyKTtcbiAgICAgICAgfVxuICAgICAgICBtYXNzRGF0YS5tYXNzID0gZGVuc2l0eSAqIGFyZWE7XG4gICAgICAgIHNjYWxlVmVjMihjZW50ZXIsIDEgLyBhcmVhLCBjZW50ZXIpO1xuICAgICAgICBhZGRWZWMyKG1hc3NEYXRhLmNlbnRlciwgY2VudGVyLCBzKTtcbiAgICAgICAgbWFzc0RhdGEuSSA9IGRlbnNpdHkgKiBJO1xuICAgICAgICBtYXNzRGF0YS5JICs9IG1hc3NEYXRhLm1hc3MgKiAoZG90VmVjMihtYXNzRGF0YS5jZW50ZXIsIG1hc3NEYXRhLmNlbnRlcikgLSBkb3RWZWMyKGNlbnRlciwgY2VudGVyKSk7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciBpMSA9IGk7XG4gICAgICAgICAgdmFyIGkyID0gaSA8IHRoaXMubV9jb3VudCAtIDEgPyBpMSArIDEgOiAwO1xuICAgICAgICAgIHZhciBwID0gdGhpcy5tX3ZlcnRpY2VzW2kxXTtcbiAgICAgICAgICBzdWJWZWMyKGUkMSwgdGhpcy5tX3ZlcnRpY2VzW2kyXSwgcCk7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLm1fY291bnQ7ICsraikge1xuICAgICAgICAgICAgaWYgKGogPT0gaTEgfHwgaiA9PSBpMikge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjMiA9IGNyb3NzVmVjMlZlYzIoZSQxLCBzdWJWZWMyKHRlbXAkMSwgdGhpcy5tX3ZlcnRpY2VzW2pdLCBwKSk7XG4gICAgICAgICAgICBpZiAoYzIgPCAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZURpc3RhbmNlUHJveHkgPSBmdW5jdGlvbihwcm94eSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgcHJveHkubV92ZXJ0aWNlc1tpXSA9IHRoaXMubV92ZXJ0aWNlc1tpXTtcbiAgICAgICAgfVxuICAgICAgICBwcm94eS5tX3ZlcnRpY2VzLmxlbmd0aCA9IHRoaXMubV9jb3VudDtcbiAgICAgICAgcHJveHkubV9jb3VudCA9IHRoaXMubV9jb3VudDtcbiAgICAgICAgcHJveHkubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIuVFlQRSA9IFwicG9seWdvblwiO1xuICAgICAgcmV0dXJuIFBvbHlnb25TaGFwZTI7XG4gICAgfShTaGFwZSlcbiAgKTtcbiAgZnVuY3Rpb24gY29tcHV0ZUNlbnRyb2lkKHZzLCBjb3VudCkge1xuICAgIHZhciBjMiA9IFZlYzIuemVybygpO1xuICAgIHZhciBhcmVhID0gMDtcbiAgICB2YXIgcFJlZiA9IFZlYzIuemVybygpO1xuICAgIHZhciBpO1xuICAgIHZhciBpbnYzID0gMSAvIDM7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7XG4gICAgICB2YXIgcDEgPSBwUmVmO1xuICAgICAgdmFyIHAyID0gdnNbaV07XG4gICAgICB2YXIgcDMgPSBpICsgMSA8IGNvdW50ID8gdnNbaSArIDFdIDogdnNbMF07XG4gICAgICB2YXIgZTFfMSA9IFZlYzIuc3ViKHAyLCBwMSk7XG4gICAgICB2YXIgZTJfMSA9IFZlYzIuc3ViKHAzLCBwMSk7XG4gICAgICB2YXIgRCA9IFZlYzIuY3Jvc3NWZWMyVmVjMihlMV8xLCBlMl8xKTtcbiAgICAgIHZhciB0cmlhbmdsZUFyZWEgPSAwLjUgKiBEO1xuICAgICAgYXJlYSArPSB0cmlhbmdsZUFyZWE7XG4gICAgICBjb21iaW5lM1ZlYzIodGVtcCQxLCAxLCBwMSwgMSwgcDIsIDEsIHAzKTtcbiAgICAgIHBsdXNTY2FsZVZlYzIoYzIsIHRyaWFuZ2xlQXJlYSAqIGludjMsIHRlbXAkMSk7XG4gICAgfVxuICAgIGMyLm11bCgxIC8gYXJlYSk7XG4gICAgcmV0dXJuIGMyO1xuICB9XG4gIHZhciBtYXRoX3NxcnQgPSBNYXRoLnNxcnQ7XG4gIHZhciBtYXRoX1BJJDQgPSBNYXRoLlBJO1xuICB2YXIgdGVtcCA9IHZlYzIoMCwgMCk7XG4gIHZhciBDaXJjbGVTaGFwZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoQ2lyY2xlU2hhcGUyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gQ2lyY2xlU2hhcGUyKGEyLCBiMikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIENpcmNsZVNoYXBlMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IENpcmNsZVNoYXBlMihhMiwgYjIpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMubV90eXBlID0gQ2lyY2xlU2hhcGUyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fcCA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX3JhZGl1cyA9IDE7XG4gICAgICAgIGlmICh0eXBlb2YgYTIgPT09IFwib2JqZWN0XCIgJiYgVmVjMi5pc1ZhbGlkKGEyKSkge1xuICAgICAgICAgIF90aGlzLm1fcC5zZXRWZWMyKGEyKTtcbiAgICAgICAgICBpZiAodHlwZW9mIGIyID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICBfdGhpcy5tX3JhZGl1cyA9IGIyO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYTIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICBfdGhpcy5tX3JhZGl1cyA9IGEyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIHA6IHRoaXMubV9wLFxuICAgICAgICAgIHJhZGl1czogdGhpcy5tX3JhZGl1c1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ2lyY2xlU2hhcGUyKGRhdGEucCwgZGF0YS5yYWRpdXMpO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLmdldFJhZGl1cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLmdldENlbnRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3A7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5fY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNsb25lID0gbmV3IENpcmNsZVNoYXBlMigpO1xuICAgICAgICBjbG9uZS5tX3R5cGUgPSB0aGlzLm1fdHlwZTtcbiAgICAgICAgY2xvbmUubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgICBjbG9uZS5tX3AgPSB0aGlzLm1fcC5jbG9uZSgpO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5nZXRDaGlsZENvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUudGVzdFBvaW50ID0gZnVuY3Rpb24oeGYyLCBwKSB7XG4gICAgICAgIHZhciBjZW50ZXIyID0gdHJhbnNmb3JtVmVjMih0ZW1wLCB4ZjIsIHRoaXMubV9wKTtcbiAgICAgICAgcmV0dXJuIGRpc3RTcXJWZWMyKHAsIGNlbnRlcjIpIDw9IHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0MiwgeGYyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHZhciBwb3NpdGlvbiA9IFZlYzIuYWRkKHhmMi5wLCBSb3QubXVsVmVjMih4ZjIucSwgdGhpcy5tX3ApKTtcbiAgICAgICAgdmFyIHMyID0gVmVjMi5zdWIoaW5wdXQyLnAxLCBwb3NpdGlvbik7XG4gICAgICAgIHZhciBiMiA9IFZlYzIuZG90KHMyLCBzMikgLSB0aGlzLm1fcmFkaXVzICogdGhpcy5tX3JhZGl1cztcbiAgICAgICAgdmFyIHIgPSBWZWMyLnN1YihpbnB1dDIucDIsIGlucHV0Mi5wMSk7XG4gICAgICAgIHZhciBjMiA9IFZlYzIuZG90KHMyLCByKTtcbiAgICAgICAgdmFyIHJyID0gVmVjMi5kb3Qociwgcik7XG4gICAgICAgIHZhciBzaWdtYSA9IGMyICogYzIgLSByciAqIGIyO1xuICAgICAgICBpZiAoc2lnbWEgPCAwIHx8IHJyIDwgRVBTSUxPTikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYTIgPSAtKGMyICsgbWF0aF9zcXJ0KHNpZ21hKSk7XG4gICAgICAgIGlmICgwIDw9IGEyICYmIGEyIDw9IGlucHV0Mi5tYXhGcmFjdGlvbiAqIHJyKSB7XG4gICAgICAgICAgYTIgLz0gcnI7XG4gICAgICAgICAgb3V0cHV0Mi5mcmFjdGlvbiA9IGEyO1xuICAgICAgICAgIG91dHB1dDIubm9ybWFsID0gVmVjMi5hZGQoczIsIFZlYzIubXVsTnVtVmVjMihhMiwgcikpO1xuICAgICAgICAgIG91dHB1dDIubm9ybWFsLm5vcm1hbGl6ZSgpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLmNvbXB1dGVBQUJCID0gZnVuY3Rpb24oYWFiYiwgeGYyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHZhciBwID0gdHJhbnNmb3JtVmVjMih0ZW1wLCB4ZjIsIHRoaXMubV9wKTtcbiAgICAgICAgc2V0VmVjMihhYWJiLmxvd2VyQm91bmQsIHAueCAtIHRoaXMubV9yYWRpdXMsIHAueSAtIHRoaXMubV9yYWRpdXMpO1xuICAgICAgICBzZXRWZWMyKGFhYmIudXBwZXJCb3VuZCwgcC54ICsgdGhpcy5tX3JhZGl1cywgcC55ICsgdGhpcy5tX3JhZGl1cyk7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlTWFzcyA9IGZ1bmN0aW9uKG1hc3NEYXRhLCBkZW5zaXR5KSB7XG4gICAgICAgIG1hc3NEYXRhLm1hc3MgPSBkZW5zaXR5ICogbWF0aF9QSSQ0ICogdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXM7XG4gICAgICAgIGNvcHlWZWMyKG1hc3NEYXRhLmNlbnRlciwgdGhpcy5tX3ApO1xuICAgICAgICBtYXNzRGF0YS5JID0gbWFzc0RhdGEubWFzcyAqICgwLjUgKiB0aGlzLm1fcmFkaXVzICogdGhpcy5tX3JhZGl1cyArIGxlbmd0aFNxclZlYzIodGhpcy5tX3ApKTtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLmNvbXB1dGVEaXN0YW5jZVByb3h5ID0gZnVuY3Rpb24ocHJveHkpIHtcbiAgICAgICAgcHJveHkubV92ZXJ0aWNlc1swXSA9IHRoaXMubV9wO1xuICAgICAgICBwcm94eS5tX3ZlcnRpY2VzLmxlbmd0aCA9IDE7XG4gICAgICAgIHByb3h5Lm1fY291bnQgPSAxO1xuICAgICAgICBwcm94eS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLlRZUEUgPSBcImNpcmNsZVwiO1xuICAgICAgcmV0dXJuIENpcmNsZVNoYXBlMjtcbiAgICB9KFNoYXBlKVxuICApO1xuICB2YXIgbWF0aF9hYnMkNSA9IE1hdGguYWJzO1xuICB2YXIgbWF0aF9QSSQzID0gTWF0aC5QSTtcbiAgdmFyIERFRkFVTFRTJGEgPSB7XG4gICAgZnJlcXVlbmN5SHo6IDAsXG4gICAgZGFtcGluZ1JhdGlvOiAwXG4gIH07XG4gIHZhciBEaXN0YW5jZUpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhEaXN0YW5jZUpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIERpc3RhbmNlSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3JBLCBhbmNob3JCKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgRGlzdGFuY2VKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBEaXN0YW5jZUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yQSwgYW5jaG9yQik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJvZHlCICYmIGFuY2hvckEgJiYgXCJtX3R5cGVcIiBpbiBhbmNob3JBICYmIFwieFwiIGluIGJvZHlCICYmIFwieVwiIGluIGJvZHlCKSB7XG4gICAgICAgICAgdmFyIHRlbXAzID0gYm9keUI7XG4gICAgICAgICAgYm9keUIgPSBhbmNob3JBO1xuICAgICAgICAgIGFuY2hvckEgPSB0ZW1wMztcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkYSk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBEaXN0YW5jZUpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoYW5jaG9yQSA/IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yQSkgOiBkZWYubG9jYWxBbmNob3JBIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLmNsb25lKGFuY2hvckIgPyBib2R5Qi5nZXRMb2NhbFBvaW50KGFuY2hvckIpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fbGVuZ3RoID0gTnVtYmVyLmlzRmluaXRlKGRlZi5sZW5ndGgpID8gZGVmLmxlbmd0aCA6IFZlYzIuZGlzdGFuY2UoYm9keUEuZ2V0V29ybGRQb2ludChfdGhpcy5tX2xvY2FsQW5jaG9yQSksIGJvZHlCLmdldFdvcmxkUG9pbnQoX3RoaXMubV9sb2NhbEFuY2hvckIpKTtcbiAgICAgICAgX3RoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgICAgX3RoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX2dhbW1hID0gMDtcbiAgICAgICAgX3RoaXMubV9iaWFzID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgZnJlcXVlbmN5SHo6IHRoaXMubV9mcmVxdWVuY3lIeixcbiAgICAgICAgICBkYW1waW5nUmF0aW86IHRoaXMubV9kYW1waW5nUmF0aW8sXG4gICAgICAgICAgbG9jYWxBbmNob3JBOiB0aGlzLm1fbG9jYWxBbmNob3JBLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQixcbiAgICAgICAgICBsZW5ndGg6IHRoaXMubV9sZW5ndGgsXG4gICAgICAgICAgaW1wdWxzZTogdGhpcy5tX2ltcHVsc2UsXG4gICAgICAgICAgZ2FtbWE6IHRoaXMubV9nYW1tYSxcbiAgICAgICAgICBiaWFzOiB0aGlzLm1fYmlhc1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgRGlzdGFuY2VKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMih0aGlzLm1fYm9keUEuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQSkpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5hbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKHRoaXMubV9ib2R5Qi5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JCKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMihkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fbGVuZ3RoID0gK2RlZi5sZW5ndGg7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxlbmd0aCA8IDApIDtcbiAgICAgICAgZWxzZSBpZiAoZGVmLmFuY2hvckEgfHwgZGVmLmFuY2hvckEgfHwgZGVmLmFuY2hvckEgfHwgZGVmLmFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbGVuZ3RoID0gVmVjMi5kaXN0YW5jZSh0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKSwgdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmZyZXF1ZW5jeUh6KSkge1xuICAgICAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5kYW1waW5nUmF0aW8pKSB7XG4gICAgICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLnNldExlbmd0aCA9IGZ1bmN0aW9uKGxlbmd0aCkge1xuICAgICAgICB0aGlzLm1fbGVuZ3RoID0gbGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXRMZW5ndGggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sZW5ndGg7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLnNldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uKGh6KSB7XG4gICAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGh6O1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXRGcmVxdWVuY3kgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuc2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24ocmF0aW8pIHtcbiAgICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IHJhdGlvO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9kYW1waW5nUmF0aW87XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5tdWxOdW1WZWMyKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fdSkubXVsKGludl9kdCk7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHRoaXMubV9yQSA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHRoaXMubV91ID0gVmVjMi5zdWIoVmVjMi5hZGQoY0IyLCB0aGlzLm1fckIpLCBWZWMyLmFkZChjQTIsIHRoaXMubV9yQSkpO1xuICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5tX3UubGVuZ3RoKCk7XG4gICAgICAgIGlmIChsZW5ndGggPiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3ApIHtcbiAgICAgICAgICB0aGlzLm1fdS5tdWwoMSAvIGxlbmd0aCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3Uuc2V0TnVtKDAsIDApO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjckF1ID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgdGhpcy5tX3UpO1xuICAgICAgICB2YXIgY3JCdSA9IFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIHRoaXMubV91KTtcbiAgICAgICAgdmFyIGludk1hc3MgPSB0aGlzLm1faW52TWFzc0EgKyB0aGlzLm1faW52SUEgKiBjckF1ICogY3JBdSArIHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQiAqIGNyQnUgKiBjckJ1O1xuICAgICAgICB0aGlzLm1fbWFzcyA9IGludk1hc3MgIT0gMCA/IDEgLyBpbnZNYXNzIDogMDtcbiAgICAgICAgaWYgKHRoaXMubV9mcmVxdWVuY3lIeiA+IDApIHtcbiAgICAgICAgICB2YXIgQyA9IGxlbmd0aCAtIHRoaXMubV9sZW5ndGg7XG4gICAgICAgICAgdmFyIG9tZWdhID0gMiAqIG1hdGhfUEkkMyAqIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgICAgICB2YXIgZDIgPSAyICogdGhpcy5tX21hc3MgKiB0aGlzLm1fZGFtcGluZ1JhdGlvICogb21lZ2E7XG4gICAgICAgICAgdmFyIGsgPSB0aGlzLm1fbWFzcyAqIG9tZWdhICogb21lZ2E7XG4gICAgICAgICAgdmFyIGggPSBzdGVwLmR0O1xuICAgICAgICAgIHRoaXMubV9nYW1tYSA9IGggKiAoZDIgKyBoICogayk7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gdGhpcy5tX2dhbW1hICE9IDAgPyAxIC8gdGhpcy5tX2dhbW1hIDogMDtcbiAgICAgICAgICB0aGlzLm1fYmlhcyA9IEMgKiBoICogayAqIHRoaXMubV9nYW1tYTtcbiAgICAgICAgICBpbnZNYXNzICs9IHRoaXMubV9nYW1tYTtcbiAgICAgICAgICB0aGlzLm1fbWFzcyA9IGludk1hc3MgIT0gMCA/IDEgLyBpbnZNYXNzIDogMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICAgIHRoaXMubV9iaWFzID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fdSk7XG4gICAgICAgICAgdkEyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgICB3QSAtPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMyk7XG4gICAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFAzKTtcbiAgICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdnBBID0gVmVjMi5hZGQodkEyLCBWZWMyLmNyb3NzTnVtVmVjMih3QSwgdGhpcy5tX3JBKSk7XG4gICAgICAgIHZhciB2cEIgPSBWZWMyLmFkZCh2QjIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpKTtcbiAgICAgICAgdmFyIENkb3QgPSBWZWMyLmRvdCh0aGlzLm1fdSwgdnBCKSAtIFZlYzIuZG90KHRoaXMubV91LCB2cEEpO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbWFzcyAqIChDZG90ICsgdGhpcy5tX2JpYXMgKyB0aGlzLm1fZ2FtbWEgKiB0aGlzLm1faW1wdWxzZSk7XG4gICAgICAgIHRoaXMubV9pbXB1bHNlICs9IGltcHVsc2U7XG4gICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihpbXB1bHNlLCB0aGlzLm1fdSk7XG4gICAgICAgIHZBMi5zdWJNdWwodGhpcy5tX2ludk1hc3NBLCBQMyk7XG4gICAgICAgIHdBIC09IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKTtcbiAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFAzKTtcbiAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52LnNldFZlYzIodkEyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIGlmICh0aGlzLm1fZnJlcXVlbmN5SHogPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsU3ViKHFBLCB0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxTdWIocUIsIHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpO1xuICAgICAgICB2YXIgdSA9IFZlYzIuc3ViKFZlYzIuYWRkKGNCMiwgckIyKSwgVmVjMi5hZGQoY0EyLCByQTIpKTtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHUubm9ybWFsaXplKCk7XG4gICAgICAgIHZhciBDID0gY2xhbXAobGVuZ3RoIC0gdGhpcy5tX2xlbmd0aCwgLVNldHRpbmdzSW50ZXJuYWwubWF4TGluZWFyQ29ycmVjdGlvbiwgU2V0dGluZ3NJbnRlcm5hbC5tYXhMaW5lYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21hc3MgKiBDO1xuICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoaW1wdWxzZSwgdSk7XG4gICAgICAgIGNBMi5zdWJNdWwodGhpcy5tX2ludk1hc3NBLCBQMyk7XG4gICAgICAgIGFBIC09IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIFAzKTtcbiAgICAgICAgY0IyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFAzKTtcbiAgICAgICAgYUIgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgUDMpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jLnNldFZlYzIoY0EyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jLnNldFZlYzIoY0IyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICByZXR1cm4gbWF0aF9hYnMkNShDKSA8IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5UWVBFID0gXCJkaXN0YW5jZS1qb2ludFwiO1xuICAgICAgcmV0dXJuIERpc3RhbmNlSm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBERUZBVUxUUyQ5ID0ge1xuICAgIG1heEZvcmNlOiAwLFxuICAgIG1heFRvcnF1ZTogMFxuICB9O1xuICB2YXIgRnJpY3Rpb25Kb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoRnJpY3Rpb25Kb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBGcmljdGlvbkpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgRnJpY3Rpb25Kb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBGcmljdGlvbkpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkOSk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBGcmljdGlvbkpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQSB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5Qi5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JCIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9saW5lYXJJbXB1bHNlID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fYW5ndWxhckltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX21heEZvcmNlID0gZGVmLm1heEZvcmNlO1xuICAgICAgICBfdGhpcy5tX21heFRvcnF1ZSA9IGRlZi5tYXhUb3JxdWU7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIG1heEZvcmNlOiB0aGlzLm1fbWF4Rm9yY2UsXG4gICAgICAgICAgbWF4VG9ycXVlOiB0aGlzLm1fbWF4VG9ycXVlLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckJcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IEZyaWN0aW9uSm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoZGVmLmFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIodGhpcy5tX2JvZHlBLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckEpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMih0aGlzLm1fYm9keUIuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQikpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4Rm9yY2UpKSB7XG4gICAgICAgICAgdGhpcy5tX21heEZvcmNlID0gZGVmLm1heEZvcmNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1heFRvcnF1ZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4VG9ycXVlID0gZGVmLm1heFRvcnF1ZTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckE7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuc2V0TWF4Rm9yY2UgPSBmdW5jdGlvbihmb3JjZSkge1xuICAgICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBmb3JjZTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0TWF4Rm9yY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhGb3JjZTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuc2V0TWF4VG9ycXVlID0gZnVuY3Rpb24odG9ycXVlKSB7XG4gICAgICAgIHRoaXMubV9tYXhUb3JxdWUgPSB0b3JxdWU7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmdldE1heFRvcnF1ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heFRvcnF1ZTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm11bE51bVZlYzIoaW52X2R0LCB0aGlzLm1fbGluZWFySW1wdWxzZSk7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1fYW5ndWxhckltcHVsc2U7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHRoaXMubV9yQSA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIEsgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgSy5leC54ID0gbUEgKyBtQiArIGlBICogdGhpcy5tX3JBLnkgKiB0aGlzLm1fckEueSArIGlCICogdGhpcy5tX3JCLnkgKiB0aGlzLm1fckIueTtcbiAgICAgICAgSy5leC55ID0gLWlBICogdGhpcy5tX3JBLnggKiB0aGlzLm1fckEueSAtIGlCICogdGhpcy5tX3JCLnggKiB0aGlzLm1fckIueTtcbiAgICAgICAgSy5leS54ID0gSy5leC55O1xuICAgICAgICBLLmV5LnkgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fckEueCAqIHRoaXMubV9yQS54ICsgaUIgKiB0aGlzLm1fckIueCAqIHRoaXMubV9yQi54O1xuICAgICAgICB0aGlzLm1fbGluZWFyTWFzcyA9IEsuZ2V0SW52ZXJzZSgpO1xuICAgICAgICB0aGlzLm1fYW5ndWxhck1hc3MgPSBpQSArIGlCO1xuICAgICAgICBpZiAodGhpcy5tX2FuZ3VsYXJNYXNzID4gMCkge1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFyTWFzcyA9IDEgLyB0aGlzLm1fYW5ndWxhck1hc3M7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UubXVsKHN0ZXAuZHRSYXRpbyk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm5lbyh0aGlzLm1fbGluZWFySW1wdWxzZS54LCB0aGlzLm1fbGluZWFySW1wdWxzZS55KTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpICsgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpICsgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIGggPSBzdGVwLmR0O1xuICAgICAgICB7XG4gICAgICAgICAgdmFyIENkb3QgPSB3QiAtIHdBO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9hbmd1bGFyTWFzcyAqIENkb3Q7XG4gICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fYW5ndWxhckltcHVsc2U7XG4gICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBoICogdGhpcy5tX21heFRvcnF1ZTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgPSBjbGFtcCh0aGlzLm1fYW5ndWxhckltcHVsc2UgKyBpbXB1bHNlLCAtbWF4SW1wdWxzZSwgbWF4SW1wdWxzZSk7XG4gICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9hbmd1bGFySW1wdWxzZSAtIG9sZEltcHVsc2U7XG4gICAgICAgICAgd0EgLT0gaUEgKiBpbXB1bHNlO1xuICAgICAgICAgIHdCICs9IGlCICogaW1wdWxzZTtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgdmFyIENkb3QgPSBWZWMyLnN1YihWZWMyLmFkZCh2QjIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpKSwgVmVjMi5hZGQodkEyLCBWZWMyLmNyb3NzTnVtVmVjMih3QSwgdGhpcy5tX3JBKSkpO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gVmVjMi5uZWcoTWF0MjIubXVsVmVjMih0aGlzLm1fbGluZWFyTWFzcywgQ2RvdCkpO1xuICAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX2xpbmVhckltcHVsc2U7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuYWRkKGltcHVsc2UpO1xuICAgICAgICAgIHZhciBtYXhJbXB1bHNlID0gaCAqIHRoaXMubV9tYXhGb3JjZTtcbiAgICAgICAgICBpZiAodGhpcy5tX2xpbmVhckltcHVsc2UubGVuZ3RoU3F1YXJlZCgpID4gbWF4SW1wdWxzZSAqIG1heEltcHVsc2UpIHtcbiAgICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLm5vcm1hbGl6ZSgpO1xuICAgICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UubXVsKG1heEltcHVsc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpbXB1bHNlID0gVmVjMi5zdWIodGhpcy5tX2xpbmVhckltcHVsc2UsIG9sZEltcHVsc2UpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIGltcHVsc2UpO1xuICAgICAgICAgIHdBIC09IGlBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgaW1wdWxzZSk7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgaW1wdWxzZSk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBpbXB1bHNlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5UWVBFID0gXCJmcmljdGlvbi1qb2ludFwiO1xuICAgICAgcmV0dXJuIEZyaWN0aW9uSm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBNYXQzMyA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBNYXQzMzIoYTIsIGIyLCBjMikge1xuICAgICAgICBpZiAodHlwZW9mIGEyID09PSBcIm9iamVjdFwiICYmIGEyICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5leCA9IFZlYzMuY2xvbmUoYTIpO1xuICAgICAgICAgIHRoaXMuZXkgPSBWZWMzLmNsb25lKGIyKTtcbiAgICAgICAgICB0aGlzLmV6ID0gVmVjMy5jbG9uZShjMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5leCA9IFZlYzMuemVybygpO1xuICAgICAgICAgIHRoaXMuZXkgPSBWZWMzLnplcm8oKTtcbiAgICAgICAgICB0aGlzLmV6ID0gVmVjMy56ZXJvKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIE1hdDMzMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMpO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5pc1ZhbGlkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gVmVjMy5pc1ZhbGlkKG9iai5leCkgJiYgVmVjMy5pc1ZhbGlkKG9iai5leSkgJiYgVmVjMy5pc1ZhbGlkKG9iai5leik7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLmFzc2VydCA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIH07XG4gICAgICBNYXQzMzIucHJvdG90eXBlLnNldFplcm8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5leC5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMuZXkuc2V0WmVybygpO1xuICAgICAgICB0aGlzLmV6LnNldFplcm8oKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLnByb3RvdHlwZS5zb2x2ZTMzID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgdmFyIGNyb3NzX3ggPSB0aGlzLmV5LnkgKiB0aGlzLmV6LnogLSB0aGlzLmV5LnogKiB0aGlzLmV6Lnk7XG4gICAgICAgIHZhciBjcm9zc195ID0gdGhpcy5leS56ICogdGhpcy5lei54IC0gdGhpcy5leS54ICogdGhpcy5lei56O1xuICAgICAgICB2YXIgY3Jvc3NfeiA9IHRoaXMuZXkueCAqIHRoaXMuZXoueSAtIHRoaXMuZXkueSAqIHRoaXMuZXoueDtcbiAgICAgICAgdmFyIGRldCA9IHRoaXMuZXgueCAqIGNyb3NzX3ggKyB0aGlzLmV4LnkgKiBjcm9zc195ICsgdGhpcy5leC56ICogY3Jvc3NfejtcbiAgICAgICAgaWYgKGRldCAhPT0gMCkge1xuICAgICAgICAgIGRldCA9IDEgLyBkZXQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHIgPSBuZXcgVmVjMygpO1xuICAgICAgICBjcm9zc194ID0gdGhpcy5leS55ICogdGhpcy5lei56IC0gdGhpcy5leS56ICogdGhpcy5lei55O1xuICAgICAgICBjcm9zc195ID0gdGhpcy5leS56ICogdGhpcy5lei54IC0gdGhpcy5leS54ICogdGhpcy5lei56O1xuICAgICAgICBjcm9zc196ID0gdGhpcy5leS54ICogdGhpcy5lei55IC0gdGhpcy5leS55ICogdGhpcy5lei54O1xuICAgICAgICByLnggPSBkZXQgKiAodjMueCAqIGNyb3NzX3ggKyB2My55ICogY3Jvc3NfeSArIHYzLnogKiBjcm9zc196KTtcbiAgICAgICAgY3Jvc3NfeCA9IHYzLnkgKiB0aGlzLmV6LnogLSB2My56ICogdGhpcy5lei55O1xuICAgICAgICBjcm9zc195ID0gdjMueiAqIHRoaXMuZXoueCAtIHYzLnggKiB0aGlzLmV6Lno7XG4gICAgICAgIGNyb3NzX3ogPSB2My54ICogdGhpcy5lei55IC0gdjMueSAqIHRoaXMuZXoueDtcbiAgICAgICAgci55ID0gZGV0ICogKHRoaXMuZXgueCAqIGNyb3NzX3ggKyB0aGlzLmV4LnkgKiBjcm9zc195ICsgdGhpcy5leC56ICogY3Jvc3Nfeik7XG4gICAgICAgIGNyb3NzX3ggPSB0aGlzLmV5LnkgKiB2My56IC0gdGhpcy5leS56ICogdjMueTtcbiAgICAgICAgY3Jvc3NfeSA9IHRoaXMuZXkueiAqIHYzLnggLSB0aGlzLmV5LnggKiB2My56O1xuICAgICAgICBjcm9zc196ID0gdGhpcy5leS54ICogdjMueSAtIHRoaXMuZXkueSAqIHYzLng7XG4gICAgICAgIHIueiA9IGRldCAqICh0aGlzLmV4LnggKiBjcm9zc194ICsgdGhpcy5leC55ICogY3Jvc3NfeSArIHRoaXMuZXgueiAqIGNyb3NzX3opO1xuICAgICAgICByZXR1cm4gcjtcbiAgICAgIH07XG4gICAgICBNYXQzMzIucHJvdG90eXBlLnNvbHZlMjIgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICB2YXIgYTExID0gdGhpcy5leC54O1xuICAgICAgICB2YXIgYTEyID0gdGhpcy5leS54O1xuICAgICAgICB2YXIgYTIxID0gdGhpcy5leC55O1xuICAgICAgICB2YXIgYTIyID0gdGhpcy5leS55O1xuICAgICAgICB2YXIgZGV0ID0gYTExICogYTIyIC0gYTEyICogYTIxO1xuICAgICAgICBpZiAoZGV0ICE9PSAwKSB7XG4gICAgICAgICAgZGV0ID0gMSAvIGRldDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgciA9IFZlYzIuemVybygpO1xuICAgICAgICByLnggPSBkZXQgKiAoYTIyICogdjMueCAtIGExMiAqIHYzLnkpO1xuICAgICAgICByLnkgPSBkZXQgKiAoYTExICogdjMueSAtIGEyMSAqIHYzLngpO1xuICAgICAgICByZXR1cm4gcjtcbiAgICAgIH07XG4gICAgICBNYXQzMzIucHJvdG90eXBlLmdldEludmVyc2UyMiA9IGZ1bmN0aW9uKE0pIHtcbiAgICAgICAgdmFyIGEyID0gdGhpcy5leC54O1xuICAgICAgICB2YXIgYjIgPSB0aGlzLmV5Lng7XG4gICAgICAgIHZhciBjMiA9IHRoaXMuZXgueTtcbiAgICAgICAgdmFyIGQyID0gdGhpcy5leS55O1xuICAgICAgICB2YXIgZGV0ID0gYTIgKiBkMiAtIGIyICogYzI7XG4gICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICBkZXQgPSAxIC8gZGV0O1xuICAgICAgICB9XG4gICAgICAgIE0uZXgueCA9IGRldCAqIGQyO1xuICAgICAgICBNLmV5LnggPSAtZGV0ICogYjI7XG4gICAgICAgIE0uZXgueiA9IDA7XG4gICAgICAgIE0uZXgueSA9IC1kZXQgKiBjMjtcbiAgICAgICAgTS5leS55ID0gZGV0ICogYTI7XG4gICAgICAgIE0uZXkueiA9IDA7XG4gICAgICAgIE0uZXoueCA9IDA7XG4gICAgICAgIE0uZXoueSA9IDA7XG4gICAgICAgIE0uZXoueiA9IDA7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLnByb3RvdHlwZS5nZXRTeW1JbnZlcnNlMzMgPSBmdW5jdGlvbihNKSB7XG4gICAgICAgIHZhciBkZXQgPSBWZWMzLmRvdCh0aGlzLmV4LCBWZWMzLmNyb3NzKHRoaXMuZXksIHRoaXMuZXopKTtcbiAgICAgICAgaWYgKGRldCAhPT0gMCkge1xuICAgICAgICAgIGRldCA9IDEgLyBkZXQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGExMSA9IHRoaXMuZXgueDtcbiAgICAgICAgdmFyIGExMiA9IHRoaXMuZXkueDtcbiAgICAgICAgdmFyIGExMyA9IHRoaXMuZXoueDtcbiAgICAgICAgdmFyIGEyMiA9IHRoaXMuZXkueTtcbiAgICAgICAgdmFyIGEyMyA9IHRoaXMuZXoueTtcbiAgICAgICAgdmFyIGEzMyA9IHRoaXMuZXouejtcbiAgICAgICAgTS5leC54ID0gZGV0ICogKGEyMiAqIGEzMyAtIGEyMyAqIGEyMyk7XG4gICAgICAgIE0uZXgueSA9IGRldCAqIChhMTMgKiBhMjMgLSBhMTIgKiBhMzMpO1xuICAgICAgICBNLmV4LnogPSBkZXQgKiAoYTEyICogYTIzIC0gYTEzICogYTIyKTtcbiAgICAgICAgTS5leS54ID0gTS5leC55O1xuICAgICAgICBNLmV5LnkgPSBkZXQgKiAoYTExICogYTMzIC0gYTEzICogYTEzKTtcbiAgICAgICAgTS5leS56ID0gZGV0ICogKGExMyAqIGExMiAtIGExMSAqIGEyMyk7XG4gICAgICAgIE0uZXoueCA9IE0uZXguejtcbiAgICAgICAgTS5lei55ID0gTS5leS56O1xuICAgICAgICBNLmV6LnogPSBkZXQgKiAoYTExICogYTIyIC0gYTEyICogYTEyKTtcbiAgICAgIH07XG4gICAgICBNYXQzMzIubXVsID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIGlmIChiMiAmJiBcInpcIiBpbiBiMiAmJiBcInlcIiBpbiBiMiAmJiBcInhcIiBpbiBiMikge1xuICAgICAgICAgIHZhciB4MiA9IGEyLmV4LnggKiBiMi54ICsgYTIuZXkueCAqIGIyLnkgKyBhMi5lei54ICogYjIuejtcbiAgICAgICAgICB2YXIgeSA9IGEyLmV4LnkgKiBiMi54ICsgYTIuZXkueSAqIGIyLnkgKyBhMi5lei55ICogYjIuejtcbiAgICAgICAgICB2YXIgeiA9IGEyLmV4LnogKiBiMi54ICsgYTIuZXkueiAqIGIyLnkgKyBhMi5lei56ICogYjIuejtcbiAgICAgICAgICByZXR1cm4gbmV3IFZlYzMoeDIsIHksIHopO1xuICAgICAgICB9IGVsc2UgaWYgKGIyICYmIFwieVwiIGluIGIyICYmIFwieFwiIGluIGIyKSB7XG4gICAgICAgICAgdmFyIHgyID0gYTIuZXgueCAqIGIyLnggKyBhMi5leS54ICogYjIueTtcbiAgICAgICAgICB2YXIgeSA9IGEyLmV4LnkgKiBiMi54ICsgYTIuZXkueSAqIGIyLnk7XG4gICAgICAgICAgcmV0dXJuIFZlYzIubmVvKHgyLCB5KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1hdDMzMi5tdWxWZWMzID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciB4MiA9IGEyLmV4LnggKiBiMi54ICsgYTIuZXkueCAqIGIyLnkgKyBhMi5lei54ICogYjIuejtcbiAgICAgICAgdmFyIHkgPSBhMi5leC55ICogYjIueCArIGEyLmV5LnkgKiBiMi55ICsgYTIuZXoueSAqIGIyLno7XG4gICAgICAgIHZhciB6ID0gYTIuZXgueiAqIGIyLnggKyBhMi5leS56ICogYjIueSArIGEyLmV6LnogKiBiMi56O1xuICAgICAgICByZXR1cm4gbmV3IFZlYzMoeDIsIHksIHopO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5tdWxWZWMyID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciB4MiA9IGEyLmV4LnggKiBiMi54ICsgYTIuZXkueCAqIGIyLnk7XG4gICAgICAgIHZhciB5ID0gYTIuZXgueSAqIGIyLnggKyBhMi5leS55ICogYjIueTtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHgyLCB5KTtcbiAgICAgIH07XG4gICAgICBNYXQzMzIuYWRkID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHJldHVybiBuZXcgTWF0MzMyKFZlYzMuYWRkKGEyLmV4LCBiMi5leCksIFZlYzMuYWRkKGEyLmV5LCBiMi5leSksIFZlYzMuYWRkKGEyLmV6LCBiMi5leikpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBNYXQzMzI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX2FicyQ0ID0gTWF0aC5hYnM7XG4gIHZhciBMaW1pdFN0YXRlJDI7XG4gIChmdW5jdGlvbihMaW1pdFN0YXRlMikge1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiaW5hY3RpdmVMaW1pdFwiXSA9IDBdID0gXCJpbmFjdGl2ZUxpbWl0XCI7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJhdExvd2VyTGltaXRcIl0gPSAxXSA9IFwiYXRMb3dlckxpbWl0XCI7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJhdFVwcGVyTGltaXRcIl0gPSAyXSA9IFwiYXRVcHBlckxpbWl0XCI7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJlcXVhbExpbWl0c1wiXSA9IDNdID0gXCJlcXVhbExpbWl0c1wiO1xuICB9KShMaW1pdFN0YXRlJDIgfHwgKExpbWl0U3RhdGUkMiA9IHt9KSk7XG4gIHZhciBERUZBVUxUUyQ4ID0ge1xuICAgIGxvd2VyQW5nbGU6IDAsXG4gICAgdXBwZXJBbmdsZTogMCxcbiAgICBtYXhNb3RvclRvcnF1ZTogMCxcbiAgICBtb3RvclNwZWVkOiAwLFxuICAgIGVuYWJsZUxpbWl0OiBmYWxzZSxcbiAgICBlbmFibGVNb3RvcjogZmFsc2VcbiAgfTtcbiAgdmFyIFJldm9sdXRlSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFJldm9sdXRlSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gUmV2b2x1dGVKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgX2EyLCBfYiwgX2MsIF9kLCBfZSwgX2Y7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgUmV2b2x1dGVKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBSZXZvbHV0ZUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBkZWYgIT09IG51bGwgJiYgZGVmICE9PSB2b2lkIDAgPyBkZWYgOiB7fTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fbWFzcyA9IG5ldyBNYXQzMygpO1xuICAgICAgICBfdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDIuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgX3RoaXMubV90eXBlID0gUmV2b2x1dGVKb2ludDIuVFlQRTtcbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChhbmNob3IpKSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBib2R5QS5nZXRMb2NhbFBvaW50KGFuY2hvcik7XG4gICAgICAgIH0gZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5sb2NhbEFuY2hvckEpKSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLmNsb25lKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChhbmNob3IpKSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBib2R5Qi5nZXRMb2NhbFBvaW50KGFuY2hvcik7XG4gICAgICAgIH0gZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5sb2NhbEFuY2hvckIpKSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLmNsb25lKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYucmVmZXJlbmNlQW5nbGUpKSB7XG4gICAgICAgICAgX3RoaXMubV9yZWZlcmVuY2VBbmdsZSA9IGRlZi5yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlID0gYm9keUIuZ2V0QW5nbGUoKSAtIGJvZHlBLmdldEFuZ2xlKCk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gbmV3IFZlYzMoKTtcbiAgICAgICAgX3RoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX2xvd2VyQW5nbGUgPSAoX2EyID0gZGVmLmxvd2VyQW5nbGUpICE9PSBudWxsICYmIF9hMiAhPT0gdm9pZCAwID8gX2EyIDogREVGQVVMVFMkOC5sb3dlckFuZ2xlO1xuICAgICAgICBfdGhpcy5tX3VwcGVyQW5nbGUgPSAoX2IgPSBkZWYudXBwZXJBbmdsZSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogREVGQVVMVFMkOC51cHBlckFuZ2xlO1xuICAgICAgICBfdGhpcy5tX21heE1vdG9yVG9ycXVlID0gKF9jID0gZGVmLm1heE1vdG9yVG9ycXVlKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiBERUZBVUxUUyQ4Lm1heE1vdG9yVG9ycXVlO1xuICAgICAgICBfdGhpcy5tX21vdG9yU3BlZWQgPSAoX2QgPSBkZWYubW90b3JTcGVlZCkgIT09IG51bGwgJiYgX2QgIT09IHZvaWQgMCA/IF9kIDogREVGQVVMVFMkOC5tb3RvclNwZWVkO1xuICAgICAgICBfdGhpcy5tX2VuYWJsZUxpbWl0ID0gKF9lID0gZGVmLmVuYWJsZUxpbWl0KSAhPT0gbnVsbCAmJiBfZSAhPT0gdm9pZCAwID8gX2UgOiBERUZBVUxUUyQ4LmVuYWJsZUxpbWl0O1xuICAgICAgICBfdGhpcy5tX2VuYWJsZU1vdG9yID0gKF9mID0gZGVmLmVuYWJsZU1vdG9yKSAhPT0gbnVsbCAmJiBfZiAhPT0gdm9pZCAwID8gX2YgOiBERUZBVUxUUyQ4LmVuYWJsZU1vdG9yO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBsb3dlckFuZ2xlOiB0aGlzLm1fbG93ZXJBbmdsZSxcbiAgICAgICAgICB1cHBlckFuZ2xlOiB0aGlzLm1fdXBwZXJBbmdsZSxcbiAgICAgICAgICBtYXhNb3RvclRvcnF1ZTogdGhpcy5tX21heE1vdG9yVG9ycXVlLFxuICAgICAgICAgIG1vdG9yU3BlZWQ6IHRoaXMubV9tb3RvclNwZWVkLFxuICAgICAgICAgIGVuYWJsZUxpbWl0OiB0aGlzLm1fZW5hYmxlTGltaXQsXG4gICAgICAgICAgZW5hYmxlTW90b3I6IHRoaXMubV9lbmFibGVNb3RvcixcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCLFxuICAgICAgICAgIHJlZmVyZW5jZUFuZ2xlOiB0aGlzLm1fcmVmZXJlbmNlQW5nbGVcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IFJldm9sdXRlSm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoZGVmLmFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIodGhpcy5tX2JvZHlBLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckEpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMih0aGlzLm1fYm9keUIuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQikpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYucmVmZXJlbmNlQW5nbGUpKSB7XG4gICAgICAgICAgdGhpcy5tX3JlZmVyZW5jZUFuZ2xlID0gZGVmLnJlZmVyZW5jZUFuZ2xlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuZW5hYmxlTGltaXQgIT09IHZvaWQgMCkge1xuICAgICAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9IGRlZi5lbmFibGVMaW1pdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5sb3dlckFuZ2xlKSkge1xuICAgICAgICAgIHRoaXMubV9sb3dlckFuZ2xlID0gZGVmLmxvd2VyQW5nbGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYudXBwZXJBbmdsZSkpIHtcbiAgICAgICAgICB0aGlzLm1fdXBwZXJBbmdsZSA9IGRlZi51cHBlckFuZ2xlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1heE1vdG9yVG9ycXVlKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhNb3RvclRvcnF1ZSA9IGRlZi5tYXhNb3RvclRvcnF1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tb3RvclNwZWVkKSkge1xuICAgICAgICAgIHRoaXMubV9tb3RvclNwZWVkID0gZGVmLm1vdG9yU3BlZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5lbmFibGVNb3RvciAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZGVmLmVuYWJsZU1vdG9yO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JCO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWZlcmVuY2VBbmdsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludEFuZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgICByZXR1cm4gYkIubV9zd2VlcC5hIC0gYkEubV9zd2VlcC5hIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludFNwZWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgICByZXR1cm4gYkIubV9hbmd1bGFyVmVsb2NpdHkgLSBiQS5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuaXNNb3RvckVuYWJsZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9lbmFibGVNb3RvcjtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZW5hYmxlTW90b3IgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnID09IHRoaXMubV9lbmFibGVNb3RvcilcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBmbGFnO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRNb3RvclRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuc2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uKHNwZWVkKSB7XG4gICAgICAgIGlmIChzcGVlZCA9PSB0aGlzLm1fbW90b3JTcGVlZClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IHNwZWVkO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRNb3RvclNwZWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbW90b3JTcGVlZDtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuc2V0TWF4TW90b3JUb3JxdWUgPSBmdW5jdGlvbih0b3JxdWUpIHtcbiAgICAgICAgaWYgKHRvcnF1ZSA9PSB0aGlzLm1fbWF4TW90b3JUb3JxdWUpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX21heE1vdG9yVG9ycXVlID0gdG9ycXVlO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhNb3RvclRvcnF1ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heE1vdG9yVG9ycXVlO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5pc0xpbWl0RW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZUxpbWl0O1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5lbmFibGVMaW1pdCA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcgIT0gdGhpcy5tX2VuYWJsZUxpbWl0KSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSBmbGFnO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldExvd2VyTGltaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb3dlckFuZ2xlO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRVcHBlckxpbWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdXBwZXJBbmdsZTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuc2V0TGltaXRzID0gZnVuY3Rpb24obG93ZXIsIHVwcGVyKSB7XG4gICAgICAgIGlmIChsb3dlciAhPSB0aGlzLm1fbG93ZXJBbmdsZSB8fCB1cHBlciAhPSB0aGlzLm1fdXBwZXJBbmdsZSkge1xuICAgICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgdGhpcy5tX2xvd2VyQW5nbGUgPSBsb3dlcjtcbiAgICAgICAgICB0aGlzLm1fdXBwZXJBbmdsZSA9IHVwcGVyO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8odGhpcy5tX2ltcHVsc2UueCwgdGhpcy5tX2ltcHVsc2UueSkubXVsKGludl9kdCk7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS56O1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB0aGlzLm1fckEgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB0aGlzLm1fckIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciBmaXhlZFJvdGF0aW9uID0gaUEgKyBpQiA9PT0gMDtcbiAgICAgICAgdGhpcy5tX21hc3MuZXgueCA9IG1BICsgbUIgKyB0aGlzLm1fckEueSAqIHRoaXMubV9yQS55ICogaUEgKyB0aGlzLm1fckIueSAqIHRoaXMubV9yQi55ICogaUI7XG4gICAgICAgIHRoaXMubV9tYXNzLmV5LnggPSAtdGhpcy5tX3JBLnkgKiB0aGlzLm1fckEueCAqIGlBIC0gdGhpcy5tX3JCLnkgKiB0aGlzLm1fckIueCAqIGlCO1xuICAgICAgICB0aGlzLm1fbWFzcy5lei54ID0gLXRoaXMubV9yQS55ICogaUEgLSB0aGlzLm1fckIueSAqIGlCO1xuICAgICAgICB0aGlzLm1fbWFzcy5leC55ID0gdGhpcy5tX21hc3MuZXkueDtcbiAgICAgICAgdGhpcy5tX21hc3MuZXkueSA9IG1BICsgbUIgKyB0aGlzLm1fckEueCAqIHRoaXMubV9yQS54ICogaUEgKyB0aGlzLm1fckIueCAqIHRoaXMubV9yQi54ICogaUI7XG4gICAgICAgIHRoaXMubV9tYXNzLmV6LnkgPSB0aGlzLm1fckEueCAqIGlBICsgdGhpcy5tX3JCLnggKiBpQjtcbiAgICAgICAgdGhpcy5tX21hc3MuZXgueiA9IHRoaXMubV9tYXNzLmV6Lng7XG4gICAgICAgIHRoaXMubV9tYXNzLmV5LnogPSB0aGlzLm1fbWFzcy5lei55O1xuICAgICAgICB0aGlzLm1fbWFzcy5lei56ID0gaUEgKyBpQjtcbiAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IGlBICsgaUI7XG4gICAgICAgIGlmICh0aGlzLm1fbW90b3JNYXNzID4gMCkge1xuICAgICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSAxIC8gdGhpcy5tX21vdG9yTWFzcztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yID09IGZhbHNlIHx8IGZpeGVkUm90YXRpb24pIHtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0ICYmIGZpeGVkUm90YXRpb24gPT0gZmFsc2UpIHtcbiAgICAgICAgICB2YXIgam9pbnRBbmdsZSA9IGFCIC0gYUEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICAgaWYgKG1hdGhfYWJzJDQodGhpcy5tX3VwcGVyQW5nbGUgLSB0aGlzLm1fbG93ZXJBbmdsZSkgPCAyICogU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcCkge1xuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDIuZXF1YWxMaW1pdHM7XG4gICAgICAgICAgfSBlbHNlIGlmIChqb2ludEFuZ2xlIDw9IHRoaXMubV9sb3dlckFuZ2xlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQyLmF0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQyLmF0TG93ZXJMaW1pdDtcbiAgICAgICAgICB9IGVsc2UgaWYgKGpvaW50QW5nbGUgPj0gdGhpcy5tX3VwcGVyQW5nbGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDIuYXRVcHBlckxpbWl0KSB7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDIuYXRVcHBlckxpbWl0O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMi5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQyLmluYWN0aXZlTGltaXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UubXVsKHN0ZXAuZHRSYXRpbyk7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5uZW8odGhpcy5tX2ltcHVsc2UueCwgdGhpcy5tX2ltcHVsc2UueSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKSArIHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpICsgdGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIGZpeGVkUm90YXRpb24gPSBpQSArIGlCID09PSAwO1xuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yICYmIHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMi5lcXVhbExpbWl0cyAmJiBmaXhlZFJvdGF0aW9uID09IGZhbHNlKSB7XG4gICAgICAgICAgdmFyIENkb3QgPSB3QiAtIHdBIC0gdGhpcy5tX21vdG9yU3BlZWQ7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21vdG9yTWFzcyAqIENkb3Q7XG4gICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgICAgIHZhciBtYXhJbXB1bHNlID0gc3RlcC5kdCAqIHRoaXMubV9tYXhNb3RvclRvcnF1ZTtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gY2xhbXAodGhpcy5tX21vdG9ySW1wdWxzZSArIGltcHVsc2UsIC1tYXhJbXB1bHNlLCBtYXhJbXB1bHNlKTtcbiAgICAgICAgICBpbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZSAtIG9sZEltcHVsc2U7XG4gICAgICAgICAgd0EgLT0gaUEgKiBpbXB1bHNlO1xuICAgICAgICAgIHdCICs9IGlCICogaW1wdWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0ICYmIHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMi5pbmFjdGl2ZUxpbWl0ICYmIGZpeGVkUm90YXRpb24gPT0gZmFsc2UpIHtcbiAgICAgICAgICB2YXIgQ2RvdDEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBDZG90MS5hZGRDb21iaW5lKDEsIHZCMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpO1xuICAgICAgICAgIENkb3QxLnN1YkNvbWJpbmUoMSwgdkEyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QSwgdGhpcy5tX3JBKSk7XG4gICAgICAgICAgdmFyIENkb3QyID0gd0IgLSB3QTtcbiAgICAgICAgICB2YXIgQ2RvdCA9IG5ldyBWZWMzKENkb3QxLngsIENkb3QxLnksIENkb3QyKTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IFZlYzMubmVnKHRoaXMubV9tYXNzLnNvbHZlMzMoQ2RvdCkpO1xuICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBMaW1pdFN0YXRlJDIuZXF1YWxMaW1pdHMpIHtcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLmFkZChpbXB1bHNlKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IExpbWl0U3RhdGUkMi5hdExvd2VyTGltaXQpIHtcbiAgICAgICAgICAgIHZhciBuZXdJbXB1bHNlID0gdGhpcy5tX2ltcHVsc2UueiArIGltcHVsc2UuejtcbiAgICAgICAgICAgIGlmIChuZXdJbXB1bHNlIDwgMCkge1xuICAgICAgICAgICAgICB2YXIgcmhzID0gVmVjMi5jb21iaW5lKC0xLCBDZG90MSwgdGhpcy5tX2ltcHVsc2UueiwgVmVjMi5uZW8odGhpcy5tX21hc3MuZXoueCwgdGhpcy5tX21hc3MuZXoueSkpO1xuICAgICAgICAgICAgICB2YXIgcmVkdWNlZCA9IHRoaXMubV9tYXNzLnNvbHZlMjIocmhzKTtcbiAgICAgICAgICAgICAgaW1wdWxzZS54ID0gcmVkdWNlZC54O1xuICAgICAgICAgICAgICBpbXB1bHNlLnkgPSByZWR1Y2VkLnk7XG4gICAgICAgICAgICAgIGltcHVsc2UueiA9IC10aGlzLm1faW1wdWxzZS56O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IHJlZHVjZWQueDtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSArPSByZWR1Y2VkLnk7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UuYWRkKGltcHVsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQyLmF0VXBwZXJMaW1pdCkge1xuICAgICAgICAgICAgdmFyIG5ld0ltcHVsc2UgPSB0aGlzLm1faW1wdWxzZS56ICsgaW1wdWxzZS56O1xuICAgICAgICAgICAgaWYgKG5ld0ltcHVsc2UgPiAwKSB7XG4gICAgICAgICAgICAgIHZhciByaHMgPSBWZWMyLmNvbWJpbmUoLTEsIENkb3QxLCB0aGlzLm1faW1wdWxzZS56LCBWZWMyLm5lbyh0aGlzLm1fbWFzcy5lei54LCB0aGlzLm1fbWFzcy5lei55KSk7XG4gICAgICAgICAgICAgIHZhciByZWR1Y2VkID0gdGhpcy5tX21hc3Muc29sdmUyMihyaHMpO1xuICAgICAgICAgICAgICBpbXB1bHNlLnggPSByZWR1Y2VkLng7XG4gICAgICAgICAgICAgIGltcHVsc2UueSA9IHJlZHVjZWQueTtcbiAgICAgICAgICAgICAgaW1wdWxzZS56ID0gLXRoaXMubV9pbXB1bHNlLno7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKz0gcmVkdWNlZC54O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ICs9IHJlZHVjZWQueTtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS5hZGQoaW1wdWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVvKGltcHVsc2UueCwgaW1wdWxzZS55KTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpICsgaW1wdWxzZS56KTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpICsgaW1wdWxzZS56KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuemVybygpO1xuICAgICAgICAgIENkb3QuYWRkQ29tYmluZSgxLCB2QjIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpKTtcbiAgICAgICAgICBDZG90LnN1YkNvbWJpbmUoMSwgdkEyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QSwgdGhpcy5tX3JBKSk7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSB0aGlzLm1fbWFzcy5zb2x2ZTIyKFZlYzIubmVnKENkb3QpKTtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IGltcHVsc2UueDtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ICs9IGltcHVsc2UueTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBpbXB1bHNlKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIGltcHVsc2UpO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIGltcHVsc2UpO1xuICAgICAgICAgIHdCICs9IGlCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgaW1wdWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciBhbmd1bGFyRXJyb3IgPSAwO1xuICAgICAgICB2YXIgcG9zaXRpb25FcnJvciA9IDA7XG4gICAgICAgIHZhciBmaXhlZFJvdGF0aW9uID0gdGhpcy5tX2ludklBICsgdGhpcy5tX2ludklCID09IDA7XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQyLmluYWN0aXZlTGltaXQgJiYgZml4ZWRSb3RhdGlvbiA9PSBmYWxzZSkge1xuICAgICAgICAgIHZhciBhbmdsZSA9IGFCIC0gYUEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICAgdmFyIGxpbWl0SW1wdWxzZSA9IDA7XG4gICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IExpbWl0U3RhdGUkMi5lcXVhbExpbWl0cykge1xuICAgICAgICAgICAgdmFyIEMgPSBjbGFtcChhbmdsZSAtIHRoaXMubV9sb3dlckFuZ2xlLCAtU2V0dGluZ3NJbnRlcm5hbC5tYXhBbmd1bGFyQ29ycmVjdGlvbiwgU2V0dGluZ3NJbnRlcm5hbC5tYXhBbmd1bGFyQ29ycmVjdGlvbik7XG4gICAgICAgICAgICBsaW1pdEltcHVsc2UgPSAtdGhpcy5tX21vdG9yTWFzcyAqIEM7XG4gICAgICAgICAgICBhbmd1bGFyRXJyb3IgPSBtYXRoX2FicyQ0KEMpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQyLmF0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgdmFyIEMgPSBhbmdsZSAtIHRoaXMubV9sb3dlckFuZ2xlO1xuICAgICAgICAgICAgYW5ndWxhckVycm9yID0gLUM7XG4gICAgICAgICAgICBDID0gY2xhbXAoQyArIFNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsb3AsIC1TZXR0aW5nc0ludGVybmFsLm1heEFuZ3VsYXJDb3JyZWN0aW9uLCAwKTtcbiAgICAgICAgICAgIGxpbWl0SW1wdWxzZSA9IC10aGlzLm1fbW90b3JNYXNzICogQztcbiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IExpbWl0U3RhdGUkMi5hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgICAgIHZhciBDID0gYW5nbGUgLSB0aGlzLm1fdXBwZXJBbmdsZTtcbiAgICAgICAgICAgIGFuZ3VsYXJFcnJvciA9IEM7XG4gICAgICAgICAgICBDID0gY2xhbXAoQyAtIFNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsb3AsIDAsIFNldHRpbmdzSW50ZXJuYWwubWF4QW5ndWxhckNvcnJlY3Rpb24pO1xuICAgICAgICAgICAgbGltaXRJbXB1bHNlID0gLXRoaXMubV9tb3Rvck1hc3MgKiBDO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhQSAtPSB0aGlzLm1faW52SUEgKiBsaW1pdEltcHVsc2U7XG4gICAgICAgICAgYUIgKz0gdGhpcy5tX2ludklCICogbGltaXRJbXB1bHNlO1xuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICBxQS5zZXRBbmdsZShhQSk7XG4gICAgICAgICAgcUIuc2V0QW5nbGUoYUIpO1xuICAgICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICAgIHZhciByQjIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICAgIHZhciBDID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQy5hZGRDb21iaW5lKDEsIGNCMiwgMSwgckIyKTtcbiAgICAgICAgICBDLnN1YkNvbWJpbmUoMSwgY0EyLCAxLCByQTIpO1xuICAgICAgICAgIHBvc2l0aW9uRXJyb3IgPSBDLmxlbmd0aCgpO1xuICAgICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgICB2YXIgSyA9IG5ldyBNYXQyMigpO1xuICAgICAgICAgIEsuZXgueCA9IG1BICsgbUIgKyBpQSAqIHJBMi55ICogckEyLnkgKyBpQiAqIHJCMi55ICogckIyLnk7XG4gICAgICAgICAgSy5leC55ID0gLWlBICogckEyLnggKiByQTIueSAtIGlCICogckIyLnggKiByQjIueTtcbiAgICAgICAgICBLLmV5LnggPSBLLmV4Lnk7XG4gICAgICAgICAgSy5leS55ID0gbUEgKyBtQiArIGlBICogckEyLnggKiByQTIueCArIGlCICogckIyLnggKiByQjIueDtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IFZlYzIubmVnKEsuc29sdmUoQykpO1xuICAgICAgICAgIGNBMi5zdWJNdWwobUEsIGltcHVsc2UpO1xuICAgICAgICAgIGFBIC09IGlBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgaW1wdWxzZSk7XG4gICAgICAgICAgY0IyLmFkZE11bChtQiwgaW1wdWxzZSk7XG4gICAgICAgICAgYUIgKz0gaUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBpbXB1bHNlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jLnNldFZlYzIoY0EyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jLnNldFZlYzIoY0IyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICByZXR1cm4gcG9zaXRpb25FcnJvciA8PSBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3AgJiYgYW5ndWxhckVycm9yIDw9IFNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsb3A7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIuVFlQRSA9IFwicmV2b2x1dGUtam9pbnRcIjtcbiAgICAgIHJldHVybiBSZXZvbHV0ZUpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgbWF0aF9hYnMkMyA9IE1hdGguYWJzO1xuICB2YXIgbWF0aF9tYXggPSBNYXRoLm1heDtcbiAgdmFyIG1hdGhfbWluJDIgPSBNYXRoLm1pbjtcbiAgdmFyIExpbWl0U3RhdGUkMTtcbiAgKGZ1bmN0aW9uKExpbWl0U3RhdGUyKSB7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJpbmFjdGl2ZUxpbWl0XCJdID0gMF0gPSBcImluYWN0aXZlTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImF0TG93ZXJMaW1pdFwiXSA9IDFdID0gXCJhdExvd2VyTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImF0VXBwZXJMaW1pdFwiXSA9IDJdID0gXCJhdFVwcGVyTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImVxdWFsTGltaXRzXCJdID0gM10gPSBcImVxdWFsTGltaXRzXCI7XG4gIH0pKExpbWl0U3RhdGUkMSB8fCAoTGltaXRTdGF0ZSQxID0ge30pKTtcbiAgdmFyIERFRkFVTFRTJDcgPSB7XG4gICAgZW5hYmxlTGltaXQ6IGZhbHNlLFxuICAgIGxvd2VyVHJhbnNsYXRpb246IDAsXG4gICAgdXBwZXJUcmFuc2xhdGlvbjogMCxcbiAgICBlbmFibGVNb3RvcjogZmFsc2UsXG4gICAgbWF4TW90b3JGb3JjZTogMCxcbiAgICBtb3RvclNwZWVkOiAwXG4gIH07XG4gIHZhciBQcmlzbWF0aWNKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoUHJpc21hdGljSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gUHJpc21hdGljSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IsIGF4aXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBQcmlzbWF0aWNKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBQcmlzbWF0aWNKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvciwgYXhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDcpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gUHJpc21hdGljSm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5QS5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JBIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckIgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsWEF4aXNBID0gVmVjMi5jbG9uZShheGlzID8gYm9keUEuZ2V0TG9jYWxWZWN0b3IoYXhpcykgOiBkZWYubG9jYWxBeGlzQSB8fCBWZWMyLm5lbygxLCAwKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxYQXhpc0Eubm9ybWFsaXplKCk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxZQXhpc0EgPSBWZWMyLmNyb3NzTnVtVmVjMigxLCBfdGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgX3RoaXMubV9yZWZlcmVuY2VBbmdsZSA9IE51bWJlci5pc0Zpbml0ZShkZWYucmVmZXJlbmNlQW5nbGUpID8gZGVmLnJlZmVyZW5jZUFuZ2xlIDogYm9keUIuZ2V0QW5nbGUoKSAtIGJvZHlBLmdldEFuZ2xlKCk7XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IG5ldyBWZWMzKCk7XG4gICAgICAgIF90aGlzLm1fbW90b3JNYXNzID0gMDtcbiAgICAgICAgX3RoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gPSBkZWYubG93ZXJUcmFuc2xhdGlvbjtcbiAgICAgICAgX3RoaXMubV91cHBlclRyYW5zbGF0aW9uID0gZGVmLnVwcGVyVHJhbnNsYXRpb247XG4gICAgICAgIF90aGlzLm1fbWF4TW90b3JGb3JjZSA9IGRlZi5tYXhNb3RvckZvcmNlO1xuICAgICAgICBfdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcbiAgICAgICAgX3RoaXMubV9lbmFibGVMaW1pdCA9IGRlZi5lbmFibGVMaW1pdDtcbiAgICAgICAgX3RoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcbiAgICAgICAgX3RoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQxLmluYWN0aXZlTGltaXQ7XG4gICAgICAgIF90aGlzLm1fYXhpcyA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX3BlcnAgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9LID0gbmV3IE1hdDMzKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBsb3dlclRyYW5zbGF0aW9uOiB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbixcbiAgICAgICAgICB1cHBlclRyYW5zbGF0aW9uOiB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbixcbiAgICAgICAgICBtYXhNb3RvckZvcmNlOiB0aGlzLm1fbWF4TW90b3JGb3JjZSxcbiAgICAgICAgICBtb3RvclNwZWVkOiB0aGlzLm1fbW90b3JTcGVlZCxcbiAgICAgICAgICBlbmFibGVMaW1pdDogdGhpcy5tX2VuYWJsZUxpbWl0LFxuICAgICAgICAgIGVuYWJsZU1vdG9yOiB0aGlzLm1fZW5hYmxlTW90b3IsXG4gICAgICAgICAgbG9jYWxBbmNob3JBOiB0aGlzLm1fbG9jYWxBbmNob3JBLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQixcbiAgICAgICAgICBsb2NhbEF4aXNBOiB0aGlzLm1fbG9jYWxYQXhpc0EsXG4gICAgICAgICAgcmVmZXJlbmNlQW5nbGU6IHRoaXMubV9yZWZlcmVuY2VBbmdsZVxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5sb2NhbEF4aXNBID0gVmVjMi5jbG9uZShkYXRhLmxvY2FsQXhpc0EpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgUHJpc21hdGljSm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKGRlZi5hbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKHRoaXMubV9ib2R5QS5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JBKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMihkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIodGhpcy5tX2JvZHlCLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckIpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYubG9jYWxBeGlzQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbFhBeGlzQS5zZXRWZWMyKGRlZi5sb2NhbEF4aXNBKTtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxZQXhpc0Euc2V0VmVjMihWZWMyLmNyb3NzTnVtVmVjMigxLCBkZWYubG9jYWxBeGlzQSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLnJlZmVyZW5jZUFuZ2xlKSkge1xuICAgICAgICAgIHRoaXMubV9yZWZlcmVuY2VBbmdsZSA9IGRlZi5yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGRlZi5lbmFibGVMaW1pdCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9ICEhZGVmLmVuYWJsZUxpbWl0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmxvd2VyVHJhbnNsYXRpb24pKSB7XG4gICAgICAgICAgdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gPSBkZWYubG93ZXJUcmFuc2xhdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi51cHBlclRyYW5zbGF0aW9uKSkge1xuICAgICAgICAgIHRoaXMubV91cHBlclRyYW5zbGF0aW9uID0gZGVmLnVwcGVyVHJhbnNsYXRpb247XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBkZWYuZW5hYmxlTW90b3IgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSAhIWRlZi5lbmFibGVNb3RvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhNb3RvckZvcmNlKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhNb3RvckZvcmNlID0gZGVmLm1heE1vdG9yRm9yY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubW90b3JTcGVlZCkpIHtcbiAgICAgICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckE7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEF4aXNBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxYQXhpc0E7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRSZWZlcmVuY2VBbmdsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnRUcmFuc2xhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcEEyID0gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICAgIHZhciBwQjIgPSB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi5zdWIocEIyLCBwQTIpO1xuICAgICAgICB2YXIgYXhpcyA9IHRoaXMubV9ib2R5QS5nZXRXb3JsZFZlY3Rvcih0aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICB2YXIgdHJhbnNsYXRpb24yID0gVmVjMi5kb3QoZDIsIGF4aXMpO1xuICAgICAgICByZXR1cm4gdHJhbnNsYXRpb24yO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnRTcGVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxWZWMyKGJBLm1feGYucSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgYkEubV9zd2VlcC5sb2NhbENlbnRlcikpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIoYkIubV94Zi5xLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyKSk7XG4gICAgICAgIHZhciBwMSA9IFZlYzIuYWRkKGJBLm1fc3dlZXAuYywgckEyKTtcbiAgICAgICAgdmFyIHAyID0gVmVjMi5hZGQoYkIubV9zd2VlcC5jLCByQjIpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihwMiwgcDEpO1xuICAgICAgICB2YXIgYXhpcyA9IFJvdC5tdWxWZWMyKGJBLm1feGYucSwgdGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgdmFyIHZBMiA9IGJBLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICAgIHZhciB2QjIgPSBiQi5tX2xpbmVhclZlbG9jaXR5O1xuICAgICAgICB2YXIgd0EgPSBiQS5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgdmFyIHdCID0gYkIubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgIHZhciBzcGVlZCA9IFZlYzIuZG90KGQyLCBWZWMyLmNyb3NzTnVtVmVjMih3QSwgYXhpcykpICsgVmVjMi5kb3QoYXhpcywgVmVjMi5zdWIoVmVjMi5hZGRDcm9zc051bVZlYzIodkIyLCB3QiwgckIyKSwgVmVjMi5hZGRDcm9zc051bVZlYzIodkEyLCB3QSwgckEyKSkpO1xuICAgICAgICByZXR1cm4gc3BlZWQ7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5pc0xpbWl0RW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZUxpbWl0O1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZW5hYmxlTGltaXQgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnICE9IHRoaXMubV9lbmFibGVMaW1pdCkge1xuICAgICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gZmxhZztcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0TG93ZXJMaW1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb247XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRVcHBlckxpbWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbjtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLnNldExpbWl0cyA9IGZ1bmN0aW9uKGxvd2VyLCB1cHBlcikge1xuICAgICAgICBpZiAobG93ZXIgIT0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gfHwgdXBwZXIgIT0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24pIHtcbiAgICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uID0gbG93ZXI7XG4gICAgICAgICAgdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gPSB1cHBlcjtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuaXNNb3RvckVuYWJsZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9lbmFibGVNb3RvcjtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmVuYWJsZU1vdG9yID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAoZmxhZyA9PSB0aGlzLm1fZW5hYmxlTW90b3IpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZmxhZztcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLnNldE1vdG9yU3BlZWQgPSBmdW5jdGlvbihzcGVlZCkge1xuICAgICAgICBpZiAoc3BlZWQgPT0gdGhpcy5tX21vdG9yU3BlZWQpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBzcGVlZDtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLnNldE1heE1vdG9yRm9yY2UgPSBmdW5jdGlvbihmb3JjZSkge1xuICAgICAgICBpZiAoZm9yY2UgPT0gdGhpcy5tX21heE1vdG9yRm9yY2UpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX21heE1vdG9yRm9yY2UgPSBmb3JjZTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldE1heE1vdG9yRm9yY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhNb3RvckZvcmNlO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21vdG9yU3BlZWQ7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRNb3RvckZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIuY29tYmluZSh0aGlzLm1faW1wdWxzZS54LCB0aGlzLm1fcGVycCwgdGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnosIHRoaXMubV9heGlzKS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS55O1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuemVybygpO1xuICAgICAgICBkMi5hZGRDb21iaW5lKDEsIGNCMiwgMSwgckIyKTtcbiAgICAgICAgZDIuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHJBMik7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAge1xuICAgICAgICAgIHRoaXMubV9heGlzID0gUm90Lm11bFZlYzIocUEsIHRoaXMubV9sb2NhbFhBeGlzQSk7XG4gICAgICAgICAgdGhpcy5tX2ExID0gVmVjMi5jcm9zc1ZlYzJWZWMyKFZlYzIuYWRkKGQyLCByQTIpLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgdGhpcy5tX2EyID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fYTEgKiB0aGlzLm1fYTEgKyBpQiAqIHRoaXMubV9hMiAqIHRoaXMubV9hMjtcbiAgICAgICAgICBpZiAodGhpcy5tX21vdG9yTWFzcyA+IDApIHtcbiAgICAgICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSAxIC8gdGhpcy5tX21vdG9yTWFzcztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIHRoaXMubV9wZXJwID0gUm90Lm11bFZlYzIocUEsIHRoaXMubV9sb2NhbFlBeGlzQSk7XG4gICAgICAgICAgdGhpcy5tX3MxID0gVmVjMi5jcm9zc1ZlYzJWZWMyKFZlYzIuYWRkKGQyLCByQTIpLCB0aGlzLm1fcGVycCk7XG4gICAgICAgICAgdGhpcy5tX3MyID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgdGhpcy5tX3BlcnApO1xuICAgICAgICAgIFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIHRoaXMubV9wZXJwKTtcbiAgICAgICAgICB2YXIgazExID0gbUEgKyBtQiArIGlBICogdGhpcy5tX3MxICogdGhpcy5tX3MxICsgaUIgKiB0aGlzLm1fczIgKiB0aGlzLm1fczI7XG4gICAgICAgICAgdmFyIGsxMiA9IGlBICogdGhpcy5tX3MxICsgaUIgKiB0aGlzLm1fczI7XG4gICAgICAgICAgdmFyIGsxMyA9IGlBICogdGhpcy5tX3MxICogdGhpcy5tX2ExICsgaUIgKiB0aGlzLm1fczIgKiB0aGlzLm1fYTI7XG4gICAgICAgICAgdmFyIGsyMiA9IGlBICsgaUI7XG4gICAgICAgICAgaWYgKGsyMiA9PSAwKSB7XG4gICAgICAgICAgICBrMjIgPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgazIzID0gaUEgKiB0aGlzLm1fYTEgKyBpQiAqIHRoaXMubV9hMjtcbiAgICAgICAgICB2YXIgazMzID0gbUEgKyBtQiArIGlBICogdGhpcy5tX2ExICogdGhpcy5tX2ExICsgaUIgKiB0aGlzLm1fYTIgKiB0aGlzLm1fYTI7XG4gICAgICAgICAgdGhpcy5tX0suZXguc2V0KGsxMSwgazEyLCBrMTMpO1xuICAgICAgICAgIHRoaXMubV9LLmV5LnNldChrMTIsIGsyMiwgazIzKTtcbiAgICAgICAgICB0aGlzLm1fSy5lei5zZXQoazEzLCBrMjMsIGszMyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCkge1xuICAgICAgICAgIHZhciBqb2ludFRyYW5zbGF0aW9uID0gVmVjMi5kb3QodGhpcy5tX2F4aXMsIGQyKTtcbiAgICAgICAgICBpZiAobWF0aF9hYnMkMyh0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiAtIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSA8IDIgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3ApIHtcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQxLmVxdWFsTGltaXRzO1xuICAgICAgICAgIH0gZWxzZSBpZiAoam9pbnRUcmFuc2xhdGlvbiA8PSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMS5hdExvd2VyTGltaXQpIHtcbiAgICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDEuYXRMb3dlckxpbWl0O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKGpvaW50VHJhbnNsYXRpb24gPj0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDEuYXRVcHBlckxpbWl0KSB7XG4gICAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQxLmF0VXBwZXJMaW1pdDtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQxLmluYWN0aXZlTGltaXQ7XG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDEuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yID09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UubXVsKHN0ZXAuZHRSYXRpbyk7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5jb21iaW5lKHRoaXMubV9pbXB1bHNlLngsIHRoaXMubV9wZXJwLCB0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueiwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHZhciBMQSA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fczEgKyB0aGlzLm1faW1wdWxzZS55ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KSAqIHRoaXMubV9hMTtcbiAgICAgICAgICB2YXIgTEIgPSB0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3MyICsgdGhpcy5tX2ltcHVsc2UueSArICh0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueikgKiB0aGlzLm1fYTI7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogTEE7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogTEI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2Uuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yICYmIHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMS5lcXVhbExpbWl0cykge1xuICAgICAgICAgIHZhciBDZG90ID0gVmVjMi5kb3QodGhpcy5tX2F4aXMsIFZlYzIuc3ViKHZCMiwgdkEyKSkgKyB0aGlzLm1fYTIgKiB3QiAtIHRoaXMubV9hMSAqIHdBO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gdGhpcy5tX21vdG9yTWFzcyAqICh0aGlzLm1fbW90b3JTcGVlZCAtIENkb3QpO1xuICAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4TW90b3JGb3JjZTtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gY2xhbXAodGhpcy5tX21vdG9ySW1wdWxzZSArIGltcHVsc2UsIC1tYXhJbXB1bHNlLCBtYXhJbXB1bHNlKTtcbiAgICAgICAgICBpbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZSAtIG9sZEltcHVsc2U7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICB2YXIgTEEgPSBpbXB1bHNlICogdGhpcy5tX2ExO1xuICAgICAgICAgIHZhciBMQiA9IGltcHVsc2UgKiB0aGlzLm1fYTI7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogTEE7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogTEI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIENkb3QxID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIENkb3QxLnggKz0gVmVjMi5kb3QodGhpcy5tX3BlcnAsIHZCMikgKyB0aGlzLm1fczIgKiB3QjtcbiAgICAgICAgQ2RvdDEueCAtPSBWZWMyLmRvdCh0aGlzLm1fcGVycCwgdkEyKSArIHRoaXMubV9zMSAqIHdBO1xuICAgICAgICBDZG90MS55ID0gd0IgLSB3QTtcbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDEuaW5hY3RpdmVMaW1pdCkge1xuICAgICAgICAgIHZhciBDZG90MiA9IDA7XG4gICAgICAgICAgQ2RvdDIgKz0gVmVjMi5kb3QodGhpcy5tX2F4aXMsIHZCMikgKyB0aGlzLm1fYTIgKiB3QjtcbiAgICAgICAgICBDZG90MiAtPSBWZWMyLmRvdCh0aGlzLm1fYXhpcywgdkEyKSArIHRoaXMubV9hMSAqIHdBO1xuICAgICAgICAgIHZhciBDZG90ID0gbmV3IFZlYzMoQ2RvdDEueCwgQ2RvdDEueSwgQ2RvdDIpO1xuICAgICAgICAgIHZhciBmMSA9IFZlYzMuY2xvbmUodGhpcy5tX2ltcHVsc2UpO1xuICAgICAgICAgIHZhciBkZiA9IHRoaXMubV9LLnNvbHZlMzMoVmVjMy5uZWcoQ2RvdCkpO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLmFkZChkZik7XG4gICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IExpbWl0U3RhdGUkMS5hdExvd2VyTGltaXQpIHtcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSBtYXRoX21heCh0aGlzLm1faW1wdWxzZS56LCAwKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IExpbWl0U3RhdGUkMS5hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSBtYXRoX21pbiQyKHRoaXMubV9pbXB1bHNlLnosIDApO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgYjIgPSBWZWMyLmNvbWJpbmUoLTEsIENkb3QxLCAtKHRoaXMubV9pbXB1bHNlLnogLSBmMS56KSwgVmVjMi5uZW8odGhpcy5tX0suZXoueCwgdGhpcy5tX0suZXoueSkpO1xuICAgICAgICAgIHZhciBmMnIgPSBWZWMyLmFkZCh0aGlzLm1fSy5zb2x2ZTIyKGIyKSwgVmVjMi5uZW8oZjEueCwgZjEueSkpO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggPSBmMnIueDtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ID0gZjJyLnk7XG4gICAgICAgICAgZGYgPSBWZWMzLnN1Yih0aGlzLm1faW1wdWxzZSwgZjEpO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIuY29tYmluZShkZi54LCB0aGlzLm1fcGVycCwgZGYueiwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHZhciBMQSA9IGRmLnggKiB0aGlzLm1fczEgKyBkZi55ICsgZGYueiAqIHRoaXMubV9hMTtcbiAgICAgICAgICB2YXIgTEIgPSBkZi54ICogdGhpcy5tX3MyICsgZGYueSArIGRmLnogKiB0aGlzLm1fYTI7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogTEE7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogTEI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIGRmID0gdGhpcy5tX0suc29sdmUyMihWZWMyLm5lZyhDZG90MSkpO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKz0gZGYueDtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ICs9IGRmLnk7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGRmLngsIHRoaXMubV9wZXJwKTtcbiAgICAgICAgICB2YXIgTEEgPSBkZi54ICogdGhpcy5tX3MxICsgZGYueTtcbiAgICAgICAgICB2YXIgTEIgPSBkZi54ICogdGhpcy5tX3MyICsgZGYueTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBMQTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBMQjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHZhciByQjIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihWZWMyLmFkZChjQjIsIHJCMiksIFZlYzIuYWRkKGNBMiwgckEyKSk7XG4gICAgICAgIHZhciBheGlzID0gUm90Lm11bFZlYzIocUEsIHRoaXMubV9sb2NhbFhBeGlzQSk7XG4gICAgICAgIHZhciBhMSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihWZWMyLmFkZChkMiwgckEyKSwgYXhpcyk7XG4gICAgICAgIHZhciBhMiA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIGF4aXMpO1xuICAgICAgICB2YXIgcGVycDIgPSBSb3QubXVsVmVjMihxQSwgdGhpcy5tX2xvY2FsWUF4aXNBKTtcbiAgICAgICAgdmFyIHMxID0gVmVjMi5jcm9zc1ZlYzJWZWMyKFZlYzIuYWRkKGQyLCByQTIpLCBwZXJwMik7XG4gICAgICAgIHZhciBzMiA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHBlcnAyKTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSBuZXcgVmVjMygpO1xuICAgICAgICB2YXIgQzEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgQzEueCA9IFZlYzIuZG90KHBlcnAyLCBkMik7XG4gICAgICAgIEMxLnkgPSBhQiAtIGFBIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICB2YXIgbGluZWFyRXJyb3IgPSBtYXRoX2FicyQzKEMxLngpO1xuICAgICAgICB2YXIgYW5ndWxhckVycm9yID0gbWF0aF9hYnMkMyhDMS55KTtcbiAgICAgICAgdmFyIGxpbmVhclNsb3AgPSBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgICAgIHZhciBtYXhMaW5lYXJDb3JyZWN0aW9uID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhMaW5lYXJDb3JyZWN0aW9uO1xuICAgICAgICB2YXIgYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHZhciBDMiA9IDA7XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQpIHtcbiAgICAgICAgICB2YXIgdHJhbnNsYXRpb24yID0gVmVjMi5kb3QoYXhpcywgZDIpO1xuICAgICAgICAgIGlmIChtYXRoX2FicyQzKHRoaXMubV91cHBlclRyYW5zbGF0aW9uIC0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24pIDwgMiAqIGxpbmVhclNsb3ApIHtcbiAgICAgICAgICAgIEMyID0gY2xhbXAodHJhbnNsYXRpb24yLCAtbWF4TGluZWFyQ29ycmVjdGlvbiwgbWF4TGluZWFyQ29ycmVjdGlvbik7XG4gICAgICAgICAgICBsaW5lYXJFcnJvciA9IG1hdGhfbWF4KGxpbmVhckVycm9yLCBtYXRoX2FicyQzKHRyYW5zbGF0aW9uMikpO1xuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRyYW5zbGF0aW9uMiA8PSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgICAgQzIgPSBjbGFtcCh0cmFuc2xhdGlvbjIgLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiArIGxpbmVhclNsb3AsIC1tYXhMaW5lYXJDb3JyZWN0aW9uLCAwKTtcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gTWF0aC5tYXgobGluZWFyRXJyb3IsIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uIC0gdHJhbnNsYXRpb24yKTtcbiAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIGlmICh0cmFuc2xhdGlvbjIgPj0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgIEMyID0gY2xhbXAodHJhbnNsYXRpb24yIC0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSBsaW5lYXJTbG9wLCAwLCBtYXhMaW5lYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gTWF0aC5tYXgobGluZWFyRXJyb3IsIHRyYW5zbGF0aW9uMiAtIHRoaXMubV91cHBlclRyYW5zbGF0aW9uKTtcbiAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChhY3RpdmUpIHtcbiAgICAgICAgICB2YXIgazExID0gbUEgKyBtQiArIGlBICogczEgKiBzMSArIGlCICogczIgKiBzMjtcbiAgICAgICAgICB2YXIgazEyID0gaUEgKiBzMSArIGlCICogczI7XG4gICAgICAgICAgdmFyIGsxMyA9IGlBICogczEgKiBhMSArIGlCICogczIgKiBhMjtcbiAgICAgICAgICB2YXIgazIyID0gaUEgKyBpQjtcbiAgICAgICAgICBpZiAoazIyID09IDApIHtcbiAgICAgICAgICAgIGsyMiA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBrMjMgPSBpQSAqIGExICsgaUIgKiBhMjtcbiAgICAgICAgICB2YXIgazMzID0gbUEgKyBtQiArIGlBICogYTEgKiBhMSArIGlCICogYTIgKiBhMjtcbiAgICAgICAgICB2YXIgSyA9IG5ldyBNYXQzMygpO1xuICAgICAgICAgIEsuZXguc2V0KGsxMSwgazEyLCBrMTMpO1xuICAgICAgICAgIEsuZXkuc2V0KGsxMiwgazIyLCBrMjMpO1xuICAgICAgICAgIEsuZXouc2V0KGsxMywgazIzLCBrMzMpO1xuICAgICAgICAgIHZhciBDID0gbmV3IFZlYzMoKTtcbiAgICAgICAgICBDLnggPSBDMS54O1xuICAgICAgICAgIEMueSA9IEMxLnk7XG4gICAgICAgICAgQy56ID0gQzI7XG4gICAgICAgICAgaW1wdWxzZSA9IEsuc29sdmUzMyhWZWMzLm5lZyhDKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIGsxMSA9IG1BICsgbUIgKyBpQSAqIHMxICogczEgKyBpQiAqIHMyICogczI7XG4gICAgICAgICAgdmFyIGsxMiA9IGlBICogczEgKyBpQiAqIHMyO1xuICAgICAgICAgIHZhciBrMjIgPSBpQSArIGlCO1xuICAgICAgICAgIGlmIChrMjIgPT0gMCkge1xuICAgICAgICAgICAgazIyID0gMTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIEsgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgICBLLmV4LnNldE51bShrMTEsIGsxMik7XG4gICAgICAgICAgSy5leS5zZXROdW0oazEyLCBrMjIpO1xuICAgICAgICAgIHZhciBpbXB1bHNlMSA9IEsuc29sdmUoVmVjMi5uZWcoQzEpKTtcbiAgICAgICAgICBpbXB1bHNlLnggPSBpbXB1bHNlMS54O1xuICAgICAgICAgIGltcHVsc2UueSA9IGltcHVsc2UxLnk7XG4gICAgICAgICAgaW1wdWxzZS56ID0gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgUDMgPSBWZWMyLmNvbWJpbmUoaW1wdWxzZS54LCBwZXJwMiwgaW1wdWxzZS56LCBheGlzKTtcbiAgICAgICAgdmFyIExBID0gaW1wdWxzZS54ICogczEgKyBpbXB1bHNlLnkgKyBpbXB1bHNlLnogKiBhMTtcbiAgICAgICAgdmFyIExCID0gaW1wdWxzZS54ICogczIgKyBpbXB1bHNlLnkgKyBpbXB1bHNlLnogKiBhMjtcbiAgICAgICAgY0EyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICBhQSAtPSBpQSAqIExBO1xuICAgICAgICBjQjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgIGFCICs9IGlCICogTEI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMgPSBjQTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmEgPSBhQTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYyA9IGNCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICByZXR1cm4gbGluZWFyRXJyb3IgPD0gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wICYmIGFuZ3VsYXJFcnJvciA8PSBTZXR0aW5nc0ludGVybmFsLmFuZ3VsYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5UWVBFID0gXCJwcmlzbWF0aWMtam9pbnRcIjtcbiAgICAgIHJldHVybiBQcmlzbWF0aWNKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIERFRkFVTFRTJDYgPSB7XG4gICAgcmF0aW86IDFcbiAgfTtcbiAgdmFyIEdlYXJKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoR2VhckpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIEdlYXJKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGpvaW50MSwgam9pbnQyLCByYXRpbykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIEdlYXJKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBHZWFySm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBqb2ludDEsIGpvaW50MiwgcmF0aW8pO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQ2KTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IEdlYXJKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9qb2ludDEgPSBqb2ludDEgPyBqb2ludDEgOiBkZWYuam9pbnQxO1xuICAgICAgICBfdGhpcy5tX2pvaW50MiA9IGpvaW50MiA/IGpvaW50MiA6IGRlZi5qb2ludDI7XG4gICAgICAgIF90aGlzLm1fcmF0aW8gPSBOdW1iZXIuaXNGaW5pdGUocmF0aW8pID8gcmF0aW8gOiBkZWYucmF0aW87XG4gICAgICAgIF90aGlzLm1fdHlwZTEgPSBfdGhpcy5tX2pvaW50MS5nZXRUeXBlKCk7XG4gICAgICAgIF90aGlzLm1fdHlwZTIgPSBfdGhpcy5tX2pvaW50Mi5nZXRUeXBlKCk7XG4gICAgICAgIHZhciBjb29yZGluYXRlQTtcbiAgICAgICAgdmFyIGNvb3JkaW5hdGVCO1xuICAgICAgICBfdGhpcy5tX2JvZHlDID0gX3RoaXMubV9qb2ludDEuZ2V0Qm9keUEoKTtcbiAgICAgICAgX3RoaXMubV9ib2R5QSA9IF90aGlzLm1fam9pbnQxLmdldEJvZHlCKCk7XG4gICAgICAgIHZhciB4ZkEyID0gX3RoaXMubV9ib2R5QS5tX3hmO1xuICAgICAgICB2YXIgYUEgPSBfdGhpcy5tX2JvZHlBLm1fc3dlZXAuYTtcbiAgICAgICAgdmFyIHhmQyA9IF90aGlzLm1fYm9keUMubV94ZjtcbiAgICAgICAgdmFyIGFDID0gX3RoaXMubV9ib2R5Qy5tX3N3ZWVwLmE7XG4gICAgICAgIGlmIChfdGhpcy5tX3R5cGUxID09PSBSZXZvbHV0ZUpvaW50LlRZUEUpIHtcbiAgICAgICAgICB2YXIgcmV2b2x1dGUgPSBfdGhpcy5tX2pvaW50MTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQyA9IHJldm9sdXRlLm1fbG9jYWxBbmNob3JBO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gcmV2b2x1dGUubV9sb2NhbEFuY2hvckI7XG4gICAgICAgICAgX3RoaXMubV9yZWZlcmVuY2VBbmdsZUEgPSByZXZvbHV0ZS5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBeGlzQyA9IFZlYzIuemVybygpO1xuICAgICAgICAgIGNvb3JkaW5hdGVBID0gYUEgLSBhQyAtIF90aGlzLm1fcmVmZXJlbmNlQW5nbGVBO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBwcmlzbWF0aWMgPSBfdGhpcy5tX2pvaW50MTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQyA9IHByaXNtYXRpYy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IHByaXNtYXRpYy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQSA9IHByaXNtYXRpYy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBeGlzQyA9IHByaXNtYXRpYy5tX2xvY2FsWEF4aXNBO1xuICAgICAgICAgIHZhciBwQyA9IF90aGlzLm1fbG9jYWxBbmNob3JDO1xuICAgICAgICAgIHZhciBwQTIgPSBSb3QubXVsVFZlYzIoeGZDLnEsIFZlYzIuYWRkKFJvdC5tdWxWZWMyKHhmQTIucSwgX3RoaXMubV9sb2NhbEFuY2hvckEpLCBWZWMyLnN1Yih4ZkEyLnAsIHhmQy5wKSkpO1xuICAgICAgICAgIGNvb3JkaW5hdGVBID0gVmVjMi5kb3QocEEyLCBfdGhpcy5tX2xvY2FsQXhpc0MpIC0gVmVjMi5kb3QocEMsIF90aGlzLm1fbG9jYWxBeGlzQyk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMubV9ib2R5RCA9IF90aGlzLm1fam9pbnQyLmdldEJvZHlBKCk7XG4gICAgICAgIF90aGlzLm1fYm9keUIgPSBfdGhpcy5tX2pvaW50Mi5nZXRCb2R5QigpO1xuICAgICAgICB2YXIgeGZCMiA9IF90aGlzLm1fYm9keUIubV94ZjtcbiAgICAgICAgdmFyIGFCID0gX3RoaXMubV9ib2R5Qi5tX3N3ZWVwLmE7XG4gICAgICAgIHZhciB4ZkQgPSBfdGhpcy5tX2JvZHlELm1feGY7XG4gICAgICAgIHZhciBhRCA9IF90aGlzLm1fYm9keUQubV9zd2VlcC5hO1xuICAgICAgICBpZiAoX3RoaXMubV90eXBlMiA9PT0gUmV2b2x1dGVKb2ludC5UWVBFKSB7XG4gICAgICAgICAgdmFyIHJldm9sdXRlID0gX3RoaXMubV9qb2ludDI7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckQgPSByZXZvbHV0ZS5tX2xvY2FsQW5jaG9yQTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IHJldm9sdXRlLm1fbG9jYWxBbmNob3JCO1xuICAgICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGVCID0gcmV2b2x1dGUubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQXhpc0QgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBjb29yZGluYXRlQiA9IGFCIC0gYUQgLSBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgcHJpc21hdGljID0gX3RoaXMubV9qb2ludDI7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckQgPSBwcmlzbWF0aWMubV9sb2NhbEFuY2hvckE7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBwcmlzbWF0aWMubV9sb2NhbEFuY2hvckI7XG4gICAgICAgICAgX3RoaXMubV9yZWZlcmVuY2VBbmdsZUIgPSBwcmlzbWF0aWMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQXhpc0QgPSBwcmlzbWF0aWMubV9sb2NhbFhBeGlzQTtcbiAgICAgICAgICB2YXIgcEQgPSBfdGhpcy5tX2xvY2FsQW5jaG9yRDtcbiAgICAgICAgICB2YXIgcEIyID0gUm90Lm11bFRWZWMyKHhmRC5xLCBWZWMyLmFkZChSb3QubXVsVmVjMih4ZkIyLnEsIF90aGlzLm1fbG9jYWxBbmNob3JCKSwgVmVjMi5zdWIoeGZCMi5wLCB4ZkQucCkpKTtcbiAgICAgICAgICBjb29yZGluYXRlQiA9IFZlYzIuZG90KHBCMiwgX3RoaXMubV9sb2NhbEF4aXNEKSAtIFZlYzIuZG90KHBELCBfdGhpcy5tX2xvY2FsQXhpc0QpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLm1fY29uc3RhbnQgPSBjb29yZGluYXRlQSArIF90aGlzLm1fcmF0aW8gKiBjb29yZGluYXRlQjtcbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBqb2ludDE6IHRoaXMubV9qb2ludDEsXG4gICAgICAgICAgam9pbnQyOiB0aGlzLm1fam9pbnQyLFxuICAgICAgICAgIHJhdGlvOiB0aGlzLm1fcmF0aW9cbiAgICAgICAgICAvLyBfY29uc3RhbnQ6IHRoaXMubV9jb25zdGFudCxcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICBkYXRhLmpvaW50MSA9IHJlc3RvcmUoSm9pbnQsIGRhdGEuam9pbnQxLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuam9pbnQyID0gcmVzdG9yZShKb2ludCwgZGF0YS5qb2ludDIsIHdvcmxkKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IEdlYXJKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYucmF0aW8pKSB7XG4gICAgICAgICAgdGhpcy5tX3JhdGlvID0gZGVmLnJhdGlvO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnQxID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fam9pbnQxO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLmdldEpvaW50MiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2pvaW50MjtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5zZXRSYXRpbyA9IGZ1bmN0aW9uKHJhdGlvKSB7XG4gICAgICAgIHRoaXMubV9yYXRpbyA9IHJhdGlvO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLmdldFJhdGlvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmF0aW87XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5tdWxOdW1WZWMyKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fSnZBQykubXVsKGludl9kdCk7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgdmFyIEwgPSB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9Kd0E7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiBMO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbGNBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sY0IgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xjQyA9IHRoaXMubV9ib2R5Qy5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbGNEID0gdGhpcy5tX2JvZHlELm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9tQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9tQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9tQyA9IHRoaXMubV9ib2R5Qy5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9tRCA9IHRoaXMubV9ib2R5RC5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pQyA9IHRoaXMubV9ib2R5Qy5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pRCA9IHRoaXMubV9ib2R5RC5tX2ludkk7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGFDID0gdGhpcy5tX2JvZHlDLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZDID0gdGhpcy5tX2JvZHlDLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdDID0gdGhpcy5tX2JvZHlDLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGFEID0gdGhpcy5tX2JvZHlELmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZEID0gdGhpcy5tX2JvZHlELmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdEID0gdGhpcy5tX2JvZHlELmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgcUMgPSBSb3QubmVvKGFDKTtcbiAgICAgICAgdmFyIHFEID0gUm90Lm5lbyhhRCk7XG4gICAgICAgIHRoaXMubV9tYXNzID0gMDtcbiAgICAgICAgaWYgKHRoaXMubV90eXBlMSA9PSBSZXZvbHV0ZUpvaW50LlRZUEUpIHtcbiAgICAgICAgICB0aGlzLm1fSnZBQyA9IFZlYzIuemVybygpO1xuICAgICAgICAgIHRoaXMubV9Kd0EgPSAxO1xuICAgICAgICAgIHRoaXMubV9Kd0MgPSAxO1xuICAgICAgICAgIHRoaXMubV9tYXNzICs9IHRoaXMubV9pQSArIHRoaXMubV9pQztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgdSA9IFJvdC5tdWxWZWMyKHFDLCB0aGlzLm1fbG9jYWxBeGlzQyk7XG4gICAgICAgICAgdmFyIHJDID0gUm90Lm11bFN1YihxQywgdGhpcy5tX2xvY2FsQW5jaG9yQywgdGhpcy5tX2xjQyk7XG4gICAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxTdWIocUEsIHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sY0EpO1xuICAgICAgICAgIHRoaXMubV9KdkFDID0gdTtcbiAgICAgICAgICB0aGlzLm1fSndDID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJDLCB1KTtcbiAgICAgICAgICB0aGlzLm1fSndBID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgdSk7XG4gICAgICAgICAgdGhpcy5tX21hc3MgKz0gdGhpcy5tX21DICsgdGhpcy5tX21BICsgdGhpcy5tX2lDICogdGhpcy5tX0p3QyAqIHRoaXMubV9Kd0MgKyB0aGlzLm1faUEgKiB0aGlzLm1fSndBICogdGhpcy5tX0p3QTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX3R5cGUyID09IFJldm9sdXRlSm9pbnQuVFlQRSkge1xuICAgICAgICAgIHRoaXMubV9KdkJEID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX0p3QiA9IHRoaXMubV9yYXRpbztcbiAgICAgICAgICB0aGlzLm1fSndEID0gdGhpcy5tX3JhdGlvO1xuICAgICAgICAgIHRoaXMubV9tYXNzICs9IHRoaXMubV9yYXRpbyAqIHRoaXMubV9yYXRpbyAqICh0aGlzLm1faUIgKyB0aGlzLm1faUQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciB1ID0gUm90Lm11bFZlYzIocUQsIHRoaXMubV9sb2NhbEF4aXNEKTtcbiAgICAgICAgICB2YXIgckQgPSBSb3QubXVsU3ViKHFELCB0aGlzLm1fbG9jYWxBbmNob3JELCB0aGlzLm1fbGNEKTtcbiAgICAgICAgICB2YXIgckIyID0gUm90Lm11bFN1YihxQiwgdGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xjQik7XG4gICAgICAgICAgdGhpcy5tX0p2QkQgPSBWZWMyLm11bE51bVZlYzIodGhpcy5tX3JhdGlvLCB1KTtcbiAgICAgICAgICB0aGlzLm1fSndEID0gdGhpcy5tX3JhdGlvICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJELCB1KTtcbiAgICAgICAgICB0aGlzLm1fSndCID0gdGhpcy5tX3JhdGlvICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgdSk7XG4gICAgICAgICAgdGhpcy5tX21hc3MgKz0gdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogKHRoaXMubV9tRCArIHRoaXMubV9tQikgKyB0aGlzLm1faUQgKiB0aGlzLm1fSndEICogdGhpcy5tX0p3RCArIHRoaXMubV9pQiAqIHRoaXMubV9Kd0IgKiB0aGlzLm1fSndCO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9tYXNzID0gdGhpcy5tX21hc3MgPiAwID8gMSAvIHRoaXMubV9tYXNzIDogMDtcbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdkEyLmFkZE11bCh0aGlzLm1fbUEgKiB0aGlzLm1faW1wdWxzZSwgdGhpcy5tX0p2QUMpO1xuICAgICAgICAgIHdBICs9IHRoaXMubV9pQSAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0p3QTtcbiAgICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9tQiAqIHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fSnZCRCk7XG4gICAgICAgICAgd0IgKz0gdGhpcy5tX2lCICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSndCO1xuICAgICAgICAgIHZDLnN1Yk11bCh0aGlzLm1fbUMgKiB0aGlzLm1faW1wdWxzZSwgdGhpcy5tX0p2QUMpO1xuICAgICAgICAgIHdDIC09IHRoaXMubV9pQyAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0p3QztcbiAgICAgICAgICB2RC5zdWJNdWwodGhpcy5tX21EICogdGhpcy5tX2ltcHVsc2UsIHRoaXMubV9KdkJEKTtcbiAgICAgICAgICB3RCAtPSB0aGlzLm1faUQgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9Kd0Q7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICAgIHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2Qyk7XG4gICAgICAgIHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5LncgPSB3QztcbiAgICAgICAgdGhpcy5tX2JvZHlELmNfdmVsb2NpdHkudi5zZXRWZWMyKHZEKTtcbiAgICAgICAgdGhpcy5tX2JvZHlELmNfdmVsb2NpdHkudyA9IHdEO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkMgPSB0aGlzLm1fYm9keUMuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0MgPSB0aGlzLm1fYm9keUMuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkQgPSB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0QgPSB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuZG90KHRoaXMubV9KdkFDLCB2QTIpIC0gVmVjMi5kb3QodGhpcy5tX0p2QUMsIHZDKSArIFZlYzIuZG90KHRoaXMubV9KdkJELCB2QjIpIC0gVmVjMi5kb3QodGhpcy5tX0p2QkQsIHZEKTtcbiAgICAgICAgQ2RvdCArPSB0aGlzLm1fSndBICogd0EgLSB0aGlzLm1fSndDICogd0MgKyAodGhpcy5tX0p3QiAqIHdCIC0gdGhpcy5tX0p3RCAqIHdEKTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21hc3MgKiBDZG90O1xuICAgICAgICB0aGlzLm1faW1wdWxzZSArPSBpbXB1bHNlO1xuICAgICAgICB2QTIuYWRkTXVsKHRoaXMubV9tQSAqIGltcHVsc2UsIHRoaXMubV9KdkFDKTtcbiAgICAgICAgd0EgKz0gdGhpcy5tX2lBICogaW1wdWxzZSAqIHRoaXMubV9Kd0E7XG4gICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX21CICogaW1wdWxzZSwgdGhpcy5tX0p2QkQpO1xuICAgICAgICB3QiArPSB0aGlzLm1faUIgKiBpbXB1bHNlICogdGhpcy5tX0p3QjtcbiAgICAgICAgdkMuc3ViTXVsKHRoaXMubV9tQyAqIGltcHVsc2UsIHRoaXMubV9KdkFDKTtcbiAgICAgICAgd0MgLT0gdGhpcy5tX2lDICogaW1wdWxzZSAqIHRoaXMubV9Kd0M7XG4gICAgICAgIHZELnN1Yk11bCh0aGlzLm1fbUQgKiBpbXB1bHNlLCB0aGlzLm1fSnZCRCk7XG4gICAgICAgIHdEIC09IHRoaXMubV9pRCAqIGltcHVsc2UgKiB0aGlzLm1fSndEO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52LnNldFZlYzIodkEyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgICB0aGlzLm1fYm9keUMuY192ZWxvY2l0eS52LnNldFZlYzIodkMpO1xuICAgICAgICB0aGlzLm1fYm9keUMuY192ZWxvY2l0eS53ID0gd0M7XG4gICAgICAgIHRoaXMubV9ib2R5RC5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2RCk7XG4gICAgICAgIHRoaXMubV9ib2R5RC5jX3ZlbG9jaXR5LncgPSB3RDtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNDID0gdGhpcy5tX2JvZHlDLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFDID0gdGhpcy5tX2JvZHlDLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNEID0gdGhpcy5tX2JvZHlELmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFEID0gdGhpcy5tX2JvZHlELmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgcUMgPSBSb3QubmVvKGFDKTtcbiAgICAgICAgdmFyIHFEID0gUm90Lm5lbyhhRCk7XG4gICAgICAgIHZhciBsaW5lYXJFcnJvciA9IDA7XG4gICAgICAgIHZhciBjb29yZGluYXRlQTtcbiAgICAgICAgdmFyIGNvb3JkaW5hdGVCO1xuICAgICAgICB2YXIgSnZBQztcbiAgICAgICAgdmFyIEp2QkQ7XG4gICAgICAgIHZhciBKd0E7XG4gICAgICAgIHZhciBKd0I7XG4gICAgICAgIHZhciBKd0M7XG4gICAgICAgIHZhciBKd0Q7XG4gICAgICAgIHZhciBtYXNzID0gMDtcbiAgICAgICAgaWYgKHRoaXMubV90eXBlMSA9PSBSZXZvbHV0ZUpvaW50LlRZUEUpIHtcbiAgICAgICAgICBKdkFDID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgSndBID0gMTtcbiAgICAgICAgICBKd0MgPSAxO1xuICAgICAgICAgIG1hc3MgKz0gdGhpcy5tX2lBICsgdGhpcy5tX2lDO1xuICAgICAgICAgIGNvb3JkaW5hdGVBID0gYUEgLSBhQyAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZUE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHUgPSBSb3QubXVsVmVjMihxQywgdGhpcy5tX2xvY2FsQXhpc0MpO1xuICAgICAgICAgIHZhciByQyA9IFJvdC5tdWxTdWIocUMsIHRoaXMubV9sb2NhbEFuY2hvckMsIHRoaXMubV9sY0MpO1xuICAgICAgICAgIHZhciByQTIgPSBSb3QubXVsU3ViKHFBLCB0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbGNBKTtcbiAgICAgICAgICBKdkFDID0gdTtcbiAgICAgICAgICBKd0MgPSBWZWMyLmNyb3NzVmVjMlZlYzIockMsIHUpO1xuICAgICAgICAgIEp3QSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIHUpO1xuICAgICAgICAgIG1hc3MgKz0gdGhpcy5tX21DICsgdGhpcy5tX21BICsgdGhpcy5tX2lDICogSndDICogSndDICsgdGhpcy5tX2lBICogSndBICogSndBO1xuICAgICAgICAgIHZhciBwQyA9IFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckMsIHRoaXMubV9sY0MpO1xuICAgICAgICAgIHZhciBwQTIgPSBSb3QubXVsVFZlYzIocUMsIFZlYzIuYWRkKHJBMiwgVmVjMi5zdWIoY0EyLCBjQykpKTtcbiAgICAgICAgICBjb29yZGluYXRlQSA9IFZlYzIuZG90KFZlYzIuc3ViKHBBMiwgcEMpLCB0aGlzLm1fbG9jYWxBeGlzQyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlMiA9PSBSZXZvbHV0ZUpvaW50LlRZUEUpIHtcbiAgICAgICAgICBKdkJEID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgSndCID0gdGhpcy5tX3JhdGlvO1xuICAgICAgICAgIEp3RCA9IHRoaXMubV9yYXRpbztcbiAgICAgICAgICBtYXNzICs9IHRoaXMubV9yYXRpbyAqIHRoaXMubV9yYXRpbyAqICh0aGlzLm1faUIgKyB0aGlzLm1faUQpO1xuICAgICAgICAgIGNvb3JkaW5hdGVCID0gYUIgLSBhRCAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZUI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHUgPSBSb3QubXVsVmVjMihxRCwgdGhpcy5tX2xvY2FsQXhpc0QpO1xuICAgICAgICAgIHZhciByRCA9IFJvdC5tdWxTdWIocUQsIHRoaXMubV9sb2NhbEFuY2hvckQsIHRoaXMubV9sY0QpO1xuICAgICAgICAgIHZhciByQjIgPSBSb3QubXVsU3ViKHFCLCB0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbGNCKTtcbiAgICAgICAgICBKdkJEID0gVmVjMi5tdWxOdW1WZWMyKHRoaXMubV9yYXRpbywgdSk7XG4gICAgICAgICAgSndEID0gdGhpcy5tX3JhdGlvICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJELCB1KTtcbiAgICAgICAgICBKd0IgPSB0aGlzLm1fcmF0aW8gKiBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB1KTtcbiAgICAgICAgICBtYXNzICs9IHRoaXMubV9yYXRpbyAqIHRoaXMubV9yYXRpbyAqICh0aGlzLm1fbUQgKyB0aGlzLm1fbUIpICsgdGhpcy5tX2lEICogSndEICogSndEICsgdGhpcy5tX2lCICogSndCICogSndCO1xuICAgICAgICAgIHZhciBwRCA9IFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckQsIHRoaXMubV9sY0QpO1xuICAgICAgICAgIHZhciBwQjIgPSBSb3QubXVsVFZlYzIocUQsIFZlYzIuYWRkKHJCMiwgVmVjMi5zdWIoY0IyLCBjRCkpKTtcbiAgICAgICAgICBjb29yZGluYXRlQiA9IFZlYzIuZG90KHBCMiwgdGhpcy5tX2xvY2FsQXhpc0QpIC0gVmVjMi5kb3QocEQsIHRoaXMubV9sb2NhbEF4aXNEKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgQyA9IGNvb3JkaW5hdGVBICsgdGhpcy5tX3JhdGlvICogY29vcmRpbmF0ZUIgLSB0aGlzLm1fY29uc3RhbnQ7XG4gICAgICAgIHZhciBpbXB1bHNlID0gMDtcbiAgICAgICAgaWYgKG1hc3MgPiAwKSB7XG4gICAgICAgICAgaW1wdWxzZSA9IC1DIC8gbWFzcztcbiAgICAgICAgfVxuICAgICAgICBjQTIuYWRkTXVsKHRoaXMubV9tQSAqIGltcHVsc2UsIEp2QUMpO1xuICAgICAgICBhQSArPSB0aGlzLm1faUEgKiBpbXB1bHNlICogSndBO1xuICAgICAgICBjQjIuYWRkTXVsKHRoaXMubV9tQiAqIGltcHVsc2UsIEp2QkQpO1xuICAgICAgICBhQiArPSB0aGlzLm1faUIgKiBpbXB1bHNlICogSndCO1xuICAgICAgICBjQy5zdWJNdWwodGhpcy5tX21DICogaW1wdWxzZSwgSnZBQyk7XG4gICAgICAgIGFDIC09IHRoaXMubV9pQyAqIGltcHVsc2UgKiBKd0M7XG4gICAgICAgIGNELnN1Yk11bCh0aGlzLm1fbUQgKiBpbXB1bHNlLCBKdkJEKTtcbiAgICAgICAgYUQgLT0gdGhpcy5tX2lEICogaW1wdWxzZSAqIEp3RDtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmEgPSBhQTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmEgPSBhQjtcbiAgICAgICAgdGhpcy5tX2JvZHlDLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNDKTtcbiAgICAgICAgdGhpcy5tX2JvZHlDLmNfcG9zaXRpb24uYSA9IGFDO1xuICAgICAgICB0aGlzLm1fYm9keUQuY19wb3NpdGlvbi5jLnNldFZlYzIoY0QpO1xuICAgICAgICB0aGlzLm1fYm9keUQuY19wb3NpdGlvbi5hID0gYUQ7XG4gICAgICAgIHJldHVybiBsaW5lYXJFcnJvciA8IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLlRZUEUgPSBcImdlYXItam9pbnRcIjtcbiAgICAgIHJldHVybiBHZWFySm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBERUZBVUxUUyQ1ID0ge1xuICAgIG1heEZvcmNlOiAxLFxuICAgIG1heFRvcnF1ZTogMSxcbiAgICBjb3JyZWN0aW9uRmFjdG9yOiAwLjNcbiAgfTtcbiAgdmFyIE1vdG9ySm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKE1vdG9ySm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gTW90b3JKb2ludDIoZGVmLCBib2R5QSwgYm9keUIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBNb3RvckpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IE1vdG9ySm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkNSk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBNb3RvckpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2xpbmVhck9mZnNldCA9IFZlYzIuaXNWYWxpZChkZWYubGluZWFyT2Zmc2V0KSA/IFZlYzIuY2xvbmUoZGVmLmxpbmVhck9mZnNldCkgOiBib2R5QS5nZXRMb2NhbFBvaW50KGJvZHlCLmdldFBvc2l0aW9uKCkpO1xuICAgICAgICBfdGhpcy5tX2FuZ3VsYXJPZmZzZXQgPSBOdW1iZXIuaXNGaW5pdGUoZGVmLmFuZ3VsYXJPZmZzZXQpID8gZGVmLmFuZ3VsYXJPZmZzZXQgOiBib2R5Qi5nZXRBbmdsZSgpIC0gYm9keUEuZ2V0QW5nbGUoKTtcbiAgICAgICAgX3RoaXMubV9saW5lYXJJbXB1bHNlID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fYW5ndWxhckltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX21heEZvcmNlID0gZGVmLm1heEZvcmNlO1xuICAgICAgICBfdGhpcy5tX21heFRvcnF1ZSA9IGRlZi5tYXhUb3JxdWU7XG4gICAgICAgIF90aGlzLm1fY29ycmVjdGlvbkZhY3RvciA9IGRlZi5jb3JyZWN0aW9uRmFjdG9yO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBtYXhGb3JjZTogdGhpcy5tX21heEZvcmNlLFxuICAgICAgICAgIG1heFRvcnF1ZTogdGhpcy5tX21heFRvcnF1ZSxcbiAgICAgICAgICBjb3JyZWN0aW9uRmFjdG9yOiB0aGlzLm1fY29ycmVjdGlvbkZhY3RvcixcbiAgICAgICAgICBsaW5lYXJPZmZzZXQ6IHRoaXMubV9saW5lYXJPZmZzZXQsXG4gICAgICAgICAgYW5ndWxhck9mZnNldDogdGhpcy5tX2FuZ3VsYXJPZmZzZXRcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IE1vdG9ySm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5hbmd1bGFyT2Zmc2V0KSkge1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFyT2Zmc2V0ID0gZGVmLmFuZ3VsYXJPZmZzZXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4Rm9yY2UpKSB7XG4gICAgICAgICAgdGhpcy5tX21heEZvcmNlID0gZGVmLm1heEZvcmNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1heFRvcnF1ZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4VG9ycXVlID0gZGVmLm1heFRvcnF1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5jb3JyZWN0aW9uRmFjdG9yKSkge1xuICAgICAgICAgIHRoaXMubV9jb3JyZWN0aW9uRmFjdG9yID0gZGVmLmNvcnJlY3Rpb25GYWN0b3I7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChkZWYubGluZWFyT2Zmc2V0KSkge1xuICAgICAgICAgIHRoaXMubV9saW5lYXJPZmZzZXQuc2V0KGRlZi5saW5lYXJPZmZzZXQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLnNldE1heEZvcmNlID0gZnVuY3Rpb24oZm9yY2UpIHtcbiAgICAgICAgdGhpcy5tX21heEZvcmNlID0gZm9yY2U7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldE1heEZvcmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4Rm9yY2U7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLnNldE1heFRvcnF1ZSA9IGZ1bmN0aW9uKHRvcnF1ZSkge1xuICAgICAgICB0aGlzLm1fbWF4VG9ycXVlID0gdG9ycXVlO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRNYXhUb3JxdWUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhUb3JxdWU7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLnNldENvcnJlY3Rpb25GYWN0b3IgPSBmdW5jdGlvbihmYWN0b3IpIHtcbiAgICAgICAgdGhpcy5tX2NvcnJlY3Rpb25GYWN0b3IgPSBmYWN0b3I7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldENvcnJlY3Rpb25GYWN0b3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jb3JyZWN0aW9uRmFjdG9yO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5zZXRMaW5lYXJPZmZzZXQgPSBmdW5jdGlvbihsaW5lYXJPZmZzZXQpIHtcbiAgICAgICAgaWYgKGxpbmVhck9mZnNldC54ICE9IHRoaXMubV9saW5lYXJPZmZzZXQueCB8fCBsaW5lYXJPZmZzZXQueSAhPSB0aGlzLm1fbGluZWFyT2Zmc2V0LnkpIHtcbiAgICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9saW5lYXJPZmZzZXQuc2V0KGxpbmVhck9mZnNldCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0TGluZWFyT2Zmc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbGluZWFyT2Zmc2V0O1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5zZXRBbmd1bGFyT2Zmc2V0ID0gZnVuY3Rpb24oYW5ndWxhck9mZnNldCkge1xuICAgICAgICBpZiAoYW5ndWxhck9mZnNldCAhPSB0aGlzLm1fYW5ndWxhck9mZnNldCkge1xuICAgICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJPZmZzZXQgPSBhbmd1bGFyT2Zmc2V0O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldEFuZ3VsYXJPZmZzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9hbmd1bGFyT2Zmc2V0O1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0UG9zaXRpb24oKTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFBvc2l0aW9uKCk7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubXVsTnVtVmVjMihpbnZfZHQsIHRoaXMubV9saW5lYXJJbXB1bHNlKTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9hbmd1bGFySW1wdWxzZTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB0aGlzLm1fckEgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xpbmVhck9mZnNldCwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB0aGlzLm1fckIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5uZWcodGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciBLID0gbmV3IE1hdDIyKCk7XG4gICAgICAgIEsuZXgueCA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9yQS55ICogdGhpcy5tX3JBLnkgKyBpQiAqIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnk7XG4gICAgICAgIEsuZXgueSA9IC1pQSAqIHRoaXMubV9yQS54ICogdGhpcy5tX3JBLnkgLSBpQiAqIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLnk7XG4gICAgICAgIEsuZXkueCA9IEsuZXgueTtcbiAgICAgICAgSy5leS55ID0gbUEgKyBtQiArIGlBICogdGhpcy5tX3JBLnggKiB0aGlzLm1fckEueCArIGlCICogdGhpcy5tX3JCLnggKiB0aGlzLm1fckIueDtcbiAgICAgICAgdGhpcy5tX2xpbmVhck1hc3MgPSBLLmdldEludmVyc2UoKTtcbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJNYXNzID0gaUEgKyBpQjtcbiAgICAgICAgaWYgKHRoaXMubV9hbmd1bGFyTWFzcyA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhck1hc3MgPSAxIC8gdGhpcy5tX2FuZ3VsYXJNYXNzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9saW5lYXJFcnJvciA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLm1fbGluZWFyRXJyb3IuYWRkQ29tYmluZSgxLCBjQjIsIDEsIHRoaXMubV9yQik7XG4gICAgICAgIHRoaXMubV9saW5lYXJFcnJvci5zdWJDb21iaW5lKDEsIGNBMiwgMSwgdGhpcy5tX3JBKTtcbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJFcnJvciA9IGFCIC0gYUEgLSB0aGlzLm1fYW5ndWxhck9mZnNldDtcbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UubXVsKHN0ZXAuZHRSYXRpbyk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm5lbyh0aGlzLm1fbGluZWFySW1wdWxzZS54LCB0aGlzLm1fbGluZWFySW1wdWxzZS55KTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpICsgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpICsgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIGggPSBzdGVwLmR0O1xuICAgICAgICB2YXIgaW52X2ggPSBzdGVwLmludl9kdDtcbiAgICAgICAge1xuICAgICAgICAgIHZhciBDZG90ID0gd0IgLSB3QSArIGludl9oICogdGhpcy5tX2NvcnJlY3Rpb25GYWN0b3IgKiB0aGlzLm1fYW5ndWxhckVycm9yO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9hbmd1bGFyTWFzcyAqIENkb3Q7XG4gICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fYW5ndWxhckltcHVsc2U7XG4gICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBoICogdGhpcy5tX21heFRvcnF1ZTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgPSBjbGFtcCh0aGlzLm1fYW5ndWxhckltcHVsc2UgKyBpbXB1bHNlLCAtbWF4SW1wdWxzZSwgbWF4SW1wdWxzZSk7XG4gICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9hbmd1bGFySW1wdWxzZSAtIG9sZEltcHVsc2U7XG4gICAgICAgICAgd0EgLT0gaUEgKiBpbXB1bHNlO1xuICAgICAgICAgIHdCICs9IGlCICogaW1wdWxzZTtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgdmFyIENkb3QgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBDZG90LmFkZENvbWJpbmUoMSwgdkIyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKSk7XG4gICAgICAgICAgQ2RvdC5zdWJDb21iaW5lKDEsIHZBMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0EsIHRoaXMubV9yQSkpO1xuICAgICAgICAgIENkb3QuYWRkTXVsKGludl9oICogdGhpcy5tX2NvcnJlY3Rpb25GYWN0b3IsIHRoaXMubV9saW5lYXJFcnJvcik7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSBWZWMyLm5lZyhNYXQyMi5tdWxWZWMyKHRoaXMubV9saW5lYXJNYXNzLCBDZG90KSk7XG4gICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSBWZWMyLmNsb25lKHRoaXMubV9saW5lYXJJbXB1bHNlKTtcbiAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5hZGQoaW1wdWxzZSk7XG4gICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBoICogdGhpcy5tX21heEZvcmNlO1xuICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLmNsYW1wKG1heEltcHVsc2UpO1xuICAgICAgICAgIGltcHVsc2UgPSBWZWMyLnN1Yih0aGlzLm1fbGluZWFySW1wdWxzZSwgb2xkSW1wdWxzZSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgaW1wdWxzZSk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBpbXB1bHNlKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBpbXB1bHNlKTtcbiAgICAgICAgICB3QiArPSBpQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIGltcHVsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLlRZUEUgPSBcIm1vdG9yLWpvaW50XCI7XG4gICAgICByZXR1cm4gTW90b3JKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIG1hdGhfUEkkMiA9IE1hdGguUEk7XG4gIHZhciBERUZBVUxUUyQ0ID0ge1xuICAgIG1heEZvcmNlOiAwLFxuICAgIGZyZXF1ZW5jeUh6OiA1LFxuICAgIGRhbXBpbmdSYXRpbzogMC43XG4gIH07XG4gIHZhciBNb3VzZUpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhNb3VzZUpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIE1vdXNlSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCB0YXJnZXQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBNb3VzZUpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IE1vdXNlSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCB0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQ0KTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IE1vdXNlSm9pbnQyLlRZUEU7XG4gICAgICAgIGlmIChWZWMyLmlzVmFsaWQodGFyZ2V0KSkge1xuICAgICAgICAgIF90aGlzLm1fdGFyZ2V0QSA9IFZlYzIuY2xvbmUodGFyZ2V0KTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmLnRhcmdldCkpIHtcbiAgICAgICAgICBfdGhpcy5tX3RhcmdldEEgPSBWZWMyLmNsb25lKGRlZi50YXJnZXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF90aGlzLm1fdGFyZ2V0QSA9IFZlYzIuemVybygpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVHJhbnNmb3JtLm11bFRWZWMyKGJvZHlCLmdldFRyYW5zZm9ybSgpLCBfdGhpcy5tX3RhcmdldEEpO1xuICAgICAgICBfdGhpcy5tX21heEZvcmNlID0gZGVmLm1heEZvcmNlO1xuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgICAgX3RoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xuICAgICAgICBfdGhpcy5tX2JldGEgPSAwO1xuICAgICAgICBfdGhpcy5tX2dhbW1hID0gMDtcbiAgICAgICAgX3RoaXMubV9yQiA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQ2VudGVyQiA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX2ludk1hc3NCID0gMDtcbiAgICAgICAgX3RoaXMubV9pbnZJQiA9IDA7XG4gICAgICAgIF90aGlzLm1fbWFzcyA9IG5ldyBNYXQyMigpO1xuICAgICAgICBfdGhpcy5tX0MgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgdGFyZ2V0OiB0aGlzLm1fdGFyZ2V0QSxcbiAgICAgICAgICBtYXhGb3JjZTogdGhpcy5tX21heEZvcmNlLFxuICAgICAgICAgIGZyZXF1ZW5jeUh6OiB0aGlzLm1fZnJlcXVlbmN5SHosXG4gICAgICAgICAgZGFtcGluZ1JhdGlvOiB0aGlzLm1fZGFtcGluZ1JhdGlvLFxuICAgICAgICAgIF9sb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckJcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgZGF0YS50YXJnZXQgPSBWZWMyLmNsb25lKGRhdGEudGFyZ2V0KTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IE1vdXNlSm9pbnQyKGRhdGEpO1xuICAgICAgICBpZiAoZGF0YS5fbG9jYWxBbmNob3JCKSB7XG4gICAgICAgICAgam9pbnQubV9sb2NhbEFuY2hvckIgPSBkYXRhLl9sb2NhbEFuY2hvckI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4Rm9yY2UpKSB7XG4gICAgICAgICAgdGhpcy5tX21heEZvcmNlID0gZGVmLm1heEZvcmNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmZyZXF1ZW5jeUh6KSkge1xuICAgICAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5kYW1waW5nUmF0aW8pKSB7XG4gICAgICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuc2V0VGFyZ2V0ID0gZnVuY3Rpb24odGFyZ2V0KSB7XG4gICAgICAgIGlmIChWZWMyLmFyZUVxdWFsKHRhcmdldCwgdGhpcy5tX3RhcmdldEEpKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fdGFyZ2V0QS5zZXQodGFyZ2V0KTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0VGFyZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdGFyZ2V0QTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuc2V0TWF4Rm9yY2UgPSBmdW5jdGlvbihmb3JjZSkge1xuICAgICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBmb3JjZTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0TWF4Rm9yY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhGb3JjZTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuc2V0RnJlcXVlbmN5ID0gZnVuY3Rpb24oaHopIHtcbiAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gaHo7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLmdldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbihyYXRpbykge1xuICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gcmF0aW87XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLmdldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2RhbXBpbmdSYXRpbztcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVmVjMi5jbG9uZSh0aGlzLm1fdGFyZ2V0QSk7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm11bE51bVZlYzIoaW52X2R0LCB0aGlzLm1faW1wdWxzZSk7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiAwO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zaGlmdE9yaWdpbiA9IGZ1bmN0aW9uKG5ld09yaWdpbikge1xuICAgICAgICB0aGlzLm1fdGFyZ2V0QS5zdWIobmV3T3JpZ2luKTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIHBvc2l0aW9uID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb247XG4gICAgICAgIHZhciB2ZWxvY2l0eSA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5O1xuICAgICAgICB2YXIgY0IyID0gcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgbWFzcyA9IHRoaXMubV9ib2R5Qi5nZXRNYXNzKCk7XG4gICAgICAgIHZhciBvbWVnYSA9IDIgKiBtYXRoX1BJJDIgKiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICAgIHZhciBkMiA9IDIgKiBtYXNzICogdGhpcy5tX2RhbXBpbmdSYXRpbyAqIG9tZWdhO1xuICAgICAgICB2YXIgayA9IG1hc3MgKiAob21lZ2EgKiBvbWVnYSk7XG4gICAgICAgIHZhciBoID0gc3RlcC5kdDtcbiAgICAgICAgdGhpcy5tX2dhbW1hID0gaCAqIChkMiArIGggKiBrKTtcbiAgICAgICAgaWYgKHRoaXMubV9nYW1tYSAhPSAwKSB7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gMSAvIHRoaXMubV9nYW1tYTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYmV0YSA9IGggKiBrICogdGhpcy5tX2dhbW1hO1xuICAgICAgICB0aGlzLm1fckIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgSyA9IG5ldyBNYXQyMigpO1xuICAgICAgICBLLmV4LnggPSB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUIgKiB0aGlzLm1fckIueSAqIHRoaXMubV9yQi55ICsgdGhpcy5tX2dhbW1hO1xuICAgICAgICBLLmV4LnkgPSAtdGhpcy5tX2ludklCICogdGhpcy5tX3JCLnggKiB0aGlzLm1fckIueTtcbiAgICAgICAgSy5leS54ID0gSy5leC55O1xuICAgICAgICBLLmV5LnkgPSB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUIgKiB0aGlzLm1fckIueCAqIHRoaXMubV9yQi54ICsgdGhpcy5tX2dhbW1hO1xuICAgICAgICB0aGlzLm1fbWFzcyA9IEsuZ2V0SW52ZXJzZSgpO1xuICAgICAgICB0aGlzLm1fQy5zZXRWZWMyKGNCMik7XG4gICAgICAgIHRoaXMubV9DLmFkZENvbWJpbmUoMSwgdGhpcy5tX3JCLCAtMSwgdGhpcy5tX3RhcmdldEEpO1xuICAgICAgICB0aGlzLm1fQy5tdWwodGhpcy5tX2JldGEpO1xuICAgICAgICB3QiAqPSAwLjk4O1xuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5tdWwoc3RlcC5kdFJhdGlvKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgdGhpcy5tX2ltcHVsc2UpO1xuICAgICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIHRoaXMubV9pbXB1bHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5zZXRaZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdmVsb2NpdHkgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eTtcbiAgICAgICAgdmFyIHZCMiA9IFZlYzIuY2xvbmUodmVsb2NpdHkudik7XG4gICAgICAgIHZhciB3QiA9IHZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBDZG90ID0gVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQik7XG4gICAgICAgIENkb3QuYWRkKHZCMik7XG4gICAgICAgIENkb3QuYWRkQ29tYmluZSgxLCB0aGlzLm1fQywgdGhpcy5tX2dhbW1hLCB0aGlzLm1faW1wdWxzZSk7XG4gICAgICAgIENkb3QubmVnKCk7XG4gICAgICAgIHZhciBpbXB1bHNlID0gTWF0MjIubXVsVmVjMih0aGlzLm1fbWFzcywgQ2RvdCk7XG4gICAgICAgIHZhciBvbGRJbXB1bHNlID0gVmVjMi5jbG9uZSh0aGlzLm1faW1wdWxzZSk7XG4gICAgICAgIHRoaXMubV9pbXB1bHNlLmFkZChpbXB1bHNlKTtcbiAgICAgICAgdmFyIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heEZvcmNlO1xuICAgICAgICB0aGlzLm1faW1wdWxzZS5jbGFtcChtYXhJbXB1bHNlKTtcbiAgICAgICAgaW1wdWxzZSA9IFZlYzIuc3ViKHRoaXMubV9pbXB1bHNlLCBvbGRJbXB1bHNlKTtcbiAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIGltcHVsc2UpO1xuICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBpbXB1bHNlKTtcbiAgICAgICAgdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5UWVBFID0gXCJtb3VzZS1qb2ludFwiO1xuICAgICAgcmV0dXJuIE1vdXNlSm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBtYXRoX2FicyQyID0gTWF0aC5hYnM7XG4gIHZhciBERUZBVUxUUyQzID0ge1xuICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRydWVcbiAgfTtcbiAgdmFyIFB1bGxleUpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhQdWxsZXlKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBQdWxsZXlKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGdyb3VuZEEsIGdyb3VuZEIsIGFuY2hvckEsIGFuY2hvckIsIHJhdGlvKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgUHVsbGV5Sm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgUHVsbGV5Sm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBncm91bmRBLCBncm91bmRCLCBhbmNob3JBLCBhbmNob3JCLCByYXRpbyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDMpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gUHVsbGV5Sm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fZ3JvdW5kQW5jaG9yQSA9IFZlYzIuY2xvbmUoZ3JvdW5kQSA/IGdyb3VuZEEgOiBkZWYuZ3JvdW5kQW5jaG9yQSB8fCBWZWMyLm5lbygtMSwgMSkpO1xuICAgICAgICBfdGhpcy5tX2dyb3VuZEFuY2hvckIgPSBWZWMyLmNsb25lKGdyb3VuZEIgPyBncm91bmRCIDogZGVmLmdyb3VuZEFuY2hvckIgfHwgVmVjMi5uZW8oMSwgMSkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoYW5jaG9yQSA/IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yQSkgOiBkZWYubG9jYWxBbmNob3JBIHx8IFZlYzIubmVvKC0xLCAwKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVmVjMi5jbG9uZShhbmNob3JCID8gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3JCKSA6IGRlZi5sb2NhbEFuY2hvckIgfHwgVmVjMi5uZW8oMSwgMCkpO1xuICAgICAgICBfdGhpcy5tX2xlbmd0aEEgPSBOdW1iZXIuaXNGaW5pdGUoZGVmLmxlbmd0aEEpID8gZGVmLmxlbmd0aEEgOiBWZWMyLmRpc3RhbmNlKGFuY2hvckEsIGdyb3VuZEEpO1xuICAgICAgICBfdGhpcy5tX2xlbmd0aEIgPSBOdW1iZXIuaXNGaW5pdGUoZGVmLmxlbmd0aEIpID8gZGVmLmxlbmd0aEIgOiBWZWMyLmRpc3RhbmNlKGFuY2hvckIsIGdyb3VuZEIpO1xuICAgICAgICBfdGhpcy5tX3JhdGlvID0gTnVtYmVyLmlzRmluaXRlKHJhdGlvKSA/IHJhdGlvIDogZGVmLnJhdGlvO1xuICAgICAgICBfdGhpcy5tX2NvbnN0YW50ID0gX3RoaXMubV9sZW5ndGhBICsgX3RoaXMubV9yYXRpbyAqIF90aGlzLm1fbGVuZ3RoQjtcbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGdyb3VuZEFuY2hvckE6IHRoaXMubV9ncm91bmRBbmNob3JBLFxuICAgICAgICAgIGdyb3VuZEFuY2hvckI6IHRoaXMubV9ncm91bmRBbmNob3JCLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckIsXG4gICAgICAgICAgbGVuZ3RoQTogdGhpcy5tX2xlbmd0aEEsXG4gICAgICAgICAgbGVuZ3RoQjogdGhpcy5tX2xlbmd0aEIsXG4gICAgICAgICAgcmF0aW86IHRoaXMubV9yYXRpb1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IFB1bGxleUpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChWZWMyLmlzVmFsaWQoZGVmLmdyb3VuZEFuY2hvckEpKSB7XG4gICAgICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvckEuc2V0KGRlZi5ncm91bmRBbmNob3JBKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5ncm91bmRBbmNob3JCKSkge1xuICAgICAgICAgIHRoaXMubV9ncm91bmRBbmNob3JCLnNldChkZWYuZ3JvdW5kQW5jaG9yQik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChkZWYubG9jYWxBbmNob3JBKSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0KGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYuYW5jaG9yQSkpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldCh0aGlzLm1fYm9keUEuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChWZWMyLmlzVmFsaWQoZGVmLmxvY2FsQW5jaG9yQikpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldChkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmLmFuY2hvckIpKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXQodGhpcy5tX2JvZHlCLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckIpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5sZW5ndGhBKSkge1xuICAgICAgICAgIHRoaXMubV9sZW5ndGhBID0gZGVmLmxlbmd0aEE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubGVuZ3RoQikpIHtcbiAgICAgICAgICB0aGlzLm1fbGVuZ3RoQiA9IGRlZi5sZW5ndGhCO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLnJhdGlvKSkge1xuICAgICAgICAgIHRoaXMubV9yYXRpbyA9IGRlZi5yYXRpbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0R3JvdW5kQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2dyb3VuZEFuY2hvckE7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRHcm91bmRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZ3JvdW5kQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldExlbmd0aEEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sZW5ndGhBO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0TGVuZ3RoQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xlbmd0aEI7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRSYXRpbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3JhdGlvO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0Q3VycmVudExlbmd0aEEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHAgPSB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgICAgdmFyIHMyID0gdGhpcy5tX2dyb3VuZEFuY2hvckE7XG4gICAgICAgIHJldHVybiBWZWMyLmRpc3RhbmNlKHAsIHMyKTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldEN1cnJlbnRMZW5ndGhCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwID0gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICAgIHZhciBzMiA9IHRoaXMubV9ncm91bmRBbmNob3JCO1xuICAgICAgICByZXR1cm4gVmVjMi5kaXN0YW5jZShwLCBzMik7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5zaGlmdE9yaWdpbiA9IGZ1bmN0aW9uKG5ld09yaWdpbikge1xuICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yQS5zdWIobmV3T3JpZ2luKTtcbiAgICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvckIuc3ViKG5ld09yaWdpbik7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5tdWxOdW1WZWMyKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fdUIpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHRoaXMubV9yQSA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHRoaXMubV91QSA9IFZlYzIuc3ViKFZlYzIuYWRkKGNBMiwgdGhpcy5tX3JBKSwgdGhpcy5tX2dyb3VuZEFuY2hvckEpO1xuICAgICAgICB0aGlzLm1fdUIgPSBWZWMyLnN1YihWZWMyLmFkZChjQjIsIHRoaXMubV9yQiksIHRoaXMubV9ncm91bmRBbmNob3JCKTtcbiAgICAgICAgdmFyIGxlbmd0aEEgPSB0aGlzLm1fdUEubGVuZ3RoKCk7XG4gICAgICAgIHZhciBsZW5ndGhCID0gdGhpcy5tX3VCLmxlbmd0aCgpO1xuICAgICAgICBpZiAobGVuZ3RoQSA+IDEwICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKSB7XG4gICAgICAgICAgdGhpcy5tX3VBLm11bCgxIC8gbGVuZ3RoQSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3VBLnNldFplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGVuZ3RoQiA+IDEwICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKSB7XG4gICAgICAgICAgdGhpcy5tX3VCLm11bCgxIC8gbGVuZ3RoQik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3VCLnNldFplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcnVBID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgdGhpcy5tX3VBKTtcbiAgICAgICAgdmFyIHJ1QiA9IFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIHRoaXMubV91Qik7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQSArIHRoaXMubV9pbnZJQSAqIHJ1QSAqIHJ1QTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklCICogcnVCICogcnVCO1xuICAgICAgICB0aGlzLm1fbWFzcyA9IG1BICsgdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogbUI7XG4gICAgICAgIGlmICh0aGlzLm1fbWFzcyA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fbWFzcyA9IDEgLyB0aGlzLm1fbWFzcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdmFyIFBBID0gVmVjMi5tdWxOdW1WZWMyKC10aGlzLm1faW1wdWxzZSwgdGhpcy5tX3VBKTtcbiAgICAgICAgICB2YXIgUEIgPSBWZWMyLm11bE51bVZlYzIoLXRoaXMubV9yYXRpbyAqIHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fdUIpO1xuICAgICAgICAgIHZBMi5hZGRNdWwodGhpcy5tX2ludk1hc3NBLCBQQSk7XG4gICAgICAgICAgd0EgKz0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUEEpO1xuICAgICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQQik7XG4gICAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUEIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdnBBID0gVmVjMi5hZGQodkEyLCBWZWMyLmNyb3NzTnVtVmVjMih3QSwgdGhpcy5tX3JBKSk7XG4gICAgICAgIHZhciB2cEIgPSBWZWMyLmFkZCh2QjIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpKTtcbiAgICAgICAgdmFyIENkb3QgPSAtVmVjMi5kb3QodGhpcy5tX3VBLCB2cEEpIC0gdGhpcy5tX3JhdGlvICogVmVjMi5kb3QodGhpcy5tX3VCLCB2cEIpO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbWFzcyAqIENkb3Q7XG4gICAgICAgIHRoaXMubV9pbXB1bHNlICs9IGltcHVsc2U7XG4gICAgICAgIHZhciBQQSA9IFZlYzIubXVsTnVtVmVjMigtaW1wdWxzZSwgdGhpcy5tX3VBKTtcbiAgICAgICAgdmFyIFBCID0gVmVjMi5tdWxOdW1WZWMyKC10aGlzLm1fcmF0aW8gKiBpbXB1bHNlLCB0aGlzLm1fdUIpO1xuICAgICAgICB2QTIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQSwgUEEpO1xuICAgICAgICB3QSArPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQQSk7XG4gICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQQik7XG4gICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFBCKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciB1QSA9IFZlYzIuc3ViKFZlYzIuYWRkKGNBMiwgdGhpcy5tX3JBKSwgdGhpcy5tX2dyb3VuZEFuY2hvckEpO1xuICAgICAgICB2YXIgdUIgPSBWZWMyLnN1YihWZWMyLmFkZChjQjIsIHRoaXMubV9yQiksIHRoaXMubV9ncm91bmRBbmNob3JCKTtcbiAgICAgICAgdmFyIGxlbmd0aEEgPSB1QS5sZW5ndGgoKTtcbiAgICAgICAgdmFyIGxlbmd0aEIgPSB1Qi5sZW5ndGgoKTtcbiAgICAgICAgaWYgKGxlbmd0aEEgPiAxMCAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCkge1xuICAgICAgICAgIHVBLm11bCgxIC8gbGVuZ3RoQSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdUEuc2V0WmVybygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsZW5ndGhCID4gMTAgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3ApIHtcbiAgICAgICAgICB1Qi5tdWwoMSAvIGxlbmd0aEIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHVCLnNldFplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcnVBID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgdUEpO1xuICAgICAgICB2YXIgcnVCID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgdUIpO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0EgKyB0aGlzLm1faW52SUEgKiBydUEgKiBydUE7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQiAqIHJ1QiAqIHJ1QjtcbiAgICAgICAgdmFyIG1hc3MgPSBtQSArIHRoaXMubV9yYXRpbyAqIHRoaXMubV9yYXRpbyAqIG1CO1xuICAgICAgICBpZiAobWFzcyA+IDApIHtcbiAgICAgICAgICBtYXNzID0gMSAvIG1hc3M7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIEMgPSB0aGlzLm1fY29uc3RhbnQgLSBsZW5ndGhBIC0gdGhpcy5tX3JhdGlvICogbGVuZ3RoQjtcbiAgICAgICAgdmFyIGxpbmVhckVycm9yID0gbWF0aF9hYnMkMihDKTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSAtbWFzcyAqIEM7XG4gICAgICAgIHZhciBQQSA9IFZlYzIubXVsTnVtVmVjMigtaW1wdWxzZSwgdUEpO1xuICAgICAgICB2YXIgUEIgPSBWZWMyLm11bE51bVZlYzIoLXRoaXMubV9yYXRpbyAqIGltcHVsc2UsIHVCKTtcbiAgICAgICAgY0EyLmFkZE11bCh0aGlzLm1faW52TWFzc0EsIFBBKTtcbiAgICAgICAgYUEgKz0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgUEEpO1xuICAgICAgICBjQjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUEIpO1xuICAgICAgICBhQiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBQQik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMgPSBjQTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmEgPSBhQTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYyA9IGNCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICByZXR1cm4gbGluZWFyRXJyb3IgPCBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLlRZUEUgPSBcInB1bGxleS1qb2ludFwiO1xuICAgICAgcmV0dXJuIFB1bGxleUpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgbWF0aF9taW4kMSA9IE1hdGgubWluO1xuICB2YXIgTGltaXRTdGF0ZTtcbiAgKGZ1bmN0aW9uKExpbWl0U3RhdGUyKSB7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJpbmFjdGl2ZUxpbWl0XCJdID0gMF0gPSBcImluYWN0aXZlTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImF0TG93ZXJMaW1pdFwiXSA9IDFdID0gXCJhdExvd2VyTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImF0VXBwZXJMaW1pdFwiXSA9IDJdID0gXCJhdFVwcGVyTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImVxdWFsTGltaXRzXCJdID0gM10gPSBcImVxdWFsTGltaXRzXCI7XG4gIH0pKExpbWl0U3RhdGUgfHwgKExpbWl0U3RhdGUgPSB7fSkpO1xuICB2YXIgREVGQVVMVFMkMiA9IHtcbiAgICBtYXhMZW5ndGg6IDBcbiAgfTtcbiAgdmFyIFJvcGVKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoUm9wZUpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIFJvcGVKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIFJvcGVKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBSb3BlSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQyKTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IFJvcGVKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi5uZW8oLTEsIDApKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckIgfHwgVmVjMi5uZW8oMSwgMCkpO1xuICAgICAgICBfdGhpcy5tX21heExlbmd0aCA9IGRlZi5tYXhMZW5ndGg7XG4gICAgICAgIF90aGlzLm1fbWFzcyA9IDA7XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbGVuZ3RoID0gMDtcbiAgICAgICAgX3RoaXMubV9zdGF0ZSA9IExpbWl0U3RhdGUuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCLFxuICAgICAgICAgIG1heExlbmd0aDogdGhpcy5tX21heExlbmd0aFxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBSb3BlSm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1heExlbmd0aCkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4TGVuZ3RoID0gZGVmLm1heExlbmd0aDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuc2V0TWF4TGVuZ3RoID0gZnVuY3Rpb24obGVuZ3RoKSB7XG4gICAgICAgIHRoaXMubV9tYXhMZW5ndGggPSBsZW5ndGg7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuZ2V0TWF4TGVuZ3RoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4TGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldExpbWl0U3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9zdGF0ZTtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm11bE51bVZlYzIodGhpcy5tX2ltcHVsc2UsIHRoaXMubV91KS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHRoaXMubV9yQSA9IFJvdC5tdWxTdWIocUEsIHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpO1xuICAgICAgICB0aGlzLm1fckIgPSBSb3QubXVsU3ViKHFCLCB0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKTtcbiAgICAgICAgdGhpcy5tX3UgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5tX3UuYWRkQ29tYmluZSgxLCBjQjIsIDEsIHRoaXMubV9yQik7XG4gICAgICAgIHRoaXMubV91LnN1YkNvbWJpbmUoMSwgY0EyLCAxLCB0aGlzLm1fckEpO1xuICAgICAgICB0aGlzLm1fbGVuZ3RoID0gdGhpcy5tX3UubGVuZ3RoKCk7XG4gICAgICAgIHZhciBDID0gdGhpcy5tX2xlbmd0aCAtIHRoaXMubV9tYXhMZW5ndGg7XG4gICAgICAgIGlmIChDID4gMCkge1xuICAgICAgICAgIHRoaXMubV9zdGF0ZSA9IExpbWl0U3RhdGUuYXRVcHBlckxpbWl0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9zdGF0ZSA9IExpbWl0U3RhdGUuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2xlbmd0aCA+IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCkge1xuICAgICAgICAgIHRoaXMubV91Lm11bCgxIC8gdGhpcy5tX2xlbmd0aCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3Uuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gMDtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjckEgPSBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCB0aGlzLm1fdSk7XG4gICAgICAgIHZhciBjckIgPSBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCB0aGlzLm1fdSk7XG4gICAgICAgIHZhciBpbnZNYXNzID0gdGhpcy5tX2ludk1hc3NBICsgdGhpcy5tX2ludklBICogY3JBICogY3JBICsgdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklCICogY3JCICogY3JCO1xuICAgICAgICB0aGlzLm1fbWFzcyA9IGludk1hc3MgIT0gMCA/IDEgLyBpbnZNYXNzIDogMDtcbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMih0aGlzLm1faW1wdWxzZSwgdGhpcy5tX3UpO1xuICAgICAgICAgIHZBMi5zdWJNdWwodGhpcy5tX2ludk1hc3NBLCBQMyk7XG4gICAgICAgICAgd0EgLT0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpO1xuICAgICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQMyk7XG4gICAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52LnNldFZlYzIodkEyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdnBBID0gVmVjMi5hZGRDcm9zc051bVZlYzIodkEyLCB3QSwgdGhpcy5tX3JBKTtcbiAgICAgICAgdmFyIHZwQiA9IFZlYzIuYWRkQ3Jvc3NOdW1WZWMyKHZCMiwgd0IsIHRoaXMubV9yQik7XG4gICAgICAgIHZhciBDID0gdGhpcy5tX2xlbmd0aCAtIHRoaXMubV9tYXhMZW5ndGg7XG4gICAgICAgIHZhciBDZG90ID0gVmVjMi5kb3QodGhpcy5tX3UsIFZlYzIuc3ViKHZwQiwgdnBBKSk7XG4gICAgICAgIGlmIChDIDwgMCkge1xuICAgICAgICAgIENkb3QgKz0gc3RlcC5pbnZfZHQgKiBDO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tYXNzICogQ2RvdDtcbiAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1faW1wdWxzZTtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSBtYXRoX21pbiQxKDAsIHRoaXMubV9pbXB1bHNlICsgaW1wdWxzZSk7XG4gICAgICAgIGltcHVsc2UgPSB0aGlzLm1faW1wdWxzZSAtIG9sZEltcHVsc2U7XG4gICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihpbXB1bHNlLCB0aGlzLm1fdSk7XG4gICAgICAgIHZBMi5zdWJNdWwodGhpcy5tX2ludk1hc3NBLCBQMyk7XG4gICAgICAgIHdBIC09IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKTtcbiAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFAzKTtcbiAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFN1YihxQSwgdGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSk7XG4gICAgICAgIHZhciByQjIgPSBSb3QubXVsU3ViKHFCLCB0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKTtcbiAgICAgICAgdmFyIHUgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdS5hZGRDb21iaW5lKDEsIGNCMiwgMSwgckIyKTtcbiAgICAgICAgdS5zdWJDb21iaW5lKDEsIGNBMiwgMSwgckEyKTtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHUubm9ybWFsaXplKCk7XG4gICAgICAgIHZhciBDID0gbGVuZ3RoIC0gdGhpcy5tX21heExlbmd0aDtcbiAgICAgICAgQyA9IGNsYW1wKEMsIDAsIFNldHRpbmdzSW50ZXJuYWwubWF4TGluZWFyQ29ycmVjdGlvbik7XG4gICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tYXNzICogQztcbiAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIHUpO1xuICAgICAgICBjQTIuc3ViTXVsKHRoaXMubV9pbnZNYXNzQSwgUDMpO1xuICAgICAgICBhQSAtPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCBQMyk7XG4gICAgICAgIGNCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQMyk7XG4gICAgICAgIGFCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIFAzKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmEgPSBhQTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmEgPSBhQjtcbiAgICAgICAgcmV0dXJuIGxlbmd0aCAtIHRoaXMubV9tYXhMZW5ndGggPCBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5UWVBFID0gXCJyb3BlLWpvaW50XCI7XG4gICAgICByZXR1cm4gUm9wZUpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgbWF0aF9hYnMkMSA9IE1hdGguYWJzO1xuICB2YXIgbWF0aF9QSSQxID0gTWF0aC5QSTtcbiAgdmFyIERFRkFVTFRTJDEgPSB7XG4gICAgZnJlcXVlbmN5SHo6IDAsXG4gICAgZGFtcGluZ1JhdGlvOiAwXG4gIH07XG4gIHZhciBXZWxkSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFdlbGRKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBXZWxkSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBXZWxkSm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgV2VsZEpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkMSk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBXZWxkSm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5QS5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JBIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckIgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlID0gTnVtYmVyLmlzRmluaXRlKGRlZi5yZWZlcmVuY2VBbmdsZSkgPyBkZWYucmVmZXJlbmNlQW5nbGUgOiBib2R5Qi5nZXRBbmdsZSgpIC0gYm9keUEuZ2V0QW5nbGUoKTtcbiAgICAgICAgX3RoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgICAgX3RoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSBuZXcgVmVjMygpO1xuICAgICAgICBfdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICBfdGhpcy5tX2dhbW1hID0gMDtcbiAgICAgICAgX3RoaXMubV9tYXNzID0gbmV3IE1hdDMzKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgZnJlcXVlbmN5SHo6IHRoaXMubV9mcmVxdWVuY3lIeixcbiAgICAgICAgICBkYW1waW5nUmF0aW86IHRoaXMubV9kYW1waW5nUmF0aW8sXG4gICAgICAgICAgbG9jYWxBbmNob3JBOiB0aGlzLm1fbG9jYWxBbmNob3JBLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQixcbiAgICAgICAgICByZWZlcmVuY2VBbmdsZTogdGhpcy5tX3JlZmVyZW5jZUFuZ2xlXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IFdlbGRKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKGRlZi5hbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKHRoaXMubV9ib2R5QS5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JBKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMihkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIodGhpcy5tX2JvZHlCLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckIpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmZyZXF1ZW5jeUh6KSkge1xuICAgICAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5kYW1waW5nUmF0aW8pKSB7XG4gICAgICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckE7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JCO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldFJlZmVyZW5jZUFuZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuc2V0RnJlcXVlbmN5ID0gZnVuY3Rpb24oaHopIHtcbiAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gaHo7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0RnJlcXVlbmN5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuc2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24ocmF0aW8pIHtcbiAgICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IHJhdGlvO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2RhbXBpbmdSYXRpbztcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh0aGlzLm1faW1wdWxzZS54LCB0aGlzLm1faW1wdWxzZS55KS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UuejtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB0aGlzLm1fckEgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB0aGlzLm1fckIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciBLID0gbmV3IE1hdDMzKCk7XG4gICAgICAgIEsuZXgueCA9IG1BICsgbUIgKyB0aGlzLm1fckEueSAqIHRoaXMubV9yQS55ICogaUEgKyB0aGlzLm1fckIueSAqIHRoaXMubV9yQi55ICogaUI7XG4gICAgICAgIEsuZXkueCA9IC10aGlzLm1fckEueSAqIHRoaXMubV9yQS54ICogaUEgLSB0aGlzLm1fckIueSAqIHRoaXMubV9yQi54ICogaUI7XG4gICAgICAgIEsuZXoueCA9IC10aGlzLm1fckEueSAqIGlBIC0gdGhpcy5tX3JCLnkgKiBpQjtcbiAgICAgICAgSy5leC55ID0gSy5leS54O1xuICAgICAgICBLLmV5LnkgPSBtQSArIG1CICsgdGhpcy5tX3JBLnggKiB0aGlzLm1fckEueCAqIGlBICsgdGhpcy5tX3JCLnggKiB0aGlzLm1fckIueCAqIGlCO1xuICAgICAgICBLLmV6LnkgPSB0aGlzLm1fckEueCAqIGlBICsgdGhpcy5tX3JCLnggKiBpQjtcbiAgICAgICAgSy5leC56ID0gSy5lei54O1xuICAgICAgICBLLmV5LnogPSBLLmV6Lnk7XG4gICAgICAgIEsuZXoueiA9IGlBICsgaUI7XG4gICAgICAgIGlmICh0aGlzLm1fZnJlcXVlbmN5SHogPiAwKSB7XG4gICAgICAgICAgSy5nZXRJbnZlcnNlMjIodGhpcy5tX21hc3MpO1xuICAgICAgICAgIHZhciBpbnZNID0gaUEgKyBpQjtcbiAgICAgICAgICB2YXIgbSA9IGludk0gPiAwID8gMSAvIGludk0gOiAwO1xuICAgICAgICAgIHZhciBDID0gYUIgLSBhQSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICB2YXIgb21lZ2EgPSAyICogbWF0aF9QSSQxICogdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgICAgIHZhciBkMiA9IDIgKiBtICogdGhpcy5tX2RhbXBpbmdSYXRpbyAqIG9tZWdhO1xuICAgICAgICAgIHZhciBrID0gbSAqIG9tZWdhICogb21lZ2E7XG4gICAgICAgICAgdmFyIGggPSBzdGVwLmR0O1xuICAgICAgICAgIHRoaXMubV9nYW1tYSA9IGggKiAoZDIgKyBoICogayk7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gdGhpcy5tX2dhbW1hICE9IDAgPyAxIC8gdGhpcy5tX2dhbW1hIDogMDtcbiAgICAgICAgICB0aGlzLm1fYmlhcyA9IEMgKiBoICogayAqIHRoaXMubV9nYW1tYTtcbiAgICAgICAgICBpbnZNICs9IHRoaXMubV9nYW1tYTtcbiAgICAgICAgICB0aGlzLm1fbWFzcy5lei56ID0gaW52TSAhPSAwID8gMSAvIGludk0gOiAwO1xuICAgICAgICB9IGVsc2UgaWYgKEsuZXoueiA9PSAwKSB7XG4gICAgICAgICAgSy5nZXRJbnZlcnNlMjIodGhpcy5tX21hc3MpO1xuICAgICAgICAgIHRoaXMubV9nYW1tYSA9IDA7XG4gICAgICAgICAgdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIEsuZ2V0U3ltSW52ZXJzZTMzKHRoaXMubV9tYXNzKTtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICAgIHRoaXMubV9iaWFzID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5tdWwoc3RlcC5kdFJhdGlvKTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm5lbyh0aGlzLm1faW1wdWxzZS54LCB0aGlzLm1faW1wdWxzZS55KTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpICsgdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKSArIHRoaXMubV9pbXB1bHNlLnopO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnNldFplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICBpZiAodGhpcy5tX2ZyZXF1ZW5jeUh6ID4gMCkge1xuICAgICAgICAgIHZhciBDZG90MiA9IHdCIC0gd0E7XG4gICAgICAgICAgdmFyIGltcHVsc2UyID0gLXRoaXMubV9tYXNzLmV6LnogKiAoQ2RvdDIgKyB0aGlzLm1fYmlhcyArIHRoaXMubV9nYW1tYSAqIHRoaXMubV9pbXB1bHNlLnopO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogKz0gaW1wdWxzZTI7XG4gICAgICAgICAgd0EgLT0gaUEgKiBpbXB1bHNlMjtcbiAgICAgICAgICB3QiArPSBpQiAqIGltcHVsc2UyO1xuICAgICAgICAgIHZhciBDZG90MSA9IFZlYzIuemVybygpO1xuICAgICAgICAgIENkb3QxLmFkZENvbWJpbmUoMSwgdkIyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKSk7XG4gICAgICAgICAgQ2RvdDEuc3ViQ29tYmluZSgxLCB2QTIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgICB2YXIgaW1wdWxzZTEgPSBWZWMyLm5lZyhNYXQzMy5tdWxWZWMyKHRoaXMubV9tYXNzLCBDZG90MSkpO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKz0gaW1wdWxzZTEueDtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ICs9IGltcHVsc2UxLnk7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5jbG9uZShpbXB1bHNlMSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgQ2RvdDEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBDZG90MS5hZGRDb21iaW5lKDEsIHZCMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpO1xuICAgICAgICAgIENkb3QxLnN1YkNvbWJpbmUoMSwgdkEyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QSwgdGhpcy5tX3JBKSk7XG4gICAgICAgICAgdmFyIENkb3QyID0gd0IgLSB3QTtcbiAgICAgICAgICB2YXIgQ2RvdCA9IG5ldyBWZWMzKENkb3QxLngsIENkb3QxLnksIENkb3QyKTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IFZlYzMubmVnKE1hdDMzLm11bFZlYzModGhpcy5tX21hc3MsIENkb3QpKTtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5hZGQoaW1wdWxzZSk7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5uZW8oaW1wdWxzZS54LCBpbXB1bHNlLnkpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMykgKyBpbXB1bHNlLnopO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMykgKyBpbXB1bHNlLnopO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHZhciByQjIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgcG9zaXRpb25FcnJvcjtcbiAgICAgICAgdmFyIGFuZ3VsYXJFcnJvcjtcbiAgICAgICAgdmFyIEsgPSBuZXcgTWF0MzMoKTtcbiAgICAgICAgSy5leC54ID0gbUEgKyBtQiArIHJBMi55ICogckEyLnkgKiBpQSArIHJCMi55ICogckIyLnkgKiBpQjtcbiAgICAgICAgSy5leS54ID0gLXJBMi55ICogckEyLnggKiBpQSAtIHJCMi55ICogckIyLnggKiBpQjtcbiAgICAgICAgSy5lei54ID0gLXJBMi55ICogaUEgLSByQjIueSAqIGlCO1xuICAgICAgICBLLmV4LnkgPSBLLmV5Lng7XG4gICAgICAgIEsuZXkueSA9IG1BICsgbUIgKyByQTIueCAqIHJBMi54ICogaUEgKyByQjIueCAqIHJCMi54ICogaUI7XG4gICAgICAgIEsuZXoueSA9IHJBMi54ICogaUEgKyByQjIueCAqIGlCO1xuICAgICAgICBLLmV4LnogPSBLLmV6Lng7XG4gICAgICAgIEsuZXkueiA9IEsuZXoueTtcbiAgICAgICAgSy5lei56ID0gaUEgKyBpQjtcbiAgICAgICAgaWYgKHRoaXMubV9mcmVxdWVuY3lIeiA+IDApIHtcbiAgICAgICAgICB2YXIgQzEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBDMS5hZGRDb21iaW5lKDEsIGNCMiwgMSwgckIyKTtcbiAgICAgICAgICBDMS5zdWJDb21iaW5lKDEsIGNBMiwgMSwgckEyKTtcbiAgICAgICAgICBwb3NpdGlvbkVycm9yID0gQzEubGVuZ3RoKCk7XG4gICAgICAgICAgYW5ndWxhckVycm9yID0gMDtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm5lZyhLLnNvbHZlMjIoQzEpKTtcbiAgICAgICAgICBjQTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgYUEgLT0gaUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCBQMyk7XG4gICAgICAgICAgY0IyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIGFCICs9IGlCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgUDMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBDMSA9IFZlYzIuemVybygpO1xuICAgICAgICAgIEMxLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICAgIEMxLnN1YkNvbWJpbmUoMSwgY0EyLCAxLCByQTIpO1xuICAgICAgICAgIHZhciBDMiA9IGFCIC0gYUEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICAgcG9zaXRpb25FcnJvciA9IEMxLmxlbmd0aCgpO1xuICAgICAgICAgIGFuZ3VsYXJFcnJvciA9IG1hdGhfYWJzJDEoQzIpO1xuICAgICAgICAgIHZhciBDID0gbmV3IFZlYzMoQzEueCwgQzEueSwgQzIpO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gbmV3IFZlYzMoKTtcbiAgICAgICAgICBpZiAoSy5lei56ID4gMCkge1xuICAgICAgICAgICAgaW1wdWxzZSA9IFZlYzMubmVnKEsuc29sdmUzMyhDKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBpbXB1bHNlMiA9IFZlYzIubmVnKEsuc29sdmUyMihDMSkpO1xuICAgICAgICAgICAgaW1wdWxzZS5zZXQoaW1wdWxzZTIueCwgaW1wdWxzZTIueSwgMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVvKGltcHVsc2UueCwgaW1wdWxzZS55KTtcbiAgICAgICAgICBjQTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgYUEgLT0gaUEgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgUDMpICsgaW1wdWxzZS56KTtcbiAgICAgICAgICBjQjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgYUIgKz0gaUIgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgUDMpICsgaW1wdWxzZS56KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jID0gY0EyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hID0gYUE7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmMgPSBjQjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmEgPSBhQjtcbiAgICAgICAgcmV0dXJuIHBvc2l0aW9uRXJyb3IgPD0gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wICYmIGFuZ3VsYXJFcnJvciA8PSBTZXR0aW5nc0ludGVybmFsLmFuZ3VsYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIuVFlQRSA9IFwid2VsZC1qb2ludFwiO1xuICAgICAgcmV0dXJuIFdlbGRKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIG1hdGhfYWJzID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX1BJID0gTWF0aC5QSTtcbiAgdmFyIERFRkFVTFRTID0ge1xuICAgIGVuYWJsZU1vdG9yOiBmYWxzZSxcbiAgICBtYXhNb3RvclRvcnF1ZTogMCxcbiAgICBtb3RvclNwZWVkOiAwLFxuICAgIGZyZXF1ZW5jeUh6OiAyLFxuICAgIGRhbXBpbmdSYXRpbzogMC43XG4gIH07XG4gIHZhciBXaGVlbEpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhXaGVlbEpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIFdoZWVsSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IsIGF4aXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBXaGVlbEpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFdoZWVsSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IsIGF4aXMpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX2F4ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fYXkgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV90eXBlID0gV2hlZWxKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIGlmIChWZWMyLmlzVmFsaWQoYXhpcykpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsWEF4aXNBID0gYm9keUEuZ2V0TG9jYWxWZWN0b3IoYXhpcyk7XG4gICAgICAgIH0gZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5sb2NhbEF4aXNBKSkge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxYQXhpc0EgPSBWZWMyLmNsb25lKGRlZi5sb2NhbEF4aXNBKTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmLmxvY2FsQXhpcykpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsWEF4aXNBID0gVmVjMi5jbG9uZShkZWYubG9jYWxBeGlzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsWEF4aXNBID0gVmVjMi5uZW8oMSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMubV9sb2NhbFlBeGlzQSA9IFZlYzIuY3Jvc3NOdW1WZWMyKDEsIF90aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICBfdGhpcy5tX21hc3MgPSAwO1xuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX21vdG9yTWFzcyA9IDA7XG4gICAgICAgIF90aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgX3RoaXMubV9zcHJpbmdNYXNzID0gMDtcbiAgICAgICAgX3RoaXMubV9zcHJpbmdJbXB1bHNlID0gMDtcbiAgICAgICAgX3RoaXMubV9tYXhNb3RvclRvcnF1ZSA9IGRlZi5tYXhNb3RvclRvcnF1ZTtcbiAgICAgICAgX3RoaXMubV9tb3RvclNwZWVkID0gZGVmLm1vdG9yU3BlZWQ7XG4gICAgICAgIF90aGlzLm1fZW5hYmxlTW90b3IgPSBkZWYuZW5hYmxlTW90b3I7XG4gICAgICAgIF90aGlzLm1fZnJlcXVlbmN5SHogPSBkZWYuZnJlcXVlbmN5SHo7XG4gICAgICAgIF90aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgX3RoaXMubV9iaWFzID0gMDtcbiAgICAgICAgX3RoaXMubV9nYW1tYSA9IDA7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGVuYWJsZU1vdG9yOiB0aGlzLm1fZW5hYmxlTW90b3IsXG4gICAgICAgICAgbWF4TW90b3JUb3JxdWU6IHRoaXMubV9tYXhNb3RvclRvcnF1ZSxcbiAgICAgICAgICBtb3RvclNwZWVkOiB0aGlzLm1fbW90b3JTcGVlZCxcbiAgICAgICAgICBmcmVxdWVuY3lIejogdGhpcy5tX2ZyZXF1ZW5jeUh6LFxuICAgICAgICAgIGRhbXBpbmdSYXRpbzogdGhpcy5tX2RhbXBpbmdSYXRpbyxcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCLFxuICAgICAgICAgIGxvY2FsQXhpc0E6IHRoaXMubV9sb2NhbFhBeGlzQVxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgV2hlZWxKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMih0aGlzLm1fYm9keUEuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQSkpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5hbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKHRoaXMubV9ib2R5Qi5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JCKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMihkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmxvY2FsQXhpc0EpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxYQXhpc0Euc2V0VmVjMihkZWYubG9jYWxBeGlzQSk7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsWUF4aXNBLnNldFZlYzIoVmVjMi5jcm9zc051bVZlYzIoMSwgZGVmLmxvY2FsQXhpc0EpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmVuYWJsZU1vdG9yICE9PSB2b2lkIDApIHtcbiAgICAgICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBkZWYuZW5hYmxlTW90b3I7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4TW90b3JUb3JxdWUpKSB7XG4gICAgICAgICAgdGhpcy5tX21heE1vdG9yVG9ycXVlID0gZGVmLm1heE1vdG9yVG9ycXVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1vdG9yU3BlZWQpKSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5mcmVxdWVuY3lIeikpIHtcbiAgICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBkZWYuZnJlcXVlbmN5SHo7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZGFtcGluZ1JhdGlvKSkge1xuICAgICAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JCO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEF4aXNBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxYQXhpc0E7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldEpvaW50VHJhbnNsYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICAgIHZhciBwQTIgPSBiQS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgICB2YXIgcEIyID0gYkIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi5zdWIocEIyLCBwQTIpO1xuICAgICAgICB2YXIgYXhpcyA9IGJBLmdldFdvcmxkVmVjdG9yKHRoaXMubV9sb2NhbFhBeGlzQSk7XG4gICAgICAgIHZhciB0cmFuc2xhdGlvbjIgPSBWZWMyLmRvdChkMiwgYXhpcyk7XG4gICAgICAgIHJldHVybiB0cmFuc2xhdGlvbjI7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldEpvaW50U3BlZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgIHJldHVybiB3QiAtIHdBO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5pc01vdG9yRW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZU1vdG9yO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5lbmFibGVNb3RvciA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcgPT0gdGhpcy5tX2VuYWJsZU1vdG9yKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGZsYWc7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLnNldE1vdG9yU3BlZWQgPSBmdW5jdGlvbihzcGVlZCkge1xuICAgICAgICBpZiAoc3BlZWQgPT0gdGhpcy5tX21vdG9yU3BlZWQpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBzcGVlZDtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21vdG9yU3BlZWQ7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLnNldE1heE1vdG9yVG9ycXVlID0gZnVuY3Rpb24odG9ycXVlKSB7XG4gICAgICAgIGlmICh0b3JxdWUgPT0gdGhpcy5tX21heE1vdG9yVG9ycXVlKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9tYXhNb3RvclRvcnF1ZSA9IHRvcnF1ZTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0TWF4TW90b3JUb3JxdWUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhNb3RvclRvcnF1ZTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0TW90b3JUb3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLnNldFNwcmluZ0ZyZXF1ZW5jeUh6ID0gZnVuY3Rpb24oaHopIHtcbiAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gaHo7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldFNwcmluZ0ZyZXF1ZW5jeUh6ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLnNldFNwcmluZ0RhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uKHJhdGlvKSB7XG4gICAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSByYXRpbztcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0U3ByaW5nRGFtcGluZ1JhdGlvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZGFtcGluZ1JhdGlvO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIuY29tYmluZSh0aGlzLm1faW1wdWxzZSwgdGhpcy5tX2F5LCB0aGlzLm1fc3ByaW5nSW1wdWxzZSwgdGhpcy5tX2F4KS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuemVybygpO1xuICAgICAgICBkMi5hZGRDb21iaW5lKDEsIGNCMiwgMSwgckIyKTtcbiAgICAgICAgZDIuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHJBMik7XG4gICAgICAgIHtcbiAgICAgICAgICB0aGlzLm1fYXkgPSBSb3QubXVsVmVjMihxQSwgdGhpcy5tX2xvY2FsWUF4aXNBKTtcbiAgICAgICAgICB0aGlzLm1fc0F5ID0gVmVjMi5jcm9zc1ZlYzJWZWMyKFZlYzIuYWRkKGQyLCByQTIpLCB0aGlzLm1fYXkpO1xuICAgICAgICAgIHRoaXMubV9zQnkgPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB0aGlzLm1fYXkpO1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gbUEgKyBtQiArIGlBICogdGhpcy5tX3NBeSAqIHRoaXMubV9zQXkgKyBpQiAqIHRoaXMubV9zQnkgKiB0aGlzLm1fc0J5O1xuICAgICAgICAgIGlmICh0aGlzLm1fbWFzcyA+IDApIHtcbiAgICAgICAgICAgIHRoaXMubV9tYXNzID0gMSAvIHRoaXMubV9tYXNzO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fc3ByaW5nTWFzcyA9IDA7XG4gICAgICAgIHRoaXMubV9iaWFzID0gMDtcbiAgICAgICAgdGhpcy5tX2dhbW1hID0gMDtcbiAgICAgICAgaWYgKHRoaXMubV9mcmVxdWVuY3lIeiA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fYXggPSBSb3QubXVsVmVjMihxQSwgdGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgICB0aGlzLm1fc0F4ID0gVmVjMi5jcm9zc1ZlYzJWZWMyKFZlYzIuYWRkKGQyLCByQTIpLCB0aGlzLm1fYXgpO1xuICAgICAgICAgIHRoaXMubV9zQnggPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB0aGlzLm1fYXgpO1xuICAgICAgICAgIHZhciBpbnZNYXNzID0gbUEgKyBtQiArIGlBICogdGhpcy5tX3NBeCAqIHRoaXMubV9zQXggKyBpQiAqIHRoaXMubV9zQnggKiB0aGlzLm1fc0J4O1xuICAgICAgICAgIGlmIChpbnZNYXNzID4gMCkge1xuICAgICAgICAgICAgdGhpcy5tX3NwcmluZ01hc3MgPSAxIC8gaW52TWFzcztcbiAgICAgICAgICAgIHZhciBDID0gVmVjMi5kb3QoZDIsIHRoaXMubV9heCk7XG4gICAgICAgICAgICB2YXIgb21lZ2EgPSAyICogbWF0aF9QSSAqIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgICAgICAgIHZhciBkYW1wID0gMiAqIHRoaXMubV9zcHJpbmdNYXNzICogdGhpcy5tX2RhbXBpbmdSYXRpbyAqIG9tZWdhO1xuICAgICAgICAgICAgdmFyIGsgPSB0aGlzLm1fc3ByaW5nTWFzcyAqIG9tZWdhICogb21lZ2E7XG4gICAgICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSBoICogKGRhbXAgKyBoICogayk7XG4gICAgICAgICAgICBpZiAodGhpcy5tX2dhbW1hID4gMCkge1xuICAgICAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSAxIC8gdGhpcy5tX2dhbW1hO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tX2JpYXMgPSBDICogaCAqIGsgKiB0aGlzLm1fZ2FtbWE7XG4gICAgICAgICAgICB0aGlzLm1fc3ByaW5nTWFzcyA9IGludk1hc3MgKyB0aGlzLm1fZ2FtbWE7XG4gICAgICAgICAgICBpZiAodGhpcy5tX3NwcmluZ01hc3MgPiAwKSB7XG4gICAgICAgICAgICAgIHRoaXMubV9zcHJpbmdNYXNzID0gMSAvIHRoaXMubV9zcHJpbmdNYXNzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fc3ByaW5nSW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVNb3Rvcikge1xuICAgICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSBpQSArIGlCO1xuICAgICAgICAgIGlmICh0aGlzLm1fbW90b3JNYXNzID4gMCkge1xuICAgICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IDEgLyB0aGlzLm1fbW90b3JNYXNzO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gMDtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdGhpcy5tX3NwcmluZ0ltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIuY29tYmluZSh0aGlzLm1faW1wdWxzZSwgdGhpcy5tX2F5LCB0aGlzLm1fc3ByaW5nSW1wdWxzZSwgdGhpcy5tX2F4KTtcbiAgICAgICAgICB2YXIgTEEgPSB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9zQXkgKyB0aGlzLm1fc3ByaW5nSW1wdWxzZSAqIHRoaXMubV9zQXggKyB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgICAgIHZhciBMQiA9IHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3NCeSArIHRoaXMubV9zcHJpbmdJbXB1bHNlICogdGhpcy5tX3NCeCArIHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICAgICAgdkEyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgICB3QSAtPSB0aGlzLm1faW52SUEgKiBMQTtcbiAgICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIExCO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgICB0aGlzLm1fc3ByaW5nSW1wdWxzZSA9IDA7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAge1xuICAgICAgICAgIHZhciBDZG90ID0gVmVjMi5kb3QodGhpcy5tX2F4LCB2QjIpIC0gVmVjMi5kb3QodGhpcy5tX2F4LCB2QTIpICsgdGhpcy5tX3NCeCAqIHdCIC0gdGhpcy5tX3NBeCAqIHdBO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9zcHJpbmdNYXNzICogKENkb3QgKyB0aGlzLm1fYmlhcyArIHRoaXMubV9nYW1tYSAqIHRoaXMubV9zcHJpbmdJbXB1bHNlKTtcbiAgICAgICAgICB0aGlzLm1fc3ByaW5nSW1wdWxzZSArPSBpbXB1bHNlO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihpbXB1bHNlLCB0aGlzLm1fYXgpO1xuICAgICAgICAgIHZhciBMQSA9IGltcHVsc2UgKiB0aGlzLm1fc0F4O1xuICAgICAgICAgIHZhciBMQiA9IGltcHVsc2UgKiB0aGlzLm1fc0J4O1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIExBO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIExCO1xuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IHdCIC0gd0EgLSB0aGlzLm1fbW90b3JTcGVlZDtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbW90b3JNYXNzICogQ2RvdDtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heE1vdG9yVG9ycXVlO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSBjbGFtcCh0aGlzLm1fbW90b3JJbXB1bHNlICsgaW1wdWxzZSwgLW1heEltcHVsc2UsIG1heEltcHVsc2UpO1xuICAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2U7XG4gICAgICAgICAgd0IgKz0gaUIgKiBpbXB1bHNlO1xuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuZG90KHRoaXMubV9heSwgdkIyKSAtIFZlYzIuZG90KHRoaXMubV9heSwgdkEyKSArIHRoaXMubV9zQnkgKiB3QiAtIHRoaXMubV9zQXkgKiB3QTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbWFzcyAqIENkb3Q7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgKz0gaW1wdWxzZTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoaW1wdWxzZSwgdGhpcy5tX2F5KTtcbiAgICAgICAgICB2YXIgTEEgPSBpbXB1bHNlICogdGhpcy5tX3NBeTtcbiAgICAgICAgICB2YXIgTEIgPSBpbXB1bHNlICogdGhpcy5tX3NCeTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBMQTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBMQjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52LnNldFZlYzIodkEyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuemVybygpO1xuICAgICAgICBkMi5hZGRDb21iaW5lKDEsIGNCMiwgMSwgckIyKTtcbiAgICAgICAgZDIuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHJBMik7XG4gICAgICAgIHZhciBheSA9IFJvdC5tdWxWZWMyKHFBLCB0aGlzLm1fbG9jYWxZQXhpc0EpO1xuICAgICAgICB2YXIgc0F5ID0gVmVjMi5jcm9zc1ZlYzJWZWMyKFZlYzIuYWRkKGQyLCByQTIpLCBheSk7XG4gICAgICAgIHZhciBzQnkgPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBheSk7XG4gICAgICAgIHZhciBDID0gVmVjMi5kb3QoZDIsIGF5KTtcbiAgICAgICAgdmFyIGsgPSB0aGlzLm1faW52TWFzc0EgKyB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUEgKiB0aGlzLm1fc0F5ICogdGhpcy5tX3NBeSArIHRoaXMubV9pbnZJQiAqIHRoaXMubV9zQnkgKiB0aGlzLm1fc0J5O1xuICAgICAgICB2YXIgaW1wdWxzZSA9IGsgIT0gMCA/IC1DIC8gayA6IDA7XG4gICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihpbXB1bHNlLCBheSk7XG4gICAgICAgIHZhciBMQSA9IGltcHVsc2UgKiBzQXk7XG4gICAgICAgIHZhciBMQiA9IGltcHVsc2UgKiBzQnk7XG4gICAgICAgIGNBMi5zdWJNdWwodGhpcy5tX2ludk1hc3NBLCBQMyk7XG4gICAgICAgIGFBIC09IHRoaXMubV9pbnZJQSAqIExBO1xuICAgICAgICBjQjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICBhQiArPSB0aGlzLm1faW52SUIgKiBMQjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmEgPSBhQTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmEgPSBhQjtcbiAgICAgICAgcmV0dXJuIG1hdGhfYWJzKEMpIDw9IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5UWVBFID0gXCJ3aGVlbC1qb2ludFwiO1xuICAgICAgcmV0dXJuIFdoZWVsSm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBfYTtcbiAgdmFyIFNJRCA9IDA7XG4gIHZhciBTRVJJQUxJWkVfUkVGX1RZUEVTID0ge1xuICAgIFwiV29ybGRcIjogV29ybGQsXG4gICAgXCJCb2R5XCI6IEJvZHksXG4gICAgXCJKb2ludFwiOiBKb2ludCxcbiAgICBcIkZpeHR1cmVcIjogRml4dHVyZSxcbiAgICBcIlNoYXBlXCI6IFNoYXBlXG4gIH07XG4gIHZhciBERVNFUklBTElaRV9CWV9SRUZfVFlQRSA9IHtcbiAgICBcIlZlYzJcIjogVmVjMixcbiAgICBcIlZlYzNcIjogVmVjMyxcbiAgICBcIldvcmxkXCI6IFdvcmxkLFxuICAgIFwiQm9keVwiOiBCb2R5LFxuICAgIFwiSm9pbnRcIjogSm9pbnQsXG4gICAgXCJGaXh0dXJlXCI6IEZpeHR1cmUsXG4gICAgXCJTaGFwZVwiOiBTaGFwZVxuICB9O1xuICB2YXIgREVTRVJJQUxJWkVfQllfVFlQRV9GSUVMRCA9IChfYSA9IHt9LCBfYVtCb2R5LlNUQVRJQ10gPSBCb2R5LCBfYVtCb2R5LkRZTkFNSUNdID0gQm9keSwgX2FbQm9keS5LSU5FTUFUSUNdID0gQm9keSwgX2FbQ2hhaW5TaGFwZS5UWVBFXSA9IENoYWluU2hhcGUsIC8vIFtCb3hTaGFwZS5UWVBFXTogQm94U2hhcGUsXG4gIF9hW1BvbHlnb25TaGFwZS5UWVBFXSA9IFBvbHlnb25TaGFwZSwgX2FbRWRnZVNoYXBlLlRZUEVdID0gRWRnZVNoYXBlLCBfYVtDaXJjbGVTaGFwZS5UWVBFXSA9IENpcmNsZVNoYXBlLCBfYVtEaXN0YW5jZUpvaW50LlRZUEVdID0gRGlzdGFuY2VKb2ludCwgX2FbRnJpY3Rpb25Kb2ludC5UWVBFXSA9IEZyaWN0aW9uSm9pbnQsIF9hW0dlYXJKb2ludC5UWVBFXSA9IEdlYXJKb2ludCwgX2FbTW90b3JKb2ludC5UWVBFXSA9IE1vdG9ySm9pbnQsIF9hW01vdXNlSm9pbnQuVFlQRV0gPSBNb3VzZUpvaW50LCBfYVtQcmlzbWF0aWNKb2ludC5UWVBFXSA9IFByaXNtYXRpY0pvaW50LCBfYVtQdWxsZXlKb2ludC5UWVBFXSA9IFB1bGxleUpvaW50LCBfYVtSZXZvbHV0ZUpvaW50LlRZUEVdID0gUmV2b2x1dGVKb2ludCwgX2FbUm9wZUpvaW50LlRZUEVdID0gUm9wZUpvaW50LCBfYVtXZWxkSm9pbnQuVFlQRV0gPSBXZWxkSm9pbnQsIF9hW1doZWVsSm9pbnQuVFlQRV0gPSBXaGVlbEpvaW50LCBfYSk7XG4gIHZhciBERUZBVUxUX09QVElPTlMgPSB7XG4gICAgcm9vdENsYXNzOiBXb3JsZCxcbiAgICBwcmVTZXJpYWxpemU6IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIG9iajtcbiAgICB9LFxuICAgIHBvc3RTZXJpYWxpemU6IGZ1bmN0aW9uKGRhdGEsIG9iaikge1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSxcbiAgICBwcmVEZXNlcmlhbGl6ZTogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSxcbiAgICBwb3N0RGVzZXJpYWxpemU6IGZ1bmN0aW9uKG9iaiwgZGF0YSkge1xuICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG4gIH07XG4gIHZhciBTZXJpYWxpemVyID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICAvKiBAX19QVVJFX18gKi8gZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTZXJpYWxpemVyMihvcHRpb25zMikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnRvSnNvbiA9IGZ1bmN0aW9uKHJvb3QpIHtcbiAgICAgICAgICB2YXIgcHJlU2VyaWFsaXplID0gX3RoaXMub3B0aW9ucy5wcmVTZXJpYWxpemU7XG4gICAgICAgICAgdmFyIHBvc3RTZXJpYWxpemUgPSBfdGhpcy5vcHRpb25zLnBvc3RTZXJpYWxpemU7XG4gICAgICAgICAgdmFyIGpzb24gPSBbXTtcbiAgICAgICAgICB2YXIgcmVmUXVldWUgPSBbcm9vdF07XG4gICAgICAgICAgdmFyIHJlZk1lbW9CeUlkID0ge307XG4gICAgICAgICAgZnVuY3Rpb24gYWRkVG9SZWZRdWV1ZSh2YWx1ZSwgdHlwZU5hbWUpIHtcbiAgICAgICAgICAgIHZhbHVlLl9fc2lkID0gdmFsdWUuX19zaWQgfHwgKytTSUQ7XG4gICAgICAgICAgICBpZiAoIXJlZk1lbW9CeUlkW3ZhbHVlLl9fc2lkXSkge1xuICAgICAgICAgICAgICByZWZRdWV1ZS5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgdmFyIGluZGV4ID0ganNvbi5sZW5ndGggKyByZWZRdWV1ZS5sZW5ndGg7XG4gICAgICAgICAgICAgIHZhciByZWYgPSB7XG4gICAgICAgICAgICAgICAgcmVmSW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgICAgIHJlZlR5cGU6IHR5cGVOYW1lXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIHJlZk1lbW9CeUlkW3ZhbHVlLl9fc2lkXSA9IHJlZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZWZNZW1vQnlJZFt2YWx1ZS5fX3NpZF07XG4gICAgICAgICAgfVxuICAgICAgICAgIGZ1bmN0aW9uIHNlcmlhbGl6ZVdpdGhIb29rcyhvYmoyKSB7XG4gICAgICAgICAgICBvYmoyID0gcHJlU2VyaWFsaXplKG9iajIpO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBvYmoyLl9zZXJpYWxpemUoKTtcbiAgICAgICAgICAgIGRhdGEgPSBwb3N0U2VyaWFsaXplKGRhdGEsIG9iajIpO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZ1bmN0aW9uIHRyYXZlcnNlKHZhbHVlLCBub1JlZlR5cGUpIHtcbiAgICAgICAgICAgIGlmIChub1JlZlR5cGUgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICBub1JlZlR5cGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09IFwib2JqZWN0XCIgfHwgdmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZS5fc2VyaWFsaXplID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgaWYgKCFub1JlZlR5cGUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciB0eXBlTmFtZSBpbiBTRVJJQUxJWkVfUkVGX1RZUEVTKSB7XG4gICAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBTRVJJQUxJWkVfUkVGX1RZUEVTW3R5cGVOYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWRkVG9SZWZRdWV1ZSh2YWx1ZSwgdHlwZU5hbWUpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YWx1ZSA9IHNlcmlhbGl6ZVdpdGhIb29rcyh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gW107XG4gICAgICAgICAgICAgIGZvciAodmFyIGtleSA9IDA7IGtleSA8IHZhbHVlLmxlbmd0aDsga2V5KyspIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZVtrZXldID0gdHJhdmVyc2UodmFsdWVba2V5XSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IHt9O1xuICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgbmV3VmFsdWVba2V5XSA9IHRyYXZlcnNlKHZhbHVlW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB3aGlsZSAocmVmUXVldWUubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgb2JqID0gcmVmUXVldWUuc2hpZnQoKTtcbiAgICAgICAgICAgIHZhciBzdHIgPSB0cmF2ZXJzZShvYmosIHRydWUpO1xuICAgICAgICAgICAganNvbi5wdXNoKHN0cik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBqc29uO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmZyb21Kc29uID0gZnVuY3Rpb24oanNvbikge1xuICAgICAgICAgIHZhciBwcmVEZXNlcmlhbGl6ZSA9IF90aGlzLm9wdGlvbnMucHJlRGVzZXJpYWxpemU7XG4gICAgICAgICAgdmFyIHBvc3REZXNlcmlhbGl6ZSA9IF90aGlzLm9wdGlvbnMucG9zdERlc2VyaWFsaXplO1xuICAgICAgICAgIHZhciByb290Q2xhc3MgPSBfdGhpcy5vcHRpb25zLnJvb3RDbGFzcztcbiAgICAgICAgICB2YXIgZGVzZXJpYWxpemVkUmVmTWVtb0J5SW5kZXggPSB7fTtcbiAgICAgICAgICBmdW5jdGlvbiBkZXNlcmlhbGl6ZVdpdGhIb29rcyhjbGFzc0hpbnQsIGRhdGEsIGNvbnRleHQpIHtcbiAgICAgICAgICAgIGlmICghY2xhc3NIaW50IHx8ICFjbGFzc0hpbnQuX2Rlc2VyaWFsaXplKSB7XG4gICAgICAgICAgICAgIGNsYXNzSGludCA9IERFU0VSSUFMSVpFX0JZX1RZUEVfRklFTERbZGF0YS50eXBlXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZXNlcmlhbGl6ZXIgPSBjbGFzc0hpbnQgJiYgY2xhc3NIaW50Ll9kZXNlcmlhbGl6ZTtcbiAgICAgICAgICAgIGlmICghZGVzZXJpYWxpemVyKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRhdGEgPSBwcmVEZXNlcmlhbGl6ZShkYXRhKTtcbiAgICAgICAgICAgIHZhciBjbGFzc0Rlc2VyaWFsaXplRm4gPSBjbGFzc0hpbnQuX2Rlc2VyaWFsaXplO1xuICAgICAgICAgICAgdmFyIG9iaiA9IGNsYXNzRGVzZXJpYWxpemVGbihkYXRhLCBjb250ZXh0LCBkZXNlcmlhbGl6ZUNoaWxkKTtcbiAgICAgICAgICAgIG9iaiA9IHBvc3REZXNlcmlhbGl6ZShvYmosIGRhdGEpO1xuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICB9XG4gICAgICAgICAgZnVuY3Rpb24gZGVzZXJpYWxpemVDaGlsZChjbGFzc0hpbnQsIGRhdGFPclJlZiwgY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIGlzUmVmT2JqZWN0ID0gZGF0YU9yUmVmLnJlZkluZGV4ICYmIGRhdGFPclJlZi5yZWZUeXBlO1xuICAgICAgICAgICAgaWYgKCFpc1JlZk9iamVjdCkge1xuICAgICAgICAgICAgICByZXR1cm4gZGVzZXJpYWxpemVXaXRoSG9va3MoY2xhc3NIaW50LCBkYXRhT3JSZWYsIGNvbnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlZiA9IGRhdGFPclJlZjtcbiAgICAgICAgICAgIGlmIChERVNFUklBTElaRV9CWV9SRUZfVFlQRVtyZWYucmVmVHlwZV0pIHtcbiAgICAgICAgICAgICAgY2xhc3NIaW50ID0gREVTRVJJQUxJWkVfQllfUkVGX1RZUEVbcmVmLnJlZlR5cGVdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlZkluZGV4ID0gcmVmLnJlZkluZGV4O1xuICAgICAgICAgICAgaWYgKCFkZXNlcmlhbGl6ZWRSZWZNZW1vQnlJbmRleFtyZWZJbmRleF0pIHtcbiAgICAgICAgICAgICAgdmFyIGRhdGEgPSBqc29uW3JlZkluZGV4XTtcbiAgICAgICAgICAgICAgdmFyIG9iaiA9IGRlc2VyaWFsaXplV2l0aEhvb2tzKGNsYXNzSGludCwgZGF0YSwgY29udGV4dCk7XG4gICAgICAgICAgICAgIGRlc2VyaWFsaXplZFJlZk1lbW9CeUluZGV4W3JlZkluZGV4XSA9IG9iajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBkZXNlcmlhbGl6ZWRSZWZNZW1vQnlJbmRleFtyZWZJbmRleF07XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciByb290ID0gZGVzZXJpYWxpemVXaXRoSG9va3Mocm9vdENsYXNzLCBqc29uWzBdLCBudWxsKTtcbiAgICAgICAgICByZXR1cm4gcm9vdDtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gX19hc3NpZ24oX19hc3NpZ24oe30sIERFRkFVTFRfT1BUSU9OUyksIG9wdGlvbnMyKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBTZXJpYWxpemVyMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIHdvcmxkU2VyaWFsaXplciA9IG5ldyBTZXJpYWxpemVyKHtcbiAgICByb290Q2xhc3M6IFdvcmxkXG4gIH0pO1xuICBTZXJpYWxpemVyLmZyb21Kc29uID0gd29ybGRTZXJpYWxpemVyLmZyb21Kc29uO1xuICBTZXJpYWxpemVyLnRvSnNvbiA9IHdvcmxkU2VyaWFsaXplci50b0pzb247XG4gIHZhciBUZXN0YmVkID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFRlc3RiZWQyKCkge1xuICAgICAgfVxuICAgICAgVGVzdGJlZDIubW91bnQgPSBmdW5jdGlvbihvcHRpb25zMikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50ZWRcIik7XG4gICAgICB9O1xuICAgICAgVGVzdGJlZDIuc3RhcnQgPSBmdW5jdGlvbih3b3JsZCkge1xuICAgICAgICB2YXIgdGVzdGJlZDIgPSBUZXN0YmVkMi5tb3VudCgpO1xuICAgICAgICB0ZXN0YmVkMi5zdGFydCh3b3JsZCk7XG4gICAgICAgIHJldHVybiB0ZXN0YmVkMjtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVGVzdGJlZDI7XG4gICAgfSgpXG4gICk7XG4gIGZ1bmN0aW9uIHRlc3RiZWQoYTIsIGIyKSB7XG4gICAgdmFyIGNhbGxiYWNrO1xuICAgIHZhciBvcHRpb25zMjtcbiAgICBpZiAodHlwZW9mIGEyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGNhbGxiYWNrID0gYTI7XG4gICAgICBvcHRpb25zMiA9IGIyO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGIyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGNhbGxiYWNrID0gYjI7XG4gICAgICBvcHRpb25zMiA9IGEyO1xuICAgIH0gZWxzZSB7XG4gICAgICBvcHRpb25zMiA9IGEyICE9PSBudWxsICYmIGEyICE9PSB2b2lkIDAgPyBhMiA6IGIyO1xuICAgIH1cbiAgICB2YXIgdGVzdGJlZDIgPSBUZXN0YmVkLm1vdW50KG9wdGlvbnMyKTtcbiAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgIHZhciB3b3JsZCA9IGNhbGxiYWNrKHRlc3RiZWQyKSB8fCB0ZXN0YmVkMi53b3JsZDtcbiAgICAgIHRlc3RiZWQyLnN0YXJ0KHdvcmxkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRlc3RiZWQyO1xuICAgIH1cbiAgfVxuICB2YXIgQm94U2hhcGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKEJveFNoYXBlMiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIEJveFNoYXBlMihoYWxmV2lkdGgsIGhhbGZIZWlnaHQsIGNlbnRlcjIsIGFuZ2xlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgQm94U2hhcGUyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgQm94U2hhcGUyKGhhbGZXaWR0aCwgaGFsZkhlaWdodCwgY2VudGVyMiwgYW5nbGUpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3NldEFzQm94KGhhbGZXaWR0aCwgaGFsZkhlaWdodCwgY2VudGVyMiwgYW5nbGUpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBCb3hTaGFwZTIuVFlQRSA9IFwicG9seWdvblwiO1xuICAgICAgcmV0dXJuIEJveFNoYXBlMjtcbiAgICB9KFBvbHlnb25TaGFwZSlcbiAgKTtcbiAgQ29udGFjdC5hZGRUeXBlKENpcmNsZVNoYXBlLlRZUEUsIENpcmNsZVNoYXBlLlRZUEUsIENpcmNsZUNpcmNsZUNvbnRhY3QpO1xuICBmdW5jdGlvbiBDaXJjbGVDaXJjbGVDb250YWN0KG1hbmlmb2xkLCB4ZkEyLCBmaXh0dXJlQSwgaW5kZXhBLCB4ZkIyLCBmaXh0dXJlQiwgaW5kZXhCKSB7XG4gICAgQ29sbGlkZUNpcmNsZXMobWFuaWZvbGQsIGZpeHR1cmVBLmdldFNoYXBlKCksIHhmQTIsIGZpeHR1cmVCLmdldFNoYXBlKCksIHhmQjIpO1xuICB9XG4gIHZhciBwQSA9IHZlYzIoMCwgMCk7XG4gIHZhciBwQiA9IHZlYzIoMCwgMCk7XG4gIHZhciBDb2xsaWRlQ2lyY2xlcyA9IGZ1bmN0aW9uKG1hbmlmb2xkLCBjaXJjbGVBLCB4ZkEyLCBjaXJjbGVCLCB4ZkIyKSB7XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDA7XG4gICAgdHJhbnNmb3JtVmVjMihwQSwgeGZBMiwgY2lyY2xlQS5tX3ApO1xuICAgIHRyYW5zZm9ybVZlYzIocEIsIHhmQjIsIGNpcmNsZUIubV9wKTtcbiAgICB2YXIgZGlzdFNxciA9IGRpc3RTcXJWZWMyKHBCLCBwQSk7XG4gICAgdmFyIHJBMiA9IGNpcmNsZUEubV9yYWRpdXM7XG4gICAgdmFyIHJCMiA9IGNpcmNsZUIubV9yYWRpdXM7XG4gICAgdmFyIHJhZGl1cyA9IHJBMiArIHJCMjtcbiAgICBpZiAoZGlzdFNxciA+IHJhZGl1cyAqIHJhZGl1cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfY2lyY2xlcztcbiAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCBjaXJjbGVBLm1fcCk7XG4gICAgemVyb1ZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwpO1xuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLnBvaW50c1swXS5sb2NhbFBvaW50LCBjaXJjbGVCLm1fcCk7XG4gICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgfTtcbiAgQ29udGFjdC5hZGRUeXBlKEVkZ2VTaGFwZS5UWVBFLCBDaXJjbGVTaGFwZS5UWVBFLCBFZGdlQ2lyY2xlQ29udGFjdCk7XG4gIENvbnRhY3QuYWRkVHlwZShDaGFpblNoYXBlLlRZUEUsIENpcmNsZVNoYXBlLlRZUEUsIENoYWluQ2lyY2xlQ29udGFjdCk7XG4gIGZ1bmN0aW9uIEVkZ2VDaXJjbGVDb250YWN0KG1hbmlmb2xkLCB4ZkEyLCBmaXh0dXJlQSwgaW5kZXhBLCB4ZkIyLCBmaXh0dXJlQiwgaW5kZXhCKSB7XG4gICAgdmFyIHNoYXBlQSA9IGZpeHR1cmVBLmdldFNoYXBlKCk7XG4gICAgdmFyIHNoYXBlQiA9IGZpeHR1cmVCLmdldFNoYXBlKCk7XG4gICAgQ29sbGlkZUVkZ2VDaXJjbGUobWFuaWZvbGQsIHNoYXBlQSwgeGZBMiwgc2hhcGVCLCB4ZkIyKTtcbiAgfVxuICBmdW5jdGlvbiBDaGFpbkNpcmNsZUNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZpeHR1cmVBLCBpbmRleEEsIHhmQjIsIGZpeHR1cmVCLCBpbmRleEIpIHtcbiAgICB2YXIgY2hhaW4gPSBmaXh0dXJlQS5nZXRTaGFwZSgpO1xuICAgIHZhciBlZGdlID0gbmV3IEVkZ2VTaGFwZSgpO1xuICAgIGNoYWluLmdldENoaWxkRWRnZShlZGdlLCBpbmRleEEpO1xuICAgIHZhciBzaGFwZUEgPSBlZGdlO1xuICAgIHZhciBzaGFwZUIgPSBmaXh0dXJlQi5nZXRTaGFwZSgpO1xuICAgIENvbGxpZGVFZGdlQ2lyY2xlKG1hbmlmb2xkLCBzaGFwZUEsIHhmQTIsIHNoYXBlQiwgeGZCMik7XG4gIH1cbiAgdmFyIGUgPSB2ZWMyKDAsIDApO1xuICB2YXIgZTEgPSB2ZWMyKDAsIDApO1xuICB2YXIgZTIgPSB2ZWMyKDAsIDApO1xuICB2YXIgUSA9IHZlYzIoMCwgMCk7XG4gIHZhciBQID0gdmVjMigwLCAwKTtcbiAgdmFyIG4kMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBDb2xsaWRlRWRnZUNpcmNsZSA9IGZ1bmN0aW9uKG1hbmlmb2xkLCBlZGdlQSwgeGZBMiwgY2lyY2xlQiwgeGZCMikge1xuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAwO1xuICAgIHJldHJhbnNmb3JtVmVjMihRLCB4ZkIyLCB4ZkEyLCBjaXJjbGVCLm1fcCk7XG4gICAgdmFyIEEgPSBlZGdlQS5tX3ZlcnRleDE7XG4gICAgdmFyIEIgPSBlZGdlQS5tX3ZlcnRleDI7XG4gICAgc3ViVmVjMihlLCBCLCBBKTtcbiAgICB2YXIgdSA9IGRvdFZlYzIoZSwgQikgLSBkb3RWZWMyKGUsIFEpO1xuICAgIHZhciB2MyA9IGRvdFZlYzIoZSwgUSkgLSBkb3RWZWMyKGUsIEEpO1xuICAgIHZhciByYWRpdXMgPSBlZGdlQS5tX3JhZGl1cyArIGNpcmNsZUIubV9yYWRpdXM7XG4gICAgaWYgKHYzIDw9IDApIHtcbiAgICAgIGNvcHlWZWMyKFAsIEEpO1xuICAgICAgdmFyIGRkXzEgPSBkaXN0U3FyVmVjMihRLCBBKTtcbiAgICAgIGlmIChkZF8xID4gcmFkaXVzICogcmFkaXVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChlZGdlQS5tX2hhc1ZlcnRleDApIHtcbiAgICAgICAgdmFyIEExID0gZWRnZUEubV92ZXJ0ZXgwO1xuICAgICAgICB2YXIgQjEgPSBBO1xuICAgICAgICBzdWJWZWMyKGUxLCBCMSwgQTEpO1xuICAgICAgICB2YXIgdTEgPSBkb3RWZWMyKGUxLCBCMSkgLSBkb3RWZWMyKGUxLCBRKTtcbiAgICAgICAgaWYgKHUxID4gMCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2NpcmNsZXM7XG4gICAgICB6ZXJvVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCk7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCBQKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh1IDw9IDApIHtcbiAgICAgIGNvcHlWZWMyKFAsIEIpO1xuICAgICAgdmFyIGRkXzIgPSBkaXN0U3FyVmVjMihRLCBQKTtcbiAgICAgIGlmIChkZF8yID4gcmFkaXVzICogcmFkaXVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChlZGdlQS5tX2hhc1ZlcnRleDMpIHtcbiAgICAgICAgdmFyIEIyID0gZWRnZUEubV92ZXJ0ZXgzO1xuICAgICAgICB2YXIgQTIgPSBCO1xuICAgICAgICBzdWJWZWMyKGUyLCBCMiwgQTIpO1xuICAgICAgICB2YXIgdjIyID0gZG90VmVjMihlMiwgUSkgLSBkb3RWZWMyKGUyLCBBMik7XG4gICAgICAgIGlmICh2MjIgPiAwKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfY2lyY2xlcztcbiAgICAgIHplcm9WZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIFApO1xuICAgICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDE7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5wb2ludHNbMF0ubG9jYWxQb2ludCwgY2lyY2xlQi5tX3ApO1xuICAgICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDEsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGRlbiA9IGxlbmd0aFNxclZlYzIoZSk7XG4gICAgY29tYmluZTJWZWMyKFAsIHUgLyBkZW4sIEEsIHYzIC8gZGVuLCBCKTtcbiAgICB2YXIgZGQgPSBkaXN0U3FyVmVjMihRLCBQKTtcbiAgICBpZiAoZGQgPiByYWRpdXMgKiByYWRpdXMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY3Jvc3NOdW1WZWMyKG4kMiwgMSwgZSk7XG4gICAgaWYgKGRvdFZlYzIobiQyLCBRKSAtIGRvdFZlYzIobiQyLCBBKSA8IDApIHtcbiAgICAgIG5lZ1ZlYzIobiQyKTtcbiAgICB9XG4gICAgbm9ybWFsaXplVmVjMihuJDIpO1xuICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQTtcbiAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgbiQyKTtcbiAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCBBKTtcbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMTtcbiAgICBjb3B5VmVjMihtYW5pZm9sZC5wb2ludHNbMF0ubG9jYWxQb2ludCwgY2lyY2xlQi5tX3ApO1xuICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV9mYWNlLCAwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICB9O1xuICB2YXIgaW5jaWRlbnRFZGdlID0gW25ldyBDbGlwVmVydGV4KCksIG5ldyBDbGlwVmVydGV4KCldO1xuICB2YXIgY2xpcFBvaW50czEkMSA9IFtuZXcgQ2xpcFZlcnRleCgpLCBuZXcgQ2xpcFZlcnRleCgpXTtcbiAgdmFyIGNsaXBQb2ludHMyJDEgPSBbbmV3IENsaXBWZXJ0ZXgoKSwgbmV3IENsaXBWZXJ0ZXgoKV07XG4gIHZhciBjbGlwU2VnbWVudFRvTGluZU5vcm1hbCA9IHZlYzIoMCwgMCk7XG4gIHZhciB2MSA9IHZlYzIoMCwgMCk7XG4gIHZhciBuJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgeGYkMSA9IHRyYW5zZm9ybSgwLCAwLCAwKTtcbiAgdmFyIHYxMSA9IHZlYzIoMCwgMCk7XG4gIHZhciB2MTIgPSB2ZWMyKDAsIDApO1xuICB2YXIgbG9jYWxUYW5nZW50ID0gdmVjMigwLCAwKTtcbiAgdmFyIGxvY2FsTm9ybWFsID0gdmVjMigwLCAwKTtcbiAgdmFyIHBsYW5lUG9pbnQgPSB2ZWMyKDAsIDApO1xuICB2YXIgdGFuZ2VudCA9IHZlYzIoMCwgMCk7XG4gIHZhciBub3JtYWwkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBub3JtYWwxJDEgPSB2ZWMyKDAsIDApO1xuICBDb250YWN0LmFkZFR5cGUoUG9seWdvblNoYXBlLlRZUEUsIFBvbHlnb25TaGFwZS5UWVBFLCBQb2x5Z29uQ29udGFjdCk7XG4gIGZ1bmN0aW9uIFBvbHlnb25Db250YWN0KG1hbmlmb2xkLCB4ZkEyLCBmaXh0dXJlQSwgaW5kZXhBLCB4ZkIyLCBmaXh0dXJlQiwgaW5kZXhCKSB7XG4gICAgQ29sbGlkZVBvbHlnb25zKG1hbmlmb2xkLCBmaXh0dXJlQS5nZXRTaGFwZSgpLCB4ZkEyLCBmaXh0dXJlQi5nZXRTaGFwZSgpLCB4ZkIyKTtcbiAgfVxuICBmdW5jdGlvbiBmaW5kTWF4U2VwYXJhdGlvbihwb2x5MSwgeGYxLCBwb2x5MiwgeGYyLCBvdXRwdXQyKSB7XG4gICAgdmFyIGNvdW50MSA9IHBvbHkxLm1fY291bnQ7XG4gICAgdmFyIGNvdW50MiA9IHBvbHkyLm1fY291bnQ7XG4gICAgdmFyIG4xcyA9IHBvbHkxLm1fbm9ybWFscztcbiAgICB2YXIgdjFzID0gcG9seTEubV92ZXJ0aWNlcztcbiAgICB2YXIgdjJzID0gcG9seTIubV92ZXJ0aWNlcztcbiAgICBkZXRyYW5zZm9ybVRyYW5zZm9ybSh4ZiQxLCB4ZjIsIHhmMSk7XG4gICAgdmFyIGJlc3RJbmRleCA9IDA7XG4gICAgdmFyIG1heFNlcGFyYXRpb24yID0gLUluZmluaXR5O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQxOyArK2kpIHtcbiAgICAgIHJvdFZlYzIobiQxLCB4ZiQxLnEsIG4xc1tpXSk7XG4gICAgICB0cmFuc2Zvcm1WZWMyKHYxLCB4ZiQxLCB2MXNbaV0pO1xuICAgICAgdmFyIHNpID0gSW5maW5pdHk7XG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNvdW50MjsgKytqKSB7XG4gICAgICAgIHZhciBzaWogPSBkb3RWZWMyKG4kMSwgdjJzW2pdKSAtIGRvdFZlYzIobiQxLCB2MSk7XG4gICAgICAgIGlmIChzaWogPCBzaSkge1xuICAgICAgICAgIHNpID0gc2lqO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoc2kgPiBtYXhTZXBhcmF0aW9uMikge1xuICAgICAgICBtYXhTZXBhcmF0aW9uMiA9IHNpO1xuICAgICAgICBiZXN0SW5kZXggPSBpO1xuICAgICAgfVxuICAgIH1cbiAgICBvdXRwdXQyLm1heFNlcGFyYXRpb24gPSBtYXhTZXBhcmF0aW9uMjtcbiAgICBvdXRwdXQyLmJlc3RJbmRleCA9IGJlc3RJbmRleDtcbiAgfVxuICBmdW5jdGlvbiBmaW5kSW5jaWRlbnRFZGdlKGNsaXBWZXJ0ZXgsIHBvbHkxLCB4ZjEsIGVkZ2UxMiwgcG9seTIsIHhmMikge1xuICAgIHZhciBub3JtYWxzMSA9IHBvbHkxLm1fbm9ybWFscztcbiAgICB2YXIgY291bnQyID0gcG9seTIubV9jb3VudDtcbiAgICB2YXIgdmVydGljZXMyID0gcG9seTIubV92ZXJ0aWNlcztcbiAgICB2YXIgbm9ybWFsczIgPSBwb2x5Mi5tX25vcm1hbHM7XG4gICAgcmVyb3RWZWMyKG5vcm1hbDEkMSwgeGYyLnEsIHhmMS5xLCBub3JtYWxzMVtlZGdlMTJdKTtcbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHZhciBtaW5Eb3QgPSBJbmZpbml0eTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50MjsgKytpKSB7XG4gICAgICB2YXIgZG90ID0gZG90VmVjMihub3JtYWwxJDEsIG5vcm1hbHMyW2ldKTtcbiAgICAgIGlmIChkb3QgPCBtaW5Eb3QpIHtcbiAgICAgICAgbWluRG90ID0gZG90O1xuICAgICAgICBpbmRleCA9IGk7XG4gICAgICB9XG4gICAgfVxuICAgIHZhciBpMSA9IGluZGV4O1xuICAgIHZhciBpMiA9IGkxICsgMSA8IGNvdW50MiA/IGkxICsgMSA6IDA7XG4gICAgdHJhbnNmb3JtVmVjMihjbGlwVmVydGV4WzBdLnYsIHhmMiwgdmVydGljZXMyW2kxXSk7XG4gICAgY2xpcFZlcnRleFswXS5pZC5zZXRGZWF0dXJlcyhlZGdlMTIsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UsIGkxLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICAgIHRyYW5zZm9ybVZlYzIoY2xpcFZlcnRleFsxXS52LCB4ZjIsIHZlcnRpY2VzMltpMl0pO1xuICAgIGNsaXBWZXJ0ZXhbMV0uaWQuc2V0RmVhdHVyZXMoZWRnZTEyLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV9mYWNlLCBpMiwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgfVxuICB2YXIgbWF4U2VwYXJhdGlvbiA9IHtcbiAgICBtYXhTZXBhcmF0aW9uOiAwLFxuICAgIGJlc3RJbmRleDogMFxuICB9O1xuICB2YXIgQ29sbGlkZVBvbHlnb25zID0gZnVuY3Rpb24obWFuaWZvbGQsIHBvbHlBLCB4ZkEyLCBwb2x5QiwgeGZCMikge1xuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAwO1xuICAgIHZhciB0b3RhbFJhZGl1cyA9IHBvbHlBLm1fcmFkaXVzICsgcG9seUIubV9yYWRpdXM7XG4gICAgZmluZE1heFNlcGFyYXRpb24ocG9seUEsIHhmQTIsIHBvbHlCLCB4ZkIyLCBtYXhTZXBhcmF0aW9uKTtcbiAgICB2YXIgZWRnZUEgPSBtYXhTZXBhcmF0aW9uLmJlc3RJbmRleDtcbiAgICB2YXIgc2VwYXJhdGlvbkEgPSBtYXhTZXBhcmF0aW9uLm1heFNlcGFyYXRpb247XG4gICAgaWYgKHNlcGFyYXRpb25BID4gdG90YWxSYWRpdXMpXG4gICAgICByZXR1cm47XG4gICAgZmluZE1heFNlcGFyYXRpb24ocG9seUIsIHhmQjIsIHBvbHlBLCB4ZkEyLCBtYXhTZXBhcmF0aW9uKTtcbiAgICB2YXIgZWRnZUIgPSBtYXhTZXBhcmF0aW9uLmJlc3RJbmRleDtcbiAgICB2YXIgc2VwYXJhdGlvbkIgPSBtYXhTZXBhcmF0aW9uLm1heFNlcGFyYXRpb247XG4gICAgaWYgKHNlcGFyYXRpb25CID4gdG90YWxSYWRpdXMpXG4gICAgICByZXR1cm47XG4gICAgdmFyIHBvbHkxO1xuICAgIHZhciBwb2x5MjtcbiAgICB2YXIgeGYxO1xuICAgIHZhciB4ZjI7XG4gICAgdmFyIGVkZ2UxMjtcbiAgICB2YXIgZmxpcDtcbiAgICB2YXIga190b2wgPSAwLjEgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgaWYgKHNlcGFyYXRpb25CID4gc2VwYXJhdGlvbkEgKyBrX3RvbCkge1xuICAgICAgcG9seTEgPSBwb2x5QjtcbiAgICAgIHBvbHkyID0gcG9seUE7XG4gICAgICB4ZjEgPSB4ZkIyO1xuICAgICAgeGYyID0geGZBMjtcbiAgICAgIGVkZ2UxMiA9IGVkZ2VCO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VCO1xuICAgICAgZmxpcCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvbHkxID0gcG9seUE7XG4gICAgICBwb2x5MiA9IHBvbHlCO1xuICAgICAgeGYxID0geGZBMjtcbiAgICAgIHhmMiA9IHhmQjI7XG4gICAgICBlZGdlMTIgPSBlZGdlQTtcbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQTtcbiAgICAgIGZsaXAgPSBmYWxzZTtcbiAgICB9XG4gICAgaW5jaWRlbnRFZGdlWzBdLnJlY3ljbGUoKTtcbiAgICBpbmNpZGVudEVkZ2VbMV0ucmVjeWNsZSgpO1xuICAgIGZpbmRJbmNpZGVudEVkZ2UoaW5jaWRlbnRFZGdlLCBwb2x5MSwgeGYxLCBlZGdlMTIsIHBvbHkyLCB4ZjIpO1xuICAgIHZhciBjb3VudDEgPSBwb2x5MS5tX2NvdW50O1xuICAgIHZhciB2ZXJ0aWNlczEgPSBwb2x5MS5tX3ZlcnRpY2VzO1xuICAgIHZhciBpdjEgPSBlZGdlMTI7XG4gICAgdmFyIGl2MiA9IGVkZ2UxMiArIDEgPCBjb3VudDEgPyBlZGdlMTIgKyAxIDogMDtcbiAgICBjb3B5VmVjMih2MTEsIHZlcnRpY2VzMVtpdjFdKTtcbiAgICBjb3B5VmVjMih2MTIsIHZlcnRpY2VzMVtpdjJdKTtcbiAgICBzdWJWZWMyKGxvY2FsVGFuZ2VudCwgdjEyLCB2MTEpO1xuICAgIG5vcm1hbGl6ZVZlYzIobG9jYWxUYW5nZW50KTtcbiAgICBjcm9zc1ZlYzJOdW0obG9jYWxOb3JtYWwsIGxvY2FsVGFuZ2VudCwgMSk7XG4gICAgY29tYmluZTJWZWMyKHBsYW5lUG9pbnQsIDAuNSwgdjExLCAwLjUsIHYxMik7XG4gICAgcm90VmVjMih0YW5nZW50LCB4ZjEucSwgbG9jYWxUYW5nZW50KTtcbiAgICBjcm9zc1ZlYzJOdW0obm9ybWFsJDEsIHRhbmdlbnQsIDEpO1xuICAgIHRyYW5zZm9ybVZlYzIodjExLCB4ZjEsIHYxMSk7XG4gICAgdHJhbnNmb3JtVmVjMih2MTIsIHhmMSwgdjEyKTtcbiAgICB2YXIgZnJvbnRPZmZzZXQgPSBkb3RWZWMyKG5vcm1hbCQxLCB2MTEpO1xuICAgIHZhciBzaWRlT2Zmc2V0MSA9IC1kb3RWZWMyKHRhbmdlbnQsIHYxMSkgKyB0b3RhbFJhZGl1cztcbiAgICB2YXIgc2lkZU9mZnNldDIgPSBkb3RWZWMyKHRhbmdlbnQsIHYxMikgKyB0b3RhbFJhZGl1cztcbiAgICBjbGlwUG9pbnRzMSQxWzBdLnJlY3ljbGUoKTtcbiAgICBjbGlwUG9pbnRzMSQxWzFdLnJlY3ljbGUoKTtcbiAgICBjbGlwUG9pbnRzMiQxWzBdLnJlY3ljbGUoKTtcbiAgICBjbGlwUG9pbnRzMiQxWzFdLnJlY3ljbGUoKTtcbiAgICBzZXRWZWMyKGNsaXBTZWdtZW50VG9MaW5lTm9ybWFsLCAtdGFuZ2VudC54LCAtdGFuZ2VudC55KTtcbiAgICB2YXIgbnAxID0gY2xpcFNlZ21lbnRUb0xpbmUoY2xpcFBvaW50czEkMSwgaW5jaWRlbnRFZGdlLCBjbGlwU2VnbWVudFRvTGluZU5vcm1hbCwgc2lkZU9mZnNldDEsIGl2MSk7XG4gICAgaWYgKG5wMSA8IDIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc2V0VmVjMihjbGlwU2VnbWVudFRvTGluZU5vcm1hbCwgdGFuZ2VudC54LCB0YW5nZW50LnkpO1xuICAgIHZhciBucDIgPSBjbGlwU2VnbWVudFRvTGluZShjbGlwUG9pbnRzMiQxLCBjbGlwUG9pbnRzMSQxLCBjbGlwU2VnbWVudFRvTGluZU5vcm1hbCwgc2lkZU9mZnNldDIsIGl2Mik7XG4gICAgaWYgKG5wMiA8IDIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIGxvY2FsTm9ybWFsKTtcbiAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCBwbGFuZVBvaW50KTtcbiAgICB2YXIgcG9pbnRDb3VudCA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbGlwUG9pbnRzMiQxLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgc2VwYXJhdGlvbiA9IGRvdFZlYzIobm9ybWFsJDEsIGNsaXBQb2ludHMyJDFbaV0udikgLSBmcm9udE9mZnNldDtcbiAgICAgIGlmIChzZXBhcmF0aW9uIDw9IHRvdGFsUmFkaXVzKSB7XG4gICAgICAgIHZhciBjcCA9IG1hbmlmb2xkLnBvaW50c1twb2ludENvdW50XTtcbiAgICAgICAgZGV0cmFuc2Zvcm1WZWMyKGNwLmxvY2FsUG9pbnQsIHhmMiwgY2xpcFBvaW50czIkMVtpXS52KTtcbiAgICAgICAgY3AuaWQuc2V0KGNsaXBQb2ludHMyJDFbaV0uaWQpO1xuICAgICAgICBpZiAoZmxpcCkge1xuICAgICAgICAgIGNwLmlkLnN3YXBGZWF0dXJlcygpO1xuICAgICAgICB9XG4gICAgICAgICsrcG9pbnRDb3VudDtcbiAgICAgIH1cbiAgICB9XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IHBvaW50Q291bnQ7XG4gIH07XG4gIENvbnRhY3QuYWRkVHlwZShQb2x5Z29uU2hhcGUuVFlQRSwgQ2lyY2xlU2hhcGUuVFlQRSwgUG9seWdvbkNpcmNsZUNvbnRhY3QpO1xuICBmdW5jdGlvbiBQb2x5Z29uQ2lyY2xlQ29udGFjdChtYW5pZm9sZCwgeGZBMiwgZml4dHVyZUEsIGluZGV4QSwgeGZCMiwgZml4dHVyZUIsIGluZGV4Qikge1xuICAgIENvbGxpZGVQb2x5Z29uQ2lyY2xlKG1hbmlmb2xkLCBmaXh0dXJlQS5nZXRTaGFwZSgpLCB4ZkEyLCBmaXh0dXJlQi5nZXRTaGFwZSgpLCB4ZkIyKTtcbiAgfVxuICB2YXIgY0xvY2FsID0gdmVjMigwLCAwKTtcbiAgdmFyIGZhY2VDZW50ZXIgPSB2ZWMyKDAsIDApO1xuICB2YXIgQ29sbGlkZVBvbHlnb25DaXJjbGUgPSBmdW5jdGlvbihtYW5pZm9sZCwgcG9seWdvbkEsIHhmQTIsIGNpcmNsZUIsIHhmQjIpIHtcbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMDtcbiAgICByZXRyYW5zZm9ybVZlYzIoY0xvY2FsLCB4ZkIyLCB4ZkEyLCBjaXJjbGVCLm1fcCk7XG4gICAgdmFyIG5vcm1hbEluZGV4ID0gMDtcbiAgICB2YXIgc2VwYXJhdGlvbiA9IC1JbmZpbml0eTtcbiAgICB2YXIgcmFkaXVzID0gcG9seWdvbkEubV9yYWRpdXMgKyBjaXJjbGVCLm1fcmFkaXVzO1xuICAgIHZhciB2ZXJ0ZXhDb3VudCA9IHBvbHlnb25BLm1fY291bnQ7XG4gICAgdmFyIHZlcnRpY2VzID0gcG9seWdvbkEubV92ZXJ0aWNlcztcbiAgICB2YXIgbm9ybWFscyA9IHBvbHlnb25BLm1fbm9ybWFscztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZlcnRleENvdW50OyArK2kpIHtcbiAgICAgIHZhciBzMiA9IGRvdFZlYzIobm9ybWFsc1tpXSwgY0xvY2FsKSAtIGRvdFZlYzIobm9ybWFsc1tpXSwgdmVydGljZXNbaV0pO1xuICAgICAgaWYgKHMyID4gcmFkaXVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChzMiA+IHNlcGFyYXRpb24pIHtcbiAgICAgICAgc2VwYXJhdGlvbiA9IHMyO1xuICAgICAgICBub3JtYWxJbmRleCA9IGk7XG4gICAgICB9XG4gICAgfVxuICAgIHZhciB2ZXJ0SW5kZXgxID0gbm9ybWFsSW5kZXg7XG4gICAgdmFyIHZlcnRJbmRleDIgPSB2ZXJ0SW5kZXgxICsgMSA8IHZlcnRleENvdW50ID8gdmVydEluZGV4MSArIDEgOiAwO1xuICAgIHZhciB2MTMgPSB2ZXJ0aWNlc1t2ZXJ0SW5kZXgxXTtcbiAgICB2YXIgdjIyID0gdmVydGljZXNbdmVydEluZGV4Ml07XG4gICAgaWYgKHNlcGFyYXRpb24gPCBFUFNJTE9OKSB7XG4gICAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMTtcbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsLCBub3JtYWxzW25vcm1hbEluZGV4XSk7XG4gICAgICBjb21iaW5lMlZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgMC41LCB2MTMsIDAuNSwgdjIyKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLnBvaW50c1swXS5sb2NhbFBvaW50LCBjaXJjbGVCLm1fcCk7XG4gICAgICBtYW5pZm9sZC5wb2ludHNbMF0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCAwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdTEgPSBkb3RWZWMyKGNMb2NhbCwgdjIyKSAtIGRvdFZlYzIoY0xvY2FsLCB2MTMpIC0gZG90VmVjMih2MTMsIHYyMikgKyBkb3RWZWMyKHYxMywgdjEzKTtcbiAgICB2YXIgdTIgPSBkb3RWZWMyKGNMb2NhbCwgdjEzKSAtIGRvdFZlYzIoY0xvY2FsLCB2MjIpIC0gZG90VmVjMih2MjIsIHYxMykgKyBkb3RWZWMyKHYyMiwgdjIyKTtcbiAgICBpZiAodTEgPD0gMCkge1xuICAgICAgaWYgKGRpc3RTcXJWZWMyKGNMb2NhbCwgdjEzKSA+IHJhZGl1cyAqIHJhZGl1cykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMTtcbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQTtcbiAgICAgIHN1YlZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIGNMb2NhbCwgdjEzKTtcbiAgICAgIG5vcm1hbGl6ZVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgdjEzKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLnBvaW50c1swXS5sb2NhbFBvaW50LCBjaXJjbGVCLm1fcCk7XG4gICAgICBtYW5pZm9sZC5wb2ludHNbMF0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCAwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICAgIH0gZWxzZSBpZiAodTIgPD0gMCkge1xuICAgICAgaWYgKGRpc3RTcXJWZWMyKGNMb2NhbCwgdjIyKSA+IHJhZGl1cyAqIHJhZGl1cykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMTtcbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQTtcbiAgICAgIHN1YlZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIGNMb2NhbCwgdjIyKTtcbiAgICAgIG5vcm1hbGl6ZVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgdjIyKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLnBvaW50c1swXS5sb2NhbFBvaW50LCBjaXJjbGVCLm1fcCk7XG4gICAgICBtYW5pZm9sZC5wb2ludHNbMF0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCAwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb21iaW5lMlZlYzIoZmFjZUNlbnRlciwgMC41LCB2MTMsIDAuNSwgdjIyKTtcbiAgICAgIHZhciBzZXBhcmF0aW9uXzEgPSBkb3RWZWMyKGNMb2NhbCwgbm9ybWFsc1t2ZXJ0SW5kZXgxXSkgLSBkb3RWZWMyKGZhY2VDZW50ZXIsIG5vcm1hbHNbdmVydEluZGV4MV0pO1xuICAgICAgaWYgKHNlcGFyYXRpb25fMSA+IHJhZGl1cykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMTtcbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsLCBub3JtYWxzW3ZlcnRJbmRleDFdKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIGZhY2VDZW50ZXIpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgfVxuICB9O1xuICB2YXIgbWF0aF9taW4gPSBNYXRoLm1pbjtcbiAgQ29udGFjdC5hZGRUeXBlKEVkZ2VTaGFwZS5UWVBFLCBQb2x5Z29uU2hhcGUuVFlQRSwgRWRnZVBvbHlnb25Db250YWN0KTtcbiAgQ29udGFjdC5hZGRUeXBlKENoYWluU2hhcGUuVFlQRSwgUG9seWdvblNoYXBlLlRZUEUsIENoYWluUG9seWdvbkNvbnRhY3QpO1xuICBmdW5jdGlvbiBFZGdlUG9seWdvbkNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZBLCBpbmRleEEsIHhmQjIsIGZCLCBpbmRleEIpIHtcbiAgICBDb2xsaWRlRWRnZVBvbHlnb24obWFuaWZvbGQsIGZBLmdldFNoYXBlKCksIHhmQTIsIGZCLmdldFNoYXBlKCksIHhmQjIpO1xuICB9XG4gIHZhciBlZGdlX3JldXNlID0gbmV3IEVkZ2VTaGFwZSgpO1xuICBmdW5jdGlvbiBDaGFpblBvbHlnb25Db250YWN0KG1hbmlmb2xkLCB4ZkEyLCBmQSwgaW5kZXhBLCB4ZkIyLCBmQiwgaW5kZXhCKSB7XG4gICAgdmFyIGNoYWluID0gZkEuZ2V0U2hhcGUoKTtcbiAgICBjaGFpbi5nZXRDaGlsZEVkZ2UoZWRnZV9yZXVzZSwgaW5kZXhBKTtcbiAgICBDb2xsaWRlRWRnZVBvbHlnb24obWFuaWZvbGQsIGVkZ2VfcmV1c2UsIHhmQTIsIGZCLmdldFNoYXBlKCksIHhmQjIpO1xuICB9XG4gIHZhciBFUEF4aXNUeXBlO1xuICAoZnVuY3Rpb24oRVBBeGlzVHlwZTIpIHtcbiAgICBFUEF4aXNUeXBlMltFUEF4aXNUeXBlMltcImVfdW5rbm93blwiXSA9IC0xXSA9IFwiZV91bmtub3duXCI7XG4gICAgRVBBeGlzVHlwZTJbRVBBeGlzVHlwZTJbXCJlX2VkZ2VBXCJdID0gMV0gPSBcImVfZWRnZUFcIjtcbiAgICBFUEF4aXNUeXBlMltFUEF4aXNUeXBlMltcImVfZWRnZUJcIl0gPSAyXSA9IFwiZV9lZGdlQlwiO1xuICB9KShFUEF4aXNUeXBlIHx8IChFUEF4aXNUeXBlID0ge30pKTtcbiAgdmFyIFZlcnRleFR5cGU7XG4gIChmdW5jdGlvbihWZXJ0ZXhUeXBlMikge1xuICAgIFZlcnRleFR5cGUyW1ZlcnRleFR5cGUyW1wiZV9pc29sYXRlZFwiXSA9IDBdID0gXCJlX2lzb2xhdGVkXCI7XG4gICAgVmVydGV4VHlwZTJbVmVydGV4VHlwZTJbXCJlX2NvbmNhdmVcIl0gPSAxXSA9IFwiZV9jb25jYXZlXCI7XG4gICAgVmVydGV4VHlwZTJbVmVydGV4VHlwZTJbXCJlX2NvbnZleFwiXSA9IDJdID0gXCJlX2NvbnZleFwiO1xuICB9KShWZXJ0ZXhUeXBlIHx8IChWZXJ0ZXhUeXBlID0ge30pKTtcbiAgdmFyIEVQQXhpcyA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRVBBeGlzMigpIHtcbiAgICAgIH1cbiAgICAgIHJldHVybiBFUEF4aXMyO1xuICAgIH0oKVxuICApO1xuICB2YXIgVGVtcFBvbHlnb24gPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIC8qIEBfX1BVUkVfXyAqLyBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFRlbXBQb2x5Z29uMigpIHtcbiAgICAgICAgdGhpcy52ZXJ0aWNlcyA9IFtdO1xuICAgICAgICB0aGlzLm5vcm1hbHMgPSBbXTtcbiAgICAgICAgdGhpcy5jb3VudCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgU2V0dGluZ3NJbnRlcm5hbC5tYXhQb2x5Z29uVmVydGljZXM7IGkrKykge1xuICAgICAgICAgIHRoaXMudmVydGljZXMucHVzaCh2ZWMyKDAsIDApKTtcbiAgICAgICAgICB0aGlzLm5vcm1hbHMucHVzaCh2ZWMyKDAsIDApKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIFRlbXBQb2x5Z29uMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFJlZmVyZW5jZUZhY2UgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gUmVmZXJlbmNlRmFjZTIoKSB7XG4gICAgICAgIHRoaXMudjEgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnYyID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5ub3JtYWwgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnNpZGVOb3JtYWwxID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5zaWRlTm9ybWFsMiA9IHZlYzIoMCwgMCk7XG4gICAgICB9XG4gICAgICBSZWZlcmVuY2VGYWNlMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnYxKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy52Mik7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubm9ybWFsKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5zaWRlTm9ybWFsMSk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMuc2lkZU5vcm1hbDIpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBSZWZlcmVuY2VGYWNlMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIGNsaXBQb2ludHMxID0gW25ldyBDbGlwVmVydGV4KCksIG5ldyBDbGlwVmVydGV4KCldO1xuICB2YXIgY2xpcFBvaW50czIgPSBbbmV3IENsaXBWZXJ0ZXgoKSwgbmV3IENsaXBWZXJ0ZXgoKV07XG4gIHZhciBpZSA9IFtuZXcgQ2xpcFZlcnRleCgpLCBuZXcgQ2xpcFZlcnRleCgpXTtcbiAgdmFyIGVkZ2VBeGlzID0gbmV3IEVQQXhpcygpO1xuICB2YXIgcG9seWdvbkF4aXMgPSBuZXcgRVBBeGlzKCk7XG4gIHZhciBwb2x5Z29uQkEgPSBuZXcgVGVtcFBvbHlnb24oKTtcbiAgdmFyIHJmID0gbmV3IFJlZmVyZW5jZUZhY2UoKTtcbiAgdmFyIGNlbnRyb2lkQiA9IHZlYzIoMCwgMCk7XG4gIHZhciBlZGdlMCA9IHZlYzIoMCwgMCk7XG4gIHZhciBlZGdlMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBlZGdlMiA9IHZlYzIoMCwgMCk7XG4gIHZhciB4ZiA9IHRyYW5zZm9ybSgwLCAwLCAwKTtcbiAgdmFyIG5vcm1hbCA9IHZlYzIoMCwgMCk7XG4gIHZhciBub3JtYWwwID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgbm9ybWFsMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBsb3dlckxpbWl0ID0gdmVjMigwLCAwKTtcbiAgdmFyIHVwcGVyTGltaXQgPSB2ZWMyKDAsIDApO1xuICB2YXIgcGVycCA9IHZlYzIoMCwgMCk7XG4gIHZhciBuID0gdmVjMigwLCAwKTtcbiAgdmFyIENvbGxpZGVFZGdlUG9seWdvbiA9IGZ1bmN0aW9uKG1hbmlmb2xkLCBlZGdlQSwgeGZBMiwgcG9seWdvbkIsIHhmQjIpIHtcbiAgICBkZXRyYW5zZm9ybVRyYW5zZm9ybSh4ZiwgeGZBMiwgeGZCMik7XG4gICAgdHJhbnNmb3JtVmVjMihjZW50cm9pZEIsIHhmLCBwb2x5Z29uQi5tX2NlbnRyb2lkKTtcbiAgICB2YXIgdjAgPSBlZGdlQS5tX3ZlcnRleDA7XG4gICAgdmFyIHYxMyA9IGVkZ2VBLm1fdmVydGV4MTtcbiAgICB2YXIgdjIyID0gZWRnZUEubV92ZXJ0ZXgyO1xuICAgIHZhciB2MyA9IGVkZ2VBLm1fdmVydGV4MztcbiAgICB2YXIgaGFzVmVydGV4MCA9IGVkZ2VBLm1faGFzVmVydGV4MDtcbiAgICB2YXIgaGFzVmVydGV4MyA9IGVkZ2VBLm1faGFzVmVydGV4MztcbiAgICBzdWJWZWMyKGVkZ2UxLCB2MjIsIHYxMyk7XG4gICAgbm9ybWFsaXplVmVjMihlZGdlMSk7XG4gICAgc2V0VmVjMihub3JtYWwxLCBlZGdlMS55LCAtZWRnZTEueCk7XG4gICAgdmFyIG9mZnNldDEgPSBkb3RWZWMyKG5vcm1hbDEsIGNlbnRyb2lkQikgLSBkb3RWZWMyKG5vcm1hbDEsIHYxMyk7XG4gICAgdmFyIG9mZnNldDAgPSAwO1xuICAgIHZhciBvZmZzZXQyID0gMDtcbiAgICB2YXIgY29udmV4MSA9IGZhbHNlO1xuICAgIHZhciBjb252ZXgyID0gZmFsc2U7XG4gICAgemVyb1ZlYzIobm9ybWFsMCk7XG4gICAgemVyb1ZlYzIobm9ybWFsMik7XG4gICAgaWYgKGhhc1ZlcnRleDApIHtcbiAgICAgIHN1YlZlYzIoZWRnZTAsIHYxMywgdjApO1xuICAgICAgbm9ybWFsaXplVmVjMihlZGdlMCk7XG4gICAgICBzZXRWZWMyKG5vcm1hbDAsIGVkZ2UwLnksIC1lZGdlMC54KTtcbiAgICAgIGNvbnZleDEgPSBjcm9zc1ZlYzJWZWMyKGVkZ2UwLCBlZGdlMSkgPj0gMDtcbiAgICAgIG9mZnNldDAgPSBWZWMyLmRvdChub3JtYWwwLCBjZW50cm9pZEIpIC0gVmVjMi5kb3Qobm9ybWFsMCwgdjApO1xuICAgIH1cbiAgICBpZiAoaGFzVmVydGV4Mykge1xuICAgICAgc3ViVmVjMihlZGdlMiwgdjMsIHYyMik7XG4gICAgICBub3JtYWxpemVWZWMyKGVkZ2UyKTtcbiAgICAgIHNldFZlYzIobm9ybWFsMiwgZWRnZTIueSwgLWVkZ2UyLngpO1xuICAgICAgY29udmV4MiA9IFZlYzIuY3Jvc3NWZWMyVmVjMihlZGdlMSwgZWRnZTIpID4gMDtcbiAgICAgIG9mZnNldDIgPSBWZWMyLmRvdChub3JtYWwyLCBjZW50cm9pZEIpIC0gVmVjMi5kb3Qobm9ybWFsMiwgdjIyKTtcbiAgICB9XG4gICAgdmFyIGZyb250O1xuICAgIHplcm9WZWMyKG5vcm1hbCk7XG4gICAgemVyb1ZlYzIobG93ZXJMaW1pdCk7XG4gICAgemVyb1ZlYzIodXBwZXJMaW1pdCk7XG4gICAgaWYgKGhhc1ZlcnRleDAgJiYgaGFzVmVydGV4Mykge1xuICAgICAgaWYgKGNvbnZleDEgJiYgY29udmV4Mikge1xuICAgICAgICBmcm9udCA9IG9mZnNldDAgPj0gMCB8fCBvZmZzZXQxID49IDAgfHwgb2Zmc2V0MiA+PSAwO1xuICAgICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDApO1xuICAgICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY29udmV4MSkge1xuICAgICAgICBmcm9udCA9IG9mZnNldDAgPj0gMCB8fCBvZmZzZXQxID49IDAgJiYgb2Zmc2V0MiA+PSAwO1xuICAgICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDApO1xuICAgICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDIpO1xuICAgICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY29udmV4Mikge1xuICAgICAgICBmcm9udCA9IG9mZnNldDIgPj0gMCB8fCBvZmZzZXQwID49IDAgJiYgb2Zmc2V0MSA+PSAwO1xuICAgICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MCA+PSAwICYmIG9mZnNldDEgPj0gMCAmJiBvZmZzZXQyID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMik7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoaGFzVmVydGV4MCkge1xuICAgICAgaWYgKGNvbnZleDEpIHtcbiAgICAgICAgZnJvbnQgPSBvZmZzZXQwID49IDAgfHwgb2Zmc2V0MSA+PSAwO1xuICAgICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDApO1xuICAgICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MCA+PSAwICYmIG9mZnNldDEgPj0gMDtcbiAgICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChoYXNWZXJ0ZXgzKSB7XG4gICAgICBpZiAoY29udmV4Mikge1xuICAgICAgICBmcm9udCA9IG9mZnNldDEgPj0gMCB8fCBvZmZzZXQyID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnJvbnQgPSBvZmZzZXQxID49IDAgJiYgb2Zmc2V0MiA+PSAwO1xuICAgICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMik7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZnJvbnQgPSBvZmZzZXQxID49IDA7XG4gICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNjYWxlVmVjMihub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgfVxuICAgIH1cbiAgICBwb2x5Z29uQkEuY291bnQgPSBwb2x5Z29uQi5tX2NvdW50O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9seWdvbkIubV9jb3VudDsgKytpKSB7XG4gICAgICB0cmFuc2Zvcm1WZWMyKHBvbHlnb25CQS52ZXJ0aWNlc1tpXSwgeGYsIHBvbHlnb25CLm1fdmVydGljZXNbaV0pO1xuICAgICAgcm90VmVjMihwb2x5Z29uQkEubm9ybWFsc1tpXSwgeGYucSwgcG9seWdvbkIubV9ub3JtYWxzW2ldKTtcbiAgICB9XG4gICAgdmFyIHJhZGl1cyA9IHBvbHlnb25CLm1fcmFkaXVzICsgZWRnZUEubV9yYWRpdXM7XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDA7XG4gICAge1xuICAgICAgZWRnZUF4aXMudHlwZSA9IEVQQXhpc1R5cGUuZV9lZGdlQTtcbiAgICAgIGVkZ2VBeGlzLmluZGV4ID0gZnJvbnQgPyAwIDogMTtcbiAgICAgIGVkZ2VBeGlzLnNlcGFyYXRpb24gPSBJbmZpbml0eTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9seWdvbkJBLmNvdW50OyArK2kpIHtcbiAgICAgICAgdmFyIHY0ID0gcG9seWdvbkJBLnZlcnRpY2VzW2ldO1xuICAgICAgICB2YXIgczIgPSBkb3RWZWMyKG5vcm1hbCwgdjQpIC0gZG90VmVjMihub3JtYWwsIHYxMyk7XG4gICAgICAgIGlmIChzMiA8IGVkZ2VBeGlzLnNlcGFyYXRpb24pIHtcbiAgICAgICAgICBlZGdlQXhpcy5zZXBhcmF0aW9uID0gczI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVkZ2VBeGlzLnR5cGUgPT0gRVBBeGlzVHlwZS5lX3Vua25vd24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGVkZ2VBeGlzLnNlcGFyYXRpb24gPiByYWRpdXMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAge1xuICAgICAgcG9seWdvbkF4aXMudHlwZSA9IEVQQXhpc1R5cGUuZV91bmtub3duO1xuICAgICAgcG9seWdvbkF4aXMuaW5kZXggPSAtMTtcbiAgICAgIHBvbHlnb25BeGlzLnNlcGFyYXRpb24gPSAtSW5maW5pdHk7XG4gICAgICBzZXRWZWMyKHBlcnAsIC1ub3JtYWwueSwgbm9ybWFsLngpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2x5Z29uQkEuY291bnQ7ICsraSkge1xuICAgICAgICBzY2FsZVZlYzIobiwgLTEsIHBvbHlnb25CQS5ub3JtYWxzW2ldKTtcbiAgICAgICAgdmFyIHMxID0gZG90VmVjMihuLCBwb2x5Z29uQkEudmVydGljZXNbaV0pIC0gZG90VmVjMihuLCB2MTMpO1xuICAgICAgICB2YXIgczIyID0gZG90VmVjMihuLCBwb2x5Z29uQkEudmVydGljZXNbaV0pIC0gZG90VmVjMihuLCB2MjIpO1xuICAgICAgICB2YXIgczIgPSBtYXRoX21pbihzMSwgczIyKTtcbiAgICAgICAgaWYgKHMyID4gcmFkaXVzKSB7XG4gICAgICAgICAgcG9seWdvbkF4aXMudHlwZSA9IEVQQXhpc1R5cGUuZV9lZGdlQjtcbiAgICAgICAgICBwb2x5Z29uQXhpcy5pbmRleCA9IGk7XG4gICAgICAgICAgcG9seWdvbkF4aXMuc2VwYXJhdGlvbiA9IHMyO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkb3RWZWMyKG4sIHBlcnApID49IDApIHtcbiAgICAgICAgICBpZiAoZG90VmVjMihuLCBub3JtYWwpIC0gZG90VmVjMih1cHBlckxpbWl0LCBub3JtYWwpIDwgLVNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsb3ApIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoZG90VmVjMihuLCBub3JtYWwpIC0gZG90VmVjMihsb3dlckxpbWl0LCBub3JtYWwpIDwgLVNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsb3ApIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoczIgPiBwb2x5Z29uQXhpcy5zZXBhcmF0aW9uKSB7XG4gICAgICAgICAgcG9seWdvbkF4aXMudHlwZSA9IEVQQXhpc1R5cGUuZV9lZGdlQjtcbiAgICAgICAgICBwb2x5Z29uQXhpcy5pbmRleCA9IGk7XG4gICAgICAgICAgcG9seWdvbkF4aXMuc2VwYXJhdGlvbiA9IHMyO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChwb2x5Z29uQXhpcy50eXBlICE9IEVQQXhpc1R5cGUuZV91bmtub3duICYmIHBvbHlnb25BeGlzLnNlcGFyYXRpb24gPiByYWRpdXMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGtfcmVsYXRpdmVUb2wgPSAwLjk4O1xuICAgIHZhciBrX2Fic29sdXRlVG9sID0gMWUtMztcbiAgICB2YXIgcHJpbWFyeUF4aXM7XG4gICAgaWYgKHBvbHlnb25BeGlzLnR5cGUgPT0gRVBBeGlzVHlwZS5lX3Vua25vd24pIHtcbiAgICAgIHByaW1hcnlBeGlzID0gZWRnZUF4aXM7XG4gICAgfSBlbHNlIGlmIChwb2x5Z29uQXhpcy5zZXBhcmF0aW9uID4ga19yZWxhdGl2ZVRvbCAqIGVkZ2VBeGlzLnNlcGFyYXRpb24gKyBrX2Fic29sdXRlVG9sKSB7XG4gICAgICBwcmltYXJ5QXhpcyA9IHBvbHlnb25BeGlzO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcmltYXJ5QXhpcyA9IGVkZ2VBeGlzO1xuICAgIH1cbiAgICBpZVswXS5yZWN5Y2xlKCk7XG4gICAgaWVbMV0ucmVjeWNsZSgpO1xuICAgIGlmIChwcmltYXJ5QXhpcy50eXBlID09IEVQQXhpc1R5cGUuZV9lZGdlQSkge1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgdmFyIGJlc3RJbmRleCA9IDA7XG4gICAgICB2YXIgYmVzdFZhbHVlID0gZG90VmVjMihub3JtYWwsIHBvbHlnb25CQS5ub3JtYWxzWzBdKTtcbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgcG9seWdvbkJBLmNvdW50OyArK2kpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gZG90VmVjMihub3JtYWwsIHBvbHlnb25CQS5ub3JtYWxzW2ldKTtcbiAgICAgICAgaWYgKHZhbHVlIDwgYmVzdFZhbHVlKSB7XG4gICAgICAgICAgYmVzdFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgYmVzdEluZGV4ID0gaTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdmFyIGkxID0gYmVzdEluZGV4O1xuICAgICAgdmFyIGkyID0gaTEgKyAxIDwgcG9seWdvbkJBLmNvdW50ID8gaTEgKyAxIDogMDtcbiAgICAgIGNvcHlWZWMyKGllWzBdLnYsIHBvbHlnb25CQS52ZXJ0aWNlc1tpMV0pO1xuICAgICAgaWVbMF0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfZmFjZSwgaTEsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgICBjb3B5VmVjMihpZVsxXS52LCBwb2x5Z29uQkEudmVydGljZXNbaTJdKTtcbiAgICAgIGllWzFdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UsIGkyLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgIHJmLmkxID0gMDtcbiAgICAgICAgcmYuaTIgPSAxO1xuICAgICAgICBjb3B5VmVjMihyZi52MSwgdjEzKTtcbiAgICAgICAgY29weVZlYzIocmYudjIsIHYyMik7XG4gICAgICAgIGNvcHlWZWMyKHJmLm5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZi5pMSA9IDE7XG4gICAgICAgIHJmLmkyID0gMDtcbiAgICAgICAgY29weVZlYzIocmYudjEsIHYyMik7XG4gICAgICAgIGNvcHlWZWMyKHJmLnYyLCB2MTMpO1xuICAgICAgICBzY2FsZVZlYzIocmYubm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQjtcbiAgICAgIGNvcHlWZWMyKGllWzBdLnYsIHYxMyk7XG4gICAgICBpZVswXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIHByaW1hcnlBeGlzLmluZGV4LCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV9mYWNlKTtcbiAgICAgIGNvcHlWZWMyKGllWzFdLnYsIHYyMik7XG4gICAgICBpZVsxXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIHByaW1hcnlBeGlzLmluZGV4LCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV9mYWNlKTtcbiAgICAgIHJmLmkxID0gcHJpbWFyeUF4aXMuaW5kZXg7XG4gICAgICByZi5pMiA9IHJmLmkxICsgMSA8IHBvbHlnb25CQS5jb3VudCA/IHJmLmkxICsgMSA6IDA7XG4gICAgICBjb3B5VmVjMihyZi52MSwgcG9seWdvbkJBLnZlcnRpY2VzW3JmLmkxXSk7XG4gICAgICBjb3B5VmVjMihyZi52MiwgcG9seWdvbkJBLnZlcnRpY2VzW3JmLmkyXSk7XG4gICAgICBjb3B5VmVjMihyZi5ub3JtYWwsIHBvbHlnb25CQS5ub3JtYWxzW3JmLmkxXSk7XG4gICAgfVxuICAgIHNldFZlYzIocmYuc2lkZU5vcm1hbDEsIHJmLm5vcm1hbC55LCAtcmYubm9ybWFsLngpO1xuICAgIHNldFZlYzIocmYuc2lkZU5vcm1hbDIsIC1yZi5zaWRlTm9ybWFsMS54LCAtcmYuc2lkZU5vcm1hbDEueSk7XG4gICAgcmYuc2lkZU9mZnNldDEgPSBkb3RWZWMyKHJmLnNpZGVOb3JtYWwxLCByZi52MSk7XG4gICAgcmYuc2lkZU9mZnNldDIgPSBkb3RWZWMyKHJmLnNpZGVOb3JtYWwyLCByZi52Mik7XG4gICAgY2xpcFBvaW50czFbMF0ucmVjeWNsZSgpO1xuICAgIGNsaXBQb2ludHMxWzFdLnJlY3ljbGUoKTtcbiAgICBjbGlwUG9pbnRzMlswXS5yZWN5Y2xlKCk7XG4gICAgY2xpcFBvaW50czJbMV0ucmVjeWNsZSgpO1xuICAgIHZhciBucDEgPSBjbGlwU2VnbWVudFRvTGluZShjbGlwUG9pbnRzMSwgaWUsIHJmLnNpZGVOb3JtYWwxLCByZi5zaWRlT2Zmc2V0MSwgcmYuaTEpO1xuICAgIGlmIChucDEgPCBTZXR0aW5nc0ludGVybmFsLm1heE1hbmlmb2xkUG9pbnRzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBucDIgPSBjbGlwU2VnbWVudFRvTGluZShjbGlwUG9pbnRzMiwgY2xpcFBvaW50czEsIHJmLnNpZGVOb3JtYWwyLCByZi5zaWRlT2Zmc2V0MiwgcmYuaTIpO1xuICAgIGlmIChucDIgPCBTZXR0aW5nc0ludGVybmFsLm1heE1hbmlmb2xkUG9pbnRzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChwcmltYXJ5QXhpcy50eXBlID09IEVQQXhpc1R5cGUuZV9lZGdlQSkge1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIHJmLm5vcm1hbCk7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCByZi52MSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsLCBwb2x5Z29uQi5tX25vcm1hbHNbcmYuaTFdKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIHBvbHlnb25CLm1fdmVydGljZXNbcmYuaTFdKTtcbiAgICB9XG4gICAgdmFyIHBvaW50Q291bnQgPSAwO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgU2V0dGluZ3NJbnRlcm5hbC5tYXhNYW5pZm9sZFBvaW50czsgKytpKSB7XG4gICAgICB2YXIgc2VwYXJhdGlvbiA9IGRvdFZlYzIocmYubm9ybWFsLCBjbGlwUG9pbnRzMltpXS52KSAtIGRvdFZlYzIocmYubm9ybWFsLCByZi52MSk7XG4gICAgICBpZiAoc2VwYXJhdGlvbiA8PSByYWRpdXMpIHtcbiAgICAgICAgdmFyIGNwID0gbWFuaWZvbGQucG9pbnRzW3BvaW50Q291bnRdO1xuICAgICAgICBpZiAocHJpbWFyeUF4aXMudHlwZSA9PSBFUEF4aXNUeXBlLmVfZWRnZUEpIHtcbiAgICAgICAgICBkZXRyYW5zZm9ybVZlYzIoY3AubG9jYWxQb2ludCwgeGYsIGNsaXBQb2ludHMyW2ldLnYpO1xuICAgICAgICAgIGNwLmlkLnNldChjbGlwUG9pbnRzMltpXS5pZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29weVZlYzIoY3AubG9jYWxQb2ludCwgY2xpcFBvaW50czJbaV0udik7XG4gICAgICAgICAgY3AuaWQuc2V0KGNsaXBQb2ludHMyW2ldLmlkKTtcbiAgICAgICAgICBjcC5pZC5zd2FwRmVhdHVyZXMoKTtcbiAgICAgICAgfVxuICAgICAgICArK3BvaW50Q291bnQ7XG4gICAgICB9XG4gICAgfVxuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSBwb2ludENvdW50O1xuICB9O1xuICB2YXIgaW50ZXJuYWwgPSB7XG4gICAgQ29sbGlkZVBvbHlnb25zLFxuICAgIFNldHRpbmdzLFxuICAgIFN3ZWVwLFxuICAgIE1hbmlmb2xkLFxuICAgIERpc3RhbmNlLFxuICAgIFRpbWVPZkltcGFjdCxcbiAgICBEeW5hbWljVHJlZSxcbiAgICBzdGF0c1xuICB9O1xuICB2YXIgRGF0YURyaXZlciA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBEYXRhRHJpdmVyMihrZXksIGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuX3JlZk1hcCA9IHt9O1xuICAgICAgICB0aGlzLl9tYXAgPSB7fTtcbiAgICAgICAgdGhpcy5feG1hcCA9IHt9O1xuICAgICAgICB0aGlzLl9kYXRhID0gW107XG4gICAgICAgIHRoaXMuX2VudGVyZWQgPSBbXTtcbiAgICAgICAgdGhpcy5fZXhpdGVkID0gW107XG4gICAgICAgIHRoaXMuX2tleSA9IGtleTtcbiAgICAgICAgdGhpcy5fbGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICAgIH1cbiAgICAgIERhdGFEcml2ZXIyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShkYXRhKSlcbiAgICAgICAgICB0aHJvdyBcIkludmFsaWQgZGF0YTogXCIgKyBkYXRhO1xuICAgICAgICB0aGlzLl9lbnRlcmVkLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuX2V4aXRlZC5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLl9kYXRhLmxlbmd0aCA9IGRhdGEubGVuZ3RoO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGRhdGFbaV0gIT09IFwib2JqZWN0XCIgfHwgZGF0YVtpXSA9PT0gbnVsbClcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIHZhciBkMiA9IGRhdGFbaV07XG4gICAgICAgICAgdmFyIGlkID0gdGhpcy5fa2V5KGQyKTtcbiAgICAgICAgICBpZiAoIXRoaXMuX21hcFtpZF0pIHtcbiAgICAgICAgICAgIHRoaXMuX2VudGVyZWQucHVzaChkMik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9tYXBbaWRdO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLl9kYXRhW2ldID0gZDI7XG4gICAgICAgICAgdGhpcy5feG1hcFtpZF0gPSBkMjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpZCBpbiB0aGlzLl9tYXApIHtcbiAgICAgICAgICB0aGlzLl9leGl0ZWQucHVzaCh0aGlzLl9tYXBbaWRdKTtcbiAgICAgICAgICBkZWxldGUgdGhpcy5fbWFwW2lkXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGVtcDMgPSB0aGlzLl9tYXA7XG4gICAgICAgIHRoaXMuX21hcCA9IHRoaXMuX3htYXA7XG4gICAgICAgIHRoaXMuX3htYXAgPSB0ZW1wMztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9leGl0ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgZDIgPSB0aGlzLl9leGl0ZWRbaV07XG4gICAgICAgICAgdmFyIGtleSA9IHRoaXMuX2tleShkMik7XG4gICAgICAgICAgdmFyIHJlZiA9IHRoaXMuX3JlZk1hcFtrZXldO1xuICAgICAgICAgIHRoaXMuX2xpc3RlbmVyLmV4aXQoZDIsIHJlZik7XG4gICAgICAgICAgZGVsZXRlIHRoaXMuX3JlZk1hcFtrZXldO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZW50ZXJlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBkMiA9IHRoaXMuX2VudGVyZWRbaV07XG4gICAgICAgICAgdmFyIGtleSA9IHRoaXMuX2tleShkMik7XG4gICAgICAgICAgdmFyIHJlZiA9IHRoaXMuX2xpc3RlbmVyLmVudGVyKGQyKTtcbiAgICAgICAgICBpZiAocmVmKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWZNYXBba2V5XSA9IHJlZjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9kYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBkYXRhW2ldICE9PSBcIm9iamVjdFwiIHx8IGRhdGFbaV0gPT09IG51bGwpXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB2YXIgZDIgPSB0aGlzLl9kYXRhW2ldO1xuICAgICAgICAgIHZhciBrZXkgPSB0aGlzLl9rZXkoZDIpO1xuICAgICAgICAgIHZhciByZWYgPSB0aGlzLl9yZWZNYXBba2V5XTtcbiAgICAgICAgICB0aGlzLl9saXN0ZW5lci51cGRhdGUoZDIsIHJlZik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZW50ZXJlZC5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLl9leGl0ZWQubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5fZGF0YS5sZW5ndGggPSAwO1xuICAgICAgfTtcbiAgICAgIERhdGFEcml2ZXIyLnByb3RvdHlwZS5yZWYgPSBmdW5jdGlvbihkMikge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVmTWFwW3RoaXMuX2tleShkMildO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBEYXRhRHJpdmVyMjtcbiAgICB9KClcbiAgKTtcbiAgY29uc3QgcGxhbmNrID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5mcmVlemUoLyogQF9fUFVSRV9fICovIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7XG4gICAgX19wcm90b19fOiBudWxsLFxuICAgIEFBQkIsXG4gICAgQm9keSxcbiAgICBCb3g6IEJveFNoYXBlLFxuICAgIEJveFNoYXBlLFxuICAgIEJyb2FkUGhhc2UsXG4gICAgQ2hhaW46IENoYWluU2hhcGUsXG4gICAgQ2hhaW5TaGFwZSxcbiAgICBDaXJjbGU6IENpcmNsZVNoYXBlLFxuICAgIENpcmNsZVNoYXBlLFxuICAgIENsaXBWZXJ0ZXgsXG4gICAgQ29sbGlkZUNpcmNsZXMsXG4gICAgQ29sbGlkZUVkZ2VDaXJjbGUsXG4gICAgQ29sbGlkZUVkZ2VQb2x5Z29uLFxuICAgIENvbGxpZGVQb2x5Z29uQ2lyY2xlLFxuICAgIENvbGxpZGVQb2x5Z29ucyxcbiAgICBDb250YWN0LFxuICAgIENvbnRhY3RFZGdlLFxuICAgIGdldCBDb250YWN0RmVhdHVyZVR5cGUoKSB7XG4gICAgICByZXR1cm4gZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlO1xuICAgIH0sXG4gICAgQ29udGFjdElELFxuICAgIENvbnRhY3RJbXB1bHNlLFxuICAgIERhdGFEcml2ZXIsXG4gICAgRGlzdGFuY2UsXG4gICAgRGlzdGFuY2VJbnB1dCxcbiAgICBEaXN0YW5jZUpvaW50LFxuICAgIERpc3RhbmNlT3V0cHV0LFxuICAgIERpc3RhbmNlUHJveHksXG4gICAgRHluYW1pY1RyZWUsXG4gICAgRWRnZTogRWRnZVNoYXBlLFxuICAgIEVkZ2VTaGFwZSxcbiAgICBGaXh0dXJlLFxuICAgIEZpeHR1cmVQcm94eSxcbiAgICBGcmljdGlvbkpvaW50LFxuICAgIEdlYXJKb2ludCxcbiAgICBKb2ludCxcbiAgICBKb2ludEVkZ2UsXG4gICAgTWFuaWZvbGQsXG4gICAgTWFuaWZvbGRQb2ludCxcbiAgICBnZXQgTWFuaWZvbGRUeXBlKCkge1xuICAgICAgcmV0dXJuIGV4cG9ydHMyLk1hbmlmb2xkVHlwZTtcbiAgICB9LFxuICAgIE1hdDIyLFxuICAgIE1hdDMzLFxuICAgIE1hdGg6IG1hdGgsXG4gICAgTW90b3JKb2ludCxcbiAgICBNb3VzZUpvaW50LFxuICAgIGdldCBQb2ludFN0YXRlKCkge1xuICAgICAgcmV0dXJuIGV4cG9ydHMyLlBvaW50U3RhdGU7XG4gICAgfSxcbiAgICBQb2x5Z29uOiBQb2x5Z29uU2hhcGUsXG4gICAgUG9seWdvblNoYXBlLFxuICAgIFByaXNtYXRpY0pvaW50LFxuICAgIFB1bGxleUpvaW50LFxuICAgIFJldm9sdXRlSm9pbnQsXG4gICAgUm9wZUpvaW50LFxuICAgIFJvdCxcbiAgICBTZXJpYWxpemVyLFxuICAgIFNldHRpbmdzLFxuICAgIFNldHRpbmdzSW50ZXJuYWwsXG4gICAgU2hhcGUsXG4gICAgU2hhcGVDYXN0LFxuICAgIFNoYXBlQ2FzdElucHV0LFxuICAgIFNoYXBlQ2FzdE91dHB1dCxcbiAgICBTaW1wbGV4Q2FjaGUsXG4gICAgU29sdmVyLFxuICAgIFN3ZWVwLFxuICAgIFRPSUlucHV0LFxuICAgIFRPSU91dHB1dCxcbiAgICBnZXQgVE9JT3V0cHV0U3RhdGUoKSB7XG4gICAgICByZXR1cm4gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGU7XG4gICAgfSxcbiAgICBUZXN0YmVkLFxuICAgIFRpbWVPZkltcGFjdCxcbiAgICBUaW1lU3RlcCxcbiAgICBUcmFuc2Zvcm0sXG4gICAgVHJlZU5vZGUsXG4gICAgVmVjMixcbiAgICBWZWMzLFxuICAgIFZlbG9jaXR5Q29uc3RyYWludFBvaW50LFxuICAgIFdlbGRKb2ludCxcbiAgICBXaGVlbEpvaW50LFxuICAgIFdvcmxkLFxuICAgIFdvcmxkTWFuaWZvbGQsXG4gICAgY2xpcFNlZ21lbnRUb0xpbmUsXG4gICAgZ2V0UG9pbnRTdGF0ZXMsXG4gICAgaW50ZXJuYWwsXG4gICAgbWl4RnJpY3Rpb24sXG4gICAgbWl4UmVzdGl0dXRpb24sXG4gICAgc3RhdHMsXG4gICAgdGVzdE92ZXJsYXAsXG4gICAgdGVzdGJlZFxuICB9LCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6IFwiTW9kdWxlXCIgfSkpO1xuICBleHBvcnRzMi5BQUJCID0gQUFCQjtcbiAgZXhwb3J0czIuQm9keSA9IEJvZHk7XG4gIGV4cG9ydHMyLkJveCA9IEJveFNoYXBlO1xuICBleHBvcnRzMi5Cb3hTaGFwZSA9IEJveFNoYXBlO1xuICBleHBvcnRzMi5Ccm9hZFBoYXNlID0gQnJvYWRQaGFzZTtcbiAgZXhwb3J0czIuQ2hhaW4gPSBDaGFpblNoYXBlO1xuICBleHBvcnRzMi5DaGFpblNoYXBlID0gQ2hhaW5TaGFwZTtcbiAgZXhwb3J0czIuQ2lyY2xlID0gQ2lyY2xlU2hhcGU7XG4gIGV4cG9ydHMyLkNpcmNsZVNoYXBlID0gQ2lyY2xlU2hhcGU7XG4gIGV4cG9ydHMyLkNsaXBWZXJ0ZXggPSBDbGlwVmVydGV4O1xuICBleHBvcnRzMi5Db2xsaWRlQ2lyY2xlcyA9IENvbGxpZGVDaXJjbGVzO1xuICBleHBvcnRzMi5Db2xsaWRlRWRnZUNpcmNsZSA9IENvbGxpZGVFZGdlQ2lyY2xlO1xuICBleHBvcnRzMi5Db2xsaWRlRWRnZVBvbHlnb24gPSBDb2xsaWRlRWRnZVBvbHlnb247XG4gIGV4cG9ydHMyLkNvbGxpZGVQb2x5Z29uQ2lyY2xlID0gQ29sbGlkZVBvbHlnb25DaXJjbGU7XG4gIGV4cG9ydHMyLkNvbGxpZGVQb2x5Z29ucyA9IENvbGxpZGVQb2x5Z29ucztcbiAgZXhwb3J0czIuQ29udGFjdCA9IENvbnRhY3Q7XG4gIGV4cG9ydHMyLkNvbnRhY3RFZGdlID0gQ29udGFjdEVkZ2U7XG4gIGV4cG9ydHMyLkNvbnRhY3RJRCA9IENvbnRhY3RJRDtcbiAgZXhwb3J0czIuQ29udGFjdEltcHVsc2UgPSBDb250YWN0SW1wdWxzZTtcbiAgZXhwb3J0czIuRGF0YURyaXZlciA9IERhdGFEcml2ZXI7XG4gIGV4cG9ydHMyLkRpc3RhbmNlID0gRGlzdGFuY2U7XG4gIGV4cG9ydHMyLkRpc3RhbmNlSW5wdXQgPSBEaXN0YW5jZUlucHV0O1xuICBleHBvcnRzMi5EaXN0YW5jZUpvaW50ID0gRGlzdGFuY2VKb2ludDtcbiAgZXhwb3J0czIuRGlzdGFuY2VPdXRwdXQgPSBEaXN0YW5jZU91dHB1dDtcbiAgZXhwb3J0czIuRGlzdGFuY2VQcm94eSA9IERpc3RhbmNlUHJveHk7XG4gIGV4cG9ydHMyLkR5bmFtaWNUcmVlID0gRHluYW1pY1RyZWU7XG4gIGV4cG9ydHMyLkVkZ2UgPSBFZGdlU2hhcGU7XG4gIGV4cG9ydHMyLkVkZ2VTaGFwZSA9IEVkZ2VTaGFwZTtcbiAgZXhwb3J0czIuRml4dHVyZSA9IEZpeHR1cmU7XG4gIGV4cG9ydHMyLkZpeHR1cmVQcm94eSA9IEZpeHR1cmVQcm94eTtcbiAgZXhwb3J0czIuRnJpY3Rpb25Kb2ludCA9IEZyaWN0aW9uSm9pbnQ7XG4gIGV4cG9ydHMyLkdlYXJKb2ludCA9IEdlYXJKb2ludDtcbiAgZXhwb3J0czIuSm9pbnQgPSBKb2ludDtcbiAgZXhwb3J0czIuSm9pbnRFZGdlID0gSm9pbnRFZGdlO1xuICBleHBvcnRzMi5NYW5pZm9sZCA9IE1hbmlmb2xkO1xuICBleHBvcnRzMi5NYW5pZm9sZFBvaW50ID0gTWFuaWZvbGRQb2ludDtcbiAgZXhwb3J0czIuTWF0MjIgPSBNYXQyMjtcbiAgZXhwb3J0czIuTWF0MzMgPSBNYXQzMztcbiAgZXhwb3J0czIuTWF0aCA9IG1hdGg7XG4gIGV4cG9ydHMyLk1vdG9ySm9pbnQgPSBNb3RvckpvaW50O1xuICBleHBvcnRzMi5Nb3VzZUpvaW50ID0gTW91c2VKb2ludDtcbiAgZXhwb3J0czIuUG9seWdvbiA9IFBvbHlnb25TaGFwZTtcbiAgZXhwb3J0czIuUG9seWdvblNoYXBlID0gUG9seWdvblNoYXBlO1xuICBleHBvcnRzMi5QcmlzbWF0aWNKb2ludCA9IFByaXNtYXRpY0pvaW50O1xuICBleHBvcnRzMi5QdWxsZXlKb2ludCA9IFB1bGxleUpvaW50O1xuICBleHBvcnRzMi5SZXZvbHV0ZUpvaW50ID0gUmV2b2x1dGVKb2ludDtcbiAgZXhwb3J0czIuUm9wZUpvaW50ID0gUm9wZUpvaW50O1xuICBleHBvcnRzMi5Sb3QgPSBSb3Q7XG4gIGV4cG9ydHMyLlNlcmlhbGl6ZXIgPSBTZXJpYWxpemVyO1xuICBleHBvcnRzMi5TZXR0aW5ncyA9IFNldHRpbmdzO1xuICBleHBvcnRzMi5TZXR0aW5nc0ludGVybmFsID0gU2V0dGluZ3NJbnRlcm5hbDtcbiAgZXhwb3J0czIuU2hhcGUgPSBTaGFwZTtcbiAgZXhwb3J0czIuU2hhcGVDYXN0ID0gU2hhcGVDYXN0O1xuICBleHBvcnRzMi5TaGFwZUNhc3RJbnB1dCA9IFNoYXBlQ2FzdElucHV0O1xuICBleHBvcnRzMi5TaGFwZUNhc3RPdXRwdXQgPSBTaGFwZUNhc3RPdXRwdXQ7XG4gIGV4cG9ydHMyLlNpbXBsZXhDYWNoZSA9IFNpbXBsZXhDYWNoZTtcbiAgZXhwb3J0czIuU29sdmVyID0gU29sdmVyO1xuICBleHBvcnRzMi5Td2VlcCA9IFN3ZWVwO1xuICBleHBvcnRzMi5UT0lJbnB1dCA9IFRPSUlucHV0O1xuICBleHBvcnRzMi5UT0lPdXRwdXQgPSBUT0lPdXRwdXQ7XG4gIGV4cG9ydHMyLlRlc3RiZWQgPSBUZXN0YmVkO1xuICBleHBvcnRzMi5UaW1lT2ZJbXBhY3QgPSBUaW1lT2ZJbXBhY3Q7XG4gIGV4cG9ydHMyLlRpbWVTdGVwID0gVGltZVN0ZXA7XG4gIGV4cG9ydHMyLlRyYW5zZm9ybSA9IFRyYW5zZm9ybTtcbiAgZXhwb3J0czIuVHJlZU5vZGUgPSBUcmVlTm9kZTtcbiAgZXhwb3J0czIuVmVjMiA9IFZlYzI7XG4gIGV4cG9ydHMyLlZlYzMgPSBWZWMzO1xuICBleHBvcnRzMi5WZWxvY2l0eUNvbnN0cmFpbnRQb2ludCA9IFZlbG9jaXR5Q29uc3RyYWludFBvaW50O1xuICBleHBvcnRzMi5XZWxkSm9pbnQgPSBXZWxkSm9pbnQ7XG4gIGV4cG9ydHMyLldoZWVsSm9pbnQgPSBXaGVlbEpvaW50O1xuICBleHBvcnRzMi5Xb3JsZCA9IFdvcmxkO1xuICBleHBvcnRzMi5Xb3JsZE1hbmlmb2xkID0gV29ybGRNYW5pZm9sZDtcbiAgZXhwb3J0czIuY2xpcFNlZ21lbnRUb0xpbmUgPSBjbGlwU2VnbWVudFRvTGluZTtcbiAgZXhwb3J0czIuZGVmYXVsdCA9IHBsYW5jaztcbiAgZXhwb3J0czIuZ2V0UG9pbnRTdGF0ZXMgPSBnZXRQb2ludFN0YXRlcztcbiAgZXhwb3J0czIuaW50ZXJuYWwgPSBpbnRlcm5hbDtcbiAgZXhwb3J0czIubWl4RnJpY3Rpb24gPSBtaXhGcmljdGlvbjtcbiAgZXhwb3J0czIubWl4UmVzdGl0dXRpb24gPSBtaXhSZXN0aXR1dGlvbjtcbiAgZXhwb3J0czIuc3RhdHMgPSBzdGF0cztcbiAgZXhwb3J0czIudGVzdE92ZXJsYXAgPSB0ZXN0T3ZlcmxhcDtcbiAgZXhwb3J0czIudGVzdGJlZCA9IHRlc3RiZWQ7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMyLCB7IF9fZXNNb2R1bGU6IHsgdmFsdWU6IHRydWUgfSwgW1N5bWJvbC50b1N0cmluZ1RhZ106IHsgdmFsdWU6IFwiTW9kdWxlXCIgfSB9KTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGxhbmNrLmpzLm1hcFxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBBc3NldCB9IGZyb20gJy4uJztcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJy4vZXZlbnQtc3lzdGVtJztcblxuLyoqIEV2ZW50cyBlbWl0dGVkIGJ5IEFzc2V0TG9hZGVyLiAqL1xuZXhwb3J0IGludGVyZmFjZSBBc3NldExvYWRlckV2ZW50cyBleHRlbmRzIFJlY29yZDxzdHJpbmcsICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZD4ge1xuICAnbG9hZGluZzpzdGFydCc6ICgpID0+IHZvaWQ7XG4gICdsb2FkaW5nOmVuZCc6ICgpID0+IHZvaWQ7XG59XG5cbi8qKlxuICogV3JhcHBlciBhcm91bmQgUElYSS5Bc3NldHMgd2l0aCBsb2FkaW5nIGV2ZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIGNvbnN0IHsgbG9hZEFzc2V0cywgUElYSUFzc2V0cyB9ID0gYXdhaXQgc2V0dXBNb3hpKHsuLi59KTtcbiAqXG4gKiBhd2FpdCBsb2FkQXNzZXRzKFtcbiAqICAgeyBzcmM6ICcuL3BsYXllci5wbmcnLCBhbGlhczogJ3BsYXllcicgfSxcbiAqICAgeyBzcmM6ICcuL2VuZW15LnBuZycsIGFsaWFzOiAnZW5lbXknIH1cbiAqIF0pO1xuICpcbiAqIGNvbnN0IHRleHR1cmUgPSBQSVhJQXNzZXRzLmdldCgncGxheWVyJyk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIEFzc2V0TG9hZGVyIHtcbiAgLyoqIFBJWEkuQXNzZXRzIGluc3RhbmNlLiBVc2UgLmdldChhbGlhcykgdG8gcmV0cmlldmUgbG9hZGVkIHRleHR1cmVzLiAqL1xuICBQSVhJQXNzZXRzOiBQSVhJLkFzc2V0c0NsYXNzID0gUElYSS5Bc3NldHM7XG5cbiAgLyoqIEFsbCBsb2FkZWQgdGV4dHVyZXMuICovXG4gIHRleHR1cmVzOiBQSVhJLlRleHR1cmVbXSA9IFtdO1xuXG4gIC8qKiBUcnVlIHdoaWxlIGxvYWRpbmcgaW4gcHJvZ3Jlc3MuICovXG4gIGlzTG9hZGluZzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHByaXZhdGUgZXZlbnRzOiBFdmVudEVtaXR0ZXI8QXNzZXRMb2FkZXJFdmVudHM+ID0gbmV3IEV2ZW50RW1pdHRlcjxBc3NldExvYWRlckV2ZW50cz4oKTtcblxuICAvKiogU3Vic2NyaWJlIHRvICdsb2FkaW5nOnN0YXJ0JyBvciAnbG9hZGluZzplbmQnIGV2ZW50cy4gKi9cbiAgb248SyBleHRlbmRzIGtleW9mIEFzc2V0TG9hZGVyRXZlbnRzPihldmVudDogSywgbGlzdGVuZXI6IEFzc2V0TG9hZGVyRXZlbnRzW0tdKTogdm9pZCB7XG4gICAgdGhpcy5ldmVudHMub24oZXZlbnQsIGxpc3RlbmVyKTtcbiAgfVxuXG4gIC8qKiBVbnN1YnNjcmliZSBmcm9tIGV2ZW50cy4gKi9cbiAgb2ZmPEsgZXh0ZW5kcyBrZXlvZiBBc3NldExvYWRlckV2ZW50cz4oZXZlbnQ6IEssIGxpc3RlbmVyOiBBc3NldExvYWRlckV2ZW50c1tLXSk6IHZvaWQge1xuICAgIHRoaXMuZXZlbnRzLm9mZihldmVudCwgbGlzdGVuZXIpO1xuICB9XG5cbiAgbG9hZEFzc2V0cyA9IGFzeW5jIChhc3NldHM6IEFzc2V0W10pID0+IHtcbiAgICBjb25zdCB7IFBJWElBc3NldHMgfSA9IHRoaXM7XG4gICAgY29uc3QgZmFpbGVkQXNzZXRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLy8gRW1pdCBsb2FkaW5nIHN0YXJ0IGV2ZW50XG4gICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuICAgIHRoaXMuZXZlbnRzLmVtaXQoJ2xvYWRpbmc6c3RhcnQnKTtcblxuICAgIHRyeSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFzc2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCB7IHNyYywgYWxpYXMgfSA9IGFzc2V0c1tpXTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmIChhbGlhcykge1xuICAgICAgICAgICAgaWYgKCFQSVhJQXNzZXRzLmNhY2hlLmhhcyhhbGlhcykpIHtcbiAgICAgICAgICAgICAgY29uc3QgdGV4dHVyZSA9IGF3YWl0IFBJWElBc3NldHMubG9hZCh7IGFsaWFzLCBzcmMgfSk7XG4gICAgICAgICAgICAgIHRoaXMudGV4dHVyZXMucHVzaCh0ZXh0dXJlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdGV4dHVyZSA9IGF3YWl0IFBJWElBc3NldHMubG9hZChzcmMpO1xuICAgICAgICAgICAgdGhpcy50ZXh0dXJlcy5wdXNoKHRleHR1cmUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gbG9hZCBhc3NldDogJHtzcmN9YCwgZXJyb3IpO1xuICAgICAgICAgIGZhaWxlZEFzc2V0cy5wdXNoKHNyYyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGZhaWxlZEFzc2V0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgJHtmYWlsZWRBc3NldHMubGVuZ3RofSBhc3NldChzKSBmYWlsZWQgdG8gbG9hZDpgLCBmYWlsZWRBc3NldHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9IGZpbmFsbHkge1xuICAgICAgLy8gRW1pdCBsb2FkaW5nIGVuZCBldmVudFxuICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuZXZlbnRzLmVtaXQoJ2xvYWRpbmc6ZW5kJyk7XG4gICAgfVxuICB9O1xufSIsImltcG9ydCBQSVhJLCB7IFBvaW50IH0gZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4vbG9naWMnO1xuaW1wb3J0IHsgU2NlbmUgfSBmcm9tICcuL3NjZW5lJztcbmltcG9ydCB7IEFzRW50aXR5LCBNb3hpTG9naWMsIE1veGlFbnRpdHkgfSBmcm9tICcuL21veGktZW50aXR5JztcbmltcG9ydCB7IGxlcnAgfSBmcm9tICcuLi9saWJyYXJ5L3V0aWxzJztcblxuLyoqXG4gKiBMb2dpYyBoYW5kbGluZyBjYW1lcmEgZm9sbG93aW5nIGFuZCBzbW9vdGggdHJhbnNpdGlvbnMuXG4gKiBBdHRhY2hlZCBhdXRvbWF0aWNhbGx5IHRvIENhbWVyYS4gQWNjZXNzIHZpYSBjYW1lcmEubW94aUVudGl0eS5nZXRMb2dpYygnQ2FtZXJhTG9naWMnKS5cbiAqL1xuZXhwb3J0IGNsYXNzIENhbWVyYUxvZ2ljIGV4dGVuZHMgTG9naWM8UElYSS5Db250YWluZXI+IHtcbiAgbmFtZSA9ICdDYW1lcmFMb2dpYyc7XG5cbiAgLyoqIEludGVycG9sYXRpb24gc3BlZWQgKDAtMSkuIEhpZ2hlciA9IHNuYXBwaWVyLiAqL1xuICBwdWJsaWMgc3BlZWQ6IG51bWJlciA9IDAuMTtcblxuICAvKiogRW50aXR5IHRvIGZvbGxvdy4gU2V0IHRvIGVuYWJsZSB0cmFja2luZy4gKi9cbiAgcHVibGljIHRhcmdldDogUElYSS5Db250YWluZXIgPSBudWxsO1xuXG4gIGVudGl0eTogUElYSS5Db250YWluZXI8UElYSS5Db250YWluZXJDaGlsZD47XG4gIHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyPEhUTUxDYW52YXNFbGVtZW50PjtcblxuICBpbml0KGVudGl0eTogUElYSS5Db250YWluZXIsIHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyKSB7XG4gICAgdGhpcy5lbnRpdHkgPSBlbnRpdHk7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCBTbW9vdGhseSB1cGRhdGVzIGNhbWVyYSBwb3NpdGlvbi9zY2FsZSBlYWNoIGZyYW1lLiAqL1xuICB1cGRhdGUoZW50aXR5OiBDYW1lcmEsIGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgY29uc3QgeyBzcGVlZCB9ID0gdGhpcztcbiAgICBjb25zdCBkZWx0YVNwZWVkID0gTWF0aC5taW4oZGVsdGFUaW1lICogc3BlZWQsIDEpO1xuXG4gICAgLy8gVHJhY2sgaWYgc2NhbGUgaXMgYWN0aXZlbHkgY2hhbmdpbmcgKHpvb21pbmcpXG4gICAgY29uc3QgaXNab29taW5nID0gTWF0aC5hYnMoZW50aXR5LnNjYWxlLnggLSBlbnRpdHkuZGVzaXJlZFNjYWxlLngpID4gMC4wMSB8fFxuICAgICAgICAgICAgICAgICAgICAgIE1hdGguYWJzKGVudGl0eS5zY2FsZS55IC0gZW50aXR5LmRlc2lyZWRTY2FsZS55KSA+IDAuMDE7XG5cbiAgICAvLyBJbnRlcnBvbGF0ZSBzY2FsZSB2YWx1ZXMgZmlyc3RcbiAgICBpZiAoZW50aXR5LmRlc2lyZWRTY2FsZSAhPT0gZW50aXR5LnNjYWxlKSB7XG4gICAgICBlbnRpdHkuc2NhbGUueCA9IGxlcnAoZW50aXR5LnNjYWxlLngsIGVudGl0eS5kZXNpcmVkU2NhbGUueCwgZGVsdGFTcGVlZCk7XG4gICAgICBlbnRpdHkuc2NhbGUueSA9IGxlcnAoZW50aXR5LnNjYWxlLnksIGVudGl0eS5kZXNpcmVkU2NhbGUueSwgZGVsdGFTcGVlZCk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGRlc2lyZWQgcG9zaXRpb24gaWYgY2FtZXJhIGhhcyBhIHRhcmdldFxuICAgIGlmICh0aGlzLnRhcmdldCkge1xuICAgICAgLy8gSW4gYSBQSVhJLmpzIGNhbWVyYSBzeXN0ZW0sIHdlIG5lZWQgdG8gcG9zaXRpb24gdGhlIGNhbWVyYSAoc2NlbmUpXG4gICAgICAvLyBzbyB0aGF0IHRoZSB0YXJnZXQgYXBwZWFycyBjZW50ZXJlZCBpbiB0aGUgdmlld3BvcnRcblxuICAgICAgLy8gR2V0IHRoZSBjZW50ZXIgb2YgdGhlIHZpZXdwb3J0IGluIHNjcmVlbiBjb29yZGluYXRlc1xuICAgICAgY29uc3Qgc2NyZWVuQ2VudGVyWCA9IHRoaXMucmVuZGVyZXIud2lkdGggLyAyO1xuICAgICAgY29uc3Qgc2NyZWVuQ2VudGVyWSA9IHRoaXMucmVuZGVyZXIuaGVpZ2h0IC8gMjtcblxuICAgICAgLy8gQ2FsY3VsYXRlIHdoZXJlIHRoZSBzY2VuZSBzaG91bGQgYmUgcG9zaXRpb25lZFxuICAgICAgLy8gVGhlIGZvcm11bGEgaXM6IC0odGFyZ2V0UG9zaXRpb24gKiBzY2FsZSkgKyBzY3JlZW5DZW50ZXJcbiAgICAgIC8vIFRoaXMgZW5zdXJlcyB0aGUgdGFyZ2V0IGlzIGF0IHRoZSBjZW50ZXIgb2YgdGhlIHNjcmVlblxuICAgICAgY29uc3QgZGVzaXJlZFggPSAtKHRoaXMudGFyZ2V0LnBvc2l0aW9uLnggKiBlbnRpdHkuc2NhbGUueCkgKyBzY3JlZW5DZW50ZXJYO1xuICAgICAgY29uc3QgZGVzaXJlZFkgPSAtKHRoaXMudGFyZ2V0LnBvc2l0aW9uLnkgKiBlbnRpdHkuc2NhbGUueSkgKyBzY3JlZW5DZW50ZXJZO1xuXG4gICAgICAvLyBTZXQgZGVzaXJlZCBwb3NpdGlvbiBmb3IgdGhlIHNjZW5lICh1c2luZyBuZWdhdGl2ZSB2YWx1ZXMgZm9yIGNhbWVyYSBjb29yZGluYXRlcylcbiAgICAgIGVudGl0eS5kZXNpcmVkUG9zaXRpb24uc2V0KC1kZXNpcmVkWCwgLWRlc2lyZWRZKTtcbiAgICB9XG5cbiAgICAvLyBJbnRlcnBvbGF0ZSBwb3NpdGlvbiB2YWx1ZXNcbiAgICAvLyBXaGVuIGFjdGl2ZWx5IHpvb21pbmcsIHVwZGF0ZSBwb3NpdGlvbiBpbnN0YW50bHkgdG8ga2VlcCB0YXJnZXQgY2VudGVyZWRcbiAgICAvLyBPdGhlcndpc2UsIGludGVycG9sYXRlIHNtb290aGx5IGZvciBjYW1lcmEgZm9sbG93aW5nXG4gICAgaWYgKGVudGl0eS5kZXNpcmVkUG9zaXRpb24gIT09IGVudGl0eS5wb3NpdGlvbikge1xuICAgICAgaWYgKGlzWm9vbWluZykge1xuICAgICAgICAvLyBJbnN0YW50IHBvc2l0aW9uIHVwZGF0ZSBkdXJpbmcgem9vbSB0byBwcmV2ZW50IHRhcmdldCBkcmlmdFxuICAgICAgICBlbnRpdHkucG9zaXRpb24uY29weUZyb20oZW50aXR5LmRlc2lyZWRQb3NpdGlvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBTbW9vdGggaW50ZXJwb2xhdGlvbiBmb3Igbm9ybWFsIGNhbWVyYSBmb2xsb3dpbmdcbiAgICAgICAgZW50aXR5LnBvc2l0aW9uLnggPSBsZXJwKGVudGl0eS5wb3NpdGlvbi54LCBlbnRpdHkuZGVzaXJlZFBvc2l0aW9uLngsIGRlbHRhU3BlZWQpO1xuICAgICAgICBlbnRpdHkucG9zaXRpb24ueSA9IGxlcnAoZW50aXR5LnBvc2l0aW9uLnksIGVudGl0eS5kZXNpcmVkUG9zaXRpb24ueSwgZGVsdGFTcGVlZCk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEFwcGx5IGNhbWVyYSB0cmFuc2Zvcm1hdGlvbnMgdG8gdGhlIHNjZW5lXG4gICAgLy8gSW4gUElYSSwgdGhlIFwiY2FtZXJhXCIgZWZmZWN0IGlzIGNyZWF0ZWQgYnkgdHJhbnNmb3JtaW5nIHRoZSBzY2VuZSBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uXG4gICAgZW50aXR5LnNjZW5lLnNjYWxlLnNldChlbnRpdHkuc2NhbGUueCwgZW50aXR5LnNjYWxlLnkpO1xuXG4gICAgLy8gUG9zaXRpb24gdGhlIHNjZW5lIGF0IHRoZSBuZWdhdGl2ZSBvZiB0aGUgY2FtZXJhIHBvc2l0aW9uIHRvIGNyZWF0ZSBjYW1lcmEgbW92ZW1lbnQgZWZmZWN0XG4gICAgZW50aXR5LnNjZW5lLnBvc2l0aW9uLnNldCgtZW50aXR5LnBvc2l0aW9uLngsIC1lbnRpdHkucG9zaXRpb24ueSk7XG4gIH1cbn1cblxuLyoqXG4gKiBWaWV3cG9ydCBjYW1lcmEgd2l0aCBzbW9vdGggZm9sbG93aW5nIGFuZCB6b29tLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3QgeyBjYW1lcmEgfSA9IGF3YWl0IHNldHVwTW94aSh7Li4ufSk7XG4gKlxuICogLy8gRm9sbG93IGEgdGFyZ2V0XG4gKiBjYW1lcmEubW94aUVudGl0eS5nZXRMb2dpYzxDYW1lcmFMb2dpYz4oJ0NhbWVyYUxvZ2ljJykudGFyZ2V0ID0gcGxheWVyO1xuICpcbiAqIC8vIFpvb20gdG8gMnhcbiAqIGNhbWVyYS5kZXNpcmVkU2NhbGUuc2V0KDIsIDIpO1xuICpcbiAqIC8vIFBhbiB0byBwb3NpdGlvblxuICogY2FtZXJhLmRlc2lyZWRQb3NpdGlvbi5zZXQoNTAwLCAzMDApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBDYW1lcmEgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lciBpbXBsZW1lbnRzIEFzRW50aXR5PFBJWEkuQ29udGFpbmVyPiB7XG4gIC8qKiBTY2VuZSBiZWluZyB2aWV3ZWQuICovXG4gIHB1YmxpYyBzY2VuZTogU2NlbmU7XG5cbiAgLyoqIFJlbmRlcmVyIHJlZmVyZW5jZS4gKi9cbiAgcHVibGljIHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyO1xuXG4gIC8qKiBUcmFuc2l0aW9uIHNwZWVkICgwLTEpLiAqL1xuICBwdWJsaWMgc3BlZWQ6IG51bWJlciA9IDAuMTtcblxuICAvKiogTW94aUVudGl0eSBmb3IgYXR0YWNoaW5nIGxvZ2ljLiAqL1xuICBwdWJsaWMgbW94aUVudGl0eTogTW94aUVudGl0eTxQSVhJLkNvbnRhaW5lcj47XG5cbiAgLyoqIFRhcmdldCB6b29tIGxldmVsLiBTZXQgdG8gYW5pbWF0ZSB6b29tLiAqL1xuICBwdWJsaWMgZGVzaXJlZFNjYWxlOiBQb2ludCA9IG5ldyBQb2ludCgxLCAxKTtcblxuICAvKiogVGFyZ2V0IHBvc2l0aW9uLiBTZXQgdG8gYW5pbWF0ZSBwYW4uICovXG4gIHB1YmxpYyBkZXNpcmVkUG9zaXRpb246IFBvaW50ID0gbmV3IFBvaW50KDAsIDApO1xuXG4gIGNvbnN0cnVjdG9yKHNjZW5lOiBTY2VuZSwgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXIsIGxvZ2ljOiBNb3hpTG9naWM8UElYSS5Db250YWluZXI+ID0ge30pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuc2NlbmUgPSBzY2VuZTtcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG5cbiAgICAvLyBJbml0aWFsaXplIGFuZCBhdHRhY2ggdGhlIGNhbWVyYSBsb2dpY1xuICAgIGNvbnN0IGNhbWVyYUxvZ2ljID0gbmV3IENhbWVyYUxvZ2ljKCk7XG4gICAgY2FtZXJhTG9naWMuaW5pdCh0aGlzLCByZW5kZXJlcik7XG4gICAgdGhpcy5tb3hpRW50aXR5ID0gbmV3IE1veGlFbnRpdHk8UElYSS5Db250YWluZXI+KHRoaXMsIGxvZ2ljKTtcbiAgICB0aGlzLm1veGlFbnRpdHkuYWRkTG9naWMoY2FtZXJhTG9naWMpO1xuICAgIHRoaXMuc2NlbmUuYWRkQ2hpbGQodGhpcyk7XG4gIH1cbn0gIFxuXG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFNjZW5lIH0gZnJvbSAnLi9zY2VuZSc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NXb3JsZCB9IGZyb20gJy4uL2xpYnJhcnkvcGh5c2ljcyc7XG5cbi8qKlxuICogR2FtZSBsb29wIG1hbmFnZXIuIERyaXZlcyBzY2VuZSB1cGRhdGVzIGFuZCByZW5kZXJpbmcgdmlhIFBJWEkuVGlja2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3QgZW5naW5lID0gbmV3IEVuZ2luZShzY2VuZSk7XG4gKiBlbmdpbmUuc3RhcnQoKTsgIC8vIEJlZ2luIGdhbWUgbG9vcFxuICogZW5naW5lLnN0b3AoKTsgICAvLyBQYXVzZSBnYW1lIGxvb3BcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgRW5naW5lIHtcbiAgLyoqIFBJWEkuVGlja2VyIGRyaXZpbmcgdGhlIGdhbWUgbG9vcC4gKi9cbiAgdGlja2VyOiBQSVhJLlRpY2tlcjtcblxuICAvKiogQWN0aXZlIHNjZW5lIGJlaW5nIHVwZGF0ZWQvcmVuZGVyZWQuICovXG4gIHJvb3Q6IFNjZW5lO1xuXG4gIC8qKiBQaHlzaWNzIHdvcmxkIChpZiBlbmFibGVkIHZpYSBzZXR1cE1veGkpLiAqL1xuICBwaHlzaWNzV29ybGQ/OiBQaHlzaWNzV29ybGQ7XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBsb2dnZXI6IChtc2c6IHN0cmluZykgPT4gdm9pZDtcbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBsb2dnZXJGcmVxdWVuY3lNczogbnVtYmVyO1xuICAvKiogQGludGVybmFsICovXG4gIG5leHRMb2dUaW1lOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3Ioc3RhZ2U6IFNjZW5lID0gbnVsbCkge1xuICAgIHRoaXMucm9vdCA9IHN0YWdlO1xuXG4gICAgY29uc3QgdGlja2VyID0gUElYSS5UaWNrZXIuc2hhcmVkO1xuICAgIHRpY2tlci5hdXRvU3RhcnQgPSBmYWxzZTtcbiAgICB0aWNrZXIuYWRkKHRoaXMuZ2FtZUxvb3ApO1xuICAgIHRoaXMudGlja2VyID0gdGlja2VyO1xuXG4gICAgdGhpcy5sb2dnZXJGcmVxdWVuY3lNcyA9IDUwMDtcbiAgICB0aGlzLm5leHRMb2dUaW1lID0gMDtcbiAgICB0aGlzLmxvZ2dlciA9IChtc2cpID0+IG51bGw7XG4gIH1cblxuICAvKiogU3RhcnQgdGhlIGdhbWUgbG9vcC4gKi9cbiAgc3RhcnQoKSB7XG4gICAgdGhpcy50aWNrZXIuc3RhcnQoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKiBTdG9wL3BhdXNlIHRoZSBnYW1lIGxvb3AuICovXG4gIHN0b3AoKSB7XG4gICAgdGhpcy50aWNrZXIuc3RvcCgpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqIEF0dGFjaCBwaHlzaWNzIHdvcmxkLiBDYWxsZWQgYXV0b21hdGljYWxseSBieSBzZXR1cE1veGkgaWYgcGh5c2ljcyBlbmFibGVkLiAqL1xuICBhZGRQaHlzaWNzV29ybGQocGh5c2ljc1dvcmxkOiBQaHlzaWNzV29ybGQpIHtcbiAgICB0aGlzLnBoeXNpY3NXb3JsZCA9IHBoeXNpY3NXb3JsZDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgTWFpbiBsb29wOiBwaHlzaWNzIHN0ZXAgLT4gc2NlbmUgdXBkYXRlIC0+IHJlbmRlci4gKi9cbiAgZ2FtZUxvb3AgPSAodGlrZXJUaW1lOiBQSVhJLlRpY2tlcikgPT4ge1xuICAgIGlmICh0aGlzLnJvb3QpIHtcbiAgICAgIGNvbnN0IHsgZGVsdGFUaW1lLCBkZWx0YU1TIH0gPSB0aWtlclRpbWU7XG5cbiAgICAgIGlmICh0aGlzLnBoeXNpY3NXb3JsZCkge1xuICAgICAgICBjb25zdCBkZWx0YVNlY29uZHMgPSBkZWx0YU1TIC8gMTAwMDtcbiAgICAgICAgdGhpcy5waHlzaWNzV29ybGQuc3RlcChkZWx0YVNlY29uZHMpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnJvb3QudXBkYXRlKGRlbHRhVGltZSk7XG4gICAgICB0aGlzLnJvb3QuZHJhdyhkZWx0YVRpbWUpO1xuICAgIH1cbiAgfTtcblxuICAvKiogU3dpdGNoIHRvIGEgZGlmZmVyZW50IHNjZW5lLiAqL1xuICBsb2FkU3RhZ2Uoc3RhZ2U6IFNjZW5lKSB7XG4gICAgdGhpcy5yb290ID0gc3RhZ2U7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn1cbiIsInR5cGUgTW94aUV2ZW50czxUIGV4dGVuZHMgc3RyaW5nIHwgc3ltYm9sID0gc3RyaW5nLCBBID0gYW55PiA9IHtcbiAgW2V2ZW50IGluIFRdOiAoLi4uYXJnczogQSBleHRlbmRzIGFueVtdID8gQSA6IFtBXSkgPT4gdm9pZDtcbn07XG5cbi8qKlxuICogVHlwZS1zYWZlIGV2ZW50IGVtaXR0ZXIgZm9yIHB1Yi9zdWIgY29tbXVuaWNhdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIC8vIERlZmluZSBldmVudCB0eXBlc1xuICogdHlwZSBHYW1lRXZlbnRzID0ge1xuICogICAncGxheWVyOmhpdCc6IChkYW1hZ2U6IG51bWJlcikgPT4gdm9pZDtcbiAqICAgJ2dhbWU6b3Zlcic6ICgpID0+IHZvaWQ7XG4gKiAgICdzY29yZTpjaGFuZ2UnOiAoc2NvcmU6IG51bWJlciwgY29tYm86IG51bWJlcikgPT4gdm9pZDtcbiAqIH07XG4gKlxuICogY29uc3QgZXZlbnRzID0gbmV3IEV2ZW50RW1pdHRlcjxHYW1lRXZlbnRzPigpO1xuICpcbiAqIC8vIFN1YnNjcmliZVxuICogZXZlbnRzLm9uKCdwbGF5ZXI6aGl0JywgKGRtZykgPT4gY29uc29sZS5sb2coYEhpdCBmb3IgJHtkbWd9YCkpO1xuICogZXZlbnRzLm9uY2UoJ2dhbWU6b3ZlcicsICgpID0+IHNob3dHYW1lT3ZlcigpKTtcbiAqXG4gKiAvLyBFbWl0XG4gKiBldmVudHMuZW1pdCgncGxheWVyOmhpdCcsIDEwKTtcbiAqIGV2ZW50cy5lbWl0KCdzY29yZTpjaGFuZ2UnLCAxMDAsIDMpO1xuICpcbiAqIC8vIFVuc3Vic2NyaWJlXG4gKiBldmVudHMub2ZmKCdwbGF5ZXI6aGl0JywgaGFuZGxlcik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIEV2ZW50RW1pdHRlcjxUIGV4dGVuZHMgTW94aUV2ZW50cyA9IE1veGlFdmVudHM+IHtcbiAgcHJpdmF0ZSBsaXN0ZW5lcnM6IHsgW0sgaW4ga2V5b2YgVF0/OiBUW0tdW10gfSA9IHt9O1xuICAvKiogQGludGVybmFsICovXG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBFdmVudEVtaXR0ZXI8TW94aUV2ZW50cz4gfCBudWxsID0gbnVsbDtcblxuICAvKiogU3Vic2NyaWJlIHRvIGV2ZW50LiAqL1xuICBvbjxLIGV4dGVuZHMga2V5b2YgVD4oZXZlbnQ6IEssIGxpc3RlbmVyOiBUW0tdKTogdm9pZCB7XG4gICAgKHRoaXMubGlzdGVuZXJzW2V2ZW50XSB8fCAodGhpcy5saXN0ZW5lcnNbZXZlbnRdID0gW10pKS5wdXNoKGxpc3RlbmVyKTtcbiAgfVxuXG4gIC8qKiBVbnN1YnNjcmliZSBmcm9tIGV2ZW50LiAqL1xuICBvZmY8SyBleHRlbmRzIGtleW9mIFQ+KGV2ZW50OiBLLCBsaXN0ZW5lcjogVFtLXSk6IHZvaWQge1xuICAgIGNvbnN0IGV2ZW50TGlzdGVuZXJzID0gdGhpcy5saXN0ZW5lcnNbZXZlbnRdO1xuICAgIGlmIChldmVudExpc3RlbmVycykge1xuICAgICAgdGhpcy5saXN0ZW5lcnNbZXZlbnRdID0gZXZlbnRMaXN0ZW5lcnMuZmlsdGVyKGwgPT4gbCAhPT0gbGlzdGVuZXIpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBFbWl0IGV2ZW50IHRvIGFsbCBsaXN0ZW5lcnMuICovXG4gIGVtaXQ8SyBleHRlbmRzIGtleW9mIFQ+KGV2ZW50OiBLLCAuLi5hcmdzOiBQYXJhbWV0ZXJzPFRbS10+KTogdm9pZCB7XG4gICAgKHRoaXMubGlzdGVuZXJzW2V2ZW50XSB8fCBbXSkuZm9yRWFjaChsaXN0ZW5lciA9PiBsaXN0ZW5lciguLi5hcmdzKSk7XG4gIH1cblxuICAvKiogU3Vic2NyaWJlIG9uY2UsIGF1dG8tdW5zdWJzY3JpYmUgYWZ0ZXIgZmlyc3QgZW1pdC4gKi9cbiAgb25jZTxLIGV4dGVuZHMga2V5b2YgVD4oZXZlbnQ6IEssIGxpc3RlbmVyOiBUW0tdKTogdm9pZCB7XG4gICAgY29uc3Qgb25jZUxpc3RlbmVyID0gKC4uLmFyZ3M6IFBhcmFtZXRlcnM8VFtLXT4pID0+IHtcbiAgICAgIGxpc3RlbmVyKC4uLmFyZ3MpO1xuICAgICAgdGhpcy5vZmYoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICB9O1xuICAgIHRoaXMub24oZXZlbnQsIG9uY2VMaXN0ZW5lciBhcyBUW0tdKTtcbiAgfVxuXG4gIC8qKiBHZXQgc2luZ2xldG9uIGluc3RhbmNlLiAqL1xuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlPFQgZXh0ZW5kcyBNb3hpRXZlbnRzID0gTW94aUV2ZW50cz4oKTogRXZlbnRFbWl0dGVyPFQ+IHtcbiAgICBpZiAoIUV2ZW50RW1pdHRlci5pbnN0YW5jZSkge1xuICAgICAgRXZlbnRFbWl0dGVyLmluc3RhbmNlID0gbmV3IEV2ZW50RW1pdHRlcjxNb3hpRXZlbnRzPigpO1xuICAgIH1cbiAgICByZXR1cm4gRXZlbnRFbWl0dGVyLmluc3RhbmNlIGFzIEV2ZW50RW1pdHRlcjxUPjtcbiAgfVxufVxuXG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcblxuLyoqXG4gKiBCYXNlIGNsYXNzIGZvciBlbnRpdHkgYmVoYXZpb3IuIEV4dGVuZCB0byBhZGQgY3VzdG9tIGxvZ2ljLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY2xhc3MgTW92ZVJpZ2h0IGV4dGVuZHMgTG9naWM8UElYSS5TcHJpdGU+IHtcbiAqICAgc3BlZWQgPSAxMDA7XG4gKiAgIHVwZGF0ZShlbnRpdHksIGR0KSB7IGVudGl0eS54ICs9IHRoaXMuc3BlZWQgKiBkdDsgfVxuICogfVxuICpcbiAqIHNwcml0ZS5tb3hpRW50aXR5LmFkZExvZ2ljKG5ldyBNb3ZlUmlnaHQoKSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIExvZ2ljPFQ+IHtcbiAgLyoqIElkZW50aWZpZXIgZm9yIGdldExvZ2ljKCkuIERlZmF1bHRzIHRvIGNsYXNzIG5hbWUuICovXG4gIG5hbWU/OiBzdHJpbmc7XG5cbiAgLyoqIFNldCBmYWxzZSB0byBza2lwIHVwZGF0ZSgpIGNhbGxzLiAqL1xuICBhY3RpdmU6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIC8qKlxuICAgKiBDYWxsZWQgb25jZSB3aGVuIHNjZW5lLmluaXQoKSBpcyBpbnZva2VkLiBPdmVycmlkZSBmb3Igc2V0dXAuXG4gICAqIEBwYXJhbSBlbnRpdHkgLSBUaGUgUElYSSBvYmplY3QgdGhpcyBsb2dpYyBpcyBhdHRhY2hlZCB0b1xuICAgKiBAcGFyYW0gcmVuZGVyZXIgLSBUaGUgUElYSSByZW5kZXJlclxuICAgKiBAcGFyYW0gYXJncyAtIEFkZGl0aW9uYWwgYXJndW1lbnRzIHBhc3NlZCB0byBzY2VuZS5pbml0KClcbiAgICovXG4gIGluaXQoZW50aXR5PzogVCwgcmVuZGVyZXI/OiBQSVhJLlJlbmRlcmVyPEhUTUxDYW52YXNFbGVtZW50PiwgLi4uYXJnczogYW55W10pIHt9XG5cbiAgLyoqXG4gICAqIENhbGxlZCBldmVyeSBmcmFtZSB3aGlsZSBhY3RpdmUuIE92ZXJyaWRlIGZvciBiZWhhdmlvci5cbiAgICogQHBhcmFtIGVudGl0eSAtIFRoZSBQSVhJIG9iamVjdCB0aGlzIGxvZ2ljIGlzIGF0dGFjaGVkIHRvXG4gICAqIEBwYXJhbSBkZWx0YVRpbWUgLSBUaW1lIHNpbmNlIGxhc3QgZnJhbWUgaW4gZnJhbWVzICgxID0gMS82MHMgYXQgNjBmcHMpXG4gICAqL1xuICB1cGRhdGUoZW50aXR5PzogVCwgZGVsdGFUaW1lPzogbnVtYmVyKSB7fVxufVxuXG4vKipcbiAqIFNhbWUgYXMgTG9naWMgYnV0IHNlbWFudGljYWxseSBpbmRpY2F0ZXMgbXVsdGlwbGUgaW5zdGFuY2VzIGV4cGVjdGVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY2xhc3MgT3JiaXQgZXh0ZW5kcyBJbnN0YW5jZWRMb2dpYzxQSVhJLlNwcml0ZT4ge1xuICogICBjb25zdHJ1Y3RvcihwdWJsaWMgcmFkaXVzOiBudW1iZXIsIHB1YmxpYyBzcGVlZDogbnVtYmVyKSB7IHN1cGVyKCk7IH1cbiAqICAgdXBkYXRlKGVudGl0eSwgZHQpIHsgLyogb3JiaXQgbG9naWMgKlxcLyB9XG4gKiB9XG4gKlxuICogc3ByaXRlMS5tb3hpRW50aXR5LmFkZExvZ2ljKG5ldyBPcmJpdCg1MCwgMSkpO1xuICogc3ByaXRlMi5tb3hpRW50aXR5LmFkZExvZ2ljKG5ldyBPcmJpdCgxMDAsIDAuNSkpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnN0YW5jZWRMb2dpYzxUPiBleHRlbmRzIExvZ2ljPFQ+IHt9XG5cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgTG9naWMgfSBmcm9tICcuL2xvZ2ljJztcblxuLyoqIEBpbnRlcm5hbCAqL1xuaW50ZXJmYWNlIE1veGlFbnRpdHlDbGFzczxUPiB7XG4gIGxvZ2ljOiBNb3hpTG9naWM8VD47XG4gIHVwZGF0ZTogKGRlbHRhOiBudW1iZXIsIGVudGl0eTogVCkgPT4gdm9pZDtcbiAgaW5pdDogKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkO1xuICBhZGRMb2dpYzogKGxvZ2ljOiBMb2dpYzxUPikgPT4gdm9pZDtcbiAgZ2V0TG9naWM6IChuYW1lOiBzdHJpbmcpID0+IExvZ2ljPFQ+IHwgdW5kZWZpbmVkO1xufVxuXG4vKiogUElYSS5Db250YWluZXIgd2l0aCBhdHRhY2hlZCBNb3hpRW50aXR5IGZvciBsb2dpYyBtYW5hZ2VtZW50LiAqL1xuZXhwb3J0IHR5cGUgQXNFbnRpdHk8VD4gPSBQSVhJLkNvbnRhaW5lciAmIHtcbiAgbW94aUVudGl0eTogTW94aUVudGl0eTxUPjtcbn07XG5cbi8qKiBNYXAgb2YgbG9naWMgY29tcG9uZW50cyBieSBuYW1lLiAqL1xuZXhwb3J0IHR5cGUgTW94aUxvZ2ljPFQ+ID0gUmVjb3JkPHN0cmluZywgTG9naWM8VD4+O1xuXG4vKipcbiAqIE1hbmFnZXMgbG9naWMgY29tcG9uZW50cyBhdHRhY2hlZCB0byBhIFBJWEkgb2JqZWN0LlxuICogVXN1YWxseSBhY2Nlc3NlZCB2aWEgYGVudGl0eS5tb3hpRW50aXR5YCBhZnRlciBjYWxsaW5nIGBhc0VudGl0eSgpYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIGNvbnN0IHNwcml0ZSA9IGFzRW50aXR5KG5ldyBQSVhJLlNwcml0ZSh0ZXh0dXJlKSk7XG4gKiBzcHJpdGUubW94aUVudGl0eS5hZGRMb2dpYyhuZXcgTXlMb2dpYygpKTtcbiAqIHNwcml0ZS5tb3hpRW50aXR5LmdldExvZ2ljPE15TG9naWM+KCdNeUxvZ2ljJykuc3BlZWQgPSAxMDtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgTW94aUVudGl0eTxUPiBpbXBsZW1lbnRzIE1veGlFbnRpdHlDbGFzczxUPiB7XG4gIC8qKiBBdHRhY2hlZCBsb2dpYyBjb21wb25lbnRzIGtleWVkIGJ5IG5hbWUuICovXG4gIGxvZ2ljOiBNb3hpTG9naWM8VD4gPSB7fTtcblxuICAvKiogVGhlIFBJWEkgb2JqZWN0IHRoaXMgZW50aXR5IHdyYXBzLiAqL1xuICBlbnRpdHk6IFQ7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBlbnRpdHkgLSBUaGUgUElYSSBvYmplY3QgdG8gd3JhcFxuICAgKiBAcGFyYW0gbG9naWMgLSBPcHRpb25hbCBpbml0aWFsIGxvZ2ljIGNvbXBvbmVudHNcbiAgICovXG4gIGNvbnN0cnVjdG9yKGVudGl0eTogVCwgbG9naWM6IE1veGlMb2dpYzxUPiA9IHt9KSB7XG4gICAgdGhpcy5sb2dpYyA9IGxvZ2ljO1xuICAgIHRoaXMuZW50aXR5ID0gZW50aXR5O1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxzIHVwZGF0ZSgpIG9uIGFsbCBhY3RpdmUgbG9naWMgY29tcG9uZW50cy5cbiAgICogQ2FsbGVkIGF1dG9tYXRpY2FsbHkgYnkgU2NlbmUgZWFjaCBmcmFtZS5cbiAgICogQHBhcmFtIGRlbHRhVGltZSAtIFRpbWUgc2luY2UgbGFzdCBmcmFtZSBpbiBmcmFtZXMgKDEgPSAxLzYwcyBhdCA2MGZwcylcbiAgICovXG4gIHVwZGF0ZShkZWx0YVRpbWU6IG51bWJlcikge1xuICAgIGlmICghdGhpcy5lbnRpdHkpIHJldHVybjtcblxuICAgIGZvciAoY29uc3QgY2xhc3NOYW1lIGluIHRoaXMubG9naWMpIHtcbiAgICAgIGNvbnN0IGxvZ2ljQ29tcG9uZW50ID0gdGhpcy5sb2dpY1tjbGFzc05hbWVdO1xuICAgICAgaWYgKGxvZ2ljQ29tcG9uZW50ICYmIGxvZ2ljQ29tcG9uZW50LmFjdGl2ZSAmJiBsb2dpY0NvbXBvbmVudC51cGRhdGUpIHtcbiAgICAgICAgbG9naWNDb21wb25lbnQudXBkYXRlKHRoaXMuZW50aXR5LCBkZWx0YVRpbWUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxscyBpbml0KCkgb24gYWxsIGxvZ2ljIGNvbXBvbmVudHMuXG4gICAqIENhbGxlZCBhdXRvbWF0aWNhbGx5IHdoZW4gc2NlbmUuaW5pdCgpIGlzIGludm9rZWQuXG4gICAqIEBwYXJhbSByZW5kZXJlciAtIFRoZSBQSVhJIHJlbmRlcmVyXG4gICAqIEBwYXJhbSBhcmdzIC0gQWRkaXRpb25hbCBhcmd1bWVudHMgcGFzc2VkIHRocm91Z2ggdG8gbG9naWMuaW5pdCgpXG4gICAqL1xuICBpbml0KHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyPEhUTUxDYW52YXNFbGVtZW50PiwgLi4uYXJnczogYW55W10pIHtcbiAgICBpZiAoIXRoaXMuZW50aXR5KSByZXR1cm47XG5cbiAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBpbiB0aGlzLmxvZ2ljKSB7XG4gICAgICBjb25zdCBsb2dpY0NvbXBvbmVudCA9IHRoaXMubG9naWNbY2xhc3NOYW1lXTtcbiAgICAgIGlmIChsb2dpY0NvbXBvbmVudCAmJiBsb2dpY0NvbXBvbmVudC5pbml0KSB7XG4gICAgICAgIGxvZ2ljQ29tcG9uZW50LmluaXQodGhpcy5lbnRpdHksIHJlbmRlcmVyLCAuLi5hcmdzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXR0YWNoIGEgbG9naWMgY29tcG9uZW50IHRvIHRoaXMgZW50aXR5LlxuICAgKiBAcGFyYW0gbG9naWMgLSBUaGUgbG9naWMgY29tcG9uZW50IHRvIGF0dGFjaC4gVXNlcyBsb2dpYy5uYW1lIG9yIGNsYXNzIG5hbWUgYXMga2V5LlxuICAgKi9cbiAgYWRkTG9naWMobG9naWM6IExvZ2ljPFQ+KSB7XG4gICAgY29uc3QgbG9naWNOYW1lID0gbG9naWMubmFtZSB8fCBsb2dpYy5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgIHRoaXMubG9naWNbbG9naWNOYW1lXSA9IGxvZ2ljO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhIGxvZ2ljIGNvbXBvbmVudCBieSBuYW1lLlxuICAgKiBAcGFyYW0gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBsb2dpYyBjb21wb25lbnQgKGNsYXNzIG5hbWUgb3IgY3VzdG9tIG5hbWUpXG4gICAqIEByZXR1cm5zIFRoZSBsb2dpYyBjb21wb25lbnQsIG9yIHVuZGVmaW5lZCBpZiBub3QgZm91bmRcbiAgICovXG4gIGdldExvZ2ljPEwgZXh0ZW5kcyBMb2dpYzxUPj4obmFtZTogc3RyaW5nKTogTCB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMubG9naWNbbmFtZV0gYXMgTCB8IHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIENvbnZlcnQgYSBQSVhJLkNvbnRhaW5lciB0byBhbiBlbnRpdHkgd2l0aCBsb2dpYyBzdXBwb3J0LlxuICogVGhpcyBpcyB0aGUgbWFpbiB3YXkgdG8gYWRkIE1veGkgZnVuY3Rpb25hbGl0eSB0byBQSVhJIG9iamVjdHMuXG4gKlxuICogQHBhcmFtIGVudGl0eSAtIEFueSBQSVhJLkNvbnRhaW5lciAoU3ByaXRlLCBHcmFwaGljcywgQ29udGFpbmVyLCBldGMuKVxuICogQHBhcmFtIGxvZ2ljIC0gT3B0aW9uYWwgaW5pdGlhbCBsb2dpYyBjb21wb25lbnRzIHRvIGF0dGFjaFxuICogQHJldHVybnMgVGhlIHNhbWUgZW50aXR5IHdpdGggbW94aUVudGl0eSBwcm9wZXJ0eSBhdHRhY2hlZFxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3QgcGxheWVyID0gYXNFbnRpdHkobmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpKTtcbiAqIHBsYXllci5tb3hpRW50aXR5LmFkZExvZ2ljKG5ldyBQbGF5ZXJDb250cm9sbGVyKCkpO1xuICogc2NlbmUuYWRkQ2hpbGQocGxheWVyKTtcbiAqXG4gKiAvLyBXaXRoIGluaXRpYWwgbG9naWNcbiAqIGNvbnN0IGVuZW15ID0gYXNFbnRpdHkobmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpLCB7XG4gKiAgICdFbmVteUFJJzogbmV3IEVuZW15QUkoKVxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzRW50aXR5PFQgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lcj4oZW50aXR5OiBULCBsb2dpYzogTW94aUxvZ2ljPFQ+ID0ge30pOiBBc0VudGl0eTxUPiB7XG4gIGNvbnN0IHRhcmdldCA9IGVudGl0eTtcbiAgXG4gIC8vIHBpeGkgcGF0Y2g6IGl0J3MgdGhyb3dpbmcgYW4gZXJyb3Igb24gaW50ZXJhY3RpdmUgZXZlbnRzIGlmIGlzSW50ZXJhY3RpdmUoKSBkb2Vzbid0IGV4aXN0LlxuICB0YXJnZXQuaXNJbnRlcmFjdGl2ZSA9ICgpID0+IGZhbHNlOyBcblxuICAodGFyZ2V0IGFzIHVua25vd24gYXMgQXNFbnRpdHk8VD4pLm1veGlFbnRpdHkgPSBuZXcgTW94aUVudGl0eTxUPih0YXJnZXQsIGxvZ2ljKTtcbiAgcmV0dXJuIGVudGl0eSBhcyB1bmtub3duIGFzIEFzRW50aXR5PFQ+O1xufVxuXG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcblxuZXhwb3J0IGNsYXNzIFJlbmRlck1hbmFnZXIge1xuICBzdGF0aWMgZ2V0UmVuZGVyZXI6IChcbiAgICBvcHRpb25zOiBQYXJ0aWFsPFBJWEkuQXV0b0RldGVjdE9wdGlvbnM+XG4gICkgPT4gUHJvbWlzZTxQSVhJLlJlbmRlcmVyPjtcblxuICBzdGF0aWMgY3JlYXRlOiAoXG4gICAgICBodG1sUm9vdDogSFRNTEVsZW1lbnQsIFxuICAgICAgb3B0aW9uczogUGFydGlhbDxQSVhJLkF1dG9EZXRlY3RPcHRpb25zPikgPT4gUHJvbWlzZTxSZW5kZXJNYW5hZ2VyPjtcblxuICBodG1sUm9vdDogSFRNTEVsZW1lbnQ7XG4gIHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyO1xuICBmaXRUb1dpbmRvdyA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKGh0bWxSb290OiBIVE1MRWxlbWVudCwgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXIpIHtcbiAgICB0aGlzLmh0bWxSb290ID0gaHRtbFJvb3Q7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuXG4gICAgaHRtbFJvb3QuYXBwZW5kQ2hpbGQodGhpcy5yZW5kZXJlci5jYW52YXMpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB0aGlzLm9uUmVzaXplKCkpO1xuICAgIHRoaXMub25SZXNpemUoKTtcbiAgfVxuXG4gIHJlbmRlcihzdGFnZTogUElYSS5Db250YWluZXIpIHtcbiAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcihzdGFnZSk7XG4gIH1cblxuICBvblJlc2l6ZSA9ICgpID0+IHtcbiAgICBjb25zdCB7IHJlbmRlcmVyLCBodG1sUm9vdDogcm9vdCB9ID0gdGhpcztcbiAgICBjb25zdCBjYW52YXMgPSByZW5kZXJlci5jYW52YXM7XG4gICAgXG4gICAgLy8gR2V0IHRoZSBwYXJlbnQgZGltZW5zaW9uc1xuICAgIGNvbnN0IHBhcmVudFdpZHRoID0gcm9vdC5jbGllbnRXaWR0aDtcbiAgICBjb25zdCBwYXJlbnRIZWlnaHQgPSByb290LmNsaWVudEhlaWdodDtcbiAgICBcbiAgICAvLyBHZXQgdGhlIGNhbnZhcydzIGludGVuZGVkIGRpbWVuc2lvbnNcbiAgICBjb25zdCBjYW52YXNXaWR0aCA9IHJlbmRlcmVyLndpZHRoO1xuICAgIGNvbnN0IGNhbnZhc0hlaWdodCA9IHJlbmRlcmVyLmhlaWdodDtcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgdGhlIHNjYWxlIHRvIGZpdCB3aGlsZSBtYWludGFpbmluZyBhc3BlY3QgcmF0aW9cbiAgICBjb25zdCBzY2FsZSA9IE1hdGgubWluKFxuICAgICAgcGFyZW50V2lkdGggLyBjYW52YXNXaWR0aCxcbiAgICAgIHBhcmVudEhlaWdodCAvIGNhbnZhc0hlaWdodFxuICAgICk7XG4gICAgXG4gICAgLy8gU2V0IENTUyBkaW1lbnNpb25zIHRvIHNjYWxlIHRoZSBjYW52YXNcbiAgICBjYW52YXMuc3R5bGUud2lkdGggPSBgJHtNYXRoLmZsb29yKGNhbnZhc1dpZHRoICogc2NhbGUpfXB4YDtcbiAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gYCR7TWF0aC5mbG9vcihjYW52YXNIZWlnaHQgKiBzY2FsZSl9cHhgO1xuICB9O1xufVxuXG5SZW5kZXJNYW5hZ2VyLmdldFJlbmRlcmVyID0gYXN5bmMgKG9wdGlvbnM6IFBhcnRpYWw8UElYSS5BdXRvRGV0ZWN0T3B0aW9ucz4pID0+IChcbiAgYXdhaXQgUElYSS5hdXRvRGV0ZWN0UmVuZGVyZXIob3B0aW9ucylcbik7XG5cblJlbmRlck1hbmFnZXIuY3JlYXRlID0gYXN5bmMgKGh0bWxSb290OiBIVE1MRWxlbWVudCwgb3B0aW9uczogUGFydGlhbDxQSVhJLkF1dG9EZXRlY3RPcHRpb25zPikgPT4gKFxuICBuZXcgUmVuZGVyTWFuYWdlcihodG1sUm9vdCwgYXdhaXQgUmVuZGVyTWFuYWdlci5nZXRSZW5kZXJlcihvcHRpb25zKSlcbik7XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IEFzRW50aXR5IH0gZnJvbSAnLi9tb3hpLWVudGl0eSc7XG5cbmZ1bmN0aW9uIGlzTW94aUVudGl0eTxUIGV4dGVuZHMgUElYSS5Db250YWluZXI+KGVudGl0eTogdW5rbm93bik6IGVudGl0eSBpcyBBc0VudGl0eTxUPiB7XG4gIHJldHVybiBlbnRpdHkgIT0gbnVsbCAmJiB0eXBlb2YgZW50aXR5ID09PSAnb2JqZWN0JyAmJiAnbW94aUVudGl0eScgaW4gZW50aXR5O1xufVxuXG4vKipcbiAqIFJvb3QgY29udGFpbmVyIGZvciBnYW1lIG9iamVjdHMuIEV4dGVuZHMgUElYSS5Db250YWluZXIuXG4gKiBBdXRvbWF0aWNhbGx5IGNhbGxzIGluaXQvdXBkYXRlIG9uIGNoaWxkIGVudGl0aWVzIGNyZWF0ZWQgd2l0aCBhc0VudGl0eSgpLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3Qgc2NlbmUgPSBuZXcgU2NlbmUocmVuZGVyZXIpO1xuICogc2NlbmUuYWRkQ2hpbGQoYXNFbnRpdHkoc3ByaXRlKSk7XG4gKiBzY2VuZS5pbml0KCk7ICAvLyBDYWxscyBpbml0KCkgb24gYWxsIGVudGl0eSBsb2dpY1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBTY2VuZSBleHRlbmRzIFBJWEkuQ29udGFpbmVyIHtcbiAgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI8SFRNTENhbnZhc0VsZW1lbnQ+O1xuXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyPEhUTUxDYW52YXNFbGVtZW50Pikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICB9XG5cbiAgLyoqIEluaXRpYWxpemUgYWxsIGVudGl0eSBsb2dpYy4gQ2FsbCBvbmNlIGFmdGVyIGFkZGluZyBlbnRpdGllcy4gKi9cbiAgaW5pdCgpIHtcbiAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XG4gICAgICBpZiAoaXNNb3hpRW50aXR5KGNoaWxkKSkge1xuICAgICAgICBjaGlsZC5tb3hpRW50aXR5LmluaXQodGhpcy5yZW5kZXJlcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKiogVXBkYXRlIGFsbCBlbnRpdHkgbG9naWMuIENhbGxlZCBhdXRvbWF0aWNhbGx5IGJ5IEVuZ2luZSBlYWNoIGZyYW1lLiAqL1xuICB1cGRhdGUoZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XG4gICAgICBpZiAoaXNNb3hpRW50aXR5KGNoaWxkKSkge1xuICAgICAgICBjaGlsZC5tb3hpRW50aXR5LnVwZGF0ZShkZWx0YVRpbWUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqIFJlbmRlciB0aGUgc2NlbmUuIENhbGxlZCBhdXRvbWF0aWNhbGx5IGJ5IEVuZ2luZSBlYWNoIGZyYW1lLiAqL1xuICBkcmF3KGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgdGhpcy5yZW5kZXJlci5yZW5kZXIodGhpcyk7XG4gIH1cbn0iLCJpbXBvcnQgKiBhcyB1dGlscyBmcm9tICcuL2xpYnJhcnkvdXRpbHMnO1xuaW1wb3J0IHsgUmVuZGVyTWFuYWdlciB9IGZyb20gJy4vY29yZS9yZW5kZXItbWFuYWdlcic7XG5pbXBvcnQgeyBTY2VuZSB9IGZyb20gJy4vY29yZS9zY2VuZSc7XG5pbXBvcnQgeyBFbmdpbmUgfSBmcm9tICcuL2NvcmUvZW5naW5lJztcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJy4vY29yZS9ldmVudC1zeXN0ZW0nO1xuaW1wb3J0IHsgQ2xpZW50RXZlbnRzIH0gZnJvbSAnLi9saWJyYXJ5L2NsaWVudC1ldmVudHMnO1xuaW1wb3J0IHsgQXNzZXRMb2FkZXIgfSBmcm9tICcuL2NvcmUvYXNzZXQtbG9hZGVyJztcbmltcG9ydCB7IFBvaW50IH0gZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4vY29yZS9sb2dpYyc7XG5pbXBvcnQgeyBkZWZhdWx0UmVuZGVyT3B0aW9ucywgc2V0dXBNb3hpIH0gZnJvbSAnLi9saWJyYXJ5L3NldHVwJztcbmltcG9ydCB7IGxvYWRGb250cyB9IGZyb20gJy4vbGlicmFyeS9mb250LWxvYWRlcic7XG5pbXBvcnQgeyBhc0VudGl0eSwgTW94aUVudGl0eSB9IGZyb20gJy4vY29yZS9tb3hpLWVudGl0eSc7XG5pbXBvcnQgeyBDYW1lcmEsIENhbWVyYUxvZ2ljIH0gZnJvbSAnLi9jb3JlL2NhbWVyYSc7XG5pbXBvcnQgeyBhc1RleHR1cmVGcmFtZXMgfSBmcm9tICcuL2xpYnJhcnkvdGV4dHVyZS1mcmFtZXMnO1xuaW1wb3J0IHsgYXNCaXRtYXBUZXh0LCBhc1Nwcml0ZSwgYXNUZXh0LCBhc0dyYXBoaWNzLCBhc0NvbnRhaW5lciwgUGl4aVByb3BzIH0gZnJvbSAnLi9saWJyYXJ5L2FzLXBpeGknO1xuaW1wb3J0IHsgVGV4dHVyZUZyYW1lU2VxdWVuY2VzLCBTZXF1ZW5jZUluZm8gfSBmcm9tICcuL2xpYnJhcnkvdGV4dHVyZS1mcmFtZS1zZXF1ZW5jZXMnO1xuaW1wb3J0IHsgY3JlYXRlUmVzaXplSGFuZGxlciwgc2V0dXBSZXNwb25zaXZlQ2FudmFzLCBSZXNpemVIYW5kbGVyT3B0aW9ucyB9IGZyb20gJy4vbGlicmFyeS9yZXNpemUtaGFuZGxlcic7XG5pbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi91aS9jb3JlL2VkZ2UtaW5zZXRzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi91aS9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBVSUZvY3VzTWFuYWdlciB9IGZyb20gJy4vdWkvY29yZS91aS1mb2N1cy1tYW5hZ2VyJztcbmltcG9ydCB7IEZsZXhDb250YWluZXIsIEZsZXhEaXJlY3Rpb24sIEZsZXhKdXN0aWZ5LCBGbGV4QWxpZ24gfSBmcm9tICcuL3VpL2xheW91dC9mbGV4LWNvbnRhaW5lcic7XG5pbXBvcnQgeyBVSUJveCB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1ib3gnO1xuaW1wb3J0IHsgVUlMYWJlbCB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1sYWJlbCc7XG5pbXBvcnQgeyBVSVBhbmVsIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXBhbmVsJztcbmltcG9ydCB7IFVJQnV0dG9uLCBCdXR0b25TdGF0ZSB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1idXR0b24nO1xuaW1wb3J0IHsgVUlTZWxlY3QsIFNlbGVjdE9wdGlvbiB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1zZWxlY3QnO1xuaW1wb3J0IHsgVUlUZXh0SW5wdXQgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktdGV4dC1pbnB1dCc7XG5pbXBvcnQgeyBVSVRleHRBcmVhIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXRleHRhcmVhJztcbmltcG9ydCB7IFVJU2Nyb2xsQ29udGFpbmVyIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXNjcm9sbC1jb250YWluZXInO1xuaW1wb3J0IHsgVUlUYWJzLCBUYWJJdGVtIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXRhYnMnO1xuaW1wb3J0IHsgVUlMYXllciB9IGZyb20gJy4vdWkvVUlMYXllcic7XG5pbXBvcnQgeyBVSVNjYWxlTW9kZSB9IGZyb20gJy4vdWkvVUlTY2FsZU1vZGUnO1xuaW1wb3J0IHsgU3RhdGVNYWNoaW5lIH0gZnJvbSAnLi9saWJyYXJ5L3N0YXRlLW1hY2hpbmUnO1xuaW1wb3J0IHsgU3RhdGVMb2dpYyB9IGZyb20gJy4vbGlicmFyeS9zdGF0ZS1sb2dpYyc7XG5pbXBvcnQgeyBjcmVhdGVUaWxlR3JpZCwgZ2V0VGV4dHVyZVJhbmdlIH0gZnJvbSAnLi9saWJyYXJ5L2dyaWQtZ2VuZXJhdG9yJztcbmltcG9ydCB7IHN2Z1RvVGV4dHVyZSB9IGZyb20gJy4vbGlicmFyeS9zdmctdXRpbHMvc3ZnLXRvLXRleHR1cmUnO1xuaW1wb3J0IHsgUGl4ZWxHcmlkLCBweCwgdW5pdHMsIEdSSUQsIEJPUkRFUiwgY3JlYXRlQm9yZGVyQ29uZmlnIH0gZnJvbSAnLi91aS9waXhlbC1ncmlkJztcbmltcG9ydCB7IFBhcmFsbGF4QmFja2dyb3VuZCwgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMgfSBmcm9tICcuL2xpYnJhcnkvcGFyYWxsYXgtYmFja2dyb3VuZCc7XG5pbXBvcnQgeyBQYXJhbGxheExheWVyLCBUaWxpbmdQYXJhbGxheExheWVyIH0gZnJvbSAnLi9saWJyYXJ5L3BhcmFsbGF4LWxheWVyJztcbmltcG9ydCB7IExvYWRpbmdTY2VuZSwgRmFsbGluZ1NxdWFyZXNBbmltYXRpb24gfSBmcm9tICcuL2xpYnJhcnkvbG9hZGluZy1zY2VuZSc7XG5pbXBvcnQgeyBBY3Rpb25NYW5hZ2VyLCBPbkFjdGlvbiB9IGZyb20gJy4vbGlicmFyeS9hY3Rpb24tbWFuYWdlcic7XG5pbXBvcnQge1xuICBQaHlzaWNzV29ybGQsXG4gIFBoeXNpY3NCb2R5TG9naWMsXG4gIFBoeXNpY3NEZWJ1Z1JlbmRlcmVyLFxuICBDb2xsaXNpb25SZWdpc3RyeSxcbiAgQ29sbGlzaW9uTWFuYWdlcixcbiAgYXNQaHlzaWNzRW50aXR5LFxuICBoYXNQaHlzaWNzLFxuICBnZXRQaHlzaWNzQm9keSxcbiAgY3JlYXRlU2hhcGVGcm9tU3ByaXRlLFxuICBQaHlzaWNzTWF0ZXJpYWxzLFxuICBhcHBseU1hdGVyaWFsXG59IGZyb20gJy4vbGlicmFyeS9waHlzaWNzJztcblxuZXhwb3J0IHR5cGUgeyBTdGF0ZUNoYW5nZUV2ZW50IH0gZnJvbSAnLi9saWJyYXJ5L3N0YXRlLW1hY2hpbmUnO1xuZXhwb3J0IHR5cGUgeyBBc0VudGl0eSwgTW94aUxvZ2ljIH0gZnJvbSAnLi9jb3JlL21veGktZW50aXR5JztcbmV4cG9ydCB0eXBlIHsgQXNUZXh0dXJlRnJhbWVzT3B0aW9ucyB9IGZyb20gJy4vbGlicmFyeS90ZXh0dXJlLWZyYW1lcyc7XG5leHBvcnQgdHlwZSB7IEdyaWRPcHRpb25zLCBDZWxsUG9zaXRpb24gfSBmcm9tICcuL2xpYnJhcnkvZ3JpZC1nZW5lcmF0b3InO1xuZXhwb3J0IHR5cGUgeyBQYXJhbGxheEJhY2tncm91bmRPcHRpb25zIH0gZnJvbSAnLi9saWJyYXJ5L3BhcmFsbGF4LWJhY2tncm91bmQnO1xuZXhwb3J0IHR5cGUgeyBQYXJhbGxheExheWVyT3B0aW9ucywgVGlsaW5nUGFyYWxsYXhMYXllck9wdGlvbnMgfSBmcm9tICcuL2xpYnJhcnkvcGFyYWxsYXgtbGF5ZXInO1xuZXhwb3J0IHR5cGUgeyBMb2FkaW5nU2NlbmVPcHRpb25zLCBMb2FkaW5nQW5pbWF0aW9uLCBMb2FkaW5nQW5pbWF0aW9uQ29udGV4dCwgRmFsbGluZ1NxdWFyZXNPcHRpb25zIH0gZnJvbSAnLi9saWJyYXJ5L2xvYWRpbmctc2NlbmUnO1xuZXhwb3J0IHR5cGUgeyBPbkFjdGlvbiB9IGZyb20gJy4vbGlicmFyeS9hY3Rpb24tbWFuYWdlcic7XG5leHBvcnQgdHlwZSB7XG4gIEJvZHlUeXBlLFxuICBTeW5jTW9kZSxcbiAgU2hhcGVUeXBlLFxuICBDb2xsaXNpb25UYWcsXG4gIFNoYXBlQ29uZmlnLFxuICBQaHlzaWNzV29ybGRPcHRpb25zLFxuICBQaHlzaWNzQm9keU9wdGlvbnMsXG4gIFBoeXNpY3NEZWJ1Z09wdGlvbnMsXG4gIENvbGxpc2lvbkV2ZW50LFxuICBSYXljYXN0Q2FsbGJhY2tcbn0gZnJvbSAnLi9saWJyYXJ5L3BoeXNpY3MnO1xuZXhwb3J0IHR5cGUgeyBCb3hNb2RlbCwgQ29tcHV0ZWRMYXlvdXQsIE1lYXN1cmVkU2l6ZSwgU2l6ZUNvbnN0cmFpbnQgfSBmcm9tICcuL3VpL2NvcmUvYm94LW1vZGVsJztcbmV4cG9ydCB0eXBlIHsgRmxleENvbnRhaW5lclByb3BzIH0gZnJvbSAnLi91aS9sYXlvdXQvZmxleC1jb250YWluZXInO1xuZXhwb3J0IHR5cGUgeyBVSUJveFByb3BzIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWJveCc7XG5leHBvcnQgdHlwZSB7IFVJTGFiZWxQcm9wcywgVGV4dEFsaWduIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWxhYmVsJztcbmV4cG9ydCB0eXBlIHsgVUlQYW5lbFByb3BzLCBOaW5lU2xpY2VDb25maWcgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktcGFuZWwnO1xuZXhwb3J0IHR5cGUgeyBVSUJ1dHRvblByb3BzLCBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWJ1dHRvbic7XG5leHBvcnQgdHlwZSB7IFVJU2VsZWN0UHJvcHMsIFNlbGVjdE9wdGlvbiB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1zZWxlY3QnO1xuZXhwb3J0IHR5cGUgeyBVSVRleHRJbnB1dFByb3BzIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXRleHQtaW5wdXQnO1xuZXhwb3J0IHR5cGUgeyBVSVRhYnNQcm9wcywgVGFiSXRlbSB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS10YWJzJztcbmV4cG9ydCB0eXBlIHsgVUlMYXllck9wdGlvbnMgfSBmcm9tICcuL3VpL1VJTGF5ZXInO1xuZXhwb3J0IHR5cGUgeyBQaXhlbEdyaWRDb25maWcsIEJvcmRlckNvbmZpZyB9IGZyb20gJy4vdWkvcGl4ZWwtZ3JpZCc7XG5leHBvcnQgdHlwZSB7IFNWR1RvVGV4dHVyZU9wdGlvbnMgfSBmcm9tICcuL2xpYnJhcnkvc3ZnLXV0aWxzL3N2Zy10by10ZXh0dXJlJztcblxuZXhwb3J0IHR5cGUgQXNzZXQgPSB7IHNyYzogc3RyaW5nLCBhbGlhcz86IHN0cmluZyB9O1xuXG5leHBvcnQgaW50ZXJmYWNlIE9uRXZlbnQge1xuICBldmVudDogRXZlbnQ7XG4gIGV2ZW50VHlwZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENsaWVudEV2ZW50c0FyZ3Mge1xuICBpbml0V2hlZWxPZmZzZXQ/OiBQb2ludDtcbiAgb25BbnlFdmVudD86IChldjogT25FdmVudCkgPT4gdm9pZDtcbn1cblxuZXhwb3J0IHR5cGUgQ2xpZW50RXZlbnRzVHlwZSA9IHtcbiAga2V5RG93bkV2ZW50PzogS2V5Ym9hcmRFdmVudDtcbiAga2V5VXBFdmVudD86IEtleWJvYXJkRXZlbnQ7XG4gIGtleWRvd24/OiBSZWNvcmQ8c3RyaW5nLCBLZXlib2FyZEV2ZW50PjtcbiAgbW91c2VEb3duRXZlbnQ/OiBNb3VzZUV2ZW50O1xuICBtb3VzZVVwRXZlbnQ/OiBNb3VzZUV2ZW50O1xuICBsYXN0TW91c2VEb3duPzogTW91c2VFdmVudDtcbiAgbGFzdE1vdXNlVXA/OiBNb3VzZUV2ZW50O1xuICB3aGVlbEV2ZW50PzogV2hlZWxFdmVudDtcbiAgd2hlZWxEZWx0YT86IHsgeVZhbHVlOiAwIHwgbnVtYmVyLCB4VmFsdWU6IDAgfCBudW1iZXIsIHhMYXN0OiBudW1iZXIsIHlMYXN0OiBudW1iZXIgfVxufVxuXG4vLyBSZS1leHBvcnQgdHlwZXNcbmV4cG9ydCB7IFxuICBTZXF1ZW5jZUluZm8sIFxuICBSZXNpemVIYW5kbGVyT3B0aW9uc1xufTtcblxuY29uc3QgZXhwb3J0ZWRPYmplY3RzID0ge1xuICBBc3NldExvYWRlcixcbiAgYXNFbnRpdHksXG4gIGFzVGV4dHVyZUZyYW1lcyxcbiAgYXNCaXRtYXBUZXh0LFxuICBhc1Nwcml0ZSxcbiAgYXNUZXh0LFxuICBhc0dyYXBoaWNzLFxuICBhc0NvbnRhaW5lcixcbiAgTG9naWMsXG4gIENhbWVyYSxcbiAgQ2FtZXJhTG9naWMsXG4gIENsaWVudEV2ZW50cyxcbiAgY3JlYXRlUmVzaXplSGFuZGxlcixcbiAgY3JlYXRlVGlsZUdyaWQsXG4gIGRlZmF1bHRSZW5kZXJPcHRpb25zLFxuICBFbmdpbmUsXG4gIEV2ZW50RW1pdHRlcixcbiAgZ2V0VGV4dHVyZVJhbmdlLFxuICBsb2FkRm9udHMsXG4gIE1veGlFbnRpdHksXG4gIFBhcmFsbGF4QmFja2dyb3VuZCxcbiAgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMsXG4gIFBhcmFsbGF4TGF5ZXIsXG4gIExvYWRpbmdTY2VuZSxcbiAgRmFsbGluZ1NxdWFyZXNBbmltYXRpb24sXG4gIHNldHVwTW94aSxcbiAgUmVuZGVyTWFuYWdlcixcbiAgU2NlbmUsXG4gIHNldHVwUmVzcG9uc2l2ZUNhbnZhcyxcbiAgVGV4dHVyZUZyYW1lU2VxdWVuY2VzLFxuICBUaWxpbmdQYXJhbGxheExheWVyLFxuICB1dGlscyxcbiAgU3RhdGVNYWNoaW5lLFxuICBTdGF0ZUxvZ2ljLFxuICBQaHlzaWNzV29ybGQsXG4gIFBoeXNpY3NCb2R5TG9naWMsXG4gIFBoeXNpY3NEZWJ1Z1JlbmRlcmVyLFxuICBDb2xsaXNpb25SZWdpc3RyeSxcbiAgQ29sbGlzaW9uTWFuYWdlcixcbiAgYXNQaHlzaWNzRW50aXR5LFxuICBoYXNQaHlzaWNzLFxuICBnZXRQaHlzaWNzQm9keSxcbiAgY3JlYXRlU2hhcGVGcm9tU3ByaXRlLFxuICBQaHlzaWNzTWF0ZXJpYWxzLFxuICBhcHBseU1hdGVyaWFsLFxuICBFZGdlSW5zZXRzLFxuICBVSUNvbXBvbmVudCxcbiAgVUlGb2N1c01hbmFnZXIsXG4gIEZsZXhDb250YWluZXIsXG4gIEZsZXhEaXJlY3Rpb24sXG4gIEZsZXhKdXN0aWZ5LFxuICBGbGV4QWxpZ24sXG4gIFVJQm94LFxuICBVSUxhYmVsLFxuICBVSVBhbmVsLFxuICBVSUJ1dHRvbixcbiAgQnV0dG9uU3RhdGUsXG4gIFVJU2VsZWN0LFxuICBVSVRleHRJbnB1dCxcbiAgVUlUZXh0QXJlYSxcbiAgVUlTY3JvbGxDb250YWluZXIsXG4gIFVJVGFicyxcbiAgVUlMYXllcixcbiAgVUlTY2FsZU1vZGUsXG4gIHN2Z1RvVGV4dHVyZSxcbiAgUGl4ZWxHcmlkLFxuICBweCxcbiAgdW5pdHMsXG4gIEdSSUQsXG4gIEJPUkRFUixcbiAgY3JlYXRlQm9yZGVyQ29uZmlnLFxuICBBY3Rpb25NYW5hZ2VyXG59O1xuXG5leHBvcnQgZGVmYXVsdCBleHBvcnRlZE9iamVjdHM7XG5cbmV4cG9ydCB7XG4gIEFzc2V0TG9hZGVyLFxuICBhc0VudGl0eSxcbiAgYXNUZXh0dXJlRnJhbWVzLFxuICBhc0JpdG1hcFRleHQsXG4gIGFzU3ByaXRlLFxuICBhc1RleHQsXG4gIGFzR3JhcGhpY3MsXG4gIGFzQ29udGFpbmVyLFxuICBQaXhpUHJvcHMsXG4gIExvZ2ljLFxuICBDYW1lcmEsXG4gIENhbWVyYUxvZ2ljLFxuICBDbGllbnRFdmVudHMsXG4gIGNyZWF0ZVJlc2l6ZUhhbmRsZXIsXG4gIGNyZWF0ZVRpbGVHcmlkLFxuICBkZWZhdWx0UmVuZGVyT3B0aW9ucyxcbiAgRW5naW5lLFxuICBFdmVudEVtaXR0ZXIsXG4gIGdldFRleHR1cmVSYW5nZSxcbiAgbG9hZEZvbnRzLFxuICBNb3hpRW50aXR5LFxuICBQYXJhbGxheEJhY2tncm91bmQsXG4gIFBhcmFsbGF4QmFja2dyb3VuZExvZ2ljLFxuICBQYXJhbGxheExheWVyLFxuICBMb2FkaW5nU2NlbmUsXG4gIEZhbGxpbmdTcXVhcmVzQW5pbWF0aW9uLFxuICBzZXR1cE1veGksXG4gIFJlbmRlck1hbmFnZXIsXG4gIFNjZW5lLFxuICBzZXR1cFJlc3BvbnNpdmVDYW52YXMsXG4gIFRleHR1cmVGcmFtZVNlcXVlbmNlcyxcbiAgVGlsaW5nUGFyYWxsYXhMYXllcixcbiAgdXRpbHMsXG4gIFN0YXRlTWFjaGluZSxcbiAgU3RhdGVMb2dpYyxcbiAgUGh5c2ljc1dvcmxkLFxuICBQaHlzaWNzQm9keUxvZ2ljLFxuICBQaHlzaWNzRGVidWdSZW5kZXJlcixcbiAgQ29sbGlzaW9uUmVnaXN0cnksXG4gIENvbGxpc2lvbk1hbmFnZXIsXG4gIGFzUGh5c2ljc0VudGl0eSxcbiAgaGFzUGh5c2ljcyxcbiAgZ2V0UGh5c2ljc0JvZHksXG4gIGNyZWF0ZVNoYXBlRnJvbVNwcml0ZSxcbiAgUGh5c2ljc01hdGVyaWFscyxcbiAgYXBwbHlNYXRlcmlhbCxcbiAgRWRnZUluc2V0cyxcbiAgVUlDb21wb25lbnQsXG4gIFVJRm9jdXNNYW5hZ2VyLFxuICBGbGV4Q29udGFpbmVyLFxuICBGbGV4RGlyZWN0aW9uLFxuICBGbGV4SnVzdGlmeSxcbiAgRmxleEFsaWduLFxuICBVSUJveCxcbiAgVUlMYWJlbCxcbiAgVUlQYW5lbCxcbiAgVUlCdXR0b24sXG4gIEJ1dHRvblN0YXRlLFxuICBVSVNlbGVjdCxcbiAgVUlUZXh0SW5wdXQsXG4gIFVJVGV4dEFyZWEsXG4gIFVJU2Nyb2xsQ29udGFpbmVyLFxuICBVSVRhYnMsXG4gIFVJTGF5ZXIsXG4gIFVJU2NhbGVNb2RlLFxuICBzdmdUb1RleHR1cmUsXG4gIFBpeGVsR3JpZCxcbiAgcHgsXG4gIHVuaXRzLFxuICBHUklELFxuICBCT1JERVIsXG4gIGNyZWF0ZUJvcmRlckNvbmZpZyxcbiAgQWN0aW9uTWFuYWdlclxufTtcblxuIiwiLyoqXG4gKiBBY3Rpb25NYW5hZ2VyIC0gQ2VudHJhbGl6ZWQgZXZlbnQgbGlzdGVuZXIgbWFuYWdlbWVudCB1dGlsaXR5XG4gKlxuICogUHJldmVudHMgbWVtb3J5IGxlYWtzIGJ5IHRyYWNraW5nIGFsbCByZWdpc3RlcmVkIGV2ZW50IGxpc3RlbmVycyBhbmQgcHJvdmlkaW5nXG4gKiBiYXRjaCBjbGVhbnVwIGZ1bmN0aW9uYWxpdHkuIFBhcnRpY3VsYXJseSB1c2VmdWwgZm9yIExvZ2ljIGNvbXBvbmVudHMgdGhhdCBuZWVkIHRvXG4gKiByZWdpc3RlciBtdWx0aXBsZSB3aW5kb3cvZG9jdW1lbnQgbGlzdGVuZXJzIGFuZCBjbGVhbiB0aGVtIHVwIG9uIGRlc3Ryb3kuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjbGFzcyBEcmFnTG9naWMgZXh0ZW5kcyBMb2dpYzxDb250YWluZXI+IHtcbiAqICAgcHJpdmF0ZSBhY3Rpb25zID0gbmV3IEFjdGlvbk1hbmFnZXIoKTtcbiAqXG4gKiAgIGluaXQoZW50aXR5OiBDb250YWluZXIpIHtcbiAqICAgICB0aGlzLmFjdGlvbnMuYWRkKHdpbmRvdywgJ3BvaW50ZXJtb3ZlJywgdGhpcy5vbk1vdmUuYmluZCh0aGlzKSk7XG4gKiAgICAgdGhpcy5hY3Rpb25zLmFkZCh3aW5kb3csICdwb2ludGVydXAnLCB0aGlzLm9uVXAuYmluZCh0aGlzKSk7XG4gKiAgIH1cbiAqXG4gKiAgIGRlc3Ryb3koKSB7XG4gKiAgICAgdGhpcy5hY3Rpb25zLnJlbW92ZUFsbCgpO1xuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqL1xuXG5leHBvcnQgaW50ZXJmYWNlIE9uQWN0aW9uIHtcbiAgdGFyZ2V0OiBFdmVudFRhcmdldDtcbiAgdHlwZTogc3RyaW5nO1xuICBoYW5kbGVyOiBFdmVudExpc3RlbmVyO1xuICBvcHRpb25zPzogQWRkRXZlbnRMaXN0ZW5lck9wdGlvbnM7XG59XG5cbi8qKlxuICogTWFuYWdlcyBldmVudCBsaXN0ZW5lciBsaWZlY3ljbGUgdG8gcHJldmVudCBtZW1vcnkgbGVha3NcbiAqL1xuZXhwb3J0IGNsYXNzIEFjdGlvbk1hbmFnZXIge1xuICBwcml2YXRlIGFjdGlvbnM6IFNldDxPbkFjdGlvbj4gPSBuZXcgU2V0KCk7XG5cbiAgLyoqXG4gICAqIEFkZCBhbiBldmVudCBsaXN0ZW5lciBhbmQgdHJhY2sgaXQgZm9yIGxhdGVyIGNsZWFudXBcbiAgICpcbiAgICogQHBhcmFtIHRhcmdldCBFdmVudCB0YXJnZXQgKHdpbmRvdywgZG9jdW1lbnQsIGVsZW1lbnQsIGV0Yy4pXG4gICAqIEBwYXJhbSB0eXBlIEV2ZW50IHR5cGUgKCdjbGljaycsICd3aGVlbCcsICdtb3VzZW1vdmUnLCBldGMuKVxuICAgKiBAcGFyYW0gaGFuZGxlciBFdmVudCBoYW5kbGVyIGZ1bmN0aW9uXG4gICAqIEBwYXJhbSBvcHRpb25zIE9wdGlvbmFsIGV2ZW50IGxpc3RlbmVyIG9wdGlvbnNcbiAgICogQHJldHVybnMgQWN0aW9uIG9iamVjdCB0aGF0IGNhbiBiZSB1c2VkIHRvIHJlbW92ZSB0aGlzIHNwZWNpZmljIGxpc3RlbmVyXG4gICAqL1xuICBhZGQoXG4gICAgdGFyZ2V0OiBFdmVudFRhcmdldCxcbiAgICB0eXBlOiBzdHJpbmcsXG4gICAgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcixcbiAgICBvcHRpb25zPzogQWRkRXZlbnRMaXN0ZW5lck9wdGlvbnNcbiAgKTogT25BY3Rpb24ge1xuICAgIGNvbnN0IGFjdGlvbjogT25BY3Rpb24gPSB7IHRhcmdldCwgdHlwZSwgaGFuZGxlciwgb3B0aW9ucyB9O1xuICAgIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHRoaXMuYWN0aW9ucy5hZGQoYWN0aW9uKTtcbiAgICByZXR1cm4gYWN0aW9uO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhIHNwZWNpZmljIGV2ZW50IGxpc3RlbmVyXG4gICAqXG4gICAqIEBwYXJhbSBhY3Rpb24gVGhlIGFjdGlvbiBvYmplY3QgcmV0dXJuZWQgZnJvbSBhZGQoKVxuICAgKi9cbiAgcmVtb3ZlKGFjdGlvbjogT25BY3Rpb24pOiB2b2lkIHtcbiAgICBpZiAodGhpcy5hY3Rpb25zLmhhcyhhY3Rpb24pKSB7XG4gICAgICBhY3Rpb24udGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgIGFjdGlvbi50eXBlLFxuICAgICAgICBhY3Rpb24uaGFuZGxlcixcbiAgICAgICAgYWN0aW9uLm9wdGlvbnNcbiAgICAgICk7XG4gICAgICB0aGlzLmFjdGlvbnMuZGVsZXRlKGFjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhbGwgZXZlbnQgbGlzdGVuZXJzIG1hbmFnZWQgYnkgdGhpcyBBY3Rpb25NYW5hZ2VyXG4gICAqXG4gICAqIFNob3VsZCBiZSBjYWxsZWQgd2hlbiB0aGUgY29tcG9uZW50IGlzIGRlc3Ryb3llZCB0byBwcmV2ZW50IG1lbW9yeSBsZWFrc1xuICAgKi9cbiAgcmVtb3ZlQWxsKCk6IHZvaWQge1xuICAgIHRoaXMuYWN0aW9ucy5mb3JFYWNoKGFjdGlvbiA9PiB7XG4gICAgICBhY3Rpb24udGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoYWN0aW9uLnR5cGUsIGFjdGlvbi5oYW5kbGVyLCBhY3Rpb24ub3B0aW9ucyk7XG4gICAgfSk7XG4gICAgdGhpcy5hY3Rpb25zLmNsZWFyKCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjb3VudCBvZiBhY3RpdmUgYWN0aW9uc1xuICAgKlxuICAgKiBVc2VmdWwgZm9yIGRlYnVnZ2luZyBhbmQgdGVzdGluZ1xuICAgKi9cbiAgZ2V0Q291bnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5hY3Rpb25zLnNpemU7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgYSBzcGVjaWZpYyBhY3Rpb24gaXMgY3VycmVudGx5IGFjdGl2ZVxuICAgKlxuICAgKiBAcGFyYW0gYWN0aW9uIFRoZSBhY3Rpb24gdG8gY2hlY2tcbiAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgYWN0aW9uIGlzIGFjdGl2ZVxuICAgKi9cbiAgaGFzQWN0aW9uKGFjdGlvbjogT25BY3Rpb24pOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5hY3Rpb25zLmhhcyhhY3Rpb24pO1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcblxuLyoqXG4gKiBPcHRpb25zIGZvciBjcmVhdGluZyBhIEJpdG1hcFRleHQgaW5zdGFuY2VcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBCaXRtYXBUZXh0T3B0aW9ucyB7XG4gIHRleHQ/OiBzdHJpbmcgfCBudW1iZXIgfCB7IHRvU3RyaW5nOiAoKSA9PiBzdHJpbmcgfTtcbiAgc3R5bGU/OiB7XG4gICAgZm9udEZhbWlseT86IHN0cmluZztcbiAgICBmb250U2l6ZT86IG51bWJlcjtcbiAgICBmb250U3R5bGU/OiBzdHJpbmc7XG4gICAgZmlsbD86IG51bWJlciB8IHN0cmluZztcbiAgICBba2V5OiBzdHJpbmddOiBhbnk7XG4gIH07XG4gIHBpeGVsUGVyZmVjdD86IGJvb2xlYW47IC8vIEVuYWJsZSBwaXhlbC1wZXJmZWN0IHJlbmRlcmluZyAocm91bmRQaXhlbHMpXG4gIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuLyoqXG4gKiBPcHRpb25zIGZvciBjcmVhdGluZyBhIFNwcml0ZSBpbnN0YW5jZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNwcml0ZU9wdGlvbnMge1xuICB0ZXh0dXJlPzogUElYSS5UZXh0dXJlIHwgUElYSS5UZXh0dXJlU291cmNlO1xuICBba2V5OiBzdHJpbmddOiBhbnk7XG59XG5cbi8qKlxuICogT3B0aW9ucyBmb3IgY3JlYXRpbmcgYSBUZXh0IGluc3RhbmNlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVGV4dE9wdGlvbnMge1xuICB0ZXh0Pzogc3RyaW5nIHwgbnVtYmVyIHwgeyB0b1N0cmluZzogKCkgPT4gc3RyaW5nIH07XG4gIHN0eWxlPzoge1xuICAgIGZvbnRGYW1pbHk/OiBzdHJpbmc7XG4gICAgZm9udFNpemU/OiBudW1iZXI7XG4gICAgZm9udFN0eWxlPzogc3RyaW5nO1xuICAgIGZpbGw/OiBudW1iZXIgfCBzdHJpbmc7XG4gICAgW2tleTogc3RyaW5nXTogYW55O1xuICB9O1xuICBba2V5OiBzdHJpbmddOiBhbnk7XG59XG5cbi8qKlxuICogQ29tbW9uIHByb3BlcnRpZXMgdGhhdCBjYW4gYmUgYXBwbGllZCB0byBQSVhJIGRpc3BsYXkgb2JqZWN0c1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFBpeGlQcm9wcyB7XG4gIHg/OiBudW1iZXI7XG4gIHk/OiBudW1iZXI7XG4gIGFuY2hvcj86IHsgeD86IG51bWJlcjsgeT86IG51bWJlciB9IHwgbnVtYmVyO1xuICBzY2FsZT86IHsgeD86IG51bWJlcjsgeT86IG51bWJlciB9IHwgbnVtYmVyO1xuICByb3RhdGlvbj86IG51bWJlcjtcbiAgdGludD86IG51bWJlcjtcbiAgYWxwaGE/OiBudW1iZXI7XG4gIHZpc2libGU/OiBib29sZWFuO1xuICBldmVudE1vZGU/OiAnbm9uZScgfCAncGFzc2l2ZScgfCAnYXV0bycgfCAnc3RhdGljJyB8ICdkeW5hbWljJztcbiAgcGl2b3Q/OiB7IHg/OiBudW1iZXI7IHk/OiBudW1iZXIgfSB8IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBcHBsaWVzIGNvbW1vbiBwcm9wZXJ0aWVzIHRvIGEgUElYSSBkaXNwbGF5IG9iamVjdFxuICovXG5mdW5jdGlvbiBhcHBseVByb3BzPFQgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lcj4ob2JqOiBULCBwcm9wcz86IFBpeGlQcm9wcyk6IFQge1xuICBpZiAoIXByb3BzKSByZXR1cm4gb2JqO1xuXG4gIGlmIChwcm9wcy54ICE9PSB1bmRlZmluZWQpIG9iai54ID0gcHJvcHMueDtcbiAgaWYgKHByb3BzLnkgIT09IHVuZGVmaW5lZCkgb2JqLnkgPSBwcm9wcy55O1xuICBcbiAgaWYgKHByb3BzLmFuY2hvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiBwcm9wcy5hbmNob3IgPT09ICdudW1iZXInKSB7XG4gICAgICBpZiAoJ2FuY2hvcicgaW4gb2JqICYmIHR5cGVvZiBvYmouYW5jaG9yID09PSAnb2JqZWN0JyAmJiBvYmouYW5jaG9yICE9PSBudWxsKSB7XG4gICAgICAgIChvYmouYW5jaG9yIGFzIFBJWEkuT2JzZXJ2YWJsZVBvaW50KS5zZXQocHJvcHMuYW5jaG9yKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCdhbmNob3InIGluIG9iaiAmJiB0eXBlb2Ygb2JqLmFuY2hvciA9PT0gJ29iamVjdCcgJiYgb2JqLmFuY2hvciAhPT0gbnVsbCkge1xuICAgICAgICBjb25zdCBhbmNob3IgPSBvYmouYW5jaG9yIGFzIFBJWEkuT2JzZXJ2YWJsZVBvaW50O1xuICAgICAgICBpZiAocHJvcHMuYW5jaG9yLnggIT09IHVuZGVmaW5lZCkgYW5jaG9yLnggPSBwcm9wcy5hbmNob3IueDtcbiAgICAgICAgaWYgKHByb3BzLmFuY2hvci55ICE9PSB1bmRlZmluZWQpIGFuY2hvci55ID0gcHJvcHMuYW5jaG9yLnk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKHByb3BzLnNjYWxlICE9PSB1bmRlZmluZWQpIHtcbiAgICBpZiAodHlwZW9mIHByb3BzLnNjYWxlID09PSAnbnVtYmVyJykge1xuICAgICAgaWYgKCdzY2FsZScgaW4gb2JqICYmIHR5cGVvZiBvYmouc2NhbGUgPT09ICdvYmplY3QnICYmIG9iai5zY2FsZSAhPT0gbnVsbCkge1xuICAgICAgICAob2JqLnNjYWxlIGFzIFBJWEkuT2JzZXJ2YWJsZVBvaW50KS5zZXQocHJvcHMuc2NhbGUpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoJ3NjYWxlJyBpbiBvYmogJiYgdHlwZW9mIG9iai5zY2FsZSA9PT0gJ29iamVjdCcgJiYgb2JqLnNjYWxlICE9PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHNjYWxlID0gb2JqLnNjYWxlIGFzIFBJWEkuT2JzZXJ2YWJsZVBvaW50O1xuICAgICAgICBpZiAocHJvcHMuc2NhbGUueCAhPT0gdW5kZWZpbmVkKSBzY2FsZS54ID0gcHJvcHMuc2NhbGUueDtcbiAgICAgICAgaWYgKHByb3BzLnNjYWxlLnkgIT09IHVuZGVmaW5lZCkgc2NhbGUueSA9IHByb3BzLnNjYWxlLnk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKHByb3BzLnJvdGF0aW9uICE9PSB1bmRlZmluZWQpIG9iai5yb3RhdGlvbiA9IHByb3BzLnJvdGF0aW9uO1xuICBpZiAocHJvcHMudGludCAhPT0gdW5kZWZpbmVkICYmICd0aW50JyBpbiBvYmopIChvYmogYXMgYW55KS50aW50ID0gcHJvcHMudGludDtcbiAgaWYgKHByb3BzLmFscGhhICE9PSB1bmRlZmluZWQpIG9iai5hbHBoYSA9IHByb3BzLmFscGhhO1xuICBpZiAocHJvcHMudmlzaWJsZSAhPT0gdW5kZWZpbmVkKSBvYmoudmlzaWJsZSA9IHByb3BzLnZpc2libGU7XG4gIGlmIChwcm9wcy5ldmVudE1vZGUgIT09IHVuZGVmaW5lZCAmJiAnZXZlbnRNb2RlJyBpbiBvYmopIG9iai5ldmVudE1vZGUgPSBwcm9wcy5ldmVudE1vZGU7XG5cbiAgaWYgKHByb3BzLnBpdm90ICE9PSB1bmRlZmluZWQpIHtcbiAgICBpZiAodHlwZW9mIHByb3BzLnBpdm90ID09PSAnbnVtYmVyJykge1xuICAgICAgaWYgKCdwaXZvdCcgaW4gb2JqICYmIHR5cGVvZiBvYmoucGl2b3QgPT09ICdvYmplY3QnICYmIG9iai5waXZvdCAhPT0gbnVsbCkge1xuICAgICAgICAob2JqLnBpdm90IGFzIFBJWEkuT2JzZXJ2YWJsZVBvaW50KS5zZXQocHJvcHMucGl2b3QpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoJ3Bpdm90JyBpbiBvYmogJiYgdHlwZW9mIG9iai5waXZvdCA9PT0gJ29iamVjdCcgJiYgb2JqLnBpdm90ICE9PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHBpdm90ID0gb2JqLnBpdm90IGFzIFBJWEkuT2JzZXJ2YWJsZVBvaW50O1xuICAgICAgICBpZiAocHJvcHMucGl2b3QueCAhPT0gdW5kZWZpbmVkKSBwaXZvdC54ID0gcHJvcHMucGl2b3QueDtcbiAgICAgICAgaWYgKHByb3BzLnBpdm90LnkgIT09IHVuZGVmaW5lZCkgcGl2b3QueSA9IHByb3BzLnBpdm90Lnk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG9iajtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgQml0bWFwVGV4dCBpbnN0YW5jZSB3aXRoIGNvbnN0cnVjdG9yIGFyZ3MgYW5kIG9wdGlvbmFsIHByb3BlcnRpZXNcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgbGFiZWwgPSBhc0JpdG1hcFRleHQoXG4gKiAgIHsgdGV4dDogJ0hlbGxvJywgc3R5bGU6IHsgZm9udEZhbWlseTogJ0FyaWFsJywgZm9udFNpemU6IDI0IH0sIHBpeGVsUGVyZmVjdDogdHJ1ZSB9LFxuICogICB7IHg6IDEwMCwgeTogNTAsIGFuY2hvcjogMC41IH1cbiAqICk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzQml0bWFwVGV4dChcbiAgY29uc3RydWN0b3JBcmdzOiBCaXRtYXBUZXh0T3B0aW9ucyxcbiAgcHJvcHM/OiBQaXhpUHJvcHNcbik6IFBJWEkuQml0bWFwVGV4dCB7XG4gIGNvbnN0IHsgcGl4ZWxQZXJmZWN0LCAuLi50ZXh0QXJncyB9ID0gY29uc3RydWN0b3JBcmdzO1xuICBjb25zdCB0ZXh0ID0gbmV3IFBJWEkuQml0bWFwVGV4dCh0ZXh0QXJncyBhcyBhbnkpO1xuXG4gIC8vIEFwcGx5IHBpeGVsLXBlcmZlY3QgcmVuZGVyaW5nIGlmIHJlcXVlc3RlZFxuICBpZiAocGl4ZWxQZXJmZWN0KSB7XG4gICAgdGV4dC5yb3VuZFBpeGVscyA9IHRydWU7XG4gIH1cblxuICByZXR1cm4gYXBwbHlQcm9wcyh0ZXh0LCBwcm9wcyk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIFNwcml0ZSBpbnN0YW5jZSB3aXRoIGNvbnN0cnVjdG9yIGFyZ3MgYW5kIG9wdGlvbmFsIHByb3BlcnRpZXNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHNwcml0ZSA9IGFzU3ByaXRlKFxuICogICB7IHRleHR1cmUgfSxcbiAqICAgeyB4OiAxMDAsIHk6IDEwMCwgYW5jaG9yOiAwLjUgfVxuICogKTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNTcHJpdGUoXG4gIGNvbnN0cnVjdG9yQXJnczogU3ByaXRlT3B0aW9ucyxcbiAgcHJvcHM/OiBQaXhpUHJvcHNcbik6IFBJWEkuU3ByaXRlIHtcbiAgY29uc3Qgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKGNvbnN0cnVjdG9yQXJncyBhcyBhbnkpO1xuICByZXR1cm4gYXBwbHlQcm9wcyhzcHJpdGUsIHByb3BzKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgVGV4dCBpbnN0YW5jZSB3aXRoIGNvbnN0cnVjdG9yIGFyZ3MgYW5kIG9wdGlvbmFsIHByb3BlcnRpZXNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHRleHQgPSBhc1RleHQoXG4gKiAgIHsgdGV4dDogJ0hlbGxvJywgc3R5bGU6IHsgZm9udEZhbWlseTogJ0FyaWFsJywgZm9udFNpemU6IDI0IH0gfSxcbiAqICAgeyB4OiAxMDAsIHk6IDUwIH1cbiAqICk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzVGV4dChcbiAgY29uc3RydWN0b3JBcmdzOiBUZXh0T3B0aW9ucyxcbiAgcHJvcHM/OiBQaXhpUHJvcHNcbik6IFBJWEkuVGV4dCB7XG4gIGNvbnN0IHRleHQgPSBuZXcgUElYSS5UZXh0KGNvbnN0cnVjdG9yQXJncyBhcyBhbnkpO1xuICByZXR1cm4gYXBwbHlQcm9wcyh0ZXh0LCBwcm9wcyk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIEdyYXBoaWNzIGluc3RhbmNlIHdpdGggb3B0aW9uYWwgcHJvcGVydGllc1xuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgZ3JhcGhpY3MgPSBhc0dyYXBoaWNzKHsgeDogMTAwLCB5OiAxMDAgfSk7XG4gKiBncmFwaGljcy5yZWN0KDAsIDAsIDUwLCA1MCkuZmlsbCgweGZmMDAwMCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzR3JhcGhpY3MocHJvcHM/OiBQaXhpUHJvcHMpOiBQSVhJLkdyYXBoaWNzIHtcbiAgY29uc3QgZ3JhcGhpY3MgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICByZXR1cm4gYXBwbHlQcm9wcyhncmFwaGljcywgcHJvcHMpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBDb250YWluZXIgaW5zdGFuY2Ugd2l0aCBvcHRpb25hbCBwcm9wZXJ0aWVzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBjb250YWluZXIgPSBhc0NvbnRhaW5lcih7IHg6IDEwMCwgeTogMTAwIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc0NvbnRhaW5lcihwcm9wcz86IFBpeGlQcm9wcyk6IFBJWEkuQ29udGFpbmVyIHtcbiAgY29uc3QgY29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gIHJldHVybiBhcHBseVByb3BzKGNvbnRhaW5lciwgcHJvcHMpO1xufVxuXG4iLCJpbXBvcnQgeyBQb2ludCB9IGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgT25FdmVudCwgQ2xpZW50RXZlbnRzQXJncyB9IGZyb20gJy4uJztcblxuLyoqXG4gKiBTaW5nbGV0b24gaW5wdXQgbWFuYWdlciBmb3Iga2V5Ym9hcmQsIG1vdXNlLCBhbmQgd2hlZWwgZXZlbnRzLlxuICogVHJhY2tzIGN1cnJlbnQgaW5wdXQgc3RhdGUgZm9yIHBvbGxpbmctYmFzZWQgaW5wdXQgaGFuZGxpbmcuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjb25zdCBpbnB1dCA9IENsaWVudEV2ZW50cy5nZXRJbnN0YW5jZSgpO1xuICpcbiAqIC8vIEluIHVwZGF0ZSBsb29wIC0gY2hlY2sga2V5IHN0YXRlXG4gKiBpZiAoaW5wdXQuaXNLZXlEb3duKCdBcnJvd1JpZ2h0JykpIHBsYXllci5tb3ZlUmlnaHQoKTtcbiAqIGlmIChpbnB1dC5pc0tleURvd24oJ1NwYWNlJykpIHBsYXllci5qdW1wKCk7XG4gKlxuICogLy8gTW91c2UgcG9zaXRpb24gYW5kIG1vdmVtZW50XG4gKiBjb25zdCBtb3VzZVBvcyA9IGlucHV0Lm1vdmVQb3NpdGlvbjtcbiAqIGNvbnN0IGRlbHRhID0gaW5wdXQubW92ZURlbHRhO1xuICpcbiAqIC8vIFdoZWVsIHNjcm9sbGluZ1xuICogY29uc3Qgc2Nyb2xsID0gaW5wdXQud2hlZWxPZmZzZXRzO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBDbGllbnRFdmVudHMge1xuICAvKiogQ3VycmVudCB3aGVlbCBzY3JvbGwgZGVsdGEuICovXG4gIHdoZWVsRGVsdGE6IHsgeVZhbHVlOiBudW1iZXI7IHhWYWx1ZTogbnVtYmVyOyB9O1xuICAvKiogTW9zdCByZWNlbnQgbW91c2V1cCBldmVudC4gKi9cbiAgbW91c2VVcEV2ZW50OiBNb3VzZUV2ZW50O1xuICAvKiogTW9zdCByZWNlbnQgbW91c2Vkb3duIGV2ZW50LiAqL1xuICBtb3VzZURvd25FdmVudDogTW91c2VFdmVudDtcbiAgLyoqIExhc3QgbW91c2Vkb3duIGV2ZW50LiAqL1xuICBsYXN0TW91c2VEb3duOiBNb3VzZUV2ZW50O1xuICAvKiogTGFzdCBtb3VzZXVwIGV2ZW50LiAqL1xuICBsYXN0TW91c2VVcDogTW91c2VFdmVudDtcbiAgLyoqIE1vc3QgcmVjZW50IGtleWRvd24gZXZlbnQuICovXG4gIGtleURvd25FdmVudDogS2V5Ym9hcmRFdmVudDtcbiAgLyoqIE1vc3QgcmVjZW50IGtleXVwIGV2ZW50LiAqL1xuICBrZXlVcEV2ZW50OiBLZXlib2FyZEV2ZW50O1xuICAvKiogQGludGVybmFsIEN1cnJlbnRseSBwcmVzc2VkIGtleXMuICovXG4gIGtleWRvd246IFJlY29yZDxzdHJpbmcsIEtleWJvYXJkRXZlbnQ+O1xuICAvKiogQWNjdW11bGF0ZWQgd2hlZWwgb2Zmc2V0cy4gKi9cbiAgd2hlZWxPZmZzZXRzOiBQb2ludDtcbiAgLyoqIEN1cnJlbnQgbW91c2UgcG9zaXRpb24uICovXG4gIG1vdmVQb3NpdGlvbjogUG9pbnQ7XG4gIC8qKiBQcmV2aW91cyBtb3VzZSBwb3NpdGlvbi4gKi9cbiAgbGFzdE1vdmVQb3NpdGlvbjogUG9pbnQ7XG4gIC8qKiBNb3VzZSBtb3ZlbWVudCBkZWx0YS4gKi9cbiAgbW92ZURlbHRhOiBQb2ludDtcblxuICAvKiogQGludGVybmFsICovXG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBDbGllbnRFdmVudHMgfCBudWxsID0gbnVsbDtcblxuICAvKiogR2V0IHNpbmdsZXRvbiBpbnN0YW5jZS4gKi9cbiAgc3RhdGljIGdldEluc3RhbmNlKG9wdGlvbnM6IENsaWVudEV2ZW50c0FyZ3MgPSB7fSk6IENsaWVudEV2ZW50cyB7XG4gICAgaWYgKCFDbGllbnRFdmVudHMuaW5zdGFuY2UpIHtcbiAgICAgIENsaWVudEV2ZW50cy5pbnN0YW5jZSA9IG5ldyBDbGllbnRFdmVudHMob3B0aW9ucyk7XG4gICAgfVxuICAgIHJldHVybiBDbGllbnRFdmVudHMuaW5zdGFuY2U7XG4gIH1cblxuICAvKiogQGludGVybmFsIFVzZSBnZXRJbnN0YW5jZSgpIGluc3RlYWQuICovXG4gIGNvbnN0cnVjdG9yKHsgaW5pdFdoZWVsT2Zmc2V0ID0gbmV3IFBvaW50KCksIG9uQW55RXZlbnQgPSAoZXY6IE9uRXZlbnQpID0+IHt9IH06IENsaWVudEV2ZW50c0FyZ3MgPSB7fSkge1xuICAgIC8vIFJldHVybiBleGlzdGluZyBpbnN0YW5jZSBpZiBvbmUgZXhpc3RzIChzaW5nbGV0b24gcGF0dGVybilcbiAgICBpZiAoQ2xpZW50RXZlbnRzLmluc3RhbmNlKSB7XG4gICAgICByZXR1cm4gQ2xpZW50RXZlbnRzLmluc3RhbmNlO1xuICAgIH1cbiAgICB0aGlzLndoZWVsT2Zmc2V0cyA9IGluaXRXaGVlbE9mZnNldDtcbiAgICB0aGlzLmtleWRvd24gPSB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBLZXlib2FyZEV2ZW50PjtcbiAgICB0aGlzLm1vdmVQb3NpdGlvbiA9IG5ldyBQb2ludCgpO1xuXG4gICAgY29uc3QgYW55RXZlbnQgPSAoZXY6IE9uRXZlbnQpID0+IHtcbiAgICAgIG9uQW55RXZlbnQoZXYpO1xuICAgIH07XG5cbiAgICAvLyBSZWdpc3RlciB3aGVlbCBldmVudCBsaXN0ZW5lclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB3aGVlbERlbHRhID0gdGhpcy53aGVlbE9mZnNldHMgfHwgbmV3IFBvaW50KCk7XG4gICAgICBjb25zdCB4VmFsdWUgPSB3aGVlbERlbHRhLnggKyBldmVudC5kZWx0YVg7XG4gICAgICBjb25zdCB5VmFsdWUgPSB3aGVlbERlbHRhLnkgKyBldmVudC5kZWx0YVk7XG4gICAgICB0aGlzLndoZWVsT2Zmc2V0cyA9IG5ldyBQb2ludCh4VmFsdWUsIHlWYWx1ZSk7XG4gICAgICBhbnlFdmVudCh7IGV2ZW50VHlwZTogJ3doZWVsJywgZXZlbnQgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZWdpc3RlciBtb3VzZSBtb3ZlIGV2ZW50IGxpc3RlbmVyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLmxhc3RNb3ZlUG9zaXRpb24gPSB0aGlzLm1vdmVQb3NpdGlvbjtcbiAgICAgIHRoaXMubW92ZVBvc2l0aW9uID0gbmV3IFBvaW50KGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkpO1xuICAgICAgdGhpcy5tb3ZlRGVsdGEgPSBuZXcgUG9pbnQoXG4gICAgICAgIHRoaXMubW92ZVBvc2l0aW9uLnggLSB0aGlzLmxhc3RNb3ZlUG9zaXRpb24ueCxcbiAgICAgICAgdGhpcy5tb3ZlUG9zaXRpb24ueSAtIHRoaXMubGFzdE1vdmVQb3NpdGlvbi55XG4gICAgICApO1xuICAgICAgYW55RXZlbnQoeyBldmVudFR5cGU6ICdtb3VzZW1vdmUnLCBldmVudCB9KTtcbiAgICB9KTtcblxuICAgIC8vIFJlZ2lzdGVyIG1vdXNlIGRvd24gZXZlbnQgbGlzdGVuZXJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMubW91c2VEb3duRXZlbnQgPSBldmVudDtcbiAgICAgIHRoaXMubGFzdE1vdXNlRG93biA9IGV2ZW50O1xuICAgICAgdGhpcy5tb3VzZVVwRXZlbnQgPSBudWxsO1xuICAgICAgYW55RXZlbnQoeyBldmVudFR5cGU6ICdtb3VzZWRvd24nLCBldmVudCB9KTtcbiAgICB9KTtcblxuICAgIC8vIFJlZ2lzdGVyIG1vdXNlIHVwIGV2ZW50IGxpc3RlbmVyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5tb3VzZVVwRXZlbnQgPSBldmVudDtcbiAgICAgIHRoaXMubGFzdE1vdXNlVXAgPSBldmVudDtcbiAgICAgIHRoaXMubW91c2VEb3duRXZlbnQgPSBudWxsO1xuICAgICAgYW55RXZlbnQoeyBldmVudFR5cGU6ICdtb3VzZXVwJywgZXZlbnQgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZWdpc3RlciBrZXkgZG93biBldmVudCBsaXN0ZW5lclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsga2V5IH0gPSBldmVudDtcbiAgICAgIHRoaXMua2V5RG93bkV2ZW50ID0gZXZlbnQ7XG4gICAgICB0aGlzLmtleVVwRXZlbnQgPSBudWxsO1xuICAgICAgdGhpcy5rZXlkb3duW2tleV0gPSBldmVudDtcbiAgICAgIGFueUV2ZW50KHsgZXZlbnRUeXBlOiAna2V5ZG93bicsIGV2ZW50IH0pO1xuICAgIH0pO1xuXG4gICAgLy8gUmVnaXN0ZXIga2V5IHVwIGV2ZW50IGxpc3RlbmVyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsga2V5IH0gPSBldmVudDtcbiAgICAgIHRoaXMua2V5VXBFdmVudCA9IGV2ZW50O1xuICAgICAgdGhpcy5rZXlEb3duRXZlbnQgPSBudWxsO1xuICAgICAgZGVsZXRlIHRoaXMua2V5ZG93bltrZXldO1xuICAgICAgYW55RXZlbnQoeyBldmVudFR5cGU6ICdrZXl1cCcsIGV2ZW50IH0pO1xuICAgIH0pO1xuXG4gICAgQ2xpZW50RXZlbnRzLmluc3RhbmNlID0gdGhpcztcbiAgfVxuXG4gIC8qKiBUcnVlIGlmIGtleSBpcyBjdXJyZW50bHkgcHJlc3NlZC4gKi9cbiAgaXNLZXlEb3duKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIEJvb2xlYW4odGhpcy5rZXlkb3duW2tleV0pO1xuICB9XG5cbiAgLyoqIFRydWUgaWYga2V5IGlzIG5vdCBwcmVzc2VkLiAqL1xuICBpc0tleVVwKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICF0aGlzLmtleWRvd25ba2V5XTtcbiAgfVxufVxuXG5cblxuIiwiaW1wb3J0IHsgQ29udGFpbmVyLCBHcmFwaGljcywgVGV4dCB9IGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHR5cGUgeyBMb2FkaW5nQW5pbWF0aW9uLCBMb2FkaW5nQW5pbWF0aW9uQ29udGV4dCB9IGZyb20gJy4vbG9hZGluZy1zY2VuZSc7XG5cbi8qKlxuICogT3B0aW9ucyBmb3IgdGhlIGRlZmF1bHQgZmFsbGluZyBzcXVhcmVzIGFuaW1hdGlvbi5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGYWxsaW5nU3F1YXJlc09wdGlvbnMge1xuICAvKiogU2l6ZSBvZiBzcXVhcmVzIGluIHBpeGVscyAoZGVmYXVsdDogMjApICovXG4gIHNxdWFyZVNpemU/OiBudW1iZXI7XG4gIC8qKiBNYXhpbXVtIG51bWJlciBvZiBwYXJ0aWNsZXMgKGRlZmF1bHQ6IDMwKSAqL1xuICBtYXhQYXJ0aWNsZXM/OiBudW1iZXI7XG4gIC8qKiBDb2xvciBwYWxldHRlIC0gYXJyYXkgb2YgaGV4IGNvbG9ycyAoZGVmYXVsdDogcGFzdGVsIHBpeGVsIGFydCBwYWxldHRlKSAqL1xuICBwYWxldHRlPzogbnVtYmVyW107XG4gIC8qKiBTcGF3biByYXRlIC0gbG93ZXIgaXMgZmFzdGVyIChkZWZhdWx0OiAwLjUpICovXG4gIHNwYXduSW50ZXJ2YWw/OiBudW1iZXI7XG59XG5cbi8qKiBEZWZhdWx0IHBhc3RlbCBwaXhlbCBhcnQgY29sb3IgcGFsZXR0ZSAqL1xuY29uc3QgREVGQVVMVF9QQUxFVFRFID0gWzB4ZjBkYWIxLCAweGUzOWFhYywgMHhjNDVkOWYsIDB4NjM0YjdkLCAweDY0NjFjMiwgMHgyYmE5YjQsIDB4OTNkNGI1LCAweGYwZjZlOF07XG5cbmludGVyZmFjZSBQYXJ0aWNsZSB7XG4gIHNwcml0ZTogR3JhcGhpY3M7XG4gIHNwYXduVGltZTogbnVtYmVyO1xuICBkdXJhdGlvbjogbnVtYmVyO1xuICBzcGluUmF0ZTogbnVtYmVyO1xuICBzdGFydFg6IG51bWJlcjtcbiAgc3RhcnRZOiBudW1iZXI7XG4gIGVuZFk6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBEZWZhdWx0IGxvYWRpbmcgYW5pbWF0aW9uIC0gY29sb3JmdWwgc3F1YXJlcyBmYWxsaW5nIGFib3ZlIHRoZSBsb2FkaW5nIHRleHQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiAvLyBVc2Ugd2l0aCBjdXN0b20gb3B0aW9uc1xuICogY29uc3QgYW5pbWF0aW9uID0gbmV3IEZhbGxpbmdTcXVhcmVzQW5pbWF0aW9uKHtcbiAqICAgc3F1YXJlU2l6ZTogMTYsXG4gKiAgIG1heFBhcnRpY2xlczogNTAsXG4gKiAgIHBhbGV0dGU6IFsweGZmMDAwMCwgMHgwMGZmMDAsIDB4MDAwMGZmXVxuICogfSk7XG4gKlxuICogY29uc3QgeyBsb2FkaW5nU2NlbmUgfSA9IGF3YWl0IHNldHVwTW94aSh7XG4gKiAgIHNob3dMb2FkaW5nU2NlbmU6IHRydWUsXG4gKiAgIGxvYWRpbmdTY2VuZU9wdGlvbnM6IHsgYW5pbWF0aW9uIH1cbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBGYWxsaW5nU3F1YXJlc0FuaW1hdGlvbiBpbXBsZW1lbnRzIExvYWRpbmdBbmltYXRpb24ge1xuICBwcml2YXRlIHBhcnRpY2xlczogUGFydGljbGVbXSA9IFtdO1xuICBwcml2YXRlIGNvbnRhaW5lcjogQ29udGFpbmVyIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgbmV4dFNwYXduOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIHRpbWU6IG51bWJlciA9IDA7XG5cbiAgcHJpdmF0ZSBzcXVhcmVTaXplOiBudW1iZXI7XG4gIHByaXZhdGUgbWF4UGFydGljbGVzOiBudW1iZXI7XG4gIHByaXZhdGUgcGFsZXR0ZTogbnVtYmVyW107XG4gIHByaXZhdGUgc3Bhd25JbnRlcnZhbDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IEZhbGxpbmdTcXVhcmVzT3B0aW9ucyA9IHt9KSB7XG4gICAgdGhpcy5zcXVhcmVTaXplID0gb3B0aW9ucy5zcXVhcmVTaXplID8/IDIwO1xuICAgIHRoaXMubWF4UGFydGljbGVzID0gb3B0aW9ucy5tYXhQYXJ0aWNsZXMgPz8gMzA7XG4gICAgdGhpcy5wYWxldHRlID0gb3B0aW9ucy5wYWxldHRlID8/IERFRkFVTFRfUEFMRVRURTtcbiAgICB0aGlzLnNwYXduSW50ZXJ2YWwgPSBvcHRpb25zLnNwYXduSW50ZXJ2YWwgPz8gMC41O1xuICB9XG5cbiAgaW5pdChjb250YWluZXI6IENvbnRhaW5lcik6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICB9XG5cbiAgdXBkYXRlKGNvbnRleHQ6IExvYWRpbmdBbmltYXRpb25Db250ZXh0KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmNvbnRhaW5lcikgcmV0dXJuO1xuXG4gICAgdGhpcy50aW1lID0gY29udGV4dC50aW1lO1xuICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCwgdGV4dEVsZW1lbnQgfSA9IGNvbnRleHQ7XG5cbiAgICAvLyBTcGF3biBuZXcgcGFydGljbGVzXG4gICAgdGhpcy5zcGF3blBhcnRpY2xlKHdpZHRoLCBoZWlnaHQsIHRleHRFbGVtZW50KTtcblxuICAgIC8vIFVwZGF0ZSBleGlzdGluZyBwYXJ0aWNsZXNcbiAgICB0aGlzLnBhcnRpY2xlcyA9IHRoaXMucGFydGljbGVzLmZpbHRlcihwID0+IHtcbiAgICAgIGNvbnN0IGVsYXBzZWQgPSB0aGlzLnRpbWUgLSBwLnNwYXduVGltZTtcbiAgICAgIGNvbnN0IHByb2dyZXNzID0gZWxhcHNlZCAvIHAuZHVyYXRpb247XG5cbiAgICAgIGlmIChwcm9ncmVzcyA8IDAgfHwgcHJvZ3Jlc3MgPiAxKSB7XG4gICAgICAgIHAuc3ByaXRlLmRlc3Ryb3koKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBwLnNwcml0ZS54ID0gcC5zdGFydFg7XG4gICAgICBwLnNwcml0ZS55ID0gcC5zdGFydFkgKyAocC5lbmRZIC0gcC5zdGFydFkpICogcHJvZ3Jlc3M7XG4gICAgICBwLnNwcml0ZS5yb3RhdGlvbiA9IHRoaXMudGltZSAqIHAuc3BpblJhdGUgKiBNYXRoLlBJICogMjtcbiAgICAgIHAuc3ByaXRlLmFscGhhID0gcHJvZ3Jlc3MgPCAwLjEgPyBwcm9ncmVzcyAvIDAuMSA6IHByb2dyZXNzID4gMC44NSA/ICgxIC0gcHJvZ3Jlc3MpIC8gMC4xNSA6IDE7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgc3Bhd25QYXJ0aWNsZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgdGV4dEVsZW1lbnQ6IFRleHQpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuY29udGFpbmVyKSByZXR1cm47XG4gICAgaWYgKHRoaXMucGFydGljbGVzLmxlbmd0aCA+PSB0aGlzLm1heFBhcnRpY2xlcyB8fCB0aGlzLnRpbWUgPCB0aGlzLm5leHRTcGF3bikgcmV0dXJuO1xuXG4gICAgY29uc3Qgc2l6ZSA9IHRoaXMuc3F1YXJlU2l6ZSAqICgwLjcgKyBNYXRoLnJhbmRvbSgpICogMC42KTtcbiAgICBjb25zdCBzcHJpdGUgPSBuZXcgR3JhcGhpY3MoKTtcbiAgICBzcHJpdGUucmVjdCgwLCAwLCBzaXplLCBzaXplKTtcbiAgICBzcHJpdGUuZmlsbCh7IGNvbG9yOiB0aGlzLnBhbGV0dGVbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy5wYWxldHRlLmxlbmd0aCldIH0pO1xuICAgIHNwcml0ZS5waXZvdC5zZXQoc2l6ZSAvIDIsIHNpemUgLyAyKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZChzcHJpdGUpO1xuXG4gICAgY29uc3QgdGV4dFkgPSB0ZXh0RWxlbWVudC55O1xuICAgIGNvbnN0IHRleHRXaWR0aCA9IHRleHRFbGVtZW50LndpZHRoIHx8IDIwMDtcbiAgICBjb25zdCB0ZXh0Q2VudGVyWCA9IHdpZHRoIC8gMjtcblxuICAgIHRoaXMucGFydGljbGVzLnB1c2goe1xuICAgICAgc3ByaXRlLFxuICAgICAgc3Bhd25UaW1lOiB0aGlzLnRpbWUsXG4gICAgICBkdXJhdGlvbjogMSArIE1hdGgucmFuZG9tKCkgKiAyLjUsXG4gICAgICBzcGluUmF0ZTogKDAuMDUgKyBNYXRoLnJhbmRvbSgpICogMS4wNzUpICogKE1hdGgucmFuZG9tKCkgPCAwLjUgPyAxIDogLTEpLFxuICAgICAgc3RhcnRYOiB0ZXh0Q2VudGVyWCAtIHRleHRXaWR0aCAvIDIgKyBNYXRoLnJhbmRvbSgpICogdGV4dFdpZHRoIC0gNCxcbiAgICAgIHN0YXJ0WTogdGV4dFkgLSAxMDAsXG4gICAgICBlbmRZOiB0ZXh0WSAtIDQwLFxuICAgIH0pO1xuXG4gICAgdGhpcy5uZXh0U3Bhd24gPSB0aGlzLnRpbWUgKyBNYXRoLnJhbmRvbSgpICogdGhpcy5zcGF3bkludGVydmFsO1xuICB9XG5cbiAgcmVzZXQoKTogdm9pZCB7XG4gICAgdGhpcy50aW1lID0gMDtcbiAgICB0aGlzLm5leHRTcGF3biA9IDA7XG4gICAgdGhpcy5wYXJ0aWNsZXMuZm9yRWFjaChwID0+IHAuc3ByaXRlLmRlc3Ryb3koKSk7XG4gICAgdGhpcy5wYXJ0aWNsZXMgPSBbXTtcbiAgfVxuXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5wYXJ0aWNsZXMuZm9yRWFjaChwID0+IHAuc3ByaXRlLmRlc3Ryb3koKSk7XG4gICAgdGhpcy5wYXJ0aWNsZXMgPSBbXTtcbiAgICB0aGlzLmNvbnRhaW5lciA9IG51bGw7XG4gIH1cbn1cbiIsImltcG9ydCBGb250RmFjZU9ic2VydmVyIGZyb20gJ2ZvbnRmYWNlb2JzZXJ2ZXInO1xuaW1wb3J0IHsgQml0bWFwRm9udCB9IGZyb20gJ3BpeGkuanMnO1xuXG5leHBvcnQgY29uc3QgbG9hZEZvbnRzID0gYXN5bmMgKCkgPT4ge1xuICAvLyBub3RlIHRoYXQgdGhpcyByZWZlcmVuY2VzIHRoZSBmb250LWZhY2Ugc3BlY2lmaWVkIGluIHRoZSBIVE1MIHN0eWxlIHNlY3Rpb25cbiAgLy8gPHN0eWxlPlxuICAvLyBAZm9udC1mYWNlIHtcbiAgLy8gICBmb250LWZhbWlseTogJ2tlbmZ1dHVyZS10aGluJztcbiAgLy8gICBzcmM6IHVybCgnLi9hc3NldHMvZm9udHMva2VudmVjdG9yX2Z1dHVyZV90aGluLnR0ZicpO1xuICAvLyB9XG4gIC8vIDwvc3R5bGU+XG5cbiAgLy8gdXNpbmcgZm9udGZhY2VvYnNlcnZlciBhbGxvd3MgdXMgZW5zdXJlIHRoZSBmb250IGlzIGxvYWRlZCBiZWZvcmUgdXNpbmcgY29uZmlndXJhdGlvbiBmb3IgYml0bWFwIGZvbnRzLlxuICBjb25zdCBmb250S2VuZnV0dXJlVGhpbiA9IG5ldyBGb250RmFjZU9ic2VydmVyKCdrZW5mdXR1cmUtdGhpbicpO1xuXG4gIC8vIFBJWEkuQml0bWFwRm9udC5pbnN0YWxsIHdpbGwgY3JlYXRlIGEgYml0bWFwIGZvbnQgZnJvbSBhIGZvbnQtZmFjZSBhbmQgVGV4dFN0eWxlIGNvbmZpZ3VyYXRpb25cbiAgLy8gVXNpbmcgYSBCaXRtYXBmb250IGFsbG93cyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlIHdoZW4gcmFwaWRseSBjaGFuZ2luZyByZW5kZXJlZCB0ZXh0LlxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBmb250S2VuZnV0dXJlVGhpbi5sb2FkKCkudGhlbigoKSA9PiB7XG4gICAgICBCaXRtYXBGb250Lmluc3RhbGwoe1xuICAgICAgICBuYW1lOiAna2VuZnV0dXJlLXRoaW4nLFxuICAgICAgICBzdHlsZToge1xuICAgICAgICAgIGZvbnRGYW1pbHk6ICdrZW5mdXR1cmUtdGhpbidcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXNvbHZlKHsgZm9udEtlbmZ1dHVyZVRoaW4gfSk7XG4gICAgfSk7XG4gIH0pO1xufTsiLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIGdyaWQgZ2VuZXJhdGlvblxuICogQGNhdGVnb3J5IExpYnJhcnlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHcmlkT3B0aW9ucyB7XG4gIHdpZHRoOiBudW1iZXI7XG4gIGhlaWdodDogbnVtYmVyO1xuICBjZWxsV2lkdGg6IG51bWJlcjtcbiAgY2VsbEhlaWdodDogbnVtYmVyO1xuICBjZW50ZXJlZD86IGJvb2xlYW47XG59XG5cbi8qKlxuICogQ2VsbCBwb3NpdGlvbiBpbmZvcm1hdGlvbiBwYXNzZWQgdG8gY2FsbGJhY2sgZnVuY3Rpb25zXG4gKiBAY2F0ZWdvcnkgTGlicmFyeVxuICovXG5leHBvcnQgaW50ZXJmYWNlIENlbGxQb3NpdGlvbiB7XG4gIHg6IG51bWJlcjtcbiAgeTogbnVtYmVyO1xuICBwaXhlbFg6IG51bWJlcjtcbiAgcGl4ZWxZOiBudW1iZXI7XG4gIGluZGV4OiBudW1iZXI7XG4gIHRvdGFsOiBudW1iZXI7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGdyaWQgb2YgdGlsZXMgdXNpbmcgYSBzZXQgb2YgdGV4dHVyZXNcbiAqIFxuICogQGNhdGVnb3J5IExpYnJhcnlcbiAqIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgZ3JpZFxuICogQHBhcmFtIHRleHR1cmVzIC0gQXJyYXkgb2YgdGV4dHVyZXMgdG8gdXNlIGZvciB0aGUgdGlsZXNcbiAqIEBwYXJhbSBzZWxlY3RvciAtIE9wdGlvbmFsIGZ1bmN0aW9uIHRvIHNlbGVjdCB3aGljaCB0ZXh0dXJlIHRvIHVzZSBmb3IgZWFjaCBjZWxsXG4gKiBAcmV0dXJucyBBIFBJWEkgQ29udGFpbmVyIHdpdGggdGhlIGdlbmVyYXRlZCB0aWxlIGdyaWRcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIC8vIENyZWF0ZSBhIHJhbmRvbSBncmFzcyBmaWVsZFxuICogY29uc3QgZ3Jhc3NGaWVsZCA9IGNyZWF0ZVRpbGVHcmlkKHtcbiAqICAgd2lkdGg6IDY0LFxuICogICBoZWlnaHQ6IDY0LFxuICogICBjZWxsV2lkdGg6IDE2LFxuICogICBjZWxsSGVpZ2h0OiAxNixcbiAqICAgY2VudGVyZWQ6IHRydWVcbiAqIH0sIGdyYXNzVGV4dHVyZXMpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUaWxlR3JpZChcbiAgb3B0aW9uczogR3JpZE9wdGlvbnMsXG4gIHRleHR1cmVzOiBQSVhJLlRleHR1cmVbXSxcbiAgc2VsZWN0b3I/OiAocG9zaXRpb246IENlbGxQb3NpdGlvbikgPT4gbnVtYmVyXG4pOiBQSVhJLkNvbnRhaW5lciB7XG4gIGNvbnN0IHsgd2lkdGgsIGhlaWdodCwgY2VsbFdpZHRoLCBjZWxsSGVpZ2h0LCBjZW50ZXJlZCA9IGZhbHNlIH0gPSBvcHRpb25zO1xuICBcbiAgLy8gRGVmYXVsdCBzZWxlY3RvciByYW5kb21seSBjaG9vc2VzIHRleHR1cmVzXG4gIGNvbnN0IGRlZmF1bHRTZWxlY3RvciA9ICgpID0+IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRleHR1cmVzLmxlbmd0aCk7XG4gIGNvbnN0IGdldFRleHR1cmVJbmRleCA9IHNlbGVjdG9yIHx8IGRlZmF1bHRTZWxlY3RvcjtcbiAgXG4gIC8vIENyZWF0ZSBjb250YWluZXIgZm9yIHRoZSBncmlkXG4gIGNvbnN0IGNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICBcbiAgLy8gQ2FsY3VsYXRlIHRvdGFsIG51bWJlciBvZiBjZWxsc1xuICBjb25zdCB0b3RhbENlbGxzID0gd2lkdGggKiBoZWlnaHQ7XG4gIFxuICAvLyBHZW5lcmF0ZSBlYWNoIGNlbGwgaW4gdGhlIGdyaWRcbiAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykge1xuICAgIGZvciAobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykge1xuICAgICAgLy8gQ2FsY3VsYXRlIHBpeGVsIGNvb3JkaW5hdGVzXG4gICAgICBjb25zdCBwaXhlbFggPSB4ICogY2VsbFdpZHRoO1xuICAgICAgY29uc3QgcGl4ZWxZID0geSAqIGNlbGxIZWlnaHQ7XG4gICAgICBcbiAgICAgIC8vIENhbGN1bGF0ZSBpbmRleFxuICAgICAgY29uc3QgaW5kZXggPSB5ICogd2lkdGggKyB4O1xuICAgICAgXG4gICAgICAvLyBDcmVhdGUgY2VsbCBwb3NpdGlvbiBpbmZvXG4gICAgICBjb25zdCBwb3NpdGlvbjogQ2VsbFBvc2l0aW9uID0ge1xuICAgICAgICB4LCB5LCBwaXhlbFgsIHBpeGVsWSwgaW5kZXgsIHRvdGFsOiB0b3RhbENlbGxzXG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBHZXQgdGV4dHVyZSBpbmRleCBmb3IgdGhpcyBwb3NpdGlvblxuICAgICAgY29uc3QgdGV4dHVyZUluZGV4ID0gZ2V0VGV4dHVyZUluZGV4KHBvc2l0aW9uKTtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHNwcml0ZSB3aXRoIHRoZSBzZWxlY3RlZCB0ZXh0dXJlXG4gICAgICBjb25zdCBjZWxsID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmVzW3RleHR1cmVJbmRleF0pO1xuICAgICAgY2VsbC5wb3NpdGlvbi5zZXQocGl4ZWxYLCBwaXhlbFkpO1xuICAgICAgXG4gICAgICAvLyBBZGQgdG8gY29udGFpbmVyXG4gICAgICBjb250YWluZXIuYWRkQ2hpbGQoY2VsbCk7XG4gICAgfVxuICB9XG4gIFxuICAvLyBDZW50ZXIgdGhlIGdyaWQgaWYgcmVxdWVzdGVkXG4gIGlmIChjZW50ZXJlZCkge1xuICAgIGNvbnN0IGdyaWRXaWR0aCA9IHdpZHRoICogY2VsbFdpZHRoO1xuICAgIGNvbnN0IGdyaWRIZWlnaHQgPSBoZWlnaHQgKiBjZWxsSGVpZ2h0O1xuICAgIGNvbnRhaW5lci5wb3NpdGlvbi5zZXQoLWdyaWRXaWR0aCAvIDIsIC1ncmlkSGVpZ2h0IC8gMik7XG4gIH1cbiAgXG4gIHJldHVybiBjb250YWluZXI7XG59XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBhIHJhbmdlIG9mIHRleHR1cmVzXG4gKiBcbiAqIEBjYXRlZ29yeSBMaWJyYXJ5XG4gKiBAcGFyYW0gdGV4dHVyZXMgLSBGdWxsIGFycmF5IG9mIHRleHR1cmVzXG4gKiBAcGFyYW0gc3RhcnRJbmRleCAtIFN0YXJ0aW5nIGluZGV4IChmcm9tIDApXG4gKiBAcGFyYW0gY291bnQgLSBOdW1iZXIgb2YgdGV4dHVyZXMgdG8gaW5jbHVkZVxuICogQHJldHVybnMgU3Vic2V0IG9mIHRleHR1cmVzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiAvLyBHZXQgdGhlIGxhc3QgMTIgZnJhbWVzIGZyb20gYSBzcHJpdGVzaGVldFxuICogY29uc3QgdGlsZVZhcmlhdGlvbnMgPSBnZXRUZXh0dXJlUmFuZ2UoZ3Jhc3NGcmFtZXMsIGdyYXNzRnJhbWVzLmxlbmd0aCAtIDEyLCAxMik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRleHR1cmVSYW5nZShcbiAgdGV4dHVyZXM6IFBJWEkuVGV4dHVyZVtdLFxuICBzdGFydEluZGV4OiBudW1iZXIsXG4gIGNvdW50OiBudW1iZXJcbik6IFBJWEkuVGV4dHVyZVtdIHtcbiAgcmV0dXJuIHRleHR1cmVzLnNsaWNlKHN0YXJ0SW5kZXgsIHN0YXJ0SW5kZXggKyBjb3VudCk7XG59XG5cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgQ29udGFpbmVyLCBHcmFwaGljcywgVGV4dCB9IGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgRmFsbGluZ1NxdWFyZXNBbmltYXRpb24sIEZhbGxpbmdTcXVhcmVzT3B0aW9ucyB9IGZyb20gJy4vZmFsbGluZy1zcXVhcmVzLWFuaW1hdGlvbic7XG5cbi8vIFJlLWV4cG9ydCBmb3IgY29udmVuaWVuY2VcbmV4cG9ydCB7IEZhbGxpbmdTcXVhcmVzQW5pbWF0aW9uIH07XG5leHBvcnQgdHlwZSB7IEZhbGxpbmdTcXVhcmVzT3B0aW9ucyB9O1xuXG4vKipcbiAqIEludGVyZmFjZSBmb3IgY3VzdG9tIGxvYWRpbmcgYW5pbWF0aW9ucy5cbiAqIEltcGxlbWVudCB0aGlzIHRvIGNyZWF0ZSB5b3VyIG93biBsb2FkaW5nIGFuaW1hdGlvbiBwbHVnaW4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjbGFzcyBTcGlubmVyQW5pbWF0aW9uIGltcGxlbWVudHMgTG9hZGluZ0FuaW1hdGlvbiB7XG4gKiAgIHByaXZhdGUgc3Bpbm5lcjogR3JhcGhpY3M7XG4gKiAgIHByaXZhdGUgcm90YXRpb24gPSAwO1xuICpcbiAqICAgaW5pdChjb250YWluZXI6IENvbnRhaW5lcikge1xuICogICAgIHRoaXMuc3Bpbm5lciA9IG5ldyBHcmFwaGljcygpO1xuICogICAgIHRoaXMuc3Bpbm5lci5hcmMoMCwgMCwgMzAsIDAsIE1hdGguUEkgKiAxLjUpO1xuICogICAgIHRoaXMuc3Bpbm5lci5zdHJva2UoeyB3aWR0aDogNCwgY29sb3I6IDB4ZmZmZmZmIH0pO1xuICogICAgIGNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnNwaW5uZXIpO1xuICogICB9XG4gKlxuICogICB1cGRhdGUoY29udGV4dDogTG9hZGluZ0FuaW1hdGlvbkNvbnRleHQpIHtcbiAqICAgICB0aGlzLnJvdGF0aW9uICs9IGNvbnRleHQuZGVsdGFUaW1lICogNTtcbiAqICAgICB0aGlzLnNwaW5uZXIucm90YXRpb24gPSB0aGlzLnJvdGF0aW9uO1xuICogICAgIHRoaXMuc3Bpbm5lci54ID0gY29udGV4dC53aWR0aCAvIDI7XG4gKiAgICAgdGhpcy5zcGlubmVyLnkgPSBjb250ZXh0LmhlaWdodCAvIDIgLSAyMDtcbiAqICAgfVxuICpcbiAqICAgcmVzZXQoKSB7IHRoaXMucm90YXRpb24gPSAwOyB9XG4gKiAgIGRlc3Ryb3koKSB7IHRoaXMuc3Bpbm5lcj8uZGVzdHJveSgpOyB9XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBMb2FkaW5nQW5pbWF0aW9uIHtcbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIGFuaW1hdGlvbi4gQWRkIHlvdXIgZGlzcGxheSBvYmplY3RzIHRvIHRoZSBjb250YWluZXIuXG4gICAqIEBwYXJhbSBjb250YWluZXIgLSBQYXJlbnQgY29udGFpbmVyIHRvIGFkZCBhbmltYXRpb24gZWxlbWVudHMgdG9cbiAgICovXG4gIGluaXQoY29udGFpbmVyOiBDb250YWluZXIpOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgYW5pbWF0aW9uIGVhY2ggZnJhbWUuXG4gICAqIEBwYXJhbSBjb250ZXh0IC0gQ3VycmVudCBhbmltYXRpb24gY29udGV4dCB3aXRoIHRpbWluZyBhbmQgZGltZW5zaW9uc1xuICAgKi9cbiAgdXBkYXRlKGNvbnRleHQ6IExvYWRpbmdBbmltYXRpb25Db250ZXh0KTogdm9pZDtcblxuICAvKipcbiAgICogUmVzZXQgYW5pbWF0aW9uIHN0YXRlIHdoZW4gbG9hZGluZyBzdGFydHMuXG4gICAqL1xuICByZXNldCgpOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBDbGVhbiB1cCBhbmltYXRpb24gcmVzb3VyY2VzLlxuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkO1xufVxuXG4vKipcbiAqIENvbnRleHQgcGFzc2VkIHRvIExvYWRpbmdBbmltYXRpb24udXBkYXRlKCkgZWFjaCBmcmFtZS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBMb2FkaW5nQW5pbWF0aW9uQ29udGV4dCB7XG4gIC8qKiBUb3RhbCBlbGFwc2VkIHRpbWUgaW4gc2Vjb25kcyBzaW5jZSBsb2FkaW5nIHN0YXJ0ZWQgKi9cbiAgdGltZTogbnVtYmVyO1xuICAvKiogRGVsdGEgdGltZSBpbiBzZWNvbmRzIHNpbmNlIGxhc3QgZnJhbWUgKi9cbiAgZGVsdGFUaW1lOiBudW1iZXI7XG4gIC8qKiBTY3JlZW4gd2lkdGggaW4gcGl4ZWxzICovXG4gIHdpZHRoOiBudW1iZXI7XG4gIC8qKiBTY3JlZW4gaGVpZ2h0IGluIHBpeGVscyAqL1xuICBoZWlnaHQ6IG51bWJlcjtcbiAgLyoqIExvYWRpbmcgdGV4dCBlbGVtZW50IChmb3IgcG9zaXRpb25pbmcgcmVsYXRpdmUgdG8gdGV4dCkgKi9cbiAgdGV4dEVsZW1lbnQ6IFRleHQ7XG59XG5cbi8qKlxuICogTG9hZGluZyBzY2VuZSBvcHRpb25zLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIExvYWRpbmdTY2VuZU9wdGlvbnMge1xuICAvKiogQmFja2dyb3VuZCBjb2xvciAoZGVmYXVsdDogMHgxYTFhMWEpICovXG4gIGJhY2tncm91bmRDb2xvcj86IG51bWJlcjtcbiAgLyoqIExvYWRpbmcgdGV4dCAoZGVmYXVsdDogJ0xPQURJTkcuLi4nKSAqL1xuICB0ZXh0Pzogc3RyaW5nO1xuICAvKiogVGV4dCBzdHlsZSBvdmVycmlkZXMgKi9cbiAgdGV4dFN0eWxlPzogUGFydGlhbDxQSVhJLlRleHRTdHlsZT47XG4gIC8qKlxuICAgKiBDdXN0b20gbG9hZGluZyBhbmltYXRpb24gcGx1Z2luLlxuICAgKiBJZiBub3QgcHJvdmlkZWQsIHVzZXMgRmFsbGluZ1NxdWFyZXNBbmltYXRpb24uXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHRzXG4gICAqIC8vIEN1c3RvbSBhbmltYXRpb25cbiAgICogY29uc3Qgb3B0aW9uczogTG9hZGluZ1NjZW5lT3B0aW9ucyA9IHtcbiAgICogICBhbmltYXRpb246IG5ldyBNeUN1c3RvbUFuaW1hdGlvbigpXG4gICAqIH07XG4gICAqXG4gICAqIC8vIE9yIGN1c3RvbWl6ZSB0aGUgZGVmYXVsdFxuICAgKiBjb25zdCBvcHRpb25zOiBMb2FkaW5nU2NlbmVPcHRpb25zID0ge1xuICAgKiAgIGFuaW1hdGlvbjogbmV3IEZhbGxpbmdTcXVhcmVzQW5pbWF0aW9uKHtcbiAgICogICAgIHNxdWFyZVNpemU6IDE2LFxuICAgKiAgICAgcGFsZXR0ZTogWzB4ZmYwMDAwLCAweDAwZmYwMF1cbiAgICogICB9KVxuICAgKiB9O1xuICAgKiBgYGBcbiAgICovXG4gIGFuaW1hdGlvbj86IExvYWRpbmdBbmltYXRpb247XG4gIC8qKiBPcHRpb25zIGZvciBkZWZhdWx0IEZhbGxpbmdTcXVhcmVzQW5pbWF0aW9uIChpZ25vcmVkIGlmIGN1c3RvbSBhbmltYXRpb24gcHJvdmlkZWQpICovXG4gIGZhbGxpbmdTcXVhcmVzT3B0aW9ucz86IEZhbGxpbmdTcXVhcmVzT3B0aW9ucztcbn1cblxuLyoqXG4gKiBMb2FkaW5nIHNjZW5lIGNvbXBvbmVudCBmb3IgTW94aS5cbiAqIFNob3dzIGFuIGFuaW1hdGVkIGxvYWRpbmcgc2NyZWVuIGR1cmluZyBhc3NldCBsb2FkaW5nLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogLy8gVmlhIHNldHVwTW94aSAocmVjb21tZW5kZWQpXG4gKiBjb25zdCB7IGxvYWRpbmdTY2VuZSB9ID0gYXdhaXQgc2V0dXBNb3hpKHtcbiAqICAgc2hvd0xvYWRpbmdTY2VuZTogdHJ1ZSxcbiAqICAgbG9hZGluZ1NjZW5lT3B0aW9uczoge1xuICogICAgIGJhY2tncm91bmRDb2xvcjogMHgyMjIyMjIsXG4gKiAgICAgdGV4dDogJ1BsZWFzZSB3YWl0Li4uJyxcbiAqICAgICBhbmltYXRpb246IG5ldyBGYWxsaW5nU3F1YXJlc0FuaW1hdGlvbih7IHNxdWFyZVNpemU6IDE2IH0pXG4gKiAgIH1cbiAqIH0pO1xuICpcbiAqIC8vIE1hbnVhbCBjb250cm9sXG4gKiBsb2FkaW5nU2NlbmUuc2hvdygpO1xuICogYXdhaXQgbG9hZEFzc2V0cyhbLi4uXSk7XG4gKiBsb2FkaW5nU2NlbmUuaGlkZSgpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBMb2FkaW5nU2NlbmUgZXh0ZW5kcyBDb250YWluZXIge1xuICBwcml2YXRlIHRleHQ6IFRleHQ7XG4gIHByaXZhdGUgYmFja2dyb3VuZDogR3JhcGhpY3M7XG4gIHByaXZhdGUgYW5pbWF0aW9uQ29udGFpbmVyOiBDb250YWluZXI7XG4gIHByaXZhdGUgYW5pbWF0aW9uOiBMb2FkaW5nQW5pbWF0aW9uO1xuICBwcml2YXRlIHRpY2tlcjogUElYSS5UaWNrZXI7XG4gIHByaXZhdGUgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSB0aW1lOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGJhY2tncm91bmRDb2xvcjogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IExvYWRpbmdTY2VuZU9wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG5cbiAgICBjb25zdCB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3IgPSAweDFhMWExYSxcbiAgICAgIHRleHQgPSAnTE9BRElORy4uLicsXG4gICAgICB0ZXh0U3R5bGUgPSB7fSxcbiAgICAgIGFuaW1hdGlvbixcbiAgICAgIGZhbGxpbmdTcXVhcmVzT3B0aW9uc1xuICAgIH0gPSBvcHRpb25zO1xuXG4gICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3I7XG5cbiAgICAvLyBVc2UgcHJvdmlkZWQgYW5pbWF0aW9uIG9yIGNyZWF0ZSBkZWZhdWx0XG4gICAgdGhpcy5hbmltYXRpb24gPSBhbmltYXRpb24gPz8gbmV3IEZhbGxpbmdTcXVhcmVzQW5pbWF0aW9uKGZhbGxpbmdTcXVhcmVzT3B0aW9ucyk7XG5cbiAgICAvLyBCYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IEdyYXBoaWNzKCk7XG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQpO1xuXG4gICAgLy8gQW5pbWF0aW9uIGNvbnRhaW5lciAoYmV0d2VlbiBiYWNrZ3JvdW5kIGFuZCB0ZXh0KVxuICAgIHRoaXMuYW5pbWF0aW9uQ29udGFpbmVyID0gbmV3IENvbnRhaW5lcigpO1xuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5hbmltYXRpb25Db250YWluZXIpO1xuXG4gICAgLy8gVGV4dFxuICAgIHRoaXMudGV4dCA9IG5ldyBUZXh0KHtcbiAgICAgIHRleHQsXG4gICAgICBzdHlsZToge1xuICAgICAgICBmb250RmFtaWx5OiAnQ291cmllciBOZXcsIG1vbm9zcGFjZScsXG4gICAgICAgIGZvbnRTaXplOiAxNixcbiAgICAgICAgZmlsbDogMHhmZmZmZmYsXG4gICAgICAgIGZvbnRXZWlnaHQ6ICdib2xkJyxcbiAgICAgICAgLi4udGV4dFN0eWxlXG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy50ZXh0LmFuY2hvci5zZXQoMC41KTtcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMudGV4dCk7XG5cbiAgICAvLyBJbml0aWFsaXplIGFuaW1hdGlvblxuICAgIHRoaXMuYW5pbWF0aW9uLmluaXQodGhpcy5hbmltYXRpb25Db250YWluZXIpO1xuXG4gICAgLy8gVGlja2VyXG4gICAgdGhpcy50aWNrZXIgPSBuZXcgUElYSS5UaWNrZXIoKTtcbiAgICB0aGlzLnRpY2tlci5hdXRvU3RhcnQgPSBmYWxzZTtcbiAgICB0aGlzLnRpY2tlci5hZGQoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMudmlzaWJsZSAmJiB0aGlzLnJlbmRlcmVyKSB7XG4gICAgICAgIGNvbnN0IGRlbHRhVGltZSA9IHRoaXMudGlja2VyLmRlbHRhVGltZSAvIDYwO1xuICAgICAgICB0aGlzLnRpbWUgKz0gZGVsdGFUaW1lO1xuICAgICAgICB0aGlzLnVwZGF0ZSh0aGlzLnJlbmRlcmVyLndpZHRoLCB0aGlzLnJlbmRlcmVyLmhlaWdodCwgZGVsdGFUaW1lKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW5kZXIodGhpcyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgZGVsdGFUaW1lOiBudW1iZXIpOiB2b2lkIHtcbiAgICAvLyBCYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kLmNsZWFyKCk7XG4gICAgdGhpcy5iYWNrZ3JvdW5kLnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgdGhpcy5iYWNrZ3JvdW5kLmZpbGwoeyBjb2xvcjogdGhpcy5iYWNrZ3JvdW5kQ29sb3IgfSk7XG5cbiAgICAvLyBUZXh0IHBvc2l0aW9uXG4gICAgdGhpcy50ZXh0LnggPSB3aWR0aCAvIDIgLSA0O1xuICAgIHRoaXMudGV4dC55ID0gaGVpZ2h0IC8gMiArIDYwO1xuXG4gICAgLy8gVXBkYXRlIGFuaW1hdGlvblxuICAgIHRoaXMuYW5pbWF0aW9uLnVwZGF0ZSh7XG4gICAgICB0aW1lOiB0aGlzLnRpbWUsXG4gICAgICBkZWx0YVRpbWUsXG4gICAgICB3aWR0aCxcbiAgICAgIGhlaWdodCxcbiAgICAgIHRleHRFbGVtZW50OiB0aGlzLnRleHRcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHdpdGggcmVuZGVyZXIgcmVmZXJlbmNlLlxuICAgKiBAcGFyYW0gcmVuZGVyZXIgLSBQSVhJIHJlbmRlcmVyXG4gICAqL1xuICBpbml0KHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyKTogdm9pZCB7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICB9XG5cbiAgLyoqXG4gICAqIFNob3cgdGhlIGxvYWRpbmcgc2NlbmUgYW5kIHN0YXJ0IGFuaW1hdGlvbi5cbiAgICovXG4gIHNob3coKTogdm9pZCB7XG4gICAgdGhpcy52aXNpYmxlID0gdHJ1ZTtcbiAgICB0aGlzLnRpbWUgPSAwO1xuICAgIHRoaXMuYW5pbWF0aW9uLnJlc2V0KCk7XG4gICAgaWYgKCF0aGlzLnRpY2tlci5zdGFydGVkKSB7XG4gICAgICB0aGlzLnRpY2tlci5zdGFydCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBIaWRlIHRoZSBsb2FkaW5nIHNjZW5lIGFuZCBzdG9wIGFuaW1hdGlvbi5cbiAgICovXG4gIGhpZGUoKTogdm9pZCB7XG4gICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XG4gICAgaWYgKHRoaXMudGlja2VyLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMudGlja2VyLnN0b3AoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW4gdXAgcmVzb3VyY2VzLlxuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aWNrZXIuc3RhcnRlZCkge1xuICAgICAgdGhpcy50aWNrZXIuc3RvcCgpO1xuICAgIH1cbiAgICB0aGlzLnRpY2tlci5kZXN0cm95KCk7XG4gICAgdGhpcy5hbmltYXRpb24uZGVzdHJveSgpO1xuICAgIHN1cGVyLmRlc3Ryb3koKTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IE1veGlFbnRpdHksIEFzRW50aXR5LCBhc0VudGl0eSB9IGZyb20gJy4uL2NvcmUvbW94aS1lbnRpdHknO1xuaW1wb3J0IHsgTG9naWMgfSBmcm9tICcuLi9jb3JlL2xvZ2ljJztcbmltcG9ydCB7IENhbWVyYSB9IGZyb20gJy4uL2NvcmUvY2FtZXJhJztcbmltcG9ydCB7IFBhcmFsbGF4TGF5ZXIgfSBmcm9tICcuL3BhcmFsbGF4LWxheWVyJztcblxuZXhwb3J0IGludGVyZmFjZSBQYXJhbGxheEJhY2tncm91bmRPcHRpb25zIHtcbiAgY2FtZXJhPzogQ2FtZXJhOyAgICAgICAgICAgICAgICAgICAgLy8gUmVmZXJlbmNlIHRvIGNhbWVyYSAoYXV0by1kZXRlY3RlZCBpZiBub3QgcHJvdmlkZWQpXG4gIHNjcm9sbE9mZnNldD86IFBJWEkuUG9pbnQ7ICAgICAgICAgIC8vIEJhc2Ugc2Nyb2xsIG9mZnNldFxuICBzY3JvbGxCYXNlU2NhbGU/OiBQSVhJLlBvaW50OyAgICAgICAvLyBCYXNlIHNjYWxlIG11bHRpcGxpZXJcbiAgc2Nyb2xsSWdub3JlQ2FtZXJhWm9vbT86IGJvb2xlYW47ICAgLy8gRGlzYWJsZSB6b29tIGFmZmVjdGluZyBwYXJhbGxheFxuICBhdXRvc2Nyb2xsPzogUElYSS5Qb2ludDsgICAgICAgICAgICAvLyBBdXRvbWF0aWMgc2Nyb2xsaW5nIGluZGVwZW5kZW50IG9mIGNhbWVyYVxufVxuXG4vKipcbiAqIENvbnRhaW5lciBmb3IgYWxsIHBhcmFsbGF4IGxheWVycyB0aGF0IG1hbmFnZXMgZ2xvYmFsIHBhcmFsbGF4IGJlaGF2aW9yXG4gKiBhbmQgY29vcmRpbmF0ZXMgd2l0aCB0aGUgQ2FtZXJhIHN5c3RlbS5cbiAqXG4gKiBJbnNwaXJlZCBieSBHb2RvdCdzIFBhcmFsbGF4QmFja2dyb3VuZCBub2RlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBwYXJhbGxheCA9IG5ldyBQYXJhbGxheEJhY2tncm91bmQoKTtcbiAqIGNvbnN0IHNreUxheWVyID0gbmV3IFRpbGluZ1BhcmFsbGF4TGF5ZXIoe1xuICogICB0ZXh0dXJlOiBza3lUZXh0dXJlLFxuICogICBzY3JvbGxTY2FsZTogbmV3IFBJWEkuUG9pbnQoMC4yLCAwLjIpXG4gKiB9KTtcbiAqIHBhcmFsbGF4LmFkZExheWVyKHNreUxheWVyKTtcbiAqIHNjZW5lLmFkZENoaWxkKHBhcmFsbGF4KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgUGFyYWxsYXhCYWNrZ3JvdW5kIGV4dGVuZHMgUElYSS5Db250YWluZXIgaW1wbGVtZW50cyBBc0VudGl0eTxQSVhJLkNvbnRhaW5lcj4ge1xuICBwdWJsaWMgbW94aUVudGl0eTogTW94aUVudGl0eTxQSVhJLkNvbnRhaW5lcj47XG4gIHB1YmxpYyBjYW1lcmE6IENhbWVyYSB8IG51bGwgPSBudWxsO1xuICBwdWJsaWMgc2Nyb2xsT2Zmc2V0OiBQSVhJLlBvaW50ID0gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG4gIHB1YmxpYyBzY3JvbGxCYXNlU2NhbGU6IFBJWEkuUG9pbnQgPSBuZXcgUElYSS5Qb2ludCgxLCAxKTtcbiAgcHVibGljIHNjcm9sbElnbm9yZUNhbWVyYVpvb206IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHVibGljIGF1dG9zY3JvbGw6IFBJWEkuUG9pbnQgPSBuZXcgUElYSS5Qb2ludCgwLCAwKTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBQYXJhbGxheEJhY2tncm91bmRPcHRpb25zID0ge30pIHtcbiAgICBzdXBlcigpO1xuXG4gICAgLy8gQXBwbHkgb3B0aW9uc1xuICAgIHRoaXMuY2FtZXJhID0gb3B0aW9ucy5jYW1lcmEgPz8gbnVsbDtcbiAgICB0aGlzLnNjcm9sbE9mZnNldCA9IG9wdGlvbnMuc2Nyb2xsT2Zmc2V0ID8/IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICAgIHRoaXMuc2Nyb2xsQmFzZVNjYWxlID0gb3B0aW9ucy5zY3JvbGxCYXNlU2NhbGUgPz8gbmV3IFBJWEkuUG9pbnQoMSwgMSk7XG4gICAgdGhpcy5zY3JvbGxJZ25vcmVDYW1lcmFab29tID0gb3B0aW9ucy5zY3JvbGxJZ25vcmVDYW1lcmFab29tID8/IGZhbHNlO1xuICAgIHRoaXMuYXV0b3Njcm9sbCA9IG9wdGlvbnMuYXV0b3Njcm9sbCA/PyBuZXcgUElYSS5Qb2ludCgwLCAwKTtcblxuICAgIC8vIENvbnZlcnQgdG8gTW94aSBlbnRpdHkgd2l0aCBQYXJhbGxheEJhY2tncm91bmRMb2dpY1xuICAgIGNvbnN0IGVudGl0eSA9IGFzRW50aXR5KHRoaXMpO1xuICAgIGVudGl0eS5tb3hpRW50aXR5LmFkZExvZ2ljKG5ldyBQYXJhbGxheEJhY2tncm91bmRMb2dpYygpKTtcbiAgICB0aGlzLm1veGlFbnRpdHkgPSBlbnRpdHkubW94aUVudGl0eTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgUGFyYWxsYXhMYXllciB0byB0aGUgYmFja2dyb3VuZFxuICAgKi9cbiAgYWRkTGF5ZXIobGF5ZXI6IFBhcmFsbGF4TGF5ZXIpOiB2b2lkIHtcbiAgICB0aGlzLmFkZENoaWxkKGxheWVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdXRvLWRldGVjdCBjYW1lcmEgZnJvbSBzY2VuZSBoaWVyYXJjaHlcbiAgICovXG4gIHByaXZhdGUgZGV0ZWN0Q2FtZXJhKCk6IENhbWVyYSB8IG51bGwge1xuICAgIGxldCBjdXJyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgd2hpbGUgKGN1cnJlbnQpIHtcbiAgICAgIGlmIChjdXJyZW50IGluc3RhbmNlb2YgQ2FtZXJhKSB7XG4gICAgICAgIHJldHVybiBjdXJyZW50O1xuICAgICAgfVxuICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50O1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGVmZmVjdGl2ZSBjYW1lcmEgcG9zaXRpb24gZm9yIHBhcmFsbGF4IGNhbGN1bGF0aW9uXG4gICAqL1xuICBnZXRDYW1lcmFQb3NpdGlvbigpOiBQSVhJLlBvaW50IHtcbiAgICBjb25zdCBjYW1lcmEgPSB0aGlzLmNhbWVyYSA/PyB0aGlzLmRldGVjdENhbWVyYSgpO1xuICAgIGlmICghY2FtZXJhKSB7XG4gICAgICByZXR1cm4gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG4gICAgfVxuXG4gICAgLy8gSW4gTU9YSSdzIGNhbWVyYSBzeXN0ZW0sIGNhbWVyYS5wb3NpdGlvbiByZXByZXNlbnRzIHdoZXJlIHRoZSBjYW1lcmEgaXMgbG9va2luZ1xuICAgIC8vIFRoZSBzY2VuZSBpcyBwb3NpdGlvbmVkIGF0IC1jYW1lcmEucG9zaXRpb24gdG8gY3JlYXRlIHRoZSBjYW1lcmEgZWZmZWN0XG4gICAgcmV0dXJuIG5ldyBQSVhJLlBvaW50KFxuICAgICAgY2FtZXJhLnBvc2l0aW9uLngsXG4gICAgICBjYW1lcmEucG9zaXRpb24ueVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBlZmZlY3RpdmUgY2FtZXJhIHNjYWxlL3pvb20gZm9yIHBhcmFsbGF4IGNhbGN1bGF0aW9uXG4gICAqL1xuICBnZXRDYW1lcmFTY2FsZSgpOiBQSVhJLlBvaW50IHtcbiAgICBpZiAodGhpcy5zY3JvbGxJZ25vcmVDYW1lcmFab29tKSB7XG4gICAgICByZXR1cm4gbmV3IFBJWEkuUG9pbnQoMSwgMSk7XG4gICAgfVxuXG4gICAgY29uc3QgY2FtZXJhID0gdGhpcy5jYW1lcmEgPz8gdGhpcy5kZXRlY3RDYW1lcmEoKTtcbiAgICBpZiAoIWNhbWVyYSkge1xuICAgICAgcmV0dXJuIG5ldyBQSVhJLlBvaW50KDEsIDEpO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgUElYSS5Qb2ludChjYW1lcmEuc2NhbGUueCwgY2FtZXJhLnNjYWxlLnkpO1xuICB9XG59XG5cbi8qKlxuICogTG9naWMgY29tcG9uZW50IHRoYXQgdXBkYXRlcyB0aGUgcGFyYWxsYXggYmFja2dyb3VuZCBiYXNlZCBvbiBjYW1lcmEgbW92ZW1lbnQgYW5kIGF1dG9zY3JvbGwuXG4gKi9cbmV4cG9ydCBjbGFzcyBQYXJhbGxheEJhY2tncm91bmRMb2dpYyBleHRlbmRzIExvZ2ljPFBhcmFsbGF4QmFja2dyb3VuZD4ge1xuICBuYW1lID0gJ1BhcmFsbGF4QmFja2dyb3VuZExvZ2ljJztcblxuICB1cGRhdGUoZW50aXR5OiBQYXJhbGxheEJhY2tncm91bmQsIGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgLy8gQXBwbHkgYXV0b3Njcm9sbFxuICAgIGlmIChlbnRpdHkuYXV0b3Njcm9sbC54ICE9PSAwIHx8IGVudGl0eS5hdXRvc2Nyb2xsLnkgIT09IDApIHtcbiAgICAgIGVudGl0eS5zY3JvbGxPZmZzZXQueCArPSBlbnRpdHkuYXV0b3Njcm9sbC54ICogZGVsdGFUaW1lO1xuICAgICAgZW50aXR5LnNjcm9sbE9mZnNldC55ICs9IGVudGl0eS5hdXRvc2Nyb2xsLnkgKiBkZWx0YVRpbWU7XG4gICAgfVxuXG4gICAgLy8gR2V0IGNhbWVyYSBwb3NpdGlvbiBmb3IgY2hpbGQgbGF5ZXJzIHRvIHJlZmVyZW5jZVxuICAgIGNvbnN0IGNhbWVyYVBvcyA9IGVudGl0eS5nZXRDYW1lcmFQb3NpdGlvbigpO1xuICAgIGNvbnN0IGNhbWVyYVNjYWxlID0gZW50aXR5LmdldENhbWVyYVNjYWxlKCk7XG5cbiAgICAvLyBQb3NpdGlvbiB0aGUgUGFyYWxsYXhCYWNrZ3JvdW5kIHRvIHN0YXkgc2NyZWVuLWFsaWduZWRcbiAgICAvLyBTaW5jZSBQYXJhbGxheEJhY2tncm91bmQgaXMgYSBjaGlsZCBvZiBzY2VuZSB3aXRoIHBpdm90IGF0IHZpZXdwb3J0IGNlbnRlcixcbiAgICAvLyB3ZSBuZWVkIHRvIGNvdW50ZXItc2NhbGUgdG8ga2VlcCBsYXllcnMgYXQgMToxIHNjcmVlbiBzY2FsZVxuICAgIGNvbnN0IHNjZW5lID0gZW50aXR5LnBhcmVudDtcbiAgICBpZiAoc2NlbmUpIHtcbiAgICAgIC8vIFBvc2l0aW9uIHRvIHN0YXkgY2VudGVyZWQgb24gdmlld3BvcnQgZGVzcGl0ZSBjYW1lcmEgbW92ZW1lbnRcbiAgICAgIC8vIEFjY291bnQgZm9yIHNjZW5lIHNjYWxlIHNpbmNlIHNjZW5lLnBvc2l0aW9uIGlzIHNjYWxlZFxuICAgICAgZW50aXR5LnBvc2l0aW9uLnggPSBjYW1lcmFQb3MueCAvIHNjZW5lLnNjYWxlLng7XG4gICAgICBlbnRpdHkucG9zaXRpb24ueSA9IGNhbWVyYVBvcy55IC8gc2NlbmUuc2NhbGUueTtcblxuICAgICAgLy8gQ291bnRlci1zY2FsZSB0byBjYW5jZWwgaW5oZXJpdGVkIHNjZW5lIHNjYWxlXG4gICAgICAvLyBUaGlzIGtlZXBzIFRpbGluZ1Nwcml0ZSBzaXppbmcgaW4gc2NyZWVuLXNwYWNlIGNvb3JkaW5hdGVzXG4gICAgICBlbnRpdHkuc2NhbGUueCA9IDEgLyBzY2VuZS5zY2FsZS54O1xuICAgICAgZW50aXR5LnNjYWxlLnkgPSAxIC8gc2NlbmUuc2NhbGUueTtcbiAgICB9IGVsc2Uge1xuICAgICAgZW50aXR5LnBvc2l0aW9uLnggPSBjYW1lcmFQb3MueDtcbiAgICAgIGVudGl0eS5wb3NpdGlvbi55ID0gY2FtZXJhUG9zLnk7XG4gICAgICBlbnRpdHkuc2NhbGUuc2V0KDEsIDEpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBhbGwgY2hpbGQgUGFyYWxsYXhMYXllcnNcbiAgICBlbnRpdHkuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQ6IGFueSkgPT4ge1xuICAgICAgaWYgKGNoaWxkIGluc3RhbmNlb2YgUGFyYWxsYXhMYXllcikge1xuICAgICAgICBjaGlsZC51cGRhdGVQYXJhbGxheChjYW1lcmFQb3MsIGNhbWVyYVNjYWxlLCBlbnRpdHkuc2Nyb2xsT2Zmc2V0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IE1veGlFbnRpdHksIEFzRW50aXR5LCBhc0VudGl0eSB9IGZyb20gJy4uL2NvcmUvbW94aS1lbnRpdHknO1xuXG5leHBvcnQgaW50ZXJmYWNlIFBhcmFsbGF4TGF5ZXJPcHRpb25zIHtcbiAgc2Nyb2xsU2NhbGU/OiBQSVhJLlBvaW50OyAgICAgIC8vIE1vdGlvbiBtdWx0aXBsaWVyICgwLjUgPSBoYWxmIHNwZWVkLCBsaWtlIEdvZG90J3MgbW90aW9uX3NjYWxlKVxuICBzY3JvbGxPZmZzZXQ/OiBQSVhJLlBvaW50OyAgICAgLy8gTGF5ZXIgb2Zmc2V0IGZvciBwb3NpdGlvbmluZyAobGlrZSBHb2RvdCdzIG1vdGlvbl9vZmZzZXQpXG4gIHJlcGVhdFNpemU/OiBQSVhJLlBvaW50OyAgICAgICAvLyBNaXJyb3JpbmcvcmVwZWF0IGludGVydmFsICgwID0gbm8gcmVwZWF0LCBsaWtlIEdvZG90J3MgbW90aW9uX21pcnJvcmluZylcbiAgbWlycm9yaW5nPzogYm9vbGVhbjsgICAgICAgICAgIC8vIEVuYWJsZSBhdXRvbWF0aWMgbWlycm9yaW5nIChyZXF1aXJlcyByZXBlYXRTaXplKVxufVxuXG4vKipcbiAqIEluZGl2aWR1YWwgcGFyYWxsYXggbGF5ZXIgdGhhdCBzY3JvbGxzIGF0IGEgZGlmZmVyZW50IHNwZWVkIGJhc2VkIG9uIHNjcm9sbFNjYWxlLlxuICpcbiAqIEluc3BpcmVkIGJ5IEdvZG90J3MgUGFyYWxsYXhMYXllciBub2RlLlxuICpcbiAqIFRoZSBzY3JvbGxTY2FsZSBwcm9wZXJ0eSBjb250cm9scyBob3cgZmFzdCB0aGUgbGF5ZXIgbW92ZXMgcmVsYXRpdmUgdG8gdGhlIGNhbWVyYTpcbiAqIC0gMC4wID0gU3RhdGljIChkb2Vzbid0IG1vdmUgd2l0aCBjYW1lcmEsIGdvb2QgZm9yIFVJL0hVRClcbiAqIC0gMC4yID0gU2xvdyAoYXBwZWFycyBmYXIgYXdheSwgbGlrZSBza3kpXG4gKiAtIDAuNSA9IE1lZGl1bSAobWlkLWdyb3VuZCBlbGVtZW50cylcbiAqIC0gMC45ID0gRmFzdCAoZm9yZWdyb3VuZCBlbGVtZW50cylcbiAqIC0gMS4wID0gTW92ZXMgd2l0aCBjYW1lcmEgKGdhbWUgZW50aXRpZXMpXG4gKiAtID4xLjAgPSBGYXN0ZXIgdGhhbiBjYW1lcmEgKHJldmVyc2UgcGFyYWxsYXggZWZmZWN0KVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBsYXllciA9IG5ldyBQYXJhbGxheExheWVyKHtcbiAqICAgc2Nyb2xsU2NhbGU6IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KSwgLy8gSGFsZiBjYW1lcmEgc3BlZWRcbiAqICAgc2Nyb2xsT2Zmc2V0OiBuZXcgUElYSS5Qb2ludCgwLCAwKVxuICogfSk7XG4gKlxuICogLy8gQWRkIHNwcml0ZXMgdG8gdGhlIGxheWVyXG4gKiBjb25zdCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gKiBsYXllci5hZGRDaGlsZChzcHJpdGUpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBQYXJhbGxheExheWVyIGV4dGVuZHMgUElYSS5Db250YWluZXIgaW1wbGVtZW50cyBBc0VudGl0eTxQSVhJLkNvbnRhaW5lcj4ge1xuICBwdWJsaWMgbW94aUVudGl0eTogTW94aUVudGl0eTxQSVhJLkNvbnRhaW5lcj47XG4gIHB1YmxpYyBzY3JvbGxTY2FsZTogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDEsIDEpO1xuICBwdWJsaWMgc2Nyb2xsT2Zmc2V0OiBQSVhJLlBvaW50ID0gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG4gIHB1YmxpYyByZXBlYXRTaXplOiBQSVhJLlBvaW50ID0gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG4gIHB1YmxpYyBtaXJyb3Jpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvLyBJbnRlcm5hbCBzdGF0ZVxuICBwcml2YXRlIF9sYXN0Q2FtZXJhUG9zOiBQSVhJLlBvaW50ID0gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogUGFyYWxsYXhMYXllck9wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLnNjcm9sbFNjYWxlID0gb3B0aW9ucy5zY3JvbGxTY2FsZSA/PyBuZXcgUElYSS5Qb2ludCgxLCAxKTtcbiAgICB0aGlzLnNjcm9sbE9mZnNldCA9IG9wdGlvbnMuc2Nyb2xsT2Zmc2V0ID8/IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICAgIHRoaXMucmVwZWF0U2l6ZSA9IG9wdGlvbnMucmVwZWF0U2l6ZSA/PyBuZXcgUElYSS5Qb2ludCgwLCAwKTtcbiAgICB0aGlzLm1pcnJvcmluZyA9IG9wdGlvbnMubWlycm9yaW5nID8/IGZhbHNlO1xuXG4gICAgLy8gQ29udmVydCB0byBNb3hpIGVudGl0eVxuICAgIGNvbnN0IGVudGl0eSA9IGFzRW50aXR5KHRoaXMpO1xuICAgIHRoaXMubW94aUVudGl0eSA9IGVudGl0eS5tb3hpRW50aXR5O1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBsYXllciBwb3NpdGlvbiBiYXNlZCBvbiBjYW1lcmEgbW92ZW1lbnQuXG4gICAqIENhbGxlZCBieSBQYXJhbGxheEJhY2tncm91bmRMb2dpYyBlYWNoIGZyYW1lLlxuICAgKlxuICAgKiBAcGFyYW0gY2FtZXJhUG9zIC0gQ3VycmVudCBjYW1lcmEgcG9zaXRpb24gaW4gd29ybGQgc3BhY2VcbiAgICogQHBhcmFtIGNhbWVyYVNjYWxlIC0gQ3VycmVudCBjYW1lcmEgc2NhbGUvem9vbVxuICAgKiBAcGFyYW0gYmFja2dyb3VuZE9mZnNldCAtIEdsb2JhbCBiYWNrZ3JvdW5kIHNjcm9sbCBvZmZzZXRcbiAgICovXG4gIHVwZGF0ZVBhcmFsbGF4KFxuICAgIGNhbWVyYVBvczogUElYSS5Qb2ludCxcbiAgICBjYW1lcmFTY2FsZTogUElYSS5Qb2ludCxcbiAgICBiYWNrZ3JvdW5kT2Zmc2V0OiBQSVhJLlBvaW50XG4gICk6IHZvaWQge1xuICAgIC8vIENhbGN1bGF0ZSBlZmZlY3RpdmUgc2Nyb2xsIG9mZnNldFxuICAgIGNvbnN0IHNjcm9sbFggPSAoY2FtZXJhUG9zLnggKyBiYWNrZ3JvdW5kT2Zmc2V0LngpICogdGhpcy5zY3JvbGxTY2FsZS54O1xuICAgIGNvbnN0IHNjcm9sbFkgPSAoY2FtZXJhUG9zLnkgKyBiYWNrZ3JvdW5kT2Zmc2V0LnkpICogdGhpcy5zY3JvbGxTY2FsZS55O1xuXG4gICAgLy8gQXBwbHkgdG8gbGF5ZXIgcG9zaXRpb25cbiAgICB0aGlzLnBvc2l0aW9uLnggPSAtc2Nyb2xsWCArIHRoaXMuc2Nyb2xsT2Zmc2V0Lng7XG4gICAgdGhpcy5wb3NpdGlvbi55ID0gLXNjcm9sbFkgKyB0aGlzLnNjcm9sbE9mZnNldC55O1xuXG4gICAgLy8gSGFuZGxlIG1pcnJvcmluZy93cmFwcGluZyBpZiBlbmFibGVkXG4gICAgaWYgKHRoaXMubWlycm9yaW5nKSB7XG4gICAgICBpZiAodGhpcy5yZXBlYXRTaXplLnggPiAwKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb24ueCA9IHRoaXMucG9zaXRpb24ueCAlIHRoaXMucmVwZWF0U2l6ZS54O1xuICAgICAgICBpZiAodGhpcy5wb3NpdGlvbi54ID4gMCkgdGhpcy5wb3NpdGlvbi54IC09IHRoaXMucmVwZWF0U2l6ZS54O1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMucmVwZWF0U2l6ZS55ID4gMCkge1xuICAgICAgICB0aGlzLnBvc2l0aW9uLnkgPSB0aGlzLnBvc2l0aW9uLnkgJSB0aGlzLnJlcGVhdFNpemUueTtcbiAgICAgICAgaWYgKHRoaXMucG9zaXRpb24ueSA+IDApIHRoaXMucG9zaXRpb24ueSAtPSB0aGlzLnJlcGVhdFNpemUueTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLl9sYXN0Q2FtZXJhUG9zLmNvcHlGcm9tKGNhbWVyYVBvcyk7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBUaWxpbmdQYXJhbGxheExheWVyT3B0aW9ucyBleHRlbmRzIFBhcmFsbGF4TGF5ZXJPcHRpb25zIHtcbiAgdGV4dHVyZTogUElYSS5UZXh0dXJlO1xuICB3aWR0aD86IG51bWJlcjtcbiAgaGVpZ2h0PzogbnVtYmVyO1xufVxuXG4vKipcbiAqIFNwZWNpYWxpemVkIHBhcmFsbGF4IGxheWVyIHVzaW5nIFBJWEkuVGlsaW5nU3ByaXRlIGZvciBlZmZpY2llbnQgaW5maW5pdGUgc2Nyb2xsaW5nLlxuICpcbiAqIFRoaXMgaXMgdGhlIHJlY29tbWVuZGVkIGFwcHJvYWNoIGZvciBsYXJnZSwgcmVwZWF0aW5nIGJhY2tncm91bmRzIGxpa2Ugc2t5LCBjbG91ZHMsXG4gKiBvciBncm91bmQgdGV4dHVyZXMuIFRpbGluZ1Nwcml0ZSBpcyBvcHRpbWl6ZWQgZm9yIHJlcGVhdGluZyBwYXR0ZXJucyBhbmQgdXNlc1xuICogdGlsZVBvc2l0aW9uIGZvciBzZWFtbGVzcyBzY3JvbGxpbmcgd2l0aG91dCByZXBvc2l0aW9uaW5nIHRoZSBjb250YWluZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHNreUxheWVyID0gbmV3IFRpbGluZ1BhcmFsbGF4TGF5ZXIoe1xuICogICB0ZXh0dXJlOiBza3lUZXh0dXJlLFxuICogICBzY3JvbGxTY2FsZTogbmV3IFBJWEkuUG9pbnQoMC4yLCAwLjIpXG4gKiAgIC8vIHdpZHRoL2hlaWdodCBhdXRvLWRldGVjdGVkIGZyb20gcmVuZGVyZXJcbiAqIH0pO1xuICogcGFyYWxsYXhCYWNrZ3JvdW5kLmFkZExheWVyKHNreUxheWVyKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVGlsaW5nUGFyYWxsYXhMYXllciBleHRlbmRzIFBhcmFsbGF4TGF5ZXIge1xuICBwdWJsaWMgdGlsaW5nU3ByaXRlOiBQSVhJLlRpbGluZ1Nwcml0ZTtcbiAgcHJpdmF0ZSBfYXV0b1NpemVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogVGlsaW5nUGFyYWxsYXhMYXllck9wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKTtcblxuICAgIC8vIEVuc3VyZSB0ZXh0dXJlIHdyYXBzIGZvciBzZWFtbGVzcyB0aWxpbmdcbiAgICBvcHRpb25zLnRleHR1cmUuc291cmNlLnN0eWxlLmFkZHJlc3NNb2RlID0gJ3JlcGVhdCc7XG5cbiAgICAvLyBJZiBkaW1lbnNpb25zIG5vdCBwcm92aWRlZCwgdXNlIHRlbXBvcmFyeSB2YWx1ZXMgYW5kIGF1dG8tZGV0ZWN0IG9uIGZpcnN0IHVwZGF0ZVxuICAgIGNvbnN0IHdpZHRoID0gb3B0aW9ucy53aWR0aCA/PyAxO1xuICAgIGNvbnN0IGhlaWdodCA9IG9wdGlvbnMuaGVpZ2h0ID8/IDE7XG5cbiAgICAvLyBDcmVhdGUgVGlsaW5nU3ByaXRlIGFzIGNoaWxkXG4gICAgdGhpcy50aWxpbmdTcHJpdGUgPSBuZXcgUElYSS5UaWxpbmdTcHJpdGUoe1xuICAgICAgdGV4dHVyZTogb3B0aW9ucy50ZXh0dXJlLFxuICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgfSk7XG5cbiAgICAvLyBQb3NpdGlvbiBUaWxpbmdTcHJpdGUgdG8gc3RhcnQgZnJvbSBvcmlnaW4gKDAsIDApIHRvIGNvdmVyIHRoZSB2aWV3cG9ydFxuICAgIHRoaXMudGlsaW5nU3ByaXRlLnBvc2l0aW9uLnNldCgwLCAwKTtcblxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy50aWxpbmdTcHJpdGUpO1xuXG4gICAgLy8gTWFyayBpZiB3ZSBuZWVkIHRvIGF1dG8tZGV0ZWN0IGRpbWVuc2lvbnNcbiAgICB0aGlzLl9hdXRvU2l6ZWQgPSAhb3B0aW9ucy53aWR0aCAmJiAhb3B0aW9ucy5oZWlnaHQ7XG4gIH1cblxuICAvKipcbiAgICogQXV0by1kZXRlY3QgcmVuZGVyZXIgZGltZW5zaW9ucyBmcm9tIHRoZSBzY2VuZSBoaWVyYXJjaHlcbiAgICovXG4gIHByaXZhdGUgYXV0b0RldGVjdERpbWVuc2lvbnMoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLl9hdXRvU2l6ZWQpIHJldHVybjtcblxuICAgIC8vIFdhbGsgdXAgcGFyZW50IGNoYWluIHRvIGZpbmQgYSBub2RlIHdpdGggYSByZW5kZXJlclxuICAgIGxldCBjdXJyZW50OiBhbnkgPSB0aGlzLnBhcmVudDtcbiAgICB3aGlsZSAoY3VycmVudCkge1xuICAgICAgaWYgKGN1cnJlbnQucmVuZGVyZXIpIHtcbiAgICAgICAgLy8gRm91bmQgYSByZW5kZXJlciAodXN1YWxseSBvbiBTY2VuZSlcbiAgICAgICAgdGhpcy5yZXNpemUoY3VycmVudC5yZW5kZXJlci53aWR0aCwgY3VycmVudC5yZW5kZXJlci5oZWlnaHQpO1xuICAgICAgICB0aGlzLl9hdXRvU2l6ZWQgPSBmYWxzZTsgLy8gT25seSBuZWVkIHRvIGRvIHRoaXMgb25jZVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE92ZXJyaWRlIHVwZGF0ZVBhcmFsbGF4IHRvIHVzZSB0aWxlUG9zaXRpb24gaW5zdGVhZCBvZiBjb250YWluZXIgcG9zaXRpb24uXG4gICAqIFRoaXMgcHJvdmlkZXMgc2VhbWxlc3MgaW5maW5pdGUgc2Nyb2xsaW5nIHdpdGhvdXQgdmlzaWJsZSBzZWFtcy5cbiAgICpcbiAgICogU2luY2UgdGhlIFBhcmFsbGF4QmFja2dyb3VuZCBjb250YWluZXIgbm93IGZvbGxvd3MgdGhlIGNhbWVyYSwgbGF5ZXJzIGluc2lkZVxuICAgKiBzdGF5IGF0ICgwLDApIGFuZCBvbmx5IHVzZSB0aWxlUG9zaXRpb24gZm9yIHRoZSBwYXJhbGxheCBzY3JvbGxpbmcgZWZmZWN0LlxuICAgKlxuICAgKiBDYW1lcmEgc2NhbGUgaXMgdXNlZCB0byByZXNpemUgdGhlIFRpbGluZ1Nwcml0ZSB0byBjb3ZlciB0aGUgdmlld3BvcnQgYXQgZGlmZmVyZW50IHpvb20gbGV2ZWxzLlxuICAgKi9cbiAgdXBkYXRlUGFyYWxsYXgoXG4gICAgY2FtZXJhUG9zOiBQSVhJLlBvaW50LFxuICAgIGNhbWVyYVNjYWxlOiBQSVhJLlBvaW50LFxuICAgIGJhY2tncm91bmRPZmZzZXQ6IFBJWEkuUG9pbnRcbiAgKTogdm9pZCB7XG4gICAgLy8gQXV0by1kZXRlY3QgZGltZW5zaW9ucyBvbiBmaXJzdCB1cGRhdGUgaWYgbm90IG1hbnVhbGx5IHNwZWNpZmllZFxuICAgIHRoaXMuYXV0b0RldGVjdERpbWVuc2lvbnMoKTtcbiAgICAvLyBjb25zb2xlLmxvZygndXBkYXRlUGFyYWxsYXgnLCBjYW1lcmFTY2FsZSk7XG5cbiAgICAvLyBHZXQgcmVuZGVyZXIgZGltZW5zaW9ucyB0byB1c2UgYXMgYmFzZSBzaXplXG4gICAgY29uc3QgcmVuZGVyZXIgPSB0aGlzLnBhcmVudD8ucGFyZW50IGFzIGFueTsgLy8gR2V0IHJlbmRlcmVyIGZyb20gc2NlbmVcbiAgICBpZiAocmVuZGVyZXI/LnJlbmRlcmVyKSB7XG4gICAgICBjb25zdCBiYXNlV2lkdGggPSByZW5kZXJlci5yZW5kZXJlci53aWR0aDtcbiAgICAgIGNvbnN0IGJhc2VIZWlnaHQgPSByZW5kZXJlci5yZW5kZXJlci5oZWlnaHQ7XG5cbiAgICAgIC8vIFBhcmFsbGF4QmFja2dyb3VuZCBjb3VudGVyLXNjYWxlcywgc28gd2UncmUgaW4gc2NyZWVuLXNwYWNlXG4gICAgICAvLyBKdXN0IHNldCB0byByZW5kZXJlciBzaXplIC0gbm8gem9vbSBhZGp1c3RtZW50IG5lZWRlZFxuICAgICAgdGhpcy50aWxpbmdTcHJpdGUud2lkdGggPSBiYXNlV2lkdGg7XG4gICAgICB0aGlzLnRpbGluZ1Nwcml0ZS5oZWlnaHQgPSBiYXNlSGVpZ2h0O1xuXG4gICAgICAvLyBLZWVwIHNwcml0ZSBhdCBvcmlnaW5cbiAgICAgIHRoaXMudGlsaW5nU3ByaXRlLnBpdm90LnNldCgwLCAwKTtcbiAgICAgIHRoaXMudGlsaW5nU3ByaXRlLnBvc2l0aW9uLnNldCgwLCAwKTtcbiAgICB9XG5cbiAgICAvLyBDYWxjdWxhdGUgZWZmZWN0aXZlIHNjcm9sbCBvZmZzZXQgZm9yIHRpbGVQb3NpdGlvblxuICAgIGNvbnN0IHNjcm9sbFggPSAoY2FtZXJhUG9zLnggKyBiYWNrZ3JvdW5kT2Zmc2V0LngpICogdGhpcy5zY3JvbGxTY2FsZS54O1xuICAgIGNvbnN0IHNjcm9sbFkgPSAoY2FtZXJhUG9zLnkgKyBiYWNrZ3JvdW5kT2Zmc2V0LnkpICogdGhpcy5zY3JvbGxTY2FsZS55O1xuXG4gICAgLy8gQXBwbHkgdG8gdGlsZVBvc2l0aW9uICh3aXRoIGxheWVyJ3Mgb3duIHNjcm9sbE9mZnNldCBmb3IgcG9zaXRpb25pbmcpXG4gICAgdGhpcy50aWxpbmdTcHJpdGUudGlsZVBvc2l0aW9uLnggPSAtc2Nyb2xsWCArIHRoaXMuc2Nyb2xsT2Zmc2V0Lng7XG4gICAgdGhpcy50aWxpbmdTcHJpdGUudGlsZVBvc2l0aW9uLnkgPSAtc2Nyb2xsWSArIHRoaXMuc2Nyb2xsT2Zmc2V0Lnk7XG5cbiAgICAvLyBMYXllciBjb250YWluZXIgc3RheXMgYXQgb3JpZ2luIC0gc2NlbmUgcGl2b3QgaGFuZGxlcyB6b29tIGFuY2hvcmluZ1xuICAgIHRoaXMucG9zaXRpb24uc2V0KDAsIDApO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBUaWxpbmdTcHJpdGUgZGltZW5zaW9ucyAoZS5nLiwgb24gd2luZG93IHJlc2l6ZSlcbiAgICovXG4gIHJlc2l6ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMudGlsaW5nU3ByaXRlLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy50aWxpbmdTcHJpdGUuaGVpZ2h0ID0gaGVpZ2h0O1xuICB9XG59XG4iLCIvKipcbiAqIFBoeXNpY3MgbW9kdWxlIC0gUGxhbmNrLmpzIGludGVncmF0aW9uIGZvciBNT1hJXG4gKlxuICogQHBhY2thZ2VEb2N1bWVudGF0aW9uXG4gKi9cblxuLy8gQ29yZSBjbGFzc2VzXG5leHBvcnQgeyBQaHlzaWNzV29ybGQgfSBmcm9tICcuL3BoeXNpY3Mtd29ybGQnO1xuZXhwb3J0IHsgUGh5c2ljc0JvZHlMb2dpYyB9IGZyb20gJy4vcGh5c2ljcy1ib2R5LWxvZ2ljJztcbmV4cG9ydCB7IENvbGxpc2lvblJlZ2lzdHJ5LCBDb2xsaXNpb25NYW5hZ2VyIH0gZnJvbSAnLi9waHlzaWNzLWNvbGxpc2lvbic7XG5leHBvcnQgeyBQaHlzaWNzRGVidWdSZW5kZXJlciB9IGZyb20gJy4vcGh5c2ljcy1kZWJ1Zy1yZW5kZXJlcic7XG5cbi8vIFV0aWxpdGllc1xuZXhwb3J0IHtcbiAgYXNQaHlzaWNzRW50aXR5LFxuICBoYXNQaHlzaWNzLFxuICBnZXRQaHlzaWNzQm9keSxcbiAgY3JlYXRlU2hhcGVGcm9tU3ByaXRlXG59IGZyb20gJy4vcGh5c2ljcy11dGlscyc7XG5cbi8vIE1hdGVyaWFsc1xuZXhwb3J0IHsgUGh5c2ljc01hdGVyaWFscywgYXBwbHlNYXRlcmlhbCB9IGZyb20gJy4vcGh5c2ljcy1tYXRlcmlhbHMnO1xuXG4vLyBUeXBlc1xuZXhwb3J0IHR5cGUge1xuICBCb2R5VHlwZSxcbiAgU3luY01vZGUsXG4gIFNoYXBlVHlwZSxcbiAgQ29sbGlzaW9uVGFnLFxuICBTaGFwZUNvbmZpZyxcbiAgUGh5c2ljc1dvcmxkT3B0aW9ucyxcbiAgUGh5c2ljc0JvZHlPcHRpb25zLFxuICBQaHlzaWNzRGVidWdPcHRpb25zLFxuICBDb2xsaXNpb25FdmVudCxcbiAgUmF5Y2FzdENhbGxiYWNrXG59IGZyb20gJy4vcGh5c2ljcy10eXBlcyc7XG4iLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0ICogYXMgcGxhbmNrIGZyb20gJ3BsYW5jayc7XG5pbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4uLy4uL2NvcmUvbG9naWMnO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzV29ybGQgfSBmcm9tICcuL3BoeXNpY3Mtd29ybGQnO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzQm9keU9wdGlvbnMsIEJvZHlUeXBlLCBTaGFwZVR5cGUgfSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuaW1wb3J0IHsgcGFyc2VHcmFwaGljc1NoYXBlIH0gZnJvbSAnLi9waHlzaWNzLWdyYXBoaWNzLXBhcnNlcic7XG5cbi8qKlxuICogTG9naWMgY29tcG9uZW50IHRoYXQgc3luY3MgYSBQSVhJIGVudGl0eSB3aXRoIGEgUGxhbmNrLmpzIHBoeXNpY3MgYm9keS5cbiAqIEhhbmRsZXMgcG9zaXRpb24vcm90YXRpb24gc3luYywgY29sbGlzaW9uIGZpbHRlcmluZywgYW5kIGZvcmNlIGFwcGxpY2F0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogLy8gQ3JlYXRlIHBoeXNpY3MgYm9keSBmb3IgYSBzcHJpdGVcbiAqIGNvbnN0IHNwcml0ZSA9IGFzRW50aXR5KG5ldyBQSVhJLlNwcml0ZSh0ZXh0dXJlKSk7XG4gKiBjb25zdCBib2R5ID0gbmV3IFBoeXNpY3NCb2R5TG9naWMocGh5c2ljc1dvcmxkLCB7XG4gKiAgIHR5cGU6ICdkeW5hbWljJyxcbiAqICAgY29sbGlzaW9uVGFnczogWydwbGF5ZXInXSxcbiAqICAgY29sbGlkZXNXaXRoOiBbJ3RlcnJhaW4nLCAnZW5lbXknXSxcbiAqICAgZGVuc2l0eTogMS4wLFxuICogICBmcmljdGlvbjogMC4zXG4gKiB9KTtcbiAqIHNwcml0ZS5tb3hpRW50aXR5LmFkZExvZ2ljKGJvZHkpO1xuICpcbiAqIC8vIEFwcGx5IGZvcmNlcyBpbiB1cGRhdGUgbG9vcFxuICogYm9keS5hcHBseUltcHVsc2UobmV3IFBJWEkuUG9pbnQoMTAwLCAwKSk7XG4gKiBib2R5LnNldFZlbG9jaXR5KG5ldyBQSVhJLlBvaW50KDAsIC0yMDApKTtcbiAqXG4gKiAvLyBDb2xsaXNpb24gY2FsbGJhY2tzXG4gKiBib2R5Lm9uQ29sbGlzaW9uQmVnaW4gPSAob3RoZXIsIGNvbnRhY3QpID0+IGNvbnNvbGUubG9nKCdoaXQhJyk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFBoeXNpY3NCb2R5TG9naWMgZXh0ZW5kcyBMb2dpYzxQSVhJLkNvbnRhaW5lcj4ge1xuICBuYW1lID0gJ1BoeXNpY3NCb2R5TG9naWMnO1xuXG4gIC8qKiBQbGFuY2suanMgYm9keSBpbnN0YW5jZS4gKi9cbiAgcHVibGljIGJvZHkhOiBwbGFuY2suQm9keTtcblxuICAvKiogUGFyZW50IHBoeXNpY3Mgd29ybGQuICovXG4gIHB1YmxpYyB3b3JsZDogUGh5c2ljc1dvcmxkO1xuXG4gIC8qKiBCb2R5IGNvbmZpZ3VyYXRpb24uICovXG4gIHB1YmxpYyBvcHRpb25zOiBQaHlzaWNzQm9keU9wdGlvbnM7XG5cbiAgLyoqIENhbGxlZCB3aGVuIGNvbGxpc2lvbiBiZWdpbnMuICovXG4gIHB1YmxpYyBvbkNvbGxpc2lvbkJlZ2luPzogKG90aGVyOiBQaHlzaWNzQm9keUxvZ2ljLCBjb250YWN0OiBwbGFuY2suQ29udGFjdCkgPT4gdm9pZDtcblxuICAvKiogQ2FsbGVkIHdoZW4gY29sbGlzaW9uIGVuZHMuICovXG4gIHB1YmxpYyBvbkNvbGxpc2lvbkVuZD86IChvdGhlcjogUGh5c2ljc0JvZHlMb2dpYywgY29udGFjdDogcGxhbmNrLkNvbnRhY3QpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3Iod29ybGQ6IFBoeXNpY3NXb3JsZCwgb3B0aW9uczogUGh5c2ljc0JvZHlPcHRpb25zID0ge30pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMud29ybGQgPSB3b3JsZDtcbiAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICB0eXBlOiAnZHluYW1pYycsXG4gICAgICBzeW5jTW9kZTogJ3BoeXNpY3MtZHJpdmVuJyxcbiAgICAgIHN5bmNQb3NpdGlvbjogdHJ1ZSxcbiAgICAgIHN5bmNSb3RhdGlvbjogdHJ1ZSxcbiAgICAgIGRlbnNpdHk6IDEuMCxcbiAgICAgIGZyaWN0aW9uOiAwLjMsXG4gICAgICByZXN0aXR1dGlvbjogMC4wLFxuICAgICAgZml4ZWRSb3RhdGlvbjogZmFsc2UsXG4gICAgICBpc1NlbnNvcjogZmFsc2UsXG4gICAgICBidWxsZXQ6IGZhbHNlLFxuICAgICAgLi4ub3B0aW9uc1xuICAgIH07XG4gIH1cblxuICAvKiogQGludGVybmFsIENyZWF0ZXMgcGh5c2ljcyBib2R5IGFuZCByZWdpc3RlcnMgd2l0aCB3b3JsZC4gKi9cbiAgaW5pdChlbnRpdHk6IFBJWEkuQ29udGFpbmVyLCByZW5kZXJlcj86IFBJWEkuUmVuZGVyZXIpOiB2b2lkIHtcbiAgICAvLyBDcmVhdGUgdGhlIHBoeXNpY3MgYm9keVxuICAgIHRoaXMuY3JlYXRlUGh5c2ljc0JvZHkoZW50aXR5KTtcblxuICAgIC8vIFNldCB1c2VyIGRhdGEgdG8gcmVmZXJlbmNlIHRoaXMgbG9naWMgY29tcG9uZW50XG4gICAgdGhpcy5ib2R5LnNldFVzZXJEYXRhKHRoaXMpO1xuXG4gICAgLy8gUmVnaXN0ZXIgd2l0aCBwaHlzaWNzIHdvcmxkXG4gICAgdGhpcy53b3JsZC5yZWdpc3RlckJvZHkodGhpcy5ib2R5LCB0aGlzKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgU3luY3MgcGh5c2ljcyDihpQgc3ByaXRlIGJhc2VkIG9uIHN5bmNNb2RlLiAqL1xuICB1cGRhdGUoZW50aXR5OiBQSVhJLkNvbnRhaW5lciwgZGVsdGFUaW1lPzogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmJvZHkpIHJldHVybjtcblxuICAgIC8vIFN5bmMgYmFzZWQgb24gbW9kZVxuICAgIHN3aXRjaCAodGhpcy5vcHRpb25zLnN5bmNNb2RlKSB7XG4gICAgICBjYXNlICdwaHlzaWNzLWRyaXZlbic6XG4gICAgICAgIHRoaXMuc3luY0Zyb21QaHlzaWNzKGVudGl0eSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc3ByaXRlLWRyaXZlbic6XG4gICAgICAgIHRoaXMuc3luY1RvUGh5c2ljcyhlbnRpdHkpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ21hbnVhbCc6XG4gICAgICAgIC8vIFVzZXIgaGFuZGxlcyBzeW5jIG1hbnVhbGx5XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBSZW1vdmVzIGJvZHkgZnJvbSBwaHlzaWNzIHdvcmxkLiAqL1xuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmJvZHkpIHtcbiAgICAgIHRoaXMud29ybGQuZGVzdHJveUJvZHkodGhpcy5ib2R5KTtcbiAgICB9XG4gIH1cblxuICAvKiogQGludGVybmFsIFVwZGF0ZXMgc3ByaXRlIHBvc2l0aW9uL3JvdGF0aW9uIGZyb20gcGh5c2ljcy4gKi9cbiAgcHJpdmF0ZSBzeW5jRnJvbVBoeXNpY3MoZW50aXR5OiBQSVhJLkNvbnRhaW5lcik6IHZvaWQge1xuICAgIGlmICghdGhpcy5ib2R5KSByZXR1cm47XG5cbiAgICBjb25zdCBwb3MgPSB0aGlzLmJvZHkuZ2V0UG9zaXRpb24oKTtcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuc3luY1Bvc2l0aW9uKSB7XG4gICAgICBlbnRpdHkueCA9IHRoaXMud29ybGQudG9QaXhlbHMocG9zLngpO1xuICAgICAgZW50aXR5LnkgPSB0aGlzLndvcmxkLnRvUGl4ZWxzKHBvcy55KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnN5bmNSb3RhdGlvbikge1xuICAgICAgZW50aXR5LnJvdGF0aW9uID0gdGhpcy5ib2R5LmdldEFuZ2xlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFVwZGF0ZXMgcGh5c2ljcyBib2R5IGZyb20gc3ByaXRlIHBvc2l0aW9uL3JvdGF0aW9uLiAqL1xuICBzeW5jVG9QaHlzaWNzKGVudGl0eTogUElYSS5Db250YWluZXIpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYm9keSkgcmV0dXJuO1xuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zeW5jUG9zaXRpb24pIHtcbiAgICAgIGNvbnN0IHggPSB0aGlzLndvcmxkLnRvUGh5c2ljcyhlbnRpdHkueCk7XG4gICAgICBjb25zdCB5ID0gdGhpcy53b3JsZC50b1BoeXNpY3MoZW50aXR5LnkpO1xuICAgICAgdGhpcy5ib2R5LnNldFBvc2l0aW9uKHBsYW5jay5WZWMyKHgsIHkpKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnN5bmNSb3RhdGlvbikge1xuICAgICAgdGhpcy5ib2R5LnNldEFuZ2xlKGVudGl0eS5yb3RhdGlvbik7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIGNyZWF0ZVBoeXNpY3NCb2R5KGVudGl0eTogUElYSS5Db250YWluZXIpOiB2b2lkIHtcbiAgICAvLyBEZXRlcm1pbmUgYm9keSB0eXBlXG4gICAgbGV0IGJvZHlUeXBlOiBwbGFuY2suQm9keVR5cGU7XG4gICAgc3dpdGNoICh0aGlzLm9wdGlvbnMudHlwZSkge1xuICAgICAgY2FzZSAnc3RhdGljJzpcbiAgICAgICAgYm9keVR5cGUgPSAnc3RhdGljJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdraW5lbWF0aWMnOlxuICAgICAgICBib2R5VHlwZSA9ICdraW5lbWF0aWMnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2R5bmFtaWMnOlxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYm9keVR5cGUgPSAnZHluYW1pYyc7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBib2R5IGRlZmluaXRpb25cbiAgICBjb25zdCBib2R5RGVmOiBwbGFuY2suQm9keURlZiA9IHtcbiAgICAgIHR5cGU6IGJvZHlUeXBlLFxuICAgICAgcG9zaXRpb246IHRoaXMub3B0aW9ucy5wb3NpdGlvblxuICAgICAgICA/IHRoaXMud29ybGQudG9QaHlzaWNzUG9pbnQodGhpcy5vcHRpb25zLnBvc2l0aW9uKVxuICAgICAgICA6IHBsYW5jay5WZWMyKHRoaXMud29ybGQudG9QaHlzaWNzKGVudGl0eS54KSwgdGhpcy53b3JsZC50b1BoeXNpY3MoZW50aXR5LnkpKSxcbiAgICAgIGFuZ2xlOiB0aGlzLm9wdGlvbnMucm90YXRpb24gPz8gZW50aXR5LnJvdGF0aW9uLFxuICAgICAgbGluZWFyVmVsb2NpdHk6IHRoaXMub3B0aW9ucy5saW5lYXJWZWxvY2l0eVxuICAgICAgICA/IHRoaXMud29ybGQudG9QaHlzaWNzUG9pbnQodGhpcy5vcHRpb25zLmxpbmVhclZlbG9jaXR5KVxuICAgICAgICA6IHBsYW5jay5WZWMyKDAsIDApLFxuICAgICAgYW5ndWxhclZlbG9jaXR5OiB0aGlzLm9wdGlvbnMuYW5ndWxhclZlbG9jaXR5ID8/IDAsXG4gICAgICBmaXhlZFJvdGF0aW9uOiB0aGlzLm9wdGlvbnMuZml4ZWRSb3RhdGlvbiA/PyBmYWxzZSxcbiAgICAgIGJ1bGxldDogdGhpcy5vcHRpb25zLmJ1bGxldCA/PyBmYWxzZVxuICAgIH07XG5cbiAgICAvLyBDcmVhdGUgdGhlIGJvZHlcbiAgICB0aGlzLmJvZHkgPSB0aGlzLndvcmxkLmNyZWF0ZUJvZHkoYm9keURlZik7XG5cbiAgICAvLyBDcmVhdGUgdGhlIHNoYXBlIGFuZCBmaXh0dXJlXG4gICAgdGhpcy5jcmVhdGVGaXh0dXJlKGVudGl0eSk7XG5cbiAgICAvLyBTZXQgaW5pdGlhbCB2ZWxvY2l0aWVzIGlmIHByb3ZpZGVkXG4gICAgaWYgKHRoaXMub3B0aW9ucy5saW5lYXJWZWxvY2l0eSkge1xuICAgICAgdGhpcy5zZXRWZWxvY2l0eSh0aGlzLm9wdGlvbnMubGluZWFyVmVsb2NpdHkpO1xuICAgIH1cbiAgICBpZiAodGhpcy5vcHRpb25zLmFuZ3VsYXJWZWxvY2l0eSkge1xuICAgICAgdGhpcy5zZXRBbmd1bGFyVmVsb2NpdHkodGhpcy5vcHRpb25zLmFuZ3VsYXJWZWxvY2l0eSk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIGNyZWF0ZUZpeHR1cmUoZW50aXR5OiBQSVhJLkNvbnRhaW5lcik6IHZvaWQge1xuICAgIGNvbnN0IHNoYXBlID0gdGhpcy5jcmVhdGVTaGFwZShlbnRpdHkpO1xuXG4gICAgLy8gU2V0dXAgY29sbGlzaW9uIGZpbHRlcmluZ1xuICAgIGNvbnN0IGNhdGVnb3J5Qml0cyA9IHRoaXMub3B0aW9ucy5jb2xsaXNpb25UYWdzXG4gICAgICA/IHRoaXMud29ybGQuY29sbGlzaW9uUmVnaXN0cnkudGFnc1RvQml0cyh0aGlzLm9wdGlvbnMuY29sbGlzaW9uVGFncylcbiAgICAgIDogdGhpcy53b3JsZC5jb2xsaXNpb25SZWdpc3RyeS5nZXRCaXQoJ2RlZmF1bHQnKTtcblxuICAgIGNvbnN0IG1hc2tCaXRzID0gdGhpcy5vcHRpb25zLmNvbGxpZGVzV2l0aFxuICAgICAgPyB0aGlzLndvcmxkLmNvbGxpc2lvblJlZ2lzdHJ5LnRhZ3NUb0JpdHModGhpcy5vcHRpb25zLmNvbGxpZGVzV2l0aClcbiAgICAgIDogMHhGRkZGOyAvLyBDb2xsaWRlIHdpdGggZXZlcnl0aGluZyBieSBkZWZhdWx0XG5cbiAgICBjb25zdCBncm91cEluZGV4ID0gdGhpcy5vcHRpb25zLmNvbGxpc2lvbkdyb3VwID8/IDA7XG5cbiAgICAvLyBDcmVhdGUgZml4dHVyZVxuICAgIHRoaXMuYm9keS5jcmVhdGVGaXh0dXJlKHtcbiAgICAgIHNoYXBlOiBzaGFwZSxcbiAgICAgIGRlbnNpdHk6IHRoaXMub3B0aW9ucy5kZW5zaXR5ID8/IDEuMCxcbiAgICAgIGZyaWN0aW9uOiB0aGlzLm9wdGlvbnMuZnJpY3Rpb24gPz8gMC4zLFxuICAgICAgcmVzdGl0dXRpb246IHRoaXMub3B0aW9ucy5yZXN0aXR1dGlvbiA/PyAwLjAsXG4gICAgICBpc1NlbnNvcjogdGhpcy5vcHRpb25zLmlzU2Vuc29yID8/IGZhbHNlLFxuICAgICAgZmlsdGVyQ2F0ZWdvcnlCaXRzOiBjYXRlZ29yeUJpdHMsXG4gICAgICBmaWx0ZXJNYXNrQml0czogbWFza0JpdHMsXG4gICAgICBmaWx0ZXJHcm91cEluZGV4OiBncm91cEluZGV4XG4gICAgfSk7XG4gIH1cblxuICAvKiogQGludGVybmFsIEV4dHJhY3RzIHNoYXBlIGZyb20gR3JhcGhpY3MsIGNvbGxpc2lvblNoYXBlLCBvciBsZWdhY3kgb3B0aW9ucy4gKi9cbiAgcHJpdmF0ZSBjcmVhdGVTaGFwZShlbnRpdHk6IFBJWEkuQ29udGFpbmVyKTogcGxhbmNrLlNoYXBlIHtcbiAgICAvLyBQcmlvcml0eSAxOiBFeHBsaWNpdCBjb2xsaXNpb24gc2hhcGUgcHJvdmlkZWRcbiAgICBpZiAodGhpcy5vcHRpb25zLmNvbGxpc2lvblNoYXBlKSB7XG4gICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZUdyYXBoaWNzU2hhcGUodGhpcy5vcHRpb25zLmNvbGxpc2lvblNoYXBlLCB0aGlzLndvcmxkKTtcbiAgICAgIHJldHVybiBwYXJzZWQuc2hhcGU7XG4gICAgfVxuXG4gICAgLy8gUHJpb3JpdHkgMjogRW50aXR5IGl0c2VsZiBpcyBHcmFwaGljcyDihpIgZXh0cmFjdCBmcm9tIGl0XG4gICAgaWYgKGVudGl0eSBpbnN0YW5jZW9mIFBJWEkuR3JhcGhpY3MpIHtcbiAgICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlR3JhcGhpY3NTaGFwZShlbnRpdHksIHRoaXMud29ybGQpO1xuICAgICAgcmV0dXJuIHBhcnNlZC5zaGFwZTtcbiAgICB9XG5cbiAgICAvLyBQcmlvcml0eSAzOiBMZWdhY3kgc2hhcGUgcHJvcGVydGllcyAoYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcbiAgICBpZiAodGhpcy5vcHRpb25zLnNoYXBlKSB7XG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVTaGFwZUZyb21UeXBlKHRoaXMub3B0aW9ucy5zaGFwZSk7XG4gICAgfVxuXG4gICAgLy8gTm8gY29sbGlzaW9uIHNoYXBlIGRlZmluZWQgLSBlcnJvciBmb3Igbm9uLUdyYXBoaWNzIGVudGl0aWVzXG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ0NvbGxpc2lvbiBzaGFwZSByZXF1aXJlZCBmb3Igbm9uLUdyYXBoaWNzIGVudGl0aWVzLiAnICtcbiAgICAgICdFaXRoZXIgcHJvdmlkZSBhIEdyYXBoaWNzIGVudGl0eSwgb3Igc3BlY2lmeSBvcHRpb25zLmNvbGxpc2lvblNoYXBlLCAnICtcbiAgICAgICdvciB1c2UgbGVnYWN5IG9wdGlvbnMuc2hhcGUgd2l0aCBkaW1lbnNpb25zLidcbiAgICApO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIGNyZWF0ZVNoYXBlRnJvbVR5cGUoc2hhcGVUeXBlOiBTaGFwZVR5cGUpOiBwbGFuY2suU2hhcGUge1xuICAgIHN3aXRjaCAoc2hhcGVUeXBlKSB7XG4gICAgICBjYXNlICdjaXJjbGUnOlxuICAgICAgICBjb25zdCByYWRpdXMgPSB0aGlzLm9wdGlvbnMucmFkaXVzID8/IDI1O1xuICAgICAgICByZXR1cm4gcGxhbmNrLkNpcmNsZSh0aGlzLndvcmxkLnRvUGh5c2ljcyhyYWRpdXMpKTtcblxuICAgICAgY2FzZSAncmVjdGFuZ2xlJzpcbiAgICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLm9wdGlvbnMud2lkdGggPz8gNTA7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IHRoaXMub3B0aW9ucy5oZWlnaHQgPz8gNTA7XG4gICAgICAgIHJldHVybiBwbGFuY2suQm94KFxuICAgICAgICAgIHRoaXMud29ybGQudG9QaHlzaWNzKHdpZHRoIC8gMiksXG4gICAgICAgICAgdGhpcy53b3JsZC50b1BoeXNpY3MoaGVpZ2h0IC8gMilcbiAgICAgICAgKTtcblxuICAgICAgY2FzZSAncG9seWdvbic6XG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLnZlcnRpY2VzIHx8IHRoaXMub3B0aW9ucy52ZXJ0aWNlcy5sZW5ndGggPCAzKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQb2x5Z29uIHNoYXBlIHJlcXVpcmVzIGF0IGxlYXN0IDMgdmVydGljZXMnKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMub3B0aW9ucy52ZXJ0aWNlcy5tYXAodiA9PlxuICAgICAgICAgIHBsYW5jay5WZWMyKHRoaXMud29ybGQudG9QaHlzaWNzKHYueCksIHRoaXMud29ybGQudG9QaHlzaWNzKHYueSkpXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBwbGFuY2suUG9seWdvbih2ZXJ0aWNlcyk7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBzaGFwZSB0eXBlOiAke3NoYXBlVHlwZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKiogQGludGVybmFsIEZhbGxiYWNrOiBjcmVhdGVzIGJveCBmcm9tIGVudGl0eSBib3VuZHMuICovXG4gIHByaXZhdGUgYXV0b0RldGVjdFNoYXBlKGVudGl0eTogUElYSS5Db250YWluZXIpOiBwbGFuY2suU2hhcGUge1xuICAgIC8vIEZvciBzcHJpdGVzLCB1c2UgdGV4dHVyZSBib3VuZHNcbiAgICBjb25zdCBib3VuZHMgPSBlbnRpdHkuZ2V0TG9jYWxCb3VuZHMoKTtcblxuICAgIC8vIERlZmF1bHQgdG8gcmVjdGFuZ2xlXG4gICAgcmV0dXJuIHBsYW5jay5Cb3goXG4gICAgICB0aGlzLndvcmxkLnRvUGh5c2ljcyhib3VuZHMud2lkdGggLyAyKSxcbiAgICAgIHRoaXMud29ybGQudG9QaHlzaWNzKGJvdW5kcy5oZWlnaHQgLyAyKVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQXBwbHkgY29udGludW91cyBmb3JjZSBhdCBhIHBvaW50LiBGb3JjZSBpcyBpbiBwaXhlbHMvc2VjwrIuXG4gICAqIEBwYXJhbSBmb3JjZSAtIEZvcmNlIHZlY3RvciBpbiBwaXhlbHNcbiAgICogQHBhcmFtIHBvaW50IC0gQXBwbGljYXRpb24gcG9pbnQgKGRlZmF1bHRzIHRvIGNlbnRlciBvZiBtYXNzKVxuICAgKi9cbiAgYXBwbHlGb3JjZShmb3JjZTogUElYSS5Qb2ludCwgcG9pbnQ/OiBQSVhJLlBvaW50KTogdm9pZCB7XG4gICAgY29uc3QgZm9yY2VWZWMgPSB0aGlzLndvcmxkLnRvUGh5c2ljc1BvaW50KGZvcmNlKTtcbiAgICBjb25zdCBwb2ludFZlYyA9IHBvaW50XG4gICAgICA/IHRoaXMud29ybGQudG9QaHlzaWNzUG9pbnQocG9pbnQpXG4gICAgICA6IHRoaXMuYm9keS5nZXRXb3JsZENlbnRlcigpO1xuICAgIHRoaXMuYm9keS5hcHBseUZvcmNlKGZvcmNlVmVjLCBwb2ludFZlYyk7XG4gIH1cblxuICAvKipcbiAgICogQXBwbHkgaW5zdGFudCBpbXB1bHNlIGF0IGEgcG9pbnQuIEdvb2QgZm9yIGp1bXBzLCBleHBsb3Npb25zLlxuICAgKiBAcGFyYW0gaW1wdWxzZSAtIEltcHVsc2UgdmVjdG9yIGluIHBpeGVsc1xuICAgKiBAcGFyYW0gcG9pbnQgLSBBcHBsaWNhdGlvbiBwb2ludCAoZGVmYXVsdHMgdG8gY2VudGVyIG9mIG1hc3MpXG4gICAqL1xuICBhcHBseUltcHVsc2UoaW1wdWxzZTogUElYSS5Qb2ludCwgcG9pbnQ/OiBQSVhJLlBvaW50KTogdm9pZCB7XG4gICAgY29uc3QgaW1wdWxzZVZlYyA9IHRoaXMud29ybGQudG9QaHlzaWNzUG9pbnQoaW1wdWxzZSk7XG4gICAgY29uc3QgcG9pbnRWZWMgPSBwb2ludFxuICAgICAgPyB0aGlzLndvcmxkLnRvUGh5c2ljc1BvaW50KHBvaW50KVxuICAgICAgOiB0aGlzLmJvZHkuZ2V0V29ybGRDZW50ZXIoKTtcbiAgICB0aGlzLmJvZHkuYXBwbHlMaW5lYXJJbXB1bHNlKGltcHVsc2VWZWMsIHBvaW50VmVjKTtcbiAgfVxuXG4gIC8qKiBBcHBseSByb3RhdGlvbmFsIHRvcnF1ZS4gKi9cbiAgYXBwbHlUb3JxdWUodG9ycXVlOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLmJvZHkuYXBwbHlUb3JxdWUodG9ycXVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgbGluZWFyIHZlbG9jaXR5IGRpcmVjdGx5LlxuICAgKiBAcGFyYW0gdmVsb2NpdHkgLSBWZWxvY2l0eSBpbiBwaXhlbHMvc2VjXG4gICAqL1xuICBzZXRWZWxvY2l0eSh2ZWxvY2l0eTogUElYSS5Qb2ludCk6IHZvaWQge1xuICAgIGNvbnN0IHZlbG9jaXR5VmVjID0gdGhpcy53b3JsZC50b1BoeXNpY3NQb2ludCh2ZWxvY2l0eSk7XG4gICAgdGhpcy5ib2R5LnNldExpbmVhclZlbG9jaXR5KHZlbG9jaXR5VmVjKTtcbiAgfVxuXG4gIC8qKiBTZXQgcm90YXRpb24gc3BlZWQgKHJhZGlhbnMvc2VjKS4gKi9cbiAgc2V0QW5ndWxhclZlbG9jaXR5KG9tZWdhOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLmJvZHkuc2V0QW5ndWxhclZlbG9jaXR5KG9tZWdhKTtcbiAgfVxuXG4gIC8qKiBHZXQgY3VycmVudCB2ZWxvY2l0eSAocGl4ZWxzL3NlYykuICovXG4gIGdldFZlbG9jaXR5KCk6IFBJWEkuUG9pbnQge1xuICAgIGNvbnN0IHZlbCA9IHRoaXMuYm9keS5nZXRMaW5lYXJWZWxvY2l0eSgpO1xuICAgIHJldHVybiB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQodmVsKTtcbiAgfVxuXG4gIC8qKiBHZXQgcm90YXRpb24gc3BlZWQgKHJhZGlhbnMvc2VjKS4gKi9cbiAgZ2V0QW5ndWxhclZlbG9jaXR5KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuYm9keS5nZXRBbmd1bGFyVmVsb2NpdHkoKTtcbiAgfVxuXG4gIC8qKiBHZXQgYm9keSBtYXNzIChrZyBpbiBwaHlzaWNzIHVuaXRzKS4gKi9cbiAgZ2V0TWFzcygpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmJvZHkuZ2V0TWFzcygpO1xuICB9XG5cbiAgLyoqIFRydWUgaWYgYm9keSBpcyBhY3RpdmUgKG5vdCBzbGVlcGluZykuICovXG4gIGlzQXdha2UoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuYm9keS5pc0F3YWtlKCk7XG4gIH1cblxuICAvKiogVHJ1ZSBpZiBib2R5IGlzIHNsZWVwaW5nIChpbmFjdGl2ZSkuICovXG4gIGlzU2xlZXBpbmcoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICF0aGlzLmJvZHkuaXNBd2FrZSgpO1xuICB9XG5cbiAgLyoqIFdha2UgdXAgb3IgcHV0IGJvZHkgdG8gc2xlZXAuICovXG4gIHNldEF3YWtlKGF3YWtlOiBib29sZWFuKTogdm9pZCB7XG4gICAgdGhpcy5ib2R5LnNldEF3YWtlKGF3YWtlKTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCAqIGFzIHBsYW5jayBmcm9tICdwbGFuY2snO1xuaW1wb3J0IHR5cGUgeyBDb2xsaXNpb25UYWcsIENvbGxpc2lvbkV2ZW50IH0gZnJvbSAnLi9waHlzaWNzLXR5cGVzJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi9waHlzaWNzLXdvcmxkJztcblxuLyoqXG4gKiBUYWctdG8tYml0bWFzayBjb252ZXJ0ZXIgZm9yIGNvbGxpc2lvbiBmaWx0ZXJpbmcuXG4gKiBBdXRvLXJlZ2lzdGVycyB0YWdzIG9uIGZpcnN0IHVzZS4gTWF4IDE2IHVuaXF1ZSB0YWdzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogLy8gVGFncyBhcmUgYXV0by1yZWdpc3RlcmVkLCBubyBjb25maWcgbmVlZGVkXG4gKiBjb25zdCBiaXRzID0gcmVnaXN0cnkudGFnc1RvQml0cyhbJ3BsYXllcicsICdlbmVteSddKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgQ29sbGlzaW9uUmVnaXN0cnkge1xuICBwcml2YXRlIHRhZ1RvQml0OiBNYXA8Q29sbGlzaW9uVGFnLCBudW1iZXI+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIGJpdFRvVGFnOiBNYXA8bnVtYmVyLCBDb2xsaXNpb25UYWc+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIG5leHRCaXQ6IG51bWJlciA9IDE7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8gUHJlLXJlZ2lzdGVyICdkZWZhdWx0JyB0YWdcbiAgICB0aGlzLnJlZ2lzdGVyKCdkZWZhdWx0Jyk7XG4gIH1cblxuICAvKiogUmVnaXN0ZXIgdGFnIG1hbnVhbGx5LiBDYWxsZWQgYXV0b21hdGljYWxseSBieSBnZXRCaXQoKS4gKi9cbiAgcmVnaXN0ZXIodGFnOiBDb2xsaXNpb25UYWcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50YWdUb0JpdC5oYXModGFnKSkgcmV0dXJuO1xuXG4gICAgaWYgKHRoaXMubmV4dEJpdCA+IDB4ODAwMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNYXhpbXVtIGNvbGxpc2lvbiB0YWdzIHJlYWNoZWQgKDE2IHRhZ3MpJyk7XG4gICAgfVxuXG4gICAgdGhpcy50YWdUb0JpdC5zZXQodGFnLCB0aGlzLm5leHRCaXQpO1xuICAgIHRoaXMuYml0VG9UYWcuc2V0KHRoaXMubmV4dEJpdCwgdGFnKTtcbiAgICB0aGlzLm5leHRCaXQgPDw9IDE7XG4gIH1cblxuICAvKiogR2V0IGJpdG1hc2sgZm9yIHRhZy4gQXV0by1yZWdpc3RlcnMgbmV3IHRhZ3MuICovXG4gIGdldEJpdCh0YWc6IENvbGxpc2lvblRhZyk6IG51bWJlciB7XG4gICAgaWYgKCF0aGlzLnRhZ1RvQml0Lmhhcyh0YWcpKSB7XG4gICAgICB0aGlzLnJlZ2lzdGVyKHRhZyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnRhZ1RvQml0LmdldCh0YWcpITtcbiAgfVxuXG4gIC8qKiBSZXZlcnNlIGxvb2t1cDogYml0IOKGkiB0YWcuICovXG4gIGdldFRhZyhiaXQ6IG51bWJlcik6IENvbGxpc2lvblRhZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuYml0VG9UYWcuZ2V0KGJpdCk7XG4gIH1cblxuICAvKiogQ29udmVydCBbJ3BsYXllcicsICdlbmVteSddIOKGkiBjb21iaW5lZCBiaXRtYXNrLiAqL1xuICB0YWdzVG9CaXRzKHRhZ3M6IENvbGxpc2lvblRhZ1tdKTogbnVtYmVyIHtcbiAgICBpZiAoIXRhZ3MgfHwgdGFncy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB0aGlzLmdldEJpdCgnZGVmYXVsdCcpO1xuICAgIH1cbiAgICByZXR1cm4gdGFncy5yZWR1Y2UoKGJpdHMsIHRhZykgPT4gYml0cyB8IHRoaXMuZ2V0Qml0KHRhZyksIDApO1xuICB9XG5cbiAgLyoqIENvbnZlcnQgYml0bWFzayDihpIgdGFnIGFycmF5LiAqL1xuICBiaXRzVG9UYWdzKGJpdHM6IG51bWJlcik6IENvbGxpc2lvblRhZ1tdIHtcbiAgICBjb25zdCB0YWdzOiBDb2xsaXNpb25UYWdbXSA9IFtdO1xuICAgIGZvciAoY29uc3QgW2JpdCwgdGFnXSBvZiB0aGlzLmJpdFRvVGFnKSB7XG4gICAgICBpZiAoYml0cyAmIGJpdCkge1xuICAgICAgICB0YWdzLnB1c2godGFnKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhZ3M7XG4gIH1cbn1cblxuLyoqIEBpbnRlcm5hbCBQaHlzaWNzIGJvZHkgdXNlciBkYXRhIHN0cnVjdHVyZS4gKi9cbmludGVyZmFjZSBQaHlzaWNzQm9keVVzZXJEYXRhIHtcbiAgb3B0aW9uczoge1xuICAgIGNvbGxpc2lvblRhZ3M/OiBDb2xsaXNpb25UYWdbXTtcbiAgfTtcbiAgb25Db2xsaXNpb25CZWdpbj86IChvdGhlcjogUGh5c2ljc0JvZHlVc2VyRGF0YSwgY29udGFjdDogcGxhbmNrLkNvbnRhY3QpID0+IHZvaWQ7XG4gIG9uQ29sbGlzaW9uRW5kPzogKG90aGVyOiBQaHlzaWNzQm9keVVzZXJEYXRhLCBjb250YWN0OiBwbGFuY2suQ29udGFjdCkgPT4gdm9pZDtcbn1cblxuLyoqIEBpbnRlcm5hbCBUeXBlIGd1YXJkIGZvciBib2R5IHVzZXIgZGF0YS4gKi9cbmZ1bmN0aW9uIGlzUGh5c2ljc0JvZHlVc2VyRGF0YShvYmo6IHVua25vd24pOiBvYmogaXMgUGh5c2ljc0JvZHlVc2VyRGF0YSB7XG4gIHJldHVybiAoXG4gICAgb2JqICE9PSBudWxsICYmXG4gICAgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiZcbiAgICAnb3B0aW9ucycgaW4gb2JqICYmXG4gICAgdHlwZW9mIChvYmogYXMgYW55KS5vcHRpb25zID09PSAnb2JqZWN0J1xuICApO1xufVxuXG4vKipcbiAqIE1hbmFnZXMgdGFnLWJhc2VkIGNvbGxpc2lvbiBjYWxsYmFja3MgYmV0d2VlbiBwaHlzaWNzIGJvZGllcy5cbiAqIFJlZ2lzdGVyIGNhbGxiYWNrcyBmb3Igc3BlY2lmaWMgdGFnIHBhaXJzIHRvIGhhbmRsZSBjb2xsaXNpb25zLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogLy8gUmVnaXN0ZXIgY29sbGlzaW9uIGhhbmRsZXJcbiAqIHBoeXNpY3NXb3JsZC5jb2xsaXNpb25NYW5hZ2VyLm9uQ29sbGlzaW9uKCdwbGF5ZXInLCAnZW5lbXknLCAoZXZlbnQpID0+IHtcbiAqICAgY29uc29sZS5sb2coJ1BsYXllciBoaXQgZW5lbXkhJyk7XG4gKiAgIGNvbnN0IHBsYXllckJvZHkgPSBldmVudC5ib2R5QTtcbiAqICAgY29uc3QgZW5lbXlCb2R5ID0gZXZlbnQuYm9keUI7XG4gKiB9KTtcbiAqXG4gKiAvLyBNdWx0aXBsZSB0YWcgY29tYmluYXRpb25zXG4gKiBwaHlzaWNzV29ybGQuY29sbGlzaW9uTWFuYWdlci5vbkNvbGxpc2lvbigncHJvamVjdGlsZScsICdlbmVteScsIChlKSA9PiB7XG4gKiAgIGUuYm9keUIuZGVzdHJveSgpOyAvLyBEZXN0cm95IGVuZW15XG4gKiB9KTtcbiAqXG4gKiAvLyBSZW1vdmUgY2FsbGJhY2tcbiAqIHBoeXNpY3NXb3JsZC5jb2xsaXNpb25NYW5hZ2VyLm9mZkNvbGxpc2lvbigncGxheWVyJywgJ2VuZW15JywgaGFuZGxlcik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIENvbGxpc2lvbk1hbmFnZXIge1xuICBwcml2YXRlIHdvcmxkOiBQaHlzaWNzV29ybGQ7XG4gIHByaXZhdGUgcmVnaXN0cnk6IENvbGxpc2lvblJlZ2lzdHJ5O1xuICBwcml2YXRlIGNhbGxiYWNrczogTWFwPHN0cmluZywgU2V0PChldmVudDogQ29sbGlzaW9uRXZlbnQpID0+IHZvaWQ+PiA9IG5ldyBNYXAoKTtcblxuICBjb25zdHJ1Y3Rvcih3b3JsZDogUGh5c2ljc1dvcmxkLCByZWdpc3RyeTogQ29sbGlzaW9uUmVnaXN0cnkpIHtcbiAgICB0aGlzLndvcmxkID0gd29ybGQ7XG4gICAgdGhpcy5yZWdpc3RyeSA9IHJlZ2lzdHJ5O1xuICAgIHRoaXMuc2V0dXBMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0dXBMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgdGhpcy53b3JsZC53b3JsZC5vbignYmVnaW4tY29udGFjdCcsIChjb250YWN0OiBwbGFuY2suQ29udGFjdCkgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVCZWdpbkNvbnRhY3QoY29udGFjdCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLndvcmxkLndvcmxkLm9uKCdlbmQtY29udGFjdCcsIChjb250YWN0OiBwbGFuY2suQ29udGFjdCkgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVFbmRDb250YWN0KGNvbnRhY3QpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqIFJlZ2lzdGVyIGNhbGxiYWNrIGZvciBjb2xsaXNpb25zIGJldHdlZW4gdHdvIHRhZ3MuICovXG4gIG9uQ29sbGlzaW9uKFxuICAgIHRhZ0E6IENvbGxpc2lvblRhZyxcbiAgICB0YWdCOiBDb2xsaXNpb25UYWcsXG4gICAgY2FsbGJhY2s6IChldmVudDogQ29sbGlzaW9uRXZlbnQpID0+IHZvaWRcbiAgKTogdm9pZCB7XG4gICAgY29uc3Qga2V5ID0gdGhpcy5tYWtlS2V5KHRhZ0EsIHRhZ0IpO1xuICAgIGlmICghdGhpcy5jYWxsYmFja3MuaGFzKGtleSkpIHtcbiAgICAgIHRoaXMuY2FsbGJhY2tzLnNldChrZXksIG5ldyBTZXQoKSk7XG4gICAgfVxuICAgIHRoaXMuY2FsbGJhY2tzLmdldChrZXkpIS5hZGQoY2FsbGJhY2spO1xuICB9XG5cbiAgLyoqIFJlbW92ZSBjb2xsaXNpb24gY2FsbGJhY2suICovXG4gIG9mZkNvbGxpc2lvbihcbiAgICB0YWdBOiBDb2xsaXNpb25UYWcsXG4gICAgdGFnQjogQ29sbGlzaW9uVGFnLFxuICAgIGNhbGxiYWNrOiAoZXZlbnQ6IENvbGxpc2lvbkV2ZW50KSA9PiB2b2lkXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGtleSA9IHRoaXMubWFrZUtleSh0YWdBLCB0YWdCKTtcbiAgICB0aGlzLmNhbGxiYWNrcy5nZXQoa2V5KT8uZGVsZXRlKGNhbGxiYWNrKTtcbiAgfVxuXG4gIHByaXZhdGUgbWFrZUtleSh0YWdBOiBDb2xsaXNpb25UYWcsIHRhZ0I6IENvbGxpc2lvblRhZyk6IHN0cmluZyB7XG4gICAgLy8gU29ydCB0YWdzIHRvIGVuc3VyZSBjb25zaXN0ZW50IGtleSByZWdhcmRsZXNzIG9mIG9yZGVyXG4gICAgcmV0dXJuIHRhZ0EgPCB0YWdCID8gYCR7dGFnQX06JHt0YWdCfWAgOiBgJHt0YWdCfToke3RhZ0F9YDtcbiAgfVxuXG4gIC8vIFRyaWdnZXIgY2FsbGJhY2tzXG4gIHByaXZhdGUgaGFuZGxlQmVnaW5Db250YWN0KGNvbnRhY3Q6IHBsYW5jay5Db250YWN0KTogdm9pZCB7XG4gICAgY29uc3QgYm9keUEgPSBjb250YWN0LmdldEZpeHR1cmVBKCkuZ2V0Qm9keSgpLmdldFVzZXJEYXRhKCk7XG4gICAgY29uc3QgYm9keUIgPSBjb250YWN0LmdldEZpeHR1cmVCKCkuZ2V0Qm9keSgpLmdldFVzZXJEYXRhKCk7XG5cbiAgICBpZiAoIWlzUGh5c2ljc0JvZHlVc2VyRGF0YShib2R5QSkgfHwgIWlzUGh5c2ljc0JvZHlVc2VyRGF0YShib2R5QikpIHJldHVybjtcblxuICAgIC8vIENhbGwgZW50aXR5LWxldmVsIGNhbGxiYWNrc1xuICAgIGJvZHlBLm9uQ29sbGlzaW9uQmVnaW4/Lihib2R5QiwgY29udGFjdCk7XG4gICAgYm9keUIub25Db2xsaXNpb25CZWdpbj8uKGJvZHlBLCBjb250YWN0KTtcblxuICAgIC8vIENhbGwgZ2xvYmFsIHRhZy1iYXNlZCBjYWxsYmFja3NcbiAgICB0aGlzLnRyaWdnZXJUYWdDYWxsYmFja3MoYm9keUEsIGJvZHlCLCBjb250YWN0KTtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlRW5kQ29udGFjdChjb250YWN0OiBwbGFuY2suQ29udGFjdCk6IHZvaWQge1xuICAgIGNvbnN0IGJvZHlBID0gY29udGFjdC5nZXRGaXh0dXJlQSgpLmdldEJvZHkoKS5nZXRVc2VyRGF0YSgpO1xuICAgIGNvbnN0IGJvZHlCID0gY29udGFjdC5nZXRGaXh0dXJlQigpLmdldEJvZHkoKS5nZXRVc2VyRGF0YSgpO1xuXG4gICAgaWYgKCFpc1BoeXNpY3NCb2R5VXNlckRhdGEoYm9keUEpIHx8ICFpc1BoeXNpY3NCb2R5VXNlckRhdGEoYm9keUIpKSByZXR1cm47XG5cbiAgICBib2R5QS5vbkNvbGxpc2lvbkVuZD8uKGJvZHlCLCBjb250YWN0KTtcbiAgICBib2R5Qi5vbkNvbGxpc2lvbkVuZD8uKGJvZHlBLCBjb250YWN0KTtcbiAgfVxuXG4gIHByaXZhdGUgdHJpZ2dlclRhZ0NhbGxiYWNrcyhcbiAgICBib2R5QTogUGh5c2ljc0JvZHlVc2VyRGF0YSxcbiAgICBib2R5QjogUGh5c2ljc0JvZHlVc2VyRGF0YSxcbiAgICBjb250YWN0OiBwbGFuY2suQ29udGFjdFxuICApOiB2b2lkIHtcbiAgICAvLyBHZXQgdGFncyBmcm9tIGJvdGggYm9kaWVzXG4gICAgY29uc3QgdGFnc0EgPSBib2R5QS5vcHRpb25zLmNvbGxpc2lvblRhZ3MgfHwgW107XG4gICAgY29uc3QgdGFnc0IgPSBib2R5Qi5vcHRpb25zLmNvbGxpc2lvblRhZ3MgfHwgW107XG5cbiAgICAvLyBDaGVjayBhbGwgdGFnIGNvbWJpbmF0aW9uc1xuICAgIGZvciAoY29uc3QgdGFnQSBvZiB0YWdzQSkge1xuICAgICAgZm9yIChjb25zdCB0YWdCIG9mIHRhZ3NCKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IHRoaXMubWFrZUtleSh0YWdBLCB0YWdCKTtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gdGhpcy5jYWxsYmFja3MuZ2V0KGtleSk7XG5cbiAgICAgICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICAgIGNvbnN0IGV2ZW50OiBDb2xsaXNpb25FdmVudCA9IHtcbiAgICAgICAgICAgIGJvZHlBLFxuICAgICAgICAgICAgYm9keUIsXG4gICAgICAgICAgICBjb250YWN0LFxuICAgICAgICAgICAgbm9ybWFsOiBuZXcgUElYSS5Qb2ludCgwLCAwKSwgLy8gVE9ETzogRXh0cmFjdCBmcm9tIGNvbnRhY3RcbiAgICAgICAgICAgIGltcHVsc2U6IDAgLy8gVE9ETzogRXh0cmFjdCBmcm9tIGNvbnRhY3RcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgY2FsbGJhY2tzLmZvckVhY2goY2IgPT4gY2IoZXZlbnQpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCAqIGFzIHBsYW5jayBmcm9tICdwbGFuY2snO1xuaW1wb3J0IHsgTG9naWMgfSBmcm9tICcuLi8uLi9jb3JlL2xvZ2ljJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi9waHlzaWNzLXdvcmxkJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc0RlYnVnT3B0aW9ucyB9IGZyb20gJy4vcGh5c2ljcy10eXBlcyc7XG5cbi8qKlxuICogUmVuZGVycyBwaHlzaWNzIGNvbGxpc2lvbiBzaGFwZXMsIHZlbG9jaXRpZXMsIEFBQkJzIGZvciBkZWJ1Z2dpbmcuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjb25zdCBkZWJ1ZyA9IHBoeXNpY3NXb3JsZC5lbmFibGVEZWJ1Z1JlbmRlcmVyKHNjZW5lKTtcbiAqIGRlYnVnLnRvZ2dsZSgpOyAvLyBUb2dnbGUgdmlzaWJpbGl0eVxuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBQaHlzaWNzRGVidWdSZW5kZXJlciBleHRlbmRzIExvZ2ljPFBJWEkuR3JhcGhpY3M+IHtcbiAgbmFtZSA9ICdQaHlzaWNzRGVidWdSZW5kZXJlcic7XG5cbiAgcHJpdmF0ZSB3b3JsZDogUGh5c2ljc1dvcmxkO1xuICBwcml2YXRlIGdyYXBoaWNzITogUElYSS5HcmFwaGljcztcbiAgcHJpdmF0ZSBvcHRpb25zOiBSZXF1aXJlZDxQaHlzaWNzRGVidWdPcHRpb25zPjtcbiAgcHJpdmF0ZSBpc1Zpc2libGU6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIGNvbnN0cnVjdG9yKHdvcmxkOiBQaHlzaWNzV29ybGQsIG9wdGlvbnM6IFBoeXNpY3NEZWJ1Z09wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy53b3JsZCA9IHdvcmxkO1xuICAgIHRoaXMub3B0aW9ucyA9IHtcbiAgICAgIHNob3dTaGFwZXM6IG9wdGlvbnMuc2hvd1NoYXBlcyA/PyB0cnVlLFxuICAgICAgc2hvd1ZlbG9jaXRpZXM6IG9wdGlvbnMuc2hvd1ZlbG9jaXRpZXMgPz8gZmFsc2UsXG4gICAgICBzaG93QUFCQnM6IG9wdGlvbnMuc2hvd0FBQkJzID8/IGZhbHNlLFxuICAgICAgc2hvd0NlbnRlck9mTWFzczogb3B0aW9ucy5zaG93Q2VudGVyT2ZNYXNzID8/IGZhbHNlLFxuICAgICAgc2hvd0NvbnRhY3RQb2ludHM6IG9wdGlvbnMuc2hvd0NvbnRhY3RQb2ludHMgPz8gZmFsc2UsXG4gICAgICBzaG93Sm9pbnRzOiBvcHRpb25zLnNob3dKb2ludHMgPz8gZmFsc2UsXG4gICAgICBjb2xvclN0YXRpYzogb3B0aW9ucy5jb2xvclN0YXRpYyA/PyAweDAwRkYwMCxcbiAgICAgIGNvbG9yRHluYW1pYzogb3B0aW9ucy5jb2xvckR5bmFtaWMgPz8gMHhGRjAwMDAsXG4gICAgICBjb2xvcktpbmVtYXRpYzogb3B0aW9ucy5jb2xvcktpbmVtYXRpYyA/PyAweDAwMDBGRixcbiAgICAgIGNvbG9yU2xlZXBpbmc6IG9wdGlvbnMuY29sb3JTbGVlcGluZyA/PyAweEFBQUFBQSxcbiAgICAgIGNvbG9yU2Vuc29yOiBvcHRpb25zLmNvbG9yU2Vuc29yID8/IDB4RkZGRjAwLFxuICAgICAgYWxwaGE6IG9wdGlvbnMuYWxwaGEgPz8gMC41LFxuICAgICAgbGluZVdpZHRoOiBvcHRpb25zLmxpbmVXaWR0aCA/PyAyXG4gICAgfTtcbiAgfVxuXG4gIGluaXQoZW50aXR5OiBQSVhJLkdyYXBoaWNzLCByZW5kZXJlcj86IFBJWEkuUmVuZGVyZXIpOiB2b2lkIHtcbiAgICB0aGlzLmdyYXBoaWNzID0gZW50aXR5O1xuICB9XG5cbiAgdXBkYXRlKGVudGl0eTogUElYSS5HcmFwaGljcywgZGVsdGFUaW1lPzogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmlzVmlzaWJsZSkge1xuICAgICAgdGhpcy5ncmFwaGljcy5jbGVhcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd1NoYXBlcykge1xuICAgICAgLy8gSXRlcmF0ZSBhbGwgYm9kaWVzIGluIHBoeXNpY3Mgd29ybGRcbiAgICAgIGZvciAobGV0IGJvZHkgPSB0aGlzLndvcmxkLndvcmxkLmdldEJvZHlMaXN0KCk7IGJvZHk7IGJvZHkgPSBib2R5LmdldE5leHQoKSkge1xuICAgICAgICB0aGlzLmRyYXdCb2R5KGJvZHkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd0NvbnRhY3RQb2ludHMpIHtcbiAgICAgIHRoaXMuZHJhd0NvbnRhY3RzKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBkcmF3Qm9keShib2R5OiBwbGFuY2suQm9keSk6IHZvaWQge1xuICAgIGNvbnN0IHRyYW5zZm9ybSA9IGJvZHkuZ2V0VHJhbnNmb3JtKCk7XG5cbiAgICAvLyBEZXRlcm1pbmUgY29sb3IgYmFzZWQgb24gYm9keSB0eXBlIGFuZCBzdGF0ZVxuICAgIGxldCBjb2xvcjogbnVtYmVyO1xuXG4gICAgaWYgKCFib2R5LmlzQXdha2UoKSAmJiBib2R5LmlzRHluYW1pYygpKSB7XG4gICAgICBjb2xvciA9IHRoaXMub3B0aW9ucy5jb2xvclNsZWVwaW5nO1xuICAgIH0gZWxzZSBpZiAoYm9keS5pc1N0YXRpYygpKSB7XG4gICAgICBjb2xvciA9IHRoaXMub3B0aW9ucy5jb2xvclN0YXRpYztcbiAgICB9IGVsc2UgaWYgKGJvZHkuaXNLaW5lbWF0aWMoKSkge1xuICAgICAgY29sb3IgPSB0aGlzLm9wdGlvbnMuY29sb3JLaW5lbWF0aWM7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbG9yID0gdGhpcy5vcHRpb25zLmNvbG9yRHluYW1pYztcbiAgICB9XG5cbiAgICAvLyBEcmF3IGVhY2ggZml4dHVyZVxuICAgIGZvciAobGV0IGZpeHR1cmUgPSBib2R5LmdldEZpeHR1cmVMaXN0KCk7IGZpeHR1cmU7IGZpeHR1cmUgPSBmaXh0dXJlLmdldE5leHQoKSkge1xuICAgICAgY29uc3Qgc2hhcGUgPSBmaXh0dXJlLmdldFNoYXBlKCk7XG5cbiAgICAgIC8vIFVzZSB5ZWxsb3cgc2VtaS10cmFuc3BhcmVudCBmb3Igc2Vuc29yc1xuICAgICAgY29uc3QgZml4dHVyZUNvbG9yID0gZml4dHVyZS5pc1NlbnNvcigpID8gdGhpcy5vcHRpb25zLmNvbG9yU2Vuc29yIDogY29sb3I7XG4gICAgICBjb25zdCBhbHBoYSA9IGZpeHR1cmUuaXNTZW5zb3IoKSA/IHRoaXMub3B0aW9ucy5hbHBoYSAqIDAuNSA6IHRoaXMub3B0aW9ucy5hbHBoYTtcblxuICAgICAgdGhpcy5kcmF3U2hhcGUoc2hhcGUsIHRyYW5zZm9ybSwgZml4dHVyZUNvbG9yLCBhbHBoYSk7XG4gICAgfVxuXG4gICAgLy8gRHJhdyB2ZWxvY2l0eSB2ZWN0b3IgaWYgZW5hYmxlZFxuICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd1ZlbG9jaXRpZXMgJiYgYm9keS5pc0R5bmFtaWMoKSkge1xuICAgICAgdGhpcy5kcmF3VmVsb2NpdHkoYm9keSk7XG4gICAgfVxuXG4gICAgLy8gRHJhdyBBQUJCIGlmIGVuYWJsZWRcbiAgICBpZiAodGhpcy5vcHRpb25zLnNob3dBQUJCcykge1xuICAgICAgdGhpcy5kcmF3QUFCQihib2R5KTtcbiAgICB9XG5cbiAgICAvLyBEcmF3IGNlbnRlciBvZiBtYXNzIGlmIGVuYWJsZWRcbiAgICBpZiAodGhpcy5vcHRpb25zLnNob3dDZW50ZXJPZk1hc3MpIHtcbiAgICAgIHRoaXMuZHJhd0NlbnRlck9mTWFzcyhib2R5KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRyYXdTaGFwZShzaGFwZTogcGxhbmNrLlNoYXBlLCB0cmFuc2Zvcm06IHBsYW5jay5UcmFuc2Zvcm0sIGNvbG9yOiBudW1iZXIsIGFscGhhOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSh7XG4gICAgICB3aWR0aDogdGhpcy5vcHRpb25zLmxpbmVXaWR0aCxcbiAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgIGFscGhhOiBhbHBoYVxuICAgIH0pO1xuXG4gICAgY29uc3Qgc2hhcGVUeXBlID0gc2hhcGUuZ2V0VHlwZSgpO1xuXG4gICAgaWYgKHNoYXBlVHlwZSA9PT0gJ2NpcmNsZScpIHtcbiAgICAgIGNvbnN0IGNpcmNsZSA9IHNoYXBlIGFzIHBsYW5jay5DaXJjbGVTaGFwZTtcbiAgICAgIGNvbnN0IGNlbnRlciA9IHBsYW5jay5WZWMyLmFkZCh0cmFuc2Zvcm0ucCwgcGxhbmNrLlJvdC5tdWxWZWMyKHRyYW5zZm9ybS5xLCBjaXJjbGUuZ2V0Q2VudGVyKCkpKTtcbiAgICAgIGNvbnN0IHJhZGl1cyA9IGNpcmNsZS5nZXRSYWRpdXMoKTtcblxuICAgICAgY29uc3QgcGl4ZWxDZW50ZXIgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQoY2VudGVyKTtcbiAgICAgIGNvbnN0IHBpeGVsUmFkaXVzID0gdGhpcy53b3JsZC50b1BpeGVscyhyYWRpdXMpO1xuXG4gICAgICB0aGlzLmdyYXBoaWNzLmNpcmNsZShwaXhlbENlbnRlci54LCBwaXhlbENlbnRlci55LCBwaXhlbFJhZGl1cyk7XG4gICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xuXG4gICAgICAvLyBEcmF3IHJhZGl1cyBsaW5lIHRvIHNob3cgcm90YXRpb25cbiAgICAgIGNvbnN0IGFuZ2xlID0gdHJhbnNmb3JtLnEuZ2V0QW5nbGUoKTtcbiAgICAgIGNvbnN0IGVuZFggPSBwaXhlbENlbnRlci54ICsgTWF0aC5jb3MoYW5nbGUpICogcGl4ZWxSYWRpdXM7XG4gICAgICBjb25zdCBlbmRZID0gcGl4ZWxDZW50ZXIueSArIE1hdGguc2luKGFuZ2xlKSAqIHBpeGVsUmFkaXVzO1xuICAgICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxDZW50ZXIueCwgcGl4ZWxDZW50ZXIueSk7XG4gICAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhlbmRYLCBlbmRZKTtcbiAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG4gICAgfSBlbHNlIGlmIChzaGFwZVR5cGUgPT09ICdwb2x5Z29uJykge1xuICAgICAgY29uc3QgcG9seSA9IHNoYXBlIGFzIHBsYW5jay5Qb2x5Z29uU2hhcGU7XG4gICAgICBjb25zdCB2ZXJ0aWNlcyA9IHBvbHkubV92ZXJ0aWNlcztcblxuICAgICAgaWYgKHZlcnRpY2VzICYmIHZlcnRpY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gVHJhbnNmb3JtIGZpcnN0IHZlcnRleFxuICAgICAgICBjb25zdCBmaXJzdFZlcnRleCA9IHBsYW5jay5WZWMyLmFkZCh0cmFuc2Zvcm0ucCwgcGxhbmNrLlJvdC5tdWxWZWMyKHRyYW5zZm9ybS5xLCB2ZXJ0aWNlc1swXSkpO1xuICAgICAgICBjb25zdCBwaXhlbEZpcnN0ID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KGZpcnN0VmVydGV4KTtcblxuICAgICAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwaXhlbEZpcnN0LngsIHBpeGVsRmlyc3QueSk7XG5cbiAgICAgICAgLy8gVHJhbnNmb3JtIGFuZCBkcmF3IHJlbWFpbmluZyB2ZXJ0aWNlc1xuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgdmVydGV4ID0gcGxhbmNrLlZlYzIuYWRkKHRyYW5zZm9ybS5wLCBwbGFuY2suUm90Lm11bFZlYzIodHJhbnNmb3JtLnEsIHZlcnRpY2VzW2ldKSk7XG4gICAgICAgICAgY29uc3QgcGl4ZWxWZXJ0ZXggPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQodmVydGV4KTtcbiAgICAgICAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhwaXhlbFZlcnRleC54LCBwaXhlbFZlcnRleC55KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENsb3NlIHRoZSBwb2x5Z29uXG4gICAgICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKHBpeGVsRmlyc3QueCwgcGl4ZWxGaXJzdC55KTtcbiAgICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHNoYXBlVHlwZSA9PT0gJ2VkZ2UnKSB7XG4gICAgICBjb25zdCBlZGdlID0gc2hhcGUgYXMgcGxhbmNrLkVkZ2VTaGFwZTtcbiAgICAgIGNvbnN0IHYxID0gcGxhbmNrLlZlYzIuYWRkKHRyYW5zZm9ybS5wLCBwbGFuY2suUm90Lm11bFZlYzIodHJhbnNmb3JtLnEsIGVkZ2UubV92ZXJ0ZXgxKSk7XG4gICAgICBjb25zdCB2MiA9IHBsYW5jay5WZWMyLmFkZCh0cmFuc2Zvcm0ucCwgcGxhbmNrLlJvdC5tdWxWZWMyKHRyYW5zZm9ybS5xLCBlZGdlLm1fdmVydGV4MikpO1xuXG4gICAgICBjb25zdCBwMSA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludCh2MSk7XG4gICAgICBjb25zdCBwMiA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludCh2Mik7XG5cbiAgICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHAxLngsIHAxLnkpO1xuICAgICAgdGhpcy5ncmFwaGljcy5saW5lVG8ocDIueCwgcDIueSk7XG4gICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xuICAgIH0gZWxzZSBpZiAoc2hhcGVUeXBlID09PSAnY2hhaW4nKSB7XG4gICAgICBjb25zdCBjaGFpbiA9IHNoYXBlIGFzIHBsYW5jay5DaGFpblNoYXBlO1xuICAgICAgY29uc3QgdmVydGljZXMgPSBjaGFpbi5tX3ZlcnRpY2VzO1xuXG4gICAgICBpZiAodmVydGljZXMgJiYgdmVydGljZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBmaXJzdFZlcnRleCA9IHBsYW5jay5WZWMyLmFkZCh0cmFuc2Zvcm0ucCwgcGxhbmNrLlJvdC5tdWxWZWMyKHRyYW5zZm9ybS5xLCB2ZXJ0aWNlc1swXSkpO1xuICAgICAgICBjb25zdCBwaXhlbEZpcnN0ID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KGZpcnN0VmVydGV4KTtcbiAgICAgICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxGaXJzdC54LCBwaXhlbEZpcnN0LnkpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdmVydGljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCB2ZXJ0ZXggPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgdmVydGljZXNbaV0pKTtcbiAgICAgICAgICBjb25zdCBwaXhlbFZlcnRleCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludCh2ZXJ0ZXgpO1xuICAgICAgICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKHBpeGVsVmVydGV4LngsIHBpeGVsVmVydGV4LnkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRyYXdWZWxvY2l0eShib2R5OiBwbGFuY2suQm9keSk6IHZvaWQge1xuICAgIGNvbnN0IHBvc2l0aW9uID0gYm9keS5nZXRQb3NpdGlvbigpO1xuICAgIGNvbnN0IHZlbG9jaXR5ID0gYm9keS5nZXRMaW5lYXJWZWxvY2l0eSgpO1xuXG4gICAgLy8gU2NhbGUgdmVsb2NpdHkgZm9yIHZpc2liaWxpdHlcbiAgICBjb25zdCBzY2FsZSA9IDAuNTtcbiAgICBjb25zdCBlbmRQb2ludCA9IHBsYW5jay5WZWMyLmFkZChwb3NpdGlvbiwgcGxhbmNrLlZlYzIubXVsKHZlbG9jaXR5LCBzY2FsZSkpO1xuXG4gICAgY29uc3QgcGl4ZWxTdGFydCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChwb3NpdGlvbik7XG4gICAgY29uc3QgcGl4ZWxFbmQgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQoZW5kUG9pbnQpO1xuXG4gICAgdGhpcy5ncmFwaGljcy5zdHJva2Uoe1xuICAgICAgd2lkdGg6IDIsXG4gICAgICBjb2xvcjogMHgwMEZGRkYsXG4gICAgICBhbHBoYTogMC44XG4gICAgfSk7XG5cbiAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwaXhlbFN0YXJ0LngsIHBpeGVsU3RhcnQueSk7XG4gICAgdGhpcy5ncmFwaGljcy5saW5lVG8ocGl4ZWxFbmQueCwgcGl4ZWxFbmQueSk7XG4gICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcblxuICAgIC8vIERyYXcgYXJyb3cgaGVhZFxuICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5hdGFuMihwaXhlbEVuZC55IC0gcGl4ZWxTdGFydC55LCBwaXhlbEVuZC54IC0gcGl4ZWxTdGFydC54KTtcbiAgICBjb25zdCBhcnJvd1NpemUgPSA1O1xuICAgIGNvbnN0IGFuZ2xlMSA9IGFuZ2xlICsgTWF0aC5QSSAqIDAuODtcbiAgICBjb25zdCBhbmdsZTIgPSBhbmdsZSAtIE1hdGguUEkgKiAwLjg7XG5cbiAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwaXhlbEVuZC54LCBwaXhlbEVuZC55KTtcbiAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhcbiAgICAgIHBpeGVsRW5kLnggKyBNYXRoLmNvcyhhbmdsZTEpICogYXJyb3dTaXplLFxuICAgICAgcGl4ZWxFbmQueSArIE1hdGguc2luKGFuZ2xlMSkgKiBhcnJvd1NpemVcbiAgICApO1xuICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsRW5kLngsIHBpeGVsRW5kLnkpO1xuICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKFxuICAgICAgcGl4ZWxFbmQueCArIE1hdGguY29zKGFuZ2xlMikgKiBhcnJvd1NpemUsXG4gICAgICBwaXhlbEVuZC55ICsgTWF0aC5zaW4oYW5nbGUyKSAqIGFycm93U2l6ZVxuICAgICk7XG4gICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcbiAgfVxuXG4gIHByaXZhdGUgZHJhd0FBQkIoYm9keTogcGxhbmNrLkJvZHkpOiB2b2lkIHtcbiAgICBmb3IgKGxldCBmaXh0dXJlID0gYm9keS5nZXRGaXh0dXJlTGlzdCgpOyBmaXh0dXJlOyBmaXh0dXJlID0gZml4dHVyZS5nZXROZXh0KCkpIHtcbiAgICAgIGNvbnN0IGFhYmIgPSBmaXh0dXJlLmdldEFBQkIoMCk7XG5cbiAgICAgIGNvbnN0IGxvd2VyQm91bmQgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQoYWFiYi5sb3dlckJvdW5kKTtcbiAgICAgIGNvbnN0IHVwcGVyQm91bmQgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQoYWFiYi51cHBlckJvdW5kKTtcblxuICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2Uoe1xuICAgICAgICB3aWR0aDogMSxcbiAgICAgICAgY29sb3I6IDB4RkYwMEZGLFxuICAgICAgICBhbHBoYTogMC4zXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5ncmFwaGljcy5yZWN0KFxuICAgICAgICBsb3dlckJvdW5kLngsXG4gICAgICAgIGxvd2VyQm91bmQueSxcbiAgICAgICAgdXBwZXJCb3VuZC54IC0gbG93ZXJCb3VuZC54LFxuICAgICAgICB1cHBlckJvdW5kLnkgLSBsb3dlckJvdW5kLnlcbiAgICAgICk7XG4gICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZHJhd0NlbnRlck9mTWFzcyhib2R5OiBwbGFuY2suQm9keSk6IHZvaWQge1xuICAgIGNvbnN0IHBvc2l0aW9uID0gYm9keS5nZXRXb3JsZENlbnRlcigpO1xuICAgIGNvbnN0IHBpeGVsUG9zID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHBvc2l0aW9uKTtcblxuICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKHtcbiAgICAgIHdpZHRoOiAxLFxuICAgICAgY29sb3I6IDB4RkZGRkZGLFxuICAgICAgYWxwaGE6IDFcbiAgICB9KTtcblxuICAgIGNvbnN0IHNpemUgPSA1O1xuICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsUG9zLnggLSBzaXplLCBwaXhlbFBvcy55KTtcbiAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhwaXhlbFBvcy54ICsgc2l6ZSwgcGl4ZWxQb3MueSk7XG4gICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxQb3MueCwgcGl4ZWxQb3MueSAtIHNpemUpO1xuICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKHBpeGVsUG9zLngsIHBpeGVsUG9zLnkgKyBzaXplKTtcbiAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBkcmF3Q29udGFjdHMoKTogdm9pZCB7XG4gICAgLy8gSXRlcmF0ZSB0aHJvdWdoIGFsbCBjb250YWN0cyBpbiB0aGUgd29ybGRcbiAgICBmb3IgKGxldCBjb250YWN0ID0gdGhpcy53b3JsZC53b3JsZC5nZXRDb250YWN0TGlzdCgpOyBjb250YWN0OyBjb250YWN0ID0gY29udGFjdC5nZXROZXh0KCkpIHtcbiAgICAgIGlmICghY29udGFjdC5pc1RvdWNoaW5nKCkpIGNvbnRpbnVlO1xuXG4gICAgICBjb25zdCBtYW5pZm9sZCA9IGNvbnRhY3QuZ2V0TWFuaWZvbGQoKTtcbiAgICAgIGlmICghbWFuaWZvbGQpIGNvbnRpbnVlO1xuXG4gICAgICBjb25zdCB3b3JsZE1hbmlmb2xkID0gY29udGFjdC5nZXRXb3JsZE1hbmlmb2xkKG51bGwpO1xuICAgICAgaWYgKCF3b3JsZE1hbmlmb2xkKSBjb250aW51ZTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYW5pZm9sZC5wb2ludENvdW50OyBpKyspIHtcbiAgICAgICAgY29uc3QgcG9pbnQgPSB3b3JsZE1hbmlmb2xkLnBvaW50c1tpXTtcbiAgICAgICAgaWYgKCFwb2ludCkgY29udGludWU7XG4gICAgICAgIGNvbnN0IHBpeGVsUG9pbnQgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQocGxhbmNrLlZlYzIocG9pbnQueCwgcG9pbnQueSkpO1xuXG4gICAgICAgIHRoaXMuZ3JhcGhpY3MuY2lyY2xlKHBpeGVsUG9pbnQueCwgcGl4ZWxQb2ludC55LCAzKTtcbiAgICAgICAgdGhpcy5ncmFwaGljcy5maWxsKHsgY29sb3I6IDB4RkYwMDAwLCBhbHBoYTogMC44IH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKiBTaG93IG9yIGhpZGUgZGVidWcgdmlzdWFsaXphdGlvbi4gKi9cbiAgc2V0VmlzaWJsZSh2aXNpYmxlOiBib29sZWFuKTogdm9pZCB7XG4gICAgdGhpcy5pc1Zpc2libGUgPSB2aXNpYmxlO1xuICAgIGlmICghdmlzaWJsZSkge1xuICAgICAgdGhpcy5ncmFwaGljcy5jbGVhcigpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBUb2dnbGUgdmlzaWJpbGl0eS4gKi9cbiAgdG9nZ2xlKCk6IHZvaWQge1xuICAgIHRoaXMuc2V0VmlzaWJsZSghdGhpcy5pc1Zpc2libGUpO1xuICB9XG5cbiAgLyoqIENoZWNrIGN1cnJlbnQgdmlzaWJpbGl0eS4gKi9cbiAgZ2V0VmlzaWJsZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5pc1Zpc2libGU7XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgKiBhcyBwbGFuY2sgZnJvbSAncGxhbmNrJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi9waHlzaWNzLXdvcmxkJztcblxuLyoqIFJlc3VsdCBmcm9tIHBhcnNlR3JhcGhpY3NTaGFwZSgpLiAqL1xuZXhwb3J0IGludGVyZmFjZSBQYXJzZWRTaGFwZSB7XG4gIHR5cGU6ICdjaXJjbGUnIHwgJ3JlY3RhbmdsZScgfCAncG9seWdvbic7XG4gIHNoYXBlOiBwbGFuY2suU2hhcGU7XG59XG5cbi8qKiBAaW50ZXJuYWwgTWV0YWRhdGEgc3RvcmVkIG9uIEdyYXBoaWNzIGZvciBwaHlzaWNzIGV4dHJhY3Rpb24uICovXG5leHBvcnQgaW50ZXJmYWNlIFBoeXNpY3NTaGFwZU1ldGFkYXRhIHtcbiAgdHlwZTogJ2NpcmNsZScgfCAncmVjdGFuZ2xlJyB8ICdwb2x5Z29uJztcbiAgcmFkaXVzPzogbnVtYmVyO1xuICB3aWR0aD86IG51bWJlcjtcbiAgaGVpZ2h0PzogbnVtYmVyO1xuICB2ZXJ0aWNlcz86IG51bWJlcltdO1xufVxuXG5jb25zdCBQSFlTSUNTX1NIQVBFX0tFWSA9ICdfX3BoeXNpY3NTaGFwZV9fJztcblxuLyoqIEBpbnRlcm5hbCBBdHRhY2ggc2hhcGUgbWV0YWRhdGEgdG8gR3JhcGhpY3MuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0R3JhcGhpY3NQaHlzaWNzU2hhcGUoZ3JhcGhpY3M6IFBJWEkuR3JhcGhpY3MsIG1ldGFkYXRhOiBQaHlzaWNzU2hhcGVNZXRhZGF0YSk6IHZvaWQge1xuICAoZ3JhcGhpY3MgYXMgYW55KVtQSFlTSUNTX1NIQVBFX0tFWV0gPSBtZXRhZGF0YTtcbn1cblxuLyoqIEBpbnRlcm5hbCBQYXRjaGVzIFBJWEkuR3JhcGhpY3MucmVjdC9jaXJjbGUvcG9seSB0byBhdXRvLXRyYWNrIHNoYXBlcy4gQ2FsbGVkIG9uY2UgYnkgUGh5c2ljc1dvcmxkLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRHcmFwaGljc1BoeXNpY3NUcmFja2luZygpOiB2b2lkIHtcbiAgLy8gU2F2ZSBvcmlnaW5hbCBtZXRob2RzXG4gIGNvbnN0IG9yaWdpbmFsUmVjdCA9IFBJWEkuR3JhcGhpY3MucHJvdG90eXBlLnJlY3Q7XG4gIGNvbnN0IG9yaWdpbmFsQ2lyY2xlID0gUElYSS5HcmFwaGljcy5wcm90b3R5cGUuY2lyY2xlO1xuICBjb25zdCBvcmlnaW5hbFBvbHkgPSBQSVhJLkdyYXBoaWNzLnByb3RvdHlwZS5wb2x5O1xuXG4gIC8vIFBhdGNoIHJlY3QoKSB0byBzdG9yZSBtZXRhZGF0YVxuICBQSVhJLkdyYXBoaWNzLnByb3RvdHlwZS5yZWN0ID0gZnVuY3Rpb24gKHg6IG51bWJlciwgeTogbnVtYmVyLCB3OiBudW1iZXIsIGg6IG51bWJlcikge1xuICAgIHNldEdyYXBoaWNzUGh5c2ljc1NoYXBlKHRoaXMsIHtcbiAgICAgIHR5cGU6ICdyZWN0YW5nbGUnLFxuICAgICAgd2lkdGg6IHcsXG4gICAgICBoZWlnaHQ6IGhcbiAgICB9KTtcbiAgICByZXR1cm4gb3JpZ2luYWxSZWN0LmNhbGwodGhpcywgeCwgeSwgdywgaCk7XG4gIH07XG5cbiAgLy8gUGF0Y2ggY2lyY2xlKCkgdG8gc3RvcmUgbWV0YWRhdGFcbiAgUElYSS5HcmFwaGljcy5wcm90b3R5cGUuY2lyY2xlID0gZnVuY3Rpb24gKHg6IG51bWJlciwgeTogbnVtYmVyLCByYWRpdXM6IG51bWJlcikge1xuICAgIHNldEdyYXBoaWNzUGh5c2ljc1NoYXBlKHRoaXMsIHtcbiAgICAgIHR5cGU6ICdjaXJjbGUnLFxuICAgICAgcmFkaXVzOiByYWRpdXNcbiAgICB9KTtcbiAgICByZXR1cm4gb3JpZ2luYWxDaXJjbGUuY2FsbCh0aGlzLCB4LCB5LCByYWRpdXMpO1xuICB9O1xuXG4gIC8vIFBhdGNoIHBvbHkoKSB0byBzdG9yZSBtZXRhZGF0YVxuICBQSVhJLkdyYXBoaWNzLnByb3RvdHlwZS5wb2x5ID0gZnVuY3Rpb24gKHBvaW50czogUElYSS5Qb2ludERhdGFbXSB8IG51bWJlcltdKSB7XG4gICAgY29uc3QgZmxhdFBvaW50cyA9IEFycmF5LmlzQXJyYXkocG9pbnRzWzBdKSA/IHBvaW50cy5mbGF0KCkgOiBwb2ludHM7XG4gICAgc2V0R3JhcGhpY3NQaHlzaWNzU2hhcGUodGhpcywge1xuICAgICAgdHlwZTogJ3BvbHlnb24nLFxuICAgICAgdmVydGljZXM6IGZsYXRQb2ludHMgYXMgbnVtYmVyW11cbiAgICB9KTtcbiAgICByZXR1cm4gb3JpZ2luYWxQb2x5LmNhbGwodGhpcywgcG9pbnRzIGFzIGFueSk7XG4gIH07XG59XG5cbi8qKiBFeHRyYWN0IFBsYW5jayBzaGFwZSBmcm9tIFBJWEkuR3JhcGhpY3MuIFVzZXMgc3RvcmVkIG1ldGFkYXRhIG9yIGZhbGxzIGJhY2sgdG8gYm91bmRzLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlR3JhcGhpY3NTaGFwZShncmFwaGljczogUElYSS5HcmFwaGljcywgd29ybGQ6IFBoeXNpY3NXb3JsZCk6IFBhcnNlZFNoYXBlIHtcbiAgLy8gQ2hlY2sgaWYgc2hhcGUgbWV0YWRhdGEgd2FzIHN0b3JlZFxuICBjb25zdCBtZXRhZGF0YSA9IChncmFwaGljcyBhcyBhbnkpW1BIWVNJQ1NfU0hBUEVfS0VZXSBhcyBQaHlzaWNzU2hhcGVNZXRhZGF0YSB8IHVuZGVmaW5lZDtcblxuICBpZiAobWV0YWRhdGEpIHtcbiAgICAvLyBVc2Ugc3RvcmVkIG1ldGFkYXRhXG4gICAgc3dpdGNoIChtZXRhZGF0YS50eXBlKSB7XG4gICAgICBjYXNlICdjaXJjbGUnOlxuICAgICAgICBpZiAoIW1ldGFkYXRhLnJhZGl1cykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2lyY2xlIG1ldGFkYXRhIG1pc3NpbmcgcmFkaXVzJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiAnY2lyY2xlJyxcbiAgICAgICAgICBzaGFwZTogcGxhbmNrLkNpcmNsZSh3b3JsZC50b1BoeXNpY3MobWV0YWRhdGEucmFkaXVzKSlcbiAgICAgICAgfTtcblxuICAgICAgY2FzZSAncmVjdGFuZ2xlJzpcbiAgICAgICAgaWYgKCFtZXRhZGF0YS53aWR0aCB8fCAhbWV0YWRhdGEuaGVpZ2h0KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWN0YW5nbGUgbWV0YWRhdGEgbWlzc2luZyB3aWR0aC9oZWlnaHQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6ICdyZWN0YW5nbGUnLFxuICAgICAgICAgIHNoYXBlOiBwbGFuY2suQm94KFxuICAgICAgICAgICAgd29ybGQudG9QaHlzaWNzKG1ldGFkYXRhLndpZHRoIC8gMiksXG4gICAgICAgICAgICB3b3JsZC50b1BoeXNpY3MobWV0YWRhdGEuaGVpZ2h0IC8gMilcbiAgICAgICAgICApXG4gICAgICAgIH07XG5cbiAgICAgIGNhc2UgJ3BvbHlnb24nOlxuICAgICAgICBpZiAoIW1ldGFkYXRhLnZlcnRpY2VzIHx8IG1ldGFkYXRhLnZlcnRpY2VzLmxlbmd0aCA8IDYpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BvbHlnb24gbWV0YWRhdGEgbWlzc2luZyB2ZXJ0aWNlcyAobmVlZCBhdCBsZWFzdCAzIHBvaW50cyA9IDYgdmFsdWVzKScpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZlcnRpY2VzOiBwbGFuY2suVmVjMltdID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWV0YWRhdGEudmVydGljZXMubGVuZ3RoOyBpICs9IDIpIHtcbiAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKFxuICAgICAgICAgICAgcGxhbmNrLlZlYzIoXG4gICAgICAgICAgICAgIHdvcmxkLnRvUGh5c2ljcyhtZXRhZGF0YS52ZXJ0aWNlc1tpXSksXG4gICAgICAgICAgICAgIHdvcmxkLnRvUGh5c2ljcyhtZXRhZGF0YS52ZXJ0aWNlc1tpICsgMV0pXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6ICdwb2x5Z29uJyxcbiAgICAgICAgICBzaGFwZTogcGxhbmNrLlBvbHlnb24odmVydGljZXMpXG4gICAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLy8gRmFsbGJhY2s6IFVzZSBib3VuZGluZyBib3ggYXMgcmVjdGFuZ2xlXG4gIGNvbnN0IGJvdW5kcyA9IGdyYXBoaWNzLmdldExvY2FsQm91bmRzKCk7XG5cbiAgaWYgKGJvdW5kcy53aWR0aCA9PT0gMCB8fCBib3VuZHMuaGVpZ2h0ID09PSAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ0dyYXBoaWNzIGhhcyBubyBkaW1lbnNpb25zLiBFaXRoZXIgZHJhdyBzaGFwZXMgdXNpbmcgcmVjdCgpLCBjaXJjbGUoKSwgb3IgcG9seSgpLCAnICtcbiAgICAgICdvciBwcm92aWRlIGFuIGV4cGxpY2l0IGNvbGxpc2lvblNoYXBlIG9wdGlvbi4nXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ3JlY3RhbmdsZScsXG4gICAgc2hhcGU6IHBsYW5jay5Cb3goXG4gICAgICB3b3JsZC50b1BoeXNpY3MoYm91bmRzLndpZHRoIC8gMiksXG4gICAgICB3b3JsZC50b1BoeXNpY3MoYm91bmRzLmhlaWdodCAvIDIpXG4gICAgKVxuICB9O1xufVxuIiwiaW1wb3J0IHR5cGUgeyBQaHlzaWNzQm9keU9wdGlvbnMgfSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuXG4vKipcbiAqIFByZWRlZmluZWQgbWF0ZXJpYWwgcHJlc2V0cyBmb3IgY29tbW9uIHBoeXNpY3MgYmVoYXZpb3JzXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGJhbGwgPSBhc1BoeXNpY3NFbnRpdHkoc3ByaXRlLCB3b3JsZCwge1xuICogICB0eXBlOiAnZHluYW1pYycsXG4gKiAgIC4uLlBoeXNpY3NNYXRlcmlhbHMuYm91bmN5XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY29uc3QgUGh5c2ljc01hdGVyaWFscyA9IHtcbiAgLyoqXG4gICAqIEJvdW5jeSBiYWxsIC0gaGlnaCByZXN0aXR1dGlvbiwgbG93IGZyaWN0aW9uXG4gICAqL1xuICBib3VuY3k6IHtcbiAgICBkZW5zaXR5OiAwLjUsXG4gICAgZnJpY3Rpb246IDAuMSxcbiAgICByZXN0aXR1dGlvbjogMC45XG4gIH0sXG5cbiAgLyoqXG4gICAqIFdvb2RlbiBib3ggLSBtZWRpdW0gZGVuc2l0eSwgbWVkaXVtIGZyaWN0aW9uXG4gICAqL1xuICB3b29kOiB7XG4gICAgZGVuc2l0eTogMC43LFxuICAgIGZyaWN0aW9uOiAwLjQsXG4gICAgcmVzdGl0dXRpb246IDAuMlxuICB9LFxuXG4gIC8qKlxuICAgKiBNZXRhbCBvYmplY3QgLSBoaWdoIGRlbnNpdHksIGxvdyByZXN0aXR1dGlvblxuICAgKi9cbiAgbWV0YWw6IHtcbiAgICBkZW5zaXR5OiAxLjUsXG4gICAgZnJpY3Rpb246IDAuMyxcbiAgICByZXN0aXR1dGlvbjogMC4xXG4gIH0sXG5cbiAgLyoqXG4gICAqIEljZSAtIHZlcnkgbG93IGZyaWN0aW9uLCBsb3cgcmVzdGl0dXRpb25cbiAgICovXG4gIGljZToge1xuICAgIGRlbnNpdHk6IDAuOSxcbiAgICBmcmljdGlvbjogMC4wMixcbiAgICByZXN0aXR1dGlvbjogMC4wNVxuICB9LFxuXG4gIC8qKlxuICAgKiBSdWJiZXIgLSBoaWdoIGZyaWN0aW9uLCBoaWdoIHJlc3RpdHV0aW9uXG4gICAqL1xuICBydWJiZXI6IHtcbiAgICBkZW5zaXR5OiAxLjAsXG4gICAgZnJpY3Rpb246IDAuOSxcbiAgICByZXN0aXR1dGlvbjogMC43XG4gIH0sXG5cbiAgLyoqXG4gICAqIENoYXJhY3RlciAtIG5vIHJvdGF0aW9uLCBtZWRpdW0gZnJpY3Rpb25cbiAgICovXG4gIGNoYXJhY3Rlcjoge1xuICAgIGRlbnNpdHk6IDEuMCxcbiAgICBmcmljdGlvbjogMC41LFxuICAgIHJlc3RpdHV0aW9uOiAwLjAsXG4gICAgZml4ZWRSb3RhdGlvbjogdHJ1ZVxuICB9LFxuXG4gIC8qKlxuICAgKiBTdGF0aWMgdGVycmFpbiAtIG5vIGRlbnNpdHkgKGltbW92YWJsZSksIGhpZ2ggZnJpY3Rpb25cbiAgICovXG4gIHRlcnJhaW46IHtcbiAgICBkZW5zaXR5OiAwLFxuICAgIGZyaWN0aW9uOiAwLjYsXG4gICAgcmVzdGl0dXRpb246IDAuMFxuICB9XG59IGFzIGNvbnN0O1xuXG4vKipcbiAqIEFwcGx5IG1hdGVyaWFsIHByZXNldCB0byBvcHRpb25zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcHBseU1hdGVyaWFsKFxuICBvcHRpb25zOiBQaHlzaWNzQm9keU9wdGlvbnMsXG4gIG1hdGVyaWFsOiBrZXlvZiB0eXBlb2YgUGh5c2ljc01hdGVyaWFsc1xuKTogUGh5c2ljc0JvZHlPcHRpb25zIHtcbiAgcmV0dXJuIHtcbiAgICAuLi5vcHRpb25zLFxuICAgIC4uLlBoeXNpY3NNYXRlcmlhbHNbbWF0ZXJpYWxdXG4gIH07XG59XG4iLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgYXNFbnRpdHksIEFzRW50aXR5IH0gZnJvbSAnLi4vLi4vY29yZS9tb3hpLWVudGl0eSc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NXb3JsZCB9IGZyb20gJy4vcGh5c2ljcy13b3JsZCc7XG5pbXBvcnQgeyBQaHlzaWNzQm9keUxvZ2ljIH0gZnJvbSAnLi9waHlzaWNzLWJvZHktbG9naWMnO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzQm9keU9wdGlvbnMsIFNoYXBlQ29uZmlnIH0gZnJvbSAnLi9waHlzaWNzLXR5cGVzJztcblxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIGEgcGh5c2ljcy1lbmFibGVkIGVudGl0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gKiBjb25zdCBwaHlzaWNzRW50aXR5ID0gYXNQaHlzaWNzRW50aXR5KHNwcml0ZSwgcGh5c2ljc1dvcmxkLCB7XG4gKiAgIHR5cGU6ICdkeW5hbWljJyxcbiAqICAgc2hhcGU6ICdjaXJjbGUnLFxuICogICByYWRpdXM6IDI1XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNQaHlzaWNzRW50aXR5PFQgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lcj4oXG4gIHBpeGlPYmplY3Q6IFQsXG4gIHdvcmxkOiBQaHlzaWNzV29ybGQsXG4gIG9wdGlvbnM6IFBoeXNpY3NCb2R5T3B0aW9ucyA9IHt9XG4pOiBBc0VudGl0eTxUPiB7XG4gIGNvbnN0IGVudGl0eSA9IGFzRW50aXR5KHBpeGlPYmplY3QpO1xuICBjb25zdCBwaHlzaWNzTG9naWMgPSBuZXcgUGh5c2ljc0JvZHlMb2dpYyh3b3JsZCwgb3B0aW9ucyk7XG4gIGVudGl0eS5tb3hpRW50aXR5LmFkZExvZ2ljKHBoeXNpY3NMb2dpYyk7XG4gIHJldHVybiBlbnRpdHkgYXMgQXNFbnRpdHk8VD47XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgZW50aXR5IGhhcyBwaHlzaWNzIGJvZHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc1BoeXNpY3MoZW50aXR5OiBhbnkpOiBib29sZWFuIHtcbiAgaWYgKCFlbnRpdHkubW94aUVudGl0eSkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gZW50aXR5Lm1veGlFbnRpdHkuZ2V0TG9naWMoJ1BoeXNpY3NCb2R5TG9naWMnKSAhPT0gdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIEdldCBwaHlzaWNzIGJvZHkgbG9naWMgZnJvbSBlbnRpdHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBoeXNpY3NCb2R5KGVudGl0eTogYW55KTogUGh5c2ljc0JvZHlMb2dpYyB8IHVuZGVmaW5lZCB7XG4gIGlmICghZW50aXR5Lm1veGlFbnRpdHkpIHJldHVybiB1bmRlZmluZWQ7XG4gIHJldHVybiBlbnRpdHkubW94aUVudGl0eS5nZXRMb2dpYygnUGh5c2ljc0JvZHlMb2dpYycpIGFzIFBoeXNpY3NCb2R5TG9naWMgfCB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogU2hhcGUgY3JlYXRpb24gZnJvbSBzcHJpdGUgYm91bmRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTaGFwZUZyb21TcHJpdGUoXG4gIHNwcml0ZTogUElYSS5TcHJpdGUsXG4gIHR5cGU6ICdyZWN0YW5nbGUnIHwgJ2NpcmNsZScgfCAnYXV0bycgPSAnYXV0bydcbik6IFNoYXBlQ29uZmlnIHtcbiAgY29uc3QgYm91bmRzID0gc3ByaXRlLmdldExvY2FsQm91bmRzKCk7XG5cbiAgaWYgKHR5cGUgPT09ICdhdXRvJykge1xuICAgIC8vIENoZWNrIGlmIHJvdWdobHkgc3F1YXJlIC0+IGNpcmNsZSwgZWxzZSByZWN0YW5nbGVcbiAgICBjb25zdCByYXRpbyA9IGJvdW5kcy53aWR0aCAvIGJvdW5kcy5oZWlnaHQ7XG4gICAgdHlwZSA9IChyYXRpbyA+IDAuOCAmJiByYXRpbyA8IDEuMikgPyAnY2lyY2xlJyA6ICdyZWN0YW5nbGUnO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09ICdjaXJjbGUnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNoYXBlOiAnY2lyY2xlJyxcbiAgICAgIHJhZGl1czogTWF0aC5tYXgoYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0KSAvIDJcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB7XG4gICAgICBzaGFwZTogJ3JlY3RhbmdsZScsXG4gICAgICB3aWR0aDogYm91bmRzLndpZHRoLFxuICAgICAgaGVpZ2h0OiBib3VuZHMuaGVpZ2h0XG4gICAgfTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCAqIGFzIHBsYW5jayBmcm9tICdwbGFuY2snO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzV29ybGRPcHRpb25zLCBSYXljYXN0Q2FsbGJhY2ssIFBoeXNpY3NEZWJ1Z09wdGlvbnMgfSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuaW1wb3J0IHsgQ29sbGlzaW9uUmVnaXN0cnksIENvbGxpc2lvbk1hbmFnZXIgfSBmcm9tICcuL3BoeXNpY3MtY29sbGlzaW9uJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc0JvZHlMb2dpYyB9IGZyb20gJy4vcGh5c2ljcy1ib2R5LWxvZ2ljJztcbmltcG9ydCB7IFBoeXNpY3NEZWJ1Z1JlbmRlcmVyIH0gZnJvbSAnLi9waHlzaWNzLWRlYnVnLXJlbmRlcmVyJztcbmltcG9ydCB7IGFzRW50aXR5IH0gZnJvbSAnLi4vLi4vY29yZS9tb3hpLWVudGl0eSc7XG5pbXBvcnQgeyBpbml0R3JhcGhpY3NQaHlzaWNzVHJhY2tpbmcgfSBmcm9tICcuL3BoeXNpY3MtZ3JhcGhpY3MtcGFyc2VyJztcblxuLyoqXG4gKiBQbGFuY2suanMgcGh5c2ljcyBzaW11bGF0aW9uIG1hbmFnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiAvLyBWaWEgc2V0dXBNb3hpIChyZWNvbW1lbmRlZClcbiAqIGNvbnN0IHsgcGh5c2ljc1dvcmxkIH0gPSBhd2FpdCBzZXR1cE1veGkoeyBwaHlzaWNzOiB0cnVlIH0pO1xuICpcbiAqIC8vIE9yIG1hbnVhbGx5XG4gKiBjb25zdCBwaHlzaWNzV29ybGQgPSBuZXcgUGh5c2ljc1dvcmxkKHsgZ3Jhdml0eTogeyB4OiAwLCB5OiA5LjggfSB9KTtcbiAqIGVuZ2luZS5hZGRQaHlzaWNzV29ybGQocGh5c2ljc1dvcmxkKTtcbiAqXG4gKiAvLyBDb2xsaXNpb24gY2FsbGJhY2tzXG4gKiBwaHlzaWNzV29ybGQub25Db2xsaXNpb24oJ3BsYXllcicsICdlbmVteScsIChlKSA9PiBjb25zb2xlLmxvZygnaGl0IScpKTtcbiAqXG4gKiAvLyBEZWJ1ZyB2aXN1YWxpemF0aW9uXG4gKiBwaHlzaWNzV29ybGQuZW5hYmxlRGVidWdSZW5kZXJlcihzY2VuZSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFBoeXNpY3NXb3JsZCB7XG4gIC8qKiBQbGFuY2suanMgd29ybGQuICovXG4gIHB1YmxpYyB3b3JsZDogcGxhbmNrLldvcmxkO1xuXG4gIC8qKiBDb252ZXJzaW9uIGZhY3Rvci4gRGVmYXVsdCAzMC4gKi9cbiAgcHVibGljIHBpeGVsc1Blck1ldGVyOiBudW1iZXIgPSAzMDtcblxuICAvKiogRml4ZWQgdGltZXN0ZXAgKHNlY29uZHMpLiBEZWZhdWx0IDEvNjAuICovXG4gIHB1YmxpYyB0aW1lc3RlcDogbnVtYmVyID0gMS82MDtcblxuICAvKiogQ29sbGlzaW9uIHRhZyByZWdpc3RyeSBmb3IgdGFnLXRvLWJpdG1hc2sgY29udmVyc2lvbi4gKi9cbiAgcHVibGljIGNvbGxpc2lvblJlZ2lzdHJ5OiBDb2xsaXNpb25SZWdpc3RyeTtcblxuICAvKiogSGFuZGxlcyBjb2xsaXNpb24gY2FsbGJhY2tzIGJldHdlZW4gdGFncy4gKi9cbiAgcHVibGljIGNvbGxpc2lvbk1hbmFnZXI6IENvbGxpc2lvbk1hbmFnZXI7XG5cbiAgcHJpdmF0ZSB2ZWxvY2l0eUl0ZXJhdGlvbnM6IG51bWJlciA9IDg7XG4gIHByaXZhdGUgcG9zaXRpb25JdGVyYXRpb25zOiBudW1iZXIgPSAzO1xuICBwcml2YXRlIGFjY3VtdWxhdG9yOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGJvZGllczogTWFwPHBsYW5jay5Cb2R5LCBQaHlzaWNzQm9keUxvZ2ljPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBkZWJ1Z1JlbmRlcmVyPzogUGh5c2ljc0RlYnVnUmVuZGVyZXI7XG4gIHByaXZhdGUgZGVidWdHcmFwaGljcz86IFBJWEkuR3JhcGhpY3M7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogUGh5c2ljc1dvcmxkT3B0aW9ucyA9IHt9KSB7XG4gICAgLy8gSW5pdGlhbGl6ZSBHcmFwaGljcyBwaHlzaWNzIHRyYWNraW5nIChwYXRjaGVzIFBJWEkuR3JhcGhpY3MgbWV0aG9kcylcbiAgICBpbml0R3JhcGhpY3NQaHlzaWNzVHJhY2tpbmcoKTtcblxuICAgIGNvbnN0IHtcbiAgICAgIGdyYXZpdHkgPSB7IHg6IDAsIHk6IDkuOCB9LFxuICAgICAgcGl4ZWxzUGVyTWV0ZXIgPSAzMCxcbiAgICAgIHZlbG9jaXR5SXRlcmF0aW9ucyA9IDgsXG4gICAgICBwb3NpdGlvbkl0ZXJhdGlvbnMgPSAzLFxuICAgICAgZW5hYmxlU2xlZXBpbmcgPSB0cnVlLFxuICAgICAgdGltZXN0ZXAgPSAxLzYwXG4gICAgfSA9IG9wdGlvbnM7XG5cbiAgICB0aGlzLnBpeGVsc1Blck1ldGVyID0gcGl4ZWxzUGVyTWV0ZXI7XG4gICAgdGhpcy52ZWxvY2l0eUl0ZXJhdGlvbnMgPSB2ZWxvY2l0eUl0ZXJhdGlvbnM7XG4gICAgdGhpcy5wb3NpdGlvbkl0ZXJhdGlvbnMgPSBwb3NpdGlvbkl0ZXJhdGlvbnM7XG4gICAgdGhpcy50aW1lc3RlcCA9IHRpbWVzdGVwO1xuXG4gICAgLy8gQ3JlYXRlIFBsYW5jayB3b3JsZFxuICAgIHRoaXMud29ybGQgPSBwbGFuY2suV29ybGQoe1xuICAgICAgZ3Jhdml0eTogcGxhbmNrLlZlYzIoZ3Jhdml0eS54LCBncmF2aXR5LnkpXG4gICAgfSk7XG5cbiAgICAvLyBDb25maWd1cmUgc2xlZXBpbmdcbiAgICB0aGlzLndvcmxkLnNldEFsbG93U2xlZXBpbmcoZW5hYmxlU2xlZXBpbmcpO1xuXG4gICAgLy8gSW5pdGlhbGl6ZSBjb2xsaXNpb24gc3lzdGVtXG4gICAgdGhpcy5jb2xsaXNpb25SZWdpc3RyeSA9IG5ldyBDb2xsaXNpb25SZWdpc3RyeSgpO1xuICAgIHRoaXMuY29sbGlzaW9uTWFuYWdlciA9IG5ldyBDb2xsaXNpb25NYW5hZ2VyKHRoaXMsIHRoaXMuY29sbGlzaW9uUmVnaXN0cnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0ZXAgdGhlIHBoeXNpY3Mgc2ltdWxhdGlvbiAoY2FsbGVkIGJ5IEVuZ2luZSB1cGRhdGUgbG9vcClcbiAgICogVXNlcyBmaXhlZCB0aW1lc3RlcCBmb3IgZGV0ZXJtaW5pc3RpYyBwaHlzaWNzXG4gICAqL1xuICBzdGVwKGRlbHRhVGltZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5hY2N1bXVsYXRvciArPSBkZWx0YVRpbWU7XG5cbiAgICAvLyBGaXhlZCB0aW1lc3RlcCB1cGRhdGVzXG4gICAgd2hpbGUgKHRoaXMuYWNjdW11bGF0b3IgPj0gdGhpcy50aW1lc3RlcCkge1xuICAgICAgdGhpcy53b3JsZC5zdGVwKHRoaXMudGltZXN0ZXAsIHRoaXMudmVsb2NpdHlJdGVyYXRpb25zLCB0aGlzLnBvc2l0aW9uSXRlcmF0aW9ucyk7XG4gICAgICB0aGlzLmFjY3VtdWxhdG9yIC09IHRoaXMudGltZXN0ZXA7XG4gICAgfVxuXG4gICAgLy8gTm90ZTogSW50ZXJwb2xhdGlvbiBmb3IgcmVuZGVyaW5nIHNtb290aG5lc3MgY291bGQgYmUgYWRkZWQgaGVyZVxuICAgIC8vIGNvbnN0IGFscGhhID0gdGhpcy5hY2N1bXVsYXRvciAvIHRoaXMudGltZXN0ZXA7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGEgcGh5c2ljcyBib2R5XG4gICAqL1xuICBjcmVhdGVCb2R5KGRlZjogcGxhbmNrLkJvZHlEZWYpOiBwbGFuY2suQm9keSB7XG4gICAgcmV0dXJuIHRoaXMud29ybGQuY3JlYXRlQm9keShkZWYpO1xuICB9XG5cbiAgLyoqXG4gICAqIERlc3Ryb3kgYSBwaHlzaWNzIGJvZHlcbiAgICovXG4gIGRlc3Ryb3lCb2R5KGJvZHk6IHBsYW5jay5Cb2R5KTogdm9pZCB7XG4gICAgdGhpcy5ib2RpZXMuZGVsZXRlKGJvZHkpO1xuICAgIHRoaXMud29ybGQuZGVzdHJveUJvZHkoYm9keSk7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgYSBwaHlzaWNzIGJvZHkgbG9naWMgY29tcG9uZW50XG4gICAqL1xuICByZWdpc3RlckJvZHkoYm9keTogcGxhbmNrLkJvZHksIGxvZ2ljOiBQaHlzaWNzQm9keUxvZ2ljKTogdm9pZCB7XG4gICAgdGhpcy5ib2RpZXMuc2V0KGJvZHksIGxvZ2ljKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcGh5c2ljcyBib2R5IGxvZ2ljIGZyb20gUGxhbmNrIGJvZHlcbiAgICovXG4gIGdldEJvZHlMb2dpYyhib2R5OiBwbGFuY2suQm9keSk6IFBoeXNpY3NCb2R5TG9naWMgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmJvZGllcy5nZXQoYm9keSk7XG4gIH1cblxuICAvKipcbiAgICogUmF5Y2FzdCBmcm9tIG9uZSBwb2ludCB0byBhbm90aGVyXG4gICAqL1xuICByYXljYXN0KGZyb206IFBJWEkuUG9pbnQsIHRvOiBQSVhJLlBvaW50LCBjYWxsYmFjazogUmF5Y2FzdENhbGxiYWNrKTogdm9pZCB7XG4gICAgY29uc3QgcDEgPSB0aGlzLnRvUGh5c2ljc1BvaW50KGZyb20pO1xuICAgIGNvbnN0IHAyID0gdGhpcy50b1BoeXNpY3NQb2ludCh0byk7XG5cbiAgICB0aGlzLndvcmxkLnJheUNhc3QocDEsIHAyLCAoZml4dHVyZSwgcG9pbnQsIG5vcm1hbCwgZnJhY3Rpb24pID0+IHtcbiAgICAgIGNvbnN0IHBpeGVsUG9pbnQgPSB0aGlzLnRvUGl4ZWxzUG9pbnQocG9pbnQpO1xuICAgICAgY29uc3QgcGl4ZWxOb3JtYWwgPSBuZXcgUElYSS5Qb2ludChub3JtYWwueCwgbm9ybWFsLnkpO1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKGZpeHR1cmUsIHBpeGVsUG9pbnQsIHBpeGVsTm9ybWFsLCBmcmFjdGlvbik7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUXVlcnkgQUFCQiAoYXhpcy1hbGlnbmVkIGJvdW5kaW5nIGJveClcbiAgICovXG4gIHF1ZXJ5QUFCQihib3VuZHM6IFBJWEkuUmVjdGFuZ2xlLCBjYWxsYmFjazogKGJvZHk6IHBsYW5jay5Cb2R5KSA9PiBib29sZWFuKTogdm9pZCB7XG4gICAgY29uc3QgbG93ZXJCb3VuZCA9IHRoaXMudG9QaHlzaWNzUG9pbnQobmV3IFBJWEkuUG9pbnQoYm91bmRzLngsIGJvdW5kcy55KSk7XG4gICAgY29uc3QgdXBwZXJCb3VuZCA9IHRoaXMudG9QaHlzaWNzUG9pbnQobmV3IFBJWEkuUG9pbnQoYm91bmRzLnggKyBib3VuZHMud2lkdGgsIGJvdW5kcy55ICsgYm91bmRzLmhlaWdodCkpO1xuXG4gICAgdGhpcy53b3JsZC5xdWVyeUFBQkIocGxhbmNrLkFBQkIobG93ZXJCb3VuZCwgdXBwZXJCb3VuZCksIChmaXh0dXJlKSA9PiB7XG4gICAgICByZXR1cm4gY2FsbGJhY2soZml4dHVyZS5nZXRCb2R5KCkpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFF1ZXJ5IHBvaW50XG4gICAqL1xuICBxdWVyeVBvaW50KHBvaW50OiBQSVhJLlBvaW50LCBjYWxsYmFjazogKGZpeHR1cmU6IHBsYW5jay5GaXh0dXJlKSA9PiBib29sZWFuKTogdm9pZCB7XG4gICAgY29uc3QgcGh5c2ljc1BvaW50ID0gdGhpcy50b1BoeXNpY3NQb2ludChwb2ludCk7XG5cbiAgICB0aGlzLndvcmxkLnF1ZXJ5QUFCQihcbiAgICAgIHBsYW5jay5BQUJCKFxuICAgICAgICBwbGFuY2suVmVjMihwaHlzaWNzUG9pbnQueCAtIDAuMDAxLCBwaHlzaWNzUG9pbnQueSAtIDAuMDAxKSxcbiAgICAgICAgcGxhbmNrLlZlYzIocGh5c2ljc1BvaW50LnggKyAwLjAwMSwgcGh5c2ljc1BvaW50LnkgKyAwLjAwMSlcbiAgICAgICksXG4gICAgICAoZml4dHVyZSkgPT4ge1xuICAgICAgICBpZiAoZml4dHVyZS50ZXN0UG9pbnQocGh5c2ljc1BvaW50KSkge1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjayhmaXh0dXJlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgcGl4ZWxzIHRvIG1ldGVyc1xuICAgKi9cbiAgdG9QaHlzaWNzKHBpeGVsczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gcGl4ZWxzIC8gdGhpcy5waXhlbHNQZXJNZXRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IG1ldGVycyB0byBwaXhlbHNcbiAgICovXG4gIHRvUGl4ZWxzKG1ldGVyczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gbWV0ZXJzICogdGhpcy5waXhlbHNQZXJNZXRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IFBJWEkgUG9pbnQgKHBpeGVscykgdG8gUGxhbmNrIFZlYzIgKG1ldGVycylcbiAgICovXG4gIHRvUGh5c2ljc1BvaW50KHBvaW50OiBQSVhJLlBvaW50KTogcGxhbmNrLlZlYzIge1xuICAgIHJldHVybiBwbGFuY2suVmVjMih0aGlzLnRvUGh5c2ljcyhwb2ludC54KSwgdGhpcy50b1BoeXNpY3MocG9pbnQueSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgUGxhbmNrIFZlYzIgKG1ldGVycykgdG8gUElYSSBQb2ludCAocGl4ZWxzKVxuICAgKi9cbiAgdG9QaXhlbHNQb2ludCh2ZWM6IHBsYW5jay5WZWMyKTogUElYSS5Qb2ludCB7XG4gICAgcmV0dXJuIG5ldyBQSVhJLlBvaW50KHRoaXMudG9QaXhlbHModmVjLngpLCB0aGlzLnRvUGl4ZWxzKHZlYy55KSk7XG4gIH1cblxuICAvKipcbiAgICogRW5hYmxlIGRlYnVnIHJlbmRlcmVyXG4gICAqL1xuICBlbmFibGVEZWJ1Z1JlbmRlcmVyKHNjZW5lOiBQSVhJLkNvbnRhaW5lciwgb3B0aW9uczogUGh5c2ljc0RlYnVnT3B0aW9ucyA9IHt9KTogUGh5c2ljc0RlYnVnUmVuZGVyZXIge1xuICAgIC8vIENsZWFuIHVwIGV4aXN0aW5nIGRlYnVnIHJlbmRlcmVyIGlmIGFueVxuICAgIGlmICh0aGlzLmRlYnVnUmVuZGVyZXIpIHtcbiAgICAgIHRoaXMuZGlzYWJsZURlYnVnUmVuZGVyZXIoKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgZGVidWcgZ3JhcGhpY3NcbiAgICB0aGlzLmRlYnVnR3JhcGhpY3MgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuXG4gICAgLy8gQ3JlYXRlIGRlYnVnIHJlbmRlcmVyIGxvZ2ljXG4gICAgdGhpcy5kZWJ1Z1JlbmRlcmVyID0gbmV3IFBoeXNpY3NEZWJ1Z1JlbmRlcmVyKHRoaXMsIG9wdGlvbnMpO1xuXG4gICAgLy8gTWFrZSBpdCBhbiBlbnRpdHkgYW5kIGFkZCB0byBzY2VuZVxuICAgIGNvbnN0IGRlYnVnRW50aXR5ID0gYXNFbnRpdHkodGhpcy5kZWJ1Z0dyYXBoaWNzKTtcbiAgICBkZWJ1Z0VudGl0eS5tb3hpRW50aXR5LmFkZExvZ2ljKHRoaXMuZGVidWdSZW5kZXJlcik7XG5cbiAgICAvLyBTZXQgaGlnaGVzdCB6LWluZGV4IHNvIGl0IHJlbmRlcnMgb24gdG9wIG9mIGV2ZXJ5dGhpbmdcbiAgICBkZWJ1Z0VudGl0eS56SW5kZXggPSAxMDAwMDtcblxuICAgIC8vIEVuYWJsZSBzb3J0YWJsZSBjaGlsZHJlbiBvbiBzY2VuZSBzbyB6SW5kZXggd29ya3NcbiAgICBzY2VuZS5zb3J0YWJsZUNoaWxkcmVuID0gdHJ1ZTtcblxuICAgIC8vIEFkZCB0byBzY2VuZSBhdCBoaWdoZXN0IHotaW5kZXggc28gaXQgcmVuZGVycyBvbiB0b3BcbiAgICBzY2VuZS5hZGRDaGlsZChkZWJ1Z0VudGl0eSk7XG5cbiAgICBjb25zb2xlLmxvZygnUGh5c2ljcyBkZWJ1ZyByZW5kZXJlciBlbmFibGVkLiBQcmVzcyBcIlBcIiB0byB0b2dnbGUgdmlzaWJpbGl0eS4nKTtcblxuICAgIHJldHVybiB0aGlzLmRlYnVnUmVuZGVyZXI7XG4gIH1cblxuICAvKipcbiAgICogRGlzYWJsZSBkZWJ1ZyByZW5kZXJlclxuICAgKi9cbiAgZGlzYWJsZURlYnVnUmVuZGVyZXIoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZGVidWdSZW5kZXJlciAmJiB0aGlzLmRlYnVnR3JhcGhpY3MpIHtcbiAgICAgIC8vIFJlbW92ZSBmcm9tIHNjZW5lXG4gICAgICBpZiAodGhpcy5kZWJ1Z0dyYXBoaWNzLnBhcmVudCkge1xuICAgICAgICB0aGlzLmRlYnVnR3JhcGhpY3MucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMuZGVidWdHcmFwaGljcyk7XG4gICAgICB9XG5cbiAgICAgIC8vIENsZWFuIHVwXG4gICAgICB0aGlzLmRlYnVnR3JhcGhpY3MuZGVzdHJveSgpO1xuICAgICAgdGhpcy5kZWJ1Z0dyYXBoaWNzID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5kZWJ1Z1JlbmRlcmVyID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZGVidWcgcmVuZGVyZXIgaWYgZW5hYmxlZFxuICAgKi9cbiAgZ2V0RGVidWdSZW5kZXJlcigpOiBQaHlzaWNzRGVidWdSZW5kZXJlciB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuZGVidWdSZW5kZXJlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIGJvZGllcyBpbiB0aGUgd29ybGRcbiAgICovXG4gIGdldEJvZGllcygpOiBwbGFuY2suQm9keVtdIHtcbiAgICBjb25zdCBib2RpZXM6IHBsYW5jay5Cb2R5W10gPSBbXTtcbiAgICBmb3IgKGxldCBib2R5ID0gdGhpcy53b3JsZC5nZXRCb2R5TGlzdCgpOyBib2R5OyBib2R5ID0gYm9keS5nZXROZXh0KCkpIHtcbiAgICAgIGJvZGllcy5wdXNoKGJvZHkpO1xuICAgIH1cbiAgICByZXR1cm4gYm9kaWVzO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFuIHVwIGFuZCBkZXN0cm95IHRoZSBwaHlzaWNzIHdvcmxkXG4gICAqL1xuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIC8vIERlc3Ryb3kgYWxsIGJvZGllc1xuICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuZ2V0Qm9kaWVzKCk7XG4gICAgYm9kaWVzLmZvckVhY2goYm9keSA9PiB0aGlzLndvcmxkLmRlc3Ryb3lCb2R5KGJvZHkpKTtcblxuICAgIHRoaXMuYm9kaWVzLmNsZWFyKCk7XG4gICAgdGhpcy5kZWJ1Z1JlbmRlcmVyID0gdW5kZWZpbmVkO1xuICB9XG59XG4iLCIvKipcbiAqIE9wdGlvbnMgZm9yIGNvbmZpZ3VyaW5nIHRoZSByZXNpemUgaGFuZGxlclxuICovXG5leHBvcnQgaW50ZXJmYWNlIFJlc2l6ZUhhbmRsZXJPcHRpb25zIHtcbiAgLyoqIFJvb3QgZWxlbWVudCBjb250YWluaW5nIHRoZSBjYW52YXMgKi9cbiAgcm9vdEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuICAvKiogVGhlIGRlc2lyZWQgd2lkdGggb2YgdGhlIGdhbWUgdmlld3BvcnQgKi9cbiAgd2lkdGg6IG51bWJlcjtcbiAgLyoqIFRoZSBkZXNpcmVkIGhlaWdodCBvZiB0aGUgZ2FtZSB2aWV3cG9ydCAqL1xuICBoZWlnaHQ6IG51bWJlcjtcbiAgLyoqIE9wdGlvbmFsIENTUyBwcm9wZXJ0aWVzIHRvIGFwcGx5IHRvIHRoZSByb290IGVsZW1lbnQgKi9cbiAgcm9vdFN0eWxlcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gIC8qKiBPcHRpb25hbCBDU1MgcHJvcGVydGllcyB0byBhcHBseSB0byB0aGUgY2FudmFzIGVsZW1lbnQgKi9cbiAgY2FudmFzU3R5bGVzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgLyoqIFdoZXRoZXIgdG8gdXNlIHBpeGVsIGFydCBvcHRpbWl6ZWQgcmVuZGVyaW5nICovXG4gIHBpeGVsQXJ0TW9kZT86IGJvb2xlYW47XG59XG5cbi8qKlxuICogRGVmYXVsdCBzdHlsZXMgYXBwbGllZCB0byB0aGUgcm9vdCBlbGVtZW50XG4gKi9cbmNvbnN0IERFRkFVTFRfUk9PVF9TVFlMRVM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gIGRpc3BsYXk6ICdmbGV4JyxcbiAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLFxuICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgb3ZlcmZsb3c6ICdoaWRkZW4nXG59O1xuXG4vKipcbiAqIERlZmF1bHQgc3R5bGVzIGFwcGxpZWQgdG8gdGhlIGNhbnZhcyBlbGVtZW50IGluIHBpeGVsIGFydCBtb2RlXG4gKi9cbmNvbnN0IFBJWEVMX0FSVF9DQU5WQVNfU1RZTEVTOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICBpbWFnZVJlbmRlcmluZzogJ3BpeGVsYXRlZCdcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIHJlc2l6ZSBoYW5kbGVyIGZ1bmN0aW9uIHRoYXQgbWFpbnRhaW5zIHRoZSBhc3BlY3QgcmF0aW8gb2YgYSBjYW52YXNcbiAqIGFuZCBjZW50ZXJzIGl0IHdpdGhpbiBpdHMgcGFyZW50IGVsZW1lbnQuXG4gKiBcbiAqIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgcmVzaXplIGhhbmRsZXJcbiAqIEByZXR1cm5zIEEgZnVuY3Rpb24gdGhhdCBjYW4gYmUgY2FsbGVkIHRvIGhhbmRsZSByZXNpemUgZXZlbnRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZXNpemVIYW5kbGVyKG9wdGlvbnM6IFJlc2l6ZUhhbmRsZXJPcHRpb25zKTogKCkgPT4gdm9pZCB7XG4gIGNvbnN0IHtcbiAgICByb290RWxlbWVudCxcbiAgICB3aWR0aCxcbiAgICBoZWlnaHQsXG4gICAgcm9vdFN0eWxlcyA9IERFRkFVTFRfUk9PVF9TVFlMRVMsXG4gICAgY2FudmFzU3R5bGVzID0ge30sXG4gICAgcGl4ZWxBcnRNb2RlID0gZmFsc2VcbiAgfSA9IG9wdGlvbnM7XG5cbiAgLy8gQXBwbHkgcm9vdCBlbGVtZW50IHN0eWxlc1xuICBPYmplY3QuZW50cmllcyhyb290U3R5bGVzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICByb290RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbHVlKTtcbiAgfSk7XG5cbiAgLy8gQ29tYmluZSBkZWZhdWx0IGNhbnZhcyBzdHlsZXMgd2l0aCB1c2VyLXByb3ZpZGVkIG9uZXNcbiAgY29uc3QgZmluYWxDYW52YXNTdHlsZXMgPSBwaXhlbEFydE1vZGVcbiAgICA/IHsgLi4uUElYRUxfQVJUX0NBTlZBU19TVFlMRVMsIC4uLmNhbnZhc1N0eWxlcyB9XG4gICAgOiBjYW52YXNTdHlsZXM7XG5cbiAgcmV0dXJuICgpID0+IHtcbiAgICAvLyBHZXQgdGhlIHBhcmVudCBkaW1lbnNpb25zXG4gICAgY29uc3QgcGFyZW50V2lkdGggPSByb290RWxlbWVudC5jbGllbnRXaWR0aDtcbiAgICBjb25zdCBwYXJlbnRIZWlnaHQgPSByb290RWxlbWVudC5jbGllbnRIZWlnaHQ7XG5cbiAgICAvLyBNYWludGFpbiBhc3BlY3QgcmF0aW9cbiAgICBjb25zdCByYXRpbyA9IE1hdGgubWluKFxuICAgICAgcGFyZW50V2lkdGggLyB3aWR0aCxcbiAgICAgIHBhcmVudEhlaWdodCAvIGhlaWdodFxuICAgICk7XG5cbiAgICAvLyBVcGRhdGUgdGhlIGNhbnZhcyBlbGVtZW50IGlmIGl0IGV4aXN0c1xuICAgIGlmIChyb290RWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50KSB7XG4gICAgICBjb25zdCBjYW52YXMgPSByb290RWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICAgIFxuICAgICAgLy8gU2V0IGRpbWVuc2lvbnMgd2hpbGUgbWFpbnRhaW5pbmcgYXNwZWN0IHJhdGlvXG4gICAgICBjYW52YXMuc3R5bGUud2lkdGggPSBgJHtNYXRoLnJvdW5kKHdpZHRoICogcmF0aW8pfXB4YDtcbiAgICAgIGNhbnZhcy5zdHlsZS5oZWlnaHQgPSBgJHtNYXRoLnJvdW5kKGhlaWdodCAqIHJhdGlvKX1weGA7XG4gICAgICBjYW52YXMuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICBcbiAgICAgIC8vIEFwcGx5IGN1c3RvbSBjYW52YXMgc3R5bGVzXG4gICAgICBPYmplY3QuZW50cmllcyhmaW5hbENhbnZhc1N0eWxlcykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIGNhbnZhcy5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cblxuLyoqXG4gKiBTZXRzIHVwIHJlc3BvbnNpdmUgcmVzaXppbmcgZm9yIGEgUElYSSBjYW52YXMgYXBwbGljYXRpb25cbiAqIFxuICogQHBhcmFtIG9wdGlvbnMgLSBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSByZXNpemUgaGFuZGxlclxuICogQHJldHVybnMgQSBjbGVhbnVwIGZ1bmN0aW9uIHRvIHJlbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldHVwUmVzcG9uc2l2ZUNhbnZhcyhvcHRpb25zOiBSZXNpemVIYW5kbGVyT3B0aW9ucyk6ICgpID0+IHZvaWQge1xuICBjb25zdCByZXNpemVIYW5kbGVyID0gY3JlYXRlUmVzaXplSGFuZGxlcihvcHRpb25zKTtcbiAgXG4gIC8vIEluaXRpYWwgcmVzaXplXG4gIHJlc2l6ZUhhbmRsZXIoKTtcbiAgXG4gIC8vIEFkZCBldmVudCBsaXN0ZW5lclxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcmVzaXplSGFuZGxlcik7XG4gIFxuICAvLyBSZXR1cm4gY2xlYW51cCBmdW5jdGlvblxuICByZXR1cm4gKCkgPT4ge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVIYW5kbGVyKTtcbiAgfTtcbn0gIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBBc3NldExvYWRlciB9IGZyb20gJy4uL2NvcmUvYXNzZXQtbG9hZGVyJztcbmltcG9ydCB7IENhbWVyYSB9IGZyb20gJy4uL2NvcmUvY2FtZXJhJztcbmltcG9ydCB7IEVuZ2luZSB9IGZyb20gJy4uL2NvcmUvZW5naW5lJztcbmltcG9ydCB7IFJlbmRlck1hbmFnZXIgfSBmcm9tICcuLi9jb3JlL3JlbmRlci1tYW5hZ2VyJztcbmltcG9ydCB7IFNjZW5lIH0gZnJvbSAnLi4vY29yZS9zY2VuZSc7XG5pbXBvcnQgeyBQaHlzaWNzV29ybGQsIHR5cGUgUGh5c2ljc1dvcmxkT3B0aW9ucyB9IGZyb20gJy4vcGh5c2ljcyc7XG5pbXBvcnQgeyBMb2FkaW5nU2NlbmUsIHR5cGUgTG9hZGluZ1NjZW5lT3B0aW9ucyB9IGZyb20gJy4vbG9hZGluZy1zY2VuZSc7XG5cbi8qKiBPcHRpb25zIGZvciBwaXhlbC1wZXJmZWN0IHJlbmRlcmluZyAocGl4ZWwgYXJ0IGdhbWVzKS4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUGl4ZWxQZXJmZWN0T3B0aW9ucyB7XG4gIC8qKiBFbmFibGUgcmVzb2x1dGlvbjoxLCBhbnRpYWxpYXM6ZmFsc2UsIHJvdW5kUGl4ZWxzOnRydWUuIERlZmF1bHQgdHJ1ZS4gKi9cbiAgZW5hYmxlZD86IGJvb2xlYW47XG4gIC8qKiBBcHBseSBDU1MgaW1hZ2VSZW5kZXJpbmc6cGl4ZWxhdGVkIHRvIGNhbnZhcy4gRGVmYXVsdCB0cnVlLiAqL1xuICBpbWFnZVJlbmRlcmluZz86IGJvb2xlYW47XG59XG5cbi8qKiBDb25maWd1cmF0aW9uIGZvciBzZXR1cE1veGkoKS4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU2V0dXBNb3hpQXJncyB7XG4gIC8qKiBDb250YWluZXIgZWxlbWVudCB0byBhdHRhY2ggdGhlIGNhbnZhcy4gKi9cbiAgaG9zdEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuICAvKiogUElYSSByZW5kZXIgb3B0aW9ucyAod2lkdGgsIGhlaWdodCwgYmFja2dyb3VuZENvbG9yLCBldGMpLiAqL1xuICByZW5kZXJPcHRpb25zPzogUGFydGlhbDxQSVhJLkF1dG9EZXRlY3RPcHRpb25zPjtcbiAgLyoqIEJhY2tncm91bmQgY29sb3IgKGhleCBudW1iZXIgbGlrZSAweDFhMWEyZSkuIENvbnZlbmllbmNlIG9wdGlvbi4gKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogRW5hYmxlIHBoeXNpY3MuIFBhc3MgdHJ1ZSBmb3IgZGVmYXVsdHMgb3IgUGh5c2ljc1dvcmxkT3B0aW9ucy4gKi9cbiAgcGh5c2ljcz86IFBoeXNpY3NXb3JsZE9wdGlvbnMgfCBib29sZWFuO1xuICAvKiogU2hvdyBsb2FkaW5nIG92ZXJsYXkgZHVyaW5nIGFzc2V0IGxvYWRpbmcuICovXG4gIHNob3dMb2FkaW5nU2NlbmU/OiBib29sZWFuO1xuICAvKiogQ3VzdG9taXplIGxvYWRpbmcgc2NlbmUgYXBwZWFyYW5jZS4gKi9cbiAgbG9hZGluZ1NjZW5lT3B0aW9ucz86IExvYWRpbmdTY2VuZU9wdGlvbnM7XG4gIC8qKiBFbmFibGUgcGl4ZWwtcGVyZmVjdCByZW5kZXJpbmcuIFBhc3MgdHJ1ZSBmb3IgZGVmYXVsdHMuICovXG4gIHBpeGVsUGVyZmVjdD86IGJvb2xlYW4gfCBQaXhlbFBlcmZlY3RPcHRpb25zO1xufVxuXG4vKiogUmV0dXJuIHZhbHVlIGZyb20gc2V0dXBNb3hpKCkuICovXG5leHBvcnQgaW50ZXJmYWNlIFNldHVwTW94aVJlc3VsdCB7XG4gIHNjZW5lOiBTY2VuZTtcbiAgZW5naW5lOiBFbmdpbmU7XG4gIFBJWElBc3NldHM6IEFzc2V0TG9hZGVyWydQSVhJQXNzZXRzJ107XG4gIHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyO1xuICBsb2FkQXNzZXRzOiBBc3NldExvYWRlclsnbG9hZEFzc2V0cyddO1xuICBjYW1lcmE6IENhbWVyYTtcbiAgcGh5c2ljc1dvcmxkPzogUGh5c2ljc1dvcmxkO1xuICBsb2FkaW5nU2NlbmU/OiBMb2FkaW5nU2NlbmU7XG59XG5cbi8qKiBEZWZhdWx0IFBJWEkgcmVuZGVyIG9wdGlvbnMuICovXG5leHBvcnQgY29uc3QgZGVmYXVsdFJlbmRlck9wdGlvbnMgPSB7XG4gIHdpZHRoOiAxMjgwLFxuICBoZWlnaHQ6IDcyMCxcbiAgYmFja2dyb3VuZENvbG9yOiAweDEwOTliYixcbiAgcmVzb2x1dGlvbjogd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMSxcbiAgYXV0b0RlbnNpdHk6IHRydWUsXG4gIGFudGlhbGlhczogdHJ1ZVxufSBhcyBQYXJ0aWFsPFBJWEkuQXV0b0RldGVjdE9wdGlvbnM+O1xuXG4vKipcbiAqIEluaXRpYWxpemUgTW94aS4gTWFpbiBlbnRyeSBwb2ludC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIGNvbnN0IHsgc2NlbmUsIGVuZ2luZSwgbG9hZEFzc2V0cywgY2FtZXJhIH0gPSBhd2FpdCBzZXR1cE1veGkoe1xuICogICBob3N0RWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcCcpLFxuICogICByZW5kZXJPcHRpb25zOiB7IHdpZHRoOiAxMjgwLCBoZWlnaHQ6IDcyMCB9LFxuICogICBwaHlzaWNzOiB0cnVlLFxuICogICBwaXhlbFBlcmZlY3Q6IHRydWVcbiAqIH0pO1xuICpcbiAqIGF3YWl0IGxvYWRBc3NldHMoW3sgc3JjOiAnLi9zcHJpdGUucG5nJywgYWxpYXM6ICdzcHJpdGUnIH1dKTtcbiAqIHNjZW5lLmFkZENoaWxkKGFzRW50aXR5KG5ldyBQSVhJLlNwcml0ZShQSVhJQXNzZXRzLmdldCgnc3ByaXRlJykpKSk7XG4gKiBzY2VuZS5pbml0KCk7XG4gKiBlbmdpbmUuc3RhcnQoKTtcbiAqIGBgYFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0dXBNb3hpKHtcbiAgaG9zdEVsZW1lbnQsXG4gIHJlbmRlck9wdGlvbnMgPSBkZWZhdWx0UmVuZGVyT3B0aW9ucyxcbiAgYmFja2dyb3VuZENvbG9yLFxuICBwaHlzaWNzLFxuICBzaG93TG9hZGluZ1NjZW5lID0gZmFsc2UsXG4gIGxvYWRpbmdTY2VuZU9wdGlvbnMgPSB7fSxcbiAgcGl4ZWxQZXJmZWN0XG59ID0ge30gYXMgU2V0dXBNb3hpQXJncykge1xuICAvLyBQcm9jZXNzIHBpeGVsLXBlcmZlY3Qgb3B0aW9uc1xuICBsZXQgZmluYWxSZW5kZXJPcHRpb25zID0geyAuLi5yZW5kZXJPcHRpb25zIH07XG4gIGxldCBhcHBseUltYWdlUmVuZGVyaW5nID0gZmFsc2U7XG5cbiAgaWYgKHBpeGVsUGVyZmVjdCkge1xuICAgIGNvbnN0IHBwT3B0aW9ucyA9IHR5cGVvZiBwaXhlbFBlcmZlY3QgPT09ICdib29sZWFuJ1xuICAgICAgPyB7IGVuYWJsZWQ6IHRydWUsIGltYWdlUmVuZGVyaW5nOiB0cnVlIH1cbiAgICAgIDogcGl4ZWxQZXJmZWN0O1xuXG4gICAgaWYgKHBwT3B0aW9ucy5lbmFibGVkICE9PSBmYWxzZSkge1xuICAgICAgLy8gQXBwbHkgcGl4ZWwtcGVyZmVjdCByZW5kZXIgc2V0dGluZ3NcbiAgICAgIGZpbmFsUmVuZGVyT3B0aW9ucyA9IHtcbiAgICAgICAgLi4uZmluYWxSZW5kZXJPcHRpb25zLFxuICAgICAgICByZXNvbHV0aW9uOiAxLFxuICAgICAgICBhbnRpYWxpYXM6IGZhbHNlLFxuICAgICAgICByb3VuZFBpeGVsczogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBhcHBseUltYWdlUmVuZGVyaW5nID0gcHBPcHRpb25zLmltYWdlUmVuZGVyaW5nICE9PSBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IHsgcmVuZGVyZXIgfSA9IGF3YWl0IFJlbmRlck1hbmFnZXIuY3JlYXRlKGhvc3RFbGVtZW50LCBmaW5hbFJlbmRlck9wdGlvbnMpO1xuXG4gIC8vIEFwcGx5IGJhY2tncm91bmQgY29sb3IgaWYgc3BlY2lmaWVkXG4gIGlmIChiYWNrZ3JvdW5kQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgIHJlbmRlcmVyLmJhY2tncm91bmQuY29sb3IgPSBiYWNrZ3JvdW5kQ29sb3I7XG4gIH1cblxuICAvLyBBcHBseSBjYW52YXMgQ1NTIGZvciBwaXhlbC1wZXJmZWN0IHNjYWxpbmcgaWYgcmVxdWVzdGVkXG4gIGlmIChhcHBseUltYWdlUmVuZGVyaW5nKSB7XG4gICAgY29uc3QgY2FudmFzID0gcmVuZGVyZXIuY2FudmFzIGFzIEhUTUxDYW52YXNFbGVtZW50O1xuICAgIGNhbnZhcy5zdHlsZS5pbWFnZVJlbmRlcmluZyA9ICdwaXhlbGF0ZWQnO1xuICAgIGNhbnZhcy5zdHlsZS5pbWFnZVJlbmRlcmluZyA9ICctbW96LWNyaXNwLWVkZ2VzJztcbiAgICBjYW52YXMuc3R5bGUuaW1hZ2VSZW5kZXJpbmcgPSAnY3Jpc3AtZWRnZXMnO1xuICB9XG5cbiAgY29uc3Qgc2NlbmUgPSBuZXcgU2NlbmUocmVuZGVyZXIpO1xuICBjb25zdCBlbmdpbmUgPSBuZXcgRW5naW5lKHNjZW5lKTtcblxuICAvLyBHZXQgdGhlIEFzc2V0TG9hZGVyIGluc3RhbmNlXG4gIGNvbnN0IGFzc2V0TG9hZGVyID0gbmV3IEFzc2V0TG9hZGVyKCk7XG4gIGNvbnN0IHsgUElYSUFzc2V0cywgbG9hZEFzc2V0cyB9ID0gYXNzZXRMb2FkZXI7XG5cbiAgY29uc3QgY2FtZXJhID0gbmV3IENhbWVyYShzY2VuZSwgcmVuZGVyZXIpO1xuXG4gIC8vIFNldHVwIHBoeXNpY3MgaWYgcmVxdWVzdGVkXG4gIGxldCBwaHlzaWNzV29ybGQ6IFBoeXNpY3NXb3JsZCB8IHVuZGVmaW5lZDtcblxuICBpZiAocGh5c2ljcykge1xuICAgIGNvbnN0IHBoeXNpY3NPcHRpb25zID0gdHlwZW9mIHBoeXNpY3MgPT09ICdib29sZWFuJ1xuICAgICAgPyB7fVxuICAgICAgOiBwaHlzaWNzO1xuXG4gICAgcGh5c2ljc1dvcmxkID0gbmV3IFBoeXNpY3NXb3JsZChwaHlzaWNzT3B0aW9ucyk7XG4gICAgZW5naW5lLmFkZFBoeXNpY3NXb3JsZChwaHlzaWNzV29ybGQpO1xuICB9XG5cbiAgLy8gU2V0dXAgbG9hZGluZyBzY2VuZSBpZiByZXF1ZXN0ZWRcbiAgbGV0IGxvYWRpbmdTY2VuZTogTG9hZGluZ1NjZW5lIHwgdW5kZWZpbmVkO1xuICBpZiAoc2hvd0xvYWRpbmdTY2VuZSkge1xuICAgIGxvYWRpbmdTY2VuZSA9IG5ldyBMb2FkaW5nU2NlbmUobG9hZGluZ1NjZW5lT3B0aW9ucyk7XG4gICAgbG9hZGluZ1NjZW5lLnpJbmRleCA9IDEwMDAwOyAvLyBFbnN1cmUgaXQncyBvbiB0b3BcbiAgICBsb2FkaW5nU2NlbmUuaW5pdChyZW5kZXJlcik7XG4gICAgc2NlbmUuYWRkQ2hpbGQobG9hZGluZ1NjZW5lKTtcbiAgICBsb2FkaW5nU2NlbmUuaGlkZSgpO1xuXG4gICAgLy8gSG9vayBpbnRvIGFzc2V0IGxvYWRpbmcgZXZlbnRzXG4gICAgYXNzZXRMb2FkZXIub24oJ2xvYWRpbmc6c3RhcnQnLCAoKSA9PiB7XG4gICAgICBpZiAobG9hZGluZ1NjZW5lKSB7XG4gICAgICAgIGxvYWRpbmdTY2VuZS5zaG93KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBhc3NldExvYWRlci5vbignbG9hZGluZzplbmQnLCAoKSA9PiB7XG4gICAgICBpZiAobG9hZGluZ1NjZW5lKSB7XG4gICAgICAgIGxvYWRpbmdTY2VuZS5oaWRlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHNjZW5lLFxuICAgIGVuZ2luZSxcbiAgICBQSVhJQXNzZXRzLFxuICAgIHJlbmRlcmVyLFxuICAgIGxvYWRBc3NldHMsXG4gICAgY2FtZXJhLFxuICAgIHBoeXNpY3NXb3JsZCxcbiAgICBsb2FkaW5nU2NlbmVcbiAgfTtcbn1cblxuIiwiaW1wb3J0IHsgTG9naWMgfSBmcm9tICcuLi9jb3JlL2xvZ2ljJztcbmltcG9ydCB7IENvbnRhaW5lciwgUmVuZGVyZXIgfSBmcm9tICdwaXhpLmpzJztcblxuZXhwb3J0IGNsYXNzIFN0YXRlTG9naWMgZXh0ZW5kcyBMb2dpYzxDb250YWluZXI+IHtcbiAgcHJpdmF0ZSBfZW50aXR5OiBDb250YWluZXI7XG5cbiAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICB9XG5cbiAgZ2V0IGVudGl0eSgpIHtcbiAgICByZXR1cm4gdGhpcy5fZW50aXR5O1xuICB9XG5cbiAgaW5pdChlbnRpdHk6IENvbnRhaW5lciwgcmVuZGVyZXI6IFJlbmRlcmVyKSB7XG4gICAgdGhpcy5fZW50aXR5ID0gZW50aXR5O1xuICAgIHN1cGVyLmluaXQoZW50aXR5LCByZW5kZXJlcik7XG4gIH1cblxuICBvbkVudGVyKHN0YXRlOiBzdHJpbmcpIHtcbiAgfVxuXG4gIG9uRXhpdChzdGF0ZTogc3RyaW5nKSB7XG4gIH1cblxuICB1cGRhdGUoZW50aXR5OiBDb250YWluZXIsIGRlbHRhVGltZTogbnVtYmVyKSB7XG4gIH1cbiAgXG59XG5cbiIsImltcG9ydCB7IFN0YXRlTG9naWMgfSBmcm9tICcuL3N0YXRlLWxvZ2ljJztcblxuLyoqIEVtaXR0ZWQgb24gc3RhdGUgdHJhbnNpdGlvbnMuICovXG5leHBvcnQgdHlwZSBTdGF0ZUNoYW5nZUV2ZW50ID0ge1xuICBwcmV2U3RhdGU6IHN0cmluZyB8IG51bGw7XG4gIG5ld1N0YXRlOiBzdHJpbmc7XG59O1xuXG50eXBlIFN0YXRlQ2hhbmdlRXZlbnRMaXN0ZW5lciA9IChldmVudDogU3RhdGVDaGFuZ2VFdmVudCkgPT4gdm9pZDtcbnR5cGUgU3RhdGVMb2dpY1JlY29yZHMgPSBSZWNvcmQ8c3RyaW5nLCBTdGF0ZUxvZ2ljPjtcblxuLyoqXG4gKiBGaW5pdGUgU3RhdGUgTWFjaGluZSBmb3IgbWFuYWdpbmcgZW50aXR5IHN0YXRlcy5cbiAqIFN0YXRlcyBhcmUgU3RhdGVMb2dpYyBpbnN0YW5jZXMgd2l0aCBvbkVudGVyL29uRXhpdC91cGRhdGUgbWV0aG9kcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIC8vIENyZWF0ZSBzdGF0ZXNcbiAqIGNsYXNzIElkbGVTdGF0ZSBleHRlbmRzIFN0YXRlTG9naWMgeyAuLi4gfVxuICogY2xhc3MgUnVuU3RhdGUgZXh0ZW5kcyBTdGF0ZUxvZ2ljIHsgLi4uIH1cbiAqXG4gKiAvLyBDcmVhdGUgRlNNIHdpdGggc3RhdGVzXG4gKiBjb25zdCBmc20gPSBuZXcgU3RhdGVNYWNoaW5lKHtcbiAqICAgaWRsZTogbmV3IElkbGVTdGF0ZSgpLFxuICogICBydW46IG5ldyBSdW5TdGF0ZSgpXG4gKiB9KTtcbiAqXG4gKiAvLyBDaGFuZ2Ugc3RhdGVcbiAqIGZzbS5zZXRTdGF0ZSgnaWRsZScpO1xuICogZnNtLnNldFN0YXRlKCdydW4nKTtcbiAqXG4gKiAvLyBMaXN0ZW4gZm9yIHN0YXRlIGNoYW5nZXNcbiAqIGZzbS5hZGRFdmVudExpc3RlbmVyKCdzdGF0ZUNoYW5nZScsIChlKSA9PiB7XG4gKiAgIGNvbnNvbGUubG9nKGAke2UuZGV0YWlsLnByZXZTdGF0ZX0gLT4gJHtlLmRldGFpbC5uZXdTdGF0ZX1gKTtcbiAqIH0pO1xuICpcbiAqIC8vIENhbGwgaW4gdXBkYXRlIGxvb3BcbiAqIGZzbS51cGRhdGUoZGVsdGFUaW1lKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgU3RhdGVNYWNoaW5lIGV4dGVuZHMgRXZlbnRUYXJnZXQge1xuICBwcml2YXRlIF9zdGF0ZXM6IFN0YXRlTG9naWNSZWNvcmRzID0ge307XG4gIHByaXZhdGUgX2N1cnJlbnRTdGF0ZTogU3RhdGVMb2dpYyB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIF9jdXJyZW50U3RhdGVOYW1lOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcihzdGF0ZXM6IFN0YXRlTG9naWNSZWNvcmRzID0ge30pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX3N0YXRlcyA9IHN0YXRlcztcbiAgfVxuXG4gIHVwZGF0ZShkZWx0YVRpbWU6IG51bWJlcikge1xuICAgIGlmICh0aGlzLl9jdXJyZW50U3RhdGUpIHtcbiAgICAgIHRoaXMuX2N1cnJlbnRTdGF0ZS51cGRhdGUodGhpcy5fY3VycmVudFN0YXRlLmVudGl0eSwgZGVsdGFUaW1lKTtcbiAgICB9XG4gIH1cbiAgXG4gIHNldFN0YXRlKHN0YXRlTmFtZTogc3RyaW5nKSB7XG4gICAgY29uc3QgbmV4dFN0YXRlID0gdGhpcy5fc3RhdGVzW3N0YXRlTmFtZV07XG4gICAgaWYoIW5leHRTdGF0ZSkgcmV0dXJuO1xuXG4gICAgY29uc3QgcHJldlN0YXRlTmFtZSA9IHRoaXMuX2N1cnJlbnRTdGF0ZU5hbWU7XG4gICAgXG4gICAgaWYgKHRoaXMuX2N1cnJlbnRTdGF0ZSkge1xuICAgICAgdGhpcy5fY3VycmVudFN0YXRlLm9uRXhpdChzdGF0ZU5hbWUpO1xuICAgIH1cblxuICAgIHRoaXMuX2N1cnJlbnRTdGF0ZSA9IHRoaXMuX3N0YXRlc1tzdGF0ZU5hbWVdO1xuICAgIHRoaXMuX2N1cnJlbnRTdGF0ZU5hbWUgPSBzdGF0ZU5hbWU7XG4gICAgdGhpcy5fY3VycmVudFN0YXRlLm9uRW50ZXIoc3RhdGVOYW1lKTtcbiAgICBcbiAgICAvLyBEaXNwYXRjaCB0aGUgc3RhdGUgY2hhbmdlIGV2ZW50XG4gICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQ8U3RhdGVDaGFuZ2VFdmVudD4oJ3N0YXRlQ2hhbmdlJywge1xuICAgICAgZGV0YWlsOiB7XG4gICAgICAgIHByZXZTdGF0ZTogcHJldlN0YXRlTmFtZSxcbiAgICAgICAgbmV3U3RhdGU6IHN0YXRlTmFtZVxuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gIH1cblxuICBhZGRTdGF0ZShzdGF0ZTogU3RhdGVMb2dpYykge1xuICAgIHRoaXMuX3N0YXRlc1tzdGF0ZS5uYW1lXSA9IHN0YXRlO1xuICB9XG4gIFxuICBnZXQgY3VycmVudFN0YXRlKCk6IHN0cmluZyB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLl9jdXJyZW50U3RhdGVOYW1lO1xuICB9XG59XG5cbiIsIi8qKlxuICogVXRpbGl0eSB0byBjb252ZXJ0IFNWRyB0byBQSVhJIHRleHR1cmVcbiAqL1xuaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcblxuZXhwb3J0IGludGVyZmFjZSBTVkdUb1RleHR1cmVPcHRpb25zIHtcbiAgc3ZnU3RyaW5nOiBzdHJpbmc7XG4gIHdpZHRoOiBudW1iZXI7ICAvLyBEZXNpcmVkIHdpZHRoIGluIGFjdHVhbCBwaXhlbHNcbiAgaGVpZ2h0OiBudW1iZXI7IC8vIERlc2lyZWQgaGVpZ2h0IGluIGFjdHVhbCBwaXhlbHNcbiAgY29sb3I/OiBudW1iZXI7IC8vIENvbG9yIHRvIHJlcGxhY2UgXCJjdXJyZW50Q29sb3JcIiB3aXRoXG59XG5cbi8qKlxuICogQ29udmVydHMgYW4gU1ZHIHN0cmluZyB0byBhIFBJWEkgdGV4dHVyZVxuICogQWNjb3VudHMgZm9yIHByb3BlciBzY2FsaW5nIGFuZCByZW5kZXJzIGF0IHRoZSBleGFjdCBwaXhlbCBkaW1lbnNpb25zIG5lZWRlZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3ZnVG9UZXh0dXJlKG9wdGlvbnM6IFNWR1RvVGV4dHVyZU9wdGlvbnMpOiBQcm9taXNlPFBJWEkuVGV4dHVyZT4ge1xuICBjb25zdCB7IHN2Z1N0cmluZywgd2lkdGgsIGhlaWdodCwgY29sb3IgPSAweDAwMDAwMCB9ID0gb3B0aW9ucztcblxuICAvLyBSZXBsYWNlIGN1cnJlbnRDb2xvciB3aXRoIGFjdHVhbCBjb2xvclxuICBjb25zdCBjb2xvckhleCA9ICcjJyArIGNvbG9yLnRvU3RyaW5nKDE2KS5wYWRTdGFydCg2LCAnMCcpO1xuICBjb25zdCBwcm9jZXNzZWRTVkcgPSBzdmdTdHJpbmcucmVwbGFjZSgvY3VycmVudENvbG9yL2csIGNvbG9ySGV4KTtcblxuICAvLyBDcmVhdGUgYSBibG9iIGZyb20gdGhlIFNWRyBzdHJpbmdcbiAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtwcm9jZXNzZWRTVkddLCB7IHR5cGU6ICdpbWFnZS9zdmcreG1sJyB9KTtcbiAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcblxuICAvLyBMb2FkIGFzIGltYWdlXG4gIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpO1xuICBpbWcud2lkdGggPSB3aWR0aDtcbiAgaW1nLmhlaWdodCA9IGhlaWdodDtcblxuICBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgaW1nLm9ubG9hZCA9ICgpID0+IHJlc29sdmUoKTtcbiAgICBpbWcub25lcnJvciA9IHJlamVjdDtcbiAgICBpbWcuc3JjID0gdXJsO1xuICB9KTtcblxuICAvLyBDcmVhdGUgY2FudmFzIGFuZCBkcmF3IHRoZSBpbWFnZSBhdCB0aGUgZXhhY3Qgc2l6ZVxuICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgY2FudmFzLndpZHRoID0gd2lkdGg7XG4gIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG4gIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG4gIGlmICghY3R4KSB7XG4gICAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCBjYW52YXMgY29udGV4dCcpO1xuICB9XG5cbiAgLy8gRHJhdyB0aGUgaW1hZ2VcbiAgY3R4LmRyYXdJbWFnZShpbWcsIDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuXG4gIC8vIENsZWFuIHVwXG4gIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcblxuICAvLyBDcmVhdGUgdGV4dHVyZSBmcm9tIGNhbnZhc1xuICBjb25zdCB0ZXh0dXJlID0gUElYSS5UZXh0dXJlLmZyb20oY2FudmFzKTtcbiAgdGV4dHVyZS5zb3VyY2Uuc2NhbGVNb2RlID0gJ2xpbmVhcic7IC8vIFNtb290aCBzY2FsaW5nIGZvciBTVkdcblxuICByZXR1cm4gdGV4dHVyZTtcbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuXG4vKipcbiAqIFNlcXVlbmNlIGluZm9ybWF0aW9uIGZvciBhbiBhbmltYXRpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTZXF1ZW5jZUluZm8ge1xuICAvKiogQXJyYXkgb2YgZnJhbWUgaW5kaWNlcyBmcm9tIHRoZSB0ZXh0dXJlIGF0bGFzICovXG4gIGZyYW1lczogbnVtYmVyW107XG4gIC8qKiBTcGVlZCBvZiBhbmltYXRpb24gKGZyYW1lcyBwZXIgbXMpICovXG4gIGFuaW1hdGlvblNwZWVkOiBudW1iZXI7XG59XG5cbi8qKlxuICogTWFuYWdlcyBmcmFtZSBzZXF1ZW5jZXMgZm9yIGFuaW1hdGVkIHNwcml0ZXNcbiAqIFByb3ZpZGVzIHV0aWxpdHkgZnVuY3Rpb25zIGZvciB3b3JraW5nIHdpdGggc3ByaXRlIHNoZWV0IGFuaW1hdGlvbnNcbiAqL1xuZXhwb3J0IGNsYXNzIFRleHR1cmVGcmFtZVNlcXVlbmNlcyB7XG4gIHByaXZhdGUgZnJhbWVzOiBQSVhJLlRleHR1cmVbXSA9IFtdO1xuICBwcml2YXRlIHNlcXVlbmNlczogUmVjb3JkPHN0cmluZywgU2VxdWVuY2VJbmZvPiA9IHt9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgVGV4dHVyZUZyYW1lU2VxdWVuY2VzXG4gICAqIEBwYXJhbSBmcmFtZXMgLSBBcnJheSBvZiB0ZXh0dXJlcyBmcm9tIGEgc3ByaXRlc2hlZXRcbiAgICogQHBhcmFtIHNlcXVlbmNlcyAtIE5hbWVkIHNlcXVlbmNlcyB3aXRoIGZyYW1lIGluZGljZXMgYW5kIGFuaW1hdGlvbiBzcGVlZFxuICAgKi9cbiAgY29uc3RydWN0b3IoZnJhbWVzOiBQSVhJLlRleHR1cmVbXSwgc2VxdWVuY2VzOiBSZWNvcmQ8c3RyaW5nLCBTZXF1ZW5jZUluZm8+ID0ge30pIHtcbiAgICB0aGlzLmZyYW1lcyA9IGZyYW1lcztcbiAgICB0aGlzLnNlcXVlbmNlcyA9IHNlcXVlbmNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYSBuZXcgYW5pbWF0aW9uIHNlcXVlbmNlXG4gICAqIEBwYXJhbSBuYW1lIC0gVW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBzZXF1ZW5jZVxuICAgKiBAcGFyYW0gZnJhbWVJbmRpY2VzIC0gQXJyYXkgb2YgZnJhbWUgaW5kaWNlcyBmcm9tIHRoZSB0ZXh0dXJlIGF0bGFzXG4gICAqIEBwYXJhbSBhbmltYXRpb25TcGVlZCAtIFNwZWVkIG9mIGFuaW1hdGlvbiAoZnJhbWVzIHBlciBtcylcbiAgICovXG4gIGFkZFNlcXVlbmNlKG5hbWU6IHN0cmluZywgZnJhbWVJbmRpY2VzOiBudW1iZXJbXSwgYW5pbWF0aW9uU3BlZWQ6IG51bWJlciA9IDEpIHtcbiAgICB0aGlzLnNlcXVlbmNlc1tuYW1lXSA9IHtcbiAgICAgIGZyYW1lczogZnJhbWVJbmRpY2VzLFxuICAgICAgYW5pbWF0aW9uU3BlZWRcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhIHNlcXVlbmNlIGJ5IG5hbWVcbiAgICovXG4gIGdldFNlcXVlbmNlKG5hbWU6IHN0cmluZyk6IFNlcXVlbmNlSW5mbyB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLnNlcXVlbmNlc1tuYW1lXSB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhIHNwZWNpZmljIGZyYW1lIGJ5IGluZGV4XG4gICAqL1xuICBnZXRGcmFtZShpbmRleDogbnVtYmVyKTogUElYSS5UZXh0dXJlIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuZnJhbWVzW2luZGV4XSB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhIHNwZWNpZmljIGZyYW1lIGZyb20gYSBzZXF1ZW5jZSBieSBpbmRleFxuICAgKi9cbiAgZ2V0RnJhbWVGcm9tU2VxdWVuY2Uoc2VxdWVuY2VOYW1lOiBzdHJpbmcsIGZyYW1lSW5kZXg6IG51bWJlcik6IFBJWEkuVGV4dHVyZSB8IG51bGwge1xuICAgIGNvbnN0IHNlcXVlbmNlID0gdGhpcy5nZXRTZXF1ZW5jZShzZXF1ZW5jZU5hbWUpO1xuICAgIGlmICghc2VxdWVuY2UpIHJldHVybiBudWxsO1xuICAgIFxuICAgIC8vIEdldCB0aGUgYXBwcm9wcmlhdGUgZnJhbWUgaW5kZXggZnJvbSB0aGUgc2VxdWVuY2VcbiAgICBjb25zdCBzZXF1ZW5jZUZyYW1lSW5kZXggPSBzZXF1ZW5jZS5mcmFtZXNbZnJhbWVJbmRleCAlIHNlcXVlbmNlLmZyYW1lcy5sZW5ndGhdO1xuICAgIFxuICAgIC8vIFJldHVybiB0aGUgdGV4dHVyZVxuICAgIHJldHVybiB0aGlzLmZyYW1lc1tzZXF1ZW5jZUZyYW1lSW5kZXhdIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCBmcmFtZXMgZm9yIGEgc2VxdWVuY2VcbiAgICovXG4gIGdldEZyYW1lU2VxdWVuY2UobmFtZTogc3RyaW5nKTogUElYSS5UZXh0dXJlW10ge1xuICAgIGNvbnN0IHNlcXVlbmNlID0gdGhpcy5nZXRTZXF1ZW5jZShuYW1lKTtcbiAgICBpZiAoIXNlcXVlbmNlKSByZXR1cm4gW107XG4gICAgXG4gICAgcmV0dXJuIHNlcXVlbmNlLmZyYW1lcy5tYXAoaW5kZXggPT4gdGhpcy5mcmFtZXNbaW5kZXhdKS5maWx0ZXIoQm9vbGVhbik7XG4gIH1cbn0gIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cblxuLyoqXG4gKiBPcHRpb25zIGZvciBjcmVhdGluZyB0ZXh0dXJlIGZyYW1lcyBmcm9tIGEgc3ByaXRlc2hlZXRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBc1RleHR1cmVGcmFtZXNPcHRpb25zIHtcbiAgLyoqXG4gICAqIFdpZHRoIG9mIGVhY2ggZnJhbWUgaW4gcGl4ZWxzXG4gICAqL1xuICBmcmFtZVdpZHRoOiBudW1iZXI7XG4gIFxuICAvKipcbiAgICogSGVpZ2h0IG9mIGVhY2ggZnJhbWUgaW4gcGl4ZWxzXG4gICAqL1xuICBmcmFtZUhlaWdodDogbnVtYmVyO1xuICBcbiAgLyoqXG4gICAqIE51bWJlciBvZiBjb2x1bW5zIGluIHRoZSBzcHJpdGVzaGVldFxuICAgKi9cbiAgY29sdW1uczogbnVtYmVyO1xuICBcbiAgLyoqXG4gICAqIE51bWJlciBvZiByb3dzIGluIHRoZSBzcHJpdGVzaGVldFxuICAgKi9cbiAgcm93czogbnVtYmVyO1xufVxuXG4vKipcbiAqIERlZmF1bHQgdGV4dHVyZSBmcmFtZSBvcHRpb25zXG4gKi9cbmNvbnN0IGRlZmF1bHRPcHRpb25zOiBBc1RleHR1cmVGcmFtZXNPcHRpb25zID0geyBcbiAgZnJhbWVXaWR0aDogNDgsIFxuICBmcmFtZUhlaWdodDogNDgsIFxuICBjb2x1bW5zOiA0LCBcbiAgcm93czogNCBcbn07XG5cbi8qKlxuICogU3BsaXRzIGEgdGV4dHVyZSBzb3VyY2UgaW50byBpbmRpdmlkdWFsIHRleHR1cmUgZnJhbWVzIGJhc2VkIG9uIGEgZ3JpZCBsYXlvdXRcbiAqIFxuICogQHBhcmFtIHRleHR1cmVTb3VyY2UgLSBUaGUgc291cmNlIHRleHR1cmUgdG8gc3BsaXQgaW50byBmcmFtZXNcbiAqIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciBmcmFtZSBleHRyYWN0aW9uXG4gKiBAcmV0dXJucyBBcnJheSBvZiBpbmRpdmlkdWFsIHRleHR1cmUgZnJhbWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc1RleHR1cmVGcmFtZXMoXG4gIFBJWEksXG4gIHRleHR1cmVTb3VyY2U6IFBJWEkuVGV4dHVyZVNvdXJjZSwgXG4gIG9wdGlvbnM6IEFzVGV4dHVyZUZyYW1lc09wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucyxcbik6IFBJWEkuVGV4dHVyZTxQSVhJLlRleHR1cmVTb3VyY2U8YW55Pj5bXSB7XG4gIGNvbnN0IHsgZnJhbWVXaWR0aCwgZnJhbWVIZWlnaHQsIGNvbHVtbnMsIHJvd3MgfSA9IG9wdGlvbnM7XG4gIGNvbnN0IGZyYW1lczogUElYSS5UZXh0dXJlPFBJWEkuVGV4dHVyZVNvdXJjZTxhbnk+PltdID0gW107XG5cbiAgLy8gRW5zdXJlIHdlJ3JlIHdvcmtpbmcgd2l0aCBhIHZhbGlkYXRlZCB0ZXh0dXJlIHNvdXJjZVxuICBpZiAoIXRleHR1cmVTb3VyY2UpIHtcbiAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIHRleHR1cmUgc291cmNlIHByb3ZpZGVkIHRvIGFzVGV4dHVyZUZyYW1lcycpO1xuICAgIHJldHVybiBmcmFtZXM7XG4gIH1cblxuICAvLyBDcmVhdGUgdGV4dHVyZXMgZnJvbSB0aGUgdGV4dHVyZSBzb3VyY2UgLSBrZWVwaW5nIGltcGxlbWVudGF0aW9uIGlkZW50aWNhbCB0byB3b3JraW5nIHZlcnNpb25cbiAgZm9yIChsZXQgeSA9IDA7IHkgPCByb3dzOyB5KyspIHtcbiAgICBmb3IgKGxldCB4ID0gMDsgeCA8IGNvbHVtbnM7IHgrKykge1xuICAgICAgY29uc3QgZnJhbWUgPSBuZXcgUElYSS5SZWN0YW5nbGUoeCAqIGZyYW1lV2lkdGgsIHkgKiBmcmFtZUhlaWdodCwgZnJhbWVXaWR0aCwgZnJhbWVIZWlnaHQpO1xuICAgICAgXG4gICAgICAvLyBLZWVwIHRoZSBleGFjdCBzYW1lIGltcGxlbWVudGF0aW9uIGFzIHRoZSB3b3JraW5nIGV4YW1wbGVcbiAgICAgIGNvbnN0IGZyYW1ldGV4dHVyZSA9IG5ldyBQSVhJLlRleHR1cmUoe1xuICAgICAgICBzb3VyY2U6IHRleHR1cmVTb3VyY2UsXG4gICAgICAgIGZyYW1lOiBmcmFtZSxcbiAgICAgIH0pIGFzIFBJWEkuVGV4dHVyZTxQSVhJLlRleHR1cmVTb3VyY2U8YW55Pj47XG4gICAgICBcbiAgICAgIGZyYW1lcy5wdXNoKGZyYW1ldGV4dHVyZSk7XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gZnJhbWVzIGFzIFBJWEkuVGV4dHVyZTxQSVhJLlRleHR1cmVTb3VyY2U8YW55Pj5bXTtcbn1cbiIsImltcG9ydCB7IFBvaW50IH0gZnJvbSAncGl4aS5qcyc7XG5cbi8qKlxuICogQ29tbW9ubHkgdXNlZCBQb2ludCBmYWN0b3J5IGZ1bmN0aW9uc1xuICogVGhlc2UgcmVkdWNlIG9iamVjdCBhbGxvY2F0aW9ucyBhbmQgY2xhcmlmeSBpbnRlbnRcbiAqL1xuZXhwb3J0IGNvbnN0IGNyZWF0ZVBvaW50ID0gKHggPSAwLCB5ID0gMCk6IFBvaW50ID0+IG5ldyBQb2ludCh4LCB5KTtcbmV4cG9ydCBjb25zdCBaRVJPX1BPSU5UID0gKCk6IFBvaW50ID0+IG5ldyBQb2ludCgwLCAwKTtcbmV4cG9ydCBjb25zdCBPTkVfUE9JTlQgPSAoKTogUG9pbnQgPT4gbmV3IFBvaW50KDEsIDEpO1xuXG5leHBvcnQgY29uc3QgdWMgPSAocyA9ICcnKSA9PiBzLnRvVXBwZXJDYXNlKCk7XG5leHBvcnQgY29uc3QgbGMgPSAocyA9ICcnKSA9PiBzLnRvTG93ZXJDYXNlKCk7XG5cbmV4cG9ydCBjb25zdCBwYWRSaWdodCA9ICh2YWwgPSAnJywgbGVuZ3RoID0gMCwgcGFkV2l0aCA9ICcgJykgPT4ge1xuICBsZXQgcmVzdWx0ID0gdmFsKycnO1xuICB3aGlsZShyZXN1bHQubGVuZ3RoIDwgbGVuZ3RoKXtcbiAgICByZXN1bHQgKz0gcGFkV2l0aDtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuZXhwb3J0IGNvbnN0IHByID0gcGFkUmlnaHQ7XG5cbi8qKlxuICogR2VuZXJhdGUgcmFuZG9tIGludGVnZXIgYmV0d2VlbiBtaW4gYW5kIG1heCAoaW5jbHVzaXZlKVxuICogQHBhcmFtIG1pbiAtIE1pbmltdW0gdmFsdWUgKGluY2x1c2l2ZSlcbiAqIEBwYXJhbSBtYXggLSBNYXhpbXVtIHZhbHVlIChpbmNsdXNpdmUpXG4gKiBAcmV0dXJucyBSYW5kb20gaW50ZWdlciBpbiByYW5nZSBbbWluLCBtYXhdXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRSYW5kb21JbnQgPSAobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyID0+IChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4ICsgMSAtIG1pbikpICsgbWluKTtcblxuZXhwb3J0IGNvbnN0IHJvdW5kVG8gPSAocGxhY2VzLCB2YWx1ZSkgPT4gKE1hdGgucm91bmQodmFsdWUgKiBNYXRoLnBvdygxMCwgcGxhY2VzKSkgLyBNYXRoLnBvdygxMCwgcGxhY2VzKSk7XG5cbmV4cG9ydCBjb25zdCBsZXJwID0gKGJlZ2luLCBlbmQsIG1hZykgPT4gKCgxIC0gbWFnKSAqIGJlZ2luICsgbWFnICogZW5kKTtcblxuZXhwb3J0IGZ1bmN0aW9uIG1ldGVyc1RvUGl4ZWxzKG06IG51bWJlcik6IG51bWJlciB7IHJldHVybiBtICogMjA7IH1cblxuZXhwb3J0IGZ1bmN0aW9uIHBpeGVsc1RvTWV0ZXJzKHA6IG51bWJlcik6IG51bWJlciB7IHJldHVybiBwICogMC4wNTsgfVxuXG5leHBvcnQgY29uc3QgZmV0Y2hYbWwgPSBhc3luYyAodXJsOiBzdHJpbmcpID0+IChhd2FpdCAoYXdhaXQgZmV0Y2godXJsKSkudGV4dCgpKTtcblxuZXhwb3J0IGNvbnN0IHJhZDJkZWcgPSAocmFkOiBudW1iZXIpID0+IHJhZCAqICgxODAgLyBNYXRoLlBJKTtcbmV4cG9ydCBjb25zdCBkZWcycmFkID0gKGRlZzogbnVtYmVyKSA9PiBkZWcgKiAoTWF0aC5QSSAvIDE4MCk7XG4gICIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSVNjYWxlTW9kZSB9IGZyb20gJy4vVUlTY2FsZU1vZGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFVJTGF5ZXJPcHRpb25zIHtcbiAgLyoqXG4gICAqIFNjYWxpbmcgbW9kZSBmb3IgdGhpcyBVSSBsYXllclxuICAgKiBAZGVmYXVsdCBVSVNjYWxlTW9kZS5Ob25lXG4gICAqL1xuICBzY2FsZU1vZGU/OiBVSVNjYWxlTW9kZTtcblxuICAvKipcbiAgICogVGFyZ2V0IHdpZHRoIGZvciB0aGUgVUkgbGF5ZXIgKHVzZWQgYXMgcmVmZXJlbmNlIGZvciBzY2FsaW5nKVxuICAgKiBJZiBub3QgcHJvdmlkZWQsIHVzZXMgdGhlIGZpcnN0IGNoaWxkJ3Mgd2lkdGhcbiAgICovXG4gIHRhcmdldFdpZHRoPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUYXJnZXQgaGVpZ2h0IGZvciB0aGUgVUkgbGF5ZXIgKHVzZWQgYXMgcmVmZXJlbmNlIGZvciBzY2FsaW5nKVxuICAgKiBJZiBub3QgcHJvdmlkZWQsIHVzZXMgdGhlIGZpcnN0IGNoaWxkJ3MgaGVpZ2h0XG4gICAqL1xuICB0YXJnZXRIZWlnaHQ/OiBudW1iZXI7XG59XG5cbi8qKlxuICogVUlMYXllciBpcyBhIGNvbnRhaW5lciB0aGF0IG1hbmFnZXMgc2NhbGluZyBiZWhhdmlvciBmb3IgYWxsIGl0cyBjaGlsZHJlblxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBodWRMYXllciA9IG5ldyBVSUxheWVyKHsgc2NhbGVNb2RlOiBVSVNjYWxlTW9kZS5TY2FsZVVJIH0pO1xuICogc2NlbmUuYWRkQ2hpbGQoaHVkTGF5ZXIpO1xuICogaHVkTGF5ZXIuYWRkQ2hpbGQodGFicy5jb250YWluZXIpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSUxheWVyIGV4dGVuZHMgUElYSS5Db250YWluZXIge1xuICBwcml2YXRlIHNjYWxlTW9kZTogVUlTY2FsZU1vZGU7XG4gIHByaXZhdGUgdGFyZ2V0V2lkdGg/OiBudW1iZXI7XG4gIHByaXZhdGUgdGFyZ2V0SGVpZ2h0PzogbnVtYmVyO1xuICBwcml2YXRlIGluaXRpYWxCb3VuZHNSZWNvcmRlZCA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IFVJTGF5ZXJPcHRpb25zID0ge30pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuc2NhbGVNb2RlID0gb3B0aW9ucy5zY2FsZU1vZGUgPz8gVUlTY2FsZU1vZGUuTm9uZTtcbiAgICB0aGlzLnRhcmdldFdpZHRoID0gb3B0aW9ucy50YXJnZXRXaWR0aDtcbiAgICB0aGlzLnRhcmdldEhlaWdodCA9IG9wdGlvbnMudGFyZ2V0SGVpZ2h0O1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgbGF5ZXIncyBzY2FsZSBiYXNlZCBvbiB0aGUgY3VycmVudCBjYW52YXMgc2l6ZVxuICAgKi9cbiAgdXBkYXRlU2NhbGUoY2FudmFzV2lkdGg6IG51bWJlciwgY2FudmFzSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5zY2FsZU1vZGUgPT09IFVJU2NhbGVNb2RlLk5vbmUpIHtcbiAgICAgIHRoaXMuc2NhbGUuc2V0KDEsIDEpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFJlY29yZCBpbml0aWFsIGJvdW5kcyBmcm9tIGZpcnN0IGNoaWxkIGlmIG5vdCBleHBsaWNpdGx5IHNldFxuICAgIGlmICghdGhpcy5pbml0aWFsQm91bmRzUmVjb3JkZWQgJiYgdGhpcy5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoIXRoaXMudGFyZ2V0V2lkdGggfHwgIXRoaXMudGFyZ2V0SGVpZ2h0KSB7XG4gICAgICAgIGNvbnN0IGJvdW5kcyA9IHRoaXMuZ2V0TG9jYWxCb3VuZHMoKTtcbiAgICAgICAgdGhpcy50YXJnZXRXaWR0aCA9IHRoaXMudGFyZ2V0V2lkdGggPz8gYm91bmRzLndpZHRoO1xuICAgICAgICB0aGlzLnRhcmdldEhlaWdodCA9IHRoaXMudGFyZ2V0SGVpZ2h0ID8/IGJvdW5kcy5oZWlnaHQ7XG4gICAgICB9XG4gICAgICB0aGlzLmluaXRpYWxCb3VuZHNSZWNvcmRlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnRhcmdldFdpZHRoIHx8ICF0aGlzLnRhcmdldEhlaWdodCkge1xuICAgICAgLy8gTm8gZGltZW5zaW9ucyB0byBzY2FsZSBmcm9tIHlldFxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHNjYWxlWCA9IGNhbnZhc1dpZHRoIC8gdGhpcy50YXJnZXRXaWR0aDtcbiAgICBjb25zdCBzY2FsZVkgPSBjYW52YXNIZWlnaHQgLyB0aGlzLnRhcmdldEhlaWdodDtcblxuICAgIHN3aXRjaCAodGhpcy5zY2FsZU1vZGUpIHtcbiAgICAgIGNhc2UgVUlTY2FsZU1vZGUuU2NhbGVVSTpcbiAgICAgICAgLy8gU2NhbGUgdG8gZmlsbCwgc3RyZXRjaGluZyBpZiBuZWNlc3NhcnlcbiAgICAgICAgdGhpcy5zY2FsZS5zZXQoc2NhbGVYLCBzY2FsZVkpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBVSVNjYWxlTW9kZS5Mb2NrUmF0aW86XG4gICAgICAgIC8vIFNjYWxlIG1haW50YWluaW5nIGFzcGVjdCByYXRpb1xuICAgICAgICBjb25zdCBzY2FsZSA9IE1hdGgubWluKHNjYWxlWCwgc2NhbGVZKTtcbiAgICAgICAgdGhpcy5zY2FsZS5zZXQoc2NhbGUsIHNjYWxlKTtcbiAgICAgICAgLy8gQ2VudGVyIHRoZSBjb250ZW50XG4gICAgICAgIHRoaXMucG9zaXRpb24uc2V0KFxuICAgICAgICAgIChjYW52YXNXaWR0aCAtIHRoaXMudGFyZ2V0V2lkdGggKiBzY2FsZSkgLyAyLFxuICAgICAgICAgIChjYW52YXNIZWlnaHQgLSB0aGlzLnRhcmdldEhlaWdodCAqIHNjYWxlKSAvIDJcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhIGNoaWxkIGFuZCB0cmlnZ2VyIHNjYWxlIHVwZGF0ZSBpZiBuZWVkZWRcbiAgICovXG4gIG92ZXJyaWRlIGFkZENoaWxkPFQgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lcltdPiguLi5jaGlsZHJlbjogVCk6IFRbMF0ge1xuICAgIGNvbnN0IHJlc3VsdCA9IHN1cGVyLmFkZENoaWxkKC4uLmNoaWxkcmVuKTtcbiAgICB0aGlzLmluaXRpYWxCb3VuZHNSZWNvcmRlZCA9IGZhbHNlO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn1cbiIsIi8qKlxuICogVUkgU2NhbGluZyBtb2RlcyBmb3IgVUlMYXllclxuICovXG5leHBvcnQgZW51bSBVSVNjYWxlTW9kZSB7XG4gIC8qKlxuICAgKiBObyBzY2FsaW5nIC0gMToxIHBpeGVsIG1hcHBpbmcsIG5vIG9mZnNldCBjYWxjdWxhdGlvbnNcbiAgICovXG4gIE5vbmUgPSAnbm9uZScsXG5cbiAgLyoqXG4gICAqIFNjYWxlIFVJIHByb3BvcnRpb25hbGx5IHRvIGZpbGwgdGhlIGF2YWlsYWJsZSBzcGFjZVxuICAgKi9cbiAgU2NhbGVVSSA9ICdzY2FsZVVJJyxcblxuICAvKipcbiAgICogU2NhbGUgd2hpbGUgbWFpbnRhaW5pbmcgYXNwZWN0IHJhdGlvIChtYXkgbGV0dGVyYm94L3BpbGxhcmJveClcbiAgICovXG4gIExvY2tSYXRpbyA9ICdsb2NrUmF0aW8nXG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IEJ1dHRvblN0YXRlIH0gZnJvbSAnLi91aS1idXR0b24nO1xuaW1wb3J0IHsgVUlQYW5lbCB9IGZyb20gJy4vdWktcGFuZWwnO1xuXG4vKipcbiAqIFN0cmF0ZWd5IGludGVyZmFjZSBmb3IgYnV0dG9uIGJhY2tncm91bmQgcmVuZGVyaW5nXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQnV0dG9uQmFja2dyb3VuZFN0cmF0ZWd5IHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYW5kIHJldHVybnMgdGhlIGJhY2tncm91bmQgY29udGFpbmVyXG4gICAqL1xuICBjcmVhdGUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiBQSVhJLkNvbnRhaW5lcjtcblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgdmlzdWFsIHN0YXRlIG9mIHRoZSBiYWNrZ3JvdW5kXG4gICAqL1xuICB1cGRhdGVTdGF0ZShzdGF0ZTogQnV0dG9uU3RhdGUpOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBhY3R1YWwgcmVuZGVyZWQgaGVpZ2h0IG9mIHRoZSBiYWNrZ3JvdW5kXG4gICAqL1xuICBnZXRBY3R1YWxIZWlnaHQoKTogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBDbGVhbnMgdXAgcmVzb3VyY2VzXG4gICAqL1xuICBkZXN0cm95KCk6IHZvaWQ7XG59XG5cbi8qKlxuICogU29saWQgY29sb3IgYmFja2dyb3VuZCBzdHJhdGVneSB1c2luZyBVSVBhbmVsXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBjbGFzcyBTb2xpZENvbG9yQmFja2dyb3VuZFN0cmF0ZWd5IGltcGxlbWVudHMgQnV0dG9uQmFja2dyb3VuZFN0cmF0ZWd5IHtcbiAgcHJpdmF0ZSBwYW5lbD86IFVJUGFuZWw7XG4gIHByaXZhdGUgbm9ybWFsQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBob3ZlckNvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgcHJlc3NlZENvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgZGlzYWJsZWRDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIHdpZHRoOiBudW1iZXI7XG4gIHByaXZhdGUgaGVpZ2h0OiBudW1iZXI7XG4gIHByaXZhdGUgYm9yZGVyUmFkaXVzOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgYmFja2dyb3VuZENvbG9yOiBudW1iZXIsXG4gICAgd2lkdGg6IG51bWJlcixcbiAgICBoZWlnaHQ6IG51bWJlcixcbiAgICBib3JkZXJSYWRpdXM6IG51bWJlclxuICApIHtcbiAgICB0aGlzLm5vcm1hbENvbG9yID0gYmFja2dyb3VuZENvbG9yO1xuICAgIHRoaXMuaG92ZXJDb2xvciA9IHRoaXMuZGFya2VuQ29sb3IoYmFja2dyb3VuZENvbG9yLCAwLjkpO1xuICAgIHRoaXMucHJlc3NlZENvbG9yID0gdGhpcy5kYXJrZW5Db2xvcihiYWNrZ3JvdW5kQ29sb3IsIDAuOCk7XG4gICAgdGhpcy5kaXNhYmxlZENvbG9yID0gMHg4ODg4ODg7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIHRoaXMuYm9yZGVyUmFkaXVzID0gYm9yZGVyUmFkaXVzO1xuICB9XG5cbiAgY3JlYXRlKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogUElYSS5Db250YWluZXIge1xuICAgIHRoaXMucGFuZWwgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMubm9ybWFsQ29sb3IsXG4gICAgICB3aWR0aCxcbiAgICAgIGhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcblxuICAgIHRoaXMucGFuZWwubGF5b3V0KHdpZHRoLCBoZWlnaHQpO1xuICAgIHJldHVybiB0aGlzLnBhbmVsLmNvbnRhaW5lcjtcbiAgfVxuXG4gIHVwZGF0ZVN0YXRlKHN0YXRlOiBCdXR0b25TdGF0ZSk6IHZvaWQge1xuICAgIGlmICghdGhpcy5wYW5lbCkgcmV0dXJuO1xuXG4gICAgbGV0IGNvbG9yOiBudW1iZXI7XG4gICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgY2FzZSBCdXR0b25TdGF0ZS5Ob3JtYWw6XG4gICAgICAgIGNvbG9yID0gdGhpcy5ub3JtYWxDb2xvcjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEJ1dHRvblN0YXRlLkhvdmVyOlxuICAgICAgICBjb2xvciA9IHRoaXMuaG92ZXJDb2xvcjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEJ1dHRvblN0YXRlLlByZXNzZWQ6XG4gICAgICAgIGNvbG9yID0gdGhpcy5wcmVzc2VkQ29sb3I7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBCdXR0b25TdGF0ZS5EaXNhYmxlZDpcbiAgICAgICAgY29sb3IgPSB0aGlzLmRpc2FibGVkQ29sb3I7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHRoaXMucGFuZWwuc2V0QmFja2dyb3VuZENvbG9yKGNvbG9yKTtcbiAgfVxuXG4gIGdldEFjdHVhbEhlaWdodCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmhlaWdodDtcbiAgfVxuXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgLy8gVUlQYW5lbCBjbGVhbnVwIGhhbmRsZWQgYnkgY29udGFpbmVyXG4gIH1cblxuICBwcml2YXRlIGRhcmtlbkNvbG9yKGNvbG9yOiBudW1iZXIsIGZhY3RvcjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBjb25zdCByID0gKChjb2xvciA+PiAxNikgJiAweGZmKSAqIGZhY3RvcjtcbiAgICBjb25zdCBnID0gKChjb2xvciA+PiA4KSAmIDB4ZmYpICogZmFjdG9yO1xuICAgIGNvbnN0IGIgPSAoY29sb3IgJiAweGZmKSAqIGZhY3RvcjtcbiAgICByZXR1cm4gKChyIDw8IDE2KSB8IChnIDw8IDgpIHwgYikgPj4+IDA7XG4gIH1cbn1cblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIGZvciBpY29uIG92ZXJsYXlzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSWNvbkNvbmZpZyB7XG4gIC8qKiBTcHJpdGVzaGVldCBjb250YWluaW5nIHRoZSBpY29uIHRleHR1cmUgKi9cbiAgc3ByaXRlc2hlZXQ6IFBJWEkuU3ByaXRlc2hlZXQ7XG4gIC8qKiBUZXh0dXJlIG5hbWUgaW4gdGhlIHNwcml0ZXNoZWV0ICovXG4gIHRleHR1cmVOYW1lOiBzdHJpbmc7XG4gIC8qKiBJY29uIHNjYWxlIChkZWZhdWx0OiAxLjApICovXG4gIHNjYWxlPzogbnVtYmVyO1xuICAvKiogVXNlIHBpeGVsLXBlcmZlY3QgcmVuZGVyaW5nICovXG4gIHBpeGVsUGVyZmVjdD86IGJvb2xlYW47XG59XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiBmb3Igc3ByaXRlLWJhc2VkIGJhY2tncm91bmRzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3ByaXRlQmFja2dyb3VuZENvbmZpZyB7XG4gIC8qKiBTcHJpdGVzaGVldCBjb250YWluaW5nIHRoZSBidXR0b24gdGV4dHVyZXMgKi9cbiAgc3ByaXRlc2hlZXQ6IFBJWEkuU3ByaXRlc2hlZXQ7XG4gIC8qKiBUZXh0dXJlIG5hbWUgcGF0dGVybiAtIHVzZSB7Y29sb3J9IHBsYWNlaG9sZGVyLiBFeGFtcGxlOiBcImJhckhvcml6b250YWxfe2NvbG9yfV9sZWZ0LnBuZ1wiICovXG4gIHRleHR1cmVQYXR0ZXJuOiBzdHJpbmc7XG4gIC8qKiBDb2xvciB2YXJpYW50IHRvIHVzZSAoZS5nLiwgJ2JsdWUnLCAnZ3JlZW4nLCAncmVkJykgKi9cbiAgY29sb3I6IHN0cmluZztcbiAgLyoqIFVzZSBwaXhlbC1wZXJmZWN0IHJlbmRlcmluZyAobmVhcmVzdCBuZWlnaGJvcikgKi9cbiAgcGl4ZWxQZXJmZWN0PzogYm9vbGVhbjtcbiAgLyoqIFVzZSA5LXNsaWNlIHJlbmRlcmluZyBpbnN0ZWFkIG9mIHRocmVlLXBpZWNlIGhvcml6b250YWwgKi9cbiAgdXNlTmluZVNsaWNlPzogYm9vbGVhbjtcbiAgLyoqIDktc2xpY2UgYm9yZGVyIHdpZHRocyAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSAtIHJlcXVpcmVkIGlmIHVzZU5pbmVTbGljZSBpcyB0cnVlICovXG4gIG5pbmVTbGljZUJvcmRlcnM/OiB7IGxlZnQ6IG51bWJlcjsgdG9wOiBudW1iZXI7IHJpZ2h0OiBudW1iZXI7IGJvdHRvbTogbnVtYmVyIH07XG4gIC8qKiBUZXh0dXJlIG5hbWUgZm9yIHByZXNzZWQvZG93biBzdGF0ZSAtIHVzZSB7Y29sb3J9IHBsYWNlaG9sZGVyIGlmIG5lZWRlZCAqL1xuICBwcmVzc2VkVGV4dHVyZVBhdHRlcm4/OiBzdHJpbmc7XG4gIC8qKiBJY29uIGNvbmZpZ3VyYXRpb24gZm9yIG92ZXJsYXkgKi9cbiAgaWNvbj86IEljb25Db25maWc7XG59XG5cbi8qKlxuICogU3ByaXRlLWJhc2VkIGJhY2tncm91bmQgc3RyYXRlZ3kgdXNpbmcgdGhyZWUtcGllY2UgaG9yaXpvbnRhbCB0ZXh0dXJlcyBvciA5LXNsaWNlXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBjbGFzcyBTcHJpdGVCYWNrZ3JvdW5kU3RyYXRlZ3kgaW1wbGVtZW50cyBCdXR0b25CYWNrZ3JvdW5kU3RyYXRlZ3kge1xuICBwcml2YXRlIGNvbnRhaW5lcj86IFBJWEkuQ29udGFpbmVyO1xuICBwcml2YXRlIHNwcml0ZUxlZnQ/OiBQSVhJLlNwcml0ZTtcbiAgcHJpdmF0ZSBzcHJpdGVNaWQ/OiBQSVhJLlNwcml0ZTtcbiAgcHJpdmF0ZSBzcHJpdGVSaWdodD86IFBJWEkuU3ByaXRlO1xuICBwcml2YXRlIG5pbmVTbGljZVNwcml0ZT86IFBJWEkuTmluZVNsaWNlU3ByaXRlO1xuICBwcml2YXRlIG5pbmVTbGljZVNwcml0ZVByZXNzZWQ/OiBQSVhJLk5pbmVTbGljZVNwcml0ZTtcbiAgcHJpdmF0ZSBpY29uU3ByaXRlPzogUElYSS5TcHJpdGU7XG4gIHByaXZhdGUgY29uZmlnOiBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnO1xuICBwcml2YXRlIHdpZHRoOiBudW1iZXI7XG4gIHByaXZhdGUgaGVpZ2h0OiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgfVxuXG4gIGNyZWF0ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IFBJWEkuQ29udGFpbmVyIHtcbiAgICB0aGlzLmNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgIGNvbnN0IHsgc3ByaXRlc2hlZXQsIHRleHR1cmVQYXR0ZXJuLCBjb2xvciwgcGl4ZWxQZXJmZWN0LCB1c2VOaW5lU2xpY2UsIG5pbmVTbGljZUJvcmRlcnMsIHByZXNzZWRUZXh0dXJlUGF0dGVybiwgaWNvbiB9ID0gdGhpcy5jb25maWc7XG5cbiAgICAvLyBTZXQgcGl4ZWwtcGVyZmVjdCByZW5kZXJpbmcgaWYgcmVxdWVzdGVkXG4gICAgaWYgKHBpeGVsUGVyZmVjdCAmJiBzcHJpdGVzaGVldC50ZXh0dXJlU291cmNlKSB7XG4gICAgICBzcHJpdGVzaGVldC50ZXh0dXJlU291cmNlLnNjYWxlTW9kZSA9ICduZWFyZXN0JztcbiAgICB9XG5cbiAgICBpZiAodXNlTmluZVNsaWNlICYmIG5pbmVTbGljZUJvcmRlcnMpIHtcbiAgICAgIC8vIFVzZSA5LXNsaWNlIHNwcml0ZVxuICAgICAgY29uc3QgdGV4dHVyZU5hbWUgPSB0ZXh0dXJlUGF0dGVybi5pbmNsdWRlcygne2NvbG9yfScpXG4gICAgICAgID8gdGV4dHVyZVBhdHRlcm4ucmVwbGFjZSgne2NvbG9yfScsIGNvbG9yKVxuICAgICAgICA6IHRleHR1cmVQYXR0ZXJuO1xuICAgICAgY29uc3QgdGV4dHVyZSA9IHNwcml0ZXNoZWV0LnRleHR1cmVzW3RleHR1cmVOYW1lXTtcblxuICAgICAgdGhpcy5uaW5lU2xpY2VTcHJpdGUgPSBuZXcgUElYSS5OaW5lU2xpY2VTcHJpdGUoe1xuICAgICAgICB0ZXh0dXJlLFxuICAgICAgICBsZWZ0V2lkdGg6IG5pbmVTbGljZUJvcmRlcnMubGVmdCxcbiAgICAgICAgdG9wSGVpZ2h0OiBuaW5lU2xpY2VCb3JkZXJzLnRvcCxcbiAgICAgICAgcmlnaHRXaWR0aDogbmluZVNsaWNlQm9yZGVycy5yaWdodCxcbiAgICAgICAgYm90dG9tSGVpZ2h0OiBuaW5lU2xpY2VCb3JkZXJzLmJvdHRvbSxcbiAgICAgICAgd2lkdGgsXG4gICAgICAgIGhlaWdodFxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMubmluZVNsaWNlU3ByaXRlKTtcblxuICAgICAgLy8gQ3JlYXRlIHByZXNzZWQgc3RhdGUgc3ByaXRlIGlmIHByb3ZpZGVkXG4gICAgICBpZiAocHJlc3NlZFRleHR1cmVQYXR0ZXJuKSB7XG4gICAgICAgIGNvbnN0IHByZXNzZWRUZXh0dXJlTmFtZSA9IHByZXNzZWRUZXh0dXJlUGF0dGVybi5pbmNsdWRlcygne2NvbG9yfScpXG4gICAgICAgICAgPyBwcmVzc2VkVGV4dHVyZVBhdHRlcm4ucmVwbGFjZSgne2NvbG9yfScsIGNvbG9yKVxuICAgICAgICAgIDogcHJlc3NlZFRleHR1cmVQYXR0ZXJuO1xuICAgICAgICBjb25zdCBwcmVzc2VkVGV4dHVyZSA9IHNwcml0ZXNoZWV0LnRleHR1cmVzW3ByZXNzZWRUZXh0dXJlTmFtZV07XG5cbiAgICAgICAgdGhpcy5uaW5lU2xpY2VTcHJpdGVQcmVzc2VkID0gbmV3IFBJWEkuTmluZVNsaWNlU3ByaXRlKHtcbiAgICAgICAgICB0ZXh0dXJlOiBwcmVzc2VkVGV4dHVyZSxcbiAgICAgICAgICBsZWZ0V2lkdGg6IG5pbmVTbGljZUJvcmRlcnMubGVmdCxcbiAgICAgICAgICB0b3BIZWlnaHQ6IG5pbmVTbGljZUJvcmRlcnMudG9wLFxuICAgICAgICAgIHJpZ2h0V2lkdGg6IG5pbmVTbGljZUJvcmRlcnMucmlnaHQsXG4gICAgICAgICAgYm90dG9tSGVpZ2h0OiBuaW5lU2xpY2VCb3JkZXJzLmJvdHRvbSxcbiAgICAgICAgICB3aWR0aCxcbiAgICAgICAgICBoZWlnaHRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gT2Zmc2V0IHByZXNzZWQgc3RhdGUgZG93biBieSA0IHBpeGVscyB0byBtYXRjaCB0aGUgYmV2ZWwgaGVpZ2h0XG4gICAgICAgIHRoaXMubmluZVNsaWNlU3ByaXRlUHJlc3NlZC55ID0gNDtcbiAgICAgICAgdGhpcy5uaW5lU2xpY2VTcHJpdGVQcmVzc2VkLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5uaW5lU2xpY2VTcHJpdGVQcmVzc2VkKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVXNlIHRocmVlLXBpZWNlIGhvcml6b250YWwgc3ByaXRlc1xuICAgICAgY29uc3QgbGVmdFRleHR1cmVOYW1lID0gdGhpcy5nZXRUZXh0dXJlTmFtZSh0ZXh0dXJlUGF0dGVybiwgY29sb3IsICdsZWZ0Jyk7XG4gICAgICBjb25zdCBtaWRUZXh0dXJlTmFtZSA9IHRoaXMuZ2V0VGV4dHVyZU5hbWUodGV4dHVyZVBhdHRlcm4sIGNvbG9yLCAnbWlkJyk7XG4gICAgICBjb25zdCByaWdodFRleHR1cmVOYW1lID0gdGhpcy5nZXRUZXh0dXJlTmFtZSh0ZXh0dXJlUGF0dGVybiwgY29sb3IsICdyaWdodCcpO1xuXG4gICAgICB0aGlzLnNwcml0ZUxlZnQgPSBuZXcgUElYSS5TcHJpdGUoc3ByaXRlc2hlZXQudGV4dHVyZXNbbGVmdFRleHR1cmVOYW1lXSk7XG4gICAgICB0aGlzLnNwcml0ZU1pZCA9IG5ldyBQSVhJLlNwcml0ZShzcHJpdGVzaGVldC50ZXh0dXJlc1ttaWRUZXh0dXJlTmFtZV0pO1xuICAgICAgdGhpcy5zcHJpdGVSaWdodCA9IG5ldyBQSVhJLlNwcml0ZShzcHJpdGVzaGVldC50ZXh0dXJlc1tyaWdodFRleHR1cmVOYW1lXSk7XG5cbiAgICAgIC8vIFNjYWxlIHRvIG1hdGNoIGJ1dHRvbiBoZWlnaHRcbiAgICAgIGNvbnN0IHNjYWxlWSA9IGhlaWdodCAvIHRoaXMuc3ByaXRlTGVmdC5oZWlnaHQ7XG4gICAgICB0aGlzLnNwcml0ZUxlZnQuc2NhbGUueSA9IHNjYWxlWTtcbiAgICAgIHRoaXMuc3ByaXRlTWlkLnNjYWxlLnkgPSBzY2FsZVk7XG4gICAgICB0aGlzLnNwcml0ZVJpZ2h0LnNjYWxlLnkgPSBzY2FsZVk7XG5cbiAgICAgIC8vIFBvc2l0aW9uIHNwcml0ZXMgaG9yaXpvbnRhbGx5XG4gICAgICB0aGlzLnNwcml0ZUxlZnQueCA9IDA7XG5cbiAgICAgIGNvbnN0IG1pZGRsZVdpZHRoID0gd2lkdGggLSB0aGlzLnNwcml0ZUxlZnQud2lkdGggLSB0aGlzLnNwcml0ZVJpZ2h0LndpZHRoO1xuICAgICAgdGhpcy5zcHJpdGVNaWQud2lkdGggPSBtaWRkbGVXaWR0aDtcbiAgICAgIHRoaXMuc3ByaXRlTWlkLnggPSB0aGlzLnNwcml0ZUxlZnQud2lkdGg7XG5cbiAgICAgIHRoaXMuc3ByaXRlUmlnaHQueCA9IHRoaXMuc3ByaXRlTGVmdC53aWR0aCArIG1pZGRsZVdpZHRoO1xuXG4gICAgICAvLyBBZGQgdG8gY29udGFpbmVyXG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnNwcml0ZUxlZnQpO1xuICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5zcHJpdGVNaWQpO1xuICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5zcHJpdGVSaWdodCk7XG4gICAgfVxuXG4gICAgLy8gQWRkIGljb24gaWYgcHJvdmlkZWRcbiAgICBpZiAoaWNvbikge1xuICAgICAgY29uc3QgaWNvblRleHR1cmUgPSBpY29uLnNwcml0ZXNoZWV0LnRleHR1cmVzW2ljb24udGV4dHVyZU5hbWVdO1xuICAgICAgdGhpcy5pY29uU3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKGljb25UZXh0dXJlKTtcblxuICAgICAgaWYgKGljb24ucGl4ZWxQZXJmZWN0ICYmIGljb24uc3ByaXRlc2hlZXQudGV4dHVyZVNvdXJjZSkge1xuICAgICAgICBpY29uLnNwcml0ZXNoZWV0LnRleHR1cmVTb3VyY2Uuc2NhbGVNb2RlID0gJ25lYXJlc3QnO1xuICAgICAgfVxuXG4gICAgICBpZiAoaWNvbi5zY2FsZSkge1xuICAgICAgICB0aGlzLmljb25TcHJpdGUuc2NhbGUuc2V0KGljb24uc2NhbGUpO1xuICAgICAgfVxuXG4gICAgICAvLyBDZW50ZXIgdGhlIGljb25cbiAgICAgIHRoaXMuaWNvblNwcml0ZS5hbmNob3Iuc2V0KDAuNSk7XG4gICAgICB0aGlzLmljb25TcHJpdGUueCA9IHdpZHRoIC8gMjtcbiAgICAgIHRoaXMuaWNvblNwcml0ZS55ID0gaGVpZ2h0IC8gMjtcblxuICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5pY29uU3ByaXRlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5jb250YWluZXI7XG4gIH1cblxuICB1cGRhdGVTdGF0ZShzdGF0ZTogQnV0dG9uU3RhdGUpOiB2b2lkIHtcbiAgICAvLyBIYW5kbGUgdXAvZG93biBzdGF0ZSBzd2l0Y2hpbmcgZm9yIDktc2xpY2Ugc3ByaXRlc1xuICAgIGlmICh0aGlzLm5pbmVTbGljZVNwcml0ZSAmJiB0aGlzLm5pbmVTbGljZVNwcml0ZVByZXNzZWQpIHtcbiAgICAgIGNvbnN0IGlzUHJlc3NlZCA9IHN0YXRlID09PSBCdXR0b25TdGF0ZS5QcmVzc2VkO1xuICAgICAgdGhpcy5uaW5lU2xpY2VTcHJpdGUudmlzaWJsZSA9ICFpc1ByZXNzZWQ7XG4gICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZVByZXNzZWQudmlzaWJsZSA9IGlzUHJlc3NlZDtcblxuICAgICAgLy8gT2Zmc2V0IGljb24gd2hlbiBwcmVzc2VkXG4gICAgICBpZiAodGhpcy5pY29uU3ByaXRlKSB7XG4gICAgICAgIHRoaXMuaWNvblNwcml0ZS55ID0gKHRoaXMuaGVpZ2h0IC8gMikgKyAoaXNQcmVzc2VkID8gNCA6IDApO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBVc2UgdGludGluZyBmb3Igc3RhdGVzIHdoZW4gbm8gcHJlc3NlZCB0ZXh0dXJlIGlzIGF2YWlsYWJsZVxuICAgICAgbGV0IHRpbnQ6IG51bWJlcjtcbiAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgY2FzZSBCdXR0b25TdGF0ZS5Ob3JtYWw6XG4gICAgICAgICAgdGludCA9IDB4ZmZmZmZmO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEJ1dHRvblN0YXRlLkhvdmVyOlxuICAgICAgICAgIHRpbnQgPSAweGNjY2NjYztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBCdXR0b25TdGF0ZS5QcmVzc2VkOlxuICAgICAgICAgIHRpbnQgPSAweDk5OTk5OTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBCdXR0b25TdGF0ZS5EaXNhYmxlZDpcbiAgICAgICAgICB0aW50ID0gMHg4ODg4ODg7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLm5pbmVTbGljZVNwcml0ZSkge1xuICAgICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZS50aW50ID0gdGludDtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5zcHJpdGVMZWZ0ICYmIHRoaXMuc3ByaXRlTWlkICYmIHRoaXMuc3ByaXRlUmlnaHQpIHtcbiAgICAgICAgdGhpcy5zcHJpdGVMZWZ0LnRpbnQgPSB0aW50O1xuICAgICAgICB0aGlzLnNwcml0ZU1pZC50aW50ID0gdGludDtcbiAgICAgICAgdGhpcy5zcHJpdGVSaWdodC50aW50ID0gdGludDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXRBY3R1YWxIZWlnaHQoKTogbnVtYmVyIHtcbiAgICBpZiAodGhpcy5uaW5lU2xpY2VTcHJpdGUpIHtcbiAgICAgIHJldHVybiB0aGlzLm5pbmVTbGljZVNwcml0ZS5oZWlnaHQ7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnNwcml0ZUxlZnQ/LmhlaWdodCA/PyB0aGlzLmhlaWdodDtcbiAgfVxuXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXI/LmRlc3Ryb3koeyBjaGlsZHJlbjogdHJ1ZSB9KTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VGV4dHVyZU5hbWUocGF0dGVybjogc3RyaW5nLCBjb2xvcjogc3RyaW5nLCBwYXJ0OiAnbGVmdCcgfCAnbWlkJyB8ICdyaWdodCcpOiBzdHJpbmcge1xuICAgIC8vIFJlcGxhY2Uge2NvbG9yfSBwbGFjZWhvbGRlciBhbmQgZW5zdXJlIGNvcnJlY3QgcGFydFxuICAgIGxldCBuYW1lID0gcGF0dGVybi5yZXBsYWNlKCd7Y29sb3J9JywgY29sb3IpO1xuXG4gICAgLy8gUmVwbGFjZSBhbnkgZXhpc3RpbmcgcGFydCBzdWZmaXggd2l0aCB0aGUgZGVzaXJlZCBvbmVcbiAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC9fKD86bGVmdHxtaWR8cmlnaHQpXFwucG5nJC8sIGBfJHtwYXJ0fS5wbmdgKTtcblxuICAgIHJldHVybiBuYW1lO1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcblxuLyoqXG4gKiBQcm9wcyBmb3IgY29uZmlndXJpbmcgYSBVSUJveFxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFVJQm94UHJvcHMge1xuICAvKiogQmFja2dyb3VuZCBjb2xvciAoaGV4IG51bWJlciwgZS5nLiwgMHhmZjAwMDAgZm9yIHJlZCkgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogQmFja2dyb3VuZCBhbHBoYS9vcGFjaXR5ICgwLTEpICovXG4gIGJhY2tncm91bmRBbHBoYT86IG51bWJlcjtcbiAgLyoqIEJvcmRlciBjb2xvciAqL1xuICBib3JkZXJDb2xvcj86IG51bWJlcjtcbiAgLyoqIEJvcmRlciB3aWR0aCBpbiBwaXhlbHMgKi9cbiAgYm9yZGVyV2lkdGg/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgcmFkaXVzIGZvciByb3VuZGVkIGNvcm5lcnMgKi9cbiAgYm9yZGVyUmFkaXVzPzogbnVtYmVyO1xuICAvKiogRml4ZWQgd2lkdGggKi9cbiAgd2lkdGg/OiBudW1iZXI7XG4gIC8qKiBGaXhlZCBoZWlnaHQgKi9cbiAgaGVpZ2h0PzogbnVtYmVyO1xufVxuXG4vKipcbiAqIEEgc2ltcGxlIHJlY3Rhbmd1bGFyIGJveCBjb21wb25lbnQgd2l0aCBvcHRpb25hbCBiYWNrZ3JvdW5kIGFuZCBib3JkZXJcbiAqIEZvdW5kYXRpb24gZm9yIHBhbmVscywgYnV0dG9ucywgYW5kIG90aGVyIHZpc3VhbCBVSSBlbGVtZW50c1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBib3ggPSBuZXcgVUlCb3goe1xuICogICBiYWNrZ3JvdW5kQ29sb3I6IDB4NGE5MGUyLFxuICogICB3aWR0aDogMjAwLFxuICogICBoZWlnaHQ6IDEwMCxcbiAqICAgYm9yZGVyUmFkaXVzOiA4XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlCb3ggZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFVJQm94UHJvcHM7XG4gIHByaXZhdGUgZ3JhcGhpY3M6IFBJWEkuR3JhcGhpY3M7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJQm94UHJvcHMgPSB7fSwgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcbiAgICB0aGlzLnByb3BzID0ge1xuICAgICAgYmFja2dyb3VuZENvbG9yOiAweDAwMDAwMCxcbiAgICAgIGJhY2tncm91bmRBbHBoYTogMSxcbiAgICAgIGJvcmRlcldpZHRoOiAwLFxuICAgICAgYm9yZGVyUmFkaXVzOiAwLFxuICAgICAgLi4ucHJvcHNcbiAgICB9O1xuXG4gICAgLy8gQ3JlYXRlIGdyYXBoaWNzIG9iamVjdCBmb3IgcmVuZGVyaW5nXG4gICAgdGhpcy5ncmFwaGljcyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5ncmFwaGljcyk7XG5cbiAgICAvLyBTZXQgYm94IG1vZGVsIGRpbWVuc2lvbnMgaWYgcHJvdmlkZWRcbiAgICBpZiAocHJvcHMud2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5ib3hNb2RlbC53aWR0aCA9IHByb3BzLndpZHRoO1xuICAgIH1cbiAgICBpZiAocHJvcHMuaGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID0gcHJvcHMuaGVpZ2h0O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgYm94XG4gICAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICBjb25zdCBib3JkZXIgPSB0aGlzLmJveE1vZGVsLmJvcmRlcjtcblxuICAgIC8vIENhbGN1bGF0ZSBjb250ZW50IHNpemVcbiAgICBsZXQgY29udGVudFdpZHRoID0gMDtcbiAgICBsZXQgY29udGVudEhlaWdodCA9IDA7XG5cbiAgICBpZiAodHlwZW9mIHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdudW1iZXInKSB7XG4gICAgICBjb250ZW50V2lkdGggPSB0aGlzLmJveE1vZGVsLndpZHRoO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy53aWR0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb250ZW50V2lkdGggPSB0aGlzLnByb3BzLndpZHRoO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdudW1iZXInKSB7XG4gICAgICBjb250ZW50SGVpZ2h0ID0gdGhpcy5ib3hNb2RlbC5oZWlnaHQ7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLmhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb250ZW50SGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG4gICAgfVxuXG4gICAgLy8gQWRkIHBhZGRpbmcgYW5kIGJvcmRlclxuICAgIGNvbnN0IHRvdGFsV2lkdGggPSBjb250ZW50V2lkdGggKyBwYWRkaW5nLmhvcml6b250YWwgKyAoYm9yZGVyPy5ob3Jpem9udGFsID8/IDApO1xuICAgIGNvbnN0IHRvdGFsSGVpZ2h0ID0gY29udGVudEhlaWdodCArIHBhZGRpbmcudmVydGljYWwgKyAoYm9yZGVyPy52ZXJ0aWNhbCA/PyAwKTtcblxuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogTWF0aC5tYXgodG90YWxXaWR0aCwgdGhpcy5ib3hNb2RlbC5taW5XaWR0aCA/PyAwKSxcbiAgICAgIGhlaWdodDogTWF0aC5tYXgodG90YWxIZWlnaHQsIHRoaXMuYm94TW9kZWwubWluSGVpZ2h0ID8/IDApXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBsYXlvdXQgZm9yIHRoaXMgYm94XG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG4gICAgY29uc3QgYm9yZGVyID0gdGhpcy5ib3hNb2RlbC5ib3JkZXIgPz8geyBob3Jpem9udGFsOiAwLCB2ZXJ0aWNhbDogMCwgdG9wOiAwLCByaWdodDogMCwgYm90dG9tOiAwLCBsZWZ0OiAwIH07XG5cbiAgICAvLyBDYWxjdWxhdGUgZmluYWwgZGltZW5zaW9uc1xuICAgIGxldCBmaW5hbFdpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgbGV0IGZpbmFsSGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgLy8gSGFuZGxlICdmaWxsJyBjb25zdHJhaW50XG4gICAgaWYgKHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdmaWxsJykge1xuICAgICAgZmluYWxXaWR0aCA9IGF2YWlsYWJsZVdpZHRoO1xuICAgIH1cbiAgICBpZiAodGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdmaWxsJykge1xuICAgICAgZmluYWxIZWlnaHQgPSBhdmFpbGFibGVIZWlnaHQ7XG4gICAgfVxuXG4gICAgLy8gQXBwbHkgbWF4IGNvbnN0cmFpbnRzXG4gICAgaWYgKHRoaXMuYm94TW9kZWwubWF4V2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgZmluYWxXaWR0aCA9IE1hdGgubWluKGZpbmFsV2lkdGgsIHRoaXMuYm94TW9kZWwubWF4V2lkdGgpO1xuICAgIH1cbiAgICBpZiAodGhpcy5ib3hNb2RlbC5tYXhIZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZmluYWxIZWlnaHQgPSBNYXRoLm1pbihmaW5hbEhlaWdodCwgdGhpcy5ib3hNb2RlbC5tYXhIZWlnaHQpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb21wdXRlZCBsYXlvdXRcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gZmluYWxXaWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IGZpbmFsSGVpZ2h0O1xuXG4gICAgLy8gQ29udGVudCBhcmVhIChpbnNpZGUgcGFkZGluZyBhbmQgYm9yZGVyKVxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFggPSBwYWRkaW5nLmxlZnQgKyBib3JkZXIubGVmdDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRZID0gcGFkZGluZy50b3AgKyBib3JkZXIudG9wO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFdpZHRoID0gZmluYWxXaWR0aCAtIHBhZGRpbmcuaG9yaXpvbnRhbCAtIGJvcmRlci5ob3Jpem9udGFsO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudEhlaWdodCA9IGZpbmFsSGVpZ2h0IC0gcGFkZGluZy52ZXJ0aWNhbCAtIGJvcmRlci52ZXJ0aWNhbDtcblxuICAgIHRoaXMubGF5b3V0RGlydHkgPSBmYWxzZTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIGJveCB2aXN1YWxzXG4gICAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcblxuICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gdGhpcy5jb21wdXRlZExheW91dDtcbiAgICBjb25zdCB7IGJhY2tncm91bmRDb2xvciwgYmFja2dyb3VuZEFscGhhLCBib3JkZXJDb2xvciwgYm9yZGVyV2lkdGgsIGJvcmRlclJhZGl1cyB9ID0gdGhpcy5wcm9wcztcblxuICAgIC8vIERyYXcgYm9yZGVyIGlmIHNwZWNpZmllZFxuICAgIGlmIChib3JkZXJXaWR0aCAmJiBib3JkZXJXaWR0aCA+IDAgJiYgYm9yZGVyQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5ncmFwaGljcy5yZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2UoeyBjb2xvcjogYm9yZGVyQ29sb3IsIHdpZHRoOiBib3JkZXJXaWR0aCB9KTtcbiAgICB9XG5cbiAgICAvLyBEcmF3IGJhY2tncm91bmRcbiAgICBpZiAoYmFja2dyb3VuZENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmIChib3JkZXJSYWRpdXMgJiYgYm9yZGVyUmFkaXVzID4gMCkge1xuICAgICAgICB0aGlzLmdyYXBoaWNzLnJvdW5kUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0LCBib3JkZXJSYWRpdXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5ncmFwaGljcy5yZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgfVxuICAgICAgdGhpcy5ncmFwaGljcy5maWxsKHsgY29sb3I6IGJhY2tncm91bmRDb2xvciwgYWxwaGE6IGJhY2tncm91bmRBbHBoYSB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgYmFja2dyb3VuZCBjb2xvclxuICAgKi9cbiAgc2V0QmFja2dyb3VuZENvbG9yKGNvbG9yOiBudW1iZXIsIGFscGhhOiBudW1iZXIgPSAxKTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcbiAgICB0aGlzLnByb3BzLmJhY2tncm91bmRBbHBoYSA9IGFscGhhO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgYm9yZGVyXG4gICAqL1xuICBzZXRCb3JkZXIoY29sb3I6IG51bWJlciwgd2lkdGg6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMucHJvcHMuYm9yZGVyQ29sb3IgPSBjb2xvcjtcbiAgICB0aGlzLnByb3BzLmJvcmRlcldpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5pbXBvcnQgeyBVSUxhYmVsIH0gZnJvbSAnLi91aS1sYWJlbCc7XG5pbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi4vY29yZS9lZGdlLWluc2V0cyc7XG5pbXBvcnQgeyBVSUZvY3VzTWFuYWdlciB9IGZyb20gJy4uL2NvcmUvdWktZm9jdXMtbWFuYWdlcic7XG5pbXBvcnQge1xuICBCdXR0b25CYWNrZ3JvdW5kU3RyYXRlZ3ksXG4gIFNvbGlkQ29sb3JCYWNrZ3JvdW5kU3RyYXRlZ3ksXG4gIFNwcml0ZUJhY2tncm91bmRTdHJhdGVneSxcbiAgU3ByaXRlQmFja2dyb3VuZENvbmZpZ1xufSBmcm9tICcuL2J1dHRvbi1iYWNrZ3JvdW5kLXN0cmF0ZWd5JztcblxuLyoqIEJ1dHRvbiB2aXN1YWwgc3RhdGVzLiAqL1xuZXhwb3J0IGVudW0gQnV0dG9uU3RhdGUge1xuICBOb3JtYWwgPSAnbm9ybWFsJyxcbiAgSG92ZXIgPSAnaG92ZXInLFxuICBQcmVzc2VkID0gJ3ByZXNzZWQnLFxuICBEaXNhYmxlZCA9ICdkaXNhYmxlZCdcbn1cblxuLy8gUmUtZXhwb3J0IFNwcml0ZUJhY2tncm91bmRDb25maWcgZm9yIGNvbnZlbmllbmNlXG5leHBvcnQgdHlwZSB7IFNwcml0ZUJhY2tncm91bmRDb25maWcgfSBmcm9tICcuL2J1dHRvbi1iYWNrZ3JvdW5kLXN0cmF0ZWd5JztcblxuLyoqIFVJQnV0dG9uIGNvbmZpZ3VyYXRpb24uICovXG5leHBvcnQgaW50ZXJmYWNlIFVJQnV0dG9uUHJvcHMge1xuICAvKiogQnV0dG9uIGxhYmVsIHRleHQgKi9cbiAgbGFiZWw/OiBzdHJpbmc7XG4gIC8qKiBCdXR0b24gd2lkdGggKi9cbiAgd2lkdGg/OiBudW1iZXI7XG4gIC8qKiBCdXR0b24gaGVpZ2h0ICovXG4gIGhlaWdodD86IG51bWJlcjtcbiAgLyoqIEJhY2tncm91bmQgY29sb3IgKG9ubHkgdXNlZCBpZiBzcHJpdGVCYWNrZ3JvdW5kIGlzIG5vdCBwcm92aWRlZCkgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogU3ByaXRlLWJhc2VkIGJhY2tncm91bmQgY29uZmlndXJhdGlvbiAqL1xuICBzcHJpdGVCYWNrZ3JvdW5kPzogU3ByaXRlQmFja2dyb3VuZENvbmZpZztcbiAgLyoqIFRleHQgY29sb3IgKi9cbiAgdGV4dENvbG9yPzogbnVtYmVyO1xuICAvKiogRm9udCBzaXplICovXG4gIGZvbnRTaXplPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyAob25seSB1c2VkIHdpdGggYmFja2dyb3VuZENvbG9yKSAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG4gIC8qKiBQYWRkaW5nIGluc2lkZSBidXR0b24gKi9cbiAgcGFkZGluZz86IEVkZ2VJbnNldHM7XG4gIC8qKiBVc2UgQml0bWFwVGV4dCBpbnN0ZWFkIG9mIHJlZ3VsYXIgdGV4dCAqL1xuICB1c2VCaXRtYXBUZXh0PzogYm9vbGVhbjtcbiAgLyoqIEJpdG1hcFRleHQgZm9udCBmYW1pbHkgKHJlcXVpcmVkIGlmIHVzZUJpdG1hcFRleHQgaXMgdHJ1ZSkgKi9cbiAgYml0bWFwRm9udEZhbWlseT86IHN0cmluZztcbiAgLyoqIENsaWNrIGNhbGxiYWNrICovXG4gIG9uQ2xpY2s/OiAoKSA9PiB2b2lkO1xuICAvKiogSG92ZXIgY2FsbGJhY2sgKi9cbiAgb25Ib3Zlcj86ICgpID0+IHZvaWQ7XG4gIC8qKiBFbmFibGVkIHN0YXRlICovXG4gIGVuYWJsZWQ/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIEludGVyYWN0aXZlIGJ1dHRvbiBjb21wb25lbnQgd2l0aCBob3ZlciwgcHJlc3MsIGFuZCBkaXNhYmxlZCBzdGF0ZXMuXG4gKiBTdXBwb3J0cyBzb2xpZCBjb2xvciBvciBzcHJpdGUtYmFzZWQgYmFja2dyb3VuZHMsIGJpdG1hcCB0ZXh0LCBhbmQga2V5Ym9hcmQgZm9jdXMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiAvLyBCYXNpYyBidXR0b25cbiAqIGNvbnN0IGJ0biA9IG5ldyBVSUJ1dHRvbih7XG4gKiAgIGxhYmVsOiAnQ2xpY2sgTWUnLFxuICogICB3aWR0aDogMTUwLFxuICogICBoZWlnaHQ6IDQwLFxuICogICBiYWNrZ3JvdW5kQ29sb3I6IDB4NGE5MGUyLFxuICogICB0ZXh0Q29sb3I6IDB4ZmZmZmZmLFxuICogICBvbkNsaWNrOiAoKSA9PiBjb25zb2xlLmxvZygnY2xpY2tlZCcpXG4gKiB9KTtcbiAqXG4gKiAvLyBTcHJpdGUtYmFzZWQgYnV0dG9uXG4gKiBjb25zdCBzcHJpdGVCdG4gPSBuZXcgVUlCdXR0b24oe1xuICogICBsYWJlbDogJ1BsYXknLFxuICogICBzcHJpdGVCYWNrZ3JvdW5kOiB7XG4gKiAgICAgbm9ybWFsOiBub3JtYWxUZXh0dXJlLFxuICogICAgIGhvdmVyOiBob3ZlclRleHR1cmUsXG4gKiAgICAgcHJlc3NlZDogcHJlc3NlZFRleHR1cmVcbiAqICAgfVxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJQnV0dG9uIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxPbWl0PFVJQnV0dG9uUHJvcHMsICdvbkNsaWNrJyB8ICdvbkhvdmVyJyB8ICdzcHJpdGVCYWNrZ3JvdW5kJyB8ICd1c2VCaXRtYXBUZXh0JyB8ICdiaXRtYXBGb250RmFtaWx5Jz4+O1xuICBwcml2YXRlIHVzZUJpdG1hcFRleHQ6IGJvb2xlYW47XG4gIHByaXZhdGUgYml0bWFwRm9udEZhbWlseT86IHN0cmluZztcbiAgcHJpdmF0ZSBvbkNsaWNrPzogKCkgPT4gdm9pZDtcbiAgcHJpdmF0ZSBvbkhvdmVyPzogKCkgPT4gdm9pZDtcblxuICBwcml2YXRlIHN0YXRlOiBCdXR0b25TdGF0ZSA9IEJ1dHRvblN0YXRlLk5vcm1hbDtcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kU3RyYXRlZ3k6IEJ1dHRvbkJhY2tncm91bmRTdHJhdGVneTtcbiAgcHJpdmF0ZSBsYWJlbD86IFVJTGFiZWw7XG4gIHByaXZhdGUgYml0bWFwTGFiZWw/OiBQSVhJLkJpdG1hcFRleHQ7XG5cbiAgLy8gQ2FjaGVkIGxhYmVsIGNlbnRlciBwb3NpdGlvblxuICBwcml2YXRlIGxhYmVsQ2VudGVyWDogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBsYWJlbENlbnRlclk6IG51bWJlciA9IDA7XG5cbiAgLy8gS2V5Ym9hcmQgaGFuZGxlciBmb3IgY2xlYW51cFxuICBwcml2YXRlIGtleWRvd25IYW5kbGVyPzogKGU6IEtleWJvYXJkRXZlbnQpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJQnV0dG9uUHJvcHMgPSB7fSwgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBsYWJlbDogcHJvcHMubGFiZWwgPz8gJycsXG4gICAgICB3aWR0aDogcHJvcHMud2lkdGggPz8gMTIwLFxuICAgICAgaGVpZ2h0OiBwcm9wcy5oZWlnaHQgPz8gNDAsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHByb3BzLmJhY2tncm91bmRDb2xvciA/PyAweDRhOTBlMixcbiAgICAgIHRleHRDb2xvcjogcHJvcHMudGV4dENvbG9yID8/IDB4ZmZmZmZmLFxuICAgICAgZm9udFNpemU6IHByb3BzLmZvbnRTaXplID8/IDE2LFxuICAgICAgYm9yZGVyUmFkaXVzOiBwcm9wcy5ib3JkZXJSYWRpdXMgPz8gNCxcbiAgICAgIHBhZGRpbmc6IHByb3BzLnBhZGRpbmcgPz8gRWRnZUluc2V0cy5zeW1tZXRyaWMoOCwgMTYpLFxuICAgICAgZW5hYmxlZDogcHJvcHMuZW5hYmxlZCA/PyB0cnVlXG4gICAgfTtcblxuICAgIHRoaXMudXNlQml0bWFwVGV4dCA9IHByb3BzLnVzZUJpdG1hcFRleHQgPz8gZmFsc2U7XG4gICAgdGhpcy5iaXRtYXBGb250RmFtaWx5ID0gcHJvcHMuYml0bWFwRm9udEZhbWlseTtcbiAgICB0aGlzLm9uQ2xpY2sgPSBwcm9wcy5vbkNsaWNrO1xuICAgIHRoaXMub25Ib3ZlciA9IHByb3BzLm9uSG92ZXI7XG5cbiAgICAvLyBTZXQgYm94IG1vZGVsIGRpbWVuc2lvbnNcbiAgICB0aGlzLmJveE1vZGVsLndpZHRoID0gdGhpcy5wcm9wcy53aWR0aDtcbiAgICB0aGlzLmJveE1vZGVsLmhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuXG4gICAgLy8gTWFrZSBidXR0b25zIGZvY3VzYWJsZSBieSBkZWZhdWx0XG4gICAgdGhpcy50YWJJbmRleCA9IDA7XG5cbiAgICAvLyBDcmVhdGUgYmFja2dyb3VuZCBzdHJhdGVneSBiYXNlZCBvbiBjb25maWd1cmF0aW9uXG4gICAgaWYgKHByb3BzLnNwcml0ZUJhY2tncm91bmQpIHtcbiAgICAgIHRoaXMuYmFja2dyb3VuZFN0cmF0ZWd5ID0gbmV3IFNwcml0ZUJhY2tncm91bmRTdHJhdGVneShcbiAgICAgICAgcHJvcHMuc3ByaXRlQmFja2dyb3VuZCxcbiAgICAgICAgdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgICAgdGhpcy5wcm9wcy5oZWlnaHRcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYmFja2dyb3VuZFN0cmF0ZWd5ID0gbmV3IFNvbGlkQ29sb3JCYWNrZ3JvdW5kU3RyYXRlZ3koXG4gICAgICAgIHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgICB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgICB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgICAgdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGFuZCBhZGQgYmFja2dyb3VuZFxuICAgIGNvbnN0IGJhY2tncm91bmRDb250YWluZXIgPSB0aGlzLmJhY2tncm91bmRTdHJhdGVneS5jcmVhdGUodGhpcy5wcm9wcy53aWR0aCwgdGhpcy5wcm9wcy5oZWlnaHQpO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKGJhY2tncm91bmRDb250YWluZXIpO1xuXG4gICAgLy8gQ3JlYXRlIGxhYmVsIGlmIHRleHQgcHJvdmlkZWRcbiAgICBpZiAodGhpcy5wcm9wcy5sYWJlbCkge1xuICAgICAgaWYgKHRoaXMudXNlQml0bWFwVGV4dCAmJiB0aGlzLmJpdG1hcEZvbnRGYW1pbHkpIHtcbiAgICAgICAgdGhpcy5jcmVhdGVCaXRtYXBMYWJlbCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5sYWJlbCA9IG5ldyBVSUxhYmVsKHtcbiAgICAgICAgICB0ZXh0OiB0aGlzLnByb3BzLmxhYmVsLFxuICAgICAgICAgIGZvbnRTaXplOiB0aGlzLnByb3BzLmZvbnRTaXplLFxuICAgICAgICAgIGNvbG9yOiB0aGlzLnByb3BzLnRleHRDb2xvcixcbiAgICAgICAgICBhbGlnbjogJ2NlbnRlcidcbiAgICAgICAgfSwge1xuICAgICAgICAgIHBhZGRpbmc6IEVkZ2VJbnNldHMuemVybygpXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmxhYmVsLmNvbnRhaW5lcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2V0dXAgaW50ZXJhY3Rpdml0eVxuICAgIHRoaXMuc2V0dXBJbnRlcmFjdGl2aXR5KCk7XG5cbiAgICAvLyBJbml0aWFsIHN0YXRlXG4gICAgaWYgKCF0aGlzLnByb3BzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuRGlzYWJsZWQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBjcmVhdGVCaXRtYXBMYWJlbCgpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYml0bWFwRm9udEZhbWlseSkgcmV0dXJuO1xuXG4gICAgdGhpcy5iaXRtYXBMYWJlbCA9IG5ldyBQSVhJLkJpdG1hcFRleHQoe1xuICAgICAgdGV4dDogdGhpcy5wcm9wcy5sYWJlbCxcbiAgICAgIHN0eWxlOiB7XG4gICAgICAgIGZvbnRGYW1pbHk6IHRoaXMuYml0bWFwRm9udEZhbWlseSxcbiAgICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMuZm9udFNpemUsXG4gICAgICAgIGZpbGw6IHRoaXMucHJvcHMudGV4dENvbG9yXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmJpdG1hcExhYmVsKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBzZXR1cEludGVyYWN0aXZpdHkoKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgdGhpcy5jb250YWluZXIuY3Vyc29yID0gJ3BvaW50ZXInO1xuXG4gICAgdGhpcy5jb250YWluZXIub24oJ3BvaW50ZXJvdmVyJywgdGhpcy5oYW5kbGVQb2ludGVyT3Zlci5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmNvbnRhaW5lci5vbigncG9pbnRlcm91dCcsIHRoaXMuaGFuZGxlUG9pbnRlck91dC5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmNvbnRhaW5lci5vbigncG9pbnRlcmRvd24nLCB0aGlzLmhhbmRsZVBvaW50ZXJEb3duLmJpbmQodGhpcykpO1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVydXAnLCB0aGlzLmhhbmRsZVBvaW50ZXJVcC5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmNvbnRhaW5lci5vbigncG9pbnRlcnVwb3V0c2lkZScsIHRoaXMuaGFuZGxlUG9pbnRlclVwT3V0c2lkZS5iaW5kKHRoaXMpKTtcblxuICAgIC8vIEhhbmRsZSBrZXlib2FyZCBpbnRlcmFjdGlvbiB3aGVuIGZvY3VzZWRcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRoaXMua2V5ZG93bkhhbmRsZXIgPSAoZTogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5pc0ZvY3VzZWQoKSAmJiB0aGlzLnByb3BzLmVuYWJsZWQpIHtcbiAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgfHwgZS5rZXkgPT09ICcgJykge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAvLyBTaG93IHByZXNzZWQgc3RhdGVcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuUHJlc3NlZCk7XG5cbiAgICAgICAgICAgIC8vIFRyaWdnZXIgY2xpY2tcbiAgICAgICAgICAgIHRoaXMub25DbGljaz8uKCk7XG5cbiAgICAgICAgICAgIC8vIFJldHVybiB0byBob3ZlciBzdGF0ZSBhZnRlciBhIHNob3J0IGRlbGF5IChzaW11bGF0aW5nIGJ1dHRvbiByZWxlYXNlKVxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKEJ1dHRvblN0YXRlLk5vcm1hbCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmtleWRvd25IYW5kbGVyKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJPdmVyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLmVuYWJsZWQgJiYgdGhpcy5zdGF0ZSA9PT0gQnV0dG9uU3RhdGUuTm9ybWFsKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKEJ1dHRvblN0YXRlLkhvdmVyKTtcbiAgICAgIHRoaXMub25Ib3Zlcj8uKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyT3V0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLmVuYWJsZWQgJiYgdGhpcy5zdGF0ZSAhPT0gQnV0dG9uU3RhdGUuUHJlc3NlZCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5Ob3JtYWwpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlckRvd24oKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5QcmVzc2VkKTtcblxuICAgICAgLy8gUmVxdWVzdCBmb2N1cyB0aHJvdWdoIHRoZSBmb2N1cyBtYW5hZ2VyXG4gICAgICBpZiAodGhpcy5jYW5Gb2N1cygpKSB7XG4gICAgICAgIGNvbnN0IGZvY3VzTWFuYWdlciA9IFVJRm9jdXNNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gICAgICAgIGlmIChmb2N1c01hbmFnZXIpIHtcbiAgICAgICAgICBmb2N1c01hbmFnZXIucmVxdWVzdEZvY3VzKHRoaXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEZhbGxiYWNrIGlmIG5vIGZvY3VzIG1hbmFnZXJcbiAgICAgICAgICB0aGlzLm9uRm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlclVwKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuSG92ZXIpO1xuICAgICAgdGhpcy5vbkNsaWNrPy4oKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJVcE91dHNpZGUoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5Ob3JtYWwpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBzZXRTdGF0ZShuZXdTdGF0ZTogQnV0dG9uU3RhdGUpOiB2b2lkIHtcbiAgICB0aGlzLnN0YXRlID0gbmV3U3RhdGU7XG4gICAgdGhpcy51cGRhdGVWaXN1YWxzKCk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIHByaXZhdGUgdXBkYXRlVmlzdWFscygpOiB2b2lkIHtcbiAgICAvLyBVcGRhdGUgYmFja2dyb3VuZCB1c2luZyBzdHJhdGVneVxuICAgIHRoaXMuYmFja2dyb3VuZFN0cmF0ZWd5LnVwZGF0ZVN0YXRlKHRoaXMuc3RhdGUpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGRlcHRoIG9mZnNldCBmb3IgcHJlc3NlZCBzdGF0ZVxuICAgIGNvbnN0IHlPZmZzZXQgPSB0aGlzLnN0YXRlID09PSBCdXR0b25TdGF0ZS5QcmVzc2VkID8gMiA6IDA7XG5cbiAgICAvLyBVcGRhdGUgY3Vyc29yIGZvciBkaXNhYmxlZCBzdGF0ZVxuICAgIGlmICh0aGlzLnN0YXRlID09PSBCdXR0b25TdGF0ZS5EaXNhYmxlZCkge1xuICAgICAgdGhpcy5jb250YWluZXIuY3Vyc29yID0gJ2RlZmF1bHQnO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNvbnRhaW5lci5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgfVxuXG4gICAgLy8gQXBwbHkgZGVwdGggb2Zmc2V0IHRvIGxhYmVsXG4gICAgaWYgKHRoaXMubGFiZWwpIHtcbiAgICAgIHRoaXMubGFiZWwuc2V0UG9zaXRpb24odGhpcy5sYWJlbENlbnRlclgsIHRoaXMubGFiZWxDZW50ZXJZICsgeU9mZnNldCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmJpdG1hcExhYmVsKSB7XG4gICAgICB0aGlzLmJpdG1hcExhYmVsLnggPSB0aGlzLmxhYmVsQ2VudGVyWDtcbiAgICAgIHRoaXMuYml0bWFwTGFiZWwueSA9IHRoaXMubGFiZWxDZW50ZXJZICsgeU9mZnNldDtcbiAgICB9XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcblxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcblxuICAgIC8vIEdldCBhY3R1YWwgYmFja2dyb3VuZCBoZWlnaHQgZnJvbSBzdHJhdGVneVxuICAgIGNvbnN0IGFjdHVhbEhlaWdodCA9IHRoaXMuYmFja2dyb3VuZFN0cmF0ZWd5LmdldEFjdHVhbEhlaWdodCgpO1xuXG4gICAgLy8gTGF5b3V0IGFuZCBjZW50ZXIgbGFiZWxcbiAgICBpZiAodGhpcy5sYWJlbCkge1xuICAgICAgdGhpcy5sYWJlbC5sYXlvdXQobWVhc3VyZWQud2lkdGgsIG1lYXN1cmVkLmhlaWdodCk7XG5cbiAgICAgIC8vIENlbnRlciB0aGUgbGFiZWwgYW5kIGNhY2hlIHRoZSBwb3NpdGlvblxuICAgICAgY29uc3QgbGFiZWxMYXlvdXQgPSB0aGlzLmxhYmVsLmdldExheW91dCgpO1xuICAgICAgdGhpcy5sYWJlbENlbnRlclggPSAobWVhc3VyZWQud2lkdGggLSBsYWJlbExheW91dC53aWR0aCkgLyAyO1xuICAgICAgdGhpcy5sYWJlbENlbnRlclkgPSAoYWN0dWFsSGVpZ2h0IC0gbGFiZWxMYXlvdXQuaGVpZ2h0KSAvIDI7XG4gICAgICB0aGlzLmxhYmVsLnNldFBvc2l0aW9uKHRoaXMubGFiZWxDZW50ZXJYLCB0aGlzLmxhYmVsQ2VudGVyWSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmJpdG1hcExhYmVsKSB7XG4gICAgICAvLyBDZW50ZXIgdGhlIGJpdG1hcCB0ZXh0IHVzaW5nIGFjdHVhbCBiYWNrZ3JvdW5kIGhlaWdodFxuICAgICAgdGhpcy5sYWJlbENlbnRlclggPSAobWVhc3VyZWQud2lkdGggLSB0aGlzLmJpdG1hcExhYmVsLndpZHRoKSAvIDI7XG4gICAgICB0aGlzLmxhYmVsQ2VudGVyWSA9IChhY3R1YWxIZWlnaHQgLSB0aGlzLmJpdG1hcExhYmVsLmhlaWdodCkgLyAyO1xuICAgICAgdGhpcy5iaXRtYXBMYWJlbC54ID0gdGhpcy5sYWJlbENlbnRlclg7XG4gICAgICB0aGlzLmJpdG1hcExhYmVsLnkgPSB0aGlzLmxhYmVsQ2VudGVyWTtcbiAgICB9XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICAvLyBSZW5kZXJpbmcgaXMgaGFuZGxlZCBieSBiYWNrZ3JvdW5kIGFuZCBsYWJlbFxuICB9XG5cbiAgLyoqIFVwZGF0ZSBidXR0b24gdGV4dC4gKi9cbiAgc2V0TGFiZWwodGV4dDogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHRoaXMubGFiZWwpIHtcbiAgICAgIHRoaXMubGFiZWwuc2V0VGV4dCh0ZXh0KTtcbiAgICAgIHRoaXMubWFya0xheW91dERpcnR5KCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmJpdG1hcExhYmVsKSB7XG4gICAgICB0aGlzLmJpdG1hcExhYmVsLnRleHQgPSB0ZXh0O1xuICAgICAgdGhpcy5tYXJrTGF5b3V0RGlydHkoKTtcbiAgICB9XG4gIH1cblxuICAvKiogRW5hYmxlIG9yIGRpc2FibGUgdGhlIGJ1dHRvbi4gKi9cbiAgc2V0RW5hYmxlZChlbmFibGVkOiBib29sZWFuKTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy5lbmFibGVkID0gZW5hYmxlZDtcbiAgICB0aGlzLnNldFN0YXRlKGVuYWJsZWQgPyBCdXR0b25TdGF0ZS5Ob3JtYWwgOiBCdXR0b25TdGF0ZS5EaXNhYmxlZCk7XG4gIH1cblxuICAvKiogR2V0IGN1cnJlbnQgdmlzdWFsIHN0YXRlLiAqL1xuICBnZXRTdGF0ZSgpOiBCdXR0b25TdGF0ZSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGU7XG4gIH1cblxuICAvKiogQ2xlYW4gdXAgZXZlbnQgbGlzdGVuZXJzLiAqL1xuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB0aGlzLmtleWRvd25IYW5kbGVyKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5ZG93bkhhbmRsZXIpO1xuICAgIH1cbiAgICBzdXBlci5kZXN0cm95KCk7XG4gIH1cblxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5cbi8qKiBUZXh0IGFsaWdubWVudCBvcHRpb25zLiAqL1xuZXhwb3J0IHR5cGUgVGV4dEFsaWduID0gJ2xlZnQnIHwgJ2NlbnRlcicgfCAncmlnaHQnO1xuXG4vKiogVUlMYWJlbCBjb25maWd1cmF0aW9uLiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSUxhYmVsUHJvcHMge1xuICAvKiogVGhlIHRleHQgdG8gZGlzcGxheSAqL1xuICB0ZXh0OiBzdHJpbmc7XG4gIC8qKiBGb250IHNpemUgaW4gcGl4ZWxzICovXG4gIGZvbnRTaXplPzogbnVtYmVyO1xuICAvKiogRm9udCBmYW1pbHkgbmFtZSAqL1xuICBmb250RmFtaWx5Pzogc3RyaW5nO1xuICAvKiogVGV4dCBjb2xvciAoaGV4IG51bWJlcikgKi9cbiAgY29sb3I/OiBudW1iZXI7XG4gIC8qKiBUZXh0IGFsaWdubWVudCAqL1xuICBhbGlnbj86IFRleHRBbGlnbjtcbiAgLyoqIEVuYWJsZSB3b3JkIHdyYXBwaW5nICovXG4gIHdvcmRXcmFwPzogYm9vbGVhbjtcbiAgLyoqIFdvcmQgd3JhcCB3aWR0aCAocmVxdWlyZWQgaWYgd29yZFdyYXAgaXMgdHJ1ZSkgKi9cbiAgd29yZFdyYXBXaWR0aD86IG51bWJlcjtcbiAgLyoqIEZvbnQgd2VpZ2h0ICovXG4gIGZvbnRXZWlnaHQ/OiBzdHJpbmc7XG4gIC8qKiBMaW5lIGhlaWdodCBtdWx0aXBsaWVyICovXG4gIGxpbmVIZWlnaHQ/OiBudW1iZXI7XG59XG5cbi8qKlxuICogVGV4dCBsYWJlbCBjb21wb25lbnQgd3JhcHBpbmcgUElYSS5UZXh0IHdpdGggbGF5b3V0IGludGVncmF0aW9uLlxuICogU3VwcG9ydHMgd29yZCB3cmFwcGluZywgY3VzdG9tIGZvbnRzLCBhbmQgYWxpZ25tZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3QgbGFiZWwgPSBuZXcgVUlMYWJlbCh7XG4gKiAgIHRleHQ6ICdIZWxsbyBXb3JsZCcsXG4gKiAgIGZvbnRTaXplOiAyNCxcbiAqICAgY29sb3I6IDB4ZmZmZmZmLFxuICogICBmb250RmFtaWx5OiAnQXJpYWwnLFxuICogICBhbGlnbjogJ2NlbnRlcidcbiAqIH0pO1xuICpcbiAqIC8vIFdpdGggd29yZCB3cmFwXG4gKiBjb25zdCBwYXJhZ3JhcGggPSBuZXcgVUlMYWJlbCh7XG4gKiAgIHRleHQ6ICdMb25nIHRleHQgdGhhdCBuZWVkcyB3cmFwcGluZy4uLicsXG4gKiAgIHdvcmRXcmFwOiB0cnVlLFxuICogICB3b3JkV3JhcFdpZHRoOiAyMDBcbiAqIH0pO1xuICpcbiAqIC8vIFVwZGF0ZSB0ZXh0IGR5bmFtaWNhbGx5XG4gKiBsYWJlbC5zZXRUZXh0KCdOZXcgdGV4dCcpO1xuICogbGFiZWwuc2V0Q29sb3IoMHhmZjAwMDApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSUxhYmVsIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxVSUxhYmVsUHJvcHM+O1xuICBwcml2YXRlIHRleHRPYmplY3Q6IFBJWEkuVGV4dDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlMYWJlbFByb3BzLCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIHRleHQ6IHByb3BzLnRleHQsXG4gICAgICBmb250U2l6ZTogcHJvcHMuZm9udFNpemUgPz8gMTYsXG4gICAgICBmb250RmFtaWx5OiBwcm9wcy5mb250RmFtaWx5ID8/ICdBcmlhbCcsXG4gICAgICBjb2xvcjogcHJvcHMuY29sb3IgPz8gMHhmZmZmZmYsXG4gICAgICBhbGlnbjogcHJvcHMuYWxpZ24gPz8gJ2xlZnQnLFxuICAgICAgd29yZFdyYXA6IHByb3BzLndvcmRXcmFwID8/IGZhbHNlLFxuICAgICAgd29yZFdyYXBXaWR0aDogcHJvcHMud29yZFdyYXBXaWR0aCA/PyAwLFxuICAgICAgZm9udFdlaWdodDogcHJvcHMuZm9udFdlaWdodCA/PyAnbm9ybWFsJyxcbiAgICAgIGxpbmVIZWlnaHQ6IHByb3BzLmxpbmVIZWlnaHQgPz8gMS4yXG4gICAgfTtcblxuICAgIC8vIENyZWF0ZSBQSVhJLlRleHQgd2l0aCBpbml0aWFsIHN0eWxlXG4gICAgdGhpcy50ZXh0T2JqZWN0ID0gbmV3IFBJWEkuVGV4dCh7XG4gICAgICB0ZXh0OiB0aGlzLnByb3BzLnRleHQsXG4gICAgICBzdHlsZTogdGhpcy5nZXRUZXh0U3R5bGUoKSxcbiAgICAgIHJlc29sdXRpb246IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDIgLy8gTWF0Y2ggZGV2aWNlIHJlc29sdXRpb24gZm9yIGNyaXNwIHRleHRcbiAgICB9KTtcblxuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMudGV4dE9iamVjdCk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIHByaXZhdGUgZ2V0VGV4dFN0eWxlKCk6IFBJWEkuVGV4dFN0eWxlIHtcbiAgICBjb25zdCBzdHlsZTogYW55ID0ge1xuICAgICAgZm9udEZhbWlseTogdGhpcy5wcm9wcy5mb250RmFtaWx5LFxuICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMuZm9udFNpemUsXG4gICAgICBmaWxsOiB0aGlzLnByb3BzLmNvbG9yLFxuICAgICAgYWxpZ246IHRoaXMucHJvcHMuYWxpZ24sXG4gICAgICBmb250V2VpZ2h0OiB0aGlzLnByb3BzLmZvbnRXZWlnaHQsXG4gICAgICBsaW5lSGVpZ2h0OiB0aGlzLnByb3BzLmZvbnRTaXplICogdGhpcy5wcm9wcy5saW5lSGVpZ2h0XG4gICAgfTtcblxuICAgIGlmICh0aGlzLnByb3BzLndvcmRXcmFwKSB7XG4gICAgICBzdHlsZS53b3JkV3JhcCA9IHRydWU7XG4gICAgICBzdHlsZS53b3JkV3JhcFdpZHRoID0gdGhpcy5wcm9wcy53b3JkV3JhcFdpZHRoO1xuICAgIH1cblxuICAgIHJldHVybiBzdHlsZTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG4gICAgY29uc3QgbWV0cmljcyA9IHRoaXMudGV4dE9iamVjdDtcblxuICAgIC8vIEdldCB0ZXh0IGJvdW5kc1xuICAgIGNvbnN0IHRleHRXaWR0aCA9IG1ldHJpY3Mud2lkdGg7XG4gICAgY29uc3QgdGV4dEhlaWdodCA9IG1ldHJpY3MuaGVpZ2h0O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0ZXh0V2lkdGggKyBwYWRkaW5nLmhvcml6b250YWwsXG4gICAgICBoZWlnaHQ6IHRleHRIZWlnaHQgKyBwYWRkaW5nLnZlcnRpY2FsXG4gICAgfTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcblxuICAgIC8vIFVwZGF0ZSB3b3JkIHdyYXAgd2lkdGggaWYgbmVlZGVkXG4gICAgaWYgKHRoaXMucHJvcHMud29yZFdyYXAgJiYgdGhpcy5wcm9wcy53b3JkV3JhcFdpZHRoID09PSAwKSB7XG4gICAgICAvLyBVc2UgYXZhaWxhYmxlIHdpZHRoIG1pbnVzIHBhZGRpbmdcbiAgICAgIGNvbnN0IHdyYXBXaWR0aCA9IGF2YWlsYWJsZVdpZHRoIC0gcGFkZGluZy5ob3Jpem9udGFsO1xuICAgICAgdGhpcy5wcm9wcy53b3JkV3JhcFdpZHRoID0gd3JhcFdpZHRoO1xuICAgICAgdGhpcy50ZXh0T2JqZWN0LnN0eWxlID0gdGhpcy5nZXRUZXh0U3R5bGUoKTtcbiAgICB9XG5cbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuXG4gICAgLy8gSGFuZGxlICdmaWxsJyBjb25zdHJhaW50c1xuICAgIGxldCBmaW5hbFdpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgbGV0IGZpbmFsSGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgaWYgKHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdmaWxsJykge1xuICAgICAgZmluYWxXaWR0aCA9IGF2YWlsYWJsZVdpZHRoO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdudW1iZXInKSB7XG4gICAgICBmaW5hbFdpZHRoID0gdGhpcy5ib3hNb2RlbC53aWR0aCArIHBhZGRpbmcuaG9yaXpvbnRhbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdmaWxsJykge1xuICAgICAgZmluYWxIZWlnaHQgPSBhdmFpbGFibGVIZWlnaHQ7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdudW1iZXInKSB7XG4gICAgICBmaW5hbEhlaWdodCA9IHRoaXMuYm94TW9kZWwuaGVpZ2h0ICsgcGFkZGluZy52ZXJ0aWNhbDtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgY29tcHV0ZWQgbGF5b3V0XG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IGZpbmFsV2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBmaW5hbEhlaWdodDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRYID0gcGFkZGluZy5sZWZ0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFkgPSBwYWRkaW5nLnRvcDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRXaWR0aCA9IGZpbmFsV2lkdGggLSBwYWRkaW5nLmhvcml6b250YWw7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50SGVpZ2h0ID0gZmluYWxIZWlnaHQgLSBwYWRkaW5nLnZlcnRpY2FsO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICB0aGlzLnRleHRPYmplY3QucG9zaXRpb24uc2V0KHBhZGRpbmcubGVmdCwgcGFkZGluZy50b3ApO1xuICB9XG5cbiAgLyoqIFVwZGF0ZSBkaXNwbGF5ZWQgdGV4dC4gKi9cbiAgc2V0VGV4dCh0ZXh0OiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLnRleHQgPSB0ZXh0O1xuICAgIHRoaXMudGV4dE9iamVjdC50ZXh0ID0gdGV4dDtcbiAgICB0aGlzLm1hcmtMYXlvdXREaXJ0eSgpO1xuICB9XG5cbiAgLyoqIFVwZGF0ZSB0ZXh0IGNvbG9yLiAqL1xuICBzZXRDb2xvcihjb2xvcjogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy5jb2xvciA9IGNvbG9yO1xuICAgIHRoaXMudGV4dE9iamVjdC5zdHlsZS5maWxsID0gY29sb3I7XG4gIH1cblxuICAvKiogVXBkYXRlIGZvbnQgc2l6ZS4gKi9cbiAgc2V0Rm9udFNpemUoc2l6ZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy5mb250U2l6ZSA9IHNpemU7XG4gICAgdGhpcy50ZXh0T2JqZWN0LnN0eWxlLmZvbnRTaXplID0gc2l6ZTtcbiAgICB0aGlzLm1hcmtMYXlvdXREaXJ0eSgpO1xuICB9XG5cbiAgLyoqIEdldCBjdXJyZW50IHRleHQuICovXG4gIGdldFRleHQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy50ZXh0O1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcblxuLyoqIDktc2xpY2UgY29uZmlndXJhdGlvbiBmb3Igc2NhbGFibGUgc3ByaXRlcy4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTmluZVNsaWNlQ29uZmlnIHtcbiAgLyoqIFdpZHRoIG9mIGxlZnQgZWRnZSB0aGF0IGRvZXNuJ3Qgc2NhbGUgKi9cbiAgbGVmdFdpZHRoOiBudW1iZXI7XG4gIC8qKiBIZWlnaHQgb2YgdG9wIGVkZ2UgdGhhdCBkb2Vzbid0IHNjYWxlICovXG4gIHRvcEhlaWdodDogbnVtYmVyO1xuICAvKiogV2lkdGggb2YgcmlnaHQgZWRnZSB0aGF0IGRvZXNuJ3Qgc2NhbGUgKi9cbiAgcmlnaHRXaWR0aDogbnVtYmVyO1xuICAvKiogSGVpZ2h0IG9mIGJvdHRvbSBlZGdlIHRoYXQgZG9lc24ndCBzY2FsZSAqL1xuICBib3R0b21IZWlnaHQ6IG51bWJlcjtcbn1cblxuLyoqIFVJUGFuZWwgY29uZmlndXJhdGlvbi4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlQYW5lbFByb3BzIHtcbiAgLyoqIEJhY2tncm91bmQgdGV4dHVyZSAqL1xuICB0ZXh0dXJlPzogUElYSS5UZXh0dXJlO1xuICAvKiogQmFja2dyb3VuZCBjb2xvciAoaWYgbm8gdGV4dHVyZSkgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogQmFja2dyb3VuZCBhbHBoYSAqL1xuICBiYWNrZ3JvdW5kQWxwaGE/OiBudW1iZXI7XG4gIC8qKiA5LXNsaWNlIGNvbmZpZ3VyYXRpb24gKGlmIHVzaW5nIHRleHR1cmUpICovXG4gIG5pbmVTbGljZT86IE5pbmVTbGljZUNvbmZpZztcbiAgLyoqIEZpeGVkIHdpZHRoICovXG4gIHdpZHRoPzogbnVtYmVyO1xuICAvKiogRml4ZWQgaGVpZ2h0ICovXG4gIGhlaWdodD86IG51bWJlcjtcbiAgLyoqIEJvcmRlciByYWRpdXMgKGlmIHVzaW5nIHNvbGlkIGNvbG9yKSAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG59XG5cbi8qKlxuICogUGFuZWwgY29tcG9uZW50IHdpdGggOS1zbGljZSBzcHJpdGUgb3Igc29saWQgY29sb3IgYmFja2dyb3VuZC5cbiAqIFVzZSBmb3IgY29udGFpbmVycywgd2luZG93cywgY2FyZHMsIGFuZCBvdGhlciBVSSBiYWNrZ3JvdW5kcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIC8vIDktc2xpY2Ugc3ByaXRlIGJhY2tncm91bmQgKHNjYWxlcyB3aXRob3V0IGRpc3RvcnRpbmcgY29ybmVycylcbiAqIGNvbnN0IHBhbmVsID0gbmV3IFVJUGFuZWwoe1xuICogICB0ZXh0dXJlOiBwYW5lbFRleHR1cmUsXG4gKiAgIG5pbmVTbGljZTogeyBsZWZ0V2lkdGg6IDE2LCB0b3BIZWlnaHQ6IDE2LCByaWdodFdpZHRoOiAxNiwgYm90dG9tSGVpZ2h0OiAxNiB9LFxuICogICB3aWR0aDogMzAwLFxuICogICBoZWlnaHQ6IDIwMFxuICogfSk7XG4gKlxuICogLy8gU29saWQgY29sb3IgYmFja2dyb3VuZFxuICogY29uc3QgY29sb3JQYW5lbCA9IG5ldyBVSVBhbmVsKHtcbiAqICAgYmFja2dyb3VuZENvbG9yOiAweDJjM2U1MCxcbiAqICAgYmFja2dyb3VuZEFscGhhOiAwLjksXG4gKiAgIHdpZHRoOiAzMDAsXG4gKiAgIGhlaWdodDogMjAwLFxuICogICBib3JkZXJSYWRpdXM6IDhcbiAqIH0pO1xuICpcbiAqIC8vIFVwZGF0ZSBhdCBydW50aW1lXG4gKiBwYW5lbC5zZXRCYWNrZ3JvdW5kQ29sb3IoMHhmZjAwMDApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSVBhbmVsIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBVSVBhbmVsUHJvcHM7XG4gIHByaXZhdGUgYmFja2dyb3VuZD86IFBJWEkuTmluZVNsaWNlU3ByaXRlIHwgUElYSS5HcmFwaGljcztcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlQYW5lbFByb3BzID0ge30sIGJveE1vZGVsPzogUGFydGlhbDxCb3hNb2RlbD4pIHtcbiAgICBzdXBlcihib3hNb2RlbCk7XG5cbiAgICB0aGlzLnByb3BzID0ge1xuICAgICAgYmFja2dyb3VuZEFscGhhOiBwcm9wcy5iYWNrZ3JvdW5kQWxwaGEgPz8gMSxcbiAgICAgIC4uLnByb3BzXG4gICAgfTtcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9ucyBpZiBwcm92aWRlZFxuICAgIGlmIChwcm9wcy53aWR0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmJveE1vZGVsLndpZHRoID0gcHJvcHMud2lkdGg7XG4gICAgfVxuICAgIGlmIChwcm9wcy5oZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPSBwcm9wcy5oZWlnaHQ7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGJhY2tncm91bmRcbiAgICB0aGlzLmNyZWF0ZUJhY2tncm91bmQoKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBjcmVhdGVCYWNrZ3JvdW5kKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLnRleHR1cmUgJiYgdGhpcy5wcm9wcy5uaW5lU2xpY2UpIHtcbiAgICAgIC8vIFVzZSA5LXNsaWNlIHNwcml0ZVxuICAgICAgY29uc3QgeyBsZWZ0V2lkdGgsIHRvcEhlaWdodCwgcmlnaHRXaWR0aCwgYm90dG9tSGVpZ2h0IH0gPSB0aGlzLnByb3BzLm5pbmVTbGljZTtcbiAgICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBQSVhJLk5pbmVTbGljZVNwcml0ZSh7XG4gICAgICAgIHRleHR1cmU6IHRoaXMucHJvcHMudGV4dHVyZSxcbiAgICAgICAgbGVmdFdpZHRoLFxuICAgICAgICB0b3BIZWlnaHQsXG4gICAgICAgIHJpZ2h0V2lkdGgsXG4gICAgICAgIGJvdHRvbUhlaWdodFxuICAgICAgfSk7XG4gICAgICB0aGlzLmJhY2tncm91bmQuYWxwaGEgPSB0aGlzLnByb3BzLmJhY2tncm91bmRBbHBoYSA/PyAxO1xuICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIFVzZSBncmFwaGljcyBmb3Igc29saWQgY29sb3JcbiAgICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG5cbiAgICBsZXQgY29udGVudFdpZHRoID0gMDtcbiAgICBsZXQgY29udGVudEhlaWdodCA9IDA7XG5cbiAgICBpZiAodHlwZW9mIHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdudW1iZXInKSB7XG4gICAgICBjb250ZW50V2lkdGggPSB0aGlzLmJveE1vZGVsLndpZHRoO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy53aWR0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb250ZW50V2lkdGggPSB0aGlzLnByb3BzLndpZHRoO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdudW1iZXInKSB7XG4gICAgICBjb250ZW50SGVpZ2h0ID0gdGhpcy5ib3hNb2RlbC5oZWlnaHQ7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLmhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb250ZW50SGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiBjb250ZW50V2lkdGggKyBwYWRkaW5nLmhvcml6b250YWwsXG4gICAgICBoZWlnaHQ6IGNvbnRlbnRIZWlnaHQgKyBwYWRkaW5nLnZlcnRpY2FsXG4gICAgfTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGZpbmFsIGRpbWVuc2lvbnNcbiAgICBsZXQgZmluYWxXaWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIGxldCBmaW5hbEhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcblxuICAgIGlmICh0aGlzLmJveE1vZGVsLndpZHRoID09PSAnZmlsbCcpIHtcbiAgICAgIGZpbmFsV2lkdGggPSBhdmFpbGFibGVXaWR0aDtcbiAgICB9XG4gICAgaWYgKHRoaXMuYm94TW9kZWwuaGVpZ2h0ID09PSAnZmlsbCcpIHtcbiAgICAgIGZpbmFsSGVpZ2h0ID0gYXZhaWxhYmxlSGVpZ2h0O1xuICAgIH1cblxuICAgIC8vIEFwcGx5IG1heCBjb25zdHJhaW50c1xuICAgIGlmICh0aGlzLmJveE1vZGVsLm1heFdpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZpbmFsV2lkdGggPSBNYXRoLm1pbihmaW5hbFdpZHRoLCB0aGlzLmJveE1vZGVsLm1heFdpZHRoKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuYm94TW9kZWwubWF4SGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZpbmFsSGVpZ2h0ID0gTWF0aC5taW4oZmluYWxIZWlnaHQsIHRoaXMuYm94TW9kZWwubWF4SGVpZ2h0KTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgY29tcHV0ZWQgbGF5b3V0XG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IGZpbmFsV2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBmaW5hbEhlaWdodDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRYID0gcGFkZGluZy5sZWZ0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFkgPSBwYWRkaW5nLnRvcDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRXaWR0aCA9IGZpbmFsV2lkdGggLSBwYWRkaW5nLmhvcml6b250YWw7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50SGVpZ2h0ID0gZmluYWxIZWlnaHQgLSBwYWRkaW5nLnZlcnRpY2FsO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmJhY2tncm91bmQpIHJldHVybjtcblxuICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gdGhpcy5jb21wdXRlZExheW91dDtcblxuICAgIGlmICh0aGlzLmJhY2tncm91bmQgaW5zdGFuY2VvZiBQSVhJLk5pbmVTbGljZVNwcml0ZSkge1xuICAgICAgLy8gVXBkYXRlIDktc2xpY2Ugc3ByaXRlIHNpemVcbiAgICAgIHRoaXMuYmFja2dyb3VuZC53aWR0aCA9IHdpZHRoO1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kLmhlaWdodCA9IGhlaWdodDtcbiAgICB9IGVsc2UgaWYgKHRoaXMuYmFja2dyb3VuZCBpbnN0YW5jZW9mIFBJWEkuR3JhcGhpY3MpIHtcbiAgICAgIC8vIFJlZHJhdyBncmFwaGljc1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kLmNsZWFyKCk7XG5cbiAgICAgIGlmICh0aGlzLnByb3BzLmJvcmRlclJhZGl1cyAmJiB0aGlzLnByb3BzLmJvcmRlclJhZGl1cyA+IDApIHtcbiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kLnJvdW5kUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0LCB0aGlzLnByb3BzLmJvcmRlclJhZGl1cyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmJhY2tncm91bmQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kLmZpbGwoe1xuICAgICAgICAgIGNvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvcixcbiAgICAgICAgICBhbHBoYTogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQWxwaGFcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqIFVwZGF0ZSBiYWNrZ3JvdW5kIGNvbG9yIChzb2xpZCBjb2xvciBwYW5lbHMgb25seSkuICovXG4gIHNldEJhY2tncm91bmRDb2xvcihjb2xvcjogbnVtYmVyLCBhbHBoYTogbnVtYmVyID0gMSk6IHZvaWQge1xuICAgIGlmICh0aGlzLmJhY2tncm91bmQgaW5zdGFuY2VvZiBQSVhJLkdyYXBoaWNzKSB7XG4gICAgICB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xuICAgICAgdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQWxwaGEgPSBhbHBoYTtcbiAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFVwZGF0ZSB0ZXh0dXJlICh0ZXh0dXJlLWJhc2VkIHBhbmVscyBvbmx5KS4gKi9cbiAgc2V0VGV4dHVyZSh0ZXh0dXJlOiBQSVhJLlRleHR1cmUpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5iYWNrZ3JvdW5kIGluc3RhbmNlb2YgUElYSS5OaW5lU2xpY2VTcHJpdGUpIHtcbiAgICAgIHRoaXMuYmFja2dyb3VuZC50ZXh0dXJlID0gdGV4dHVyZTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuaW1wb3J0IHsgRWRnZUluc2V0cyB9IGZyb20gJy4uL2NvcmUvZWRnZS1pbnNldHMnO1xuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJU2Nyb2xsQ29udGFpbmVyXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlTY3JvbGxDb250YWluZXJQcm9wcyB7XG4gIC8qKiBXaWR0aCBvZiB0aGUgc2Nyb2xsIGNvbnRhaW5lciAqL1xuICB3aWR0aDogbnVtYmVyO1xuICAvKiogSGVpZ2h0IG9mIHRoZSBzY3JvbGwgY29udGFpbmVyICh2aWV3cG9ydCBoZWlnaHQpICovXG4gIGhlaWdodDogbnVtYmVyO1xuICAvKiogQmFja2dyb3VuZCBjb2xvciBvZiB0aGUgY29udGFpbmVyICovXG4gIGJhY2tncm91bmRDb2xvcj86IG51bWJlcjtcbiAgLyoqIEJvcmRlciByYWRpdXMgKi9cbiAgYm9yZGVyUmFkaXVzPzogbnVtYmVyO1xuICAvKiogU2Nyb2xsYmFyIHdpZHRoICovXG4gIHNjcm9sbGJhcldpZHRoPzogbnVtYmVyO1xuICAvKiogU2Nyb2xsYmFyIHRyYWNrIGNvbG9yICovXG4gIHNjcm9sbGJhclRyYWNrQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBTY3JvbGxiYXIgdGh1bWIgY29sb3IgKi9cbiAgc2Nyb2xsYmFyVGh1bWJDb2xvcj86IG51bWJlcjtcbiAgLyoqIFNjcm9sbGJhciB0aHVtYiBob3ZlciBjb2xvciAqL1xuICBzY3JvbGxiYXJUaHVtYkhvdmVyQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBXaGV0aGVyIHRvIHNob3cgc2Nyb2xsYmFyIG9ubHkgb24gaG92ZXIgKi9cbiAgc2Nyb2xsYmFyQXV0b0hpZGU/OiBib29sZWFuO1xuICAvKiogUGFkZGluZyBpbnNpZGUgdGhlIHNjcm9sbCBjb250YWluZXIgKi9cbiAgcGFkZGluZz86IEVkZ2VJbnNldHM7XG59XG5cbi8qKlxuICogQSBzY3JvbGxhYmxlIGNvbnRhaW5lciB3aXRoIGEgdmlzdWFsIHNjcm9sbGJhclxuICogU3VwcG9ydHMgbW91c2Ugd2hlZWwgc2Nyb2xsaW5nIGFuZCBkcmFnZ2FibGUgc2Nyb2xsYmFyIHRodW1iXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHNjcm9sbENvbnRhaW5lciA9IG5ldyBVSVNjcm9sbENvbnRhaW5lcih7XG4gKiAgIHdpZHRoOiA0MDAsXG4gKiAgIGhlaWdodDogMzAwLFxuICogICBiYWNrZ3JvdW5kQ29sb3I6IDB4ZmZmZmZmXG4gKiB9KTtcbiAqXG4gKiAvLyBBZGQgY2hpbGRyZW4gdGhhdCBleGNlZWQgdGhlIHZpZXdwb3J0IGhlaWdodFxuICogc2Nyb2xsQ29udGFpbmVyLmFkZENoaWxkKHNvbWVVSUNvbXBvbmVudCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJU2Nyb2xsQ29udGFpbmVyIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxVSVNjcm9sbENvbnRhaW5lclByb3BzPjtcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kOiBQSVhJLkdyYXBoaWNzO1xuICBwcml2YXRlIGNvbnRlbnRDb250YWluZXI6IFBJWEkuQ29udGFpbmVyO1xuICBwcml2YXRlIGNvbnRlbnRNYXNrOiBQSVhJLkdyYXBoaWNzO1xuICBwcml2YXRlIHNjcm9sbGJhclRyYWNrOiBQSVhJLkdyYXBoaWNzO1xuICBwcml2YXRlIHNjcm9sbGJhclRodW1iOiBQSVhJLkdyYXBoaWNzO1xuXG4gIC8vIFB1YmxpYyBjaGlsZHJlbiBhcnJheSBmb3IgZm9jdXMgbWFuYWdlciBkaXNjb3ZlcnlcbiAgcHVibGljIGNoaWxkcmVuOiBVSUNvbXBvbmVudFtdID0gW107XG5cbiAgcHJpdmF0ZSBzY3JvbGxZOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIG1heFNjcm9sbFk6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgY29udGVudEhlaWdodDogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBpc0RyYWdnaW5nOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgZHJhZ1N0YXJ0WTogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBkcmFnU3RhcnRTY3JvbGxZOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGlzSG92ZXJpbmdUaHVtYjogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIC8vIEJvdW5kIGhhbmRsZXJzIGZvciBwcm9wZXIgY2xlYW51cFxuICBwcml2YXRlIGJvdW5kR2xvYmFsUG9pbnRlck1vdmU6ICgoZTogUG9pbnRlckV2ZW50KSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGJvdW5kR2xvYmFsUG9pbnRlclVwOiAoKCkgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlTY3JvbGxDb250YWluZXJQcm9wcywgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICB3aWR0aDogcHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHByb3BzLmhlaWdodCxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogcHJvcHMuYmFja2dyb3VuZENvbG9yID8/IDB4ZmZmZmZmLFxuICAgICAgYm9yZGVyUmFkaXVzOiBwcm9wcy5ib3JkZXJSYWRpdXMgPz8gMCxcbiAgICAgIHNjcm9sbGJhcldpZHRoOiBwcm9wcy5zY3JvbGxiYXJXaWR0aCA/PyAxMixcbiAgICAgIHNjcm9sbGJhclRyYWNrQ29sb3I6IHByb3BzLnNjcm9sbGJhclRyYWNrQ29sb3IgPz8gMHhlMGUwZTAsXG4gICAgICBzY3JvbGxiYXJUaHVtYkNvbG9yOiBwcm9wcy5zY3JvbGxiYXJUaHVtYkNvbG9yID8/IDB4ODg4ODg4LFxuICAgICAgc2Nyb2xsYmFyVGh1bWJIb3ZlckNvbG9yOiBwcm9wcy5zY3JvbGxiYXJUaHVtYkhvdmVyQ29sb3IgPz8gMHg1NTU1NTUsXG4gICAgICBzY3JvbGxiYXJBdXRvSGlkZTogcHJvcHMuc2Nyb2xsYmFyQXV0b0hpZGUgPz8gZmFsc2UsXG4gICAgICBwYWRkaW5nOiBwcm9wcy5wYWRkaW5nID8/IEVkZ2VJbnNldHMuYWxsKDApXG4gICAgfTtcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9uc1xuICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSB0aGlzLnByb3BzLndpZHRoO1xuICAgIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG5cbiAgICAvLyBDcmVhdGUgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy51cGRhdGVCYWNrZ3JvdW5kKCk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kKTtcblxuICAgIC8vIENyZWF0ZSBjb250ZW50IGNvbnRhaW5lclxuICAgIHRoaXMuY29udGVudENvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgIHRoaXMuY29udGVudENvbnRhaW5lci54ID0gdGhpcy5wcm9wcy5wYWRkaW5nLmxlZnQ7XG4gICAgdGhpcy5jb250ZW50Q29udGFpbmVyLnkgPSB0aGlzLnByb3BzLnBhZGRpbmcudG9wO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuY29udGVudENvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgbWFzayBmb3IgY29udGVudFxuICAgIHRoaXMuY29udGVudE1hc2sgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMudXBkYXRlTWFzaygpO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuY29udGVudE1hc2spO1xuICAgIHRoaXMuY29udGVudENvbnRhaW5lci5tYXNrID0gdGhpcy5jb250ZW50TWFzaztcblxuICAgIC8vIENyZWF0ZSBzY3JvbGxiYXIgdHJhY2tcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2suY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuc2Nyb2xsYmFyVHJhY2spO1xuXG4gICAgLy8gQ3JlYXRlIHNjcm9sbGJhciB0aHVtYlxuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5zY3JvbGxiYXJUaHVtYik7XG5cbiAgICAvLyBTZXR1cCBpbnRlcmFjdGl2aXR5XG4gICAgdGhpcy5zZXR1cEludGVyYWN0aXZpdHkoKTtcblxuICAgIC8vIEluaXRpYWwgc2Nyb2xsYmFyIHVwZGF0ZVxuICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgYmFja2dyb3VuZCBncmFwaGljc1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVCYWNrZ3JvdW5kKCk6IHZvaWQge1xuICAgIHRoaXMuYmFja2dyb3VuZC5jbGVhcigpO1xuICAgIHRoaXMuYmFja2dyb3VuZC5yb3VuZFJlY3QoXG4gICAgICAwLFxuICAgICAgMCxcbiAgICAgIHRoaXMucHJvcHMud2lkdGgsXG4gICAgICB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgKTtcbiAgICB0aGlzLmJhY2tncm91bmQuZmlsbCh7IGNvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBjb250ZW50IG1hc2tcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlTWFzaygpOiB2b2lkIHtcbiAgICBjb25zdCBjb250ZW50V2lkdGggPSB0aGlzLnByb3BzLndpZHRoIC0gdGhpcy5wcm9wcy5wYWRkaW5nLmxlZnQgLSB0aGlzLnByb3BzLnBhZGRpbmcucmlnaHQgLSB0aGlzLnByb3BzLnNjcm9sbGJhcldpZHRoO1xuICAgIGNvbnN0IGNvbnRlbnRIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodCAtIHRoaXMucHJvcHMucGFkZGluZy50b3AgLSB0aGlzLnByb3BzLnBhZGRpbmcuYm90dG9tO1xuXG4gICAgdGhpcy5jb250ZW50TWFzay5jbGVhcigpO1xuICAgIHRoaXMuY29udGVudE1hc2sucmVjdChcbiAgICAgIHRoaXMucHJvcHMucGFkZGluZy5sZWZ0LFxuICAgICAgdGhpcy5wcm9wcy5wYWRkaW5nLnRvcCxcbiAgICAgIGNvbnRlbnRXaWR0aCxcbiAgICAgIGNvbnRlbnRIZWlnaHRcbiAgICApO1xuICAgIHRoaXMuY29udGVudE1hc2suZmlsbCh7IGNvbG9yOiAweGZmZmZmZiB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHVwIG1vdXNlL3doZWVsIGV2ZW50IGhhbmRsZXJzXG4gICAqL1xuICBwcml2YXRlIHNldHVwSW50ZXJhY3Rpdml0eSgpOiB2b2lkIHtcbiAgICAvLyBNb3VzZSB3aGVlbCBzY3JvbGxpbmdcbiAgICB0aGlzLmNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICB0aGlzLmNvbnRhaW5lci5vbignd2hlZWwnLCB0aGlzLmhhbmRsZVdoZWVsLmJpbmQodGhpcykpO1xuXG4gICAgLy8gU2Nyb2xsYmFyIHRodW1iIGRyYWdnaW5nXG4gICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5vbigncG9pbnRlcmRvd24nLCB0aGlzLmhhbmRsZVRodW1iUG9pbnRlckRvd24uYmluZCh0aGlzKSk7XG4gICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5vbigncG9pbnRlcm92ZXInLCAoKSA9PiB7XG4gICAgICB0aGlzLmlzSG92ZXJpbmdUaHVtYiA9IHRydWU7XG4gICAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICAgIH0pO1xuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIub24oJ3BvaW50ZXJvdXQnLCAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuaXNEcmFnZ2luZykge1xuICAgICAgICB0aGlzLmlzSG92ZXJpbmdUaHVtYiA9IGZhbHNlO1xuICAgICAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gVHJhY2sgY2xpY2sgZm9yIGp1bXBpbmdcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrLm9uKCdwb2ludGVyZG93bicsIHRoaXMuaGFuZGxlVHJhY2tQb2ludGVyRG93bi5iaW5kKHRoaXMpKTtcblxuICAgIC8vIEdsb2JhbCBwb2ludGVyIGV2ZW50cyBmb3IgZHJhZ2dpbmcgLSBzdG9yZSBib3VuZCByZWZlcmVuY2VzIGZvciBjbGVhbnVwXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzLmJvdW5kR2xvYmFsUG9pbnRlck1vdmUgPSB0aGlzLmhhbmRsZUdsb2JhbFBvaW50ZXJNb3ZlLmJpbmQodGhpcyk7XG4gICAgICB0aGlzLmJvdW5kR2xvYmFsUG9pbnRlclVwID0gdGhpcy5oYW5kbGVHbG9iYWxQb2ludGVyVXAuYmluZCh0aGlzKTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIHRoaXMuYm91bmRHbG9iYWxQb2ludGVyTW92ZSk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgdGhpcy5ib3VuZEdsb2JhbFBvaW50ZXJVcCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgbW91c2Ugd2hlZWwgZXZlbnRzXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVdoZWVsKGU6IFBJWEkuRmVkZXJhdGVkV2hlZWxFdmVudCk6IHZvaWQge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IGRlbHRhID0gZS5kZWx0YVk7XG4gICAgdGhpcy5zY3JvbGxZICs9IGRlbHRhO1xuICAgIHRoaXMuc2Nyb2xsWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMubWF4U2Nyb2xsWSwgdGhpcy5zY3JvbGxZKSk7XG5cbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRQb3NpdGlvbigpO1xuICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBwb2ludGVyIGRvd24gb24gc2Nyb2xsYmFyIHRodW1iXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVRodW1iUG9pbnRlckRvd24oZTogUElYSS5GZWRlcmF0ZWRQb2ludGVyRXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLmlzRHJhZ2dpbmcgPSB0cnVlO1xuICAgIHRoaXMuZHJhZ1N0YXJ0WSA9IGUuZ2xvYmFsWTtcbiAgICB0aGlzLmRyYWdTdGFydFNjcm9sbFkgPSB0aGlzLnNjcm9sbFk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIHBvaW50ZXIgZG93biBvbiBzY3JvbGxiYXIgdHJhY2tcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlVHJhY2tQb2ludGVyRG93bihlOiBQSVhJLkZlZGVyYXRlZFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGxvY2FsWSA9IGUuZ2xvYmFsWSAtIHRoaXMuY29udGFpbmVyLndvcmxkVHJhbnNmb3JtLnR5O1xuICAgIGNvbnN0IHRodW1iSGVpZ2h0ID0gdGhpcy5nZXRUaHVtYkhlaWdodCgpO1xuICAgIGNvbnN0IHRyYWNrVG9wID0gMDtcbiAgICBjb25zdCB0cmFja0JvdHRvbSA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuXG4gICAgLy8gQ2FsY3VsYXRlIHRhcmdldCBzY3JvbGwgcG9zaXRpb25cbiAgICBjb25zdCBjbGlja1JhdGlvID0gKGxvY2FsWSAtIHRyYWNrVG9wKSAvICh0cmFja0JvdHRvbSAtIHRyYWNrVG9wKTtcbiAgICB0aGlzLnNjcm9sbFkgPSBjbGlja1JhdGlvICogdGhpcy5tYXhTY3JvbGxZO1xuICAgIHRoaXMuc2Nyb2xsWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMubWF4U2Nyb2xsWSwgdGhpcy5zY3JvbGxZKSk7XG5cbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRQb3NpdGlvbigpO1xuICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBnbG9iYWwgcG9pbnRlciBtb3ZlIGZvciB0aHVtYiBkcmFnZ2luZ1xuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVHbG9iYWxQb2ludGVyTW92ZShlOiBQb2ludGVyRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuaXNEcmFnZ2luZykgcmV0dXJuO1xuXG4gICAgY29uc3QgZGVsdGFZID0gZS5jbGllbnRZIC0gdGhpcy5kcmFnU3RhcnRZO1xuICAgIGNvbnN0IHRyYWNrSGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG4gICAgY29uc3QgdGh1bWJIZWlnaHQgPSB0aGlzLmdldFRodW1iSGVpZ2h0KCk7XG4gICAgY29uc3Qgc2Nyb2xsYWJsZVRyYWNrSGVpZ2h0ID0gdHJhY2tIZWlnaHQgLSB0aHVtYkhlaWdodDtcblxuICAgIGlmIChzY3JvbGxhYmxlVHJhY2tIZWlnaHQgPD0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3Qgc2Nyb2xsRGVsdGEgPSAoZGVsdGFZIC8gc2Nyb2xsYWJsZVRyYWNrSGVpZ2h0KSAqIHRoaXMubWF4U2Nyb2xsWTtcbiAgICB0aGlzLnNjcm9sbFkgPSB0aGlzLmRyYWdTdGFydFNjcm9sbFkgKyBzY3JvbGxEZWx0YTtcbiAgICB0aGlzLnNjcm9sbFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbih0aGlzLm1heFNjcm9sbFksIHRoaXMuc2Nyb2xsWSkpO1xuXG4gICAgdGhpcy51cGRhdGVDb250ZW50UG9zaXRpb24oKTtcbiAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgZ2xvYmFsIHBvaW50ZXIgdXAgdG8gZW5kIGRyYWdnaW5nXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZUdsb2JhbFBvaW50ZXJVcCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5pc0RyYWdnaW5nKSB7XG4gICAgICB0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgIGlmICghdGhpcy5pc0hvdmVyaW5nVGh1bWIpIHtcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgY29udGVudCBwb3NpdGlvbiBiYXNlZCBvbiBzY3JvbGxcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlQ29udGVudFBvc2l0aW9uKCk6IHZvaWQge1xuICAgIHRoaXMuY29udGVudENvbnRhaW5lci55ID0gdGhpcy5wcm9wcy5wYWRkaW5nLnRvcCAtIHRoaXMuc2Nyb2xsWTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGVzIHRoZSB0aHVtYiBoZWlnaHQgYmFzZWQgb24gY29udGVudCByYXRpb1xuICAgKi9cbiAgcHJpdmF0ZSBnZXRUaHVtYkhlaWdodCgpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLmNvbnRlbnRIZWlnaHQgPD0gMCkgcmV0dXJuIDA7XG5cbiAgICBjb25zdCB2aWV3cG9ydEhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0IC0gdGhpcy5wcm9wcy5wYWRkaW5nLnRvcCAtIHRoaXMucHJvcHMucGFkZGluZy5ib3R0b207XG4gICAgY29uc3QgcmF0aW8gPSB2aWV3cG9ydEhlaWdodCAvIHRoaXMuY29udGVudEhlaWdodDtcbiAgICBjb25zdCB0aHVtYkhlaWdodCA9IE1hdGgubWF4KDMwLCB0aGlzLnByb3BzLmhlaWdodCAqIHJhdGlvKTtcblxuICAgIHJldHVybiBNYXRoLm1pbih0aHVtYkhlaWdodCwgdGhpcy5wcm9wcy5oZWlnaHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHRodW1iIFkgcG9zaXRpb25cbiAgICovXG4gIHByaXZhdGUgZ2V0VGh1bWJZKCk6IG51bWJlciB7XG4gICAgaWYgKHRoaXMubWF4U2Nyb2xsWSA8PSAwKSByZXR1cm4gMDtcblxuICAgIGNvbnN0IHRyYWNrSGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG4gICAgY29uc3QgdGh1bWJIZWlnaHQgPSB0aGlzLmdldFRodW1iSGVpZ2h0KCk7XG4gICAgY29uc3Qgc2Nyb2xsYWJsZVRyYWNrSGVpZ2h0ID0gdHJhY2tIZWlnaHQgLSB0aHVtYkhlaWdodDtcblxuICAgIGNvbnN0IHNjcm9sbFJhdGlvID0gdGhpcy5zY3JvbGxZIC8gdGhpcy5tYXhTY3JvbGxZO1xuICAgIHJldHVybiBzY3JvbGxSYXRpbyAqIHNjcm9sbGFibGVUcmFja0hlaWdodDtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBzY3JvbGxiYXIgYXBwZWFyYW5jZVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVTY3JvbGxiYXIoKTogdm9pZCB7XG4gICAgY29uc3QgdHJhY2tYID0gdGhpcy5wcm9wcy53aWR0aCAtIHRoaXMucHJvcHMuc2Nyb2xsYmFyV2lkdGg7XG4gICAgY29uc3QgdHJhY2tXaWR0aCA9IHRoaXMucHJvcHMuc2Nyb2xsYmFyV2lkdGg7XG4gICAgY29uc3QgdHJhY2tIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcblxuICAgIC8vIFVwZGF0ZSB0cmFja1xuICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2suY2xlYXIoKTtcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrLnJlY3QodHJhY2tYLCAwLCB0cmFja1dpZHRoLCB0cmFja0hlaWdodCk7XG4gICAgdGhpcy5zY3JvbGxiYXJUcmFjay5maWxsKHsgY29sb3I6IHRoaXMucHJvcHMuc2Nyb2xsYmFyVHJhY2tDb2xvciB9KTtcblxuICAgIC8vIFVwZGF0ZSB0aHVtYlxuICAgIGNvbnN0IHRodW1iSGVpZ2h0ID0gdGhpcy5nZXRUaHVtYkhlaWdodCgpO1xuICAgIGNvbnN0IHRodW1iWSA9IHRoaXMuZ2V0VGh1bWJZKCk7XG4gICAgY29uc3QgdGh1bWJDb2xvciA9ICh0aGlzLmlzSG92ZXJpbmdUaHVtYiB8fCB0aGlzLmlzRHJhZ2dpbmcpXG4gICAgICA/IHRoaXMucHJvcHMuc2Nyb2xsYmFyVGh1bWJIb3ZlckNvbG9yXG4gICAgICA6IHRoaXMucHJvcHMuc2Nyb2xsYmFyVGh1bWJDb2xvcjtcblxuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIuY2xlYXIoKTtcblxuICAgIC8vIE9ubHkgc2hvdyB0aHVtYiBpZiBjb250ZW50IGlzIHNjcm9sbGFibGVcbiAgICBpZiAodGhpcy5tYXhTY3JvbGxZID4gMCkge1xuICAgICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5yb3VuZFJlY3QoXG4gICAgICAgIHRyYWNrWCArIDIsXG4gICAgICAgIHRodW1iWSArIDIsXG4gICAgICAgIHRyYWNrV2lkdGggLSA0LFxuICAgICAgICB0aHVtYkhlaWdodCAtIDQsXG4gICAgICAgIDRcbiAgICAgICk7XG4gICAgICB0aGlzLnNjcm9sbGJhclRodW1iLmZpbGwoeyBjb2xvcjogdGh1bWJDb2xvciB9KTtcbiAgICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIudmlzaWJsZSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIudmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8vIEhhbmRsZSBhdXRvLWhpZGVcbiAgICBpZiAodGhpcy5wcm9wcy5zY3JvbGxiYXJBdXRvSGlkZSAmJiAhdGhpcy5pc0RyYWdnaW5nICYmICF0aGlzLmlzSG92ZXJpbmdUaHVtYikge1xuICAgICAgdGhpcy5zY3JvbGxiYXJUcmFjay5hbHBoYSA9IDA7XG4gICAgICB0aGlzLnNjcm9sbGJhclRodW1iLmFscGhhID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zY3JvbGxiYXJUcmFjay5hbHBoYSA9IDE7XG4gICAgICB0aGlzLnNjcm9sbGJhclRodW1iLmFscGhhID0gMTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjYWxjdWxhdGVzIGNvbnRlbnQgaGVpZ2h0IGFuZCBtYXggc2Nyb2xsXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZUNvbnRlbnRCb3VuZHMoKTogdm9pZCB7XG4gICAgLy8gQ2FsY3VsYXRlIGNvbnRlbnQgaGVpZ2h0IGZyb20gY2hpbGRyZW4ncyBjb21wdXRlZCBsYXlvdXRzXG4gICAgbGV0IG1heEhlaWdodCA9IDA7XG5cbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQ6IGFueSkgPT4ge1xuICAgICAgaWYgKGNoaWxkICYmIHR5cGVvZiBjaGlsZC55ID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgY2hpbGQuaGVpZ2h0ID09PSAnbnVtYmVyJykge1xuICAgICAgICBjb25zdCBjaGlsZEJvdHRvbSA9IGNoaWxkLnkgKyBjaGlsZC5oZWlnaHQ7XG4gICAgICAgIGlmIChjaGlsZEJvdHRvbSA+IG1heEhlaWdodCkge1xuICAgICAgICAgIG1heEhlaWdodCA9IGNoaWxkQm90dG9tO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmNvbnRlbnRIZWlnaHQgPSBtYXhIZWlnaHQ7XG5cbiAgICBjb25zdCB2aWV3cG9ydEhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0IC0gdGhpcy5wcm9wcy5wYWRkaW5nLnRvcCAtIHRoaXMucHJvcHMucGFkZGluZy5ib3R0b207XG4gICAgdGhpcy5tYXhTY3JvbGxZID0gTWF0aC5tYXgoMCwgdGhpcy5jb250ZW50SGVpZ2h0IC0gdmlld3BvcnRIZWlnaHQpO1xuXG4gICAgLy8gQ2xhbXAgY3VycmVudCBzY3JvbGwgcG9zaXRpb25cbiAgICB0aGlzLnNjcm9sbFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbih0aGlzLm1heFNjcm9sbFksIHRoaXMuc2Nyb2xsWSkpO1xuXG4gICAgdGhpcy51cGRhdGVDb250ZW50UG9zaXRpb24oKTtcbiAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBjaGlsZCB0byB0aGUgc2Nyb2xsYWJsZSBjb250ZW50XG4gICAqL1xuICBhZGRDaGlsZChjaGlsZDogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICAvLyBTZXQgcGFyZW50IHJlZmVyZW5jZSBmb3Igc2Nyb2xsLWludG8tdmlldyBzdXBwb3J0XG4gICAgY2hpbGQucGFyZW50ID0gdGhpcyBhcyBhbnk7XG5cbiAgICAvLyBUcmFjayBjaGlsZCBmb3IgZm9jdXMgbWFuYWdlciBkaXNjb3ZlcnlcbiAgICB0aGlzLmNoaWxkcmVuLnB1c2goY2hpbGQpO1xuXG4gICAgdGhpcy5jb250ZW50Q29udGFpbmVyLmFkZENoaWxkKGNoaWxkLmNvbnRhaW5lcik7XG5cbiAgICAvLyBMYXlvdXQgdGhlIGNoaWxkIHdpdGggYXZhaWxhYmxlIGNvbnRlbnQgd2lkdGhcbiAgICBjb25zdCBjb250ZW50V2lkdGggPSB0aGlzLnByb3BzLndpZHRoIC0gdGhpcy5wcm9wcy5wYWRkaW5nLmxlZnQgLSB0aGlzLnByb3BzLnBhZGRpbmcucmlnaHQgLSB0aGlzLnByb3BzLnNjcm9sbGJhcldpZHRoO1xuICAgIGNvbnN0IGNvbnRlbnRIZWlnaHQgPSA5OTk5OTk7IC8vIEFsbG93IHVubGltaXRlZCBoZWlnaHQgZm9yIHNjcm9sbGluZ1xuICAgIGNoaWxkLmxheW91dChjb250ZW50V2lkdGgsIGNvbnRlbnRIZWlnaHQpO1xuXG4gICAgdGhpcy51cGRhdGVDb250ZW50Qm91bmRzKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhIGNoaWxkIGZyb20gdGhlIHNjcm9sbGFibGUgY29udGVudFxuICAgKi9cbiAgcmVtb3ZlQ2hpbGQoY2hpbGQ6IFVJQ29tcG9uZW50KTogdm9pZCB7XG4gICAgY2hpbGQucGFyZW50ID0gdW5kZWZpbmVkO1xuXG4gICAgLy8gUmVtb3ZlIGZyb20gY2hpbGRyZW4gdHJhY2tpbmdcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuY2hpbGRyZW4uaW5kZXhPZihjaGlsZCk7XG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cblxuICAgIHRoaXMuY29udGVudENvbnRhaW5lci5yZW1vdmVDaGlsZChjaGlsZC5jb250YWluZXIpO1xuICAgIHRoaXMudXBkYXRlQ29udGVudEJvdW5kcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNjcm9sbHMgdG8gYSBzcGVjaWZpYyBZIHBvc2l0aW9uXG4gICAqL1xuICBzY3JvbGxUbyh5OiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnNjcm9sbFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbih0aGlzLm1heFNjcm9sbFksIHkpKTtcbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRQb3NpdGlvbigpO1xuICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xscyB0byB0aGUgdG9wXG4gICAqL1xuICBzY3JvbGxUb1RvcCgpOiB2b2lkIHtcbiAgICB0aGlzLnNjcm9sbFRvKDApO1xuICB9XG5cbiAgLyoqXG4gICAqIFNjcm9sbHMgdG8gdGhlIGJvdHRvbVxuICAgKi9cbiAgc2Nyb2xsVG9Cb3R0b20oKTogdm9pZCB7XG4gICAgdGhpcy5zY3JvbGxUbyh0aGlzLm1heFNjcm9sbFkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uXG4gICAqL1xuICBnZXRTY3JvbGxZKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuc2Nyb2xsWTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBtYXhpbXVtIHNjcm9sbCBwb3NpdGlvblxuICAgKi9cbiAgZ2V0TWF4U2Nyb2xsWSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLm1heFNjcm9sbFk7XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xscyB0byBtYWtlIGEgY2hpbGQgY29tcG9uZW50IHZpc2libGVcbiAgICovXG4gIHNjcm9sbFRvQ29tcG9uZW50KGNvbXBvbmVudDogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICBjb25zdCBjb21wb25lbnRCb3VuZHMgPSBjb21wb25lbnQuZ2V0R2xvYmFsQm91bmRzKCk7XG4gICAgY29uc3QgY29udGFpbmVyQm91bmRzID0gdGhpcy5nZXRHbG9iYWxCb3VuZHMoKTtcblxuICAgIC8vIENhbGN1bGF0ZSBjb21wb25lbnQgcG9zaXRpb24gcmVsYXRpdmUgdG8gc2Nyb2xsIGNvbnRhaW5lcidzIGNvbnRlbnQgYXJlYVxuICAgIGNvbnN0IHJlbGF0aXZlWSA9IGNvbXBvbmVudEJvdW5kcy55IC0gY29udGFpbmVyQm91bmRzLnkgLSB0aGlzLnByb3BzLnBhZGRpbmcudG9wICsgdGhpcy5zY3JvbGxZO1xuICAgIGNvbnN0IHZpZXdwb3J0SGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQgLSB0aGlzLnByb3BzLnBhZGRpbmcudG9wIC0gdGhpcy5wcm9wcy5wYWRkaW5nLmJvdHRvbTtcblxuICAgIC8vIENoZWNrIGlmIGNvbXBvbmVudCBpcyBhYm92ZSB2aWV3cG9ydFxuICAgIGlmIChyZWxhdGl2ZVkgPCB0aGlzLnNjcm9sbFkpIHtcbiAgICAgIC8vIFNjcm9sbCB1cCB0byBzaG93IGNvbXBvbmVudCBhdCB0b3BcbiAgICAgIHRoaXMuc2Nyb2xsVG8ocmVsYXRpdmVZKTtcbiAgICB9XG4gICAgLy8gQ2hlY2sgaWYgY29tcG9uZW50IGlzIGJlbG93IHZpZXdwb3J0XG4gICAgZWxzZSBpZiAocmVsYXRpdmVZICsgY29tcG9uZW50Qm91bmRzLmhlaWdodCA+IHRoaXMuc2Nyb2xsWSArIHZpZXdwb3J0SGVpZ2h0KSB7XG4gICAgICAvLyBTY3JvbGwgZG93biB0byBzaG93IGNvbXBvbmVudCBhdCBib3R0b21cbiAgICAgIGNvbnN0IHRhcmdldFNjcm9sbCA9IHJlbGF0aXZlWSArIGNvbXBvbmVudEJvdW5kcy5oZWlnaHQgLSB2aWV3cG9ydEhlaWdodDtcbiAgICAgIHRoaXMuc2Nyb2xsVG8odGFyZ2V0U2Nyb2xsKTtcbiAgICB9XG4gICAgLy8gQ29tcG9uZW50IGlzIGFscmVhZHkgdmlzaWJsZSwgbm8gbmVlZCB0byBzY3JvbGxcbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgY29udGFpbmVyXG4gICAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIGNvbnRhaW5lclxuICAgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcblxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcblxuICAgIHRoaXMudXBkYXRlQ29udGVudEJvdW5kcygpO1xuICAgIHRoaXMubGF5b3V0RGlydHkgPSBmYWxzZTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIGNvbnRhaW5lclxuICAgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICAvLyBSZW5kZXJpbmcgaGFuZGxlZCBieSBiYWNrZ3JvdW5kLCBjb250ZW50LCBtYXNrLCBhbmQgc2Nyb2xsYmFyXG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCB3aGVuIGRlc3Ryb3lpbmdcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBpZiAodGhpcy5ib3VuZEdsb2JhbFBvaW50ZXJNb3ZlKSB7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIHRoaXMuYm91bmRHbG9iYWxQb2ludGVyTW92ZSk7XG4gICAgICAgIHRoaXMuYm91bmRHbG9iYWxQb2ludGVyTW92ZSA9IG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5ib3VuZEdsb2JhbFBvaW50ZXJVcCkge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgdGhpcy5ib3VuZEdsb2JhbFBvaW50ZXJVcCk7XG4gICAgICAgIHRoaXMuYm91bmRHbG9iYWxQb2ludGVyVXAgPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgICBzdXBlci5kZXN0cm95KCk7XG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuaW1wb3J0IHsgVUlQYW5lbCB9IGZyb20gJy4vdWktcGFuZWwnO1xuaW1wb3J0IHsgVUlMYWJlbCB9IGZyb20gJy4vdWktbGFiZWwnO1xuaW1wb3J0IHsgRWRnZUluc2V0cyB9IGZyb20gJy4uL2NvcmUvZWRnZS1pbnNldHMnO1xuXG4vKipcbiAqIE9wdGlvbiBzdHJ1Y3R1cmUgZm9yIFNlbGVjdCBjb21wb25lbnRcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTZWxlY3RPcHRpb24ge1xuICAvKiogRGlzcGxheSB0ZXh0IGZvciB0aGUgb3B0aW9uICovXG4gIGxhYmVsOiBzdHJpbmc7XG4gIC8qKiBUaGUgYWN0dWFsIHZhbHVlICovXG4gIHZhbHVlOiBhbnk7XG4gIC8qKiBXaGV0aGVyIHRoaXMgb3B0aW9uIGlzIGRpc2FibGVkICovXG4gIGRpc2FibGVkPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBQcm9wcyBmb3IgY29uZmlndXJpbmcgYSBVSVNlbGVjdFxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFVJU2VsZWN0UHJvcHMge1xuICAvKiogQXJyYXkgb2Ygb3B0aW9ucyAqL1xuICBvcHRpb25zOiBTZWxlY3RPcHRpb25bXTtcbiAgLyoqIEN1cnJlbnQgc2VsZWN0ZWQgdmFsdWUgKGNvbnRyb2xsZWQpICovXG4gIHZhbHVlPzogYW55O1xuICAvKiogRGVmYXVsdCBzZWxlY3RlZCB2YWx1ZSAodW5jb250cm9sbGVkKSAqL1xuICBkZWZhdWx0VmFsdWU/OiBhbnk7XG4gIC8qKiBDaGFuZ2UgY2FsbGJhY2sgKi9cbiAgb25DaGFuZ2U/OiAodmFsdWU6IGFueSkgPT4gdm9pZDtcbiAgLyoqIFdpZHRoIG9mIHRoZSBzZWxlY3QgKi9cbiAgd2lkdGg/OiBudW1iZXI7XG4gIC8qKiBIZWlnaHQgb2YgdGhlIHNlbGVjdCAqL1xuICBoZWlnaHQ/OiBudW1iZXI7XG4gIC8qKiBQbGFjZWhvbGRlciB0ZXh0IHdoZW4gbm90aGluZyBzZWxlY3RlZCAqL1xuICBwbGFjZWhvbGRlcj86IHN0cmluZztcbiAgLyoqIFdoZXRoZXIgdGhlIHNlbGVjdCBpcyBkaXNhYmxlZCAqL1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yICovXG4gIGJhY2tncm91bmRDb2xvcj86IG51bWJlcjtcbiAgLyoqIFRleHQgY29sb3IgKi9cbiAgdGV4dENvbG9yPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG59XG5cbi8qKlxuICogQSBzZWxlY3QvZHJvcGRvd24gY29tcG9uZW50IHdpdGggb3B0aW9uc1xuICogRm9sbG93cyBBbnQgRGVzaWduJ3MgZGF0YS1kcml2ZW4gcGF0dGVyblxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBzZWxlY3QgPSBuZXcgVUlTZWxlY3Qoe1xuICogICBvcHRpb25zOiBbXG4gKiAgICAgeyBsYWJlbDogJ09wdGlvbiAxJywgdmFsdWU6IDEgfSxcbiAqICAgICB7IGxhYmVsOiAnT3B0aW9uIDInLCB2YWx1ZTogMiB9LFxuICogICAgIHsgbGFiZWw6ICdPcHRpb24gMycsIHZhbHVlOiAzIH1cbiAqICAgXSxcbiAqICAgcGxhY2Vob2xkZXI6ICdDaG9vc2UgYW4gb3B0aW9uJyxcbiAqICAgb25DaGFuZ2U6ICh2YWx1ZSkgPT4gY29uc29sZS5sb2coJ1NlbGVjdGVkOicsIHZhbHVlKVxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJU2VsZWN0IGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxPbWl0PFVJU2VsZWN0UHJvcHMsICdvbkNoYW5nZScgfCAndmFsdWUnIHwgJ2RlZmF1bHRWYWx1ZSc+PjtcbiAgcHJpdmF0ZSBvbkNoYW5nZT86ICh2YWx1ZTogYW55KSA9PiB2b2lkO1xuXG4gIHByaXZhdGUgc2VsZWN0ZWRWYWx1ZTogYW55O1xuICBwcml2YXRlIGJhY2tncm91bmQ6IFVJUGFuZWw7XG4gIHByaXZhdGUgbGFiZWw6IFVJTGFiZWw7XG4gIHByaXZhdGUgZHJvcGRvd25Db250YWluZXI/OiBQSVhJLkNvbnRhaW5lcjtcbiAgcHJpdmF0ZSBkcm9wZG93blBhbmVsPzogVUlQYW5lbDtcbiAgcHJpdmF0ZSBvcHRpb25MYWJlbHM6IFVJTGFiZWxbXSA9IFtdO1xuICBwcml2YXRlIGlzT3BlbjogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHByaXZhdGUgaG92ZXJDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIHNlbGVjdGVkQ29sb3I6IG51bWJlcjtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlTZWxlY3RQcm9wcywgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBvcHRpb25zOiBwcm9wcy5vcHRpb25zID8/IFtdLFxuICAgICAgcGxhY2Vob2xkZXI6IHByb3BzLnBsYWNlaG9sZGVyID8/ICdTZWxlY3QuLi4nLFxuICAgICAgd2lkdGg6IHByb3BzLndpZHRoID8/IDIwMCxcbiAgICAgIGhlaWdodDogcHJvcHMuaGVpZ2h0ID8/IDM2LFxuICAgICAgZGlzYWJsZWQ6IHByb3BzLmRpc2FibGVkID8/IGZhbHNlLFxuICAgICAgYmFja2dyb3VuZENvbG9yOiBwcm9wcy5iYWNrZ3JvdW5kQ29sb3IgPz8gMHhmZmZmZmYsXG4gICAgICB0ZXh0Q29sb3I6IHByb3BzLnRleHRDb2xvciA/PyAweDAwMDAwMCxcbiAgICAgIGJvcmRlclJhZGl1czogcHJvcHMuYm9yZGVyUmFkaXVzID8/IDRcbiAgICB9O1xuXG4gICAgdGhpcy5vbkNoYW5nZSA9IHByb3BzLm9uQ2hhbmdlO1xuICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZSA9IHByb3BzLnZhbHVlID8/IHByb3BzLmRlZmF1bHRWYWx1ZTtcblxuICAgIC8vIENhbGN1bGF0ZSBjb2xvcnNcbiAgICB0aGlzLmhvdmVyQ29sb3IgPSB0aGlzLmRhcmtlbkNvbG9yKHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLCAwLjk1KTtcbiAgICB0aGlzLnNlbGVjdGVkQ29sb3IgPSB0aGlzLmRhcmtlbkNvbG9yKHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLCAwLjkpO1xuXG4gICAgLy8gU2V0IGJveCBtb2RlbCBkaW1lbnNpb25zXG4gICAgdGhpcy5ib3hNb2RlbC53aWR0aCA9IHRoaXMucHJvcHMud2lkdGg7XG4gICAgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcblxuICAgIC8vIENyZWF0ZSBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQuY29udGFpbmVyKTtcblxuICAgIC8vIENyZWF0ZSBsYWJlbCBmb3Igc2VsZWN0ZWQgdmFsdWVcbiAgICBjb25zdCBkaXNwbGF5VGV4dCA9IHRoaXMuZ2V0RGlzcGxheVRleHQoKTtcbiAgICB0aGlzLmxhYmVsID0gbmV3IFVJTGFiZWwoe1xuICAgICAgdGV4dDogZGlzcGxheVRleHQsXG4gICAgICBmb250U2l6ZTogMTQsXG4gICAgICBjb2xvcjogdGhpcy5zZWxlY3RlZFZhbHVlID8gdGhpcy5wcm9wcy50ZXh0Q29sb3IgOiAweDk5OTk5OSxcbiAgICAgIGFsaWduOiAnbGVmdCdcbiAgICB9LCB7XG4gICAgICBwYWRkaW5nOiBFZGdlSW5zZXRzLnN5bW1ldHJpYyg4LCAxMilcbiAgICB9KTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmxhYmVsLmNvbnRhaW5lcik7XG5cbiAgICAvLyBTZXR1cCBpbnRlcmFjdGl2aXR5XG4gICAgdGhpcy5zZXR1cEludGVyYWN0aXZpdHkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBkaXNwbGF5IHRleHQgYmFzZWQgb24gc2VsZWN0ZWQgdmFsdWVcbiAgICovXG4gIHByaXZhdGUgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcbiAgICBpZiAoIXRoaXMuc2VsZWN0ZWRWYWx1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMucGxhY2Vob2xkZXI7XG4gICAgfVxuXG4gICAgY29uc3Qgb3B0aW9uID0gdGhpcy5wcm9wcy5vcHRpb25zLmZpbmQob3B0ID0+IG9wdC52YWx1ZSA9PT0gdGhpcy5zZWxlY3RlZFZhbHVlKTtcbiAgICByZXR1cm4gb3B0aW9uID8gb3B0aW9uLmxhYmVsIDogdGhpcy5wcm9wcy5wbGFjZWhvbGRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHVwIG1vdXNlL3RvdWNoIGV2ZW50IGhhbmRsZXJzXG4gICAqL1xuICBwcml2YXRlIHNldHVwSW50ZXJhY3Rpdml0eSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICB0aGlzLmNvbnRhaW5lci5jdXJzb3IgPSAncG9pbnRlcic7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5vbigncG9pbnRlcmRvd24nLCB0aGlzLmhhbmRsZVBvaW50ZXJEb3duLmJpbmQodGhpcykpO1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyRG93bigpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wcm9wcy5kaXNhYmxlZCkgcmV0dXJuO1xuXG4gICAgaWYgKHRoaXMuaXNPcGVuKSB7XG4gICAgICB0aGlzLmNsb3NlRHJvcGRvd24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vcGVuRHJvcGRvd24oKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogT3BlbnMgdGhlIGRyb3Bkb3duIG1lbnVcbiAgICovXG4gIHByaXZhdGUgb3BlbkRyb3Bkb3duKCk6IHZvaWQge1xuICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcblxuICAgIC8vIENyZWF0ZSBkcm9wZG93biBjb250YWluZXJcbiAgICB0aGlzLmRyb3Bkb3duQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgdGhpcy5kcm9wZG93bkNvbnRhaW5lci5wb3NpdGlvbi5zZXQoMCwgdGhpcy5wcm9wcy5oZWlnaHQgKyA0KTtcblxuICAgIC8vIENyZWF0ZSBkcm9wZG93biBwYW5lbFxuICAgIGNvbnN0IGRyb3Bkb3duSGVpZ2h0ID0gTWF0aC5taW4odGhpcy5wcm9wcy5vcHRpb25zLmxlbmd0aCAqIDMyLCAyMDApO1xuICAgIHRoaXMuZHJvcGRvd25QYW5lbCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogZHJvcGRvd25IZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG4gICAgdGhpcy5kcm9wZG93bkNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmRyb3Bkb3duUGFuZWwuY29udGFpbmVyKTtcblxuICAgIC8vIENyZWF0ZSBvcHRpb24gbGFiZWxzXG4gICAgdGhpcy5vcHRpb25MYWJlbHMgPSBbXTtcbiAgICB0aGlzLnByb3BzLm9wdGlvbnMuZm9yRWFjaCgob3B0aW9uLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3Qgb3B0aW9uQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgICBvcHRpb25Db250YWluZXIucG9zaXRpb24uc2V0KDAsIGluZGV4ICogMzIpO1xuXG4gICAgICAvLyBPcHRpb24gYmFja2dyb3VuZFxuICAgICAgY29uc3Qgb3B0aW9uQmcgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgICAgb3B0aW9uQmcucmVjdCgwLCAwLCB0aGlzLnByb3BzLndpZHRoLCAzMik7XG4gICAgICBvcHRpb25CZy5maWxsKHsgY29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLCBhbHBoYTogMCB9KTtcbiAgICAgIG9wdGlvbkNvbnRhaW5lci5hZGRDaGlsZChvcHRpb25CZyk7XG5cbiAgICAgIC8vIE9wdGlvbiBsYWJlbFxuICAgICAgY29uc3Qgb3B0aW9uTGFiZWwgPSBuZXcgVUlMYWJlbCh7XG4gICAgICAgIHRleHQ6IG9wdGlvbi5sYWJlbCxcbiAgICAgICAgZm9udFNpemU6IDE0LFxuICAgICAgICBjb2xvcjogb3B0aW9uLmRpc2FibGVkID8gMHg5OTk5OTkgOiB0aGlzLnByb3BzLnRleHRDb2xvcixcbiAgICAgICAgYWxpZ246ICdsZWZ0J1xuICAgICAgfSwge1xuICAgICAgICBwYWRkaW5nOiBFZGdlSW5zZXRzLnN5bW1ldHJpYyg4LCAxMilcbiAgICAgIH0pO1xuICAgICAgb3B0aW9uTGFiZWwubGF5b3V0KHRoaXMucHJvcHMud2lkdGgsIDMyKTtcbiAgICAgIG9wdGlvbkNvbnRhaW5lci5hZGRDaGlsZChvcHRpb25MYWJlbC5jb250YWluZXIpO1xuXG4gICAgICBpZiAoIW9wdGlvbi5kaXNhYmxlZCkge1xuICAgICAgICBvcHRpb25Db250YWluZXIuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgICAgIG9wdGlvbkNvbnRhaW5lci5jdXJzb3IgPSAncG9pbnRlcic7XG5cbiAgICAgICAgLy8gSG92ZXIgZWZmZWN0XG4gICAgICAgIG9wdGlvbkNvbnRhaW5lci5vbigncG9pbnRlcm92ZXInLCAoKSA9PiB7XG4gICAgICAgICAgb3B0aW9uQmcuY2xlYXIoKTtcbiAgICAgICAgICBvcHRpb25CZy5yZWN0KDAsIDAsIHRoaXMucHJvcHMud2lkdGgsIDMyKTtcbiAgICAgICAgICBvcHRpb25CZy5maWxsKHsgY29sb3I6IHRoaXMuaG92ZXJDb2xvciB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgb3B0aW9uQ29udGFpbmVyLm9uKCdwb2ludGVyb3V0JywgKCkgPT4ge1xuICAgICAgICAgIG9wdGlvbkJnLmNsZWFyKCk7XG4gICAgICAgICAgb3B0aW9uQmcucmVjdCgwLCAwLCB0aGlzLnByb3BzLndpZHRoLCAzMik7XG4gICAgICAgICAgb3B0aW9uQmcuZmlsbCh7IGNvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciwgYWxwaGE6IDAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENsaWNrIGhhbmRsZXJcbiAgICAgICAgb3B0aW9uQ29udGFpbmVyLm9uKCdwb2ludGVyZG93bicsICgpID0+IHtcbiAgICAgICAgICB0aGlzLnNlbGVjdE9wdGlvbihvcHRpb24udmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5kcm9wZG93bkNvbnRhaW5lciEuYWRkQ2hpbGQob3B0aW9uQ29udGFpbmVyKTtcbiAgICAgIHRoaXMub3B0aW9uTGFiZWxzLnB1c2gob3B0aW9uTGFiZWwpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5kcm9wZG93bkNvbnRhaW5lcik7XG5cbiAgICAvLyBBZGQgY2xpY2sgb3V0c2lkZSBsaXN0ZW5lclxuICAgIHRoaXMuc2V0dXBDbGlja091dHNpZGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9zZXMgdGhlIGRyb3Bkb3duIG1lbnVcbiAgICovXG4gIHByaXZhdGUgY2xvc2VEcm9wZG93bigpOiB2b2lkIHtcbiAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xuXG4gICAgaWYgKHRoaXMuZHJvcGRvd25Db250YWluZXIpIHtcbiAgICAgIHRoaXMuY29udGFpbmVyLnJlbW92ZUNoaWxkKHRoaXMuZHJvcGRvd25Db250YWluZXIpO1xuICAgICAgdGhpcy5kcm9wZG93bkNvbnRhaW5lciA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMuZHJvcGRvd25QYW5lbCA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMub3B0aW9uTGFiZWxzID0gW107XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIGNsaWNrIG91dHNpZGUgbGlzdGVuZXJcbiAgICB0aGlzLnJlbW92ZUNsaWNrT3V0c2lkZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdHMgYW4gb3B0aW9uXG4gICAqL1xuICBwcml2YXRlIHNlbGVjdE9wdGlvbih2YWx1ZTogYW55KTogdm9pZCB7XG4gICAgdGhpcy5zZWxlY3RlZFZhbHVlID0gdmFsdWU7XG4gICAgdGhpcy5sYWJlbC5zZXRUZXh0KHRoaXMuZ2V0RGlzcGxheVRleHQoKSk7XG4gICAgdGhpcy5sYWJlbC5zZXRDb2xvcih0aGlzLnByb3BzLnRleHRDb2xvcik7XG5cbiAgICB0aGlzLm9uQ2hhbmdlPy4odmFsdWUpO1xuICAgIHRoaXMuY2xvc2VEcm9wZG93bigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHVwIGNsaWNrIG91dHNpZGUgZGV0ZWN0aW9uXG4gICAqL1xuICBwcml2YXRlIHNldHVwQ2xpY2tPdXRzaWRlKCk6IHZvaWQge1xuICAgIC8vIFNpbXBsZSBhcHByb2FjaDogY2xvc2Ugb24gYW55IG91dHNpZGUgY2xpY2tcbiAgICBjb25zdCBzdGFnZSA9IHRoaXMuY29udGFpbmVyLnBhcmVudDtcbiAgICBpZiAoc3RhZ2UpIHtcbiAgICAgIHN0YWdlLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgICAgc3RhZ2Uub25jZSgncG9pbnRlcmRvd24nLCAoZSkgPT4ge1xuICAgICAgICAvLyBDaGVjayBpZiBjbGljayBpcyBvdXRzaWRlXG4gICAgICAgIGNvbnN0IHBvaW50ID0gZS5nbG9iYWw7XG4gICAgICAgIGNvbnN0IGJvdW5kcyA9IHRoaXMuY29udGFpbmVyLmdldEJvdW5kcygpO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHBvaW50IGlzIHdpdGhpbiBib3VuZHMgbWFudWFsbHlcbiAgICAgICAgaWYgKHBvaW50LnggPCBib3VuZHMueCB8fCBwb2ludC54ID4gYm91bmRzLnggKyBib3VuZHMud2lkdGggfHxcbiAgICAgICAgICAgIHBvaW50LnkgPCBib3VuZHMueSB8fCBwb2ludC55ID4gYm91bmRzLnkgKyBib3VuZHMuaGVpZ2h0KSB7XG4gICAgICAgICAgdGhpcy5jbG9zZURyb3Bkb3duKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgY2xpY2sgb3V0c2lkZSBkZXRlY3Rpb25cbiAgICovXG4gIHByaXZhdGUgcmVtb3ZlQ2xpY2tPdXRzaWRlKCk6IHZvaWQge1xuICAgIC8vIEhhbmRsZWQgYnkgJ29uY2UnIGluIHNldHVwQ2xpY2tPdXRzaWRlXG4gIH1cblxuICAvKipcbiAgICogRGFya2VucyBhIGNvbG9yIGJ5IGEgZmFjdG9yXG4gICAqL1xuICBwcml2YXRlIGRhcmtlbkNvbG9yKGNvbG9yOiBudW1iZXIsIGZhY3RvcjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBjb25zdCByID0gKChjb2xvciA+PiAxNikgJiAweGZmKSAqIGZhY3RvcjtcbiAgICBjb25zdCBnID0gKChjb2xvciA+PiA4KSAmIDB4ZmYpICogZmFjdG9yO1xuICAgIGNvbnN0IGIgPSAoY29sb3IgJiAweGZmKSAqIGZhY3RvcjtcbiAgICByZXR1cm4gKChyIDw8IDE2KSB8IChnIDw8IDgpIHwgYikgPj4+IDA7XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgdGhlIHNpemUgbmVlZGVkIGZvciB0aGlzIHNlbGVjdFxuICAgKi9cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHRcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGxheW91dCBmb3IgdGhpcyBzZWxlY3RcbiAgICovXG4gIGxheW91dChhdmFpbGFibGVXaWR0aDogbnVtYmVyLCBhdmFpbGFibGVIZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG5cbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG5cbiAgICAvLyBMYXlvdXQgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZC5sYXlvdXQobWVhc3VyZWQud2lkdGgsIG1lYXN1cmVkLmhlaWdodCk7XG5cbiAgICAvLyBMYXlvdXQgbGFiZWxcbiAgICB0aGlzLmxhYmVsLmxheW91dChtZWFzdXJlZC53aWR0aCwgbWVhc3VyZWQuaGVpZ2h0KTtcblxuICAgIHRoaXMubGF5b3V0RGlydHkgPSBmYWxzZTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIHNlbGVjdFxuICAgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICAvLyBSZW5kZXJpbmcgaGFuZGxlZCBieSBiYWNrZ3JvdW5kIGFuZCBsYWJlbFxuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHNlbGVjdGVkIHZhbHVlIHByb2dyYW1tYXRpY2FsbHlcbiAgICovXG4gIHNldFZhbHVlKHZhbHVlOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLnNlbGVjdGVkVmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLmxhYmVsLnNldFRleHQodGhpcy5nZXREaXNwbGF5VGV4dCgpKTtcbiAgICB0aGlzLmxhYmVsLnNldENvbG9yKHRoaXMucHJvcHMudGV4dENvbG9yKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IHNlbGVjdGVkIHZhbHVlXG4gICAqL1xuICBnZXRWYWx1ZSgpOiBhbnkge1xuICAgIHJldHVybiB0aGlzLnNlbGVjdGVkVmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgb3B0aW9uc1xuICAgKi9cbiAgc2V0T3B0aW9ucyhvcHRpb25zOiBTZWxlY3RPcHRpb25bXSk6IHZvaWQge1xuICAgIHRoaXMucHJvcHMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgaWYgKHRoaXMuaXNPcGVuKSB7XG4gICAgICB0aGlzLmNsb3NlRHJvcGRvd24oKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5pbXBvcnQgeyBVSUxhYmVsIH0gZnJvbSAnLi91aS1sYWJlbCc7XG5pbXBvcnQgeyBVSVBhbmVsIH0gZnJvbSAnLi91aS1wYW5lbCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGFiSXRlbSB7XG4gIGtleTogc3RyaW5nO1xuICBsYWJlbDogc3RyaW5nO1xuICBjb250ZW50OiBVSUNvbXBvbmVudDtcbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVJVGFic1Byb3BzIHtcbiAgaXRlbXM6IFRhYkl0ZW1bXTtcbiAgYWN0aXZlS2V5Pzogc3RyaW5nO1xuICBkZWZhdWx0QWN0aXZlS2V5Pzogc3RyaW5nO1xuICBvbkNoYW5nZT86IChhY3RpdmVLZXk6IHN0cmluZykgPT4gdm9pZDtcbiAgdHlwZT86ICdsaW5lJyB8ICdjYXJkJztcbiAgdGFiUG9zaXRpb24/OiAndG9wJyB8ICdib3R0b20nO1xuICB3aWR0aD86IG51bWJlcjtcbiAgaGVpZ2h0PzogbnVtYmVyO1xuICB0YWJCYXJCYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIHRhYkJhckhlaWdodD86IG51bWJlcjtcbiAgYWN0aXZlVGFiQ29sb3I/OiBudW1iZXI7XG4gIGluYWN0aXZlVGFiQ29sb3I/OiBudW1iZXI7XG4gIHRleHRDb2xvcj86IG51bWJlcjtcbiAgYWN0aXZlVGV4dENvbG9yPzogbnVtYmVyO1xuICBoYXNoUHJlZml4Pzogc3RyaW5nOyAvLyBlLmcuLCBcInVpLXNob3djYXNlXCIgY3JlYXRlcyBVUkxzIGxpa2UgI3VpLXNob3djYXNlL2Jhc2ljc1xufVxuXG5leHBvcnQgY2xhc3MgVUlUYWJzIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIGl0ZW1zOiBUYWJJdGVtW107XG4gIHByaXZhdGUgYWN0aXZlS2V5OiBzdHJpbmc7XG4gIHByaXZhdGUgb25DaGFuZ2U/OiAoYWN0aXZlS2V5OiBzdHJpbmcpID0+IHZvaWQ7XG4gIHByaXZhdGUgdHlwZTogJ2xpbmUnIHwgJ2NhcmQnO1xuICBwcml2YXRlIHRhYlBvc2l0aW9uOiAndG9wJyB8ICdib3R0b20nO1xuICBwcml2YXRlIHdpZHRoOiBudW1iZXI7XG4gIHByaXZhdGUgaGVpZ2h0OiBudW1iZXI7XG4gIHByaXZhdGUgdGFiQmFyQmFja2dyb3VuZENvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgdGFiQmFySGVpZ2h0OiBudW1iZXI7XG4gIHByaXZhdGUgYWN0aXZlVGFiQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBpbmFjdGl2ZVRhYkNvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgdGV4dENvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgYWN0aXZlVGV4dENvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgaGFzaFByZWZpeD86IHN0cmluZztcblxuICBwcml2YXRlIHRhYkJhcjogUElYSS5Db250YWluZXI7XG4gIHByaXZhdGUgY29udGVudEFyZWE6IFBJWEkuQ29udGFpbmVyO1xuICBwcml2YXRlIHRhYkJ1dHRvbnM6IE1hcDxzdHJpbmcsIHsgY29udGFpbmVyOiBQSVhJLkNvbnRhaW5lcjsgbGFiZWw6IFVJTGFiZWw7IGJnOiBQSVhJLkdyYXBoaWNzIH0+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIGFjdGl2ZUluZGljYXRvcj86IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgaGFzaENoYW5nZUhhbmRsZXI/OiAoKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSVRhYnNQcm9wcywgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMuaXRlbXMgPSBwcm9wcy5pdGVtcyB8fCBbXTtcbiAgICB0aGlzLm9uQ2hhbmdlID0gcHJvcHMub25DaGFuZ2U7XG4gICAgdGhpcy50eXBlID0gcHJvcHMudHlwZSB8fCAnbGluZSc7XG4gICAgdGhpcy50YWJQb3NpdGlvbiA9IHByb3BzLnRhYlBvc2l0aW9uIHx8ICd0b3AnO1xuICAgIHRoaXMudGFiQmFyQmFja2dyb3VuZENvbG9yID0gcHJvcHMudGFiQmFyQmFja2dyb3VuZENvbG9yID8/IDB4MmQyZDQ0O1xuICAgIHRoaXMudGFiQmFySGVpZ2h0ID0gcHJvcHMudGFiQmFySGVpZ2h0ID8/IDQ4O1xuICAgIHRoaXMuYWN0aXZlVGFiQ29sb3IgPSBwcm9wcy5hY3RpdmVUYWJDb2xvciA/PyAweDE4OTBmZjtcbiAgICB0aGlzLmluYWN0aXZlVGFiQ29sb3IgPSBwcm9wcy5pbmFjdGl2ZVRhYkNvbG9yID8/IDB4M2QzZDU0O1xuICAgIHRoaXMudGV4dENvbG9yID0gcHJvcHMudGV4dENvbG9yID8/IDB4YWFhYWFhO1xuICAgIHRoaXMuYWN0aXZlVGV4dENvbG9yID0gcHJvcHMuYWN0aXZlVGV4dENvbG9yID8/IDB4ZmZmZmZmO1xuICAgIHRoaXMuaGFzaFByZWZpeCA9IHByb3BzLmhhc2hQcmVmaXg7XG5cbiAgICAvLyBEZXRlcm1pbmUgYWN0aXZlIGtleSAtIGNoZWNrIFVSTCBoYXNoIGZpcnN0IGlmIGhhc2hQcmVmaXggaXMgcHJvdmlkZWRcbiAgICBsZXQgaW5pdGlhbEtleSA9IHByb3BzLmFjdGl2ZUtleSB8fCBwcm9wcy5kZWZhdWx0QWN0aXZlS2V5IHx8ICh0aGlzLml0ZW1zLmxlbmd0aCA+IDAgPyB0aGlzLml0ZW1zWzBdLmtleSA6ICcnKTtcbiAgICBpZiAodGhpcy5oYXNoUHJlZml4ICYmICFwcm9wcy5hY3RpdmVLZXkpIHtcbiAgICAgIGNvbnN0IGhhc2hLZXkgPSB0aGlzLmdldEtleUZyb21IYXNoKCk7XG4gICAgICBpZiAoaGFzaEtleSAmJiB0aGlzLml0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLmtleSA9PT0gaGFzaEtleSkpIHtcbiAgICAgICAgaW5pdGlhbEtleSA9IGhhc2hLZXk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuYWN0aXZlS2V5ID0gaW5pdGlhbEtleTtcblxuICAgIHRoaXMud2lkdGggPSBwcm9wcy53aWR0aCA/PyA4MDA7XG4gICAgdGhpcy5oZWlnaHQgPSBwcm9wcy5oZWlnaHQgPz8gNjAwO1xuXG4gICAgdGhpcy50YWJCYXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICB0aGlzLmNvbnRlbnRBcmVhID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnRhYkJhcik7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5jb250ZW50QXJlYSk7XG5cbiAgICB0aGlzLmJ1aWxkVGFicygpO1xuICAgIHRoaXMuc2hvd0FjdGl2ZVRhYigpO1xuXG4gICAgLy8gU2V0IHVwIGhhc2ggY2hhbmdlIGxpc3RlbmVyIGlmIGhhc2hQcmVmaXggaXMgcHJvdmlkZWRcbiAgICBpZiAodGhpcy5oYXNoUHJlZml4KSB7XG4gICAgICB0aGlzLnNldHVwSGFzaExpc3RlbmVyKCk7XG4gICAgICAvLyBVcGRhdGUgaGFzaCB0byBtYXRjaCBpbml0aWFsIGFjdGl2ZSBrZXlcbiAgICAgIHRoaXMudXBkYXRlSGFzaCh0aGlzLmFjdGl2ZUtleSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRLZXlGcm9tSGFzaCgpOiBzdHJpbmcgfCBudWxsIHtcbiAgICBpZiAoIXRoaXMuaGFzaFByZWZpeCkgcmV0dXJuIG51bGw7XG4gICAgY29uc3QgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnNsaWNlKDEpOyAvLyBSZW1vdmUgI1xuICAgIGNvbnN0IHByZWZpeCA9IGAke3RoaXMuaGFzaFByZWZpeH0vYDtcbiAgICBpZiAoaGFzaC5zdGFydHNXaXRoKHByZWZpeCkpIHtcbiAgICAgIHJldHVybiBoYXNoLnNsaWNlKHByZWZpeC5sZW5ndGgpO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlSGFzaChrZXk6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICghdGhpcy5oYXNoUHJlZml4KSByZXR1cm47XG4gICAgY29uc3QgbmV3SGFzaCA9IGAjJHt0aGlzLmhhc2hQcmVmaXh9LyR7a2V5fWA7XG4gICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5oYXNoICE9PSBuZXdIYXNoKSB7XG4gICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9IG5ld0hhc2g7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzZXR1cEhhc2hMaXN0ZW5lcigpOiB2b2lkIHtcbiAgICB0aGlzLmhhc2hDaGFuZ2VIYW5kbGVyID0gKCkgPT4ge1xuICAgICAgY29uc3QgaGFzaEtleSA9IHRoaXMuZ2V0S2V5RnJvbUhhc2goKTtcbiAgICAgIGlmIChoYXNoS2V5ICYmIGhhc2hLZXkgIT09IHRoaXMuYWN0aXZlS2V5KSB7XG4gICAgICAgIHRoaXMuc2V0QWN0aXZlS2V5KGhhc2hLZXksIGZhbHNlKTsgLy8gZmFsc2UgPSBkb24ndCB1cGRhdGUgaGFzaCAoYWxyZWFkeSBjaGFuZ2VkKVxuICAgICAgfVxuICAgIH07XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2hhc2hjaGFuZ2UnLCB0aGlzLmhhc2hDaGFuZ2VIYW5kbGVyKTtcbiAgfVxuXG4gIHB1YmxpYyBkZXN0cm95KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmhhc2hDaGFuZ2VIYW5kbGVyKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIHRoaXMuaGFzaENoYW5nZUhhbmRsZXIpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRUYWJzKCk6IHZvaWQge1xuICAgIC8vIENsZWFyIGV4aXN0aW5nIHRhYnNcbiAgICB0aGlzLnRhYkJhci5yZW1vdmVDaGlsZHJlbigpO1xuICAgIHRoaXMudGFiQnV0dG9ucy5jbGVhcigpO1xuXG4gICAgLy8gQ3JlYXRlIHRhYiBiYXIgYmFja2dyb3VuZFxuICAgIGNvbnN0IHRhYkJhckJnID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0YWJCYXJCZy5yZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0KTtcbiAgICB0YWJCYXJCZy5maWxsKHsgY29sb3I6IHRoaXMudGFiQmFyQmFja2dyb3VuZENvbG9yIH0pO1xuICAgIHRoaXMudGFiQmFyLmFkZENoaWxkKHRhYkJhckJnKTtcblxuICAgIC8vIEFkZCBib3R0b20gYm9yZGVyIGxpbmUgZm9yIGxpbmUgdHlwZVxuICAgIGlmICh0aGlzLnR5cGUgPT09ICdsaW5lJykge1xuICAgICAgY29uc3QgYm9yZGVyTGluZSA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgICBib3JkZXJMaW5lLnJlY3QoMCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCB0aGlzLndpZHRoLCAyKTtcbiAgICAgIGJvcmRlckxpbmUuZmlsbCh7IGNvbG9yOiAweDNkM2Q1NCwgYWxwaGE6IDAuNSB9KTtcbiAgICAgIHRoaXMudGFiQmFyLmFkZENoaWxkKGJvcmRlckxpbmUpO1xuICAgIH1cblxuICAgIC8vIFBvc2l0aW9uIHRhYiBiYXJcbiAgICBpZiAodGhpcy50YWJQb3NpdGlvbiA9PT0gJ2JvdHRvbScpIHtcbiAgICAgIHRoaXMudGFiQmFyLnkgPSB0aGlzLmhlaWdodCAtIHRoaXMudGFiQmFySGVpZ2h0O1xuICAgICAgdGhpcy5jb250ZW50QXJlYS55ID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50YWJCYXIueSA9IDA7XG4gICAgICB0aGlzLmNvbnRlbnRBcmVhLnkgPSB0aGlzLnRhYkJhckhlaWdodDtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgdGFic1xuICAgIGxldCB4T2Zmc2V0ID0gODsgLy8gU3RhcnQgd2l0aCBzb21lIGxlZnQgcGFkZGluZ1xuICAgIGNvbnN0IHRhYlBhZGRpbmcgPSAyNDtcbiAgICBjb25zdCB0YWJHYXAgPSA4O1xuXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIHRoaXMuaXRlbXMpIHtcbiAgICAgIGlmIChpdGVtLmRpc2FibGVkKSBjb250aW51ZTtcblxuICAgICAgY29uc3QgdGFiQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgICB0YWJDb250YWluZXIueCA9IHhPZmZzZXQ7XG5cbiAgICAgIC8vIFRhYiBsYWJlbFxuICAgICAgY29uc3QgaXNBY3RpdmUgPSB0aGlzLmFjdGl2ZUtleSA9PT0gaXRlbS5rZXk7XG4gICAgICBjb25zdCBsYWJlbCA9IG5ldyBVSUxhYmVsKHtcbiAgICAgICAgdGV4dDogaXRlbS5sYWJlbCxcbiAgICAgICAgZm9udFNpemU6IDE1LFxuICAgICAgICBmb250V2VpZ2h0OiBpc0FjdGl2ZSA/ICdib2xkJyA6ICdub3JtYWwnLFxuICAgICAgICBjb2xvcjogaXNBY3RpdmUgPyB0aGlzLmFjdGl2ZVRleHRDb2xvciA6IHRoaXMudGV4dENvbG9yXG4gICAgICB9KTtcblxuICAgICAgLy8gTWVhc3VyZSBsYWJlbCB0byBkZXRlcm1pbmUgdGFiIHdpZHRoXG4gICAgICBsYWJlbC5tZWFzdXJlKCk7XG4gICAgICBsYWJlbC5sYXlvdXQodGhpcy53aWR0aCwgdGhpcy50YWJCYXJIZWlnaHQpO1xuICAgICAgY29uc3QgbGFiZWxCb3VuZHMgPSBsYWJlbC5jb250YWluZXIuZ2V0TG9jYWxCb3VuZHMoKTtcbiAgICAgIGNvbnN0IHRhYldpZHRoID0gbGFiZWxCb3VuZHMud2lkdGggKyAodGFiUGFkZGluZyAqIDIpO1xuXG4gICAgICAvLyBUYWIgYmFja2dyb3VuZFxuICAgICAgbGV0IGJnOiBQSVhJLkdyYXBoaWNzO1xuICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2NhcmQnKSB7XG4gICAgICAgIGJnID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICAgICAgYmcucm91bmRSZWN0KDAsIDAsIHRhYldpZHRoLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIDYpO1xuICAgICAgICBiZy5maWxsKHsgY29sb3I6IGlzQWN0aXZlID8gdGhpcy5hY3RpdmVUYWJDb2xvciA6IHRoaXMuaW5hY3RpdmVUYWJDb2xvciB9KTtcbiAgICAgICAgLy8gQWRkIGJvcmRlciBmb3IgY2FyZCB0eXBlXG4gICAgICAgIGJnLnJvdW5kUmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgYmcuc3Ryb2tlKHsgY29sb3I6IGlzQWN0aXZlID8gdGhpcy5hY3RpdmVUYWJDb2xvciA6IDB4NGQ0ZDY0LCB3aWR0aDogMiB9KTtcbiAgICAgICAgdGFiQ29udGFpbmVyLmFkZENoaWxkKGJnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZvciBsaW5lIHR5cGUsIE5PIGJhY2tncm91bmQgb3IgYm9yZGVyIC0ganVzdCB0cmFuc3BhcmVudCBoaXQgYXJlYVxuICAgICAgICBiZyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgICAgIGJnLnJlY3QoMCwgMCwgdGFiV2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0KTtcbiAgICAgICAgYmcuZmlsbCh7IGNvbG9yOiAweDAwMDAwMCwgYWxwaGE6IDAgfSk7XG4gICAgICAgIHRhYkNvbnRhaW5lci5hZGRDaGlsZChiZyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFBvc2l0aW9uIGxhYmVsIGNlbnRlcmVkIGluIHRhYlxuICAgICAgbGFiZWwuY29udGFpbmVyLnggPSB0YWJQYWRkaW5nO1xuICAgICAgbGFiZWwuY29udGFpbmVyLnkgPSAodGhpcy50YWJCYXJIZWlnaHQgLSBsYWJlbEJvdW5kcy5oZWlnaHQpIC8gMjtcbiAgICAgIHRhYkNvbnRhaW5lci5hZGRDaGlsZChsYWJlbC5jb250YWluZXIpO1xuXG4gICAgICAvLyBNYWtlIHRhYiBpbnRlcmFjdGl2ZVxuICAgICAgdGFiQ29udGFpbmVyLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgICAgdGFiQ29udGFpbmVyLmN1cnNvciA9ICdwb2ludGVyJztcblxuICAgICAgY29uc3QgdGFiS2V5ID0gaXRlbS5rZXk7XG4gICAgICB0YWJDb250YWluZXIub24oJ3BvaW50ZXJkb3duJywgKCkgPT4ge1xuICAgICAgICB0aGlzLnNldEFjdGl2ZUtleSh0YWJLZXkpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEhvdmVyIGVmZmVjdFxuICAgICAgdGFiQ29udGFpbmVyLm9uKCdwb2ludGVyb3ZlcicsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlS2V5ICE9PSB0YWJLZXkpIHtcbiAgICAgICAgICBpZiAodGhpcy50eXBlID09PSAnY2FyZCcpIHtcbiAgICAgICAgICAgIGJnLmNsZWFyKCk7XG4gICAgICAgICAgICBiZy5yb3VuZFJlY3QoMCwgMCwgdGFiV2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgNik7XG4gICAgICAgICAgICBiZy5maWxsKHsgY29sb3I6IHRoaXMuYWN0aXZlVGFiQ29sb3IsIGFscGhhOiAwLjUgfSk7XG4gICAgICAgICAgICBiZy5yb3VuZFJlY3QoMCwgMCwgdGFiV2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgNik7XG4gICAgICAgICAgICBiZy5zdHJva2UoeyBjb2xvcjogdGhpcy5hY3RpdmVUYWJDb2xvciwgd2lkdGg6IDIgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEZvciBsaW5lIHR5cGUsIGp1c3QgY2hhbmdlIHRleHQgY29sb3Igb24gaG92ZXJcbiAgICAgICAgICAgIGxhYmVsLnNldENvbG9yKHRoaXMuYWN0aXZlVGV4dENvbG9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB0YWJDb250YWluZXIub24oJ3BvaW50ZXJvdXQnLCAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZUtleSAhPT0gdGFiS2V5KSB7XG4gICAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2NhcmQnKSB7XG4gICAgICAgICAgICBiZy5jbGVhcigpO1xuICAgICAgICAgICAgYmcucm91bmRSZWN0KDAsIDAsIHRhYldpZHRoLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIDYpO1xuICAgICAgICAgICAgYmcuZmlsbCh7IGNvbG9yOiB0aGlzLmluYWN0aXZlVGFiQ29sb3IgfSk7XG4gICAgICAgICAgICBiZy5yb3VuZFJlY3QoMCwgMCwgdGFiV2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgNik7XG4gICAgICAgICAgICBiZy5zdHJva2UoeyBjb2xvcjogMHg0ZDRkNjQsIHdpZHRoOiAyIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBSZXN0b3JlIG11dGVkIHRleHQgY29sb3JcbiAgICAgICAgICAgIGxhYmVsLnNldENvbG9yKHRoaXMudGV4dENvbG9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLnRhYkJhci5hZGRDaGlsZCh0YWJDb250YWluZXIpO1xuICAgICAgdGhpcy50YWJCdXR0b25zLnNldChpdGVtLmtleSwgeyBjb250YWluZXI6IHRhYkNvbnRhaW5lciwgbGFiZWwsIGJnIH0pO1xuXG4gICAgICB4T2Zmc2V0ICs9IHRhYldpZHRoICsgdGFiR2FwO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBhY3RpdmUgaW5kaWNhdG9yIGZvciBsaW5lIHR5cGVcbiAgICBpZiAodGhpcy50eXBlID09PSAnbGluZScpIHtcbiAgICAgIHRoaXMuYWN0aXZlSW5kaWNhdG9yID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICAgIHRoaXMudGFiQmFyLmFkZENoaWxkKHRoaXMuYWN0aXZlSW5kaWNhdG9yKTtcbiAgICAgIHRoaXMudXBkYXRlQWN0aXZlSW5kaWNhdG9yKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVBY3RpdmVJbmRpY2F0b3IoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmFjdGl2ZUluZGljYXRvciB8fCB0aGlzLnR5cGUgIT09ICdsaW5lJykgcmV0dXJuO1xuXG4gICAgdGhpcy5hY3RpdmVJbmRpY2F0b3IuY2xlYXIoKTtcblxuICAgIGNvbnN0IGFjdGl2ZVRhYiA9IHRoaXMudGFiQnV0dG9ucy5nZXQodGhpcy5hY3RpdmVLZXkpO1xuICAgIGlmICghYWN0aXZlVGFiKSByZXR1cm47XG5cbiAgICBjb25zdCB0YWJYID0gYWN0aXZlVGFiLmNvbnRhaW5lci54O1xuICAgIGNvbnN0IHRhYkJvdW5kcyA9IGFjdGl2ZVRhYi5iZy5nZXRMb2NhbEJvdW5kcygpO1xuICAgIGNvbnN0IHRhYldpZHRoID0gdGFiQm91bmRzLndpZHRoO1xuICAgIGNvbnN0IGluZGljYXRvckhlaWdodCA9IDM7XG4gICAgY29uc3QgaW5kaWNhdG9yWSA9IHRoaXMudGFiQmFySGVpZ2h0IC0gaW5kaWNhdG9ySGVpZ2h0O1xuXG4gICAgLy8gRHJhdyBpbmRpY2F0b3IgYXQgdGhlIHZlcnkgYm90dG9tLCBzcGFubmluZyBtb3N0IG9mIHRoZSB0YWIgd2lkdGhcbiAgICB0aGlzLmFjdGl2ZUluZGljYXRvci5yb3VuZFJlY3QodGFiWCArIDgsIGluZGljYXRvclksIHRhYldpZHRoIC0gMTYsIGluZGljYXRvckhlaWdodCwgMS41KTtcbiAgICB0aGlzLmFjdGl2ZUluZGljYXRvci5maWxsKHsgY29sb3I6IHRoaXMuYWN0aXZlVGFiQ29sb3IgfSk7XG4gIH1cblxuICBwcml2YXRlIHNob3dBY3RpdmVUYWIoKTogdm9pZCB7XG4gICAgLy8gQ2xlYXIgY29udGVudCBhcmVhXG4gICAgdGhpcy5jb250ZW50QXJlYS5yZW1vdmVDaGlsZHJlbigpO1xuXG4gICAgLy8gRmluZCBhY3RpdmUgaXRlbVxuICAgIGNvbnN0IGFjdGl2ZUl0ZW0gPSB0aGlzLml0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLmtleSA9PT0gdGhpcy5hY3RpdmVLZXkpO1xuICAgIGlmICghYWN0aXZlSXRlbSkgcmV0dXJuO1xuXG4gICAgLy8gQWRkIGNvbnRlbnRcbiAgICBjb25zdCBjb250ZW50SGVpZ2h0ID0gdGhpcy5oZWlnaHQgLSB0aGlzLnRhYkJhckhlaWdodDtcbiAgICBhY3RpdmVJdGVtLmNvbnRlbnQubGF5b3V0KHRoaXMud2lkdGgsIGNvbnRlbnRIZWlnaHQpO1xuICAgIHRoaXMuY29udGVudEFyZWEuYWRkQ2hpbGQoYWN0aXZlSXRlbS5jb250ZW50LmNvbnRhaW5lcik7XG5cbiAgICAvLyBVcGRhdGUgdGFiIHN0eWxlc1xuICAgIHRoaXMudGFiQnV0dG9ucy5mb3JFYWNoKCh0YWIsIGtleSkgPT4ge1xuICAgICAgY29uc3QgaXNBY3RpdmUgPSBrZXkgPT09IHRoaXMuYWN0aXZlS2V5O1xuICAgICAgY29uc3QgdGFiQm91bmRzID0gdGFiLmJnLmdldExvY2FsQm91bmRzKCk7XG5cbiAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdjYXJkJykge1xuICAgICAgICB0YWIuYmcuY2xlYXIoKTtcbiAgICAgICAgdGFiLmJnLnJvdW5kUmVjdCgwLCAwLCB0YWJCb3VuZHMud2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgNik7XG4gICAgICAgIHRhYi5iZy5maWxsKHsgY29sb3I6IGlzQWN0aXZlID8gdGhpcy5hY3RpdmVUYWJDb2xvciA6IHRoaXMuaW5hY3RpdmVUYWJDb2xvciB9KTtcbiAgICAgICAgdGFiLmJnLnJvdW5kUmVjdCgwLCAwLCB0YWJCb3VuZHMud2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgNik7XG4gICAgICAgIHRhYi5iZy5zdHJva2UoeyBjb2xvcjogaXNBY3RpdmUgPyB0aGlzLmFjdGl2ZVRhYkNvbG9yIDogMHg0ZDRkNjQsIHdpZHRoOiAyIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRm9yIGxpbmUgdHlwZSwga2VlcCB0cmFuc3BhcmVudCBiYWNrZ3JvdW5kXG4gICAgICAgIHRhYi5iZy5jbGVhcigpO1xuICAgICAgICB0YWIuYmcucmVjdCgwLCAwLCB0YWJCb3VuZHMud2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0KTtcbiAgICAgICAgdGFiLmJnLmZpbGwoeyBjb2xvcjogMHgwMDAwMDAsIGFscGhhOiAwIH0pO1xuICAgICAgfVxuXG4gICAgICB0YWIubGFiZWwuc2V0Q29sb3IoaXNBY3RpdmUgPyB0aGlzLmFjdGl2ZVRleHRDb2xvciA6IHRoaXMudGV4dENvbG9yKTtcbiAgICAgIHRhYi5sYWJlbC5jb250YWluZXIuYWxwaGEgPSAxO1xuICAgIH0pO1xuXG4gICAgLy8gVXBkYXRlIGFjdGl2ZSBpbmRpY2F0b3JcbiAgICBpZiAodGhpcy50eXBlID09PSAnbGluZScpIHtcbiAgICAgIHRoaXMudXBkYXRlQWN0aXZlSW5kaWNhdG9yKCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHNldEFjdGl2ZUtleShrZXk6IHN0cmluZywgdXBkYXRlSGFzaDogYm9vbGVhbiA9IHRydWUpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5hY3RpdmVLZXkgPT09IGtleSkgcmV0dXJuO1xuXG4gICAgY29uc3QgaXRlbSA9IHRoaXMuaXRlbXMuZmluZChpdGVtID0+IGl0ZW0ua2V5ID09PSBrZXkpO1xuICAgIGlmICghaXRlbSB8fCBpdGVtLmRpc2FibGVkKSByZXR1cm47XG5cbiAgICB0aGlzLmFjdGl2ZUtleSA9IGtleTtcbiAgICB0aGlzLnNob3dBY3RpdmVUYWIoKTtcblxuICAgIC8vIFVwZGF0ZSBVUkwgaGFzaCBpZiBlbmFibGVkXG4gICAgaWYgKHVwZGF0ZUhhc2ggJiYgdGhpcy5oYXNoUHJlZml4KSB7XG4gICAgICB0aGlzLnVwZGF0ZUhhc2goa2V5KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5vbkNoYW5nZSkge1xuICAgICAgdGhpcy5vbkNoYW5nZShrZXkpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBnZXRBY3RpdmVLZXkoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5hY3RpdmVLZXk7XG4gIH1cblxuICBwdWJsaWMgc2V0SXRlbXMoaXRlbXM6IFRhYkl0ZW1bXSk6IHZvaWQge1xuICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcblxuICAgIC8vIElmIGFjdGl2ZSBrZXkgbm8gbG9uZ2VyIGV4aXN0cywgc3dpdGNoIHRvIGZpcnN0IHRhYlxuICAgIGlmICghdGhpcy5pdGVtcy5maW5kKGl0ZW0gPT4gaXRlbS5rZXkgPT09IHRoaXMuYWN0aXZlS2V5KSkge1xuICAgICAgdGhpcy5hY3RpdmVLZXkgPSB0aGlzLml0ZW1zLmxlbmd0aCA+IDAgPyB0aGlzLml0ZW1zWzBdLmtleSA6ICcnO1xuICAgIH1cblxuICAgIHRoaXMuYnVpbGRUYWJzKCk7XG4gICAgdGhpcy5zaG93QWN0aXZlVGFiKCk7XG4gIH1cblxuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0aGlzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodFxuICAgIH07XG4gIH1cblxuICBsYXlvdXQod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAvLyBSZWJ1aWxkIHRhYnMgd2l0aCBuZXcgZGltZW5zaW9uc1xuICAgIHRoaXMuYnVpbGRUYWJzKCk7XG4gICAgdGhpcy5zaG93QWN0aXZlVGFiKCk7XG4gIH1cblxuICByZW5kZXIoKTogdm9pZCB7XG4gICAgLy8gUmVuZGVyaW5nIGlzIGhhbmRsZWQgYnkgY2hpbGQgY29tcG9uZW50c1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcbmltcG9ydCB7IFVJUGFuZWwgfSBmcm9tICcuL3VpLXBhbmVsJztcbmltcG9ydCB7IEVkZ2VJbnNldHMgfSBmcm9tICcuLi9jb3JlL2VkZ2UtaW5zZXRzJztcbmltcG9ydCB7IFVJRm9jdXNNYW5hZ2VyIH0gZnJvbSAnLi4vY29yZS91aS1mb2N1cy1tYW5hZ2VyJztcblxuLyoqXG4gKiBQcm9wcyBmb3IgY29uZmlndXJpbmcgYSBVSVRleHRJbnB1dFxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFVJVGV4dElucHV0UHJvcHMge1xuICAvKiogQ3VycmVudCB2YWx1ZSAoY29udHJvbGxlZCkgKi9cbiAgdmFsdWU/OiBzdHJpbmc7XG4gIC8qKiBEZWZhdWx0IHZhbHVlICh1bmNvbnRyb2xsZWQpICovXG4gIGRlZmF1bHRWYWx1ZT86IHN0cmluZztcbiAgLyoqIENoYW5nZSBjYWxsYmFjayAqL1xuICBvbkNoYW5nZT86ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xuICAvKiogUGxhY2Vob2xkZXIgdGV4dCB3aGVuIGVtcHR5ICovXG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xuICAvKiogTWF4aW11bSBjaGFyYWN0ZXIgbGVuZ3RoICovXG4gIG1heExlbmd0aD86IG51bWJlcjtcbiAgLyoqIFdpZHRoIG9mIHRoZSBpbnB1dCAqL1xuICB3aWR0aD86IG51bWJlcjtcbiAgLyoqIEhlaWdodCBvZiB0aGUgaW5wdXQgKi9cbiAgaGVpZ2h0PzogbnVtYmVyO1xuICAvKiogV2hldGhlciB0aGUgaW5wdXQgaXMgZGlzYWJsZWQgKi9cbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICAvKiogQmFja2dyb3VuZCBjb2xvciAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBUZXh0IGNvbG9yICovXG4gIHRleHRDb2xvcj86IG51bWJlcjtcbiAgLyoqIFBsYWNlaG9sZGVyIHRleHQgY29sb3IgKi9cbiAgcGxhY2Vob2xkZXJDb2xvcj86IG51bWJlcjtcbiAgLyoqIEJvcmRlciByYWRpdXMgKi9cbiAgYm9yZGVyUmFkaXVzPzogbnVtYmVyO1xuICAvKiogRm9udCBzaXplICovXG4gIGZvbnRTaXplPzogbnVtYmVyO1xuICAvKiogSW5wdXQgdHlwZSBmb3IgdmFsaWRhdGlvbiAqL1xuICB0eXBlPzogJ3RleHQnIHwgJ251bWJlcic7XG59XG5cbi8qKlxuICogQSB0ZXh0IGlucHV0IGNvbXBvbmVudCBmb2xsb3dpbmcgQW50IERlc2lnbiBwYXR0ZXJuc1xuICogU3VwcG9ydHMgYm90aCBjb250cm9sbGVkIGFuZCB1bmNvbnRyb2xsZWQgbW9kZXNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgaW5wdXQgPSBuZXcgVUlUZXh0SW5wdXQoe1xuICogICBwbGFjZWhvbGRlcjogJ0VudGVyIHlvdXIgbmFtZS4uLicsXG4gKiAgIG9uQ2hhbmdlOiAodmFsdWUpID0+IGNvbnNvbGUubG9nKCdJbnB1dDonLCB2YWx1ZSksXG4gKiAgIG1heExlbmd0aDogNTBcbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSVRleHRJbnB1dCBleHRlbmRzIFVJQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBwcm9wczogUmVxdWlyZWQ8T21pdDxVSVRleHRJbnB1dFByb3BzLCAnb25DaGFuZ2UnIHwgJ3ZhbHVlJyB8ICdkZWZhdWx0VmFsdWUnPj47XG4gIHByaXZhdGUgb25DaGFuZ2U/OiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcblxuICBwcml2YXRlIGN1cnJlbnRWYWx1ZTogc3RyaW5nO1xuICBwcml2YXRlIGJhY2tncm91bmQ6IFVJUGFuZWw7XG4gIHByaXZhdGUgdGV4dERpc3BsYXk6IFBJWEkuVGV4dDtcbiAgcHJpdmF0ZSBjdXJzb3I6IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgY3Vyc29yUG9zaXRpb246IG51bWJlciA9IDA7XG4gIHByaXZhdGUgY3Vyc29yQmxpbmtJbnRlcnZhbD86IG51bWJlcjtcbiAgcHJpdmF0ZSBjdXJzb3JWaXNpYmxlOiBib29sZWFuID0gdHJ1ZTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlUZXh0SW5wdXRQcm9wcywgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBwbGFjZWhvbGRlcjogcHJvcHMucGxhY2Vob2xkZXIgPz8gJycsXG4gICAgICBtYXhMZW5ndGg6IHByb3BzLm1heExlbmd0aCA/PyAxMDAsXG4gICAgICB3aWR0aDogcHJvcHMud2lkdGggPz8gMjAwLFxuICAgICAgaGVpZ2h0OiBwcm9wcy5oZWlnaHQgPz8gMzYsXG4gICAgICBkaXNhYmxlZDogcHJvcHMuZGlzYWJsZWQgPz8gZmFsc2UsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHByb3BzLmJhY2tncm91bmRDb2xvciA/PyAweGZmZmZmZixcbiAgICAgIHRleHRDb2xvcjogcHJvcHMudGV4dENvbG9yID8/IDB4MDAwMDAwLFxuICAgICAgcGxhY2Vob2xkZXJDb2xvcjogcHJvcHMucGxhY2Vob2xkZXJDb2xvciA/PyAweDk5OTk5OSxcbiAgICAgIGJvcmRlclJhZGl1czogcHJvcHMuYm9yZGVyUmFkaXVzID8/IDQsXG4gICAgICBmb250U2l6ZTogcHJvcHMuZm9udFNpemUgPz8gMTQsXG4gICAgICB0eXBlOiBwcm9wcy50eXBlID8/ICd0ZXh0J1xuICAgIH07XG5cbiAgICB0aGlzLm9uQ2hhbmdlID0gcHJvcHMub25DaGFuZ2U7XG4gICAgdGhpcy5jdXJyZW50VmFsdWUgPSBwcm9wcy52YWx1ZSA/PyBwcm9wcy5kZWZhdWx0VmFsdWUgPz8gJyc7XG5cbiAgICAvLyBTZXQgYm94IG1vZGVsIGRpbWVuc2lvbnNcbiAgICB0aGlzLmJveE1vZGVsLndpZHRoID0gdGhpcy5wcm9wcy53aWR0aDtcbiAgICB0aGlzLmJveE1vZGVsLmhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuXG4gICAgLy8gQ3JlYXRlIGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuYmFja2dyb3VuZC5jb250YWluZXIpO1xuXG4gICAgLy8gQ3JlYXRlIHRleHQgZGlzcGxheVxuICAgIHRoaXMudGV4dERpc3BsYXkgPSBuZXcgUElYSS5UZXh0KHtcbiAgICAgIHRleHQ6IHRoaXMuZ2V0RGlzcGxheVRleHQoKSxcbiAgICAgIHN0eWxlOiB7XG4gICAgICAgIGZvbnRGYW1pbHk6ICdBcmlhbCcsXG4gICAgICAgIGZvbnRTaXplOiB0aGlzLnByb3BzLmZvbnRTaXplLFxuICAgICAgICBmaWxsOiB0aGlzLmN1cnJlbnRWYWx1ZSA/IHRoaXMucHJvcHMudGV4dENvbG9yIDogdGhpcy5wcm9wcy5wbGFjZWhvbGRlckNvbG9yLFxuICAgICAgICBhbGlnbjogJ2xlZnQnXG4gICAgICB9LFxuICAgICAgcmVzb2x1dGlvbjogd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMlxuICAgIH0pO1xuICAgIHRoaXMudGV4dERpc3BsYXkucG9zaXRpb24uc2V0KDEyLCAodGhpcy5wcm9wcy5oZWlnaHQgLSB0aGlzLnByb3BzLmZvbnRTaXplKSAvIDIpO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMudGV4dERpc3BsYXkpO1xuXG4gICAgLy8gQ3JlYXRlIGN1cnNvclxuICAgIHRoaXMuY3Vyc29yID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0aGlzLmN1cnNvci52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5jdXJzb3IpO1xuXG4gICAgLy8gU2V0dXAgaW50ZXJhY3Rpdml0eVxuICAgIHRoaXMuc2V0dXBJbnRlcmFjdGl2aXR5KCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgZGlzcGxheSB0ZXh0ICh2YWx1ZSBvciBwbGFjZWhvbGRlcilcbiAgICovXG4gIHByaXZhdGUgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcbiAgICBpZiAodGhpcy5jdXJyZW50VmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucHJvcHMucGxhY2Vob2xkZXI7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB1cCBtb3VzZS9rZXlib2FyZCBldmVudCBoYW5kbGVyc1xuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cEludGVyYWN0aXZpdHkoKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgdGhpcy5jb250YWluZXIuY3Vyc29yID0gJ3RleHQnO1xuXG4gICAgLy8gQ2xpY2sgdG8gZm9jdXNcbiAgICB0aGlzLmNvbnRhaW5lci5vbigncG9pbnRlcmRvd24nLCB0aGlzLmhhbmRsZVBvaW50ZXJEb3duLmJpbmQodGhpcykpO1xuXG4gICAgLy8gTGlzdGVuIGZvciBnbG9iYWwgY2xpY2sgdG8gYmx1clxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleURvd24uYmluZCh0aGlzKSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyRG93bihlOiBQSVhJLkZlZGVyYXRlZFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLmRpc2FibGVkKSByZXR1cm47XG5cbiAgICAvLyBSZXF1ZXN0IGZvY3VzIHRocm91Z2ggdGhlIGZvY3VzIG1hbmFnZXJcbiAgICBjb25zdCBmb2N1c01hbmFnZXIgPSBVSUZvY3VzTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuICAgIGlmIChmb2N1c01hbmFnZXIpIHtcbiAgICAgIGZvY3VzTWFuYWdlci5yZXF1ZXN0Rm9jdXModGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZhbGxiYWNrIGlmIG5vIGZvY3VzIG1hbmFnZXJcbiAgICAgIHRoaXMub25Gb2N1cygpO1xuICAgIH1cbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGlucHV0IHJlY2VpdmVzIGZvY3VzIChvdmVycmlkZSBmcm9tIGJhc2UgY2xhc3MpXG4gICAqL1xuICBvdmVycmlkZSBvbkZvY3VzKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzZWQpIHJldHVybjtcblxuICAgIHN1cGVyLm9uRm9jdXMoKTtcbiAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoO1xuICAgIHRoaXMuY3Vyc29yLnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgdGhpcy5zdGFydEN1cnNvckJsaW5rKCk7XG5cbiAgICAvLyBVcGRhdGUgYmFja2dyb3VuZCB0byBzaG93IGZvY3VzIHN0YXRlXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLmxpZ2h0ZW5Db2xvcih0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciwgMC45NSksXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gaW5wdXQgbG9zZXMgZm9jdXMgKG92ZXJyaWRlIGZyb20gYmFzZSBjbGFzcylcbiAgICovXG4gIG92ZXJyaWRlIG9uQmx1cigpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZm9jdXNlZCkgcmV0dXJuO1xuXG4gICAgc3VwZXIub25CbHVyKCk7XG4gICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IGZhbHNlO1xuICAgIHRoaXMuc3RvcEN1cnNvckJsaW5rKCk7XG5cbiAgICAvLyBSZXN0b3JlIG5vcm1hbCBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlS2V5RG93bihlOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmZvY3VzZWQgfHwgdGhpcy5wcm9wcy5kaXNhYmxlZCkgcmV0dXJuO1xuXG4gICAgLy8gU3RvcCBldmVudCBmcm9tIHByb3BhZ2F0aW5nXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICBjb25zdCBrZXkgPSBlLmtleTtcblxuICAgIGlmIChrZXkgPT09ICdFbnRlcicpIHtcbiAgICAgIHRoaXMub25CbHVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHRoaXMub25CbHVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0JhY2tzcGFjZScpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uID4gMCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24gLSAxKSArXG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKHRoaXMuY3Vyc29yUG9zaXRpb24pO1xuICAgICAgICB0aGlzLmN1cnNvclBvc2l0aW9uLS07XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdEZWxldGUnKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3JQb3NpdGlvbiA8IHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24pICtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcodGhpcy5jdXJzb3JQb3NpdGlvbiArIDEpO1xuICAgICAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQXJyb3dMZWZ0Jykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPiAwKSB7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24tLTtcbiAgICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQXJyb3dSaWdodCcpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uIDwgdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24rKztcbiAgICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnSG9tZScpIHtcbiAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSAwO1xuICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnRW5kJykge1xuICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aDtcbiAgICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIGNoYXJhY3RlciBpbnB1dFxuICAgIGlmIChrZXkubGVuZ3RoID09PSAxICYmICFlLmN0cmxLZXkgJiYgIWUubWV0YUtleSkge1xuICAgICAgLy8gVHlwZSB2YWxpZGF0aW9uXG4gICAgICBpZiAodGhpcy5wcm9wcy50eXBlID09PSAnbnVtYmVyJyAmJiAhL1swLTkuLV0vLnRlc3Qoa2V5KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIG1heCBsZW5ndGhcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGggPj0gdGhpcy5wcm9wcy5tYXhMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBJbnNlcnQgY2hhcmFjdGVyIGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPVxuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbikgK1xuICAgICAgICBrZXkgK1xuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcodGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgICB0aGlzLmN1cnNvclBvc2l0aW9uKys7XG4gICAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgdGV4dCBkaXNwbGF5IGFuZCB0cmlnZ2VycyBvbkNoYW5nZVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVUZXh0KCk6IHZvaWQge1xuICAgIHRoaXMudGV4dERpc3BsYXkudGV4dCA9IHRoaXMuZ2V0RGlzcGxheVRleHQoKTtcbiAgICB0aGlzLnRleHREaXNwbGF5LnN0eWxlLmZpbGwgPSB0aGlzLmN1cnJlbnRWYWx1ZSA/IHRoaXMucHJvcHMudGV4dENvbG9yIDogdGhpcy5wcm9wcy5wbGFjZWhvbGRlckNvbG9yO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgdGhpcy5vbkNoYW5nZT8uKHRoaXMuY3VycmVudFZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIGN1cnNvciBwb3NpdGlvbiB2aXN1YWxseVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVDdXJzb3IoKTogdm9pZCB7XG4gICAgLy8gTWVhc3VyZSB0ZXh0IHVwIHRvIGN1cnNvciBwb3NpdGlvbiBieSBjcmVhdGluZyBhIHRlbXBvcmFyeSB0ZXh0IG9iamVjdFxuICAgIGNvbnN0IHRleHRVcFRvQ3Vyc29yID0gdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24pO1xuICAgIGNvbnN0IHRlbXBUZXh0ID0gbmV3IFBJWEkuVGV4dCh7XG4gICAgICB0ZXh0OiB0ZXh0VXBUb0N1cnNvcixcbiAgICAgIHN0eWxlOiB0aGlzLnRleHREaXNwbGF5LnN0eWxlXG4gICAgfSk7XG5cbiAgICBjb25zdCBjdXJzb3JYID0gMTIgKyB0ZW1wVGV4dC53aWR0aDtcbiAgICBjb25zdCBjdXJzb3JZID0gKHRoaXMucHJvcHMuaGVpZ2h0IC0gdGhpcy5wcm9wcy5mb250U2l6ZSkgLyAyO1xuXG4gICAgdGhpcy5jdXJzb3IuY2xlYXIoKTtcbiAgICB0aGlzLmN1cnNvci5yZWN0KGN1cnNvclgsIGN1cnNvclksIDEsIHRoaXMucHJvcHMuZm9udFNpemUpO1xuICAgIHRoaXMuY3Vyc29yLmZpbGwoeyBjb2xvcjogdGhpcy5wcm9wcy50ZXh0Q29sb3IgfSk7XG5cbiAgICAvLyBDbGVhbiB1cCB0ZW1wIHRleHRcbiAgICB0ZW1wVGV4dC5kZXN0cm95KCk7XG4gIH1cblxuICAvKipcbiAgICogU3RhcnRzIGN1cnNvciBibGlua2luZyBhbmltYXRpb25cbiAgICovXG4gIHByaXZhdGUgc3RhcnRDdXJzb3JCbGluaygpOiB2b2lkIHtcbiAgICB0aGlzLnN0b3BDdXJzb3JCbGluaygpO1xuICAgIHRoaXMuY3Vyc29yVmlzaWJsZSA9IHRydWU7XG5cbiAgICB0aGlzLmN1cnNvckJsaW5rSW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgdGhpcy5jdXJzb3JWaXNpYmxlID0gIXRoaXMuY3Vyc29yVmlzaWJsZTtcbiAgICAgIHRoaXMuY3Vyc29yLnZpc2libGUgPSB0aGlzLmN1cnNvclZpc2libGU7XG4gICAgfSwgNTMwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wcyBjdXJzb3IgYmxpbmtpbmcgYW5pbWF0aW9uXG4gICAqL1xuICBwcml2YXRlIHN0b3BDdXJzb3JCbGluaygpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jdXJzb3JCbGlua0ludGVydmFsKSB7XG4gICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmN1cnNvckJsaW5rSW50ZXJ2YWwpO1xuICAgICAgdGhpcy5jdXJzb3JCbGlua0ludGVydmFsID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMaWdodGVucyBhIGNvbG9yIGJ5IGEgZmFjdG9yXG4gICAqL1xuICBwcml2YXRlIGxpZ2h0ZW5Db2xvcihjb2xvcjogbnVtYmVyLCBmYWN0b3I6IG51bWJlcik6IG51bWJlciB7XG4gICAgY29uc3QgciA9IE1hdGgubWluKDI1NSwgKChjb2xvciA+PiAxNikgJiAweGZmKSAvIGZhY3Rvcik7XG4gICAgY29uc3QgZyA9IE1hdGgubWluKDI1NSwgKChjb2xvciA+PiA4KSAmIDB4ZmYpIC8gZmFjdG9yKTtcbiAgICBjb25zdCBiID0gTWF0aC5taW4oMjU1LCAoY29sb3IgJiAweGZmKSAvIGZhY3Rvcik7XG4gICAgcmV0dXJuICgociA8PCAxNikgfCAoZyA8PCA4KSB8IGIpID4+PiAwO1xuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmVzIHRoZSBzaXplIG5lZWRlZCBmb3IgdGhpcyBpbnB1dFxuICAgKi9cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHRcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGxheW91dCBmb3IgdGhpcyBpbnB1dFxuICAgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcblxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcblxuICAgIC8vIExheW91dCBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kLmxheW91dChtZWFzdXJlZC53aWR0aCwgbWVhc3VyZWQuaGVpZ2h0KTtcblxuICAgIHRoaXMubGF5b3V0RGlydHkgPSBmYWxzZTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIGlucHV0XG4gICAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIC8vIFJlbmRlcmluZyBoYW5kbGVkIGJ5IGJhY2tncm91bmQsIHRleHQsIGFuZCBjdXJzb3JcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSB2YWx1ZSBwcm9ncmFtbWF0aWNhbGx5XG4gICAqL1xuICBzZXRWYWx1ZSh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5jdXJyZW50VmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gdmFsdWUubGVuZ3RoO1xuICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgdmFsdWVcbiAgICovXG4gIGdldFZhbHVlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFZhbHVlO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFudXAgd2hlbiBkZXN0cm95aW5nXG4gICAqL1xuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuc3RvcEN1cnNvckJsaW5rKCk7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpKTtcbiAgICB9XG4gICAgc3VwZXIuZGVzdHJveSgpO1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcbmltcG9ydCB7IFVJUGFuZWwgfSBmcm9tICcuL3VpLXBhbmVsJztcbmltcG9ydCB7IFVJRm9jdXNNYW5hZ2VyIH0gZnJvbSAnLi4vY29yZS91aS1mb2N1cy1tYW5hZ2VyJztcblxuLyoqXG4gKiBQcm9wcyBmb3IgY29uZmlndXJpbmcgYSBVSVRleHRBcmVhXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlUZXh0QXJlYVByb3BzIHtcbiAgLyoqIEN1cnJlbnQgdmFsdWUgKGNvbnRyb2xsZWQpICovXG4gIHZhbHVlPzogc3RyaW5nO1xuICAvKiogRGVmYXVsdCB2YWx1ZSAodW5jb250cm9sbGVkKSAqL1xuICBkZWZhdWx0VmFsdWU/OiBzdHJpbmc7XG4gIC8qKiBDaGFuZ2UgY2FsbGJhY2sgKi9cbiAgb25DaGFuZ2U/OiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcbiAgLyoqIFBsYWNlaG9sZGVyIHRleHQgd2hlbiBlbXB0eSAqL1xuICBwbGFjZWhvbGRlcj86IHN0cmluZztcbiAgLyoqIE1heGltdW0gY2hhcmFjdGVyIGxlbmd0aCAqL1xuICBtYXhMZW5ndGg/OiBudW1iZXI7XG4gIC8qKiBXaWR0aCBvZiB0aGUgdGV4dGFyZWEgKi9cbiAgd2lkdGg/OiBudW1iZXI7XG4gIC8qKiBIZWlnaHQgb2YgdGhlIHRleHRhcmVhICovXG4gIGhlaWdodD86IG51bWJlcjtcbiAgLyoqIFdoZXRoZXIgdGhlIHRleHRhcmVhIGlzIGRpc2FibGVkICovXG4gIGRpc2FibGVkPzogYm9vbGVhbjtcbiAgLyoqIEJhY2tncm91bmQgY29sb3IgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogVGV4dCBjb2xvciAqL1xuICB0ZXh0Q29sb3I/OiBudW1iZXI7XG4gIC8qKiBQbGFjZWhvbGRlciB0ZXh0IGNvbG9yICovXG4gIHBsYWNlaG9sZGVyQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgcmFkaXVzICovXG4gIGJvcmRlclJhZGl1cz86IG51bWJlcjtcbiAgLyoqIEZvbnQgc2l6ZSAqL1xuICBmb250U2l6ZT86IG51bWJlcjtcbiAgLyoqIExpbmUgaGVpZ2h0IG11bHRpcGxpZXIgKGUuZy4sIDEuNSBtZWFucyAxLjV4IHRoZSBmb250IHNpemUpICovXG4gIGxpbmVIZWlnaHQ/OiBudW1iZXI7XG4gIC8qKiBOdW1iZXIgb2YgdmlzaWJsZSByb3dzICovXG4gIHJvd3M/OiBudW1iZXI7XG59XG5cbi8qKlxuICogQSBtdWx0aS1saW5lIHRleHQgYXJlYSBjb21wb25lbnRcbiAqIFN1cHBvcnRzIHdvcmQgd3JhcHBpbmcgYW5kIHNjcm9sbGluZ1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCB0ZXh0YXJlYSA9IG5ldyBVSVRleHRBcmVhKHtcbiAqICAgcGxhY2Vob2xkZXI6ICdFbnRlciB5b3VyIG1lc3NhZ2UuLi4nLFxuICogICBvbkNoYW5nZTogKHZhbHVlKSA9PiBjb25zb2xlLmxvZygnTWVzc2FnZTonLCB2YWx1ZSksXG4gKiAgIHdpZHRoOiA0MDAsXG4gKiAgIGhlaWdodDogMTIwLFxuICogICByb3dzOiA0XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlUZXh0QXJlYSBleHRlbmRzIFVJQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBwcm9wczogUmVxdWlyZWQ8T21pdDxVSVRleHRBcmVhUHJvcHMsICdvbkNoYW5nZScgfCAndmFsdWUnIHwgJ2RlZmF1bHRWYWx1ZSc+PjtcbiAgcHJpdmF0ZSBvbkNoYW5nZT86ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xuXG4gIHByaXZhdGUgY3VycmVudFZhbHVlOiBzdHJpbmc7XG4gIHByaXZhdGUgYmFja2dyb3VuZDogVUlQYW5lbDtcbiAgcHJpdmF0ZSB0ZXh0RGlzcGxheTogUElYSS5UZXh0O1xuICBwcml2YXRlIGN1cnNvcjogUElYSS5HcmFwaGljcztcbiAgcHJpdmF0ZSBjdXJzb3JQb3NpdGlvbjogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBjdXJzb3JCbGlua0ludGVydmFsPzogbnVtYmVyO1xuICBwcml2YXRlIGN1cnNvclZpc2libGU6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSVRleHRBcmVhUHJvcHMsIGJveE1vZGVsPzogUGFydGlhbDxCb3hNb2RlbD4pIHtcbiAgICBzdXBlcihib3hNb2RlbCk7XG5cbiAgICBjb25zdCBkZWZhdWx0SGVpZ2h0ID0gKHByb3BzLnJvd3MgPz8gNCkgKiAocHJvcHMuZm9udFNpemUgPz8gMTQpICogKHByb3BzLmxpbmVIZWlnaHQgPz8gMS41KSArIDI0O1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIHBsYWNlaG9sZGVyOiBwcm9wcy5wbGFjZWhvbGRlciA/PyAnJyxcbiAgICAgIG1heExlbmd0aDogcHJvcHMubWF4TGVuZ3RoID8/IDEwMDAsXG4gICAgICB3aWR0aDogcHJvcHMud2lkdGggPz8gNDAwLFxuICAgICAgaGVpZ2h0OiBwcm9wcy5oZWlnaHQgPz8gZGVmYXVsdEhlaWdodCxcbiAgICAgIGRpc2FibGVkOiBwcm9wcy5kaXNhYmxlZCA/PyBmYWxzZSxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogcHJvcHMuYmFja2dyb3VuZENvbG9yID8/IDB4ZmZmZmZmLFxuICAgICAgdGV4dENvbG9yOiBwcm9wcy50ZXh0Q29sb3IgPz8gMHgwMDAwMDAsXG4gICAgICBwbGFjZWhvbGRlckNvbG9yOiBwcm9wcy5wbGFjZWhvbGRlckNvbG9yID8/IDB4OTk5OTk5LFxuICAgICAgYm9yZGVyUmFkaXVzOiBwcm9wcy5ib3JkZXJSYWRpdXMgPz8gNCxcbiAgICAgIGZvbnRTaXplOiBwcm9wcy5mb250U2l6ZSA/PyAxNCxcbiAgICAgIGxpbmVIZWlnaHQ6IHByb3BzLmxpbmVIZWlnaHQgPz8gMS41LFxuICAgICAgcm93czogcHJvcHMucm93cyA/PyA0XG4gICAgfTtcblxuICAgIHRoaXMub25DaGFuZ2UgPSBwcm9wcy5vbkNoYW5nZTtcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHByb3BzLnZhbHVlID8/IHByb3BzLmRlZmF1bHRWYWx1ZSA/PyAnJztcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9uc1xuICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSB0aGlzLnByb3BzLndpZHRoO1xuICAgIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG5cbiAgICAvLyBDcmVhdGUgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kLmNvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgdGV4dCBkaXNwbGF5IHdpdGggd29yZCB3cmFwcGluZ1xuICAgIHRoaXMudGV4dERpc3BsYXkgPSBuZXcgUElYSS5UZXh0KHtcbiAgICAgIHRleHQ6IHRoaXMuZ2V0RGlzcGxheVRleHQoKSxcbiAgICAgIHN0eWxlOiB7XG4gICAgICAgIGZvbnRGYW1pbHk6ICdBcmlhbCcsXG4gICAgICAgIGZvbnRTaXplOiB0aGlzLnByb3BzLmZvbnRTaXplLFxuICAgICAgICBmaWxsOiB0aGlzLmN1cnJlbnRWYWx1ZSA/IHRoaXMucHJvcHMudGV4dENvbG9yIDogdGhpcy5wcm9wcy5wbGFjZWhvbGRlckNvbG9yLFxuICAgICAgICBhbGlnbjogJ2xlZnQnLFxuICAgICAgICB3b3JkV3JhcDogdHJ1ZSxcbiAgICAgICAgd29yZFdyYXBXaWR0aDogdGhpcy5wcm9wcy53aWR0aCAtIDI0LFxuICAgICAgICBsaW5lSGVpZ2h0OiB0aGlzLnByb3BzLmZvbnRTaXplICogdGhpcy5wcm9wcy5saW5lSGVpZ2h0XG4gICAgICB9LFxuICAgICAgcmVzb2x1dGlvbjogd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMlxuICAgIH0pO1xuICAgIHRoaXMudGV4dERpc3BsYXkucG9zaXRpb24uc2V0KDEyLCAxMik7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy50ZXh0RGlzcGxheSk7XG5cbiAgICAvLyBDcmVhdGUgY3Vyc29yXG4gICAgdGhpcy5jdXJzb3IgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMuY3Vyc29yLnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmN1cnNvcik7XG5cbiAgICAvLyBTZXR1cCBpbnRlcmFjdGl2aXR5XG4gICAgdGhpcy5zZXR1cEludGVyYWN0aXZpdHkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBkaXNwbGF5IHRleHQgKHZhbHVlIG9yIHBsYWNlaG9sZGVyKVxuICAgKi9cbiAgcHJpdmF0ZSBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLmN1cnJlbnRWYWx1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5wcm9wcy5wbGFjZWhvbGRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHVwIG1vdXNlL2tleWJvYXJkIGV2ZW50IGhhbmRsZXJzXG4gICAqL1xuICBwcml2YXRlIHNldHVwSW50ZXJhY3Rpdml0eSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICB0aGlzLmNvbnRhaW5lci5jdXJzb3IgPSAndGV4dCc7XG5cbiAgICAvLyBDbGljayB0byBmb2N1c1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVyZG93bicsIHRoaXMuaGFuZGxlUG9pbnRlckRvd24uYmluZCh0aGlzKSk7XG5cbiAgICAvLyBMaXN0ZW4gZm9yIGdsb2JhbCBrZXlib2FyZCBldmVudHNcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlEb3duLmJpbmQodGhpcykpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlckRvd24oZTogUElYSS5GZWRlcmF0ZWRQb2ludGVyRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wcm9wcy5kaXNhYmxlZCkgcmV0dXJuO1xuXG4gICAgLy8gUmVxdWVzdCBmb2N1cyB0aHJvdWdoIHRoZSBmb2N1cyBtYW5hZ2VyXG4gICAgY29uc3QgZm9jdXNNYW5hZ2VyID0gVUlGb2N1c01hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICBpZiAoZm9jdXNNYW5hZ2VyKSB7XG4gICAgICBmb2N1c01hbmFnZXIucmVxdWVzdEZvY3VzKHRoaXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBGYWxsYmFjayBpZiBubyBmb2N1cyBtYW5hZ2VyXG4gICAgICB0aGlzLm9uRm9jdXMoKTtcbiAgICB9XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiB0ZXh0YXJlYSByZWNlaXZlcyBmb2N1cyAob3ZlcnJpZGUgZnJvbSBiYXNlIGNsYXNzKVxuICAgKi9cbiAgb3ZlcnJpZGUgb25Gb2N1cygpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5mb2N1c2VkKSByZXR1cm47XG5cbiAgICBzdXBlci5vbkZvY3VzKCk7XG4gICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aDtcbiAgICB0aGlzLmN1cnNvci52aXNpYmxlID0gdHJ1ZTtcbiAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgIHRoaXMuc3RhcnRDdXJzb3JCbGluaygpO1xuXG4gICAgLy8gVXBkYXRlIGJhY2tncm91bmQgdG8gc2hvdyBmb2N1cyBzdGF0ZVxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5saWdodGVuQ29sb3IodGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsIDAuOTUpLFxuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHRleHRhcmVhIGxvc2VzIGZvY3VzIChvdmVycmlkZSBmcm9tIGJhc2UgY2xhc3MpXG4gICAqL1xuICBvdmVycmlkZSBvbkJsdXIoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmZvY3VzZWQpIHJldHVybjtcblxuICAgIHN1cGVyLm9uQmx1cigpO1xuICAgIHRoaXMuY3Vyc29yLnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLnN0b3BDdXJzb3JCbGluaygpO1xuXG4gICAgLy8gUmVzdG9yZSBub3JtYWwgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZUtleURvd24oZTogS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5mb2N1c2VkIHx8IHRoaXMucHJvcHMuZGlzYWJsZWQpIHJldHVybjtcblxuICAgIC8vIERvbid0IHByZXZlbnQgZGVmYXVsdCBmb3IgVGFiIChhbGxvdyB0YWIgbmF2aWdhdGlvbilcbiAgICBpZiAoZS5rZXkgIT09ICdUYWInKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH1cblxuICAgIGNvbnN0IGtleSA9IGUua2V5O1xuXG4gICAgLy8gRW50ZXIgYWRkcyBuZXcgbGluZSBpbiB0ZXh0YXJlYVxuICAgIGlmIChrZXkgPT09ICdFbnRlcicpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGggPCB0aGlzLnByb3BzLm1heExlbmd0aCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24pICtcbiAgICAgICAgICAnXFxuJyArXG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKHRoaXMuY3Vyc29yUG9zaXRpb24pO1xuICAgICAgICB0aGlzLmN1cnNvclBvc2l0aW9uKys7XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICB0aGlzLm9uQmx1cigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdCYWNrc3BhY2UnKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3JQb3NpdGlvbiA+IDApIHtcbiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPVxuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uIC0gMSkgK1xuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZyh0aGlzLmN1cnNvclBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbi0tO1xuICAgICAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnRGVsZXRlJykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPCB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPVxuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uKSArXG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKHRoaXMuY3Vyc29yUG9zaXRpb24gKyAxKTtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0Fycm93TGVmdCcpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uID4gMCkge1xuICAgICAgICB0aGlzLmN1cnNvclBvc2l0aW9uLS07XG4gICAgICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0Fycm93UmlnaHQnKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3JQb3NpdGlvbiA8IHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCkge1xuICAgICAgICB0aGlzLmN1cnNvclBvc2l0aW9uKys7XG4gICAgICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0Fycm93VXAnKSB7XG4gICAgICAvLyBNb3ZlIGN1cnNvciB1cCBvbmUgbGluZVxuICAgICAgdGhpcy5tb3ZlQ3Vyc29yVmVydGljYWxseSgtMSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0Fycm93RG93bicpIHtcbiAgICAgIC8vIE1vdmUgY3Vyc29yIGRvd24gb25lIGxpbmVcbiAgICAgIHRoaXMubW92ZUN1cnNvclZlcnRpY2FsbHkoMSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0hvbWUnKSB7XG4gICAgICAvLyBNb3ZlIHRvIHN0YXJ0IG9mIGN1cnJlbnQgbGluZVxuICAgICAgY29uc3QgbGluZVN0YXJ0ID0gdGhpcy5jdXJyZW50VmFsdWUubGFzdEluZGV4T2YoJ1xcbicsIHRoaXMuY3Vyc29yUG9zaXRpb24gLSAxKSArIDE7XG4gICAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gbGluZVN0YXJ0O1xuICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnRW5kJykge1xuICAgICAgLy8gTW92ZSB0byBlbmQgb2YgY3VycmVudCBsaW5lXG4gICAgICBsZXQgbGluZUVuZCA9IHRoaXMuY3VycmVudFZhbHVlLmluZGV4T2YoJ1xcbicsIHRoaXMuY3Vyc29yUG9zaXRpb24pO1xuICAgICAgaWYgKGxpbmVFbmQgPT09IC0xKSBsaW5lRW5kID0gdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoO1xuICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IGxpbmVFbmQ7XG4gICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEhhbmRsZSBjaGFyYWN0ZXIgaW5wdXRcbiAgICBpZiAoa2V5Lmxlbmd0aCA9PT0gMSAmJiAhZS5jdHJsS2V5ICYmICFlLm1ldGFLZXkpIHtcbiAgICAgIC8vIENoZWNrIG1heCBsZW5ndGhcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGggPj0gdGhpcy5wcm9wcy5tYXhMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBJbnNlcnQgY2hhcmFjdGVyIGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPVxuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbikgK1xuICAgICAgICBrZXkgK1xuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcodGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgICB0aGlzLmN1cnNvclBvc2l0aW9uKys7XG4gICAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTW92ZXMgY3Vyc29yIHZlcnRpY2FsbHkgYnkgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgbGluZXNcbiAgICovXG4gIHByaXZhdGUgbW92ZUN1cnNvclZlcnRpY2FsbHkoZGlyZWN0aW9uOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBsaW5lcyA9IHRoaXMuY3VycmVudFZhbHVlLnNwbGl0KCdcXG4nKTtcbiAgICBsZXQgY3VycmVudExpbmUgPSAwO1xuICAgIGxldCBwb3NpdGlvbkluTGluZSA9IDA7XG4gICAgbGV0IGNoYXJDb3VudCA9IDA7XG5cbiAgICAvLyBGaW5kIGN1cnJlbnQgbGluZSBhbmQgcG9zaXRpb25cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoY2hhckNvdW50ICsgbGluZXNbaV0ubGVuZ3RoID49IHRoaXMuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgY3VycmVudExpbmUgPSBpO1xuICAgICAgICBwb3NpdGlvbkluTGluZSA9IHRoaXMuY3Vyc29yUG9zaXRpb24gLSBjaGFyQ291bnQ7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2hhckNvdW50ICs9IGxpbmVzW2ldLmxlbmd0aCArIDE7IC8vICsxIGZvciBuZXdsaW5lXG4gICAgfVxuXG4gICAgLy8gTW92ZSB0byB0YXJnZXQgbGluZVxuICAgIGNvbnN0IHRhcmdldExpbmUgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihsaW5lcy5sZW5ndGggLSAxLCBjdXJyZW50TGluZSArIGRpcmVjdGlvbikpO1xuICAgIGlmICh0YXJnZXRMaW5lID09PSBjdXJyZW50TGluZSkgcmV0dXJuO1xuXG4gICAgLy8gQ2FsY3VsYXRlIG5ldyBjdXJzb3IgcG9zaXRpb25cbiAgICBsZXQgbmV3UG9zaXRpb24gPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0TGluZTsgaSsrKSB7XG4gICAgICBuZXdQb3NpdGlvbiArPSBsaW5lc1tpXS5sZW5ndGggKyAxO1xuICAgIH1cbiAgICBuZXdQb3NpdGlvbiArPSBNYXRoLm1pbihwb3NpdGlvbkluTGluZSwgbGluZXNbdGFyZ2V0TGluZV0ubGVuZ3RoKTtcblxuICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSBuZXdQb3NpdGlvbjtcbiAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIHRleHQgZGlzcGxheSBhbmQgdHJpZ2dlcnMgb25DaGFuZ2VcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlVGV4dCgpOiB2b2lkIHtcbiAgICB0aGlzLnRleHREaXNwbGF5LnRleHQgPSB0aGlzLmdldERpc3BsYXlUZXh0KCk7XG4gICAgdGhpcy50ZXh0RGlzcGxheS5zdHlsZS5maWxsID0gdGhpcy5jdXJyZW50VmFsdWUgPyB0aGlzLnByb3BzLnRleHRDb2xvciA6IHRoaXMucHJvcHMucGxhY2Vob2xkZXJDb2xvcjtcbiAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgIHRoaXMub25DaGFuZ2U/Lih0aGlzLmN1cnJlbnRWYWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyBjdXJzb3IgcG9zaXRpb24gdmlzdWFsbHlcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlQ3Vyc29yKCk6IHZvaWQge1xuICAgIC8vIEdldCB0ZXh0IG1ldHJpY3MgdXAgdG8gY3Vyc29yIHBvc2l0aW9uXG4gICAgY29uc3QgdGV4dFVwVG9DdXJzb3IgPSB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbik7XG5cbiAgICAvLyBDcmVhdGUgdGVtcG9yYXJ5IHRleHQgdG8gbWVhc3VyZVxuICAgIGNvbnN0IHRlbXBUZXh0ID0gbmV3IFBJWEkuVGV4dCh7XG4gICAgICB0ZXh0OiB0ZXh0VXBUb0N1cnNvcixcbiAgICAgIHN0eWxlOiB7XG4gICAgICAgIC4uLnRoaXMudGV4dERpc3BsYXkuc3R5bGUsXG4gICAgICAgIHdvcmRXcmFwOiB0cnVlLFxuICAgICAgICB3b3JkV3JhcFdpZHRoOiB0aGlzLnByb3BzLndpZHRoIC0gMjRcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEdldCB0aGUgYm91bmRzIHRvIGZpbmQgY3Vyc29yIHBvc2l0aW9uXG4gICAgY29uc3QgbWV0cmljcyA9IHRlbXBUZXh0LmdldExvY2FsQm91bmRzKCk7XG5cbiAgICAvLyBGb3IgbXVsdGktbGluZSwgd2UgbmVlZCB0byBmaW5kIHRoZSBsYXN0IGxpbmUgcG9zaXRpb25cbiAgICBjb25zdCBsaW5lcyA9IHRleHRVcFRvQ3Vyc29yLnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBsYXN0TGluZSA9IGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdO1xuXG4gICAgY29uc3QgbGFzdExpbmVUZXh0ID0gbmV3IFBJWEkuVGV4dCh7XG4gICAgICB0ZXh0OiBsYXN0TGluZSxcbiAgICAgIHN0eWxlOiB0aGlzLnRleHREaXNwbGF5LnN0eWxlXG4gICAgfSk7XG5cbiAgICBjb25zdCBjdXJzb3JYID0gMTIgKyBsYXN0TGluZVRleHQud2lkdGg7XG4gICAgY29uc3QgY3Vyc29yWSA9IDEyICsgKGxpbmVzLmxlbmd0aCAtIDEpICogKHRoaXMucHJvcHMuZm9udFNpemUgKiB0aGlzLnByb3BzLmxpbmVIZWlnaHQpO1xuXG4gICAgdGhpcy5jdXJzb3IuY2xlYXIoKTtcbiAgICB0aGlzLmN1cnNvci5yZWN0KGN1cnNvclgsIGN1cnNvclksIDEsIHRoaXMucHJvcHMuZm9udFNpemUpO1xuICAgIHRoaXMuY3Vyc29yLmZpbGwoeyBjb2xvcjogdGhpcy5wcm9wcy50ZXh0Q29sb3IgfSk7XG5cbiAgICAvLyBDbGVhbiB1cCB0ZW1wIG9iamVjdHNcbiAgICB0ZW1wVGV4dC5kZXN0cm95KCk7XG4gICAgbGFzdExpbmVUZXh0LmRlc3Ryb3koKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydHMgY3Vyc29yIGJsaW5raW5nIGFuaW1hdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBzdGFydEN1cnNvckJsaW5rKCk6IHZvaWQge1xuICAgIHRoaXMuc3RvcEN1cnNvckJsaW5rKCk7XG4gICAgdGhpcy5jdXJzb3JWaXNpYmxlID0gdHJ1ZTtcblxuICAgIHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLmN1cnNvclZpc2libGUgPSAhdGhpcy5jdXJzb3JWaXNpYmxlO1xuICAgICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IHRoaXMuY3Vyc29yVmlzaWJsZTtcbiAgICB9LCA1MzApO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3BzIGN1cnNvciBibGlua2luZyBhbmltYXRpb25cbiAgICovXG4gIHByaXZhdGUgc3RvcEN1cnNvckJsaW5rKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmN1cnNvckJsaW5rSW50ZXJ2YWwpIHtcbiAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCk7XG4gICAgICB0aGlzLmN1cnNvckJsaW5rSW50ZXJ2YWwgPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIExpZ2h0ZW5zIGEgY29sb3IgYnkgYSBmYWN0b3JcbiAgICovXG4gIHByaXZhdGUgbGlnaHRlbkNvbG9yKGNvbG9yOiBudW1iZXIsIGZhY3RvcjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBjb25zdCByID0gTWF0aC5taW4oMjU1LCAoKGNvbG9yID4+IDE2KSAmIDB4ZmYpIC8gZmFjdG9yKTtcbiAgICBjb25zdCBnID0gTWF0aC5taW4oMjU1LCAoKGNvbG9yID4+IDgpICYgMHhmZikgLyBmYWN0b3IpO1xuICAgIGNvbnN0IGIgPSBNYXRoLm1pbigyNTUsIChjb2xvciAmIDB4ZmYpIC8gZmFjdG9yKTtcbiAgICByZXR1cm4gKChyIDw8IDE2KSB8IChnIDw8IDgpIHwgYikgPj4+IDA7XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgdGhlIHNpemUgbmVlZGVkIGZvciB0aGlzIHRleHRhcmVhXG4gICAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIHRleHRhcmVhXG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuXG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgLy8gTGF5b3V0IGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQubGF5b3V0KG1lYXN1cmVkLndpZHRoLCBtZWFzdXJlZC5oZWlnaHQpO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgdGV4dGFyZWFcbiAgICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgLy8gUmVuZGVyaW5nIGhhbmRsZWQgYnkgYmFja2dyb3VuZCwgdGV4dCwgYW5kIGN1cnNvclxuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHZhbHVlIHByb2dyYW1tYXRpY2FsbHlcbiAgICovXG4gIHNldFZhbHVlKHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSB2YWx1ZS5sZW5ndGg7XG4gICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCB2YWx1ZVxuICAgKi9cbiAgZ2V0VmFsdWUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCB3aGVuIGRlc3Ryb3lpbmdcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5zdG9wQ3Vyc29yQmxpbmsoKTtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlEb3duLmJpbmQodGhpcykpO1xuICAgIH1cbiAgICBzdXBlci5kZXN0cm95KCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IEVkZ2VJbnNldHMgfSBmcm9tICcuL2VkZ2UtaW5zZXRzJztcblxuLyoqXG4gKiBTaXplIGNvbnN0cmFpbnQgdmFsdWVzIGZvciBVSSBjb21wb25lbnRzXG4gKiBDYW4gYmUgYSBmaXhlZCBudW1iZXIsICdhdXRvJyB0byBmaXQgY29udGVudCwgb3IgJ2ZpbGwnIHRvIGV4cGFuZFxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgdHlwZSBTaXplQ29uc3RyYWludCA9IG51bWJlciB8ICdhdXRvJyB8ICdmaWxsJztcblxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBib3ggbW9kZWwgZm9yIGEgVUkgY29tcG9uZW50XG4gKiBTaW1pbGFyIHRvIENTUyBib3ggbW9kZWwgd2l0aCB3aWR0aCwgaGVpZ2h0LCBwYWRkaW5nLCBtYXJnaW4sIGFuZCBib3JkZXJcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBCb3hNb2RlbCB7XG4gIC8vIENvbnRlbnQgYXJlYSBkaW1lbnNpb25zXG4gIHdpZHRoOiBTaXplQ29uc3RyYWludDtcbiAgaGVpZ2h0OiBTaXplQ29uc3RyYWludDtcblxuICAvLyBTaXplIGNvbnN0cmFpbnRzXG4gIG1pbldpZHRoPzogbnVtYmVyO1xuICBtaW5IZWlnaHQ/OiBudW1iZXI7XG4gIG1heFdpZHRoPzogbnVtYmVyO1xuICBtYXhIZWlnaHQ/OiBudW1iZXI7XG5cbiAgLy8gU3BhY2luZ1xuICBwYWRkaW5nOiBFZGdlSW5zZXRzO1xuICBtYXJnaW46IEVkZ2VJbnNldHM7XG5cbiAgLy8gQm9yZGVyICh2aXN1YWwgYm9yZGVyIHdpbGwgYmUgaW1wbGVtZW50ZWQgbGF0ZXIpXG4gIGJvcmRlcj86IEVkZ2VJbnNldHM7XG59XG5cbi8qKlxuICogVGhlIGNvbXB1dGVkL2FjdHVhbCBsYXlvdXQgb2YgYSBjb21wb25lbnQgYWZ0ZXIgbWVhc3VyZW1lbnRcbiAqIEFsbCB2YWx1ZXMgYXJlIGNvbmNyZXRlIHBpeGVsIHZhbHVlc1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIENvbXB1dGVkTGF5b3V0IHtcbiAgLy8gUG9zaXRpb24gcmVsYXRpdmUgdG8gcGFyZW50XG4gIHg6IG51bWJlcjtcbiAgeTogbnVtYmVyO1xuXG4gIC8vIEZpbmFsIGRpbWVuc2lvbnNcbiAgd2lkdGg6IG51bWJlcjtcbiAgaGVpZ2h0OiBudW1iZXI7XG5cbiAgLy8gQ29udGVudCBhcmVhIChpbnNpZGUgcGFkZGluZylcbiAgY29udGVudFg6IG51bWJlcjtcbiAgY29udGVudFk6IG51bWJlcjtcbiAgY29udGVudFdpZHRoOiBudW1iZXI7XG4gIGNvbnRlbnRIZWlnaHQ6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBSZXN1bHQgb2YgbWVhc3VyaW5nIGEgY29tcG9uZW50J3Mgc2l6ZVxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIE1lYXN1cmVkU2l6ZSB7XG4gIHdpZHRoOiBudW1iZXI7XG4gIGhlaWdodDogbnVtYmVyO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBjcmVhdGUgYSBkZWZhdWx0IEJveE1vZGVsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEZWZhdWx0Qm94TW9kZWwob3ZlcnJpZGVzPzogUGFydGlhbDxCb3hNb2RlbD4pOiBCb3hNb2RlbCB7XG4gIHJldHVybiB7XG4gICAgd2lkdGg6ICdhdXRvJyxcbiAgICBoZWlnaHQ6ICdhdXRvJyxcbiAgICBwYWRkaW5nOiBFZGdlSW5zZXRzLnplcm8oKSxcbiAgICBtYXJnaW46IEVkZ2VJbnNldHMuemVybygpLFxuICAgIC4uLm92ZXJyaWRlc1xuICB9O1xufVxuIiwiLyoqXG4gKiBSZXByZXNlbnRzIHNwYWNpbmcgdmFsdWVzIGZvciB0aGUgZWRnZXMgb2YgYSBib3ggKHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdCkuXG4gKiBTaW1pbGFyIHRvIENTUyBwYWRkaW5nL21hcmdpbiBzeW50YXguXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBjbGFzcyBFZGdlSW5zZXRzIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gRWRnZUluc2V0cyB3aXRoIHNwZWNpZmljIHZhbHVlcyBmb3IgZWFjaCBlZGdlXG4gICAqXG4gICAqIEBwYXJhbSB0b3AgLSBUb3AgZWRnZSBzcGFjaW5nXG4gICAqIEBwYXJhbSByaWdodCAtIFJpZ2h0IGVkZ2Ugc3BhY2luZ1xuICAgKiBAcGFyYW0gYm90dG9tIC0gQm90dG9tIGVkZ2Ugc3BhY2luZ1xuICAgKiBAcGFyYW0gbGVmdCAtIExlZnQgZWRnZSBzcGFjaW5nXG4gICAqL1xuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgdG9wOiBudW1iZXIsXG4gICAgcHVibGljIHJpZ2h0OiBudW1iZXIsXG4gICAgcHVibGljIGJvdHRvbTogbnVtYmVyLFxuICAgIHB1YmxpYyBsZWZ0OiBudW1iZXJcbiAgKSB7fVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIEVkZ2VJbnNldHMgd2l0aCB0aGUgc2FtZSB2YWx1ZSBmb3IgYWxsIGVkZ2VzXG4gICAqIFNpbWlsYXIgdG8gQ1NTOiBwYWRkaW5nOiAxMHB4XG4gICAqXG4gICAqIEBwYXJhbSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byBhcHBseSB0byBhbGwgZWRnZXNcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBjb25zdCBwYWRkaW5nID0gRWRnZUluc2V0cy5hbGwoMjApOyAvLyAyMHB4IG9uIGFsbCBzaWRlc1xuICAgKiBgYGBcbiAgICovXG4gIHN0YXRpYyBhbGwodmFsdWU6IG51bWJlcik6IEVkZ2VJbnNldHMge1xuICAgIHJldHVybiBuZXcgRWRnZUluc2V0cyh2YWx1ZSwgdmFsdWUsIHZhbHVlLCB2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBFZGdlSW5zZXRzIHdpdGggc3ltbWV0cmljIHZlcnRpY2FsIGFuZCBob3Jpem9udGFsIHZhbHVlc1xuICAgKiBTaW1pbGFyIHRvIENTUzogcGFkZGluZzogMTBweCAyMHB4XG4gICAqXG4gICAqIEBwYXJhbSB2ZXJ0aWNhbCAtIFZhbHVlIGZvciB0b3AgYW5kIGJvdHRvbSBlZGdlc1xuICAgKiBAcGFyYW0gaG9yaXpvbnRhbCAtIFZhbHVlIGZvciBsZWZ0IGFuZCByaWdodCBlZGdlc1xuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IHBhZGRpbmcgPSBFZGdlSW5zZXRzLnN5bW1ldHJpYygxMCwgMjApOyAvLyAxMHB4IHRvcC9ib3R0b20sIDIwcHggbGVmdC9yaWdodFxuICAgKiBgYGBcbiAgICovXG4gIHN0YXRpYyBzeW1tZXRyaWModmVydGljYWw6IG51bWJlciwgaG9yaXpvbnRhbDogbnVtYmVyKTogRWRnZUluc2V0cyB7XG4gICAgcmV0dXJuIG5ldyBFZGdlSW5zZXRzKHZlcnRpY2FsLCBob3Jpem9udGFsLCB2ZXJ0aWNhbCwgaG9yaXpvbnRhbCk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBFZGdlSW5zZXRzIHdpdGggc3BlY2lmaWMgdmFsdWVzIGZvciBpbmRpdmlkdWFsIGVkZ2VzXG4gICAqIFNpbWlsYXIgdG8gQ1NTOiBwYWRkaW5nLXRvcCwgcGFkZGluZy1yaWdodCwgZXRjLlxuICAgKlxuICAgKiBAcGFyYW0gZWRnZXMgLSBPYmplY3Qgd2l0aCBvcHRpb25hbCB0b3AsIHJpZ2h0LCBib3R0b20sIGxlZnQgdmFsdWVzIChkZWZhdWx0cyB0byAwKVxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IHBhZGRpbmcgPSBFZGdlSW5zZXRzLm9ubHkoeyB0b3A6IDEwLCBsZWZ0OiAyMCB9KTsgLy8gMTBweCB0b3AsIDIwcHggbGVmdCwgMHB4IHJpZ2h0L2JvdHRvbVxuICAgKiBgYGBcbiAgICovXG4gIHN0YXRpYyBvbmx5KGVkZ2VzOiB7IHRvcD86IG51bWJlcjsgcmlnaHQ/OiBudW1iZXI7IGJvdHRvbT86IG51bWJlcjsgbGVmdD86IG51bWJlciB9KTogRWRnZUluc2V0cyB7XG4gICAgcmV0dXJuIG5ldyBFZGdlSW5zZXRzKFxuICAgICAgZWRnZXMudG9wID8/IDAsXG4gICAgICBlZGdlcy5yaWdodCA/PyAwLFxuICAgICAgZWRnZXMuYm90dG9tID8/IDAsXG4gICAgICBlZGdlcy5sZWZ0ID8/IDBcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgRWRnZUluc2V0cyB3aXRoIHplcm8gc3BhY2luZyBvbiBhbGwgZWRnZXNcbiAgICogU2ltaWxhciB0byBDU1M6IHBhZGRpbmc6IDBcbiAgICovXG4gIHN0YXRpYyB6ZXJvKCk6IEVkZ2VJbnNldHMge1xuICAgIHJldHVybiBuZXcgRWRnZUluc2V0cygwLCAwLCAwLCAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSB0b3RhbCBob3Jpem9udGFsIHNwYWNpbmcgKGxlZnQgKyByaWdodClcbiAgICovXG4gIGdldCBob3Jpem9udGFsKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMubGVmdCArIHRoaXMucmlnaHQ7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgdG90YWwgdmVydGljYWwgc3BhY2luZyAodG9wICsgYm90dG9tKVxuICAgKi9cbiAgZ2V0IHZlcnRpY2FsKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMudG9wICsgdGhpcy5ib3R0b207XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIGNvcHkgb2YgdGhlc2UgRWRnZUluc2V0c1xuICAgKi9cbiAgY2xvbmUoKTogRWRnZUluc2V0cyB7XG4gICAgcmV0dXJuIG5ldyBFZGdlSW5zZXRzKHRoaXMudG9wLCB0aGlzLnJpZ2h0LCB0aGlzLmJvdHRvbSwgdGhpcy5sZWZ0KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgQ29tcHV0ZWRMYXlvdXQsIE1lYXN1cmVkU2l6ZSwgY3JlYXRlRGVmYXVsdEJveE1vZGVsIH0gZnJvbSAnLi9ib3gtbW9kZWwnO1xuXG4vKipcbiAqIEJhc2UgYWJzdHJhY3QgY2xhc3MgZm9yIGFsbCBVSSBjb21wb25lbnRzXG4gKiBQcm92aWRlcyBib3ggbW9kZWwsIGxheW91dCwgYW5kIHJlbmRlcmluZyBmdW5jdGlvbmFsaXR5XG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBVSUNvbXBvbmVudCB7XG4gIC8qKlxuICAgKiBUaGUgUElYSSBjb250YWluZXIgdGhhdCBob2xkcyB0aGlzIGNvbXBvbmVudCdzIHZpc3VhbCByZXByZXNlbnRhdGlvblxuICAgKi9cbiAgcHVibGljIGNvbnRhaW5lcjogUElYSS5Db250YWluZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBib3ggbW9kZWwgZGVmaW5pbmcgdGhpcyBjb21wb25lbnQncyBzaXppbmcgYW5kIHNwYWNpbmdcbiAgICovXG4gIHByb3RlY3RlZCBib3hNb2RlbDogQm94TW9kZWw7XG5cbiAgLyoqXG4gICAqIEZvY3VzIHJpbmcgZm9yIHZpc3VhbCBmb2N1cyBpbmRpY2F0aW9uXG4gICAqL1xuICBwcm90ZWN0ZWQgZm9jdXNSaW5nPzogUElYSS5HcmFwaGljcztcblxuICAvKipcbiAgICogVGhlIGNvbXB1dGVkIGxheW91dCBhZnRlciBtZWFzdXJlbWVudCBhbmQgcG9zaXRpb25pbmdcbiAgICovXG4gIHByb3RlY3RlZCBjb21wdXRlZExheW91dDogQ29tcHV0ZWRMYXlvdXQ7XG5cbiAgLyoqXG4gICAqIFJlZmVyZW5jZSB0byBwYXJlbnQgY29tcG9uZW50IChpZiBhbnkpXG4gICAqL1xuICBwdWJsaWMgcGFyZW50PzogVUlDb21wb25lbnQ7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhpcyBjb21wb25lbnQgaXMgY3VycmVudGx5IHZpc2libGVcbiAgICovXG4gIHB1YmxpYyB2aXNpYmxlOiBib29sZWFuID0gdHJ1ZTtcblxuICAvKipcbiAgICogV2hldGhlciB0aGlzIGNvbXBvbmVudCBpcyBlbmFibGVkIGZvciBpbnRlcmFjdGlvblxuICAgKi9cbiAgcHVibGljIGVuYWJsZWQ6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIC8qKlxuICAgKiBGbGFnIGluZGljYXRpbmcgaWYgbGF5b3V0IG5lZWRzIHRvIGJlIHJlY2FsY3VsYXRlZFxuICAgKi9cbiAgcHJvdGVjdGVkIGxheW91dERpcnR5OiBib29sZWFuID0gdHJ1ZTtcblxuICAvKipcbiAgICogVGFiIGluZGV4IGZvciBmb2N1cyBvcmRlciAoLTEgbWVhbnMgbm90IGZvY3VzYWJsZSBieSB0YWIpXG4gICAqL1xuICBwdWJsaWMgdGFiSW5kZXg6IG51bWJlciA9IC0xO1xuXG4gIC8qKlxuICAgKiBJbnRlcm5hbCBmb2N1cyBzdGF0ZVxuICAgKi9cbiAgcHJvdGVjdGVkIGZvY3VzZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBjb25zdHJ1Y3Rvcihib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgdGhpcy5jb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICB0aGlzLmJveE1vZGVsID0gY3JlYXRlRGVmYXVsdEJveE1vZGVsKGJveE1vZGVsKTtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0ID0ge1xuICAgICAgeDogMCxcbiAgICAgIHk6IDAsXG4gICAgICB3aWR0aDogMCxcbiAgICAgIGhlaWdodDogMCxcbiAgICAgIGNvbnRlbnRYOiAwLFxuICAgICAgY29udGVudFk6IDAsXG4gICAgICBjb250ZW50V2lkdGg6IDAsXG4gICAgICBjb250ZW50SGVpZ2h0OiAwXG4gICAgfTtcblxuICAgIC8vIENyZWF0ZSBmb2N1cyByaW5nIChpbml0aWFsbHkgaGlkZGVuKVxuICAgIHRoaXMuY3JlYXRlRm9jdXNSaW5nKCk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyB0aGUgZm9jdXMgcmluZyBncmFwaGljc1xuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVGb2N1c1JpbmcoKTogdm9pZCB7XG4gICAgdGhpcy5mb2N1c1JpbmcgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMuZm9jdXNSaW5nLnZpc2libGUgPSBmYWxzZTtcbiAgICAvLyBBZGQgYXMgZmlyc3QgY2hpbGQgc28gaXQgcmVuZGVycyBiZWhpbmQgY29udGVudFxuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkQXQodGhpcy5mb2N1c1JpbmcsIDApO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGZvY3VzIHJpbmcgYXBwZWFyYW5jZSBiYXNlZCBvbiBjb21wb25lbnQgc2l6ZVxuICAgKi9cbiAgcHJvdGVjdGVkIHVwZGF0ZUZvY3VzUmluZygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZm9jdXNSaW5nKSByZXR1cm47XG5cbiAgICB0aGlzLmZvY3VzUmluZy5jbGVhcigpO1xuXG4gICAgY29uc3Qgd2lkdGggPSB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoO1xuICAgIGNvbnN0IGhlaWdodCA9IHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0O1xuXG4gICAgaWYgKHdpZHRoIDw9IDAgfHwgaGVpZ2h0IDw9IDApIHJldHVybjtcblxuICAgIC8vIEFuaW1hdGVkIHB1bHNpbmcgZWZmZWN0IHdpdGggZGFzaGVkIG91dGxpbmVcbiAgICBjb25zdCBvZmZzZXQgPSA0O1xuICAgIGNvbnN0IHN0cm9rZVdpZHRoID0gMztcblxuICAgIC8vIERyYXcgb3V0ZXIgZ2xvd1xuICAgIHRoaXMuZm9jdXNSaW5nLnJvdW5kUmVjdChcbiAgICAgIC1vZmZzZXQgLSAyLFxuICAgICAgLW9mZnNldCAtIDIsXG4gICAgICB3aWR0aCArIChvZmZzZXQgKyAyKSAqIDIsXG4gICAgICBoZWlnaHQgKyAob2Zmc2V0ICsgMikgKiAyLFxuICAgICAgOFxuICAgICk7XG4gICAgdGhpcy5mb2N1c1Jpbmcuc3Ryb2tlKHtcbiAgICAgIGNvbG9yOiAweDAwZDlmZixcbiAgICAgIHdpZHRoOiBzdHJva2VXaWR0aCArIDIsXG4gICAgICBhbHBoYTogMC4zXG4gICAgfSk7XG5cbiAgICAvLyBEcmF3IG1haW4gZm9jdXMgcmluZ1xuICAgIHRoaXMuZm9jdXNSaW5nLnJvdW5kUmVjdChcbiAgICAgIC1vZmZzZXQsXG4gICAgICAtb2Zmc2V0LFxuICAgICAgd2lkdGggKyBvZmZzZXQgKiAyLFxuICAgICAgaGVpZ2h0ICsgb2Zmc2V0ICogMixcbiAgICAgIDhcbiAgICApO1xuICAgIHRoaXMuZm9jdXNSaW5nLnN0cm9rZSh7XG4gICAgICBjb2xvcjogMHgwMGQ5ZmYsXG4gICAgICB3aWR0aDogc3Ryb2tlV2lkdGhcbiAgICB9KTtcblxuICAgIC8vIERyYXcgaW5uZXIgaGlnaGxpZ2h0XG4gICAgdGhpcy5mb2N1c1Jpbmcucm91bmRSZWN0KFxuICAgICAgLW9mZnNldCArIHN0cm9rZVdpZHRoLFxuICAgICAgLW9mZnNldCArIHN0cm9rZVdpZHRoLFxuICAgICAgd2lkdGggKyAob2Zmc2V0IC0gc3Ryb2tlV2lkdGgpICogMixcbiAgICAgIGhlaWdodCArIChvZmZzZXQgLSBzdHJva2VXaWR0aCkgKiAyLFxuICAgICAgNlxuICAgICk7XG4gICAgdGhpcy5mb2N1c1Jpbmcuc3Ryb2tlKHtcbiAgICAgIGNvbG9yOiAweGZmZmZmZixcbiAgICAgIHdpZHRoOiAxLFxuICAgICAgYWxwaGE6IDAuNlxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmVzIHRoZSBzaXplIHRoaXMgY29tcG9uZW50IG5lZWRzXG4gICAqIE11c3QgYmUgaW1wbGVtZW50ZWQgYnkgc3ViY2xhc3Nlc1xuICAgKlxuICAgKiBAcmV0dXJucyBUaGUgbWVhc3VyZWQgd2lkdGggYW5kIGhlaWdodFxuICAgKi9cbiAgYWJzdHJhY3QgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemU7XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGxheW91dCBmb3IgdGhpcyBjb21wb25lbnQgd2l0aGluIHRoZSBnaXZlbiBhdmFpbGFibGUgc3BhY2VcbiAgICogTXVzdCBiZSBpbXBsZW1lbnRlZCBieSBzdWJjbGFzc2VzXG4gICAqXG4gICAqIEBwYXJhbSBhdmFpbGFibGVXaWR0aCAtIEF2YWlsYWJsZSB3aWR0aCBpbiBwaXhlbHNcbiAgICogQHBhcmFtIGF2YWlsYWJsZUhlaWdodCAtIEF2YWlsYWJsZSBoZWlnaHQgaW4gcGl4ZWxzXG4gICAqL1xuICBhYnN0cmFjdCBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSBjb21wb25lbnQncyB2aXN1YWxzXG4gICAqIENhbGxlZCBhZnRlciBsYXlvdXQgaXMgY29tcGxldGVcbiAgICovXG4gIHByb3RlY3RlZCBhYnN0cmFjdCByZW5kZXIoKTogdm9pZDtcblxuICAvKipcbiAgICogTWFya3MgdGhpcyBjb21wb25lbnQncyBsYXlvdXQgYXMgZGlydHksIHJlcXVpcmluZyByZWNhbGN1bGF0aW9uXG4gICAqL1xuICBwdWJsaWMgbWFya0xheW91dERpcnR5KCk6IHZvaWQge1xuICAgIHRoaXMubGF5b3V0RGlydHkgPSB0cnVlO1xuICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgdGhpcy5wYXJlbnQubWFya0xheW91dERpcnR5KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGNvbXB1dGVkIGxheW91dCBvZiB0aGlzIGNvbXBvbmVudFxuICAgKi9cbiAgcHVibGljIGdldExheW91dCgpOiBDb21wdXRlZExheW91dCB7XG4gICAgcmV0dXJuIHRoaXMuY29tcHV0ZWRMYXlvdXQ7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgYm94IG1vZGVsIG9mIHRoaXMgY29tcG9uZW50XG4gICAqL1xuICBwdWJsaWMgZ2V0Qm94TW9kZWwoKTogQm94TW9kZWwge1xuICAgIHJldHVybiB0aGlzLmJveE1vZGVsO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGdsb2JhbCBib3VuZHMgb2YgdGhpcyBjb21wb25lbnQgKHBvc2l0aW9uIHJlbGF0aXZlIHRvIHN0YWdlKVxuICAgKi9cbiAgcHVibGljIGdldEdsb2JhbEJvdW5kcygpOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyOyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlciB9IHtcbiAgICBjb25zdCBnbG9iYWxQb3MgPSB0aGlzLmNvbnRhaW5lci5nZXRHbG9iYWxQb3NpdGlvbigpO1xuICAgIHJldHVybiB7XG4gICAgICB4OiBnbG9iYWxQb3MueCxcbiAgICAgIHk6IGdsb2JhbFBvcy55LFxuICAgICAgd2lkdGg6IHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBwb3NpdGlvbiBvZiB0aGlzIGNvbXBvbmVudFxuICAgKi9cbiAgcHVibGljIHNldFBvc2l0aW9uKHg6IG51bWJlciwgeTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC54ID0geDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LnkgPSB5O1xuICAgIHRoaXMuY29udGFpbmVyLnBvc2l0aW9uLnNldCh4LCB5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTaG93cyB0aGlzIGNvbXBvbmVudFxuICAgKi9cbiAgcHVibGljIHNob3coKTogdm9pZCB7XG4gICAgdGhpcy52aXNpYmxlID0gdHJ1ZTtcbiAgICB0aGlzLmNvbnRhaW5lci52aXNpYmxlID0gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIaWRlcyB0aGlzIGNvbXBvbmVudFxuICAgKi9cbiAgcHVibGljIGhpZGUoKTogdm9pZCB7XG4gICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5jb250YWluZXIudmlzaWJsZSA9IGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhpcyBjb21wb25lbnQgY2FuIHJlY2VpdmUgZm9jdXNcbiAgICovXG4gIHB1YmxpYyBjYW5Gb2N1cygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5lbmFibGVkICYmIHRoaXMudmlzaWJsZSAmJiB0aGlzLnRhYkluZGV4ID49IDA7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0aGlzIGNvbXBvbmVudCBpcyBjdXJyZW50bHkgZm9jdXNlZFxuICAgKi9cbiAgcHVibGljIGlzRm9jdXNlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5mb2N1c2VkO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGNvbXBvbmVudCByZWNlaXZlcyBmb2N1c1xuICAgKiBPdmVycmlkZSBpbiBzdWJjbGFzc2VzIHRvIGN1c3RvbWl6ZSBmb2N1cyBiZWhhdmlvclxuICAgKi9cbiAgcHVibGljIG9uRm9jdXMoKTogdm9pZCB7XG4gICAgdGhpcy5mb2N1c2VkID0gdHJ1ZTtcbiAgICB0aGlzLnNob3dGb2N1c1JpbmcoKTtcbiAgICB0aGlzLnNjcm9sbEludG9WaWV3KCk7XG4gIH1cblxuICAvKipcbiAgICogU2hvd3MgdGhlIGZvY3VzIHJpbmdcbiAgICovXG4gIHByb3RlY3RlZCBzaG93Rm9jdXNSaW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzUmluZykge1xuICAgICAgdGhpcy51cGRhdGVGb2N1c1JpbmcoKTtcbiAgICAgIHRoaXMuZm9jdXNSaW5nLnZpc2libGUgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRoaXMgY29tcG9uZW50IGludG8gdmlldyBpZiBpdCdzIGluc2lkZSBhIHNjcm9sbCBjb250YWluZXJcbiAgICovXG4gIHByaXZhdGUgc2Nyb2xsSW50b1ZpZXcoKTogdm9pZCB7XG4gICAgLy8gV2FsayB1cCB0aGUgcGFyZW50IGNoYWluIHRvIGZpbmQgYSBzY3JvbGwgY29udGFpbmVyXG4gICAgbGV0IGN1cnJlbnRQYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICB3aGlsZSAoY3VycmVudFBhcmVudCkge1xuICAgICAgLy8gQ2hlY2sgaWYgcGFyZW50IGhhcyBzY3JvbGxUb0NvbXBvbmVudCBtZXRob2QgKGR1Y2sgdHlwaW5nIGZvciBVSVNjcm9sbENvbnRhaW5lcilcbiAgICAgIGlmICgnc2Nyb2xsVG9Db21wb25lbnQnIGluIGN1cnJlbnRQYXJlbnQgJiYgdHlwZW9mIChjdXJyZW50UGFyZW50IGFzIGFueSkuc2Nyb2xsVG9Db21wb25lbnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgKGN1cnJlbnRQYXJlbnQgYXMgYW55KS5zY3JvbGxUb0NvbXBvbmVudCh0aGlzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjdXJyZW50UGFyZW50ID0gY3VycmVudFBhcmVudC5wYXJlbnQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGNvbXBvbmVudCBsb3NlcyBmb2N1c1xuICAgKiBPdmVycmlkZSBpbiBzdWJjbGFzc2VzIHRvIGN1c3RvbWl6ZSBibHVyIGJlaGF2aW9yXG4gICAqL1xuICBwdWJsaWMgb25CbHVyKCk6IHZvaWQge1xuICAgIHRoaXMuZm9jdXNlZCA9IGZhbHNlO1xuICAgIHRoaXMuaGlkZUZvY3VzUmluZygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhpZGVzIHRoZSBmb2N1cyByaW5nXG4gICAqL1xuICBwcm90ZWN0ZWQgaGlkZUZvY3VzUmluZygpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5mb2N1c1JpbmcpIHtcbiAgICAgIHRoaXMuZm9jdXNSaW5nLnZpc2libGUgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGVzdHJveXMgdGhpcyBjb21wb25lbnQgYW5kIGNsZWFucyB1cCByZXNvdXJjZXNcbiAgICovXG4gIHB1YmxpYyBkZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmRlc3Ryb3koeyBjaGlsZHJlbjogdHJ1ZSB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuL3VpLWNvbXBvbmVudCc7XG5cbi8qKlxuICogSW50ZXJmYWNlIGZvciBmb2N1c2FibGUgVUkgY29tcG9uZW50c1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvY3VzYWJsZSB7XG4gIC8qKiBXaGV0aGVyIHRoaXMgY29tcG9uZW50IGNhbiByZWNlaXZlIGZvY3VzICovXG4gIGNhbkZvY3VzKCk6IGJvb2xlYW47XG4gIC8qKiBDYWxsZWQgd2hlbiBjb21wb25lbnQgcmVjZWl2ZXMgZm9jdXMgKi9cbiAgb25Gb2N1cygpOiB2b2lkO1xuICAvKiogQ2FsbGVkIHdoZW4gY29tcG9uZW50IGxvc2VzIGZvY3VzICovXG4gIG9uQmx1cigpOiB2b2lkO1xuICAvKiogVGhlIHRhYiBpbmRleCBmb3IgZm9jdXMgb3JkZXIgKGxvd2VyIHZhbHVlcyBmb2N1c2VkIGZpcnN0KSAqL1xuICB0YWJJbmRleDogbnVtYmVyO1xuICAvKiogV2hldGhlciB0aGlzIGNvbXBvbmVudCBpcyBjdXJyZW50bHkgZm9jdXNlZCAqL1xuICBpc0ZvY3VzZWQoKTogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBNYW5hZ2VzIGtleWJvYXJkIGZvY3VzIGFuZCB0YWIgbmF2aWdhdGlvbiBmb3IgVUkgY29tcG9uZW50c1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBmb2N1c01hbmFnZXIgPSBuZXcgVUlGb2N1c01hbmFnZXIoKTtcbiAqIGZvY3VzTWFuYWdlci5yZWdpc3RlcihidXR0b24xKTtcbiAqIGZvY3VzTWFuYWdlci5yZWdpc3Rlcih0ZXh0SW5wdXQxKTtcbiAqIGZvY3VzTWFuYWdlci5yZWdpc3RlcihidXR0b24yKTtcbiAqXG4gKiAvLyBGb2N1cyBmaXJzdCBjb21wb25lbnRcbiAqIGZvY3VzTWFuYWdlci5mb2N1c0ZpcnN0KCk7XG4gKlxuICogLy8gT3IgZm9jdXMgc3BlY2lmaWMgY29tcG9uZW50XG4gKiBmb2N1c01hbmFnZXIuZm9jdXModGV4dElucHV0MSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJRm9jdXNNYW5hZ2VyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFVJRm9jdXNNYW5hZ2VyIHwgbnVsbCA9IG51bGw7XG5cbiAgcHJpdmF0ZSBmb2N1c2FibGVDb21wb25lbnRzOiAoVUlDb21wb25lbnQgJiBGb2N1c2FibGUpW10gPSBbXTtcbiAgcHJpdmF0ZSBjdXJyZW50Rm9jdXNJbmRleDogbnVtYmVyID0gLTE7XG4gIHByaXZhdGUga2V5ZG93bkhhbmRsZXI6ICgoZTogS2V5Ym9hcmRFdmVudCkgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnNldHVwS2V5Ym9hcmRMaXN0ZW5lcnMoKTtcbiAgICAvLyBTZXQgYXMgc2luZ2xldG9uIGluc3RhbmNlXG4gICAgVUlGb2N1c01hbmFnZXIuaW5zdGFuY2UgPSB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgZ2xvYmFsIGZvY3VzIG1hbmFnZXIgaW5zdGFuY2VcbiAgICovXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBVSUZvY3VzTWFuYWdlciB8IG51bGwge1xuICAgIHJldHVybiBVSUZvY3VzTWFuYWdlci5pbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHVwIGdsb2JhbCBrZXlib2FyZCBsaXN0ZW5lcnMgZm9yIHRhYiBuYXZpZ2F0aW9uXG4gICAqL1xuICBwcml2YXRlIHNldHVwS2V5Ym9hcmRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSByZXR1cm47XG5cbiAgICAvLyBSZW1vdmUgZXhpc3RpbmcgaGFuZGxlciBpZiBwcmVzZW50IHRvIHByZXZlbnQgZHVwbGljYXRlc1xuICAgIGlmICh0aGlzLmtleWRvd25IYW5kbGVyKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5ZG93bkhhbmRsZXIpO1xuICAgIH1cblxuICAgIHRoaXMua2V5ZG93bkhhbmRsZXIgPSAoZTogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgaWYgKGUua2V5ID09PSAnVGFiJykge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgaWYgKGUuc2hpZnRLZXkpIHtcbiAgICAgICAgICB0aGlzLmZvY3VzUHJldmlvdXMoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmZvY3VzTmV4dCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlkb3duSGFuZGxlcik7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXJzIGEgZm9jdXNhYmxlIGNvbXBvbmVudFxuICAgKi9cbiAgcmVnaXN0ZXIoY29tcG9uZW50OiBVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSk6IHZvaWQge1xuICAgIGlmICghdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmluY2x1ZGVzKGNvbXBvbmVudCkpIHtcbiAgICAgIHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgICB0aGlzLnNvcnRCeVRhYkluZGV4KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEF1dG9tYXRpY2FsbHkgZGlzY292ZXJzIGFuZCByZWdpc3RlcnMgYWxsIGZvY3VzYWJsZSBjb21wb25lbnRzIGluIGEgY29udGFpbmVyXG4gICAqIFdhbGtzIHRoZSBjb21wb25lbnQgdHJlZSBhbmQgZmluZHMgYWxsIGNvbXBvbmVudHMgd2l0aCB0YWJJbmRleCA+PSAwXG4gICAqL1xuICByZWdpc3RlckNvbnRhaW5lcihjb250YWluZXI6IFVJQ29tcG9uZW50KTogdm9pZCB7XG4gICAgdGhpcy5kaXNjb3ZlckZvY3VzYWJsZUNvbXBvbmVudHMoY29udGFpbmVyKTtcbiAgICB0aGlzLnNvcnRCeVRhYkluZGV4KCk7XG4gIH1cblxuICAvKipcbiAgICogUmVjdXJzaXZlbHkgZGlzY292ZXJzIGZvY3VzYWJsZSBjb21wb25lbnRzIGluIHRoZSB0cmVlXG4gICAqL1xuICBwcml2YXRlIGRpc2NvdmVyRm9jdXNhYmxlQ29tcG9uZW50cyhjb21wb25lbnQ6IFVJQ29tcG9uZW50KTogdm9pZCB7XG4gICAgLy8gQ2hlY2sgaWYgdGhpcyBjb21wb25lbnQgaXMgZm9jdXNhYmxlXG4gICAgaWYgKHRoaXMuaXNGb2N1c2FibGVDb21wb25lbnQoY29tcG9uZW50KSkge1xuICAgICAgdGhpcy5yZWdpc3Rlcihjb21wb25lbnQgYXMgVUlDb21wb25lbnQgJiBGb2N1c2FibGUpO1xuICAgIH1cblxuICAgIC8vIFJlY3Vyc2l2ZWx5IGNoZWNrIGNoaWxkcmVuIChpZiBpdCdzIGEgY29udGFpbmVyIHR5cGUpXG4gICAgaWYgKCdjaGlsZHJlbicgaW4gY29tcG9uZW50ICYmIEFycmF5LmlzQXJyYXkoKGNvbXBvbmVudCBhcyBhbnkpLmNoaWxkcmVuKSkge1xuICAgICAgY29uc3QgY2hpbGRyZW4gPSAoY29tcG9uZW50IGFzIGFueSkuY2hpbGRyZW4gYXMgVUlDb21wb25lbnRbXTtcbiAgICAgIGNoaWxkcmVuLmZvckVhY2goY2hpbGQgPT4gdGhpcy5kaXNjb3ZlckZvY3VzYWJsZUNvbXBvbmVudHMoY2hpbGQpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGEgY29tcG9uZW50IGltcGxlbWVudHMgdGhlIEZvY3VzYWJsZSBpbnRlcmZhY2VcbiAgICovXG4gIHByaXZhdGUgaXNGb2N1c2FibGVDb21wb25lbnQoY29tcG9uZW50OiBVSUNvbXBvbmVudCk6IGNvbXBvbmVudCBpcyBVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHR5cGVvZiBjb21wb25lbnQudGFiSW5kZXggPT09ICdudW1iZXInICYmXG4gICAgICBjb21wb25lbnQudGFiSW5kZXggPj0gMCAmJlxuICAgICAgdHlwZW9mIGNvbXBvbmVudC5jYW5Gb2N1cyA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgdHlwZW9mIGNvbXBvbmVudC5vbkZvY3VzID09PSAnZnVuY3Rpb24nICYmXG4gICAgICB0eXBlb2YgY29tcG9uZW50Lm9uQmx1ciA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgdHlwZW9mIGNvbXBvbmVudC5pc0ZvY3VzZWQgPT09ICdmdW5jdGlvbidcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFVucmVnaXN0ZXJzIGEgZm9jdXNhYmxlIGNvbXBvbmVudFxuICAgKi9cbiAgdW5yZWdpc3Rlcihjb21wb25lbnQ6IFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKTogdm9pZCB7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMuaW5kZXhPZihjb21wb25lbnQpO1xuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIGlmIChpbmRleCA9PT0gdGhpcy5jdXJyZW50Rm9jdXNJbmRleCkge1xuICAgICAgICB0aGlzLmJsdXIoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgaWYgKHRoaXMuY3VycmVudEZvY3VzSW5kZXggPiBpbmRleCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRGb2N1c0luZGV4LS07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNvcnRzIGNvbXBvbmVudHMgYnkgdGFiIGluZGV4XG4gICAqL1xuICBwcml2YXRlIHNvcnRCeVRhYkluZGV4KCk6IHZvaWQge1xuICAgIHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5zb3J0KChhLCBiKSA9PiBhLnRhYkluZGV4IC0gYi50YWJJbmRleCk7XG4gIH1cblxuICAvKipcbiAgICogRm9jdXNlcyBhIHNwZWNpZmljIGNvbXBvbmVudFxuICAgKi9cbiAgZm9jdXMoY29tcG9uZW50OiBVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSk6IHZvaWQge1xuICAgIGlmICghY29tcG9uZW50LmNhbkZvY3VzKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBpbmRleCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5pbmRleE9mKGNvbXBvbmVudCk7XG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEJsdXIgY3VycmVudCBmb2N1c1xuICAgIGlmICh0aGlzLmN1cnJlbnRGb2N1c0luZGV4ICE9PSAtMSAmJiB0aGlzLmN1cnJlbnRGb2N1c0luZGV4ICE9PSBpbmRleCkge1xuICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1t0aGlzLmN1cnJlbnRGb2N1c0luZGV4XTtcbiAgICAgIGlmIChjdXJyZW50KSB7XG4gICAgICAgIGN1cnJlbnQub25CbHVyKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRm9jdXMgbmV3IGNvbXBvbmVudFxuICAgIHRoaXMuY3VycmVudEZvY3VzSW5kZXggPSBpbmRleDtcbiAgICBjb21wb25lbnQub25Gb2N1cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlcXVlc3QgZm9jdXMgZm9yIGEgY29tcG9uZW50IChjYWxsZWQgYnkgY29tcG9uZW50cyB3aGVuIGNsaWNrZWQpXG4gICAqIFRoaXMgaXMgYSBoZWxwZXIgdGhhdCBmaW5kcyB0aGUgY29tcG9uZW50IGFuZCBjYWxscyBmb2N1cygpXG4gICAqL1xuICByZXF1ZXN0Rm9jdXMoY29tcG9uZW50OiBVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSk6IHZvaWQge1xuICAgIHRoaXMuZm9jdXMoY29tcG9uZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCbHVycyB0aGUgY3VycmVudGx5IGZvY3VzZWQgY29tcG9uZW50XG4gICAqL1xuICBibHVyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmN1cnJlbnRGb2N1c0luZGV4ICE9PSAtMSkge1xuICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1t0aGlzLmN1cnJlbnRGb2N1c0luZGV4XTtcbiAgICAgIGlmIChjdXJyZW50KSB7XG4gICAgICAgIGN1cnJlbnQub25CbHVyKCk7XG4gICAgICB9XG4gICAgICB0aGlzLmN1cnJlbnRGb2N1c0luZGV4ID0gLTE7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZvY3VzZXMgdGhlIG5leHQgY29tcG9uZW50IGluIHRhYiBvcmRlclxuICAgKi9cbiAgZm9jdXNOZXh0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBsZXQgbmV4dEluZGV4ID0gdGhpcy5jdXJyZW50Rm9jdXNJbmRleCArIDE7XG4gICAgbGV0IGF0dGVtcHRzID0gMDtcblxuICAgIC8vIEZpbmQgbmV4dCBmb2N1c2FibGUgY29tcG9uZW50XG4gICAgd2hpbGUgKGF0dGVtcHRzIDwgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmxlbmd0aCkge1xuICAgICAgaWYgKG5leHRJbmRleCA+PSB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoKSB7XG4gICAgICAgIG5leHRJbmRleCA9IDA7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1tuZXh0SW5kZXhdO1xuICAgICAgaWYgKGNvbXBvbmVudCAmJiBjb21wb25lbnQuY2FuRm9jdXMoKSkge1xuICAgICAgICB0aGlzLmZvY3VzKGNvbXBvbmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbmV4dEluZGV4Kys7XG4gICAgICBhdHRlbXB0cysrO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGb2N1c2VzIHRoZSBwcmV2aW91cyBjb21wb25lbnQgaW4gdGFiIG9yZGVyXG4gICAqL1xuICBmb2N1c1ByZXZpb3VzKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBsZXQgcHJldkluZGV4ID0gdGhpcy5jdXJyZW50Rm9jdXNJbmRleCAtIDE7XG4gICAgbGV0IGF0dGVtcHRzID0gMDtcblxuICAgIC8vIEZpbmQgcHJldmlvdXMgZm9jdXNhYmxlIGNvbXBvbmVudFxuICAgIHdoaWxlIChhdHRlbXB0cyA8IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGgpIHtcbiAgICAgIGlmIChwcmV2SW5kZXggPCAwKSB7XG4gICAgICAgIHByZXZJbmRleCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGggLSAxO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjb21wb25lbnQgPSB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHNbcHJldkluZGV4XTtcbiAgICAgIGlmIChjb21wb25lbnQgJiYgY29tcG9uZW50LmNhbkZvY3VzKCkpIHtcbiAgICAgICAgdGhpcy5mb2N1cyhjb21wb25lbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHByZXZJbmRleC0tO1xuICAgICAgYXR0ZW1wdHMrKztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRm9jdXNlcyB0aGUgZmlyc3QgZm9jdXNhYmxlIGNvbXBvbmVudFxuICAgKi9cbiAgZm9jdXNGaXJzdCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgZm9yIChjb25zdCBjb21wb25lbnQgb2YgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzKSB7XG4gICAgICBpZiAoY29tcG9uZW50LmNhbkZvY3VzKCkpIHtcbiAgICAgICAgdGhpcy5mb2N1cyhjb21wb25lbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZvY3VzZXMgdGhlIGxhc3QgZm9jdXNhYmxlIGNvbXBvbmVudFxuICAgKi9cbiAgZm9jdXNMYXN0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBmb3IgKGxldCBpID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBjb25zdCBjb21wb25lbnQgPSB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHNbaV07XG4gICAgICBpZiAoY29tcG9uZW50LmNhbkZvY3VzKCkpIHtcbiAgICAgICAgdGhpcy5mb2N1cyhjb21wb25lbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnRseSBmb2N1c2VkIGNvbXBvbmVudFxuICAgKi9cbiAgZ2V0Q3VycmVudEZvY3VzKCk6IChVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSkgfCBudWxsIHtcbiAgICBpZiAodGhpcy5jdXJyZW50Rm9jdXNJbmRleCA9PT0gLTEpIHJldHVybiBudWxsO1xuICAgIHJldHVybiB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHNbdGhpcy5jdXJyZW50Rm9jdXNJbmRleF0gfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGFsbCByZWdpc3RlcmVkIGZvY3VzYWJsZSBjb21wb25lbnRzXG4gICAqL1xuICBnZXRGb2N1c2FibGVDb21wb25lbnRzKCk6IChVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSlbXSB7XG4gICAgcmV0dXJuIFsuLi50aGlzLmZvY3VzYWJsZUNvbXBvbmVudHNdO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFycyBhbGwgcmVnaXN0ZXJlZCBjb21wb25lbnRzXG4gICAqL1xuICBjbGVhcigpOiB2b2lkIHtcbiAgICB0aGlzLmJsdXIoKTtcbiAgICB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMgPSBbXTtcbiAgICB0aGlzLmN1cnJlbnRGb2N1c0luZGV4ID0gLTE7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCB3aGVuIGRlc3Ryb3lpbmcgdGhlIGZvY3VzIG1hbmFnZXJcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHRoaXMua2V5ZG93bkhhbmRsZXIpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlkb3duSGFuZGxlcik7XG4gICAgfVxuICAgIHRoaXMuY2xlYXIoKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5pbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi4vY29yZS9lZGdlLWluc2V0cyc7XG5cbi8qKiBGbGV4Ym94IGRpcmVjdGlvbi4gKi9cbmV4cG9ydCBlbnVtIEZsZXhEaXJlY3Rpb24ge1xuICBSb3cgPSAncm93JywgICAgICAgICAgICAgIC8vIEhvcml6b250YWwsIGxlZnQgdG8gcmlnaHRcbiAgUm93UmV2ZXJzZSA9ICdyb3ctcmV2ZXJzZScsXG4gIENvbHVtbiA9ICdjb2x1bW4nLCAgICAgICAgLy8gVmVydGljYWwsIHRvcCB0byBib3R0b21cbiAgQ29sdW1uUmV2ZXJzZSA9ICdjb2x1bW4tcmV2ZXJzZSdcbn1cblxuLyoqIE1haW4gYXhpcyBhbGlnbm1lbnQuICovXG5leHBvcnQgZW51bSBGbGV4SnVzdGlmeSB7XG4gIFN0YXJ0ID0gJ3N0YXJ0JywgICAgICAgICAgLy8gUGFjayBpdGVtcyB0byBzdGFydFxuICBFbmQgPSAnZW5kJywgICAgICAgICAgICAgIC8vIFBhY2sgaXRlbXMgdG8gZW5kXG4gIENlbnRlciA9ICdjZW50ZXInLCAgICAgICAgLy8gQ2VudGVyIGl0ZW1zXG4gIFNwYWNlQmV0d2VlbiA9ICdzcGFjZS1iZXR3ZWVuJywgIC8vIFNwYWNlIGJldHdlZW4gaXRlbXNcbiAgU3BhY2VBcm91bmQgPSAnc3BhY2UtYXJvdW5kJywgICAgLy8gU3BhY2UgYXJvdW5kIGl0ZW1zXG4gIFNwYWNlRXZlbmx5ID0gJ3NwYWNlLWV2ZW5seScgICAgIC8vIEV2ZW4gc3BhY2UgYmV0d2VlbiBpdGVtc1xufVxuXG4vKiogQ3Jvc3MgYXhpcyBhbGlnbm1lbnQuICovXG5leHBvcnQgZW51bSBGbGV4QWxpZ24ge1xuICBTdGFydCA9ICdzdGFydCcsXG4gIEVuZCA9ICdlbmQnLFxuICBDZW50ZXIgPSAnY2VudGVyJyxcbiAgU3RyZXRjaCA9ICdzdHJldGNoJyAgICAgICAvLyBTdHJldGNoIHRvIGZpbGwgY3Jvc3MgYXhpc1xufVxuXG4vKiogRmxleENvbnRhaW5lciBjb25maWd1cmF0aW9uLiAqL1xuZXhwb3J0IGludGVyZmFjZSBGbGV4Q29udGFpbmVyUHJvcHMge1xuICBkaXJlY3Rpb24/OiBGbGV4RGlyZWN0aW9uO1xuICBqdXN0aWZ5PzogRmxleEp1c3RpZnk7XG4gIGFsaWduPzogRmxleEFsaWduO1xuICBnYXA/OiBudW1iZXI7ICAgICAgICAgICAgICAvLyBTcGFjZSBiZXR3ZWVuIGNoaWxkcmVuXG4gIHdyYXA/OiBib29sZWFuOyAgICAgICAgICAgIC8vIEFsbG93IHdyYXBwaW5nIChQaGFzZSAyKVxuICBwYWRkaW5nPzogRWRnZUluc2V0cztcbiAgd2lkdGg/OiBudW1iZXIgfCAnZmlsbCc7XG4gIGhlaWdodD86IG51bWJlciB8ICdmaWxsJztcbn1cblxuLyoqXG4gKiBGbGV4Ym94LXN0eWxlIGxheW91dCBjb250YWluZXIgZm9yIGFycmFuZ2luZyBVSSBjb21wb25lbnRzLlxuICogU3VwcG9ydHMgcm93L2NvbHVtbiBkaXJlY3Rpb24sIGFsaWdubWVudCwganVzdGlmeSwgYW5kIGdhcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiAvLyBIb3Jpem9udGFsIHJvdyB3aXRoIGNlbnRlcmVkIGl0ZW1zXG4gKiBjb25zdCB0b29sYmFyID0gbmV3IEZsZXhDb250YWluZXIoe1xuICogICBkaXJlY3Rpb246IEZsZXhEaXJlY3Rpb24uUm93LFxuICogICBqdXN0aWZ5OiBGbGV4SnVzdGlmeS5DZW50ZXIsXG4gKiAgIGFsaWduOiBGbGV4QWxpZ24uQ2VudGVyLFxuICogICBnYXA6IDEwLFxuICogICBwYWRkaW5nOiBFZGdlSW5zZXRzLmFsbCgyMClcbiAqIH0pO1xuICogdG9vbGJhci5hZGRDaGlsZChidXR0b24xKTtcbiAqIHRvb2xiYXIuYWRkQ2hpbGQoYnV0dG9uMik7XG4gKiB0b29sYmFyLmFkZENoaWxkKGJ1dHRvbjMpO1xuICpcbiAqIC8vIFZlcnRpY2FsIGNvbHVtbiB3aXRoIHNwYWNlIGJldHdlZW5cbiAqIGNvbnN0IHNpZGViYXIgPSBuZXcgRmxleENvbnRhaW5lcih7XG4gKiAgIGRpcmVjdGlvbjogRmxleERpcmVjdGlvbi5Db2x1bW4sXG4gKiAgIGp1c3RpZnk6IEZsZXhKdXN0aWZ5LlNwYWNlQmV0d2VlbixcbiAqICAgd2lkdGg6IDIwMCxcbiAqICAgaGVpZ2h0OiAnZmlsbCdcbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBGbGV4Q29udGFpbmVyIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxPbWl0PEZsZXhDb250YWluZXJQcm9wcywgJ3BhZGRpbmcnIHwgJ3dpZHRoJyB8ICdoZWlnaHQnPj47XG4gIHB1YmxpYyBjaGlsZHJlbjogVUlDb21wb25lbnRbXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBGbGV4Q29udGFpbmVyUHJvcHMgPSB7fSkge1xuICAgIGNvbnN0IGJveE1vZGVsOiBQYXJ0aWFsPEJveE1vZGVsPiA9IHtcbiAgICAgIHBhZGRpbmc6IHByb3BzLnBhZGRpbmcgPz8gRWRnZUluc2V0cy56ZXJvKCksXG4gICAgICB3aWR0aDogcHJvcHMud2lkdGggPz8gJ2F1dG8nLFxuICAgICAgaGVpZ2h0OiBwcm9wcy5oZWlnaHQgPz8gJ2F1dG8nXG4gICAgfTtcblxuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBkaXJlY3Rpb246IHByb3BzLmRpcmVjdGlvbiA/PyBGbGV4RGlyZWN0aW9uLlJvdyxcbiAgICAgIGp1c3RpZnk6IHByb3BzLmp1c3RpZnkgPz8gRmxleEp1c3RpZnkuU3RhcnQsXG4gICAgICBhbGlnbjogcHJvcHMuYWxpZ24gPz8gRmxleEFsaWduLlN0YXJ0LFxuICAgICAgZ2FwOiBwcm9wcy5nYXAgPz8gMCxcbiAgICAgIHdyYXA6IHByb3BzLndyYXAgPz8gZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgLyoqIEFkZCBjaGlsZCBjb21wb25lbnQuICovXG4gIGFkZENoaWxkKGNoaWxkOiBVSUNvbXBvbmVudCk6IHZvaWQge1xuICAgIGNoaWxkLnBhcmVudCA9IHRoaXM7XG4gICAgdGhpcy5jaGlsZHJlbi5wdXNoKGNoaWxkKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZChjaGlsZC5jb250YWluZXIpO1xuICAgIHRoaXMubWFya0xheW91dERpcnR5KCk7XG4gIH1cblxuICAvKiogUmVtb3ZlIGNoaWxkIGNvbXBvbmVudC4gKi9cbiAgcmVtb3ZlQ2hpbGQoY2hpbGQ6IFVJQ29tcG9uZW50KTogdm9pZCB7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmNoaWxkcmVuLmluZGV4T2YoY2hpbGQpO1xuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIHRoaXMuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIHRoaXMuY29udGFpbmVyLnJlbW92ZUNoaWxkKGNoaWxkLmNvbnRhaW5lcik7XG4gICAgICBjaGlsZC5wYXJlbnQgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLm1hcmtMYXlvdXREaXJ0eSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdpZHRoOiBwYWRkaW5nLmhvcml6b250YWwsXG4gICAgICAgIGhlaWdodDogcGFkZGluZy52ZXJ0aWNhbFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBNZWFzdXJlIGFsbCBjaGlsZHJlblxuICAgIGNvbnN0IGNoaWxkU2l6ZXMgPSB0aGlzLmNoaWxkcmVuLm1hcChjaGlsZCA9PiBjaGlsZC5tZWFzdXJlKCkpO1xuICAgIGNvbnN0IHsgZGlyZWN0aW9uLCBnYXAgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcblxuICAgIGNvbnN0IGlzUm93ID0gZGlyZWN0aW9uID09PSBGbGV4RGlyZWN0aW9uLlJvdyB8fCBkaXJlY3Rpb24gPT09IEZsZXhEaXJlY3Rpb24uUm93UmV2ZXJzZTtcbiAgICBjb25zdCB0b3RhbEdhcCA9IGdhcCAqICh0aGlzLmNoaWxkcmVuLmxlbmd0aCAtIDEpO1xuXG4gICAgbGV0IG1lYXN1cmVkV2lkdGggPSAwO1xuICAgIGxldCBtZWFzdXJlZEhlaWdodCA9IDA7XG5cbiAgICBpZiAoaXNSb3cpIHtcbiAgICAgIC8vIFJvdzogc3VtIHdpZHRocywgbWF4IGhlaWdodFxuICAgICAgbWVhc3VyZWRXaWR0aCA9IGNoaWxkU2l6ZXMucmVkdWNlKChzdW0sIHNpemUpID0+IHN1bSArIHNpemUud2lkdGgsIDApICsgdG90YWxHYXA7XG4gICAgICBtZWFzdXJlZEhlaWdodCA9IE1hdGgubWF4KC4uLmNoaWxkU2l6ZXMubWFwKHNpemUgPT4gc2l6ZS5oZWlnaHQpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ29sdW1uOiBtYXggd2lkdGgsIHN1bSBoZWlnaHRzXG4gICAgICBtZWFzdXJlZFdpZHRoID0gTWF0aC5tYXgoLi4uY2hpbGRTaXplcy5tYXAoc2l6ZSA9PiBzaXplLndpZHRoKSk7XG4gICAgICBtZWFzdXJlZEhlaWdodCA9IGNoaWxkU2l6ZXMucmVkdWNlKChzdW0sIHNpemUpID0+IHN1bSArIHNpemUuaGVpZ2h0LCAwKSArIHRvdGFsR2FwO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogbWVhc3VyZWRXaWR0aCArIHBhZGRpbmcuaG9yaXpvbnRhbCxcbiAgICAgIGhlaWdodDogbWVhc3VyZWRIZWlnaHQgKyBwYWRkaW5nLnZlcnRpY2FsXG4gICAgfTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICBjb25zdCB7IGRpcmVjdGlvbiwganVzdGlmeSwgYWxpZ24sIGdhcCB9ID0gdGhpcy5wcm9wcztcblxuICAgIC8vIERldGVybWluZSBjb250YWluZXIgc2l6ZVxuICAgIGxldCBjb250YWluZXJXaWR0aDogbnVtYmVyO1xuICAgIGxldCBjb250YWluZXJIZWlnaHQ6IG51bWJlcjtcblxuICAgIGlmICh0aGlzLmJveE1vZGVsLndpZHRoID09PSAnZmlsbCcpIHtcbiAgICAgIGNvbnRhaW5lcldpZHRoID0gYXZhaWxhYmxlV2lkdGg7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnRhaW5lcldpZHRoID0gdGhpcy5ib3hNb2RlbC53aWR0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcbiAgICAgIGNvbnRhaW5lcldpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYm94TW9kZWwuaGVpZ2h0ID09PSAnZmlsbCcpIHtcbiAgICAgIGNvbnRhaW5lckhlaWdodCA9IGF2YWlsYWJsZUhlaWdodDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnRhaW5lckhlaWdodCA9IHRoaXMuYm94TW9kZWwuaGVpZ2h0O1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuICAgICAgY29udGFpbmVySGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb21wdXRlZCBsYXlvdXRcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gY29udGFpbmVyV2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBjb250YWluZXJIZWlnaHQ7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50WCA9IHBhZGRpbmcubGVmdDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRZID0gcGFkZGluZy50b3A7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50V2lkdGggPSBjb250YWluZXJXaWR0aCAtIHBhZGRpbmcuaG9yaXpvbnRhbDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRIZWlnaHQgPSBjb250YWluZXJIZWlnaHQgLSBwYWRkaW5nLnZlcnRpY2FsO1xuXG4gICAgLy8gTGF5b3V0IGNoaWxkcmVuXG4gICAgaWYgKHRoaXMuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5sYXlvdXRDaGlsZHJlbigpO1xuICAgIH1cblxuICAgIHRoaXMubGF5b3V0RGlydHkgPSBmYWxzZTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIGxheW91dENoaWxkcmVuKCk6IHZvaWQge1xuICAgIGNvbnN0IHsgZGlyZWN0aW9uLCBqdXN0aWZ5LCBhbGlnbiwgZ2FwIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG4gICAgY29uc3QgY29udGVudFdpZHRoID0gdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50V2lkdGg7XG4gICAgY29uc3QgY29udGVudEhlaWdodCA9IHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudEhlaWdodDtcblxuICAgIGNvbnN0IGlzUm93ID0gZGlyZWN0aW9uID09PSBGbGV4RGlyZWN0aW9uLlJvdyB8fCBkaXJlY3Rpb24gPT09IEZsZXhEaXJlY3Rpb24uUm93UmV2ZXJzZTtcblxuICAgIC8vIE1lYXN1cmUgY2hpbGRyZW5cbiAgICBjb25zdCBjaGlsZFNpemVzID0gdGhpcy5jaGlsZHJlbi5tYXAoY2hpbGQgPT4gY2hpbGQubWVhc3VyZSgpKTtcblxuICAgIC8vIENhbGN1bGF0ZSB0b3RhbCBtYWluIGF4aXMgc2l6ZVxuICAgIGNvbnN0IHRvdGFsR2FwID0gZ2FwICogKHRoaXMuY2hpbGRyZW4ubGVuZ3RoIC0gMSk7XG4gICAgY29uc3QgdG90YWxDaGlsZFNpemUgPSBpc1Jvd1xuICAgICAgPyBjaGlsZFNpemVzLnJlZHVjZSgoc3VtLCBzaXplKSA9PiBzdW0gKyBzaXplLndpZHRoLCAwKVxuICAgICAgOiBjaGlsZFNpemVzLnJlZHVjZSgoc3VtLCBzaXplKSA9PiBzdW0gKyBzaXplLmhlaWdodCwgMCk7XG5cbiAgICBjb25zdCBtYWluQXhpc1NpemUgPSBpc1JvdyA/IGNvbnRlbnRXaWR0aCA6IGNvbnRlbnRIZWlnaHQ7XG4gICAgY29uc3QgY3Jvc3NBeGlzU2l6ZSA9IGlzUm93ID8gY29udGVudEhlaWdodCA6IGNvbnRlbnRXaWR0aDtcbiAgICBjb25zdCBmcmVlU3BhY2UgPSBtYWluQXhpc1NpemUgLSB0b3RhbENoaWxkU2l6ZSAtIHRvdGFsR2FwO1xuXG4gICAgLy8gQ2FsY3VsYXRlIHN0YXJ0aW5nIHBvc2l0aW9uIGJhc2VkIG9uIGp1c3RpZnlcbiAgICBsZXQgbWFpbkF4aXNPZmZzZXQgPSAwO1xuICAgIGxldCBzcGFjZUJldHdlZW4gPSAwO1xuXG4gICAgc3dpdGNoIChqdXN0aWZ5KSB7XG4gICAgICBjYXNlIEZsZXhKdXN0aWZ5LlN0YXJ0OlxuICAgICAgICBtYWluQXhpc09mZnNldCA9IDA7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBGbGV4SnVzdGlmeS5FbmQ6XG4gICAgICAgIG1haW5BeGlzT2Zmc2V0ID0gZnJlZVNwYWNlO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgRmxleEp1c3RpZnkuQ2VudGVyOlxuICAgICAgICBtYWluQXhpc09mZnNldCA9IGZyZWVTcGFjZSAvIDI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBGbGV4SnVzdGlmeS5TcGFjZUJldHdlZW46XG4gICAgICAgIHNwYWNlQmV0d2VlbiA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoID4gMSA/IGZyZWVTcGFjZSAvICh0aGlzLmNoaWxkcmVuLmxlbmd0aCAtIDEpIDogMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEZsZXhKdXN0aWZ5LlNwYWNlQXJvdW5kOlxuICAgICAgICBzcGFjZUJldHdlZW4gPSBmcmVlU3BhY2UgLyB0aGlzLmNoaWxkcmVuLmxlbmd0aDtcbiAgICAgICAgbWFpbkF4aXNPZmZzZXQgPSBzcGFjZUJldHdlZW4gLyAyO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgRmxleEp1c3RpZnkuU3BhY2VFdmVubHk6XG4gICAgICAgIHNwYWNlQmV0d2VlbiA9IGZyZWVTcGFjZSAvICh0aGlzLmNoaWxkcmVuLmxlbmd0aCArIDEpO1xuICAgICAgICBtYWluQXhpc09mZnNldCA9IHNwYWNlQmV0d2VlbjtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgLy8gUG9zaXRpb24gY2hpbGRyZW5cbiAgICBsZXQgY3VycmVudFBvc2l0aW9uID0gbWFpbkF4aXNPZmZzZXQ7XG5cbiAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgY2hpbGRTaXplID0gY2hpbGRTaXplc1tpbmRleF07XG5cbiAgICAgIC8vIExheW91dCBjaGlsZFxuICAgICAgY2hpbGQubGF5b3V0KGNoaWxkU2l6ZS53aWR0aCwgY2hpbGRTaXplLmhlaWdodCk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBjcm9zcyBheGlzIHBvc2l0aW9uIGJhc2VkIG9uIGFsaWduXG4gICAgICBsZXQgY3Jvc3NBeGlzUG9zaXRpb24gPSAwO1xuXG4gICAgICBzd2l0Y2ggKGFsaWduKSB7XG4gICAgICAgIGNhc2UgRmxleEFsaWduLlN0YXJ0OlxuICAgICAgICAgIGNyb3NzQXhpc1Bvc2l0aW9uID0gMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGbGV4QWxpZ24uRW5kOlxuICAgICAgICAgIGNyb3NzQXhpc1Bvc2l0aW9uID0gY3Jvc3NBeGlzU2l6ZSAtIChpc1JvdyA/IGNoaWxkU2l6ZS5oZWlnaHQgOiBjaGlsZFNpemUud2lkdGgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEZsZXhBbGlnbi5DZW50ZXI6XG4gICAgICAgICAgY3Jvc3NBeGlzUG9zaXRpb24gPSAoY3Jvc3NBeGlzU2l6ZSAtIChpc1JvdyA/IGNoaWxkU2l6ZS5oZWlnaHQgOiBjaGlsZFNpemUud2lkdGgpKSAvIDI7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgRmxleEFsaWduLlN0cmV0Y2g6XG4gICAgICAgICAgLy8gU3RyZXRjaCBjaGlsZCB0byBmaWxsIGNyb3NzIGF4aXMgKGltcGxlbWVudCBsYXRlcilcbiAgICAgICAgICBjcm9zc0F4aXNQb3NpdGlvbiA9IDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIC8vIFNldCBjaGlsZCBwb3NpdGlvblxuICAgICAgaWYgKGlzUm93KSB7XG4gICAgICAgIGNoaWxkLnNldFBvc2l0aW9uKFxuICAgICAgICAgIHBhZGRpbmcubGVmdCArIGN1cnJlbnRQb3NpdGlvbixcbiAgICAgICAgICBwYWRkaW5nLnRvcCArIGNyb3NzQXhpc1Bvc2l0aW9uXG4gICAgICAgICk7XG4gICAgICAgIGN1cnJlbnRQb3NpdGlvbiArPSBjaGlsZFNpemUud2lkdGggKyBnYXAgKyBzcGFjZUJldHdlZW47XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjaGlsZC5zZXRQb3NpdGlvbihcbiAgICAgICAgICBwYWRkaW5nLmxlZnQgKyBjcm9zc0F4aXNQb3NpdGlvbixcbiAgICAgICAgICBwYWRkaW5nLnRvcCArIGN1cnJlbnRQb3NpdGlvblxuICAgICAgICApO1xuICAgICAgICBjdXJyZW50UG9zaXRpb24gKz0gY2hpbGRTaXplLmhlaWdodCArIGdhcCArIHNwYWNlQmV0d2VlbjtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICAvLyBGbGV4Q29udGFpbmVyIGl0c2VsZiBoYXMgbm8gdmlzdWFsIHJlcHJlc2VudGF0aW9uXG4gICAgLy8gQ291bGQgYWRkIGRlYnVnIGJvcmRlcnMgaGVyZSBpZiBuZWVkZWRcbiAgfVxufVxuIiwiLyoqXG4gKiBQaXhlbC1wZXJmZWN0IGdyaWQgc3lzdGVtIGZvciBjb25zaXN0ZW50IFVJIG1lYXN1cmVtZW50cy5cbiAqIEFsbCBtZWFzdXJlbWVudHMgYXJlIGluIGdyaWQgdW5pdHMgdGhhdCBzY2FsZSB0byBhY3R1YWwgcGl4ZWxzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogLy8gVXNlIGdsb2JhbCBoZWxwZXJzIChkZWZhdWx0IDR4IHNjYWxlKVxuICogY29uc3Qgd2lkdGggPSBweCgxMCk7ICAgICAgLy8gMTAgdW5pdHMgPSA0MHB4XG4gKiBjb25zdCBncmlkVW5pdHMgPSB1bml0cyg0MCk7IC8vIDQwcHggPSAxMCB1bml0c1xuICpcbiAqIC8vIEFjY2VzcyBncmlkIGNvbnN0YW50c1xuICogY29uc3QgcGFkZGluZyA9IHB4KEdSSUQucGFkZGluZyk7ICAvLyBEZWZhdWx0IHBhZGRpbmcgaW4gcGl4ZWxzXG4gKiBjb25zdCBnYXAgPSBweChHUklELmdhcCk7ICAgICAgICAgIC8vIERlZmF1bHQgZ2FwIGluIHBpeGVsc1xuICpcbiAqIC8vIENyZWF0ZSBjdXN0b20gZ3JpZCB3aXRoIGRpZmZlcmVudCBzY2FsZVxuICogY29uc3QgZ3JpZDJ4ID0gbmV3IFBpeGVsR3JpZCh7IHNjYWxlOiAyIH0pO1xuICogY29uc3Qgd2lkdGgyeCA9IGdyaWQyeC5weCgxMCk7ICAvLyAxMCB1bml0cyA9IDIwcHggYXQgMnhcbiAqIGBgYFxuICovXG5cbi8qKiBQaXhlbEdyaWQgY29uZmlndXJhdGlvbi4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUGl4ZWxHcmlkQ29uZmlnIHtcbiAgLyoqIEJhc2UgcGl4ZWwgdW5pdCBhdCAxeCBzY2FsZSAoZGVmYXVsdDogMSkgKi9cbiAgdW5pdD86IG51bWJlcjtcbiAgLyoqIFNjYWxlIG11bHRpcGxpZXIgZm9yIGFsbCBtZWFzdXJlbWVudHMgKGRlZmF1bHQ6IDQpICovXG4gIHNjYWxlPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHdpZHRoIGluIGdyaWQgdW5pdHMgKGRlZmF1bHQ6IDEpICovXG4gIGJvcmRlcj86IG51bWJlcjtcbiAgLyoqIFN0YW5kYXJkIHBhZGRpbmcgaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogMSkgKi9cbiAgcGFkZGluZz86IG51bWJlcjtcbiAgLyoqIEdhcCBiZXR3ZWVuIGVsZW1lbnRzIGluIGdyaWQgdW5pdHMgKGRlZmF1bHQ6IDEpICovXG4gIGdhcD86IG51bWJlcjtcbiAgLyoqIE1hcmdpbi9zcGFjaW5nIGluIGdyaWQgdW5pdHMgKGRlZmF1bHQ6IDUsIGUuZy4sIDUgKiA0ID0gMjBweCkgKi9cbiAgbWFyZ2luPzogbnVtYmVyO1xuICAvKiogRm9udCBzY2FsZSBtdWx0aXBsaWVyIChkZWZhdWx0OiAwLjI1LCBlLmcuLCA2NHB4ICogMC4yNSA9IDE2cHgpICovXG4gIGZvbnRTY2FsZT86IG51bWJlcjtcbn1cblxuLyoqIE11bHRpLWxheWVyIGJvcmRlciBjb25maWd1cmF0aW9uLiAqL1xuZXhwb3J0IGludGVyZmFjZSBCb3JkZXJDb25maWcge1xuICAvKiogT3V0ZXIgYm9yZGVyIHdpZHRoIGluIGdyaWQgdW5pdHMgKGRlZmF1bHQ6IDEpICovXG4gIG91dGVyPzogbnVtYmVyO1xuICAvKiogTWlkZGxlIGJvcmRlciB3aWR0aCBpbiBncmlkIHVuaXRzIChkZWZhdWx0OiAxKSAqL1xuICBtaWRkbGU/OiBudW1iZXI7XG4gIC8qKiBJbm5lciBib3JkZXIgd2lkdGggaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogMSkgKi9cbiAgaW5uZXI/OiBudW1iZXI7XG4gIC8qKiBUb3RhbCBib3JkZXIgd2lkdGggKGNhbGN1bGF0ZWQgYXV0b21hdGljYWxseSkgKi9cbiAgdG90YWw/OiBudW1iZXI7XG59XG5cbi8qKiBHcmlkIHN5c3RlbSBjb252ZXJ0aW5nIHVuaXRzIHRvIHBpeGVscyBhdCBjb25zaXN0ZW50IHNjYWxlLiAqL1xuZXhwb3J0IGNsYXNzIFBpeGVsR3JpZCB7XG4gIHB1YmxpYyByZWFkb25seSB1bml0OiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSBzY2FsZTogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgYm9yZGVyOiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSBwYWRkaW5nOiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSBnYXA6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IG1hcmdpbjogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgZm9udFNjYWxlOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBQaXhlbEdyaWRDb25maWcgPSB7fSkge1xuICAgIHRoaXMudW5pdCA9IGNvbmZpZy51bml0ID8/IDE7XG4gICAgdGhpcy5zY2FsZSA9IGNvbmZpZy5zY2FsZSA/PyA0O1xuICAgIHRoaXMuYm9yZGVyID0gY29uZmlnLmJvcmRlciA/PyAxO1xuICAgIHRoaXMucGFkZGluZyA9IGNvbmZpZy5wYWRkaW5nID8/IDE7XG4gICAgdGhpcy5nYXAgPSBjb25maWcuZ2FwID8/IDE7XG4gICAgdGhpcy5tYXJnaW4gPSBjb25maWcubWFyZ2luID8/IDU7IC8vIDUgdW5pdHMgKiA0IHNjYWxlID0gMjBweCBkZWZhdWx0XG4gICAgLy8gRm9udCBzY2FsZSBpcyBwcm9wb3J0aW9uYWwgdG8gR1JJRCBzY2FsZSAoMC4yNSBhdCA0eCBzY2FsZSlcbiAgICAvLyBBdCA0eDogNjRweCAqIDAuMjUgPSAxNnB4LCBBdCAzeDogNjRweCAqIDAuMTg3NSA9IDEycHgsIGV0Yy5cbiAgICB0aGlzLmZvbnRTY2FsZSA9IGNvbmZpZy5mb250U2NhbGUgPz8gKHRoaXMuc2NhbGUgLyAxNik7XG4gIH1cblxuICAvKiogQ29udmVydCBncmlkIHVuaXRzIOKGkiBwaXhlbHMuICovXG4gIHB4KHVuaXRzOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiB1bml0cyAqIHRoaXMudW5pdCAqIHRoaXMuc2NhbGU7XG4gIH1cblxuICAvKiogQ29udmVydCBwaXhlbHMg4oaSIGdyaWQgdW5pdHMgKHJvdW5kZWQpLiAqL1xuICB1bml0cyhwaXhlbHM6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGgucm91bmQocGl4ZWxzIC8gKHRoaXMudW5pdCAqIHRoaXMuc2NhbGUpKTtcbiAgfVxufVxuXG4vKiogRGVmYXVsdCBncmlkOiA0eCBzY2FsZSwgMXB4IGJhc2UgdW5pdC4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX1BJWEVMX0dSSUQgPSAoKCkgPT4ge1xuICAvLyBURU1QT1JBUlk6IENoZWNrIGZvciBzY2FsZSBvdmVycmlkZSBpbiBsb2NhbFN0b3JhZ2VcbiAgY29uc3QgdGVtcFNjYWxlID0gdHlwZW9mIGxvY2FsU3RvcmFnZSAhPT0gJ3VuZGVmaW5lZCdcbiAgICA/IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0ZW1wLWdyaWQtc2NhbGUnKVxuICAgIDogbnVsbDtcblxuICBpZiAodGVtcFNjYWxlKSB7XG4gICAgY29uc3Qgc2NhbGUgPSBwYXJzZUludCh0ZW1wU2NhbGUsIDEwKTtcbiAgICBpZiAoIWlzTmFOKHNjYWxlKSAmJiBzY2FsZSA+PSAxICYmIHNjYWxlIDw9IDQpIHtcbiAgICAgIHJldHVybiBuZXcgUGl4ZWxHcmlkKHsgc2NhbGUgfSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ldyBQaXhlbEdyaWQoKTtcbn0pKCk7XG5cbi8qKiBDb252ZXJ0IGdyaWQgdW5pdHMg4oaSIHBpeGVscyAoZGVmYXVsdCBncmlkKS4gKi9cbmV4cG9ydCBjb25zdCBweCA9ICh1bml0czogbnVtYmVyKTogbnVtYmVyID0+IERFRkFVTFRfUElYRUxfR1JJRC5weCh1bml0cyk7XG5cbi8qKiBDb252ZXJ0IHBpeGVscyDihpIgZ3JpZCB1bml0cyAoZGVmYXVsdCBncmlkKS4gKi9cbmV4cG9ydCBjb25zdCB1bml0cyA9IChwaXhlbHM6IG51bWJlcik6IG51bWJlciA9PiBERUZBVUxUX1BJWEVMX0dSSUQudW5pdHMocGl4ZWxzKTtcblxuLyoqIERlZmF1bHQgZ3JpZCBjb25zdGFudHMuICovXG5leHBvcnQgY29uc3QgR1JJRCA9IHtcbiAgdW5pdDogREVGQVVMVF9QSVhFTF9HUklELnVuaXQsXG4gIHNjYWxlOiBERUZBVUxUX1BJWEVMX0dSSUQuc2NhbGUsXG4gIGJvcmRlcjogREVGQVVMVF9QSVhFTF9HUklELmJvcmRlcixcbiAgcGFkZGluZzogREVGQVVMVF9QSVhFTF9HUklELnBhZGRpbmcsXG4gIGdhcDogREVGQVVMVF9QSVhFTF9HUklELmdhcCxcbiAgbWFyZ2luOiBERUZBVUxUX1BJWEVMX0dSSUQubWFyZ2luLFxuICBmb250U2NhbGU6IERFRkFVTFRfUElYRUxfR1JJRC5mb250U2NhbGVcbn0gYXMgY29uc3Q7XG5cbi8qKiBEZWZhdWx0IHRyaXBsZSBib3JkZXIgKG91dGVyL21pZGRsZS9pbm5lcikuICovXG5leHBvcnQgY29uc3QgQk9SREVSID0ge1xuICBvdXRlcjogMSwgICAvLyBPdXRlciBib3JkZXIgKDEgZ3JpZCB1bml0KVxuICBtaWRkbGU6IDEsICAvLyBNaWRkbGUgYm9yZGVyICgxIGdyaWQgdW5pdClcbiAgaW5uZXI6IDEsICAgLy8gSW5uZXIgYm9yZGVyICgxIGdyaWQgdW5pdClcbiAgdG90YWw6IDMgICAgLy8gVG90YWwgYm9yZGVyIHdpZHRoICgzIGdyaWQgdW5pdHMpXG59IGFzIGNvbnN0O1xuXG4vKiogQ3JlYXRlIGN1c3RvbSBib3JkZXIgY29uZmlnIHdpdGggY2FsY3VsYXRlZCB0b3RhbC4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVCb3JkZXJDb25maWcoY29uZmlnOiBCb3JkZXJDb25maWcgPSB7fSk6IFJlcXVpcmVkPEJvcmRlckNvbmZpZz4ge1xuICBjb25zdCBvdXRlciA9IGNvbmZpZy5vdXRlciA/PyAxO1xuICBjb25zdCBtaWRkbGUgPSBjb25maWcubWlkZGxlID8/IDE7XG4gIGNvbnN0IGlubmVyID0gY29uZmlnLmlubmVyID8/IDE7XG4gIGNvbnN0IHRvdGFsID0gb3V0ZXIgKyBtaWRkbGUgKyBpbm5lcjtcblxuICByZXR1cm4ge1xuICAgIG91dGVyLFxuICAgIG1pZGRsZSxcbiAgICBpbm5lcixcbiAgICB0b3RhbFxuICB9O1xufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX3BpeGlfanNfXzsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFwiLi9zcmMvaW5kZXgudHNcIik7XG4iLCIiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=