{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://pikcell/../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js","webpack://pikcell/webpack/bootstrap","webpack://pikcell/webpack/runtime/compat get default export","webpack://pikcell/webpack/runtime/define property getters","webpack://pikcell/webpack/runtime/hasOwnProperty shorthand","webpack://pikcell/webpack/runtime/make namespace object","webpack://pikcell/external window \"PIXI\"","webpack://pikcell/../moxi/src/library/utils.ts","webpack://pikcell/../moxi/src/core/render-manager.ts","webpack://pikcell/../moxi/src/core/scene.ts","webpack://pikcell/../moxi/src/core/engine.ts","webpack://pikcell/../moxi/src/core/event-system.ts","webpack://pikcell/../moxi/src/library/client-events.ts","webpack://pikcell/../moxi/src/core/asset-loader.ts","webpack://pikcell/../moxi/src/core/logic.ts","webpack://pikcell/../moxi/src/core/moxi-entity.ts","webpack://pikcell/../moxi/src/core/camera.ts","webpack://pikcell/../../node_modules/planck/dist/planck.mjs","webpack://pikcell/../moxi/src/library/physics/physics-collision.ts","webpack://pikcell/../moxi/src/library/physics/physics-debug-renderer.ts","webpack://pikcell/../moxi/src/library/physics/physics-graphics-parser.ts","webpack://pikcell/../moxi/src/library/physics/physics-world.ts","webpack://pikcell/../moxi/src/library/loading-scene.ts","webpack://pikcell/../moxi/src/library/setup.ts","webpack://pikcell/../moxi/src/ui/core/ui-focus-manager.ts","webpack://pikcell/../moxi/src/ui/layout/flex-container.ts","webpack://pikcell/../moxi/src/ui/components/ui-button.ts","webpack://pikcell/../moxi/src/ui/UIScaleMode.ts","webpack://pikcell/../moxi/src/ui/UILayer.ts","webpack://pikcell/../moxi/src/library/state-machine.ts","webpack://pikcell/../moxi/src/ui/pixel-grid.ts","webpack://pikcell/../moxi/src/library/parallax-layer.ts","webpack://pikcell/../moxi/src/library/parallax-background.ts","webpack://pikcell/../moxi/src/index.ts","webpack://pikcell/./src/theming/theme.ts","webpack://pikcell/./src/components/pixel-card.ts","webpack://pikcell/./src/components/pixel-button.ts","webpack://pikcell/./src/components/pixel-dialog.ts","webpack://pikcell/./src/components/pixel-checkbox.ts","webpack://pikcell/./src/controllers/sprite-sheet-controller.ts","webpack://pikcell/./src/components/spritesheet-card.ts","webpack://pikcell/./src/controllers/sprite-controller.ts","webpack://pikcell/./src/state/ui-state-manager.ts","webpack://pikcell/./src/state/project-state-manager.ts","webpack://pikcell/./src/state/layout-state-manager.ts","webpack://pikcell/./src/theming/palettes.ts","webpack://pikcell/./src/utilities/card-zoom-handler.ts","webpack://pikcell/./src/config/constants.ts","webpack://pikcell/./src/managers/sprite-sheet-manager.ts","webpack://pikcell/./src/managers/ui-manager.ts","webpack://pikcell/./src/managers/layout-manager.ts","webpack://pikcell/./src/managers/file-operations-manager.ts","webpack://pikcell/./src/sprite-editor.ts","webpack://pikcell/./src/components/sprite-card.ts","webpack://pikcell/./src/utilities/texture-utils.ts","webpack://pikcell/./src/cards/commander-bar-card.ts","webpack://pikcell/./src/cards/palette-card.ts","webpack://pikcell/./src/cards/info-bar-card.ts","webpack://pikcell/./src/theming/tool-icons.ts","webpack://pikcell/./src/index.ts"],"sourcesContent":["/* Font Face Observer v2.3.0 -  Bram Stein. License: BSD-3-Clause */(function(){function p(a,c){document.addEventListener?a.addEventListener(\"scroll\",c,!1):a.attachEvent(\"scroll\",c)}function u(a){document.body?a():document.addEventListener?document.addEventListener(\"DOMContentLoaded\",function b(){document.removeEventListener(\"DOMContentLoaded\",b);a()}):document.attachEvent(\"onreadystatechange\",function g(){if(\"interactive\"==document.readyState||\"complete\"==document.readyState)document.detachEvent(\"onreadystatechange\",g),a()})};function w(a){this.g=document.createElement(\"div\");this.g.setAttribute(\"aria-hidden\",\"true\");this.g.appendChild(document.createTextNode(a));this.h=document.createElement(\"span\");this.i=document.createElement(\"span\");this.m=document.createElement(\"span\");this.j=document.createElement(\"span\");this.l=-1;this.h.style.cssText=\"max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;\";this.i.style.cssText=\"max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;\";\nthis.j.style.cssText=\"max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;\";this.m.style.cssText=\"display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;\";this.h.appendChild(this.m);this.i.appendChild(this.j);this.g.appendChild(this.h);this.g.appendChild(this.i)}\nfunction x(a,c){a.g.style.cssText=\"max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:\"+c+\";\"}function B(a){var c=a.g.offsetWidth,b=c+100;a.j.style.width=b+\"px\";a.i.scrollLeft=b;a.h.scrollLeft=a.h.scrollWidth+100;return a.l!==c?(a.l=c,!0):!1}function C(a,c){function b(){var e=g;B(e)&&null!==e.g.parentNode&&c(e.l)}var g=a;p(a.h,b);p(a.i,b);B(a)};function D(a,c,b){c=c||{};b=b||window;this.family=a;this.style=c.style||\"normal\";this.weight=c.weight||\"normal\";this.stretch=c.stretch||\"normal\";this.context=b}var E=null,F=null,G=null,H=null;function I(a){null===F&&(M(a)&&/Apple/.test(window.navigator.vendor)?(a=/AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))(?:\\.([0-9]+))/.exec(window.navigator.userAgent),F=!!a&&603>parseInt(a[1],10)):F=!1);return F}function M(a){null===H&&(H=!!a.document.fonts);return H}\nfunction N(a,c){var b=a.style,g=a.weight;if(null===G){var e=document.createElement(\"div\");try{e.style.font=\"condensed 100px sans-serif\"}catch(q){}G=\"\"!==e.style.font}return[b,g,G?a.stretch:\"\",\"100px\",c].join(\" \")}\nD.prototype.load=function(a,c){var b=this,g=a||\"BESbswy\",e=0,q=c||3E3,J=(new Date).getTime();return new Promise(function(K,L){if(M(b.context)&&!I(b.context)){var O=new Promise(function(r,t){function h(){(new Date).getTime()-J>=q?t(Error(\"\"+q+\"ms timeout exceeded\")):b.context.document.fonts.load(N(b,'\"'+b.family+'\"'),g).then(function(n){1<=n.length?r():setTimeout(h,25)},t)}h()}),P=new Promise(function(r,t){e=setTimeout(function(){t(Error(\"\"+q+\"ms timeout exceeded\"))},q)});Promise.race([P,O]).then(function(){clearTimeout(e);\nK(b)},L)}else u(function(){function r(){var d;if(d=-1!=k&&-1!=l||-1!=k&&-1!=m||-1!=l&&-1!=m)(d=k!=l&&k!=m&&l!=m)||(null===E&&(d=/AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))/.exec(window.navigator.userAgent),E=!!d&&(536>parseInt(d[1],10)||536===parseInt(d[1],10)&&11>=parseInt(d[2],10))),d=E&&(k==y&&l==y&&m==y||k==z&&l==z&&m==z||k==A&&l==A&&m==A)),d=!d;d&&(null!==f.parentNode&&f.parentNode.removeChild(f),clearTimeout(e),K(b))}function t(){if((new Date).getTime()-J>=q)null!==f.parentNode&&f.parentNode.removeChild(f),\nL(Error(\"\"+q+\"ms timeout exceeded\"));else{var d=b.context.document.hidden;if(!0===d||void 0===d)k=h.g.offsetWidth,l=n.g.offsetWidth,m=v.g.offsetWidth,r();e=setTimeout(t,50)}}var h=new w(g),n=new w(g),v=new w(g),k=-1,l=-1,m=-1,y=-1,z=-1,A=-1,f=document.createElement(\"div\");f.dir=\"ltr\";x(h,N(b,\"sans-serif\"));x(n,N(b,\"serif\"));x(v,N(b,\"monospace\"));f.appendChild(h.g);f.appendChild(n.g);f.appendChild(v.g);b.context.document.body.appendChild(f);y=h.g.offsetWidth;z=n.g.offsetWidth;A=v.g.offsetWidth;t();\nC(h,function(d){k=d;r()});x(h,N(b,'\"'+b.family+'\",sans-serif'));C(n,function(d){l=d;r()});x(n,N(b,'\"'+b.family+'\",serif'));C(v,function(d){m=d;r()});x(v,N(b,'\"'+b.family+'\",monospace'))})})};\"object\"===typeof module?module.exports=D:(window.FontFaceObserver=D,window.FontFaceObserver.prototype.load=D.prototype.load);}());\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"PIXI\"];","import { Point } from 'pixi.js';\n\n/**\n * Commonly used Point factory functions\n * These reduce object allocations and clarify intent\n */\nexport const createPoint = (x = 0, y = 0): Point => new Point(x, y);\nexport const ZERO_POINT = (): Point => new Point(0, 0);\nexport const ONE_POINT = (): Point => new Point(1, 1);\n\nexport const uc = (s = '') => s.toUpperCase();\nexport const lc = (s = '') => s.toLowerCase();\n\nexport const padRight = (val = '', length = 0, padWith = ' ') => {\n  let result = val+'';\n  while(result.length < length){\n    result += padWith;\n  }\n  return result;\n};\n\nexport const pr = padRight;\n\n/**\n * Generate random integer between min and max (inclusive)\n * @param min - Minimum value (inclusive)\n * @param max - Maximum value (inclusive)\n * @returns Random integer in range [min, max]\n */\nexport const getRandomInt = (min: number, max: number): number => (Math.floor(Math.random() * (max + 1 - min)) + min);\n\nexport const roundTo = (places, value) => (Math.round(value * Math.pow(10, places)) / Math.pow(10, places));\n\nexport const lerp = (begin, end, mag) => ((1 - mag) * begin + mag * end);\n\nexport function metersToPixels(m: number): number { return m * 20; }\n\nexport function pixelsToMeters(p: number): number { return p * 0.05; }\n\nexport const fetchXml = async (url: string) => (await (await fetch(url)).text());\n\nexport const rad2deg = (rad: number) => rad * (180 / Math.PI);\nexport const deg2rad = (deg: number) => deg * (Math.PI / 180);\n  ","import PIXI from 'pixi.js';\n\nexport class RenderManager {\n  static getRenderer: (\n    options: Partial<PIXI.AutoDetectOptions>\n  ) => Promise<PIXI.Renderer>;\n\n  static create: (\n      htmlRoot: HTMLElement, \n      options: Partial<PIXI.AutoDetectOptions>) => Promise<RenderManager>;\n\n  htmlRoot: HTMLElement;\n  renderer: PIXI.Renderer;\n  fitToWindow = false;\n\n  constructor(htmlRoot: HTMLElement, renderer: PIXI.Renderer) {\n    this.htmlRoot = htmlRoot;\n    this.renderer = renderer;\n\n    htmlRoot.appendChild(this.renderer.canvas);\n    window.addEventListener('resize', () => this.onResize());\n    this.onResize();\n  }\n\n  render(stage: PIXI.Container) {\n    this.renderer.render(stage);\n  }\n\n  onResize = () => {\n    const { renderer, htmlRoot: root } = this;\n    const canvas = renderer.canvas;\n    \n    // Get the parent dimensions\n    const parentWidth = root.clientWidth;\n    const parentHeight = root.clientHeight;\n    \n    // Get the canvas's intended dimensions\n    const canvasWidth = renderer.width;\n    const canvasHeight = renderer.height;\n    \n    // Calculate the scale to fit while maintaining aspect ratio\n    const scale = Math.min(\n      parentWidth / canvasWidth,\n      parentHeight / canvasHeight\n    );\n    \n    // Set CSS dimensions to scale the canvas\n    canvas.style.width = `${Math.floor(canvasWidth * scale)}px`;\n    canvas.style.height = `${Math.floor(canvasHeight * scale)}px`;\n  };\n}\n\nRenderManager.getRenderer = async (options: Partial<PIXI.AutoDetectOptions>) => (\n  await PIXI.autoDetectRenderer(options)\n);\n\nRenderManager.create = async (htmlRoot: HTMLElement, options: Partial<PIXI.AutoDetectOptions>) => (\n  new RenderManager(htmlRoot, await RenderManager.getRenderer(options))\n);\n","import PIXI from 'pixi.js';\nimport { AsEntity } from './moxi-entity';\n\nfunction isMoxiEntity<T extends PIXI.Container>(entity: unknown): entity is AsEntity<T> {\n  return entity != null && typeof entity === 'object' && 'moxiEntity' in entity;\n}\n\nexport class Scene extends PIXI.Container {\n  renderer: PIXI.Renderer<HTMLCanvasElement>;\n\n  constructor(renderer: PIXI.Renderer<HTMLCanvasElement>) {\n    super();\n    this.renderer = renderer;\n  }\n\n  init() {\n    this.children.forEach((child) => {\n      if (isMoxiEntity(child)) {\n        child.moxiEntity.init(this.renderer);\n      }\n    });\n  }\n\n\n  update(deltaTime: number) {\n    this.children.forEach((child) => {\n      if (isMoxiEntity(child)) {\n        child.moxiEntity.update(deltaTime);\n      }\n    });\n  }\n\n  draw(deltaTime: number) {\n    this.renderer.render(this);\n  }\n}","import PIXI from 'pixi.js';\nimport { Scene } from './scene';\nimport type { PhysicsWorld } from '../library/physics';\n\n/**\n * The core game engine class that manages the game loop, scene rendering,\n * and update cycles. Coordinates with the PIXI.Ticker to drive the animation.\n *\n * @category Core\n * @example\n * ```typescript\n * // Create a new engine with a scene\n * const engine = new Engine(scene);\n *\n * // Start the game loop\n * engine.start();\n *\n * // Stop the game loop when needed\n * engine.stop();\n * ```\n */\nexport class Engine {\n  /**\n   * The PIXI Ticker instance that drives the game loop\n   */\n  ticker: PIXI.Ticker;\n\n  /**\n   * The current active scene/stage\n   */\n  root: Scene;\n\n  /**\n   * Optional physics world instance\n   */\n  physicsWorld?: PhysicsWorld;\n\n  /**\n   * Optional logging function for debugging\n   */\n  logger: (msg: string) => void;\n\n  /**\n   * How often to log messages (in milliseconds)\n   */\n  loggerFrequencyMs: number;\n\n  /**\n   * Timestamp for the next log message\n   * @internal\n   */\n  nextLogTime: number;\n\n  /**\n   * Creates a new Engine instance\n   * \n   * @param stage - The initial scene to use, if any\n   */\n  constructor(stage: Scene = null) {\n    this.root = stage;\n\n    const ticker = PIXI.Ticker.shared;\n    ticker.autoStart = false;\n    ticker.add(this.gameLoop);\n    this.ticker = ticker;\n\n    this.loggerFrequencyMs = 500;\n    this.nextLogTime = 0;\n    this.logger = (msg) => null;\n  }\n\n  /**\n   * Starts the game loop\n   * \n   * @returns The Engine instance for chaining\n   */\n  start() {\n    this.ticker.start();\n    return this;\n  }\n\n  /**\n   * Stops the game loop\n   * \n   * @returns The Engine instance for chaining\n   */\n  stop() {\n    this.ticker.stop();\n    return this;\n  }\n\n  /**\n   * Add physics world to engine\n   *\n   * @param physicsWorld - The physics world instance\n   * @returns The Engine instance for chaining\n   */\n  addPhysicsWorld(physicsWorld: PhysicsWorld) {\n    this.physicsWorld = physicsWorld;\n    return this;\n  }\n\n  /**\n   * The main game loop function called by the ticker on each frame\n   * Updates and renders the active scene\n   *\n   * @param tikerTime - Ticker information including delta time\n   * @private\n   */\n  gameLoop = (tikerTime: PIXI.Ticker) => {\n    if (this.root) {\n      const { deltaTime, deltaMS } = tikerTime;\n\n      // 1. Update physics simulation FIRST (needs deltaTime in seconds)\n      if (this.physicsWorld) {\n        const deltaSeconds = deltaMS / 1000;\n        this.physicsWorld.step(deltaSeconds);\n      }\n\n      // 2. Then update all logic components (they use frame-based deltaTime)\n      this.root.update(deltaTime);\n      this.root.draw(deltaTime);\n    }\n  };\n\n  /**\n   * Sets a new active scene\n   * \n   * @param stage - The new scene to use\n   * @returns The Engine instance for chaining\n   */\n  loadStage(stage: Scene) {\n    this.root = stage;\n    return this;\n  }\n}\n","type MoxiEvents<T extends string | symbol = string, A = any> = {\n  [event in T]: (...args: A extends any[] ? A : [A]) => void;\n};\n\nexport class EventEmitter<T extends MoxiEvents = MoxiEvents> {\n  private listeners: { [K in keyof T]?: T[K][] } = {};\n\n  /**\n   * Singleton instance of EventEmitter (lazy initialized)\n   * @static\n   */\n  private static instance: EventEmitter<MoxiEvents> | null = null;\n\n  on<K extends keyof T>(event: K, listener: T[K]): void {\n    (this.listeners[event] || (this.listeners[event] = [])).push(listener);\n  }\n\n  off<K extends keyof T>(event: K, listener: T[K]): void {\n    const eventListeners = this.listeners[event];\n    if (eventListeners) {\n      this.listeners[event] = eventListeners.filter(l => l !== listener);\n    }\n  }\n\n  emit<K extends keyof T>(event: K, ...args: Parameters<T[K]>): void {\n    (this.listeners[event] || []).forEach(listener => listener(...args));\n  }\n\n  once<K extends keyof T>(event: K, listener: T[K]): void {\n    const onceListener = (...args: Parameters<T[K]>) => {\n      listener(...args);\n      this.off(event, listener);\n    };\n    this.on(event, onceListener as T[K]);\n  }\n\n  /**\n   * Get the singleton instance of EventEmitter\n   * @static\n   */\n  public static getInstance<T extends MoxiEvents = MoxiEvents>(): EventEmitter<T> {\n    if (!EventEmitter.instance) {\n      EventEmitter.instance = new EventEmitter<MoxiEvents>();\n    }\n    return EventEmitter.instance as EventEmitter<T>;\n  }\n}\n\n","import { Point } from 'pixi.js';\nimport { OnEvent, ClientEventsArgs } from '..';\n\n/**\n * Manages input events from the client (keyboard, mouse, etc.) and provides an interface\n * for querying the current input state.\n * \n * Implements the Singleton pattern to ensure only one instance of event handlers exists.\n * \n * @category Core\n * @example\n * ```typescript\n * // Create/get the ClientEvents instance\n * const events = new ClientEvents();\n * \n * // Check if a key is currently pressed\n * if (events.isKeyDown('ArrowRight')) {\n *   player.moveRight();\n * }\n * \n * // Access mouse position\n * const mousePos = events.movePosition;\n * ```\n */\nexport class ClientEvents {\n  /**\n   * Current wheel scroll delta values\n   */\n  wheelDelta: { yValue: number; xValue: number; };\n  \n  /**\n   * The most recent mouse up event\n   */\n  mouseUpEvent: MouseEvent;\n  \n  /**\n   * The most recent mouse down event\n   */\n  mouseDownEvent: MouseEvent;\n  \n  /**\n   * The last mouse down event that occurred\n   */\n  lastMouseDown: MouseEvent;\n  \n  /**\n   * The last mouse up event that occurred\n   */\n  lastMouseUp: MouseEvent;\n  \n  /**\n   * The most recent key down event\n   */\n  keyDownEvent: KeyboardEvent;\n  \n  /**\n   * The most recent key up event\n   */\n  keyUpEvent: KeyboardEvent;\n  \n  /**\n   * Map of currently pressed keys\n   * @internal\n   */\n  keydown: Record<string, KeyboardEvent>;\n  \n  /**\n   * Accumulated wheel offset values\n   */\n  wheelOffsets: Point;\n  \n  /**\n   * Current mouse position\n   */\n  movePosition: Point;\n  \n  /**\n   * Previous mouse position\n   */\n  lastMovePosition: Point;\n  \n  /**\n   * Change in mouse position since last update\n   */\n  moveDelta: Point;\n\n  /**\n   * Singleton instance of ClientEvents\n   * @static\n   */\n  private static instance: ClientEvents | null = null;\n\n  /**\n   * Gets the singleton instance of ClientEvents, creating it if necessary\n   * This is the preferred way to get the ClientEvents instance\n   *\n   * @param options - Configuration options (only used on first call)\n   * @returns The singleton ClientEvents instance\n   */\n  static getInstance(options: ClientEventsArgs = {}): ClientEvents {\n    if (!ClientEvents.instance) {\n      ClientEvents.instance = new ClientEvents(options);\n    }\n    return ClientEvents.instance;\n  }\n\n  /**\n   * Creates a new ClientEvents instance\n   * Note: Use getInstance() instead to ensure singleton behavior\n   *\n   * @param options - Configuration options\n   * @param options.initWheelOffset - Initial wheel offset value\n   * @param options.onAnyEvent - Callback that fires on any input event\n   */\n  constructor({ initWheelOffset = new Point(), onAnyEvent = (ev: OnEvent) => {} }: ClientEventsArgs = {}) {\n    // Return existing instance if one exists (singleton pattern)\n    if (ClientEvents.instance) {\n      return ClientEvents.instance;\n    }\n    this.wheelOffsets = initWheelOffset;\n    this.keydown = {} as Record<string, KeyboardEvent>;\n    this.movePosition = new Point();\n\n    const anyEvent = (ev: OnEvent) => {\n      onAnyEvent(ev);\n    };\n\n    // Register wheel event listener\n    document.addEventListener('wheel', (event) => {\n      const wheelDelta = this.wheelOffsets || new Point();\n      const xValue = wheelDelta.x + event.deltaX;\n      const yValue = wheelDelta.y + event.deltaY;\n      this.wheelOffsets = new Point(xValue, yValue);\n      anyEvent({ eventType: 'wheel', event });\n    });\n\n    // Register mouse move event listener\n    document.addEventListener('mousemove', (event) => {\n      this.lastMovePosition = this.movePosition;\n      this.movePosition = new Point(event.clientX, event.clientY);\n      this.moveDelta = new Point(\n        this.movePosition.x - this.lastMovePosition.x,\n        this.movePosition.y - this.lastMovePosition.y\n      );\n      anyEvent({ eventType: 'mousemove', event });\n    });\n\n    // Register mouse down event listener\n    document.addEventListener('mousedown', (event) => {\n      this.mouseDownEvent = event;\n      this.lastMouseDown = event;\n      this.mouseUpEvent = null;\n      anyEvent({ eventType: 'mousedown', event });\n    });\n\n    // Register mouse up event listener\n    document.addEventListener('mouseup', (event) => {\n      this.mouseUpEvent = event;\n      this.lastMouseUp = event;\n      this.mouseDownEvent = null;\n      anyEvent({ eventType: 'mouseup', event });\n    });\n\n    // Register key down event listener\n    document.addEventListener('keydown', (event) => {\n      const { key } = event;\n      this.keyDownEvent = event;\n      this.keyUpEvent = null;\n      this.keydown[key] = event;\n      anyEvent({ eventType: 'keydown', event });\n    });\n\n    // Register key up event listener\n    document.addEventListener('keyup', (event) => {\n      const { key } = event;\n      this.keyUpEvent = event;\n      this.keyDownEvent = null;\n      delete this.keydown[key];\n      anyEvent({ eventType: 'keyup', event });\n    });\n\n    ClientEvents.instance = this;\n  }\n\n  /**\n   * Checks if a specific key is currently pressed down\n   * \n   * @param key - The key to check, e.g., 'a', 'ArrowUp', 'Space'\n   * @returns True if the key is currently pressed, false otherwise\n   * \n   * @example\n   * ```typescript\n   * if (events.isKeyDown('Space')) {\n   *   player.jump();\n   * }\n   * ```\n   */\n  isKeyDown(key: string): boolean {\n    return Boolean(this.keydown[key]);\n  }\n\n  /**\n   * Checks if a specific key is currently not pressed\n   * \n   * @param key - The key to check, e.g., 'a', 'ArrowUp', 'Space'\n   * @returns True if the key is currently not pressed, false if it is pressed\n   */\n  isKeyUp(key: string): boolean {\n    return !this.keydown[key];\n  }\n}\n\n\n\n","import PIXI from 'pixi.js';\nimport { Asset } from '..';\nimport { EventEmitter } from './event-system';\n\nexport interface AssetLoaderEvents extends Record<string, (...args: any[]) => void> {\n  'loading:start': () => void;\n  'loading:end': () => void;\n}\n\nexport class AssetLoader {\n  PIXIAssets: PIXI.AssetsClass = PIXI.Assets;\n  textures: PIXI.Texture[] = [];\n  isLoading: boolean = false;\n  private events: EventEmitter<AssetLoaderEvents> = new EventEmitter<AssetLoaderEvents>();\n\n  /**\n   * Subscribe to loading events\n   */\n  on<K extends keyof AssetLoaderEvents>(event: K, listener: AssetLoaderEvents[K]): void {\n    this.events.on(event, listener);\n  }\n\n  /**\n   * Unsubscribe from loading events\n   */\n  off<K extends keyof AssetLoaderEvents>(event: K, listener: AssetLoaderEvents[K]): void {\n    this.events.off(event, listener);\n  }\n\n  loadAssets = async (assets: Asset[]) => {\n    const { PIXIAssets } = this;\n    const failedAssets: string[] = [];\n\n    // Emit loading start event\n    this.isLoading = true;\n    this.events.emit('loading:start');\n\n    try {\n      for (let i = 0; i < assets.length; i++) {\n        const { src, alias } = assets[i];\n\n        try {\n          if (alias) {\n            if (!PIXIAssets.cache.has(alias)) {\n              const texture = await PIXIAssets.load({ alias, src });\n              this.textures.push(texture);\n            }\n          } else {\n            const texture = await PIXIAssets.load(src);\n            this.textures.push(texture);\n          }\n        } catch (error) {\n          console.error(`Failed to load asset: ${src}`, error);\n          failedAssets.push(src);\n        }\n      }\n\n      if (failedAssets.length > 0) {\n        console.warn(`${failedAssets.length} asset(s) failed to load:`, failedAssets);\n      }\n\n      return this;\n    } finally {\n      // Emit loading end event\n      this.isLoading = false;\n      this.events.emit('loading:end');\n    }\n  };\n}","import PIXI from 'pixi.js';\n\n/**\n * Base abstract class for all logic in the Moxi engine.\n * Logic components can be attached to entities to add functionality.\n * \n * @category Logic\n * @template T - The type of entity this logic can be attached to\n * \n * @example\n * ```typescript\n * class MyLogic extends Logic<Sprite> {\n *   update(entity: Sprite, deltaTime: number) {\n *     entity.rotation += deltaTime;\n *   }\n * }\n * ```\n */\nexport abstract class Logic<T> {\n  /**\n   * The name of this logic component\n   * Used to identify and retrieve logic components\n   * Defaults to constructor name but should be set explicitly for production builds\n   */\n  name?: string;\n  \n  /**\n   * Whether this logic is currently active and should be updated\n   * @default true\n   */\n  active: boolean = true;\n  \n  /**\n   * Initializes the logic with the entity it's attached to\n   * @param entity - The entity this logic is attached to\n   * @param renderer - The PIXI renderer instance\n   * @param args - Additional initialization arguments\n   */\n  init(entity?: T, renderer?: PIXI.Renderer<HTMLCanvasElement>, ...args: any[]) {\n    // Implement in subclass\n  }\n\n  /**\n   * Updates the logic's state\n   * @param entity - The entity this logic is attached to\n   * @param deltaTime - Time elapsed since last update in seconds\n   */\n  update(entity?: T, deltaTime?: number) {\n    // Implement in subclass\n  }\n}\n\n/**\n * Logic that can be instantiated multiple times with different configurations\n * \n * @category Logic\n * @template T - The type of entity this logic can be attached to\n * \n * @example\n * ```typescript\n * class MyInstancedLogic extends InstancedLogic<Sprite> {\n *   constructor(public speed: number) {\n *     super();\n *   }\n *   \n *   update(entity: Sprite, deltaTime: number) {\n *     entity.rotation += this.speed * deltaTime;\n *   }\n * }\n * ```\n */\nexport class InstancedLogic<T> extends Logic<T> {}\n\n","import PIXI from 'pixi.js';\nimport { Logic } from './logic';\n\n/**\n * Interface defining the contract for the MoxiEntity class.\n * Specifies required methods and properties for entity management.\n * \n * @internal\n * @template T - The type of entity being managed\n */\ninterface MoxiEntityClass<T> {\n  logic: MoxiLogic<T>;\n  update: (delta: number, entity: T) => void;\n  init: (...args: any[]) => void;\n  addLogic: (logic: Logic<T>) => void;\n  getLogic: (name: string) => Logic<T> | undefined;\n}\n\n/**\n * Type definition for objects that have been enhanced with MoxiEntity capabilities.\n * This is the primary interface developers will interact with when using the entity system.\n * \n * @category Entities\n * @template T - The type of entity being managed (typically extends PIXI.Container)\n * \n * @example\n * ```typescript\n * // Create a sprite and convert it to an AsEntity\n * const sprite = new PIXI.Sprite(texture);\n * const entitySprite = asEntity(sprite);\n * \n * // Now it has a moxiEntity property\n * entitySprite.moxiEntity.addLogic(new MovementLogic());\n * ```\n */\nexport type AsEntity<T> = PIXI.Container & {\n  moxiEntity: MoxiEntity<T>;\n};\n\n/**\n * Type definition for a collection of logic components mapped by name.\n * Used to store and retrieve logic attached to entities.\n * \n * @category Entities\n * @template T - The type of entity these logic components can be applied to\n */\nexport type MoxiLogic<T> = Record<string, Logic<T>>;\n\n/**\n * The core entity management class that handles component-based logic.\n * MoxiEntity connects entities with their logic components and manages the logic lifecycle.\n * \n * This class implements the Entity-Component-System pattern, where:\n * - The entity is the object being controlled (like a PIXI.Sprite)\n * - Logic components add functionality\n * - This class provides the system to manage those components\n * \n * @category Entities\n * @template T - The type of entity being managed\n * \n * @example\n * ```typescript\n * // Create a sprite and entity\n * const sprite = new PIXI.Sprite(texture);\n * const entity = new MoxiEntity(sprite);\n * \n * // Add logic\n * entity.addLogic(new MovementLogic());\n * entity.addLogic(new AnimationLogic());\n * \n * // Initialize all logic\n * entity.init(renderer);\n * \n * // Update all logic (usually called within the game loop)\n * entity.update(deltaTime);\n * ```\n */\nexport class MoxiEntity<T> implements MoxiEntityClass<T> {\n  /**\n   * Collection of logic components attached to this entity\n   */\n  logic: MoxiLogic<T> = {};\n  \n  /**\n   * Reference to the actual entity being managed\n   */\n  entity: T;\n\n  /**\n   * Creates a new MoxiEntity\n   * \n   * @param entity - The entity to manage\n   * @param logic - Optional map of initial logic to attach\n   */\n  constructor(entity: T, logic: MoxiLogic<T> = {}) {\n    this.logic = logic;\n    this.entity = entity;\n  }\n\n  /**\n   * Updates all active logic components attached to this entity\n   * Typically called each frame during the game loop\n   * \n   * @param deltaTime - Time in seconds since the last update\n   * \n   * @example\n   * ```typescript\n   * // In game loop\n   * function gameLoop(deltaTime) {\n   *   playerEntity.moxiEntity.update(deltaTime);\n   * }\n   * ```\n   */\n  update(deltaTime: number) {\n    if (!this.entity) return;\n\n    for (const className in this.logic) {\n      const logicComponent = this.logic[className];\n      if (logicComponent && logicComponent.active && logicComponent.update) {\n        logicComponent.update(this.entity, deltaTime);\n      }\n    }\n    // TODO: update children?\n  }\n  \n  /**\n   * Initializes all logic components attached to this entity\n   * Typically called once when the entity is first created or added to the scene\n   * \n   * @param renderer - The PIXI renderer instance\n   * @param args - Additional arguments to pass to each logic component's init method\n   * \n   * @example\n   * ```typescript\n   * // When adding an entity to the scene\n   * scene.addChild(entitySprite);\n   * entitySprite.moxiEntity.init(renderer);\n   * ```\n   */\n  init(renderer: PIXI.Renderer<HTMLCanvasElement>, ...args: any[]) {\n    if (!this.entity) return;\n\n    for (const className in this.logic) {\n      const logicComponent = this.logic[className];\n      if (logicComponent && logicComponent.init) {\n        logicComponent.init(this.entity, renderer, ...args);\n      }\n    }\n  } \n\n  /**\n   * Adds a logic component to this entity\n   * \n   * @param logic - The logic component to add\n   * \n   * @example\n   * ```typescript\n   * // Create and add logic\n   * const movementLogic = new MovementLogic();\n   * movementLogic.speed = 5;\n   * entitySprite.moxiEntity.addLogic(movementLogic);\n   * ```\n   */\n  addLogic(logic: Logic<T>) {\n    // Use explicit name if set, otherwise fall back to constructor name\n    const logicName = logic.name || logic.constructor.name;\n    this.logic[logicName] = logic;\n  }\n\n  /**\n   * Retrieves a logic component by name\n   * Useful for accessing and configuring specific logic components\n   * \n   * @template L - The type of logic to return\n   * @param name - The name of the logic to retrieve (usually the class name)\n   * @returns The logic instance, or undefined if not found\n   * \n   * @example\n   * ```typescript\n   * // Get and configure logic\n   * const movement = entitySprite.moxiEntity.getLogic<MovementLogic>('MovementLogic');\n   * if (movement) {\n   *   movement.speed = 10;\n   *   movement.direction = 'right';\n   * }\n   * ```\n   */\n  getLogic<L extends Logic<T>>(name: string): L | undefined {\n    return this.logic[name] as L | undefined;\n  }\n}\n\n/**\n * Helper function to convert a PIXI Container into an AsEntity\n * This is the primary way to create entities in Moxi\n * \n * @category Entities\n * @template T - The type of container being converted\n * @param entity - The PIXI Container to convert\n * @param logic - Optional initial logic to attach\n * @returns The enhanced container as an AsEntity\n * \n * @example\n * ```typescript\n * // Basic usage\n * const sprite = new PIXI.Sprite(texture);\n * const entitySprite = asEntity(sprite);\n * scene.addChild(entitySprite);\n * \n * // With initial logic\n * const player = asEntity(\n *   new PIXI.Sprite(playerTexture),\n *   {\n *     'PlayerMovement': new PlayerMovementLogic(),\n *     'Health': new HealthLogic(100)\n *   }\n * );\n * ```\n */\nexport function asEntity<T extends PIXI.Container>(entity: T, logic: MoxiLogic<T> = {}): AsEntity<T> {\n  const target = entity;\n  \n  // pixi patch: it's throwing an error on interactive events if isInteractive() doesn't exist.\n  target.isInteractive = () => false; \n\n  (target as unknown as AsEntity<T>).moxiEntity = new MoxiEntity<T>(target, logic);\n  return entity as unknown as AsEntity<T>;\n}\n\n","import PIXI, { Point } from 'pixi.js';\nimport { Logic } from './logic';\nimport { Scene } from './scene';\nimport { AsEntity, MoxiLogic, MoxiEntity } from './moxi-entity';\nimport { lerp } from '../library/utils';\n\n/**\n * Logic that handles camera movement, following targets, and smooth transitions.\n * \n * @category Logic\n * @implements {Logic<PIXI.Container>}\n */\nexport class CameraLogic extends Logic<PIXI.Container> {\n  /**\n   * Explicit name for the logic component (survives minification)\n   */\n  name = 'CameraLogic';\n  \n  /**\n   * Speed at which the camera transitions to its target position and scale\n   * @default 0.1\n   */\n  public speed: number = 0.1;\n  \n  /**\n   * The entity that the camera will follow\n   * @default null\n   */\n  public target: PIXI.Container = null;\n  \n  /**\n   * The entity this logic is attached to\n   */\n  entity: PIXI.Container<PIXI.ContainerChild>;\n  \n  /**\n   * Reference to the renderer for viewport calculations\n   */\n  renderer: PIXI.Renderer<HTMLCanvasElement>;\n\n  /**\n   * Initialize the camera logic\n   * @param entity - The container (camera) this logic is attached to\n   * @param renderer - The PIXI renderer instance\n   */\n  init(entity: PIXI.Container, renderer: PIXI.Renderer) {\n    this.entity = entity;\n    this.renderer = renderer;\n  }\n\n  /**\n   * Updates the camera position and scale based on targets and desired values\n   * @param entity - The Camera entity\n   * @param deltaTime - Time elapsed since last update in seconds\n   */\n  update(entity: Camera, deltaTime: number) {\n    const { speed } = this;\n    const deltaSpeed = Math.min(deltaTime * speed, 1);\n\n    // Track if scale is actively changing (zooming)\n    const isZooming = Math.abs(entity.scale.x - entity.desiredScale.x) > 0.01 ||\n                      Math.abs(entity.scale.y - entity.desiredScale.y) > 0.01;\n\n    // Interpolate scale values first\n    if (entity.desiredScale !== entity.scale) {\n      entity.scale.x = lerp(entity.scale.x, entity.desiredScale.x, deltaSpeed);\n      entity.scale.y = lerp(entity.scale.y, entity.desiredScale.y, deltaSpeed);\n    }\n\n    // Update desired position if camera has a target\n    if (this.target) {\n      // In a PIXI.js camera system, we need to position the camera (scene)\n      // so that the target appears centered in the viewport\n\n      // Get the center of the viewport in screen coordinates\n      const screenCenterX = this.renderer.width / 2;\n      const screenCenterY = this.renderer.height / 2;\n\n      // Calculate where the scene should be positioned\n      // The formula is: -(targetPosition * scale) + screenCenter\n      // This ensures the target is at the center of the screen\n      const desiredX = -(this.target.position.x * entity.scale.x) + screenCenterX;\n      const desiredY = -(this.target.position.y * entity.scale.y) + screenCenterY;\n\n      // Set desired position for the scene (using negative values for camera coordinates)\n      entity.desiredPosition.set(-desiredX, -desiredY);\n    }\n\n    // Interpolate position values\n    // When actively zooming, update position instantly to keep target centered\n    // Otherwise, interpolate smoothly for camera following\n    if (entity.desiredPosition !== entity.position) {\n      if (isZooming) {\n        // Instant position update during zoom to prevent target drift\n        entity.position.copyFrom(entity.desiredPosition);\n      } else {\n        // Smooth interpolation for normal camera following\n        entity.position.x = lerp(entity.position.x, entity.desiredPosition.x, deltaSpeed);\n        entity.position.y = lerp(entity.position.y, entity.desiredPosition.y, deltaSpeed);\n      }\n    }\n    \n    // Apply camera transformations to the scene\n    // In PIXI, the \"camera\" effect is created by transforming the scene in the opposite direction\n    entity.scene.scale.set(entity.scale.x, entity.scale.y);\n\n    // Position the scene at the negative of the camera position to create camera movement effect\n    entity.scene.position.set(-entity.position.x, -entity.position.y);\n  }\n}\n\n/**\n * Camera entity for controlling the viewport and following game objects.\n * The Camera applies transformations to the scene to simulate camera movement.\n * \n * @category Core\n * @implements {AsEntity<PIXI.Container>}\n * \n * @example\n * ```typescript\n * // Make the camera follow a player entity\n * camera.moxiEntity.getLogic<CameraLogic>('CameraLogic').target = player;\n * \n * // Set the camera zoom level\n * camera.desiredScale.set(2, 2); // 2x zoom\n * ```\n */\nexport class Camera extends PIXI.Container implements AsEntity<PIXI.Container> {\n  /**\n   * Reference to the scene being viewed by this camera\n   */\n  public scene: Scene;\n  \n  /**\n   * Reference to the renderer\n   */\n  public renderer: PIXI.Renderer;\n  \n  /**\n   * Speed at which the camera transitions\n   * @default 0.1\n   */\n  public speed: number = 0.1;\n  \n  /**\n   * MoxiEntity reference as required by the AsEntity interface\n   */\n  public moxiEntity: MoxiEntity<PIXI.Container>;\n  \n  /**\n   * The target scale (zoom) for the camera\n   * @default new Point(1, 1)\n   */\n  public desiredScale: Point = new Point(1, 1);\n  \n  /**\n   * The target position for the camera\n   * @default new Point(0, 0)\n   */\n  public desiredPosition: Point = new Point(0, 0); \n  \n  /**\n   * Creates a new Camera instance\n   * @param scene - The scene being viewed by this camera\n   * @param renderer - The PIXI renderer\n   * @param logic - Additional logic to attach to this camera\n   */\n  constructor(scene: Scene, renderer: PIXI.Renderer, logic: MoxiLogic<PIXI.Container> = {}) {\n    super();\n    this.scene = scene;\n    this.renderer = renderer;\n\n    // Initialize and attach the camera logic\n    const cameraLogic = new CameraLogic();\n    cameraLogic.init(this, renderer);\n    this.moxiEntity = new MoxiEntity<PIXI.Container>(this, logic);\n    this.moxiEntity.addLogic(cameraLogic);\n    this.scene.addChild(this);\n  }\n}  \n\n","/**\n * Planck.js v1.4.2\n * @license The MIT license\n * @copyright Copyright (c) 2025 Erin Catto, Ali Shakiba\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\nvar extendStatics = function(d2, b2) {\n  extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d3, b3) {\n    d3.__proto__ = b3;\n  } || function(d3, b3) {\n    for (var p in b3) if (Object.prototype.hasOwnProperty.call(b3, p)) d3[p] = b3[p];\n  };\n  return extendStatics(d2, b2);\n};\nfunction __extends(d2, b2) {\n  if (typeof b2 !== \"function\" && b2 !== null)\n    throw new TypeError(\"Class extends value \" + String(b2) + \" is not a constructor or null\");\n  extendStatics(d2, b2);\n  function __() {\n    this.constructor = d2;\n  }\n  d2.prototype = b2 === null ? Object.create(b2) : (__.prototype = b2.prototype, new __());\n}\nvar __assign = function() {\n  __assign = Object.assign || function __assign2(t) {\n    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {\n      s2 = arguments[i];\n      for (var p in s2) if (Object.prototype.hasOwnProperty.call(s2, p)) t[p] = s2[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar options = function(input2, defaults) {\n  if (input2 === null || typeof input2 === \"undefined\") {\n    input2 = {};\n  }\n  var output2 = __assign({}, input2);\n  for (var key in defaults) {\n    if (defaults.hasOwnProperty(key) && typeof input2[key] === \"undefined\") {\n      output2[key] = defaults[key];\n    }\n  }\n  if (typeof Object.getOwnPropertySymbols === \"function\") {\n    var symbols = Object.getOwnPropertySymbols(defaults);\n    for (var i = 0; i < symbols.length; i++) {\n      var symbol = symbols[i];\n      if (defaults.propertyIsEnumerable(symbol) && typeof input2[symbol] === \"undefined\") {\n        output2[symbol] = defaults[symbol];\n      }\n    }\n  }\n  return output2;\n};\nvar math_random = Math.random;\nvar EPSILON = 1e-9;\nvar isFinite = Number.isFinite;\nfunction nextPowerOfTwo(x2) {\n  x2 |= x2 >> 1;\n  x2 |= x2 >> 2;\n  x2 |= x2 >> 4;\n  x2 |= x2 >> 8;\n  x2 |= x2 >> 16;\n  return x2 + 1;\n}\nfunction isPowerOfTwo(x2) {\n  return x2 > 0 && (x2 & x2 - 1) === 0;\n}\nfunction mod(num, min, max) {\n  if (typeof min === \"undefined\") {\n    max = 1;\n    min = 0;\n  } else if (typeof max === \"undefined\") {\n    max = min;\n    min = 0;\n  }\n  if (max > min) {\n    num = (num - min) % (max - min);\n    return num + (num < 0 ? max : min);\n  } else {\n    num = (num - max) % (min - max);\n    return num + (num <= 0 ? min : max);\n  }\n}\nfunction clamp(num, min, max) {\n  if (num < min) {\n    return min;\n  } else if (num > max) {\n    return max;\n  } else {\n    return num;\n  }\n}\nfunction random(min, max) {\n  if (typeof min === \"undefined\") {\n    max = 1;\n    min = 0;\n  } else if (typeof max === \"undefined\") {\n    max = min;\n    min = 0;\n  }\n  return min === max ? min : math_random() * (max - min) + min;\n}\nvar math = Object.create(Math);\nmath.EPSILON = EPSILON;\nmath.isFinite = isFinite;\nmath.nextPowerOfTwo = nextPowerOfTwo;\nmath.isPowerOfTwo = isPowerOfTwo;\nmath.mod = mod;\nmath.clamp = clamp;\nmath.random = random;\nvar math_abs$9 = Math.abs;\nvar math_sqrt$5 = Math.sqrt;\nvar math_max$8 = Math.max;\nvar math_min$8 = Math.min;\nvar Vec2 = (\n  /** @class */\n  function() {\n    function Vec22(x2, y) {\n      if (!(this instanceof Vec22)) {\n        return new Vec22(x2, y);\n      }\n      if (typeof x2 === \"undefined\") {\n        this.x = 0;\n        this.y = 0;\n      } else if (typeof x2 === \"object\") {\n        this.x = x2.x;\n        this.y = x2.y;\n      } else {\n        this.x = x2;\n        this.y = y;\n      }\n    }\n    Vec22.prototype._serialize = function() {\n      return {\n        x: this.x,\n        y: this.y\n      };\n    };\n    Vec22._deserialize = function(data) {\n      var obj = Object.create(Vec22.prototype);\n      obj.x = data.x;\n      obj.y = data.y;\n      return obj;\n    };\n    Vec22.zero = function() {\n      var obj = Object.create(Vec22.prototype);\n      obj.x = 0;\n      obj.y = 0;\n      return obj;\n    };\n    Vec22.neo = function(x2, y) {\n      var obj = Object.create(Vec22.prototype);\n      obj.x = x2;\n      obj.y = y;\n      return obj;\n    };\n    Vec22.clone = function(v3) {\n      return Vec22.neo(v3.x, v3.y);\n    };\n    Vec22.prototype.toString = function() {\n      return JSON.stringify(this);\n    };\n    Vec22.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Number.isFinite(obj.x) && Number.isFinite(obj.y);\n    };\n    Vec22.assert = function(o) {\n    };\n    Vec22.prototype.clone = function() {\n      return Vec22.clone(this);\n    };\n    Vec22.prototype.setZero = function() {\n      this.x = 0;\n      this.y = 0;\n      return this;\n    };\n    Vec22.prototype.set = function(x2, y) {\n      if (typeof x2 === \"object\") {\n        this.x = x2.x;\n        this.y = x2.y;\n      } else {\n        this.x = x2;\n        this.y = y;\n      }\n      return this;\n    };\n    Vec22.prototype.setNum = function(x2, y) {\n      this.x = x2;\n      this.y = y;\n      return this;\n    };\n    Vec22.prototype.setVec2 = function(value) {\n      this.x = value.x;\n      this.y = value.y;\n      return this;\n    };\n    Vec22.prototype.wSet = function(a2, v3, b2, w) {\n      if (typeof b2 !== \"undefined\" || typeof w !== \"undefined\") {\n        return this.setCombine(a2, v3, b2, w);\n      } else {\n        return this.setMul(a2, v3);\n      }\n    };\n    Vec22.prototype.setCombine = function(a2, v3, b2, w) {\n      var x2 = a2 * v3.x + b2 * w.x;\n      var y = a2 * v3.y + b2 * w.y;\n      this.x = x2;\n      this.y = y;\n      return this;\n    };\n    Vec22.prototype.setMul = function(a2, v3) {\n      var x2 = a2 * v3.x;\n      var y = a2 * v3.y;\n      this.x = x2;\n      this.y = y;\n      return this;\n    };\n    Vec22.prototype.add = function(w) {\n      this.x += w.x;\n      this.y += w.y;\n      return this;\n    };\n    Vec22.prototype.wAdd = function(a2, v3, b2, w) {\n      if (typeof b2 !== \"undefined\" || typeof w !== \"undefined\") {\n        return this.addCombine(a2, v3, b2, w);\n      } else {\n        return this.addMul(a2, v3);\n      }\n    };\n    Vec22.prototype.addCombine = function(a2, v3, b2, w) {\n      var x2 = a2 * v3.x + b2 * w.x;\n      var y = a2 * v3.y + b2 * w.y;\n      this.x += x2;\n      this.y += y;\n      return this;\n    };\n    Vec22.prototype.addMul = function(a2, v3) {\n      var x2 = a2 * v3.x;\n      var y = a2 * v3.y;\n      this.x += x2;\n      this.y += y;\n      return this;\n    };\n    Vec22.prototype.wSub = function(a2, v3, b2, w) {\n      if (typeof b2 !== \"undefined\" || typeof w !== \"undefined\") {\n        return this.subCombine(a2, v3, b2, w);\n      } else {\n        return this.subMul(a2, v3);\n      }\n    };\n    Vec22.prototype.subCombine = function(a2, v3, b2, w) {\n      var x2 = a2 * v3.x + b2 * w.x;\n      var y = a2 * v3.y + b2 * w.y;\n      this.x -= x2;\n      this.y -= y;\n      return this;\n    };\n    Vec22.prototype.subMul = function(a2, v3) {\n      var x2 = a2 * v3.x;\n      var y = a2 * v3.y;\n      this.x -= x2;\n      this.y -= y;\n      return this;\n    };\n    Vec22.prototype.sub = function(w) {\n      this.x -= w.x;\n      this.y -= w.y;\n      return this;\n    };\n    Vec22.prototype.mul = function(m) {\n      this.x *= m;\n      this.y *= m;\n      return this;\n    };\n    Vec22.prototype.length = function() {\n      return Vec22.lengthOf(this);\n    };\n    Vec22.prototype.lengthSquared = function() {\n      return Vec22.lengthSquared(this);\n    };\n    Vec22.prototype.normalize = function() {\n      var length = this.length();\n      if (length < EPSILON) {\n        return 0;\n      }\n      var invLength = 1 / length;\n      this.x *= invLength;\n      this.y *= invLength;\n      return length;\n    };\n    Vec22.normalize = function(v3) {\n      var length = Vec22.lengthOf(v3);\n      if (length < EPSILON) {\n        return Vec22.zero();\n      }\n      var invLength = 1 / length;\n      return Vec22.neo(v3.x * invLength, v3.y * invLength);\n    };\n    Vec22.lengthOf = function(v3) {\n      return math_sqrt$5(v3.x * v3.x + v3.y * v3.y);\n    };\n    Vec22.lengthSquared = function(v3) {\n      return v3.x * v3.x + v3.y * v3.y;\n    };\n    Vec22.distance = function(v3, w) {\n      var dx = v3.x - w.x;\n      var dy = v3.y - w.y;\n      return math_sqrt$5(dx * dx + dy * dy);\n    };\n    Vec22.distanceSquared = function(v3, w) {\n      var dx = v3.x - w.x;\n      var dy = v3.y - w.y;\n      return dx * dx + dy * dy;\n    };\n    Vec22.areEqual = function(v3, w) {\n      return v3 === w || typeof w === \"object\" && w !== null && v3.x === w.x && v3.y === w.y;\n    };\n    Vec22.skew = function(v3) {\n      return Vec22.neo(-v3.y, v3.x);\n    };\n    Vec22.dot = function(v3, w) {\n      return v3.x * w.x + v3.y * w.y;\n    };\n    Vec22.cross = function(v3, w) {\n      if (typeof w === \"number\") {\n        return Vec22.neo(w * v3.y, -w * v3.x);\n      } else if (typeof v3 === \"number\") {\n        return Vec22.neo(-v3 * w.y, v3 * w.x);\n      } else {\n        return v3.x * w.y - v3.y * w.x;\n      }\n    };\n    Vec22.crossVec2Vec2 = function(v3, w) {\n      return v3.x * w.y - v3.y * w.x;\n    };\n    Vec22.crossVec2Num = function(v3, w) {\n      return Vec22.neo(w * v3.y, -w * v3.x);\n    };\n    Vec22.crossNumVec2 = function(v3, w) {\n      return Vec22.neo(-v3 * w.y, v3 * w.x);\n    };\n    Vec22.addCross = function(a2, v3, w) {\n      if (typeof w === \"number\") {\n        return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);\n      } else if (typeof v3 === \"number\") {\n        return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);\n      }\n    };\n    Vec22.addCrossVec2Num = function(a2, v3, w) {\n      return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);\n    };\n    Vec22.addCrossNumVec2 = function(a2, v3, w) {\n      return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);\n    };\n    Vec22.add = function(v3, w) {\n      return Vec22.neo(v3.x + w.x, v3.y + w.y);\n    };\n    Vec22.wAdd = function(a2, v3, b2, w) {\n      if (typeof b2 !== \"undefined\" || typeof w !== \"undefined\") {\n        return Vec22.combine(a2, v3, b2, w);\n      } else {\n        return Vec22.mulNumVec2(a2, v3);\n      }\n    };\n    Vec22.combine = function(a2, v3, b2, w) {\n      return Vec22.zero().setCombine(a2, v3, b2, w);\n    };\n    Vec22.sub = function(v3, w) {\n      return Vec22.neo(v3.x - w.x, v3.y - w.y);\n    };\n    Vec22.mul = function(a2, b2) {\n      if (typeof a2 === \"object\") {\n        return Vec22.neo(a2.x * b2, a2.y * b2);\n      } else if (typeof b2 === \"object\") {\n        return Vec22.neo(a2 * b2.x, a2 * b2.y);\n      }\n    };\n    Vec22.mulVec2Num = function(a2, b2) {\n      return Vec22.neo(a2.x * b2, a2.y * b2);\n    };\n    Vec22.mulNumVec2 = function(a2, b2) {\n      return Vec22.neo(a2 * b2.x, a2 * b2.y);\n    };\n    Vec22.prototype.neg = function() {\n      this.x = -this.x;\n      this.y = -this.y;\n      return this;\n    };\n    Vec22.neg = function(v3) {\n      return Vec22.neo(-v3.x, -v3.y);\n    };\n    Vec22.abs = function(v3) {\n      return Vec22.neo(math_abs$9(v3.x), math_abs$9(v3.y));\n    };\n    Vec22.mid = function(v3, w) {\n      return Vec22.neo((v3.x + w.x) * 0.5, (v3.y + w.y) * 0.5);\n    };\n    Vec22.upper = function(v3, w) {\n      return Vec22.neo(math_max$8(v3.x, w.x), math_max$8(v3.y, w.y));\n    };\n    Vec22.lower = function(v3, w) {\n      return Vec22.neo(math_min$8(v3.x, w.x), math_min$8(v3.y, w.y));\n    };\n    Vec22.prototype.clamp = function(max) {\n      var lengthSqr = this.x * this.x + this.y * this.y;\n      if (lengthSqr > max * max) {\n        var scale = max / math_sqrt$5(lengthSqr);\n        this.x *= scale;\n        this.y *= scale;\n      }\n      return this;\n    };\n    Vec22.clamp = function(v3, max) {\n      var r = Vec22.neo(v3.x, v3.y);\n      r.clamp(max);\n      return r;\n    };\n    Vec22.clampVec2 = function(v3, min, max) {\n      return {\n        x: clamp(v3.x, min === null || min === void 0 ? void 0 : min.x, max === null || max === void 0 ? void 0 : max.x),\n        y: clamp(v3.y, min === null || min === void 0 ? void 0 : min.y, max === null || max === void 0 ? void 0 : max.y)\n      };\n    };\n    Vec22.scaleFn = function(x2, y) {\n      return function(v3) {\n        return Vec22.neo(v3.x * x2, v3.y * y);\n      };\n    };\n    Vec22.translateFn = function(x2, y) {\n      return function(v3) {\n        return Vec22.neo(v3.x + x2, v3.y + y);\n      };\n    };\n    return Vec22;\n  }()\n);\nvar math_max$7 = Math.max;\nvar math_min$7 = Math.min;\nvar AABB = (\n  /** @class */\n  function() {\n    function AABB2(lower, upper) {\n      if (!(this instanceof AABB2)) {\n        return new AABB2(lower, upper);\n      }\n      this.lowerBound = Vec2.zero();\n      this.upperBound = Vec2.zero();\n      if (typeof lower === \"object\") {\n        this.lowerBound.setVec2(lower);\n      }\n      if (typeof upper === \"object\") {\n        this.upperBound.setVec2(upper);\n      } else if (typeof lower === \"object\") {\n        this.upperBound.setVec2(lower);\n      }\n    }\n    AABB2.prototype.isValid = function() {\n      return AABB2.isValid(this);\n    };\n    AABB2.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Vec2.isValid(obj.lowerBound) && Vec2.isValid(obj.upperBound) && Vec2.sub(obj.upperBound, obj.lowerBound).lengthSquared() >= 0;\n    };\n    AABB2.assert = function(o) {\n    };\n    AABB2.prototype.getCenter = function() {\n      return Vec2.neo((this.lowerBound.x + this.upperBound.x) * 0.5, (this.lowerBound.y + this.upperBound.y) * 0.5);\n    };\n    AABB2.prototype.getExtents = function() {\n      return Vec2.neo((this.upperBound.x - this.lowerBound.x) * 0.5, (this.upperBound.y - this.lowerBound.y) * 0.5);\n    };\n    AABB2.prototype.getPerimeter = function() {\n      return 2 * (this.upperBound.x - this.lowerBound.x + this.upperBound.y - this.lowerBound.y);\n    };\n    AABB2.prototype.combine = function(a2, b2) {\n      b2 = b2 || this;\n      var lowerA = a2.lowerBound;\n      var upperA = a2.upperBound;\n      var lowerB = b2.lowerBound;\n      var upperB = b2.upperBound;\n      var lowerX = math_min$7(lowerA.x, lowerB.x);\n      var lowerY = math_min$7(lowerA.y, lowerB.y);\n      var upperX = math_max$7(upperB.x, upperA.x);\n      var upperY = math_max$7(upperB.y, upperA.y);\n      this.lowerBound.setNum(lowerX, lowerY);\n      this.upperBound.setNum(upperX, upperY);\n    };\n    AABB2.prototype.combinePoints = function(a2, b2) {\n      this.lowerBound.setNum(math_min$7(a2.x, b2.x), math_min$7(a2.y, b2.y));\n      this.upperBound.setNum(math_max$7(a2.x, b2.x), math_max$7(a2.y, b2.y));\n    };\n    AABB2.prototype.set = function(aabb) {\n      this.lowerBound.setNum(aabb.lowerBound.x, aabb.lowerBound.y);\n      this.upperBound.setNum(aabb.upperBound.x, aabb.upperBound.y);\n    };\n    AABB2.prototype.contains = function(aabb) {\n      var result = true;\n      result = result && this.lowerBound.x <= aabb.lowerBound.x;\n      result = result && this.lowerBound.y <= aabb.lowerBound.y;\n      result = result && aabb.upperBound.x <= this.upperBound.x;\n      result = result && aabb.upperBound.y <= this.upperBound.y;\n      return result;\n    };\n    AABB2.prototype.extend = function(value) {\n      AABB2.extend(this, value);\n      return this;\n    };\n    AABB2.extend = function(out, value) {\n      out.lowerBound.x -= value;\n      out.lowerBound.y -= value;\n      out.upperBound.x += value;\n      out.upperBound.y += value;\n      return out;\n    };\n    AABB2.testOverlap = function(a2, b2) {\n      var d1x = b2.lowerBound.x - a2.upperBound.x;\n      var d2x = a2.lowerBound.x - b2.upperBound.x;\n      var d1y = b2.lowerBound.y - a2.upperBound.y;\n      var d2y = a2.lowerBound.y - b2.upperBound.y;\n      if (d1x > 0 || d1y > 0 || d2x > 0 || d2y > 0) {\n        return false;\n      }\n      return true;\n    };\n    AABB2.areEqual = function(a2, b2) {\n      return Vec2.areEqual(a2.lowerBound, b2.lowerBound) && Vec2.areEqual(a2.upperBound, b2.upperBound);\n    };\n    AABB2.diff = function(a2, b2) {\n      var wD = math_max$7(0, math_min$7(a2.upperBound.x, b2.upperBound.x) - math_max$7(b2.lowerBound.x, a2.lowerBound.x));\n      var hD = math_max$7(0, math_min$7(a2.upperBound.y, b2.upperBound.y) - math_max$7(b2.lowerBound.y, a2.lowerBound.y));\n      var wA = a2.upperBound.x - a2.lowerBound.x;\n      var hA = a2.upperBound.y - a2.lowerBound.y;\n      var wB = b2.upperBound.x - b2.lowerBound.x;\n      var hB = b2.upperBound.y - b2.lowerBound.y;\n      return wA * hA + wB * hB - wD * hD;\n    };\n    AABB2.prototype.rayCast = function(output2, input2) {\n      var tmin = -Infinity;\n      var tmax = Infinity;\n      var p = input2.p1;\n      var d2 = Vec2.sub(input2.p2, input2.p1);\n      var absD = Vec2.abs(d2);\n      var normal3 = Vec2.zero();\n      {\n        if (absD.x < EPSILON) {\n          if (p.x < this.lowerBound.x || this.upperBound.x < p.x) {\n            return false;\n          }\n        } else {\n          var inv_d = 1 / d2.x;\n          var t1 = (this.lowerBound.x - p.x) * inv_d;\n          var t2 = (this.upperBound.x - p.x) * inv_d;\n          var s2 = -1;\n          if (t1 > t2) {\n            var temp3 = t1;\n            t1 = t2;\n            t2 = temp3;\n            s2 = 1;\n          }\n          if (t1 > tmin) {\n            normal3.setZero();\n            normal3.x = s2;\n            tmin = t1;\n          }\n          tmax = math_min$7(tmax, t2);\n          if (tmin > tmax) {\n            return false;\n          }\n        }\n      }\n      {\n        if (absD.y < EPSILON) {\n          if (p.y < this.lowerBound.y || this.upperBound.y < p.y) {\n            return false;\n          }\n        } else {\n          var inv_d = 1 / d2.y;\n          var t1 = (this.lowerBound.y - p.y) * inv_d;\n          var t2 = (this.upperBound.y - p.y) * inv_d;\n          var s2 = -1;\n          if (t1 > t2) {\n            var temp3 = t1;\n            t1 = t2;\n            t2 = temp3;\n            s2 = 1;\n          }\n          if (t1 > tmin) {\n            normal3.setZero();\n            normal3.y = s2;\n            tmin = t1;\n          }\n          tmax = math_min$7(tmax, t2);\n          if (tmin > tmax) {\n            return false;\n          }\n        }\n      }\n      if (tmin < 0 || input2.maxFraction < tmin) {\n        return false;\n      }\n      output2.fraction = tmin;\n      output2.normal = normal3;\n      return true;\n    };\n    AABB2.prototype.toString = function() {\n      return JSON.stringify(this);\n    };\n    AABB2.combinePoints = function(out, a2, b2) {\n      out.lowerBound.x = math_min$7(a2.x, b2.x);\n      out.lowerBound.y = math_min$7(a2.y, b2.y);\n      out.upperBound.x = math_max$7(a2.x, b2.x);\n      out.upperBound.y = math_max$7(a2.y, b2.y);\n      return out;\n    };\n    AABB2.combinedPerimeter = function(a2, b2) {\n      var lx = math_min$7(a2.lowerBound.x, b2.lowerBound.x);\n      var ly = math_min$7(a2.lowerBound.y, b2.lowerBound.y);\n      var ux = math_max$7(a2.upperBound.x, b2.upperBound.x);\n      var uy = math_max$7(a2.upperBound.y, b2.upperBound.y);\n      return 2 * (ux - lx + uy - ly);\n    };\n    return AABB2;\n  }()\n);\nvar math_PI$6 = Math.PI;\nvar Settings = (\n  /** @class */\n  function() {\n    function Settings2() {\n    }\n    Object.defineProperty(Settings2, \"polygonRadius\", {\n      /**\n       * The radius of the polygon/edge shape skin. This should not be modified.\n       * Making this smaller means polygons will have an insufficient buffer for\n       * continuous collision. Making it larger may create artifacts for vertex\n       * collision.\n       */\n      get: function() {\n        return 2 * Settings2.linearSlop;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Settings2.lengthUnitsPerMeter = 1;\n    Settings2.maxManifoldPoints = 2;\n    Settings2.maxPolygonVertices = 12;\n    Settings2.aabbExtension = 0.1;\n    Settings2.aabbMultiplier = 2;\n    Settings2.linearSlop = 5e-3;\n    Settings2.angularSlop = 2 / 180 * math_PI$6;\n    Settings2.maxSubSteps = 8;\n    Settings2.maxTOIContacts = 32;\n    Settings2.maxTOIIterations = 20;\n    Settings2.maxDistanceIterations = 20;\n    Settings2.velocityThreshold = 1;\n    Settings2.maxLinearCorrection = 0.2;\n    Settings2.maxAngularCorrection = 8 / 180 * math_PI$6;\n    Settings2.maxTranslation = 2;\n    Settings2.maxRotation = 0.5 * math_PI$6;\n    Settings2.baumgarte = 0.2;\n    Settings2.toiBaugarte = 0.75;\n    Settings2.timeToSleep = 0.5;\n    Settings2.linearSleepTolerance = 0.01;\n    Settings2.angularSleepTolerance = 2 / 180 * math_PI$6;\n    return Settings2;\n  }()\n);\nvar SettingsInternal = (\n  /** @class */\n  function() {\n    function SettingsInternal2() {\n    }\n    Object.defineProperty(SettingsInternal2, \"maxManifoldPoints\", {\n      get: function() {\n        return Settings.maxManifoldPoints;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxPolygonVertices\", {\n      get: function() {\n        return Settings.maxPolygonVertices;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"aabbExtension\", {\n      get: function() {\n        return Settings.aabbExtension * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"aabbMultiplier\", {\n      get: function() {\n        return Settings.aabbMultiplier;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"linearSlop\", {\n      get: function() {\n        return Settings.linearSlop * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"linearSlopSquared\", {\n      get: function() {\n        return Settings.linearSlop * Settings.lengthUnitsPerMeter * Settings.linearSlop * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"angularSlop\", {\n      get: function() {\n        return Settings.angularSlop;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"polygonRadius\", {\n      get: function() {\n        return 2 * Settings.linearSlop;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxSubSteps\", {\n      get: function() {\n        return Settings.maxSubSteps;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxTOIContacts\", {\n      get: function() {\n        return Settings.maxTOIContacts;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxTOIIterations\", {\n      get: function() {\n        return Settings.maxTOIIterations;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxDistanceIterations\", {\n      get: function() {\n        return Settings.maxDistanceIterations;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"velocityThreshold\", {\n      get: function() {\n        return Settings.velocityThreshold * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxLinearCorrection\", {\n      get: function() {\n        return Settings.maxLinearCorrection * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxAngularCorrection\", {\n      get: function() {\n        return Settings.maxAngularCorrection;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxTranslation\", {\n      get: function() {\n        return Settings.maxTranslation * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxTranslationSquared\", {\n      get: function() {\n        return Settings.maxTranslation * Settings.lengthUnitsPerMeter * Settings.maxTranslation * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxRotation\", {\n      get: function() {\n        return Settings.maxRotation;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxRotationSquared\", {\n      get: function() {\n        return Settings.maxRotation * Settings.maxRotation;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"baumgarte\", {\n      get: function() {\n        return Settings.baumgarte;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"toiBaugarte\", {\n      get: function() {\n        return Settings.toiBaugarte;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"timeToSleep\", {\n      get: function() {\n        return Settings.timeToSleep;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"linearSleepTolerance\", {\n      get: function() {\n        return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"linearSleepToleranceSqr\", {\n      get: function() {\n        return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter * Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"angularSleepTolerance\", {\n      get: function() {\n        return Settings.angularSleepTolerance;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"angularSleepToleranceSqr\", {\n      get: function() {\n        return Settings.angularSleepTolerance * Settings.angularSleepTolerance;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    return SettingsInternal2;\n  }()\n);\nvar Pool = (\n  /** @class */\n  function() {\n    function Pool2(opts) {\n      this._list = [];\n      this._max = Infinity;\n      this._hasCreateFn = false;\n      this._createCount = 0;\n      this._hasAllocateFn = false;\n      this._allocateCount = 0;\n      this._hasReleaseFn = false;\n      this._releaseCount = 0;\n      this._hasDisposeFn = false;\n      this._disposeCount = 0;\n      this._list = [];\n      this._max = opts.max || this._max;\n      this._createFn = opts.create;\n      this._hasCreateFn = typeof this._createFn === \"function\";\n      this._allocateFn = opts.allocate;\n      this._hasAllocateFn = typeof this._allocateFn === \"function\";\n      this._releaseFn = opts.release;\n      this._hasReleaseFn = typeof this._releaseFn === \"function\";\n      this._disposeFn = opts.dispose;\n      this._hasDisposeFn = typeof this._disposeFn === \"function\";\n    }\n    Pool2.prototype.max = function(n2) {\n      if (typeof n2 === \"number\") {\n        this._max = n2;\n        return this;\n      }\n      return this._max;\n    };\n    Pool2.prototype.size = function() {\n      return this._list.length;\n    };\n    Pool2.prototype.allocate = function() {\n      var item;\n      if (this._list.length > 0) {\n        item = this._list.shift();\n      } else {\n        this._createCount++;\n        if (this._hasCreateFn) {\n          item = this._createFn();\n        } else {\n          item = {};\n        }\n      }\n      this._allocateCount++;\n      if (this._hasAllocateFn) {\n        this._allocateFn(item);\n      }\n      return item;\n    };\n    Pool2.prototype.release = function(item) {\n      if (this._list.length < this._max) {\n        this._releaseCount++;\n        if (this._hasReleaseFn) {\n          this._releaseFn(item);\n        }\n        this._list.push(item);\n      } else {\n        this._disposeCount++;\n        if (this._hasDisposeFn) {\n          item = this._disposeFn(item);\n        }\n      }\n    };\n    Pool2.prototype.toString = function() {\n      return \" +\" + this._createCount + \" >\" + this._allocateCount + \" <\" + this._releaseCount + \" -\" + this._disposeCount + \" =\" + this._list.length + \"/\" + this._max;\n    };\n    return Pool2;\n  }()\n);\nvar math_abs$8 = Math.abs;\nvar math_max$6 = Math.max;\nvar TreeNode = (\n  /** @class */\n  function() {\n    function TreeNode2(id) {\n      this.aabb = new AABB();\n      this.userData = null;\n      this.parent = null;\n      this.child1 = null;\n      this.child2 = null;\n      this.height = -1;\n      this.id = id;\n    }\n    TreeNode2.prototype.toString = function() {\n      return this.id + \": \" + this.userData;\n    };\n    TreeNode2.prototype.isLeaf = function() {\n      return this.child1 == null;\n    };\n    return TreeNode2;\n  }()\n);\nvar poolTreeNode = new Pool({\n  create: function() {\n    return new TreeNode();\n  },\n  release: function(node) {\n    node.userData = null;\n    node.parent = null;\n    node.child1 = null;\n    node.child2 = null;\n    node.height = -1;\n    node.id = void 0;\n  }\n});\nvar DynamicTree = (\n  /** @class */\n  function() {\n    function DynamicTree2() {\n      this.inputPool = new Pool({\n        create: function() {\n          return {};\n        },\n        release: function(stack) {\n        }\n      });\n      this.stackPool = new Pool({\n        create: function() {\n          return [];\n        },\n        release: function(stack) {\n          stack.length = 0;\n        }\n      });\n      this.iteratorPool = new Pool({\n        create: function() {\n          return new Iterator();\n        },\n        release: function(iterator) {\n          iterator.close();\n        }\n      });\n      this.m_root = null;\n      this.m_nodes = {};\n      this.m_lastProxyId = 0;\n    }\n    DynamicTree2.prototype.getUserData = function(id) {\n      var node = this.m_nodes[id];\n      return node.userData;\n    };\n    DynamicTree2.prototype.getFatAABB = function(id) {\n      var node = this.m_nodes[id];\n      return node.aabb;\n    };\n    DynamicTree2.prototype.allocateNode = function() {\n      var node = poolTreeNode.allocate();\n      node.id = ++this.m_lastProxyId;\n      this.m_nodes[node.id] = node;\n      return node;\n    };\n    DynamicTree2.prototype.freeNode = function(node) {\n      delete this.m_nodes[node.id];\n      poolTreeNode.release(node);\n    };\n    DynamicTree2.prototype.createProxy = function(aabb, userData) {\n      var node = this.allocateNode();\n      node.aabb.set(aabb);\n      AABB.extend(node.aabb, SettingsInternal.aabbExtension);\n      node.userData = userData;\n      node.height = 0;\n      this.insertLeaf(node);\n      return node.id;\n    };\n    DynamicTree2.prototype.destroyProxy = function(id) {\n      var node = this.m_nodes[id];\n      this.removeLeaf(node);\n      this.freeNode(node);\n    };\n    DynamicTree2.prototype.moveProxy = function(id, aabb, d2) {\n      var node = this.m_nodes[id];\n      if (node.aabb.contains(aabb)) {\n        return false;\n      }\n      this.removeLeaf(node);\n      node.aabb.set(aabb);\n      aabb = node.aabb;\n      AABB.extend(aabb, SettingsInternal.aabbExtension);\n      if (d2.x < 0) {\n        aabb.lowerBound.x += d2.x * SettingsInternal.aabbMultiplier;\n      } else {\n        aabb.upperBound.x += d2.x * SettingsInternal.aabbMultiplier;\n      }\n      if (d2.y < 0) {\n        aabb.lowerBound.y += d2.y * SettingsInternal.aabbMultiplier;\n      } else {\n        aabb.upperBound.y += d2.y * SettingsInternal.aabbMultiplier;\n      }\n      this.insertLeaf(node);\n      return true;\n    };\n    DynamicTree2.prototype.insertLeaf = function(leaf) {\n      if (this.m_root == null) {\n        this.m_root = leaf;\n        this.m_root.parent = null;\n        return;\n      }\n      var leafAABB = leaf.aabb;\n      var index = this.m_root;\n      while (!index.isLeaf()) {\n        var child1 = index.child1;\n        var child2 = index.child2;\n        var area = index.aabb.getPerimeter();\n        var combinedArea = AABB.combinedPerimeter(index.aabb, leafAABB);\n        var cost = 2 * combinedArea;\n        var inheritanceCost = 2 * (combinedArea - area);\n        var newArea1 = AABB.combinedPerimeter(leafAABB, child1.aabb);\n        var cost1 = newArea1 + inheritanceCost;\n        if (!child1.isLeaf()) {\n          var oldArea = child1.aabb.getPerimeter();\n          cost1 -= oldArea;\n        }\n        var newArea2 = AABB.combinedPerimeter(leafAABB, child2.aabb);\n        var cost2 = newArea2 + inheritanceCost;\n        if (!child2.isLeaf()) {\n          var oldArea = child2.aabb.getPerimeter();\n          cost2 -= oldArea;\n        }\n        if (cost < cost1 && cost < cost2) {\n          break;\n        }\n        if (cost1 < cost2) {\n          index = child1;\n        } else {\n          index = child2;\n        }\n      }\n      var sibling = index;\n      var oldParent = sibling.parent;\n      var newParent = this.allocateNode();\n      newParent.parent = oldParent;\n      newParent.userData = null;\n      newParent.aabb.combine(leafAABB, sibling.aabb);\n      newParent.height = sibling.height + 1;\n      if (oldParent != null) {\n        if (oldParent.child1 === sibling) {\n          oldParent.child1 = newParent;\n        } else {\n          oldParent.child2 = newParent;\n        }\n        newParent.child1 = sibling;\n        newParent.child2 = leaf;\n        sibling.parent = newParent;\n        leaf.parent = newParent;\n      } else {\n        newParent.child1 = sibling;\n        newParent.child2 = leaf;\n        sibling.parent = newParent;\n        leaf.parent = newParent;\n        this.m_root = newParent;\n      }\n      index = leaf.parent;\n      while (index != null) {\n        index = this.balance(index);\n        var child1 = index.child1;\n        var child2 = index.child2;\n        index.height = 1 + math_max$6(child1.height, child2.height);\n        index.aabb.combine(child1.aabb, child2.aabb);\n        index = index.parent;\n      }\n    };\n    DynamicTree2.prototype.removeLeaf = function(leaf) {\n      if (leaf === this.m_root) {\n        this.m_root = null;\n        return;\n      }\n      var parent = leaf.parent;\n      var grandParent = parent.parent;\n      var sibling;\n      if (parent.child1 === leaf) {\n        sibling = parent.child2;\n      } else {\n        sibling = parent.child1;\n      }\n      if (grandParent != null) {\n        if (grandParent.child1 === parent) {\n          grandParent.child1 = sibling;\n        } else {\n          grandParent.child2 = sibling;\n        }\n        sibling.parent = grandParent;\n        this.freeNode(parent);\n        var index = grandParent;\n        while (index != null) {\n          index = this.balance(index);\n          var child1 = index.child1;\n          var child2 = index.child2;\n          index.aabb.combine(child1.aabb, child2.aabb);\n          index.height = 1 + math_max$6(child1.height, child2.height);\n          index = index.parent;\n        }\n      } else {\n        this.m_root = sibling;\n        sibling.parent = null;\n        this.freeNode(parent);\n      }\n    };\n    DynamicTree2.prototype.balance = function(iA) {\n      var A = iA;\n      if (A.isLeaf() || A.height < 2) {\n        return iA;\n      }\n      var B = A.child1;\n      var C = A.child2;\n      var balance = C.height - B.height;\n      if (balance > 1) {\n        var F = C.child1;\n        var G = C.child2;\n        C.child1 = A;\n        C.parent = A.parent;\n        A.parent = C;\n        if (C.parent != null) {\n          if (C.parent.child1 === iA) {\n            C.parent.child1 = C;\n          } else {\n            C.parent.child2 = C;\n          }\n        } else {\n          this.m_root = C;\n        }\n        if (F.height > G.height) {\n          C.child2 = F;\n          A.child2 = G;\n          G.parent = A;\n          A.aabb.combine(B.aabb, G.aabb);\n          C.aabb.combine(A.aabb, F.aabb);\n          A.height = 1 + math_max$6(B.height, G.height);\n          C.height = 1 + math_max$6(A.height, F.height);\n        } else {\n          C.child2 = G;\n          A.child2 = F;\n          F.parent = A;\n          A.aabb.combine(B.aabb, F.aabb);\n          C.aabb.combine(A.aabb, G.aabb);\n          A.height = 1 + math_max$6(B.height, F.height);\n          C.height = 1 + math_max$6(A.height, G.height);\n        }\n        return C;\n      }\n      if (balance < -1) {\n        var D = B.child1;\n        var E = B.child2;\n        B.child1 = A;\n        B.parent = A.parent;\n        A.parent = B;\n        if (B.parent != null) {\n          if (B.parent.child1 === A) {\n            B.parent.child1 = B;\n          } else {\n            B.parent.child2 = B;\n          }\n        } else {\n          this.m_root = B;\n        }\n        if (D.height > E.height) {\n          B.child2 = D;\n          A.child1 = E;\n          E.parent = A;\n          A.aabb.combine(C.aabb, E.aabb);\n          B.aabb.combine(A.aabb, D.aabb);\n          A.height = 1 + math_max$6(C.height, E.height);\n          B.height = 1 + math_max$6(A.height, D.height);\n        } else {\n          B.child2 = E;\n          A.child1 = D;\n          D.parent = A;\n          A.aabb.combine(C.aabb, D.aabb);\n          B.aabb.combine(A.aabb, E.aabb);\n          A.height = 1 + math_max$6(C.height, D.height);\n          B.height = 1 + math_max$6(A.height, E.height);\n        }\n        return B;\n      }\n      return A;\n    };\n    DynamicTree2.prototype.getHeight = function() {\n      if (this.m_root == null) {\n        return 0;\n      }\n      return this.m_root.height;\n    };\n    DynamicTree2.prototype.getAreaRatio = function() {\n      if (this.m_root == null) {\n        return 0;\n      }\n      var root = this.m_root;\n      var rootArea = root.aabb.getPerimeter();\n      var totalArea = 0;\n      var node;\n      var it = this.iteratorPool.allocate().preorder(this.m_root);\n      while (node = it.next()) {\n        if (node.height < 0) {\n          continue;\n        }\n        totalArea += node.aabb.getPerimeter();\n      }\n      this.iteratorPool.release(it);\n      return totalArea / rootArea;\n    };\n    DynamicTree2.prototype.computeHeight = function(id) {\n      var node;\n      if (typeof id !== \"undefined\") {\n        node = this.m_nodes[id];\n      } else {\n        node = this.m_root;\n      }\n      if (node.isLeaf()) {\n        return 0;\n      }\n      var height1 = this.computeHeight(node.child1.id);\n      var height2 = this.computeHeight(node.child2.id);\n      return 1 + math_max$6(height1, height2);\n    };\n    DynamicTree2.prototype.validateStructure = function(node) {\n      if (node == null) {\n        return;\n      }\n      if (node === this.m_root) ;\n      var child1 = node.child1;\n      var child2 = node.child2;\n      if (node.isLeaf()) {\n        return;\n      }\n      this.validateStructure(child1);\n      this.validateStructure(child2);\n    };\n    DynamicTree2.prototype.validateMetrics = function(node) {\n      if (node == null) {\n        return;\n      }\n      var child1 = node.child1;\n      var child2 = node.child2;\n      if (node.isLeaf()) {\n        return;\n      }\n      this.validateMetrics(child1);\n      this.validateMetrics(child2);\n    };\n    DynamicTree2.prototype.validate = function() {\n      return;\n    };\n    DynamicTree2.prototype.getMaxBalance = function() {\n      var maxBalance = 0;\n      var node;\n      var it = this.iteratorPool.allocate().preorder(this.m_root);\n      while (node = it.next()) {\n        if (node.height <= 1) {\n          continue;\n        }\n        var balance = math_abs$8(node.child2.height - node.child1.height);\n        maxBalance = math_max$6(maxBalance, balance);\n      }\n      this.iteratorPool.release(it);\n      return maxBalance;\n    };\n    DynamicTree2.prototype.rebuildBottomUp = function() {\n      var nodes = [];\n      var count = 0;\n      var node;\n      var it = this.iteratorPool.allocate().preorder(this.m_root);\n      while (node = it.next()) {\n        if (node.height < 0) {\n          continue;\n        }\n        if (node.isLeaf()) {\n          node.parent = null;\n          nodes[count] = node;\n          ++count;\n        } else {\n          this.freeNode(node);\n        }\n      }\n      this.iteratorPool.release(it);\n      while (count > 1) {\n        var minCost = Infinity;\n        var iMin = -1;\n        var jMin = -1;\n        for (var i = 0; i < count; ++i) {\n          var aabbi = nodes[i].aabb;\n          for (var j = i + 1; j < count; ++j) {\n            var aabbj = nodes[j].aabb;\n            var cost = AABB.combinedPerimeter(aabbi, aabbj);\n            if (cost < minCost) {\n              iMin = i;\n              jMin = j;\n              minCost = cost;\n            }\n          }\n        }\n        var child1 = nodes[iMin];\n        var child2 = nodes[jMin];\n        var parent_1 = this.allocateNode();\n        parent_1.child1 = child1;\n        parent_1.child2 = child2;\n        parent_1.height = 1 + math_max$6(child1.height, child2.height);\n        parent_1.aabb.combine(child1.aabb, child2.aabb);\n        parent_1.parent = null;\n        child1.parent = parent_1;\n        child2.parent = parent_1;\n        nodes[jMin] = nodes[count - 1];\n        nodes[iMin] = parent_1;\n        --count;\n      }\n      this.m_root = nodes[0];\n    };\n    DynamicTree2.prototype.shiftOrigin = function(newOrigin) {\n      var node;\n      var it = this.iteratorPool.allocate().preorder(this.m_root);\n      while (node = it.next()) {\n        var aabb = node.aabb;\n        aabb.lowerBound.x -= newOrigin.x;\n        aabb.lowerBound.y -= newOrigin.y;\n        aabb.upperBound.x -= newOrigin.x;\n        aabb.upperBound.y -= newOrigin.y;\n      }\n      this.iteratorPool.release(it);\n    };\n    DynamicTree2.prototype.query = function(aabb, queryCallback) {\n      var stack = this.stackPool.allocate();\n      stack.push(this.m_root);\n      while (stack.length > 0) {\n        var node = stack.pop();\n        if (node == null) {\n          continue;\n        }\n        if (AABB.testOverlap(node.aabb, aabb)) {\n          if (node.isLeaf()) {\n            var proceed = queryCallback(node.id);\n            if (proceed === false) {\n              return;\n            }\n          } else {\n            stack.push(node.child1);\n            stack.push(node.child2);\n          }\n        }\n      }\n      this.stackPool.release(stack);\n    };\n    DynamicTree2.prototype.rayCast = function(input2, rayCastCallback) {\n      var p1 = input2.p1;\n      var p2 = input2.p2;\n      var r = Vec2.sub(p2, p1);\n      r.normalize();\n      var v3 = Vec2.crossNumVec2(1, r);\n      var abs_v = Vec2.abs(v3);\n      var maxFraction = input2.maxFraction;\n      var segmentAABB = new AABB();\n      var t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);\n      segmentAABB.combinePoints(p1, t);\n      var stack = this.stackPool.allocate();\n      var subInput = this.inputPool.allocate();\n      stack.push(this.m_root);\n      while (stack.length > 0) {\n        var node = stack.pop();\n        if (node == null) {\n          continue;\n        }\n        if (AABB.testOverlap(node.aabb, segmentAABB) === false) {\n          continue;\n        }\n        var c2 = node.aabb.getCenter();\n        var h = node.aabb.getExtents();\n        var separation = math_abs$8(Vec2.dot(v3, Vec2.sub(p1, c2))) - Vec2.dot(abs_v, h);\n        if (separation > 0) {\n          continue;\n        }\n        if (node.isLeaf()) {\n          subInput.p1 = Vec2.clone(input2.p1);\n          subInput.p2 = Vec2.clone(input2.p2);\n          subInput.maxFraction = maxFraction;\n          var value = rayCastCallback(subInput, node.id);\n          if (value === 0) {\n            break;\n          } else if (value > 0) {\n            maxFraction = value;\n            t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);\n            segmentAABB.combinePoints(p1, t);\n          }\n        } else {\n          stack.push(node.child1);\n          stack.push(node.child2);\n        }\n      }\n      this.stackPool.release(stack);\n      this.inputPool.release(subInput);\n    };\n    return DynamicTree2;\n  }()\n);\nvar Iterator = (\n  /** @class */\n  function() {\n    function Iterator2() {\n      this.parents = [];\n      this.states = [];\n    }\n    Iterator2.prototype.preorder = function(root) {\n      this.parents.length = 0;\n      this.parents.push(root);\n      this.states.length = 0;\n      this.states.push(0);\n      return this;\n    };\n    Iterator2.prototype.next = function() {\n      while (this.parents.length > 0) {\n        var i = this.parents.length - 1;\n        var node = this.parents[i];\n        if (this.states[i] === 0) {\n          this.states[i] = 1;\n          return node;\n        }\n        if (this.states[i] === 1) {\n          this.states[i] = 2;\n          if (node.child1) {\n            this.parents.push(node.child1);\n            this.states.push(1);\n            return node.child1;\n          }\n        }\n        if (this.states[i] === 2) {\n          this.states[i] = 3;\n          if (node.child2) {\n            this.parents.push(node.child2);\n            this.states.push(1);\n            return node.child2;\n          }\n        }\n        this.parents.pop();\n        this.states.pop();\n      }\n    };\n    Iterator2.prototype.close = function() {\n      this.parents.length = 0;\n    };\n    return Iterator2;\n  }()\n);\nvar math_max$5 = Math.max;\nvar math_min$6 = Math.min;\nvar BroadPhase = (\n  /** @class */\n  function() {\n    function BroadPhase2() {\n      var _this = this;\n      this.m_tree = new DynamicTree();\n      this.m_moveBuffer = [];\n      this.query = function(aabb, queryCallback) {\n        _this.m_tree.query(aabb, queryCallback);\n      };\n      this.queryCallback = function(proxyId) {\n        if (proxyId === _this.m_queryProxyId) {\n          return true;\n        }\n        var proxyIdA = math_min$6(proxyId, _this.m_queryProxyId);\n        var proxyIdB = math_max$5(proxyId, _this.m_queryProxyId);\n        var userDataA = _this.m_tree.getUserData(proxyIdA);\n        var userDataB = _this.m_tree.getUserData(proxyIdB);\n        _this.m_callback(userDataA, userDataB);\n        return true;\n      };\n    }\n    BroadPhase2.prototype.getUserData = function(proxyId) {\n      return this.m_tree.getUserData(proxyId);\n    };\n    BroadPhase2.prototype.testOverlap = function(proxyIdA, proxyIdB) {\n      var aabbA = this.m_tree.getFatAABB(proxyIdA);\n      var aabbB = this.m_tree.getFatAABB(proxyIdB);\n      return AABB.testOverlap(aabbA, aabbB);\n    };\n    BroadPhase2.prototype.getFatAABB = function(proxyId) {\n      return this.m_tree.getFatAABB(proxyId);\n    };\n    BroadPhase2.prototype.getProxyCount = function() {\n      return this.m_moveBuffer.length;\n    };\n    BroadPhase2.prototype.getTreeHeight = function() {\n      return this.m_tree.getHeight();\n    };\n    BroadPhase2.prototype.getTreeBalance = function() {\n      return this.m_tree.getMaxBalance();\n    };\n    BroadPhase2.prototype.getTreeQuality = function() {\n      return this.m_tree.getAreaRatio();\n    };\n    BroadPhase2.prototype.rayCast = function(input2, rayCastCallback) {\n      this.m_tree.rayCast(input2, rayCastCallback);\n    };\n    BroadPhase2.prototype.shiftOrigin = function(newOrigin) {\n      this.m_tree.shiftOrigin(newOrigin);\n    };\n    BroadPhase2.prototype.createProxy = function(aabb, userData) {\n      var proxyId = this.m_tree.createProxy(aabb, userData);\n      this.bufferMove(proxyId);\n      return proxyId;\n    };\n    BroadPhase2.prototype.destroyProxy = function(proxyId) {\n      this.unbufferMove(proxyId);\n      this.m_tree.destroyProxy(proxyId);\n    };\n    BroadPhase2.prototype.moveProxy = function(proxyId, aabb, displacement2) {\n      var changed = this.m_tree.moveProxy(proxyId, aabb, displacement2);\n      if (changed) {\n        this.bufferMove(proxyId);\n      }\n    };\n    BroadPhase2.prototype.touchProxy = function(proxyId) {\n      this.bufferMove(proxyId);\n    };\n    BroadPhase2.prototype.bufferMove = function(proxyId) {\n      this.m_moveBuffer.push(proxyId);\n    };\n    BroadPhase2.prototype.unbufferMove = function(proxyId) {\n      for (var i = 0; i < this.m_moveBuffer.length; ++i) {\n        if (this.m_moveBuffer[i] === proxyId) {\n          this.m_moveBuffer[i] = null;\n        }\n      }\n    };\n    BroadPhase2.prototype.updatePairs = function(addPairCallback) {\n      this.m_callback = addPairCallback;\n      while (this.m_moveBuffer.length > 0) {\n        this.m_queryProxyId = this.m_moveBuffer.pop();\n        if (this.m_queryProxyId === null) {\n          continue;\n        }\n        var fatAABB = this.m_tree.getFatAABB(this.m_queryProxyId);\n        this.m_tree.query(fatAABB, this.queryCallback);\n      }\n    };\n    return BroadPhase2;\n  }()\n);\nvar math_sin$2 = Math.sin;\nvar math_cos$2 = Math.cos;\nvar math_sqrt$4 = Math.sqrt;\nfunction vec2(x2, y) {\n  return { x: x2, y };\n}\nfunction rotation(angle) {\n  return { s: math_sin$2(angle), c: math_cos$2(angle) };\n}\nfunction setVec2(out, x2, y) {\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction copyVec2(out, w) {\n  out.x = w.x;\n  out.y = w.y;\n  return out;\n}\nfunction zeroVec2(out) {\n  out.x = 0;\n  out.y = 0;\n  return out;\n}\nfunction negVec2(out) {\n  out.x = -out.x;\n  out.y = -out.y;\n  return out;\n}\nfunction plusVec2(out, w) {\n  out.x += w.x;\n  out.y += w.y;\n  return out;\n}\nfunction addVec2(out, v3, w) {\n  out.x = v3.x + w.x;\n  out.y = v3.x + w.y;\n  return out;\n}\nfunction minusVec2(out, w) {\n  out.x -= w.x;\n  out.y -= w.y;\n  return out;\n}\nfunction subVec2(out, v3, w) {\n  out.x = v3.x - w.x;\n  out.y = v3.y - w.y;\n  return out;\n}\nfunction mulVec2(out, m) {\n  out.x *= m;\n  out.y *= m;\n  return out;\n}\nfunction scaleVec2(out, m, w) {\n  out.x = m * w.x;\n  out.y = m * w.y;\n  return out;\n}\nfunction plusScaleVec2(out, m, w) {\n  out.x += m * w.x;\n  out.y += m * w.y;\n  return out;\n}\nfunction minusScaleVec2(out, m, w) {\n  out.x -= m * w.x;\n  out.y -= m * w.y;\n  return out;\n}\nfunction combine2Vec2(out, am, a2, bm, b2) {\n  out.x = am * a2.x + bm * b2.x;\n  out.y = am * a2.y + bm * b2.y;\n  return out;\n}\nfunction combine3Vec2(out, am, a2, bm, b2, cm, c2) {\n  out.x = am * a2.x + bm * b2.x + cm * c2.x;\n  out.y = am * a2.y + bm * b2.y + cm * c2.y;\n  return out;\n}\nfunction normalizeVec2Length(out) {\n  var length = math_sqrt$4(out.x * out.x + out.y * out.y);\n  if (length !== 0) {\n    var invLength = 1 / length;\n    out.x *= invLength;\n    out.y *= invLength;\n  }\n  return length;\n}\nfunction normalizeVec2(out) {\n  var length = math_sqrt$4(out.x * out.x + out.y * out.y);\n  if (length > 0) {\n    var invLength = 1 / length;\n    out.x *= invLength;\n    out.y *= invLength;\n  }\n  return out;\n}\nfunction crossVec2Num(out, v3, w) {\n  var x2 = w * v3.y;\n  var y = -w * v3.x;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction crossNumVec2(out, w, v3) {\n  var x2 = -w * v3.y;\n  var y = w * v3.x;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction crossVec2Vec2(a2, b2) {\n  return a2.x * b2.y - a2.y * b2.x;\n}\nfunction dotVec2(a2, b2) {\n  return a2.x * b2.x + a2.y * b2.y;\n}\nfunction lengthSqrVec2(a2) {\n  return a2.x * a2.x + a2.y * a2.y;\n}\nfunction distVec2(a2, b2) {\n  var dx = a2.x - b2.x;\n  var dy = a2.y - b2.y;\n  return math_sqrt$4(dx * dx + dy * dy);\n}\nfunction distSqrVec2(a2, b2) {\n  var dx = a2.x - b2.x;\n  var dy = a2.y - b2.y;\n  return dx * dx + dy * dy;\n}\nfunction setRotAngle(out, a2) {\n  out.c = math_cos$2(a2);\n  out.s = math_sin$2(a2);\n  return out;\n}\nfunction rotVec2(out, q, v3) {\n  out.x = q.c * v3.x - q.s * v3.y;\n  out.y = q.s * v3.x + q.c * v3.y;\n  return out;\n}\nfunction derotVec2(out, q, v3) {\n  var x2 = q.c * v3.x + q.s * v3.y;\n  var y = -q.s * v3.x + q.c * v3.y;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction rerotVec2(out, before, after, v3) {\n  var x0 = before.c * v3.x + before.s * v3.y;\n  var y0 = -before.s * v3.x + before.c * v3.y;\n  var x2 = after.c * x0 - after.s * y0;\n  var y = after.s * x0 + after.c * y0;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction transform(x2, y, a2) {\n  return { p: vec2(x2, y), q: rotation(a2) };\n}\nfunction copyTransform(out, transform2) {\n  out.p.x = transform2.p.x;\n  out.p.y = transform2.p.y;\n  out.q.s = transform2.q.s;\n  out.q.c = transform2.q.c;\n  return out;\n}\nfunction transformVec2(out, xf2, v3) {\n  var x2 = xf2.q.c * v3.x - xf2.q.s * v3.y + xf2.p.x;\n  var y = xf2.q.s * v3.x + xf2.q.c * v3.y + xf2.p.y;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction detransformVec2(out, xf2, v3) {\n  var px = v3.x - xf2.p.x;\n  var py = v3.y - xf2.p.y;\n  var x2 = xf2.q.c * px + xf2.q.s * py;\n  var y = -xf2.q.s * px + xf2.q.c * py;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction retransformVec2(out, from, to, v3) {\n  var x0 = from.q.c * v3.x - from.q.s * v3.y + from.p.x;\n  var y0 = from.q.s * v3.x + from.q.c * v3.y + from.p.y;\n  var px = x0 - to.p.x;\n  var py = y0 - to.p.y;\n  var x2 = to.q.c * px + to.q.s * py;\n  var y = -to.q.s * px + to.q.c * py;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction detransformTransform(out, a2, b2) {\n  var c2 = a2.q.c * b2.q.c + a2.q.s * b2.q.s;\n  var s2 = a2.q.c * b2.q.s - a2.q.s * b2.q.c;\n  var x2 = a2.q.c * (b2.p.x - a2.p.x) + a2.q.s * (b2.p.y - a2.p.y);\n  var y = -a2.q.s * (b2.p.x - a2.p.x) + a2.q.c * (b2.p.y - a2.p.y);\n  out.q.c = c2;\n  out.q.s = s2;\n  out.p.x = x2;\n  out.p.y = y;\n  return out;\n}\nvar math_sin$1 = Math.sin;\nvar math_cos$1 = Math.cos;\nvar math_atan2$1 = Math.atan2;\nvar Rot = (\n  /** @class */\n  function() {\n    function Rot2(angle) {\n      if (!(this instanceof Rot2)) {\n        return new Rot2(angle);\n      }\n      if (typeof angle === \"number\") {\n        this.setAngle(angle);\n      } else if (typeof angle === \"object\") {\n        this.setRot(angle);\n      } else {\n        this.setIdentity();\n      }\n    }\n    Rot2.neo = function(angle) {\n      var obj = Object.create(Rot2.prototype);\n      obj.setAngle(angle);\n      return obj;\n    };\n    Rot2.clone = function(rot) {\n      var obj = Object.create(Rot2.prototype);\n      obj.s = rot.s;\n      obj.c = rot.c;\n      return obj;\n    };\n    Rot2.identity = function() {\n      var obj = Object.create(Rot2.prototype);\n      obj.s = 0;\n      obj.c = 1;\n      return obj;\n    };\n    Rot2.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Number.isFinite(obj.s) && Number.isFinite(obj.c);\n    };\n    Rot2.assert = function(o) {\n    };\n    Rot2.prototype.setIdentity = function() {\n      this.s = 0;\n      this.c = 1;\n    };\n    Rot2.prototype.set = function(angle) {\n      if (typeof angle === \"object\") {\n        this.s = angle.s;\n        this.c = angle.c;\n      } else {\n        this.s = math_sin$1(angle);\n        this.c = math_cos$1(angle);\n      }\n    };\n    Rot2.prototype.setRot = function(angle) {\n      this.s = angle.s;\n      this.c = angle.c;\n    };\n    Rot2.prototype.setAngle = function(angle) {\n      this.s = math_sin$1(angle);\n      this.c = math_cos$1(angle);\n    };\n    Rot2.prototype.getAngle = function() {\n      return math_atan2$1(this.s, this.c);\n    };\n    Rot2.prototype.getXAxis = function() {\n      return Vec2.neo(this.c, this.s);\n    };\n    Rot2.prototype.getYAxis = function() {\n      return Vec2.neo(-this.s, this.c);\n    };\n    Rot2.mul = function(rot, m) {\n      if (\"c\" in m && \"s\" in m) {\n        var qr = Rot2.identity();\n        qr.s = rot.s * m.c + rot.c * m.s;\n        qr.c = rot.c * m.c - rot.s * m.s;\n        return qr;\n      } else if (\"x\" in m && \"y\" in m) {\n        return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);\n      }\n    };\n    Rot2.mulRot = function(rot, m) {\n      var qr = Rot2.identity();\n      qr.s = rot.s * m.c + rot.c * m.s;\n      qr.c = rot.c * m.c - rot.s * m.s;\n      return qr;\n    };\n    Rot2.mulVec2 = function(rot, m) {\n      return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);\n    };\n    Rot2.mulSub = function(rot, v3, w) {\n      var x2 = rot.c * (v3.x - w.x) - rot.s * (v3.y - w.y);\n      var y = rot.s * (v3.x - w.x) + rot.c * (v3.y - w.y);\n      return Vec2.neo(x2, y);\n    };\n    Rot2.mulT = function(rot, m) {\n      if (\"c\" in m && \"s\" in m) {\n        var qr = Rot2.identity();\n        qr.s = rot.c * m.s - rot.s * m.c;\n        qr.c = rot.c * m.c + rot.s * m.s;\n        return qr;\n      } else if (\"x\" in m && \"y\" in m) {\n        return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);\n      }\n    };\n    Rot2.mulTRot = function(rot, m) {\n      var qr = Rot2.identity();\n      qr.s = rot.c * m.s - rot.s * m.c;\n      qr.c = rot.c * m.c + rot.s * m.s;\n      return qr;\n    };\n    Rot2.mulTVec2 = function(rot, m) {\n      return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);\n    };\n    return Rot2;\n  }()\n);\nvar math_atan2 = Math.atan2;\nvar math_PI$5 = Math.PI;\nvar temp$7 = vec2(0, 0);\nvar Sweep = (\n  /** @class */\n  function() {\n    function Sweep2() {\n      this.localCenter = Vec2.zero();\n      this.c = Vec2.zero();\n      this.a = 0;\n      this.alpha0 = 0;\n      this.c0 = Vec2.zero();\n      this.a0 = 0;\n    }\n    Sweep2.prototype.recycle = function() {\n      zeroVec2(this.localCenter);\n      zeroVec2(this.c);\n      this.a = 0;\n      this.alpha0 = 0;\n      zeroVec2(this.c0);\n      this.a0 = 0;\n    };\n    Sweep2.prototype.setTransform = function(xf2) {\n      transformVec2(temp$7, xf2, this.localCenter);\n      copyVec2(this.c, temp$7);\n      copyVec2(this.c0, temp$7);\n      this.a = this.a0 = math_atan2(xf2.q.s, xf2.q.c);\n    };\n    Sweep2.prototype.setLocalCenter = function(localCenter2, xf2) {\n      copyVec2(this.localCenter, localCenter2);\n      transformVec2(temp$7, xf2, this.localCenter);\n      copyVec2(this.c, temp$7);\n      copyVec2(this.c0, temp$7);\n    };\n    Sweep2.prototype.getTransform = function(xf2, beta) {\n      if (beta === void 0) {\n        beta = 0;\n      }\n      setRotAngle(xf2.q, (1 - beta) * this.a0 + beta * this.a);\n      combine2Vec2(xf2.p, 1 - beta, this.c0, beta, this.c);\n      minusVec2(xf2.p, rotVec2(temp$7, xf2.q, this.localCenter));\n    };\n    Sweep2.prototype.advance = function(alpha) {\n      var beta = (alpha - this.alpha0) / (1 - this.alpha0);\n      combine2Vec2(this.c0, beta, this.c, 1 - beta, this.c0);\n      this.a0 = beta * this.a + (1 - beta) * this.a0;\n      this.alpha0 = alpha;\n    };\n    Sweep2.prototype.forward = function() {\n      this.a0 = this.a;\n      copyVec2(this.c0, this.c);\n    };\n    Sweep2.prototype.normalize = function() {\n      var a0 = mod(this.a0, -math_PI$5, +math_PI$5);\n      this.a -= this.a0 - a0;\n      this.a0 = a0;\n    };\n    Sweep2.prototype.set = function(that) {\n      copyVec2(this.localCenter, that.localCenter);\n      copyVec2(this.c, that.c);\n      this.a = that.a;\n      this.alpha0 = that.alpha0;\n      copyVec2(this.c0, that.c0);\n      this.a0 = that.a0;\n    };\n    return Sweep2;\n  }()\n);\nvar Transform = (\n  /** @class */\n  function() {\n    function Transform2(position, rotation2) {\n      if (!(this instanceof Transform2)) {\n        return new Transform2(position, rotation2);\n      }\n      this.p = Vec2.zero();\n      this.q = Rot.identity();\n      if (typeof position !== \"undefined\") {\n        this.p.setVec2(position);\n      }\n      if (typeof rotation2 !== \"undefined\") {\n        this.q.setAngle(rotation2);\n      }\n    }\n    Transform2.clone = function(xf2) {\n      var obj = Object.create(Transform2.prototype);\n      obj.p = Vec2.clone(xf2.p);\n      obj.q = Rot.clone(xf2.q);\n      return obj;\n    };\n    Transform2.neo = function(position, rotation2) {\n      var obj = Object.create(Transform2.prototype);\n      obj.p = Vec2.clone(position);\n      obj.q = Rot.clone(rotation2);\n      return obj;\n    };\n    Transform2.identity = function() {\n      var obj = Object.create(Transform2.prototype);\n      obj.p = Vec2.zero();\n      obj.q = Rot.identity();\n      return obj;\n    };\n    Transform2.prototype.setIdentity = function() {\n      this.p.setZero();\n      this.q.setIdentity();\n    };\n    Transform2.prototype.set = function(a2, b2) {\n      if (typeof b2 === \"undefined\") {\n        this.p.set(a2.p);\n        this.q.set(a2.q);\n      } else {\n        this.p.set(a2);\n        this.q.set(b2);\n      }\n    };\n    Transform2.prototype.setNum = function(position, rotation2) {\n      this.p.setVec2(position);\n      this.q.setAngle(rotation2);\n    };\n    Transform2.prototype.setTransform = function(xf2) {\n      this.p.setVec2(xf2.p);\n      this.q.setRot(xf2.q);\n    };\n    Transform2.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Vec2.isValid(obj.p) && Rot.isValid(obj.q);\n    };\n    Transform2.assert = function(o) {\n    };\n    Transform2.mul = function(a2, b2) {\n      if (Array.isArray(b2)) {\n        var arr = [];\n        for (var i = 0; i < b2.length; i++) {\n          arr[i] = Transform2.mul(a2, b2[i]);\n        }\n        return arr;\n      } else if (\"x\" in b2 && \"y\" in b2) {\n        return Transform2.mulVec2(a2, b2);\n      } else if (\"p\" in b2 && \"q\" in b2) {\n        return Transform2.mulXf(a2, b2);\n      }\n    };\n    Transform2.mulAll = function(a2, b2) {\n      var arr = [];\n      for (var i = 0; i < b2.length; i++) {\n        arr[i] = Transform2.mul(a2, b2[i]);\n      }\n      return arr;\n    };\n    Transform2.mulFn = function(a2) {\n      return function(b2) {\n        return Transform2.mul(a2, b2);\n      };\n    };\n    Transform2.mulVec2 = function(a2, b2) {\n      var x2 = a2.q.c * b2.x - a2.q.s * b2.y + a2.p.x;\n      var y = a2.q.s * b2.x + a2.q.c * b2.y + a2.p.y;\n      return Vec2.neo(x2, y);\n    };\n    Transform2.mulXf = function(a2, b2) {\n      var xf2 = Transform2.identity();\n      xf2.q = Rot.mulRot(a2.q, b2.q);\n      xf2.p = Vec2.add(Rot.mulVec2(a2.q, b2.p), a2.p);\n      return xf2;\n    };\n    Transform2.mulT = function(a2, b2) {\n      if (\"x\" in b2 && \"y\" in b2) {\n        return Transform2.mulTVec2(a2, b2);\n      } else if (\"p\" in b2 && \"q\" in b2) {\n        return Transform2.mulTXf(a2, b2);\n      }\n    };\n    Transform2.mulTVec2 = function(a2, b2) {\n      var px = b2.x - a2.p.x;\n      var py = b2.y - a2.p.y;\n      var x2 = a2.q.c * px + a2.q.s * py;\n      var y = -a2.q.s * px + a2.q.c * py;\n      return Vec2.neo(x2, y);\n    };\n    Transform2.mulTXf = function(a2, b2) {\n      var xf2 = Transform2.identity();\n      xf2.q.setRot(Rot.mulTRot(a2.q, b2.q));\n      xf2.p.setVec2(Rot.mulTVec2(a2.q, Vec2.sub(b2.p, a2.p)));\n      return xf2;\n    };\n    return Transform2;\n  }()\n);\nvar Velocity = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function Velocity2() {\n      this.v = Vec2.zero();\n      this.w = 0;\n    }\n    return Velocity2;\n  }()\n);\nvar math_sin = Math.sin;\nvar math_cos = Math.cos;\nvar Position = (\n  /** @class */\n  function() {\n    function Position2() {\n      this.c = Vec2.zero();\n      this.a = 0;\n    }\n    Position2.prototype.getTransform = function(xf2, p) {\n      xf2.q.c = math_cos(this.a);\n      xf2.q.s = math_sin(this.a);\n      xf2.p.x = this.c.x - (xf2.q.c * p.x - xf2.q.s * p.y);\n      xf2.p.y = this.c.y - (xf2.q.s * p.x + xf2.q.c * p.y);\n      return xf2;\n    };\n    return Position2;\n  }()\n);\nfunction getTransform(xf2, p, c2, a2) {\n  xf2.q.c = math_cos(a2);\n  xf2.q.s = math_sin(a2);\n  xf2.p.x = c2.x - (xf2.q.c * p.x - xf2.q.s * p.y);\n  xf2.p.y = c2.y - (xf2.q.s * p.x + xf2.q.c * p.y);\n  return xf2;\n}\nvar Shape = (\n  /** @class */\n  function() {\n    function Shape2() {\n      this.style = {};\n      this.appData = {};\n    }\n    Shape2.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return typeof obj.m_type === \"string\" && typeof obj.m_radius === \"number\";\n    };\n    return Shape2;\n  }()\n);\nvar synchronize_aabb1 = new AABB();\nvar synchronize_aabb2 = new AABB();\nvar displacement = vec2(0, 0);\nvar FixtureDefDefault = {\n  userData: null,\n  friction: 0.2,\n  restitution: 0,\n  density: 0,\n  isSensor: false,\n  filterGroupIndex: 0,\n  filterCategoryBits: 1,\n  filterMaskBits: 65535\n};\nvar FixtureProxy = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function FixtureProxy2(fixture, childIndex) {\n      this.aabb = new AABB();\n      this.fixture = fixture;\n      this.childIndex = childIndex;\n    }\n    return FixtureProxy2;\n  }()\n);\nvar Fixture = (\n  /** @class */\n  function() {\n    function Fixture2(body, shape, def) {\n      this.style = {};\n      this.appData = {};\n      if (shape.shape) {\n        def = shape;\n        shape = shape.shape;\n      } else if (typeof def === \"number\") {\n        def = { density: def };\n      }\n      def = options(def, FixtureDefDefault);\n      this.m_body = body;\n      this.m_friction = def.friction;\n      this.m_restitution = def.restitution;\n      this.m_density = def.density;\n      this.m_isSensor = def.isSensor;\n      this.m_filterGroupIndex = def.filterGroupIndex;\n      this.m_filterCategoryBits = def.filterCategoryBits;\n      this.m_filterMaskBits = def.filterMaskBits;\n      this.m_shape = shape;\n      this.m_next = null;\n      this.m_proxies = [];\n      this.m_proxyCount = 0;\n      var childCount = this.m_shape.getChildCount();\n      for (var i = 0; i < childCount; ++i) {\n        this.m_proxies[i] = new FixtureProxy(this, i);\n      }\n      this.m_userData = def.userData;\n      if (typeof def.style === \"object\" && def.style !== null) {\n        this.style = def.style;\n      }\n    }\n    Fixture2.prototype._reset = function() {\n      var body = this.getBody();\n      var broadPhase = body.m_world.m_broadPhase;\n      this.destroyProxies(broadPhase);\n      if (this.m_shape._reset) {\n        this.m_shape._reset();\n      }\n      var childCount = this.m_shape.getChildCount();\n      for (var i = 0; i < childCount; ++i) {\n        this.m_proxies[i] = new FixtureProxy(this, i);\n      }\n      this.createProxies(broadPhase, body.m_xf);\n      body.resetMassData();\n    };\n    Fixture2.prototype._serialize = function() {\n      return {\n        friction: this.m_friction,\n        restitution: this.m_restitution,\n        density: this.m_density,\n        isSensor: this.m_isSensor,\n        filterGroupIndex: this.m_filterGroupIndex,\n        filterCategoryBits: this.m_filterCategoryBits,\n        filterMaskBits: this.m_filterMaskBits,\n        shape: this.m_shape\n      };\n    };\n    Fixture2._deserialize = function(data, body, restore) {\n      var shape = restore(Shape, data.shape);\n      var fixture = shape && new Fixture2(body, shape, data);\n      return fixture;\n    };\n    Fixture2.prototype.getType = function() {\n      return this.m_shape.m_type;\n    };\n    Fixture2.prototype.getShape = function() {\n      return this.m_shape;\n    };\n    Fixture2.prototype.isSensor = function() {\n      return this.m_isSensor;\n    };\n    Fixture2.prototype.setSensor = function(sensor) {\n      if (sensor != this.m_isSensor) {\n        this.m_body.setAwake(true);\n        this.m_isSensor = sensor;\n      }\n    };\n    Fixture2.prototype.getUserData = function() {\n      return this.m_userData;\n    };\n    Fixture2.prototype.setUserData = function(data) {\n      this.m_userData = data;\n    };\n    Fixture2.prototype.getBody = function() {\n      return this.m_body;\n    };\n    Fixture2.prototype.getNext = function() {\n      return this.m_next;\n    };\n    Fixture2.prototype.getDensity = function() {\n      return this.m_density;\n    };\n    Fixture2.prototype.setDensity = function(density) {\n      this.m_density = density;\n    };\n    Fixture2.prototype.getFriction = function() {\n      return this.m_friction;\n    };\n    Fixture2.prototype.setFriction = function(friction) {\n      this.m_friction = friction;\n    };\n    Fixture2.prototype.getRestitution = function() {\n      return this.m_restitution;\n    };\n    Fixture2.prototype.setRestitution = function(restitution) {\n      this.m_restitution = restitution;\n    };\n    Fixture2.prototype.testPoint = function(p) {\n      return this.m_shape.testPoint(this.m_body.getTransform(), p);\n    };\n    Fixture2.prototype.rayCast = function(output2, input2, childIndex) {\n      return this.m_shape.rayCast(output2, input2, this.m_body.getTransform(), childIndex);\n    };\n    Fixture2.prototype.getMassData = function(massData) {\n      this.m_shape.computeMass(massData, this.m_density);\n    };\n    Fixture2.prototype.getAABB = function(childIndex) {\n      return this.m_proxies[childIndex].aabb;\n    };\n    Fixture2.prototype.createProxies = function(broadPhase, xf2) {\n      this.m_proxyCount = this.m_shape.getChildCount();\n      for (var i = 0; i < this.m_proxyCount; ++i) {\n        var proxy = this.m_proxies[i];\n        this.m_shape.computeAABB(proxy.aabb, xf2, i);\n        proxy.proxyId = broadPhase.createProxy(proxy.aabb, proxy);\n      }\n    };\n    Fixture2.prototype.destroyProxies = function(broadPhase) {\n      for (var i = 0; i < this.m_proxyCount; ++i) {\n        var proxy = this.m_proxies[i];\n        broadPhase.destroyProxy(proxy.proxyId);\n        proxy.proxyId = null;\n      }\n      this.m_proxyCount = 0;\n    };\n    Fixture2.prototype.synchronize = function(broadPhase, xf1, xf2) {\n      for (var i = 0; i < this.m_proxyCount; ++i) {\n        var proxy = this.m_proxies[i];\n        this.m_shape.computeAABB(synchronize_aabb1, xf1, proxy.childIndex);\n        this.m_shape.computeAABB(synchronize_aabb2, xf2, proxy.childIndex);\n        proxy.aabb.combine(synchronize_aabb1, synchronize_aabb2);\n        subVec2(displacement, xf2.p, xf1.p);\n        broadPhase.moveProxy(proxy.proxyId, proxy.aabb, displacement);\n      }\n    };\n    Fixture2.prototype.setFilterData = function(filter) {\n      this.m_filterGroupIndex = filter.groupIndex;\n      this.m_filterCategoryBits = filter.categoryBits;\n      this.m_filterMaskBits = filter.maskBits;\n      this.refilter();\n    };\n    Fixture2.prototype.getFilterGroupIndex = function() {\n      return this.m_filterGroupIndex;\n    };\n    Fixture2.prototype.setFilterGroupIndex = function(groupIndex) {\n      this.m_filterGroupIndex = groupIndex;\n      this.refilter();\n    };\n    Fixture2.prototype.getFilterCategoryBits = function() {\n      return this.m_filterCategoryBits;\n    };\n    Fixture2.prototype.setFilterCategoryBits = function(categoryBits) {\n      this.m_filterCategoryBits = categoryBits;\n      this.refilter();\n    };\n    Fixture2.prototype.getFilterMaskBits = function() {\n      return this.m_filterMaskBits;\n    };\n    Fixture2.prototype.setFilterMaskBits = function(maskBits) {\n      this.m_filterMaskBits = maskBits;\n      this.refilter();\n    };\n    Fixture2.prototype.refilter = function() {\n      if (this.m_body == null) {\n        return;\n      }\n      var edge = this.m_body.getContactList();\n      while (edge) {\n        var contact = edge.contact;\n        var fixtureA = contact.getFixtureA();\n        var fixtureB = contact.getFixtureB();\n        if (fixtureA == this || fixtureB == this) {\n          contact.flagForFiltering();\n        }\n        edge = edge.next;\n      }\n      var world = this.m_body.getWorld();\n      if (world == null) {\n        return;\n      }\n      var broadPhase = world.m_broadPhase;\n      for (var i = 0; i < this.m_proxyCount; ++i) {\n        broadPhase.touchProxy(this.m_proxies[i].proxyId);\n      }\n    };\n    Fixture2.prototype.shouldCollide = function(that) {\n      if (that.m_filterGroupIndex === this.m_filterGroupIndex && that.m_filterGroupIndex !== 0) {\n        return that.m_filterGroupIndex > 0;\n      }\n      var collideA = (that.m_filterMaskBits & this.m_filterCategoryBits) !== 0;\n      var collideB = (that.m_filterCategoryBits & this.m_filterMaskBits) !== 0;\n      var collide = collideA && collideB;\n      return collide;\n    };\n    return Fixture2;\n  }()\n);\nvar STATIC = \"static\";\nvar KINEMATIC = \"kinematic\";\nvar DYNAMIC = \"dynamic\";\nvar oldCenter = vec2(0, 0);\nvar localCenter = vec2(0, 0);\nvar shift = vec2(0, 0);\nvar temp$6 = vec2(0, 0);\nvar xf$2 = transform(0, 0, 0);\nvar BodyDefDefault = {\n  type: STATIC,\n  position: Vec2.zero(),\n  angle: 0,\n  linearVelocity: Vec2.zero(),\n  angularVelocity: 0,\n  linearDamping: 0,\n  angularDamping: 0,\n  fixedRotation: false,\n  bullet: false,\n  gravityScale: 1,\n  allowSleep: true,\n  awake: true,\n  active: true,\n  userData: null\n};\nvar Body = (\n  /** @class */\n  function() {\n    function Body2(world, def) {\n      this.style = {};\n      this.appData = {};\n      def = options(def, BodyDefDefault);\n      this.m_world = world;\n      this.m_awakeFlag = def.awake;\n      this.m_autoSleepFlag = def.allowSleep;\n      this.m_bulletFlag = def.bullet;\n      this.m_fixedRotationFlag = def.fixedRotation;\n      this.m_activeFlag = def.active;\n      this.m_islandFlag = false;\n      this.m_toiFlag = false;\n      this.m_userData = def.userData;\n      this.m_type = def.type;\n      if (this.m_type == DYNAMIC) {\n        this.m_mass = 1;\n        this.m_invMass = 1;\n      } else {\n        this.m_mass = 0;\n        this.m_invMass = 0;\n      }\n      this.m_I = 0;\n      this.m_invI = 0;\n      this.m_xf = Transform.identity();\n      this.m_xf.p.setVec2(def.position);\n      this.m_xf.q.setAngle(def.angle);\n      this.m_sweep = new Sweep();\n      this.m_sweep.setTransform(this.m_xf);\n      this.c_velocity = new Velocity();\n      this.c_position = new Position();\n      this.m_force = Vec2.zero();\n      this.m_torque = 0;\n      this.m_linearVelocity = Vec2.clone(def.linearVelocity);\n      this.m_angularVelocity = def.angularVelocity;\n      this.m_linearDamping = def.linearDamping;\n      this.m_angularDamping = def.angularDamping;\n      this.m_gravityScale = def.gravityScale;\n      this.m_sleepTime = 0;\n      this.m_jointList = null;\n      this.m_contactList = null;\n      this.m_fixtureList = null;\n      this.m_prev = null;\n      this.m_next = null;\n      this.m_destroyed = false;\n      if (typeof def.style === \"object\" && def.style !== null) {\n        this.style = def.style;\n      }\n    }\n    Body2.prototype._serialize = function() {\n      var fixtures = [];\n      for (var f = this.m_fixtureList; f; f = f.m_next) {\n        fixtures.push(f);\n      }\n      return {\n        type: this.m_type,\n        bullet: this.m_bulletFlag,\n        position: this.m_xf.p,\n        angle: this.m_xf.q.getAngle(),\n        linearVelocity: this.m_linearVelocity,\n        angularVelocity: this.m_angularVelocity,\n        fixtures\n      };\n    };\n    Body2._deserialize = function(data, world, restore) {\n      var body = new Body2(world, data);\n      if (data.fixtures) {\n        for (var i = data.fixtures.length - 1; i >= 0; i--) {\n          var fixture = restore(Fixture, data.fixtures[i], body);\n          body._addFixture(fixture);\n        }\n      }\n      return body;\n    };\n    Body2.prototype.isWorldLocked = function() {\n      return this.m_world && this.m_world.isLocked() ? true : false;\n    };\n    Body2.prototype.getWorld = function() {\n      return this.m_world;\n    };\n    Body2.prototype.getNext = function() {\n      return this.m_next;\n    };\n    Body2.prototype.setUserData = function(data) {\n      this.m_userData = data;\n    };\n    Body2.prototype.getUserData = function() {\n      return this.m_userData;\n    };\n    Body2.prototype.getFixtureList = function() {\n      return this.m_fixtureList;\n    };\n    Body2.prototype.getJointList = function() {\n      return this.m_jointList;\n    };\n    Body2.prototype.getContactList = function() {\n      return this.m_contactList;\n    };\n    Body2.prototype.isStatic = function() {\n      return this.m_type == STATIC;\n    };\n    Body2.prototype.isDynamic = function() {\n      return this.m_type == DYNAMIC;\n    };\n    Body2.prototype.isKinematic = function() {\n      return this.m_type == KINEMATIC;\n    };\n    Body2.prototype.setStatic = function() {\n      this.setType(STATIC);\n      return this;\n    };\n    Body2.prototype.setDynamic = function() {\n      this.setType(DYNAMIC);\n      return this;\n    };\n    Body2.prototype.setKinematic = function() {\n      this.setType(KINEMATIC);\n      return this;\n    };\n    Body2.prototype.getType = function() {\n      return this.m_type;\n    };\n    Body2.prototype.setType = function(type) {\n      if (this.isWorldLocked() == true) {\n        return;\n      }\n      if (this.m_type == type) {\n        return;\n      }\n      this.m_type = type;\n      this.resetMassData();\n      if (this.m_type == STATIC) {\n        this.m_linearVelocity.setZero();\n        this.m_angularVelocity = 0;\n        this.m_sweep.forward();\n        this.synchronizeFixtures();\n      }\n      this.setAwake(true);\n      this.m_force.setZero();\n      this.m_torque = 0;\n      var ce = this.m_contactList;\n      while (ce) {\n        var ce0 = ce;\n        ce = ce.next;\n        this.m_world.destroyContact(ce0.contact);\n      }\n      this.m_contactList = null;\n      var broadPhase = this.m_world.m_broadPhase;\n      for (var f = this.m_fixtureList; f; f = f.m_next) {\n        for (var i = 0; i < f.m_proxyCount; ++i) {\n          broadPhase.touchProxy(f.m_proxies[i].proxyId);\n        }\n      }\n    };\n    Body2.prototype.isBullet = function() {\n      return this.m_bulletFlag;\n    };\n    Body2.prototype.setBullet = function(flag) {\n      this.m_bulletFlag = !!flag;\n    };\n    Body2.prototype.isSleepingAllowed = function() {\n      return this.m_autoSleepFlag;\n    };\n    Body2.prototype.setSleepingAllowed = function(flag) {\n      this.m_autoSleepFlag = !!flag;\n      if (this.m_autoSleepFlag == false) {\n        this.setAwake(true);\n      }\n    };\n    Body2.prototype.isAwake = function() {\n      return this.m_awakeFlag;\n    };\n    Body2.prototype.setAwake = function(flag) {\n      if (flag) {\n        this.m_awakeFlag = true;\n        this.m_sleepTime = 0;\n      } else {\n        this.m_awakeFlag = false;\n        this.m_sleepTime = 0;\n        this.m_linearVelocity.setZero();\n        this.m_angularVelocity = 0;\n        this.m_force.setZero();\n        this.m_torque = 0;\n      }\n    };\n    Body2.prototype.isActive = function() {\n      return this.m_activeFlag;\n    };\n    Body2.prototype.setActive = function(flag) {\n      if (flag == this.m_activeFlag) {\n        return;\n      }\n      this.m_activeFlag = !!flag;\n      if (this.m_activeFlag) {\n        var broadPhase = this.m_world.m_broadPhase;\n        for (var f = this.m_fixtureList; f; f = f.m_next) {\n          f.createProxies(broadPhase, this.m_xf);\n        }\n        this.m_world.m_newFixture = true;\n      } else {\n        var broadPhase = this.m_world.m_broadPhase;\n        for (var f = this.m_fixtureList; f; f = f.m_next) {\n          f.destroyProxies(broadPhase);\n        }\n        var ce = this.m_contactList;\n        while (ce) {\n          var ce0 = ce;\n          ce = ce.next;\n          this.m_world.destroyContact(ce0.contact);\n        }\n        this.m_contactList = null;\n      }\n    };\n    Body2.prototype.isFixedRotation = function() {\n      return this.m_fixedRotationFlag;\n    };\n    Body2.prototype.setFixedRotation = function(flag) {\n      if (this.m_fixedRotationFlag == flag) {\n        return;\n      }\n      this.m_fixedRotationFlag = !!flag;\n      this.m_angularVelocity = 0;\n      this.resetMassData();\n    };\n    Body2.prototype.getTransform = function() {\n      return this.m_xf;\n    };\n    Body2.prototype.setTransform = function(a2, b2) {\n      if (this.isWorldLocked() == true) {\n        return;\n      }\n      if (typeof b2 === \"number\") {\n        this.m_xf.setNum(a2, b2);\n      } else {\n        this.m_xf.setTransform(a2);\n      }\n      this.m_sweep.setTransform(this.m_xf);\n      var broadPhase = this.m_world.m_broadPhase;\n      for (var f = this.m_fixtureList; f; f = f.m_next) {\n        f.synchronize(broadPhase, this.m_xf, this.m_xf);\n      }\n      this.setAwake(true);\n    };\n    Body2.prototype.synchronizeTransform = function() {\n      this.m_sweep.getTransform(this.m_xf, 1);\n    };\n    Body2.prototype.synchronizeFixtures = function() {\n      this.m_sweep.getTransform(xf$2, 0);\n      var broadPhase = this.m_world.m_broadPhase;\n      for (var f = this.m_fixtureList; f; f = f.m_next) {\n        f.synchronize(broadPhase, xf$2, this.m_xf);\n      }\n    };\n    Body2.prototype.advance = function(alpha) {\n      this.m_sweep.advance(alpha);\n      copyVec2(this.m_sweep.c, this.m_sweep.c0);\n      this.m_sweep.a = this.m_sweep.a0;\n      this.m_sweep.getTransform(this.m_xf, 1);\n    };\n    Body2.prototype.getPosition = function() {\n      return this.m_xf.p;\n    };\n    Body2.prototype.setPosition = function(p) {\n      this.setTransform(p, this.m_sweep.a);\n    };\n    Body2.prototype.getAngle = function() {\n      return this.m_sweep.a;\n    };\n    Body2.prototype.setAngle = function(angle) {\n      this.setTransform(this.m_xf.p, angle);\n    };\n    Body2.prototype.getWorldCenter = function() {\n      return this.m_sweep.c;\n    };\n    Body2.prototype.getLocalCenter = function() {\n      return this.m_sweep.localCenter;\n    };\n    Body2.prototype.getLinearVelocity = function() {\n      return this.m_linearVelocity;\n    };\n    Body2.prototype.getLinearVelocityFromWorldPoint = function(worldPoint) {\n      var localCenter2 = Vec2.sub(worldPoint, this.m_sweep.c);\n      return Vec2.add(this.m_linearVelocity, Vec2.crossNumVec2(this.m_angularVelocity, localCenter2));\n    };\n    Body2.prototype.getLinearVelocityFromLocalPoint = function(localPoint) {\n      return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(localPoint));\n    };\n    Body2.prototype.setLinearVelocity = function(v3) {\n      if (this.m_type == STATIC) {\n        return;\n      }\n      if (Vec2.dot(v3, v3) > 0) {\n        this.setAwake(true);\n      }\n      this.m_linearVelocity.setVec2(v3);\n    };\n    Body2.prototype.getAngularVelocity = function() {\n      return this.m_angularVelocity;\n    };\n    Body2.prototype.setAngularVelocity = function(w) {\n      if (this.m_type == STATIC) {\n        return;\n      }\n      if (w * w > 0) {\n        this.setAwake(true);\n      }\n      this.m_angularVelocity = w;\n    };\n    Body2.prototype.getLinearDamping = function() {\n      return this.m_linearDamping;\n    };\n    Body2.prototype.setLinearDamping = function(linearDamping) {\n      this.m_linearDamping = linearDamping;\n    };\n    Body2.prototype.getAngularDamping = function() {\n      return this.m_angularDamping;\n    };\n    Body2.prototype.setAngularDamping = function(angularDamping) {\n      this.m_angularDamping = angularDamping;\n    };\n    Body2.prototype.getGravityScale = function() {\n      return this.m_gravityScale;\n    };\n    Body2.prototype.setGravityScale = function(scale) {\n      this.m_gravityScale = scale;\n    };\n    Body2.prototype.getMass = function() {\n      return this.m_mass;\n    };\n    Body2.prototype.getInertia = function() {\n      return this.m_I + this.m_mass * Vec2.dot(this.m_sweep.localCenter, this.m_sweep.localCenter);\n    };\n    Body2.prototype.getMassData = function(data) {\n      data.mass = this.m_mass;\n      data.I = this.getInertia();\n      copyVec2(data.center, this.m_sweep.localCenter);\n    };\n    Body2.prototype.resetMassData = function() {\n      this.m_mass = 0;\n      this.m_invMass = 0;\n      this.m_I = 0;\n      this.m_invI = 0;\n      zeroVec2(this.m_sweep.localCenter);\n      if (this.isStatic() || this.isKinematic()) {\n        copyVec2(this.m_sweep.c0, this.m_xf.p);\n        copyVec2(this.m_sweep.c, this.m_xf.p);\n        this.m_sweep.a0 = this.m_sweep.a;\n        return;\n      }\n      zeroVec2(localCenter);\n      for (var f = this.m_fixtureList; f; f = f.m_next) {\n        if (f.m_density == 0) {\n          continue;\n        }\n        var massData = {\n          mass: 0,\n          center: vec2(0, 0),\n          I: 0\n        };\n        f.getMassData(massData);\n        this.m_mass += massData.mass;\n        plusScaleVec2(localCenter, massData.mass, massData.center);\n        this.m_I += massData.I;\n      }\n      if (this.m_mass > 0) {\n        this.m_invMass = 1 / this.m_mass;\n        scaleVec2(localCenter, this.m_invMass, localCenter);\n      } else {\n        this.m_mass = 1;\n        this.m_invMass = 1;\n      }\n      if (this.m_I > 0 && this.m_fixedRotationFlag == false) {\n        this.m_I -= this.m_mass * dotVec2(localCenter, localCenter);\n        this.m_invI = 1 / this.m_I;\n      } else {\n        this.m_I = 0;\n        this.m_invI = 0;\n      }\n      copyVec2(oldCenter, this.m_sweep.c);\n      this.m_sweep.setLocalCenter(localCenter, this.m_xf);\n      subVec2(shift, this.m_sweep.c, oldCenter);\n      crossNumVec2(temp$6, this.m_angularVelocity, shift);\n      plusVec2(this.m_linearVelocity, temp$6);\n    };\n    Body2.prototype.setMassData = function(massData) {\n      if (this.isWorldLocked() == true) {\n        return;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      this.m_invMass = 0;\n      this.m_I = 0;\n      this.m_invI = 0;\n      this.m_mass = massData.mass;\n      if (this.m_mass <= 0) {\n        this.m_mass = 1;\n      }\n      this.m_invMass = 1 / this.m_mass;\n      if (massData.I > 0 && this.m_fixedRotationFlag == false) {\n        this.m_I = massData.I - this.m_mass * dotVec2(massData.center, massData.center);\n        this.m_invI = 1 / this.m_I;\n      }\n      copyVec2(oldCenter, this.m_sweep.c);\n      this.m_sweep.setLocalCenter(massData.center, this.m_xf);\n      subVec2(shift, this.m_sweep.c, oldCenter);\n      crossNumVec2(temp$6, this.m_angularVelocity, shift);\n      plusVec2(this.m_linearVelocity, temp$6);\n    };\n    Body2.prototype.applyForce = function(force, point2, wake) {\n      if (wake === void 0) {\n        wake = true;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      if (wake && this.m_awakeFlag == false) {\n        this.setAwake(true);\n      }\n      if (this.m_awakeFlag) {\n        this.m_force.add(force);\n        this.m_torque += Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), force);\n      }\n    };\n    Body2.prototype.applyForceToCenter = function(force, wake) {\n      if (wake === void 0) {\n        wake = true;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      if (wake && this.m_awakeFlag == false) {\n        this.setAwake(true);\n      }\n      if (this.m_awakeFlag) {\n        this.m_force.add(force);\n      }\n    };\n    Body2.prototype.applyTorque = function(torque, wake) {\n      if (wake === void 0) {\n        wake = true;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      if (wake && this.m_awakeFlag == false) {\n        this.setAwake(true);\n      }\n      if (this.m_awakeFlag) {\n        this.m_torque += torque;\n      }\n    };\n    Body2.prototype.applyLinearImpulse = function(impulse, point2, wake) {\n      if (wake === void 0) {\n        wake = true;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      if (wake && this.m_awakeFlag == false) {\n        this.setAwake(true);\n      }\n      if (this.m_awakeFlag) {\n        this.m_linearVelocity.addMul(this.m_invMass, impulse);\n        this.m_angularVelocity += this.m_invI * Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), impulse);\n      }\n    };\n    Body2.prototype.applyAngularImpulse = function(impulse, wake) {\n      if (wake === void 0) {\n        wake = true;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      if (wake && this.m_awakeFlag == false) {\n        this.setAwake(true);\n      }\n      if (this.m_awakeFlag) {\n        this.m_angularVelocity += this.m_invI * impulse;\n      }\n    };\n    Body2.prototype.shouldCollide = function(that) {\n      if (this.m_type != DYNAMIC && that.m_type != DYNAMIC) {\n        return false;\n      }\n      for (var jn = this.m_jointList; jn; jn = jn.next) {\n        if (jn.other == that) {\n          if (jn.joint.m_collideConnected == false) {\n            return false;\n          }\n        }\n      }\n      return true;\n    };\n    Body2.prototype._addFixture = function(fixture) {\n      if (this.isWorldLocked() == true) {\n        return null;\n      }\n      if (this.m_activeFlag) {\n        var broadPhase = this.m_world.m_broadPhase;\n        fixture.createProxies(broadPhase, this.m_xf);\n      }\n      fixture.m_next = this.m_fixtureList;\n      this.m_fixtureList = fixture;\n      if (fixture.m_density > 0) {\n        this.resetMassData();\n      }\n      this.m_world.m_newFixture = true;\n      return fixture;\n    };\n    Body2.prototype.createFixture = function(shape, fixdef) {\n      if (this.isWorldLocked() == true) {\n        return null;\n      }\n      var fixture = new Fixture(this, shape, fixdef);\n      this._addFixture(fixture);\n      return fixture;\n    };\n    Body2.prototype.destroyFixture = function(fixture) {\n      if (this.isWorldLocked() == true) {\n        return;\n      }\n      if (this.m_fixtureList === fixture) {\n        this.m_fixtureList = fixture.m_next;\n      } else {\n        var node = this.m_fixtureList;\n        while (node != null) {\n          if (node.m_next === fixture) {\n            node.m_next = fixture.m_next;\n            break;\n          }\n          node = node.m_next;\n        }\n      }\n      var edge = this.m_contactList;\n      while (edge) {\n        var c2 = edge.contact;\n        edge = edge.next;\n        var fixtureA = c2.getFixtureA();\n        var fixtureB = c2.getFixtureB();\n        if (fixture == fixtureA || fixture == fixtureB) {\n          this.m_world.destroyContact(c2);\n        }\n      }\n      if (this.m_activeFlag) {\n        var broadPhase = this.m_world.m_broadPhase;\n        fixture.destroyProxies(broadPhase);\n      }\n      fixture.m_body = null;\n      fixture.m_next = null;\n      this.m_world.publish(\"remove-fixture\", fixture);\n      this.resetMassData();\n    };\n    Body2.prototype.getWorldPoint = function(localPoint) {\n      return Transform.mulVec2(this.m_xf, localPoint);\n    };\n    Body2.prototype.getWorldVector = function(localVector) {\n      return Rot.mulVec2(this.m_xf.q, localVector);\n    };\n    Body2.prototype.getLocalPoint = function(worldPoint) {\n      return Transform.mulTVec2(this.m_xf, worldPoint);\n    };\n    Body2.prototype.getLocalVector = function(worldVector) {\n      return Rot.mulTVec2(this.m_xf.q, worldVector);\n    };\n    Body2.STATIC = \"static\";\n    Body2.KINEMATIC = \"kinematic\";\n    Body2.DYNAMIC = \"dynamic\";\n    return Body2;\n  }()\n);\nvar JointEdge = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function JointEdge2() {\n      this.other = null;\n      this.joint = null;\n      this.prev = null;\n      this.next = null;\n    }\n    return JointEdge2;\n  }()\n);\nvar Joint = (\n  /** @class */\n  function() {\n    function Joint2(def, bodyA, bodyB) {\n      this.m_type = \"unknown-joint\";\n      this.m_prev = null;\n      this.m_next = null;\n      this.m_edgeA = new JointEdge();\n      this.m_edgeB = new JointEdge();\n      this.m_islandFlag = false;\n      this.style = {};\n      this.appData = {};\n      bodyA = \"bodyA\" in def ? def.bodyA : bodyA;\n      bodyB = \"bodyB\" in def ? def.bodyB : bodyB;\n      this.m_bodyA = bodyA;\n      this.m_bodyB = bodyB;\n      this.m_collideConnected = !!def.collideConnected;\n      this.m_userData = def.userData;\n      if (typeof def.style === \"object\" && def.style !== null) {\n        this.style = def.style;\n      }\n    }\n    Joint2.prototype.isActive = function() {\n      return this.m_bodyA.isActive() && this.m_bodyB.isActive();\n    };\n    Joint2.prototype.getType = function() {\n      return this.m_type;\n    };\n    Joint2.prototype.getBodyA = function() {\n      return this.m_bodyA;\n    };\n    Joint2.prototype.getBodyB = function() {\n      return this.m_bodyB;\n    };\n    Joint2.prototype.getNext = function() {\n      return this.m_next;\n    };\n    Joint2.prototype.getUserData = function() {\n      return this.m_userData;\n    };\n    Joint2.prototype.setUserData = function(data) {\n      this.m_userData = data;\n    };\n    Joint2.prototype.getCollideConnected = function() {\n      return this.m_collideConnected;\n    };\n    Joint2.prototype.shiftOrigin = function(newOrigin) {\n    };\n    Joint2.prototype._resetAnchors = function(def) {\n      return this._reset(def);\n    };\n    return Joint2;\n  }()\n);\nvar stats = {\n  gjkCalls: 0,\n  gjkIters: 0,\n  gjkMaxIters: 0,\n  toiTime: 0,\n  toiMaxTime: 0,\n  toiCalls: 0,\n  toiIters: 0,\n  toiMaxIters: 0,\n  toiRootIters: 0,\n  toiMaxRootIters: 0,\n  toString: function(newline) {\n    newline = typeof newline === \"string\" ? newline : \"\\n\";\n    var string = \"\";\n    for (var name_1 in this) {\n      if (typeof this[name_1] !== \"function\" && typeof this[name_1] !== \"object\") {\n        string += name_1 + \": \" + this[name_1] + newline;\n      }\n    }\n    return string;\n  }\n};\nvar now = function() {\n  return Date.now();\n};\nvar diff = function(time) {\n  return Date.now() - time;\n};\nconst Timer = {\n  now,\n  diff\n};\nvar math_max$4 = Math.max;\nvar temp$5 = vec2(0, 0);\nvar normal$4 = vec2(0, 0);\nvar e12 = vec2(0, 0);\nvar e13 = vec2(0, 0);\nvar e23 = vec2(0, 0);\nvar temp1 = vec2(0, 0);\nvar temp2 = vec2(0, 0);\nstats.gjkCalls = 0;\nstats.gjkIters = 0;\nstats.gjkMaxIters = 0;\nvar DistanceInput = (\n  /** @class */\n  function() {\n    function DistanceInput2() {\n      this.proxyA = new DistanceProxy();\n      this.proxyB = new DistanceProxy();\n      this.transformA = Transform.identity();\n      this.transformB = Transform.identity();\n      this.useRadii = false;\n    }\n    DistanceInput2.prototype.recycle = function() {\n      this.proxyA.recycle();\n      this.proxyB.recycle();\n      this.transformA.setIdentity();\n      this.transformB.setIdentity();\n      this.useRadii = false;\n    };\n    return DistanceInput2;\n  }()\n);\nvar DistanceOutput = (\n  /** @class */\n  function() {\n    function DistanceOutput2() {\n      this.pointA = vec2(0, 0);\n      this.pointB = vec2(0, 0);\n      this.distance = 0;\n      this.iterations = 0;\n    }\n    DistanceOutput2.prototype.recycle = function() {\n      zeroVec2(this.pointA);\n      zeroVec2(this.pointB);\n      this.distance = 0;\n      this.iterations = 0;\n    };\n    return DistanceOutput2;\n  }()\n);\nvar SimplexCache = (\n  /** @class */\n  function() {\n    function SimplexCache2() {\n      this.metric = 0;\n      this.indexA = [];\n      this.indexB = [];\n      this.count = 0;\n    }\n    SimplexCache2.prototype.recycle = function() {\n      this.metric = 0;\n      this.indexA.length = 0;\n      this.indexB.length = 0;\n      this.count = 0;\n    };\n    return SimplexCache2;\n  }()\n);\nvar Distance = function(output2, cache2, input2) {\n  ++stats.gjkCalls;\n  var proxyA = input2.proxyA;\n  var proxyB = input2.proxyB;\n  var xfA2 = input2.transformA;\n  var xfB2 = input2.transformB;\n  simplex.recycle();\n  simplex.readCache(cache2, proxyA, xfA2, proxyB, xfB2);\n  var vertices = simplex.m_v;\n  var k_maxIters = SettingsInternal.maxDistanceIterations;\n  var saveA = [];\n  var saveB = [];\n  var saveCount = 0;\n  var iter = 0;\n  while (iter < k_maxIters) {\n    saveCount = simplex.m_count;\n    for (var i = 0; i < saveCount; ++i) {\n      saveA[i] = vertices[i].indexA;\n      saveB[i] = vertices[i].indexB;\n    }\n    simplex.solve();\n    if (simplex.m_count === 3) {\n      break;\n    }\n    var d2 = simplex.getSearchDirection();\n    if (lengthSqrVec2(d2) < EPSILON * EPSILON) {\n      break;\n    }\n    var vertex = vertices[simplex.m_count];\n    vertex.indexA = proxyA.getSupport(derotVec2(temp$5, xfA2.q, scaleVec2(temp$5, -1, d2)));\n    transformVec2(vertex.wA, xfA2, proxyA.getVertex(vertex.indexA));\n    vertex.indexB = proxyB.getSupport(derotVec2(temp$5, xfB2.q, d2));\n    transformVec2(vertex.wB, xfB2, proxyB.getVertex(vertex.indexB));\n    subVec2(vertex.w, vertex.wB, vertex.wA);\n    ++iter;\n    ++stats.gjkIters;\n    var duplicate = false;\n    for (var i = 0; i < saveCount; ++i) {\n      if (vertex.indexA === saveA[i] && vertex.indexB === saveB[i]) {\n        duplicate = true;\n        break;\n      }\n    }\n    if (duplicate) {\n      break;\n    }\n    ++simplex.m_count;\n  }\n  stats.gjkMaxIters = math_max$4(stats.gjkMaxIters, iter);\n  simplex.getWitnessPoints(output2.pointA, output2.pointB);\n  output2.distance = distVec2(output2.pointA, output2.pointB);\n  output2.iterations = iter;\n  simplex.writeCache(cache2);\n  if (input2.useRadii) {\n    var rA2 = proxyA.m_radius;\n    var rB2 = proxyB.m_radius;\n    if (output2.distance > rA2 + rB2 && output2.distance > EPSILON) {\n      output2.distance -= rA2 + rB2;\n      subVec2(normal$4, output2.pointB, output2.pointA);\n      normalizeVec2(normal$4);\n      plusScaleVec2(output2.pointA, rA2, normal$4);\n      minusScaleVec2(output2.pointB, rB2, normal$4);\n    } else {\n      var p = subVec2(temp$5, output2.pointA, output2.pointB);\n      copyVec2(output2.pointA, p);\n      copyVec2(output2.pointB, p);\n      output2.distance = 0;\n    }\n  }\n};\nvar DistanceProxy = (\n  /** @class */\n  function() {\n    function DistanceProxy2() {\n      this.m_vertices = [];\n      this.m_count = 0;\n      this.m_radius = 0;\n    }\n    DistanceProxy2.prototype.recycle = function() {\n      this.m_vertices.length = 0;\n      this.m_count = 0;\n      this.m_radius = 0;\n    };\n    DistanceProxy2.prototype.getVertexCount = function() {\n      return this.m_count;\n    };\n    DistanceProxy2.prototype.getVertex = function(index) {\n      return this.m_vertices[index];\n    };\n    DistanceProxy2.prototype.getSupport = function(d2) {\n      var bestIndex = -1;\n      var bestValue = -Infinity;\n      for (var i = 0; i < this.m_count; ++i) {\n        var value = dotVec2(this.m_vertices[i], d2);\n        if (value > bestValue) {\n          bestIndex = i;\n          bestValue = value;\n        }\n      }\n      return bestIndex;\n    };\n    DistanceProxy2.prototype.getSupportVertex = function(d2) {\n      return this.m_vertices[this.getSupport(d2)];\n    };\n    DistanceProxy2.prototype.set = function(shape, index) {\n      shape.computeDistanceProxy(this, index);\n    };\n    DistanceProxy2.prototype.setVertices = function(vertices, count, radius) {\n      this.m_vertices = vertices;\n      this.m_count = count;\n      this.m_radius = radius;\n    };\n    return DistanceProxy2;\n  }()\n);\nvar SimplexVertex = (\n  /** @class */\n  function() {\n    function SimplexVertex2() {\n      this.wA = vec2(0, 0);\n      this.indexA = 0;\n      this.wB = vec2(0, 0);\n      this.indexB = 0;\n      this.w = vec2(0, 0);\n      this.a = 0;\n    }\n    SimplexVertex2.prototype.recycle = function() {\n      this.indexA = 0;\n      this.indexB = 0;\n      zeroVec2(this.wA);\n      zeroVec2(this.wB);\n      zeroVec2(this.w);\n      this.a = 0;\n    };\n    SimplexVertex2.prototype.set = function(v3) {\n      this.indexA = v3.indexA;\n      this.indexB = v3.indexB;\n      copyVec2(this.wA, v3.wA);\n      copyVec2(this.wB, v3.wB);\n      copyVec2(this.w, v3.w);\n      this.a = v3.a;\n    };\n    return SimplexVertex2;\n  }()\n);\nvar searchDirection_reuse = vec2(0, 0);\nvar closestPoint_reuse = vec2(0, 0);\nvar Simplex = (\n  /** @class */\n  function() {\n    function Simplex2() {\n      this.m_v1 = new SimplexVertex();\n      this.m_v2 = new SimplexVertex();\n      this.m_v3 = new SimplexVertex();\n      this.m_v = [this.m_v1, this.m_v2, this.m_v3];\n    }\n    Simplex2.prototype.recycle = function() {\n      this.m_v1.recycle();\n      this.m_v2.recycle();\n      this.m_v3.recycle();\n      this.m_count = 0;\n    };\n    Simplex2.prototype.toString = function() {\n      if (this.m_count === 3) {\n        return [\n          \"+\" + this.m_count,\n          this.m_v1.a,\n          this.m_v1.wA.x,\n          this.m_v1.wA.y,\n          this.m_v1.wB.x,\n          this.m_v1.wB.y,\n          this.m_v2.a,\n          this.m_v2.wA.x,\n          this.m_v2.wA.y,\n          this.m_v2.wB.x,\n          this.m_v2.wB.y,\n          this.m_v3.a,\n          this.m_v3.wA.x,\n          this.m_v3.wA.y,\n          this.m_v3.wB.x,\n          this.m_v3.wB.y\n        ].toString();\n      } else if (this.m_count === 2) {\n        return [\n          \"+\" + this.m_count,\n          this.m_v1.a,\n          this.m_v1.wA.x,\n          this.m_v1.wA.y,\n          this.m_v1.wB.x,\n          this.m_v1.wB.y,\n          this.m_v2.a,\n          this.m_v2.wA.x,\n          this.m_v2.wA.y,\n          this.m_v2.wB.x,\n          this.m_v2.wB.y\n        ].toString();\n      } else if (this.m_count === 1) {\n        return [\n          \"+\" + this.m_count,\n          this.m_v1.a,\n          this.m_v1.wA.x,\n          this.m_v1.wA.y,\n          this.m_v1.wB.x,\n          this.m_v1.wB.y\n        ].toString();\n      } else {\n        return \"+\" + this.m_count;\n      }\n    };\n    Simplex2.prototype.readCache = function(cache2, proxyA, transformA, proxyB, transformB) {\n      this.m_count = cache2.count;\n      for (var i = 0; i < this.m_count; ++i) {\n        var v3 = this.m_v[i];\n        v3.indexA = cache2.indexA[i];\n        v3.indexB = cache2.indexB[i];\n        var wALocal = proxyA.getVertex(v3.indexA);\n        var wBLocal = proxyB.getVertex(v3.indexB);\n        transformVec2(v3.wA, transformA, wALocal);\n        transformVec2(v3.wB, transformB, wBLocal);\n        subVec2(v3.w, v3.wB, v3.wA);\n        v3.a = 0;\n      }\n      if (this.m_count > 1) {\n        var metric1 = cache2.metric;\n        var metric2 = this.getMetric();\n        if (metric2 < 0.5 * metric1 || 2 * metric1 < metric2 || metric2 < EPSILON) {\n          this.m_count = 0;\n        }\n      }\n      if (this.m_count === 0) {\n        var v3 = this.m_v[0];\n        v3.indexA = 0;\n        v3.indexB = 0;\n        var wALocal = proxyA.getVertex(0);\n        var wBLocal = proxyB.getVertex(0);\n        transformVec2(v3.wA, transformA, wALocal);\n        transformVec2(v3.wB, transformB, wBLocal);\n        subVec2(v3.w, v3.wB, v3.wA);\n        v3.a = 1;\n        this.m_count = 1;\n      }\n    };\n    Simplex2.prototype.writeCache = function(cache2) {\n      cache2.metric = this.getMetric();\n      cache2.count = this.m_count;\n      for (var i = 0; i < this.m_count; ++i) {\n        cache2.indexA[i] = this.m_v[i].indexA;\n        cache2.indexB[i] = this.m_v[i].indexB;\n      }\n    };\n    Simplex2.prototype.getSearchDirection = function() {\n      var v13 = this.m_v1;\n      var v22 = this.m_v2;\n      switch (this.m_count) {\n        case 1:\n          return setVec2(searchDirection_reuse, -v13.w.x, -v13.w.y);\n        case 2: {\n          subVec2(e12, v22.w, v13.w);\n          var sgn = -crossVec2Vec2(e12, v13.w);\n          if (sgn > 0) {\n            return setVec2(searchDirection_reuse, -e12.y, e12.x);\n          } else {\n            return setVec2(searchDirection_reuse, e12.y, -e12.x);\n          }\n        }\n        default:\n          return zeroVec2(searchDirection_reuse);\n      }\n    };\n    Simplex2.prototype.getClosestPoint = function() {\n      var v13 = this.m_v1;\n      var v22 = this.m_v2;\n      switch (this.m_count) {\n        case 0:\n          return zeroVec2(closestPoint_reuse);\n        case 1:\n          return copyVec2(closestPoint_reuse, v13.w);\n        case 2:\n          return combine2Vec2(closestPoint_reuse, v13.a, v13.w, v22.a, v22.w);\n        case 3:\n          return zeroVec2(closestPoint_reuse);\n        default:\n          return zeroVec2(closestPoint_reuse);\n      }\n    };\n    Simplex2.prototype.getWitnessPoints = function(pA2, pB2) {\n      var v13 = this.m_v1;\n      var v22 = this.m_v2;\n      var v3 = this.m_v3;\n      switch (this.m_count) {\n        case 0:\n          break;\n        case 1:\n          copyVec2(pA2, v13.wA);\n          copyVec2(pB2, v13.wB);\n          break;\n        case 2:\n          combine2Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA);\n          combine2Vec2(pB2, v13.a, v13.wB, v22.a, v22.wB);\n          break;\n        case 3:\n          combine3Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA, v3.a, v3.wA);\n          copyVec2(pB2, pA2);\n          break;\n      }\n    };\n    Simplex2.prototype.getMetric = function() {\n      switch (this.m_count) {\n        case 0:\n          return 0;\n        case 1:\n          return 0;\n        case 2:\n          return distVec2(this.m_v1.w, this.m_v2.w);\n        case 3:\n          return crossVec2Vec2(subVec2(temp1, this.m_v2.w, this.m_v1.w), subVec2(temp2, this.m_v3.w, this.m_v1.w));\n        default:\n          return 0;\n      }\n    };\n    Simplex2.prototype.solve = function() {\n      switch (this.m_count) {\n        case 1:\n          break;\n        case 2:\n          this.solve2();\n          break;\n        case 3:\n          this.solve3();\n          break;\n      }\n    };\n    Simplex2.prototype.solve2 = function() {\n      var w1 = this.m_v1.w;\n      var w2 = this.m_v2.w;\n      subVec2(e12, w2, w1);\n      var d12_2 = -dotVec2(w1, e12);\n      if (d12_2 <= 0) {\n        this.m_v1.a = 1;\n        this.m_count = 1;\n        return;\n      }\n      var d12_1 = dotVec2(w2, e12);\n      if (d12_1 <= 0) {\n        this.m_v2.a = 1;\n        this.m_count = 1;\n        this.m_v1.set(this.m_v2);\n        return;\n      }\n      var inv_d12 = 1 / (d12_1 + d12_2);\n      this.m_v1.a = d12_1 * inv_d12;\n      this.m_v2.a = d12_2 * inv_d12;\n      this.m_count = 2;\n    };\n    Simplex2.prototype.solve3 = function() {\n      var w1 = this.m_v1.w;\n      var w2 = this.m_v2.w;\n      var w3 = this.m_v3.w;\n      subVec2(e12, w2, w1);\n      var w1e12 = dotVec2(w1, e12);\n      var w2e12 = dotVec2(w2, e12);\n      var d12_1 = w2e12;\n      var d12_2 = -w1e12;\n      subVec2(e13, w3, w1);\n      var w1e13 = dotVec2(w1, e13);\n      var w3e13 = dotVec2(w3, e13);\n      var d13_1 = w3e13;\n      var d13_2 = -w1e13;\n      subVec2(e23, w3, w2);\n      var w2e23 = dotVec2(w2, e23);\n      var w3e23 = dotVec2(w3, e23);\n      var d23_1 = w3e23;\n      var d23_2 = -w2e23;\n      var n123 = crossVec2Vec2(e12, e13);\n      var d123_1 = n123 * crossVec2Vec2(w2, w3);\n      var d123_2 = n123 * crossVec2Vec2(w3, w1);\n      var d123_3 = n123 * crossVec2Vec2(w1, w2);\n      if (d12_2 <= 0 && d13_2 <= 0) {\n        this.m_v1.a = 1;\n        this.m_count = 1;\n        return;\n      }\n      if (d12_1 > 0 && d12_2 > 0 && d123_3 <= 0) {\n        var inv_d12 = 1 / (d12_1 + d12_2);\n        this.m_v1.a = d12_1 * inv_d12;\n        this.m_v2.a = d12_2 * inv_d12;\n        this.m_count = 2;\n        return;\n      }\n      if (d13_1 > 0 && d13_2 > 0 && d123_2 <= 0) {\n        var inv_d13 = 1 / (d13_1 + d13_2);\n        this.m_v1.a = d13_1 * inv_d13;\n        this.m_v3.a = d13_2 * inv_d13;\n        this.m_count = 2;\n        this.m_v2.set(this.m_v3);\n        return;\n      }\n      if (d12_1 <= 0 && d23_2 <= 0) {\n        this.m_v2.a = 1;\n        this.m_count = 1;\n        this.m_v1.set(this.m_v2);\n        return;\n      }\n      if (d13_1 <= 0 && d23_1 <= 0) {\n        this.m_v3.a = 1;\n        this.m_count = 1;\n        this.m_v1.set(this.m_v3);\n        return;\n      }\n      if (d23_1 > 0 && d23_2 > 0 && d123_1 <= 0) {\n        var inv_d23 = 1 / (d23_1 + d23_2);\n        this.m_v2.a = d23_1 * inv_d23;\n        this.m_v3.a = d23_2 * inv_d23;\n        this.m_count = 2;\n        this.m_v1.set(this.m_v3);\n        return;\n      }\n      var inv_d123 = 1 / (d123_1 + d123_2 + d123_3);\n      this.m_v1.a = d123_1 * inv_d123;\n      this.m_v2.a = d123_2 * inv_d123;\n      this.m_v3.a = d123_3 * inv_d123;\n      this.m_count = 3;\n    };\n    return Simplex2;\n  }()\n);\nvar simplex = new Simplex();\nvar input$1 = new DistanceInput();\nvar cache$1 = new SimplexCache();\nvar output$1 = new DistanceOutput();\nvar testOverlap = function(shapeA, indexA, shapeB, indexB, xfA2, xfB2) {\n  input$1.recycle();\n  input$1.proxyA.set(shapeA, indexA);\n  input$1.proxyB.set(shapeB, indexB);\n  copyTransform(input$1.transformA, xfA2);\n  copyTransform(input$1.transformB, xfB2);\n  input$1.useRadii = true;\n  output$1.recycle();\n  cache$1.recycle();\n  Distance(output$1, cache$1, input$1);\n  return output$1.distance < 10 * EPSILON;\n};\nDistance.testOverlap = testOverlap;\nDistance.Input = DistanceInput;\nDistance.Output = DistanceOutput;\nDistance.Proxy = DistanceProxy;\nDistance.Cache = SimplexCache;\nvar ShapeCastInput = (\n  /** @class */\n  function() {\n    function ShapeCastInput2() {\n      this.proxyA = new DistanceProxy();\n      this.proxyB = new DistanceProxy();\n      this.transformA = Transform.identity();\n      this.transformB = Transform.identity();\n      this.translationB = Vec2.zero();\n    }\n    ShapeCastInput2.prototype.recycle = function() {\n      this.proxyA.recycle();\n      this.proxyB.recycle();\n      this.transformA.setIdentity();\n      this.transformB.setIdentity();\n      zeroVec2(this.translationB);\n    };\n    return ShapeCastInput2;\n  }()\n);\nvar ShapeCastOutput = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function ShapeCastOutput2() {\n      this.point = Vec2.zero();\n      this.normal = Vec2.zero();\n      this.lambda = 1;\n      this.iterations = 0;\n    }\n    return ShapeCastOutput2;\n  }()\n);\nvar ShapeCast = function(output2, input2) {\n  output2.iterations = 0;\n  output2.lambda = 1;\n  output2.normal.setZero();\n  output2.point.setZero();\n  var proxyA = input2.proxyA;\n  var proxyB = input2.proxyB;\n  var radiusA = math_max$4(proxyA.m_radius, SettingsInternal.polygonRadius);\n  var radiusB = math_max$4(proxyB.m_radius, SettingsInternal.polygonRadius);\n  var radius = radiusA + radiusB;\n  var xfA2 = input2.transformA;\n  var xfB2 = input2.transformB;\n  var r = input2.translationB;\n  var n2 = Vec2.zero();\n  var lambda = 0;\n  var simplex2 = new Simplex();\n  simplex2.m_count = 0;\n  var vertices = simplex2.m_v;\n  var indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(r)));\n  var wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));\n  var indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, r));\n  var wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));\n  var v3 = Vec2.sub(wA, wB);\n  var sigma = math_max$4(SettingsInternal.polygonRadius, radius - SettingsInternal.polygonRadius);\n  var tolerance = 0.5 * SettingsInternal.linearSlop;\n  var k_maxIters = 20;\n  var iter = 0;\n  while (iter < k_maxIters && v3.length() - sigma > tolerance) {\n    output2.iterations += 1;\n    indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(v3)));\n    wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));\n    indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, v3));\n    wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));\n    var p = Vec2.sub(wA, wB);\n    v3.normalize();\n    var vp = Vec2.dot(v3, p);\n    var vr = Vec2.dot(v3, r);\n    if (vp - sigma > lambda * vr) {\n      if (vr <= 0) {\n        return false;\n      }\n      lambda = (vp - sigma) / vr;\n      if (lambda > 1) {\n        return false;\n      }\n      n2.setMul(-1, v3);\n      simplex2.m_count = 0;\n    }\n    var vertex = vertices[simplex2.m_count];\n    vertex.indexA = indexB;\n    vertex.wA = Vec2.combine(1, wB, lambda, r);\n    vertex.indexB = indexA;\n    vertex.wB = wA;\n    vertex.w = Vec2.sub(vertex.wB, vertex.wA);\n    vertex.a = 1;\n    simplex2.m_count += 1;\n    switch (simplex2.m_count) {\n      case 1:\n        break;\n      case 2:\n        simplex2.solve2();\n        break;\n      case 3:\n        simplex2.solve3();\n        break;\n    }\n    if (simplex2.m_count == 3) {\n      return false;\n    }\n    v3.setVec2(simplex2.getClosestPoint());\n    ++iter;\n  }\n  if (iter == 0) {\n    return false;\n  }\n  var pointA2 = Vec2.zero();\n  var pointB2 = Vec2.zero();\n  simplex2.getWitnessPoints(pointB2, pointA2);\n  if (v3.lengthSquared() > 0) {\n    n2.setMul(-1, v3);\n    n2.normalize();\n  }\n  output2.point = Vec2.combine(1, pointA2, radiusA, n2);\n  output2.normal = n2;\n  output2.lambda = lambda;\n  output2.iterations = iter;\n  return true;\n};\nvar math_abs$7 = Math.abs;\nvar math_max$3 = Math.max;\nvar TOIInput = (\n  /** @class */\n  function() {\n    function TOIInput2() {\n      this.proxyA = new DistanceProxy();\n      this.proxyB = new DistanceProxy();\n      this.sweepA = new Sweep();\n      this.sweepB = new Sweep();\n    }\n    TOIInput2.prototype.recycle = function() {\n      this.proxyA.recycle();\n      this.proxyB.recycle();\n      this.sweepA.recycle();\n      this.sweepB.recycle();\n      this.tMax = -1;\n    };\n    return TOIInput2;\n  }()\n);\nvar TOIOutputState;\n(function(TOIOutputState2) {\n  TOIOutputState2[TOIOutputState2[\"e_unset\"] = -1] = \"e_unset\";\n  TOIOutputState2[TOIOutputState2[\"e_unknown\"] = 0] = \"e_unknown\";\n  TOIOutputState2[TOIOutputState2[\"e_failed\"] = 1] = \"e_failed\";\n  TOIOutputState2[TOIOutputState2[\"e_overlapped\"] = 2] = \"e_overlapped\";\n  TOIOutputState2[TOIOutputState2[\"e_touching\"] = 3] = \"e_touching\";\n  TOIOutputState2[TOIOutputState2[\"e_separated\"] = 4] = \"e_separated\";\n})(TOIOutputState || (TOIOutputState = {}));\nvar TOIOutput = (\n  /** @class */\n  function() {\n    function TOIOutput2() {\n      this.state = TOIOutputState.e_unset;\n      this.t = -1;\n    }\n    TOIOutput2.prototype.recycle = function() {\n      this.state = TOIOutputState.e_unset;\n      this.t = -1;\n    };\n    return TOIOutput2;\n  }()\n);\nstats.toiTime = 0;\nstats.toiMaxTime = 0;\nstats.toiCalls = 0;\nstats.toiIters = 0;\nstats.toiMaxIters = 0;\nstats.toiRootIters = 0;\nstats.toiMaxRootIters = 0;\nvar distanceInput = new DistanceInput();\nvar distanceOutput = new DistanceOutput();\nvar cache = new SimplexCache();\nvar xfA$1 = transform(0, 0, 0);\nvar xfB$1 = transform(0, 0, 0);\nvar temp$4 = vec2(0, 0);\nvar pointA$2 = vec2(0, 0);\nvar pointB$2 = vec2(0, 0);\nvar normal$3 = vec2(0, 0);\nvar axisA = vec2(0, 0);\nvar axisB = vec2(0, 0);\nvar localPointA = vec2(0, 0);\nvar localPointB = vec2(0, 0);\nvar TimeOfImpact = function(output2, input2) {\n  var timer = Timer.now();\n  ++stats.toiCalls;\n  output2.state = TOIOutputState.e_unknown;\n  output2.t = input2.tMax;\n  var proxyA = input2.proxyA;\n  var proxyB = input2.proxyB;\n  var sweepA = input2.sweepA;\n  var sweepB = input2.sweepB;\n  sweepA.normalize();\n  sweepB.normalize();\n  var tMax = input2.tMax;\n  var totalRadius = proxyA.m_radius + proxyB.m_radius;\n  var target = math_max$3(SettingsInternal.linearSlop, totalRadius - 3 * SettingsInternal.linearSlop);\n  var tolerance = 0.25 * SettingsInternal.linearSlop;\n  var t1 = 0;\n  var k_maxIterations = SettingsInternal.maxTOIIterations;\n  var iter = 0;\n  cache.recycle();\n  distanceInput.proxyA.setVertices(proxyA.m_vertices, proxyA.m_count, proxyA.m_radius);\n  distanceInput.proxyB.setVertices(proxyB.m_vertices, proxyB.m_count, proxyB.m_radius);\n  distanceInput.useRadii = false;\n  while (true) {\n    sweepA.getTransform(xfA$1, t1);\n    sweepB.getTransform(xfB$1, t1);\n    copyTransform(distanceInput.transformA, xfA$1);\n    copyTransform(distanceInput.transformB, xfB$1);\n    Distance(distanceOutput, cache, distanceInput);\n    if (distanceOutput.distance <= 0) {\n      output2.state = TOIOutputState.e_overlapped;\n      output2.t = 0;\n      break;\n    }\n    if (distanceOutput.distance < target + tolerance) {\n      output2.state = TOIOutputState.e_touching;\n      output2.t = t1;\n      break;\n    }\n    separationFunction.initialize(cache, proxyA, sweepA, proxyB, sweepB, t1);\n    var done = false;\n    var t2 = tMax;\n    var pushBackIter = 0;\n    while (true) {\n      var s2 = separationFunction.findMinSeparation(t2);\n      if (s2 > target + tolerance) {\n        output2.state = TOIOutputState.e_separated;\n        output2.t = tMax;\n        done = true;\n        break;\n      }\n      if (s2 > target - tolerance) {\n        t1 = t2;\n        break;\n      }\n      var s1 = separationFunction.evaluate(t1);\n      if (s1 < target - tolerance) {\n        output2.state = TOIOutputState.e_failed;\n        output2.t = t1;\n        done = true;\n        break;\n      }\n      if (s1 <= target + tolerance) {\n        output2.state = TOIOutputState.e_touching;\n        output2.t = t1;\n        done = true;\n        break;\n      }\n      var rootIterCount = 0;\n      var a1 = t1;\n      var a2 = t2;\n      while (true) {\n        var t = void 0;\n        if (rootIterCount & 1) {\n          t = a1 + (target - s1) * (a2 - a1) / (s2 - s1);\n        } else {\n          t = 0.5 * (a1 + a2);\n        }\n        ++rootIterCount;\n        ++stats.toiRootIters;\n        var s3 = separationFunction.evaluate(t);\n        if (math_abs$7(s3 - target) < tolerance) {\n          t2 = t;\n          break;\n        }\n        if (s3 > target) {\n          a1 = t;\n          s1 = s3;\n        } else {\n          a2 = t;\n          s2 = s3;\n        }\n        if (rootIterCount === 50) {\n          break;\n        }\n      }\n      stats.toiMaxRootIters = math_max$3(stats.toiMaxRootIters, rootIterCount);\n      ++pushBackIter;\n      if (pushBackIter === SettingsInternal.maxPolygonVertices) {\n        break;\n      }\n    }\n    ++iter;\n    ++stats.toiIters;\n    if (done) {\n      break;\n    }\n    if (iter === k_maxIterations) {\n      output2.state = TOIOutputState.e_failed;\n      output2.t = t1;\n      break;\n    }\n  }\n  stats.toiMaxIters = math_max$3(stats.toiMaxIters, iter);\n  var time = Timer.diff(timer);\n  stats.toiMaxTime = math_max$3(stats.toiMaxTime, time);\n  stats.toiTime += time;\n  separationFunction.recycle();\n};\nvar SeparationFunctionType;\n(function(SeparationFunctionType2) {\n  SeparationFunctionType2[SeparationFunctionType2[\"e_unset\"] = -1] = \"e_unset\";\n  SeparationFunctionType2[SeparationFunctionType2[\"e_points\"] = 1] = \"e_points\";\n  SeparationFunctionType2[SeparationFunctionType2[\"e_faceA\"] = 2] = \"e_faceA\";\n  SeparationFunctionType2[SeparationFunctionType2[\"e_faceB\"] = 3] = \"e_faceB\";\n})(SeparationFunctionType || (SeparationFunctionType = {}));\nvar SeparationFunction = (\n  /** @class */\n  function() {\n    function SeparationFunction2() {\n      this.m_proxyA = null;\n      this.m_proxyB = null;\n      this.m_sweepA = null;\n      this.m_sweepB = null;\n      this.m_type = SeparationFunctionType.e_unset;\n      this.m_localPoint = vec2(0, 0);\n      this.m_axis = vec2(0, 0);\n      this.indexA = -1;\n      this.indexB = -1;\n    }\n    SeparationFunction2.prototype.recycle = function() {\n      this.m_proxyA = null;\n      this.m_proxyB = null;\n      this.m_sweepA = null;\n      this.m_sweepB = null;\n      this.m_type = SeparationFunctionType.e_unset;\n      zeroVec2(this.m_localPoint);\n      zeroVec2(this.m_axis);\n      this.indexA = -1;\n      this.indexB = -1;\n    };\n    SeparationFunction2.prototype.initialize = function(cache2, proxyA, sweepA, proxyB, sweepB, t1) {\n      var count = cache2.count;\n      this.m_proxyA = proxyA;\n      this.m_proxyB = proxyB;\n      this.m_sweepA = sweepA;\n      this.m_sweepB = sweepB;\n      this.m_sweepA.getTransform(xfA$1, t1);\n      this.m_sweepB.getTransform(xfB$1, t1);\n      if (count === 1) {\n        this.m_type = SeparationFunctionType.e_points;\n        var localPointA_1 = this.m_proxyA.getVertex(cache2.indexA[0]);\n        var localPointB_1 = this.m_proxyB.getVertex(cache2.indexB[0]);\n        transformVec2(pointA$2, xfA$1, localPointA_1);\n        transformVec2(pointB$2, xfB$1, localPointB_1);\n        subVec2(this.m_axis, pointB$2, pointA$2);\n        var s2 = normalizeVec2Length(this.m_axis);\n        return s2;\n      } else if (cache2.indexA[0] === cache2.indexA[1]) {\n        this.m_type = SeparationFunctionType.e_faceB;\n        var localPointB1 = proxyB.getVertex(cache2.indexB[0]);\n        var localPointB2 = proxyB.getVertex(cache2.indexB[1]);\n        crossVec2Num(this.m_axis, subVec2(temp$4, localPointB2, localPointB1), 1);\n        normalizeVec2(this.m_axis);\n        rotVec2(normal$3, xfB$1.q, this.m_axis);\n        combine2Vec2(this.m_localPoint, 0.5, localPointB1, 0.5, localPointB2);\n        transformVec2(pointB$2, xfB$1, this.m_localPoint);\n        var localPointA_2 = proxyA.getVertex(cache2.indexA[0]);\n        var pointA_1 = Transform.mulVec2(xfA$1, localPointA_2);\n        var s2 = dotVec2(pointA_1, normal$3) - dotVec2(pointB$2, normal$3);\n        if (s2 < 0) {\n          negVec2(this.m_axis);\n          s2 = -s2;\n        }\n        return s2;\n      } else {\n        this.m_type = SeparationFunctionType.e_faceA;\n        var localPointA1 = this.m_proxyA.getVertex(cache2.indexA[0]);\n        var localPointA2 = this.m_proxyA.getVertex(cache2.indexA[1]);\n        crossVec2Num(this.m_axis, subVec2(temp$4, localPointA2, localPointA1), 1);\n        normalizeVec2(this.m_axis);\n        rotVec2(normal$3, xfA$1.q, this.m_axis);\n        combine2Vec2(this.m_localPoint, 0.5, localPointA1, 0.5, localPointA2);\n        transformVec2(pointA$2, xfA$1, this.m_localPoint);\n        var localPointB_2 = this.m_proxyB.getVertex(cache2.indexB[0]);\n        transformVec2(pointB$2, xfB$1, localPointB_2);\n        var s2 = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);\n        if (s2 < 0) {\n          negVec2(this.m_axis);\n          s2 = -s2;\n        }\n        return s2;\n      }\n    };\n    SeparationFunction2.prototype.compute = function(find, t) {\n      this.m_sweepA.getTransform(xfA$1, t);\n      this.m_sweepB.getTransform(xfB$1, t);\n      switch (this.m_type) {\n        case SeparationFunctionType.e_points: {\n          if (find) {\n            derotVec2(axisA, xfA$1.q, this.m_axis);\n            derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, this.m_axis));\n            this.indexA = this.m_proxyA.getSupport(axisA);\n            this.indexB = this.m_proxyB.getSupport(axisB);\n          }\n          copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));\n          copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));\n          transformVec2(pointA$2, xfA$1, localPointA);\n          transformVec2(pointB$2, xfB$1, localPointB);\n          var sep = dotVec2(pointB$2, this.m_axis) - dotVec2(pointA$2, this.m_axis);\n          return sep;\n        }\n        case SeparationFunctionType.e_faceA: {\n          rotVec2(normal$3, xfA$1.q, this.m_axis);\n          transformVec2(pointA$2, xfA$1, this.m_localPoint);\n          if (find) {\n            derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, normal$3));\n            this.indexA = -1;\n            this.indexB = this.m_proxyB.getSupport(axisB);\n          }\n          copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));\n          transformVec2(pointB$2, xfB$1, localPointB);\n          var sep = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);\n          return sep;\n        }\n        case SeparationFunctionType.e_faceB: {\n          rotVec2(normal$3, xfB$1.q, this.m_axis);\n          transformVec2(pointB$2, xfB$1, this.m_localPoint);\n          if (find) {\n            derotVec2(axisA, xfA$1.q, scaleVec2(temp$4, -1, normal$3));\n            this.indexB = -1;\n            this.indexA = this.m_proxyA.getSupport(axisA);\n          }\n          copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));\n          transformVec2(pointA$2, xfA$1, localPointA);\n          var sep = dotVec2(pointA$2, normal$3) - dotVec2(pointB$2, normal$3);\n          return sep;\n        }\n        default:\n          if (find) {\n            this.indexA = -1;\n            this.indexB = -1;\n          }\n          return 0;\n      }\n    };\n    SeparationFunction2.prototype.findMinSeparation = function(t) {\n      return this.compute(true, t);\n    };\n    SeparationFunction2.prototype.evaluate = function(t) {\n      return this.compute(false, t);\n    };\n    return SeparationFunction2;\n  }()\n);\nvar separationFunction = new SeparationFunction();\nTimeOfImpact.Input = TOIInput;\nTimeOfImpact.Output = TOIOutput;\nvar math_abs$6 = Math.abs;\nvar math_sqrt$3 = Math.sqrt;\nvar math_min$5 = Math.min;\nvar TimeStep = (\n  /** @class */\n  function() {\n    function TimeStep2() {\n      this.dt = 0;\n      this.inv_dt = 0;\n      this.velocityIterations = 0;\n      this.positionIterations = 0;\n      this.warmStarting = false;\n      this.blockSolve = true;\n      this.inv_dt0 = 0;\n      this.dtRatio = 1;\n    }\n    TimeStep2.prototype.reset = function(dt) {\n      if (this.dt > 0) {\n        this.inv_dt0 = this.inv_dt;\n      }\n      this.dt = dt;\n      this.inv_dt = dt == 0 ? 0 : 1 / dt;\n      this.dtRatio = dt * this.inv_dt0;\n    };\n    return TimeStep2;\n  }()\n);\nvar s_subStep = new TimeStep();\nvar c = vec2(0, 0);\nvar v = vec2(0, 0);\nvar translation = vec2(0, 0);\nvar input = new TOIInput();\nvar output = new TOIOutput();\nvar backup = new Sweep();\nvar backup1 = new Sweep();\nvar backup2 = new Sweep();\nvar ContactImpulse = (\n  /** @class */\n  function() {\n    function ContactImpulse2(contact) {\n      this.contact = contact;\n      this.normals = [];\n      this.tangents = [];\n    }\n    ContactImpulse2.prototype.recycle = function() {\n      this.normals.length = 0;\n      this.tangents.length = 0;\n    };\n    Object.defineProperty(ContactImpulse2.prototype, \"normalImpulses\", {\n      get: function() {\n        var contact = this.contact;\n        var normals = this.normals;\n        normals.length = 0;\n        for (var p = 0; p < contact.v_points.length; ++p) {\n          normals.push(contact.v_points[p].normalImpulse);\n        }\n        return normals;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(ContactImpulse2.prototype, \"tangentImpulses\", {\n      get: function() {\n        var contact = this.contact;\n        var tangents = this.tangents;\n        tangents.length = 0;\n        for (var p = 0; p < contact.v_points.length; ++p) {\n          tangents.push(contact.v_points[p].tangentImpulse);\n        }\n        return tangents;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    return ContactImpulse2;\n  }()\n);\nvar Solver = (\n  /** @class */\n  function() {\n    function Solver2(world) {\n      this.m_world = world;\n      this.m_stack = [];\n      this.m_bodies = [];\n      this.m_contacts = [];\n      this.m_joints = [];\n    }\n    Solver2.prototype.clear = function() {\n      this.m_stack.length = 0;\n      this.m_bodies.length = 0;\n      this.m_contacts.length = 0;\n      this.m_joints.length = 0;\n    };\n    Solver2.prototype.addBody = function(body) {\n      this.m_bodies.push(body);\n    };\n    Solver2.prototype.addContact = function(contact) {\n      this.m_contacts.push(contact);\n    };\n    Solver2.prototype.addJoint = function(joint) {\n      this.m_joints.push(joint);\n    };\n    Solver2.prototype.solveWorld = function(step) {\n      var world = this.m_world;\n      for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {\n        b2.m_islandFlag = false;\n      }\n      for (var c_1 = world.m_contactList; c_1; c_1 = c_1.m_next) {\n        c_1.m_islandFlag = false;\n      }\n      for (var j = world.m_jointList; j; j = j.m_next) {\n        j.m_islandFlag = false;\n      }\n      var stack = this.m_stack;\n      for (var seed = world.m_bodyList; seed; seed = seed.m_next) {\n        if (seed.m_islandFlag) {\n          continue;\n        }\n        if (seed.isAwake() == false || seed.isActive() == false) {\n          continue;\n        }\n        if (seed.isStatic()) {\n          continue;\n        }\n        this.clear();\n        stack.push(seed);\n        seed.m_islandFlag = true;\n        while (stack.length > 0) {\n          var b2 = stack.pop();\n          this.addBody(b2);\n          b2.m_awakeFlag = true;\n          if (b2.isStatic()) {\n            continue;\n          }\n          for (var ce = b2.m_contactList; ce; ce = ce.next) {\n            var contact = ce.contact;\n            if (contact.m_islandFlag) {\n              continue;\n            }\n            if (contact.isEnabled() == false || contact.isTouching() == false) {\n              continue;\n            }\n            var sensorA = contact.m_fixtureA.m_isSensor;\n            var sensorB = contact.m_fixtureB.m_isSensor;\n            if (sensorA || sensorB) {\n              continue;\n            }\n            this.addContact(contact);\n            contact.m_islandFlag = true;\n            var other = ce.other;\n            if (other.m_islandFlag) {\n              continue;\n            }\n            stack.push(other);\n            other.m_islandFlag = true;\n          }\n          for (var je = b2.m_jointList; je; je = je.next) {\n            if (je.joint.m_islandFlag == true) {\n              continue;\n            }\n            var other = je.other;\n            if (other.isActive() == false) {\n              continue;\n            }\n            this.addJoint(je.joint);\n            je.joint.m_islandFlag = true;\n            if (other.m_islandFlag) {\n              continue;\n            }\n            stack.push(other);\n            other.m_islandFlag = true;\n          }\n        }\n        this.solveIsland(step);\n        for (var i = 0; i < this.m_bodies.length; ++i) {\n          var b2 = this.m_bodies[i];\n          if (b2.isStatic()) {\n            b2.m_islandFlag = false;\n          }\n        }\n      }\n    };\n    Solver2.prototype.solveIsland = function(step) {\n      var world = this.m_world;\n      var gravity = world.m_gravity;\n      var allowSleep = world.m_allowSleep;\n      var h = step.dt;\n      for (var i = 0; i < this.m_bodies.length; ++i) {\n        var body = this.m_bodies[i];\n        copyVec2(c, body.m_sweep.c);\n        var a2 = body.m_sweep.a;\n        copyVec2(v, body.m_linearVelocity);\n        var w = body.m_angularVelocity;\n        copyVec2(body.m_sweep.c0, body.m_sweep.c);\n        body.m_sweep.a0 = body.m_sweep.a;\n        if (body.isDynamic()) {\n          plusScaleVec2(v, h * body.m_gravityScale, gravity);\n          plusScaleVec2(v, h * body.m_invMass, body.m_force);\n          w += h * body.m_invI * body.m_torque;\n          scaleVec2(v, 1 / (1 + h * body.m_linearDamping), v);\n          w *= 1 / (1 + h * body.m_angularDamping);\n        }\n        copyVec2(body.c_position.c, c);\n        body.c_position.a = a2;\n        copyVec2(body.c_velocity.v, v);\n        body.c_velocity.w = w;\n      }\n      for (var i = 0; i < this.m_contacts.length; ++i) {\n        var contact = this.m_contacts[i];\n        contact.initConstraint(step);\n      }\n      for (var i = 0; i < this.m_contacts.length; ++i) {\n        var contact = this.m_contacts[i];\n        contact.initVelocityConstraint(step);\n      }\n      if (step.warmStarting) {\n        for (var i = 0; i < this.m_contacts.length; ++i) {\n          var contact = this.m_contacts[i];\n          contact.warmStartConstraint(step);\n        }\n      }\n      for (var i = 0; i < this.m_joints.length; ++i) {\n        var joint = this.m_joints[i];\n        joint.initVelocityConstraints(step);\n      }\n      for (var i = 0; i < step.velocityIterations; ++i) {\n        for (var j = 0; j < this.m_joints.length; ++j) {\n          var joint = this.m_joints[j];\n          joint.solveVelocityConstraints(step);\n        }\n        for (var j = 0; j < this.m_contacts.length; ++j) {\n          var contact = this.m_contacts[j];\n          contact.solveVelocityConstraint(step);\n        }\n      }\n      for (var i = 0; i < this.m_contacts.length; ++i) {\n        var contact = this.m_contacts[i];\n        contact.storeConstraintImpulses(step);\n      }\n      for (var i = 0; i < this.m_bodies.length; ++i) {\n        var body = this.m_bodies[i];\n        copyVec2(c, body.c_position.c);\n        var a2 = body.c_position.a;\n        copyVec2(v, body.c_velocity.v);\n        var w = body.c_velocity.w;\n        scaleVec2(translation, h, v);\n        var translationLengthSqr = lengthSqrVec2(translation);\n        if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {\n          var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);\n          mulVec2(v, ratio);\n        }\n        var rotation2 = h * w;\n        if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {\n          var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);\n          w *= ratio;\n        }\n        plusScaleVec2(c, h, v);\n        a2 += h * w;\n        copyVec2(body.c_position.c, c);\n        body.c_position.a = a2;\n        copyVec2(body.c_velocity.v, v);\n        body.c_velocity.w = w;\n      }\n      var positionSolved = false;\n      for (var i = 0; i < step.positionIterations; ++i) {\n        var minSeparation = 0;\n        for (var j = 0; j < this.m_contacts.length; ++j) {\n          var contact = this.m_contacts[j];\n          var separation = contact.solvePositionConstraint(step);\n          minSeparation = math_min$5(minSeparation, separation);\n        }\n        var contactsOkay = minSeparation >= -3 * SettingsInternal.linearSlop;\n        var jointsOkay = true;\n        for (var j = 0; j < this.m_joints.length; ++j) {\n          var joint = this.m_joints[j];\n          var jointOkay = joint.solvePositionConstraints(step);\n          jointsOkay = jointsOkay && jointOkay;\n        }\n        if (contactsOkay && jointsOkay) {\n          positionSolved = true;\n          break;\n        }\n      }\n      for (var i = 0; i < this.m_bodies.length; ++i) {\n        var body = this.m_bodies[i];\n        copyVec2(body.m_sweep.c, body.c_position.c);\n        body.m_sweep.a = body.c_position.a;\n        copyVec2(body.m_linearVelocity, body.c_velocity.v);\n        body.m_angularVelocity = body.c_velocity.w;\n        body.synchronizeTransform();\n      }\n      this.postSolveIsland();\n      if (allowSleep) {\n        var minSleepTime = Infinity;\n        var linTolSqr = SettingsInternal.linearSleepToleranceSqr;\n        var angTolSqr = SettingsInternal.angularSleepToleranceSqr;\n        for (var i = 0; i < this.m_bodies.length; ++i) {\n          var body = this.m_bodies[i];\n          if (body.isStatic()) {\n            continue;\n          }\n          if (body.m_autoSleepFlag == false || body.m_angularVelocity * body.m_angularVelocity > angTolSqr || lengthSqrVec2(body.m_linearVelocity) > linTolSqr) {\n            body.m_sleepTime = 0;\n            minSleepTime = 0;\n          } else {\n            body.m_sleepTime += h;\n            minSleepTime = math_min$5(minSleepTime, body.m_sleepTime);\n          }\n        }\n        if (minSleepTime >= SettingsInternal.timeToSleep && positionSolved) {\n          for (var i = 0; i < this.m_bodies.length; ++i) {\n            var body = this.m_bodies[i];\n            body.setAwake(false);\n          }\n        }\n      }\n    };\n    Solver2.prototype.solveWorldTOI = function(step) {\n      var world = this.m_world;\n      if (world.m_stepComplete) {\n        for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {\n          b2.m_islandFlag = false;\n          b2.m_sweep.alpha0 = 0;\n        }\n        for (var c_2 = world.m_contactList; c_2; c_2 = c_2.m_next) {\n          c_2.m_toiFlag = false;\n          c_2.m_islandFlag = false;\n          c_2.m_toiCount = 0;\n          c_2.m_toi = 1;\n        }\n      }\n      while (true) {\n        var minContact = null;\n        var minAlpha = 1;\n        for (var c_3 = world.m_contactList; c_3; c_3 = c_3.m_next) {\n          if (c_3.isEnabled() == false) {\n            continue;\n          }\n          if (c_3.m_toiCount > SettingsInternal.maxSubSteps) {\n            continue;\n          }\n          var alpha = 1;\n          if (c_3.m_toiFlag) {\n            alpha = c_3.m_toi;\n          } else {\n            var fA_1 = c_3.getFixtureA();\n            var fB_1 = c_3.getFixtureB();\n            if (fA_1.isSensor() || fB_1.isSensor()) {\n              continue;\n            }\n            var bA_1 = fA_1.getBody();\n            var bB_1 = fB_1.getBody();\n            var activeA = bA_1.isAwake() && !bA_1.isStatic();\n            var activeB = bB_1.isAwake() && !bB_1.isStatic();\n            if (activeA == false && activeB == false) {\n              continue;\n            }\n            var collideA = bA_1.isBullet() || !bA_1.isDynamic();\n            var collideB = bB_1.isBullet() || !bB_1.isDynamic();\n            if (collideA == false && collideB == false) {\n              continue;\n            }\n            var alpha0 = bA_1.m_sweep.alpha0;\n            if (bA_1.m_sweep.alpha0 < bB_1.m_sweep.alpha0) {\n              alpha0 = bB_1.m_sweep.alpha0;\n              bA_1.m_sweep.advance(alpha0);\n            } else if (bB_1.m_sweep.alpha0 < bA_1.m_sweep.alpha0) {\n              alpha0 = bA_1.m_sweep.alpha0;\n              bB_1.m_sweep.advance(alpha0);\n            }\n            var indexA = c_3.getChildIndexA();\n            var indexB = c_3.getChildIndexB();\n            input.proxyA.set(fA_1.getShape(), indexA);\n            input.proxyB.set(fB_1.getShape(), indexB);\n            input.sweepA.set(bA_1.m_sweep);\n            input.sweepB.set(bB_1.m_sweep);\n            input.tMax = 1;\n            TimeOfImpact(output, input);\n            var beta = output.t;\n            if (output.state == TOIOutputState.e_touching) {\n              alpha = math_min$5(alpha0 + (1 - alpha0) * beta, 1);\n            } else {\n              alpha = 1;\n            }\n            c_3.m_toi = alpha;\n            c_3.m_toiFlag = true;\n          }\n          if (alpha < minAlpha) {\n            minContact = c_3;\n            minAlpha = alpha;\n          }\n        }\n        if (minContact == null || 1 - 10 * EPSILON < minAlpha) {\n          world.m_stepComplete = true;\n          break;\n        }\n        var fA = minContact.getFixtureA();\n        var fB = minContact.getFixtureB();\n        var bA = fA.getBody();\n        var bB = fB.getBody();\n        backup1.set(bA.m_sweep);\n        backup2.set(bB.m_sweep);\n        bA.advance(minAlpha);\n        bB.advance(minAlpha);\n        minContact.update(world);\n        minContact.m_toiFlag = false;\n        ++minContact.m_toiCount;\n        if (minContact.isEnabled() == false || minContact.isTouching() == false) {\n          minContact.setEnabled(false);\n          bA.m_sweep.set(backup1);\n          bB.m_sweep.set(backup2);\n          bA.synchronizeTransform();\n          bB.synchronizeTransform();\n          continue;\n        }\n        bA.setAwake(true);\n        bB.setAwake(true);\n        this.clear();\n        this.addBody(bA);\n        this.addBody(bB);\n        this.addContact(minContact);\n        bA.m_islandFlag = true;\n        bB.m_islandFlag = true;\n        minContact.m_islandFlag = true;\n        var bodies = [bA, bB];\n        for (var i = 0; i < bodies.length; ++i) {\n          var body = bodies[i];\n          if (body.isDynamic()) {\n            for (var ce = body.m_contactList; ce; ce = ce.next) {\n              var contact = ce.contact;\n              if (contact.m_islandFlag) {\n                continue;\n              }\n              var other = ce.other;\n              if (other.isDynamic() && !body.isBullet() && !other.isBullet()) {\n                continue;\n              }\n              var sensorA = contact.m_fixtureA.m_isSensor;\n              var sensorB = contact.m_fixtureB.m_isSensor;\n              if (sensorA || sensorB) {\n                continue;\n              }\n              backup.set(other.m_sweep);\n              if (other.m_islandFlag == false) {\n                other.advance(minAlpha);\n              }\n              contact.update(world);\n              if (contact.isEnabled() == false || contact.isTouching() == false) {\n                other.m_sweep.set(backup);\n                other.synchronizeTransform();\n                continue;\n              }\n              contact.m_islandFlag = true;\n              this.addContact(contact);\n              if (other.m_islandFlag) {\n                continue;\n              }\n              other.m_islandFlag = true;\n              if (!other.isStatic()) {\n                other.setAwake(true);\n              }\n              this.addBody(other);\n            }\n          }\n        }\n        s_subStep.reset((1 - minAlpha) * step.dt);\n        s_subStep.dtRatio = 1;\n        s_subStep.positionIterations = 20;\n        s_subStep.velocityIterations = step.velocityIterations;\n        s_subStep.warmStarting = false;\n        this.solveIslandTOI(s_subStep, bA, bB);\n        for (var i = 0; i < this.m_bodies.length; ++i) {\n          var body = this.m_bodies[i];\n          body.m_islandFlag = false;\n          if (!body.isDynamic()) {\n            continue;\n          }\n          body.synchronizeFixtures();\n          for (var ce = body.m_contactList; ce; ce = ce.next) {\n            ce.contact.m_toiFlag = false;\n            ce.contact.m_islandFlag = false;\n          }\n        }\n        world.findNewContacts();\n        if (world.m_subStepping) {\n          world.m_stepComplete = false;\n          break;\n        }\n      }\n    };\n    Solver2.prototype.solveIslandTOI = function(subStep, toiA, toiB) {\n      for (var i = 0; i < this.m_bodies.length; ++i) {\n        var body = this.m_bodies[i];\n        copyVec2(body.c_position.c, body.m_sweep.c);\n        body.c_position.a = body.m_sweep.a;\n        copyVec2(body.c_velocity.v, body.m_linearVelocity);\n        body.c_velocity.w = body.m_angularVelocity;\n      }\n      for (var i = 0; i < this.m_contacts.length; ++i) {\n        var contact = this.m_contacts[i];\n        contact.initConstraint(subStep);\n      }\n      for (var i = 0; i < subStep.positionIterations; ++i) {\n        var minSeparation = 0;\n        for (var j = 0; j < this.m_contacts.length; ++j) {\n          var contact = this.m_contacts[j];\n          var separation = contact.solvePositionConstraintTOI(subStep, toiA, toiB);\n          minSeparation = math_min$5(minSeparation, separation);\n        }\n        var contactsOkay = minSeparation >= -1.5 * SettingsInternal.linearSlop;\n        if (contactsOkay) {\n          break;\n        }\n      }\n      var i;\n      copyVec2(toiA.m_sweep.c0, toiA.c_position.c);\n      toiA.m_sweep.a0 = toiA.c_position.a;\n      copyVec2(toiB.m_sweep.c0, toiB.c_position.c);\n      toiB.m_sweep.a0 = toiB.c_position.a;\n      for (var i = 0; i < this.m_contacts.length; ++i) {\n        var contact = this.m_contacts[i];\n        contact.initVelocityConstraint(subStep);\n      }\n      for (var i = 0; i < subStep.velocityIterations; ++i) {\n        for (var j = 0; j < this.m_contacts.length; ++j) {\n          var contact = this.m_contacts[j];\n          contact.solveVelocityConstraint(subStep);\n        }\n      }\n      var h = subStep.dt;\n      for (var i = 0; i < this.m_bodies.length; ++i) {\n        var body = this.m_bodies[i];\n        copyVec2(c, body.c_position.c);\n        var a2 = body.c_position.a;\n        copyVec2(v, body.c_velocity.v);\n        var w = body.c_velocity.w;\n        scaleVec2(translation, h, v);\n        var translationLengthSqr = lengthSqrVec2(translation);\n        if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {\n          var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);\n          mulVec2(v, ratio);\n        }\n        var rotation2 = h * w;\n        if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {\n          var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);\n          w *= ratio;\n        }\n        plusScaleVec2(c, h, v);\n        a2 += h * w;\n        copyVec2(body.c_position.c, c);\n        body.c_position.a = a2;\n        copyVec2(body.c_velocity.v, v);\n        body.c_velocity.w = w;\n        copyVec2(body.m_sweep.c, c);\n        body.m_sweep.a = a2;\n        copyVec2(body.m_linearVelocity, v);\n        body.m_angularVelocity = w;\n        body.synchronizeTransform();\n      }\n      this.postSolveIsland();\n    };\n    Solver2.prototype.postSolveIsland = function() {\n      for (var c_5 = 0; c_5 < this.m_contacts.length; ++c_5) {\n        var contact = this.m_contacts[c_5];\n        this.m_world.postSolve(contact, contact.m_impulse);\n      }\n    };\n    return Solver2;\n  }()\n);\nSolver.TimeStep = TimeStep;\nvar Mat22 = (\n  /** @class */\n  function() {\n    function Mat222(a2, b2, c2, d2) {\n      if (typeof a2 === \"object\" && a2 !== null) {\n        this.ex = Vec2.clone(a2);\n        this.ey = Vec2.clone(b2);\n      } else if (typeof a2 === \"number\") {\n        this.ex = Vec2.neo(a2, c2);\n        this.ey = Vec2.neo(b2, d2);\n      } else {\n        this.ex = Vec2.zero();\n        this.ey = Vec2.zero();\n      }\n    }\n    Mat222.prototype.toString = function() {\n      return JSON.stringify(this);\n    };\n    Mat222.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Vec2.isValid(obj.ex) && Vec2.isValid(obj.ey);\n    };\n    Mat222.assert = function(o) {\n    };\n    Mat222.prototype.set = function(a2, b2, c2, d2) {\n      if (typeof a2 === \"number\" && typeof b2 === \"number\" && typeof c2 === \"number\" && typeof d2 === \"number\") {\n        this.ex.setNum(a2, c2);\n        this.ey.setNum(b2, d2);\n      } else if (typeof a2 === \"object\" && typeof b2 === \"object\") {\n        this.ex.setVec2(a2);\n        this.ey.setVec2(b2);\n      } else if (typeof a2 === \"object\") {\n        this.ex.setVec2(a2.ex);\n        this.ey.setVec2(a2.ey);\n      } else ;\n    };\n    Mat222.prototype.setIdentity = function() {\n      this.ex.x = 1;\n      this.ey.x = 0;\n      this.ex.y = 0;\n      this.ey.y = 1;\n    };\n    Mat222.prototype.setZero = function() {\n      this.ex.x = 0;\n      this.ey.x = 0;\n      this.ex.y = 0;\n      this.ey.y = 0;\n    };\n    Mat222.prototype.getInverse = function() {\n      var a2 = this.ex.x;\n      var b2 = this.ey.x;\n      var c2 = this.ex.y;\n      var d2 = this.ey.y;\n      var det = a2 * d2 - b2 * c2;\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      var imx = new Mat222();\n      imx.ex.x = det * d2;\n      imx.ey.x = -det * b2;\n      imx.ex.y = -det * c2;\n      imx.ey.y = det * a2;\n      return imx;\n    };\n    Mat222.prototype.solve = function(v3) {\n      var a2 = this.ex.x;\n      var b2 = this.ey.x;\n      var c2 = this.ex.y;\n      var d2 = this.ey.y;\n      var det = a2 * d2 - b2 * c2;\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      var w = Vec2.zero();\n      w.x = det * (d2 * v3.x - b2 * v3.y);\n      w.y = det * (a2 * v3.y - c2 * v3.x);\n      return w;\n    };\n    Mat222.mul = function(mx, v3) {\n      if (v3 && \"x\" in v3 && \"y\" in v3) {\n        var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;\n        var y = mx.ex.y * v3.x + mx.ey.y * v3.y;\n        return Vec2.neo(x2, y);\n      } else if (v3 && \"ex\" in v3 && \"ey\" in v3) {\n        var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;\n        var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;\n        var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;\n        var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;\n        return new Mat222(a2, b2, c2, d2);\n      }\n    };\n    Mat222.mulVec2 = function(mx, v3) {\n      var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;\n      var y = mx.ex.y * v3.x + mx.ey.y * v3.y;\n      return Vec2.neo(x2, y);\n    };\n    Mat222.mulMat22 = function(mx, v3) {\n      var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;\n      var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;\n      var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;\n      var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;\n      return new Mat222(a2, b2, c2, d2);\n    };\n    Mat222.mulT = function(mx, v3) {\n      if (v3 && \"x\" in v3 && \"y\" in v3) {\n        return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));\n      } else if (v3 && \"ex\" in v3 && \"ey\" in v3) {\n        var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));\n        var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));\n        return new Mat222(c1, c2);\n      }\n    };\n    Mat222.mulTVec2 = function(mx, v3) {\n      return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));\n    };\n    Mat222.mulTMat22 = function(mx, v3) {\n      var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));\n      var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));\n      return new Mat222(c1, c2);\n    };\n    Mat222.abs = function(mx) {\n      return new Mat222(Vec2.abs(mx.ex), Vec2.abs(mx.ey));\n    };\n    Mat222.add = function(mx1, mx2) {\n      return new Mat222(Vec2.add(mx1.ex, mx2.ex), Vec2.add(mx1.ey, mx2.ey));\n    };\n    return Mat222;\n  }()\n);\nvar math_sqrt$2 = Math.sqrt;\nvar pointA$1 = vec2(0, 0);\nvar pointB$1 = vec2(0, 0);\nvar temp$3 = vec2(0, 0);\nvar cA$1 = vec2(0, 0);\nvar cB$1 = vec2(0, 0);\nvar dist = vec2(0, 0);\nvar planePoint$2 = vec2(0, 0);\nvar clipPoint$1 = vec2(0, 0);\nvar ManifoldType;\n(function(ManifoldType2) {\n  ManifoldType2[ManifoldType2[\"e_unset\"] = -1] = \"e_unset\";\n  ManifoldType2[ManifoldType2[\"e_circles\"] = 0] = \"e_circles\";\n  ManifoldType2[ManifoldType2[\"e_faceA\"] = 1] = \"e_faceA\";\n  ManifoldType2[ManifoldType2[\"e_faceB\"] = 2] = \"e_faceB\";\n})(ManifoldType || (ManifoldType = {}));\nvar ContactFeatureType;\n(function(ContactFeatureType2) {\n  ContactFeatureType2[ContactFeatureType2[\"e_unset\"] = -1] = \"e_unset\";\n  ContactFeatureType2[ContactFeatureType2[\"e_vertex\"] = 0] = \"e_vertex\";\n  ContactFeatureType2[ContactFeatureType2[\"e_face\"] = 1] = \"e_face\";\n})(ContactFeatureType || (ContactFeatureType = {}));\nvar PointState;\n(function(PointState2) {\n  PointState2[PointState2[\"nullState\"] = 0] = \"nullState\";\n  PointState2[PointState2[\"addState\"] = 1] = \"addState\";\n  PointState2[PointState2[\"persistState\"] = 2] = \"persistState\";\n  PointState2[PointState2[\"removeState\"] = 3] = \"removeState\";\n})(PointState || (PointState = {}));\nvar ClipVertex = (\n  /** @class */\n  function() {\n    function ClipVertex2() {\n      this.v = vec2(0, 0);\n      this.id = new ContactID();\n    }\n    ClipVertex2.prototype.set = function(o) {\n      copyVec2(this.v, o.v);\n      this.id.set(o.id);\n    };\n    ClipVertex2.prototype.recycle = function() {\n      zeroVec2(this.v);\n      this.id.recycle();\n    };\n    return ClipVertex2;\n  }()\n);\nvar Manifold = (\n  /** @class */\n  function() {\n    function Manifold2() {\n      this.localNormal = vec2(0, 0);\n      this.localPoint = vec2(0, 0);\n      this.points = [new ManifoldPoint(), new ManifoldPoint()];\n      this.pointCount = 0;\n    }\n    Manifold2.prototype.set = function(that) {\n      this.type = that.type;\n      copyVec2(this.localNormal, that.localNormal);\n      copyVec2(this.localPoint, that.localPoint);\n      this.pointCount = that.pointCount;\n      this.points[0].set(that.points[0]);\n      this.points[1].set(that.points[1]);\n    };\n    Manifold2.prototype.recycle = function() {\n      this.type = ManifoldType.e_unset;\n      zeroVec2(this.localNormal);\n      zeroVec2(this.localPoint);\n      this.pointCount = 0;\n      this.points[0].recycle();\n      this.points[1].recycle();\n    };\n    Manifold2.prototype.getWorldManifold = function(wm, xfA2, radiusA, xfB2, radiusB) {\n      if (this.pointCount == 0) {\n        return wm;\n      }\n      wm = wm || new WorldManifold();\n      wm.pointCount = this.pointCount;\n      var normal3 = wm.normal;\n      var points = wm.points;\n      var separations = wm.separations;\n      switch (this.type) {\n        case ManifoldType.e_circles: {\n          setVec2(normal3, 1, 0);\n          var manifoldPoint = this.points[0];\n          transformVec2(pointA$1, xfA2, this.localPoint);\n          transformVec2(pointB$1, xfB2, manifoldPoint.localPoint);\n          subVec2(dist, pointB$1, pointA$1);\n          var lengthSqr = lengthSqrVec2(dist);\n          if (lengthSqr > EPSILON * EPSILON) {\n            var length_1 = math_sqrt$2(lengthSqr);\n            scaleVec2(normal3, 1 / length_1, dist);\n          }\n          combine2Vec2(cA$1, 1, pointA$1, radiusA, normal3);\n          combine2Vec2(cB$1, 1, pointB$1, -radiusB, normal3);\n          combine2Vec2(points[0], 0.5, cA$1, 0.5, cB$1);\n          separations[0] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);\n          break;\n        }\n        case ManifoldType.e_faceA: {\n          rotVec2(normal3, xfA2.q, this.localNormal);\n          transformVec2(planePoint$2, xfA2, this.localPoint);\n          for (var i = 0; i < this.pointCount; ++i) {\n            var manifoldPoint = this.points[i];\n            transformVec2(clipPoint$1, xfB2, manifoldPoint.localPoint);\n            combine2Vec2(cA$1, 1, clipPoint$1, radiusA - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);\n            combine2Vec2(cB$1, 1, clipPoint$1, -radiusB, normal3);\n            combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);\n            separations[i] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);\n          }\n          break;\n        }\n        case ManifoldType.e_faceB: {\n          rotVec2(normal3, xfB2.q, this.localNormal);\n          transformVec2(planePoint$2, xfB2, this.localPoint);\n          for (var i = 0; i < this.pointCount; ++i) {\n            var manifoldPoint = this.points[i];\n            transformVec2(clipPoint$1, xfA2, manifoldPoint.localPoint);\n            combine2Vec2(cB$1, 1, clipPoint$1, radiusB - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);\n            combine2Vec2(cA$1, 1, clipPoint$1, -radiusA, normal3);\n            combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);\n            separations[i] = dotVec2(subVec2(temp$3, cA$1, cB$1), normal3);\n          }\n          negVec2(normal3);\n          break;\n        }\n      }\n      return wm;\n    };\n    Manifold2.clipSegmentToLine = clipSegmentToLine;\n    Manifold2.ClipVertex = ClipVertex;\n    Manifold2.getPointStates = getPointStates;\n    Manifold2.PointState = PointState;\n    return Manifold2;\n  }()\n);\nvar ManifoldPoint = (\n  /** @class */\n  function() {\n    function ManifoldPoint2() {\n      this.localPoint = vec2(0, 0);\n      this.normalImpulse = 0;\n      this.tangentImpulse = 0;\n      this.id = new ContactID();\n    }\n    ManifoldPoint2.prototype.set = function(that) {\n      copyVec2(this.localPoint, that.localPoint);\n      this.normalImpulse = that.normalImpulse;\n      this.tangentImpulse = that.tangentImpulse;\n      this.id.set(that.id);\n    };\n    ManifoldPoint2.prototype.recycle = function() {\n      zeroVec2(this.localPoint);\n      this.normalImpulse = 0;\n      this.tangentImpulse = 0;\n      this.id.recycle();\n    };\n    return ManifoldPoint2;\n  }()\n);\nvar ContactID = (\n  /** @class */\n  function() {\n    function ContactID2() {\n      this.key = -1;\n      this.indexA = -1;\n      this.indexB = -1;\n      this.typeA = ContactFeatureType.e_unset;\n      this.typeB = ContactFeatureType.e_unset;\n    }\n    ContactID2.prototype.setFeatures = function(indexA, typeA, indexB, typeB) {\n      this.indexA = indexA;\n      this.indexB = indexB;\n      this.typeA = typeA;\n      this.typeB = typeB;\n      this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;\n    };\n    ContactID2.prototype.set = function(that) {\n      this.indexA = that.indexA;\n      this.indexB = that.indexB;\n      this.typeA = that.typeA;\n      this.typeB = that.typeB;\n      this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;\n    };\n    ContactID2.prototype.swapFeatures = function() {\n      var indexA = this.indexA;\n      var indexB = this.indexB;\n      var typeA = this.typeA;\n      var typeB = this.typeB;\n      this.indexA = indexB;\n      this.indexB = indexA;\n      this.typeA = typeB;\n      this.typeB = typeA;\n      this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;\n    };\n    ContactID2.prototype.recycle = function() {\n      this.indexA = 0;\n      this.indexB = 0;\n      this.typeA = ContactFeatureType.e_unset;\n      this.typeB = ContactFeatureType.e_unset;\n      this.key = -1;\n    };\n    return ContactID2;\n  }()\n);\nvar WorldManifold = (\n  /** @class */\n  function() {\n    function WorldManifold2() {\n      this.normal = vec2(0, 0);\n      this.points = [vec2(0, 0), vec2(0, 0)];\n      this.separations = [0, 0];\n      this.pointCount = 0;\n    }\n    WorldManifold2.prototype.recycle = function() {\n      zeroVec2(this.normal);\n      zeroVec2(this.points[0]);\n      zeroVec2(this.points[1]);\n      this.separations[0] = 0;\n      this.separations[1] = 0;\n      this.pointCount = 0;\n    };\n    return WorldManifold2;\n  }()\n);\nfunction getPointStates(state1, state2, manifold1, manifold2) {\n  for (var i = 0; i < manifold1.pointCount; ++i) {\n    var id = manifold1.points[i].id;\n    state1[i] = PointState.removeState;\n    for (var j = 0; j < manifold2.pointCount; ++j) {\n      if (manifold2.points[j].id.key === id.key) {\n        state1[i] = PointState.persistState;\n        break;\n      }\n    }\n  }\n  for (var i = 0; i < manifold2.pointCount; ++i) {\n    var id = manifold2.points[i].id;\n    state2[i] = PointState.addState;\n    for (var j = 0; j < manifold1.pointCount; ++j) {\n      if (manifold1.points[j].id.key === id.key) {\n        state2[i] = PointState.persistState;\n        break;\n      }\n    }\n  }\n}\nfunction clipSegmentToLine(vOut, vIn, normal3, offset, vertexIndexA) {\n  var numOut = 0;\n  var distance0 = dotVec2(normal3, vIn[0].v) - offset;\n  var distance1 = dotVec2(normal3, vIn[1].v) - offset;\n  if (distance0 <= 0)\n    vOut[numOut++].set(vIn[0]);\n  if (distance1 <= 0)\n    vOut[numOut++].set(vIn[1]);\n  if (distance0 * distance1 < 0) {\n    var interp = distance0 / (distance0 - distance1);\n    combine2Vec2(vOut[numOut].v, 1 - interp, vIn[0].v, interp, vIn[1].v);\n    vOut[numOut].id.setFeatures(vertexIndexA, ContactFeatureType.e_vertex, vIn[0].id.indexB, ContactFeatureType.e_face);\n    ++numOut;\n  }\n  return numOut;\n}\nvar math_sqrt$1 = Math.sqrt;\nvar math_max$2 = Math.max;\nvar math_min$4 = Math.min;\nvar contactPool = new Pool({\n  create: function() {\n    return new Contact();\n  },\n  release: function(contact) {\n    contact.recycle();\n  }\n});\nvar oldManifold = new Manifold();\nvar worldManifold = new WorldManifold();\nvar ContactEdge = (\n  /** @class */\n  function() {\n    function ContactEdge2(contact) {\n      this.prev = null;\n      this.next = null;\n      this.other = null;\n      this.contact = contact;\n    }\n    ContactEdge2.prototype.recycle = function() {\n      this.prev = null;\n      this.next = null;\n      this.other = null;\n    };\n    return ContactEdge2;\n  }()\n);\nfunction mixFriction(friction1, friction2) {\n  return math_sqrt$1(friction1 * friction2);\n}\nfunction mixRestitution(restitution1, restitution2) {\n  return restitution1 > restitution2 ? restitution1 : restitution2;\n}\nvar s_registers = [];\nvar VelocityConstraintPoint = (\n  /** @class */\n  function() {\n    function VelocityConstraintPoint2() {\n      this.rA = vec2(0, 0);\n      this.rB = vec2(0, 0);\n      this.normalImpulse = 0;\n      this.tangentImpulse = 0;\n      this.normalMass = 0;\n      this.tangentMass = 0;\n      this.velocityBias = 0;\n    }\n    VelocityConstraintPoint2.prototype.recycle = function() {\n      zeroVec2(this.rA);\n      zeroVec2(this.rB);\n      this.normalImpulse = 0;\n      this.tangentImpulse = 0;\n      this.normalMass = 0;\n      this.tangentMass = 0;\n      this.velocityBias = 0;\n    };\n    return VelocityConstraintPoint2;\n  }()\n);\nvar cA = vec2(0, 0);\nvar vA = vec2(0, 0);\nvar cB = vec2(0, 0);\nvar vB = vec2(0, 0);\nvar tangent$1 = vec2(0, 0);\nvar xfA = transform(0, 0, 0);\nvar xfB = transform(0, 0, 0);\nvar pointA = vec2(0, 0);\nvar pointB = vec2(0, 0);\nvar clipPoint = vec2(0, 0);\nvar planePoint$1 = vec2(0, 0);\nvar rA = vec2(0, 0);\nvar rB = vec2(0, 0);\nvar P$1 = vec2(0, 0);\nvar normal$2 = vec2(0, 0);\nvar point = vec2(0, 0);\nvar dv = vec2(0, 0);\nvar dv1 = vec2(0, 0);\nvar dv2 = vec2(0, 0);\nvar b = vec2(0, 0);\nvar a = vec2(0, 0);\nvar x = vec2(0, 0);\nvar d = vec2(0, 0);\nvar P1 = vec2(0, 0);\nvar P2 = vec2(0, 0);\nvar temp$2 = vec2(0, 0);\nvar Contact = (\n  /** @class */\n  function() {\n    function Contact2() {\n      this.m_nodeA = new ContactEdge(this);\n      this.m_nodeB = new ContactEdge(this);\n      this.m_fixtureA = null;\n      this.m_fixtureB = null;\n      this.m_indexA = -1;\n      this.m_indexB = -1;\n      this.m_evaluateFcn = null;\n      this.m_manifold = new Manifold();\n      this.m_prev = null;\n      this.m_next = null;\n      this.m_toi = 1;\n      this.m_toiCount = 0;\n      this.m_toiFlag = false;\n      this.m_friction = 0;\n      this.m_restitution = 0;\n      this.m_tangentSpeed = 0;\n      this.m_enabledFlag = true;\n      this.m_islandFlag = false;\n      this.m_touchingFlag = false;\n      this.m_filterFlag = false;\n      this.m_bulletHitFlag = false;\n      this.m_impulse = new ContactImpulse(this);\n      this.v_points = [new VelocityConstraintPoint(), new VelocityConstraintPoint()];\n      this.v_normal = vec2(0, 0);\n      this.v_normalMass = new Mat22();\n      this.v_K = new Mat22();\n      this.v_pointCount = 0;\n      this.v_tangentSpeed = 0;\n      this.v_friction = 0;\n      this.v_restitution = 0;\n      this.v_invMassA = 0;\n      this.v_invMassB = 0;\n      this.v_invIA = 0;\n      this.v_invIB = 0;\n      this.p_localPoints = [vec2(0, 0), vec2(0, 0)];\n      this.p_localNormal = vec2(0, 0);\n      this.p_localPoint = vec2(0, 0);\n      this.p_localCenterA = vec2(0, 0);\n      this.p_localCenterB = vec2(0, 0);\n      this.p_type = ManifoldType.e_unset;\n      this.p_radiusA = 0;\n      this.p_radiusB = 0;\n      this.p_pointCount = 0;\n      this.p_invMassA = 0;\n      this.p_invMassB = 0;\n      this.p_invIA = 0;\n      this.p_invIB = 0;\n    }\n    Contact2.prototype.initialize = function(fA, indexA, fB, indexB, evaluateFcn) {\n      this.m_fixtureA = fA;\n      this.m_fixtureB = fB;\n      this.m_indexA = indexA;\n      this.m_indexB = indexB;\n      this.m_evaluateFcn = evaluateFcn;\n      this.m_friction = mixFriction(this.m_fixtureA.m_friction, this.m_fixtureB.m_friction);\n      this.m_restitution = mixRestitution(this.m_fixtureA.m_restitution, this.m_fixtureB.m_restitution);\n    };\n    Contact2.prototype.recycle = function() {\n      this.m_nodeA.recycle();\n      this.m_nodeB.recycle();\n      this.m_fixtureA = null;\n      this.m_fixtureB = null;\n      this.m_indexA = -1;\n      this.m_indexB = -1;\n      this.m_evaluateFcn = null;\n      this.m_manifold.recycle();\n      this.m_prev = null;\n      this.m_next = null;\n      this.m_toi = 1;\n      this.m_toiCount = 0;\n      this.m_toiFlag = false;\n      this.m_friction = 0;\n      this.m_restitution = 0;\n      this.m_tangentSpeed = 0;\n      this.m_enabledFlag = true;\n      this.m_islandFlag = false;\n      this.m_touchingFlag = false;\n      this.m_filterFlag = false;\n      this.m_bulletHitFlag = false;\n      this.m_impulse.recycle();\n      for (var _i = 0, _a2 = this.v_points; _i < _a2.length; _i++) {\n        var point_1 = _a2[_i];\n        point_1.recycle();\n      }\n      zeroVec2(this.v_normal);\n      this.v_normalMass.setZero();\n      this.v_K.setZero();\n      this.v_pointCount = 0;\n      this.v_tangentSpeed = 0;\n      this.v_friction = 0;\n      this.v_restitution = 0;\n      this.v_invMassA = 0;\n      this.v_invMassB = 0;\n      this.v_invIA = 0;\n      this.v_invIB = 0;\n      for (var _b = 0, _c = this.p_localPoints; _b < _c.length; _b++) {\n        var point_2 = _c[_b];\n        zeroVec2(point_2);\n      }\n      zeroVec2(this.p_localNormal);\n      zeroVec2(this.p_localPoint);\n      zeroVec2(this.p_localCenterA);\n      zeroVec2(this.p_localCenterB);\n      this.p_type = ManifoldType.e_unset;\n      this.p_radiusA = 0;\n      this.p_radiusB = 0;\n      this.p_pointCount = 0;\n      this.p_invMassA = 0;\n      this.p_invMassB = 0;\n      this.p_invIA = 0;\n      this.p_invIB = 0;\n    };\n    Contact2.prototype.initConstraint = function(step) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var shapeA = fixtureA.m_shape;\n      var shapeB = fixtureB.m_shape;\n      if (shapeA === null || shapeB === null)\n        return;\n      var manifold = this.m_manifold;\n      var pointCount = manifold.pointCount;\n      this.v_invMassA = bodyA.m_invMass;\n      this.v_invMassB = bodyB.m_invMass;\n      this.v_invIA = bodyA.m_invI;\n      this.v_invIB = bodyB.m_invI;\n      this.v_friction = this.m_friction;\n      this.v_restitution = this.m_restitution;\n      this.v_tangentSpeed = this.m_tangentSpeed;\n      this.v_pointCount = pointCount;\n      this.v_K.setZero();\n      this.v_normalMass.setZero();\n      this.p_invMassA = bodyA.m_invMass;\n      this.p_invMassB = bodyB.m_invMass;\n      this.p_invIA = bodyA.m_invI;\n      this.p_invIB = bodyB.m_invI;\n      copyVec2(this.p_localCenterA, bodyA.m_sweep.localCenter);\n      copyVec2(this.p_localCenterB, bodyB.m_sweep.localCenter);\n      this.p_radiusA = shapeA.m_radius;\n      this.p_radiusB = shapeB.m_radius;\n      this.p_type = manifold.type;\n      copyVec2(this.p_localNormal, manifold.localNormal);\n      copyVec2(this.p_localPoint, manifold.localPoint);\n      this.p_pointCount = pointCount;\n      for (var j = 0; j < SettingsInternal.maxManifoldPoints; ++j) {\n        this.v_points[j].recycle();\n        zeroVec2(this.p_localPoints[j]);\n      }\n      for (var j = 0; j < pointCount; ++j) {\n        var cp = manifold.points[j];\n        var vcp = this.v_points[j];\n        if (step.warmStarting) {\n          vcp.normalImpulse = step.dtRatio * cp.normalImpulse;\n          vcp.tangentImpulse = step.dtRatio * cp.tangentImpulse;\n        }\n        copyVec2(this.p_localPoints[j], cp.localPoint);\n      }\n    };\n    Contact2.prototype.getManifold = function() {\n      return this.m_manifold;\n    };\n    Contact2.prototype.getWorldManifold = function(worldManifold2) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var shapeA = fixtureA.m_shape;\n      var shapeB = fixtureB.m_shape;\n      if (shapeA === null || shapeB === null)\n        return;\n      return this.m_manifold.getWorldManifold(worldManifold2, bodyA.getTransform(), shapeA.m_radius, bodyB.getTransform(), shapeB.m_radius);\n    };\n    Contact2.prototype.setEnabled = function(flag) {\n      this.m_enabledFlag = !!flag;\n    };\n    Contact2.prototype.isEnabled = function() {\n      return this.m_enabledFlag;\n    };\n    Contact2.prototype.isTouching = function() {\n      return this.m_touchingFlag;\n    };\n    Contact2.prototype.getNext = function() {\n      return this.m_next;\n    };\n    Contact2.prototype.getFixtureA = function() {\n      return this.m_fixtureA;\n    };\n    Contact2.prototype.getFixtureB = function() {\n      return this.m_fixtureB;\n    };\n    Contact2.prototype.getChildIndexA = function() {\n      return this.m_indexA;\n    };\n    Contact2.prototype.getChildIndexB = function() {\n      return this.m_indexB;\n    };\n    Contact2.prototype.flagForFiltering = function() {\n      this.m_filterFlag = true;\n    };\n    Contact2.prototype.setFriction = function(friction) {\n      this.m_friction = friction;\n    };\n    Contact2.prototype.getFriction = function() {\n      return this.m_friction;\n    };\n    Contact2.prototype.resetFriction = function() {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      this.m_friction = mixFriction(fixtureA.m_friction, fixtureB.m_friction);\n    };\n    Contact2.prototype.setRestitution = function(restitution) {\n      this.m_restitution = restitution;\n    };\n    Contact2.prototype.getRestitution = function() {\n      return this.m_restitution;\n    };\n    Contact2.prototype.resetRestitution = function() {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      this.m_restitution = mixRestitution(fixtureA.m_restitution, fixtureB.m_restitution);\n    };\n    Contact2.prototype.setTangentSpeed = function(speed) {\n      this.m_tangentSpeed = speed;\n    };\n    Contact2.prototype.getTangentSpeed = function() {\n      return this.m_tangentSpeed;\n    };\n    Contact2.prototype.evaluate = function(manifold, xfA2, xfB2) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      this.m_evaluateFcn(manifold, xfA2, fixtureA, this.m_indexA, xfB2, fixtureB, this.m_indexB);\n    };\n    Contact2.prototype.update = function(listener) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var shapeA = fixtureA.m_shape;\n      var shapeB = fixtureB.m_shape;\n      if (shapeA === null || shapeB === null)\n        return;\n      this.m_enabledFlag = true;\n      var touching = false;\n      var wasTouching = this.m_touchingFlag;\n      var sensorA = fixtureA.m_isSensor;\n      var sensorB = fixtureB.m_isSensor;\n      var sensor = sensorA || sensorB;\n      var xfA2 = bodyA.m_xf;\n      var xfB2 = bodyB.m_xf;\n      if (sensor) {\n        touching = testOverlap(shapeA, this.m_indexA, shapeB, this.m_indexB, xfA2, xfB2);\n        this.m_manifold.pointCount = 0;\n      } else {\n        oldManifold.recycle();\n        oldManifold.set(this.m_manifold);\n        this.m_manifold.recycle();\n        this.evaluate(this.m_manifold, xfA2, xfB2);\n        touching = this.m_manifold.pointCount > 0;\n        for (var i = 0; i < this.m_manifold.pointCount; ++i) {\n          var nmp = this.m_manifold.points[i];\n          nmp.normalImpulse = 0;\n          nmp.tangentImpulse = 0;\n          for (var j = 0; j < oldManifold.pointCount; ++j) {\n            var omp = oldManifold.points[j];\n            if (omp.id.key === nmp.id.key) {\n              nmp.normalImpulse = omp.normalImpulse;\n              nmp.tangentImpulse = omp.tangentImpulse;\n              break;\n            }\n          }\n        }\n        if (touching !== wasTouching) {\n          bodyA.setAwake(true);\n          bodyB.setAwake(true);\n        }\n      }\n      this.m_touchingFlag = touching;\n      var hasListener = typeof listener === \"object\" && listener !== null;\n      if (!wasTouching && touching && hasListener) {\n        listener.beginContact(this);\n      }\n      if (wasTouching && !touching && hasListener) {\n        listener.endContact(this);\n      }\n      if (!sensor && touching && hasListener && oldManifold) {\n        listener.preSolve(this, oldManifold);\n      }\n    };\n    Contact2.prototype.solvePositionConstraint = function(step) {\n      return this._solvePositionConstraint(step, null, null);\n    };\n    Contact2.prototype.solvePositionConstraintTOI = function(step, toiA, toiB) {\n      return this._solvePositionConstraint(step, toiA, toiB);\n    };\n    Contact2.prototype._solvePositionConstraint = function(step, toiA, toiB) {\n      var toi = toiA !== null && toiB !== null ? true : false;\n      var minSeparation = 0;\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return minSeparation;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return minSeparation;\n      var positionA = bodyA.c_position;\n      var positionB = bodyB.c_position;\n      var localCenterA = this.p_localCenterA;\n      var localCenterB = this.p_localCenterB;\n      var mA = 0;\n      var iA = 0;\n      if (!toi || bodyA === toiA || bodyA === toiB) {\n        mA = this.p_invMassA;\n        iA = this.p_invIA;\n      }\n      var mB = 0;\n      var iB = 0;\n      if (!toi || bodyB === toiA || bodyB === toiB) {\n        mB = this.p_invMassB;\n        iB = this.p_invIB;\n      }\n      copyVec2(cA, positionA.c);\n      var aA = positionA.a;\n      copyVec2(cB, positionB.c);\n      var aB = positionB.a;\n      for (var j = 0; j < this.p_pointCount; ++j) {\n        getTransform(xfA, localCenterA, cA, aA);\n        getTransform(xfB, localCenterB, cB, aB);\n        var separation = void 0;\n        switch (this.p_type) {\n          case ManifoldType.e_circles: {\n            transformVec2(pointA, xfA, this.p_localPoint);\n            transformVec2(pointB, xfB, this.p_localPoints[0]);\n            subVec2(normal$2, pointB, pointA);\n            normalizeVec2(normal$2);\n            combine2Vec2(point, 0.5, pointA, 0.5, pointB);\n            separation = dotVec2(pointB, normal$2) - dotVec2(pointA, normal$2) - this.p_radiusA - this.p_radiusB;\n            break;\n          }\n          case ManifoldType.e_faceA: {\n            rotVec2(normal$2, xfA.q, this.p_localNormal);\n            transformVec2(planePoint$1, xfA, this.p_localPoint);\n            transformVec2(clipPoint, xfB, this.p_localPoints[j]);\n            separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;\n            copyVec2(point, clipPoint);\n            break;\n          }\n          case ManifoldType.e_faceB: {\n            rotVec2(normal$2, xfB.q, this.p_localNormal);\n            transformVec2(planePoint$1, xfB, this.p_localPoint);\n            transformVec2(clipPoint, xfA, this.p_localPoints[j]);\n            separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;\n            copyVec2(point, clipPoint);\n            negVec2(normal$2);\n            break;\n          }\n          default: {\n            return minSeparation;\n          }\n        }\n        subVec2(rA, point, cA);\n        subVec2(rB, point, cB);\n        minSeparation = math_min$4(minSeparation, separation);\n        var baumgarte = toi ? SettingsInternal.toiBaugarte : SettingsInternal.baumgarte;\n        var linearSlop = SettingsInternal.linearSlop;\n        var maxLinearCorrection = SettingsInternal.maxLinearCorrection;\n        var C = clamp(baumgarte * (separation + linearSlop), -maxLinearCorrection, 0);\n        var rnA = crossVec2Vec2(rA, normal$2);\n        var rnB = crossVec2Vec2(rB, normal$2);\n        var K = mA + mB + iA * rnA * rnA + iB * rnB * rnB;\n        var impulse = K > 0 ? -C / K : 0;\n        scaleVec2(P$1, impulse, normal$2);\n        minusScaleVec2(cA, mA, P$1);\n        aA -= iA * crossVec2Vec2(rA, P$1);\n        plusScaleVec2(cB, mB, P$1);\n        aB += iB * crossVec2Vec2(rB, P$1);\n      }\n      copyVec2(positionA.c, cA);\n      positionA.a = aA;\n      copyVec2(positionB.c, cB);\n      positionB.a = aB;\n      return minSeparation;\n    };\n    Contact2.prototype.initVelocityConstraint = function(step) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var velocityA = bodyA.c_velocity;\n      var velocityB = bodyB.c_velocity;\n      var positionA = bodyA.c_position;\n      var positionB = bodyB.c_position;\n      var radiusA = this.p_radiusA;\n      var radiusB = this.p_radiusB;\n      var manifold = this.m_manifold;\n      var mA = this.v_invMassA;\n      var mB = this.v_invMassB;\n      var iA = this.v_invIA;\n      var iB = this.v_invIB;\n      var localCenterA = this.p_localCenterA;\n      var localCenterB = this.p_localCenterB;\n      copyVec2(cA, positionA.c);\n      var aA = positionA.a;\n      copyVec2(vA, velocityA.v);\n      var wA = velocityA.w;\n      copyVec2(cB, positionB.c);\n      var aB = positionB.a;\n      copyVec2(vB, velocityB.v);\n      var wB = velocityB.w;\n      getTransform(xfA, localCenterA, cA, aA);\n      getTransform(xfB, localCenterB, cB, aB);\n      worldManifold.recycle();\n      manifold.getWorldManifold(worldManifold, xfA, radiusA, xfB, radiusB);\n      copyVec2(this.v_normal, worldManifold.normal);\n      for (var j = 0; j < this.v_pointCount; ++j) {\n        var vcp = this.v_points[j];\n        var wmp = worldManifold.points[j];\n        subVec2(vcp.rA, wmp, cA);\n        subVec2(vcp.rB, wmp, cB);\n        var rnA = crossVec2Vec2(vcp.rA, this.v_normal);\n        var rnB = crossVec2Vec2(vcp.rB, this.v_normal);\n        var kNormal = mA + mB + iA * rnA * rnA + iB * rnB * rnB;\n        vcp.normalMass = kNormal > 0 ? 1 / kNormal : 0;\n        crossVec2Num(tangent$1, this.v_normal, 1);\n        var rtA = crossVec2Vec2(vcp.rA, tangent$1);\n        var rtB = crossVec2Vec2(vcp.rB, tangent$1);\n        var kTangent = mA + mB + iA * rtA * rtA + iB * rtB * rtB;\n        vcp.tangentMass = kTangent > 0 ? 1 / kTangent : 0;\n        vcp.velocityBias = 0;\n        var vRel = 0;\n        vRel += dotVec2(this.v_normal, vB);\n        vRel += dotVec2(this.v_normal, crossNumVec2(temp$2, wB, vcp.rB));\n        vRel -= dotVec2(this.v_normal, vA);\n        vRel -= dotVec2(this.v_normal, crossNumVec2(temp$2, wA, vcp.rA));\n        if (vRel < -SettingsInternal.velocityThreshold) {\n          vcp.velocityBias = -this.v_restitution * vRel;\n        }\n      }\n      if (this.v_pointCount == 2 && step.blockSolve) {\n        var vcp1 = this.v_points[0];\n        var vcp2 = this.v_points[1];\n        var rn1A = crossVec2Vec2(vcp1.rA, this.v_normal);\n        var rn1B = crossVec2Vec2(vcp1.rB, this.v_normal);\n        var rn2A = crossVec2Vec2(vcp2.rA, this.v_normal);\n        var rn2B = crossVec2Vec2(vcp2.rB, this.v_normal);\n        var k11 = mA + mB + iA * rn1A * rn1A + iB * rn1B * rn1B;\n        var k22 = mA + mB + iA * rn2A * rn2A + iB * rn2B * rn2B;\n        var k12 = mA + mB + iA * rn1A * rn2A + iB * rn1B * rn2B;\n        var k_maxConditionNumber = 1e3;\n        if (k11 * k11 < k_maxConditionNumber * (k11 * k22 - k12 * k12)) {\n          this.v_K.ex.setNum(k11, k12);\n          this.v_K.ey.setNum(k12, k22);\n          var a_1 = this.v_K.ex.x;\n          var b_1 = this.v_K.ey.x;\n          var c2 = this.v_K.ex.y;\n          var d_1 = this.v_K.ey.y;\n          var det = a_1 * d_1 - b_1 * c2;\n          if (det !== 0) {\n            det = 1 / det;\n          }\n          this.v_normalMass.ex.x = det * d_1;\n          this.v_normalMass.ey.x = -det * b_1;\n          this.v_normalMass.ex.y = -det * c2;\n          this.v_normalMass.ey.y = det * a_1;\n        } else {\n          this.v_pointCount = 1;\n        }\n      }\n      copyVec2(positionA.c, cA);\n      positionA.a = aA;\n      copyVec2(velocityA.v, vA);\n      velocityA.w = wA;\n      copyVec2(positionB.c, cB);\n      positionB.a = aB;\n      copyVec2(velocityB.v, vB);\n      velocityB.w = wB;\n    };\n    Contact2.prototype.warmStartConstraint = function(step) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var velocityA = bodyA.c_velocity;\n      var velocityB = bodyB.c_velocity;\n      var mA = this.v_invMassA;\n      var iA = this.v_invIA;\n      var mB = this.v_invMassB;\n      var iB = this.v_invIB;\n      copyVec2(vA, velocityA.v);\n      var wA = velocityA.w;\n      copyVec2(vB, velocityB.v);\n      var wB = velocityB.w;\n      copyVec2(normal$2, this.v_normal);\n      crossVec2Num(tangent$1, normal$2, 1);\n      for (var j = 0; j < this.v_pointCount; ++j) {\n        var vcp = this.v_points[j];\n        combine2Vec2(P$1, vcp.normalImpulse, normal$2, vcp.tangentImpulse, tangent$1);\n        wA -= iA * crossVec2Vec2(vcp.rA, P$1);\n        minusScaleVec2(vA, mA, P$1);\n        wB += iB * crossVec2Vec2(vcp.rB, P$1);\n        plusScaleVec2(vB, mB, P$1);\n      }\n      copyVec2(velocityA.v, vA);\n      velocityA.w = wA;\n      copyVec2(velocityB.v, vB);\n      velocityB.w = wB;\n    };\n    Contact2.prototype.storeConstraintImpulses = function(step) {\n      var manifold = this.m_manifold;\n      for (var j = 0; j < this.v_pointCount; ++j) {\n        manifold.points[j].normalImpulse = this.v_points[j].normalImpulse;\n        manifold.points[j].tangentImpulse = this.v_points[j].tangentImpulse;\n      }\n    };\n    Contact2.prototype.solveVelocityConstraint = function(step) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var velocityA = bodyA.c_velocity;\n      var velocityB = bodyB.c_velocity;\n      var mA = this.v_invMassA;\n      var iA = this.v_invIA;\n      var mB = this.v_invMassB;\n      var iB = this.v_invIB;\n      copyVec2(vA, velocityA.v);\n      var wA = velocityA.w;\n      copyVec2(vB, velocityB.v);\n      var wB = velocityB.w;\n      copyVec2(normal$2, this.v_normal);\n      crossVec2Num(tangent$1, normal$2, 1);\n      var friction = this.v_friction;\n      for (var j = 0; j < this.v_pointCount; ++j) {\n        var vcp = this.v_points[j];\n        zeroVec2(dv);\n        plusVec2(dv, vB);\n        plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));\n        minusVec2(dv, vA);\n        minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));\n        var vt = dotVec2(dv, tangent$1) - this.v_tangentSpeed;\n        var lambda = vcp.tangentMass * -vt;\n        var maxFriction = friction * vcp.normalImpulse;\n        var newImpulse = clamp(vcp.tangentImpulse + lambda, -maxFriction, maxFriction);\n        lambda = newImpulse - vcp.tangentImpulse;\n        vcp.tangentImpulse = newImpulse;\n        scaleVec2(P$1, lambda, tangent$1);\n        minusScaleVec2(vA, mA, P$1);\n        wA -= iA * crossVec2Vec2(vcp.rA, P$1);\n        plusScaleVec2(vB, mB, P$1);\n        wB += iB * crossVec2Vec2(vcp.rB, P$1);\n      }\n      if (this.v_pointCount == 1 || step.blockSolve == false) {\n        for (var i = 0; i < this.v_pointCount; ++i) {\n          var vcp = this.v_points[i];\n          zeroVec2(dv);\n          plusVec2(dv, vB);\n          plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));\n          minusVec2(dv, vA);\n          minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));\n          var vn = dotVec2(dv, normal$2);\n          var lambda = -vcp.normalMass * (vn - vcp.velocityBias);\n          var newImpulse = math_max$2(vcp.normalImpulse + lambda, 0);\n          lambda = newImpulse - vcp.normalImpulse;\n          vcp.normalImpulse = newImpulse;\n          scaleVec2(P$1, lambda, normal$2);\n          minusScaleVec2(vA, mA, P$1);\n          wA -= iA * crossVec2Vec2(vcp.rA, P$1);\n          plusScaleVec2(vB, mB, P$1);\n          wB += iB * crossVec2Vec2(vcp.rB, P$1);\n        }\n      } else {\n        var vcp1 = this.v_points[0];\n        var vcp2 = this.v_points[1];\n        setVec2(a, vcp1.normalImpulse, vcp2.normalImpulse);\n        zeroVec2(dv1);\n        plusVec2(dv1, vB);\n        plusVec2(dv1, crossNumVec2(temp$2, wB, vcp1.rB));\n        minusVec2(dv1, vA);\n        minusVec2(dv1, crossNumVec2(temp$2, wA, vcp1.rA));\n        zeroVec2(dv2);\n        plusVec2(dv2, vB);\n        plusVec2(dv2, crossNumVec2(temp$2, wB, vcp2.rB));\n        minusVec2(dv2, vA);\n        minusVec2(dv2, crossNumVec2(temp$2, wA, vcp2.rA));\n        var vn1 = dotVec2(dv1, normal$2);\n        var vn2 = dotVec2(dv2, normal$2);\n        setVec2(b, vn1 - vcp1.velocityBias, vn2 - vcp2.velocityBias);\n        b.x -= this.v_K.ex.x * a.x + this.v_K.ey.x * a.y;\n        b.y -= this.v_K.ex.y * a.x + this.v_K.ey.y * a.y;\n        while (true) {\n          zeroVec2(x);\n          x.x = -(this.v_normalMass.ex.x * b.x + this.v_normalMass.ey.x * b.y);\n          x.y = -(this.v_normalMass.ex.y * b.x + this.v_normalMass.ey.y * b.y);\n          if (x.x >= 0 && x.y >= 0) {\n            subVec2(d, x, a);\n            scaleVec2(P1, d.x, normal$2);\n            scaleVec2(P2, d.y, normal$2);\n            combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);\n            wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));\n            combine3Vec2(vB, mB, P1, mB, P2, 1, vB);\n            wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));\n            vcp1.normalImpulse = x.x;\n            vcp2.normalImpulse = x.y;\n            break;\n          }\n          x.x = -vcp1.normalMass * b.x;\n          x.y = 0;\n          vn1 = 0;\n          vn2 = this.v_K.ex.y * x.x + b.y;\n          if (x.x >= 0 && vn2 >= 0) {\n            subVec2(d, x, a);\n            scaleVec2(P1, d.x, normal$2);\n            scaleVec2(P2, d.y, normal$2);\n            combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);\n            wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));\n            combine3Vec2(vB, mB, P1, mB, P2, 1, vB);\n            wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));\n            vcp1.normalImpulse = x.x;\n            vcp2.normalImpulse = x.y;\n            break;\n          }\n          x.x = 0;\n          x.y = -vcp2.normalMass * b.y;\n          vn1 = this.v_K.ey.x * x.y + b.x;\n          vn2 = 0;\n          if (x.y >= 0 && vn1 >= 0) {\n            subVec2(d, x, a);\n            scaleVec2(P1, d.x, normal$2);\n            scaleVec2(P2, d.y, normal$2);\n            combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);\n            wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));\n            combine3Vec2(vB, mB, P1, mB, P2, 1, vB);\n            wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));\n            vcp1.normalImpulse = x.x;\n            vcp2.normalImpulse = x.y;\n            break;\n          }\n          x.x = 0;\n          x.y = 0;\n          vn1 = b.x;\n          vn2 = b.y;\n          if (vn1 >= 0 && vn2 >= 0) {\n            subVec2(d, x, a);\n            scaleVec2(P1, d.x, normal$2);\n            scaleVec2(P2, d.y, normal$2);\n            combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);\n            wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));\n            combine3Vec2(vB, mB, P1, mB, P2, 1, vB);\n            wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));\n            vcp1.normalImpulse = x.x;\n            vcp2.normalImpulse = x.y;\n            break;\n          }\n          break;\n        }\n      }\n      copyVec2(velocityA.v, vA);\n      velocityA.w = wA;\n      copyVec2(velocityB.v, vB);\n      velocityB.w = wB;\n    };\n    Contact2.addType = function(type1, type2, callback) {\n      s_registers[type1] = s_registers[type1] || {};\n      s_registers[type1][type2] = callback;\n    };\n    Contact2.create = function(fixtureA, indexA, fixtureB, indexB) {\n      var typeA = fixtureA.m_shape.m_type;\n      var typeB = fixtureB.m_shape.m_type;\n      var contact = contactPool.allocate();\n      var evaluateFcn;\n      if (evaluateFcn = s_registers[typeA] && s_registers[typeA][typeB]) {\n        contact.initialize(fixtureA, indexA, fixtureB, indexB, evaluateFcn);\n      } else if (evaluateFcn = s_registers[typeB] && s_registers[typeB][typeA]) {\n        contact.initialize(fixtureB, indexB, fixtureA, indexA, evaluateFcn);\n      } else {\n        return null;\n      }\n      fixtureA = contact.m_fixtureA;\n      fixtureB = contact.m_fixtureB;\n      indexA = contact.getChildIndexA();\n      indexB = contact.getChildIndexB();\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      contact.m_nodeA.contact = contact;\n      contact.m_nodeA.other = bodyB;\n      contact.m_nodeA.prev = null;\n      contact.m_nodeA.next = bodyA.m_contactList;\n      if (bodyA.m_contactList != null) {\n        bodyA.m_contactList.prev = contact.m_nodeA;\n      }\n      bodyA.m_contactList = contact.m_nodeA;\n      contact.m_nodeB.contact = contact;\n      contact.m_nodeB.other = bodyA;\n      contact.m_nodeB.prev = null;\n      contact.m_nodeB.next = bodyB.m_contactList;\n      if (bodyB.m_contactList != null) {\n        bodyB.m_contactList.prev = contact.m_nodeB;\n      }\n      bodyB.m_contactList = contact.m_nodeB;\n      if (fixtureA.isSensor() == false && fixtureB.isSensor() == false) {\n        bodyA.setAwake(true);\n        bodyB.setAwake(true);\n      }\n      return contact;\n    };\n    Contact2.destroy = function(contact, listener) {\n      var fixtureA = contact.m_fixtureA;\n      var fixtureB = contact.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      if (contact.isTouching()) {\n        listener.endContact(contact);\n      }\n      if (contact.m_nodeA.prev) {\n        contact.m_nodeA.prev.next = contact.m_nodeA.next;\n      }\n      if (contact.m_nodeA.next) {\n        contact.m_nodeA.next.prev = contact.m_nodeA.prev;\n      }\n      if (contact.m_nodeA == bodyA.m_contactList) {\n        bodyA.m_contactList = contact.m_nodeA.next;\n      }\n      if (contact.m_nodeB.prev) {\n        contact.m_nodeB.prev.next = contact.m_nodeB.next;\n      }\n      if (contact.m_nodeB.next) {\n        contact.m_nodeB.next.prev = contact.m_nodeB.prev;\n      }\n      if (contact.m_nodeB == bodyB.m_contactList) {\n        bodyB.m_contactList = contact.m_nodeB.next;\n      }\n      if (contact.m_manifold.pointCount > 0 && !fixtureA.m_isSensor && !fixtureB.m_isSensor) {\n        bodyA.setAwake(true);\n        bodyB.setAwake(true);\n      }\n      contactPool.release(contact);\n    };\n    return Contact2;\n  }()\n);\nvar DEFAULTS$b = {\n  gravity: Vec2.zero(),\n  allowSleep: true,\n  warmStarting: true,\n  continuousPhysics: true,\n  subStepping: false,\n  blockSolve: true,\n  velocityIterations: 8,\n  positionIterations: 3\n};\nvar World = (\n  /** @class */\n  function() {\n    function World2(def) {\n      if (!(this instanceof World2)) {\n        return new World2(def);\n      }\n      this.s_step = new TimeStep();\n      if (!def) {\n        def = {};\n      } else if (Vec2.isValid(def)) {\n        def = { gravity: def };\n      }\n      def = options(def, DEFAULTS$b);\n      this.m_solver = new Solver(this);\n      this.m_broadPhase = new BroadPhase();\n      this.m_contactList = null;\n      this.m_contactCount = 0;\n      this.m_bodyList = null;\n      this.m_bodyCount = 0;\n      this.m_jointList = null;\n      this.m_jointCount = 0;\n      this.m_stepComplete = true;\n      this.m_allowSleep = def.allowSleep;\n      this.m_gravity = Vec2.clone(def.gravity);\n      this.m_clearForces = true;\n      this.m_newFixture = false;\n      this.m_locked = false;\n      this.m_warmStarting = def.warmStarting;\n      this.m_continuousPhysics = def.continuousPhysics;\n      this.m_subStepping = def.subStepping;\n      this.m_blockSolve = def.blockSolve;\n      this.m_velocityIterations = def.velocityIterations;\n      this.m_positionIterations = def.positionIterations;\n      this.m_t = 0;\n      this.m_step_callback = [];\n    }\n    World2.prototype._serialize = function() {\n      var bodies = [];\n      var joints = [];\n      for (var b2 = this.getBodyList(); b2; b2 = b2.getNext()) {\n        bodies.push(b2);\n      }\n      for (var j = this.getJointList(); j; j = j.getNext()) {\n        if (typeof j._serialize === \"function\") {\n          joints.push(j);\n        }\n      }\n      return {\n        gravity: this.m_gravity,\n        bodies,\n        joints\n      };\n    };\n    World2._deserialize = function(data, context, restore) {\n      if (!data) {\n        return new World2();\n      }\n      var world = new World2(data.gravity);\n      if (data.bodies) {\n        for (var i = data.bodies.length - 1; i >= 0; i -= 1) {\n          world._addBody(restore(Body, data.bodies[i], world));\n        }\n      }\n      if (data.joints) {\n        for (var i = data.joints.length - 1; i >= 0; i--) {\n          world.createJoint(restore(Joint, data.joints[i], world));\n        }\n      }\n      return world;\n    };\n    World2.prototype.getBodyList = function() {\n      return this.m_bodyList;\n    };\n    World2.prototype.getJointList = function() {\n      return this.m_jointList;\n    };\n    World2.prototype.getContactList = function() {\n      return this.m_contactList;\n    };\n    World2.prototype.getBodyCount = function() {\n      return this.m_bodyCount;\n    };\n    World2.prototype.getJointCount = function() {\n      return this.m_jointCount;\n    };\n    World2.prototype.getContactCount = function() {\n      return this.m_contactCount;\n    };\n    World2.prototype.setGravity = function(gravity) {\n      this.m_gravity.set(gravity);\n    };\n    World2.prototype.getGravity = function() {\n      return this.m_gravity;\n    };\n    World2.prototype.isLocked = function() {\n      return this.m_locked;\n    };\n    World2.prototype.setAllowSleeping = function(flag) {\n      if (flag == this.m_allowSleep) {\n        return;\n      }\n      this.m_allowSleep = flag;\n      if (this.m_allowSleep == false) {\n        for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {\n          b2.setAwake(true);\n        }\n      }\n    };\n    World2.prototype.getAllowSleeping = function() {\n      return this.m_allowSleep;\n    };\n    World2.prototype.setWarmStarting = function(flag) {\n      this.m_warmStarting = flag;\n    };\n    World2.prototype.getWarmStarting = function() {\n      return this.m_warmStarting;\n    };\n    World2.prototype.setContinuousPhysics = function(flag) {\n      this.m_continuousPhysics = flag;\n    };\n    World2.prototype.getContinuousPhysics = function() {\n      return this.m_continuousPhysics;\n    };\n    World2.prototype.setSubStepping = function(flag) {\n      this.m_subStepping = flag;\n    };\n    World2.prototype.getSubStepping = function() {\n      return this.m_subStepping;\n    };\n    World2.prototype.setAutoClearForces = function(flag) {\n      this.m_clearForces = flag;\n    };\n    World2.prototype.getAutoClearForces = function() {\n      return this.m_clearForces;\n    };\n    World2.prototype.clearForces = function() {\n      for (var body = this.m_bodyList; body; body = body.getNext()) {\n        body.m_force.setZero();\n        body.m_torque = 0;\n      }\n    };\n    World2.prototype.queryAABB = function(aabb, callback) {\n      var broadPhase = this.m_broadPhase;\n      this.m_broadPhase.query(aabb, function(proxyId) {\n        var proxy = broadPhase.getUserData(proxyId);\n        return callback(proxy.fixture);\n      });\n    };\n    World2.prototype.rayCast = function(point1, point2, callback) {\n      var broadPhase = this.m_broadPhase;\n      this.m_broadPhase.rayCast({\n        maxFraction: 1,\n        p1: point1,\n        p2: point2\n      }, function(input2, proxyId) {\n        var proxy = broadPhase.getUserData(proxyId);\n        var fixture = proxy.fixture;\n        var index = proxy.childIndex;\n        var output2 = {};\n        var hit = fixture.rayCast(output2, input2, index);\n        if (hit) {\n          var fraction = output2.fraction;\n          var point3 = Vec2.add(Vec2.mulNumVec2(1 - fraction, input2.p1), Vec2.mulNumVec2(fraction, input2.p2));\n          return callback(fixture, point3, output2.normal, fraction);\n        }\n        return input2.maxFraction;\n      });\n    };\n    World2.prototype.getProxyCount = function() {\n      return this.m_broadPhase.getProxyCount();\n    };\n    World2.prototype.getTreeHeight = function() {\n      return this.m_broadPhase.getTreeHeight();\n    };\n    World2.prototype.getTreeBalance = function() {\n      return this.m_broadPhase.getTreeBalance();\n    };\n    World2.prototype.getTreeQuality = function() {\n      return this.m_broadPhase.getTreeQuality();\n    };\n    World2.prototype.shiftOrigin = function(newOrigin) {\n      if (this.isLocked()) {\n        return;\n      }\n      for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {\n        b2.m_xf.p.sub(newOrigin);\n        b2.m_sweep.c0.sub(newOrigin);\n        b2.m_sweep.c.sub(newOrigin);\n      }\n      for (var j = this.m_jointList; j; j = j.m_next) {\n        j.shiftOrigin(newOrigin);\n      }\n      this.m_broadPhase.shiftOrigin(newOrigin);\n    };\n    World2.prototype._addBody = function(body) {\n      if (this.isLocked()) {\n        return;\n      }\n      body.m_prev = null;\n      body.m_next = this.m_bodyList;\n      if (this.m_bodyList) {\n        this.m_bodyList.m_prev = body;\n      }\n      this.m_bodyList = body;\n      ++this.m_bodyCount;\n    };\n    World2.prototype.createBody = function(arg1, arg2) {\n      if (this.isLocked()) {\n        return null;\n      }\n      var def = {};\n      if (!arg1) ;\n      else if (Vec2.isValid(arg1)) {\n        def = { position: arg1, angle: arg2 };\n      } else if (typeof arg1 === \"object\") {\n        def = arg1;\n      }\n      var body = new Body(this, def);\n      this._addBody(body);\n      return body;\n    };\n    World2.prototype.createDynamicBody = function(arg1, arg2) {\n      var def = {};\n      if (!arg1) ;\n      else if (Vec2.isValid(arg1)) {\n        def = { position: arg1, angle: arg2 };\n      } else if (typeof arg1 === \"object\") {\n        def = arg1;\n      }\n      def.type = \"dynamic\";\n      return this.createBody(def);\n    };\n    World2.prototype.createKinematicBody = function(arg1, arg2) {\n      var def = {};\n      if (!arg1) ;\n      else if (Vec2.isValid(arg1)) {\n        def = { position: arg1, angle: arg2 };\n      } else if (typeof arg1 === \"object\") {\n        def = arg1;\n      }\n      def.type = \"kinematic\";\n      return this.createBody(def);\n    };\n    World2.prototype.destroyBody = function(b2) {\n      if (this.isLocked()) {\n        return;\n      }\n      if (b2.m_destroyed) {\n        return false;\n      }\n      var je = b2.m_jointList;\n      while (je) {\n        var je0 = je;\n        je = je.next;\n        this.publish(\"remove-joint\", je0.joint);\n        this.destroyJoint(je0.joint);\n        b2.m_jointList = je;\n      }\n      b2.m_jointList = null;\n      var ce = b2.m_contactList;\n      while (ce) {\n        var ce0 = ce;\n        ce = ce.next;\n        this.destroyContact(ce0.contact);\n        b2.m_contactList = ce;\n      }\n      b2.m_contactList = null;\n      var f = b2.m_fixtureList;\n      while (f) {\n        var f0 = f;\n        f = f.m_next;\n        this.publish(\"remove-fixture\", f0);\n        f0.destroyProxies(this.m_broadPhase);\n        b2.m_fixtureList = f;\n      }\n      b2.m_fixtureList = null;\n      if (b2.m_prev) {\n        b2.m_prev.m_next = b2.m_next;\n      }\n      if (b2.m_next) {\n        b2.m_next.m_prev = b2.m_prev;\n      }\n      if (b2 == this.m_bodyList) {\n        this.m_bodyList = b2.m_next;\n      }\n      b2.m_destroyed = true;\n      --this.m_bodyCount;\n      this.publish(\"remove-body\", b2);\n      return true;\n    };\n    World2.prototype.createJoint = function(joint) {\n      if (this.isLocked()) {\n        return null;\n      }\n      joint.m_prev = null;\n      joint.m_next = this.m_jointList;\n      if (this.m_jointList) {\n        this.m_jointList.m_prev = joint;\n      }\n      this.m_jointList = joint;\n      ++this.m_jointCount;\n      joint.m_edgeA.joint = joint;\n      joint.m_edgeA.other = joint.m_bodyB;\n      joint.m_edgeA.prev = null;\n      joint.m_edgeA.next = joint.m_bodyA.m_jointList;\n      if (joint.m_bodyA.m_jointList)\n        joint.m_bodyA.m_jointList.prev = joint.m_edgeA;\n      joint.m_bodyA.m_jointList = joint.m_edgeA;\n      joint.m_edgeB.joint = joint;\n      joint.m_edgeB.other = joint.m_bodyA;\n      joint.m_edgeB.prev = null;\n      joint.m_edgeB.next = joint.m_bodyB.m_jointList;\n      if (joint.m_bodyB.m_jointList)\n        joint.m_bodyB.m_jointList.prev = joint.m_edgeB;\n      joint.m_bodyB.m_jointList = joint.m_edgeB;\n      if (joint.m_collideConnected == false) {\n        for (var edge = joint.m_bodyB.getContactList(); edge; edge = edge.next) {\n          if (edge.other == joint.m_bodyA) {\n            edge.contact.flagForFiltering();\n          }\n        }\n      }\n      return joint;\n    };\n    World2.prototype.destroyJoint = function(joint) {\n      if (this.isLocked()) {\n        return;\n      }\n      if (joint.m_prev) {\n        joint.m_prev.m_next = joint.m_next;\n      }\n      if (joint.m_next) {\n        joint.m_next.m_prev = joint.m_prev;\n      }\n      if (joint == this.m_jointList) {\n        this.m_jointList = joint.m_next;\n      }\n      var bodyA = joint.m_bodyA;\n      var bodyB = joint.m_bodyB;\n      bodyA.setAwake(true);\n      bodyB.setAwake(true);\n      if (joint.m_edgeA.prev) {\n        joint.m_edgeA.prev.next = joint.m_edgeA.next;\n      }\n      if (joint.m_edgeA.next) {\n        joint.m_edgeA.next.prev = joint.m_edgeA.prev;\n      }\n      if (joint.m_edgeA == bodyA.m_jointList) {\n        bodyA.m_jointList = joint.m_edgeA.next;\n      }\n      joint.m_edgeA.prev = null;\n      joint.m_edgeA.next = null;\n      if (joint.m_edgeB.prev) {\n        joint.m_edgeB.prev.next = joint.m_edgeB.next;\n      }\n      if (joint.m_edgeB.next) {\n        joint.m_edgeB.next.prev = joint.m_edgeB.prev;\n      }\n      if (joint.m_edgeB == bodyB.m_jointList) {\n        bodyB.m_jointList = joint.m_edgeB.next;\n      }\n      joint.m_edgeB.prev = null;\n      joint.m_edgeB.next = null;\n      --this.m_jointCount;\n      if (joint.m_collideConnected == false) {\n        var edge = bodyB.getContactList();\n        while (edge) {\n          if (edge.other == bodyA) {\n            edge.contact.flagForFiltering();\n          }\n          edge = edge.next;\n        }\n      }\n      this.publish(\"remove-joint\", joint);\n    };\n    World2.prototype.step = function(timeStep, velocityIterations, positionIterations) {\n      this.publish(\"pre-step\", timeStep);\n      if ((velocityIterations | 0) !== velocityIterations) {\n        velocityIterations = 0;\n      }\n      velocityIterations = velocityIterations || this.m_velocityIterations;\n      positionIterations = positionIterations || this.m_positionIterations;\n      if (this.m_newFixture) {\n        this.findNewContacts();\n        this.m_newFixture = false;\n      }\n      this.m_locked = true;\n      this.s_step.reset(timeStep);\n      this.s_step.velocityIterations = velocityIterations;\n      this.s_step.positionIterations = positionIterations;\n      this.s_step.warmStarting = this.m_warmStarting;\n      this.s_step.blockSolve = this.m_blockSolve;\n      this.updateContacts();\n      if (this.m_stepComplete && timeStep > 0) {\n        this.m_solver.solveWorld(this.s_step);\n        for (var b2 = this.m_bodyList; b2; b2 = b2.getNext()) {\n          if (b2.m_islandFlag == false) {\n            continue;\n          }\n          if (b2.isStatic()) {\n            continue;\n          }\n          b2.synchronizeFixtures();\n        }\n        this.findNewContacts();\n      }\n      if (this.m_continuousPhysics && timeStep > 0) {\n        this.m_solver.solveWorldTOI(this.s_step);\n      }\n      if (this.m_clearForces) {\n        this.clearForces();\n      }\n      this.m_locked = false;\n      var callback;\n      while (callback = this.m_step_callback.shift()) {\n        callback(this);\n      }\n      this.publish(\"post-step\", timeStep);\n    };\n    World2.prototype.queueUpdate = function(callback) {\n      if (!this.isLocked()) {\n        callback(this);\n      } else {\n        this.m_step_callback.push(callback);\n      }\n    };\n    World2.prototype.findNewContacts = function() {\n      var _this = this;\n      this.m_broadPhase.updatePairs(function(proxyA, proxyB) {\n        return _this.createContact(proxyA, proxyB);\n      });\n    };\n    World2.prototype.createContact = function(proxyA, proxyB) {\n      var fixtureA = proxyA.fixture;\n      var fixtureB = proxyB.fixture;\n      var indexA = proxyA.childIndex;\n      var indexB = proxyB.childIndex;\n      var bodyA = fixtureA.getBody();\n      var bodyB = fixtureB.getBody();\n      if (bodyA == bodyB) {\n        return;\n      }\n      var edge = bodyB.getContactList();\n      while (edge) {\n        if (edge.other == bodyA) {\n          var fA = edge.contact.getFixtureA();\n          var fB = edge.contact.getFixtureB();\n          var iA = edge.contact.getChildIndexA();\n          var iB = edge.contact.getChildIndexB();\n          if (fA == fixtureA && fB == fixtureB && iA == indexA && iB == indexB) {\n            return;\n          }\n          if (fA == fixtureB && fB == fixtureA && iA == indexB && iB == indexA) {\n            return;\n          }\n        }\n        edge = edge.next;\n      }\n      if (bodyB.shouldCollide(bodyA) == false) {\n        return;\n      }\n      if (fixtureB.shouldCollide(fixtureA) == false) {\n        return;\n      }\n      var contact = Contact.create(fixtureA, indexA, fixtureB, indexB);\n      if (contact == null) {\n        return;\n      }\n      contact.m_prev = null;\n      if (this.m_contactList != null) {\n        contact.m_next = this.m_contactList;\n        this.m_contactList.m_prev = contact;\n      }\n      this.m_contactList = contact;\n      ++this.m_contactCount;\n    };\n    World2.prototype.updateContacts = function() {\n      var c2;\n      var next_c = this.m_contactList;\n      while (c2 = next_c) {\n        next_c = c2.getNext();\n        var fixtureA = c2.getFixtureA();\n        var fixtureB = c2.getFixtureB();\n        var indexA = c2.getChildIndexA();\n        var indexB = c2.getChildIndexB();\n        var bodyA = fixtureA.getBody();\n        var bodyB = fixtureB.getBody();\n        if (c2.m_filterFlag) {\n          if (bodyB.shouldCollide(bodyA) == false) {\n            this.destroyContact(c2);\n            continue;\n          }\n          if (fixtureB.shouldCollide(fixtureA) == false) {\n            this.destroyContact(c2);\n            continue;\n          }\n          c2.m_filterFlag = false;\n        }\n        var activeA = bodyA.isAwake() && !bodyA.isStatic();\n        var activeB = bodyB.isAwake() && !bodyB.isStatic();\n        if (activeA == false && activeB == false) {\n          continue;\n        }\n        var proxyIdA = fixtureA.m_proxies[indexA].proxyId;\n        var proxyIdB = fixtureB.m_proxies[indexB].proxyId;\n        var overlap = this.m_broadPhase.testOverlap(proxyIdA, proxyIdB);\n        if (overlap == false) {\n          this.destroyContact(c2);\n          continue;\n        }\n        c2.update(this);\n      }\n    };\n    World2.prototype.destroyContact = function(contact) {\n      if (contact.m_prev) {\n        contact.m_prev.m_next = contact.m_next;\n      }\n      if (contact.m_next) {\n        contact.m_next.m_prev = contact.m_prev;\n      }\n      if (contact == this.m_contactList) {\n        this.m_contactList = contact.m_next;\n      }\n      Contact.destroy(contact, this);\n      --this.m_contactCount;\n    };\n    World2.prototype.on = function(name, listener) {\n      if (typeof name !== \"string\" || typeof listener !== \"function\") {\n        return this;\n      }\n      if (!this._listeners) {\n        this._listeners = {};\n      }\n      if (!this._listeners[name]) {\n        this._listeners[name] = [];\n      }\n      this._listeners[name].push(listener);\n      return this;\n    };\n    World2.prototype.off = function(name, listener) {\n      if (typeof name !== \"string\" || typeof listener !== \"function\") {\n        return this;\n      }\n      var listeners = this._listeners && this._listeners[name];\n      if (!listeners || !listeners.length) {\n        return this;\n      }\n      var index = listeners.indexOf(listener);\n      if (index >= 0) {\n        listeners.splice(index, 1);\n      }\n      return this;\n    };\n    World2.prototype.publish = function(name, arg1, arg2, arg3) {\n      var listeners = this._listeners && this._listeners[name];\n      if (!listeners || !listeners.length) {\n        return 0;\n      }\n      for (var l = 0; l < listeners.length; l++) {\n        listeners[l].call(this, arg1, arg2, arg3);\n      }\n      return listeners.length;\n    };\n    World2.prototype.beginContact = function(contact) {\n      this.publish(\"begin-contact\", contact);\n    };\n    World2.prototype.endContact = function(contact) {\n      this.publish(\"end-contact\", contact);\n    };\n    World2.prototype.preSolve = function(contact, oldManifold2) {\n      this.publish(\"pre-solve\", contact, oldManifold2);\n    };\n    World2.prototype.postSolve = function(contact, impulse) {\n      this.publish(\"post-solve\", contact, impulse);\n    };\n    return World2;\n  }()\n);\nvar Vec3 = (\n  /** @class */\n  function() {\n    function Vec32(x2, y, z) {\n      if (!(this instanceof Vec32)) {\n        return new Vec32(x2, y, z);\n      }\n      if (typeof x2 === \"undefined\") {\n        this.x = 0;\n        this.y = 0;\n        this.z = 0;\n      } else if (typeof x2 === \"object\") {\n        this.x = x2.x;\n        this.y = x2.y;\n        this.z = x2.z;\n      } else {\n        this.x = x2;\n        this.y = y;\n        this.z = z;\n      }\n    }\n    Vec32.prototype._serialize = function() {\n      return {\n        x: this.x,\n        y: this.y,\n        z: this.z\n      };\n    };\n    Vec32._deserialize = function(data) {\n      var obj = Object.create(Vec32.prototype);\n      obj.x = data.x;\n      obj.y = data.y;\n      obj.z = data.z;\n      return obj;\n    };\n    Vec32.neo = function(x2, y, z) {\n      var obj = Object.create(Vec32.prototype);\n      obj.x = x2;\n      obj.y = y;\n      obj.z = z;\n      return obj;\n    };\n    Vec32.zero = function() {\n      var obj = Object.create(Vec32.prototype);\n      obj.x = 0;\n      obj.y = 0;\n      obj.z = 0;\n      return obj;\n    };\n    Vec32.clone = function(v3) {\n      return Vec32.neo(v3.x, v3.y, v3.z);\n    };\n    Vec32.prototype.toString = function() {\n      return JSON.stringify(this);\n    };\n    Vec32.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Number.isFinite(obj.x) && Number.isFinite(obj.y) && Number.isFinite(obj.z);\n    };\n    Vec32.assert = function(o) {\n    };\n    Vec32.prototype.setZero = function() {\n      this.x = 0;\n      this.y = 0;\n      this.z = 0;\n      return this;\n    };\n    Vec32.prototype.set = function(x2, y, z) {\n      this.x = x2;\n      this.y = y;\n      this.z = z;\n      return this;\n    };\n    Vec32.prototype.add = function(w) {\n      this.x += w.x;\n      this.y += w.y;\n      this.z += w.z;\n      return this;\n    };\n    Vec32.prototype.sub = function(w) {\n      this.x -= w.x;\n      this.y -= w.y;\n      this.z -= w.z;\n      return this;\n    };\n    Vec32.prototype.mul = function(m) {\n      this.x *= m;\n      this.y *= m;\n      this.z *= m;\n      return this;\n    };\n    Vec32.areEqual = function(v3, w) {\n      return v3 === w || typeof v3 === \"object\" && v3 !== null && typeof w === \"object\" && w !== null && v3.x === w.x && v3.y === w.y && v3.z === w.z;\n    };\n    Vec32.dot = function(v3, w) {\n      return v3.x * w.x + v3.y * w.y + v3.z * w.z;\n    };\n    Vec32.cross = function(v3, w) {\n      return new Vec32(v3.y * w.z - v3.z * w.y, v3.z * w.x - v3.x * w.z, v3.x * w.y - v3.y * w.x);\n    };\n    Vec32.add = function(v3, w) {\n      return new Vec32(v3.x + w.x, v3.y + w.y, v3.z + w.z);\n    };\n    Vec32.sub = function(v3, w) {\n      return new Vec32(v3.x - w.x, v3.y - w.y, v3.z - w.z);\n    };\n    Vec32.mul = function(v3, m) {\n      return new Vec32(m * v3.x, m * v3.y, m * v3.z);\n    };\n    Vec32.prototype.neg = function() {\n      this.x = -this.x;\n      this.y = -this.y;\n      this.z = -this.z;\n      return this;\n    };\n    Vec32.neg = function(v3) {\n      return new Vec32(-v3.x, -v3.y, -v3.z);\n    };\n    return Vec32;\n  }()\n);\nvar v1$2 = vec2(0, 0);\nvar v2$1 = vec2(0, 0);\nvar EdgeShape = (\n  /** @class */\n  function(_super) {\n    __extends(EdgeShape2, _super);\n    function EdgeShape2(v122, v22) {\n      var _this = this;\n      if (!(_this instanceof EdgeShape2)) {\n        return new EdgeShape2(v122, v22);\n      }\n      _this = _super.call(this) || this;\n      _this.m_type = EdgeShape2.TYPE;\n      _this.m_radius = SettingsInternal.polygonRadius;\n      _this.m_vertex1 = v122 ? Vec2.clone(v122) : Vec2.zero();\n      _this.m_vertex2 = v22 ? Vec2.clone(v22) : Vec2.zero();\n      _this.m_vertex0 = Vec2.zero();\n      _this.m_vertex3 = Vec2.zero();\n      _this.m_hasVertex0 = false;\n      _this.m_hasVertex3 = false;\n      return _this;\n    }\n    EdgeShape2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        vertex1: this.m_vertex1,\n        vertex2: this.m_vertex2,\n        vertex0: this.m_vertex0,\n        vertex3: this.m_vertex3,\n        hasVertex0: this.m_hasVertex0,\n        hasVertex3: this.m_hasVertex3\n      };\n    };\n    EdgeShape2._deserialize = function(data) {\n      var shape = new EdgeShape2(data.vertex1, data.vertex2);\n      if (shape.m_hasVertex0) {\n        shape.setPrevVertex(data.vertex0);\n      }\n      if (shape.m_hasVertex3) {\n        shape.setNextVertex(data.vertex3);\n      }\n      return shape;\n    };\n    EdgeShape2.prototype._reset = function() {\n    };\n    EdgeShape2.prototype.getRadius = function() {\n      return this.m_radius;\n    };\n    EdgeShape2.prototype.getType = function() {\n      return this.m_type;\n    };\n    EdgeShape2.prototype.setNext = function(v3) {\n      return this.setNextVertex(v3);\n    };\n    EdgeShape2.prototype.setNextVertex = function(v3) {\n      if (v3) {\n        this.m_vertex3.setVec2(v3);\n        this.m_hasVertex3 = true;\n      } else {\n        this.m_vertex3.setZero();\n        this.m_hasVertex3 = false;\n      }\n      return this;\n    };\n    EdgeShape2.prototype.getNextVertex = function() {\n      return this.m_vertex3;\n    };\n    EdgeShape2.prototype.setPrev = function(v3) {\n      return this.setPrevVertex(v3);\n    };\n    EdgeShape2.prototype.setPrevVertex = function(v3) {\n      if (v3) {\n        this.m_vertex0.setVec2(v3);\n        this.m_hasVertex0 = true;\n      } else {\n        this.m_vertex0.setZero();\n        this.m_hasVertex0 = false;\n      }\n      return this;\n    };\n    EdgeShape2.prototype.getPrevVertex = function() {\n      return this.m_vertex0;\n    };\n    EdgeShape2.prototype._set = function(v122, v22) {\n      this.m_vertex1.setVec2(v122);\n      this.m_vertex2.setVec2(v22);\n      this.m_hasVertex0 = false;\n      this.m_hasVertex3 = false;\n      return this;\n    };\n    EdgeShape2.prototype._clone = function() {\n      var clone = new EdgeShape2();\n      clone.m_type = this.m_type;\n      clone.m_radius = this.m_radius;\n      clone.m_vertex1.setVec2(this.m_vertex1);\n      clone.m_vertex2.setVec2(this.m_vertex2);\n      clone.m_vertex0.setVec2(this.m_vertex0);\n      clone.m_vertex3.setVec2(this.m_vertex3);\n      clone.m_hasVertex0 = this.m_hasVertex0;\n      clone.m_hasVertex3 = this.m_hasVertex3;\n      return clone;\n    };\n    EdgeShape2.prototype.getChildCount = function() {\n      return 1;\n    };\n    EdgeShape2.prototype.testPoint = function(xf2, p) {\n      return false;\n    };\n    EdgeShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {\n      var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));\n      var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));\n      var d2 = Vec2.sub(p2, p1);\n      var v122 = this.m_vertex1;\n      var v22 = this.m_vertex2;\n      var e3 = Vec2.sub(v22, v122);\n      var normal3 = Vec2.neo(e3.y, -e3.x);\n      normal3.normalize();\n      var numerator = Vec2.dot(normal3, Vec2.sub(v122, p1));\n      var denominator = Vec2.dot(normal3, d2);\n      if (denominator == 0) {\n        return false;\n      }\n      var t = numerator / denominator;\n      if (t < 0 || input2.maxFraction < t) {\n        return false;\n      }\n      var q = Vec2.add(p1, Vec2.mulNumVec2(t, d2));\n      var r = Vec2.sub(v22, v122);\n      var rr = Vec2.dot(r, r);\n      if (rr == 0) {\n        return false;\n      }\n      var s2 = Vec2.dot(Vec2.sub(q, v122), r) / rr;\n      if (s2 < 0 || 1 < s2) {\n        return false;\n      }\n      output2.fraction = t;\n      if (numerator > 0) {\n        output2.normal = Rot.mulVec2(xf2.q, normal3).neg();\n      } else {\n        output2.normal = Rot.mulVec2(xf2.q, normal3);\n      }\n      return true;\n    };\n    EdgeShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {\n      transformVec2(v1$2, xf2, this.m_vertex1);\n      transformVec2(v2$1, xf2, this.m_vertex2);\n      AABB.combinePoints(aabb, v1$2, v2$1);\n      AABB.extend(aabb, this.m_radius);\n    };\n    EdgeShape2.prototype.computeMass = function(massData, density) {\n      massData.mass = 0;\n      combine2Vec2(massData.center, 0.5, this.m_vertex1, 0.5, this.m_vertex2);\n      massData.I = 0;\n    };\n    EdgeShape2.prototype.computeDistanceProxy = function(proxy) {\n      proxy.m_vertices[0] = this.m_vertex1;\n      proxy.m_vertices[1] = this.m_vertex2;\n      proxy.m_vertices.length = 2;\n      proxy.m_count = 2;\n      proxy.m_radius = this.m_radius;\n    };\n    EdgeShape2.TYPE = \"edge\";\n    return EdgeShape2;\n  }(Shape)\n);\nvar v1$1 = vec2(0, 0);\nvar v2 = vec2(0, 0);\nvar ChainShape = (\n  /** @class */\n  function(_super) {\n    __extends(ChainShape2, _super);\n    function ChainShape2(vertices, loop) {\n      var _this = this;\n      if (!(_this instanceof ChainShape2)) {\n        return new ChainShape2(vertices, loop);\n      }\n      _this = _super.call(this) || this;\n      _this.m_type = ChainShape2.TYPE;\n      _this.m_radius = SettingsInternal.polygonRadius;\n      _this.m_vertices = [];\n      _this.m_count = 0;\n      _this.m_prevVertex = null;\n      _this.m_nextVertex = null;\n      _this.m_hasPrevVertex = false;\n      _this.m_hasNextVertex = false;\n      _this.m_isLoop = !!loop;\n      if (vertices && vertices.length) {\n        if (loop) {\n          _this._createLoop(vertices);\n        } else {\n          _this._createChain(vertices);\n        }\n      }\n      return _this;\n    }\n    ChainShape2.prototype._serialize = function() {\n      var data = {\n        type: this.m_type,\n        vertices: this.m_isLoop ? this.m_vertices.slice(0, this.m_vertices.length - 1) : this.m_vertices,\n        isLoop: this.m_isLoop,\n        hasPrevVertex: this.m_hasPrevVertex,\n        hasNextVertex: this.m_hasNextVertex,\n        prevVertex: null,\n        nextVertex: null\n      };\n      if (this.m_prevVertex) {\n        data.prevVertex = this.m_prevVertex;\n      }\n      if (this.m_nextVertex) {\n        data.nextVertex = this.m_nextVertex;\n      }\n      return data;\n    };\n    ChainShape2._deserialize = function(data, fixture, restore) {\n      var vertices = [];\n      if (data.vertices) {\n        for (var i = 0; i < data.vertices.length; i++) {\n          vertices.push(restore(Vec2, data.vertices[i]));\n        }\n      }\n      var shape = new ChainShape2(vertices, data.isLoop);\n      if (data.prevVertex) {\n        shape.setPrevVertex(data.prevVertex);\n      }\n      if (data.nextVertex) {\n        shape.setNextVertex(data.nextVertex);\n      }\n      return shape;\n    };\n    ChainShape2.prototype.getType = function() {\n      return this.m_type;\n    };\n    ChainShape2.prototype.getRadius = function() {\n      return this.m_radius;\n    };\n    ChainShape2.prototype._createLoop = function(vertices) {\n      if (vertices.length < 3) {\n        return;\n      }\n      var i;\n      this.m_vertices = [];\n      this.m_count = vertices.length + 1;\n      for (var i = 0; i < vertices.length; ++i) {\n        this.m_vertices[i] = Vec2.clone(vertices[i]);\n      }\n      this.m_vertices[vertices.length] = Vec2.clone(vertices[0]);\n      this.m_prevVertex = this.m_vertices[this.m_count - 2];\n      this.m_nextVertex = this.m_vertices[1];\n      this.m_hasPrevVertex = true;\n      this.m_hasNextVertex = true;\n      return this;\n    };\n    ChainShape2.prototype._createChain = function(vertices) {\n      var i;\n      this.m_vertices = [];\n      this.m_count = vertices.length;\n      for (var i = 0; i < vertices.length; ++i) {\n        this.m_vertices[i] = Vec2.clone(vertices[i]);\n      }\n      this.m_prevVertex = null;\n      this.m_nextVertex = null;\n      this.m_hasPrevVertex = false;\n      this.m_hasNextVertex = false;\n      return this;\n    };\n    ChainShape2.prototype._reset = function() {\n      if (this.m_isLoop) {\n        this._createLoop(this.m_vertices.slice(0, this.m_vertices.length - 1));\n      } else {\n        this._createChain(this.m_vertices);\n      }\n    };\n    ChainShape2.prototype.setPrevVertex = function(prevVertex) {\n      this.m_prevVertex = prevVertex;\n      this.m_hasPrevVertex = true;\n    };\n    ChainShape2.prototype.getPrevVertex = function() {\n      return this.m_prevVertex;\n    };\n    ChainShape2.prototype.setNextVertex = function(nextVertex) {\n      this.m_nextVertex = nextVertex;\n      this.m_hasNextVertex = true;\n    };\n    ChainShape2.prototype.getNextVertex = function() {\n      return this.m_nextVertex;\n    };\n    ChainShape2.prototype._clone = function() {\n      var clone = new ChainShape2();\n      clone._createChain(this.m_vertices);\n      clone.m_type = this.m_type;\n      clone.m_radius = this.m_radius;\n      clone.m_prevVertex = this.m_prevVertex;\n      clone.m_nextVertex = this.m_nextVertex;\n      clone.m_hasPrevVertex = this.m_hasPrevVertex;\n      clone.m_hasNextVertex = this.m_hasNextVertex;\n      return clone;\n    };\n    ChainShape2.prototype.getChildCount = function() {\n      return this.m_count - 1;\n    };\n    ChainShape2.prototype.getChildEdge = function(edge, childIndex) {\n      edge.m_type = EdgeShape.TYPE;\n      edge.m_radius = this.m_radius;\n      edge.m_vertex1 = this.m_vertices[childIndex];\n      edge.m_vertex2 = this.m_vertices[childIndex + 1];\n      if (childIndex > 0) {\n        edge.m_vertex0 = this.m_vertices[childIndex - 1];\n        edge.m_hasVertex0 = true;\n      } else {\n        edge.m_vertex0 = this.m_prevVertex;\n        edge.m_hasVertex0 = this.m_hasPrevVertex;\n      }\n      if (childIndex < this.m_count - 2) {\n        edge.m_vertex3 = this.m_vertices[childIndex + 2];\n        edge.m_hasVertex3 = true;\n      } else {\n        edge.m_vertex3 = this.m_nextVertex;\n        edge.m_hasVertex3 = this.m_hasNextVertex;\n      }\n    };\n    ChainShape2.prototype.getVertex = function(index) {\n      if (index < this.m_count) {\n        return this.m_vertices[index];\n      } else {\n        return this.m_vertices[0];\n      }\n    };\n    ChainShape2.prototype.isLoop = function() {\n      return this.m_isLoop;\n    };\n    ChainShape2.prototype.testPoint = function(xf2, p) {\n      return false;\n    };\n    ChainShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {\n      var edgeShape = new EdgeShape(this.getVertex(childIndex), this.getVertex(childIndex + 1));\n      return edgeShape.rayCast(output2, input2, xf2, 0);\n    };\n    ChainShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {\n      transformVec2(v1$1, xf2, this.getVertex(childIndex));\n      transformVec2(v2, xf2, this.getVertex(childIndex + 1));\n      AABB.combinePoints(aabb, v1$1, v2);\n    };\n    ChainShape2.prototype.computeMass = function(massData, density) {\n      massData.mass = 0;\n      zeroVec2(massData.center);\n      massData.I = 0;\n    };\n    ChainShape2.prototype.computeDistanceProxy = function(proxy, childIndex) {\n      proxy.m_vertices[0] = this.getVertex(childIndex);\n      proxy.m_vertices[1] = this.getVertex(childIndex + 1);\n      proxy.m_count = 2;\n      proxy.m_radius = this.m_radius;\n    };\n    ChainShape2.TYPE = \"chain\";\n    return ChainShape2;\n  }(Shape)\n);\nvar math_max$1 = Math.max;\nvar math_min$3 = Math.min;\nvar temp$1 = vec2(0, 0);\nvar e$1 = vec2(0, 0);\nvar e1$1 = vec2(0, 0);\nvar e2$1 = vec2(0, 0);\nvar center = vec2(0, 0);\nvar s = vec2(0, 0);\nvar PolygonShape = (\n  /** @class */\n  function(_super) {\n    __extends(PolygonShape2, _super);\n    function PolygonShape2(vertices) {\n      var _this = this;\n      if (!(_this instanceof PolygonShape2)) {\n        return new PolygonShape2(vertices);\n      }\n      _this = _super.call(this) || this;\n      _this.m_type = PolygonShape2.TYPE;\n      _this.m_radius = SettingsInternal.polygonRadius;\n      _this.m_centroid = Vec2.zero();\n      _this.m_vertices = [];\n      _this.m_normals = [];\n      _this.m_count = 0;\n      if (vertices && vertices.length) {\n        _this._set(vertices);\n      }\n      return _this;\n    }\n    PolygonShape2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        vertices: this.m_vertices\n      };\n    };\n    PolygonShape2._deserialize = function(data, fixture, restore) {\n      var vertices = [];\n      if (data.vertices) {\n        for (var i = 0; i < data.vertices.length; i++) {\n          vertices.push(restore(Vec2, data.vertices[i]));\n        }\n      }\n      var shape = new PolygonShape2(vertices);\n      return shape;\n    };\n    PolygonShape2.prototype.getType = function() {\n      return this.m_type;\n    };\n    PolygonShape2.prototype.getRadius = function() {\n      return this.m_radius;\n    };\n    PolygonShape2.prototype._clone = function() {\n      var clone = new PolygonShape2();\n      clone.m_type = this.m_type;\n      clone.m_radius = this.m_radius;\n      clone.m_count = this.m_count;\n      clone.m_centroid.setVec2(this.m_centroid);\n      for (var i = 0; i < this.m_count; i++) {\n        clone.m_vertices.push(this.m_vertices[i].clone());\n      }\n      for (var i = 0; i < this.m_normals.length; i++) {\n        clone.m_normals.push(this.m_normals[i].clone());\n      }\n      return clone;\n    };\n    PolygonShape2.prototype.getChildCount = function() {\n      return 1;\n    };\n    PolygonShape2.prototype._reset = function() {\n      this._set(this.m_vertices);\n    };\n    PolygonShape2.prototype._set = function(vertices) {\n      if (vertices.length < 3) {\n        this._setAsBox(1, 1);\n        return;\n      }\n      var n2 = math_min$3(vertices.length, SettingsInternal.maxPolygonVertices);\n      var ps = [];\n      for (var i = 0; i < n2; ++i) {\n        var v3 = vertices[i];\n        var unique = true;\n        for (var j = 0; j < ps.length; ++j) {\n          if (Vec2.distanceSquared(v3, ps[j]) < 0.25 * SettingsInternal.linearSlopSquared) {\n            unique = false;\n            break;\n          }\n        }\n        if (unique) {\n          ps.push(Vec2.clone(v3));\n        }\n      }\n      n2 = ps.length;\n      if (n2 < 3) {\n        this._setAsBox(1, 1);\n        return;\n      }\n      var i0 = 0;\n      var x0 = ps[0].x;\n      for (var i = 1; i < n2; ++i) {\n        var x2 = ps[i].x;\n        if (x2 > x0 || x2 === x0 && ps[i].y < ps[i0].y) {\n          i0 = i;\n          x0 = x2;\n        }\n      }\n      var hull = [];\n      var m = 0;\n      var ih = i0;\n      while (true) {\n        hull[m] = ih;\n        var ie2 = 0;\n        for (var j = 1; j < n2; ++j) {\n          if (ie2 === ih) {\n            ie2 = j;\n            continue;\n          }\n          var r = Vec2.sub(ps[ie2], ps[hull[m]]);\n          var v3 = Vec2.sub(ps[j], ps[hull[m]]);\n          var c2 = Vec2.crossVec2Vec2(r, v3);\n          if (c2 < 0) {\n            ie2 = j;\n          }\n          if (c2 === 0 && v3.lengthSquared() > r.lengthSquared()) {\n            ie2 = j;\n          }\n        }\n        ++m;\n        ih = ie2;\n        if (ie2 === i0) {\n          break;\n        }\n      }\n      if (m < 3) {\n        this._setAsBox(1, 1);\n        return;\n      }\n      this.m_count = m;\n      this.m_vertices = [];\n      for (var i = 0; i < m; ++i) {\n        this.m_vertices[i] = ps[hull[i]];\n      }\n      for (var i = 0; i < m; ++i) {\n        var i1 = i;\n        var i2 = i + 1 < m ? i + 1 : 0;\n        var edge = Vec2.sub(this.m_vertices[i2], this.m_vertices[i1]);\n        this.m_normals[i] = Vec2.crossVec2Num(edge, 1);\n        this.m_normals[i].normalize();\n      }\n      this.m_centroid = computeCentroid(this.m_vertices, m);\n    };\n    PolygonShape2.prototype._setAsBox = function(hx, hy, center2, angle) {\n      this.m_vertices[0] = Vec2.neo(hx, -hy);\n      this.m_vertices[1] = Vec2.neo(hx, hy);\n      this.m_vertices[2] = Vec2.neo(-hx, hy);\n      this.m_vertices[3] = Vec2.neo(-hx, -hy);\n      this.m_normals[0] = Vec2.neo(1, 0);\n      this.m_normals[1] = Vec2.neo(0, 1);\n      this.m_normals[2] = Vec2.neo(-1, 0);\n      this.m_normals[3] = Vec2.neo(0, -1);\n      this.m_count = 4;\n      if (center2 && Vec2.isValid(center2)) {\n        angle = angle || 0;\n        copyVec2(this.m_centroid, center2);\n        var xf2 = Transform.identity();\n        xf2.p.setVec2(center2);\n        xf2.q.setAngle(angle);\n        for (var i = 0; i < this.m_count; ++i) {\n          this.m_vertices[i] = Transform.mulVec2(xf2, this.m_vertices[i]);\n          this.m_normals[i] = Rot.mulVec2(xf2.q, this.m_normals[i]);\n        }\n      }\n    };\n    PolygonShape2.prototype.testPoint = function(xf2, p) {\n      var pLocal = detransformVec2(temp$1, xf2, p);\n      for (var i = 0; i < this.m_count; ++i) {\n        var dot = dotVec2(this.m_normals[i], pLocal) - dotVec2(this.m_normals[i], this.m_vertices[i]);\n        if (dot > 0) {\n          return false;\n        }\n      }\n      return true;\n    };\n    PolygonShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {\n      var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));\n      var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));\n      var d2 = Vec2.sub(p2, p1);\n      var lower = 0;\n      var upper = input2.maxFraction;\n      var index = -1;\n      for (var i = 0; i < this.m_count; ++i) {\n        var numerator = Vec2.dot(this.m_normals[i], Vec2.sub(this.m_vertices[i], p1));\n        var denominator = Vec2.dot(this.m_normals[i], d2);\n        if (denominator == 0) {\n          if (numerator < 0) {\n            return false;\n          }\n        } else {\n          if (denominator < 0 && numerator < lower * denominator) {\n            lower = numerator / denominator;\n            index = i;\n          } else if (denominator > 0 && numerator < upper * denominator) {\n            upper = numerator / denominator;\n          }\n        }\n        if (upper < lower) {\n          return false;\n        }\n      }\n      if (index >= 0) {\n        output2.fraction = lower;\n        output2.normal = Rot.mulVec2(xf2.q, this.m_normals[index]);\n        return true;\n      }\n      return false;\n    };\n    PolygonShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {\n      var minX = Infinity;\n      var minY = Infinity;\n      var maxX = -Infinity;\n      var maxY = -Infinity;\n      for (var i = 0; i < this.m_count; ++i) {\n        var v3 = transformVec2(temp$1, xf2, this.m_vertices[i]);\n        minX = math_min$3(minX, v3.x);\n        maxX = math_max$1(maxX, v3.x);\n        minY = math_min$3(minY, v3.y);\n        maxY = math_max$1(maxY, v3.y);\n      }\n      setVec2(aabb.lowerBound, minX - this.m_radius, minY - this.m_radius);\n      setVec2(aabb.upperBound, maxX + this.m_radius, maxY + this.m_radius);\n    };\n    PolygonShape2.prototype.computeMass = function(massData, density) {\n      zeroVec2(center);\n      var area = 0;\n      var I = 0;\n      zeroVec2(s);\n      for (var i = 0; i < this.m_count; ++i) {\n        plusVec2(s, this.m_vertices[i]);\n      }\n      scaleVec2(s, 1 / this.m_count, s);\n      var k_inv3 = 1 / 3;\n      for (var i = 0; i < this.m_count; ++i) {\n        subVec2(e1$1, this.m_vertices[i], s);\n        if (i + 1 < this.m_count) {\n          subVec2(e2$1, this.m_vertices[i + 1], s);\n        } else {\n          subVec2(e2$1, this.m_vertices[0], s);\n        }\n        var D = crossVec2Vec2(e1$1, e2$1);\n        var triangleArea = 0.5 * D;\n        area += triangleArea;\n        combine2Vec2(temp$1, triangleArea * k_inv3, e1$1, triangleArea * k_inv3, e2$1);\n        plusVec2(center, temp$1);\n        var ex1 = e1$1.x;\n        var ey1 = e1$1.y;\n        var ex2 = e2$1.x;\n        var ey2 = e2$1.y;\n        var intx2 = ex1 * ex1 + ex2 * ex1 + ex2 * ex2;\n        var inty2 = ey1 * ey1 + ey2 * ey1 + ey2 * ey2;\n        I += 0.25 * k_inv3 * D * (intx2 + inty2);\n      }\n      massData.mass = density * area;\n      scaleVec2(center, 1 / area, center);\n      addVec2(massData.center, center, s);\n      massData.I = density * I;\n      massData.I += massData.mass * (dotVec2(massData.center, massData.center) - dotVec2(center, center));\n    };\n    PolygonShape2.prototype.validate = function() {\n      for (var i = 0; i < this.m_count; ++i) {\n        var i1 = i;\n        var i2 = i < this.m_count - 1 ? i1 + 1 : 0;\n        var p = this.m_vertices[i1];\n        subVec2(e$1, this.m_vertices[i2], p);\n        for (var j = 0; j < this.m_count; ++j) {\n          if (j == i1 || j == i2) {\n            continue;\n          }\n          var c2 = crossVec2Vec2(e$1, subVec2(temp$1, this.m_vertices[j], p));\n          if (c2 < 0) {\n            return false;\n          }\n        }\n      }\n      return true;\n    };\n    PolygonShape2.prototype.computeDistanceProxy = function(proxy) {\n      for (var i = 0; i < this.m_count; ++i) {\n        proxy.m_vertices[i] = this.m_vertices[i];\n      }\n      proxy.m_vertices.length = this.m_count;\n      proxy.m_count = this.m_count;\n      proxy.m_radius = this.m_radius;\n    };\n    PolygonShape2.TYPE = \"polygon\";\n    return PolygonShape2;\n  }(Shape)\n);\nfunction computeCentroid(vs, count) {\n  var c2 = Vec2.zero();\n  var area = 0;\n  var pRef = Vec2.zero();\n  var i;\n  var inv3 = 1 / 3;\n  for (var i = 0; i < count; ++i) {\n    var p1 = pRef;\n    var p2 = vs[i];\n    var p3 = i + 1 < count ? vs[i + 1] : vs[0];\n    var e1_1 = Vec2.sub(p2, p1);\n    var e2_1 = Vec2.sub(p3, p1);\n    var D = Vec2.crossVec2Vec2(e1_1, e2_1);\n    var triangleArea = 0.5 * D;\n    area += triangleArea;\n    combine3Vec2(temp$1, 1, p1, 1, p2, 1, p3);\n    plusScaleVec2(c2, triangleArea * inv3, temp$1);\n  }\n  c2.mul(1 / area);\n  return c2;\n}\nvar math_sqrt = Math.sqrt;\nvar math_PI$4 = Math.PI;\nvar temp = vec2(0, 0);\nvar CircleShape = (\n  /** @class */\n  function(_super) {\n    __extends(CircleShape2, _super);\n    function CircleShape2(a2, b2) {\n      var _this = this;\n      if (!(_this instanceof CircleShape2)) {\n        return new CircleShape2(a2, b2);\n      }\n      _this = _super.call(this) || this;\n      _this.m_type = CircleShape2.TYPE;\n      _this.m_p = Vec2.zero();\n      _this.m_radius = 1;\n      if (typeof a2 === \"object\" && Vec2.isValid(a2)) {\n        _this.m_p.setVec2(a2);\n        if (typeof b2 === \"number\") {\n          _this.m_radius = b2;\n        }\n      } else if (typeof a2 === \"number\") {\n        _this.m_radius = a2;\n      }\n      return _this;\n    }\n    CircleShape2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        p: this.m_p,\n        radius: this.m_radius\n      };\n    };\n    CircleShape2._deserialize = function(data) {\n      return new CircleShape2(data.p, data.radius);\n    };\n    CircleShape2.prototype._reset = function() {\n    };\n    CircleShape2.prototype.getType = function() {\n      return this.m_type;\n    };\n    CircleShape2.prototype.getRadius = function() {\n      return this.m_radius;\n    };\n    CircleShape2.prototype.getCenter = function() {\n      return this.m_p;\n    };\n    CircleShape2.prototype._clone = function() {\n      var clone = new CircleShape2();\n      clone.m_type = this.m_type;\n      clone.m_radius = this.m_radius;\n      clone.m_p = this.m_p.clone();\n      return clone;\n    };\n    CircleShape2.prototype.getChildCount = function() {\n      return 1;\n    };\n    CircleShape2.prototype.testPoint = function(xf2, p) {\n      var center2 = transformVec2(temp, xf2, this.m_p);\n      return distSqrVec2(p, center2) <= this.m_radius * this.m_radius;\n    };\n    CircleShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {\n      var position = Vec2.add(xf2.p, Rot.mulVec2(xf2.q, this.m_p));\n      var s2 = Vec2.sub(input2.p1, position);\n      var b2 = Vec2.dot(s2, s2) - this.m_radius * this.m_radius;\n      var r = Vec2.sub(input2.p2, input2.p1);\n      var c2 = Vec2.dot(s2, r);\n      var rr = Vec2.dot(r, r);\n      var sigma = c2 * c2 - rr * b2;\n      if (sigma < 0 || rr < EPSILON) {\n        return false;\n      }\n      var a2 = -(c2 + math_sqrt(sigma));\n      if (0 <= a2 && a2 <= input2.maxFraction * rr) {\n        a2 /= rr;\n        output2.fraction = a2;\n        output2.normal = Vec2.add(s2, Vec2.mulNumVec2(a2, r));\n        output2.normal.normalize();\n        return true;\n      }\n      return false;\n    };\n    CircleShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {\n      var p = transformVec2(temp, xf2, this.m_p);\n      setVec2(aabb.lowerBound, p.x - this.m_radius, p.y - this.m_radius);\n      setVec2(aabb.upperBound, p.x + this.m_radius, p.y + this.m_radius);\n    };\n    CircleShape2.prototype.computeMass = function(massData, density) {\n      massData.mass = density * math_PI$4 * this.m_radius * this.m_radius;\n      copyVec2(massData.center, this.m_p);\n      massData.I = massData.mass * (0.5 * this.m_radius * this.m_radius + lengthSqrVec2(this.m_p));\n    };\n    CircleShape2.prototype.computeDistanceProxy = function(proxy) {\n      proxy.m_vertices[0] = this.m_p;\n      proxy.m_vertices.length = 1;\n      proxy.m_count = 1;\n      proxy.m_radius = this.m_radius;\n    };\n    CircleShape2.TYPE = \"circle\";\n    return CircleShape2;\n  }(Shape)\n);\nvar math_abs$5 = Math.abs;\nvar math_PI$3 = Math.PI;\nvar DEFAULTS$a = {\n  frequencyHz: 0,\n  dampingRatio: 0\n};\nvar DistanceJoint = (\n  /** @class */\n  function(_super) {\n    __extends(DistanceJoint2, _super);\n    function DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB) {\n      var _this = this;\n      if (!(_this instanceof DistanceJoint2)) {\n        return new DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB);\n      }\n      if (bodyB && anchorA && \"m_type\" in anchorA && \"x\" in bodyB && \"y\" in bodyB) {\n        var temp3 = bodyB;\n        bodyB = anchorA;\n        anchorA = temp3;\n      }\n      def = options(def, DEFAULTS$a);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = DistanceJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.zero());\n      _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.zero());\n      _this.m_length = Number.isFinite(def.length) ? def.length : Vec2.distance(bodyA.getWorldPoint(_this.m_localAnchorA), bodyB.getWorldPoint(_this.m_localAnchorB));\n      _this.m_frequencyHz = def.frequencyHz;\n      _this.m_dampingRatio = def.dampingRatio;\n      _this.m_impulse = 0;\n      _this.m_gamma = 0;\n      _this.m_bias = 0;\n      return _this;\n    }\n    DistanceJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        frequencyHz: this.m_frequencyHz,\n        dampingRatio: this.m_dampingRatio,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        length: this.m_length,\n        impulse: this.m_impulse,\n        gamma: this.m_gamma,\n        bias: this.m_bias\n      };\n    };\n    DistanceJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new DistanceJoint2(data);\n      return joint;\n    };\n    DistanceJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (def.length > 0) {\n        this.m_length = +def.length;\n      } else if (def.length < 0) ;\n      else if (def.anchorA || def.anchorA || def.anchorA || def.anchorA) {\n        this.m_length = Vec2.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA), this.m_bodyB.getWorldPoint(this.m_localAnchorB));\n      }\n      if (Number.isFinite(def.frequencyHz)) {\n        this.m_frequencyHz = def.frequencyHz;\n      }\n      if (Number.isFinite(def.dampingRatio)) {\n        this.m_dampingRatio = def.dampingRatio;\n      }\n    };\n    DistanceJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    DistanceJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    DistanceJoint2.prototype.setLength = function(length) {\n      this.m_length = length;\n    };\n    DistanceJoint2.prototype.getLength = function() {\n      return this.m_length;\n    };\n    DistanceJoint2.prototype.setFrequency = function(hz) {\n      this.m_frequencyHz = hz;\n    };\n    DistanceJoint2.prototype.getFrequency = function() {\n      return this.m_frequencyHz;\n    };\n    DistanceJoint2.prototype.setDampingRatio = function(ratio) {\n      this.m_dampingRatio = ratio;\n    };\n    DistanceJoint2.prototype.getDampingRatio = function() {\n      return this.m_dampingRatio;\n    };\n    DistanceJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    DistanceJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    DistanceJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);\n    };\n    DistanceJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return 0;\n    };\n    DistanceJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      this.m_u = Vec2.sub(Vec2.add(cB2, this.m_rB), Vec2.add(cA2, this.m_rA));\n      var length = this.m_u.length();\n      if (length > SettingsInternal.linearSlop) {\n        this.m_u.mul(1 / length);\n      } else {\n        this.m_u.setNum(0, 0);\n      }\n      var crAu = Vec2.crossVec2Vec2(this.m_rA, this.m_u);\n      var crBu = Vec2.crossVec2Vec2(this.m_rB, this.m_u);\n      var invMass = this.m_invMassA + this.m_invIA * crAu * crAu + this.m_invMassB + this.m_invIB * crBu * crBu;\n      this.m_mass = invMass != 0 ? 1 / invMass : 0;\n      if (this.m_frequencyHz > 0) {\n        var C = length - this.m_length;\n        var omega = 2 * math_PI$3 * this.m_frequencyHz;\n        var d2 = 2 * this.m_mass * this.m_dampingRatio * omega;\n        var k = this.m_mass * omega * omega;\n        var h = step.dt;\n        this.m_gamma = h * (d2 + h * k);\n        this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;\n        this.m_bias = C * h * k * this.m_gamma;\n        invMass += this.m_gamma;\n        this.m_mass = invMass != 0 ? 1 / invMass : 0;\n      } else {\n        this.m_gamma = 0;\n        this.m_bias = 0;\n      }\n      if (step.warmStarting) {\n        this.m_impulse *= step.dtRatio;\n        var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);\n        vA2.subMul(this.m_invMassA, P3);\n        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);\n        vB2.addMul(this.m_invMassB, P3);\n        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);\n      } else {\n        this.m_impulse = 0;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    DistanceJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));\n      var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));\n      var Cdot = Vec2.dot(this.m_u, vpB) - Vec2.dot(this.m_u, vpA);\n      var impulse = -this.m_mass * (Cdot + this.m_bias + this.m_gamma * this.m_impulse);\n      this.m_impulse += impulse;\n      var P3 = Vec2.mulNumVec2(impulse, this.m_u);\n      vA2.subMul(this.m_invMassA, P3);\n      wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);\n      vB2.addMul(this.m_invMassB, P3);\n      wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    DistanceJoint2.prototype.solvePositionConstraints = function(step) {\n      if (this.m_frequencyHz > 0) {\n        return true;\n      }\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);\n      var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);\n      var u = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));\n      var length = u.normalize();\n      var C = clamp(length - this.m_length, -SettingsInternal.maxLinearCorrection, SettingsInternal.maxLinearCorrection);\n      var impulse = -this.m_mass * C;\n      var P3 = Vec2.mulNumVec2(impulse, u);\n      cA2.subMul(this.m_invMassA, P3);\n      aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);\n      cB2.addMul(this.m_invMassB, P3);\n      aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);\n      this.m_bodyA.c_position.c.setVec2(cA2);\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c.setVec2(cB2);\n      this.m_bodyB.c_position.a = aB;\n      return math_abs$5(C) < SettingsInternal.linearSlop;\n    };\n    DistanceJoint2.TYPE = \"distance-joint\";\n    return DistanceJoint2;\n  }(Joint)\n);\nvar DEFAULTS$9 = {\n  maxForce: 0,\n  maxTorque: 0\n};\nvar FrictionJoint = (\n  /** @class */\n  function(_super) {\n    __extends(FrictionJoint2, _super);\n    function FrictionJoint2(def, bodyA, bodyB, anchor) {\n      var _this = this;\n      if (!(_this instanceof FrictionJoint2)) {\n        return new FrictionJoint2(def, bodyA, bodyB, anchor);\n      }\n      def = options(def, DEFAULTS$9);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = FrictionJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());\n      _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());\n      _this.m_linearImpulse = Vec2.zero();\n      _this.m_angularImpulse = 0;\n      _this.m_maxForce = def.maxForce;\n      _this.m_maxTorque = def.maxTorque;\n      return _this;\n    }\n    FrictionJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        maxForce: this.m_maxForce,\n        maxTorque: this.m_maxTorque,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB\n      };\n    };\n    FrictionJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new FrictionJoint2(data);\n      return joint;\n    };\n    FrictionJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (Number.isFinite(def.maxForce)) {\n        this.m_maxForce = def.maxForce;\n      }\n      if (Number.isFinite(def.maxTorque)) {\n        this.m_maxTorque = def.maxTorque;\n      }\n    };\n    FrictionJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    FrictionJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    FrictionJoint2.prototype.setMaxForce = function(force) {\n      this.m_maxForce = force;\n    };\n    FrictionJoint2.prototype.getMaxForce = function() {\n      return this.m_maxForce;\n    };\n    FrictionJoint2.prototype.setMaxTorque = function(torque) {\n      this.m_maxTorque = torque;\n    };\n    FrictionJoint2.prototype.getMaxTorque = function() {\n      return this.m_maxTorque;\n    };\n    FrictionJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    FrictionJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    FrictionJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);\n    };\n    FrictionJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_angularImpulse;\n    };\n    FrictionJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var K = new Mat22();\n      K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;\n      K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;\n      K.ey.x = K.ex.y;\n      K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;\n      this.m_linearMass = K.getInverse();\n      this.m_angularMass = iA + iB;\n      if (this.m_angularMass > 0) {\n        this.m_angularMass = 1 / this.m_angularMass;\n      }\n      if (step.warmStarting) {\n        this.m_linearImpulse.mul(step.dtRatio);\n        this.m_angularImpulse *= step.dtRatio;\n        var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);\n      } else {\n        this.m_linearImpulse.setZero();\n        this.m_angularImpulse = 0;\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    FrictionJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var h = step.dt;\n      {\n        var Cdot = wB - wA;\n        var impulse = -this.m_angularMass * Cdot;\n        var oldImpulse = this.m_angularImpulse;\n        var maxImpulse = h * this.m_maxTorque;\n        this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);\n        impulse = this.m_angularImpulse - oldImpulse;\n        wA -= iA * impulse;\n        wB += iB * impulse;\n      }\n      {\n        var Cdot = Vec2.sub(Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB)), Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA)));\n        var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));\n        var oldImpulse = this.m_linearImpulse;\n        this.m_linearImpulse.add(impulse);\n        var maxImpulse = h * this.m_maxForce;\n        if (this.m_linearImpulse.lengthSquared() > maxImpulse * maxImpulse) {\n          this.m_linearImpulse.normalize();\n          this.m_linearImpulse.mul(maxImpulse);\n        }\n        impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);\n        vA2.subMul(mA, impulse);\n        wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);\n        vB2.addMul(mB, impulse);\n        wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    FrictionJoint2.prototype.solvePositionConstraints = function(step) {\n      return true;\n    };\n    FrictionJoint2.TYPE = \"friction-joint\";\n    return FrictionJoint2;\n  }(Joint)\n);\nvar Mat33 = (\n  /** @class */\n  function() {\n    function Mat332(a2, b2, c2) {\n      if (typeof a2 === \"object\" && a2 !== null) {\n        this.ex = Vec3.clone(a2);\n        this.ey = Vec3.clone(b2);\n        this.ez = Vec3.clone(c2);\n      } else {\n        this.ex = Vec3.zero();\n        this.ey = Vec3.zero();\n        this.ez = Vec3.zero();\n      }\n    }\n    Mat332.prototype.toString = function() {\n      return JSON.stringify(this);\n    };\n    Mat332.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Vec3.isValid(obj.ex) && Vec3.isValid(obj.ey) && Vec3.isValid(obj.ez);\n    };\n    Mat332.assert = function(o) {\n    };\n    Mat332.prototype.setZero = function() {\n      this.ex.setZero();\n      this.ey.setZero();\n      this.ez.setZero();\n      return this;\n    };\n    Mat332.prototype.solve33 = function(v3) {\n      var cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;\n      var cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;\n      var cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;\n      var det = this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z;\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      var r = new Vec3();\n      cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;\n      cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;\n      cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;\n      r.x = det * (v3.x * cross_x + v3.y * cross_y + v3.z * cross_z);\n      cross_x = v3.y * this.ez.z - v3.z * this.ez.y;\n      cross_y = v3.z * this.ez.x - v3.x * this.ez.z;\n      cross_z = v3.x * this.ez.y - v3.y * this.ez.x;\n      r.y = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);\n      cross_x = this.ey.y * v3.z - this.ey.z * v3.y;\n      cross_y = this.ey.z * v3.x - this.ey.x * v3.z;\n      cross_z = this.ey.x * v3.y - this.ey.y * v3.x;\n      r.z = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);\n      return r;\n    };\n    Mat332.prototype.solve22 = function(v3) {\n      var a11 = this.ex.x;\n      var a12 = this.ey.x;\n      var a21 = this.ex.y;\n      var a22 = this.ey.y;\n      var det = a11 * a22 - a12 * a21;\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      var r = Vec2.zero();\n      r.x = det * (a22 * v3.x - a12 * v3.y);\n      r.y = det * (a11 * v3.y - a21 * v3.x);\n      return r;\n    };\n    Mat332.prototype.getInverse22 = function(M) {\n      var a2 = this.ex.x;\n      var b2 = this.ey.x;\n      var c2 = this.ex.y;\n      var d2 = this.ey.y;\n      var det = a2 * d2 - b2 * c2;\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      M.ex.x = det * d2;\n      M.ey.x = -det * b2;\n      M.ex.z = 0;\n      M.ex.y = -det * c2;\n      M.ey.y = det * a2;\n      M.ey.z = 0;\n      M.ez.x = 0;\n      M.ez.y = 0;\n      M.ez.z = 0;\n    };\n    Mat332.prototype.getSymInverse33 = function(M) {\n      var det = Vec3.dot(this.ex, Vec3.cross(this.ey, this.ez));\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      var a11 = this.ex.x;\n      var a12 = this.ey.x;\n      var a13 = this.ez.x;\n      var a22 = this.ey.y;\n      var a23 = this.ez.y;\n      var a33 = this.ez.z;\n      M.ex.x = det * (a22 * a33 - a23 * a23);\n      M.ex.y = det * (a13 * a23 - a12 * a33);\n      M.ex.z = det * (a12 * a23 - a13 * a22);\n      M.ey.x = M.ex.y;\n      M.ey.y = det * (a11 * a33 - a13 * a13);\n      M.ey.z = det * (a13 * a12 - a11 * a23);\n      M.ez.x = M.ex.z;\n      M.ez.y = M.ey.z;\n      M.ez.z = det * (a11 * a22 - a12 * a12);\n    };\n    Mat332.mul = function(a2, b2) {\n      if (b2 && \"z\" in b2 && \"y\" in b2 && \"x\" in b2) {\n        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;\n        var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;\n        var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;\n        return new Vec3(x2, y, z);\n      } else if (b2 && \"y\" in b2 && \"x\" in b2) {\n        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;\n        var y = a2.ex.y * b2.x + a2.ey.y * b2.y;\n        return Vec2.neo(x2, y);\n      }\n    };\n    Mat332.mulVec3 = function(a2, b2) {\n      var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;\n      var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;\n      var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;\n      return new Vec3(x2, y, z);\n    };\n    Mat332.mulVec2 = function(a2, b2) {\n      var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;\n      var y = a2.ex.y * b2.x + a2.ey.y * b2.y;\n      return Vec2.neo(x2, y);\n    };\n    Mat332.add = function(a2, b2) {\n      return new Mat332(Vec3.add(a2.ex, b2.ex), Vec3.add(a2.ey, b2.ey), Vec3.add(a2.ez, b2.ez));\n    };\n    return Mat332;\n  }()\n);\nvar math_abs$4 = Math.abs;\nvar LimitState$2;\n(function(LimitState2) {\n  LimitState2[LimitState2[\"inactiveLimit\"] = 0] = \"inactiveLimit\";\n  LimitState2[LimitState2[\"atLowerLimit\"] = 1] = \"atLowerLimit\";\n  LimitState2[LimitState2[\"atUpperLimit\"] = 2] = \"atUpperLimit\";\n  LimitState2[LimitState2[\"equalLimits\"] = 3] = \"equalLimits\";\n})(LimitState$2 || (LimitState$2 = {}));\nvar DEFAULTS$8 = {\n  lowerAngle: 0,\n  upperAngle: 0,\n  maxMotorTorque: 0,\n  motorSpeed: 0,\n  enableLimit: false,\n  enableMotor: false\n};\nvar RevoluteJoint = (\n  /** @class */\n  function(_super) {\n    __extends(RevoluteJoint2, _super);\n    function RevoluteJoint2(def, bodyA, bodyB, anchor) {\n      var _this = this;\n      var _a2, _b, _c, _d, _e, _f;\n      if (!(_this instanceof RevoluteJoint2)) {\n        return new RevoluteJoint2(def, bodyA, bodyB, anchor);\n      }\n      def = def !== null && def !== void 0 ? def : {};\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_mass = new Mat33();\n      _this.m_limitState = LimitState$2.inactiveLimit;\n      _this.m_type = RevoluteJoint2.TYPE;\n      if (Vec2.isValid(anchor)) {\n        _this.m_localAnchorA = bodyA.getLocalPoint(anchor);\n      } else if (Vec2.isValid(def.localAnchorA)) {\n        _this.m_localAnchorA = Vec2.clone(def.localAnchorA);\n      } else {\n        _this.m_localAnchorA = Vec2.zero();\n      }\n      if (Vec2.isValid(anchor)) {\n        _this.m_localAnchorB = bodyB.getLocalPoint(anchor);\n      } else if (Vec2.isValid(def.localAnchorB)) {\n        _this.m_localAnchorB = Vec2.clone(def.localAnchorB);\n      } else {\n        _this.m_localAnchorB = Vec2.zero();\n      }\n      if (Number.isFinite(def.referenceAngle)) {\n        _this.m_referenceAngle = def.referenceAngle;\n      } else {\n        _this.m_referenceAngle = bodyB.getAngle() - bodyA.getAngle();\n      }\n      _this.m_impulse = new Vec3();\n      _this.m_motorImpulse = 0;\n      _this.m_lowerAngle = (_a2 = def.lowerAngle) !== null && _a2 !== void 0 ? _a2 : DEFAULTS$8.lowerAngle;\n      _this.m_upperAngle = (_b = def.upperAngle) !== null && _b !== void 0 ? _b : DEFAULTS$8.upperAngle;\n      _this.m_maxMotorTorque = (_c = def.maxMotorTorque) !== null && _c !== void 0 ? _c : DEFAULTS$8.maxMotorTorque;\n      _this.m_motorSpeed = (_d = def.motorSpeed) !== null && _d !== void 0 ? _d : DEFAULTS$8.motorSpeed;\n      _this.m_enableLimit = (_e = def.enableLimit) !== null && _e !== void 0 ? _e : DEFAULTS$8.enableLimit;\n      _this.m_enableMotor = (_f = def.enableMotor) !== null && _f !== void 0 ? _f : DEFAULTS$8.enableMotor;\n      return _this;\n    }\n    RevoluteJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        lowerAngle: this.m_lowerAngle,\n        upperAngle: this.m_upperAngle,\n        maxMotorTorque: this.m_maxMotorTorque,\n        motorSpeed: this.m_motorSpeed,\n        enableLimit: this.m_enableLimit,\n        enableMotor: this.m_enableMotor,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        referenceAngle: this.m_referenceAngle\n      };\n    };\n    RevoluteJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new RevoluteJoint2(data);\n      return joint;\n    };\n    RevoluteJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (Number.isFinite(def.referenceAngle)) {\n        this.m_referenceAngle = def.referenceAngle;\n      }\n      if (def.enableLimit !== void 0) {\n        this.m_enableLimit = def.enableLimit;\n      }\n      if (Number.isFinite(def.lowerAngle)) {\n        this.m_lowerAngle = def.lowerAngle;\n      }\n      if (Number.isFinite(def.upperAngle)) {\n        this.m_upperAngle = def.upperAngle;\n      }\n      if (Number.isFinite(def.maxMotorTorque)) {\n        this.m_maxMotorTorque = def.maxMotorTorque;\n      }\n      if (Number.isFinite(def.motorSpeed)) {\n        this.m_motorSpeed = def.motorSpeed;\n      }\n      if (def.enableMotor !== void 0) {\n        this.m_enableMotor = def.enableMotor;\n      }\n    };\n    RevoluteJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    RevoluteJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    RevoluteJoint2.prototype.getReferenceAngle = function() {\n      return this.m_referenceAngle;\n    };\n    RevoluteJoint2.prototype.getJointAngle = function() {\n      var bA = this.m_bodyA;\n      var bB = this.m_bodyB;\n      return bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;\n    };\n    RevoluteJoint2.prototype.getJointSpeed = function() {\n      var bA = this.m_bodyA;\n      var bB = this.m_bodyB;\n      return bB.m_angularVelocity - bA.m_angularVelocity;\n    };\n    RevoluteJoint2.prototype.isMotorEnabled = function() {\n      return this.m_enableMotor;\n    };\n    RevoluteJoint2.prototype.enableMotor = function(flag) {\n      if (flag == this.m_enableMotor)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_enableMotor = flag;\n    };\n    RevoluteJoint2.prototype.getMotorTorque = function(inv_dt) {\n      return inv_dt * this.m_motorImpulse;\n    };\n    RevoluteJoint2.prototype.setMotorSpeed = function(speed) {\n      if (speed == this.m_motorSpeed)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_motorSpeed = speed;\n    };\n    RevoluteJoint2.prototype.getMotorSpeed = function() {\n      return this.m_motorSpeed;\n    };\n    RevoluteJoint2.prototype.setMaxMotorTorque = function(torque) {\n      if (torque == this.m_maxMotorTorque)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_maxMotorTorque = torque;\n    };\n    RevoluteJoint2.prototype.getMaxMotorTorque = function() {\n      return this.m_maxMotorTorque;\n    };\n    RevoluteJoint2.prototype.isLimitEnabled = function() {\n      return this.m_enableLimit;\n    };\n    RevoluteJoint2.prototype.enableLimit = function(flag) {\n      if (flag != this.m_enableLimit) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_enableLimit = flag;\n        this.m_impulse.z = 0;\n      }\n    };\n    RevoluteJoint2.prototype.getLowerLimit = function() {\n      return this.m_lowerAngle;\n    };\n    RevoluteJoint2.prototype.getUpperLimit = function() {\n      return this.m_upperAngle;\n    };\n    RevoluteJoint2.prototype.setLimits = function(lower, upper) {\n      if (lower != this.m_lowerAngle || upper != this.m_upperAngle) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_impulse.z = 0;\n        this.m_lowerAngle = lower;\n        this.m_upperAngle = upper;\n      }\n    };\n    RevoluteJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    RevoluteJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    RevoluteJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);\n    };\n    RevoluteJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_impulse.z;\n    };\n    RevoluteJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var fixedRotation = iA + iB === 0;\n      this.m_mass.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;\n      this.m_mass.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;\n      this.m_mass.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;\n      this.m_mass.ex.y = this.m_mass.ey.x;\n      this.m_mass.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;\n      this.m_mass.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;\n      this.m_mass.ex.z = this.m_mass.ez.x;\n      this.m_mass.ey.z = this.m_mass.ez.y;\n      this.m_mass.ez.z = iA + iB;\n      this.m_motorMass = iA + iB;\n      if (this.m_motorMass > 0) {\n        this.m_motorMass = 1 / this.m_motorMass;\n      }\n      if (this.m_enableMotor == false || fixedRotation) {\n        this.m_motorImpulse = 0;\n      }\n      if (this.m_enableLimit && fixedRotation == false) {\n        var jointAngle = aB - aA - this.m_referenceAngle;\n        if (math_abs$4(this.m_upperAngle - this.m_lowerAngle) < 2 * SettingsInternal.angularSlop) {\n          this.m_limitState = LimitState$2.equalLimits;\n        } else if (jointAngle <= this.m_lowerAngle) {\n          if (this.m_limitState != LimitState$2.atLowerLimit) {\n            this.m_impulse.z = 0;\n          }\n          this.m_limitState = LimitState$2.atLowerLimit;\n        } else if (jointAngle >= this.m_upperAngle) {\n          if (this.m_limitState != LimitState$2.atUpperLimit) {\n            this.m_impulse.z = 0;\n          }\n          this.m_limitState = LimitState$2.atUpperLimit;\n        } else {\n          this.m_limitState = LimitState$2.inactiveLimit;\n          this.m_impulse.z = 0;\n        }\n      } else {\n        this.m_limitState = LimitState$2.inactiveLimit;\n      }\n      if (step.warmStarting) {\n        this.m_impulse.mul(step.dtRatio);\n        this.m_motorImpulse *= step.dtRatio;\n        var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_motorImpulse + this.m_impulse.z);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_motorImpulse + this.m_impulse.z);\n      } else {\n        this.m_impulse.setZero();\n        this.m_motorImpulse = 0;\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    RevoluteJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var fixedRotation = iA + iB === 0;\n      if (this.m_enableMotor && this.m_limitState != LimitState$2.equalLimits && fixedRotation == false) {\n        var Cdot = wB - wA - this.m_motorSpeed;\n        var impulse = -this.m_motorMass * Cdot;\n        var oldImpulse = this.m_motorImpulse;\n        var maxImpulse = step.dt * this.m_maxMotorTorque;\n        this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);\n        impulse = this.m_motorImpulse - oldImpulse;\n        wA -= iA * impulse;\n        wB += iB * impulse;\n      }\n      if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {\n        var Cdot1 = Vec2.zero();\n        Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));\n        Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));\n        var Cdot2 = wB - wA;\n        var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);\n        var impulse = Vec3.neg(this.m_mass.solve33(Cdot));\n        if (this.m_limitState == LimitState$2.equalLimits) {\n          this.m_impulse.add(impulse);\n        } else if (this.m_limitState == LimitState$2.atLowerLimit) {\n          var newImpulse = this.m_impulse.z + impulse.z;\n          if (newImpulse < 0) {\n            var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));\n            var reduced = this.m_mass.solve22(rhs);\n            impulse.x = reduced.x;\n            impulse.y = reduced.y;\n            impulse.z = -this.m_impulse.z;\n            this.m_impulse.x += reduced.x;\n            this.m_impulse.y += reduced.y;\n            this.m_impulse.z = 0;\n          } else {\n            this.m_impulse.add(impulse);\n          }\n        } else if (this.m_limitState == LimitState$2.atUpperLimit) {\n          var newImpulse = this.m_impulse.z + impulse.z;\n          if (newImpulse > 0) {\n            var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));\n            var reduced = this.m_mass.solve22(rhs);\n            impulse.x = reduced.x;\n            impulse.y = reduced.y;\n            impulse.z = -this.m_impulse.z;\n            this.m_impulse.x += reduced.x;\n            this.m_impulse.y += reduced.y;\n            this.m_impulse.z = 0;\n          } else {\n            this.m_impulse.add(impulse);\n          }\n        }\n        var P3 = Vec2.neo(impulse.x, impulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);\n      } else {\n        var Cdot = Vec2.zero();\n        Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));\n        Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));\n        var impulse = this.m_mass.solve22(Vec2.neg(Cdot));\n        this.m_impulse.x += impulse.x;\n        this.m_impulse.y += impulse.y;\n        vA2.subMul(mA, impulse);\n        wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);\n        vB2.addMul(mB, impulse);\n        wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    RevoluteJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var angularError = 0;\n      var positionError = 0;\n      var fixedRotation = this.m_invIA + this.m_invIB == 0;\n      if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {\n        var angle = aB - aA - this.m_referenceAngle;\n        var limitImpulse = 0;\n        if (this.m_limitState == LimitState$2.equalLimits) {\n          var C = clamp(angle - this.m_lowerAngle, -SettingsInternal.maxAngularCorrection, SettingsInternal.maxAngularCorrection);\n          limitImpulse = -this.m_motorMass * C;\n          angularError = math_abs$4(C);\n        } else if (this.m_limitState == LimitState$2.atLowerLimit) {\n          var C = angle - this.m_lowerAngle;\n          angularError = -C;\n          C = clamp(C + SettingsInternal.angularSlop, -SettingsInternal.maxAngularCorrection, 0);\n          limitImpulse = -this.m_motorMass * C;\n        } else if (this.m_limitState == LimitState$2.atUpperLimit) {\n          var C = angle - this.m_upperAngle;\n          angularError = C;\n          C = clamp(C - SettingsInternal.angularSlop, 0, SettingsInternal.maxAngularCorrection);\n          limitImpulse = -this.m_motorMass * C;\n        }\n        aA -= this.m_invIA * limitImpulse;\n        aB += this.m_invIB * limitImpulse;\n      }\n      {\n        qA.setAngle(aA);\n        qB.setAngle(aB);\n        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n        var C = Vec2.zero();\n        C.addCombine(1, cB2, 1, rB2);\n        C.subCombine(1, cA2, 1, rA2);\n        positionError = C.length();\n        var mA = this.m_invMassA;\n        var mB = this.m_invMassB;\n        var iA = this.m_invIA;\n        var iB = this.m_invIB;\n        var K = new Mat22();\n        K.ex.x = mA + mB + iA * rA2.y * rA2.y + iB * rB2.y * rB2.y;\n        K.ex.y = -iA * rA2.x * rA2.y - iB * rB2.x * rB2.y;\n        K.ey.x = K.ex.y;\n        K.ey.y = mA + mB + iA * rA2.x * rA2.x + iB * rB2.x * rB2.x;\n        var impulse = Vec2.neg(K.solve(C));\n        cA2.subMul(mA, impulse);\n        aA -= iA * Vec2.crossVec2Vec2(rA2, impulse);\n        cB2.addMul(mB, impulse);\n        aB += iB * Vec2.crossVec2Vec2(rB2, impulse);\n      }\n      this.m_bodyA.c_position.c.setVec2(cA2);\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c.setVec2(cB2);\n      this.m_bodyB.c_position.a = aB;\n      return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;\n    };\n    RevoluteJoint2.TYPE = \"revolute-joint\";\n    return RevoluteJoint2;\n  }(Joint)\n);\nvar math_abs$3 = Math.abs;\nvar math_max = Math.max;\nvar math_min$2 = Math.min;\nvar LimitState$1;\n(function(LimitState2) {\n  LimitState2[LimitState2[\"inactiveLimit\"] = 0] = \"inactiveLimit\";\n  LimitState2[LimitState2[\"atLowerLimit\"] = 1] = \"atLowerLimit\";\n  LimitState2[LimitState2[\"atUpperLimit\"] = 2] = \"atUpperLimit\";\n  LimitState2[LimitState2[\"equalLimits\"] = 3] = \"equalLimits\";\n})(LimitState$1 || (LimitState$1 = {}));\nvar DEFAULTS$7 = {\n  enableLimit: false,\n  lowerTranslation: 0,\n  upperTranslation: 0,\n  enableMotor: false,\n  maxMotorForce: 0,\n  motorSpeed: 0\n};\nvar PrismaticJoint = (\n  /** @class */\n  function(_super) {\n    __extends(PrismaticJoint2, _super);\n    function PrismaticJoint2(def, bodyA, bodyB, anchor, axis) {\n      var _this = this;\n      if (!(_this instanceof PrismaticJoint2)) {\n        return new PrismaticJoint2(def, bodyA, bodyB, anchor, axis);\n      }\n      def = options(def, DEFAULTS$7);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = PrismaticJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());\n      _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());\n      _this.m_localXAxisA = Vec2.clone(axis ? bodyA.getLocalVector(axis) : def.localAxisA || Vec2.neo(1, 0));\n      _this.m_localXAxisA.normalize();\n      _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);\n      _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();\n      _this.m_impulse = new Vec3();\n      _this.m_motorMass = 0;\n      _this.m_motorImpulse = 0;\n      _this.m_lowerTranslation = def.lowerTranslation;\n      _this.m_upperTranslation = def.upperTranslation;\n      _this.m_maxMotorForce = def.maxMotorForce;\n      _this.m_motorSpeed = def.motorSpeed;\n      _this.m_enableLimit = def.enableLimit;\n      _this.m_enableMotor = def.enableMotor;\n      _this.m_limitState = LimitState$1.inactiveLimit;\n      _this.m_axis = Vec2.zero();\n      _this.m_perp = Vec2.zero();\n      _this.m_K = new Mat33();\n      return _this;\n    }\n    PrismaticJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        lowerTranslation: this.m_lowerTranslation,\n        upperTranslation: this.m_upperTranslation,\n        maxMotorForce: this.m_maxMotorForce,\n        motorSpeed: this.m_motorSpeed,\n        enableLimit: this.m_enableLimit,\n        enableMotor: this.m_enableMotor,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        localAxisA: this.m_localXAxisA,\n        referenceAngle: this.m_referenceAngle\n      };\n    };\n    PrismaticJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      data.localAxisA = Vec2.clone(data.localAxisA);\n      var joint = new PrismaticJoint2(data);\n      return joint;\n    };\n    PrismaticJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (def.localAxisA) {\n        this.m_localXAxisA.setVec2(def.localAxisA);\n        this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));\n      }\n      if (Number.isFinite(def.referenceAngle)) {\n        this.m_referenceAngle = def.referenceAngle;\n      }\n      if (typeof def.enableLimit !== \"undefined\") {\n        this.m_enableLimit = !!def.enableLimit;\n      }\n      if (Number.isFinite(def.lowerTranslation)) {\n        this.m_lowerTranslation = def.lowerTranslation;\n      }\n      if (Number.isFinite(def.upperTranslation)) {\n        this.m_upperTranslation = def.upperTranslation;\n      }\n      if (typeof def.enableMotor !== \"undefined\") {\n        this.m_enableMotor = !!def.enableMotor;\n      }\n      if (Number.isFinite(def.maxMotorForce)) {\n        this.m_maxMotorForce = def.maxMotorForce;\n      }\n      if (Number.isFinite(def.motorSpeed)) {\n        this.m_motorSpeed = def.motorSpeed;\n      }\n    };\n    PrismaticJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    PrismaticJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    PrismaticJoint2.prototype.getLocalAxisA = function() {\n      return this.m_localXAxisA;\n    };\n    PrismaticJoint2.prototype.getReferenceAngle = function() {\n      return this.m_referenceAngle;\n    };\n    PrismaticJoint2.prototype.getJointTranslation = function() {\n      var pA2 = this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n      var pB2 = this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n      var d2 = Vec2.sub(pB2, pA2);\n      var axis = this.m_bodyA.getWorldVector(this.m_localXAxisA);\n      var translation2 = Vec2.dot(d2, axis);\n      return translation2;\n    };\n    PrismaticJoint2.prototype.getJointSpeed = function() {\n      var bA = this.m_bodyA;\n      var bB = this.m_bodyB;\n      var rA2 = Rot.mulVec2(bA.m_xf.q, Vec2.sub(this.m_localAnchorA, bA.m_sweep.localCenter));\n      var rB2 = Rot.mulVec2(bB.m_xf.q, Vec2.sub(this.m_localAnchorB, bB.m_sweep.localCenter));\n      var p1 = Vec2.add(bA.m_sweep.c, rA2);\n      var p2 = Vec2.add(bB.m_sweep.c, rB2);\n      var d2 = Vec2.sub(p2, p1);\n      var axis = Rot.mulVec2(bA.m_xf.q, this.m_localXAxisA);\n      var vA2 = bA.m_linearVelocity;\n      var vB2 = bB.m_linearVelocity;\n      var wA = bA.m_angularVelocity;\n      var wB = bB.m_angularVelocity;\n      var speed = Vec2.dot(d2, Vec2.crossNumVec2(wA, axis)) + Vec2.dot(axis, Vec2.sub(Vec2.addCrossNumVec2(vB2, wB, rB2), Vec2.addCrossNumVec2(vA2, wA, rA2)));\n      return speed;\n    };\n    PrismaticJoint2.prototype.isLimitEnabled = function() {\n      return this.m_enableLimit;\n    };\n    PrismaticJoint2.prototype.enableLimit = function(flag) {\n      if (flag != this.m_enableLimit) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_enableLimit = flag;\n        this.m_impulse.z = 0;\n      }\n    };\n    PrismaticJoint2.prototype.getLowerLimit = function() {\n      return this.m_lowerTranslation;\n    };\n    PrismaticJoint2.prototype.getUpperLimit = function() {\n      return this.m_upperTranslation;\n    };\n    PrismaticJoint2.prototype.setLimits = function(lower, upper) {\n      if (lower != this.m_lowerTranslation || upper != this.m_upperTranslation) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_lowerTranslation = lower;\n        this.m_upperTranslation = upper;\n        this.m_impulse.z = 0;\n      }\n    };\n    PrismaticJoint2.prototype.isMotorEnabled = function() {\n      return this.m_enableMotor;\n    };\n    PrismaticJoint2.prototype.enableMotor = function(flag) {\n      if (flag == this.m_enableMotor)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_enableMotor = flag;\n    };\n    PrismaticJoint2.prototype.setMotorSpeed = function(speed) {\n      if (speed == this.m_motorSpeed)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_motorSpeed = speed;\n    };\n    PrismaticJoint2.prototype.setMaxMotorForce = function(force) {\n      if (force == this.m_maxMotorForce)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_maxMotorForce = force;\n    };\n    PrismaticJoint2.prototype.getMaxMotorForce = function() {\n      return this.m_maxMotorForce;\n    };\n    PrismaticJoint2.prototype.getMotorSpeed = function() {\n      return this.m_motorSpeed;\n    };\n    PrismaticJoint2.prototype.getMotorForce = function(inv_dt) {\n      return inv_dt * this.m_motorImpulse;\n    };\n    PrismaticJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    PrismaticJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    PrismaticJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis).mul(inv_dt);\n    };\n    PrismaticJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_impulse.y;\n    };\n    PrismaticJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var d2 = Vec2.zero();\n      d2.addCombine(1, cB2, 1, rB2);\n      d2.subCombine(1, cA2, 1, rA2);\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      {\n        this.m_axis = Rot.mulVec2(qA, this.m_localXAxisA);\n        this.m_a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_axis);\n        this.m_a2 = Vec2.crossVec2Vec2(rB2, this.m_axis);\n        this.m_motorMass = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;\n        if (this.m_motorMass > 0) {\n          this.m_motorMass = 1 / this.m_motorMass;\n        }\n      }\n      {\n        this.m_perp = Rot.mulVec2(qA, this.m_localYAxisA);\n        this.m_s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_perp);\n        this.m_s2 = Vec2.crossVec2Vec2(rB2, this.m_perp);\n        Vec2.crossVec2Vec2(rA2, this.m_perp);\n        var k11 = mA + mB + iA * this.m_s1 * this.m_s1 + iB * this.m_s2 * this.m_s2;\n        var k12 = iA * this.m_s1 + iB * this.m_s2;\n        var k13 = iA * this.m_s1 * this.m_a1 + iB * this.m_s2 * this.m_a2;\n        var k22 = iA + iB;\n        if (k22 == 0) {\n          k22 = 1;\n        }\n        var k23 = iA * this.m_a1 + iB * this.m_a2;\n        var k33 = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;\n        this.m_K.ex.set(k11, k12, k13);\n        this.m_K.ey.set(k12, k22, k23);\n        this.m_K.ez.set(k13, k23, k33);\n      }\n      if (this.m_enableLimit) {\n        var jointTranslation = Vec2.dot(this.m_axis, d2);\n        if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * SettingsInternal.linearSlop) {\n          this.m_limitState = LimitState$1.equalLimits;\n        } else if (jointTranslation <= this.m_lowerTranslation) {\n          if (this.m_limitState != LimitState$1.atLowerLimit) {\n            this.m_limitState = LimitState$1.atLowerLimit;\n            this.m_impulse.z = 0;\n          }\n        } else if (jointTranslation >= this.m_upperTranslation) {\n          if (this.m_limitState != LimitState$1.atUpperLimit) {\n            this.m_limitState = LimitState$1.atUpperLimit;\n            this.m_impulse.z = 0;\n          }\n        } else {\n          this.m_limitState = LimitState$1.inactiveLimit;\n          this.m_impulse.z = 0;\n        }\n      } else {\n        this.m_limitState = LimitState$1.inactiveLimit;\n        this.m_impulse.z = 0;\n      }\n      if (this.m_enableMotor == false) {\n        this.m_motorImpulse = 0;\n      }\n      if (step.warmStarting) {\n        this.m_impulse.mul(step.dtRatio);\n        this.m_motorImpulse *= step.dtRatio;\n        var P3 = Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis);\n        var LA = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1;\n        var LB = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      } else {\n        this.m_impulse.setZero();\n        this.m_motorImpulse = 0;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    PrismaticJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      if (this.m_enableMotor && this.m_limitState != LimitState$1.equalLimits) {\n        var Cdot = Vec2.dot(this.m_axis, Vec2.sub(vB2, vA2)) + this.m_a2 * wB - this.m_a1 * wA;\n        var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);\n        var oldImpulse = this.m_motorImpulse;\n        var maxImpulse = step.dt * this.m_maxMotorForce;\n        this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);\n        impulse = this.m_motorImpulse - oldImpulse;\n        var P3 = Vec2.mulNumVec2(impulse, this.m_axis);\n        var LA = impulse * this.m_a1;\n        var LB = impulse * this.m_a2;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      }\n      var Cdot1 = Vec2.zero();\n      Cdot1.x += Vec2.dot(this.m_perp, vB2) + this.m_s2 * wB;\n      Cdot1.x -= Vec2.dot(this.m_perp, vA2) + this.m_s1 * wA;\n      Cdot1.y = wB - wA;\n      if (this.m_enableLimit && this.m_limitState != LimitState$1.inactiveLimit) {\n        var Cdot2 = 0;\n        Cdot2 += Vec2.dot(this.m_axis, vB2) + this.m_a2 * wB;\n        Cdot2 -= Vec2.dot(this.m_axis, vA2) + this.m_a1 * wA;\n        var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);\n        var f1 = Vec3.clone(this.m_impulse);\n        var df = this.m_K.solve33(Vec3.neg(Cdot));\n        this.m_impulse.add(df);\n        if (this.m_limitState == LimitState$1.atLowerLimit) {\n          this.m_impulse.z = math_max(this.m_impulse.z, 0);\n        } else if (this.m_limitState == LimitState$1.atUpperLimit) {\n          this.m_impulse.z = math_min$2(this.m_impulse.z, 0);\n        }\n        var b2 = Vec2.combine(-1, Cdot1, -(this.m_impulse.z - f1.z), Vec2.neo(this.m_K.ez.x, this.m_K.ez.y));\n        var f2r = Vec2.add(this.m_K.solve22(b2), Vec2.neo(f1.x, f1.y));\n        this.m_impulse.x = f2r.x;\n        this.m_impulse.y = f2r.y;\n        df = Vec3.sub(this.m_impulse, f1);\n        var P3 = Vec2.combine(df.x, this.m_perp, df.z, this.m_axis);\n        var LA = df.x * this.m_s1 + df.y + df.z * this.m_a1;\n        var LB = df.x * this.m_s2 + df.y + df.z * this.m_a2;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      } else {\n        var df = this.m_K.solve22(Vec2.neg(Cdot1));\n        this.m_impulse.x += df.x;\n        this.m_impulse.y += df.y;\n        var P3 = Vec2.mulNumVec2(df.x, this.m_perp);\n        var LA = df.x * this.m_s1 + df.y;\n        var LB = df.x * this.m_s2 + df.y;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    PrismaticJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var d2 = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));\n      var axis = Rot.mulVec2(qA, this.m_localXAxisA);\n      var a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), axis);\n      var a2 = Vec2.crossVec2Vec2(rB2, axis);\n      var perp2 = Rot.mulVec2(qA, this.m_localYAxisA);\n      var s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), perp2);\n      var s2 = Vec2.crossVec2Vec2(rB2, perp2);\n      var impulse = new Vec3();\n      var C1 = Vec2.zero();\n      C1.x = Vec2.dot(perp2, d2);\n      C1.y = aB - aA - this.m_referenceAngle;\n      var linearError = math_abs$3(C1.x);\n      var angularError = math_abs$3(C1.y);\n      var linearSlop = SettingsInternal.linearSlop;\n      var maxLinearCorrection = SettingsInternal.maxLinearCorrection;\n      var active = false;\n      var C2 = 0;\n      if (this.m_enableLimit) {\n        var translation2 = Vec2.dot(axis, d2);\n        if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * linearSlop) {\n          C2 = clamp(translation2, -maxLinearCorrection, maxLinearCorrection);\n          linearError = math_max(linearError, math_abs$3(translation2));\n          active = true;\n        } else if (translation2 <= this.m_lowerTranslation) {\n          C2 = clamp(translation2 - this.m_lowerTranslation + linearSlop, -maxLinearCorrection, 0);\n          linearError = Math.max(linearError, this.m_lowerTranslation - translation2);\n          active = true;\n        } else if (translation2 >= this.m_upperTranslation) {\n          C2 = clamp(translation2 - this.m_upperTranslation - linearSlop, 0, maxLinearCorrection);\n          linearError = Math.max(linearError, translation2 - this.m_upperTranslation);\n          active = true;\n        }\n      }\n      if (active) {\n        var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;\n        var k12 = iA * s1 + iB * s2;\n        var k13 = iA * s1 * a1 + iB * s2 * a2;\n        var k22 = iA + iB;\n        if (k22 == 0) {\n          k22 = 1;\n        }\n        var k23 = iA * a1 + iB * a2;\n        var k33 = mA + mB + iA * a1 * a1 + iB * a2 * a2;\n        var K = new Mat33();\n        K.ex.set(k11, k12, k13);\n        K.ey.set(k12, k22, k23);\n        K.ez.set(k13, k23, k33);\n        var C = new Vec3();\n        C.x = C1.x;\n        C.y = C1.y;\n        C.z = C2;\n        impulse = K.solve33(Vec3.neg(C));\n      } else {\n        var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;\n        var k12 = iA * s1 + iB * s2;\n        var k22 = iA + iB;\n        if (k22 == 0) {\n          k22 = 1;\n        }\n        var K = new Mat22();\n        K.ex.setNum(k11, k12);\n        K.ey.setNum(k12, k22);\n        var impulse1 = K.solve(Vec2.neg(C1));\n        impulse.x = impulse1.x;\n        impulse.y = impulse1.y;\n        impulse.z = 0;\n      }\n      var P3 = Vec2.combine(impulse.x, perp2, impulse.z, axis);\n      var LA = impulse.x * s1 + impulse.y + impulse.z * a1;\n      var LB = impulse.x * s2 + impulse.y + impulse.z * a2;\n      cA2.subMul(mA, P3);\n      aA -= iA * LA;\n      cB2.addMul(mB, P3);\n      aB += iB * LB;\n      this.m_bodyA.c_position.c = cA2;\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c = cB2;\n      this.m_bodyB.c_position.a = aB;\n      return linearError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;\n    };\n    PrismaticJoint2.TYPE = \"prismatic-joint\";\n    return PrismaticJoint2;\n  }(Joint)\n);\nvar DEFAULTS$6 = {\n  ratio: 1\n};\nvar GearJoint = (\n  /** @class */\n  function(_super) {\n    __extends(GearJoint2, _super);\n    function GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio) {\n      var _this = this;\n      if (!(_this instanceof GearJoint2)) {\n        return new GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio);\n      }\n      def = options(def, DEFAULTS$6);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = GearJoint2.TYPE;\n      _this.m_joint1 = joint1 ? joint1 : def.joint1;\n      _this.m_joint2 = joint2 ? joint2 : def.joint2;\n      _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;\n      _this.m_type1 = _this.m_joint1.getType();\n      _this.m_type2 = _this.m_joint2.getType();\n      var coordinateA;\n      var coordinateB;\n      _this.m_bodyC = _this.m_joint1.getBodyA();\n      _this.m_bodyA = _this.m_joint1.getBodyB();\n      var xfA2 = _this.m_bodyA.m_xf;\n      var aA = _this.m_bodyA.m_sweep.a;\n      var xfC = _this.m_bodyC.m_xf;\n      var aC = _this.m_bodyC.m_sweep.a;\n      if (_this.m_type1 === RevoluteJoint.TYPE) {\n        var revolute = _this.m_joint1;\n        _this.m_localAnchorC = revolute.m_localAnchorA;\n        _this.m_localAnchorA = revolute.m_localAnchorB;\n        _this.m_referenceAngleA = revolute.m_referenceAngle;\n        _this.m_localAxisC = Vec2.zero();\n        coordinateA = aA - aC - _this.m_referenceAngleA;\n      } else {\n        var prismatic = _this.m_joint1;\n        _this.m_localAnchorC = prismatic.m_localAnchorA;\n        _this.m_localAnchorA = prismatic.m_localAnchorB;\n        _this.m_referenceAngleA = prismatic.m_referenceAngle;\n        _this.m_localAxisC = prismatic.m_localXAxisA;\n        var pC = _this.m_localAnchorC;\n        var pA2 = Rot.mulTVec2(xfC.q, Vec2.add(Rot.mulVec2(xfA2.q, _this.m_localAnchorA), Vec2.sub(xfA2.p, xfC.p)));\n        coordinateA = Vec2.dot(pA2, _this.m_localAxisC) - Vec2.dot(pC, _this.m_localAxisC);\n      }\n      _this.m_bodyD = _this.m_joint2.getBodyA();\n      _this.m_bodyB = _this.m_joint2.getBodyB();\n      var xfB2 = _this.m_bodyB.m_xf;\n      var aB = _this.m_bodyB.m_sweep.a;\n      var xfD = _this.m_bodyD.m_xf;\n      var aD = _this.m_bodyD.m_sweep.a;\n      if (_this.m_type2 === RevoluteJoint.TYPE) {\n        var revolute = _this.m_joint2;\n        _this.m_localAnchorD = revolute.m_localAnchorA;\n        _this.m_localAnchorB = revolute.m_localAnchorB;\n        _this.m_referenceAngleB = revolute.m_referenceAngle;\n        _this.m_localAxisD = Vec2.zero();\n        coordinateB = aB - aD - _this.m_referenceAngleB;\n      } else {\n        var prismatic = _this.m_joint2;\n        _this.m_localAnchorD = prismatic.m_localAnchorA;\n        _this.m_localAnchorB = prismatic.m_localAnchorB;\n        _this.m_referenceAngleB = prismatic.m_referenceAngle;\n        _this.m_localAxisD = prismatic.m_localXAxisA;\n        var pD = _this.m_localAnchorD;\n        var pB2 = Rot.mulTVec2(xfD.q, Vec2.add(Rot.mulVec2(xfB2.q, _this.m_localAnchorB), Vec2.sub(xfB2.p, xfD.p)));\n        coordinateB = Vec2.dot(pB2, _this.m_localAxisD) - Vec2.dot(pD, _this.m_localAxisD);\n      }\n      _this.m_constant = coordinateA + _this.m_ratio * coordinateB;\n      _this.m_impulse = 0;\n      return _this;\n    }\n    GearJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        joint1: this.m_joint1,\n        joint2: this.m_joint2,\n        ratio: this.m_ratio\n        // _constant: this.m_constant,\n      };\n    };\n    GearJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      data.joint1 = restore(Joint, data.joint1, world);\n      data.joint2 = restore(Joint, data.joint2, world);\n      var joint = new GearJoint2(data);\n      return joint;\n    };\n    GearJoint2.prototype._reset = function(def) {\n      if (Number.isFinite(def.ratio)) {\n        this.m_ratio = def.ratio;\n      }\n    };\n    GearJoint2.prototype.getJoint1 = function() {\n      return this.m_joint1;\n    };\n    GearJoint2.prototype.getJoint2 = function() {\n      return this.m_joint2;\n    };\n    GearJoint2.prototype.setRatio = function(ratio) {\n      this.m_ratio = ratio;\n    };\n    GearJoint2.prototype.getRatio = function() {\n      return this.m_ratio;\n    };\n    GearJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    GearJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    GearJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(this.m_impulse, this.m_JvAC).mul(inv_dt);\n    };\n    GearJoint2.prototype.getReactionTorque = function(inv_dt) {\n      var L = this.m_impulse * this.m_JwA;\n      return inv_dt * L;\n    };\n    GearJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_lcA = this.m_bodyA.m_sweep.localCenter;\n      this.m_lcB = this.m_bodyB.m_sweep.localCenter;\n      this.m_lcC = this.m_bodyC.m_sweep.localCenter;\n      this.m_lcD = this.m_bodyD.m_sweep.localCenter;\n      this.m_mA = this.m_bodyA.m_invMass;\n      this.m_mB = this.m_bodyB.m_invMass;\n      this.m_mC = this.m_bodyC.m_invMass;\n      this.m_mD = this.m_bodyD.m_invMass;\n      this.m_iA = this.m_bodyA.m_invI;\n      this.m_iB = this.m_bodyB.m_invI;\n      this.m_iC = this.m_bodyC.m_invI;\n      this.m_iD = this.m_bodyD.m_invI;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var aC = this.m_bodyC.c_position.a;\n      var vC = this.m_bodyC.c_velocity.v;\n      var wC = this.m_bodyC.c_velocity.w;\n      var aD = this.m_bodyD.c_position.a;\n      var vD = this.m_bodyD.c_velocity.v;\n      var wD = this.m_bodyD.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var qC = Rot.neo(aC);\n      var qD = Rot.neo(aD);\n      this.m_mass = 0;\n      if (this.m_type1 == RevoluteJoint.TYPE) {\n        this.m_JvAC = Vec2.zero();\n        this.m_JwA = 1;\n        this.m_JwC = 1;\n        this.m_mass += this.m_iA + this.m_iC;\n      } else {\n        var u = Rot.mulVec2(qC, this.m_localAxisC);\n        var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);\n        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);\n        this.m_JvAC = u;\n        this.m_JwC = Vec2.crossVec2Vec2(rC, u);\n        this.m_JwA = Vec2.crossVec2Vec2(rA2, u);\n        this.m_mass += this.m_mC + this.m_mA + this.m_iC * this.m_JwC * this.m_JwC + this.m_iA * this.m_JwA * this.m_JwA;\n      }\n      if (this.m_type2 == RevoluteJoint.TYPE) {\n        this.m_JvBD = Vec2.zero();\n        this.m_JwB = this.m_ratio;\n        this.m_JwD = this.m_ratio;\n        this.m_mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);\n      } else {\n        var u = Rot.mulVec2(qD, this.m_localAxisD);\n        var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);\n        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);\n        this.m_JvBD = Vec2.mulNumVec2(this.m_ratio, u);\n        this.m_JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);\n        this.m_JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);\n        this.m_mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * this.m_JwD * this.m_JwD + this.m_iB * this.m_JwB * this.m_JwB;\n      }\n      this.m_mass = this.m_mass > 0 ? 1 / this.m_mass : 0;\n      if (step.warmStarting) {\n        vA2.addMul(this.m_mA * this.m_impulse, this.m_JvAC);\n        wA += this.m_iA * this.m_impulse * this.m_JwA;\n        vB2.addMul(this.m_mB * this.m_impulse, this.m_JvBD);\n        wB += this.m_iB * this.m_impulse * this.m_JwB;\n        vC.subMul(this.m_mC * this.m_impulse, this.m_JvAC);\n        wC -= this.m_iC * this.m_impulse * this.m_JwC;\n        vD.subMul(this.m_mD * this.m_impulse, this.m_JvBD);\n        wD -= this.m_iD * this.m_impulse * this.m_JwD;\n      } else {\n        this.m_impulse = 0;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n      this.m_bodyC.c_velocity.v.setVec2(vC);\n      this.m_bodyC.c_velocity.w = wC;\n      this.m_bodyD.c_velocity.v.setVec2(vD);\n      this.m_bodyD.c_velocity.w = wD;\n    };\n    GearJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var vC = this.m_bodyC.c_velocity.v;\n      var wC = this.m_bodyC.c_velocity.w;\n      var vD = this.m_bodyD.c_velocity.v;\n      var wD = this.m_bodyD.c_velocity.w;\n      var Cdot = Vec2.dot(this.m_JvAC, vA2) - Vec2.dot(this.m_JvAC, vC) + Vec2.dot(this.m_JvBD, vB2) - Vec2.dot(this.m_JvBD, vD);\n      Cdot += this.m_JwA * wA - this.m_JwC * wC + (this.m_JwB * wB - this.m_JwD * wD);\n      var impulse = -this.m_mass * Cdot;\n      this.m_impulse += impulse;\n      vA2.addMul(this.m_mA * impulse, this.m_JvAC);\n      wA += this.m_iA * impulse * this.m_JwA;\n      vB2.addMul(this.m_mB * impulse, this.m_JvBD);\n      wB += this.m_iB * impulse * this.m_JwB;\n      vC.subMul(this.m_mC * impulse, this.m_JvAC);\n      wC -= this.m_iC * impulse * this.m_JwC;\n      vD.subMul(this.m_mD * impulse, this.m_JvBD);\n      wD -= this.m_iD * impulse * this.m_JwD;\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n      this.m_bodyC.c_velocity.v.setVec2(vC);\n      this.m_bodyC.c_velocity.w = wC;\n      this.m_bodyD.c_velocity.v.setVec2(vD);\n      this.m_bodyD.c_velocity.w = wD;\n    };\n    GearJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var cC = this.m_bodyC.c_position.c;\n      var aC = this.m_bodyC.c_position.a;\n      var cD = this.m_bodyD.c_position.c;\n      var aD = this.m_bodyD.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var qC = Rot.neo(aC);\n      var qD = Rot.neo(aD);\n      var linearError = 0;\n      var coordinateA;\n      var coordinateB;\n      var JvAC;\n      var JvBD;\n      var JwA;\n      var JwB;\n      var JwC;\n      var JwD;\n      var mass = 0;\n      if (this.m_type1 == RevoluteJoint.TYPE) {\n        JvAC = Vec2.zero();\n        JwA = 1;\n        JwC = 1;\n        mass += this.m_iA + this.m_iC;\n        coordinateA = aA - aC - this.m_referenceAngleA;\n      } else {\n        var u = Rot.mulVec2(qC, this.m_localAxisC);\n        var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);\n        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);\n        JvAC = u;\n        JwC = Vec2.crossVec2Vec2(rC, u);\n        JwA = Vec2.crossVec2Vec2(rA2, u);\n        mass += this.m_mC + this.m_mA + this.m_iC * JwC * JwC + this.m_iA * JwA * JwA;\n        var pC = Vec2.sub(this.m_localAnchorC, this.m_lcC);\n        var pA2 = Rot.mulTVec2(qC, Vec2.add(rA2, Vec2.sub(cA2, cC)));\n        coordinateA = Vec2.dot(Vec2.sub(pA2, pC), this.m_localAxisC);\n      }\n      if (this.m_type2 == RevoluteJoint.TYPE) {\n        JvBD = Vec2.zero();\n        JwB = this.m_ratio;\n        JwD = this.m_ratio;\n        mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);\n        coordinateB = aB - aD - this.m_referenceAngleB;\n      } else {\n        var u = Rot.mulVec2(qD, this.m_localAxisD);\n        var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);\n        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);\n        JvBD = Vec2.mulNumVec2(this.m_ratio, u);\n        JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);\n        JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);\n        mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * JwD * JwD + this.m_iB * JwB * JwB;\n        var pD = Vec2.sub(this.m_localAnchorD, this.m_lcD);\n        var pB2 = Rot.mulTVec2(qD, Vec2.add(rB2, Vec2.sub(cB2, cD)));\n        coordinateB = Vec2.dot(pB2, this.m_localAxisD) - Vec2.dot(pD, this.m_localAxisD);\n      }\n      var C = coordinateA + this.m_ratio * coordinateB - this.m_constant;\n      var impulse = 0;\n      if (mass > 0) {\n        impulse = -C / mass;\n      }\n      cA2.addMul(this.m_mA * impulse, JvAC);\n      aA += this.m_iA * impulse * JwA;\n      cB2.addMul(this.m_mB * impulse, JvBD);\n      aB += this.m_iB * impulse * JwB;\n      cC.subMul(this.m_mC * impulse, JvAC);\n      aC -= this.m_iC * impulse * JwC;\n      cD.subMul(this.m_mD * impulse, JvBD);\n      aD -= this.m_iD * impulse * JwD;\n      this.m_bodyA.c_position.c.setVec2(cA2);\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c.setVec2(cB2);\n      this.m_bodyB.c_position.a = aB;\n      this.m_bodyC.c_position.c.setVec2(cC);\n      this.m_bodyC.c_position.a = aC;\n      this.m_bodyD.c_position.c.setVec2(cD);\n      this.m_bodyD.c_position.a = aD;\n      return linearError < SettingsInternal.linearSlop;\n    };\n    GearJoint2.TYPE = \"gear-joint\";\n    return GearJoint2;\n  }(Joint)\n);\nvar DEFAULTS$5 = {\n  maxForce: 1,\n  maxTorque: 1,\n  correctionFactor: 0.3\n};\nvar MotorJoint = (\n  /** @class */\n  function(_super) {\n    __extends(MotorJoint2, _super);\n    function MotorJoint2(def, bodyA, bodyB) {\n      var _this = this;\n      if (!(_this instanceof MotorJoint2)) {\n        return new MotorJoint2(def, bodyA, bodyB);\n      }\n      def = options(def, DEFAULTS$5);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = MotorJoint2.TYPE;\n      _this.m_linearOffset = Vec2.isValid(def.linearOffset) ? Vec2.clone(def.linearOffset) : bodyA.getLocalPoint(bodyB.getPosition());\n      _this.m_angularOffset = Number.isFinite(def.angularOffset) ? def.angularOffset : bodyB.getAngle() - bodyA.getAngle();\n      _this.m_linearImpulse = Vec2.zero();\n      _this.m_angularImpulse = 0;\n      _this.m_maxForce = def.maxForce;\n      _this.m_maxTorque = def.maxTorque;\n      _this.m_correctionFactor = def.correctionFactor;\n      return _this;\n    }\n    MotorJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        maxForce: this.m_maxForce,\n        maxTorque: this.m_maxTorque,\n        correctionFactor: this.m_correctionFactor,\n        linearOffset: this.m_linearOffset,\n        angularOffset: this.m_angularOffset\n      };\n    };\n    MotorJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new MotorJoint2(data);\n      return joint;\n    };\n    MotorJoint2.prototype._reset = function(def) {\n      if (Number.isFinite(def.angularOffset)) {\n        this.m_angularOffset = def.angularOffset;\n      }\n      if (Number.isFinite(def.maxForce)) {\n        this.m_maxForce = def.maxForce;\n      }\n      if (Number.isFinite(def.maxTorque)) {\n        this.m_maxTorque = def.maxTorque;\n      }\n      if (Number.isFinite(def.correctionFactor)) {\n        this.m_correctionFactor = def.correctionFactor;\n      }\n      if (Vec2.isValid(def.linearOffset)) {\n        this.m_linearOffset.set(def.linearOffset);\n      }\n    };\n    MotorJoint2.prototype.setMaxForce = function(force) {\n      this.m_maxForce = force;\n    };\n    MotorJoint2.prototype.getMaxForce = function() {\n      return this.m_maxForce;\n    };\n    MotorJoint2.prototype.setMaxTorque = function(torque) {\n      this.m_maxTorque = torque;\n    };\n    MotorJoint2.prototype.getMaxTorque = function() {\n      return this.m_maxTorque;\n    };\n    MotorJoint2.prototype.setCorrectionFactor = function(factor) {\n      this.m_correctionFactor = factor;\n    };\n    MotorJoint2.prototype.getCorrectionFactor = function() {\n      return this.m_correctionFactor;\n    };\n    MotorJoint2.prototype.setLinearOffset = function(linearOffset) {\n      if (linearOffset.x != this.m_linearOffset.x || linearOffset.y != this.m_linearOffset.y) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_linearOffset.set(linearOffset);\n      }\n    };\n    MotorJoint2.prototype.getLinearOffset = function() {\n      return this.m_linearOffset;\n    };\n    MotorJoint2.prototype.setAngularOffset = function(angularOffset) {\n      if (angularOffset != this.m_angularOffset) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_angularOffset = angularOffset;\n      }\n    };\n    MotorJoint2.prototype.getAngularOffset = function() {\n      return this.m_angularOffset;\n    };\n    MotorJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getPosition();\n    };\n    MotorJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getPosition();\n    };\n    MotorJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);\n    };\n    MotorJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_angularImpulse;\n    };\n    MotorJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_linearOffset, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.neg(this.m_localCenterB));\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var K = new Mat22();\n      K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;\n      K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;\n      K.ey.x = K.ex.y;\n      K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;\n      this.m_linearMass = K.getInverse();\n      this.m_angularMass = iA + iB;\n      if (this.m_angularMass > 0) {\n        this.m_angularMass = 1 / this.m_angularMass;\n      }\n      this.m_linearError = Vec2.zero();\n      this.m_linearError.addCombine(1, cB2, 1, this.m_rB);\n      this.m_linearError.subCombine(1, cA2, 1, this.m_rA);\n      this.m_angularError = aB - aA - this.m_angularOffset;\n      if (step.warmStarting) {\n        this.m_linearImpulse.mul(step.dtRatio);\n        this.m_angularImpulse *= step.dtRatio;\n        var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);\n      } else {\n        this.m_linearImpulse.setZero();\n        this.m_angularImpulse = 0;\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    MotorJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var h = step.dt;\n      var inv_h = step.inv_dt;\n      {\n        var Cdot = wB - wA + inv_h * this.m_correctionFactor * this.m_angularError;\n        var impulse = -this.m_angularMass * Cdot;\n        var oldImpulse = this.m_angularImpulse;\n        var maxImpulse = h * this.m_maxTorque;\n        this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);\n        impulse = this.m_angularImpulse - oldImpulse;\n        wA -= iA * impulse;\n        wB += iB * impulse;\n      }\n      {\n        var Cdot = Vec2.zero();\n        Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));\n        Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));\n        Cdot.addMul(inv_h * this.m_correctionFactor, this.m_linearError);\n        var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));\n        var oldImpulse = Vec2.clone(this.m_linearImpulse);\n        this.m_linearImpulse.add(impulse);\n        var maxImpulse = h * this.m_maxForce;\n        this.m_linearImpulse.clamp(maxImpulse);\n        impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);\n        vA2.subMul(mA, impulse);\n        wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);\n        vB2.addMul(mB, impulse);\n        wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    MotorJoint2.prototype.solvePositionConstraints = function(step) {\n      return true;\n    };\n    MotorJoint2.TYPE = \"motor-joint\";\n    return MotorJoint2;\n  }(Joint)\n);\nvar math_PI$2 = Math.PI;\nvar DEFAULTS$4 = {\n  maxForce: 0,\n  frequencyHz: 5,\n  dampingRatio: 0.7\n};\nvar MouseJoint = (\n  /** @class */\n  function(_super) {\n    __extends(MouseJoint2, _super);\n    function MouseJoint2(def, bodyA, bodyB, target) {\n      var _this = this;\n      if (!(_this instanceof MouseJoint2)) {\n        return new MouseJoint2(def, bodyA, bodyB, target);\n      }\n      def = options(def, DEFAULTS$4);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = MouseJoint2.TYPE;\n      if (Vec2.isValid(target)) {\n        _this.m_targetA = Vec2.clone(target);\n      } else if (Vec2.isValid(def.target)) {\n        _this.m_targetA = Vec2.clone(def.target);\n      } else {\n        _this.m_targetA = Vec2.zero();\n      }\n      _this.m_localAnchorB = Transform.mulTVec2(bodyB.getTransform(), _this.m_targetA);\n      _this.m_maxForce = def.maxForce;\n      _this.m_impulse = Vec2.zero();\n      _this.m_frequencyHz = def.frequencyHz;\n      _this.m_dampingRatio = def.dampingRatio;\n      _this.m_beta = 0;\n      _this.m_gamma = 0;\n      _this.m_rB = Vec2.zero();\n      _this.m_localCenterB = Vec2.zero();\n      _this.m_invMassB = 0;\n      _this.m_invIB = 0;\n      _this.m_mass = new Mat22();\n      _this.m_C = Vec2.zero();\n      return _this;\n    }\n    MouseJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        target: this.m_targetA,\n        maxForce: this.m_maxForce,\n        frequencyHz: this.m_frequencyHz,\n        dampingRatio: this.m_dampingRatio,\n        _localAnchorB: this.m_localAnchorB\n      };\n    };\n    MouseJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      data.target = Vec2.clone(data.target);\n      var joint = new MouseJoint2(data);\n      if (data._localAnchorB) {\n        joint.m_localAnchorB = data._localAnchorB;\n      }\n      return joint;\n    };\n    MouseJoint2.prototype._reset = function(def) {\n      if (Number.isFinite(def.maxForce)) {\n        this.m_maxForce = def.maxForce;\n      }\n      if (Number.isFinite(def.frequencyHz)) {\n        this.m_frequencyHz = def.frequencyHz;\n      }\n      if (Number.isFinite(def.dampingRatio)) {\n        this.m_dampingRatio = def.dampingRatio;\n      }\n    };\n    MouseJoint2.prototype.setTarget = function(target) {\n      if (Vec2.areEqual(target, this.m_targetA))\n        return;\n      this.m_bodyB.setAwake(true);\n      this.m_targetA.set(target);\n    };\n    MouseJoint2.prototype.getTarget = function() {\n      return this.m_targetA;\n    };\n    MouseJoint2.prototype.setMaxForce = function(force) {\n      this.m_maxForce = force;\n    };\n    MouseJoint2.prototype.getMaxForce = function() {\n      return this.m_maxForce;\n    };\n    MouseJoint2.prototype.setFrequency = function(hz) {\n      this.m_frequencyHz = hz;\n    };\n    MouseJoint2.prototype.getFrequency = function() {\n      return this.m_frequencyHz;\n    };\n    MouseJoint2.prototype.setDampingRatio = function(ratio) {\n      this.m_dampingRatio = ratio;\n    };\n    MouseJoint2.prototype.getDampingRatio = function() {\n      return this.m_dampingRatio;\n    };\n    MouseJoint2.prototype.getAnchorA = function() {\n      return Vec2.clone(this.m_targetA);\n    };\n    MouseJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    MouseJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(inv_dt, this.m_impulse);\n    };\n    MouseJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * 0;\n    };\n    MouseJoint2.prototype.shiftOrigin = function(newOrigin) {\n      this.m_targetA.sub(newOrigin);\n    };\n    MouseJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var position = this.m_bodyB.c_position;\n      var velocity = this.m_bodyB.c_velocity;\n      var cB2 = position.c;\n      var aB = position.a;\n      var vB2 = velocity.v;\n      var wB = velocity.w;\n      var qB = Rot.neo(aB);\n      var mass = this.m_bodyB.getMass();\n      var omega = 2 * math_PI$2 * this.m_frequencyHz;\n      var d2 = 2 * mass * this.m_dampingRatio * omega;\n      var k = mass * (omega * omega);\n      var h = step.dt;\n      this.m_gamma = h * (d2 + h * k);\n      if (this.m_gamma != 0) {\n        this.m_gamma = 1 / this.m_gamma;\n      }\n      this.m_beta = h * k * this.m_gamma;\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var K = new Mat22();\n      K.ex.x = this.m_invMassB + this.m_invIB * this.m_rB.y * this.m_rB.y + this.m_gamma;\n      K.ex.y = -this.m_invIB * this.m_rB.x * this.m_rB.y;\n      K.ey.x = K.ex.y;\n      K.ey.y = this.m_invMassB + this.m_invIB * this.m_rB.x * this.m_rB.x + this.m_gamma;\n      this.m_mass = K.getInverse();\n      this.m_C.setVec2(cB2);\n      this.m_C.addCombine(1, this.m_rB, -1, this.m_targetA);\n      this.m_C.mul(this.m_beta);\n      wB *= 0.98;\n      if (step.warmStarting) {\n        this.m_impulse.mul(step.dtRatio);\n        vB2.addMul(this.m_invMassB, this.m_impulse);\n        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, this.m_impulse);\n      } else {\n        this.m_impulse.setZero();\n      }\n      velocity.v.setVec2(vB2);\n      velocity.w = wB;\n    };\n    MouseJoint2.prototype.solveVelocityConstraints = function(step) {\n      var velocity = this.m_bodyB.c_velocity;\n      var vB2 = Vec2.clone(velocity.v);\n      var wB = velocity.w;\n      var Cdot = Vec2.crossNumVec2(wB, this.m_rB);\n      Cdot.add(vB2);\n      Cdot.addCombine(1, this.m_C, this.m_gamma, this.m_impulse);\n      Cdot.neg();\n      var impulse = Mat22.mulVec2(this.m_mass, Cdot);\n      var oldImpulse = Vec2.clone(this.m_impulse);\n      this.m_impulse.add(impulse);\n      var maxImpulse = step.dt * this.m_maxForce;\n      this.m_impulse.clamp(maxImpulse);\n      impulse = Vec2.sub(this.m_impulse, oldImpulse);\n      vB2.addMul(this.m_invMassB, impulse);\n      wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, impulse);\n      velocity.v.setVec2(vB2);\n      velocity.w = wB;\n    };\n    MouseJoint2.prototype.solvePositionConstraints = function(step) {\n      return true;\n    };\n    MouseJoint2.TYPE = \"mouse-joint\";\n    return MouseJoint2;\n  }(Joint)\n);\nvar math_abs$2 = Math.abs;\nvar DEFAULTS$3 = {\n  collideConnected: true\n};\nvar PulleyJoint = (\n  /** @class */\n  function(_super) {\n    __extends(PulleyJoint2, _super);\n    function PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio) {\n      var _this = this;\n      if (!(_this instanceof PulleyJoint2)) {\n        return new PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio);\n      }\n      def = options(def, DEFAULTS$3);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = PulleyJoint2.TYPE;\n      _this.m_groundAnchorA = Vec2.clone(groundA ? groundA : def.groundAnchorA || Vec2.neo(-1, 1));\n      _this.m_groundAnchorB = Vec2.clone(groundB ? groundB : def.groundAnchorB || Vec2.neo(1, 1));\n      _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.neo(-1, 0));\n      _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.neo(1, 0));\n      _this.m_lengthA = Number.isFinite(def.lengthA) ? def.lengthA : Vec2.distance(anchorA, groundA);\n      _this.m_lengthB = Number.isFinite(def.lengthB) ? def.lengthB : Vec2.distance(anchorB, groundB);\n      _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;\n      _this.m_constant = _this.m_lengthA + _this.m_ratio * _this.m_lengthB;\n      _this.m_impulse = 0;\n      return _this;\n    }\n    PulleyJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        groundAnchorA: this.m_groundAnchorA,\n        groundAnchorB: this.m_groundAnchorB,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        lengthA: this.m_lengthA,\n        lengthB: this.m_lengthB,\n        ratio: this.m_ratio\n      };\n    };\n    PulleyJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new PulleyJoint2(data);\n      return joint;\n    };\n    PulleyJoint2.prototype._reset = function(def) {\n      if (Vec2.isValid(def.groundAnchorA)) {\n        this.m_groundAnchorA.set(def.groundAnchorA);\n      }\n      if (Vec2.isValid(def.groundAnchorB)) {\n        this.m_groundAnchorB.set(def.groundAnchorB);\n      }\n      if (Vec2.isValid(def.localAnchorA)) {\n        this.m_localAnchorA.set(def.localAnchorA);\n      } else if (Vec2.isValid(def.anchorA)) {\n        this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(def.anchorA));\n      }\n      if (Vec2.isValid(def.localAnchorB)) {\n        this.m_localAnchorB.set(def.localAnchorB);\n      } else if (Vec2.isValid(def.anchorB)) {\n        this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(def.anchorB));\n      }\n      if (Number.isFinite(def.lengthA)) {\n        this.m_lengthA = def.lengthA;\n      }\n      if (Number.isFinite(def.lengthB)) {\n        this.m_lengthB = def.lengthB;\n      }\n      if (Number.isFinite(def.ratio)) {\n        this.m_ratio = def.ratio;\n      }\n    };\n    PulleyJoint2.prototype.getGroundAnchorA = function() {\n      return this.m_groundAnchorA;\n    };\n    PulleyJoint2.prototype.getGroundAnchorB = function() {\n      return this.m_groundAnchorB;\n    };\n    PulleyJoint2.prototype.getLengthA = function() {\n      return this.m_lengthA;\n    };\n    PulleyJoint2.prototype.getLengthB = function() {\n      return this.m_lengthB;\n    };\n    PulleyJoint2.prototype.getRatio = function() {\n      return this.m_ratio;\n    };\n    PulleyJoint2.prototype.getCurrentLengthA = function() {\n      var p = this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n      var s2 = this.m_groundAnchorA;\n      return Vec2.distance(p, s2);\n    };\n    PulleyJoint2.prototype.getCurrentLengthB = function() {\n      var p = this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n      var s2 = this.m_groundAnchorB;\n      return Vec2.distance(p, s2);\n    };\n    PulleyJoint2.prototype.shiftOrigin = function(newOrigin) {\n      this.m_groundAnchorA.sub(newOrigin);\n      this.m_groundAnchorB.sub(newOrigin);\n    };\n    PulleyJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    PulleyJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    PulleyJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(this.m_impulse, this.m_uB).mul(inv_dt);\n    };\n    PulleyJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return 0;\n    };\n    PulleyJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      this.m_uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);\n      this.m_uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);\n      var lengthA = this.m_uA.length();\n      var lengthB = this.m_uB.length();\n      if (lengthA > 10 * SettingsInternal.linearSlop) {\n        this.m_uA.mul(1 / lengthA);\n      } else {\n        this.m_uA.setZero();\n      }\n      if (lengthB > 10 * SettingsInternal.linearSlop) {\n        this.m_uB.mul(1 / lengthB);\n      } else {\n        this.m_uB.setZero();\n      }\n      var ruA = Vec2.crossVec2Vec2(this.m_rA, this.m_uA);\n      var ruB = Vec2.crossVec2Vec2(this.m_rB, this.m_uB);\n      var mA = this.m_invMassA + this.m_invIA * ruA * ruA;\n      var mB = this.m_invMassB + this.m_invIB * ruB * ruB;\n      this.m_mass = mA + this.m_ratio * this.m_ratio * mB;\n      if (this.m_mass > 0) {\n        this.m_mass = 1 / this.m_mass;\n      }\n      if (step.warmStarting) {\n        this.m_impulse *= step.dtRatio;\n        var PA = Vec2.mulNumVec2(-this.m_impulse, this.m_uA);\n        var PB = Vec2.mulNumVec2(-this.m_ratio * this.m_impulse, this.m_uB);\n        vA2.addMul(this.m_invMassA, PA);\n        wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);\n        vB2.addMul(this.m_invMassB, PB);\n        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);\n      } else {\n        this.m_impulse = 0;\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    PulleyJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));\n      var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));\n      var Cdot = -Vec2.dot(this.m_uA, vpA) - this.m_ratio * Vec2.dot(this.m_uB, vpB);\n      var impulse = -this.m_mass * Cdot;\n      this.m_impulse += impulse;\n      var PA = Vec2.mulNumVec2(-impulse, this.m_uA);\n      var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, this.m_uB);\n      vA2.addMul(this.m_invMassA, PA);\n      wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);\n      vB2.addMul(this.m_invMassB, PB);\n      wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    PulleyJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);\n      var uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);\n      var lengthA = uA.length();\n      var lengthB = uB.length();\n      if (lengthA > 10 * SettingsInternal.linearSlop) {\n        uA.mul(1 / lengthA);\n      } else {\n        uA.setZero();\n      }\n      if (lengthB > 10 * SettingsInternal.linearSlop) {\n        uB.mul(1 / lengthB);\n      } else {\n        uB.setZero();\n      }\n      var ruA = Vec2.crossVec2Vec2(rA2, uA);\n      var ruB = Vec2.crossVec2Vec2(rB2, uB);\n      var mA = this.m_invMassA + this.m_invIA * ruA * ruA;\n      var mB = this.m_invMassB + this.m_invIB * ruB * ruB;\n      var mass = mA + this.m_ratio * this.m_ratio * mB;\n      if (mass > 0) {\n        mass = 1 / mass;\n      }\n      var C = this.m_constant - lengthA - this.m_ratio * lengthB;\n      var linearError = math_abs$2(C);\n      var impulse = -mass * C;\n      var PA = Vec2.mulNumVec2(-impulse, uA);\n      var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, uB);\n      cA2.addMul(this.m_invMassA, PA);\n      aA += this.m_invIA * Vec2.crossVec2Vec2(rA2, PA);\n      cB2.addMul(this.m_invMassB, PB);\n      aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, PB);\n      this.m_bodyA.c_position.c = cA2;\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c = cB2;\n      this.m_bodyB.c_position.a = aB;\n      return linearError < SettingsInternal.linearSlop;\n    };\n    PulleyJoint2.TYPE = \"pulley-joint\";\n    return PulleyJoint2;\n  }(Joint)\n);\nvar math_min$1 = Math.min;\nvar LimitState;\n(function(LimitState2) {\n  LimitState2[LimitState2[\"inactiveLimit\"] = 0] = \"inactiveLimit\";\n  LimitState2[LimitState2[\"atLowerLimit\"] = 1] = \"atLowerLimit\";\n  LimitState2[LimitState2[\"atUpperLimit\"] = 2] = \"atUpperLimit\";\n  LimitState2[LimitState2[\"equalLimits\"] = 3] = \"equalLimits\";\n})(LimitState || (LimitState = {}));\nvar DEFAULTS$2 = {\n  maxLength: 0\n};\nvar RopeJoint = (\n  /** @class */\n  function(_super) {\n    __extends(RopeJoint2, _super);\n    function RopeJoint2(def, bodyA, bodyB, anchor) {\n      var _this = this;\n      if (!(_this instanceof RopeJoint2)) {\n        return new RopeJoint2(def, bodyA, bodyB, anchor);\n      }\n      def = options(def, DEFAULTS$2);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = RopeJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.neo(-1, 0));\n      _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.neo(1, 0));\n      _this.m_maxLength = def.maxLength;\n      _this.m_mass = 0;\n      _this.m_impulse = 0;\n      _this.m_length = 0;\n      _this.m_state = LimitState.inactiveLimit;\n      return _this;\n    }\n    RopeJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        maxLength: this.m_maxLength\n      };\n    };\n    RopeJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new RopeJoint2(data);\n      return joint;\n    };\n    RopeJoint2.prototype._reset = function(def) {\n      if (Number.isFinite(def.maxLength)) {\n        this.m_maxLength = def.maxLength;\n      }\n    };\n    RopeJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    RopeJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    RopeJoint2.prototype.setMaxLength = function(length) {\n      this.m_maxLength = length;\n    };\n    RopeJoint2.prototype.getMaxLength = function() {\n      return this.m_maxLength;\n    };\n    RopeJoint2.prototype.getLimitState = function() {\n      return this.m_state;\n    };\n    RopeJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    RopeJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    RopeJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);\n    };\n    RopeJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return 0;\n    };\n    RopeJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);\n      this.m_rB = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);\n      this.m_u = Vec2.zero();\n      this.m_u.addCombine(1, cB2, 1, this.m_rB);\n      this.m_u.subCombine(1, cA2, 1, this.m_rA);\n      this.m_length = this.m_u.length();\n      var C = this.m_length - this.m_maxLength;\n      if (C > 0) {\n        this.m_state = LimitState.atUpperLimit;\n      } else {\n        this.m_state = LimitState.inactiveLimit;\n      }\n      if (this.m_length > SettingsInternal.linearSlop) {\n        this.m_u.mul(1 / this.m_length);\n      } else {\n        this.m_u.setZero();\n        this.m_mass = 0;\n        this.m_impulse = 0;\n        return;\n      }\n      var crA = Vec2.crossVec2Vec2(this.m_rA, this.m_u);\n      var crB = Vec2.crossVec2Vec2(this.m_rB, this.m_u);\n      var invMass = this.m_invMassA + this.m_invIA * crA * crA + this.m_invMassB + this.m_invIB * crB * crB;\n      this.m_mass = invMass != 0 ? 1 / invMass : 0;\n      if (step.warmStarting) {\n        this.m_impulse *= step.dtRatio;\n        var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);\n        vA2.subMul(this.m_invMassA, P3);\n        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);\n        vB2.addMul(this.m_invMassB, P3);\n        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);\n      } else {\n        this.m_impulse = 0;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    RopeJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var vpA = Vec2.addCrossNumVec2(vA2, wA, this.m_rA);\n      var vpB = Vec2.addCrossNumVec2(vB2, wB, this.m_rB);\n      var C = this.m_length - this.m_maxLength;\n      var Cdot = Vec2.dot(this.m_u, Vec2.sub(vpB, vpA));\n      if (C < 0) {\n        Cdot += step.inv_dt * C;\n      }\n      var impulse = -this.m_mass * Cdot;\n      var oldImpulse = this.m_impulse;\n      this.m_impulse = math_min$1(0, this.m_impulse + impulse);\n      impulse = this.m_impulse - oldImpulse;\n      var P3 = Vec2.mulNumVec2(impulse, this.m_u);\n      vA2.subMul(this.m_invMassA, P3);\n      wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);\n      vB2.addMul(this.m_invMassB, P3);\n      wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    RopeJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);\n      var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);\n      var u = Vec2.zero();\n      u.addCombine(1, cB2, 1, rB2);\n      u.subCombine(1, cA2, 1, rA2);\n      var length = u.normalize();\n      var C = length - this.m_maxLength;\n      C = clamp(C, 0, SettingsInternal.maxLinearCorrection);\n      var impulse = -this.m_mass * C;\n      var P3 = Vec2.mulNumVec2(impulse, u);\n      cA2.subMul(this.m_invMassA, P3);\n      aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);\n      cB2.addMul(this.m_invMassB, P3);\n      aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);\n      this.m_bodyA.c_position.c.setVec2(cA2);\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c.setVec2(cB2);\n      this.m_bodyB.c_position.a = aB;\n      return length - this.m_maxLength < SettingsInternal.linearSlop;\n    };\n    RopeJoint2.TYPE = \"rope-joint\";\n    return RopeJoint2;\n  }(Joint)\n);\nvar math_abs$1 = Math.abs;\nvar math_PI$1 = Math.PI;\nvar DEFAULTS$1 = {\n  frequencyHz: 0,\n  dampingRatio: 0\n};\nvar WeldJoint = (\n  /** @class */\n  function(_super) {\n    __extends(WeldJoint2, _super);\n    function WeldJoint2(def, bodyA, bodyB, anchor) {\n      var _this = this;\n      if (!(_this instanceof WeldJoint2)) {\n        return new WeldJoint2(def, bodyA, bodyB, anchor);\n      }\n      def = options(def, DEFAULTS$1);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = WeldJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());\n      _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());\n      _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();\n      _this.m_frequencyHz = def.frequencyHz;\n      _this.m_dampingRatio = def.dampingRatio;\n      _this.m_impulse = new Vec3();\n      _this.m_bias = 0;\n      _this.m_gamma = 0;\n      _this.m_mass = new Mat33();\n      return _this;\n    }\n    WeldJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        frequencyHz: this.m_frequencyHz,\n        dampingRatio: this.m_dampingRatio,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        referenceAngle: this.m_referenceAngle\n      };\n    };\n    WeldJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new WeldJoint2(data);\n      return joint;\n    };\n    WeldJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (Number.isFinite(def.frequencyHz)) {\n        this.m_frequencyHz = def.frequencyHz;\n      }\n      if (Number.isFinite(def.dampingRatio)) {\n        this.m_dampingRatio = def.dampingRatio;\n      }\n    };\n    WeldJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    WeldJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    WeldJoint2.prototype.getReferenceAngle = function() {\n      return this.m_referenceAngle;\n    };\n    WeldJoint2.prototype.setFrequency = function(hz) {\n      this.m_frequencyHz = hz;\n    };\n    WeldJoint2.prototype.getFrequency = function() {\n      return this.m_frequencyHz;\n    };\n    WeldJoint2.prototype.setDampingRatio = function(ratio) {\n      this.m_dampingRatio = ratio;\n    };\n    WeldJoint2.prototype.getDampingRatio = function() {\n      return this.m_dampingRatio;\n    };\n    WeldJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    WeldJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    WeldJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);\n    };\n    WeldJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_impulse.z;\n    };\n    WeldJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var K = new Mat33();\n      K.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;\n      K.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;\n      K.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;\n      K.ex.y = K.ey.x;\n      K.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;\n      K.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;\n      K.ex.z = K.ez.x;\n      K.ey.z = K.ez.y;\n      K.ez.z = iA + iB;\n      if (this.m_frequencyHz > 0) {\n        K.getInverse22(this.m_mass);\n        var invM = iA + iB;\n        var m = invM > 0 ? 1 / invM : 0;\n        var C = aB - aA - this.m_referenceAngle;\n        var omega = 2 * math_PI$1 * this.m_frequencyHz;\n        var d2 = 2 * m * this.m_dampingRatio * omega;\n        var k = m * omega * omega;\n        var h = step.dt;\n        this.m_gamma = h * (d2 + h * k);\n        this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;\n        this.m_bias = C * h * k * this.m_gamma;\n        invM += this.m_gamma;\n        this.m_mass.ez.z = invM != 0 ? 1 / invM : 0;\n      } else if (K.ez.z == 0) {\n        K.getInverse22(this.m_mass);\n        this.m_gamma = 0;\n        this.m_bias = 0;\n      } else {\n        K.getSymInverse33(this.m_mass);\n        this.m_gamma = 0;\n        this.m_bias = 0;\n      }\n      if (step.warmStarting) {\n        this.m_impulse.mul(step.dtRatio);\n        var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_impulse.z);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_impulse.z);\n      } else {\n        this.m_impulse.setZero();\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    WeldJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      if (this.m_frequencyHz > 0) {\n        var Cdot2 = wB - wA;\n        var impulse2 = -this.m_mass.ez.z * (Cdot2 + this.m_bias + this.m_gamma * this.m_impulse.z);\n        this.m_impulse.z += impulse2;\n        wA -= iA * impulse2;\n        wB += iB * impulse2;\n        var Cdot1 = Vec2.zero();\n        Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));\n        Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));\n        var impulse1 = Vec2.neg(Mat33.mulVec2(this.m_mass, Cdot1));\n        this.m_impulse.x += impulse1.x;\n        this.m_impulse.y += impulse1.y;\n        var P3 = Vec2.clone(impulse1);\n        vA2.subMul(mA, P3);\n        wA -= iA * Vec2.crossVec2Vec2(this.m_rA, P3);\n        vB2.addMul(mB, P3);\n        wB += iB * Vec2.crossVec2Vec2(this.m_rB, P3);\n      } else {\n        var Cdot1 = Vec2.zero();\n        Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));\n        Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));\n        var Cdot2 = wB - wA;\n        var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);\n        var impulse = Vec3.neg(Mat33.mulVec3(this.m_mass, Cdot));\n        this.m_impulse.add(impulse);\n        var P3 = Vec2.neo(impulse.x, impulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    WeldJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var positionError;\n      var angularError;\n      var K = new Mat33();\n      K.ex.x = mA + mB + rA2.y * rA2.y * iA + rB2.y * rB2.y * iB;\n      K.ey.x = -rA2.y * rA2.x * iA - rB2.y * rB2.x * iB;\n      K.ez.x = -rA2.y * iA - rB2.y * iB;\n      K.ex.y = K.ey.x;\n      K.ey.y = mA + mB + rA2.x * rA2.x * iA + rB2.x * rB2.x * iB;\n      K.ez.y = rA2.x * iA + rB2.x * iB;\n      K.ex.z = K.ez.x;\n      K.ey.z = K.ez.y;\n      K.ez.z = iA + iB;\n      if (this.m_frequencyHz > 0) {\n        var C1 = Vec2.zero();\n        C1.addCombine(1, cB2, 1, rB2);\n        C1.subCombine(1, cA2, 1, rA2);\n        positionError = C1.length();\n        angularError = 0;\n        var P3 = Vec2.neg(K.solve22(C1));\n        cA2.subMul(mA, P3);\n        aA -= iA * Vec2.crossVec2Vec2(rA2, P3);\n        cB2.addMul(mB, P3);\n        aB += iB * Vec2.crossVec2Vec2(rB2, P3);\n      } else {\n        var C1 = Vec2.zero();\n        C1.addCombine(1, cB2, 1, rB2);\n        C1.subCombine(1, cA2, 1, rA2);\n        var C2 = aB - aA - this.m_referenceAngle;\n        positionError = C1.length();\n        angularError = math_abs$1(C2);\n        var C = new Vec3(C1.x, C1.y, C2);\n        var impulse = new Vec3();\n        if (K.ez.z > 0) {\n          impulse = Vec3.neg(K.solve33(C));\n        } else {\n          var impulse2 = Vec2.neg(K.solve22(C1));\n          impulse.set(impulse2.x, impulse2.y, 0);\n        }\n        var P3 = Vec2.neo(impulse.x, impulse.y);\n        cA2.subMul(mA, P3);\n        aA -= iA * (Vec2.crossVec2Vec2(rA2, P3) + impulse.z);\n        cB2.addMul(mB, P3);\n        aB += iB * (Vec2.crossVec2Vec2(rB2, P3) + impulse.z);\n      }\n      this.m_bodyA.c_position.c = cA2;\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c = cB2;\n      this.m_bodyB.c_position.a = aB;\n      return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;\n    };\n    WeldJoint2.TYPE = \"weld-joint\";\n    return WeldJoint2;\n  }(Joint)\n);\nvar math_abs = Math.abs;\nvar math_PI = Math.PI;\nvar DEFAULTS = {\n  enableMotor: false,\n  maxMotorTorque: 0,\n  motorSpeed: 0,\n  frequencyHz: 2,\n  dampingRatio: 0.7\n};\nvar WheelJoint = (\n  /** @class */\n  function(_super) {\n    __extends(WheelJoint2, _super);\n    function WheelJoint2(def, bodyA, bodyB, anchor, axis) {\n      var _this = this;\n      if (!(_this instanceof WheelJoint2)) {\n        return new WheelJoint2(def, bodyA, bodyB, anchor, axis);\n      }\n      def = options(def, DEFAULTS);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_ax = Vec2.zero();\n      _this.m_ay = Vec2.zero();\n      _this.m_type = WheelJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());\n      _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());\n      if (Vec2.isValid(axis)) {\n        _this.m_localXAxisA = bodyA.getLocalVector(axis);\n      } else if (Vec2.isValid(def.localAxisA)) {\n        _this.m_localXAxisA = Vec2.clone(def.localAxisA);\n      } else if (Vec2.isValid(def.localAxis)) {\n        _this.m_localXAxisA = Vec2.clone(def.localAxis);\n      } else {\n        _this.m_localXAxisA = Vec2.neo(1, 0);\n      }\n      _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);\n      _this.m_mass = 0;\n      _this.m_impulse = 0;\n      _this.m_motorMass = 0;\n      _this.m_motorImpulse = 0;\n      _this.m_springMass = 0;\n      _this.m_springImpulse = 0;\n      _this.m_maxMotorTorque = def.maxMotorTorque;\n      _this.m_motorSpeed = def.motorSpeed;\n      _this.m_enableMotor = def.enableMotor;\n      _this.m_frequencyHz = def.frequencyHz;\n      _this.m_dampingRatio = def.dampingRatio;\n      _this.m_bias = 0;\n      _this.m_gamma = 0;\n      return _this;\n    }\n    WheelJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        enableMotor: this.m_enableMotor,\n        maxMotorTorque: this.m_maxMotorTorque,\n        motorSpeed: this.m_motorSpeed,\n        frequencyHz: this.m_frequencyHz,\n        dampingRatio: this.m_dampingRatio,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        localAxisA: this.m_localXAxisA\n      };\n    };\n    WheelJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new WheelJoint2(data);\n      return joint;\n    };\n    WheelJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (def.localAxisA) {\n        this.m_localXAxisA.setVec2(def.localAxisA);\n        this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));\n      }\n      if (def.enableMotor !== void 0) {\n        this.m_enableMotor = def.enableMotor;\n      }\n      if (Number.isFinite(def.maxMotorTorque)) {\n        this.m_maxMotorTorque = def.maxMotorTorque;\n      }\n      if (Number.isFinite(def.motorSpeed)) {\n        this.m_motorSpeed = def.motorSpeed;\n      }\n      if (Number.isFinite(def.frequencyHz)) {\n        this.m_frequencyHz = def.frequencyHz;\n      }\n      if (Number.isFinite(def.dampingRatio)) {\n        this.m_dampingRatio = def.dampingRatio;\n      }\n    };\n    WheelJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    WheelJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    WheelJoint2.prototype.getLocalAxisA = function() {\n      return this.m_localXAxisA;\n    };\n    WheelJoint2.prototype.getJointTranslation = function() {\n      var bA = this.m_bodyA;\n      var bB = this.m_bodyB;\n      var pA2 = bA.getWorldPoint(this.m_localAnchorA);\n      var pB2 = bB.getWorldPoint(this.m_localAnchorB);\n      var d2 = Vec2.sub(pB2, pA2);\n      var axis = bA.getWorldVector(this.m_localXAxisA);\n      var translation2 = Vec2.dot(d2, axis);\n      return translation2;\n    };\n    WheelJoint2.prototype.getJointSpeed = function() {\n      var wA = this.m_bodyA.m_angularVelocity;\n      var wB = this.m_bodyB.m_angularVelocity;\n      return wB - wA;\n    };\n    WheelJoint2.prototype.isMotorEnabled = function() {\n      return this.m_enableMotor;\n    };\n    WheelJoint2.prototype.enableMotor = function(flag) {\n      if (flag == this.m_enableMotor)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_enableMotor = flag;\n    };\n    WheelJoint2.prototype.setMotorSpeed = function(speed) {\n      if (speed == this.m_motorSpeed)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_motorSpeed = speed;\n    };\n    WheelJoint2.prototype.getMotorSpeed = function() {\n      return this.m_motorSpeed;\n    };\n    WheelJoint2.prototype.setMaxMotorTorque = function(torque) {\n      if (torque == this.m_maxMotorTorque)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_maxMotorTorque = torque;\n    };\n    WheelJoint2.prototype.getMaxMotorTorque = function() {\n      return this.m_maxMotorTorque;\n    };\n    WheelJoint2.prototype.getMotorTorque = function(inv_dt) {\n      return inv_dt * this.m_motorImpulse;\n    };\n    WheelJoint2.prototype.setSpringFrequencyHz = function(hz) {\n      this.m_frequencyHz = hz;\n    };\n    WheelJoint2.prototype.getSpringFrequencyHz = function() {\n      return this.m_frequencyHz;\n    };\n    WheelJoint2.prototype.setSpringDampingRatio = function(ratio) {\n      this.m_dampingRatio = ratio;\n    };\n    WheelJoint2.prototype.getSpringDampingRatio = function() {\n      return this.m_dampingRatio;\n    };\n    WheelJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    WheelJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    WheelJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax).mul(inv_dt);\n    };\n    WheelJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_motorImpulse;\n    };\n    WheelJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var d2 = Vec2.zero();\n      d2.addCombine(1, cB2, 1, rB2);\n      d2.subCombine(1, cA2, 1, rA2);\n      {\n        this.m_ay = Rot.mulVec2(qA, this.m_localYAxisA);\n        this.m_sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ay);\n        this.m_sBy = Vec2.crossVec2Vec2(rB2, this.m_ay);\n        this.m_mass = mA + mB + iA * this.m_sAy * this.m_sAy + iB * this.m_sBy * this.m_sBy;\n        if (this.m_mass > 0) {\n          this.m_mass = 1 / this.m_mass;\n        }\n      }\n      this.m_springMass = 0;\n      this.m_bias = 0;\n      this.m_gamma = 0;\n      if (this.m_frequencyHz > 0) {\n        this.m_ax = Rot.mulVec2(qA, this.m_localXAxisA);\n        this.m_sAx = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ax);\n        this.m_sBx = Vec2.crossVec2Vec2(rB2, this.m_ax);\n        var invMass = mA + mB + iA * this.m_sAx * this.m_sAx + iB * this.m_sBx * this.m_sBx;\n        if (invMass > 0) {\n          this.m_springMass = 1 / invMass;\n          var C = Vec2.dot(d2, this.m_ax);\n          var omega = 2 * math_PI * this.m_frequencyHz;\n          var damp = 2 * this.m_springMass * this.m_dampingRatio * omega;\n          var k = this.m_springMass * omega * omega;\n          var h = step.dt;\n          this.m_gamma = h * (damp + h * k);\n          if (this.m_gamma > 0) {\n            this.m_gamma = 1 / this.m_gamma;\n          }\n          this.m_bias = C * h * k * this.m_gamma;\n          this.m_springMass = invMass + this.m_gamma;\n          if (this.m_springMass > 0) {\n            this.m_springMass = 1 / this.m_springMass;\n          }\n        }\n      } else {\n        this.m_springImpulse = 0;\n      }\n      if (this.m_enableMotor) {\n        this.m_motorMass = iA + iB;\n        if (this.m_motorMass > 0) {\n          this.m_motorMass = 1 / this.m_motorMass;\n        }\n      } else {\n        this.m_motorMass = 0;\n        this.m_motorImpulse = 0;\n      }\n      if (step.warmStarting) {\n        this.m_impulse *= step.dtRatio;\n        this.m_springImpulse *= step.dtRatio;\n        this.m_motorImpulse *= step.dtRatio;\n        var P3 = Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax);\n        var LA = this.m_impulse * this.m_sAy + this.m_springImpulse * this.m_sAx + this.m_motorImpulse;\n        var LB = this.m_impulse * this.m_sBy + this.m_springImpulse * this.m_sBx + this.m_motorImpulse;\n        vA2.subMul(this.m_invMassA, P3);\n        wA -= this.m_invIA * LA;\n        vB2.addMul(this.m_invMassB, P3);\n        wB += this.m_invIB * LB;\n      } else {\n        this.m_impulse = 0;\n        this.m_springImpulse = 0;\n        this.m_motorImpulse = 0;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    WheelJoint2.prototype.solveVelocityConstraints = function(step) {\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      {\n        var Cdot = Vec2.dot(this.m_ax, vB2) - Vec2.dot(this.m_ax, vA2) + this.m_sBx * wB - this.m_sAx * wA;\n        var impulse = -this.m_springMass * (Cdot + this.m_bias + this.m_gamma * this.m_springImpulse);\n        this.m_springImpulse += impulse;\n        var P3 = Vec2.mulNumVec2(impulse, this.m_ax);\n        var LA = impulse * this.m_sAx;\n        var LB = impulse * this.m_sBx;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      }\n      {\n        var Cdot = wB - wA - this.m_motorSpeed;\n        var impulse = -this.m_motorMass * Cdot;\n        var oldImpulse = this.m_motorImpulse;\n        var maxImpulse = step.dt * this.m_maxMotorTorque;\n        this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);\n        impulse = this.m_motorImpulse - oldImpulse;\n        wA -= iA * impulse;\n        wB += iB * impulse;\n      }\n      {\n        var Cdot = Vec2.dot(this.m_ay, vB2) - Vec2.dot(this.m_ay, vA2) + this.m_sBy * wB - this.m_sAy * wA;\n        var impulse = -this.m_mass * Cdot;\n        this.m_impulse += impulse;\n        var P3 = Vec2.mulNumVec2(impulse, this.m_ay);\n        var LA = impulse * this.m_sAy;\n        var LB = impulse * this.m_sBy;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    WheelJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var d2 = Vec2.zero();\n      d2.addCombine(1, cB2, 1, rB2);\n      d2.subCombine(1, cA2, 1, rA2);\n      var ay = Rot.mulVec2(qA, this.m_localYAxisA);\n      var sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), ay);\n      var sBy = Vec2.crossVec2Vec2(rB2, ay);\n      var C = Vec2.dot(d2, ay);\n      var k = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_sAy * this.m_sAy + this.m_invIB * this.m_sBy * this.m_sBy;\n      var impulse = k != 0 ? -C / k : 0;\n      var P3 = Vec2.mulNumVec2(impulse, ay);\n      var LA = impulse * sAy;\n      var LB = impulse * sBy;\n      cA2.subMul(this.m_invMassA, P3);\n      aA -= this.m_invIA * LA;\n      cB2.addMul(this.m_invMassB, P3);\n      aB += this.m_invIB * LB;\n      this.m_bodyA.c_position.c.setVec2(cA2);\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c.setVec2(cB2);\n      this.m_bodyB.c_position.a = aB;\n      return math_abs(C) <= SettingsInternal.linearSlop;\n    };\n    WheelJoint2.TYPE = \"wheel-joint\";\n    return WheelJoint2;\n  }(Joint)\n);\nvar _a;\nvar SID = 0;\nvar SERIALIZE_REF_TYPES = {\n  \"World\": World,\n  \"Body\": Body,\n  \"Joint\": Joint,\n  \"Fixture\": Fixture,\n  \"Shape\": Shape\n};\nvar DESERIALIZE_BY_REF_TYPE = {\n  \"Vec2\": Vec2,\n  \"Vec3\": Vec3,\n  \"World\": World,\n  \"Body\": Body,\n  \"Joint\": Joint,\n  \"Fixture\": Fixture,\n  \"Shape\": Shape\n};\nvar DESERIALIZE_BY_TYPE_FIELD = (_a = {}, _a[Body.STATIC] = Body, _a[Body.DYNAMIC] = Body, _a[Body.KINEMATIC] = Body, _a[ChainShape.TYPE] = ChainShape, // [BoxShape.TYPE]: BoxShape,\n_a[PolygonShape.TYPE] = PolygonShape, _a[EdgeShape.TYPE] = EdgeShape, _a[CircleShape.TYPE] = CircleShape, _a[DistanceJoint.TYPE] = DistanceJoint, _a[FrictionJoint.TYPE] = FrictionJoint, _a[GearJoint.TYPE] = GearJoint, _a[MotorJoint.TYPE] = MotorJoint, _a[MouseJoint.TYPE] = MouseJoint, _a[PrismaticJoint.TYPE] = PrismaticJoint, _a[PulleyJoint.TYPE] = PulleyJoint, _a[RevoluteJoint.TYPE] = RevoluteJoint, _a[RopeJoint.TYPE] = RopeJoint, _a[WeldJoint.TYPE] = WeldJoint, _a[WheelJoint.TYPE] = WheelJoint, _a);\nvar DEFAULT_OPTIONS = {\n  rootClass: World,\n  preSerialize: function(obj) {\n    return obj;\n  },\n  postSerialize: function(data, obj) {\n    return data;\n  },\n  preDeserialize: function(data) {\n    return data;\n  },\n  postDeserialize: function(obj, data) {\n    return obj;\n  }\n};\nvar Serializer = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function Serializer2(options2) {\n      var _this = this;\n      this.toJson = function(root) {\n        var preSerialize = _this.options.preSerialize;\n        var postSerialize = _this.options.postSerialize;\n        var json = [];\n        var refQueue = [root];\n        var refMemoById = {};\n        function addToRefQueue(value, typeName) {\n          value.__sid = value.__sid || ++SID;\n          if (!refMemoById[value.__sid]) {\n            refQueue.push(value);\n            var index = json.length + refQueue.length;\n            var ref = {\n              refIndex: index,\n              refType: typeName\n            };\n            refMemoById[value.__sid] = ref;\n          }\n          return refMemoById[value.__sid];\n        }\n        function serializeWithHooks(obj2) {\n          obj2 = preSerialize(obj2);\n          var data = obj2._serialize();\n          data = postSerialize(data, obj2);\n          return data;\n        }\n        function traverse(value, noRefType) {\n          if (noRefType === void 0) {\n            noRefType = false;\n          }\n          if (typeof value !== \"object\" || value === null) {\n            return value;\n          }\n          if (typeof value._serialize === \"function\") {\n            if (!noRefType) {\n              for (var typeName in SERIALIZE_REF_TYPES) {\n                if (value instanceof SERIALIZE_REF_TYPES[typeName]) {\n                  return addToRefQueue(value, typeName);\n                }\n              }\n            }\n            value = serializeWithHooks(value);\n          }\n          if (Array.isArray(value)) {\n            var newValue = [];\n            for (var key = 0; key < value.length; key++) {\n              newValue[key] = traverse(value[key]);\n            }\n            value = newValue;\n          } else {\n            var newValue = {};\n            for (var key in value) {\n              if (value.hasOwnProperty(key)) {\n                newValue[key] = traverse(value[key]);\n              }\n            }\n            value = newValue;\n          }\n          return value;\n        }\n        while (refQueue.length) {\n          var obj = refQueue.shift();\n          var str = traverse(obj, true);\n          json.push(str);\n        }\n        return json;\n      };\n      this.fromJson = function(json) {\n        var preDeserialize = _this.options.preDeserialize;\n        var postDeserialize = _this.options.postDeserialize;\n        var rootClass = _this.options.rootClass;\n        var deserializedRefMemoByIndex = {};\n        function deserializeWithHooks(classHint, data, context) {\n          if (!classHint || !classHint._deserialize) {\n            classHint = DESERIALIZE_BY_TYPE_FIELD[data.type];\n          }\n          var deserializer = classHint && classHint._deserialize;\n          if (!deserializer) {\n            return;\n          }\n          data = preDeserialize(data);\n          var classDeserializeFn = classHint._deserialize;\n          var obj = classDeserializeFn(data, context, deserializeChild);\n          obj = postDeserialize(obj, data);\n          return obj;\n        }\n        function deserializeChild(classHint, dataOrRef, context) {\n          var isRefObject = dataOrRef.refIndex && dataOrRef.refType;\n          if (!isRefObject) {\n            return deserializeWithHooks(classHint, dataOrRef, context);\n          }\n          var ref = dataOrRef;\n          if (DESERIALIZE_BY_REF_TYPE[ref.refType]) {\n            classHint = DESERIALIZE_BY_REF_TYPE[ref.refType];\n          }\n          var refIndex = ref.refIndex;\n          if (!deserializedRefMemoByIndex[refIndex]) {\n            var data = json[refIndex];\n            var obj = deserializeWithHooks(classHint, data, context);\n            deserializedRefMemoByIndex[refIndex] = obj;\n          }\n          return deserializedRefMemoByIndex[refIndex];\n        }\n        var root = deserializeWithHooks(rootClass, json[0], null);\n        return root;\n      };\n      this.options = __assign(__assign({}, DEFAULT_OPTIONS), options2);\n    }\n    return Serializer2;\n  }()\n);\nvar worldSerializer = new Serializer({\n  rootClass: World\n});\nSerializer.fromJson = worldSerializer.fromJson;\nSerializer.toJson = worldSerializer.toJson;\nvar Testbed = (\n  /** @class */\n  function() {\n    function Testbed2() {\n    }\n    Testbed2.mount = function(options2) {\n      throw new Error(\"Not implemented\");\n    };\n    Testbed2.start = function(world) {\n      var testbed2 = Testbed2.mount();\n      testbed2.start(world);\n      return testbed2;\n    };\n    return Testbed2;\n  }()\n);\nfunction testbed(a2, b2) {\n  var callback;\n  var options2;\n  if (typeof a2 === \"function\") {\n    callback = a2;\n    options2 = b2;\n  } else if (typeof b2 === \"function\") {\n    callback = b2;\n    options2 = a2;\n  } else {\n    options2 = a2 !== null && a2 !== void 0 ? a2 : b2;\n  }\n  var testbed2 = Testbed.mount(options2);\n  if (callback) {\n    var world = callback(testbed2) || testbed2.world;\n    testbed2.start(world);\n  } else {\n    return testbed2;\n  }\n}\nvar BoxShape = (\n  /** @class */\n  function(_super) {\n    __extends(BoxShape2, _super);\n    function BoxShape2(halfWidth, halfHeight, center2, angle) {\n      var _this = this;\n      if (!(_this instanceof BoxShape2)) {\n        return new BoxShape2(halfWidth, halfHeight, center2, angle);\n      }\n      _this = _super.call(this) || this;\n      _this._setAsBox(halfWidth, halfHeight, center2, angle);\n      return _this;\n    }\n    BoxShape2.TYPE = \"polygon\";\n    return BoxShape2;\n  }(PolygonShape)\n);\nContact.addType(CircleShape.TYPE, CircleShape.TYPE, CircleCircleContact);\nfunction CircleCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {\n  CollideCircles(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);\n}\nvar pA = vec2(0, 0);\nvar pB = vec2(0, 0);\nvar CollideCircles = function(manifold, circleA, xfA2, circleB, xfB2) {\n  manifold.pointCount = 0;\n  transformVec2(pA, xfA2, circleA.m_p);\n  transformVec2(pB, xfB2, circleB.m_p);\n  var distSqr = distSqrVec2(pB, pA);\n  var rA2 = circleA.m_radius;\n  var rB2 = circleB.m_radius;\n  var radius = rA2 + rB2;\n  if (distSqr > radius * radius) {\n    return;\n  }\n  manifold.type = ManifoldType.e_circles;\n  copyVec2(manifold.localPoint, circleA.m_p);\n  zeroVec2(manifold.localNormal);\n  manifold.pointCount = 1;\n  copyVec2(manifold.points[0].localPoint, circleB.m_p);\n  manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n};\nContact.addType(EdgeShape.TYPE, CircleShape.TYPE, EdgeCircleContact);\nContact.addType(ChainShape.TYPE, CircleShape.TYPE, ChainCircleContact);\nfunction EdgeCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {\n  var shapeA = fixtureA.getShape();\n  var shapeB = fixtureB.getShape();\n  CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);\n}\nfunction ChainCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {\n  var chain = fixtureA.getShape();\n  var edge = new EdgeShape();\n  chain.getChildEdge(edge, indexA);\n  var shapeA = edge;\n  var shapeB = fixtureB.getShape();\n  CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);\n}\nvar e = vec2(0, 0);\nvar e1 = vec2(0, 0);\nvar e2 = vec2(0, 0);\nvar Q = vec2(0, 0);\nvar P = vec2(0, 0);\nvar n$2 = vec2(0, 0);\nvar CollideEdgeCircle = function(manifold, edgeA, xfA2, circleB, xfB2) {\n  manifold.pointCount = 0;\n  retransformVec2(Q, xfB2, xfA2, circleB.m_p);\n  var A = edgeA.m_vertex1;\n  var B = edgeA.m_vertex2;\n  subVec2(e, B, A);\n  var u = dotVec2(e, B) - dotVec2(e, Q);\n  var v3 = dotVec2(e, Q) - dotVec2(e, A);\n  var radius = edgeA.m_radius + circleB.m_radius;\n  if (v3 <= 0) {\n    copyVec2(P, A);\n    var dd_1 = distSqrVec2(Q, A);\n    if (dd_1 > radius * radius) {\n      return;\n    }\n    if (edgeA.m_hasVertex0) {\n      var A1 = edgeA.m_vertex0;\n      var B1 = A;\n      subVec2(e1, B1, A1);\n      var u1 = dotVec2(e1, B1) - dotVec2(e1, Q);\n      if (u1 > 0) {\n        return;\n      }\n    }\n    manifold.type = ManifoldType.e_circles;\n    zeroVec2(manifold.localNormal);\n    copyVec2(manifold.localPoint, P);\n    manifold.pointCount = 1;\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n    return;\n  }\n  if (u <= 0) {\n    copyVec2(P, B);\n    var dd_2 = distSqrVec2(Q, P);\n    if (dd_2 > radius * radius) {\n      return;\n    }\n    if (edgeA.m_hasVertex3) {\n      var B2 = edgeA.m_vertex3;\n      var A2 = B;\n      subVec2(e2, B2, A2);\n      var v22 = dotVec2(e2, Q) - dotVec2(e2, A2);\n      if (v22 > 0) {\n        return;\n      }\n    }\n    manifold.type = ManifoldType.e_circles;\n    zeroVec2(manifold.localNormal);\n    copyVec2(manifold.localPoint, P);\n    manifold.pointCount = 1;\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(1, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n    return;\n  }\n  var den = lengthSqrVec2(e);\n  combine2Vec2(P, u / den, A, v3 / den, B);\n  var dd = distSqrVec2(Q, P);\n  if (dd > radius * radius) {\n    return;\n  }\n  crossNumVec2(n$2, 1, e);\n  if (dotVec2(n$2, Q) - dotVec2(n$2, A) < 0) {\n    negVec2(n$2);\n  }\n  normalizeVec2(n$2);\n  manifold.type = ManifoldType.e_faceA;\n  copyVec2(manifold.localNormal, n$2);\n  copyVec2(manifold.localPoint, A);\n  manifold.pointCount = 1;\n  copyVec2(manifold.points[0].localPoint, circleB.m_p);\n  manifold.points[0].id.setFeatures(0, ContactFeatureType.e_face, 0, ContactFeatureType.e_vertex);\n};\nvar incidentEdge = [new ClipVertex(), new ClipVertex()];\nvar clipPoints1$1 = [new ClipVertex(), new ClipVertex()];\nvar clipPoints2$1 = [new ClipVertex(), new ClipVertex()];\nvar clipSegmentToLineNormal = vec2(0, 0);\nvar v1 = vec2(0, 0);\nvar n$1 = vec2(0, 0);\nvar xf$1 = transform(0, 0, 0);\nvar v11 = vec2(0, 0);\nvar v12 = vec2(0, 0);\nvar localTangent = vec2(0, 0);\nvar localNormal = vec2(0, 0);\nvar planePoint = vec2(0, 0);\nvar tangent = vec2(0, 0);\nvar normal$1 = vec2(0, 0);\nvar normal1$1 = vec2(0, 0);\nContact.addType(PolygonShape.TYPE, PolygonShape.TYPE, PolygonContact);\nfunction PolygonContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {\n  CollidePolygons(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);\n}\nfunction findMaxSeparation(poly1, xf1, poly2, xf2, output2) {\n  var count1 = poly1.m_count;\n  var count2 = poly2.m_count;\n  var n1s = poly1.m_normals;\n  var v1s = poly1.m_vertices;\n  var v2s = poly2.m_vertices;\n  detransformTransform(xf$1, xf2, xf1);\n  var bestIndex = 0;\n  var maxSeparation2 = -Infinity;\n  for (var i = 0; i < count1; ++i) {\n    rotVec2(n$1, xf$1.q, n1s[i]);\n    transformVec2(v1, xf$1, v1s[i]);\n    var si = Infinity;\n    for (var j = 0; j < count2; ++j) {\n      var sij = dotVec2(n$1, v2s[j]) - dotVec2(n$1, v1);\n      if (sij < si) {\n        si = sij;\n      }\n    }\n    if (si > maxSeparation2) {\n      maxSeparation2 = si;\n      bestIndex = i;\n    }\n  }\n  output2.maxSeparation = maxSeparation2;\n  output2.bestIndex = bestIndex;\n}\nfunction findIncidentEdge(clipVertex, poly1, xf1, edge12, poly2, xf2) {\n  var normals1 = poly1.m_normals;\n  var count2 = poly2.m_count;\n  var vertices2 = poly2.m_vertices;\n  var normals2 = poly2.m_normals;\n  rerotVec2(normal1$1, xf2.q, xf1.q, normals1[edge12]);\n  var index = 0;\n  var minDot = Infinity;\n  for (var i = 0; i < count2; ++i) {\n    var dot = dotVec2(normal1$1, normals2[i]);\n    if (dot < minDot) {\n      minDot = dot;\n      index = i;\n    }\n  }\n  var i1 = index;\n  var i2 = i1 + 1 < count2 ? i1 + 1 : 0;\n  transformVec2(clipVertex[0].v, xf2, vertices2[i1]);\n  clipVertex[0].id.setFeatures(edge12, ContactFeatureType.e_face, i1, ContactFeatureType.e_vertex);\n  transformVec2(clipVertex[1].v, xf2, vertices2[i2]);\n  clipVertex[1].id.setFeatures(edge12, ContactFeatureType.e_face, i2, ContactFeatureType.e_vertex);\n}\nvar maxSeparation = {\n  maxSeparation: 0,\n  bestIndex: 0\n};\nvar CollidePolygons = function(manifold, polyA, xfA2, polyB, xfB2) {\n  manifold.pointCount = 0;\n  var totalRadius = polyA.m_radius + polyB.m_radius;\n  findMaxSeparation(polyA, xfA2, polyB, xfB2, maxSeparation);\n  var edgeA = maxSeparation.bestIndex;\n  var separationA = maxSeparation.maxSeparation;\n  if (separationA > totalRadius)\n    return;\n  findMaxSeparation(polyB, xfB2, polyA, xfA2, maxSeparation);\n  var edgeB = maxSeparation.bestIndex;\n  var separationB = maxSeparation.maxSeparation;\n  if (separationB > totalRadius)\n    return;\n  var poly1;\n  var poly2;\n  var xf1;\n  var xf2;\n  var edge12;\n  var flip;\n  var k_tol = 0.1 * SettingsInternal.linearSlop;\n  if (separationB > separationA + k_tol) {\n    poly1 = polyB;\n    poly2 = polyA;\n    xf1 = xfB2;\n    xf2 = xfA2;\n    edge12 = edgeB;\n    manifold.type = ManifoldType.e_faceB;\n    flip = true;\n  } else {\n    poly1 = polyA;\n    poly2 = polyB;\n    xf1 = xfA2;\n    xf2 = xfB2;\n    edge12 = edgeA;\n    manifold.type = ManifoldType.e_faceA;\n    flip = false;\n  }\n  incidentEdge[0].recycle();\n  incidentEdge[1].recycle();\n  findIncidentEdge(incidentEdge, poly1, xf1, edge12, poly2, xf2);\n  var count1 = poly1.m_count;\n  var vertices1 = poly1.m_vertices;\n  var iv1 = edge12;\n  var iv2 = edge12 + 1 < count1 ? edge12 + 1 : 0;\n  copyVec2(v11, vertices1[iv1]);\n  copyVec2(v12, vertices1[iv2]);\n  subVec2(localTangent, v12, v11);\n  normalizeVec2(localTangent);\n  crossVec2Num(localNormal, localTangent, 1);\n  combine2Vec2(planePoint, 0.5, v11, 0.5, v12);\n  rotVec2(tangent, xf1.q, localTangent);\n  crossVec2Num(normal$1, tangent, 1);\n  transformVec2(v11, xf1, v11);\n  transformVec2(v12, xf1, v12);\n  var frontOffset = dotVec2(normal$1, v11);\n  var sideOffset1 = -dotVec2(tangent, v11) + totalRadius;\n  var sideOffset2 = dotVec2(tangent, v12) + totalRadius;\n  clipPoints1$1[0].recycle();\n  clipPoints1$1[1].recycle();\n  clipPoints2$1[0].recycle();\n  clipPoints2$1[1].recycle();\n  setVec2(clipSegmentToLineNormal, -tangent.x, -tangent.y);\n  var np1 = clipSegmentToLine(clipPoints1$1, incidentEdge, clipSegmentToLineNormal, sideOffset1, iv1);\n  if (np1 < 2) {\n    return;\n  }\n  setVec2(clipSegmentToLineNormal, tangent.x, tangent.y);\n  var np2 = clipSegmentToLine(clipPoints2$1, clipPoints1$1, clipSegmentToLineNormal, sideOffset2, iv2);\n  if (np2 < 2) {\n    return;\n  }\n  copyVec2(manifold.localNormal, localNormal);\n  copyVec2(manifold.localPoint, planePoint);\n  var pointCount = 0;\n  for (var i = 0; i < clipPoints2$1.length; ++i) {\n    var separation = dotVec2(normal$1, clipPoints2$1[i].v) - frontOffset;\n    if (separation <= totalRadius) {\n      var cp = manifold.points[pointCount];\n      detransformVec2(cp.localPoint, xf2, clipPoints2$1[i].v);\n      cp.id.set(clipPoints2$1[i].id);\n      if (flip) {\n        cp.id.swapFeatures();\n      }\n      ++pointCount;\n    }\n  }\n  manifold.pointCount = pointCount;\n};\nContact.addType(PolygonShape.TYPE, CircleShape.TYPE, PolygonCircleContact);\nfunction PolygonCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {\n  CollidePolygonCircle(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);\n}\nvar cLocal = vec2(0, 0);\nvar faceCenter = vec2(0, 0);\nvar CollidePolygonCircle = function(manifold, polygonA, xfA2, circleB, xfB2) {\n  manifold.pointCount = 0;\n  retransformVec2(cLocal, xfB2, xfA2, circleB.m_p);\n  var normalIndex = 0;\n  var separation = -Infinity;\n  var radius = polygonA.m_radius + circleB.m_radius;\n  var vertexCount = polygonA.m_count;\n  var vertices = polygonA.m_vertices;\n  var normals = polygonA.m_normals;\n  for (var i = 0; i < vertexCount; ++i) {\n    var s2 = dotVec2(normals[i], cLocal) - dotVec2(normals[i], vertices[i]);\n    if (s2 > radius) {\n      return;\n    }\n    if (s2 > separation) {\n      separation = s2;\n      normalIndex = i;\n    }\n  }\n  var vertIndex1 = normalIndex;\n  var vertIndex2 = vertIndex1 + 1 < vertexCount ? vertIndex1 + 1 : 0;\n  var v13 = vertices[vertIndex1];\n  var v22 = vertices[vertIndex2];\n  if (separation < EPSILON) {\n    manifold.pointCount = 1;\n    manifold.type = ManifoldType.e_faceA;\n    copyVec2(manifold.localNormal, normals[normalIndex]);\n    combine2Vec2(manifold.localPoint, 0.5, v13, 0.5, v22);\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n    return;\n  }\n  var u1 = dotVec2(cLocal, v22) - dotVec2(cLocal, v13) - dotVec2(v13, v22) + dotVec2(v13, v13);\n  var u2 = dotVec2(cLocal, v13) - dotVec2(cLocal, v22) - dotVec2(v22, v13) + dotVec2(v22, v22);\n  if (u1 <= 0) {\n    if (distSqrVec2(cLocal, v13) > radius * radius) {\n      return;\n    }\n    manifold.pointCount = 1;\n    manifold.type = ManifoldType.e_faceA;\n    subVec2(manifold.localNormal, cLocal, v13);\n    normalizeVec2(manifold.localNormal);\n    copyVec2(manifold.localPoint, v13);\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n  } else if (u2 <= 0) {\n    if (distSqrVec2(cLocal, v22) > radius * radius) {\n      return;\n    }\n    manifold.pointCount = 1;\n    manifold.type = ManifoldType.e_faceA;\n    subVec2(manifold.localNormal, cLocal, v22);\n    normalizeVec2(manifold.localNormal);\n    copyVec2(manifold.localPoint, v22);\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n  } else {\n    combine2Vec2(faceCenter, 0.5, v13, 0.5, v22);\n    var separation_1 = dotVec2(cLocal, normals[vertIndex1]) - dotVec2(faceCenter, normals[vertIndex1]);\n    if (separation_1 > radius) {\n      return;\n    }\n    manifold.pointCount = 1;\n    manifold.type = ManifoldType.e_faceA;\n    copyVec2(manifold.localNormal, normals[vertIndex1]);\n    copyVec2(manifold.localPoint, faceCenter);\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n  }\n};\nvar math_min = Math.min;\nContact.addType(EdgeShape.TYPE, PolygonShape.TYPE, EdgePolygonContact);\nContact.addType(ChainShape.TYPE, PolygonShape.TYPE, ChainPolygonContact);\nfunction EdgePolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {\n  CollideEdgePolygon(manifold, fA.getShape(), xfA2, fB.getShape(), xfB2);\n}\nvar edge_reuse = new EdgeShape();\nfunction ChainPolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {\n  var chain = fA.getShape();\n  chain.getChildEdge(edge_reuse, indexA);\n  CollideEdgePolygon(manifold, edge_reuse, xfA2, fB.getShape(), xfB2);\n}\nvar EPAxisType;\n(function(EPAxisType2) {\n  EPAxisType2[EPAxisType2[\"e_unknown\"] = -1] = \"e_unknown\";\n  EPAxisType2[EPAxisType2[\"e_edgeA\"] = 1] = \"e_edgeA\";\n  EPAxisType2[EPAxisType2[\"e_edgeB\"] = 2] = \"e_edgeB\";\n})(EPAxisType || (EPAxisType = {}));\nvar VertexType;\n(function(VertexType2) {\n  VertexType2[VertexType2[\"e_isolated\"] = 0] = \"e_isolated\";\n  VertexType2[VertexType2[\"e_concave\"] = 1] = \"e_concave\";\n  VertexType2[VertexType2[\"e_convex\"] = 2] = \"e_convex\";\n})(VertexType || (VertexType = {}));\nvar EPAxis = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function EPAxis2() {\n    }\n    return EPAxis2;\n  }()\n);\nvar TempPolygon = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function TempPolygon2() {\n      this.vertices = [];\n      this.normals = [];\n      this.count = 0;\n      for (var i = 0; i < SettingsInternal.maxPolygonVertices; i++) {\n        this.vertices.push(vec2(0, 0));\n        this.normals.push(vec2(0, 0));\n      }\n    }\n    return TempPolygon2;\n  }()\n);\nvar ReferenceFace = (\n  /** @class */\n  function() {\n    function ReferenceFace2() {\n      this.v1 = vec2(0, 0);\n      this.v2 = vec2(0, 0);\n      this.normal = vec2(0, 0);\n      this.sideNormal1 = vec2(0, 0);\n      this.sideNormal2 = vec2(0, 0);\n    }\n    ReferenceFace2.prototype.recycle = function() {\n      zeroVec2(this.v1);\n      zeroVec2(this.v2);\n      zeroVec2(this.normal);\n      zeroVec2(this.sideNormal1);\n      zeroVec2(this.sideNormal2);\n    };\n    return ReferenceFace2;\n  }()\n);\nvar clipPoints1 = [new ClipVertex(), new ClipVertex()];\nvar clipPoints2 = [new ClipVertex(), new ClipVertex()];\nvar ie = [new ClipVertex(), new ClipVertex()];\nvar edgeAxis = new EPAxis();\nvar polygonAxis = new EPAxis();\nvar polygonBA = new TempPolygon();\nvar rf = new ReferenceFace();\nvar centroidB = vec2(0, 0);\nvar edge0 = vec2(0, 0);\nvar edge1 = vec2(0, 0);\nvar edge2 = vec2(0, 0);\nvar xf = transform(0, 0, 0);\nvar normal = vec2(0, 0);\nvar normal0 = vec2(0, 0);\nvar normal1 = vec2(0, 0);\nvar normal2 = vec2(0, 0);\nvar lowerLimit = vec2(0, 0);\nvar upperLimit = vec2(0, 0);\nvar perp = vec2(0, 0);\nvar n = vec2(0, 0);\nvar CollideEdgePolygon = function(manifold, edgeA, xfA2, polygonB, xfB2) {\n  detransformTransform(xf, xfA2, xfB2);\n  transformVec2(centroidB, xf, polygonB.m_centroid);\n  var v0 = edgeA.m_vertex0;\n  var v13 = edgeA.m_vertex1;\n  var v22 = edgeA.m_vertex2;\n  var v3 = edgeA.m_vertex3;\n  var hasVertex0 = edgeA.m_hasVertex0;\n  var hasVertex3 = edgeA.m_hasVertex3;\n  subVec2(edge1, v22, v13);\n  normalizeVec2(edge1);\n  setVec2(normal1, edge1.y, -edge1.x);\n  var offset1 = dotVec2(normal1, centroidB) - dotVec2(normal1, v13);\n  var offset0 = 0;\n  var offset2 = 0;\n  var convex1 = false;\n  var convex2 = false;\n  zeroVec2(normal0);\n  zeroVec2(normal2);\n  if (hasVertex0) {\n    subVec2(edge0, v13, v0);\n    normalizeVec2(edge0);\n    setVec2(normal0, edge0.y, -edge0.x);\n    convex1 = crossVec2Vec2(edge0, edge1) >= 0;\n    offset0 = Vec2.dot(normal0, centroidB) - Vec2.dot(normal0, v0);\n  }\n  if (hasVertex3) {\n    subVec2(edge2, v3, v22);\n    normalizeVec2(edge2);\n    setVec2(normal2, edge2.y, -edge2.x);\n    convex2 = Vec2.crossVec2Vec2(edge1, edge2) > 0;\n    offset2 = Vec2.dot(normal2, centroidB) - Vec2.dot(normal2, v22);\n  }\n  var front;\n  zeroVec2(normal);\n  zeroVec2(lowerLimit);\n  zeroVec2(upperLimit);\n  if (hasVertex0 && hasVertex3) {\n    if (convex1 && convex2) {\n      front = offset0 >= 0 || offset1 >= 0 || offset2 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal0);\n        copyVec2(upperLimit, normal2);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal1);\n        scaleVec2(upperLimit, -1, normal1);\n      }\n    } else if (convex1) {\n      front = offset0 >= 0 || offset1 >= 0 && offset2 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal0);\n        copyVec2(upperLimit, normal1);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal2);\n        scaleVec2(upperLimit, -1, normal1);\n      }\n    } else if (convex2) {\n      front = offset2 >= 0 || offset0 >= 0 && offset1 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal1);\n        copyVec2(upperLimit, normal2);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal1);\n        scaleVec2(upperLimit, -1, normal0);\n      }\n    } else {\n      front = offset0 >= 0 && offset1 >= 0 && offset2 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal1);\n        copyVec2(upperLimit, normal1);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal2);\n        scaleVec2(upperLimit, -1, normal0);\n      }\n    }\n  } else if (hasVertex0) {\n    if (convex1) {\n      front = offset0 >= 0 || offset1 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal0);\n        scaleVec2(upperLimit, -1, normal1);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        copyVec2(lowerLimit, normal1);\n        scaleVec2(upperLimit, -1, normal1);\n      }\n    } else {\n      front = offset0 >= 0 && offset1 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal1);\n        scaleVec2(upperLimit, -1, normal1);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        copyVec2(lowerLimit, normal1);\n        scaleVec2(upperLimit, -1, normal0);\n      }\n    }\n  } else if (hasVertex3) {\n    if (convex2) {\n      front = offset1 >= 0 || offset2 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        scaleVec2(lowerLimit, -1, normal1);\n        copyVec2(upperLimit, normal2);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal1);\n        copyVec2(upperLimit, normal1);\n      }\n    } else {\n      front = offset1 >= 0 && offset2 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        scaleVec2(lowerLimit, -1, normal1);\n        copyVec2(upperLimit, normal1);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal2);\n        copyVec2(upperLimit, normal1);\n      }\n    }\n  } else {\n    front = offset1 >= 0;\n    if (front) {\n      copyVec2(normal, normal1);\n      scaleVec2(lowerLimit, -1, normal1);\n      scaleVec2(upperLimit, -1, normal1);\n    } else {\n      scaleVec2(normal, -1, normal1);\n      copyVec2(lowerLimit, normal1);\n      copyVec2(upperLimit, normal1);\n    }\n  }\n  polygonBA.count = polygonB.m_count;\n  for (var i = 0; i < polygonB.m_count; ++i) {\n    transformVec2(polygonBA.vertices[i], xf, polygonB.m_vertices[i]);\n    rotVec2(polygonBA.normals[i], xf.q, polygonB.m_normals[i]);\n  }\n  var radius = polygonB.m_radius + edgeA.m_radius;\n  manifold.pointCount = 0;\n  {\n    edgeAxis.type = EPAxisType.e_edgeA;\n    edgeAxis.index = front ? 0 : 1;\n    edgeAxis.separation = Infinity;\n    for (var i = 0; i < polygonBA.count; ++i) {\n      var v4 = polygonBA.vertices[i];\n      var s2 = dotVec2(normal, v4) - dotVec2(normal, v13);\n      if (s2 < edgeAxis.separation) {\n        edgeAxis.separation = s2;\n      }\n    }\n  }\n  if (edgeAxis.type == EPAxisType.e_unknown) {\n    return;\n  }\n  if (edgeAxis.separation > radius) {\n    return;\n  }\n  {\n    polygonAxis.type = EPAxisType.e_unknown;\n    polygonAxis.index = -1;\n    polygonAxis.separation = -Infinity;\n    setVec2(perp, -normal.y, normal.x);\n    for (var i = 0; i < polygonBA.count; ++i) {\n      scaleVec2(n, -1, polygonBA.normals[i]);\n      var s1 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v13);\n      var s22 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v22);\n      var s2 = math_min(s1, s22);\n      if (s2 > radius) {\n        polygonAxis.type = EPAxisType.e_edgeB;\n        polygonAxis.index = i;\n        polygonAxis.separation = s2;\n        break;\n      }\n      if (dotVec2(n, perp) >= 0) {\n        if (dotVec2(n, normal) - dotVec2(upperLimit, normal) < -SettingsInternal.angularSlop) {\n          continue;\n        }\n      } else {\n        if (dotVec2(n, normal) - dotVec2(lowerLimit, normal) < -SettingsInternal.angularSlop) {\n          continue;\n        }\n      }\n      if (s2 > polygonAxis.separation) {\n        polygonAxis.type = EPAxisType.e_edgeB;\n        polygonAxis.index = i;\n        polygonAxis.separation = s2;\n      }\n    }\n  }\n  if (polygonAxis.type != EPAxisType.e_unknown && polygonAxis.separation > radius) {\n    return;\n  }\n  var k_relativeTol = 0.98;\n  var k_absoluteTol = 1e-3;\n  var primaryAxis;\n  if (polygonAxis.type == EPAxisType.e_unknown) {\n    primaryAxis = edgeAxis;\n  } else if (polygonAxis.separation > k_relativeTol * edgeAxis.separation + k_absoluteTol) {\n    primaryAxis = polygonAxis;\n  } else {\n    primaryAxis = edgeAxis;\n  }\n  ie[0].recycle();\n  ie[1].recycle();\n  if (primaryAxis.type == EPAxisType.e_edgeA) {\n    manifold.type = ManifoldType.e_faceA;\n    var bestIndex = 0;\n    var bestValue = dotVec2(normal, polygonBA.normals[0]);\n    for (var i = 1; i < polygonBA.count; ++i) {\n      var value = dotVec2(normal, polygonBA.normals[i]);\n      if (value < bestValue) {\n        bestValue = value;\n        bestIndex = i;\n      }\n    }\n    var i1 = bestIndex;\n    var i2 = i1 + 1 < polygonBA.count ? i1 + 1 : 0;\n    copyVec2(ie[0].v, polygonBA.vertices[i1]);\n    ie[0].id.setFeatures(0, ContactFeatureType.e_face, i1, ContactFeatureType.e_vertex);\n    copyVec2(ie[1].v, polygonBA.vertices[i2]);\n    ie[1].id.setFeatures(0, ContactFeatureType.e_face, i2, ContactFeatureType.e_vertex);\n    if (front) {\n      rf.i1 = 0;\n      rf.i2 = 1;\n      copyVec2(rf.v1, v13);\n      copyVec2(rf.v2, v22);\n      copyVec2(rf.normal, normal1);\n    } else {\n      rf.i1 = 1;\n      rf.i2 = 0;\n      copyVec2(rf.v1, v22);\n      copyVec2(rf.v2, v13);\n      scaleVec2(rf.normal, -1, normal1);\n    }\n  } else {\n    manifold.type = ManifoldType.e_faceB;\n    copyVec2(ie[0].v, v13);\n    ie[0].id.setFeatures(0, ContactFeatureType.e_vertex, primaryAxis.index, ContactFeatureType.e_face);\n    copyVec2(ie[1].v, v22);\n    ie[1].id.setFeatures(0, ContactFeatureType.e_vertex, primaryAxis.index, ContactFeatureType.e_face);\n    rf.i1 = primaryAxis.index;\n    rf.i2 = rf.i1 + 1 < polygonBA.count ? rf.i1 + 1 : 0;\n    copyVec2(rf.v1, polygonBA.vertices[rf.i1]);\n    copyVec2(rf.v2, polygonBA.vertices[rf.i2]);\n    copyVec2(rf.normal, polygonBA.normals[rf.i1]);\n  }\n  setVec2(rf.sideNormal1, rf.normal.y, -rf.normal.x);\n  setVec2(rf.sideNormal2, -rf.sideNormal1.x, -rf.sideNormal1.y);\n  rf.sideOffset1 = dotVec2(rf.sideNormal1, rf.v1);\n  rf.sideOffset2 = dotVec2(rf.sideNormal2, rf.v2);\n  clipPoints1[0].recycle();\n  clipPoints1[1].recycle();\n  clipPoints2[0].recycle();\n  clipPoints2[1].recycle();\n  var np1 = clipSegmentToLine(clipPoints1, ie, rf.sideNormal1, rf.sideOffset1, rf.i1);\n  if (np1 < SettingsInternal.maxManifoldPoints) {\n    return;\n  }\n  var np2 = clipSegmentToLine(clipPoints2, clipPoints1, rf.sideNormal2, rf.sideOffset2, rf.i2);\n  if (np2 < SettingsInternal.maxManifoldPoints) {\n    return;\n  }\n  if (primaryAxis.type == EPAxisType.e_edgeA) {\n    copyVec2(manifold.localNormal, rf.normal);\n    copyVec2(manifold.localPoint, rf.v1);\n  } else {\n    copyVec2(manifold.localNormal, polygonB.m_normals[rf.i1]);\n    copyVec2(manifold.localPoint, polygonB.m_vertices[rf.i1]);\n  }\n  var pointCount = 0;\n  for (var i = 0; i < SettingsInternal.maxManifoldPoints; ++i) {\n    var separation = dotVec2(rf.normal, clipPoints2[i].v) - dotVec2(rf.normal, rf.v1);\n    if (separation <= radius) {\n      var cp = manifold.points[pointCount];\n      if (primaryAxis.type == EPAxisType.e_edgeA) {\n        detransformVec2(cp.localPoint, xf, clipPoints2[i].v);\n        cp.id.set(clipPoints2[i].id);\n      } else {\n        copyVec2(cp.localPoint, clipPoints2[i].v);\n        cp.id.set(clipPoints2[i].id);\n        cp.id.swapFeatures();\n      }\n      ++pointCount;\n    }\n  }\n  manifold.pointCount = pointCount;\n};\nvar internal = {\n  CollidePolygons,\n  Settings,\n  Sweep,\n  Manifold,\n  Distance,\n  TimeOfImpact,\n  DynamicTree,\n  stats\n};\nvar DataDriver = (\n  /** @class */\n  function() {\n    function DataDriver2(key, listener) {\n      this._refMap = {};\n      this._map = {};\n      this._xmap = {};\n      this._data = [];\n      this._entered = [];\n      this._exited = [];\n      this._key = key;\n      this._listener = listener;\n    }\n    DataDriver2.prototype.update = function(data) {\n      if (!Array.isArray(data))\n        throw \"Invalid data: \" + data;\n      this._entered.length = 0;\n      this._exited.length = 0;\n      this._data.length = data.length;\n      for (var i = 0; i < data.length; i++) {\n        if (typeof data[i] !== \"object\" || data[i] === null)\n          continue;\n        var d2 = data[i];\n        var id = this._key(d2);\n        if (!this._map[id]) {\n          this._entered.push(d2);\n        } else {\n          delete this._map[id];\n        }\n        this._data[i] = d2;\n        this._xmap[id] = d2;\n      }\n      for (var id in this._map) {\n        this._exited.push(this._map[id]);\n        delete this._map[id];\n      }\n      var temp3 = this._map;\n      this._map = this._xmap;\n      this._xmap = temp3;\n      for (var i = 0; i < this._exited.length; i++) {\n        var d2 = this._exited[i];\n        var key = this._key(d2);\n        var ref = this._refMap[key];\n        this._listener.exit(d2, ref);\n        delete this._refMap[key];\n      }\n      for (var i = 0; i < this._entered.length; i++) {\n        var d2 = this._entered[i];\n        var key = this._key(d2);\n        var ref = this._listener.enter(d2);\n        if (ref) {\n          this._refMap[key] = ref;\n        }\n      }\n      for (var i = 0; i < this._data.length; i++) {\n        if (typeof data[i] !== \"object\" || data[i] === null)\n          continue;\n        var d2 = this._data[i];\n        var key = this._key(d2);\n        var ref = this._refMap[key];\n        this._listener.update(d2, ref);\n      }\n      this._entered.length = 0;\n      this._exited.length = 0;\n      this._data.length = 0;\n    };\n    DataDriver2.prototype.ref = function(d2) {\n      return this._refMap[this._key(d2)];\n    };\n    return DataDriver2;\n  }()\n);\nconst planck = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({\n  __proto__: null,\n  AABB,\n  Body,\n  Box: BoxShape,\n  BoxShape,\n  BroadPhase,\n  Chain: ChainShape,\n  ChainShape,\n  Circle: CircleShape,\n  CircleShape,\n  ClipVertex,\n  CollideCircles,\n  CollideEdgeCircle,\n  CollideEdgePolygon,\n  CollidePolygonCircle,\n  CollidePolygons,\n  Contact,\n  ContactEdge,\n  get ContactFeatureType() {\n    return ContactFeatureType;\n  },\n  ContactID,\n  ContactImpulse,\n  DataDriver,\n  Distance,\n  DistanceInput,\n  DistanceJoint,\n  DistanceOutput,\n  DistanceProxy,\n  DynamicTree,\n  Edge: EdgeShape,\n  EdgeShape,\n  Fixture,\n  FixtureProxy,\n  FrictionJoint,\n  GearJoint,\n  Joint,\n  JointEdge,\n  Manifold,\n  ManifoldPoint,\n  get ManifoldType() {\n    return ManifoldType;\n  },\n  Mat22,\n  Mat33,\n  Math: math,\n  MotorJoint,\n  MouseJoint,\n  get PointState() {\n    return PointState;\n  },\n  Polygon: PolygonShape,\n  PolygonShape,\n  PrismaticJoint,\n  PulleyJoint,\n  RevoluteJoint,\n  RopeJoint,\n  Rot,\n  Serializer,\n  Settings,\n  SettingsInternal,\n  Shape,\n  ShapeCast,\n  ShapeCastInput,\n  ShapeCastOutput,\n  SimplexCache,\n  Solver,\n  Sweep,\n  TOIInput,\n  TOIOutput,\n  get TOIOutputState() {\n    return TOIOutputState;\n  },\n  Testbed,\n  TimeOfImpact,\n  TimeStep,\n  Transform,\n  TreeNode,\n  Vec2,\n  Vec3,\n  VelocityConstraintPoint,\n  WeldJoint,\n  WheelJoint,\n  World,\n  WorldManifold,\n  clipSegmentToLine,\n  getPointStates,\n  internal,\n  mixFriction,\n  mixRestitution,\n  stats,\n  testOverlap,\n  testbed\n}, Symbol.toStringTag, { value: \"Module\" }));\nexport {\n  AABB,\n  Body,\n  BoxShape as Box,\n  BoxShape,\n  BroadPhase,\n  ChainShape as Chain,\n  ChainShape,\n  CircleShape as Circle,\n  CircleShape,\n  ClipVertex,\n  CollideCircles,\n  CollideEdgeCircle,\n  CollideEdgePolygon,\n  CollidePolygonCircle,\n  CollidePolygons,\n  Contact,\n  ContactEdge,\n  ContactFeatureType,\n  ContactID,\n  ContactImpulse,\n  DataDriver,\n  Distance,\n  DistanceInput,\n  DistanceJoint,\n  DistanceOutput,\n  DistanceProxy,\n  DynamicTree,\n  EdgeShape as Edge,\n  EdgeShape,\n  Fixture,\n  FixtureProxy,\n  FrictionJoint,\n  GearJoint,\n  Joint,\n  JointEdge,\n  Manifold,\n  ManifoldPoint,\n  ManifoldType,\n  Mat22,\n  Mat33,\n  math as Math,\n  MotorJoint,\n  MouseJoint,\n  PointState,\n  PolygonShape as Polygon,\n  PolygonShape,\n  PrismaticJoint,\n  PulleyJoint,\n  RevoluteJoint,\n  RopeJoint,\n  Rot,\n  Serializer,\n  Settings,\n  SettingsInternal,\n  Shape,\n  ShapeCast,\n  ShapeCastInput,\n  ShapeCastOutput,\n  SimplexCache,\n  Solver,\n  Sweep,\n  TOIInput,\n  TOIOutput,\n  TOIOutputState,\n  Testbed,\n  TimeOfImpact,\n  TimeStep,\n  Transform,\n  TreeNode,\n  Vec2,\n  Vec3,\n  VelocityConstraintPoint,\n  WeldJoint,\n  WheelJoint,\n  World,\n  WorldManifold,\n  clipSegmentToLine,\n  planck as default,\n  getPointStates,\n  internal,\n  mixFriction,\n  mixRestitution,\n  stats,\n  testOverlap,\n  testbed\n};\n//# sourceMappingURL=planck.mjs.map\n","import * as PIXI from 'pixi.js';\nimport * as planck from 'planck';\nimport type { CollisionTag, CollisionEvent } from './physics-types';\nimport type { PhysicsWorld } from './physics-world';\n\n/**\n * Collision category registry - converts tags to bit masks\n * Auto-registers tags as they're used (no configuration needed)\n *\n * Modern tag-based collision system (converted to bit masks internally for Planck.js)\n *\n * Instead of old-school bit masks, we use strings for better DX:\n * - collisionTags: ['player'] instead of bitmask 0x0002\n * - collidesWith: ['terrain', 'enemy'] instead of mask operations\n *\n * This is converted to bit masks under the hood for Planck.js efficiency.\n */\nexport class CollisionRegistry {\n  private tagToBit: Map<CollisionTag, number> = new Map();\n  private bitToTag: Map<number, CollisionTag> = new Map();\n  private nextBit: number = 1;\n\n  constructor() {\n    // Pre-register 'default' tag\n    this.register('default');\n  }\n\n  /**\n   * Register a collision tag (called automatically when needed)\n   */\n  register(tag: CollisionTag): void {\n    if (this.tagToBit.has(tag)) return;\n\n    if (this.nextBit > 0x8000) {\n      throw new Error('Maximum collision tags reached (16 tags)');\n    }\n\n    this.tagToBit.set(tag, this.nextBit);\n    this.bitToTag.set(this.nextBit, tag);\n    this.nextBit <<= 1;\n  }\n\n  /**\n   * Get bit value for a tag (auto-registers if new)\n   */\n  getBit(tag: CollisionTag): number {\n    if (!this.tagToBit.has(tag)) {\n      this.register(tag);\n    }\n    return this.tagToBit.get(tag)!;\n  }\n\n  /**\n   * Get tag from bit value\n   */\n  getTag(bit: number): CollisionTag | undefined {\n    return this.bitToTag.get(bit);\n  }\n\n  /**\n   * Convert array of tags to bit mask\n   */\n  tagsToBits(tags: CollisionTag[]): number {\n    if (!tags || tags.length === 0) {\n      return this.getBit('default');\n    }\n    return tags.reduce((bits, tag) => bits | this.getBit(tag), 0);\n  }\n\n  /**\n   * Convert bit mask to array of tags\n   */\n  bitsToTags(bits: number): CollisionTag[] {\n    const tags: CollisionTag[] = [];\n    for (const [bit, tag] of this.bitToTag) {\n      if (bits & bit) {\n        tags.push(tag);\n      }\n    }\n    return tags;\n  }\n}\n\n/**\n * Interface for physics body user data\n */\ninterface PhysicsBodyUserData {\n  options: {\n    collisionTags?: CollisionTag[];\n  };\n  onCollisionBegin?: (other: PhysicsBodyUserData, contact: planck.Contact) => void;\n  onCollisionEnd?: (other: PhysicsBodyUserData, contact: planck.Contact) => void;\n}\n\n/**\n * Type guard to check if user data is valid physics body data\n */\nfunction isPhysicsBodyUserData(obj: unknown): obj is PhysicsBodyUserData {\n  return (\n    obj !== null &&\n    typeof obj === 'object' &&\n    'options' in obj &&\n    typeof (obj as any).options === 'object'\n  );\n}\n\n/**\n * Collision manager - handles callbacks\n */\nexport class CollisionManager {\n  private world: PhysicsWorld;\n  private registry: CollisionRegistry;\n  private callbacks: Map<string, Set<(event: CollisionEvent) => void>> = new Map();\n\n  constructor(world: PhysicsWorld, registry: CollisionRegistry) {\n    this.world = world;\n    this.registry = registry;\n    this.setupListeners();\n  }\n\n  private setupListeners(): void {\n    this.world.world.on('begin-contact', (contact: planck.Contact) => {\n      this.handleBeginContact(contact);\n    });\n\n    this.world.world.on('end-contact', (contact: planck.Contact) => {\n      this.handleEndContact(contact);\n    });\n  }\n\n  /**\n   * Register collision callback between two tag categories\n   *\n   * @example\n   * collisionManager.onCollision('player', 'enemy', (event) => {\n   *   console.log('Player hit enemy!');\n   * });\n   */\n  onCollision(\n    tagA: CollisionTag,\n    tagB: CollisionTag,\n    callback: (event: CollisionEvent) => void\n  ): void {\n    const key = this.makeKey(tagA, tagB);\n    if (!this.callbacks.has(key)) {\n      this.callbacks.set(key, new Set());\n    }\n    this.callbacks.get(key)!.add(callback);\n  }\n\n  /**\n   * Remove collision callback\n   */\n  offCollision(\n    tagA: CollisionTag,\n    tagB: CollisionTag,\n    callback: (event: CollisionEvent) => void\n  ): void {\n    const key = this.makeKey(tagA, tagB);\n    this.callbacks.get(key)?.delete(callback);\n  }\n\n  private makeKey(tagA: CollisionTag, tagB: CollisionTag): string {\n    // Sort tags to ensure consistent key regardless of order\n    return tagA < tagB ? `${tagA}:${tagB}` : `${tagB}:${tagA}`;\n  }\n\n  // Trigger callbacks\n  private handleBeginContact(contact: planck.Contact): void {\n    const bodyA = contact.getFixtureA().getBody().getUserData();\n    const bodyB = contact.getFixtureB().getBody().getUserData();\n\n    if (!isPhysicsBodyUserData(bodyA) || !isPhysicsBodyUserData(bodyB)) return;\n\n    // Call entity-level callbacks\n    bodyA.onCollisionBegin?.(bodyB, contact);\n    bodyB.onCollisionBegin?.(bodyA, contact);\n\n    // Call global tag-based callbacks\n    this.triggerTagCallbacks(bodyA, bodyB, contact);\n  }\n\n  private handleEndContact(contact: planck.Contact): void {\n    const bodyA = contact.getFixtureA().getBody().getUserData();\n    const bodyB = contact.getFixtureB().getBody().getUserData();\n\n    if (!isPhysicsBodyUserData(bodyA) || !isPhysicsBodyUserData(bodyB)) return;\n\n    bodyA.onCollisionEnd?.(bodyB, contact);\n    bodyB.onCollisionEnd?.(bodyA, contact);\n  }\n\n  private triggerTagCallbacks(\n    bodyA: PhysicsBodyUserData,\n    bodyB: PhysicsBodyUserData,\n    contact: planck.Contact\n  ): void {\n    // Get tags from both bodies\n    const tagsA = bodyA.options.collisionTags || [];\n    const tagsB = bodyB.options.collisionTags || [];\n\n    // Check all tag combinations\n    for (const tagA of tagsA) {\n      for (const tagB of tagsB) {\n        const key = this.makeKey(tagA, tagB);\n        const callbacks = this.callbacks.get(key);\n\n        if (callbacks) {\n          const event: CollisionEvent = {\n            bodyA,\n            bodyB,\n            contact,\n            normal: new PIXI.Point(0, 0), // TODO: Extract from contact\n            impulse: 0 // TODO: Extract from contact\n          };\n\n          callbacks.forEach(cb => cb(event));\n        }\n      }\n    }\n  }\n}\n","import * as PIXI from 'pixi.js';\nimport * as planck from 'planck';\nimport { Logic } from '../../core/logic';\nimport type { PhysicsWorld } from './physics-world';\nimport type { PhysicsDebugOptions } from './physics-types';\n\n/**\n * PhysicsDebugRenderer - Visualizes collision shapes, velocity vectors, and physics state\n *\n * @example\n * ```typescript\n * const debugRenderer = physicsWorld.enableDebugRenderer(scene);\n *\n * // Toggle with keyboard\n * document.addEventListener('keydown', (e) => {\n *   if (e.key === 'p') debugRenderer.toggle();\n * });\n * ```\n */\nexport class PhysicsDebugRenderer extends Logic<PIXI.Graphics> {\n  name = 'PhysicsDebugRenderer';\n\n  private world: PhysicsWorld;\n  private graphics!: PIXI.Graphics;\n  private options: Required<PhysicsDebugOptions>;\n  private isVisible: boolean = true;\n\n  constructor(world: PhysicsWorld, options: PhysicsDebugOptions = {}) {\n    super();\n    this.world = world;\n    this.options = {\n      showShapes: options.showShapes ?? true,\n      showVelocities: options.showVelocities ?? false,\n      showAABBs: options.showAABBs ?? false,\n      showCenterOfMass: options.showCenterOfMass ?? false,\n      showContactPoints: options.showContactPoints ?? false,\n      showJoints: options.showJoints ?? false,\n      colorStatic: options.colorStatic ?? 0x00FF00,\n      colorDynamic: options.colorDynamic ?? 0xFF0000,\n      colorKinematic: options.colorKinematic ?? 0x0000FF,\n      colorSleeping: options.colorSleeping ?? 0xAAAAAA,\n      colorSensor: options.colorSensor ?? 0xFFFF00,\n      alpha: options.alpha ?? 0.5,\n      lineWidth: options.lineWidth ?? 2\n    };\n  }\n\n  init(entity: PIXI.Graphics, renderer?: PIXI.Renderer): void {\n    this.graphics = entity;\n  }\n\n  update(entity: PIXI.Graphics, deltaTime?: number): void {\n    if (!this.isVisible) {\n      this.graphics.clear();\n      return;\n    }\n\n    this.graphics.clear();\n\n    if (this.options.showShapes) {\n      // Iterate all bodies in physics world\n      for (let body = this.world.world.getBodyList(); body; body = body.getNext()) {\n        this.drawBody(body);\n      }\n    }\n\n    if (this.options.showContactPoints) {\n      this.drawContacts();\n    }\n  }\n\n  private drawBody(body: planck.Body): void {\n    const transform = body.getTransform();\n\n    // Determine color based on body type and state\n    let color: number;\n\n    if (!body.isAwake() && body.isDynamic()) {\n      color = this.options.colorSleeping;\n    } else if (body.isStatic()) {\n      color = this.options.colorStatic;\n    } else if (body.isKinematic()) {\n      color = this.options.colorKinematic;\n    } else {\n      color = this.options.colorDynamic;\n    }\n\n    // Draw each fixture\n    for (let fixture = body.getFixtureList(); fixture; fixture = fixture.getNext()) {\n      const shape = fixture.getShape();\n\n      // Use yellow semi-transparent for sensors\n      const fixtureColor = fixture.isSensor() ? this.options.colorSensor : color;\n      const alpha = fixture.isSensor() ? this.options.alpha * 0.5 : this.options.alpha;\n\n      this.drawShape(shape, transform, fixtureColor, alpha);\n    }\n\n    // Draw velocity vector if enabled\n    if (this.options.showVelocities && body.isDynamic()) {\n      this.drawVelocity(body);\n    }\n\n    // Draw AABB if enabled\n    if (this.options.showAABBs) {\n      this.drawAABB(body);\n    }\n\n    // Draw center of mass if enabled\n    if (this.options.showCenterOfMass) {\n      this.drawCenterOfMass(body);\n    }\n  }\n\n  private drawShape(shape: planck.Shape, transform: planck.Transform, color: number, alpha: number): void {\n    this.graphics.stroke({\n      width: this.options.lineWidth,\n      color: color,\n      alpha: alpha\n    });\n\n    const shapeType = shape.getType();\n\n    if (shapeType === 'circle') {\n      const circle = shape as planck.CircleShape;\n      const center = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, circle.getCenter()));\n      const radius = circle.getRadius();\n\n      const pixelCenter = this.world.toPixelsPoint(center);\n      const pixelRadius = this.world.toPixels(radius);\n\n      this.graphics.circle(pixelCenter.x, pixelCenter.y, pixelRadius);\n      this.graphics.stroke();\n\n      // Draw radius line to show rotation\n      const angle = transform.q.getAngle();\n      const endX = pixelCenter.x + Math.cos(angle) * pixelRadius;\n      const endY = pixelCenter.y + Math.sin(angle) * pixelRadius;\n      this.graphics.moveTo(pixelCenter.x, pixelCenter.y);\n      this.graphics.lineTo(endX, endY);\n      this.graphics.stroke();\n    } else if (shapeType === 'polygon') {\n      const poly = shape as planck.PolygonShape;\n      const vertices = poly.m_vertices;\n\n      if (vertices && vertices.length > 0) {\n        // Transform first vertex\n        const firstVertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[0]));\n        const pixelFirst = this.world.toPixelsPoint(firstVertex);\n\n        this.graphics.moveTo(pixelFirst.x, pixelFirst.y);\n\n        // Transform and draw remaining vertices\n        for (let i = 1; i < vertices.length; i++) {\n          const vertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[i]));\n          const pixelVertex = this.world.toPixelsPoint(vertex);\n          this.graphics.lineTo(pixelVertex.x, pixelVertex.y);\n        }\n\n        // Close the polygon\n        this.graphics.lineTo(pixelFirst.x, pixelFirst.y);\n        this.graphics.stroke();\n      }\n    } else if (shapeType === 'edge') {\n      const edge = shape as planck.EdgeShape;\n      const v1 = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, edge.m_vertex1));\n      const v2 = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, edge.m_vertex2));\n\n      const p1 = this.world.toPixelsPoint(v1);\n      const p2 = this.world.toPixelsPoint(v2);\n\n      this.graphics.moveTo(p1.x, p1.y);\n      this.graphics.lineTo(p2.x, p2.y);\n      this.graphics.stroke();\n    } else if (shapeType === 'chain') {\n      const chain = shape as planck.ChainShape;\n      const vertices = chain.m_vertices;\n\n      if (vertices && vertices.length > 0) {\n        const firstVertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[0]));\n        const pixelFirst = this.world.toPixelsPoint(firstVertex);\n        this.graphics.moveTo(pixelFirst.x, pixelFirst.y);\n\n        for (let i = 1; i < vertices.length; i++) {\n          const vertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[i]));\n          const pixelVertex = this.world.toPixelsPoint(vertex);\n          this.graphics.lineTo(pixelVertex.x, pixelVertex.y);\n        }\n\n        this.graphics.stroke();\n      }\n    }\n  }\n\n  private drawVelocity(body: planck.Body): void {\n    const position = body.getPosition();\n    const velocity = body.getLinearVelocity();\n\n    // Scale velocity for visibility\n    const scale = 0.5;\n    const endPoint = planck.Vec2.add(position, planck.Vec2.mul(velocity, scale));\n\n    const pixelStart = this.world.toPixelsPoint(position);\n    const pixelEnd = this.world.toPixelsPoint(endPoint);\n\n    this.graphics.stroke({\n      width: 2,\n      color: 0x00FFFF,\n      alpha: 0.8\n    });\n\n    this.graphics.moveTo(pixelStart.x, pixelStart.y);\n    this.graphics.lineTo(pixelEnd.x, pixelEnd.y);\n    this.graphics.stroke();\n\n    // Draw arrow head\n    const angle = Math.atan2(pixelEnd.y - pixelStart.y, pixelEnd.x - pixelStart.x);\n    const arrowSize = 5;\n    const angle1 = angle + Math.PI * 0.8;\n    const angle2 = angle - Math.PI * 0.8;\n\n    this.graphics.moveTo(pixelEnd.x, pixelEnd.y);\n    this.graphics.lineTo(\n      pixelEnd.x + Math.cos(angle1) * arrowSize,\n      pixelEnd.y + Math.sin(angle1) * arrowSize\n    );\n    this.graphics.moveTo(pixelEnd.x, pixelEnd.y);\n    this.graphics.lineTo(\n      pixelEnd.x + Math.cos(angle2) * arrowSize,\n      pixelEnd.y + Math.sin(angle2) * arrowSize\n    );\n    this.graphics.stroke();\n  }\n\n  private drawAABB(body: planck.Body): void {\n    for (let fixture = body.getFixtureList(); fixture; fixture = fixture.getNext()) {\n      const aabb = fixture.getAABB(0);\n\n      const lowerBound = this.world.toPixelsPoint(aabb.lowerBound);\n      const upperBound = this.world.toPixelsPoint(aabb.upperBound);\n\n      this.graphics.stroke({\n        width: 1,\n        color: 0xFF00FF,\n        alpha: 0.3\n      });\n\n      this.graphics.rect(\n        lowerBound.x,\n        lowerBound.y,\n        upperBound.x - lowerBound.x,\n        upperBound.y - lowerBound.y\n      );\n      this.graphics.stroke();\n    }\n  }\n\n  private drawCenterOfMass(body: planck.Body): void {\n    const position = body.getWorldCenter();\n    const pixelPos = this.world.toPixelsPoint(position);\n\n    this.graphics.stroke({\n      width: 1,\n      color: 0xFFFFFF,\n      alpha: 1\n    });\n\n    const size = 5;\n    this.graphics.moveTo(pixelPos.x - size, pixelPos.y);\n    this.graphics.lineTo(pixelPos.x + size, pixelPos.y);\n    this.graphics.moveTo(pixelPos.x, pixelPos.y - size);\n    this.graphics.lineTo(pixelPos.x, pixelPos.y + size);\n    this.graphics.stroke();\n  }\n\n  private drawContacts(): void {\n    // Iterate through all contacts in the world\n    for (let contact = this.world.world.getContactList(); contact; contact = contact.getNext()) {\n      if (!contact.isTouching()) continue;\n\n      const manifold = contact.getManifold();\n      if (!manifold) continue;\n\n      const worldManifold = contact.getWorldManifold(null);\n      if (!worldManifold) continue;\n\n      for (let i = 0; i < manifold.pointCount; i++) {\n        const point = worldManifold.points[i];\n        if (!point) continue;\n        const pixelPoint = this.world.toPixelsPoint(planck.Vec2(point.x, point.y));\n\n        this.graphics.circle(pixelPoint.x, pixelPoint.y, 3);\n        this.graphics.fill({ color: 0xFF0000, alpha: 0.8 });\n      }\n    }\n  }\n\n  /**\n   * Set visibility of debug renderer\n   */\n  setVisible(visible: boolean): void {\n    this.isVisible = visible;\n    if (!visible) {\n      this.graphics.clear();\n    }\n  }\n\n  /**\n   * Toggle debug renderer visibility\n   */\n  toggle(): void {\n    this.setVisible(!this.isVisible);\n  }\n\n  /**\n   * Check if debug renderer is visible\n   */\n  getVisible(): boolean {\n    return this.isVisible;\n  }\n}\n","import * as PIXI from 'pixi.js';\nimport * as planck from 'planck';\nimport type { PhysicsWorld } from './physics-world';\n\nexport interface ParsedShape {\n  type: 'circle' | 'rectangle' | 'polygon';\n  shape: planck.Shape;\n}\n\n/**\n * Shape metadata stored on Graphics for physics parsing\n */\nexport interface PhysicsShapeMetadata {\n  type: 'circle' | 'rectangle' | 'polygon';\n  radius?: number;\n  width?: number;\n  height?: number;\n  vertices?: number[];\n}\n\nconst PHYSICS_SHAPE_KEY = '__physicsShape__';\n\n/**\n * Store shape metadata on Graphics object\n */\nexport function setGraphicsPhysicsShape(graphics: PIXI.Graphics, metadata: PhysicsShapeMetadata): void {\n  (graphics as any)[PHYSICS_SHAPE_KEY] = metadata;\n}\n\n/**\n * Extend PIXI Graphics to automatically track shape data for physics\n * This patches Graphics methods to store metadata for physics collision shapes\n */\nexport function initGraphicsPhysicsTracking(): void {\n  // Save original methods\n  const originalRect = PIXI.Graphics.prototype.rect;\n  const originalCircle = PIXI.Graphics.prototype.circle;\n  const originalPoly = PIXI.Graphics.prototype.poly;\n\n  // Patch rect() to store metadata\n  PIXI.Graphics.prototype.rect = function (x: number, y: number, w: number, h: number) {\n    setGraphicsPhysicsShape(this, {\n      type: 'rectangle',\n      width: w,\n      height: h\n    });\n    return originalRect.call(this, x, y, w, h);\n  };\n\n  // Patch circle() to store metadata\n  PIXI.Graphics.prototype.circle = function (x: number, y: number, radius: number) {\n    setGraphicsPhysicsShape(this, {\n      type: 'circle',\n      radius: radius\n    });\n    return originalCircle.call(this, x, y, radius);\n  };\n\n  // Patch poly() to store metadata\n  PIXI.Graphics.prototype.poly = function (points: PIXI.PointData[] | number[]) {\n    const flatPoints = Array.isArray(points[0]) ? points.flat() : points;\n    setGraphicsPhysicsShape(this, {\n      type: 'polygon',\n      vertices: flatPoints as number[]\n    });\n    return originalPoly.call(this, points as any);\n  };\n}\n\n/**\n * Parse PIXI Graphics geometry to extract collision shape for physics\n *\n * Uses metadata stored by helper functions or falls back to bounds-based rectangle\n */\nexport function parseGraphicsShape(graphics: PIXI.Graphics, world: PhysicsWorld): ParsedShape {\n  // Check if shape metadata was stored\n  const metadata = (graphics as any)[PHYSICS_SHAPE_KEY] as PhysicsShapeMetadata | undefined;\n\n  if (metadata) {\n    // Use stored metadata\n    switch (metadata.type) {\n      case 'circle':\n        if (!metadata.radius) {\n          throw new Error('Circle metadata missing radius');\n        }\n        return {\n          type: 'circle',\n          shape: planck.Circle(world.toPhysics(metadata.radius))\n        };\n\n      case 'rectangle':\n        if (!metadata.width || !metadata.height) {\n          throw new Error('Rectangle metadata missing width/height');\n        }\n        return {\n          type: 'rectangle',\n          shape: planck.Box(\n            world.toPhysics(metadata.width / 2),\n            world.toPhysics(metadata.height / 2)\n          )\n        };\n\n      case 'polygon':\n        if (!metadata.vertices || metadata.vertices.length < 6) {\n          throw new Error('Polygon metadata missing vertices (need at least 3 points = 6 values)');\n        }\n        const vertices: planck.Vec2[] = [];\n        for (let i = 0; i < metadata.vertices.length; i += 2) {\n          vertices.push(\n            planck.Vec2(\n              world.toPhysics(metadata.vertices[i]),\n              world.toPhysics(metadata.vertices[i + 1])\n            )\n          );\n        }\n        return {\n          type: 'polygon',\n          shape: planck.Polygon(vertices)\n        };\n    }\n  }\n\n  // Fallback: Use bounding box as rectangle\n  const bounds = graphics.getLocalBounds();\n\n  if (bounds.width === 0 || bounds.height === 0) {\n    throw new Error(\n      'Graphics has no dimensions. Either draw shapes using rect(), circle(), or poly(), ' +\n      'or provide an explicit collisionShape option.'\n    );\n  }\n\n  return {\n    type: 'rectangle',\n    shape: planck.Box(\n      world.toPhysics(bounds.width / 2),\n      world.toPhysics(bounds.height / 2)\n    )\n  };\n}\n","import * as PIXI from 'pixi.js';\nimport * as planck from 'planck';\nimport type { PhysicsWorldOptions, RaycastCallback, PhysicsDebugOptions } from './physics-types';\nimport { CollisionRegistry, CollisionManager } from './physics-collision';\nimport type { PhysicsBodyLogic } from './physics-body-logic';\nimport { PhysicsDebugRenderer } from './physics-debug-renderer';\nimport { asEntity } from '../../core/moxi-entity';\nimport { initGraphicsPhysicsTracking } from './physics-graphics-parser';\n\n/**\n * PhysicsWorld manages the Planck.js physics simulation and provides\n * integration with MOXI's Scene/Engine.\n *\n * @example\n * ```typescript\n * const physicsWorld = new PhysicsWorld({\n *   gravity: { x: 0, y: 9.8 },\n *   pixelsPerMeter: 30\n * });\n *\n * // Integrate with engine\n * engine.addPhysicsWorld(physicsWorld);\n * ```\n */\nexport class PhysicsWorld {\n  /** The Planck.js world instance */\n  public world: planck.World;\n\n  /** Pixels per meter conversion factor */\n  public pixelsPerMeter: number = 30;\n\n  /** Fixed timestep in seconds */\n  public timestep: number = 1/60;\n\n  /** Collision tag registry */\n  public collisionRegistry: CollisionRegistry;\n\n  /** Collision event manager */\n  public collisionManager: CollisionManager;\n\n  /** Velocity iterations for solver */\n  private velocityIterations: number = 8;\n\n  /** Position iterations for solver */\n  private positionIterations: number = 3;\n\n  /** Time accumulator for fixed timestep */\n  private accumulator: number = 0;\n\n  /** Registry of physics bodies */\n  private bodies: Map<planck.Body, PhysicsBodyLogic> = new Map();\n\n  /** Debug renderer reference */\n  private debugRenderer?: PhysicsDebugRenderer;\n\n  /** Debug graphics container */\n  private debugGraphics?: PIXI.Graphics;\n\n  constructor(options: PhysicsWorldOptions = {}) {\n    // Initialize Graphics physics tracking (patches PIXI.Graphics methods)\n    initGraphicsPhysicsTracking();\n\n    const {\n      gravity = { x: 0, y: 9.8 },\n      pixelsPerMeter = 30,\n      velocityIterations = 8,\n      positionIterations = 3,\n      enableSleeping = true,\n      timestep = 1/60\n    } = options;\n\n    this.pixelsPerMeter = pixelsPerMeter;\n    this.velocityIterations = velocityIterations;\n    this.positionIterations = positionIterations;\n    this.timestep = timestep;\n\n    // Create Planck world\n    this.world = planck.World({\n      gravity: planck.Vec2(gravity.x, gravity.y)\n    });\n\n    // Configure sleeping\n    this.world.setAllowSleeping(enableSleeping);\n\n    // Initialize collision system\n    this.collisionRegistry = new CollisionRegistry();\n    this.collisionManager = new CollisionManager(this, this.collisionRegistry);\n  }\n\n  /**\n   * Step the physics simulation (called by Engine update loop)\n   * Uses fixed timestep for deterministic physics\n   */\n  step(deltaTime: number): void {\n    this.accumulator += deltaTime;\n\n    // Fixed timestep updates\n    while (this.accumulator >= this.timestep) {\n      this.world.step(this.timestep, this.velocityIterations, this.positionIterations);\n      this.accumulator -= this.timestep;\n    }\n\n    // Note: Interpolation for rendering smoothness could be added here\n    // const alpha = this.accumulator / this.timestep;\n  }\n\n  /**\n   * Create a physics body\n   */\n  createBody(def: planck.BodyDef): planck.Body {\n    return this.world.createBody(def);\n  }\n\n  /**\n   * Destroy a physics body\n   */\n  destroyBody(body: planck.Body): void {\n    this.bodies.delete(body);\n    this.world.destroyBody(body);\n  }\n\n  /**\n   * Register a physics body logic component\n   */\n  registerBody(body: planck.Body, logic: PhysicsBodyLogic): void {\n    this.bodies.set(body, logic);\n  }\n\n  /**\n   * Get physics body logic from Planck body\n   */\n  getBodyLogic(body: planck.Body): PhysicsBodyLogic | undefined {\n    return this.bodies.get(body);\n  }\n\n  /**\n   * Raycast from one point to another\n   */\n  raycast(from: PIXI.Point, to: PIXI.Point, callback: RaycastCallback): void {\n    const p1 = this.toPhysicsPoint(from);\n    const p2 = this.toPhysicsPoint(to);\n\n    this.world.rayCast(p1, p2, (fixture, point, normal, fraction) => {\n      const pixelPoint = this.toPixelsPoint(point);\n      const pixelNormal = new PIXI.Point(normal.x, normal.y);\n      return callback(fixture, pixelPoint, pixelNormal, fraction);\n    });\n  }\n\n  /**\n   * Query AABB (axis-aligned bounding box)\n   */\n  queryAABB(bounds: PIXI.Rectangle, callback: (body: planck.Body) => boolean): void {\n    const lowerBound = this.toPhysicsPoint(new PIXI.Point(bounds.x, bounds.y));\n    const upperBound = this.toPhysicsPoint(new PIXI.Point(bounds.x + bounds.width, bounds.y + bounds.height));\n\n    this.world.queryAABB(planck.AABB(lowerBound, upperBound), (fixture) => {\n      return callback(fixture.getBody());\n    });\n  }\n\n  /**\n   * Query point\n   */\n  queryPoint(point: PIXI.Point, callback: (fixture: planck.Fixture) => boolean): void {\n    const physicsPoint = this.toPhysicsPoint(point);\n\n    this.world.queryAABB(\n      planck.AABB(\n        planck.Vec2(physicsPoint.x - 0.001, physicsPoint.y - 0.001),\n        planck.Vec2(physicsPoint.x + 0.001, physicsPoint.y + 0.001)\n      ),\n      (fixture) => {\n        if (fixture.testPoint(physicsPoint)) {\n          return callback(fixture);\n        }\n        return true;\n      }\n    );\n  }\n\n  /**\n   * Convert pixels to meters\n   */\n  toPhysics(pixels: number): number {\n    return pixels / this.pixelsPerMeter;\n  }\n\n  /**\n   * Convert meters to pixels\n   */\n  toPixels(meters: number): number {\n    return meters * this.pixelsPerMeter;\n  }\n\n  /**\n   * Convert PIXI Point (pixels) to Planck Vec2 (meters)\n   */\n  toPhysicsPoint(point: PIXI.Point): planck.Vec2 {\n    return planck.Vec2(this.toPhysics(point.x), this.toPhysics(point.y));\n  }\n\n  /**\n   * Convert Planck Vec2 (meters) to PIXI Point (pixels)\n   */\n  toPixelsPoint(vec: planck.Vec2): PIXI.Point {\n    return new PIXI.Point(this.toPixels(vec.x), this.toPixels(vec.y));\n  }\n\n  /**\n   * Enable debug renderer\n   */\n  enableDebugRenderer(scene: PIXI.Container, options: PhysicsDebugOptions = {}): PhysicsDebugRenderer {\n    // Clean up existing debug renderer if any\n    if (this.debugRenderer) {\n      this.disableDebugRenderer();\n    }\n\n    // Create debug graphics\n    this.debugGraphics = new PIXI.Graphics();\n\n    // Create debug renderer logic\n    this.debugRenderer = new PhysicsDebugRenderer(this, options);\n\n    // Make it an entity and add to scene\n    const debugEntity = asEntity(this.debugGraphics);\n    debugEntity.moxiEntity.addLogic(this.debugRenderer);\n\n    // Set highest z-index so it renders on top of everything\n    debugEntity.zIndex = 10000;\n\n    // Enable sortable children on scene so zIndex works\n    scene.sortableChildren = true;\n\n    // Add to scene at highest z-index so it renders on top\n    scene.addChild(debugEntity);\n\n    console.log('Physics debug renderer enabled. Press \"P\" to toggle visibility.');\n\n    return this.debugRenderer;\n  }\n\n  /**\n   * Disable debug renderer\n   */\n  disableDebugRenderer(): void {\n    if (this.debugRenderer && this.debugGraphics) {\n      // Remove from scene\n      if (this.debugGraphics.parent) {\n        this.debugGraphics.parent.removeChild(this.debugGraphics);\n      }\n\n      // Clean up\n      this.debugGraphics.destroy();\n      this.debugGraphics = undefined;\n      this.debugRenderer = undefined;\n    }\n  }\n\n  /**\n   * Get debug renderer if enabled\n   */\n  getDebugRenderer(): PhysicsDebugRenderer | undefined {\n    return this.debugRenderer;\n  }\n\n  /**\n   * Get all bodies in the world\n   */\n  getBodies(): planck.Body[] {\n    const bodies: planck.Body[] = [];\n    for (let body = this.world.getBodyList(); body; body = body.getNext()) {\n      bodies.push(body);\n    }\n    return bodies;\n  }\n\n  /**\n   * Clean up and destroy the physics world\n   */\n  destroy(): void {\n    // Destroy all bodies\n    const bodies = this.getBodies();\n    bodies.forEach(body => this.world.destroyBody(body));\n\n    this.bodies.clear();\n    this.debugRenderer = undefined;\n  }\n}\n","import PIXI from 'pixi.js';\nimport { Container, Graphics, Text } from 'pixi.js';\n\nexport interface LoadingSceneOptions {\n  backgroundColor?: number;\n  squareSize?: number;\n  numSquares?: number;\n  text?: string;\n  textStyle?: Partial<PIXI.TextStyle>;\n}\n\nconst PALETTE = [0xf0dab1, 0xe39aac, 0xc45d9f, 0x634b7d, 0x6461c2, 0x2ba9b4, 0x93d4b5, 0xf0f6e8];\n\ninterface Particle {\n  sprite: Graphics;\n  spawnTime: number;\n  duration: number;\n  spinRate: number;\n  startX: number;\n  startY: number;\n  endY: number;\n}\n\n/**\n * Default loading scene component for Moxi\n * Displays animated pixel squares falling above loading text\n * \n * @category Library\n */\nexport class LoadingScene extends Container {\n  private particles: Particle[] = [];\n  private text: Text;\n  private background: Graphics;\n  private ticker: PIXI.Ticker;\n  private renderer: PIXI.Renderer | null = null;\n  private time: number = 0;\n  private nextSpawn: number = 0;\n  private maxParticles: number;\n  private baseSize: number;\n  private backgroundColor: number;\n\n  constructor(options: LoadingSceneOptions = {}) {\n    super();\n\n    const {\n      backgroundColor = 0x1a1a1a,\n      squareSize = 20,\n      numSquares = 30,\n      text = 'LOADING...',\n      textStyle = {}\n    } = options;\n\n    this.maxParticles = numSquares;\n    this.baseSize = squareSize;\n    this.backgroundColor = backgroundColor;\n\n    // Background\n    this.background = new Graphics();\n    this.addChild(this.background);\n\n    // Text\n    this.text = new Text({\n      text,\n      style: {\n        fontFamily: 'Courier New, monospace',\n        fontSize: 16,\n        fill: 0xffffff,\n        fontWeight: 'bold',\n        ...textStyle\n      }\n    });\n    this.text.anchor.set(0.5);\n    this.addChild(this.text);\n\n    // Ticker\n    this.ticker = new PIXI.Ticker();\n    this.ticker.autoStart = false;\n    this.ticker.add(() => {\n      if (this.visible && this.renderer) {\n        this.time += this.ticker.deltaTime / 60;\n        this.update(this.renderer.width, this.renderer.height);\n        this.renderer.render(this);\n      }\n    });\n  }\n\n  private spawnParticle(width: number, height: number): void {\n    if (this.particles.length >= this.maxParticles || this.time < this.nextSpawn) return;\n\n    const size = this.baseSize * (0.7 + Math.random() * 0.6);\n    const sprite = new Graphics();\n    sprite.rect(0, 0, size, size);\n    sprite.fill({ color: PALETTE[Math.floor(Math.random() * PALETTE.length)] });\n    sprite.pivot.set(size / 2, size / 2);\n    this.addChild(sprite);\n\n    const textY = height / 2 + 60;\n    const textWidth = this.text.width || 200;\n    const textCenterX = width / 2;\n\n    this.particles.push({\n      sprite,\n      spawnTime: this.time,\n      duration: 1 + Math.random() * 2.5,\n      spinRate: (0.05 + Math.random() * 1.075) * (Math.random() < 0.5 ? 1 : -1),\n      startX: textCenterX - textWidth / 2 + Math.random() * textWidth - 4,\n      startY: textY - 100,\n      endY: textY - 40,\n    });\n\n    this.nextSpawn = this.time + Math.random() * 0.5;\n  }\n\n  private update(width: number, height: number): void {\n    // Background\n    this.background.clear();\n    this.background.rect(0, 0, width, height);\n    this.background.fill({ color: this.backgroundColor });\n\n    // Text position\n    this.text.x = width / 2 - 4;\n    this.text.y = height / 2 + 60;\n\n    // Spawn particles\n    this.spawnParticle(width, height);\n\n    // Update particles\n    this.particles = this.particles.filter(p => {\n      const elapsed = this.time - p.spawnTime;\n      const progress = elapsed / p.duration;\n\n      if (progress < 0 || progress > 1) {\n        p.sprite.destroy();\n        return false;\n      }\n\n      p.sprite.x = p.startX;\n      p.sprite.y = p.startY + (p.endY - p.startY) * progress;\n      p.sprite.rotation = this.time * p.spinRate * Math.PI * 2;\n      p.sprite.alpha = progress < 0.1 ? progress / 0.1 : progress > 0.85 ? (1 - progress) / 0.15 : 1;\n      return true;\n    });\n  }\n\n  init(renderer: PIXI.Renderer): void {\n    this.renderer = renderer;\n  }\n\n  show(): void {\n    this.visible = true;\n    this.time = 0;\n    this.nextSpawn = 0;\n    this.particles.forEach(p => p.sprite.destroy());\n    this.particles = [];\n    if (!this.ticker.started) {\n      this.ticker.start();\n    }\n  }\n\n  hide(): void {\n    this.visible = false;\n    if (this.ticker.started) {\n      this.ticker.stop();\n    }\n  }\n\n  destroy(): void {\n    if (this.ticker.started) {\n      this.ticker.stop();\n    }\n    this.ticker.destroy();\n    this.particles.forEach(p => p.sprite.destroy());\n    super.destroy();\n  }\n}\n","import PIXI from 'pixi.js';\nimport { AssetLoader } from '../core/asset-loader';\nimport { Camera } from '../core/camera';\nimport { Engine } from '../core/engine';\nimport { RenderManager } from '../core/render-manager';\nimport { Scene } from '../core/scene';\nimport { PhysicsWorld, type PhysicsWorldOptions } from './physics';\nimport { LoadingScene, type LoadingSceneOptions } from './loading-scene';\n\nexport interface PixelPerfectOptions {\n  /** Enable all pixel-perfect settings (resolution: 1, antialias: false, roundPixels: true, canvas imageRendering) */\n  enabled?: boolean;\n  /** Apply canvas CSS imageRendering for nearest-neighbor scaling */\n  imageRendering?: boolean;\n}\n\nexport interface SetupMoxiArgs {\n  hostElement: HTMLElement;\n  renderOptions?: Partial<PIXI.AutoDetectOptions>;\n  physics?: PhysicsWorldOptions | boolean;\n  showLoadingScene?: boolean;\n  loadingSceneOptions?: LoadingSceneOptions;\n  /** Pixel-perfect rendering options. Can be true for all defaults, or an object for fine control */\n  pixelPerfect?: boolean | PixelPerfectOptions;\n}\n\nexport interface SetupMoxiResult {\n  scene: Scene;\n  engine: Engine;\n  PIXIAssets: AssetLoader['PIXIAssets'];\n  renderer: PIXI.Renderer;\n  loadAssets: AssetLoader['loadAssets'];\n  camera: Camera;\n  physicsWorld?: PhysicsWorld;\n  loadingScene?: LoadingScene;\n}\n\nexport const defaultRenderOptions = {\n  width: 1280,\n  height: 720,\n  backgroundColor: 0x1099bb,\n  resolution: window.devicePixelRatio || 1,\n  autoDensity: true,\n  antialias: true\n} as Partial<PIXI.AutoDetectOptions>;\n\nexport async function setupMoxi({\n  hostElement,\n  renderOptions = defaultRenderOptions,\n  physics,\n  showLoadingScene = false,\n  loadingSceneOptions = {},\n  pixelPerfect\n} = {} as SetupMoxiArgs) {\n  // Process pixel-perfect options\n  let finalRenderOptions = { ...renderOptions };\n  let applyImageRendering = false;\n\n  if (pixelPerfect) {\n    const ppOptions = typeof pixelPerfect === 'boolean'\n      ? { enabled: true, imageRendering: true }\n      : pixelPerfect;\n\n    if (ppOptions.enabled !== false) {\n      // Apply pixel-perfect render settings\n      finalRenderOptions = {\n        ...finalRenderOptions,\n        resolution: 1,\n        antialias: false,\n        roundPixels: true\n      };\n    }\n\n    applyImageRendering = ppOptions.imageRendering !== false;\n  }\n\n  const { renderer } = await RenderManager.create(hostElement, finalRenderOptions);\n\n  // Apply canvas CSS for pixel-perfect scaling if requested\n  if (applyImageRendering) {\n    const canvas = renderer.canvas as HTMLCanvasElement;\n    canvas.style.imageRendering = 'pixelated';\n    canvas.style.imageRendering = '-moz-crisp-edges';\n    canvas.style.imageRendering = 'crisp-edges';\n  }\n\n  const scene = new Scene(renderer);\n  const engine = new Engine(scene);\n\n  // Get the AssetLoader instance\n  const assetLoader = new AssetLoader();\n  const { PIXIAssets, loadAssets } = assetLoader;\n\n  const camera = new Camera(scene, renderer);\n\n  // Setup physics if requested\n  let physicsWorld: PhysicsWorld | undefined;\n\n  if (physics) {\n    const physicsOptions = typeof physics === 'boolean'\n      ? {}\n      : physics;\n\n    physicsWorld = new PhysicsWorld(physicsOptions);\n    engine.addPhysicsWorld(physicsWorld);\n  }\n\n  // Setup loading scene if requested\n  let loadingScene: LoadingScene | undefined;\n  if (showLoadingScene) {\n    loadingScene = new LoadingScene(loadingSceneOptions);\n    loadingScene.zIndex = 10000; // Ensure it's on top\n    loadingScene.init(renderer);\n    scene.addChild(loadingScene);\n    loadingScene.hide();\n\n    // Hook into asset loading events\n    assetLoader.on('loading:start', () => {\n      if (loadingScene) {\n        loadingScene.show();\n      }\n    });\n\n    assetLoader.on('loading:end', () => {\n      if (loadingScene) {\n        loadingScene.hide();\n      }\n    });\n  }\n\n  return {\n    scene,\n    engine,\n    PIXIAssets,\n    renderer,\n    loadAssets,\n    camera,\n    physicsWorld,\n    loadingScene\n  };\n}\n\n","import { UIComponent } from './ui-component';\n\n/**\n * Interface for focusable UI components\n *\n * @category UI\n */\nexport interface Focusable {\n  /** Whether this component can receive focus */\n  canFocus(): boolean;\n  /** Called when component receives focus */\n  onFocus(): void;\n  /** Called when component loses focus */\n  onBlur(): void;\n  /** The tab index for focus order (lower values focused first) */\n  tabIndex: number;\n  /** Whether this component is currently focused */\n  isFocused(): boolean;\n}\n\n/**\n * Manages keyboard focus and tab navigation for UI components\n *\n * @category UI\n *\n * @example\n * ```typescript\n * const focusManager = new UIFocusManager();\n * focusManager.register(button1);\n * focusManager.register(textInput1);\n * focusManager.register(button2);\n *\n * // Focus first component\n * focusManager.focusFirst();\n *\n * // Or focus specific component\n * focusManager.focus(textInput1);\n * ```\n */\nexport class UIFocusManager {\n  private static instance: UIFocusManager | null = null;\n\n  private focusableComponents: (UIComponent & Focusable)[] = [];\n  private currentFocusIndex: number = -1;\n  private keydownHandler: ((e: KeyboardEvent) => void) | null = null;\n\n  constructor() {\n    this.setupKeyboardListeners();\n    // Set as singleton instance\n    UIFocusManager.instance = this;\n  }\n\n  /**\n   * Gets the current global focus manager instance\n   */\n  static getInstance(): UIFocusManager | null {\n    return UIFocusManager.instance;\n  }\n\n  /**\n   * Sets up global keyboard listeners for tab navigation\n   */\n  private setupKeyboardListeners(): void {\n    if (typeof window === 'undefined') return;\n\n    // Remove existing handler if present to prevent duplicates\n    if (this.keydownHandler) {\n      window.removeEventListener('keydown', this.keydownHandler);\n    }\n\n    this.keydownHandler = (e: KeyboardEvent) => {\n      if (e.key === 'Tab') {\n        e.preventDefault();\n\n        if (e.shiftKey) {\n          this.focusPrevious();\n        } else {\n          this.focusNext();\n        }\n      }\n    };\n\n    window.addEventListener('keydown', this.keydownHandler);\n  }\n\n  /**\n   * Registers a focusable component\n   */\n  register(component: UIComponent & Focusable): void {\n    if (!this.focusableComponents.includes(component)) {\n      this.focusableComponents.push(component);\n      this.sortByTabIndex();\n    }\n  }\n\n  /**\n   * Automatically discovers and registers all focusable components in a container\n   * Walks the component tree and finds all components with tabIndex >= 0\n   */\n  registerContainer(container: UIComponent): void {\n    this.discoverFocusableComponents(container);\n    this.sortByTabIndex();\n  }\n\n  /**\n   * Recursively discovers focusable components in the tree\n   */\n  private discoverFocusableComponents(component: UIComponent): void {\n    // Check if this component is focusable\n    if (this.isFocusableComponent(component)) {\n      this.register(component as UIComponent & Focusable);\n    }\n\n    // Recursively check children (if it's a container type)\n    if ('children' in component && Array.isArray((component as any).children)) {\n      const children = (component as any).children as UIComponent[];\n      children.forEach(child => this.discoverFocusableComponents(child));\n    }\n  }\n\n  /**\n   * Checks if a component implements the Focusable interface\n   */\n  private isFocusableComponent(component: UIComponent): component is UIComponent & Focusable {\n    return (\n      typeof component.tabIndex === 'number' &&\n      component.tabIndex >= 0 &&\n      typeof component.canFocus === 'function' &&\n      typeof component.onFocus === 'function' &&\n      typeof component.onBlur === 'function' &&\n      typeof component.isFocused === 'function'\n    );\n  }\n\n  /**\n   * Unregisters a focusable component\n   */\n  unregister(component: UIComponent & Focusable): void {\n    const index = this.focusableComponents.indexOf(component);\n    if (index !== -1) {\n      if (index === this.currentFocusIndex) {\n        this.blur();\n      }\n      this.focusableComponents.splice(index, 1);\n      if (this.currentFocusIndex > index) {\n        this.currentFocusIndex--;\n      }\n    }\n  }\n\n  /**\n   * Sorts components by tab index\n   */\n  private sortByTabIndex(): void {\n    this.focusableComponents.sort((a, b) => a.tabIndex - b.tabIndex);\n  }\n\n  /**\n   * Focuses a specific component\n   */\n  focus(component: UIComponent & Focusable): void {\n    if (!component.canFocus()) {\n      return;\n    }\n\n    const index = this.focusableComponents.indexOf(component);\n    if (index === -1) {\n      return;\n    }\n\n    // Blur current focus\n    if (this.currentFocusIndex !== -1 && this.currentFocusIndex !== index) {\n      const current = this.focusableComponents[this.currentFocusIndex];\n      if (current) {\n        current.onBlur();\n      }\n    }\n\n    // Focus new component\n    this.currentFocusIndex = index;\n    component.onFocus();\n  }\n\n  /**\n   * Request focus for a component (called by components when clicked)\n   * This is a helper that finds the component and calls focus()\n   */\n  requestFocus(component: UIComponent & Focusable): void {\n    this.focus(component);\n  }\n\n  /**\n   * Blurs the currently focused component\n   */\n  blur(): void {\n    if (this.currentFocusIndex !== -1) {\n      const current = this.focusableComponents[this.currentFocusIndex];\n      if (current) {\n        current.onBlur();\n      }\n      this.currentFocusIndex = -1;\n    }\n  }\n\n  /**\n   * Focuses the next component in tab order\n   */\n  focusNext(): void {\n    if (this.focusableComponents.length === 0) return;\n\n    let nextIndex = this.currentFocusIndex + 1;\n    let attempts = 0;\n\n    // Find next focusable component\n    while (attempts < this.focusableComponents.length) {\n      if (nextIndex >= this.focusableComponents.length) {\n        nextIndex = 0;\n      }\n\n      const component = this.focusableComponents[nextIndex];\n      if (component && component.canFocus()) {\n        this.focus(component);\n        return;\n      }\n\n      nextIndex++;\n      attempts++;\n    }\n  }\n\n  /**\n   * Focuses the previous component in tab order\n   */\n  focusPrevious(): void {\n    if (this.focusableComponents.length === 0) return;\n\n    let prevIndex = this.currentFocusIndex - 1;\n    let attempts = 0;\n\n    // Find previous focusable component\n    while (attempts < this.focusableComponents.length) {\n      if (prevIndex < 0) {\n        prevIndex = this.focusableComponents.length - 1;\n      }\n\n      const component = this.focusableComponents[prevIndex];\n      if (component && component.canFocus()) {\n        this.focus(component);\n        return;\n      }\n\n      prevIndex--;\n      attempts++;\n    }\n  }\n\n  /**\n   * Focuses the first focusable component\n   */\n  focusFirst(): void {\n    if (this.focusableComponents.length === 0) return;\n\n    for (const component of this.focusableComponents) {\n      if (component.canFocus()) {\n        this.focus(component);\n        return;\n      }\n    }\n  }\n\n  /**\n   * Focuses the last focusable component\n   */\n  focusLast(): void {\n    if (this.focusableComponents.length === 0) return;\n\n    for (let i = this.focusableComponents.length - 1; i >= 0; i--) {\n      const component = this.focusableComponents[i];\n      if (component.canFocus()) {\n        this.focus(component);\n        return;\n      }\n    }\n  }\n\n  /**\n   * Gets the currently focused component\n   */\n  getCurrentFocus(): (UIComponent & Focusable) | null {\n    if (this.currentFocusIndex === -1) return null;\n    return this.focusableComponents[this.currentFocusIndex] || null;\n  }\n\n  /**\n   * Gets all registered focusable components\n   */\n  getFocusableComponents(): (UIComponent & Focusable)[] {\n    return [...this.focusableComponents];\n  }\n\n  /**\n   * Clears all registered components\n   */\n  clear(): void {\n    this.blur();\n    this.focusableComponents = [];\n    this.currentFocusIndex = -1;\n  }\n\n  /**\n   * Cleanup when destroying the focus manager\n   */\n  destroy(): void {\n    if (typeof window !== 'undefined' && this.keydownHandler) {\n      window.removeEventListener('keydown', this.keydownHandler);\n    }\n    this.clear();\n  }\n}\n","import PIXI from 'pixi.js';\nimport { UIComponent } from '../core/ui-component';\nimport { BoxModel, MeasuredSize } from '../core/box-model';\nimport { EdgeInsets } from '../core/edge-insets';\n\n/**\n * Flexbox direction (how children are arranged)\n *\n * @category UI\n */\nexport enum FlexDirection {\n  Row = 'row',              // Horizontal, left to right\n  RowReverse = 'row-reverse',\n  Column = 'column',        // Vertical, top to bottom\n  ColumnReverse = 'column-reverse'\n}\n\n/**\n * Flexbox justify content (main axis alignment)\n *\n * @category UI\n */\nexport enum FlexJustify {\n  Start = 'start',          // Pack items to start\n  End = 'end',              // Pack items to end\n  Center = 'center',        // Center items\n  SpaceBetween = 'space-between',  // Space between items\n  SpaceAround = 'space-around',    // Space around items\n  SpaceEvenly = 'space-evenly'     // Even space between items\n}\n\n/**\n * Flexbox align items (cross axis alignment)\n *\n * @category UI\n */\nexport enum FlexAlign {\n  Start = 'start',\n  End = 'end',\n  Center = 'center',\n  Stretch = 'stretch'       // Stretch to fill cross axis\n}\n\n/**\n * Props for configuring a FlexContainer\n *\n * @category UI\n */\nexport interface FlexContainerProps {\n  direction?: FlexDirection;\n  justify?: FlexJustify;\n  align?: FlexAlign;\n  gap?: number;              // Space between children\n  wrap?: boolean;            // Allow wrapping (Phase 2)\n  padding?: EdgeInsets;\n  width?: number | 'fill';\n  height?: number | 'fill';\n}\n\n/**\n * A flexbox-style layout container\n * Arranges children in rows or columns with flexible sizing and alignment\n *\n * @category UI\n *\n * @example\n * ```typescript\n * const container = new FlexContainer({\n *   direction: FlexDirection.Row,\n *   justify: FlexJustify.Center,\n *   gap: 10,\n *   padding: EdgeInsets.all(20)\n * });\n *\n * container.addChild(box1);\n * container.addChild(box2);\n * container.addChild(box3);\n * ```\n */\nexport class FlexContainer extends UIComponent {\n  private props: Required<Omit<FlexContainerProps, 'padding' | 'width' | 'height'>>;\n  public children: UIComponent[] = [];\n\n  constructor(props: FlexContainerProps = {}) {\n    const boxModel: Partial<BoxModel> = {\n      padding: props.padding ?? EdgeInsets.zero(),\n      width: props.width ?? 'auto',\n      height: props.height ?? 'auto'\n    };\n\n    super(boxModel);\n\n    this.props = {\n      direction: props.direction ?? FlexDirection.Row,\n      justify: props.justify ?? FlexJustify.Start,\n      align: props.align ?? FlexAlign.Start,\n      gap: props.gap ?? 0,\n      wrap: props.wrap ?? false\n    };\n  }\n\n  /**\n   * Adds a child component to this container\n   */\n  addChild(child: UIComponent): void {\n    child.parent = this;\n    this.children.push(child);\n    this.container.addChild(child.container);\n    this.markLayoutDirty();\n  }\n\n  /**\n   * Removes a child component from this container\n   */\n  removeChild(child: UIComponent): void {\n    const index = this.children.indexOf(child);\n    if (index !== -1) {\n      this.children.splice(index, 1);\n      this.container.removeChild(child.container);\n      child.parent = undefined;\n      this.markLayoutDirty();\n    }\n  }\n\n  /**\n   * Measures the size needed for this container and its children\n   */\n  measure(): MeasuredSize {\n    if (this.children.length === 0) {\n      const padding = this.boxModel.padding;\n      return {\n        width: padding.horizontal,\n        height: padding.vertical\n      };\n    }\n\n    // Measure all children\n    const childSizes = this.children.map(child => child.measure());\n    const { direction, gap } = this.props;\n    const padding = this.boxModel.padding;\n\n    const isRow = direction === FlexDirection.Row || direction === FlexDirection.RowReverse;\n    const totalGap = gap * (this.children.length - 1);\n\n    let measuredWidth = 0;\n    let measuredHeight = 0;\n\n    if (isRow) {\n      // Row: sum widths, max height\n      measuredWidth = childSizes.reduce((sum, size) => sum + size.width, 0) + totalGap;\n      measuredHeight = Math.max(...childSizes.map(size => size.height));\n    } else {\n      // Column: max width, sum heights\n      measuredWidth = Math.max(...childSizes.map(size => size.width));\n      measuredHeight = childSizes.reduce((sum, size) => sum + size.height, 0) + totalGap;\n    }\n\n    return {\n      width: measuredWidth + padding.horizontal,\n      height: measuredHeight + padding.vertical\n    };\n  }\n\n  /**\n   * Performs layout for this container and positions children\n   */\n  layout(availableWidth: number, availableHeight: number): void {\n    const padding = this.boxModel.padding;\n    const { direction, justify, align, gap } = this.props;\n\n    // Determine container size\n    let containerWidth: number;\n    let containerHeight: number;\n\n    if (this.boxModel.width === 'fill') {\n      containerWidth = availableWidth;\n    } else if (typeof this.boxModel.width === 'number') {\n      containerWidth = this.boxModel.width;\n    } else {\n      const measured = this.measure();\n      containerWidth = measured.width;\n    }\n\n    if (this.boxModel.height === 'fill') {\n      containerHeight = availableHeight;\n    } else if (typeof this.boxModel.height === 'number') {\n      containerHeight = this.boxModel.height;\n    } else {\n      const measured = this.measure();\n      containerHeight = measured.height;\n    }\n\n    // Update computed layout\n    this.computedLayout.width = containerWidth;\n    this.computedLayout.height = containerHeight;\n    this.computedLayout.contentX = padding.left;\n    this.computedLayout.contentY = padding.top;\n    this.computedLayout.contentWidth = containerWidth - padding.horizontal;\n    this.computedLayout.contentHeight = containerHeight - padding.vertical;\n\n    // Layout children\n    if (this.children.length > 0) {\n      this.layoutChildren();\n    }\n\n    this.layoutDirty = false;\n    this.render();\n  }\n\n  /**\n   * Layouts and positions child components\n   */\n  private layoutChildren(): void {\n    const { direction, justify, align, gap } = this.props;\n    const padding = this.boxModel.padding;\n    const contentWidth = this.computedLayout.contentWidth;\n    const contentHeight = this.computedLayout.contentHeight;\n\n    const isRow = direction === FlexDirection.Row || direction === FlexDirection.RowReverse;\n\n    // Measure children\n    const childSizes = this.children.map(child => child.measure());\n\n    // Calculate total main axis size\n    const totalGap = gap * (this.children.length - 1);\n    const totalChildSize = isRow\n      ? childSizes.reduce((sum, size) => sum + size.width, 0)\n      : childSizes.reduce((sum, size) => sum + size.height, 0);\n\n    const mainAxisSize = isRow ? contentWidth : contentHeight;\n    const crossAxisSize = isRow ? contentHeight : contentWidth;\n    const freeSpace = mainAxisSize - totalChildSize - totalGap;\n\n    // Calculate starting position based on justify\n    let mainAxisOffset = 0;\n    let spaceBetween = 0;\n\n    switch (justify) {\n      case FlexJustify.Start:\n        mainAxisOffset = 0;\n        break;\n      case FlexJustify.End:\n        mainAxisOffset = freeSpace;\n        break;\n      case FlexJustify.Center:\n        mainAxisOffset = freeSpace / 2;\n        break;\n      case FlexJustify.SpaceBetween:\n        spaceBetween = this.children.length > 1 ? freeSpace / (this.children.length - 1) : 0;\n        break;\n      case FlexJustify.SpaceAround:\n        spaceBetween = freeSpace / this.children.length;\n        mainAxisOffset = spaceBetween / 2;\n        break;\n      case FlexJustify.SpaceEvenly:\n        spaceBetween = freeSpace / (this.children.length + 1);\n        mainAxisOffset = spaceBetween;\n        break;\n    }\n\n    // Position children\n    let currentPosition = mainAxisOffset;\n\n    this.children.forEach((child, index) => {\n      const childSize = childSizes[index];\n\n      // Layout child\n      child.layout(childSize.width, childSize.height);\n\n      // Calculate cross axis position based on align\n      let crossAxisPosition = 0;\n\n      switch (align) {\n        case FlexAlign.Start:\n          crossAxisPosition = 0;\n          break;\n        case FlexAlign.End:\n          crossAxisPosition = crossAxisSize - (isRow ? childSize.height : childSize.width);\n          break;\n        case FlexAlign.Center:\n          crossAxisPosition = (crossAxisSize - (isRow ? childSize.height : childSize.width)) / 2;\n          break;\n        case FlexAlign.Stretch:\n          // Stretch child to fill cross axis (implement later)\n          crossAxisPosition = 0;\n          break;\n      }\n\n      // Set child position\n      if (isRow) {\n        child.setPosition(\n          padding.left + currentPosition,\n          padding.top + crossAxisPosition\n        );\n        currentPosition += childSize.width + gap + spaceBetween;\n      } else {\n        child.setPosition(\n          padding.left + crossAxisPosition,\n          padding.top + currentPosition\n        );\n        currentPosition += childSize.height + gap + spaceBetween;\n      }\n    });\n  }\n\n  /**\n   * Renders the container (currently no visual representation)\n   */\n  protected render(): void {\n    // FlexContainer itself has no visual representation\n    // Could add debug borders here if needed\n  }\n}\n","import PIXI from 'pixi.js';\nimport { UIComponent } from '../core/ui-component';\nimport { BoxModel, MeasuredSize } from '../core/box-model';\nimport { UILabel } from './ui-label';\nimport { EdgeInsets } from '../core/edge-insets';\nimport { UIFocusManager } from '../core/ui-focus-manager';\nimport {\n  ButtonBackgroundStrategy,\n  SolidColorBackgroundStrategy,\n  SpriteBackgroundStrategy,\n  SpriteBackgroundConfig\n} from './button-background-strategy';\n\n/**\n * Button visual states\n *\n * @category UI\n */\nexport enum ButtonState {\n  Normal = 'normal',\n  Hover = 'hover',\n  Pressed = 'pressed',\n  Disabled = 'disabled'\n}\n\n// Re-export SpriteBackgroundConfig for convenience\nexport type { SpriteBackgroundConfig } from './button-background-strategy';\n\n/**\n * Props for configuring a UIButton\n *\n * @category UI\n */\nexport interface UIButtonProps {\n  /** Button label text */\n  label?: string;\n  /** Button width */\n  width?: number;\n  /** Button height */\n  height?: number;\n  /** Background color (only used if spriteBackground is not provided) */\n  backgroundColor?: number;\n  /** Sprite-based background configuration */\n  spriteBackground?: SpriteBackgroundConfig;\n  /** Text color */\n  textColor?: number;\n  /** Font size */\n  fontSize?: number;\n  /** Border radius (only used with backgroundColor) */\n  borderRadius?: number;\n  /** Padding inside button */\n  padding?: EdgeInsets;\n  /** Use BitmapText instead of regular text */\n  useBitmapText?: boolean;\n  /** BitmapText font family (required if useBitmapText is true) */\n  bitmapFontFamily?: string;\n  /** Click callback */\n  onClick?: () => void;\n  /** Hover callback */\n  onHover?: () => void;\n  /** Enabled state */\n  enabled?: boolean;\n}\n\n/**\n * An interactive button component\n * Supports hover, press, and disabled states\n *\n * @category UI\n *\n * @example\n * ```typescript\n * const button = new UIButton({\n *   label: 'Click Me',\n *   width: 150,\n *   height: 40,\n *   backgroundColor: 0x4a90e2,\n *   textColor: 0xffffff,\n *   onClick: () => console.log('Button clicked!')\n * });\n * ```\n */\nexport class UIButton extends UIComponent {\n  private props: Required<Omit<UIButtonProps, 'onClick' | 'onHover' | 'spriteBackground' | 'useBitmapText' | 'bitmapFontFamily'>>;\n  private useBitmapText: boolean;\n  private bitmapFontFamily?: string;\n  private onClick?: () => void;\n  private onHover?: () => void;\n\n  private state: ButtonState = ButtonState.Normal;\n  private backgroundStrategy: ButtonBackgroundStrategy;\n  private label?: UILabel;\n  private bitmapLabel?: PIXI.BitmapText;\n\n  // Cached label center position\n  private labelCenterX: number = 0;\n  private labelCenterY: number = 0;\n\n  // Keyboard handler for cleanup\n  private keydownHandler?: (e: KeyboardEvent) => void;\n\n  constructor(props: UIButtonProps = {}, boxModel?: Partial<BoxModel>) {\n    super(boxModel);\n\n    this.props = {\n      label: props.label ?? '',\n      width: props.width ?? 120,\n      height: props.height ?? 40,\n      backgroundColor: props.backgroundColor ?? 0x4a90e2,\n      textColor: props.textColor ?? 0xffffff,\n      fontSize: props.fontSize ?? 16,\n      borderRadius: props.borderRadius ?? 4,\n      padding: props.padding ?? EdgeInsets.symmetric(8, 16),\n      enabled: props.enabled ?? true\n    };\n\n    this.useBitmapText = props.useBitmapText ?? false;\n    this.bitmapFontFamily = props.bitmapFontFamily;\n    this.onClick = props.onClick;\n    this.onHover = props.onHover;\n\n    // Set box model dimensions\n    this.boxModel.width = this.props.width;\n    this.boxModel.height = this.props.height;\n\n    // Make buttons focusable by default\n    this.tabIndex = 0;\n\n    // Create background strategy based on configuration\n    if (props.spriteBackground) {\n      this.backgroundStrategy = new SpriteBackgroundStrategy(\n        props.spriteBackground,\n        this.props.width,\n        this.props.height\n      );\n    } else {\n      this.backgroundStrategy = new SolidColorBackgroundStrategy(\n        this.props.backgroundColor,\n        this.props.width,\n        this.props.height,\n        this.props.borderRadius\n      );\n    }\n\n    // Create and add background\n    const backgroundContainer = this.backgroundStrategy.create(this.props.width, this.props.height);\n    this.container.addChild(backgroundContainer);\n\n    // Create label if text provided\n    if (this.props.label) {\n      if (this.useBitmapText && this.bitmapFontFamily) {\n        this.createBitmapLabel();\n      } else {\n        this.label = new UILabel({\n          text: this.props.label,\n          fontSize: this.props.fontSize,\n          color: this.props.textColor,\n          align: 'center'\n        }, {\n          padding: EdgeInsets.zero()\n        });\n        this.container.addChild(this.label.container);\n      }\n    }\n\n    // Setup interactivity\n    this.setupInteractivity();\n\n    // Initial state\n    if (!this.props.enabled) {\n      this.setState(ButtonState.Disabled);\n    }\n  }\n\n  /**\n   * Creates a BitmapText label\n   */\n  private createBitmapLabel(): void {\n    if (!this.bitmapFontFamily) return;\n\n    this.bitmapLabel = new PIXI.BitmapText({\n      text: this.props.label,\n      style: {\n        fontFamily: this.bitmapFontFamily,\n        fontSize: this.props.fontSize,\n        fill: this.props.textColor\n      }\n    });\n\n    this.container.addChild(this.bitmapLabel);\n  }\n\n  /**\n   * Sets up mouse/touch event handlers\n   */\n  private setupInteractivity(): void {\n    this.container.eventMode = 'static';\n    this.container.cursor = 'pointer';\n\n    this.container.on('pointerover', this.handlePointerOver.bind(this));\n    this.container.on('pointerout', this.handlePointerOut.bind(this));\n    this.container.on('pointerdown', this.handlePointerDown.bind(this));\n    this.container.on('pointerup', this.handlePointerUp.bind(this));\n    this.container.on('pointerupoutside', this.handlePointerUpOutside.bind(this));\n\n    // Handle keyboard interaction when focused\n    if (typeof window !== 'undefined') {\n      this.keydownHandler = (e: KeyboardEvent) => {\n        if (this.isFocused() && this.props.enabled) {\n          if (e.key === 'Enter' || e.key === ' ') {\n            e.preventDefault();\n\n            // Show pressed state\n            this.setState(ButtonState.Pressed);\n\n            // Trigger click\n            this.onClick?.();\n\n            // Return to hover state after a short delay (simulating button release)\n            setTimeout(() => {\n              if (this.props.enabled) {\n                this.setState(ButtonState.Normal);\n              }\n            }, 100);\n          }\n        }\n      };\n      window.addEventListener('keydown', this.keydownHandler);\n    }\n  }\n\n  private handlePointerOver(): void {\n    if (this.props.enabled && this.state === ButtonState.Normal) {\n      this.setState(ButtonState.Hover);\n      this.onHover?.();\n    }\n  }\n\n  private handlePointerOut(): void {\n    if (this.props.enabled && this.state !== ButtonState.Pressed) {\n      this.setState(ButtonState.Normal);\n    }\n  }\n\n  private handlePointerDown(): void {\n    if (this.props.enabled) {\n      this.setState(ButtonState.Pressed);\n\n      // Request focus through the focus manager\n      if (this.canFocus()) {\n        const focusManager = UIFocusManager.getInstance();\n        if (focusManager) {\n          focusManager.requestFocus(this);\n        } else {\n          // Fallback if no focus manager\n          this.onFocus();\n        }\n      }\n    }\n  }\n\n  private handlePointerUp(): void {\n    if (this.props.enabled) {\n      this.setState(ButtonState.Hover);\n      this.onClick?.();\n    }\n  }\n\n  private handlePointerUpOutside(): void {\n    if (this.props.enabled) {\n      this.setState(ButtonState.Normal);\n    }\n  }\n\n  /**\n   * Updates the button's visual state\n   */\n  private setState(newState: ButtonState): void {\n    this.state = newState;\n    this.updateVisuals();\n  }\n\n  /**\n   * Updates visuals based on current state\n   */\n  private updateVisuals(): void {\n    // Update background using strategy\n    this.backgroundStrategy.updateState(this.state);\n\n    // Calculate depth offset for pressed state\n    const yOffset = this.state === ButtonState.Pressed ? 2 : 0;\n\n    // Update cursor for disabled state\n    if (this.state === ButtonState.Disabled) {\n      this.container.cursor = 'default';\n    } else {\n      this.container.cursor = 'pointer';\n    }\n\n    // Apply depth offset to label\n    if (this.label) {\n      this.label.setPosition(this.labelCenterX, this.labelCenterY + yOffset);\n    } else if (this.bitmapLabel) {\n      this.bitmapLabel.x = this.labelCenterX;\n      this.bitmapLabel.y = this.labelCenterY + yOffset;\n    }\n  }\n\n  /**\n   * Measures the size needed for this button\n   */\n  measure(): MeasuredSize {\n    return {\n      width: this.props.width,\n      height: this.props.height\n    };\n  }\n\n  /**\n   * Performs layout for this button\n   */\n  layout(availableWidth: number, availableHeight: number): void {\n    const measured = this.measure();\n\n    this.computedLayout.width = measured.width;\n    this.computedLayout.height = measured.height;\n\n    // Get actual background height from strategy\n    const actualHeight = this.backgroundStrategy.getActualHeight();\n\n    // Layout and center label\n    if (this.label) {\n      this.label.layout(measured.width, measured.height);\n\n      // Center the label and cache the position\n      const labelLayout = this.label.getLayout();\n      this.labelCenterX = (measured.width - labelLayout.width) / 2;\n      this.labelCenterY = (actualHeight - labelLayout.height) / 2;\n      this.label.setPosition(this.labelCenterX, this.labelCenterY);\n    } else if (this.bitmapLabel) {\n      // Center the bitmap text using actual background height\n      this.labelCenterX = (measured.width - this.bitmapLabel.width) / 2;\n      this.labelCenterY = (actualHeight - this.bitmapLabel.height) / 2;\n      this.bitmapLabel.x = this.labelCenterX;\n      this.bitmapLabel.y = this.labelCenterY;\n    }\n\n    this.layoutDirty = false;\n    this.render();\n  }\n\n  /**\n   * Renders the button (called after layout)\n   */\n  protected render(): void {\n    // Rendering is handled by background and label\n  }\n\n  /**\n   * Sets the button label\n   */\n  setLabel(text: string): void {\n    if (this.label) {\n      this.label.setText(text);\n      this.markLayoutDirty();\n    } else if (this.bitmapLabel) {\n      this.bitmapLabel.text = text;\n      this.markLayoutDirty();\n    }\n  }\n\n  /**\n   * Sets the enabled state\n   */\n  setEnabled(enabled: boolean): void {\n    this.props.enabled = enabled;\n    this.setState(enabled ? ButtonState.Normal : ButtonState.Disabled);\n  }\n\n  /**\n   * Gets the current state\n   */\n  getState(): ButtonState {\n    return this.state;\n  }\n\n  /**\n   * Cleanup when destroying the button\n   */\n  destroy(): void {\n    if (typeof window !== 'undefined' && this.keydownHandler) {\n      window.removeEventListener('keydown', this.keydownHandler);\n    }\n    super.destroy();\n  }\n\n}\n","/**\n * UI Scaling modes for UILayer\n */\nexport enum UIScaleMode {\n  /**\n   * No scaling - 1:1 pixel mapping, no offset calculations\n   */\n  None = 'none',\n\n  /**\n   * Scale UI proportionally to fill the available space\n   */\n  ScaleUI = 'scaleUI',\n\n  /**\n   * Scale while maintaining aspect ratio (may letterbox/pillarbox)\n   */\n  LockRatio = 'lockRatio'\n}\n","import * as PIXI from 'pixi.js';\nimport { UIScaleMode } from './UIScaleMode';\n\nexport interface UILayerOptions {\n  /**\n   * Scaling mode for this UI layer\n   * @default UIScaleMode.None\n   */\n  scaleMode?: UIScaleMode;\n\n  /**\n   * Target width for the UI layer (used as reference for scaling)\n   * If not provided, uses the first child's width\n   */\n  targetWidth?: number;\n\n  /**\n   * Target height for the UI layer (used as reference for scaling)\n   * If not provided, uses the first child's height\n   */\n  targetHeight?: number;\n}\n\n/**\n * UILayer is a container that manages scaling behavior for all its children\n *\n * @example\n * ```typescript\n * const hudLayer = new UILayer({ scaleMode: UIScaleMode.ScaleUI });\n * scene.addChild(hudLayer);\n * hudLayer.addChild(tabs.container);\n * ```\n */\nexport class UILayer extends PIXI.Container {\n  private scaleMode: UIScaleMode;\n  private targetWidth?: number;\n  private targetHeight?: number;\n  private initialBoundsRecorded = false;\n\n  constructor(options: UILayerOptions = {}) {\n    super();\n    this.scaleMode = options.scaleMode ?? UIScaleMode.None;\n    this.targetWidth = options.targetWidth;\n    this.targetHeight = options.targetHeight;\n  }\n\n  /**\n   * Update the layer's scale based on the current canvas size\n   */\n  updateScale(canvasWidth: number, canvasHeight: number): void {\n    if (this.scaleMode === UIScaleMode.None) {\n      this.scale.set(1, 1);\n      return;\n    }\n\n    // Record initial bounds from first child if not explicitly set\n    if (!this.initialBoundsRecorded && this.children.length > 0) {\n      if (!this.targetWidth || !this.targetHeight) {\n        const bounds = this.getLocalBounds();\n        this.targetWidth = this.targetWidth ?? bounds.width;\n        this.targetHeight = this.targetHeight ?? bounds.height;\n      }\n      this.initialBoundsRecorded = true;\n    }\n\n    if (!this.targetWidth || !this.targetHeight) {\n      // No dimensions to scale from yet\n      return;\n    }\n\n    const scaleX = canvasWidth / this.targetWidth;\n    const scaleY = canvasHeight / this.targetHeight;\n\n    switch (this.scaleMode) {\n      case UIScaleMode.ScaleUI:\n        // Scale to fill, stretching if necessary\n        this.scale.set(scaleX, scaleY);\n        break;\n\n      case UIScaleMode.LockRatio:\n        // Scale maintaining aspect ratio\n        const scale = Math.min(scaleX, scaleY);\n        this.scale.set(scale, scale);\n        // Center the content\n        this.position.set(\n          (canvasWidth - this.targetWidth * scale) / 2,\n          (canvasHeight - this.targetHeight * scale) / 2\n        );\n        break;\n    }\n  }\n\n  /**\n   * Add a child and trigger scale update if needed\n   */\n  override addChild<T extends PIXI.Container[]>(...children: T): T[0] {\n    const result = super.addChild(...children);\n    this.initialBoundsRecorded = false;\n    return result;\n  }\n}\n","import { StateLogic } from './state-logic';\n\n// Define the custom event type for state changes\nexport type StateChangeEvent = {\n  prevState: string | null;\n  newState: string;\n};\n\ntype StateChangeEventListener = (event: StateChangeEvent) => void;\ntype StateLogicRecords = Record<string, StateLogic>;\n\nexport class StateMachine extends EventTarget {\n  private _states: StateLogicRecords = {};\n  private _currentState: StateLogic | null = null;\n  private _currentStateName: string | null = null;\n\n  constructor(states: StateLogicRecords = {}) {\n    super();\n    this._states = states;\n  }\n\n  update(deltaTime: number) {\n    if (this._currentState) {\n      this._currentState.update(this._currentState.entity, deltaTime);\n    }\n  }\n  \n  setState(stateName: string) {\n    const nextState = this._states[stateName];\n    if(!nextState) return;\n\n    const prevStateName = this._currentStateName;\n    \n    if (this._currentState) {\n      this._currentState.onExit(stateName);\n    }\n\n    this._currentState = this._states[stateName];\n    this._currentStateName = stateName;\n    this._currentState.onEnter(stateName);\n    \n    // Dispatch the state change event\n    const event = new CustomEvent<StateChangeEvent>('stateChange', {\n      detail: {\n        prevState: prevStateName,\n        newState: stateName\n      }\n    });\n    \n    this.dispatchEvent(event);\n  }\n\n  addState(state: StateLogic) {\n    this._states[state.name] = state;\n  }\n  \n  get currentState(): string | null {\n    return this._currentStateName;\n  }\n}\n\n","/**\n * Pixel-Perfect Grid System\n *\n * Provides a consistent grid-based layout system for pixel-perfect UIs,\n * commonly used in retro-style games and pixel art applications.\n *\n * @category UI\n *\n * @example\n * ```typescript\n * // Use the default grid\n * const width = px(10); // 10 grid units = 40 pixels at 4x scale\n *\n * // Create a custom grid\n * const customGrid = new PixelGrid({\n *   unit: 1,\n *   scale: 2,  // 2x scale instead of 4x\n *   border: 1,\n *   padding: 2,\n *   gap: 1\n * });\n * const width = customGrid.px(10); // 20 pixels at 2x scale\n * ```\n */\n\n/**\n * Configuration for a pixel grid system\n */\nexport interface PixelGridConfig {\n  /** Base pixel unit at 1x scale (default: 1) */\n  unit?: number;\n  /** Scale multiplier for all measurements (default: 4) */\n  scale?: number;\n  /** Border width in grid units (default: 1) */\n  border?: number;\n  /** Standard padding in grid units (default: 1) */\n  padding?: number;\n  /** Gap between elements in grid units (default: 1) */\n  gap?: number;\n  /** Margin/spacing in grid units (default: 5, e.g., 5 * 4 = 20px) */\n  margin?: number;\n  /** Font scale multiplier (default: 0.25, e.g., 64px * 0.25 = 16px) */\n  fontScale?: number;\n}\n\n/**\n * Border configuration for multi-layer borders\n */\nexport interface BorderConfig {\n  /** Outer border width in grid units (default: 1) */\n  outer?: number;\n  /** Middle border width in grid units (default: 1) */\n  middle?: number;\n  /** Inner border width in grid units (default: 1) */\n  inner?: number;\n  /** Total border width (calculated automatically) */\n  total?: number;\n}\n\n/**\n * A pixel-perfect grid system for consistent UI measurements\n *\n * All measurements are in grid units that get scaled to actual pixels.\n * This ensures pixel-perfect alignment at any scale factor.\n */\nexport class PixelGrid {\n  public readonly unit: number;\n  public readonly scale: number;\n  public readonly border: number;\n  public readonly padding: number;\n  public readonly gap: number;\n  public readonly margin: number;\n  public readonly fontScale: number;\n\n  constructor(config: PixelGridConfig = {}) {\n    this.unit = config.unit ?? 1;\n    this.scale = config.scale ?? 4;\n    this.border = config.border ?? 1;\n    this.padding = config.padding ?? 1;\n    this.gap = config.gap ?? 1;\n    this.margin = config.margin ?? 5; // 5 units * 4 scale = 20px default\n    // Font scale is proportional to GRID scale (0.25 at 4x scale)\n    // At 4x: 64px * 0.25 = 16px, At 3x: 64px * 0.1875 = 12px, etc.\n    this.fontScale = config.fontScale ?? (this.scale / 16);\n  }\n\n  /**\n   * Convert grid units to actual pixels\n   * @param units - Number of grid units\n   * @returns Actual pixel value\n   */\n  px(units: number): number {\n    return units * this.unit * this.scale;\n  }\n\n  /**\n   * Convert pixels to grid units\n   * @param pixels - Number of pixels\n   * @returns Grid units (rounded)\n   */\n  units(pixels: number): number {\n    return Math.round(pixels / (this.unit * this.scale));\n  }\n}\n\n/**\n * Default pixel grid instance\n * - 1px base unit\n * - 4x scale (common for retro/pixel games)\n * - 1 unit borders, padding, and gaps\n *\n * TEMPORARY: Checks localStorage for 'temp-grid-scale' to override scale for testing\n */\nexport const DEFAULT_PIXEL_GRID = (() => {\n  // TEMPORARY: Check for scale override in localStorage\n  const tempScale = typeof localStorage !== 'undefined'\n    ? localStorage.getItem('temp-grid-scale')\n    : null;\n\n  if (tempScale) {\n    const scale = parseInt(tempScale, 10);\n    if (!isNaN(scale) && scale >= 1 && scale <= 4) {\n      return new PixelGrid({ scale });\n    }\n  }\n\n  return new PixelGrid();\n})();\n\n/**\n * Helper function to convert grid units to pixels using the default grid\n * @param units - Number of grid units\n * @returns Actual pixel value\n */\nexport const px = (units: number): number => DEFAULT_PIXEL_GRID.px(units);\n\n/**\n * Helper function to convert pixels to grid units using the default grid\n * @param pixels - Number of pixels\n * @returns Grid units (rounded)\n */\nexport const units = (pixels: number): number => DEFAULT_PIXEL_GRID.units(pixels);\n\n/**\n * Default grid constants for easy access\n */\nexport const GRID = {\n  unit: DEFAULT_PIXEL_GRID.unit,\n  scale: DEFAULT_PIXEL_GRID.scale,\n  border: DEFAULT_PIXEL_GRID.border,\n  padding: DEFAULT_PIXEL_GRID.padding,\n  gap: DEFAULT_PIXEL_GRID.gap,\n  margin: DEFAULT_PIXEL_GRID.margin,\n  fontScale: DEFAULT_PIXEL_GRID.fontScale\n} as const;\n\n/**\n * Default border configuration (triple border: outer/middle/inner)\n */\nexport const BORDER = {\n  outer: 1,   // Outer border (1 grid unit)\n  middle: 1,  // Middle border (1 grid unit)\n  inner: 1,   // Inner border (1 grid unit)\n  total: 3    // Total border width (3 grid units)\n} as const;\n\n/**\n * Create a custom border configuration\n * @param config - Border configuration\n * @returns Border configuration with calculated total\n */\nexport function createBorderConfig(config: BorderConfig = {}): Required<BorderConfig> {\n  const outer = config.outer ?? 1;\n  const middle = config.middle ?? 1;\n  const inner = config.inner ?? 1;\n  const total = outer + middle + inner;\n\n  return {\n    outer,\n    middle,\n    inner,\n    total\n  };\n}\n","import * as PIXI from 'pixi.js';\nimport { MoxiEntity, AsEntity, asEntity } from '../core/moxi-entity';\n\nexport interface ParallaxLayerOptions {\n  scrollScale?: PIXI.Point;      // Motion multiplier (0.5 = half speed, like Godot's motion_scale)\n  scrollOffset?: PIXI.Point;     // Layer offset for positioning (like Godot's motion_offset)\n  repeatSize?: PIXI.Point;       // Mirroring/repeat interval (0 = no repeat, like Godot's motion_mirroring)\n  mirroring?: boolean;           // Enable automatic mirroring (requires repeatSize)\n}\n\n/**\n * Individual parallax layer that scrolls at a different speed based on scrollScale.\n *\n * Inspired by Godot's ParallaxLayer node.\n *\n * The scrollScale property controls how fast the layer moves relative to the camera:\n * - 0.0 = Static (doesn't move with camera, good for UI/HUD)\n * - 0.2 = Slow (appears far away, like sky)\n * - 0.5 = Medium (mid-ground elements)\n * - 0.9 = Fast (foreground elements)\n * - 1.0 = Moves with camera (game entities)\n * - >1.0 = Faster than camera (reverse parallax effect)\n *\n * @example\n * ```typescript\n * const layer = new ParallaxLayer({\n *   scrollScale: new PIXI.Point(0.5, 0.5), // Half camera speed\n *   scrollOffset: new PIXI.Point(0, 0)\n * });\n *\n * // Add sprites to the layer\n * const sprite = new PIXI.Sprite(texture);\n * layer.addChild(sprite);\n * ```\n */\nexport class ParallaxLayer extends PIXI.Container implements AsEntity<PIXI.Container> {\n  public moxiEntity: MoxiEntity<PIXI.Container>;\n  public scrollScale: PIXI.Point = new PIXI.Point(1, 1);\n  public scrollOffset: PIXI.Point = new PIXI.Point(0, 0);\n  public repeatSize: PIXI.Point = new PIXI.Point(0, 0);\n  public mirroring: boolean = false;\n\n  // Internal state\n  private _lastCameraPos: PIXI.Point = new PIXI.Point(0, 0);\n\n  constructor(options: ParallaxLayerOptions = {}) {\n    super();\n\n    this.scrollScale = options.scrollScale ?? new PIXI.Point(1, 1);\n    this.scrollOffset = options.scrollOffset ?? new PIXI.Point(0, 0);\n    this.repeatSize = options.repeatSize ?? new PIXI.Point(0, 0);\n    this.mirroring = options.mirroring ?? false;\n\n    // Convert to Moxi entity\n    const entity = asEntity(this);\n    this.moxiEntity = entity.moxiEntity;\n  }\n\n  /**\n   * Update layer position based on camera movement.\n   * Called by ParallaxBackgroundLogic each frame.\n   *\n   * @param cameraPos - Current camera position in world space\n   * @param cameraScale - Current camera scale/zoom\n   * @param backgroundOffset - Global background scroll offset\n   */\n  updateParallax(\n    cameraPos: PIXI.Point,\n    cameraScale: PIXI.Point,\n    backgroundOffset: PIXI.Point\n  ): void {\n    // Calculate effective scroll offset\n    const scrollX = (cameraPos.x + backgroundOffset.x) * this.scrollScale.x;\n    const scrollY = (cameraPos.y + backgroundOffset.y) * this.scrollScale.y;\n\n    // Apply to layer position\n    this.position.x = -scrollX + this.scrollOffset.x;\n    this.position.y = -scrollY + this.scrollOffset.y;\n\n    // Handle mirroring/wrapping if enabled\n    if (this.mirroring) {\n      if (this.repeatSize.x > 0) {\n        this.position.x = this.position.x % this.repeatSize.x;\n        if (this.position.x > 0) this.position.x -= this.repeatSize.x;\n      }\n      if (this.repeatSize.y > 0) {\n        this.position.y = this.position.y % this.repeatSize.y;\n        if (this.position.y > 0) this.position.y -= this.repeatSize.y;\n      }\n    }\n\n    this._lastCameraPos.copyFrom(cameraPos);\n  }\n}\n\nexport interface TilingParallaxLayerOptions extends ParallaxLayerOptions {\n  texture: PIXI.Texture;\n  width?: number;\n  height?: number;\n}\n\n/**\n * Specialized parallax layer using PIXI.TilingSprite for efficient infinite scrolling.\n *\n * This is the recommended approach for large, repeating backgrounds like sky, clouds,\n * or ground textures. TilingSprite is optimized for repeating patterns and uses\n * tilePosition for seamless scrolling without repositioning the container.\n *\n * @example\n * ```typescript\n * const skyLayer = new TilingParallaxLayer({\n *   texture: skyTexture,\n *   scrollScale: new PIXI.Point(0.2, 0.2)\n *   // width/height auto-detected from renderer\n * });\n * parallaxBackground.addLayer(skyLayer);\n * ```\n */\nexport class TilingParallaxLayer extends ParallaxLayer {\n  public tilingSprite: PIXI.TilingSprite;\n  private _autoSized: boolean = false;\n\n  constructor(options: TilingParallaxLayerOptions) {\n    super(options);\n\n    // Ensure texture wraps for seamless tiling\n    options.texture.source.style.addressMode = 'repeat';\n\n    // If dimensions not provided, use temporary values and auto-detect on first update\n    const width = options.width ?? 1;\n    const height = options.height ?? 1;\n\n    // Create TilingSprite as child\n    this.tilingSprite = new PIXI.TilingSprite({\n      texture: options.texture,\n      width: width,\n      height: height,\n    });\n\n    // Position TilingSprite to start from origin (0, 0) to cover the viewport\n    this.tilingSprite.position.set(0, 0);\n\n    this.addChild(this.tilingSprite);\n\n    // Mark if we need to auto-detect dimensions\n    this._autoSized = !options.width && !options.height;\n  }\n\n  /**\n   * Auto-detect renderer dimensions from the scene hierarchy\n   */\n  private autoDetectDimensions(): void {\n    if (!this._autoSized) return;\n\n    // Walk up parent chain to find a node with a renderer\n    let current: any = this.parent;\n    while (current) {\n      if (current.renderer) {\n        // Found a renderer (usually on Scene)\n        this.resize(current.renderer.width, current.renderer.height);\n        this._autoSized = false; // Only need to do this once\n        return;\n      }\n      current = current.parent;\n    }\n  }\n\n  /**\n   * Override updateParallax to use tilePosition instead of container position.\n   * This provides seamless infinite scrolling without visible seams.\n   *\n   * Since the ParallaxBackground container now follows the camera, layers inside\n   * stay at (0,0) and only use tilePosition for the parallax scrolling effect.\n   *\n   * Camera scale is used to resize the TilingSprite to cover the viewport at different zoom levels.\n   */\n  updateParallax(\n    cameraPos: PIXI.Point,\n    cameraScale: PIXI.Point,\n    backgroundOffset: PIXI.Point\n  ): void {\n    // Auto-detect dimensions on first update if not manually specified\n    this.autoDetectDimensions();\n    // console.log('updateParallax', cameraScale);\n\n    // Get renderer dimensions to use as base size\n    const renderer = this.parent?.parent as any; // Get renderer from scene\n    if (renderer?.renderer) {\n      const baseWidth = renderer.renderer.width;\n      const baseHeight = renderer.renderer.height;\n\n      // ParallaxBackground counter-scales, so we're in screen-space\n      // Just set to renderer size - no zoom adjustment needed\n      this.tilingSprite.width = baseWidth;\n      this.tilingSprite.height = baseHeight;\n\n      // Keep sprite at origin\n      this.tilingSprite.pivot.set(0, 0);\n      this.tilingSprite.position.set(0, 0);\n    }\n\n    // Calculate effective scroll offset for tilePosition\n    const scrollX = (cameraPos.x + backgroundOffset.x) * this.scrollScale.x;\n    const scrollY = (cameraPos.y + backgroundOffset.y) * this.scrollScale.y;\n\n    // Apply to tilePosition (with layer's own scrollOffset for positioning)\n    this.tilingSprite.tilePosition.x = -scrollX + this.scrollOffset.x;\n    this.tilingSprite.tilePosition.y = -scrollY + this.scrollOffset.y;\n\n    // Layer container stays at origin - scene pivot handles zoom anchoring\n    this.position.set(0, 0);\n  }\n\n  /**\n   * Update TilingSprite dimensions (e.g., on window resize)\n   */\n  resize(width: number, height: number): void {\n    this.tilingSprite.width = width;\n    this.tilingSprite.height = height;\n  }\n}\n","import * as PIXI from 'pixi.js';\nimport { MoxiEntity, AsEntity, asEntity } from '../core/moxi-entity';\nimport { Logic } from '../core/logic';\nimport { Camera } from '../core/camera';\nimport { ParallaxLayer } from './parallax-layer';\n\nexport interface ParallaxBackgroundOptions {\n  camera?: Camera;                    // Reference to camera (auto-detected if not provided)\n  scrollOffset?: PIXI.Point;          // Base scroll offset\n  scrollBaseScale?: PIXI.Point;       // Base scale multiplier\n  scrollIgnoreCameraZoom?: boolean;   // Disable zoom affecting parallax\n  autoscroll?: PIXI.Point;            // Automatic scrolling independent of camera\n}\n\n/**\n * Container for all parallax layers that manages global parallax behavior\n * and coordinates with the Camera system.\n *\n * Inspired by Godot's ParallaxBackground node.\n *\n * @example\n * ```typescript\n * const parallax = new ParallaxBackground();\n * const skyLayer = new TilingParallaxLayer({\n *   texture: skyTexture,\n *   scrollScale: new PIXI.Point(0.2, 0.2)\n * });\n * parallax.addLayer(skyLayer);\n * scene.addChild(parallax);\n * ```\n */\nexport class ParallaxBackground extends PIXI.Container implements AsEntity<PIXI.Container> {\n  public moxiEntity: MoxiEntity<PIXI.Container>;\n  public camera: Camera | null = null;\n  public scrollOffset: PIXI.Point = new PIXI.Point(0, 0);\n  public scrollBaseScale: PIXI.Point = new PIXI.Point(1, 1);\n  public scrollIgnoreCameraZoom: boolean = false;\n  public autoscroll: PIXI.Point = new PIXI.Point(0, 0);\n\n  constructor(options: ParallaxBackgroundOptions = {}) {\n    super();\n\n    // Apply options\n    this.camera = options.camera ?? null;\n    this.scrollOffset = options.scrollOffset ?? new PIXI.Point(0, 0);\n    this.scrollBaseScale = options.scrollBaseScale ?? new PIXI.Point(1, 1);\n    this.scrollIgnoreCameraZoom = options.scrollIgnoreCameraZoom ?? false;\n    this.autoscroll = options.autoscroll ?? new PIXI.Point(0, 0);\n\n    // Convert to Moxi entity with ParallaxBackgroundLogic\n    const entity = asEntity(this);\n    entity.moxiEntity.addLogic(new ParallaxBackgroundLogic());\n    this.moxiEntity = entity.moxiEntity;\n  }\n\n  /**\n   * Adds a ParallaxLayer to the background\n   */\n  addLayer(layer: ParallaxLayer): void {\n    this.addChild(layer);\n  }\n\n  /**\n   * Auto-detect camera from scene hierarchy\n   */\n  private detectCamera(): Camera | null {\n    let current = this.parent;\n    while (current) {\n      if (current instanceof Camera) {\n        return current;\n      }\n      current = current.parent;\n    }\n    return null;\n  }\n\n  /**\n   * Get the effective camera position for parallax calculation\n   */\n  getCameraPosition(): PIXI.Point {\n    const camera = this.camera ?? this.detectCamera();\n    if (!camera) {\n      return new PIXI.Point(0, 0);\n    }\n\n    // In MOXI's camera system, camera.position represents where the camera is looking\n    // The scene is positioned at -camera.position to create the camera effect\n    return new PIXI.Point(\n      camera.position.x,\n      camera.position.y\n    );\n  }\n\n  /**\n   * Get the effective camera scale/zoom for parallax calculation\n   */\n  getCameraScale(): PIXI.Point {\n    if (this.scrollIgnoreCameraZoom) {\n      return new PIXI.Point(1, 1);\n    }\n\n    const camera = this.camera ?? this.detectCamera();\n    if (!camera) {\n      return new PIXI.Point(1, 1);\n    }\n\n    return new PIXI.Point(camera.scale.x, camera.scale.y);\n  }\n}\n\n/**\n * Logic component that updates the parallax background based on camera movement and autoscroll.\n */\nexport class ParallaxBackgroundLogic extends Logic<ParallaxBackground> {\n  name = 'ParallaxBackgroundLogic';\n\n  update(entity: ParallaxBackground, deltaTime: number) {\n    // Apply autoscroll\n    if (entity.autoscroll.x !== 0 || entity.autoscroll.y !== 0) {\n      entity.scrollOffset.x += entity.autoscroll.x * deltaTime;\n      entity.scrollOffset.y += entity.autoscroll.y * deltaTime;\n    }\n\n    // Get camera position for child layers to reference\n    const cameraPos = entity.getCameraPosition();\n    const cameraScale = entity.getCameraScale();\n\n    // Position the ParallaxBackground to stay screen-aligned\n    // Since ParallaxBackground is a child of scene with pivot at viewport center,\n    // we need to counter-scale to keep layers at 1:1 screen scale\n    const scene = entity.parent;\n    if (scene) {\n      // Position to stay centered on viewport despite camera movement\n      // Account for scene scale since scene.position is scaled\n      entity.position.x = cameraPos.x / scene.scale.x;\n      entity.position.y = cameraPos.y / scene.scale.y;\n\n      // Counter-scale to cancel inherited scene scale\n      // This keeps TilingSprite sizing in screen-space coordinates\n      entity.scale.x = 1 / scene.scale.x;\n      entity.scale.y = 1 / scene.scale.y;\n    } else {\n      entity.position.x = cameraPos.x;\n      entity.position.y = cameraPos.y;\n      entity.scale.set(1, 1);\n    }\n\n    // Update all child ParallaxLayers\n    entity.children.forEach((child: any) => {\n      if (child instanceof ParallaxLayer) {\n        child.updateParallax(cameraPos, cameraScale, entity.scrollOffset);\n      }\n    });\n  }\n}\n","import * as utils from './library/utils';\nimport { RenderManager } from './core/render-manager';\nimport { Scene } from './core/scene';\nimport { Engine } from './core/engine';\nimport { EventEmitter } from './core/event-system';\nimport { ClientEvents } from './library/client-events';\nimport { AssetLoader } from './core/asset-loader';\nimport { Point } from 'pixi.js';\nimport { Logic } from './core/logic';\nimport { defaultRenderOptions, setupMoxi } from './library/setup';\nimport { loadFonts } from './library/font-loader';\nimport { asEntity, MoxiEntity } from './core/moxi-entity';\nimport { Camera, CameraLogic } from './core/camera';\nimport { asTextureFrames } from './library/texture-frames';\nimport { asBitmapText, asSprite, asText, asGraphics, asContainer, PixiProps } from './library/as-pixi';\nimport { TextureFrameSequences, SequenceInfo } from './library/texture-frame-sequences';\nimport { createResizeHandler, setupResponsiveCanvas, ResizeHandlerOptions } from './library/resize-handler';\nimport { EdgeInsets } from './ui/core/edge-insets';\nimport { UIComponent } from './ui/core/ui-component';\nimport { UIFocusManager } from './ui/core/ui-focus-manager';\nimport { FlexContainer, FlexDirection, FlexJustify, FlexAlign } from './ui/layout/flex-container';\nimport { UIBox } from './ui/components/ui-box';\nimport { UILabel } from './ui/components/ui-label';\nimport { UIPanel } from './ui/components/ui-panel';\nimport { UIButton, ButtonState } from './ui/components/ui-button';\nimport { UISelect, SelectOption } from './ui/components/ui-select';\nimport { UITextInput } from './ui/components/ui-text-input';\nimport { UITextArea } from './ui/components/ui-textarea';\nimport { UIScrollContainer } from './ui/components/ui-scroll-container';\nimport { UITabs, TabItem } from './ui/components/ui-tabs';\nimport { UILayer } from './ui/UILayer';\nimport { UIScaleMode } from './ui/UIScaleMode';\nimport { StateMachine } from './library/state-machine';\nimport { StateLogic } from './library/state-logic';\nimport { createTileGrid, getTextureRange } from './library/grid-generator';\nimport { svgToTexture } from './library/svg-utils/svg-to-texture';\nimport { PixelGrid, px, units, GRID, BORDER, createBorderConfig } from './ui/pixel-grid';\nimport { ParallaxBackground, ParallaxBackgroundLogic } from './library/parallax-background';\nimport { ParallaxLayer, TilingParallaxLayer } from './library/parallax-layer';\nimport { LoadingScene } from './library/loading-scene';\nimport {\n  PhysicsWorld,\n  PhysicsBodyLogic,\n  PhysicsDebugRenderer,\n  CollisionRegistry,\n  CollisionManager,\n  asPhysicsEntity,\n  hasPhysics,\n  getPhysicsBody,\n  createShapeFromSprite,\n  PhysicsMaterials,\n  applyMaterial\n} from './library/physics';\n\nexport type { StateChangeEvent } from './library/state-machine';\nexport type { AsEntity, MoxiLogic } from './core/moxi-entity';\nexport type { AsTextureFramesOptions } from './library/texture-frames';\nexport type { GridOptions, CellPosition } from './library/grid-generator';\nexport type { ParallaxBackgroundOptions } from './library/parallax-background';\nexport type { ParallaxLayerOptions, TilingParallaxLayerOptions } from './library/parallax-layer';\nexport type { LoadingSceneOptions } from './library/loading-scene';\nexport type {\n  BodyType,\n  SyncMode,\n  ShapeType,\n  CollisionTag,\n  ShapeConfig,\n  PhysicsWorldOptions,\n  PhysicsBodyOptions,\n  PhysicsDebugOptions,\n  CollisionEvent,\n  RaycastCallback\n} from './library/physics';\nexport type { BoxModel, ComputedLayout, MeasuredSize, SizeConstraint } from './ui/core/box-model';\nexport type { FlexContainerProps } from './ui/layout/flex-container';\nexport type { UIBoxProps } from './ui/components/ui-box';\nexport type { UILabelProps, TextAlign } from './ui/components/ui-label';\nexport type { UIPanelProps, NineSliceConfig } from './ui/components/ui-panel';\nexport type { UIButtonProps, SpriteBackgroundConfig } from './ui/components/ui-button';\nexport type { UISelectProps, SelectOption } from './ui/components/ui-select';\nexport type { UITextInputProps } from './ui/components/ui-text-input';\nexport type { UITabsProps, TabItem } from './ui/components/ui-tabs';\nexport type { UILayerOptions } from './ui/UILayer';\nexport type { PixelGridConfig, BorderConfig } from './ui/pixel-grid';\nexport type { SVGToTextureOptions } from './library/svg-utils/svg-to-texture';\n\nexport type Asset = { src: string, alias?: string };\n\nexport interface OnEvent {\n  event: Event;\n  eventType: string;\n}\n\nexport interface ClientEventsArgs {\n  initWheelOffset?: Point;\n  onAnyEvent?: (ev: OnEvent) => void;\n}\n\nexport type ClientEventsType = {\n  keyDownEvent?: KeyboardEvent;\n  keyUpEvent?: KeyboardEvent;\n  keydown?: Record<string, KeyboardEvent>;\n  mouseDownEvent?: MouseEvent;\n  mouseUpEvent?: MouseEvent;\n  lastMouseDown?: MouseEvent;\n  lastMouseUp?: MouseEvent;\n  wheelEvent?: WheelEvent;\n  wheelDelta?: { yValue: 0 | number, xValue: 0 | number, xLast: number, yLast: number }\n}\n\n// Re-export types\nexport { \n  SequenceInfo, \n  ResizeHandlerOptions\n};\n\nconst exportedObjects = {\n  AssetLoader,\n  asEntity,\n  asTextureFrames,\n  asBitmapText,\n  asSprite,\n  asText,\n  asGraphics,\n  asContainer,\n  Logic,\n  Camera,\n  CameraLogic,\n  ClientEvents,\n  createResizeHandler,\n  createTileGrid,\n  defaultRenderOptions,\n  Engine,\n  EventEmitter,\n  getTextureRange,\n  loadFonts,\n  MoxiEntity,\n  ParallaxBackground,\n  ParallaxBackgroundLogic,\n  ParallaxLayer,\n  LoadingScene,\n  setupMoxi,\n  RenderManager,\n  Scene,\n  setupResponsiveCanvas,\n  TextureFrameSequences,\n  TilingParallaxLayer,\n  utils,\n  StateMachine,\n  StateLogic,\n  PhysicsWorld,\n  PhysicsBodyLogic,\n  PhysicsDebugRenderer,\n  CollisionRegistry,\n  CollisionManager,\n  asPhysicsEntity,\n  hasPhysics,\n  getPhysicsBody,\n  createShapeFromSprite,\n  PhysicsMaterials,\n  applyMaterial,\n  EdgeInsets,\n  UIComponent,\n  UIFocusManager,\n  FlexContainer,\n  FlexDirection,\n  FlexJustify,\n  FlexAlign,\n  UIBox,\n  UILabel,\n  UIPanel,\n  UIButton,\n  ButtonState,\n  UISelect,\n  UITextInput,\n  UITextArea,\n  UIScrollContainer,\n  UITabs,\n  UILayer,\n  UIScaleMode,\n  svgToTexture,\n  PixelGrid,\n  px,\n  units,\n  GRID,\n  BORDER,\n  createBorderConfig\n};\n\nexport default exportedObjects;\n\nexport {\n  AssetLoader,\n  asEntity,\n  asTextureFrames,\n  asBitmapText,\n  asSprite,\n  asText,\n  asGraphics,\n  asContainer,\n  PixiProps,\n  Logic,\n  Camera,\n  CameraLogic,\n  ClientEvents,\n  createResizeHandler,\n  createTileGrid,\n  defaultRenderOptions,\n  Engine,\n  EventEmitter,\n  getTextureRange,\n  loadFonts,\n  MoxiEntity,\n  ParallaxBackground,\n  ParallaxBackgroundLogic,\n  ParallaxLayer,\n  LoadingScene,\n  setupMoxi,\n  RenderManager,\n  Scene,\n  setupResponsiveCanvas,\n  TextureFrameSequences,\n  TilingParallaxLayer,\n  utils,\n  StateMachine,\n  StateLogic,\n  PhysicsWorld,\n  PhysicsBodyLogic,\n  PhysicsDebugRenderer,\n  CollisionRegistry,\n  CollisionManager,\n  asPhysicsEntity,\n  hasPhysics,\n  getPhysicsBody,\n  createShapeFromSprite,\n  PhysicsMaterials,\n  applyMaterial,\n  EdgeInsets,\n  UIComponent,\n  UIFocusManager,\n  FlexContainer,\n  FlexDirection,\n  FlexJustify,\n  FlexAlign,\n  UIBox,\n  UILabel,\n  UIPanel,\n  UIButton,\n  ButtonState,\n  UISelect,\n  UITextInput,\n  UITextArea,\n  UIScrollContainer,\n  UITabs,\n  UILayer,\n  UIScaleMode,\n  svgToTexture,\n  PixelGrid,\n  px,\n  units,\n  GRID,\n  BORDER,\n  createBorderConfig\n};\n\n","/**\n * Theme system for the sprite editor\n * Allows customizing the look and feel of all UI components\n */\n\nimport cc29ThemesJson from './themes/cc29-themes.json';\n\n/**\n * Theme Configuration\n *\n * A theme defines the visual appearance through semantic color roles.\n * Colors are organized by their visual function, not by which component uses them.\n *\n * BACKGROUND LAYERS (4 colors - define depth through layering):\n *   backgroundRoot     - The canvas/viewport background (furthest back)\n *   backgroundSurface  - Cards, panels, dialogs (main surfaces)\n *   backgroundRaised   - Buttons, inputs, interactive elements (raised above surfaces)\n *   backgroundOverlay  - Headers, title bars, hover states (highest layer)\n *\n * BORDERS (2 colors - define edges and separation):\n *   borderStrong  - Primary borders, strong definition\n *   borderSubtle  - Subtle dividers, inner borders, light separation\n *\n * ACCENTS (2 colors - draw attention and show state):\n *   accentPrimary   - Active states, selections, primary actions\n *   accentSecondary - Hover states, secondary highlights\n *\n * TEXT (2 colors - content hierarchy):\n *   textPrimary   - Main content, important text\n *   textSecondary - Labels, hints, de-emphasized content\n */\nexport interface Theme {\n  // Background layers (from back to front)\n  backgroundRoot: number;     // Canvas background\n  backgroundSurface: number;  // Cards, panels\n  backgroundRaised: number;   // Buttons, inputs\n  backgroundOverlay: number;  // Headers, title bars\n\n  // Borders\n  borderStrong: number;  // Primary borders\n  borderSubtle: number;  // Light dividers\n\n  // Accents\n  accentPrimary: number;   // Selections, active\n  accentSecondary: number; // Hover, secondary\n\n  // Text\n  textPrimary: number;   // Main content\n  textSecondary: number; // Labels, hints\n}\n\n/**\n * Convert JSON theme data to Theme object\n * JSON stores colors as hex strings, need to convert to numbers\n */\nfunction parseThemeFromJson(jsonTheme: any): Theme {\n  const parseColor = (colorStr: string): number => {\n    return parseInt(colorStr, 16);\n  };\n\n  return {\n    backgroundRoot: parseColor(jsonTheme.backgroundRoot),\n    backgroundSurface: parseColor(jsonTheme.backgroundSurface),\n    backgroundRaised: parseColor(jsonTheme.backgroundRaised),\n    backgroundOverlay: parseColor(jsonTheme.backgroundOverlay),\n    borderStrong: parseColor(jsonTheme.borderStrong),\n    borderSubtle: parseColor(jsonTheme.borderSubtle),\n    accentPrimary: parseColor(jsonTheme.accentPrimary),\n    accentSecondary: parseColor(jsonTheme.accentSecondary),\n    textPrimary: parseColor(jsonTheme.textPrimary),\n    textSecondary: parseColor(jsonTheme.textSecondary),\n  };\n}\n\n/**\n * Load themes from JSON\n */\nconst cc29Themes = cc29ThemesJson as any;\n\n// Classic themes\nexport const DARK_THEME: Theme = parseThemeFromJson(cc29Themes.classic[0]);\nexport const LIGHT_THEME: Theme = parseThemeFromJson(cc29Themes.classic[1]);\n\n// Seasonal themes\nexport const SPRING_THEME: Theme = parseThemeFromJson(cc29Themes.seasonal[0]);\nexport const SUMMER_THEME: Theme = parseThemeFromJson(cc29Themes.seasonal[1]);\nexport const AUTUMN_THEME: Theme = parseThemeFromJson(cc29Themes.seasonal[2]);\nexport const WINTER_THEME: Theme = parseThemeFromJson(cc29Themes.seasonal[3]);\n\n/**\n * Helper function to create a theme from a palette\n * Maps palette colors to theme roles based on brightness/purpose\n */\nexport function createThemeFromPalette(\n  palette: number[],\n  config?: {\n    background?: number;\n    cardBg?: number;\n    titleBar?: number;\n    buttonBg?: number;\n    highlight?: number;\n    darkText?: number;\n    lightText?: number;\n  }\n): Theme {\n  // Sort palette by brightness (simple luminance calculation)\n  const sortedByBrightness = [...palette].sort((a, b) => {\n    const lumA = ((a >> 16) & 0xff) * 0.299 + ((a >> 8) & 0xff) * 0.587 + (a & 0xff) * 0.114;\n    const lumB = ((b >> 16) & 0xff) * 0.299 + ((b >> 8) & 0xff) * 0.587 + (b & 0xff) * 0.114;\n    return lumA - lumB;\n  });\n\n  const darkest = sortedByBrightness[0];\n  const dark = sortedByBrightness[Math.floor(sortedByBrightness.length * 0.25)];\n  const medium = sortedByBrightness[Math.floor(sortedByBrightness.length * 0.5)];\n  const light = sortedByBrightness[Math.floor(sortedByBrightness.length * 0.75)];\n  const lightest = sortedByBrightness[sortedByBrightness.length - 1];\n\n  // Find a saturated color for highlight (highest saturation)\n  const highlight = palette.reduce((best, color) => {\n    const r = (color >> 16) & 0xff;\n    const g = (color >> 8) & 0xff;\n    const b = color & 0xff;\n    const max = Math.max(r, g, b);\n    const min = Math.min(r, g, b);\n    const sat = max === 0 ? 0 : (max - min) / max;\n\n    const bestR = (best >> 16) & 0xff;\n    const bestG = (best >> 8) & 0xff;\n    const bestB = best & 0xff;\n    const bestMax = Math.max(bestR, bestG, bestB);\n    const bestMin = Math.min(bestR, bestG, bestB);\n    const bestSat = bestMax === 0 ? 0 : (bestMax - bestMin) / bestMax;\n\n    return sat > bestSat ? color : best;\n  }, palette[0]);\n\n  return {\n    backgroundRoot: config?.background ?? dark,\n    backgroundSurface: config?.cardBg ?? medium,\n    backgroundRaised: config?.buttonBg ?? light,\n    backgroundOverlay: config?.titleBar ?? dark,\n    borderStrong: darkest,\n    borderSubtle: lightest,\n    accentPrimary: config?.highlight ?? highlight,\n    accentSecondary: config?.highlight ?? highlight,\n    textPrimary: config?.darkText ?? darkest,\n    textSecondary: config?.lightText ?? dark,\n  };\n}\n\n/**\n * Theme metadata for organizing and displaying themes\n */\nexport interface ThemeMetadata {\n  name: string;\n  theme: Theme;\n  category: 'classic' | 'seasonal';\n  palette: string;\n}\n\n/**\n * Theme group - organizes themes by palette\n */\nexport interface ThemeGroup {\n  paletteName: string;\n  classic: ThemeMetadata[];\n  seasonal: ThemeMetadata[];\n}\n\n/**\n * Load theme groups from JSON files\n */\nfunction loadThemeGroup(jsonData: any): ThemeGroup {\n  const paletteName = jsonData.paletteName;\n\n  const classic: ThemeMetadata[] = jsonData.classic.map((jsonTheme: any) => ({\n    name: jsonTheme.name,\n    theme: parseThemeFromJson(jsonTheme),\n    category: 'classic' as const,\n    palette: paletteName\n  }));\n\n  const seasonal: ThemeMetadata[] = jsonData.seasonal.map((jsonTheme: any) => ({\n    name: jsonTheme.name,\n    theme: parseThemeFromJson(jsonTheme),\n    category: 'seasonal' as const,\n    palette: paletteName\n  }));\n\n  return {\n    paletteName,\n    classic,\n    seasonal\n  };\n}\n\n/**\n * All available theme groups organized by palette\n */\nexport const THEME_GROUPS: ThemeGroup[] = [\n  loadThemeGroup(cc29ThemesJson)\n];\n\n/**\n * Get all themes flattened into a single array\n */\nexport function getAllThemes(): ThemeMetadata[] {\n  return THEME_GROUPS.flatMap(group => [...group.classic, ...group.seasonal]);\n}\n\n/**\n * Get themes by palette name\n */\nexport function getThemesByPalette(paletteName: string): ThemeGroup | undefined {\n  return THEME_GROUPS.find(group => group.paletteName === paletteName);\n}\n\n/**\n * Get theme by name\n */\nexport function getThemeByName(name: string): ThemeMetadata | undefined {\n  return getAllThemes().find(t => t.name === name);\n}\n\n/**\n * Global theme state - can be modified at runtime\n */\nlet currentTheme: Theme = DARK_THEME;\nlet currentThemeMetadata: ThemeMetadata = { name: 'Dark', theme: DARK_THEME, category: 'classic', palette: 'CC-29' };\n\n/**\n * Get the current theme\n */\nexport function getTheme(): Theme {\n  return currentTheme;\n}\n\n/**\n * Get the current theme metadata\n */\nexport function getCurrentThemeMetadata(): ThemeMetadata {\n  return currentThemeMetadata;\n}\n\n/**\n * Set the current theme by metadata\n */\nexport function setThemeByMetadata(metadata: ThemeMetadata): void {\n  currentTheme = metadata.theme;\n  currentThemeMetadata = metadata;\n}\n\n/**\n * Set the current theme (legacy API)\n */\nexport function setTheme(theme: Theme): void {\n  currentTheme = theme;\n  // Try to find metadata for this theme\n  const metadata = getAllThemes().find(t => t.theme === theme);\n  if (metadata) {\n    currentThemeMetadata = metadata;\n  }\n}\n\n/**\n * Reset to default theme\n */\nexport function resetTheme(): void {\n  const defaultMetadata = getThemeByName('Dark');\n  if (defaultMetadata) {\n    setThemeByMetadata(defaultMetadata);\n  }\n}\n","/**\n * Pixel-perfect card component with drag, resize, and triple border\n */\nimport * as PIXI from 'pixi.js';\nimport { getTheme } from '../theming/theme';\nimport { GRID, BORDER, px } from 'moxi';\n\n// Re-export for backwards compatibility with editor code\nexport { GRID, BORDER, px };\n\n// UI Colors - Maps theme tokens to component usage\nexport const UI_COLORS = {\n  get cardBg() { return getTheme().backgroundSurface; },\n  get cardBorder() { return getTheme().borderStrong; },\n  get middleBorder() { return getTheme().borderSubtle; },\n  get text() { return getTheme().textPrimary; },\n  get titleBar() { return getTheme().backgroundOverlay; },\n  get selected() { return getTheme().accentPrimary; },\n  get buttonBg() { return getTheme().backgroundRaised; },\n};\n\nexport interface PixelCardOptions {\n  title: string;\n  x?: number;\n  y?: number;\n  contentWidth: number;   // In grid units\n  contentHeight: number;  // In grid units\n  renderer: PIXI.Renderer;\n  onResize?: (width: number, height: number) => void;\n  onRefresh?: () => void; // Callback when card is refreshed (e.g., theme change)\n  minContentSize?: boolean; // If true, prevents resizing below content's actual size\n  backgroundColor?: number; // Custom background color (defaults to UI_COLORS.cardBg)\n  clipContent?: boolean; // If true, clips content to container bounds (like CSS overflow: hidden)\n  pairedCard?: PixelCard; // Optional paired card that should layer together\n  onFocus?: () => void; // Callback when card is clicked/focused\n}\n\nexport interface PixelCardResizeState {\n  contentWidth: number;   // Current content width in grid units\n  contentHeight: number;  // Current content height in grid units\n  minContentWidth?: number;  // Minimum content width in grid units (when minContentSize is enabled)\n  minContentHeight?: number; // Minimum content height in grid units (when minContentSize is enabled)\n}\n\n/**\n * Creates a pixel-perfect card with drag, resize, and triple border\n */\nexport class PixelCard {\n  public container: PIXI.Container;\n  public contentContainer: PIXI.Container;\n  private titleBarHeightPx: number; // Calculated based on font size + padding\n\n  private isDragging = false;\n  private dragStartX = 0;\n  private dragStartY = 0;\n  private cardStartX = 0;\n  private cardStartY = 0;\n\n  private isResizing = false;\n  private resizeStartX = 0;\n  private resizeStartY = 0;\n  private resizeStartWidth = 0;\n  private resizeStartHeight = 0;\n  private resizeDirection: 'e' | 'w' | 's' | 'n' | 'se' | 'sw' | 'ne' | 'nw' | null = null;\n\n  private capturedPointerId: number | null = null;\n\n  private options: PixelCardOptions;\n  private state: PixelCardResizeState;\n\n  private scaleIndicator: PIXI.Container | null = null;\n  private pairedCard: PixelCard | null = null;\n  private onFocus: (() => void) | null = null;\n  private onStateChange: (() => void) | null = null;\n  private contentMask: PIXI.Graphics | null = null;\n\n  constructor(options: PixelCardOptions) {\n    this.options = options;\n    this.pairedCard = options.pairedCard ?? null;\n    this.onFocus = options.onFocus ?? null;\n\n    this.container = new PIXI.Container();\n    this.container.position.set(options.x ?? 0, options.y ?? 0);\n\n    this.contentContainer = new PIXI.Container();\n\n    this.state = {\n      contentWidth: options.contentWidth,\n      contentHeight: options.contentHeight,\n    };\n\n    // Calculate title bar height based on font size\n    // Font renders at 64px * GRID.fontScale, plus vertical padding\n    const fontHeight = 64 * GRID.fontScale;\n    const verticalPadding = px(GRID.padding * 2); // Top and bottom padding\n    this.titleBarHeightPx = Math.ceil(fontHeight + verticalPadding);\n\n    this.setupEventListeners();\n    this.redraw();\n  }\n\n  private setupEventListeners() {\n    const renderer = this.options.renderer;\n\n    const handleGlobalMove = (e: PointerEvent) => {\n      if (this.isDragging) {\n        const canvas = renderer.canvas as HTMLCanvasElement;\n        const rect = canvas.getBoundingClientRect();\n        const scaleX = canvas.width / rect.width;\n        const scaleY = canvas.height / rect.height;\n\n        const deltaScreenX = e.clientX - this.dragStartX;\n        const deltaScreenY = e.clientY - this.dragStartY;\n\n        const deltaX = deltaScreenX * scaleX;\n        const deltaY = deltaScreenY * scaleY;\n\n        this.container.x = this.cardStartX + deltaX;\n        this.container.y = this.cardStartY + deltaY;\n      } else if (this.isResizing && this.resizeDirection) {\n        const canvas = renderer.canvas as HTMLCanvasElement;\n        const rect = canvas.getBoundingClientRect();\n        const scaleX = canvas.width / rect.width;\n        const scaleY = canvas.height / rect.height;\n\n        const deltaScreenX = e.clientX - this.resizeStartX;\n        const deltaScreenY = e.clientY - this.resizeStartY;\n        const deltaX = deltaScreenX * scaleX;\n        const deltaY = deltaScreenY * scaleY;\n\n        // Calculate size changes based on direction\n        const deltaGridUnitsX = Math.round(deltaX / px(1));\n        const deltaGridUnitsY = Math.round(deltaY / px(1));\n\n        // Determine minimum sizes\n        const minWidth = this.state.minContentWidth ?? 10;\n        const minHeight = this.state.minContentHeight ?? 10;\n\n        // Horizontal resizing\n        if (this.resizeDirection.includes('e')) {\n          // East: resize right edge (width changes, position stays)\n          this.state.contentWidth = Math.max(minWidth, this.resizeStartWidth + deltaGridUnitsX);\n        } else if (this.resizeDirection.includes('w')) {\n          // West: resize left edge (position and width both change)\n          const newWidth = Math.max(minWidth, this.resizeStartWidth - deltaGridUnitsX);\n          const widthDelta = newWidth - this.resizeStartWidth; // negative when shrinking\n\n          // Position moves opposite to width change, calculated from start position\n          const newX = Math.max(0, this.cardStartX - px(widthDelta));\n          this.container.x = newX;\n          this.state.contentWidth = newWidth;\n        }\n\n        // Vertical resizing\n        if (this.resizeDirection.includes('s')) {\n          // South: resize bottom edge (height changes, position stays)\n          this.state.contentHeight = Math.max(minHeight, this.resizeStartHeight + deltaGridUnitsY);\n        } else if (this.resizeDirection.includes('n')) {\n          // North: resize top edge (position and height both change)\n          const newHeight = Math.max(minHeight, this.resizeStartHeight - deltaGridUnitsY);\n          const heightDelta = newHeight - this.resizeStartHeight; // negative when shrinking\n\n          // Position moves opposite to height change, calculated from start position\n          const newY = Math.max(0, this.cardStartY - px(heightDelta));\n          this.container.y = newY;\n          this.state.contentHeight = newHeight;\n        }\n\n        this.redraw();\n\n        // Show scale indicator\n        this.showScaleIndicator(e.clientX, e.clientY);\n\n        if (this.options.onResize) {\n          this.options.onResize(this.state.contentWidth, this.state.contentHeight);\n        }\n      }\n    };\n\n    const handleGlobalUp = () => {\n      const wasDragging = this.isDragging;\n      const wasResizing = this.isResizing;\n\n      this.isDragging = false;\n      this.isResizing = false;\n      this.resizeDirection = null;\n\n      // Release pointer capture\n      if (this.capturedPointerId !== null) {\n        const canvas = renderer.canvas as HTMLCanvasElement;\n        if (canvas) {\n          try {\n            canvas.releasePointerCapture(this.capturedPointerId);\n          } catch (e) {\n            // Ignore errors if pointer was already released\n          }\n        }\n        this.capturedPointerId = null;\n      }\n\n      // Hide scale indicator\n      this.hideScaleIndicator();\n\n      // Trigger state change callback if position or size changed\n      if ((wasDragging || wasResizing) && this.onStateChange) {\n        this.onStateChange();\n      }\n    };\n\n    if (typeof window !== 'undefined') {\n      window.addEventListener('pointermove', handleGlobalMove);\n      window.addEventListener('pointerup', handleGlobalUp);\n\n      this.container.on('destroyed', () => {\n        window.removeEventListener('pointermove', handleGlobalMove);\n        window.removeEventListener('pointerup', handleGlobalUp);\n      });\n    }\n  }\n\n  private redraw() {\n    // Clear all children except content container\n    this.container.removeChildren();\n\n    const cardWidth = BORDER.total * 2 + GRID.padding * 2 + this.state.contentWidth;\n    const cardHeight = px(BORDER.total * 2) + this.titleBarHeightPx + px(GRID.padding * 2) + px(this.state.contentHeight);\n\n    // Card background with triple border\n    const bg = new PIXI.Graphics();\n    bg.roundPixels = true;\n\n    // Shadow offset\n    const shadowOffset = px(1);\n    const shadowColor = 0x000000;\n\n    // Drop shadow (below and to the right)\n    bg.rect(shadowOffset, shadowOffset, px(cardWidth), cardHeight);\n    bg.fill({ color: shadowColor, alpha: 0.3 });\n\n    // Layer 1: Outer black border\n    bg.rect(0, 0, px(cardWidth), cardHeight);\n    bg.fill({ color: 0x000000 });\n\n    // Layer 2: Middle tan border\n    bg.rect(px(BORDER.outer), px(BORDER.outer),\n            px(cardWidth - BORDER.outer * 2), cardHeight - px(BORDER.outer * 2));\n    bg.fill({ color: UI_COLORS.middleBorder });\n\n    // Layer 3: Inner black border\n    bg.rect(px(BORDER.outer + BORDER.middle), px(BORDER.outer + BORDER.middle),\n            px(cardWidth - (BORDER.outer + BORDER.middle) * 2),\n            cardHeight - px((BORDER.outer + BORDER.middle) * 2));\n    bg.fill({ color: 0x000000 });\n\n    // Layer 4: Content background\n    bg.rect(px(BORDER.total), px(BORDER.total),\n            px(cardWidth - BORDER.total * 2), cardHeight - px(BORDER.total * 2));\n    bg.fill({ color: this.options.backgroundColor ?? UI_COLORS.cardBg });\n\n    this.container.addChild(bg);\n\n    // Title bar\n    const titleBar = new PIXI.Graphics();\n    titleBar.roundPixels = true;\n    titleBar.eventMode = 'static';\n    titleBar.cursor = 'move';\n    titleBar.rect(px(BORDER.total), px(BORDER.total),\n                  px(cardWidth - BORDER.total * 2), this.titleBarHeightPx);\n    titleBar.fill({ color: UI_COLORS.titleBar });\n\n    // Title bar dragging and focus\n    titleBar.on('pointerdown', (e: PIXI.FederatedPointerEvent) => {\n      // Trigger focus callback to bring this card to front\n      if (this.onFocus) {\n        this.onFocus();\n      }\n\n      this.isDragging = true;\n      this.cardStartX = this.container.x;\n      this.cardStartY = this.container.y;\n\n      const canvas = this.options.renderer.canvas as HTMLCanvasElement;\n      const rect = canvas.getBoundingClientRect();\n      this.dragStartX = e.client.x;\n      this.dragStartY = e.client.y;\n\n      // Capture pointer to continue receiving events even outside the window\n      if (canvas && e.pointerId !== undefined) {\n        canvas.setPointerCapture(e.pointerId);\n        this.capturedPointerId = e.pointerId;\n      }\n\n      e.stopPropagation();\n    });\n\n    this.container.addChild(titleBar);\n\n    // Title text\n    const theme = getTheme();\n    const titleText = new PIXI.BitmapText({\n      text: this.options.title,\n      style: {\n        fontFamily: 'PixelOperator8Bitmap',\n        fontSize: 64,\n        fill: theme.textPrimary,\n      }\n    });\n    titleText.roundPixels = true;\n    titleText.scale.set(GRID.fontScale); // Scale 64px down based on GRID.fontScale\n\n    const textHeight = titleText.height;\n    const verticalCenter = px(BORDER.total) + (this.titleBarHeightPx - textHeight) / 2;\n    titleText.position.set(px(BORDER.total) + 2, Math.floor(verticalCenter));\n    this.container.addChild(titleText);\n\n    // ALPHA! stamp for PIKCELL title (temporary fun branding)\n    if (this.options.title === 'PIKCELL') {\n      const alphaStamp = new PIXI.BitmapText({\n        text: 'ALPHA!',\n        style: {\n          fontFamily: 'KennyBlocksBitmap',\n          fontSize: 64,\n          fill: 0x00e436, // Lime green from PICO-8 palette\n        }\n      });\n      alphaStamp.roundPixels = true;\n      alphaStamp.anchor.set(0.5); // Center origin for rotation\n      alphaStamp.scale.set(GRID.fontScale * 1.2); // Scale up a bit\n      alphaStamp.angle = -8; // Slight counter-clockwise rotation\n\n      // Position after PIKCELL text with some spacing, adjusted for centered anchor\n      const stampX = titleText.x + titleText.width + px(2) + px(8) + px(2);\n      const stampY = verticalCenter - px(2) + px(4) - px(1);\n      alphaStamp.position.set(stampX, stampY);\n      this.container.addChild(alphaStamp);\n    }\n\n    // Position content container\n    this.contentContainer.position.set(\n      px(BORDER.total + GRID.padding),\n      px(BORDER.total) + this.titleBarHeightPx + px(GRID.padding)\n    );\n\n    // Create mask to clip content (like CSS overflow: hidden) - only if enabled\n    if (this.options.clipContent) {\n      // Reuse existing mask or create new one\n      if (!this.contentMask) {\n        this.contentMask = new PIXI.Graphics();\n      }\n\n      this.contentMask.clear();\n      this.contentMask.rect(\n        px(BORDER.total + GRID.padding),\n        px(BORDER.total) + this.titleBarHeightPx + px(GRID.padding),\n        px(this.state.contentWidth),\n        px(this.state.contentHeight)\n      );\n      this.contentMask.fill({ color: 0xffffff });\n      this.container.addChild(this.contentMask);\n      this.contentContainer.mask = this.contentMask;\n    } else {\n      this.contentContainer.mask = null;\n    }\n\n    this.container.addChild(this.contentContainer);\n\n    // Add resize handles\n    this.addResizeHandles(cardWidth, cardHeight);\n  }\n\n  private addResizeHandles(cardWidth: number, cardHeight: number) {\n    const handleThickness = px(1);\n    const cornerSize = px(2);\n\n    const createResizeHandle = (\n      x: number,\n      y: number,\n      width: number,\n      height: number,\n      cursor: string,\n      direction: 'e' | 'w' | 's' | 'n' | 'se' | 'sw' | 'ne' | 'nw'\n    ) => {\n      const handle = new PIXI.Graphics();\n      handle.roundPixels = true;\n      handle.eventMode = 'static';\n      handle.cursor = cursor;\n      handle.rect(0, 0, width, height);\n      handle.fill({ color: 0x000000, alpha: 0.01 });\n      handle.position.set(x, y);\n\n      handle.on('pointerdown', (e: PIXI.FederatedPointerEvent) => {\n        this.isResizing = true;\n        this.resizeDirection = direction;\n        this.resizeStartX = e.client.x;\n        this.resizeStartY = e.client.y;\n        this.resizeStartWidth = this.state.contentWidth;\n        this.resizeStartHeight = this.state.contentHeight;\n        this.cardStartX = this.container.x;\n        this.cardStartY = this.container.y;\n\n        // Capture pointer to continue receiving events even outside the window\n        const canvas = this.options.renderer.canvas as HTMLCanvasElement;\n        if (canvas && e.pointerId !== undefined) {\n          canvas.setPointerCapture(e.pointerId);\n          this.capturedPointerId = e.pointerId;\n        }\n\n        e.stopPropagation();\n      });\n\n      this.container.addChild(handle);\n    };\n\n    // Corners\n    createResizeHandle(0, 0, cornerSize, cornerSize, 'nwse-resize', 'nw');\n    createResizeHandle(px(cardWidth) - cornerSize, 0, cornerSize, cornerSize, 'nesw-resize', 'ne');\n    createResizeHandle(0, cardHeight - cornerSize, cornerSize, cornerSize, 'nesw-resize', 'sw');\n    createResizeHandle(px(cardWidth) - cornerSize, cardHeight - cornerSize, cornerSize, cornerSize, 'nwse-resize', 'se');\n\n    // Edges\n    createResizeHandle(cornerSize, 0, px(cardWidth) - cornerSize * 2, handleThickness, 'ns-resize', 'n');\n    createResizeHandle(cornerSize, cardHeight - handleThickness, px(cardWidth) - cornerSize * 2, handleThickness, 'ns-resize', 's');\n    createResizeHandle(0, cornerSize, handleThickness, cardHeight - cornerSize * 2, 'ew-resize', 'w');\n    createResizeHandle(px(cardWidth) - handleThickness, cornerSize, handleThickness, cardHeight - cornerSize * 2, 'ew-resize', 'e');\n  }\n\n  /**\n   * Get the content container to add custom content\n   */\n  public getContentContainer(): PIXI.Container {\n    return this.contentContainer;\n  }\n\n  /**\n   * Get current content dimensions\n   */\n  public getContentSize(): { width: number; height: number } {\n    return {\n      width: this.state.contentWidth,\n      height: this.state.contentHeight\n    };\n  }\n\n  /**\n   * Set content dimensions and redraw\n   */\n  public setContentSize(width: number, height: number) {\n    this.state.contentWidth = width;\n    this.state.contentHeight = height;\n    this.redraw();\n\n    // Trigger onResize callback so content can adapt to new size\n    if (this.options.onResize) {\n      this.options.onResize(width, height);\n    }\n  }\n\n  /**\n   * Get total card width in pixels\n   * Formula: cardWidth = px(contentWidth + BORDER.total * 2 + GRID.padding * 2)\n   */\n  public getPixelWidth(): number {\n    const cardWidthGridUnits = this.state.contentWidth + BORDER.total * 2 + GRID.padding * 2;\n    return px(cardWidthGridUnits);\n  }\n\n  /**\n   * Get total card height in pixels\n   * Formula: cardHeight = px(contentHeight) + px(BORDER.total * 2) + titleBarHeight + px(GRID.padding * 2)\n   */\n  public getPixelHeight(): number {\n    return px(this.state.contentHeight) + px(BORDER.total * 2) + this.titleBarHeightPx + px(GRID.padding * 2);\n  }\n\n  /**\n   * Manually trigger a redraw (useful after adding/changing content)\n   */\n  public refresh() {\n    this.redraw();\n\n    // Trigger content refresh callback if provided\n    if (this.options.onRefresh) {\n      this.options.onRefresh();\n    }\n  }\n\n  /**\n   * Update the card title\n   */\n  public setTitle(title: string) {\n    this.options.title = title;\n    this.redraw();\n  }\n\n  /**\n   * Set custom title bar content with left and right aligned text\n   */\n  public setTitleContent(leftText: string, rightText: string) {\n    // Store custom title content\n    this.options.title = ''; // Clear standard title\n\n    // Remove existing title text children (they have BitmapText type)\n    const titleTextChildren = this.container.children.filter(\n      child => child instanceof PIXI.BitmapText\n    );\n    titleTextChildren.forEach(child => this.container.removeChild(child));\n\n    const theme = getTheme();\n    const textY = px(BORDER.total) + (this.titleBarHeightPx - 64 * GRID.fontScale) / 2;\n\n    // Left-aligned text\n    const leftBitmapText = new PIXI.BitmapText({\n      text: leftText,\n      style: {\n        fontFamily: 'PixelOperator8Bitmap',\n        fontSize: 64,\n        fill: theme.textPrimary,\n      }\n    });\n    leftBitmapText.roundPixels = true;\n    leftBitmapText.scale.set(GRID.fontScale);\n    leftBitmapText.position.set(px(BORDER.total) + 2, Math.floor(textY));\n    this.container.addChild(leftBitmapText);\n\n    // Right-aligned text\n    const rightBitmapText = new PIXI.BitmapText({\n      text: rightText,\n      style: {\n        fontFamily: 'PixelOperator8Bitmap',\n        fontSize: 64,\n        fill: theme.textPrimary,\n      }\n    });\n    rightBitmapText.roundPixels = true;\n    rightBitmapText.scale.set(GRID.fontScale);\n\n    // Calculate card width for right alignment\n    const cardWidth = this.state.contentWidth + BORDER.total * 2 + GRID.padding * 2;\n    const rightX = px(cardWidth - BORDER.total) - rightBitmapText.width - 2;\n    rightBitmapText.position.set(rightX, Math.floor(textY));\n    this.container.addChild(rightBitmapText);\n  }\n\n  /**\n   * Set the paired card (usually set after both cards are created)\n   */\n  public setPairedCard(card: PixelCard) {\n    this.pairedCard = card;\n  }\n\n  /**\n   * Get the paired card\n   */\n  public getPairedCard(): PixelCard | null {\n    return this.pairedCard;\n  }\n\n  /**\n   * Set callback for when card state changes (position/size)\n   */\n  public onStateChanged(callback: () => void) {\n    this.onStateChange = callback;\n  }\n\n  /**\n   * Export card state for persistence\n   */\n  public exportState(id: string): { id: string; x: number; y: number; contentWidth: number; contentHeight: number; visible: boolean } {\n    return {\n      id,\n      x: this.container.x,\n      y: this.container.y,\n      contentWidth: this.state.contentWidth,\n      contentHeight: this.state.contentHeight,\n      visible: this.container.visible\n    };\n  }\n\n  /**\n   * Import card state (restore position and size)\n   */\n  public importState(state: { x: number; y: number; contentWidth: number; contentHeight: number; visible: boolean }): void {\n    this.container.position.set(state.x, state.y);\n    this.container.visible = state.visible;\n\n    if (state.contentWidth !== this.state.contentWidth ||\n        state.contentHeight !== this.state.contentHeight) {\n      this.setContentSize(state.contentWidth, state.contentHeight);\n    }\n  }\n\n  /**\n   * Updates minimum content size based on actual content bounds\n   * Call this after adding content to the content container when minContentSize is enabled\n   */\n  public updateMinContentSize() {\n    if (!this.options.minContentSize) return;\n\n    const bounds = this.contentContainer.getLocalBounds();\n\n    // Convert pixel bounds to grid units (round up to ensure content fits)\n    const minWidth = Math.ceil((bounds.x + bounds.width) / px(1));\n    const minHeight = Math.ceil((bounds.y + bounds.height) / px(1));\n\n    this.state.minContentWidth = minWidth;\n    this.state.minContentHeight = minHeight;\n\n    // Ensure current size is at least the minimum\n    if (this.state.contentWidth < minWidth || this.state.contentHeight < minHeight) {\n      this.state.contentWidth = Math.max(this.state.contentWidth, minWidth);\n      this.state.contentHeight = Math.max(this.state.contentHeight, minHeight);\n      this.redraw();\n    }\n  }\n\n  /**\n   * Shows the scale indicator near the mouse\n   */\n  private showScaleIndicator(screenX: number, screenY: number) {\n    const canvas = this.options.renderer.canvas as HTMLCanvasElement;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n\n    const canvasX = (screenX - rect.left) * scaleX;\n    const canvasY = (screenY - rect.top) * scaleY;\n\n    if (!this.scaleIndicator) {\n      this.scaleIndicator = new PIXI.Container();\n    }\n\n    // Clear and rebuild\n    this.scaleIndicator.removeChildren();\n\n    const scaleText = `${this.state.contentWidth}x${this.state.contentHeight}`;\n\n    const theme = getTheme();\n    const text = new PIXI.BitmapText({\n      text: scaleText,\n      style: {\n        fontFamily: 'PixelOperator8Bitmap',\n        fontSize: 64,\n        fill: theme.textPrimary,\n      }\n    });\n    text.roundPixels = true;\n    text.scale.set(GRID.fontScale); // Scale 64px down based on GRID.fontScale\n\n    const padding = px(2);\n    const borderWidth = px(BORDER.outer);\n    const shadowOffset = px(1);\n    const indicatorWidth = text.width + padding * 2 + borderWidth * 2;\n    const indicatorHeight = text.height + padding * 2 + borderWidth * 2;\n\n    const bg = new PIXI.Graphics();\n    bg.roundPixels = true;\n\n    // Gray drop shadow\n    bg.rect(shadowOffset, shadowOffset, indicatorWidth, indicatorHeight);\n    bg.fill({ color: UI_COLORS.titleBar });\n\n    // White outer border\n    bg.rect(0, 0, indicatorWidth, indicatorHeight);\n    bg.fill({ color: 0xffffff });\n\n    // Black background\n    bg.rect(borderWidth, borderWidth,\n            indicatorWidth - borderWidth * 2,\n            indicatorHeight - borderWidth * 2);\n    bg.fill({ color: 0x000000 });\n\n    this.scaleIndicator.addChild(bg);\n    text.position.set(borderWidth + padding, borderWidth + padding);\n    this.scaleIndicator.addChild(text);\n\n    // Position above and to the right of mouse\n    this.scaleIndicator.position.set(\n      canvasX + 10,\n      canvasY - indicatorHeight - 10\n    );\n\n    // Add to container parent (scene) not the card itself\n    if (this.container.parent) {\n      this.container.parent.addChild(this.scaleIndicator);\n    }\n  }\n\n  /**\n   * Hides the scale indicator\n   */\n  private hideScaleIndicator() {\n    if (this.scaleIndicator && this.scaleIndicator.parent) {\n      this.scaleIndicator.parent.removeChild(this.scaleIndicator);\n      this.scaleIndicator.destroy();\n      this.scaleIndicator = null;\n    }\n  }\n}\n","/**\n * Pixel-perfect button component for the sprite editor\n */\nimport * as PIXI from 'pixi.js';\nimport { GRID, px, UI_COLORS } from './pixel-card';\nimport { getTheme } from '../theming/theme';\n\nexport type SelectionMode = 'highlight' | 'press';\nexport type ActionMode = 'click' | 'toggle';\n\nexport interface PixelButtonOptions {\n  size?: number;          // Size in grid units (for square buttons)\n  width?: number;         // Width in grid units (for rectangular buttons)\n  height?: number;        // Height in grid units (for rectangular buttons)\n  selected?: boolean;\n  label?: string;\n  icon?: PIXI.Sprite | PIXI.Graphics;   // Optional icon sprite or graphic\n  backgroundColor?: number;\n  onClick?: () => void;\n  selectionMode?: SelectionMode;  // 'highlight' for swatches, 'press' for tool buttons (visual appearance)\n  actionMode?: ActionMode;        // 'click' for simple click, 'toggle' for toggleable state (behavior)\n  tooltip?: string;       // Optional tooltip text\n}\n\n/**\n * Creates a pixel-perfect button with optional label\n *\n * Selection modes (visual appearance):\n * - 'highlight': Shows orange border when selected (for color swatches)\n * - 'press': Shows pressed state with bevel (for tool buttons)\n *\n * Action modes (behavior):\n * - 'click': Simple click action, no visual state change\n * - 'toggle': Toggleable selection state (for swatches, tool groups)\n */\nexport function createPixelButton(options: PixelButtonOptions): PIXI.Graphics {\n  const {\n    size,\n    width,\n    height,\n    selected = false,\n    label,\n    icon,\n    backgroundColor = UI_COLORS.buttonBg,\n    onClick,\n    selectionMode = 'press',\n    actionMode = 'click',\n    tooltip\n  } = options;\n\n  // Auto-calculate width for text labels if not explicitly provided\n  let buttonWidth = width ?? size ?? 10;\n  const buttonHeight = height ?? size ?? 10;\n\n  // If label is provided and no explicit width, calculate based on text + padding\n  if (label && !width && !size) {\n    const tempText = new PIXI.BitmapText({\n      text: label,\n      style: {\n        fontFamily: 'PixelOperator8Bitmap',\n        fontSize: 64,\n        fill: 0xffffff,\n      }\n    });\n    tempText.scale.set(GRID.fontScale);\n\n    // Calculate text width in grid units\n    // Need to account for:\n    // - 2 border layers on each side (GRID.border * 2 on each side = 4 total)\n    // - 1 grid unit padding on each side (2 total)\n    const textWidthInGridUnits = Math.ceil(tempText.width / px(1));\n    const bordersWidth = GRID.border * 4; // 2 borders on each side\n    const paddingWidth = 2; // 1 grid unit on each side\n    buttonWidth = textWidthInGridUnits + bordersWidth + paddingWidth;\n\n    tempText.destroy();\n  }\n\n  const button = new PIXI.Graphics();\n  button.roundPixels = true;\n  button.eventMode = (onClick || tooltip) ? 'static' : 'auto';\n  button.cursor = onClick ? 'pointer' : 'default';\n\n  // Tooltip support\n  if (tooltip) {\n    let tooltipContainer: PIXI.Container | null = null;\n\n    const createTooltip = () => {\n      const tooltipContainer = new PIXI.Container();\n\n      const text = new PIXI.BitmapText({\n        text: tooltip,\n        style: {\n          fontFamily: 'PixelOperator8Bitmap',\n          fontSize: 64,\n          fill: 0xffffff,\n        }\n      });\n      text.roundPixels = true;\n      text.scale.set(GRID.fontScale); // Scale 64px down based on GRID.fontScale\n\n      const padding = px(2); // Same padding as cards\n      const borderWidth = px(GRID.border);\n      const tooltipWidth = text.width + padding * 2 + borderWidth * 2;\n      const tooltipHeight = text.height + padding * 2 + borderWidth * 2;\n\n      const bg = new PIXI.Graphics();\n      bg.roundPixels = true;\n\n      const shadowOffset = px(1);\n\n      // Gray drop shadow\n      bg.rect(shadowOffset, shadowOffset, tooltipWidth, tooltipHeight);\n      bg.fill({ color: 0x686461 }); // Same gray as title bar\n\n      // White outer border\n      bg.rect(0, 0, tooltipWidth, tooltipHeight);\n      bg.fill({ color: 0xffffff });\n\n      // Black background\n      bg.rect(borderWidth, borderWidth,\n              tooltipWidth - borderWidth * 2,\n              tooltipHeight - borderWidth * 2);\n      bg.fill({ color: 0x000000 });\n\n      tooltipContainer.addChild(bg);\n      text.position.set(borderWidth + padding, borderWidth + padding);\n      tooltipContainer.addChild(text);\n\n      return tooltipContainer;\n    };\n\n    button.on('pointerover', (e: PIXI.FederatedPointerEvent) => {\n      if (tooltipContainer) return; // Already showing\n\n      tooltipContainer = createTooltip();\n\n      // Position tooltip relative to local mouse position\n      const local = e.getLocalPosition(button);\n      tooltipContainer.position.set(local.x, local.y - tooltipContainer.height - 2);\n\n      button.addChild(tooltipContainer);\n    });\n\n    button.on('pointermove', (e: PIXI.FederatedPointerEvent) => {\n      if (tooltipContainer) {\n        // Update tooltip position to follow mouse\n        const local = e.getLocalPosition(button);\n        tooltipContainer.position.set(local.x, local.y - tooltipContainer.height - 2);\n      }\n    });\n\n    button.on('pointerout', () => {\n      if (tooltipContainer) {\n        button.removeChild(tooltipContainer);\n        tooltipContainer.destroy();\n        tooltipContainer = null;\n      }\n    });\n  }\n\n  const theme = getTheme();\n\n  if (selectionMode === 'highlight') {\n    // Highlight mode (for swatches)\n    if (selected) {\n      // Selected: accent border, then strong border, then background/color\n      button.rect(0, 0, px(buttonWidth), px(buttonHeight));\n      button.fill({ color: theme.accentPrimary });\n\n      button.rect(px(GRID.border), px(GRID.border),\n                  px(buttonWidth - GRID.border * 2), px(buttonHeight - GRID.border * 2));\n      button.fill({ color: theme.borderStrong });\n\n      button.rect(px(GRID.border * 2), px(GRID.border * 2),\n                  px(buttonWidth - GRID.border * 4), px(buttonHeight - GRID.border * 4));\n      button.fill({ color: backgroundColor });\n    } else {\n      // Unselected: border, then background/color\n      button.rect(0, 0, px(buttonWidth), px(buttonHeight));\n      button.fill({ color: theme.borderStrong });\n\n      button.rect(px(GRID.border), px(GRID.border),\n                  px(buttonWidth - GRID.border * 2), px(buttonHeight - GRID.border * 2));\n      button.fill({ color: backgroundColor });\n    }\n  } else {\n    // Press mode (for tool buttons)\n    if (selected) {\n      // Pressed: starts 1px lower, strong border, subtle border, background (no bevel)\n      // Shift everything down by 1px and reduce height by 1px\n      button.rect(0, px(1), px(buttonWidth), px(buttonHeight) - px(1));\n      button.fill({ color: theme.borderStrong });\n\n      button.rect(px(GRID.border), px(GRID.border + 1),\n                  px(buttonWidth - GRID.border * 2), px(buttonHeight - GRID.border * 2 - 1));\n      button.fill({ color: theme.borderSubtle });\n\n      button.rect(px(GRID.border * 2), px(GRID.border * 2 + 1),\n                  px(buttonWidth - GRID.border * 4), px(buttonHeight - GRID.border * 4 - 1));\n      button.fill({ color: backgroundColor });\n    } else {\n      // Unpressed: strong border, bevel at bottom (overlay layer), subtle border, background\n      button.rect(0, 0, px(buttonWidth), px(buttonHeight));\n      button.fill({ color: theme.borderStrong });\n\n      // Bevel strip at bottom (between border and inner border)\n      button.rect(px(GRID.border), px(buttonHeight - GRID.border * 2),\n                  px(buttonWidth - GRID.border * 2), px(GRID.border));\n      button.fill({ color: theme.backgroundOverlay });\n\n      // Inner border (on top, sides, and covers most of bottom except bevel)\n      button.rect(px(GRID.border), px(GRID.border),\n                  px(buttonWidth - GRID.border * 2), px(buttonHeight - GRID.border * 3));\n      button.fill({ color: theme.borderSubtle });\n\n      // Background\n      button.rect(px(GRID.border * 2), px(GRID.border * 2),\n                  px(buttonWidth - GRID.border * 4), px(buttonHeight - GRID.border * 5));\n      button.fill({ color: backgroundColor });\n    }\n  }\n\n  // Add icon if provided\n  if (icon) {\n    // When pressed in 'press' mode, shift icon down 1px with the button\n    const yOffset = (selectionMode === 'press' && selected) ? px(1) : 0;\n    icon.position.set(px(buttonWidth) / 2 - icon.width / 2, px(buttonHeight) / 2 - icon.height / 2 + yOffset);\n    button.addChild(icon);\n  }\n  // Add label if provided (and no icon)\n  else if (label) {\n    // When pressed, the whole button shifts down 1px, no additional offset needed\n    const yOffset = 0;\n\n    const buttonText = new PIXI.BitmapText({\n      text: label,\n      style: {\n        fontFamily: 'PixelOperator8Bitmap',\n        fontSize: 64,\n        fill: theme.textPrimary,\n      }\n    });\n    buttonText.roundPixels = true;\n    buttonText.scale.set(GRID.fontScale); // Scale 64px down based on GRID.fontScale\n    buttonText.anchor.set(0.5);\n    buttonText.position.set(px(buttonWidth) / 2, px(buttonHeight) / 2 + yOffset);\n    button.addChild(buttonText);\n  }\n\n  // Add click handler if provided\n  if (onClick) {\n    button.on('pointerdown', (e: PIXI.FederatedPointerEvent) => {\n      onClick();\n      e.stopPropagation();\n    });\n  }\n\n  return button;\n}\n","/**\n * Pixel-perfect dialog component built on top of PixelCard\n */\nimport * as PIXI from 'pixi.js';\nimport { PixelCard, GRID, px } from './pixel-card';\nimport { createPixelButton } from './pixel-button';\nimport { createPixelCheckbox } from './pixel-checkbox';\nimport { getTheme } from '../theming/theme';\n\nexport interface DialogButton {\n  label: string;\n  onClick: (checkboxStates?: Record<string, boolean>) => void;\n}\n\nexport interface DialogCheckbox {\n  name: string;\n  label: string;\n  defaultValue?: boolean;\n}\n\nexport interface PixelDialogOptions {\n  title: string;\n  message: string;\n  buttons: DialogButton[];\n  checkboxes?: DialogCheckbox[];\n  renderer: PIXI.Renderer;\n}\n\n/**\n * Creates a pixel-perfect dialog centered on screen\n * Returns a container with the dialog and a semi-transparent backdrop\n */\nexport function createPixelDialog(options: PixelDialogOptions): PIXI.Container {\n  const { title, message, buttons, checkboxes = [], renderer } = options;\n\n  // Create overlay container\n  const overlay = new PIXI.Container();\n\n  // Semi-transparent backdrop\n  const backdrop = new PIXI.Graphics();\n  backdrop.rect(0, 0, renderer.width, renderer.height);\n  backdrop.fill({ color: 0x000000, alpha: 0.5 });\n  backdrop.eventMode = 'static'; // Block clicks to elements below\n  overlay.addChild(backdrop);\n\n  // Track checkbox states\n  const checkboxStates: Record<string, boolean> = {};\n  checkboxes.forEach(cb => {\n    checkboxStates[cb.name] = cb.defaultValue ?? false;\n  });\n\n  // Calculate dialog dimensions\n  const buttonWidth = 30; // Grid units per button\n  const buttonHeight = 12; // Grid units\n  const buttonSpacing = px(2);\n  const checkboxHeight = 8; // Grid units per checkbox\n  const messageMargin = px(4);\n\n  // Create message text to measure it\n  const theme = getTheme();\n  const messageText = new PIXI.BitmapText({\n    text: message,\n    style: {\n      fontFamily: 'PixelOperator8Bitmap',\n      fontSize: 64,\n      fill: theme.textPrimary,\n    }\n  });\n  messageText.roundPixels = true;\n  messageText.scale.set(GRID.fontScale);\n\n  // Calculate content dimensions based on message, checkboxes, and buttons\n  const messageWidthInGridUnits = Math.ceil(messageText.width / px(1));\n  const buttonsWidthInGridUnits = buttons.length * buttonWidth + (buttons.length - 1) * (buttonSpacing / px(1));\n  const contentWidth = Math.max(messageWidthInGridUnits, buttonsWidthInGridUnits) + 4; // +4 for margins\n\n  const messageHeightInGridUnits = Math.ceil(messageText.height / px(1));\n  const checkboxesHeightInGridUnits = checkboxes.length > 0 ? checkboxes.length * checkboxHeight + 2 : 0;\n  const verticalSpacing = 4; // Grid units between sections\n  const contentHeight = messageHeightInGridUnits + checkboxesHeightInGridUnits + verticalSpacing + buttonHeight + 4; // +4 for top/bottom margins\n\n  // Create dialog card\n  const dialogCard = new PixelCard({\n    title,\n    x: 0, // Will be centered\n    y: 0,\n    contentWidth,\n    contentHeight,\n    renderer,\n    minContentSize: true\n  });\n\n  const contentContainer = dialogCard.getContentContainer();\n\n  // Add message text\n  const messageY = px(2);\n  messageText.position.set(px(2), messageY);\n  contentContainer.addChild(messageText);\n\n  // Add checkboxes\n  let checkboxY = messageY + messageText.height + px(4); // message position + message height + 4 grid units (16px at 4x scale)\n  checkboxes.forEach((checkboxConfig) => {\n    const checkbox = createPixelCheckbox({\n      label: checkboxConfig.label,\n      checked: checkboxStates[checkboxConfig.name],\n      onChange: (checked) => {\n        checkboxStates[checkboxConfig.name] = checked;\n      }\n    });\n    checkbox.position.set(px(2), checkboxY);\n    contentContainer.addChild(checkbox);\n\n    // Get actual height of checkbox container for proper spacing\n    const checkboxContainer = checkbox as PIXI.Container;\n    checkboxY += checkboxContainer.height + px(1); // Add spacing between checkboxes\n  });\n\n  // Add buttons\n  const buttonY = px(messageHeightInGridUnits + checkboxesHeightInGridUnits + verticalSpacing + 2);\n  let currentX = px((contentWidth - buttonsWidthInGridUnits) / 2); // Center buttons\n\n  buttons.forEach((buttonConfig, index) => {\n    const button = createPixelButton({\n      width: buttonWidth,\n      height: buttonHeight,\n      label: buttonConfig.label,\n      selectionMode: 'press',\n      actionMode: 'click',\n      onClick: () => {\n        buttonConfig.onClick(checkboxStates);\n        // Close dialog when button is clicked\n        overlay.destroy();\n      }\n    });\n    button.position.set(currentX, buttonY);\n    contentContainer.addChild(button);\n    currentX += px(buttonWidth) + buttonSpacing;\n  });\n\n  // Center dialog on screen\n  const dialogBounds = dialogCard.container.getBounds();\n  dialogCard.container.position.set(\n    (renderer.width - dialogBounds.width) / 2,\n    (renderer.height - dialogBounds.height) / 2\n  );\n\n  overlay.addChild(dialogCard.container);\n\n  return overlay;\n}\n","/**\n * Pixel-perfect checkbox component\n */\nimport * as PIXI from 'pixi.js';\nimport { GRID, px } from './pixel-card';\nimport { createPixelButton } from './pixel-button';\n\nexport interface PixelCheckboxOptions {\n  label: string;\n  checked?: boolean;\n  onChange?: (checked: boolean) => void;\n}\n\n/**\n * Creates a pixel-perfect checkbox with label\n * Returns a container with the checkbox and label\n */\nexport function createPixelCheckbox(options: PixelCheckboxOptions): PIXI.Container {\n  const { label, checked = false, onChange } = options;\n\n  const container = new PIXI.Container();\n\n  let isChecked = checked;\n  const checkboxSize = 6; // Grid units for checkbox square\n\n  // Checkbox label\n  const checkboxLabel = new PIXI.BitmapText({\n    text: label,\n    style: {\n      fontFamily: 'PixelOperator8Bitmap',\n      fontSize: 64,\n      fill: 0x000000,\n    }\n  });\n  checkboxLabel.roundPixels = true;\n  checkboxLabel.scale.set(GRID.fontScale);\n  checkboxLabel.position.set(px(checkboxSize + 2), 0);\n  container.addChild(checkboxLabel);\n\n  // Create checkbox button (centered vertically with label)\n  const checkboxHeight = px(checkboxSize);\n  const labelHeight = checkboxLabel.height;\n  const checkboxY = (labelHeight - checkboxHeight) / 2;\n\n  const checkbox = createPixelButton({\n    size: checkboxSize,\n    selected: isChecked,\n    selectionMode: 'highlight',\n    actionMode: 'toggle',\n    backgroundColor: 0xffffff,\n    onClick: () => {\n      isChecked = !isChecked;\n      if (onChange) {\n        onChange(isChecked);\n      }\n    }\n  });\n  checkbox.position.set(0, checkboxY);\n  container.addChild(checkbox);\n\n  return container;\n}\n","/**\n * Sprite sheet controller - manages sprite data and interactions independently of the card\n */\nimport * as PIXI from 'pixi.js';\nimport { px } from '../components/pixel-card';\n\nexport type SpriteSheetType = 'PICO-8' | 'TIC-80';\n\nexport interface SpriteSheetConfig {\n  type: SpriteSheetType;\n  width: number;   // In pixels\n  height: number;  // In pixels\n  palette: number[]; // Array of color values\n}\n\nexport interface SpriteSheetControllerOptions {\n  config: SpriteSheetConfig;\n  renderer: PIXI.Renderer;\n  showGrid?: boolean;\n  onScaleChange?: (scale: number) => void;\n  onCellHover?: (cellX: number, cellY: number) => void;\n  onCellClick?: (cellX: number, cellY: number) => void;\n}\n\n/**\n * Controller for managing sprite sheet state and rendering\n */\nexport class SpriteSheetController {\n  private config: SpriteSheetConfig;\n  private renderer: PIXI.Renderer;\n  private scale: number = 1;\n  private pixels: number[][]; // 2D array of color indices\n  private texture: PIXI.Texture | null = null;\n  private sprite: PIXI.Sprite | null = null;\n  private showGrid: boolean;\n  private onScaleChange?: (scale: number) => void;\n  private onCellHover?: (cellX: number, cellY: number) => void;\n  private onCellClick?: (cellX: number, cellY: number) => void;\n  private isPanning: boolean = false;\n  private panStartX: number = 0;\n  private panStartY: number = 0;\n  private spriteStartX: number = 0;\n  private spriteStartY: number = 0;\n  private cellOverlay: PIXI.Graphics | null = null;\n  private selectedCellX: number = -1;\n  private selectedCellY: number = -1;\n  private hoveredCellX: number = -1;\n  private hoveredCellY: number = -1;\n  private interactionSetup: boolean = false;\n  private isDragging: boolean = false;\n  private dragStartX: number = 0;\n  private dragStartY: number = 0;\n  private clickThreshold: number = 5; // Pixels of movement before it's considered a drag\n\n  constructor(options: SpriteSheetControllerOptions) {\n    this.config = options.config;\n    this.renderer = options.renderer;\n    this.showGrid = options.showGrid ?? false;\n    this.onScaleChange = options.onScaleChange;\n    this.onCellHover = options.onCellHover;\n    this.onCellClick = options.onCellClick;\n\n    // Calculate initial scale to fit nicely (50% of viewport height)\n    const targetHeight = this.renderer.height * 0.5;\n    this.scale = Math.max(1, Math.floor(targetHeight / this.config.height));\n\n    // Initialize pixel data (all set to first palette color)\n    this.pixels = [];\n    for (let y = 0; y < this.config.height; y++) {\n      this.pixels[y] = [];\n      for (let x = 0; x < this.config.width; x++) {\n        this.pixels[y][x] = 0; // Default to first palette color\n      }\n    }\n\n    // Setup mouse wheel zoom\n    this.setupMouseWheelZoom();\n\n    // Setup middle mouse button pan\n    this.setupMiddleMousePan();\n  }\n\n  /**\n   * Setup mouse wheel zoom handler\n   * Based on: https://stackoverflow.com/questions/75969167/pixi-js-zoom-to-mouse-position\n   */\n  private setupMouseWheelZoom() {\n    if (typeof window !== 'undefined') {\n      const handleWheel = (e: WheelEvent) => {\n        if (!this.sprite) return;\n\n        // Get canvas bounds\n        const canvas = this.renderer.canvas as HTMLCanvasElement;\n        const rect = canvas.getBoundingClientRect();\n        const canvasScaleX = canvas.width / rect.width;\n        const canvasScaleY = canvas.height / rect.height;\n\n        // Convert client coordinates to canvas coordinates\n        const mouseX = (e.clientX - rect.left) * canvasScaleX;\n        const mouseY = (e.clientY - rect.top) * canvasScaleY;\n\n        // Get sprite sheet bounds\n        const bounds = this.sprite.getBounds();\n\n        // Check if mouse is over the sprite sheet\n        if (mouseX >= bounds.x && mouseX <= bounds.x + bounds.width &&\n            mouseY >= bounds.y && mouseY <= bounds.y + bounds.height) {\n          e.preventDefault();\n\n          // Get parent container offset\n          const parentBounds = this.sprite.parent.getBounds();\n\n          // Calculate mouse position relative to sprite center (accounting for anchor 0.5, 0.5)\n          const spriteCenterX = parentBounds.x + this.sprite.x;\n          const spriteCenterY = parentBounds.y + this.sprite.y;\n\n          // Current scale\n          const oldScale = this.sprite.scale.x;\n\n          // Mouse position in sprite's local space (unscaled, relative to center due to anchor)\n          const localX = (mouseX - spriteCenterX) / oldScale;\n          const localY = (mouseY - spriteCenterY) / oldScale;\n\n          // Calculate new scale\n          const zoomDelta = e.deltaY > 0 ? -0.5 : 0.5;\n          const newScale = Math.max(1, Math.min(16, this.scale + zoomDelta));\n\n          if (newScale !== this.scale) {\n            // Reposition sprite so the local point under mouse stays at same screen position\n            this.sprite.x = mouseX - parentBounds.x - (localX * newScale);\n            this.sprite.y = mouseY - parentBounds.y - (localY * newScale);\n\n            // Update scale\n            this.setScale(newScale);\n          }\n        }\n      };\n\n      window.addEventListener('wheel', handleWheel, { passive: false });\n    }\n  }\n\n  /**\n   * Setup middle mouse button pan handler\n   */\n  private setupMiddleMousePan() {\n    if (typeof window !== 'undefined') {\n      const handleMouseDown = (e: MouseEvent) => {\n        if (e.button !== 1 || !this.sprite) return; // Middle button only\n\n        // Get canvas bounds\n        const canvas = this.renderer.canvas as HTMLCanvasElement;\n        const rect = canvas.getBoundingClientRect();\n        const scaleX = canvas.width / rect.width;\n        const scaleY = canvas.height / rect.height;\n\n        // Convert client coordinates to canvas coordinates\n        const canvasX = (e.clientX - rect.left) * scaleX;\n        const canvasY = (e.clientY - rect.top) * scaleY;\n\n        // Get sprite sheet bounds\n        const bounds = this.sprite.getBounds();\n\n        // Check if mouse is over the sprite sheet\n        if (canvasX >= bounds.x && canvasX <= bounds.x + bounds.width &&\n            canvasY >= bounds.y && canvasY <= bounds.y + bounds.height) {\n          e.preventDefault();\n          this.isPanning = true;\n          this.panStartX = e.clientX;\n          this.panStartY = e.clientY;\n          this.spriteStartX = this.sprite.x;\n          this.spriteStartY = this.sprite.y;\n        }\n      };\n\n      const handleMouseMove = (e: MouseEvent) => {\n        if (!this.isPanning || !this.sprite) return;\n\n        e.preventDefault();\n\n        // Get canvas bounds for scaling\n        const canvas = this.renderer.canvas as HTMLCanvasElement;\n        const rect = canvas.getBoundingClientRect();\n        const scaleX = canvas.width / rect.width;\n        const scaleY = canvas.height / rect.height;\n\n        // Calculate delta in screen space, then convert to canvas space\n        const deltaScreenX = e.clientX - this.panStartX;\n        const deltaScreenY = e.clientY - this.panStartY;\n        const deltaX = deltaScreenX * scaleX;\n        const deltaY = deltaScreenY * scaleY;\n\n        // Update sprite position\n        this.sprite.x = this.spriteStartX + deltaX;\n        this.sprite.y = this.spriteStartY + deltaY;\n      };\n\n      const handleMouseUp = (e: MouseEvent) => {\n        if (e.button === 1) { // Middle button\n          this.isPanning = false;\n        }\n      };\n\n      window.addEventListener('mousedown', handleMouseDown);\n      window.addEventListener('mousemove', handleMouseMove);\n      window.addEventListener('mouseup', handleMouseUp);\n    }\n  }\n\n  /**\n   * Get the current scale\n   */\n  public getScale(): number {\n    return this.scale;\n  }\n\n  /**\n   * Set the scale (supports smooth/fractional scaling)\n   */\n  public setScale(newScale: number) {\n    const clampedScale = Math.max(1, Math.min(16, newScale));\n    // Allow smooth scaling - no rounding to integers\n    if (clampedScale !== this.scale) {\n      this.scale = clampedScale;\n      if (this.onScaleChange) {\n        this.onScaleChange(this.scale);\n      }\n    }\n  }\n\n  /**\n   * Get the sprite sheet config\n   */\n  public getConfig(): SpriteSheetConfig {\n    return this.config;\n  }\n\n  /**\n   * Get the scaled dimensions\n   */\n  public getScaledDimensions(): { width: number; height: number } {\n    return {\n      width: this.config.width * this.scale,\n      height: this.config.height * this.scale\n    };\n  }\n\n  /**\n   * Get pixel color at coordinates\n   */\n  public getPixel(x: number, y: number): number {\n    if (x < 0 || x >= this.config.width || y < 0 || y >= this.config.height) {\n      return 0;\n    }\n    return this.pixels[y][x];\n  }\n\n  /**\n   * Set pixel color at coordinates\n   */\n  public setPixel(x: number, y: number, colorIndex: number) {\n    if (x < 0 || x >= this.config.width || y < 0 || y >= this.config.height) {\n      return;\n    }\n    if (colorIndex < 0 || colorIndex >= this.config.palette.length) {\n      return;\n    }\n    this.pixels[y][x] = colorIndex;\n  }\n\n  /**\n   * Update the texture from pixel data\n   */\n  private updateTexture() {\n    // Create canvas to draw pixel data\n    const canvas = document.createElement('canvas');\n    canvas.width = this.config.width;\n    canvas.height = this.config.height;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    // Draw each pixel to canvas\n    for (let y = 0; y < this.config.height; y++) {\n      for (let x = 0; x < this.config.width; x++) {\n        const colorIndex = this.pixels[y][x];\n        const color = this.config.palette[colorIndex];\n\n        // Convert color to CSS format\n        const r = (color >> 16) & 0xff;\n        const g = (color >> 8) & 0xff;\n        const b = color & 0xff;\n        ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;\n        ctx.fillRect(x, y, 1, 1);\n      }\n    }\n\n    // Bake grid into texture if enabled\n    if (this.showGrid) {\n      const gridSize = 8;\n      ctx.strokeStyle = 'rgba(128, 128, 128, 0.3)'; // Gray with 30% opacity\n      ctx.lineWidth = 1;\n\n      // Draw vertical grid lines\n      for (let x = gridSize; x < this.config.width; x += gridSize) {\n        ctx.beginPath();\n        ctx.moveTo(x, 0);\n        ctx.lineTo(x, this.config.height);\n        ctx.stroke();\n      }\n\n      // Draw horizontal grid lines\n      for (let y = gridSize; y < this.config.height; y += gridSize) {\n        ctx.beginPath();\n        ctx.moveTo(0, y);\n        ctx.lineTo(this.config.width, y);\n        ctx.stroke();\n      }\n    }\n\n    // Destroy old texture if exists\n    if (this.texture) {\n      this.texture.destroy(true);\n    }\n\n    // Create texture from canvas with nearest neighbor scaling\n    this.texture = PIXI.Texture.from(canvas);\n    this.texture.source.scaleMode = 'nearest';\n  }\n\n  /**\n   * Draw the cell overlay (highlighting selected/hovered cells)\n   */\n  private drawCellOverlay() {\n    if (!this.cellOverlay || !this.sprite) return;\n\n    this.cellOverlay.clear();\n\n    const cellSize = 8 * this.scale;\n    // Sprite has anchor (0.5, 0.5), so adjust for centered origin\n    const spriteX = this.sprite.x - (this.config.width * this.scale) / 2;\n    const spriteY = this.sprite.y - (this.config.height * this.scale) / 2;\n\n    // Draw selected cell first (strong highlight) - behind hover\n    if (this.selectedCellX >= 0 && this.selectedCellY >= 0) {\n      this.cellOverlay.rect(\n        spriteX + this.selectedCellX * cellSize,\n        spriteY + this.selectedCellY * cellSize,\n        cellSize,\n        cellSize\n      );\n      this.cellOverlay.stroke({ color: 0xffec27, width: 2 }); // Yellow highlight\n    }\n\n    // Draw hovered cell on top (subtle highlight)\n    if (this.hoveredCellX >= 0 && this.hoveredCellY >= 0) {\n      this.cellOverlay.rect(\n        spriteX + this.hoveredCellX * cellSize,\n        spriteY + this.hoveredCellY * cellSize,\n        cellSize,\n        cellSize\n      );\n      this.cellOverlay.stroke({ color: 0xffffff, width: 1, alpha: 0.5 });\n    }\n  }\n\n  /**\n   * Setup cell interaction handlers\n   */\n  private setupCellInteraction(container: PIXI.Container) {\n    if (!this.onCellHover && !this.onCellClick) return;\n    if (this.interactionSetup) return; // Already set up\n\n    this.interactionSetup = true;\n    container.eventMode = 'static';\n    container.cursor = 'pointer';\n\n    container.on('pointermove', (e: PIXI.FederatedPointerEvent) => {\n      if (!this.sprite) return;\n\n      // Convert to sprite-local coordinates (unscaled, centered at origin)\n      const spriteLocal = e.getLocalPosition(this.sprite);\n      const cellSize = 8; // Cell size in texture space (unscaled)\n\n      // Adjust for centered anchor (sprite origin is at center)\n      const adjustedX = spriteLocal.x + (this.config.width / 2);\n      const adjustedY = spriteLocal.y + (this.config.height / 2);\n\n      const cellX = Math.floor(adjustedX / cellSize);\n      const cellY = Math.floor(adjustedY / cellSize);\n\n      const maxCellX = Math.floor(this.config.width / 8) - 1;\n      const maxCellY = Math.floor(this.config.height / 8) - 1;\n\n      if (cellX >= 0 && cellX <= maxCellX && cellY >= 0 && cellY <= maxCellY) {\n        if (cellX !== this.hoveredCellX || cellY !== this.hoveredCellY) {\n          this.hoveredCellX = cellX;\n          this.hoveredCellY = cellY;\n          this.drawCellOverlay();\n          if (this.onCellHover) {\n            this.onCellHover(cellX, cellY);\n          }\n        }\n      } else {\n        if (this.hoveredCellX !== -1 || this.hoveredCellY !== -1) {\n          this.hoveredCellX = -1;\n          this.hoveredCellY = -1;\n          this.drawCellOverlay();\n        }\n      }\n    });\n\n    container.on('pointerout', () => {\n      this.hoveredCellX = -1;\n      this.hoveredCellY = -1;\n      this.drawCellOverlay();\n    });\n\n    // Click and drag interaction\n    container.on('pointerdown', (e: PIXI.FederatedPointerEvent) => {\n      if (!this.sprite) return;\n\n      this.isDragging = false;\n      this.dragStartX = e.global.x;\n      this.dragStartY = e.global.y;\n      this.spriteStartX = this.sprite.x;\n      this.spriteStartY = this.sprite.y;\n    });\n\n    container.on('globalpointermove', (e: PIXI.FederatedPointerEvent) => {\n      if (!this.sprite) return;\n\n      // Check if we've moved beyond the click threshold\n      const dx = e.global.x - this.dragStartX;\n      const dy = e.global.y - this.dragStartY;\n      const distance = Math.sqrt(dx * dx + dy * dy);\n\n      if (distance > this.clickThreshold && (this.dragStartX !== 0 || this.dragStartY !== 0)) {\n        this.isDragging = true;\n        // Pan the sprite\n        this.sprite.x = this.spriteStartX + dx;\n        this.sprite.y = this.spriteStartY + dy;\n      }\n    });\n\n    container.on('pointerup', () => {\n      // If we didn't drag, it's a click - select the cell\n      if (!this.isDragging && this.onCellClick) {\n        if (this.hoveredCellX >= 0 && this.hoveredCellY >= 0) {\n          this.selectedCellX = this.hoveredCellX;\n          this.selectedCellY = this.hoveredCellY;\n          this.drawCellOverlay();\n          this.onCellClick!(this.selectedCellX, this.selectedCellY);\n        }\n      }\n\n      // Reset drag state\n      this.isDragging = false;\n      this.dragStartX = 0;\n      this.dragStartY = 0;\n    });\n\n    container.on('pointerupoutside', () => {\n      // Reset drag state\n      this.isDragging = false;\n      this.dragStartX = 0;\n      this.dragStartY = 0;\n    });\n\n    // Update overlay continuously to follow sprite when panning\n    if (typeof window !== 'undefined') {\n      const updateOverlay = () => {\n        this.drawCellOverlay();\n        requestAnimationFrame(updateOverlay);\n      };\n      requestAnimationFrame(updateOverlay);\n    }\n  }\n\n  /**\n   * Render the sprite sheet\n   */\n  public render(container: PIXI.Container) {\n    // Preserve position if sprite already exists\n    const preservedX = this.sprite?.x;\n    const preservedY = this.sprite?.y;\n\n    // Remove old sprite if it exists\n    if (this.sprite) {\n      container.removeChild(this.sprite);\n    }\n\n    // Remove old overlay if it exists\n    if (this.cellOverlay) {\n      container.removeChild(this.cellOverlay);\n    }\n\n    // Update texture from pixel data (with grid baked in if enabled)\n    this.updateTexture();\n\n    if (!this.texture) return;\n\n    // Create sprite from texture\n    this.sprite = new PIXI.Sprite(this.texture);\n    this.sprite.anchor.set(0.5, 0.5); // Center origin for zoom\n    this.sprite.scale.set(this.scale);\n\n    // Use preserved position if available, otherwise center it\n    if (preservedX !== undefined && preservedY !== undefined) {\n      this.sprite.x = preservedX;\n      this.sprite.y = preservedY;\n    } else {\n      // Initial position at center of texture dimensions\n      this.sprite.x = (this.config.width * this.scale) / 2;\n      this.sprite.y = (this.config.height * this.scale) / 2;\n    }\n\n    container.addChild(this.sprite);\n\n    // Create and add cell overlay AFTER sprite (so it renders on top)\n    this.cellOverlay = new PIXI.Graphics();\n    this.cellOverlay.roundPixels = true;\n    container.addChild(this.cellOverlay);\n\n    // Setup cell interaction once\n    if (this.onCellHover || this.onCellClick) {\n      this.setupCellInteraction(container);\n    }\n\n    // Initial overlay draw\n    this.drawCellOverlay();\n  }\n\n  /**\n   * Programmatically select a cell\n   */\n  public selectCell(cellX: number, cellY: number) {\n    this.selectedCellX = cellX;\n    this.selectedCellY = cellY;\n    this.drawCellOverlay();\n\n    // Trigger onCellClick callback to update title\n    if (this.onCellClick) {\n      this.onCellClick(cellX, cellY);\n    }\n  }\n\n  /**\n   * Clear all pixels to a specific color\n   */\n  public clear(colorIndex: number = 0) {\n    for (let y = 0; y < this.config.height; y++) {\n      for (let x = 0; x < this.config.width; x++) {\n        this.pixels[y][x] = colorIndex;\n      }\n    }\n  }\n\n  /**\n   * Convert screen coordinates to sprite pixel coordinates\n   */\n  public screenToPixel(screenX: number, screenY: number): { x: number; y: number } | null {\n    const pixelX = Math.floor(screenX / this.scale);\n    const pixelY = Math.floor(screenY / this.scale);\n\n    if (pixelX < 0 || pixelX >= this.config.width || pixelY < 0 || pixelY >= this.config.height) {\n      return null;\n    }\n\n    return { x: pixelX, y: pixelY };\n  }\n\n  /**\n   * Get all pixel data (for saving)\n   */\n  public getPixelData(): number[][] {\n    // Return a deep copy to prevent external mutation\n    return this.pixels.map(row => [...row]);\n  }\n\n  /**\n   * Set all pixel data (for loading)\n   */\n  public setPixelData(pixels: number[][]): void {\n    // Validate dimensions match\n    if (pixels.length !== this.config.height) {\n      console.error('Pixel data height mismatch');\n      return;\n    }\n    if (pixels[0]?.length !== this.config.width) {\n      console.error('Pixel data width mismatch');\n      return;\n    }\n\n    // Deep copy the pixel data\n    this.pixels = pixels.map(row => [...row]);\n  }\n\n  /**\n   * Get current selected cell\n   */\n  public getSelectedCell(): { x: number; y: number } {\n    return { x: this.selectedCellX, y: this.selectedCellY };\n  }\n\n  /**\n   * Position the sprite so that cell 0,0 is at the top-left corner of the content container\n   */\n  public positionCell00AtTopLeft(): void {\n    if (!this.sprite) return;\n\n    // With anchor (0.5, 0.5), to position cell 0,0 at top-left (0,0) of content container:\n    // sprite position = (width * scale) / 2, (height * scale) / 2\n    this.sprite.x = (this.config.width * this.scale) / 2;\n    this.sprite.y = (this.config.height * this.scale) / 2;\n\n    // Redraw overlay to reflect new position\n    this.drawCellOverlay();\n  }\n\n  /**\n   * Center a specific cell in the viewport\n   * Positions the sprite so the given cell is centered in the content container\n   */\n  public centerCell(cellX: number, cellY: number, containerWidth: number, containerHeight: number): void {\n    if (!this.sprite) return;\n\n    const cellSize = 8; // Each cell is 8x8 pixels\n\n    // Calculate the center of the cell in sprite-local coordinates (unscaled)\n    const cellCenterX = (cellX * cellSize) + (cellSize / 2);\n    const cellCenterY = (cellY * cellSize) + (cellSize / 2);\n\n    // Calculate the center of the container\n    const containerCenterX = containerWidth / 2;\n    const containerCenterY = containerHeight / 2;\n\n    // With anchor (0.5, 0.5), sprite position (0,0) corresponds to sprite center\n    // To center a cell: position sprite so that cell's scaled position aligns with container center\n    // sprite.x + (cellLocalX - spriteLocalCenterX) * scale = containerCenterX\n\n    const spriteCenterX = this.config.width / 2;\n    const spriteCenterY = this.config.height / 2;\n\n    this.sprite.x = containerCenterX - (cellCenterX - spriteCenterX) * this.scale;\n    this.sprite.y = containerCenterY - (cellCenterY - spriteCenterY) * this.scale;\n\n    // Redraw overlay to reflect new position\n    this.drawCellOverlay();\n  }\n}\n","/**\n * Sprite sheet card component for displaying and editing sprite sheets\n */\nimport * as PIXI from 'pixi.js';\nimport { PixelCard, GRID, px } from './pixel-card';\nimport { SpriteSheetController, SpriteSheetConfig, SpriteSheetType } from '../controllers/sprite-sheet-controller';\nimport { createCheckerboardTexture } from '../utilities/texture-utils';\n\nexport { SpriteSheetType, SpriteSheetConfig };\n\n// Sprite sheet configurations\nexport const SPRITESHEET_CONFIGS: Record<SpriteSheetType, SpriteSheetConfig> = {\n  'PICO-8': {\n    type: 'PICO-8',\n    width: 128,\n    height: 128,\n    palette: [\n      0x000000, 0x1d2b53, 0x7e2553, 0x008751,\n      0xab5236, 0x5f574f, 0xc2c3c7, 0xfff1e8,\n      0xff004d, 0xffa300, 0xffec27, 0x00e436,\n      0x29adff, 0x83769c, 0xff77a8, 0xffccaa\n    ]\n  },\n  'TIC-80': {\n    type: 'TIC-80',\n    width: 256,\n    height: 256,\n    palette: [\n      0x140c1c, 0x442434, 0x30346d, 0x4e4a4e,\n      0x854c30, 0x346524, 0xd04648, 0x757161,\n      0x597dce, 0xd27d2c, 0x8595a1, 0x6daa2c,\n      0xd2aa99, 0x6dc2ca, 0xdad45e, 0xdeeed6\n    ]\n  }\n};\n\nexport interface SpriteSheetCardOptions {\n  config: SpriteSheetConfig;\n  x?: number;\n  y?: number;\n  renderer: PIXI.Renderer;\n  showGrid?: boolean;\n  onCellHover?: (cellX: number, cellY: number) => void;\n  onCellClick?: (cellX: number, cellY: number) => void;\n  onFocus?: () => void;\n}\n\nexport interface SpriteSheetCardResult {\n  card: PixelCard;\n  controller: SpriteSheetController;\n}\n\n/**\n * Creates a sprite sheet card with a canvas for editing\n */\nexport function createSpriteSheetCard(options: SpriteSheetCardOptions): SpriteSheetCardResult {\n  const { config, x, y, renderer, showGrid = false, onCellHover, onCellClick, onFocus } = options;\n\n  let card: PixelCard;\n  let contentContainer: PIXI.Container;\n  let gridBackground: PIXI.TilingSprite;\n\n  // Create sprite sheet controller\n  const controller = new SpriteSheetController({\n    config,\n    renderer,\n    showGrid,\n    onScaleChange: (newScale) => {\n      // Update card title when scale changes\n      const cell = controller.getSelectedCell();\n      const cellText = cell ? `${cell.x},${cell.y}` : 'grid-cell';\n      card.setTitle(`${cellText} | ${newScale.toFixed(2)}x`);\n      // Re-render the sprite sheet\n      controller.render(contentContainer);\n    },\n    onCellHover,\n    onCellClick: (cellX, cellY) => {\n      // Update title when cell is selected\n      card.setTitle(`${cellX},${cellY} | ${controller.getScale().toFixed(2)}x`);\n      // Call original onCellClick if provided\n      if (onCellClick) {\n        onCellClick(cellX, cellY);\n      }\n    }\n  });\n\n  // Get initial scaled dimensions\n  const { width: scaledWidth, height: scaledHeight } = controller.getScaledDimensions();\n\n  // Convert pixel dimensions to grid units\n  const contentWidth = Math.ceil(scaledWidth / px(1));\n  const contentHeight = Math.ceil(scaledHeight / px(1));\n\n  // Default position to bottom right (minimap style) if not specified\n  const cardPadding = px(GRID.padding * 2) + px(6); // padding + border\n  const titleBarHeight = 24; // Title bar height in pixels\n  const margin = 20; // Margin from edges\n  const defaultX = x ?? (renderer.width - px(contentWidth) - cardPadding - margin);\n  const defaultY = y ?? (renderer.height - px(contentHeight) - cardPadding - titleBarHeight - margin);\n\n  card = new PixelCard({\n    title: `grid-cell | ${controller.getScale().toFixed(2)}x`,\n    x: defaultX,\n    y: defaultY,\n    contentWidth,\n    contentHeight,\n    renderer,\n    clipContent: true, // Enable clipping for sprite sheet (overflow: hidden)\n    onFocus,\n    onResize: (width, height) => {\n      // Update tiled background size when card is resized\n      if (gridBackground) {\n        gridBackground.width = px(width);\n        gridBackground.height = px(height);\n      }\n    }\n  });\n\n  contentContainer = card.getContentContainer();\n\n  // Create tiled grid background using utility\n  const gridTexture = createCheckerboardTexture(16, 0x2a2a3a, 0x353545);\n  gridBackground = new PIXI.TilingSprite({\n    texture: gridTexture,\n    width: px(contentWidth),\n    height: px(contentHeight)\n  });\n  gridBackground.tileScale.set(1, 1);\n  contentContainer.addChildAt(gridBackground, 0); // Add as first child (behind everything)\n\n  // Initial render - controller now handles cell selection/highlighting\n  controller.render(contentContainer);\n\n  return { card, controller };\n}\n","/**\n * Sprite controller - manages a single 8x8 sprite cell from the sprite sheet\n */\nimport * as PIXI from 'pixi.js';\nimport { SpriteSheetController } from './sprite-sheet-controller';\n\nexport interface SpriteControllerOptions {\n  spriteSheetController: SpriteSheetController;\n  cellX: number;  // Cell X coordinate (0-based, in 8x8 cells)\n  cellY: number;  // Cell Y coordinate (0-based, in 8x8 cells)\n  scale?: number; // Display scale\n}\n\n/**\n * Controller for managing a single 8x8 sprite cell\n * References the sprite sheet controller and updates it directly\n */\nexport class SpriteController {\n  private spriteSheetController: SpriteSheetController;\n  private cellX: number;\n  private cellY: number;\n  private scale: number;\n  private sprite: PIXI.Sprite | null = null;\n  private texture: PIXI.Texture | null = null;\n\n  constructor(options: SpriteControllerOptions) {\n    this.spriteSheetController = options.spriteSheetController;\n    this.cellX = options.cellX;\n    this.cellY = options.cellY;\n    this.scale = options.scale ?? 8; // Default 8x zoom for editing\n  }\n\n  /**\n   * Get the current cell coordinates\n   */\n  public getCell(): { x: number; y: number } {\n    return { x: this.cellX, y: this.cellY };\n  }\n\n  /**\n   * Set which cell to edit\n   */\n  public setCell(cellX: number, cellY: number) {\n    this.cellX = cellX;\n    this.cellY = cellY;\n  }\n\n  /**\n   * Get the scale\n   */\n  public getScale(): number {\n    return this.scale;\n  }\n\n  /**\n   * Set the scale\n   */\n  public setScale(newScale: number) {\n    this.scale = Math.max(1, Math.min(64, newScale));\n  }\n\n  /**\n   * Get pixel color at local sprite coordinates (0-7, 0-7)\n   */\n  public getPixel(localX: number, localY: number): number {\n    // Convert local coordinates to global sheet coordinates\n    const globalX = this.cellX * 8 + localX;\n    const globalY = this.cellY * 8 + localY;\n    return this.spriteSheetController.getPixel(globalX, globalY);\n  }\n\n  /**\n   * Set pixel color at local sprite coordinates (0-7, 0-7)\n   */\n  public setPixel(localX: number, localY: number, colorIndex: number) {\n    // Convert local coordinates to global sheet coordinates\n    const globalX = this.cellX * 8 + localX;\n    const globalY = this.cellY * 8 + localY;\n    this.spriteSheetController.setPixel(globalX, globalY, colorIndex);\n  }\n\n  /**\n   * Render the sprite (shows the 8x8 cell from sprite sheet)\n   */\n  public render(container: PIXI.Container) {\n    // Remove old sprite if it exists\n    if (this.sprite) {\n      container.removeChild(this.sprite);\n    }\n\n    // Get the sprite sheet's texture\n    const sheetConfig = this.spriteSheetController.getConfig();\n\n    // For now, we'll render our own texture from pixel data\n    // This ensures we always show the latest pixel data\n    const canvas = document.createElement('canvas');\n    canvas.width = 8;\n    canvas.height = 8;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    // Draw the 8x8 sprite from sprite sheet data\n    for (let y = 0; y < 8; y++) {\n      for (let x = 0; x < 8; x++) {\n        const colorIndex = this.getPixel(x, y);\n        const color = sheetConfig.palette[colorIndex];\n\n        // Convert color to CSS format\n        const r = (color >> 16) & 0xff;\n        const g = (color >> 8) & 0xff;\n        const b = color & 0xff;\n        ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;\n        ctx.fillRect(x, y, 1, 1);\n      }\n    }\n\n    // Destroy old texture if exists\n    if (this.texture) {\n      this.texture.destroy(true);\n    }\n\n    // Create texture from canvas with nearest neighbor scaling\n    this.texture = PIXI.Texture.from(canvas);\n    this.texture.source.scaleMode = 'nearest';\n\n    // Create sprite\n    this.sprite = new PIXI.Sprite(this.texture);\n    this.sprite.scale.set(this.scale);\n    this.sprite.position.set(0, 0);\n\n    container.addChild(this.sprite);\n  }\n\n  /**\n   * Convert screen coordinates (relative to sprite) to pixel coordinates\n   */\n  public screenToPixel(screenX: number, screenY: number): { x: number; y: number } | null {\n    const pixelX = Math.floor(screenX / this.scale);\n    const pixelY = Math.floor(screenY / this.scale);\n\n    if (pixelX < 0 || pixelX >= 8 || pixelY < 0 || pixelY >= 8) {\n      return null;\n    }\n\n    return { x: pixelX, y: pixelY };\n  }\n\n  /**\n   * Get the scaled dimensions\n   */\n  public getScaledDimensions(): { width: number; height: number } {\n    return {\n      width: 8 * this.scale,\n      height: 8 * this.scale\n    };\n  }\n}\n","/**\n * UI State Manager - Persists card positions and sizes to localStorage\n */\n\nexport interface CardState {\n  id: string;                    // Unique identifier for the card\n  x: number;                     // Position X\n  y: number;                     // Position Y\n  contentWidth: number;          // Content width in grid units\n  contentHeight: number;         // Content height in grid units\n  visible: boolean;              // Visibility state\n}\n\nexport interface UIState {\n  version: string;               // For future migrations\n  timestamp: number;             // When saved\n  canvasWidth: number;           // Canvas dimensions at save time\n  canvasHeight: number;\n  cards: CardState[];            // All card states\n}\n\nexport class UIStateManager {\n  private static readonly VERSION = '1.0.0';\n  private static readonly STORAGE_KEY = 'sprite-editor-ui-state';\n\n  /**\n   * Save UI state to localStorage\n   */\n  static saveState(\n    cards: Map<string, CardState>,\n    canvasWidth: number,\n    canvasHeight: number\n  ): void {\n    const state: UIState = {\n      version: UIStateManager.VERSION,\n      timestamp: Date.now(),\n      canvasWidth,\n      canvasHeight,\n      cards: Array.from(cards.values())\n    };\n\n    try {\n      localStorage.setItem(\n        UIStateManager.STORAGE_KEY,\n        JSON.stringify(state)\n      );\n      console.log(' UI state saved:', cards.size, 'cards');\n    } catch (e) {\n      console.error('Failed to save UI state:', e);\n    }\n  }\n\n  /**\n   * Load UI state from localStorage\n   */\n  static loadState(): UIState | null {\n    try {\n      const json = localStorage.getItem(UIStateManager.STORAGE_KEY);\n      if (!json) return null;\n\n      const state = JSON.parse(json) as UIState;\n\n      // Validate version\n      if (state.version !== UIStateManager.VERSION) {\n        console.warn('UI state version mismatch, ignoring');\n        return null;\n      }\n\n      console.log(' UI state loaded:', state.cards.length, 'cards');\n      return state;\n    } catch (e) {\n      console.error('Failed to load UI state:', e);\n      return null;\n    }\n  }\n\n  /**\n   * Clear saved UI state\n   */\n  static clearState(): void {\n    localStorage.removeItem(UIStateManager.STORAGE_KEY);\n    console.log(' UI state cleared');\n  }\n\n  /**\n   * Check if saved state exists\n   */\n  static hasState(): boolean {\n    return localStorage.getItem(UIStateManager.STORAGE_KEY) !== null;\n  }\n\n  /**\n   * Adjust card positions for different canvas size\n   * (Handles window resize between sessions)\n   */\n  static adjustForCanvasSize(\n    state: UIState,\n    newWidth: number,\n    newHeight: number\n  ): UIState {\n    const scaleX = newWidth / state.canvasWidth;\n    const scaleY = newHeight / state.canvasHeight;\n\n    return {\n      ...state,\n      canvasWidth: newWidth,\n      canvasHeight: newHeight,\n      cards: state.cards.map(card => ({\n        ...card,\n        x: Math.round(card.x * scaleX),\n        y: Math.round(card.y * scaleY)\n      }))\n    };\n  }\n}\n","/**\n * Project State Manager\n * Manages sprite project data separately from UI layout state\n * Saves sprite pixel data, sprite sheet configurations, and active editing state\n */\nimport { SpriteSheetType } from '../controllers/sprite-sheet-controller';\n\nconst PROJECT_STATE_KEY = 'sprite-editor-project';\n\n/**\n * State for a single sprite sheet in the project\n */\nexport interface SpriteSheetState {\n  id: string;\n  type: SpriteSheetType;\n  showGrid: boolean;\n  pixels: number[][]; // 2D array of color indices\n  selectedCellX: number;\n  selectedCellY: number;\n  scale: number;\n  spriteCardScale?: number; // Scale of the sprite card if open\n}\n\n/**\n * Complete project state\n */\nexport interface ProjectState {\n  version: number; // For future migrations\n  createdAt: number; // Timestamp\n  modifiedAt: number; // Timestamp\n  spriteSheets: SpriteSheetState[];\n  activeSpriteSheetId: string | null;\n  selectedColorIndex: number;\n}\n\n/**\n * Project State Manager\n * Handles saving and loading of sprite project data to/from localStorage\n */\nexport class ProjectStateManager {\n  private static readonly CURRENT_VERSION = 1;\n\n  /**\n   * Create a new empty project\n   */\n  static createEmptyProject(): ProjectState {\n    return {\n      version: this.CURRENT_VERSION,\n      createdAt: Date.now(),\n      modifiedAt: Date.now(),\n      spriteSheets: [],\n      activeSpriteSheetId: null,\n      selectedColorIndex: 0\n    };\n  }\n\n  /**\n   * Save project state to localStorage\n   */\n  static saveProject(state: ProjectState): void {\n    try {\n      state.modifiedAt = Date.now();\n      const serialized = JSON.stringify(state);\n      localStorage.setItem(PROJECT_STATE_KEY, serialized);\n      console.log(' Project saved to localStorage');\n    } catch (error) {\n      console.error('Failed to save project state:', error);\n    }\n  }\n\n  /**\n   * Load project state from localStorage\n   */\n  static loadProject(): ProjectState | null {\n    try {\n      const serialized = localStorage.getItem(PROJECT_STATE_KEY);\n      if (!serialized) {\n        return null;\n      }\n\n      const state = JSON.parse(serialized) as ProjectState;\n\n      // Version migration if needed\n      if (state.version !== this.CURRENT_VERSION) {\n        console.warn('Project version mismatch, migrating...');\n        return this.migrateProject(state);\n      }\n\n      console.log(' Project loaded from localStorage');\n      return state;\n    } catch (error) {\n      console.error('Failed to load project state:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Clear project state (start fresh)\n   */\n  static clearProject(): void {\n    try {\n      localStorage.removeItem(PROJECT_STATE_KEY);\n      console.log(' Project cleared');\n    } catch (error) {\n      console.error('Failed to clear project state:', error);\n    }\n  }\n\n  /**\n   * Check if a project exists\n   */\n  static hasProject(): boolean {\n    return localStorage.getItem(PROJECT_STATE_KEY) !== null;\n  }\n\n  /**\n   * Migrate old project versions to current version\n   */\n  private static migrateProject(state: ProjectState): ProjectState {\n    // For now, just update the version\n    // In the future, handle migrations between versions here\n    return {\n      ...state,\n      version: this.CURRENT_VERSION\n    };\n  }\n\n  /**\n   * Export project as JSON string (for download/sharing)\n   */\n  static exportProjectJSON(state: ProjectState): string {\n    return JSON.stringify(state, null, 2);\n  }\n\n  /**\n   * Import project from JSON string\n   */\n  static importProjectJSON(jsonString: string): ProjectState | null {\n    try {\n      const state = JSON.parse(jsonString) as ProjectState;\n\n      // Validate the structure\n      if (!state.spriteSheets || !Array.isArray(state.spriteSheets)) {\n        throw new Error('Invalid project structure');\n      }\n\n      // Migrate if needed\n      if (state.version !== this.CURRENT_VERSION) {\n        return this.migrateProject(state);\n      }\n\n      return state;\n    } catch (error) {\n      console.error('Failed to import project:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Get project metadata (without full pixel data)\n   */\n  static getProjectMetadata(): { createdAt: number; modifiedAt: number; sheetCount: number } | null {\n    const state = this.loadProject();\n    if (!state) return null;\n\n    return {\n      createdAt: state.createdAt,\n      modifiedAt: state.modifiedAt,\n      sheetCount: state.spriteSheets.length\n    };\n  }\n\n  /**\n   * Download project as a .pikcell file to user's drive\n   */\n  static downloadProject(state: ProjectState, filename?: string): void {\n    const json = this.exportProjectJSON(state);\n    const blob = new Blob([json], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename ?? `pikcell-project-${Date.now()}.pikcell`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n\n    console.log(' Pikcell project downloaded');\n  }\n\n  /**\n   * Prompt user to load a project file from their drive\n   * Returns a promise that resolves with the loaded project state\n   */\n  static async loadProjectFromFile(): Promise<ProjectState | null> {\n    return new Promise((resolve) => {\n      const input = document.createElement('input');\n      input.type = 'file';\n      input.accept = '.pikcell,application/json';\n\n      input.onchange = async (e) => {\n        const file = (e.target as HTMLInputElement).files?.[0];\n        if (!file) {\n          resolve(null);\n          return;\n        }\n\n        try {\n          const text = await file.text();\n          const state = this.importProjectJSON(text);\n          if (state) {\n            console.log(' Pikcell project loaded from file');\n          }\n          resolve(state);\n        } catch (error) {\n          console.error('Failed to load pikcell project file:', error);\n          resolve(null);\n        }\n      };\n\n      input.click();\n    });\n  }\n}\n","/**\n * Layout State Manager - Save and load layout configurations\n */\n\nexport interface CardLayoutState {\n  id: string;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\nexport interface LayoutSlotState {\n  cards: CardLayoutState[];\n}\n\nconst LAYOUT_STORAGE_PREFIX = 'pikcell-layout-slot-';\n\nexport class LayoutStateManager {\n  /**\n   * Save current layout to a slot\n   */\n  static saveLayoutSlot(slot: 'A' | 'B' | 'C', layout: LayoutSlotState): void {\n    const key = `${LAYOUT_STORAGE_PREFIX}${slot}`;\n    localStorage.setItem(key, JSON.stringify(layout));\n  }\n\n  /**\n   * Load layout from a slot\n   */\n  static loadLayoutSlot(slot: 'A' | 'B' | 'C'): LayoutSlotState | null {\n    const key = `${LAYOUT_STORAGE_PREFIX}${slot}`;\n    const data = localStorage.getItem(key);\n    if (!data) return null;\n\n    try {\n      return JSON.parse(data) as LayoutSlotState;\n    } catch (e) {\n      console.error(`Failed to parse layout slot ${slot}:`, e);\n      return null;\n    }\n  }\n\n  /**\n   * Check if a slot has a saved layout\n   */\n  static hasLayoutSlot(slot: 'A' | 'B' | 'C'): boolean {\n    const key = `${LAYOUT_STORAGE_PREFIX}${slot}`;\n    return localStorage.getItem(key) !== null;\n  }\n\n  /**\n   * Clear a layout slot\n   */\n  static clearLayoutSlot(slot: 'A' | 'B' | 'C'): void {\n    const key = `${LAYOUT_STORAGE_PREFIX}${slot}`;\n    localStorage.removeItem(key);\n  }\n}\n","/**\n * Color palette definitions for sprite editor\n */\n\n/**\n * PICO-8 color palette (16 colors)\n * Standard palette used in PICO-8 fantasy console\n */\nexport const PICO8_PALETTE = [\n  0x000000, // black\n  0x1d2b53, // dark blue\n  0x7e2553, // dark purple\n  0x008751, // dark green\n  0xab5236, // brown\n  0x5f574f, // dark gray\n  0xc2c3c7, // light gray\n  0xfff1e8, // white\n  0xff004d, // red\n  0xffa300, // orange\n  0xffec27, // yellow\n  0x00e436, // green\n  0x29adff, // blue\n  0x83769c, // lavender\n  0xff77a8, // pink\n  0xffccaa  // peach\n];\n\n/**\n * TIC-80 color palette (16 colors)\n * Standard palette used in TIC-80 fantasy console\n */\nexport const TIC80_PALETTE = [\n  0x000000, // black\n  0x1d2b53, // dark blue\n  0x7e2553, // dark purple\n  0x008751, // dark green\n  0xab5236, // brown\n  0x5f574f, // dark gray\n  0xc2c3c7, // light gray\n  0xfff1e8, // white\n  0xff004d, // red\n  0xffa300, // orange\n  0xffec27, // yellow\n  0x00e436, // green\n  0x29adff, // blue\n  0x83769c, // lavender\n  0xff77a8, // pink\n  0xffccaa  // peach\n];\n\n/**\n * CC-29 color palette (29 colors)\n * From Lospec.com/palette-list\n */\nexport const CC29_PALETTE = [\n  0xf2f0e5, // Light cream\n  0xb8b5b9, // Light gray\n  0x868188, // Medium gray\n  0x646365, // Dark gray\n  0x45444f, // Darker gray\n  0x3a3858, // Dark blue-gray\n  0x212123, // Very dark\n  0x352b42, // Dark purple\n  0x43436a, // Medium blue\n  0x4b80ca, // Blue\n  0x68c2d3, // Light blue\n  0xa2dcc7, // Mint green\n  0xede19e, // Light yellow\n  0xd3a068, // Tan\n  0xb45252, // Red\n  0x6a536e, // Purple-gray\n  0x4b4158, // Dark purple-gray\n  0x80493a, // Brown\n  0xa77b5b, // Light brown\n  0xe5ceb4, // Beige\n  0xc2d368, // Yellow-green\n  0x8ab060, // Green\n  0x567b79, // Teal\n  0x4e584a, // Dark green\n  0x7b7243, // Olive\n  0xb2b47e, // Light olive\n  0xedc8c4, // Light pink\n  0xcf8acb, // Pink\n  0x5f556a  // Dark purple-gray\n];\n\n/**\n * Aerugo color palette (32 colors)\n * The editor's UI palette\n * From https://lospec.com/palette-list/aerugo\n */\nexport const AERUGO_PALETTE = [\n  0x2f1e1a, 0x4f3322, 0x723627, 0x95392c,\n  0xc75533, 0xe76d46, 0x934e28, 0xa2663c,\n  0xc87d40, 0xf5a95b, 0x6b8b8c, 0x81a38e,\n  0xaac39e, 0xffffff, 0xd1d0ce, 0xbab7b2,\n  0x898a8a, 0x686461, 0x554d4b, 0x3c3d3b,\n  0x343230, 0x87d1ef, 0x64a1c2, 0x466480,\n  0x2f485c, 0x242e35, 0x1b2026, 0xaa9c8a,\n  0x917f6d, 0x86624a, 0x715b48, 0x5e4835\n];\n\nexport type PaletteType = 'pico8' | 'tic80' | 'cc29' | 'aerugo';\n\nexport function getPalette(type: PaletteType): number[] {\n  switch (type) {\n    case 'pico8':\n      return PICO8_PALETTE;\n    case 'tic80':\n      return TIC80_PALETTE;\n    case 'cc29':\n      return CC29_PALETTE;\n    case 'aerugo':\n      return AERUGO_PALETTE;\n  }\n}\n\n","/**\n * Card Zoom Handler Utility\n * Encapsulates the common zoom logic used by palette, tools, and sprite cards\n */\nimport * as PIXI from 'pixi.js';\nimport { PixelCard } from '../components/pixel-card';\n\n/**\n * Helper: Creates a mouse wheel zoom handler for a card\n * Encapsulates the common zoom logic used by palette, tools, and sprite cards\n */\nexport function createCardZoomHandler(\n  renderer: PIXI.Renderer,\n  card: PixelCard,\n  onZoom: (delta: number, event: WheelEvent) => void\n): (e: WheelEvent) => void {\n  return (e: WheelEvent) => {\n    const canvas = renderer.canvas as HTMLCanvasElement;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n\n    const mouseX = (e.clientX - rect.left) * scaleX;\n    const mouseY = (e.clientY - rect.top) * scaleY;\n\n    const cardBounds = card.container.getBounds();\n\n    if (mouseX >= cardBounds.x && mouseX <= cardBounds.x + cardBounds.width &&\n        mouseY >= cardBounds.y && mouseY <= cardBounds.y + cardBounds.height) {\n      e.preventDefault();\n\n      const delta = e.deltaY > 0 ? -1 : 1;\n      onZoom(delta, e);\n    }\n  };\n}\n","/**\n * Sprite Editor Constants\n *\n * Centralized configuration for all magic numbers and constants used throughout\n * the sprite editor. This promotes maintainability and makes it easy to tune\n * editor behavior from a single location.\n */\n\n/**\n * Sprite dimensions and cell sizes\n */\nexport const SPRITE_CONSTANTS = {\n  /** Standard sprite cell size in pixels (8x8) */\n  CELL_SIZE: 8,\n\n  /** Default editor scale for individual sprite editing */\n  DEFAULT_SPRITE_SCALE: 8,\n\n  /** Minimum sprite scale */\n  MIN_SPRITE_SCALE: 1,\n\n  /** Maximum sprite scale */\n  MAX_SPRITE_SCALE: 64,\n} as const;\n\n/**\n * Sprite sheet controller constants\n */\nexport const SPRITE_SHEET_CONSTANTS = {\n  /** Click threshold in pixels - below this distance is a click, above is a drag */\n  CLICK_THRESHOLD_PX: 5,\n\n  /** Default viewport scale ratio (sheet height / viewport height) */\n  DEFAULT_VIEWPORT_RATIO: 0.5,\n\n  /** Zoom increment per mouse wheel notch */\n  ZOOM_INCREMENT: 0.5,\n\n  /** Minimum sprite sheet scale */\n  MIN_SCALE: 1,\n\n  /** Maximum sprite sheet scale */\n  MAX_SCALE: 16,\n\n  /** Grid line opacity (0-1) */\n  GRID_OPACITY: 0.3,\n\n  /** Grid line color (CSS color string) */\n  GRID_COLOR: 'rgba(128, 128, 128, 0.3)',\n\n  /** Grid line width in pixels */\n  GRID_LINE_WIDTH: 1,\n} as const;\n\n/**\n * Card UI constants\n */\nexport const CARD_CONSTANTS = {\n  /** Title bar font scale multiplier */\n  TITLE_FONT_SCALE_MULTIPLIER: 64,\n\n  /** Title bar padding multiplier */\n  TITLE_PADDING_MULTIPLIER: 2,\n\n  /** Resize handle size in pixels */\n  RESIZE_HANDLE_SIZE: 16,\n\n  /** Corner resize handle size in pixels */\n  CORNER_RESIZE_HANDLE_SIZE: 16,\n\n  /** Minimum drag distance to distinguish from click */\n  MIN_DRAG_DISTANCE: 5,\n} as const;\n\n/**\n * Default card dimensions (in grid units)\n */\nexport const DEFAULT_CARD_SIZES = {\n  /** Default palette card dimensions */\n  PALETTE: {\n    WIDTH: 50,\n    HEIGHT: 50,\n  },\n\n  /** Default tool card dimensions */\n  TOOL: {\n    WIDTH: 50,\n    HEIGHT: 50,\n  },\n\n  /** Default sprite sheet minimap dimensions */\n  SPRITESHEET_MINIMAP: {\n    WIDTH: 50,\n    HEIGHT: 50,\n    SCALE: 5,\n  },\n\n  /** Default sprite card dimensions */\n  SPRITE: {\n    WIDTH: 70,\n    HEIGHT: 70,\n  },\n\n  /** Default commander bar dimensions */\n  COMMANDER_BAR: {\n    BASE_HEIGHT: 12,\n    BUTTON_SPACING: 24,\n  },\n\n  /** Default info bar dimensions */\n  INFO_BAR: {\n    HEIGHT: 10,\n  },\n\n  /** Default scale card dimensions */\n  SCALE: {\n    WIDTH: 20,\n    HEIGHT: 10,\n  },\n} as const;\n\n/**\n * Layout constants\n */\nexport const LAYOUT_CONSTANTS = {\n  /** Gap between cards in pixels */\n  CARD_GAP: 8,\n\n  /** Padding from viewport edges */\n  VIEWPORT_PADDING: 0,\n\n  /** Z-index for focused cards (to bring to front) */\n  FOCUSED_CARD_Z_INDEX: 1000,\n} as const;\n\n/**\n * Animation and interaction constants\n */\nexport const INTERACTION_CONSTANTS = {\n  /** Double-click time threshold in milliseconds */\n  DOUBLE_CLICK_THRESHOLD_MS: 300,\n\n  /** Long press duration in milliseconds */\n  LONG_PRESS_DURATION_MS: 500,\n\n  /** Drag start delay in milliseconds */\n  DRAG_START_DELAY_MS: 100,\n} as const;\n\n/**\n * File operation constants\n */\nexport const FILE_CONSTANTS = {\n  /** Project file extension */\n  PROJECT_FILE_EXTENSION: '.moxiproject',\n\n  /** PNG export file extension */\n  PNG_EXPORT_EXTENSION: '.png',\n\n  /** Default project file name */\n  DEFAULT_PROJECT_NAME: 'untitled-project',\n\n  /** UI state storage key */\n  UI_STATE_STORAGE_KEY: 'spriteEditorUIState',\n\n  /** Project state storage key */\n  PROJECT_STATE_STORAGE_KEY: 'spriteEditorProjectState',\n\n  /** Layout state storage key */\n  LAYOUT_STATE_STORAGE_KEY: 'spriteEditorLayoutState',\n} as const;\n\n/**\n * Color constants\n */\nexport const COLOR_CONSTANTS = {\n  /** Cell selection highlight color */\n  CELL_SELECTION_COLOR: 0xffec27,\n\n  /** Cell selection highlight width */\n  CELL_SELECTION_WIDTH: 2,\n\n  /** Cell hover highlight color */\n  CELL_HOVER_COLOR: 0xffffff,\n\n  /** Cell hover highlight width */\n  CELL_HOVER_WIDTH: 1,\n\n  /** Cell hover highlight alpha */\n  CELL_HOVER_ALPHA: 0.5,\n} as const;\n\n/**\n * Performance constants\n */\nexport const PERFORMANCE_CONSTANTS = {\n  /** Maximum number of sprite sheets per project */\n  MAX_SPRITE_SHEETS_PER_PROJECT: 10,\n\n  /** Texture cache size limit */\n  TEXTURE_CACHE_SIZE: 100,\n\n  /** Debounce delay for auto-save in milliseconds */\n  AUTO_SAVE_DEBOUNCE_MS: 1000,\n} as const;\n\n/**\n * Debug constants\n */\nexport const DEBUG_CONSTANTS = {\n  /** Enable verbose logging */\n  ENABLE_VERBOSE_LOGGING: false,\n\n  /** Show performance metrics */\n  SHOW_PERFORMANCE_METRICS: false,\n\n  /** Show bounding boxes for cards */\n  SHOW_CARD_BOUNDS: false,\n} as const;\n\n/**\n * Tool constants\n */\nexport const TOOL_CONSTANTS = {\n  /** Default tool on editor start */\n  DEFAULT_TOOL: 'pencil',\n\n  /** Tool cursor types */\n  TOOL_CURSORS: {\n    pencil: 'crosshair',\n    eraser: 'crosshair',\n    fill: 'crosshair',\n    eyedropper: 'crosshair',\n    select: 'default',\n  },\n} as const;\n","/**\n * SpriteSheetManager - Manages sprite sheet lifecycle\n *\n * Extracted from SpriteEditor to follow Single Responsibility Principle.\n * Handles creation, tracking, activation, and validation of sprite sheets.\n */\nimport { SpriteSheetInstance, ISpriteSheetManager, ValidationResult } from '../interfaces/managers';\nimport { SpriteSheetType, SpriteSheetConfig } from '../controllers/sprite-sheet-controller';\nimport { PERFORMANCE_CONSTANTS } from '../config/constants';\n\ntype EventHandler = (id: string) => void;\n\n/**\n * Manages all sprite sheet instances in the editor\n */\nexport class SpriteSheetManager implements ISpriteSheetManager {\n  private instances: Map<string, SpriteSheetInstance> = new Map();\n  private activeId: string | null = null;\n  private eventHandlers: Map<string, Set<EventHandler>> = new Map();\n\n  /**\n   * Create a new sprite sheet instance\n   *\n   * @param type Sprite sheet type (PICO-8, TIC-80, etc.)\n   * @param savedId Optional saved ID to reuse when loading from state\n   * @param config Optional configuration overrides\n   * @returns The created sprite sheet instance\n   */\n  create(type: SpriteSheetType, savedId?: string, config?: Partial<SpriteSheetConfig>): SpriteSheetInstance {\n    const id = savedId || this.generateId();\n\n    // Create the instance (cards will be set by the caller)\n    const instance: SpriteSheetInstance = {\n      id,\n      sheetCard: null as any, // Will be set by caller\n      spriteCard: null,\n      spriteController: null,\n    };\n\n    this.instances.set(id, instance);\n    this.emit('created', id);\n\n    return instance;\n  }\n\n  /**\n   * Get a sprite sheet instance by ID\n   *\n   * @param id Sprite sheet ID\n   * @returns The sprite sheet instance or undefined if not found\n   */\n  get(id: string): SpriteSheetInstance | undefined {\n    return this.instances.get(id);\n  }\n\n  /**\n   * Get the currently active sprite sheet\n   *\n   * @returns The active sprite sheet instance or null if none active\n   */\n  getActive(): SpriteSheetInstance | null {\n    if (!this.activeId) return null;\n    return this.instances.get(this.activeId) || null;\n  }\n\n  /**\n   * Set the active sprite sheet\n   *\n   * @param id Sprite sheet ID to activate\n   * @throws Error if sprite sheet ID doesn't exist\n   */\n  setActive(id: string): void {\n    if (!this.instances.has(id)) {\n      throw new Error(`Cannot set active sprite sheet: ID \"${id}\" not found`);\n    }\n\n    if (this.activeId !== id) {\n      this.activeId = id;\n      this.emit('activeChanged', id);\n    }\n  }\n\n  /**\n   * Get all sprite sheet instances\n   *\n   * @returns Array of all sprite sheet instances\n   */\n  getAll(): SpriteSheetInstance[] {\n    return Array.from(this.instances.values());\n  }\n\n  /**\n   * Remove a sprite sheet instance\n   *\n   * @param id Sprite sheet ID to remove\n   */\n  remove(id: string): void {\n    const instance = this.instances.get(id);\n    if (!instance) return;\n\n    // Clear active if this was the active sheet\n    if (this.activeId === id) {\n      this.activeId = null;\n\n      // Set first remaining sheet as active, if any\n      const remaining = Array.from(this.instances.keys()).filter(key => key !== id);\n      if (remaining.length > 0) {\n        this.activeId = remaining[0];\n      }\n    }\n\n    this.instances.delete(id);\n    this.emit('removed', id);\n  }\n\n  /**\n   * Validate if a sprite sheet can be created\n   *\n   * Enforces rules like:\n   * - Maximum sprite sheets per project\n   * - One sprite sheet type per project\n   *\n   * @param type Sprite sheet type to validate\n   * @returns Validation result with error message if invalid\n   */\n  validate(type: SpriteSheetType): ValidationResult {\n    // Check maximum sprite sheets\n    if (this.instances.size >= PERFORMANCE_CONSTANTS.MAX_SPRITE_SHEETS_PER_PROJECT) {\n      return {\n        valid: false,\n        message: `Maximum ${PERFORMANCE_CONSTANTS.MAX_SPRITE_SHEETS_PER_PROJECT} sprite sheets per project`,\n      };\n    }\n\n    // Enforce single sprite sheet type per project\n    if (this.instances.size > 0) {\n      const firstInstance = Array.from(this.instances.values())[0];\n      const existingType = firstInstance.sheetCard?.controller.getConfig().type;\n\n      if (existingType && existingType !== type) {\n        return {\n          valid: false,\n          message: `Project already contains a ${existingType} sprite sheet. Create a new project to use ${type}.`,\n        };\n      }\n    }\n\n    return { valid: true };\n  }\n\n  /**\n   * Check if a sprite sheet exists\n   *\n   * @param id Sprite sheet ID\n   * @returns True if sprite sheet exists\n   */\n  has(id: string): boolean {\n    return this.instances.has(id);\n  }\n\n  /**\n   * Get the count of sprite sheets\n   *\n   * @returns Number of sprite sheets\n   */\n  count(): number {\n    return this.instances.size;\n  }\n\n  /**\n   * Subscribe to sprite sheet events\n   *\n   * @param event Event type to subscribe to\n   * @param handler Event handler function\n   */\n  on(event: 'created' | 'removed' | 'activeChanged', handler: EventHandler): void {\n    if (!this.eventHandlers.has(event)) {\n      this.eventHandlers.set(event, new Set());\n    }\n    this.eventHandlers.get(event)!.add(handler);\n  }\n\n  /**\n   * Unsubscribe from sprite sheet events\n   *\n   * @param event Event type to unsubscribe from\n   * @param handler Event handler function to remove\n   */\n  off(event: 'created' | 'removed' | 'activeChanged', handler: EventHandler): void {\n    const handlers = this.eventHandlers.get(event);\n    if (handlers) {\n      handlers.delete(handler);\n    }\n  }\n\n  /**\n   * Clear all sprite sheets\n   *\n   * Useful for creating a new project\n   */\n  clear(): void {\n    const ids = Array.from(this.instances.keys());\n    ids.forEach(id => this.remove(id));\n  }\n\n  /**\n   * Get the sprite sheet type (if all sheets are the same type)\n   *\n   * @returns The sprite sheet type or null if no sheets or mixed types\n   */\n  getProjectSpriteSheetType(): SpriteSheetType | null {\n    if (this.instances.size === 0) return null;\n\n    const firstInstance = Array.from(this.instances.values())[0];\n    return firstInstance.sheetCard?.controller.getConfig().type || null;\n  }\n\n  /**\n   * Generate a unique ID for a sprite sheet\n   *\n   * @private\n   */\n  private generateId(): string {\n    return `sheet-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * Emit an event to all subscribed handlers\n   *\n   * @private\n   */\n  private emit(event: string, id: string): void {\n    const handlers = this.eventHandlers.get(event);\n    if (handlers) {\n      handlers.forEach(handler => handler(id));\n    }\n  }\n\n  /**\n   * Get statistics about sprite sheets\n   *\n   * Useful for debugging and UI display\n   */\n  getStats(): {\n    total: number;\n    activeId: string | null;\n    type: SpriteSheetType | null;\n  } {\n    return {\n      total: this.instances.size,\n      activeId: this.activeId,\n      type: this.getProjectSpriteSheetType(),\n    };\n  }\n}\n","/**\n * UIManager - Manages UI card lifecycle and z-ordering\n *\n * Extracted from SpriteEditor to follow Single Responsibility Principle.\n * Handles card registration, z-ordering, focus management, and state export/import.\n */\nimport * as PIXI from 'pixi.js';\nimport { PixelCard } from '../components/pixel-card';\nimport { IUIManager } from '../interfaces/managers';\nimport { CardState } from '../state/ui-state-manager';\nimport { LAYOUT_CONSTANTS } from '../config/constants';\n\n/**\n * Manages all UI cards in the editor\n */\nexport class UIManager implements IUIManager {\n  private cards: Map<string, PixelCard> = new Map();\n  private scene: PIXI.Container;\n  private focusedCardId: string | null = null;\n\n  constructor(scene: PIXI.Container) {\n    this.scene = scene;\n  }\n\n  /**\n   * Register a card with the UI manager\n   *\n   * @param id Unique card identifier\n   * @param card PixelCard instance\n   */\n  registerCard(id: string, card: PixelCard): void {\n    if (this.cards.has(id)) {\n      console.warn(`Card with ID \"${id}\" is already registered`);\n      return;\n    }\n\n    this.cards.set(id, card);\n\n    // Add card to scene if not already added\n    if (!this.scene.children.includes(card.container)) {\n      this.scene.addChild(card.container);\n    }\n\n    // Setup focus listener\n    if (card.onStateChanged) {\n      const originalOnStateChanged = card.onStateChanged.bind(card);\n      card.onStateChanged = () => {\n        this.setFocusedCard(id);\n        originalOnStateChanged();\n      };\n    }\n  }\n\n  /**\n   * Unregister a card\n   *\n   * @param id Card identifier\n   */\n  unregisterCard(id: string): void {\n    const card = this.cards.get(id);\n    if (!card) return;\n\n    // Remove from scene\n    if (this.scene.children.includes(card.container)) {\n      this.scene.removeChild(card.container);\n    }\n\n    // Clear focus if this was the focused card\n    if (this.focusedCardId === id) {\n      this.focusedCardId = null;\n    }\n\n    this.cards.delete(id);\n  }\n\n  /**\n   * Get a registered card by ID\n   *\n   * @param id Card identifier\n   * @returns The card or undefined if not found\n   */\n  getCard(id: string): PixelCard | undefined {\n    return this.cards.get(id);\n  }\n\n  /**\n   * Get all registered cards\n   *\n   * @returns Map of all cards (id -> card)\n   */\n  getAllCards(): Map<string, PixelCard> {\n    return new Map(this.cards);\n  }\n\n  /**\n   * Bring a card to the front (highest z-index)\n   *\n   * This is done by removing and re-adding the card to the scene,\n   * which places it at the end of the children array (rendered last = on top)\n   *\n   * @param id Card identifier\n   */\n  bringToFront(id: string): void {\n    const card = this.cards.get(id);\n    if (!card) return;\n\n    // Remove and re-add to bring to front\n    this.scene.removeChild(card.container);\n    this.scene.addChild(card.container);\n\n    // If card has a paired card, bring that to front too (but behind this one)\n    const pairedCard = card.getPairedCard?.();\n    if (pairedCard && pairedCard !== card) {\n      // Find the paired card's ID\n      for (const [pairedId, registeredCard] of this.cards.entries()) {\n        if (registeredCard === pairedCard) {\n          // Remove and re-add paired card first (so it's behind the main card)\n          this.scene.removeChild(pairedCard.container);\n          this.scene.addChild(pairedCard.container);\n\n          // Then remove and re-add the main card (so it's on top)\n          this.scene.removeChild(card.container);\n          this.scene.addChild(card.container);\n          break;\n        }\n      }\n    }\n  }\n\n  /**\n   * Export states of all cards\n   *\n   * @returns Map of card states (id -> state)\n   */\n  exportAllStates(): Map<string, CardState> {\n    const stateMap = new Map<string, CardState>();\n\n    this.cards.forEach((card, id) => {\n      stateMap.set(id, card.exportState(id));\n    });\n\n    return stateMap;\n  }\n\n  /**\n   * Import and restore card states\n   *\n   * @param states Map of card states to restore\n   */\n  importStates(states: Map<string, CardState>): void {\n    states.forEach((cardState, id) => {\n      const card = this.cards.get(id);\n      if (card) {\n        card.importState(cardState);\n      }\n    });\n  }\n\n  /**\n   * Check if a card is registered\n   *\n   * @param id Card identifier\n   * @returns True if card exists\n   */\n  hasCard(id: string): boolean {\n    return this.cards.has(id);\n  }\n\n  /**\n   * Get the focused card ID\n   *\n   * @returns The ID of the focused card or null\n   */\n  getFocusedCard(): string | null {\n    return this.focusedCardId;\n  }\n\n  /**\n   * Set the focused card\n   *\n   * This will bring the card to front and track it as focused\n   *\n   * @param id Card identifier or null to clear focus\n   */\n  setFocusedCard(id: string | null): void {\n    if (id === this.focusedCardId) return;\n\n    this.focusedCardId = id;\n\n    if (id) {\n      this.bringToFront(id);\n    }\n  }\n\n  /**\n   * Get the count of registered cards\n   *\n   * @returns Number of cards\n   */\n  getCardCount(): number {\n    return this.cards.size;\n  }\n\n  /**\n   * Clear all cards\n   *\n   * Removes all cards from the scene and clears the registry\n   */\n  clear(): void {\n    const ids = Array.from(this.cards.keys());\n    ids.forEach(id => this.unregisterCard(id));\n  }\n\n  /**\n   * Find cards by predicate\n   *\n   * @param predicate Function to test each card\n   * @returns Array of [id, card] pairs that match the predicate\n   */\n  findCards(predicate: (card: PixelCard, id: string) => boolean): Array<[string, PixelCard]> {\n    const results: Array<[string, PixelCard]> = [];\n\n    this.cards.forEach((card, id) => {\n      if (predicate(card, id)) {\n        results.push([id, card]);\n      }\n    });\n\n    return results;\n  }\n\n  /**\n   * Get card IDs matching a pattern\n   *\n   * @param pattern Regex pattern or string to match\n   * @returns Array of matching card IDs\n   */\n  getCardIdsByPattern(pattern: string | RegExp): string[] {\n    const regex = typeof pattern === 'string' ? new RegExp(pattern) : pattern;\n    return Array.from(this.cards.keys()).filter(id => regex.test(id));\n  }\n\n  /**\n   * Bring a group of cards to front together\n   *\n   * Useful for bringing paired cards or related cards to front as a group\n   *\n   * @param ids Array of card IDs to bring to front\n   */\n  bringGroupToFront(ids: string[]): void {\n    // Remove all cards from scene\n    ids.forEach(id => {\n      const card = this.cards.get(id);\n      if (card && this.scene.children.includes(card.container)) {\n        this.scene.removeChild(card.container);\n      }\n    });\n\n    // Re-add in order (first card in array will be at back, last at front)\n    ids.forEach(id => {\n      const card = this.cards.get(id);\n      if (card) {\n        this.scene.addChild(card.container);\n      }\n    });\n  }\n}\n","/**\n * LayoutManager - Manages card positioning and layouts\n *\n * Extracted from SpriteEditor to follow Single Responsibility Principle.\n * Handles layout presets, card positioning, dimension calculations, and viewport resizing.\n */\nimport * as PIXI from 'pixi.js';\nimport { PixelCard } from '../components/pixel-card';\nimport { ILayoutManager, LayoutSpec, CardPosition } from '../interfaces/managers';\nimport { GRID, BORDER, px } from 'moxi';\nimport { LAYOUT_CONSTANTS, CARD_CONSTANTS } from '../config/constants';\n\n/**\n * Manages card layouts and positioning\n */\nexport class LayoutManager implements ILayoutManager {\n  private layouts: Map<string, LayoutSpec> = new Map();\n  private renderer: PIXI.Renderer;\n  private currentLayout: string | null = null;\n\n  constructor(renderer: PIXI.Renderer) {\n    this.renderer = renderer;\n    this.registerDefaultLayouts();\n  }\n\n  /**\n   * Apply a layout preset\n   *\n   * @param layoutId Layout identifier\n   * @param cards Map of cards to position\n   */\n  applyLayout(layoutId: string, cards: Map<string, PixelCard>): void {\n    const layout = this.layouts.get(layoutId);\n    if (!layout) {\n      console.warn(`Layout \"${layoutId}\" not found`);\n      return;\n    }\n\n    // Apply each card position\n    Object.entries(layout.positions).forEach(([cardId, position]) => {\n      const card = cards.get(cardId);\n      if (card) {\n        this.positionCard(card, position);\n      }\n    });\n\n    this.currentLayout = layoutId;\n  }\n\n  /**\n   * Apply the default layout\n   *\n   * @param cards Map of cards to position\n   */\n  applyDefaultLayout(cards: Map<string, PixelCard>): void {\n    // Calculate key dimensions\n    const titleBarHeight = this.calculateTitleBarHeight();\n    const commanderBarHeight = px(12) + px(BORDER.total * 2) + titleBarHeight;\n    const topOffset = commanderBarHeight + px(GRID.gap * 2);\n\n    // Position commander bar at top\n    const commanderCard = cards.get('commander');\n    if (commanderCard) {\n      commanderCard.container.position.set(0, 0);\n    }\n\n    // Position palette below commander, docked to left\n    const paletteCard = cards.get('palette');\n    if (paletteCard) {\n      paletteCard.container.position.set(0, topOffset);\n    }\n\n    // Position info bar at bottom (full width)\n    const infoCard = cards.get('info');\n    if (infoCard) {\n      const barHeight = 8;\n      const cardTotalHeight = this.calculateCardHeightFromContent(barHeight);\n      const y = this.renderer.height - cardTotalHeight;\n      infoCard.container.position.set(0, y);\n    }\n\n    this.currentLayout = 'default';\n  }\n\n  /**\n   * Position a single card\n   *\n   * @param card Card to position\n   * @param position Position specification\n   */\n  positionCard(card: PixelCard, position: CardPosition): void {\n    card.container.position.set(position.x, position.y);\n\n    // Apply size if specified\n    if (position.width !== undefined && position.height !== undefined) {\n      card.setContentSize(position.width, position.height);\n    }\n  }\n\n  /**\n   * Get a layout by ID\n   *\n   * @param id Layout identifier\n   * @returns The layout or undefined if not found\n   */\n  getLayout(id: string): LayoutSpec | undefined {\n    return this.layouts.get(id);\n  }\n\n  /**\n   * Register a custom layout\n   *\n   * @param layout Layout specification\n   */\n  registerLayout(layout: LayoutSpec): void {\n    this.layouts.set(layout.id, layout);\n  }\n\n  /**\n   * Get all available layouts\n   *\n   * @returns Array of all layout specifications\n   */\n  getAllLayouts(): LayoutSpec[] {\n    return Array.from(this.layouts.values());\n  }\n\n  /**\n   * Calculate card dimensions based on content size\n   *\n   * @param contentWidth Content width in grid units\n   * @param contentHeight Content height in grid units\n   * @returns Card dimensions in pixels\n   */\n  calculateCardDimensions(contentWidth: number, contentHeight: number): { width: number; height: number } {\n    const titleBarHeight = this.calculateTitleBarHeight();\n\n    const width = this.calculateCardWidth(contentWidth);\n    const height = this.calculateCardHeight(contentHeight);\n\n    return { width, height };\n  }\n\n  /**\n   * Handle viewport resize\n   *\n   * This method should be called when the renderer size changes\n   * to reposition cards that are anchored to viewport edges\n   *\n   * @param width New viewport width\n   * @param height New viewport height\n   */\n  onViewportResize(width: number, height: number): void {\n    // This would typically trigger a layout re-application\n    // For now, we just store the new dimensions\n    console.log(`Viewport resized to ${width}x${height}`);\n\n    // In a full implementation, this would:\n    // 1. Adjust cards anchored to right/bottom edges\n    // 2. Ensure cards don't go off-screen\n    // 3. Reapply layout if needed\n  }\n\n  /**\n   * Calculate title bar height dynamically based on GRID.fontScale\n   *\n   * @private\n   */\n  private calculateTitleBarHeight(): number {\n    const fontHeight = CARD_CONSTANTS.TITLE_FONT_SCALE_MULTIPLIER * GRID.fontScale;\n    const verticalPadding = px(GRID.padding * CARD_CONSTANTS.TITLE_PADDING_MULTIPLIER);\n    return Math.ceil(fontHeight + verticalPadding);\n  }\n\n  /**\n   * Calculate total card width in pixels given content width in grid units\n   *\n   * @private\n   */\n  private calculateCardWidth(contentWidthGridUnits: number): number {\n    const cardWidthGridUnits = contentWidthGridUnits + BORDER.total * 2 + GRID.padding * 2;\n    return px(cardWidthGridUnits);\n  }\n\n  /**\n   * Calculate total card height in pixels given content height in grid units\n   *\n   * @private\n   */\n  private calculateCardHeight(contentHeightGridUnits: number): number {\n    const titleBarHeightPx = this.calculateTitleBarHeight();\n    return px(contentHeightGridUnits) + px(BORDER.total * 2) + titleBarHeightPx + px(GRID.padding * 2);\n  }\n\n  /**\n   * Calculate total card height from content height\n   * Helper that wraps calculateCardHeight for public use\n   *\n   * @param contentHeightGridUnits Content height in grid units\n   * @returns Total card height in pixels\n   */\n  calculateCardHeightFromContent(contentHeightGridUnits: number): number {\n    return this.calculateCardHeight(contentHeightGridUnits);\n  }\n\n  /**\n   * Calculate content width needed for edge-to-edge card (full viewport width)\n   *\n   * @param rendererWidth Viewport width in pixels\n   * @returns Content width in grid units\n   */\n  calculateFullWidthContentSize(rendererWidth: number): number {\n    return Math.floor(rendererWidth / px(1)) - (BORDER.total * 2) - (GRID.padding * 2);\n  }\n\n  /**\n   * Register default layouts\n   *\n   * @private\n   */\n  private registerDefaultLayouts(): void {\n    // Default layout\n    this.registerLayout({\n      id: 'default',\n      name: 'Default Layout',\n      positions: {\n        commander: { x: 0, y: 0 },\n        palette: { x: 0, y: 100 }, // Will be calculated dynamically\n        info: { x: 0, y: 700 }, // Will be calculated dynamically\n      },\n    });\n\n    // Compact layout\n    this.registerLayout({\n      id: 'compact',\n      name: 'Compact Layout',\n      positions: {\n        commander: { x: 0, y: 0 },\n        palette: { x: 0, y: 80 },\n        tool: { x: 300, y: 80 },\n        info: { x: 0, y: 700 },\n      },\n    });\n\n    // Fullscreen layout\n    this.registerLayout({\n      id: 'fullscreen',\n      name: 'Fullscreen Layout',\n      positions: {\n        commander: { x: 0, y: 0 },\n        info: { x: 0, y: 700 },\n      },\n    });\n  }\n\n  /**\n   * Get current layout ID\n   *\n   * @returns Current layout identifier or null\n   */\n  getCurrentLayoutId(): string | null {\n    return this.currentLayout;\n  }\n\n  /**\n   * Center a card in the viewport\n   *\n   * @param card Card to center\n   */\n  centerCard(card: PixelCard): void {\n    const cardWidth = card.getPixelWidth();\n    const cardHeight = card.getPixelHeight();\n\n    const x = (this.renderer.width - cardWidth) / 2;\n    const y = (this.renderer.height - cardHeight) / 2;\n\n    card.container.position.set(x, y);\n  }\n\n  /**\n   * Align a card to an edge of the viewport\n   *\n   * @param card Card to align\n   * @param edge Edge to align to\n   * @param offset Optional offset from edge in pixels\n   */\n  alignCardToEdge(\n    card: PixelCard,\n    edge: 'top' | 'right' | 'bottom' | 'left',\n    offset: number = 0\n  ): void {\n    const cardWidth = card.getPixelWidth();\n    const cardHeight = card.getPixelHeight();\n    const currentPos = card.container.position;\n\n    switch (edge) {\n      case 'top':\n        card.container.position.set(currentPos.x, offset);\n        break;\n      case 'right':\n        card.container.position.set(this.renderer.width - cardWidth - offset, currentPos.y);\n        break;\n      case 'bottom':\n        card.container.position.set(currentPos.x, this.renderer.height - cardHeight - offset);\n        break;\n      case 'left':\n        card.container.position.set(offset, currentPos.y);\n        break;\n    }\n  }\n\n  /**\n   * Position a card relative to another card\n   *\n   * @param card Card to position\n   * @param referenceCard Reference card\n   * @param direction Direction relative to reference card\n   * @param gap Gap between cards in pixels\n   */\n  positionRelativeTo(\n    card: PixelCard,\n    referenceCard: PixelCard,\n    direction: 'above' | 'below' | 'left' | 'right',\n    gap: number = LAYOUT_CONSTANTS.CARD_GAP\n  ): void {\n    const refPos = referenceCard.container.position;\n    const refWidth = referenceCard.getPixelWidth();\n    const refHeight = referenceCard.getPixelHeight();\n    const cardWidth = card.getPixelWidth();\n    const cardHeight = card.getPixelHeight();\n\n    switch (direction) {\n      case 'above':\n        card.container.position.set(refPos.x, refPos.y - cardHeight - gap);\n        break;\n      case 'below':\n        card.container.position.set(refPos.x, refPos.y + refHeight + gap);\n        break;\n      case 'left':\n        card.container.position.set(refPos.x - cardWidth - gap, refPos.y);\n        break;\n      case 'right':\n        card.container.position.set(refPos.x + refWidth + gap, refPos.y);\n        break;\n    }\n  }\n}\n","/**\n * FileOperationsManager - Manages file I/O operations\n *\n * Extracted from SpriteEditor to follow Single Responsibility Principle.\n * Handles save/load project files, PNG export, and file dialogs.\n */\nimport { IFileOperationsManager } from '../interfaces/managers';\nimport { ProjectState } from '../state/project-state-manager';\nimport { SpriteSheetController } from '../controllers/sprite-sheet-controller';\nimport { SpriteController } from '../controllers/sprite-controller';\nimport { FILE_CONSTANTS } from '../config/constants';\n\n/**\n * Manages all file operations in the editor\n */\nexport class FileOperationsManager implements IFileOperationsManager {\n  private lastSavedFileName: string | null = null;\n\n  /**\n   * Save project to file\n   *\n   * Downloads a .moxiproject JSON file with the current project state\n   *\n   * @param projectState Project state to save\n   */\n  async saveProject(projectState: ProjectState): Promise<void> {\n    if (!this.supportsFileOperations()) {\n      throw new Error('File operations not supported in this browser');\n    }\n\n    const json = JSON.stringify(projectState, null, 2);\n    const blob = new Blob([json], { type: 'application/json' });\n\n    // Generate filename\n    const timestamp = new Date().toISOString().split('T')[0];\n    const filename = `${FILE_CONSTANTS.DEFAULT_PROJECT_NAME}-${timestamp}${FILE_CONSTANTS.PROJECT_FILE_EXTENSION}`;\n\n    // Download file\n    this.downloadBlob(blob, filename);\n    this.lastSavedFileName = filename;\n  }\n\n  /**\n   * Load project from file\n   *\n   * Opens a file picker and loads a .moxiproject JSON file\n   *\n   * @returns Loaded project state or null if cancelled/failed\n   */\n  async loadProject(): Promise<ProjectState | null> {\n    if (!this.supportsFileOperations()) {\n      throw new Error('File operations not supported in this browser');\n    }\n\n    return new Promise((resolve) => {\n      const input = document.createElement('input');\n      input.type = 'file';\n      input.accept = FILE_CONSTANTS.PROJECT_FILE_EXTENSION;\n\n      input.onchange = async (e: Event) => {\n        const target = e.target as HTMLInputElement;\n        const file = target.files?.[0];\n\n        if (!file) {\n          resolve(null);\n          return;\n        }\n\n        try {\n          const text = await file.text();\n          const json = JSON.parse(text);\n\n          // Basic validation\n          if (!json.version || !json.spriteSheets) {\n            console.error('Invalid project file format');\n            resolve(null);\n            return;\n          }\n\n          this.lastSavedFileName = file.name;\n          resolve(json as ProjectState);\n        } catch (error) {\n          console.error('Failed to load project file:', error);\n          resolve(null);\n        }\n      };\n\n      input.oncancel = () => {\n        resolve(null);\n      };\n\n      input.click();\n    });\n  }\n\n  /**\n   * Export sprite sheet as PNG\n   *\n   * Renders the sprite sheet to a canvas and downloads it as PNG\n   *\n   * @param spriteSheet Sprite sheet controller to export\n   * @param filename Optional custom filename\n   */\n  async exportPNG(spriteSheet: SpriteSheetController, filename?: string): Promise<void> {\n    if (!this.supportsFileOperations()) {\n      throw new Error('File operations not supported in this browser');\n    }\n\n    // Get sprite sheet data\n    const config = spriteSheet.getConfig();\n    const pixels = spriteSheet.getPixelData();\n\n    // Create canvas\n    const canvas = document.createElement('canvas');\n    canvas.width = config.width;\n    canvas.height = config.height;\n\n    const ctx = canvas.getContext('2d');\n    if (!ctx) {\n      throw new Error('Failed to get 2D context from canvas');\n    }\n\n    // Render pixels to canvas\n    for (let y = 0; y < config.height; y++) {\n      for (let x = 0; x < config.width; x++) {\n        const colorIndex = pixels[y][x];\n        const color = config.palette[colorIndex];\n\n        const r = (color >> 16) & 0xff;\n        const g = (color >> 8) & 0xff;\n        const b = color & 0xff;\n\n        ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;\n        ctx.fillRect(x, y, 1, 1);\n      }\n    }\n\n    // Convert to PNG blob\n    const blob = await this.canvasToBlob(canvas);\n\n    // Generate filename\n    const timestamp = new Date().toISOString().split('T')[0];\n    const exportFilename = filename || `spritesheet-${config.type.toLowerCase()}-${timestamp}${FILE_CONSTANTS.PNG_EXPORT_EXTENSION}`;\n\n    // Download\n    this.downloadBlob(blob, exportFilename);\n  }\n\n  /**\n   * Export individual sprite as PNG\n   *\n   * Renders an 8x8 sprite to a canvas and downloads it as PNG\n   *\n   * @param sprite Sprite controller to export\n   * @param filename Optional custom filename\n   */\n  async exportSpritePNG(sprite: SpriteController, filename?: string): Promise<void> {\n    if (!this.supportsFileOperations()) {\n      throw new Error('File operations not supported in this browser');\n    }\n\n    // Get sprite data\n    const { x: cellX, y: cellY } = sprite.getCell();\n    const sheetController = (sprite as any).spriteSheetController as SpriteSheetController;\n    const config = sheetController.getConfig();\n\n    // Create canvas\n    const canvas = document.createElement('canvas');\n    canvas.width = 8;\n    canvas.height = 8;\n\n    const ctx = canvas.getContext('2d');\n    if (!ctx) {\n      throw new Error('Failed to get 2D context from canvas');\n    }\n\n    // Render 8x8 sprite\n    for (let y = 0; y < 8; y++) {\n      for (let x = 0; x < 8; x++) {\n        const colorIndex = sprite.getPixel(x, y);\n        const color = config.palette[colorIndex];\n\n        const r = (color >> 16) & 0xff;\n        const g = (color >> 8) & 0xff;\n        const b = color & 0xff;\n\n        ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;\n        ctx.fillRect(x, y, 1, 1);\n      }\n    }\n\n    // Convert to PNG blob\n    const blob = await this.canvasToBlob(canvas);\n\n    // Generate filename\n    const exportFilename = filename || `sprite-${cellX}-${cellY}${FILE_CONSTANTS.PNG_EXPORT_EXTENSION}`;\n\n    // Download\n    this.downloadBlob(blob, exportFilename);\n  }\n\n  /**\n   * Check if browser supports file operations\n   *\n   * @returns True if file operations are supported\n   */\n  supportsFileOperations(): boolean {\n    return typeof window !== 'undefined' && typeof document !== 'undefined';\n  }\n\n  /**\n   * Get the last saved file name\n   *\n   * @returns Last saved filename or null\n   */\n  getLastSavedFileName(): string | null {\n    return this.lastSavedFileName;\n  }\n\n  /**\n   * Download a blob as a file\n   *\n   * @private\n   * @param blob Blob to download\n   * @param filename Filename for the download\n   */\n  private downloadBlob(blob: Blob, filename: string): void {\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = filename;\n    link.click();\n\n    // Clean up\n    setTimeout(() => URL.revokeObjectURL(url), 100);\n  }\n\n  /**\n   * Convert canvas to PNG blob\n   *\n   * @private\n   * @param canvas Canvas element to convert\n   * @returns Promise resolving to PNG blob\n   */\n  private canvasToBlob(canvas: HTMLCanvasElement): Promise<Blob> {\n    return new Promise((resolve, reject) => {\n      canvas.toBlob((blob) => {\n        if (blob) {\n          resolve(blob);\n        } else {\n          reject(new Error('Failed to convert canvas to blob'));\n        }\n      }, 'image/png');\n    });\n  }\n\n  /**\n   * Export sprite sheet with custom scale (for high-res exports)\n   *\n   * @param spriteSheet Sprite sheet controller to export\n   * @param scale Scale factor (e.g., 2 for 2x resolution)\n   * @param filename Optional custom filename\n   */\n  async exportScaledPNG(\n    spriteSheet: SpriteSheetController,\n    scale: number,\n    filename?: string\n  ): Promise<void> {\n    if (!this.supportsFileOperations()) {\n      throw new Error('File operations not supported in this browser');\n    }\n\n    // Get sprite sheet data\n    const config = spriteSheet.getConfig();\n    const pixels = spriteSheet.getPixelData();\n\n    // Create canvas with scaled dimensions\n    const canvas = document.createElement('canvas');\n    canvas.width = config.width * scale;\n    canvas.height = config.height * scale;\n\n    const ctx = canvas.getContext('2d');\n    if (!ctx) {\n      throw new Error('Failed to get 2D context from canvas');\n    }\n\n    // Disable image smoothing for pixel-perfect scaling\n    ctx.imageSmoothingEnabled = false;\n\n    // Render pixels to canvas with scaling\n    for (let y = 0; y < config.height; y++) {\n      for (let x = 0; x < config.width; x++) {\n        const colorIndex = pixels[y][x];\n        const color = config.palette[colorIndex];\n\n        const r = (color >> 16) & 0xff;\n        const g = (color >> 8) & 0xff;\n        const b = color & 0xff;\n\n        ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;\n        ctx.fillRect(x * scale, y * scale, scale, scale);\n      }\n    }\n\n    // Convert to PNG blob\n    const blob = await this.canvasToBlob(canvas);\n\n    // Generate filename\n    const timestamp = new Date().toISOString().split('T')[0];\n    const exportFilename = filename || `spritesheet-${config.type.toLowerCase()}-${scale}x-${timestamp}${FILE_CONSTANTS.PNG_EXPORT_EXTENSION}`;\n\n    // Download\n    this.downloadBlob(blob, exportFilename);\n  }\n\n  /**\n   * Clear the last saved filename\n   *\n   * Useful when creating a new project\n   */\n  clearLastSavedFileName(): void {\n    this.lastSavedFileName = null;\n  }\n}\n","/**\n * Sprite Editor (Refactored) - Main orchestrator class\n *\n * REFACTORED to use manager pattern for better separation of concerns:\n * - SpriteSheetManager: Sprite sheet lifecycle\n * - UIManager: Card registry and z-ordering\n * - LayoutManager: Positioning and layouts\n * - FileOperationsManager: Save/load/export\n *\n * This reduces the class from 1040 lines to ~400 lines with clear responsibilities.\n */\nimport * as PIXI from 'pixi.js';\nimport { PixelCard } from './components/pixel-card';\nimport { createPixelDialog } from './components/pixel-dialog';\nimport { createSpriteSheetCard, SPRITESHEET_CONFIGS } from './components/spritesheet-card';\nimport { createSpriteCard } from './components/sprite-card';\nimport { SpriteController } from './controllers/sprite-controller';\nimport { SpriteSheetType } from './controllers/sprite-sheet-controller';\nimport { UIStateManager } from './state/ui-state-manager';\nimport { ProjectStateManager, ProjectState, SpriteSheetState } from './state/project-state-manager';\nimport { LayoutStateManager, LayoutSlotState } from './state/layout-state-manager';\nimport { getTheme } from './theming/theme';\nimport { PICO8_PALETTE } from './theming/palettes';\nimport { GRID, BORDER, px } from 'moxi';\n\n// Card imports\nimport { createPaletteCard, PaletteCardResult } from './cards/palette-card';\nimport { createInfoBarCard, InfoBarCardResult } from './cards/info-bar-card';\nimport { createCommanderBarCard, CommanderBarCardResult } from './cards/commander-bar-card';\nimport { createCardZoomHandler } from './utilities/card-zoom-handler';\n\n// Manager imports\nimport { SpriteSheetManager } from './managers/sprite-sheet-manager';\nimport { UIManager } from './managers/ui-manager';\nimport { LayoutManager } from './managers/layout-manager';\nimport { FileOperationsManager } from './managers/file-operations-manager';\nimport { SpriteSheetInstance } from './interfaces/managers';\n\n// Utility imports\nimport { PixelRenderer } from './utilities/pixel-renderer';\n\nexport interface SpriteEditorOptions {\n  renderer: PIXI.Renderer;\n  scene: PIXI.Container;\n  maxSpriteSheets?: number;\n}\n\n/**\n * Main Sprite Editor class (Refactored)\n * Now acts as a lightweight orchestrator that delegates to specialized managers\n */\nexport class SpriteEditor {\n  // Managers\n  private spriteSheetManager: SpriteSheetManager;\n  private uiManager: UIManager;\n  private layoutManager: LayoutManager;\n  private fileOperationsManager: FileOperationsManager;\n\n  // Core dependencies\n  private renderer: PIXI.Renderer;\n  private scene: PIXI.Container;\n\n  // UI Cards (only persistent cards stored here)\n  private commanderBarCard?: CommanderBarCardResult;\n  private paletteCard?: PaletteCardResult;\n  private infoBarCard?: InfoBarCardResult;\n\n  // Editor state\n  private currentPalette: number[] = PICO8_PALETTE;\n  private selectedColorIndex: number = 0;\n  private projectState: ProjectState;\n  private hasUnsavedChanges: boolean = false;\n\n  // Timers for debounced saves\n  private uiStateSaveTimer: number | null = null;\n  private projectSaveTimer: number | null = null;\n\n  constructor(options: SpriteEditorOptions) {\n    this.renderer = options.renderer;\n    this.scene = options.scene;\n\n    // Initialize managers\n    this.spriteSheetManager = new SpriteSheetManager();\n    this.uiManager = new UIManager(this.scene);\n    this.layoutManager = new LayoutManager(this.renderer);\n    this.fileOperationsManager = new FileOperationsManager();\n\n    // Initialize or load project state\n    const savedProject = ProjectStateManager.loadProject();\n    this.projectState = savedProject ?? ProjectStateManager.createEmptyProject();\n\n    // Subscribe to sprite sheet manager events\n    this.spriteSheetManager.on('activeChanged', (id) => {\n      this.updatePaletteForActiveSheet();\n    });\n  }\n\n  /**\n   * Initialize and create all UI elements\n   */\n  async initialize(): Promise<void> {\n    await this.recreateUI();\n  }\n\n  /**\n   * Register a card and setup auto-save on state changes\n   */\n  private registerCard(id: string, card: PixelCard): void {\n    this.uiManager.registerCard(id, card);\n    card.onStateChanged(() => this.saveUIState());\n  }\n\n  /**\n   * Save current UI state to localStorage (debounced)\n   */\n  private saveUIState(): void {\n    if (this.uiStateSaveTimer) {\n      clearTimeout(this.uiStateSaveTimer);\n    }\n\n    this.uiStateSaveTimer = window.setTimeout(() => {\n      const stateMap = this.uiManager.exportAllStates();\n      UIStateManager.saveState(stateMap, this.renderer.width, this.renderer.height);\n    }, 500);\n  }\n\n  /**\n   * Restore UI state from localStorage\n   */\n  private restoreUIState(): boolean {\n    const savedState = UIStateManager.loadState();\n    if (!savedState) return false;\n\n    const adjustedState = UIStateManager.adjustForCanvasSize(\n      savedState,\n      this.renderer.width,\n      this.renderer.height\n    );\n\n    // Use UIManager to import states\n    this.uiManager.importStates(new Map(adjustedState.cards.map(cs => [cs.id, cs])));\n\n    console.log(' UI state restored');\n    return true;\n  }\n\n  /**\n   * Apply default layout positions to all cards\n   */\n  private applyDefaultLayout(): void {\n    // Delegate to LayoutManager\n    this.layoutManager.applyDefaultLayout(this.uiManager.getAllCards());\n\n    // Position sprite sheet instances\n    const spriteSheets = this.spriteSheetManager.getAll();\n    const infoCard = this.uiManager.getCard('info');\n\n    spriteSheets.forEach((instance, index) => {\n      if (instance.sheetCard) {\n        const card = instance.sheetCard.card;\n\n        // Set minimap size and scale\n        const desiredContentWidth = 50;\n        const desiredContentHeight = 50;\n\n        instance.sheetCard.controller.setScale(5);\n        instance.sheetCard.controller.selectCell(0, 0);\n        instance.sheetCard.controller.positionCell00AtTopLeft();\n\n        card.setContentSize(desiredContentWidth, desiredContentHeight);\n        instance.sheetCard.controller.render(card.getContentContainer());\n\n        // Position at bottom right\n        const defaultX = this.renderer.width - card.getPixelWidth();\n        const defaultY = infoCard\n          ? infoCard.container.y - card.getPixelHeight() - px(GRID.gap)\n          : this.renderer.height - card.getPixelHeight();\n\n        card.container.position.set(defaultX, defaultY);\n      }\n    });\n\n    // Center sprite cards\n    const commanderBarHeight = px(12) + px(BORDER.total * 2) + 24;\n    this.uiManager.getAllCards().forEach((card, id) => {\n      if (id.startsWith('sprite-card-')) {\n        const x = (this.renderer.width - card.getPixelWidth()) / 2;\n        const y = px(GRID.margin) + commanderBarHeight + px(GRID.gap * 2);\n        card.container.position.set(x, y);\n      }\n    });\n\n    this.saveUIState();\n    console.log(' Default layout applied');\n  }\n\n  /**\n   * Updates the palette card to match the active sprite sheet\n   */\n  private updatePaletteForActiveSheet(): void {\n    const activeSheet = this.spriteSheetManager.getActive();\n    if (!activeSheet || !this.paletteCard) return;\n\n    this.currentPalette = activeSheet.sheetCard.controller.getConfig().palette;\n    this.paletteCard.setPalette(this.currentPalette);\n  }\n\n  /**\n   * Creates a new sprite sheet and sprite card\n   */\n  private createNewSpriteSheet(type: SpriteSheetType, showGrid: boolean, savedState?: SpriteSheetState): void {\n    // Validate using SpriteSheetManager\n    if (!savedState) {\n      const validation = this.spriteSheetManager.validate(type);\n      if (!validation.valid) {\n        const dialog = createPixelDialog({\n          title: 'Cannot Create Sprite Sheet',\n          message: validation.message || 'Validation failed',\n          buttons: [{ label: 'OK', onClick: () => {} }],\n          renderer: this.renderer\n        });\n        this.scene.addChild(dialog);\n        return;\n      }\n    }\n\n    // Create instance via manager (with saved ID if available)\n    const instance = this.spriteSheetManager.create(type, savedState?.id);\n\n    // Function to make this sprite sheet active\n    const makeThisSheetActive = () => {\n      this.spriteSheetManager.setActive(instance.id);\n\n      // Bring cards to front using UIManager\n      if (instance.sheetCard) {\n        const sheetIndex = this.spriteSheetManager.getAll().indexOf(instance);\n        this.uiManager.bringGroupToFront([\n          `sprite-sheet-${sheetIndex}`,\n          `sprite-card-${sheetIndex}`\n        ]);\n      }\n\n      console.log(`Activated ${type} sprite sheet`);\n    };\n\n    // Helper to create sprite card for a cell\n    const createSpriteCardForCell = (cellX: number, cellY: number) => {\n      // If sprite card already exists, update it instead of creating a new one\n      if (instance.spriteCard && instance.spriteController) {\n        console.log(`Updating sprite card to cell: ${cellX}, ${cellY}`);\n        instance.spriteController.setCell(cellX, cellY);\n        instance.spriteCard.redraw();\n        instance.sheetCard.controller.render(instance.sheetCard.card.getContentContainer());\n        makeThisSheetActive();\n        return;\n      }\n\n      console.log(`Creating sprite card for cell: ${cellX}, ${cellY}`);\n      makeThisSheetActive();\n\n      const spriteController = new SpriteController({\n        spriteSheetController: instance.sheetCard.controller,\n        cellX,\n        cellY,\n        scale: 32\n      });\n\n      // Calculate position\n      let spriteCardX: number;\n      let spriteCardY: number;\n\n      if (instance.spriteCard) {\n        spriteCardX = instance.spriteCard.card.container.x;\n        spriteCardY = instance.spriteCard.card.container.y;\n        this.scene.removeChild(instance.spriteCard.card.container);\n      } else {\n        const dims = spriteController.getScaledDimensions();\n        const commanderBarHeight = px(12) + px(BORDER.total * 2) + 24;\n        spriteCardX = (this.renderer.width - dims.width) / 2;\n        spriteCardY = px(GRID.margin) + commanderBarHeight + px(GRID.gap * 2);\n      }\n\n      const spriteCardResult = createSpriteCard({\n        x: spriteCardX,\n        y: spriteCardY,\n        renderer: this.renderer,\n        spriteController,\n        onPixelClick: (x, y) => {\n          spriteController.setPixel(x, y, this.selectedColorIndex);\n\n          // Re-render using PixelRenderer utility in the future\n          spriteController.render(spriteCardResult.card.getContentContainer().children[0] as PIXI.Container);\n          instance.sheetCard.controller.render(instance.sheetCard.card.getContentContainer());\n\n          this.saveProjectState();\n        },\n        onFocus: makeThisSheetActive\n      });\n\n      this.scene.addChild(spriteCardResult.card.container);\n      instance.spriteCard = spriteCardResult;\n      instance.spriteController = spriteController;\n\n      const sheetIndex = this.spriteSheetManager.getAll().indexOf(instance);\n      this.registerCard(`sprite-card-${sheetIndex}`, spriteCardResult.card);\n\n      // Link paired cards\n      spriteCardResult.card.setPairedCard(instance.sheetCard.card);\n      instance.sheetCard.card.setPairedCard(spriteCardResult.card);\n\n      // Setup zoom handler\n      const handleSpriteZoom = createCardZoomHandler(this.renderer, spriteCardResult.card, (delta) => {\n        const currentScale = spriteController.getScale();\n        const zoomIncrement = delta * 2;\n        const newScale = Math.max(1, Math.min(64, currentScale + zoomIncrement));\n\n        if (newScale !== currentScale) {\n          spriteController.setScale(newScale);\n          spriteCardResult.card.setTitle(`Sprite (${newScale}x)`);\n\n          const dims = spriteController.getScaledDimensions();\n          const newContentWidth = Math.ceil(dims.width / px(1));\n          const newContentHeight = Math.ceil(dims.height / px(1));\n          spriteCardResult.card.setContentSize(newContentWidth, newContentHeight);\n\n          spriteCardResult.redraw();\n        }\n      });\n\n      if (typeof window !== 'undefined') {\n        window.addEventListener('wheel', handleSpriteZoom, { passive: false });\n        spriteCardResult.card.container.on('destroyed', () => {\n          window.removeEventListener('wheel', handleSpriteZoom);\n        });\n      }\n    };\n\n    // Create sprite sheet card\n    const spriteSheetResult = createSpriteSheetCard({\n      config: SPRITESHEET_CONFIGS[type],\n      renderer: this.renderer,\n      showGrid,\n      onCellHover: (cellX, cellY) => {\n        console.log(`Hovering cell: ${cellX}, ${cellY}`);\n      },\n      onCellClick: (cellX, cellY) => {\n        createSpriteCardForCell(cellX, cellY);\n        this.saveProjectState();\n      },\n      onFocus: makeThisSheetActive\n    });\n\n    this.scene.addChild(spriteSheetResult.card.container);\n    instance.sheetCard = spriteSheetResult;\n\n    // Restore pixel data if loading from saved state\n    if (savedState) {\n      spriteSheetResult.controller.setPixelData(savedState.pixels);\n      if (savedState.scale) {\n        spriteSheetResult.controller.setScale(savedState.scale);\n      }\n      spriteSheetResult.controller.render(spriteSheetResult.card.getContentContainer());\n    }\n\n    // Register with UIManager\n    const sheetIndex = this.spriteSheetManager.count() - 1;\n    this.registerCard(`sprite-sheet-${sheetIndex}`, spriteSheetResult.card);\n\n    // Set as active\n    this.spriteSheetManager.setActive(instance.id);\n\n    // Default zoom if new\n    if (!savedState) {\n      spriteSheetResult.controller.setScale(4);\n      const dims = spriteSheetResult.controller.getScaledDimensions();\n      const newContentWidth = Math.ceil(dims.width / px(1));\n      const newContentHeight = Math.ceil(dims.height / px(1));\n      spriteSheetResult.card.setContentSize(newContentWidth, newContentHeight);\n      spriteSheetResult.controller.render(spriteSheetResult.card.getContentContainer());\n    }\n\n    // Create sprite card for initial cell\n    // Note: selectCell() triggers onCellClick which calls createSpriteCardForCell\n    const cellX = savedState?.selectedCellX ?? 0;\n    const cellY = savedState?.selectedCellY ?? 0;\n    spriteSheetResult.controller.selectCell(cellX, cellY);\n\n    if (savedState) {\n      const contentState = spriteSheetResult.card.getContentSize();\n      const contentWidthPx = px(contentState.width);\n      const contentHeightPx = px(contentState.height);\n      spriteSheetResult.controller.centerCell(cellX, cellY, contentWidthPx, contentHeightPx);\n    }\n\n    // Restore sprite card scale if saved\n    if (savedState?.spriteCardScale && instance.spriteController) {\n      instance.spriteController.setScale(savedState.spriteCardScale);\n      if (instance.spriteCard) {\n        instance.spriteCard.card.setTitle(`Sprite (${savedState.spriteCardScale}x)`);\n        const dims = instance.spriteController.getScaledDimensions();\n        const newContentWidth = Math.ceil(dims.width / px(1));\n        const newContentHeight = Math.ceil(dims.height / px(1));\n        instance.spriteCard.card.setContentSize(newContentWidth, newContentHeight);\n        instance.spriteCard.redraw();\n      }\n    }\n\n    console.log(`Created ${type} sprite sheet`);\n    this.saveProjectState();\n  }\n\n  /**\n   * Update theme without losing state\n   */\n  updateTheme(): void {\n    this.renderer.background.color = getTheme().backgroundRoot;\n\n    // Refresh all cards\n    if (this.commanderBarCard) this.commanderBarCard.card.refresh();\n    if (this.paletteCard) this.paletteCard.card.refresh();\n    if (this.infoBarCard) this.infoBarCard.card.refresh();\n\n    this.spriteSheetManager.getAll().forEach(instance => {\n      if (instance.sheetCard) instance.sheetCard.card.refresh();\n      if (instance.spriteCard) instance.spriteCard.card.refresh();\n    });\n\n    console.log(' Theme updated');\n  }\n\n  /**\n   * Recreate all UI with current theme\n   */\n  async recreateUI(): Promise<void> {\n    this.scene.removeChildren();\n    this.renderer.background.color = getTheme().backgroundRoot;\n\n    // Create commander bar\n    this.commanderBarCard = createCommanderBarCard({\n      x: px(GRID.margin),\n      y: px(GRID.margin),\n      renderer: this.renderer,\n      scene: this.scene,\n      callbacks: {\n        onNew: () => this.handleNew(),\n        onSave: () => this.handleSave(),\n        onLoad: () => this.handleLoad(),\n        onExport: () => this.handleExport(),\n        onApplyLayout: () => this.applyDefaultLayout(),\n        onSaveLayoutSlot: (slot) => this.handleSaveLayoutSlot(slot),\n        onLoadLayoutSlot: (slot) => this.handleLoadLayoutSlot(slot),\n        hasLayoutSlot: (slot) => LayoutStateManager.hasLayoutSlot(slot),\n        onThemeChange: () => this.updateTheme(),\n        onScaleChange: (scale) => this.handleScaleChange(scale)\n      }\n    });\n    this.scene.addChild(this.commanderBarCard.card.container);\n    this.registerCard('commander', this.commanderBarCard.card);\n\n    // Create palette card\n    const commanderBarHeight = px(12) + px(BORDER.total * 2) + 24;\n    const topOffset = px(GRID.margin) + commanderBarHeight + px(GRID.gap * 2);\n\n    this.paletteCard = createPaletteCard({\n      x: px(GRID.margin),\n      y: topOffset,\n      renderer: this.renderer,\n      palette: this.currentPalette,\n      selectedColorIndex: this.selectedColorIndex,\n      onColorSelect: (colorIndex) => {\n        this.selectedColorIndex = colorIndex;\n      }\n    });\n    this.scene.addChild(this.paletteCard.card.container);\n    this.registerCard('palette', this.paletteCard.card);\n\n    // Create info bar using LayoutManager\n    const barHeight = 8;\n    const cardTotalHeight = this.layoutManager.calculateCardHeightFromContent(barHeight);\n    const infoY = this.renderer.height - cardTotalHeight;\n    const infoBarWidth = this.layoutManager.calculateFullWidthContentSize(this.renderer.width);\n\n    this.infoBarCard = createInfoBarCard({\n      x: 0,\n      y: infoY,\n      renderer: this.renderer,\n      width: infoBarWidth\n    });\n    this.scene.addChild(this.infoBarCard.card.container);\n    this.registerCard('info', this.infoBarCard.card);\n\n    // Load project state\n    this.loadProjectState();\n\n    // Restore UI state\n    this.restoreUIState();\n  }\n\n  /**\n   * Save current project state (debounced)\n   */\n  private saveProjectState(): void {\n    this.hasUnsavedChanges = true;\n\n    if (this.projectSaveTimer) {\n      clearTimeout(this.projectSaveTimer);\n    }\n\n    this.projectSaveTimer = window.setTimeout(() => {\n      this.projectState.spriteSheets = this.spriteSheetManager.getAll().map(instance => {\n        const cell = instance.sheetCard.controller.getSelectedCell();\n        const state: SpriteSheetState = {\n          id: instance.id,\n          type: instance.sheetCard.controller.getConfig().type,\n          showGrid: false,\n          pixels: instance.sheetCard.controller.getPixelData(),\n          selectedCellX: cell.x,\n          selectedCellY: cell.y,\n          scale: instance.sheetCard.controller.getScale(),\n          spriteCardScale: instance.spriteController?.getScale()\n        };\n        return state;\n      });\n\n      const activeSheet = this.spriteSheetManager.getActive();\n      this.projectState.activeSpriteSheetId = activeSheet?.id ?? null;\n      this.projectState.selectedColorIndex = this.selectedColorIndex;\n\n      ProjectStateManager.saveProject(this.projectState);\n    }, 1000);\n  }\n\n  /**\n   * Load project state and recreate sprite sheets\n   */\n  private loadProjectState(): void {\n    if (this.projectState.spriteSheets.length === 0) {\n      console.log('No sprite sheets in project state');\n      return;\n    }\n\n    this.selectedColorIndex = this.projectState.selectedColorIndex ?? 0;\n\n    this.projectState.spriteSheets.forEach(sheetState => {\n      this.createNewSpriteSheet(sheetState.type, sheetState.showGrid, sheetState);\n    });\n\n    console.log(' Project state loaded');\n  }\n\n  /**\n   * Handle \"New\" button\n   */\n  private async handleNew(): Promise<void> {\n    if (this.spriteSheetManager.count() > 0) {\n      const dialog = createPixelDialog({\n        title: 'Save Current Project?',\n        message: 'You have unsaved work. Save before creating new project?',\n        buttons: [\n          {\n            label: 'Save',\n            onClick: () => {\n              this.handleSave();\n              setTimeout(() => this.createNewProject(), 100);\n            }\n          },\n          {\n            label: 'Discard',\n            onClick: () => {\n              this.createNewProject();\n            }\n          },\n          {\n            label: 'Cancel',\n            onClick: () => {}\n          }\n        ],\n        renderer: this.renderer\n      });\n      this.scene.addChild(dialog);\n    } else {\n      this.createNewProject();\n    }\n  }\n\n  /**\n   * Create a new project\n   */\n  private createNewProject(): void {\n    // Clear using managers\n    this.spriteSheetManager.getAll().forEach(instance => {\n      if (instance.sheetCard) this.scene.removeChild(instance.sheetCard.card.container);\n      if (instance.spriteCard) this.scene.removeChild(instance.spriteCard.card.container);\n    });\n\n    this.spriteSheetManager.clear();\n    this.projectState = ProjectStateManager.createEmptyProject();\n    this.hasUnsavedChanges = false;\n\n    // Show sprite sheet type dialog\n    const dialog = createPixelDialog({\n      title: 'New Sprite Sheet',\n      message: 'Choose sprite sheet type:',\n      checkboxes: [\n        {\n          name: 'showGrid',\n          label: 'Show 8x8 Grid',\n          defaultValue: true\n        }\n      ],\n      buttons: [\n        {\n          label: 'PICO-8',\n          onClick: (checkboxStates) => {\n            this.createNewSpriteSheet('PICO-8', checkboxStates?.showGrid ?? false);\n          }\n        },\n        {\n          label: 'TIC-80',\n          onClick: (checkboxStates) => {\n            this.createNewSpriteSheet('TIC-80', checkboxStates?.showGrid ?? false);\n          }\n        }\n      ],\n      renderer: this.renderer\n    });\n    this.scene.addChild(dialog);\n  }\n\n  /**\n   * Handle \"Save\" button - uses FileOperationsManager\n   */\n  private handleSave(): void {\n    if (this.projectSaveTimer) {\n      clearTimeout(this.projectSaveTimer);\n    }\n\n    // Update project state\n    this.projectState.spriteSheets = this.spriteSheetManager.getAll().map(instance => {\n      const cell = instance.sheetCard.controller.getSelectedCell();\n      return {\n        id: instance.id,\n        type: instance.sheetCard.controller.getConfig().type,\n        showGrid: false,\n        pixels: instance.sheetCard.controller.getPixelData(),\n        selectedCellX: cell.x,\n        selectedCellY: cell.y,\n        scale: instance.sheetCard.controller.getScale(),\n        spriteCardScale: instance.spriteController?.getScale()\n      };\n    });\n\n    const activeSheet = this.spriteSheetManager.getActive();\n    this.projectState.activeSpriteSheetId = activeSheet?.id ?? null;\n    this.projectState.selectedColorIndex = this.selectedColorIndex;\n\n    // Delegate to FileOperationsManager\n    this.fileOperationsManager.saveProject(this.projectState);\n    this.hasUnsavedChanges = false;\n  }\n\n  /**\n   * Handle \"Load\" button - uses FileOperationsManager\n   */\n  private async handleLoad(): Promise<void> {\n    if (this.spriteSheetManager.count() > 0 && this.hasUnsavedChanges) {\n      const dialog = createPixelDialog({\n        title: 'Unsaved Changes',\n        message: 'Loading will replace current project. Continue?',\n        buttons: [\n          {\n            label: 'Continue',\n            onClick: async () => {\n              await this.loadProjectFile();\n            }\n          },\n          {\n            label: 'Cancel',\n            onClick: () => {}\n          }\n        ],\n        renderer: this.renderer\n      });\n      this.scene.addChild(dialog);\n    } else {\n      await this.loadProjectFile();\n    }\n  }\n\n  /**\n   * Load a project file\n   */\n  private async loadProjectFile(): Promise<void> {\n    // Delegate to FileOperationsManager\n    const loadedState = await this.fileOperationsManager.loadProject();\n    if (!loadedState) {\n      console.log('No file selected or failed to load');\n      return;\n    }\n\n    // Clear existing work\n    this.spriteSheetManager.getAll().forEach(instance => {\n      if (instance.sheetCard) this.scene.removeChild(instance.sheetCard.card.container);\n      if (instance.spriteCard) this.scene.removeChild(instance.spriteCard.card.container);\n    });\n\n    this.spriteSheetManager.clear();\n    this.projectState = loadedState;\n    this.hasUnsavedChanges = false;\n\n    ProjectStateManager.saveProject(this.projectState);\n    this.loadProjectState();\n  }\n\n  /**\n   * Handle \"Export\" button - uses FileOperationsManager\n   */\n  private handleExport(): void {\n    const activeSheet = this.spriteSheetManager.getActive();\n    if (!activeSheet) {\n      const dialog = createPixelDialog({\n        title: 'No Sprite Sheet',\n        message: 'Please create a sprite sheet first.',\n        buttons: [{ label: 'OK', onClick: () => {} }],\n        renderer: this.renderer\n      });\n      this.scene.addChild(dialog);\n      return;\n    }\n\n    // Delegate to FileOperationsManager\n    this.fileOperationsManager.exportPNG(activeSheet.sheetCard.controller);\n  }\n\n  /**\n   * Handle saving layout to slot\n   */\n  private handleSaveLayoutSlot(slot: 'A' | 'B' | 'C'): void {\n    const layoutState: LayoutSlotState = { cards: [] };\n\n    this.uiManager.getAllCards().forEach((card, id) => {\n      const contentSize = card.getContentSize();\n      layoutState.cards.push({\n        id,\n        x: card.container.x,\n        y: card.container.y,\n        width: contentSize.width,\n        height: contentSize.height\n      });\n    });\n\n    LayoutStateManager.saveLayoutSlot(slot, layoutState);\n    console.log(`Layout saved to slot ${slot}`);\n  }\n\n  /**\n   * Handle loading layout from slot\n   */\n  private handleLoadLayoutSlot(slot: 'A' | 'B' | 'C'): void {\n    const layoutState = LayoutStateManager.loadLayoutSlot(slot);\n    if (!layoutState) {\n      console.warn(`No layout found in slot ${slot}`);\n      return;\n    }\n\n    layoutState.cards.forEach(cardLayout => {\n      const card = this.uiManager.getCard(cardLayout.id);\n      if (card) {\n        card.container.position.set(cardLayout.x, cardLayout.y);\n        card.setContentSize(cardLayout.width, cardLayout.height);\n      }\n    });\n\n    console.log(`Layout loaded from slot ${slot}`);\n  }\n\n  /**\n   * Handle scale change (temporary)\n   */\n  private handleScaleChange(scale: number): void {\n    const dialog = createPixelDialog({\n      title: 'Scale Change',\n      message: `Changing scale to ${scale}x requires reloading the page.`,\n      buttons: [\n        {\n          label: 'Reload',\n          onClick: () => {\n            localStorage.setItem('temp-grid-scale', scale.toString());\n            window.location.reload();\n          }\n        },\n        {\n          label: 'Cancel',\n          onClick: () => {}\n        }\n      ],\n      renderer: this.renderer\n    });\n    this.scene.addChild(dialog);\n  }\n\n  /**\n   * Cleanup resources\n   */\n  destroy(): void {\n    if (this.uiStateSaveTimer) {\n      clearTimeout(this.uiStateSaveTimer);\n    }\n    if (this.projectSaveTimer) {\n      clearTimeout(this.projectSaveTimer);\n    }\n    this.uiManager.clear();\n    this.spriteSheetManager.clear();\n  }\n}\n","/**\n * Sprite card - displays and allows editing of a single 8x8 sprite\n */\nimport * as PIXI from 'pixi.js';\nimport { PixelCard, px, GRID } from './pixel-card';\nimport { SpriteController } from '../controllers/sprite-controller';\n\nexport interface SpriteCardOptions {\n  x: number;\n  y: number;\n  renderer: PIXI.Renderer;\n  spriteController: SpriteController;\n  onPixelClick?: (x: number, y: number) => void;\n  onFocus?: () => void;\n}\n\nexport interface SpriteCardResult {\n  card: PixelCard;\n  controller: SpriteController;\n  redraw: () => void;\n}\n\n/**\n * Creates a sprite card for editing a single 8x8 sprite\n */\nexport function createSpriteCard(options: SpriteCardOptions): SpriteCardResult {\n  const { x, y, renderer, spriteController, onPixelClick, onFocus } = options;\n\n  // Get scaled dimensions\n  const dims = spriteController.getScaledDimensions();\n  const contentWidth = Math.ceil(dims.width / px(1));\n  const contentHeight = Math.ceil(dims.height / px(1));\n\n  // Create the card\n  const card = new PixelCard({\n    title: `(${spriteController.getScale()}x)`,\n    x,\n    y,\n    contentWidth,\n    contentHeight,\n    renderer,\n    minContentSize: true,\n    clipContent: true, // Enable clipping for sprite canvas (overflow: hidden)\n    onResize: (width, height) => {\n      // Re-render sprite when card resizes\n      drawSprite();\n    },\n    onFocus\n  });\n\n  const contentContainer = card.getContentContainer();\n\n  // Container for the sprite\n  const spriteContainer = new PIXI.Container();\n  contentContainer.addChild(spriteContainer);\n\n  // Draw the sprite\n  function drawSprite() {\n    spriteContainer.removeChildren();\n    spriteController.render(spriteContainer);\n  }\n\n  // Handle clicks for drawing\n  if (onPixelClick) {\n    spriteContainer.eventMode = 'static';\n    spriteContainer.cursor = 'crosshair';\n\n    let isDrawing = false;\n    let lastPixelX = -1;\n    let lastPixelY = -1;\n\n    spriteContainer.on('pointerdown', (e: PIXI.FederatedPointerEvent) => {\n      isDrawing = true;\n      const local = e.getLocalPosition(spriteContainer);\n      const pixel = spriteController.screenToPixel(local.x, local.y);\n      if (pixel) {\n        lastPixelX = pixel.x;\n        lastPixelY = pixel.y;\n        onPixelClick(pixel.x, pixel.y);\n      }\n    });\n\n    spriteContainer.on('pointermove', (e: PIXI.FederatedPointerEvent) => {\n      if (isDrawing) {\n        const local = e.getLocalPosition(spriteContainer);\n        const pixel = spriteController.screenToPixel(local.x, local.y);\n        if (pixel && (pixel.x !== lastPixelX || pixel.y !== lastPixelY)) {\n          lastPixelX = pixel.x;\n          lastPixelY = pixel.y;\n          onPixelClick(pixel.x, pixel.y);\n        }\n      }\n    });\n\n    spriteContainer.on('pointerup', () => {\n      isDrawing = false;\n      lastPixelX = -1;\n      lastPixelY = -1;\n    });\n\n    spriteContainer.on('pointerupoutside', () => {\n      isDrawing = false;\n      lastPixelX = -1;\n      lastPixelY = -1;\n    });\n  }\n\n  // Initial draw\n  drawSprite();\n\n  return {\n    card,\n    controller: spriteController,\n    redraw: drawSprite\n  };\n}\n","/**\n * Texture and grid utilities\n */\nimport * as PIXI from 'pixi.js';\n\n/**\n * Creates a tiled checkerboard grid texture for use as a background\n * @param gridSize Size of each square in the checkerboard pattern\n * @param darkColor Color of the dark squares (hex number)\n * @param lightColor Color of the light squares (hex number)\n * @returns PIXI.Texture with nearest neighbor scaling enabled\n */\nexport function createCheckerboardTexture(\n  gridSize: number = 16,\n  darkColor: number = 0x2a2a3a,\n  lightColor: number = 0x353545\n): PIXI.Texture {\n  // Create canvas for the checkerboard pattern\n  const gridCanvas = document.createElement('canvas');\n  gridCanvas.width = gridSize * 2;\n  gridCanvas.height = gridSize * 2;\n  const gridCtx = gridCanvas.getContext('2d')!;\n\n  // Draw checkerboard pattern\n  gridCtx.fillStyle = `#${darkColor.toString(16).padStart(6, '0')}`;\n  gridCtx.fillRect(0, 0, gridSize, gridSize);\n  gridCtx.fillRect(gridSize, gridSize, gridSize, gridSize);\n\n  gridCtx.fillStyle = `#${lightColor.toString(16).padStart(6, '0')}`;\n  gridCtx.fillRect(gridSize, 0, gridSize, gridSize);\n  gridCtx.fillRect(0, gridSize, gridSize, gridSize);\n\n  // Create texture from canvas and enable nearest neighbor scaling\n  const gridTexture = PIXI.Texture.from(gridCanvas);\n  gridTexture.source.scaleMode = 'nearest'; // Keep it crisp\n\n  return gridTexture;\n}\n","/**\n * PIKCELL Bar Card - Main action bar with commands\n */\nimport * as PIXI from 'pixi.js';\nimport { PixelCard } from '../components/pixel-card';\nimport { createPixelButton } from '../components/pixel-button';\nimport { createPixelDialog } from '../components/pixel-dialog';\nimport { GRID, BORDER, px } from 'moxi';\nimport { getAllThemes, setThemeByMetadata } from '../theming/theme';\nimport { SpriteSheetType } from '../controllers/sprite-sheet-controller';\n\nexport interface CommanderBarCallbacks {\n  onNew?: () => void;\n  onSave?: () => void;\n  onLoad?: () => void;\n  onExport?: () => void;\n  onApplyLayout?: () => void;\n  onSaveLayoutSlot?: (slot: 'A' | 'B' | 'C') => void;\n  onLoadLayoutSlot?: (slot: 'A' | 'B' | 'C') => void;\n  hasLayoutSlot?: (slot: 'A' | 'B' | 'C') => boolean;\n  onThemeChange?: () => void;\n  onScaleChange?: (scale: number) => void; // TEMPORARY: For testing GRID scaling\n}\n\nexport interface CommanderBarCardOptions {\n  x: number;\n  y: number;\n  renderer: PIXI.Renderer;\n  scene: PIXI.Container;\n  width?: number;  // Optional width in grid units (defaults to auto-calculated)\n  callbacks?: CommanderBarCallbacks;\n}\n\nexport interface CommanderBarCardResult {\n  card: PixelCard;\n}\n\n/**\n * Creates a PIKCELL bar for actions and options\n */\nexport function createCommanderBarCard(options: CommanderBarCardOptions): CommanderBarCardResult {\n  const { x, y, renderer, scene, width, callbacks } = options;\n\n  const canvasWidth = renderer.width;\n  const barHeight = 12; // Grid units for PIKCELL bar\n\n  // IMPORTANT: Card adds BORDER.total * 2 + GRID.padding * 2 to contentWidth (in grid units)\n  // So we must subtract those from the desired total width to get the correct contentWidth\n  // Formula: contentWidth = (canvasWidth / px(1)) - (BORDER.total * 2) - (GRID.padding * 2)\n  const barWidth = width ?? (Math.floor(canvasWidth / px(1)) - (BORDER.total * 2) - (GRID.padding * 2));\n\n  // Create the card\n  const card = new PixelCard({\n    title: 'PIKCELL',\n    x,\n    y,\n    contentWidth: barWidth,\n    contentHeight: barHeight,\n    renderer,\n    minContentSize: true, // Prevent resizing below content's actual size\n    onResize: (newWidth, newHeight) => {\n      drawCommands();\n    },\n    onRefresh: () => {\n      drawCommands();\n    }\n  });\n\n  const contentContainer = card.getContentContainer();\n\n  function drawCommands() {\n    contentContainer.removeChildren();\n\n    const buttonHeight = 12; // Grid units (same as bar height for full height button)\n    const buttonSpacing = px(2);\n\n    // Left side buttons (flush with content container left edge)\n    let currentX = 0;\n\n    // New button\n    const newButton = createPixelButton({\n      height: buttonHeight,\n      label: 'New',\n      selectionMode: 'press',\n      actionMode: 'click',\n      onClick: () => {\n        if (callbacks?.onNew) {\n          callbacks.onNew();\n        }\n      }\n    });\n    newButton.position.set(currentX, 0);\n    contentContainer.addChild(newButton);\n    currentX += newButton.width + buttonSpacing;\n\n    // Save button\n    const saveButton = createPixelButton({\n      height: buttonHeight,\n      label: 'Save',\n      selectionMode: 'press',\n      actionMode: 'click',\n      onClick: () => {\n        if (callbacks?.onSave) {\n          callbacks.onSave();\n        }\n      }\n    });\n    saveButton.position.set(currentX, 0);\n    contentContainer.addChild(saveButton);\n    currentX += saveButton.width + buttonSpacing;\n\n    // Load button\n    const loadButton = createPixelButton({\n      height: buttonHeight,\n      label: 'Load',\n      selectionMode: 'press',\n      actionMode: 'click',\n      onClick: () => {\n        if (callbacks?.onLoad) {\n          callbacks.onLoad();\n        }\n      }\n    });\n    loadButton.position.set(currentX, 0);\n    contentContainer.addChild(loadButton);\n    currentX += loadButton.width + buttonSpacing;\n\n    // Export button\n    const exportButton = createPixelButton({\n      height: buttonHeight,\n      label: 'Export',\n      selectionMode: 'press',\n      actionMode: 'click',\n      onClick: () => {\n        if (callbacks?.onExport) {\n          callbacks.onExport();\n        }\n      }\n    });\n    exportButton.position.set(currentX, 0);\n    contentContainer.addChild(exportButton);\n    currentX += exportButton.width + buttonSpacing;\n\n    // Right side buttons - positioned at the far right\n    const rightButtonsSpacing = px(2);\n\n    // Layout button (auto-sized based on text)\n    const layoutButton = createPixelButton({\n      height: buttonHeight,\n      label: 'Layout',\n      selectionMode: 'press',\n      actionMode: 'click',\n      onClick: () => {\n        // Build button list dynamically\n        const buttons: Array<{ label: string; onClick: () => void }> = [];\n\n        // Reset layout button\n        buttons.push({\n          label: 'Reset',\n          onClick: () => {\n            if (callbacks?.onApplyLayout) {\n              callbacks.onApplyLayout();\n            }\n          }\n        });\n\n        // Slot A, B, C load/save buttons\n        const slots: Array<'A' | 'B' | 'C'> = ['A', 'B', 'C'];\n        slots.forEach(slot => {\n          const hasSlot = callbacks?.hasLayoutSlot?.(slot) ?? false;\n\n          // Load button (if slot has saved layout)\n          if (hasSlot) {\n            buttons.push({\n              label: `Load ${slot}`,\n              onClick: () => {\n                if (callbacks?.onLoadLayoutSlot) {\n                  callbacks.onLoadLayoutSlot(slot);\n                }\n              }\n            });\n          }\n\n          // Save button\n          buttons.push({\n            label: hasSlot ? `Save ${slot}` : `Save ${slot}`,\n            onClick: () => {\n              if (callbacks?.onSaveLayoutSlot) {\n                callbacks.onSaveLayoutSlot(slot);\n              }\n            }\n          });\n        });\n\n        // Show layout dialog\n        const dialog = createPixelDialog({\n          title: 'Layout',\n          message: 'Choose layout:',\n          buttons,\n          renderer\n        });\n        scene.addChild(dialog);\n      }\n    });\n\n    // Theme button (auto-sized based on text)\n    const themeButton = createPixelButton({\n      height: buttonHeight,\n      label: 'Theme',\n      selectionMode: 'press',\n      actionMode: 'click',\n      onClick: () => {\n        // Show theme selection dialog\n        // Dynamically create buttons from all available themes\n        const allThemes = getAllThemes();\n        const dialog = createPixelDialog({\n          title: 'Choose Theme',\n          message: 'Select a theme:',\n          buttons: allThemes.map(themeMetadata => ({\n            label: themeMetadata.name,\n            onClick: () => {\n              setThemeByMetadata(themeMetadata);\n              // Update theme callback\n              if (callbacks?.onThemeChange) {\n                callbacks.onThemeChange();\n              }\n            }\n          })),\n          renderer\n        });\n        scene.addChild(dialog);\n      }\n    });\n\n    // Position right-side buttons (get their widths after creation)\n    const layoutButtonWidth = layoutButton.width / px(1); // Convert from pixels to grid units\n    const themeButtonWidth = themeButton.width / px(1);\n\n    // Position before theme button (content width - both buttons - spacing)\n    layoutButton.position.set(px(barWidth - layoutButtonWidth - themeButtonWidth) - rightButtonsSpacing, 0);\n    contentContainer.addChild(layoutButton);\n\n    // Position at far right (content width - button width)\n    themeButton.position.set(px(barWidth - themeButtonWidth), 0);\n    contentContainer.addChild(themeButton);\n  }\n\n  // Initial draw\n  drawCommands();\n\n  // Update minimum content size based on actual content\n  card.updateMinContentSize();\n\n  return {\n    card\n  };\n}\n","/**\n * Palette Card - Color palette selector\n */\nimport * as PIXI from 'pixi.js';\nimport { PixelCard } from '../components/pixel-card';\nimport { createPixelButton } from '../components/pixel-button';\nimport { GRID, px } from 'moxi';\nimport { createCardZoomHandler } from '../utilities/card-zoom-handler';\n\nexport interface PaletteCardOptions {\n  x: number;\n  y: number;\n  renderer: PIXI.Renderer;\n  palette: number[];\n  selectedColorIndex?: number;\n  onColorSelect?: (colorIndex: number, color: number) => void;\n}\n\nexport interface PaletteCardResult {\n  card: PixelCard;\n  getSelectedColorIndex: () => number;\n  setSelectedColorIndex: (index: number) => void;\n  setPalette: (palette: number[]) => void;\n}\n\n/**\n * Creates a pixel-perfect palette card\n */\nexport function createPaletteCard(options: PaletteCardOptions): PaletteCardResult {\n  const { x, y, renderer, palette, onColorSelect } = options;\n\n  // State\n  let selectedColorIndex = options.selectedColorIndex ?? 0;\n  let currentPalette = [...palette];\n  let colorsPerRow = 4;\n  let rows = 4;\n  let swatchSize = 12; // Grid units (8 * 1.5 = 12)\n\n  // Calculate initial content size\n  const contentWidth = colorsPerRow * swatchSize + (colorsPerRow - 1) * GRID.gap;\n  const contentHeight = rows * swatchSize + (rows - 1) * GRID.gap;\n\n  // Create the card\n  const card = new PixelCard({\n    title: 'Palette',\n    x,\n    y,\n    contentWidth,\n    contentHeight,\n    renderer,\n    onResize: (newWidth, newHeight) => {\n      // Calculate new swatch size to fit the available space while showing all colors\n      const totalColors = currentPalette.length;\n\n      // Try different column layouts and pick the best fitting size\n      let bestSize = 2;\n      let bestCols = 1;\n      let bestRows = totalColors;\n\n      for (let cols = 1; cols <= totalColors; cols++) {\n        const rowsNeeded = Math.ceil(totalColors / cols);\n\n        // Calculate max swatch size that fits in this layout\n        const maxWidthPerSwatch = Math.floor((newWidth - (cols - 1) * GRID.gap) / cols);\n        const maxHeightPerSwatch = Math.floor((newHeight - (rowsNeeded - 1) * GRID.gap) / rowsNeeded);\n        const maxSize = Math.min(maxWidthPerSwatch, maxHeightPerSwatch);\n\n        if (maxSize > bestSize) {\n          bestSize = maxSize;\n          bestCols = cols;\n          bestRows = rowsNeeded;\n        }\n      }\n\n      // Update layout\n      swatchSize = Math.max(2, Math.min(32, bestSize));\n      colorsPerRow = bestCols;\n      rows = bestRows;\n      redrawContent();\n    },\n    onRefresh: () => {\n      redrawContent();\n    }\n  });\n\n  const contentContainer = card.getContentContainer();\n\n  // Redraw function - only updates content, not the whole card\n  function redrawContent() {\n    // Clear content container\n    contentContainer.removeChildren();\n\n    const totalSwatches = colorsPerRow * rows;\n\n    // Draw color swatches\n    for (let i = 0; i < Math.min(totalSwatches, currentPalette.length); i++) {\n      const color = currentPalette[i];\n      const col = i % colorsPerRow;\n      const row = Math.floor(i / colorsPerRow);\n\n      // Position relative to content container\n      const swatchX = px(col * (swatchSize + GRID.gap));\n      const swatchY = px(row * (swatchSize + GRID.gap));\n\n      const swatch = createPixelButton({\n        size: swatchSize,\n        selected: i === selectedColorIndex,\n        backgroundColor: color,\n        selectionMode: 'highlight',\n        actionMode: 'toggle',\n        onClick: () => {\n          selectedColorIndex = i;\n          console.log(`Selected color #${i}: #${color.toString(16).padStart(6, '0')}`);\n          redrawContent();\n          if (onColorSelect) {\n            onColorSelect(i, color);\n          }\n        }\n      });\n\n      swatch.position.set(swatchX, swatchY);\n      contentContainer.addChild(swatch);\n    }\n  }\n\n  // Mouse wheel zoom for swatch size\n  const handleWheel = createCardZoomHandler(renderer, card, (delta) => {\n    swatchSize = Math.max(2, Math.min(32, swatchSize + delta));\n\n    // Update card content size to match new swatch size\n    const newContentWidth = colorsPerRow * swatchSize + (colorsPerRow - 1) * GRID.gap;\n    const newContentHeight = rows * swatchSize + (rows - 1) * GRID.gap;\n    card.setContentSize(newContentWidth, newContentHeight);\n\n    redrawContent();\n  });\n\n  if (typeof window !== 'undefined') {\n    window.addEventListener('wheel', handleWheel, { passive: false });\n\n    card.container.on('destroyed', () => {\n      window.removeEventListener('wheel', handleWheel);\n    });\n  }\n\n  // Initial draw\n  redrawContent();\n\n  // Update minimum content size to match actual content\n  card.updateMinContentSize();\n\n  return {\n    card,\n    getSelectedColorIndex: () => selectedColorIndex,\n    setSelectedColorIndex: (index: number) => {\n      selectedColorIndex = index;\n      redrawContent();\n    },\n    setPalette: (newPalette: number[]) => {\n      currentPalette = [...newPalette];\n      redrawContent();\n    }\n  };\n}\n","/**\n * Info Bar Card - Displays contextual information\n */\nimport * as PIXI from 'pixi.js';\nimport { PixelCard } from '../components/pixel-card';\nimport { GRID, BORDER, px } from 'moxi';\nimport { getTheme } from '../theming/theme';\n\nexport interface InfoSection {\n  label: string;\n  value: string;\n}\n\nexport interface InfoBarCardOptions {\n  x: number;\n  y: number;\n  renderer: PIXI.Renderer;\n  width?: number;  // Optional width in grid units (defaults to auto-calculated)\n  sections?: InfoSection[];\n}\n\nexport interface InfoBarCardResult {\n  card: PixelCard;\n  updateSections: (sections: InfoSection[]) => void;\n}\n\n/**\n * Creates an info bar for displaying contextual information in horizontal sections\n */\nexport function createInfoBarCard(options: InfoBarCardOptions): InfoBarCardResult {\n  const { x, y, renderer, width } = options;\n\n  const barHeight = 8; // Grid units for a slim horizontal bar\n\n  // Default sections\n  let sections: InfoSection[] = options.sections ?? [\n    { label: 'Tool:', value: 'Pencil' },\n    { label: 'Color:', value: '#000000' },\n    { label: 'Scale:', value: '1x' }\n  ];\n\n  // Use provided width or estimate based on sections\n  const barWidth = width ?? (sections.length * 20);\n\n  // Create the card (uses default card background from theme)\n  const card = new PixelCard({\n    title: 'Info',\n    x,\n    y,\n    contentWidth: barWidth,\n    contentHeight: barHeight,\n    renderer,\n    minContentSize: true, // Prevent resizing below content's actual size\n    onResize: (newWidth, newHeight) => {\n      // Only update if the resize maintains horizontal layout\n      if (newWidth >= barHeight) {\n        updateInfoSections();\n      }\n    },\n    onRefresh: () => {\n      // Redraw content when theme changes\n      updateInfoSections();\n    }\n  });\n\n  const contentContainer = card.getContentContainer();\n\n  function updateInfoSections() {\n    contentContainer.removeChildren();\n\n    let currentX = px(2);\n    const sectionSpacing = px(4);\n\n    sections.forEach((section, index) => {\n      // Label text\n      const labelText = new PIXI.BitmapText({\n        text: section.label,\n        style: {\n          fontFamily: 'PixelOperator8Bitmap',\n          fontSize: 64,\n          fill: getTheme().textSecondary, // Use theme secondary text\n        }\n      });\n      labelText.roundPixels = true;\n      labelText.scale.set(GRID.fontScale);\n      labelText.position.set(currentX, px(2));\n      contentContainer.addChild(labelText);\n\n      currentX += labelText.width + px(1);\n\n      // Value text\n      const valueText = new PIXI.BitmapText({\n        text: section.value,\n        style: {\n          fontFamily: 'PixelOperator8Bitmap',\n          fontSize: 64,\n          fill: getTheme().textPrimary, // Use theme primary text\n        }\n      });\n      valueText.roundPixels = true;\n      valueText.scale.set(GRID.fontScale);\n      valueText.position.set(currentX, px(2));\n      contentContainer.addChild(valueText);\n\n      currentX += valueText.width + sectionSpacing;\n    });\n  }\n\n  // Initial draw\n  updateInfoSections();\n\n  // Update minimum content size based on actual content\n  card.updateMinContentSize();\n\n  return {\n    card,\n    updateSections: (newSections: InfoSection[]) => {\n      sections = newSections;\n      updateInfoSections();\n      card.updateMinContentSize();\n    }\n  };\n}\n","/**\n * Tool icons for the sprite editor\n * Creates simple pixel art icons and bakes them to textures\n */\nimport * as PIXI from 'pixi.js';\n\nexport type ToolType = 'pencil' | 'eraser' | 'fill' | 'eyedrop';\n\n// Cache for generated textures\nconst textureCache: Map<string, PIXI.Texture> = new Map();\n\n// SVG icon data\nconst SVG_ICONS: Record<ToolType, string> = {\n  pencil: `<svg fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M18 2h-2v2h-2v2h-2v2h-2v2H8v2H6v2H4v2H2v6h6v-2h2v-2h2v-2h2v-2h2v-2h2v-2h2V8h2V6h-2V4h-2V2zm0 8h-2v2h-2v2h-2v2h-2v2H8v-2H6v-2h2v-2h2v-2h2V8h2V6h2v2h2v2zM6 16H4v4h4v-2H6v-2z\" fill=\"currentColor\"/></svg>`,\n  eraser: '',\n  fill: '',\n  eyedrop: ''\n};\n\n/**\n * Draws a tool icon as Graphics at native size (24x24)\n */\nfunction drawToolGraphic(tool: ToolType, color: number): PIXI.Graphics {\n  const g = new PIXI.Graphics();\n  g.roundPixels = true;\n\n  switch (tool) {\n    case 'pencil':\n      // Pixel art pencil from SVG - native 24x24 size, 2px blocks\n      g.rect(16, 0, 2, 2);\n      g.fill({ color });\n      g.rect(14, 2, 2, 2);\n      g.fill({ color });\n      g.rect(12, 4, 2, 2);\n      g.fill({ color });\n      g.rect(10, 6, 2, 2);\n      g.fill({ color });\n      g.rect(8, 8, 2, 2);\n      g.fill({ color });\n      g.rect(6, 10, 2, 2);\n      g.fill({ color });\n      g.rect(4, 12, 2, 2);\n      g.fill({ color });\n      g.rect(2, 14, 2, 2);\n      g.fill({ color });\n      g.rect(0, 16, 2, 6);\n      g.fill({ color });\n      g.rect(2, 18, 4, 2);\n      g.fill({ color });\n      // Inner detail\n      g.rect(14, 8, 2, 2);\n      g.fill({ color });\n      g.rect(12, 10, 2, 2);\n      g.fill({ color });\n      g.rect(10, 12, 2, 2);\n      g.fill({ color });\n      g.rect(8, 14, 2, 2);\n      g.fill({ color });\n      g.rect(6, 14, 2, 2);\n      g.fill({ color });\n      // Bottom square detail\n      g.rect(4, 16, 2, 4);\n      g.fill({ color });\n      g.rect(2, 16, 2, 2);\n      g.fill({ color });\n      break;\n\n    case 'eraser':\n      // Eraser at 24x24\n      g.rect(6, 10, 12, 8);\n      g.fill({ color: 0xeeeeee });\n      g.rect(6, 10, 12, 2);\n      g.fill({ color });\n      g.rect(6, 16, 12, 2);\n      g.fill({ color });\n      g.rect(6, 10, 2, 8);\n      g.fill({ color });\n      g.rect(16, 10, 2, 8);\n      g.fill({ color });\n      break;\n\n    case 'fill':\n      // Fill bucket at 24x24\n      g.rect(8, 10, 8, 6);\n      g.fill({ color });\n      g.rect(14, 8, 4, 4);\n      g.fill({ color });\n      g.rect(10, 18, 4, 4);\n      g.fill({ color });\n      g.rect(11, 22, 2, 2);\n      g.fill({ color });\n      break;\n\n    case 'eyedrop':\n      // Eyedropper at 24x24\n      g.rect(8, 4, 8, 4);\n      g.fill({ color });\n      g.rect(10, 8, 4, 6);\n      g.fill({ color });\n      g.rect(11, 14, 2, 6);\n      g.fill({ color });\n      break;\n  }\n\n  return g;\n}\n\n/**\n * Creates a tool icon sprite from cached or newly generated texture\n * Icons are always rendered at native 24x24 size (no scaling)\n */\nexport function createToolIcon(tool: ToolType, size: number, color: number, renderer: PIXI.Renderer): PIXI.Sprite {\n  const cacheKey = `${tool}_${color}`; // Size not part of cache key - always 24x24\n\n  // Check cache\n  if (!textureCache.has(cacheKey)) {\n    // Always use graphics at native size\n    const graphic = drawToolGraphic(tool, color);\n    graphic.roundPixels = true;\n\n    const texture = renderer.generateTexture({\n      target: graphic,\n      resolution: 1,\n      antialias: false\n    });\n\n    texture.source.scaleMode = 'nearest';\n\n    graphic.destroy();\n\n    // Cache it\n    textureCache.set(cacheKey, texture);\n  }\n\n  // Create sprite from cached texture (native 24x24)\n  const sprite = new PIXI.Sprite(textureCache.get(cacheKey)!);\n  sprite.roundPixels = true;\n  sprite.texture.source.scaleMode = 'nearest';\n\n  return sprite;\n}\n","/**\n * PIKCELL - Pixel-Perfect Sprite Editor\n * Built on Moxi and PIXI.js\n */\nimport { setupMoxi } from 'moxi';\nimport * as PIXI from 'pixi.js';\nimport { Assets } from 'pixi.js';\nimport { SpriteEditor } from './sprite-editor';\nimport { getTheme } from './theming/theme';\n\n// Asset paths\nconst ASSETS = {\n  PIXEL_OPERATOR8_FONT: {\n    alias: 'PixelOperator8',\n    src: './assets/fonts/pixel_operator/PixelOperator8.ttf'\n  },\n  KENNEY_BLOCKS_FONT: {\n    alias: 'Kenney Blocks',\n    src: './assets/fonts/kenney-blocks.ttf'\n  }\n};\n\n/**\n * Initialize and run the PIKCELL sprite editor\n */\nexport async function initPikcell(hostElement?: HTMLElement) {\n  const root = hostElement || document.getElementById('app');\n  if (!root) throw new Error('Host element not found');\n\n  // Setup with pixel-perfect rendering\n  const { scene, engine, renderer } = await setupMoxi({\n    hostElement: root,\n    showLoadingScene: false,\n    pixelPerfect: true,\n    renderOptions: {\n      width: 1280,\n      height: 720,\n      backgroundColor: getTheme().backgroundRoot,\n    }\n  });\n\n  // Load pixel fonts\n  await Assets.load([ASSETS.PIXEL_OPERATOR8_FONT, ASSETS.KENNEY_BLOCKS_FONT]);\n\n  // Install bitmap font at 64px for high quality, will scale down to 16px\n  PIXI.BitmapFont.install({\n    name: 'PixelOperator8Bitmap',\n    style: {\n      fontFamily: 'PixelOperator8',\n      fontSize: 64,\n      fill: 0xffffff,\n    }\n  });\n\n  // Install Kenney Blocks bitmap font for branding\n  PIXI.BitmapFont.install({\n    name: 'KennyBlocksBitmap',\n    style: {\n      fontFamily: 'Kenney Blocks',\n      fontSize: 64,\n      fill: 0xffffff,\n    }\n  });\n\n  // Create the sprite editor\n  const spriteEditor = new SpriteEditor({\n    renderer,\n    scene,\n    maxSpriteSheets: 2\n  });\n\n  // Initialize the editor (creates all UI)\n  await spriteEditor.initialize();\n\n  // Start the engine\n  scene.init();\n  engine.start();\n\n  console.log('PIKCELL loaded');\n\n  return { spriteEditor, scene, engine, renderer };\n}\n\n// Auto-init when DOM is ready (for standalone use)\nif (typeof document !== 'undefined') {\n  document.addEventListener('DOMContentLoaded', () => {\n    const app = document.getElementById('app');\n    if (app) {\n      initPikcell(app).catch(console.error);\n    }\n  });\n}\n\n// Export everything for library use\nexport { SpriteEditor } from './sprite-editor';\nexport { getTheme, setTheme, getAllThemes } from './theming/theme';\nexport * from './editor-exports';\n"],"names":["p","a","c","document","addEventListener","attachEvent","w","this","g","createElement","setAttribute","appendChild","createTextNode","h","i","m","j","l","style","cssText","x","B","offsetWidth","b","width","scrollLeft","scrollWidth","C","e","parentNode","D","window","family","weight","stretch","context","E","F","G","H","M","fonts","N","font","q","join","prototype","load","J","Date","getTime","Promise","K","L","test","navigator","vendor","exec","userAgent","parseInt","I","O","r","t","Error","then","n","length","setTimeout","P","race","clearTimeout","body","removeEventListener","readyState","detachEvent","u","d","k","y","z","A","f","removeChild","v","dir","hidden","module","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","hasOwnProperty","call","Symbol","toStringTag","value","createPoint","Point","ZERO_POINT","ONE_POINT","uc","s","toUpperCase","lc","toLowerCase","padRight","val","padWith","result","pr","getRandomInt","min","max","Math","floor","random","roundTo","places","round","pow","lerp","begin","end","mag","metersToPixels","pixelsToMeters","fetchXml","async","url","fetch","text","rad2deg","rad","PI","deg2rad","deg","RenderManager","constructor","htmlRoot","renderer","fitToWindow","onResize","root","canvas","parentWidth","clientWidth","parentHeight","clientHeight","canvasWidth","canvasHeight","height","scale","render","stage","isMoxiEntity","entity","getRenderer","options","create","Scene","super","init","children","forEach","child","moxiEntity","update","deltaTime","draw","Engine","gameLoop","tikerTime","deltaMS","physicsWorld","deltaSeconds","step","ticker","shared","autoStart","add","loggerFrequencyMs","nextLogTime","logger","msg","start","stop","addPhysicsWorld","loadStage","EventEmitter","listeners","on","event","listener","push","off","eventListeners","filter","emit","args","once","getInstance","instance","ClientEvents","initWheelOffset","onAnyEvent","ev","wheelOffsets","keydown","movePosition","anyEvent","wheelDelta","xValue","deltaX","yValue","deltaY","eventType","lastMovePosition","clientX","clientY","moveDelta","mouseDownEvent","lastMouseDown","mouseUpEvent","lastMouseUp","keyDownEvent","keyUpEvent","isKeyDown","Boolean","isKeyUp","AssetLoader","PIXIAssets","textures","isLoading","events","loadAssets","assets","failedAssets","src","alias","cache","has","texture","error","console","warn","Logic","active","MoxiEntity","logic","className","logicComponent","addLogic","logicName","name","getLogic","CameraLogic","speed","target","deltaSpeed","isZooming","abs","desiredScale","screenCenterX","screenCenterY","desiredX","position","desiredY","desiredPosition","set","copyFrom","scene","Camera","cameraLogic","addChild","extendStatics","d2","b2","setPrototypeOf","__proto__","Array","d3","b3","__extends","TypeError","String","__","__assign","assign","s2","n2","arguments","apply","input2","defaults","output2","getOwnPropertySymbols","symbols","symbol","propertyIsEnumerable","math_random","EPSILON","Number","isFinite","mod","num","clamp","math","nextPowerOfTwo","x2","isPowerOfTwo","math_abs$9","math_sqrt$5","sqrt","math_max$8","math_min$8","Vec2","Vec22","_serialize","_deserialize","data","zero","neo","clone","v3","toString","JSON","stringify","isValid","assert","setZero","setNum","setVec2","wSet","a2","setCombine","setMul","wAdd","addCombine","addMul","wSub","subCombine","subMul","sub","mul","lengthOf","lengthSquared","normalize","invLength","distance","dx","dy","distanceSquared","areEqual","skew","dot","cross","crossVec2Vec2","crossVec2Num","crossNumVec2","addCross","addCrossVec2Num","addCrossNumVec2","combine","mulNumVec2","mulVec2Num","neg","mid","upper","lower","lengthSqr","clampVec2","scaleFn","translateFn","math_max$7","math_min$7","AABB","AABB2","lowerBound","upperBound","getCenter","getExtents","getPerimeter","lowerA","upperA","lowerB","upperB","lowerX","lowerY","upperX","upperY","combinePoints","aabb","contains","extend","out","testOverlap","d1x","d2x","d1y","d2y","diff","wD","hD","rayCast","t1","t2","tmin","tmax","Infinity","p1","p2","absD","normal3","inv_d","temp3","maxFraction","fraction","normal","combinedPerimeter","lx","ly","math_PI$6","Settings","Settings2","linearSlop","configurable","lengthUnitsPerMeter","maxManifoldPoints","maxPolygonVertices","aabbExtension","aabbMultiplier","angularSlop","maxSubSteps","maxTOIContacts","maxTOIIterations","maxDistanceIterations","velocityThreshold","maxLinearCorrection","maxAngularCorrection","maxTranslation","maxRotation","baumgarte","toiBaugarte","timeToSleep","linearSleepTolerance","angularSleepTolerance","SettingsInternal","SettingsInternal2","Pool","Pool2","opts","_list","_max","_hasCreateFn","_createCount","_hasAllocateFn","_allocateCount","_hasReleaseFn","_releaseCount","_hasDisposeFn","_disposeCount","_createFn","_allocateFn","allocate","_releaseFn","release","_disposeFn","dispose","size","item","shift","math_abs$8","math_max$6","TreeNode","TreeNode2","id","userData","parent","child1","child2","isLeaf","poolTreeNode","node","DynamicTree","DynamicTree2","inputPool","stack","stackPool","iteratorPool","Iterator","iterator","close","m_root","m_nodes","m_lastProxyId","getUserData","getFatAABB","allocateNode","freeNode","createProxy","insertLeaf","destroyProxy","removeLeaf","moveProxy","leaf","leafAABB","index","area","combinedArea","cost","inheritanceCost","cost1","cost2","sibling","oldParent","newParent","balance","grandParent","iA","getHeight","getAreaRatio","rootArea","totalArea","it","preorder","next","computeHeight","height1","height2","validateStructure","validateMetrics","validate","getMaxBalance","maxBalance","rebuildBottomUp","nodes","count","minCost","iMin","jMin","aabbi","aabbj","parent_1","shiftOrigin","newOrigin","query","queryCallback","pop","rayCastCallback","abs_v","segmentAABB","subInput","c2","Iterator2","parents","states","math_max$5","math_min$6","BroadPhase","BroadPhase2","_this","m_tree","m_moveBuffer","proxyId","m_queryProxyId","proxyIdA","proxyIdB","userDataA","userDataB","m_callback","aabbA","aabbB","getProxyCount","getTreeHeight","getTreeBalance","getTreeQuality","bufferMove","unbufferMove","displacement2","touchProxy","updatePairs","addPairCallback","fatAABB","math_sin$2","sin","math_cos$2","cos","math_sqrt$4","vec2","copyVec2","zeroVec2","negVec2","plusVec2","minusVec2","subVec2","mulVec2","scaleVec2","plusScaleVec2","minusScaleVec2","combine2Vec2","am","bm","combine3Vec2","cm","normalizeVec2","dotVec2","lengthSqrVec2","distVec2","distSqrVec2","rotVec2","derotVec2","transform","angle","copyTransform","transform2","transformVec2","xf2","detransformVec2","px","py","retransformVec2","from","to","x0","y0","detransformTransform","math_sin$1","math_cos$1","math_atan2$1","atan2","Rot","Rot2","setAngle","setRot","setIdentity","rot","identity","getAngle","getXAxis","getYAxis","qr","mulRot","mulSub","mulT","mulTRot","mulTVec2","math_atan2","math_PI$5","temp$7","Sweep","Sweep2","localCenter","alpha0","c0","a0","recycle","setTransform","setLocalCenter","localCenter2","getTransform","beta","advance","alpha","forward","that","Transform","Transform2","rotation2","isArray","arr","mulXf","mulAll","mulFn","mulTXf","Velocity","math_sin","math_cos","Position","Position2","Shape","Shape2","appData","m_type","m_radius","synchronize_aabb1","synchronize_aabb2","displacement","FixtureDefDefault","friction","restitution","density","isSensor","filterGroupIndex","filterCategoryBits","filterMaskBits","FixtureProxy","fixture","childIndex","Fixture","Fixture2","shape","def","m_body","m_friction","m_restitution","m_density","m_isSensor","m_filterGroupIndex","m_filterCategoryBits","m_filterMaskBits","m_shape","m_next","m_proxies","m_proxyCount","childCount","getChildCount","m_userData","_reset","getBody","broadPhase","m_world","m_broadPhase","destroyProxies","createProxies","m_xf","resetMassData","restore","getType","getShape","setSensor","sensor","setAwake","setUserData","getNext","getDensity","setDensity","getFriction","setFriction","getRestitution","setRestitution","testPoint","getMassData","massData","computeMass","getAABB","proxy","computeAABB","synchronize","xf1","setFilterData","groupIndex","categoryBits","maskBits","refilter","getFilterGroupIndex","setFilterGroupIndex","getFilterCategoryBits","setFilterCategoryBits","getFilterMaskBits","setFilterMaskBits","edge","getContactList","contact","fixtureA","getFixtureA","fixtureB","getFixtureB","flagForFiltering","world","getWorld","shouldCollide","collideA","collideB","STATIC","KINEMATIC","DYNAMIC","oldCenter","temp$6","xf$2","BodyDefDefault","type","linearVelocity","angularVelocity","linearDamping","angularDamping","fixedRotation","bullet","gravityScale","allowSleep","awake","Body","Body2","m_awakeFlag","m_autoSleepFlag","m_bulletFlag","m_fixedRotationFlag","m_activeFlag","m_islandFlag","m_toiFlag","m_mass","m_invMass","m_I","m_invI","m_sweep","c_velocity","c_position","m_force","m_torque","m_linearVelocity","m_angularVelocity","m_linearDamping","m_angularDamping","m_gravityScale","m_sleepTime","m_jointList","m_contactList","m_fixtureList","m_prev","m_destroyed","fixtures","_addFixture","isWorldLocked","isLocked","getFixtureList","getJointList","isStatic","isDynamic","isKinematic","setStatic","setType","setDynamic","setKinematic","synchronizeFixtures","ce","ce0","destroyContact","isBullet","setBullet","flag","isSleepingAllowed","setSleepingAllowed","isAwake","isActive","setActive","m_newFixture","isFixedRotation","setFixedRotation","synchronizeTransform","getPosition","setPosition","getWorldCenter","getLocalCenter","getLinearVelocity","getLinearVelocityFromWorldPoint","worldPoint","getLinearVelocityFromLocalPoint","localPoint","getWorldPoint","setLinearVelocity","getAngularVelocity","setAngularVelocity","getLinearDamping","setLinearDamping","getAngularDamping","setAngularDamping","getGravityScale","setGravityScale","getMass","getInertia","mass","center","setMassData","applyForce","force","point2","wake","applyForceToCenter","applyTorque","torque","applyLinearImpulse","impulse","applyAngularImpulse","jn","other","joint","m_collideConnected","createFixture","fixdef","destroyFixture","publish","getWorldVector","localVector","getLocalPoint","getLocalVector","worldVector","JointEdge","prev","Joint","Joint2","bodyA","bodyB","m_edgeA","m_edgeB","m_bodyA","m_bodyB","collideConnected","getBodyA","getBodyB","getCollideConnected","_resetAnchors","stats","gjkCalls","gjkIters","gjkMaxIters","toiTime","toiMaxTime","toiCalls","toiIters","toiMaxIters","toiRootIters","toiMaxRootIters","newline","string","name_1","math_max$4","temp$5","normal$4","e12","e13","e23","temp1","temp2","DistanceInput","DistanceInput2","proxyA","DistanceProxy","proxyB","transformA","transformB","useRadii","DistanceOutput","DistanceOutput2","pointA","pointB","iterations","SimplexCache","SimplexCache2","metric","indexA","indexB","Distance","cache2","xfA2","xfB2","simplex","readCache","vertices","m_v","k_maxIters","saveA","saveB","saveCount","iter","m_count","solve","getSearchDirection","vertex","getSupport","wA","getVertex","wB","duplicate","getWitnessPoints","writeCache","rA2","rB2","DistanceProxy2","m_vertices","getVertexCount","bestIndex","bestValue","getSupportVertex","computeDistanceProxy","setVertices","radius","SimplexVertex","SimplexVertex2","searchDirection_reuse","closestPoint_reuse","Simplex2","m_v1","m_v2","m_v3","wALocal","wBLocal","metric1","metric2","getMetric","v13","v22","getClosestPoint","pA2","pB2","solve2","solve3","w1","w2","d12_2","d12_1","inv_d12","w3","w1e12","w1e13","d13_1","d13_2","w2e23","d23_1","d23_2","n123","d123_1","d123_2","d123_3","inv_d13","inv_d23","inv_d123","input$1","cache$1","output$1","shapeA","shapeB","Input","Output","Proxy","Cache","ShapeCastInput2","translationB","TOIOutputState","TOIOutputState2","math_abs$7","math_max$3","TOIInput","TOIInput2","sweepA","sweepB","tMax","TOIOutput","TOIOutput2","state","e_unset","SeparationFunctionType","SeparationFunctionType2","distanceInput","distanceOutput","xfA$1","xfB$1","temp$4","pointA$2","pointB$2","normal$3","axisA","axisB","localPointA","localPointB","TimeOfImpact","timer","now","e_unknown","totalRadius","tolerance","k_maxIterations","e_overlapped","e_touching","separationFunction","initialize","done","pushBackIter","findMinSeparation","e_separated","s1","evaluate","e_failed","rootIterCount","a1","s3","time","Timer","SeparationFunction2","m_proxyA","m_proxyB","m_sweepA","m_sweepB","m_localPoint","m_axis","e_points","localPointA_1","localPointB_1","normalizeVec2Length","e_faceB","localPointB1","localPointB2","localPointA_2","e_faceA","localPointA1","localPointA2","localPointB_2","compute","find","math_abs$6","math_sqrt$3","math_min$5","TimeStep","TimeStep2","dt","inv_dt","velocityIterations","positionIterations","warmStarting","blockSolve","inv_dt0","dtRatio","reset","s_subStep","translation","input","output","backup","backup1","backup2","ContactImpulse","ContactImpulse2","normals","tangents","v_points","normalImpulse","tangentImpulse","Solver","Solver2","m_stack","m_bodies","m_contacts","m_joints","clear","addBody","addContact","addJoint","solveWorld","m_bodyList","c_1","seed","isEnabled","isTouching","sensorA","m_fixtureA","sensorB","m_fixtureB","je","solveIsland","gravity","m_gravity","m_allowSleep","initConstraint","initVelocityConstraint","warmStartConstraint","initVelocityConstraints","solveVelocityConstraints","solveVelocityConstraint","storeConstraintImpulses","translationLengthSqr","maxTranslationSquared","ratio","maxRotationSquared","positionSolved","minSeparation","separation","solvePositionConstraint","contactsOkay","jointsOkay","jointOkay","solvePositionConstraints","postSolveIsland","minSleepTime","linTolSqr","linearSleepToleranceSqr","angTolSqr","angularSleepToleranceSqr","solveWorldTOI","m_stepComplete","c_2","m_toiCount","m_toi","minContact","minAlpha","c_3","fA_1","fB_1","bA_1","bB_1","activeA","activeB","getChildIndexA","getChildIndexB","fA","fB","bA","bB","bodies","solveIslandTOI","findNewContacts","m_subStepping","setEnabled","subStep","toiA","toiB","solvePositionConstraintTOI","c_5","postSolve","m_impulse","ManifoldType","ManifoldType2","ContactFeatureType","ContactFeatureType2","PointState","PointState2","Mat22","Mat222","ex","ey","getInverse","det","imx","mx","mulMat22","mulTMat22","mx1","mx2","math_sqrt$2","pointA$1","pointB$1","temp$3","cA$1","cB$1","dist","planePoint$2","clipPoint$1","ClipVertex","ClipVertex2","ContactID","Manifold","Manifold2","localNormal","points","ManifoldPoint","pointCount","getWorldManifold","wm","radiusA","radiusB","WorldManifold","separations","e_circles","manifoldPoint","clipSegmentToLine","getPointStates","ManifoldPoint2","ContactID2","typeA","typeB","setFeatures","swapFeatures","WorldManifold2","state1","state2","manifold1","manifold2","removeState","persistState","addState","vOut","vIn","offset","vertexIndexA","numOut","distance0","distance1","interp","e_vertex","e_face","math_sqrt$1","math_max$2","math_min$4","contactPool","Contact","oldManifold","worldManifold","ContactEdge","ContactEdge2","mixFriction","friction1","friction2","mixRestitution","restitution1","restitution2","LimitState$2","LimitState2","s_registers","VelocityConstraintPoint","VelocityConstraintPoint2","rA","rB","normalMass","tangentMass","velocityBias","cA","vA","cB","vB","tangent$1","xfA","xfB","clipPoint","planePoint$1","P$1","normal$2","point","dv","dv1","dv2","P1","P2","temp$2","Contact2","m_nodeA","m_nodeB","m_indexA","m_indexB","m_evaluateFcn","m_manifold","m_tangentSpeed","m_enabledFlag","m_touchingFlag","m_filterFlag","m_bulletHitFlag","v_normal","v_normalMass","v_K","v_pointCount","v_tangentSpeed","v_friction","v_restitution","v_invMassA","v_invMassB","v_invIA","v_invIB","p_localPoints","p_localNormal","p_localPoint","p_localCenterA","p_localCenterB","p_type","p_radiusA","p_radiusB","p_pointCount","p_invMassA","p_invMassB","p_invIA","p_invIB","evaluateFcn","_i","_a2","_b","_c","manifold","cp","vcp","getManifold","worldManifold2","resetFriction","resetRestitution","setTangentSpeed","getTangentSpeed","touching","wasTouching","nmp","omp","hasListener","beginContact","endContact","preSolve","_solvePositionConstraint","toi","positionA","positionB","localCenterA","localCenterB","mA","mB","iB","aA","aB","rnA","rnB","velocityA","velocityB","wmp","kNormal","rtA","rtB","kTangent","vRel","vcp1","vcp2","rn1A","rn1B","rn2A","rn2B","k11","k22","k12","a_1","b_1","d_1","vt","lambda","maxFriction","newImpulse","vn","vn1","vn2","addType","type1","type2","callback","destroy","DEFAULTS$b","continuousPhysics","subStepping","World","World2","s_step","m_solver","m_contactCount","m_bodyCount","m_jointCount","m_clearForces","m_locked","m_warmStarting","m_continuousPhysics","m_blockSolve","m_velocityIterations","m_positionIterations","m_t","m_step_callback","joints","getBodyList","_addBody","createJoint","getBodyCount","getJointCount","getContactCount","setGravity","getGravity","setAllowSleeping","getAllowSleeping","setWarmStarting","getWarmStarting","setContinuousPhysics","getContinuousPhysics","setSubStepping","getSubStepping","setAutoClearForces","getAutoClearForces","clearForces","queryAABB","point1","point3","createBody","arg1","arg2","createDynamicBody","createKinematicBody","destroyBody","je0","destroyJoint","f0","timeStep","updateContacts","queueUpdate","createContact","next_c","_listeners","indexOf","splice","arg3","oldManifold2","Vec3","Vec32","v1$2","v2$1","EdgeShape","_super","EdgeShape2","v122","TYPE","polygonRadius","m_vertex1","m_vertex2","m_vertex0","m_vertex3","m_hasVertex0","m_hasVertex3","vertex1","vertex2","vertex0","vertex3","hasVertex0","hasVertex3","setPrevVertex","setNextVertex","getRadius","setNext","getNextVertex","setPrev","getPrevVertex","_set","_clone","e3","numerator","denominator","rr","v1$1","v2","ChainShape","ChainShape2","loop","m_prevVertex","m_nextVertex","m_hasPrevVertex","m_hasNextVertex","m_isLoop","_createLoop","_createChain","slice","isLoop","hasPrevVertex","hasNextVertex","prevVertex","nextVertex","getChildEdge","math_max$1","math_min$3","temp$1","e$1","e1$1","e2$1","PolygonShape","PolygonShape2","m_centroid","m_normals","_setAsBox","ps","unique","linearSlopSquared","i0","hull","ih","ie2","i1","i2","vs","pRef","inv3","p3","e1_1","e2_1","triangleArea","computeCentroid","hx","hy","center2","pLocal","minX","minY","maxX","maxY","k_inv3","ex1","ey1","ex2","ey2","math_sqrt","math_PI$4","temp","CircleShape","CircleShape2","m_p","sigma","math_abs$5","math_PI$3","DEFAULTS$a","frequencyHz","dampingRatio","DistanceJoint","DistanceJoint2","anchorA","anchorB","m_localAnchorA","localAnchorA","m_localAnchorB","localAnchorB","m_length","m_frequencyHz","m_dampingRatio","m_gamma","m_bias","gamma","bias","getLocalAnchorA","getLocalAnchorB","setLength","getLength","setFrequency","hz","getFrequency","setDampingRatio","getDampingRatio","getAnchorA","getAnchorB","getReactionForce","m_u","getReactionTorque","m_localCenterA","m_localCenterB","m_invMassA","m_invMassB","m_invIA","m_invIB","cA2","vA2","cB2","vB2","qA","qB","m_rA","m_rB","crAu","crBu","invMass","omega","P3","vpA","vpB","Cdot","DEFAULTS$9","maxForce","maxTorque","FrictionJoint","FrictionJoint2","anchor","m_linearImpulse","m_angularImpulse","m_maxForce","m_maxTorque","setMaxForce","getMaxForce","setMaxTorque","getMaxTorque","m_linearMass","m_angularMass","oldImpulse","maxImpulse","Mat33","Mat332","ez","solve33","cross_x","cross_y","cross_z","solve22","a11","a12","a21","a22","getInverse22","getSymInverse33","a13","a23","a33","mulVec3","math_abs$4","LimitState$1","RevoluteJoint","RevoluteJoint2","_d","_e","_f","m_limitState","inactiveLimit","referenceAngle","m_referenceAngle","m_motorImpulse","m_lowerAngle","lowerAngle","m_upperAngle","upperAngle","m_maxMotorTorque","maxMotorTorque","m_motorSpeed","motorSpeed","m_enableLimit","enableLimit","m_enableMotor","enableMotor","getReferenceAngle","getJointAngle","getJointSpeed","isMotorEnabled","getMotorTorque","setMotorSpeed","getMotorSpeed","setMaxMotorTorque","getMaxMotorTorque","isLimitEnabled","getLowerLimit","getUpperLimit","setLimits","m_motorMass","jointAngle","equalLimits","atLowerLimit","atUpperLimit","Cdot1","Cdot2","rhs","reduced","positionError","angularError","limitImpulse","math_abs$3","math_max","math_min$2","LimitState","DEFAULTS$7","lowerTranslation","upperTranslation","maxMotorForce","PrismaticJoint","PrismaticJoint2","axis","m_localXAxisA","localAxisA","m_localYAxisA","m_lowerTranslation","m_upperTranslation","m_maxMotorForce","m_perp","m_K","getLocalAxisA","getJointTranslation","setMaxMotorForce","getMaxMotorForce","getMotorForce","m_a1","m_a2","m_s1","m_s2","k13","k23","k33","jointTranslation","LA","LB","f1","df","f2r","perp2","C1","linearError","C2","translation2","impulse1","DEFAULTS$6","GearJoint","GearJoint2","joint1","joint2","coordinateA","coordinateB","m_joint1","m_joint2","m_ratio","m_type1","m_type2","m_bodyC","xfC","aC","revolute","m_localAnchorC","m_referenceAngleA","m_localAxisC","prismatic","pC","m_bodyD","xfD","aD","m_localAnchorD","m_referenceAngleB","m_localAxisD","pD","m_constant","getJoint1","getJoint2","setRatio","getRatio","m_JvAC","m_JwA","m_lcA","m_lcB","m_lcC","m_lcD","m_mA","m_mB","m_mC","m_mD","m_iA","m_iB","m_iC","m_iD","vC","wC","vD","qC","qD","m_JwC","rC","m_JvBD","m_JwB","m_JwD","rD","JvAC","JvBD","JwA","JwB","JwC","JwD","cC","cD","DEFAULTS$5","correctionFactor","MotorJoint","MotorJoint2","m_linearOffset","linearOffset","m_angularOffset","angularOffset","m_correctionFactor","setCorrectionFactor","factor","getCorrectionFactor","setLinearOffset","getLinearOffset","setAngularOffset","getAngularOffset","m_linearError","m_angularError","inv_h","math_PI$2","DEFAULTS$4","MouseJoint","MouseJoint2","m_targetA","m_beta","m_C","_localAnchorB","setTarget","getTarget","velocity","math_abs$2","DEFAULTS$3","PulleyJoint","PulleyJoint2","groundA","groundB","m_groundAnchorA","groundAnchorA","m_groundAnchorB","groundAnchorB","m_lengthA","lengthA","m_lengthB","lengthB","getGroundAnchorA","getGroundAnchorB","getLengthA","getLengthB","getCurrentLengthA","getCurrentLengthB","m_uB","m_uA","ruA","ruB","PA","PB","uA","uB","math_min$1","_a","DEFAULTS$2","maxLength","RopeJoint","RopeJoint2","m_maxLength","m_state","setMaxLength","getMaxLength","getLimitState","crA","crB","math_abs$1","math_PI$1","DEFAULTS$1","WeldJoint","WeldJoint2","invM","impulse2","math_abs","math_PI","DEFAULTS","WheelJoint","WheelJoint2","m_ax","m_ay","localAxis","m_springMass","m_springImpulse","setSpringFrequencyHz","getSpringFrequencyHz","setSpringDampingRatio","getSpringDampingRatio","m_sAy","m_sBy","m_sAx","m_sBx","damp","ay","sAy","sBy","SID","SERIALIZE_REF_TYPES","DESERIALIZE_BY_REF_TYPE","DESERIALIZE_BY_TYPE_FIELD","DEFAULT_OPTIONS","rootClass","preSerialize","postSerialize","preDeserialize","postDeserialize","Serializer","options2","toJson","json","refQueue","refMemoById","addToRefQueue","typeName","__sid","ref","refIndex","refType","traverse","noRefType","obj2","newValue","str","fromJson","deserializedRefMemoByIndex","deserializeWithHooks","classHint","classDeserializeFn","deserializeChild","dataOrRef","worldSerializer","Testbed2","mount","testbed2","BoxShape2","halfWidth","halfHeight","CollideCircles","pA","pB","circleA","circleB","distSqr","CollideEdgeCircle","chain","e1","e2","Q","n$2","edgeA","A1","B1","B2","A2","den","incidentEdge","clipPoints1$1","clipPoints2$1","clipSegmentToLineNormal","v1","n$1","xf$1","v11","v12","localTangent","planePoint","tangent","normal$1","normal1$1","findMaxSeparation","poly1","poly2","count1","count2","n1s","v1s","v2s","maxSeparation2","si","sij","maxSeparation","CollidePolygons","polyA","polyB","separationA","edgeB","separationB","edge12","flip","clipVertex","before","after","normals1","vertices2","normals2","minDot","findIncidentEdge","vertices1","iv1","iv2","frontOffset","sideOffset1","sideOffset2","CollidePolygonCircle","cLocal","faceCenter","polygonA","normalIndex","vertexCount","vertIndex1","vertIndex2","u1","u2","math_min","CollideEdgePolygon","edge_reuse","EPAxisType","EPAxisType2","VertexType","VertexType2","EPAxis","TempPolygon","ReferenceFace","ReferenceFace2","sideNormal1","sideNormal2","clipPoints1","clipPoints2","ie","edgeAxis","polygonAxis","polygonBA","rf","centroidB","edge0","edge1","edge2","xf","normal0","normal1","normal2","lowerLimit","upperLimit","perp","polygonB","v0","front","offset1","offset0","offset2","convex1","convex2","e_edgeA","v4","s22","e_edgeB","primaryAxis","DataDriver2","_refMap","_map","_xmap","_data","_entered","_exited","_key","_listener","exit","enter","CollisionRegistry","tagToBit","Map","bitToTag","nextBit","register","tag","getBit","getTag","bit","tagsToBits","tags","reduce","bits","bitsToTags","isPhysicsBodyUserData","CollisionManager","registry","callbacks","setupListeners","handleBeginContact","handleEndContact","onCollision","tagA","tagB","makeKey","Set","offCollision","delete","onCollisionBegin","triggerTagCallbacks","onCollisionEnd","tagsA","collisionTags","tagsB","cb","PhysicsDebugRenderer","isVisible","showShapes","showVelocities","showAABBs","showCenterOfMass","showContactPoints","showJoints","colorStatic","colorDynamic","colorKinematic","colorSleeping","colorSensor","lineWidth","graphics","drawBody","drawContacts","color","fixtureColor","drawShape","drawVelocity","drawAABB","drawCenterOfMass","stroke","shapeType","circle","pixelCenter","toPixelsPoint","pixelRadius","toPixels","endX","endY","moveTo","lineTo","firstVertex","pixelFirst","pixelVertex","endPoint","pixelStart","pixelEnd","angle1","angle2","rect","pixelPos","pixelPoint","fill","setVisible","visible","toggle","getVisible","setGraphicsPhysicsShape","metadata","PhysicsWorld","pixelsPerMeter","timestep","accumulator","originalRect","originalCircle","originalPoly","poly","flat","initGraphicsPhysicsTracking","enableSleeping","collisionRegistry","collisionManager","registerBody","getBodyLogic","raycast","toPhysicsPoint","pixelNormal","bounds","queryPoint","physicsPoint","toPhysics","pixels","meters","vec","enableDebugRenderer","debugRenderer","disableDebugRenderer","debugGraphics","debugEntity","isInteractive","asEntity","zIndex","sortableChildren","log","getDebugRenderer","getBodies","PALETTE","LoadingScene","Container","particles","nextSpawn","backgroundColor","squareSize","numSquares","textStyle","maxParticles","baseSize","background","Graphics","Text","fontFamily","fontSize","fontWeight","spawnParticle","sprite","pivot","textY","textWidth","textCenterX","spawnTime","duration","spinRate","startX","startY","progress","rotation","show","started","hide","defaultRenderOptions","resolution","devicePixelRatio","autoDensity","antialias","UIFocusManager","focusableComponents","currentFocusIndex","keydownHandler","setupKeyboardListeners","preventDefault","shiftKey","focusPrevious","focusNext","component","includes","sortByTabIndex","registerContainer","container","discoverFocusableComponents","isFocusableComponent","tabIndex","canFocus","onFocus","onBlur","isFocused","unregister","blur","sort","focus","current","requestFocus","nextIndex","attempts","prevIndex","focusFirst","focusLast","getCurrentFocus","getFocusableComponents","FlexDirection","FlexJustify","FlexAlign","ButtonState","UIScaleMode","EventTarget","PixelGrid","config","unit","border","padding","gap","margin","fontScale","units","DEFAULT_PIXEL_GRID","tempScale","localStorage","getItem","isNaN","BORDER","parseThemeFromJson","jsonTheme","parseColor","colorStr","backgroundRoot","backgroundSurface","backgroundRaised","backgroundOverlay","borderStrong","borderSubtle","accentPrimary","accentSecondary","textPrimary","textSecondary","cc29Themes","DARK_THEME","classic","seasonal","THEME_GROUPS","jsonData","paletteName","map","theme","category","palette","loadThemeGroup","currentTheme","currentThemeMetadata","getTheme","UI_COLORS","cardBg","cardBorder","middleBorder","titleBar","selected","buttonBg","isDragging","dragStartX","dragStartY","cardStartX","cardStartY","isResizing","resizeStartX","resizeStartY","resizeStartWidth","resizeStartHeight","resizeDirection","capturedPointerId","scaleIndicator","pairedCard","onStateChange","contentMask","contentContainer","contentWidth","contentHeight","fontHeight","verticalPadding","titleBarHeightPx","ceil","setupEventListeners","redraw","handleGlobalMove","getBoundingClientRect","scaleX","scaleY","deltaGridUnitsX","deltaGridUnitsY","minWidth","minContentWidth","minHeight","minContentHeight","newWidth","widthDelta","newX","newHeight","heightDelta","newY","showScaleIndicator","handleGlobalUp","wasDragging","wasResizing","releasePointerCapture","hideScaleIndicator","removeChildren","cardWidth","cardHeight","bg","roundPixels","shadowOffset","eventMode","cursor","client","pointerId","setPointerCapture","stopPropagation","titleText","title","textHeight","verticalCenter","alphaStamp","stampX","stampY","clipContent","mask","addResizeHandles","handleThickness","cornerSize","createResizeHandle","direction","handle","getContentContainer","getContentSize","setContentSize","getPixelWidth","cardWidthGridUnits","getPixelHeight","refresh","onRefresh","setTitle","setTitleContent","leftText","rightText","leftBitmapText","rightBitmapText","rightX","setPairedCard","card","getPairedCard","onStateChanged","exportState","importState","updateMinContentSize","minContentSize","getLocalBounds","screenX","screenY","canvasX","left","canvasY","top","scaleText","borderWidth","indicatorWidth","indicatorHeight","label","icon","onClick","selectionMode","actionMode","tooltip","buttonWidth","buttonHeight","tempText","button","tooltipContainer","createTooltip","tooltipWidth","tooltipHeight","local","getLocalPosition","yOffset","buttonText","createPixelDialog","message","buttons","checkboxes","overlay","backdrop","checkboxStates","defaultValue","buttonSpacing","messageText","messageWidthInGridUnits","buttonsWidthInGridUnits","messageHeightInGridUnits","checkboxesHeightInGridUnits","dialogCard","messageY","checkboxY","checkboxConfig","checkbox","checked","onChange","isChecked","checkboxLabel","checkboxSize","checkboxHeight","createPixelCheckbox","buttonY","currentX","buttonConfig","dialogBounds","getBounds","SpriteSheetController","isPanning","panStartX","panStartY","spriteStartX","spriteStartY","cellOverlay","selectedCellX","selectedCellY","hoveredCellX","hoveredCellY","interactionSetup","clickThreshold","showGrid","onScaleChange","onCellHover","onCellClick","targetHeight","setupMouseWheelZoom","setupMiddleMousePan","handleWheel","canvasScaleX","canvasScaleY","mouseX","mouseY","parentBounds","spriteCenterX","spriteCenterY","oldScale","localX","localY","zoomDelta","newScale","setScale","passive","handleMouseDown","handleMouseMove","handleMouseUp","getScale","clampedScale","getConfig","getScaledDimensions","getPixel","setPixel","colorIndex","updateTexture","ctx","getContext","fillStyle","fillRect","gridSize","strokeStyle","beginPath","source","scaleMode","drawCellOverlay","cellSize","spriteX","spriteY","setupCellInteraction","spriteLocal","adjustedX","adjustedY","cellX","cellY","maxCellX","maxCellY","global","updateOverlay","requestAnimationFrame","preservedX","preservedY","selectCell","screenToPixel","pixelX","pixelY","getPixelData","row","setPixelData","getSelectedCell","positionCell00AtTopLeft","centerCell","containerWidth","containerHeight","cellCenterX","cellCenterY","containerCenterX","containerCenterY","SPRITESHEET_CONFIGS","SpriteController","spriteSheetController","getCell","setCell","globalX","globalY","sheetConfig","UIStateManager","saveState","cards","version","VERSION","timestamp","values","setItem","STORAGE_KEY","loadState","parse","clearState","removeItem","hasState","adjustForCanvasSize","PROJECT_STATE_KEY","ProjectStateManager","createEmptyProject","CURRENT_VERSION","createdAt","modifiedAt","spriteSheets","activeSpriteSheetId","selectedColorIndex","saveProject","serialized","loadProject","migrateProject","clearProject","hasProject","exportProjectJSON","importProjectJSON","jsonString","getProjectMetadata","sheetCount","downloadProject","filename","blob","Blob","URL","createObjectURL","href","download","click","revokeObjectURL","loadProjectFromFile","resolve","accept","onchange","file","files","LAYOUT_STORAGE_PREFIX","LayoutStateManager","saveLayoutSlot","slot","layout","loadLayoutSlot","hasLayoutSlot","clearLayoutSlot","PICO8_PALETTE","onZoom","cardBounds","delta","FILE_CONSTANTS","SpriteSheetManager","instances","activeId","eventHandlers","savedId","generateId","sheetCard","spriteCard","spriteController","getActive","getAll","remove","remaining","keys","valid","firstInstance","existingType","controller","handler","handlers","getProjectSpriteSheetType","substr","getStats","total","UIManager","focusedCardId","registerCard","originalOnStateChanged","bind","setFocusedCard","unregisterCard","getCard","getAllCards","bringToFront","pairedId","registeredCard","entries","exportAllStates","stateMap","importStates","cardState","hasCard","getFocusedCard","getCardCount","findCards","predicate","results","getCardIdsByPattern","pattern","regex","RegExp","bringGroupToFront","ids","LayoutManager","layouts","currentLayout","registerDefaultLayouts","applyLayout","layoutId","positions","cardId","positionCard","applyDefaultLayout","titleBarHeight","calculateTitleBarHeight","topOffset","commanderCard","paletteCard","infoCard","barHeight","cardTotalHeight","calculateCardHeightFromContent","getLayout","registerLayout","getAllLayouts","calculateCardDimensions","calculateCardWidth","calculateCardHeight","onViewportResize","contentWidthGridUnits","contentHeightGridUnits","calculateFullWidthContentSize","rendererWidth","commander","info","tool","getCurrentLayoutId","centerCard","alignCardToEdge","currentPos","positionRelativeTo","referenceCard","refPos","refWidth","refHeight","FileOperationsManager","lastSavedFileName","projectState","supportsFileOperations","toISOString","split","downloadBlob","oncancel","exportPNG","spriteSheet","canvasToBlob","exportFilename","exportSpritePNG","getLastSavedFileName","link","reject","toBlob","exportScaledPNG","imageSmoothingEnabled","clearLastSavedFileName","SpriteEditor","currentPalette","hasUnsavedChanges","uiStateSaveTimer","projectSaveTimer","spriteSheetManager","uiManager","layoutManager","fileOperationsManager","savedProject","updatePaletteForActiveSheet","recreateUI","saveUIState","restoreUIState","savedState","adjustedState","cs","desiredContentWidth","desiredContentHeight","defaultX","defaultY","commanderBarHeight","startsWith","activeSheet","setPalette","createNewSpriteSheet","validation","dialog","makeThisSheetActive","sheetIndex","createSpriteCardForCell","spriteCardX","spriteCardY","dims","spriteCardResult","onPixelClick","drawSprite","spriteContainer","isDrawing","lastPixelX","lastPixelY","pixel","createSpriteCard","saveProjectState","handleSpriteZoom","currentScale","zoomIncrement","newContentWidth","newContentHeight","spriteSheetResult","gridBackground","cell","cellText","toFixed","scaledWidth","scaledHeight","cardPadding","gridTexture","darkColor","lightColor","gridCanvas","gridCtx","padStart","createCheckerboardTexture","tileScale","addChildAt","createSpriteSheetCard","contentState","contentWidthPx","contentHeightPx","spriteCardScale","updateTheme","commanderBarCard","infoBarCard","barWidth","drawCommands","newButton","onNew","saveButton","onSave","loadButton","onLoad","exportButton","onExport","rightButtonsSpacing","layoutButton","onApplyLayout","onLoadLayoutSlot","onSaveLayoutSlot","themeButton","flatMap","group","themeMetadata","onThemeChange","layoutButtonWidth","themeButtonWidth","createCommanderBarCard","handleNew","handleSave","handleLoad","handleExport","handleSaveLayoutSlot","handleLoadLayoutSlot","handleScaleChange","onColorSelect","colorsPerRow","rows","swatchSize","totalColors","bestSize","bestCols","bestRows","cols","rowsNeeded","maxWidthPerSwatch","maxHeightPerSwatch","maxSize","redrawContent","totalSwatches","col","swatchX","swatchY","swatch","getSelectedColorIndex","setSelectedColorIndex","newPalette","createPaletteCard","infoY","infoBarWidth","sections","updateInfoSections","sectionSpacing","section","labelText","valueText","updateSections","newSections","createInfoBarCard","loadProjectState","sheetState","createNewProject","loadProjectFile","loadedState","layoutState","contentSize","cardLayout","location","reload","ASSETS","PIXEL_OPERATOR8_FONT","KENNEY_BLOCKS_FONT","app","getElementById","hostElement","engine","renderOptions","physics","showLoadingScene","loadingSceneOptions","pixelPerfect","finalRenderOptions","applyImageRendering","ppOptions","enabled","imageRendering","assetLoader","camera","loadingScene","setupMoxi","Assets","install","spriteEditor","maxSpriteSheets","initPikcell","catch"],"ignoreList":[],"sourceRoot":""}