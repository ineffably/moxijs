(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("pixi.js"));
	else if(typeof define === 'function' && define.amd)
		define(["pixi.js"], factory);
	else if(typeof exports === 'object')
		exports["moxi"] = factory(require("pixi.js"));
	else
		root["moxi"] = factory(root["PIXI"]);
})(self, (__WEBPACK_EXTERNAL_MODULE_pixi_js__) => {
return /******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js":
/*!**************************************************************************!*\
  !*** ../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js ***!
  \**************************************************************************/
/***/ ((module) => {

/* Font Face Observer v2.3.0 - Â© Bram Stein. License: BSD-3-Clause */(function(){function p(a,c){document.addEventListener?a.addEventListener("scroll",c,!1):a.attachEvent("scroll",c)}function u(a){document.body?a():document.addEventListener?document.addEventListener("DOMContentLoaded",function b(){document.removeEventListener("DOMContentLoaded",b);a()}):document.attachEvent("onreadystatechange",function g(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",g),a()})};function w(a){this.g=document.createElement("div");this.g.setAttribute("aria-hidden","true");this.g.appendChild(document.createTextNode(a));this.h=document.createElement("span");this.i=document.createElement("span");this.m=document.createElement("span");this.j=document.createElement("span");this.l=-1;this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.h.appendChild(this.m);this.i.appendChild(this.j);this.g.appendChild(this.h);this.g.appendChild(this.i)}
function x(a,c){a.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+c+";"}function B(a){var c=a.g.offsetWidth,b=c+100;a.j.style.width=b+"px";a.i.scrollLeft=b;a.h.scrollLeft=a.h.scrollWidth+100;return a.l!==c?(a.l=c,!0):!1}function C(a,c){function b(){var e=g;B(e)&&null!==e.g.parentNode&&c(e.l)}var g=a;p(a.h,b);p(a.i,b);B(a)};function D(a,c,b){c=c||{};b=b||window;this.family=a;this.style=c.style||"normal";this.weight=c.weight||"normal";this.stretch=c.stretch||"normal";this.context=b}var E=null,F=null,G=null,H=null;function I(a){null===F&&(M(a)&&/Apple/.test(window.navigator.vendor)?(a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),F=!!a&&603>parseInt(a[1],10)):F=!1);return F}function M(a){null===H&&(H=!!a.document.fonts);return H}
function N(a,c){var b=a.style,g=a.weight;if(null===G){var e=document.createElement("div");try{e.style.font="condensed 100px sans-serif"}catch(q){}G=""!==e.style.font}return[b,g,G?a.stretch:"","100px",c].join(" ")}
D.prototype.load=function(a,c){var b=this,g=a||"BESbswy",e=0,q=c||3E3,J=(new Date).getTime();return new Promise(function(K,L){if(M(b.context)&&!I(b.context)){var O=new Promise(function(r,t){function h(){(new Date).getTime()-J>=q?t(Error(""+q+"ms timeout exceeded")):b.context.document.fonts.load(N(b,'"'+b.family+'"'),g).then(function(n){1<=n.length?r():setTimeout(h,25)},t)}h()}),P=new Promise(function(r,t){e=setTimeout(function(){t(Error(""+q+"ms timeout exceeded"))},q)});Promise.race([P,O]).then(function(){clearTimeout(e);
K(b)},L)}else u(function(){function r(){var d;if(d=-1!=k&&-1!=l||-1!=k&&-1!=m||-1!=l&&-1!=m)(d=k!=l&&k!=m&&l!=m)||(null===E&&(d=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),E=!!d&&(536>parseInt(d[1],10)||536===parseInt(d[1],10)&&11>=parseInt(d[2],10))),d=E&&(k==y&&l==y&&m==y||k==z&&l==z&&m==z||k==A&&l==A&&m==A)),d=!d;d&&(null!==f.parentNode&&f.parentNode.removeChild(f),clearTimeout(e),K(b))}function t(){if((new Date).getTime()-J>=q)null!==f.parentNode&&f.parentNode.removeChild(f),
L(Error(""+q+"ms timeout exceeded"));else{var d=b.context.document.hidden;if(!0===d||void 0===d)k=h.g.offsetWidth,l=n.g.offsetWidth,m=v.g.offsetWidth,r();e=setTimeout(t,50)}}var h=new w(g),n=new w(g),v=new w(g),k=-1,l=-1,m=-1,y=-1,z=-1,A=-1,f=document.createElement("div");f.dir="ltr";x(h,N(b,"sans-serif"));x(n,N(b,"serif"));x(v,N(b,"monospace"));f.appendChild(h.g);f.appendChild(n.g);f.appendChild(v.g);b.context.document.body.appendChild(f);y=h.g.offsetWidth;z=n.g.offsetWidth;A=v.g.offsetWidth;t();
C(h,function(d){k=d;r()});x(h,N(b,'"'+b.family+'",sans-serif'));C(n,function(d){l=d;r()});x(n,N(b,'"'+b.family+'",serif'));C(v,function(d){m=d;r()});x(v,N(b,'"'+b.family+'",monospace'))})})}; true?module.exports=D:(0);}());


/***/ }),

/***/ "../../node_modules/planck/dist/planck.js":
/*!************************************************!*\
  !*** ../../node_modules/planck/dist/planck.js ***!
  \************************************************/
/***/ (function(__unused_webpack_module, exports) {

(function(global, factory) {
   true ? factory(exports) : 0;
})(this, function(exports2) {
  "use strict";/**
 * Planck.js v1.4.2
 * @license The MIT license
 * @copyright Copyright (c) 2025 Erin Catto, Ali Shakiba
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

  /*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */
  var extendStatics = function(d2, b2) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d3, b3) {
      d3.__proto__ = b3;
    } || function(d3, b3) {
      for (var p in b3) if (Object.prototype.hasOwnProperty.call(b3, p)) d3[p] = b3[p];
    };
    return extendStatics(d2, b2);
  };
  function __extends(d2, b2) {
    if (typeof b2 !== "function" && b2 !== null)
      throw new TypeError("Class extends value " + String(b2) + " is not a constructor or null");
    extendStatics(d2, b2);
    function __() {
      this.constructor = d2;
    }
    d2.prototype = b2 === null ? Object.create(b2) : (__.prototype = b2.prototype, new __());
  }
  var __assign = function() {
    __assign = Object.assign || function __assign2(t) {
      for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
        s2 = arguments[i];
        for (var p in s2) if (Object.prototype.hasOwnProperty.call(s2, p)) t[p] = s2[p];
      }
      return t;
    };
    return __assign.apply(this, arguments);
  };
  var options = function(input2, defaults) {
    if (input2 === null || typeof input2 === "undefined") {
      input2 = {};
    }
    var output2 = __assign({}, input2);
    for (var key in defaults) {
      if (defaults.hasOwnProperty(key) && typeof input2[key] === "undefined") {
        output2[key] = defaults[key];
      }
    }
    if (typeof Object.getOwnPropertySymbols === "function") {
      var symbols = Object.getOwnPropertySymbols(defaults);
      for (var i = 0; i < symbols.length; i++) {
        var symbol = symbols[i];
        if (defaults.propertyIsEnumerable(symbol) && typeof input2[symbol] === "undefined") {
          output2[symbol] = defaults[symbol];
        }
      }
    }
    return output2;
  };
  var math_random = Math.random;
  var EPSILON = 1e-9;
  var isFinite = Number.isFinite;
  function nextPowerOfTwo(x2) {
    x2 |= x2 >> 1;
    x2 |= x2 >> 2;
    x2 |= x2 >> 4;
    x2 |= x2 >> 8;
    x2 |= x2 >> 16;
    return x2 + 1;
  }
  function isPowerOfTwo(x2) {
    return x2 > 0 && (x2 & x2 - 1) === 0;
  }
  function mod(num, min, max) {
    if (typeof min === "undefined") {
      max = 1;
      min = 0;
    } else if (typeof max === "undefined") {
      max = min;
      min = 0;
    }
    if (max > min) {
      num = (num - min) % (max - min);
      return num + (num < 0 ? max : min);
    } else {
      num = (num - max) % (min - max);
      return num + (num <= 0 ? min : max);
    }
  }
  function clamp(num, min, max) {
    if (num < min) {
      return min;
    } else if (num > max) {
      return max;
    } else {
      return num;
    }
  }
  function random(min, max) {
    if (typeof min === "undefined") {
      max = 1;
      min = 0;
    } else if (typeof max === "undefined") {
      max = min;
      min = 0;
    }
    return min === max ? min : math_random() * (max - min) + min;
  }
  var math = Object.create(Math);
  math.EPSILON = EPSILON;
  math.isFinite = isFinite;
  math.nextPowerOfTwo = nextPowerOfTwo;
  math.isPowerOfTwo = isPowerOfTwo;
  math.mod = mod;
  math.clamp = clamp;
  math.random = random;
  var math_abs$9 = Math.abs;
  var math_sqrt$5 = Math.sqrt;
  var math_max$8 = Math.max;
  var math_min$8 = Math.min;
  var Vec2 = (
    /** @class */
    function() {
      function Vec22(x2, y) {
        if (!(this instanceof Vec22)) {
          return new Vec22(x2, y);
        }
        if (typeof x2 === "undefined") {
          this.x = 0;
          this.y = 0;
        } else if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
        } else {
          this.x = x2;
          this.y = y;
        }
      }
      Vec22.prototype._serialize = function() {
        return {
          x: this.x,
          y: this.y
        };
      };
      Vec22._deserialize = function(data) {
        var obj = Object.create(Vec22.prototype);
        obj.x = data.x;
        obj.y = data.y;
        return obj;
      };
      Vec22.zero = function() {
        var obj = Object.create(Vec22.prototype);
        obj.x = 0;
        obj.y = 0;
        return obj;
      };
      Vec22.neo = function(x2, y) {
        var obj = Object.create(Vec22.prototype);
        obj.x = x2;
        obj.y = y;
        return obj;
      };
      Vec22.clone = function(v3) {
        return Vec22.neo(v3.x, v3.y);
      };
      Vec22.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Vec22.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.x) && Number.isFinite(obj.y);
      };
      Vec22.assert = function(o) {
      };
      Vec22.prototype.clone = function() {
        return Vec22.clone(this);
      };
      Vec22.prototype.setZero = function() {
        this.x = 0;
        this.y = 0;
        return this;
      };
      Vec22.prototype.set = function(x2, y) {
        if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
        } else {
          this.x = x2;
          this.y = y;
        }
        return this;
      };
      Vec22.prototype.setNum = function(x2, y) {
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.setVec2 = function(value) {
        this.x = value.x;
        this.y = value.y;
        return this;
      };
      Vec22.prototype.wSet = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.setCombine(a2, v3, b2, w);
        } else {
          return this.setMul(a2, v3);
        }
      };
      Vec22.prototype.setCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.setMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.add = function(w) {
        this.x += w.x;
        this.y += w.y;
        return this;
      };
      Vec22.prototype.wAdd = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.addCombine(a2, v3, b2, w);
        } else {
          return this.addMul(a2, v3);
        }
      };
      Vec22.prototype.addCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x += x2;
        this.y += y;
        return this;
      };
      Vec22.prototype.addMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x += x2;
        this.y += y;
        return this;
      };
      Vec22.prototype.wSub = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.subCombine(a2, v3, b2, w);
        } else {
          return this.subMul(a2, v3);
        }
      };
      Vec22.prototype.subCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x -= x2;
        this.y -= y;
        return this;
      };
      Vec22.prototype.subMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x -= x2;
        this.y -= y;
        return this;
      };
      Vec22.prototype.sub = function(w) {
        this.x -= w.x;
        this.y -= w.y;
        return this;
      };
      Vec22.prototype.mul = function(m) {
        this.x *= m;
        this.y *= m;
        return this;
      };
      Vec22.prototype.length = function() {
        return Vec22.lengthOf(this);
      };
      Vec22.prototype.lengthSquared = function() {
        return Vec22.lengthSquared(this);
      };
      Vec22.prototype.normalize = function() {
        var length = this.length();
        if (length < EPSILON) {
          return 0;
        }
        var invLength = 1 / length;
        this.x *= invLength;
        this.y *= invLength;
        return length;
      };
      Vec22.normalize = function(v3) {
        var length = Vec22.lengthOf(v3);
        if (length < EPSILON) {
          return Vec22.zero();
        }
        var invLength = 1 / length;
        return Vec22.neo(v3.x * invLength, v3.y * invLength);
      };
      Vec22.lengthOf = function(v3) {
        return math_sqrt$5(v3.x * v3.x + v3.y * v3.y);
      };
      Vec22.lengthSquared = function(v3) {
        return v3.x * v3.x + v3.y * v3.y;
      };
      Vec22.distance = function(v3, w) {
        var dx = v3.x - w.x;
        var dy = v3.y - w.y;
        return math_sqrt$5(dx * dx + dy * dy);
      };
      Vec22.distanceSquared = function(v3, w) {
        var dx = v3.x - w.x;
        var dy = v3.y - w.y;
        return dx * dx + dy * dy;
      };
      Vec22.areEqual = function(v3, w) {
        return v3 === w || typeof w === "object" && w !== null && v3.x === w.x && v3.y === w.y;
      };
      Vec22.skew = function(v3) {
        return Vec22.neo(-v3.y, v3.x);
      };
      Vec22.dot = function(v3, w) {
        return v3.x * w.x + v3.y * w.y;
      };
      Vec22.cross = function(v3, w) {
        if (typeof w === "number") {
          return Vec22.neo(w * v3.y, -w * v3.x);
        } else if (typeof v3 === "number") {
          return Vec22.neo(-v3 * w.y, v3 * w.x);
        } else {
          return v3.x * w.y - v3.y * w.x;
        }
      };
      Vec22.crossVec2Vec2 = function(v3, w) {
        return v3.x * w.y - v3.y * w.x;
      };
      Vec22.crossVec2Num = function(v3, w) {
        return Vec22.neo(w * v3.y, -w * v3.x);
      };
      Vec22.crossNumVec2 = function(v3, w) {
        return Vec22.neo(-v3 * w.y, v3 * w.x);
      };
      Vec22.addCross = function(a2, v3, w) {
        if (typeof w === "number") {
          return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);
        } else if (typeof v3 === "number") {
          return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);
        }
      };
      Vec22.addCrossVec2Num = function(a2, v3, w) {
        return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);
      };
      Vec22.addCrossNumVec2 = function(a2, v3, w) {
        return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);
      };
      Vec22.add = function(v3, w) {
        return Vec22.neo(v3.x + w.x, v3.y + w.y);
      };
      Vec22.wAdd = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return Vec22.combine(a2, v3, b2, w);
        } else {
          return Vec22.mulNumVec2(a2, v3);
        }
      };
      Vec22.combine = function(a2, v3, b2, w) {
        return Vec22.zero().setCombine(a2, v3, b2, w);
      };
      Vec22.sub = function(v3, w) {
        return Vec22.neo(v3.x - w.x, v3.y - w.y);
      };
      Vec22.mul = function(a2, b2) {
        if (typeof a2 === "object") {
          return Vec22.neo(a2.x * b2, a2.y * b2);
        } else if (typeof b2 === "object") {
          return Vec22.neo(a2 * b2.x, a2 * b2.y);
        }
      };
      Vec22.mulVec2Num = function(a2, b2) {
        return Vec22.neo(a2.x * b2, a2.y * b2);
      };
      Vec22.mulNumVec2 = function(a2, b2) {
        return Vec22.neo(a2 * b2.x, a2 * b2.y);
      };
      Vec22.prototype.neg = function() {
        this.x = -this.x;
        this.y = -this.y;
        return this;
      };
      Vec22.neg = function(v3) {
        return Vec22.neo(-v3.x, -v3.y);
      };
      Vec22.abs = function(v3) {
        return Vec22.neo(math_abs$9(v3.x), math_abs$9(v3.y));
      };
      Vec22.mid = function(v3, w) {
        return Vec22.neo((v3.x + w.x) * 0.5, (v3.y + w.y) * 0.5);
      };
      Vec22.upper = function(v3, w) {
        return Vec22.neo(math_max$8(v3.x, w.x), math_max$8(v3.y, w.y));
      };
      Vec22.lower = function(v3, w) {
        return Vec22.neo(math_min$8(v3.x, w.x), math_min$8(v3.y, w.y));
      };
      Vec22.prototype.clamp = function(max) {
        var lengthSqr = this.x * this.x + this.y * this.y;
        if (lengthSqr > max * max) {
          var scale = max / math_sqrt$5(lengthSqr);
          this.x *= scale;
          this.y *= scale;
        }
        return this;
      };
      Vec22.clamp = function(v3, max) {
        var r = Vec22.neo(v3.x, v3.y);
        r.clamp(max);
        return r;
      };
      Vec22.clampVec2 = function(v3, min, max) {
        return {
          x: clamp(v3.x, min === null || min === void 0 ? void 0 : min.x, max === null || max === void 0 ? void 0 : max.x),
          y: clamp(v3.y, min === null || min === void 0 ? void 0 : min.y, max === null || max === void 0 ? void 0 : max.y)
        };
      };
      Vec22.scaleFn = function(x2, y) {
        return function(v3) {
          return Vec22.neo(v3.x * x2, v3.y * y);
        };
      };
      Vec22.translateFn = function(x2, y) {
        return function(v3) {
          return Vec22.neo(v3.x + x2, v3.y + y);
        };
      };
      return Vec22;
    }()
  );
  var math_max$7 = Math.max;
  var math_min$7 = Math.min;
  var AABB = (
    /** @class */
    function() {
      function AABB2(lower, upper) {
        if (!(this instanceof AABB2)) {
          return new AABB2(lower, upper);
        }
        this.lowerBound = Vec2.zero();
        this.upperBound = Vec2.zero();
        if (typeof lower === "object") {
          this.lowerBound.setVec2(lower);
        }
        if (typeof upper === "object") {
          this.upperBound.setVec2(upper);
        } else if (typeof lower === "object") {
          this.upperBound.setVec2(lower);
        }
      }
      AABB2.prototype.isValid = function() {
        return AABB2.isValid(this);
      };
      AABB2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.lowerBound) && Vec2.isValid(obj.upperBound) && Vec2.sub(obj.upperBound, obj.lowerBound).lengthSquared() >= 0;
      };
      AABB2.assert = function(o) {
      };
      AABB2.prototype.getCenter = function() {
        return Vec2.neo((this.lowerBound.x + this.upperBound.x) * 0.5, (this.lowerBound.y + this.upperBound.y) * 0.5);
      };
      AABB2.prototype.getExtents = function() {
        return Vec2.neo((this.upperBound.x - this.lowerBound.x) * 0.5, (this.upperBound.y - this.lowerBound.y) * 0.5);
      };
      AABB2.prototype.getPerimeter = function() {
        return 2 * (this.upperBound.x - this.lowerBound.x + this.upperBound.y - this.lowerBound.y);
      };
      AABB2.prototype.combine = function(a2, b2) {
        b2 = b2 || this;
        var lowerA = a2.lowerBound;
        var upperA = a2.upperBound;
        var lowerB = b2.lowerBound;
        var upperB = b2.upperBound;
        var lowerX = math_min$7(lowerA.x, lowerB.x);
        var lowerY = math_min$7(lowerA.y, lowerB.y);
        var upperX = math_max$7(upperB.x, upperA.x);
        var upperY = math_max$7(upperB.y, upperA.y);
        this.lowerBound.setNum(lowerX, lowerY);
        this.upperBound.setNum(upperX, upperY);
      };
      AABB2.prototype.combinePoints = function(a2, b2) {
        this.lowerBound.setNum(math_min$7(a2.x, b2.x), math_min$7(a2.y, b2.y));
        this.upperBound.setNum(math_max$7(a2.x, b2.x), math_max$7(a2.y, b2.y));
      };
      AABB2.prototype.set = function(aabb) {
        this.lowerBound.setNum(aabb.lowerBound.x, aabb.lowerBound.y);
        this.upperBound.setNum(aabb.upperBound.x, aabb.upperBound.y);
      };
      AABB2.prototype.contains = function(aabb) {
        var result = true;
        result = result && this.lowerBound.x <= aabb.lowerBound.x;
        result = result && this.lowerBound.y <= aabb.lowerBound.y;
        result = result && aabb.upperBound.x <= this.upperBound.x;
        result = result && aabb.upperBound.y <= this.upperBound.y;
        return result;
      };
      AABB2.prototype.extend = function(value) {
        AABB2.extend(this, value);
        return this;
      };
      AABB2.extend = function(out, value) {
        out.lowerBound.x -= value;
        out.lowerBound.y -= value;
        out.upperBound.x += value;
        out.upperBound.y += value;
        return out;
      };
      AABB2.testOverlap = function(a2, b2) {
        var d1x = b2.lowerBound.x - a2.upperBound.x;
        var d2x = a2.lowerBound.x - b2.upperBound.x;
        var d1y = b2.lowerBound.y - a2.upperBound.y;
        var d2y = a2.lowerBound.y - b2.upperBound.y;
        if (d1x > 0 || d1y > 0 || d2x > 0 || d2y > 0) {
          return false;
        }
        return true;
      };
      AABB2.areEqual = function(a2, b2) {
        return Vec2.areEqual(a2.lowerBound, b2.lowerBound) && Vec2.areEqual(a2.upperBound, b2.upperBound);
      };
      AABB2.diff = function(a2, b2) {
        var wD = math_max$7(0, math_min$7(a2.upperBound.x, b2.upperBound.x) - math_max$7(b2.lowerBound.x, a2.lowerBound.x));
        var hD = math_max$7(0, math_min$7(a2.upperBound.y, b2.upperBound.y) - math_max$7(b2.lowerBound.y, a2.lowerBound.y));
        var wA = a2.upperBound.x - a2.lowerBound.x;
        var hA = a2.upperBound.y - a2.lowerBound.y;
        var wB = b2.upperBound.x - b2.lowerBound.x;
        var hB = b2.upperBound.y - b2.lowerBound.y;
        return wA * hA + wB * hB - wD * hD;
      };
      AABB2.prototype.rayCast = function(output2, input2) {
        var tmin = -Infinity;
        var tmax = Infinity;
        var p = input2.p1;
        var d2 = Vec2.sub(input2.p2, input2.p1);
        var absD = Vec2.abs(d2);
        var normal3 = Vec2.zero();
        {
          if (absD.x < EPSILON) {
            if (p.x < this.lowerBound.x || this.upperBound.x < p.x) {
              return false;
            }
          } else {
            var inv_d = 1 / d2.x;
            var t1 = (this.lowerBound.x - p.x) * inv_d;
            var t2 = (this.upperBound.x - p.x) * inv_d;
            var s2 = -1;
            if (t1 > t2) {
              var temp3 = t1;
              t1 = t2;
              t2 = temp3;
              s2 = 1;
            }
            if (t1 > tmin) {
              normal3.setZero();
              normal3.x = s2;
              tmin = t1;
            }
            tmax = math_min$7(tmax, t2);
            if (tmin > tmax) {
              return false;
            }
          }
        }
        {
          if (absD.y < EPSILON) {
            if (p.y < this.lowerBound.y || this.upperBound.y < p.y) {
              return false;
            }
          } else {
            var inv_d = 1 / d2.y;
            var t1 = (this.lowerBound.y - p.y) * inv_d;
            var t2 = (this.upperBound.y - p.y) * inv_d;
            var s2 = -1;
            if (t1 > t2) {
              var temp3 = t1;
              t1 = t2;
              t2 = temp3;
              s2 = 1;
            }
            if (t1 > tmin) {
              normal3.setZero();
              normal3.y = s2;
              tmin = t1;
            }
            tmax = math_min$7(tmax, t2);
            if (tmin > tmax) {
              return false;
            }
          }
        }
        if (tmin < 0 || input2.maxFraction < tmin) {
          return false;
        }
        output2.fraction = tmin;
        output2.normal = normal3;
        return true;
      };
      AABB2.prototype.toString = function() {
        return JSON.stringify(this);
      };
      AABB2.combinePoints = function(out, a2, b2) {
        out.lowerBound.x = math_min$7(a2.x, b2.x);
        out.lowerBound.y = math_min$7(a2.y, b2.y);
        out.upperBound.x = math_max$7(a2.x, b2.x);
        out.upperBound.y = math_max$7(a2.y, b2.y);
        return out;
      };
      AABB2.combinedPerimeter = function(a2, b2) {
        var lx = math_min$7(a2.lowerBound.x, b2.lowerBound.x);
        var ly = math_min$7(a2.lowerBound.y, b2.lowerBound.y);
        var ux = math_max$7(a2.upperBound.x, b2.upperBound.x);
        var uy = math_max$7(a2.upperBound.y, b2.upperBound.y);
        return 2 * (ux - lx + uy - ly);
      };
      return AABB2;
    }()
  );
  var math_PI$6 = Math.PI;
  var Settings = (
    /** @class */
    function() {
      function Settings2() {
      }
      Object.defineProperty(Settings2, "polygonRadius", {
        /**
         * The radius of the polygon/edge shape skin. This should not be modified.
         * Making this smaller means polygons will have an insufficient buffer for
         * continuous collision. Making it larger may create artifacts for vertex
         * collision.
         */
        get: function() {
          return 2 * Settings2.linearSlop;
        },
        enumerable: false,
        configurable: true
      });
      Settings2.lengthUnitsPerMeter = 1;
      Settings2.maxManifoldPoints = 2;
      Settings2.maxPolygonVertices = 12;
      Settings2.aabbExtension = 0.1;
      Settings2.aabbMultiplier = 2;
      Settings2.linearSlop = 5e-3;
      Settings2.angularSlop = 2 / 180 * math_PI$6;
      Settings2.maxSubSteps = 8;
      Settings2.maxTOIContacts = 32;
      Settings2.maxTOIIterations = 20;
      Settings2.maxDistanceIterations = 20;
      Settings2.velocityThreshold = 1;
      Settings2.maxLinearCorrection = 0.2;
      Settings2.maxAngularCorrection = 8 / 180 * math_PI$6;
      Settings2.maxTranslation = 2;
      Settings2.maxRotation = 0.5 * math_PI$6;
      Settings2.baumgarte = 0.2;
      Settings2.toiBaugarte = 0.75;
      Settings2.timeToSleep = 0.5;
      Settings2.linearSleepTolerance = 0.01;
      Settings2.angularSleepTolerance = 2 / 180 * math_PI$6;
      return Settings2;
    }()
  );
  var SettingsInternal = (
    /** @class */
    function() {
      function SettingsInternal2() {
      }
      Object.defineProperty(SettingsInternal2, "maxManifoldPoints", {
        get: function() {
          return Settings.maxManifoldPoints;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxPolygonVertices", {
        get: function() {
          return Settings.maxPolygonVertices;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "aabbExtension", {
        get: function() {
          return Settings.aabbExtension * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "aabbMultiplier", {
        get: function() {
          return Settings.aabbMultiplier;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSlop", {
        get: function() {
          return Settings.linearSlop * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSlopSquared", {
        get: function() {
          return Settings.linearSlop * Settings.lengthUnitsPerMeter * Settings.linearSlop * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSlop", {
        get: function() {
          return Settings.angularSlop;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "polygonRadius", {
        get: function() {
          return 2 * Settings.linearSlop;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxSubSteps", {
        get: function() {
          return Settings.maxSubSteps;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTOIContacts", {
        get: function() {
          return Settings.maxTOIContacts;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTOIIterations", {
        get: function() {
          return Settings.maxTOIIterations;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxDistanceIterations", {
        get: function() {
          return Settings.maxDistanceIterations;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "velocityThreshold", {
        get: function() {
          return Settings.velocityThreshold * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxLinearCorrection", {
        get: function() {
          return Settings.maxLinearCorrection * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxAngularCorrection", {
        get: function() {
          return Settings.maxAngularCorrection;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTranslation", {
        get: function() {
          return Settings.maxTranslation * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTranslationSquared", {
        get: function() {
          return Settings.maxTranslation * Settings.lengthUnitsPerMeter * Settings.maxTranslation * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxRotation", {
        get: function() {
          return Settings.maxRotation;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxRotationSquared", {
        get: function() {
          return Settings.maxRotation * Settings.maxRotation;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "baumgarte", {
        get: function() {
          return Settings.baumgarte;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "toiBaugarte", {
        get: function() {
          return Settings.toiBaugarte;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "timeToSleep", {
        get: function() {
          return Settings.timeToSleep;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSleepTolerance", {
        get: function() {
          return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSleepToleranceSqr", {
        get: function() {
          return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter * Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSleepTolerance", {
        get: function() {
          return Settings.angularSleepTolerance;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSleepToleranceSqr", {
        get: function() {
          return Settings.angularSleepTolerance * Settings.angularSleepTolerance;
        },
        enumerable: false,
        configurable: true
      });
      return SettingsInternal2;
    }()
  );
  var Pool = (
    /** @class */
    function() {
      function Pool2(opts) {
        this._list = [];
        this._max = Infinity;
        this._hasCreateFn = false;
        this._createCount = 0;
        this._hasAllocateFn = false;
        this._allocateCount = 0;
        this._hasReleaseFn = false;
        this._releaseCount = 0;
        this._hasDisposeFn = false;
        this._disposeCount = 0;
        this._list = [];
        this._max = opts.max || this._max;
        this._createFn = opts.create;
        this._hasCreateFn = typeof this._createFn === "function";
        this._allocateFn = opts.allocate;
        this._hasAllocateFn = typeof this._allocateFn === "function";
        this._releaseFn = opts.release;
        this._hasReleaseFn = typeof this._releaseFn === "function";
        this._disposeFn = opts.dispose;
        this._hasDisposeFn = typeof this._disposeFn === "function";
      }
      Pool2.prototype.max = function(n2) {
        if (typeof n2 === "number") {
          this._max = n2;
          return this;
        }
        return this._max;
      };
      Pool2.prototype.size = function() {
        return this._list.length;
      };
      Pool2.prototype.allocate = function() {
        var item;
        if (this._list.length > 0) {
          item = this._list.shift();
        } else {
          this._createCount++;
          if (this._hasCreateFn) {
            item = this._createFn();
          } else {
            item = {};
          }
        }
        this._allocateCount++;
        if (this._hasAllocateFn) {
          this._allocateFn(item);
        }
        return item;
      };
      Pool2.prototype.release = function(item) {
        if (this._list.length < this._max) {
          this._releaseCount++;
          if (this._hasReleaseFn) {
            this._releaseFn(item);
          }
          this._list.push(item);
        } else {
          this._disposeCount++;
          if (this._hasDisposeFn) {
            item = this._disposeFn(item);
          }
        }
      };
      Pool2.prototype.toString = function() {
        return " +" + this._createCount + " >" + this._allocateCount + " <" + this._releaseCount + " -" + this._disposeCount + " =" + this._list.length + "/" + this._max;
      };
      return Pool2;
    }()
  );
  var math_abs$8 = Math.abs;
  var math_max$6 = Math.max;
  var TreeNode = (
    /** @class */
    function() {
      function TreeNode2(id) {
        this.aabb = new AABB();
        this.userData = null;
        this.parent = null;
        this.child1 = null;
        this.child2 = null;
        this.height = -1;
        this.id = id;
      }
      TreeNode2.prototype.toString = function() {
        return this.id + ": " + this.userData;
      };
      TreeNode2.prototype.isLeaf = function() {
        return this.child1 == null;
      };
      return TreeNode2;
    }()
  );
  var poolTreeNode = new Pool({
    create: function() {
      return new TreeNode();
    },
    release: function(node) {
      node.userData = null;
      node.parent = null;
      node.child1 = null;
      node.child2 = null;
      node.height = -1;
      node.id = void 0;
    }
  });
  var DynamicTree = (
    /** @class */
    function() {
      function DynamicTree2() {
        this.inputPool = new Pool({
          create: function() {
            return {};
          },
          release: function(stack) {
          }
        });
        this.stackPool = new Pool({
          create: function() {
            return [];
          },
          release: function(stack) {
            stack.length = 0;
          }
        });
        this.iteratorPool = new Pool({
          create: function() {
            return new Iterator();
          },
          release: function(iterator) {
            iterator.close();
          }
        });
        this.m_root = null;
        this.m_nodes = {};
        this.m_lastProxyId = 0;
      }
      DynamicTree2.prototype.getUserData = function(id) {
        var node = this.m_nodes[id];
        return node.userData;
      };
      DynamicTree2.prototype.getFatAABB = function(id) {
        var node = this.m_nodes[id];
        return node.aabb;
      };
      DynamicTree2.prototype.allocateNode = function() {
        var node = poolTreeNode.allocate();
        node.id = ++this.m_lastProxyId;
        this.m_nodes[node.id] = node;
        return node;
      };
      DynamicTree2.prototype.freeNode = function(node) {
        delete this.m_nodes[node.id];
        poolTreeNode.release(node);
      };
      DynamicTree2.prototype.createProxy = function(aabb, userData) {
        var node = this.allocateNode();
        node.aabb.set(aabb);
        AABB.extend(node.aabb, SettingsInternal.aabbExtension);
        node.userData = userData;
        node.height = 0;
        this.insertLeaf(node);
        return node.id;
      };
      DynamicTree2.prototype.destroyProxy = function(id) {
        var node = this.m_nodes[id];
        this.removeLeaf(node);
        this.freeNode(node);
      };
      DynamicTree2.prototype.moveProxy = function(id, aabb, d2) {
        var node = this.m_nodes[id];
        if (node.aabb.contains(aabb)) {
          return false;
        }
        this.removeLeaf(node);
        node.aabb.set(aabb);
        aabb = node.aabb;
        AABB.extend(aabb, SettingsInternal.aabbExtension);
        if (d2.x < 0) {
          aabb.lowerBound.x += d2.x * SettingsInternal.aabbMultiplier;
        } else {
          aabb.upperBound.x += d2.x * SettingsInternal.aabbMultiplier;
        }
        if (d2.y < 0) {
          aabb.lowerBound.y += d2.y * SettingsInternal.aabbMultiplier;
        } else {
          aabb.upperBound.y += d2.y * SettingsInternal.aabbMultiplier;
        }
        this.insertLeaf(node);
        return true;
      };
      DynamicTree2.prototype.insertLeaf = function(leaf) {
        if (this.m_root == null) {
          this.m_root = leaf;
          this.m_root.parent = null;
          return;
        }
        var leafAABB = leaf.aabb;
        var index = this.m_root;
        while (!index.isLeaf()) {
          var child1 = index.child1;
          var child2 = index.child2;
          var area = index.aabb.getPerimeter();
          var combinedArea = AABB.combinedPerimeter(index.aabb, leafAABB);
          var cost = 2 * combinedArea;
          var inheritanceCost = 2 * (combinedArea - area);
          var newArea1 = AABB.combinedPerimeter(leafAABB, child1.aabb);
          var cost1 = newArea1 + inheritanceCost;
          if (!child1.isLeaf()) {
            var oldArea = child1.aabb.getPerimeter();
            cost1 -= oldArea;
          }
          var newArea2 = AABB.combinedPerimeter(leafAABB, child2.aabb);
          var cost2 = newArea2 + inheritanceCost;
          if (!child2.isLeaf()) {
            var oldArea = child2.aabb.getPerimeter();
            cost2 -= oldArea;
          }
          if (cost < cost1 && cost < cost2) {
            break;
          }
          if (cost1 < cost2) {
            index = child1;
          } else {
            index = child2;
          }
        }
        var sibling = index;
        var oldParent = sibling.parent;
        var newParent = this.allocateNode();
        newParent.parent = oldParent;
        newParent.userData = null;
        newParent.aabb.combine(leafAABB, sibling.aabb);
        newParent.height = sibling.height + 1;
        if (oldParent != null) {
          if (oldParent.child1 === sibling) {
            oldParent.child1 = newParent;
          } else {
            oldParent.child2 = newParent;
          }
          newParent.child1 = sibling;
          newParent.child2 = leaf;
          sibling.parent = newParent;
          leaf.parent = newParent;
        } else {
          newParent.child1 = sibling;
          newParent.child2 = leaf;
          sibling.parent = newParent;
          leaf.parent = newParent;
          this.m_root = newParent;
        }
        index = leaf.parent;
        while (index != null) {
          index = this.balance(index);
          var child1 = index.child1;
          var child2 = index.child2;
          index.height = 1 + math_max$6(child1.height, child2.height);
          index.aabb.combine(child1.aabb, child2.aabb);
          index = index.parent;
        }
      };
      DynamicTree2.prototype.removeLeaf = function(leaf) {
        if (leaf === this.m_root) {
          this.m_root = null;
          return;
        }
        var parent = leaf.parent;
        var grandParent = parent.parent;
        var sibling;
        if (parent.child1 === leaf) {
          sibling = parent.child2;
        } else {
          sibling = parent.child1;
        }
        if (grandParent != null) {
          if (grandParent.child1 === parent) {
            grandParent.child1 = sibling;
          } else {
            grandParent.child2 = sibling;
          }
          sibling.parent = grandParent;
          this.freeNode(parent);
          var index = grandParent;
          while (index != null) {
            index = this.balance(index);
            var child1 = index.child1;
            var child2 = index.child2;
            index.aabb.combine(child1.aabb, child2.aabb);
            index.height = 1 + math_max$6(child1.height, child2.height);
            index = index.parent;
          }
        } else {
          this.m_root = sibling;
          sibling.parent = null;
          this.freeNode(parent);
        }
      };
      DynamicTree2.prototype.balance = function(iA) {
        var A = iA;
        if (A.isLeaf() || A.height < 2) {
          return iA;
        }
        var B = A.child1;
        var C = A.child2;
        var balance = C.height - B.height;
        if (balance > 1) {
          var F = C.child1;
          var G = C.child2;
          C.child1 = A;
          C.parent = A.parent;
          A.parent = C;
          if (C.parent != null) {
            if (C.parent.child1 === iA) {
              C.parent.child1 = C;
            } else {
              C.parent.child2 = C;
            }
          } else {
            this.m_root = C;
          }
          if (F.height > G.height) {
            C.child2 = F;
            A.child2 = G;
            G.parent = A;
            A.aabb.combine(B.aabb, G.aabb);
            C.aabb.combine(A.aabb, F.aabb);
            A.height = 1 + math_max$6(B.height, G.height);
            C.height = 1 + math_max$6(A.height, F.height);
          } else {
            C.child2 = G;
            A.child2 = F;
            F.parent = A;
            A.aabb.combine(B.aabb, F.aabb);
            C.aabb.combine(A.aabb, G.aabb);
            A.height = 1 + math_max$6(B.height, F.height);
            C.height = 1 + math_max$6(A.height, G.height);
          }
          return C;
        }
        if (balance < -1) {
          var D = B.child1;
          var E = B.child2;
          B.child1 = A;
          B.parent = A.parent;
          A.parent = B;
          if (B.parent != null) {
            if (B.parent.child1 === A) {
              B.parent.child1 = B;
            } else {
              B.parent.child2 = B;
            }
          } else {
            this.m_root = B;
          }
          if (D.height > E.height) {
            B.child2 = D;
            A.child1 = E;
            E.parent = A;
            A.aabb.combine(C.aabb, E.aabb);
            B.aabb.combine(A.aabb, D.aabb);
            A.height = 1 + math_max$6(C.height, E.height);
            B.height = 1 + math_max$6(A.height, D.height);
          } else {
            B.child2 = E;
            A.child1 = D;
            D.parent = A;
            A.aabb.combine(C.aabb, D.aabb);
            B.aabb.combine(A.aabb, E.aabb);
            A.height = 1 + math_max$6(C.height, D.height);
            B.height = 1 + math_max$6(A.height, E.height);
          }
          return B;
        }
        return A;
      };
      DynamicTree2.prototype.getHeight = function() {
        if (this.m_root == null) {
          return 0;
        }
        return this.m_root.height;
      };
      DynamicTree2.prototype.getAreaRatio = function() {
        if (this.m_root == null) {
          return 0;
        }
        var root = this.m_root;
        var rootArea = root.aabb.getPerimeter();
        var totalArea = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height < 0) {
            continue;
          }
          totalArea += node.aabb.getPerimeter();
        }
        this.iteratorPool.release(it);
        return totalArea / rootArea;
      };
      DynamicTree2.prototype.computeHeight = function(id) {
        var node;
        if (typeof id !== "undefined") {
          node = this.m_nodes[id];
        } else {
          node = this.m_root;
        }
        if (node.isLeaf()) {
          return 0;
        }
        var height1 = this.computeHeight(node.child1.id);
        var height2 = this.computeHeight(node.child2.id);
        return 1 + math_max$6(height1, height2);
      };
      DynamicTree2.prototype.validateStructure = function(node) {
        if (node == null) {
          return;
        }
        if (node === this.m_root) ;
        var child1 = node.child1;
        var child2 = node.child2;
        if (node.isLeaf()) {
          return;
        }
        this.validateStructure(child1);
        this.validateStructure(child2);
      };
      DynamicTree2.prototype.validateMetrics = function(node) {
        if (node == null) {
          return;
        }
        var child1 = node.child1;
        var child2 = node.child2;
        if (node.isLeaf()) {
          return;
        }
        this.validateMetrics(child1);
        this.validateMetrics(child2);
      };
      DynamicTree2.prototype.validate = function() {
        return;
      };
      DynamicTree2.prototype.getMaxBalance = function() {
        var maxBalance = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height <= 1) {
            continue;
          }
          var balance = math_abs$8(node.child2.height - node.child1.height);
          maxBalance = math_max$6(maxBalance, balance);
        }
        this.iteratorPool.release(it);
        return maxBalance;
      };
      DynamicTree2.prototype.rebuildBottomUp = function() {
        var nodes = [];
        var count = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height < 0) {
            continue;
          }
          if (node.isLeaf()) {
            node.parent = null;
            nodes[count] = node;
            ++count;
          } else {
            this.freeNode(node);
          }
        }
        this.iteratorPool.release(it);
        while (count > 1) {
          var minCost = Infinity;
          var iMin = -1;
          var jMin = -1;
          for (var i = 0; i < count; ++i) {
            var aabbi = nodes[i].aabb;
            for (var j = i + 1; j < count; ++j) {
              var aabbj = nodes[j].aabb;
              var cost = AABB.combinedPerimeter(aabbi, aabbj);
              if (cost < minCost) {
                iMin = i;
                jMin = j;
                minCost = cost;
              }
            }
          }
          var child1 = nodes[iMin];
          var child2 = nodes[jMin];
          var parent_1 = this.allocateNode();
          parent_1.child1 = child1;
          parent_1.child2 = child2;
          parent_1.height = 1 + math_max$6(child1.height, child2.height);
          parent_1.aabb.combine(child1.aabb, child2.aabb);
          parent_1.parent = null;
          child1.parent = parent_1;
          child2.parent = parent_1;
          nodes[jMin] = nodes[count - 1];
          nodes[iMin] = parent_1;
          --count;
        }
        this.m_root = nodes[0];
      };
      DynamicTree2.prototype.shiftOrigin = function(newOrigin) {
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          var aabb = node.aabb;
          aabb.lowerBound.x -= newOrigin.x;
          aabb.lowerBound.y -= newOrigin.y;
          aabb.upperBound.x -= newOrigin.x;
          aabb.upperBound.y -= newOrigin.y;
        }
        this.iteratorPool.release(it);
      };
      DynamicTree2.prototype.query = function(aabb, queryCallback) {
        var stack = this.stackPool.allocate();
        stack.push(this.m_root);
        while (stack.length > 0) {
          var node = stack.pop();
          if (node == null) {
            continue;
          }
          if (AABB.testOverlap(node.aabb, aabb)) {
            if (node.isLeaf()) {
              var proceed = queryCallback(node.id);
              if (proceed === false) {
                return;
              }
            } else {
              stack.push(node.child1);
              stack.push(node.child2);
            }
          }
        }
        this.stackPool.release(stack);
      };
      DynamicTree2.prototype.rayCast = function(input2, rayCastCallback) {
        var p1 = input2.p1;
        var p2 = input2.p2;
        var r = Vec2.sub(p2, p1);
        r.normalize();
        var v3 = Vec2.crossNumVec2(1, r);
        var abs_v = Vec2.abs(v3);
        var maxFraction = input2.maxFraction;
        var segmentAABB = new AABB();
        var t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);
        segmentAABB.combinePoints(p1, t);
        var stack = this.stackPool.allocate();
        var subInput = this.inputPool.allocate();
        stack.push(this.m_root);
        while (stack.length > 0) {
          var node = stack.pop();
          if (node == null) {
            continue;
          }
          if (AABB.testOverlap(node.aabb, segmentAABB) === false) {
            continue;
          }
          var c2 = node.aabb.getCenter();
          var h = node.aabb.getExtents();
          var separation = math_abs$8(Vec2.dot(v3, Vec2.sub(p1, c2))) - Vec2.dot(abs_v, h);
          if (separation > 0) {
            continue;
          }
          if (node.isLeaf()) {
            subInput.p1 = Vec2.clone(input2.p1);
            subInput.p2 = Vec2.clone(input2.p2);
            subInput.maxFraction = maxFraction;
            var value = rayCastCallback(subInput, node.id);
            if (value === 0) {
              break;
            } else if (value > 0) {
              maxFraction = value;
              t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);
              segmentAABB.combinePoints(p1, t);
            }
          } else {
            stack.push(node.child1);
            stack.push(node.child2);
          }
        }
        this.stackPool.release(stack);
        this.inputPool.release(subInput);
      };
      return DynamicTree2;
    }()
  );
  var Iterator = (
    /** @class */
    function() {
      function Iterator2() {
        this.parents = [];
        this.states = [];
      }
      Iterator2.prototype.preorder = function(root) {
        this.parents.length = 0;
        this.parents.push(root);
        this.states.length = 0;
        this.states.push(0);
        return this;
      };
      Iterator2.prototype.next = function() {
        while (this.parents.length > 0) {
          var i = this.parents.length - 1;
          var node = this.parents[i];
          if (this.states[i] === 0) {
            this.states[i] = 1;
            return node;
          }
          if (this.states[i] === 1) {
            this.states[i] = 2;
            if (node.child1) {
              this.parents.push(node.child1);
              this.states.push(1);
              return node.child1;
            }
          }
          if (this.states[i] === 2) {
            this.states[i] = 3;
            if (node.child2) {
              this.parents.push(node.child2);
              this.states.push(1);
              return node.child2;
            }
          }
          this.parents.pop();
          this.states.pop();
        }
      };
      Iterator2.prototype.close = function() {
        this.parents.length = 0;
      };
      return Iterator2;
    }()
  );
  var math_max$5 = Math.max;
  var math_min$6 = Math.min;
  var BroadPhase = (
    /** @class */
    function() {
      function BroadPhase2() {
        var _this = this;
        this.m_tree = new DynamicTree();
        this.m_moveBuffer = [];
        this.query = function(aabb, queryCallback) {
          _this.m_tree.query(aabb, queryCallback);
        };
        this.queryCallback = function(proxyId) {
          if (proxyId === _this.m_queryProxyId) {
            return true;
          }
          var proxyIdA = math_min$6(proxyId, _this.m_queryProxyId);
          var proxyIdB = math_max$5(proxyId, _this.m_queryProxyId);
          var userDataA = _this.m_tree.getUserData(proxyIdA);
          var userDataB = _this.m_tree.getUserData(proxyIdB);
          _this.m_callback(userDataA, userDataB);
          return true;
        };
      }
      BroadPhase2.prototype.getUserData = function(proxyId) {
        return this.m_tree.getUserData(proxyId);
      };
      BroadPhase2.prototype.testOverlap = function(proxyIdA, proxyIdB) {
        var aabbA = this.m_tree.getFatAABB(proxyIdA);
        var aabbB = this.m_tree.getFatAABB(proxyIdB);
        return AABB.testOverlap(aabbA, aabbB);
      };
      BroadPhase2.prototype.getFatAABB = function(proxyId) {
        return this.m_tree.getFatAABB(proxyId);
      };
      BroadPhase2.prototype.getProxyCount = function() {
        return this.m_moveBuffer.length;
      };
      BroadPhase2.prototype.getTreeHeight = function() {
        return this.m_tree.getHeight();
      };
      BroadPhase2.prototype.getTreeBalance = function() {
        return this.m_tree.getMaxBalance();
      };
      BroadPhase2.prototype.getTreeQuality = function() {
        return this.m_tree.getAreaRatio();
      };
      BroadPhase2.prototype.rayCast = function(input2, rayCastCallback) {
        this.m_tree.rayCast(input2, rayCastCallback);
      };
      BroadPhase2.prototype.shiftOrigin = function(newOrigin) {
        this.m_tree.shiftOrigin(newOrigin);
      };
      BroadPhase2.prototype.createProxy = function(aabb, userData) {
        var proxyId = this.m_tree.createProxy(aabb, userData);
        this.bufferMove(proxyId);
        return proxyId;
      };
      BroadPhase2.prototype.destroyProxy = function(proxyId) {
        this.unbufferMove(proxyId);
        this.m_tree.destroyProxy(proxyId);
      };
      BroadPhase2.prototype.moveProxy = function(proxyId, aabb, displacement2) {
        var changed = this.m_tree.moveProxy(proxyId, aabb, displacement2);
        if (changed) {
          this.bufferMove(proxyId);
        }
      };
      BroadPhase2.prototype.touchProxy = function(proxyId) {
        this.bufferMove(proxyId);
      };
      BroadPhase2.prototype.bufferMove = function(proxyId) {
        this.m_moveBuffer.push(proxyId);
      };
      BroadPhase2.prototype.unbufferMove = function(proxyId) {
        for (var i = 0; i < this.m_moveBuffer.length; ++i) {
          if (this.m_moveBuffer[i] === proxyId) {
            this.m_moveBuffer[i] = null;
          }
        }
      };
      BroadPhase2.prototype.updatePairs = function(addPairCallback) {
        this.m_callback = addPairCallback;
        while (this.m_moveBuffer.length > 0) {
          this.m_queryProxyId = this.m_moveBuffer.pop();
          if (this.m_queryProxyId === null) {
            continue;
          }
          var fatAABB = this.m_tree.getFatAABB(this.m_queryProxyId);
          this.m_tree.query(fatAABB, this.queryCallback);
        }
      };
      return BroadPhase2;
    }()
  );
  var math_sin$2 = Math.sin;
  var math_cos$2 = Math.cos;
  var math_sqrt$4 = Math.sqrt;
  function vec2(x2, y) {
    return { x: x2, y };
  }
  function rotation(angle) {
    return { s: math_sin$2(angle), c: math_cos$2(angle) };
  }
  function setVec2(out, x2, y) {
    out.x = x2;
    out.y = y;
    return out;
  }
  function copyVec2(out, w) {
    out.x = w.x;
    out.y = w.y;
    return out;
  }
  function zeroVec2(out) {
    out.x = 0;
    out.y = 0;
    return out;
  }
  function negVec2(out) {
    out.x = -out.x;
    out.y = -out.y;
    return out;
  }
  function plusVec2(out, w) {
    out.x += w.x;
    out.y += w.y;
    return out;
  }
  function addVec2(out, v3, w) {
    out.x = v3.x + w.x;
    out.y = v3.x + w.y;
    return out;
  }
  function minusVec2(out, w) {
    out.x -= w.x;
    out.y -= w.y;
    return out;
  }
  function subVec2(out, v3, w) {
    out.x = v3.x - w.x;
    out.y = v3.y - w.y;
    return out;
  }
  function mulVec2(out, m) {
    out.x *= m;
    out.y *= m;
    return out;
  }
  function scaleVec2(out, m, w) {
    out.x = m * w.x;
    out.y = m * w.y;
    return out;
  }
  function plusScaleVec2(out, m, w) {
    out.x += m * w.x;
    out.y += m * w.y;
    return out;
  }
  function minusScaleVec2(out, m, w) {
    out.x -= m * w.x;
    out.y -= m * w.y;
    return out;
  }
  function combine2Vec2(out, am, a2, bm, b2) {
    out.x = am * a2.x + bm * b2.x;
    out.y = am * a2.y + bm * b2.y;
    return out;
  }
  function combine3Vec2(out, am, a2, bm, b2, cm, c2) {
    out.x = am * a2.x + bm * b2.x + cm * c2.x;
    out.y = am * a2.y + bm * b2.y + cm * c2.y;
    return out;
  }
  function normalizeVec2Length(out) {
    var length = math_sqrt$4(out.x * out.x + out.y * out.y);
    if (length !== 0) {
      var invLength = 1 / length;
      out.x *= invLength;
      out.y *= invLength;
    }
    return length;
  }
  function normalizeVec2(out) {
    var length = math_sqrt$4(out.x * out.x + out.y * out.y);
    if (length > 0) {
      var invLength = 1 / length;
      out.x *= invLength;
      out.y *= invLength;
    }
    return out;
  }
  function crossVec2Num(out, v3, w) {
    var x2 = w * v3.y;
    var y = -w * v3.x;
    out.x = x2;
    out.y = y;
    return out;
  }
  function crossNumVec2(out, w, v3) {
    var x2 = -w * v3.y;
    var y = w * v3.x;
    out.x = x2;
    out.y = y;
    return out;
  }
  function crossVec2Vec2(a2, b2) {
    return a2.x * b2.y - a2.y * b2.x;
  }
  function dotVec2(a2, b2) {
    return a2.x * b2.x + a2.y * b2.y;
  }
  function lengthSqrVec2(a2) {
    return a2.x * a2.x + a2.y * a2.y;
  }
  function distVec2(a2, b2) {
    var dx = a2.x - b2.x;
    var dy = a2.y - b2.y;
    return math_sqrt$4(dx * dx + dy * dy);
  }
  function distSqrVec2(a2, b2) {
    var dx = a2.x - b2.x;
    var dy = a2.y - b2.y;
    return dx * dx + dy * dy;
  }
  function setRotAngle(out, a2) {
    out.c = math_cos$2(a2);
    out.s = math_sin$2(a2);
    return out;
  }
  function rotVec2(out, q, v3) {
    out.x = q.c * v3.x - q.s * v3.y;
    out.y = q.s * v3.x + q.c * v3.y;
    return out;
  }
  function derotVec2(out, q, v3) {
    var x2 = q.c * v3.x + q.s * v3.y;
    var y = -q.s * v3.x + q.c * v3.y;
    out.x = x2;
    out.y = y;
    return out;
  }
  function rerotVec2(out, before, after, v3) {
    var x0 = before.c * v3.x + before.s * v3.y;
    var y0 = -before.s * v3.x + before.c * v3.y;
    var x2 = after.c * x0 - after.s * y0;
    var y = after.s * x0 + after.c * y0;
    out.x = x2;
    out.y = y;
    return out;
  }
  function transform(x2, y, a2) {
    return { p: vec2(x2, y), q: rotation(a2) };
  }
  function copyTransform(out, transform2) {
    out.p.x = transform2.p.x;
    out.p.y = transform2.p.y;
    out.q.s = transform2.q.s;
    out.q.c = transform2.q.c;
    return out;
  }
  function transformVec2(out, xf2, v3) {
    var x2 = xf2.q.c * v3.x - xf2.q.s * v3.y + xf2.p.x;
    var y = xf2.q.s * v3.x + xf2.q.c * v3.y + xf2.p.y;
    out.x = x2;
    out.y = y;
    return out;
  }
  function detransformVec2(out, xf2, v3) {
    var px = v3.x - xf2.p.x;
    var py = v3.y - xf2.p.y;
    var x2 = xf2.q.c * px + xf2.q.s * py;
    var y = -xf2.q.s * px + xf2.q.c * py;
    out.x = x2;
    out.y = y;
    return out;
  }
  function retransformVec2(out, from, to, v3) {
    var x0 = from.q.c * v3.x - from.q.s * v3.y + from.p.x;
    var y0 = from.q.s * v3.x + from.q.c * v3.y + from.p.y;
    var px = x0 - to.p.x;
    var py = y0 - to.p.y;
    var x2 = to.q.c * px + to.q.s * py;
    var y = -to.q.s * px + to.q.c * py;
    out.x = x2;
    out.y = y;
    return out;
  }
  function detransformTransform(out, a2, b2) {
    var c2 = a2.q.c * b2.q.c + a2.q.s * b2.q.s;
    var s2 = a2.q.c * b2.q.s - a2.q.s * b2.q.c;
    var x2 = a2.q.c * (b2.p.x - a2.p.x) + a2.q.s * (b2.p.y - a2.p.y);
    var y = -a2.q.s * (b2.p.x - a2.p.x) + a2.q.c * (b2.p.y - a2.p.y);
    out.q.c = c2;
    out.q.s = s2;
    out.p.x = x2;
    out.p.y = y;
    return out;
  }
  var math_sin$1 = Math.sin;
  var math_cos$1 = Math.cos;
  var math_atan2$1 = Math.atan2;
  var Rot = (
    /** @class */
    function() {
      function Rot2(angle) {
        if (!(this instanceof Rot2)) {
          return new Rot2(angle);
        }
        if (typeof angle === "number") {
          this.setAngle(angle);
        } else if (typeof angle === "object") {
          this.setRot(angle);
        } else {
          this.setIdentity();
        }
      }
      Rot2.neo = function(angle) {
        var obj = Object.create(Rot2.prototype);
        obj.setAngle(angle);
        return obj;
      };
      Rot2.clone = function(rot) {
        var obj = Object.create(Rot2.prototype);
        obj.s = rot.s;
        obj.c = rot.c;
        return obj;
      };
      Rot2.identity = function() {
        var obj = Object.create(Rot2.prototype);
        obj.s = 0;
        obj.c = 1;
        return obj;
      };
      Rot2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.s) && Number.isFinite(obj.c);
      };
      Rot2.assert = function(o) {
      };
      Rot2.prototype.setIdentity = function() {
        this.s = 0;
        this.c = 1;
      };
      Rot2.prototype.set = function(angle) {
        if (typeof angle === "object") {
          this.s = angle.s;
          this.c = angle.c;
        } else {
          this.s = math_sin$1(angle);
          this.c = math_cos$1(angle);
        }
      };
      Rot2.prototype.setRot = function(angle) {
        this.s = angle.s;
        this.c = angle.c;
      };
      Rot2.prototype.setAngle = function(angle) {
        this.s = math_sin$1(angle);
        this.c = math_cos$1(angle);
      };
      Rot2.prototype.getAngle = function() {
        return math_atan2$1(this.s, this.c);
      };
      Rot2.prototype.getXAxis = function() {
        return Vec2.neo(this.c, this.s);
      };
      Rot2.prototype.getYAxis = function() {
        return Vec2.neo(-this.s, this.c);
      };
      Rot2.mul = function(rot, m) {
        if ("c" in m && "s" in m) {
          var qr = Rot2.identity();
          qr.s = rot.s * m.c + rot.c * m.s;
          qr.c = rot.c * m.c - rot.s * m.s;
          return qr;
        } else if ("x" in m && "y" in m) {
          return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);
        }
      };
      Rot2.mulRot = function(rot, m) {
        var qr = Rot2.identity();
        qr.s = rot.s * m.c + rot.c * m.s;
        qr.c = rot.c * m.c - rot.s * m.s;
        return qr;
      };
      Rot2.mulVec2 = function(rot, m) {
        return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);
      };
      Rot2.mulSub = function(rot, v3, w) {
        var x2 = rot.c * (v3.x - w.x) - rot.s * (v3.y - w.y);
        var y = rot.s * (v3.x - w.x) + rot.c * (v3.y - w.y);
        return Vec2.neo(x2, y);
      };
      Rot2.mulT = function(rot, m) {
        if ("c" in m && "s" in m) {
          var qr = Rot2.identity();
          qr.s = rot.c * m.s - rot.s * m.c;
          qr.c = rot.c * m.c + rot.s * m.s;
          return qr;
        } else if ("x" in m && "y" in m) {
          return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);
        }
      };
      Rot2.mulTRot = function(rot, m) {
        var qr = Rot2.identity();
        qr.s = rot.c * m.s - rot.s * m.c;
        qr.c = rot.c * m.c + rot.s * m.s;
        return qr;
      };
      Rot2.mulTVec2 = function(rot, m) {
        return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);
      };
      return Rot2;
    }()
  );
  var math_atan2 = Math.atan2;
  var math_PI$5 = Math.PI;
  var temp$7 = vec2(0, 0);
  var Sweep = (
    /** @class */
    function() {
      function Sweep2() {
        this.localCenter = Vec2.zero();
        this.c = Vec2.zero();
        this.a = 0;
        this.alpha0 = 0;
        this.c0 = Vec2.zero();
        this.a0 = 0;
      }
      Sweep2.prototype.recycle = function() {
        zeroVec2(this.localCenter);
        zeroVec2(this.c);
        this.a = 0;
        this.alpha0 = 0;
        zeroVec2(this.c0);
        this.a0 = 0;
      };
      Sweep2.prototype.setTransform = function(xf2) {
        transformVec2(temp$7, xf2, this.localCenter);
        copyVec2(this.c, temp$7);
        copyVec2(this.c0, temp$7);
        this.a = this.a0 = math_atan2(xf2.q.s, xf2.q.c);
      };
      Sweep2.prototype.setLocalCenter = function(localCenter2, xf2) {
        copyVec2(this.localCenter, localCenter2);
        transformVec2(temp$7, xf2, this.localCenter);
        copyVec2(this.c, temp$7);
        copyVec2(this.c0, temp$7);
      };
      Sweep2.prototype.getTransform = function(xf2, beta) {
        if (beta === void 0) {
          beta = 0;
        }
        setRotAngle(xf2.q, (1 - beta) * this.a0 + beta * this.a);
        combine2Vec2(xf2.p, 1 - beta, this.c0, beta, this.c);
        minusVec2(xf2.p, rotVec2(temp$7, xf2.q, this.localCenter));
      };
      Sweep2.prototype.advance = function(alpha) {
        var beta = (alpha - this.alpha0) / (1 - this.alpha0);
        combine2Vec2(this.c0, beta, this.c, 1 - beta, this.c0);
        this.a0 = beta * this.a + (1 - beta) * this.a0;
        this.alpha0 = alpha;
      };
      Sweep2.prototype.forward = function() {
        this.a0 = this.a;
        copyVec2(this.c0, this.c);
      };
      Sweep2.prototype.normalize = function() {
        var a0 = mod(this.a0, -math_PI$5, +math_PI$5);
        this.a -= this.a0 - a0;
        this.a0 = a0;
      };
      Sweep2.prototype.set = function(that) {
        copyVec2(this.localCenter, that.localCenter);
        copyVec2(this.c, that.c);
        this.a = that.a;
        this.alpha0 = that.alpha0;
        copyVec2(this.c0, that.c0);
        this.a0 = that.a0;
      };
      return Sweep2;
    }()
  );
  var Transform = (
    /** @class */
    function() {
      function Transform2(position, rotation2) {
        if (!(this instanceof Transform2)) {
          return new Transform2(position, rotation2);
        }
        this.p = Vec2.zero();
        this.q = Rot.identity();
        if (typeof position !== "undefined") {
          this.p.setVec2(position);
        }
        if (typeof rotation2 !== "undefined") {
          this.q.setAngle(rotation2);
        }
      }
      Transform2.clone = function(xf2) {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.clone(xf2.p);
        obj.q = Rot.clone(xf2.q);
        return obj;
      };
      Transform2.neo = function(position, rotation2) {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.clone(position);
        obj.q = Rot.clone(rotation2);
        return obj;
      };
      Transform2.identity = function() {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.zero();
        obj.q = Rot.identity();
        return obj;
      };
      Transform2.prototype.setIdentity = function() {
        this.p.setZero();
        this.q.setIdentity();
      };
      Transform2.prototype.set = function(a2, b2) {
        if (typeof b2 === "undefined") {
          this.p.set(a2.p);
          this.q.set(a2.q);
        } else {
          this.p.set(a2);
          this.q.set(b2);
        }
      };
      Transform2.prototype.setNum = function(position, rotation2) {
        this.p.setVec2(position);
        this.q.setAngle(rotation2);
      };
      Transform2.prototype.setTransform = function(xf2) {
        this.p.setVec2(xf2.p);
        this.q.setRot(xf2.q);
      };
      Transform2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.p) && Rot.isValid(obj.q);
      };
      Transform2.assert = function(o) {
      };
      Transform2.mul = function(a2, b2) {
        if (Array.isArray(b2)) {
          var arr = [];
          for (var i = 0; i < b2.length; i++) {
            arr[i] = Transform2.mul(a2, b2[i]);
          }
          return arr;
        } else if ("x" in b2 && "y" in b2) {
          return Transform2.mulVec2(a2, b2);
        } else if ("p" in b2 && "q" in b2) {
          return Transform2.mulXf(a2, b2);
        }
      };
      Transform2.mulAll = function(a2, b2) {
        var arr = [];
        for (var i = 0; i < b2.length; i++) {
          arr[i] = Transform2.mul(a2, b2[i]);
        }
        return arr;
      };
      Transform2.mulFn = function(a2) {
        return function(b2) {
          return Transform2.mul(a2, b2);
        };
      };
      Transform2.mulVec2 = function(a2, b2) {
        var x2 = a2.q.c * b2.x - a2.q.s * b2.y + a2.p.x;
        var y = a2.q.s * b2.x + a2.q.c * b2.y + a2.p.y;
        return Vec2.neo(x2, y);
      };
      Transform2.mulXf = function(a2, b2) {
        var xf2 = Transform2.identity();
        xf2.q = Rot.mulRot(a2.q, b2.q);
        xf2.p = Vec2.add(Rot.mulVec2(a2.q, b2.p), a2.p);
        return xf2;
      };
      Transform2.mulT = function(a2, b2) {
        if ("x" in b2 && "y" in b2) {
          return Transform2.mulTVec2(a2, b2);
        } else if ("p" in b2 && "q" in b2) {
          return Transform2.mulTXf(a2, b2);
        }
      };
      Transform2.mulTVec2 = function(a2, b2) {
        var px = b2.x - a2.p.x;
        var py = b2.y - a2.p.y;
        var x2 = a2.q.c * px + a2.q.s * py;
        var y = -a2.q.s * px + a2.q.c * py;
        return Vec2.neo(x2, y);
      };
      Transform2.mulTXf = function(a2, b2) {
        var xf2 = Transform2.identity();
        xf2.q.setRot(Rot.mulTRot(a2.q, b2.q));
        xf2.p.setVec2(Rot.mulTVec2(a2.q, Vec2.sub(b2.p, a2.p)));
        return xf2;
      };
      return Transform2;
    }()
  );
  var Velocity = (
    /** @class */
    /* @__PURE__ */ function() {
      function Velocity2() {
        this.v = Vec2.zero();
        this.w = 0;
      }
      return Velocity2;
    }()
  );
  var math_sin = Math.sin;
  var math_cos = Math.cos;
  var Position = (
    /** @class */
    function() {
      function Position2() {
        this.c = Vec2.zero();
        this.a = 0;
      }
      Position2.prototype.getTransform = function(xf2, p) {
        xf2.q.c = math_cos(this.a);
        xf2.q.s = math_sin(this.a);
        xf2.p.x = this.c.x - (xf2.q.c * p.x - xf2.q.s * p.y);
        xf2.p.y = this.c.y - (xf2.q.s * p.x + xf2.q.c * p.y);
        return xf2;
      };
      return Position2;
    }()
  );
  function getTransform(xf2, p, c2, a2) {
    xf2.q.c = math_cos(a2);
    xf2.q.s = math_sin(a2);
    xf2.p.x = c2.x - (xf2.q.c * p.x - xf2.q.s * p.y);
    xf2.p.y = c2.y - (xf2.q.s * p.x + xf2.q.c * p.y);
    return xf2;
  }
  var Shape = (
    /** @class */
    function() {
      function Shape2() {
        this.style = {};
        this.appData = {};
      }
      Shape2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return typeof obj.m_type === "string" && typeof obj.m_radius === "number";
      };
      return Shape2;
    }()
  );
  var synchronize_aabb1 = new AABB();
  var synchronize_aabb2 = new AABB();
  var displacement = vec2(0, 0);
  var FixtureDefDefault = {
    userData: null,
    friction: 0.2,
    restitution: 0,
    density: 0,
    isSensor: false,
    filterGroupIndex: 0,
    filterCategoryBits: 1,
    filterMaskBits: 65535
  };
  var FixtureProxy = (
    /** @class */
    /* @__PURE__ */ function() {
      function FixtureProxy2(fixture, childIndex) {
        this.aabb = new AABB();
        this.fixture = fixture;
        this.childIndex = childIndex;
      }
      return FixtureProxy2;
    }()
  );
  var Fixture = (
    /** @class */
    function() {
      function Fixture2(body, shape, def) {
        this.style = {};
        this.appData = {};
        if (shape.shape) {
          def = shape;
          shape = shape.shape;
        } else if (typeof def === "number") {
          def = { density: def };
        }
        def = options(def, FixtureDefDefault);
        this.m_body = body;
        this.m_friction = def.friction;
        this.m_restitution = def.restitution;
        this.m_density = def.density;
        this.m_isSensor = def.isSensor;
        this.m_filterGroupIndex = def.filterGroupIndex;
        this.m_filterCategoryBits = def.filterCategoryBits;
        this.m_filterMaskBits = def.filterMaskBits;
        this.m_shape = shape;
        this.m_next = null;
        this.m_proxies = [];
        this.m_proxyCount = 0;
        var childCount = this.m_shape.getChildCount();
        for (var i = 0; i < childCount; ++i) {
          this.m_proxies[i] = new FixtureProxy(this, i);
        }
        this.m_userData = def.userData;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Fixture2.prototype._reset = function() {
        var body = this.getBody();
        var broadPhase = body.m_world.m_broadPhase;
        this.destroyProxies(broadPhase);
        if (this.m_shape._reset) {
          this.m_shape._reset();
        }
        var childCount = this.m_shape.getChildCount();
        for (var i = 0; i < childCount; ++i) {
          this.m_proxies[i] = new FixtureProxy(this, i);
        }
        this.createProxies(broadPhase, body.m_xf);
        body.resetMassData();
      };
      Fixture2.prototype._serialize = function() {
        return {
          friction: this.m_friction,
          restitution: this.m_restitution,
          density: this.m_density,
          isSensor: this.m_isSensor,
          filterGroupIndex: this.m_filterGroupIndex,
          filterCategoryBits: this.m_filterCategoryBits,
          filterMaskBits: this.m_filterMaskBits,
          shape: this.m_shape
        };
      };
      Fixture2._deserialize = function(data, body, restore) {
        var shape = restore(Shape, data.shape);
        var fixture = shape && new Fixture2(body, shape, data);
        return fixture;
      };
      Fixture2.prototype.getType = function() {
        return this.m_shape.m_type;
      };
      Fixture2.prototype.getShape = function() {
        return this.m_shape;
      };
      Fixture2.prototype.isSensor = function() {
        return this.m_isSensor;
      };
      Fixture2.prototype.setSensor = function(sensor) {
        if (sensor != this.m_isSensor) {
          this.m_body.setAwake(true);
          this.m_isSensor = sensor;
        }
      };
      Fixture2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Fixture2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Fixture2.prototype.getBody = function() {
        return this.m_body;
      };
      Fixture2.prototype.getNext = function() {
        return this.m_next;
      };
      Fixture2.prototype.getDensity = function() {
        return this.m_density;
      };
      Fixture2.prototype.setDensity = function(density) {
        this.m_density = density;
      };
      Fixture2.prototype.getFriction = function() {
        return this.m_friction;
      };
      Fixture2.prototype.setFriction = function(friction) {
        this.m_friction = friction;
      };
      Fixture2.prototype.getRestitution = function() {
        return this.m_restitution;
      };
      Fixture2.prototype.setRestitution = function(restitution) {
        this.m_restitution = restitution;
      };
      Fixture2.prototype.testPoint = function(p) {
        return this.m_shape.testPoint(this.m_body.getTransform(), p);
      };
      Fixture2.prototype.rayCast = function(output2, input2, childIndex) {
        return this.m_shape.rayCast(output2, input2, this.m_body.getTransform(), childIndex);
      };
      Fixture2.prototype.getMassData = function(massData) {
        this.m_shape.computeMass(massData, this.m_density);
      };
      Fixture2.prototype.getAABB = function(childIndex) {
        return this.m_proxies[childIndex].aabb;
      };
      Fixture2.prototype.createProxies = function(broadPhase, xf2) {
        this.m_proxyCount = this.m_shape.getChildCount();
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          this.m_shape.computeAABB(proxy.aabb, xf2, i);
          proxy.proxyId = broadPhase.createProxy(proxy.aabb, proxy);
        }
      };
      Fixture2.prototype.destroyProxies = function(broadPhase) {
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          broadPhase.destroyProxy(proxy.proxyId);
          proxy.proxyId = null;
        }
        this.m_proxyCount = 0;
      };
      Fixture2.prototype.synchronize = function(broadPhase, xf1, xf2) {
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          this.m_shape.computeAABB(synchronize_aabb1, xf1, proxy.childIndex);
          this.m_shape.computeAABB(synchronize_aabb2, xf2, proxy.childIndex);
          proxy.aabb.combine(synchronize_aabb1, synchronize_aabb2);
          subVec2(displacement, xf2.p, xf1.p);
          broadPhase.moveProxy(proxy.proxyId, proxy.aabb, displacement);
        }
      };
      Fixture2.prototype.setFilterData = function(filter) {
        this.m_filterGroupIndex = filter.groupIndex;
        this.m_filterCategoryBits = filter.categoryBits;
        this.m_filterMaskBits = filter.maskBits;
        this.refilter();
      };
      Fixture2.prototype.getFilterGroupIndex = function() {
        return this.m_filterGroupIndex;
      };
      Fixture2.prototype.setFilterGroupIndex = function(groupIndex) {
        this.m_filterGroupIndex = groupIndex;
        this.refilter();
      };
      Fixture2.prototype.getFilterCategoryBits = function() {
        return this.m_filterCategoryBits;
      };
      Fixture2.prototype.setFilterCategoryBits = function(categoryBits) {
        this.m_filterCategoryBits = categoryBits;
        this.refilter();
      };
      Fixture2.prototype.getFilterMaskBits = function() {
        return this.m_filterMaskBits;
      };
      Fixture2.prototype.setFilterMaskBits = function(maskBits) {
        this.m_filterMaskBits = maskBits;
        this.refilter();
      };
      Fixture2.prototype.refilter = function() {
        if (this.m_body == null) {
          return;
        }
        var edge = this.m_body.getContactList();
        while (edge) {
          var contact = edge.contact;
          var fixtureA = contact.getFixtureA();
          var fixtureB = contact.getFixtureB();
          if (fixtureA == this || fixtureB == this) {
            contact.flagForFiltering();
          }
          edge = edge.next;
        }
        var world = this.m_body.getWorld();
        if (world == null) {
          return;
        }
        var broadPhase = world.m_broadPhase;
        for (var i = 0; i < this.m_proxyCount; ++i) {
          broadPhase.touchProxy(this.m_proxies[i].proxyId);
        }
      };
      Fixture2.prototype.shouldCollide = function(that) {
        if (that.m_filterGroupIndex === this.m_filterGroupIndex && that.m_filterGroupIndex !== 0) {
          return that.m_filterGroupIndex > 0;
        }
        var collideA = (that.m_filterMaskBits & this.m_filterCategoryBits) !== 0;
        var collideB = (that.m_filterCategoryBits & this.m_filterMaskBits) !== 0;
        var collide = collideA && collideB;
        return collide;
      };
      return Fixture2;
    }()
  );
  var STATIC = "static";
  var KINEMATIC = "kinematic";
  var DYNAMIC = "dynamic";
  var oldCenter = vec2(0, 0);
  var localCenter = vec2(0, 0);
  var shift = vec2(0, 0);
  var temp$6 = vec2(0, 0);
  var xf$2 = transform(0, 0, 0);
  var BodyDefDefault = {
    type: STATIC,
    position: Vec2.zero(),
    angle: 0,
    linearVelocity: Vec2.zero(),
    angularVelocity: 0,
    linearDamping: 0,
    angularDamping: 0,
    fixedRotation: false,
    bullet: false,
    gravityScale: 1,
    allowSleep: true,
    awake: true,
    active: true,
    userData: null
  };
  var Body = (
    /** @class */
    function() {
      function Body2(world, def) {
        this.style = {};
        this.appData = {};
        def = options(def, BodyDefDefault);
        this.m_world = world;
        this.m_awakeFlag = def.awake;
        this.m_autoSleepFlag = def.allowSleep;
        this.m_bulletFlag = def.bullet;
        this.m_fixedRotationFlag = def.fixedRotation;
        this.m_activeFlag = def.active;
        this.m_islandFlag = false;
        this.m_toiFlag = false;
        this.m_userData = def.userData;
        this.m_type = def.type;
        if (this.m_type == DYNAMIC) {
          this.m_mass = 1;
          this.m_invMass = 1;
        } else {
          this.m_mass = 0;
          this.m_invMass = 0;
        }
        this.m_I = 0;
        this.m_invI = 0;
        this.m_xf = Transform.identity();
        this.m_xf.p.setVec2(def.position);
        this.m_xf.q.setAngle(def.angle);
        this.m_sweep = new Sweep();
        this.m_sweep.setTransform(this.m_xf);
        this.c_velocity = new Velocity();
        this.c_position = new Position();
        this.m_force = Vec2.zero();
        this.m_torque = 0;
        this.m_linearVelocity = Vec2.clone(def.linearVelocity);
        this.m_angularVelocity = def.angularVelocity;
        this.m_linearDamping = def.linearDamping;
        this.m_angularDamping = def.angularDamping;
        this.m_gravityScale = def.gravityScale;
        this.m_sleepTime = 0;
        this.m_jointList = null;
        this.m_contactList = null;
        this.m_fixtureList = null;
        this.m_prev = null;
        this.m_next = null;
        this.m_destroyed = false;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Body2.prototype._serialize = function() {
        var fixtures = [];
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          fixtures.push(f);
        }
        return {
          type: this.m_type,
          bullet: this.m_bulletFlag,
          position: this.m_xf.p,
          angle: this.m_xf.q.getAngle(),
          linearVelocity: this.m_linearVelocity,
          angularVelocity: this.m_angularVelocity,
          fixtures
        };
      };
      Body2._deserialize = function(data, world, restore) {
        var body = new Body2(world, data);
        if (data.fixtures) {
          for (var i = data.fixtures.length - 1; i >= 0; i--) {
            var fixture = restore(Fixture, data.fixtures[i], body);
            body._addFixture(fixture);
          }
        }
        return body;
      };
      Body2.prototype.isWorldLocked = function() {
        return this.m_world && this.m_world.isLocked() ? true : false;
      };
      Body2.prototype.getWorld = function() {
        return this.m_world;
      };
      Body2.prototype.getNext = function() {
        return this.m_next;
      };
      Body2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Body2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Body2.prototype.getFixtureList = function() {
        return this.m_fixtureList;
      };
      Body2.prototype.getJointList = function() {
        return this.m_jointList;
      };
      Body2.prototype.getContactList = function() {
        return this.m_contactList;
      };
      Body2.prototype.isStatic = function() {
        return this.m_type == STATIC;
      };
      Body2.prototype.isDynamic = function() {
        return this.m_type == DYNAMIC;
      };
      Body2.prototype.isKinematic = function() {
        return this.m_type == KINEMATIC;
      };
      Body2.prototype.setStatic = function() {
        this.setType(STATIC);
        return this;
      };
      Body2.prototype.setDynamic = function() {
        this.setType(DYNAMIC);
        return this;
      };
      Body2.prototype.setKinematic = function() {
        this.setType(KINEMATIC);
        return this;
      };
      Body2.prototype.getType = function() {
        return this.m_type;
      };
      Body2.prototype.setType = function(type) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_type == type) {
          return;
        }
        this.m_type = type;
        this.resetMassData();
        if (this.m_type == STATIC) {
          this.m_linearVelocity.setZero();
          this.m_angularVelocity = 0;
          this.m_sweep.forward();
          this.synchronizeFixtures();
        }
        this.setAwake(true);
        this.m_force.setZero();
        this.m_torque = 0;
        var ce = this.m_contactList;
        while (ce) {
          var ce0 = ce;
          ce = ce.next;
          this.m_world.destroyContact(ce0.contact);
        }
        this.m_contactList = null;
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          for (var i = 0; i < f.m_proxyCount; ++i) {
            broadPhase.touchProxy(f.m_proxies[i].proxyId);
          }
        }
      };
      Body2.prototype.isBullet = function() {
        return this.m_bulletFlag;
      };
      Body2.prototype.setBullet = function(flag) {
        this.m_bulletFlag = !!flag;
      };
      Body2.prototype.isSleepingAllowed = function() {
        return this.m_autoSleepFlag;
      };
      Body2.prototype.setSleepingAllowed = function(flag) {
        this.m_autoSleepFlag = !!flag;
        if (this.m_autoSleepFlag == false) {
          this.setAwake(true);
        }
      };
      Body2.prototype.isAwake = function() {
        return this.m_awakeFlag;
      };
      Body2.prototype.setAwake = function(flag) {
        if (flag) {
          this.m_awakeFlag = true;
          this.m_sleepTime = 0;
        } else {
          this.m_awakeFlag = false;
          this.m_sleepTime = 0;
          this.m_linearVelocity.setZero();
          this.m_angularVelocity = 0;
          this.m_force.setZero();
          this.m_torque = 0;
        }
      };
      Body2.prototype.isActive = function() {
        return this.m_activeFlag;
      };
      Body2.prototype.setActive = function(flag) {
        if (flag == this.m_activeFlag) {
          return;
        }
        this.m_activeFlag = !!flag;
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          for (var f = this.m_fixtureList; f; f = f.m_next) {
            f.createProxies(broadPhase, this.m_xf);
          }
          this.m_world.m_newFixture = true;
        } else {
          var broadPhase = this.m_world.m_broadPhase;
          for (var f = this.m_fixtureList; f; f = f.m_next) {
            f.destroyProxies(broadPhase);
          }
          var ce = this.m_contactList;
          while (ce) {
            var ce0 = ce;
            ce = ce.next;
            this.m_world.destroyContact(ce0.contact);
          }
          this.m_contactList = null;
        }
      };
      Body2.prototype.isFixedRotation = function() {
        return this.m_fixedRotationFlag;
      };
      Body2.prototype.setFixedRotation = function(flag) {
        if (this.m_fixedRotationFlag == flag) {
          return;
        }
        this.m_fixedRotationFlag = !!flag;
        this.m_angularVelocity = 0;
        this.resetMassData();
      };
      Body2.prototype.getTransform = function() {
        return this.m_xf;
      };
      Body2.prototype.setTransform = function(a2, b2) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (typeof b2 === "number") {
          this.m_xf.setNum(a2, b2);
        } else {
          this.m_xf.setTransform(a2);
        }
        this.m_sweep.setTransform(this.m_xf);
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          f.synchronize(broadPhase, this.m_xf, this.m_xf);
        }
        this.setAwake(true);
      };
      Body2.prototype.synchronizeTransform = function() {
        this.m_sweep.getTransform(this.m_xf, 1);
      };
      Body2.prototype.synchronizeFixtures = function() {
        this.m_sweep.getTransform(xf$2, 0);
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          f.synchronize(broadPhase, xf$2, this.m_xf);
        }
      };
      Body2.prototype.advance = function(alpha) {
        this.m_sweep.advance(alpha);
        copyVec2(this.m_sweep.c, this.m_sweep.c0);
        this.m_sweep.a = this.m_sweep.a0;
        this.m_sweep.getTransform(this.m_xf, 1);
      };
      Body2.prototype.getPosition = function() {
        return this.m_xf.p;
      };
      Body2.prototype.setPosition = function(p) {
        this.setTransform(p, this.m_sweep.a);
      };
      Body2.prototype.getAngle = function() {
        return this.m_sweep.a;
      };
      Body2.prototype.setAngle = function(angle) {
        this.setTransform(this.m_xf.p, angle);
      };
      Body2.prototype.getWorldCenter = function() {
        return this.m_sweep.c;
      };
      Body2.prototype.getLocalCenter = function() {
        return this.m_sweep.localCenter;
      };
      Body2.prototype.getLinearVelocity = function() {
        return this.m_linearVelocity;
      };
      Body2.prototype.getLinearVelocityFromWorldPoint = function(worldPoint) {
        var localCenter2 = Vec2.sub(worldPoint, this.m_sweep.c);
        return Vec2.add(this.m_linearVelocity, Vec2.crossNumVec2(this.m_angularVelocity, localCenter2));
      };
      Body2.prototype.getLinearVelocityFromLocalPoint = function(localPoint) {
        return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(localPoint));
      };
      Body2.prototype.setLinearVelocity = function(v3) {
        if (this.m_type == STATIC) {
          return;
        }
        if (Vec2.dot(v3, v3) > 0) {
          this.setAwake(true);
        }
        this.m_linearVelocity.setVec2(v3);
      };
      Body2.prototype.getAngularVelocity = function() {
        return this.m_angularVelocity;
      };
      Body2.prototype.setAngularVelocity = function(w) {
        if (this.m_type == STATIC) {
          return;
        }
        if (w * w > 0) {
          this.setAwake(true);
        }
        this.m_angularVelocity = w;
      };
      Body2.prototype.getLinearDamping = function() {
        return this.m_linearDamping;
      };
      Body2.prototype.setLinearDamping = function(linearDamping) {
        this.m_linearDamping = linearDamping;
      };
      Body2.prototype.getAngularDamping = function() {
        return this.m_angularDamping;
      };
      Body2.prototype.setAngularDamping = function(angularDamping) {
        this.m_angularDamping = angularDamping;
      };
      Body2.prototype.getGravityScale = function() {
        return this.m_gravityScale;
      };
      Body2.prototype.setGravityScale = function(scale) {
        this.m_gravityScale = scale;
      };
      Body2.prototype.getMass = function() {
        return this.m_mass;
      };
      Body2.prototype.getInertia = function() {
        return this.m_I + this.m_mass * Vec2.dot(this.m_sweep.localCenter, this.m_sweep.localCenter);
      };
      Body2.prototype.getMassData = function(data) {
        data.mass = this.m_mass;
        data.I = this.getInertia();
        copyVec2(data.center, this.m_sweep.localCenter);
      };
      Body2.prototype.resetMassData = function() {
        this.m_mass = 0;
        this.m_invMass = 0;
        this.m_I = 0;
        this.m_invI = 0;
        zeroVec2(this.m_sweep.localCenter);
        if (this.isStatic() || this.isKinematic()) {
          copyVec2(this.m_sweep.c0, this.m_xf.p);
          copyVec2(this.m_sweep.c, this.m_xf.p);
          this.m_sweep.a0 = this.m_sweep.a;
          return;
        }
        zeroVec2(localCenter);
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          if (f.m_density == 0) {
            continue;
          }
          var massData = {
            mass: 0,
            center: vec2(0, 0),
            I: 0
          };
          f.getMassData(massData);
          this.m_mass += massData.mass;
          plusScaleVec2(localCenter, massData.mass, massData.center);
          this.m_I += massData.I;
        }
        if (this.m_mass > 0) {
          this.m_invMass = 1 / this.m_mass;
          scaleVec2(localCenter, this.m_invMass, localCenter);
        } else {
          this.m_mass = 1;
          this.m_invMass = 1;
        }
        if (this.m_I > 0 && this.m_fixedRotationFlag == false) {
          this.m_I -= this.m_mass * dotVec2(localCenter, localCenter);
          this.m_invI = 1 / this.m_I;
        } else {
          this.m_I = 0;
          this.m_invI = 0;
        }
        copyVec2(oldCenter, this.m_sweep.c);
        this.m_sweep.setLocalCenter(localCenter, this.m_xf);
        subVec2(shift, this.m_sweep.c, oldCenter);
        crossNumVec2(temp$6, this.m_angularVelocity, shift);
        plusVec2(this.m_linearVelocity, temp$6);
      };
      Body2.prototype.setMassData = function(massData) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        this.m_invMass = 0;
        this.m_I = 0;
        this.m_invI = 0;
        this.m_mass = massData.mass;
        if (this.m_mass <= 0) {
          this.m_mass = 1;
        }
        this.m_invMass = 1 / this.m_mass;
        if (massData.I > 0 && this.m_fixedRotationFlag == false) {
          this.m_I = massData.I - this.m_mass * dotVec2(massData.center, massData.center);
          this.m_invI = 1 / this.m_I;
        }
        copyVec2(oldCenter, this.m_sweep.c);
        this.m_sweep.setLocalCenter(massData.center, this.m_xf);
        subVec2(shift, this.m_sweep.c, oldCenter);
        crossNumVec2(temp$6, this.m_angularVelocity, shift);
        plusVec2(this.m_linearVelocity, temp$6);
      };
      Body2.prototype.applyForce = function(force, point2, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_force.add(force);
          this.m_torque += Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), force);
        }
      };
      Body2.prototype.applyForceToCenter = function(force, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_force.add(force);
        }
      };
      Body2.prototype.applyTorque = function(torque, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_torque += torque;
        }
      };
      Body2.prototype.applyLinearImpulse = function(impulse, point2, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_linearVelocity.addMul(this.m_invMass, impulse);
          this.m_angularVelocity += this.m_invI * Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), impulse);
        }
      };
      Body2.prototype.applyAngularImpulse = function(impulse, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_angularVelocity += this.m_invI * impulse;
        }
      };
      Body2.prototype.shouldCollide = function(that) {
        if (this.m_type != DYNAMIC && that.m_type != DYNAMIC) {
          return false;
        }
        for (var jn = this.m_jointList; jn; jn = jn.next) {
          if (jn.other == that) {
            if (jn.joint.m_collideConnected == false) {
              return false;
            }
          }
        }
        return true;
      };
      Body2.prototype._addFixture = function(fixture) {
        if (this.isWorldLocked() == true) {
          return null;
        }
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          fixture.createProxies(broadPhase, this.m_xf);
        }
        fixture.m_next = this.m_fixtureList;
        this.m_fixtureList = fixture;
        if (fixture.m_density > 0) {
          this.resetMassData();
        }
        this.m_world.m_newFixture = true;
        return fixture;
      };
      Body2.prototype.createFixture = function(shape, fixdef) {
        if (this.isWorldLocked() == true) {
          return null;
        }
        var fixture = new Fixture(this, shape, fixdef);
        this._addFixture(fixture);
        return fixture;
      };
      Body2.prototype.destroyFixture = function(fixture) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_fixtureList === fixture) {
          this.m_fixtureList = fixture.m_next;
        } else {
          var node = this.m_fixtureList;
          while (node != null) {
            if (node.m_next === fixture) {
              node.m_next = fixture.m_next;
              break;
            }
            node = node.m_next;
          }
        }
        var edge = this.m_contactList;
        while (edge) {
          var c2 = edge.contact;
          edge = edge.next;
          var fixtureA = c2.getFixtureA();
          var fixtureB = c2.getFixtureB();
          if (fixture == fixtureA || fixture == fixtureB) {
            this.m_world.destroyContact(c2);
          }
        }
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          fixture.destroyProxies(broadPhase);
        }
        fixture.m_body = null;
        fixture.m_next = null;
        this.m_world.publish("remove-fixture", fixture);
        this.resetMassData();
      };
      Body2.prototype.getWorldPoint = function(localPoint) {
        return Transform.mulVec2(this.m_xf, localPoint);
      };
      Body2.prototype.getWorldVector = function(localVector) {
        return Rot.mulVec2(this.m_xf.q, localVector);
      };
      Body2.prototype.getLocalPoint = function(worldPoint) {
        return Transform.mulTVec2(this.m_xf, worldPoint);
      };
      Body2.prototype.getLocalVector = function(worldVector) {
        return Rot.mulTVec2(this.m_xf.q, worldVector);
      };
      Body2.STATIC = "static";
      Body2.KINEMATIC = "kinematic";
      Body2.DYNAMIC = "dynamic";
      return Body2;
    }()
  );
  var JointEdge = (
    /** @class */
    /* @__PURE__ */ function() {
      function JointEdge2() {
        this.other = null;
        this.joint = null;
        this.prev = null;
        this.next = null;
      }
      return JointEdge2;
    }()
  );
  var Joint = (
    /** @class */
    function() {
      function Joint2(def, bodyA, bodyB) {
        this.m_type = "unknown-joint";
        this.m_prev = null;
        this.m_next = null;
        this.m_edgeA = new JointEdge();
        this.m_edgeB = new JointEdge();
        this.m_islandFlag = false;
        this.style = {};
        this.appData = {};
        bodyA = "bodyA" in def ? def.bodyA : bodyA;
        bodyB = "bodyB" in def ? def.bodyB : bodyB;
        this.m_bodyA = bodyA;
        this.m_bodyB = bodyB;
        this.m_collideConnected = !!def.collideConnected;
        this.m_userData = def.userData;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Joint2.prototype.isActive = function() {
        return this.m_bodyA.isActive() && this.m_bodyB.isActive();
      };
      Joint2.prototype.getType = function() {
        return this.m_type;
      };
      Joint2.prototype.getBodyA = function() {
        return this.m_bodyA;
      };
      Joint2.prototype.getBodyB = function() {
        return this.m_bodyB;
      };
      Joint2.prototype.getNext = function() {
        return this.m_next;
      };
      Joint2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Joint2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Joint2.prototype.getCollideConnected = function() {
        return this.m_collideConnected;
      };
      Joint2.prototype.shiftOrigin = function(newOrigin) {
      };
      Joint2.prototype._resetAnchors = function(def) {
        return this._reset(def);
      };
      return Joint2;
    }()
  );
  var stats = {
    gjkCalls: 0,
    gjkIters: 0,
    gjkMaxIters: 0,
    toiTime: 0,
    toiMaxTime: 0,
    toiCalls: 0,
    toiIters: 0,
    toiMaxIters: 0,
    toiRootIters: 0,
    toiMaxRootIters: 0,
    toString: function(newline) {
      newline = typeof newline === "string" ? newline : "\n";
      var string = "";
      for (var name_1 in this) {
        if (typeof this[name_1] !== "function" && typeof this[name_1] !== "object") {
          string += name_1 + ": " + this[name_1] + newline;
        }
      }
      return string;
    }
  };
  var now = function() {
    return Date.now();
  };
  var diff = function(time) {
    return Date.now() - time;
  };
  const Timer = {
    now,
    diff
  };
  var math_max$4 = Math.max;
  var temp$5 = vec2(0, 0);
  var normal$4 = vec2(0, 0);
  var e12 = vec2(0, 0);
  var e13 = vec2(0, 0);
  var e23 = vec2(0, 0);
  var temp1 = vec2(0, 0);
  var temp2 = vec2(0, 0);
  stats.gjkCalls = 0;
  stats.gjkIters = 0;
  stats.gjkMaxIters = 0;
  var DistanceInput = (
    /** @class */
    function() {
      function DistanceInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.transformA = Transform.identity();
        this.transformB = Transform.identity();
        this.useRadii = false;
      }
      DistanceInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.transformA.setIdentity();
        this.transformB.setIdentity();
        this.useRadii = false;
      };
      return DistanceInput2;
    }()
  );
  var DistanceOutput = (
    /** @class */
    function() {
      function DistanceOutput2() {
        this.pointA = vec2(0, 0);
        this.pointB = vec2(0, 0);
        this.distance = 0;
        this.iterations = 0;
      }
      DistanceOutput2.prototype.recycle = function() {
        zeroVec2(this.pointA);
        zeroVec2(this.pointB);
        this.distance = 0;
        this.iterations = 0;
      };
      return DistanceOutput2;
    }()
  );
  var SimplexCache = (
    /** @class */
    function() {
      function SimplexCache2() {
        this.metric = 0;
        this.indexA = [];
        this.indexB = [];
        this.count = 0;
      }
      SimplexCache2.prototype.recycle = function() {
        this.metric = 0;
        this.indexA.length = 0;
        this.indexB.length = 0;
        this.count = 0;
      };
      return SimplexCache2;
    }()
  );
  var Distance = function(output2, cache2, input2) {
    ++stats.gjkCalls;
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var xfA2 = input2.transformA;
    var xfB2 = input2.transformB;
    simplex.recycle();
    simplex.readCache(cache2, proxyA, xfA2, proxyB, xfB2);
    var vertices = simplex.m_v;
    var k_maxIters = SettingsInternal.maxDistanceIterations;
    var saveA = [];
    var saveB = [];
    var saveCount = 0;
    var iter = 0;
    while (iter < k_maxIters) {
      saveCount = simplex.m_count;
      for (var i = 0; i < saveCount; ++i) {
        saveA[i] = vertices[i].indexA;
        saveB[i] = vertices[i].indexB;
      }
      simplex.solve();
      if (simplex.m_count === 3) {
        break;
      }
      var d2 = simplex.getSearchDirection();
      if (lengthSqrVec2(d2) < EPSILON * EPSILON) {
        break;
      }
      var vertex = vertices[simplex.m_count];
      vertex.indexA = proxyA.getSupport(derotVec2(temp$5, xfA2.q, scaleVec2(temp$5, -1, d2)));
      transformVec2(vertex.wA, xfA2, proxyA.getVertex(vertex.indexA));
      vertex.indexB = proxyB.getSupport(derotVec2(temp$5, xfB2.q, d2));
      transformVec2(vertex.wB, xfB2, proxyB.getVertex(vertex.indexB));
      subVec2(vertex.w, vertex.wB, vertex.wA);
      ++iter;
      ++stats.gjkIters;
      var duplicate = false;
      for (var i = 0; i < saveCount; ++i) {
        if (vertex.indexA === saveA[i] && vertex.indexB === saveB[i]) {
          duplicate = true;
          break;
        }
      }
      if (duplicate) {
        break;
      }
      ++simplex.m_count;
    }
    stats.gjkMaxIters = math_max$4(stats.gjkMaxIters, iter);
    simplex.getWitnessPoints(output2.pointA, output2.pointB);
    output2.distance = distVec2(output2.pointA, output2.pointB);
    output2.iterations = iter;
    simplex.writeCache(cache2);
    if (input2.useRadii) {
      var rA2 = proxyA.m_radius;
      var rB2 = proxyB.m_radius;
      if (output2.distance > rA2 + rB2 && output2.distance > EPSILON) {
        output2.distance -= rA2 + rB2;
        subVec2(normal$4, output2.pointB, output2.pointA);
        normalizeVec2(normal$4);
        plusScaleVec2(output2.pointA, rA2, normal$4);
        minusScaleVec2(output2.pointB, rB2, normal$4);
      } else {
        var p = subVec2(temp$5, output2.pointA, output2.pointB);
        copyVec2(output2.pointA, p);
        copyVec2(output2.pointB, p);
        output2.distance = 0;
      }
    }
  };
  var DistanceProxy = (
    /** @class */
    function() {
      function DistanceProxy2() {
        this.m_vertices = [];
        this.m_count = 0;
        this.m_radius = 0;
      }
      DistanceProxy2.prototype.recycle = function() {
        this.m_vertices.length = 0;
        this.m_count = 0;
        this.m_radius = 0;
      };
      DistanceProxy2.prototype.getVertexCount = function() {
        return this.m_count;
      };
      DistanceProxy2.prototype.getVertex = function(index) {
        return this.m_vertices[index];
      };
      DistanceProxy2.prototype.getSupport = function(d2) {
        var bestIndex = -1;
        var bestValue = -Infinity;
        for (var i = 0; i < this.m_count; ++i) {
          var value = dotVec2(this.m_vertices[i], d2);
          if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
          }
        }
        return bestIndex;
      };
      DistanceProxy2.prototype.getSupportVertex = function(d2) {
        return this.m_vertices[this.getSupport(d2)];
      };
      DistanceProxy2.prototype.set = function(shape, index) {
        shape.computeDistanceProxy(this, index);
      };
      DistanceProxy2.prototype.setVertices = function(vertices, count, radius) {
        this.m_vertices = vertices;
        this.m_count = count;
        this.m_radius = radius;
      };
      return DistanceProxy2;
    }()
  );
  var SimplexVertex = (
    /** @class */
    function() {
      function SimplexVertex2() {
        this.wA = vec2(0, 0);
        this.indexA = 0;
        this.wB = vec2(0, 0);
        this.indexB = 0;
        this.w = vec2(0, 0);
        this.a = 0;
      }
      SimplexVertex2.prototype.recycle = function() {
        this.indexA = 0;
        this.indexB = 0;
        zeroVec2(this.wA);
        zeroVec2(this.wB);
        zeroVec2(this.w);
        this.a = 0;
      };
      SimplexVertex2.prototype.set = function(v3) {
        this.indexA = v3.indexA;
        this.indexB = v3.indexB;
        copyVec2(this.wA, v3.wA);
        copyVec2(this.wB, v3.wB);
        copyVec2(this.w, v3.w);
        this.a = v3.a;
      };
      return SimplexVertex2;
    }()
  );
  var searchDirection_reuse = vec2(0, 0);
  var closestPoint_reuse = vec2(0, 0);
  var Simplex = (
    /** @class */
    function() {
      function Simplex2() {
        this.m_v1 = new SimplexVertex();
        this.m_v2 = new SimplexVertex();
        this.m_v3 = new SimplexVertex();
        this.m_v = [this.m_v1, this.m_v2, this.m_v3];
      }
      Simplex2.prototype.recycle = function() {
        this.m_v1.recycle();
        this.m_v2.recycle();
        this.m_v3.recycle();
        this.m_count = 0;
      };
      Simplex2.prototype.toString = function() {
        if (this.m_count === 3) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y,
            this.m_v2.a,
            this.m_v2.wA.x,
            this.m_v2.wA.y,
            this.m_v2.wB.x,
            this.m_v2.wB.y,
            this.m_v3.a,
            this.m_v3.wA.x,
            this.m_v3.wA.y,
            this.m_v3.wB.x,
            this.m_v3.wB.y
          ].toString();
        } else if (this.m_count === 2) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y,
            this.m_v2.a,
            this.m_v2.wA.x,
            this.m_v2.wA.y,
            this.m_v2.wB.x,
            this.m_v2.wB.y
          ].toString();
        } else if (this.m_count === 1) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y
          ].toString();
        } else {
          return "+" + this.m_count;
        }
      };
      Simplex2.prototype.readCache = function(cache2, proxyA, transformA, proxyB, transformB) {
        this.m_count = cache2.count;
        for (var i = 0; i < this.m_count; ++i) {
          var v3 = this.m_v[i];
          v3.indexA = cache2.indexA[i];
          v3.indexB = cache2.indexB[i];
          var wALocal = proxyA.getVertex(v3.indexA);
          var wBLocal = proxyB.getVertex(v3.indexB);
          transformVec2(v3.wA, transformA, wALocal);
          transformVec2(v3.wB, transformB, wBLocal);
          subVec2(v3.w, v3.wB, v3.wA);
          v3.a = 0;
        }
        if (this.m_count > 1) {
          var metric1 = cache2.metric;
          var metric2 = this.getMetric();
          if (metric2 < 0.5 * metric1 || 2 * metric1 < metric2 || metric2 < EPSILON) {
            this.m_count = 0;
          }
        }
        if (this.m_count === 0) {
          var v3 = this.m_v[0];
          v3.indexA = 0;
          v3.indexB = 0;
          var wALocal = proxyA.getVertex(0);
          var wBLocal = proxyB.getVertex(0);
          transformVec2(v3.wA, transformA, wALocal);
          transformVec2(v3.wB, transformB, wBLocal);
          subVec2(v3.w, v3.wB, v3.wA);
          v3.a = 1;
          this.m_count = 1;
        }
      };
      Simplex2.prototype.writeCache = function(cache2) {
        cache2.metric = this.getMetric();
        cache2.count = this.m_count;
        for (var i = 0; i < this.m_count; ++i) {
          cache2.indexA[i] = this.m_v[i].indexA;
          cache2.indexB[i] = this.m_v[i].indexB;
        }
      };
      Simplex2.prototype.getSearchDirection = function() {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        switch (this.m_count) {
          case 1:
            return setVec2(searchDirection_reuse, -v13.w.x, -v13.w.y);
          case 2: {
            subVec2(e12, v22.w, v13.w);
            var sgn = -crossVec2Vec2(e12, v13.w);
            if (sgn > 0) {
              return setVec2(searchDirection_reuse, -e12.y, e12.x);
            } else {
              return setVec2(searchDirection_reuse, e12.y, -e12.x);
            }
          }
          default:
            return zeroVec2(searchDirection_reuse);
        }
      };
      Simplex2.prototype.getClosestPoint = function() {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        switch (this.m_count) {
          case 0:
            return zeroVec2(closestPoint_reuse);
          case 1:
            return copyVec2(closestPoint_reuse, v13.w);
          case 2:
            return combine2Vec2(closestPoint_reuse, v13.a, v13.w, v22.a, v22.w);
          case 3:
            return zeroVec2(closestPoint_reuse);
          default:
            return zeroVec2(closestPoint_reuse);
        }
      };
      Simplex2.prototype.getWitnessPoints = function(pA2, pB2) {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        var v3 = this.m_v3;
        switch (this.m_count) {
          case 0:
            break;
          case 1:
            copyVec2(pA2, v13.wA);
            copyVec2(pB2, v13.wB);
            break;
          case 2:
            combine2Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA);
            combine2Vec2(pB2, v13.a, v13.wB, v22.a, v22.wB);
            break;
          case 3:
            combine3Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA, v3.a, v3.wA);
            copyVec2(pB2, pA2);
            break;
        }
      };
      Simplex2.prototype.getMetric = function() {
        switch (this.m_count) {
          case 0:
            return 0;
          case 1:
            return 0;
          case 2:
            return distVec2(this.m_v1.w, this.m_v2.w);
          case 3:
            return crossVec2Vec2(subVec2(temp1, this.m_v2.w, this.m_v1.w), subVec2(temp2, this.m_v3.w, this.m_v1.w));
          default:
            return 0;
        }
      };
      Simplex2.prototype.solve = function() {
        switch (this.m_count) {
          case 1:
            break;
          case 2:
            this.solve2();
            break;
          case 3:
            this.solve3();
            break;
        }
      };
      Simplex2.prototype.solve2 = function() {
        var w1 = this.m_v1.w;
        var w2 = this.m_v2.w;
        subVec2(e12, w2, w1);
        var d12_2 = -dotVec2(w1, e12);
        if (d12_2 <= 0) {
          this.m_v1.a = 1;
          this.m_count = 1;
          return;
        }
        var d12_1 = dotVec2(w2, e12);
        if (d12_1 <= 0) {
          this.m_v2.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v2);
          return;
        }
        var inv_d12 = 1 / (d12_1 + d12_2);
        this.m_v1.a = d12_1 * inv_d12;
        this.m_v2.a = d12_2 * inv_d12;
        this.m_count = 2;
      };
      Simplex2.prototype.solve3 = function() {
        var w1 = this.m_v1.w;
        var w2 = this.m_v2.w;
        var w3 = this.m_v3.w;
        subVec2(e12, w2, w1);
        var w1e12 = dotVec2(w1, e12);
        var w2e12 = dotVec2(w2, e12);
        var d12_1 = w2e12;
        var d12_2 = -w1e12;
        subVec2(e13, w3, w1);
        var w1e13 = dotVec2(w1, e13);
        var w3e13 = dotVec2(w3, e13);
        var d13_1 = w3e13;
        var d13_2 = -w1e13;
        subVec2(e23, w3, w2);
        var w2e23 = dotVec2(w2, e23);
        var w3e23 = dotVec2(w3, e23);
        var d23_1 = w3e23;
        var d23_2 = -w2e23;
        var n123 = crossVec2Vec2(e12, e13);
        var d123_1 = n123 * crossVec2Vec2(w2, w3);
        var d123_2 = n123 * crossVec2Vec2(w3, w1);
        var d123_3 = n123 * crossVec2Vec2(w1, w2);
        if (d12_2 <= 0 && d13_2 <= 0) {
          this.m_v1.a = 1;
          this.m_count = 1;
          return;
        }
        if (d12_1 > 0 && d12_2 > 0 && d123_3 <= 0) {
          var inv_d12 = 1 / (d12_1 + d12_2);
          this.m_v1.a = d12_1 * inv_d12;
          this.m_v2.a = d12_2 * inv_d12;
          this.m_count = 2;
          return;
        }
        if (d13_1 > 0 && d13_2 > 0 && d123_2 <= 0) {
          var inv_d13 = 1 / (d13_1 + d13_2);
          this.m_v1.a = d13_1 * inv_d13;
          this.m_v3.a = d13_2 * inv_d13;
          this.m_count = 2;
          this.m_v2.set(this.m_v3);
          return;
        }
        if (d12_1 <= 0 && d23_2 <= 0) {
          this.m_v2.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v2);
          return;
        }
        if (d13_1 <= 0 && d23_1 <= 0) {
          this.m_v3.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v3);
          return;
        }
        if (d23_1 > 0 && d23_2 > 0 && d123_1 <= 0) {
          var inv_d23 = 1 / (d23_1 + d23_2);
          this.m_v2.a = d23_1 * inv_d23;
          this.m_v3.a = d23_2 * inv_d23;
          this.m_count = 2;
          this.m_v1.set(this.m_v3);
          return;
        }
        var inv_d123 = 1 / (d123_1 + d123_2 + d123_3);
        this.m_v1.a = d123_1 * inv_d123;
        this.m_v2.a = d123_2 * inv_d123;
        this.m_v3.a = d123_3 * inv_d123;
        this.m_count = 3;
      };
      return Simplex2;
    }()
  );
  var simplex = new Simplex();
  var input$1 = new DistanceInput();
  var cache$1 = new SimplexCache();
  var output$1 = new DistanceOutput();
  var testOverlap = function(shapeA, indexA, shapeB, indexB, xfA2, xfB2) {
    input$1.recycle();
    input$1.proxyA.set(shapeA, indexA);
    input$1.proxyB.set(shapeB, indexB);
    copyTransform(input$1.transformA, xfA2);
    copyTransform(input$1.transformB, xfB2);
    input$1.useRadii = true;
    output$1.recycle();
    cache$1.recycle();
    Distance(output$1, cache$1, input$1);
    return output$1.distance < 10 * EPSILON;
  };
  Distance.testOverlap = testOverlap;
  Distance.Input = DistanceInput;
  Distance.Output = DistanceOutput;
  Distance.Proxy = DistanceProxy;
  Distance.Cache = SimplexCache;
  var ShapeCastInput = (
    /** @class */
    function() {
      function ShapeCastInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.transformA = Transform.identity();
        this.transformB = Transform.identity();
        this.translationB = Vec2.zero();
      }
      ShapeCastInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.transformA.setIdentity();
        this.transformB.setIdentity();
        zeroVec2(this.translationB);
      };
      return ShapeCastInput2;
    }()
  );
  var ShapeCastOutput = (
    /** @class */
    /* @__PURE__ */ function() {
      function ShapeCastOutput2() {
        this.point = Vec2.zero();
        this.normal = Vec2.zero();
        this.lambda = 1;
        this.iterations = 0;
      }
      return ShapeCastOutput2;
    }()
  );
  var ShapeCast = function(output2, input2) {
    output2.iterations = 0;
    output2.lambda = 1;
    output2.normal.setZero();
    output2.point.setZero();
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var radiusA = math_max$4(proxyA.m_radius, SettingsInternal.polygonRadius);
    var radiusB = math_max$4(proxyB.m_radius, SettingsInternal.polygonRadius);
    var radius = radiusA + radiusB;
    var xfA2 = input2.transformA;
    var xfB2 = input2.transformB;
    var r = input2.translationB;
    var n2 = Vec2.zero();
    var lambda = 0;
    var simplex2 = new Simplex();
    simplex2.m_count = 0;
    var vertices = simplex2.m_v;
    var indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(r)));
    var wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));
    var indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, r));
    var wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));
    var v3 = Vec2.sub(wA, wB);
    var sigma = math_max$4(SettingsInternal.polygonRadius, radius - SettingsInternal.polygonRadius);
    var tolerance = 0.5 * SettingsInternal.linearSlop;
    var k_maxIters = 20;
    var iter = 0;
    while (iter < k_maxIters && v3.length() - sigma > tolerance) {
      output2.iterations += 1;
      indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(v3)));
      wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));
      indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, v3));
      wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));
      var p = Vec2.sub(wA, wB);
      v3.normalize();
      var vp = Vec2.dot(v3, p);
      var vr = Vec2.dot(v3, r);
      if (vp - sigma > lambda * vr) {
        if (vr <= 0) {
          return false;
        }
        lambda = (vp - sigma) / vr;
        if (lambda > 1) {
          return false;
        }
        n2.setMul(-1, v3);
        simplex2.m_count = 0;
      }
      var vertex = vertices[simplex2.m_count];
      vertex.indexA = indexB;
      vertex.wA = Vec2.combine(1, wB, lambda, r);
      vertex.indexB = indexA;
      vertex.wB = wA;
      vertex.w = Vec2.sub(vertex.wB, vertex.wA);
      vertex.a = 1;
      simplex2.m_count += 1;
      switch (simplex2.m_count) {
        case 1:
          break;
        case 2:
          simplex2.solve2();
          break;
        case 3:
          simplex2.solve3();
          break;
      }
      if (simplex2.m_count == 3) {
        return false;
      }
      v3.setVec2(simplex2.getClosestPoint());
      ++iter;
    }
    if (iter == 0) {
      return false;
    }
    var pointA2 = Vec2.zero();
    var pointB2 = Vec2.zero();
    simplex2.getWitnessPoints(pointB2, pointA2);
    if (v3.lengthSquared() > 0) {
      n2.setMul(-1, v3);
      n2.normalize();
    }
    output2.point = Vec2.combine(1, pointA2, radiusA, n2);
    output2.normal = n2;
    output2.lambda = lambda;
    output2.iterations = iter;
    return true;
  };
  var math_abs$7 = Math.abs;
  var math_max$3 = Math.max;
  var TOIInput = (
    /** @class */
    function() {
      function TOIInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.sweepA = new Sweep();
        this.sweepB = new Sweep();
      }
      TOIInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.sweepA.recycle();
        this.sweepB.recycle();
        this.tMax = -1;
      };
      return TOIInput2;
    }()
  );
  exports2.TOIOutputState = void 0;
  (function(TOIOutputState2) {
    TOIOutputState2[TOIOutputState2["e_unset"] = -1] = "e_unset";
    TOIOutputState2[TOIOutputState2["e_unknown"] = 0] = "e_unknown";
    TOIOutputState2[TOIOutputState2["e_failed"] = 1] = "e_failed";
    TOIOutputState2[TOIOutputState2["e_overlapped"] = 2] = "e_overlapped";
    TOIOutputState2[TOIOutputState2["e_touching"] = 3] = "e_touching";
    TOIOutputState2[TOIOutputState2["e_separated"] = 4] = "e_separated";
  })(exports2.TOIOutputState || (exports2.TOIOutputState = {}));
  var TOIOutput = (
    /** @class */
    function() {
      function TOIOutput2() {
        this.state = exports2.TOIOutputState.e_unset;
        this.t = -1;
      }
      TOIOutput2.prototype.recycle = function() {
        this.state = exports2.TOIOutputState.e_unset;
        this.t = -1;
      };
      return TOIOutput2;
    }()
  );
  stats.toiTime = 0;
  stats.toiMaxTime = 0;
  stats.toiCalls = 0;
  stats.toiIters = 0;
  stats.toiMaxIters = 0;
  stats.toiRootIters = 0;
  stats.toiMaxRootIters = 0;
  var distanceInput = new DistanceInput();
  var distanceOutput = new DistanceOutput();
  var cache = new SimplexCache();
  var xfA$1 = transform(0, 0, 0);
  var xfB$1 = transform(0, 0, 0);
  var temp$4 = vec2(0, 0);
  var pointA$2 = vec2(0, 0);
  var pointB$2 = vec2(0, 0);
  var normal$3 = vec2(0, 0);
  var axisA = vec2(0, 0);
  var axisB = vec2(0, 0);
  var localPointA = vec2(0, 0);
  var localPointB = vec2(0, 0);
  var TimeOfImpact = function(output2, input2) {
    var timer = Timer.now();
    ++stats.toiCalls;
    output2.state = exports2.TOIOutputState.e_unknown;
    output2.t = input2.tMax;
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var sweepA = input2.sweepA;
    var sweepB = input2.sweepB;
    sweepA.normalize();
    sweepB.normalize();
    var tMax = input2.tMax;
    var totalRadius = proxyA.m_radius + proxyB.m_radius;
    var target = math_max$3(SettingsInternal.linearSlop, totalRadius - 3 * SettingsInternal.linearSlop);
    var tolerance = 0.25 * SettingsInternal.linearSlop;
    var t1 = 0;
    var k_maxIterations = SettingsInternal.maxTOIIterations;
    var iter = 0;
    cache.recycle();
    distanceInput.proxyA.setVertices(proxyA.m_vertices, proxyA.m_count, proxyA.m_radius);
    distanceInput.proxyB.setVertices(proxyB.m_vertices, proxyB.m_count, proxyB.m_radius);
    distanceInput.useRadii = false;
    while (true) {
      sweepA.getTransform(xfA$1, t1);
      sweepB.getTransform(xfB$1, t1);
      copyTransform(distanceInput.transformA, xfA$1);
      copyTransform(distanceInput.transformB, xfB$1);
      Distance(distanceOutput, cache, distanceInput);
      if (distanceOutput.distance <= 0) {
        output2.state = exports2.TOIOutputState.e_overlapped;
        output2.t = 0;
        break;
      }
      if (distanceOutput.distance < target + tolerance) {
        output2.state = exports2.TOIOutputState.e_touching;
        output2.t = t1;
        break;
      }
      separationFunction.initialize(cache, proxyA, sweepA, proxyB, sweepB, t1);
      var done = false;
      var t2 = tMax;
      var pushBackIter = 0;
      while (true) {
        var s2 = separationFunction.findMinSeparation(t2);
        if (s2 > target + tolerance) {
          output2.state = exports2.TOIOutputState.e_separated;
          output2.t = tMax;
          done = true;
          break;
        }
        if (s2 > target - tolerance) {
          t1 = t2;
          break;
        }
        var s1 = separationFunction.evaluate(t1);
        if (s1 < target - tolerance) {
          output2.state = exports2.TOIOutputState.e_failed;
          output2.t = t1;
          done = true;
          break;
        }
        if (s1 <= target + tolerance) {
          output2.state = exports2.TOIOutputState.e_touching;
          output2.t = t1;
          done = true;
          break;
        }
        var rootIterCount = 0;
        var a1 = t1;
        var a2 = t2;
        while (true) {
          var t = void 0;
          if (rootIterCount & 1) {
            t = a1 + (target - s1) * (a2 - a1) / (s2 - s1);
          } else {
            t = 0.5 * (a1 + a2);
          }
          ++rootIterCount;
          ++stats.toiRootIters;
          var s3 = separationFunction.evaluate(t);
          if (math_abs$7(s3 - target) < tolerance) {
            t2 = t;
            break;
          }
          if (s3 > target) {
            a1 = t;
            s1 = s3;
          } else {
            a2 = t;
            s2 = s3;
          }
          if (rootIterCount === 50) {
            break;
          }
        }
        stats.toiMaxRootIters = math_max$3(stats.toiMaxRootIters, rootIterCount);
        ++pushBackIter;
        if (pushBackIter === SettingsInternal.maxPolygonVertices) {
          break;
        }
      }
      ++iter;
      ++stats.toiIters;
      if (done) {
        break;
      }
      if (iter === k_maxIterations) {
        output2.state = exports2.TOIOutputState.e_failed;
        output2.t = t1;
        break;
      }
    }
    stats.toiMaxIters = math_max$3(stats.toiMaxIters, iter);
    var time = Timer.diff(timer);
    stats.toiMaxTime = math_max$3(stats.toiMaxTime, time);
    stats.toiTime += time;
    separationFunction.recycle();
  };
  var SeparationFunctionType;
  (function(SeparationFunctionType2) {
    SeparationFunctionType2[SeparationFunctionType2["e_unset"] = -1] = "e_unset";
    SeparationFunctionType2[SeparationFunctionType2["e_points"] = 1] = "e_points";
    SeparationFunctionType2[SeparationFunctionType2["e_faceA"] = 2] = "e_faceA";
    SeparationFunctionType2[SeparationFunctionType2["e_faceB"] = 3] = "e_faceB";
  })(SeparationFunctionType || (SeparationFunctionType = {}));
  var SeparationFunction = (
    /** @class */
    function() {
      function SeparationFunction2() {
        this.m_proxyA = null;
        this.m_proxyB = null;
        this.m_sweepA = null;
        this.m_sweepB = null;
        this.m_type = SeparationFunctionType.e_unset;
        this.m_localPoint = vec2(0, 0);
        this.m_axis = vec2(0, 0);
        this.indexA = -1;
        this.indexB = -1;
      }
      SeparationFunction2.prototype.recycle = function() {
        this.m_proxyA = null;
        this.m_proxyB = null;
        this.m_sweepA = null;
        this.m_sweepB = null;
        this.m_type = SeparationFunctionType.e_unset;
        zeroVec2(this.m_localPoint);
        zeroVec2(this.m_axis);
        this.indexA = -1;
        this.indexB = -1;
      };
      SeparationFunction2.prototype.initialize = function(cache2, proxyA, sweepA, proxyB, sweepB, t1) {
        var count = cache2.count;
        this.m_proxyA = proxyA;
        this.m_proxyB = proxyB;
        this.m_sweepA = sweepA;
        this.m_sweepB = sweepB;
        this.m_sweepA.getTransform(xfA$1, t1);
        this.m_sweepB.getTransform(xfB$1, t1);
        if (count === 1) {
          this.m_type = SeparationFunctionType.e_points;
          var localPointA_1 = this.m_proxyA.getVertex(cache2.indexA[0]);
          var localPointB_1 = this.m_proxyB.getVertex(cache2.indexB[0]);
          transformVec2(pointA$2, xfA$1, localPointA_1);
          transformVec2(pointB$2, xfB$1, localPointB_1);
          subVec2(this.m_axis, pointB$2, pointA$2);
          var s2 = normalizeVec2Length(this.m_axis);
          return s2;
        } else if (cache2.indexA[0] === cache2.indexA[1]) {
          this.m_type = SeparationFunctionType.e_faceB;
          var localPointB1 = proxyB.getVertex(cache2.indexB[0]);
          var localPointB2 = proxyB.getVertex(cache2.indexB[1]);
          crossVec2Num(this.m_axis, subVec2(temp$4, localPointB2, localPointB1), 1);
          normalizeVec2(this.m_axis);
          rotVec2(normal$3, xfB$1.q, this.m_axis);
          combine2Vec2(this.m_localPoint, 0.5, localPointB1, 0.5, localPointB2);
          transformVec2(pointB$2, xfB$1, this.m_localPoint);
          var localPointA_2 = proxyA.getVertex(cache2.indexA[0]);
          var pointA_1 = Transform.mulVec2(xfA$1, localPointA_2);
          var s2 = dotVec2(pointA_1, normal$3) - dotVec2(pointB$2, normal$3);
          if (s2 < 0) {
            negVec2(this.m_axis);
            s2 = -s2;
          }
          return s2;
        } else {
          this.m_type = SeparationFunctionType.e_faceA;
          var localPointA1 = this.m_proxyA.getVertex(cache2.indexA[0]);
          var localPointA2 = this.m_proxyA.getVertex(cache2.indexA[1]);
          crossVec2Num(this.m_axis, subVec2(temp$4, localPointA2, localPointA1), 1);
          normalizeVec2(this.m_axis);
          rotVec2(normal$3, xfA$1.q, this.m_axis);
          combine2Vec2(this.m_localPoint, 0.5, localPointA1, 0.5, localPointA2);
          transformVec2(pointA$2, xfA$1, this.m_localPoint);
          var localPointB_2 = this.m_proxyB.getVertex(cache2.indexB[0]);
          transformVec2(pointB$2, xfB$1, localPointB_2);
          var s2 = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);
          if (s2 < 0) {
            negVec2(this.m_axis);
            s2 = -s2;
          }
          return s2;
        }
      };
      SeparationFunction2.prototype.compute = function(find, t) {
        this.m_sweepA.getTransform(xfA$1, t);
        this.m_sweepB.getTransform(xfB$1, t);
        switch (this.m_type) {
          case SeparationFunctionType.e_points: {
            if (find) {
              derotVec2(axisA, xfA$1.q, this.m_axis);
              derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, this.m_axis));
              this.indexA = this.m_proxyA.getSupport(axisA);
              this.indexB = this.m_proxyB.getSupport(axisB);
            }
            copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));
            copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));
            transformVec2(pointA$2, xfA$1, localPointA);
            transformVec2(pointB$2, xfB$1, localPointB);
            var sep = dotVec2(pointB$2, this.m_axis) - dotVec2(pointA$2, this.m_axis);
            return sep;
          }
          case SeparationFunctionType.e_faceA: {
            rotVec2(normal$3, xfA$1.q, this.m_axis);
            transformVec2(pointA$2, xfA$1, this.m_localPoint);
            if (find) {
              derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, normal$3));
              this.indexA = -1;
              this.indexB = this.m_proxyB.getSupport(axisB);
            }
            copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));
            transformVec2(pointB$2, xfB$1, localPointB);
            var sep = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);
            return sep;
          }
          case SeparationFunctionType.e_faceB: {
            rotVec2(normal$3, xfB$1.q, this.m_axis);
            transformVec2(pointB$2, xfB$1, this.m_localPoint);
            if (find) {
              derotVec2(axisA, xfA$1.q, scaleVec2(temp$4, -1, normal$3));
              this.indexB = -1;
              this.indexA = this.m_proxyA.getSupport(axisA);
            }
            copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));
            transformVec2(pointA$2, xfA$1, localPointA);
            var sep = dotVec2(pointA$2, normal$3) - dotVec2(pointB$2, normal$3);
            return sep;
          }
          default:
            if (find) {
              this.indexA = -1;
              this.indexB = -1;
            }
            return 0;
        }
      };
      SeparationFunction2.prototype.findMinSeparation = function(t) {
        return this.compute(true, t);
      };
      SeparationFunction2.prototype.evaluate = function(t) {
        return this.compute(false, t);
      };
      return SeparationFunction2;
    }()
  );
  var separationFunction = new SeparationFunction();
  TimeOfImpact.Input = TOIInput;
  TimeOfImpact.Output = TOIOutput;
  var math_abs$6 = Math.abs;
  var math_sqrt$3 = Math.sqrt;
  var math_min$5 = Math.min;
  var TimeStep = (
    /** @class */
    function() {
      function TimeStep2() {
        this.dt = 0;
        this.inv_dt = 0;
        this.velocityIterations = 0;
        this.positionIterations = 0;
        this.warmStarting = false;
        this.blockSolve = true;
        this.inv_dt0 = 0;
        this.dtRatio = 1;
      }
      TimeStep2.prototype.reset = function(dt) {
        if (this.dt > 0) {
          this.inv_dt0 = this.inv_dt;
        }
        this.dt = dt;
        this.inv_dt = dt == 0 ? 0 : 1 / dt;
        this.dtRatio = dt * this.inv_dt0;
      };
      return TimeStep2;
    }()
  );
  var s_subStep = new TimeStep();
  var c = vec2(0, 0);
  var v = vec2(0, 0);
  var translation = vec2(0, 0);
  var input = new TOIInput();
  var output = new TOIOutput();
  var backup = new Sweep();
  var backup1 = new Sweep();
  var backup2 = new Sweep();
  var ContactImpulse = (
    /** @class */
    function() {
      function ContactImpulse2(contact) {
        this.contact = contact;
        this.normals = [];
        this.tangents = [];
      }
      ContactImpulse2.prototype.recycle = function() {
        this.normals.length = 0;
        this.tangents.length = 0;
      };
      Object.defineProperty(ContactImpulse2.prototype, "normalImpulses", {
        get: function() {
          var contact = this.contact;
          var normals = this.normals;
          normals.length = 0;
          for (var p = 0; p < contact.v_points.length; ++p) {
            normals.push(contact.v_points[p].normalImpulse);
          }
          return normals;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(ContactImpulse2.prototype, "tangentImpulses", {
        get: function() {
          var contact = this.contact;
          var tangents = this.tangents;
          tangents.length = 0;
          for (var p = 0; p < contact.v_points.length; ++p) {
            tangents.push(contact.v_points[p].tangentImpulse);
          }
          return tangents;
        },
        enumerable: false,
        configurable: true
      });
      return ContactImpulse2;
    }()
  );
  var Solver = (
    /** @class */
    function() {
      function Solver2(world) {
        this.m_world = world;
        this.m_stack = [];
        this.m_bodies = [];
        this.m_contacts = [];
        this.m_joints = [];
      }
      Solver2.prototype.clear = function() {
        this.m_stack.length = 0;
        this.m_bodies.length = 0;
        this.m_contacts.length = 0;
        this.m_joints.length = 0;
      };
      Solver2.prototype.addBody = function(body) {
        this.m_bodies.push(body);
      };
      Solver2.prototype.addContact = function(contact) {
        this.m_contacts.push(contact);
      };
      Solver2.prototype.addJoint = function(joint) {
        this.m_joints.push(joint);
      };
      Solver2.prototype.solveWorld = function(step) {
        var world = this.m_world;
        for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {
          b2.m_islandFlag = false;
        }
        for (var c_1 = world.m_contactList; c_1; c_1 = c_1.m_next) {
          c_1.m_islandFlag = false;
        }
        for (var j = world.m_jointList; j; j = j.m_next) {
          j.m_islandFlag = false;
        }
        var stack = this.m_stack;
        for (var seed = world.m_bodyList; seed; seed = seed.m_next) {
          if (seed.m_islandFlag) {
            continue;
          }
          if (seed.isAwake() == false || seed.isActive() == false) {
            continue;
          }
          if (seed.isStatic()) {
            continue;
          }
          this.clear();
          stack.push(seed);
          seed.m_islandFlag = true;
          while (stack.length > 0) {
            var b2 = stack.pop();
            this.addBody(b2);
            b2.m_awakeFlag = true;
            if (b2.isStatic()) {
              continue;
            }
            for (var ce = b2.m_contactList; ce; ce = ce.next) {
              var contact = ce.contact;
              if (contact.m_islandFlag) {
                continue;
              }
              if (contact.isEnabled() == false || contact.isTouching() == false) {
                continue;
              }
              var sensorA = contact.m_fixtureA.m_isSensor;
              var sensorB = contact.m_fixtureB.m_isSensor;
              if (sensorA || sensorB) {
                continue;
              }
              this.addContact(contact);
              contact.m_islandFlag = true;
              var other = ce.other;
              if (other.m_islandFlag) {
                continue;
              }
              stack.push(other);
              other.m_islandFlag = true;
            }
            for (var je = b2.m_jointList; je; je = je.next) {
              if (je.joint.m_islandFlag == true) {
                continue;
              }
              var other = je.other;
              if (other.isActive() == false) {
                continue;
              }
              this.addJoint(je.joint);
              je.joint.m_islandFlag = true;
              if (other.m_islandFlag) {
                continue;
              }
              stack.push(other);
              other.m_islandFlag = true;
            }
          }
          this.solveIsland(step);
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var b2 = this.m_bodies[i];
            if (b2.isStatic()) {
              b2.m_islandFlag = false;
            }
          }
        }
      };
      Solver2.prototype.solveIsland = function(step) {
        var world = this.m_world;
        var gravity = world.m_gravity;
        var allowSleep = world.m_allowSleep;
        var h = step.dt;
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.m_sweep.c);
          var a2 = body.m_sweep.a;
          copyVec2(v, body.m_linearVelocity);
          var w = body.m_angularVelocity;
          copyVec2(body.m_sweep.c0, body.m_sweep.c);
          body.m_sweep.a0 = body.m_sweep.a;
          if (body.isDynamic()) {
            plusScaleVec2(v, h * body.m_gravityScale, gravity);
            plusScaleVec2(v, h * body.m_invMass, body.m_force);
            w += h * body.m_invI * body.m_torque;
            scaleVec2(v, 1 / (1 + h * body.m_linearDamping), v);
            w *= 1 / (1 + h * body.m_angularDamping);
          }
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initConstraint(step);
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initVelocityConstraint(step);
        }
        if (step.warmStarting) {
          for (var i = 0; i < this.m_contacts.length; ++i) {
            var contact = this.m_contacts[i];
            contact.warmStartConstraint(step);
          }
        }
        for (var i = 0; i < this.m_joints.length; ++i) {
          var joint = this.m_joints[i];
          joint.initVelocityConstraints(step);
        }
        for (var i = 0; i < step.velocityIterations; ++i) {
          for (var j = 0; j < this.m_joints.length; ++j) {
            var joint = this.m_joints[j];
            joint.solveVelocityConstraints(step);
          }
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            contact.solveVelocityConstraint(step);
          }
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.storeConstraintImpulses(step);
        }
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.c_position.c);
          var a2 = body.c_position.a;
          copyVec2(v, body.c_velocity.v);
          var w = body.c_velocity.w;
          scaleVec2(translation, h, v);
          var translationLengthSqr = lengthSqrVec2(translation);
          if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {
            var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);
            mulVec2(v, ratio);
          }
          var rotation2 = h * w;
          if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {
            var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);
            w *= ratio;
          }
          plusScaleVec2(c, h, v);
          a2 += h * w;
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
        }
        var positionSolved = false;
        for (var i = 0; i < step.positionIterations; ++i) {
          var minSeparation = 0;
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            var separation = contact.solvePositionConstraint(step);
            minSeparation = math_min$5(minSeparation, separation);
          }
          var contactsOkay = minSeparation >= -3 * SettingsInternal.linearSlop;
          var jointsOkay = true;
          for (var j = 0; j < this.m_joints.length; ++j) {
            var joint = this.m_joints[j];
            var jointOkay = joint.solvePositionConstraints(step);
            jointsOkay = jointsOkay && jointOkay;
          }
          if (contactsOkay && jointsOkay) {
            positionSolved = true;
            break;
          }
        }
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(body.m_sweep.c, body.c_position.c);
          body.m_sweep.a = body.c_position.a;
          copyVec2(body.m_linearVelocity, body.c_velocity.v);
          body.m_angularVelocity = body.c_velocity.w;
          body.synchronizeTransform();
        }
        this.postSolveIsland();
        if (allowSleep) {
          var minSleepTime = Infinity;
          var linTolSqr = SettingsInternal.linearSleepToleranceSqr;
          var angTolSqr = SettingsInternal.angularSleepToleranceSqr;
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var body = this.m_bodies[i];
            if (body.isStatic()) {
              continue;
            }
            if (body.m_autoSleepFlag == false || body.m_angularVelocity * body.m_angularVelocity > angTolSqr || lengthSqrVec2(body.m_linearVelocity) > linTolSqr) {
              body.m_sleepTime = 0;
              minSleepTime = 0;
            } else {
              body.m_sleepTime += h;
              minSleepTime = math_min$5(minSleepTime, body.m_sleepTime);
            }
          }
          if (minSleepTime >= SettingsInternal.timeToSleep && positionSolved) {
            for (var i = 0; i < this.m_bodies.length; ++i) {
              var body = this.m_bodies[i];
              body.setAwake(false);
            }
          }
        }
      };
      Solver2.prototype.solveWorldTOI = function(step) {
        var world = this.m_world;
        if (world.m_stepComplete) {
          for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {
            b2.m_islandFlag = false;
            b2.m_sweep.alpha0 = 0;
          }
          for (var c_2 = world.m_contactList; c_2; c_2 = c_2.m_next) {
            c_2.m_toiFlag = false;
            c_2.m_islandFlag = false;
            c_2.m_toiCount = 0;
            c_2.m_toi = 1;
          }
        }
        while (true) {
          var minContact = null;
          var minAlpha = 1;
          for (var c_3 = world.m_contactList; c_3; c_3 = c_3.m_next) {
            if (c_3.isEnabled() == false) {
              continue;
            }
            if (c_3.m_toiCount > SettingsInternal.maxSubSteps) {
              continue;
            }
            var alpha = 1;
            if (c_3.m_toiFlag) {
              alpha = c_3.m_toi;
            } else {
              var fA_1 = c_3.getFixtureA();
              var fB_1 = c_3.getFixtureB();
              if (fA_1.isSensor() || fB_1.isSensor()) {
                continue;
              }
              var bA_1 = fA_1.getBody();
              var bB_1 = fB_1.getBody();
              var activeA = bA_1.isAwake() && !bA_1.isStatic();
              var activeB = bB_1.isAwake() && !bB_1.isStatic();
              if (activeA == false && activeB == false) {
                continue;
              }
              var collideA = bA_1.isBullet() || !bA_1.isDynamic();
              var collideB = bB_1.isBullet() || !bB_1.isDynamic();
              if (collideA == false && collideB == false) {
                continue;
              }
              var alpha0 = bA_1.m_sweep.alpha0;
              if (bA_1.m_sweep.alpha0 < bB_1.m_sweep.alpha0) {
                alpha0 = bB_1.m_sweep.alpha0;
                bA_1.m_sweep.advance(alpha0);
              } else if (bB_1.m_sweep.alpha0 < bA_1.m_sweep.alpha0) {
                alpha0 = bA_1.m_sweep.alpha0;
                bB_1.m_sweep.advance(alpha0);
              }
              var indexA = c_3.getChildIndexA();
              var indexB = c_3.getChildIndexB();
              input.proxyA.set(fA_1.getShape(), indexA);
              input.proxyB.set(fB_1.getShape(), indexB);
              input.sweepA.set(bA_1.m_sweep);
              input.sweepB.set(bB_1.m_sweep);
              input.tMax = 1;
              TimeOfImpact(output, input);
              var beta = output.t;
              if (output.state == exports2.TOIOutputState.e_touching) {
                alpha = math_min$5(alpha0 + (1 - alpha0) * beta, 1);
              } else {
                alpha = 1;
              }
              c_3.m_toi = alpha;
              c_3.m_toiFlag = true;
            }
            if (alpha < minAlpha) {
              minContact = c_3;
              minAlpha = alpha;
            }
          }
          if (minContact == null || 1 - 10 * EPSILON < minAlpha) {
            world.m_stepComplete = true;
            break;
          }
          var fA = minContact.getFixtureA();
          var fB = minContact.getFixtureB();
          var bA = fA.getBody();
          var bB = fB.getBody();
          backup1.set(bA.m_sweep);
          backup2.set(bB.m_sweep);
          bA.advance(minAlpha);
          bB.advance(minAlpha);
          minContact.update(world);
          minContact.m_toiFlag = false;
          ++minContact.m_toiCount;
          if (minContact.isEnabled() == false || minContact.isTouching() == false) {
            minContact.setEnabled(false);
            bA.m_sweep.set(backup1);
            bB.m_sweep.set(backup2);
            bA.synchronizeTransform();
            bB.synchronizeTransform();
            continue;
          }
          bA.setAwake(true);
          bB.setAwake(true);
          this.clear();
          this.addBody(bA);
          this.addBody(bB);
          this.addContact(minContact);
          bA.m_islandFlag = true;
          bB.m_islandFlag = true;
          minContact.m_islandFlag = true;
          var bodies = [bA, bB];
          for (var i = 0; i < bodies.length; ++i) {
            var body = bodies[i];
            if (body.isDynamic()) {
              for (var ce = body.m_contactList; ce; ce = ce.next) {
                var contact = ce.contact;
                if (contact.m_islandFlag) {
                  continue;
                }
                var other = ce.other;
                if (other.isDynamic() && !body.isBullet() && !other.isBullet()) {
                  continue;
                }
                var sensorA = contact.m_fixtureA.m_isSensor;
                var sensorB = contact.m_fixtureB.m_isSensor;
                if (sensorA || sensorB) {
                  continue;
                }
                backup.set(other.m_sweep);
                if (other.m_islandFlag == false) {
                  other.advance(minAlpha);
                }
                contact.update(world);
                if (contact.isEnabled() == false || contact.isTouching() == false) {
                  other.m_sweep.set(backup);
                  other.synchronizeTransform();
                  continue;
                }
                contact.m_islandFlag = true;
                this.addContact(contact);
                if (other.m_islandFlag) {
                  continue;
                }
                other.m_islandFlag = true;
                if (!other.isStatic()) {
                  other.setAwake(true);
                }
                this.addBody(other);
              }
            }
          }
          s_subStep.reset((1 - minAlpha) * step.dt);
          s_subStep.dtRatio = 1;
          s_subStep.positionIterations = 20;
          s_subStep.velocityIterations = step.velocityIterations;
          s_subStep.warmStarting = false;
          this.solveIslandTOI(s_subStep, bA, bB);
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var body = this.m_bodies[i];
            body.m_islandFlag = false;
            if (!body.isDynamic()) {
              continue;
            }
            body.synchronizeFixtures();
            for (var ce = body.m_contactList; ce; ce = ce.next) {
              ce.contact.m_toiFlag = false;
              ce.contact.m_islandFlag = false;
            }
          }
          world.findNewContacts();
          if (world.m_subStepping) {
            world.m_stepComplete = false;
            break;
          }
        }
      };
      Solver2.prototype.solveIslandTOI = function(subStep, toiA, toiB) {
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(body.c_position.c, body.m_sweep.c);
          body.c_position.a = body.m_sweep.a;
          copyVec2(body.c_velocity.v, body.m_linearVelocity);
          body.c_velocity.w = body.m_angularVelocity;
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initConstraint(subStep);
        }
        for (var i = 0; i < subStep.positionIterations; ++i) {
          var minSeparation = 0;
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            var separation = contact.solvePositionConstraintTOI(subStep, toiA, toiB);
            minSeparation = math_min$5(minSeparation, separation);
          }
          var contactsOkay = minSeparation >= -1.5 * SettingsInternal.linearSlop;
          if (contactsOkay) {
            break;
          }
        }
        var i;
        copyVec2(toiA.m_sweep.c0, toiA.c_position.c);
        toiA.m_sweep.a0 = toiA.c_position.a;
        copyVec2(toiB.m_sweep.c0, toiB.c_position.c);
        toiB.m_sweep.a0 = toiB.c_position.a;
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initVelocityConstraint(subStep);
        }
        for (var i = 0; i < subStep.velocityIterations; ++i) {
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            contact.solveVelocityConstraint(subStep);
          }
        }
        var h = subStep.dt;
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.c_position.c);
          var a2 = body.c_position.a;
          copyVec2(v, body.c_velocity.v);
          var w = body.c_velocity.w;
          scaleVec2(translation, h, v);
          var translationLengthSqr = lengthSqrVec2(translation);
          if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {
            var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);
            mulVec2(v, ratio);
          }
          var rotation2 = h * w;
          if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {
            var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);
            w *= ratio;
          }
          plusScaleVec2(c, h, v);
          a2 += h * w;
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
          copyVec2(body.m_sweep.c, c);
          body.m_sweep.a = a2;
          copyVec2(body.m_linearVelocity, v);
          body.m_angularVelocity = w;
          body.synchronizeTransform();
        }
        this.postSolveIsland();
      };
      Solver2.prototype.postSolveIsland = function() {
        for (var c_5 = 0; c_5 < this.m_contacts.length; ++c_5) {
          var contact = this.m_contacts[c_5];
          this.m_world.postSolve(contact, contact.m_impulse);
        }
      };
      return Solver2;
    }()
  );
  Solver.TimeStep = TimeStep;
  var Mat22 = (
    /** @class */
    function() {
      function Mat222(a2, b2, c2, d2) {
        if (typeof a2 === "object" && a2 !== null) {
          this.ex = Vec2.clone(a2);
          this.ey = Vec2.clone(b2);
        } else if (typeof a2 === "number") {
          this.ex = Vec2.neo(a2, c2);
          this.ey = Vec2.neo(b2, d2);
        } else {
          this.ex = Vec2.zero();
          this.ey = Vec2.zero();
        }
      }
      Mat222.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Mat222.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.ex) && Vec2.isValid(obj.ey);
      };
      Mat222.assert = function(o) {
      };
      Mat222.prototype.set = function(a2, b2, c2, d2) {
        if (typeof a2 === "number" && typeof b2 === "number" && typeof c2 === "number" && typeof d2 === "number") {
          this.ex.setNum(a2, c2);
          this.ey.setNum(b2, d2);
        } else if (typeof a2 === "object" && typeof b2 === "object") {
          this.ex.setVec2(a2);
          this.ey.setVec2(b2);
        } else if (typeof a2 === "object") {
          this.ex.setVec2(a2.ex);
          this.ey.setVec2(a2.ey);
        } else ;
      };
      Mat222.prototype.setIdentity = function() {
        this.ex.x = 1;
        this.ey.x = 0;
        this.ex.y = 0;
        this.ey.y = 1;
      };
      Mat222.prototype.setZero = function() {
        this.ex.x = 0;
        this.ey.x = 0;
        this.ex.y = 0;
        this.ey.y = 0;
      };
      Mat222.prototype.getInverse = function() {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        var imx = new Mat222();
        imx.ex.x = det * d2;
        imx.ey.x = -det * b2;
        imx.ex.y = -det * c2;
        imx.ey.y = det * a2;
        return imx;
      };
      Mat222.prototype.solve = function(v3) {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        var w = Vec2.zero();
        w.x = det * (d2 * v3.x - b2 * v3.y);
        w.y = det * (a2 * v3.y - c2 * v3.x);
        return w;
      };
      Mat222.mul = function(mx, v3) {
        if (v3 && "x" in v3 && "y" in v3) {
          var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;
          var y = mx.ex.y * v3.x + mx.ey.y * v3.y;
          return Vec2.neo(x2, y);
        } else if (v3 && "ex" in v3 && "ey" in v3) {
          var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;
          var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;
          var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;
          var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;
          return new Mat222(a2, b2, c2, d2);
        }
      };
      Mat222.mulVec2 = function(mx, v3) {
        var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;
        var y = mx.ex.y * v3.x + mx.ey.y * v3.y;
        return Vec2.neo(x2, y);
      };
      Mat222.mulMat22 = function(mx, v3) {
        var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;
        var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;
        var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;
        var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;
        return new Mat222(a2, b2, c2, d2);
      };
      Mat222.mulT = function(mx, v3) {
        if (v3 && "x" in v3 && "y" in v3) {
          return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));
        } else if (v3 && "ex" in v3 && "ey" in v3) {
          var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));
          var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));
          return new Mat222(c1, c2);
        }
      };
      Mat222.mulTVec2 = function(mx, v3) {
        return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));
      };
      Mat222.mulTMat22 = function(mx, v3) {
        var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));
        var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));
        return new Mat222(c1, c2);
      };
      Mat222.abs = function(mx) {
        return new Mat222(Vec2.abs(mx.ex), Vec2.abs(mx.ey));
      };
      Mat222.add = function(mx1, mx2) {
        return new Mat222(Vec2.add(mx1.ex, mx2.ex), Vec2.add(mx1.ey, mx2.ey));
      };
      return Mat222;
    }()
  );
  var math_sqrt$2 = Math.sqrt;
  var pointA$1 = vec2(0, 0);
  var pointB$1 = vec2(0, 0);
  var temp$3 = vec2(0, 0);
  var cA$1 = vec2(0, 0);
  var cB$1 = vec2(0, 0);
  var dist = vec2(0, 0);
  var planePoint$2 = vec2(0, 0);
  var clipPoint$1 = vec2(0, 0);
  exports2.ManifoldType = void 0;
  (function(ManifoldType2) {
    ManifoldType2[ManifoldType2["e_unset"] = -1] = "e_unset";
    ManifoldType2[ManifoldType2["e_circles"] = 0] = "e_circles";
    ManifoldType2[ManifoldType2["e_faceA"] = 1] = "e_faceA";
    ManifoldType2[ManifoldType2["e_faceB"] = 2] = "e_faceB";
  })(exports2.ManifoldType || (exports2.ManifoldType = {}));
  exports2.ContactFeatureType = void 0;
  (function(ContactFeatureType2) {
    ContactFeatureType2[ContactFeatureType2["e_unset"] = -1] = "e_unset";
    ContactFeatureType2[ContactFeatureType2["e_vertex"] = 0] = "e_vertex";
    ContactFeatureType2[ContactFeatureType2["e_face"] = 1] = "e_face";
  })(exports2.ContactFeatureType || (exports2.ContactFeatureType = {}));
  exports2.PointState = void 0;
  (function(PointState2) {
    PointState2[PointState2["nullState"] = 0] = "nullState";
    PointState2[PointState2["addState"] = 1] = "addState";
    PointState2[PointState2["persistState"] = 2] = "persistState";
    PointState2[PointState2["removeState"] = 3] = "removeState";
  })(exports2.PointState || (exports2.PointState = {}));
  var ClipVertex = (
    /** @class */
    function() {
      function ClipVertex2() {
        this.v = vec2(0, 0);
        this.id = new ContactID();
      }
      ClipVertex2.prototype.set = function(o) {
        copyVec2(this.v, o.v);
        this.id.set(o.id);
      };
      ClipVertex2.prototype.recycle = function() {
        zeroVec2(this.v);
        this.id.recycle();
      };
      return ClipVertex2;
    }()
  );
  var Manifold = (
    /** @class */
    function() {
      function Manifold2() {
        this.localNormal = vec2(0, 0);
        this.localPoint = vec2(0, 0);
        this.points = [new ManifoldPoint(), new ManifoldPoint()];
        this.pointCount = 0;
      }
      Manifold2.prototype.set = function(that) {
        this.type = that.type;
        copyVec2(this.localNormal, that.localNormal);
        copyVec2(this.localPoint, that.localPoint);
        this.pointCount = that.pointCount;
        this.points[0].set(that.points[0]);
        this.points[1].set(that.points[1]);
      };
      Manifold2.prototype.recycle = function() {
        this.type = exports2.ManifoldType.e_unset;
        zeroVec2(this.localNormal);
        zeroVec2(this.localPoint);
        this.pointCount = 0;
        this.points[0].recycle();
        this.points[1].recycle();
      };
      Manifold2.prototype.getWorldManifold = function(wm, xfA2, radiusA, xfB2, radiusB) {
        if (this.pointCount == 0) {
          return wm;
        }
        wm = wm || new WorldManifold();
        wm.pointCount = this.pointCount;
        var normal3 = wm.normal;
        var points = wm.points;
        var separations = wm.separations;
        switch (this.type) {
          case exports2.ManifoldType.e_circles: {
            setVec2(normal3, 1, 0);
            var manifoldPoint = this.points[0];
            transformVec2(pointA$1, xfA2, this.localPoint);
            transformVec2(pointB$1, xfB2, manifoldPoint.localPoint);
            subVec2(dist, pointB$1, pointA$1);
            var lengthSqr = lengthSqrVec2(dist);
            if (lengthSqr > EPSILON * EPSILON) {
              var length_1 = math_sqrt$2(lengthSqr);
              scaleVec2(normal3, 1 / length_1, dist);
            }
            combine2Vec2(cA$1, 1, pointA$1, radiusA, normal3);
            combine2Vec2(cB$1, 1, pointB$1, -radiusB, normal3);
            combine2Vec2(points[0], 0.5, cA$1, 0.5, cB$1);
            separations[0] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);
            break;
          }
          case exports2.ManifoldType.e_faceA: {
            rotVec2(normal3, xfA2.q, this.localNormal);
            transformVec2(planePoint$2, xfA2, this.localPoint);
            for (var i = 0; i < this.pointCount; ++i) {
              var manifoldPoint = this.points[i];
              transformVec2(clipPoint$1, xfB2, manifoldPoint.localPoint);
              combine2Vec2(cA$1, 1, clipPoint$1, radiusA - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);
              combine2Vec2(cB$1, 1, clipPoint$1, -radiusB, normal3);
              combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);
              separations[i] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);
            }
            break;
          }
          case exports2.ManifoldType.e_faceB: {
            rotVec2(normal3, xfB2.q, this.localNormal);
            transformVec2(planePoint$2, xfB2, this.localPoint);
            for (var i = 0; i < this.pointCount; ++i) {
              var manifoldPoint = this.points[i];
              transformVec2(clipPoint$1, xfA2, manifoldPoint.localPoint);
              combine2Vec2(cB$1, 1, clipPoint$1, radiusB - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);
              combine2Vec2(cA$1, 1, clipPoint$1, -radiusA, normal3);
              combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);
              separations[i] = dotVec2(subVec2(temp$3, cA$1, cB$1), normal3);
            }
            negVec2(normal3);
            break;
          }
        }
        return wm;
      };
      Manifold2.clipSegmentToLine = clipSegmentToLine;
      Manifold2.ClipVertex = ClipVertex;
      Manifold2.getPointStates = getPointStates;
      Manifold2.PointState = exports2.PointState;
      return Manifold2;
    }()
  );
  var ManifoldPoint = (
    /** @class */
    function() {
      function ManifoldPoint2() {
        this.localPoint = vec2(0, 0);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.id = new ContactID();
      }
      ManifoldPoint2.prototype.set = function(that) {
        copyVec2(this.localPoint, that.localPoint);
        this.normalImpulse = that.normalImpulse;
        this.tangentImpulse = that.tangentImpulse;
        this.id.set(that.id);
      };
      ManifoldPoint2.prototype.recycle = function() {
        zeroVec2(this.localPoint);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.id.recycle();
      };
      return ManifoldPoint2;
    }()
  );
  var ContactID = (
    /** @class */
    function() {
      function ContactID2() {
        this.key = -1;
        this.indexA = -1;
        this.indexB = -1;
        this.typeA = exports2.ContactFeatureType.e_unset;
        this.typeB = exports2.ContactFeatureType.e_unset;
      }
      ContactID2.prototype.setFeatures = function(indexA, typeA, indexB, typeB) {
        this.indexA = indexA;
        this.indexB = indexB;
        this.typeA = typeA;
        this.typeB = typeB;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.set = function(that) {
        this.indexA = that.indexA;
        this.indexB = that.indexB;
        this.typeA = that.typeA;
        this.typeB = that.typeB;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.swapFeatures = function() {
        var indexA = this.indexA;
        var indexB = this.indexB;
        var typeA = this.typeA;
        var typeB = this.typeB;
        this.indexA = indexB;
        this.indexB = indexA;
        this.typeA = typeB;
        this.typeB = typeA;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.recycle = function() {
        this.indexA = 0;
        this.indexB = 0;
        this.typeA = exports2.ContactFeatureType.e_unset;
        this.typeB = exports2.ContactFeatureType.e_unset;
        this.key = -1;
      };
      return ContactID2;
    }()
  );
  var WorldManifold = (
    /** @class */
    function() {
      function WorldManifold2() {
        this.normal = vec2(0, 0);
        this.points = [vec2(0, 0), vec2(0, 0)];
        this.separations = [0, 0];
        this.pointCount = 0;
      }
      WorldManifold2.prototype.recycle = function() {
        zeroVec2(this.normal);
        zeroVec2(this.points[0]);
        zeroVec2(this.points[1]);
        this.separations[0] = 0;
        this.separations[1] = 0;
        this.pointCount = 0;
      };
      return WorldManifold2;
    }()
  );
  function getPointStates(state1, state2, manifold1, manifold2) {
    for (var i = 0; i < manifold1.pointCount; ++i) {
      var id = manifold1.points[i].id;
      state1[i] = exports2.PointState.removeState;
      for (var j = 0; j < manifold2.pointCount; ++j) {
        if (manifold2.points[j].id.key === id.key) {
          state1[i] = exports2.PointState.persistState;
          break;
        }
      }
    }
    for (var i = 0; i < manifold2.pointCount; ++i) {
      var id = manifold2.points[i].id;
      state2[i] = exports2.PointState.addState;
      for (var j = 0; j < manifold1.pointCount; ++j) {
        if (manifold1.points[j].id.key === id.key) {
          state2[i] = exports2.PointState.persistState;
          break;
        }
      }
    }
  }
  function clipSegmentToLine(vOut, vIn, normal3, offset, vertexIndexA) {
    var numOut = 0;
    var distance0 = dotVec2(normal3, vIn[0].v) - offset;
    var distance1 = dotVec2(normal3, vIn[1].v) - offset;
    if (distance0 <= 0)
      vOut[numOut++].set(vIn[0]);
    if (distance1 <= 0)
      vOut[numOut++].set(vIn[1]);
    if (distance0 * distance1 < 0) {
      var interp = distance0 / (distance0 - distance1);
      combine2Vec2(vOut[numOut].v, 1 - interp, vIn[0].v, interp, vIn[1].v);
      vOut[numOut].id.setFeatures(vertexIndexA, exports2.ContactFeatureType.e_vertex, vIn[0].id.indexB, exports2.ContactFeatureType.e_face);
      ++numOut;
    }
    return numOut;
  }
  var math_sqrt$1 = Math.sqrt;
  var math_max$2 = Math.max;
  var math_min$4 = Math.min;
  var contactPool = new Pool({
    create: function() {
      return new Contact();
    },
    release: function(contact) {
      contact.recycle();
    }
  });
  var oldManifold = new Manifold();
  var worldManifold = new WorldManifold();
  var ContactEdge = (
    /** @class */
    function() {
      function ContactEdge2(contact) {
        this.prev = null;
        this.next = null;
        this.other = null;
        this.contact = contact;
      }
      ContactEdge2.prototype.recycle = function() {
        this.prev = null;
        this.next = null;
        this.other = null;
      };
      return ContactEdge2;
    }()
  );
  function mixFriction(friction1, friction2) {
    return math_sqrt$1(friction1 * friction2);
  }
  function mixRestitution(restitution1, restitution2) {
    return restitution1 > restitution2 ? restitution1 : restitution2;
  }
  var s_registers = [];
  var VelocityConstraintPoint = (
    /** @class */
    function() {
      function VelocityConstraintPoint2() {
        this.rA = vec2(0, 0);
        this.rB = vec2(0, 0);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.normalMass = 0;
        this.tangentMass = 0;
        this.velocityBias = 0;
      }
      VelocityConstraintPoint2.prototype.recycle = function() {
        zeroVec2(this.rA);
        zeroVec2(this.rB);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.normalMass = 0;
        this.tangentMass = 0;
        this.velocityBias = 0;
      };
      return VelocityConstraintPoint2;
    }()
  );
  var cA = vec2(0, 0);
  var vA = vec2(0, 0);
  var cB = vec2(0, 0);
  var vB = vec2(0, 0);
  var tangent$1 = vec2(0, 0);
  var xfA = transform(0, 0, 0);
  var xfB = transform(0, 0, 0);
  var pointA = vec2(0, 0);
  var pointB = vec2(0, 0);
  var clipPoint = vec2(0, 0);
  var planePoint$1 = vec2(0, 0);
  var rA = vec2(0, 0);
  var rB = vec2(0, 0);
  var P$1 = vec2(0, 0);
  var normal$2 = vec2(0, 0);
  var point = vec2(0, 0);
  var dv = vec2(0, 0);
  var dv1 = vec2(0, 0);
  var dv2 = vec2(0, 0);
  var b = vec2(0, 0);
  var a = vec2(0, 0);
  var x = vec2(0, 0);
  var d = vec2(0, 0);
  var P1 = vec2(0, 0);
  var P2 = vec2(0, 0);
  var temp$2 = vec2(0, 0);
  var Contact = (
    /** @class */
    function() {
      function Contact2() {
        this.m_nodeA = new ContactEdge(this);
        this.m_nodeB = new ContactEdge(this);
        this.m_fixtureA = null;
        this.m_fixtureB = null;
        this.m_indexA = -1;
        this.m_indexB = -1;
        this.m_evaluateFcn = null;
        this.m_manifold = new Manifold();
        this.m_prev = null;
        this.m_next = null;
        this.m_toi = 1;
        this.m_toiCount = 0;
        this.m_toiFlag = false;
        this.m_friction = 0;
        this.m_restitution = 0;
        this.m_tangentSpeed = 0;
        this.m_enabledFlag = true;
        this.m_islandFlag = false;
        this.m_touchingFlag = false;
        this.m_filterFlag = false;
        this.m_bulletHitFlag = false;
        this.m_impulse = new ContactImpulse(this);
        this.v_points = [new VelocityConstraintPoint(), new VelocityConstraintPoint()];
        this.v_normal = vec2(0, 0);
        this.v_normalMass = new Mat22();
        this.v_K = new Mat22();
        this.v_pointCount = 0;
        this.v_tangentSpeed = 0;
        this.v_friction = 0;
        this.v_restitution = 0;
        this.v_invMassA = 0;
        this.v_invMassB = 0;
        this.v_invIA = 0;
        this.v_invIB = 0;
        this.p_localPoints = [vec2(0, 0), vec2(0, 0)];
        this.p_localNormal = vec2(0, 0);
        this.p_localPoint = vec2(0, 0);
        this.p_localCenterA = vec2(0, 0);
        this.p_localCenterB = vec2(0, 0);
        this.p_type = exports2.ManifoldType.e_unset;
        this.p_radiusA = 0;
        this.p_radiusB = 0;
        this.p_pointCount = 0;
        this.p_invMassA = 0;
        this.p_invMassB = 0;
        this.p_invIA = 0;
        this.p_invIB = 0;
      }
      Contact2.prototype.initialize = function(fA, indexA, fB, indexB, evaluateFcn) {
        this.m_fixtureA = fA;
        this.m_fixtureB = fB;
        this.m_indexA = indexA;
        this.m_indexB = indexB;
        this.m_evaluateFcn = evaluateFcn;
        this.m_friction = mixFriction(this.m_fixtureA.m_friction, this.m_fixtureB.m_friction);
        this.m_restitution = mixRestitution(this.m_fixtureA.m_restitution, this.m_fixtureB.m_restitution);
      };
      Contact2.prototype.recycle = function() {
        this.m_nodeA.recycle();
        this.m_nodeB.recycle();
        this.m_fixtureA = null;
        this.m_fixtureB = null;
        this.m_indexA = -1;
        this.m_indexB = -1;
        this.m_evaluateFcn = null;
        this.m_manifold.recycle();
        this.m_prev = null;
        this.m_next = null;
        this.m_toi = 1;
        this.m_toiCount = 0;
        this.m_toiFlag = false;
        this.m_friction = 0;
        this.m_restitution = 0;
        this.m_tangentSpeed = 0;
        this.m_enabledFlag = true;
        this.m_islandFlag = false;
        this.m_touchingFlag = false;
        this.m_filterFlag = false;
        this.m_bulletHitFlag = false;
        this.m_impulse.recycle();
        for (var _i = 0, _a2 = this.v_points; _i < _a2.length; _i++) {
          var point_1 = _a2[_i];
          point_1.recycle();
        }
        zeroVec2(this.v_normal);
        this.v_normalMass.setZero();
        this.v_K.setZero();
        this.v_pointCount = 0;
        this.v_tangentSpeed = 0;
        this.v_friction = 0;
        this.v_restitution = 0;
        this.v_invMassA = 0;
        this.v_invMassB = 0;
        this.v_invIA = 0;
        this.v_invIB = 0;
        for (var _b = 0, _c = this.p_localPoints; _b < _c.length; _b++) {
          var point_2 = _c[_b];
          zeroVec2(point_2);
        }
        zeroVec2(this.p_localNormal);
        zeroVec2(this.p_localPoint);
        zeroVec2(this.p_localCenterA);
        zeroVec2(this.p_localCenterB);
        this.p_type = exports2.ManifoldType.e_unset;
        this.p_radiusA = 0;
        this.p_radiusB = 0;
        this.p_pointCount = 0;
        this.p_invMassA = 0;
        this.p_invMassB = 0;
        this.p_invIA = 0;
        this.p_invIB = 0;
      };
      Contact2.prototype.initConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        var manifold = this.m_manifold;
        var pointCount = manifold.pointCount;
        this.v_invMassA = bodyA.m_invMass;
        this.v_invMassB = bodyB.m_invMass;
        this.v_invIA = bodyA.m_invI;
        this.v_invIB = bodyB.m_invI;
        this.v_friction = this.m_friction;
        this.v_restitution = this.m_restitution;
        this.v_tangentSpeed = this.m_tangentSpeed;
        this.v_pointCount = pointCount;
        this.v_K.setZero();
        this.v_normalMass.setZero();
        this.p_invMassA = bodyA.m_invMass;
        this.p_invMassB = bodyB.m_invMass;
        this.p_invIA = bodyA.m_invI;
        this.p_invIB = bodyB.m_invI;
        copyVec2(this.p_localCenterA, bodyA.m_sweep.localCenter);
        copyVec2(this.p_localCenterB, bodyB.m_sweep.localCenter);
        this.p_radiusA = shapeA.m_radius;
        this.p_radiusB = shapeB.m_radius;
        this.p_type = manifold.type;
        copyVec2(this.p_localNormal, manifold.localNormal);
        copyVec2(this.p_localPoint, manifold.localPoint);
        this.p_pointCount = pointCount;
        for (var j = 0; j < SettingsInternal.maxManifoldPoints; ++j) {
          this.v_points[j].recycle();
          zeroVec2(this.p_localPoints[j]);
        }
        for (var j = 0; j < pointCount; ++j) {
          var cp = manifold.points[j];
          var vcp = this.v_points[j];
          if (step.warmStarting) {
            vcp.normalImpulse = step.dtRatio * cp.normalImpulse;
            vcp.tangentImpulse = step.dtRatio * cp.tangentImpulse;
          }
          copyVec2(this.p_localPoints[j], cp.localPoint);
        }
      };
      Contact2.prototype.getManifold = function() {
        return this.m_manifold;
      };
      Contact2.prototype.getWorldManifold = function(worldManifold2) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        return this.m_manifold.getWorldManifold(worldManifold2, bodyA.getTransform(), shapeA.m_radius, bodyB.getTransform(), shapeB.m_radius);
      };
      Contact2.prototype.setEnabled = function(flag) {
        this.m_enabledFlag = !!flag;
      };
      Contact2.prototype.isEnabled = function() {
        return this.m_enabledFlag;
      };
      Contact2.prototype.isTouching = function() {
        return this.m_touchingFlag;
      };
      Contact2.prototype.getNext = function() {
        return this.m_next;
      };
      Contact2.prototype.getFixtureA = function() {
        return this.m_fixtureA;
      };
      Contact2.prototype.getFixtureB = function() {
        return this.m_fixtureB;
      };
      Contact2.prototype.getChildIndexA = function() {
        return this.m_indexA;
      };
      Contact2.prototype.getChildIndexB = function() {
        return this.m_indexB;
      };
      Contact2.prototype.flagForFiltering = function() {
        this.m_filterFlag = true;
      };
      Contact2.prototype.setFriction = function(friction) {
        this.m_friction = friction;
      };
      Contact2.prototype.getFriction = function() {
        return this.m_friction;
      };
      Contact2.prototype.resetFriction = function() {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_friction = mixFriction(fixtureA.m_friction, fixtureB.m_friction);
      };
      Contact2.prototype.setRestitution = function(restitution) {
        this.m_restitution = restitution;
      };
      Contact2.prototype.getRestitution = function() {
        return this.m_restitution;
      };
      Contact2.prototype.resetRestitution = function() {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_restitution = mixRestitution(fixtureA.m_restitution, fixtureB.m_restitution);
      };
      Contact2.prototype.setTangentSpeed = function(speed) {
        this.m_tangentSpeed = speed;
      };
      Contact2.prototype.getTangentSpeed = function() {
        return this.m_tangentSpeed;
      };
      Contact2.prototype.evaluate = function(manifold, xfA2, xfB2) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_evaluateFcn(manifold, xfA2, fixtureA, this.m_indexA, xfB2, fixtureB, this.m_indexB);
      };
      Contact2.prototype.update = function(listener) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        this.m_enabledFlag = true;
        var touching = false;
        var wasTouching = this.m_touchingFlag;
        var sensorA = fixtureA.m_isSensor;
        var sensorB = fixtureB.m_isSensor;
        var sensor = sensorA || sensorB;
        var xfA2 = bodyA.m_xf;
        var xfB2 = bodyB.m_xf;
        if (sensor) {
          touching = testOverlap(shapeA, this.m_indexA, shapeB, this.m_indexB, xfA2, xfB2);
          this.m_manifold.pointCount = 0;
        } else {
          oldManifold.recycle();
          oldManifold.set(this.m_manifold);
          this.m_manifold.recycle();
          this.evaluate(this.m_manifold, xfA2, xfB2);
          touching = this.m_manifold.pointCount > 0;
          for (var i = 0; i < this.m_manifold.pointCount; ++i) {
            var nmp = this.m_manifold.points[i];
            nmp.normalImpulse = 0;
            nmp.tangentImpulse = 0;
            for (var j = 0; j < oldManifold.pointCount; ++j) {
              var omp = oldManifold.points[j];
              if (omp.id.key === nmp.id.key) {
                nmp.normalImpulse = omp.normalImpulse;
                nmp.tangentImpulse = omp.tangentImpulse;
                break;
              }
            }
          }
          if (touching !== wasTouching) {
            bodyA.setAwake(true);
            bodyB.setAwake(true);
          }
        }
        this.m_touchingFlag = touching;
        var hasListener = typeof listener === "object" && listener !== null;
        if (!wasTouching && touching && hasListener) {
          listener.beginContact(this);
        }
        if (wasTouching && !touching && hasListener) {
          listener.endContact(this);
        }
        if (!sensor && touching && hasListener && oldManifold) {
          listener.preSolve(this, oldManifold);
        }
      };
      Contact2.prototype.solvePositionConstraint = function(step) {
        return this._solvePositionConstraint(step, null, null);
      };
      Contact2.prototype.solvePositionConstraintTOI = function(step, toiA, toiB) {
        return this._solvePositionConstraint(step, toiA, toiB);
      };
      Contact2.prototype._solvePositionConstraint = function(step, toiA, toiB) {
        var toi = toiA !== null && toiB !== null ? true : false;
        var minSeparation = 0;
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return minSeparation;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return minSeparation;
        var positionA = bodyA.c_position;
        var positionB = bodyB.c_position;
        var localCenterA = this.p_localCenterA;
        var localCenterB = this.p_localCenterB;
        var mA = 0;
        var iA = 0;
        if (!toi || bodyA === toiA || bodyA === toiB) {
          mA = this.p_invMassA;
          iA = this.p_invIA;
        }
        var mB = 0;
        var iB = 0;
        if (!toi || bodyB === toiA || bodyB === toiB) {
          mB = this.p_invMassB;
          iB = this.p_invIB;
        }
        copyVec2(cA, positionA.c);
        var aA = positionA.a;
        copyVec2(cB, positionB.c);
        var aB = positionB.a;
        for (var j = 0; j < this.p_pointCount; ++j) {
          getTransform(xfA, localCenterA, cA, aA);
          getTransform(xfB, localCenterB, cB, aB);
          var separation = void 0;
          switch (this.p_type) {
            case exports2.ManifoldType.e_circles: {
              transformVec2(pointA, xfA, this.p_localPoint);
              transformVec2(pointB, xfB, this.p_localPoints[0]);
              subVec2(normal$2, pointB, pointA);
              normalizeVec2(normal$2);
              combine2Vec2(point, 0.5, pointA, 0.5, pointB);
              separation = dotVec2(pointB, normal$2) - dotVec2(pointA, normal$2) - this.p_radiusA - this.p_radiusB;
              break;
            }
            case exports2.ManifoldType.e_faceA: {
              rotVec2(normal$2, xfA.q, this.p_localNormal);
              transformVec2(planePoint$1, xfA, this.p_localPoint);
              transformVec2(clipPoint, xfB, this.p_localPoints[j]);
              separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;
              copyVec2(point, clipPoint);
              break;
            }
            case exports2.ManifoldType.e_faceB: {
              rotVec2(normal$2, xfB.q, this.p_localNormal);
              transformVec2(planePoint$1, xfB, this.p_localPoint);
              transformVec2(clipPoint, xfA, this.p_localPoints[j]);
              separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;
              copyVec2(point, clipPoint);
              negVec2(normal$2);
              break;
            }
            default: {
              return minSeparation;
            }
          }
          subVec2(rA, point, cA);
          subVec2(rB, point, cB);
          minSeparation = math_min$4(minSeparation, separation);
          var baumgarte = toi ? SettingsInternal.toiBaugarte : SettingsInternal.baumgarte;
          var linearSlop = SettingsInternal.linearSlop;
          var maxLinearCorrection = SettingsInternal.maxLinearCorrection;
          var C = clamp(baumgarte * (separation + linearSlop), -maxLinearCorrection, 0);
          var rnA = crossVec2Vec2(rA, normal$2);
          var rnB = crossVec2Vec2(rB, normal$2);
          var K = mA + mB + iA * rnA * rnA + iB * rnB * rnB;
          var impulse = K > 0 ? -C / K : 0;
          scaleVec2(P$1, impulse, normal$2);
          minusScaleVec2(cA, mA, P$1);
          aA -= iA * crossVec2Vec2(rA, P$1);
          plusScaleVec2(cB, mB, P$1);
          aB += iB * crossVec2Vec2(rB, P$1);
        }
        copyVec2(positionA.c, cA);
        positionA.a = aA;
        copyVec2(positionB.c, cB);
        positionB.a = aB;
        return minSeparation;
      };
      Contact2.prototype.initVelocityConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var positionA = bodyA.c_position;
        var positionB = bodyB.c_position;
        var radiusA = this.p_radiusA;
        var radiusB = this.p_radiusB;
        var manifold = this.m_manifold;
        var mA = this.v_invMassA;
        var mB = this.v_invMassB;
        var iA = this.v_invIA;
        var iB = this.v_invIB;
        var localCenterA = this.p_localCenterA;
        var localCenterB = this.p_localCenterB;
        copyVec2(cA, positionA.c);
        var aA = positionA.a;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(cB, positionB.c);
        var aB = positionB.a;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        getTransform(xfA, localCenterA, cA, aA);
        getTransform(xfB, localCenterB, cB, aB);
        worldManifold.recycle();
        manifold.getWorldManifold(worldManifold, xfA, radiusA, xfB, radiusB);
        copyVec2(this.v_normal, worldManifold.normal);
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          var wmp = worldManifold.points[j];
          subVec2(vcp.rA, wmp, cA);
          subVec2(vcp.rB, wmp, cB);
          var rnA = crossVec2Vec2(vcp.rA, this.v_normal);
          var rnB = crossVec2Vec2(vcp.rB, this.v_normal);
          var kNormal = mA + mB + iA * rnA * rnA + iB * rnB * rnB;
          vcp.normalMass = kNormal > 0 ? 1 / kNormal : 0;
          crossVec2Num(tangent$1, this.v_normal, 1);
          var rtA = crossVec2Vec2(vcp.rA, tangent$1);
          var rtB = crossVec2Vec2(vcp.rB, tangent$1);
          var kTangent = mA + mB + iA * rtA * rtA + iB * rtB * rtB;
          vcp.tangentMass = kTangent > 0 ? 1 / kTangent : 0;
          vcp.velocityBias = 0;
          var vRel = 0;
          vRel += dotVec2(this.v_normal, vB);
          vRel += dotVec2(this.v_normal, crossNumVec2(temp$2, wB, vcp.rB));
          vRel -= dotVec2(this.v_normal, vA);
          vRel -= dotVec2(this.v_normal, crossNumVec2(temp$2, wA, vcp.rA));
          if (vRel < -SettingsInternal.velocityThreshold) {
            vcp.velocityBias = -this.v_restitution * vRel;
          }
        }
        if (this.v_pointCount == 2 && step.blockSolve) {
          var vcp1 = this.v_points[0];
          var vcp2 = this.v_points[1];
          var rn1A = crossVec2Vec2(vcp1.rA, this.v_normal);
          var rn1B = crossVec2Vec2(vcp1.rB, this.v_normal);
          var rn2A = crossVec2Vec2(vcp2.rA, this.v_normal);
          var rn2B = crossVec2Vec2(vcp2.rB, this.v_normal);
          var k11 = mA + mB + iA * rn1A * rn1A + iB * rn1B * rn1B;
          var k22 = mA + mB + iA * rn2A * rn2A + iB * rn2B * rn2B;
          var k12 = mA + mB + iA * rn1A * rn2A + iB * rn1B * rn2B;
          var k_maxConditionNumber = 1e3;
          if (k11 * k11 < k_maxConditionNumber * (k11 * k22 - k12 * k12)) {
            this.v_K.ex.setNum(k11, k12);
            this.v_K.ey.setNum(k12, k22);
            var a_1 = this.v_K.ex.x;
            var b_1 = this.v_K.ey.x;
            var c2 = this.v_K.ex.y;
            var d_1 = this.v_K.ey.y;
            var det = a_1 * d_1 - b_1 * c2;
            if (det !== 0) {
              det = 1 / det;
            }
            this.v_normalMass.ex.x = det * d_1;
            this.v_normalMass.ey.x = -det * b_1;
            this.v_normalMass.ex.y = -det * c2;
            this.v_normalMass.ey.y = det * a_1;
          } else {
            this.v_pointCount = 1;
          }
        }
        copyVec2(positionA.c, cA);
        positionA.a = aA;
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(positionB.c, cB);
        positionB.a = aB;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.prototype.warmStartConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var mA = this.v_invMassA;
        var iA = this.v_invIA;
        var mB = this.v_invMassB;
        var iB = this.v_invIB;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        copyVec2(normal$2, this.v_normal);
        crossVec2Num(tangent$1, normal$2, 1);
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          combine2Vec2(P$1, vcp.normalImpulse, normal$2, vcp.tangentImpulse, tangent$1);
          wA -= iA * crossVec2Vec2(vcp.rA, P$1);
          minusScaleVec2(vA, mA, P$1);
          wB += iB * crossVec2Vec2(vcp.rB, P$1);
          plusScaleVec2(vB, mB, P$1);
        }
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.prototype.storeConstraintImpulses = function(step) {
        var manifold = this.m_manifold;
        for (var j = 0; j < this.v_pointCount; ++j) {
          manifold.points[j].normalImpulse = this.v_points[j].normalImpulse;
          manifold.points[j].tangentImpulse = this.v_points[j].tangentImpulse;
        }
      };
      Contact2.prototype.solveVelocityConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var mA = this.v_invMassA;
        var iA = this.v_invIA;
        var mB = this.v_invMassB;
        var iB = this.v_invIB;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        copyVec2(normal$2, this.v_normal);
        crossVec2Num(tangent$1, normal$2, 1);
        var friction = this.v_friction;
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          zeroVec2(dv);
          plusVec2(dv, vB);
          plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));
          minusVec2(dv, vA);
          minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));
          var vt = dotVec2(dv, tangent$1) - this.v_tangentSpeed;
          var lambda = vcp.tangentMass * -vt;
          var maxFriction = friction * vcp.normalImpulse;
          var newImpulse = clamp(vcp.tangentImpulse + lambda, -maxFriction, maxFriction);
          lambda = newImpulse - vcp.tangentImpulse;
          vcp.tangentImpulse = newImpulse;
          scaleVec2(P$1, lambda, tangent$1);
          minusScaleVec2(vA, mA, P$1);
          wA -= iA * crossVec2Vec2(vcp.rA, P$1);
          plusScaleVec2(vB, mB, P$1);
          wB += iB * crossVec2Vec2(vcp.rB, P$1);
        }
        if (this.v_pointCount == 1 || step.blockSolve == false) {
          for (var i = 0; i < this.v_pointCount; ++i) {
            var vcp = this.v_points[i];
            zeroVec2(dv);
            plusVec2(dv, vB);
            plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));
            minusVec2(dv, vA);
            minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));
            var vn = dotVec2(dv, normal$2);
            var lambda = -vcp.normalMass * (vn - vcp.velocityBias);
            var newImpulse = math_max$2(vcp.normalImpulse + lambda, 0);
            lambda = newImpulse - vcp.normalImpulse;
            vcp.normalImpulse = newImpulse;
            scaleVec2(P$1, lambda, normal$2);
            minusScaleVec2(vA, mA, P$1);
            wA -= iA * crossVec2Vec2(vcp.rA, P$1);
            plusScaleVec2(vB, mB, P$1);
            wB += iB * crossVec2Vec2(vcp.rB, P$1);
          }
        } else {
          var vcp1 = this.v_points[0];
          var vcp2 = this.v_points[1];
          setVec2(a, vcp1.normalImpulse, vcp2.normalImpulse);
          zeroVec2(dv1);
          plusVec2(dv1, vB);
          plusVec2(dv1, crossNumVec2(temp$2, wB, vcp1.rB));
          minusVec2(dv1, vA);
          minusVec2(dv1, crossNumVec2(temp$2, wA, vcp1.rA));
          zeroVec2(dv2);
          plusVec2(dv2, vB);
          plusVec2(dv2, crossNumVec2(temp$2, wB, vcp2.rB));
          minusVec2(dv2, vA);
          minusVec2(dv2, crossNumVec2(temp$2, wA, vcp2.rA));
          var vn1 = dotVec2(dv1, normal$2);
          var vn2 = dotVec2(dv2, normal$2);
          setVec2(b, vn1 - vcp1.velocityBias, vn2 - vcp2.velocityBias);
          b.x -= this.v_K.ex.x * a.x + this.v_K.ey.x * a.y;
          b.y -= this.v_K.ex.y * a.x + this.v_K.ey.y * a.y;
          while (true) {
            zeroVec2(x);
            x.x = -(this.v_normalMass.ex.x * b.x + this.v_normalMass.ey.x * b.y);
            x.y = -(this.v_normalMass.ex.y * b.x + this.v_normalMass.ey.y * b.y);
            if (x.x >= 0 && x.y >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = -vcp1.normalMass * b.x;
            x.y = 0;
            vn1 = 0;
            vn2 = this.v_K.ex.y * x.x + b.y;
            if (x.x >= 0 && vn2 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = 0;
            x.y = -vcp2.normalMass * b.y;
            vn1 = this.v_K.ey.x * x.y + b.x;
            vn2 = 0;
            if (x.y >= 0 && vn1 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = 0;
            x.y = 0;
            vn1 = b.x;
            vn2 = b.y;
            if (vn1 >= 0 && vn2 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            break;
          }
        }
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.addType = function(type1, type2, callback) {
        s_registers[type1] = s_registers[type1] || {};
        s_registers[type1][type2] = callback;
      };
      Contact2.create = function(fixtureA, indexA, fixtureB, indexB) {
        var typeA = fixtureA.m_shape.m_type;
        var typeB = fixtureB.m_shape.m_type;
        var contact = contactPool.allocate();
        var evaluateFcn;
        if (evaluateFcn = s_registers[typeA] && s_registers[typeA][typeB]) {
          contact.initialize(fixtureA, indexA, fixtureB, indexB, evaluateFcn);
        } else if (evaluateFcn = s_registers[typeB] && s_registers[typeB][typeA]) {
          contact.initialize(fixtureB, indexB, fixtureA, indexA, evaluateFcn);
        } else {
          return null;
        }
        fixtureA = contact.m_fixtureA;
        fixtureB = contact.m_fixtureB;
        indexA = contact.getChildIndexA();
        indexB = contact.getChildIndexB();
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        contact.m_nodeA.contact = contact;
        contact.m_nodeA.other = bodyB;
        contact.m_nodeA.prev = null;
        contact.m_nodeA.next = bodyA.m_contactList;
        if (bodyA.m_contactList != null) {
          bodyA.m_contactList.prev = contact.m_nodeA;
        }
        bodyA.m_contactList = contact.m_nodeA;
        contact.m_nodeB.contact = contact;
        contact.m_nodeB.other = bodyA;
        contact.m_nodeB.prev = null;
        contact.m_nodeB.next = bodyB.m_contactList;
        if (bodyB.m_contactList != null) {
          bodyB.m_contactList.prev = contact.m_nodeB;
        }
        bodyB.m_contactList = contact.m_nodeB;
        if (fixtureA.isSensor() == false && fixtureB.isSensor() == false) {
          bodyA.setAwake(true);
          bodyB.setAwake(true);
        }
        return contact;
      };
      Contact2.destroy = function(contact, listener) {
        var fixtureA = contact.m_fixtureA;
        var fixtureB = contact.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        if (contact.isTouching()) {
          listener.endContact(contact);
        }
        if (contact.m_nodeA.prev) {
          contact.m_nodeA.prev.next = contact.m_nodeA.next;
        }
        if (contact.m_nodeA.next) {
          contact.m_nodeA.next.prev = contact.m_nodeA.prev;
        }
        if (contact.m_nodeA == bodyA.m_contactList) {
          bodyA.m_contactList = contact.m_nodeA.next;
        }
        if (contact.m_nodeB.prev) {
          contact.m_nodeB.prev.next = contact.m_nodeB.next;
        }
        if (contact.m_nodeB.next) {
          contact.m_nodeB.next.prev = contact.m_nodeB.prev;
        }
        if (contact.m_nodeB == bodyB.m_contactList) {
          bodyB.m_contactList = contact.m_nodeB.next;
        }
        if (contact.m_manifold.pointCount > 0 && !fixtureA.m_isSensor && !fixtureB.m_isSensor) {
          bodyA.setAwake(true);
          bodyB.setAwake(true);
        }
        contactPool.release(contact);
      };
      return Contact2;
    }()
  );
  var DEFAULTS$b = {
    gravity: Vec2.zero(),
    allowSleep: true,
    warmStarting: true,
    continuousPhysics: true,
    subStepping: false,
    blockSolve: true,
    velocityIterations: 8,
    positionIterations: 3
  };
  var World = (
    /** @class */
    function() {
      function World2(def) {
        if (!(this instanceof World2)) {
          return new World2(def);
        }
        this.s_step = new TimeStep();
        if (!def) {
          def = {};
        } else if (Vec2.isValid(def)) {
          def = { gravity: def };
        }
        def = options(def, DEFAULTS$b);
        this.m_solver = new Solver(this);
        this.m_broadPhase = new BroadPhase();
        this.m_contactList = null;
        this.m_contactCount = 0;
        this.m_bodyList = null;
        this.m_bodyCount = 0;
        this.m_jointList = null;
        this.m_jointCount = 0;
        this.m_stepComplete = true;
        this.m_allowSleep = def.allowSleep;
        this.m_gravity = Vec2.clone(def.gravity);
        this.m_clearForces = true;
        this.m_newFixture = false;
        this.m_locked = false;
        this.m_warmStarting = def.warmStarting;
        this.m_continuousPhysics = def.continuousPhysics;
        this.m_subStepping = def.subStepping;
        this.m_blockSolve = def.blockSolve;
        this.m_velocityIterations = def.velocityIterations;
        this.m_positionIterations = def.positionIterations;
        this.m_t = 0;
        this.m_step_callback = [];
      }
      World2.prototype._serialize = function() {
        var bodies = [];
        var joints = [];
        for (var b2 = this.getBodyList(); b2; b2 = b2.getNext()) {
          bodies.push(b2);
        }
        for (var j = this.getJointList(); j; j = j.getNext()) {
          if (typeof j._serialize === "function") {
            joints.push(j);
          }
        }
        return {
          gravity: this.m_gravity,
          bodies,
          joints
        };
      };
      World2._deserialize = function(data, context, restore) {
        if (!data) {
          return new World2();
        }
        var world = new World2(data.gravity);
        if (data.bodies) {
          for (var i = data.bodies.length - 1; i >= 0; i -= 1) {
            world._addBody(restore(Body, data.bodies[i], world));
          }
        }
        if (data.joints) {
          for (var i = data.joints.length - 1; i >= 0; i--) {
            world.createJoint(restore(Joint, data.joints[i], world));
          }
        }
        return world;
      };
      World2.prototype.getBodyList = function() {
        return this.m_bodyList;
      };
      World2.prototype.getJointList = function() {
        return this.m_jointList;
      };
      World2.prototype.getContactList = function() {
        return this.m_contactList;
      };
      World2.prototype.getBodyCount = function() {
        return this.m_bodyCount;
      };
      World2.prototype.getJointCount = function() {
        return this.m_jointCount;
      };
      World2.prototype.getContactCount = function() {
        return this.m_contactCount;
      };
      World2.prototype.setGravity = function(gravity) {
        this.m_gravity.set(gravity);
      };
      World2.prototype.getGravity = function() {
        return this.m_gravity;
      };
      World2.prototype.isLocked = function() {
        return this.m_locked;
      };
      World2.prototype.setAllowSleeping = function(flag) {
        if (flag == this.m_allowSleep) {
          return;
        }
        this.m_allowSleep = flag;
        if (this.m_allowSleep == false) {
          for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {
            b2.setAwake(true);
          }
        }
      };
      World2.prototype.getAllowSleeping = function() {
        return this.m_allowSleep;
      };
      World2.prototype.setWarmStarting = function(flag) {
        this.m_warmStarting = flag;
      };
      World2.prototype.getWarmStarting = function() {
        return this.m_warmStarting;
      };
      World2.prototype.setContinuousPhysics = function(flag) {
        this.m_continuousPhysics = flag;
      };
      World2.prototype.getContinuousPhysics = function() {
        return this.m_continuousPhysics;
      };
      World2.prototype.setSubStepping = function(flag) {
        this.m_subStepping = flag;
      };
      World2.prototype.getSubStepping = function() {
        return this.m_subStepping;
      };
      World2.prototype.setAutoClearForces = function(flag) {
        this.m_clearForces = flag;
      };
      World2.prototype.getAutoClearForces = function() {
        return this.m_clearForces;
      };
      World2.prototype.clearForces = function() {
        for (var body = this.m_bodyList; body; body = body.getNext()) {
          body.m_force.setZero();
          body.m_torque = 0;
        }
      };
      World2.prototype.queryAABB = function(aabb, callback) {
        var broadPhase = this.m_broadPhase;
        this.m_broadPhase.query(aabb, function(proxyId) {
          var proxy = broadPhase.getUserData(proxyId);
          return callback(proxy.fixture);
        });
      };
      World2.prototype.rayCast = function(point1, point2, callback) {
        var broadPhase = this.m_broadPhase;
        this.m_broadPhase.rayCast({
          maxFraction: 1,
          p1: point1,
          p2: point2
        }, function(input2, proxyId) {
          var proxy = broadPhase.getUserData(proxyId);
          var fixture = proxy.fixture;
          var index = proxy.childIndex;
          var output2 = {};
          var hit = fixture.rayCast(output2, input2, index);
          if (hit) {
            var fraction = output2.fraction;
            var point3 = Vec2.add(Vec2.mulNumVec2(1 - fraction, input2.p1), Vec2.mulNumVec2(fraction, input2.p2));
            return callback(fixture, point3, output2.normal, fraction);
          }
          return input2.maxFraction;
        });
      };
      World2.prototype.getProxyCount = function() {
        return this.m_broadPhase.getProxyCount();
      };
      World2.prototype.getTreeHeight = function() {
        return this.m_broadPhase.getTreeHeight();
      };
      World2.prototype.getTreeBalance = function() {
        return this.m_broadPhase.getTreeBalance();
      };
      World2.prototype.getTreeQuality = function() {
        return this.m_broadPhase.getTreeQuality();
      };
      World2.prototype.shiftOrigin = function(newOrigin) {
        if (this.isLocked()) {
          return;
        }
        for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {
          b2.m_xf.p.sub(newOrigin);
          b2.m_sweep.c0.sub(newOrigin);
          b2.m_sweep.c.sub(newOrigin);
        }
        for (var j = this.m_jointList; j; j = j.m_next) {
          j.shiftOrigin(newOrigin);
        }
        this.m_broadPhase.shiftOrigin(newOrigin);
      };
      World2.prototype._addBody = function(body) {
        if (this.isLocked()) {
          return;
        }
        body.m_prev = null;
        body.m_next = this.m_bodyList;
        if (this.m_bodyList) {
          this.m_bodyList.m_prev = body;
        }
        this.m_bodyList = body;
        ++this.m_bodyCount;
      };
      World2.prototype.createBody = function(arg1, arg2) {
        if (this.isLocked()) {
          return null;
        }
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        var body = new Body(this, def);
        this._addBody(body);
        return body;
      };
      World2.prototype.createDynamicBody = function(arg1, arg2) {
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        def.type = "dynamic";
        return this.createBody(def);
      };
      World2.prototype.createKinematicBody = function(arg1, arg2) {
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        def.type = "kinematic";
        return this.createBody(def);
      };
      World2.prototype.destroyBody = function(b2) {
        if (this.isLocked()) {
          return;
        }
        if (b2.m_destroyed) {
          return false;
        }
        var je = b2.m_jointList;
        while (je) {
          var je0 = je;
          je = je.next;
          this.publish("remove-joint", je0.joint);
          this.destroyJoint(je0.joint);
          b2.m_jointList = je;
        }
        b2.m_jointList = null;
        var ce = b2.m_contactList;
        while (ce) {
          var ce0 = ce;
          ce = ce.next;
          this.destroyContact(ce0.contact);
          b2.m_contactList = ce;
        }
        b2.m_contactList = null;
        var f = b2.m_fixtureList;
        while (f) {
          var f0 = f;
          f = f.m_next;
          this.publish("remove-fixture", f0);
          f0.destroyProxies(this.m_broadPhase);
          b2.m_fixtureList = f;
        }
        b2.m_fixtureList = null;
        if (b2.m_prev) {
          b2.m_prev.m_next = b2.m_next;
        }
        if (b2.m_next) {
          b2.m_next.m_prev = b2.m_prev;
        }
        if (b2 == this.m_bodyList) {
          this.m_bodyList = b2.m_next;
        }
        b2.m_destroyed = true;
        --this.m_bodyCount;
        this.publish("remove-body", b2);
        return true;
      };
      World2.prototype.createJoint = function(joint) {
        if (this.isLocked()) {
          return null;
        }
        joint.m_prev = null;
        joint.m_next = this.m_jointList;
        if (this.m_jointList) {
          this.m_jointList.m_prev = joint;
        }
        this.m_jointList = joint;
        ++this.m_jointCount;
        joint.m_edgeA.joint = joint;
        joint.m_edgeA.other = joint.m_bodyB;
        joint.m_edgeA.prev = null;
        joint.m_edgeA.next = joint.m_bodyA.m_jointList;
        if (joint.m_bodyA.m_jointList)
          joint.m_bodyA.m_jointList.prev = joint.m_edgeA;
        joint.m_bodyA.m_jointList = joint.m_edgeA;
        joint.m_edgeB.joint = joint;
        joint.m_edgeB.other = joint.m_bodyA;
        joint.m_edgeB.prev = null;
        joint.m_edgeB.next = joint.m_bodyB.m_jointList;
        if (joint.m_bodyB.m_jointList)
          joint.m_bodyB.m_jointList.prev = joint.m_edgeB;
        joint.m_bodyB.m_jointList = joint.m_edgeB;
        if (joint.m_collideConnected == false) {
          for (var edge = joint.m_bodyB.getContactList(); edge; edge = edge.next) {
            if (edge.other == joint.m_bodyA) {
              edge.contact.flagForFiltering();
            }
          }
        }
        return joint;
      };
      World2.prototype.destroyJoint = function(joint) {
        if (this.isLocked()) {
          return;
        }
        if (joint.m_prev) {
          joint.m_prev.m_next = joint.m_next;
        }
        if (joint.m_next) {
          joint.m_next.m_prev = joint.m_prev;
        }
        if (joint == this.m_jointList) {
          this.m_jointList = joint.m_next;
        }
        var bodyA = joint.m_bodyA;
        var bodyB = joint.m_bodyB;
        bodyA.setAwake(true);
        bodyB.setAwake(true);
        if (joint.m_edgeA.prev) {
          joint.m_edgeA.prev.next = joint.m_edgeA.next;
        }
        if (joint.m_edgeA.next) {
          joint.m_edgeA.next.prev = joint.m_edgeA.prev;
        }
        if (joint.m_edgeA == bodyA.m_jointList) {
          bodyA.m_jointList = joint.m_edgeA.next;
        }
        joint.m_edgeA.prev = null;
        joint.m_edgeA.next = null;
        if (joint.m_edgeB.prev) {
          joint.m_edgeB.prev.next = joint.m_edgeB.next;
        }
        if (joint.m_edgeB.next) {
          joint.m_edgeB.next.prev = joint.m_edgeB.prev;
        }
        if (joint.m_edgeB == bodyB.m_jointList) {
          bodyB.m_jointList = joint.m_edgeB.next;
        }
        joint.m_edgeB.prev = null;
        joint.m_edgeB.next = null;
        --this.m_jointCount;
        if (joint.m_collideConnected == false) {
          var edge = bodyB.getContactList();
          while (edge) {
            if (edge.other == bodyA) {
              edge.contact.flagForFiltering();
            }
            edge = edge.next;
          }
        }
        this.publish("remove-joint", joint);
      };
      World2.prototype.step = function(timeStep, velocityIterations, positionIterations) {
        this.publish("pre-step", timeStep);
        if ((velocityIterations | 0) !== velocityIterations) {
          velocityIterations = 0;
        }
        velocityIterations = velocityIterations || this.m_velocityIterations;
        positionIterations = positionIterations || this.m_positionIterations;
        if (this.m_newFixture) {
          this.findNewContacts();
          this.m_newFixture = false;
        }
        this.m_locked = true;
        this.s_step.reset(timeStep);
        this.s_step.velocityIterations = velocityIterations;
        this.s_step.positionIterations = positionIterations;
        this.s_step.warmStarting = this.m_warmStarting;
        this.s_step.blockSolve = this.m_blockSolve;
        this.updateContacts();
        if (this.m_stepComplete && timeStep > 0) {
          this.m_solver.solveWorld(this.s_step);
          for (var b2 = this.m_bodyList; b2; b2 = b2.getNext()) {
            if (b2.m_islandFlag == false) {
              continue;
            }
            if (b2.isStatic()) {
              continue;
            }
            b2.synchronizeFixtures();
          }
          this.findNewContacts();
        }
        if (this.m_continuousPhysics && timeStep > 0) {
          this.m_solver.solveWorldTOI(this.s_step);
        }
        if (this.m_clearForces) {
          this.clearForces();
        }
        this.m_locked = false;
        var callback;
        while (callback = this.m_step_callback.shift()) {
          callback(this);
        }
        this.publish("post-step", timeStep);
      };
      World2.prototype.queueUpdate = function(callback) {
        if (!this.isLocked()) {
          callback(this);
        } else {
          this.m_step_callback.push(callback);
        }
      };
      World2.prototype.findNewContacts = function() {
        var _this = this;
        this.m_broadPhase.updatePairs(function(proxyA, proxyB) {
          return _this.createContact(proxyA, proxyB);
        });
      };
      World2.prototype.createContact = function(proxyA, proxyB) {
        var fixtureA = proxyA.fixture;
        var fixtureB = proxyB.fixture;
        var indexA = proxyA.childIndex;
        var indexB = proxyB.childIndex;
        var bodyA = fixtureA.getBody();
        var bodyB = fixtureB.getBody();
        if (bodyA == bodyB) {
          return;
        }
        var edge = bodyB.getContactList();
        while (edge) {
          if (edge.other == bodyA) {
            var fA = edge.contact.getFixtureA();
            var fB = edge.contact.getFixtureB();
            var iA = edge.contact.getChildIndexA();
            var iB = edge.contact.getChildIndexB();
            if (fA == fixtureA && fB == fixtureB && iA == indexA && iB == indexB) {
              return;
            }
            if (fA == fixtureB && fB == fixtureA && iA == indexB && iB == indexA) {
              return;
            }
          }
          edge = edge.next;
        }
        if (bodyB.shouldCollide(bodyA) == false) {
          return;
        }
        if (fixtureB.shouldCollide(fixtureA) == false) {
          return;
        }
        var contact = Contact.create(fixtureA, indexA, fixtureB, indexB);
        if (contact == null) {
          return;
        }
        contact.m_prev = null;
        if (this.m_contactList != null) {
          contact.m_next = this.m_contactList;
          this.m_contactList.m_prev = contact;
        }
        this.m_contactList = contact;
        ++this.m_contactCount;
      };
      World2.prototype.updateContacts = function() {
        var c2;
        var next_c = this.m_contactList;
        while (c2 = next_c) {
          next_c = c2.getNext();
          var fixtureA = c2.getFixtureA();
          var fixtureB = c2.getFixtureB();
          var indexA = c2.getChildIndexA();
          var indexB = c2.getChildIndexB();
          var bodyA = fixtureA.getBody();
          var bodyB = fixtureB.getBody();
          if (c2.m_filterFlag) {
            if (bodyB.shouldCollide(bodyA) == false) {
              this.destroyContact(c2);
              continue;
            }
            if (fixtureB.shouldCollide(fixtureA) == false) {
              this.destroyContact(c2);
              continue;
            }
            c2.m_filterFlag = false;
          }
          var activeA = bodyA.isAwake() && !bodyA.isStatic();
          var activeB = bodyB.isAwake() && !bodyB.isStatic();
          if (activeA == false && activeB == false) {
            continue;
          }
          var proxyIdA = fixtureA.m_proxies[indexA].proxyId;
          var proxyIdB = fixtureB.m_proxies[indexB].proxyId;
          var overlap = this.m_broadPhase.testOverlap(proxyIdA, proxyIdB);
          if (overlap == false) {
            this.destroyContact(c2);
            continue;
          }
          c2.update(this);
        }
      };
      World2.prototype.destroyContact = function(contact) {
        if (contact.m_prev) {
          contact.m_prev.m_next = contact.m_next;
        }
        if (contact.m_next) {
          contact.m_next.m_prev = contact.m_prev;
        }
        if (contact == this.m_contactList) {
          this.m_contactList = contact.m_next;
        }
        Contact.destroy(contact, this);
        --this.m_contactCount;
      };
      World2.prototype.on = function(name, listener) {
        if (typeof name !== "string" || typeof listener !== "function") {
          return this;
        }
        if (!this._listeners) {
          this._listeners = {};
        }
        if (!this._listeners[name]) {
          this._listeners[name] = [];
        }
        this._listeners[name].push(listener);
        return this;
      };
      World2.prototype.off = function(name, listener) {
        if (typeof name !== "string" || typeof listener !== "function") {
          return this;
        }
        var listeners = this._listeners && this._listeners[name];
        if (!listeners || !listeners.length) {
          return this;
        }
        var index = listeners.indexOf(listener);
        if (index >= 0) {
          listeners.splice(index, 1);
        }
        return this;
      };
      World2.prototype.publish = function(name, arg1, arg2, arg3) {
        var listeners = this._listeners && this._listeners[name];
        if (!listeners || !listeners.length) {
          return 0;
        }
        for (var l = 0; l < listeners.length; l++) {
          listeners[l].call(this, arg1, arg2, arg3);
        }
        return listeners.length;
      };
      World2.prototype.beginContact = function(contact) {
        this.publish("begin-contact", contact);
      };
      World2.prototype.endContact = function(contact) {
        this.publish("end-contact", contact);
      };
      World2.prototype.preSolve = function(contact, oldManifold2) {
        this.publish("pre-solve", contact, oldManifold2);
      };
      World2.prototype.postSolve = function(contact, impulse) {
        this.publish("post-solve", contact, impulse);
      };
      return World2;
    }()
  );
  var Vec3 = (
    /** @class */
    function() {
      function Vec32(x2, y, z) {
        if (!(this instanceof Vec32)) {
          return new Vec32(x2, y, z);
        }
        if (typeof x2 === "undefined") {
          this.x = 0;
          this.y = 0;
          this.z = 0;
        } else if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
          this.z = x2.z;
        } else {
          this.x = x2;
          this.y = y;
          this.z = z;
        }
      }
      Vec32.prototype._serialize = function() {
        return {
          x: this.x,
          y: this.y,
          z: this.z
        };
      };
      Vec32._deserialize = function(data) {
        var obj = Object.create(Vec32.prototype);
        obj.x = data.x;
        obj.y = data.y;
        obj.z = data.z;
        return obj;
      };
      Vec32.neo = function(x2, y, z) {
        var obj = Object.create(Vec32.prototype);
        obj.x = x2;
        obj.y = y;
        obj.z = z;
        return obj;
      };
      Vec32.zero = function() {
        var obj = Object.create(Vec32.prototype);
        obj.x = 0;
        obj.y = 0;
        obj.z = 0;
        return obj;
      };
      Vec32.clone = function(v3) {
        return Vec32.neo(v3.x, v3.y, v3.z);
      };
      Vec32.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Vec32.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.x) && Number.isFinite(obj.y) && Number.isFinite(obj.z);
      };
      Vec32.assert = function(o) {
      };
      Vec32.prototype.setZero = function() {
        this.x = 0;
        this.y = 0;
        this.z = 0;
        return this;
      };
      Vec32.prototype.set = function(x2, y, z) {
        this.x = x2;
        this.y = y;
        this.z = z;
        return this;
      };
      Vec32.prototype.add = function(w) {
        this.x += w.x;
        this.y += w.y;
        this.z += w.z;
        return this;
      };
      Vec32.prototype.sub = function(w) {
        this.x -= w.x;
        this.y -= w.y;
        this.z -= w.z;
        return this;
      };
      Vec32.prototype.mul = function(m) {
        this.x *= m;
        this.y *= m;
        this.z *= m;
        return this;
      };
      Vec32.areEqual = function(v3, w) {
        return v3 === w || typeof v3 === "object" && v3 !== null && typeof w === "object" && w !== null && v3.x === w.x && v3.y === w.y && v3.z === w.z;
      };
      Vec32.dot = function(v3, w) {
        return v3.x * w.x + v3.y * w.y + v3.z * w.z;
      };
      Vec32.cross = function(v3, w) {
        return new Vec32(v3.y * w.z - v3.z * w.y, v3.z * w.x - v3.x * w.z, v3.x * w.y - v3.y * w.x);
      };
      Vec32.add = function(v3, w) {
        return new Vec32(v3.x + w.x, v3.y + w.y, v3.z + w.z);
      };
      Vec32.sub = function(v3, w) {
        return new Vec32(v3.x - w.x, v3.y - w.y, v3.z - w.z);
      };
      Vec32.mul = function(v3, m) {
        return new Vec32(m * v3.x, m * v3.y, m * v3.z);
      };
      Vec32.prototype.neg = function() {
        this.x = -this.x;
        this.y = -this.y;
        this.z = -this.z;
        return this;
      };
      Vec32.neg = function(v3) {
        return new Vec32(-v3.x, -v3.y, -v3.z);
      };
      return Vec32;
    }()
  );
  var v1$2 = vec2(0, 0);
  var v2$1 = vec2(0, 0);
  var EdgeShape = (
    /** @class */
    function(_super) {
      __extends(EdgeShape2, _super);
      function EdgeShape2(v122, v22) {
        var _this = this;
        if (!(_this instanceof EdgeShape2)) {
          return new EdgeShape2(v122, v22);
        }
        _this = _super.call(this) || this;
        _this.m_type = EdgeShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_vertex1 = v122 ? Vec2.clone(v122) : Vec2.zero();
        _this.m_vertex2 = v22 ? Vec2.clone(v22) : Vec2.zero();
        _this.m_vertex0 = Vec2.zero();
        _this.m_vertex3 = Vec2.zero();
        _this.m_hasVertex0 = false;
        _this.m_hasVertex3 = false;
        return _this;
      }
      EdgeShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          vertex1: this.m_vertex1,
          vertex2: this.m_vertex2,
          vertex0: this.m_vertex0,
          vertex3: this.m_vertex3,
          hasVertex0: this.m_hasVertex0,
          hasVertex3: this.m_hasVertex3
        };
      };
      EdgeShape2._deserialize = function(data) {
        var shape = new EdgeShape2(data.vertex1, data.vertex2);
        if (shape.m_hasVertex0) {
          shape.setPrevVertex(data.vertex0);
        }
        if (shape.m_hasVertex3) {
          shape.setNextVertex(data.vertex3);
        }
        return shape;
      };
      EdgeShape2.prototype._reset = function() {
      };
      EdgeShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      EdgeShape2.prototype.getType = function() {
        return this.m_type;
      };
      EdgeShape2.prototype.setNext = function(v3) {
        return this.setNextVertex(v3);
      };
      EdgeShape2.prototype.setNextVertex = function(v3) {
        if (v3) {
          this.m_vertex3.setVec2(v3);
          this.m_hasVertex3 = true;
        } else {
          this.m_vertex3.setZero();
          this.m_hasVertex3 = false;
        }
        return this;
      };
      EdgeShape2.prototype.getNextVertex = function() {
        return this.m_vertex3;
      };
      EdgeShape2.prototype.setPrev = function(v3) {
        return this.setPrevVertex(v3);
      };
      EdgeShape2.prototype.setPrevVertex = function(v3) {
        if (v3) {
          this.m_vertex0.setVec2(v3);
          this.m_hasVertex0 = true;
        } else {
          this.m_vertex0.setZero();
          this.m_hasVertex0 = false;
        }
        return this;
      };
      EdgeShape2.prototype.getPrevVertex = function() {
        return this.m_vertex0;
      };
      EdgeShape2.prototype._set = function(v122, v22) {
        this.m_vertex1.setVec2(v122);
        this.m_vertex2.setVec2(v22);
        this.m_hasVertex0 = false;
        this.m_hasVertex3 = false;
        return this;
      };
      EdgeShape2.prototype._clone = function() {
        var clone = new EdgeShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_vertex1.setVec2(this.m_vertex1);
        clone.m_vertex2.setVec2(this.m_vertex2);
        clone.m_vertex0.setVec2(this.m_vertex0);
        clone.m_vertex3.setVec2(this.m_vertex3);
        clone.m_hasVertex0 = this.m_hasVertex0;
        clone.m_hasVertex3 = this.m_hasVertex3;
        return clone;
      };
      EdgeShape2.prototype.getChildCount = function() {
        return 1;
      };
      EdgeShape2.prototype.testPoint = function(xf2, p) {
        return false;
      };
      EdgeShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));
        var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));
        var d2 = Vec2.sub(p2, p1);
        var v122 = this.m_vertex1;
        var v22 = this.m_vertex2;
        var e3 = Vec2.sub(v22, v122);
        var normal3 = Vec2.neo(e3.y, -e3.x);
        normal3.normalize();
        var numerator = Vec2.dot(normal3, Vec2.sub(v122, p1));
        var denominator = Vec2.dot(normal3, d2);
        if (denominator == 0) {
          return false;
        }
        var t = numerator / denominator;
        if (t < 0 || input2.maxFraction < t) {
          return false;
        }
        var q = Vec2.add(p1, Vec2.mulNumVec2(t, d2));
        var r = Vec2.sub(v22, v122);
        var rr = Vec2.dot(r, r);
        if (rr == 0) {
          return false;
        }
        var s2 = Vec2.dot(Vec2.sub(q, v122), r) / rr;
        if (s2 < 0 || 1 < s2) {
          return false;
        }
        output2.fraction = t;
        if (numerator > 0) {
          output2.normal = Rot.mulVec2(xf2.q, normal3).neg();
        } else {
          output2.normal = Rot.mulVec2(xf2.q, normal3);
        }
        return true;
      };
      EdgeShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        transformVec2(v1$2, xf2, this.m_vertex1);
        transformVec2(v2$1, xf2, this.m_vertex2);
        AABB.combinePoints(aabb, v1$2, v2$1);
        AABB.extend(aabb, this.m_radius);
      };
      EdgeShape2.prototype.computeMass = function(massData, density) {
        massData.mass = 0;
        combine2Vec2(massData.center, 0.5, this.m_vertex1, 0.5, this.m_vertex2);
        massData.I = 0;
      };
      EdgeShape2.prototype.computeDistanceProxy = function(proxy) {
        proxy.m_vertices[0] = this.m_vertex1;
        proxy.m_vertices[1] = this.m_vertex2;
        proxy.m_vertices.length = 2;
        proxy.m_count = 2;
        proxy.m_radius = this.m_radius;
      };
      EdgeShape2.TYPE = "edge";
      return EdgeShape2;
    }(Shape)
  );
  var v1$1 = vec2(0, 0);
  var v2 = vec2(0, 0);
  var ChainShape = (
    /** @class */
    function(_super) {
      __extends(ChainShape2, _super);
      function ChainShape2(vertices, loop) {
        var _this = this;
        if (!(_this instanceof ChainShape2)) {
          return new ChainShape2(vertices, loop);
        }
        _this = _super.call(this) || this;
        _this.m_type = ChainShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_vertices = [];
        _this.m_count = 0;
        _this.m_prevVertex = null;
        _this.m_nextVertex = null;
        _this.m_hasPrevVertex = false;
        _this.m_hasNextVertex = false;
        _this.m_isLoop = !!loop;
        if (vertices && vertices.length) {
          if (loop) {
            _this._createLoop(vertices);
          } else {
            _this._createChain(vertices);
          }
        }
        return _this;
      }
      ChainShape2.prototype._serialize = function() {
        var data = {
          type: this.m_type,
          vertices: this.m_isLoop ? this.m_vertices.slice(0, this.m_vertices.length - 1) : this.m_vertices,
          isLoop: this.m_isLoop,
          hasPrevVertex: this.m_hasPrevVertex,
          hasNextVertex: this.m_hasNextVertex,
          prevVertex: null,
          nextVertex: null
        };
        if (this.m_prevVertex) {
          data.prevVertex = this.m_prevVertex;
        }
        if (this.m_nextVertex) {
          data.nextVertex = this.m_nextVertex;
        }
        return data;
      };
      ChainShape2._deserialize = function(data, fixture, restore) {
        var vertices = [];
        if (data.vertices) {
          for (var i = 0; i < data.vertices.length; i++) {
            vertices.push(restore(Vec2, data.vertices[i]));
          }
        }
        var shape = new ChainShape2(vertices, data.isLoop);
        if (data.prevVertex) {
          shape.setPrevVertex(data.prevVertex);
        }
        if (data.nextVertex) {
          shape.setNextVertex(data.nextVertex);
        }
        return shape;
      };
      ChainShape2.prototype.getType = function() {
        return this.m_type;
      };
      ChainShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      ChainShape2.prototype._createLoop = function(vertices) {
        if (vertices.length < 3) {
          return;
        }
        var i;
        this.m_vertices = [];
        this.m_count = vertices.length + 1;
        for (var i = 0; i < vertices.length; ++i) {
          this.m_vertices[i] = Vec2.clone(vertices[i]);
        }
        this.m_vertices[vertices.length] = Vec2.clone(vertices[0]);
        this.m_prevVertex = this.m_vertices[this.m_count - 2];
        this.m_nextVertex = this.m_vertices[1];
        this.m_hasPrevVertex = true;
        this.m_hasNextVertex = true;
        return this;
      };
      ChainShape2.prototype._createChain = function(vertices) {
        var i;
        this.m_vertices = [];
        this.m_count = vertices.length;
        for (var i = 0; i < vertices.length; ++i) {
          this.m_vertices[i] = Vec2.clone(vertices[i]);
        }
        this.m_prevVertex = null;
        this.m_nextVertex = null;
        this.m_hasPrevVertex = false;
        this.m_hasNextVertex = false;
        return this;
      };
      ChainShape2.prototype._reset = function() {
        if (this.m_isLoop) {
          this._createLoop(this.m_vertices.slice(0, this.m_vertices.length - 1));
        } else {
          this._createChain(this.m_vertices);
        }
      };
      ChainShape2.prototype.setPrevVertex = function(prevVertex) {
        this.m_prevVertex = prevVertex;
        this.m_hasPrevVertex = true;
      };
      ChainShape2.prototype.getPrevVertex = function() {
        return this.m_prevVertex;
      };
      ChainShape2.prototype.setNextVertex = function(nextVertex) {
        this.m_nextVertex = nextVertex;
        this.m_hasNextVertex = true;
      };
      ChainShape2.prototype.getNextVertex = function() {
        return this.m_nextVertex;
      };
      ChainShape2.prototype._clone = function() {
        var clone = new ChainShape2();
        clone._createChain(this.m_vertices);
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_prevVertex = this.m_prevVertex;
        clone.m_nextVertex = this.m_nextVertex;
        clone.m_hasPrevVertex = this.m_hasPrevVertex;
        clone.m_hasNextVertex = this.m_hasNextVertex;
        return clone;
      };
      ChainShape2.prototype.getChildCount = function() {
        return this.m_count - 1;
      };
      ChainShape2.prototype.getChildEdge = function(edge, childIndex) {
        edge.m_type = EdgeShape.TYPE;
        edge.m_radius = this.m_radius;
        edge.m_vertex1 = this.m_vertices[childIndex];
        edge.m_vertex2 = this.m_vertices[childIndex + 1];
        if (childIndex > 0) {
          edge.m_vertex0 = this.m_vertices[childIndex - 1];
          edge.m_hasVertex0 = true;
        } else {
          edge.m_vertex0 = this.m_prevVertex;
          edge.m_hasVertex0 = this.m_hasPrevVertex;
        }
        if (childIndex < this.m_count - 2) {
          edge.m_vertex3 = this.m_vertices[childIndex + 2];
          edge.m_hasVertex3 = true;
        } else {
          edge.m_vertex3 = this.m_nextVertex;
          edge.m_hasVertex3 = this.m_hasNextVertex;
        }
      };
      ChainShape2.prototype.getVertex = function(index) {
        if (index < this.m_count) {
          return this.m_vertices[index];
        } else {
          return this.m_vertices[0];
        }
      };
      ChainShape2.prototype.isLoop = function() {
        return this.m_isLoop;
      };
      ChainShape2.prototype.testPoint = function(xf2, p) {
        return false;
      };
      ChainShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var edgeShape = new EdgeShape(this.getVertex(childIndex), this.getVertex(childIndex + 1));
        return edgeShape.rayCast(output2, input2, xf2, 0);
      };
      ChainShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        transformVec2(v1$1, xf2, this.getVertex(childIndex));
        transformVec2(v2, xf2, this.getVertex(childIndex + 1));
        AABB.combinePoints(aabb, v1$1, v2);
      };
      ChainShape2.prototype.computeMass = function(massData, density) {
        massData.mass = 0;
        zeroVec2(massData.center);
        massData.I = 0;
      };
      ChainShape2.prototype.computeDistanceProxy = function(proxy, childIndex) {
        proxy.m_vertices[0] = this.getVertex(childIndex);
        proxy.m_vertices[1] = this.getVertex(childIndex + 1);
        proxy.m_count = 2;
        proxy.m_radius = this.m_radius;
      };
      ChainShape2.TYPE = "chain";
      return ChainShape2;
    }(Shape)
  );
  var math_max$1 = Math.max;
  var math_min$3 = Math.min;
  var temp$1 = vec2(0, 0);
  var e$1 = vec2(0, 0);
  var e1$1 = vec2(0, 0);
  var e2$1 = vec2(0, 0);
  var center = vec2(0, 0);
  var s = vec2(0, 0);
  var PolygonShape = (
    /** @class */
    function(_super) {
      __extends(PolygonShape2, _super);
      function PolygonShape2(vertices) {
        var _this = this;
        if (!(_this instanceof PolygonShape2)) {
          return new PolygonShape2(vertices);
        }
        _this = _super.call(this) || this;
        _this.m_type = PolygonShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_centroid = Vec2.zero();
        _this.m_vertices = [];
        _this.m_normals = [];
        _this.m_count = 0;
        if (vertices && vertices.length) {
          _this._set(vertices);
        }
        return _this;
      }
      PolygonShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          vertices: this.m_vertices
        };
      };
      PolygonShape2._deserialize = function(data, fixture, restore) {
        var vertices = [];
        if (data.vertices) {
          for (var i = 0; i < data.vertices.length; i++) {
            vertices.push(restore(Vec2, data.vertices[i]));
          }
        }
        var shape = new PolygonShape2(vertices);
        return shape;
      };
      PolygonShape2.prototype.getType = function() {
        return this.m_type;
      };
      PolygonShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      PolygonShape2.prototype._clone = function() {
        var clone = new PolygonShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_count = this.m_count;
        clone.m_centroid.setVec2(this.m_centroid);
        for (var i = 0; i < this.m_count; i++) {
          clone.m_vertices.push(this.m_vertices[i].clone());
        }
        for (var i = 0; i < this.m_normals.length; i++) {
          clone.m_normals.push(this.m_normals[i].clone());
        }
        return clone;
      };
      PolygonShape2.prototype.getChildCount = function() {
        return 1;
      };
      PolygonShape2.prototype._reset = function() {
        this._set(this.m_vertices);
      };
      PolygonShape2.prototype._set = function(vertices) {
        if (vertices.length < 3) {
          this._setAsBox(1, 1);
          return;
        }
        var n2 = math_min$3(vertices.length, SettingsInternal.maxPolygonVertices);
        var ps = [];
        for (var i = 0; i < n2; ++i) {
          var v3 = vertices[i];
          var unique = true;
          for (var j = 0; j < ps.length; ++j) {
            if (Vec2.distanceSquared(v3, ps[j]) < 0.25 * SettingsInternal.linearSlopSquared) {
              unique = false;
              break;
            }
          }
          if (unique) {
            ps.push(Vec2.clone(v3));
          }
        }
        n2 = ps.length;
        if (n2 < 3) {
          this._setAsBox(1, 1);
          return;
        }
        var i0 = 0;
        var x0 = ps[0].x;
        for (var i = 1; i < n2; ++i) {
          var x2 = ps[i].x;
          if (x2 > x0 || x2 === x0 && ps[i].y < ps[i0].y) {
            i0 = i;
            x0 = x2;
          }
        }
        var hull = [];
        var m = 0;
        var ih = i0;
        while (true) {
          hull[m] = ih;
          var ie2 = 0;
          for (var j = 1; j < n2; ++j) {
            if (ie2 === ih) {
              ie2 = j;
              continue;
            }
            var r = Vec2.sub(ps[ie2], ps[hull[m]]);
            var v3 = Vec2.sub(ps[j], ps[hull[m]]);
            var c2 = Vec2.crossVec2Vec2(r, v3);
            if (c2 < 0) {
              ie2 = j;
            }
            if (c2 === 0 && v3.lengthSquared() > r.lengthSquared()) {
              ie2 = j;
            }
          }
          ++m;
          ih = ie2;
          if (ie2 === i0) {
            break;
          }
        }
        if (m < 3) {
          this._setAsBox(1, 1);
          return;
        }
        this.m_count = m;
        this.m_vertices = [];
        for (var i = 0; i < m; ++i) {
          this.m_vertices[i] = ps[hull[i]];
        }
        for (var i = 0; i < m; ++i) {
          var i1 = i;
          var i2 = i + 1 < m ? i + 1 : 0;
          var edge = Vec2.sub(this.m_vertices[i2], this.m_vertices[i1]);
          this.m_normals[i] = Vec2.crossVec2Num(edge, 1);
          this.m_normals[i].normalize();
        }
        this.m_centroid = computeCentroid(this.m_vertices, m);
      };
      PolygonShape2.prototype._setAsBox = function(hx, hy, center2, angle) {
        this.m_vertices[0] = Vec2.neo(hx, -hy);
        this.m_vertices[1] = Vec2.neo(hx, hy);
        this.m_vertices[2] = Vec2.neo(-hx, hy);
        this.m_vertices[3] = Vec2.neo(-hx, -hy);
        this.m_normals[0] = Vec2.neo(1, 0);
        this.m_normals[1] = Vec2.neo(0, 1);
        this.m_normals[2] = Vec2.neo(-1, 0);
        this.m_normals[3] = Vec2.neo(0, -1);
        this.m_count = 4;
        if (center2 && Vec2.isValid(center2)) {
          angle = angle || 0;
          copyVec2(this.m_centroid, center2);
          var xf2 = Transform.identity();
          xf2.p.setVec2(center2);
          xf2.q.setAngle(angle);
          for (var i = 0; i < this.m_count; ++i) {
            this.m_vertices[i] = Transform.mulVec2(xf2, this.m_vertices[i]);
            this.m_normals[i] = Rot.mulVec2(xf2.q, this.m_normals[i]);
          }
        }
      };
      PolygonShape2.prototype.testPoint = function(xf2, p) {
        var pLocal = detransformVec2(temp$1, xf2, p);
        for (var i = 0; i < this.m_count; ++i) {
          var dot = dotVec2(this.m_normals[i], pLocal) - dotVec2(this.m_normals[i], this.m_vertices[i]);
          if (dot > 0) {
            return false;
          }
        }
        return true;
      };
      PolygonShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));
        var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));
        var d2 = Vec2.sub(p2, p1);
        var lower = 0;
        var upper = input2.maxFraction;
        var index = -1;
        for (var i = 0; i < this.m_count; ++i) {
          var numerator = Vec2.dot(this.m_normals[i], Vec2.sub(this.m_vertices[i], p1));
          var denominator = Vec2.dot(this.m_normals[i], d2);
          if (denominator == 0) {
            if (numerator < 0) {
              return false;
            }
          } else {
            if (denominator < 0 && numerator < lower * denominator) {
              lower = numerator / denominator;
              index = i;
            } else if (denominator > 0 && numerator < upper * denominator) {
              upper = numerator / denominator;
            }
          }
          if (upper < lower) {
            return false;
          }
        }
        if (index >= 0) {
          output2.fraction = lower;
          output2.normal = Rot.mulVec2(xf2.q, this.m_normals[index]);
          return true;
        }
        return false;
      };
      PolygonShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        var minX = Infinity;
        var minY = Infinity;
        var maxX = -Infinity;
        var maxY = -Infinity;
        for (var i = 0; i < this.m_count; ++i) {
          var v3 = transformVec2(temp$1, xf2, this.m_vertices[i]);
          minX = math_min$3(minX, v3.x);
          maxX = math_max$1(maxX, v3.x);
          minY = math_min$3(minY, v3.y);
          maxY = math_max$1(maxY, v3.y);
        }
        setVec2(aabb.lowerBound, minX - this.m_radius, minY - this.m_radius);
        setVec2(aabb.upperBound, maxX + this.m_radius, maxY + this.m_radius);
      };
      PolygonShape2.prototype.computeMass = function(massData, density) {
        zeroVec2(center);
        var area = 0;
        var I = 0;
        zeroVec2(s);
        for (var i = 0; i < this.m_count; ++i) {
          plusVec2(s, this.m_vertices[i]);
        }
        scaleVec2(s, 1 / this.m_count, s);
        var k_inv3 = 1 / 3;
        for (var i = 0; i < this.m_count; ++i) {
          subVec2(e1$1, this.m_vertices[i], s);
          if (i + 1 < this.m_count) {
            subVec2(e2$1, this.m_vertices[i + 1], s);
          } else {
            subVec2(e2$1, this.m_vertices[0], s);
          }
          var D = crossVec2Vec2(e1$1, e2$1);
          var triangleArea = 0.5 * D;
          area += triangleArea;
          combine2Vec2(temp$1, triangleArea * k_inv3, e1$1, triangleArea * k_inv3, e2$1);
          plusVec2(center, temp$1);
          var ex1 = e1$1.x;
          var ey1 = e1$1.y;
          var ex2 = e2$1.x;
          var ey2 = e2$1.y;
          var intx2 = ex1 * ex1 + ex2 * ex1 + ex2 * ex2;
          var inty2 = ey1 * ey1 + ey2 * ey1 + ey2 * ey2;
          I += 0.25 * k_inv3 * D * (intx2 + inty2);
        }
        massData.mass = density * area;
        scaleVec2(center, 1 / area, center);
        addVec2(massData.center, center, s);
        massData.I = density * I;
        massData.I += massData.mass * (dotVec2(massData.center, massData.center) - dotVec2(center, center));
      };
      PolygonShape2.prototype.validate = function() {
        for (var i = 0; i < this.m_count; ++i) {
          var i1 = i;
          var i2 = i < this.m_count - 1 ? i1 + 1 : 0;
          var p = this.m_vertices[i1];
          subVec2(e$1, this.m_vertices[i2], p);
          for (var j = 0; j < this.m_count; ++j) {
            if (j == i1 || j == i2) {
              continue;
            }
            var c2 = crossVec2Vec2(e$1, subVec2(temp$1, this.m_vertices[j], p));
            if (c2 < 0) {
              return false;
            }
          }
        }
        return true;
      };
      PolygonShape2.prototype.computeDistanceProxy = function(proxy) {
        for (var i = 0; i < this.m_count; ++i) {
          proxy.m_vertices[i] = this.m_vertices[i];
        }
        proxy.m_vertices.length = this.m_count;
        proxy.m_count = this.m_count;
        proxy.m_radius = this.m_radius;
      };
      PolygonShape2.TYPE = "polygon";
      return PolygonShape2;
    }(Shape)
  );
  function computeCentroid(vs, count) {
    var c2 = Vec2.zero();
    var area = 0;
    var pRef = Vec2.zero();
    var i;
    var inv3 = 1 / 3;
    for (var i = 0; i < count; ++i) {
      var p1 = pRef;
      var p2 = vs[i];
      var p3 = i + 1 < count ? vs[i + 1] : vs[0];
      var e1_1 = Vec2.sub(p2, p1);
      var e2_1 = Vec2.sub(p3, p1);
      var D = Vec2.crossVec2Vec2(e1_1, e2_1);
      var triangleArea = 0.5 * D;
      area += triangleArea;
      combine3Vec2(temp$1, 1, p1, 1, p2, 1, p3);
      plusScaleVec2(c2, triangleArea * inv3, temp$1);
    }
    c2.mul(1 / area);
    return c2;
  }
  var math_sqrt = Math.sqrt;
  var math_PI$4 = Math.PI;
  var temp = vec2(0, 0);
  var CircleShape = (
    /** @class */
    function(_super) {
      __extends(CircleShape2, _super);
      function CircleShape2(a2, b2) {
        var _this = this;
        if (!(_this instanceof CircleShape2)) {
          return new CircleShape2(a2, b2);
        }
        _this = _super.call(this) || this;
        _this.m_type = CircleShape2.TYPE;
        _this.m_p = Vec2.zero();
        _this.m_radius = 1;
        if (typeof a2 === "object" && Vec2.isValid(a2)) {
          _this.m_p.setVec2(a2);
          if (typeof b2 === "number") {
            _this.m_radius = b2;
          }
        } else if (typeof a2 === "number") {
          _this.m_radius = a2;
        }
        return _this;
      }
      CircleShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          p: this.m_p,
          radius: this.m_radius
        };
      };
      CircleShape2._deserialize = function(data) {
        return new CircleShape2(data.p, data.radius);
      };
      CircleShape2.prototype._reset = function() {
      };
      CircleShape2.prototype.getType = function() {
        return this.m_type;
      };
      CircleShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      CircleShape2.prototype.getCenter = function() {
        return this.m_p;
      };
      CircleShape2.prototype._clone = function() {
        var clone = new CircleShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_p = this.m_p.clone();
        return clone;
      };
      CircleShape2.prototype.getChildCount = function() {
        return 1;
      };
      CircleShape2.prototype.testPoint = function(xf2, p) {
        var center2 = transformVec2(temp, xf2, this.m_p);
        return distSqrVec2(p, center2) <= this.m_radius * this.m_radius;
      };
      CircleShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var position = Vec2.add(xf2.p, Rot.mulVec2(xf2.q, this.m_p));
        var s2 = Vec2.sub(input2.p1, position);
        var b2 = Vec2.dot(s2, s2) - this.m_radius * this.m_radius;
        var r = Vec2.sub(input2.p2, input2.p1);
        var c2 = Vec2.dot(s2, r);
        var rr = Vec2.dot(r, r);
        var sigma = c2 * c2 - rr * b2;
        if (sigma < 0 || rr < EPSILON) {
          return false;
        }
        var a2 = -(c2 + math_sqrt(sigma));
        if (0 <= a2 && a2 <= input2.maxFraction * rr) {
          a2 /= rr;
          output2.fraction = a2;
          output2.normal = Vec2.add(s2, Vec2.mulNumVec2(a2, r));
          output2.normal.normalize();
          return true;
        }
        return false;
      };
      CircleShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        var p = transformVec2(temp, xf2, this.m_p);
        setVec2(aabb.lowerBound, p.x - this.m_radius, p.y - this.m_radius);
        setVec2(aabb.upperBound, p.x + this.m_radius, p.y + this.m_radius);
      };
      CircleShape2.prototype.computeMass = function(massData, density) {
        massData.mass = density * math_PI$4 * this.m_radius * this.m_radius;
        copyVec2(massData.center, this.m_p);
        massData.I = massData.mass * (0.5 * this.m_radius * this.m_radius + lengthSqrVec2(this.m_p));
      };
      CircleShape2.prototype.computeDistanceProxy = function(proxy) {
        proxy.m_vertices[0] = this.m_p;
        proxy.m_vertices.length = 1;
        proxy.m_count = 1;
        proxy.m_radius = this.m_radius;
      };
      CircleShape2.TYPE = "circle";
      return CircleShape2;
    }(Shape)
  );
  var math_abs$5 = Math.abs;
  var math_PI$3 = Math.PI;
  var DEFAULTS$a = {
    frequencyHz: 0,
    dampingRatio: 0
  };
  var DistanceJoint = (
    /** @class */
    function(_super) {
      __extends(DistanceJoint2, _super);
      function DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB) {
        var _this = this;
        if (!(_this instanceof DistanceJoint2)) {
          return new DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB);
        }
        if (bodyB && anchorA && "m_type" in anchorA && "x" in bodyB && "y" in bodyB) {
          var temp3 = bodyB;
          bodyB = anchorA;
          anchorA = temp3;
        }
        def = options(def, DEFAULTS$a);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = DistanceJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.zero());
        _this.m_length = Number.isFinite(def.length) ? def.length : Vec2.distance(bodyA.getWorldPoint(_this.m_localAnchorA), bodyB.getWorldPoint(_this.m_localAnchorB));
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_impulse = 0;
        _this.m_gamma = 0;
        _this.m_bias = 0;
        return _this;
      }
      DistanceJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          length: this.m_length,
          impulse: this.m_impulse,
          gamma: this.m_gamma,
          bias: this.m_bias
        };
      };
      DistanceJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new DistanceJoint2(data);
        return joint;
      };
      DistanceJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.length > 0) {
          this.m_length = +def.length;
        } else if (def.length < 0) ;
        else if (def.anchorA || def.anchorA || def.anchorA || def.anchorA) {
          this.m_length = Vec2.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA), this.m_bodyB.getWorldPoint(this.m_localAnchorB));
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      DistanceJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      DistanceJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      DistanceJoint2.prototype.setLength = function(length) {
        this.m_length = length;
      };
      DistanceJoint2.prototype.getLength = function() {
        return this.m_length;
      };
      DistanceJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      DistanceJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      DistanceJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      DistanceJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      DistanceJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      DistanceJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      DistanceJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);
      };
      DistanceJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      DistanceJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        this.m_u = Vec2.sub(Vec2.add(cB2, this.m_rB), Vec2.add(cA2, this.m_rA));
        var length = this.m_u.length();
        if (length > SettingsInternal.linearSlop) {
          this.m_u.mul(1 / length);
        } else {
          this.m_u.setNum(0, 0);
        }
        var crAu = Vec2.crossVec2Vec2(this.m_rA, this.m_u);
        var crBu = Vec2.crossVec2Vec2(this.m_rB, this.m_u);
        var invMass = this.m_invMassA + this.m_invIA * crAu * crAu + this.m_invMassB + this.m_invIB * crBu * crBu;
        this.m_mass = invMass != 0 ? 1 / invMass : 0;
        if (this.m_frequencyHz > 0) {
          var C = length - this.m_length;
          var omega = 2 * math_PI$3 * this.m_frequencyHz;
          var d2 = 2 * this.m_mass * this.m_dampingRatio * omega;
          var k = this.m_mass * omega * omega;
          var h = step.dt;
          this.m_gamma = h * (d2 + h * k);
          this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;
          this.m_bias = C * h * k * this.m_gamma;
          invMass += this.m_gamma;
          this.m_mass = invMass != 0 ? 1 / invMass : 0;
        } else {
          this.m_gamma = 0;
          this.m_bias = 0;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      DistanceJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));
        var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));
        var Cdot = Vec2.dot(this.m_u, vpB) - Vec2.dot(this.m_u, vpA);
        var impulse = -this.m_mass * (Cdot + this.m_bias + this.m_gamma * this.m_impulse);
        this.m_impulse += impulse;
        var P3 = Vec2.mulNumVec2(impulse, this.m_u);
        vA2.subMul(this.m_invMassA, P3);
        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
        vB2.addMul(this.m_invMassB, P3);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      DistanceJoint2.prototype.solvePositionConstraints = function(step) {
        if (this.m_frequencyHz > 0) {
          return true;
        }
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        var u = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));
        var length = u.normalize();
        var C = clamp(length - this.m_length, -SettingsInternal.maxLinearCorrection, SettingsInternal.maxLinearCorrection);
        var impulse = -this.m_mass * C;
        var P3 = Vec2.mulNumVec2(impulse, u);
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return math_abs$5(C) < SettingsInternal.linearSlop;
      };
      DistanceJoint2.TYPE = "distance-joint";
      return DistanceJoint2;
    }(Joint)
  );
  var DEFAULTS$9 = {
    maxForce: 0,
    maxTorque: 0
  };
  var FrictionJoint = (
    /** @class */
    function(_super) {
      __extends(FrictionJoint2, _super);
      function FrictionJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof FrictionJoint2)) {
          return new FrictionJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$9);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = FrictionJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_linearImpulse = Vec2.zero();
        _this.m_angularImpulse = 0;
        _this.m_maxForce = def.maxForce;
        _this.m_maxTorque = def.maxTorque;
        return _this;
      }
      FrictionJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          maxForce: this.m_maxForce,
          maxTorque: this.m_maxTorque,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB
        };
      };
      FrictionJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new FrictionJoint2(data);
        return joint;
      };
      FrictionJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.maxTorque)) {
          this.m_maxTorque = def.maxTorque;
        }
      };
      FrictionJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      FrictionJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      FrictionJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      FrictionJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      FrictionJoint2.prototype.setMaxTorque = function(torque) {
        this.m_maxTorque = torque;
      };
      FrictionJoint2.prototype.getMaxTorque = function() {
        return this.m_maxTorque;
      };
      FrictionJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      FrictionJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      FrictionJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);
      };
      FrictionJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_angularImpulse;
      };
      FrictionJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat22();
        K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;
        K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;
        this.m_linearMass = K.getInverse();
        this.m_angularMass = iA + iB;
        if (this.m_angularMass > 0) {
          this.m_angularMass = 1 / this.m_angularMass;
        }
        if (step.warmStarting) {
          this.m_linearImpulse.mul(step.dtRatio);
          this.m_angularImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);
        } else {
          this.m_linearImpulse.setZero();
          this.m_angularImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      FrictionJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var h = step.dt;
        {
          var Cdot = wB - wA;
          var impulse = -this.m_angularMass * Cdot;
          var oldImpulse = this.m_angularImpulse;
          var maxImpulse = h * this.m_maxTorque;
          this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_angularImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.sub(Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB)), Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA)));
          var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));
          var oldImpulse = this.m_linearImpulse;
          this.m_linearImpulse.add(impulse);
          var maxImpulse = h * this.m_maxForce;
          if (this.m_linearImpulse.lengthSquared() > maxImpulse * maxImpulse) {
            this.m_linearImpulse.normalize();
            this.m_linearImpulse.mul(maxImpulse);
          }
          impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      FrictionJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      FrictionJoint2.TYPE = "friction-joint";
      return FrictionJoint2;
    }(Joint)
  );
  var Mat33 = (
    /** @class */
    function() {
      function Mat332(a2, b2, c2) {
        if (typeof a2 === "object" && a2 !== null) {
          this.ex = Vec3.clone(a2);
          this.ey = Vec3.clone(b2);
          this.ez = Vec3.clone(c2);
        } else {
          this.ex = Vec3.zero();
          this.ey = Vec3.zero();
          this.ez = Vec3.zero();
        }
      }
      Mat332.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Mat332.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec3.isValid(obj.ex) && Vec3.isValid(obj.ey) && Vec3.isValid(obj.ez);
      };
      Mat332.assert = function(o) {
      };
      Mat332.prototype.setZero = function() {
        this.ex.setZero();
        this.ey.setZero();
        this.ez.setZero();
        return this;
      };
      Mat332.prototype.solve33 = function(v3) {
        var cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;
        var cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;
        var cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;
        var det = this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z;
        if (det !== 0) {
          det = 1 / det;
        }
        var r = new Vec3();
        cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;
        cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;
        cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;
        r.x = det * (v3.x * cross_x + v3.y * cross_y + v3.z * cross_z);
        cross_x = v3.y * this.ez.z - v3.z * this.ez.y;
        cross_y = v3.z * this.ez.x - v3.x * this.ez.z;
        cross_z = v3.x * this.ez.y - v3.y * this.ez.x;
        r.y = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);
        cross_x = this.ey.y * v3.z - this.ey.z * v3.y;
        cross_y = this.ey.z * v3.x - this.ey.x * v3.z;
        cross_z = this.ey.x * v3.y - this.ey.y * v3.x;
        r.z = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);
        return r;
      };
      Mat332.prototype.solve22 = function(v3) {
        var a11 = this.ex.x;
        var a12 = this.ey.x;
        var a21 = this.ex.y;
        var a22 = this.ey.y;
        var det = a11 * a22 - a12 * a21;
        if (det !== 0) {
          det = 1 / det;
        }
        var r = Vec2.zero();
        r.x = det * (a22 * v3.x - a12 * v3.y);
        r.y = det * (a11 * v3.y - a21 * v3.x);
        return r;
      };
      Mat332.prototype.getInverse22 = function(M) {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        M.ex.x = det * d2;
        M.ey.x = -det * b2;
        M.ex.z = 0;
        M.ex.y = -det * c2;
        M.ey.y = det * a2;
        M.ey.z = 0;
        M.ez.x = 0;
        M.ez.y = 0;
        M.ez.z = 0;
      };
      Mat332.prototype.getSymInverse33 = function(M) {
        var det = Vec3.dot(this.ex, Vec3.cross(this.ey, this.ez));
        if (det !== 0) {
          det = 1 / det;
        }
        var a11 = this.ex.x;
        var a12 = this.ey.x;
        var a13 = this.ez.x;
        var a22 = this.ey.y;
        var a23 = this.ez.y;
        var a33 = this.ez.z;
        M.ex.x = det * (a22 * a33 - a23 * a23);
        M.ex.y = det * (a13 * a23 - a12 * a33);
        M.ex.z = det * (a12 * a23 - a13 * a22);
        M.ey.x = M.ex.y;
        M.ey.y = det * (a11 * a33 - a13 * a13);
        M.ey.z = det * (a13 * a12 - a11 * a23);
        M.ez.x = M.ex.z;
        M.ez.y = M.ey.z;
        M.ez.z = det * (a11 * a22 - a12 * a12);
      };
      Mat332.mul = function(a2, b2) {
        if (b2 && "z" in b2 && "y" in b2 && "x" in b2) {
          var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;
          var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;
          var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;
          return new Vec3(x2, y, z);
        } else if (b2 && "y" in b2 && "x" in b2) {
          var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;
          var y = a2.ex.y * b2.x + a2.ey.y * b2.y;
          return Vec2.neo(x2, y);
        }
      };
      Mat332.mulVec3 = function(a2, b2) {
        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;
        var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;
        var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;
        return new Vec3(x2, y, z);
      };
      Mat332.mulVec2 = function(a2, b2) {
        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;
        var y = a2.ex.y * b2.x + a2.ey.y * b2.y;
        return Vec2.neo(x2, y);
      };
      Mat332.add = function(a2, b2) {
        return new Mat332(Vec3.add(a2.ex, b2.ex), Vec3.add(a2.ey, b2.ey), Vec3.add(a2.ez, b2.ez));
      };
      return Mat332;
    }()
  );
  var math_abs$4 = Math.abs;
  var LimitState$2;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState$2 || (LimitState$2 = {}));
  var DEFAULTS$8 = {
    lowerAngle: 0,
    upperAngle: 0,
    maxMotorTorque: 0,
    motorSpeed: 0,
    enableLimit: false,
    enableMotor: false
  };
  var RevoluteJoint = (
    /** @class */
    function(_super) {
      __extends(RevoluteJoint2, _super);
      function RevoluteJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        var _a2, _b, _c, _d, _e, _f;
        if (!(_this instanceof RevoluteJoint2)) {
          return new RevoluteJoint2(def, bodyA, bodyB, anchor);
        }
        def = def !== null && def !== void 0 ? def : {};
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_mass = new Mat33();
        _this.m_limitState = LimitState$2.inactiveLimit;
        _this.m_type = RevoluteJoint2.TYPE;
        if (Vec2.isValid(anchor)) {
          _this.m_localAnchorA = bodyA.getLocalPoint(anchor);
        } else if (Vec2.isValid(def.localAnchorA)) {
          _this.m_localAnchorA = Vec2.clone(def.localAnchorA);
        } else {
          _this.m_localAnchorA = Vec2.zero();
        }
        if (Vec2.isValid(anchor)) {
          _this.m_localAnchorB = bodyB.getLocalPoint(anchor);
        } else if (Vec2.isValid(def.localAnchorB)) {
          _this.m_localAnchorB = Vec2.clone(def.localAnchorB);
        } else {
          _this.m_localAnchorB = Vec2.zero();
        }
        if (Number.isFinite(def.referenceAngle)) {
          _this.m_referenceAngle = def.referenceAngle;
        } else {
          _this.m_referenceAngle = bodyB.getAngle() - bodyA.getAngle();
        }
        _this.m_impulse = new Vec3();
        _this.m_motorImpulse = 0;
        _this.m_lowerAngle = (_a2 = def.lowerAngle) !== null && _a2 !== void 0 ? _a2 : DEFAULTS$8.lowerAngle;
        _this.m_upperAngle = (_b = def.upperAngle) !== null && _b !== void 0 ? _b : DEFAULTS$8.upperAngle;
        _this.m_maxMotorTorque = (_c = def.maxMotorTorque) !== null && _c !== void 0 ? _c : DEFAULTS$8.maxMotorTorque;
        _this.m_motorSpeed = (_d = def.motorSpeed) !== null && _d !== void 0 ? _d : DEFAULTS$8.motorSpeed;
        _this.m_enableLimit = (_e = def.enableLimit) !== null && _e !== void 0 ? _e : DEFAULTS$8.enableLimit;
        _this.m_enableMotor = (_f = def.enableMotor) !== null && _f !== void 0 ? _f : DEFAULTS$8.enableMotor;
        return _this;
      }
      RevoluteJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          lowerAngle: this.m_lowerAngle,
          upperAngle: this.m_upperAngle,
          maxMotorTorque: this.m_maxMotorTorque,
          motorSpeed: this.m_motorSpeed,
          enableLimit: this.m_enableLimit,
          enableMotor: this.m_enableMotor,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          referenceAngle: this.m_referenceAngle
        };
      };
      RevoluteJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new RevoluteJoint2(data);
        return joint;
      };
      RevoluteJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.referenceAngle)) {
          this.m_referenceAngle = def.referenceAngle;
        }
        if (def.enableLimit !== void 0) {
          this.m_enableLimit = def.enableLimit;
        }
        if (Number.isFinite(def.lowerAngle)) {
          this.m_lowerAngle = def.lowerAngle;
        }
        if (Number.isFinite(def.upperAngle)) {
          this.m_upperAngle = def.upperAngle;
        }
        if (Number.isFinite(def.maxMotorTorque)) {
          this.m_maxMotorTorque = def.maxMotorTorque;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
        if (def.enableMotor !== void 0) {
          this.m_enableMotor = def.enableMotor;
        }
      };
      RevoluteJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      RevoluteJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      RevoluteJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      RevoluteJoint2.prototype.getJointAngle = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        return bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
      };
      RevoluteJoint2.prototype.getJointSpeed = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        return bB.m_angularVelocity - bA.m_angularVelocity;
      };
      RevoluteJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      RevoluteJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      RevoluteJoint2.prototype.getMotorTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      RevoluteJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      RevoluteJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      RevoluteJoint2.prototype.setMaxMotorTorque = function(torque) {
        if (torque == this.m_maxMotorTorque)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorTorque = torque;
      };
      RevoluteJoint2.prototype.getMaxMotorTorque = function() {
        return this.m_maxMotorTorque;
      };
      RevoluteJoint2.prototype.isLimitEnabled = function() {
        return this.m_enableLimit;
      };
      RevoluteJoint2.prototype.enableLimit = function(flag) {
        if (flag != this.m_enableLimit) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_enableLimit = flag;
          this.m_impulse.z = 0;
        }
      };
      RevoluteJoint2.prototype.getLowerLimit = function() {
        return this.m_lowerAngle;
      };
      RevoluteJoint2.prototype.getUpperLimit = function() {
        return this.m_upperAngle;
      };
      RevoluteJoint2.prototype.setLimits = function(lower, upper) {
        if (lower != this.m_lowerAngle || upper != this.m_upperAngle) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_impulse.z = 0;
          this.m_lowerAngle = lower;
          this.m_upperAngle = upper;
        }
      };
      RevoluteJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      RevoluteJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      RevoluteJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);
      };
      RevoluteJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.z;
      };
      RevoluteJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var fixedRotation = iA + iB === 0;
        this.m_mass.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;
        this.m_mass.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;
        this.m_mass.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;
        this.m_mass.ex.y = this.m_mass.ey.x;
        this.m_mass.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;
        this.m_mass.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;
        this.m_mass.ex.z = this.m_mass.ez.x;
        this.m_mass.ey.z = this.m_mass.ez.y;
        this.m_mass.ez.z = iA + iB;
        this.m_motorMass = iA + iB;
        if (this.m_motorMass > 0) {
          this.m_motorMass = 1 / this.m_motorMass;
        }
        if (this.m_enableMotor == false || fixedRotation) {
          this.m_motorImpulse = 0;
        }
        if (this.m_enableLimit && fixedRotation == false) {
          var jointAngle = aB - aA - this.m_referenceAngle;
          if (math_abs$4(this.m_upperAngle - this.m_lowerAngle) < 2 * SettingsInternal.angularSlop) {
            this.m_limitState = LimitState$2.equalLimits;
          } else if (jointAngle <= this.m_lowerAngle) {
            if (this.m_limitState != LimitState$2.atLowerLimit) {
              this.m_impulse.z = 0;
            }
            this.m_limitState = LimitState$2.atLowerLimit;
          } else if (jointAngle >= this.m_upperAngle) {
            if (this.m_limitState != LimitState$2.atUpperLimit) {
              this.m_impulse.z = 0;
            }
            this.m_limitState = LimitState$2.atUpperLimit;
          } else {
            this.m_limitState = LimitState$2.inactiveLimit;
            this.m_impulse.z = 0;
          }
        } else {
          this.m_limitState = LimitState$2.inactiveLimit;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_motorImpulse + this.m_impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_motorImpulse + this.m_impulse.z);
        } else {
          this.m_impulse.setZero();
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RevoluteJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var fixedRotation = iA + iB === 0;
        if (this.m_enableMotor && this.m_limitState != LimitState$2.equalLimits && fixedRotation == false) {
          var Cdot = wB - wA - this.m_motorSpeed;
          var impulse = -this.m_motorMass * Cdot;
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorTorque;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var Cdot2 = wB - wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var impulse = Vec3.neg(this.m_mass.solve33(Cdot));
          if (this.m_limitState == LimitState$2.equalLimits) {
            this.m_impulse.add(impulse);
          } else if (this.m_limitState == LimitState$2.atLowerLimit) {
            var newImpulse = this.m_impulse.z + impulse.z;
            if (newImpulse < 0) {
              var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));
              var reduced = this.m_mass.solve22(rhs);
              impulse.x = reduced.x;
              impulse.y = reduced.y;
              impulse.z = -this.m_impulse.z;
              this.m_impulse.x += reduced.x;
              this.m_impulse.y += reduced.y;
              this.m_impulse.z = 0;
            } else {
              this.m_impulse.add(impulse);
            }
          } else if (this.m_limitState == LimitState$2.atUpperLimit) {
            var newImpulse = this.m_impulse.z + impulse.z;
            if (newImpulse > 0) {
              var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));
              var reduced = this.m_mass.solve22(rhs);
              impulse.x = reduced.x;
              impulse.y = reduced.y;
              impulse.z = -this.m_impulse.z;
              this.m_impulse.x += reduced.x;
              this.m_impulse.y += reduced.y;
              this.m_impulse.z = 0;
            } else {
              this.m_impulse.add(impulse);
            }
          }
          var P3 = Vec2.neo(impulse.x, impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);
        } else {
          var Cdot = Vec2.zero();
          Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var impulse = this.m_mass.solve22(Vec2.neg(Cdot));
          this.m_impulse.x += impulse.x;
          this.m_impulse.y += impulse.y;
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RevoluteJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var angularError = 0;
        var positionError = 0;
        var fixedRotation = this.m_invIA + this.m_invIB == 0;
        if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {
          var angle = aB - aA - this.m_referenceAngle;
          var limitImpulse = 0;
          if (this.m_limitState == LimitState$2.equalLimits) {
            var C = clamp(angle - this.m_lowerAngle, -SettingsInternal.maxAngularCorrection, SettingsInternal.maxAngularCorrection);
            limitImpulse = -this.m_motorMass * C;
            angularError = math_abs$4(C);
          } else if (this.m_limitState == LimitState$2.atLowerLimit) {
            var C = angle - this.m_lowerAngle;
            angularError = -C;
            C = clamp(C + SettingsInternal.angularSlop, -SettingsInternal.maxAngularCorrection, 0);
            limitImpulse = -this.m_motorMass * C;
          } else if (this.m_limitState == LimitState$2.atUpperLimit) {
            var C = angle - this.m_upperAngle;
            angularError = C;
            C = clamp(C - SettingsInternal.angularSlop, 0, SettingsInternal.maxAngularCorrection);
            limitImpulse = -this.m_motorMass * C;
          }
          aA -= this.m_invIA * limitImpulse;
          aB += this.m_invIB * limitImpulse;
        }
        {
          qA.setAngle(aA);
          qB.setAngle(aB);
          var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
          var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
          var C = Vec2.zero();
          C.addCombine(1, cB2, 1, rB2);
          C.subCombine(1, cA2, 1, rA2);
          positionError = C.length();
          var mA = this.m_invMassA;
          var mB = this.m_invMassB;
          var iA = this.m_invIA;
          var iB = this.m_invIB;
          var K = new Mat22();
          K.ex.x = mA + mB + iA * rA2.y * rA2.y + iB * rB2.y * rB2.y;
          K.ex.y = -iA * rA2.x * rA2.y - iB * rB2.x * rB2.y;
          K.ey.x = K.ex.y;
          K.ey.y = mA + mB + iA * rA2.x * rA2.x + iB * rB2.x * rB2.x;
          var impulse = Vec2.neg(K.solve(C));
          cA2.subMul(mA, impulse);
          aA -= iA * Vec2.crossVec2Vec2(rA2, impulse);
          cB2.addMul(mB, impulse);
          aB += iB * Vec2.crossVec2Vec2(rB2, impulse);
        }
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      RevoluteJoint2.TYPE = "revolute-joint";
      return RevoluteJoint2;
    }(Joint)
  );
  var math_abs$3 = Math.abs;
  var math_max = Math.max;
  var math_min$2 = Math.min;
  var LimitState$1;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState$1 || (LimitState$1 = {}));
  var DEFAULTS$7 = {
    enableLimit: false,
    lowerTranslation: 0,
    upperTranslation: 0,
    enableMotor: false,
    maxMotorForce: 0,
    motorSpeed: 0
  };
  var PrismaticJoint = (
    /** @class */
    function(_super) {
      __extends(PrismaticJoint2, _super);
      function PrismaticJoint2(def, bodyA, bodyB, anchor, axis) {
        var _this = this;
        if (!(_this instanceof PrismaticJoint2)) {
          return new PrismaticJoint2(def, bodyA, bodyB, anchor, axis);
        }
        def = options(def, DEFAULTS$7);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = PrismaticJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_localXAxisA = Vec2.clone(axis ? bodyA.getLocalVector(axis) : def.localAxisA || Vec2.neo(1, 0));
        _this.m_localXAxisA.normalize();
        _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);
        _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();
        _this.m_impulse = new Vec3();
        _this.m_motorMass = 0;
        _this.m_motorImpulse = 0;
        _this.m_lowerTranslation = def.lowerTranslation;
        _this.m_upperTranslation = def.upperTranslation;
        _this.m_maxMotorForce = def.maxMotorForce;
        _this.m_motorSpeed = def.motorSpeed;
        _this.m_enableLimit = def.enableLimit;
        _this.m_enableMotor = def.enableMotor;
        _this.m_limitState = LimitState$1.inactiveLimit;
        _this.m_axis = Vec2.zero();
        _this.m_perp = Vec2.zero();
        _this.m_K = new Mat33();
        return _this;
      }
      PrismaticJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          lowerTranslation: this.m_lowerTranslation,
          upperTranslation: this.m_upperTranslation,
          maxMotorForce: this.m_maxMotorForce,
          motorSpeed: this.m_motorSpeed,
          enableLimit: this.m_enableLimit,
          enableMotor: this.m_enableMotor,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          localAxisA: this.m_localXAxisA,
          referenceAngle: this.m_referenceAngle
        };
      };
      PrismaticJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.localAxisA = Vec2.clone(data.localAxisA);
        var joint = new PrismaticJoint2(data);
        return joint;
      };
      PrismaticJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.localAxisA) {
          this.m_localXAxisA.setVec2(def.localAxisA);
          this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));
        }
        if (Number.isFinite(def.referenceAngle)) {
          this.m_referenceAngle = def.referenceAngle;
        }
        if (typeof def.enableLimit !== "undefined") {
          this.m_enableLimit = !!def.enableLimit;
        }
        if (Number.isFinite(def.lowerTranslation)) {
          this.m_lowerTranslation = def.lowerTranslation;
        }
        if (Number.isFinite(def.upperTranslation)) {
          this.m_upperTranslation = def.upperTranslation;
        }
        if (typeof def.enableMotor !== "undefined") {
          this.m_enableMotor = !!def.enableMotor;
        }
        if (Number.isFinite(def.maxMotorForce)) {
          this.m_maxMotorForce = def.maxMotorForce;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
      };
      PrismaticJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      PrismaticJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      PrismaticJoint2.prototype.getLocalAxisA = function() {
        return this.m_localXAxisA;
      };
      PrismaticJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      PrismaticJoint2.prototype.getJointTranslation = function() {
        var pA2 = this.m_bodyA.getWorldPoint(this.m_localAnchorA);
        var pB2 = this.m_bodyB.getWorldPoint(this.m_localAnchorB);
        var d2 = Vec2.sub(pB2, pA2);
        var axis = this.m_bodyA.getWorldVector(this.m_localXAxisA);
        var translation2 = Vec2.dot(d2, axis);
        return translation2;
      };
      PrismaticJoint2.prototype.getJointSpeed = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        var rA2 = Rot.mulVec2(bA.m_xf.q, Vec2.sub(this.m_localAnchorA, bA.m_sweep.localCenter));
        var rB2 = Rot.mulVec2(bB.m_xf.q, Vec2.sub(this.m_localAnchorB, bB.m_sweep.localCenter));
        var p1 = Vec2.add(bA.m_sweep.c, rA2);
        var p2 = Vec2.add(bB.m_sweep.c, rB2);
        var d2 = Vec2.sub(p2, p1);
        var axis = Rot.mulVec2(bA.m_xf.q, this.m_localXAxisA);
        var vA2 = bA.m_linearVelocity;
        var vB2 = bB.m_linearVelocity;
        var wA = bA.m_angularVelocity;
        var wB = bB.m_angularVelocity;
        var speed = Vec2.dot(d2, Vec2.crossNumVec2(wA, axis)) + Vec2.dot(axis, Vec2.sub(Vec2.addCrossNumVec2(vB2, wB, rB2), Vec2.addCrossNumVec2(vA2, wA, rA2)));
        return speed;
      };
      PrismaticJoint2.prototype.isLimitEnabled = function() {
        return this.m_enableLimit;
      };
      PrismaticJoint2.prototype.enableLimit = function(flag) {
        if (flag != this.m_enableLimit) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_enableLimit = flag;
          this.m_impulse.z = 0;
        }
      };
      PrismaticJoint2.prototype.getLowerLimit = function() {
        return this.m_lowerTranslation;
      };
      PrismaticJoint2.prototype.getUpperLimit = function() {
        return this.m_upperTranslation;
      };
      PrismaticJoint2.prototype.setLimits = function(lower, upper) {
        if (lower != this.m_lowerTranslation || upper != this.m_upperTranslation) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_lowerTranslation = lower;
          this.m_upperTranslation = upper;
          this.m_impulse.z = 0;
        }
      };
      PrismaticJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      PrismaticJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      PrismaticJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      PrismaticJoint2.prototype.setMaxMotorForce = function(force) {
        if (force == this.m_maxMotorForce)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorForce = force;
      };
      PrismaticJoint2.prototype.getMaxMotorForce = function() {
        return this.m_maxMotorForce;
      };
      PrismaticJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      PrismaticJoint2.prototype.getMotorForce = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      PrismaticJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      PrismaticJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      PrismaticJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis).mul(inv_dt);
      };
      PrismaticJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.y;
      };
      PrismaticJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        {
          this.m_axis = Rot.mulVec2(qA, this.m_localXAxisA);
          this.m_a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_axis);
          this.m_a2 = Vec2.crossVec2Vec2(rB2, this.m_axis);
          this.m_motorMass = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;
          if (this.m_motorMass > 0) {
            this.m_motorMass = 1 / this.m_motorMass;
          }
        }
        {
          this.m_perp = Rot.mulVec2(qA, this.m_localYAxisA);
          this.m_s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_perp);
          this.m_s2 = Vec2.crossVec2Vec2(rB2, this.m_perp);
          Vec2.crossVec2Vec2(rA2, this.m_perp);
          var k11 = mA + mB + iA * this.m_s1 * this.m_s1 + iB * this.m_s2 * this.m_s2;
          var k12 = iA * this.m_s1 + iB * this.m_s2;
          var k13 = iA * this.m_s1 * this.m_a1 + iB * this.m_s2 * this.m_a2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var k23 = iA * this.m_a1 + iB * this.m_a2;
          var k33 = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;
          this.m_K.ex.set(k11, k12, k13);
          this.m_K.ey.set(k12, k22, k23);
          this.m_K.ez.set(k13, k23, k33);
        }
        if (this.m_enableLimit) {
          var jointTranslation = Vec2.dot(this.m_axis, d2);
          if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * SettingsInternal.linearSlop) {
            this.m_limitState = LimitState$1.equalLimits;
          } else if (jointTranslation <= this.m_lowerTranslation) {
            if (this.m_limitState != LimitState$1.atLowerLimit) {
              this.m_limitState = LimitState$1.atLowerLimit;
              this.m_impulse.z = 0;
            }
          } else if (jointTranslation >= this.m_upperTranslation) {
            if (this.m_limitState != LimitState$1.atUpperLimit) {
              this.m_limitState = LimitState$1.atUpperLimit;
              this.m_impulse.z = 0;
            }
          } else {
            this.m_limitState = LimitState$1.inactiveLimit;
            this.m_impulse.z = 0;
          }
        } else {
          this.m_limitState = LimitState$1.inactiveLimit;
          this.m_impulse.z = 0;
        }
        if (this.m_enableMotor == false) {
          this.m_motorImpulse = 0;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis);
          var LA = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1;
          var LB = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        } else {
          this.m_impulse.setZero();
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      PrismaticJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        if (this.m_enableMotor && this.m_limitState != LimitState$1.equalLimits) {
          var Cdot = Vec2.dot(this.m_axis, Vec2.sub(vB2, vA2)) + this.m_a2 * wB - this.m_a1 * wA;
          var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorForce;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_axis);
          var LA = impulse * this.m_a1;
          var LB = impulse * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        var Cdot1 = Vec2.zero();
        Cdot1.x += Vec2.dot(this.m_perp, vB2) + this.m_s2 * wB;
        Cdot1.x -= Vec2.dot(this.m_perp, vA2) + this.m_s1 * wA;
        Cdot1.y = wB - wA;
        if (this.m_enableLimit && this.m_limitState != LimitState$1.inactiveLimit) {
          var Cdot2 = 0;
          Cdot2 += Vec2.dot(this.m_axis, vB2) + this.m_a2 * wB;
          Cdot2 -= Vec2.dot(this.m_axis, vA2) + this.m_a1 * wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var f1 = Vec3.clone(this.m_impulse);
          var df = this.m_K.solve33(Vec3.neg(Cdot));
          this.m_impulse.add(df);
          if (this.m_limitState == LimitState$1.atLowerLimit) {
            this.m_impulse.z = math_max(this.m_impulse.z, 0);
          } else if (this.m_limitState == LimitState$1.atUpperLimit) {
            this.m_impulse.z = math_min$2(this.m_impulse.z, 0);
          }
          var b2 = Vec2.combine(-1, Cdot1, -(this.m_impulse.z - f1.z), Vec2.neo(this.m_K.ez.x, this.m_K.ez.y));
          var f2r = Vec2.add(this.m_K.solve22(b2), Vec2.neo(f1.x, f1.y));
          this.m_impulse.x = f2r.x;
          this.m_impulse.y = f2r.y;
          df = Vec3.sub(this.m_impulse, f1);
          var P3 = Vec2.combine(df.x, this.m_perp, df.z, this.m_axis);
          var LA = df.x * this.m_s1 + df.y + df.z * this.m_a1;
          var LB = df.x * this.m_s2 + df.y + df.z * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        } else {
          var df = this.m_K.solve22(Vec2.neg(Cdot1));
          this.m_impulse.x += df.x;
          this.m_impulse.y += df.y;
          var P3 = Vec2.mulNumVec2(df.x, this.m_perp);
          var LA = df.x * this.m_s1 + df.y;
          var LB = df.x * this.m_s2 + df.y;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PrismaticJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));
        var axis = Rot.mulVec2(qA, this.m_localXAxisA);
        var a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), axis);
        var a2 = Vec2.crossVec2Vec2(rB2, axis);
        var perp2 = Rot.mulVec2(qA, this.m_localYAxisA);
        var s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), perp2);
        var s2 = Vec2.crossVec2Vec2(rB2, perp2);
        var impulse = new Vec3();
        var C1 = Vec2.zero();
        C1.x = Vec2.dot(perp2, d2);
        C1.y = aB - aA - this.m_referenceAngle;
        var linearError = math_abs$3(C1.x);
        var angularError = math_abs$3(C1.y);
        var linearSlop = SettingsInternal.linearSlop;
        var maxLinearCorrection = SettingsInternal.maxLinearCorrection;
        var active = false;
        var C2 = 0;
        if (this.m_enableLimit) {
          var translation2 = Vec2.dot(axis, d2);
          if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * linearSlop) {
            C2 = clamp(translation2, -maxLinearCorrection, maxLinearCorrection);
            linearError = math_max(linearError, math_abs$3(translation2));
            active = true;
          } else if (translation2 <= this.m_lowerTranslation) {
            C2 = clamp(translation2 - this.m_lowerTranslation + linearSlop, -maxLinearCorrection, 0);
            linearError = Math.max(linearError, this.m_lowerTranslation - translation2);
            active = true;
          } else if (translation2 >= this.m_upperTranslation) {
            C2 = clamp(translation2 - this.m_upperTranslation - linearSlop, 0, maxLinearCorrection);
            linearError = Math.max(linearError, translation2 - this.m_upperTranslation);
            active = true;
          }
        }
        if (active) {
          var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;
          var k12 = iA * s1 + iB * s2;
          var k13 = iA * s1 * a1 + iB * s2 * a2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var k23 = iA * a1 + iB * a2;
          var k33 = mA + mB + iA * a1 * a1 + iB * a2 * a2;
          var K = new Mat33();
          K.ex.set(k11, k12, k13);
          K.ey.set(k12, k22, k23);
          K.ez.set(k13, k23, k33);
          var C = new Vec3();
          C.x = C1.x;
          C.y = C1.y;
          C.z = C2;
          impulse = K.solve33(Vec3.neg(C));
        } else {
          var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;
          var k12 = iA * s1 + iB * s2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var K = new Mat22();
          K.ex.setNum(k11, k12);
          K.ey.setNum(k12, k22);
          var impulse1 = K.solve(Vec2.neg(C1));
          impulse.x = impulse1.x;
          impulse.y = impulse1.y;
          impulse.z = 0;
        }
        var P3 = Vec2.combine(impulse.x, perp2, impulse.z, axis);
        var LA = impulse.x * s1 + impulse.y + impulse.z * a1;
        var LB = impulse.x * s2 + impulse.y + impulse.z * a2;
        cA2.subMul(mA, P3);
        aA -= iA * LA;
        cB2.addMul(mB, P3);
        aB += iB * LB;
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return linearError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      PrismaticJoint2.TYPE = "prismatic-joint";
      return PrismaticJoint2;
    }(Joint)
  );
  var DEFAULTS$6 = {
    ratio: 1
  };
  var GearJoint = (
    /** @class */
    function(_super) {
      __extends(GearJoint2, _super);
      function GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio) {
        var _this = this;
        if (!(_this instanceof GearJoint2)) {
          return new GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio);
        }
        def = options(def, DEFAULTS$6);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = GearJoint2.TYPE;
        _this.m_joint1 = joint1 ? joint1 : def.joint1;
        _this.m_joint2 = joint2 ? joint2 : def.joint2;
        _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;
        _this.m_type1 = _this.m_joint1.getType();
        _this.m_type2 = _this.m_joint2.getType();
        var coordinateA;
        var coordinateB;
        _this.m_bodyC = _this.m_joint1.getBodyA();
        _this.m_bodyA = _this.m_joint1.getBodyB();
        var xfA2 = _this.m_bodyA.m_xf;
        var aA = _this.m_bodyA.m_sweep.a;
        var xfC = _this.m_bodyC.m_xf;
        var aC = _this.m_bodyC.m_sweep.a;
        if (_this.m_type1 === RevoluteJoint.TYPE) {
          var revolute = _this.m_joint1;
          _this.m_localAnchorC = revolute.m_localAnchorA;
          _this.m_localAnchorA = revolute.m_localAnchorB;
          _this.m_referenceAngleA = revolute.m_referenceAngle;
          _this.m_localAxisC = Vec2.zero();
          coordinateA = aA - aC - _this.m_referenceAngleA;
        } else {
          var prismatic = _this.m_joint1;
          _this.m_localAnchorC = prismatic.m_localAnchorA;
          _this.m_localAnchorA = prismatic.m_localAnchorB;
          _this.m_referenceAngleA = prismatic.m_referenceAngle;
          _this.m_localAxisC = prismatic.m_localXAxisA;
          var pC = _this.m_localAnchorC;
          var pA2 = Rot.mulTVec2(xfC.q, Vec2.add(Rot.mulVec2(xfA2.q, _this.m_localAnchorA), Vec2.sub(xfA2.p, xfC.p)));
          coordinateA = Vec2.dot(pA2, _this.m_localAxisC) - Vec2.dot(pC, _this.m_localAxisC);
        }
        _this.m_bodyD = _this.m_joint2.getBodyA();
        _this.m_bodyB = _this.m_joint2.getBodyB();
        var xfB2 = _this.m_bodyB.m_xf;
        var aB = _this.m_bodyB.m_sweep.a;
        var xfD = _this.m_bodyD.m_xf;
        var aD = _this.m_bodyD.m_sweep.a;
        if (_this.m_type2 === RevoluteJoint.TYPE) {
          var revolute = _this.m_joint2;
          _this.m_localAnchorD = revolute.m_localAnchorA;
          _this.m_localAnchorB = revolute.m_localAnchorB;
          _this.m_referenceAngleB = revolute.m_referenceAngle;
          _this.m_localAxisD = Vec2.zero();
          coordinateB = aB - aD - _this.m_referenceAngleB;
        } else {
          var prismatic = _this.m_joint2;
          _this.m_localAnchorD = prismatic.m_localAnchorA;
          _this.m_localAnchorB = prismatic.m_localAnchorB;
          _this.m_referenceAngleB = prismatic.m_referenceAngle;
          _this.m_localAxisD = prismatic.m_localXAxisA;
          var pD = _this.m_localAnchorD;
          var pB2 = Rot.mulTVec2(xfD.q, Vec2.add(Rot.mulVec2(xfB2.q, _this.m_localAnchorB), Vec2.sub(xfB2.p, xfD.p)));
          coordinateB = Vec2.dot(pB2, _this.m_localAxisD) - Vec2.dot(pD, _this.m_localAxisD);
        }
        _this.m_constant = coordinateA + _this.m_ratio * coordinateB;
        _this.m_impulse = 0;
        return _this;
      }
      GearJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          joint1: this.m_joint1,
          joint2: this.m_joint2,
          ratio: this.m_ratio
          // _constant: this.m_constant,
        };
      };
      GearJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.joint1 = restore(Joint, data.joint1, world);
        data.joint2 = restore(Joint, data.joint2, world);
        var joint = new GearJoint2(data);
        return joint;
      };
      GearJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.ratio)) {
          this.m_ratio = def.ratio;
        }
      };
      GearJoint2.prototype.getJoint1 = function() {
        return this.m_joint1;
      };
      GearJoint2.prototype.getJoint2 = function() {
        return this.m_joint2;
      };
      GearJoint2.prototype.setRatio = function(ratio) {
        this.m_ratio = ratio;
      };
      GearJoint2.prototype.getRatio = function() {
        return this.m_ratio;
      };
      GearJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      GearJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      GearJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_JvAC).mul(inv_dt);
      };
      GearJoint2.prototype.getReactionTorque = function(inv_dt) {
        var L = this.m_impulse * this.m_JwA;
        return inv_dt * L;
      };
      GearJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_lcA = this.m_bodyA.m_sweep.localCenter;
        this.m_lcB = this.m_bodyB.m_sweep.localCenter;
        this.m_lcC = this.m_bodyC.m_sweep.localCenter;
        this.m_lcD = this.m_bodyD.m_sweep.localCenter;
        this.m_mA = this.m_bodyA.m_invMass;
        this.m_mB = this.m_bodyB.m_invMass;
        this.m_mC = this.m_bodyC.m_invMass;
        this.m_mD = this.m_bodyD.m_invMass;
        this.m_iA = this.m_bodyA.m_invI;
        this.m_iB = this.m_bodyB.m_invI;
        this.m_iC = this.m_bodyC.m_invI;
        this.m_iD = this.m_bodyD.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var aC = this.m_bodyC.c_position.a;
        var vC = this.m_bodyC.c_velocity.v;
        var wC = this.m_bodyC.c_velocity.w;
        var aD = this.m_bodyD.c_position.a;
        var vD = this.m_bodyD.c_velocity.v;
        var wD = this.m_bodyD.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var qC = Rot.neo(aC);
        var qD = Rot.neo(aD);
        this.m_mass = 0;
        if (this.m_type1 == RevoluteJoint.TYPE) {
          this.m_JvAC = Vec2.zero();
          this.m_JwA = 1;
          this.m_JwC = 1;
          this.m_mass += this.m_iA + this.m_iC;
        } else {
          var u = Rot.mulVec2(qC, this.m_localAxisC);
          var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);
          var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);
          this.m_JvAC = u;
          this.m_JwC = Vec2.crossVec2Vec2(rC, u);
          this.m_JwA = Vec2.crossVec2Vec2(rA2, u);
          this.m_mass += this.m_mC + this.m_mA + this.m_iC * this.m_JwC * this.m_JwC + this.m_iA * this.m_JwA * this.m_JwA;
        }
        if (this.m_type2 == RevoluteJoint.TYPE) {
          this.m_JvBD = Vec2.zero();
          this.m_JwB = this.m_ratio;
          this.m_JwD = this.m_ratio;
          this.m_mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);
        } else {
          var u = Rot.mulVec2(qD, this.m_localAxisD);
          var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);
          var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);
          this.m_JvBD = Vec2.mulNumVec2(this.m_ratio, u);
          this.m_JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);
          this.m_JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);
          this.m_mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * this.m_JwD * this.m_JwD + this.m_iB * this.m_JwB * this.m_JwB;
        }
        this.m_mass = this.m_mass > 0 ? 1 / this.m_mass : 0;
        if (step.warmStarting) {
          vA2.addMul(this.m_mA * this.m_impulse, this.m_JvAC);
          wA += this.m_iA * this.m_impulse * this.m_JwA;
          vB2.addMul(this.m_mB * this.m_impulse, this.m_JvBD);
          wB += this.m_iB * this.m_impulse * this.m_JwB;
          vC.subMul(this.m_mC * this.m_impulse, this.m_JvAC);
          wC -= this.m_iC * this.m_impulse * this.m_JwC;
          vD.subMul(this.m_mD * this.m_impulse, this.m_JvBD);
          wD -= this.m_iD * this.m_impulse * this.m_JwD;
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
        this.m_bodyC.c_velocity.v.setVec2(vC);
        this.m_bodyC.c_velocity.w = wC;
        this.m_bodyD.c_velocity.v.setVec2(vD);
        this.m_bodyD.c_velocity.w = wD;
      };
      GearJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vC = this.m_bodyC.c_velocity.v;
        var wC = this.m_bodyC.c_velocity.w;
        var vD = this.m_bodyD.c_velocity.v;
        var wD = this.m_bodyD.c_velocity.w;
        var Cdot = Vec2.dot(this.m_JvAC, vA2) - Vec2.dot(this.m_JvAC, vC) + Vec2.dot(this.m_JvBD, vB2) - Vec2.dot(this.m_JvBD, vD);
        Cdot += this.m_JwA * wA - this.m_JwC * wC + (this.m_JwB * wB - this.m_JwD * wD);
        var impulse = -this.m_mass * Cdot;
        this.m_impulse += impulse;
        vA2.addMul(this.m_mA * impulse, this.m_JvAC);
        wA += this.m_iA * impulse * this.m_JwA;
        vB2.addMul(this.m_mB * impulse, this.m_JvBD);
        wB += this.m_iB * impulse * this.m_JwB;
        vC.subMul(this.m_mC * impulse, this.m_JvAC);
        wC -= this.m_iC * impulse * this.m_JwC;
        vD.subMul(this.m_mD * impulse, this.m_JvBD);
        wD -= this.m_iD * impulse * this.m_JwD;
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
        this.m_bodyC.c_velocity.v.setVec2(vC);
        this.m_bodyC.c_velocity.w = wC;
        this.m_bodyD.c_velocity.v.setVec2(vD);
        this.m_bodyD.c_velocity.w = wD;
      };
      GearJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var cC = this.m_bodyC.c_position.c;
        var aC = this.m_bodyC.c_position.a;
        var cD = this.m_bodyD.c_position.c;
        var aD = this.m_bodyD.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var qC = Rot.neo(aC);
        var qD = Rot.neo(aD);
        var linearError = 0;
        var coordinateA;
        var coordinateB;
        var JvAC;
        var JvBD;
        var JwA;
        var JwB;
        var JwC;
        var JwD;
        var mass = 0;
        if (this.m_type1 == RevoluteJoint.TYPE) {
          JvAC = Vec2.zero();
          JwA = 1;
          JwC = 1;
          mass += this.m_iA + this.m_iC;
          coordinateA = aA - aC - this.m_referenceAngleA;
        } else {
          var u = Rot.mulVec2(qC, this.m_localAxisC);
          var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);
          var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);
          JvAC = u;
          JwC = Vec2.crossVec2Vec2(rC, u);
          JwA = Vec2.crossVec2Vec2(rA2, u);
          mass += this.m_mC + this.m_mA + this.m_iC * JwC * JwC + this.m_iA * JwA * JwA;
          var pC = Vec2.sub(this.m_localAnchorC, this.m_lcC);
          var pA2 = Rot.mulTVec2(qC, Vec2.add(rA2, Vec2.sub(cA2, cC)));
          coordinateA = Vec2.dot(Vec2.sub(pA2, pC), this.m_localAxisC);
        }
        if (this.m_type2 == RevoluteJoint.TYPE) {
          JvBD = Vec2.zero();
          JwB = this.m_ratio;
          JwD = this.m_ratio;
          mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);
          coordinateB = aB - aD - this.m_referenceAngleB;
        } else {
          var u = Rot.mulVec2(qD, this.m_localAxisD);
          var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);
          var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);
          JvBD = Vec2.mulNumVec2(this.m_ratio, u);
          JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);
          JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);
          mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * JwD * JwD + this.m_iB * JwB * JwB;
          var pD = Vec2.sub(this.m_localAnchorD, this.m_lcD);
          var pB2 = Rot.mulTVec2(qD, Vec2.add(rB2, Vec2.sub(cB2, cD)));
          coordinateB = Vec2.dot(pB2, this.m_localAxisD) - Vec2.dot(pD, this.m_localAxisD);
        }
        var C = coordinateA + this.m_ratio * coordinateB - this.m_constant;
        var impulse = 0;
        if (mass > 0) {
          impulse = -C / mass;
        }
        cA2.addMul(this.m_mA * impulse, JvAC);
        aA += this.m_iA * impulse * JwA;
        cB2.addMul(this.m_mB * impulse, JvBD);
        aB += this.m_iB * impulse * JwB;
        cC.subMul(this.m_mC * impulse, JvAC);
        aC -= this.m_iC * impulse * JwC;
        cD.subMul(this.m_mD * impulse, JvBD);
        aD -= this.m_iD * impulse * JwD;
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        this.m_bodyC.c_position.c.setVec2(cC);
        this.m_bodyC.c_position.a = aC;
        this.m_bodyD.c_position.c.setVec2(cD);
        this.m_bodyD.c_position.a = aD;
        return linearError < SettingsInternal.linearSlop;
      };
      GearJoint2.TYPE = "gear-joint";
      return GearJoint2;
    }(Joint)
  );
  var DEFAULTS$5 = {
    maxForce: 1,
    maxTorque: 1,
    correctionFactor: 0.3
  };
  var MotorJoint = (
    /** @class */
    function(_super) {
      __extends(MotorJoint2, _super);
      function MotorJoint2(def, bodyA, bodyB) {
        var _this = this;
        if (!(_this instanceof MotorJoint2)) {
          return new MotorJoint2(def, bodyA, bodyB);
        }
        def = options(def, DEFAULTS$5);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = MotorJoint2.TYPE;
        _this.m_linearOffset = Vec2.isValid(def.linearOffset) ? Vec2.clone(def.linearOffset) : bodyA.getLocalPoint(bodyB.getPosition());
        _this.m_angularOffset = Number.isFinite(def.angularOffset) ? def.angularOffset : bodyB.getAngle() - bodyA.getAngle();
        _this.m_linearImpulse = Vec2.zero();
        _this.m_angularImpulse = 0;
        _this.m_maxForce = def.maxForce;
        _this.m_maxTorque = def.maxTorque;
        _this.m_correctionFactor = def.correctionFactor;
        return _this;
      }
      MotorJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          maxForce: this.m_maxForce,
          maxTorque: this.m_maxTorque,
          correctionFactor: this.m_correctionFactor,
          linearOffset: this.m_linearOffset,
          angularOffset: this.m_angularOffset
        };
      };
      MotorJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new MotorJoint2(data);
        return joint;
      };
      MotorJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.angularOffset)) {
          this.m_angularOffset = def.angularOffset;
        }
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.maxTorque)) {
          this.m_maxTorque = def.maxTorque;
        }
        if (Number.isFinite(def.correctionFactor)) {
          this.m_correctionFactor = def.correctionFactor;
        }
        if (Vec2.isValid(def.linearOffset)) {
          this.m_linearOffset.set(def.linearOffset);
        }
      };
      MotorJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      MotorJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      MotorJoint2.prototype.setMaxTorque = function(torque) {
        this.m_maxTorque = torque;
      };
      MotorJoint2.prototype.getMaxTorque = function() {
        return this.m_maxTorque;
      };
      MotorJoint2.prototype.setCorrectionFactor = function(factor) {
        this.m_correctionFactor = factor;
      };
      MotorJoint2.prototype.getCorrectionFactor = function() {
        return this.m_correctionFactor;
      };
      MotorJoint2.prototype.setLinearOffset = function(linearOffset) {
        if (linearOffset.x != this.m_linearOffset.x || linearOffset.y != this.m_linearOffset.y) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_linearOffset.set(linearOffset);
        }
      };
      MotorJoint2.prototype.getLinearOffset = function() {
        return this.m_linearOffset;
      };
      MotorJoint2.prototype.setAngularOffset = function(angularOffset) {
        if (angularOffset != this.m_angularOffset) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_angularOffset = angularOffset;
        }
      };
      MotorJoint2.prototype.getAngularOffset = function() {
        return this.m_angularOffset;
      };
      MotorJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getPosition();
      };
      MotorJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getPosition();
      };
      MotorJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);
      };
      MotorJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_angularImpulse;
      };
      MotorJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_linearOffset, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.neg(this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat22();
        K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;
        K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;
        this.m_linearMass = K.getInverse();
        this.m_angularMass = iA + iB;
        if (this.m_angularMass > 0) {
          this.m_angularMass = 1 / this.m_angularMass;
        }
        this.m_linearError = Vec2.zero();
        this.m_linearError.addCombine(1, cB2, 1, this.m_rB);
        this.m_linearError.subCombine(1, cA2, 1, this.m_rA);
        this.m_angularError = aB - aA - this.m_angularOffset;
        if (step.warmStarting) {
          this.m_linearImpulse.mul(step.dtRatio);
          this.m_angularImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);
        } else {
          this.m_linearImpulse.setZero();
          this.m_angularImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      MotorJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var h = step.dt;
        var inv_h = step.inv_dt;
        {
          var Cdot = wB - wA + inv_h * this.m_correctionFactor * this.m_angularError;
          var impulse = -this.m_angularMass * Cdot;
          var oldImpulse = this.m_angularImpulse;
          var maxImpulse = h * this.m_maxTorque;
          this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_angularImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.zero();
          Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          Cdot.addMul(inv_h * this.m_correctionFactor, this.m_linearError);
          var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));
          var oldImpulse = Vec2.clone(this.m_linearImpulse);
          this.m_linearImpulse.add(impulse);
          var maxImpulse = h * this.m_maxForce;
          this.m_linearImpulse.clamp(maxImpulse);
          impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      MotorJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      MotorJoint2.TYPE = "motor-joint";
      return MotorJoint2;
    }(Joint)
  );
  var math_PI$2 = Math.PI;
  var DEFAULTS$4 = {
    maxForce: 0,
    frequencyHz: 5,
    dampingRatio: 0.7
  };
  var MouseJoint = (
    /** @class */
    function(_super) {
      __extends(MouseJoint2, _super);
      function MouseJoint2(def, bodyA, bodyB, target) {
        var _this = this;
        if (!(_this instanceof MouseJoint2)) {
          return new MouseJoint2(def, bodyA, bodyB, target);
        }
        def = options(def, DEFAULTS$4);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = MouseJoint2.TYPE;
        if (Vec2.isValid(target)) {
          _this.m_targetA = Vec2.clone(target);
        } else if (Vec2.isValid(def.target)) {
          _this.m_targetA = Vec2.clone(def.target);
        } else {
          _this.m_targetA = Vec2.zero();
        }
        _this.m_localAnchorB = Transform.mulTVec2(bodyB.getTransform(), _this.m_targetA);
        _this.m_maxForce = def.maxForce;
        _this.m_impulse = Vec2.zero();
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_beta = 0;
        _this.m_gamma = 0;
        _this.m_rB = Vec2.zero();
        _this.m_localCenterB = Vec2.zero();
        _this.m_invMassB = 0;
        _this.m_invIB = 0;
        _this.m_mass = new Mat22();
        _this.m_C = Vec2.zero();
        return _this;
      }
      MouseJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          target: this.m_targetA,
          maxForce: this.m_maxForce,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          _localAnchorB: this.m_localAnchorB
        };
      };
      MouseJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.target = Vec2.clone(data.target);
        var joint = new MouseJoint2(data);
        if (data._localAnchorB) {
          joint.m_localAnchorB = data._localAnchorB;
        }
        return joint;
      };
      MouseJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      MouseJoint2.prototype.setTarget = function(target) {
        if (Vec2.areEqual(target, this.m_targetA))
          return;
        this.m_bodyB.setAwake(true);
        this.m_targetA.set(target);
      };
      MouseJoint2.prototype.getTarget = function() {
        return this.m_targetA;
      };
      MouseJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      MouseJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      MouseJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      MouseJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      MouseJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      MouseJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      MouseJoint2.prototype.getAnchorA = function() {
        return Vec2.clone(this.m_targetA);
      };
      MouseJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      MouseJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_impulse);
      };
      MouseJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * 0;
      };
      MouseJoint2.prototype.shiftOrigin = function(newOrigin) {
        this.m_targetA.sub(newOrigin);
      };
      MouseJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIB = this.m_bodyB.m_invI;
        var position = this.m_bodyB.c_position;
        var velocity = this.m_bodyB.c_velocity;
        var cB2 = position.c;
        var aB = position.a;
        var vB2 = velocity.v;
        var wB = velocity.w;
        var qB = Rot.neo(aB);
        var mass = this.m_bodyB.getMass();
        var omega = 2 * math_PI$2 * this.m_frequencyHz;
        var d2 = 2 * mass * this.m_dampingRatio * omega;
        var k = mass * (omega * omega);
        var h = step.dt;
        this.m_gamma = h * (d2 + h * k);
        if (this.m_gamma != 0) {
          this.m_gamma = 1 / this.m_gamma;
        }
        this.m_beta = h * k * this.m_gamma;
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var K = new Mat22();
        K.ex.x = this.m_invMassB + this.m_invIB * this.m_rB.y * this.m_rB.y + this.m_gamma;
        K.ex.y = -this.m_invIB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = this.m_invMassB + this.m_invIB * this.m_rB.x * this.m_rB.x + this.m_gamma;
        this.m_mass = K.getInverse();
        this.m_C.setVec2(cB2);
        this.m_C.addCombine(1, this.m_rB, -1, this.m_targetA);
        this.m_C.mul(this.m_beta);
        wB *= 0.98;
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          vB2.addMul(this.m_invMassB, this.m_impulse);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, this.m_impulse);
        } else {
          this.m_impulse.setZero();
        }
        velocity.v.setVec2(vB2);
        velocity.w = wB;
      };
      MouseJoint2.prototype.solveVelocityConstraints = function(step) {
        var velocity = this.m_bodyB.c_velocity;
        var vB2 = Vec2.clone(velocity.v);
        var wB = velocity.w;
        var Cdot = Vec2.crossNumVec2(wB, this.m_rB);
        Cdot.add(vB2);
        Cdot.addCombine(1, this.m_C, this.m_gamma, this.m_impulse);
        Cdot.neg();
        var impulse = Mat22.mulVec2(this.m_mass, Cdot);
        var oldImpulse = Vec2.clone(this.m_impulse);
        this.m_impulse.add(impulse);
        var maxImpulse = step.dt * this.m_maxForce;
        this.m_impulse.clamp(maxImpulse);
        impulse = Vec2.sub(this.m_impulse, oldImpulse);
        vB2.addMul(this.m_invMassB, impulse);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        velocity.v.setVec2(vB2);
        velocity.w = wB;
      };
      MouseJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      MouseJoint2.TYPE = "mouse-joint";
      return MouseJoint2;
    }(Joint)
  );
  var math_abs$2 = Math.abs;
  var DEFAULTS$3 = {
    collideConnected: true
  };
  var PulleyJoint = (
    /** @class */
    function(_super) {
      __extends(PulleyJoint2, _super);
      function PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio) {
        var _this = this;
        if (!(_this instanceof PulleyJoint2)) {
          return new PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio);
        }
        def = options(def, DEFAULTS$3);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = PulleyJoint2.TYPE;
        _this.m_groundAnchorA = Vec2.clone(groundA ? groundA : def.groundAnchorA || Vec2.neo(-1, 1));
        _this.m_groundAnchorB = Vec2.clone(groundB ? groundB : def.groundAnchorB || Vec2.neo(1, 1));
        _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.neo(-1, 0));
        _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.neo(1, 0));
        _this.m_lengthA = Number.isFinite(def.lengthA) ? def.lengthA : Vec2.distance(anchorA, groundA);
        _this.m_lengthB = Number.isFinite(def.lengthB) ? def.lengthB : Vec2.distance(anchorB, groundB);
        _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;
        _this.m_constant = _this.m_lengthA + _this.m_ratio * _this.m_lengthB;
        _this.m_impulse = 0;
        return _this;
      }
      PulleyJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          groundAnchorA: this.m_groundAnchorA,
          groundAnchorB: this.m_groundAnchorB,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          lengthA: this.m_lengthA,
          lengthB: this.m_lengthB,
          ratio: this.m_ratio
        };
      };
      PulleyJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new PulleyJoint2(data);
        return joint;
      };
      PulleyJoint2.prototype._reset = function(def) {
        if (Vec2.isValid(def.groundAnchorA)) {
          this.m_groundAnchorA.set(def.groundAnchorA);
        }
        if (Vec2.isValid(def.groundAnchorB)) {
          this.m_groundAnchorB.set(def.groundAnchorB);
        }
        if (Vec2.isValid(def.localAnchorA)) {
          this.m_localAnchorA.set(def.localAnchorA);
        } else if (Vec2.isValid(def.anchorA)) {
          this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(def.anchorA));
        }
        if (Vec2.isValid(def.localAnchorB)) {
          this.m_localAnchorB.set(def.localAnchorB);
        } else if (Vec2.isValid(def.anchorB)) {
          this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(def.anchorB));
        }
        if (Number.isFinite(def.lengthA)) {
          this.m_lengthA = def.lengthA;
        }
        if (Number.isFinite(def.lengthB)) {
          this.m_lengthB = def.lengthB;
        }
        if (Number.isFinite(def.ratio)) {
          this.m_ratio = def.ratio;
        }
      };
      PulleyJoint2.prototype.getGroundAnchorA = function() {
        return this.m_groundAnchorA;
      };
      PulleyJoint2.prototype.getGroundAnchorB = function() {
        return this.m_groundAnchorB;
      };
      PulleyJoint2.prototype.getLengthA = function() {
        return this.m_lengthA;
      };
      PulleyJoint2.prototype.getLengthB = function() {
        return this.m_lengthB;
      };
      PulleyJoint2.prototype.getRatio = function() {
        return this.m_ratio;
      };
      PulleyJoint2.prototype.getCurrentLengthA = function() {
        var p = this.m_bodyA.getWorldPoint(this.m_localAnchorA);
        var s2 = this.m_groundAnchorA;
        return Vec2.distance(p, s2);
      };
      PulleyJoint2.prototype.getCurrentLengthB = function() {
        var p = this.m_bodyB.getWorldPoint(this.m_localAnchorB);
        var s2 = this.m_groundAnchorB;
        return Vec2.distance(p, s2);
      };
      PulleyJoint2.prototype.shiftOrigin = function(newOrigin) {
        this.m_groundAnchorA.sub(newOrigin);
        this.m_groundAnchorB.sub(newOrigin);
      };
      PulleyJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      PulleyJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      PulleyJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_uB).mul(inv_dt);
      };
      PulleyJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      PulleyJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        this.m_uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);
        this.m_uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);
        var lengthA = this.m_uA.length();
        var lengthB = this.m_uB.length();
        if (lengthA > 10 * SettingsInternal.linearSlop) {
          this.m_uA.mul(1 / lengthA);
        } else {
          this.m_uA.setZero();
        }
        if (lengthB > 10 * SettingsInternal.linearSlop) {
          this.m_uB.mul(1 / lengthB);
        } else {
          this.m_uB.setZero();
        }
        var ruA = Vec2.crossVec2Vec2(this.m_rA, this.m_uA);
        var ruB = Vec2.crossVec2Vec2(this.m_rB, this.m_uB);
        var mA = this.m_invMassA + this.m_invIA * ruA * ruA;
        var mB = this.m_invMassB + this.m_invIB * ruB * ruB;
        this.m_mass = mA + this.m_ratio * this.m_ratio * mB;
        if (this.m_mass > 0) {
          this.m_mass = 1 / this.m_mass;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var PA = Vec2.mulNumVec2(-this.m_impulse, this.m_uA);
          var PB = Vec2.mulNumVec2(-this.m_ratio * this.m_impulse, this.m_uB);
          vA2.addMul(this.m_invMassA, PA);
          wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);
          vB2.addMul(this.m_invMassB, PB);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PulleyJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));
        var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));
        var Cdot = -Vec2.dot(this.m_uA, vpA) - this.m_ratio * Vec2.dot(this.m_uB, vpB);
        var impulse = -this.m_mass * Cdot;
        this.m_impulse += impulse;
        var PA = Vec2.mulNumVec2(-impulse, this.m_uA);
        var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, this.m_uB);
        vA2.addMul(this.m_invMassA, PA);
        wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);
        vB2.addMul(this.m_invMassB, PB);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PulleyJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);
        var uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);
        var lengthA = uA.length();
        var lengthB = uB.length();
        if (lengthA > 10 * SettingsInternal.linearSlop) {
          uA.mul(1 / lengthA);
        } else {
          uA.setZero();
        }
        if (lengthB > 10 * SettingsInternal.linearSlop) {
          uB.mul(1 / lengthB);
        } else {
          uB.setZero();
        }
        var ruA = Vec2.crossVec2Vec2(rA2, uA);
        var ruB = Vec2.crossVec2Vec2(rB2, uB);
        var mA = this.m_invMassA + this.m_invIA * ruA * ruA;
        var mB = this.m_invMassB + this.m_invIB * ruB * ruB;
        var mass = mA + this.m_ratio * this.m_ratio * mB;
        if (mass > 0) {
          mass = 1 / mass;
        }
        var C = this.m_constant - lengthA - this.m_ratio * lengthB;
        var linearError = math_abs$2(C);
        var impulse = -mass * C;
        var PA = Vec2.mulNumVec2(-impulse, uA);
        var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, uB);
        cA2.addMul(this.m_invMassA, PA);
        aA += this.m_invIA * Vec2.crossVec2Vec2(rA2, PA);
        cB2.addMul(this.m_invMassB, PB);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, PB);
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return linearError < SettingsInternal.linearSlop;
      };
      PulleyJoint2.TYPE = "pulley-joint";
      return PulleyJoint2;
    }(Joint)
  );
  var math_min$1 = Math.min;
  var LimitState;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState || (LimitState = {}));
  var DEFAULTS$2 = {
    maxLength: 0
  };
  var RopeJoint = (
    /** @class */
    function(_super) {
      __extends(RopeJoint2, _super);
      function RopeJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof RopeJoint2)) {
          return new RopeJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$2);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = RopeJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.neo(-1, 0));
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.neo(1, 0));
        _this.m_maxLength = def.maxLength;
        _this.m_mass = 0;
        _this.m_impulse = 0;
        _this.m_length = 0;
        _this.m_state = LimitState.inactiveLimit;
        return _this;
      }
      RopeJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          maxLength: this.m_maxLength
        };
      };
      RopeJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new RopeJoint2(data);
        return joint;
      };
      RopeJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.maxLength)) {
          this.m_maxLength = def.maxLength;
        }
      };
      RopeJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      RopeJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      RopeJoint2.prototype.setMaxLength = function(length) {
        this.m_maxLength = length;
      };
      RopeJoint2.prototype.getMaxLength = function() {
        return this.m_maxLength;
      };
      RopeJoint2.prototype.getLimitState = function() {
        return this.m_state;
      };
      RopeJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      RopeJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      RopeJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);
      };
      RopeJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      RopeJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        this.m_rB = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        this.m_u = Vec2.zero();
        this.m_u.addCombine(1, cB2, 1, this.m_rB);
        this.m_u.subCombine(1, cA2, 1, this.m_rA);
        this.m_length = this.m_u.length();
        var C = this.m_length - this.m_maxLength;
        if (C > 0) {
          this.m_state = LimitState.atUpperLimit;
        } else {
          this.m_state = LimitState.inactiveLimit;
        }
        if (this.m_length > SettingsInternal.linearSlop) {
          this.m_u.mul(1 / this.m_length);
        } else {
          this.m_u.setZero();
          this.m_mass = 0;
          this.m_impulse = 0;
          return;
        }
        var crA = Vec2.crossVec2Vec2(this.m_rA, this.m_u);
        var crB = Vec2.crossVec2Vec2(this.m_rB, this.m_u);
        var invMass = this.m_invMassA + this.m_invIA * crA * crA + this.m_invMassB + this.m_invIB * crB * crB;
        this.m_mass = invMass != 0 ? 1 / invMass : 0;
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      RopeJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.addCrossNumVec2(vA2, wA, this.m_rA);
        var vpB = Vec2.addCrossNumVec2(vB2, wB, this.m_rB);
        var C = this.m_length - this.m_maxLength;
        var Cdot = Vec2.dot(this.m_u, Vec2.sub(vpB, vpA));
        if (C < 0) {
          Cdot += step.inv_dt * C;
        }
        var impulse = -this.m_mass * Cdot;
        var oldImpulse = this.m_impulse;
        this.m_impulse = math_min$1(0, this.m_impulse + impulse);
        impulse = this.m_impulse - oldImpulse;
        var P3 = Vec2.mulNumVec2(impulse, this.m_u);
        vA2.subMul(this.m_invMassA, P3);
        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
        vB2.addMul(this.m_invMassB, P3);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RopeJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        var u = Vec2.zero();
        u.addCombine(1, cB2, 1, rB2);
        u.subCombine(1, cA2, 1, rA2);
        var length = u.normalize();
        var C = length - this.m_maxLength;
        C = clamp(C, 0, SettingsInternal.maxLinearCorrection);
        var impulse = -this.m_mass * C;
        var P3 = Vec2.mulNumVec2(impulse, u);
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return length - this.m_maxLength < SettingsInternal.linearSlop;
      };
      RopeJoint2.TYPE = "rope-joint";
      return RopeJoint2;
    }(Joint)
  );
  var math_abs$1 = Math.abs;
  var math_PI$1 = Math.PI;
  var DEFAULTS$1 = {
    frequencyHz: 0,
    dampingRatio: 0
  };
  var WeldJoint = (
    /** @class */
    function(_super) {
      __extends(WeldJoint2, _super);
      function WeldJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof WeldJoint2)) {
          return new WeldJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$1);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = WeldJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_impulse = new Vec3();
        _this.m_bias = 0;
        _this.m_gamma = 0;
        _this.m_mass = new Mat33();
        return _this;
      }
      WeldJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          referenceAngle: this.m_referenceAngle
        };
      };
      WeldJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new WeldJoint2(data);
        return joint;
      };
      WeldJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      WeldJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      WeldJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      WeldJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      WeldJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      WeldJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      WeldJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      WeldJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      WeldJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      WeldJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      WeldJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);
      };
      WeldJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.z;
      };
      WeldJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat33();
        K.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;
        K.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;
        K.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;
        K.ex.y = K.ey.x;
        K.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;
        K.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;
        K.ex.z = K.ez.x;
        K.ey.z = K.ez.y;
        K.ez.z = iA + iB;
        if (this.m_frequencyHz > 0) {
          K.getInverse22(this.m_mass);
          var invM = iA + iB;
          var m = invM > 0 ? 1 / invM : 0;
          var C = aB - aA - this.m_referenceAngle;
          var omega = 2 * math_PI$1 * this.m_frequencyHz;
          var d2 = 2 * m * this.m_dampingRatio * omega;
          var k = m * omega * omega;
          var h = step.dt;
          this.m_gamma = h * (d2 + h * k);
          this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;
          this.m_bias = C * h * k * this.m_gamma;
          invM += this.m_gamma;
          this.m_mass.ez.z = invM != 0 ? 1 / invM : 0;
        } else if (K.ez.z == 0) {
          K.getInverse22(this.m_mass);
          this.m_gamma = 0;
          this.m_bias = 0;
        } else {
          K.getSymInverse33(this.m_mass);
          this.m_gamma = 0;
          this.m_bias = 0;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_impulse.z);
        } else {
          this.m_impulse.setZero();
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      WeldJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        if (this.m_frequencyHz > 0) {
          var Cdot2 = wB - wA;
          var impulse2 = -this.m_mass.ez.z * (Cdot2 + this.m_bias + this.m_gamma * this.m_impulse.z);
          this.m_impulse.z += impulse2;
          wA -= iA * impulse2;
          wB += iB * impulse2;
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var impulse1 = Vec2.neg(Mat33.mulVec2(this.m_mass, Cdot1));
          this.m_impulse.x += impulse1.x;
          this.m_impulse.y += impulse1.y;
          var P3 = Vec2.clone(impulse1);
          vA2.subMul(mA, P3);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(mB, P3);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var Cdot2 = wB - wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var impulse = Vec3.neg(Mat33.mulVec3(this.m_mass, Cdot));
          this.m_impulse.add(impulse);
          var P3 = Vec2.neo(impulse.x, impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      WeldJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var positionError;
        var angularError;
        var K = new Mat33();
        K.ex.x = mA + mB + rA2.y * rA2.y * iA + rB2.y * rB2.y * iB;
        K.ey.x = -rA2.y * rA2.x * iA - rB2.y * rB2.x * iB;
        K.ez.x = -rA2.y * iA - rB2.y * iB;
        K.ex.y = K.ey.x;
        K.ey.y = mA + mB + rA2.x * rA2.x * iA + rB2.x * rB2.x * iB;
        K.ez.y = rA2.x * iA + rB2.x * iB;
        K.ex.z = K.ez.x;
        K.ey.z = K.ez.y;
        K.ez.z = iA + iB;
        if (this.m_frequencyHz > 0) {
          var C1 = Vec2.zero();
          C1.addCombine(1, cB2, 1, rB2);
          C1.subCombine(1, cA2, 1, rA2);
          positionError = C1.length();
          angularError = 0;
          var P3 = Vec2.neg(K.solve22(C1));
          cA2.subMul(mA, P3);
          aA -= iA * Vec2.crossVec2Vec2(rA2, P3);
          cB2.addMul(mB, P3);
          aB += iB * Vec2.crossVec2Vec2(rB2, P3);
        } else {
          var C1 = Vec2.zero();
          C1.addCombine(1, cB2, 1, rB2);
          C1.subCombine(1, cA2, 1, rA2);
          var C2 = aB - aA - this.m_referenceAngle;
          positionError = C1.length();
          angularError = math_abs$1(C2);
          var C = new Vec3(C1.x, C1.y, C2);
          var impulse = new Vec3();
          if (K.ez.z > 0) {
            impulse = Vec3.neg(K.solve33(C));
          } else {
            var impulse2 = Vec2.neg(K.solve22(C1));
            impulse.set(impulse2.x, impulse2.y, 0);
          }
          var P3 = Vec2.neo(impulse.x, impulse.y);
          cA2.subMul(mA, P3);
          aA -= iA * (Vec2.crossVec2Vec2(rA2, P3) + impulse.z);
          cB2.addMul(mB, P3);
          aB += iB * (Vec2.crossVec2Vec2(rB2, P3) + impulse.z);
        }
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      WeldJoint2.TYPE = "weld-joint";
      return WeldJoint2;
    }(Joint)
  );
  var math_abs = Math.abs;
  var math_PI = Math.PI;
  var DEFAULTS = {
    enableMotor: false,
    maxMotorTorque: 0,
    motorSpeed: 0,
    frequencyHz: 2,
    dampingRatio: 0.7
  };
  var WheelJoint = (
    /** @class */
    function(_super) {
      __extends(WheelJoint2, _super);
      function WheelJoint2(def, bodyA, bodyB, anchor, axis) {
        var _this = this;
        if (!(_this instanceof WheelJoint2)) {
          return new WheelJoint2(def, bodyA, bodyB, anchor, axis);
        }
        def = options(def, DEFAULTS);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_ax = Vec2.zero();
        _this.m_ay = Vec2.zero();
        _this.m_type = WheelJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        if (Vec2.isValid(axis)) {
          _this.m_localXAxisA = bodyA.getLocalVector(axis);
        } else if (Vec2.isValid(def.localAxisA)) {
          _this.m_localXAxisA = Vec2.clone(def.localAxisA);
        } else if (Vec2.isValid(def.localAxis)) {
          _this.m_localXAxisA = Vec2.clone(def.localAxis);
        } else {
          _this.m_localXAxisA = Vec2.neo(1, 0);
        }
        _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);
        _this.m_mass = 0;
        _this.m_impulse = 0;
        _this.m_motorMass = 0;
        _this.m_motorImpulse = 0;
        _this.m_springMass = 0;
        _this.m_springImpulse = 0;
        _this.m_maxMotorTorque = def.maxMotorTorque;
        _this.m_motorSpeed = def.motorSpeed;
        _this.m_enableMotor = def.enableMotor;
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_bias = 0;
        _this.m_gamma = 0;
        return _this;
      }
      WheelJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          enableMotor: this.m_enableMotor,
          maxMotorTorque: this.m_maxMotorTorque,
          motorSpeed: this.m_motorSpeed,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          localAxisA: this.m_localXAxisA
        };
      };
      WheelJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new WheelJoint2(data);
        return joint;
      };
      WheelJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.localAxisA) {
          this.m_localXAxisA.setVec2(def.localAxisA);
          this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));
        }
        if (def.enableMotor !== void 0) {
          this.m_enableMotor = def.enableMotor;
        }
        if (Number.isFinite(def.maxMotorTorque)) {
          this.m_maxMotorTorque = def.maxMotorTorque;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      WheelJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      WheelJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      WheelJoint2.prototype.getLocalAxisA = function() {
        return this.m_localXAxisA;
      };
      WheelJoint2.prototype.getJointTranslation = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        var pA2 = bA.getWorldPoint(this.m_localAnchorA);
        var pB2 = bB.getWorldPoint(this.m_localAnchorB);
        var d2 = Vec2.sub(pB2, pA2);
        var axis = bA.getWorldVector(this.m_localXAxisA);
        var translation2 = Vec2.dot(d2, axis);
        return translation2;
      };
      WheelJoint2.prototype.getJointSpeed = function() {
        var wA = this.m_bodyA.m_angularVelocity;
        var wB = this.m_bodyB.m_angularVelocity;
        return wB - wA;
      };
      WheelJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      WheelJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      WheelJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      WheelJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      WheelJoint2.prototype.setMaxMotorTorque = function(torque) {
        if (torque == this.m_maxMotorTorque)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorTorque = torque;
      };
      WheelJoint2.prototype.getMaxMotorTorque = function() {
        return this.m_maxMotorTorque;
      };
      WheelJoint2.prototype.getMotorTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      WheelJoint2.prototype.setSpringFrequencyHz = function(hz) {
        this.m_frequencyHz = hz;
      };
      WheelJoint2.prototype.getSpringFrequencyHz = function() {
        return this.m_frequencyHz;
      };
      WheelJoint2.prototype.setSpringDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      WheelJoint2.prototype.getSpringDampingRatio = function() {
        return this.m_dampingRatio;
      };
      WheelJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      WheelJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      WheelJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax).mul(inv_dt);
      };
      WheelJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      WheelJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        {
          this.m_ay = Rot.mulVec2(qA, this.m_localYAxisA);
          this.m_sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ay);
          this.m_sBy = Vec2.crossVec2Vec2(rB2, this.m_ay);
          this.m_mass = mA + mB + iA * this.m_sAy * this.m_sAy + iB * this.m_sBy * this.m_sBy;
          if (this.m_mass > 0) {
            this.m_mass = 1 / this.m_mass;
          }
        }
        this.m_springMass = 0;
        this.m_bias = 0;
        this.m_gamma = 0;
        if (this.m_frequencyHz > 0) {
          this.m_ax = Rot.mulVec2(qA, this.m_localXAxisA);
          this.m_sAx = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ax);
          this.m_sBx = Vec2.crossVec2Vec2(rB2, this.m_ax);
          var invMass = mA + mB + iA * this.m_sAx * this.m_sAx + iB * this.m_sBx * this.m_sBx;
          if (invMass > 0) {
            this.m_springMass = 1 / invMass;
            var C = Vec2.dot(d2, this.m_ax);
            var omega = 2 * math_PI * this.m_frequencyHz;
            var damp = 2 * this.m_springMass * this.m_dampingRatio * omega;
            var k = this.m_springMass * omega * omega;
            var h = step.dt;
            this.m_gamma = h * (damp + h * k);
            if (this.m_gamma > 0) {
              this.m_gamma = 1 / this.m_gamma;
            }
            this.m_bias = C * h * k * this.m_gamma;
            this.m_springMass = invMass + this.m_gamma;
            if (this.m_springMass > 0) {
              this.m_springMass = 1 / this.m_springMass;
            }
          }
        } else {
          this.m_springImpulse = 0;
        }
        if (this.m_enableMotor) {
          this.m_motorMass = iA + iB;
          if (this.m_motorMass > 0) {
            this.m_motorMass = 1 / this.m_motorMass;
          }
        } else {
          this.m_motorMass = 0;
          this.m_motorImpulse = 0;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          this.m_springImpulse *= step.dtRatio;
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax);
          var LA = this.m_impulse * this.m_sAy + this.m_springImpulse * this.m_sAx + this.m_motorImpulse;
          var LB = this.m_impulse * this.m_sBy + this.m_springImpulse * this.m_sBx + this.m_motorImpulse;
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * LA;
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * LB;
        } else {
          this.m_impulse = 0;
          this.m_springImpulse = 0;
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      WheelJoint2.prototype.solveVelocityConstraints = function(step) {
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        {
          var Cdot = Vec2.dot(this.m_ax, vB2) - Vec2.dot(this.m_ax, vA2) + this.m_sBx * wB - this.m_sAx * wA;
          var impulse = -this.m_springMass * (Cdot + this.m_bias + this.m_gamma * this.m_springImpulse);
          this.m_springImpulse += impulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_ax);
          var LA = impulse * this.m_sAx;
          var LB = impulse * this.m_sBx;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        {
          var Cdot = wB - wA - this.m_motorSpeed;
          var impulse = -this.m_motorMass * Cdot;
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorTorque;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.dot(this.m_ay, vB2) - Vec2.dot(this.m_ay, vA2) + this.m_sBy * wB - this.m_sAy * wA;
          var impulse = -this.m_mass * Cdot;
          this.m_impulse += impulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_ay);
          var LA = impulse * this.m_sAy;
          var LB = impulse * this.m_sBy;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      WheelJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        var ay = Rot.mulVec2(qA, this.m_localYAxisA);
        var sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), ay);
        var sBy = Vec2.crossVec2Vec2(rB2, ay);
        var C = Vec2.dot(d2, ay);
        var k = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_sAy * this.m_sAy + this.m_invIB * this.m_sBy * this.m_sBy;
        var impulse = k != 0 ? -C / k : 0;
        var P3 = Vec2.mulNumVec2(impulse, ay);
        var LA = impulse * sAy;
        var LB = impulse * sBy;
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * LA;
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * LB;
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return math_abs(C) <= SettingsInternal.linearSlop;
      };
      WheelJoint2.TYPE = "wheel-joint";
      return WheelJoint2;
    }(Joint)
  );
  var _a;
  var SID = 0;
  var SERIALIZE_REF_TYPES = {
    "World": World,
    "Body": Body,
    "Joint": Joint,
    "Fixture": Fixture,
    "Shape": Shape
  };
  var DESERIALIZE_BY_REF_TYPE = {
    "Vec2": Vec2,
    "Vec3": Vec3,
    "World": World,
    "Body": Body,
    "Joint": Joint,
    "Fixture": Fixture,
    "Shape": Shape
  };
  var DESERIALIZE_BY_TYPE_FIELD = (_a = {}, _a[Body.STATIC] = Body, _a[Body.DYNAMIC] = Body, _a[Body.KINEMATIC] = Body, _a[ChainShape.TYPE] = ChainShape, // [BoxShape.TYPE]: BoxShape,
  _a[PolygonShape.TYPE] = PolygonShape, _a[EdgeShape.TYPE] = EdgeShape, _a[CircleShape.TYPE] = CircleShape, _a[DistanceJoint.TYPE] = DistanceJoint, _a[FrictionJoint.TYPE] = FrictionJoint, _a[GearJoint.TYPE] = GearJoint, _a[MotorJoint.TYPE] = MotorJoint, _a[MouseJoint.TYPE] = MouseJoint, _a[PrismaticJoint.TYPE] = PrismaticJoint, _a[PulleyJoint.TYPE] = PulleyJoint, _a[RevoluteJoint.TYPE] = RevoluteJoint, _a[RopeJoint.TYPE] = RopeJoint, _a[WeldJoint.TYPE] = WeldJoint, _a[WheelJoint.TYPE] = WheelJoint, _a);
  var DEFAULT_OPTIONS = {
    rootClass: World,
    preSerialize: function(obj) {
      return obj;
    },
    postSerialize: function(data, obj) {
      return data;
    },
    preDeserialize: function(data) {
      return data;
    },
    postDeserialize: function(obj, data) {
      return obj;
    }
  };
  var Serializer = (
    /** @class */
    /* @__PURE__ */ function() {
      function Serializer2(options2) {
        var _this = this;
        this.toJson = function(root) {
          var preSerialize = _this.options.preSerialize;
          var postSerialize = _this.options.postSerialize;
          var json = [];
          var refQueue = [root];
          var refMemoById = {};
          function addToRefQueue(value, typeName) {
            value.__sid = value.__sid || ++SID;
            if (!refMemoById[value.__sid]) {
              refQueue.push(value);
              var index = json.length + refQueue.length;
              var ref = {
                refIndex: index,
                refType: typeName
              };
              refMemoById[value.__sid] = ref;
            }
            return refMemoById[value.__sid];
          }
          function serializeWithHooks(obj2) {
            obj2 = preSerialize(obj2);
            var data = obj2._serialize();
            data = postSerialize(data, obj2);
            return data;
          }
          function traverse(value, noRefType) {
            if (noRefType === void 0) {
              noRefType = false;
            }
            if (typeof value !== "object" || value === null) {
              return value;
            }
            if (typeof value._serialize === "function") {
              if (!noRefType) {
                for (var typeName in SERIALIZE_REF_TYPES) {
                  if (value instanceof SERIALIZE_REF_TYPES[typeName]) {
                    return addToRefQueue(value, typeName);
                  }
                }
              }
              value = serializeWithHooks(value);
            }
            if (Array.isArray(value)) {
              var newValue = [];
              for (var key = 0; key < value.length; key++) {
                newValue[key] = traverse(value[key]);
              }
              value = newValue;
            } else {
              var newValue = {};
              for (var key in value) {
                if (value.hasOwnProperty(key)) {
                  newValue[key] = traverse(value[key]);
                }
              }
              value = newValue;
            }
            return value;
          }
          while (refQueue.length) {
            var obj = refQueue.shift();
            var str = traverse(obj, true);
            json.push(str);
          }
          return json;
        };
        this.fromJson = function(json) {
          var preDeserialize = _this.options.preDeserialize;
          var postDeserialize = _this.options.postDeserialize;
          var rootClass = _this.options.rootClass;
          var deserializedRefMemoByIndex = {};
          function deserializeWithHooks(classHint, data, context) {
            if (!classHint || !classHint._deserialize) {
              classHint = DESERIALIZE_BY_TYPE_FIELD[data.type];
            }
            var deserializer = classHint && classHint._deserialize;
            if (!deserializer) {
              return;
            }
            data = preDeserialize(data);
            var classDeserializeFn = classHint._deserialize;
            var obj = classDeserializeFn(data, context, deserializeChild);
            obj = postDeserialize(obj, data);
            return obj;
          }
          function deserializeChild(classHint, dataOrRef, context) {
            var isRefObject = dataOrRef.refIndex && dataOrRef.refType;
            if (!isRefObject) {
              return deserializeWithHooks(classHint, dataOrRef, context);
            }
            var ref = dataOrRef;
            if (DESERIALIZE_BY_REF_TYPE[ref.refType]) {
              classHint = DESERIALIZE_BY_REF_TYPE[ref.refType];
            }
            var refIndex = ref.refIndex;
            if (!deserializedRefMemoByIndex[refIndex]) {
              var data = json[refIndex];
              var obj = deserializeWithHooks(classHint, data, context);
              deserializedRefMemoByIndex[refIndex] = obj;
            }
            return deserializedRefMemoByIndex[refIndex];
          }
          var root = deserializeWithHooks(rootClass, json[0], null);
          return root;
        };
        this.options = __assign(__assign({}, DEFAULT_OPTIONS), options2);
      }
      return Serializer2;
    }()
  );
  var worldSerializer = new Serializer({
    rootClass: World
  });
  Serializer.fromJson = worldSerializer.fromJson;
  Serializer.toJson = worldSerializer.toJson;
  var Testbed = (
    /** @class */
    function() {
      function Testbed2() {
      }
      Testbed2.mount = function(options2) {
        throw new Error("Not implemented");
      };
      Testbed2.start = function(world) {
        var testbed2 = Testbed2.mount();
        testbed2.start(world);
        return testbed2;
      };
      return Testbed2;
    }()
  );
  function testbed(a2, b2) {
    var callback;
    var options2;
    if (typeof a2 === "function") {
      callback = a2;
      options2 = b2;
    } else if (typeof b2 === "function") {
      callback = b2;
      options2 = a2;
    } else {
      options2 = a2 !== null && a2 !== void 0 ? a2 : b2;
    }
    var testbed2 = Testbed.mount(options2);
    if (callback) {
      var world = callback(testbed2) || testbed2.world;
      testbed2.start(world);
    } else {
      return testbed2;
    }
  }
  var BoxShape = (
    /** @class */
    function(_super) {
      __extends(BoxShape2, _super);
      function BoxShape2(halfWidth, halfHeight, center2, angle) {
        var _this = this;
        if (!(_this instanceof BoxShape2)) {
          return new BoxShape2(halfWidth, halfHeight, center2, angle);
        }
        _this = _super.call(this) || this;
        _this._setAsBox(halfWidth, halfHeight, center2, angle);
        return _this;
      }
      BoxShape2.TYPE = "polygon";
      return BoxShape2;
    }(PolygonShape)
  );
  Contact.addType(CircleShape.TYPE, CircleShape.TYPE, CircleCircleContact);
  function CircleCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollideCircles(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  var pA = vec2(0, 0);
  var pB = vec2(0, 0);
  var CollideCircles = function(manifold, circleA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    transformVec2(pA, xfA2, circleA.m_p);
    transformVec2(pB, xfB2, circleB.m_p);
    var distSqr = distSqrVec2(pB, pA);
    var rA2 = circleA.m_radius;
    var rB2 = circleB.m_radius;
    var radius = rA2 + rB2;
    if (distSqr > radius * radius) {
      return;
    }
    manifold.type = exports2.ManifoldType.e_circles;
    copyVec2(manifold.localPoint, circleA.m_p);
    zeroVec2(manifold.localNormal);
    manifold.pointCount = 1;
    copyVec2(manifold.points[0].localPoint, circleB.m_p);
    manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
  };
  Contact.addType(EdgeShape.TYPE, CircleShape.TYPE, EdgeCircleContact);
  Contact.addType(ChainShape.TYPE, CircleShape.TYPE, ChainCircleContact);
  function EdgeCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    var shapeA = fixtureA.getShape();
    var shapeB = fixtureB.getShape();
    CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);
  }
  function ChainCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    var chain = fixtureA.getShape();
    var edge = new EdgeShape();
    chain.getChildEdge(edge, indexA);
    var shapeA = edge;
    var shapeB = fixtureB.getShape();
    CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);
  }
  var e = vec2(0, 0);
  var e1 = vec2(0, 0);
  var e2 = vec2(0, 0);
  var Q = vec2(0, 0);
  var P = vec2(0, 0);
  var n$2 = vec2(0, 0);
  var CollideEdgeCircle = function(manifold, edgeA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    retransformVec2(Q, xfB2, xfA2, circleB.m_p);
    var A = edgeA.m_vertex1;
    var B = edgeA.m_vertex2;
    subVec2(e, B, A);
    var u = dotVec2(e, B) - dotVec2(e, Q);
    var v3 = dotVec2(e, Q) - dotVec2(e, A);
    var radius = edgeA.m_radius + circleB.m_radius;
    if (v3 <= 0) {
      copyVec2(P, A);
      var dd_1 = distSqrVec2(Q, A);
      if (dd_1 > radius * radius) {
        return;
      }
      if (edgeA.m_hasVertex0) {
        var A1 = edgeA.m_vertex0;
        var B1 = A;
        subVec2(e1, B1, A1);
        var u1 = dotVec2(e1, B1) - dotVec2(e1, Q);
        if (u1 > 0) {
          return;
        }
      }
      manifold.type = exports2.ManifoldType.e_circles;
      zeroVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, P);
      manifold.pointCount = 1;
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    if (u <= 0) {
      copyVec2(P, B);
      var dd_2 = distSqrVec2(Q, P);
      if (dd_2 > radius * radius) {
        return;
      }
      if (edgeA.m_hasVertex3) {
        var B2 = edgeA.m_vertex3;
        var A2 = B;
        subVec2(e2, B2, A2);
        var v22 = dotVec2(e2, Q) - dotVec2(e2, A2);
        if (v22 > 0) {
          return;
        }
      }
      manifold.type = exports2.ManifoldType.e_circles;
      zeroVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, P);
      manifold.pointCount = 1;
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(1, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    var den = lengthSqrVec2(e);
    combine2Vec2(P, u / den, A, v3 / den, B);
    var dd = distSqrVec2(Q, P);
    if (dd > radius * radius) {
      return;
    }
    crossNumVec2(n$2, 1, e);
    if (dotVec2(n$2, Q) - dotVec2(n$2, A) < 0) {
      negVec2(n$2);
    }
    normalizeVec2(n$2);
    manifold.type = exports2.ManifoldType.e_faceA;
    copyVec2(manifold.localNormal, n$2);
    copyVec2(manifold.localPoint, A);
    manifold.pointCount = 1;
    copyVec2(manifold.points[0].localPoint, circleB.m_p);
    manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_face, 0, exports2.ContactFeatureType.e_vertex);
  };
  var incidentEdge = [new ClipVertex(), new ClipVertex()];
  var clipPoints1$1 = [new ClipVertex(), new ClipVertex()];
  var clipPoints2$1 = [new ClipVertex(), new ClipVertex()];
  var clipSegmentToLineNormal = vec2(0, 0);
  var v1 = vec2(0, 0);
  var n$1 = vec2(0, 0);
  var xf$1 = transform(0, 0, 0);
  var v11 = vec2(0, 0);
  var v12 = vec2(0, 0);
  var localTangent = vec2(0, 0);
  var localNormal = vec2(0, 0);
  var planePoint = vec2(0, 0);
  var tangent = vec2(0, 0);
  var normal$1 = vec2(0, 0);
  var normal1$1 = vec2(0, 0);
  Contact.addType(PolygonShape.TYPE, PolygonShape.TYPE, PolygonContact);
  function PolygonContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollidePolygons(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  function findMaxSeparation(poly1, xf1, poly2, xf2, output2) {
    var count1 = poly1.m_count;
    var count2 = poly2.m_count;
    var n1s = poly1.m_normals;
    var v1s = poly1.m_vertices;
    var v2s = poly2.m_vertices;
    detransformTransform(xf$1, xf2, xf1);
    var bestIndex = 0;
    var maxSeparation2 = -Infinity;
    for (var i = 0; i < count1; ++i) {
      rotVec2(n$1, xf$1.q, n1s[i]);
      transformVec2(v1, xf$1, v1s[i]);
      var si = Infinity;
      for (var j = 0; j < count2; ++j) {
        var sij = dotVec2(n$1, v2s[j]) - dotVec2(n$1, v1);
        if (sij < si) {
          si = sij;
        }
      }
      if (si > maxSeparation2) {
        maxSeparation2 = si;
        bestIndex = i;
      }
    }
    output2.maxSeparation = maxSeparation2;
    output2.bestIndex = bestIndex;
  }
  function findIncidentEdge(clipVertex, poly1, xf1, edge12, poly2, xf2) {
    var normals1 = poly1.m_normals;
    var count2 = poly2.m_count;
    var vertices2 = poly2.m_vertices;
    var normals2 = poly2.m_normals;
    rerotVec2(normal1$1, xf2.q, xf1.q, normals1[edge12]);
    var index = 0;
    var minDot = Infinity;
    for (var i = 0; i < count2; ++i) {
      var dot = dotVec2(normal1$1, normals2[i]);
      if (dot < minDot) {
        minDot = dot;
        index = i;
      }
    }
    var i1 = index;
    var i2 = i1 + 1 < count2 ? i1 + 1 : 0;
    transformVec2(clipVertex[0].v, xf2, vertices2[i1]);
    clipVertex[0].id.setFeatures(edge12, exports2.ContactFeatureType.e_face, i1, exports2.ContactFeatureType.e_vertex);
    transformVec2(clipVertex[1].v, xf2, vertices2[i2]);
    clipVertex[1].id.setFeatures(edge12, exports2.ContactFeatureType.e_face, i2, exports2.ContactFeatureType.e_vertex);
  }
  var maxSeparation = {
    maxSeparation: 0,
    bestIndex: 0
  };
  var CollidePolygons = function(manifold, polyA, xfA2, polyB, xfB2) {
    manifold.pointCount = 0;
    var totalRadius = polyA.m_radius + polyB.m_radius;
    findMaxSeparation(polyA, xfA2, polyB, xfB2, maxSeparation);
    var edgeA = maxSeparation.bestIndex;
    var separationA = maxSeparation.maxSeparation;
    if (separationA > totalRadius)
      return;
    findMaxSeparation(polyB, xfB2, polyA, xfA2, maxSeparation);
    var edgeB = maxSeparation.bestIndex;
    var separationB = maxSeparation.maxSeparation;
    if (separationB > totalRadius)
      return;
    var poly1;
    var poly2;
    var xf1;
    var xf2;
    var edge12;
    var flip;
    var k_tol = 0.1 * SettingsInternal.linearSlop;
    if (separationB > separationA + k_tol) {
      poly1 = polyB;
      poly2 = polyA;
      xf1 = xfB2;
      xf2 = xfA2;
      edge12 = edgeB;
      manifold.type = exports2.ManifoldType.e_faceB;
      flip = true;
    } else {
      poly1 = polyA;
      poly2 = polyB;
      xf1 = xfA2;
      xf2 = xfB2;
      edge12 = edgeA;
      manifold.type = exports2.ManifoldType.e_faceA;
      flip = false;
    }
    incidentEdge[0].recycle();
    incidentEdge[1].recycle();
    findIncidentEdge(incidentEdge, poly1, xf1, edge12, poly2, xf2);
    var count1 = poly1.m_count;
    var vertices1 = poly1.m_vertices;
    var iv1 = edge12;
    var iv2 = edge12 + 1 < count1 ? edge12 + 1 : 0;
    copyVec2(v11, vertices1[iv1]);
    copyVec2(v12, vertices1[iv2]);
    subVec2(localTangent, v12, v11);
    normalizeVec2(localTangent);
    crossVec2Num(localNormal, localTangent, 1);
    combine2Vec2(planePoint, 0.5, v11, 0.5, v12);
    rotVec2(tangent, xf1.q, localTangent);
    crossVec2Num(normal$1, tangent, 1);
    transformVec2(v11, xf1, v11);
    transformVec2(v12, xf1, v12);
    var frontOffset = dotVec2(normal$1, v11);
    var sideOffset1 = -dotVec2(tangent, v11) + totalRadius;
    var sideOffset2 = dotVec2(tangent, v12) + totalRadius;
    clipPoints1$1[0].recycle();
    clipPoints1$1[1].recycle();
    clipPoints2$1[0].recycle();
    clipPoints2$1[1].recycle();
    setVec2(clipSegmentToLineNormal, -tangent.x, -tangent.y);
    var np1 = clipSegmentToLine(clipPoints1$1, incidentEdge, clipSegmentToLineNormal, sideOffset1, iv1);
    if (np1 < 2) {
      return;
    }
    setVec2(clipSegmentToLineNormal, tangent.x, tangent.y);
    var np2 = clipSegmentToLine(clipPoints2$1, clipPoints1$1, clipSegmentToLineNormal, sideOffset2, iv2);
    if (np2 < 2) {
      return;
    }
    copyVec2(manifold.localNormal, localNormal);
    copyVec2(manifold.localPoint, planePoint);
    var pointCount = 0;
    for (var i = 0; i < clipPoints2$1.length; ++i) {
      var separation = dotVec2(normal$1, clipPoints2$1[i].v) - frontOffset;
      if (separation <= totalRadius) {
        var cp = manifold.points[pointCount];
        detransformVec2(cp.localPoint, xf2, clipPoints2$1[i].v);
        cp.id.set(clipPoints2$1[i].id);
        if (flip) {
          cp.id.swapFeatures();
        }
        ++pointCount;
      }
    }
    manifold.pointCount = pointCount;
  };
  Contact.addType(PolygonShape.TYPE, CircleShape.TYPE, PolygonCircleContact);
  function PolygonCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollidePolygonCircle(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  var cLocal = vec2(0, 0);
  var faceCenter = vec2(0, 0);
  var CollidePolygonCircle = function(manifold, polygonA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    retransformVec2(cLocal, xfB2, xfA2, circleB.m_p);
    var normalIndex = 0;
    var separation = -Infinity;
    var radius = polygonA.m_radius + circleB.m_radius;
    var vertexCount = polygonA.m_count;
    var vertices = polygonA.m_vertices;
    var normals = polygonA.m_normals;
    for (var i = 0; i < vertexCount; ++i) {
      var s2 = dotVec2(normals[i], cLocal) - dotVec2(normals[i], vertices[i]);
      if (s2 > radius) {
        return;
      }
      if (s2 > separation) {
        separation = s2;
        normalIndex = i;
      }
    }
    var vertIndex1 = normalIndex;
    var vertIndex2 = vertIndex1 + 1 < vertexCount ? vertIndex1 + 1 : 0;
    var v13 = vertices[vertIndex1];
    var v22 = vertices[vertIndex2];
    if (separation < EPSILON) {
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      copyVec2(manifold.localNormal, normals[normalIndex]);
      combine2Vec2(manifold.localPoint, 0.5, v13, 0.5, v22);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    var u1 = dotVec2(cLocal, v22) - dotVec2(cLocal, v13) - dotVec2(v13, v22) + dotVec2(v13, v13);
    var u2 = dotVec2(cLocal, v13) - dotVec2(cLocal, v22) - dotVec2(v22, v13) + dotVec2(v22, v22);
    if (u1 <= 0) {
      if (distSqrVec2(cLocal, v13) > radius * radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      subVec2(manifold.localNormal, cLocal, v13);
      normalizeVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, v13);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    } else if (u2 <= 0) {
      if (distSqrVec2(cLocal, v22) > radius * radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      subVec2(manifold.localNormal, cLocal, v22);
      normalizeVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, v22);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    } else {
      combine2Vec2(faceCenter, 0.5, v13, 0.5, v22);
      var separation_1 = dotVec2(cLocal, normals[vertIndex1]) - dotVec2(faceCenter, normals[vertIndex1]);
      if (separation_1 > radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      copyVec2(manifold.localNormal, normals[vertIndex1]);
      copyVec2(manifold.localPoint, faceCenter);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    }
  };
  var math_min = Math.min;
  Contact.addType(EdgeShape.TYPE, PolygonShape.TYPE, EdgePolygonContact);
  Contact.addType(ChainShape.TYPE, PolygonShape.TYPE, ChainPolygonContact);
  function EdgePolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {
    CollideEdgePolygon(manifold, fA.getShape(), xfA2, fB.getShape(), xfB2);
  }
  var edge_reuse = new EdgeShape();
  function ChainPolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {
    var chain = fA.getShape();
    chain.getChildEdge(edge_reuse, indexA);
    CollideEdgePolygon(manifold, edge_reuse, xfA2, fB.getShape(), xfB2);
  }
  var EPAxisType;
  (function(EPAxisType2) {
    EPAxisType2[EPAxisType2["e_unknown"] = -1] = "e_unknown";
    EPAxisType2[EPAxisType2["e_edgeA"] = 1] = "e_edgeA";
    EPAxisType2[EPAxisType2["e_edgeB"] = 2] = "e_edgeB";
  })(EPAxisType || (EPAxisType = {}));
  var VertexType;
  (function(VertexType2) {
    VertexType2[VertexType2["e_isolated"] = 0] = "e_isolated";
    VertexType2[VertexType2["e_concave"] = 1] = "e_concave";
    VertexType2[VertexType2["e_convex"] = 2] = "e_convex";
  })(VertexType || (VertexType = {}));
  var EPAxis = (
    /** @class */
    /* @__PURE__ */ function() {
      function EPAxis2() {
      }
      return EPAxis2;
    }()
  );
  var TempPolygon = (
    /** @class */
    /* @__PURE__ */ function() {
      function TempPolygon2() {
        this.vertices = [];
        this.normals = [];
        this.count = 0;
        for (var i = 0; i < SettingsInternal.maxPolygonVertices; i++) {
          this.vertices.push(vec2(0, 0));
          this.normals.push(vec2(0, 0));
        }
      }
      return TempPolygon2;
    }()
  );
  var ReferenceFace = (
    /** @class */
    function() {
      function ReferenceFace2() {
        this.v1 = vec2(0, 0);
        this.v2 = vec2(0, 0);
        this.normal = vec2(0, 0);
        this.sideNormal1 = vec2(0, 0);
        this.sideNormal2 = vec2(0, 0);
      }
      ReferenceFace2.prototype.recycle = function() {
        zeroVec2(this.v1);
        zeroVec2(this.v2);
        zeroVec2(this.normal);
        zeroVec2(this.sideNormal1);
        zeroVec2(this.sideNormal2);
      };
      return ReferenceFace2;
    }()
  );
  var clipPoints1 = [new ClipVertex(), new ClipVertex()];
  var clipPoints2 = [new ClipVertex(), new ClipVertex()];
  var ie = [new ClipVertex(), new ClipVertex()];
  var edgeAxis = new EPAxis();
  var polygonAxis = new EPAxis();
  var polygonBA = new TempPolygon();
  var rf = new ReferenceFace();
  var centroidB = vec2(0, 0);
  var edge0 = vec2(0, 0);
  var edge1 = vec2(0, 0);
  var edge2 = vec2(0, 0);
  var xf = transform(0, 0, 0);
  var normal = vec2(0, 0);
  var normal0 = vec2(0, 0);
  var normal1 = vec2(0, 0);
  var normal2 = vec2(0, 0);
  var lowerLimit = vec2(0, 0);
  var upperLimit = vec2(0, 0);
  var perp = vec2(0, 0);
  var n = vec2(0, 0);
  var CollideEdgePolygon = function(manifold, edgeA, xfA2, polygonB, xfB2) {
    detransformTransform(xf, xfA2, xfB2);
    transformVec2(centroidB, xf, polygonB.m_centroid);
    var v0 = edgeA.m_vertex0;
    var v13 = edgeA.m_vertex1;
    var v22 = edgeA.m_vertex2;
    var v3 = edgeA.m_vertex3;
    var hasVertex0 = edgeA.m_hasVertex0;
    var hasVertex3 = edgeA.m_hasVertex3;
    subVec2(edge1, v22, v13);
    normalizeVec2(edge1);
    setVec2(normal1, edge1.y, -edge1.x);
    var offset1 = dotVec2(normal1, centroidB) - dotVec2(normal1, v13);
    var offset0 = 0;
    var offset2 = 0;
    var convex1 = false;
    var convex2 = false;
    zeroVec2(normal0);
    zeroVec2(normal2);
    if (hasVertex0) {
      subVec2(edge0, v13, v0);
      normalizeVec2(edge0);
      setVec2(normal0, edge0.y, -edge0.x);
      convex1 = crossVec2Vec2(edge0, edge1) >= 0;
      offset0 = Vec2.dot(normal0, centroidB) - Vec2.dot(normal0, v0);
    }
    if (hasVertex3) {
      subVec2(edge2, v3, v22);
      normalizeVec2(edge2);
      setVec2(normal2, edge2.y, -edge2.x);
      convex2 = Vec2.crossVec2Vec2(edge1, edge2) > 0;
      offset2 = Vec2.dot(normal2, centroidB) - Vec2.dot(normal2, v22);
    }
    var front;
    zeroVec2(normal);
    zeroVec2(lowerLimit);
    zeroVec2(upperLimit);
    if (hasVertex0 && hasVertex3) {
      if (convex1 && convex2) {
        front = offset0 >= 0 || offset1 >= 0 || offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else if (convex1) {
        front = offset0 >= 0 || offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else if (convex2) {
        front = offset2 >= 0 || offset0 >= 0 && offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          scaleVec2(upperLimit, -1, normal0);
        }
      } else {
        front = offset0 >= 0 && offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          scaleVec2(upperLimit, -1, normal0);
        }
      }
    } else if (hasVertex0) {
      if (convex1) {
        front = offset0 >= 0 || offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          scaleVec2(upperLimit, -1, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else {
        front = offset0 >= 0 && offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal0);
        }
      }
    } else if (hasVertex3) {
      if (convex2) {
        front = offset1 >= 0 || offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal1);
        }
      } else {
        front = offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          copyVec2(upperLimit, normal1);
        }
      }
    } else {
      front = offset1 >= 0;
      if (front) {
        copyVec2(normal, normal1);
        scaleVec2(lowerLimit, -1, normal1);
        scaleVec2(upperLimit, -1, normal1);
      } else {
        scaleVec2(normal, -1, normal1);
        copyVec2(lowerLimit, normal1);
        copyVec2(upperLimit, normal1);
      }
    }
    polygonBA.count = polygonB.m_count;
    for (var i = 0; i < polygonB.m_count; ++i) {
      transformVec2(polygonBA.vertices[i], xf, polygonB.m_vertices[i]);
      rotVec2(polygonBA.normals[i], xf.q, polygonB.m_normals[i]);
    }
    var radius = polygonB.m_radius + edgeA.m_radius;
    manifold.pointCount = 0;
    {
      edgeAxis.type = EPAxisType.e_edgeA;
      edgeAxis.index = front ? 0 : 1;
      edgeAxis.separation = Infinity;
      for (var i = 0; i < polygonBA.count; ++i) {
        var v4 = polygonBA.vertices[i];
        var s2 = dotVec2(normal, v4) - dotVec2(normal, v13);
        if (s2 < edgeAxis.separation) {
          edgeAxis.separation = s2;
        }
      }
    }
    if (edgeAxis.type == EPAxisType.e_unknown) {
      return;
    }
    if (edgeAxis.separation > radius) {
      return;
    }
    {
      polygonAxis.type = EPAxisType.e_unknown;
      polygonAxis.index = -1;
      polygonAxis.separation = -Infinity;
      setVec2(perp, -normal.y, normal.x);
      for (var i = 0; i < polygonBA.count; ++i) {
        scaleVec2(n, -1, polygonBA.normals[i]);
        var s1 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v13);
        var s22 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v22);
        var s2 = math_min(s1, s22);
        if (s2 > radius) {
          polygonAxis.type = EPAxisType.e_edgeB;
          polygonAxis.index = i;
          polygonAxis.separation = s2;
          break;
        }
        if (dotVec2(n, perp) >= 0) {
          if (dotVec2(n, normal) - dotVec2(upperLimit, normal) < -SettingsInternal.angularSlop) {
            continue;
          }
        } else {
          if (dotVec2(n, normal) - dotVec2(lowerLimit, normal) < -SettingsInternal.angularSlop) {
            continue;
          }
        }
        if (s2 > polygonAxis.separation) {
          polygonAxis.type = EPAxisType.e_edgeB;
          polygonAxis.index = i;
          polygonAxis.separation = s2;
        }
      }
    }
    if (polygonAxis.type != EPAxisType.e_unknown && polygonAxis.separation > radius) {
      return;
    }
    var k_relativeTol = 0.98;
    var k_absoluteTol = 1e-3;
    var primaryAxis;
    if (polygonAxis.type == EPAxisType.e_unknown) {
      primaryAxis = edgeAxis;
    } else if (polygonAxis.separation > k_relativeTol * edgeAxis.separation + k_absoluteTol) {
      primaryAxis = polygonAxis;
    } else {
      primaryAxis = edgeAxis;
    }
    ie[0].recycle();
    ie[1].recycle();
    if (primaryAxis.type == EPAxisType.e_edgeA) {
      manifold.type = exports2.ManifoldType.e_faceA;
      var bestIndex = 0;
      var bestValue = dotVec2(normal, polygonBA.normals[0]);
      for (var i = 1; i < polygonBA.count; ++i) {
        var value = dotVec2(normal, polygonBA.normals[i]);
        if (value < bestValue) {
          bestValue = value;
          bestIndex = i;
        }
      }
      var i1 = bestIndex;
      var i2 = i1 + 1 < polygonBA.count ? i1 + 1 : 0;
      copyVec2(ie[0].v, polygonBA.vertices[i1]);
      ie[0].id.setFeatures(0, exports2.ContactFeatureType.e_face, i1, exports2.ContactFeatureType.e_vertex);
      copyVec2(ie[1].v, polygonBA.vertices[i2]);
      ie[1].id.setFeatures(0, exports2.ContactFeatureType.e_face, i2, exports2.ContactFeatureType.e_vertex);
      if (front) {
        rf.i1 = 0;
        rf.i2 = 1;
        copyVec2(rf.v1, v13);
        copyVec2(rf.v2, v22);
        copyVec2(rf.normal, normal1);
      } else {
        rf.i1 = 1;
        rf.i2 = 0;
        copyVec2(rf.v1, v22);
        copyVec2(rf.v2, v13);
        scaleVec2(rf.normal, -1, normal1);
      }
    } else {
      manifold.type = exports2.ManifoldType.e_faceB;
      copyVec2(ie[0].v, v13);
      ie[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, primaryAxis.index, exports2.ContactFeatureType.e_face);
      copyVec2(ie[1].v, v22);
      ie[1].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, primaryAxis.index, exports2.ContactFeatureType.e_face);
      rf.i1 = primaryAxis.index;
      rf.i2 = rf.i1 + 1 < polygonBA.count ? rf.i1 + 1 : 0;
      copyVec2(rf.v1, polygonBA.vertices[rf.i1]);
      copyVec2(rf.v2, polygonBA.vertices[rf.i2]);
      copyVec2(rf.normal, polygonBA.normals[rf.i1]);
    }
    setVec2(rf.sideNormal1, rf.normal.y, -rf.normal.x);
    setVec2(rf.sideNormal2, -rf.sideNormal1.x, -rf.sideNormal1.y);
    rf.sideOffset1 = dotVec2(rf.sideNormal1, rf.v1);
    rf.sideOffset2 = dotVec2(rf.sideNormal2, rf.v2);
    clipPoints1[0].recycle();
    clipPoints1[1].recycle();
    clipPoints2[0].recycle();
    clipPoints2[1].recycle();
    var np1 = clipSegmentToLine(clipPoints1, ie, rf.sideNormal1, rf.sideOffset1, rf.i1);
    if (np1 < SettingsInternal.maxManifoldPoints) {
      return;
    }
    var np2 = clipSegmentToLine(clipPoints2, clipPoints1, rf.sideNormal2, rf.sideOffset2, rf.i2);
    if (np2 < SettingsInternal.maxManifoldPoints) {
      return;
    }
    if (primaryAxis.type == EPAxisType.e_edgeA) {
      copyVec2(manifold.localNormal, rf.normal);
      copyVec2(manifold.localPoint, rf.v1);
    } else {
      copyVec2(manifold.localNormal, polygonB.m_normals[rf.i1]);
      copyVec2(manifold.localPoint, polygonB.m_vertices[rf.i1]);
    }
    var pointCount = 0;
    for (var i = 0; i < SettingsInternal.maxManifoldPoints; ++i) {
      var separation = dotVec2(rf.normal, clipPoints2[i].v) - dotVec2(rf.normal, rf.v1);
      if (separation <= radius) {
        var cp = manifold.points[pointCount];
        if (primaryAxis.type == EPAxisType.e_edgeA) {
          detransformVec2(cp.localPoint, xf, clipPoints2[i].v);
          cp.id.set(clipPoints2[i].id);
        } else {
          copyVec2(cp.localPoint, clipPoints2[i].v);
          cp.id.set(clipPoints2[i].id);
          cp.id.swapFeatures();
        }
        ++pointCount;
      }
    }
    manifold.pointCount = pointCount;
  };
  var internal = {
    CollidePolygons,
    Settings,
    Sweep,
    Manifold,
    Distance,
    TimeOfImpact,
    DynamicTree,
    stats
  };
  var DataDriver = (
    /** @class */
    function() {
      function DataDriver2(key, listener) {
        this._refMap = {};
        this._map = {};
        this._xmap = {};
        this._data = [];
        this._entered = [];
        this._exited = [];
        this._key = key;
        this._listener = listener;
      }
      DataDriver2.prototype.update = function(data) {
        if (!Array.isArray(data))
          throw "Invalid data: " + data;
        this._entered.length = 0;
        this._exited.length = 0;
        this._data.length = data.length;
        for (var i = 0; i < data.length; i++) {
          if (typeof data[i] !== "object" || data[i] === null)
            continue;
          var d2 = data[i];
          var id = this._key(d2);
          if (!this._map[id]) {
            this._entered.push(d2);
          } else {
            delete this._map[id];
          }
          this._data[i] = d2;
          this._xmap[id] = d2;
        }
        for (var id in this._map) {
          this._exited.push(this._map[id]);
          delete this._map[id];
        }
        var temp3 = this._map;
        this._map = this._xmap;
        this._xmap = temp3;
        for (var i = 0; i < this._exited.length; i++) {
          var d2 = this._exited[i];
          var key = this._key(d2);
          var ref = this._refMap[key];
          this._listener.exit(d2, ref);
          delete this._refMap[key];
        }
        for (var i = 0; i < this._entered.length; i++) {
          var d2 = this._entered[i];
          var key = this._key(d2);
          var ref = this._listener.enter(d2);
          if (ref) {
            this._refMap[key] = ref;
          }
        }
        for (var i = 0; i < this._data.length; i++) {
          if (typeof data[i] !== "object" || data[i] === null)
            continue;
          var d2 = this._data[i];
          var key = this._key(d2);
          var ref = this._refMap[key];
          this._listener.update(d2, ref);
        }
        this._entered.length = 0;
        this._exited.length = 0;
        this._data.length = 0;
      };
      DataDriver2.prototype.ref = function(d2) {
        return this._refMap[this._key(d2)];
      };
      return DataDriver2;
    }()
  );
  const planck = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
    __proto__: null,
    AABB,
    Body,
    Box: BoxShape,
    BoxShape,
    BroadPhase,
    Chain: ChainShape,
    ChainShape,
    Circle: CircleShape,
    CircleShape,
    ClipVertex,
    CollideCircles,
    CollideEdgeCircle,
    CollideEdgePolygon,
    CollidePolygonCircle,
    CollidePolygons,
    Contact,
    ContactEdge,
    get ContactFeatureType() {
      return exports2.ContactFeatureType;
    },
    ContactID,
    ContactImpulse,
    DataDriver,
    Distance,
    DistanceInput,
    DistanceJoint,
    DistanceOutput,
    DistanceProxy,
    DynamicTree,
    Edge: EdgeShape,
    EdgeShape,
    Fixture,
    FixtureProxy,
    FrictionJoint,
    GearJoint,
    Joint,
    JointEdge,
    Manifold,
    ManifoldPoint,
    get ManifoldType() {
      return exports2.ManifoldType;
    },
    Mat22,
    Mat33,
    Math: math,
    MotorJoint,
    MouseJoint,
    get PointState() {
      return exports2.PointState;
    },
    Polygon: PolygonShape,
    PolygonShape,
    PrismaticJoint,
    PulleyJoint,
    RevoluteJoint,
    RopeJoint,
    Rot,
    Serializer,
    Settings,
    SettingsInternal,
    Shape,
    ShapeCast,
    ShapeCastInput,
    ShapeCastOutput,
    SimplexCache,
    Solver,
    Sweep,
    TOIInput,
    TOIOutput,
    get TOIOutputState() {
      return exports2.TOIOutputState;
    },
    Testbed,
    TimeOfImpact,
    TimeStep,
    Transform,
    TreeNode,
    Vec2,
    Vec3,
    VelocityConstraintPoint,
    WeldJoint,
    WheelJoint,
    World,
    WorldManifold,
    clipSegmentToLine,
    getPointStates,
    internal,
    mixFriction,
    mixRestitution,
    stats,
    testOverlap,
    testbed
  }, Symbol.toStringTag, { value: "Module" }));
  exports2.AABB = AABB;
  exports2.Body = Body;
  exports2.Box = BoxShape;
  exports2.BoxShape = BoxShape;
  exports2.BroadPhase = BroadPhase;
  exports2.Chain = ChainShape;
  exports2.ChainShape = ChainShape;
  exports2.Circle = CircleShape;
  exports2.CircleShape = CircleShape;
  exports2.ClipVertex = ClipVertex;
  exports2.CollideCircles = CollideCircles;
  exports2.CollideEdgeCircle = CollideEdgeCircle;
  exports2.CollideEdgePolygon = CollideEdgePolygon;
  exports2.CollidePolygonCircle = CollidePolygonCircle;
  exports2.CollidePolygons = CollidePolygons;
  exports2.Contact = Contact;
  exports2.ContactEdge = ContactEdge;
  exports2.ContactID = ContactID;
  exports2.ContactImpulse = ContactImpulse;
  exports2.DataDriver = DataDriver;
  exports2.Distance = Distance;
  exports2.DistanceInput = DistanceInput;
  exports2.DistanceJoint = DistanceJoint;
  exports2.DistanceOutput = DistanceOutput;
  exports2.DistanceProxy = DistanceProxy;
  exports2.DynamicTree = DynamicTree;
  exports2.Edge = EdgeShape;
  exports2.EdgeShape = EdgeShape;
  exports2.Fixture = Fixture;
  exports2.FixtureProxy = FixtureProxy;
  exports2.FrictionJoint = FrictionJoint;
  exports2.GearJoint = GearJoint;
  exports2.Joint = Joint;
  exports2.JointEdge = JointEdge;
  exports2.Manifold = Manifold;
  exports2.ManifoldPoint = ManifoldPoint;
  exports2.Mat22 = Mat22;
  exports2.Mat33 = Mat33;
  exports2.Math = math;
  exports2.MotorJoint = MotorJoint;
  exports2.MouseJoint = MouseJoint;
  exports2.Polygon = PolygonShape;
  exports2.PolygonShape = PolygonShape;
  exports2.PrismaticJoint = PrismaticJoint;
  exports2.PulleyJoint = PulleyJoint;
  exports2.RevoluteJoint = RevoluteJoint;
  exports2.RopeJoint = RopeJoint;
  exports2.Rot = Rot;
  exports2.Serializer = Serializer;
  exports2.Settings = Settings;
  exports2.SettingsInternal = SettingsInternal;
  exports2.Shape = Shape;
  exports2.ShapeCast = ShapeCast;
  exports2.ShapeCastInput = ShapeCastInput;
  exports2.ShapeCastOutput = ShapeCastOutput;
  exports2.SimplexCache = SimplexCache;
  exports2.Solver = Solver;
  exports2.Sweep = Sweep;
  exports2.TOIInput = TOIInput;
  exports2.TOIOutput = TOIOutput;
  exports2.Testbed = Testbed;
  exports2.TimeOfImpact = TimeOfImpact;
  exports2.TimeStep = TimeStep;
  exports2.Transform = Transform;
  exports2.TreeNode = TreeNode;
  exports2.Vec2 = Vec2;
  exports2.Vec3 = Vec3;
  exports2.VelocityConstraintPoint = VelocityConstraintPoint;
  exports2.WeldJoint = WeldJoint;
  exports2.WheelJoint = WheelJoint;
  exports2.World = World;
  exports2.WorldManifold = WorldManifold;
  exports2.clipSegmentToLine = clipSegmentToLine;
  exports2.default = planck;
  exports2.getPointStates = getPointStates;
  exports2.internal = internal;
  exports2.mixFriction = mixFriction;
  exports2.mixRestitution = mixRestitution;
  exports2.stats = stats;
  exports2.testOverlap = testOverlap;
  exports2.testbed = testbed;
  Object.defineProperties(exports2, { __esModule: { value: true }, [Symbol.toStringTag]: { value: "Module" } });
});
//# sourceMappingURL=planck.js.map


/***/ }),

/***/ "./src/core/asset-loader.ts":
/*!**********************************!*\
  !*** ./src/core/asset-loader.ts ***!
  \**********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.AssetLoader = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const event_system_1 = __webpack_require__(/*! ./event-system */ "./src/core/event-system.ts");
class AssetLoader {
    PIXIAssets = pixi_js_1.default.Assets;
    textures = [];
    isLoading = false;
    events = new event_system_1.EventEmitter();
    on(event, listener) {
        this.events.on(event, listener);
    }
    off(event, listener) {
        this.events.off(event, listener);
    }
    loadAssets = async (assets) => {
        const { PIXIAssets } = this;
        const failedAssets = [];
        this.isLoading = true;
        this.events.emit('loading:start');
        try {
            for (let i = 0; i < assets.length; i++) {
                const { src, alias } = assets[i];
                try {
                    if (alias) {
                        if (!PIXIAssets.cache.has(alias)) {
                            const texture = await PIXIAssets.load({ alias, src });
                            this.textures.push(texture);
                        }
                    }
                    else {
                        const texture = await PIXIAssets.load(src);
                        this.textures.push(texture);
                    }
                }
                catch (error) {
                    console.error(`Failed to load asset: ${src}`, error);
                    failedAssets.push(src);
                }
            }
            if (failedAssets.length > 0) {
                console.warn(`${failedAssets.length} asset(s) failed to load:`, failedAssets);
            }
            return this;
        }
        finally {
            this.isLoading = false;
            this.events.emit('loading:end');
        }
    };
}
exports.AssetLoader = AssetLoader;


/***/ }),

/***/ "./src/core/camera.ts":
/*!****************************!*\
  !*** ./src/core/camera.ts ***!
  \****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Camera = exports.CameraLogic = void 0;
const pixi_js_1 = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const logic_1 = __webpack_require__(/*! ./logic */ "./src/core/logic.ts");
const moxi_entity_1 = __webpack_require__(/*! ./moxi-entity */ "./src/core/moxi-entity.ts");
const utils_1 = __webpack_require__(/*! ../library/utils */ "./src/library/utils.ts");
class CameraLogic extends logic_1.Logic {
    name = 'CameraLogic';
    speed = 0.1;
    target = null;
    entity;
    renderer;
    init(entity, renderer) {
        this.entity = entity;
        this.renderer = renderer;
    }
    update(entity, deltaTime) {
        const { speed } = this;
        const deltaSpeed = Math.min(deltaTime * speed, 1);
        const isZooming = Math.abs(entity.scale.x - entity.desiredScale.x) > 0.01 ||
            Math.abs(entity.scale.y - entity.desiredScale.y) > 0.01;
        if (entity.desiredScale !== entity.scale) {
            entity.scale.x = (0, utils_1.lerp)(entity.scale.x, entity.desiredScale.x, deltaSpeed);
            entity.scale.y = (0, utils_1.lerp)(entity.scale.y, entity.desiredScale.y, deltaSpeed);
        }
        if (this.target) {
            const screenCenterX = this.renderer.width / 2;
            const screenCenterY = this.renderer.height / 2;
            const desiredX = -(this.target.position.x * entity.scale.x) + screenCenterX;
            const desiredY = -(this.target.position.y * entity.scale.y) + screenCenterY;
            entity.desiredPosition.set(-desiredX, -desiredY);
        }
        if (entity.desiredPosition !== entity.position) {
            if (isZooming) {
                entity.position.copyFrom(entity.desiredPosition);
            }
            else {
                entity.position.x = (0, utils_1.lerp)(entity.position.x, entity.desiredPosition.x, deltaSpeed);
                entity.position.y = (0, utils_1.lerp)(entity.position.y, entity.desiredPosition.y, deltaSpeed);
            }
        }
        entity.scene.scale.set(entity.scale.x, entity.scale.y);
        entity.scene.position.set(-entity.position.x, -entity.position.y);
    }
}
exports.CameraLogic = CameraLogic;
class Camera extends pixi_js_1.default.Container {
    scene;
    renderer;
    speed = 0.1;
    moxiEntity;
    desiredScale = new pixi_js_1.Point(1, 1);
    desiredPosition = new pixi_js_1.Point(0, 0);
    constructor(scene, renderer, logic = {}) {
        super();
        this.scene = scene;
        this.renderer = renderer;
        const cameraLogic = new CameraLogic();
        cameraLogic.init(this, renderer);
        this.moxiEntity = new moxi_entity_1.MoxiEntity(this, logic);
        this.moxiEntity.addLogic(cameraLogic);
        this.scene.addChild(this);
    }
}
exports.Camera = Camera;


/***/ }),

/***/ "./src/core/engine.ts":
/*!****************************!*\
  !*** ./src/core/engine.ts ***!
  \****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Engine = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
class Engine {
    ticker;
    root;
    physicsWorld;
    logger;
    loggerFrequencyMs;
    nextLogTime;
    constructor(stage = null) {
        this.root = stage;
        const ticker = pixi_js_1.default.Ticker.shared;
        ticker.autoStart = false;
        ticker.add(this.gameLoop);
        this.ticker = ticker;
        this.loggerFrequencyMs = 500;
        this.nextLogTime = 0;
        this.logger = (msg) => null;
    }
    start() {
        this.ticker.start();
        return this;
    }
    stop() {
        this.ticker.stop();
        return this;
    }
    addPhysicsWorld(physicsWorld) {
        this.physicsWorld = physicsWorld;
        return this;
    }
    gameLoop = (tikerTime) => {
        if (this.root) {
            const { deltaTime, deltaMS } = tikerTime;
            if (this.physicsWorld) {
                const deltaSeconds = deltaMS / 1000;
                this.physicsWorld.step(deltaSeconds);
            }
            this.root.update(deltaTime);
            this.root.draw(deltaTime);
        }
    };
    loadStage(stage) {
        this.root = stage;
        return this;
    }
}
exports.Engine = Engine;


/***/ }),

/***/ "./src/core/event-system.ts":
/*!**********************************!*\
  !*** ./src/core/event-system.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.EventEmitter = void 0;
class EventEmitter {
    listeners = {};
    static instance = null;
    on(event, listener) {
        (this.listeners[event] || (this.listeners[event] = [])).push(listener);
    }
    off(event, listener) {
        const eventListeners = this.listeners[event];
        if (eventListeners) {
            this.listeners[event] = eventListeners.filter(l => l !== listener);
        }
    }
    emit(event, ...args) {
        (this.listeners[event] || []).forEach(listener => listener(...args));
    }
    once(event, listener) {
        const onceListener = (...args) => {
            listener(...args);
            this.off(event, listener);
        };
        this.on(event, onceListener);
    }
    static getInstance() {
        if (!EventEmitter.instance) {
            EventEmitter.instance = new EventEmitter();
        }
        return EventEmitter.instance;
    }
}
exports.EventEmitter = EventEmitter;


/***/ }),

/***/ "./src/core/logic.ts":
/*!***************************!*\
  !*** ./src/core/logic.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.InstancedLogic = exports.Logic = void 0;
class Logic {
    name;
    active = true;
    init(entity, renderer, ...args) { }
    update(entity, deltaTime) { }
}
exports.Logic = Logic;
class InstancedLogic extends Logic {
}
exports.InstancedLogic = InstancedLogic;


/***/ }),

/***/ "./src/core/moxi-entity.ts":
/*!*********************************!*\
  !*** ./src/core/moxi-entity.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.MoxiEntity = void 0;
exports.asEntity = asEntity;
class MoxiEntity {
    logic = {};
    entity;
    constructor(entity, logic = {}) {
        this.logic = logic;
        this.entity = entity;
    }
    update(deltaTime) {
        if (!this.entity)
            return;
        for (const className in this.logic) {
            const logicComponent = this.logic[className];
            if (logicComponent && logicComponent.active && logicComponent.update) {
                logicComponent.update(this.entity, deltaTime);
            }
        }
    }
    init(renderer, ...args) {
        if (!this.entity)
            return;
        for (const className in this.logic) {
            const logicComponent = this.logic[className];
            if (logicComponent && logicComponent.init) {
                logicComponent.init(this.entity, renderer, ...args);
            }
        }
    }
    addLogic(logic) {
        const logicName = logic.name || logic.constructor.name;
        this.logic[logicName] = logic;
    }
    getLogic(name) {
        return this.logic[name];
    }
}
exports.MoxiEntity = MoxiEntity;
function asEntity(entity, logic = {}) {
    const target = entity;
    target.isInteractive = () => false;
    target.moxiEntity = new MoxiEntity(target, logic);
    return entity;
}


/***/ }),

/***/ "./src/core/render-manager.ts":
/*!************************************!*\
  !*** ./src/core/render-manager.ts ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.RenderManager = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
class RenderManager {
    static getRenderer;
    static create;
    htmlRoot;
    renderer;
    fitToWindow = false;
    constructor(htmlRoot, renderer) {
        this.htmlRoot = htmlRoot;
        this.renderer = renderer;
        htmlRoot.appendChild(this.renderer.canvas);
        window.addEventListener('resize', () => this.onResize());
        this.onResize();
    }
    render(stage) {
        this.renderer.render(stage);
    }
    onResize = () => {
        const { renderer, htmlRoot: root } = this;
        const canvas = renderer.canvas;
        const parentWidth = root.clientWidth;
        const parentHeight = root.clientHeight;
        const canvasWidth = renderer.width;
        const canvasHeight = renderer.height;
        const scale = Math.min(parentWidth / canvasWidth, parentHeight / canvasHeight);
        canvas.style.width = `${Math.floor(canvasWidth * scale)}px`;
        canvas.style.height = `${Math.floor(canvasHeight * scale)}px`;
    };
}
exports.RenderManager = RenderManager;
RenderManager.getRenderer = async (options) => (await pixi_js_1.default.autoDetectRenderer(options));
RenderManager.create = async (htmlRoot, options) => (new RenderManager(htmlRoot, await RenderManager.getRenderer(options)));


/***/ }),

/***/ "./src/core/scene.ts":
/*!***************************!*\
  !*** ./src/core/scene.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Scene = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function isMoxiEntity(entity) {
    return entity != null && typeof entity === 'object' && 'moxiEntity' in entity;
}
class Scene extends pixi_js_1.default.Container {
    renderer;
    constructor(renderer) {
        super();
        this.renderer = renderer;
    }
    init() {
        this.children.forEach((child) => {
            if (isMoxiEntity(child)) {
                child.moxiEntity.init(this.renderer);
            }
        });
    }
    update(deltaTime) {
        this.children.forEach((child) => {
            if (isMoxiEntity(child)) {
                child.moxiEntity.update(deltaTime);
            }
        });
    }
    draw(deltaTime) {
        this.renderer.render(this);
    }
}
exports.Scene = Scene;


/***/ }),

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.FlexDirection = exports.FlexContainer = exports.UIFocusManager = exports.UIComponent = exports.EdgeInsets = exports.applyMaterial = exports.PhysicsMaterials = exports.createShapeFromSprite = exports.getPhysicsBody = exports.hasPhysics = exports.asPhysicsEntity = exports.CollisionManager = exports.CollisionRegistry = exports.PhysicsDebugRenderer = exports.PhysicsBodyLogic = exports.PhysicsWorld = exports.StateLogic = exports.StateMachine = exports.utils = exports.TilingParallaxLayer = exports.TextureFrameSequences = exports.setupResponsiveCanvas = exports.Scene = exports.RenderManager = exports.setupMoxi = exports.FallingSquaresAnimation = exports.LoadingScene = exports.ParallaxLayer = exports.ParallaxBackgroundLogic = exports.ParallaxBackground = exports.MoxiEntity = exports.loadFonts = exports.getTextureRange = exports.EventEmitter = exports.Engine = exports.defaultRenderOptions = exports.createTileGrid = exports.createResizeHandler = exports.ClientEvents = exports.CameraLogic = exports.Camera = exports.Logic = exports.asContainer = exports.asGraphics = exports.asText = exports.asSprite = exports.asBitmapText = exports.asTextureFrames = exports.asEntity = exports.AssetLoader = void 0;
exports.createBorderConfig = exports.BORDER = exports.GRID = exports.units = exports.px = exports.PixelGrid = exports.svgToTexture = exports.UIScaleMode = exports.UILayer = exports.UITabs = exports.UIScrollContainer = exports.UITextArea = exports.UITextInput = exports.UISelect = exports.ButtonState = exports.UIButton = exports.UIPanel = exports.UILabel = exports.UIBox = exports.FlexAlign = exports.FlexJustify = void 0;
const utils = __importStar(__webpack_require__(/*! ./library/utils */ "./src/library/utils.ts"));
exports.utils = utils;
const render_manager_1 = __webpack_require__(/*! ./core/render-manager */ "./src/core/render-manager.ts");
Object.defineProperty(exports, "RenderManager", ({ enumerable: true, get: function () { return render_manager_1.RenderManager; } }));
const scene_1 = __webpack_require__(/*! ./core/scene */ "./src/core/scene.ts");
Object.defineProperty(exports, "Scene", ({ enumerable: true, get: function () { return scene_1.Scene; } }));
const engine_1 = __webpack_require__(/*! ./core/engine */ "./src/core/engine.ts");
Object.defineProperty(exports, "Engine", ({ enumerable: true, get: function () { return engine_1.Engine; } }));
const event_system_1 = __webpack_require__(/*! ./core/event-system */ "./src/core/event-system.ts");
Object.defineProperty(exports, "EventEmitter", ({ enumerable: true, get: function () { return event_system_1.EventEmitter; } }));
const client_events_1 = __webpack_require__(/*! ./library/client-events */ "./src/library/client-events.ts");
Object.defineProperty(exports, "ClientEvents", ({ enumerable: true, get: function () { return client_events_1.ClientEvents; } }));
const asset_loader_1 = __webpack_require__(/*! ./core/asset-loader */ "./src/core/asset-loader.ts");
Object.defineProperty(exports, "AssetLoader", ({ enumerable: true, get: function () { return asset_loader_1.AssetLoader; } }));
const logic_1 = __webpack_require__(/*! ./core/logic */ "./src/core/logic.ts");
Object.defineProperty(exports, "Logic", ({ enumerable: true, get: function () { return logic_1.Logic; } }));
const setup_1 = __webpack_require__(/*! ./library/setup */ "./src/library/setup.ts");
Object.defineProperty(exports, "defaultRenderOptions", ({ enumerable: true, get: function () { return setup_1.defaultRenderOptions; } }));
Object.defineProperty(exports, "setupMoxi", ({ enumerable: true, get: function () { return setup_1.setupMoxi; } }));
const font_loader_1 = __webpack_require__(/*! ./library/font-loader */ "./src/library/font-loader.ts");
Object.defineProperty(exports, "loadFonts", ({ enumerable: true, get: function () { return font_loader_1.loadFonts; } }));
const moxi_entity_1 = __webpack_require__(/*! ./core/moxi-entity */ "./src/core/moxi-entity.ts");
Object.defineProperty(exports, "asEntity", ({ enumerable: true, get: function () { return moxi_entity_1.asEntity; } }));
Object.defineProperty(exports, "MoxiEntity", ({ enumerable: true, get: function () { return moxi_entity_1.MoxiEntity; } }));
const camera_1 = __webpack_require__(/*! ./core/camera */ "./src/core/camera.ts");
Object.defineProperty(exports, "Camera", ({ enumerable: true, get: function () { return camera_1.Camera; } }));
Object.defineProperty(exports, "CameraLogic", ({ enumerable: true, get: function () { return camera_1.CameraLogic; } }));
const texture_frames_1 = __webpack_require__(/*! ./library/texture-frames */ "./src/library/texture-frames.ts");
Object.defineProperty(exports, "asTextureFrames", ({ enumerable: true, get: function () { return texture_frames_1.asTextureFrames; } }));
const as_pixi_1 = __webpack_require__(/*! ./library/as-pixi */ "./src/library/as-pixi.ts");
Object.defineProperty(exports, "asBitmapText", ({ enumerable: true, get: function () { return as_pixi_1.asBitmapText; } }));
Object.defineProperty(exports, "asSprite", ({ enumerable: true, get: function () { return as_pixi_1.asSprite; } }));
Object.defineProperty(exports, "asText", ({ enumerable: true, get: function () { return as_pixi_1.asText; } }));
Object.defineProperty(exports, "asGraphics", ({ enumerable: true, get: function () { return as_pixi_1.asGraphics; } }));
Object.defineProperty(exports, "asContainer", ({ enumerable: true, get: function () { return as_pixi_1.asContainer; } }));
const texture_frame_sequences_1 = __webpack_require__(/*! ./library/texture-frame-sequences */ "./src/library/texture-frame-sequences.ts");
Object.defineProperty(exports, "TextureFrameSequences", ({ enumerable: true, get: function () { return texture_frame_sequences_1.TextureFrameSequences; } }));
const resize_handler_1 = __webpack_require__(/*! ./library/resize-handler */ "./src/library/resize-handler.ts");
Object.defineProperty(exports, "createResizeHandler", ({ enumerable: true, get: function () { return resize_handler_1.createResizeHandler; } }));
Object.defineProperty(exports, "setupResponsiveCanvas", ({ enumerable: true, get: function () { return resize_handler_1.setupResponsiveCanvas; } }));
const edge_insets_1 = __webpack_require__(/*! ./ui/core/edge-insets */ "./src/ui/core/edge-insets.ts");
Object.defineProperty(exports, "EdgeInsets", ({ enumerable: true, get: function () { return edge_insets_1.EdgeInsets; } }));
const ui_component_1 = __webpack_require__(/*! ./ui/core/ui-component */ "./src/ui/core/ui-component.ts");
Object.defineProperty(exports, "UIComponent", ({ enumerable: true, get: function () { return ui_component_1.UIComponent; } }));
const ui_focus_manager_1 = __webpack_require__(/*! ./ui/core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
Object.defineProperty(exports, "UIFocusManager", ({ enumerable: true, get: function () { return ui_focus_manager_1.UIFocusManager; } }));
const flex_container_1 = __webpack_require__(/*! ./ui/layout/flex-container */ "./src/ui/layout/flex-container.ts");
Object.defineProperty(exports, "FlexContainer", ({ enumerable: true, get: function () { return flex_container_1.FlexContainer; } }));
Object.defineProperty(exports, "FlexDirection", ({ enumerable: true, get: function () { return flex_container_1.FlexDirection; } }));
Object.defineProperty(exports, "FlexJustify", ({ enumerable: true, get: function () { return flex_container_1.FlexJustify; } }));
Object.defineProperty(exports, "FlexAlign", ({ enumerable: true, get: function () { return flex_container_1.FlexAlign; } }));
const ui_box_1 = __webpack_require__(/*! ./ui/components/ui-box */ "./src/ui/components/ui-box.ts");
Object.defineProperty(exports, "UIBox", ({ enumerable: true, get: function () { return ui_box_1.UIBox; } }));
const ui_label_1 = __webpack_require__(/*! ./ui/components/ui-label */ "./src/ui/components/ui-label.ts");
Object.defineProperty(exports, "UILabel", ({ enumerable: true, get: function () { return ui_label_1.UILabel; } }));
const ui_panel_1 = __webpack_require__(/*! ./ui/components/ui-panel */ "./src/ui/components/ui-panel.ts");
Object.defineProperty(exports, "UIPanel", ({ enumerable: true, get: function () { return ui_panel_1.UIPanel; } }));
const ui_button_1 = __webpack_require__(/*! ./ui/components/ui-button */ "./src/ui/components/ui-button.ts");
Object.defineProperty(exports, "UIButton", ({ enumerable: true, get: function () { return ui_button_1.UIButton; } }));
Object.defineProperty(exports, "ButtonState", ({ enumerable: true, get: function () { return ui_button_1.ButtonState; } }));
const ui_select_1 = __webpack_require__(/*! ./ui/components/ui-select */ "./src/ui/components/ui-select.ts");
Object.defineProperty(exports, "UISelect", ({ enumerable: true, get: function () { return ui_select_1.UISelect; } }));
const ui_text_input_1 = __webpack_require__(/*! ./ui/components/ui-text-input */ "./src/ui/components/ui-text-input.ts");
Object.defineProperty(exports, "UITextInput", ({ enumerable: true, get: function () { return ui_text_input_1.UITextInput; } }));
const ui_textarea_1 = __webpack_require__(/*! ./ui/components/ui-textarea */ "./src/ui/components/ui-textarea.ts");
Object.defineProperty(exports, "UITextArea", ({ enumerable: true, get: function () { return ui_textarea_1.UITextArea; } }));
const ui_scroll_container_1 = __webpack_require__(/*! ./ui/components/ui-scroll-container */ "./src/ui/components/ui-scroll-container.ts");
Object.defineProperty(exports, "UIScrollContainer", ({ enumerable: true, get: function () { return ui_scroll_container_1.UIScrollContainer; } }));
const ui_tabs_1 = __webpack_require__(/*! ./ui/components/ui-tabs */ "./src/ui/components/ui-tabs.ts");
Object.defineProperty(exports, "UITabs", ({ enumerable: true, get: function () { return ui_tabs_1.UITabs; } }));
const UILayer_1 = __webpack_require__(/*! ./ui/UILayer */ "./src/ui/UILayer.ts");
Object.defineProperty(exports, "UILayer", ({ enumerable: true, get: function () { return UILayer_1.UILayer; } }));
const UIScaleMode_1 = __webpack_require__(/*! ./ui/UIScaleMode */ "./src/ui/UIScaleMode.ts");
Object.defineProperty(exports, "UIScaleMode", ({ enumerable: true, get: function () { return UIScaleMode_1.UIScaleMode; } }));
const state_machine_1 = __webpack_require__(/*! ./library/state-machine */ "./src/library/state-machine.ts");
Object.defineProperty(exports, "StateMachine", ({ enumerable: true, get: function () { return state_machine_1.StateMachine; } }));
const state_logic_1 = __webpack_require__(/*! ./library/state-logic */ "./src/library/state-logic.ts");
Object.defineProperty(exports, "StateLogic", ({ enumerable: true, get: function () { return state_logic_1.StateLogic; } }));
const grid_generator_1 = __webpack_require__(/*! ./library/grid-generator */ "./src/library/grid-generator.ts");
Object.defineProperty(exports, "createTileGrid", ({ enumerable: true, get: function () { return grid_generator_1.createTileGrid; } }));
Object.defineProperty(exports, "getTextureRange", ({ enumerable: true, get: function () { return grid_generator_1.getTextureRange; } }));
const svg_to_texture_1 = __webpack_require__(/*! ./library/svg-utils/svg-to-texture */ "./src/library/svg-utils/svg-to-texture.ts");
Object.defineProperty(exports, "svgToTexture", ({ enumerable: true, get: function () { return svg_to_texture_1.svgToTexture; } }));
const pixel_grid_1 = __webpack_require__(/*! ./ui/pixel-grid */ "./src/ui/pixel-grid.ts");
Object.defineProperty(exports, "PixelGrid", ({ enumerable: true, get: function () { return pixel_grid_1.PixelGrid; } }));
Object.defineProperty(exports, "px", ({ enumerable: true, get: function () { return pixel_grid_1.px; } }));
Object.defineProperty(exports, "units", ({ enumerable: true, get: function () { return pixel_grid_1.units; } }));
Object.defineProperty(exports, "GRID", ({ enumerable: true, get: function () { return pixel_grid_1.GRID; } }));
Object.defineProperty(exports, "BORDER", ({ enumerable: true, get: function () { return pixel_grid_1.BORDER; } }));
Object.defineProperty(exports, "createBorderConfig", ({ enumerable: true, get: function () { return pixel_grid_1.createBorderConfig; } }));
const parallax_background_1 = __webpack_require__(/*! ./library/parallax-background */ "./src/library/parallax-background.ts");
Object.defineProperty(exports, "ParallaxBackground", ({ enumerable: true, get: function () { return parallax_background_1.ParallaxBackground; } }));
Object.defineProperty(exports, "ParallaxBackgroundLogic", ({ enumerable: true, get: function () { return parallax_background_1.ParallaxBackgroundLogic; } }));
const parallax_layer_1 = __webpack_require__(/*! ./library/parallax-layer */ "./src/library/parallax-layer.ts");
Object.defineProperty(exports, "ParallaxLayer", ({ enumerable: true, get: function () { return parallax_layer_1.ParallaxLayer; } }));
Object.defineProperty(exports, "TilingParallaxLayer", ({ enumerable: true, get: function () { return parallax_layer_1.TilingParallaxLayer; } }));
const loading_scene_1 = __webpack_require__(/*! ./library/loading-scene */ "./src/library/loading-scene.ts");
Object.defineProperty(exports, "LoadingScene", ({ enumerable: true, get: function () { return loading_scene_1.LoadingScene; } }));
Object.defineProperty(exports, "FallingSquaresAnimation", ({ enumerable: true, get: function () { return loading_scene_1.FallingSquaresAnimation; } }));
const physics_1 = __webpack_require__(/*! ./library/physics */ "./src/library/physics/index.ts");
Object.defineProperty(exports, "PhysicsWorld", ({ enumerable: true, get: function () { return physics_1.PhysicsWorld; } }));
Object.defineProperty(exports, "PhysicsBodyLogic", ({ enumerable: true, get: function () { return physics_1.PhysicsBodyLogic; } }));
Object.defineProperty(exports, "PhysicsDebugRenderer", ({ enumerable: true, get: function () { return physics_1.PhysicsDebugRenderer; } }));
Object.defineProperty(exports, "CollisionRegistry", ({ enumerable: true, get: function () { return physics_1.CollisionRegistry; } }));
Object.defineProperty(exports, "CollisionManager", ({ enumerable: true, get: function () { return physics_1.CollisionManager; } }));
Object.defineProperty(exports, "asPhysicsEntity", ({ enumerable: true, get: function () { return physics_1.asPhysicsEntity; } }));
Object.defineProperty(exports, "hasPhysics", ({ enumerable: true, get: function () { return physics_1.hasPhysics; } }));
Object.defineProperty(exports, "getPhysicsBody", ({ enumerable: true, get: function () { return physics_1.getPhysicsBody; } }));
Object.defineProperty(exports, "createShapeFromSprite", ({ enumerable: true, get: function () { return physics_1.createShapeFromSprite; } }));
Object.defineProperty(exports, "PhysicsMaterials", ({ enumerable: true, get: function () { return physics_1.PhysicsMaterials; } }));
Object.defineProperty(exports, "applyMaterial", ({ enumerable: true, get: function () { return physics_1.applyMaterial; } }));
const exportedObjects = {
    AssetLoader: asset_loader_1.AssetLoader,
    asEntity: moxi_entity_1.asEntity,
    asTextureFrames: texture_frames_1.asTextureFrames,
    asBitmapText: as_pixi_1.asBitmapText,
    asSprite: as_pixi_1.asSprite,
    asText: as_pixi_1.asText,
    asGraphics: as_pixi_1.asGraphics,
    asContainer: as_pixi_1.asContainer,
    Logic: logic_1.Logic,
    Camera: camera_1.Camera,
    CameraLogic: camera_1.CameraLogic,
    ClientEvents: client_events_1.ClientEvents,
    createResizeHandler: resize_handler_1.createResizeHandler,
    createTileGrid: grid_generator_1.createTileGrid,
    defaultRenderOptions: setup_1.defaultRenderOptions,
    Engine: engine_1.Engine,
    EventEmitter: event_system_1.EventEmitter,
    getTextureRange: grid_generator_1.getTextureRange,
    loadFonts: font_loader_1.loadFonts,
    MoxiEntity: moxi_entity_1.MoxiEntity,
    ParallaxBackground: parallax_background_1.ParallaxBackground,
    ParallaxBackgroundLogic: parallax_background_1.ParallaxBackgroundLogic,
    ParallaxLayer: parallax_layer_1.ParallaxLayer,
    LoadingScene: loading_scene_1.LoadingScene,
    FallingSquaresAnimation: loading_scene_1.FallingSquaresAnimation,
    setupMoxi: setup_1.setupMoxi,
    RenderManager: render_manager_1.RenderManager,
    Scene: scene_1.Scene,
    setupResponsiveCanvas: resize_handler_1.setupResponsiveCanvas,
    TextureFrameSequences: texture_frame_sequences_1.TextureFrameSequences,
    TilingParallaxLayer: parallax_layer_1.TilingParallaxLayer,
    utils,
    StateMachine: state_machine_1.StateMachine,
    StateLogic: state_logic_1.StateLogic,
    PhysicsWorld: physics_1.PhysicsWorld,
    PhysicsBodyLogic: physics_1.PhysicsBodyLogic,
    PhysicsDebugRenderer: physics_1.PhysicsDebugRenderer,
    CollisionRegistry: physics_1.CollisionRegistry,
    CollisionManager: physics_1.CollisionManager,
    asPhysicsEntity: physics_1.asPhysicsEntity,
    hasPhysics: physics_1.hasPhysics,
    getPhysicsBody: physics_1.getPhysicsBody,
    createShapeFromSprite: physics_1.createShapeFromSprite,
    PhysicsMaterials: physics_1.PhysicsMaterials,
    applyMaterial: physics_1.applyMaterial,
    EdgeInsets: edge_insets_1.EdgeInsets,
    UIComponent: ui_component_1.UIComponent,
    UIFocusManager: ui_focus_manager_1.UIFocusManager,
    FlexContainer: flex_container_1.FlexContainer,
    FlexDirection: flex_container_1.FlexDirection,
    FlexJustify: flex_container_1.FlexJustify,
    FlexAlign: flex_container_1.FlexAlign,
    UIBox: ui_box_1.UIBox,
    UILabel: ui_label_1.UILabel,
    UIPanel: ui_panel_1.UIPanel,
    UIButton: ui_button_1.UIButton,
    ButtonState: ui_button_1.ButtonState,
    UISelect: ui_select_1.UISelect,
    UITextInput: ui_text_input_1.UITextInput,
    UITextArea: ui_textarea_1.UITextArea,
    UIScrollContainer: ui_scroll_container_1.UIScrollContainer,
    UITabs: ui_tabs_1.UITabs,
    UILayer: UILayer_1.UILayer,
    UIScaleMode: UIScaleMode_1.UIScaleMode,
    svgToTexture: svg_to_texture_1.svgToTexture,
    PixelGrid: pixel_grid_1.PixelGrid,
    px: pixel_grid_1.px,
    units: pixel_grid_1.units,
    GRID: pixel_grid_1.GRID,
    BORDER: pixel_grid_1.BORDER,
    createBorderConfig: pixel_grid_1.createBorderConfig
};
exports["default"] = exportedObjects;


/***/ }),

/***/ "./src/library/as-pixi.ts":
/*!********************************!*\
  !*** ./src/library/as-pixi.ts ***!
  \********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asBitmapText = asBitmapText;
exports.asSprite = asSprite;
exports.asText = asText;
exports.asGraphics = asGraphics;
exports.asContainer = asContainer;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function applyProps(obj, props) {
    if (!props)
        return obj;
    if (props.x !== undefined)
        obj.x = props.x;
    if (props.y !== undefined)
        obj.y = props.y;
    if (props.anchor !== undefined) {
        if (typeof props.anchor === 'number') {
            if ('anchor' in obj && typeof obj.anchor === 'object' && obj.anchor !== null) {
                obj.anchor.set(props.anchor);
            }
        }
        else {
            if ('anchor' in obj && typeof obj.anchor === 'object' && obj.anchor !== null) {
                const anchor = obj.anchor;
                if (props.anchor.x !== undefined)
                    anchor.x = props.anchor.x;
                if (props.anchor.y !== undefined)
                    anchor.y = props.anchor.y;
            }
        }
    }
    if (props.scale !== undefined) {
        if (typeof props.scale === 'number') {
            if ('scale' in obj && typeof obj.scale === 'object' && obj.scale !== null) {
                obj.scale.set(props.scale);
            }
        }
        else {
            if ('scale' in obj && typeof obj.scale === 'object' && obj.scale !== null) {
                const scale = obj.scale;
                if (props.scale.x !== undefined)
                    scale.x = props.scale.x;
                if (props.scale.y !== undefined)
                    scale.y = props.scale.y;
            }
        }
    }
    if (props.rotation !== undefined)
        obj.rotation = props.rotation;
    if (props.tint !== undefined && 'tint' in obj)
        obj.tint = props.tint;
    if (props.alpha !== undefined)
        obj.alpha = props.alpha;
    if (props.visible !== undefined)
        obj.visible = props.visible;
    if (props.eventMode !== undefined && 'eventMode' in obj)
        obj.eventMode = props.eventMode;
    if (props.pivot !== undefined) {
        if (typeof props.pivot === 'number') {
            if ('pivot' in obj && typeof obj.pivot === 'object' && obj.pivot !== null) {
                obj.pivot.set(props.pivot);
            }
        }
        else {
            if ('pivot' in obj && typeof obj.pivot === 'object' && obj.pivot !== null) {
                const pivot = obj.pivot;
                if (props.pivot.x !== undefined)
                    pivot.x = props.pivot.x;
                if (props.pivot.y !== undefined)
                    pivot.y = props.pivot.y;
            }
        }
    }
    return obj;
}
function asBitmapText(constructorArgs, props) {
    const { pixelPerfect, ...textArgs } = constructorArgs;
    const text = new pixi_js_1.default.BitmapText(textArgs);
    if (pixelPerfect) {
        text.roundPixels = true;
    }
    return applyProps(text, props);
}
function asSprite(constructorArgs, props) {
    const sprite = new pixi_js_1.default.Sprite(constructorArgs);
    return applyProps(sprite, props);
}
function asText(constructorArgs, props) {
    const text = new pixi_js_1.default.Text(constructorArgs);
    return applyProps(text, props);
}
function asGraphics(props) {
    const graphics = new pixi_js_1.default.Graphics();
    return applyProps(graphics, props);
}
function asContainer(props) {
    const container = new pixi_js_1.default.Container();
    return applyProps(container, props);
}


/***/ }),

/***/ "./src/library/client-events.ts":
/*!**************************************!*\
  !*** ./src/library/client-events.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.ClientEvents = void 0;
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
class ClientEvents {
    wheelDelta;
    mouseUpEvent;
    mouseDownEvent;
    lastMouseDown;
    lastMouseUp;
    keyDownEvent;
    keyUpEvent;
    keydown;
    wheelOffsets;
    movePosition;
    lastMovePosition;
    moveDelta;
    static instance = null;
    static getInstance(options = {}) {
        if (!ClientEvents.instance) {
            ClientEvents.instance = new ClientEvents(options);
        }
        return ClientEvents.instance;
    }
    constructor({ initWheelOffset = new pixi_js_1.Point(), onAnyEvent = (ev) => { } } = {}) {
        if (ClientEvents.instance) {
            return ClientEvents.instance;
        }
        this.wheelOffsets = initWheelOffset;
        this.keydown = {};
        this.movePosition = new pixi_js_1.Point();
        const anyEvent = (ev) => {
            onAnyEvent(ev);
        };
        document.addEventListener('wheel', (event) => {
            const wheelDelta = this.wheelOffsets || new pixi_js_1.Point();
            const xValue = wheelDelta.x + event.deltaX;
            const yValue = wheelDelta.y + event.deltaY;
            this.wheelOffsets = new pixi_js_1.Point(xValue, yValue);
            anyEvent({ eventType: 'wheel', event });
        });
        document.addEventListener('mousemove', (event) => {
            this.lastMovePosition = this.movePosition;
            this.movePosition = new pixi_js_1.Point(event.clientX, event.clientY);
            this.moveDelta = new pixi_js_1.Point(this.movePosition.x - this.lastMovePosition.x, this.movePosition.y - this.lastMovePosition.y);
            anyEvent({ eventType: 'mousemove', event });
        });
        document.addEventListener('mousedown', (event) => {
            this.mouseDownEvent = event;
            this.lastMouseDown = event;
            this.mouseUpEvent = null;
            anyEvent({ eventType: 'mousedown', event });
        });
        document.addEventListener('mouseup', (event) => {
            this.mouseUpEvent = event;
            this.lastMouseUp = event;
            this.mouseDownEvent = null;
            anyEvent({ eventType: 'mouseup', event });
        });
        document.addEventListener('keydown', (event) => {
            const { key } = event;
            this.keyDownEvent = event;
            this.keyUpEvent = null;
            this.keydown[key] = event;
            anyEvent({ eventType: 'keydown', event });
        });
        document.addEventListener('keyup', (event) => {
            const { key } = event;
            this.keyUpEvent = event;
            this.keyDownEvent = null;
            delete this.keydown[key];
            anyEvent({ eventType: 'keyup', event });
        });
        ClientEvents.instance = this;
    }
    isKeyDown(key) {
        return Boolean(this.keydown[key]);
    }
    isKeyUp(key) {
        return !this.keydown[key];
    }
}
exports.ClientEvents = ClientEvents;


/***/ }),

/***/ "./src/library/falling-squares-animation.ts":
/*!**************************************************!*\
  !*** ./src/library/falling-squares-animation.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.FallingSquaresAnimation = void 0;
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
const DEFAULT_PALETTE = [0xf0dab1, 0xe39aac, 0xc45d9f, 0x634b7d, 0x6461c2, 0x2ba9b4, 0x93d4b5, 0xf0f6e8];
class FallingSquaresAnimation {
    particles = [];
    container = null;
    nextSpawn = 0;
    time = 0;
    squareSize;
    maxParticles;
    palette;
    spawnInterval;
    constructor(options = {}) {
        this.squareSize = options.squareSize ?? 20;
        this.maxParticles = options.maxParticles ?? 30;
        this.palette = options.palette ?? DEFAULT_PALETTE;
        this.spawnInterval = options.spawnInterval ?? 0.5;
    }
    init(container) {
        this.container = container;
    }
    update(context) {
        if (!this.container)
            return;
        this.time = context.time;
        const { width, height, textElement } = context;
        this.spawnParticle(width, height, textElement);
        this.particles = this.particles.filter(p => {
            const elapsed = this.time - p.spawnTime;
            const progress = elapsed / p.duration;
            if (progress < 0 || progress > 1) {
                p.sprite.destroy();
                return false;
            }
            p.sprite.x = p.startX;
            p.sprite.y = p.startY + (p.endY - p.startY) * progress;
            p.sprite.rotation = this.time * p.spinRate * Math.PI * 2;
            p.sprite.alpha = progress < 0.1 ? progress / 0.1 : progress > 0.85 ? (1 - progress) / 0.15 : 1;
            return true;
        });
    }
    spawnParticle(width, height, textElement) {
        if (!this.container)
            return;
        if (this.particles.length >= this.maxParticles || this.time < this.nextSpawn)
            return;
        const size = this.squareSize * (0.7 + Math.random() * 0.6);
        const sprite = new pixi_js_1.Graphics();
        sprite.rect(0, 0, size, size);
        sprite.fill({ color: this.palette[Math.floor(Math.random() * this.palette.length)] });
        sprite.pivot.set(size / 2, size / 2);
        this.container.addChild(sprite);
        const textY = textElement.y;
        const textWidth = textElement.width || 200;
        const textCenterX = width / 2;
        this.particles.push({
            sprite,
            spawnTime: this.time,
            duration: 1 + Math.random() * 2.5,
            spinRate: (0.05 + Math.random() * 1.075) * (Math.random() < 0.5 ? 1 : -1),
            startX: textCenterX - textWidth / 2 + Math.random() * textWidth - 4,
            startY: textY - 100,
            endY: textY - 40,
        });
        this.nextSpawn = this.time + Math.random() * this.spawnInterval;
    }
    reset() {
        this.time = 0;
        this.nextSpawn = 0;
        this.particles.forEach(p => p.sprite.destroy());
        this.particles = [];
    }
    destroy() {
        this.particles.forEach(p => p.sprite.destroy());
        this.particles = [];
        this.container = null;
    }
}
exports.FallingSquaresAnimation = FallingSquaresAnimation;


/***/ }),

/***/ "./src/library/font-loader.ts":
/*!************************************!*\
  !*** ./src/library/font-loader.ts ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.loadFonts = void 0;
const fontfaceobserver_1 = __importDefault(__webpack_require__(/*! fontfaceobserver */ "../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js"));
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
const loadFonts = async () => {
    const fontKenfutureThin = new fontfaceobserver_1.default('kenfuture-thin');
    return new Promise((resolve) => {
        fontKenfutureThin.load().then(() => {
            pixi_js_1.BitmapFont.install({
                name: 'kenfuture-thin',
                style: {
                    fontFamily: 'kenfuture-thin'
                }
            });
            resolve({ fontKenfutureThin });
        });
    });
};
exports.loadFonts = loadFonts;


/***/ }),

/***/ "./src/library/grid-generator.ts":
/*!***************************************!*\
  !*** ./src/library/grid-generator.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createTileGrid = createTileGrid;
exports.getTextureRange = getTextureRange;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function createTileGrid(options, textures, selector) {
    const { width, height, cellWidth, cellHeight, centered = false } = options;
    const defaultSelector = () => Math.floor(Math.random() * textures.length);
    const getTextureIndex = selector || defaultSelector;
    const container = new pixi_js_1.default.Container();
    const totalCells = width * height;
    for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
            const pixelX = x * cellWidth;
            const pixelY = y * cellHeight;
            const index = y * width + x;
            const position = {
                x, y, pixelX, pixelY, index, total: totalCells
            };
            const textureIndex = getTextureIndex(position);
            const cell = new pixi_js_1.default.Sprite(textures[textureIndex]);
            cell.position.set(pixelX, pixelY);
            container.addChild(cell);
        }
    }
    if (centered) {
        const gridWidth = width * cellWidth;
        const gridHeight = height * cellHeight;
        container.position.set(-gridWidth / 2, -gridHeight / 2);
    }
    return container;
}
function getTextureRange(textures, startIndex, count) {
    return textures.slice(startIndex, startIndex + count);
}


/***/ }),

/***/ "./src/library/loading-scene.ts":
/*!**************************************!*\
  !*** ./src/library/loading-scene.ts ***!
  \**************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.LoadingScene = exports.FallingSquaresAnimation = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const pixi_js_2 = __webpack_require__(/*! pixi.js */ "pixi.js");
const falling_squares_animation_1 = __webpack_require__(/*! ./falling-squares-animation */ "./src/library/falling-squares-animation.ts");
Object.defineProperty(exports, "FallingSquaresAnimation", ({ enumerable: true, get: function () { return falling_squares_animation_1.FallingSquaresAnimation; } }));
class LoadingScene extends pixi_js_2.Container {
    text;
    background;
    animationContainer;
    animation;
    ticker;
    renderer = null;
    time = 0;
    backgroundColor;
    constructor(options = {}) {
        super();
        const { backgroundColor = 0x1a1a1a, text = 'LOADING...', textStyle = {}, animation, fallingSquaresOptions } = options;
        this.backgroundColor = backgroundColor;
        this.animation = animation ?? new falling_squares_animation_1.FallingSquaresAnimation(fallingSquaresOptions);
        this.background = new pixi_js_2.Graphics();
        this.addChild(this.background);
        this.animationContainer = new pixi_js_2.Container();
        this.addChild(this.animationContainer);
        this.text = new pixi_js_2.Text({
            text,
            style: {
                fontFamily: 'Courier New, monospace',
                fontSize: 16,
                fill: 0xffffff,
                fontWeight: 'bold',
                ...textStyle
            }
        });
        this.text.anchor.set(0.5);
        this.addChild(this.text);
        this.animation.init(this.animationContainer);
        this.ticker = new pixi_js_1.default.Ticker();
        this.ticker.autoStart = false;
        this.ticker.add(() => {
            if (this.visible && this.renderer) {
                const deltaTime = this.ticker.deltaTime / 60;
                this.time += deltaTime;
                this.update(this.renderer.width, this.renderer.height, deltaTime);
                this.renderer.render(this);
            }
        });
    }
    update(width, height, deltaTime) {
        this.background.clear();
        this.background.rect(0, 0, width, height);
        this.background.fill({ color: this.backgroundColor });
        this.text.x = width / 2 - 4;
        this.text.y = height / 2 + 60;
        this.animation.update({
            time: this.time,
            deltaTime,
            width,
            height,
            textElement: this.text
        });
    }
    init(renderer) {
        this.renderer = renderer;
    }
    show() {
        this.visible = true;
        this.time = 0;
        this.animation.reset();
        if (!this.ticker.started) {
            this.ticker.start();
        }
    }
    hide() {
        this.visible = false;
        if (this.ticker.started) {
            this.ticker.stop();
        }
    }
    destroy() {
        if (this.ticker.started) {
            this.ticker.stop();
        }
        this.ticker.destroy();
        this.animation.destroy();
        super.destroy();
    }
}
exports.LoadingScene = LoadingScene;


/***/ }),

/***/ "./src/library/parallax-background.ts":
/*!********************************************!*\
  !*** ./src/library/parallax-background.ts ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.ParallaxBackgroundLogic = exports.ParallaxBackground = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const moxi_entity_1 = __webpack_require__(/*! ../core/moxi-entity */ "./src/core/moxi-entity.ts");
const logic_1 = __webpack_require__(/*! ../core/logic */ "./src/core/logic.ts");
const camera_1 = __webpack_require__(/*! ../core/camera */ "./src/core/camera.ts");
const parallax_layer_1 = __webpack_require__(/*! ./parallax-layer */ "./src/library/parallax-layer.ts");
class ParallaxBackground extends PIXI.Container {
    moxiEntity;
    camera = null;
    scrollOffset = new PIXI.Point(0, 0);
    scrollBaseScale = new PIXI.Point(1, 1);
    scrollIgnoreCameraZoom = false;
    autoscroll = new PIXI.Point(0, 0);
    constructor(options = {}) {
        super();
        this.camera = options.camera ?? null;
        this.scrollOffset = options.scrollOffset ?? new PIXI.Point(0, 0);
        this.scrollBaseScale = options.scrollBaseScale ?? new PIXI.Point(1, 1);
        this.scrollIgnoreCameraZoom = options.scrollIgnoreCameraZoom ?? false;
        this.autoscroll = options.autoscroll ?? new PIXI.Point(0, 0);
        const entity = (0, moxi_entity_1.asEntity)(this);
        entity.moxiEntity.addLogic(new ParallaxBackgroundLogic());
        this.moxiEntity = entity.moxiEntity;
    }
    addLayer(layer) {
        this.addChild(layer);
    }
    detectCamera() {
        let current = this.parent;
        while (current) {
            if (current instanceof camera_1.Camera) {
                return current;
            }
            current = current.parent;
        }
        return null;
    }
    getCameraPosition() {
        const camera = this.camera ?? this.detectCamera();
        if (!camera) {
            return new PIXI.Point(0, 0);
        }
        return new PIXI.Point(camera.position.x, camera.position.y);
    }
    getCameraScale() {
        if (this.scrollIgnoreCameraZoom) {
            return new PIXI.Point(1, 1);
        }
        const camera = this.camera ?? this.detectCamera();
        if (!camera) {
            return new PIXI.Point(1, 1);
        }
        return new PIXI.Point(camera.scale.x, camera.scale.y);
    }
}
exports.ParallaxBackground = ParallaxBackground;
class ParallaxBackgroundLogic extends logic_1.Logic {
    name = 'ParallaxBackgroundLogic';
    update(entity, deltaTime) {
        if (entity.autoscroll.x !== 0 || entity.autoscroll.y !== 0) {
            entity.scrollOffset.x += entity.autoscroll.x * deltaTime;
            entity.scrollOffset.y += entity.autoscroll.y * deltaTime;
        }
        const cameraPos = entity.getCameraPosition();
        const cameraScale = entity.getCameraScale();
        const scene = entity.parent;
        if (scene) {
            entity.position.x = cameraPos.x / scene.scale.x;
            entity.position.y = cameraPos.y / scene.scale.y;
            entity.scale.x = 1 / scene.scale.x;
            entity.scale.y = 1 / scene.scale.y;
        }
        else {
            entity.position.x = cameraPos.x;
            entity.position.y = cameraPos.y;
            entity.scale.set(1, 1);
        }
        entity.children.forEach((child) => {
            if (child instanceof parallax_layer_1.ParallaxLayer) {
                child.updateParallax(cameraPos, cameraScale, entity.scrollOffset);
            }
        });
    }
}
exports.ParallaxBackgroundLogic = ParallaxBackgroundLogic;


/***/ }),

/***/ "./src/library/parallax-layer.ts":
/*!***************************************!*\
  !*** ./src/library/parallax-layer.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.TilingParallaxLayer = exports.ParallaxLayer = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const moxi_entity_1 = __webpack_require__(/*! ../core/moxi-entity */ "./src/core/moxi-entity.ts");
class ParallaxLayer extends PIXI.Container {
    moxiEntity;
    scrollScale = new PIXI.Point(1, 1);
    scrollOffset = new PIXI.Point(0, 0);
    repeatSize = new PIXI.Point(0, 0);
    mirroring = false;
    _lastCameraPos = new PIXI.Point(0, 0);
    constructor(options = {}) {
        super();
        this.scrollScale = options.scrollScale ?? new PIXI.Point(1, 1);
        this.scrollOffset = options.scrollOffset ?? new PIXI.Point(0, 0);
        this.repeatSize = options.repeatSize ?? new PIXI.Point(0, 0);
        this.mirroring = options.mirroring ?? false;
        const entity = (0, moxi_entity_1.asEntity)(this);
        this.moxiEntity = entity.moxiEntity;
    }
    updateParallax(cameraPos, cameraScale, backgroundOffset) {
        const scrollX = (cameraPos.x + backgroundOffset.x) * this.scrollScale.x;
        const scrollY = (cameraPos.y + backgroundOffset.y) * this.scrollScale.y;
        this.position.x = -scrollX + this.scrollOffset.x;
        this.position.y = -scrollY + this.scrollOffset.y;
        if (this.mirroring) {
            if (this.repeatSize.x > 0) {
                this.position.x = this.position.x % this.repeatSize.x;
                if (this.position.x > 0)
                    this.position.x -= this.repeatSize.x;
            }
            if (this.repeatSize.y > 0) {
                this.position.y = this.position.y % this.repeatSize.y;
                if (this.position.y > 0)
                    this.position.y -= this.repeatSize.y;
            }
        }
        this._lastCameraPos.copyFrom(cameraPos);
    }
}
exports.ParallaxLayer = ParallaxLayer;
class TilingParallaxLayer extends ParallaxLayer {
    tilingSprite;
    _autoSized = false;
    constructor(options) {
        super(options);
        options.texture.source.style.addressMode = 'repeat';
        const width = options.width ?? 1;
        const height = options.height ?? 1;
        this.tilingSprite = new PIXI.TilingSprite({
            texture: options.texture,
            width: width,
            height: height,
        });
        this.tilingSprite.position.set(0, 0);
        this.addChild(this.tilingSprite);
        this._autoSized = !options.width && !options.height;
    }
    autoDetectDimensions() {
        if (!this._autoSized)
            return;
        let current = this.parent;
        while (current) {
            if (current.renderer) {
                this.resize(current.renderer.width, current.renderer.height);
                this._autoSized = false;
                return;
            }
            current = current.parent;
        }
    }
    updateParallax(cameraPos, cameraScale, backgroundOffset) {
        this.autoDetectDimensions();
        const renderer = this.parent?.parent;
        if (renderer?.renderer) {
            const baseWidth = renderer.renderer.width;
            const baseHeight = renderer.renderer.height;
            this.tilingSprite.width = baseWidth;
            this.tilingSprite.height = baseHeight;
            this.tilingSprite.pivot.set(0, 0);
            this.tilingSprite.position.set(0, 0);
        }
        const scrollX = (cameraPos.x + backgroundOffset.x) * this.scrollScale.x;
        const scrollY = (cameraPos.y + backgroundOffset.y) * this.scrollScale.y;
        this.tilingSprite.tilePosition.x = -scrollX + this.scrollOffset.x;
        this.tilingSprite.tilePosition.y = -scrollY + this.scrollOffset.y;
        this.position.set(0, 0);
    }
    resize(width, height) {
        this.tilingSprite.width = width;
        this.tilingSprite.height = height;
    }
}
exports.TilingParallaxLayer = TilingParallaxLayer;


/***/ }),

/***/ "./src/library/physics/index.ts":
/*!**************************************!*\
  !*** ./src/library/physics/index.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.applyMaterial = exports.PhysicsMaterials = exports.createShapeFromSprite = exports.getPhysicsBody = exports.hasPhysics = exports.asPhysicsEntity = exports.PhysicsDebugRenderer = exports.CollisionManager = exports.CollisionRegistry = exports.PhysicsBodyLogic = exports.PhysicsWorld = void 0;
var physics_world_1 = __webpack_require__(/*! ./physics-world */ "./src/library/physics/physics-world.ts");
Object.defineProperty(exports, "PhysicsWorld", ({ enumerable: true, get: function () { return physics_world_1.PhysicsWorld; } }));
var physics_body_logic_1 = __webpack_require__(/*! ./physics-body-logic */ "./src/library/physics/physics-body-logic.ts");
Object.defineProperty(exports, "PhysicsBodyLogic", ({ enumerable: true, get: function () { return physics_body_logic_1.PhysicsBodyLogic; } }));
var physics_collision_1 = __webpack_require__(/*! ./physics-collision */ "./src/library/physics/physics-collision.ts");
Object.defineProperty(exports, "CollisionRegistry", ({ enumerable: true, get: function () { return physics_collision_1.CollisionRegistry; } }));
Object.defineProperty(exports, "CollisionManager", ({ enumerable: true, get: function () { return physics_collision_1.CollisionManager; } }));
var physics_debug_renderer_1 = __webpack_require__(/*! ./physics-debug-renderer */ "./src/library/physics/physics-debug-renderer.ts");
Object.defineProperty(exports, "PhysicsDebugRenderer", ({ enumerable: true, get: function () { return physics_debug_renderer_1.PhysicsDebugRenderer; } }));
var physics_utils_1 = __webpack_require__(/*! ./physics-utils */ "./src/library/physics/physics-utils.ts");
Object.defineProperty(exports, "asPhysicsEntity", ({ enumerable: true, get: function () { return physics_utils_1.asPhysicsEntity; } }));
Object.defineProperty(exports, "hasPhysics", ({ enumerable: true, get: function () { return physics_utils_1.hasPhysics; } }));
Object.defineProperty(exports, "getPhysicsBody", ({ enumerable: true, get: function () { return physics_utils_1.getPhysicsBody; } }));
Object.defineProperty(exports, "createShapeFromSprite", ({ enumerable: true, get: function () { return physics_utils_1.createShapeFromSprite; } }));
var physics_materials_1 = __webpack_require__(/*! ./physics-materials */ "./src/library/physics/physics-materials.ts");
Object.defineProperty(exports, "PhysicsMaterials", ({ enumerable: true, get: function () { return physics_materials_1.PhysicsMaterials; } }));
Object.defineProperty(exports, "applyMaterial", ({ enumerable: true, get: function () { return physics_materials_1.applyMaterial; } }));


/***/ }),

/***/ "./src/library/physics/physics-body-logic.ts":
/*!***************************************************!*\
  !*** ./src/library/physics/physics-body-logic.ts ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsBodyLogic = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const logic_1 = __webpack_require__(/*! ../../core/logic */ "./src/core/logic.ts");
const physics_graphics_parser_1 = __webpack_require__(/*! ./physics-graphics-parser */ "./src/library/physics/physics-graphics-parser.ts");
class PhysicsBodyLogic extends logic_1.Logic {
    name = 'PhysicsBodyLogic';
    body;
    world;
    options;
    onCollisionBegin;
    onCollisionEnd;
    constructor(world, options = {}) {
        super();
        this.world = world;
        this.options = {
            type: 'dynamic',
            syncMode: 'physics-driven',
            syncPosition: true,
            syncRotation: true,
            density: 1.0,
            friction: 0.3,
            restitution: 0.0,
            fixedRotation: false,
            isSensor: false,
            bullet: false,
            ...options
        };
    }
    init(entity, renderer) {
        this.createPhysicsBody(entity);
        this.body.setUserData(this);
        this.world.registerBody(this.body, this);
    }
    update(entity, deltaTime) {
        if (!this.body)
            return;
        switch (this.options.syncMode) {
            case 'physics-driven':
                this.syncFromPhysics(entity);
                break;
            case 'sprite-driven':
                this.syncToPhysics(entity);
                break;
            case 'manual':
                break;
        }
    }
    destroy() {
        if (this.body) {
            this.world.destroyBody(this.body);
        }
    }
    syncFromPhysics(entity) {
        if (!this.body)
            return;
        const pos = this.body.getPosition();
        if (this.options.syncPosition) {
            entity.x = this.world.toPixels(pos.x);
            entity.y = this.world.toPixels(pos.y);
        }
        if (this.options.syncRotation) {
            entity.rotation = this.body.getAngle();
        }
    }
    syncToPhysics(entity) {
        if (!this.body)
            return;
        if (this.options.syncPosition) {
            const x = this.world.toPhysics(entity.x);
            const y = this.world.toPhysics(entity.y);
            this.body.setPosition(planck.Vec2(x, y));
        }
        if (this.options.syncRotation) {
            this.body.setAngle(entity.rotation);
        }
    }
    createPhysicsBody(entity) {
        let bodyType;
        switch (this.options.type) {
            case 'static':
                bodyType = 'static';
                break;
            case 'kinematic':
                bodyType = 'kinematic';
                break;
            case 'dynamic':
            default:
                bodyType = 'dynamic';
                break;
        }
        const bodyDef = {
            type: bodyType,
            position: this.options.position
                ? this.world.toPhysicsPoint(this.options.position)
                : planck.Vec2(this.world.toPhysics(entity.x), this.world.toPhysics(entity.y)),
            angle: this.options.rotation ?? entity.rotation,
            linearVelocity: this.options.linearVelocity
                ? this.world.toPhysicsPoint(this.options.linearVelocity)
                : planck.Vec2(0, 0),
            angularVelocity: this.options.angularVelocity ?? 0,
            fixedRotation: this.options.fixedRotation ?? false,
            bullet: this.options.bullet ?? false
        };
        this.body = this.world.createBody(bodyDef);
        this.createFixture(entity);
        if (this.options.linearVelocity) {
            this.setVelocity(this.options.linearVelocity);
        }
        if (this.options.angularVelocity) {
            this.setAngularVelocity(this.options.angularVelocity);
        }
    }
    createFixture(entity) {
        const shape = this.createShape(entity);
        const categoryBits = this.options.collisionTags
            ? this.world.collisionRegistry.tagsToBits(this.options.collisionTags)
            : this.world.collisionRegistry.getBit('default');
        const maskBits = this.options.collidesWith
            ? this.world.collisionRegistry.tagsToBits(this.options.collidesWith)
            : 0xFFFF;
        const groupIndex = this.options.collisionGroup ?? 0;
        this.body.createFixture({
            shape: shape,
            density: this.options.density ?? 1.0,
            friction: this.options.friction ?? 0.3,
            restitution: this.options.restitution ?? 0.0,
            isSensor: this.options.isSensor ?? false,
            filterCategoryBits: categoryBits,
            filterMaskBits: maskBits,
            filterGroupIndex: groupIndex
        });
    }
    createShape(entity) {
        if (this.options.collisionShape) {
            const parsed = (0, physics_graphics_parser_1.parseGraphicsShape)(this.options.collisionShape, this.world);
            return parsed.shape;
        }
        if (entity instanceof PIXI.Graphics) {
            const parsed = (0, physics_graphics_parser_1.parseGraphicsShape)(entity, this.world);
            return parsed.shape;
        }
        if (this.options.shape) {
            return this.createShapeFromType(this.options.shape);
        }
        throw new Error('Collision shape required for non-Graphics entities. ' +
            'Either provide a Graphics entity, or specify options.collisionShape, ' +
            'or use legacy options.shape with dimensions.');
    }
    createShapeFromType(shapeType) {
        switch (shapeType) {
            case 'circle':
                const radius = this.options.radius ?? 25;
                return planck.Circle(this.world.toPhysics(radius));
            case 'rectangle':
                const width = this.options.width ?? 50;
                const height = this.options.height ?? 50;
                return planck.Box(this.world.toPhysics(width / 2), this.world.toPhysics(height / 2));
            case 'polygon':
                if (!this.options.vertices || this.options.vertices.length < 3) {
                    throw new Error('Polygon shape requires at least 3 vertices');
                }
                const vertices = this.options.vertices.map(v => planck.Vec2(this.world.toPhysics(v.x), this.world.toPhysics(v.y)));
                return planck.Polygon(vertices);
            default:
                throw new Error(`Unknown shape type: ${shapeType}`);
        }
    }
    autoDetectShape(entity) {
        const bounds = entity.getLocalBounds();
        return planck.Box(this.world.toPhysics(bounds.width / 2), this.world.toPhysics(bounds.height / 2));
    }
    applyForce(force, point) {
        const forceVec = this.world.toPhysicsPoint(force);
        const pointVec = point
            ? this.world.toPhysicsPoint(point)
            : this.body.getWorldCenter();
        this.body.applyForce(forceVec, pointVec);
    }
    applyImpulse(impulse, point) {
        const impulseVec = this.world.toPhysicsPoint(impulse);
        const pointVec = point
            ? this.world.toPhysicsPoint(point)
            : this.body.getWorldCenter();
        this.body.applyLinearImpulse(impulseVec, pointVec);
    }
    applyTorque(torque) {
        this.body.applyTorque(torque);
    }
    setVelocity(velocity) {
        const velocityVec = this.world.toPhysicsPoint(velocity);
        this.body.setLinearVelocity(velocityVec);
    }
    setAngularVelocity(omega) {
        this.body.setAngularVelocity(omega);
    }
    getVelocity() {
        const vel = this.body.getLinearVelocity();
        return this.world.toPixelsPoint(vel);
    }
    getAngularVelocity() {
        return this.body.getAngularVelocity();
    }
    getMass() {
        return this.body.getMass();
    }
    isAwake() {
        return this.body.isAwake();
    }
    isSleeping() {
        return !this.body.isAwake();
    }
    setAwake(awake) {
        this.body.setAwake(awake);
    }
}
exports.PhysicsBodyLogic = PhysicsBodyLogic;


/***/ }),

/***/ "./src/library/physics/physics-collision.ts":
/*!**************************************************!*\
  !*** ./src/library/physics/physics-collision.ts ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.CollisionManager = exports.CollisionRegistry = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
class CollisionRegistry {
    tagToBit = new Map();
    bitToTag = new Map();
    nextBit = 1;
    constructor() {
        this.register('default');
    }
    register(tag) {
        if (this.tagToBit.has(tag))
            return;
        if (this.nextBit > 0x8000) {
            throw new Error('Maximum collision tags reached (16 tags)');
        }
        this.tagToBit.set(tag, this.nextBit);
        this.bitToTag.set(this.nextBit, tag);
        this.nextBit <<= 1;
    }
    getBit(tag) {
        if (!this.tagToBit.has(tag)) {
            this.register(tag);
        }
        return this.tagToBit.get(tag);
    }
    getTag(bit) {
        return this.bitToTag.get(bit);
    }
    tagsToBits(tags) {
        if (!tags || tags.length === 0) {
            return this.getBit('default');
        }
        return tags.reduce((bits, tag) => bits | this.getBit(tag), 0);
    }
    bitsToTags(bits) {
        const tags = [];
        for (const [bit, tag] of this.bitToTag) {
            if (bits & bit) {
                tags.push(tag);
            }
        }
        return tags;
    }
}
exports.CollisionRegistry = CollisionRegistry;
function isPhysicsBodyUserData(obj) {
    return (obj !== null &&
        typeof obj === 'object' &&
        'options' in obj &&
        typeof obj.options === 'object');
}
class CollisionManager {
    world;
    registry;
    callbacks = new Map();
    constructor(world, registry) {
        this.world = world;
        this.registry = registry;
        this.setupListeners();
    }
    setupListeners() {
        this.world.world.on('begin-contact', (contact) => {
            this.handleBeginContact(contact);
        });
        this.world.world.on('end-contact', (contact) => {
            this.handleEndContact(contact);
        });
    }
    onCollision(tagA, tagB, callback) {
        const key = this.makeKey(tagA, tagB);
        if (!this.callbacks.has(key)) {
            this.callbacks.set(key, new Set());
        }
        this.callbacks.get(key).add(callback);
    }
    offCollision(tagA, tagB, callback) {
        const key = this.makeKey(tagA, tagB);
        this.callbacks.get(key)?.delete(callback);
    }
    makeKey(tagA, tagB) {
        return tagA < tagB ? `${tagA}:${tagB}` : `${tagB}:${tagA}`;
    }
    handleBeginContact(contact) {
        const bodyA = contact.getFixtureA().getBody().getUserData();
        const bodyB = contact.getFixtureB().getBody().getUserData();
        if (!isPhysicsBodyUserData(bodyA) || !isPhysicsBodyUserData(bodyB))
            return;
        bodyA.onCollisionBegin?.(bodyB, contact);
        bodyB.onCollisionBegin?.(bodyA, contact);
        this.triggerTagCallbacks(bodyA, bodyB, contact);
    }
    handleEndContact(contact) {
        const bodyA = contact.getFixtureA().getBody().getUserData();
        const bodyB = contact.getFixtureB().getBody().getUserData();
        if (!isPhysicsBodyUserData(bodyA) || !isPhysicsBodyUserData(bodyB))
            return;
        bodyA.onCollisionEnd?.(bodyB, contact);
        bodyB.onCollisionEnd?.(bodyA, contact);
    }
    triggerTagCallbacks(bodyA, bodyB, contact) {
        const tagsA = bodyA.options.collisionTags || [];
        const tagsB = bodyB.options.collisionTags || [];
        for (const tagA of tagsA) {
            for (const tagB of tagsB) {
                const key = this.makeKey(tagA, tagB);
                const callbacks = this.callbacks.get(key);
                if (callbacks) {
                    const event = {
                        bodyA,
                        bodyB,
                        contact,
                        normal: new PIXI.Point(0, 0),
                        impulse: 0
                    };
                    callbacks.forEach(cb => cb(event));
                }
            }
        }
    }
}
exports.CollisionManager = CollisionManager;


/***/ }),

/***/ "./src/library/physics/physics-debug-renderer.ts":
/*!*******************************************************!*\
  !*** ./src/library/physics/physics-debug-renderer.ts ***!
  \*******************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsDebugRenderer = void 0;
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const logic_1 = __webpack_require__(/*! ../../core/logic */ "./src/core/logic.ts");
class PhysicsDebugRenderer extends logic_1.Logic {
    name = 'PhysicsDebugRenderer';
    world;
    graphics;
    options;
    isVisible = true;
    constructor(world, options = {}) {
        super();
        this.world = world;
        this.options = {
            showShapes: options.showShapes ?? true,
            showVelocities: options.showVelocities ?? false,
            showAABBs: options.showAABBs ?? false,
            showCenterOfMass: options.showCenterOfMass ?? false,
            showContactPoints: options.showContactPoints ?? false,
            showJoints: options.showJoints ?? false,
            colorStatic: options.colorStatic ?? 0x00FF00,
            colorDynamic: options.colorDynamic ?? 0xFF0000,
            colorKinematic: options.colorKinematic ?? 0x0000FF,
            colorSleeping: options.colorSleeping ?? 0xAAAAAA,
            colorSensor: options.colorSensor ?? 0xFFFF00,
            alpha: options.alpha ?? 0.5,
            lineWidth: options.lineWidth ?? 2
        };
    }
    init(entity, renderer) {
        this.graphics = entity;
    }
    update(entity, deltaTime) {
        if (!this.isVisible) {
            this.graphics.clear();
            return;
        }
        this.graphics.clear();
        if (this.options.showShapes) {
            for (let body = this.world.world.getBodyList(); body; body = body.getNext()) {
                this.drawBody(body);
            }
        }
        if (this.options.showContactPoints) {
            this.drawContacts();
        }
    }
    drawBody(body) {
        const transform = body.getTransform();
        let color;
        if (!body.isAwake() && body.isDynamic()) {
            color = this.options.colorSleeping;
        }
        else if (body.isStatic()) {
            color = this.options.colorStatic;
        }
        else if (body.isKinematic()) {
            color = this.options.colorKinematic;
        }
        else {
            color = this.options.colorDynamic;
        }
        for (let fixture = body.getFixtureList(); fixture; fixture = fixture.getNext()) {
            const shape = fixture.getShape();
            const fixtureColor = fixture.isSensor() ? this.options.colorSensor : color;
            const alpha = fixture.isSensor() ? this.options.alpha * 0.5 : this.options.alpha;
            this.drawShape(shape, transform, fixtureColor, alpha);
        }
        if (this.options.showVelocities && body.isDynamic()) {
            this.drawVelocity(body);
        }
        if (this.options.showAABBs) {
            this.drawAABB(body);
        }
        if (this.options.showCenterOfMass) {
            this.drawCenterOfMass(body);
        }
    }
    drawShape(shape, transform, color, alpha) {
        this.graphics.stroke({
            width: this.options.lineWidth,
            color: color,
            alpha: alpha
        });
        const shapeType = shape.getType();
        if (shapeType === 'circle') {
            const circle = shape;
            const center = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, circle.getCenter()));
            const radius = circle.getRadius();
            const pixelCenter = this.world.toPixelsPoint(center);
            const pixelRadius = this.world.toPixels(radius);
            this.graphics.circle(pixelCenter.x, pixelCenter.y, pixelRadius);
            this.graphics.stroke();
            const angle = transform.q.getAngle();
            const endX = pixelCenter.x + Math.cos(angle) * pixelRadius;
            const endY = pixelCenter.y + Math.sin(angle) * pixelRadius;
            this.graphics.moveTo(pixelCenter.x, pixelCenter.y);
            this.graphics.lineTo(endX, endY);
            this.graphics.stroke();
        }
        else if (shapeType === 'polygon') {
            const poly = shape;
            const vertices = poly.m_vertices;
            if (vertices && vertices.length > 0) {
                const firstVertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[0]));
                const pixelFirst = this.world.toPixelsPoint(firstVertex);
                this.graphics.moveTo(pixelFirst.x, pixelFirst.y);
                for (let i = 1; i < vertices.length; i++) {
                    const vertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[i]));
                    const pixelVertex = this.world.toPixelsPoint(vertex);
                    this.graphics.lineTo(pixelVertex.x, pixelVertex.y);
                }
                this.graphics.lineTo(pixelFirst.x, pixelFirst.y);
                this.graphics.stroke();
            }
        }
        else if (shapeType === 'edge') {
            const edge = shape;
            const v1 = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, edge.m_vertex1));
            const v2 = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, edge.m_vertex2));
            const p1 = this.world.toPixelsPoint(v1);
            const p2 = this.world.toPixelsPoint(v2);
            this.graphics.moveTo(p1.x, p1.y);
            this.graphics.lineTo(p2.x, p2.y);
            this.graphics.stroke();
        }
        else if (shapeType === 'chain') {
            const chain = shape;
            const vertices = chain.m_vertices;
            if (vertices && vertices.length > 0) {
                const firstVertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[0]));
                const pixelFirst = this.world.toPixelsPoint(firstVertex);
                this.graphics.moveTo(pixelFirst.x, pixelFirst.y);
                for (let i = 1; i < vertices.length; i++) {
                    const vertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[i]));
                    const pixelVertex = this.world.toPixelsPoint(vertex);
                    this.graphics.lineTo(pixelVertex.x, pixelVertex.y);
                }
                this.graphics.stroke();
            }
        }
    }
    drawVelocity(body) {
        const position = body.getPosition();
        const velocity = body.getLinearVelocity();
        const scale = 0.5;
        const endPoint = planck.Vec2.add(position, planck.Vec2.mul(velocity, scale));
        const pixelStart = this.world.toPixelsPoint(position);
        const pixelEnd = this.world.toPixelsPoint(endPoint);
        this.graphics.stroke({
            width: 2,
            color: 0x00FFFF,
            alpha: 0.8
        });
        this.graphics.moveTo(pixelStart.x, pixelStart.y);
        this.graphics.lineTo(pixelEnd.x, pixelEnd.y);
        this.graphics.stroke();
        const angle = Math.atan2(pixelEnd.y - pixelStart.y, pixelEnd.x - pixelStart.x);
        const arrowSize = 5;
        const angle1 = angle + Math.PI * 0.8;
        const angle2 = angle - Math.PI * 0.8;
        this.graphics.moveTo(pixelEnd.x, pixelEnd.y);
        this.graphics.lineTo(pixelEnd.x + Math.cos(angle1) * arrowSize, pixelEnd.y + Math.sin(angle1) * arrowSize);
        this.graphics.moveTo(pixelEnd.x, pixelEnd.y);
        this.graphics.lineTo(pixelEnd.x + Math.cos(angle2) * arrowSize, pixelEnd.y + Math.sin(angle2) * arrowSize);
        this.graphics.stroke();
    }
    drawAABB(body) {
        for (let fixture = body.getFixtureList(); fixture; fixture = fixture.getNext()) {
            const aabb = fixture.getAABB(0);
            const lowerBound = this.world.toPixelsPoint(aabb.lowerBound);
            const upperBound = this.world.toPixelsPoint(aabb.upperBound);
            this.graphics.stroke({
                width: 1,
                color: 0xFF00FF,
                alpha: 0.3
            });
            this.graphics.rect(lowerBound.x, lowerBound.y, upperBound.x - lowerBound.x, upperBound.y - lowerBound.y);
            this.graphics.stroke();
        }
    }
    drawCenterOfMass(body) {
        const position = body.getWorldCenter();
        const pixelPos = this.world.toPixelsPoint(position);
        this.graphics.stroke({
            width: 1,
            color: 0xFFFFFF,
            alpha: 1
        });
        const size = 5;
        this.graphics.moveTo(pixelPos.x - size, pixelPos.y);
        this.graphics.lineTo(pixelPos.x + size, pixelPos.y);
        this.graphics.moveTo(pixelPos.x, pixelPos.y - size);
        this.graphics.lineTo(pixelPos.x, pixelPos.y + size);
        this.graphics.stroke();
    }
    drawContacts() {
        for (let contact = this.world.world.getContactList(); contact; contact = contact.getNext()) {
            if (!contact.isTouching())
                continue;
            const manifold = contact.getManifold();
            if (!manifold)
                continue;
            const worldManifold = contact.getWorldManifold(null);
            if (!worldManifold)
                continue;
            for (let i = 0; i < manifold.pointCount; i++) {
                const point = worldManifold.points[i];
                if (!point)
                    continue;
                const pixelPoint = this.world.toPixelsPoint(planck.Vec2(point.x, point.y));
                this.graphics.circle(pixelPoint.x, pixelPoint.y, 3);
                this.graphics.fill({ color: 0xFF0000, alpha: 0.8 });
            }
        }
    }
    setVisible(visible) {
        this.isVisible = visible;
        if (!visible) {
            this.graphics.clear();
        }
    }
    toggle() {
        this.setVisible(!this.isVisible);
    }
    getVisible() {
        return this.isVisible;
    }
}
exports.PhysicsDebugRenderer = PhysicsDebugRenderer;


/***/ }),

/***/ "./src/library/physics/physics-graphics-parser.ts":
/*!********************************************************!*\
  !*** ./src/library/physics/physics-graphics-parser.ts ***!
  \********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.setGraphicsPhysicsShape = setGraphicsPhysicsShape;
exports.initGraphicsPhysicsTracking = initGraphicsPhysicsTracking;
exports.parseGraphicsShape = parseGraphicsShape;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const PHYSICS_SHAPE_KEY = '__physicsShape__';
function setGraphicsPhysicsShape(graphics, metadata) {
    graphics[PHYSICS_SHAPE_KEY] = metadata;
}
function initGraphicsPhysicsTracking() {
    const originalRect = PIXI.Graphics.prototype.rect;
    const originalCircle = PIXI.Graphics.prototype.circle;
    const originalPoly = PIXI.Graphics.prototype.poly;
    PIXI.Graphics.prototype.rect = function (x, y, w, h) {
        setGraphicsPhysicsShape(this, {
            type: 'rectangle',
            width: w,
            height: h
        });
        return originalRect.call(this, x, y, w, h);
    };
    PIXI.Graphics.prototype.circle = function (x, y, radius) {
        setGraphicsPhysicsShape(this, {
            type: 'circle',
            radius: radius
        });
        return originalCircle.call(this, x, y, radius);
    };
    PIXI.Graphics.prototype.poly = function (points) {
        const flatPoints = Array.isArray(points[0]) ? points.flat() : points;
        setGraphicsPhysicsShape(this, {
            type: 'polygon',
            vertices: flatPoints
        });
        return originalPoly.call(this, points);
    };
}
function parseGraphicsShape(graphics, world) {
    const metadata = graphics[PHYSICS_SHAPE_KEY];
    if (metadata) {
        switch (metadata.type) {
            case 'circle':
                if (!metadata.radius) {
                    throw new Error('Circle metadata missing radius');
                }
                return {
                    type: 'circle',
                    shape: planck.Circle(world.toPhysics(metadata.radius))
                };
            case 'rectangle':
                if (!metadata.width || !metadata.height) {
                    throw new Error('Rectangle metadata missing width/height');
                }
                return {
                    type: 'rectangle',
                    shape: planck.Box(world.toPhysics(metadata.width / 2), world.toPhysics(metadata.height / 2))
                };
            case 'polygon':
                if (!metadata.vertices || metadata.vertices.length < 6) {
                    throw new Error('Polygon metadata missing vertices (need at least 3 points = 6 values)');
                }
                const vertices = [];
                for (let i = 0; i < metadata.vertices.length; i += 2) {
                    vertices.push(planck.Vec2(world.toPhysics(metadata.vertices[i]), world.toPhysics(metadata.vertices[i + 1])));
                }
                return {
                    type: 'polygon',
                    shape: planck.Polygon(vertices)
                };
        }
    }
    const bounds = graphics.getLocalBounds();
    if (bounds.width === 0 || bounds.height === 0) {
        throw new Error('Graphics has no dimensions. Either draw shapes using rect(), circle(), or poly(), ' +
            'or provide an explicit collisionShape option.');
    }
    return {
        type: 'rectangle',
        shape: planck.Box(world.toPhysics(bounds.width / 2), world.toPhysics(bounds.height / 2))
    };
}


/***/ }),

/***/ "./src/library/physics/physics-materials.ts":
/*!**************************************************!*\
  !*** ./src/library/physics/physics-materials.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsMaterials = void 0;
exports.applyMaterial = applyMaterial;
exports.PhysicsMaterials = {
    bouncy: {
        density: 0.5,
        friction: 0.1,
        restitution: 0.9
    },
    wood: {
        density: 0.7,
        friction: 0.4,
        restitution: 0.2
    },
    metal: {
        density: 1.5,
        friction: 0.3,
        restitution: 0.1
    },
    ice: {
        density: 0.9,
        friction: 0.02,
        restitution: 0.05
    },
    rubber: {
        density: 1.0,
        friction: 0.9,
        restitution: 0.7
    },
    character: {
        density: 1.0,
        friction: 0.5,
        restitution: 0.0,
        fixedRotation: true
    },
    terrain: {
        density: 0,
        friction: 0.6,
        restitution: 0.0
    }
};
function applyMaterial(options, material) {
    return {
        ...options,
        ...exports.PhysicsMaterials[material]
    };
}


/***/ }),

/***/ "./src/library/physics/physics-utils.ts":
/*!**********************************************!*\
  !*** ./src/library/physics/physics-utils.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asPhysicsEntity = asPhysicsEntity;
exports.hasPhysics = hasPhysics;
exports.getPhysicsBody = getPhysicsBody;
exports.createShapeFromSprite = createShapeFromSprite;
const moxi_entity_1 = __webpack_require__(/*! ../../core/moxi-entity */ "./src/core/moxi-entity.ts");
const physics_body_logic_1 = __webpack_require__(/*! ./physics-body-logic */ "./src/library/physics/physics-body-logic.ts");
function asPhysicsEntity(pixiObject, world, options = {}) {
    const entity = (0, moxi_entity_1.asEntity)(pixiObject);
    const physicsLogic = new physics_body_logic_1.PhysicsBodyLogic(world, options);
    entity.moxiEntity.addLogic(physicsLogic);
    return entity;
}
function hasPhysics(entity) {
    if (!entity.moxiEntity)
        return false;
    return entity.moxiEntity.getLogic('PhysicsBodyLogic') !== undefined;
}
function getPhysicsBody(entity) {
    if (!entity.moxiEntity)
        return undefined;
    return entity.moxiEntity.getLogic('PhysicsBodyLogic');
}
function createShapeFromSprite(sprite, type = 'auto') {
    const bounds = sprite.getLocalBounds();
    if (type === 'auto') {
        const ratio = bounds.width / bounds.height;
        type = (ratio > 0.8 && ratio < 1.2) ? 'circle' : 'rectangle';
    }
    if (type === 'circle') {
        return {
            shape: 'circle',
            radius: Math.max(bounds.width, bounds.height) / 2
        };
    }
    else {
        return {
            shape: 'rectangle',
            width: bounds.width,
            height: bounds.height
        };
    }
}


/***/ }),

/***/ "./src/library/physics/physics-world.ts":
/*!**********************************************!*\
  !*** ./src/library/physics/physics-world.ts ***!
  \**********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsWorld = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const physics_collision_1 = __webpack_require__(/*! ./physics-collision */ "./src/library/physics/physics-collision.ts");
const physics_debug_renderer_1 = __webpack_require__(/*! ./physics-debug-renderer */ "./src/library/physics/physics-debug-renderer.ts");
const moxi_entity_1 = __webpack_require__(/*! ../../core/moxi-entity */ "./src/core/moxi-entity.ts");
const physics_graphics_parser_1 = __webpack_require__(/*! ./physics-graphics-parser */ "./src/library/physics/physics-graphics-parser.ts");
class PhysicsWorld {
    world;
    pixelsPerMeter = 30;
    timestep = 1 / 60;
    collisionRegistry;
    collisionManager;
    velocityIterations = 8;
    positionIterations = 3;
    accumulator = 0;
    bodies = new Map();
    debugRenderer;
    debugGraphics;
    constructor(options = {}) {
        (0, physics_graphics_parser_1.initGraphicsPhysicsTracking)();
        const { gravity = { x: 0, y: 9.8 }, pixelsPerMeter = 30, velocityIterations = 8, positionIterations = 3, enableSleeping = true, timestep = 1 / 60 } = options;
        this.pixelsPerMeter = pixelsPerMeter;
        this.velocityIterations = velocityIterations;
        this.positionIterations = positionIterations;
        this.timestep = timestep;
        this.world = planck.World({
            gravity: planck.Vec2(gravity.x, gravity.y)
        });
        this.world.setAllowSleeping(enableSleeping);
        this.collisionRegistry = new physics_collision_1.CollisionRegistry();
        this.collisionManager = new physics_collision_1.CollisionManager(this, this.collisionRegistry);
    }
    step(deltaTime) {
        this.accumulator += deltaTime;
        while (this.accumulator >= this.timestep) {
            this.world.step(this.timestep, this.velocityIterations, this.positionIterations);
            this.accumulator -= this.timestep;
        }
    }
    createBody(def) {
        return this.world.createBody(def);
    }
    destroyBody(body) {
        this.bodies.delete(body);
        this.world.destroyBody(body);
    }
    registerBody(body, logic) {
        this.bodies.set(body, logic);
    }
    getBodyLogic(body) {
        return this.bodies.get(body);
    }
    raycast(from, to, callback) {
        const p1 = this.toPhysicsPoint(from);
        const p2 = this.toPhysicsPoint(to);
        this.world.rayCast(p1, p2, (fixture, point, normal, fraction) => {
            const pixelPoint = this.toPixelsPoint(point);
            const pixelNormal = new PIXI.Point(normal.x, normal.y);
            return callback(fixture, pixelPoint, pixelNormal, fraction);
        });
    }
    queryAABB(bounds, callback) {
        const lowerBound = this.toPhysicsPoint(new PIXI.Point(bounds.x, bounds.y));
        const upperBound = this.toPhysicsPoint(new PIXI.Point(bounds.x + bounds.width, bounds.y + bounds.height));
        this.world.queryAABB(planck.AABB(lowerBound, upperBound), (fixture) => {
            return callback(fixture.getBody());
        });
    }
    queryPoint(point, callback) {
        const physicsPoint = this.toPhysicsPoint(point);
        this.world.queryAABB(planck.AABB(planck.Vec2(physicsPoint.x - 0.001, physicsPoint.y - 0.001), planck.Vec2(physicsPoint.x + 0.001, physicsPoint.y + 0.001)), (fixture) => {
            if (fixture.testPoint(physicsPoint)) {
                return callback(fixture);
            }
            return true;
        });
    }
    toPhysics(pixels) {
        return pixels / this.pixelsPerMeter;
    }
    toPixels(meters) {
        return meters * this.pixelsPerMeter;
    }
    toPhysicsPoint(point) {
        return planck.Vec2(this.toPhysics(point.x), this.toPhysics(point.y));
    }
    toPixelsPoint(vec) {
        return new PIXI.Point(this.toPixels(vec.x), this.toPixels(vec.y));
    }
    enableDebugRenderer(scene, options = {}) {
        if (this.debugRenderer) {
            this.disableDebugRenderer();
        }
        this.debugGraphics = new PIXI.Graphics();
        this.debugRenderer = new physics_debug_renderer_1.PhysicsDebugRenderer(this, options);
        const debugEntity = (0, moxi_entity_1.asEntity)(this.debugGraphics);
        debugEntity.moxiEntity.addLogic(this.debugRenderer);
        debugEntity.zIndex = 10000;
        scene.sortableChildren = true;
        scene.addChild(debugEntity);
        console.log('Physics debug renderer enabled. Press "P" to toggle visibility.');
        return this.debugRenderer;
    }
    disableDebugRenderer() {
        if (this.debugRenderer && this.debugGraphics) {
            if (this.debugGraphics.parent) {
                this.debugGraphics.parent.removeChild(this.debugGraphics);
            }
            this.debugGraphics.destroy();
            this.debugGraphics = undefined;
            this.debugRenderer = undefined;
        }
    }
    getDebugRenderer() {
        return this.debugRenderer;
    }
    getBodies() {
        const bodies = [];
        for (let body = this.world.getBodyList(); body; body = body.getNext()) {
            bodies.push(body);
        }
        return bodies;
    }
    destroy() {
        const bodies = this.getBodies();
        bodies.forEach(body => this.world.destroyBody(body));
        this.bodies.clear();
        this.debugRenderer = undefined;
    }
}
exports.PhysicsWorld = PhysicsWorld;


/***/ }),

/***/ "./src/library/resize-handler.ts":
/*!***************************************!*\
  !*** ./src/library/resize-handler.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createResizeHandler = createResizeHandler;
exports.setupResponsiveCanvas = setupResponsiveCanvas;
const DEFAULT_ROOT_STYLES = {
    display: 'flex',
    justifyContent: 'center',
    alignItems: 'center',
    overflow: 'hidden'
};
const PIXEL_ART_CANVAS_STYLES = {
    imageRendering: 'pixelated'
};
function createResizeHandler(options) {
    const { rootElement, width, height, rootStyles = DEFAULT_ROOT_STYLES, canvasStyles = {}, pixelArtMode = false } = options;
    Object.entries(rootStyles).forEach(([key, value]) => {
        rootElement.style.setProperty(key, value);
    });
    const finalCanvasStyles = pixelArtMode
        ? { ...PIXEL_ART_CANVAS_STYLES, ...canvasStyles }
        : canvasStyles;
    return () => {
        const parentWidth = rootElement.clientWidth;
        const parentHeight = rootElement.clientHeight;
        const ratio = Math.min(parentWidth / width, parentHeight / height);
        if (rootElement.firstElementChild instanceof HTMLCanvasElement) {
            const canvas = rootElement.firstElementChild;
            canvas.style.width = `${Math.round(width * ratio)}px`;
            canvas.style.height = `${Math.round(height * ratio)}px`;
            canvas.style.display = 'block';
            Object.entries(finalCanvasStyles).forEach(([key, value]) => {
                canvas.style.setProperty(key, value);
            });
        }
    };
}
function setupResponsiveCanvas(options) {
    const resizeHandler = createResizeHandler(options);
    resizeHandler();
    window.addEventListener('resize', resizeHandler);
    return () => {
        window.removeEventListener('resize', resizeHandler);
    };
}


/***/ }),

/***/ "./src/library/setup.ts":
/*!******************************!*\
  !*** ./src/library/setup.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.defaultRenderOptions = void 0;
exports.setupMoxi = setupMoxi;
const asset_loader_1 = __webpack_require__(/*! ../core/asset-loader */ "./src/core/asset-loader.ts");
const camera_1 = __webpack_require__(/*! ../core/camera */ "./src/core/camera.ts");
const engine_1 = __webpack_require__(/*! ../core/engine */ "./src/core/engine.ts");
const render_manager_1 = __webpack_require__(/*! ../core/render-manager */ "./src/core/render-manager.ts");
const scene_1 = __webpack_require__(/*! ../core/scene */ "./src/core/scene.ts");
const physics_1 = __webpack_require__(/*! ./physics */ "./src/library/physics/index.ts");
const loading_scene_1 = __webpack_require__(/*! ./loading-scene */ "./src/library/loading-scene.ts");
exports.defaultRenderOptions = {
    width: 1280,
    height: 720,
    backgroundColor: 0x1099bb,
    resolution: window.devicePixelRatio || 1,
    autoDensity: true,
    antialias: true
};
async function setupMoxi({ hostElement, renderOptions = exports.defaultRenderOptions, physics, showLoadingScene = false, loadingSceneOptions = {}, pixelPerfect } = {}) {
    let finalRenderOptions = { ...renderOptions };
    let applyImageRendering = false;
    if (pixelPerfect) {
        const ppOptions = typeof pixelPerfect === 'boolean'
            ? { enabled: true, imageRendering: true }
            : pixelPerfect;
        if (ppOptions.enabled !== false) {
            finalRenderOptions = {
                ...finalRenderOptions,
                resolution: 1,
                antialias: false,
                roundPixels: true
            };
        }
        applyImageRendering = ppOptions.imageRendering !== false;
    }
    const { renderer } = await render_manager_1.RenderManager.create(hostElement, finalRenderOptions);
    if (applyImageRendering) {
        const canvas = renderer.canvas;
        canvas.style.imageRendering = 'pixelated';
        canvas.style.imageRendering = '-moz-crisp-edges';
        canvas.style.imageRendering = 'crisp-edges';
    }
    const scene = new scene_1.Scene(renderer);
    const engine = new engine_1.Engine(scene);
    const assetLoader = new asset_loader_1.AssetLoader();
    const { PIXIAssets, loadAssets } = assetLoader;
    const camera = new camera_1.Camera(scene, renderer);
    let physicsWorld;
    if (physics) {
        const physicsOptions = typeof physics === 'boolean'
            ? {}
            : physics;
        physicsWorld = new physics_1.PhysicsWorld(physicsOptions);
        engine.addPhysicsWorld(physicsWorld);
    }
    let loadingScene;
    if (showLoadingScene) {
        loadingScene = new loading_scene_1.LoadingScene(loadingSceneOptions);
        loadingScene.zIndex = 10000;
        loadingScene.init(renderer);
        scene.addChild(loadingScene);
        loadingScene.hide();
        assetLoader.on('loading:start', () => {
            if (loadingScene) {
                loadingScene.show();
            }
        });
        assetLoader.on('loading:end', () => {
            if (loadingScene) {
                loadingScene.hide();
            }
        });
    }
    return {
        scene,
        engine,
        PIXIAssets,
        renderer,
        loadAssets,
        camera,
        physicsWorld,
        loadingScene
    };
}


/***/ }),

/***/ "./src/library/state-logic.ts":
/*!************************************!*\
  !*** ./src/library/state-logic.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.StateLogic = void 0;
const logic_1 = __webpack_require__(/*! ../core/logic */ "./src/core/logic.ts");
class StateLogic extends logic_1.Logic {
    _entity;
    constructor(name) {
        super();
        this.name = name;
    }
    get entity() {
        return this._entity;
    }
    init(entity, renderer) {
        this._entity = entity;
        super.init(entity, renderer);
    }
    onEnter(state) {
    }
    onExit(state) {
    }
    update(entity, deltaTime) {
    }
}
exports.StateLogic = StateLogic;


/***/ }),

/***/ "./src/library/state-machine.ts":
/*!**************************************!*\
  !*** ./src/library/state-machine.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.StateMachine = void 0;
class StateMachine extends EventTarget {
    _states = {};
    _currentState = null;
    _currentStateName = null;
    constructor(states = {}) {
        super();
        this._states = states;
    }
    update(deltaTime) {
        if (this._currentState) {
            this._currentState.update(this._currentState.entity, deltaTime);
        }
    }
    setState(stateName) {
        const nextState = this._states[stateName];
        if (!nextState)
            return;
        const prevStateName = this._currentStateName;
        if (this._currentState) {
            this._currentState.onExit(stateName);
        }
        this._currentState = this._states[stateName];
        this._currentStateName = stateName;
        this._currentState.onEnter(stateName);
        const event = new CustomEvent('stateChange', {
            detail: {
                prevState: prevStateName,
                newState: stateName
            }
        });
        this.dispatchEvent(event);
    }
    addState(state) {
        this._states[state.name] = state;
    }
    get currentState() {
        return this._currentStateName;
    }
}
exports.StateMachine = StateMachine;


/***/ }),

/***/ "./src/library/svg-utils/svg-to-texture.ts":
/*!*************************************************!*\
  !*** ./src/library/svg-utils/svg-to-texture.ts ***!
  \*************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.svgToTexture = svgToTexture;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
async function svgToTexture(options) {
    const { svgString, width, height, color = 0x000000 } = options;
    const colorHex = '#' + color.toString(16).padStart(6, '0');
    const processedSVG = svgString.replace(/currentColor/g, colorHex);
    const blob = new Blob([processedSVG], { type: 'image/svg+xml' });
    const url = URL.createObjectURL(blob);
    const img = new Image();
    img.width = width;
    img.height = height;
    await new Promise((resolve, reject) => {
        img.onload = () => resolve();
        img.onerror = reject;
        img.src = url;
    });
    const canvas = document.createElement('canvas');
    canvas.width = width;
    canvas.height = height;
    const ctx = canvas.getContext('2d');
    if (!ctx) {
        URL.revokeObjectURL(url);
        throw new Error('Failed to get canvas context');
    }
    ctx.drawImage(img, 0, 0, width, height);
    URL.revokeObjectURL(url);
    const texture = PIXI.Texture.from(canvas);
    texture.source.scaleMode = 'linear';
    return texture;
}


/***/ }),

/***/ "./src/library/texture-frame-sequences.ts":
/*!************************************************!*\
  !*** ./src/library/texture-frame-sequences.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.TextureFrameSequences = void 0;
class TextureFrameSequences {
    frames = [];
    sequences = {};
    constructor(frames, sequences = {}) {
        this.frames = frames;
        this.sequences = sequences;
    }
    addSequence(name, frameIndices, animationSpeed = 1) {
        this.sequences[name] = {
            frames: frameIndices,
            animationSpeed
        };
    }
    getSequence(name) {
        return this.sequences[name] || null;
    }
    getFrame(index) {
        return this.frames[index] || null;
    }
    getFrameFromSequence(sequenceName, frameIndex) {
        const sequence = this.getSequence(sequenceName);
        if (!sequence)
            return null;
        const sequenceFrameIndex = sequence.frames[frameIndex % sequence.frames.length];
        return this.frames[sequenceFrameIndex] || null;
    }
    getFrameSequence(name) {
        const sequence = this.getSequence(name);
        if (!sequence)
            return [];
        return sequence.frames.map(index => this.frames[index]).filter(Boolean);
    }
}
exports.TextureFrameSequences = TextureFrameSequences;


/***/ }),

/***/ "./src/library/texture-frames.ts":
/*!***************************************!*\
  !*** ./src/library/texture-frames.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asTextureFrames = asTextureFrames;
const defaultOptions = {
    frameWidth: 48,
    frameHeight: 48,
    columns: 4,
    rows: 4
};
function asTextureFrames(PIXI, textureSource, options = defaultOptions) {
    const { frameWidth, frameHeight, columns, rows } = options;
    const frames = [];
    if (!textureSource) {
        console.error('Invalid texture source provided to asTextureFrames');
        return frames;
    }
    for (let y = 0; y < rows; y++) {
        for (let x = 0; x < columns; x++) {
            const frame = new PIXI.Rectangle(x * frameWidth, y * frameHeight, frameWidth, frameHeight);
            const frametexture = new PIXI.Texture({
                source: textureSource,
                frame: frame,
            });
            frames.push(frametexture);
        }
    }
    return frames;
}


/***/ }),

/***/ "./src/library/utils.ts":
/*!******************************!*\
  !*** ./src/library/utils.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.deg2rad = exports.rad2deg = exports.fetchXml = exports.lerp = exports.roundTo = exports.getRandomInt = exports.pr = exports.padRight = exports.lc = exports.uc = exports.ONE_POINT = exports.ZERO_POINT = exports.createPoint = void 0;
exports.metersToPixels = metersToPixels;
exports.pixelsToMeters = pixelsToMeters;
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
const createPoint = (x = 0, y = 0) => new pixi_js_1.Point(x, y);
exports.createPoint = createPoint;
const ZERO_POINT = () => new pixi_js_1.Point(0, 0);
exports.ZERO_POINT = ZERO_POINT;
const ONE_POINT = () => new pixi_js_1.Point(1, 1);
exports.ONE_POINT = ONE_POINT;
const uc = (s = '') => s.toUpperCase();
exports.uc = uc;
const lc = (s = '') => s.toLowerCase();
exports.lc = lc;
const padRight = (val = '', length = 0, padWith = ' ') => {
    let result = val + '';
    while (result.length < length) {
        result += padWith;
    }
    return result;
};
exports.padRight = padRight;
exports.pr = exports.padRight;
const getRandomInt = (min, max) => (Math.floor(Math.random() * (max + 1 - min)) + min);
exports.getRandomInt = getRandomInt;
const roundTo = (places, value) => (Math.round(value * Math.pow(10, places)) / Math.pow(10, places));
exports.roundTo = roundTo;
const lerp = (begin, end, mag) => ((1 - mag) * begin + mag * end);
exports.lerp = lerp;
function metersToPixels(m) { return m * 20; }
function pixelsToMeters(p) { return p * 0.05; }
const fetchXml = async (url) => (await (await fetch(url)).text());
exports.fetchXml = fetchXml;
const rad2deg = (rad) => rad * (180 / Math.PI);
exports.rad2deg = rad2deg;
const deg2rad = (deg) => deg * (Math.PI / 180);
exports.deg2rad = deg2rad;


/***/ }),

/***/ "./src/ui/UILayer.ts":
/*!***************************!*\
  !*** ./src/ui/UILayer.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UILayer = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const UIScaleMode_1 = __webpack_require__(/*! ./UIScaleMode */ "./src/ui/UIScaleMode.ts");
class UILayer extends PIXI.Container {
    scaleMode;
    targetWidth;
    targetHeight;
    initialBoundsRecorded = false;
    constructor(options = {}) {
        super();
        this.scaleMode = options.scaleMode ?? UIScaleMode_1.UIScaleMode.None;
        this.targetWidth = options.targetWidth;
        this.targetHeight = options.targetHeight;
    }
    updateScale(canvasWidth, canvasHeight) {
        if (this.scaleMode === UIScaleMode_1.UIScaleMode.None) {
            this.scale.set(1, 1);
            return;
        }
        if (!this.initialBoundsRecorded && this.children.length > 0) {
            if (!this.targetWidth || !this.targetHeight) {
                const bounds = this.getLocalBounds();
                this.targetWidth = this.targetWidth ?? bounds.width;
                this.targetHeight = this.targetHeight ?? bounds.height;
            }
            this.initialBoundsRecorded = true;
        }
        if (!this.targetWidth || !this.targetHeight) {
            return;
        }
        const scaleX = canvasWidth / this.targetWidth;
        const scaleY = canvasHeight / this.targetHeight;
        switch (this.scaleMode) {
            case UIScaleMode_1.UIScaleMode.ScaleUI:
                this.scale.set(scaleX, scaleY);
                break;
            case UIScaleMode_1.UIScaleMode.LockRatio:
                const scale = Math.min(scaleX, scaleY);
                this.scale.set(scale, scale);
                this.position.set((canvasWidth - this.targetWidth * scale) / 2, (canvasHeight - this.targetHeight * scale) / 2);
                break;
        }
    }
    addChild(...children) {
        const result = super.addChild(...children);
        this.initialBoundsRecorded = false;
        return result;
    }
}
exports.UILayer = UILayer;


/***/ }),

/***/ "./src/ui/UIScaleMode.ts":
/*!*******************************!*\
  !*** ./src/ui/UIScaleMode.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIScaleMode = void 0;
var UIScaleMode;
(function (UIScaleMode) {
    UIScaleMode["None"] = "none";
    UIScaleMode["ScaleUI"] = "scaleUI";
    UIScaleMode["LockRatio"] = "lockRatio";
})(UIScaleMode || (exports.UIScaleMode = UIScaleMode = {}));


/***/ }),

/***/ "./src/ui/components/button-background-strategy.ts":
/*!*********************************************************!*\
  !*** ./src/ui/components/button-background-strategy.ts ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.SpriteBackgroundStrategy = exports.SolidColorBackgroundStrategy = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_button_1 = __webpack_require__(/*! ./ui-button */ "./src/ui/components/ui-button.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
class SolidColorBackgroundStrategy {
    panel;
    normalColor;
    hoverColor;
    pressedColor;
    disabledColor;
    width;
    height;
    borderRadius;
    constructor(backgroundColor, width, height, borderRadius) {
        this.normalColor = backgroundColor;
        this.hoverColor = this.darkenColor(backgroundColor, 0.9);
        this.pressedColor = this.darkenColor(backgroundColor, 0.8);
        this.disabledColor = 0x888888;
        this.width = width;
        this.height = height;
        this.borderRadius = borderRadius;
    }
    create(width, height) {
        this.panel = new ui_panel_1.UIPanel({
            backgroundColor: this.normalColor,
            width,
            height,
            borderRadius: this.borderRadius
        });
        this.panel.layout(width, height);
        return this.panel.container;
    }
    updateState(state) {
        if (!this.panel)
            return;
        let color;
        switch (state) {
            case ui_button_1.ButtonState.Normal:
                color = this.normalColor;
                break;
            case ui_button_1.ButtonState.Hover:
                color = this.hoverColor;
                break;
            case ui_button_1.ButtonState.Pressed:
                color = this.pressedColor;
                break;
            case ui_button_1.ButtonState.Disabled:
                color = this.disabledColor;
                break;
        }
        this.panel.setBackgroundColor(color);
    }
    getActualHeight() {
        return this.height;
    }
    destroy() {
    }
    darkenColor(color, factor) {
        const r = ((color >> 16) & 0xff) * factor;
        const g = ((color >> 8) & 0xff) * factor;
        const b = (color & 0xff) * factor;
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
}
exports.SolidColorBackgroundStrategy = SolidColorBackgroundStrategy;
class SpriteBackgroundStrategy {
    container;
    spriteLeft;
    spriteMid;
    spriteRight;
    nineSliceSprite;
    nineSliceSpritePressed;
    iconSprite;
    config;
    width;
    height;
    constructor(config, width, height) {
        this.config = config;
        this.width = width;
        this.height = height;
    }
    create(width, height) {
        this.container = new pixi_js_1.default.Container();
        const { spritesheet, texturePattern, color, pixelPerfect, useNineSlice, nineSliceBorders, pressedTexturePattern, icon } = this.config;
        if (pixelPerfect && spritesheet.textureSource) {
            spritesheet.textureSource.scaleMode = 'nearest';
        }
        if (useNineSlice && nineSliceBorders) {
            const textureName = texturePattern.includes('{color}')
                ? texturePattern.replace('{color}', color)
                : texturePattern;
            const texture = spritesheet.textures[textureName];
            this.nineSliceSprite = new pixi_js_1.default.NineSliceSprite({
                texture,
                leftWidth: nineSliceBorders.left,
                topHeight: nineSliceBorders.top,
                rightWidth: nineSliceBorders.right,
                bottomHeight: nineSliceBorders.bottom,
                width,
                height
            });
            this.container.addChild(this.nineSliceSprite);
            if (pressedTexturePattern) {
                const pressedTextureName = pressedTexturePattern.includes('{color}')
                    ? pressedTexturePattern.replace('{color}', color)
                    : pressedTexturePattern;
                const pressedTexture = spritesheet.textures[pressedTextureName];
                this.nineSliceSpritePressed = new pixi_js_1.default.NineSliceSprite({
                    texture: pressedTexture,
                    leftWidth: nineSliceBorders.left,
                    topHeight: nineSliceBorders.top,
                    rightWidth: nineSliceBorders.right,
                    bottomHeight: nineSliceBorders.bottom,
                    width,
                    height
                });
                this.nineSliceSpritePressed.y = 4;
                this.nineSliceSpritePressed.visible = false;
                this.container.addChild(this.nineSliceSpritePressed);
            }
        }
        else {
            const leftTextureName = this.getTextureName(texturePattern, color, 'left');
            const midTextureName = this.getTextureName(texturePattern, color, 'mid');
            const rightTextureName = this.getTextureName(texturePattern, color, 'right');
            this.spriteLeft = new pixi_js_1.default.Sprite(spritesheet.textures[leftTextureName]);
            this.spriteMid = new pixi_js_1.default.Sprite(spritesheet.textures[midTextureName]);
            this.spriteRight = new pixi_js_1.default.Sprite(spritesheet.textures[rightTextureName]);
            const scaleY = height / this.spriteLeft.height;
            this.spriteLeft.scale.y = scaleY;
            this.spriteMid.scale.y = scaleY;
            this.spriteRight.scale.y = scaleY;
            this.spriteLeft.x = 0;
            const middleWidth = width - this.spriteLeft.width - this.spriteRight.width;
            this.spriteMid.width = middleWidth;
            this.spriteMid.x = this.spriteLeft.width;
            this.spriteRight.x = this.spriteLeft.width + middleWidth;
            this.container.addChild(this.spriteLeft);
            this.container.addChild(this.spriteMid);
            this.container.addChild(this.spriteRight);
        }
        if (icon) {
            const iconTexture = icon.spritesheet.textures[icon.textureName];
            this.iconSprite = new pixi_js_1.default.Sprite(iconTexture);
            if (icon.pixelPerfect && icon.spritesheet.textureSource) {
                icon.spritesheet.textureSource.scaleMode = 'nearest';
            }
            if (icon.scale) {
                this.iconSprite.scale.set(icon.scale);
            }
            this.iconSprite.anchor.set(0.5);
            this.iconSprite.x = width / 2;
            this.iconSprite.y = height / 2;
            this.container.addChild(this.iconSprite);
        }
        return this.container;
    }
    updateState(state) {
        if (this.nineSliceSprite && this.nineSliceSpritePressed) {
            const isPressed = state === ui_button_1.ButtonState.Pressed;
            this.nineSliceSprite.visible = !isPressed;
            this.nineSliceSpritePressed.visible = isPressed;
            if (this.iconSprite) {
                this.iconSprite.y = (this.height / 2) + (isPressed ? 4 : 0);
            }
        }
        else {
            let tint;
            switch (state) {
                case ui_button_1.ButtonState.Normal:
                    tint = 0xffffff;
                    break;
                case ui_button_1.ButtonState.Hover:
                    tint = 0xcccccc;
                    break;
                case ui_button_1.ButtonState.Pressed:
                    tint = 0x999999;
                    break;
                case ui_button_1.ButtonState.Disabled:
                    tint = 0x888888;
                    break;
            }
            if (this.nineSliceSprite) {
                this.nineSliceSprite.tint = tint;
            }
            else if (this.spriteLeft && this.spriteMid && this.spriteRight) {
                this.spriteLeft.tint = tint;
                this.spriteMid.tint = tint;
                this.spriteRight.tint = tint;
            }
        }
    }
    getActualHeight() {
        if (this.nineSliceSprite) {
            return this.nineSliceSprite.height;
        }
        return this.spriteLeft?.height ?? this.height;
    }
    destroy() {
        this.container?.destroy({ children: true });
    }
    getTextureName(pattern, color, part) {
        let name = pattern.replace('{color}', color);
        name = name.replace(/_(?:left|mid|right)\.png$/, `_${part}.png`);
        return name;
    }
}
exports.SpriteBackgroundStrategy = SpriteBackgroundStrategy;


/***/ }),

/***/ "./src/ui/components/ui-box.ts":
/*!*************************************!*\
  !*** ./src/ui/components/ui-box.ts ***!
  \*************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIBox = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UIBox extends ui_component_1.UIComponent {
    props;
    graphics;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            backgroundColor: 0x000000,
            backgroundAlpha: 1,
            borderWidth: 0,
            borderRadius: 0,
            ...props
        };
        this.graphics = new pixi_js_1.default.Graphics();
        this.container.addChild(this.graphics);
        if (props.width !== undefined) {
            this.boxModel.width = props.width;
        }
        if (props.height !== undefined) {
            this.boxModel.height = props.height;
        }
    }
    measure() {
        const padding = this.boxModel.padding;
        const border = this.boxModel.border;
        let contentWidth = 0;
        let contentHeight = 0;
        if (typeof this.boxModel.width === 'number') {
            contentWidth = this.boxModel.width;
        }
        else if (this.props.width !== undefined) {
            contentWidth = this.props.width;
        }
        if (typeof this.boxModel.height === 'number') {
            contentHeight = this.boxModel.height;
        }
        else if (this.props.height !== undefined) {
            contentHeight = this.props.height;
        }
        const totalWidth = contentWidth + padding.horizontal + (border?.horizontal ?? 0);
        const totalHeight = contentHeight + padding.vertical + (border?.vertical ?? 0);
        return {
            width: Math.max(totalWidth, this.boxModel.minWidth ?? 0),
            height: Math.max(totalHeight, this.boxModel.minHeight ?? 0)
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        const padding = this.boxModel.padding;
        const border = this.boxModel.border ?? { horizontal: 0, vertical: 0, top: 0, right: 0, bottom: 0, left: 0 };
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        if (this.boxModel.maxWidth !== undefined) {
            finalWidth = Math.min(finalWidth, this.boxModel.maxWidth);
        }
        if (this.boxModel.maxHeight !== undefined) {
            finalHeight = Math.min(finalHeight, this.boxModel.maxHeight);
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left + border.left;
        this.computedLayout.contentY = padding.top + border.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal - border.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical - border.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        this.graphics.clear();
        const { width, height } = this.computedLayout;
        const { backgroundColor, backgroundAlpha, borderColor, borderWidth, borderRadius } = this.props;
        if (borderWidth && borderWidth > 0 && borderColor !== undefined) {
            this.graphics.rect(0, 0, width, height);
            this.graphics.stroke({ color: borderColor, width: borderWidth });
        }
        if (backgroundColor !== undefined) {
            if (borderRadius && borderRadius > 0) {
                this.graphics.roundRect(0, 0, width, height, borderRadius);
            }
            else {
                this.graphics.rect(0, 0, width, height);
            }
            this.graphics.fill({ color: backgroundColor, alpha: backgroundAlpha });
        }
    }
    setBackgroundColor(color, alpha = 1) {
        this.props.backgroundColor = color;
        this.props.backgroundAlpha = alpha;
        this.render();
    }
    setBorder(color, width) {
        this.props.borderColor = color;
        this.props.borderWidth = width;
        this.render();
    }
}
exports.UIBox = UIBox;


/***/ }),

/***/ "./src/ui/components/ui-button.ts":
/*!****************************************!*\
  !*** ./src/ui/components/ui-button.ts ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIButton = exports.ButtonState = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
const button_background_strategy_1 = __webpack_require__(/*! ./button-background-strategy */ "./src/ui/components/button-background-strategy.ts");
var ButtonState;
(function (ButtonState) {
    ButtonState["Normal"] = "normal";
    ButtonState["Hover"] = "hover";
    ButtonState["Pressed"] = "pressed";
    ButtonState["Disabled"] = "disabled";
})(ButtonState || (exports.ButtonState = ButtonState = {}));
class UIButton extends ui_component_1.UIComponent {
    props;
    useBitmapText;
    bitmapFontFamily;
    onClick;
    onHover;
    state = ButtonState.Normal;
    backgroundStrategy;
    label;
    bitmapLabel;
    labelCenterX = 0;
    labelCenterY = 0;
    keydownHandler;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            label: props.label ?? '',
            width: props.width ?? 120,
            height: props.height ?? 40,
            backgroundColor: props.backgroundColor ?? 0x4a90e2,
            textColor: props.textColor ?? 0xffffff,
            fontSize: props.fontSize ?? 16,
            borderRadius: props.borderRadius ?? 4,
            padding: props.padding ?? edge_insets_1.EdgeInsets.symmetric(8, 16),
            enabled: props.enabled ?? true
        };
        this.useBitmapText = props.useBitmapText ?? false;
        this.bitmapFontFamily = props.bitmapFontFamily;
        this.onClick = props.onClick;
        this.onHover = props.onHover;
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.tabIndex = 0;
        if (props.spriteBackground) {
            this.backgroundStrategy = new button_background_strategy_1.SpriteBackgroundStrategy(props.spriteBackground, this.props.width, this.props.height);
        }
        else {
            this.backgroundStrategy = new button_background_strategy_1.SolidColorBackgroundStrategy(this.props.backgroundColor, this.props.width, this.props.height, this.props.borderRadius);
        }
        const backgroundContainer = this.backgroundStrategy.create(this.props.width, this.props.height);
        this.container.addChild(backgroundContainer);
        if (this.props.label) {
            if (this.useBitmapText && this.bitmapFontFamily) {
                this.createBitmapLabel();
            }
            else {
                this.label = new ui_label_1.UILabel({
                    text: this.props.label,
                    fontSize: this.props.fontSize,
                    color: this.props.textColor,
                    align: 'center'
                }, {
                    padding: edge_insets_1.EdgeInsets.zero()
                });
                this.container.addChild(this.label.container);
            }
        }
        this.setupInteractivity();
        if (!this.props.enabled) {
            this.setState(ButtonState.Disabled);
        }
    }
    createBitmapLabel() {
        if (!this.bitmapFontFamily)
            return;
        this.bitmapLabel = new pixi_js_1.default.BitmapText({
            text: this.props.label,
            style: {
                fontFamily: this.bitmapFontFamily,
                fontSize: this.props.fontSize,
                fill: this.props.textColor
            }
        });
        this.container.addChild(this.bitmapLabel);
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'pointer';
        this.container.on('pointerover', this.handlePointerOver.bind(this));
        this.container.on('pointerout', this.handlePointerOut.bind(this));
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        this.container.on('pointerup', this.handlePointerUp.bind(this));
        this.container.on('pointerupoutside', this.handlePointerUpOutside.bind(this));
        if (typeof window !== 'undefined') {
            this.keydownHandler = (e) => {
                if (this.isFocused() && this.props.enabled) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.setState(ButtonState.Pressed);
                        this.onClick?.();
                        setTimeout(() => {
                            if (this.props.enabled) {
                                this.setState(ButtonState.Normal);
                            }
                        }, 100);
                    }
                }
            };
            window.addEventListener('keydown', this.keydownHandler);
        }
    }
    handlePointerOver() {
        if (this.props.enabled && this.state === ButtonState.Normal) {
            this.setState(ButtonState.Hover);
            this.onHover?.();
        }
    }
    handlePointerOut() {
        if (this.props.enabled && this.state !== ButtonState.Pressed) {
            this.setState(ButtonState.Normal);
        }
    }
    handlePointerDown() {
        if (this.props.enabled) {
            this.setState(ButtonState.Pressed);
            if (this.canFocus()) {
                const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
                if (focusManager) {
                    focusManager.requestFocus(this);
                }
                else {
                    this.onFocus();
                }
            }
        }
    }
    handlePointerUp() {
        if (this.props.enabled) {
            this.setState(ButtonState.Hover);
            this.onClick?.();
        }
    }
    handlePointerUpOutside() {
        if (this.props.enabled) {
            this.setState(ButtonState.Normal);
        }
    }
    setState(newState) {
        this.state = newState;
        this.updateVisuals();
    }
    updateVisuals() {
        this.backgroundStrategy.updateState(this.state);
        const yOffset = this.state === ButtonState.Pressed ? 2 : 0;
        if (this.state === ButtonState.Disabled) {
            this.container.cursor = 'default';
        }
        else {
            this.container.cursor = 'pointer';
        }
        if (this.label) {
            this.label.setPosition(this.labelCenterX, this.labelCenterY + yOffset);
        }
        else if (this.bitmapLabel) {
            this.bitmapLabel.x = this.labelCenterX;
            this.bitmapLabel.y = this.labelCenterY + yOffset;
        }
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        const actualHeight = this.backgroundStrategy.getActualHeight();
        if (this.label) {
            this.label.layout(measured.width, measured.height);
            const labelLayout = this.label.getLayout();
            this.labelCenterX = (measured.width - labelLayout.width) / 2;
            this.labelCenterY = (actualHeight - labelLayout.height) / 2;
            this.label.setPosition(this.labelCenterX, this.labelCenterY);
        }
        else if (this.bitmapLabel) {
            this.labelCenterX = (measured.width - this.bitmapLabel.width) / 2;
            this.labelCenterY = (actualHeight - this.bitmapLabel.height) / 2;
            this.bitmapLabel.x = this.labelCenterX;
            this.bitmapLabel.y = this.labelCenterY;
        }
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setLabel(text) {
        if (this.label) {
            this.label.setText(text);
            this.markLayoutDirty();
        }
        else if (this.bitmapLabel) {
            this.bitmapLabel.text = text;
            this.markLayoutDirty();
        }
    }
    setEnabled(enabled) {
        this.props.enabled = enabled;
        this.setState(enabled ? ButtonState.Normal : ButtonState.Disabled);
    }
    getState() {
        return this.state;
    }
    destroy() {
        if (typeof window !== 'undefined' && this.keydownHandler) {
            window.removeEventListener('keydown', this.keydownHandler);
        }
        super.destroy();
    }
}
exports.UIButton = UIButton;


/***/ }),

/***/ "./src/ui/components/ui-label.ts":
/*!***************************************!*\
  !*** ./src/ui/components/ui-label.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UILabel = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UILabel extends ui_component_1.UIComponent {
    props;
    textObject;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            text: props.text,
            fontSize: props.fontSize ?? 16,
            fontFamily: props.fontFamily ?? 'Arial',
            color: props.color ?? 0xffffff,
            align: props.align ?? 'left',
            wordWrap: props.wordWrap ?? false,
            wordWrapWidth: props.wordWrapWidth ?? 0,
            fontWeight: props.fontWeight ?? 'normal',
            lineHeight: props.lineHeight ?? 1.2
        };
        this.textObject = new pixi_js_1.default.Text({
            text: this.props.text,
            style: this.getTextStyle(),
            resolution: window.devicePixelRatio || 2
        });
        this.container.addChild(this.textObject);
    }
    getTextStyle() {
        const style = {
            fontFamily: this.props.fontFamily,
            fontSize: this.props.fontSize,
            fill: this.props.color,
            align: this.props.align,
            fontWeight: this.props.fontWeight,
            lineHeight: this.props.fontSize * this.props.lineHeight
        };
        if (this.props.wordWrap) {
            style.wordWrap = true;
            style.wordWrapWidth = this.props.wordWrapWidth;
        }
        return style;
    }
    measure() {
        const padding = this.boxModel.padding;
        const metrics = this.textObject;
        const textWidth = metrics.width;
        const textHeight = metrics.height;
        return {
            width: textWidth + padding.horizontal,
            height: textHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const padding = this.boxModel.padding;
        if (this.props.wordWrap && this.props.wordWrapWidth === 0) {
            const wrapWidth = availableWidth - padding.horizontal;
            this.props.wordWrapWidth = wrapWidth;
            this.textObject.style = this.getTextStyle();
        }
        const measured = this.measure();
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        else if (typeof this.boxModel.width === 'number') {
            finalWidth = this.boxModel.width + padding.horizontal;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        else if (typeof this.boxModel.height === 'number') {
            finalHeight = this.boxModel.height + padding.vertical;
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        const padding = this.boxModel.padding;
        this.textObject.position.set(padding.left, padding.top);
    }
    setText(text) {
        this.props.text = text;
        this.textObject.text = text;
        this.markLayoutDirty();
    }
    setColor(color) {
        this.props.color = color;
        this.textObject.style.fill = color;
    }
    setFontSize(size) {
        this.props.fontSize = size;
        this.textObject.style.fontSize = size;
        this.markLayoutDirty();
    }
    getText() {
        return this.props.text;
    }
}
exports.UILabel = UILabel;


/***/ }),

/***/ "./src/ui/components/ui-panel.ts":
/*!***************************************!*\
  !*** ./src/ui/components/ui-panel.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIPanel = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UIPanel extends ui_component_1.UIComponent {
    props;
    background;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            backgroundAlpha: props.backgroundAlpha ?? 1,
            ...props
        };
        if (props.width !== undefined) {
            this.boxModel.width = props.width;
        }
        if (props.height !== undefined) {
            this.boxModel.height = props.height;
        }
        this.createBackground();
    }
    createBackground() {
        if (this.props.texture && this.props.nineSlice) {
            const { leftWidth, topHeight, rightWidth, bottomHeight } = this.props.nineSlice;
            this.background = new pixi_js_1.default.NineSliceSprite({
                texture: this.props.texture,
                leftWidth,
                topHeight,
                rightWidth,
                bottomHeight
            });
            this.background.alpha = this.props.backgroundAlpha ?? 1;
            this.container.addChild(this.background);
        }
        else if (this.props.backgroundColor !== undefined) {
            this.background = new pixi_js_1.default.Graphics();
            this.container.addChild(this.background);
        }
    }
    measure() {
        const padding = this.boxModel.padding;
        let contentWidth = 0;
        let contentHeight = 0;
        if (typeof this.boxModel.width === 'number') {
            contentWidth = this.boxModel.width;
        }
        else if (this.props.width !== undefined) {
            contentWidth = this.props.width;
        }
        if (typeof this.boxModel.height === 'number') {
            contentHeight = this.boxModel.height;
        }
        else if (this.props.height !== undefined) {
            contentHeight = this.props.height;
        }
        return {
            width: contentWidth + padding.horizontal,
            height: contentHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        const padding = this.boxModel.padding;
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        if (this.boxModel.maxWidth !== undefined) {
            finalWidth = Math.min(finalWidth, this.boxModel.maxWidth);
        }
        if (this.boxModel.maxHeight !== undefined) {
            finalHeight = Math.min(finalHeight, this.boxModel.maxHeight);
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        if (!this.background)
            return;
        const { width, height } = this.computedLayout;
        if (this.background instanceof pixi_js_1.default.NineSliceSprite) {
            this.background.width = width;
            this.background.height = height;
        }
        else if (this.background instanceof pixi_js_1.default.Graphics) {
            this.background.clear();
            if (this.props.borderRadius && this.props.borderRadius > 0) {
                this.background.roundRect(0, 0, width, height, this.props.borderRadius);
            }
            else {
                this.background.rect(0, 0, width, height);
            }
            if (this.props.backgroundColor !== undefined) {
                this.background.fill({
                    color: this.props.backgroundColor,
                    alpha: this.props.backgroundAlpha
                });
            }
        }
    }
    setBackgroundColor(color, alpha = 1) {
        if (this.background instanceof pixi_js_1.default.Graphics) {
            this.props.backgroundColor = color;
            this.props.backgroundAlpha = alpha;
            this.render();
        }
    }
    setTexture(texture) {
        if (this.background instanceof pixi_js_1.default.NineSliceSprite) {
            this.background.texture = texture;
        }
    }
}
exports.UIPanel = UIPanel;


/***/ }),

/***/ "./src/ui/components/ui-scroll-container.ts":
/*!**************************************************!*\
  !*** ./src/ui/components/ui-scroll-container.ts ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIScrollContainer = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
class UIScrollContainer extends ui_component_1.UIComponent {
    props;
    background;
    contentContainer;
    contentMask;
    scrollbarTrack;
    scrollbarThumb;
    children = [];
    scrollY = 0;
    maxScrollY = 0;
    contentHeight = 0;
    isDragging = false;
    dragStartY = 0;
    dragStartScrollY = 0;
    isHoveringThumb = false;
    boundGlobalPointerMove = null;
    boundGlobalPointerUp = null;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            width: props.width,
            height: props.height,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            borderRadius: props.borderRadius ?? 0,
            scrollbarWidth: props.scrollbarWidth ?? 12,
            scrollbarTrackColor: props.scrollbarTrackColor ?? 0xe0e0e0,
            scrollbarThumbColor: props.scrollbarThumbColor ?? 0x888888,
            scrollbarThumbHoverColor: props.scrollbarThumbHoverColor ?? 0x555555,
            scrollbarAutoHide: props.scrollbarAutoHide ?? false,
            padding: props.padding ?? edge_insets_1.EdgeInsets.all(0)
        };
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new pixi_js_1.default.Graphics();
        this.updateBackground();
        this.container.addChild(this.background);
        this.contentContainer = new pixi_js_1.default.Container();
        this.contentContainer.x = this.props.padding.left;
        this.contentContainer.y = this.props.padding.top;
        this.container.addChild(this.contentContainer);
        this.contentMask = new pixi_js_1.default.Graphics();
        this.updateMask();
        this.container.addChild(this.contentMask);
        this.contentContainer.mask = this.contentMask;
        this.scrollbarTrack = new pixi_js_1.default.Graphics();
        this.scrollbarTrack.eventMode = 'static';
        this.scrollbarTrack.cursor = 'pointer';
        this.container.addChild(this.scrollbarTrack);
        this.scrollbarThumb = new pixi_js_1.default.Graphics();
        this.scrollbarThumb.eventMode = 'static';
        this.scrollbarThumb.cursor = 'pointer';
        this.container.addChild(this.scrollbarThumb);
        this.setupInteractivity();
        this.updateScrollbar();
    }
    updateBackground() {
        this.background.clear();
        this.background.roundRect(0, 0, this.props.width, this.props.height, this.props.borderRadius);
        this.background.fill({ color: this.props.backgroundColor });
    }
    updateMask() {
        const contentWidth = this.props.width - this.props.padding.left - this.props.padding.right - this.props.scrollbarWidth;
        const contentHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        this.contentMask.clear();
        this.contentMask.rect(this.props.padding.left, this.props.padding.top, contentWidth, contentHeight);
        this.contentMask.fill({ color: 0xffffff });
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.on('wheel', this.handleWheel.bind(this));
        this.scrollbarThumb.on('pointerdown', this.handleThumbPointerDown.bind(this));
        this.scrollbarThumb.on('pointerover', () => {
            this.isHoveringThumb = true;
            this.updateScrollbar();
        });
        this.scrollbarThumb.on('pointerout', () => {
            if (!this.isDragging) {
                this.isHoveringThumb = false;
                this.updateScrollbar();
            }
        });
        this.scrollbarTrack.on('pointerdown', this.handleTrackPointerDown.bind(this));
        if (typeof window !== 'undefined') {
            this.boundGlobalPointerMove = this.handleGlobalPointerMove.bind(this);
            this.boundGlobalPointerUp = this.handleGlobalPointerUp.bind(this);
            window.addEventListener('pointermove', this.boundGlobalPointerMove);
            window.addEventListener('pointerup', this.boundGlobalPointerUp);
        }
    }
    handleWheel(e) {
        e.preventDefault();
        const delta = e.deltaY;
        this.scrollY += delta;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleThumbPointerDown(e) {
        this.isDragging = true;
        this.dragStartY = e.globalY;
        this.dragStartScrollY = this.scrollY;
        e.stopPropagation();
    }
    handleTrackPointerDown(e) {
        const localY = e.globalY - this.container.worldTransform.ty;
        const thumbHeight = this.getThumbHeight();
        const trackTop = 0;
        const trackBottom = this.props.height;
        const clickRatio = (localY - trackTop) / (trackBottom - trackTop);
        this.scrollY = clickRatio * this.maxScrollY;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleGlobalPointerMove(e) {
        if (!this.isDragging)
            return;
        const deltaY = e.clientY - this.dragStartY;
        const trackHeight = this.props.height;
        const thumbHeight = this.getThumbHeight();
        const scrollableTrackHeight = trackHeight - thumbHeight;
        if (scrollableTrackHeight <= 0)
            return;
        const scrollDelta = (deltaY / scrollableTrackHeight) * this.maxScrollY;
        this.scrollY = this.dragStartScrollY + scrollDelta;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleGlobalPointerUp() {
        if (this.isDragging) {
            this.isDragging = false;
            if (!this.isHoveringThumb) {
                this.updateScrollbar();
            }
        }
    }
    updateContentPosition() {
        this.contentContainer.y = this.props.padding.top - this.scrollY;
    }
    getThumbHeight() {
        if (this.contentHeight <= 0)
            return 0;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        const ratio = viewportHeight / this.contentHeight;
        const thumbHeight = Math.max(30, this.props.height * ratio);
        return Math.min(thumbHeight, this.props.height);
    }
    getThumbY() {
        if (this.maxScrollY <= 0)
            return 0;
        const trackHeight = this.props.height;
        const thumbHeight = this.getThumbHeight();
        const scrollableTrackHeight = trackHeight - thumbHeight;
        const scrollRatio = this.scrollY / this.maxScrollY;
        return scrollRatio * scrollableTrackHeight;
    }
    updateScrollbar() {
        const trackX = this.props.width - this.props.scrollbarWidth;
        const trackWidth = this.props.scrollbarWidth;
        const trackHeight = this.props.height;
        this.scrollbarTrack.clear();
        this.scrollbarTrack.rect(trackX, 0, trackWidth, trackHeight);
        this.scrollbarTrack.fill({ color: this.props.scrollbarTrackColor });
        const thumbHeight = this.getThumbHeight();
        const thumbY = this.getThumbY();
        const thumbColor = (this.isHoveringThumb || this.isDragging)
            ? this.props.scrollbarThumbHoverColor
            : this.props.scrollbarThumbColor;
        this.scrollbarThumb.clear();
        if (this.maxScrollY > 0) {
            this.scrollbarThumb.roundRect(trackX + 2, thumbY + 2, trackWidth - 4, thumbHeight - 4, 4);
            this.scrollbarThumb.fill({ color: thumbColor });
            this.scrollbarThumb.visible = true;
        }
        else {
            this.scrollbarThumb.visible = false;
        }
        if (this.props.scrollbarAutoHide && !this.isDragging && !this.isHoveringThumb) {
            this.scrollbarTrack.alpha = 0;
            this.scrollbarThumb.alpha = 0;
        }
        else {
            this.scrollbarTrack.alpha = 1;
            this.scrollbarThumb.alpha = 1;
        }
    }
    updateContentBounds() {
        let maxHeight = 0;
        this.contentContainer.children.forEach((child) => {
            if (child && typeof child.y === 'number' && typeof child.height === 'number') {
                const childBottom = child.y + child.height;
                if (childBottom > maxHeight) {
                    maxHeight = childBottom;
                }
            }
        });
        this.contentHeight = maxHeight;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        this.maxScrollY = Math.max(0, this.contentHeight - viewportHeight);
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    addChild(child) {
        child.parent = this;
        this.children.push(child);
        this.contentContainer.addChild(child.container);
        const contentWidth = this.props.width - this.props.padding.left - this.props.padding.right - this.props.scrollbarWidth;
        const contentHeight = 999999;
        child.layout(contentWidth, contentHeight);
        this.updateContentBounds();
    }
    removeChild(child) {
        child.parent = undefined;
        const index = this.children.indexOf(child);
        if (index !== -1) {
            this.children.splice(index, 1);
        }
        this.contentContainer.removeChild(child.container);
        this.updateContentBounds();
    }
    scrollTo(y) {
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, y));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    scrollToTop() {
        this.scrollTo(0);
    }
    scrollToBottom() {
        this.scrollTo(this.maxScrollY);
    }
    getScrollY() {
        return this.scrollY;
    }
    getMaxScrollY() {
        return this.maxScrollY;
    }
    scrollToComponent(component) {
        const componentBounds = component.getGlobalBounds();
        const containerBounds = this.getGlobalBounds();
        const relativeY = componentBounds.y - containerBounds.y - this.props.padding.top + this.scrollY;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        if (relativeY < this.scrollY) {
            this.scrollTo(relativeY);
        }
        else if (relativeY + componentBounds.height > this.scrollY + viewportHeight) {
            const targetScroll = relativeY + componentBounds.height - viewportHeight;
            this.scrollTo(targetScroll);
        }
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.updateContentBounds();
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    destroy() {
        if (typeof window !== 'undefined') {
            if (this.boundGlobalPointerMove) {
                window.removeEventListener('pointermove', this.boundGlobalPointerMove);
                this.boundGlobalPointerMove = null;
            }
            if (this.boundGlobalPointerUp) {
                window.removeEventListener('pointerup', this.boundGlobalPointerUp);
                this.boundGlobalPointerUp = null;
            }
        }
        super.destroy();
    }
}
exports.UIScrollContainer = UIScrollContainer;


/***/ }),

/***/ "./src/ui/components/ui-select.ts":
/*!****************************************!*\
  !*** ./src/ui/components/ui-select.ts ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UISelect = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
class UISelect extends ui_component_1.UIComponent {
    props;
    onChange;
    selectedValue;
    background;
    label;
    dropdownContainer;
    dropdownPanel;
    optionLabels = [];
    isOpen = false;
    hoverColor;
    selectedColor;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            options: props.options ?? [],
            placeholder: props.placeholder ?? 'Select...',
            width: props.width ?? 200,
            height: props.height ?? 36,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            borderRadius: props.borderRadius ?? 4
        };
        this.onChange = props.onChange;
        this.selectedValue = props.value ?? props.defaultValue;
        this.hoverColor = this.darkenColor(this.props.backgroundColor, 0.95);
        this.selectedColor = this.darkenColor(this.props.backgroundColor, 0.9);
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        const displayText = this.getDisplayText();
        this.label = new ui_label_1.UILabel({
            text: displayText,
            fontSize: 14,
            color: this.selectedValue ? this.props.textColor : 0x999999,
            align: 'left'
        }, {
            padding: edge_insets_1.EdgeInsets.symmetric(8, 12)
        });
        this.container.addChild(this.label.container);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (!this.selectedValue) {
            return this.props.placeholder;
        }
        const option = this.props.options.find(opt => opt.value === this.selectedValue);
        return option ? option.label : this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'pointer';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
    }
    handlePointerDown() {
        if (this.props.disabled)
            return;
        if (this.isOpen) {
            this.closeDropdown();
        }
        else {
            this.openDropdown();
        }
    }
    openDropdown() {
        this.isOpen = true;
        this.dropdownContainer = new pixi_js_1.default.Container();
        this.dropdownContainer.position.set(0, this.props.height + 4);
        const dropdownHeight = Math.min(this.props.options.length * 32, 200);
        this.dropdownPanel = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: dropdownHeight,
            borderRadius: this.props.borderRadius
        });
        this.dropdownContainer.addChild(this.dropdownPanel.container);
        this.optionLabels = [];
        this.props.options.forEach((option, index) => {
            const optionContainer = new pixi_js_1.default.Container();
            optionContainer.position.set(0, index * 32);
            const optionBg = new pixi_js_1.default.Graphics();
            optionBg.rect(0, 0, this.props.width, 32);
            optionBg.fill({ color: this.props.backgroundColor, alpha: 0 });
            optionContainer.addChild(optionBg);
            const optionLabel = new ui_label_1.UILabel({
                text: option.label,
                fontSize: 14,
                color: option.disabled ? 0x999999 : this.props.textColor,
                align: 'left'
            }, {
                padding: edge_insets_1.EdgeInsets.symmetric(8, 12)
            });
            optionLabel.layout(this.props.width, 32);
            optionContainer.addChild(optionLabel.container);
            if (!option.disabled) {
                optionContainer.eventMode = 'static';
                optionContainer.cursor = 'pointer';
                optionContainer.on('pointerover', () => {
                    optionBg.clear();
                    optionBg.rect(0, 0, this.props.width, 32);
                    optionBg.fill({ color: this.hoverColor });
                });
                optionContainer.on('pointerout', () => {
                    optionBg.clear();
                    optionBg.rect(0, 0, this.props.width, 32);
                    optionBg.fill({ color: this.props.backgroundColor, alpha: 0 });
                });
                optionContainer.on('pointerdown', () => {
                    this.selectOption(option.value);
                });
            }
            this.dropdownContainer.addChild(optionContainer);
            this.optionLabels.push(optionLabel);
        });
        this.container.addChild(this.dropdownContainer);
        this.setupClickOutside();
    }
    closeDropdown() {
        this.isOpen = false;
        if (this.dropdownContainer) {
            this.container.removeChild(this.dropdownContainer);
            this.dropdownContainer = undefined;
            this.dropdownPanel = undefined;
            this.optionLabels = [];
        }
        this.removeClickOutside();
    }
    selectOption(value) {
        this.selectedValue = value;
        this.label.setText(this.getDisplayText());
        this.label.setColor(this.props.textColor);
        this.onChange?.(value);
        this.closeDropdown();
    }
    setupClickOutside() {
        const stage = this.container.parent;
        if (stage) {
            stage.eventMode = 'static';
            stage.once('pointerdown', (e) => {
                const point = e.global;
                const bounds = this.container.getBounds();
                if (point.x < bounds.x || point.x > bounds.x + bounds.width ||
                    point.y < bounds.y || point.y > bounds.y + bounds.height) {
                    this.closeDropdown();
                }
            });
        }
    }
    removeClickOutside() {
    }
    darkenColor(color, factor) {
        const r = ((color >> 16) & 0xff) * factor;
        const g = ((color >> 8) & 0xff) * factor;
        const b = (color & 0xff) * factor;
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.label.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.selectedValue = value;
        this.label.setText(this.getDisplayText());
        this.label.setColor(this.props.textColor);
    }
    getValue() {
        return this.selectedValue;
    }
    setOptions(options) {
        this.props.options = options;
        if (this.isOpen) {
            this.closeDropdown();
        }
    }
}
exports.UISelect = UISelect;


/***/ }),

/***/ "./src/ui/components/ui-tabs.ts":
/*!**************************************!*\
  !*** ./src/ui/components/ui-tabs.ts ***!
  \**************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITabs = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
class UITabs extends ui_component_1.UIComponent {
    items;
    activeKey;
    onChange;
    type;
    tabPosition;
    width;
    height;
    tabBarBackgroundColor;
    tabBarHeight;
    activeTabColor;
    inactiveTabColor;
    textColor;
    activeTextColor;
    hashPrefix;
    tabBar;
    contentArea;
    tabButtons = new Map();
    activeIndicator;
    hashChangeHandler;
    constructor(props, boxModel) {
        super(boxModel);
        this.items = props.items || [];
        this.onChange = props.onChange;
        this.type = props.type || 'line';
        this.tabPosition = props.tabPosition || 'top';
        this.tabBarBackgroundColor = props.tabBarBackgroundColor ?? 0x2d2d44;
        this.tabBarHeight = props.tabBarHeight ?? 48;
        this.activeTabColor = props.activeTabColor ?? 0x1890ff;
        this.inactiveTabColor = props.inactiveTabColor ?? 0x3d3d54;
        this.textColor = props.textColor ?? 0xaaaaaa;
        this.activeTextColor = props.activeTextColor ?? 0xffffff;
        this.hashPrefix = props.hashPrefix;
        let initialKey = props.activeKey || props.defaultActiveKey || (this.items.length > 0 ? this.items[0].key : '');
        if (this.hashPrefix && !props.activeKey) {
            const hashKey = this.getKeyFromHash();
            if (hashKey && this.items.find(item => item.key === hashKey)) {
                initialKey = hashKey;
            }
        }
        this.activeKey = initialKey;
        this.width = props.width ?? 800;
        this.height = props.height ?? 600;
        this.tabBar = new PIXI.Container();
        this.contentArea = new PIXI.Container();
        this.container.addChild(this.tabBar);
        this.container.addChild(this.contentArea);
        this.buildTabs();
        this.showActiveTab();
        if (this.hashPrefix) {
            this.setupHashListener();
            this.updateHash(this.activeKey);
        }
    }
    getKeyFromHash() {
        if (!this.hashPrefix)
            return null;
        const hash = window.location.hash.slice(1);
        const prefix = `${this.hashPrefix}/`;
        if (hash.startsWith(prefix)) {
            return hash.slice(prefix.length);
        }
        return null;
    }
    updateHash(key) {
        if (!this.hashPrefix)
            return;
        const newHash = `#${this.hashPrefix}/${key}`;
        if (window.location.hash !== newHash) {
            window.location.hash = newHash;
        }
    }
    setupHashListener() {
        this.hashChangeHandler = () => {
            const hashKey = this.getKeyFromHash();
            if (hashKey && hashKey !== this.activeKey) {
                this.setActiveKey(hashKey, false);
            }
        };
        window.addEventListener('hashchange', this.hashChangeHandler);
    }
    destroy() {
        if (this.hashChangeHandler) {
            window.removeEventListener('hashchange', this.hashChangeHandler);
        }
    }
    buildTabs() {
        this.tabBar.removeChildren();
        this.tabButtons.clear();
        const tabBarBg = new PIXI.Graphics();
        tabBarBg.rect(0, 0, this.width, this.tabBarHeight);
        tabBarBg.fill({ color: this.tabBarBackgroundColor });
        this.tabBar.addChild(tabBarBg);
        if (this.type === 'line') {
            const borderLine = new PIXI.Graphics();
            borderLine.rect(0, this.tabBarHeight - 2, this.width, 2);
            borderLine.fill({ color: 0x3d3d54, alpha: 0.5 });
            this.tabBar.addChild(borderLine);
        }
        if (this.tabPosition === 'bottom') {
            this.tabBar.y = this.height - this.tabBarHeight;
            this.contentArea.y = 0;
        }
        else {
            this.tabBar.y = 0;
            this.contentArea.y = this.tabBarHeight;
        }
        let xOffset = 8;
        const tabPadding = 24;
        const tabGap = 8;
        for (const item of this.items) {
            if (item.disabled)
                continue;
            const tabContainer = new PIXI.Container();
            tabContainer.x = xOffset;
            const isActive = this.activeKey === item.key;
            const label = new ui_label_1.UILabel({
                text: item.label,
                fontSize: 15,
                fontWeight: isActive ? 'bold' : 'normal',
                color: isActive ? this.activeTextColor : this.textColor
            });
            label.measure();
            label.layout(this.width, this.tabBarHeight);
            const labelBounds = label.container.getLocalBounds();
            const tabWidth = labelBounds.width + (tabPadding * 2);
            let bg;
            if (this.type === 'card') {
                bg = new PIXI.Graphics();
                bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                bg.fill({ color: isActive ? this.activeTabColor : this.inactiveTabColor });
                bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                bg.stroke({ color: isActive ? this.activeTabColor : 0x4d4d64, width: 2 });
                tabContainer.addChild(bg);
            }
            else {
                bg = new PIXI.Graphics();
                bg.rect(0, 0, tabWidth, this.tabBarHeight);
                bg.fill({ color: 0x000000, alpha: 0 });
                tabContainer.addChild(bg);
            }
            label.container.x = tabPadding;
            label.container.y = (this.tabBarHeight - labelBounds.height) / 2;
            tabContainer.addChild(label.container);
            tabContainer.eventMode = 'static';
            tabContainer.cursor = 'pointer';
            const tabKey = item.key;
            tabContainer.on('pointerdown', () => {
                this.setActiveKey(tabKey);
            });
            tabContainer.on('pointerover', () => {
                if (this.activeKey !== tabKey) {
                    if (this.type === 'card') {
                        bg.clear();
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.fill({ color: this.activeTabColor, alpha: 0.5 });
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.stroke({ color: this.activeTabColor, width: 2 });
                    }
                    else {
                        label.setColor(this.activeTextColor);
                    }
                }
            });
            tabContainer.on('pointerout', () => {
                if (this.activeKey !== tabKey) {
                    if (this.type === 'card') {
                        bg.clear();
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.fill({ color: this.inactiveTabColor });
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.stroke({ color: 0x4d4d64, width: 2 });
                    }
                    else {
                        label.setColor(this.textColor);
                    }
                }
            });
            this.tabBar.addChild(tabContainer);
            this.tabButtons.set(item.key, { container: tabContainer, label, bg });
            xOffset += tabWidth + tabGap;
        }
        if (this.type === 'line') {
            this.activeIndicator = new PIXI.Graphics();
            this.tabBar.addChild(this.activeIndicator);
            this.updateActiveIndicator();
        }
    }
    updateActiveIndicator() {
        if (!this.activeIndicator || this.type !== 'line')
            return;
        this.activeIndicator.clear();
        const activeTab = this.tabButtons.get(this.activeKey);
        if (!activeTab)
            return;
        const tabX = activeTab.container.x;
        const tabBounds = activeTab.bg.getLocalBounds();
        const tabWidth = tabBounds.width;
        const indicatorHeight = 3;
        const indicatorY = this.tabBarHeight - indicatorHeight;
        this.activeIndicator.roundRect(tabX + 8, indicatorY, tabWidth - 16, indicatorHeight, 1.5);
        this.activeIndicator.fill({ color: this.activeTabColor });
    }
    showActiveTab() {
        this.contentArea.removeChildren();
        const activeItem = this.items.find(item => item.key === this.activeKey);
        if (!activeItem)
            return;
        const contentHeight = this.height - this.tabBarHeight;
        activeItem.content.layout(this.width, contentHeight);
        this.contentArea.addChild(activeItem.content.container);
        this.tabButtons.forEach((tab, key) => {
            const isActive = key === this.activeKey;
            const tabBounds = tab.bg.getLocalBounds();
            if (this.type === 'card') {
                tab.bg.clear();
                tab.bg.roundRect(0, 0, tabBounds.width, this.tabBarHeight - 2, 6);
                tab.bg.fill({ color: isActive ? this.activeTabColor : this.inactiveTabColor });
                tab.bg.roundRect(0, 0, tabBounds.width, this.tabBarHeight - 2, 6);
                tab.bg.stroke({ color: isActive ? this.activeTabColor : 0x4d4d64, width: 2 });
            }
            else {
                tab.bg.clear();
                tab.bg.rect(0, 0, tabBounds.width, this.tabBarHeight);
                tab.bg.fill({ color: 0x000000, alpha: 0 });
            }
            tab.label.setColor(isActive ? this.activeTextColor : this.textColor);
            tab.label.container.alpha = 1;
        });
        if (this.type === 'line') {
            this.updateActiveIndicator();
        }
    }
    setActiveKey(key, updateHash = true) {
        if (this.activeKey === key)
            return;
        const item = this.items.find(item => item.key === key);
        if (!item || item.disabled)
            return;
        this.activeKey = key;
        this.showActiveTab();
        if (updateHash && this.hashPrefix) {
            this.updateHash(key);
        }
        if (this.onChange) {
            this.onChange(key);
        }
    }
    getActiveKey() {
        return this.activeKey;
    }
    setItems(items) {
        this.items = items;
        if (!this.items.find(item => item.key === this.activeKey)) {
            this.activeKey = this.items.length > 0 ? this.items[0].key : '';
        }
        this.buildTabs();
        this.showActiveTab();
    }
    measure() {
        return {
            width: this.width,
            height: this.height
        };
    }
    layout(width, height) {
        this.width = width;
        this.height = height;
        this.buildTabs();
        this.showActiveTab();
    }
    render() {
    }
}
exports.UITabs = UITabs;


/***/ }),

/***/ "./src/ui/components/ui-text-input.ts":
/*!********************************************!*\
  !*** ./src/ui/components/ui-text-input.ts ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITextInput = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
class UITextInput extends ui_component_1.UIComponent {
    props;
    onChange;
    currentValue;
    background;
    textDisplay;
    cursor;
    cursorPosition = 0;
    cursorBlinkInterval;
    cursorVisible = true;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            placeholder: props.placeholder ?? '',
            maxLength: props.maxLength ?? 100,
            width: props.width ?? 200,
            height: props.height ?? 36,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            placeholderColor: props.placeholderColor ?? 0x999999,
            borderRadius: props.borderRadius ?? 4,
            fontSize: props.fontSize ?? 14,
            type: props.type ?? 'text'
        };
        this.onChange = props.onChange;
        this.currentValue = props.value ?? props.defaultValue ?? '';
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        this.textDisplay = new pixi_js_1.default.Text({
            text: this.getDisplayText(),
            style: {
                fontFamily: 'Arial',
                fontSize: this.props.fontSize,
                fill: this.currentValue ? this.props.textColor : this.props.placeholderColor,
                align: 'left'
            },
            resolution: window.devicePixelRatio || 2
        });
        this.textDisplay.position.set(12, (this.props.height - this.props.fontSize) / 2);
        this.container.addChild(this.textDisplay);
        this.cursor = new pixi_js_1.default.Graphics();
        this.cursor.visible = false;
        this.container.addChild(this.cursor);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (this.currentValue) {
            return this.currentValue;
        }
        return this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'text';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        if (typeof window !== 'undefined') {
            window.addEventListener('keydown', this.handleKeyDown.bind(this));
        }
    }
    handlePointerDown(e) {
        if (this.props.disabled)
            return;
        const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
        if (focusManager) {
            focusManager.requestFocus(this);
        }
        else {
            this.onFocus();
        }
        e.stopPropagation();
    }
    onFocus() {
        if (this.focused)
            return;
        super.onFocus();
        this.cursorPosition = this.currentValue.length;
        this.cursor.visible = true;
        this.updateCursor();
        this.startCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.lightenColor(this.props.backgroundColor, 0.95),
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    onBlur() {
        if (!this.focused)
            return;
        super.onBlur();
        this.cursor.visible = false;
        this.stopCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    handleKeyDown(e) {
        if (!this.focused || this.props.disabled)
            return;
        e.preventDefault();
        e.stopPropagation();
        const key = e.key;
        if (key === 'Enter') {
            this.onBlur();
            return;
        }
        if (key === 'Escape') {
            this.onBlur();
            return;
        }
        if (key === 'Backspace') {
            if (this.cursorPosition > 0) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition - 1) +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition--;
                this.updateText();
            }
            return;
        }
        if (key === 'Delete') {
            if (this.cursorPosition < this.currentValue.length) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        this.currentValue.substring(this.cursorPosition + 1);
                this.updateText();
            }
            return;
        }
        if (key === 'ArrowLeft') {
            if (this.cursorPosition > 0) {
                this.cursorPosition--;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowRight') {
            if (this.cursorPosition < this.currentValue.length) {
                this.cursorPosition++;
                this.updateCursor();
            }
            return;
        }
        if (key === 'Home') {
            this.cursorPosition = 0;
            this.updateCursor();
            return;
        }
        if (key === 'End') {
            this.cursorPosition = this.currentValue.length;
            this.updateCursor();
            return;
        }
        if (key.length === 1 && !e.ctrlKey && !e.metaKey) {
            if (this.props.type === 'number' && !/[0-9.-]/.test(key)) {
                return;
            }
            if (this.currentValue.length >= this.props.maxLength) {
                return;
            }
            this.currentValue =
                this.currentValue.substring(0, this.cursorPosition) +
                    key +
                    this.currentValue.substring(this.cursorPosition);
            this.cursorPosition++;
            this.updateText();
        }
    }
    updateText() {
        this.textDisplay.text = this.getDisplayText();
        this.textDisplay.style.fill = this.currentValue ? this.props.textColor : this.props.placeholderColor;
        this.updateCursor();
        this.onChange?.(this.currentValue);
    }
    updateCursor() {
        const textUpToCursor = this.currentValue.substring(0, this.cursorPosition);
        const tempText = new pixi_js_1.default.Text({
            text: textUpToCursor,
            style: this.textDisplay.style
        });
        const cursorX = 12 + tempText.width;
        const cursorY = (this.props.height - this.props.fontSize) / 2;
        this.cursor.clear();
        this.cursor.rect(cursorX, cursorY, 1, this.props.fontSize);
        this.cursor.fill({ color: this.props.textColor });
        tempText.destroy();
    }
    startCursorBlink() {
        this.stopCursorBlink();
        this.cursorVisible = true;
        this.cursorBlinkInterval = window.setInterval(() => {
            this.cursorVisible = !this.cursorVisible;
            this.cursor.visible = this.cursorVisible;
        }, 530);
    }
    stopCursorBlink() {
        if (this.cursorBlinkInterval) {
            window.clearInterval(this.cursorBlinkInterval);
            this.cursorBlinkInterval = undefined;
        }
    }
    lightenColor(color, factor) {
        const r = Math.min(255, ((color >> 16) & 0xff) / factor);
        const g = Math.min(255, ((color >> 8) & 0xff) / factor);
        const b = Math.min(255, (color & 0xff) / factor);
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.currentValue = value;
        this.cursorPosition = value.length;
        this.updateText();
    }
    getValue() {
        return this.currentValue;
    }
    destroy() {
        this.stopCursorBlink();
        if (typeof window !== 'undefined') {
            window.removeEventListener('keydown', this.handleKeyDown.bind(this));
        }
        super.destroy();
    }
}
exports.UITextInput = UITextInput;


/***/ }),

/***/ "./src/ui/components/ui-textarea.ts":
/*!******************************************!*\
  !*** ./src/ui/components/ui-textarea.ts ***!
  \******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITextArea = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
class UITextArea extends ui_component_1.UIComponent {
    props;
    onChange;
    currentValue;
    background;
    textDisplay;
    cursor;
    cursorPosition = 0;
    cursorBlinkInterval;
    cursorVisible = true;
    constructor(props, boxModel) {
        super(boxModel);
        const defaultHeight = (props.rows ?? 4) * (props.fontSize ?? 14) * (props.lineHeight ?? 1.5) + 24;
        this.props = {
            placeholder: props.placeholder ?? '',
            maxLength: props.maxLength ?? 1000,
            width: props.width ?? 400,
            height: props.height ?? defaultHeight,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            placeholderColor: props.placeholderColor ?? 0x999999,
            borderRadius: props.borderRadius ?? 4,
            fontSize: props.fontSize ?? 14,
            lineHeight: props.lineHeight ?? 1.5,
            rows: props.rows ?? 4
        };
        this.onChange = props.onChange;
        this.currentValue = props.value ?? props.defaultValue ?? '';
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        this.textDisplay = new pixi_js_1.default.Text({
            text: this.getDisplayText(),
            style: {
                fontFamily: 'Arial',
                fontSize: this.props.fontSize,
                fill: this.currentValue ? this.props.textColor : this.props.placeholderColor,
                align: 'left',
                wordWrap: true,
                wordWrapWidth: this.props.width - 24,
                lineHeight: this.props.fontSize * this.props.lineHeight
            },
            resolution: window.devicePixelRatio || 2
        });
        this.textDisplay.position.set(12, 12);
        this.container.addChild(this.textDisplay);
        this.cursor = new pixi_js_1.default.Graphics();
        this.cursor.visible = false;
        this.container.addChild(this.cursor);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (this.currentValue) {
            return this.currentValue;
        }
        return this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'text';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        if (typeof window !== 'undefined') {
            window.addEventListener('keydown', this.handleKeyDown.bind(this));
        }
    }
    handlePointerDown(e) {
        if (this.props.disabled)
            return;
        const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
        if (focusManager) {
            focusManager.requestFocus(this);
        }
        else {
            this.onFocus();
        }
        e.stopPropagation();
    }
    onFocus() {
        if (this.focused)
            return;
        super.onFocus();
        this.cursorPosition = this.currentValue.length;
        this.cursor.visible = true;
        this.updateCursor();
        this.startCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.lightenColor(this.props.backgroundColor, 0.95),
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    onBlur() {
        if (!this.focused)
            return;
        super.onBlur();
        this.cursor.visible = false;
        this.stopCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    handleKeyDown(e) {
        if (!this.focused || this.props.disabled)
            return;
        if (e.key !== 'Tab') {
            e.preventDefault();
            e.stopPropagation();
        }
        const key = e.key;
        if (key === 'Enter') {
            if (this.currentValue.length < this.props.maxLength) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        '\n' +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition++;
                this.updateText();
            }
            return;
        }
        if (key === 'Escape') {
            this.onBlur();
            return;
        }
        if (key === 'Backspace') {
            if (this.cursorPosition > 0) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition - 1) +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition--;
                this.updateText();
            }
            return;
        }
        if (key === 'Delete') {
            if (this.cursorPosition < this.currentValue.length) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        this.currentValue.substring(this.cursorPosition + 1);
                this.updateText();
            }
            return;
        }
        if (key === 'ArrowLeft') {
            if (this.cursorPosition > 0) {
                this.cursorPosition--;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowRight') {
            if (this.cursorPosition < this.currentValue.length) {
                this.cursorPosition++;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowUp') {
            this.moveCursorVertically(-1);
            return;
        }
        if (key === 'ArrowDown') {
            this.moveCursorVertically(1);
            return;
        }
        if (key === 'Home') {
            const lineStart = this.currentValue.lastIndexOf('\n', this.cursorPosition - 1) + 1;
            this.cursorPosition = lineStart;
            this.updateCursor();
            return;
        }
        if (key === 'End') {
            let lineEnd = this.currentValue.indexOf('\n', this.cursorPosition);
            if (lineEnd === -1)
                lineEnd = this.currentValue.length;
            this.cursorPosition = lineEnd;
            this.updateCursor();
            return;
        }
        if (key.length === 1 && !e.ctrlKey && !e.metaKey) {
            if (this.currentValue.length >= this.props.maxLength) {
                return;
            }
            this.currentValue =
                this.currentValue.substring(0, this.cursorPosition) +
                    key +
                    this.currentValue.substring(this.cursorPosition);
            this.cursorPosition++;
            this.updateText();
        }
    }
    moveCursorVertically(direction) {
        const lines = this.currentValue.split('\n');
        let currentLine = 0;
        let positionInLine = 0;
        let charCount = 0;
        for (let i = 0; i < lines.length; i++) {
            if (charCount + lines[i].length >= this.cursorPosition) {
                currentLine = i;
                positionInLine = this.cursorPosition - charCount;
                break;
            }
            charCount += lines[i].length + 1;
        }
        const targetLine = Math.max(0, Math.min(lines.length - 1, currentLine + direction));
        if (targetLine === currentLine)
            return;
        let newPosition = 0;
        for (let i = 0; i < targetLine; i++) {
            newPosition += lines[i].length + 1;
        }
        newPosition += Math.min(positionInLine, lines[targetLine].length);
        this.cursorPosition = newPosition;
        this.updateCursor();
    }
    updateText() {
        this.textDisplay.text = this.getDisplayText();
        this.textDisplay.style.fill = this.currentValue ? this.props.textColor : this.props.placeholderColor;
        this.updateCursor();
        this.onChange?.(this.currentValue);
    }
    updateCursor() {
        const textUpToCursor = this.currentValue.substring(0, this.cursorPosition);
        const tempText = new pixi_js_1.default.Text({
            text: textUpToCursor,
            style: {
                ...this.textDisplay.style,
                wordWrap: true,
                wordWrapWidth: this.props.width - 24
            }
        });
        const metrics = tempText.getLocalBounds();
        const lines = textUpToCursor.split('\n');
        const lastLine = lines[lines.length - 1];
        const lastLineText = new pixi_js_1.default.Text({
            text: lastLine,
            style: this.textDisplay.style
        });
        const cursorX = 12 + lastLineText.width;
        const cursorY = 12 + (lines.length - 1) * (this.props.fontSize * this.props.lineHeight);
        this.cursor.clear();
        this.cursor.rect(cursorX, cursorY, 1, this.props.fontSize);
        this.cursor.fill({ color: this.props.textColor });
        tempText.destroy();
        lastLineText.destroy();
    }
    startCursorBlink() {
        this.stopCursorBlink();
        this.cursorVisible = true;
        this.cursorBlinkInterval = window.setInterval(() => {
            this.cursorVisible = !this.cursorVisible;
            this.cursor.visible = this.cursorVisible;
        }, 530);
    }
    stopCursorBlink() {
        if (this.cursorBlinkInterval) {
            window.clearInterval(this.cursorBlinkInterval);
            this.cursorBlinkInterval = undefined;
        }
    }
    lightenColor(color, factor) {
        const r = Math.min(255, ((color >> 16) & 0xff) / factor);
        const g = Math.min(255, ((color >> 8) & 0xff) / factor);
        const b = Math.min(255, (color & 0xff) / factor);
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.currentValue = value;
        this.cursorPosition = value.length;
        this.updateText();
    }
    getValue() {
        return this.currentValue;
    }
    destroy() {
        this.stopCursorBlink();
        if (typeof window !== 'undefined') {
            window.removeEventListener('keydown', this.handleKeyDown.bind(this));
        }
        super.destroy();
    }
}
exports.UITextArea = UITextArea;


/***/ }),

/***/ "./src/ui/core/box-model.ts":
/*!**********************************!*\
  !*** ./src/ui/core/box-model.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createDefaultBoxModel = createDefaultBoxModel;
const edge_insets_1 = __webpack_require__(/*! ./edge-insets */ "./src/ui/core/edge-insets.ts");
function createDefaultBoxModel(overrides) {
    return {
        width: 'auto',
        height: 'auto',
        padding: edge_insets_1.EdgeInsets.zero(),
        margin: edge_insets_1.EdgeInsets.zero(),
        ...overrides
    };
}


/***/ }),

/***/ "./src/ui/core/edge-insets.ts":
/*!************************************!*\
  !*** ./src/ui/core/edge-insets.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.EdgeInsets = void 0;
class EdgeInsets {
    top;
    right;
    bottom;
    left;
    constructor(top, right, bottom, left) {
        this.top = top;
        this.right = right;
        this.bottom = bottom;
        this.left = left;
    }
    static all(value) {
        return new EdgeInsets(value, value, value, value);
    }
    static symmetric(vertical, horizontal) {
        return new EdgeInsets(vertical, horizontal, vertical, horizontal);
    }
    static only(edges) {
        return new EdgeInsets(edges.top ?? 0, edges.right ?? 0, edges.bottom ?? 0, edges.left ?? 0);
    }
    static zero() {
        return new EdgeInsets(0, 0, 0, 0);
    }
    get horizontal() {
        return this.left + this.right;
    }
    get vertical() {
        return this.top + this.bottom;
    }
    clone() {
        return new EdgeInsets(this.top, this.right, this.bottom, this.left);
    }
}
exports.EdgeInsets = EdgeInsets;


/***/ }),

/***/ "./src/ui/core/ui-component.ts":
/*!*************************************!*\
  !*** ./src/ui/core/ui-component.ts ***!
  \*************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIComponent = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const box_model_1 = __webpack_require__(/*! ./box-model */ "./src/ui/core/box-model.ts");
class UIComponent {
    container;
    boxModel;
    focusRing;
    computedLayout;
    parent;
    visible = true;
    enabled = true;
    layoutDirty = true;
    tabIndex = -1;
    focused = false;
    constructor(boxModel) {
        this.container = new pixi_js_1.default.Container();
        this.boxModel = (0, box_model_1.createDefaultBoxModel)(boxModel);
        this.computedLayout = {
            x: 0,
            y: 0,
            width: 0,
            height: 0,
            contentX: 0,
            contentY: 0,
            contentWidth: 0,
            contentHeight: 0
        };
        this.createFocusRing();
    }
    createFocusRing() {
        this.focusRing = new pixi_js_1.default.Graphics();
        this.focusRing.visible = false;
        this.container.addChildAt(this.focusRing, 0);
    }
    updateFocusRing() {
        if (!this.focusRing)
            return;
        this.focusRing.clear();
        const width = this.computedLayout.width;
        const height = this.computedLayout.height;
        if (width <= 0 || height <= 0)
            return;
        const offset = 4;
        const strokeWidth = 3;
        this.focusRing.roundRect(-offset - 2, -offset - 2, width + (offset + 2) * 2, height + (offset + 2) * 2, 8);
        this.focusRing.stroke({
            color: 0x00d9ff,
            width: strokeWidth + 2,
            alpha: 0.3
        });
        this.focusRing.roundRect(-offset, -offset, width + offset * 2, height + offset * 2, 8);
        this.focusRing.stroke({
            color: 0x00d9ff,
            width: strokeWidth
        });
        this.focusRing.roundRect(-offset + strokeWidth, -offset + strokeWidth, width + (offset - strokeWidth) * 2, height + (offset - strokeWidth) * 2, 6);
        this.focusRing.stroke({
            color: 0xffffff,
            width: 1,
            alpha: 0.6
        });
    }
    markLayoutDirty() {
        this.layoutDirty = true;
        if (this.parent) {
            this.parent.markLayoutDirty();
        }
    }
    getLayout() {
        return this.computedLayout;
    }
    getBoxModel() {
        return this.boxModel;
    }
    getGlobalBounds() {
        const globalPos = this.container.getGlobalPosition();
        return {
            x: globalPos.x,
            y: globalPos.y,
            width: this.computedLayout.width,
            height: this.computedLayout.height
        };
    }
    setPosition(x, y) {
        this.computedLayout.x = x;
        this.computedLayout.y = y;
        this.container.position.set(x, y);
    }
    show() {
        this.visible = true;
        this.container.visible = true;
    }
    hide() {
        this.visible = false;
        this.container.visible = false;
    }
    canFocus() {
        return this.enabled && this.visible && this.tabIndex >= 0;
    }
    isFocused() {
        return this.focused;
    }
    onFocus() {
        this.focused = true;
        this.showFocusRing();
        this.scrollIntoView();
    }
    showFocusRing() {
        if (this.focusRing) {
            this.updateFocusRing();
            this.focusRing.visible = true;
        }
    }
    scrollIntoView() {
        let currentParent = this.parent;
        while (currentParent) {
            if ('scrollToComponent' in currentParent && typeof currentParent.scrollToComponent === 'function') {
                currentParent.scrollToComponent(this);
                break;
            }
            currentParent = currentParent.parent;
        }
    }
    onBlur() {
        this.focused = false;
        this.hideFocusRing();
    }
    hideFocusRing() {
        if (this.focusRing) {
            this.focusRing.visible = false;
        }
    }
    destroy() {
        this.container.destroy({ children: true });
    }
}
exports.UIComponent = UIComponent;


/***/ }),

/***/ "./src/ui/core/ui-focus-manager.ts":
/*!*****************************************!*\
  !*** ./src/ui/core/ui-focus-manager.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIFocusManager = void 0;
class UIFocusManager {
    static instance = null;
    focusableComponents = [];
    currentFocusIndex = -1;
    keydownHandler = null;
    constructor() {
        this.setupKeyboardListeners();
        UIFocusManager.instance = this;
    }
    static getInstance() {
        return UIFocusManager.instance;
    }
    setupKeyboardListeners() {
        if (typeof window === 'undefined')
            return;
        if (this.keydownHandler) {
            window.removeEventListener('keydown', this.keydownHandler);
        }
        this.keydownHandler = (e) => {
            if (e.key === 'Tab') {
                e.preventDefault();
                if (e.shiftKey) {
                    this.focusPrevious();
                }
                else {
                    this.focusNext();
                }
            }
        };
        window.addEventListener('keydown', this.keydownHandler);
    }
    register(component) {
        if (!this.focusableComponents.includes(component)) {
            this.focusableComponents.push(component);
            this.sortByTabIndex();
        }
    }
    registerContainer(container) {
        this.discoverFocusableComponents(container);
        this.sortByTabIndex();
    }
    discoverFocusableComponents(component) {
        if (this.isFocusableComponent(component)) {
            this.register(component);
        }
        if ('children' in component && Array.isArray(component.children)) {
            const children = component.children;
            children.forEach(child => this.discoverFocusableComponents(child));
        }
    }
    isFocusableComponent(component) {
        return (typeof component.tabIndex === 'number' &&
            component.tabIndex >= 0 &&
            typeof component.canFocus === 'function' &&
            typeof component.onFocus === 'function' &&
            typeof component.onBlur === 'function' &&
            typeof component.isFocused === 'function');
    }
    unregister(component) {
        const index = this.focusableComponents.indexOf(component);
        if (index !== -1) {
            if (index === this.currentFocusIndex) {
                this.blur();
            }
            this.focusableComponents.splice(index, 1);
            if (this.currentFocusIndex > index) {
                this.currentFocusIndex--;
            }
        }
    }
    sortByTabIndex() {
        this.focusableComponents.sort((a, b) => a.tabIndex - b.tabIndex);
    }
    focus(component) {
        if (!component.canFocus()) {
            return;
        }
        const index = this.focusableComponents.indexOf(component);
        if (index === -1) {
            return;
        }
        if (this.currentFocusIndex !== -1 && this.currentFocusIndex !== index) {
            const current = this.focusableComponents[this.currentFocusIndex];
            if (current) {
                current.onBlur();
            }
        }
        this.currentFocusIndex = index;
        component.onFocus();
    }
    requestFocus(component) {
        this.focus(component);
    }
    blur() {
        if (this.currentFocusIndex !== -1) {
            const current = this.focusableComponents[this.currentFocusIndex];
            if (current) {
                current.onBlur();
            }
            this.currentFocusIndex = -1;
        }
    }
    focusNext() {
        if (this.focusableComponents.length === 0)
            return;
        let nextIndex = this.currentFocusIndex + 1;
        let attempts = 0;
        while (attempts < this.focusableComponents.length) {
            if (nextIndex >= this.focusableComponents.length) {
                nextIndex = 0;
            }
            const component = this.focusableComponents[nextIndex];
            if (component && component.canFocus()) {
                this.focus(component);
                return;
            }
            nextIndex++;
            attempts++;
        }
    }
    focusPrevious() {
        if (this.focusableComponents.length === 0)
            return;
        let prevIndex = this.currentFocusIndex - 1;
        let attempts = 0;
        while (attempts < this.focusableComponents.length) {
            if (prevIndex < 0) {
                prevIndex = this.focusableComponents.length - 1;
            }
            const component = this.focusableComponents[prevIndex];
            if (component && component.canFocus()) {
                this.focus(component);
                return;
            }
            prevIndex--;
            attempts++;
        }
    }
    focusFirst() {
        if (this.focusableComponents.length === 0)
            return;
        for (const component of this.focusableComponents) {
            if (component.canFocus()) {
                this.focus(component);
                return;
            }
        }
    }
    focusLast() {
        if (this.focusableComponents.length === 0)
            return;
        for (let i = this.focusableComponents.length - 1; i >= 0; i--) {
            const component = this.focusableComponents[i];
            if (component.canFocus()) {
                this.focus(component);
                return;
            }
        }
    }
    getCurrentFocus() {
        if (this.currentFocusIndex === -1)
            return null;
        return this.focusableComponents[this.currentFocusIndex] || null;
    }
    getFocusableComponents() {
        return [...this.focusableComponents];
    }
    clear() {
        this.blur();
        this.focusableComponents = [];
        this.currentFocusIndex = -1;
    }
    destroy() {
        if (typeof window !== 'undefined' && this.keydownHandler) {
            window.removeEventListener('keydown', this.keydownHandler);
        }
        this.clear();
    }
}
exports.UIFocusManager = UIFocusManager;


/***/ }),

/***/ "./src/ui/layout/flex-container.ts":
/*!*****************************************!*\
  !*** ./src/ui/layout/flex-container.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.FlexContainer = exports.FlexAlign = exports.FlexJustify = exports.FlexDirection = void 0;
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
var FlexDirection;
(function (FlexDirection) {
    FlexDirection["Row"] = "row";
    FlexDirection["RowReverse"] = "row-reverse";
    FlexDirection["Column"] = "column";
    FlexDirection["ColumnReverse"] = "column-reverse";
})(FlexDirection || (exports.FlexDirection = FlexDirection = {}));
var FlexJustify;
(function (FlexJustify) {
    FlexJustify["Start"] = "start";
    FlexJustify["End"] = "end";
    FlexJustify["Center"] = "center";
    FlexJustify["SpaceBetween"] = "space-between";
    FlexJustify["SpaceAround"] = "space-around";
    FlexJustify["SpaceEvenly"] = "space-evenly";
})(FlexJustify || (exports.FlexJustify = FlexJustify = {}));
var FlexAlign;
(function (FlexAlign) {
    FlexAlign["Start"] = "start";
    FlexAlign["End"] = "end";
    FlexAlign["Center"] = "center";
    FlexAlign["Stretch"] = "stretch";
})(FlexAlign || (exports.FlexAlign = FlexAlign = {}));
class FlexContainer extends ui_component_1.UIComponent {
    props;
    children = [];
    constructor(props = {}) {
        const boxModel = {
            padding: props.padding ?? edge_insets_1.EdgeInsets.zero(),
            width: props.width ?? 'auto',
            height: props.height ?? 'auto'
        };
        super(boxModel);
        this.props = {
            direction: props.direction ?? FlexDirection.Row,
            justify: props.justify ?? FlexJustify.Start,
            align: props.align ?? FlexAlign.Start,
            gap: props.gap ?? 0,
            wrap: props.wrap ?? false
        };
    }
    addChild(child) {
        child.parent = this;
        this.children.push(child);
        this.container.addChild(child.container);
        this.markLayoutDirty();
    }
    removeChild(child) {
        const index = this.children.indexOf(child);
        if (index !== -1) {
            this.children.splice(index, 1);
            this.container.removeChild(child.container);
            child.parent = undefined;
            this.markLayoutDirty();
        }
    }
    measure() {
        if (this.children.length === 0) {
            const padding = this.boxModel.padding;
            return {
                width: padding.horizontal,
                height: padding.vertical
            };
        }
        const childSizes = this.children.map(child => child.measure());
        const { direction, gap } = this.props;
        const padding = this.boxModel.padding;
        const isRow = direction === FlexDirection.Row || direction === FlexDirection.RowReverse;
        const totalGap = gap * (this.children.length - 1);
        let measuredWidth = 0;
        let measuredHeight = 0;
        if (isRow) {
            measuredWidth = childSizes.reduce((sum, size) => sum + size.width, 0) + totalGap;
            measuredHeight = Math.max(...childSizes.map(size => size.height));
        }
        else {
            measuredWidth = Math.max(...childSizes.map(size => size.width));
            measuredHeight = childSizes.reduce((sum, size) => sum + size.height, 0) + totalGap;
        }
        return {
            width: measuredWidth + padding.horizontal,
            height: measuredHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const padding = this.boxModel.padding;
        const { direction, justify, align, gap } = this.props;
        let containerWidth;
        let containerHeight;
        if (this.boxModel.width === 'fill') {
            containerWidth = availableWidth;
        }
        else if (typeof this.boxModel.width === 'number') {
            containerWidth = this.boxModel.width;
        }
        else {
            const measured = this.measure();
            containerWidth = measured.width;
        }
        if (this.boxModel.height === 'fill') {
            containerHeight = availableHeight;
        }
        else if (typeof this.boxModel.height === 'number') {
            containerHeight = this.boxModel.height;
        }
        else {
            const measured = this.measure();
            containerHeight = measured.height;
        }
        this.computedLayout.width = containerWidth;
        this.computedLayout.height = containerHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = containerWidth - padding.horizontal;
        this.computedLayout.contentHeight = containerHeight - padding.vertical;
        if (this.children.length > 0) {
            this.layoutChildren();
        }
        this.layoutDirty = false;
        this.render();
    }
    layoutChildren() {
        const { direction, justify, align, gap } = this.props;
        const padding = this.boxModel.padding;
        const contentWidth = this.computedLayout.contentWidth;
        const contentHeight = this.computedLayout.contentHeight;
        const isRow = direction === FlexDirection.Row || direction === FlexDirection.RowReverse;
        const childSizes = this.children.map(child => child.measure());
        const totalGap = gap * (this.children.length - 1);
        const totalChildSize = isRow
            ? childSizes.reduce((sum, size) => sum + size.width, 0)
            : childSizes.reduce((sum, size) => sum + size.height, 0);
        const mainAxisSize = isRow ? contentWidth : contentHeight;
        const crossAxisSize = isRow ? contentHeight : contentWidth;
        const freeSpace = mainAxisSize - totalChildSize - totalGap;
        let mainAxisOffset = 0;
        let spaceBetween = 0;
        switch (justify) {
            case FlexJustify.Start:
                mainAxisOffset = 0;
                break;
            case FlexJustify.End:
                mainAxisOffset = freeSpace;
                break;
            case FlexJustify.Center:
                mainAxisOffset = freeSpace / 2;
                break;
            case FlexJustify.SpaceBetween:
                spaceBetween = this.children.length > 1 ? freeSpace / (this.children.length - 1) : 0;
                break;
            case FlexJustify.SpaceAround:
                spaceBetween = freeSpace / this.children.length;
                mainAxisOffset = spaceBetween / 2;
                break;
            case FlexJustify.SpaceEvenly:
                spaceBetween = freeSpace / (this.children.length + 1);
                mainAxisOffset = spaceBetween;
                break;
        }
        let currentPosition = mainAxisOffset;
        this.children.forEach((child, index) => {
            const childSize = childSizes[index];
            child.layout(childSize.width, childSize.height);
            let crossAxisPosition = 0;
            switch (align) {
                case FlexAlign.Start:
                    crossAxisPosition = 0;
                    break;
                case FlexAlign.End:
                    crossAxisPosition = crossAxisSize - (isRow ? childSize.height : childSize.width);
                    break;
                case FlexAlign.Center:
                    crossAxisPosition = (crossAxisSize - (isRow ? childSize.height : childSize.width)) / 2;
                    break;
                case FlexAlign.Stretch:
                    crossAxisPosition = 0;
                    break;
            }
            if (isRow) {
                child.setPosition(padding.left + currentPosition, padding.top + crossAxisPosition);
                currentPosition += childSize.width + gap + spaceBetween;
            }
            else {
                child.setPosition(padding.left + crossAxisPosition, padding.top + currentPosition);
                currentPosition += childSize.height + gap + spaceBetween;
            }
        });
    }
    render() {
    }
}
exports.FlexContainer = FlexContainer;


/***/ }),

/***/ "./src/ui/pixel-grid.ts":
/*!******************************!*\
  !*** ./src/ui/pixel-grid.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.BORDER = exports.GRID = exports.units = exports.px = exports.DEFAULT_PIXEL_GRID = exports.PixelGrid = void 0;
exports.createBorderConfig = createBorderConfig;
class PixelGrid {
    unit;
    scale;
    border;
    padding;
    gap;
    margin;
    fontScale;
    constructor(config = {}) {
        this.unit = config.unit ?? 1;
        this.scale = config.scale ?? 4;
        this.border = config.border ?? 1;
        this.padding = config.padding ?? 1;
        this.gap = config.gap ?? 1;
        this.margin = config.margin ?? 5;
        this.fontScale = config.fontScale ?? (this.scale / 16);
    }
    px(units) {
        return units * this.unit * this.scale;
    }
    units(pixels) {
        return Math.round(pixels / (this.unit * this.scale));
    }
}
exports.PixelGrid = PixelGrid;
exports.DEFAULT_PIXEL_GRID = (() => {
    const tempScale = typeof localStorage !== 'undefined'
        ? localStorage.getItem('temp-grid-scale')
        : null;
    if (tempScale) {
        const scale = parseInt(tempScale, 10);
        if (!isNaN(scale) && scale >= 1 && scale <= 4) {
            return new PixelGrid({ scale });
        }
    }
    return new PixelGrid();
})();
const px = (units) => exports.DEFAULT_PIXEL_GRID.px(units);
exports.px = px;
const units = (pixels) => exports.DEFAULT_PIXEL_GRID.units(pixels);
exports.units = units;
exports.GRID = {
    unit: exports.DEFAULT_PIXEL_GRID.unit,
    scale: exports.DEFAULT_PIXEL_GRID.scale,
    border: exports.DEFAULT_PIXEL_GRID.border,
    padding: exports.DEFAULT_PIXEL_GRID.padding,
    gap: exports.DEFAULT_PIXEL_GRID.gap,
    margin: exports.DEFAULT_PIXEL_GRID.margin,
    fontScale: exports.DEFAULT_PIXEL_GRID.fontScale
};
exports.BORDER = {
    outer: 1,
    middle: 1,
    inner: 1,
    total: 3
};
function createBorderConfig(config = {}) {
    const outer = config.outer ?? 1;
    const middle = config.middle ?? 1;
    const inner = config.inner ?? 1;
    const total = outer + middle + inner;
    return {
        outer,
        middle,
        inner,
        total
    };
}


/***/ }),

/***/ "pixi.js":
/*!*******************************************************************************************!*\
  !*** external {"commonjs":"pixi.js","commonjs2":"pixi.js","amd":"pixi.js","root":"PIXI"} ***!
  \*******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_pixi_js__;

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.ts");
/******/ 	
/******/ 	return __webpack_exports__;
/******/ })()
;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixXQUFXO0FBQ3JDO0FBQ0EsZ0NBQWdDLFdBQVc7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsOEJBQThCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixlQUFlO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Ysa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnQkFBZ0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsR0FBRztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsUUFBUTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLEdBQUc7QUFDNUMsMEJBQTBCLG9CQUFvQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxHQUFHO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLDJDQUEyQyxHQUFHO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLEdBQUc7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsR0FBRztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxHQUFHO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLElBQUk7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGVBQWU7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixlQUFlO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLDBEQUEwRDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyx3REFBd0Q7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNkJBQTZCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNkJBQTZCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLElBQUk7QUFDNUM7QUFDQTtBQUNBLDRDQUE0QyxLQUFLO0FBQ2pEO0FBQ0E7QUFDQSx3Q0FBd0MsR0FBRztBQUMzQztBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsTUFBTTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxJQUFJO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxJQUFJO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNEJBQTRCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw0QkFBNEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNEJBQTRCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkJBQTZCO0FBQ3JELDBCQUEwQiwwQkFBMEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw0QkFBNEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkJBQTZCO0FBQ3JEO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBCQUEwQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDBCQUEwQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsSUFBSTtBQUM5QztBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsbUJBQW1CO0FBQzdDO0FBQ0E7QUFDQSxnREFBZ0QsSUFBSTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxJQUFJO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDRCQUE0QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0NBQWdDO0FBQ3hEO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDRCQUE0QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0NBQWdDO0FBQ3hELDBCQUEwQiw0QkFBNEI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsOEJBQThCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxzREFBc0Q7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsa0VBQWtFO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsa0RBQWtEO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIscUJBQXFCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixxQkFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esb0JBQW9CLDBCQUEwQjtBQUM5QztBQUNBO0FBQ0Esc0JBQXNCLDBCQUEwQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsMEJBQTBCO0FBQzlDO0FBQ0E7QUFDQSxzQkFBc0IsMEJBQTBCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxpQkFBaUI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxnQkFBZ0I7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3Q0FBd0M7QUFDaEU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixnQ0FBZ0M7QUFDMUQ7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDRCQUE0QjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHVCQUF1QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxJQUFJO0FBQzlDO0FBQ0E7QUFDQSwwQ0FBMEMsR0FBRztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxRQUFRO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFFBQVE7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxJQUFJO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsTUFBTTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLElBQUk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsR0FBRztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQixVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsTUFBTTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsSUFBSTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNCQUFzQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBCQUEwQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixxQkFBcUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBLHdCQUF3QiwyQkFBMkI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixRQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsT0FBTztBQUMvQjtBQUNBO0FBQ0Esd0JBQXdCLE9BQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGtCQUFrQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsa0JBQWtCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixXQUFXO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsb0NBQW9DO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLG9DQUFvQztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLGdDQUFnQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msb0JBQW9CO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsWUFBWTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDBCQUEwQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLGdDQUFnQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnQ0FBZ0M7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUNBQXlDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzQkFBc0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHFCQUFxQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IscUJBQXFCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixxQkFBcUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isd0NBQXdDO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlCQUFpQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlCQUF5QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMEJBQTBCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyx3QkFBd0IsaUJBQWlCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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SUFDbkMsR0FBRyxFQUFFLDBCQUFrQixDQUFDLEdBQUc7SUFDM0IsTUFBTSxFQUFFLDBCQUFrQixDQUFDLE1BQU07SUFDakMsU0FBUyxFQUFFLDBCQUFrQixDQUFDLFNBQVM7Q0FDL0IsQ0FBQztBQUdFLGNBQU0sR0FBRztJQUNwQixLQUFLLEVBQUUsQ0FBQztJQUNSLE1BQU0sRUFBRSxDQUFDO0lBQ1QsS0FBSyxFQUFFLENBQUM7SUFDUixLQUFLLEVBQUUsQ0FBQztDQUNBLENBQUM7QUFHWCxTQUFnQixrQkFBa0IsQ0FBQyxTQUF1QixFQUFFO0lBQzFELE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDO0lBQ2hDLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLElBQUksQ0FBQyxDQUFDO0lBQ2xDLE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDO0lBQ2hDLE1BQU0sS0FBSyxHQUFHLEtBQUssR0FBRyxNQUFNLEdBQUcsS0FBSyxDQUFDO0lBRXJDLE9BQU87UUFDTCxLQUFLO1FBQ0wsTUFBTTtRQUNOLEtBQUs7UUFDTCxLQUFLO0tBQ04sQ0FBQztBQUNKLENBQUM7Ozs7Ozs7Ozs7OztBQzFJRCxxRDs7Ozs7O1VDQUE7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTs7VUFFQTtVQUNBOztVQUVBO1VBQ0E7VUFDQTs7OztVRXRCQTtVQUNBO1VBQ0E7VUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL21veGkvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL21veGkvLi4vLi4vbm9kZV9tb2R1bGVzL2ZvbnRmYWNlb2JzZXJ2ZXIvZm9udGZhY2VvYnNlcnZlci5zdGFuZGFsb25lLmpzIiwid2VicGFjazovL21veGkvLi4vLi4vbm9kZV9tb2R1bGVzL3BsYW5jay9kaXN0L3BsYW5jay5qcyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvYXNzZXQtbG9hZGVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9jYW1lcmEudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9jb3JlL2VuZ2luZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvZXZlbnQtc3lzdGVtLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9sb2dpYy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvbW94aS1lbnRpdHkudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9jb3JlL3JlbmRlci1tYW5hZ2VyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9zY2VuZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9hcy1waXhpLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9jbGllbnQtZXZlbnRzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9mYWxsaW5nLXNxdWFyZXMtYW5pbWF0aW9uLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9mb250LWxvYWRlci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvZ3JpZC1nZW5lcmF0b3IudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L2xvYWRpbmctc2NlbmUudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BhcmFsbGF4LWJhY2tncm91bmQudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BhcmFsbGF4LWxheWVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL2luZGV4LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3MtYm9keS1sb2dpYy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGh5c2ljcy9waHlzaWNzLWNvbGxpc2lvbi50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGh5c2ljcy9waHlzaWNzLWRlYnVnLXJlbmRlcmVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3MtZ3JhcGhpY3MtcGFyc2VyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3MtbWF0ZXJpYWxzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3MtdXRpbHMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BoeXNpY3MvcGh5c2ljcy13b3JsZC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcmVzaXplLWhhbmRsZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3NldHVwLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9zdGF0ZS1sb2dpYy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvc3RhdGUtbWFjaGluZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvc3ZnLXV0aWxzL3N2Zy10by10ZXh0dXJlLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS90ZXh0dXJlLWZyYW1lLXNlcXVlbmNlcy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvdGV4dHVyZS1mcmFtZXMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3V0aWxzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvVUlMYXllci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL1VJU2NhbGVNb2RlLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy9idXR0b24tYmFja2dyb3VuZC1zdHJhdGVneS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktYm94LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS1idXR0b24udHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL3VpLWxhYmVsLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS1wYW5lbC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktc2Nyb2xsLWNvbnRhaW5lci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktc2VsZWN0LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS10YWJzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS10ZXh0LWlucHV0LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS10ZXh0YXJlYS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvcmUvYm94LW1vZGVsLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29yZS9lZGdlLWluc2V0cy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvcmUvdWktY29tcG9uZW50LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29yZS91aS1mb2N1cy1tYW5hZ2VyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvbGF5b3V0L2ZsZXgtY29udGFpbmVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvcGl4ZWwtZ3JpZC50cyIsIndlYnBhY2s6Ly9tb3hpL2V4dGVybmFsIHVtZCB7XCJjb21tb25qc1wiOlwicGl4aS5qc1wiLFwiY29tbW9uanMyXCI6XCJwaXhpLmpzXCIsXCJhbWRcIjpcInBpeGkuanNcIixcInJvb3RcIjpcIlBJWElcIn0iLCJ3ZWJwYWNrOi8vbW94aS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9tb3hpL3dlYnBhY2svYmVmb3JlLXN0YXJ0dXAiLCJ3ZWJwYWNrOi8vbW94aS93ZWJwYWNrL3N0YXJ0dXAiLCJ3ZWJwYWNrOi8vbW94aS93ZWJwYWNrL2FmdGVyLXN0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwicGl4aS5qc1wiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXCJwaXhpLmpzXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcIm1veGlcIl0gPSBmYWN0b3J5KHJlcXVpcmUoXCJwaXhpLmpzXCIpKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJtb3hpXCJdID0gZmFjdG9yeShyb290W1wiUElYSVwiXSk7XG59KShzZWxmLCAoX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9waXhpX2pzX18pID0+IHtcbnJldHVybiAiLCIvKiBGb250IEZhY2UgT2JzZXJ2ZXIgdjIuMy4wIC0gwqkgQnJhbSBTdGVpbi4gTGljZW5zZTogQlNELTMtQ2xhdXNlICovKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcChhLGMpe2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXI/YS5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsYywhMSk6YS5hdHRhY2hFdmVudChcInNjcm9sbFwiLGMpfWZ1bmN0aW9uIHUoYSl7ZG9jdW1lbnQuYm9keT9hKCk6ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcj9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGZ1bmN0aW9uIGIoKXtkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGIpO2EoKX0pOmRvY3VtZW50LmF0dGFjaEV2ZW50KFwib25yZWFkeXN0YXRlY2hhbmdlXCIsZnVuY3Rpb24gZygpe2lmKFwiaW50ZXJhY3RpdmVcIj09ZG9jdW1lbnQucmVhZHlTdGF0ZXx8XCJjb21wbGV0ZVwiPT1kb2N1bWVudC5yZWFkeVN0YXRlKWRvY3VtZW50LmRldGFjaEV2ZW50KFwib25yZWFkeXN0YXRlY2hhbmdlXCIsZyksYSgpfSl9O2Z1bmN0aW9uIHcoYSl7dGhpcy5nPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dGhpcy5nLnNldEF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIsXCJ0cnVlXCIpO3RoaXMuZy5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShhKSk7dGhpcy5oPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO3RoaXMuaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTt0aGlzLm09ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7dGhpcy5qPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO3RoaXMubD0tMTt0aGlzLmguc3R5bGUuY3NzVGV4dD1cIm1heC13aWR0aDpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7b3ZlcmZsb3c6c2Nyb2xsO2ZvbnQtc2l6ZToxNnB4O1wiO3RoaXMuaS5zdHlsZS5jc3NUZXh0PVwibWF4LXdpZHRoOm5vbmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7cG9zaXRpb246YWJzb2x1dGU7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTtvdmVyZmxvdzpzY3JvbGw7Zm9udC1zaXplOjE2cHg7XCI7XG50aGlzLmouc3R5bGUuY3NzVGV4dD1cIm1heC13aWR0aDpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7b3ZlcmZsb3c6c2Nyb2xsO2ZvbnQtc2l6ZToxNnB4O1wiO3RoaXMubS5zdHlsZS5jc3NUZXh0PVwiZGlzcGxheTppbmxpbmUtYmxvY2s7d2lkdGg6MjAwJTtoZWlnaHQ6MjAwJTtmb250LXNpemU6MTZweDttYXgtd2lkdGg6bm9uZTtcIjt0aGlzLmguYXBwZW5kQ2hpbGQodGhpcy5tKTt0aGlzLmkuYXBwZW5kQ2hpbGQodGhpcy5qKTt0aGlzLmcuYXBwZW5kQ2hpbGQodGhpcy5oKTt0aGlzLmcuYXBwZW5kQ2hpbGQodGhpcy5pKX1cbmZ1bmN0aW9uIHgoYSxjKXthLmcuc3R5bGUuY3NzVGV4dD1cIm1heC13aWR0aDpub25lO21pbi13aWR0aDoyMHB4O21pbi1oZWlnaHQ6MjBweDtkaXNwbGF5OmlubGluZS1ibG9jaztvdmVyZmxvdzpoaWRkZW47cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6YXV0bzttYXJnaW46MDtwYWRkaW5nOjA7dG9wOi05OTlweDt3aGl0ZS1zcGFjZTpub3dyYXA7Zm9udC1zeW50aGVzaXM6bm9uZTtmb250OlwiK2MrXCI7XCJ9ZnVuY3Rpb24gQihhKXt2YXIgYz1hLmcub2Zmc2V0V2lkdGgsYj1jKzEwMDthLmouc3R5bGUud2lkdGg9YitcInB4XCI7YS5pLnNjcm9sbExlZnQ9YjthLmguc2Nyb2xsTGVmdD1hLmguc2Nyb2xsV2lkdGgrMTAwO3JldHVybiBhLmwhPT1jPyhhLmw9YywhMCk6ITF9ZnVuY3Rpb24gQyhhLGMpe2Z1bmN0aW9uIGIoKXt2YXIgZT1nO0IoZSkmJm51bGwhPT1lLmcucGFyZW50Tm9kZSYmYyhlLmwpfXZhciBnPWE7cChhLmgsYik7cChhLmksYik7QihhKX07ZnVuY3Rpb24gRChhLGMsYil7Yz1jfHx7fTtiPWJ8fHdpbmRvdzt0aGlzLmZhbWlseT1hO3RoaXMuc3R5bGU9Yy5zdHlsZXx8XCJub3JtYWxcIjt0aGlzLndlaWdodD1jLndlaWdodHx8XCJub3JtYWxcIjt0aGlzLnN0cmV0Y2g9Yy5zdHJldGNofHxcIm5vcm1hbFwiO3RoaXMuY29udGV4dD1ifXZhciBFPW51bGwsRj1udWxsLEc9bnVsbCxIPW51bGw7ZnVuY3Rpb24gSShhKXtudWxsPT09RiYmKE0oYSkmJi9BcHBsZS8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnZlbmRvcik/KGE9L0FwcGxlV2ViS2l0XFwvKFswLTldKykoPzpcXC4oWzAtOV0rKSkoPzpcXC4oWzAtOV0rKSkvLmV4ZWMod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpLEY9ISFhJiY2MDM+cGFyc2VJbnQoYVsxXSwxMCkpOkY9ITEpO3JldHVybiBGfWZ1bmN0aW9uIE0oYSl7bnVsbD09PUgmJihIPSEhYS5kb2N1bWVudC5mb250cyk7cmV0dXJuIEh9XG5mdW5jdGlvbiBOKGEsYyl7dmFyIGI9YS5zdHlsZSxnPWEud2VpZ2h0O2lmKG51bGw9PT1HKXt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RyeXtlLnN0eWxlLmZvbnQ9XCJjb25kZW5zZWQgMTAwcHggc2Fucy1zZXJpZlwifWNhdGNoKHEpe31HPVwiXCIhPT1lLnN0eWxlLmZvbnR9cmV0dXJuW2IsZyxHP2Euc3RyZXRjaDpcIlwiLFwiMTAwcHhcIixjXS5qb2luKFwiIFwiKX1cbkQucHJvdG90eXBlLmxvYWQ9ZnVuY3Rpb24oYSxjKXt2YXIgYj10aGlzLGc9YXx8XCJCRVNic3d5XCIsZT0wLHE9Y3x8M0UzLEo9KG5ldyBEYXRlKS5nZXRUaW1lKCk7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKEssTCl7aWYoTShiLmNvbnRleHQpJiYhSShiLmNvbnRleHQpKXt2YXIgTz1uZXcgUHJvbWlzZShmdW5jdGlvbihyLHQpe2Z1bmN0aW9uIGgoKXsobmV3IERhdGUpLmdldFRpbWUoKS1KPj1xP3QoRXJyb3IoXCJcIitxK1wibXMgdGltZW91dCBleGNlZWRlZFwiKSk6Yi5jb250ZXh0LmRvY3VtZW50LmZvbnRzLmxvYWQoTihiLCdcIicrYi5mYW1pbHkrJ1wiJyksZykudGhlbihmdW5jdGlvbihuKXsxPD1uLmxlbmd0aD9yKCk6c2V0VGltZW91dChoLDI1KX0sdCl9aCgpfSksUD1uZXcgUHJvbWlzZShmdW5jdGlvbihyLHQpe2U9c2V0VGltZW91dChmdW5jdGlvbigpe3QoRXJyb3IoXCJcIitxK1wibXMgdGltZW91dCBleGNlZWRlZFwiKSl9LHEpfSk7UHJvbWlzZS5yYWNlKFtQLE9dKS50aGVuKGZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KGUpO1xuSyhiKX0sTCl9ZWxzZSB1KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcigpe3ZhciBkO2lmKGQ9LTEhPWsmJi0xIT1sfHwtMSE9ayYmLTEhPW18fC0xIT1sJiYtMSE9bSkoZD1rIT1sJiZrIT1tJiZsIT1tKXx8KG51bGw9PT1FJiYoZD0vQXBwbGVXZWJLaXRcXC8oWzAtOV0rKSg/OlxcLihbMC05XSspKS8uZXhlYyh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCksRT0hIWQmJig1MzY+cGFyc2VJbnQoZFsxXSwxMCl8fDUzNj09PXBhcnNlSW50KGRbMV0sMTApJiYxMT49cGFyc2VJbnQoZFsyXSwxMCkpKSxkPUUmJihrPT15JiZsPT15JiZtPT15fHxrPT16JiZsPT16JiZtPT16fHxrPT1BJiZsPT1BJiZtPT1BKSksZD0hZDtkJiYobnVsbCE9PWYucGFyZW50Tm9kZSYmZi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGYpLGNsZWFyVGltZW91dChlKSxLKGIpKX1mdW5jdGlvbiB0KCl7aWYoKG5ldyBEYXRlKS5nZXRUaW1lKCktSj49cSludWxsIT09Zi5wYXJlbnROb2RlJiZmLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZiksXG5MKEVycm9yKFwiXCIrcStcIm1zIHRpbWVvdXQgZXhjZWVkZWRcIikpO2Vsc2V7dmFyIGQ9Yi5jb250ZXh0LmRvY3VtZW50LmhpZGRlbjtpZighMD09PWR8fHZvaWQgMD09PWQpaz1oLmcub2Zmc2V0V2lkdGgsbD1uLmcub2Zmc2V0V2lkdGgsbT12Lmcub2Zmc2V0V2lkdGgscigpO2U9c2V0VGltZW91dCh0LDUwKX19dmFyIGg9bmV3IHcoZyksbj1uZXcgdyhnKSx2PW5ldyB3KGcpLGs9LTEsbD0tMSxtPS0xLHk9LTEsej0tMSxBPS0xLGY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtmLmRpcj1cImx0clwiO3goaCxOKGIsXCJzYW5zLXNlcmlmXCIpKTt4KG4sTihiLFwic2VyaWZcIikpO3godixOKGIsXCJtb25vc3BhY2VcIikpO2YuYXBwZW5kQ2hpbGQoaC5nKTtmLmFwcGVuZENoaWxkKG4uZyk7Zi5hcHBlbmRDaGlsZCh2LmcpO2IuY29udGV4dC5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGYpO3k9aC5nLm9mZnNldFdpZHRoO3o9bi5nLm9mZnNldFdpZHRoO0E9di5nLm9mZnNldFdpZHRoO3QoKTtcbkMoaCxmdW5jdGlvbihkKXtrPWQ7cigpfSk7eChoLE4oYiwnXCInK2IuZmFtaWx5KydcIixzYW5zLXNlcmlmJykpO0MobixmdW5jdGlvbihkKXtsPWQ7cigpfSk7eChuLE4oYiwnXCInK2IuZmFtaWx5KydcIixzZXJpZicpKTtDKHYsZnVuY3Rpb24oZCl7bT1kO3IoKX0pO3godixOKGIsJ1wiJytiLmZhbWlseSsnXCIsbW9ub3NwYWNlJykpfSl9KX07XCJvYmplY3RcIj09PXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9RDood2luZG93LkZvbnRGYWNlT2JzZXJ2ZXI9RCx3aW5kb3cuRm9udEZhY2VPYnNlcnZlci5wcm90b3R5cGUubG9hZD1ELnByb3RvdHlwZS5sb2FkKTt9KCkpO1xuIiwiKGZ1bmN0aW9uKGdsb2JhbCwgZmFjdG9yeSkge1xuICB0eXBlb2YgZXhwb3J0cyA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlICE9PSBcInVuZGVmaW5lZFwiID8gZmFjdG9yeShleHBvcnRzKSA6IHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKFtcImV4cG9ydHNcIl0sIGZhY3RvcnkpIDogKGdsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsVGhpcyA6IGdsb2JhbCB8fCBzZWxmLCBmYWN0b3J5KGdsb2JhbC5wbGFuY2sgPSB7fSkpO1xufSkodGhpcywgZnVuY3Rpb24oZXhwb3J0czIpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7LyoqXG4gKiBQbGFuY2suanMgdjEuNC4yXG4gKiBAbGljZW5zZSBUaGUgTUlUIGxpY2Vuc2VcbiAqIEBjb3B5cmlnaHQgQ29weXJpZ2h0IChjKSAyMDI1IEVyaW4gQ2F0dG8sIEFsaSBTaGFraWJhXG4gKlxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICpcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXG4gKiBTT0ZUV0FSRS5cbiAqL1xuXG4gIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXG4gIFxuICAgICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XG4gICAgICBwdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXG4gIFxuICAgICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxuICAgICAgUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXG4gICAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXG4gICAgICBJTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cbiAgICAgIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXG4gICAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXG4gICAgICBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxuICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cbiAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkMiwgYjIpIHtcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24oZDMsIGIzKSB7XG4gICAgICBkMy5fX3Byb3RvX18gPSBiMztcbiAgICB9IHx8IGZ1bmN0aW9uKGQzLCBiMykge1xuICAgICAgZm9yICh2YXIgcCBpbiBiMykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiMywgcCkpIGQzW3BdID0gYjNbcF07XG4gICAgfTtcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkMiwgYjIpO1xuICB9O1xuICBmdW5jdGlvbiBfX2V4dGVuZHMoZDIsIGIyKSB7XG4gICAgaWYgKHR5cGVvZiBiMiAhPT0gXCJmdW5jdGlvblwiICYmIGIyICE9PSBudWxsKVxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYjIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICBleHRlbmRTdGF0aWNzKGQyLCBiMik7XG4gICAgZnVuY3Rpb24gX18oKSB7XG4gICAgICB0aGlzLmNvbnN0cnVjdG9yID0gZDI7XG4gICAgfVxuICAgIGQyLnByb3RvdHlwZSA9IGIyID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiMikgOiAoX18ucHJvdG90eXBlID0gYjIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gIH1cbiAgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduMih0KSB7XG4gICAgICBmb3IgKHZhciBzMiwgaSA9IDEsIG4yID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG4yOyBpKyspIHtcbiAgICAgICAgczIgPSBhcmd1bWVudHNbaV07XG4gICAgICAgIGZvciAodmFyIHAgaW4gczIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoczIsIHApKSB0W3BdID0gczJbcF07XG4gICAgICB9XG4gICAgICByZXR1cm4gdDtcbiAgICB9O1xuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuICB2YXIgb3B0aW9ucyA9IGZ1bmN0aW9uKGlucHV0MiwgZGVmYXVsdHMpIHtcbiAgICBpZiAoaW5wdXQyID09PSBudWxsIHx8IHR5cGVvZiBpbnB1dDIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGlucHV0MiA9IHt9O1xuICAgIH1cbiAgICB2YXIgb3V0cHV0MiA9IF9fYXNzaWduKHt9LCBpbnB1dDIpO1xuICAgIGZvciAodmFyIGtleSBpbiBkZWZhdWx0cykge1xuICAgICAgaWYgKGRlZmF1bHRzLmhhc093blByb3BlcnR5KGtleSkgJiYgdHlwZW9mIGlucHV0MltrZXldID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIG91dHB1dDJba2V5XSA9IGRlZmF1bHRzW2tleV07XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZGVmYXVsdHMpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzeW1ib2xzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzW2ldO1xuICAgICAgICBpZiAoZGVmYXVsdHMucHJvcGVydHlJc0VudW1lcmFibGUoc3ltYm9sKSAmJiB0eXBlb2YgaW5wdXQyW3N5bWJvbF0gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICBvdXRwdXQyW3N5bWJvbF0gPSBkZWZhdWx0c1tzeW1ib2xdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQyO1xuICB9O1xuICB2YXIgbWF0aF9yYW5kb20gPSBNYXRoLnJhbmRvbTtcbiAgdmFyIEVQU0lMT04gPSAxZS05O1xuICB2YXIgaXNGaW5pdGUgPSBOdW1iZXIuaXNGaW5pdGU7XG4gIGZ1bmN0aW9uIG5leHRQb3dlck9mVHdvKHgyKSB7XG4gICAgeDIgfD0geDIgPj4gMTtcbiAgICB4MiB8PSB4MiA+PiAyO1xuICAgIHgyIHw9IHgyID4+IDQ7XG4gICAgeDIgfD0geDIgPj4gODtcbiAgICB4MiB8PSB4MiA+PiAxNjtcbiAgICByZXR1cm4geDIgKyAxO1xuICB9XG4gIGZ1bmN0aW9uIGlzUG93ZXJPZlR3byh4Mikge1xuICAgIHJldHVybiB4MiA+IDAgJiYgKHgyICYgeDIgLSAxKSA9PT0gMDtcbiAgfVxuICBmdW5jdGlvbiBtb2QobnVtLCBtaW4sIG1heCkge1xuICAgIGlmICh0eXBlb2YgbWluID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBtYXggPSAxO1xuICAgICAgbWluID0gMDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBtYXggPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIG1heCA9IG1pbjtcbiAgICAgIG1pbiA9IDA7XG4gICAgfVxuICAgIGlmIChtYXggPiBtaW4pIHtcbiAgICAgIG51bSA9IChudW0gLSBtaW4pICUgKG1heCAtIG1pbik7XG4gICAgICByZXR1cm4gbnVtICsgKG51bSA8IDAgPyBtYXggOiBtaW4pO1xuICAgIH0gZWxzZSB7XG4gICAgICBudW0gPSAobnVtIC0gbWF4KSAlIChtaW4gLSBtYXgpO1xuICAgICAgcmV0dXJuIG51bSArIChudW0gPD0gMCA/IG1pbiA6IG1heCk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGNsYW1wKG51bSwgbWluLCBtYXgpIHtcbiAgICBpZiAobnVtIDwgbWluKSB7XG4gICAgICByZXR1cm4gbWluO1xuICAgIH0gZWxzZSBpZiAobnVtID4gbWF4KSB7XG4gICAgICByZXR1cm4gbWF4O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbnVtO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiByYW5kb20obWluLCBtYXgpIHtcbiAgICBpZiAodHlwZW9mIG1pbiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgbWF4ID0gMTtcbiAgICAgIG1pbiA9IDA7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbWF4ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBtYXggPSBtaW47XG4gICAgICBtaW4gPSAwO1xuICAgIH1cbiAgICByZXR1cm4gbWluID09PSBtYXggPyBtaW4gOiBtYXRoX3JhbmRvbSgpICogKG1heCAtIG1pbikgKyBtaW47XG4gIH1cbiAgdmFyIG1hdGggPSBPYmplY3QuY3JlYXRlKE1hdGgpO1xuICBtYXRoLkVQU0lMT04gPSBFUFNJTE9OO1xuICBtYXRoLmlzRmluaXRlID0gaXNGaW5pdGU7XG4gIG1hdGgubmV4dFBvd2VyT2ZUd28gPSBuZXh0UG93ZXJPZlR3bztcbiAgbWF0aC5pc1Bvd2VyT2ZUd28gPSBpc1Bvd2VyT2ZUd287XG4gIG1hdGgubW9kID0gbW9kO1xuICBtYXRoLmNsYW1wID0gY2xhbXA7XG4gIG1hdGgucmFuZG9tID0gcmFuZG9tO1xuICB2YXIgbWF0aF9hYnMkOSA9IE1hdGguYWJzO1xuICB2YXIgbWF0aF9zcXJ0JDUgPSBNYXRoLnNxcnQ7XG4gIHZhciBtYXRoX21heCQ4ID0gTWF0aC5tYXg7XG4gIHZhciBtYXRoX21pbiQ4ID0gTWF0aC5taW47XG4gIHZhciBWZWMyID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFZlYzIyKHgyLCB5KSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBWZWMyMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFZlYzIyKHgyLCB5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHgyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgdGhpcy54ID0gMDtcbiAgICAgICAgICB0aGlzLnkgPSAwO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB4MiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMueCA9IHgyLng7XG4gICAgICAgICAgdGhpcy55ID0geDIueTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnggPSB4MjtcbiAgICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBWZWMyMi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHg6IHRoaXMueCxcbiAgICAgICAgICB5OiB0aGlzLnlcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFZlYzIyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai54ID0gZGF0YS54O1xuICAgICAgICBvYmoueSA9IGRhdGEueTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBWZWMyMi56ZXJvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFZlYzIyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai54ID0gMDtcbiAgICAgICAgb2JqLnkgPSAwO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLm5lbyA9IGZ1bmN0aW9uKHgyLCB5KSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFZlYzIyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai54ID0geDI7XG4gICAgICAgIG9iai55ID0geTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBWZWMyMi5jbG9uZSA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8odjMueCwgdjMueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5pc1ZhbGlkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKG9iai54KSAmJiBOdW1iZXIuaXNGaW5pdGUob2JqLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmFzc2VydCA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLmNsb25lKHRoaXMpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zZXRaZXJvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMueCA9IDA7XG4gICAgICAgIHRoaXMueSA9IDA7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih4MiwgeSkge1xuICAgICAgICBpZiAodHlwZW9mIHgyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy54ID0geDIueDtcbiAgICAgICAgICB0aGlzLnkgPSB4Mi55O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMueCA9IHgyO1xuICAgICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnNldE51bSA9IGZ1bmN0aW9uKHgyLCB5KSB7XG4gICAgICAgIHRoaXMueCA9IHgyO1xuICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc2V0VmVjMiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMueCA9IHZhbHVlLng7XG4gICAgICAgIHRoaXMueSA9IHZhbHVlLnk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS53U2V0ID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICBpZiAodHlwZW9mIGIyICE9PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiB3ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2V0Q29tYmluZShhMiwgdjMsIGIyLCB3KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zZXRNdWwoYTIsIHYzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zZXRDb21iaW5lID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICB2YXIgeDIgPSBhMiAqIHYzLnggKyBiMiAqIHcueDtcbiAgICAgICAgdmFyIHkgPSBhMiAqIHYzLnkgKyBiMiAqIHcueTtcbiAgICAgICAgdGhpcy54ID0geDI7XG4gICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zZXRNdWwgPSBmdW5jdGlvbihhMiwgdjMpIHtcbiAgICAgICAgdmFyIHgyID0gYTIgKiB2My54O1xuICAgICAgICB2YXIgeSA9IGEyICogdjMueTtcbiAgICAgICAgdGhpcy54ID0geDI7XG4gICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbih3KSB7XG4gICAgICAgIHRoaXMueCArPSB3Lng7XG4gICAgICAgIHRoaXMueSArPSB3Lnk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS53QWRkID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICBpZiAodHlwZW9mIGIyICE9PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiB3ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuYWRkQ29tYmluZShhMiwgdjMsIGIyLCB3KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5hZGRNdWwoYTIsIHYzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5hZGRDb21iaW5lID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICB2YXIgeDIgPSBhMiAqIHYzLnggKyBiMiAqIHcueDtcbiAgICAgICAgdmFyIHkgPSBhMiAqIHYzLnkgKyBiMiAqIHcueTtcbiAgICAgICAgdGhpcy54ICs9IHgyO1xuICAgICAgICB0aGlzLnkgKz0geTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLmFkZE11bCA9IGZ1bmN0aW9uKGEyLCB2Mykge1xuICAgICAgICB2YXIgeDIgPSBhMiAqIHYzLng7XG4gICAgICAgIHZhciB5ID0gYTIgKiB2My55O1xuICAgICAgICB0aGlzLnggKz0geDI7XG4gICAgICAgIHRoaXMueSArPSB5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUud1N1YiA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiMiAhPT0gXCJ1bmRlZmluZWRcIiB8fCB0eXBlb2YgdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiB0aGlzLnN1YkNvbWJpbmUoYTIsIHYzLCBiMiwgdyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc3ViTXVsKGEyLCB2Myk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc3ViQ29tYmluZSA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgdmFyIHgyID0gYTIgKiB2My54ICsgYjIgKiB3Lng7XG4gICAgICAgIHZhciB5ID0gYTIgKiB2My55ICsgYjIgKiB3Lnk7XG4gICAgICAgIHRoaXMueCAtPSB4MjtcbiAgICAgICAgdGhpcy55IC09IHk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zdWJNdWwgPSBmdW5jdGlvbihhMiwgdjMpIHtcbiAgICAgICAgdmFyIHgyID0gYTIgKiB2My54O1xuICAgICAgICB2YXIgeSA9IGEyICogdjMueTtcbiAgICAgICAgdGhpcy54IC09IHgyO1xuICAgICAgICB0aGlzLnkgLT0geTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnN1YiA9IGZ1bmN0aW9uKHcpIHtcbiAgICAgICAgdGhpcy54IC09IHcueDtcbiAgICAgICAgdGhpcy55IC09IHcueTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLm11bCA9IGZ1bmN0aW9uKG0pIHtcbiAgICAgICAgdGhpcy54ICo9IG07XG4gICAgICAgIHRoaXMueSAqPSBtO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUubGVuZ3RoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5sZW5ndGhPZih0aGlzKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUubGVuZ3RoU3F1YXJlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVmVjMjIubGVuZ3RoU3F1YXJlZCh0aGlzKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUubm9ybWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpO1xuICAgICAgICBpZiAobGVuZ3RoIDwgRVBTSUxPTikge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnZMZW5ndGggPSAxIC8gbGVuZ3RoO1xuICAgICAgICB0aGlzLnggKj0gaW52TGVuZ3RoO1xuICAgICAgICB0aGlzLnkgKj0gaW52TGVuZ3RoO1xuICAgICAgICByZXR1cm4gbGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSBWZWMyMi5sZW5ndGhPZih2Myk7XG4gICAgICAgIGlmIChsZW5ndGggPCBFUFNJTE9OKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLnplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW52TGVuZ3RoID0gMSAvIGxlbmd0aDtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh2My54ICogaW52TGVuZ3RoLCB2My55ICogaW52TGVuZ3RoKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5sZW5ndGhPZiA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBtYXRoX3NxcnQkNSh2My54ICogdjMueCArIHYzLnkgKiB2My55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5sZW5ndGhTcXVhcmVkID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIHYzLnggKiB2My54ICsgdjMueSAqIHYzLnk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuZGlzdGFuY2UgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICB2YXIgZHggPSB2My54IC0gdy54O1xuICAgICAgICB2YXIgZHkgPSB2My55IC0gdy55O1xuICAgICAgICByZXR1cm4gbWF0aF9zcXJ0JDUoZHggKiBkeCArIGR5ICogZHkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmRpc3RhbmNlU3F1YXJlZCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHZhciBkeCA9IHYzLnggLSB3Lng7XG4gICAgICAgIHZhciBkeSA9IHYzLnkgLSB3Lnk7XG4gICAgICAgIHJldHVybiBkeCAqIGR4ICsgZHkgKiBkeTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5hcmVFcXVhbCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiB2MyA9PT0gdyB8fCB0eXBlb2YgdyA9PT0gXCJvYmplY3RcIiAmJiB3ICE9PSBudWxsICYmIHYzLnggPT09IHcueCAmJiB2My55ID09PSB3Lnk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuc2tldyA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8oLXYzLnksIHYzLngpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmRvdCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiB2My54ICogdy54ICsgdjMueSAqIHcueTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5jcm9zcyA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8odyAqIHYzLnksIC13ICogdjMueCk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHYzID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMgKiB3LnksIHYzICogdy54KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdjMueCAqIHcueSAtIHYzLnkgKiB3Lng7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBWZWMyMi5jcm9zc1ZlYzJWZWMyID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIHYzLnggKiB3LnkgLSB2My55ICogdy54O1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmNyb3NzVmVjMk51bSA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8odyAqIHYzLnksIC13ICogdjMueCk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuY3Jvc3NOdW1WZWMyID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMgKiB3LnksIHYzICogdy54KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5hZGRDcm9zcyA9IGZ1bmN0aW9uKGEyLCB2Mywgdykge1xuICAgICAgICBpZiAodHlwZW9mIHcgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIubmVvKHcgKiB2My55ICsgYTIueCwgLXcgKiB2My54ICsgYTIueSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHYzID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMgKiB3LnkgKyBhMi54LCB2MyAqIHcueCArIGEyLnkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVmVjMjIuYWRkQ3Jvc3NWZWMyTnVtID0gZnVuY3Rpb24oYTIsIHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8odyAqIHYzLnkgKyBhMi54LCAtdyAqIHYzLnggKyBhMi55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5hZGRDcm9zc051bVZlYzIgPSBmdW5jdGlvbihhMiwgdjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMgKiB3LnkgKyBhMi54LCB2MyAqIHcueCArIGEyLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmFkZCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8odjMueCArIHcueCwgdjMueSArIHcueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIud0FkZCA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiMiAhPT0gXCJ1bmRlZmluZWRcIiB8fCB0eXBlb2YgdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5jb21iaW5lKGEyLCB2MywgYjIsIHcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5tdWxOdW1WZWMyKGEyLCB2Myk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBWZWMyMi5jb21iaW5lID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIuemVybygpLnNldENvbWJpbmUoYTIsIHYzLCBiMiwgdyk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuc3ViID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh2My54IC0gdy54LCB2My55IC0gdy55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5tdWwgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhMiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8oYTIueCAqIGIyLCBhMi55ICogYjIpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBiMiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8oYTIgKiBiMi54LCBhMiAqIGIyLnkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVmVjMjIubXVsVmVjMk51bSA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKGEyLnggKiBiMiwgYTIueSAqIGIyKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5tdWxOdW1WZWMyID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8oYTIgKiBiMi54LCBhMiAqIGIyLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5uZWcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy54ID0gLXRoaXMueDtcbiAgICAgICAgdGhpcy55ID0gLXRoaXMueTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIubmVnID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMueCwgLXYzLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmFicyA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8obWF0aF9hYnMkOSh2My54KSwgbWF0aF9hYnMkOSh2My55KSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIubWlkID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygodjMueCArIHcueCkgKiAwLjUsICh2My55ICsgdy55KSAqIDAuNSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIudXBwZXIgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKG1hdGhfbWF4JDgodjMueCwgdy54KSwgbWF0aF9tYXgkOCh2My55LCB3LnkpKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5sb3dlciA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8obWF0aF9taW4kOCh2My54LCB3LngpLCBtYXRoX21pbiQ4KHYzLnksIHcueSkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5jbGFtcCA9IGZ1bmN0aW9uKG1heCkge1xuICAgICAgICB2YXIgbGVuZ3RoU3FyID0gdGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55O1xuICAgICAgICBpZiAobGVuZ3RoU3FyID4gbWF4ICogbWF4KSB7XG4gICAgICAgICAgdmFyIHNjYWxlID0gbWF4IC8gbWF0aF9zcXJ0JDUobGVuZ3RoU3FyKTtcbiAgICAgICAgICB0aGlzLnggKj0gc2NhbGU7XG4gICAgICAgICAgdGhpcy55ICo9IHNjYWxlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmNsYW1wID0gZnVuY3Rpb24odjMsIG1heCkge1xuICAgICAgICB2YXIgciA9IFZlYzIyLm5lbyh2My54LCB2My55KTtcbiAgICAgICAgci5jbGFtcChtYXgpO1xuICAgICAgICByZXR1cm4gcjtcbiAgICAgIH07XG4gICAgICBWZWMyMi5jbGFtcFZlYzIgPSBmdW5jdGlvbih2MywgbWluLCBtYXgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB4OiBjbGFtcCh2My54LCBtaW4gPT09IG51bGwgfHwgbWluID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtaW4ueCwgbWF4ID09PSBudWxsIHx8IG1heCA9PT0gdm9pZCAwID8gdm9pZCAwIDogbWF4LngpLFxuICAgICAgICAgIHk6IGNsYW1wKHYzLnksIG1pbiA9PT0gbnVsbCB8fCBtaW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG1pbi55LCBtYXggPT09IG51bGwgfHwgbWF4ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtYXgueSlcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5zY2FsZUZuID0gZnVuY3Rpb24oeDIsIHkpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh2My54ICogeDIsIHYzLnkgKiB5KTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBWZWMyMi50cmFuc2xhdGVGbiA9IGZ1bmN0aW9uKHgyLCB5KSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih2Mykge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8odjMueCArIHgyLCB2My55ICsgeSk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFZlYzIyO1xuICAgIH0oKVxuICApO1xuICB2YXIgbWF0aF9tYXgkNyA9IE1hdGgubWF4O1xuICB2YXIgbWF0aF9taW4kNyA9IE1hdGgubWluO1xuICB2YXIgQUFCQiA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBBQUJCMihsb3dlciwgdXBwZXIpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEFBQkIyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgQUFCQjIobG93ZXIsIHVwcGVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxvd2VyQm91bmQgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy51cHBlckJvdW5kID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIGlmICh0eXBlb2YgbG93ZXIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLmxvd2VyQm91bmQuc2V0VmVjMihsb3dlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB1cHBlciA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMudXBwZXJCb3VuZC5zZXRWZWMyKHVwcGVyKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbG93ZXIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLnVwcGVyQm91bmQuc2V0VmVjMihsb3dlcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIEFBQkIyLnByb3RvdHlwZS5pc1ZhbGlkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBBQUJCMi5pc1ZhbGlkKHRoaXMpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBWZWMyLmlzVmFsaWQob2JqLmxvd2VyQm91bmQpICYmIFZlYzIuaXNWYWxpZChvYmoudXBwZXJCb3VuZCkgJiYgVmVjMi5zdWIob2JqLnVwcGVyQm91bmQsIG9iai5sb3dlckJvdW5kKS5sZW5ndGhTcXVhcmVkKCkgPj0gMDtcbiAgICAgIH07XG4gICAgICBBQUJCMi5hc3NlcnQgPSBmdW5jdGlvbihvKSB7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmdldENlbnRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oKHRoaXMubG93ZXJCb3VuZC54ICsgdGhpcy51cHBlckJvdW5kLngpICogMC41LCAodGhpcy5sb3dlckJvdW5kLnkgKyB0aGlzLnVwcGVyQm91bmQueSkgKiAwLjUpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5nZXRFeHRlbnRzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbygodGhpcy51cHBlckJvdW5kLnggLSB0aGlzLmxvd2VyQm91bmQueCkgKiAwLjUsICh0aGlzLnVwcGVyQm91bmQueSAtIHRoaXMubG93ZXJCb3VuZC55KSAqIDAuNSk7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmdldFBlcmltZXRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gMiAqICh0aGlzLnVwcGVyQm91bmQueCAtIHRoaXMubG93ZXJCb3VuZC54ICsgdGhpcy51cHBlckJvdW5kLnkgLSB0aGlzLmxvd2VyQm91bmQueSk7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmNvbWJpbmUgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgYjIgPSBiMiB8fCB0aGlzO1xuICAgICAgICB2YXIgbG93ZXJBID0gYTIubG93ZXJCb3VuZDtcbiAgICAgICAgdmFyIHVwcGVyQSA9IGEyLnVwcGVyQm91bmQ7XG4gICAgICAgIHZhciBsb3dlckIgPSBiMi5sb3dlckJvdW5kO1xuICAgICAgICB2YXIgdXBwZXJCID0gYjIudXBwZXJCb3VuZDtcbiAgICAgICAgdmFyIGxvd2VyWCA9IG1hdGhfbWluJDcobG93ZXJBLngsIGxvd2VyQi54KTtcbiAgICAgICAgdmFyIGxvd2VyWSA9IG1hdGhfbWluJDcobG93ZXJBLnksIGxvd2VyQi55KTtcbiAgICAgICAgdmFyIHVwcGVyWCA9IG1hdGhfbWF4JDcodXBwZXJCLngsIHVwcGVyQS54KTtcbiAgICAgICAgdmFyIHVwcGVyWSA9IG1hdGhfbWF4JDcodXBwZXJCLnksIHVwcGVyQS55KTtcbiAgICAgICAgdGhpcy5sb3dlckJvdW5kLnNldE51bShsb3dlclgsIGxvd2VyWSk7XG4gICAgICAgIHRoaXMudXBwZXJCb3VuZC5zZXROdW0odXBwZXJYLCB1cHBlclkpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5jb21iaW5lUG9pbnRzID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHRoaXMubG93ZXJCb3VuZC5zZXROdW0obWF0aF9taW4kNyhhMi54LCBiMi54KSwgbWF0aF9taW4kNyhhMi55LCBiMi55KSk7XG4gICAgICAgIHRoaXMudXBwZXJCb3VuZC5zZXROdW0obWF0aF9tYXgkNyhhMi54LCBiMi54KSwgbWF0aF9tYXgkNyhhMi55LCBiMi55KSk7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKGFhYmIpIHtcbiAgICAgICAgdGhpcy5sb3dlckJvdW5kLnNldE51bShhYWJiLmxvd2VyQm91bmQueCwgYWFiYi5sb3dlckJvdW5kLnkpO1xuICAgICAgICB0aGlzLnVwcGVyQm91bmQuc2V0TnVtKGFhYmIudXBwZXJCb3VuZC54LCBhYWJiLnVwcGVyQm91bmQueSk7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24oYWFiYikge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIHRoaXMubG93ZXJCb3VuZC54IDw9IGFhYmIubG93ZXJCb3VuZC54O1xuICAgICAgICByZXN1bHQgPSByZXN1bHQgJiYgdGhpcy5sb3dlckJvdW5kLnkgPD0gYWFiYi5sb3dlckJvdW5kLnk7XG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiBhYWJiLnVwcGVyQm91bmQueCA8PSB0aGlzLnVwcGVyQm91bmQueDtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIGFhYmIudXBwZXJCb3VuZC55IDw9IHRoaXMudXBwZXJCb3VuZC55O1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5leHRlbmQgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBBQUJCMi5leHRlbmQodGhpcywgdmFsdWUpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBBQUJCMi5leHRlbmQgPSBmdW5jdGlvbihvdXQsIHZhbHVlKSB7XG4gICAgICAgIG91dC5sb3dlckJvdW5kLnggLT0gdmFsdWU7XG4gICAgICAgIG91dC5sb3dlckJvdW5kLnkgLT0gdmFsdWU7XG4gICAgICAgIG91dC51cHBlckJvdW5kLnggKz0gdmFsdWU7XG4gICAgICAgIG91dC51cHBlckJvdW5kLnkgKz0gdmFsdWU7XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgICB9O1xuICAgICAgQUFCQjIudGVzdE92ZXJsYXAgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIGQxeCA9IGIyLmxvd2VyQm91bmQueCAtIGEyLnVwcGVyQm91bmQueDtcbiAgICAgICAgdmFyIGQyeCA9IGEyLmxvd2VyQm91bmQueCAtIGIyLnVwcGVyQm91bmQueDtcbiAgICAgICAgdmFyIGQxeSA9IGIyLmxvd2VyQm91bmQueSAtIGEyLnVwcGVyQm91bmQueTtcbiAgICAgICAgdmFyIGQyeSA9IGEyLmxvd2VyQm91bmQueSAtIGIyLnVwcGVyQm91bmQueTtcbiAgICAgICAgaWYgKGQxeCA+IDAgfHwgZDF5ID4gMCB8fCBkMnggPiAwIHx8IGQyeSA+IDApIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgQUFCQjIuYXJlRXF1YWwgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIuYXJlRXF1YWwoYTIubG93ZXJCb3VuZCwgYjIubG93ZXJCb3VuZCkgJiYgVmVjMi5hcmVFcXVhbChhMi51cHBlckJvdW5kLCBiMi51cHBlckJvdW5kKTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5kaWZmID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciB3RCA9IG1hdGhfbWF4JDcoMCwgbWF0aF9taW4kNyhhMi51cHBlckJvdW5kLngsIGIyLnVwcGVyQm91bmQueCkgLSBtYXRoX21heCQ3KGIyLmxvd2VyQm91bmQueCwgYTIubG93ZXJCb3VuZC54KSk7XG4gICAgICAgIHZhciBoRCA9IG1hdGhfbWF4JDcoMCwgbWF0aF9taW4kNyhhMi51cHBlckJvdW5kLnksIGIyLnVwcGVyQm91bmQueSkgLSBtYXRoX21heCQ3KGIyLmxvd2VyQm91bmQueSwgYTIubG93ZXJCb3VuZC55KSk7XG4gICAgICAgIHZhciB3QSA9IGEyLnVwcGVyQm91bmQueCAtIGEyLmxvd2VyQm91bmQueDtcbiAgICAgICAgdmFyIGhBID0gYTIudXBwZXJCb3VuZC55IC0gYTIubG93ZXJCb3VuZC55O1xuICAgICAgICB2YXIgd0IgPSBiMi51cHBlckJvdW5kLnggLSBiMi5sb3dlckJvdW5kLng7XG4gICAgICAgIHZhciBoQiA9IGIyLnVwcGVyQm91bmQueSAtIGIyLmxvd2VyQm91bmQueTtcbiAgICAgICAgcmV0dXJuIHdBICogaEEgKyB3QiAqIGhCIC0gd0QgKiBoRDtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0Mikge1xuICAgICAgICB2YXIgdG1pbiA9IC1JbmZpbml0eTtcbiAgICAgICAgdmFyIHRtYXggPSBJbmZpbml0eTtcbiAgICAgICAgdmFyIHAgPSBpbnB1dDIucDE7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuc3ViKGlucHV0Mi5wMiwgaW5wdXQyLnAxKTtcbiAgICAgICAgdmFyIGFic0QgPSBWZWMyLmFicyhkMik7XG4gICAgICAgIHZhciBub3JtYWwzID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHtcbiAgICAgICAgICBpZiAoYWJzRC54IDwgRVBTSUxPTikge1xuICAgICAgICAgICAgaWYgKHAueCA8IHRoaXMubG93ZXJCb3VuZC54IHx8IHRoaXMudXBwZXJCb3VuZC54IDwgcC54KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGludl9kID0gMSAvIGQyLng7XG4gICAgICAgICAgICB2YXIgdDEgPSAodGhpcy5sb3dlckJvdW5kLnggLSBwLngpICogaW52X2Q7XG4gICAgICAgICAgICB2YXIgdDIgPSAodGhpcy51cHBlckJvdW5kLnggLSBwLngpICogaW52X2Q7XG4gICAgICAgICAgICB2YXIgczIgPSAtMTtcbiAgICAgICAgICAgIGlmICh0MSA+IHQyKSB7XG4gICAgICAgICAgICAgIHZhciB0ZW1wMyA9IHQxO1xuICAgICAgICAgICAgICB0MSA9IHQyO1xuICAgICAgICAgICAgICB0MiA9IHRlbXAzO1xuICAgICAgICAgICAgICBzMiA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodDEgPiB0bWluKSB7XG4gICAgICAgICAgICAgIG5vcm1hbDMuc2V0WmVybygpO1xuICAgICAgICAgICAgICBub3JtYWwzLnggPSBzMjtcbiAgICAgICAgICAgICAgdG1pbiA9IHQxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdG1heCA9IG1hdGhfbWluJDcodG1heCwgdDIpO1xuICAgICAgICAgICAgaWYgKHRtaW4gPiB0bWF4KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIGlmIChhYnNELnkgPCBFUFNJTE9OKSB7XG4gICAgICAgICAgICBpZiAocC55IDwgdGhpcy5sb3dlckJvdW5kLnkgfHwgdGhpcy51cHBlckJvdW5kLnkgPCBwLnkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgaW52X2QgPSAxIC8gZDIueTtcbiAgICAgICAgICAgIHZhciB0MSA9ICh0aGlzLmxvd2VyQm91bmQueSAtIHAueSkgKiBpbnZfZDtcbiAgICAgICAgICAgIHZhciB0MiA9ICh0aGlzLnVwcGVyQm91bmQueSAtIHAueSkgKiBpbnZfZDtcbiAgICAgICAgICAgIHZhciBzMiA9IC0xO1xuICAgICAgICAgICAgaWYgKHQxID4gdDIpIHtcbiAgICAgICAgICAgICAgdmFyIHRlbXAzID0gdDE7XG4gICAgICAgICAgICAgIHQxID0gdDI7XG4gICAgICAgICAgICAgIHQyID0gdGVtcDM7XG4gICAgICAgICAgICAgIHMyID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0MSA+IHRtaW4pIHtcbiAgICAgICAgICAgICAgbm9ybWFsMy5zZXRaZXJvKCk7XG4gICAgICAgICAgICAgIG5vcm1hbDMueSA9IHMyO1xuICAgICAgICAgICAgICB0bWluID0gdDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0bWF4ID0gbWF0aF9taW4kNyh0bWF4LCB0Mik7XG4gICAgICAgICAgICBpZiAodG1pbiA+IHRtYXgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodG1pbiA8IDAgfHwgaW5wdXQyLm1heEZyYWN0aW9uIDwgdG1pbikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXQyLmZyYWN0aW9uID0gdG1pbjtcbiAgICAgICAgb3V0cHV0Mi5ub3JtYWwgPSBub3JtYWwzO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLmNvbWJpbmVQb2ludHMgPSBmdW5jdGlvbihvdXQsIGEyLCBiMikge1xuICAgICAgICBvdXQubG93ZXJCb3VuZC54ID0gbWF0aF9taW4kNyhhMi54LCBiMi54KTtcbiAgICAgICAgb3V0Lmxvd2VyQm91bmQueSA9IG1hdGhfbWluJDcoYTIueSwgYjIueSk7XG4gICAgICAgIG91dC51cHBlckJvdW5kLnggPSBtYXRoX21heCQ3KGEyLngsIGIyLngpO1xuICAgICAgICBvdXQudXBwZXJCb3VuZC55ID0gbWF0aF9tYXgkNyhhMi55LCBiMi55KTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgIH07XG4gICAgICBBQUJCMi5jb21iaW5lZFBlcmltZXRlciA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgbHggPSBtYXRoX21pbiQ3KGEyLmxvd2VyQm91bmQueCwgYjIubG93ZXJCb3VuZC54KTtcbiAgICAgICAgdmFyIGx5ID0gbWF0aF9taW4kNyhhMi5sb3dlckJvdW5kLnksIGIyLmxvd2VyQm91bmQueSk7XG4gICAgICAgIHZhciB1eCA9IG1hdGhfbWF4JDcoYTIudXBwZXJCb3VuZC54LCBiMi51cHBlckJvdW5kLngpO1xuICAgICAgICB2YXIgdXkgPSBtYXRoX21heCQ3KGEyLnVwcGVyQm91bmQueSwgYjIudXBwZXJCb3VuZC55KTtcbiAgICAgICAgcmV0dXJuIDIgKiAodXggLSBseCArIHV5IC0gbHkpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBBQUJCMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfUEkkNiA9IE1hdGguUEk7XG4gIHZhciBTZXR0aW5ncyA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTZXR0aW5nczIoKSB7XG4gICAgICB9XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3MyLCBcInBvbHlnb25SYWRpdXNcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHJhZGl1cyBvZiB0aGUgcG9seWdvbi9lZGdlIHNoYXBlIHNraW4uIFRoaXMgc2hvdWxkIG5vdCBiZSBtb2RpZmllZC5cbiAgICAgICAgICogTWFraW5nIHRoaXMgc21hbGxlciBtZWFucyBwb2x5Z29ucyB3aWxsIGhhdmUgYW4gaW5zdWZmaWNpZW50IGJ1ZmZlciBmb3JcbiAgICAgICAgICogY29udGludW91cyBjb2xsaXNpb24uIE1ha2luZyBpdCBsYXJnZXIgbWF5IGNyZWF0ZSBhcnRpZmFjdHMgZm9yIHZlcnRleFxuICAgICAgICAgKiBjb2xsaXNpb24uXG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiAyICogU2V0dGluZ3MyLmxpbmVhclNsb3A7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgU2V0dGluZ3MyLmxlbmd0aFVuaXRzUGVyTWV0ZXIgPSAxO1xuICAgICAgU2V0dGluZ3MyLm1heE1hbmlmb2xkUG9pbnRzID0gMjtcbiAgICAgIFNldHRpbmdzMi5tYXhQb2x5Z29uVmVydGljZXMgPSAxMjtcbiAgICAgIFNldHRpbmdzMi5hYWJiRXh0ZW5zaW9uID0gMC4xO1xuICAgICAgU2V0dGluZ3MyLmFhYmJNdWx0aXBsaWVyID0gMjtcbiAgICAgIFNldHRpbmdzMi5saW5lYXJTbG9wID0gNWUtMztcbiAgICAgIFNldHRpbmdzMi5hbmd1bGFyU2xvcCA9IDIgLyAxODAgKiBtYXRoX1BJJDY7XG4gICAgICBTZXR0aW5nczIubWF4U3ViU3RlcHMgPSA4O1xuICAgICAgU2V0dGluZ3MyLm1heFRPSUNvbnRhY3RzID0gMzI7XG4gICAgICBTZXR0aW5nczIubWF4VE9JSXRlcmF0aW9ucyA9IDIwO1xuICAgICAgU2V0dGluZ3MyLm1heERpc3RhbmNlSXRlcmF0aW9ucyA9IDIwO1xuICAgICAgU2V0dGluZ3MyLnZlbG9jaXR5VGhyZXNob2xkID0gMTtcbiAgICAgIFNldHRpbmdzMi5tYXhMaW5lYXJDb3JyZWN0aW9uID0gMC4yO1xuICAgICAgU2V0dGluZ3MyLm1heEFuZ3VsYXJDb3JyZWN0aW9uID0gOCAvIDE4MCAqIG1hdGhfUEkkNjtcbiAgICAgIFNldHRpbmdzMi5tYXhUcmFuc2xhdGlvbiA9IDI7XG4gICAgICBTZXR0aW5nczIubWF4Um90YXRpb24gPSAwLjUgKiBtYXRoX1BJJDY7XG4gICAgICBTZXR0aW5nczIuYmF1bWdhcnRlID0gMC4yO1xuICAgICAgU2V0dGluZ3MyLnRvaUJhdWdhcnRlID0gMC43NTtcbiAgICAgIFNldHRpbmdzMi50aW1lVG9TbGVlcCA9IDAuNTtcbiAgICAgIFNldHRpbmdzMi5saW5lYXJTbGVlcFRvbGVyYW5jZSA9IDAuMDE7XG4gICAgICBTZXR0aW5nczIuYW5ndWxhclNsZWVwVG9sZXJhbmNlID0gMiAvIDE4MCAqIG1hdGhfUEkkNjtcbiAgICAgIHJldHVybiBTZXR0aW5nczI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBTZXR0aW5nc0ludGVybmFsID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNldHRpbmdzSW50ZXJuYWwyKCkge1xuICAgICAgfVxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heE1hbmlmb2xkUG9pbnRzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4TWFuaWZvbGRQb2ludHM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heFBvbHlnb25WZXJ0aWNlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFBvbHlnb25WZXJ0aWNlcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwiYWFiYkV4dGVuc2lvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmFhYmJFeHRlbnNpb24gKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJhYWJiTXVsdGlwbGllclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmFhYmJNdWx0aXBsaWVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJsaW5lYXJTbG9wXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubGluZWFyU2xvcCAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImxpbmVhclNsb3BTcXVhcmVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubGluZWFyU2xvcCAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXIgKiBTZXR0aW5ncy5saW5lYXJTbG9wICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwiYW5ndWxhclNsb3BcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5hbmd1bGFyU2xvcDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwicG9seWdvblJhZGl1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIDIgKiBTZXR0aW5ncy5saW5lYXJTbG9wO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhTdWJTdGVwc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFN1YlN0ZXBzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhUT0lDb250YWN0c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFRPSUNvbnRhY3RzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhUT0lJdGVyYXRpb25zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4VE9JSXRlcmF0aW9ucztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4RGlzdGFuY2VJdGVyYXRpb25zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4RGlzdGFuY2VJdGVyYXRpb25zO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJ2ZWxvY2l0eVRocmVzaG9sZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLnZlbG9jaXR5VGhyZXNob2xkICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4TGluZWFyQ29ycmVjdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heExpbmVhckNvcnJlY3Rpb24gKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhBbmd1bGFyQ29ycmVjdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heEFuZ3VsYXJDb3JyZWN0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhUcmFuc2xhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFRyYW5zbGF0aW9uICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4VHJhbnNsYXRpb25TcXVhcmVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4VHJhbnNsYXRpb24gKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyICogU2V0dGluZ3MubWF4VHJhbnNsYXRpb24gKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhSb3RhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFJvdGF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhSb3RhdGlvblNxdWFyZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhSb3RhdGlvbiAqIFNldHRpbmdzLm1heFJvdGF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJiYXVtZ2FydGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5iYXVtZ2FydGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcInRvaUJhdWdhcnRlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MudG9pQmF1Z2FydGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcInRpbWVUb1NsZWVwXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MudGltZVRvU2xlZXA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImxpbmVhclNsZWVwVG9sZXJhbmNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubGluZWFyU2xlZXBUb2xlcmFuY2UgKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJsaW5lYXJTbGVlcFRvbGVyYW5jZVNxclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmxpbmVhclNsZWVwVG9sZXJhbmNlICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlciAqIFNldHRpbmdzLmxpbmVhclNsZWVwVG9sZXJhbmNlICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwiYW5ndWxhclNsZWVwVG9sZXJhbmNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MuYW5ndWxhclNsZWVwVG9sZXJhbmNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJhbmd1bGFyU2xlZXBUb2xlcmFuY2VTcXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5hbmd1bGFyU2xlZXBUb2xlcmFuY2UgKiBTZXR0aW5ncy5hbmd1bGFyU2xlZXBUb2xlcmFuY2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIFNldHRpbmdzSW50ZXJuYWwyO1xuICAgIH0oKVxuICApO1xuICB2YXIgUG9vbCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBQb29sMihvcHRzKSB7XG4gICAgICAgIHRoaXMuX2xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5fbWF4ID0gSW5maW5pdHk7XG4gICAgICAgIHRoaXMuX2hhc0NyZWF0ZUZuID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2NyZWF0ZUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5faGFzQWxsb2NhdGVGbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9hbGxvY2F0ZUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5faGFzUmVsZWFzZUZuID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3JlbGVhc2VDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuX2hhc0Rpc3Bvc2VGbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9kaXNwb3NlQ291bnQgPSAwO1xuICAgICAgICB0aGlzLl9saXN0ID0gW107XG4gICAgICAgIHRoaXMuX21heCA9IG9wdHMubWF4IHx8IHRoaXMuX21heDtcbiAgICAgICAgdGhpcy5fY3JlYXRlRm4gPSBvcHRzLmNyZWF0ZTtcbiAgICAgICAgdGhpcy5faGFzQ3JlYXRlRm4gPSB0eXBlb2YgdGhpcy5fY3JlYXRlRm4gPT09IFwiZnVuY3Rpb25cIjtcbiAgICAgICAgdGhpcy5fYWxsb2NhdGVGbiA9IG9wdHMuYWxsb2NhdGU7XG4gICAgICAgIHRoaXMuX2hhc0FsbG9jYXRlRm4gPSB0eXBlb2YgdGhpcy5fYWxsb2NhdGVGbiA9PT0gXCJmdW5jdGlvblwiO1xuICAgICAgICB0aGlzLl9yZWxlYXNlRm4gPSBvcHRzLnJlbGVhc2U7XG4gICAgICAgIHRoaXMuX2hhc1JlbGVhc2VGbiA9IHR5cGVvZiB0aGlzLl9yZWxlYXNlRm4gPT09IFwiZnVuY3Rpb25cIjtcbiAgICAgICAgdGhpcy5fZGlzcG9zZUZuID0gb3B0cy5kaXNwb3NlO1xuICAgICAgICB0aGlzLl9oYXNEaXNwb3NlRm4gPSB0eXBlb2YgdGhpcy5fZGlzcG9zZUZuID09PSBcImZ1bmN0aW9uXCI7XG4gICAgICB9XG4gICAgICBQb29sMi5wcm90b3R5cGUubWF4ID0gZnVuY3Rpb24objIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBuMiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHRoaXMuX21heCA9IG4yO1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9tYXg7XG4gICAgICB9O1xuICAgICAgUG9vbDIucHJvdG90eXBlLnNpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xpc3QubGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIFBvb2wyLnByb3RvdHlwZS5hbGxvY2F0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaXRlbTtcbiAgICAgICAgaWYgKHRoaXMuX2xpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGl0ZW0gPSB0aGlzLl9saXN0LnNoaWZ0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fY3JlYXRlQ291bnQrKztcbiAgICAgICAgICBpZiAodGhpcy5faGFzQ3JlYXRlRm4pIHtcbiAgICAgICAgICAgIGl0ZW0gPSB0aGlzLl9jcmVhdGVGbigpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpdGVtID0ge307XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FsbG9jYXRlQ291bnQrKztcbiAgICAgICAgaWYgKHRoaXMuX2hhc0FsbG9jYXRlRm4pIHtcbiAgICAgICAgICB0aGlzLl9hbGxvY2F0ZUZuKGl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgfTtcbiAgICAgIFBvb2wyLnByb3RvdHlwZS5yZWxlYXNlID0gZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBpZiAodGhpcy5fbGlzdC5sZW5ndGggPCB0aGlzLl9tYXgpIHtcbiAgICAgICAgICB0aGlzLl9yZWxlYXNlQ291bnQrKztcbiAgICAgICAgICBpZiAodGhpcy5faGFzUmVsZWFzZUZuKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWxlYXNlRm4oaXRlbSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX2xpc3QucHVzaChpdGVtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9kaXNwb3NlQ291bnQrKztcbiAgICAgICAgICBpZiAodGhpcy5faGFzRGlzcG9zZUZuKSB7XG4gICAgICAgICAgICBpdGVtID0gdGhpcy5fZGlzcG9zZUZuKGl0ZW0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFBvb2wyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gXCIgK1wiICsgdGhpcy5fY3JlYXRlQ291bnQgKyBcIiA+XCIgKyB0aGlzLl9hbGxvY2F0ZUNvdW50ICsgXCIgPFwiICsgdGhpcy5fcmVsZWFzZUNvdW50ICsgXCIgLVwiICsgdGhpcy5fZGlzcG9zZUNvdW50ICsgXCIgPVwiICsgdGhpcy5fbGlzdC5sZW5ndGggKyBcIi9cIiArIHRoaXMuX21heDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gUG9vbDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX2FicyQ4ID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX21heCQ2ID0gTWF0aC5tYXg7XG4gIHZhciBUcmVlTm9kZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBUcmVlTm9kZTIoaWQpIHtcbiAgICAgICAgdGhpcy5hYWJiID0gbmV3IEFBQkIoKTtcbiAgICAgICAgdGhpcy51c2VyRGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMucGFyZW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5jaGlsZDEgPSBudWxsO1xuICAgICAgICB0aGlzLmNoaWxkMiA9IG51bGw7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gLTE7XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgIH1cbiAgICAgIFRyZWVOb2RlMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaWQgKyBcIjogXCIgKyB0aGlzLnVzZXJEYXRhO1xuICAgICAgfTtcbiAgICAgIFRyZWVOb2RlMi5wcm90b3R5cGUuaXNMZWFmID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkMSA9PSBudWxsO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBUcmVlTm9kZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBwb29sVHJlZU5vZGUgPSBuZXcgUG9vbCh7XG4gICAgY3JlYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBuZXcgVHJlZU5vZGUoKTtcbiAgICB9LFxuICAgIHJlbGVhc2U6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIG5vZGUudXNlckRhdGEgPSBudWxsO1xuICAgICAgbm9kZS5wYXJlbnQgPSBudWxsO1xuICAgICAgbm9kZS5jaGlsZDEgPSBudWxsO1xuICAgICAgbm9kZS5jaGlsZDIgPSBudWxsO1xuICAgICAgbm9kZS5oZWlnaHQgPSAtMTtcbiAgICAgIG5vZGUuaWQgPSB2b2lkIDA7XG4gICAgfVxuICB9KTtcbiAgdmFyIER5bmFtaWNUcmVlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIER5bmFtaWNUcmVlMigpIHtcbiAgICAgICAgdGhpcy5pbnB1dFBvb2wgPSBuZXcgUG9vbCh7XG4gICAgICAgICAgY3JlYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlbGVhc2U6IGZ1bmN0aW9uKHN0YWNrKSB7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdGFja1Bvb2wgPSBuZXcgUG9vbCh7XG4gICAgICAgICAgY3JlYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlbGVhc2U6IGZ1bmN0aW9uKHN0YWNrKSB7XG4gICAgICAgICAgICBzdGFjay5sZW5ndGggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaXRlcmF0b3JQb29sID0gbmV3IFBvb2woe1xuICAgICAgICAgIGNyZWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEl0ZXJhdG9yKCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZWxlYXNlOiBmdW5jdGlvbihpdGVyYXRvcikge1xuICAgICAgICAgICAgaXRlcmF0b3IuY2xvc2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm1fcm9vdCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9ub2RlcyA9IHt9O1xuICAgICAgICB0aGlzLm1fbGFzdFByb3h5SWQgPSAwO1xuICAgICAgfVxuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5nZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5tX25vZGVzW2lkXTtcbiAgICAgICAgcmV0dXJuIG5vZGUudXNlckRhdGE7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5nZXRGYXRBQUJCID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fbm9kZXNbaWRdO1xuICAgICAgICByZXR1cm4gbm9kZS5hYWJiO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuYWxsb2NhdGVOb2RlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBub2RlID0gcG9vbFRyZWVOb2RlLmFsbG9jYXRlKCk7XG4gICAgICAgIG5vZGUuaWQgPSArK3RoaXMubV9sYXN0UHJveHlJZDtcbiAgICAgICAgdGhpcy5tX25vZGVzW25vZGUuaWRdID0gbm9kZTtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5mcmVlTm9kZSA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMubV9ub2Rlc1tub2RlLmlkXTtcbiAgICAgICAgcG9vbFRyZWVOb2RlLnJlbGVhc2Uobm9kZSk7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5jcmVhdGVQcm94eSA9IGZ1bmN0aW9uKGFhYmIsIHVzZXJEYXRhKSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5hbGxvY2F0ZU5vZGUoKTtcbiAgICAgICAgbm9kZS5hYWJiLnNldChhYWJiKTtcbiAgICAgICAgQUFCQi5leHRlbmQobm9kZS5hYWJiLCBTZXR0aW5nc0ludGVybmFsLmFhYmJFeHRlbnNpb24pO1xuICAgICAgICBub2RlLnVzZXJEYXRhID0gdXNlckRhdGE7XG4gICAgICAgIG5vZGUuaGVpZ2h0ID0gMDtcbiAgICAgICAgdGhpcy5pbnNlcnRMZWFmKG5vZGUpO1xuICAgICAgICByZXR1cm4gbm9kZS5pZDtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmRlc3Ryb3lQcm94eSA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5tX25vZGVzW2lkXTtcbiAgICAgICAgdGhpcy5yZW1vdmVMZWFmKG5vZGUpO1xuICAgICAgICB0aGlzLmZyZWVOb2RlKG5vZGUpO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUubW92ZVByb3h5ID0gZnVuY3Rpb24oaWQsIGFhYmIsIGQyKSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5tX25vZGVzW2lkXTtcbiAgICAgICAgaWYgKG5vZGUuYWFiYi5jb250YWlucyhhYWJiKSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbW92ZUxlYWYobm9kZSk7XG4gICAgICAgIG5vZGUuYWFiYi5zZXQoYWFiYik7XG4gICAgICAgIGFhYmIgPSBub2RlLmFhYmI7XG4gICAgICAgIEFBQkIuZXh0ZW5kKGFhYmIsIFNldHRpbmdzSW50ZXJuYWwuYWFiYkV4dGVuc2lvbik7XG4gICAgICAgIGlmIChkMi54IDwgMCkge1xuICAgICAgICAgIGFhYmIubG93ZXJCb3VuZC54ICs9IGQyLnggKiBTZXR0aW5nc0ludGVybmFsLmFhYmJNdWx0aXBsaWVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFhYmIudXBwZXJCb3VuZC54ICs9IGQyLnggKiBTZXR0aW5nc0ludGVybmFsLmFhYmJNdWx0aXBsaWVyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkMi55IDwgMCkge1xuICAgICAgICAgIGFhYmIubG93ZXJCb3VuZC55ICs9IGQyLnkgKiBTZXR0aW5nc0ludGVybmFsLmFhYmJNdWx0aXBsaWVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFhYmIudXBwZXJCb3VuZC55ICs9IGQyLnkgKiBTZXR0aW5nc0ludGVybmFsLmFhYmJNdWx0aXBsaWVyO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5zZXJ0TGVhZihub2RlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5pbnNlcnRMZWFmID0gZnVuY3Rpb24obGVhZikge1xuICAgICAgICBpZiAodGhpcy5tX3Jvb3QgPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMubV9yb290ID0gbGVhZjtcbiAgICAgICAgICB0aGlzLm1fcm9vdC5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGVhZkFBQkIgPSBsZWFmLmFhYmI7XG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMubV9yb290O1xuICAgICAgICB3aGlsZSAoIWluZGV4LmlzTGVhZigpKSB7XG4gICAgICAgICAgdmFyIGNoaWxkMSA9IGluZGV4LmNoaWxkMTtcbiAgICAgICAgICB2YXIgY2hpbGQyID0gaW5kZXguY2hpbGQyO1xuICAgICAgICAgIHZhciBhcmVhID0gaW5kZXguYWFiYi5nZXRQZXJpbWV0ZXIoKTtcbiAgICAgICAgICB2YXIgY29tYmluZWRBcmVhID0gQUFCQi5jb21iaW5lZFBlcmltZXRlcihpbmRleC5hYWJiLCBsZWFmQUFCQik7XG4gICAgICAgICAgdmFyIGNvc3QgPSAyICogY29tYmluZWRBcmVhO1xuICAgICAgICAgIHZhciBpbmhlcml0YW5jZUNvc3QgPSAyICogKGNvbWJpbmVkQXJlYSAtIGFyZWEpO1xuICAgICAgICAgIHZhciBuZXdBcmVhMSA9IEFBQkIuY29tYmluZWRQZXJpbWV0ZXIobGVhZkFBQkIsIGNoaWxkMS5hYWJiKTtcbiAgICAgICAgICB2YXIgY29zdDEgPSBuZXdBcmVhMSArIGluaGVyaXRhbmNlQ29zdDtcbiAgICAgICAgICBpZiAoIWNoaWxkMS5pc0xlYWYoKSkge1xuICAgICAgICAgICAgdmFyIG9sZEFyZWEgPSBjaGlsZDEuYWFiYi5nZXRQZXJpbWV0ZXIoKTtcbiAgICAgICAgICAgIGNvc3QxIC09IG9sZEFyZWE7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBuZXdBcmVhMiA9IEFBQkIuY29tYmluZWRQZXJpbWV0ZXIobGVhZkFBQkIsIGNoaWxkMi5hYWJiKTtcbiAgICAgICAgICB2YXIgY29zdDIgPSBuZXdBcmVhMiArIGluaGVyaXRhbmNlQ29zdDtcbiAgICAgICAgICBpZiAoIWNoaWxkMi5pc0xlYWYoKSkge1xuICAgICAgICAgICAgdmFyIG9sZEFyZWEgPSBjaGlsZDIuYWFiYi5nZXRQZXJpbWV0ZXIoKTtcbiAgICAgICAgICAgIGNvc3QyIC09IG9sZEFyZWE7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjb3N0IDwgY29zdDEgJiYgY29zdCA8IGNvc3QyKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNvc3QxIDwgY29zdDIpIHtcbiAgICAgICAgICAgIGluZGV4ID0gY2hpbGQxO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbmRleCA9IGNoaWxkMjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNpYmxpbmcgPSBpbmRleDtcbiAgICAgICAgdmFyIG9sZFBhcmVudCA9IHNpYmxpbmcucGFyZW50O1xuICAgICAgICB2YXIgbmV3UGFyZW50ID0gdGhpcy5hbGxvY2F0ZU5vZGUoKTtcbiAgICAgICAgbmV3UGFyZW50LnBhcmVudCA9IG9sZFBhcmVudDtcbiAgICAgICAgbmV3UGFyZW50LnVzZXJEYXRhID0gbnVsbDtcbiAgICAgICAgbmV3UGFyZW50LmFhYmIuY29tYmluZShsZWFmQUFCQiwgc2libGluZy5hYWJiKTtcbiAgICAgICAgbmV3UGFyZW50LmhlaWdodCA9IHNpYmxpbmcuaGVpZ2h0ICsgMTtcbiAgICAgICAgaWYgKG9sZFBhcmVudCAhPSBudWxsKSB7XG4gICAgICAgICAgaWYgKG9sZFBhcmVudC5jaGlsZDEgPT09IHNpYmxpbmcpIHtcbiAgICAgICAgICAgIG9sZFBhcmVudC5jaGlsZDEgPSBuZXdQYXJlbnQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG9sZFBhcmVudC5jaGlsZDIgPSBuZXdQYXJlbnQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIG5ld1BhcmVudC5jaGlsZDEgPSBzaWJsaW5nO1xuICAgICAgICAgIG5ld1BhcmVudC5jaGlsZDIgPSBsZWFmO1xuICAgICAgICAgIHNpYmxpbmcucGFyZW50ID0gbmV3UGFyZW50O1xuICAgICAgICAgIGxlYWYucGFyZW50ID0gbmV3UGFyZW50O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld1BhcmVudC5jaGlsZDEgPSBzaWJsaW5nO1xuICAgICAgICAgIG5ld1BhcmVudC5jaGlsZDIgPSBsZWFmO1xuICAgICAgICAgIHNpYmxpbmcucGFyZW50ID0gbmV3UGFyZW50O1xuICAgICAgICAgIGxlYWYucGFyZW50ID0gbmV3UGFyZW50O1xuICAgICAgICAgIHRoaXMubV9yb290ID0gbmV3UGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIGluZGV4ID0gbGVhZi5wYXJlbnQ7XG4gICAgICAgIHdoaWxlIChpbmRleCAhPSBudWxsKSB7XG4gICAgICAgICAgaW5kZXggPSB0aGlzLmJhbGFuY2UoaW5kZXgpO1xuICAgICAgICAgIHZhciBjaGlsZDEgPSBpbmRleC5jaGlsZDE7XG4gICAgICAgICAgdmFyIGNoaWxkMiA9IGluZGV4LmNoaWxkMjtcbiAgICAgICAgICBpbmRleC5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihjaGlsZDEuaGVpZ2h0LCBjaGlsZDIuaGVpZ2h0KTtcbiAgICAgICAgICBpbmRleC5hYWJiLmNvbWJpbmUoY2hpbGQxLmFhYmIsIGNoaWxkMi5hYWJiKTtcbiAgICAgICAgICBpbmRleCA9IGluZGV4LnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUucmVtb3ZlTGVhZiA9IGZ1bmN0aW9uKGxlYWYpIHtcbiAgICAgICAgaWYgKGxlYWYgPT09IHRoaXMubV9yb290KSB7XG4gICAgICAgICAgdGhpcy5tX3Jvb3QgPSBudWxsO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyZW50ID0gbGVhZi5wYXJlbnQ7XG4gICAgICAgIHZhciBncmFuZFBhcmVudCA9IHBhcmVudC5wYXJlbnQ7XG4gICAgICAgIHZhciBzaWJsaW5nO1xuICAgICAgICBpZiAocGFyZW50LmNoaWxkMSA9PT0gbGVhZikge1xuICAgICAgICAgIHNpYmxpbmcgPSBwYXJlbnQuY2hpbGQyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNpYmxpbmcgPSBwYXJlbnQuY2hpbGQxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChncmFuZFBhcmVudCAhPSBudWxsKSB7XG4gICAgICAgICAgaWYgKGdyYW5kUGFyZW50LmNoaWxkMSA9PT0gcGFyZW50KSB7XG4gICAgICAgICAgICBncmFuZFBhcmVudC5jaGlsZDEgPSBzaWJsaW5nO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBncmFuZFBhcmVudC5jaGlsZDIgPSBzaWJsaW5nO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzaWJsaW5nLnBhcmVudCA9IGdyYW5kUGFyZW50O1xuICAgICAgICAgIHRoaXMuZnJlZU5vZGUocGFyZW50KTtcbiAgICAgICAgICB2YXIgaW5kZXggPSBncmFuZFBhcmVudDtcbiAgICAgICAgICB3aGlsZSAoaW5kZXggIT0gbnVsbCkge1xuICAgICAgICAgICAgaW5kZXggPSB0aGlzLmJhbGFuY2UoaW5kZXgpO1xuICAgICAgICAgICAgdmFyIGNoaWxkMSA9IGluZGV4LmNoaWxkMTtcbiAgICAgICAgICAgIHZhciBjaGlsZDIgPSBpbmRleC5jaGlsZDI7XG4gICAgICAgICAgICBpbmRleC5hYWJiLmNvbWJpbmUoY2hpbGQxLmFhYmIsIGNoaWxkMi5hYWJiKTtcbiAgICAgICAgICAgIGluZGV4LmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KGNoaWxkMS5oZWlnaHQsIGNoaWxkMi5oZWlnaHQpO1xuICAgICAgICAgICAgaW5kZXggPSBpbmRleC5wYXJlbnQ7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9yb290ID0gc2libGluZztcbiAgICAgICAgICBzaWJsaW5nLnBhcmVudCA9IG51bGw7XG4gICAgICAgICAgdGhpcy5mcmVlTm9kZShwYXJlbnQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5iYWxhbmNlID0gZnVuY3Rpb24oaUEpIHtcbiAgICAgICAgdmFyIEEgPSBpQTtcbiAgICAgICAgaWYgKEEuaXNMZWFmKCkgfHwgQS5oZWlnaHQgPCAyKSB7XG4gICAgICAgICAgcmV0dXJuIGlBO1xuICAgICAgICB9XG4gICAgICAgIHZhciBCID0gQS5jaGlsZDE7XG4gICAgICAgIHZhciBDID0gQS5jaGlsZDI7XG4gICAgICAgIHZhciBiYWxhbmNlID0gQy5oZWlnaHQgLSBCLmhlaWdodDtcbiAgICAgICAgaWYgKGJhbGFuY2UgPiAxKSB7XG4gICAgICAgICAgdmFyIEYgPSBDLmNoaWxkMTtcbiAgICAgICAgICB2YXIgRyA9IEMuY2hpbGQyO1xuICAgICAgICAgIEMuY2hpbGQxID0gQTtcbiAgICAgICAgICBDLnBhcmVudCA9IEEucGFyZW50O1xuICAgICAgICAgIEEucGFyZW50ID0gQztcbiAgICAgICAgICBpZiAoQy5wYXJlbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKEMucGFyZW50LmNoaWxkMSA9PT0gaUEpIHtcbiAgICAgICAgICAgICAgQy5wYXJlbnQuY2hpbGQxID0gQztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIEMucGFyZW50LmNoaWxkMiA9IEM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV9yb290ID0gQztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKEYuaGVpZ2h0ID4gRy5oZWlnaHQpIHtcbiAgICAgICAgICAgIEMuY2hpbGQyID0gRjtcbiAgICAgICAgICAgIEEuY2hpbGQyID0gRztcbiAgICAgICAgICAgIEcucGFyZW50ID0gQTtcbiAgICAgICAgICAgIEEuYWFiYi5jb21iaW5lKEIuYWFiYiwgRy5hYWJiKTtcbiAgICAgICAgICAgIEMuYWFiYi5jb21iaW5lKEEuYWFiYiwgRi5hYWJiKTtcbiAgICAgICAgICAgIEEuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoQi5oZWlnaHQsIEcuaGVpZ2h0KTtcbiAgICAgICAgICAgIEMuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoQS5oZWlnaHQsIEYuaGVpZ2h0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgQy5jaGlsZDIgPSBHO1xuICAgICAgICAgICAgQS5jaGlsZDIgPSBGO1xuICAgICAgICAgICAgRi5wYXJlbnQgPSBBO1xuICAgICAgICAgICAgQS5hYWJiLmNvbWJpbmUoQi5hYWJiLCBGLmFhYmIpO1xuICAgICAgICAgICAgQy5hYWJiLmNvbWJpbmUoQS5hYWJiLCBHLmFhYmIpO1xuICAgICAgICAgICAgQS5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihCLmhlaWdodCwgRi5oZWlnaHQpO1xuICAgICAgICAgICAgQy5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihBLmhlaWdodCwgRy5oZWlnaHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gQztcbiAgICAgICAgfVxuICAgICAgICBpZiAoYmFsYW5jZSA8IC0xKSB7XG4gICAgICAgICAgdmFyIEQgPSBCLmNoaWxkMTtcbiAgICAgICAgICB2YXIgRSA9IEIuY2hpbGQyO1xuICAgICAgICAgIEIuY2hpbGQxID0gQTtcbiAgICAgICAgICBCLnBhcmVudCA9IEEucGFyZW50O1xuICAgICAgICAgIEEucGFyZW50ID0gQjtcbiAgICAgICAgICBpZiAoQi5wYXJlbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKEIucGFyZW50LmNoaWxkMSA9PT0gQSkge1xuICAgICAgICAgICAgICBCLnBhcmVudC5jaGlsZDEgPSBCO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgQi5wYXJlbnQuY2hpbGQyID0gQjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX3Jvb3QgPSBCO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoRC5oZWlnaHQgPiBFLmhlaWdodCkge1xuICAgICAgICAgICAgQi5jaGlsZDIgPSBEO1xuICAgICAgICAgICAgQS5jaGlsZDEgPSBFO1xuICAgICAgICAgICAgRS5wYXJlbnQgPSBBO1xuICAgICAgICAgICAgQS5hYWJiLmNvbWJpbmUoQy5hYWJiLCBFLmFhYmIpO1xuICAgICAgICAgICAgQi5hYWJiLmNvbWJpbmUoQS5hYWJiLCBELmFhYmIpO1xuICAgICAgICAgICAgQS5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihDLmhlaWdodCwgRS5oZWlnaHQpO1xuICAgICAgICAgICAgQi5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihBLmhlaWdodCwgRC5oZWlnaHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBCLmNoaWxkMiA9IEU7XG4gICAgICAgICAgICBBLmNoaWxkMSA9IEQ7XG4gICAgICAgICAgICBELnBhcmVudCA9IEE7XG4gICAgICAgICAgICBBLmFhYmIuY29tYmluZShDLmFhYmIsIEQuYWFiYik7XG4gICAgICAgICAgICBCLmFhYmIuY29tYmluZShBLmFhYmIsIEUuYWFiYik7XG4gICAgICAgICAgICBBLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KEMuaGVpZ2h0LCBELmhlaWdodCk7XG4gICAgICAgICAgICBCLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KEEuaGVpZ2h0LCBFLmhlaWdodCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBCO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBBO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm1fcm9vdCA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubV9yb290LmhlaWdodDtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmdldEFyZWFSYXRpbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5tX3Jvb3QgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciByb290ID0gdGhpcy5tX3Jvb3Q7XG4gICAgICAgIHZhciByb290QXJlYSA9IHJvb3QuYWFiYi5nZXRQZXJpbWV0ZXIoKTtcbiAgICAgICAgdmFyIHRvdGFsQXJlYSA9IDA7XG4gICAgICAgIHZhciBub2RlO1xuICAgICAgICB2YXIgaXQgPSB0aGlzLml0ZXJhdG9yUG9vbC5hbGxvY2F0ZSgpLnByZW9yZGVyKHRoaXMubV9yb290KTtcbiAgICAgICAgd2hpbGUgKG5vZGUgPSBpdC5uZXh0KCkpIHtcbiAgICAgICAgICBpZiAobm9kZS5oZWlnaHQgPCAwKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdG90YWxBcmVhICs9IG5vZGUuYWFiYi5nZXRQZXJpbWV0ZXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLml0ZXJhdG9yUG9vbC5yZWxlYXNlKGl0KTtcbiAgICAgICAgcmV0dXJuIHRvdGFsQXJlYSAvIHJvb3RBcmVhO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuY29tcHV0ZUhlaWdodCA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHZhciBub2RlO1xuICAgICAgICBpZiAodHlwZW9mIGlkICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgbm9kZSA9IHRoaXMubV9ub2Rlc1tpZF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm9kZSA9IHRoaXMubV9yb290O1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlLmlzTGVhZigpKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhlaWdodDEgPSB0aGlzLmNvbXB1dGVIZWlnaHQobm9kZS5jaGlsZDEuaWQpO1xuICAgICAgICB2YXIgaGVpZ2h0MiA9IHRoaXMuY29tcHV0ZUhlaWdodChub2RlLmNoaWxkMi5pZCk7XG4gICAgICAgIHJldHVybiAxICsgbWF0aF9tYXgkNihoZWlnaHQxLCBoZWlnaHQyKTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLnZhbGlkYXRlU3RydWN0dXJlID0gZnVuY3Rpb24obm9kZSkge1xuICAgICAgICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlID09PSB0aGlzLm1fcm9vdCkgO1xuICAgICAgICB2YXIgY2hpbGQxID0gbm9kZS5jaGlsZDE7XG4gICAgICAgIHZhciBjaGlsZDIgPSBub2RlLmNoaWxkMjtcbiAgICAgICAgaWYgKG5vZGUuaXNMZWFmKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52YWxpZGF0ZVN0cnVjdHVyZShjaGlsZDEpO1xuICAgICAgICB0aGlzLnZhbGlkYXRlU3RydWN0dXJlKGNoaWxkMik7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS52YWxpZGF0ZU1ldHJpY3MgPSBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIGlmIChub2RlID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkMSA9IG5vZGUuY2hpbGQxO1xuICAgICAgICB2YXIgY2hpbGQyID0gbm9kZS5jaGlsZDI7XG4gICAgICAgIGlmIChub2RlLmlzTGVhZigpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFsaWRhdGVNZXRyaWNzKGNoaWxkMSk7XG4gICAgICAgIHRoaXMudmFsaWRhdGVNZXRyaWNzKGNoaWxkMik7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5nZXRNYXhCYWxhbmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBtYXhCYWxhbmNlID0gMDtcbiAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgIHZhciBpdCA9IHRoaXMuaXRlcmF0b3JQb29sLmFsbG9jYXRlKCkucHJlb3JkZXIodGhpcy5tX3Jvb3QpO1xuICAgICAgICB3aGlsZSAobm9kZSA9IGl0Lm5leHQoKSkge1xuICAgICAgICAgIGlmIChub2RlLmhlaWdodCA8PSAxKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGJhbGFuY2UgPSBtYXRoX2FicyQ4KG5vZGUuY2hpbGQyLmhlaWdodCAtIG5vZGUuY2hpbGQxLmhlaWdodCk7XG4gICAgICAgICAgbWF4QmFsYW5jZSA9IG1hdGhfbWF4JDYobWF4QmFsYW5jZSwgYmFsYW5jZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVyYXRvclBvb2wucmVsZWFzZShpdCk7XG4gICAgICAgIHJldHVybiBtYXhCYWxhbmNlO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUucmVidWlsZEJvdHRvbVVwID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBub2RlcyA9IFtdO1xuICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgdmFyIGl0ID0gdGhpcy5pdGVyYXRvclBvb2wuYWxsb2NhdGUoKS5wcmVvcmRlcih0aGlzLm1fcm9vdCk7XG4gICAgICAgIHdoaWxlIChub2RlID0gaXQubmV4dCgpKSB7XG4gICAgICAgICAgaWYgKG5vZGUuaGVpZ2h0IDwgMCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChub2RlLmlzTGVhZigpKSB7XG4gICAgICAgICAgICBub2RlLnBhcmVudCA9IG51bGw7XG4gICAgICAgICAgICBub2Rlc1tjb3VudF0gPSBub2RlO1xuICAgICAgICAgICAgKytjb3VudDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5mcmVlTm9kZShub2RlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVyYXRvclBvb2wucmVsZWFzZShpdCk7XG4gICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHtcbiAgICAgICAgICB2YXIgbWluQ29zdCA9IEluZmluaXR5O1xuICAgICAgICAgIHZhciBpTWluID0gLTE7XG4gICAgICAgICAgdmFyIGpNaW4gPSAtMTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyArK2kpIHtcbiAgICAgICAgICAgIHZhciBhYWJiaSA9IG5vZGVzW2ldLmFhYmI7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gaSArIDE7IGogPCBjb3VudDsgKytqKSB7XG4gICAgICAgICAgICAgIHZhciBhYWJiaiA9IG5vZGVzW2pdLmFhYmI7XG4gICAgICAgICAgICAgIHZhciBjb3N0ID0gQUFCQi5jb21iaW5lZFBlcmltZXRlcihhYWJiaSwgYWFiYmopO1xuICAgICAgICAgICAgICBpZiAoY29zdCA8IG1pbkNvc3QpIHtcbiAgICAgICAgICAgICAgICBpTWluID0gaTtcbiAgICAgICAgICAgICAgICBqTWluID0gajtcbiAgICAgICAgICAgICAgICBtaW5Db3N0ID0gY29zdDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgY2hpbGQxID0gbm9kZXNbaU1pbl07XG4gICAgICAgICAgdmFyIGNoaWxkMiA9IG5vZGVzW2pNaW5dO1xuICAgICAgICAgIHZhciBwYXJlbnRfMSA9IHRoaXMuYWxsb2NhdGVOb2RlKCk7XG4gICAgICAgICAgcGFyZW50XzEuY2hpbGQxID0gY2hpbGQxO1xuICAgICAgICAgIHBhcmVudF8xLmNoaWxkMiA9IGNoaWxkMjtcbiAgICAgICAgICBwYXJlbnRfMS5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihjaGlsZDEuaGVpZ2h0LCBjaGlsZDIuaGVpZ2h0KTtcbiAgICAgICAgICBwYXJlbnRfMS5hYWJiLmNvbWJpbmUoY2hpbGQxLmFhYmIsIGNoaWxkMi5hYWJiKTtcbiAgICAgICAgICBwYXJlbnRfMS5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgIGNoaWxkMS5wYXJlbnQgPSBwYXJlbnRfMTtcbiAgICAgICAgICBjaGlsZDIucGFyZW50ID0gcGFyZW50XzE7XG4gICAgICAgICAgbm9kZXNbak1pbl0gPSBub2Rlc1tjb3VudCAtIDFdO1xuICAgICAgICAgIG5vZGVzW2lNaW5dID0gcGFyZW50XzE7XG4gICAgICAgICAgLS1jb3VudDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fcm9vdCA9IG5vZGVzWzBdO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuc2hpZnRPcmlnaW4gPSBmdW5jdGlvbihuZXdPcmlnaW4pIHtcbiAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgIHZhciBpdCA9IHRoaXMuaXRlcmF0b3JQb29sLmFsbG9jYXRlKCkucHJlb3JkZXIodGhpcy5tX3Jvb3QpO1xuICAgICAgICB3aGlsZSAobm9kZSA9IGl0Lm5leHQoKSkge1xuICAgICAgICAgIHZhciBhYWJiID0gbm9kZS5hYWJiO1xuICAgICAgICAgIGFhYmIubG93ZXJCb3VuZC54IC09IG5ld09yaWdpbi54O1xuICAgICAgICAgIGFhYmIubG93ZXJCb3VuZC55IC09IG5ld09yaWdpbi55O1xuICAgICAgICAgIGFhYmIudXBwZXJCb3VuZC54IC09IG5ld09yaWdpbi54O1xuICAgICAgICAgIGFhYmIudXBwZXJCb3VuZC55IC09IG5ld09yaWdpbi55O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXRlcmF0b3JQb29sLnJlbGVhc2UoaXQpO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUucXVlcnkgPSBmdW5jdGlvbihhYWJiLCBxdWVyeUNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBzdGFjayA9IHRoaXMuc3RhY2tQb29sLmFsbG9jYXRlKCk7XG4gICAgICAgIHN0YWNrLnB1c2godGhpcy5tX3Jvb3QpO1xuICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZhciBub2RlID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChBQUJCLnRlc3RPdmVybGFwKG5vZGUuYWFiYiwgYWFiYikpIHtcbiAgICAgICAgICAgIGlmIChub2RlLmlzTGVhZigpKSB7XG4gICAgICAgICAgICAgIHZhciBwcm9jZWVkID0gcXVlcnlDYWxsYmFjayhub2RlLmlkKTtcbiAgICAgICAgICAgICAgaWYgKHByb2NlZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzdGFjay5wdXNoKG5vZGUuY2hpbGQxKTtcbiAgICAgICAgICAgICAgc3RhY2sucHVzaChub2RlLmNoaWxkMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhY2tQb29sLnJlbGVhc2Uoc3RhY2spO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKGlucHV0MiwgcmF5Q2FzdENhbGxiYWNrKSB7XG4gICAgICAgIHZhciBwMSA9IGlucHV0Mi5wMTtcbiAgICAgICAgdmFyIHAyID0gaW5wdXQyLnAyO1xuICAgICAgICB2YXIgciA9IFZlYzIuc3ViKHAyLCBwMSk7XG4gICAgICAgIHIubm9ybWFsaXplKCk7XG4gICAgICAgIHZhciB2MyA9IFZlYzIuY3Jvc3NOdW1WZWMyKDEsIHIpO1xuICAgICAgICB2YXIgYWJzX3YgPSBWZWMyLmFicyh2Myk7XG4gICAgICAgIHZhciBtYXhGcmFjdGlvbiA9IGlucHV0Mi5tYXhGcmFjdGlvbjtcbiAgICAgICAgdmFyIHNlZ21lbnRBQUJCID0gbmV3IEFBQkIoKTtcbiAgICAgICAgdmFyIHQgPSBWZWMyLmNvbWJpbmUoMSAtIG1heEZyYWN0aW9uLCBwMSwgbWF4RnJhY3Rpb24sIHAyKTtcbiAgICAgICAgc2VnbWVudEFBQkIuY29tYmluZVBvaW50cyhwMSwgdCk7XG4gICAgICAgIHZhciBzdGFjayA9IHRoaXMuc3RhY2tQb29sLmFsbG9jYXRlKCk7XG4gICAgICAgIHZhciBzdWJJbnB1dCA9IHRoaXMuaW5wdXRQb29sLmFsbG9jYXRlKCk7XG4gICAgICAgIHN0YWNrLnB1c2godGhpcy5tX3Jvb3QpO1xuICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZhciBub2RlID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChBQUJCLnRlc3RPdmVybGFwKG5vZGUuYWFiYiwgc2VnbWVudEFBQkIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjMiA9IG5vZGUuYWFiYi5nZXRDZW50ZXIoKTtcbiAgICAgICAgICB2YXIgaCA9IG5vZGUuYWFiYi5nZXRFeHRlbnRzKCk7XG4gICAgICAgICAgdmFyIHNlcGFyYXRpb24gPSBtYXRoX2FicyQ4KFZlYzIuZG90KHYzLCBWZWMyLnN1YihwMSwgYzIpKSkgLSBWZWMyLmRvdChhYnNfdiwgaCk7XG4gICAgICAgICAgaWYgKHNlcGFyYXRpb24gPiAwKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG5vZGUuaXNMZWFmKCkpIHtcbiAgICAgICAgICAgIHN1YklucHV0LnAxID0gVmVjMi5jbG9uZShpbnB1dDIucDEpO1xuICAgICAgICAgICAgc3ViSW5wdXQucDIgPSBWZWMyLmNsb25lKGlucHV0Mi5wMik7XG4gICAgICAgICAgICBzdWJJbnB1dC5tYXhGcmFjdGlvbiA9IG1heEZyYWN0aW9uO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gcmF5Q2FzdENhbGxiYWNrKHN1YklucHV0LCBub2RlLmlkKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gMCkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPiAwKSB7XG4gICAgICAgICAgICAgIG1heEZyYWN0aW9uID0gdmFsdWU7XG4gICAgICAgICAgICAgIHQgPSBWZWMyLmNvbWJpbmUoMSAtIG1heEZyYWN0aW9uLCBwMSwgbWF4RnJhY3Rpb24sIHAyKTtcbiAgICAgICAgICAgICAgc2VnbWVudEFBQkIuY29tYmluZVBvaW50cyhwMSwgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0YWNrLnB1c2gobm9kZS5jaGlsZDEpO1xuICAgICAgICAgICAgc3RhY2sucHVzaChub2RlLmNoaWxkMik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhY2tQb29sLnJlbGVhc2Uoc3RhY2spO1xuICAgICAgICB0aGlzLmlucHV0UG9vbC5yZWxlYXNlKHN1YklucHV0KTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gRHluYW1pY1RyZWUyO1xuICAgIH0oKVxuICApO1xuICB2YXIgSXRlcmF0b3IgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gSXRlcmF0b3IyKCkge1xuICAgICAgICB0aGlzLnBhcmVudHMgPSBbXTtcbiAgICAgICAgdGhpcy5zdGF0ZXMgPSBbXTtcbiAgICAgIH1cbiAgICAgIEl0ZXJhdG9yMi5wcm90b3R5cGUucHJlb3JkZXIgPSBmdW5jdGlvbihyb290KSB7XG4gICAgICAgIHRoaXMucGFyZW50cy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLnBhcmVudHMucHVzaChyb290KTtcbiAgICAgICAgdGhpcy5zdGF0ZXMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5zdGF0ZXMucHVzaCgwKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgSXRlcmF0b3IyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHdoaWxlICh0aGlzLnBhcmVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZhciBpID0gdGhpcy5wYXJlbnRzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLnBhcmVudHNbaV07XG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGVzW2ldID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlc1tpXSA9IDE7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGVzW2ldID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlc1tpXSA9IDI7XG4gICAgICAgICAgICBpZiAobm9kZS5jaGlsZDEpIHtcbiAgICAgICAgICAgICAgdGhpcy5wYXJlbnRzLnB1c2gobm9kZS5jaGlsZDEpO1xuICAgICAgICAgICAgICB0aGlzLnN0YXRlcy5wdXNoKDEpO1xuICAgICAgICAgICAgICByZXR1cm4gbm9kZS5jaGlsZDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0aGlzLnN0YXRlc1tpXSA9PT0gMikge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZXNbaV0gPSAzO1xuICAgICAgICAgICAgaWYgKG5vZGUuY2hpbGQyKSB7XG4gICAgICAgICAgICAgIHRoaXMucGFyZW50cy5wdXNoKG5vZGUuY2hpbGQyKTtcbiAgICAgICAgICAgICAgdGhpcy5zdGF0ZXMucHVzaCgxKTtcbiAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuY2hpbGQyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnBhcmVudHMucG9wKCk7XG4gICAgICAgICAgdGhpcy5zdGF0ZXMucG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBJdGVyYXRvcjIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucGFyZW50cy5sZW5ndGggPSAwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBJdGVyYXRvcjI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX21heCQ1ID0gTWF0aC5tYXg7XG4gIHZhciBtYXRoX21pbiQ2ID0gTWF0aC5taW47XG4gIHZhciBCcm9hZFBoYXNlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEJyb2FkUGhhc2UyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLm1fdHJlZSA9IG5ldyBEeW5hbWljVHJlZSgpO1xuICAgICAgICB0aGlzLm1fbW92ZUJ1ZmZlciA9IFtdO1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gZnVuY3Rpb24oYWFiYiwgcXVlcnlDYWxsYmFjaykge1xuICAgICAgICAgIF90aGlzLm1fdHJlZS5xdWVyeShhYWJiLCBxdWVyeUNhbGxiYWNrKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5xdWVyeUNhbGxiYWNrID0gZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICAgIGlmIChwcm94eUlkID09PSBfdGhpcy5tX3F1ZXJ5UHJveHlJZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBwcm94eUlkQSA9IG1hdGhfbWluJDYocHJveHlJZCwgX3RoaXMubV9xdWVyeVByb3h5SWQpO1xuICAgICAgICAgIHZhciBwcm94eUlkQiA9IG1hdGhfbWF4JDUocHJveHlJZCwgX3RoaXMubV9xdWVyeVByb3h5SWQpO1xuICAgICAgICAgIHZhciB1c2VyRGF0YUEgPSBfdGhpcy5tX3RyZWUuZ2V0VXNlckRhdGEocHJveHlJZEEpO1xuICAgICAgICAgIHZhciB1c2VyRGF0YUIgPSBfdGhpcy5tX3RyZWUuZ2V0VXNlckRhdGEocHJveHlJZEIpO1xuICAgICAgICAgIF90aGlzLm1fY2FsbGJhY2sodXNlckRhdGFBLCB1c2VyRGF0YUIpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmdldFVzZXJEYXRhID0gZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RyZWUuZ2V0VXNlckRhdGEocHJveHlJZCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLnRlc3RPdmVybGFwID0gZnVuY3Rpb24ocHJveHlJZEEsIHByb3h5SWRCKSB7XG4gICAgICAgIHZhciBhYWJiQSA9IHRoaXMubV90cmVlLmdldEZhdEFBQkIocHJveHlJZEEpO1xuICAgICAgICB2YXIgYWFiYkIgPSB0aGlzLm1fdHJlZS5nZXRGYXRBQUJCKHByb3h5SWRCKTtcbiAgICAgICAgcmV0dXJuIEFBQkIudGVzdE92ZXJsYXAoYWFiYkEsIGFhYmJCKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuZ2V0RmF0QUFCQiA9IGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90cmVlLmdldEZhdEFBQkIocHJveHlJZCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmdldFByb3h5Q291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aDtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuZ2V0VHJlZUhlaWdodCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RyZWUuZ2V0SGVpZ2h0KCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmdldFRyZWVCYWxhbmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHJlZS5nZXRNYXhCYWxhbmNlKCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmdldFRyZWVRdWFsaXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHJlZS5nZXRBcmVhUmF0aW8oKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKGlucHV0MiwgcmF5Q2FzdENhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMubV90cmVlLnJheUNhc3QoaW5wdXQyLCByYXlDYXN0Q2FsbGJhY2spO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5zaGlmdE9yaWdpbiA9IGZ1bmN0aW9uKG5ld09yaWdpbikge1xuICAgICAgICB0aGlzLm1fdHJlZS5zaGlmdE9yaWdpbihuZXdPcmlnaW4pO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5jcmVhdGVQcm94eSA9IGZ1bmN0aW9uKGFhYmIsIHVzZXJEYXRhKSB7XG4gICAgICAgIHZhciBwcm94eUlkID0gdGhpcy5tX3RyZWUuY3JlYXRlUHJveHkoYWFiYiwgdXNlckRhdGEpO1xuICAgICAgICB0aGlzLmJ1ZmZlck1vdmUocHJveHlJZCk7XG4gICAgICAgIHJldHVybiBwcm94eUlkO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5kZXN0cm95UHJveHkgPSBmdW5jdGlvbihwcm94eUlkKSB7XG4gICAgICAgIHRoaXMudW5idWZmZXJNb3ZlKHByb3h5SWQpO1xuICAgICAgICB0aGlzLm1fdHJlZS5kZXN0cm95UHJveHkocHJveHlJZCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLm1vdmVQcm94eSA9IGZ1bmN0aW9uKHByb3h5SWQsIGFhYmIsIGRpc3BsYWNlbWVudDIpIHtcbiAgICAgICAgdmFyIGNoYW5nZWQgPSB0aGlzLm1fdHJlZS5tb3ZlUHJveHkocHJveHlJZCwgYWFiYiwgZGlzcGxhY2VtZW50Mik7XG4gICAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgICAgdGhpcy5idWZmZXJNb3ZlKHByb3h5SWQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLnRvdWNoUHJveHkgPSBmdW5jdGlvbihwcm94eUlkKSB7XG4gICAgICAgIHRoaXMuYnVmZmVyTW92ZShwcm94eUlkKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuYnVmZmVyTW92ZSA9IGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgdGhpcy5tX21vdmVCdWZmZXIucHVzaChwcm94eUlkKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUudW5idWZmZXJNb3ZlID0gZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgaWYgKHRoaXMubV9tb3ZlQnVmZmVyW2ldID09PSBwcm94eUlkKSB7XG4gICAgICAgICAgICB0aGlzLm1fbW92ZUJ1ZmZlcltpXSA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLnVwZGF0ZVBhaXJzID0gZnVuY3Rpb24oYWRkUGFpckNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMubV9jYWxsYmFjayA9IGFkZFBhaXJDYWxsYmFjaztcbiAgICAgICAgd2hpbGUgKHRoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fcXVlcnlQcm94eUlkID0gdGhpcy5tX21vdmVCdWZmZXIucG9wKCk7XG4gICAgICAgICAgaWYgKHRoaXMubV9xdWVyeVByb3h5SWQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgZmF0QUFCQiA9IHRoaXMubV90cmVlLmdldEZhdEFBQkIodGhpcy5tX3F1ZXJ5UHJveHlJZCk7XG4gICAgICAgICAgdGhpcy5tX3RyZWUucXVlcnkoZmF0QUFCQiwgdGhpcy5xdWVyeUNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHJldHVybiBCcm9hZFBoYXNlMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfc2luJDIgPSBNYXRoLnNpbjtcbiAgdmFyIG1hdGhfY29zJDIgPSBNYXRoLmNvcztcbiAgdmFyIG1hdGhfc3FydCQ0ID0gTWF0aC5zcXJ0O1xuICBmdW5jdGlvbiB2ZWMyKHgyLCB5KSB7XG4gICAgcmV0dXJuIHsgeDogeDIsIHkgfTtcbiAgfVxuICBmdW5jdGlvbiByb3RhdGlvbihhbmdsZSkge1xuICAgIHJldHVybiB7IHM6IG1hdGhfc2luJDIoYW5nbGUpLCBjOiBtYXRoX2NvcyQyKGFuZ2xlKSB9O1xuICB9XG4gIGZ1bmN0aW9uIHNldFZlYzIob3V0LCB4MiwgeSkge1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gY29weVZlYzIob3V0LCB3KSB7XG4gICAgb3V0LnggPSB3Lng7XG4gICAgb3V0LnkgPSB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiB6ZXJvVmVjMihvdXQpIHtcbiAgICBvdXQueCA9IDA7XG4gICAgb3V0LnkgPSAwO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gbmVnVmVjMihvdXQpIHtcbiAgICBvdXQueCA9IC1vdXQueDtcbiAgICBvdXQueSA9IC1vdXQueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHBsdXNWZWMyKG91dCwgdykge1xuICAgIG91dC54ICs9IHcueDtcbiAgICBvdXQueSArPSB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBhZGRWZWMyKG91dCwgdjMsIHcpIHtcbiAgICBvdXQueCA9IHYzLnggKyB3Lng7XG4gICAgb3V0LnkgPSB2My54ICsgdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gbWludXNWZWMyKG91dCwgdykge1xuICAgIG91dC54IC09IHcueDtcbiAgICBvdXQueSAtPSB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBzdWJWZWMyKG91dCwgdjMsIHcpIHtcbiAgICBvdXQueCA9IHYzLnggLSB3Lng7XG4gICAgb3V0LnkgPSB2My55IC0gdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gbXVsVmVjMihvdXQsIG0pIHtcbiAgICBvdXQueCAqPSBtO1xuICAgIG91dC55ICo9IG07XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBzY2FsZVZlYzIob3V0LCBtLCB3KSB7XG4gICAgb3V0LnggPSBtICogdy54O1xuICAgIG91dC55ID0gbSAqIHcueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHBsdXNTY2FsZVZlYzIob3V0LCBtLCB3KSB7XG4gICAgb3V0LnggKz0gbSAqIHcueDtcbiAgICBvdXQueSArPSBtICogdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gbWludXNTY2FsZVZlYzIob3V0LCBtLCB3KSB7XG4gICAgb3V0LnggLT0gbSAqIHcueDtcbiAgICBvdXQueSAtPSBtICogdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gY29tYmluZTJWZWMyKG91dCwgYW0sIGEyLCBibSwgYjIpIHtcbiAgICBvdXQueCA9IGFtICogYTIueCArIGJtICogYjIueDtcbiAgICBvdXQueSA9IGFtICogYTIueSArIGJtICogYjIueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGNvbWJpbmUzVmVjMihvdXQsIGFtLCBhMiwgYm0sIGIyLCBjbSwgYzIpIHtcbiAgICBvdXQueCA9IGFtICogYTIueCArIGJtICogYjIueCArIGNtICogYzIueDtcbiAgICBvdXQueSA9IGFtICogYTIueSArIGJtICogYjIueSArIGNtICogYzIueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZVZlYzJMZW5ndGgob3V0KSB7XG4gICAgdmFyIGxlbmd0aCA9IG1hdGhfc3FydCQ0KG91dC54ICogb3V0LnggKyBvdXQueSAqIG91dC55KTtcbiAgICBpZiAobGVuZ3RoICE9PSAwKSB7XG4gICAgICB2YXIgaW52TGVuZ3RoID0gMSAvIGxlbmd0aDtcbiAgICAgIG91dC54ICo9IGludkxlbmd0aDtcbiAgICAgIG91dC55ICo9IGludkxlbmd0aDtcbiAgICB9XG4gICAgcmV0dXJuIGxlbmd0aDtcbiAgfVxuICBmdW5jdGlvbiBub3JtYWxpemVWZWMyKG91dCkge1xuICAgIHZhciBsZW5ndGggPSBtYXRoX3NxcnQkNChvdXQueCAqIG91dC54ICsgb3V0LnkgKiBvdXQueSk7XG4gICAgaWYgKGxlbmd0aCA+IDApIHtcbiAgICAgIHZhciBpbnZMZW5ndGggPSAxIC8gbGVuZ3RoO1xuICAgICAgb3V0LnggKj0gaW52TGVuZ3RoO1xuICAgICAgb3V0LnkgKj0gaW52TGVuZ3RoO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGNyb3NzVmVjMk51bShvdXQsIHYzLCB3KSB7XG4gICAgdmFyIHgyID0gdyAqIHYzLnk7XG4gICAgdmFyIHkgPSAtdyAqIHYzLng7XG4gICAgb3V0LnggPSB4MjtcbiAgICBvdXQueSA9IHk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBjcm9zc051bVZlYzIob3V0LCB3LCB2Mykge1xuICAgIHZhciB4MiA9IC13ICogdjMueTtcbiAgICB2YXIgeSA9IHcgKiB2My54O1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gY3Jvc3NWZWMyVmVjMihhMiwgYjIpIHtcbiAgICByZXR1cm4gYTIueCAqIGIyLnkgLSBhMi55ICogYjIueDtcbiAgfVxuICBmdW5jdGlvbiBkb3RWZWMyKGEyLCBiMikge1xuICAgIHJldHVybiBhMi54ICogYjIueCArIGEyLnkgKiBiMi55O1xuICB9XG4gIGZ1bmN0aW9uIGxlbmd0aFNxclZlYzIoYTIpIHtcbiAgICByZXR1cm4gYTIueCAqIGEyLnggKyBhMi55ICogYTIueTtcbiAgfVxuICBmdW5jdGlvbiBkaXN0VmVjMihhMiwgYjIpIHtcbiAgICB2YXIgZHggPSBhMi54IC0gYjIueDtcbiAgICB2YXIgZHkgPSBhMi55IC0gYjIueTtcbiAgICByZXR1cm4gbWF0aF9zcXJ0JDQoZHggKiBkeCArIGR5ICogZHkpO1xuICB9XG4gIGZ1bmN0aW9uIGRpc3RTcXJWZWMyKGEyLCBiMikge1xuICAgIHZhciBkeCA9IGEyLnggLSBiMi54O1xuICAgIHZhciBkeSA9IGEyLnkgLSBiMi55O1xuICAgIHJldHVybiBkeCAqIGR4ICsgZHkgKiBkeTtcbiAgfVxuICBmdW5jdGlvbiBzZXRSb3RBbmdsZShvdXQsIGEyKSB7XG4gICAgb3V0LmMgPSBtYXRoX2NvcyQyKGEyKTtcbiAgICBvdXQucyA9IG1hdGhfc2luJDIoYTIpO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gcm90VmVjMihvdXQsIHEsIHYzKSB7XG4gICAgb3V0LnggPSBxLmMgKiB2My54IC0gcS5zICogdjMueTtcbiAgICBvdXQueSA9IHEucyAqIHYzLnggKyBxLmMgKiB2My55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gZGVyb3RWZWMyKG91dCwgcSwgdjMpIHtcbiAgICB2YXIgeDIgPSBxLmMgKiB2My54ICsgcS5zICogdjMueTtcbiAgICB2YXIgeSA9IC1xLnMgKiB2My54ICsgcS5jICogdjMueTtcbiAgICBvdXQueCA9IHgyO1xuICAgIG91dC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHJlcm90VmVjMihvdXQsIGJlZm9yZSwgYWZ0ZXIsIHYzKSB7XG4gICAgdmFyIHgwID0gYmVmb3JlLmMgKiB2My54ICsgYmVmb3JlLnMgKiB2My55O1xuICAgIHZhciB5MCA9IC1iZWZvcmUucyAqIHYzLnggKyBiZWZvcmUuYyAqIHYzLnk7XG4gICAgdmFyIHgyID0gYWZ0ZXIuYyAqIHgwIC0gYWZ0ZXIucyAqIHkwO1xuICAgIHZhciB5ID0gYWZ0ZXIucyAqIHgwICsgYWZ0ZXIuYyAqIHkwO1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gdHJhbnNmb3JtKHgyLCB5LCBhMikge1xuICAgIHJldHVybiB7IHA6IHZlYzIoeDIsIHkpLCBxOiByb3RhdGlvbihhMikgfTtcbiAgfVxuICBmdW5jdGlvbiBjb3B5VHJhbnNmb3JtKG91dCwgdHJhbnNmb3JtMikge1xuICAgIG91dC5wLnggPSB0cmFuc2Zvcm0yLnAueDtcbiAgICBvdXQucC55ID0gdHJhbnNmb3JtMi5wLnk7XG4gICAgb3V0LnEucyA9IHRyYW5zZm9ybTIucS5zO1xuICAgIG91dC5xLmMgPSB0cmFuc2Zvcm0yLnEuYztcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHRyYW5zZm9ybVZlYzIob3V0LCB4ZjIsIHYzKSB7XG4gICAgdmFyIHgyID0geGYyLnEuYyAqIHYzLnggLSB4ZjIucS5zICogdjMueSArIHhmMi5wLng7XG4gICAgdmFyIHkgPSB4ZjIucS5zICogdjMueCArIHhmMi5xLmMgKiB2My55ICsgeGYyLnAueTtcbiAgICBvdXQueCA9IHgyO1xuICAgIG91dC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGRldHJhbnNmb3JtVmVjMihvdXQsIHhmMiwgdjMpIHtcbiAgICB2YXIgcHggPSB2My54IC0geGYyLnAueDtcbiAgICB2YXIgcHkgPSB2My55IC0geGYyLnAueTtcbiAgICB2YXIgeDIgPSB4ZjIucS5jICogcHggKyB4ZjIucS5zICogcHk7XG4gICAgdmFyIHkgPSAteGYyLnEucyAqIHB4ICsgeGYyLnEuYyAqIHB5O1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gcmV0cmFuc2Zvcm1WZWMyKG91dCwgZnJvbSwgdG8sIHYzKSB7XG4gICAgdmFyIHgwID0gZnJvbS5xLmMgKiB2My54IC0gZnJvbS5xLnMgKiB2My55ICsgZnJvbS5wLng7XG4gICAgdmFyIHkwID0gZnJvbS5xLnMgKiB2My54ICsgZnJvbS5xLmMgKiB2My55ICsgZnJvbS5wLnk7XG4gICAgdmFyIHB4ID0geDAgLSB0by5wLng7XG4gICAgdmFyIHB5ID0geTAgLSB0by5wLnk7XG4gICAgdmFyIHgyID0gdG8ucS5jICogcHggKyB0by5xLnMgKiBweTtcbiAgICB2YXIgeSA9IC10by5xLnMgKiBweCArIHRvLnEuYyAqIHB5O1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gZGV0cmFuc2Zvcm1UcmFuc2Zvcm0ob3V0LCBhMiwgYjIpIHtcbiAgICB2YXIgYzIgPSBhMi5xLmMgKiBiMi5xLmMgKyBhMi5xLnMgKiBiMi5xLnM7XG4gICAgdmFyIHMyID0gYTIucS5jICogYjIucS5zIC0gYTIucS5zICogYjIucS5jO1xuICAgIHZhciB4MiA9IGEyLnEuYyAqIChiMi5wLnggLSBhMi5wLngpICsgYTIucS5zICogKGIyLnAueSAtIGEyLnAueSk7XG4gICAgdmFyIHkgPSAtYTIucS5zICogKGIyLnAueCAtIGEyLnAueCkgKyBhMi5xLmMgKiAoYjIucC55IC0gYTIucC55KTtcbiAgICBvdXQucS5jID0gYzI7XG4gICAgb3V0LnEucyA9IHMyO1xuICAgIG91dC5wLnggPSB4MjtcbiAgICBvdXQucC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIHZhciBtYXRoX3NpbiQxID0gTWF0aC5zaW47XG4gIHZhciBtYXRoX2NvcyQxID0gTWF0aC5jb3M7XG4gIHZhciBtYXRoX2F0YW4yJDEgPSBNYXRoLmF0YW4yO1xuICB2YXIgUm90ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFJvdDIoYW5nbGUpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFJvdDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBSb3QyKGFuZ2xlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGFuZ2xlID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgdGhpcy5zZXRBbmdsZShhbmdsZSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFuZ2xlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy5zZXRSb3QoYW5nbGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2V0SWRlbnRpdHkoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgUm90Mi5uZW8gPSBmdW5jdGlvbihhbmdsZSkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShSb3QyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5zZXRBbmdsZShhbmdsZSk7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgUm90Mi5jbG9uZSA9IGZ1bmN0aW9uKHJvdCkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShSb3QyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5zID0gcm90LnM7XG4gICAgICAgIG9iai5jID0gcm90LmM7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgUm90Mi5pZGVudGl0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShSb3QyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5zID0gMDtcbiAgICAgICAgb2JqLmMgPSAxO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFJvdDIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShvYmoucykgJiYgTnVtYmVyLmlzRmluaXRlKG9iai5jKTtcbiAgICAgIH07XG4gICAgICBSb3QyLmFzc2VydCA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIH07XG4gICAgICBSb3QyLnByb3RvdHlwZS5zZXRJZGVudGl0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnMgPSAwO1xuICAgICAgICB0aGlzLmMgPSAxO1xuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKGFuZ2xlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYW5nbGUgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLnMgPSBhbmdsZS5zO1xuICAgICAgICAgIHRoaXMuYyA9IGFuZ2xlLmM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5zID0gbWF0aF9zaW4kMShhbmdsZSk7XG4gICAgICAgICAgdGhpcy5jID0gbWF0aF9jb3MkMShhbmdsZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSb3QyLnByb3RvdHlwZS5zZXRSb3QgPSBmdW5jdGlvbihhbmdsZSkge1xuICAgICAgICB0aGlzLnMgPSBhbmdsZS5zO1xuICAgICAgICB0aGlzLmMgPSBhbmdsZS5jO1xuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLnNldEFuZ2xlID0gZnVuY3Rpb24oYW5nbGUpIHtcbiAgICAgICAgdGhpcy5zID0gbWF0aF9zaW4kMShhbmdsZSk7XG4gICAgICAgIHRoaXMuYyA9IG1hdGhfY29zJDEoYW5nbGUpO1xuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLmdldEFuZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBtYXRoX2F0YW4yJDEodGhpcy5zLCB0aGlzLmMpO1xuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLmdldFhBeGlzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh0aGlzLmMsIHRoaXMucyk7XG4gICAgICB9O1xuICAgICAgUm90Mi5wcm90b3R5cGUuZ2V0WUF4aXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKC10aGlzLnMsIHRoaXMuYyk7XG4gICAgICB9O1xuICAgICAgUm90Mi5tdWwgPSBmdW5jdGlvbihyb3QsIG0pIHtcbiAgICAgICAgaWYgKFwiY1wiIGluIG0gJiYgXCJzXCIgaW4gbSkge1xuICAgICAgICAgIHZhciBxciA9IFJvdDIuaWRlbnRpdHkoKTtcbiAgICAgICAgICBxci5zID0gcm90LnMgKiBtLmMgKyByb3QuYyAqIG0ucztcbiAgICAgICAgICBxci5jID0gcm90LmMgKiBtLmMgLSByb3QucyAqIG0ucztcbiAgICAgICAgICByZXR1cm4gcXI7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJ4XCIgaW4gbSAmJiBcInlcIiBpbiBtKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIubmVvKHJvdC5jICogbS54IC0gcm90LnMgKiBtLnksIHJvdC5zICogbS54ICsgcm90LmMgKiBtLnkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUm90Mi5tdWxSb3QgPSBmdW5jdGlvbihyb3QsIG0pIHtcbiAgICAgICAgdmFyIHFyID0gUm90Mi5pZGVudGl0eSgpO1xuICAgICAgICBxci5zID0gcm90LnMgKiBtLmMgKyByb3QuYyAqIG0ucztcbiAgICAgICAgcXIuYyA9IHJvdC5jICogbS5jIC0gcm90LnMgKiBtLnM7XG4gICAgICAgIHJldHVybiBxcjtcbiAgICAgIH07XG4gICAgICBSb3QyLm11bFZlYzIgPSBmdW5jdGlvbihyb3QsIG0pIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHJvdC5jICogbS54IC0gcm90LnMgKiBtLnksIHJvdC5zICogbS54ICsgcm90LmMgKiBtLnkpO1xuICAgICAgfTtcbiAgICAgIFJvdDIubXVsU3ViID0gZnVuY3Rpb24ocm90LCB2Mywgdykge1xuICAgICAgICB2YXIgeDIgPSByb3QuYyAqICh2My54IC0gdy54KSAtIHJvdC5zICogKHYzLnkgLSB3LnkpO1xuICAgICAgICB2YXIgeSA9IHJvdC5zICogKHYzLnggLSB3LngpICsgcm90LmMgKiAodjMueSAtIHcueSk7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh4MiwgeSk7XG4gICAgICB9O1xuICAgICAgUm90Mi5tdWxUID0gZnVuY3Rpb24ocm90LCBtKSB7XG4gICAgICAgIGlmIChcImNcIiBpbiBtICYmIFwic1wiIGluIG0pIHtcbiAgICAgICAgICB2YXIgcXIgPSBSb3QyLmlkZW50aXR5KCk7XG4gICAgICAgICAgcXIucyA9IHJvdC5jICogbS5zIC0gcm90LnMgKiBtLmM7XG4gICAgICAgICAgcXIuYyA9IHJvdC5jICogbS5jICsgcm90LnMgKiBtLnM7XG4gICAgICAgICAgcmV0dXJuIHFyO1xuICAgICAgICB9IGVsc2UgaWYgKFwieFwiIGluIG0gJiYgXCJ5XCIgaW4gbSkge1xuICAgICAgICAgIHJldHVybiBWZWMyLm5lbyhyb3QuYyAqIG0ueCArIHJvdC5zICogbS55LCAtcm90LnMgKiBtLnggKyByb3QuYyAqIG0ueSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSb3QyLm11bFRSb3QgPSBmdW5jdGlvbihyb3QsIG0pIHtcbiAgICAgICAgdmFyIHFyID0gUm90Mi5pZGVudGl0eSgpO1xuICAgICAgICBxci5zID0gcm90LmMgKiBtLnMgLSByb3QucyAqIG0uYztcbiAgICAgICAgcXIuYyA9IHJvdC5jICogbS5jICsgcm90LnMgKiBtLnM7XG4gICAgICAgIHJldHVybiBxcjtcbiAgICAgIH07XG4gICAgICBSb3QyLm11bFRWZWMyID0gZnVuY3Rpb24ocm90LCBtKSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyhyb3QuYyAqIG0ueCArIHJvdC5zICogbS55LCAtcm90LnMgKiBtLnggKyByb3QuYyAqIG0ueSk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFJvdDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX2F0YW4yID0gTWF0aC5hdGFuMjtcbiAgdmFyIG1hdGhfUEkkNSA9IE1hdGguUEk7XG4gIHZhciB0ZW1wJDcgPSB2ZWMyKDAsIDApO1xuICB2YXIgU3dlZXAgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU3dlZXAyKCkge1xuICAgICAgICB0aGlzLmxvY2FsQ2VudGVyID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMuYyA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLmEgPSAwO1xuICAgICAgICB0aGlzLmFscGhhMCA9IDA7XG4gICAgICAgIHRoaXMuYzAgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5hMCA9IDA7XG4gICAgICB9XG4gICAgICBTd2VlcDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5sb2NhbENlbnRlcik7XG4gICAgICAgIHplcm9WZWMyKHRoaXMuYyk7XG4gICAgICAgIHRoaXMuYSA9IDA7XG4gICAgICAgIHRoaXMuYWxwaGEwID0gMDtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5jMCk7XG4gICAgICAgIHRoaXMuYTAgPSAwO1xuICAgICAgfTtcbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUuc2V0VHJhbnNmb3JtID0gZnVuY3Rpb24oeGYyKSB7XG4gICAgICAgIHRyYW5zZm9ybVZlYzIodGVtcCQ3LCB4ZjIsIHRoaXMubG9jYWxDZW50ZXIpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmMsIHRlbXAkNyk7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMuYzAsIHRlbXAkNyk7XG4gICAgICAgIHRoaXMuYSA9IHRoaXMuYTAgPSBtYXRoX2F0YW4yKHhmMi5xLnMsIHhmMi5xLmMpO1xuICAgICAgfTtcbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUuc2V0TG9jYWxDZW50ZXIgPSBmdW5jdGlvbihsb2NhbENlbnRlcjIsIHhmMikge1xuICAgICAgICBjb3B5VmVjMih0aGlzLmxvY2FsQ2VudGVyLCBsb2NhbENlbnRlcjIpO1xuICAgICAgICB0cmFuc2Zvcm1WZWMyKHRlbXAkNywgeGYyLCB0aGlzLmxvY2FsQ2VudGVyKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5jLCB0ZW1wJDcpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmMwLCB0ZW1wJDcpO1xuICAgICAgfTtcbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUuZ2V0VHJhbnNmb3JtID0gZnVuY3Rpb24oeGYyLCBiZXRhKSB7XG4gICAgICAgIGlmIChiZXRhID09PSB2b2lkIDApIHtcbiAgICAgICAgICBiZXRhID0gMDtcbiAgICAgICAgfVxuICAgICAgICBzZXRSb3RBbmdsZSh4ZjIucSwgKDEgLSBiZXRhKSAqIHRoaXMuYTAgKyBiZXRhICogdGhpcy5hKTtcbiAgICAgICAgY29tYmluZTJWZWMyKHhmMi5wLCAxIC0gYmV0YSwgdGhpcy5jMCwgYmV0YSwgdGhpcy5jKTtcbiAgICAgICAgbWludXNWZWMyKHhmMi5wLCByb3RWZWMyKHRlbXAkNywgeGYyLnEsIHRoaXMubG9jYWxDZW50ZXIpKTtcbiAgICAgIH07XG4gICAgICBTd2VlcDIucHJvdG90eXBlLmFkdmFuY2UgPSBmdW5jdGlvbihhbHBoYSkge1xuICAgICAgICB2YXIgYmV0YSA9IChhbHBoYSAtIHRoaXMuYWxwaGEwKSAvICgxIC0gdGhpcy5hbHBoYTApO1xuICAgICAgICBjb21iaW5lMlZlYzIodGhpcy5jMCwgYmV0YSwgdGhpcy5jLCAxIC0gYmV0YSwgdGhpcy5jMCk7XG4gICAgICAgIHRoaXMuYTAgPSBiZXRhICogdGhpcy5hICsgKDEgLSBiZXRhKSAqIHRoaXMuYTA7XG4gICAgICAgIHRoaXMuYWxwaGEwID0gYWxwaGE7XG4gICAgICB9O1xuICAgICAgU3dlZXAyLnByb3RvdHlwZS5mb3J3YXJkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYTAgPSB0aGlzLmE7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMuYzAsIHRoaXMuYyk7XG4gICAgICB9O1xuICAgICAgU3dlZXAyLnByb3RvdHlwZS5ub3JtYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGEwID0gbW9kKHRoaXMuYTAsIC1tYXRoX1BJJDUsICttYXRoX1BJJDUpO1xuICAgICAgICB0aGlzLmEgLT0gdGhpcy5hMCAtIGEwO1xuICAgICAgICB0aGlzLmEwID0gYTA7XG4gICAgICB9O1xuICAgICAgU3dlZXAyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih0aGF0KSB7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMubG9jYWxDZW50ZXIsIHRoYXQubG9jYWxDZW50ZXIpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmMsIHRoYXQuYyk7XG4gICAgICAgIHRoaXMuYSA9IHRoYXQuYTtcbiAgICAgICAgdGhpcy5hbHBoYTAgPSB0aGF0LmFscGhhMDtcbiAgICAgICAgY29weVZlYzIodGhpcy5jMCwgdGhhdC5jMCk7XG4gICAgICAgIHRoaXMuYTAgPSB0aGF0LmEwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTd2VlcDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBUcmFuc2Zvcm0gPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVHJhbnNmb3JtMihwb3NpdGlvbiwgcm90YXRpb24yKSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBUcmFuc2Zvcm0yKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgVHJhbnNmb3JtMihwb3NpdGlvbiwgcm90YXRpb24yKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnAgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5xID0gUm90LmlkZW50aXR5KCk7XG4gICAgICAgIGlmICh0eXBlb2YgcG9zaXRpb24gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0aGlzLnAuc2V0VmVjMihwb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiByb3RhdGlvbjIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0aGlzLnEuc2V0QW5nbGUocm90YXRpb24yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgVHJhbnNmb3JtMi5jbG9uZSA9IGZ1bmN0aW9uKHhmMikge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShUcmFuc2Zvcm0yLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5wID0gVmVjMi5jbG9uZSh4ZjIucCk7XG4gICAgICAgIG9iai5xID0gUm90LmNsb25lKHhmMi5xKTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm5lbyA9IGZ1bmN0aW9uKHBvc2l0aW9uLCByb3RhdGlvbjIpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVHJhbnNmb3JtMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoucCA9IFZlYzIuY2xvbmUocG9zaXRpb24pO1xuICAgICAgICBvYmoucSA9IFJvdC5jbG9uZShyb3RhdGlvbjIpO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIuaWRlbnRpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVHJhbnNmb3JtMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoucCA9IFZlYzIuemVybygpO1xuICAgICAgICBvYmoucSA9IFJvdC5pZGVudGl0eSgpO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIucHJvdG90eXBlLnNldElkZW50aXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucC5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMucS5zZXRJZGVudGl0eSgpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICBpZiAodHlwZW9mIGIyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgdGhpcy5wLnNldChhMi5wKTtcbiAgICAgICAgICB0aGlzLnEuc2V0KGEyLnEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucC5zZXQoYTIpO1xuICAgICAgICAgIHRoaXMucS5zZXQoYjIpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5wcm90b3R5cGUuc2V0TnVtID0gZnVuY3Rpb24ocG9zaXRpb24sIHJvdGF0aW9uMikge1xuICAgICAgICB0aGlzLnAuc2V0VmVjMihwb3NpdGlvbik7XG4gICAgICAgIHRoaXMucS5zZXRBbmdsZShyb3RhdGlvbjIpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIucHJvdG90eXBlLnNldFRyYW5zZm9ybSA9IGZ1bmN0aW9uKHhmMikge1xuICAgICAgICB0aGlzLnAuc2V0VmVjMih4ZjIucCk7XG4gICAgICAgIHRoaXMucS5zZXRSb3QoeGYyLnEpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFZlYzIuaXNWYWxpZChvYmoucCkgJiYgUm90LmlzVmFsaWQob2JqLnEpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIuYXNzZXJ0ID0gZnVuY3Rpb24obykge1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGIyKSkge1xuICAgICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcnJbaV0gPSBUcmFuc2Zvcm0yLm11bChhMiwgYjJbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgICB9IGVsc2UgaWYgKFwieFwiIGluIGIyICYmIFwieVwiIGluIGIyKSB7XG4gICAgICAgICAgcmV0dXJuIFRyYW5zZm9ybTIubXVsVmVjMihhMiwgYjIpO1xuICAgICAgICB9IGVsc2UgaWYgKFwicFwiIGluIGIyICYmIFwicVwiIGluIGIyKSB7XG4gICAgICAgICAgcmV0dXJuIFRyYW5zZm9ybTIubXVsWGYoYTIsIGIyKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsQWxsID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiMi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGFycltpXSA9IFRyYW5zZm9ybTIubXVsKGEyLCBiMltpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm11bEZuID0gZnVuY3Rpb24oYTIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGIyKSB7XG4gICAgICAgICAgcmV0dXJuIFRyYW5zZm9ybTIubXVsKGEyLCBiMik7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5tdWxWZWMyID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciB4MiA9IGEyLnEuYyAqIGIyLnggLSBhMi5xLnMgKiBiMi55ICsgYTIucC54O1xuICAgICAgICB2YXIgeSA9IGEyLnEucyAqIGIyLnggKyBhMi5xLmMgKiBiMi55ICsgYTIucC55O1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsWGYgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIHhmMiA9IFRyYW5zZm9ybTIuaWRlbnRpdHkoKTtcbiAgICAgICAgeGYyLnEgPSBSb3QubXVsUm90KGEyLnEsIGIyLnEpO1xuICAgICAgICB4ZjIucCA9IFZlYzIuYWRkKFJvdC5tdWxWZWMyKGEyLnEsIGIyLnApLCBhMi5wKTtcbiAgICAgICAgcmV0dXJuIHhmMjtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm11bFQgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgaWYgKFwieFwiIGluIGIyICYmIFwieVwiIGluIGIyKSB7XG4gICAgICAgICAgcmV0dXJuIFRyYW5zZm9ybTIubXVsVFZlYzIoYTIsIGIyKTtcbiAgICAgICAgfSBlbHNlIGlmIChcInBcIiBpbiBiMiAmJiBcInFcIiBpbiBiMikge1xuICAgICAgICAgIHJldHVybiBUcmFuc2Zvcm0yLm11bFRYZihhMiwgYjIpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5tdWxUVmVjMiA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgcHggPSBiMi54IC0gYTIucC54O1xuICAgICAgICB2YXIgcHkgPSBiMi55IC0gYTIucC55O1xuICAgICAgICB2YXIgeDIgPSBhMi5xLmMgKiBweCArIGEyLnEucyAqIHB5O1xuICAgICAgICB2YXIgeSA9IC1hMi5xLnMgKiBweCArIGEyLnEuYyAqIHB5O1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsVFhmID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciB4ZjIgPSBUcmFuc2Zvcm0yLmlkZW50aXR5KCk7XG4gICAgICAgIHhmMi5xLnNldFJvdChSb3QubXVsVFJvdChhMi5xLCBiMi5xKSk7XG4gICAgICAgIHhmMi5wLnNldFZlYzIoUm90Lm11bFRWZWMyKGEyLnEsIFZlYzIuc3ViKGIyLnAsIGEyLnApKSk7XG4gICAgICAgIHJldHVybiB4ZjI7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFRyYW5zZm9ybTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBWZWxvY2l0eSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVmVsb2NpdHkyKCkge1xuICAgICAgICB0aGlzLnYgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy53ID0gMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBWZWxvY2l0eTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX3NpbiA9IE1hdGguc2luO1xuICB2YXIgbWF0aF9jb3MgPSBNYXRoLmNvcztcbiAgdmFyIFBvc2l0aW9uID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFBvc2l0aW9uMigpIHtcbiAgICAgICAgdGhpcy5jID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMuYSA9IDA7XG4gICAgICB9XG4gICAgICBQb3NpdGlvbjIucHJvdG90eXBlLmdldFRyYW5zZm9ybSA9IGZ1bmN0aW9uKHhmMiwgcCkge1xuICAgICAgICB4ZjIucS5jID0gbWF0aF9jb3ModGhpcy5hKTtcbiAgICAgICAgeGYyLnEucyA9IG1hdGhfc2luKHRoaXMuYSk7XG4gICAgICAgIHhmMi5wLnggPSB0aGlzLmMueCAtICh4ZjIucS5jICogcC54IC0geGYyLnEucyAqIHAueSk7XG4gICAgICAgIHhmMi5wLnkgPSB0aGlzLmMueSAtICh4ZjIucS5zICogcC54ICsgeGYyLnEuYyAqIHAueSk7XG4gICAgICAgIHJldHVybiB4ZjI7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFBvc2l0aW9uMjtcbiAgICB9KClcbiAgKTtcbiAgZnVuY3Rpb24gZ2V0VHJhbnNmb3JtKHhmMiwgcCwgYzIsIGEyKSB7XG4gICAgeGYyLnEuYyA9IG1hdGhfY29zKGEyKTtcbiAgICB4ZjIucS5zID0gbWF0aF9zaW4oYTIpO1xuICAgIHhmMi5wLnggPSBjMi54IC0gKHhmMi5xLmMgKiBwLnggLSB4ZjIucS5zICogcC55KTtcbiAgICB4ZjIucC55ID0gYzIueSAtICh4ZjIucS5zICogcC54ICsgeGYyLnEuYyAqIHAueSk7XG4gICAgcmV0dXJuIHhmMjtcbiAgfVxuICB2YXIgU2hhcGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2hhcGUyKCkge1xuICAgICAgICB0aGlzLnN0eWxlID0ge307XG4gICAgICAgIHRoaXMuYXBwRGF0YSA9IHt9O1xuICAgICAgfVxuICAgICAgU2hhcGUyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0eXBlb2Ygb2JqLm1fdHlwZSA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2Ygb2JqLm1fcmFkaXVzID09PSBcIm51bWJlclwiO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTaGFwZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBzeW5jaHJvbml6ZV9hYWJiMSA9IG5ldyBBQUJCKCk7XG4gIHZhciBzeW5jaHJvbml6ZV9hYWJiMiA9IG5ldyBBQUJCKCk7XG4gIHZhciBkaXNwbGFjZW1lbnQgPSB2ZWMyKDAsIDApO1xuICB2YXIgRml4dHVyZURlZkRlZmF1bHQgPSB7XG4gICAgdXNlckRhdGE6IG51bGwsXG4gICAgZnJpY3Rpb246IDAuMixcbiAgICByZXN0aXR1dGlvbjogMCxcbiAgICBkZW5zaXR5OiAwLFxuICAgIGlzU2Vuc29yOiBmYWxzZSxcbiAgICBmaWx0ZXJHcm91cEluZGV4OiAwLFxuICAgIGZpbHRlckNhdGVnb3J5Qml0czogMSxcbiAgICBmaWx0ZXJNYXNrQml0czogNjU1MzVcbiAgfTtcbiAgdmFyIEZpeHR1cmVQcm94eSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRml4dHVyZVByb3h5MihmaXh0dXJlLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7XG4gICAgICAgIHRoaXMuZml4dHVyZSA9IGZpeHR1cmU7XG4gICAgICAgIHRoaXMuY2hpbGRJbmRleCA9IGNoaWxkSW5kZXg7XG4gICAgICB9XG4gICAgICByZXR1cm4gRml4dHVyZVByb3h5MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIEZpeHR1cmUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRml4dHVyZTIoYm9keSwgc2hhcGUsIGRlZikge1xuICAgICAgICB0aGlzLnN0eWxlID0ge307XG4gICAgICAgIHRoaXMuYXBwRGF0YSA9IHt9O1xuICAgICAgICBpZiAoc2hhcGUuc2hhcGUpIHtcbiAgICAgICAgICBkZWYgPSBzaGFwZTtcbiAgICAgICAgICBzaGFwZSA9IHNoYXBlLnNoYXBlO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZWYgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICBkZWYgPSB7IGRlbnNpdHk6IGRlZiB9O1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBGaXh0dXJlRGVmRGVmYXVsdCk7XG4gICAgICAgIHRoaXMubV9ib2R5ID0gYm9keTtcbiAgICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gZGVmLmZyaWN0aW9uO1xuICAgICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSBkZWYucmVzdGl0dXRpb247XG4gICAgICAgIHRoaXMubV9kZW5zaXR5ID0gZGVmLmRlbnNpdHk7XG4gICAgICAgIHRoaXMubV9pc1NlbnNvciA9IGRlZi5pc1NlbnNvcjtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXggPSBkZWYuZmlsdGVyR3JvdXBJbmRleDtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckNhdGVnb3J5Qml0cyA9IGRlZi5maWx0ZXJDYXRlZ29yeUJpdHM7XG4gICAgICAgIHRoaXMubV9maWx0ZXJNYXNrQml0cyA9IGRlZi5maWx0ZXJNYXNrQml0cztcbiAgICAgICAgdGhpcy5tX3NoYXBlID0gc2hhcGU7XG4gICAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3Byb3hpZXMgPSBbXTtcbiAgICAgICAgdGhpcy5tX3Byb3h5Q291bnQgPSAwO1xuICAgICAgICB2YXIgY2hpbGRDb3VudCA9IHRoaXMubV9zaGFwZS5nZXRDaGlsZENvdW50KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRDb3VudDsgKytpKSB7XG4gICAgICAgICAgdGhpcy5tX3Byb3hpZXNbaV0gPSBuZXcgRml4dHVyZVByb3h5KHRoaXMsIGkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRlZi51c2VyRGF0YTtcbiAgICAgICAgaWYgKHR5cGVvZiBkZWYuc3R5bGUgPT09IFwib2JqZWN0XCIgJiYgZGVmLnN0eWxlICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5zdHlsZSA9IGRlZi5zdHlsZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgRml4dHVyZTIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYm9keSA9IHRoaXMuZ2V0Qm9keSgpO1xuICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IGJvZHkubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgIHRoaXMuZGVzdHJveVByb3hpZXMoYnJvYWRQaGFzZSk7XG4gICAgICAgIGlmICh0aGlzLm1fc2hhcGUuX3Jlc2V0KSB7XG4gICAgICAgICAgdGhpcy5tX3NoYXBlLl9yZXNldCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGlsZENvdW50ID0gdGhpcy5tX3NoYXBlLmdldENoaWxkQ291bnQoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZENvdW50OyArK2kpIHtcbiAgICAgICAgICB0aGlzLm1fcHJveGllc1tpXSA9IG5ldyBGaXh0dXJlUHJveHkodGhpcywgaSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jcmVhdGVQcm94aWVzKGJyb2FkUGhhc2UsIGJvZHkubV94Zik7XG4gICAgICAgIGJvZHkucmVzZXRNYXNzRGF0YSgpO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZnJpY3Rpb246IHRoaXMubV9mcmljdGlvbixcbiAgICAgICAgICByZXN0aXR1dGlvbjogdGhpcy5tX3Jlc3RpdHV0aW9uLFxuICAgICAgICAgIGRlbnNpdHk6IHRoaXMubV9kZW5zaXR5LFxuICAgICAgICAgIGlzU2Vuc29yOiB0aGlzLm1faXNTZW5zb3IsXG4gICAgICAgICAgZmlsdGVyR3JvdXBJbmRleDogdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXgsXG4gICAgICAgICAgZmlsdGVyQ2F0ZWdvcnlCaXRzOiB0aGlzLm1fZmlsdGVyQ2F0ZWdvcnlCaXRzLFxuICAgICAgICAgIGZpbHRlck1hc2tCaXRzOiB0aGlzLm1fZmlsdGVyTWFza0JpdHMsXG4gICAgICAgICAgc2hhcGU6IHRoaXMubV9zaGFwZVxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIGJvZHksIHJlc3RvcmUpIHtcbiAgICAgICAgdmFyIHNoYXBlID0gcmVzdG9yZShTaGFwZSwgZGF0YS5zaGFwZSk7XG4gICAgICAgIHZhciBmaXh0dXJlID0gc2hhcGUgJiYgbmV3IEZpeHR1cmUyKGJvZHksIHNoYXBlLCBkYXRhKTtcbiAgICAgICAgcmV0dXJuIGZpeHR1cmU7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9zaGFwZS5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldFNoYXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc2hhcGU7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmlzU2Vuc29yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1faXNTZW5zb3I7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldFNlbnNvciA9IGZ1bmN0aW9uKHNlbnNvcikge1xuICAgICAgICBpZiAoc2Vuc29yICE9IHRoaXMubV9pc1NlbnNvcikge1xuICAgICAgICAgIHRoaXMubV9ib2R5LnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9pc1NlbnNvciA9IHNlbnNvcjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3VzZXJEYXRhO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgdGhpcy5tX3VzZXJEYXRhID0gZGF0YTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0Qm9keSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldE5leHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXREZW5zaXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZGVuc2l0eTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0RGVuc2l0eSA9IGZ1bmN0aW9uKGRlbnNpdHkpIHtcbiAgICAgICAgdGhpcy5tX2RlbnNpdHkgPSBkZW5zaXR5O1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRGcmljdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZyaWN0aW9uO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRGcmljdGlvbiA9IGZ1bmN0aW9uKGZyaWN0aW9uKSB7XG4gICAgICAgIHRoaXMubV9mcmljdGlvbiA9IGZyaWN0aW9uO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3Jlc3RpdHV0aW9uO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uKHJlc3RpdHV0aW9uKSB7XG4gICAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IHJlc3RpdHV0aW9uO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS50ZXN0UG9pbnQgPSBmdW5jdGlvbihwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc2hhcGUudGVzdFBvaW50KHRoaXMubV9ib2R5LmdldFRyYW5zZm9ybSgpLCBwKTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0MiwgY2hpbGRJbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3NoYXBlLnJheUNhc3Qob3V0cHV0MiwgaW5wdXQyLCB0aGlzLm1fYm9keS5nZXRUcmFuc2Zvcm0oKSwgY2hpbGRJbmRleCk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldE1hc3NEYXRhID0gZnVuY3Rpb24obWFzc0RhdGEpIHtcbiAgICAgICAgdGhpcy5tX3NoYXBlLmNvbXB1dGVNYXNzKG1hc3NEYXRhLCB0aGlzLm1fZGVuc2l0eSk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldEFBQkIgPSBmdW5jdGlvbihjaGlsZEluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcHJveGllc1tjaGlsZEluZGV4XS5hYWJiO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5jcmVhdGVQcm94aWVzID0gZnVuY3Rpb24oYnJvYWRQaGFzZSwgeGYyKSB7XG4gICAgICAgIHRoaXMubV9wcm94eUNvdW50ID0gdGhpcy5tX3NoYXBlLmdldENoaWxkQ291bnQoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fcHJveHlDb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIHByb3h5ID0gdGhpcy5tX3Byb3hpZXNbaV07XG4gICAgICAgICAgdGhpcy5tX3NoYXBlLmNvbXB1dGVBQUJCKHByb3h5LmFhYmIsIHhmMiwgaSk7XG4gICAgICAgICAgcHJveHkucHJveHlJZCA9IGJyb2FkUGhhc2UuY3JlYXRlUHJveHkocHJveHkuYWFiYiwgcHJveHkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmRlc3Ryb3lQcm94aWVzID0gZnVuY3Rpb24oYnJvYWRQaGFzZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9wcm94eUNvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgcHJveHkgPSB0aGlzLm1fcHJveGllc1tpXTtcbiAgICAgICAgICBicm9hZFBoYXNlLmRlc3Ryb3lQcm94eShwcm94eS5wcm94eUlkKTtcbiAgICAgICAgICBwcm94eS5wcm94eUlkID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fcHJveHlDb3VudCA9IDA7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnN5bmNocm9uaXplID0gZnVuY3Rpb24oYnJvYWRQaGFzZSwgeGYxLCB4ZjIpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fcHJveHlDb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIHByb3h5ID0gdGhpcy5tX3Byb3hpZXNbaV07XG4gICAgICAgICAgdGhpcy5tX3NoYXBlLmNvbXB1dGVBQUJCKHN5bmNocm9uaXplX2FhYmIxLCB4ZjEsIHByb3h5LmNoaWxkSW5kZXgpO1xuICAgICAgICAgIHRoaXMubV9zaGFwZS5jb21wdXRlQUFCQihzeW5jaHJvbml6ZV9hYWJiMiwgeGYyLCBwcm94eS5jaGlsZEluZGV4KTtcbiAgICAgICAgICBwcm94eS5hYWJiLmNvbWJpbmUoc3luY2hyb25pemVfYWFiYjEsIHN5bmNocm9uaXplX2FhYmIyKTtcbiAgICAgICAgICBzdWJWZWMyKGRpc3BsYWNlbWVudCwgeGYyLnAsIHhmMS5wKTtcbiAgICAgICAgICBicm9hZFBoYXNlLm1vdmVQcm94eShwcm94eS5wcm94eUlkLCBwcm94eS5hYWJiLCBkaXNwbGFjZW1lbnQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldEZpbHRlckRhdGEgPSBmdW5jdGlvbihmaWx0ZXIpIHtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXggPSBmaWx0ZXIuZ3JvdXBJbmRleDtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckNhdGVnb3J5Qml0cyA9IGZpbHRlci5jYXRlZ29yeUJpdHM7XG4gICAgICAgIHRoaXMubV9maWx0ZXJNYXNrQml0cyA9IGZpbHRlci5tYXNrQml0cztcbiAgICAgICAgdGhpcy5yZWZpbHRlcigpO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRGaWx0ZXJHcm91cEluZGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZmlsdGVyR3JvdXBJbmRleDtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0RmlsdGVyR3JvdXBJbmRleCA9IGZ1bmN0aW9uKGdyb3VwSW5kZXgpIHtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXggPSBncm91cEluZGV4O1xuICAgICAgICB0aGlzLnJlZmlsdGVyKCk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldEZpbHRlckNhdGVnb3J5Qml0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZpbHRlckNhdGVnb3J5Qml0cztcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0RmlsdGVyQ2F0ZWdvcnlCaXRzID0gZnVuY3Rpb24oY2F0ZWdvcnlCaXRzKSB7XG4gICAgICAgIHRoaXMubV9maWx0ZXJDYXRlZ29yeUJpdHMgPSBjYXRlZ29yeUJpdHM7XG4gICAgICAgIHRoaXMucmVmaWx0ZXIoKTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0RmlsdGVyTWFza0JpdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9maWx0ZXJNYXNrQml0cztcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0RmlsdGVyTWFza0JpdHMgPSBmdW5jdGlvbihtYXNrQml0cykge1xuICAgICAgICB0aGlzLm1fZmlsdGVyTWFza0JpdHMgPSBtYXNrQml0cztcbiAgICAgICAgdGhpcy5yZWZpbHRlcigpO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5yZWZpbHRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5tX2JvZHkgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZWRnZSA9IHRoaXMubV9ib2R5LmdldENvbnRhY3RMaXN0KCk7XG4gICAgICAgIHdoaWxlIChlZGdlKSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSBlZGdlLmNvbnRhY3Q7XG4gICAgICAgICAgdmFyIGZpeHR1cmVBID0gY29udGFjdC5nZXRGaXh0dXJlQSgpO1xuICAgICAgICAgIHZhciBmaXh0dXJlQiA9IGNvbnRhY3QuZ2V0Rml4dHVyZUIoKTtcbiAgICAgICAgICBpZiAoZml4dHVyZUEgPT0gdGhpcyB8fCBmaXh0dXJlQiA9PSB0aGlzKSB7XG4gICAgICAgICAgICBjb250YWN0LmZsYWdGb3JGaWx0ZXJpbmcoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgd29ybGQgPSB0aGlzLm1fYm9keS5nZXRXb3JsZCgpO1xuICAgICAgICBpZiAod29ybGQgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHdvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fcHJveHlDb3VudDsgKytpKSB7XG4gICAgICAgICAgYnJvYWRQaGFzZS50b3VjaFByb3h5KHRoaXMubV9wcm94aWVzW2ldLnByb3h5SWQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNob3VsZENvbGxpZGUgPSBmdW5jdGlvbih0aGF0KSB7XG4gICAgICAgIGlmICh0aGF0Lm1fZmlsdGVyR3JvdXBJbmRleCA9PT0gdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXggJiYgdGhhdC5tX2ZpbHRlckdyb3VwSW5kZXggIT09IDApIHtcbiAgICAgICAgICByZXR1cm4gdGhhdC5tX2ZpbHRlckdyb3VwSW5kZXggPiAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb2xsaWRlQSA9ICh0aGF0Lm1fZmlsdGVyTWFza0JpdHMgJiB0aGlzLm1fZmlsdGVyQ2F0ZWdvcnlCaXRzKSAhPT0gMDtcbiAgICAgICAgdmFyIGNvbGxpZGVCID0gKHRoYXQubV9maWx0ZXJDYXRlZ29yeUJpdHMgJiB0aGlzLm1fZmlsdGVyTWFza0JpdHMpICE9PSAwO1xuICAgICAgICB2YXIgY29sbGlkZSA9IGNvbGxpZGVBICYmIGNvbGxpZGVCO1xuICAgICAgICByZXR1cm4gY29sbGlkZTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gRml4dHVyZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBTVEFUSUMgPSBcInN0YXRpY1wiO1xuICB2YXIgS0lORU1BVElDID0gXCJraW5lbWF0aWNcIjtcbiAgdmFyIERZTkFNSUMgPSBcImR5bmFtaWNcIjtcbiAgdmFyIG9sZENlbnRlciA9IHZlYzIoMCwgMCk7XG4gIHZhciBsb2NhbENlbnRlciA9IHZlYzIoMCwgMCk7XG4gIHZhciBzaGlmdCA9IHZlYzIoMCwgMCk7XG4gIHZhciB0ZW1wJDYgPSB2ZWMyKDAsIDApO1xuICB2YXIgeGYkMiA9IHRyYW5zZm9ybSgwLCAwLCAwKTtcbiAgdmFyIEJvZHlEZWZEZWZhdWx0ID0ge1xuICAgIHR5cGU6IFNUQVRJQyxcbiAgICBwb3NpdGlvbjogVmVjMi56ZXJvKCksXG4gICAgYW5nbGU6IDAsXG4gICAgbGluZWFyVmVsb2NpdHk6IFZlYzIuemVybygpLFxuICAgIGFuZ3VsYXJWZWxvY2l0eTogMCxcbiAgICBsaW5lYXJEYW1waW5nOiAwLFxuICAgIGFuZ3VsYXJEYW1waW5nOiAwLFxuICAgIGZpeGVkUm90YXRpb246IGZhbHNlLFxuICAgIGJ1bGxldDogZmFsc2UsXG4gICAgZ3Jhdml0eVNjYWxlOiAxLFxuICAgIGFsbG93U2xlZXA6IHRydWUsXG4gICAgYXdha2U6IHRydWUsXG4gICAgYWN0aXZlOiB0cnVlLFxuICAgIHVzZXJEYXRhOiBudWxsXG4gIH07XG4gIHZhciBCb2R5ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEJvZHkyKHdvcmxkLCBkZWYpIHtcbiAgICAgICAgdGhpcy5zdHlsZSA9IHt9O1xuICAgICAgICB0aGlzLmFwcERhdGEgPSB7fTtcbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIEJvZHlEZWZEZWZhdWx0KTtcbiAgICAgICAgdGhpcy5tX3dvcmxkID0gd29ybGQ7XG4gICAgICAgIHRoaXMubV9hd2FrZUZsYWcgPSBkZWYuYXdha2U7XG4gICAgICAgIHRoaXMubV9hdXRvU2xlZXBGbGFnID0gZGVmLmFsbG93U2xlZXA7XG4gICAgICAgIHRoaXMubV9idWxsZXRGbGFnID0gZGVmLmJ1bGxldDtcbiAgICAgICAgdGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnID0gZGVmLmZpeGVkUm90YXRpb247XG4gICAgICAgIHRoaXMubV9hY3RpdmVGbGFnID0gZGVmLmFjdGl2ZTtcbiAgICAgICAgdGhpcy5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX3RvaUZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX3VzZXJEYXRhID0gZGVmLnVzZXJEYXRhO1xuICAgICAgICB0aGlzLm1fdHlwZSA9IGRlZi50eXBlO1xuICAgICAgICBpZiAodGhpcy5tX3R5cGUgPT0gRFlOQU1JQykge1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gMTtcbiAgICAgICAgICB0aGlzLm1faW52TWFzcyA9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSAwO1xuICAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fSSA9IDA7XG4gICAgICAgIHRoaXMubV9pbnZJID0gMDtcbiAgICAgICAgdGhpcy5tX3hmID0gVHJhbnNmb3JtLmlkZW50aXR5KCk7XG4gICAgICAgIHRoaXMubV94Zi5wLnNldFZlYzIoZGVmLnBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5tX3hmLnEuc2V0QW5nbGUoZGVmLmFuZ2xlKTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwID0gbmV3IFN3ZWVwKCk7XG4gICAgICAgIHRoaXMubV9zd2VlcC5zZXRUcmFuc2Zvcm0odGhpcy5tX3hmKTtcbiAgICAgICAgdGhpcy5jX3ZlbG9jaXR5ID0gbmV3IFZlbG9jaXR5KCk7XG4gICAgICAgIHRoaXMuY19wb3NpdGlvbiA9IG5ldyBQb3NpdGlvbigpO1xuICAgICAgICB0aGlzLm1fZm9yY2UgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5tX3RvcnF1ZSA9IDA7XG4gICAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eSA9IFZlYzIuY2xvbmUoZGVmLmxpbmVhclZlbG9jaXR5KTtcbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IGRlZi5hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgIHRoaXMubV9saW5lYXJEYW1waW5nID0gZGVmLmxpbmVhckRhbXBpbmc7XG4gICAgICAgIHRoaXMubV9hbmd1bGFyRGFtcGluZyA9IGRlZi5hbmd1bGFyRGFtcGluZztcbiAgICAgICAgdGhpcy5tX2dyYXZpdHlTY2FsZSA9IGRlZi5ncmF2aXR5U2NhbGU7XG4gICAgICAgIHRoaXMubV9zbGVlcFRpbWUgPSAwO1xuICAgICAgICB0aGlzLm1fam9pbnRMaXN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2ZpeHR1cmVMaXN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9kZXN0cm95ZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKHR5cGVvZiBkZWYuc3R5bGUgPT09IFwib2JqZWN0XCIgJiYgZGVmLnN0eWxlICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5zdHlsZSA9IGRlZi5zdHlsZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgQm9keTIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVzID0gW107XG4gICAgICAgIGZvciAodmFyIGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgIGZpeHR1cmVzLnB1c2goZik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBidWxsZXQ6IHRoaXMubV9idWxsZXRGbGFnLFxuICAgICAgICAgIHBvc2l0aW9uOiB0aGlzLm1feGYucCxcbiAgICAgICAgICBhbmdsZTogdGhpcy5tX3hmLnEuZ2V0QW5nbGUoKSxcbiAgICAgICAgICBsaW5lYXJWZWxvY2l0eTogdGhpcy5tX2xpbmVhclZlbG9jaXR5LFxuICAgICAgICAgIGFuZ3VsYXJWZWxvY2l0eTogdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSxcbiAgICAgICAgICBmaXh0dXJlc1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIHZhciBib2R5ID0gbmV3IEJvZHkyKHdvcmxkLCBkYXRhKTtcbiAgICAgICAgaWYgKGRhdGEuZml4dHVyZXMpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gZGF0YS5maXh0dXJlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGZpeHR1cmUgPSByZXN0b3JlKEZpeHR1cmUsIGRhdGEuZml4dHVyZXNbaV0sIGJvZHkpO1xuICAgICAgICAgICAgYm9keS5fYWRkRml4dHVyZShmaXh0dXJlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJvZHk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzV29ybGRMb2NrZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV93b3JsZCAmJiB0aGlzLm1fd29ybGQuaXNMb2NrZWQoKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0V29ybGQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV93b3JsZDtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TmV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX25leHQ7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldFVzZXJEYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICB0aGlzLm1fdXNlckRhdGEgPSBkYXRhO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3VzZXJEYXRhO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRGaXh0dXJlTGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZpeHR1cmVMaXN0O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRKb2ludExpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9qb2ludExpc3Q7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldENvbnRhY3RMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzU3RhdGljID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZSA9PSBTVEFUSUM7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzRHluYW1pYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGUgPT0gRFlOQU1JQztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNLaW5lbWF0aWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlID09IEtJTkVNQVRJQztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0U3RhdGljID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2V0VHlwZShTVEFUSUMpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0RHluYW1pYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNldFR5cGUoRFlOQU1JQyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRLaW5lbWF0aWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zZXRUeXBlKEtJTkVNQVRJQyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0VHlwZSA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNXb3JsZExvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlID09IHR5cGUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3R5cGUgPSB0eXBlO1xuICAgICAgICB0aGlzLnJlc2V0TWFzc0RhdGEoKTtcbiAgICAgICAgaWYgKHRoaXMubV90eXBlID09IFNUQVRJQykge1xuICAgICAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IDA7XG4gICAgICAgICAgdGhpcy5tX3N3ZWVwLmZvcndhcmQoKTtcbiAgICAgICAgICB0aGlzLnN5bmNocm9uaXplRml4dHVyZXMoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fZm9yY2Uuc2V0WmVybygpO1xuICAgICAgICB0aGlzLm1fdG9ycXVlID0gMDtcbiAgICAgICAgdmFyIGNlID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgICAgICB3aGlsZSAoY2UpIHtcbiAgICAgICAgICB2YXIgY2UwID0gY2U7XG4gICAgICAgICAgY2UgPSBjZS5uZXh0O1xuICAgICAgICAgIHRoaXMubV93b3JsZC5kZXN0cm95Q29udGFjdChjZTAuY29udGFjdCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gbnVsbDtcbiAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICBmb3IgKHZhciBmID0gdGhpcy5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGYubV9wcm94eUNvdW50OyArK2kpIHtcbiAgICAgICAgICAgIGJyb2FkUGhhc2UudG91Y2hQcm94eShmLm1fcHJveGllc1tpXS5wcm94eUlkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNCdWxsZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9idWxsZXRGbGFnO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRCdWxsZXQgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIHRoaXMubV9idWxsZXRGbGFnID0gISFmbGFnO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc1NsZWVwaW5nQWxsb3dlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2F1dG9TbGVlcEZsYWc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldFNsZWVwaW5nQWxsb3dlZCA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX2F1dG9TbGVlcEZsYWcgPSAhIWZsYWc7XG4gICAgICAgIGlmICh0aGlzLm1fYXV0b1NsZWVwRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNBd2FrZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2F3YWtlRmxhZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0QXdha2UgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnKSB7XG4gICAgICAgICAgdGhpcy5tX2F3YWtlRmxhZyA9IHRydWU7XG4gICAgICAgICAgdGhpcy5tX3NsZWVwVGltZSA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2F3YWtlRmxhZyA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMubV9zbGVlcFRpbWUgPSAwO1xuICAgICAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IDA7XG4gICAgICAgICAgdGhpcy5tX2ZvcmNlLnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fdG9ycXVlID0gMDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc0FjdGl2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2FjdGl2ZUZsYWc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEFjdGl2ZSA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcgPT0gdGhpcy5tX2FjdGl2ZUZsYWcpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2FjdGl2ZUZsYWcgPSAhIWZsYWc7XG4gICAgICAgIGlmICh0aGlzLm1fYWN0aXZlRmxhZykge1xuICAgICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgICBmb3IgKHZhciBmID0gdGhpcy5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgICAgIGYuY3JlYXRlUHJveGllcyhicm9hZFBoYXNlLCB0aGlzLm1feGYpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLm1fd29ybGQubV9uZXdGaXh0dXJlID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgICBmLmRlc3Ryb3lQcm94aWVzKGJyb2FkUGhhc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgY2UgPSB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICAgICAgd2hpbGUgKGNlKSB7XG4gICAgICAgICAgICB2YXIgY2UwID0gY2U7XG4gICAgICAgICAgICBjZSA9IGNlLm5leHQ7XG4gICAgICAgICAgICB0aGlzLm1fd29ybGQuZGVzdHJveUNvbnRhY3QoY2UwLmNvbnRhY3QpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzRml4ZWRSb3RhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRGaXhlZFJvdGF0aW9uID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAodGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnID09IGZsYWcpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnID0gISFmbGFnO1xuICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gMDtcbiAgICAgICAgdGhpcy5yZXNldE1hc3NEYXRhKCk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldFRyYW5zZm9ybSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3hmO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNXb3JsZExvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBiMiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHRoaXMubV94Zi5zZXROdW0oYTIsIGIyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1feGYuc2V0VHJhbnNmb3JtKGEyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fc3dlZXAuc2V0VHJhbnNmb3JtKHRoaXMubV94Zik7XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgZi5zeW5jaHJvbml6ZShicm9hZFBoYXNlLCB0aGlzLm1feGYsIHRoaXMubV94Zik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc3luY2hyb25pemVUcmFuc2Zvcm0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLmdldFRyYW5zZm9ybSh0aGlzLm1feGYsIDEpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zeW5jaHJvbml6ZUZpeHR1cmVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV9zd2VlcC5nZXRUcmFuc2Zvcm0oeGYkMiwgMCk7XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgZi5zeW5jaHJvbml6ZShicm9hZFBoYXNlLCB4ZiQyLCB0aGlzLm1feGYpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmFkdmFuY2UgPSBmdW5jdGlvbihhbHBoYSkge1xuICAgICAgICB0aGlzLm1fc3dlZXAuYWR2YW5jZShhbHBoYSk7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMubV9zd2VlcC5jLCB0aGlzLm1fc3dlZXAuYzApO1xuICAgICAgICB0aGlzLm1fc3dlZXAuYSA9IHRoaXMubV9zd2VlcC5hMDtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLmdldFRyYW5zZm9ybSh0aGlzLm1feGYsIDEpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3hmLnA7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24ocCkge1xuICAgICAgICB0aGlzLnNldFRyYW5zZm9ybShwLCB0aGlzLm1fc3dlZXAuYSk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldEFuZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc3dlZXAuYTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0QW5nbGUgPSBmdW5jdGlvbihhbmdsZSkge1xuICAgICAgICB0aGlzLnNldFRyYW5zZm9ybSh0aGlzLm1feGYucCwgYW5nbGUpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRXb3JsZENlbnRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3N3ZWVwLmM7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExvY2FsQ2VudGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExpbmVhclZlbG9jaXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExpbmVhclZlbG9jaXR5RnJvbVdvcmxkUG9pbnQgPSBmdW5jdGlvbih3b3JsZFBvaW50KSB7XG4gICAgICAgIHZhciBsb2NhbENlbnRlcjIgPSBWZWMyLnN1Yih3b3JsZFBvaW50LCB0aGlzLm1fc3dlZXAuYyk7XG4gICAgICAgIHJldHVybiBWZWMyLmFkZCh0aGlzLm1fbGluZWFyVmVsb2NpdHksIFZlYzIuY3Jvc3NOdW1WZWMyKHRoaXMubV9hbmd1bGFyVmVsb2NpdHksIGxvY2FsQ2VudGVyMikpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRMaW5lYXJWZWxvY2l0eUZyb21Mb2NhbFBvaW50ID0gZnVuY3Rpb24obG9jYWxQb2ludCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRMaW5lYXJWZWxvY2l0eUZyb21Xb3JsZFBvaW50KHRoaXMuZ2V0V29ybGRQb2ludChsb2NhbFBvaW50KSk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldExpbmVhclZlbG9jaXR5ID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgaWYgKHRoaXMubV90eXBlID09IFNUQVRJQykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVmVjMi5kb3QodjMsIHYzKSA+IDApIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS5zZXRWZWMyKHYzKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0QW5ndWxhclZlbG9jaXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRBbmd1bGFyVmVsb2NpdHkgPSBmdW5jdGlvbih3KSB7XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSBTVEFUSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHcgKiB3ID4gMCkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IHc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExpbmVhckRhbXBpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9saW5lYXJEYW1waW5nO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRMaW5lYXJEYW1waW5nID0gZnVuY3Rpb24obGluZWFyRGFtcGluZykge1xuICAgICAgICB0aGlzLm1fbGluZWFyRGFtcGluZyA9IGxpbmVhckRhbXBpbmc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldEFuZ3VsYXJEYW1waW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYW5ndWxhckRhbXBpbmc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEFuZ3VsYXJEYW1waW5nID0gZnVuY3Rpb24oYW5ndWxhckRhbXBpbmcpIHtcbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJEYW1waW5nID0gYW5ndWxhckRhbXBpbmc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldEdyYXZpdHlTY2FsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2dyYXZpdHlTY2FsZTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0R3Jhdml0eVNjYWxlID0gZnVuY3Rpb24oc2NhbGUpIHtcbiAgICAgICAgdGhpcy5tX2dyYXZpdHlTY2FsZSA9IHNjYWxlO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRNYXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWFzcztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0SW5lcnRpYSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX0kgKyB0aGlzLm1fbWFzcyAqIFZlYzIuZG90KHRoaXMubV9zd2VlcC5sb2NhbENlbnRlciwgdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TWFzc0RhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGRhdGEubWFzcyA9IHRoaXMubV9tYXNzO1xuICAgICAgICBkYXRhLkkgPSB0aGlzLmdldEluZXJ0aWEoKTtcbiAgICAgICAgY29weVZlYzIoZGF0YS5jZW50ZXIsIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcik7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnJlc2V0TWFzc0RhdGEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX21hc3MgPSAwO1xuICAgICAgICB0aGlzLm1faW52TWFzcyA9IDA7XG4gICAgICAgIHRoaXMubV9JID0gMDtcbiAgICAgICAgdGhpcy5tX2ludkkgPSAwO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIpO1xuICAgICAgICBpZiAodGhpcy5pc1N0YXRpYygpIHx8IHRoaXMuaXNLaW5lbWF0aWMoKSkge1xuICAgICAgICAgIGNvcHlWZWMyKHRoaXMubV9zd2VlcC5jMCwgdGhpcy5tX3hmLnApO1xuICAgICAgICAgIGNvcHlWZWMyKHRoaXMubV9zd2VlcC5jLCB0aGlzLm1feGYucCk7XG4gICAgICAgICAgdGhpcy5tX3N3ZWVwLmEwID0gdGhpcy5tX3N3ZWVwLmE7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHplcm9WZWMyKGxvY2FsQ2VudGVyKTtcbiAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgaWYgKGYubV9kZW5zaXR5ID09IDApIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgbWFzc0RhdGEgPSB7XG4gICAgICAgICAgICBtYXNzOiAwLFxuICAgICAgICAgICAgY2VudGVyOiB2ZWMyKDAsIDApLFxuICAgICAgICAgICAgSTogMFxuICAgICAgICAgIH07XG4gICAgICAgICAgZi5nZXRNYXNzRGF0YShtYXNzRGF0YSk7XG4gICAgICAgICAgdGhpcy5tX21hc3MgKz0gbWFzc0RhdGEubWFzcztcbiAgICAgICAgICBwbHVzU2NhbGVWZWMyKGxvY2FsQ2VudGVyLCBtYXNzRGF0YS5tYXNzLCBtYXNzRGF0YS5jZW50ZXIpO1xuICAgICAgICAgIHRoaXMubV9JICs9IG1hc3NEYXRhLkk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9tYXNzID4gMCkge1xuICAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMSAvIHRoaXMubV9tYXNzO1xuICAgICAgICAgIHNjYWxlVmVjMihsb2NhbENlbnRlciwgdGhpcy5tX2ludk1hc3MsIGxvY2FsQ2VudGVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fbWFzcyA9IDE7XG4gICAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fSSA+IDAgJiYgdGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5tX0kgLT0gdGhpcy5tX21hc3MgKiBkb3RWZWMyKGxvY2FsQ2VudGVyLCBsb2NhbENlbnRlcik7XG4gICAgICAgICAgdGhpcy5tX2ludkkgPSAxIC8gdGhpcy5tX0k7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX0kgPSAwO1xuICAgICAgICAgIHRoaXMubV9pbnZJID0gMDtcbiAgICAgICAgfVxuICAgICAgICBjb3B5VmVjMihvbGRDZW50ZXIsIHRoaXMubV9zd2VlcC5jKTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLnNldExvY2FsQ2VudGVyKGxvY2FsQ2VudGVyLCB0aGlzLm1feGYpO1xuICAgICAgICBzdWJWZWMyKHNoaWZ0LCB0aGlzLm1fc3dlZXAuYywgb2xkQ2VudGVyKTtcbiAgICAgICAgY3Jvc3NOdW1WZWMyKHRlbXAkNiwgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSwgc2hpZnQpO1xuICAgICAgICBwbHVzVmVjMih0aGlzLm1fbGluZWFyVmVsb2NpdHksIHRlbXAkNik7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldE1hc3NEYXRhID0gZnVuY3Rpb24obWFzc0RhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNXb3JsZExvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAwO1xuICAgICAgICB0aGlzLm1fSSA9IDA7XG4gICAgICAgIHRoaXMubV9pbnZJID0gMDtcbiAgICAgICAgdGhpcy5tX21hc3MgPSBtYXNzRGF0YS5tYXNzO1xuICAgICAgICBpZiAodGhpcy5tX21hc3MgPD0gMCkge1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1faW52TWFzcyA9IDEgLyB0aGlzLm1fbWFzcztcbiAgICAgICAgaWYgKG1hc3NEYXRhLkkgPiAwICYmIHRoaXMubV9maXhlZFJvdGF0aW9uRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMubV9JID0gbWFzc0RhdGEuSSAtIHRoaXMubV9tYXNzICogZG90VmVjMihtYXNzRGF0YS5jZW50ZXIsIG1hc3NEYXRhLmNlbnRlcik7XG4gICAgICAgICAgdGhpcy5tX2ludkkgPSAxIC8gdGhpcy5tX0k7XG4gICAgICAgIH1cbiAgICAgICAgY29weVZlYzIob2xkQ2VudGVyLCB0aGlzLm1fc3dlZXAuYyk7XG4gICAgICAgIHRoaXMubV9zd2VlcC5zZXRMb2NhbENlbnRlcihtYXNzRGF0YS5jZW50ZXIsIHRoaXMubV94Zik7XG4gICAgICAgIHN1YlZlYzIoc2hpZnQsIHRoaXMubV9zd2VlcC5jLCBvbGRDZW50ZXIpO1xuICAgICAgICBjcm9zc051bVZlYzIodGVtcCQ2LCB0aGlzLm1fYW5ndWxhclZlbG9jaXR5LCBzaGlmdCk7XG4gICAgICAgIHBsdXNWZWMyKHRoaXMubV9saW5lYXJWZWxvY2l0eSwgdGVtcCQ2KTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuYXBwbHlGb3JjZSA9IGZ1bmN0aW9uKGZvcmNlLCBwb2ludDIsIHdha2UpIHtcbiAgICAgICAgaWYgKHdha2UgPT09IHZvaWQgMCkge1xuICAgICAgICAgIHdha2UgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBEWU5BTUlDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3YWtlICYmIHRoaXMubV9hd2FrZUZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYXdha2VGbGFnKSB7XG4gICAgICAgICAgdGhpcy5tX2ZvcmNlLmFkZChmb3JjZSk7XG4gICAgICAgICAgdGhpcy5tX3RvcnF1ZSArPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5zdWIocG9pbnQyLCB0aGlzLm1fc3dlZXAuYyksIGZvcmNlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5hcHBseUZvcmNlVG9DZW50ZXIgPSBmdW5jdGlvbihmb3JjZSwgd2FrZSkge1xuICAgICAgICBpZiAod2FrZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgd2FrZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdha2UgJiYgdGhpcy5tX2F3YWtlRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9hd2FrZUZsYWcpIHtcbiAgICAgICAgICB0aGlzLm1fZm9yY2UuYWRkKGZvcmNlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5hcHBseVRvcnF1ZSA9IGZ1bmN0aW9uKHRvcnF1ZSwgd2FrZSkge1xuICAgICAgICBpZiAod2FrZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgd2FrZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdha2UgJiYgdGhpcy5tX2F3YWtlRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9hd2FrZUZsYWcpIHtcbiAgICAgICAgICB0aGlzLm1fdG9ycXVlICs9IHRvcnF1ZTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5hcHBseUxpbmVhckltcHVsc2UgPSBmdW5jdGlvbihpbXB1bHNlLCBwb2ludDIsIHdha2UpIHtcbiAgICAgICAgaWYgKHdha2UgPT09IHZvaWQgMCkge1xuICAgICAgICAgIHdha2UgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBEWU5BTUlDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3YWtlICYmIHRoaXMubV9hd2FrZUZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYXdha2VGbGFnKSB7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LmFkZE11bCh0aGlzLm1faW52TWFzcywgaW1wdWxzZSk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSArPSB0aGlzLm1faW52SSAqIFZlYzIuY3Jvc3NWZWMyVmVjMihWZWMyLnN1Yihwb2ludDIsIHRoaXMubV9zd2VlcC5jKSwgaW1wdWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuYXBwbHlBbmd1bGFySW1wdWxzZSA9IGZ1bmN0aW9uKGltcHVsc2UsIHdha2UpIHtcbiAgICAgICAgaWYgKHdha2UgPT09IHZvaWQgMCkge1xuICAgICAgICAgIHdha2UgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBEWU5BTUlDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3YWtlICYmIHRoaXMubV9hd2FrZUZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYXdha2VGbGFnKSB7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSArPSB0aGlzLm1faW52SSAqIGltcHVsc2U7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2hvdWxkQ29sbGlkZSA9IGZ1bmN0aW9uKHRoYXQpIHtcbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMgJiYgdGhhdC5tX3R5cGUgIT0gRFlOQU1JQykge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBqbiA9IHRoaXMubV9qb2ludExpc3Q7IGpuOyBqbiA9IGpuLm5leHQpIHtcbiAgICAgICAgICBpZiAoam4ub3RoZXIgPT0gdGhhdCkge1xuICAgICAgICAgICAgaWYgKGpuLmpvaW50Lm1fY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5fYWRkRml4dHVyZSA9IGZ1bmN0aW9uKGZpeHR1cmUpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNXb3JsZExvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2FjdGl2ZUZsYWcpIHtcbiAgICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgICAgZml4dHVyZS5jcmVhdGVQcm94aWVzKGJyb2FkUGhhc2UsIHRoaXMubV94Zik7XG4gICAgICAgIH1cbiAgICAgICAgZml4dHVyZS5tX25leHQgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XG4gICAgICAgIHRoaXMubV9maXh0dXJlTGlzdCA9IGZpeHR1cmU7XG4gICAgICAgIGlmIChmaXh0dXJlLm1fZGVuc2l0eSA+IDApIHtcbiAgICAgICAgICB0aGlzLnJlc2V0TWFzc0RhdGEoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fd29ybGQubV9uZXdGaXh0dXJlID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIGZpeHR1cmU7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmNyZWF0ZUZpeHR1cmUgPSBmdW5jdGlvbihzaGFwZSwgZml4ZGVmKSB7XG4gICAgICAgIGlmICh0aGlzLmlzV29ybGRMb2NrZWQoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpeHR1cmUgPSBuZXcgRml4dHVyZSh0aGlzLCBzaGFwZSwgZml4ZGVmKTtcbiAgICAgICAgdGhpcy5fYWRkRml4dHVyZShmaXh0dXJlKTtcbiAgICAgICAgcmV0dXJuIGZpeHR1cmU7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmRlc3Ryb3lGaXh0dXJlID0gZnVuY3Rpb24oZml4dHVyZSkge1xuICAgICAgICBpZiAodGhpcy5pc1dvcmxkTG9ja2VkKCkgPT0gdHJ1ZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2ZpeHR1cmVMaXN0ID09PSBmaXh0dXJlKSB7XG4gICAgICAgICAgdGhpcy5tX2ZpeHR1cmVMaXN0ID0gZml4dHVyZS5tX25leHQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XG4gICAgICAgICAgd2hpbGUgKG5vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKG5vZGUubV9uZXh0ID09PSBmaXh0dXJlKSB7XG4gICAgICAgICAgICAgIG5vZGUubV9uZXh0ID0gZml4dHVyZS5tX25leHQ7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZSA9IG5vZGUubV9uZXh0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZWRnZSA9IHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgICAgd2hpbGUgKGVkZ2UpIHtcbiAgICAgICAgICB2YXIgYzIgPSBlZGdlLmNvbnRhY3Q7XG4gICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcbiAgICAgICAgICB2YXIgZml4dHVyZUEgPSBjMi5nZXRGaXh0dXJlQSgpO1xuICAgICAgICAgIHZhciBmaXh0dXJlQiA9IGMyLmdldEZpeHR1cmVCKCk7XG4gICAgICAgICAgaWYgKGZpeHR1cmUgPT0gZml4dHVyZUEgfHwgZml4dHVyZSA9PSBmaXh0dXJlQikge1xuICAgICAgICAgICAgdGhpcy5tX3dvcmxkLmRlc3Ryb3lDb250YWN0KGMyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9hY3RpdmVGbGFnKSB7XG4gICAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICAgIGZpeHR1cmUuZGVzdHJveVByb3hpZXMoYnJvYWRQaGFzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZml4dHVyZS5tX2JvZHkgPSBudWxsO1xuICAgICAgICBmaXh0dXJlLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV93b3JsZC5wdWJsaXNoKFwicmVtb3ZlLWZpeHR1cmVcIiwgZml4dHVyZSk7XG4gICAgICAgIHRoaXMucmVzZXRNYXNzRGF0YSgpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRXb3JsZFBvaW50ID0gZnVuY3Rpb24obG9jYWxQb2ludCkge1xuICAgICAgICByZXR1cm4gVHJhbnNmb3JtLm11bFZlYzIodGhpcy5tX3hmLCBsb2NhbFBvaW50KTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0V29ybGRWZWN0b3IgPSBmdW5jdGlvbihsb2NhbFZlY3Rvcikge1xuICAgICAgICByZXR1cm4gUm90Lm11bFZlYzIodGhpcy5tX3hmLnEsIGxvY2FsVmVjdG9yKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TG9jYWxQb2ludCA9IGZ1bmN0aW9uKHdvcmxkUG9pbnQpIHtcbiAgICAgICAgcmV0dXJuIFRyYW5zZm9ybS5tdWxUVmVjMih0aGlzLm1feGYsIHdvcmxkUG9pbnQpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRMb2NhbFZlY3RvciA9IGZ1bmN0aW9uKHdvcmxkVmVjdG9yKSB7XG4gICAgICAgIHJldHVybiBSb3QubXVsVFZlYzIodGhpcy5tX3hmLnEsIHdvcmxkVmVjdG9yKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5TVEFUSUMgPSBcInN0YXRpY1wiO1xuICAgICAgQm9keTIuS0lORU1BVElDID0gXCJraW5lbWF0aWNcIjtcbiAgICAgIEJvZHkyLkRZTkFNSUMgPSBcImR5bmFtaWNcIjtcbiAgICAgIHJldHVybiBCb2R5MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIEpvaW50RWRnZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gSm9pbnRFZGdlMigpIHtcbiAgICAgICAgdGhpcy5vdGhlciA9IG51bGw7XG4gICAgICAgIHRoaXMuam9pbnQgPSBudWxsO1xuICAgICAgICB0aGlzLnByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm5leHQgPSBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIEpvaW50RWRnZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBKb2ludDIoZGVmLCBib2R5QSwgYm9keUIpIHtcbiAgICAgICAgdGhpcy5tX3R5cGUgPSBcInVua25vd24tam9pbnRcIjtcbiAgICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9lZGdlQSA9IG5ldyBKb2ludEVkZ2UoKTtcbiAgICAgICAgdGhpcy5tX2VkZ2VCID0gbmV3IEpvaW50RWRnZSgpO1xuICAgICAgICB0aGlzLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN0eWxlID0ge307XG4gICAgICAgIHRoaXMuYXBwRGF0YSA9IHt9O1xuICAgICAgICBib2R5QSA9IFwiYm9keUFcIiBpbiBkZWYgPyBkZWYuYm9keUEgOiBib2R5QTtcbiAgICAgICAgYm9keUIgPSBcImJvZHlCXCIgaW4gZGVmID8gZGVmLmJvZHlCIDogYm9keUI7XG4gICAgICAgIHRoaXMubV9ib2R5QSA9IGJvZHlBO1xuICAgICAgICB0aGlzLm1fYm9keUIgPSBib2R5QjtcbiAgICAgICAgdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQgPSAhIWRlZi5jb2xsaWRlQ29ubmVjdGVkO1xuICAgICAgICB0aGlzLm1fdXNlckRhdGEgPSBkZWYudXNlckRhdGE7XG4gICAgICAgIGlmICh0eXBlb2YgZGVmLnN0eWxlID09PSBcIm9iamVjdFwiICYmIGRlZi5zdHlsZSAhPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuc3R5bGUgPSBkZWYuc3R5bGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuaXNBY3RpdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5pc0FjdGl2ZSgpICYmIHRoaXMubV9ib2R5Qi5pc0FjdGl2ZSgpO1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5nZXRCb2R5QSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBO1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuZ2V0Qm9keUIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QjtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLmdldE5leHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuZ2V0VXNlckRhdGEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV91c2VyRGF0YTtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLnNldFVzZXJEYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICB0aGlzLm1fdXNlckRhdGEgPSBkYXRhO1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuZ2V0Q29sbGlkZUNvbm5lY3RlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQ7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5zaGlmdE9yaWdpbiA9IGZ1bmN0aW9uKG5ld09yaWdpbikge1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0QW5jaG9ycyA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVzZXQoZGVmKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gSm9pbnQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgc3RhdHMgPSB7XG4gICAgZ2prQ2FsbHM6IDAsXG4gICAgZ2prSXRlcnM6IDAsXG4gICAgZ2prTWF4SXRlcnM6IDAsXG4gICAgdG9pVGltZTogMCxcbiAgICB0b2lNYXhUaW1lOiAwLFxuICAgIHRvaUNhbGxzOiAwLFxuICAgIHRvaUl0ZXJzOiAwLFxuICAgIHRvaU1heEl0ZXJzOiAwLFxuICAgIHRvaVJvb3RJdGVyczogMCxcbiAgICB0b2lNYXhSb290SXRlcnM6IDAsXG4gICAgdG9TdHJpbmc6IGZ1bmN0aW9uKG5ld2xpbmUpIHtcbiAgICAgIG5ld2xpbmUgPSB0eXBlb2YgbmV3bGluZSA9PT0gXCJzdHJpbmdcIiA/IG5ld2xpbmUgOiBcIlxcblwiO1xuICAgICAgdmFyIHN0cmluZyA9IFwiXCI7XG4gICAgICBmb3IgKHZhciBuYW1lXzEgaW4gdGhpcykge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXNbbmFtZV8xXSAhPT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiB0aGlzW25hbWVfMV0gIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICBzdHJpbmcgKz0gbmFtZV8xICsgXCI6IFwiICsgdGhpc1tuYW1lXzFdICsgbmV3bGluZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9XG4gIH07XG4gIHZhciBub3cgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gRGF0ZS5ub3coKTtcbiAgfTtcbiAgdmFyIGRpZmYgPSBmdW5jdGlvbih0aW1lKSB7XG4gICAgcmV0dXJuIERhdGUubm93KCkgLSB0aW1lO1xuICB9O1xuICBjb25zdCBUaW1lciA9IHtcbiAgICBub3csXG4gICAgZGlmZlxuICB9O1xuICB2YXIgbWF0aF9tYXgkNCA9IE1hdGgubWF4O1xuICB2YXIgdGVtcCQ1ID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbCQ0ID0gdmVjMigwLCAwKTtcbiAgdmFyIGUxMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBlMTMgPSB2ZWMyKDAsIDApO1xuICB2YXIgZTIzID0gdmVjMigwLCAwKTtcbiAgdmFyIHRlbXAxID0gdmVjMigwLCAwKTtcbiAgdmFyIHRlbXAyID0gdmVjMigwLCAwKTtcbiAgc3RhdHMuZ2prQ2FsbHMgPSAwO1xuICBzdGF0cy5namtJdGVycyA9IDA7XG4gIHN0YXRzLmdqa01heEl0ZXJzID0gMDtcbiAgdmFyIERpc3RhbmNlSW5wdXQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRGlzdGFuY2VJbnB1dDIoKSB7XG4gICAgICAgIHRoaXMucHJveHlBID0gbmV3IERpc3RhbmNlUHJveHkoKTtcbiAgICAgICAgdGhpcy5wcm94eUIgPSBuZXcgRGlzdGFuY2VQcm94eSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUEgPSBUcmFuc2Zvcm0uaWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1CID0gVHJhbnNmb3JtLmlkZW50aXR5KCk7XG4gICAgICAgIHRoaXMudXNlUmFkaWkgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIERpc3RhbmNlSW5wdXQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucHJveHlBLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5wcm94eUIucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUEuc2V0SWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1CLnNldElkZW50aXR5KCk7XG4gICAgICAgIHRoaXMudXNlUmFkaWkgPSBmYWxzZTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gRGlzdGFuY2VJbnB1dDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBEaXN0YW5jZU91dHB1dCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBEaXN0YW5jZU91dHB1dDIoKSB7XG4gICAgICAgIHRoaXMucG9pbnRBID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5wb2ludEIgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLmRpc3RhbmNlID0gMDtcbiAgICAgICAgdGhpcy5pdGVyYXRpb25zID0gMDtcbiAgICAgIH1cbiAgICAgIERpc3RhbmNlT3V0cHV0Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBvaW50QSk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMucG9pbnRCKTtcbiAgICAgICAgdGhpcy5kaXN0YW5jZSA9IDA7XG4gICAgICAgIHRoaXMuaXRlcmF0aW9ucyA9IDA7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIERpc3RhbmNlT3V0cHV0MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFNpbXBsZXhDYWNoZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTaW1wbGV4Q2FjaGUyKCkge1xuICAgICAgICB0aGlzLm1ldHJpYyA9IDA7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gW107XG4gICAgICAgIHRoaXMuaW5kZXhCID0gW107XG4gICAgICAgIHRoaXMuY291bnQgPSAwO1xuICAgICAgfVxuICAgICAgU2ltcGxleENhY2hlMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1ldHJpYyA9IDA7XG4gICAgICAgIHRoaXMuaW5kZXhBLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuaW5kZXhCLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuY291bnQgPSAwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTaW1wbGV4Q2FjaGUyO1xuICAgIH0oKVxuICApO1xuICB2YXIgRGlzdGFuY2UgPSBmdW5jdGlvbihvdXRwdXQyLCBjYWNoZTIsIGlucHV0Mikge1xuICAgICsrc3RhdHMuZ2prQ2FsbHM7XG4gICAgdmFyIHByb3h5QSA9IGlucHV0Mi5wcm94eUE7XG4gICAgdmFyIHByb3h5QiA9IGlucHV0Mi5wcm94eUI7XG4gICAgdmFyIHhmQTIgPSBpbnB1dDIudHJhbnNmb3JtQTtcbiAgICB2YXIgeGZCMiA9IGlucHV0Mi50cmFuc2Zvcm1CO1xuICAgIHNpbXBsZXgucmVjeWNsZSgpO1xuICAgIHNpbXBsZXgucmVhZENhY2hlKGNhY2hlMiwgcHJveHlBLCB4ZkEyLCBwcm94eUIsIHhmQjIpO1xuICAgIHZhciB2ZXJ0aWNlcyA9IHNpbXBsZXgubV92O1xuICAgIHZhciBrX21heEl0ZXJzID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhEaXN0YW5jZUl0ZXJhdGlvbnM7XG4gICAgdmFyIHNhdmVBID0gW107XG4gICAgdmFyIHNhdmVCID0gW107XG4gICAgdmFyIHNhdmVDb3VudCA9IDA7XG4gICAgdmFyIGl0ZXIgPSAwO1xuICAgIHdoaWxlIChpdGVyIDwga19tYXhJdGVycykge1xuICAgICAgc2F2ZUNvdW50ID0gc2ltcGxleC5tX2NvdW50O1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzYXZlQ291bnQ7ICsraSkge1xuICAgICAgICBzYXZlQVtpXSA9IHZlcnRpY2VzW2ldLmluZGV4QTtcbiAgICAgICAgc2F2ZUJbaV0gPSB2ZXJ0aWNlc1tpXS5pbmRleEI7XG4gICAgICB9XG4gICAgICBzaW1wbGV4LnNvbHZlKCk7XG4gICAgICBpZiAoc2ltcGxleC5tX2NvdW50ID09PSAzKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgdmFyIGQyID0gc2ltcGxleC5nZXRTZWFyY2hEaXJlY3Rpb24oKTtcbiAgICAgIGlmIChsZW5ndGhTcXJWZWMyKGQyKSA8IEVQU0lMT04gKiBFUFNJTE9OKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgdmFyIHZlcnRleCA9IHZlcnRpY2VzW3NpbXBsZXgubV9jb3VudF07XG4gICAgICB2ZXJ0ZXguaW5kZXhBID0gcHJveHlBLmdldFN1cHBvcnQoZGVyb3RWZWMyKHRlbXAkNSwgeGZBMi5xLCBzY2FsZVZlYzIodGVtcCQ1LCAtMSwgZDIpKSk7XG4gICAgICB0cmFuc2Zvcm1WZWMyKHZlcnRleC53QSwgeGZBMiwgcHJveHlBLmdldFZlcnRleCh2ZXJ0ZXguaW5kZXhBKSk7XG4gICAgICB2ZXJ0ZXguaW5kZXhCID0gcHJveHlCLmdldFN1cHBvcnQoZGVyb3RWZWMyKHRlbXAkNSwgeGZCMi5xLCBkMikpO1xuICAgICAgdHJhbnNmb3JtVmVjMih2ZXJ0ZXgud0IsIHhmQjIsIHByb3h5Qi5nZXRWZXJ0ZXgodmVydGV4LmluZGV4QikpO1xuICAgICAgc3ViVmVjMih2ZXJ0ZXgudywgdmVydGV4LndCLCB2ZXJ0ZXgud0EpO1xuICAgICAgKytpdGVyO1xuICAgICAgKytzdGF0cy5namtJdGVycztcbiAgICAgIHZhciBkdXBsaWNhdGUgPSBmYWxzZTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2F2ZUNvdW50OyArK2kpIHtcbiAgICAgICAgaWYgKHZlcnRleC5pbmRleEEgPT09IHNhdmVBW2ldICYmIHZlcnRleC5pbmRleEIgPT09IHNhdmVCW2ldKSB7XG4gICAgICAgICAgZHVwbGljYXRlID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGR1cGxpY2F0ZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgICsrc2ltcGxleC5tX2NvdW50O1xuICAgIH1cbiAgICBzdGF0cy5namtNYXhJdGVycyA9IG1hdGhfbWF4JDQoc3RhdHMuZ2prTWF4SXRlcnMsIGl0ZXIpO1xuICAgIHNpbXBsZXguZ2V0V2l0bmVzc1BvaW50cyhvdXRwdXQyLnBvaW50QSwgb3V0cHV0Mi5wb2ludEIpO1xuICAgIG91dHB1dDIuZGlzdGFuY2UgPSBkaXN0VmVjMihvdXRwdXQyLnBvaW50QSwgb3V0cHV0Mi5wb2ludEIpO1xuICAgIG91dHB1dDIuaXRlcmF0aW9ucyA9IGl0ZXI7XG4gICAgc2ltcGxleC53cml0ZUNhY2hlKGNhY2hlMik7XG4gICAgaWYgKGlucHV0Mi51c2VSYWRpaSkge1xuICAgICAgdmFyIHJBMiA9IHByb3h5QS5tX3JhZGl1cztcbiAgICAgIHZhciByQjIgPSBwcm94eUIubV9yYWRpdXM7XG4gICAgICBpZiAob3V0cHV0Mi5kaXN0YW5jZSA+IHJBMiArIHJCMiAmJiBvdXRwdXQyLmRpc3RhbmNlID4gRVBTSUxPTikge1xuICAgICAgICBvdXRwdXQyLmRpc3RhbmNlIC09IHJBMiArIHJCMjtcbiAgICAgICAgc3ViVmVjMihub3JtYWwkNCwgb3V0cHV0Mi5wb2ludEIsIG91dHB1dDIucG9pbnRBKTtcbiAgICAgICAgbm9ybWFsaXplVmVjMihub3JtYWwkNCk7XG4gICAgICAgIHBsdXNTY2FsZVZlYzIob3V0cHV0Mi5wb2ludEEsIHJBMiwgbm9ybWFsJDQpO1xuICAgICAgICBtaW51c1NjYWxlVmVjMihvdXRwdXQyLnBvaW50QiwgckIyLCBub3JtYWwkNCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcCA9IHN1YlZlYzIodGVtcCQ1LCBvdXRwdXQyLnBvaW50QSwgb3V0cHV0Mi5wb2ludEIpO1xuICAgICAgICBjb3B5VmVjMihvdXRwdXQyLnBvaW50QSwgcCk7XG4gICAgICAgIGNvcHlWZWMyKG91dHB1dDIucG9pbnRCLCBwKTtcbiAgICAgICAgb3V0cHV0Mi5kaXN0YW5jZSA9IDA7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICB2YXIgRGlzdGFuY2VQcm94eSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBEaXN0YW5jZVByb3h5MigpIHtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIHRoaXMubV9jb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV9yYWRpdXMgPSAwO1xuICAgICAgfVxuICAgICAgRGlzdGFuY2VQcm94eTIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMubV9jb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV9yYWRpdXMgPSAwO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5nZXRWZXJ0ZXhDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvdW50O1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5nZXRWZXJ0ZXggPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzW2luZGV4XTtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZVByb3h5Mi5wcm90b3R5cGUuZ2V0U3VwcG9ydCA9IGZ1bmN0aW9uKGQyKSB7XG4gICAgICAgIHZhciBiZXN0SW5kZXggPSAtMTtcbiAgICAgICAgdmFyIGJlc3RWYWx1ZSA9IC1JbmZpbml0eTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciB2YWx1ZSA9IGRvdFZlYzIodGhpcy5tX3ZlcnRpY2VzW2ldLCBkMik7XG4gICAgICAgICAgaWYgKHZhbHVlID4gYmVzdFZhbHVlKSB7XG4gICAgICAgICAgICBiZXN0SW5kZXggPSBpO1xuICAgICAgICAgICAgYmVzdFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiZXN0SW5kZXg7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VQcm94eTIucHJvdG90eXBlLmdldFN1cHBvcnRWZXJ0ZXggPSBmdW5jdGlvbihkMikge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzW3RoaXMuZ2V0U3VwcG9ydChkMildO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihzaGFwZSwgaW5kZXgpIHtcbiAgICAgICAgc2hhcGUuY29tcHV0ZURpc3RhbmNlUHJveHkodGhpcywgaW5kZXgpO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5zZXRWZXJ0aWNlcyA9IGZ1bmN0aW9uKHZlcnRpY2VzLCBjb3VudCwgcmFkaXVzKSB7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlcyA9IHZlcnRpY2VzO1xuICAgICAgICB0aGlzLm1fY291bnQgPSBjb3VudDtcbiAgICAgICAgdGhpcy5tX3JhZGl1cyA9IHJhZGl1cztcbiAgICAgIH07XG4gICAgICByZXR1cm4gRGlzdGFuY2VQcm94eTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBTaW1wbGV4VmVydGV4ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNpbXBsZXhWZXJ0ZXgyKCkge1xuICAgICAgICB0aGlzLndBID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAwO1xuICAgICAgICB0aGlzLndCID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSAwO1xuICAgICAgICB0aGlzLncgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLmEgPSAwO1xuICAgICAgfVxuICAgICAgU2ltcGxleFZlcnRleDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAwO1xuICAgICAgICB0aGlzLmluZGV4QiA9IDA7XG4gICAgICAgIHplcm9WZWMyKHRoaXMud0EpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLndCKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy53KTtcbiAgICAgICAgdGhpcy5hID0gMDtcbiAgICAgIH07XG4gICAgICBTaW1wbGV4VmVydGV4Mi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgdGhpcy5pbmRleEEgPSB2My5pbmRleEE7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gdjMuaW5kZXhCO1xuICAgICAgICBjb3B5VmVjMih0aGlzLndBLCB2My53QSk7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMud0IsIHYzLndCKTtcbiAgICAgICAgY29weVZlYzIodGhpcy53LCB2My53KTtcbiAgICAgICAgdGhpcy5hID0gdjMuYTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gU2ltcGxleFZlcnRleDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBzZWFyY2hEaXJlY3Rpb25fcmV1c2UgPSB2ZWMyKDAsIDApO1xuICB2YXIgY2xvc2VzdFBvaW50X3JldXNlID0gdmVjMigwLCAwKTtcbiAgdmFyIFNpbXBsZXggPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2ltcGxleDIoKSB7XG4gICAgICAgIHRoaXMubV92MSA9IG5ldyBTaW1wbGV4VmVydGV4KCk7XG4gICAgICAgIHRoaXMubV92MiA9IG5ldyBTaW1wbGV4VmVydGV4KCk7XG4gICAgICAgIHRoaXMubV92MyA9IG5ldyBTaW1wbGV4VmVydGV4KCk7XG4gICAgICAgIHRoaXMubV92ID0gW3RoaXMubV92MSwgdGhpcy5tX3YyLCB0aGlzLm1fdjNdO1xuICAgICAgfVxuICAgICAgU2ltcGxleDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX3YxLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5tX3YyLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5tX3YzLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gMDtcbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMubV9jb3VudCA9PT0gMykge1xuICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBcIitcIiArIHRoaXMubV9jb3VudCxcbiAgICAgICAgICAgIHRoaXMubV92MS5hLFxuICAgICAgICAgICAgdGhpcy5tX3YxLndBLngsXG4gICAgICAgICAgICB0aGlzLm1fdjEud0EueSxcbiAgICAgICAgICAgIHRoaXMubV92MS53Qi54LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndCLnksXG4gICAgICAgICAgICB0aGlzLm1fdjIuYSxcbiAgICAgICAgICAgIHRoaXMubV92Mi53QS54LFxuICAgICAgICAgICAgdGhpcy5tX3YyLndBLnksXG4gICAgICAgICAgICB0aGlzLm1fdjIud0IueCxcbiAgICAgICAgICAgIHRoaXMubV92Mi53Qi55LFxuICAgICAgICAgICAgdGhpcy5tX3YzLmEsXG4gICAgICAgICAgICB0aGlzLm1fdjMud0EueCxcbiAgICAgICAgICAgIHRoaXMubV92My53QS55LFxuICAgICAgICAgICAgdGhpcy5tX3YzLndCLngsXG4gICAgICAgICAgICB0aGlzLm1fdjMud0IueVxuICAgICAgICAgIF0udG9TdHJpbmcoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fY291bnQgPT09IDIpIHtcbiAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgXCIrXCIgKyB0aGlzLm1fY291bnQsXG4gICAgICAgICAgICB0aGlzLm1fdjEuYSxcbiAgICAgICAgICAgIHRoaXMubV92MS53QS54LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndBLnksXG4gICAgICAgICAgICB0aGlzLm1fdjEud0IueCxcbiAgICAgICAgICAgIHRoaXMubV92MS53Qi55LFxuICAgICAgICAgICAgdGhpcy5tX3YyLmEsXG4gICAgICAgICAgICB0aGlzLm1fdjIud0EueCxcbiAgICAgICAgICAgIHRoaXMubV92Mi53QS55LFxuICAgICAgICAgICAgdGhpcy5tX3YyLndCLngsXG4gICAgICAgICAgICB0aGlzLm1fdjIud0IueVxuICAgICAgICAgIF0udG9TdHJpbmcoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fY291bnQgPT09IDEpIHtcbiAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgXCIrXCIgKyB0aGlzLm1fY291bnQsXG4gICAgICAgICAgICB0aGlzLm1fdjEuYSxcbiAgICAgICAgICAgIHRoaXMubV92MS53QS54LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndBLnksXG4gICAgICAgICAgICB0aGlzLm1fdjEud0IueCxcbiAgICAgICAgICAgIHRoaXMubV92MS53Qi55XG4gICAgICAgICAgXS50b1N0cmluZygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBcIitcIiArIHRoaXMubV9jb3VudDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5yZWFkQ2FjaGUgPSBmdW5jdGlvbihjYWNoZTIsIHByb3h5QSwgdHJhbnNmb3JtQSwgcHJveHlCLCB0cmFuc2Zvcm1CKSB7XG4gICAgICAgIHRoaXMubV9jb3VudCA9IGNhY2hlMi5jb3VudDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciB2MyA9IHRoaXMubV92W2ldO1xuICAgICAgICAgIHYzLmluZGV4QSA9IGNhY2hlMi5pbmRleEFbaV07XG4gICAgICAgICAgdjMuaW5kZXhCID0gY2FjaGUyLmluZGV4QltpXTtcbiAgICAgICAgICB2YXIgd0FMb2NhbCA9IHByb3h5QS5nZXRWZXJ0ZXgodjMuaW5kZXhBKTtcbiAgICAgICAgICB2YXIgd0JMb2NhbCA9IHByb3h5Qi5nZXRWZXJ0ZXgodjMuaW5kZXhCKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHYzLndBLCB0cmFuc2Zvcm1BLCB3QUxvY2FsKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHYzLndCLCB0cmFuc2Zvcm1CLCB3QkxvY2FsKTtcbiAgICAgICAgICBzdWJWZWMyKHYzLncsIHYzLndCLCB2My53QSk7XG4gICAgICAgICAgdjMuYSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9jb3VudCA+IDEpIHtcbiAgICAgICAgICB2YXIgbWV0cmljMSA9IGNhY2hlMi5tZXRyaWM7XG4gICAgICAgICAgdmFyIG1ldHJpYzIgPSB0aGlzLmdldE1ldHJpYygpO1xuICAgICAgICAgIGlmIChtZXRyaWMyIDwgMC41ICogbWV0cmljMSB8fCAyICogbWV0cmljMSA8IG1ldHJpYzIgfHwgbWV0cmljMiA8IEVQU0lMT04pIHtcbiAgICAgICAgICAgIHRoaXMubV9jb3VudCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fY291bnQgPT09IDApIHtcbiAgICAgICAgICB2YXIgdjMgPSB0aGlzLm1fdlswXTtcbiAgICAgICAgICB2My5pbmRleEEgPSAwO1xuICAgICAgICAgIHYzLmluZGV4QiA9IDA7XG4gICAgICAgICAgdmFyIHdBTG9jYWwgPSBwcm94eUEuZ2V0VmVydGV4KDApO1xuICAgICAgICAgIHZhciB3QkxvY2FsID0gcHJveHlCLmdldFZlcnRleCgwKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHYzLndBLCB0cmFuc2Zvcm1BLCB3QUxvY2FsKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHYzLndCLCB0cmFuc2Zvcm1CLCB3QkxvY2FsKTtcbiAgICAgICAgICBzdWJWZWMyKHYzLncsIHYzLndCLCB2My53QSk7XG4gICAgICAgICAgdjMuYSA9IDE7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS53cml0ZUNhY2hlID0gZnVuY3Rpb24oY2FjaGUyKSB7XG4gICAgICAgIGNhY2hlMi5tZXRyaWMgPSB0aGlzLmdldE1ldHJpYygpO1xuICAgICAgICBjYWNoZTIuY291bnQgPSB0aGlzLm1fY291bnQ7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICBjYWNoZTIuaW5kZXhBW2ldID0gdGhpcy5tX3ZbaV0uaW5kZXhBO1xuICAgICAgICAgIGNhY2hlMi5pbmRleEJbaV0gPSB0aGlzLm1fdltpXS5pbmRleEI7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUuZ2V0U2VhcmNoRGlyZWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2MTMgPSB0aGlzLm1fdjE7XG4gICAgICAgIHZhciB2MjIgPSB0aGlzLm1fdjI7XG4gICAgICAgIHN3aXRjaCAodGhpcy5tX2NvdW50KSB7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIHNldFZlYzIoc2VhcmNoRGlyZWN0aW9uX3JldXNlLCAtdjEzLncueCwgLXYxMy53LnkpO1xuICAgICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgICAgc3ViVmVjMihlMTIsIHYyMi53LCB2MTMudyk7XG4gICAgICAgICAgICB2YXIgc2duID0gLWNyb3NzVmVjMlZlYzIoZTEyLCB2MTMudyk7XG4gICAgICAgICAgICBpZiAoc2duID4gMCkge1xuICAgICAgICAgICAgICByZXR1cm4gc2V0VmVjMihzZWFyY2hEaXJlY3Rpb25fcmV1c2UsIC1lMTIueSwgZTEyLngpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHNldFZlYzIoc2VhcmNoRGlyZWN0aW9uX3JldXNlLCBlMTIueSwgLWUxMi54KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB6ZXJvVmVjMihzZWFyY2hEaXJlY3Rpb25fcmV1c2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLmdldENsb3Nlc3RQb2ludCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdjEzID0gdGhpcy5tX3YxO1xuICAgICAgICB2YXIgdjIyID0gdGhpcy5tX3YyO1xuICAgICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHJldHVybiB6ZXJvVmVjMihjbG9zZXN0UG9pbnRfcmV1c2UpO1xuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHJldHVybiBjb3B5VmVjMihjbG9zZXN0UG9pbnRfcmV1c2UsIHYxMy53KTtcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gY29tYmluZTJWZWMyKGNsb3Nlc3RQb2ludF9yZXVzZSwgdjEzLmEsIHYxMy53LCB2MjIuYSwgdjIyLncpO1xuICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiB6ZXJvVmVjMihjbG9zZXN0UG9pbnRfcmV1c2UpO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gemVyb1ZlYzIoY2xvc2VzdFBvaW50X3JldXNlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5nZXRXaXRuZXNzUG9pbnRzID0gZnVuY3Rpb24ocEEyLCBwQjIpIHtcbiAgICAgICAgdmFyIHYxMyA9IHRoaXMubV92MTtcbiAgICAgICAgdmFyIHYyMiA9IHRoaXMubV92MjtcbiAgICAgICAgdmFyIHYzID0gdGhpcy5tX3YzO1xuICAgICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGNvcHlWZWMyKHBBMiwgdjEzLndBKTtcbiAgICAgICAgICAgIGNvcHlWZWMyKHBCMiwgdjEzLndCKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGNvbWJpbmUyVmVjMihwQTIsIHYxMy5hLCB2MTMud0EsIHYyMi5hLCB2MjIud0EpO1xuICAgICAgICAgICAgY29tYmluZTJWZWMyKHBCMiwgdjEzLmEsIHYxMy53QiwgdjIyLmEsIHYyMi53Qik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjb21iaW5lM1ZlYzIocEEyLCB2MTMuYSwgdjEzLndBLCB2MjIuYSwgdjIyLndBLCB2My5hLCB2My53QSk7XG4gICAgICAgICAgICBjb3B5VmVjMihwQjIsIHBBMik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5nZXRNZXRyaWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gZGlzdFZlYzIodGhpcy5tX3YxLncsIHRoaXMubV92Mi53KTtcbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gY3Jvc3NWZWMyVmVjMihzdWJWZWMyKHRlbXAxLCB0aGlzLm1fdjIudywgdGhpcy5tX3YxLncpLCBzdWJWZWMyKHRlbXAyLCB0aGlzLm1fdjMudywgdGhpcy5tX3YxLncpKTtcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUuc29sdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICB0aGlzLnNvbHZlMigpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgdGhpcy5zb2x2ZTMoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLnNvbHZlMiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdzEgPSB0aGlzLm1fdjEudztcbiAgICAgICAgdmFyIHcyID0gdGhpcy5tX3YyLnc7XG4gICAgICAgIHN1YlZlYzIoZTEyLCB3MiwgdzEpO1xuICAgICAgICB2YXIgZDEyXzIgPSAtZG90VmVjMih3MSwgZTEyKTtcbiAgICAgICAgaWYgKGQxMl8yIDw9IDApIHtcbiAgICAgICAgICB0aGlzLm1fdjEuYSA9IDE7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGQxMl8xID0gZG90VmVjMih3MiwgZTEyKTtcbiAgICAgICAgaWYgKGQxMl8xIDw9IDApIHtcbiAgICAgICAgICB0aGlzLm1fdjIuYSA9IDE7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgICB0aGlzLm1fdjEuc2V0KHRoaXMubV92Mik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnZfZDEyID0gMSAvIChkMTJfMSArIGQxMl8yKTtcbiAgICAgICAgdGhpcy5tX3YxLmEgPSBkMTJfMSAqIGludl9kMTI7XG4gICAgICAgIHRoaXMubV92Mi5hID0gZDEyXzIgKiBpbnZfZDEyO1xuICAgICAgICB0aGlzLm1fY291bnQgPSAyO1xuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5zb2x2ZTMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHcxID0gdGhpcy5tX3YxLnc7XG4gICAgICAgIHZhciB3MiA9IHRoaXMubV92Mi53O1xuICAgICAgICB2YXIgdzMgPSB0aGlzLm1fdjMudztcbiAgICAgICAgc3ViVmVjMihlMTIsIHcyLCB3MSk7XG4gICAgICAgIHZhciB3MWUxMiA9IGRvdFZlYzIodzEsIGUxMik7XG4gICAgICAgIHZhciB3MmUxMiA9IGRvdFZlYzIodzIsIGUxMik7XG4gICAgICAgIHZhciBkMTJfMSA9IHcyZTEyO1xuICAgICAgICB2YXIgZDEyXzIgPSAtdzFlMTI7XG4gICAgICAgIHN1YlZlYzIoZTEzLCB3MywgdzEpO1xuICAgICAgICB2YXIgdzFlMTMgPSBkb3RWZWMyKHcxLCBlMTMpO1xuICAgICAgICB2YXIgdzNlMTMgPSBkb3RWZWMyKHczLCBlMTMpO1xuICAgICAgICB2YXIgZDEzXzEgPSB3M2UxMztcbiAgICAgICAgdmFyIGQxM18yID0gLXcxZTEzO1xuICAgICAgICBzdWJWZWMyKGUyMywgdzMsIHcyKTtcbiAgICAgICAgdmFyIHcyZTIzID0gZG90VmVjMih3MiwgZTIzKTtcbiAgICAgICAgdmFyIHczZTIzID0gZG90VmVjMih3MywgZTIzKTtcbiAgICAgICAgdmFyIGQyM18xID0gdzNlMjM7XG4gICAgICAgIHZhciBkMjNfMiA9IC13MmUyMztcbiAgICAgICAgdmFyIG4xMjMgPSBjcm9zc1ZlYzJWZWMyKGUxMiwgZTEzKTtcbiAgICAgICAgdmFyIGQxMjNfMSA9IG4xMjMgKiBjcm9zc1ZlYzJWZWMyKHcyLCB3Myk7XG4gICAgICAgIHZhciBkMTIzXzIgPSBuMTIzICogY3Jvc3NWZWMyVmVjMih3MywgdzEpO1xuICAgICAgICB2YXIgZDEyM18zID0gbjEyMyAqIGNyb3NzVmVjMlZlYzIodzEsIHcyKTtcbiAgICAgICAgaWYgKGQxMl8yIDw9IDAgJiYgZDEzXzIgPD0gMCkge1xuICAgICAgICAgIHRoaXMubV92MS5hID0gMTtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZDEyXzEgPiAwICYmIGQxMl8yID4gMCAmJiBkMTIzXzMgPD0gMCkge1xuICAgICAgICAgIHZhciBpbnZfZDEyID0gMSAvIChkMTJfMSArIGQxMl8yKTtcbiAgICAgICAgICB0aGlzLm1fdjEuYSA9IGQxMl8xICogaW52X2QxMjtcbiAgICAgICAgICB0aGlzLm1fdjIuYSA9IGQxMl8yICogaW52X2QxMjtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAyO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZDEzXzEgPiAwICYmIGQxM18yID4gMCAmJiBkMTIzXzIgPD0gMCkge1xuICAgICAgICAgIHZhciBpbnZfZDEzID0gMSAvIChkMTNfMSArIGQxM18yKTtcbiAgICAgICAgICB0aGlzLm1fdjEuYSA9IGQxM18xICogaW52X2QxMztcbiAgICAgICAgICB0aGlzLm1fdjMuYSA9IGQxM18yICogaW52X2QxMztcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAyO1xuICAgICAgICAgIHRoaXMubV92Mi5zZXQodGhpcy5tX3YzKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQxMl8xIDw9IDAgJiYgZDIzXzIgPD0gMCkge1xuICAgICAgICAgIHRoaXMubV92Mi5hID0gMTtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xuICAgICAgICAgIHRoaXMubV92MS5zZXQodGhpcy5tX3YyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQxM18xIDw9IDAgJiYgZDIzXzEgPD0gMCkge1xuICAgICAgICAgIHRoaXMubV92My5hID0gMTtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xuICAgICAgICAgIHRoaXMubV92MS5zZXQodGhpcy5tX3YzKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQyM18xID4gMCAmJiBkMjNfMiA+IDAgJiYgZDEyM18xIDw9IDApIHtcbiAgICAgICAgICB2YXIgaW52X2QyMyA9IDEgLyAoZDIzXzEgKyBkMjNfMik7XG4gICAgICAgICAgdGhpcy5tX3YyLmEgPSBkMjNfMSAqIGludl9kMjM7XG4gICAgICAgICAgdGhpcy5tX3YzLmEgPSBkMjNfMiAqIGludl9kMjM7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMjtcbiAgICAgICAgICB0aGlzLm1fdjEuc2V0KHRoaXMubV92Myk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnZfZDEyMyA9IDEgLyAoZDEyM18xICsgZDEyM18yICsgZDEyM18zKTtcbiAgICAgICAgdGhpcy5tX3YxLmEgPSBkMTIzXzEgKiBpbnZfZDEyMztcbiAgICAgICAgdGhpcy5tX3YyLmEgPSBkMTIzXzIgKiBpbnZfZDEyMztcbiAgICAgICAgdGhpcy5tX3YzLmEgPSBkMTIzXzMgKiBpbnZfZDEyMztcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gMztcbiAgICAgIH07XG4gICAgICByZXR1cm4gU2ltcGxleDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBzaW1wbGV4ID0gbmV3IFNpbXBsZXgoKTtcbiAgdmFyIGlucHV0JDEgPSBuZXcgRGlzdGFuY2VJbnB1dCgpO1xuICB2YXIgY2FjaGUkMSA9IG5ldyBTaW1wbGV4Q2FjaGUoKTtcbiAgdmFyIG91dHB1dCQxID0gbmV3IERpc3RhbmNlT3V0cHV0KCk7XG4gIHZhciB0ZXN0T3ZlcmxhcCA9IGZ1bmN0aW9uKHNoYXBlQSwgaW5kZXhBLCBzaGFwZUIsIGluZGV4QiwgeGZBMiwgeGZCMikge1xuICAgIGlucHV0JDEucmVjeWNsZSgpO1xuICAgIGlucHV0JDEucHJveHlBLnNldChzaGFwZUEsIGluZGV4QSk7XG4gICAgaW5wdXQkMS5wcm94eUIuc2V0KHNoYXBlQiwgaW5kZXhCKTtcbiAgICBjb3B5VHJhbnNmb3JtKGlucHV0JDEudHJhbnNmb3JtQSwgeGZBMik7XG4gICAgY29weVRyYW5zZm9ybShpbnB1dCQxLnRyYW5zZm9ybUIsIHhmQjIpO1xuICAgIGlucHV0JDEudXNlUmFkaWkgPSB0cnVlO1xuICAgIG91dHB1dCQxLnJlY3ljbGUoKTtcbiAgICBjYWNoZSQxLnJlY3ljbGUoKTtcbiAgICBEaXN0YW5jZShvdXRwdXQkMSwgY2FjaGUkMSwgaW5wdXQkMSk7XG4gICAgcmV0dXJuIG91dHB1dCQxLmRpc3RhbmNlIDwgMTAgKiBFUFNJTE9OO1xuICB9O1xuICBEaXN0YW5jZS50ZXN0T3ZlcmxhcCA9IHRlc3RPdmVybGFwO1xuICBEaXN0YW5jZS5JbnB1dCA9IERpc3RhbmNlSW5wdXQ7XG4gIERpc3RhbmNlLk91dHB1dCA9IERpc3RhbmNlT3V0cHV0O1xuICBEaXN0YW5jZS5Qcm94eSA9IERpc3RhbmNlUHJveHk7XG4gIERpc3RhbmNlLkNhY2hlID0gU2ltcGxleENhY2hlO1xuICB2YXIgU2hhcGVDYXN0SW5wdXQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2hhcGVDYXN0SW5wdXQyKCkge1xuICAgICAgICB0aGlzLnByb3h5QSA9IG5ldyBEaXN0YW5jZVByb3h5KCk7XG4gICAgICAgIHRoaXMucHJveHlCID0gbmV3IERpc3RhbmNlUHJveHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1BID0gVHJhbnNmb3JtLmlkZW50aXR5KCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtQiA9IFRyYW5zZm9ybS5pZGVudGl0eSgpO1xuICAgICAgICB0aGlzLnRyYW5zbGF0aW9uQiA9IFZlYzIuemVybygpO1xuICAgICAgfVxuICAgICAgU2hhcGVDYXN0SW5wdXQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucHJveHlBLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5wcm94eUIucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUEuc2V0SWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1CLnNldElkZW50aXR5KCk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMudHJhbnNsYXRpb25CKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gU2hhcGVDYXN0SW5wdXQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgU2hhcGVDYXN0T3V0cHV0ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICAvKiBAX19QVVJFX18gKi8gZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTaGFwZUNhc3RPdXRwdXQyKCkge1xuICAgICAgICB0aGlzLnBvaW50ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMubm9ybWFsID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMubGFtYmRhID0gMTtcbiAgICAgICAgdGhpcy5pdGVyYXRpb25zID0gMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBTaGFwZUNhc3RPdXRwdXQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgU2hhcGVDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyKSB7XG4gICAgb3V0cHV0Mi5pdGVyYXRpb25zID0gMDtcbiAgICBvdXRwdXQyLmxhbWJkYSA9IDE7XG4gICAgb3V0cHV0Mi5ub3JtYWwuc2V0WmVybygpO1xuICAgIG91dHB1dDIucG9pbnQuc2V0WmVybygpO1xuICAgIHZhciBwcm94eUEgPSBpbnB1dDIucHJveHlBO1xuICAgIHZhciBwcm94eUIgPSBpbnB1dDIucHJveHlCO1xuICAgIHZhciByYWRpdXNBID0gbWF0aF9tYXgkNChwcm94eUEubV9yYWRpdXMsIFNldHRpbmdzSW50ZXJuYWwucG9seWdvblJhZGl1cyk7XG4gICAgdmFyIHJhZGl1c0IgPSBtYXRoX21heCQ0KHByb3h5Qi5tX3JhZGl1cywgU2V0dGluZ3NJbnRlcm5hbC5wb2x5Z29uUmFkaXVzKTtcbiAgICB2YXIgcmFkaXVzID0gcmFkaXVzQSArIHJhZGl1c0I7XG4gICAgdmFyIHhmQTIgPSBpbnB1dDIudHJhbnNmb3JtQTtcbiAgICB2YXIgeGZCMiA9IGlucHV0Mi50cmFuc2Zvcm1CO1xuICAgIHZhciByID0gaW5wdXQyLnRyYW5zbGF0aW9uQjtcbiAgICB2YXIgbjIgPSBWZWMyLnplcm8oKTtcbiAgICB2YXIgbGFtYmRhID0gMDtcbiAgICB2YXIgc2ltcGxleDIgPSBuZXcgU2ltcGxleCgpO1xuICAgIHNpbXBsZXgyLm1fY291bnQgPSAwO1xuICAgIHZhciB2ZXJ0aWNlcyA9IHNpbXBsZXgyLm1fdjtcbiAgICB2YXIgaW5kZXhBID0gcHJveHlBLmdldFN1cHBvcnQoUm90Lm11bFRWZWMyKHhmQTIucSwgVmVjMi5uZWcocikpKTtcbiAgICB2YXIgd0EgPSBUcmFuc2Zvcm0ubXVsVmVjMih4ZkEyLCBwcm94eUEuZ2V0VmVydGV4KGluZGV4QSkpO1xuICAgIHZhciBpbmRleEIgPSBwcm94eUIuZ2V0U3VwcG9ydChSb3QubXVsVFZlYzIoeGZCMi5xLCByKSk7XG4gICAgdmFyIHdCID0gVHJhbnNmb3JtLm11bFZlYzIoeGZCMiwgcHJveHlCLmdldFZlcnRleChpbmRleEIpKTtcbiAgICB2YXIgdjMgPSBWZWMyLnN1Yih3QSwgd0IpO1xuICAgIHZhciBzaWdtYSA9IG1hdGhfbWF4JDQoU2V0dGluZ3NJbnRlcm5hbC5wb2x5Z29uUmFkaXVzLCByYWRpdXMgLSBTZXR0aW5nc0ludGVybmFsLnBvbHlnb25SYWRpdXMpO1xuICAgIHZhciB0b2xlcmFuY2UgPSAwLjUgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgdmFyIGtfbWF4SXRlcnMgPSAyMDtcbiAgICB2YXIgaXRlciA9IDA7XG4gICAgd2hpbGUgKGl0ZXIgPCBrX21heEl0ZXJzICYmIHYzLmxlbmd0aCgpIC0gc2lnbWEgPiB0b2xlcmFuY2UpIHtcbiAgICAgIG91dHB1dDIuaXRlcmF0aW9ucyArPSAxO1xuICAgICAgaW5kZXhBID0gcHJveHlBLmdldFN1cHBvcnQoUm90Lm11bFRWZWMyKHhmQTIucSwgVmVjMi5uZWcodjMpKSk7XG4gICAgICB3QSA9IFRyYW5zZm9ybS5tdWxWZWMyKHhmQTIsIHByb3h5QS5nZXRWZXJ0ZXgoaW5kZXhBKSk7XG4gICAgICBpbmRleEIgPSBwcm94eUIuZ2V0U3VwcG9ydChSb3QubXVsVFZlYzIoeGZCMi5xLCB2MykpO1xuICAgICAgd0IgPSBUcmFuc2Zvcm0ubXVsVmVjMih4ZkIyLCBwcm94eUIuZ2V0VmVydGV4KGluZGV4QikpO1xuICAgICAgdmFyIHAgPSBWZWMyLnN1Yih3QSwgd0IpO1xuICAgICAgdjMubm9ybWFsaXplKCk7XG4gICAgICB2YXIgdnAgPSBWZWMyLmRvdCh2MywgcCk7XG4gICAgICB2YXIgdnIgPSBWZWMyLmRvdCh2Mywgcik7XG4gICAgICBpZiAodnAgLSBzaWdtYSA+IGxhbWJkYSAqIHZyKSB7XG4gICAgICAgIGlmICh2ciA8PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxhbWJkYSA9ICh2cCAtIHNpZ21hKSAvIHZyO1xuICAgICAgICBpZiAobGFtYmRhID4gMSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBuMi5zZXRNdWwoLTEsIHYzKTtcbiAgICAgICAgc2ltcGxleDIubV9jb3VudCA9IDA7XG4gICAgICB9XG4gICAgICB2YXIgdmVydGV4ID0gdmVydGljZXNbc2ltcGxleDIubV9jb3VudF07XG4gICAgICB2ZXJ0ZXguaW5kZXhBID0gaW5kZXhCO1xuICAgICAgdmVydGV4LndBID0gVmVjMi5jb21iaW5lKDEsIHdCLCBsYW1iZGEsIHIpO1xuICAgICAgdmVydGV4LmluZGV4QiA9IGluZGV4QTtcbiAgICAgIHZlcnRleC53QiA9IHdBO1xuICAgICAgdmVydGV4LncgPSBWZWMyLnN1Yih2ZXJ0ZXgud0IsIHZlcnRleC53QSk7XG4gICAgICB2ZXJ0ZXguYSA9IDE7XG4gICAgICBzaW1wbGV4Mi5tX2NvdW50ICs9IDE7XG4gICAgICBzd2l0Y2ggKHNpbXBsZXgyLm1fY291bnQpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgc2ltcGxleDIuc29sdmUyKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBzaW1wbGV4Mi5zb2x2ZTMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmIChzaW1wbGV4Mi5tX2NvdW50ID09IDMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdjMuc2V0VmVjMihzaW1wbGV4Mi5nZXRDbG9zZXN0UG9pbnQoKSk7XG4gICAgICArK2l0ZXI7XG4gICAgfVxuICAgIGlmIChpdGVyID09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIHBvaW50QTIgPSBWZWMyLnplcm8oKTtcbiAgICB2YXIgcG9pbnRCMiA9IFZlYzIuemVybygpO1xuICAgIHNpbXBsZXgyLmdldFdpdG5lc3NQb2ludHMocG9pbnRCMiwgcG9pbnRBMik7XG4gICAgaWYgKHYzLmxlbmd0aFNxdWFyZWQoKSA+IDApIHtcbiAgICAgIG4yLnNldE11bCgtMSwgdjMpO1xuICAgICAgbjIubm9ybWFsaXplKCk7XG4gICAgfVxuICAgIG91dHB1dDIucG9pbnQgPSBWZWMyLmNvbWJpbmUoMSwgcG9pbnRBMiwgcmFkaXVzQSwgbjIpO1xuICAgIG91dHB1dDIubm9ybWFsID0gbjI7XG4gICAgb3V0cHV0Mi5sYW1iZGEgPSBsYW1iZGE7XG4gICAgb3V0cHV0Mi5pdGVyYXRpb25zID0gaXRlcjtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcbiAgdmFyIG1hdGhfYWJzJDcgPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfbWF4JDMgPSBNYXRoLm1heDtcbiAgdmFyIFRPSUlucHV0ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFRPSUlucHV0MigpIHtcbiAgICAgICAgdGhpcy5wcm94eUEgPSBuZXcgRGlzdGFuY2VQcm94eSgpO1xuICAgICAgICB0aGlzLnByb3h5QiA9IG5ldyBEaXN0YW5jZVByb3h5KCk7XG4gICAgICAgIHRoaXMuc3dlZXBBID0gbmV3IFN3ZWVwKCk7XG4gICAgICAgIHRoaXMuc3dlZXBCID0gbmV3IFN3ZWVwKCk7XG4gICAgICB9XG4gICAgICBUT0lJbnB1dDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5wcm94eUEucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnByb3h5Qi5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMuc3dlZXBBLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5zd2VlcEIucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnRNYXggPSAtMTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVE9JSW5wdXQyO1xuICAgIH0oKVxuICApO1xuICBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZSA9IHZvaWQgMDtcbiAgKGZ1bmN0aW9uKFRPSU91dHB1dFN0YXRlMikge1xuICAgIFRPSU91dHB1dFN0YXRlMltUT0lPdXRwdXRTdGF0ZTJbXCJlX3Vuc2V0XCJdID0gLTFdID0gXCJlX3Vuc2V0XCI7XG4gICAgVE9JT3V0cHV0U3RhdGUyW1RPSU91dHB1dFN0YXRlMltcImVfdW5rbm93blwiXSA9IDBdID0gXCJlX3Vua25vd25cIjtcbiAgICBUT0lPdXRwdXRTdGF0ZTJbVE9JT3V0cHV0U3RhdGUyW1wiZV9mYWlsZWRcIl0gPSAxXSA9IFwiZV9mYWlsZWRcIjtcbiAgICBUT0lPdXRwdXRTdGF0ZTJbVE9JT3V0cHV0U3RhdGUyW1wiZV9vdmVybGFwcGVkXCJdID0gMl0gPSBcImVfb3ZlcmxhcHBlZFwiO1xuICAgIFRPSU91dHB1dFN0YXRlMltUT0lPdXRwdXRTdGF0ZTJbXCJlX3RvdWNoaW5nXCJdID0gM10gPSBcImVfdG91Y2hpbmdcIjtcbiAgICBUT0lPdXRwdXRTdGF0ZTJbVE9JT3V0cHV0U3RhdGUyW1wiZV9zZXBhcmF0ZWRcIl0gPSA0XSA9IFwiZV9zZXBhcmF0ZWRcIjtcbiAgfSkoZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUgfHwgKGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlID0ge30pKTtcbiAgdmFyIFRPSU91dHB1dCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBUT0lPdXRwdXQyKCkge1xuICAgICAgICB0aGlzLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV91bnNldDtcbiAgICAgICAgdGhpcy50ID0gLTE7XG4gICAgICB9XG4gICAgICBUT0lPdXRwdXQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLnQgPSAtMTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVE9JT3V0cHV0MjtcbiAgICB9KClcbiAgKTtcbiAgc3RhdHMudG9pVGltZSA9IDA7XG4gIHN0YXRzLnRvaU1heFRpbWUgPSAwO1xuICBzdGF0cy50b2lDYWxscyA9IDA7XG4gIHN0YXRzLnRvaUl0ZXJzID0gMDtcbiAgc3RhdHMudG9pTWF4SXRlcnMgPSAwO1xuICBzdGF0cy50b2lSb290SXRlcnMgPSAwO1xuICBzdGF0cy50b2lNYXhSb290SXRlcnMgPSAwO1xuICB2YXIgZGlzdGFuY2VJbnB1dCA9IG5ldyBEaXN0YW5jZUlucHV0KCk7XG4gIHZhciBkaXN0YW5jZU91dHB1dCA9IG5ldyBEaXN0YW5jZU91dHB1dCgpO1xuICB2YXIgY2FjaGUgPSBuZXcgU2ltcGxleENhY2hlKCk7XG4gIHZhciB4ZkEkMSA9IHRyYW5zZm9ybSgwLCAwLCAwKTtcbiAgdmFyIHhmQiQxID0gdHJhbnNmb3JtKDAsIDAsIDApO1xuICB2YXIgdGVtcCQ0ID0gdmVjMigwLCAwKTtcbiAgdmFyIHBvaW50QSQyID0gdmVjMigwLCAwKTtcbiAgdmFyIHBvaW50QiQyID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbCQzID0gdmVjMigwLCAwKTtcbiAgdmFyIGF4aXNBID0gdmVjMigwLCAwKTtcbiAgdmFyIGF4aXNCID0gdmVjMigwLCAwKTtcbiAgdmFyIGxvY2FsUG9pbnRBID0gdmVjMigwLCAwKTtcbiAgdmFyIGxvY2FsUG9pbnRCID0gdmVjMigwLCAwKTtcbiAgdmFyIFRpbWVPZkltcGFjdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0Mikge1xuICAgIHZhciB0aW1lciA9IFRpbWVyLm5vdygpO1xuICAgICsrc3RhdHMudG9pQ2FsbHM7XG4gICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfdW5rbm93bjtcbiAgICBvdXRwdXQyLnQgPSBpbnB1dDIudE1heDtcbiAgICB2YXIgcHJveHlBID0gaW5wdXQyLnByb3h5QTtcbiAgICB2YXIgcHJveHlCID0gaW5wdXQyLnByb3h5QjtcbiAgICB2YXIgc3dlZXBBID0gaW5wdXQyLnN3ZWVwQTtcbiAgICB2YXIgc3dlZXBCID0gaW5wdXQyLnN3ZWVwQjtcbiAgICBzd2VlcEEubm9ybWFsaXplKCk7XG4gICAgc3dlZXBCLm5vcm1hbGl6ZSgpO1xuICAgIHZhciB0TWF4ID0gaW5wdXQyLnRNYXg7XG4gICAgdmFyIHRvdGFsUmFkaXVzID0gcHJveHlBLm1fcmFkaXVzICsgcHJveHlCLm1fcmFkaXVzO1xuICAgIHZhciB0YXJnZXQgPSBtYXRoX21heCQzKFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCwgdG90YWxSYWRpdXMgLSAzICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKTtcbiAgICB2YXIgdG9sZXJhbmNlID0gMC4yNSAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICB2YXIgdDEgPSAwO1xuICAgIHZhciBrX21heEl0ZXJhdGlvbnMgPSBTZXR0aW5nc0ludGVybmFsLm1heFRPSUl0ZXJhdGlvbnM7XG4gICAgdmFyIGl0ZXIgPSAwO1xuICAgIGNhY2hlLnJlY3ljbGUoKTtcbiAgICBkaXN0YW5jZUlucHV0LnByb3h5QS5zZXRWZXJ0aWNlcyhwcm94eUEubV92ZXJ0aWNlcywgcHJveHlBLm1fY291bnQsIHByb3h5QS5tX3JhZGl1cyk7XG4gICAgZGlzdGFuY2VJbnB1dC5wcm94eUIuc2V0VmVydGljZXMocHJveHlCLm1fdmVydGljZXMsIHByb3h5Qi5tX2NvdW50LCBwcm94eUIubV9yYWRpdXMpO1xuICAgIGRpc3RhbmNlSW5wdXQudXNlUmFkaWkgPSBmYWxzZTtcbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgc3dlZXBBLmdldFRyYW5zZm9ybSh4ZkEkMSwgdDEpO1xuICAgICAgc3dlZXBCLmdldFRyYW5zZm9ybSh4ZkIkMSwgdDEpO1xuICAgICAgY29weVRyYW5zZm9ybShkaXN0YW5jZUlucHV0LnRyYW5zZm9ybUEsIHhmQSQxKTtcbiAgICAgIGNvcHlUcmFuc2Zvcm0oZGlzdGFuY2VJbnB1dC50cmFuc2Zvcm1CLCB4ZkIkMSk7XG4gICAgICBEaXN0YW5jZShkaXN0YW5jZU91dHB1dCwgY2FjaGUsIGRpc3RhbmNlSW5wdXQpO1xuICAgICAgaWYgKGRpc3RhbmNlT3V0cHV0LmRpc3RhbmNlIDw9IDApIHtcbiAgICAgICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfb3ZlcmxhcHBlZDtcbiAgICAgICAgb3V0cHV0Mi50ID0gMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAoZGlzdGFuY2VPdXRwdXQuZGlzdGFuY2UgPCB0YXJnZXQgKyB0b2xlcmFuY2UpIHtcbiAgICAgICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfdG91Y2hpbmc7XG4gICAgICAgIG91dHB1dDIudCA9IHQxO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHNlcGFyYXRpb25GdW5jdGlvbi5pbml0aWFsaXplKGNhY2hlLCBwcm94eUEsIHN3ZWVwQSwgcHJveHlCLCBzd2VlcEIsIHQxKTtcbiAgICAgIHZhciBkb25lID0gZmFsc2U7XG4gICAgICB2YXIgdDIgPSB0TWF4O1xuICAgICAgdmFyIHB1c2hCYWNrSXRlciA9IDA7XG4gICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgczIgPSBzZXBhcmF0aW9uRnVuY3Rpb24uZmluZE1pblNlcGFyYXRpb24odDIpO1xuICAgICAgICBpZiAoczIgPiB0YXJnZXQgKyB0b2xlcmFuY2UpIHtcbiAgICAgICAgICBvdXRwdXQyLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV9zZXBhcmF0ZWQ7XG4gICAgICAgICAgb3V0cHV0Mi50ID0gdE1heDtcbiAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAoczIgPiB0YXJnZXQgLSB0b2xlcmFuY2UpIHtcbiAgICAgICAgICB0MSA9IHQyO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzMSA9IHNlcGFyYXRpb25GdW5jdGlvbi5ldmFsdWF0ZSh0MSk7XG4gICAgICAgIGlmIChzMSA8IHRhcmdldCAtIHRvbGVyYW5jZSkge1xuICAgICAgICAgIG91dHB1dDIuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX2ZhaWxlZDtcbiAgICAgICAgICBvdXRwdXQyLnQgPSB0MTtcbiAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAoczEgPD0gdGFyZ2V0ICsgdG9sZXJhbmNlKSB7XG4gICAgICAgICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfdG91Y2hpbmc7XG4gICAgICAgICAgb3V0cHV0Mi50ID0gdDE7XG4gICAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvb3RJdGVyQ291bnQgPSAwO1xuICAgICAgICB2YXIgYTEgPSB0MTtcbiAgICAgICAgdmFyIGEyID0gdDI7XG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgdmFyIHQgPSB2b2lkIDA7XG4gICAgICAgICAgaWYgKHJvb3RJdGVyQ291bnQgJiAxKSB7XG4gICAgICAgICAgICB0ID0gYTEgKyAodGFyZ2V0IC0gczEpICogKGEyIC0gYTEpIC8gKHMyIC0gczEpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0ID0gMC41ICogKGExICsgYTIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICArK3Jvb3RJdGVyQ291bnQ7XG4gICAgICAgICAgKytzdGF0cy50b2lSb290SXRlcnM7XG4gICAgICAgICAgdmFyIHMzID0gc2VwYXJhdGlvbkZ1bmN0aW9uLmV2YWx1YXRlKHQpO1xuICAgICAgICAgIGlmIChtYXRoX2FicyQ3KHMzIC0gdGFyZ2V0KSA8IHRvbGVyYW5jZSkge1xuICAgICAgICAgICAgdDIgPSB0O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzMyA+IHRhcmdldCkge1xuICAgICAgICAgICAgYTEgPSB0O1xuICAgICAgICAgICAgczEgPSBzMztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYTIgPSB0O1xuICAgICAgICAgICAgczIgPSBzMztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHJvb3RJdGVyQ291bnQgPT09IDUwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc3RhdHMudG9pTWF4Um9vdEl0ZXJzID0gbWF0aF9tYXgkMyhzdGF0cy50b2lNYXhSb290SXRlcnMsIHJvb3RJdGVyQ291bnQpO1xuICAgICAgICArK3B1c2hCYWNrSXRlcjtcbiAgICAgICAgaWYgKHB1c2hCYWNrSXRlciA9PT0gU2V0dGluZ3NJbnRlcm5hbC5tYXhQb2x5Z29uVmVydGljZXMpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgKytpdGVyO1xuICAgICAgKytzdGF0cy50b2lJdGVycztcbiAgICAgIGlmIChkb25lKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKGl0ZXIgPT09IGtfbWF4SXRlcmF0aW9ucykge1xuICAgICAgICBvdXRwdXQyLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV9mYWlsZWQ7XG4gICAgICAgIG91dHB1dDIudCA9IHQxO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgc3RhdHMudG9pTWF4SXRlcnMgPSBtYXRoX21heCQzKHN0YXRzLnRvaU1heEl0ZXJzLCBpdGVyKTtcbiAgICB2YXIgdGltZSA9IFRpbWVyLmRpZmYodGltZXIpO1xuICAgIHN0YXRzLnRvaU1heFRpbWUgPSBtYXRoX21heCQzKHN0YXRzLnRvaU1heFRpbWUsIHRpbWUpO1xuICAgIHN0YXRzLnRvaVRpbWUgKz0gdGltZTtcbiAgICBzZXBhcmF0aW9uRnVuY3Rpb24ucmVjeWNsZSgpO1xuICB9O1xuICB2YXIgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTtcbiAgKGZ1bmN0aW9uKFNlcGFyYXRpb25GdW5jdGlvblR5cGUyKSB7XG4gICAgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbXCJlX3Vuc2V0XCJdID0gLTFdID0gXCJlX3Vuc2V0XCI7XG4gICAgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbXCJlX3BvaW50c1wiXSA9IDFdID0gXCJlX3BvaW50c1wiO1xuICAgIFNlcGFyYXRpb25GdW5jdGlvblR5cGUyW1NlcGFyYXRpb25GdW5jdGlvblR5cGUyW1wiZV9mYWNlQVwiXSA9IDJdID0gXCJlX2ZhY2VBXCI7XG4gICAgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbXCJlX2ZhY2VCXCJdID0gM10gPSBcImVfZmFjZUJcIjtcbiAgfSkoU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZSB8fCAoU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZSA9IHt9KSk7XG4gIHZhciBTZXBhcmF0aW9uRnVuY3Rpb24gPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2VwYXJhdGlvbkZ1bmN0aW9uMigpIHtcbiAgICAgICAgdGhpcy5tX3Byb3h5QSA9IG51bGw7XG4gICAgICAgIHRoaXMubV9wcm94eUIgPSBudWxsO1xuICAgICAgICB0aGlzLm1fc3dlZXBBID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQiA9IG51bGw7XG4gICAgICAgIHRoaXMubV90eXBlID0gU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLm1fbG9jYWxQb2ludCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMubV9heGlzID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAtMTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSAtMTtcbiAgICAgIH1cbiAgICAgIFNlcGFyYXRpb25GdW5jdGlvbjIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX3Byb3h5QSA9IG51bGw7XG4gICAgICAgIHRoaXMubV9wcm94eUIgPSBudWxsO1xuICAgICAgICB0aGlzLm1fc3dlZXBBID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQiA9IG51bGw7XG4gICAgICAgIHRoaXMubV90eXBlID0gU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZS5lX3Vuc2V0O1xuICAgICAgICB6ZXJvVmVjMih0aGlzLm1fbG9jYWxQb2ludCk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubV9heGlzKTtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAtMTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSAtMTtcbiAgICAgIH07XG4gICAgICBTZXBhcmF0aW9uRnVuY3Rpb24yLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24oY2FjaGUyLCBwcm94eUEsIHN3ZWVwQSwgcHJveHlCLCBzd2VlcEIsIHQxKSB7XG4gICAgICAgIHZhciBjb3VudCA9IGNhY2hlMi5jb3VudDtcbiAgICAgICAgdGhpcy5tX3Byb3h5QSA9IHByb3h5QTtcbiAgICAgICAgdGhpcy5tX3Byb3h5QiA9IHByb3h5QjtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQSA9IHN3ZWVwQTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQiA9IHN3ZWVwQjtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQS5nZXRUcmFuc2Zvcm0oeGZBJDEsIHQxKTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQi5nZXRUcmFuc2Zvcm0oeGZCJDEsIHQxKTtcbiAgICAgICAgaWYgKGNvdW50ID09PSAxKSB7XG4gICAgICAgICAgdGhpcy5tX3R5cGUgPSBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlLmVfcG9pbnRzO1xuICAgICAgICAgIHZhciBsb2NhbFBvaW50QV8xID0gdGhpcy5tX3Byb3h5QS5nZXRWZXJ0ZXgoY2FjaGUyLmluZGV4QVswXSk7XG4gICAgICAgICAgdmFyIGxvY2FsUG9pbnRCXzEgPSB0aGlzLm1fcHJveHlCLmdldFZlcnRleChjYWNoZTIuaW5kZXhCWzBdKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSQyLCB4ZkEkMSwgbG9jYWxQb2ludEFfMSk7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIGxvY2FsUG9pbnRCXzEpO1xuICAgICAgICAgIHN1YlZlYzIodGhpcy5tX2F4aXMsIHBvaW50QiQyLCBwb2ludEEkMik7XG4gICAgICAgICAgdmFyIHMyID0gbm9ybWFsaXplVmVjMkxlbmd0aCh0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgcmV0dXJuIHMyO1xuICAgICAgICB9IGVsc2UgaWYgKGNhY2hlMi5pbmRleEFbMF0gPT09IGNhY2hlMi5pbmRleEFbMV0pIHtcbiAgICAgICAgICB0aGlzLm1fdHlwZSA9IFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV9mYWNlQjtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEIxID0gcHJveHlCLmdldFZlcnRleChjYWNoZTIuaW5kZXhCWzBdKTtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEIyID0gcHJveHlCLmdldFZlcnRleChjYWNoZTIuaW5kZXhCWzFdKTtcbiAgICAgICAgICBjcm9zc1ZlYzJOdW0odGhpcy5tX2F4aXMsIHN1YlZlYzIodGVtcCQ0LCBsb2NhbFBvaW50QjIsIGxvY2FsUG9pbnRCMSksIDEpO1xuICAgICAgICAgIG5vcm1hbGl6ZVZlYzIodGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHJvdFZlYzIobm9ybWFsJDMsIHhmQiQxLnEsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICBjb21iaW5lMlZlYzIodGhpcy5tX2xvY2FsUG9pbnQsIDAuNSwgbG9jYWxQb2ludEIxLCAwLjUsIGxvY2FsUG9pbnRCMik7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIHRoaXMubV9sb2NhbFBvaW50KTtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEFfMiA9IHByb3h5QS5nZXRWZXJ0ZXgoY2FjaGUyLmluZGV4QVswXSk7XG4gICAgICAgICAgdmFyIHBvaW50QV8xID0gVHJhbnNmb3JtLm11bFZlYzIoeGZBJDEsIGxvY2FsUG9pbnRBXzIpO1xuICAgICAgICAgIHZhciBzMiA9IGRvdFZlYzIocG9pbnRBXzEsIG5vcm1hbCQzKSAtIGRvdFZlYzIocG9pbnRCJDIsIG5vcm1hbCQzKTtcbiAgICAgICAgICBpZiAoczIgPCAwKSB7XG4gICAgICAgICAgICBuZWdWZWMyKHRoaXMubV9heGlzKTtcbiAgICAgICAgICAgIHMyID0gLXMyO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gczI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3R5cGUgPSBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlLmVfZmFjZUE7XG4gICAgICAgICAgdmFyIGxvY2FsUG9pbnRBMSA9IHRoaXMubV9wcm94eUEuZ2V0VmVydGV4KGNhY2hlMi5pbmRleEFbMF0pO1xuICAgICAgICAgIHZhciBsb2NhbFBvaW50QTIgPSB0aGlzLm1fcHJveHlBLmdldFZlcnRleChjYWNoZTIuaW5kZXhBWzFdKTtcbiAgICAgICAgICBjcm9zc1ZlYzJOdW0odGhpcy5tX2F4aXMsIHN1YlZlYzIodGVtcCQ0LCBsb2NhbFBvaW50QTIsIGxvY2FsUG9pbnRBMSksIDEpO1xuICAgICAgICAgIG5vcm1hbGl6ZVZlYzIodGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHJvdFZlYzIobm9ybWFsJDMsIHhmQSQxLnEsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICBjb21iaW5lMlZlYzIodGhpcy5tX2xvY2FsUG9pbnQsIDAuNSwgbG9jYWxQb2ludEExLCAwLjUsIGxvY2FsUG9pbnRBMik7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEEkMiwgeGZBJDEsIHRoaXMubV9sb2NhbFBvaW50KTtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEJfMiA9IHRoaXMubV9wcm94eUIuZ2V0VmVydGV4KGNhY2hlMi5pbmRleEJbMF0pO1xuICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRCJDIsIHhmQiQxLCBsb2NhbFBvaW50Ql8yKTtcbiAgICAgICAgICB2YXIgczIgPSBkb3RWZWMyKHBvaW50QiQyLCBub3JtYWwkMykgLSBkb3RWZWMyKHBvaW50QSQyLCBub3JtYWwkMyk7XG4gICAgICAgICAgaWYgKHMyIDwgMCkge1xuICAgICAgICAgICAgbmVnVmVjMih0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgICBzMiA9IC1zMjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHMyO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2VwYXJhdGlvbkZ1bmN0aW9uMi5wcm90b3R5cGUuY29tcHV0ZSA9IGZ1bmN0aW9uKGZpbmQsIHQpIHtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQS5nZXRUcmFuc2Zvcm0oeGZBJDEsIHQpO1xuICAgICAgICB0aGlzLm1fc3dlZXBCLmdldFRyYW5zZm9ybSh4ZkIkMSwgdCk7XG4gICAgICAgIHN3aXRjaCAodGhpcy5tX3R5cGUpIHtcbiAgICAgICAgICBjYXNlIFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV9wb2ludHM6IHtcbiAgICAgICAgICAgIGlmIChmaW5kKSB7XG4gICAgICAgICAgICAgIGRlcm90VmVjMihheGlzQSwgeGZBJDEucSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgICAgICBkZXJvdFZlYzIoYXhpc0IsIHhmQiQxLnEsIHNjYWxlVmVjMih0ZW1wJDQsIC0xLCB0aGlzLm1fYXhpcykpO1xuICAgICAgICAgICAgICB0aGlzLmluZGV4QSA9IHRoaXMubV9wcm94eUEuZ2V0U3VwcG9ydChheGlzQSk7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhCID0gdGhpcy5tX3Byb3h5Qi5nZXRTdXBwb3J0KGF4aXNCKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvcHlWZWMyKGxvY2FsUG9pbnRBLCB0aGlzLm1fcHJveHlBLmdldFZlcnRleCh0aGlzLmluZGV4QSkpO1xuICAgICAgICAgICAgY29weVZlYzIobG9jYWxQb2ludEIsIHRoaXMubV9wcm94eUIuZ2V0VmVydGV4KHRoaXMuaW5kZXhCKSk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSQyLCB4ZkEkMSwgbG9jYWxQb2ludEEpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIGxvY2FsUG9pbnRCKTtcbiAgICAgICAgICAgIHZhciBzZXAgPSBkb3RWZWMyKHBvaW50QiQyLCB0aGlzLm1fYXhpcykgLSBkb3RWZWMyKHBvaW50QSQyLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgICByZXR1cm4gc2VwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV9mYWNlQToge1xuICAgICAgICAgICAgcm90VmVjMihub3JtYWwkMywgeGZBJDEucSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEEkMiwgeGZBJDEsIHRoaXMubV9sb2NhbFBvaW50KTtcbiAgICAgICAgICAgIGlmIChmaW5kKSB7XG4gICAgICAgICAgICAgIGRlcm90VmVjMihheGlzQiwgeGZCJDEucSwgc2NhbGVWZWMyKHRlbXAkNCwgLTEsIG5vcm1hbCQzKSk7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhBID0gLTE7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhCID0gdGhpcy5tX3Byb3h5Qi5nZXRTdXBwb3J0KGF4aXNCKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvcHlWZWMyKGxvY2FsUG9pbnRCLCB0aGlzLm1fcHJveHlCLmdldFZlcnRleCh0aGlzLmluZGV4QikpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIGxvY2FsUG9pbnRCKTtcbiAgICAgICAgICAgIHZhciBzZXAgPSBkb3RWZWMyKHBvaW50QiQyLCBub3JtYWwkMykgLSBkb3RWZWMyKHBvaW50QSQyLCBub3JtYWwkMyk7XG4gICAgICAgICAgICByZXR1cm4gc2VwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV9mYWNlQjoge1xuICAgICAgICAgICAgcm90VmVjMihub3JtYWwkMywgeGZCJDEucSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIHRoaXMubV9sb2NhbFBvaW50KTtcbiAgICAgICAgICAgIGlmIChmaW5kKSB7XG4gICAgICAgICAgICAgIGRlcm90VmVjMihheGlzQSwgeGZBJDEucSwgc2NhbGVWZWMyKHRlbXAkNCwgLTEsIG5vcm1hbCQzKSk7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhCID0gLTE7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhBID0gdGhpcy5tX3Byb3h5QS5nZXRTdXBwb3J0KGF4aXNBKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvcHlWZWMyKGxvY2FsUG9pbnRBLCB0aGlzLm1fcHJveHlBLmdldFZlcnRleCh0aGlzLmluZGV4QSkpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEEkMiwgeGZBJDEsIGxvY2FsUG9pbnRBKTtcbiAgICAgICAgICAgIHZhciBzZXAgPSBkb3RWZWMyKHBvaW50QSQyLCBub3JtYWwkMykgLSBkb3RWZWMyKHBvaW50QiQyLCBub3JtYWwkMyk7XG4gICAgICAgICAgICByZXR1cm4gc2VwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgaWYgKGZpbmQpIHtcbiAgICAgICAgICAgICAgdGhpcy5pbmRleEEgPSAtMTtcbiAgICAgICAgICAgICAgdGhpcy5pbmRleEIgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2VwYXJhdGlvbkZ1bmN0aW9uMi5wcm90b3R5cGUuZmluZE1pblNlcGFyYXRpb24gPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbXB1dGUodHJ1ZSwgdCk7XG4gICAgICB9O1xuICAgICAgU2VwYXJhdGlvbkZ1bmN0aW9uMi5wcm90b3R5cGUuZXZhbHVhdGUgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbXB1dGUoZmFsc2UsIHQpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTZXBhcmF0aW9uRnVuY3Rpb24yO1xuICAgIH0oKVxuICApO1xuICB2YXIgc2VwYXJhdGlvbkZ1bmN0aW9uID0gbmV3IFNlcGFyYXRpb25GdW5jdGlvbigpO1xuICBUaW1lT2ZJbXBhY3QuSW5wdXQgPSBUT0lJbnB1dDtcbiAgVGltZU9mSW1wYWN0Lk91dHB1dCA9IFRPSU91dHB1dDtcbiAgdmFyIG1hdGhfYWJzJDYgPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfc3FydCQzID0gTWF0aC5zcXJ0O1xuICB2YXIgbWF0aF9taW4kNSA9IE1hdGgubWluO1xuICB2YXIgVGltZVN0ZXAgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVGltZVN0ZXAyKCkge1xuICAgICAgICB0aGlzLmR0ID0gMDtcbiAgICAgICAgdGhpcy5pbnZfZHQgPSAwO1xuICAgICAgICB0aGlzLnZlbG9jaXR5SXRlcmF0aW9ucyA9IDA7XG4gICAgICAgIHRoaXMucG9zaXRpb25JdGVyYXRpb25zID0gMDtcbiAgICAgICAgdGhpcy53YXJtU3RhcnRpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5ibG9ja1NvbHZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5pbnZfZHQwID0gMDtcbiAgICAgICAgdGhpcy5kdFJhdGlvID0gMTtcbiAgICAgIH1cbiAgICAgIFRpbWVTdGVwMi5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbihkdCkge1xuICAgICAgICBpZiAodGhpcy5kdCA+IDApIHtcbiAgICAgICAgICB0aGlzLmludl9kdDAgPSB0aGlzLmludl9kdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmR0ID0gZHQ7XG4gICAgICAgIHRoaXMuaW52X2R0ID0gZHQgPT0gMCA/IDAgOiAxIC8gZHQ7XG4gICAgICAgIHRoaXMuZHRSYXRpbyA9IGR0ICogdGhpcy5pbnZfZHQwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBUaW1lU3RlcDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBzX3N1YlN0ZXAgPSBuZXcgVGltZVN0ZXAoKTtcbiAgdmFyIGMgPSB2ZWMyKDAsIDApO1xuICB2YXIgdiA9IHZlYzIoMCwgMCk7XG4gIHZhciB0cmFuc2xhdGlvbiA9IHZlYzIoMCwgMCk7XG4gIHZhciBpbnB1dCA9IG5ldyBUT0lJbnB1dCgpO1xuICB2YXIgb3V0cHV0ID0gbmV3IFRPSU91dHB1dCgpO1xuICB2YXIgYmFja3VwID0gbmV3IFN3ZWVwKCk7XG4gIHZhciBiYWNrdXAxID0gbmV3IFN3ZWVwKCk7XG4gIHZhciBiYWNrdXAyID0gbmV3IFN3ZWVwKCk7XG4gIHZhciBDb250YWN0SW1wdWxzZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBDb250YWN0SW1wdWxzZTIoY29udGFjdCkge1xuICAgICAgICB0aGlzLmNvbnRhY3QgPSBjb250YWN0O1xuICAgICAgICB0aGlzLm5vcm1hbHMgPSBbXTtcbiAgICAgICAgdGhpcy50YW5nZW50cyA9IFtdO1xuICAgICAgfVxuICAgICAgQ29udGFjdEltcHVsc2UyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubm9ybWFscy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLnRhbmdlbnRzLmxlbmd0aCA9IDA7XG4gICAgICB9O1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnRhY3RJbXB1bHNlMi5wcm90b3R5cGUsIFwibm9ybWFsSW1wdWxzZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5jb250YWN0O1xuICAgICAgICAgIHZhciBub3JtYWxzID0gdGhpcy5ub3JtYWxzO1xuICAgICAgICAgIG5vcm1hbHMubGVuZ3RoID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBwID0gMDsgcCA8IGNvbnRhY3Qudl9wb2ludHMubGVuZ3RoOyArK3ApIHtcbiAgICAgICAgICAgIG5vcm1hbHMucHVzaChjb250YWN0LnZfcG9pbnRzW3BdLm5vcm1hbEltcHVsc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbm9ybWFscztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29udGFjdEltcHVsc2UyLnByb3RvdHlwZSwgXCJ0YW5nZW50SW1wdWxzZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5jb250YWN0O1xuICAgICAgICAgIHZhciB0YW5nZW50cyA9IHRoaXMudGFuZ2VudHM7XG4gICAgICAgICAgdGFuZ2VudHMubGVuZ3RoID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBwID0gMDsgcCA8IGNvbnRhY3Qudl9wb2ludHMubGVuZ3RoOyArK3ApIHtcbiAgICAgICAgICAgIHRhbmdlbnRzLnB1c2goY29udGFjdC52X3BvaW50c1twXS50YW5nZW50SW1wdWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0YW5nZW50cztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gQ29udGFjdEltcHVsc2UyO1xuICAgIH0oKVxuICApO1xuICB2YXIgU29sdmVyID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNvbHZlcjIod29ybGQpIHtcbiAgICAgICAgdGhpcy5tX3dvcmxkID0gd29ybGQ7XG4gICAgICAgIHRoaXMubV9zdGFjayA9IFtdO1xuICAgICAgICB0aGlzLm1fYm9kaWVzID0gW107XG4gICAgICAgIHRoaXMubV9jb250YWN0cyA9IFtdO1xuICAgICAgICB0aGlzLm1fam9pbnRzID0gW107XG4gICAgICB9XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fc3RhY2subGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5tX2JvZGllcy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLm1fY29udGFjdHMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5tX2pvaW50cy5sZW5ndGggPSAwO1xuICAgICAgfTtcbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLmFkZEJvZHkgPSBmdW5jdGlvbihib2R5KSB7XG4gICAgICAgIHRoaXMubV9ib2RpZXMucHVzaChib2R5KTtcbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5hZGRDb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCkge1xuICAgICAgICB0aGlzLm1fY29udGFjdHMucHVzaChjb250YWN0KTtcbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5hZGRKb2ludCA9IGZ1bmN0aW9uKGpvaW50KSB7XG4gICAgICAgIHRoaXMubV9qb2ludHMucHVzaChqb2ludCk7XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUuc29sdmVXb3JsZCA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHdvcmxkID0gdGhpcy5tX3dvcmxkO1xuICAgICAgICBmb3IgKHZhciBiMiA9IHdvcmxkLm1fYm9keUxpc3Q7IGIyOyBiMiA9IGIyLm1fbmV4dCkge1xuICAgICAgICAgIGIyLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGNfMSA9IHdvcmxkLm1fY29udGFjdExpc3Q7IGNfMTsgY18xID0gY18xLm1fbmV4dCkge1xuICAgICAgICAgIGNfMS5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBqID0gd29ybGQubV9qb2ludExpc3Q7IGo7IGogPSBqLm1fbmV4dCkge1xuICAgICAgICAgIGoubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN0YWNrID0gdGhpcy5tX3N0YWNrO1xuICAgICAgICBmb3IgKHZhciBzZWVkID0gd29ybGQubV9ib2R5TGlzdDsgc2VlZDsgc2VlZCA9IHNlZWQubV9uZXh0KSB7XG4gICAgICAgICAgaWYgKHNlZWQubV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHNlZWQuaXNBd2FrZSgpID09IGZhbHNlIHx8IHNlZWQuaXNBY3RpdmUoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzZWVkLmlzU3RhdGljKCkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICAgICAgc3RhY2sucHVzaChzZWVkKTtcbiAgICAgICAgICBzZWVkLm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBiMiA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgdGhpcy5hZGRCb2R5KGIyKTtcbiAgICAgICAgICAgIGIyLm1fYXdha2VGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChiMi5pc1N0YXRpYygpKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgY2UgPSBiMi5tX2NvbnRhY3RMaXN0OyBjZTsgY2UgPSBjZS5uZXh0KSB7XG4gICAgICAgICAgICAgIHZhciBjb250YWN0ID0gY2UuY29udGFjdDtcbiAgICAgICAgICAgICAgaWYgKGNvbnRhY3QubV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKGNvbnRhY3QuaXNFbmFibGVkKCkgPT0gZmFsc2UgfHwgY29udGFjdC5pc1RvdWNoaW5nKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgc2Vuc29yQSA9IGNvbnRhY3QubV9maXh0dXJlQS5tX2lzU2Vuc29yO1xuICAgICAgICAgICAgICB2YXIgc2Vuc29yQiA9IGNvbnRhY3QubV9maXh0dXJlQi5tX2lzU2Vuc29yO1xuICAgICAgICAgICAgICBpZiAoc2Vuc29yQSB8fCBzZW5zb3JCKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdGhpcy5hZGRDb250YWN0KGNvbnRhY3QpO1xuICAgICAgICAgICAgICBjb250YWN0Lm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgIHZhciBvdGhlciA9IGNlLm90aGVyO1xuICAgICAgICAgICAgICBpZiAob3RoZXIubV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc3RhY2sucHVzaChvdGhlcik7XG4gICAgICAgICAgICAgIG90aGVyLm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBqZSA9IGIyLm1fam9pbnRMaXN0OyBqZTsgamUgPSBqZS5uZXh0KSB7XG4gICAgICAgICAgICAgIGlmIChqZS5qb2ludC5tX2lzbGFuZEZsYWcgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhciBvdGhlciA9IGplLm90aGVyO1xuICAgICAgICAgICAgICBpZiAob3RoZXIuaXNBY3RpdmUoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHRoaXMuYWRkSm9pbnQoamUuam9pbnQpO1xuICAgICAgICAgICAgICBqZS5qb2ludC5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICBpZiAob3RoZXIubV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc3RhY2sucHVzaChvdGhlcik7XG4gICAgICAgICAgICAgIG90aGVyLm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuc29sdmVJc2xhbmQoc3RlcCk7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgYjIgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgICAgaWYgKGIyLmlzU3RhdGljKCkpIHtcbiAgICAgICAgICAgICAgYjIubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUuc29sdmVJc2xhbmQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB3b3JsZCA9IHRoaXMubV93b3JsZDtcbiAgICAgICAgdmFyIGdyYXZpdHkgPSB3b3JsZC5tX2dyYXZpdHk7XG4gICAgICAgIHZhciBhbGxvd1NsZWVwID0gd29ybGQubV9hbGxvd1NsZWVwO1xuICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICBjb3B5VmVjMihjLCBib2R5Lm1fc3dlZXAuYyk7XG4gICAgICAgICAgdmFyIGEyID0gYm9keS5tX3N3ZWVwLmE7XG4gICAgICAgICAgY29weVZlYzIodiwgYm9keS5tX2xpbmVhclZlbG9jaXR5KTtcbiAgICAgICAgICB2YXIgdyA9IGJvZHkubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5tX3N3ZWVwLmMwLCBib2R5Lm1fc3dlZXAuYyk7XG4gICAgICAgICAgYm9keS5tX3N3ZWVwLmEwID0gYm9keS5tX3N3ZWVwLmE7XG4gICAgICAgICAgaWYgKGJvZHkuaXNEeW5hbWljKCkpIHtcbiAgICAgICAgICAgIHBsdXNTY2FsZVZlYzIodiwgaCAqIGJvZHkubV9ncmF2aXR5U2NhbGUsIGdyYXZpdHkpO1xuICAgICAgICAgICAgcGx1c1NjYWxlVmVjMih2LCBoICogYm9keS5tX2ludk1hc3MsIGJvZHkubV9mb3JjZSk7XG4gICAgICAgICAgICB3ICs9IGggKiBib2R5Lm1faW52SSAqIGJvZHkubV90b3JxdWU7XG4gICAgICAgICAgICBzY2FsZVZlYzIodiwgMSAvICgxICsgaCAqIGJvZHkubV9saW5lYXJEYW1waW5nKSwgdik7XG4gICAgICAgICAgICB3ICo9IDEgLyAoMSArIGggKiBib2R5Lm1fYW5ndWxhckRhbXBpbmcpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfcG9zaXRpb24uYywgYyk7XG4gICAgICAgICAgYm9keS5jX3Bvc2l0aW9uLmEgPSBhMjtcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfdmVsb2NpdHkudiwgdik7XG4gICAgICAgICAgYm9keS5jX3ZlbG9jaXR5LncgPSB3O1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbaV07XG4gICAgICAgICAgY29udGFjdC5pbml0Q29uc3RyYWludChzdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2ldO1xuICAgICAgICAgIGNvbnRhY3QuaW5pdFZlbG9jaXR5Q29uc3RyYWludChzdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbaV07XG4gICAgICAgICAgICBjb250YWN0Lndhcm1TdGFydENvbnN0cmFpbnQoc3RlcCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2pvaW50cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBqb2ludCA9IHRoaXMubV9qb2ludHNbaV07XG4gICAgICAgICAgam9pbnQuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMoc3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGVwLnZlbG9jaXR5SXRlcmF0aW9uczsgKytpKSB7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLm1fam9pbnRzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICB2YXIgam9pbnQgPSB0aGlzLm1fam9pbnRzW2pdO1xuICAgICAgICAgICAgam9pbnQuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzKHN0ZXApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbal07XG4gICAgICAgICAgICBjb250YWN0LnNvbHZlVmVsb2NpdHlDb25zdHJhaW50KHN0ZXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2ldO1xuICAgICAgICAgIGNvbnRhY3Quc3RvcmVDb25zdHJhaW50SW1wdWxzZXMoc3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgIGNvcHlWZWMyKGMsIGJvZHkuY19wb3NpdGlvbi5jKTtcbiAgICAgICAgICB2YXIgYTIgPSBib2R5LmNfcG9zaXRpb24uYTtcbiAgICAgICAgICBjb3B5VmVjMih2LCBib2R5LmNfdmVsb2NpdHkudik7XG4gICAgICAgICAgdmFyIHcgPSBib2R5LmNfdmVsb2NpdHkudztcbiAgICAgICAgICBzY2FsZVZlYzIodHJhbnNsYXRpb24sIGgsIHYpO1xuICAgICAgICAgIHZhciB0cmFuc2xhdGlvbkxlbmd0aFNxciA9IGxlbmd0aFNxclZlYzIodHJhbnNsYXRpb24pO1xuICAgICAgICAgIGlmICh0cmFuc2xhdGlvbkxlbmd0aFNxciA+IFNldHRpbmdzSW50ZXJuYWwubWF4VHJhbnNsYXRpb25TcXVhcmVkKSB7XG4gICAgICAgICAgICB2YXIgcmF0aW8gPSBTZXR0aW5nc0ludGVybmFsLm1heFRyYW5zbGF0aW9uIC8gbWF0aF9zcXJ0JDModHJhbnNsYXRpb25MZW5ndGhTcXIpO1xuICAgICAgICAgICAgbXVsVmVjMih2LCByYXRpbyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciByb3RhdGlvbjIgPSBoICogdztcbiAgICAgICAgICBpZiAocm90YXRpb24yICogcm90YXRpb24yID4gU2V0dGluZ3NJbnRlcm5hbC5tYXhSb3RhdGlvblNxdWFyZWQpIHtcbiAgICAgICAgICAgIHZhciByYXRpbyA9IFNldHRpbmdzSW50ZXJuYWwubWF4Um90YXRpb24gLyBtYXRoX2FicyQ2KHJvdGF0aW9uMik7XG4gICAgICAgICAgICB3ICo9IHJhdGlvO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwbHVzU2NhbGVWZWMyKGMsIGgsIHYpO1xuICAgICAgICAgIGEyICs9IGggKiB3O1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY19wb3NpdGlvbi5jLCBjKTtcbiAgICAgICAgICBib2R5LmNfcG9zaXRpb24uYSA9IGEyO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY192ZWxvY2l0eS52LCB2KTtcbiAgICAgICAgICBib2R5LmNfdmVsb2NpdHkudyA9IHc7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBvc2l0aW9uU29sdmVkID0gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnM7ICsraSkge1xuICAgICAgICAgIHZhciBtaW5TZXBhcmF0aW9uID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbal07XG4gICAgICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IGNvbnRhY3Quc29sdmVQb3NpdGlvbkNvbnN0cmFpbnQoc3RlcCk7XG4gICAgICAgICAgICBtaW5TZXBhcmF0aW9uID0gbWF0aF9taW4kNShtaW5TZXBhcmF0aW9uLCBzZXBhcmF0aW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGNvbnRhY3RzT2theSA9IG1pblNlcGFyYXRpb24gPj0gLTMgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgICAgICAgdmFyIGpvaW50c09rYXkgPSB0cnVlO1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5tX2pvaW50cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGpvaW50ID0gdGhpcy5tX2pvaW50c1tqXTtcbiAgICAgICAgICAgIHZhciBqb2ludE9rYXkgPSBqb2ludC5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMoc3RlcCk7XG4gICAgICAgICAgICBqb2ludHNPa2F5ID0gam9pbnRzT2theSAmJiBqb2ludE9rYXk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjb250YWN0c09rYXkgJiYgam9pbnRzT2theSkge1xuICAgICAgICAgICAgcG9zaXRpb25Tb2x2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICBjb3B5VmVjMihib2R5Lm1fc3dlZXAuYywgYm9keS5jX3Bvc2l0aW9uLmMpO1xuICAgICAgICAgIGJvZHkubV9zd2VlcC5hID0gYm9keS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5tX2xpbmVhclZlbG9jaXR5LCBib2R5LmNfdmVsb2NpdHkudik7XG4gICAgICAgICAgYm9keS5tX2FuZ3VsYXJWZWxvY2l0eSA9IGJvZHkuY192ZWxvY2l0eS53O1xuICAgICAgICAgIGJvZHkuc3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBvc3RTb2x2ZUlzbGFuZCgpO1xuICAgICAgICBpZiAoYWxsb3dTbGVlcCkge1xuICAgICAgICAgIHZhciBtaW5TbGVlcFRpbWUgPSBJbmZpbml0eTtcbiAgICAgICAgICB2YXIgbGluVG9sU3FyID0gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbGVlcFRvbGVyYW5jZVNxcjtcbiAgICAgICAgICB2YXIgYW5nVG9sU3FyID0gU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xlZXBUb2xlcmFuY2VTcXI7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgYm9keSA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgICBpZiAoYm9keS5pc1N0YXRpYygpKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGJvZHkubV9hdXRvU2xlZXBGbGFnID09IGZhbHNlIHx8IGJvZHkubV9hbmd1bGFyVmVsb2NpdHkgKiBib2R5Lm1fYW5ndWxhclZlbG9jaXR5ID4gYW5nVG9sU3FyIHx8IGxlbmd0aFNxclZlYzIoYm9keS5tX2xpbmVhclZlbG9jaXR5KSA+IGxpblRvbFNxcikge1xuICAgICAgICAgICAgICBib2R5Lm1fc2xlZXBUaW1lID0gMDtcbiAgICAgICAgICAgICAgbWluU2xlZXBUaW1lID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGJvZHkubV9zbGVlcFRpbWUgKz0gaDtcbiAgICAgICAgICAgICAgbWluU2xlZXBUaW1lID0gbWF0aF9taW4kNShtaW5TbGVlcFRpbWUsIGJvZHkubV9zbGVlcFRpbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobWluU2xlZXBUaW1lID49IFNldHRpbmdzSW50ZXJuYWwudGltZVRvU2xlZXAgJiYgcG9zaXRpb25Tb2x2ZWQpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICB2YXIgYm9keSA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgICAgIGJvZHkuc2V0QXdha2UoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLnNvbHZlV29ybGRUT0kgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB3b3JsZCA9IHRoaXMubV93b3JsZDtcbiAgICAgICAgaWYgKHdvcmxkLm1fc3RlcENvbXBsZXRlKSB7XG4gICAgICAgICAgZm9yICh2YXIgYjIgPSB3b3JsZC5tX2JvZHlMaXN0OyBiMjsgYjIgPSBiMi5tX25leHQpIHtcbiAgICAgICAgICAgIGIyLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgYjIubV9zd2VlcC5hbHBoYTAgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmb3IgKHZhciBjXzIgPSB3b3JsZC5tX2NvbnRhY3RMaXN0OyBjXzI7IGNfMiA9IGNfMi5tX25leHQpIHtcbiAgICAgICAgICAgIGNfMi5tX3RvaUZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIGNfMi5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIGNfMi5tX3RvaUNvdW50ID0gMDtcbiAgICAgICAgICAgIGNfMi5tX3RvaSA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgdmFyIG1pbkNvbnRhY3QgPSBudWxsO1xuICAgICAgICAgIHZhciBtaW5BbHBoYSA9IDE7XG4gICAgICAgICAgZm9yICh2YXIgY18zID0gd29ybGQubV9jb250YWN0TGlzdDsgY18zOyBjXzMgPSBjXzMubV9uZXh0KSB7XG4gICAgICAgICAgICBpZiAoY18zLmlzRW5hYmxlZCgpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNfMy5tX3RvaUNvdW50ID4gU2V0dGluZ3NJbnRlcm5hbC5tYXhTdWJTdGVwcykge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhbHBoYSA9IDE7XG4gICAgICAgICAgICBpZiAoY18zLm1fdG9pRmxhZykge1xuICAgICAgICAgICAgICBhbHBoYSA9IGNfMy5tX3RvaTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciBmQV8xID0gY18zLmdldEZpeHR1cmVBKCk7XG4gICAgICAgICAgICAgIHZhciBmQl8xID0gY18zLmdldEZpeHR1cmVCKCk7XG4gICAgICAgICAgICAgIGlmIChmQV8xLmlzU2Vuc29yKCkgfHwgZkJfMS5pc1NlbnNvcigpKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIGJBXzEgPSBmQV8xLmdldEJvZHkoKTtcbiAgICAgICAgICAgICAgdmFyIGJCXzEgPSBmQl8xLmdldEJvZHkoKTtcbiAgICAgICAgICAgICAgdmFyIGFjdGl2ZUEgPSBiQV8xLmlzQXdha2UoKSAmJiAhYkFfMS5pc1N0YXRpYygpO1xuICAgICAgICAgICAgICB2YXIgYWN0aXZlQiA9IGJCXzEuaXNBd2FrZSgpICYmICFiQl8xLmlzU3RhdGljKCk7XG4gICAgICAgICAgICAgIGlmIChhY3RpdmVBID09IGZhbHNlICYmIGFjdGl2ZUIgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgY29sbGlkZUEgPSBiQV8xLmlzQnVsbGV0KCkgfHwgIWJBXzEuaXNEeW5hbWljKCk7XG4gICAgICAgICAgICAgIHZhciBjb2xsaWRlQiA9IGJCXzEuaXNCdWxsZXQoKSB8fCAhYkJfMS5pc0R5bmFtaWMoKTtcbiAgICAgICAgICAgICAgaWYgKGNvbGxpZGVBID09IGZhbHNlICYmIGNvbGxpZGVCID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIGFscGhhMCA9IGJBXzEubV9zd2VlcC5hbHBoYTA7XG4gICAgICAgICAgICAgIGlmIChiQV8xLm1fc3dlZXAuYWxwaGEwIDwgYkJfMS5tX3N3ZWVwLmFscGhhMCkge1xuICAgICAgICAgICAgICAgIGFscGhhMCA9IGJCXzEubV9zd2VlcC5hbHBoYTA7XG4gICAgICAgICAgICAgICAgYkFfMS5tX3N3ZWVwLmFkdmFuY2UoYWxwaGEwKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChiQl8xLm1fc3dlZXAuYWxwaGEwIDwgYkFfMS5tX3N3ZWVwLmFscGhhMCkge1xuICAgICAgICAgICAgICAgIGFscGhhMCA9IGJBXzEubV9zd2VlcC5hbHBoYTA7XG4gICAgICAgICAgICAgICAgYkJfMS5tX3N3ZWVwLmFkdmFuY2UoYWxwaGEwKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgaW5kZXhBID0gY18zLmdldENoaWxkSW5kZXhBKCk7XG4gICAgICAgICAgICAgIHZhciBpbmRleEIgPSBjXzMuZ2V0Q2hpbGRJbmRleEIoKTtcbiAgICAgICAgICAgICAgaW5wdXQucHJveHlBLnNldChmQV8xLmdldFNoYXBlKCksIGluZGV4QSk7XG4gICAgICAgICAgICAgIGlucHV0LnByb3h5Qi5zZXQoZkJfMS5nZXRTaGFwZSgpLCBpbmRleEIpO1xuICAgICAgICAgICAgICBpbnB1dC5zd2VlcEEuc2V0KGJBXzEubV9zd2VlcCk7XG4gICAgICAgICAgICAgIGlucHV0LnN3ZWVwQi5zZXQoYkJfMS5tX3N3ZWVwKTtcbiAgICAgICAgICAgICAgaW5wdXQudE1heCA9IDE7XG4gICAgICAgICAgICAgIFRpbWVPZkltcGFjdChvdXRwdXQsIGlucHV0KTtcbiAgICAgICAgICAgICAgdmFyIGJldGEgPSBvdXRwdXQudDtcbiAgICAgICAgICAgICAgaWYgKG91dHB1dC5zdGF0ZSA9PSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX3RvdWNoaW5nKSB7XG4gICAgICAgICAgICAgICAgYWxwaGEgPSBtYXRoX21pbiQ1KGFscGhhMCArICgxIC0gYWxwaGEwKSAqIGJldGEsIDEpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGFscGhhID0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjXzMubV90b2kgPSBhbHBoYTtcbiAgICAgICAgICAgICAgY18zLm1fdG9pRmxhZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYWxwaGEgPCBtaW5BbHBoYSkge1xuICAgICAgICAgICAgICBtaW5Db250YWN0ID0gY18zO1xuICAgICAgICAgICAgICBtaW5BbHBoYSA9IGFscGhhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobWluQ29udGFjdCA9PSBudWxsIHx8IDEgLSAxMCAqIEVQU0lMT04gPCBtaW5BbHBoYSkge1xuICAgICAgICAgICAgd29ybGQubV9zdGVwQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBmQSA9IG1pbkNvbnRhY3QuZ2V0Rml4dHVyZUEoKTtcbiAgICAgICAgICB2YXIgZkIgPSBtaW5Db250YWN0LmdldEZpeHR1cmVCKCk7XG4gICAgICAgICAgdmFyIGJBID0gZkEuZ2V0Qm9keSgpO1xuICAgICAgICAgIHZhciBiQiA9IGZCLmdldEJvZHkoKTtcbiAgICAgICAgICBiYWNrdXAxLnNldChiQS5tX3N3ZWVwKTtcbiAgICAgICAgICBiYWNrdXAyLnNldChiQi5tX3N3ZWVwKTtcbiAgICAgICAgICBiQS5hZHZhbmNlKG1pbkFscGhhKTtcbiAgICAgICAgICBiQi5hZHZhbmNlKG1pbkFscGhhKTtcbiAgICAgICAgICBtaW5Db250YWN0LnVwZGF0ZSh3b3JsZCk7XG4gICAgICAgICAgbWluQ29udGFjdC5tX3RvaUZsYWcgPSBmYWxzZTtcbiAgICAgICAgICArK21pbkNvbnRhY3QubV90b2lDb3VudDtcbiAgICAgICAgICBpZiAobWluQ29udGFjdC5pc0VuYWJsZWQoKSA9PSBmYWxzZSB8fCBtaW5Db250YWN0LmlzVG91Y2hpbmcoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgbWluQ29udGFjdC5zZXRFbmFibGVkKGZhbHNlKTtcbiAgICAgICAgICAgIGJBLm1fc3dlZXAuc2V0KGJhY2t1cDEpO1xuICAgICAgICAgICAgYkIubV9zd2VlcC5zZXQoYmFja3VwMik7XG4gICAgICAgICAgICBiQS5zeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgYkIuc3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBiQS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICBiQi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICAgICAgdGhpcy5hZGRCb2R5KGJBKTtcbiAgICAgICAgICB0aGlzLmFkZEJvZHkoYkIpO1xuICAgICAgICAgIHRoaXMuYWRkQ29udGFjdChtaW5Db250YWN0KTtcbiAgICAgICAgICBiQS5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgIGJCLm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgbWluQ29udGFjdC5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgIHZhciBib2RpZXMgPSBbYkEsIGJCXTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGJvZHkgPSBib2RpZXNbaV07XG4gICAgICAgICAgICBpZiAoYm9keS5pc0R5bmFtaWMoKSkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBjZSA9IGJvZHkubV9jb250YWN0TGlzdDsgY2U7IGNlID0gY2UubmV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBjb250YWN0ID0gY2UuY29udGFjdDtcbiAgICAgICAgICAgICAgICBpZiAoY29udGFjdC5tX2lzbGFuZEZsYWcpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb3RoZXIgPSBjZS5vdGhlcjtcbiAgICAgICAgICAgICAgICBpZiAob3RoZXIuaXNEeW5hbWljKCkgJiYgIWJvZHkuaXNCdWxsZXQoKSAmJiAhb3RoZXIuaXNCdWxsZXQoKSkge1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzZW5zb3JBID0gY29udGFjdC5tX2ZpeHR1cmVBLm1faXNTZW5zb3I7XG4gICAgICAgICAgICAgICAgdmFyIHNlbnNvckIgPSBjb250YWN0Lm1fZml4dHVyZUIubV9pc1NlbnNvcjtcbiAgICAgICAgICAgICAgICBpZiAoc2Vuc29yQSB8fCBzZW5zb3JCKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYmFja3VwLnNldChvdGhlci5tX3N3ZWVwKTtcbiAgICAgICAgICAgICAgICBpZiAob3RoZXIubV9pc2xhbmRGbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICBvdGhlci5hZHZhbmNlKG1pbkFscGhhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGFjdC51cGRhdGUod29ybGQpO1xuICAgICAgICAgICAgICAgIGlmIChjb250YWN0LmlzRW5hYmxlZCgpID09IGZhbHNlIHx8IGNvbnRhY3QuaXNUb3VjaGluZygpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICBvdGhlci5tX3N3ZWVwLnNldChiYWNrdXApO1xuICAgICAgICAgICAgICAgICAgb3RoZXIuc3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250YWN0Lm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRDb250YWN0KGNvbnRhY3QpO1xuICAgICAgICAgICAgICAgIGlmIChvdGhlci5tX2lzbGFuZEZsYWcpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvdGhlci5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICghb3RoZXIuaXNTdGF0aWMoKSkge1xuICAgICAgICAgICAgICAgICAgb3RoZXIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuYWRkQm9keShvdGhlcik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgc19zdWJTdGVwLnJlc2V0KCgxIC0gbWluQWxwaGEpICogc3RlcC5kdCk7XG4gICAgICAgICAgc19zdWJTdGVwLmR0UmF0aW8gPSAxO1xuICAgICAgICAgIHNfc3ViU3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnMgPSAyMDtcbiAgICAgICAgICBzX3N1YlN0ZXAudmVsb2NpdHlJdGVyYXRpb25zID0gc3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnM7XG4gICAgICAgICAgc19zdWJTdGVwLndhcm1TdGFydGluZyA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuc29sdmVJc2xhbmRUT0koc19zdWJTdGVwLCBiQSwgYkIpO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgICAgYm9keS5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICghYm9keS5pc0R5bmFtaWMoKSkge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJvZHkuc3luY2hyb25pemVGaXh0dXJlcygpO1xuICAgICAgICAgICAgZm9yICh2YXIgY2UgPSBib2R5Lm1fY29udGFjdExpc3Q7IGNlOyBjZSA9IGNlLm5leHQpIHtcbiAgICAgICAgICAgICAgY2UuY29udGFjdC5tX3RvaUZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgY2UuY29udGFjdC5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgd29ybGQuZmluZE5ld0NvbnRhY3RzKCk7XG4gICAgICAgICAgaWYgKHdvcmxkLm1fc3ViU3RlcHBpbmcpIHtcbiAgICAgICAgICAgIHdvcmxkLm1fc3RlcENvbXBsZXRlID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5zb2x2ZUlzbGFuZFRPSSA9IGZ1bmN0aW9uKHN1YlN0ZXAsIHRvaUEsIHRvaUIpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY19wb3NpdGlvbi5jLCBib2R5Lm1fc3dlZXAuYyk7XG4gICAgICAgICAgYm9keS5jX3Bvc2l0aW9uLmEgPSBib2R5Lm1fc3dlZXAuYTtcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfdmVsb2NpdHkudiwgYm9keS5tX2xpbmVhclZlbG9jaXR5KTtcbiAgICAgICAgICBib2R5LmNfdmVsb2NpdHkudyA9IGJvZHkubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tpXTtcbiAgICAgICAgICBjb250YWN0LmluaXRDb25zdHJhaW50KHN1YlN0ZXApO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3ViU3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnM7ICsraSkge1xuICAgICAgICAgIHZhciBtaW5TZXBhcmF0aW9uID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbal07XG4gICAgICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IGNvbnRhY3Quc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRUT0koc3ViU3RlcCwgdG9pQSwgdG9pQik7XG4gICAgICAgICAgICBtaW5TZXBhcmF0aW9uID0gbWF0aF9taW4kNShtaW5TZXBhcmF0aW9uLCBzZXBhcmF0aW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGNvbnRhY3RzT2theSA9IG1pblNlcGFyYXRpb24gPj0gLTEuNSAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgICAgICBpZiAoY29udGFjdHNPa2F5KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGNvcHlWZWMyKHRvaUEubV9zd2VlcC5jMCwgdG9pQS5jX3Bvc2l0aW9uLmMpO1xuICAgICAgICB0b2lBLm1fc3dlZXAuYTAgPSB0b2lBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgY29weVZlYzIodG9pQi5tX3N3ZWVwLmMwLCB0b2lCLmNfcG9zaXRpb24uYyk7XG4gICAgICAgIHRvaUIubV9zd2VlcC5hMCA9IHRvaUIuY19wb3NpdGlvbi5hO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2ldO1xuICAgICAgICAgIGNvbnRhY3QuaW5pdFZlbG9jaXR5Q29uc3RyYWludChzdWJTdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1YlN0ZXAudmVsb2NpdHlJdGVyYXRpb25zOyArK2kpIHtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbal07XG4gICAgICAgICAgICBjb250YWN0LnNvbHZlVmVsb2NpdHlDb25zdHJhaW50KHN1YlN0ZXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgaCA9IHN1YlN0ZXAuZHQ7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICBjb3B5VmVjMihjLCBib2R5LmNfcG9zaXRpb24uYyk7XG4gICAgICAgICAgdmFyIGEyID0gYm9keS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgICAgY29weVZlYzIodiwgYm9keS5jX3ZlbG9jaXR5LnYpO1xuICAgICAgICAgIHZhciB3ID0gYm9keS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgICAgc2NhbGVWZWMyKHRyYW5zbGF0aW9uLCBoLCB2KTtcbiAgICAgICAgICB2YXIgdHJhbnNsYXRpb25MZW5ndGhTcXIgPSBsZW5ndGhTcXJWZWMyKHRyYW5zbGF0aW9uKTtcbiAgICAgICAgICBpZiAodHJhbnNsYXRpb25MZW5ndGhTcXIgPiBTZXR0aW5nc0ludGVybmFsLm1heFRyYW5zbGF0aW9uU3F1YXJlZCkge1xuICAgICAgICAgICAgdmFyIHJhdGlvID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhUcmFuc2xhdGlvbiAvIG1hdGhfc3FydCQzKHRyYW5zbGF0aW9uTGVuZ3RoU3FyKTtcbiAgICAgICAgICAgIG11bFZlYzIodiwgcmF0aW8pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcm90YXRpb24yID0gaCAqIHc7XG4gICAgICAgICAgaWYgKHJvdGF0aW9uMiAqIHJvdGF0aW9uMiA+IFNldHRpbmdzSW50ZXJuYWwubWF4Um90YXRpb25TcXVhcmVkKSB7XG4gICAgICAgICAgICB2YXIgcmF0aW8gPSBTZXR0aW5nc0ludGVybmFsLm1heFJvdGF0aW9uIC8gbWF0aF9hYnMkNihyb3RhdGlvbjIpO1xuICAgICAgICAgICAgdyAqPSByYXRpbztcbiAgICAgICAgICB9XG4gICAgICAgICAgcGx1c1NjYWxlVmVjMihjLCBoLCB2KTtcbiAgICAgICAgICBhMiArPSBoICogdztcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfcG9zaXRpb24uYywgYyk7XG4gICAgICAgICAgYm9keS5jX3Bvc2l0aW9uLmEgPSBhMjtcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfdmVsb2NpdHkudiwgdik7XG4gICAgICAgICAgYm9keS5jX3ZlbG9jaXR5LncgPSB3O1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkubV9zd2VlcC5jLCBjKTtcbiAgICAgICAgICBib2R5Lm1fc3dlZXAuYSA9IGEyO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkubV9saW5lYXJWZWxvY2l0eSwgdik7XG4gICAgICAgICAgYm9keS5tX2FuZ3VsYXJWZWxvY2l0eSA9IHc7XG4gICAgICAgICAgYm9keS5zeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucG9zdFNvbHZlSXNsYW5kKCk7XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUucG9zdFNvbHZlSXNsYW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZvciAodmFyIGNfNSA9IDA7IGNfNSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsrY181KSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbY181XTtcbiAgICAgICAgICB0aGlzLm1fd29ybGQucG9zdFNvbHZlKGNvbnRhY3QsIGNvbnRhY3QubV9pbXB1bHNlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHJldHVybiBTb2x2ZXIyO1xuICAgIH0oKVxuICApO1xuICBTb2x2ZXIuVGltZVN0ZXAgPSBUaW1lU3RlcDtcbiAgdmFyIE1hdDIyID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIE1hdDIyMihhMiwgYjIsIGMyLCBkMikge1xuICAgICAgICBpZiAodHlwZW9mIGEyID09PSBcIm9iamVjdFwiICYmIGEyICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5leCA9IFZlYzIuY2xvbmUoYTIpO1xuICAgICAgICAgIHRoaXMuZXkgPSBWZWMyLmNsb25lKGIyKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYTIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICB0aGlzLmV4ID0gVmVjMi5uZW8oYTIsIGMyKTtcbiAgICAgICAgICB0aGlzLmV5ID0gVmVjMi5uZW8oYjIsIGQyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmV4ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgdGhpcy5leSA9IFZlYzIuemVybygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBNYXQyMjIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFZlYzIuaXNWYWxpZChvYmouZXgpICYmIFZlYzIuaXNWYWxpZChvYmouZXkpO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5hc3NlcnQgPSBmdW5jdGlvbihvKSB7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihhMiwgYjIsIGMyLCBkMikge1xuICAgICAgICBpZiAodHlwZW9mIGEyID09PSBcIm51bWJlclwiICYmIHR5cGVvZiBiMiA9PT0gXCJudW1iZXJcIiAmJiB0eXBlb2YgYzIgPT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGQyID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgdGhpcy5leC5zZXROdW0oYTIsIGMyKTtcbiAgICAgICAgICB0aGlzLmV5LnNldE51bShiMiwgZDIpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhMiA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgYjIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLmV4LnNldFZlYzIoYTIpO1xuICAgICAgICAgIHRoaXMuZXkuc2V0VmVjMihiMik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGEyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy5leC5zZXRWZWMyKGEyLmV4KTtcbiAgICAgICAgICB0aGlzLmV5LnNldFZlYzIoYTIuZXkpO1xuICAgICAgICB9IGVsc2UgO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5wcm90b3R5cGUuc2V0SWRlbnRpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5leC54ID0gMTtcbiAgICAgICAgdGhpcy5leS54ID0gMDtcbiAgICAgICAgdGhpcy5leC55ID0gMDtcbiAgICAgICAgdGhpcy5leS55ID0gMTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIucHJvdG90eXBlLnNldFplcm8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5leC54ID0gMDtcbiAgICAgICAgdGhpcy5leS54ID0gMDtcbiAgICAgICAgdGhpcy5leC55ID0gMDtcbiAgICAgICAgdGhpcy5leS55ID0gMDtcbiAgICAgIH07XG4gICAgICBNYXQyMjIucHJvdG90eXBlLmdldEludmVyc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGEyID0gdGhpcy5leC54O1xuICAgICAgICB2YXIgYjIgPSB0aGlzLmV5Lng7XG4gICAgICAgIHZhciBjMiA9IHRoaXMuZXgueTtcbiAgICAgICAgdmFyIGQyID0gdGhpcy5leS55O1xuICAgICAgICB2YXIgZGV0ID0gYTIgKiBkMiAtIGIyICogYzI7XG4gICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICBkZXQgPSAxIC8gZGV0O1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbXggPSBuZXcgTWF0MjIyKCk7XG4gICAgICAgIGlteC5leC54ID0gZGV0ICogZDI7XG4gICAgICAgIGlteC5leS54ID0gLWRldCAqIGIyO1xuICAgICAgICBpbXguZXgueSA9IC1kZXQgKiBjMjtcbiAgICAgICAgaW14LmV5LnkgPSBkZXQgKiBhMjtcbiAgICAgICAgcmV0dXJuIGlteDtcbiAgICAgIH07XG4gICAgICBNYXQyMjIucHJvdG90eXBlLnNvbHZlID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgdmFyIGEyID0gdGhpcy5leC54O1xuICAgICAgICB2YXIgYjIgPSB0aGlzLmV5Lng7XG4gICAgICAgIHZhciBjMiA9IHRoaXMuZXgueTtcbiAgICAgICAgdmFyIGQyID0gdGhpcy5leS55O1xuICAgICAgICB2YXIgZGV0ID0gYTIgKiBkMiAtIGIyICogYzI7XG4gICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICBkZXQgPSAxIC8gZGV0O1xuICAgICAgICB9XG4gICAgICAgIHZhciB3ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHcueCA9IGRldCAqIChkMiAqIHYzLnggLSBiMiAqIHYzLnkpO1xuICAgICAgICB3LnkgPSBkZXQgKiAoYTIgKiB2My55IC0gYzIgKiB2My54KTtcbiAgICAgICAgcmV0dXJuIHc7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLm11bCA9IGZ1bmN0aW9uKG14LCB2Mykge1xuICAgICAgICBpZiAodjMgJiYgXCJ4XCIgaW4gdjMgJiYgXCJ5XCIgaW4gdjMpIHtcbiAgICAgICAgICB2YXIgeDIgPSBteC5leC54ICogdjMueCArIG14LmV5LnggKiB2My55O1xuICAgICAgICAgIHZhciB5ID0gbXguZXgueSAqIHYzLnggKyBteC5leS55ICogdjMueTtcbiAgICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgICB9IGVsc2UgaWYgKHYzICYmIFwiZXhcIiBpbiB2MyAmJiBcImV5XCIgaW4gdjMpIHtcbiAgICAgICAgICB2YXIgYTIgPSBteC5leC54ICogdjMuZXgueCArIG14LmV5LnggKiB2My5leC55O1xuICAgICAgICAgIHZhciBiMiA9IG14LmV4LnggKiB2My5leS54ICsgbXguZXkueCAqIHYzLmV5Lnk7XG4gICAgICAgICAgdmFyIGMyID0gbXguZXgueSAqIHYzLmV4LnggKyBteC5leS55ICogdjMuZXgueTtcbiAgICAgICAgICB2YXIgZDIgPSBteC5leC55ICogdjMuZXkueCArIG14LmV5LnkgKiB2My5leS55O1xuICAgICAgICAgIHJldHVybiBuZXcgTWF0MjIyKGEyLCBiMiwgYzIsIGQyKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1hdDIyMi5tdWxWZWMyID0gZnVuY3Rpb24obXgsIHYzKSB7XG4gICAgICAgIHZhciB4MiA9IG14LmV4LnggKiB2My54ICsgbXguZXkueCAqIHYzLnk7XG4gICAgICAgIHZhciB5ID0gbXguZXgueSAqIHYzLnggKyBteC5leS55ICogdjMueTtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHgyLCB5KTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIubXVsTWF0MjIgPSBmdW5jdGlvbihteCwgdjMpIHtcbiAgICAgICAgdmFyIGEyID0gbXguZXgueCAqIHYzLmV4LnggKyBteC5leS54ICogdjMuZXgueTtcbiAgICAgICAgdmFyIGIyID0gbXguZXgueCAqIHYzLmV5LnggKyBteC5leS54ICogdjMuZXkueTtcbiAgICAgICAgdmFyIGMyID0gbXguZXgueSAqIHYzLmV4LnggKyBteC5leS55ICogdjMuZXgueTtcbiAgICAgICAgdmFyIGQyID0gbXguZXgueSAqIHYzLmV5LnggKyBteC5leS55ICogdjMuZXkueTtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXQyMjIoYTIsIGIyLCBjMiwgZDIpO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5tdWxUID0gZnVuY3Rpb24obXgsIHYzKSB7XG4gICAgICAgIGlmICh2MyAmJiBcInhcIiBpbiB2MyAmJiBcInlcIiBpbiB2Mykge1xuICAgICAgICAgIHJldHVybiBWZWMyLm5lbyhWZWMyLmRvdCh2MywgbXguZXgpLCBWZWMyLmRvdCh2MywgbXguZXkpKTtcbiAgICAgICAgfSBlbHNlIGlmICh2MyAmJiBcImV4XCIgaW4gdjMgJiYgXCJleVwiIGluIHYzKSB7XG4gICAgICAgICAgdmFyIGMxID0gVmVjMi5uZW8oVmVjMi5kb3QobXguZXgsIHYzLmV4KSwgVmVjMi5kb3QobXguZXksIHYzLmV4KSk7XG4gICAgICAgICAgdmFyIGMyID0gVmVjMi5uZW8oVmVjMi5kb3QobXguZXgsIHYzLmV5KSwgVmVjMi5kb3QobXguZXksIHYzLmV5KSk7XG4gICAgICAgICAgcmV0dXJuIG5ldyBNYXQyMjIoYzEsIGMyKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1hdDIyMi5tdWxUVmVjMiA9IGZ1bmN0aW9uKG14LCB2Mykge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oVmVjMi5kb3QodjMsIG14LmV4KSwgVmVjMi5kb3QodjMsIG14LmV5KSk7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLm11bFRNYXQyMiA9IGZ1bmN0aW9uKG14LCB2Mykge1xuICAgICAgICB2YXIgYzEgPSBWZWMyLm5lbyhWZWMyLmRvdChteC5leCwgdjMuZXgpLCBWZWMyLmRvdChteC5leSwgdjMuZXgpKTtcbiAgICAgICAgdmFyIGMyID0gVmVjMi5uZW8oVmVjMi5kb3QobXguZXgsIHYzLmV5KSwgVmVjMi5kb3QobXguZXksIHYzLmV5KSk7XG4gICAgICAgIHJldHVybiBuZXcgTWF0MjIyKGMxLCBjMik7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLmFicyA9IGZ1bmN0aW9uKG14KSB7XG4gICAgICAgIHJldHVybiBuZXcgTWF0MjIyKFZlYzIuYWJzKG14LmV4KSwgVmVjMi5hYnMobXguZXkpKTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIuYWRkID0gZnVuY3Rpb24obXgxLCBteDIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXQyMjIoVmVjMi5hZGQobXgxLmV4LCBteDIuZXgpLCBWZWMyLmFkZChteDEuZXksIG14Mi5leSkpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBNYXQyMjI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX3NxcnQkMiA9IE1hdGguc3FydDtcbiAgdmFyIHBvaW50QSQxID0gdmVjMigwLCAwKTtcbiAgdmFyIHBvaW50QiQxID0gdmVjMigwLCAwKTtcbiAgdmFyIHRlbXAkMyA9IHZlYzIoMCwgMCk7XG4gIHZhciBjQSQxID0gdmVjMigwLCAwKTtcbiAgdmFyIGNCJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgZGlzdCA9IHZlYzIoMCwgMCk7XG4gIHZhciBwbGFuZVBvaW50JDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgY2xpcFBvaW50JDEgPSB2ZWMyKDAsIDApO1xuICBleHBvcnRzMi5NYW5pZm9sZFR5cGUgPSB2b2lkIDA7XG4gIChmdW5jdGlvbihNYW5pZm9sZFR5cGUyKSB7XG4gICAgTWFuaWZvbGRUeXBlMltNYW5pZm9sZFR5cGUyW1wiZV91bnNldFwiXSA9IC0xXSA9IFwiZV91bnNldFwiO1xuICAgIE1hbmlmb2xkVHlwZTJbTWFuaWZvbGRUeXBlMltcImVfY2lyY2xlc1wiXSA9IDBdID0gXCJlX2NpcmNsZXNcIjtcbiAgICBNYW5pZm9sZFR5cGUyW01hbmlmb2xkVHlwZTJbXCJlX2ZhY2VBXCJdID0gMV0gPSBcImVfZmFjZUFcIjtcbiAgICBNYW5pZm9sZFR5cGUyW01hbmlmb2xkVHlwZTJbXCJlX2ZhY2VCXCJdID0gMl0gPSBcImVfZmFjZUJcIjtcbiAgfSkoZXhwb3J0czIuTWFuaWZvbGRUeXBlIHx8IChleHBvcnRzMi5NYW5pZm9sZFR5cGUgPSB7fSkpO1xuICBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUgPSB2b2lkIDA7XG4gIChmdW5jdGlvbihDb250YWN0RmVhdHVyZVR5cGUyKSB7XG4gICAgQ29udGFjdEZlYXR1cmVUeXBlMltDb250YWN0RmVhdHVyZVR5cGUyW1wiZV91bnNldFwiXSA9IC0xXSA9IFwiZV91bnNldFwiO1xuICAgIENvbnRhY3RGZWF0dXJlVHlwZTJbQ29udGFjdEZlYXR1cmVUeXBlMltcImVfdmVydGV4XCJdID0gMF0gPSBcImVfdmVydGV4XCI7XG4gICAgQ29udGFjdEZlYXR1cmVUeXBlMltDb250YWN0RmVhdHVyZVR5cGUyW1wiZV9mYWNlXCJdID0gMV0gPSBcImVfZmFjZVwiO1xuICB9KShleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUgfHwgKGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZSA9IHt9KSk7XG4gIGV4cG9ydHMyLlBvaW50U3RhdGUgPSB2b2lkIDA7XG4gIChmdW5jdGlvbihQb2ludFN0YXRlMikge1xuICAgIFBvaW50U3RhdGUyW1BvaW50U3RhdGUyW1wibnVsbFN0YXRlXCJdID0gMF0gPSBcIm51bGxTdGF0ZVwiO1xuICAgIFBvaW50U3RhdGUyW1BvaW50U3RhdGUyW1wiYWRkU3RhdGVcIl0gPSAxXSA9IFwiYWRkU3RhdGVcIjtcbiAgICBQb2ludFN0YXRlMltQb2ludFN0YXRlMltcInBlcnNpc3RTdGF0ZVwiXSA9IDJdID0gXCJwZXJzaXN0U3RhdGVcIjtcbiAgICBQb2ludFN0YXRlMltQb2ludFN0YXRlMltcInJlbW92ZVN0YXRlXCJdID0gM10gPSBcInJlbW92ZVN0YXRlXCI7XG4gIH0pKGV4cG9ydHMyLlBvaW50U3RhdGUgfHwgKGV4cG9ydHMyLlBvaW50U3RhdGUgPSB7fSkpO1xuICB2YXIgQ2xpcFZlcnRleCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBDbGlwVmVydGV4MigpIHtcbiAgICAgICAgdGhpcy52ID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5pZCA9IG5ldyBDb250YWN0SUQoKTtcbiAgICAgIH1cbiAgICAgIENsaXBWZXJ0ZXgyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihvKSB7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMudiwgby52KTtcbiAgICAgICAgdGhpcy5pZC5zZXQoby5pZCk7XG4gICAgICB9O1xuICAgICAgQ2xpcFZlcnRleDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgemVyb1ZlYzIodGhpcy52KTtcbiAgICAgICAgdGhpcy5pZC5yZWN5Y2xlKCk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIENsaXBWZXJ0ZXgyO1xuICAgIH0oKVxuICApO1xuICB2YXIgTWFuaWZvbGQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gTWFuaWZvbGQyKCkge1xuICAgICAgICB0aGlzLmxvY2FsTm9ybWFsID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5sb2NhbFBvaW50ID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5wb2ludHMgPSBbbmV3IE1hbmlmb2xkUG9pbnQoKSwgbmV3IE1hbmlmb2xkUG9pbnQoKV07XG4gICAgICAgIHRoaXMucG9pbnRDb3VudCA9IDA7XG4gICAgICB9XG4gICAgICBNYW5pZm9sZDIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRoYXQpIHtcbiAgICAgICAgdGhpcy50eXBlID0gdGhhdC50eXBlO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmxvY2FsTm9ybWFsLCB0aGF0LmxvY2FsTm9ybWFsKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5sb2NhbFBvaW50LCB0aGF0LmxvY2FsUG9pbnQpO1xuICAgICAgICB0aGlzLnBvaW50Q291bnQgPSB0aGF0LnBvaW50Q291bnQ7XG4gICAgICAgIHRoaXMucG9pbnRzWzBdLnNldCh0aGF0LnBvaW50c1swXSk7XG4gICAgICAgIHRoaXMucG9pbnRzWzFdLnNldCh0aGF0LnBvaW50c1sxXSk7XG4gICAgICB9O1xuICAgICAgTWFuaWZvbGQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX3Vuc2V0O1xuICAgICAgICB6ZXJvVmVjMih0aGlzLmxvY2FsTm9ybWFsKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5sb2NhbFBvaW50KTtcbiAgICAgICAgdGhpcy5wb2ludENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5wb2ludHNbMF0ucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnBvaW50c1sxXS5yZWN5Y2xlKCk7XG4gICAgICB9O1xuICAgICAgTWFuaWZvbGQyLnByb3RvdHlwZS5nZXRXb3JsZE1hbmlmb2xkID0gZnVuY3Rpb24od20sIHhmQTIsIHJhZGl1c0EsIHhmQjIsIHJhZGl1c0IpIHtcbiAgICAgICAgaWYgKHRoaXMucG9pbnRDb3VudCA9PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIHdtO1xuICAgICAgICB9XG4gICAgICAgIHdtID0gd20gfHwgbmV3IFdvcmxkTWFuaWZvbGQoKTtcbiAgICAgICAgd20ucG9pbnRDb3VudCA9IHRoaXMucG9pbnRDb3VudDtcbiAgICAgICAgdmFyIG5vcm1hbDMgPSB3bS5ub3JtYWw7XG4gICAgICAgIHZhciBwb2ludHMgPSB3bS5wb2ludHM7XG4gICAgICAgIHZhciBzZXBhcmF0aW9ucyA9IHdtLnNlcGFyYXRpb25zO1xuICAgICAgICBzd2l0Y2ggKHRoaXMudHlwZSkge1xuICAgICAgICAgIGNhc2UgZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfY2lyY2xlczoge1xuICAgICAgICAgICAgc2V0VmVjMihub3JtYWwzLCAxLCAwKTtcbiAgICAgICAgICAgIHZhciBtYW5pZm9sZFBvaW50ID0gdGhpcy5wb2ludHNbMF07XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSQxLCB4ZkEyLCB0aGlzLmxvY2FsUG9pbnQpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMSwgeGZCMiwgbWFuaWZvbGRQb2ludC5sb2NhbFBvaW50KTtcbiAgICAgICAgICAgIHN1YlZlYzIoZGlzdCwgcG9pbnRCJDEsIHBvaW50QSQxKTtcbiAgICAgICAgICAgIHZhciBsZW5ndGhTcXIgPSBsZW5ndGhTcXJWZWMyKGRpc3QpO1xuICAgICAgICAgICAgaWYgKGxlbmd0aFNxciA+IEVQU0lMT04gKiBFUFNJTE9OKSB7XG4gICAgICAgICAgICAgIHZhciBsZW5ndGhfMSA9IG1hdGhfc3FydCQyKGxlbmd0aFNxcik7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwzLCAxIC8gbGVuZ3RoXzEsIGRpc3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29tYmluZTJWZWMyKGNBJDEsIDEsIHBvaW50QSQxLCByYWRpdXNBLCBub3JtYWwzKTtcbiAgICAgICAgICAgIGNvbWJpbmUyVmVjMihjQiQxLCAxLCBwb2ludEIkMSwgLXJhZGl1c0IsIG5vcm1hbDMpO1xuICAgICAgICAgICAgY29tYmluZTJWZWMyKHBvaW50c1swXSwgMC41LCBjQSQxLCAwLjUsIGNCJDEpO1xuICAgICAgICAgICAgc2VwYXJhdGlvbnNbMF0gPSBkb3RWZWMyKHN1YlZlYzIodGVtcCQzLCBjQiQxLCBjQSQxKSwgbm9ybWFsMyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQToge1xuICAgICAgICAgICAgcm90VmVjMihub3JtYWwzLCB4ZkEyLnEsIHRoaXMubG9jYWxOb3JtYWwpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwbGFuZVBvaW50JDIsIHhmQTIsIHRoaXMubG9jYWxQb2ludCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucG9pbnRDb3VudDsgKytpKSB7XG4gICAgICAgICAgICAgIHZhciBtYW5pZm9sZFBvaW50ID0gdGhpcy5wb2ludHNbaV07XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIoY2xpcFBvaW50JDEsIHhmQjIsIG1hbmlmb2xkUG9pbnQubG9jYWxQb2ludCk7XG4gICAgICAgICAgICAgIGNvbWJpbmUyVmVjMihjQSQxLCAxLCBjbGlwUG9pbnQkMSwgcmFkaXVzQSAtIGRvdFZlYzIoc3ViVmVjMih0ZW1wJDMsIGNsaXBQb2ludCQxLCBwbGFuZVBvaW50JDIpLCBub3JtYWwzKSwgbm9ybWFsMyk7XG4gICAgICAgICAgICAgIGNvbWJpbmUyVmVjMihjQiQxLCAxLCBjbGlwUG9pbnQkMSwgLXJhZGl1c0IsIG5vcm1hbDMpO1xuICAgICAgICAgICAgICBjb21iaW5lMlZlYzIocG9pbnRzW2ldLCAwLjUsIGNBJDEsIDAuNSwgY0IkMSk7XG4gICAgICAgICAgICAgIHNlcGFyYXRpb25zW2ldID0gZG90VmVjMihzdWJWZWMyKHRlbXAkMywgY0IkMSwgY0EkMSksIG5vcm1hbDMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhc2UgZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUI6IHtcbiAgICAgICAgICAgIHJvdFZlYzIobm9ybWFsMywgeGZCMi5xLCB0aGlzLmxvY2FsTm9ybWFsKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocGxhbmVQb2ludCQyLCB4ZkIyLCB0aGlzLmxvY2FsUG9pbnQpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBvaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgICB2YXIgbWFuaWZvbGRQb2ludCA9IHRoaXMucG9pbnRzW2ldO1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKGNsaXBQb2ludCQxLCB4ZkEyLCBtYW5pZm9sZFBvaW50LmxvY2FsUG9pbnQpO1xuICAgICAgICAgICAgICBjb21iaW5lMlZlYzIoY0IkMSwgMSwgY2xpcFBvaW50JDEsIHJhZGl1c0IgLSBkb3RWZWMyKHN1YlZlYzIodGVtcCQzLCBjbGlwUG9pbnQkMSwgcGxhbmVQb2ludCQyKSwgbm9ybWFsMyksIG5vcm1hbDMpO1xuICAgICAgICAgICAgICBjb21iaW5lMlZlYzIoY0EkMSwgMSwgY2xpcFBvaW50JDEsIC1yYWRpdXNBLCBub3JtYWwzKTtcbiAgICAgICAgICAgICAgY29tYmluZTJWZWMyKHBvaW50c1tpXSwgMC41LCBjQSQxLCAwLjUsIGNCJDEpO1xuICAgICAgICAgICAgICBzZXBhcmF0aW9uc1tpXSA9IGRvdFZlYzIoc3ViVmVjMih0ZW1wJDMsIGNBJDEsIGNCJDEpLCBub3JtYWwzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5lZ1ZlYzIobm9ybWFsMyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHdtO1xuICAgICAgfTtcbiAgICAgIE1hbmlmb2xkMi5jbGlwU2VnbWVudFRvTGluZSA9IGNsaXBTZWdtZW50VG9MaW5lO1xuICAgICAgTWFuaWZvbGQyLkNsaXBWZXJ0ZXggPSBDbGlwVmVydGV4O1xuICAgICAgTWFuaWZvbGQyLmdldFBvaW50U3RhdGVzID0gZ2V0UG9pbnRTdGF0ZXM7XG4gICAgICBNYW5pZm9sZDIuUG9pbnRTdGF0ZSA9IGV4cG9ydHMyLlBvaW50U3RhdGU7XG4gICAgICByZXR1cm4gTWFuaWZvbGQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgTWFuaWZvbGRQb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBNYW5pZm9sZFBvaW50MigpIHtcbiAgICAgICAgdGhpcy5sb2NhbFBvaW50ID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5ub3JtYWxJbXB1bHNlID0gMDtcbiAgICAgICAgdGhpcy50YW5nZW50SW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMuaWQgPSBuZXcgQ29udGFjdElEKCk7XG4gICAgICB9XG4gICAgICBNYW5pZm9sZFBvaW50Mi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24odGhhdCkge1xuICAgICAgICBjb3B5VmVjMih0aGlzLmxvY2FsUG9pbnQsIHRoYXQubG9jYWxQb2ludCk7XG4gICAgICAgIHRoaXMubm9ybWFsSW1wdWxzZSA9IHRoYXQubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgdGhpcy50YW5nZW50SW1wdWxzZSA9IHRoYXQudGFuZ2VudEltcHVsc2U7XG4gICAgICAgIHRoaXMuaWQuc2V0KHRoYXQuaWQpO1xuICAgICAgfTtcbiAgICAgIE1hbmlmb2xkUG9pbnQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubG9jYWxQb2ludCk7XG4gICAgICAgIHRoaXMubm9ybWFsSW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMudGFuZ2VudEltcHVsc2UgPSAwO1xuICAgICAgICB0aGlzLmlkLnJlY3ljbGUoKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gTWFuaWZvbGRQb2ludDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBDb250YWN0SUQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gQ29udGFjdElEMigpIHtcbiAgICAgICAgdGhpcy5rZXkgPSAtMTtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAtMTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSAtMTtcbiAgICAgICAgdGhpcy50eXBlQSA9IGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLnR5cGVCID0gZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdW5zZXQ7XG4gICAgICB9XG4gICAgICBDb250YWN0SUQyLnByb3RvdHlwZS5zZXRGZWF0dXJlcyA9IGZ1bmN0aW9uKGluZGV4QSwgdHlwZUEsIGluZGV4QiwgdHlwZUIpIHtcbiAgICAgICAgdGhpcy5pbmRleEEgPSBpbmRleEE7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gaW5kZXhCO1xuICAgICAgICB0aGlzLnR5cGVBID0gdHlwZUE7XG4gICAgICAgIHRoaXMudHlwZUIgPSB0eXBlQjtcbiAgICAgICAgdGhpcy5rZXkgPSB0aGlzLmluZGV4QSArIHRoaXMuaW5kZXhCICogNCArIHRoaXMudHlwZUEgKiAxNiArIHRoaXMudHlwZUIgKiA2NDtcbiAgICAgIH07XG4gICAgICBDb250YWN0SUQyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih0aGF0KSB7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gdGhhdC5pbmRleEE7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gdGhhdC5pbmRleEI7XG4gICAgICAgIHRoaXMudHlwZUEgPSB0aGF0LnR5cGVBO1xuICAgICAgICB0aGlzLnR5cGVCID0gdGhhdC50eXBlQjtcbiAgICAgICAgdGhpcy5rZXkgPSB0aGlzLmluZGV4QSArIHRoaXMuaW5kZXhCICogNCArIHRoaXMudHlwZUEgKiAxNiArIHRoaXMudHlwZUIgKiA2NDtcbiAgICAgIH07XG4gICAgICBDb250YWN0SUQyLnByb3RvdHlwZS5zd2FwRmVhdHVyZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGluZGV4QSA9IHRoaXMuaW5kZXhBO1xuICAgICAgICB2YXIgaW5kZXhCID0gdGhpcy5pbmRleEI7XG4gICAgICAgIHZhciB0eXBlQSA9IHRoaXMudHlwZUE7XG4gICAgICAgIHZhciB0eXBlQiA9IHRoaXMudHlwZUI7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gaW5kZXhCO1xuICAgICAgICB0aGlzLmluZGV4QiA9IGluZGV4QTtcbiAgICAgICAgdGhpcy50eXBlQSA9IHR5cGVCO1xuICAgICAgICB0aGlzLnR5cGVCID0gdHlwZUE7XG4gICAgICAgIHRoaXMua2V5ID0gdGhpcy5pbmRleEEgKyB0aGlzLmluZGV4QiAqIDQgKyB0aGlzLnR5cGVBICogMTYgKyB0aGlzLnR5cGVCICogNjQ7XG4gICAgICB9O1xuICAgICAgQ29udGFjdElEMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmluZGV4QSA9IDA7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gMDtcbiAgICAgICAgdGhpcy50eXBlQSA9IGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLnR5cGVCID0gZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdW5zZXQ7XG4gICAgICAgIHRoaXMua2V5ID0gLTE7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIENvbnRhY3RJRDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBXb3JsZE1hbmlmb2xkID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFdvcmxkTWFuaWZvbGQyKCkge1xuICAgICAgICB0aGlzLm5vcm1hbCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMucG9pbnRzID0gW3ZlYzIoMCwgMCksIHZlYzIoMCwgMCldO1xuICAgICAgICB0aGlzLnNlcGFyYXRpb25zID0gWzAsIDBdO1xuICAgICAgICB0aGlzLnBvaW50Q291bnQgPSAwO1xuICAgICAgfVxuICAgICAgV29ybGRNYW5pZm9sZDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5ub3JtYWwpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBvaW50c1swXSk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMucG9pbnRzWzFdKTtcbiAgICAgICAgdGhpcy5zZXBhcmF0aW9uc1swXSA9IDA7XG4gICAgICAgIHRoaXMuc2VwYXJhdGlvbnNbMV0gPSAwO1xuICAgICAgICB0aGlzLnBvaW50Q291bnQgPSAwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBXb3JsZE1hbmlmb2xkMjtcbiAgICB9KClcbiAgKTtcbiAgZnVuY3Rpb24gZ2V0UG9pbnRTdGF0ZXMoc3RhdGUxLCBzdGF0ZTIsIG1hbmlmb2xkMSwgbWFuaWZvbGQyKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYW5pZm9sZDEucG9pbnRDb3VudDsgKytpKSB7XG4gICAgICB2YXIgaWQgPSBtYW5pZm9sZDEucG9pbnRzW2ldLmlkO1xuICAgICAgc3RhdGUxW2ldID0gZXhwb3J0czIuUG9pbnRTdGF0ZS5yZW1vdmVTdGF0ZTtcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbWFuaWZvbGQyLnBvaW50Q291bnQ7ICsraikge1xuICAgICAgICBpZiAobWFuaWZvbGQyLnBvaW50c1tqXS5pZC5rZXkgPT09IGlkLmtleSkge1xuICAgICAgICAgIHN0YXRlMVtpXSA9IGV4cG9ydHMyLlBvaW50U3RhdGUucGVyc2lzdFN0YXRlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFuaWZvbGQyLnBvaW50Q291bnQ7ICsraSkge1xuICAgICAgdmFyIGlkID0gbWFuaWZvbGQyLnBvaW50c1tpXS5pZDtcbiAgICAgIHN0YXRlMltpXSA9IGV4cG9ydHMyLlBvaW50U3RhdGUuYWRkU3RhdGU7XG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1hbmlmb2xkMS5wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgaWYgKG1hbmlmb2xkMS5wb2ludHNbal0uaWQua2V5ID09PSBpZC5rZXkpIHtcbiAgICAgICAgICBzdGF0ZTJbaV0gPSBleHBvcnRzMi5Qb2ludFN0YXRlLnBlcnNpc3RTdGF0ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBjbGlwU2VnbWVudFRvTGluZSh2T3V0LCB2SW4sIG5vcm1hbDMsIG9mZnNldCwgdmVydGV4SW5kZXhBKSB7XG4gICAgdmFyIG51bU91dCA9IDA7XG4gICAgdmFyIGRpc3RhbmNlMCA9IGRvdFZlYzIobm9ybWFsMywgdkluWzBdLnYpIC0gb2Zmc2V0O1xuICAgIHZhciBkaXN0YW5jZTEgPSBkb3RWZWMyKG5vcm1hbDMsIHZJblsxXS52KSAtIG9mZnNldDtcbiAgICBpZiAoZGlzdGFuY2UwIDw9IDApXG4gICAgICB2T3V0W251bU91dCsrXS5zZXQodkluWzBdKTtcbiAgICBpZiAoZGlzdGFuY2UxIDw9IDApXG4gICAgICB2T3V0W251bU91dCsrXS5zZXQodkluWzFdKTtcbiAgICBpZiAoZGlzdGFuY2UwICogZGlzdGFuY2UxIDwgMCkge1xuICAgICAgdmFyIGludGVycCA9IGRpc3RhbmNlMCAvIChkaXN0YW5jZTAgLSBkaXN0YW5jZTEpO1xuICAgICAgY29tYmluZTJWZWMyKHZPdXRbbnVtT3V0XS52LCAxIC0gaW50ZXJwLCB2SW5bMF0udiwgaW50ZXJwLCB2SW5bMV0udik7XG4gICAgICB2T3V0W251bU91dF0uaWQuc2V0RmVhdHVyZXModmVydGV4SW5kZXhBLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIHZJblswXS5pZC5pbmRleEIsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UpO1xuICAgICAgKytudW1PdXQ7XG4gICAgfVxuICAgIHJldHVybiBudW1PdXQ7XG4gIH1cbiAgdmFyIG1hdGhfc3FydCQxID0gTWF0aC5zcXJ0O1xuICB2YXIgbWF0aF9tYXgkMiA9IE1hdGgubWF4O1xuICB2YXIgbWF0aF9taW4kNCA9IE1hdGgubWluO1xuICB2YXIgY29udGFjdFBvb2wgPSBuZXcgUG9vbCh7XG4gICAgY3JlYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBuZXcgQ29udGFjdCgpO1xuICAgIH0sXG4gICAgcmVsZWFzZTogZnVuY3Rpb24oY29udGFjdCkge1xuICAgICAgY29udGFjdC5yZWN5Y2xlKCk7XG4gICAgfVxuICB9KTtcbiAgdmFyIG9sZE1hbmlmb2xkID0gbmV3IE1hbmlmb2xkKCk7XG4gIHZhciB3b3JsZE1hbmlmb2xkID0gbmV3IFdvcmxkTWFuaWZvbGQoKTtcbiAgdmFyIENvbnRhY3RFZGdlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIENvbnRhY3RFZGdlMihjb250YWN0KSB7XG4gICAgICAgIHRoaXMucHJldiA9IG51bGw7XG4gICAgICAgIHRoaXMubmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMub3RoZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmNvbnRhY3QgPSBjb250YWN0O1xuICAgICAgfVxuICAgICAgQ29udGFjdEVkZ2UyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucHJldiA9IG51bGw7XG4gICAgICAgIHRoaXMubmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMub3RoZXIgPSBudWxsO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBDb250YWN0RWRnZTI7XG4gICAgfSgpXG4gICk7XG4gIGZ1bmN0aW9uIG1peEZyaWN0aW9uKGZyaWN0aW9uMSwgZnJpY3Rpb24yKSB7XG4gICAgcmV0dXJuIG1hdGhfc3FydCQxKGZyaWN0aW9uMSAqIGZyaWN0aW9uMik7XG4gIH1cbiAgZnVuY3Rpb24gbWl4UmVzdGl0dXRpb24ocmVzdGl0dXRpb24xLCByZXN0aXR1dGlvbjIpIHtcbiAgICByZXR1cm4gcmVzdGl0dXRpb24xID4gcmVzdGl0dXRpb24yID8gcmVzdGl0dXRpb24xIDogcmVzdGl0dXRpb24yO1xuICB9XG4gIHZhciBzX3JlZ2lzdGVycyA9IFtdO1xuICB2YXIgVmVsb2NpdHlDb25zdHJhaW50UG9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVmVsb2NpdHlDb25zdHJhaW50UG9pbnQyKCkge1xuICAgICAgICB0aGlzLnJBID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5yQiA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMubm9ybWFsSW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMudGFuZ2VudEltcHVsc2UgPSAwO1xuICAgICAgICB0aGlzLm5vcm1hbE1hc3MgPSAwO1xuICAgICAgICB0aGlzLnRhbmdlbnRNYXNzID0gMDtcbiAgICAgICAgdGhpcy52ZWxvY2l0eUJpYXMgPSAwO1xuICAgICAgfVxuICAgICAgVmVsb2NpdHlDb25zdHJhaW50UG9pbnQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHplcm9WZWMyKHRoaXMuckEpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnJCKTtcbiAgICAgICAgdGhpcy5ub3JtYWxJbXB1bHNlID0gMDtcbiAgICAgICAgdGhpcy50YW5nZW50SW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMubm9ybWFsTWFzcyA9IDA7XG4gICAgICAgIHRoaXMudGFuZ2VudE1hc3MgPSAwO1xuICAgICAgICB0aGlzLnZlbG9jaXR5QmlhcyA9IDA7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFZlbG9jaXR5Q29uc3RyYWludFBvaW50MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIGNBID0gdmVjMigwLCAwKTtcbiAgdmFyIHZBID0gdmVjMigwLCAwKTtcbiAgdmFyIGNCID0gdmVjMigwLCAwKTtcbiAgdmFyIHZCID0gdmVjMigwLCAwKTtcbiAgdmFyIHRhbmdlbnQkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciB4ZkEgPSB0cmFuc2Zvcm0oMCwgMCwgMCk7XG4gIHZhciB4ZkIgPSB0cmFuc2Zvcm0oMCwgMCwgMCk7XG4gIHZhciBwb2ludEEgPSB2ZWMyKDAsIDApO1xuICB2YXIgcG9pbnRCID0gdmVjMigwLCAwKTtcbiAgdmFyIGNsaXBQb2ludCA9IHZlYzIoMCwgMCk7XG4gIHZhciBwbGFuZVBvaW50JDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgckEgPSB2ZWMyKDAsIDApO1xuICB2YXIgckIgPSB2ZWMyKDAsIDApO1xuICB2YXIgUCQxID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbCQyID0gdmVjMigwLCAwKTtcbiAgdmFyIHBvaW50ID0gdmVjMigwLCAwKTtcbiAgdmFyIGR2ID0gdmVjMigwLCAwKTtcbiAgdmFyIGR2MSA9IHZlYzIoMCwgMCk7XG4gIHZhciBkdjIgPSB2ZWMyKDAsIDApO1xuICB2YXIgYiA9IHZlYzIoMCwgMCk7XG4gIHZhciBhID0gdmVjMigwLCAwKTtcbiAgdmFyIHggPSB2ZWMyKDAsIDApO1xuICB2YXIgZCA9IHZlYzIoMCwgMCk7XG4gIHZhciBQMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBQMiA9IHZlYzIoMCwgMCk7XG4gIHZhciB0ZW1wJDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgQ29udGFjdCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBDb250YWN0MigpIHtcbiAgICAgICAgdGhpcy5tX25vZGVBID0gbmV3IENvbnRhY3RFZGdlKHRoaXMpO1xuICAgICAgICB0aGlzLm1fbm9kZUIgPSBuZXcgQ29udGFjdEVkZ2UodGhpcyk7XG4gICAgICAgIHRoaXMubV9maXh0dXJlQSA9IG51bGw7XG4gICAgICAgIHRoaXMubV9maXh0dXJlQiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9pbmRleEEgPSAtMTtcbiAgICAgICAgdGhpcy5tX2luZGV4QiA9IC0xO1xuICAgICAgICB0aGlzLm1fZXZhbHVhdGVGY24gPSBudWxsO1xuICAgICAgICB0aGlzLm1fbWFuaWZvbGQgPSBuZXcgTWFuaWZvbGQoKTtcbiAgICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV90b2kgPSAxO1xuICAgICAgICB0aGlzLm1fdG9pQ291bnQgPSAwO1xuICAgICAgICB0aGlzLm1fdG9pRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fZnJpY3Rpb24gPSAwO1xuICAgICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSAwO1xuICAgICAgICB0aGlzLm1fdGFuZ2VudFNwZWVkID0gMDtcbiAgICAgICAgdGhpcy5tX2VuYWJsZWRGbGFnID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX3RvdWNoaW5nRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fZmlsdGVyRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fYnVsbGV0SGl0RmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1faW1wdWxzZSA9IG5ldyBDb250YWN0SW1wdWxzZSh0aGlzKTtcbiAgICAgICAgdGhpcy52X3BvaW50cyA9IFtuZXcgVmVsb2NpdHlDb25zdHJhaW50UG9pbnQoKSwgbmV3IFZlbG9jaXR5Q29uc3RyYWludFBvaW50KCldO1xuICAgICAgICB0aGlzLnZfbm9ybWFsID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy52X25vcm1hbE1hc3MgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgdGhpcy52X0sgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgdGhpcy52X3BvaW50Q291bnQgPSAwO1xuICAgICAgICB0aGlzLnZfdGFuZ2VudFNwZWVkID0gMDtcbiAgICAgICAgdGhpcy52X2ZyaWN0aW9uID0gMDtcbiAgICAgICAgdGhpcy52X3Jlc3RpdHV0aW9uID0gMDtcbiAgICAgICAgdGhpcy52X2ludk1hc3NBID0gMDtcbiAgICAgICAgdGhpcy52X2ludk1hc3NCID0gMDtcbiAgICAgICAgdGhpcy52X2ludklBID0gMDtcbiAgICAgICAgdGhpcy52X2ludklCID0gMDtcbiAgICAgICAgdGhpcy5wX2xvY2FsUG9pbnRzID0gW3ZlYzIoMCwgMCksIHZlYzIoMCwgMCldO1xuICAgICAgICB0aGlzLnBfbG9jYWxOb3JtYWwgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnBfbG9jYWxQb2ludCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMucF9sb2NhbENlbnRlckEgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnBfbG9jYWxDZW50ZXJCID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5wX3R5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV91bnNldDtcbiAgICAgICAgdGhpcy5wX3JhZGl1c0EgPSAwO1xuICAgICAgICB0aGlzLnBfcmFkaXVzQiA9IDA7XG4gICAgICAgIHRoaXMucF9wb2ludENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5wX2ludk1hc3NBID0gMDtcbiAgICAgICAgdGhpcy5wX2ludk1hc3NCID0gMDtcbiAgICAgICAgdGhpcy5wX2ludklBID0gMDtcbiAgICAgICAgdGhpcy5wX2ludklCID0gMDtcbiAgICAgIH1cbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24oZkEsIGluZGV4QSwgZkIsIGluZGV4QiwgZXZhbHVhdGVGY24pIHtcbiAgICAgICAgdGhpcy5tX2ZpeHR1cmVBID0gZkE7XG4gICAgICAgIHRoaXMubV9maXh0dXJlQiA9IGZCO1xuICAgICAgICB0aGlzLm1faW5kZXhBID0gaW5kZXhBO1xuICAgICAgICB0aGlzLm1faW5kZXhCID0gaW5kZXhCO1xuICAgICAgICB0aGlzLm1fZXZhbHVhdGVGY24gPSBldmFsdWF0ZUZjbjtcbiAgICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gbWl4RnJpY3Rpb24odGhpcy5tX2ZpeHR1cmVBLm1fZnJpY3Rpb24sIHRoaXMubV9maXh0dXJlQi5tX2ZyaWN0aW9uKTtcbiAgICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gbWl4UmVzdGl0dXRpb24odGhpcy5tX2ZpeHR1cmVBLm1fcmVzdGl0dXRpb24sIHRoaXMubV9maXh0dXJlQi5tX3Jlc3RpdHV0aW9uKTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fbm9kZUEucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLm1fbm9kZUIucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLm1fZml4dHVyZUEgPSBudWxsO1xuICAgICAgICB0aGlzLm1fZml4dHVyZUIgPSBudWxsO1xuICAgICAgICB0aGlzLm1faW5kZXhBID0gLTE7XG4gICAgICAgIHRoaXMubV9pbmRleEIgPSAtMTtcbiAgICAgICAgdGhpcy5tX2V2YWx1YXRlRmNuID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX21hbmlmb2xkLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV90b2kgPSAxO1xuICAgICAgICB0aGlzLm1fdG9pQ291bnQgPSAwO1xuICAgICAgICB0aGlzLm1fdG9pRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fZnJpY3Rpb24gPSAwO1xuICAgICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSAwO1xuICAgICAgICB0aGlzLm1fdGFuZ2VudFNwZWVkID0gMDtcbiAgICAgICAgdGhpcy5tX2VuYWJsZWRGbGFnID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX3RvdWNoaW5nRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fZmlsdGVyRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fYnVsbGV0SGl0RmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1faW1wdWxzZS5yZWN5Y2xlKCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EyID0gdGhpcy52X3BvaW50czsgX2kgPCBfYTIubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgdmFyIHBvaW50XzEgPSBfYTJbX2ldO1xuICAgICAgICAgIHBvaW50XzEucmVjeWNsZSgpO1xuICAgICAgICB9XG4gICAgICAgIHplcm9WZWMyKHRoaXMudl9ub3JtYWwpO1xuICAgICAgICB0aGlzLnZfbm9ybWFsTWFzcy5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMudl9LLnNldFplcm8oKTtcbiAgICAgICAgdGhpcy52X3BvaW50Q291bnQgPSAwO1xuICAgICAgICB0aGlzLnZfdGFuZ2VudFNwZWVkID0gMDtcbiAgICAgICAgdGhpcy52X2ZyaWN0aW9uID0gMDtcbiAgICAgICAgdGhpcy52X3Jlc3RpdHV0aW9uID0gMDtcbiAgICAgICAgdGhpcy52X2ludk1hc3NBID0gMDtcbiAgICAgICAgdGhpcy52X2ludk1hc3NCID0gMDtcbiAgICAgICAgdGhpcy52X2ludklBID0gMDtcbiAgICAgICAgdGhpcy52X2ludklCID0gMDtcbiAgICAgICAgZm9yICh2YXIgX2IgPSAwLCBfYyA9IHRoaXMucF9sb2NhbFBvaW50czsgX2IgPCBfYy5sZW5ndGg7IF9iKyspIHtcbiAgICAgICAgICB2YXIgcG9pbnRfMiA9IF9jW19iXTtcbiAgICAgICAgICB6ZXJvVmVjMihwb2ludF8yKTtcbiAgICAgICAgfVxuICAgICAgICB6ZXJvVmVjMih0aGlzLnBfbG9jYWxOb3JtYWwpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBfbG9jYWxQb2ludCk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMucF9sb2NhbENlbnRlckEpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBfbG9jYWxDZW50ZXJCKTtcbiAgICAgICAgdGhpcy5wX3R5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV91bnNldDtcbiAgICAgICAgdGhpcy5wX3JhZGl1c0EgPSAwO1xuICAgICAgICB0aGlzLnBfcmFkaXVzQiA9IDA7XG4gICAgICAgIHRoaXMucF9wb2ludENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5wX2ludk1hc3NBID0gMDtcbiAgICAgICAgdGhpcy5wX2ludk1hc3NCID0gMDtcbiAgICAgICAgdGhpcy5wX2ludklBID0gMDtcbiAgICAgICAgdGhpcy5wX2ludklCID0gMDtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuaW5pdENvbnN0cmFpbnQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgaWYgKGJvZHlBID09PSBudWxsIHx8IGJvZHlCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHNoYXBlQSA9IGZpeHR1cmVBLm1fc2hhcGU7XG4gICAgICAgIHZhciBzaGFwZUIgPSBmaXh0dXJlQi5tX3NoYXBlO1xuICAgICAgICBpZiAoc2hhcGVBID09PSBudWxsIHx8IHNoYXBlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBtYW5pZm9sZCA9IHRoaXMubV9tYW5pZm9sZDtcbiAgICAgICAgdmFyIHBvaW50Q291bnQgPSBtYW5pZm9sZC5wb2ludENvdW50O1xuICAgICAgICB0aGlzLnZfaW52TWFzc0EgPSBib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMudl9pbnZNYXNzQiA9IGJvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy52X2ludklBID0gYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLnZfaW52SUIgPSBib2R5Qi5tX2ludkk7XG4gICAgICAgIHRoaXMudl9mcmljdGlvbiA9IHRoaXMubV9mcmljdGlvbjtcbiAgICAgICAgdGhpcy52X3Jlc3RpdHV0aW9uID0gdGhpcy5tX3Jlc3RpdHV0aW9uO1xuICAgICAgICB0aGlzLnZfdGFuZ2VudFNwZWVkID0gdGhpcy5tX3RhbmdlbnRTcGVlZDtcbiAgICAgICAgdGhpcy52X3BvaW50Q291bnQgPSBwb2ludENvdW50O1xuICAgICAgICB0aGlzLnZfSy5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMudl9ub3JtYWxNYXNzLnNldFplcm8oKTtcbiAgICAgICAgdGhpcy5wX2ludk1hc3NBID0gYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLnBfaW52TWFzc0IgPSBib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMucF9pbnZJQSA9IGJvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5wX2ludklCID0gYm9keUIubV9pbnZJO1xuICAgICAgICBjb3B5VmVjMih0aGlzLnBfbG9jYWxDZW50ZXJBLCBib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5wX2xvY2FsQ2VudGVyQiwgYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcik7XG4gICAgICAgIHRoaXMucF9yYWRpdXNBID0gc2hhcGVBLm1fcmFkaXVzO1xuICAgICAgICB0aGlzLnBfcmFkaXVzQiA9IHNoYXBlQi5tX3JhZGl1cztcbiAgICAgICAgdGhpcy5wX3R5cGUgPSBtYW5pZm9sZC50eXBlO1xuICAgICAgICBjb3B5VmVjMih0aGlzLnBfbG9jYWxOb3JtYWwsIG1hbmlmb2xkLmxvY2FsTm9ybWFsKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5wX2xvY2FsUG9pbnQsIG1hbmlmb2xkLmxvY2FsUG9pbnQpO1xuICAgICAgICB0aGlzLnBfcG9pbnRDb3VudCA9IHBvaW50Q291bnQ7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgU2V0dGluZ3NJbnRlcm5hbC5tYXhNYW5pZm9sZFBvaW50czsgKytqKSB7XG4gICAgICAgICAgdGhpcy52X3BvaW50c1tqXS5yZWN5Y2xlKCk7XG4gICAgICAgICAgemVyb1ZlYzIodGhpcy5wX2xvY2FsUG9pbnRzW2pdKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHBvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgIHZhciBjcCA9IG1hbmlmb2xkLnBvaW50c1tqXTtcbiAgICAgICAgICB2YXIgdmNwID0gdGhpcy52X3BvaW50c1tqXTtcbiAgICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICAgIHZjcC5ub3JtYWxJbXB1bHNlID0gc3RlcC5kdFJhdGlvICogY3Aubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICAgIHZjcC50YW5nZW50SW1wdWxzZSA9IHN0ZXAuZHRSYXRpbyAqIGNwLnRhbmdlbnRJbXB1bHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb3B5VmVjMih0aGlzLnBfbG9jYWxQb2ludHNbal0sIGNwLmxvY2FsUG9pbnQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldE1hbmlmb2xkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWFuaWZvbGQ7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldFdvcmxkTWFuaWZvbGQgPSBmdW5jdGlvbih3b3JsZE1hbmlmb2xkMikge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGlmIChib2R5QSA9PT0gbnVsbCB8fCBib2R5QiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBzaGFwZUEgPSBmaXh0dXJlQS5tX3NoYXBlO1xuICAgICAgICB2YXIgc2hhcGVCID0gZml4dHVyZUIubV9zaGFwZTtcbiAgICAgICAgaWYgKHNoYXBlQSA9PT0gbnVsbCB8fCBzaGFwZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICByZXR1cm4gdGhpcy5tX21hbmlmb2xkLmdldFdvcmxkTWFuaWZvbGQod29ybGRNYW5pZm9sZDIsIGJvZHlBLmdldFRyYW5zZm9ybSgpLCBzaGFwZUEubV9yYWRpdXMsIGJvZHlCLmdldFRyYW5zZm9ybSgpLCBzaGFwZUIubV9yYWRpdXMpO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zZXRFbmFibGVkID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICB0aGlzLm1fZW5hYmxlZEZsYWcgPSAhIWZsYWc7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmlzRW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZWRGbGFnO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5pc1RvdWNoaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdG91Y2hpbmdGbGFnO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXROZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0Rml4dHVyZUEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9maXh0dXJlQTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0Rml4dHVyZUIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9maXh0dXJlQjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0Q2hpbGRJbmRleEEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9pbmRleEE7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldENoaWxkSW5kZXhCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1faW5kZXhCO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5mbGFnRm9yRmlsdGVyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV9maWx0ZXJGbGFnID0gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc2V0RnJpY3Rpb24gPSBmdW5jdGlvbihmcmljdGlvbikge1xuICAgICAgICB0aGlzLm1fZnJpY3Rpb24gPSBmcmljdGlvbjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0RnJpY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9mcmljdGlvbjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUucmVzZXRGcmljdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gbWl4RnJpY3Rpb24oZml4dHVyZUEubV9mcmljdGlvbiwgZml4dHVyZUIubV9mcmljdGlvbik7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnNldFJlc3RpdHV0aW9uID0gZnVuY3Rpb24ocmVzdGl0dXRpb24pIHtcbiAgICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gcmVzdGl0dXRpb247XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldFJlc3RpdHV0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmVzdGl0dXRpb247XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnJlc2V0UmVzdGl0dXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IG1peFJlc3RpdHV0aW9uKGZpeHR1cmVBLm1fcmVzdGl0dXRpb24sIGZpeHR1cmVCLm1fcmVzdGl0dXRpb24pO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zZXRUYW5nZW50U3BlZWQgPSBmdW5jdGlvbihzcGVlZCkge1xuICAgICAgICB0aGlzLm1fdGFuZ2VudFNwZWVkID0gc3BlZWQ7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldFRhbmdlbnRTcGVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RhbmdlbnRTcGVlZDtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZXZhbHVhdGUgPSBmdW5jdGlvbihtYW5pZm9sZCwgeGZBMiwgeGZCMikge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2V2YWx1YXRlRmNuKG1hbmlmb2xkLCB4ZkEyLCBmaXh0dXJlQSwgdGhpcy5tX2luZGV4QSwgeGZCMiwgZml4dHVyZUIsIHRoaXMubV9pbmRleEIpO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbihsaXN0ZW5lcikge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGlmIChib2R5QSA9PT0gbnVsbCB8fCBib2R5QiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBzaGFwZUEgPSBmaXh0dXJlQS5tX3NoYXBlO1xuICAgICAgICB2YXIgc2hhcGVCID0gZml4dHVyZUIubV9zaGFwZTtcbiAgICAgICAgaWYgKHNoYXBlQSA9PT0gbnVsbCB8fCBzaGFwZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fZW5hYmxlZEZsYWcgPSB0cnVlO1xuICAgICAgICB2YXIgdG91Y2hpbmcgPSBmYWxzZTtcbiAgICAgICAgdmFyIHdhc1RvdWNoaW5nID0gdGhpcy5tX3RvdWNoaW5nRmxhZztcbiAgICAgICAgdmFyIHNlbnNvckEgPSBmaXh0dXJlQS5tX2lzU2Vuc29yO1xuICAgICAgICB2YXIgc2Vuc29yQiA9IGZpeHR1cmVCLm1faXNTZW5zb3I7XG4gICAgICAgIHZhciBzZW5zb3IgPSBzZW5zb3JBIHx8IHNlbnNvckI7XG4gICAgICAgIHZhciB4ZkEyID0gYm9keUEubV94ZjtcbiAgICAgICAgdmFyIHhmQjIgPSBib2R5Qi5tX3hmO1xuICAgICAgICBpZiAoc2Vuc29yKSB7XG4gICAgICAgICAgdG91Y2hpbmcgPSB0ZXN0T3ZlcmxhcChzaGFwZUEsIHRoaXMubV9pbmRleEEsIHNoYXBlQiwgdGhpcy5tX2luZGV4QiwgeGZBMiwgeGZCMik7XG4gICAgICAgICAgdGhpcy5tX21hbmlmb2xkLnBvaW50Q291bnQgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9sZE1hbmlmb2xkLnJlY3ljbGUoKTtcbiAgICAgICAgICBvbGRNYW5pZm9sZC5zZXQodGhpcy5tX21hbmlmb2xkKTtcbiAgICAgICAgICB0aGlzLm1fbWFuaWZvbGQucmVjeWNsZSgpO1xuICAgICAgICAgIHRoaXMuZXZhbHVhdGUodGhpcy5tX21hbmlmb2xkLCB4ZkEyLCB4ZkIyKTtcbiAgICAgICAgICB0b3VjaGluZyA9IHRoaXMubV9tYW5pZm9sZC5wb2ludENvdW50ID4gMDtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9tYW5pZm9sZC5wb2ludENvdW50OyArK2kpIHtcbiAgICAgICAgICAgIHZhciBubXAgPSB0aGlzLm1fbWFuaWZvbGQucG9pbnRzW2ldO1xuICAgICAgICAgICAgbm1wLm5vcm1hbEltcHVsc2UgPSAwO1xuICAgICAgICAgICAgbm1wLnRhbmdlbnRJbXB1bHNlID0gMDtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgb2xkTWFuaWZvbGQucG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgICAgIHZhciBvbXAgPSBvbGRNYW5pZm9sZC5wb2ludHNbal07XG4gICAgICAgICAgICAgIGlmIChvbXAuaWQua2V5ID09PSBubXAuaWQua2V5KSB7XG4gICAgICAgICAgICAgICAgbm1wLm5vcm1hbEltcHVsc2UgPSBvbXAubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICAgICAgICBubXAudGFuZ2VudEltcHVsc2UgPSBvbXAudGFuZ2VudEltcHVsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRvdWNoaW5nICE9PSB3YXNUb3VjaGluZykge1xuICAgICAgICAgICAgYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgICBib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3RvdWNoaW5nRmxhZyA9IHRvdWNoaW5nO1xuICAgICAgICB2YXIgaGFzTGlzdGVuZXIgPSB0eXBlb2YgbGlzdGVuZXIgPT09IFwib2JqZWN0XCIgJiYgbGlzdGVuZXIgIT09IG51bGw7XG4gICAgICAgIGlmICghd2FzVG91Y2hpbmcgJiYgdG91Y2hpbmcgJiYgaGFzTGlzdGVuZXIpIHtcbiAgICAgICAgICBsaXN0ZW5lci5iZWdpbkNvbnRhY3QodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdhc1RvdWNoaW5nICYmICF0b3VjaGluZyAmJiBoYXNMaXN0ZW5lcikge1xuICAgICAgICAgIGxpc3RlbmVyLmVuZENvbnRhY3QodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZW5zb3IgJiYgdG91Y2hpbmcgJiYgaGFzTGlzdGVuZXIgJiYgb2xkTWFuaWZvbGQpIHtcbiAgICAgICAgICBsaXN0ZW5lci5wcmVTb2x2ZSh0aGlzLCBvbGRNYW5pZm9sZCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zb2x2ZVBvc2l0aW9uQ29uc3RyYWludChzdGVwLCBudWxsLCBudWxsKTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRUT0kgPSBmdW5jdGlvbihzdGVwLCB0b2lBLCB0b2lCKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zb2x2ZVBvc2l0aW9uQ29uc3RyYWludChzdGVwLCB0b2lBLCB0b2lCKTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuX3NvbHZlUG9zaXRpb25Db25zdHJhaW50ID0gZnVuY3Rpb24oc3RlcCwgdG9pQSwgdG9pQikge1xuICAgICAgICB2YXIgdG9pID0gdG9pQSAhPT0gbnVsbCAmJiB0b2lCICE9PSBudWxsID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICB2YXIgbWluU2VwYXJhdGlvbiA9IDA7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuIG1pblNlcGFyYXRpb247XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuIG1pblNlcGFyYXRpb247XG4gICAgICAgIHZhciBwb3NpdGlvbkEgPSBib2R5QS5jX3Bvc2l0aW9uO1xuICAgICAgICB2YXIgcG9zaXRpb25CID0gYm9keUIuY19wb3NpdGlvbjtcbiAgICAgICAgdmFyIGxvY2FsQ2VudGVyQSA9IHRoaXMucF9sb2NhbENlbnRlckE7XG4gICAgICAgIHZhciBsb2NhbENlbnRlckIgPSB0aGlzLnBfbG9jYWxDZW50ZXJCO1xuICAgICAgICB2YXIgbUEgPSAwO1xuICAgICAgICB2YXIgaUEgPSAwO1xuICAgICAgICBpZiAoIXRvaSB8fCBib2R5QSA9PT0gdG9pQSB8fCBib2R5QSA9PT0gdG9pQikge1xuICAgICAgICAgIG1BID0gdGhpcy5wX2ludk1hc3NBO1xuICAgICAgICAgIGlBID0gdGhpcy5wX2ludklBO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtQiA9IDA7XG4gICAgICAgIHZhciBpQiA9IDA7XG4gICAgICAgIGlmICghdG9pIHx8IGJvZHlCID09PSB0b2lBIHx8IGJvZHlCID09PSB0b2lCKSB7XG4gICAgICAgICAgbUIgPSB0aGlzLnBfaW52TWFzc0I7XG4gICAgICAgICAgaUIgPSB0aGlzLnBfaW52SUI7XG4gICAgICAgIH1cbiAgICAgICAgY29weVZlYzIoY0EsIHBvc2l0aW9uQS5jKTtcbiAgICAgICAgdmFyIGFBID0gcG9zaXRpb25BLmE7XG4gICAgICAgIGNvcHlWZWMyKGNCLCBwb3NpdGlvbkIuYyk7XG4gICAgICAgIHZhciBhQiA9IHBvc2l0aW9uQi5hO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMucF9wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICBnZXRUcmFuc2Zvcm0oeGZBLCBsb2NhbENlbnRlckEsIGNBLCBhQSk7XG4gICAgICAgICAgZ2V0VHJhbnNmb3JtKHhmQiwgbG9jYWxDZW50ZXJCLCBjQiwgYUIpO1xuICAgICAgICAgIHZhciBzZXBhcmF0aW9uID0gdm9pZCAwO1xuICAgICAgICAgIHN3aXRjaCAodGhpcy5wX3R5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfY2lyY2xlczoge1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSwgeGZBLCB0aGlzLnBfbG9jYWxQb2ludCk7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRCLCB4ZkIsIHRoaXMucF9sb2NhbFBvaW50c1swXSk7XG4gICAgICAgICAgICAgIHN1YlZlYzIobm9ybWFsJDIsIHBvaW50QiwgcG9pbnRBKTtcbiAgICAgICAgICAgICAgbm9ybWFsaXplVmVjMihub3JtYWwkMik7XG4gICAgICAgICAgICAgIGNvbWJpbmUyVmVjMihwb2ludCwgMC41LCBwb2ludEEsIDAuNSwgcG9pbnRCKTtcbiAgICAgICAgICAgICAgc2VwYXJhdGlvbiA9IGRvdFZlYzIocG9pbnRCLCBub3JtYWwkMikgLSBkb3RWZWMyKHBvaW50QSwgbm9ybWFsJDIpIC0gdGhpcy5wX3JhZGl1c0EgLSB0aGlzLnBfcmFkaXVzQjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBOiB7XG4gICAgICAgICAgICAgIHJvdFZlYzIobm9ybWFsJDIsIHhmQS5xLCB0aGlzLnBfbG9jYWxOb3JtYWwpO1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBsYW5lUG9pbnQkMSwgeGZBLCB0aGlzLnBfbG9jYWxQb2ludCk7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIoY2xpcFBvaW50LCB4ZkIsIHRoaXMucF9sb2NhbFBvaW50c1tqXSk7XG4gICAgICAgICAgICAgIHNlcGFyYXRpb24gPSBkb3RWZWMyKGNsaXBQb2ludCwgbm9ybWFsJDIpIC0gZG90VmVjMihwbGFuZVBvaW50JDEsIG5vcm1hbCQyKSAtIHRoaXMucF9yYWRpdXNBIC0gdGhpcy5wX3JhZGl1c0I7XG4gICAgICAgICAgICAgIGNvcHlWZWMyKHBvaW50LCBjbGlwUG9pbnQpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUI6IHtcbiAgICAgICAgICAgICAgcm90VmVjMihub3JtYWwkMiwgeGZCLnEsIHRoaXMucF9sb2NhbE5vcm1hbCk7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocGxhbmVQb2ludCQxLCB4ZkIsIHRoaXMucF9sb2NhbFBvaW50KTtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihjbGlwUG9pbnQsIHhmQSwgdGhpcy5wX2xvY2FsUG9pbnRzW2pdKTtcbiAgICAgICAgICAgICAgc2VwYXJhdGlvbiA9IGRvdFZlYzIoY2xpcFBvaW50LCBub3JtYWwkMikgLSBkb3RWZWMyKHBsYW5lUG9pbnQkMSwgbm9ybWFsJDIpIC0gdGhpcy5wX3JhZGl1c0EgLSB0aGlzLnBfcmFkaXVzQjtcbiAgICAgICAgICAgICAgY29weVZlYzIocG9pbnQsIGNsaXBQb2ludCk7XG4gICAgICAgICAgICAgIG5lZ1ZlYzIobm9ybWFsJDIpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1pblNlcGFyYXRpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHN1YlZlYzIockEsIHBvaW50LCBjQSk7XG4gICAgICAgICAgc3ViVmVjMihyQiwgcG9pbnQsIGNCKTtcbiAgICAgICAgICBtaW5TZXBhcmF0aW9uID0gbWF0aF9taW4kNChtaW5TZXBhcmF0aW9uLCBzZXBhcmF0aW9uKTtcbiAgICAgICAgICB2YXIgYmF1bWdhcnRlID0gdG9pID8gU2V0dGluZ3NJbnRlcm5hbC50b2lCYXVnYXJ0ZSA6IFNldHRpbmdzSW50ZXJuYWwuYmF1bWdhcnRlO1xuICAgICAgICAgIHZhciBsaW5lYXJTbG9wID0gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgICAgIHZhciBtYXhMaW5lYXJDb3JyZWN0aW9uID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhMaW5lYXJDb3JyZWN0aW9uO1xuICAgICAgICAgIHZhciBDID0gY2xhbXAoYmF1bWdhcnRlICogKHNlcGFyYXRpb24gKyBsaW5lYXJTbG9wKSwgLW1heExpbmVhckNvcnJlY3Rpb24sIDApO1xuICAgICAgICAgIHZhciBybkEgPSBjcm9zc1ZlYzJWZWMyKHJBLCBub3JtYWwkMik7XG4gICAgICAgICAgdmFyIHJuQiA9IGNyb3NzVmVjMlZlYzIockIsIG5vcm1hbCQyKTtcbiAgICAgICAgICB2YXIgSyA9IG1BICsgbUIgKyBpQSAqIHJuQSAqIHJuQSArIGlCICogcm5CICogcm5CO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gSyA+IDAgPyAtQyAvIEsgOiAwO1xuICAgICAgICAgIHNjYWxlVmVjMihQJDEsIGltcHVsc2UsIG5vcm1hbCQyKTtcbiAgICAgICAgICBtaW51c1NjYWxlVmVjMihjQSwgbUEsIFAkMSk7XG4gICAgICAgICAgYUEgLT0gaUEgKiBjcm9zc1ZlYzJWZWMyKHJBLCBQJDEpO1xuICAgICAgICAgIHBsdXNTY2FsZVZlYzIoY0IsIG1CLCBQJDEpO1xuICAgICAgICAgIGFCICs9IGlCICogY3Jvc3NWZWMyVmVjMihyQiwgUCQxKTtcbiAgICAgICAgfVxuICAgICAgICBjb3B5VmVjMihwb3NpdGlvbkEuYywgY0EpO1xuICAgICAgICBwb3NpdGlvbkEuYSA9IGFBO1xuICAgICAgICBjb3B5VmVjMihwb3NpdGlvbkIuYywgY0IpO1xuICAgICAgICBwb3NpdGlvbkIuYSA9IGFCO1xuICAgICAgICByZXR1cm4gbWluU2VwYXJhdGlvbjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludCA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgdmVsb2NpdHlBID0gYm9keUEuY192ZWxvY2l0eTtcbiAgICAgICAgdmFyIHZlbG9jaXR5QiA9IGJvZHlCLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciBwb3NpdGlvbkEgPSBib2R5QS5jX3Bvc2l0aW9uO1xuICAgICAgICB2YXIgcG9zaXRpb25CID0gYm9keUIuY19wb3NpdGlvbjtcbiAgICAgICAgdmFyIHJhZGl1c0EgPSB0aGlzLnBfcmFkaXVzQTtcbiAgICAgICAgdmFyIHJhZGl1c0IgPSB0aGlzLnBfcmFkaXVzQjtcbiAgICAgICAgdmFyIG1hbmlmb2xkID0gdGhpcy5tX21hbmlmb2xkO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLnZfaW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMudl9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy52X2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLnZfaW52SUI7XG4gICAgICAgIHZhciBsb2NhbENlbnRlckEgPSB0aGlzLnBfbG9jYWxDZW50ZXJBO1xuICAgICAgICB2YXIgbG9jYWxDZW50ZXJCID0gdGhpcy5wX2xvY2FsQ2VudGVyQjtcbiAgICAgICAgY29weVZlYzIoY0EsIHBvc2l0aW9uQS5jKTtcbiAgICAgICAgdmFyIGFBID0gcG9zaXRpb25BLmE7XG4gICAgICAgIGNvcHlWZWMyKHZBLCB2ZWxvY2l0eUEudik7XG4gICAgICAgIHZhciB3QSA9IHZlbG9jaXR5QS53O1xuICAgICAgICBjb3B5VmVjMihjQiwgcG9zaXRpb25CLmMpO1xuICAgICAgICB2YXIgYUIgPSBwb3NpdGlvbkIuYTtcbiAgICAgICAgY29weVZlYzIodkIsIHZlbG9jaXR5Qi52KTtcbiAgICAgICAgdmFyIHdCID0gdmVsb2NpdHlCLnc7XG4gICAgICAgIGdldFRyYW5zZm9ybSh4ZkEsIGxvY2FsQ2VudGVyQSwgY0EsIGFBKTtcbiAgICAgICAgZ2V0VHJhbnNmb3JtKHhmQiwgbG9jYWxDZW50ZXJCLCBjQiwgYUIpO1xuICAgICAgICB3b3JsZE1hbmlmb2xkLnJlY3ljbGUoKTtcbiAgICAgICAgbWFuaWZvbGQuZ2V0V29ybGRNYW5pZm9sZCh3b3JsZE1hbmlmb2xkLCB4ZkEsIHJhZGl1c0EsIHhmQiwgcmFkaXVzQik7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMudl9ub3JtYWwsIHdvcmxkTWFuaWZvbGQubm9ybWFsKTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnZfcG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgdmFyIHZjcCA9IHRoaXMudl9wb2ludHNbal07XG4gICAgICAgICAgdmFyIHdtcCA9IHdvcmxkTWFuaWZvbGQucG9pbnRzW2pdO1xuICAgICAgICAgIHN1YlZlYzIodmNwLnJBLCB3bXAsIGNBKTtcbiAgICAgICAgICBzdWJWZWMyKHZjcC5yQiwgd21wLCBjQik7XG4gICAgICAgICAgdmFyIHJuQSA9IGNyb3NzVmVjMlZlYzIodmNwLnJBLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgICB2YXIgcm5CID0gY3Jvc3NWZWMyVmVjMih2Y3AuckIsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICAgIHZhciBrTm9ybWFsID0gbUEgKyBtQiArIGlBICogcm5BICogcm5BICsgaUIgKiBybkIgKiBybkI7XG4gICAgICAgICAgdmNwLm5vcm1hbE1hc3MgPSBrTm9ybWFsID4gMCA/IDEgLyBrTm9ybWFsIDogMDtcbiAgICAgICAgICBjcm9zc1ZlYzJOdW0odGFuZ2VudCQxLCB0aGlzLnZfbm9ybWFsLCAxKTtcbiAgICAgICAgICB2YXIgcnRBID0gY3Jvc3NWZWMyVmVjMih2Y3AuckEsIHRhbmdlbnQkMSk7XG4gICAgICAgICAgdmFyIHJ0QiA9IGNyb3NzVmVjMlZlYzIodmNwLnJCLCB0YW5nZW50JDEpO1xuICAgICAgICAgIHZhciBrVGFuZ2VudCA9IG1BICsgbUIgKyBpQSAqIHJ0QSAqIHJ0QSArIGlCICogcnRCICogcnRCO1xuICAgICAgICAgIHZjcC50YW5nZW50TWFzcyA9IGtUYW5nZW50ID4gMCA/IDEgLyBrVGFuZ2VudCA6IDA7XG4gICAgICAgICAgdmNwLnZlbG9jaXR5QmlhcyA9IDA7XG4gICAgICAgICAgdmFyIHZSZWwgPSAwO1xuICAgICAgICAgIHZSZWwgKz0gZG90VmVjMih0aGlzLnZfbm9ybWFsLCB2Qik7XG4gICAgICAgICAgdlJlbCArPSBkb3RWZWMyKHRoaXMudl9ub3JtYWwsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdCLCB2Y3AuckIpKTtcbiAgICAgICAgICB2UmVsIC09IGRvdFZlYzIodGhpcy52X25vcm1hbCwgdkEpO1xuICAgICAgICAgIHZSZWwgLT0gZG90VmVjMih0aGlzLnZfbm9ybWFsLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QSwgdmNwLnJBKSk7XG4gICAgICAgICAgaWYgKHZSZWwgPCAtU2V0dGluZ3NJbnRlcm5hbC52ZWxvY2l0eVRocmVzaG9sZCkge1xuICAgICAgICAgICAgdmNwLnZlbG9jaXR5QmlhcyA9IC10aGlzLnZfcmVzdGl0dXRpb24gKiB2UmVsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52X3BvaW50Q291bnQgPT0gMiAmJiBzdGVwLmJsb2NrU29sdmUpIHtcbiAgICAgICAgICB2YXIgdmNwMSA9IHRoaXMudl9wb2ludHNbMF07XG4gICAgICAgICAgdmFyIHZjcDIgPSB0aGlzLnZfcG9pbnRzWzFdO1xuICAgICAgICAgIHZhciBybjFBID0gY3Jvc3NWZWMyVmVjMih2Y3AxLnJBLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgICB2YXIgcm4xQiA9IGNyb3NzVmVjMlZlYzIodmNwMS5yQiwgdGhpcy52X25vcm1hbCk7XG4gICAgICAgICAgdmFyIHJuMkEgPSBjcm9zc1ZlYzJWZWMyKHZjcDIuckEsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICAgIHZhciBybjJCID0gY3Jvc3NWZWMyVmVjMih2Y3AyLnJCLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgICB2YXIgazExID0gbUEgKyBtQiArIGlBICogcm4xQSAqIHJuMUEgKyBpQiAqIHJuMUIgKiBybjFCO1xuICAgICAgICAgIHZhciBrMjIgPSBtQSArIG1CICsgaUEgKiBybjJBICogcm4yQSArIGlCICogcm4yQiAqIHJuMkI7XG4gICAgICAgICAgdmFyIGsxMiA9IG1BICsgbUIgKyBpQSAqIHJuMUEgKiBybjJBICsgaUIgKiBybjFCICogcm4yQjtcbiAgICAgICAgICB2YXIga19tYXhDb25kaXRpb25OdW1iZXIgPSAxZTM7XG4gICAgICAgICAgaWYgKGsxMSAqIGsxMSA8IGtfbWF4Q29uZGl0aW9uTnVtYmVyICogKGsxMSAqIGsyMiAtIGsxMiAqIGsxMikpIHtcbiAgICAgICAgICAgIHRoaXMudl9LLmV4LnNldE51bShrMTEsIGsxMik7XG4gICAgICAgICAgICB0aGlzLnZfSy5leS5zZXROdW0oazEyLCBrMjIpO1xuICAgICAgICAgICAgdmFyIGFfMSA9IHRoaXMudl9LLmV4Lng7XG4gICAgICAgICAgICB2YXIgYl8xID0gdGhpcy52X0suZXkueDtcbiAgICAgICAgICAgIHZhciBjMiA9IHRoaXMudl9LLmV4Lnk7XG4gICAgICAgICAgICB2YXIgZF8xID0gdGhpcy52X0suZXkueTtcbiAgICAgICAgICAgIHZhciBkZXQgPSBhXzEgKiBkXzEgLSBiXzEgKiBjMjtcbiAgICAgICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICAgICAgZGV0ID0gMSAvIGRldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudl9ub3JtYWxNYXNzLmV4LnggPSBkZXQgKiBkXzE7XG4gICAgICAgICAgICB0aGlzLnZfbm9ybWFsTWFzcy5leS54ID0gLWRldCAqIGJfMTtcbiAgICAgICAgICAgIHRoaXMudl9ub3JtYWxNYXNzLmV4LnkgPSAtZGV0ICogYzI7XG4gICAgICAgICAgICB0aGlzLnZfbm9ybWFsTWFzcy5leS55ID0gZGV0ICogYV8xO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnZfcG9pbnRDb3VudCA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvcHlWZWMyKHBvc2l0aW9uQS5jLCBjQSk7XG4gICAgICAgIHBvc2l0aW9uQS5hID0gYUE7XG4gICAgICAgIGNvcHlWZWMyKHZlbG9jaXR5QS52LCB2QSk7XG4gICAgICAgIHZlbG9jaXR5QS53ID0gd0E7XG4gICAgICAgIGNvcHlWZWMyKHBvc2l0aW9uQi5jLCBjQik7XG4gICAgICAgIHBvc2l0aW9uQi5hID0gYUI7XG4gICAgICAgIGNvcHlWZWMyKHZlbG9jaXR5Qi52LCB2Qik7XG4gICAgICAgIHZlbG9jaXR5Qi53ID0gd0I7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLndhcm1TdGFydENvbnN0cmFpbnQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgaWYgKGJvZHlBID09PSBudWxsIHx8IGJvZHlCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHZlbG9jaXR5QSA9IGJvZHlBLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciB2ZWxvY2l0eUIgPSBib2R5Qi5jX3ZlbG9jaXR5O1xuICAgICAgICB2YXIgbUEgPSB0aGlzLnZfaW52TWFzc0E7XG4gICAgICAgIHZhciBpQSA9IHRoaXMudl9pbnZJQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy52X2ludk1hc3NCO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLnZfaW52SUI7XG4gICAgICAgIGNvcHlWZWMyKHZBLCB2ZWxvY2l0eUEudik7XG4gICAgICAgIHZhciB3QSA9IHZlbG9jaXR5QS53O1xuICAgICAgICBjb3B5VmVjMih2QiwgdmVsb2NpdHlCLnYpO1xuICAgICAgICB2YXIgd0IgPSB2ZWxvY2l0eUIudztcbiAgICAgICAgY29weVZlYzIobm9ybWFsJDIsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICBjcm9zc1ZlYzJOdW0odGFuZ2VudCQxLCBub3JtYWwkMiwgMSk7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy52X3BvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgIHZhciB2Y3AgPSB0aGlzLnZfcG9pbnRzW2pdO1xuICAgICAgICAgIGNvbWJpbmUyVmVjMihQJDEsIHZjcC5ub3JtYWxJbXB1bHNlLCBub3JtYWwkMiwgdmNwLnRhbmdlbnRJbXB1bHNlLCB0YW5nZW50JDEpO1xuICAgICAgICAgIHdBIC09IGlBICogY3Jvc3NWZWMyVmVjMih2Y3AuckEsIFAkMSk7XG4gICAgICAgICAgbWludXNTY2FsZVZlYzIodkEsIG1BLCBQJDEpO1xuICAgICAgICAgIHdCICs9IGlCICogY3Jvc3NWZWMyVmVjMih2Y3AuckIsIFAkMSk7XG4gICAgICAgICAgcGx1c1NjYWxlVmVjMih2QiwgbUIsIFAkMSk7XG4gICAgICAgIH1cbiAgICAgICAgY29weVZlYzIodmVsb2NpdHlBLnYsIHZBKTtcbiAgICAgICAgdmVsb2NpdHlBLncgPSB3QTtcbiAgICAgICAgY29weVZlYzIodmVsb2NpdHlCLnYsIHZCKTtcbiAgICAgICAgdmVsb2NpdHlCLncgPSB3QjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc3RvcmVDb25zdHJhaW50SW1wdWxzZXMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBtYW5pZm9sZCA9IHRoaXMubV9tYW5pZm9sZDtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnZfcG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgbWFuaWZvbGQucG9pbnRzW2pdLm5vcm1hbEltcHVsc2UgPSB0aGlzLnZfcG9pbnRzW2pdLm5vcm1hbEltcHVsc2U7XG4gICAgICAgICAgbWFuaWZvbGQucG9pbnRzW2pdLnRhbmdlbnRJbXB1bHNlID0gdGhpcy52X3BvaW50c1tqXS50YW5nZW50SW1wdWxzZTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludCA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgdmVsb2NpdHlBID0gYm9keUEuY192ZWxvY2l0eTtcbiAgICAgICAgdmFyIHZlbG9jaXR5QiA9IGJvZHlCLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMudl9pbnZNYXNzQTtcbiAgICAgICAgdmFyIGlBID0gdGhpcy52X2ludklBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLnZfaW52TWFzc0I7XG4gICAgICAgIHZhciBpQiA9IHRoaXMudl9pbnZJQjtcbiAgICAgICAgY29weVZlYzIodkEsIHZlbG9jaXR5QS52KTtcbiAgICAgICAgdmFyIHdBID0gdmVsb2NpdHlBLnc7XG4gICAgICAgIGNvcHlWZWMyKHZCLCB2ZWxvY2l0eUIudik7XG4gICAgICAgIHZhciB3QiA9IHZlbG9jaXR5Qi53O1xuICAgICAgICBjb3B5VmVjMihub3JtYWwkMiwgdGhpcy52X25vcm1hbCk7XG4gICAgICAgIGNyb3NzVmVjMk51bSh0YW5nZW50JDEsIG5vcm1hbCQyLCAxKTtcbiAgICAgICAgdmFyIGZyaWN0aW9uID0gdGhpcy52X2ZyaWN0aW9uO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMudl9wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICB2YXIgdmNwID0gdGhpcy52X3BvaW50c1tqXTtcbiAgICAgICAgICB6ZXJvVmVjMihkdik7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYsIHZCKTtcbiAgICAgICAgICBwbHVzVmVjMihkdiwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0IsIHZjcC5yQikpO1xuICAgICAgICAgIG1pbnVzVmVjMihkdiwgdkEpO1xuICAgICAgICAgIG1pbnVzVmVjMihkdiwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0EsIHZjcC5yQSkpO1xuICAgICAgICAgIHZhciB2dCA9IGRvdFZlYzIoZHYsIHRhbmdlbnQkMSkgLSB0aGlzLnZfdGFuZ2VudFNwZWVkO1xuICAgICAgICAgIHZhciBsYW1iZGEgPSB2Y3AudGFuZ2VudE1hc3MgKiAtdnQ7XG4gICAgICAgICAgdmFyIG1heEZyaWN0aW9uID0gZnJpY3Rpb24gKiB2Y3Aubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICB2YXIgbmV3SW1wdWxzZSA9IGNsYW1wKHZjcC50YW5nZW50SW1wdWxzZSArIGxhbWJkYSwgLW1heEZyaWN0aW9uLCBtYXhGcmljdGlvbik7XG4gICAgICAgICAgbGFtYmRhID0gbmV3SW1wdWxzZSAtIHZjcC50YW5nZW50SW1wdWxzZTtcbiAgICAgICAgICB2Y3AudGFuZ2VudEltcHVsc2UgPSBuZXdJbXB1bHNlO1xuICAgICAgICAgIHNjYWxlVmVjMihQJDEsIGxhbWJkYSwgdGFuZ2VudCQxKTtcbiAgICAgICAgICBtaW51c1NjYWxlVmVjMih2QSwgbUEsIFAkMSk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBjcm9zc1ZlYzJWZWMyKHZjcC5yQSwgUCQxKTtcbiAgICAgICAgICBwbHVzU2NhbGVWZWMyKHZCLCBtQiwgUCQxKTtcbiAgICAgICAgICB3QiArPSBpQiAqIGNyb3NzVmVjMlZlYzIodmNwLnJCLCBQJDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZfcG9pbnRDb3VudCA9PSAxIHx8IHN0ZXAuYmxvY2tTb2x2ZSA9PSBmYWxzZSkge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy52X3BvaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIHZjcCA9IHRoaXMudl9wb2ludHNbaV07XG4gICAgICAgICAgICB6ZXJvVmVjMihkdik7XG4gICAgICAgICAgICBwbHVzVmVjMihkdiwgdkIpO1xuICAgICAgICAgICAgcGx1c1ZlYzIoZHYsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdCLCB2Y3AuckIpKTtcbiAgICAgICAgICAgIG1pbnVzVmVjMihkdiwgdkEpO1xuICAgICAgICAgICAgbWludXNWZWMyKGR2LCBjcm9zc051bVZlYzIodGVtcCQyLCB3QSwgdmNwLnJBKSk7XG4gICAgICAgICAgICB2YXIgdm4gPSBkb3RWZWMyKGR2LCBub3JtYWwkMik7XG4gICAgICAgICAgICB2YXIgbGFtYmRhID0gLXZjcC5ub3JtYWxNYXNzICogKHZuIC0gdmNwLnZlbG9jaXR5Qmlhcyk7XG4gICAgICAgICAgICB2YXIgbmV3SW1wdWxzZSA9IG1hdGhfbWF4JDIodmNwLm5vcm1hbEltcHVsc2UgKyBsYW1iZGEsIDApO1xuICAgICAgICAgICAgbGFtYmRhID0gbmV3SW1wdWxzZSAtIHZjcC5ub3JtYWxJbXB1bHNlO1xuICAgICAgICAgICAgdmNwLm5vcm1hbEltcHVsc2UgPSBuZXdJbXB1bHNlO1xuICAgICAgICAgICAgc2NhbGVWZWMyKFAkMSwgbGFtYmRhLCBub3JtYWwkMik7XG4gICAgICAgICAgICBtaW51c1NjYWxlVmVjMih2QSwgbUEsIFAkMSk7XG4gICAgICAgICAgICB3QSAtPSBpQSAqIGNyb3NzVmVjMlZlYzIodmNwLnJBLCBQJDEpO1xuICAgICAgICAgICAgcGx1c1NjYWxlVmVjMih2QiwgbUIsIFAkMSk7XG4gICAgICAgICAgICB3QiArPSBpQiAqIGNyb3NzVmVjMlZlYzIodmNwLnJCLCBQJDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgdmNwMSA9IHRoaXMudl9wb2ludHNbMF07XG4gICAgICAgICAgdmFyIHZjcDIgPSB0aGlzLnZfcG9pbnRzWzFdO1xuICAgICAgICAgIHNldFZlYzIoYSwgdmNwMS5ub3JtYWxJbXB1bHNlLCB2Y3AyLm5vcm1hbEltcHVsc2UpO1xuICAgICAgICAgIHplcm9WZWMyKGR2MSk7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYxLCB2Qik7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYxLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QiwgdmNwMS5yQikpO1xuICAgICAgICAgIG1pbnVzVmVjMihkdjEsIHZBKTtcbiAgICAgICAgICBtaW51c1ZlYzIoZHYxLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QSwgdmNwMS5yQSkpO1xuICAgICAgICAgIHplcm9WZWMyKGR2Mik7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYyLCB2Qik7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYyLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QiwgdmNwMi5yQikpO1xuICAgICAgICAgIG1pbnVzVmVjMihkdjIsIHZBKTtcbiAgICAgICAgICBtaW51c1ZlYzIoZHYyLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QSwgdmNwMi5yQSkpO1xuICAgICAgICAgIHZhciB2bjEgPSBkb3RWZWMyKGR2MSwgbm9ybWFsJDIpO1xuICAgICAgICAgIHZhciB2bjIgPSBkb3RWZWMyKGR2Miwgbm9ybWFsJDIpO1xuICAgICAgICAgIHNldFZlYzIoYiwgdm4xIC0gdmNwMS52ZWxvY2l0eUJpYXMsIHZuMiAtIHZjcDIudmVsb2NpdHlCaWFzKTtcbiAgICAgICAgICBiLnggLT0gdGhpcy52X0suZXgueCAqIGEueCArIHRoaXMudl9LLmV5LnggKiBhLnk7XG4gICAgICAgICAgYi55IC09IHRoaXMudl9LLmV4LnkgKiBhLnggKyB0aGlzLnZfSy5leS55ICogYS55O1xuICAgICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICB6ZXJvVmVjMih4KTtcbiAgICAgICAgICAgIHgueCA9IC0odGhpcy52X25vcm1hbE1hc3MuZXgueCAqIGIueCArIHRoaXMudl9ub3JtYWxNYXNzLmV5LnggKiBiLnkpO1xuICAgICAgICAgICAgeC55ID0gLSh0aGlzLnZfbm9ybWFsTWFzcy5leC55ICogYi54ICsgdGhpcy52X25vcm1hbE1hc3MuZXkueSAqIGIueSk7XG4gICAgICAgICAgICBpZiAoeC54ID49IDAgJiYgeC55ID49IDApIHtcbiAgICAgICAgICAgICAgc3ViVmVjMihkLCB4LCBhKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKFAxLCBkLngsIG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKFAyLCBkLnksIG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZBLCAtbUEsIFAxLCAtbUEsIFAyLCAxLCB2QSk7XG4gICAgICAgICAgICAgIHdBIC09IGlBICogKGNyb3NzVmVjMlZlYzIodmNwMS5yQSwgUDEpICsgY3Jvc3NWZWMyVmVjMih2Y3AyLnJBLCBQMikpO1xuICAgICAgICAgICAgICBjb21iaW5lM1ZlYzIodkIsIG1CLCBQMSwgbUIsIFAyLCAxLCB2Qik7XG4gICAgICAgICAgICAgIHdCICs9IGlCICogKGNyb3NzVmVjMlZlYzIodmNwMS5yQiwgUDEpICsgY3Jvc3NWZWMyVmVjMih2Y3AyLnJCLCBQMikpO1xuICAgICAgICAgICAgICB2Y3AxLm5vcm1hbEltcHVsc2UgPSB4Lng7XG4gICAgICAgICAgICAgIHZjcDIubm9ybWFsSW1wdWxzZSA9IHgueTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4LnggPSAtdmNwMS5ub3JtYWxNYXNzICogYi54O1xuICAgICAgICAgICAgeC55ID0gMDtcbiAgICAgICAgICAgIHZuMSA9IDA7XG4gICAgICAgICAgICB2bjIgPSB0aGlzLnZfSy5leC55ICogeC54ICsgYi55O1xuICAgICAgICAgICAgaWYgKHgueCA+PSAwICYmIHZuMiA+PSAwKSB7XG4gICAgICAgICAgICAgIHN1YlZlYzIoZCwgeCwgYSk7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMSwgZC54LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMiwgZC55LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QSwgLW1BLCBQMSwgLW1BLCBQMiwgMSwgdkEpO1xuICAgICAgICAgICAgICB3QSAtPSBpQSAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckEsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQSwgUDIpKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZCLCBtQiwgUDEsIG1CLCBQMiwgMSwgdkIpO1xuICAgICAgICAgICAgICB3QiArPSBpQiAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckIsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQiwgUDIpKTtcbiAgICAgICAgICAgICAgdmNwMS5ub3JtYWxJbXB1bHNlID0geC54O1xuICAgICAgICAgICAgICB2Y3AyLm5vcm1hbEltcHVsc2UgPSB4Lnk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeC54ID0gMDtcbiAgICAgICAgICAgIHgueSA9IC12Y3AyLm5vcm1hbE1hc3MgKiBiLnk7XG4gICAgICAgICAgICB2bjEgPSB0aGlzLnZfSy5leS54ICogeC55ICsgYi54O1xuICAgICAgICAgICAgdm4yID0gMDtcbiAgICAgICAgICAgIGlmICh4LnkgPj0gMCAmJiB2bjEgPj0gMCkge1xuICAgICAgICAgICAgICBzdWJWZWMyKGQsIHgsIGEpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIoUDEsIGQueCwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIoUDIsIGQueSwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgICBjb21iaW5lM1ZlYzIodkEsIC1tQSwgUDEsIC1tQSwgUDIsIDEsIHZBKTtcbiAgICAgICAgICAgICAgd0EgLT0gaUEgKiAoY3Jvc3NWZWMyVmVjMih2Y3AxLnJBLCBQMSkgKyBjcm9zc1ZlYzJWZWMyKHZjcDIuckEsIFAyKSk7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QiwgbUIsIFAxLCBtQiwgUDIsIDEsIHZCKTtcbiAgICAgICAgICAgICAgd0IgKz0gaUIgKiAoY3Jvc3NWZWMyVmVjMih2Y3AxLnJCLCBQMSkgKyBjcm9zc1ZlYzJWZWMyKHZjcDIuckIsIFAyKSk7XG4gICAgICAgICAgICAgIHZjcDEubm9ybWFsSW1wdWxzZSA9IHgueDtcbiAgICAgICAgICAgICAgdmNwMi5ub3JtYWxJbXB1bHNlID0geC55O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHgueCA9IDA7XG4gICAgICAgICAgICB4LnkgPSAwO1xuICAgICAgICAgICAgdm4xID0gYi54O1xuICAgICAgICAgICAgdm4yID0gYi55O1xuICAgICAgICAgICAgaWYgKHZuMSA+PSAwICYmIHZuMiA+PSAwKSB7XG4gICAgICAgICAgICAgIHN1YlZlYzIoZCwgeCwgYSk7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMSwgZC54LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMiwgZC55LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QSwgLW1BLCBQMSwgLW1BLCBQMiwgMSwgdkEpO1xuICAgICAgICAgICAgICB3QSAtPSBpQSAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckEsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQSwgUDIpKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZCLCBtQiwgUDEsIG1CLCBQMiwgMSwgdkIpO1xuICAgICAgICAgICAgICB3QiArPSBpQiAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckIsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQiwgUDIpKTtcbiAgICAgICAgICAgICAgdmNwMS5ub3JtYWxJbXB1bHNlID0geC54O1xuICAgICAgICAgICAgICB2Y3AyLm5vcm1hbEltcHVsc2UgPSB4Lnk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvcHlWZWMyKHZlbG9jaXR5QS52LCB2QSk7XG4gICAgICAgIHZlbG9jaXR5QS53ID0gd0E7XG4gICAgICAgIGNvcHlWZWMyKHZlbG9jaXR5Qi52LCB2Qik7XG4gICAgICAgIHZlbG9jaXR5Qi53ID0gd0I7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIuYWRkVHlwZSA9IGZ1bmN0aW9uKHR5cGUxLCB0eXBlMiwgY2FsbGJhY2spIHtcbiAgICAgICAgc19yZWdpc3RlcnNbdHlwZTFdID0gc19yZWdpc3RlcnNbdHlwZTFdIHx8IHt9O1xuICAgICAgICBzX3JlZ2lzdGVyc1t0eXBlMV1bdHlwZTJdID0gY2FsbGJhY2s7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIuY3JlYXRlID0gZnVuY3Rpb24oZml4dHVyZUEsIGluZGV4QSwgZml4dHVyZUIsIGluZGV4Qikge1xuICAgICAgICB2YXIgdHlwZUEgPSBmaXh0dXJlQS5tX3NoYXBlLm1fdHlwZTtcbiAgICAgICAgdmFyIHR5cGVCID0gZml4dHVyZUIubV9zaGFwZS5tX3R5cGU7XG4gICAgICAgIHZhciBjb250YWN0ID0gY29udGFjdFBvb2wuYWxsb2NhdGUoKTtcbiAgICAgICAgdmFyIGV2YWx1YXRlRmNuO1xuICAgICAgICBpZiAoZXZhbHVhdGVGY24gPSBzX3JlZ2lzdGVyc1t0eXBlQV0gJiYgc19yZWdpc3RlcnNbdHlwZUFdW3R5cGVCXSkge1xuICAgICAgICAgIGNvbnRhY3QuaW5pdGlhbGl6ZShmaXh0dXJlQSwgaW5kZXhBLCBmaXh0dXJlQiwgaW5kZXhCLCBldmFsdWF0ZUZjbik7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZhbHVhdGVGY24gPSBzX3JlZ2lzdGVyc1t0eXBlQl0gJiYgc19yZWdpc3RlcnNbdHlwZUJdW3R5cGVBXSkge1xuICAgICAgICAgIGNvbnRhY3QuaW5pdGlhbGl6ZShmaXh0dXJlQiwgaW5kZXhCLCBmaXh0dXJlQSwgaW5kZXhBLCBldmFsdWF0ZUZjbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZml4dHVyZUEgPSBjb250YWN0Lm1fZml4dHVyZUE7XG4gICAgICAgIGZpeHR1cmVCID0gY29udGFjdC5tX2ZpeHR1cmVCO1xuICAgICAgICBpbmRleEEgPSBjb250YWN0LmdldENoaWxkSW5kZXhBKCk7XG4gICAgICAgIGluZGV4QiA9IGNvbnRhY3QuZ2V0Q2hpbGRJbmRleEIoKTtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQS5jb250YWN0ID0gY29udGFjdDtcbiAgICAgICAgY29udGFjdC5tX25vZGVBLm90aGVyID0gYm9keUI7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQS5wcmV2ID0gbnVsbDtcbiAgICAgICAgY29udGFjdC5tX25vZGVBLm5leHQgPSBib2R5QS5tX2NvbnRhY3RMaXN0O1xuICAgICAgICBpZiAoYm9keUEubV9jb250YWN0TGlzdCAhPSBudWxsKSB7XG4gICAgICAgICAgYm9keUEubV9jb250YWN0TGlzdC5wcmV2ID0gY29udGFjdC5tX25vZGVBO1xuICAgICAgICB9XG4gICAgICAgIGJvZHlBLm1fY29udGFjdExpc3QgPSBjb250YWN0Lm1fbm9kZUE7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQi5jb250YWN0ID0gY29udGFjdDtcbiAgICAgICAgY29udGFjdC5tX25vZGVCLm90aGVyID0gYm9keUE7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQi5wcmV2ID0gbnVsbDtcbiAgICAgICAgY29udGFjdC5tX25vZGVCLm5leHQgPSBib2R5Qi5tX2NvbnRhY3RMaXN0O1xuICAgICAgICBpZiAoYm9keUIubV9jb250YWN0TGlzdCAhPSBudWxsKSB7XG4gICAgICAgICAgYm9keUIubV9jb250YWN0TGlzdC5wcmV2ID0gY29udGFjdC5tX25vZGVCO1xuICAgICAgICB9XG4gICAgICAgIGJvZHlCLm1fY29udGFjdExpc3QgPSBjb250YWN0Lm1fbm9kZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQS5pc1NlbnNvcigpID09IGZhbHNlICYmIGZpeHR1cmVCLmlzU2Vuc29yKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICBib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICBib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGFjdDtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5kZXN0cm95ID0gZnVuY3Rpb24oY29udGFjdCwgbGlzdGVuZXIpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gY29udGFjdC5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSBjb250YWN0Lm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoY29udGFjdC5pc1RvdWNoaW5nKCkpIHtcbiAgICAgICAgICBsaXN0ZW5lci5lbmRDb250YWN0KGNvbnRhY3QpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbm9kZUEucHJldikge1xuICAgICAgICAgIGNvbnRhY3QubV9ub2RlQS5wcmV2Lm5leHQgPSBjb250YWN0Lm1fbm9kZUEubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdC5tX25vZGVBLm5leHQpIHtcbiAgICAgICAgICBjb250YWN0Lm1fbm9kZUEubmV4dC5wcmV2ID0gY29udGFjdC5tX25vZGVBLnByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9ub2RlQSA9PSBib2R5QS5tX2NvbnRhY3RMaXN0KSB7XG4gICAgICAgICAgYm9keUEubV9jb250YWN0TGlzdCA9IGNvbnRhY3QubV9ub2RlQS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbm9kZUIucHJldikge1xuICAgICAgICAgIGNvbnRhY3QubV9ub2RlQi5wcmV2Lm5leHQgPSBjb250YWN0Lm1fbm9kZUIubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdC5tX25vZGVCLm5leHQpIHtcbiAgICAgICAgICBjb250YWN0Lm1fbm9kZUIubmV4dC5wcmV2ID0gY29udGFjdC5tX25vZGVCLnByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9ub2RlQiA9PSBib2R5Qi5tX2NvbnRhY3RMaXN0KSB7XG4gICAgICAgICAgYm9keUIubV9jb250YWN0TGlzdCA9IGNvbnRhY3QubV9ub2RlQi5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbWFuaWZvbGQucG9pbnRDb3VudCA+IDAgJiYgIWZpeHR1cmVBLm1faXNTZW5zb3IgJiYgIWZpeHR1cmVCLm1faXNTZW5zb3IpIHtcbiAgICAgICAgICBib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICBib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBjb250YWN0UG9vbC5yZWxlYXNlKGNvbnRhY3QpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBDb250YWN0MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIERFRkFVTFRTJGIgPSB7XG4gICAgZ3Jhdml0eTogVmVjMi56ZXJvKCksXG4gICAgYWxsb3dTbGVlcDogdHJ1ZSxcbiAgICB3YXJtU3RhcnRpbmc6IHRydWUsXG4gICAgY29udGludW91c1BoeXNpY3M6IHRydWUsXG4gICAgc3ViU3RlcHBpbmc6IGZhbHNlLFxuICAgIGJsb2NrU29sdmU6IHRydWUsXG4gICAgdmVsb2NpdHlJdGVyYXRpb25zOiA4LFxuICAgIHBvc2l0aW9uSXRlcmF0aW9uczogM1xuICB9O1xuICB2YXIgV29ybGQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gV29ybGQyKGRlZikge1xuICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgV29ybGQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgV29ybGQyKGRlZik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zX3N0ZXAgPSBuZXcgVGltZVN0ZXAoKTtcbiAgICAgICAgaWYgKCFkZWYpIHtcbiAgICAgICAgICBkZWYgPSB7fTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmKSkge1xuICAgICAgICAgIGRlZiA9IHsgZ3Jhdml0eTogZGVmIH07XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJGIpO1xuICAgICAgICB0aGlzLm1fc29sdmVyID0gbmV3IFNvbHZlcih0aGlzKTtcbiAgICAgICAgdGhpcy5tX2Jyb2FkUGhhc2UgPSBuZXcgQnJvYWRQaGFzZSgpO1xuICAgICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBudWxsO1xuICAgICAgICB0aGlzLm1fY29udGFjdENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5tX2JvZHlMaXN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2JvZHlDb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV9qb2ludExpc3QgPSBudWxsO1xuICAgICAgICB0aGlzLm1fam9pbnRDb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV9zdGVwQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICB0aGlzLm1fYWxsb3dTbGVlcCA9IGRlZi5hbGxvd1NsZWVwO1xuICAgICAgICB0aGlzLm1fZ3Jhdml0eSA9IFZlYzIuY2xvbmUoZGVmLmdyYXZpdHkpO1xuICAgICAgICB0aGlzLm1fY2xlYXJGb3JjZXMgPSB0cnVlO1xuICAgICAgICB0aGlzLm1fbmV3Rml4dHVyZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV93YXJtU3RhcnRpbmcgPSBkZWYud2FybVN0YXJ0aW5nO1xuICAgICAgICB0aGlzLm1fY29udGludW91c1BoeXNpY3MgPSBkZWYuY29udGludW91c1BoeXNpY3M7XG4gICAgICAgIHRoaXMubV9zdWJTdGVwcGluZyA9IGRlZi5zdWJTdGVwcGluZztcbiAgICAgICAgdGhpcy5tX2Jsb2NrU29sdmUgPSBkZWYuYmxvY2tTb2x2ZTtcbiAgICAgICAgdGhpcy5tX3ZlbG9jaXR5SXRlcmF0aW9ucyA9IGRlZi52ZWxvY2l0eUl0ZXJhdGlvbnM7XG4gICAgICAgIHRoaXMubV9wb3NpdGlvbkl0ZXJhdGlvbnMgPSBkZWYucG9zaXRpb25JdGVyYXRpb25zO1xuICAgICAgICB0aGlzLm1fdCA9IDA7XG4gICAgICAgIHRoaXMubV9zdGVwX2NhbGxiYWNrID0gW107XG4gICAgICB9XG4gICAgICBXb3JsZDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGJvZGllcyA9IFtdO1xuICAgICAgICB2YXIgam9pbnRzID0gW107XG4gICAgICAgIGZvciAodmFyIGIyID0gdGhpcy5nZXRCb2R5TGlzdCgpOyBiMjsgYjIgPSBiMi5nZXROZXh0KCkpIHtcbiAgICAgICAgICBib2RpZXMucHVzaChiMik7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaiA9IHRoaXMuZ2V0Sm9pbnRMaXN0KCk7IGo7IGogPSBqLmdldE5leHQoKSkge1xuICAgICAgICAgIGlmICh0eXBlb2Ygai5fc2VyaWFsaXplID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGpvaW50cy5wdXNoKGopO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGdyYXZpdHk6IHRoaXMubV9ncmF2aXR5LFxuICAgICAgICAgIGJvZGllcyxcbiAgICAgICAgICBqb2ludHNcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgY29udGV4dCwgcmVzdG9yZSkge1xuICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFdvcmxkMigpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB3b3JsZCA9IG5ldyBXb3JsZDIoZGF0YS5ncmF2aXR5KTtcbiAgICAgICAgaWYgKGRhdGEuYm9kaWVzKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IGRhdGEuYm9kaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaSAtPSAxKSB7XG4gICAgICAgICAgICB3b3JsZC5fYWRkQm9keShyZXN0b3JlKEJvZHksIGRhdGEuYm9kaWVzW2ldLCB3b3JsZCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZGF0YS5qb2ludHMpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gZGF0YS5qb2ludHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHdvcmxkLmNyZWF0ZUpvaW50KHJlc3RvcmUoSm9pbnQsIGRhdGEuam9pbnRzW2ldLCB3b3JsZCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gd29ybGQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRCb2R5TGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlMaXN0O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0Sm9pbnRMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fam9pbnRMaXN0O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0Q29udGFjdExpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldEJvZHlDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlDb3VudDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldEpvaW50Q291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9qb2ludENvdW50O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0Q29udGFjdENvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY29udGFjdENvdW50O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuc2V0R3Jhdml0eSA9IGZ1bmN0aW9uKGdyYXZpdHkpIHtcbiAgICAgICAgdGhpcy5tX2dyYXZpdHkuc2V0KGdyYXZpdHkpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0R3Jhdml0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2dyYXZpdHk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5pc0xvY2tlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2tlZDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnNldEFsbG93U2xlZXBpbmcgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnID09IHRoaXMubV9hbGxvd1NsZWVwKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9hbGxvd1NsZWVwID0gZmxhZztcbiAgICAgICAgaWYgKHRoaXMubV9hbGxvd1NsZWVwID09IGZhbHNlKSB7XG4gICAgICAgICAgZm9yICh2YXIgYjIgPSB0aGlzLm1fYm9keUxpc3Q7IGIyOyBiMiA9IGIyLm1fbmV4dCkge1xuICAgICAgICAgICAgYjIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRBbGxvd1NsZWVwaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYWxsb3dTbGVlcDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnNldFdhcm1TdGFydGluZyA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX3dhcm1TdGFydGluZyA9IGZsYWc7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRXYXJtU3RhcnRpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV93YXJtU3RhcnRpbmc7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zZXRDb250aW51b3VzUGh5c2ljcyA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX2NvbnRpbnVvdXNQaHlzaWNzID0gZmxhZztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldENvbnRpbnVvdXNQaHlzaWNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY29udGludW91c1BoeXNpY3M7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zZXRTdWJTdGVwcGluZyA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX3N1YlN0ZXBwaW5nID0gZmxhZztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldFN1YlN0ZXBwaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc3ViU3RlcHBpbmc7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zZXRBdXRvQ2xlYXJGb3JjZXMgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIHRoaXMubV9jbGVhckZvcmNlcyA9IGZsYWc7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRBdXRvQ2xlYXJGb3JjZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jbGVhckZvcmNlcztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmNsZWFyRm9yY2VzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZvciAodmFyIGJvZHkgPSB0aGlzLm1fYm9keUxpc3Q7IGJvZHk7IGJvZHkgPSBib2R5LmdldE5leHQoKSkge1xuICAgICAgICAgIGJvZHkubV9mb3JjZS5zZXRaZXJvKCk7XG4gICAgICAgICAgYm9keS5tX3RvcnF1ZSA9IDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnF1ZXJ5QUFCQiA9IGZ1bmN0aW9uKGFhYmIsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX2Jyb2FkUGhhc2U7XG4gICAgICAgIHRoaXMubV9icm9hZFBoYXNlLnF1ZXJ5KGFhYmIsIGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgICB2YXIgcHJveHkgPSBicm9hZFBoYXNlLmdldFVzZXJEYXRhKHByb3h5SWQpO1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjayhwcm94eS5maXh0dXJlKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ocG9pbnQxLCBwb2ludDIsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX2Jyb2FkUGhhc2U7XG4gICAgICAgIHRoaXMubV9icm9hZFBoYXNlLnJheUNhc3Qoe1xuICAgICAgICAgIG1heEZyYWN0aW9uOiAxLFxuICAgICAgICAgIHAxOiBwb2ludDEsXG4gICAgICAgICAgcDI6IHBvaW50MlxuICAgICAgICB9LCBmdW5jdGlvbihpbnB1dDIsIHByb3h5SWQpIHtcbiAgICAgICAgICB2YXIgcHJveHkgPSBicm9hZFBoYXNlLmdldFVzZXJEYXRhKHByb3h5SWQpO1xuICAgICAgICAgIHZhciBmaXh0dXJlID0gcHJveHkuZml4dHVyZTtcbiAgICAgICAgICB2YXIgaW5kZXggPSBwcm94eS5jaGlsZEluZGV4O1xuICAgICAgICAgIHZhciBvdXRwdXQyID0ge307XG4gICAgICAgICAgdmFyIGhpdCA9IGZpeHR1cmUucmF5Q2FzdChvdXRwdXQyLCBpbnB1dDIsIGluZGV4KTtcbiAgICAgICAgICBpZiAoaGl0KSB7XG4gICAgICAgICAgICB2YXIgZnJhY3Rpb24gPSBvdXRwdXQyLmZyYWN0aW9uO1xuICAgICAgICAgICAgdmFyIHBvaW50MyA9IFZlYzIuYWRkKFZlYzIubXVsTnVtVmVjMigxIC0gZnJhY3Rpb24sIGlucHV0Mi5wMSksIFZlYzIubXVsTnVtVmVjMihmcmFjdGlvbiwgaW5wdXQyLnAyKSk7XG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZml4dHVyZSwgcG9pbnQzLCBvdXRwdXQyLm5vcm1hbCwgZnJhY3Rpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gaW5wdXQyLm1heEZyYWN0aW9uO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldFByb3h5Q291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9icm9hZFBoYXNlLmdldFByb3h5Q291bnQoKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldFRyZWVIZWlnaHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9icm9hZFBoYXNlLmdldFRyZWVIZWlnaHQoKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldFRyZWVCYWxhbmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYnJvYWRQaGFzZS5nZXRUcmVlQmFsYW5jZSgpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0VHJlZVF1YWxpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9icm9hZFBoYXNlLmdldFRyZWVRdWFsaXR5KCk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zaGlmdE9yaWdpbiA9IGZ1bmN0aW9uKG5ld09yaWdpbikge1xuICAgICAgICBpZiAodGhpcy5pc0xvY2tlZCgpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGIyID0gdGhpcy5tX2JvZHlMaXN0OyBiMjsgYjIgPSBiMi5tX25leHQpIHtcbiAgICAgICAgICBiMi5tX3hmLnAuc3ViKG5ld09yaWdpbik7XG4gICAgICAgICAgYjIubV9zd2VlcC5jMC5zdWIobmV3T3JpZ2luKTtcbiAgICAgICAgICBiMi5tX3N3ZWVwLmMuc3ViKG5ld09yaWdpbik7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaiA9IHRoaXMubV9qb2ludExpc3Q7IGo7IGogPSBqLm1fbmV4dCkge1xuICAgICAgICAgIGouc2hpZnRPcmlnaW4obmV3T3JpZ2luKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYnJvYWRQaGFzZS5zaGlmdE9yaWdpbihuZXdPcmlnaW4pO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuX2FkZEJvZHkgPSBmdW5jdGlvbihib2R5KSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgYm9keS5tX3ByZXYgPSBudWxsO1xuICAgICAgICBib2R5Lm1fbmV4dCA9IHRoaXMubV9ib2R5TGlzdDtcbiAgICAgICAgaWYgKHRoaXMubV9ib2R5TGlzdCkge1xuICAgICAgICAgIHRoaXMubV9ib2R5TGlzdC5tX3ByZXYgPSBib2R5O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5TGlzdCA9IGJvZHk7XG4gICAgICAgICsrdGhpcy5tX2JvZHlDb3VudDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmNyZWF0ZUJvZHkgPSBmdW5jdGlvbihhcmcxLCBhcmcyKSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGVmID0ge307XG4gICAgICAgIGlmICghYXJnMSkgO1xuICAgICAgICBlbHNlIGlmIChWZWMyLmlzVmFsaWQoYXJnMSkpIHtcbiAgICAgICAgICBkZWYgPSB7IHBvc2l0aW9uOiBhcmcxLCBhbmdsZTogYXJnMiB9O1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhcmcxID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgZGVmID0gYXJnMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYm9keSA9IG5ldyBCb2R5KHRoaXMsIGRlZik7XG4gICAgICAgIHRoaXMuX2FkZEJvZHkoYm9keSk7XG4gICAgICAgIHJldHVybiBib2R5O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuY3JlYXRlRHluYW1pY0JvZHkgPSBmdW5jdGlvbihhcmcxLCBhcmcyKSB7XG4gICAgICAgIHZhciBkZWYgPSB7fTtcbiAgICAgICAgaWYgKCFhcmcxKSA7XG4gICAgICAgIGVsc2UgaWYgKFZlYzIuaXNWYWxpZChhcmcxKSkge1xuICAgICAgICAgIGRlZiA9IHsgcG9zaXRpb246IGFyZzEsIGFuZ2xlOiBhcmcyIH07XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZzEgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICBkZWYgPSBhcmcxO1xuICAgICAgICB9XG4gICAgICAgIGRlZi50eXBlID0gXCJkeW5hbWljXCI7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUJvZHkoZGVmKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmNyZWF0ZUtpbmVtYXRpY0JvZHkgPSBmdW5jdGlvbihhcmcxLCBhcmcyKSB7XG4gICAgICAgIHZhciBkZWYgPSB7fTtcbiAgICAgICAgaWYgKCFhcmcxKSA7XG4gICAgICAgIGVsc2UgaWYgKFZlYzIuaXNWYWxpZChhcmcxKSkge1xuICAgICAgICAgIGRlZiA9IHsgcG9zaXRpb246IGFyZzEsIGFuZ2xlOiBhcmcyIH07XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZzEgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICBkZWYgPSBhcmcxO1xuICAgICAgICB9XG4gICAgICAgIGRlZi50eXBlID0gXCJraW5lbWF0aWNcIjtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQm9keShkZWYpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZGVzdHJveUJvZHkgPSBmdW5jdGlvbihiMikge1xuICAgICAgICBpZiAodGhpcy5pc0xvY2tlZCgpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiMi5tX2Rlc3Ryb3llZCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgamUgPSBiMi5tX2pvaW50TGlzdDtcbiAgICAgICAgd2hpbGUgKGplKSB7XG4gICAgICAgICAgdmFyIGplMCA9IGplO1xuICAgICAgICAgIGplID0gamUubmV4dDtcbiAgICAgICAgICB0aGlzLnB1Ymxpc2goXCJyZW1vdmUtam9pbnRcIiwgamUwLmpvaW50KTtcbiAgICAgICAgICB0aGlzLmRlc3Ryb3lKb2ludChqZTAuam9pbnQpO1xuICAgICAgICAgIGIyLm1fam9pbnRMaXN0ID0gamU7XG4gICAgICAgIH1cbiAgICAgICAgYjIubV9qb2ludExpc3QgPSBudWxsO1xuICAgICAgICB2YXIgY2UgPSBiMi5tX2NvbnRhY3RMaXN0O1xuICAgICAgICB3aGlsZSAoY2UpIHtcbiAgICAgICAgICB2YXIgY2UwID0gY2U7XG4gICAgICAgICAgY2UgPSBjZS5uZXh0O1xuICAgICAgICAgIHRoaXMuZGVzdHJveUNvbnRhY3QoY2UwLmNvbnRhY3QpO1xuICAgICAgICAgIGIyLm1fY29udGFjdExpc3QgPSBjZTtcbiAgICAgICAgfVxuICAgICAgICBiMi5tX2NvbnRhY3RMaXN0ID0gbnVsbDtcbiAgICAgICAgdmFyIGYgPSBiMi5tX2ZpeHR1cmVMaXN0O1xuICAgICAgICB3aGlsZSAoZikge1xuICAgICAgICAgIHZhciBmMCA9IGY7XG4gICAgICAgICAgZiA9IGYubV9uZXh0O1xuICAgICAgICAgIHRoaXMucHVibGlzaChcInJlbW92ZS1maXh0dXJlXCIsIGYwKTtcbiAgICAgICAgICBmMC5kZXN0cm95UHJveGllcyh0aGlzLm1fYnJvYWRQaGFzZSk7XG4gICAgICAgICAgYjIubV9maXh0dXJlTGlzdCA9IGY7XG4gICAgICAgIH1cbiAgICAgICAgYjIubV9maXh0dXJlTGlzdCA9IG51bGw7XG4gICAgICAgIGlmIChiMi5tX3ByZXYpIHtcbiAgICAgICAgICBiMi5tX3ByZXYubV9uZXh0ID0gYjIubV9uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChiMi5tX25leHQpIHtcbiAgICAgICAgICBiMi5tX25leHQubV9wcmV2ID0gYjIubV9wcmV2O1xuICAgICAgICB9XG4gICAgICAgIGlmIChiMiA9PSB0aGlzLm1fYm9keUxpc3QpIHtcbiAgICAgICAgICB0aGlzLm1fYm9keUxpc3QgPSBiMi5tX25leHQ7XG4gICAgICAgIH1cbiAgICAgICAgYjIubV9kZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgICAtLXRoaXMubV9ib2R5Q291bnQ7XG4gICAgICAgIHRoaXMucHVibGlzaChcInJlbW92ZS1ib2R5XCIsIGIyKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5jcmVhdGVKb2ludCA9IGZ1bmN0aW9uKGpvaW50KSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBqb2ludC5tX3ByZXYgPSBudWxsO1xuICAgICAgICBqb2ludC5tX25leHQgPSB0aGlzLm1fam9pbnRMaXN0O1xuICAgICAgICBpZiAodGhpcy5tX2pvaW50TGlzdCkge1xuICAgICAgICAgIHRoaXMubV9qb2ludExpc3QubV9wcmV2ID0gam9pbnQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2pvaW50TGlzdCA9IGpvaW50O1xuICAgICAgICArK3RoaXMubV9qb2ludENvdW50O1xuICAgICAgICBqb2ludC5tX2VkZ2VBLmpvaW50ID0gam9pbnQ7XG4gICAgICAgIGpvaW50Lm1fZWRnZUEub3RoZXIgPSBqb2ludC5tX2JvZHlCO1xuICAgICAgICBqb2ludC5tX2VkZ2VBLnByZXYgPSBudWxsO1xuICAgICAgICBqb2ludC5tX2VkZ2VBLm5leHQgPSBqb2ludC5tX2JvZHlBLm1fam9pbnRMaXN0O1xuICAgICAgICBpZiAoam9pbnQubV9ib2R5QS5tX2pvaW50TGlzdClcbiAgICAgICAgICBqb2ludC5tX2JvZHlBLm1fam9pbnRMaXN0LnByZXYgPSBqb2ludC5tX2VkZ2VBO1xuICAgICAgICBqb2ludC5tX2JvZHlBLm1fam9pbnRMaXN0ID0gam9pbnQubV9lZGdlQTtcbiAgICAgICAgam9pbnQubV9lZGdlQi5qb2ludCA9IGpvaW50O1xuICAgICAgICBqb2ludC5tX2VkZ2VCLm90aGVyID0gam9pbnQubV9ib2R5QTtcbiAgICAgICAgam9pbnQubV9lZGdlQi5wcmV2ID0gbnVsbDtcbiAgICAgICAgam9pbnQubV9lZGdlQi5uZXh0ID0gam9pbnQubV9ib2R5Qi5tX2pvaW50TGlzdDtcbiAgICAgICAgaWYgKGpvaW50Lm1fYm9keUIubV9qb2ludExpc3QpXG4gICAgICAgICAgam9pbnQubV9ib2R5Qi5tX2pvaW50TGlzdC5wcmV2ID0gam9pbnQubV9lZGdlQjtcbiAgICAgICAgam9pbnQubV9ib2R5Qi5tX2pvaW50TGlzdCA9IGpvaW50Lm1fZWRnZUI7XG4gICAgICAgIGlmIChqb2ludC5tX2NvbGxpZGVDb25uZWN0ZWQgPT0gZmFsc2UpIHtcbiAgICAgICAgICBmb3IgKHZhciBlZGdlID0gam9pbnQubV9ib2R5Qi5nZXRDb250YWN0TGlzdCgpOyBlZGdlOyBlZGdlID0gZWRnZS5uZXh0KSB7XG4gICAgICAgICAgICBpZiAoZWRnZS5vdGhlciA9PSBqb2ludC5tX2JvZHlBKSB7XG4gICAgICAgICAgICAgIGVkZ2UuY29udGFjdC5mbGFnRm9yRmlsdGVyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmRlc3Ryb3lKb2ludCA9IGZ1bmN0aW9uKGpvaW50KSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50Lm1fcHJldikge1xuICAgICAgICAgIGpvaW50Lm1fcHJldi5tX25leHQgPSBqb2ludC5tX25leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50Lm1fbmV4dCkge1xuICAgICAgICAgIGpvaW50Lm1fbmV4dC5tX3ByZXYgPSBqb2ludC5tX3ByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50ID09IHRoaXMubV9qb2ludExpc3QpIHtcbiAgICAgICAgICB0aGlzLm1fam9pbnRMaXN0ID0gam9pbnQubV9uZXh0O1xuICAgICAgICB9XG4gICAgICAgIHZhciBib2R5QSA9IGpvaW50Lm1fYm9keUE7XG4gICAgICAgIHZhciBib2R5QiA9IGpvaW50Lm1fYm9keUI7XG4gICAgICAgIGJvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICBib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgaWYgKGpvaW50Lm1fZWRnZUEucHJldikge1xuICAgICAgICAgIGpvaW50Lm1fZWRnZUEucHJldi5uZXh0ID0gam9pbnQubV9lZGdlQS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChqb2ludC5tX2VkZ2VBLm5leHQpIHtcbiAgICAgICAgICBqb2ludC5tX2VkZ2VBLm5leHQucHJldiA9IGpvaW50Lm1fZWRnZUEucHJldjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbnQubV9lZGdlQSA9PSBib2R5QS5tX2pvaW50TGlzdCkge1xuICAgICAgICAgIGJvZHlBLm1fam9pbnRMaXN0ID0gam9pbnQubV9lZGdlQS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGpvaW50Lm1fZWRnZUEucHJldiA9IG51bGw7XG4gICAgICAgIGpvaW50Lm1fZWRnZUEubmV4dCA9IG51bGw7XG4gICAgICAgIGlmIChqb2ludC5tX2VkZ2VCLnByZXYpIHtcbiAgICAgICAgICBqb2ludC5tX2VkZ2VCLnByZXYubmV4dCA9IGpvaW50Lm1fZWRnZUIubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbnQubV9lZGdlQi5uZXh0KSB7XG4gICAgICAgICAgam9pbnQubV9lZGdlQi5uZXh0LnByZXYgPSBqb2ludC5tX2VkZ2VCLnByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50Lm1fZWRnZUIgPT0gYm9keUIubV9qb2ludExpc3QpIHtcbiAgICAgICAgICBib2R5Qi5tX2pvaW50TGlzdCA9IGpvaW50Lm1fZWRnZUIubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBqb2ludC5tX2VkZ2VCLnByZXYgPSBudWxsO1xuICAgICAgICBqb2ludC5tX2VkZ2VCLm5leHQgPSBudWxsO1xuICAgICAgICAtLXRoaXMubV9qb2ludENvdW50O1xuICAgICAgICBpZiAoam9pbnQubV9jb2xsaWRlQ29ubmVjdGVkID09IGZhbHNlKSB7XG4gICAgICAgICAgdmFyIGVkZ2UgPSBib2R5Qi5nZXRDb250YWN0TGlzdCgpO1xuICAgICAgICAgIHdoaWxlIChlZGdlKSB7XG4gICAgICAgICAgICBpZiAoZWRnZS5vdGhlciA9PSBib2R5QSkge1xuICAgICAgICAgICAgICBlZGdlLmNvbnRhY3QuZmxhZ0ZvckZpbHRlcmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wdWJsaXNoKFwicmVtb3ZlLWpvaW50XCIsIGpvaW50KTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnN0ZXAgPSBmdW5jdGlvbih0aW1lU3RlcCwgdmVsb2NpdHlJdGVyYXRpb25zLCBwb3NpdGlvbkl0ZXJhdGlvbnMpIHtcbiAgICAgICAgdGhpcy5wdWJsaXNoKFwicHJlLXN0ZXBcIiwgdGltZVN0ZXApO1xuICAgICAgICBpZiAoKHZlbG9jaXR5SXRlcmF0aW9ucyB8IDApICE9PSB2ZWxvY2l0eUl0ZXJhdGlvbnMpIHtcbiAgICAgICAgICB2ZWxvY2l0eUl0ZXJhdGlvbnMgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHZlbG9jaXR5SXRlcmF0aW9ucyA9IHZlbG9jaXR5SXRlcmF0aW9ucyB8fCB0aGlzLm1fdmVsb2NpdHlJdGVyYXRpb25zO1xuICAgICAgICBwb3NpdGlvbkl0ZXJhdGlvbnMgPSBwb3NpdGlvbkl0ZXJhdGlvbnMgfHwgdGhpcy5tX3Bvc2l0aW9uSXRlcmF0aW9ucztcbiAgICAgICAgaWYgKHRoaXMubV9uZXdGaXh0dXJlKSB7XG4gICAgICAgICAgdGhpcy5maW5kTmV3Q29udGFjdHMoKTtcbiAgICAgICAgICB0aGlzLm1fbmV3Rml4dHVyZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9sb2NrZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnNfc3RlcC5yZXNldCh0aW1lU3RlcCk7XG4gICAgICAgIHRoaXMuc19zdGVwLnZlbG9jaXR5SXRlcmF0aW9ucyA9IHZlbG9jaXR5SXRlcmF0aW9ucztcbiAgICAgICAgdGhpcy5zX3N0ZXAucG9zaXRpb25JdGVyYXRpb25zID0gcG9zaXRpb25JdGVyYXRpb25zO1xuICAgICAgICB0aGlzLnNfc3RlcC53YXJtU3RhcnRpbmcgPSB0aGlzLm1fd2FybVN0YXJ0aW5nO1xuICAgICAgICB0aGlzLnNfc3RlcC5ibG9ja1NvbHZlID0gdGhpcy5tX2Jsb2NrU29sdmU7XG4gICAgICAgIHRoaXMudXBkYXRlQ29udGFjdHMoKTtcbiAgICAgICAgaWYgKHRoaXMubV9zdGVwQ29tcGxldGUgJiYgdGltZVN0ZXAgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX3NvbHZlci5zb2x2ZVdvcmxkKHRoaXMuc19zdGVwKTtcbiAgICAgICAgICBmb3IgKHZhciBiMiA9IHRoaXMubV9ib2R5TGlzdDsgYjI7IGIyID0gYjIuZ2V0TmV4dCgpKSB7XG4gICAgICAgICAgICBpZiAoYjIubV9pc2xhbmRGbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGIyLmlzU3RhdGljKCkpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBiMi5zeW5jaHJvbml6ZUZpeHR1cmVzKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuZmluZE5ld0NvbnRhY3RzKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9jb250aW51b3VzUGh5c2ljcyAmJiB0aW1lU3RlcCA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fc29sdmVyLnNvbHZlV29ybGRUT0kodGhpcy5zX3N0ZXApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fY2xlYXJGb3JjZXMpIHtcbiAgICAgICAgICB0aGlzLmNsZWFyRm9yY2VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICB2YXIgY2FsbGJhY2s7XG4gICAgICAgIHdoaWxlIChjYWxsYmFjayA9IHRoaXMubV9zdGVwX2NhbGxiYWNrLnNoaWZ0KCkpIHtcbiAgICAgICAgICBjYWxsYmFjayh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnB1Ymxpc2goXCJwb3N0LXN0ZXBcIiwgdGltZVN0ZXApO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUucXVldWVVcGRhdGUgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgICBpZiAoIXRoaXMuaXNMb2NrZWQoKSkge1xuICAgICAgICAgIGNhbGxiYWNrKHRoaXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9zdGVwX2NhbGxiYWNrLnB1c2goY2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5maW5kTmV3Q29udGFjdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5tX2Jyb2FkUGhhc2UudXBkYXRlUGFpcnMoZnVuY3Rpb24ocHJveHlBLCBwcm94eUIpIHtcbiAgICAgICAgICByZXR1cm4gX3RoaXMuY3JlYXRlQ29udGFjdChwcm94eUEsIHByb3h5Qik7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuY3JlYXRlQ29udGFjdCA9IGZ1bmN0aW9uKHByb3h5QSwgcHJveHlCKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHByb3h5QS5maXh0dXJlO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSBwcm94eUIuZml4dHVyZTtcbiAgICAgICAgdmFyIGluZGV4QSA9IHByb3h5QS5jaGlsZEluZGV4O1xuICAgICAgICB2YXIgaW5kZXhCID0gcHJveHlCLmNoaWxkSW5kZXg7XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLmdldEJvZHkoKTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIuZ2V0Qm9keSgpO1xuICAgICAgICBpZiAoYm9keUEgPT0gYm9keUIpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVkZ2UgPSBib2R5Qi5nZXRDb250YWN0TGlzdCgpO1xuICAgICAgICB3aGlsZSAoZWRnZSkge1xuICAgICAgICAgIGlmIChlZGdlLm90aGVyID09IGJvZHlBKSB7XG4gICAgICAgICAgICB2YXIgZkEgPSBlZGdlLmNvbnRhY3QuZ2V0Rml4dHVyZUEoKTtcbiAgICAgICAgICAgIHZhciBmQiA9IGVkZ2UuY29udGFjdC5nZXRGaXh0dXJlQigpO1xuICAgICAgICAgICAgdmFyIGlBID0gZWRnZS5jb250YWN0LmdldENoaWxkSW5kZXhBKCk7XG4gICAgICAgICAgICB2YXIgaUIgPSBlZGdlLmNvbnRhY3QuZ2V0Q2hpbGRJbmRleEIoKTtcbiAgICAgICAgICAgIGlmIChmQSA9PSBmaXh0dXJlQSAmJiBmQiA9PSBmaXh0dXJlQiAmJiBpQSA9PSBpbmRleEEgJiYgaUIgPT0gaW5kZXhCKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmQSA9PSBmaXh0dXJlQiAmJiBmQiA9PSBmaXh0dXJlQSAmJiBpQSA9PSBpbmRleEIgJiYgaUIgPT0gaW5kZXhBKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYm9keUIuc2hvdWxkQ29sbGlkZShib2R5QSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpeHR1cmVCLnNob3VsZENvbGxpZGUoZml4dHVyZUEpID09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb250YWN0ID0gQ29udGFjdC5jcmVhdGUoZml4dHVyZUEsIGluZGV4QSwgZml4dHVyZUIsIGluZGV4Qik7XG4gICAgICAgIGlmIChjb250YWN0ID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29udGFjdC5tX3ByZXYgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5tX2NvbnRhY3RMaXN0ICE9IG51bGwpIHtcbiAgICAgICAgICBjb250YWN0Lm1fbmV4dCA9IHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgICAgICB0aGlzLm1fY29udGFjdExpc3QubV9wcmV2ID0gY29udGFjdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBjb250YWN0O1xuICAgICAgICArK3RoaXMubV9jb250YWN0Q291bnQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS51cGRhdGVDb250YWN0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYzI7XG4gICAgICAgIHZhciBuZXh0X2MgPSB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICAgIHdoaWxlIChjMiA9IG5leHRfYykge1xuICAgICAgICAgIG5leHRfYyA9IGMyLmdldE5leHQoKTtcbiAgICAgICAgICB2YXIgZml4dHVyZUEgPSBjMi5nZXRGaXh0dXJlQSgpO1xuICAgICAgICAgIHZhciBmaXh0dXJlQiA9IGMyLmdldEZpeHR1cmVCKCk7XG4gICAgICAgICAgdmFyIGluZGV4QSA9IGMyLmdldENoaWxkSW5kZXhBKCk7XG4gICAgICAgICAgdmFyIGluZGV4QiA9IGMyLmdldENoaWxkSW5kZXhCKCk7XG4gICAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEuZ2V0Qm9keSgpO1xuICAgICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLmdldEJvZHkoKTtcbiAgICAgICAgICBpZiAoYzIubV9maWx0ZXJGbGFnKSB7XG4gICAgICAgICAgICBpZiAoYm9keUIuc2hvdWxkQ29sbGlkZShib2R5QSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgdGhpcy5kZXN0cm95Q29udGFjdChjMik7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpeHR1cmVCLnNob3VsZENvbGxpZGUoZml4dHVyZUEpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIHRoaXMuZGVzdHJveUNvbnRhY3QoYzIpO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGMyLm1fZmlsdGVyRmxhZyA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgYWN0aXZlQSA9IGJvZHlBLmlzQXdha2UoKSAmJiAhYm9keUEuaXNTdGF0aWMoKTtcbiAgICAgICAgICB2YXIgYWN0aXZlQiA9IGJvZHlCLmlzQXdha2UoKSAmJiAhYm9keUIuaXNTdGF0aWMoKTtcbiAgICAgICAgICBpZiAoYWN0aXZlQSA9PSBmYWxzZSAmJiBhY3RpdmVCID09IGZhbHNlKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHByb3h5SWRBID0gZml4dHVyZUEubV9wcm94aWVzW2luZGV4QV0ucHJveHlJZDtcbiAgICAgICAgICB2YXIgcHJveHlJZEIgPSBmaXh0dXJlQi5tX3Byb3hpZXNbaW5kZXhCXS5wcm94eUlkO1xuICAgICAgICAgIHZhciBvdmVybGFwID0gdGhpcy5tX2Jyb2FkUGhhc2UudGVzdE92ZXJsYXAocHJveHlJZEEsIHByb3h5SWRCKTtcbiAgICAgICAgICBpZiAob3ZlcmxhcCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95Q29udGFjdChjMik7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYzIudXBkYXRlKHRoaXMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5kZXN0cm95Q29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QpIHtcbiAgICAgICAgaWYgKGNvbnRhY3QubV9wcmV2KSB7XG4gICAgICAgICAgY29udGFjdC5tX3ByZXYubV9uZXh0ID0gY29udGFjdC5tX25leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9uZXh0KSB7XG4gICAgICAgICAgY29udGFjdC5tX25leHQubV9wcmV2ID0gY29udGFjdC5tX3ByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QgPT0gdGhpcy5tX2NvbnRhY3RMaXN0KSB7XG4gICAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gY29udGFjdC5tX25leHQ7XG4gICAgICAgIH1cbiAgICAgICAgQ29udGFjdC5kZXN0cm95KGNvbnRhY3QsIHRoaXMpO1xuICAgICAgICAtLXRoaXMubV9jb250YWN0Q291bnQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uKG5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgbGlzdGVuZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5fbGlzdGVuZXJzKSB7XG4gICAgICAgICAgdGhpcy5fbGlzdGVuZXJzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9saXN0ZW5lcnNbbmFtZV0pIHtcbiAgICAgICAgICB0aGlzLl9saXN0ZW5lcnNbbmFtZV0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9saXN0ZW5lcnNbbmFtZV0ucHVzaChsaXN0ZW5lcik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24obmFtZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lICE9PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBsaXN0ZW5lciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVycyAmJiB0aGlzLl9saXN0ZW5lcnNbbmFtZV07XG4gICAgICAgIGlmICghbGlzdGVuZXJzIHx8ICFsaXN0ZW5lcnMubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluZGV4ID0gbGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUucHVibGlzaCA9IGZ1bmN0aW9uKG5hbWUsIGFyZzEsIGFyZzIsIGFyZzMpIHtcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVycyAmJiB0aGlzLl9saXN0ZW5lcnNbbmFtZV07XG4gICAgICAgIGlmICghbGlzdGVuZXJzIHx8ICFsaXN0ZW5lcnMubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgbCA9IDA7IGwgPCBsaXN0ZW5lcnMubGVuZ3RoOyBsKyspIHtcbiAgICAgICAgICBsaXN0ZW5lcnNbbF0uY2FsbCh0aGlzLCBhcmcxLCBhcmcyLCBhcmczKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdGVuZXJzLmxlbmd0aDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmJlZ2luQ29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QpIHtcbiAgICAgICAgdGhpcy5wdWJsaXNoKFwiYmVnaW4tY29udGFjdFwiLCBjb250YWN0KTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmVuZENvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0KSB7XG4gICAgICAgIHRoaXMucHVibGlzaChcImVuZC1jb250YWN0XCIsIGNvbnRhY3QpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUucHJlU29sdmUgPSBmdW5jdGlvbihjb250YWN0LCBvbGRNYW5pZm9sZDIpIHtcbiAgICAgICAgdGhpcy5wdWJsaXNoKFwicHJlLXNvbHZlXCIsIGNvbnRhY3QsIG9sZE1hbmlmb2xkMik7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5wb3N0U29sdmUgPSBmdW5jdGlvbihjb250YWN0LCBpbXB1bHNlKSB7XG4gICAgICAgIHRoaXMucHVibGlzaChcInBvc3Qtc29sdmVcIiwgY29udGFjdCwgaW1wdWxzZSk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFdvcmxkMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFZlYzMgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVmVjMzIoeDIsIHksIHopIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFZlYzMyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgVmVjMzIoeDIsIHksIHopO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgeDIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0aGlzLnggPSAwO1xuICAgICAgICAgIHRoaXMueSA9IDA7XG4gICAgICAgICAgdGhpcy56ID0gMDtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgeDIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLnggPSB4Mi54O1xuICAgICAgICAgIHRoaXMueSA9IHgyLnk7XG4gICAgICAgICAgdGhpcy56ID0geDIuejtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnggPSB4MjtcbiAgICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICAgIHRoaXMueiA9IHo7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFZlYzMyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgeDogdGhpcy54LFxuICAgICAgICAgIHk6IHRoaXMueSxcbiAgICAgICAgICB6OiB0aGlzLnpcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFZlYzMyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai54ID0gZGF0YS54O1xuICAgICAgICBvYmoueSA9IGRhdGEueTtcbiAgICAgICAgb2JqLnogPSBkYXRhLno7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVmVjMzIubmVvID0gZnVuY3Rpb24oeDIsIHksIHopIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVmVjMzIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnggPSB4MjtcbiAgICAgICAgb2JqLnkgPSB5O1xuICAgICAgICBvYmoueiA9IHo7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVmVjMzIuemVybyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShWZWMzMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoueCA9IDA7XG4gICAgICAgIG9iai55ID0gMDtcbiAgICAgICAgb2JqLnogPSAwO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLmNsb25lID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIFZlYzMyLm5lbyh2My54LCB2My55LCB2My56KTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMpO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOdW1iZXIuaXNGaW5pdGUob2JqLngpICYmIE51bWJlci5pc0Zpbml0ZShvYmoueSkgJiYgTnVtYmVyLmlzRmluaXRlKG9iai56KTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5hc3NlcnQgPSBmdW5jdGlvbihvKSB7XG4gICAgICB9O1xuICAgICAgVmVjMzIucHJvdG90eXBlLnNldFplcm8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy54ID0gMDtcbiAgICAgICAgdGhpcy55ID0gMDtcbiAgICAgICAgdGhpcy56ID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMzIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHgyLCB5LCB6KSB7XG4gICAgICAgIHRoaXMueCA9IHgyO1xuICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICB0aGlzLnogPSB6O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24odykge1xuICAgICAgICB0aGlzLnggKz0gdy54O1xuICAgICAgICB0aGlzLnkgKz0gdy55O1xuICAgICAgICB0aGlzLnogKz0gdy56O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUuc3ViID0gZnVuY3Rpb24odykge1xuICAgICAgICB0aGlzLnggLT0gdy54O1xuICAgICAgICB0aGlzLnkgLT0gdy55O1xuICAgICAgICB0aGlzLnogLT0gdy56O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUubXVsID0gZnVuY3Rpb24obSkge1xuICAgICAgICB0aGlzLnggKj0gbTtcbiAgICAgICAgdGhpcy55ICo9IG07XG4gICAgICAgIHRoaXMueiAqPSBtO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMzMi5hcmVFcXVhbCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiB2MyA9PT0gdyB8fCB0eXBlb2YgdjMgPT09IFwib2JqZWN0XCIgJiYgdjMgIT09IG51bGwgJiYgdHlwZW9mIHcgPT09IFwib2JqZWN0XCIgJiYgdyAhPT0gbnVsbCAmJiB2My54ID09PSB3LnggJiYgdjMueSA9PT0gdy55ICYmIHYzLnogPT09IHcuejtcbiAgICAgIH07XG4gICAgICBWZWMzMi5kb3QgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gdjMueCAqIHcueCArIHYzLnkgKiB3LnkgKyB2My56ICogdy56O1xuICAgICAgfTtcbiAgICAgIFZlYzMyLmNyb3NzID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzMih2My55ICogdy56IC0gdjMueiAqIHcueSwgdjMueiAqIHcueCAtIHYzLnggKiB3LnosIHYzLnggKiB3LnkgLSB2My55ICogdy54KTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5hZGQgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gbmV3IFZlYzMyKHYzLnggKyB3LngsIHYzLnkgKyB3LnksIHYzLnogKyB3LnopO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLnN1YiA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjMzIodjMueCAtIHcueCwgdjMueSAtIHcueSwgdjMueiAtIHcueik7XG4gICAgICB9O1xuICAgICAgVmVjMzIubXVsID0gZnVuY3Rpb24odjMsIG0pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzMihtICogdjMueCwgbSAqIHYzLnksIG0gKiB2My56KTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUubmVnID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMueCA9IC10aGlzLng7XG4gICAgICAgIHRoaXMueSA9IC10aGlzLnk7XG4gICAgICAgIHRoaXMueiA9IC10aGlzLno7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLm5lZyA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjMzIoLXYzLngsIC12My55LCAtdjMueik7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFZlYzMyO1xuICAgIH0oKVxuICApO1xuICB2YXIgdjEkMiA9IHZlYzIoMCwgMCk7XG4gIHZhciB2MiQxID0gdmVjMigwLCAwKTtcbiAgdmFyIEVkZ2VTaGFwZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoRWRnZVNoYXBlMiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIEVkZ2VTaGFwZTIodjEyMiwgdjIyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgRWRnZVNoYXBlMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEVkZ2VTaGFwZTIodjEyMiwgdjIyKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IEVkZ2VTaGFwZTIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9yYWRpdXMgPSBTZXR0aW5nc0ludGVybmFsLnBvbHlnb25SYWRpdXM7XG4gICAgICAgIF90aGlzLm1fdmVydGV4MSA9IHYxMjIgPyBWZWMyLmNsb25lKHYxMjIpIDogVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fdmVydGV4MiA9IHYyMiA/IFZlYzIuY2xvbmUodjIyKSA6IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX3ZlcnRleDAgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV92ZXJ0ZXgzID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1faGFzVmVydGV4MCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5tX2hhc1ZlcnRleDMgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIHZlcnRleDE6IHRoaXMubV92ZXJ0ZXgxLFxuICAgICAgICAgIHZlcnRleDI6IHRoaXMubV92ZXJ0ZXgyLFxuICAgICAgICAgIHZlcnRleDA6IHRoaXMubV92ZXJ0ZXgwLFxuICAgICAgICAgIHZlcnRleDM6IHRoaXMubV92ZXJ0ZXgzLFxuICAgICAgICAgIGhhc1ZlcnRleDA6IHRoaXMubV9oYXNWZXJ0ZXgwLFxuICAgICAgICAgIGhhc1ZlcnRleDM6IHRoaXMubV9oYXNWZXJ0ZXgzXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHZhciBzaGFwZSA9IG5ldyBFZGdlU2hhcGUyKGRhdGEudmVydGV4MSwgZGF0YS52ZXJ0ZXgyKTtcbiAgICAgICAgaWYgKHNoYXBlLm1faGFzVmVydGV4MCkge1xuICAgICAgICAgIHNoYXBlLnNldFByZXZWZXJ0ZXgoZGF0YS52ZXJ0ZXgwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2hhcGUubV9oYXNWZXJ0ZXgzKSB7XG4gICAgICAgICAgc2hhcGUuc2V0TmV4dFZlcnRleChkYXRhLnZlcnRleDMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaGFwZTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5nZXRSYWRpdXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuc2V0TmV4dCA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldE5leHRWZXJ0ZXgodjMpO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLnNldE5leHRWZXJ0ZXggPSBmdW5jdGlvbih2Mykge1xuICAgICAgICBpZiAodjMpIHtcbiAgICAgICAgICB0aGlzLm1fdmVydGV4My5zZXRWZWMyKHYzKTtcbiAgICAgICAgICB0aGlzLm1faGFzVmVydGV4MyA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3ZlcnRleDMuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9oYXNWZXJ0ZXgzID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuZ2V0TmV4dFZlcnRleCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRleDM7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuc2V0UHJldiA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldFByZXZWZXJ0ZXgodjMpO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLnNldFByZXZWZXJ0ZXggPSBmdW5jdGlvbih2Mykge1xuICAgICAgICBpZiAodjMpIHtcbiAgICAgICAgICB0aGlzLm1fdmVydGV4MC5zZXRWZWMyKHYzKTtcbiAgICAgICAgICB0aGlzLm1faGFzVmVydGV4MCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3ZlcnRleDAuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9oYXNWZXJ0ZXgwID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuZ2V0UHJldlZlcnRleCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRleDA7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuX3NldCA9IGZ1bmN0aW9uKHYxMjIsIHYyMikge1xuICAgICAgICB0aGlzLm1fdmVydGV4MS5zZXRWZWMyKHYxMjIpO1xuICAgICAgICB0aGlzLm1fdmVydGV4Mi5zZXRWZWMyKHYyMik7XG4gICAgICAgIHRoaXMubV9oYXNWZXJ0ZXgwID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9oYXNWZXJ0ZXgzID0gZmFsc2U7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLl9jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgRWRnZVNoYXBlMigpO1xuICAgICAgICBjbG9uZS5tX3R5cGUgPSB0aGlzLm1fdHlwZTtcbiAgICAgICAgY2xvbmUubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgICBjbG9uZS5tX3ZlcnRleDEuc2V0VmVjMih0aGlzLm1fdmVydGV4MSk7XG4gICAgICAgIGNsb25lLm1fdmVydGV4Mi5zZXRWZWMyKHRoaXMubV92ZXJ0ZXgyKTtcbiAgICAgICAgY2xvbmUubV92ZXJ0ZXgwLnNldFZlYzIodGhpcy5tX3ZlcnRleDApO1xuICAgICAgICBjbG9uZS5tX3ZlcnRleDMuc2V0VmVjMih0aGlzLm1fdmVydGV4Myk7XG4gICAgICAgIGNsb25lLm1faGFzVmVydGV4MCA9IHRoaXMubV9oYXNWZXJ0ZXgwO1xuICAgICAgICBjbG9uZS5tX2hhc1ZlcnRleDMgPSB0aGlzLm1faGFzVmVydGV4MztcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmdldENoaWxkQ291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUudGVzdFBvaW50ID0gZnVuY3Rpb24oeGYyLCBwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdmFyIHAxID0gUm90Lm11bFRWZWMyKHhmMi5xLCBWZWMyLnN1YihpbnB1dDIucDEsIHhmMi5wKSk7XG4gICAgICAgIHZhciBwMiA9IFJvdC5tdWxUVmVjMih4ZjIucSwgVmVjMi5zdWIoaW5wdXQyLnAyLCB4ZjIucCkpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihwMiwgcDEpO1xuICAgICAgICB2YXIgdjEyMiA9IHRoaXMubV92ZXJ0ZXgxO1xuICAgICAgICB2YXIgdjIyID0gdGhpcy5tX3ZlcnRleDI7XG4gICAgICAgIHZhciBlMyA9IFZlYzIuc3ViKHYyMiwgdjEyMik7XG4gICAgICAgIHZhciBub3JtYWwzID0gVmVjMi5uZW8oZTMueSwgLWUzLngpO1xuICAgICAgICBub3JtYWwzLm5vcm1hbGl6ZSgpO1xuICAgICAgICB2YXIgbnVtZXJhdG9yID0gVmVjMi5kb3Qobm9ybWFsMywgVmVjMi5zdWIodjEyMiwgcDEpKTtcbiAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gVmVjMi5kb3Qobm9ybWFsMywgZDIpO1xuICAgICAgICBpZiAoZGVub21pbmF0b3IgPT0gMCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdCA9IG51bWVyYXRvciAvIGRlbm9taW5hdG9yO1xuICAgICAgICBpZiAodCA8IDAgfHwgaW5wdXQyLm1heEZyYWN0aW9uIDwgdCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcSA9IFZlYzIuYWRkKHAxLCBWZWMyLm11bE51bVZlYzIodCwgZDIpKTtcbiAgICAgICAgdmFyIHIgPSBWZWMyLnN1Yih2MjIsIHYxMjIpO1xuICAgICAgICB2YXIgcnIgPSBWZWMyLmRvdChyLCByKTtcbiAgICAgICAgaWYgKHJyID09IDApIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHMyID0gVmVjMi5kb3QoVmVjMi5zdWIocSwgdjEyMiksIHIpIC8gcnI7XG4gICAgICAgIGlmIChzMiA8IDAgfHwgMSA8IHMyKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIG91dHB1dDIuZnJhY3Rpb24gPSB0O1xuICAgICAgICBpZiAobnVtZXJhdG9yID4gMCkge1xuICAgICAgICAgIG91dHB1dDIubm9ybWFsID0gUm90Lm11bFZlYzIoeGYyLnEsIG5vcm1hbDMpLm5lZygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG91dHB1dDIubm9ybWFsID0gUm90Lm11bFZlYzIoeGYyLnEsIG5vcm1hbDMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmNvbXB1dGVBQUJCID0gZnVuY3Rpb24oYWFiYiwgeGYyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHRyYW5zZm9ybVZlYzIodjEkMiwgeGYyLCB0aGlzLm1fdmVydGV4MSk7XG4gICAgICAgIHRyYW5zZm9ybVZlYzIodjIkMSwgeGYyLCB0aGlzLm1fdmVydGV4Mik7XG4gICAgICAgIEFBQkIuY29tYmluZVBvaW50cyhhYWJiLCB2MSQyLCB2MiQxKTtcbiAgICAgICAgQUFCQi5leHRlbmQoYWFiYiwgdGhpcy5tX3JhZGl1cyk7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZU1hc3MgPSBmdW5jdGlvbihtYXNzRGF0YSwgZGVuc2l0eSkge1xuICAgICAgICBtYXNzRGF0YS5tYXNzID0gMDtcbiAgICAgICAgY29tYmluZTJWZWMyKG1hc3NEYXRhLmNlbnRlciwgMC41LCB0aGlzLm1fdmVydGV4MSwgMC41LCB0aGlzLm1fdmVydGV4Mik7XG4gICAgICAgIG1hc3NEYXRhLkkgPSAwO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmNvbXB1dGVEaXN0YW5jZVByb3h5ID0gZnVuY3Rpb24ocHJveHkpIHtcbiAgICAgICAgcHJveHkubV92ZXJ0aWNlc1swXSA9IHRoaXMubV92ZXJ0ZXgxO1xuICAgICAgICBwcm94eS5tX3ZlcnRpY2VzWzFdID0gdGhpcy5tX3ZlcnRleDI7XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXMubGVuZ3RoID0gMjtcbiAgICAgICAgcHJveHkubV9jb3VudCA9IDI7XG4gICAgICAgIHByb3h5Lm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLlRZUEUgPSBcImVkZ2VcIjtcbiAgICAgIHJldHVybiBFZGdlU2hhcGUyO1xuICAgIH0oU2hhcGUpXG4gICk7XG4gIHZhciB2MSQxID0gdmVjMigwLCAwKTtcbiAgdmFyIHYyID0gdmVjMigwLCAwKTtcbiAgdmFyIENoYWluU2hhcGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKENoYWluU2hhcGUyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gQ2hhaW5TaGFwZTIodmVydGljZXMsIGxvb3ApIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBDaGFpblNoYXBlMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IENoYWluU2hhcGUyKHZlcnRpY2VzLCBsb29wKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IENoYWluU2hhcGUyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fcmFkaXVzID0gU2V0dGluZ3NJbnRlcm5hbC5wb2x5Z29uUmFkaXVzO1xuICAgICAgICBfdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIF90aGlzLm1fY291bnQgPSAwO1xuICAgICAgICBfdGhpcy5tX3ByZXZWZXJ0ZXggPSBudWxsO1xuICAgICAgICBfdGhpcy5tX25leHRWZXJ0ZXggPSBudWxsO1xuICAgICAgICBfdGhpcy5tX2hhc1ByZXZWZXJ0ZXggPSBmYWxzZTtcbiAgICAgICAgX3RoaXMubV9oYXNOZXh0VmVydGV4ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLm1faXNMb29wID0gISFsb29wO1xuICAgICAgICBpZiAodmVydGljZXMgJiYgdmVydGljZXMubGVuZ3RoKSB7XG4gICAgICAgICAgaWYgKGxvb3ApIHtcbiAgICAgICAgICAgIF90aGlzLl9jcmVhdGVMb29wKHZlcnRpY2VzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX3RoaXMuX2NyZWF0ZUNoYWluKHZlcnRpY2VzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgdmVydGljZXM6IHRoaXMubV9pc0xvb3AgPyB0aGlzLm1fdmVydGljZXMuc2xpY2UoMCwgdGhpcy5tX3ZlcnRpY2VzLmxlbmd0aCAtIDEpIDogdGhpcy5tX3ZlcnRpY2VzLFxuICAgICAgICAgIGlzTG9vcDogdGhpcy5tX2lzTG9vcCxcbiAgICAgICAgICBoYXNQcmV2VmVydGV4OiB0aGlzLm1faGFzUHJldlZlcnRleCxcbiAgICAgICAgICBoYXNOZXh0VmVydGV4OiB0aGlzLm1faGFzTmV4dFZlcnRleCxcbiAgICAgICAgICBwcmV2VmVydGV4OiBudWxsLFxuICAgICAgICAgIG5leHRWZXJ0ZXg6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMubV9wcmV2VmVydGV4KSB7XG4gICAgICAgICAgZGF0YS5wcmV2VmVydGV4ID0gdGhpcy5tX3ByZXZWZXJ0ZXg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9uZXh0VmVydGV4KSB7XG4gICAgICAgICAgZGF0YS5uZXh0VmVydGV4ID0gdGhpcy5tX25leHRWZXJ0ZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgZml4dHVyZSwgcmVzdG9yZSkge1xuICAgICAgICB2YXIgdmVydGljZXMgPSBbXTtcbiAgICAgICAgaWYgKGRhdGEudmVydGljZXMpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEudmVydGljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZlcnRpY2VzLnB1c2gocmVzdG9yZShWZWMyLCBkYXRhLnZlcnRpY2VzW2ldKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBzaGFwZSA9IG5ldyBDaGFpblNoYXBlMih2ZXJ0aWNlcywgZGF0YS5pc0xvb3ApO1xuICAgICAgICBpZiAoZGF0YS5wcmV2VmVydGV4KSB7XG4gICAgICAgICAgc2hhcGUuc2V0UHJldlZlcnRleChkYXRhLnByZXZWZXJ0ZXgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRhLm5leHRWZXJ0ZXgpIHtcbiAgICAgICAgICBzaGFwZS5zZXROZXh0VmVydGV4KGRhdGEubmV4dFZlcnRleCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNoYXBlO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuZ2V0UmFkaXVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5fY3JlYXRlTG9vcCA9IGZ1bmN0aW9uKHZlcnRpY2VzKSB7XG4gICAgICAgIGlmICh2ZXJ0aWNlcy5sZW5ndGggPCAzKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpO1xuICAgICAgICB0aGlzLm1fdmVydGljZXMgPSBbXTtcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gdmVydGljZXMubGVuZ3RoICsgMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2ZXJ0aWNlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXSA9IFZlYzIuY2xvbmUodmVydGljZXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlc1t2ZXJ0aWNlcy5sZW5ndGhdID0gVmVjMi5jbG9uZSh2ZXJ0aWNlc1swXSk7XG4gICAgICAgIHRoaXMubV9wcmV2VmVydGV4ID0gdGhpcy5tX3ZlcnRpY2VzW3RoaXMubV9jb3VudCAtIDJdO1xuICAgICAgICB0aGlzLm1fbmV4dFZlcnRleCA9IHRoaXMubV92ZXJ0aWNlc1sxXTtcbiAgICAgICAgdGhpcy5tX2hhc1ByZXZWZXJ0ZXggPSB0cnVlO1xuICAgICAgICB0aGlzLm1faGFzTmV4dFZlcnRleCA9IHRydWU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5fY3JlYXRlQ2hhaW4gPSBmdW5jdGlvbih2ZXJ0aWNlcykge1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIHRoaXMubV9jb3VudCA9IHZlcnRpY2VzLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2ZXJ0aWNlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXSA9IFZlYzIuY2xvbmUodmVydGljZXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9wcmV2VmVydGV4ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX25leHRWZXJ0ZXggPSBudWxsO1xuICAgICAgICB0aGlzLm1faGFzUHJldlZlcnRleCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1faGFzTmV4dFZlcnRleCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm1faXNMb29wKSB7XG4gICAgICAgICAgdGhpcy5fY3JlYXRlTG9vcCh0aGlzLm1fdmVydGljZXMuc2xpY2UoMCwgdGhpcy5tX3ZlcnRpY2VzLmxlbmd0aCAtIDEpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9jcmVhdGVDaGFpbih0aGlzLm1fdmVydGljZXMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLnNldFByZXZWZXJ0ZXggPSBmdW5jdGlvbihwcmV2VmVydGV4KSB7XG4gICAgICAgIHRoaXMubV9wcmV2VmVydGV4ID0gcHJldlZlcnRleDtcbiAgICAgICAgdGhpcy5tX2hhc1ByZXZWZXJ0ZXggPSB0cnVlO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRQcmV2VmVydGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcHJldlZlcnRleDtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuc2V0TmV4dFZlcnRleCA9IGZ1bmN0aW9uKG5leHRWZXJ0ZXgpIHtcbiAgICAgICAgdGhpcy5tX25leHRWZXJ0ZXggPSBuZXh0VmVydGV4O1xuICAgICAgICB0aGlzLm1faGFzTmV4dFZlcnRleCA9IHRydWU7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmdldE5leHRWZXJ0ZXggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9uZXh0VmVydGV4O1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5fY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNsb25lID0gbmV3IENoYWluU2hhcGUyKCk7XG4gICAgICAgIGNsb25lLl9jcmVhdGVDaGFpbih0aGlzLm1fdmVydGljZXMpO1xuICAgICAgICBjbG9uZS5tX3R5cGUgPSB0aGlzLm1fdHlwZTtcbiAgICAgICAgY2xvbmUubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgICBjbG9uZS5tX3ByZXZWZXJ0ZXggPSB0aGlzLm1fcHJldlZlcnRleDtcbiAgICAgICAgY2xvbmUubV9uZXh0VmVydGV4ID0gdGhpcy5tX25leHRWZXJ0ZXg7XG4gICAgICAgIGNsb25lLm1faGFzUHJldlZlcnRleCA9IHRoaXMubV9oYXNQcmV2VmVydGV4O1xuICAgICAgICBjbG9uZS5tX2hhc05leHRWZXJ0ZXggPSB0aGlzLm1faGFzTmV4dFZlcnRleDtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRDaGlsZENvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY291bnQgLSAxO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRDaGlsZEVkZ2UgPSBmdW5jdGlvbihlZGdlLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIGVkZ2UubV90eXBlID0gRWRnZVNoYXBlLlRZUEU7XG4gICAgICAgIGVkZ2UubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgICBlZGdlLm1fdmVydGV4MSA9IHRoaXMubV92ZXJ0aWNlc1tjaGlsZEluZGV4XTtcbiAgICAgICAgZWRnZS5tX3ZlcnRleDIgPSB0aGlzLm1fdmVydGljZXNbY2hpbGRJbmRleCArIDFdO1xuICAgICAgICBpZiAoY2hpbGRJbmRleCA+IDApIHtcbiAgICAgICAgICBlZGdlLm1fdmVydGV4MCA9IHRoaXMubV92ZXJ0aWNlc1tjaGlsZEluZGV4IC0gMV07XG4gICAgICAgICAgZWRnZS5tX2hhc1ZlcnRleDAgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVkZ2UubV92ZXJ0ZXgwID0gdGhpcy5tX3ByZXZWZXJ0ZXg7XG4gICAgICAgICAgZWRnZS5tX2hhc1ZlcnRleDAgPSB0aGlzLm1faGFzUHJldlZlcnRleDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hpbGRJbmRleCA8IHRoaXMubV9jb3VudCAtIDIpIHtcbiAgICAgICAgICBlZGdlLm1fdmVydGV4MyA9IHRoaXMubV92ZXJ0aWNlc1tjaGlsZEluZGV4ICsgMl07XG4gICAgICAgICAgZWRnZS5tX2hhc1ZlcnRleDMgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVkZ2UubV92ZXJ0ZXgzID0gdGhpcy5tX25leHRWZXJ0ZXg7XG4gICAgICAgICAgZWRnZS5tX2hhc1ZlcnRleDMgPSB0aGlzLm1faGFzTmV4dFZlcnRleDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRWZXJ0ZXggPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICBpZiAoaW5kZXggPCB0aGlzLm1fY291bnQpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzW2luZGV4XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzWzBdO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmlzTG9vcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2lzTG9vcDtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUudGVzdFBvaW50ID0gZnVuY3Rpb24oeGYyLCBwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0MiwgeGYyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHZhciBlZGdlU2hhcGUgPSBuZXcgRWRnZVNoYXBlKHRoaXMuZ2V0VmVydGV4KGNoaWxkSW5kZXgpLCB0aGlzLmdldFZlcnRleChjaGlsZEluZGV4ICsgMSkpO1xuICAgICAgICByZXR1cm4gZWRnZVNoYXBlLnJheUNhc3Qob3V0cHV0MiwgaW5wdXQyLCB4ZjIsIDApO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlQUFCQiA9IGZ1bmN0aW9uKGFhYmIsIHhmMiwgY2hpbGRJbmRleCkge1xuICAgICAgICB0cmFuc2Zvcm1WZWMyKHYxJDEsIHhmMiwgdGhpcy5nZXRWZXJ0ZXgoY2hpbGRJbmRleCkpO1xuICAgICAgICB0cmFuc2Zvcm1WZWMyKHYyLCB4ZjIsIHRoaXMuZ2V0VmVydGV4KGNoaWxkSW5kZXggKyAxKSk7XG4gICAgICAgIEFBQkIuY29tYmluZVBvaW50cyhhYWJiLCB2MSQxLCB2Mik7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmNvbXB1dGVNYXNzID0gZnVuY3Rpb24obWFzc0RhdGEsIGRlbnNpdHkpIHtcbiAgICAgICAgbWFzc0RhdGEubWFzcyA9IDA7XG4gICAgICAgIHplcm9WZWMyKG1hc3NEYXRhLmNlbnRlcik7XG4gICAgICAgIG1hc3NEYXRhLkkgPSAwO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlRGlzdGFuY2VQcm94eSA9IGZ1bmN0aW9uKHByb3h5LCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXNbMF0gPSB0aGlzLmdldFZlcnRleChjaGlsZEluZGV4KTtcbiAgICAgICAgcHJveHkubV92ZXJ0aWNlc1sxXSA9IHRoaXMuZ2V0VmVydGV4KGNoaWxkSW5kZXggKyAxKTtcbiAgICAgICAgcHJveHkubV9jb3VudCA9IDI7XG4gICAgICAgIHByb3h5Lm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5UWVBFID0gXCJjaGFpblwiO1xuICAgICAgcmV0dXJuIENoYWluU2hhcGUyO1xuICAgIH0oU2hhcGUpXG4gICk7XG4gIHZhciBtYXRoX21heCQxID0gTWF0aC5tYXg7XG4gIHZhciBtYXRoX21pbiQzID0gTWF0aC5taW47XG4gIHZhciB0ZW1wJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgZSQxID0gdmVjMigwLCAwKTtcbiAgdmFyIGUxJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgZTIkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBjZW50ZXIgPSB2ZWMyKDAsIDApO1xuICB2YXIgcyA9IHZlYzIoMCwgMCk7XG4gIHZhciBQb2x5Z29uU2hhcGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFBvbHlnb25TaGFwZTIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBQb2x5Z29uU2hhcGUyKHZlcnRpY2VzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgUG9seWdvblNoYXBlMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFBvbHlnb25TaGFwZTIodmVydGljZXMpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMubV90eXBlID0gUG9seWdvblNoYXBlMi5UWVBFO1xuICAgICAgICBfdGhpcy5tX3JhZGl1cyA9IFNldHRpbmdzSW50ZXJuYWwucG9seWdvblJhZGl1cztcbiAgICAgICAgX3RoaXMubV9jZW50cm9pZCA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIF90aGlzLm1fbm9ybWFscyA9IFtdO1xuICAgICAgICBfdGhpcy5tX2NvdW50ID0gMDtcbiAgICAgICAgaWYgKHZlcnRpY2VzICYmIHZlcnRpY2VzLmxlbmd0aCkge1xuICAgICAgICAgIF90aGlzLl9zZXQodmVydGljZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICB2ZXJ0aWNlczogdGhpcy5tX3ZlcnRpY2VzXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCBmaXh0dXJlLCByZXN0b3JlKSB7XG4gICAgICAgIHZhciB2ZXJ0aWNlcyA9IFtdO1xuICAgICAgICBpZiAoZGF0YS52ZXJ0aWNlcykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS52ZXJ0aWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmVydGljZXMucHVzaChyZXN0b3JlKFZlYzIsIGRhdGEudmVydGljZXNbaV0pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNoYXBlID0gbmV3IFBvbHlnb25TaGFwZTIodmVydGljZXMpO1xuICAgICAgICByZXR1cm4gc2hhcGU7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuZ2V0UmFkaXVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLl9jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgUG9seWdvblNoYXBlMigpO1xuICAgICAgICBjbG9uZS5tX3R5cGUgPSB0aGlzLm1fdHlwZTtcbiAgICAgICAgY2xvbmUubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgICBjbG9uZS5tX2NvdW50ID0gdGhpcy5tX2NvdW50O1xuICAgICAgICBjbG9uZS5tX2NlbnRyb2lkLnNldFZlYzIodGhpcy5tX2NlbnRyb2lkKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7IGkrKykge1xuICAgICAgICAgIGNsb25lLm1fdmVydGljZXMucHVzaCh0aGlzLm1fdmVydGljZXNbaV0uY2xvbmUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fbm9ybWFscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNsb25lLm1fbm9ybWFscy5wdXNoKHRoaXMubV9ub3JtYWxzW2ldLmNsb25lKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5nZXRDaGlsZENvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9zZXQodGhpcy5tX3ZlcnRpY2VzKTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5fc2V0ID0gZnVuY3Rpb24odmVydGljZXMpIHtcbiAgICAgICAgaWYgKHZlcnRpY2VzLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgICB0aGlzLl9zZXRBc0JveCgxLCAxKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG4yID0gbWF0aF9taW4kMyh2ZXJ0aWNlcy5sZW5ndGgsIFNldHRpbmdzSW50ZXJuYWwubWF4UG9seWdvblZlcnRpY2VzKTtcbiAgICAgICAgdmFyIHBzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjI7ICsraSkge1xuICAgICAgICAgIHZhciB2MyA9IHZlcnRpY2VzW2ldO1xuICAgICAgICAgIHZhciB1bmlxdWUgPSB0cnVlO1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcHMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIGlmIChWZWMyLmRpc3RhbmNlU3F1YXJlZCh2MywgcHNbal0pIDwgMC4yNSAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcFNxdWFyZWQpIHtcbiAgICAgICAgICAgICAgdW5pcXVlID0gZmFsc2U7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodW5pcXVlKSB7XG4gICAgICAgICAgICBwcy5wdXNoKFZlYzIuY2xvbmUodjMpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbjIgPSBwcy5sZW5ndGg7XG4gICAgICAgIGlmIChuMiA8IDMpIHtcbiAgICAgICAgICB0aGlzLl9zZXRBc0JveCgxLCAxKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGkwID0gMDtcbiAgICAgICAgdmFyIHgwID0gcHNbMF0ueDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBuMjsgKytpKSB7XG4gICAgICAgICAgdmFyIHgyID0gcHNbaV0ueDtcbiAgICAgICAgICBpZiAoeDIgPiB4MCB8fCB4MiA9PT0geDAgJiYgcHNbaV0ueSA8IHBzW2kwXS55KSB7XG4gICAgICAgICAgICBpMCA9IGk7XG4gICAgICAgICAgICB4MCA9IHgyO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgaHVsbCA9IFtdO1xuICAgICAgICB2YXIgbSA9IDA7XG4gICAgICAgIHZhciBpaCA9IGkwO1xuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgIGh1bGxbbV0gPSBpaDtcbiAgICAgICAgICB2YXIgaWUyID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IG4yOyArK2opIHtcbiAgICAgICAgICAgIGlmIChpZTIgPT09IGloKSB7XG4gICAgICAgICAgICAgIGllMiA9IGo7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHIgPSBWZWMyLnN1Yihwc1tpZTJdLCBwc1todWxsW21dXSk7XG4gICAgICAgICAgICB2YXIgdjMgPSBWZWMyLnN1Yihwc1tqXSwgcHNbaHVsbFttXV0pO1xuICAgICAgICAgICAgdmFyIGMyID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHIsIHYzKTtcbiAgICAgICAgICAgIGlmIChjMiA8IDApIHtcbiAgICAgICAgICAgICAgaWUyID0gajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjMiA9PT0gMCAmJiB2My5sZW5ndGhTcXVhcmVkKCkgPiByLmxlbmd0aFNxdWFyZWQoKSkge1xuICAgICAgICAgICAgICBpZTIgPSBqO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICArK207XG4gICAgICAgICAgaWggPSBpZTI7XG4gICAgICAgICAgaWYgKGllMiA9PT0gaTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobSA8IDMpIHtcbiAgICAgICAgICB0aGlzLl9zZXRBc0JveCgxLCAxKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2NvdW50ID0gbTtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbTsgKytpKSB7XG4gICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldID0gcHNbaHVsbFtpXV07XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtOyArK2kpIHtcbiAgICAgICAgICB2YXIgaTEgPSBpO1xuICAgICAgICAgIHZhciBpMiA9IGkgKyAxIDwgbSA/IGkgKyAxIDogMDtcbiAgICAgICAgICB2YXIgZWRnZSA9IFZlYzIuc3ViKHRoaXMubV92ZXJ0aWNlc1tpMl0sIHRoaXMubV92ZXJ0aWNlc1tpMV0pO1xuICAgICAgICAgIHRoaXMubV9ub3JtYWxzW2ldID0gVmVjMi5jcm9zc1ZlYzJOdW0oZWRnZSwgMSk7XG4gICAgICAgICAgdGhpcy5tX25vcm1hbHNbaV0ubm9ybWFsaXplKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2NlbnRyb2lkID0gY29tcHV0ZUNlbnRyb2lkKHRoaXMubV92ZXJ0aWNlcywgbSk7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuX3NldEFzQm94ID0gZnVuY3Rpb24oaHgsIGh5LCBjZW50ZXIyLCBhbmdsZSkge1xuICAgICAgICB0aGlzLm1fdmVydGljZXNbMF0gPSBWZWMyLm5lbyhoeCwgLWh5KTtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzWzFdID0gVmVjMi5uZW8oaHgsIGh5KTtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzWzJdID0gVmVjMi5uZW8oLWh4LCBoeSk7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlc1szXSA9IFZlYzIubmVvKC1oeCwgLWh5KTtcbiAgICAgICAgdGhpcy5tX25vcm1hbHNbMF0gPSBWZWMyLm5lbygxLCAwKTtcbiAgICAgICAgdGhpcy5tX25vcm1hbHNbMV0gPSBWZWMyLm5lbygwLCAxKTtcbiAgICAgICAgdGhpcy5tX25vcm1hbHNbMl0gPSBWZWMyLm5lbygtMSwgMCk7XG4gICAgICAgIHRoaXMubV9ub3JtYWxzWzNdID0gVmVjMi5uZW8oMCwgLTEpO1xuICAgICAgICB0aGlzLm1fY291bnQgPSA0O1xuICAgICAgICBpZiAoY2VudGVyMiAmJiBWZWMyLmlzVmFsaWQoY2VudGVyMikpIHtcbiAgICAgICAgICBhbmdsZSA9IGFuZ2xlIHx8IDA7XG4gICAgICAgICAgY29weVZlYzIodGhpcy5tX2NlbnRyb2lkLCBjZW50ZXIyKTtcbiAgICAgICAgICB2YXIgeGYyID0gVHJhbnNmb3JtLmlkZW50aXR5KCk7XG4gICAgICAgICAgeGYyLnAuc2V0VmVjMihjZW50ZXIyKTtcbiAgICAgICAgICB4ZjIucS5zZXRBbmdsZShhbmdsZSk7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldID0gVHJhbnNmb3JtLm11bFZlYzIoeGYyLCB0aGlzLm1fdmVydGljZXNbaV0pO1xuICAgICAgICAgICAgdGhpcy5tX25vcm1hbHNbaV0gPSBSb3QubXVsVmVjMih4ZjIucSwgdGhpcy5tX25vcm1hbHNbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLnRlc3RQb2ludCA9IGZ1bmN0aW9uKHhmMiwgcCkge1xuICAgICAgICB2YXIgcExvY2FsID0gZGV0cmFuc2Zvcm1WZWMyKHRlbXAkMSwgeGYyLCBwKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciBkb3QgPSBkb3RWZWMyKHRoaXMubV9ub3JtYWxzW2ldLCBwTG9jYWwpIC0gZG90VmVjMih0aGlzLm1fbm9ybWFsc1tpXSwgdGhpcy5tX3ZlcnRpY2VzW2ldKTtcbiAgICAgICAgICBpZiAoZG90ID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdmFyIHAxID0gUm90Lm11bFRWZWMyKHhmMi5xLCBWZWMyLnN1YihpbnB1dDIucDEsIHhmMi5wKSk7XG4gICAgICAgIHZhciBwMiA9IFJvdC5tdWxUVmVjMih4ZjIucSwgVmVjMi5zdWIoaW5wdXQyLnAyLCB4ZjIucCkpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihwMiwgcDEpO1xuICAgICAgICB2YXIgbG93ZXIgPSAwO1xuICAgICAgICB2YXIgdXBwZXIgPSBpbnB1dDIubWF4RnJhY3Rpb247XG4gICAgICAgIHZhciBpbmRleCA9IC0xO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIG51bWVyYXRvciA9IFZlYzIuZG90KHRoaXMubV9ub3JtYWxzW2ldLCBWZWMyLnN1Yih0aGlzLm1fdmVydGljZXNbaV0sIHAxKSk7XG4gICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gVmVjMi5kb3QodGhpcy5tX25vcm1hbHNbaV0sIGQyKTtcbiAgICAgICAgICBpZiAoZGVub21pbmF0b3IgPT0gMCkge1xuICAgICAgICAgICAgaWYgKG51bWVyYXRvciA8IDApIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoZGVub21pbmF0b3IgPCAwICYmIG51bWVyYXRvciA8IGxvd2VyICogZGVub21pbmF0b3IpIHtcbiAgICAgICAgICAgICAgbG93ZXIgPSBudW1lcmF0b3IgLyBkZW5vbWluYXRvcjtcbiAgICAgICAgICAgICAgaW5kZXggPSBpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkZW5vbWluYXRvciA+IDAgJiYgbnVtZXJhdG9yIDwgdXBwZXIgKiBkZW5vbWluYXRvcikge1xuICAgICAgICAgICAgICB1cHBlciA9IG51bWVyYXRvciAvIGRlbm9taW5hdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodXBwZXIgPCBsb3dlcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgIG91dHB1dDIuZnJhY3Rpb24gPSBsb3dlcjtcbiAgICAgICAgICBvdXRwdXQyLm5vcm1hbCA9IFJvdC5tdWxWZWMyKHhmMi5xLCB0aGlzLm1fbm9ybWFsc1tpbmRleF0pO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlQUFCQiA9IGZ1bmN0aW9uKGFhYmIsIHhmMiwgY2hpbGRJbmRleCkge1xuICAgICAgICB2YXIgbWluWCA9IEluZmluaXR5O1xuICAgICAgICB2YXIgbWluWSA9IEluZmluaXR5O1xuICAgICAgICB2YXIgbWF4WCA9IC1JbmZpbml0eTtcbiAgICAgICAgdmFyIG1heFkgPSAtSW5maW5pdHk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgdjMgPSB0cmFuc2Zvcm1WZWMyKHRlbXAkMSwgeGYyLCB0aGlzLm1fdmVydGljZXNbaV0pO1xuICAgICAgICAgIG1pblggPSBtYXRoX21pbiQzKG1pblgsIHYzLngpO1xuICAgICAgICAgIG1heFggPSBtYXRoX21heCQxKG1heFgsIHYzLngpO1xuICAgICAgICAgIG1pblkgPSBtYXRoX21pbiQzKG1pblksIHYzLnkpO1xuICAgICAgICAgIG1heFkgPSBtYXRoX21heCQxKG1heFksIHYzLnkpO1xuICAgICAgICB9XG4gICAgICAgIHNldFZlYzIoYWFiYi5sb3dlckJvdW5kLCBtaW5YIC0gdGhpcy5tX3JhZGl1cywgbWluWSAtIHRoaXMubV9yYWRpdXMpO1xuICAgICAgICBzZXRWZWMyKGFhYmIudXBwZXJCb3VuZCwgbWF4WCArIHRoaXMubV9yYWRpdXMsIG1heFkgKyB0aGlzLm1fcmFkaXVzKTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlTWFzcyA9IGZ1bmN0aW9uKG1hc3NEYXRhLCBkZW5zaXR5KSB7XG4gICAgICAgIHplcm9WZWMyKGNlbnRlcik7XG4gICAgICAgIHZhciBhcmVhID0gMDtcbiAgICAgICAgdmFyIEkgPSAwO1xuICAgICAgICB6ZXJvVmVjMihzKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHBsdXNWZWMyKHMsIHRoaXMubV92ZXJ0aWNlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgc2NhbGVWZWMyKHMsIDEgLyB0aGlzLm1fY291bnQsIHMpO1xuICAgICAgICB2YXIga19pbnYzID0gMSAvIDM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICBzdWJWZWMyKGUxJDEsIHRoaXMubV92ZXJ0aWNlc1tpXSwgcyk7XG4gICAgICAgICAgaWYgKGkgKyAxIDwgdGhpcy5tX2NvdW50KSB7XG4gICAgICAgICAgICBzdWJWZWMyKGUyJDEsIHRoaXMubV92ZXJ0aWNlc1tpICsgMV0sIHMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWJWZWMyKGUyJDEsIHRoaXMubV92ZXJ0aWNlc1swXSwgcyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBEID0gY3Jvc3NWZWMyVmVjMihlMSQxLCBlMiQxKTtcbiAgICAgICAgICB2YXIgdHJpYW5nbGVBcmVhID0gMC41ICogRDtcbiAgICAgICAgICBhcmVhICs9IHRyaWFuZ2xlQXJlYTtcbiAgICAgICAgICBjb21iaW5lMlZlYzIodGVtcCQxLCB0cmlhbmdsZUFyZWEgKiBrX2ludjMsIGUxJDEsIHRyaWFuZ2xlQXJlYSAqIGtfaW52MywgZTIkMSk7XG4gICAgICAgICAgcGx1c1ZlYzIoY2VudGVyLCB0ZW1wJDEpO1xuICAgICAgICAgIHZhciBleDEgPSBlMSQxLng7XG4gICAgICAgICAgdmFyIGV5MSA9IGUxJDEueTtcbiAgICAgICAgICB2YXIgZXgyID0gZTIkMS54O1xuICAgICAgICAgIHZhciBleTIgPSBlMiQxLnk7XG4gICAgICAgICAgdmFyIGludHgyID0gZXgxICogZXgxICsgZXgyICogZXgxICsgZXgyICogZXgyO1xuICAgICAgICAgIHZhciBpbnR5MiA9IGV5MSAqIGV5MSArIGV5MiAqIGV5MSArIGV5MiAqIGV5MjtcbiAgICAgICAgICBJICs9IDAuMjUgKiBrX2ludjMgKiBEICogKGludHgyICsgaW50eTIpO1xuICAgICAgICB9XG4gICAgICAgIG1hc3NEYXRhLm1hc3MgPSBkZW5zaXR5ICogYXJlYTtcbiAgICAgICAgc2NhbGVWZWMyKGNlbnRlciwgMSAvIGFyZWEsIGNlbnRlcik7XG4gICAgICAgIGFkZFZlYzIobWFzc0RhdGEuY2VudGVyLCBjZW50ZXIsIHMpO1xuICAgICAgICBtYXNzRGF0YS5JID0gZGVuc2l0eSAqIEk7XG4gICAgICAgIG1hc3NEYXRhLkkgKz0gbWFzc0RhdGEubWFzcyAqIChkb3RWZWMyKG1hc3NEYXRhLmNlbnRlciwgbWFzc0RhdGEuY2VudGVyKSAtIGRvdFZlYzIoY2VudGVyLCBjZW50ZXIpKTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIGkxID0gaTtcbiAgICAgICAgICB2YXIgaTIgPSBpIDwgdGhpcy5tX2NvdW50IC0gMSA/IGkxICsgMSA6IDA7XG4gICAgICAgICAgdmFyIHAgPSB0aGlzLm1fdmVydGljZXNbaTFdO1xuICAgICAgICAgIHN1YlZlYzIoZSQxLCB0aGlzLm1fdmVydGljZXNbaTJdLCBwKTtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9jb3VudDsgKytqKSB7XG4gICAgICAgICAgICBpZiAoaiA9PSBpMSB8fCBqID09IGkyKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGMyID0gY3Jvc3NWZWMyVmVjMihlJDEsIHN1YlZlYzIodGVtcCQxLCB0aGlzLm1fdmVydGljZXNbal0sIHApKTtcbiAgICAgICAgICAgIGlmIChjMiA8IDApIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlRGlzdGFuY2VQcm94eSA9IGZ1bmN0aW9uKHByb3h5KSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICBwcm94eS5tX3ZlcnRpY2VzW2ldID0gdGhpcy5tX3ZlcnRpY2VzW2ldO1xuICAgICAgICB9XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXMubGVuZ3RoID0gdGhpcy5tX2NvdW50O1xuICAgICAgICBwcm94eS5tX2NvdW50ID0gdGhpcy5tX2NvdW50O1xuICAgICAgICBwcm94eS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5UWVBFID0gXCJwb2x5Z29uXCI7XG4gICAgICByZXR1cm4gUG9seWdvblNoYXBlMjtcbiAgICB9KFNoYXBlKVxuICApO1xuICBmdW5jdGlvbiBjb21wdXRlQ2VudHJvaWQodnMsIGNvdW50KSB7XG4gICAgdmFyIGMyID0gVmVjMi56ZXJvKCk7XG4gICAgdmFyIGFyZWEgPSAwO1xuICAgIHZhciBwUmVmID0gVmVjMi56ZXJvKCk7XG4gICAgdmFyIGk7XG4gICAgdmFyIGludjMgPSAxIC8gMztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyArK2kpIHtcbiAgICAgIHZhciBwMSA9IHBSZWY7XG4gICAgICB2YXIgcDIgPSB2c1tpXTtcbiAgICAgIHZhciBwMyA9IGkgKyAxIDwgY291bnQgPyB2c1tpICsgMV0gOiB2c1swXTtcbiAgICAgIHZhciBlMV8xID0gVmVjMi5zdWIocDIsIHAxKTtcbiAgICAgIHZhciBlMl8xID0gVmVjMi5zdWIocDMsIHAxKTtcbiAgICAgIHZhciBEID0gVmVjMi5jcm9zc1ZlYzJWZWMyKGUxXzEsIGUyXzEpO1xuICAgICAgdmFyIHRyaWFuZ2xlQXJlYSA9IDAuNSAqIEQ7XG4gICAgICBhcmVhICs9IHRyaWFuZ2xlQXJlYTtcbiAgICAgIGNvbWJpbmUzVmVjMih0ZW1wJDEsIDEsIHAxLCAxLCBwMiwgMSwgcDMpO1xuICAgICAgcGx1c1NjYWxlVmVjMihjMiwgdHJpYW5nbGVBcmVhICogaW52MywgdGVtcCQxKTtcbiAgICB9XG4gICAgYzIubXVsKDEgLyBhcmVhKTtcbiAgICByZXR1cm4gYzI7XG4gIH1cbiAgdmFyIG1hdGhfc3FydCA9IE1hdGguc3FydDtcbiAgdmFyIG1hdGhfUEkkNCA9IE1hdGguUEk7XG4gIHZhciB0ZW1wID0gdmVjMigwLCAwKTtcbiAgdmFyIENpcmNsZVNoYXBlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhDaXJjbGVTaGFwZTIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBDaXJjbGVTaGFwZTIoYTIsIGIyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgQ2lyY2xlU2hhcGUyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgQ2lyY2xlU2hhcGUyKGEyLCBiMik7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBDaXJjbGVTaGFwZTIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9wID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fcmFkaXVzID0gMTtcbiAgICAgICAgaWYgKHR5cGVvZiBhMiA9PT0gXCJvYmplY3RcIiAmJiBWZWMyLmlzVmFsaWQoYTIpKSB7XG4gICAgICAgICAgX3RoaXMubV9wLnNldFZlYzIoYTIpO1xuICAgICAgICAgIGlmICh0eXBlb2YgYjIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIF90aGlzLm1fcmFkaXVzID0gYjI7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhMiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIF90aGlzLm1fcmFkaXVzID0gYTI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgcDogdGhpcy5tX3AsXG4gICAgICAgICAgcmFkaXVzOiB0aGlzLm1fcmFkaXVzXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDaXJjbGVTaGFwZTIoZGF0YS5wLCBkYXRhLnJhZGl1cyk7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuZ2V0UmFkaXVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuZ2V0Q2VudGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcDtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLl9jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgQ2lyY2xlU2hhcGUyKCk7XG4gICAgICAgIGNsb25lLm1fdHlwZSA9IHRoaXMubV90eXBlO1xuICAgICAgICBjbG9uZS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICAgIGNsb25lLm1fcCA9IHRoaXMubV9wLmNsb25lKCk7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLmdldENoaWxkQ291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS50ZXN0UG9pbnQgPSBmdW5jdGlvbih4ZjIsIHApIHtcbiAgICAgICAgdmFyIGNlbnRlcjIgPSB0cmFuc2Zvcm1WZWMyKHRlbXAsIHhmMiwgdGhpcy5tX3ApO1xuICAgICAgICByZXR1cm4gZGlzdFNxclZlYzIocCwgY2VudGVyMikgPD0gdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdmFyIHBvc2l0aW9uID0gVmVjMi5hZGQoeGYyLnAsIFJvdC5tdWxWZWMyKHhmMi5xLCB0aGlzLm1fcCkpO1xuICAgICAgICB2YXIgczIgPSBWZWMyLnN1YihpbnB1dDIucDEsIHBvc2l0aW9uKTtcbiAgICAgICAgdmFyIGIyID0gVmVjMi5kb3QoczIsIHMyKSAtIHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzO1xuICAgICAgICB2YXIgciA9IFZlYzIuc3ViKGlucHV0Mi5wMiwgaW5wdXQyLnAxKTtcbiAgICAgICAgdmFyIGMyID0gVmVjMi5kb3QoczIsIHIpO1xuICAgICAgICB2YXIgcnIgPSBWZWMyLmRvdChyLCByKTtcbiAgICAgICAgdmFyIHNpZ21hID0gYzIgKiBjMiAtIHJyICogYjI7XG4gICAgICAgIGlmIChzaWdtYSA8IDAgfHwgcnIgPCBFUFNJTE9OKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhMiA9IC0oYzIgKyBtYXRoX3NxcnQoc2lnbWEpKTtcbiAgICAgICAgaWYgKDAgPD0gYTIgJiYgYTIgPD0gaW5wdXQyLm1heEZyYWN0aW9uICogcnIpIHtcbiAgICAgICAgICBhMiAvPSBycjtcbiAgICAgICAgICBvdXRwdXQyLmZyYWN0aW9uID0gYTI7XG4gICAgICAgICAgb3V0cHV0Mi5ub3JtYWwgPSBWZWMyLmFkZChzMiwgVmVjMi5tdWxOdW1WZWMyKGEyLCByKSk7XG4gICAgICAgICAgb3V0cHV0Mi5ub3JtYWwubm9ybWFsaXplKCk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZUFBQkIgPSBmdW5jdGlvbihhYWJiLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdmFyIHAgPSB0cmFuc2Zvcm1WZWMyKHRlbXAsIHhmMiwgdGhpcy5tX3ApO1xuICAgICAgICBzZXRWZWMyKGFhYmIubG93ZXJCb3VuZCwgcC54IC0gdGhpcy5tX3JhZGl1cywgcC55IC0gdGhpcy5tX3JhZGl1cyk7XG4gICAgICAgIHNldFZlYzIoYWFiYi51cHBlckJvdW5kLCBwLnggKyB0aGlzLm1fcmFkaXVzLCBwLnkgKyB0aGlzLm1fcmFkaXVzKTtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLmNvbXB1dGVNYXNzID0gZnVuY3Rpb24obWFzc0RhdGEsIGRlbnNpdHkpIHtcbiAgICAgICAgbWFzc0RhdGEubWFzcyA9IGRlbnNpdHkgKiBtYXRoX1BJJDQgKiB0aGlzLm1fcmFkaXVzICogdGhpcy5tX3JhZGl1cztcbiAgICAgICAgY29weVZlYzIobWFzc0RhdGEuY2VudGVyLCB0aGlzLm1fcCk7XG4gICAgICAgIG1hc3NEYXRhLkkgPSBtYXNzRGF0YS5tYXNzICogKDAuNSAqIHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzICsgbGVuZ3RoU3FyVmVjMih0aGlzLm1fcCkpO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZURpc3RhbmNlUHJveHkgPSBmdW5jdGlvbihwcm94eSkge1xuICAgICAgICBwcm94eS5tX3ZlcnRpY2VzWzBdID0gdGhpcy5tX3A7XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXMubGVuZ3RoID0gMTtcbiAgICAgICAgcHJveHkubV9jb3VudCA9IDE7XG4gICAgICAgIHByb3h5Lm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIuVFlQRSA9IFwiY2lyY2xlXCI7XG4gICAgICByZXR1cm4gQ2lyY2xlU2hhcGUyO1xuICAgIH0oU2hhcGUpXG4gICk7XG4gIHZhciBtYXRoX2FicyQ1ID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX1BJJDMgPSBNYXRoLlBJO1xuICB2YXIgREVGQVVMVFMkYSA9IHtcbiAgICBmcmVxdWVuY3lIejogMCxcbiAgICBkYW1waW5nUmF0aW86IDBcbiAgfTtcbiAgdmFyIERpc3RhbmNlSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKERpc3RhbmNlSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gRGlzdGFuY2VKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvckEsIGFuY2hvckIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBEaXN0YW5jZUpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IERpc3RhbmNlSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3JBLCBhbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYm9keUIgJiYgYW5jaG9yQSAmJiBcIm1fdHlwZVwiIGluIGFuY2hvckEgJiYgXCJ4XCIgaW4gYm9keUIgJiYgXCJ5XCIgaW4gYm9keUIpIHtcbiAgICAgICAgICB2YXIgdGVtcDMgPSBib2R5QjtcbiAgICAgICAgICBib2R5QiA9IGFuY2hvckE7XG4gICAgICAgICAgYW5jaG9yQSA9IHRlbXAzO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyRhKTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IERpc3RhbmNlSm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShhbmNob3JBID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3JBKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yQiA/IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yQikgOiBkZWYubG9jYWxBbmNob3JCIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9sZW5ndGggPSBOdW1iZXIuaXNGaW5pdGUoZGVmLmxlbmd0aCkgPyBkZWYubGVuZ3RoIDogVmVjMi5kaXN0YW5jZShib2R5QS5nZXRXb3JsZFBvaW50KF90aGlzLm1fbG9jYWxBbmNob3JBKSwgYm9keUIuZ2V0V29ybGRQb2ludChfdGhpcy5tX2xvY2FsQW5jaG9yQikpO1xuICAgICAgICBfdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICBfdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICBfdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBmcmVxdWVuY3lIejogdGhpcy5tX2ZyZXF1ZW5jeUh6LFxuICAgICAgICAgIGRhbXBpbmdSYXRpbzogdGhpcy5tX2RhbXBpbmdSYXRpbyxcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCLFxuICAgICAgICAgIGxlbmd0aDogdGhpcy5tX2xlbmd0aCxcbiAgICAgICAgICBpbXB1bHNlOiB0aGlzLm1faW1wdWxzZSxcbiAgICAgICAgICBnYW1tYTogdGhpcy5tX2dhbW1hLFxuICAgICAgICAgIGJpYXM6IHRoaXMubV9iaWFzXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBEaXN0YW5jZUpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKGRlZi5hbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKHRoaXMubV9ib2R5QS5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JBKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMihkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIodGhpcy5tX2JvZHlCLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckIpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHRoaXMubV9sZW5ndGggPSArZGVmLmxlbmd0aDtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubGVuZ3RoIDwgMCkgO1xuICAgICAgICBlbHNlIGlmIChkZWYuYW5jaG9yQSB8fCBkZWYuYW5jaG9yQSB8fCBkZWYuYW5jaG9yQSB8fCBkZWYuYW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sZW5ndGggPSBWZWMyLmRpc3RhbmNlKHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpLCB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZnJlcXVlbmN5SHopKSB7XG4gICAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmRhbXBpbmdSYXRpbykpIHtcbiAgICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckE7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuc2V0TGVuZ3RoID0gZnVuY3Rpb24obGVuZ3RoKSB7XG4gICAgICAgIHRoaXMubV9sZW5ndGggPSBsZW5ndGg7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldExlbmd0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xlbmd0aDtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuc2V0RnJlcXVlbmN5ID0gZnVuY3Rpb24oaHopIHtcbiAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gaHo7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5zZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbihyYXRpbykge1xuICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gcmF0aW87XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2RhbXBpbmdSYXRpbztcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm11bE51bVZlYzIodGhpcy5tX2ltcHVsc2UsIHRoaXMubV91KS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdGhpcy5tX3UgPSBWZWMyLnN1YihWZWMyLmFkZChjQjIsIHRoaXMubV9yQiksIFZlYzIuYWRkKGNBMiwgdGhpcy5tX3JBKSk7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLm1fdS5sZW5ndGgoKTtcbiAgICAgICAgaWYgKGxlbmd0aCA+IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCkge1xuICAgICAgICAgIHRoaXMubV91Lm11bCgxIC8gbGVuZ3RoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdS5zZXROdW0oMCwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNyQXUgPSBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCB0aGlzLm1fdSk7XG4gICAgICAgIHZhciBjckJ1ID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgdGhpcy5tX3UpO1xuICAgICAgICB2YXIgaW52TWFzcyA9IHRoaXMubV9pbnZNYXNzQSArIHRoaXMubV9pbnZJQSAqIGNyQXUgKiBjckF1ICsgdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklCICogY3JCdSAqIGNyQnU7XG4gICAgICAgIHRoaXMubV9tYXNzID0gaW52TWFzcyAhPSAwID8gMSAvIGludk1hc3MgOiAwO1xuICAgICAgICBpZiAodGhpcy5tX2ZyZXF1ZW5jeUh6ID4gMCkge1xuICAgICAgICAgIHZhciBDID0gbGVuZ3RoIC0gdGhpcy5tX2xlbmd0aDtcbiAgICAgICAgICB2YXIgb21lZ2EgPSAyICogbWF0aF9QSSQzICogdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgICAgIHZhciBkMiA9IDIgKiB0aGlzLm1fbWFzcyAqIHRoaXMubV9kYW1waW5nUmF0aW8gKiBvbWVnYTtcbiAgICAgICAgICB2YXIgayA9IHRoaXMubV9tYXNzICogb21lZ2EgKiBvbWVnYTtcbiAgICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gaCAqIChkMiArIGggKiBrKTtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSB0aGlzLm1fZ2FtbWEgIT0gMCA/IDEgLyB0aGlzLm1fZ2FtbWEgOiAwO1xuICAgICAgICAgIHRoaXMubV9iaWFzID0gQyAqIGggKiBrICogdGhpcy5tX2dhbW1hO1xuICAgICAgICAgIGludk1hc3MgKz0gdGhpcy5tX2dhbW1hO1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gaW52TWFzcyAhPSAwID8gMSAvIGludk1hc3MgOiAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9nYW1tYSA9IDA7XG4gICAgICAgICAgdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIodGhpcy5tX2ltcHVsc2UsIHRoaXMubV91KTtcbiAgICAgICAgICB2QTIuc3ViTXVsKHRoaXMubV9pbnZNYXNzQSwgUDMpO1xuICAgICAgICAgIHdBIC09IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2cEEgPSBWZWMyLmFkZCh2QTIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgdmFyIHZwQiA9IFZlYzIuYWRkKHZCMiwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpO1xuICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuZG90KHRoaXMubV91LCB2cEIpIC0gVmVjMi5kb3QodGhpcy5tX3UsIHZwQSk7XG4gICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tYXNzICogKENkb3QgKyB0aGlzLm1fYmlhcyArIHRoaXMubV9nYW1tYSAqIHRoaXMubV9pbXB1bHNlKTtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UgKz0gaW1wdWxzZTtcbiAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIHRoaXMubV91KTtcbiAgICAgICAgdkEyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgd0EgLT0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpO1xuICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMyk7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgaWYgKHRoaXMubV9mcmVxdWVuY3lIeiA+IDApIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxTdWIocUEsIHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFN1YihxQiwgdGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQik7XG4gICAgICAgIHZhciB1ID0gVmVjMi5zdWIoVmVjMi5hZGQoY0IyLCByQjIpLCBWZWMyLmFkZChjQTIsIHJBMikpO1xuICAgICAgICB2YXIgbGVuZ3RoID0gdS5ub3JtYWxpemUoKTtcbiAgICAgICAgdmFyIEMgPSBjbGFtcChsZW5ndGggLSB0aGlzLm1fbGVuZ3RoLCAtU2V0dGluZ3NJbnRlcm5hbC5tYXhMaW5lYXJDb3JyZWN0aW9uLCBTZXR0aW5nc0ludGVybmFsLm1heExpbmVhckNvcnJlY3Rpb24pO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbWFzcyAqIEM7XG4gICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihpbXB1bHNlLCB1KTtcbiAgICAgICAgY0EyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgYUEgLT0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgUDMpO1xuICAgICAgICBjQjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICBhQiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBQMyk7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hID0gYUE7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBtYXRoX2FicyQ1KEMpIDwgU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLlRZUEUgPSBcImRpc3RhbmNlLWpvaW50XCI7XG4gICAgICByZXR1cm4gRGlzdGFuY2VKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIERFRkFVTFRTJDkgPSB7XG4gICAgbWF4Rm9yY2U6IDAsXG4gICAgbWF4VG9ycXVlOiAwXG4gIH07XG4gIHZhciBGcmljdGlvbkpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhGcmljdGlvbkpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIEZyaWN0aW9uSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBGcmljdGlvbkpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEZyaWN0aW9uSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQ5KTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IEZyaWN0aW9uSm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5QS5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JBIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckIgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xpbmVhckltcHVsc2UgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9hbmd1bGFySW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIF90aGlzLm1fbWF4VG9ycXVlID0gZGVmLm1heFRvcnF1ZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgbWF4Rm9yY2U6IHRoaXMubV9tYXhGb3JjZSxcbiAgICAgICAgICBtYXhUb3JxdWU6IHRoaXMubV9tYXhUb3JxdWUsXG4gICAgICAgICAgbG9jYWxBbmNob3JBOiB0aGlzLm1fbG9jYWxBbmNob3JBLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQlxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgRnJpY3Rpb25Kb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMih0aGlzLm1fYm9keUEuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQSkpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5hbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKHRoaXMubV9ib2R5Qi5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JCKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMihkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhGb3JjZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4VG9ycXVlKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhUb3JxdWUgPSBkZWYubWF4VG9ycXVlO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JCO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhGb3JjZSA9IGZ1bmN0aW9uKGZvcmNlKSB7XG4gICAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGZvcmNlO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhGb3JjZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heEZvcmNlO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhUb3JxdWUgPSBmdW5jdGlvbih0b3JxdWUpIHtcbiAgICAgICAgdGhpcy5tX21heFRvcnF1ZSA9IHRvcnF1ZTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0TWF4VG9ycXVlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4VG9ycXVlO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubXVsTnVtVmVjMihpbnZfZHQsIHRoaXMubV9saW5lYXJJbXB1bHNlKTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9hbmd1bGFySW1wdWxzZTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgSyA9IG5ldyBNYXQyMigpO1xuICAgICAgICBLLmV4LnggPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fckEueSAqIHRoaXMubV9yQS55ICsgaUIgKiB0aGlzLm1fckIueSAqIHRoaXMubV9yQi55O1xuICAgICAgICBLLmV4LnkgPSAtaUEgKiB0aGlzLm1fckEueCAqIHRoaXMubV9yQS55IC0gaUIgKiB0aGlzLm1fckIueCAqIHRoaXMubV9yQi55O1xuICAgICAgICBLLmV5LnggPSBLLmV4Lnk7XG4gICAgICAgIEsuZXkueSA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9yQS54ICogdGhpcy5tX3JBLnggKyBpQiAqIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLng7XG4gICAgICAgIHRoaXMubV9saW5lYXJNYXNzID0gSy5nZXRJbnZlcnNlKCk7XG4gICAgICAgIHRoaXMubV9hbmd1bGFyTWFzcyA9IGlBICsgaUI7XG4gICAgICAgIGlmICh0aGlzLm1fYW5ndWxhck1hc3MgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJNYXNzID0gMSAvIHRoaXMubV9hbmd1bGFyTWFzcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5tdWwoc3RlcC5kdFJhdGlvKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVvKHRoaXMubV9saW5lYXJJbXB1bHNlLngsIHRoaXMubV9saW5lYXJJbXB1bHNlLnkpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMykgKyB0aGlzLm1fYW5ndWxhckltcHVsc2UpO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMykgKyB0aGlzLm1fYW5ndWxhckltcHVsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IHdCIC0gd0E7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX2FuZ3VsYXJNYXNzICogQ2RvdDtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9hbmd1bGFySW1wdWxzZTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IGggKiB0aGlzLm1fbWF4VG9ycXVlO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFySW1wdWxzZSA9IGNsYW1wKHRoaXMubV9hbmd1bGFySW1wdWxzZSArIGltcHVsc2UsIC1tYXhJbXB1bHNlLCBtYXhJbXB1bHNlKTtcbiAgICAgICAgICBpbXB1bHNlID0gdGhpcy5tX2FuZ3VsYXJJbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2U7XG4gICAgICAgICAgd0IgKz0gaUIgKiBpbXB1bHNlO1xuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuc3ViKFZlYzIuYWRkKHZCMiwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpLCBWZWMyLmFkZCh2QTIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKSk7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSBWZWMyLm5lZyhNYXQyMi5tdWxWZWMyKHRoaXMubV9saW5lYXJNYXNzLCBDZG90KSk7XG4gICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fbGluZWFySW1wdWxzZTtcbiAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5hZGQoaW1wdWxzZSk7XG4gICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBoICogdGhpcy5tX21heEZvcmNlO1xuICAgICAgICAgIGlmICh0aGlzLm1fbGluZWFySW1wdWxzZS5sZW5ndGhTcXVhcmVkKCkgPiBtYXhJbXB1bHNlICogbWF4SW1wdWxzZSkge1xuICAgICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2Uubm9ybWFsaXplKCk7XG4gICAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5tdWwobWF4SW1wdWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGltcHVsc2UgPSBWZWMyLnN1Yih0aGlzLm1fbGluZWFySW1wdWxzZSwgb2xkSW1wdWxzZSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgaW1wdWxzZSk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBpbXB1bHNlKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBpbXB1bHNlKTtcbiAgICAgICAgICB3QiArPSBpQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIGltcHVsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLlRZUEUgPSBcImZyaWN0aW9uLWpvaW50XCI7XG4gICAgICByZXR1cm4gRnJpY3Rpb25Kb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIE1hdDMzID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIE1hdDMzMihhMiwgYjIsIGMyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYTIgPT09IFwib2JqZWN0XCIgJiYgYTIgIT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLmV4ID0gVmVjMy5jbG9uZShhMik7XG4gICAgICAgICAgdGhpcy5leSA9IFZlYzMuY2xvbmUoYjIpO1xuICAgICAgICAgIHRoaXMuZXogPSBWZWMzLmNsb25lKGMyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmV4ID0gVmVjMy56ZXJvKCk7XG4gICAgICAgICAgdGhpcy5leSA9IFZlYzMuemVybygpO1xuICAgICAgICAgIHRoaXMuZXogPSBWZWMzLnplcm8oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgTWF0MzMyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyk7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBWZWMzLmlzVmFsaWQob2JqLmV4KSAmJiBWZWMzLmlzVmFsaWQob2JqLmV5KSAmJiBWZWMzLmlzVmFsaWQob2JqLmV6KTtcbiAgICAgIH07XG4gICAgICBNYXQzMzIuYXNzZXJ0ID0gZnVuY3Rpb24obykge1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5wcm90b3R5cGUuc2V0WmVybyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmV4LnNldFplcm8oKTtcbiAgICAgICAgdGhpcy5leS5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMuZXouc2V0WmVybygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBNYXQzMzIucHJvdG90eXBlLnNvbHZlMzMgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICB2YXIgY3Jvc3NfeCA9IHRoaXMuZXkueSAqIHRoaXMuZXoueiAtIHRoaXMuZXkueiAqIHRoaXMuZXoueTtcbiAgICAgICAgdmFyIGNyb3NzX3kgPSB0aGlzLmV5LnogKiB0aGlzLmV6LnggLSB0aGlzLmV5LnggKiB0aGlzLmV6Lno7XG4gICAgICAgIHZhciBjcm9zc196ID0gdGhpcy5leS54ICogdGhpcy5lei55IC0gdGhpcy5leS55ICogdGhpcy5lei54O1xuICAgICAgICB2YXIgZGV0ID0gdGhpcy5leC54ICogY3Jvc3NfeCArIHRoaXMuZXgueSAqIGNyb3NzX3kgKyB0aGlzLmV4LnogKiBjcm9zc196O1xuICAgICAgICBpZiAoZGV0ICE9PSAwKSB7XG4gICAgICAgICAgZGV0ID0gMSAvIGRldDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgciA9IG5ldyBWZWMzKCk7XG4gICAgICAgIGNyb3NzX3ggPSB0aGlzLmV5LnkgKiB0aGlzLmV6LnogLSB0aGlzLmV5LnogKiB0aGlzLmV6Lnk7XG4gICAgICAgIGNyb3NzX3kgPSB0aGlzLmV5LnogKiB0aGlzLmV6LnggLSB0aGlzLmV5LnggKiB0aGlzLmV6Lno7XG4gICAgICAgIGNyb3NzX3ogPSB0aGlzLmV5LnggKiB0aGlzLmV6LnkgLSB0aGlzLmV5LnkgKiB0aGlzLmV6Lng7XG4gICAgICAgIHIueCA9IGRldCAqICh2My54ICogY3Jvc3NfeCArIHYzLnkgKiBjcm9zc195ICsgdjMueiAqIGNyb3NzX3opO1xuICAgICAgICBjcm9zc194ID0gdjMueSAqIHRoaXMuZXoueiAtIHYzLnogKiB0aGlzLmV6Lnk7XG4gICAgICAgIGNyb3NzX3kgPSB2My56ICogdGhpcy5lei54IC0gdjMueCAqIHRoaXMuZXouejtcbiAgICAgICAgY3Jvc3NfeiA9IHYzLnggKiB0aGlzLmV6LnkgLSB2My55ICogdGhpcy5lei54O1xuICAgICAgICByLnkgPSBkZXQgKiAodGhpcy5leC54ICogY3Jvc3NfeCArIHRoaXMuZXgueSAqIGNyb3NzX3kgKyB0aGlzLmV4LnogKiBjcm9zc196KTtcbiAgICAgICAgY3Jvc3NfeCA9IHRoaXMuZXkueSAqIHYzLnogLSB0aGlzLmV5LnogKiB2My55O1xuICAgICAgICBjcm9zc195ID0gdGhpcy5leS56ICogdjMueCAtIHRoaXMuZXkueCAqIHYzLno7XG4gICAgICAgIGNyb3NzX3ogPSB0aGlzLmV5LnggKiB2My55IC0gdGhpcy5leS55ICogdjMueDtcbiAgICAgICAgci56ID0gZGV0ICogKHRoaXMuZXgueCAqIGNyb3NzX3ggKyB0aGlzLmV4LnkgKiBjcm9zc195ICsgdGhpcy5leC56ICogY3Jvc3Nfeik7XG4gICAgICAgIHJldHVybiByO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5wcm90b3R5cGUuc29sdmUyMiA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHZhciBhMTEgPSB0aGlzLmV4Lng7XG4gICAgICAgIHZhciBhMTIgPSB0aGlzLmV5Lng7XG4gICAgICAgIHZhciBhMjEgPSB0aGlzLmV4Lnk7XG4gICAgICAgIHZhciBhMjIgPSB0aGlzLmV5Lnk7XG4gICAgICAgIHZhciBkZXQgPSBhMTEgKiBhMjIgLSBhMTIgKiBhMjE7XG4gICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICBkZXQgPSAxIC8gZGV0O1xuICAgICAgICB9XG4gICAgICAgIHZhciByID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHIueCA9IGRldCAqIChhMjIgKiB2My54IC0gYTEyICogdjMueSk7XG4gICAgICAgIHIueSA9IGRldCAqIChhMTEgKiB2My55IC0gYTIxICogdjMueCk7XG4gICAgICAgIHJldHVybiByO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5wcm90b3R5cGUuZ2V0SW52ZXJzZTIyID0gZnVuY3Rpb24oTSkge1xuICAgICAgICB2YXIgYTIgPSB0aGlzLmV4Lng7XG4gICAgICAgIHZhciBiMiA9IHRoaXMuZXkueDtcbiAgICAgICAgdmFyIGMyID0gdGhpcy5leC55O1xuICAgICAgICB2YXIgZDIgPSB0aGlzLmV5Lnk7XG4gICAgICAgIHZhciBkZXQgPSBhMiAqIGQyIC0gYjIgKiBjMjtcbiAgICAgICAgaWYgKGRldCAhPT0gMCkge1xuICAgICAgICAgIGRldCA9IDEgLyBkZXQ7XG4gICAgICAgIH1cbiAgICAgICAgTS5leC54ID0gZGV0ICogZDI7XG4gICAgICAgIE0uZXkueCA9IC1kZXQgKiBiMjtcbiAgICAgICAgTS5leC56ID0gMDtcbiAgICAgICAgTS5leC55ID0gLWRldCAqIGMyO1xuICAgICAgICBNLmV5LnkgPSBkZXQgKiBhMjtcbiAgICAgICAgTS5leS56ID0gMDtcbiAgICAgICAgTS5lei54ID0gMDtcbiAgICAgICAgTS5lei55ID0gMDtcbiAgICAgICAgTS5lei56ID0gMDtcbiAgICAgIH07XG4gICAgICBNYXQzMzIucHJvdG90eXBlLmdldFN5bUludmVyc2UzMyA9IGZ1bmN0aW9uKE0pIHtcbiAgICAgICAgdmFyIGRldCA9IFZlYzMuZG90KHRoaXMuZXgsIFZlYzMuY3Jvc3ModGhpcy5leSwgdGhpcy5leikpO1xuICAgICAgICBpZiAoZGV0ICE9PSAwKSB7XG4gICAgICAgICAgZGV0ID0gMSAvIGRldDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYTExID0gdGhpcy5leC54O1xuICAgICAgICB2YXIgYTEyID0gdGhpcy5leS54O1xuICAgICAgICB2YXIgYTEzID0gdGhpcy5lei54O1xuICAgICAgICB2YXIgYTIyID0gdGhpcy5leS55O1xuICAgICAgICB2YXIgYTIzID0gdGhpcy5lei55O1xuICAgICAgICB2YXIgYTMzID0gdGhpcy5lei56O1xuICAgICAgICBNLmV4LnggPSBkZXQgKiAoYTIyICogYTMzIC0gYTIzICogYTIzKTtcbiAgICAgICAgTS5leC55ID0gZGV0ICogKGExMyAqIGEyMyAtIGExMiAqIGEzMyk7XG4gICAgICAgIE0uZXgueiA9IGRldCAqIChhMTIgKiBhMjMgLSBhMTMgKiBhMjIpO1xuICAgICAgICBNLmV5LnggPSBNLmV4Lnk7XG4gICAgICAgIE0uZXkueSA9IGRldCAqIChhMTEgKiBhMzMgLSBhMTMgKiBhMTMpO1xuICAgICAgICBNLmV5LnogPSBkZXQgKiAoYTEzICogYTEyIC0gYTExICogYTIzKTtcbiAgICAgICAgTS5lei54ID0gTS5leC56O1xuICAgICAgICBNLmV6LnkgPSBNLmV5Lno7XG4gICAgICAgIE0uZXoueiA9IGRldCAqIChhMTEgKiBhMjIgLSBhMTIgKiBhMTIpO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5tdWwgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgaWYgKGIyICYmIFwielwiIGluIGIyICYmIFwieVwiIGluIGIyICYmIFwieFwiIGluIGIyKSB7XG4gICAgICAgICAgdmFyIHgyID0gYTIuZXgueCAqIGIyLnggKyBhMi5leS54ICogYjIueSArIGEyLmV6LnggKiBiMi56O1xuICAgICAgICAgIHZhciB5ID0gYTIuZXgueSAqIGIyLnggKyBhMi5leS55ICogYjIueSArIGEyLmV6LnkgKiBiMi56O1xuICAgICAgICAgIHZhciB6ID0gYTIuZXgueiAqIGIyLnggKyBhMi5leS56ICogYjIueSArIGEyLmV6LnogKiBiMi56O1xuICAgICAgICAgIHJldHVybiBuZXcgVmVjMyh4MiwgeSwgeik7XG4gICAgICAgIH0gZWxzZSBpZiAoYjIgJiYgXCJ5XCIgaW4gYjIgJiYgXCJ4XCIgaW4gYjIpIHtcbiAgICAgICAgICB2YXIgeDIgPSBhMi5leC54ICogYjIueCArIGEyLmV5LnggKiBiMi55O1xuICAgICAgICAgIHZhciB5ID0gYTIuZXgueSAqIGIyLnggKyBhMi5leS55ICogYjIueTtcbiAgICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgTWF0MzMyLm11bFZlYzMgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIHgyID0gYTIuZXgueCAqIGIyLnggKyBhMi5leS54ICogYjIueSArIGEyLmV6LnggKiBiMi56O1xuICAgICAgICB2YXIgeSA9IGEyLmV4LnkgKiBiMi54ICsgYTIuZXkueSAqIGIyLnkgKyBhMi5lei55ICogYjIuejtcbiAgICAgICAgdmFyIHogPSBhMi5leC56ICogYjIueCArIGEyLmV5LnogKiBiMi55ICsgYTIuZXoueiAqIGIyLno7XG4gICAgICAgIHJldHVybiBuZXcgVmVjMyh4MiwgeSwgeik7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLm11bFZlYzIgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIHgyID0gYTIuZXgueCAqIGIyLnggKyBhMi5leS54ICogYjIueTtcbiAgICAgICAgdmFyIHkgPSBhMi5leC55ICogYjIueCArIGEyLmV5LnkgKiBiMi55O1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5hZGQgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXQzMzIoVmVjMy5hZGQoYTIuZXgsIGIyLmV4KSwgVmVjMy5hZGQoYTIuZXksIGIyLmV5KSwgVmVjMy5hZGQoYTIuZXosIGIyLmV6KSk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIE1hdDMzMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfYWJzJDQgPSBNYXRoLmFicztcbiAgdmFyIExpbWl0U3RhdGUkMjtcbiAgKGZ1bmN0aW9uKExpbWl0U3RhdGUyKSB7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJpbmFjdGl2ZUxpbWl0XCJdID0gMF0gPSBcImluYWN0aXZlTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImF0TG93ZXJMaW1pdFwiXSA9IDFdID0gXCJhdExvd2VyTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImF0VXBwZXJMaW1pdFwiXSA9IDJdID0gXCJhdFVwcGVyTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImVxdWFsTGltaXRzXCJdID0gM10gPSBcImVxdWFsTGltaXRzXCI7XG4gIH0pKExpbWl0U3RhdGUkMiB8fCAoTGltaXRTdGF0ZSQyID0ge30pKTtcbiAgdmFyIERFRkFVTFRTJDggPSB7XG4gICAgbG93ZXJBbmdsZTogMCxcbiAgICB1cHBlckFuZ2xlOiAwLFxuICAgIG1heE1vdG9yVG9ycXVlOiAwLFxuICAgIG1vdG9yU3BlZWQ6IDAsXG4gICAgZW5hYmxlTGltaXQ6IGZhbHNlLFxuICAgIGVuYWJsZU1vdG9yOiBmYWxzZVxuICB9O1xuICB2YXIgUmV2b2x1dGVKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoUmV2b2x1dGVKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBSZXZvbHV0ZUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBfYTIsIF9iLCBfYywgX2QsIF9lLCBfZjtcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBSZXZvbHV0ZUpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFJldm9sdXRlSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IGRlZiAhPT0gbnVsbCAmJiBkZWYgIT09IHZvaWQgMCA/IGRlZiA6IHt9O1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV9tYXNzID0gbmV3IE1hdDMzKCk7XG4gICAgICAgIF90aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMi5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBSZXZvbHV0ZUpvaW50Mi5UWVBFO1xuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGFuY2hvcikpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yKTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmLmxvY2FsQW5jaG9yQSkpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGFuY2hvcikpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yKTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmLmxvY2FsQW5jaG9yQikpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5yZWZlcmVuY2VBbmdsZSkpIHtcbiAgICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlID0gZGVmLnJlZmVyZW5jZUFuZ2xlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBib2R5Qi5nZXRBbmdsZSgpIC0gYm9keUEuZ2V0QW5nbGUoKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSBuZXcgVmVjMygpO1xuICAgICAgICBfdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbG93ZXJBbmdsZSA9IChfYTIgPSBkZWYubG93ZXJBbmdsZSkgIT09IG51bGwgJiYgX2EyICE9PSB2b2lkIDAgPyBfYTIgOiBERUZBVUxUUyQ4Lmxvd2VyQW5nbGU7XG4gICAgICAgIF90aGlzLm1fdXBwZXJBbmdsZSA9IChfYiA9IGRlZi51cHBlckFuZ2xlKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBERUZBVUxUUyQ4LnVwcGVyQW5nbGU7XG4gICAgICAgIF90aGlzLm1fbWF4TW90b3JUb3JxdWUgPSAoX2MgPSBkZWYubWF4TW90b3JUb3JxdWUpICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6IERFRkFVTFRTJDgubWF4TW90b3JUb3JxdWU7XG4gICAgICAgIF90aGlzLm1fbW90b3JTcGVlZCA9IChfZCA9IGRlZi5tb3RvclNwZWVkKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiBERUZBVUxUUyQ4Lm1vdG9yU3BlZWQ7XG4gICAgICAgIF90aGlzLm1fZW5hYmxlTGltaXQgPSAoX2UgPSBkZWYuZW5hYmxlTGltaXQpICE9PSBudWxsICYmIF9lICE9PSB2b2lkIDAgPyBfZSA6IERFRkFVTFRTJDguZW5hYmxlTGltaXQ7XG4gICAgICAgIF90aGlzLm1fZW5hYmxlTW90b3IgPSAoX2YgPSBkZWYuZW5hYmxlTW90b3IpICE9PSBudWxsICYmIF9mICE9PSB2b2lkIDAgPyBfZiA6IERFRkFVTFRTJDguZW5hYmxlTW90b3I7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGxvd2VyQW5nbGU6IHRoaXMubV9sb3dlckFuZ2xlLFxuICAgICAgICAgIHVwcGVyQW5nbGU6IHRoaXMubV91cHBlckFuZ2xlLFxuICAgICAgICAgIG1heE1vdG9yVG9ycXVlOiB0aGlzLm1fbWF4TW90b3JUb3JxdWUsXG4gICAgICAgICAgbW90b3JTcGVlZDogdGhpcy5tX21vdG9yU3BlZWQsXG4gICAgICAgICAgZW5hYmxlTGltaXQ6IHRoaXMubV9lbmFibGVMaW1pdCxcbiAgICAgICAgICBlbmFibGVNb3RvcjogdGhpcy5tX2VuYWJsZU1vdG9yLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckIsXG4gICAgICAgICAgcmVmZXJlbmNlQW5nbGU6IHRoaXMubV9yZWZlcmVuY2VBbmdsZVxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgUmV2b2x1dGVKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMih0aGlzLm1fYm9keUEuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQSkpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5hbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKHRoaXMubV9ib2R5Qi5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JCKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMihkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5yZWZlcmVuY2VBbmdsZSkpIHtcbiAgICAgICAgICB0aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBkZWYucmVmZXJlbmNlQW5nbGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5lbmFibGVMaW1pdCAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gZGVmLmVuYWJsZUxpbWl0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmxvd2VyQW5nbGUpKSB7XG4gICAgICAgICAgdGhpcy5tX2xvd2VyQW5nbGUgPSBkZWYubG93ZXJBbmdsZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi51cHBlckFuZ2xlKSkge1xuICAgICAgICAgIHRoaXMubV91cHBlckFuZ2xlID0gZGVmLnVwcGVyQW5nbGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4TW90b3JUb3JxdWUpKSB7XG4gICAgICAgICAgdGhpcy5tX21heE1vdG9yVG9ycXVlID0gZGVmLm1heE1vdG9yVG9ycXVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1vdG9yU3BlZWQpKSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmVuYWJsZU1vdG9yICE9PSB2b2lkIDApIHtcbiAgICAgICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBkZWYuZW5hYmxlTW90b3I7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldFJlZmVyZW5jZUFuZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldEpvaW50QW5nbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICAgIHJldHVybiBiQi5tX3N3ZWVwLmEgLSBiQS5tX3N3ZWVwLmEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldEpvaW50U3BlZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICAgIHJldHVybiBiQi5tX2FuZ3VsYXJWZWxvY2l0eSAtIGJBLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5pc01vdG9yRW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZU1vdG9yO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5lbmFibGVNb3RvciA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcgPT0gdGhpcy5tX2VuYWJsZU1vdG9yKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGZsYWc7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldE1vdG9yVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5zZXRNb3RvclNwZWVkID0gZnVuY3Rpb24oc3BlZWQpIHtcbiAgICAgICAgaWYgKHNwZWVkID09IHRoaXMubV9tb3RvclNwZWVkKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9tb3RvclNwZWVkID0gc3BlZWQ7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldE1vdG9yU3BlZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tb3RvclNwZWVkO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhNb3RvclRvcnF1ZSA9IGZ1bmN0aW9uKHRvcnF1ZSkge1xuICAgICAgICBpZiAodG9ycXVlID09IHRoaXMubV9tYXhNb3RvclRvcnF1ZSlcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fbWF4TW90b3JUb3JxdWUgPSB0b3JxdWU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldE1heE1vdG9yVG9ycXVlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4TW90b3JUb3JxdWU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmlzTGltaXRFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTGltaXQ7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmVuYWJsZUxpbWl0ID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAoZmxhZyAhPSB0aGlzLm1fZW5hYmxlTGltaXQpIHtcbiAgICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9IGZsYWc7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0TG93ZXJMaW1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvd2VyQW5nbGU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldFVwcGVyTGltaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV91cHBlckFuZ2xlO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5zZXRMaW1pdHMgPSBmdW5jdGlvbihsb3dlciwgdXBwZXIpIHtcbiAgICAgICAgaWYgKGxvd2VyICE9IHRoaXMubV9sb3dlckFuZ2xlIHx8IHVwcGVyICE9IHRoaXMubV91cHBlckFuZ2xlKSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICB0aGlzLm1fbG93ZXJBbmdsZSA9IGxvd2VyO1xuICAgICAgICAgIHRoaXMubV91cHBlckFuZ2xlID0gdXBwZXI7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh0aGlzLm1faW1wdWxzZS54LCB0aGlzLm1faW1wdWxzZS55KS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLno7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHRoaXMubV9yQSA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIGZpeGVkUm90YXRpb24gPSBpQSArIGlCID09PSAwO1xuICAgICAgICB0aGlzLm1fbWFzcy5leC54ID0gbUEgKyBtQiArIHRoaXMubV9yQS55ICogdGhpcy5tX3JBLnkgKiBpQSArIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnkgKiBpQjtcbiAgICAgICAgdGhpcy5tX21hc3MuZXkueCA9IC10aGlzLm1fckEueSAqIHRoaXMubV9yQS54ICogaUEgLSB0aGlzLm1fckIueSAqIHRoaXMubV9yQi54ICogaUI7XG4gICAgICAgIHRoaXMubV9tYXNzLmV6LnggPSAtdGhpcy5tX3JBLnkgKiBpQSAtIHRoaXMubV9yQi55ICogaUI7XG4gICAgICAgIHRoaXMubV9tYXNzLmV4LnkgPSB0aGlzLm1fbWFzcy5leS54O1xuICAgICAgICB0aGlzLm1fbWFzcy5leS55ID0gbUEgKyBtQiArIHRoaXMubV9yQS54ICogdGhpcy5tX3JBLnggKiBpQSArIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLnggKiBpQjtcbiAgICAgICAgdGhpcy5tX21hc3MuZXoueSA9IHRoaXMubV9yQS54ICogaUEgKyB0aGlzLm1fckIueCAqIGlCO1xuICAgICAgICB0aGlzLm1fbWFzcy5leC56ID0gdGhpcy5tX21hc3MuZXoueDtcbiAgICAgICAgdGhpcy5tX21hc3MuZXkueiA9IHRoaXMubV9tYXNzLmV6Lnk7XG4gICAgICAgIHRoaXMubV9tYXNzLmV6LnogPSBpQSArIGlCO1xuICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gaUEgKyBpQjtcbiAgICAgICAgaWYgKHRoaXMubV9tb3Rvck1hc3MgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IDEgLyB0aGlzLm1fbW90b3JNYXNzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgPT0gZmFsc2UgfHwgZml4ZWRSb3RhdGlvbikge1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQgJiYgZml4ZWRSb3RhdGlvbiA9PSBmYWxzZSkge1xuICAgICAgICAgIHZhciBqb2ludEFuZ2xlID0gYUIgLSBhQSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICBpZiAobWF0aF9hYnMkNCh0aGlzLm1fdXBwZXJBbmdsZSAtIHRoaXMubV9sb3dlckFuZ2xlKSA8IDIgKiBTZXR0aW5nc0ludGVybmFsLmFuZ3VsYXJTbG9wKSB7XG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMi5lcXVhbExpbWl0cztcbiAgICAgICAgICB9IGVsc2UgaWYgKGpvaW50QW5nbGUgPD0gdGhpcy5tX2xvd2VyQW5nbGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDIuYXRMb3dlckxpbWl0KSB7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDIuYXRMb3dlckxpbWl0O1xuICAgICAgICAgIH0gZWxzZSBpZiAoam9pbnRBbmdsZSA+PSB0aGlzLm1fdXBwZXJBbmdsZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMi5hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMi5hdFVwcGVyTGltaXQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQyLmluYWN0aXZlTGltaXQ7XG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDIuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5tdWwoc3RlcC5kdFJhdGlvKTtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm5lbyh0aGlzLm1faW1wdWxzZS54LCB0aGlzLm1faW1wdWxzZS55KTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpICsgdGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMykgKyB0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2Uuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgZml4ZWRSb3RhdGlvbiA9IGlBICsgaUIgPT09IDA7XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQyLmVxdWFsTGltaXRzICYmIGZpeGVkUm90YXRpb24gPT0gZmFsc2UpIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IHdCIC0gd0EgLSB0aGlzLm1fbW90b3JTcGVlZDtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbW90b3JNYXNzICogQ2RvdDtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heE1vdG9yVG9ycXVlO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSBjbGFtcCh0aGlzLm1fbW90b3JJbXB1bHNlICsgaW1wdWxzZSwgLW1heEltcHVsc2UsIG1heEltcHVsc2UpO1xuICAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2U7XG4gICAgICAgICAgd0IgKz0gaUIgKiBpbXB1bHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQyLmluYWN0aXZlTGltaXQgJiYgZml4ZWRSb3RhdGlvbiA9PSBmYWxzZSkge1xuICAgICAgICAgIHZhciBDZG90MSA9IFZlYzIuemVybygpO1xuICAgICAgICAgIENkb3QxLmFkZENvbWJpbmUoMSwgdkIyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKSk7XG4gICAgICAgICAgQ2RvdDEuc3ViQ29tYmluZSgxLCB2QTIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgICB2YXIgQ2RvdDIgPSB3QiAtIHdBO1xuICAgICAgICAgIHZhciBDZG90ID0gbmV3IFZlYzMoQ2RvdDEueCwgQ2RvdDEueSwgQ2RvdDIpO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gVmVjMy5uZWcodGhpcy5tX21hc3Muc29sdmUzMyhDZG90KSk7XG4gICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IExpbWl0U3RhdGUkMi5lcXVhbExpbWl0cykge1xuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UuYWRkKGltcHVsc2UpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQyLmF0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgdmFyIG5ld0ltcHVsc2UgPSB0aGlzLm1faW1wdWxzZS56ICsgaW1wdWxzZS56O1xuICAgICAgICAgICAgaWYgKG5ld0ltcHVsc2UgPCAwKSB7XG4gICAgICAgICAgICAgIHZhciByaHMgPSBWZWMyLmNvbWJpbmUoLTEsIENkb3QxLCB0aGlzLm1faW1wdWxzZS56LCBWZWMyLm5lbyh0aGlzLm1fbWFzcy5lei54LCB0aGlzLm1fbWFzcy5lei55KSk7XG4gICAgICAgICAgICAgIHZhciByZWR1Y2VkID0gdGhpcy5tX21hc3Muc29sdmUyMihyaHMpO1xuICAgICAgICAgICAgICBpbXB1bHNlLnggPSByZWR1Y2VkLng7XG4gICAgICAgICAgICAgIGltcHVsc2UueSA9IHJlZHVjZWQueTtcbiAgICAgICAgICAgICAgaW1wdWxzZS56ID0gLXRoaXMubV9pbXB1bHNlLno7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKz0gcmVkdWNlZC54O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ICs9IHJlZHVjZWQueTtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS5hZGQoaW1wdWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBMaW1pdFN0YXRlJDIuYXRVcHBlckxpbWl0KSB7XG4gICAgICAgICAgICB2YXIgbmV3SW1wdWxzZSA9IHRoaXMubV9pbXB1bHNlLnogKyBpbXB1bHNlLno7XG4gICAgICAgICAgICBpZiAobmV3SW1wdWxzZSA+IDApIHtcbiAgICAgICAgICAgICAgdmFyIHJocyA9IFZlYzIuY29tYmluZSgtMSwgQ2RvdDEsIHRoaXMubV9pbXB1bHNlLnosIFZlYzIubmVvKHRoaXMubV9tYXNzLmV6LngsIHRoaXMubV9tYXNzLmV6LnkpKTtcbiAgICAgICAgICAgICAgdmFyIHJlZHVjZWQgPSB0aGlzLm1fbWFzcy5zb2x2ZTIyKHJocyk7XG4gICAgICAgICAgICAgIGltcHVsc2UueCA9IHJlZHVjZWQueDtcbiAgICAgICAgICAgICAgaW1wdWxzZS55ID0gcmVkdWNlZC55O1xuICAgICAgICAgICAgICBpbXB1bHNlLnogPSAtdGhpcy5tX2ltcHVsc2UuejtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSByZWR1Y2VkLng7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gcmVkdWNlZC55O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLmFkZChpbXB1bHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5uZW8oaW1wdWxzZS54LCBpbXB1bHNlLnkpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMykgKyBpbXB1bHNlLnopO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMykgKyBpbXB1bHNlLnopO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBDZG90ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQ2RvdC5hZGRDb21iaW5lKDEsIHZCMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpO1xuICAgICAgICAgIENkb3Quc3ViQ29tYmluZSgxLCB2QTIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IHRoaXMubV9tYXNzLnNvbHZlMjIoVmVjMi5uZWcoQ2RvdCkpO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKz0gaW1wdWxzZS54O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gaW1wdWxzZS55O1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIGltcHVsc2UpO1xuICAgICAgICAgIHdBIC09IGlBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgaW1wdWxzZSk7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgaW1wdWxzZSk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBpbXB1bHNlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIGFuZ3VsYXJFcnJvciA9IDA7XG4gICAgICAgIHZhciBwb3NpdGlvbkVycm9yID0gMDtcbiAgICAgICAgdmFyIGZpeGVkUm90YXRpb24gPSB0aGlzLm1faW52SUEgKyB0aGlzLm1faW52SUIgPT0gMDtcbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDIuaW5hY3RpdmVMaW1pdCAmJiBmaXhlZFJvdGF0aW9uID09IGZhbHNlKSB7XG4gICAgICAgICAgdmFyIGFuZ2xlID0gYUIgLSBhQSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICB2YXIgbGltaXRJbXB1bHNlID0gMDtcbiAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQyLmVxdWFsTGltaXRzKSB7XG4gICAgICAgICAgICB2YXIgQyA9IGNsYW1wKGFuZ2xlIC0gdGhpcy5tX2xvd2VyQW5nbGUsIC1TZXR0aW5nc0ludGVybmFsLm1heEFuZ3VsYXJDb3JyZWN0aW9uLCBTZXR0aW5nc0ludGVybmFsLm1heEFuZ3VsYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgICAgIGxpbWl0SW1wdWxzZSA9IC10aGlzLm1fbW90b3JNYXNzICogQztcbiAgICAgICAgICAgIGFuZ3VsYXJFcnJvciA9IG1hdGhfYWJzJDQoQyk7XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBMaW1pdFN0YXRlJDIuYXRMb3dlckxpbWl0KSB7XG4gICAgICAgICAgICB2YXIgQyA9IGFuZ2xlIC0gdGhpcy5tX2xvd2VyQW5nbGU7XG4gICAgICAgICAgICBhbmd1bGFyRXJyb3IgPSAtQztcbiAgICAgICAgICAgIEMgPSBjbGFtcChDICsgU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcCwgLVNldHRpbmdzSW50ZXJuYWwubWF4QW5ndWxhckNvcnJlY3Rpb24sIDApO1xuICAgICAgICAgICAgbGltaXRJbXB1bHNlID0gLXRoaXMubV9tb3Rvck1hc3MgKiBDO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQyLmF0VXBwZXJMaW1pdCkge1xuICAgICAgICAgICAgdmFyIEMgPSBhbmdsZSAtIHRoaXMubV91cHBlckFuZ2xlO1xuICAgICAgICAgICAgYW5ndWxhckVycm9yID0gQztcbiAgICAgICAgICAgIEMgPSBjbGFtcChDIC0gU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcCwgMCwgU2V0dGluZ3NJbnRlcm5hbC5tYXhBbmd1bGFyQ29ycmVjdGlvbik7XG4gICAgICAgICAgICBsaW1pdEltcHVsc2UgPSAtdGhpcy5tX21vdG9yTWFzcyAqIEM7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFBIC09IHRoaXMubV9pbnZJQSAqIGxpbWl0SW1wdWxzZTtcbiAgICAgICAgICBhQiArPSB0aGlzLm1faW52SUIgKiBsaW1pdEltcHVsc2U7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIHFBLnNldEFuZ2xlKGFBKTtcbiAgICAgICAgICBxQi5zZXRBbmdsZShhQik7XG4gICAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgICAgdmFyIEMgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBDLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICAgIEMuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHJBMik7XG4gICAgICAgICAgcG9zaXRpb25FcnJvciA9IEMubGVuZ3RoKCk7XG4gICAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICAgIHZhciBLID0gbmV3IE1hdDIyKCk7XG4gICAgICAgICAgSy5leC54ID0gbUEgKyBtQiArIGlBICogckEyLnkgKiByQTIueSArIGlCICogckIyLnkgKiByQjIueTtcbiAgICAgICAgICBLLmV4LnkgPSAtaUEgKiByQTIueCAqIHJBMi55IC0gaUIgKiByQjIueCAqIHJCMi55O1xuICAgICAgICAgIEsuZXkueCA9IEsuZXgueTtcbiAgICAgICAgICBLLmV5LnkgPSBtQSArIG1CICsgaUEgKiByQTIueCAqIHJBMi54ICsgaUIgKiByQjIueCAqIHJCMi54O1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gVmVjMi5uZWcoSy5zb2x2ZShDKSk7XG4gICAgICAgICAgY0EyLnN1Yk11bChtQSwgaW1wdWxzZSk7XG4gICAgICAgICAgYUEgLT0gaUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCBpbXB1bHNlKTtcbiAgICAgICAgICBjQjIuYWRkTXVsKG1CLCBpbXB1bHNlKTtcbiAgICAgICAgICBhQiArPSBpQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIGltcHVsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hID0gYUE7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBwb3NpdGlvbkVycm9yIDw9IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCAmJiBhbmd1bGFyRXJyb3IgPD0gU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcDtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5UWVBFID0gXCJyZXZvbHV0ZS1qb2ludFwiO1xuICAgICAgcmV0dXJuIFJldm9sdXRlSm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBtYXRoX2FicyQzID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX21heCA9IE1hdGgubWF4O1xuICB2YXIgbWF0aF9taW4kMiA9IE1hdGgubWluO1xuICB2YXIgTGltaXRTdGF0ZSQxO1xuICAoZnVuY3Rpb24oTGltaXRTdGF0ZTIpIHtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImluYWN0aXZlTGltaXRcIl0gPSAwXSA9IFwiaW5hY3RpdmVMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiYXRMb3dlckxpbWl0XCJdID0gMV0gPSBcImF0TG93ZXJMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiYXRVcHBlckxpbWl0XCJdID0gMl0gPSBcImF0VXBwZXJMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiZXF1YWxMaW1pdHNcIl0gPSAzXSA9IFwiZXF1YWxMaW1pdHNcIjtcbiAgfSkoTGltaXRTdGF0ZSQxIHx8IChMaW1pdFN0YXRlJDEgPSB7fSkpO1xuICB2YXIgREVGQVVMVFMkNyA9IHtcbiAgICBlbmFibGVMaW1pdDogZmFsc2UsXG4gICAgbG93ZXJUcmFuc2xhdGlvbjogMCxcbiAgICB1cHBlclRyYW5zbGF0aW9uOiAwLFxuICAgIGVuYWJsZU1vdG9yOiBmYWxzZSxcbiAgICBtYXhNb3RvckZvcmNlOiAwLFxuICAgIG1vdG9yU3BlZWQ6IDBcbiAgfTtcbiAgdmFyIFByaXNtYXRpY0pvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhQcmlzbWF0aWNKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBQcmlzbWF0aWNKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvciwgYXhpcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIFByaXNtYXRpY0pvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFByaXNtYXRpY0pvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yLCBheGlzKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkNyk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBQcmlzbWF0aWNKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxYQXhpc0EgPSBWZWMyLmNsb25lKGF4aXMgPyBib2R5QS5nZXRMb2NhbFZlY3RvcihheGlzKSA6IGRlZi5sb2NhbEF4aXNBIHx8IFZlYzIubmVvKDEsIDApKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbFhBeGlzQS5ub3JtYWxpemUoKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbFlBeGlzQSA9IFZlYzIuY3Jvc3NOdW1WZWMyKDEsIF90aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlID0gTnVtYmVyLmlzRmluaXRlKGRlZi5yZWZlcmVuY2VBbmdsZSkgPyBkZWYucmVmZXJlbmNlQW5nbGUgOiBib2R5Qi5nZXRBbmdsZSgpIC0gYm9keUEuZ2V0QW5nbGUoKTtcbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gbmV3IFZlYzMoKTtcbiAgICAgICAgX3RoaXMubV9tb3Rvck1hc3MgPSAwO1xuICAgICAgICBfdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGRlZi5sb3dlclRyYW5zbGF0aW9uO1xuICAgICAgICBfdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gPSBkZWYudXBwZXJUcmFuc2xhdGlvbjtcbiAgICAgICAgX3RoaXMubV9tYXhNb3RvckZvcmNlID0gZGVmLm1heE1vdG9yRm9yY2U7XG4gICAgICAgIF90aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xuICAgICAgICBfdGhpcy5tX2VuYWJsZUxpbWl0ID0gZGVmLmVuYWJsZUxpbWl0O1xuICAgICAgICBfdGhpcy5tX2VuYWJsZU1vdG9yID0gZGVmLmVuYWJsZU1vdG9yO1xuICAgICAgICBfdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDEuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgX3RoaXMubV9heGlzID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fcGVycCA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX0sgPSBuZXcgTWF0MzMoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGxvd2VyVHJhbnNsYXRpb246IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uLFxuICAgICAgICAgIHVwcGVyVHJhbnNsYXRpb246IHRoaXMubV91cHBlclRyYW5zbGF0aW9uLFxuICAgICAgICAgIG1heE1vdG9yRm9yY2U6IHRoaXMubV9tYXhNb3RvckZvcmNlLFxuICAgICAgICAgIG1vdG9yU3BlZWQ6IHRoaXMubV9tb3RvclNwZWVkLFxuICAgICAgICAgIGVuYWJsZUxpbWl0OiB0aGlzLm1fZW5hYmxlTGltaXQsXG4gICAgICAgICAgZW5hYmxlTW90b3I6IHRoaXMubV9lbmFibGVNb3RvcixcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCLFxuICAgICAgICAgIGxvY2FsQXhpc0E6IHRoaXMubV9sb2NhbFhBeGlzQSxcbiAgICAgICAgICByZWZlcmVuY2VBbmdsZTogdGhpcy5tX3JlZmVyZW5jZUFuZ2xlXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICBkYXRhLmxvY2FsQXhpc0EgPSBWZWMyLmNsb25lKGRhdGEubG9jYWxBeGlzQSk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBQcmlzbWF0aWNKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoZGVmLmFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIodGhpcy5tX2JvZHlBLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckEpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMih0aGlzLm1fYm9keUIuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQikpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5sb2NhbEF4aXNBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsWEF4aXNBLnNldFZlYzIoZGVmLmxvY2FsQXhpc0EpO1xuICAgICAgICAgIHRoaXMubV9sb2NhbFlBeGlzQS5zZXRWZWMyKFZlYzIuY3Jvc3NOdW1WZWMyKDEsIGRlZi5sb2NhbEF4aXNBKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYucmVmZXJlbmNlQW5nbGUpKSB7XG4gICAgICAgICAgdGhpcy5tX3JlZmVyZW5jZUFuZ2xlID0gZGVmLnJlZmVyZW5jZUFuZ2xlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZGVmLmVuYWJsZUxpbWl0ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gISFkZWYuZW5hYmxlTGltaXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubG93ZXJUcmFuc2xhdGlvbikpIHtcbiAgICAgICAgICB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGRlZi5sb3dlclRyYW5zbGF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLnVwcGVyVHJhbnNsYXRpb24pKSB7XG4gICAgICAgICAgdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gPSBkZWYudXBwZXJUcmFuc2xhdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGRlZi5lbmFibGVNb3RvciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9ICEhZGVmLmVuYWJsZU1vdG9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1heE1vdG9yRm9yY2UpKSB7XG4gICAgICAgICAgdGhpcy5tX21heE1vdG9yRm9yY2UgPSBkZWYubWF4TW90b3JGb3JjZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tb3RvclNwZWVkKSkge1xuICAgICAgICAgIHRoaXMubV9tb3RvclNwZWVkID0gZGVmLm1vdG9yU3BlZWQ7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldExvY2FsQXhpc0EgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbFhBeGlzQTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldFJlZmVyZW5jZUFuZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludFRyYW5zbGF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwQTIgPSB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgICAgdmFyIHBCMiA9IHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihwQjIsIHBBMik7XG4gICAgICAgIHZhciBheGlzID0gdGhpcy5tX2JvZHlBLmdldFdvcmxkVmVjdG9yKHRoaXMubV9sb2NhbFhBeGlzQSk7XG4gICAgICAgIHZhciB0cmFuc2xhdGlvbjIgPSBWZWMyLmRvdChkMiwgYXhpcyk7XG4gICAgICAgIHJldHVybiB0cmFuc2xhdGlvbjI7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludFNwZWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIoYkEubV94Zi5xLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyKSk7XG4gICAgICAgIHZhciByQjIgPSBSb3QubXVsVmVjMihiQi5tX3hmLnEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIpKTtcbiAgICAgICAgdmFyIHAxID0gVmVjMi5hZGQoYkEubV9zd2VlcC5jLCByQTIpO1xuICAgICAgICB2YXIgcDIgPSBWZWMyLmFkZChiQi5tX3N3ZWVwLmMsIHJCMik7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuc3ViKHAyLCBwMSk7XG4gICAgICAgIHZhciBheGlzID0gUm90Lm11bFZlYzIoYkEubV94Zi5xLCB0aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICB2YXIgdkEyID0gYkEubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgICAgdmFyIHZCMiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICAgIHZhciB3QSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICB2YXIgd0IgPSBiQi5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgdmFyIHNwZWVkID0gVmVjMi5kb3QoZDIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCBheGlzKSkgKyBWZWMyLmRvdChheGlzLCBWZWMyLnN1YihWZWMyLmFkZENyb3NzTnVtVmVjMih2QjIsIHdCLCByQjIpLCBWZWMyLmFkZENyb3NzTnVtVmVjMih2QTIsIHdBLCByQTIpKSk7XG4gICAgICAgIHJldHVybiBzcGVlZDtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmlzTGltaXRFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTGltaXQ7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5lbmFibGVMaW1pdCA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcgIT0gdGhpcy5tX2VuYWJsZUxpbWl0KSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSBmbGFnO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRMb3dlckxpbWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbjtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldFVwcGVyTGltaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV91cHBlclRyYW5zbGF0aW9uO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuc2V0TGltaXRzID0gZnVuY3Rpb24obG93ZXIsIHVwcGVyKSB7XG4gICAgICAgIGlmIChsb3dlciAhPSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiB8fCB1cHBlciAhPSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gPSBsb3dlcjtcbiAgICAgICAgICB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiA9IHVwcGVyO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5pc01vdG9yRW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZU1vdG9yO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZW5hYmxlTW90b3IgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnID09IHRoaXMubV9lbmFibGVNb3RvcilcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBmbGFnO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuc2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uKHNwZWVkKSB7XG4gICAgICAgIGlmIChzcGVlZCA9PSB0aGlzLm1fbW90b3JTcGVlZClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IHNwZWVkO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuc2V0TWF4TW90b3JGb3JjZSA9IGZ1bmN0aW9uKGZvcmNlKSB7XG4gICAgICAgIGlmIChmb3JjZSA9PSB0aGlzLm1fbWF4TW90b3JGb3JjZSlcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fbWF4TW90b3JGb3JjZSA9IGZvcmNlO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0TWF4TW90b3JGb3JjZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heE1vdG9yRm9yY2U7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRNb3RvclNwZWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbW90b3JTcGVlZDtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldE1vdG9yRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5jb21iaW5lKHRoaXMubV9pbXB1bHNlLngsIHRoaXMubV9wZXJwLCB0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueiwgdGhpcy5tX2F4aXMpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLnk7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIGQyLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICBkMi5zdWJDb21iaW5lKDEsIGNBMiwgMSwgckEyKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB7XG4gICAgICAgICAgdGhpcy5tX2F4aXMgPSBSb3QubXVsVmVjMihxQSwgdGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgICB0aGlzLm1fYTEgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIHRoaXMubV9heGlzKTtcbiAgICAgICAgICB0aGlzLm1fYTIgPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9hMSAqIHRoaXMubV9hMSArIGlCICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xuICAgICAgICAgIGlmICh0aGlzLm1fbW90b3JNYXNzID4gMCkge1xuICAgICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IDEgLyB0aGlzLm1fbW90b3JNYXNzO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgdGhpcy5tX3BlcnAgPSBSb3QubXVsVmVjMihxQSwgdGhpcy5tX2xvY2FsWUF4aXNBKTtcbiAgICAgICAgICB0aGlzLm1fczEgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIHRoaXMubV9wZXJwKTtcbiAgICAgICAgICB0aGlzLm1fczIgPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB0aGlzLm1fcGVycCk7XG4gICAgICAgICAgVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgdGhpcy5tX3BlcnApO1xuICAgICAgICAgIHZhciBrMTEgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fczEgKiB0aGlzLm1fczEgKyBpQiAqIHRoaXMubV9zMiAqIHRoaXMubV9zMjtcbiAgICAgICAgICB2YXIgazEyID0gaUEgKiB0aGlzLm1fczEgKyBpQiAqIHRoaXMubV9zMjtcbiAgICAgICAgICB2YXIgazEzID0gaUEgKiB0aGlzLm1fczEgKiB0aGlzLm1fYTEgKyBpQiAqIHRoaXMubV9zMiAqIHRoaXMubV9hMjtcbiAgICAgICAgICB2YXIgazIyID0gaUEgKyBpQjtcbiAgICAgICAgICBpZiAoazIyID09IDApIHtcbiAgICAgICAgICAgIGsyMiA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBrMjMgPSBpQSAqIHRoaXMubV9hMSArIGlCICogdGhpcy5tX2EyO1xuICAgICAgICAgIHZhciBrMzMgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fYTEgKiB0aGlzLm1fYTEgKyBpQiAqIHRoaXMubV9hMiAqIHRoaXMubV9hMjtcbiAgICAgICAgICB0aGlzLm1fSy5leC5zZXQoazExLCBrMTIsIGsxMyk7XG4gICAgICAgICAgdGhpcy5tX0suZXkuc2V0KGsxMiwgazIyLCBrMjMpO1xuICAgICAgICAgIHRoaXMubV9LLmV6LnNldChrMTMsIGsyMywgazMzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0KSB7XG4gICAgICAgICAgdmFyIGpvaW50VHJhbnNsYXRpb24gPSBWZWMyLmRvdCh0aGlzLm1fYXhpcywgZDIpO1xuICAgICAgICAgIGlmIChtYXRoX2FicyQzKHRoaXMubV91cHBlclRyYW5zbGF0aW9uIC0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24pIDwgMiAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCkge1xuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDEuZXF1YWxMaW1pdHM7XG4gICAgICAgICAgfSBlbHNlIGlmIChqb2ludFRyYW5zbGF0aW9uIDw9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQxLmF0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMS5hdExvd2VyTGltaXQ7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoam9pbnRUcmFuc2xhdGlvbiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMS5hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDEuYXRVcHBlckxpbWl0O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDEuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMS5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5tdWwoc3RlcC5kdFJhdGlvKTtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLmNvbWJpbmUodGhpcy5tX2ltcHVsc2UueCwgdGhpcy5tX3BlcnAsIHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56LCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgdmFyIExBID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9zMSArIHRoaXMubV9pbXB1bHNlLnkgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopICogdGhpcy5tX2ExO1xuICAgICAgICAgIHZhciBMQiA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fczIgKyB0aGlzLm1faW1wdWxzZS55ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KSAqIHRoaXMubV9hMjtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBMQTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBMQjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQxLmVxdWFsTGltaXRzKSB7XG4gICAgICAgICAgdmFyIENkb3QgPSBWZWMyLmRvdCh0aGlzLm1fYXhpcywgVmVjMi5zdWIodkIyLCB2QTIpKSArIHRoaXMubV9hMiAqIHdCIC0gdGhpcy5tX2ExICogd0E7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSB0aGlzLm1fbW90b3JNYXNzICogKHRoaXMubV9tb3RvclNwZWVkIC0gQ2RvdCk7XG4gICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgICAgIHZhciBtYXhJbXB1bHNlID0gc3RlcC5kdCAqIHRoaXMubV9tYXhNb3RvckZvcmNlO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSBjbGFtcCh0aGlzLm1fbW90b3JJbXB1bHNlICsgaW1wdWxzZSwgLW1heEltcHVsc2UsIG1heEltcHVsc2UpO1xuICAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoaW1wdWxzZSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHZhciBMQSA9IGltcHVsc2UgKiB0aGlzLm1fYTE7XG4gICAgICAgICAgdmFyIExCID0gaW1wdWxzZSAqIHRoaXMubV9hMjtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBMQTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBMQjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgQ2RvdDEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgQ2RvdDEueCArPSBWZWMyLmRvdCh0aGlzLm1fcGVycCwgdkIyKSArIHRoaXMubV9zMiAqIHdCO1xuICAgICAgICBDZG90MS54IC09IFZlYzIuZG90KHRoaXMubV9wZXJwLCB2QTIpICsgdGhpcy5tX3MxICogd0E7XG4gICAgICAgIENkb3QxLnkgPSB3QiAtIHdBO1xuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0ICYmIHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMS5pbmFjdGl2ZUxpbWl0KSB7XG4gICAgICAgICAgdmFyIENkb3QyID0gMDtcbiAgICAgICAgICBDZG90MiArPSBWZWMyLmRvdCh0aGlzLm1fYXhpcywgdkIyKSArIHRoaXMubV9hMiAqIHdCO1xuICAgICAgICAgIENkb3QyIC09IFZlYzIuZG90KHRoaXMubV9heGlzLCB2QTIpICsgdGhpcy5tX2ExICogd0E7XG4gICAgICAgICAgdmFyIENkb3QgPSBuZXcgVmVjMyhDZG90MS54LCBDZG90MS55LCBDZG90Mik7XG4gICAgICAgICAgdmFyIGYxID0gVmVjMy5jbG9uZSh0aGlzLm1faW1wdWxzZSk7XG4gICAgICAgICAgdmFyIGRmID0gdGhpcy5tX0suc29sdmUzMyhWZWMzLm5lZyhDZG90KSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UuYWRkKGRmKTtcbiAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQxLmF0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IG1hdGhfbWF4KHRoaXMubV9pbXB1bHNlLnosIDApO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQxLmF0VXBwZXJMaW1pdCkge1xuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IG1hdGhfbWluJDIodGhpcy5tX2ltcHVsc2UueiwgMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBiMiA9IFZlYzIuY29tYmluZSgtMSwgQ2RvdDEsIC0odGhpcy5tX2ltcHVsc2UueiAtIGYxLnopLCBWZWMyLm5lbyh0aGlzLm1fSy5lei54LCB0aGlzLm1fSy5lei55KSk7XG4gICAgICAgICAgdmFyIGYyciA9IFZlYzIuYWRkKHRoaXMubV9LLnNvbHZlMjIoYjIpLCBWZWMyLm5lbyhmMS54LCBmMS55KSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCA9IGYyci54O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSBmMnIueTtcbiAgICAgICAgICBkZiA9IFZlYzMuc3ViKHRoaXMubV9pbXB1bHNlLCBmMSk7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5jb21iaW5lKGRmLngsIHRoaXMubV9wZXJwLCBkZi56LCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgdmFyIExBID0gZGYueCAqIHRoaXMubV9zMSArIGRmLnkgKyBkZi56ICogdGhpcy5tX2ExO1xuICAgICAgICAgIHZhciBMQiA9IGRmLnggKiB0aGlzLm1fczIgKyBkZi55ICsgZGYueiAqIHRoaXMubV9hMjtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBMQTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBMQjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgZGYgPSB0aGlzLm1fSy5zb2x2ZTIyKFZlYzIubmVnKENkb3QxKSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSBkZi54O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gZGYueTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoZGYueCwgdGhpcy5tX3BlcnApO1xuICAgICAgICAgIHZhciBMQSA9IGRmLnggKiB0aGlzLm1fczEgKyBkZi55O1xuICAgICAgICAgIHZhciBMQiA9IGRmLnggKiB0aGlzLm1fczIgKyBkZi55O1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIExBO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIExCO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuc3ViKFZlYzIuYWRkKGNCMiwgckIyKSwgVmVjMi5hZGQoY0EyLCByQTIpKTtcbiAgICAgICAgdmFyIGF4aXMgPSBSb3QubXVsVmVjMihxQSwgdGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgdmFyIGExID0gVmVjMi5jcm9zc1ZlYzJWZWMyKFZlYzIuYWRkKGQyLCByQTIpLCBheGlzKTtcbiAgICAgICAgdmFyIGEyID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgYXhpcyk7XG4gICAgICAgIHZhciBwZXJwMiA9IFJvdC5tdWxWZWMyKHFBLCB0aGlzLm1fbG9jYWxZQXhpc0EpO1xuICAgICAgICB2YXIgczEgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIHBlcnAyKTtcbiAgICAgICAgdmFyIHMyID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgcGVycDIpO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IG5ldyBWZWMzKCk7XG4gICAgICAgIHZhciBDMSA9IFZlYzIuemVybygpO1xuICAgICAgICBDMS54ID0gVmVjMi5kb3QocGVycDIsIGQyKTtcbiAgICAgICAgQzEueSA9IGFCIC0gYUEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgIHZhciBsaW5lYXJFcnJvciA9IG1hdGhfYWJzJDMoQzEueCk7XG4gICAgICAgIHZhciBhbmd1bGFyRXJyb3IgPSBtYXRoX2FicyQzKEMxLnkpO1xuICAgICAgICB2YXIgbGluZWFyU2xvcCA9IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgICAgdmFyIG1heExpbmVhckNvcnJlY3Rpb24gPSBTZXR0aW5nc0ludGVybmFsLm1heExpbmVhckNvcnJlY3Rpb247XG4gICAgICAgIHZhciBhY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdmFyIEMyID0gMDtcbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCkge1xuICAgICAgICAgIHZhciB0cmFuc2xhdGlvbjIgPSBWZWMyLmRvdChheGlzLCBkMik7XG4gICAgICAgICAgaWYgKG1hdGhfYWJzJDModGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikgPCAyICogbGluZWFyU2xvcCkge1xuICAgICAgICAgICAgQzIgPSBjbGFtcCh0cmFuc2xhdGlvbjIsIC1tYXhMaW5lYXJDb3JyZWN0aW9uLCBtYXhMaW5lYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gbWF0aF9tYXgobGluZWFyRXJyb3IsIG1hdGhfYWJzJDModHJhbnNsYXRpb24yKSk7XG4gICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSBpZiAodHJhbnNsYXRpb24yIDw9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICBDMiA9IGNsYW1wKHRyYW5zbGF0aW9uMiAtIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uICsgbGluZWFyU2xvcCwgLW1heExpbmVhckNvcnJlY3Rpb24sIDApO1xuICAgICAgICAgICAgbGluZWFyRXJyb3IgPSBNYXRoLm1heChsaW5lYXJFcnJvciwgdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gLSB0cmFuc2xhdGlvbjIpO1xuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRyYW5zbGF0aW9uMiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgICAgQzIgPSBjbGFtcCh0cmFuc2xhdGlvbjIgLSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiAtIGxpbmVhclNsb3AsIDAsIG1heExpbmVhckNvcnJlY3Rpb24pO1xuICAgICAgICAgICAgbGluZWFyRXJyb3IgPSBNYXRoLm1heChsaW5lYXJFcnJvciwgdHJhbnNsYXRpb24yIC0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24pO1xuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGl2ZSkge1xuICAgICAgICAgIHZhciBrMTEgPSBtQSArIG1CICsgaUEgKiBzMSAqIHMxICsgaUIgKiBzMiAqIHMyO1xuICAgICAgICAgIHZhciBrMTIgPSBpQSAqIHMxICsgaUIgKiBzMjtcbiAgICAgICAgICB2YXIgazEzID0gaUEgKiBzMSAqIGExICsgaUIgKiBzMiAqIGEyO1xuICAgICAgICAgIHZhciBrMjIgPSBpQSArIGlCO1xuICAgICAgICAgIGlmIChrMjIgPT0gMCkge1xuICAgICAgICAgICAgazIyID0gMTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGsyMyA9IGlBICogYTEgKyBpQiAqIGEyO1xuICAgICAgICAgIHZhciBrMzMgPSBtQSArIG1CICsgaUEgKiBhMSAqIGExICsgaUIgKiBhMiAqIGEyO1xuICAgICAgICAgIHZhciBLID0gbmV3IE1hdDMzKCk7XG4gICAgICAgICAgSy5leC5zZXQoazExLCBrMTIsIGsxMyk7XG4gICAgICAgICAgSy5leS5zZXQoazEyLCBrMjIsIGsyMyk7XG4gICAgICAgICAgSy5lei5zZXQoazEzLCBrMjMsIGszMyk7XG4gICAgICAgICAgdmFyIEMgPSBuZXcgVmVjMygpO1xuICAgICAgICAgIEMueCA9IEMxLng7XG4gICAgICAgICAgQy55ID0gQzEueTtcbiAgICAgICAgICBDLnogPSBDMjtcbiAgICAgICAgICBpbXB1bHNlID0gSy5zb2x2ZTMzKFZlYzMubmVnKEMpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgazExID0gbUEgKyBtQiArIGlBICogczEgKiBzMSArIGlCICogczIgKiBzMjtcbiAgICAgICAgICB2YXIgazEyID0gaUEgKiBzMSArIGlCICogczI7XG4gICAgICAgICAgdmFyIGsyMiA9IGlBICsgaUI7XG4gICAgICAgICAgaWYgKGsyMiA9PSAwKSB7XG4gICAgICAgICAgICBrMjIgPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgSyA9IG5ldyBNYXQyMigpO1xuICAgICAgICAgIEsuZXguc2V0TnVtKGsxMSwgazEyKTtcbiAgICAgICAgICBLLmV5LnNldE51bShrMTIsIGsyMik7XG4gICAgICAgICAgdmFyIGltcHVsc2UxID0gSy5zb2x2ZShWZWMyLm5lZyhDMSkpO1xuICAgICAgICAgIGltcHVsc2UueCA9IGltcHVsc2UxLng7XG4gICAgICAgICAgaW1wdWxzZS55ID0gaW1wdWxzZTEueTtcbiAgICAgICAgICBpbXB1bHNlLnogPSAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciBQMyA9IFZlYzIuY29tYmluZShpbXB1bHNlLngsIHBlcnAyLCBpbXB1bHNlLnosIGF4aXMpO1xuICAgICAgICB2YXIgTEEgPSBpbXB1bHNlLnggKiBzMSArIGltcHVsc2UueSArIGltcHVsc2UueiAqIGExO1xuICAgICAgICB2YXIgTEIgPSBpbXB1bHNlLnggKiBzMiArIGltcHVsc2UueSArIGltcHVsc2UueiAqIGEyO1xuICAgICAgICBjQTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgIGFBIC09IGlBICogTEE7XG4gICAgICAgIGNCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgYUIgKz0gaUIgKiBMQjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYyA9IGNBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jID0gY0IyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBsaW5lYXJFcnJvciA8PSBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3AgJiYgYW5ndWxhckVycm9yIDw9IFNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsb3A7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLlRZUEUgPSBcInByaXNtYXRpYy1qb2ludFwiO1xuICAgICAgcmV0dXJuIFByaXNtYXRpY0pvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgREVGQVVMVFMkNiA9IHtcbiAgICByYXRpbzogMVxuICB9O1xuICB2YXIgR2VhckpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhHZWFySm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gR2VhckpvaW50MihkZWYsIGJvZHlBLCBib2R5Qiwgam9pbnQxLCBqb2ludDIsIHJhdGlvKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgR2VhckpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEdlYXJKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGpvaW50MSwgam9pbnQyLCByYXRpbyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDYpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gR2VhckpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2pvaW50MSA9IGpvaW50MSA/IGpvaW50MSA6IGRlZi5qb2ludDE7XG4gICAgICAgIF90aGlzLm1fam9pbnQyID0gam9pbnQyID8gam9pbnQyIDogZGVmLmpvaW50MjtcbiAgICAgICAgX3RoaXMubV9yYXRpbyA9IE51bWJlci5pc0Zpbml0ZShyYXRpbykgPyByYXRpbyA6IGRlZi5yYXRpbztcbiAgICAgICAgX3RoaXMubV90eXBlMSA9IF90aGlzLm1fam9pbnQxLmdldFR5cGUoKTtcbiAgICAgICAgX3RoaXMubV90eXBlMiA9IF90aGlzLm1fam9pbnQyLmdldFR5cGUoKTtcbiAgICAgICAgdmFyIGNvb3JkaW5hdGVBO1xuICAgICAgICB2YXIgY29vcmRpbmF0ZUI7XG4gICAgICAgIF90aGlzLm1fYm9keUMgPSBfdGhpcy5tX2pvaW50MS5nZXRCb2R5QSgpO1xuICAgICAgICBfdGhpcy5tX2JvZHlBID0gX3RoaXMubV9qb2ludDEuZ2V0Qm9keUIoKTtcbiAgICAgICAgdmFyIHhmQTIgPSBfdGhpcy5tX2JvZHlBLm1feGY7XG4gICAgICAgIHZhciBhQSA9IF90aGlzLm1fYm9keUEubV9zd2VlcC5hO1xuICAgICAgICB2YXIgeGZDID0gX3RoaXMubV9ib2R5Qy5tX3hmO1xuICAgICAgICB2YXIgYUMgPSBfdGhpcy5tX2JvZHlDLm1fc3dlZXAuYTtcbiAgICAgICAgaWYgKF90aGlzLm1fdHlwZTEgPT09IFJldm9sdXRlSm9pbnQuVFlQRSkge1xuICAgICAgICAgIHZhciByZXZvbHV0ZSA9IF90aGlzLm1fam9pbnQxO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JDID0gcmV2b2x1dGUubV9sb2NhbEFuY2hvckE7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSByZXZvbHV0ZS5tX2xvY2FsQW5jaG9yQjtcbiAgICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQSA9IHJldm9sdXRlLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEF4aXNDID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgY29vcmRpbmF0ZUEgPSBhQSAtIGFDIC0gX3RoaXMubV9yZWZlcmVuY2VBbmdsZUE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHByaXNtYXRpYyA9IF90aGlzLm1fam9pbnQxO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JDID0gcHJpc21hdGljLm1fbG9jYWxBbmNob3JBO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gcHJpc21hdGljLm1fbG9jYWxBbmNob3JCO1xuICAgICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGVBID0gcHJpc21hdGljLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEF4aXNDID0gcHJpc21hdGljLm1fbG9jYWxYQXhpc0E7XG4gICAgICAgICAgdmFyIHBDID0gX3RoaXMubV9sb2NhbEFuY2hvckM7XG4gICAgICAgICAgdmFyIHBBMiA9IFJvdC5tdWxUVmVjMih4ZkMucSwgVmVjMi5hZGQoUm90Lm11bFZlYzIoeGZBMi5xLCBfdGhpcy5tX2xvY2FsQW5jaG9yQSksIFZlYzIuc3ViKHhmQTIucCwgeGZDLnApKSk7XG4gICAgICAgICAgY29vcmRpbmF0ZUEgPSBWZWMyLmRvdChwQTIsIF90aGlzLm1fbG9jYWxBeGlzQykgLSBWZWMyLmRvdChwQywgX3RoaXMubV9sb2NhbEF4aXNDKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5tX2JvZHlEID0gX3RoaXMubV9qb2ludDIuZ2V0Qm9keUEoKTtcbiAgICAgICAgX3RoaXMubV9ib2R5QiA9IF90aGlzLm1fam9pbnQyLmdldEJvZHlCKCk7XG4gICAgICAgIHZhciB4ZkIyID0gX3RoaXMubV9ib2R5Qi5tX3hmO1xuICAgICAgICB2YXIgYUIgPSBfdGhpcy5tX2JvZHlCLm1fc3dlZXAuYTtcbiAgICAgICAgdmFyIHhmRCA9IF90aGlzLm1fYm9keUQubV94ZjtcbiAgICAgICAgdmFyIGFEID0gX3RoaXMubV9ib2R5RC5tX3N3ZWVwLmE7XG4gICAgICAgIGlmIChfdGhpcy5tX3R5cGUyID09PSBSZXZvbHV0ZUpvaW50LlRZUEUpIHtcbiAgICAgICAgICB2YXIgcmV2b2x1dGUgPSBfdGhpcy5tX2pvaW50MjtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yRCA9IHJldm9sdXRlLm1fbG9jYWxBbmNob3JBO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gcmV2b2x1dGUubV9sb2NhbEFuY2hvckI7XG4gICAgICAgICAgX3RoaXMubV9yZWZlcmVuY2VBbmdsZUIgPSByZXZvbHV0ZS5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBeGlzRCA9IFZlYzIuemVybygpO1xuICAgICAgICAgIGNvb3JkaW5hdGVCID0gYUIgLSBhRCAtIF90aGlzLm1fcmVmZXJlbmNlQW5nbGVCO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBwcmlzbWF0aWMgPSBfdGhpcy5tX2pvaW50MjtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yRCA9IHByaXNtYXRpYy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IHByaXNtYXRpYy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQiA9IHByaXNtYXRpYy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBeGlzRCA9IHByaXNtYXRpYy5tX2xvY2FsWEF4aXNBO1xuICAgICAgICAgIHZhciBwRCA9IF90aGlzLm1fbG9jYWxBbmNob3JEO1xuICAgICAgICAgIHZhciBwQjIgPSBSb3QubXVsVFZlYzIoeGZELnEsIFZlYzIuYWRkKFJvdC5tdWxWZWMyKHhmQjIucSwgX3RoaXMubV9sb2NhbEFuY2hvckIpLCBWZWMyLnN1Yih4ZkIyLnAsIHhmRC5wKSkpO1xuICAgICAgICAgIGNvb3JkaW5hdGVCID0gVmVjMi5kb3QocEIyLCBfdGhpcy5tX2xvY2FsQXhpc0QpIC0gVmVjMi5kb3QocEQsIF90aGlzLm1fbG9jYWxBeGlzRCk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMubV9jb25zdGFudCA9IGNvb3JkaW5hdGVBICsgX3RoaXMubV9yYXRpbyAqIGNvb3JkaW5hdGVCO1xuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGpvaW50MTogdGhpcy5tX2pvaW50MSxcbiAgICAgICAgICBqb2ludDI6IHRoaXMubV9qb2ludDIsXG4gICAgICAgICAgcmF0aW86IHRoaXMubV9yYXRpb1xuICAgICAgICAgIC8vIF9jb25zdGFudDogdGhpcy5tX2NvbnN0YW50LFxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuam9pbnQxID0gcmVzdG9yZShKb2ludCwgZGF0YS5qb2ludDEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5qb2ludDIgPSByZXN0b3JlKEpvaW50LCBkYXRhLmpvaW50Miwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgR2VhckpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5yYXRpbykpIHtcbiAgICAgICAgICB0aGlzLm1fcmF0aW8gPSBkZWYucmF0aW87XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludDEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9qb2ludDE7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnQyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fam9pbnQyO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLnNldFJhdGlvID0gZnVuY3Rpb24ocmF0aW8pIHtcbiAgICAgICAgdGhpcy5tX3JhdGlvID0gcmF0aW87XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuZ2V0UmF0aW8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yYXRpbztcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm11bE51bVZlYzIodGhpcy5tX2ltcHVsc2UsIHRoaXMubV9KdkFDKS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICB2YXIgTCA9IHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0p3QTtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIEw7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sY0EgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xjQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbGNDID0gdGhpcy5tX2JvZHlDLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sY0QgPSB0aGlzLm1fYm9keUQubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX21BID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX21CID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX21DID0gdGhpcy5tX2JvZHlDLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX21EID0gdGhpcy5tX2JvZHlELm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2lBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2lCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdGhpcy5tX2lDID0gdGhpcy5tX2JvZHlDLm1faW52STtcbiAgICAgICAgdGhpcy5tX2lEID0gdGhpcy5tX2JvZHlELm1faW52STtcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgYUMgPSB0aGlzLm1fYm9keUMuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkMgPSB0aGlzLm1fYm9keUMuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0MgPSB0aGlzLm1fYm9keUMuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgYUQgPSB0aGlzLm1fYm9keUQuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkQgPSB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0QgPSB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciBxQyA9IFJvdC5uZW8oYUMpO1xuICAgICAgICB2YXIgcUQgPSBSb3QubmVvKGFEKTtcbiAgICAgICAgdGhpcy5tX21hc3MgPSAwO1xuICAgICAgICBpZiAodGhpcy5tX3R5cGUxID09IFJldm9sdXRlSm9pbnQuVFlQRSkge1xuICAgICAgICAgIHRoaXMubV9KdkFDID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX0p3QSA9IDE7XG4gICAgICAgICAgdGhpcy5tX0p3QyA9IDE7XG4gICAgICAgICAgdGhpcy5tX21hc3MgKz0gdGhpcy5tX2lBICsgdGhpcy5tX2lDO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciB1ID0gUm90Lm11bFZlYzIocUMsIHRoaXMubV9sb2NhbEF4aXNDKTtcbiAgICAgICAgICB2YXIgckMgPSBSb3QubXVsU3ViKHFDLCB0aGlzLm1fbG9jYWxBbmNob3JDLCB0aGlzLm1fbGNDKTtcbiAgICAgICAgICB2YXIgckEyID0gUm90Lm11bFN1YihxQSwgdGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xjQSk7XG4gICAgICAgICAgdGhpcy5tX0p2QUMgPSB1O1xuICAgICAgICAgIHRoaXMubV9Kd0MgPSBWZWMyLmNyb3NzVmVjMlZlYzIockMsIHUpO1xuICAgICAgICAgIHRoaXMubV9Kd0EgPSBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCB1KTtcbiAgICAgICAgICB0aGlzLm1fbWFzcyArPSB0aGlzLm1fbUMgKyB0aGlzLm1fbUEgKyB0aGlzLm1faUMgKiB0aGlzLm1fSndDICogdGhpcy5tX0p3QyArIHRoaXMubV9pQSAqIHRoaXMubV9Kd0EgKiB0aGlzLm1fSndBO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZTIgPT0gUmV2b2x1dGVKb2ludC5UWVBFKSB7XG4gICAgICAgICAgdGhpcy5tX0p2QkQgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fSndCID0gdGhpcy5tX3JhdGlvO1xuICAgICAgICAgIHRoaXMubV9Kd0QgPSB0aGlzLm1fcmF0aW87XG4gICAgICAgICAgdGhpcy5tX21hc3MgKz0gdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogKHRoaXMubV9pQiArIHRoaXMubV9pRCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHUgPSBSb3QubXVsVmVjMihxRCwgdGhpcy5tX2xvY2FsQXhpc0QpO1xuICAgICAgICAgIHZhciByRCA9IFJvdC5tdWxTdWIocUQsIHRoaXMubV9sb2NhbEFuY2hvckQsIHRoaXMubV9sY0QpO1xuICAgICAgICAgIHZhciByQjIgPSBSb3QubXVsU3ViKHFCLCB0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbGNCKTtcbiAgICAgICAgICB0aGlzLm1fSnZCRCA9IFZlYzIubXVsTnVtVmVjMih0aGlzLm1fcmF0aW8sIHUpO1xuICAgICAgICAgIHRoaXMubV9Kd0QgPSB0aGlzLm1fcmF0aW8gKiBWZWMyLmNyb3NzVmVjMlZlYzIockQsIHUpO1xuICAgICAgICAgIHRoaXMubV9Kd0IgPSB0aGlzLm1fcmF0aW8gKiBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB1KTtcbiAgICAgICAgICB0aGlzLm1fbWFzcyArPSB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiAodGhpcy5tX21EICsgdGhpcy5tX21CKSArIHRoaXMubV9pRCAqIHRoaXMubV9Kd0QgKiB0aGlzLm1fSndEICsgdGhpcy5tX2lCICogdGhpcy5tX0p3QiAqIHRoaXMubV9Kd0I7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX21hc3MgPSB0aGlzLm1fbWFzcyA+IDAgPyAxIC8gdGhpcy5tX21hc3MgOiAwO1xuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB2QTIuYWRkTXVsKHRoaXMubV9tQSAqIHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fSnZBQyk7XG4gICAgICAgICAgd0EgKz0gdGhpcy5tX2lBICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSndBO1xuICAgICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX21CICogdGhpcy5tX2ltcHVsc2UsIHRoaXMubV9KdkJEKTtcbiAgICAgICAgICB3QiArPSB0aGlzLm1faUIgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9Kd0I7XG4gICAgICAgICAgdkMuc3ViTXVsKHRoaXMubV9tQyAqIHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fSnZBQyk7XG4gICAgICAgICAgd0MgLT0gdGhpcy5tX2lDICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSndDO1xuICAgICAgICAgIHZELnN1Yk11bCh0aGlzLm1fbUQgKiB0aGlzLm1faW1wdWxzZSwgdGhpcy5tX0p2QkQpO1xuICAgICAgICAgIHdEIC09IHRoaXMubV9pRCAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0p3RDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgICAgdGhpcy5tX2JvZHlDLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZDKTtcbiAgICAgICAgdGhpcy5tX2JvZHlDLmNfdmVsb2NpdHkudyA9IHdDO1xuICAgICAgICB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS52LnNldFZlYzIodkQpO1xuICAgICAgICB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS53ID0gd0Q7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QyA9IHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QyA9IHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2RCA9IHRoaXMubV9ib2R5RC5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3RCA9IHRoaXMubV9ib2R5RC5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBDZG90ID0gVmVjMi5kb3QodGhpcy5tX0p2QUMsIHZBMikgLSBWZWMyLmRvdCh0aGlzLm1fSnZBQywgdkMpICsgVmVjMi5kb3QodGhpcy5tX0p2QkQsIHZCMikgLSBWZWMyLmRvdCh0aGlzLm1fSnZCRCwgdkQpO1xuICAgICAgICBDZG90ICs9IHRoaXMubV9Kd0EgKiB3QSAtIHRoaXMubV9Kd0MgKiB3QyArICh0aGlzLm1fSndCICogd0IgLSB0aGlzLm1fSndEICogd0QpO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbWFzcyAqIENkb3Q7XG4gICAgICAgIHRoaXMubV9pbXB1bHNlICs9IGltcHVsc2U7XG4gICAgICAgIHZBMi5hZGRNdWwodGhpcy5tX21BICogaW1wdWxzZSwgdGhpcy5tX0p2QUMpO1xuICAgICAgICB3QSArPSB0aGlzLm1faUEgKiBpbXB1bHNlICogdGhpcy5tX0p3QTtcbiAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1fbUIgKiBpbXB1bHNlLCB0aGlzLm1fSnZCRCk7XG4gICAgICAgIHdCICs9IHRoaXMubV9pQiAqIGltcHVsc2UgKiB0aGlzLm1fSndCO1xuICAgICAgICB2Qy5zdWJNdWwodGhpcy5tX21DICogaW1wdWxzZSwgdGhpcy5tX0p2QUMpO1xuICAgICAgICB3QyAtPSB0aGlzLm1faUMgKiBpbXB1bHNlICogdGhpcy5tX0p3QztcbiAgICAgICAgdkQuc3ViTXVsKHRoaXMubV9tRCAqIGltcHVsc2UsIHRoaXMubV9KdkJEKTtcbiAgICAgICAgd0QgLT0gdGhpcy5tX2lEICogaW1wdWxzZSAqIHRoaXMubV9Kd0Q7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICAgIHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2Qyk7XG4gICAgICAgIHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5LncgPSB3QztcbiAgICAgICAgdGhpcy5tX2JvZHlELmNfdmVsb2NpdHkudi5zZXRWZWMyKHZEKTtcbiAgICAgICAgdGhpcy5tX2JvZHlELmNfdmVsb2NpdHkudyA9IHdEO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0MgPSB0aGlzLm1fYm9keUMuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUMgPSB0aGlzLm1fYm9keUMuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0QgPSB0aGlzLm1fYm9keUQuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUQgPSB0aGlzLm1fYm9keUQuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciBxQyA9IFJvdC5uZW8oYUMpO1xuICAgICAgICB2YXIgcUQgPSBSb3QubmVvKGFEKTtcbiAgICAgICAgdmFyIGxpbmVhckVycm9yID0gMDtcbiAgICAgICAgdmFyIGNvb3JkaW5hdGVBO1xuICAgICAgICB2YXIgY29vcmRpbmF0ZUI7XG4gICAgICAgIHZhciBKdkFDO1xuICAgICAgICB2YXIgSnZCRDtcbiAgICAgICAgdmFyIEp3QTtcbiAgICAgICAgdmFyIEp3QjtcbiAgICAgICAgdmFyIEp3QztcbiAgICAgICAgdmFyIEp3RDtcbiAgICAgICAgdmFyIG1hc3MgPSAwO1xuICAgICAgICBpZiAodGhpcy5tX3R5cGUxID09IFJldm9sdXRlSm9pbnQuVFlQRSkge1xuICAgICAgICAgIEp2QUMgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBKd0EgPSAxO1xuICAgICAgICAgIEp3QyA9IDE7XG4gICAgICAgICAgbWFzcyArPSB0aGlzLm1faUEgKyB0aGlzLm1faUM7XG4gICAgICAgICAgY29vcmRpbmF0ZUEgPSBhQSAtIGFDIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgdSA9IFJvdC5tdWxWZWMyKHFDLCB0aGlzLm1fbG9jYWxBeGlzQyk7XG4gICAgICAgICAgdmFyIHJDID0gUm90Lm11bFN1YihxQywgdGhpcy5tX2xvY2FsQW5jaG9yQywgdGhpcy5tX2xjQyk7XG4gICAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxTdWIocUEsIHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sY0EpO1xuICAgICAgICAgIEp2QUMgPSB1O1xuICAgICAgICAgIEp3QyA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQywgdSk7XG4gICAgICAgICAgSndBID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgdSk7XG4gICAgICAgICAgbWFzcyArPSB0aGlzLm1fbUMgKyB0aGlzLm1fbUEgKyB0aGlzLm1faUMgKiBKd0MgKiBKd0MgKyB0aGlzLm1faUEgKiBKd0EgKiBKd0E7XG4gICAgICAgICAgdmFyIHBDID0gVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQywgdGhpcy5tX2xjQyk7XG4gICAgICAgICAgdmFyIHBBMiA9IFJvdC5tdWxUVmVjMihxQywgVmVjMi5hZGQockEyLCBWZWMyLnN1YihjQTIsIGNDKSkpO1xuICAgICAgICAgIGNvb3JkaW5hdGVBID0gVmVjMi5kb3QoVmVjMi5zdWIocEEyLCBwQyksIHRoaXMubV9sb2NhbEF4aXNDKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX3R5cGUyID09IFJldm9sdXRlSm9pbnQuVFlQRSkge1xuICAgICAgICAgIEp2QkQgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBKd0IgPSB0aGlzLm1fcmF0aW87XG4gICAgICAgICAgSndEID0gdGhpcy5tX3JhdGlvO1xuICAgICAgICAgIG1hc3MgKz0gdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogKHRoaXMubV9pQiArIHRoaXMubV9pRCk7XG4gICAgICAgICAgY29vcmRpbmF0ZUIgPSBhQiAtIGFEIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgdSA9IFJvdC5tdWxWZWMyKHFELCB0aGlzLm1fbG9jYWxBeGlzRCk7XG4gICAgICAgICAgdmFyIHJEID0gUm90Lm11bFN1YihxRCwgdGhpcy5tX2xvY2FsQW5jaG9yRCwgdGhpcy5tX2xjRCk7XG4gICAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxTdWIocUIsIHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sY0IpO1xuICAgICAgICAgIEp2QkQgPSBWZWMyLm11bE51bVZlYzIodGhpcy5tX3JhdGlvLCB1KTtcbiAgICAgICAgICBKd0QgPSB0aGlzLm1fcmF0aW8gKiBWZWMyLmNyb3NzVmVjMlZlYzIockQsIHUpO1xuICAgICAgICAgIEp3QiA9IHRoaXMubV9yYXRpbyAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHUpO1xuICAgICAgICAgIG1hc3MgKz0gdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogKHRoaXMubV9tRCArIHRoaXMubV9tQikgKyB0aGlzLm1faUQgKiBKd0QgKiBKd0QgKyB0aGlzLm1faUIgKiBKd0IgKiBKd0I7XG4gICAgICAgICAgdmFyIHBEID0gVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yRCwgdGhpcy5tX2xjRCk7XG4gICAgICAgICAgdmFyIHBCMiA9IFJvdC5tdWxUVmVjMihxRCwgVmVjMi5hZGQockIyLCBWZWMyLnN1YihjQjIsIGNEKSkpO1xuICAgICAgICAgIGNvb3JkaW5hdGVCID0gVmVjMi5kb3QocEIyLCB0aGlzLm1fbG9jYWxBeGlzRCkgLSBWZWMyLmRvdChwRCwgdGhpcy5tX2xvY2FsQXhpc0QpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBDID0gY29vcmRpbmF0ZUEgKyB0aGlzLm1fcmF0aW8gKiBjb29yZGluYXRlQiAtIHRoaXMubV9jb25zdGFudDtcbiAgICAgICAgdmFyIGltcHVsc2UgPSAwO1xuICAgICAgICBpZiAobWFzcyA+IDApIHtcbiAgICAgICAgICBpbXB1bHNlID0gLUMgLyBtYXNzO1xuICAgICAgICB9XG4gICAgICAgIGNBMi5hZGRNdWwodGhpcy5tX21BICogaW1wdWxzZSwgSnZBQyk7XG4gICAgICAgIGFBICs9IHRoaXMubV9pQSAqIGltcHVsc2UgKiBKd0E7XG4gICAgICAgIGNCMi5hZGRNdWwodGhpcy5tX21CICogaW1wdWxzZSwgSnZCRCk7XG4gICAgICAgIGFCICs9IHRoaXMubV9pQiAqIGltcHVsc2UgKiBKd0I7XG4gICAgICAgIGNDLnN1Yk11bCh0aGlzLm1fbUMgKiBpbXB1bHNlLCBKdkFDKTtcbiAgICAgICAgYUMgLT0gdGhpcy5tX2lDICogaW1wdWxzZSAqIEp3QztcbiAgICAgICAgY0Quc3ViTXVsKHRoaXMubV9tRCAqIGltcHVsc2UsIEp2QkQpO1xuICAgICAgICBhRCAtPSB0aGlzLm1faUQgKiBpbXB1bHNlICogSndEO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jLnNldFZlYzIoY0EyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jLnNldFZlYzIoY0IyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICB0aGlzLm1fYm9keUMuY19wb3NpdGlvbi5jLnNldFZlYzIoY0MpO1xuICAgICAgICB0aGlzLm1fYm9keUMuY19wb3NpdGlvbi5hID0gYUM7XG4gICAgICAgIHRoaXMubV9ib2R5RC5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjRCk7XG4gICAgICAgIHRoaXMubV9ib2R5RC5jX3Bvc2l0aW9uLmEgPSBhRDtcbiAgICAgICAgcmV0dXJuIGxpbmVhckVycm9yIDwgU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIuVFlQRSA9IFwiZ2Vhci1qb2ludFwiO1xuICAgICAgcmV0dXJuIEdlYXJKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIERFRkFVTFRTJDUgPSB7XG4gICAgbWF4Rm9yY2U6IDEsXG4gICAgbWF4VG9ycXVlOiAxLFxuICAgIGNvcnJlY3Rpb25GYWN0b3I6IDAuM1xuICB9O1xuICB2YXIgTW90b3JKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoTW90b3JKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBNb3RvckpvaW50MihkZWYsIGJvZHlBLCBib2R5Qikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIE1vdG9ySm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgTW90b3JKb2ludDIoZGVmLCBib2R5QSwgYm9keUIpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQ1KTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IE1vdG9ySm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fbGluZWFyT2Zmc2V0ID0gVmVjMi5pc1ZhbGlkKGRlZi5saW5lYXJPZmZzZXQpID8gVmVjMi5jbG9uZShkZWYubGluZWFyT2Zmc2V0KSA6IGJvZHlBLmdldExvY2FsUG9pbnQoYm9keUIuZ2V0UG9zaXRpb24oKSk7XG4gICAgICAgIF90aGlzLm1fYW5ndWxhck9mZnNldCA9IE51bWJlci5pc0Zpbml0ZShkZWYuYW5ndWxhck9mZnNldCkgPyBkZWYuYW5ndWxhck9mZnNldCA6IGJvZHlCLmdldEFuZ2xlKCkgLSBib2R5QS5nZXRBbmdsZSgpO1xuICAgICAgICBfdGhpcy5tX2xpbmVhckltcHVsc2UgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9hbmd1bGFySW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIF90aGlzLm1fbWF4VG9ycXVlID0gZGVmLm1heFRvcnF1ZTtcbiAgICAgICAgX3RoaXMubV9jb3JyZWN0aW9uRmFjdG9yID0gZGVmLmNvcnJlY3Rpb25GYWN0b3I7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIG1heEZvcmNlOiB0aGlzLm1fbWF4Rm9yY2UsXG4gICAgICAgICAgbWF4VG9ycXVlOiB0aGlzLm1fbWF4VG9ycXVlLFxuICAgICAgICAgIGNvcnJlY3Rpb25GYWN0b3I6IHRoaXMubV9jb3JyZWN0aW9uRmFjdG9yLFxuICAgICAgICAgIGxpbmVhck9mZnNldDogdGhpcy5tX2xpbmVhck9mZnNldCxcbiAgICAgICAgICBhbmd1bGFyT2Zmc2V0OiB0aGlzLm1fYW5ndWxhck9mZnNldFxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgTW90b3JKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmFuZ3VsYXJPZmZzZXQpKSB7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJPZmZzZXQgPSBkZWYuYW5ndWxhck9mZnNldDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhGb3JjZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4VG9ycXVlKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhUb3JxdWUgPSBkZWYubWF4VG9ycXVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmNvcnJlY3Rpb25GYWN0b3IpKSB7XG4gICAgICAgICAgdGhpcy5tX2NvcnJlY3Rpb25GYWN0b3IgPSBkZWYuY29ycmVjdGlvbkZhY3RvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5saW5lYXJPZmZzZXQpKSB7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhck9mZnNldC5zZXQoZGVmLmxpbmVhck9mZnNldCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuc2V0TWF4Rm9yY2UgPSBmdW5jdGlvbihmb3JjZSkge1xuICAgICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBmb3JjZTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0TWF4Rm9yY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhGb3JjZTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuc2V0TWF4VG9ycXVlID0gZnVuY3Rpb24odG9ycXVlKSB7XG4gICAgICAgIHRoaXMubV9tYXhUb3JxdWUgPSB0b3JxdWU7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldE1heFRvcnF1ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heFRvcnF1ZTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuc2V0Q29ycmVjdGlvbkZhY3RvciA9IGZ1bmN0aW9uKGZhY3Rvcikge1xuICAgICAgICB0aGlzLm1fY29ycmVjdGlvbkZhY3RvciA9IGZhY3RvcjtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0Q29ycmVjdGlvbkZhY3RvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvcnJlY3Rpb25GYWN0b3I7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLnNldExpbmVhck9mZnNldCA9IGZ1bmN0aW9uKGxpbmVhck9mZnNldCkge1xuICAgICAgICBpZiAobGluZWFyT2Zmc2V0LnggIT0gdGhpcy5tX2xpbmVhck9mZnNldC54IHx8IGxpbmVhck9mZnNldC55ICE9IHRoaXMubV9saW5lYXJPZmZzZXQueSkge1xuICAgICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhck9mZnNldC5zZXQobGluZWFyT2Zmc2V0KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRMaW5lYXJPZmZzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9saW5lYXJPZmZzZXQ7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLnNldEFuZ3VsYXJPZmZzZXQgPSBmdW5jdGlvbihhbmd1bGFyT2Zmc2V0KSB7XG4gICAgICAgIGlmIChhbmd1bGFyT2Zmc2V0ICE9IHRoaXMubV9hbmd1bGFyT2Zmc2V0KSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhck9mZnNldCA9IGFuZ3VsYXJPZmZzZXQ7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0QW5ndWxhck9mZnNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2FuZ3VsYXJPZmZzZXQ7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRQb3NpdGlvbigpO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0UG9zaXRpb24oKTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5tdWxOdW1WZWMyKGludl9kdCwgdGhpcy5tX2xpbmVhckltcHVsc2UpO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2FuZ3VsYXJJbXB1bHNlO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHRoaXMubV9yQSA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbGluZWFyT2Zmc2V0LCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLm5lZyh0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIEsgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgSy5leC54ID0gbUEgKyBtQiArIGlBICogdGhpcy5tX3JBLnkgKiB0aGlzLm1fckEueSArIGlCICogdGhpcy5tX3JCLnkgKiB0aGlzLm1fckIueTtcbiAgICAgICAgSy5leC55ID0gLWlBICogdGhpcy5tX3JBLnggKiB0aGlzLm1fckEueSAtIGlCICogdGhpcy5tX3JCLnggKiB0aGlzLm1fckIueTtcbiAgICAgICAgSy5leS54ID0gSy5leC55O1xuICAgICAgICBLLmV5LnkgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fckEueCAqIHRoaXMubV9yQS54ICsgaUIgKiB0aGlzLm1fckIueCAqIHRoaXMubV9yQi54O1xuICAgICAgICB0aGlzLm1fbGluZWFyTWFzcyA9IEsuZ2V0SW52ZXJzZSgpO1xuICAgICAgICB0aGlzLm1fYW5ndWxhck1hc3MgPSBpQSArIGlCO1xuICAgICAgICBpZiAodGhpcy5tX2FuZ3VsYXJNYXNzID4gMCkge1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFyTWFzcyA9IDEgLyB0aGlzLm1fYW5ndWxhck1hc3M7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2xpbmVhckVycm9yID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMubV9saW5lYXJFcnJvci5hZGRDb21iaW5lKDEsIGNCMiwgMSwgdGhpcy5tX3JCKTtcbiAgICAgICAgdGhpcy5tX2xpbmVhckVycm9yLnN1YkNvbWJpbmUoMSwgY0EyLCAxLCB0aGlzLm1fckEpO1xuICAgICAgICB0aGlzLm1fYW5ndWxhckVycm9yID0gYUIgLSBhQSAtIHRoaXMubV9hbmd1bGFyT2Zmc2V0O1xuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5tdWwoc3RlcC5kdFJhdGlvKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVvKHRoaXMubV9saW5lYXJJbXB1bHNlLngsIHRoaXMubV9saW5lYXJJbXB1bHNlLnkpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMykgKyB0aGlzLm1fYW5ndWxhckltcHVsc2UpO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMykgKyB0aGlzLm1fYW5ndWxhckltcHVsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgIHZhciBpbnZfaCA9IHN0ZXAuaW52X2R0O1xuICAgICAgICB7XG4gICAgICAgICAgdmFyIENkb3QgPSB3QiAtIHdBICsgaW52X2ggKiB0aGlzLm1fY29ycmVjdGlvbkZhY3RvciAqIHRoaXMubV9hbmd1bGFyRXJyb3I7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX2FuZ3VsYXJNYXNzICogQ2RvdDtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9hbmd1bGFySW1wdWxzZTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IGggKiB0aGlzLm1fbWF4VG9ycXVlO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFySW1wdWxzZSA9IGNsYW1wKHRoaXMubV9hbmd1bGFySW1wdWxzZSArIGltcHVsc2UsIC1tYXhJbXB1bHNlLCBtYXhJbXB1bHNlKTtcbiAgICAgICAgICBpbXB1bHNlID0gdGhpcy5tX2FuZ3VsYXJJbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2U7XG4gICAgICAgICAgd0IgKz0gaUIgKiBpbXB1bHNlO1xuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuemVybygpO1xuICAgICAgICAgIENkb3QuYWRkQ29tYmluZSgxLCB2QjIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpKTtcbiAgICAgICAgICBDZG90LnN1YkNvbWJpbmUoMSwgdkEyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QSwgdGhpcy5tX3JBKSk7XG4gICAgICAgICAgQ2RvdC5hZGRNdWwoaW52X2ggKiB0aGlzLm1fY29ycmVjdGlvbkZhY3RvciwgdGhpcy5tX2xpbmVhckVycm9yKTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IFZlYzIubmVnKE1hdDIyLm11bFZlYzIodGhpcy5tX2xpbmVhck1hc3MsIENkb3QpKTtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IFZlYzIuY2xvbmUodGhpcy5tX2xpbmVhckltcHVsc2UpO1xuICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLmFkZChpbXB1bHNlKTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IGggKiB0aGlzLm1fbWF4Rm9yY2U7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuY2xhbXAobWF4SW1wdWxzZSk7XG4gICAgICAgICAgaW1wdWxzZSA9IFZlYzIuc3ViKHRoaXMubV9saW5lYXJJbXB1bHNlLCBvbGRJbXB1bHNlKTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBpbXB1bHNlKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIGltcHVsc2UpO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIGltcHVsc2UpO1xuICAgICAgICAgIHdCICs9IGlCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgaW1wdWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIuVFlQRSA9IFwibW90b3Itam9pbnRcIjtcbiAgICAgIHJldHVybiBNb3RvckpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgbWF0aF9QSSQyID0gTWF0aC5QSTtcbiAgdmFyIERFRkFVTFRTJDQgPSB7XG4gICAgbWF4Rm9yY2U6IDAsXG4gICAgZnJlcXVlbmN5SHo6IDUsXG4gICAgZGFtcGluZ1JhdGlvOiAwLjdcbiAgfTtcbiAgdmFyIE1vdXNlSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKE1vdXNlSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gTW91c2VKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIHRhcmdldCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIE1vdXNlSm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgTW91c2VKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDQpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gTW91c2VKb2ludDIuVFlQRTtcbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZCh0YXJnZXQpKSB7XG4gICAgICAgICAgX3RoaXMubV90YXJnZXRBID0gVmVjMi5jbG9uZSh0YXJnZXQpO1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYudGFyZ2V0KSkge1xuICAgICAgICAgIF90aGlzLm1fdGFyZ2V0QSA9IFZlYzIuY2xvbmUoZGVmLnRhcmdldCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMubV90YXJnZXRBID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBUcmFuc2Zvcm0ubXVsVFZlYzIoYm9keUIuZ2V0VHJhbnNmb3JtKCksIF90aGlzLm1fdGFyZ2V0QSk7XG4gICAgICAgIF90aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICBfdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIF90aGlzLm1fYmV0YSA9IDA7XG4gICAgICAgIF90aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICBfdGhpcy5tX3JCID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxDZW50ZXJCID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1faW52TWFzc0IgPSAwO1xuICAgICAgICBfdGhpcy5tX2ludklCID0gMDtcbiAgICAgICAgX3RoaXMubV9tYXNzID0gbmV3IE1hdDIyKCk7XG4gICAgICAgIF90aGlzLm1fQyA9IFZlYzIuemVybygpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICB0YXJnZXQ6IHRoaXMubV90YXJnZXRBLFxuICAgICAgICAgIG1heEZvcmNlOiB0aGlzLm1fbWF4Rm9yY2UsXG4gICAgICAgICAgZnJlcXVlbmN5SHo6IHRoaXMubV9mcmVxdWVuY3lIeixcbiAgICAgICAgICBkYW1waW5nUmF0aW86IHRoaXMubV9kYW1waW5nUmF0aW8sXG4gICAgICAgICAgX2xvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQlxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICBkYXRhLnRhcmdldCA9IFZlYzIuY2xvbmUoZGF0YS50YXJnZXQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgTW91c2VKb2ludDIoZGF0YSk7XG4gICAgICAgIGlmIChkYXRhLl9sb2NhbEFuY2hvckIpIHtcbiAgICAgICAgICBqb2ludC5tX2xvY2FsQW5jaG9yQiA9IGRhdGEuX2xvY2FsQW5jaG9yQjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhGb3JjZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZnJlcXVlbmN5SHopKSB7XG4gICAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmRhbXBpbmdSYXRpbykpIHtcbiAgICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zZXRUYXJnZXQgPSBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgICAgaWYgKFZlYzIuYXJlRXF1YWwodGFyZ2V0LCB0aGlzLm1fdGFyZ2V0QSkpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV90YXJnZXRBLnNldCh0YXJnZXQpO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXRUYXJnZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90YXJnZXRBO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhGb3JjZSA9IGZ1bmN0aW9uKGZvcmNlKSB7XG4gICAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGZvcmNlO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhGb3JjZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heEZvcmNlO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zZXRGcmVxdWVuY3kgPSBmdW5jdGlvbihoeikge1xuICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBoejtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0RnJlcXVlbmN5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLnNldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uKHJhdGlvKSB7XG4gICAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSByYXRpbztcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZGFtcGluZ1JhdGlvO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyLmNsb25lKHRoaXMubV90YXJnZXRBKTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubXVsTnVtVmVjMihpbnZfZHQsIHRoaXMubV9pbXB1bHNlKTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIDA7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLnNoaWZ0T3JpZ2luID0gZnVuY3Rpb24obmV3T3JpZ2luKSB7XG4gICAgICAgIHRoaXMubV90YXJnZXRBLnN1YihuZXdPcmlnaW4pO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgcG9zaXRpb24gPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbjtcbiAgICAgICAgdmFyIHZlbG9jaXR5ID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciBjQjIgPSBwb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSBwb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciBtYXNzID0gdGhpcy5tX2JvZHlCLmdldE1hc3MoKTtcbiAgICAgICAgdmFyIG9tZWdhID0gMiAqIG1hdGhfUEkkMiAqIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgICAgdmFyIGQyID0gMiAqIG1hc3MgKiB0aGlzLm1fZGFtcGluZ1JhdGlvICogb21lZ2E7XG4gICAgICAgIHZhciBrID0gbWFzcyAqIChvbWVnYSAqIG9tZWdhKTtcbiAgICAgICAgdmFyIGggPSBzdGVwLmR0O1xuICAgICAgICB0aGlzLm1fZ2FtbWEgPSBoICogKGQyICsgaCAqIGspO1xuICAgICAgICBpZiAodGhpcy5tX2dhbW1hICE9IDApIHtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSAxIC8gdGhpcy5tX2dhbW1hO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9iZXRhID0gaCAqIGsgKiB0aGlzLm1fZ2FtbWE7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBLID0gbmV3IE1hdDIyKCk7XG4gICAgICAgIEsuZXgueCA9IHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQiAqIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnkgKyB0aGlzLm1fZ2FtbWE7XG4gICAgICAgIEsuZXgueSA9IC10aGlzLm1faW52SUIgKiB0aGlzLm1fckIueCAqIHRoaXMubV9yQi55O1xuICAgICAgICBLLmV5LnggPSBLLmV4Lnk7XG4gICAgICAgIEsuZXkueSA9IHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQiAqIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLnggKyB0aGlzLm1fZ2FtbWE7XG4gICAgICAgIHRoaXMubV9tYXNzID0gSy5nZXRJbnZlcnNlKCk7XG4gICAgICAgIHRoaXMubV9DLnNldFZlYzIoY0IyKTtcbiAgICAgICAgdGhpcy5tX0MuYWRkQ29tYmluZSgxLCB0aGlzLm1fckIsIC0xLCB0aGlzLm1fdGFyZ2V0QSk7XG4gICAgICAgIHRoaXMubV9DLm11bCh0aGlzLm1fYmV0YSk7XG4gICAgICAgIHdCICo9IDAuOTg7XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLm11bChzdGVwLmR0UmF0aW8pO1xuICAgICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCB0aGlzLm1faW1wdWxzZSk7XG4gICAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgdGhpcy5tX2ltcHVsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnNldFplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICB2ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2ZWxvY2l0eSA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5O1xuICAgICAgICB2YXIgdkIyID0gVmVjMi5jbG9uZSh2ZWxvY2l0eS52KTtcbiAgICAgICAgdmFyIHdCID0gdmVsb2NpdHkudztcbiAgICAgICAgdmFyIENkb3QgPSBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKTtcbiAgICAgICAgQ2RvdC5hZGQodkIyKTtcbiAgICAgICAgQ2RvdC5hZGRDb21iaW5lKDEsIHRoaXMubV9DLCB0aGlzLm1fZ2FtbWEsIHRoaXMubV9pbXB1bHNlKTtcbiAgICAgICAgQ2RvdC5uZWcoKTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSBNYXQyMi5tdWxWZWMyKHRoaXMubV9tYXNzLCBDZG90KTtcbiAgICAgICAgdmFyIG9sZEltcHVsc2UgPSBWZWMyLmNsb25lKHRoaXMubV9pbXB1bHNlKTtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UuYWRkKGltcHVsc2UpO1xuICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4Rm9yY2U7XG4gICAgICAgIHRoaXMubV9pbXB1bHNlLmNsYW1wKG1heEltcHVsc2UpO1xuICAgICAgICBpbXB1bHNlID0gVmVjMi5zdWIodGhpcy5tX2ltcHVsc2UsIG9sZEltcHVsc2UpO1xuICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgaW1wdWxzZSk7XG4gICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIGltcHVsc2UpO1xuICAgICAgICB2ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLlRZUEUgPSBcIm1vdXNlLWpvaW50XCI7XG4gICAgICByZXR1cm4gTW91c2VKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIG1hdGhfYWJzJDIgPSBNYXRoLmFicztcbiAgdmFyIERFRkFVTFRTJDMgPSB7XG4gICAgY29sbGlkZUNvbm5lY3RlZDogdHJ1ZVxuICB9O1xuICB2YXIgUHVsbGV5Sm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFB1bGxleUpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIFB1bGxleUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgZ3JvdW5kQSwgZ3JvdW5kQiwgYW5jaG9yQSwgYW5jaG9yQiwgcmF0aW8pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBQdWxsZXlKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBQdWxsZXlKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGdyb3VuZEEsIGdyb3VuZEIsIGFuY2hvckEsIGFuY2hvckIsIHJhdGlvKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkMyk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBQdWxsZXlKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9ncm91bmRBbmNob3JBID0gVmVjMi5jbG9uZShncm91bmRBID8gZ3JvdW5kQSA6IGRlZi5ncm91bmRBbmNob3JBIHx8IFZlYzIubmVvKC0xLCAxKSk7XG4gICAgICAgIF90aGlzLm1fZ3JvdW5kQW5jaG9yQiA9IFZlYzIuY2xvbmUoZ3JvdW5kQiA/IGdyb3VuZEIgOiBkZWYuZ3JvdW5kQW5jaG9yQiB8fCBWZWMyLm5lbygxLCAxKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShhbmNob3JBID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3JBKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi5uZW8oLTEsIDApKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLmNsb25lKGFuY2hvckIgPyBib2R5Qi5nZXRMb2NhbFBvaW50KGFuY2hvckIpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLm5lbygxLCAwKSk7XG4gICAgICAgIF90aGlzLm1fbGVuZ3RoQSA9IE51bWJlci5pc0Zpbml0ZShkZWYubGVuZ3RoQSkgPyBkZWYubGVuZ3RoQSA6IFZlYzIuZGlzdGFuY2UoYW5jaG9yQSwgZ3JvdW5kQSk7XG4gICAgICAgIF90aGlzLm1fbGVuZ3RoQiA9IE51bWJlci5pc0Zpbml0ZShkZWYubGVuZ3RoQikgPyBkZWYubGVuZ3RoQiA6IFZlYzIuZGlzdGFuY2UoYW5jaG9yQiwgZ3JvdW5kQik7XG4gICAgICAgIF90aGlzLm1fcmF0aW8gPSBOdW1iZXIuaXNGaW5pdGUocmF0aW8pID8gcmF0aW8gOiBkZWYucmF0aW87XG4gICAgICAgIF90aGlzLm1fY29uc3RhbnQgPSBfdGhpcy5tX2xlbmd0aEEgKyBfdGhpcy5tX3JhdGlvICogX3RoaXMubV9sZW5ndGhCO1xuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgZ3JvdW5kQW5jaG9yQTogdGhpcy5tX2dyb3VuZEFuY2hvckEsXG4gICAgICAgICAgZ3JvdW5kQW5jaG9yQjogdGhpcy5tX2dyb3VuZEFuY2hvckIsXG4gICAgICAgICAgbG9jYWxBbmNob3JBOiB0aGlzLm1fbG9jYWxBbmNob3JBLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQixcbiAgICAgICAgICBsZW5ndGhBOiB0aGlzLm1fbGVuZ3RoQSxcbiAgICAgICAgICBsZW5ndGhCOiB0aGlzLm1fbGVuZ3RoQixcbiAgICAgICAgICByYXRpbzogdGhpcy5tX3JhdGlvXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgUHVsbGV5Sm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChkZWYuZ3JvdW5kQW5jaG9yQSkpIHtcbiAgICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yQS5zZXQoZGVmLmdyb3VuZEFuY2hvckEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChWZWMyLmlzVmFsaWQoZGVmLmdyb3VuZEFuY2hvckIpKSB7XG4gICAgICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvckIuc2V0KGRlZi5ncm91bmRBbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5sb2NhbEFuY2hvckEpKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXQoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH0gZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5hbmNob3JBKSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0KHRoaXMubV9ib2R5QS5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JBKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChkZWYubG9jYWxBbmNob3JCKSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0KGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYuYW5jaG9yQikpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldCh0aGlzLm1fYm9keUIuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmxlbmd0aEEpKSB7XG4gICAgICAgICAgdGhpcy5tX2xlbmd0aEEgPSBkZWYubGVuZ3RoQTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5sZW5ndGhCKSkge1xuICAgICAgICAgIHRoaXMubV9sZW5ndGhCID0gZGVmLmxlbmd0aEI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYucmF0aW8pKSB7XG4gICAgICAgICAgdGhpcy5tX3JhdGlvID0gZGVmLnJhdGlvO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRHcm91bmRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZ3JvdW5kQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldEdyb3VuZEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ncm91bmRBbmNob3JCO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0TGVuZ3RoQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xlbmd0aEE7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRMZW5ndGhCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbGVuZ3RoQjtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldFJhdGlvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmF0aW87XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRDdXJyZW50TGVuZ3RoQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcCA9IHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgICB2YXIgczIgPSB0aGlzLm1fZ3JvdW5kQW5jaG9yQTtcbiAgICAgICAgcmV0dXJuIFZlYzIuZGlzdGFuY2UocCwgczIpO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0Q3VycmVudExlbmd0aEIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHAgPSB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgICAgdmFyIHMyID0gdGhpcy5tX2dyb3VuZEFuY2hvckI7XG4gICAgICAgIHJldHVybiBWZWMyLmRpc3RhbmNlKHAsIHMyKTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLnNoaWZ0T3JpZ2luID0gZnVuY3Rpb24obmV3T3JpZ2luKSB7XG4gICAgICAgIHRoaXMubV9ncm91bmRBbmNob3JBLnN1YihuZXdPcmlnaW4pO1xuICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yQi5zdWIobmV3T3JpZ2luKTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm11bE51bVZlYzIodGhpcy5tX2ltcHVsc2UsIHRoaXMubV91QikubXVsKGludl9kdCk7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdGhpcy5tX3VBID0gVmVjMi5zdWIoVmVjMi5hZGQoY0EyLCB0aGlzLm1fckEpLCB0aGlzLm1fZ3JvdW5kQW5jaG9yQSk7XG4gICAgICAgIHRoaXMubV91QiA9IFZlYzIuc3ViKFZlYzIuYWRkKGNCMiwgdGhpcy5tX3JCKSwgdGhpcy5tX2dyb3VuZEFuY2hvckIpO1xuICAgICAgICB2YXIgbGVuZ3RoQSA9IHRoaXMubV91QS5sZW5ndGgoKTtcbiAgICAgICAgdmFyIGxlbmd0aEIgPSB0aGlzLm1fdUIubGVuZ3RoKCk7XG4gICAgICAgIGlmIChsZW5ndGhBID4gMTAgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3ApIHtcbiAgICAgICAgICB0aGlzLm1fdUEubXVsKDEgLyBsZW5ndGhBKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdUEuc2V0WmVybygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsZW5ndGhCID4gMTAgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3ApIHtcbiAgICAgICAgICB0aGlzLm1fdUIubXVsKDEgLyBsZW5ndGhCKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdUIuc2V0WmVybygpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBydUEgPSBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCB0aGlzLm1fdUEpO1xuICAgICAgICB2YXIgcnVCID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgdGhpcy5tX3VCKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBICsgdGhpcy5tX2ludklBICogcnVBICogcnVBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUIgKiBydUIgKiBydUI7XG4gICAgICAgIHRoaXMubV9tYXNzID0gbUEgKyB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiBtQjtcbiAgICAgICAgaWYgKHRoaXMubV9tYXNzID4gMCkge1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gMSAvIHRoaXMubV9tYXNzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUEEgPSBWZWMyLm11bE51bVZlYzIoLXRoaXMubV9pbXB1bHNlLCB0aGlzLm1fdUEpO1xuICAgICAgICAgIHZhciBQQiA9IFZlYzIubXVsTnVtVmVjMigtdGhpcy5tX3JhdGlvICogdGhpcy5tX2ltcHVsc2UsIHRoaXMubV91Qik7XG4gICAgICAgICAgdkEyLmFkZE11bCh0aGlzLm1faW52TWFzc0EsIFBBKTtcbiAgICAgICAgICB3QSArPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQQSk7XG4gICAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFBCKTtcbiAgICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQQik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2cEEgPSBWZWMyLmFkZCh2QTIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgdmFyIHZwQiA9IFZlYzIuYWRkKHZCMiwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpO1xuICAgICAgICB2YXIgQ2RvdCA9IC1WZWMyLmRvdCh0aGlzLm1fdUEsIHZwQSkgLSB0aGlzLm1fcmF0aW8gKiBWZWMyLmRvdCh0aGlzLm1fdUIsIHZwQik7XG4gICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tYXNzICogQ2RvdDtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UgKz0gaW1wdWxzZTtcbiAgICAgICAgdmFyIFBBID0gVmVjMi5tdWxOdW1WZWMyKC1pbXB1bHNlLCB0aGlzLm1fdUEpO1xuICAgICAgICB2YXIgUEIgPSBWZWMyLm11bE51bVZlYzIoLXRoaXMubV9yYXRpbyAqIGltcHVsc2UsIHRoaXMubV91Qik7XG4gICAgICAgIHZBMi5hZGRNdWwodGhpcy5tX2ludk1hc3NBLCBQQSk7XG4gICAgICAgIHdBICs9IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFBBKTtcbiAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFBCKTtcbiAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUEIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIHVBID0gVmVjMi5zdWIoVmVjMi5hZGQoY0EyLCB0aGlzLm1fckEpLCB0aGlzLm1fZ3JvdW5kQW5jaG9yQSk7XG4gICAgICAgIHZhciB1QiA9IFZlYzIuc3ViKFZlYzIuYWRkKGNCMiwgdGhpcy5tX3JCKSwgdGhpcy5tX2dyb3VuZEFuY2hvckIpO1xuICAgICAgICB2YXIgbGVuZ3RoQSA9IHVBLmxlbmd0aCgpO1xuICAgICAgICB2YXIgbGVuZ3RoQiA9IHVCLmxlbmd0aCgpO1xuICAgICAgICBpZiAobGVuZ3RoQSA+IDEwICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKSB7XG4gICAgICAgICAgdUEubXVsKDEgLyBsZW5ndGhBKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB1QS5zZXRaZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxlbmd0aEIgPiAxMCAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCkge1xuICAgICAgICAgIHVCLm11bCgxIC8gbGVuZ3RoQik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdUIuc2V0WmVybygpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBydUEgPSBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCB1QSk7XG4gICAgICAgIHZhciBydUIgPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB1Qik7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQSArIHRoaXMubV9pbnZJQSAqIHJ1QSAqIHJ1QTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklCICogcnVCICogcnVCO1xuICAgICAgICB2YXIgbWFzcyA9IG1BICsgdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogbUI7XG4gICAgICAgIGlmIChtYXNzID4gMCkge1xuICAgICAgICAgIG1hc3MgPSAxIC8gbWFzcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgQyA9IHRoaXMubV9jb25zdGFudCAtIGxlbmd0aEEgLSB0aGlzLm1fcmF0aW8gKiBsZW5ndGhCO1xuICAgICAgICB2YXIgbGluZWFyRXJyb3IgPSBtYXRoX2FicyQyKEMpO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IC1tYXNzICogQztcbiAgICAgICAgdmFyIFBBID0gVmVjMi5tdWxOdW1WZWMyKC1pbXB1bHNlLCB1QSk7XG4gICAgICAgIHZhciBQQiA9IFZlYzIubXVsTnVtVmVjMigtdGhpcy5tX3JhdGlvICogaW1wdWxzZSwgdUIpO1xuICAgICAgICBjQTIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQSwgUEEpO1xuICAgICAgICBhQSArPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCBQQSk7XG4gICAgICAgIGNCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQQik7XG4gICAgICAgIGFCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIFBCKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYyA9IGNBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jID0gY0IyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBsaW5lYXJFcnJvciA8IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIuVFlQRSA9IFwicHVsbGV5LWpvaW50XCI7XG4gICAgICByZXR1cm4gUHVsbGV5Sm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBtYXRoX21pbiQxID0gTWF0aC5taW47XG4gIHZhciBMaW1pdFN0YXRlO1xuICAoZnVuY3Rpb24oTGltaXRTdGF0ZTIpIHtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImluYWN0aXZlTGltaXRcIl0gPSAwXSA9IFwiaW5hY3RpdmVMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiYXRMb3dlckxpbWl0XCJdID0gMV0gPSBcImF0TG93ZXJMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiYXRVcHBlckxpbWl0XCJdID0gMl0gPSBcImF0VXBwZXJMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiZXF1YWxMaW1pdHNcIl0gPSAzXSA9IFwiZXF1YWxMaW1pdHNcIjtcbiAgfSkoTGltaXRTdGF0ZSB8fCAoTGltaXRTdGF0ZSA9IHt9KSk7XG4gIHZhciBERUZBVUxUUyQyID0ge1xuICAgIG1heExlbmd0aDogMFxuICB9O1xuICB2YXIgUm9wZUpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhSb3BlSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gUm9wZUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgUm9wZUpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFJvcGVKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvcik7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDIpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gUm9wZUpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQSB8fCBWZWMyLm5lbygtMSwgMCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLm5lbygxLCAwKSk7XG4gICAgICAgIF90aGlzLm1fbWF4TGVuZ3RoID0gZGVmLm1heExlbmd0aDtcbiAgICAgICAgX3RoaXMubV9tYXNzID0gMDtcbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgX3RoaXMubV9sZW5ndGggPSAwO1xuICAgICAgICBfdGhpcy5tX3N0YXRlID0gTGltaXRTdGF0ZS5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckIsXG4gICAgICAgICAgbWF4TGVuZ3RoOiB0aGlzLm1fbWF4TGVuZ3RoXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IFJvcGVKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4TGVuZ3RoKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhMZW5ndGggPSBkZWYubWF4TGVuZ3RoO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhMZW5ndGggPSBmdW5jdGlvbihsZW5ndGgpIHtcbiAgICAgICAgdGhpcy5tX21heExlbmd0aCA9IGxlbmd0aDtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhMZW5ndGggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhMZW5ndGg7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuZ2V0TGltaXRTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3N0YXRlO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubXVsTnVtVmVjMih0aGlzLm1faW1wdWxzZSwgdGhpcy5tX3UpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFN1YihxQSwgdGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxTdWIocUIsIHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpO1xuICAgICAgICB0aGlzLm1fdSA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLm1fdS5hZGRDb21iaW5lKDEsIGNCMiwgMSwgdGhpcy5tX3JCKTtcbiAgICAgICAgdGhpcy5tX3Uuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHRoaXMubV9yQSk7XG4gICAgICAgIHRoaXMubV9sZW5ndGggPSB0aGlzLm1fdS5sZW5ndGgoKTtcbiAgICAgICAgdmFyIEMgPSB0aGlzLm1fbGVuZ3RoIC0gdGhpcy5tX21heExlbmd0aDtcbiAgICAgICAgaWYgKEMgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX3N0YXRlID0gTGltaXRTdGF0ZS5hdFVwcGVyTGltaXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3N0YXRlID0gTGltaXRTdGF0ZS5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fbGVuZ3RoID4gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKSB7XG4gICAgICAgICAgdGhpcy5tX3UubXVsKDEgLyB0aGlzLm1fbGVuZ3RoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSAwO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNyQSA9IFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIHRoaXMubV91KTtcbiAgICAgICAgdmFyIGNyQiA9IFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIHRoaXMubV91KTtcbiAgICAgICAgdmFyIGludk1hc3MgPSB0aGlzLm1faW52TWFzc0EgKyB0aGlzLm1faW52SUEgKiBjckEgKiBjckEgKyB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUIgKiBjckIgKiBjckI7XG4gICAgICAgIHRoaXMubV9tYXNzID0gaW52TWFzcyAhPSAwID8gMSAvIGludk1hc3MgOiAwO1xuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fdSk7XG4gICAgICAgICAgdkEyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgICB3QSAtPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMyk7XG4gICAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFAzKTtcbiAgICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2cEEgPSBWZWMyLmFkZENyb3NzTnVtVmVjMih2QTIsIHdBLCB0aGlzLm1fckEpO1xuICAgICAgICB2YXIgdnBCID0gVmVjMi5hZGRDcm9zc051bVZlYzIodkIyLCB3QiwgdGhpcy5tX3JCKTtcbiAgICAgICAgdmFyIEMgPSB0aGlzLm1fbGVuZ3RoIC0gdGhpcy5tX21heExlbmd0aDtcbiAgICAgICAgdmFyIENkb3QgPSBWZWMyLmRvdCh0aGlzLm1fdSwgVmVjMi5zdWIodnBCLCB2cEEpKTtcbiAgICAgICAgaWYgKEMgPCAwKSB7XG4gICAgICAgICAgQ2RvdCArPSBzdGVwLmludl9kdCAqIEM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21hc3MgKiBDZG90O1xuICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9pbXB1bHNlO1xuICAgICAgICB0aGlzLm1faW1wdWxzZSA9IG1hdGhfbWluJDEoMCwgdGhpcy5tX2ltcHVsc2UgKyBpbXB1bHNlKTtcbiAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9pbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIHRoaXMubV91KTtcbiAgICAgICAgdkEyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgd0EgLT0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpO1xuICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMyk7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsU3ViKHFBLCB0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxTdWIocUIsIHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpO1xuICAgICAgICB2YXIgdSA9IFZlYzIuemVybygpO1xuICAgICAgICB1LmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICB1LnN1YkNvbWJpbmUoMSwgY0EyLCAxLCByQTIpO1xuICAgICAgICB2YXIgbGVuZ3RoID0gdS5ub3JtYWxpemUoKTtcbiAgICAgICAgdmFyIEMgPSBsZW5ndGggLSB0aGlzLm1fbWF4TGVuZ3RoO1xuICAgICAgICBDID0gY2xhbXAoQywgMCwgU2V0dGluZ3NJbnRlcm5hbC5tYXhMaW5lYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21hc3MgKiBDO1xuICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoaW1wdWxzZSwgdSk7XG4gICAgICAgIGNBMi5zdWJNdWwodGhpcy5tX2ludk1hc3NBLCBQMyk7XG4gICAgICAgIGFBIC09IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIFAzKTtcbiAgICAgICAgY0IyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFAzKTtcbiAgICAgICAgYUIgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgUDMpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jLnNldFZlYzIoY0EyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jLnNldFZlYzIoY0IyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICByZXR1cm4gbGVuZ3RoIC0gdGhpcy5tX21heExlbmd0aCA8IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLlRZUEUgPSBcInJvcGUtam9pbnRcIjtcbiAgICAgIHJldHVybiBSb3BlSm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBtYXRoX2FicyQxID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX1BJJDEgPSBNYXRoLlBJO1xuICB2YXIgREVGQVVMVFMkMSA9IHtcbiAgICBmcmVxdWVuY3lIejogMCxcbiAgICBkYW1waW5nUmF0aW86IDBcbiAgfTtcbiAgdmFyIFdlbGRKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoV2VsZEpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIFdlbGRKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIFdlbGRKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBXZWxkSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQxKTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IFdlbGRKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBOdW1iZXIuaXNGaW5pdGUoZGVmLnJlZmVyZW5jZUFuZ2xlKSA/IGRlZi5yZWZlcmVuY2VBbmdsZSA6IGJvZHlCLmdldEFuZ2xlKCkgLSBib2R5QS5nZXRBbmdsZSgpO1xuICAgICAgICBfdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICBfdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IG5ldyBWZWMzKCk7XG4gICAgICAgIF90aGlzLm1fYmlhcyA9IDA7XG4gICAgICAgIF90aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICBfdGhpcy5tX21hc3MgPSBuZXcgTWF0MzMoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBmcmVxdWVuY3lIejogdGhpcy5tX2ZyZXF1ZW5jeUh6LFxuICAgICAgICAgIGRhbXBpbmdSYXRpbzogdGhpcy5tX2RhbXBpbmdSYXRpbyxcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCLFxuICAgICAgICAgIHJlZmVyZW5jZUFuZ2xlOiB0aGlzLm1fcmVmZXJlbmNlQW5nbGVcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgV2VsZEpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoZGVmLmFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIodGhpcy5tX2JvZHlBLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckEpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMih0aGlzLm1fYm9keUIuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQikpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZnJlcXVlbmN5SHopKSB7XG4gICAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmRhbXBpbmdSYXRpbykpIHtcbiAgICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0UmVmZXJlbmNlQW5nbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5zZXRGcmVxdWVuY3kgPSBmdW5jdGlvbihoeikge1xuICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBoejtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXRGcmVxdWVuY3kgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5zZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbihyYXRpbykge1xuICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gcmF0aW87XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZGFtcGluZ1JhdGlvO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHRoaXMubV9pbXB1bHNlLngsIHRoaXMubV9pbXB1bHNlLnkpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS56O1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHRoaXMubV9yQSA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIEsgPSBuZXcgTWF0MzMoKTtcbiAgICAgICAgSy5leC54ID0gbUEgKyBtQiArIHRoaXMubV9yQS55ICogdGhpcy5tX3JBLnkgKiBpQSArIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnkgKiBpQjtcbiAgICAgICAgSy5leS54ID0gLXRoaXMubV9yQS55ICogdGhpcy5tX3JBLnggKiBpQSAtIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnggKiBpQjtcbiAgICAgICAgSy5lei54ID0gLXRoaXMubV9yQS55ICogaUEgLSB0aGlzLm1fckIueSAqIGlCO1xuICAgICAgICBLLmV4LnkgPSBLLmV5Lng7XG4gICAgICAgIEsuZXkueSA9IG1BICsgbUIgKyB0aGlzLm1fckEueCAqIHRoaXMubV9yQS54ICogaUEgKyB0aGlzLm1fckIueCAqIHRoaXMubV9yQi54ICogaUI7XG4gICAgICAgIEsuZXoueSA9IHRoaXMubV9yQS54ICogaUEgKyB0aGlzLm1fckIueCAqIGlCO1xuICAgICAgICBLLmV4LnogPSBLLmV6Lng7XG4gICAgICAgIEsuZXkueiA9IEsuZXoueTtcbiAgICAgICAgSy5lei56ID0gaUEgKyBpQjtcbiAgICAgICAgaWYgKHRoaXMubV9mcmVxdWVuY3lIeiA+IDApIHtcbiAgICAgICAgICBLLmdldEludmVyc2UyMih0aGlzLm1fbWFzcyk7XG4gICAgICAgICAgdmFyIGludk0gPSBpQSArIGlCO1xuICAgICAgICAgIHZhciBtID0gaW52TSA+IDAgPyAxIC8gaW52TSA6IDA7XG4gICAgICAgICAgdmFyIEMgPSBhQiAtIGFBIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIHZhciBvbWVnYSA9IDIgKiBtYXRoX1BJJDEgKiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICAgICAgdmFyIGQyID0gMiAqIG0gKiB0aGlzLm1fZGFtcGluZ1JhdGlvICogb21lZ2E7XG4gICAgICAgICAgdmFyIGsgPSBtICogb21lZ2EgKiBvbWVnYTtcbiAgICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gaCAqIChkMiArIGggKiBrKTtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSB0aGlzLm1fZ2FtbWEgIT0gMCA/IDEgLyB0aGlzLm1fZ2FtbWEgOiAwO1xuICAgICAgICAgIHRoaXMubV9iaWFzID0gQyAqIGggKiBrICogdGhpcy5tX2dhbW1hO1xuICAgICAgICAgIGludk0gKz0gdGhpcy5tX2dhbW1hO1xuICAgICAgICAgIHRoaXMubV9tYXNzLmV6LnogPSBpbnZNICE9IDAgPyAxIC8gaW52TSA6IDA7XG4gICAgICAgIH0gZWxzZSBpZiAoSy5lei56ID09IDApIHtcbiAgICAgICAgICBLLmdldEludmVyc2UyMih0aGlzLm1fbWFzcyk7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gMDtcbiAgICAgICAgICB0aGlzLm1fYmlhcyA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgSy5nZXRTeW1JbnZlcnNlMzModGhpcy5tX21hc3MpO1xuICAgICAgICAgIHRoaXMubV9nYW1tYSA9IDA7XG4gICAgICAgICAgdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLm11bChzdGVwLmR0UmF0aW8pO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVvKHRoaXMubV9pbXB1bHNlLngsIHRoaXMubV9pbXB1bHNlLnkpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMykgKyB0aGlzLm1faW1wdWxzZS56KTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpICsgdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2Uuc2V0WmVybygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIGlmICh0aGlzLm1fZnJlcXVlbmN5SHogPiAwKSB7XG4gICAgICAgICAgdmFyIENkb3QyID0gd0IgLSB3QTtcbiAgICAgICAgICB2YXIgaW1wdWxzZTIgPSAtdGhpcy5tX21hc3MuZXoueiAqIChDZG90MiArIHRoaXMubV9iaWFzICsgdGhpcy5tX2dhbW1hICogdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiArPSBpbXB1bHNlMjtcbiAgICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2UyO1xuICAgICAgICAgIHdCICs9IGlCICogaW1wdWxzZTI7XG4gICAgICAgICAgdmFyIENkb3QxID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQ2RvdDEuYWRkQ29tYmluZSgxLCB2QjIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpKTtcbiAgICAgICAgICBDZG90MS5zdWJDb21iaW5lKDEsIHZBMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0EsIHRoaXMubV9yQSkpO1xuICAgICAgICAgIHZhciBpbXB1bHNlMSA9IFZlYzIubmVnKE1hdDMzLm11bFZlYzIodGhpcy5tX21hc3MsIENkb3QxKSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSBpbXB1bHNlMS54O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gaW1wdWxzZTEueTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLmNsb25lKGltcHVsc2UxKTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMyk7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBDZG90MSA9IFZlYzIuemVybygpO1xuICAgICAgICAgIENkb3QxLmFkZENvbWJpbmUoMSwgdkIyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKSk7XG4gICAgICAgICAgQ2RvdDEuc3ViQ29tYmluZSgxLCB2QTIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgICB2YXIgQ2RvdDIgPSB3QiAtIHdBO1xuICAgICAgICAgIHZhciBDZG90ID0gbmV3IFZlYzMoQ2RvdDEueCwgQ2RvdDEueSwgQ2RvdDIpO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gVmVjMy5uZWcoTWF0MzMubXVsVmVjMyh0aGlzLm1fbWFzcywgQ2RvdCkpO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLmFkZChpbXB1bHNlKTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm5lbyhpbXB1bHNlLngsIGltcHVsc2UueSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKSArIGltcHVsc2Uueik7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKSArIGltcHVsc2Uueik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBwb3NpdGlvbkVycm9yO1xuICAgICAgICB2YXIgYW5ndWxhckVycm9yO1xuICAgICAgICB2YXIgSyA9IG5ldyBNYXQzMygpO1xuICAgICAgICBLLmV4LnggPSBtQSArIG1CICsgckEyLnkgKiByQTIueSAqIGlBICsgckIyLnkgKiByQjIueSAqIGlCO1xuICAgICAgICBLLmV5LnggPSAtckEyLnkgKiByQTIueCAqIGlBIC0gckIyLnkgKiByQjIueCAqIGlCO1xuICAgICAgICBLLmV6LnggPSAtckEyLnkgKiBpQSAtIHJCMi55ICogaUI7XG4gICAgICAgIEsuZXgueSA9IEsuZXkueDtcbiAgICAgICAgSy5leS55ID0gbUEgKyBtQiArIHJBMi54ICogckEyLnggKiBpQSArIHJCMi54ICogckIyLnggKiBpQjtcbiAgICAgICAgSy5lei55ID0gckEyLnggKiBpQSArIHJCMi54ICogaUI7XG4gICAgICAgIEsuZXgueiA9IEsuZXoueDtcbiAgICAgICAgSy5leS56ID0gSy5lei55O1xuICAgICAgICBLLmV6LnogPSBpQSArIGlCO1xuICAgICAgICBpZiAodGhpcy5tX2ZyZXF1ZW5jeUh6ID4gMCkge1xuICAgICAgICAgIHZhciBDMSA9IFZlYzIuemVybygpO1xuICAgICAgICAgIEMxLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICAgIEMxLnN1YkNvbWJpbmUoMSwgY0EyLCAxLCByQTIpO1xuICAgICAgICAgIHBvc2l0aW9uRXJyb3IgPSBDMS5sZW5ndGgoKTtcbiAgICAgICAgICBhbmd1bGFyRXJyb3IgPSAwO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVnKEsuc29sdmUyMihDMSkpO1xuICAgICAgICAgIGNBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICBhQSAtPSBpQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIFAzKTtcbiAgICAgICAgICBjQjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgYUIgKz0gaUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBQMyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIEMxID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQzEuYWRkQ29tYmluZSgxLCBjQjIsIDEsIHJCMik7XG4gICAgICAgICAgQzEuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHJBMik7XG4gICAgICAgICAgdmFyIEMyID0gYUIgLSBhQSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICBwb3NpdGlvbkVycm9yID0gQzEubGVuZ3RoKCk7XG4gICAgICAgICAgYW5ndWxhckVycm9yID0gbWF0aF9hYnMkMShDMik7XG4gICAgICAgICAgdmFyIEMgPSBuZXcgVmVjMyhDMS54LCBDMS55LCBDMik7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSBuZXcgVmVjMygpO1xuICAgICAgICAgIGlmIChLLmV6LnogPiAwKSB7XG4gICAgICAgICAgICBpbXB1bHNlID0gVmVjMy5uZWcoSy5zb2x2ZTMzKEMpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGltcHVsc2UyID0gVmVjMi5uZWcoSy5zb2x2ZTIyKEMxKSk7XG4gICAgICAgICAgICBpbXB1bHNlLnNldChpbXB1bHNlMi54LCBpbXB1bHNlMi55LCAwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5uZW8oaW1wdWxzZS54LCBpbXB1bHNlLnkpO1xuICAgICAgICAgIGNBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICBhQSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIockEyLCBQMykgKyBpbXB1bHNlLnopO1xuICAgICAgICAgIGNCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICBhQiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBQMykgKyBpbXB1bHNlLnopO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMgPSBjQTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmEgPSBhQTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYyA9IGNCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICByZXR1cm4gcG9zaXRpb25FcnJvciA8PSBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3AgJiYgYW5ndWxhckVycm9yIDw9IFNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsb3A7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5UWVBFID0gXCJ3ZWxkLWpvaW50XCI7XG4gICAgICByZXR1cm4gV2VsZEpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgbWF0aF9hYnMgPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfUEkgPSBNYXRoLlBJO1xuICB2YXIgREVGQVVMVFMgPSB7XG4gICAgZW5hYmxlTW90b3I6IGZhbHNlLFxuICAgIG1heE1vdG9yVG9ycXVlOiAwLFxuICAgIG1vdG9yU3BlZWQ6IDAsXG4gICAgZnJlcXVlbmN5SHo6IDIsXG4gICAgZGFtcGluZ1JhdGlvOiAwLjdcbiAgfTtcbiAgdmFyIFdoZWVsSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFdoZWVsSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gV2hlZWxKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvciwgYXhpcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIFdoZWVsSm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgV2hlZWxKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvciwgYXhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTKTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fYXggPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9heSA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBXaGVlbEpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQSB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5Qi5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JCIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChheGlzKSkge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxYQXhpc0EgPSBib2R5QS5nZXRMb2NhbFZlY3RvcihheGlzKTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmLmxvY2FsQXhpc0EpKSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbFhBeGlzQSA9IFZlYzIuY2xvbmUoZGVmLmxvY2FsQXhpc0EpO1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYubG9jYWxBeGlzKSkge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxYQXhpc0EgPSBWZWMyLmNsb25lKGRlZi5sb2NhbEF4aXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxYQXhpc0EgPSBWZWMyLm5lbygxLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5tX2xvY2FsWUF4aXNBID0gVmVjMi5jcm9zc051bVZlYzIoMSwgX3RoaXMubV9sb2NhbFhBeGlzQSk7XG4gICAgICAgIF90aGlzLm1fbWFzcyA9IDA7XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbW90b3JNYXNzID0gMDtcbiAgICAgICAgX3RoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX3NwcmluZ01hc3MgPSAwO1xuICAgICAgICBfdGhpcy5tX3NwcmluZ0ltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX21heE1vdG9yVG9ycXVlID0gZGVmLm1heE1vdG9yVG9ycXVlO1xuICAgICAgICBfdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcbiAgICAgICAgX3RoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcbiAgICAgICAgX3RoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgICAgX3RoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xuICAgICAgICBfdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICBfdGhpcy5tX2dhbW1hID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgZW5hYmxlTW90b3I6IHRoaXMubV9lbmFibGVNb3RvcixcbiAgICAgICAgICBtYXhNb3RvclRvcnF1ZTogdGhpcy5tX21heE1vdG9yVG9ycXVlLFxuICAgICAgICAgIG1vdG9yU3BlZWQ6IHRoaXMubV9tb3RvclNwZWVkLFxuICAgICAgICAgIGZyZXF1ZW5jeUh6OiB0aGlzLm1fZnJlcXVlbmN5SHosXG4gICAgICAgICAgZGFtcGluZ1JhdGlvOiB0aGlzLm1fZGFtcGluZ1JhdGlvLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckIsXG4gICAgICAgICAgbG9jYWxBeGlzQTogdGhpcy5tX2xvY2FsWEF4aXNBXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBXaGVlbEpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKGRlZi5hbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKHRoaXMubV9ib2R5QS5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JBKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMihkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIodGhpcy5tX2JvZHlCLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckIpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYubG9jYWxBeGlzQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbFhBeGlzQS5zZXRWZWMyKGRlZi5sb2NhbEF4aXNBKTtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxZQXhpc0Euc2V0VmVjMihWZWMyLmNyb3NzTnVtVmVjMigxLCBkZWYubG9jYWxBeGlzQSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuZW5hYmxlTW90b3IgIT09IHZvaWQgMCkge1xuICAgICAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhNb3RvclRvcnF1ZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4TW90b3JUb3JxdWUgPSBkZWYubWF4TW90b3JUb3JxdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubW90b3JTcGVlZCkpIHtcbiAgICAgICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmZyZXF1ZW5jeUh6KSkge1xuICAgICAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5kYW1waW5nUmF0aW8pKSB7XG4gICAgICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldExvY2FsQXhpc0EgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbFhBeGlzQTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnRUcmFuc2xhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgICAgdmFyIHBBMiA9IGJBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICAgIHZhciBwQjIgPSBiQi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihwQjIsIHBBMik7XG4gICAgICAgIHZhciBheGlzID0gYkEuZ2V0V29ybGRWZWN0b3IodGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgdmFyIHRyYW5zbGF0aW9uMiA9IFZlYzIuZG90KGQyLCBheGlzKTtcbiAgICAgICAgcmV0dXJuIHRyYW5zbGF0aW9uMjtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnRTcGVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgcmV0dXJuIHdCIC0gd0E7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmlzTW90b3JFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTW90b3I7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmVuYWJsZU1vdG9yID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAoZmxhZyA9PSB0aGlzLm1fZW5hYmxlTW90b3IpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZmxhZztcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuc2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uKHNwZWVkKSB7XG4gICAgICAgIGlmIChzcGVlZCA9PSB0aGlzLm1fbW90b3JTcGVlZClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IHNwZWVkO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRNb3RvclNwZWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbW90b3JTcGVlZDtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuc2V0TWF4TW90b3JUb3JxdWUgPSBmdW5jdGlvbih0b3JxdWUpIHtcbiAgICAgICAgaWYgKHRvcnF1ZSA9PSB0aGlzLm1fbWF4TW90b3JUb3JxdWUpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX21heE1vdG9yVG9ycXVlID0gdG9ycXVlO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhNb3RvclRvcnF1ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heE1vdG9yVG9ycXVlO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRNb3RvclRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuc2V0U3ByaW5nRnJlcXVlbmN5SHogPSBmdW5jdGlvbihoeikge1xuICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBoejtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0U3ByaW5nRnJlcXVlbmN5SHogPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuc2V0U3ByaW5nRGFtcGluZ1JhdGlvID0gZnVuY3Rpb24ocmF0aW8pIHtcbiAgICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IHJhdGlvO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRTcHJpbmdEYW1waW5nUmF0aW8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9kYW1waW5nUmF0aW87XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5jb21iaW5lKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fYXksIHRoaXMubV9zcHJpbmdJbXB1bHNlLCB0aGlzLm1fYXgpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIGQyLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICBkMi5zdWJDb21iaW5lKDEsIGNBMiwgMSwgckEyKTtcbiAgICAgICAge1xuICAgICAgICAgIHRoaXMubV9heSA9IFJvdC5tdWxWZWMyKHFBLCB0aGlzLm1fbG9jYWxZQXhpc0EpO1xuICAgICAgICAgIHRoaXMubV9zQXkgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIHRoaXMubV9heSk7XG4gICAgICAgICAgdGhpcy5tX3NCeSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHRoaXMubV9heSk7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fc0F5ICogdGhpcy5tX3NBeSArIGlCICogdGhpcy5tX3NCeSAqIHRoaXMubV9zQnk7XG4gICAgICAgICAgaWYgKHRoaXMubV9tYXNzID4gMCkge1xuICAgICAgICAgICAgdGhpcy5tX21hc3MgPSAxIC8gdGhpcy5tX21hc3M7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9zcHJpbmdNYXNzID0gMDtcbiAgICAgICAgdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICB0aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICBpZiAodGhpcy5tX2ZyZXF1ZW5jeUh6ID4gMCkge1xuICAgICAgICAgIHRoaXMubV9heCA9IFJvdC5tdWxWZWMyKHFBLCB0aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICAgIHRoaXMubV9zQXggPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIHRoaXMubV9heCk7XG4gICAgICAgICAgdGhpcy5tX3NCeCA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHRoaXMubV9heCk7XG4gICAgICAgICAgdmFyIGludk1hc3MgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fc0F4ICogdGhpcy5tX3NBeCArIGlCICogdGhpcy5tX3NCeCAqIHRoaXMubV9zQng7XG4gICAgICAgICAgaWYgKGludk1hc3MgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLm1fc3ByaW5nTWFzcyA9IDEgLyBpbnZNYXNzO1xuICAgICAgICAgICAgdmFyIEMgPSBWZWMyLmRvdChkMiwgdGhpcy5tX2F4KTtcbiAgICAgICAgICAgIHZhciBvbWVnYSA9IDIgKiBtYXRoX1BJICogdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgICAgICAgdmFyIGRhbXAgPSAyICogdGhpcy5tX3NwcmluZ01hc3MgKiB0aGlzLm1fZGFtcGluZ1JhdGlvICogb21lZ2E7XG4gICAgICAgICAgICB2YXIgayA9IHRoaXMubV9zcHJpbmdNYXNzICogb21lZ2EgKiBvbWVnYTtcbiAgICAgICAgICAgIHZhciBoID0gc3RlcC5kdDtcbiAgICAgICAgICAgIHRoaXMubV9nYW1tYSA9IGggKiAoZGFtcCArIGggKiBrKTtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fZ2FtbWEgPiAwKSB7XG4gICAgICAgICAgICAgIHRoaXMubV9nYW1tYSA9IDEgLyB0aGlzLm1fZ2FtbWE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1fYmlhcyA9IEMgKiBoICogayAqIHRoaXMubV9nYW1tYTtcbiAgICAgICAgICAgIHRoaXMubV9zcHJpbmdNYXNzID0gaW52TWFzcyArIHRoaXMubV9nYW1tYTtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fc3ByaW5nTWFzcyA+IDApIHtcbiAgICAgICAgICAgICAgdGhpcy5tX3NwcmluZ01hc3MgPSAxIC8gdGhpcy5tX3NwcmluZ01hc3M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9zcHJpbmdJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yKSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IGlBICsgaUI7XG4gICAgICAgICAgaWYgKHRoaXMubV9tb3Rvck1hc3MgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gMSAvIHRoaXMubV9tb3Rvck1hc3M7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSAwO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB0aGlzLm1fc3ByaW5nSW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5jb21iaW5lKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fYXksIHRoaXMubV9zcHJpbmdJbXB1bHNlLCB0aGlzLm1fYXgpO1xuICAgICAgICAgIHZhciBMQSA9IHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3NBeSArIHRoaXMubV9zcHJpbmdJbXB1bHNlICogdGhpcy5tX3NBeCArIHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICAgICAgdmFyIExCID0gdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fc0J5ICsgdGhpcy5tX3NwcmluZ0ltcHVsc2UgKiB0aGlzLm1fc0J4ICsgdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgICAgICB2QTIuc3ViTXVsKHRoaXMubV9pbnZNYXNzQSwgUDMpO1xuICAgICAgICAgIHdBIC09IHRoaXMubV9pbnZJQSAqIExBO1xuICAgICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQMyk7XG4gICAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogTEI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICAgIHRoaXMubV9zcHJpbmdJbXB1bHNlID0gMDtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52LnNldFZlYzIodkEyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB7XG4gICAgICAgICAgdmFyIENkb3QgPSBWZWMyLmRvdCh0aGlzLm1fYXgsIHZCMikgLSBWZWMyLmRvdCh0aGlzLm1fYXgsIHZBMikgKyB0aGlzLm1fc0J4ICogd0IgLSB0aGlzLm1fc0F4ICogd0E7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX3NwcmluZ01hc3MgKiAoQ2RvdCArIHRoaXMubV9iaWFzICsgdGhpcy5tX2dhbW1hICogdGhpcy5tX3NwcmluZ0ltcHVsc2UpO1xuICAgICAgICAgIHRoaXMubV9zcHJpbmdJbXB1bHNlICs9IGltcHVsc2U7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIHRoaXMubV9heCk7XG4gICAgICAgICAgdmFyIExBID0gaW1wdWxzZSAqIHRoaXMubV9zQXg7XG4gICAgICAgICAgdmFyIExCID0gaW1wdWxzZSAqIHRoaXMubV9zQng7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogTEE7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogTEI7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIHZhciBDZG90ID0gd0IgLSB3QSAtIHRoaXMubV9tb3RvclNwZWVkO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tb3Rvck1hc3MgKiBDZG90O1xuICAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4TW90b3JUb3JxdWU7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IGNsYW1wKHRoaXMubV9tb3RvckltcHVsc2UgKyBpbXB1bHNlLCAtbWF4SW1wdWxzZSwgbWF4SW1wdWxzZSk7XG4gICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2UgLSBvbGRJbXB1bHNlO1xuICAgICAgICAgIHdBIC09IGlBICogaW1wdWxzZTtcbiAgICAgICAgICB3QiArPSBpQiAqIGltcHVsc2U7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIHZhciBDZG90ID0gVmVjMi5kb3QodGhpcy5tX2F5LCB2QjIpIC0gVmVjMi5kb3QodGhpcy5tX2F5LCB2QTIpICsgdGhpcy5tX3NCeSAqIHdCIC0gdGhpcy5tX3NBeSAqIHdBO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tYXNzICogQ2RvdDtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSArPSBpbXB1bHNlO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihpbXB1bHNlLCB0aGlzLm1fYXkpO1xuICAgICAgICAgIHZhciBMQSA9IGltcHVsc2UgKiB0aGlzLm1fc0F5O1xuICAgICAgICAgIHZhciBMQiA9IGltcHVsc2UgKiB0aGlzLm1fc0J5O1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIExBO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIExCO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIGQyLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICBkMi5zdWJDb21iaW5lKDEsIGNBMiwgMSwgckEyKTtcbiAgICAgICAgdmFyIGF5ID0gUm90Lm11bFZlYzIocUEsIHRoaXMubV9sb2NhbFlBeGlzQSk7XG4gICAgICAgIHZhciBzQXkgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIGF5KTtcbiAgICAgICAgdmFyIHNCeSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIGF5KTtcbiAgICAgICAgdmFyIEMgPSBWZWMyLmRvdChkMiwgYXkpO1xuICAgICAgICB2YXIgayA9IHRoaXMubV9pbnZNYXNzQSArIHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQSAqIHRoaXMubV9zQXkgKiB0aGlzLm1fc0F5ICsgdGhpcy5tX2ludklCICogdGhpcy5tX3NCeSAqIHRoaXMubV9zQnk7XG4gICAgICAgIHZhciBpbXB1bHNlID0gayAhPSAwID8gLUMgLyBrIDogMDtcbiAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIGF5KTtcbiAgICAgICAgdmFyIExBID0gaW1wdWxzZSAqIHNBeTtcbiAgICAgICAgdmFyIExCID0gaW1wdWxzZSAqIHNCeTtcbiAgICAgICAgY0EyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgYUEgLT0gdGhpcy5tX2ludklBICogTEE7XG4gICAgICAgIGNCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQMyk7XG4gICAgICAgIGFCICs9IHRoaXMubV9pbnZJQiAqIExCO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jLnNldFZlYzIoY0EyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jLnNldFZlYzIoY0IyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICByZXR1cm4gbWF0aF9hYnMoQykgPD0gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLlRZUEUgPSBcIndoZWVsLWpvaW50XCI7XG4gICAgICByZXR1cm4gV2hlZWxKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIF9hO1xuICB2YXIgU0lEID0gMDtcbiAgdmFyIFNFUklBTElaRV9SRUZfVFlQRVMgPSB7XG4gICAgXCJXb3JsZFwiOiBXb3JsZCxcbiAgICBcIkJvZHlcIjogQm9keSxcbiAgICBcIkpvaW50XCI6IEpvaW50LFxuICAgIFwiRml4dHVyZVwiOiBGaXh0dXJlLFxuICAgIFwiU2hhcGVcIjogU2hhcGVcbiAgfTtcbiAgdmFyIERFU0VSSUFMSVpFX0JZX1JFRl9UWVBFID0ge1xuICAgIFwiVmVjMlwiOiBWZWMyLFxuICAgIFwiVmVjM1wiOiBWZWMzLFxuICAgIFwiV29ybGRcIjogV29ybGQsXG4gICAgXCJCb2R5XCI6IEJvZHksXG4gICAgXCJKb2ludFwiOiBKb2ludCxcbiAgICBcIkZpeHR1cmVcIjogRml4dHVyZSxcbiAgICBcIlNoYXBlXCI6IFNoYXBlXG4gIH07XG4gIHZhciBERVNFUklBTElaRV9CWV9UWVBFX0ZJRUxEID0gKF9hID0ge30sIF9hW0JvZHkuU1RBVElDXSA9IEJvZHksIF9hW0JvZHkuRFlOQU1JQ10gPSBCb2R5LCBfYVtCb2R5LktJTkVNQVRJQ10gPSBCb2R5LCBfYVtDaGFpblNoYXBlLlRZUEVdID0gQ2hhaW5TaGFwZSwgLy8gW0JveFNoYXBlLlRZUEVdOiBCb3hTaGFwZSxcbiAgX2FbUG9seWdvblNoYXBlLlRZUEVdID0gUG9seWdvblNoYXBlLCBfYVtFZGdlU2hhcGUuVFlQRV0gPSBFZGdlU2hhcGUsIF9hW0NpcmNsZVNoYXBlLlRZUEVdID0gQ2lyY2xlU2hhcGUsIF9hW0Rpc3RhbmNlSm9pbnQuVFlQRV0gPSBEaXN0YW5jZUpvaW50LCBfYVtGcmljdGlvbkpvaW50LlRZUEVdID0gRnJpY3Rpb25Kb2ludCwgX2FbR2VhckpvaW50LlRZUEVdID0gR2VhckpvaW50LCBfYVtNb3RvckpvaW50LlRZUEVdID0gTW90b3JKb2ludCwgX2FbTW91c2VKb2ludC5UWVBFXSA9IE1vdXNlSm9pbnQsIF9hW1ByaXNtYXRpY0pvaW50LlRZUEVdID0gUHJpc21hdGljSm9pbnQsIF9hW1B1bGxleUpvaW50LlRZUEVdID0gUHVsbGV5Sm9pbnQsIF9hW1Jldm9sdXRlSm9pbnQuVFlQRV0gPSBSZXZvbHV0ZUpvaW50LCBfYVtSb3BlSm9pbnQuVFlQRV0gPSBSb3BlSm9pbnQsIF9hW1dlbGRKb2ludC5UWVBFXSA9IFdlbGRKb2ludCwgX2FbV2hlZWxKb2ludC5UWVBFXSA9IFdoZWVsSm9pbnQsIF9hKTtcbiAgdmFyIERFRkFVTFRfT1BUSU9OUyA9IHtcbiAgICByb290Q2xhc3M6IFdvcmxkLFxuICAgIHByZVNlcmlhbGl6ZTogZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqO1xuICAgIH0sXG4gICAgcG9zdFNlcmlhbGl6ZTogZnVuY3Rpb24oZGF0YSwgb2JqKSB7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9LFxuICAgIHByZURlc2VyaWFsaXplOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9LFxuICAgIHBvc3REZXNlcmlhbGl6ZTogZnVuY3Rpb24ob2JqLCBkYXRhKSB7XG4gICAgICByZXR1cm4gb2JqO1xuICAgIH1cbiAgfTtcbiAgdmFyIFNlcmlhbGl6ZXIgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIC8qIEBfX1BVUkVfXyAqLyBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNlcmlhbGl6ZXIyKG9wdGlvbnMyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMudG9Kc29uID0gZnVuY3Rpb24ocm9vdCkge1xuICAgICAgICAgIHZhciBwcmVTZXJpYWxpemUgPSBfdGhpcy5vcHRpb25zLnByZVNlcmlhbGl6ZTtcbiAgICAgICAgICB2YXIgcG9zdFNlcmlhbGl6ZSA9IF90aGlzLm9wdGlvbnMucG9zdFNlcmlhbGl6ZTtcbiAgICAgICAgICB2YXIganNvbiA9IFtdO1xuICAgICAgICAgIHZhciByZWZRdWV1ZSA9IFtyb290XTtcbiAgICAgICAgICB2YXIgcmVmTWVtb0J5SWQgPSB7fTtcbiAgICAgICAgICBmdW5jdGlvbiBhZGRUb1JlZlF1ZXVlKHZhbHVlLCB0eXBlTmFtZSkge1xuICAgICAgICAgICAgdmFsdWUuX19zaWQgPSB2YWx1ZS5fX3NpZCB8fCArK1NJRDtcbiAgICAgICAgICAgIGlmICghcmVmTWVtb0J5SWRbdmFsdWUuX19zaWRdKSB7XG4gICAgICAgICAgICAgIHJlZlF1ZXVlLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgICB2YXIgaW5kZXggPSBqc29uLmxlbmd0aCArIHJlZlF1ZXVlLmxlbmd0aDtcbiAgICAgICAgICAgICAgdmFyIHJlZiA9IHtcbiAgICAgICAgICAgICAgICByZWZJbmRleDogaW5kZXgsXG4gICAgICAgICAgICAgICAgcmVmVHlwZTogdHlwZU5hbWVcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgcmVmTWVtb0J5SWRbdmFsdWUuX19zaWRdID0gcmVmO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlZk1lbW9CeUlkW3ZhbHVlLl9fc2lkXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZnVuY3Rpb24gc2VyaWFsaXplV2l0aEhvb2tzKG9iajIpIHtcbiAgICAgICAgICAgIG9iajIgPSBwcmVTZXJpYWxpemUob2JqMik7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG9iajIuX3NlcmlhbGl6ZSgpO1xuICAgICAgICAgICAgZGF0YSA9IHBvc3RTZXJpYWxpemUoZGF0YSwgb2JqMik7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZnVuY3Rpb24gdHJhdmVyc2UodmFsdWUsIG5vUmVmVHlwZSkge1xuICAgICAgICAgICAgaWYgKG5vUmVmVHlwZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgIG5vUmVmVHlwZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIiB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlLl9zZXJpYWxpemUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICBpZiAoIW5vUmVmVHlwZSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHR5cGVOYW1lIGluIFNFUklBTElaRV9SRUZfVFlQRVMpIHtcbiAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFNFUklBTElaRV9SRUZfVFlQRVNbdHlwZU5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhZGRUb1JlZlF1ZXVlKHZhbHVlLCB0eXBlTmFtZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhbHVlID0gc2VyaWFsaXplV2l0aEhvb2tzKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSBbXTtcbiAgICAgICAgICAgICAgZm9yICh2YXIga2V5ID0gMDsga2V5IDwgdmFsdWUubGVuZ3RoOyBrZXkrKykge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlW2tleV0gPSB0cmF2ZXJzZSh2YWx1ZVtrZXldKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0ge307XG4gICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICBuZXdWYWx1ZVtrZXldID0gdHJhdmVyc2UodmFsdWVba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHdoaWxlIChyZWZRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBvYmogPSByZWZRdWV1ZS5zaGlmdCgpO1xuICAgICAgICAgICAgdmFyIHN0ciA9IHRyYXZlcnNlKG9iaiwgdHJ1ZSk7XG4gICAgICAgICAgICBqc29uLnB1c2goc3RyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGpzb247XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZnJvbUpzb24gPSBmdW5jdGlvbihqc29uKSB7XG4gICAgICAgICAgdmFyIHByZURlc2VyaWFsaXplID0gX3RoaXMub3B0aW9ucy5wcmVEZXNlcmlhbGl6ZTtcbiAgICAgICAgICB2YXIgcG9zdERlc2VyaWFsaXplID0gX3RoaXMub3B0aW9ucy5wb3N0RGVzZXJpYWxpemU7XG4gICAgICAgICAgdmFyIHJvb3RDbGFzcyA9IF90aGlzLm9wdGlvbnMucm9vdENsYXNzO1xuICAgICAgICAgIHZhciBkZXNlcmlhbGl6ZWRSZWZNZW1vQnlJbmRleCA9IHt9O1xuICAgICAgICAgIGZ1bmN0aW9uIGRlc2VyaWFsaXplV2l0aEhvb2tzKGNsYXNzSGludCwgZGF0YSwgY29udGV4dCkge1xuICAgICAgICAgICAgaWYgKCFjbGFzc0hpbnQgfHwgIWNsYXNzSGludC5fZGVzZXJpYWxpemUpIHtcbiAgICAgICAgICAgICAgY2xhc3NIaW50ID0gREVTRVJJQUxJWkVfQllfVFlQRV9GSUVMRFtkYXRhLnR5cGVdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlc2VyaWFsaXplciA9IGNsYXNzSGludCAmJiBjbGFzc0hpbnQuX2Rlc2VyaWFsaXplO1xuICAgICAgICAgICAgaWYgKCFkZXNlcmlhbGl6ZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YSA9IHByZURlc2VyaWFsaXplKGRhdGEpO1xuICAgICAgICAgICAgdmFyIGNsYXNzRGVzZXJpYWxpemVGbiA9IGNsYXNzSGludC5fZGVzZXJpYWxpemU7XG4gICAgICAgICAgICB2YXIgb2JqID0gY2xhc3NEZXNlcmlhbGl6ZUZuKGRhdGEsIGNvbnRleHQsIGRlc2VyaWFsaXplQ2hpbGQpO1xuICAgICAgICAgICAgb2JqID0gcG9zdERlc2VyaWFsaXplKG9iaiwgZGF0YSk7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUNoaWxkKGNsYXNzSGludCwgZGF0YU9yUmVmLCBjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgaXNSZWZPYmplY3QgPSBkYXRhT3JSZWYucmVmSW5kZXggJiYgZGF0YU9yUmVmLnJlZlR5cGU7XG4gICAgICAgICAgICBpZiAoIWlzUmVmT2JqZWN0KSB7XG4gICAgICAgICAgICAgIHJldHVybiBkZXNlcmlhbGl6ZVdpdGhIb29rcyhjbGFzc0hpbnQsIGRhdGFPclJlZiwgY29udGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVmID0gZGF0YU9yUmVmO1xuICAgICAgICAgICAgaWYgKERFU0VSSUFMSVpFX0JZX1JFRl9UWVBFW3JlZi5yZWZUeXBlXSkge1xuICAgICAgICAgICAgICBjbGFzc0hpbnQgPSBERVNFUklBTElaRV9CWV9SRUZfVFlQRVtyZWYucmVmVHlwZV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVmSW5kZXggPSByZWYucmVmSW5kZXg7XG4gICAgICAgICAgICBpZiAoIWRlc2VyaWFsaXplZFJlZk1lbW9CeUluZGV4W3JlZkluZGV4XSkge1xuICAgICAgICAgICAgICB2YXIgZGF0YSA9IGpzb25bcmVmSW5kZXhdO1xuICAgICAgICAgICAgICB2YXIgb2JqID0gZGVzZXJpYWxpemVXaXRoSG9va3MoY2xhc3NIaW50LCBkYXRhLCBjb250ZXh0KTtcbiAgICAgICAgICAgICAgZGVzZXJpYWxpemVkUmVmTWVtb0J5SW5kZXhbcmVmSW5kZXhdID0gb2JqO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGRlc2VyaWFsaXplZFJlZk1lbW9CeUluZGV4W3JlZkluZGV4XTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHJvb3QgPSBkZXNlcmlhbGl6ZVdpdGhIb29rcyhyb290Q2xhc3MsIGpzb25bMF0sIG51bGwpO1xuICAgICAgICAgIHJldHVybiByb290O1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgREVGQVVMVF9PUFRJT05TKSwgb3B0aW9uczIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFNlcmlhbGl6ZXIyO1xuICAgIH0oKVxuICApO1xuICB2YXIgd29ybGRTZXJpYWxpemVyID0gbmV3IFNlcmlhbGl6ZXIoe1xuICAgIHJvb3RDbGFzczogV29ybGRcbiAgfSk7XG4gIFNlcmlhbGl6ZXIuZnJvbUpzb24gPSB3b3JsZFNlcmlhbGl6ZXIuZnJvbUpzb247XG4gIFNlcmlhbGl6ZXIudG9Kc29uID0gd29ybGRTZXJpYWxpemVyLnRvSnNvbjtcbiAgdmFyIFRlc3RiZWQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVGVzdGJlZDIoKSB7XG4gICAgICB9XG4gICAgICBUZXN0YmVkMi5tb3VudCA9IGZ1bmN0aW9uKG9wdGlvbnMyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRlZFwiKTtcbiAgICAgIH07XG4gICAgICBUZXN0YmVkMi5zdGFydCA9IGZ1bmN0aW9uKHdvcmxkKSB7XG4gICAgICAgIHZhciB0ZXN0YmVkMiA9IFRlc3RiZWQyLm1vdW50KCk7XG4gICAgICAgIHRlc3RiZWQyLnN0YXJ0KHdvcmxkKTtcbiAgICAgICAgcmV0dXJuIHRlc3RiZWQyO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBUZXN0YmVkMjtcbiAgICB9KClcbiAgKTtcbiAgZnVuY3Rpb24gdGVzdGJlZChhMiwgYjIpIHtcbiAgICB2YXIgY2FsbGJhY2s7XG4gICAgdmFyIG9wdGlvbnMyO1xuICAgIGlmICh0eXBlb2YgYTIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY2FsbGJhY2sgPSBhMjtcbiAgICAgIG9wdGlvbnMyID0gYjI7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYjIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY2FsbGJhY2sgPSBiMjtcbiAgICAgIG9wdGlvbnMyID0gYTI7XG4gICAgfSBlbHNlIHtcbiAgICAgIG9wdGlvbnMyID0gYTIgIT09IG51bGwgJiYgYTIgIT09IHZvaWQgMCA/IGEyIDogYjI7XG4gICAgfVxuICAgIHZhciB0ZXN0YmVkMiA9IFRlc3RiZWQubW91bnQob3B0aW9uczIpO1xuICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgdmFyIHdvcmxkID0gY2FsbGJhY2sodGVzdGJlZDIpIHx8IHRlc3RiZWQyLndvcmxkO1xuICAgICAgdGVzdGJlZDIuc3RhcnQod29ybGQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGVzdGJlZDI7XG4gICAgfVxuICB9XG4gIHZhciBCb3hTaGFwZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoQm94U2hhcGUyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gQm94U2hhcGUyKGhhbGZXaWR0aCwgaGFsZkhlaWdodCwgY2VudGVyMiwgYW5nbGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBCb3hTaGFwZTIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBCb3hTaGFwZTIoaGFsZldpZHRoLCBoYWxmSGVpZ2h0LCBjZW50ZXIyLCBhbmdsZSk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fc2V0QXNCb3goaGFsZldpZHRoLCBoYWxmSGVpZ2h0LCBjZW50ZXIyLCBhbmdsZSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIEJveFNoYXBlMi5UWVBFID0gXCJwb2x5Z29uXCI7XG4gICAgICByZXR1cm4gQm94U2hhcGUyO1xuICAgIH0oUG9seWdvblNoYXBlKVxuICApO1xuICBDb250YWN0LmFkZFR5cGUoQ2lyY2xlU2hhcGUuVFlQRSwgQ2lyY2xlU2hhcGUuVFlQRSwgQ2lyY2xlQ2lyY2xlQ29udGFjdCk7XG4gIGZ1bmN0aW9uIENpcmNsZUNpcmNsZUNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZpeHR1cmVBLCBpbmRleEEsIHhmQjIsIGZpeHR1cmVCLCBpbmRleEIpIHtcbiAgICBDb2xsaWRlQ2lyY2xlcyhtYW5pZm9sZCwgZml4dHVyZUEuZ2V0U2hhcGUoKSwgeGZBMiwgZml4dHVyZUIuZ2V0U2hhcGUoKSwgeGZCMik7XG4gIH1cbiAgdmFyIHBBID0gdmVjMigwLCAwKTtcbiAgdmFyIHBCID0gdmVjMigwLCAwKTtcbiAgdmFyIENvbGxpZGVDaXJjbGVzID0gZnVuY3Rpb24obWFuaWZvbGQsIGNpcmNsZUEsIHhmQTIsIGNpcmNsZUIsIHhmQjIpIHtcbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMDtcbiAgICB0cmFuc2Zvcm1WZWMyKHBBLCB4ZkEyLCBjaXJjbGVBLm1fcCk7XG4gICAgdHJhbnNmb3JtVmVjMihwQiwgeGZCMiwgY2lyY2xlQi5tX3ApO1xuICAgIHZhciBkaXN0U3FyID0gZGlzdFNxclZlYzIocEIsIHBBKTtcbiAgICB2YXIgckEyID0gY2lyY2xlQS5tX3JhZGl1cztcbiAgICB2YXIgckIyID0gY2lyY2xlQi5tX3JhZGl1cztcbiAgICB2YXIgcmFkaXVzID0gckEyICsgckIyO1xuICAgIGlmIChkaXN0U3FyID4gcmFkaXVzICogcmFkaXVzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9jaXJjbGVzO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIGNpcmNsZUEubV9wKTtcbiAgICB6ZXJvVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCk7XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDE7XG4gICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICBtYW5pZm9sZC5wb2ludHNbMF0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCAwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICB9O1xuICBDb250YWN0LmFkZFR5cGUoRWRnZVNoYXBlLlRZUEUsIENpcmNsZVNoYXBlLlRZUEUsIEVkZ2VDaXJjbGVDb250YWN0KTtcbiAgQ29udGFjdC5hZGRUeXBlKENoYWluU2hhcGUuVFlQRSwgQ2lyY2xlU2hhcGUuVFlQRSwgQ2hhaW5DaXJjbGVDb250YWN0KTtcbiAgZnVuY3Rpb24gRWRnZUNpcmNsZUNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZpeHR1cmVBLCBpbmRleEEsIHhmQjIsIGZpeHR1cmVCLCBpbmRleEIpIHtcbiAgICB2YXIgc2hhcGVBID0gZml4dHVyZUEuZ2V0U2hhcGUoKTtcbiAgICB2YXIgc2hhcGVCID0gZml4dHVyZUIuZ2V0U2hhcGUoKTtcbiAgICBDb2xsaWRlRWRnZUNpcmNsZShtYW5pZm9sZCwgc2hhcGVBLCB4ZkEyLCBzaGFwZUIsIHhmQjIpO1xuICB9XG4gIGZ1bmN0aW9uIENoYWluQ2lyY2xlQ29udGFjdChtYW5pZm9sZCwgeGZBMiwgZml4dHVyZUEsIGluZGV4QSwgeGZCMiwgZml4dHVyZUIsIGluZGV4Qikge1xuICAgIHZhciBjaGFpbiA9IGZpeHR1cmVBLmdldFNoYXBlKCk7XG4gICAgdmFyIGVkZ2UgPSBuZXcgRWRnZVNoYXBlKCk7XG4gICAgY2hhaW4uZ2V0Q2hpbGRFZGdlKGVkZ2UsIGluZGV4QSk7XG4gICAgdmFyIHNoYXBlQSA9IGVkZ2U7XG4gICAgdmFyIHNoYXBlQiA9IGZpeHR1cmVCLmdldFNoYXBlKCk7XG4gICAgQ29sbGlkZUVkZ2VDaXJjbGUobWFuaWZvbGQsIHNoYXBlQSwgeGZBMiwgc2hhcGVCLCB4ZkIyKTtcbiAgfVxuICB2YXIgZSA9IHZlYzIoMCwgMCk7XG4gIHZhciBlMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBlMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBRID0gdmVjMigwLCAwKTtcbiAgdmFyIFAgPSB2ZWMyKDAsIDApO1xuICB2YXIgbiQyID0gdmVjMigwLCAwKTtcbiAgdmFyIENvbGxpZGVFZGdlQ2lyY2xlID0gZnVuY3Rpb24obWFuaWZvbGQsIGVkZ2VBLCB4ZkEyLCBjaXJjbGVCLCB4ZkIyKSB7XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDA7XG4gICAgcmV0cmFuc2Zvcm1WZWMyKFEsIHhmQjIsIHhmQTIsIGNpcmNsZUIubV9wKTtcbiAgICB2YXIgQSA9IGVkZ2VBLm1fdmVydGV4MTtcbiAgICB2YXIgQiA9IGVkZ2VBLm1fdmVydGV4MjtcbiAgICBzdWJWZWMyKGUsIEIsIEEpO1xuICAgIHZhciB1ID0gZG90VmVjMihlLCBCKSAtIGRvdFZlYzIoZSwgUSk7XG4gICAgdmFyIHYzID0gZG90VmVjMihlLCBRKSAtIGRvdFZlYzIoZSwgQSk7XG4gICAgdmFyIHJhZGl1cyA9IGVkZ2VBLm1fcmFkaXVzICsgY2lyY2xlQi5tX3JhZGl1cztcbiAgICBpZiAodjMgPD0gMCkge1xuICAgICAgY29weVZlYzIoUCwgQSk7XG4gICAgICB2YXIgZGRfMSA9IGRpc3RTcXJWZWMyKFEsIEEpO1xuICAgICAgaWYgKGRkXzEgPiByYWRpdXMgKiByYWRpdXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGVkZ2VBLm1faGFzVmVydGV4MCkge1xuICAgICAgICB2YXIgQTEgPSBlZGdlQS5tX3ZlcnRleDA7XG4gICAgICAgIHZhciBCMSA9IEE7XG4gICAgICAgIHN1YlZlYzIoZTEsIEIxLCBBMSk7XG4gICAgICAgIHZhciB1MSA9IGRvdFZlYzIoZTEsIEIxKSAtIGRvdFZlYzIoZTEsIFEpO1xuICAgICAgICBpZiAodTEgPiAwKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfY2lyY2xlcztcbiAgICAgIHplcm9WZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIFApO1xuICAgICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDE7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5wb2ludHNbMF0ubG9jYWxQb2ludCwgY2lyY2xlQi5tX3ApO1xuICAgICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHUgPD0gMCkge1xuICAgICAgY29weVZlYzIoUCwgQik7XG4gICAgICB2YXIgZGRfMiA9IGRpc3RTcXJWZWMyKFEsIFApO1xuICAgICAgaWYgKGRkXzIgPiByYWRpdXMgKiByYWRpdXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGVkZ2VBLm1faGFzVmVydGV4Mykge1xuICAgICAgICB2YXIgQjIgPSBlZGdlQS5tX3ZlcnRleDM7XG4gICAgICAgIHZhciBBMiA9IEI7XG4gICAgICAgIHN1YlZlYzIoZTIsIEIyLCBBMik7XG4gICAgICAgIHZhciB2MjIgPSBkb3RWZWMyKGUyLCBRKSAtIGRvdFZlYzIoZTIsIEEyKTtcbiAgICAgICAgaWYgKHYyMiA+IDApIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9jaXJjbGVzO1xuICAgICAgemVyb1ZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgUCk7XG4gICAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLnBvaW50c1swXS5sb2NhbFBvaW50LCBjaXJjbGVCLm1fcCk7XG4gICAgICBtYW5pZm9sZC5wb2ludHNbMF0uaWQuc2V0RmVhdHVyZXMoMSwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCAwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgZGVuID0gbGVuZ3RoU3FyVmVjMihlKTtcbiAgICBjb21iaW5lMlZlYzIoUCwgdSAvIGRlbiwgQSwgdjMgLyBkZW4sIEIpO1xuICAgIHZhciBkZCA9IGRpc3RTcXJWZWMyKFEsIFApO1xuICAgIGlmIChkZCA+IHJhZGl1cyAqIHJhZGl1cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjcm9zc051bVZlYzIobiQyLCAxLCBlKTtcbiAgICBpZiAoZG90VmVjMihuJDIsIFEpIC0gZG90VmVjMihuJDIsIEEpIDwgMCkge1xuICAgICAgbmVnVmVjMihuJDIpO1xuICAgIH1cbiAgICBub3JtYWxpemVWZWMyKG4kMik7XG4gICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsLCBuJDIpO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIEEpO1xuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLnBvaW50c1swXS5sb2NhbFBvaW50LCBjaXJjbGVCLm1fcCk7XG4gICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gIH07XG4gIHZhciBpbmNpZGVudEVkZ2UgPSBbbmV3IENsaXBWZXJ0ZXgoKSwgbmV3IENsaXBWZXJ0ZXgoKV07XG4gIHZhciBjbGlwUG9pbnRzMSQxID0gW25ldyBDbGlwVmVydGV4KCksIG5ldyBDbGlwVmVydGV4KCldO1xuICB2YXIgY2xpcFBvaW50czIkMSA9IFtuZXcgQ2xpcFZlcnRleCgpLCBuZXcgQ2xpcFZlcnRleCgpXTtcbiAgdmFyIGNsaXBTZWdtZW50VG9MaW5lTm9ybWFsID0gdmVjMigwLCAwKTtcbiAgdmFyIHYxID0gdmVjMigwLCAwKTtcbiAgdmFyIG4kMSA9IHZlYzIoMCwgMCk7XG4gIHZhciB4ZiQxID0gdHJhbnNmb3JtKDAsIDAsIDApO1xuICB2YXIgdjExID0gdmVjMigwLCAwKTtcbiAgdmFyIHYxMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBsb2NhbFRhbmdlbnQgPSB2ZWMyKDAsIDApO1xuICB2YXIgbG9jYWxOb3JtYWwgPSB2ZWMyKDAsIDApO1xuICB2YXIgcGxhbmVQb2ludCA9IHZlYzIoMCwgMCk7XG4gIHZhciB0YW5nZW50ID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbCQxID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbDEkMSA9IHZlYzIoMCwgMCk7XG4gIENvbnRhY3QuYWRkVHlwZShQb2x5Z29uU2hhcGUuVFlQRSwgUG9seWdvblNoYXBlLlRZUEUsIFBvbHlnb25Db250YWN0KTtcbiAgZnVuY3Rpb24gUG9seWdvbkNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZpeHR1cmVBLCBpbmRleEEsIHhmQjIsIGZpeHR1cmVCLCBpbmRleEIpIHtcbiAgICBDb2xsaWRlUG9seWdvbnMobWFuaWZvbGQsIGZpeHR1cmVBLmdldFNoYXBlKCksIHhmQTIsIGZpeHR1cmVCLmdldFNoYXBlKCksIHhmQjIpO1xuICB9XG4gIGZ1bmN0aW9uIGZpbmRNYXhTZXBhcmF0aW9uKHBvbHkxLCB4ZjEsIHBvbHkyLCB4ZjIsIG91dHB1dDIpIHtcbiAgICB2YXIgY291bnQxID0gcG9seTEubV9jb3VudDtcbiAgICB2YXIgY291bnQyID0gcG9seTIubV9jb3VudDtcbiAgICB2YXIgbjFzID0gcG9seTEubV9ub3JtYWxzO1xuICAgIHZhciB2MXMgPSBwb2x5MS5tX3ZlcnRpY2VzO1xuICAgIHZhciB2MnMgPSBwb2x5Mi5tX3ZlcnRpY2VzO1xuICAgIGRldHJhbnNmb3JtVHJhbnNmb3JtKHhmJDEsIHhmMiwgeGYxKTtcbiAgICB2YXIgYmVzdEluZGV4ID0gMDtcbiAgICB2YXIgbWF4U2VwYXJhdGlvbjIgPSAtSW5maW5pdHk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDE7ICsraSkge1xuICAgICAgcm90VmVjMihuJDEsIHhmJDEucSwgbjFzW2ldKTtcbiAgICAgIHRyYW5zZm9ybVZlYzIodjEsIHhmJDEsIHYxc1tpXSk7XG4gICAgICB2YXIgc2kgPSBJbmZpbml0eTtcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY291bnQyOyArK2opIHtcbiAgICAgICAgdmFyIHNpaiA9IGRvdFZlYzIobiQxLCB2MnNbal0pIC0gZG90VmVjMihuJDEsIHYxKTtcbiAgICAgICAgaWYgKHNpaiA8IHNpKSB7XG4gICAgICAgICAgc2kgPSBzaWo7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChzaSA+IG1heFNlcGFyYXRpb24yKSB7XG4gICAgICAgIG1heFNlcGFyYXRpb24yID0gc2k7XG4gICAgICAgIGJlc3RJbmRleCA9IGk7XG4gICAgICB9XG4gICAgfVxuICAgIG91dHB1dDIubWF4U2VwYXJhdGlvbiA9IG1heFNlcGFyYXRpb24yO1xuICAgIG91dHB1dDIuYmVzdEluZGV4ID0gYmVzdEluZGV4O1xuICB9XG4gIGZ1bmN0aW9uIGZpbmRJbmNpZGVudEVkZ2UoY2xpcFZlcnRleCwgcG9seTEsIHhmMSwgZWRnZTEyLCBwb2x5MiwgeGYyKSB7XG4gICAgdmFyIG5vcm1hbHMxID0gcG9seTEubV9ub3JtYWxzO1xuICAgIHZhciBjb3VudDIgPSBwb2x5Mi5tX2NvdW50O1xuICAgIHZhciB2ZXJ0aWNlczIgPSBwb2x5Mi5tX3ZlcnRpY2VzO1xuICAgIHZhciBub3JtYWxzMiA9IHBvbHkyLm1fbm9ybWFscztcbiAgICByZXJvdFZlYzIobm9ybWFsMSQxLCB4ZjIucSwgeGYxLnEsIG5vcm1hbHMxW2VkZ2UxMl0pO1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgdmFyIG1pbkRvdCA9IEluZmluaXR5O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQyOyArK2kpIHtcbiAgICAgIHZhciBkb3QgPSBkb3RWZWMyKG5vcm1hbDEkMSwgbm9ybWFsczJbaV0pO1xuICAgICAgaWYgKGRvdCA8IG1pbkRvdCkge1xuICAgICAgICBtaW5Eb3QgPSBkb3Q7XG4gICAgICAgIGluZGV4ID0gaTtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIGkxID0gaW5kZXg7XG4gICAgdmFyIGkyID0gaTEgKyAxIDwgY291bnQyID8gaTEgKyAxIDogMDtcbiAgICB0cmFuc2Zvcm1WZWMyKGNsaXBWZXJ0ZXhbMF0udiwgeGYyLCB2ZXJ0aWNlczJbaTFdKTtcbiAgICBjbGlwVmVydGV4WzBdLmlkLnNldEZlYXR1cmVzKGVkZ2UxMiwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfZmFjZSwgaTEsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgdHJhbnNmb3JtVmVjMihjbGlwVmVydGV4WzFdLnYsIHhmMiwgdmVydGljZXMyW2kyXSk7XG4gICAgY2xpcFZlcnRleFsxXS5pZC5zZXRGZWF0dXJlcyhlZGdlMTIsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UsIGkyLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICB9XG4gIHZhciBtYXhTZXBhcmF0aW9uID0ge1xuICAgIG1heFNlcGFyYXRpb246IDAsXG4gICAgYmVzdEluZGV4OiAwXG4gIH07XG4gIHZhciBDb2xsaWRlUG9seWdvbnMgPSBmdW5jdGlvbihtYW5pZm9sZCwgcG9seUEsIHhmQTIsIHBvbHlCLCB4ZkIyKSB7XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDA7XG4gICAgdmFyIHRvdGFsUmFkaXVzID0gcG9seUEubV9yYWRpdXMgKyBwb2x5Qi5tX3JhZGl1cztcbiAgICBmaW5kTWF4U2VwYXJhdGlvbihwb2x5QSwgeGZBMiwgcG9seUIsIHhmQjIsIG1heFNlcGFyYXRpb24pO1xuICAgIHZhciBlZGdlQSA9IG1heFNlcGFyYXRpb24uYmVzdEluZGV4O1xuICAgIHZhciBzZXBhcmF0aW9uQSA9IG1heFNlcGFyYXRpb24ubWF4U2VwYXJhdGlvbjtcbiAgICBpZiAoc2VwYXJhdGlvbkEgPiB0b3RhbFJhZGl1cylcbiAgICAgIHJldHVybjtcbiAgICBmaW5kTWF4U2VwYXJhdGlvbihwb2x5QiwgeGZCMiwgcG9seUEsIHhmQTIsIG1heFNlcGFyYXRpb24pO1xuICAgIHZhciBlZGdlQiA9IG1heFNlcGFyYXRpb24uYmVzdEluZGV4O1xuICAgIHZhciBzZXBhcmF0aW9uQiA9IG1heFNlcGFyYXRpb24ubWF4U2VwYXJhdGlvbjtcbiAgICBpZiAoc2VwYXJhdGlvbkIgPiB0b3RhbFJhZGl1cylcbiAgICAgIHJldHVybjtcbiAgICB2YXIgcG9seTE7XG4gICAgdmFyIHBvbHkyO1xuICAgIHZhciB4ZjE7XG4gICAgdmFyIHhmMjtcbiAgICB2YXIgZWRnZTEyO1xuICAgIHZhciBmbGlwO1xuICAgIHZhciBrX3RvbCA9IDAuMSAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICBpZiAoc2VwYXJhdGlvbkIgPiBzZXBhcmF0aW9uQSArIGtfdG9sKSB7XG4gICAgICBwb2x5MSA9IHBvbHlCO1xuICAgICAgcG9seTIgPSBwb2x5QTtcbiAgICAgIHhmMSA9IHhmQjI7XG4gICAgICB4ZjIgPSB4ZkEyO1xuICAgICAgZWRnZTEyID0gZWRnZUI7XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUI7XG4gICAgICBmbGlwID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcG9seTEgPSBwb2x5QTtcbiAgICAgIHBvbHkyID0gcG9seUI7XG4gICAgICB4ZjEgPSB4ZkEyO1xuICAgICAgeGYyID0geGZCMjtcbiAgICAgIGVkZ2UxMiA9IGVkZ2VBO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgZmxpcCA9IGZhbHNlO1xuICAgIH1cbiAgICBpbmNpZGVudEVkZ2VbMF0ucmVjeWNsZSgpO1xuICAgIGluY2lkZW50RWRnZVsxXS5yZWN5Y2xlKCk7XG4gICAgZmluZEluY2lkZW50RWRnZShpbmNpZGVudEVkZ2UsIHBvbHkxLCB4ZjEsIGVkZ2UxMiwgcG9seTIsIHhmMik7XG4gICAgdmFyIGNvdW50MSA9IHBvbHkxLm1fY291bnQ7XG4gICAgdmFyIHZlcnRpY2VzMSA9IHBvbHkxLm1fdmVydGljZXM7XG4gICAgdmFyIGl2MSA9IGVkZ2UxMjtcbiAgICB2YXIgaXYyID0gZWRnZTEyICsgMSA8IGNvdW50MSA/IGVkZ2UxMiArIDEgOiAwO1xuICAgIGNvcHlWZWMyKHYxMSwgdmVydGljZXMxW2l2MV0pO1xuICAgIGNvcHlWZWMyKHYxMiwgdmVydGljZXMxW2l2Ml0pO1xuICAgIHN1YlZlYzIobG9jYWxUYW5nZW50LCB2MTIsIHYxMSk7XG4gICAgbm9ybWFsaXplVmVjMihsb2NhbFRhbmdlbnQpO1xuICAgIGNyb3NzVmVjMk51bShsb2NhbE5vcm1hbCwgbG9jYWxUYW5nZW50LCAxKTtcbiAgICBjb21iaW5lMlZlYzIocGxhbmVQb2ludCwgMC41LCB2MTEsIDAuNSwgdjEyKTtcbiAgICByb3RWZWMyKHRhbmdlbnQsIHhmMS5xLCBsb2NhbFRhbmdlbnQpO1xuICAgIGNyb3NzVmVjMk51bShub3JtYWwkMSwgdGFuZ2VudCwgMSk7XG4gICAgdHJhbnNmb3JtVmVjMih2MTEsIHhmMSwgdjExKTtcbiAgICB0cmFuc2Zvcm1WZWMyKHYxMiwgeGYxLCB2MTIpO1xuICAgIHZhciBmcm9udE9mZnNldCA9IGRvdFZlYzIobm9ybWFsJDEsIHYxMSk7XG4gICAgdmFyIHNpZGVPZmZzZXQxID0gLWRvdFZlYzIodGFuZ2VudCwgdjExKSArIHRvdGFsUmFkaXVzO1xuICAgIHZhciBzaWRlT2Zmc2V0MiA9IGRvdFZlYzIodGFuZ2VudCwgdjEyKSArIHRvdGFsUmFkaXVzO1xuICAgIGNsaXBQb2ludHMxJDFbMF0ucmVjeWNsZSgpO1xuICAgIGNsaXBQb2ludHMxJDFbMV0ucmVjeWNsZSgpO1xuICAgIGNsaXBQb2ludHMyJDFbMF0ucmVjeWNsZSgpO1xuICAgIGNsaXBQb2ludHMyJDFbMV0ucmVjeWNsZSgpO1xuICAgIHNldFZlYzIoY2xpcFNlZ21lbnRUb0xpbmVOb3JtYWwsIC10YW5nZW50LngsIC10YW5nZW50LnkpO1xuICAgIHZhciBucDEgPSBjbGlwU2VnbWVudFRvTGluZShjbGlwUG9pbnRzMSQxLCBpbmNpZGVudEVkZ2UsIGNsaXBTZWdtZW50VG9MaW5lTm9ybWFsLCBzaWRlT2Zmc2V0MSwgaXYxKTtcbiAgICBpZiAobnAxIDwgMikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzZXRWZWMyKGNsaXBTZWdtZW50VG9MaW5lTm9ybWFsLCB0YW5nZW50LngsIHRhbmdlbnQueSk7XG4gICAgdmFyIG5wMiA9IGNsaXBTZWdtZW50VG9MaW5lKGNsaXBQb2ludHMyJDEsIGNsaXBQb2ludHMxJDEsIGNsaXBTZWdtZW50VG9MaW5lTm9ybWFsLCBzaWRlT2Zmc2V0MiwgaXYyKTtcbiAgICBpZiAobnAyIDwgMikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgbG9jYWxOb3JtYWwpO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIHBsYW5lUG9pbnQpO1xuICAgIHZhciBwb2ludENvdW50ID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNsaXBQb2ludHMyJDEubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciBzZXBhcmF0aW9uID0gZG90VmVjMihub3JtYWwkMSwgY2xpcFBvaW50czIkMVtpXS52KSAtIGZyb250T2Zmc2V0O1xuICAgICAgaWYgKHNlcGFyYXRpb24gPD0gdG90YWxSYWRpdXMpIHtcbiAgICAgICAgdmFyIGNwID0gbWFuaWZvbGQucG9pbnRzW3BvaW50Q291bnRdO1xuICAgICAgICBkZXRyYW5zZm9ybVZlYzIoY3AubG9jYWxQb2ludCwgeGYyLCBjbGlwUG9pbnRzMiQxW2ldLnYpO1xuICAgICAgICBjcC5pZC5zZXQoY2xpcFBvaW50czIkMVtpXS5pZCk7XG4gICAgICAgIGlmIChmbGlwKSB7XG4gICAgICAgICAgY3AuaWQuc3dhcEZlYXR1cmVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgKytwb2ludENvdW50O1xuICAgICAgfVxuICAgIH1cbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gcG9pbnRDb3VudDtcbiAgfTtcbiAgQ29udGFjdC5hZGRUeXBlKFBvbHlnb25TaGFwZS5UWVBFLCBDaXJjbGVTaGFwZS5UWVBFLCBQb2x5Z29uQ2lyY2xlQ29udGFjdCk7XG4gIGZ1bmN0aW9uIFBvbHlnb25DaXJjbGVDb250YWN0KG1hbmlmb2xkLCB4ZkEyLCBmaXh0dXJlQSwgaW5kZXhBLCB4ZkIyLCBmaXh0dXJlQiwgaW5kZXhCKSB7XG4gICAgQ29sbGlkZVBvbHlnb25DaXJjbGUobWFuaWZvbGQsIGZpeHR1cmVBLmdldFNoYXBlKCksIHhmQTIsIGZpeHR1cmVCLmdldFNoYXBlKCksIHhmQjIpO1xuICB9XG4gIHZhciBjTG9jYWwgPSB2ZWMyKDAsIDApO1xuICB2YXIgZmFjZUNlbnRlciA9IHZlYzIoMCwgMCk7XG4gIHZhciBDb2xsaWRlUG9seWdvbkNpcmNsZSA9IGZ1bmN0aW9uKG1hbmlmb2xkLCBwb2x5Z29uQSwgeGZBMiwgY2lyY2xlQiwgeGZCMikge1xuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAwO1xuICAgIHJldHJhbnNmb3JtVmVjMihjTG9jYWwsIHhmQjIsIHhmQTIsIGNpcmNsZUIubV9wKTtcbiAgICB2YXIgbm9ybWFsSW5kZXggPSAwO1xuICAgIHZhciBzZXBhcmF0aW9uID0gLUluZmluaXR5O1xuICAgIHZhciByYWRpdXMgPSBwb2x5Z29uQS5tX3JhZGl1cyArIGNpcmNsZUIubV9yYWRpdXM7XG4gICAgdmFyIHZlcnRleENvdW50ID0gcG9seWdvbkEubV9jb3VudDtcbiAgICB2YXIgdmVydGljZXMgPSBwb2x5Z29uQS5tX3ZlcnRpY2VzO1xuICAgIHZhciBub3JtYWxzID0gcG9seWdvbkEubV9ub3JtYWxzO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGV4Q291bnQ7ICsraSkge1xuICAgICAgdmFyIHMyID0gZG90VmVjMihub3JtYWxzW2ldLCBjTG9jYWwpIC0gZG90VmVjMihub3JtYWxzW2ldLCB2ZXJ0aWNlc1tpXSk7XG4gICAgICBpZiAoczIgPiByYWRpdXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHMyID4gc2VwYXJhdGlvbikge1xuICAgICAgICBzZXBhcmF0aW9uID0gczI7XG4gICAgICAgIG5vcm1hbEluZGV4ID0gaTtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIHZlcnRJbmRleDEgPSBub3JtYWxJbmRleDtcbiAgICB2YXIgdmVydEluZGV4MiA9IHZlcnRJbmRleDEgKyAxIDwgdmVydGV4Q291bnQgPyB2ZXJ0SW5kZXgxICsgMSA6IDA7XG4gICAgdmFyIHYxMyA9IHZlcnRpY2VzW3ZlcnRJbmRleDFdO1xuICAgIHZhciB2MjIgPSB2ZXJ0aWNlc1t2ZXJ0SW5kZXgyXTtcbiAgICBpZiAoc2VwYXJhdGlvbiA8IEVQU0lMT04pIHtcbiAgICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIG5vcm1hbHNbbm9ybWFsSW5kZXhdKTtcbiAgICAgIGNvbWJpbmUyVmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCAwLjUsIHYxMywgMC41LCB2MjIpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB1MSA9IGRvdFZlYzIoY0xvY2FsLCB2MjIpIC0gZG90VmVjMihjTG9jYWwsIHYxMykgLSBkb3RWZWMyKHYxMywgdjIyKSArIGRvdFZlYzIodjEzLCB2MTMpO1xuICAgIHZhciB1MiA9IGRvdFZlYzIoY0xvY2FsLCB2MTMpIC0gZG90VmVjMihjTG9jYWwsIHYyMikgLSBkb3RWZWMyKHYyMiwgdjEzKSArIGRvdFZlYzIodjIyLCB2MjIpO1xuICAgIGlmICh1MSA8PSAwKSB7XG4gICAgICBpZiAoZGlzdFNxclZlYzIoY0xvY2FsLCB2MTMpID4gcmFkaXVzICogcmFkaXVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgc3ViVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgY0xvY2FsLCB2MTMpO1xuICAgICAgbm9ybWFsaXplVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCk7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCB2MTMpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgfSBlbHNlIGlmICh1MiA8PSAwKSB7XG4gICAgICBpZiAoZGlzdFNxclZlYzIoY0xvY2FsLCB2MjIpID4gcmFkaXVzICogcmFkaXVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgc3ViVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgY0xvY2FsLCB2MjIpO1xuICAgICAgbm9ybWFsaXplVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCk7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCB2MjIpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbWJpbmUyVmVjMihmYWNlQ2VudGVyLCAwLjUsIHYxMywgMC41LCB2MjIpO1xuICAgICAgdmFyIHNlcGFyYXRpb25fMSA9IGRvdFZlYzIoY0xvY2FsLCBub3JtYWxzW3ZlcnRJbmRleDFdKSAtIGRvdFZlYzIoZmFjZUNlbnRlciwgbm9ybWFsc1t2ZXJ0SW5kZXgxXSk7XG4gICAgICBpZiAoc2VwYXJhdGlvbl8xID4gcmFkaXVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIG5vcm1hbHNbdmVydEluZGV4MV0pO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgZmFjZUNlbnRlcik7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5wb2ludHNbMF0ubG9jYWxQb2ludCwgY2lyY2xlQi5tX3ApO1xuICAgICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICB9XG4gIH07XG4gIHZhciBtYXRoX21pbiA9IE1hdGgubWluO1xuICBDb250YWN0LmFkZFR5cGUoRWRnZVNoYXBlLlRZUEUsIFBvbHlnb25TaGFwZS5UWVBFLCBFZGdlUG9seWdvbkNvbnRhY3QpO1xuICBDb250YWN0LmFkZFR5cGUoQ2hhaW5TaGFwZS5UWVBFLCBQb2x5Z29uU2hhcGUuVFlQRSwgQ2hhaW5Qb2x5Z29uQ29udGFjdCk7XG4gIGZ1bmN0aW9uIEVkZ2VQb2x5Z29uQ29udGFjdChtYW5pZm9sZCwgeGZBMiwgZkEsIGluZGV4QSwgeGZCMiwgZkIsIGluZGV4Qikge1xuICAgIENvbGxpZGVFZGdlUG9seWdvbihtYW5pZm9sZCwgZkEuZ2V0U2hhcGUoKSwgeGZBMiwgZkIuZ2V0U2hhcGUoKSwgeGZCMik7XG4gIH1cbiAgdmFyIGVkZ2VfcmV1c2UgPSBuZXcgRWRnZVNoYXBlKCk7XG4gIGZ1bmN0aW9uIENoYWluUG9seWdvbkNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZBLCBpbmRleEEsIHhmQjIsIGZCLCBpbmRleEIpIHtcbiAgICB2YXIgY2hhaW4gPSBmQS5nZXRTaGFwZSgpO1xuICAgIGNoYWluLmdldENoaWxkRWRnZShlZGdlX3JldXNlLCBpbmRleEEpO1xuICAgIENvbGxpZGVFZGdlUG9seWdvbihtYW5pZm9sZCwgZWRnZV9yZXVzZSwgeGZBMiwgZkIuZ2V0U2hhcGUoKSwgeGZCMik7XG4gIH1cbiAgdmFyIEVQQXhpc1R5cGU7XG4gIChmdW5jdGlvbihFUEF4aXNUeXBlMikge1xuICAgIEVQQXhpc1R5cGUyW0VQQXhpc1R5cGUyW1wiZV91bmtub3duXCJdID0gLTFdID0gXCJlX3Vua25vd25cIjtcbiAgICBFUEF4aXNUeXBlMltFUEF4aXNUeXBlMltcImVfZWRnZUFcIl0gPSAxXSA9IFwiZV9lZGdlQVwiO1xuICAgIEVQQXhpc1R5cGUyW0VQQXhpc1R5cGUyW1wiZV9lZGdlQlwiXSA9IDJdID0gXCJlX2VkZ2VCXCI7XG4gIH0pKEVQQXhpc1R5cGUgfHwgKEVQQXhpc1R5cGUgPSB7fSkpO1xuICB2YXIgVmVydGV4VHlwZTtcbiAgKGZ1bmN0aW9uKFZlcnRleFR5cGUyKSB7XG4gICAgVmVydGV4VHlwZTJbVmVydGV4VHlwZTJbXCJlX2lzb2xhdGVkXCJdID0gMF0gPSBcImVfaXNvbGF0ZWRcIjtcbiAgICBWZXJ0ZXhUeXBlMltWZXJ0ZXhUeXBlMltcImVfY29uY2F2ZVwiXSA9IDFdID0gXCJlX2NvbmNhdmVcIjtcbiAgICBWZXJ0ZXhUeXBlMltWZXJ0ZXhUeXBlMltcImVfY29udmV4XCJdID0gMl0gPSBcImVfY29udmV4XCI7XG4gIH0pKFZlcnRleFR5cGUgfHwgKFZlcnRleFR5cGUgPSB7fSkpO1xuICB2YXIgRVBBeGlzID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICAvKiBAX19QVVJFX18gKi8gZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBFUEF4aXMyKCkge1xuICAgICAgfVxuICAgICAgcmV0dXJuIEVQQXhpczI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBUZW1wUG9seWdvbiA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVGVtcFBvbHlnb24yKCkge1xuICAgICAgICB0aGlzLnZlcnRpY2VzID0gW107XG4gICAgICAgIHRoaXMubm9ybWFscyA9IFtdO1xuICAgICAgICB0aGlzLmNvdW50ID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBTZXR0aW5nc0ludGVybmFsLm1heFBvbHlnb25WZXJ0aWNlczsgaSsrKSB7XG4gICAgICAgICAgdGhpcy52ZXJ0aWNlcy5wdXNoKHZlYzIoMCwgMCkpO1xuICAgICAgICAgIHRoaXMubm9ybWFscy5wdXNoKHZlYzIoMCwgMCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gVGVtcFBvbHlnb24yO1xuICAgIH0oKVxuICApO1xuICB2YXIgUmVmZXJlbmNlRmFjZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBSZWZlcmVuY2VGYWNlMigpIHtcbiAgICAgICAgdGhpcy52MSA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMudjIgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLm5vcm1hbCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMuc2lkZU5vcm1hbDEgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnNpZGVOb3JtYWwyID0gdmVjMigwLCAwKTtcbiAgICAgIH1cbiAgICAgIFJlZmVyZW5jZUZhY2UyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHplcm9WZWMyKHRoaXMudjEpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnYyKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5ub3JtYWwpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnNpZGVOb3JtYWwxKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5zaWRlTm9ybWFsMik7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFJlZmVyZW5jZUZhY2UyO1xuICAgIH0oKVxuICApO1xuICB2YXIgY2xpcFBvaW50czEgPSBbbmV3IENsaXBWZXJ0ZXgoKSwgbmV3IENsaXBWZXJ0ZXgoKV07XG4gIHZhciBjbGlwUG9pbnRzMiA9IFtuZXcgQ2xpcFZlcnRleCgpLCBuZXcgQ2xpcFZlcnRleCgpXTtcbiAgdmFyIGllID0gW25ldyBDbGlwVmVydGV4KCksIG5ldyBDbGlwVmVydGV4KCldO1xuICB2YXIgZWRnZUF4aXMgPSBuZXcgRVBBeGlzKCk7XG4gIHZhciBwb2x5Z29uQXhpcyA9IG5ldyBFUEF4aXMoKTtcbiAgdmFyIHBvbHlnb25CQSA9IG5ldyBUZW1wUG9seWdvbigpO1xuICB2YXIgcmYgPSBuZXcgUmVmZXJlbmNlRmFjZSgpO1xuICB2YXIgY2VudHJvaWRCID0gdmVjMigwLCAwKTtcbiAgdmFyIGVkZ2UwID0gdmVjMigwLCAwKTtcbiAgdmFyIGVkZ2UxID0gdmVjMigwLCAwKTtcbiAgdmFyIGVkZ2UyID0gdmVjMigwLCAwKTtcbiAgdmFyIHhmID0gdHJhbnNmb3JtKDAsIDAsIDApO1xuICB2YXIgbm9ybWFsID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbDAgPSB2ZWMyKDAsIDApO1xuICB2YXIgbm9ybWFsMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBub3JtYWwyID0gdmVjMigwLCAwKTtcbiAgdmFyIGxvd2VyTGltaXQgPSB2ZWMyKDAsIDApO1xuICB2YXIgdXBwZXJMaW1pdCA9IHZlYzIoMCwgMCk7XG4gIHZhciBwZXJwID0gdmVjMigwLCAwKTtcbiAgdmFyIG4gPSB2ZWMyKDAsIDApO1xuICB2YXIgQ29sbGlkZUVkZ2VQb2x5Z29uID0gZnVuY3Rpb24obWFuaWZvbGQsIGVkZ2VBLCB4ZkEyLCBwb2x5Z29uQiwgeGZCMikge1xuICAgIGRldHJhbnNmb3JtVHJhbnNmb3JtKHhmLCB4ZkEyLCB4ZkIyKTtcbiAgICB0cmFuc2Zvcm1WZWMyKGNlbnRyb2lkQiwgeGYsIHBvbHlnb25CLm1fY2VudHJvaWQpO1xuICAgIHZhciB2MCA9IGVkZ2VBLm1fdmVydGV4MDtcbiAgICB2YXIgdjEzID0gZWRnZUEubV92ZXJ0ZXgxO1xuICAgIHZhciB2MjIgPSBlZGdlQS5tX3ZlcnRleDI7XG4gICAgdmFyIHYzID0gZWRnZUEubV92ZXJ0ZXgzO1xuICAgIHZhciBoYXNWZXJ0ZXgwID0gZWRnZUEubV9oYXNWZXJ0ZXgwO1xuICAgIHZhciBoYXNWZXJ0ZXgzID0gZWRnZUEubV9oYXNWZXJ0ZXgzO1xuICAgIHN1YlZlYzIoZWRnZTEsIHYyMiwgdjEzKTtcbiAgICBub3JtYWxpemVWZWMyKGVkZ2UxKTtcbiAgICBzZXRWZWMyKG5vcm1hbDEsIGVkZ2UxLnksIC1lZGdlMS54KTtcbiAgICB2YXIgb2Zmc2V0MSA9IGRvdFZlYzIobm9ybWFsMSwgY2VudHJvaWRCKSAtIGRvdFZlYzIobm9ybWFsMSwgdjEzKTtcbiAgICB2YXIgb2Zmc2V0MCA9IDA7XG4gICAgdmFyIG9mZnNldDIgPSAwO1xuICAgIHZhciBjb252ZXgxID0gZmFsc2U7XG4gICAgdmFyIGNvbnZleDIgPSBmYWxzZTtcbiAgICB6ZXJvVmVjMihub3JtYWwwKTtcbiAgICB6ZXJvVmVjMihub3JtYWwyKTtcbiAgICBpZiAoaGFzVmVydGV4MCkge1xuICAgICAgc3ViVmVjMihlZGdlMCwgdjEzLCB2MCk7XG4gICAgICBub3JtYWxpemVWZWMyKGVkZ2UwKTtcbiAgICAgIHNldFZlYzIobm9ybWFsMCwgZWRnZTAueSwgLWVkZ2UwLngpO1xuICAgICAgY29udmV4MSA9IGNyb3NzVmVjMlZlYzIoZWRnZTAsIGVkZ2UxKSA+PSAwO1xuICAgICAgb2Zmc2V0MCA9IFZlYzIuZG90KG5vcm1hbDAsIGNlbnRyb2lkQikgLSBWZWMyLmRvdChub3JtYWwwLCB2MCk7XG4gICAgfVxuICAgIGlmIChoYXNWZXJ0ZXgzKSB7XG4gICAgICBzdWJWZWMyKGVkZ2UyLCB2MywgdjIyKTtcbiAgICAgIG5vcm1hbGl6ZVZlYzIoZWRnZTIpO1xuICAgICAgc2V0VmVjMihub3JtYWwyLCBlZGdlMi55LCAtZWRnZTIueCk7XG4gICAgICBjb252ZXgyID0gVmVjMi5jcm9zc1ZlYzJWZWMyKGVkZ2UxLCBlZGdlMikgPiAwO1xuICAgICAgb2Zmc2V0MiA9IFZlYzIuZG90KG5vcm1hbDIsIGNlbnRyb2lkQikgLSBWZWMyLmRvdChub3JtYWwyLCB2MjIpO1xuICAgIH1cbiAgICB2YXIgZnJvbnQ7XG4gICAgemVyb1ZlYzIobm9ybWFsKTtcbiAgICB6ZXJvVmVjMihsb3dlckxpbWl0KTtcbiAgICB6ZXJvVmVjMih1cHBlckxpbWl0KTtcbiAgICBpZiAoaGFzVmVydGV4MCAmJiBoYXNWZXJ0ZXgzKSB7XG4gICAgICBpZiAoY29udmV4MSAmJiBjb252ZXgyKSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MCA+PSAwIHx8IG9mZnNldDEgPj0gMCB8fCBvZmZzZXQyID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMCk7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjb252ZXgxKSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MCA+PSAwIHx8IG9mZnNldDEgPj0gMCAmJiBvZmZzZXQyID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMCk7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMik7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjb252ZXgyKSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MiA+PSAwIHx8IG9mZnNldDAgPj0gMCAmJiBvZmZzZXQxID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwwKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnJvbnQgPSBvZmZzZXQwID49IDAgJiYgb2Zmc2V0MSA+PSAwICYmIG9mZnNldDIgPj0gMDtcbiAgICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwyKTtcbiAgICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChoYXNWZXJ0ZXgwKSB7XG4gICAgICBpZiAoY29udmV4MSkge1xuICAgICAgICBmcm9udCA9IG9mZnNldDAgPj0gMCB8fCBvZmZzZXQxID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMCk7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnJvbnQgPSBvZmZzZXQwID49IDAgJiYgb2Zmc2V0MSA+PSAwO1xuICAgICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGhhc1ZlcnRleDMpIHtcbiAgICAgIGlmIChjb252ZXgyKSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MSA+PSAwIHx8IG9mZnNldDIgPj0gMDtcbiAgICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmcm9udCA9IG9mZnNldDEgPj0gMCAmJiBvZmZzZXQyID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwyKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBmcm9udCA9IG9mZnNldDEgPj0gMDtcbiAgICAgIGlmIChmcm9udCkge1xuICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICB9XG4gICAgfVxuICAgIHBvbHlnb25CQS5jb3VudCA9IHBvbHlnb25CLm1fY291bnQ7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2x5Z29uQi5tX2NvdW50OyArK2kpIHtcbiAgICAgIHRyYW5zZm9ybVZlYzIocG9seWdvbkJBLnZlcnRpY2VzW2ldLCB4ZiwgcG9seWdvbkIubV92ZXJ0aWNlc1tpXSk7XG4gICAgICByb3RWZWMyKHBvbHlnb25CQS5ub3JtYWxzW2ldLCB4Zi5xLCBwb2x5Z29uQi5tX25vcm1hbHNbaV0pO1xuICAgIH1cbiAgICB2YXIgcmFkaXVzID0gcG9seWdvbkIubV9yYWRpdXMgKyBlZGdlQS5tX3JhZGl1cztcbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMDtcbiAgICB7XG4gICAgICBlZGdlQXhpcy50eXBlID0gRVBBeGlzVHlwZS5lX2VkZ2VBO1xuICAgICAgZWRnZUF4aXMuaW5kZXggPSBmcm9udCA/IDAgOiAxO1xuICAgICAgZWRnZUF4aXMuc2VwYXJhdGlvbiA9IEluZmluaXR5O1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2x5Z29uQkEuY291bnQ7ICsraSkge1xuICAgICAgICB2YXIgdjQgPSBwb2x5Z29uQkEudmVydGljZXNbaV07XG4gICAgICAgIHZhciBzMiA9IGRvdFZlYzIobm9ybWFsLCB2NCkgLSBkb3RWZWMyKG5vcm1hbCwgdjEzKTtcbiAgICAgICAgaWYgKHMyIDwgZWRnZUF4aXMuc2VwYXJhdGlvbikge1xuICAgICAgICAgIGVkZ2VBeGlzLnNlcGFyYXRpb24gPSBzMjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZWRnZUF4aXMudHlwZSA9PSBFUEF4aXNUeXBlLmVfdW5rbm93bikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZWRnZUF4aXMuc2VwYXJhdGlvbiA+IHJhZGl1cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB7XG4gICAgICBwb2x5Z29uQXhpcy50eXBlID0gRVBBeGlzVHlwZS5lX3Vua25vd247XG4gICAgICBwb2x5Z29uQXhpcy5pbmRleCA9IC0xO1xuICAgICAgcG9seWdvbkF4aXMuc2VwYXJhdGlvbiA9IC1JbmZpbml0eTtcbiAgICAgIHNldFZlYzIocGVycCwgLW5vcm1hbC55LCBub3JtYWwueCk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvbHlnb25CQS5jb3VudDsgKytpKSB7XG4gICAgICAgIHNjYWxlVmVjMihuLCAtMSwgcG9seWdvbkJBLm5vcm1hbHNbaV0pO1xuICAgICAgICB2YXIgczEgPSBkb3RWZWMyKG4sIHBvbHlnb25CQS52ZXJ0aWNlc1tpXSkgLSBkb3RWZWMyKG4sIHYxMyk7XG4gICAgICAgIHZhciBzMjIgPSBkb3RWZWMyKG4sIHBvbHlnb25CQS52ZXJ0aWNlc1tpXSkgLSBkb3RWZWMyKG4sIHYyMik7XG4gICAgICAgIHZhciBzMiA9IG1hdGhfbWluKHMxLCBzMjIpO1xuICAgICAgICBpZiAoczIgPiByYWRpdXMpIHtcbiAgICAgICAgICBwb2x5Z29uQXhpcy50eXBlID0gRVBBeGlzVHlwZS5lX2VkZ2VCO1xuICAgICAgICAgIHBvbHlnb25BeGlzLmluZGV4ID0gaTtcbiAgICAgICAgICBwb2x5Z29uQXhpcy5zZXBhcmF0aW9uID0gczI7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRvdFZlYzIobiwgcGVycCkgPj0gMCkge1xuICAgICAgICAgIGlmIChkb3RWZWMyKG4sIG5vcm1hbCkgLSBkb3RWZWMyKHVwcGVyTGltaXQsIG5vcm1hbCkgPCAtU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChkb3RWZWMyKG4sIG5vcm1hbCkgLSBkb3RWZWMyKGxvd2VyTGltaXQsIG5vcm1hbCkgPCAtU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzMiA+IHBvbHlnb25BeGlzLnNlcGFyYXRpb24pIHtcbiAgICAgICAgICBwb2x5Z29uQXhpcy50eXBlID0gRVBBeGlzVHlwZS5lX2VkZ2VCO1xuICAgICAgICAgIHBvbHlnb25BeGlzLmluZGV4ID0gaTtcbiAgICAgICAgICBwb2x5Z29uQXhpcy5zZXBhcmF0aW9uID0gczI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHBvbHlnb25BeGlzLnR5cGUgIT0gRVBBeGlzVHlwZS5lX3Vua25vd24gJiYgcG9seWdvbkF4aXMuc2VwYXJhdGlvbiA+IHJhZGl1cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIga19yZWxhdGl2ZVRvbCA9IDAuOTg7XG4gICAgdmFyIGtfYWJzb2x1dGVUb2wgPSAxZS0zO1xuICAgIHZhciBwcmltYXJ5QXhpcztcbiAgICBpZiAocG9seWdvbkF4aXMudHlwZSA9PSBFUEF4aXNUeXBlLmVfdW5rbm93bikge1xuICAgICAgcHJpbWFyeUF4aXMgPSBlZGdlQXhpcztcbiAgICB9IGVsc2UgaWYgKHBvbHlnb25BeGlzLnNlcGFyYXRpb24gPiBrX3JlbGF0aXZlVG9sICogZWRnZUF4aXMuc2VwYXJhdGlvbiArIGtfYWJzb2x1dGVUb2wpIHtcbiAgICAgIHByaW1hcnlBeGlzID0gcG9seWdvbkF4aXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByaW1hcnlBeGlzID0gZWRnZUF4aXM7XG4gICAgfVxuICAgIGllWzBdLnJlY3ljbGUoKTtcbiAgICBpZVsxXS5yZWN5Y2xlKCk7XG4gICAgaWYgKHByaW1hcnlBeGlzLnR5cGUgPT0gRVBBeGlzVHlwZS5lX2VkZ2VBKSB7XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUE7XG4gICAgICB2YXIgYmVzdEluZGV4ID0gMDtcbiAgICAgIHZhciBiZXN0VmFsdWUgPSBkb3RWZWMyKG5vcm1hbCwgcG9seWdvbkJBLm5vcm1hbHNbMF0pO1xuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwb2x5Z29uQkEuY291bnQ7ICsraSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBkb3RWZWMyKG5vcm1hbCwgcG9seWdvbkJBLm5vcm1hbHNbaV0pO1xuICAgICAgICBpZiAodmFsdWUgPCBiZXN0VmFsdWUpIHtcbiAgICAgICAgICBiZXN0VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICBiZXN0SW5kZXggPSBpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgaTEgPSBiZXN0SW5kZXg7XG4gICAgICB2YXIgaTIgPSBpMSArIDEgPCBwb2x5Z29uQkEuY291bnQgPyBpMSArIDEgOiAwO1xuICAgICAgY29weVZlYzIoaWVbMF0udiwgcG9seWdvbkJBLnZlcnRpY2VzW2kxXSk7XG4gICAgICBpZVswXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV9mYWNlLCBpMSwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICAgIGNvcHlWZWMyKGllWzFdLnYsIHBvbHlnb25CQS52ZXJ0aWNlc1tpMl0pO1xuICAgICAgaWVbMV0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfZmFjZSwgaTIsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgcmYuaTEgPSAwO1xuICAgICAgICByZi5pMiA9IDE7XG4gICAgICAgIGNvcHlWZWMyKHJmLnYxLCB2MTMpO1xuICAgICAgICBjb3B5VmVjMihyZi52MiwgdjIyKTtcbiAgICAgICAgY29weVZlYzIocmYubm9ybWFsLCBub3JtYWwxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJmLmkxID0gMTtcbiAgICAgICAgcmYuaTIgPSAwO1xuICAgICAgICBjb3B5VmVjMihyZi52MSwgdjIyKTtcbiAgICAgICAgY29weVZlYzIocmYudjIsIHYxMyk7XG4gICAgICAgIHNjYWxlVmVjMihyZi5ub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VCO1xuICAgICAgY29weVZlYzIoaWVbMF0udiwgdjEzKTtcbiAgICAgIGllWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgcHJpbWFyeUF4aXMuaW5kZXgsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UpO1xuICAgICAgY29weVZlYzIoaWVbMV0udiwgdjIyKTtcbiAgICAgIGllWzFdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgcHJpbWFyeUF4aXMuaW5kZXgsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UpO1xuICAgICAgcmYuaTEgPSBwcmltYXJ5QXhpcy5pbmRleDtcbiAgICAgIHJmLmkyID0gcmYuaTEgKyAxIDwgcG9seWdvbkJBLmNvdW50ID8gcmYuaTEgKyAxIDogMDtcbiAgICAgIGNvcHlWZWMyKHJmLnYxLCBwb2x5Z29uQkEudmVydGljZXNbcmYuaTFdKTtcbiAgICAgIGNvcHlWZWMyKHJmLnYyLCBwb2x5Z29uQkEudmVydGljZXNbcmYuaTJdKTtcbiAgICAgIGNvcHlWZWMyKHJmLm5vcm1hbCwgcG9seWdvbkJBLm5vcm1hbHNbcmYuaTFdKTtcbiAgICB9XG4gICAgc2V0VmVjMihyZi5zaWRlTm9ybWFsMSwgcmYubm9ybWFsLnksIC1yZi5ub3JtYWwueCk7XG4gICAgc2V0VmVjMihyZi5zaWRlTm9ybWFsMiwgLXJmLnNpZGVOb3JtYWwxLngsIC1yZi5zaWRlTm9ybWFsMS55KTtcbiAgICByZi5zaWRlT2Zmc2V0MSA9IGRvdFZlYzIocmYuc2lkZU5vcm1hbDEsIHJmLnYxKTtcbiAgICByZi5zaWRlT2Zmc2V0MiA9IGRvdFZlYzIocmYuc2lkZU5vcm1hbDIsIHJmLnYyKTtcbiAgICBjbGlwUG9pbnRzMVswXS5yZWN5Y2xlKCk7XG4gICAgY2xpcFBvaW50czFbMV0ucmVjeWNsZSgpO1xuICAgIGNsaXBQb2ludHMyWzBdLnJlY3ljbGUoKTtcbiAgICBjbGlwUG9pbnRzMlsxXS5yZWN5Y2xlKCk7XG4gICAgdmFyIG5wMSA9IGNsaXBTZWdtZW50VG9MaW5lKGNsaXBQb2ludHMxLCBpZSwgcmYuc2lkZU5vcm1hbDEsIHJmLnNpZGVPZmZzZXQxLCByZi5pMSk7XG4gICAgaWYgKG5wMSA8IFNldHRpbmdzSW50ZXJuYWwubWF4TWFuaWZvbGRQb2ludHMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG5wMiA9IGNsaXBTZWdtZW50VG9MaW5lKGNsaXBQb2ludHMyLCBjbGlwUG9pbnRzMSwgcmYuc2lkZU5vcm1hbDIsIHJmLnNpZGVPZmZzZXQyLCByZi5pMik7XG4gICAgaWYgKG5wMiA8IFNldHRpbmdzSW50ZXJuYWwubWF4TWFuaWZvbGRQb2ludHMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHByaW1hcnlBeGlzLnR5cGUgPT0gRVBBeGlzVHlwZS5lX2VkZ2VBKSB7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgcmYubm9ybWFsKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIHJmLnYxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIHBvbHlnb25CLm1fbm9ybWFsc1tyZi5pMV0pO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgcG9seWdvbkIubV92ZXJ0aWNlc1tyZi5pMV0pO1xuICAgIH1cbiAgICB2YXIgcG9pbnRDb3VudCA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBTZXR0aW5nc0ludGVybmFsLm1heE1hbmlmb2xkUG9pbnRzOyArK2kpIHtcbiAgICAgIHZhciBzZXBhcmF0aW9uID0gZG90VmVjMihyZi5ub3JtYWwsIGNsaXBQb2ludHMyW2ldLnYpIC0gZG90VmVjMihyZi5ub3JtYWwsIHJmLnYxKTtcbiAgICAgIGlmIChzZXBhcmF0aW9uIDw9IHJhZGl1cykge1xuICAgICAgICB2YXIgY3AgPSBtYW5pZm9sZC5wb2ludHNbcG9pbnRDb3VudF07XG4gICAgICAgIGlmIChwcmltYXJ5QXhpcy50eXBlID09IEVQQXhpc1R5cGUuZV9lZGdlQSkge1xuICAgICAgICAgIGRldHJhbnNmb3JtVmVjMihjcC5sb2NhbFBvaW50LCB4ZiwgY2xpcFBvaW50czJbaV0udik7XG4gICAgICAgICAgY3AuaWQuc2V0KGNsaXBQb2ludHMyW2ldLmlkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb3B5VmVjMihjcC5sb2NhbFBvaW50LCBjbGlwUG9pbnRzMltpXS52KTtcbiAgICAgICAgICBjcC5pZC5zZXQoY2xpcFBvaW50czJbaV0uaWQpO1xuICAgICAgICAgIGNwLmlkLnN3YXBGZWF0dXJlcygpO1xuICAgICAgICB9XG4gICAgICAgICsrcG9pbnRDb3VudDtcbiAgICAgIH1cbiAgICB9XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IHBvaW50Q291bnQ7XG4gIH07XG4gIHZhciBpbnRlcm5hbCA9IHtcbiAgICBDb2xsaWRlUG9seWdvbnMsXG4gICAgU2V0dGluZ3MsXG4gICAgU3dlZXAsXG4gICAgTWFuaWZvbGQsXG4gICAgRGlzdGFuY2UsXG4gICAgVGltZU9mSW1wYWN0LFxuICAgIER5bmFtaWNUcmVlLFxuICAgIHN0YXRzXG4gIH07XG4gIHZhciBEYXRhRHJpdmVyID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIERhdGFEcml2ZXIyKGtleSwgbGlzdGVuZXIpIHtcbiAgICAgICAgdGhpcy5fcmVmTWFwID0ge307XG4gICAgICAgIHRoaXMuX21hcCA9IHt9O1xuICAgICAgICB0aGlzLl94bWFwID0ge307XG4gICAgICAgIHRoaXMuX2RhdGEgPSBbXTtcbiAgICAgICAgdGhpcy5fZW50ZXJlZCA9IFtdO1xuICAgICAgICB0aGlzLl9leGl0ZWQgPSBbXTtcbiAgICAgICAgdGhpcy5fa2V5ID0ga2V5O1xuICAgICAgICB0aGlzLl9saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgICAgfVxuICAgICAgRGF0YURyaXZlcjIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGRhdGEpKVxuICAgICAgICAgIHRocm93IFwiSW52YWxpZCBkYXRhOiBcIiArIGRhdGE7XG4gICAgICAgIHRoaXMuX2VudGVyZWQubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5fZXhpdGVkLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuX2RhdGEubGVuZ3RoID0gZGF0YS5sZW5ndGg7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmICh0eXBlb2YgZGF0YVtpXSAhPT0gXCJvYmplY3RcIiB8fCBkYXRhW2ldID09PSBudWxsKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgdmFyIGQyID0gZGF0YVtpXTtcbiAgICAgICAgICB2YXIgaWQgPSB0aGlzLl9rZXkoZDIpO1xuICAgICAgICAgIGlmICghdGhpcy5fbWFwW2lkXSkge1xuICAgICAgICAgICAgdGhpcy5fZW50ZXJlZC5wdXNoKGQyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX21hcFtpZF07XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX2RhdGFbaV0gPSBkMjtcbiAgICAgICAgICB0aGlzLl94bWFwW2lkXSA9IGQyO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGlkIGluIHRoaXMuX21hcCkge1xuICAgICAgICAgIHRoaXMuX2V4aXRlZC5wdXNoKHRoaXMuX21hcFtpZF0pO1xuICAgICAgICAgIGRlbGV0ZSB0aGlzLl9tYXBbaWRdO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0ZW1wMyA9IHRoaXMuX21hcDtcbiAgICAgICAgdGhpcy5fbWFwID0gdGhpcy5feG1hcDtcbiAgICAgICAgdGhpcy5feG1hcCA9IHRlbXAzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2V4aXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBkMiA9IHRoaXMuX2V4aXRlZFtpXTtcbiAgICAgICAgICB2YXIga2V5ID0gdGhpcy5fa2V5KGQyKTtcbiAgICAgICAgICB2YXIgcmVmID0gdGhpcy5fcmVmTWFwW2tleV07XG4gICAgICAgICAgdGhpcy5fbGlzdGVuZXIuZXhpdChkMiwgcmVmKTtcbiAgICAgICAgICBkZWxldGUgdGhpcy5fcmVmTWFwW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9lbnRlcmVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdmFyIGQyID0gdGhpcy5fZW50ZXJlZFtpXTtcbiAgICAgICAgICB2YXIga2V5ID0gdGhpcy5fa2V5KGQyKTtcbiAgICAgICAgICB2YXIgcmVmID0gdGhpcy5fbGlzdGVuZXIuZW50ZXIoZDIpO1xuICAgICAgICAgIGlmIChyZWYpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlZk1hcFtrZXldID0gcmVmO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2RhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGRhdGFbaV0gIT09IFwib2JqZWN0XCIgfHwgZGF0YVtpXSA9PT0gbnVsbClcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIHZhciBkMiA9IHRoaXMuX2RhdGFbaV07XG4gICAgICAgICAgdmFyIGtleSA9IHRoaXMuX2tleShkMik7XG4gICAgICAgICAgdmFyIHJlZiA9IHRoaXMuX3JlZk1hcFtrZXldO1xuICAgICAgICAgIHRoaXMuX2xpc3RlbmVyLnVwZGF0ZShkMiwgcmVmKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9lbnRlcmVkLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuX2V4aXRlZC5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLl9kYXRhLmxlbmd0aCA9IDA7XG4gICAgICB9O1xuICAgICAgRGF0YURyaXZlcjIucHJvdG90eXBlLnJlZiA9IGZ1bmN0aW9uKGQyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZWZNYXBbdGhpcy5fa2V5KGQyKV07XG4gICAgICB9O1xuICAgICAgcmV0dXJuIERhdGFEcml2ZXIyO1xuICAgIH0oKVxuICApO1xuICBjb25zdCBwbGFuY2sgPSAvKiBAX19QVVJFX18gKi8gT2JqZWN0LmZyZWV6ZSgvKiBAX19QVVJFX18gKi8gT2JqZWN0LmRlZmluZVByb3BlcnR5KHtcbiAgICBfX3Byb3RvX186IG51bGwsXG4gICAgQUFCQixcbiAgICBCb2R5LFxuICAgIEJveDogQm94U2hhcGUsXG4gICAgQm94U2hhcGUsXG4gICAgQnJvYWRQaGFzZSxcbiAgICBDaGFpbjogQ2hhaW5TaGFwZSxcbiAgICBDaGFpblNoYXBlLFxuICAgIENpcmNsZTogQ2lyY2xlU2hhcGUsXG4gICAgQ2lyY2xlU2hhcGUsXG4gICAgQ2xpcFZlcnRleCxcbiAgICBDb2xsaWRlQ2lyY2xlcyxcbiAgICBDb2xsaWRlRWRnZUNpcmNsZSxcbiAgICBDb2xsaWRlRWRnZVBvbHlnb24sXG4gICAgQ29sbGlkZVBvbHlnb25DaXJjbGUsXG4gICAgQ29sbGlkZVBvbHlnb25zLFxuICAgIENvbnRhY3QsXG4gICAgQ29udGFjdEVkZ2UsXG4gICAgZ2V0IENvbnRhY3RGZWF0dXJlVHlwZSgpIHtcbiAgICAgIHJldHVybiBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGU7XG4gICAgfSxcbiAgICBDb250YWN0SUQsXG4gICAgQ29udGFjdEltcHVsc2UsXG4gICAgRGF0YURyaXZlcixcbiAgICBEaXN0YW5jZSxcbiAgICBEaXN0YW5jZUlucHV0LFxuICAgIERpc3RhbmNlSm9pbnQsXG4gICAgRGlzdGFuY2VPdXRwdXQsXG4gICAgRGlzdGFuY2VQcm94eSxcbiAgICBEeW5hbWljVHJlZSxcbiAgICBFZGdlOiBFZGdlU2hhcGUsXG4gICAgRWRnZVNoYXBlLFxuICAgIEZpeHR1cmUsXG4gICAgRml4dHVyZVByb3h5LFxuICAgIEZyaWN0aW9uSm9pbnQsXG4gICAgR2VhckpvaW50LFxuICAgIEpvaW50LFxuICAgIEpvaW50RWRnZSxcbiAgICBNYW5pZm9sZCxcbiAgICBNYW5pZm9sZFBvaW50LFxuICAgIGdldCBNYW5pZm9sZFR5cGUoKSB7XG4gICAgICByZXR1cm4gZXhwb3J0czIuTWFuaWZvbGRUeXBlO1xuICAgIH0sXG4gICAgTWF0MjIsXG4gICAgTWF0MzMsXG4gICAgTWF0aDogbWF0aCxcbiAgICBNb3RvckpvaW50LFxuICAgIE1vdXNlSm9pbnQsXG4gICAgZ2V0IFBvaW50U3RhdGUoKSB7XG4gICAgICByZXR1cm4gZXhwb3J0czIuUG9pbnRTdGF0ZTtcbiAgICB9LFxuICAgIFBvbHlnb246IFBvbHlnb25TaGFwZSxcbiAgICBQb2x5Z29uU2hhcGUsXG4gICAgUHJpc21hdGljSm9pbnQsXG4gICAgUHVsbGV5Sm9pbnQsXG4gICAgUmV2b2x1dGVKb2ludCxcbiAgICBSb3BlSm9pbnQsXG4gICAgUm90LFxuICAgIFNlcmlhbGl6ZXIsXG4gICAgU2V0dGluZ3MsXG4gICAgU2V0dGluZ3NJbnRlcm5hbCxcbiAgICBTaGFwZSxcbiAgICBTaGFwZUNhc3QsXG4gICAgU2hhcGVDYXN0SW5wdXQsXG4gICAgU2hhcGVDYXN0T3V0cHV0LFxuICAgIFNpbXBsZXhDYWNoZSxcbiAgICBTb2x2ZXIsXG4gICAgU3dlZXAsXG4gICAgVE9JSW5wdXQsXG4gICAgVE9JT3V0cHV0LFxuICAgIGdldCBUT0lPdXRwdXRTdGF0ZSgpIHtcbiAgICAgIHJldHVybiBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZTtcbiAgICB9LFxuICAgIFRlc3RiZWQsXG4gICAgVGltZU9mSW1wYWN0LFxuICAgIFRpbWVTdGVwLFxuICAgIFRyYW5zZm9ybSxcbiAgICBUcmVlTm9kZSxcbiAgICBWZWMyLFxuICAgIFZlYzMsXG4gICAgVmVsb2NpdHlDb25zdHJhaW50UG9pbnQsXG4gICAgV2VsZEpvaW50LFxuICAgIFdoZWVsSm9pbnQsXG4gICAgV29ybGQsXG4gICAgV29ybGRNYW5pZm9sZCxcbiAgICBjbGlwU2VnbWVudFRvTGluZSxcbiAgICBnZXRQb2ludFN0YXRlcyxcbiAgICBpbnRlcm5hbCxcbiAgICBtaXhGcmljdGlvbixcbiAgICBtaXhSZXN0aXR1dGlvbixcbiAgICBzdGF0cyxcbiAgICB0ZXN0T3ZlcmxhcCxcbiAgICB0ZXN0YmVkXG4gIH0sIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogXCJNb2R1bGVcIiB9KSk7XG4gIGV4cG9ydHMyLkFBQkIgPSBBQUJCO1xuICBleHBvcnRzMi5Cb2R5ID0gQm9keTtcbiAgZXhwb3J0czIuQm94ID0gQm94U2hhcGU7XG4gIGV4cG9ydHMyLkJveFNoYXBlID0gQm94U2hhcGU7XG4gIGV4cG9ydHMyLkJyb2FkUGhhc2UgPSBCcm9hZFBoYXNlO1xuICBleHBvcnRzMi5DaGFpbiA9IENoYWluU2hhcGU7XG4gIGV4cG9ydHMyLkNoYWluU2hhcGUgPSBDaGFpblNoYXBlO1xuICBleHBvcnRzMi5DaXJjbGUgPSBDaXJjbGVTaGFwZTtcbiAgZXhwb3J0czIuQ2lyY2xlU2hhcGUgPSBDaXJjbGVTaGFwZTtcbiAgZXhwb3J0czIuQ2xpcFZlcnRleCA9IENsaXBWZXJ0ZXg7XG4gIGV4cG9ydHMyLkNvbGxpZGVDaXJjbGVzID0gQ29sbGlkZUNpcmNsZXM7XG4gIGV4cG9ydHMyLkNvbGxpZGVFZGdlQ2lyY2xlID0gQ29sbGlkZUVkZ2VDaXJjbGU7XG4gIGV4cG9ydHMyLkNvbGxpZGVFZGdlUG9seWdvbiA9IENvbGxpZGVFZGdlUG9seWdvbjtcbiAgZXhwb3J0czIuQ29sbGlkZVBvbHlnb25DaXJjbGUgPSBDb2xsaWRlUG9seWdvbkNpcmNsZTtcbiAgZXhwb3J0czIuQ29sbGlkZVBvbHlnb25zID0gQ29sbGlkZVBvbHlnb25zO1xuICBleHBvcnRzMi5Db250YWN0ID0gQ29udGFjdDtcbiAgZXhwb3J0czIuQ29udGFjdEVkZ2UgPSBDb250YWN0RWRnZTtcbiAgZXhwb3J0czIuQ29udGFjdElEID0gQ29udGFjdElEO1xuICBleHBvcnRzMi5Db250YWN0SW1wdWxzZSA9IENvbnRhY3RJbXB1bHNlO1xuICBleHBvcnRzMi5EYXRhRHJpdmVyID0gRGF0YURyaXZlcjtcbiAgZXhwb3J0czIuRGlzdGFuY2UgPSBEaXN0YW5jZTtcbiAgZXhwb3J0czIuRGlzdGFuY2VJbnB1dCA9IERpc3RhbmNlSW5wdXQ7XG4gIGV4cG9ydHMyLkRpc3RhbmNlSm9pbnQgPSBEaXN0YW5jZUpvaW50O1xuICBleHBvcnRzMi5EaXN0YW5jZU91dHB1dCA9IERpc3RhbmNlT3V0cHV0O1xuICBleHBvcnRzMi5EaXN0YW5jZVByb3h5ID0gRGlzdGFuY2VQcm94eTtcbiAgZXhwb3J0czIuRHluYW1pY1RyZWUgPSBEeW5hbWljVHJlZTtcbiAgZXhwb3J0czIuRWRnZSA9IEVkZ2VTaGFwZTtcbiAgZXhwb3J0czIuRWRnZVNoYXBlID0gRWRnZVNoYXBlO1xuICBleHBvcnRzMi5GaXh0dXJlID0gRml4dHVyZTtcbiAgZXhwb3J0czIuRml4dHVyZVByb3h5ID0gRml4dHVyZVByb3h5O1xuICBleHBvcnRzMi5GcmljdGlvbkpvaW50ID0gRnJpY3Rpb25Kb2ludDtcbiAgZXhwb3J0czIuR2VhckpvaW50ID0gR2VhckpvaW50O1xuICBleHBvcnRzMi5Kb2ludCA9IEpvaW50O1xuICBleHBvcnRzMi5Kb2ludEVkZ2UgPSBKb2ludEVkZ2U7XG4gIGV4cG9ydHMyLk1hbmlmb2xkID0gTWFuaWZvbGQ7XG4gIGV4cG9ydHMyLk1hbmlmb2xkUG9pbnQgPSBNYW5pZm9sZFBvaW50O1xuICBleHBvcnRzMi5NYXQyMiA9IE1hdDIyO1xuICBleHBvcnRzMi5NYXQzMyA9IE1hdDMzO1xuICBleHBvcnRzMi5NYXRoID0gbWF0aDtcbiAgZXhwb3J0czIuTW90b3JKb2ludCA9IE1vdG9ySm9pbnQ7XG4gIGV4cG9ydHMyLk1vdXNlSm9pbnQgPSBNb3VzZUpvaW50O1xuICBleHBvcnRzMi5Qb2x5Z29uID0gUG9seWdvblNoYXBlO1xuICBleHBvcnRzMi5Qb2x5Z29uU2hhcGUgPSBQb2x5Z29uU2hhcGU7XG4gIGV4cG9ydHMyLlByaXNtYXRpY0pvaW50ID0gUHJpc21hdGljSm9pbnQ7XG4gIGV4cG9ydHMyLlB1bGxleUpvaW50ID0gUHVsbGV5Sm9pbnQ7XG4gIGV4cG9ydHMyLlJldm9sdXRlSm9pbnQgPSBSZXZvbHV0ZUpvaW50O1xuICBleHBvcnRzMi5Sb3BlSm9pbnQgPSBSb3BlSm9pbnQ7XG4gIGV4cG9ydHMyLlJvdCA9IFJvdDtcbiAgZXhwb3J0czIuU2VyaWFsaXplciA9IFNlcmlhbGl6ZXI7XG4gIGV4cG9ydHMyLlNldHRpbmdzID0gU2V0dGluZ3M7XG4gIGV4cG9ydHMyLlNldHRpbmdzSW50ZXJuYWwgPSBTZXR0aW5nc0ludGVybmFsO1xuICBleHBvcnRzMi5TaGFwZSA9IFNoYXBlO1xuICBleHBvcnRzMi5TaGFwZUNhc3QgPSBTaGFwZUNhc3Q7XG4gIGV4cG9ydHMyLlNoYXBlQ2FzdElucHV0ID0gU2hhcGVDYXN0SW5wdXQ7XG4gIGV4cG9ydHMyLlNoYXBlQ2FzdE91dHB1dCA9IFNoYXBlQ2FzdE91dHB1dDtcbiAgZXhwb3J0czIuU2ltcGxleENhY2hlID0gU2ltcGxleENhY2hlO1xuICBleHBvcnRzMi5Tb2x2ZXIgPSBTb2x2ZXI7XG4gIGV4cG9ydHMyLlN3ZWVwID0gU3dlZXA7XG4gIGV4cG9ydHMyLlRPSUlucHV0ID0gVE9JSW5wdXQ7XG4gIGV4cG9ydHMyLlRPSU91dHB1dCA9IFRPSU91dHB1dDtcbiAgZXhwb3J0czIuVGVzdGJlZCA9IFRlc3RiZWQ7XG4gIGV4cG9ydHMyLlRpbWVPZkltcGFjdCA9IFRpbWVPZkltcGFjdDtcbiAgZXhwb3J0czIuVGltZVN0ZXAgPSBUaW1lU3RlcDtcbiAgZXhwb3J0czIuVHJhbnNmb3JtID0gVHJhbnNmb3JtO1xuICBleHBvcnRzMi5UcmVlTm9kZSA9IFRyZWVOb2RlO1xuICBleHBvcnRzMi5WZWMyID0gVmVjMjtcbiAgZXhwb3J0czIuVmVjMyA9IFZlYzM7XG4gIGV4cG9ydHMyLlZlbG9jaXR5Q29uc3RyYWludFBvaW50ID0gVmVsb2NpdHlDb25zdHJhaW50UG9pbnQ7XG4gIGV4cG9ydHMyLldlbGRKb2ludCA9IFdlbGRKb2ludDtcbiAgZXhwb3J0czIuV2hlZWxKb2ludCA9IFdoZWVsSm9pbnQ7XG4gIGV4cG9ydHMyLldvcmxkID0gV29ybGQ7XG4gIGV4cG9ydHMyLldvcmxkTWFuaWZvbGQgPSBXb3JsZE1hbmlmb2xkO1xuICBleHBvcnRzMi5jbGlwU2VnbWVudFRvTGluZSA9IGNsaXBTZWdtZW50VG9MaW5lO1xuICBleHBvcnRzMi5kZWZhdWx0ID0gcGxhbmNrO1xuICBleHBvcnRzMi5nZXRQb2ludFN0YXRlcyA9IGdldFBvaW50U3RhdGVzO1xuICBleHBvcnRzMi5pbnRlcm5hbCA9IGludGVybmFsO1xuICBleHBvcnRzMi5taXhGcmljdGlvbiA9IG1peEZyaWN0aW9uO1xuICBleHBvcnRzMi5taXhSZXN0aXR1dGlvbiA9IG1peFJlc3RpdHV0aW9uO1xuICBleHBvcnRzMi5zdGF0cyA9IHN0YXRzO1xuICBleHBvcnRzMi50ZXN0T3ZlcmxhcCA9IHRlc3RPdmVybGFwO1xuICBleHBvcnRzMi50ZXN0YmVkID0gdGVzdGJlZDtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0czIsIHsgX19lc01vZHVsZTogeyB2YWx1ZTogdHJ1ZSB9LCBbU3ltYm9sLnRvU3RyaW5nVGFnXTogeyB2YWx1ZTogXCJNb2R1bGVcIiB9IH0pO1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wbGFuY2suanMubWFwXG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IEFzc2V0IH0gZnJvbSAnLi4nO1xuaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnLi9ldmVudC1zeXN0ZW0nO1xuXG4vKiogRXZlbnRzIGVtaXR0ZWQgYnkgQXNzZXRMb2FkZXIuICovXG5leHBvcnQgaW50ZXJmYWNlIEFzc2V0TG9hZGVyRXZlbnRzIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkPiB7XG4gICdsb2FkaW5nOnN0YXJ0JzogKCkgPT4gdm9pZDtcbiAgJ2xvYWRpbmc6ZW5kJzogKCkgPT4gdm9pZDtcbn1cblxuLyoqXG4gKiBXcmFwcGVyIGFyb3VuZCBQSVhJLkFzc2V0cyB3aXRoIGxvYWRpbmcgZXZlbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3QgeyBsb2FkQXNzZXRzLCBQSVhJQXNzZXRzIH0gPSBhd2FpdCBzZXR1cE1veGkoey4uLn0pO1xuICpcbiAqIGF3YWl0IGxvYWRBc3NldHMoW1xuICogICB7IHNyYzogJy4vcGxheWVyLnBuZycsIGFsaWFzOiAncGxheWVyJyB9LFxuICogICB7IHNyYzogJy4vZW5lbXkucG5nJywgYWxpYXM6ICdlbmVteScgfVxuICogXSk7XG4gKlxuICogY29uc3QgdGV4dHVyZSA9IFBJWElBc3NldHMuZ2V0KCdwbGF5ZXInKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgQXNzZXRMb2FkZXIge1xuICAvKiogUElYSS5Bc3NldHMgaW5zdGFuY2UuIFVzZSAuZ2V0KGFsaWFzKSB0byByZXRyaWV2ZSBsb2FkZWQgdGV4dHVyZXMuICovXG4gIFBJWElBc3NldHM6IFBJWEkuQXNzZXRzQ2xhc3MgPSBQSVhJLkFzc2V0cztcblxuICAvKiogQWxsIGxvYWRlZCB0ZXh0dXJlcy4gKi9cbiAgdGV4dHVyZXM6IFBJWEkuVGV4dHVyZVtdID0gW107XG5cbiAgLyoqIFRydWUgd2hpbGUgbG9hZGluZyBpbiBwcm9ncmVzcy4gKi9cbiAgaXNMb2FkaW5nOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBldmVudHM6IEV2ZW50RW1pdHRlcjxBc3NldExvYWRlckV2ZW50cz4gPSBuZXcgRXZlbnRFbWl0dGVyPEFzc2V0TG9hZGVyRXZlbnRzPigpO1xuXG4gIC8qKiBTdWJzY3JpYmUgdG8gJ2xvYWRpbmc6c3RhcnQnIG9yICdsb2FkaW5nOmVuZCcgZXZlbnRzLiAqL1xuICBvbjxLIGV4dGVuZHMga2V5b2YgQXNzZXRMb2FkZXJFdmVudHM+KGV2ZW50OiBLLCBsaXN0ZW5lcjogQXNzZXRMb2FkZXJFdmVudHNbS10pOiB2b2lkIHtcbiAgICB0aGlzLmV2ZW50cy5vbihldmVudCwgbGlzdGVuZXIpO1xuICB9XG5cbiAgLyoqIFVuc3Vic2NyaWJlIGZyb20gZXZlbnRzLiAqL1xuICBvZmY8SyBleHRlbmRzIGtleW9mIEFzc2V0TG9hZGVyRXZlbnRzPihldmVudDogSywgbGlzdGVuZXI6IEFzc2V0TG9hZGVyRXZlbnRzW0tdKTogdm9pZCB7XG4gICAgdGhpcy5ldmVudHMub2ZmKGV2ZW50LCBsaXN0ZW5lcik7XG4gIH1cblxuICBsb2FkQXNzZXRzID0gYXN5bmMgKGFzc2V0czogQXNzZXRbXSkgPT4ge1xuICAgIGNvbnN0IHsgUElYSUFzc2V0cyB9ID0gdGhpcztcbiAgICBjb25zdCBmYWlsZWRBc3NldHM6IHN0cmluZ1tdID0gW107XG5cbiAgICAvLyBFbWl0IGxvYWRpbmcgc3RhcnQgZXZlbnRcbiAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7XG4gICAgdGhpcy5ldmVudHMuZW1pdCgnbG9hZGluZzpzdGFydCcpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXNzZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHsgc3JjLCBhbGlhcyB9ID0gYXNzZXRzW2ldO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKGFsaWFzKSB7XG4gICAgICAgICAgICBpZiAoIVBJWElBc3NldHMuY2FjaGUuaGFzKGFsaWFzKSkge1xuICAgICAgICAgICAgICBjb25zdCB0ZXh0dXJlID0gYXdhaXQgUElYSUFzc2V0cy5sb2FkKHsgYWxpYXMsIHNyYyB9KTtcbiAgICAgICAgICAgICAgdGhpcy50ZXh0dXJlcy5wdXNoKHRleHR1cmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0dXJlID0gYXdhaXQgUElYSUFzc2V0cy5sb2FkKHNyYyk7XG4gICAgICAgICAgICB0aGlzLnRleHR1cmVzLnB1c2godGV4dHVyZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBsb2FkIGFzc2V0OiAke3NyY31gLCBlcnJvcik7XG4gICAgICAgICAgZmFpbGVkQXNzZXRzLnB1c2goc3JjKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoZmFpbGVkQXNzZXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc29sZS53YXJuKGAke2ZhaWxlZEFzc2V0cy5sZW5ndGh9IGFzc2V0KHMpIGZhaWxlZCB0byBsb2FkOmAsIGZhaWxlZEFzc2V0cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAvLyBFbWl0IGxvYWRpbmcgZW5kIGV2ZW50XG4gICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5ldmVudHMuZW1pdCgnbG9hZGluZzplbmQnKTtcbiAgICB9XG4gIH07XG59IiwiaW1wb3J0IFBJWEksIHsgUG9pbnQgfSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IExvZ2ljIH0gZnJvbSAnLi9sb2dpYyc7XG5pbXBvcnQgeyBTY2VuZSB9IGZyb20gJy4vc2NlbmUnO1xuaW1wb3J0IHsgQXNFbnRpdHksIE1veGlMb2dpYywgTW94aUVudGl0eSB9IGZyb20gJy4vbW94aS1lbnRpdHknO1xuaW1wb3J0IHsgbGVycCB9IGZyb20gJy4uL2xpYnJhcnkvdXRpbHMnO1xuXG4vKipcbiAqIExvZ2ljIGhhbmRsaW5nIGNhbWVyYSBmb2xsb3dpbmcgYW5kIHNtb290aCB0cmFuc2l0aW9ucy5cbiAqIEF0dGFjaGVkIGF1dG9tYXRpY2FsbHkgdG8gQ2FtZXJhLiBBY2Nlc3MgdmlhIGNhbWVyYS5tb3hpRW50aXR5LmdldExvZ2ljKCdDYW1lcmFMb2dpYycpLlxuICovXG5leHBvcnQgY2xhc3MgQ2FtZXJhTG9naWMgZXh0ZW5kcyBMb2dpYzxQSVhJLkNvbnRhaW5lcj4ge1xuICBuYW1lID0gJ0NhbWVyYUxvZ2ljJztcblxuICAvKiogSW50ZXJwb2xhdGlvbiBzcGVlZCAoMC0xKS4gSGlnaGVyID0gc25hcHBpZXIuICovXG4gIHB1YmxpYyBzcGVlZDogbnVtYmVyID0gMC4xO1xuXG4gIC8qKiBFbnRpdHkgdG8gZm9sbG93LiBTZXQgdG8gZW5hYmxlIHRyYWNraW5nLiAqL1xuICBwdWJsaWMgdGFyZ2V0OiBQSVhJLkNvbnRhaW5lciA9IG51bGw7XG5cbiAgZW50aXR5OiBQSVhJLkNvbnRhaW5lcjxQSVhJLkNvbnRhaW5lckNoaWxkPjtcbiAgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI8SFRNTENhbnZhc0VsZW1lbnQ+O1xuXG4gIGluaXQoZW50aXR5OiBQSVhJLkNvbnRhaW5lciwgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXIpIHtcbiAgICB0aGlzLmVudGl0eSA9IGVudGl0eTtcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gIH1cblxuICAvKiogQGludGVybmFsIFNtb290aGx5IHVwZGF0ZXMgY2FtZXJhIHBvc2l0aW9uL3NjYWxlIGVhY2ggZnJhbWUuICovXG4gIHVwZGF0ZShlbnRpdHk6IENhbWVyYSwgZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgICBjb25zdCB7IHNwZWVkIH0gPSB0aGlzO1xuICAgIGNvbnN0IGRlbHRhU3BlZWQgPSBNYXRoLm1pbihkZWx0YVRpbWUgKiBzcGVlZCwgMSk7XG5cbiAgICAvLyBUcmFjayBpZiBzY2FsZSBpcyBhY3RpdmVseSBjaGFuZ2luZyAoem9vbWluZylcbiAgICBjb25zdCBpc1pvb21pbmcgPSBNYXRoLmFicyhlbnRpdHkuc2NhbGUueCAtIGVudGl0eS5kZXNpcmVkU2NhbGUueCkgPiAwLjAxIHx8XG4gICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZW50aXR5LnNjYWxlLnkgLSBlbnRpdHkuZGVzaXJlZFNjYWxlLnkpID4gMC4wMTtcblxuICAgIC8vIEludGVycG9sYXRlIHNjYWxlIHZhbHVlcyBmaXJzdFxuICAgIGlmIChlbnRpdHkuZGVzaXJlZFNjYWxlICE9PSBlbnRpdHkuc2NhbGUpIHtcbiAgICAgIGVudGl0eS5zY2FsZS54ID0gbGVycChlbnRpdHkuc2NhbGUueCwgZW50aXR5LmRlc2lyZWRTY2FsZS54LCBkZWx0YVNwZWVkKTtcbiAgICAgIGVudGl0eS5zY2FsZS55ID0gbGVycChlbnRpdHkuc2NhbGUueSwgZW50aXR5LmRlc2lyZWRTY2FsZS55LCBkZWx0YVNwZWVkKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgZGVzaXJlZCBwb3NpdGlvbiBpZiBjYW1lcmEgaGFzIGEgdGFyZ2V0XG4gICAgaWYgKHRoaXMudGFyZ2V0KSB7XG4gICAgICAvLyBJbiBhIFBJWEkuanMgY2FtZXJhIHN5c3RlbSwgd2UgbmVlZCB0byBwb3NpdGlvbiB0aGUgY2FtZXJhIChzY2VuZSlcbiAgICAgIC8vIHNvIHRoYXQgdGhlIHRhcmdldCBhcHBlYXJzIGNlbnRlcmVkIGluIHRoZSB2aWV3cG9ydFxuXG4gICAgICAvLyBHZXQgdGhlIGNlbnRlciBvZiB0aGUgdmlld3BvcnQgaW4gc2NyZWVuIGNvb3JkaW5hdGVzXG4gICAgICBjb25zdCBzY3JlZW5DZW50ZXJYID0gdGhpcy5yZW5kZXJlci53aWR0aCAvIDI7XG4gICAgICBjb25zdCBzY3JlZW5DZW50ZXJZID0gdGhpcy5yZW5kZXJlci5oZWlnaHQgLyAyO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgd2hlcmUgdGhlIHNjZW5lIHNob3VsZCBiZSBwb3NpdGlvbmVkXG4gICAgICAvLyBUaGUgZm9ybXVsYSBpczogLSh0YXJnZXRQb3NpdGlvbiAqIHNjYWxlKSArIHNjcmVlbkNlbnRlclxuICAgICAgLy8gVGhpcyBlbnN1cmVzIHRoZSB0YXJnZXQgaXMgYXQgdGhlIGNlbnRlciBvZiB0aGUgc2NyZWVuXG4gICAgICBjb25zdCBkZXNpcmVkWCA9IC0odGhpcy50YXJnZXQucG9zaXRpb24ueCAqIGVudGl0eS5zY2FsZS54KSArIHNjcmVlbkNlbnRlclg7XG4gICAgICBjb25zdCBkZXNpcmVkWSA9IC0odGhpcy50YXJnZXQucG9zaXRpb24ueSAqIGVudGl0eS5zY2FsZS55KSArIHNjcmVlbkNlbnRlclk7XG5cbiAgICAgIC8vIFNldCBkZXNpcmVkIHBvc2l0aW9uIGZvciB0aGUgc2NlbmUgKHVzaW5nIG5lZ2F0aXZlIHZhbHVlcyBmb3IgY2FtZXJhIGNvb3JkaW5hdGVzKVxuICAgICAgZW50aXR5LmRlc2lyZWRQb3NpdGlvbi5zZXQoLWRlc2lyZWRYLCAtZGVzaXJlZFkpO1xuICAgIH1cblxuICAgIC8vIEludGVycG9sYXRlIHBvc2l0aW9uIHZhbHVlc1xuICAgIC8vIFdoZW4gYWN0aXZlbHkgem9vbWluZywgdXBkYXRlIHBvc2l0aW9uIGluc3RhbnRseSB0byBrZWVwIHRhcmdldCBjZW50ZXJlZFxuICAgIC8vIE90aGVyd2lzZSwgaW50ZXJwb2xhdGUgc21vb3RobHkgZm9yIGNhbWVyYSBmb2xsb3dpbmdcbiAgICBpZiAoZW50aXR5LmRlc2lyZWRQb3NpdGlvbiAhPT0gZW50aXR5LnBvc2l0aW9uKSB7XG4gICAgICBpZiAoaXNab29taW5nKSB7XG4gICAgICAgIC8vIEluc3RhbnQgcG9zaXRpb24gdXBkYXRlIGR1cmluZyB6b29tIHRvIHByZXZlbnQgdGFyZ2V0IGRyaWZ0XG4gICAgICAgIGVudGl0eS5wb3NpdGlvbi5jb3B5RnJvbShlbnRpdHkuZGVzaXJlZFBvc2l0aW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFNtb290aCBpbnRlcnBvbGF0aW9uIGZvciBub3JtYWwgY2FtZXJhIGZvbGxvd2luZ1xuICAgICAgICBlbnRpdHkucG9zaXRpb24ueCA9IGxlcnAoZW50aXR5LnBvc2l0aW9uLngsIGVudGl0eS5kZXNpcmVkUG9zaXRpb24ueCwgZGVsdGFTcGVlZCk7XG4gICAgICAgIGVudGl0eS5wb3NpdGlvbi55ID0gbGVycChlbnRpdHkucG9zaXRpb24ueSwgZW50aXR5LmRlc2lyZWRQb3NpdGlvbi55LCBkZWx0YVNwZWVkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gQXBwbHkgY2FtZXJhIHRyYW5zZm9ybWF0aW9ucyB0byB0aGUgc2NlbmVcbiAgICAvLyBJbiBQSVhJLCB0aGUgXCJjYW1lcmFcIiBlZmZlY3QgaXMgY3JlYXRlZCBieSB0cmFuc2Zvcm1pbmcgdGhlIHNjZW5lIGluIHRoZSBvcHBvc2l0ZSBkaXJlY3Rpb25cbiAgICBlbnRpdHkuc2NlbmUuc2NhbGUuc2V0KGVudGl0eS5zY2FsZS54LCBlbnRpdHkuc2NhbGUueSk7XG5cbiAgICAvLyBQb3NpdGlvbiB0aGUgc2NlbmUgYXQgdGhlIG5lZ2F0aXZlIG9mIHRoZSBjYW1lcmEgcG9zaXRpb24gdG8gY3JlYXRlIGNhbWVyYSBtb3ZlbWVudCBlZmZlY3RcbiAgICBlbnRpdHkuc2NlbmUucG9zaXRpb24uc2V0KC1lbnRpdHkucG9zaXRpb24ueCwgLWVudGl0eS5wb3NpdGlvbi55KTtcbiAgfVxufVxuXG4vKipcbiAqIFZpZXdwb3J0IGNhbWVyYSB3aXRoIHNtb290aCBmb2xsb3dpbmcgYW5kIHpvb20uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjb25zdCB7IGNhbWVyYSB9ID0gYXdhaXQgc2V0dXBNb3hpKHsuLi59KTtcbiAqXG4gKiAvLyBGb2xsb3cgYSB0YXJnZXRcbiAqIGNhbWVyYS5tb3hpRW50aXR5LmdldExvZ2ljPENhbWVyYUxvZ2ljPignQ2FtZXJhTG9naWMnKS50YXJnZXQgPSBwbGF5ZXI7XG4gKlxuICogLy8gWm9vbSB0byAyeFxuICogY2FtZXJhLmRlc2lyZWRTY2FsZS5zZXQoMiwgMik7XG4gKlxuICogLy8gUGFuIHRvIHBvc2l0aW9uXG4gKiBjYW1lcmEuZGVzaXJlZFBvc2l0aW9uLnNldCg1MDAsIDMwMCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIENhbWVyYSBleHRlbmRzIFBJWEkuQ29udGFpbmVyIGltcGxlbWVudHMgQXNFbnRpdHk8UElYSS5Db250YWluZXI+IHtcbiAgLyoqIFNjZW5lIGJlaW5nIHZpZXdlZC4gKi9cbiAgcHVibGljIHNjZW5lOiBTY2VuZTtcblxuICAvKiogUmVuZGVyZXIgcmVmZXJlbmNlLiAqL1xuICBwdWJsaWMgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI7XG5cbiAgLyoqIFRyYW5zaXRpb24gc3BlZWQgKDAtMSkuICovXG4gIHB1YmxpYyBzcGVlZDogbnVtYmVyID0gMC4xO1xuXG4gIC8qKiBNb3hpRW50aXR5IGZvciBhdHRhY2hpbmcgbG9naWMuICovXG4gIHB1YmxpYyBtb3hpRW50aXR5OiBNb3hpRW50aXR5PFBJWEkuQ29udGFpbmVyPjtcblxuICAvKiogVGFyZ2V0IHpvb20gbGV2ZWwuIFNldCB0byBhbmltYXRlIHpvb20uICovXG4gIHB1YmxpYyBkZXNpcmVkU2NhbGU6IFBvaW50ID0gbmV3IFBvaW50KDEsIDEpO1xuXG4gIC8qKiBUYXJnZXQgcG9zaXRpb24uIFNldCB0byBhbmltYXRlIHBhbi4gKi9cbiAgcHVibGljIGRlc2lyZWRQb3NpdGlvbjogUG9pbnQgPSBuZXcgUG9pbnQoMCwgMCk7XG5cbiAgY29uc3RydWN0b3Ioc2NlbmU6IFNjZW5lLCByZW5kZXJlcjogUElYSS5SZW5kZXJlciwgbG9naWM6IE1veGlMb2dpYzxQSVhJLkNvbnRhaW5lcj4gPSB7fSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5zY2VuZSA9IHNjZW5lO1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcblxuICAgIC8vIEluaXRpYWxpemUgYW5kIGF0dGFjaCB0aGUgY2FtZXJhIGxvZ2ljXG4gICAgY29uc3QgY2FtZXJhTG9naWMgPSBuZXcgQ2FtZXJhTG9naWMoKTtcbiAgICBjYW1lcmFMb2dpYy5pbml0KHRoaXMsIHJlbmRlcmVyKTtcbiAgICB0aGlzLm1veGlFbnRpdHkgPSBuZXcgTW94aUVudGl0eTxQSVhJLkNvbnRhaW5lcj4odGhpcywgbG9naWMpO1xuICAgIHRoaXMubW94aUVudGl0eS5hZGRMb2dpYyhjYW1lcmFMb2dpYyk7XG4gICAgdGhpcy5zY2VuZS5hZGRDaGlsZCh0aGlzKTtcbiAgfVxufSAgXG5cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgU2NlbmUgfSBmcm9tICcuL3NjZW5lJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi4vbGlicmFyeS9waHlzaWNzJztcblxuLyoqXG4gKiBHYW1lIGxvb3AgbWFuYWdlci4gRHJpdmVzIHNjZW5lIHVwZGF0ZXMgYW5kIHJlbmRlcmluZyB2aWEgUElYSS5UaWNrZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjb25zdCBlbmdpbmUgPSBuZXcgRW5naW5lKHNjZW5lKTtcbiAqIGVuZ2luZS5zdGFydCgpOyAgLy8gQmVnaW4gZ2FtZSBsb29wXG4gKiBlbmdpbmUuc3RvcCgpOyAgIC8vIFBhdXNlIGdhbWUgbG9vcFxuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBFbmdpbmUge1xuICAvKiogUElYSS5UaWNrZXIgZHJpdmluZyB0aGUgZ2FtZSBsb29wLiAqL1xuICB0aWNrZXI6IFBJWEkuVGlja2VyO1xuXG4gIC8qKiBBY3RpdmUgc2NlbmUgYmVpbmcgdXBkYXRlZC9yZW5kZXJlZC4gKi9cbiAgcm9vdDogU2NlbmU7XG5cbiAgLyoqIFBoeXNpY3Mgd29ybGQgKGlmIGVuYWJsZWQgdmlhIHNldHVwTW94aSkuICovXG4gIHBoeXNpY3NXb3JsZD86IFBoeXNpY3NXb3JsZDtcblxuICAvKiogQGludGVybmFsICovXG4gIGxvZ2dlcjogKG1zZzogc3RyaW5nKSA9PiB2b2lkO1xuICAvKiogQGludGVybmFsICovXG4gIGxvZ2dlckZyZXF1ZW5jeU1zOiBudW1iZXI7XG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgbmV4dExvZ1RpbWU6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihzdGFnZTogU2NlbmUgPSBudWxsKSB7XG4gICAgdGhpcy5yb290ID0gc3RhZ2U7XG5cbiAgICBjb25zdCB0aWNrZXIgPSBQSVhJLlRpY2tlci5zaGFyZWQ7XG4gICAgdGlja2VyLmF1dG9TdGFydCA9IGZhbHNlO1xuICAgIHRpY2tlci5hZGQodGhpcy5nYW1lTG9vcCk7XG4gICAgdGhpcy50aWNrZXIgPSB0aWNrZXI7XG5cbiAgICB0aGlzLmxvZ2dlckZyZXF1ZW5jeU1zID0gNTAwO1xuICAgIHRoaXMubmV4dExvZ1RpbWUgPSAwO1xuICAgIHRoaXMubG9nZ2VyID0gKG1zZykgPT4gbnVsbDtcbiAgfVxuXG4gIC8qKiBTdGFydCB0aGUgZ2FtZSBsb29wLiAqL1xuICBzdGFydCgpIHtcbiAgICB0aGlzLnRpY2tlci5zdGFydCgpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqIFN0b3AvcGF1c2UgdGhlIGdhbWUgbG9vcC4gKi9cbiAgc3RvcCgpIHtcbiAgICB0aGlzLnRpY2tlci5zdG9wKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKiogQXR0YWNoIHBoeXNpY3Mgd29ybGQuIENhbGxlZCBhdXRvbWF0aWNhbGx5IGJ5IHNldHVwTW94aSBpZiBwaHlzaWNzIGVuYWJsZWQuICovXG4gIGFkZFBoeXNpY3NXb3JsZChwaHlzaWNzV29ybGQ6IFBoeXNpY3NXb3JsZCkge1xuICAgIHRoaXMucGh5c2ljc1dvcmxkID0gcGh5c2ljc1dvcmxkO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCBNYWluIGxvb3A6IHBoeXNpY3Mgc3RlcCAtPiBzY2VuZSB1cGRhdGUgLT4gcmVuZGVyLiAqL1xuICBnYW1lTG9vcCA9ICh0aWtlclRpbWU6IFBJWEkuVGlja2VyKSA9PiB7XG4gICAgaWYgKHRoaXMucm9vdCkge1xuICAgICAgY29uc3QgeyBkZWx0YVRpbWUsIGRlbHRhTVMgfSA9IHRpa2VyVGltZTtcblxuICAgICAgaWYgKHRoaXMucGh5c2ljc1dvcmxkKSB7XG4gICAgICAgIGNvbnN0IGRlbHRhU2Vjb25kcyA9IGRlbHRhTVMgLyAxMDAwO1xuICAgICAgICB0aGlzLnBoeXNpY3NXb3JsZC5zdGVwKGRlbHRhU2Vjb25kcyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucm9vdC51cGRhdGUoZGVsdGFUaW1lKTtcbiAgICAgIHRoaXMucm9vdC5kcmF3KGRlbHRhVGltZSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKiBTd2l0Y2ggdG8gYSBkaWZmZXJlbnQgc2NlbmUuICovXG4gIGxvYWRTdGFnZShzdGFnZTogU2NlbmUpIHtcbiAgICB0aGlzLnJvb3QgPSBzdGFnZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxufVxuIiwidHlwZSBNb3hpRXZlbnRzPFQgZXh0ZW5kcyBzdHJpbmcgfCBzeW1ib2wgPSBzdHJpbmcsIEEgPSBhbnk+ID0ge1xuICBbZXZlbnQgaW4gVF06ICguLi5hcmdzOiBBIGV4dGVuZHMgYW55W10gPyBBIDogW0FdKSA9PiB2b2lkO1xufTtcblxuLyoqXG4gKiBUeXBlLXNhZmUgZXZlbnQgZW1pdHRlciBmb3IgcHViL3N1YiBjb21tdW5pY2F0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogLy8gRGVmaW5lIGV2ZW50IHR5cGVzXG4gKiB0eXBlIEdhbWVFdmVudHMgPSB7XG4gKiAgICdwbGF5ZXI6aGl0JzogKGRhbWFnZTogbnVtYmVyKSA9PiB2b2lkO1xuICogICAnZ2FtZTpvdmVyJzogKCkgPT4gdm9pZDtcbiAqICAgJ3Njb3JlOmNoYW5nZSc6IChzY29yZTogbnVtYmVyLCBjb21ibzogbnVtYmVyKSA9PiB2b2lkO1xuICogfTtcbiAqXG4gKiBjb25zdCBldmVudHMgPSBuZXcgRXZlbnRFbWl0dGVyPEdhbWVFdmVudHM+KCk7XG4gKlxuICogLy8gU3Vic2NyaWJlXG4gKiBldmVudHMub24oJ3BsYXllcjpoaXQnLCAoZG1nKSA9PiBjb25zb2xlLmxvZyhgSGl0IGZvciAke2RtZ31gKSk7XG4gKiBldmVudHMub25jZSgnZ2FtZTpvdmVyJywgKCkgPT4gc2hvd0dhbWVPdmVyKCkpO1xuICpcbiAqIC8vIEVtaXRcbiAqIGV2ZW50cy5lbWl0KCdwbGF5ZXI6aGl0JywgMTApO1xuICogZXZlbnRzLmVtaXQoJ3Njb3JlOmNoYW5nZScsIDEwMCwgMyk7XG4gKlxuICogLy8gVW5zdWJzY3JpYmVcbiAqIGV2ZW50cy5vZmYoJ3BsYXllcjpoaXQnLCBoYW5kbGVyKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgRXZlbnRFbWl0dGVyPFQgZXh0ZW5kcyBNb3hpRXZlbnRzID0gTW94aUV2ZW50cz4ge1xuICBwcml2YXRlIGxpc3RlbmVyczogeyBbSyBpbiBrZXlvZiBUXT86IFRbS11bXSB9ID0ge307XG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IEV2ZW50RW1pdHRlcjxNb3hpRXZlbnRzPiB8IG51bGwgPSBudWxsO1xuXG4gIC8qKiBTdWJzY3JpYmUgdG8gZXZlbnQuICovXG4gIG9uPEsgZXh0ZW5kcyBrZXlvZiBUPihldmVudDogSywgbGlzdGVuZXI6IFRbS10pOiB2b2lkIHtcbiAgICAodGhpcy5saXN0ZW5lcnNbZXZlbnRdIHx8ICh0aGlzLmxpc3RlbmVyc1tldmVudF0gPSBbXSkpLnB1c2gobGlzdGVuZXIpO1xuICB9XG5cbiAgLyoqIFVuc3Vic2NyaWJlIGZyb20gZXZlbnQuICovXG4gIG9mZjxLIGV4dGVuZHMga2V5b2YgVD4oZXZlbnQ6IEssIGxpc3RlbmVyOiBUW0tdKTogdm9pZCB7XG4gICAgY29uc3QgZXZlbnRMaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVyc1tldmVudF07XG4gICAgaWYgKGV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLmxpc3RlbmVyc1tldmVudF0gPSBldmVudExpc3RlbmVycy5maWx0ZXIobCA9PiBsICE9PSBsaXN0ZW5lcik7XG4gICAgfVxuICB9XG5cbiAgLyoqIEVtaXQgZXZlbnQgdG8gYWxsIGxpc3RlbmVycy4gKi9cbiAgZW1pdDxLIGV4dGVuZHMga2V5b2YgVD4oZXZlbnQ6IEssIC4uLmFyZ3M6IFBhcmFtZXRlcnM8VFtLXT4pOiB2b2lkIHtcbiAgICAodGhpcy5saXN0ZW5lcnNbZXZlbnRdIHx8IFtdKS5mb3JFYWNoKGxpc3RlbmVyID0+IGxpc3RlbmVyKC4uLmFyZ3MpKTtcbiAgfVxuXG4gIC8qKiBTdWJzY3JpYmUgb25jZSwgYXV0by11bnN1YnNjcmliZSBhZnRlciBmaXJzdCBlbWl0LiAqL1xuICBvbmNlPEsgZXh0ZW5kcyBrZXlvZiBUPihldmVudDogSywgbGlzdGVuZXI6IFRbS10pOiB2b2lkIHtcbiAgICBjb25zdCBvbmNlTGlzdGVuZXIgPSAoLi4uYXJnczogUGFyYW1ldGVyczxUW0tdPikgPT4ge1xuICAgICAgbGlzdGVuZXIoLi4uYXJncyk7XG4gICAgICB0aGlzLm9mZihldmVudCwgbGlzdGVuZXIpO1xuICAgIH07XG4gICAgdGhpcy5vbihldmVudCwgb25jZUxpc3RlbmVyIGFzIFRbS10pO1xuICB9XG5cbiAgLyoqIEdldCBzaW5nbGV0b24gaW5zdGFuY2UuICovXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2U8VCBleHRlbmRzIE1veGlFdmVudHMgPSBNb3hpRXZlbnRzPigpOiBFdmVudEVtaXR0ZXI8VD4ge1xuICAgIGlmICghRXZlbnRFbWl0dGVyLmluc3RhbmNlKSB7XG4gICAgICBFdmVudEVtaXR0ZXIuaW5zdGFuY2UgPSBuZXcgRXZlbnRFbWl0dGVyPE1veGlFdmVudHM+KCk7XG4gICAgfVxuICAgIHJldHVybiBFdmVudEVtaXR0ZXIuaW5zdGFuY2UgYXMgRXZlbnRFbWl0dGVyPFQ+O1xuICB9XG59XG5cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuXG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIGVudGl0eSBiZWhhdmlvci4gRXh0ZW5kIHRvIGFkZCBjdXN0b20gbG9naWMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjbGFzcyBNb3ZlUmlnaHQgZXh0ZW5kcyBMb2dpYzxQSVhJLlNwcml0ZT4ge1xuICogICBzcGVlZCA9IDEwMDtcbiAqICAgdXBkYXRlKGVudGl0eSwgZHQpIHsgZW50aXR5LnggKz0gdGhpcy5zcGVlZCAqIGR0OyB9XG4gKiB9XG4gKlxuICogc3ByaXRlLm1veGlFbnRpdHkuYWRkTG9naWMobmV3IE1vdmVSaWdodCgpKTtcbiAqIGBgYFxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgTG9naWM8VD4ge1xuICAvKiogSWRlbnRpZmllciBmb3IgZ2V0TG9naWMoKS4gRGVmYXVsdHMgdG8gY2xhc3MgbmFtZS4gKi9cbiAgbmFtZT86IHN0cmluZztcblxuICAvKiogU2V0IGZhbHNlIHRvIHNraXAgdXBkYXRlKCkgY2FsbHMuICovXG4gIGFjdGl2ZTogYm9vbGVhbiA9IHRydWU7XG5cbiAgLyoqXG4gICAqIENhbGxlZCBvbmNlIHdoZW4gc2NlbmUuaW5pdCgpIGlzIGludm9rZWQuIE92ZXJyaWRlIGZvciBzZXR1cC5cbiAgICogQHBhcmFtIGVudGl0eSAtIFRoZSBQSVhJIG9iamVjdCB0aGlzIGxvZ2ljIGlzIGF0dGFjaGVkIHRvXG4gICAqIEBwYXJhbSByZW5kZXJlciAtIFRoZSBQSVhJIHJlbmRlcmVyXG4gICAqIEBwYXJhbSBhcmdzIC0gQWRkaXRpb25hbCBhcmd1bWVudHMgcGFzc2VkIHRvIHNjZW5lLmluaXQoKVxuICAgKi9cbiAgaW5pdChlbnRpdHk/OiBULCByZW5kZXJlcj86IFBJWEkuUmVuZGVyZXI8SFRNTENhbnZhc0VsZW1lbnQ+LCAuLi5hcmdzOiBhbnlbXSkge31cblxuICAvKipcbiAgICogQ2FsbGVkIGV2ZXJ5IGZyYW1lIHdoaWxlIGFjdGl2ZS4gT3ZlcnJpZGUgZm9yIGJlaGF2aW9yLlxuICAgKiBAcGFyYW0gZW50aXR5IC0gVGhlIFBJWEkgb2JqZWN0IHRoaXMgbG9naWMgaXMgYXR0YWNoZWQgdG9cbiAgICogQHBhcmFtIGRlbHRhVGltZSAtIFRpbWUgc2luY2UgbGFzdCBmcmFtZSBpbiBmcmFtZXMgKDEgPSAxLzYwcyBhdCA2MGZwcylcbiAgICovXG4gIHVwZGF0ZShlbnRpdHk/OiBULCBkZWx0YVRpbWU/OiBudW1iZXIpIHt9XG59XG5cbi8qKlxuICogU2FtZSBhcyBMb2dpYyBidXQgc2VtYW50aWNhbGx5IGluZGljYXRlcyBtdWx0aXBsZSBpbnN0YW5jZXMgZXhwZWN0ZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjbGFzcyBPcmJpdCBleHRlbmRzIEluc3RhbmNlZExvZ2ljPFBJWEkuU3ByaXRlPiB7XG4gKiAgIGNvbnN0cnVjdG9yKHB1YmxpYyByYWRpdXM6IG51bWJlciwgcHVibGljIHNwZWVkOiBudW1iZXIpIHsgc3VwZXIoKTsgfVxuICogICB1cGRhdGUoZW50aXR5LCBkdCkgeyAvKiBvcmJpdCBsb2dpYyAqXFwvIH1cbiAqIH1cbiAqXG4gKiBzcHJpdGUxLm1veGlFbnRpdHkuYWRkTG9naWMobmV3IE9yYml0KDUwLCAxKSk7XG4gKiBzcHJpdGUyLm1veGlFbnRpdHkuYWRkTG9naWMobmV3IE9yYml0KDEwMCwgMC41KSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIEluc3RhbmNlZExvZ2ljPFQ+IGV4dGVuZHMgTG9naWM8VD4ge31cblxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4vbG9naWMnO1xuXG4vKiogQGludGVybmFsICovXG5pbnRlcmZhY2UgTW94aUVudGl0eUNsYXNzPFQ+IHtcbiAgbG9naWM6IE1veGlMb2dpYzxUPjtcbiAgdXBkYXRlOiAoZGVsdGE6IG51bWJlciwgZW50aXR5OiBUKSA9PiB2b2lkO1xuICBpbml0OiAoLi4uYXJnczogYW55W10pID0+IHZvaWQ7XG4gIGFkZExvZ2ljOiAobG9naWM6IExvZ2ljPFQ+KSA9PiB2b2lkO1xuICBnZXRMb2dpYzogKG5hbWU6IHN0cmluZykgPT4gTG9naWM8VD4gfCB1bmRlZmluZWQ7XG59XG5cbi8qKiBQSVhJLkNvbnRhaW5lciB3aXRoIGF0dGFjaGVkIE1veGlFbnRpdHkgZm9yIGxvZ2ljIG1hbmFnZW1lbnQuICovXG5leHBvcnQgdHlwZSBBc0VudGl0eTxUPiA9IFBJWEkuQ29udGFpbmVyICYge1xuICBtb3hpRW50aXR5OiBNb3hpRW50aXR5PFQ+O1xufTtcblxuLyoqIE1hcCBvZiBsb2dpYyBjb21wb25lbnRzIGJ5IG5hbWUuICovXG5leHBvcnQgdHlwZSBNb3hpTG9naWM8VD4gPSBSZWNvcmQ8c3RyaW5nLCBMb2dpYzxUPj47XG5cbi8qKlxuICogTWFuYWdlcyBsb2dpYyBjb21wb25lbnRzIGF0dGFjaGVkIHRvIGEgUElYSSBvYmplY3QuXG4gKiBVc3VhbGx5IGFjY2Vzc2VkIHZpYSBgZW50aXR5Lm1veGlFbnRpdHlgIGFmdGVyIGNhbGxpbmcgYGFzRW50aXR5KClgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3Qgc3ByaXRlID0gYXNFbnRpdHkobmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpKTtcbiAqIHNwcml0ZS5tb3hpRW50aXR5LmFkZExvZ2ljKG5ldyBNeUxvZ2ljKCkpO1xuICogc3ByaXRlLm1veGlFbnRpdHkuZ2V0TG9naWM8TXlMb2dpYz4oJ015TG9naWMnKS5zcGVlZCA9IDEwO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBNb3hpRW50aXR5PFQ+IGltcGxlbWVudHMgTW94aUVudGl0eUNsYXNzPFQ+IHtcbiAgLyoqIEF0dGFjaGVkIGxvZ2ljIGNvbXBvbmVudHMga2V5ZWQgYnkgbmFtZS4gKi9cbiAgbG9naWM6IE1veGlMb2dpYzxUPiA9IHt9O1xuXG4gIC8qKiBUaGUgUElYSSBvYmplY3QgdGhpcyBlbnRpdHkgd3JhcHMuICovXG4gIGVudGl0eTogVDtcblxuICAvKipcbiAgICogQHBhcmFtIGVudGl0eSAtIFRoZSBQSVhJIG9iamVjdCB0byB3cmFwXG4gICAqIEBwYXJhbSBsb2dpYyAtIE9wdGlvbmFsIGluaXRpYWwgbG9naWMgY29tcG9uZW50c1xuICAgKi9cbiAgY29uc3RydWN0b3IoZW50aXR5OiBULCBsb2dpYzogTW94aUxvZ2ljPFQ+ID0ge30pIHtcbiAgICB0aGlzLmxvZ2ljID0gbG9naWM7XG4gICAgdGhpcy5lbnRpdHkgPSBlbnRpdHk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbHMgdXBkYXRlKCkgb24gYWxsIGFjdGl2ZSBsb2dpYyBjb21wb25lbnRzLlxuICAgKiBDYWxsZWQgYXV0b21hdGljYWxseSBieSBTY2VuZSBlYWNoIGZyYW1lLlxuICAgKiBAcGFyYW0gZGVsdGFUaW1lIC0gVGltZSBzaW5jZSBsYXN0IGZyYW1lIGluIGZyYW1lcyAoMSA9IDEvNjBzIGF0IDYwZnBzKVxuICAgKi9cbiAgdXBkYXRlKGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgaWYgKCF0aGlzLmVudGl0eSkgcmV0dXJuO1xuXG4gICAgZm9yIChjb25zdCBjbGFzc05hbWUgaW4gdGhpcy5sb2dpYykge1xuICAgICAgY29uc3QgbG9naWNDb21wb25lbnQgPSB0aGlzLmxvZ2ljW2NsYXNzTmFtZV07XG4gICAgICBpZiAobG9naWNDb21wb25lbnQgJiYgbG9naWNDb21wb25lbnQuYWN0aXZlICYmIGxvZ2ljQ29tcG9uZW50LnVwZGF0ZSkge1xuICAgICAgICBsb2dpY0NvbXBvbmVudC51cGRhdGUodGhpcy5lbnRpdHksIGRlbHRhVGltZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGxzIGluaXQoKSBvbiBhbGwgbG9naWMgY29tcG9uZW50cy5cbiAgICogQ2FsbGVkIGF1dG9tYXRpY2FsbHkgd2hlbiBzY2VuZS5pbml0KCkgaXMgaW52b2tlZC5cbiAgICogQHBhcmFtIHJlbmRlcmVyIC0gVGhlIFBJWEkgcmVuZGVyZXJcbiAgICogQHBhcmFtIGFyZ3MgLSBBZGRpdGlvbmFsIGFyZ3VtZW50cyBwYXNzZWQgdGhyb3VnaCB0byBsb2dpYy5pbml0KClcbiAgICovXG4gIGluaXQocmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI8SFRNTENhbnZhc0VsZW1lbnQ+LCAuLi5hcmdzOiBhbnlbXSkge1xuICAgIGlmICghdGhpcy5lbnRpdHkpIHJldHVybjtcblxuICAgIGZvciAoY29uc3QgY2xhc3NOYW1lIGluIHRoaXMubG9naWMpIHtcbiAgICAgIGNvbnN0IGxvZ2ljQ29tcG9uZW50ID0gdGhpcy5sb2dpY1tjbGFzc05hbWVdO1xuICAgICAgaWYgKGxvZ2ljQ29tcG9uZW50ICYmIGxvZ2ljQ29tcG9uZW50LmluaXQpIHtcbiAgICAgICAgbG9naWNDb21wb25lbnQuaW5pdCh0aGlzLmVudGl0eSwgcmVuZGVyZXIsIC4uLmFyZ3MpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBdHRhY2ggYSBsb2dpYyBjb21wb25lbnQgdG8gdGhpcyBlbnRpdHkuXG4gICAqIEBwYXJhbSBsb2dpYyAtIFRoZSBsb2dpYyBjb21wb25lbnQgdG8gYXR0YWNoLiBVc2VzIGxvZ2ljLm5hbWUgb3IgY2xhc3MgbmFtZSBhcyBrZXkuXG4gICAqL1xuICBhZGRMb2dpYyhsb2dpYzogTG9naWM8VD4pIHtcbiAgICBjb25zdCBsb2dpY05hbWUgPSBsb2dpYy5uYW1lIHx8IGxvZ2ljLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgdGhpcy5sb2dpY1tsb2dpY05hbWVdID0gbG9naWM7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgbG9naWMgY29tcG9uZW50IGJ5IG5hbWUuXG4gICAqIEBwYXJhbSBuYW1lIC0gVGhlIG5hbWUgb2YgdGhlIGxvZ2ljIGNvbXBvbmVudCAoY2xhc3MgbmFtZSBvciBjdXN0b20gbmFtZSlcbiAgICogQHJldHVybnMgVGhlIGxvZ2ljIGNvbXBvbmVudCwgb3IgdW5kZWZpbmVkIGlmIG5vdCBmb3VuZFxuICAgKi9cbiAgZ2V0TG9naWM8TCBleHRlbmRzIExvZ2ljPFQ+PihuYW1lOiBzdHJpbmcpOiBMIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5sb2dpY1tuYW1lXSBhcyBMIHwgdW5kZWZpbmVkO1xuICB9XG59XG5cbi8qKlxuICogQ29udmVydCBhIFBJWEkuQ29udGFpbmVyIHRvIGFuIGVudGl0eSB3aXRoIGxvZ2ljIHN1cHBvcnQuXG4gKiBUaGlzIGlzIHRoZSBtYWluIHdheSB0byBhZGQgTW94aSBmdW5jdGlvbmFsaXR5IHRvIFBJWEkgb2JqZWN0cy5cbiAqXG4gKiBAcGFyYW0gZW50aXR5IC0gQW55IFBJWEkuQ29udGFpbmVyIChTcHJpdGUsIEdyYXBoaWNzLCBDb250YWluZXIsIGV0Yy4pXG4gKiBAcGFyYW0gbG9naWMgLSBPcHRpb25hbCBpbml0aWFsIGxvZ2ljIGNvbXBvbmVudHMgdG8gYXR0YWNoXG4gKiBAcmV0dXJucyBUaGUgc2FtZSBlbnRpdHkgd2l0aCBtb3hpRW50aXR5IHByb3BlcnR5IGF0dGFjaGVkXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjb25zdCBwbGF5ZXIgPSBhc0VudGl0eShuZXcgUElYSS5TcHJpdGUodGV4dHVyZSkpO1xuICogcGxheWVyLm1veGlFbnRpdHkuYWRkTG9naWMobmV3IFBsYXllckNvbnRyb2xsZXIoKSk7XG4gKiBzY2VuZS5hZGRDaGlsZChwbGF5ZXIpO1xuICpcbiAqIC8vIFdpdGggaW5pdGlhbCBsb2dpY1xuICogY29uc3QgZW5lbXkgPSBhc0VudGl0eShuZXcgUElYSS5TcHJpdGUodGV4dHVyZSksIHtcbiAqICAgJ0VuZW15QUknOiBuZXcgRW5lbXlBSSgpXG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNFbnRpdHk8VCBleHRlbmRzIFBJWEkuQ29udGFpbmVyPihlbnRpdHk6IFQsIGxvZ2ljOiBNb3hpTG9naWM8VD4gPSB7fSk6IEFzRW50aXR5PFQ+IHtcbiAgY29uc3QgdGFyZ2V0ID0gZW50aXR5O1xuICBcbiAgLy8gcGl4aSBwYXRjaDogaXQncyB0aHJvd2luZyBhbiBlcnJvciBvbiBpbnRlcmFjdGl2ZSBldmVudHMgaWYgaXNJbnRlcmFjdGl2ZSgpIGRvZXNuJ3QgZXhpc3QuXG4gIHRhcmdldC5pc0ludGVyYWN0aXZlID0gKCkgPT4gZmFsc2U7IFxuXG4gICh0YXJnZXQgYXMgdW5rbm93biBhcyBBc0VudGl0eTxUPikubW94aUVudGl0eSA9IG5ldyBNb3hpRW50aXR5PFQ+KHRhcmdldCwgbG9naWMpO1xuICByZXR1cm4gZW50aXR5IGFzIHVua25vd24gYXMgQXNFbnRpdHk8VD47XG59XG5cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuXG5leHBvcnQgY2xhc3MgUmVuZGVyTWFuYWdlciB7XG4gIHN0YXRpYyBnZXRSZW5kZXJlcjogKFxuICAgIG9wdGlvbnM6IFBhcnRpYWw8UElYSS5BdXRvRGV0ZWN0T3B0aW9ucz5cbiAgKSA9PiBQcm9taXNlPFBJWEkuUmVuZGVyZXI+O1xuXG4gIHN0YXRpYyBjcmVhdGU6IChcbiAgICAgIGh0bWxSb290OiBIVE1MRWxlbWVudCwgXG4gICAgICBvcHRpb25zOiBQYXJ0aWFsPFBJWEkuQXV0b0RldGVjdE9wdGlvbnM+KSA9PiBQcm9taXNlPFJlbmRlck1hbmFnZXI+O1xuXG4gIGh0bWxSb290OiBIVE1MRWxlbWVudDtcbiAgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI7XG4gIGZpdFRvV2luZG93ID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoaHRtbFJvb3Q6IEhUTUxFbGVtZW50LCByZW5kZXJlcjogUElYSS5SZW5kZXJlcikge1xuICAgIHRoaXMuaHRtbFJvb3QgPSBodG1sUm9vdDtcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG5cbiAgICBodG1sUm9vdC5hcHBlbmRDaGlsZCh0aGlzLnJlbmRlcmVyLmNhbnZhcyk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHRoaXMub25SZXNpemUoKSk7XG4gICAgdGhpcy5vblJlc2l6ZSgpO1xuICB9XG5cbiAgcmVuZGVyKHN0YWdlOiBQSVhJLkNvbnRhaW5lcikge1xuICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHN0YWdlKTtcbiAgfVxuXG4gIG9uUmVzaXplID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVuZGVyZXIsIGh0bWxSb290OiByb290IH0gPSB0aGlzO1xuICAgIGNvbnN0IGNhbnZhcyA9IHJlbmRlcmVyLmNhbnZhcztcbiAgICBcbiAgICAvLyBHZXQgdGhlIHBhcmVudCBkaW1lbnNpb25zXG4gICAgY29uc3QgcGFyZW50V2lkdGggPSByb290LmNsaWVudFdpZHRoO1xuICAgIGNvbnN0IHBhcmVudEhlaWdodCA9IHJvb3QuY2xpZW50SGVpZ2h0O1xuICAgIFxuICAgIC8vIEdldCB0aGUgY2FudmFzJ3MgaW50ZW5kZWQgZGltZW5zaW9uc1xuICAgIGNvbnN0IGNhbnZhc1dpZHRoID0gcmVuZGVyZXIud2lkdGg7XG4gICAgY29uc3QgY2FudmFzSGVpZ2h0ID0gcmVuZGVyZXIuaGVpZ2h0O1xuICAgIFxuICAgIC8vIENhbGN1bGF0ZSB0aGUgc2NhbGUgdG8gZml0IHdoaWxlIG1haW50YWluaW5nIGFzcGVjdCByYXRpb1xuICAgIGNvbnN0IHNjYWxlID0gTWF0aC5taW4oXG4gICAgICBwYXJlbnRXaWR0aCAvIGNhbnZhc1dpZHRoLFxuICAgICAgcGFyZW50SGVpZ2h0IC8gY2FudmFzSGVpZ2h0XG4gICAgKTtcbiAgICBcbiAgICAvLyBTZXQgQ1NTIGRpbWVuc2lvbnMgdG8gc2NhbGUgdGhlIGNhbnZhc1xuICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9IGAke01hdGguZmxvb3IoY2FudmFzV2lkdGggKiBzY2FsZSl9cHhgO1xuICAgIGNhbnZhcy5zdHlsZS5oZWlnaHQgPSBgJHtNYXRoLmZsb29yKGNhbnZhc0hlaWdodCAqIHNjYWxlKX1weGA7XG4gIH07XG59XG5cblJlbmRlck1hbmFnZXIuZ2V0UmVuZGVyZXIgPSBhc3luYyAob3B0aW9uczogUGFydGlhbDxQSVhJLkF1dG9EZXRlY3RPcHRpb25zPikgPT4gKFxuICBhd2FpdCBQSVhJLmF1dG9EZXRlY3RSZW5kZXJlcihvcHRpb25zKVxuKTtcblxuUmVuZGVyTWFuYWdlci5jcmVhdGUgPSBhc3luYyAoaHRtbFJvb3Q6IEhUTUxFbGVtZW50LCBvcHRpb25zOiBQYXJ0aWFsPFBJWEkuQXV0b0RldGVjdE9wdGlvbnM+KSA9PiAoXG4gIG5ldyBSZW5kZXJNYW5hZ2VyKGh0bWxSb290LCBhd2FpdCBSZW5kZXJNYW5hZ2VyLmdldFJlbmRlcmVyKG9wdGlvbnMpKVxuKTtcbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgQXNFbnRpdHkgfSBmcm9tICcuL21veGktZW50aXR5JztcblxuZnVuY3Rpb24gaXNNb3hpRW50aXR5PFQgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lcj4oZW50aXR5OiB1bmtub3duKTogZW50aXR5IGlzIEFzRW50aXR5PFQ+IHtcbiAgcmV0dXJuIGVudGl0eSAhPSBudWxsICYmIHR5cGVvZiBlbnRpdHkgPT09ICdvYmplY3QnICYmICdtb3hpRW50aXR5JyBpbiBlbnRpdHk7XG59XG5cbi8qKlxuICogUm9vdCBjb250YWluZXIgZm9yIGdhbWUgb2JqZWN0cy4gRXh0ZW5kcyBQSVhJLkNvbnRhaW5lci5cbiAqIEF1dG9tYXRpY2FsbHkgY2FsbHMgaW5pdC91cGRhdGUgb24gY2hpbGQgZW50aXRpZXMgY3JlYXRlZCB3aXRoIGFzRW50aXR5KCkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjb25zdCBzY2VuZSA9IG5ldyBTY2VuZShyZW5kZXJlcik7XG4gKiBzY2VuZS5hZGRDaGlsZChhc0VudGl0eShzcHJpdGUpKTtcbiAqIHNjZW5lLmluaXQoKTsgIC8vIENhbGxzIGluaXQoKSBvbiBhbGwgZW50aXR5IGxvZ2ljXG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFNjZW5lIGV4dGVuZHMgUElYSS5Db250YWluZXIge1xuICByZW5kZXJlcjogUElYSS5SZW5kZXJlcjxIVE1MQ2FudmFzRWxlbWVudD47XG5cbiAgY29uc3RydWN0b3IocmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI8SFRNTENhbnZhc0VsZW1lbnQ+KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gIH1cblxuICAvKiogSW5pdGlhbGl6ZSBhbGwgZW50aXR5IGxvZ2ljLiBDYWxsIG9uY2UgYWZ0ZXIgYWRkaW5nIGVudGl0aWVzLiAqL1xuICBpbml0KCkge1xuICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgIGlmIChpc01veGlFbnRpdHkoY2hpbGQpKSB7XG4gICAgICAgIGNoaWxkLm1veGlFbnRpdHkuaW5pdCh0aGlzLnJlbmRlcmVyKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBVcGRhdGUgYWxsIGVudGl0eSBsb2dpYy4gQ2FsbGVkIGF1dG9tYXRpY2FsbHkgYnkgRW5naW5lIGVhY2ggZnJhbWUuICovXG4gIHVwZGF0ZShkZWx0YVRpbWU6IG51bWJlcikge1xuICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgIGlmIChpc01veGlFbnRpdHkoY2hpbGQpKSB7XG4gICAgICAgIGNoaWxkLm1veGlFbnRpdHkudXBkYXRlKGRlbHRhVGltZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKiogUmVuZGVyIHRoZSBzY2VuZS4gQ2FsbGVkIGF1dG9tYXRpY2FsbHkgYnkgRW5naW5lIGVhY2ggZnJhbWUuICovXG4gIGRyYXcoZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcih0aGlzKTtcbiAgfVxufSIsImltcG9ydCAqIGFzIHV0aWxzIGZyb20gJy4vbGlicmFyeS91dGlscyc7XG5pbXBvcnQgeyBSZW5kZXJNYW5hZ2VyIH0gZnJvbSAnLi9jb3JlL3JlbmRlci1tYW5hZ2VyJztcbmltcG9ydCB7IFNjZW5lIH0gZnJvbSAnLi9jb3JlL3NjZW5lJztcbmltcG9ydCB7IEVuZ2luZSB9IGZyb20gJy4vY29yZS9lbmdpbmUnO1xuaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnLi9jb3JlL2V2ZW50LXN5c3RlbSc7XG5pbXBvcnQgeyBDbGllbnRFdmVudHMgfSBmcm9tICcuL2xpYnJhcnkvY2xpZW50LWV2ZW50cyc7XG5pbXBvcnQgeyBBc3NldExvYWRlciB9IGZyb20gJy4vY29yZS9hc3NldC1sb2FkZXInO1xuaW1wb3J0IHsgUG9pbnQgfSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IExvZ2ljIH0gZnJvbSAnLi9jb3JlL2xvZ2ljJztcbmltcG9ydCB7IGRlZmF1bHRSZW5kZXJPcHRpb25zLCBzZXR1cE1veGkgfSBmcm9tICcuL2xpYnJhcnkvc2V0dXAnO1xuaW1wb3J0IHsgbG9hZEZvbnRzIH0gZnJvbSAnLi9saWJyYXJ5L2ZvbnQtbG9hZGVyJztcbmltcG9ydCB7IGFzRW50aXR5LCBNb3hpRW50aXR5IH0gZnJvbSAnLi9jb3JlL21veGktZW50aXR5JztcbmltcG9ydCB7IENhbWVyYSwgQ2FtZXJhTG9naWMgfSBmcm9tICcuL2NvcmUvY2FtZXJhJztcbmltcG9ydCB7IGFzVGV4dHVyZUZyYW1lcyB9IGZyb20gJy4vbGlicmFyeS90ZXh0dXJlLWZyYW1lcyc7XG5pbXBvcnQgeyBhc0JpdG1hcFRleHQsIGFzU3ByaXRlLCBhc1RleHQsIGFzR3JhcGhpY3MsIGFzQ29udGFpbmVyLCBQaXhpUHJvcHMgfSBmcm9tICcuL2xpYnJhcnkvYXMtcGl4aSc7XG5pbXBvcnQgeyBUZXh0dXJlRnJhbWVTZXF1ZW5jZXMsIFNlcXVlbmNlSW5mbyB9IGZyb20gJy4vbGlicmFyeS90ZXh0dXJlLWZyYW1lLXNlcXVlbmNlcyc7XG5pbXBvcnQgeyBjcmVhdGVSZXNpemVIYW5kbGVyLCBzZXR1cFJlc3BvbnNpdmVDYW52YXMsIFJlc2l6ZUhhbmRsZXJPcHRpb25zIH0gZnJvbSAnLi9saWJyYXJ5L3Jlc2l6ZS1oYW5kbGVyJztcbmltcG9ydCB7IEVkZ2VJbnNldHMgfSBmcm9tICcuL3VpL2NvcmUvZWRnZS1pbnNldHMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuL3VpL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IFVJRm9jdXNNYW5hZ2VyIH0gZnJvbSAnLi91aS9jb3JlL3VpLWZvY3VzLW1hbmFnZXInO1xuaW1wb3J0IHsgRmxleENvbnRhaW5lciwgRmxleERpcmVjdGlvbiwgRmxleEp1c3RpZnksIEZsZXhBbGlnbiB9IGZyb20gJy4vdWkvbGF5b3V0L2ZsZXgtY29udGFpbmVyJztcbmltcG9ydCB7IFVJQm94IH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWJveCc7XG5pbXBvcnQgeyBVSUxhYmVsIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWxhYmVsJztcbmltcG9ydCB7IFVJUGFuZWwgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktcGFuZWwnO1xuaW1wb3J0IHsgVUlCdXR0b24sIEJ1dHRvblN0YXRlIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWJ1dHRvbic7XG5pbXBvcnQgeyBVSVNlbGVjdCwgU2VsZWN0T3B0aW9uIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXNlbGVjdCc7XG5pbXBvcnQgeyBVSVRleHRJbnB1dCB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS10ZXh0LWlucHV0JztcbmltcG9ydCB7IFVJVGV4dEFyZWEgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktdGV4dGFyZWEnO1xuaW1wb3J0IHsgVUlTY3JvbGxDb250YWluZXIgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktc2Nyb2xsLWNvbnRhaW5lcic7XG5pbXBvcnQgeyBVSVRhYnMsIFRhYkl0ZW0gfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktdGFicyc7XG5pbXBvcnQgeyBVSUxheWVyIH0gZnJvbSAnLi91aS9VSUxheWVyJztcbmltcG9ydCB7IFVJU2NhbGVNb2RlIH0gZnJvbSAnLi91aS9VSVNjYWxlTW9kZSc7XG5pbXBvcnQgeyBTdGF0ZU1hY2hpbmUgfSBmcm9tICcuL2xpYnJhcnkvc3RhdGUtbWFjaGluZSc7XG5pbXBvcnQgeyBTdGF0ZUxvZ2ljIH0gZnJvbSAnLi9saWJyYXJ5L3N0YXRlLWxvZ2ljJztcbmltcG9ydCB7IGNyZWF0ZVRpbGVHcmlkLCBnZXRUZXh0dXJlUmFuZ2UgfSBmcm9tICcuL2xpYnJhcnkvZ3JpZC1nZW5lcmF0b3InO1xuaW1wb3J0IHsgc3ZnVG9UZXh0dXJlIH0gZnJvbSAnLi9saWJyYXJ5L3N2Zy11dGlscy9zdmctdG8tdGV4dHVyZSc7XG5pbXBvcnQgeyBQaXhlbEdyaWQsIHB4LCB1bml0cywgR1JJRCwgQk9SREVSLCBjcmVhdGVCb3JkZXJDb25maWcgfSBmcm9tICcuL3VpL3BpeGVsLWdyaWQnO1xuaW1wb3J0IHsgUGFyYWxsYXhCYWNrZ3JvdW5kLCBQYXJhbGxheEJhY2tncm91bmRMb2dpYyB9IGZyb20gJy4vbGlicmFyeS9wYXJhbGxheC1iYWNrZ3JvdW5kJztcbmltcG9ydCB7IFBhcmFsbGF4TGF5ZXIsIFRpbGluZ1BhcmFsbGF4TGF5ZXIgfSBmcm9tICcuL2xpYnJhcnkvcGFyYWxsYXgtbGF5ZXInO1xuaW1wb3J0IHsgTG9hZGluZ1NjZW5lLCBGYWxsaW5nU3F1YXJlc0FuaW1hdGlvbiB9IGZyb20gJy4vbGlicmFyeS9sb2FkaW5nLXNjZW5lJztcbmltcG9ydCB7XG4gIFBoeXNpY3NXb3JsZCxcbiAgUGh5c2ljc0JvZHlMb2dpYyxcbiAgUGh5c2ljc0RlYnVnUmVuZGVyZXIsXG4gIENvbGxpc2lvblJlZ2lzdHJ5LFxuICBDb2xsaXNpb25NYW5hZ2VyLFxuICBhc1BoeXNpY3NFbnRpdHksXG4gIGhhc1BoeXNpY3MsXG4gIGdldFBoeXNpY3NCb2R5LFxuICBjcmVhdGVTaGFwZUZyb21TcHJpdGUsXG4gIFBoeXNpY3NNYXRlcmlhbHMsXG4gIGFwcGx5TWF0ZXJpYWxcbn0gZnJvbSAnLi9saWJyYXJ5L3BoeXNpY3MnO1xuXG5leHBvcnQgdHlwZSB7IFN0YXRlQ2hhbmdlRXZlbnQgfSBmcm9tICcuL2xpYnJhcnkvc3RhdGUtbWFjaGluZSc7XG5leHBvcnQgdHlwZSB7IEFzRW50aXR5LCBNb3hpTG9naWMgfSBmcm9tICcuL2NvcmUvbW94aS1lbnRpdHknO1xuZXhwb3J0IHR5cGUgeyBBc1RleHR1cmVGcmFtZXNPcHRpb25zIH0gZnJvbSAnLi9saWJyYXJ5L3RleHR1cmUtZnJhbWVzJztcbmV4cG9ydCB0eXBlIHsgR3JpZE9wdGlvbnMsIENlbGxQb3NpdGlvbiB9IGZyb20gJy4vbGlicmFyeS9ncmlkLWdlbmVyYXRvcic7XG5leHBvcnQgdHlwZSB7IFBhcmFsbGF4QmFja2dyb3VuZE9wdGlvbnMgfSBmcm9tICcuL2xpYnJhcnkvcGFyYWxsYXgtYmFja2dyb3VuZCc7XG5leHBvcnQgdHlwZSB7IFBhcmFsbGF4TGF5ZXJPcHRpb25zLCBUaWxpbmdQYXJhbGxheExheWVyT3B0aW9ucyB9IGZyb20gJy4vbGlicmFyeS9wYXJhbGxheC1sYXllcic7XG5leHBvcnQgdHlwZSB7IExvYWRpbmdTY2VuZU9wdGlvbnMsIExvYWRpbmdBbmltYXRpb24sIExvYWRpbmdBbmltYXRpb25Db250ZXh0LCBGYWxsaW5nU3F1YXJlc09wdGlvbnMgfSBmcm9tICcuL2xpYnJhcnkvbG9hZGluZy1zY2VuZSc7XG5leHBvcnQgdHlwZSB7XG4gIEJvZHlUeXBlLFxuICBTeW5jTW9kZSxcbiAgU2hhcGVUeXBlLFxuICBDb2xsaXNpb25UYWcsXG4gIFNoYXBlQ29uZmlnLFxuICBQaHlzaWNzV29ybGRPcHRpb25zLFxuICBQaHlzaWNzQm9keU9wdGlvbnMsXG4gIFBoeXNpY3NEZWJ1Z09wdGlvbnMsXG4gIENvbGxpc2lvbkV2ZW50LFxuICBSYXljYXN0Q2FsbGJhY2tcbn0gZnJvbSAnLi9saWJyYXJ5L3BoeXNpY3MnO1xuZXhwb3J0IHR5cGUgeyBCb3hNb2RlbCwgQ29tcHV0ZWRMYXlvdXQsIE1lYXN1cmVkU2l6ZSwgU2l6ZUNvbnN0cmFpbnQgfSBmcm9tICcuL3VpL2NvcmUvYm94LW1vZGVsJztcbmV4cG9ydCB0eXBlIHsgRmxleENvbnRhaW5lclByb3BzIH0gZnJvbSAnLi91aS9sYXlvdXQvZmxleC1jb250YWluZXInO1xuZXhwb3J0IHR5cGUgeyBVSUJveFByb3BzIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWJveCc7XG5leHBvcnQgdHlwZSB7IFVJTGFiZWxQcm9wcywgVGV4dEFsaWduIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWxhYmVsJztcbmV4cG9ydCB0eXBlIHsgVUlQYW5lbFByb3BzLCBOaW5lU2xpY2VDb25maWcgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktcGFuZWwnO1xuZXhwb3J0IHR5cGUgeyBVSUJ1dHRvblByb3BzLCBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWJ1dHRvbic7XG5leHBvcnQgdHlwZSB7IFVJU2VsZWN0UHJvcHMsIFNlbGVjdE9wdGlvbiB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1zZWxlY3QnO1xuZXhwb3J0IHR5cGUgeyBVSVRleHRJbnB1dFByb3BzIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXRleHQtaW5wdXQnO1xuZXhwb3J0IHR5cGUgeyBVSVRhYnNQcm9wcywgVGFiSXRlbSB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS10YWJzJztcbmV4cG9ydCB0eXBlIHsgVUlMYXllck9wdGlvbnMgfSBmcm9tICcuL3VpL1VJTGF5ZXInO1xuZXhwb3J0IHR5cGUgeyBQaXhlbEdyaWRDb25maWcsIEJvcmRlckNvbmZpZyB9IGZyb20gJy4vdWkvcGl4ZWwtZ3JpZCc7XG5leHBvcnQgdHlwZSB7IFNWR1RvVGV4dHVyZU9wdGlvbnMgfSBmcm9tICcuL2xpYnJhcnkvc3ZnLXV0aWxzL3N2Zy10by10ZXh0dXJlJztcblxuZXhwb3J0IHR5cGUgQXNzZXQgPSB7IHNyYzogc3RyaW5nLCBhbGlhcz86IHN0cmluZyB9O1xuXG5leHBvcnQgaW50ZXJmYWNlIE9uRXZlbnQge1xuICBldmVudDogRXZlbnQ7XG4gIGV2ZW50VHlwZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENsaWVudEV2ZW50c0FyZ3Mge1xuICBpbml0V2hlZWxPZmZzZXQ/OiBQb2ludDtcbiAgb25BbnlFdmVudD86IChldjogT25FdmVudCkgPT4gdm9pZDtcbn1cblxuZXhwb3J0IHR5cGUgQ2xpZW50RXZlbnRzVHlwZSA9IHtcbiAga2V5RG93bkV2ZW50PzogS2V5Ym9hcmRFdmVudDtcbiAga2V5VXBFdmVudD86IEtleWJvYXJkRXZlbnQ7XG4gIGtleWRvd24/OiBSZWNvcmQ8c3RyaW5nLCBLZXlib2FyZEV2ZW50PjtcbiAgbW91c2VEb3duRXZlbnQ/OiBNb3VzZUV2ZW50O1xuICBtb3VzZVVwRXZlbnQ/OiBNb3VzZUV2ZW50O1xuICBsYXN0TW91c2VEb3duPzogTW91c2VFdmVudDtcbiAgbGFzdE1vdXNlVXA/OiBNb3VzZUV2ZW50O1xuICB3aGVlbEV2ZW50PzogV2hlZWxFdmVudDtcbiAgd2hlZWxEZWx0YT86IHsgeVZhbHVlOiAwIHwgbnVtYmVyLCB4VmFsdWU6IDAgfCBudW1iZXIsIHhMYXN0OiBudW1iZXIsIHlMYXN0OiBudW1iZXIgfVxufVxuXG4vLyBSZS1leHBvcnQgdHlwZXNcbmV4cG9ydCB7IFxuICBTZXF1ZW5jZUluZm8sIFxuICBSZXNpemVIYW5kbGVyT3B0aW9uc1xufTtcblxuY29uc3QgZXhwb3J0ZWRPYmplY3RzID0ge1xuICBBc3NldExvYWRlcixcbiAgYXNFbnRpdHksXG4gIGFzVGV4dHVyZUZyYW1lcyxcbiAgYXNCaXRtYXBUZXh0LFxuICBhc1Nwcml0ZSxcbiAgYXNUZXh0LFxuICBhc0dyYXBoaWNzLFxuICBhc0NvbnRhaW5lcixcbiAgTG9naWMsXG4gIENhbWVyYSxcbiAgQ2FtZXJhTG9naWMsXG4gIENsaWVudEV2ZW50cyxcbiAgY3JlYXRlUmVzaXplSGFuZGxlcixcbiAgY3JlYXRlVGlsZUdyaWQsXG4gIGRlZmF1bHRSZW5kZXJPcHRpb25zLFxuICBFbmdpbmUsXG4gIEV2ZW50RW1pdHRlcixcbiAgZ2V0VGV4dHVyZVJhbmdlLFxuICBsb2FkRm9udHMsXG4gIE1veGlFbnRpdHksXG4gIFBhcmFsbGF4QmFja2dyb3VuZCxcbiAgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMsXG4gIFBhcmFsbGF4TGF5ZXIsXG4gIExvYWRpbmdTY2VuZSxcbiAgRmFsbGluZ1NxdWFyZXNBbmltYXRpb24sXG4gIHNldHVwTW94aSxcbiAgUmVuZGVyTWFuYWdlcixcbiAgU2NlbmUsXG4gIHNldHVwUmVzcG9uc2l2ZUNhbnZhcyxcbiAgVGV4dHVyZUZyYW1lU2VxdWVuY2VzLFxuICBUaWxpbmdQYXJhbGxheExheWVyLFxuICB1dGlscyxcbiAgU3RhdGVNYWNoaW5lLFxuICBTdGF0ZUxvZ2ljLFxuICBQaHlzaWNzV29ybGQsXG4gIFBoeXNpY3NCb2R5TG9naWMsXG4gIFBoeXNpY3NEZWJ1Z1JlbmRlcmVyLFxuICBDb2xsaXNpb25SZWdpc3RyeSxcbiAgQ29sbGlzaW9uTWFuYWdlcixcbiAgYXNQaHlzaWNzRW50aXR5LFxuICBoYXNQaHlzaWNzLFxuICBnZXRQaHlzaWNzQm9keSxcbiAgY3JlYXRlU2hhcGVGcm9tU3ByaXRlLFxuICBQaHlzaWNzTWF0ZXJpYWxzLFxuICBhcHBseU1hdGVyaWFsLFxuICBFZGdlSW5zZXRzLFxuICBVSUNvbXBvbmVudCxcbiAgVUlGb2N1c01hbmFnZXIsXG4gIEZsZXhDb250YWluZXIsXG4gIEZsZXhEaXJlY3Rpb24sXG4gIEZsZXhKdXN0aWZ5LFxuICBGbGV4QWxpZ24sXG4gIFVJQm94LFxuICBVSUxhYmVsLFxuICBVSVBhbmVsLFxuICBVSUJ1dHRvbixcbiAgQnV0dG9uU3RhdGUsXG4gIFVJU2VsZWN0LFxuICBVSVRleHRJbnB1dCxcbiAgVUlUZXh0QXJlYSxcbiAgVUlTY3JvbGxDb250YWluZXIsXG4gIFVJVGFicyxcbiAgVUlMYXllcixcbiAgVUlTY2FsZU1vZGUsXG4gIHN2Z1RvVGV4dHVyZSxcbiAgUGl4ZWxHcmlkLFxuICBweCxcbiAgdW5pdHMsXG4gIEdSSUQsXG4gIEJPUkRFUixcbiAgY3JlYXRlQm9yZGVyQ29uZmlnXG59O1xuXG5leHBvcnQgZGVmYXVsdCBleHBvcnRlZE9iamVjdHM7XG5cbmV4cG9ydCB7XG4gIEFzc2V0TG9hZGVyLFxuICBhc0VudGl0eSxcbiAgYXNUZXh0dXJlRnJhbWVzLFxuICBhc0JpdG1hcFRleHQsXG4gIGFzU3ByaXRlLFxuICBhc1RleHQsXG4gIGFzR3JhcGhpY3MsXG4gIGFzQ29udGFpbmVyLFxuICBQaXhpUHJvcHMsXG4gIExvZ2ljLFxuICBDYW1lcmEsXG4gIENhbWVyYUxvZ2ljLFxuICBDbGllbnRFdmVudHMsXG4gIGNyZWF0ZVJlc2l6ZUhhbmRsZXIsXG4gIGNyZWF0ZVRpbGVHcmlkLFxuICBkZWZhdWx0UmVuZGVyT3B0aW9ucyxcbiAgRW5naW5lLFxuICBFdmVudEVtaXR0ZXIsXG4gIGdldFRleHR1cmVSYW5nZSxcbiAgbG9hZEZvbnRzLFxuICBNb3hpRW50aXR5LFxuICBQYXJhbGxheEJhY2tncm91bmQsXG4gIFBhcmFsbGF4QmFja2dyb3VuZExvZ2ljLFxuICBQYXJhbGxheExheWVyLFxuICBMb2FkaW5nU2NlbmUsXG4gIEZhbGxpbmdTcXVhcmVzQW5pbWF0aW9uLFxuICBzZXR1cE1veGksXG4gIFJlbmRlck1hbmFnZXIsXG4gIFNjZW5lLFxuICBzZXR1cFJlc3BvbnNpdmVDYW52YXMsXG4gIFRleHR1cmVGcmFtZVNlcXVlbmNlcyxcbiAgVGlsaW5nUGFyYWxsYXhMYXllcixcbiAgdXRpbHMsXG4gIFN0YXRlTWFjaGluZSxcbiAgU3RhdGVMb2dpYyxcbiAgUGh5c2ljc1dvcmxkLFxuICBQaHlzaWNzQm9keUxvZ2ljLFxuICBQaHlzaWNzRGVidWdSZW5kZXJlcixcbiAgQ29sbGlzaW9uUmVnaXN0cnksXG4gIENvbGxpc2lvbk1hbmFnZXIsXG4gIGFzUGh5c2ljc0VudGl0eSxcbiAgaGFzUGh5c2ljcyxcbiAgZ2V0UGh5c2ljc0JvZHksXG4gIGNyZWF0ZVNoYXBlRnJvbVNwcml0ZSxcbiAgUGh5c2ljc01hdGVyaWFscyxcbiAgYXBwbHlNYXRlcmlhbCxcbiAgRWRnZUluc2V0cyxcbiAgVUlDb21wb25lbnQsXG4gIFVJRm9jdXNNYW5hZ2VyLFxuICBGbGV4Q29udGFpbmVyLFxuICBGbGV4RGlyZWN0aW9uLFxuICBGbGV4SnVzdGlmeSxcbiAgRmxleEFsaWduLFxuICBVSUJveCxcbiAgVUlMYWJlbCxcbiAgVUlQYW5lbCxcbiAgVUlCdXR0b24sXG4gIEJ1dHRvblN0YXRlLFxuICBVSVNlbGVjdCxcbiAgVUlUZXh0SW5wdXQsXG4gIFVJVGV4dEFyZWEsXG4gIFVJU2Nyb2xsQ29udGFpbmVyLFxuICBVSVRhYnMsXG4gIFVJTGF5ZXIsXG4gIFVJU2NhbGVNb2RlLFxuICBzdmdUb1RleHR1cmUsXG4gIFBpeGVsR3JpZCxcbiAgcHgsXG4gIHVuaXRzLFxuICBHUklELFxuICBCT1JERVIsXG4gIGNyZWF0ZUJvcmRlckNvbmZpZ1xufTtcblxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbi8qKlxuICogT3B0aW9ucyBmb3IgY3JlYXRpbmcgYSBCaXRtYXBUZXh0IGluc3RhbmNlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQml0bWFwVGV4dE9wdGlvbnMge1xuICB0ZXh0Pzogc3RyaW5nIHwgbnVtYmVyIHwgeyB0b1N0cmluZzogKCkgPT4gc3RyaW5nIH07XG4gIHN0eWxlPzoge1xuICAgIGZvbnRGYW1pbHk/OiBzdHJpbmc7XG4gICAgZm9udFNpemU/OiBudW1iZXI7XG4gICAgZm9udFN0eWxlPzogc3RyaW5nO1xuICAgIGZpbGw/OiBudW1iZXIgfCBzdHJpbmc7XG4gICAgW2tleTogc3RyaW5nXTogYW55O1xuICB9O1xuICBwaXhlbFBlcmZlY3Q/OiBib29sZWFuOyAvLyBFbmFibGUgcGl4ZWwtcGVyZmVjdCByZW5kZXJpbmcgKHJvdW5kUGl4ZWxzKVxuICBba2V5OiBzdHJpbmddOiBhbnk7XG59XG5cbi8qKlxuICogT3B0aW9ucyBmb3IgY3JlYXRpbmcgYSBTcHJpdGUgaW5zdGFuY2VcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTcHJpdGVPcHRpb25zIHtcbiAgdGV4dHVyZT86IFBJWEkuVGV4dHVyZSB8IFBJWEkuVGV4dHVyZVNvdXJjZTtcbiAgW2tleTogc3RyaW5nXTogYW55O1xufVxuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGNyZWF0aW5nIGEgVGV4dCBpbnN0YW5jZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFRleHRPcHRpb25zIHtcbiAgdGV4dD86IHN0cmluZyB8IG51bWJlciB8IHsgdG9TdHJpbmc6ICgpID0+IHN0cmluZyB9O1xuICBzdHlsZT86IHtcbiAgICBmb250RmFtaWx5Pzogc3RyaW5nO1xuICAgIGZvbnRTaXplPzogbnVtYmVyO1xuICAgIGZvbnRTdHlsZT86IHN0cmluZztcbiAgICBmaWxsPzogbnVtYmVyIHwgc3RyaW5nO1xuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbiAgfTtcbiAgW2tleTogc3RyaW5nXTogYW55O1xufVxuXG4vKipcbiAqIENvbW1vbiBwcm9wZXJ0aWVzIHRoYXQgY2FuIGJlIGFwcGxpZWQgdG8gUElYSSBkaXNwbGF5IG9iamVjdHNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQaXhpUHJvcHMge1xuICB4PzogbnVtYmVyO1xuICB5PzogbnVtYmVyO1xuICBhbmNob3I/OiB7IHg/OiBudW1iZXI7IHk/OiBudW1iZXIgfSB8IG51bWJlcjtcbiAgc2NhbGU/OiB7IHg/OiBudW1iZXI7IHk/OiBudW1iZXIgfSB8IG51bWJlcjtcbiAgcm90YXRpb24/OiBudW1iZXI7XG4gIHRpbnQ/OiBudW1iZXI7XG4gIGFscGhhPzogbnVtYmVyO1xuICB2aXNpYmxlPzogYm9vbGVhbjtcbiAgZXZlbnRNb2RlPzogJ25vbmUnIHwgJ3Bhc3NpdmUnIHwgJ2F1dG8nIHwgJ3N0YXRpYycgfCAnZHluYW1pYyc7XG4gIHBpdm90PzogeyB4PzogbnVtYmVyOyB5PzogbnVtYmVyIH0gfCBudW1iZXI7XG59XG5cbi8qKlxuICogQXBwbGllcyBjb21tb24gcHJvcGVydGllcyB0byBhIFBJWEkgZGlzcGxheSBvYmplY3RcbiAqL1xuZnVuY3Rpb24gYXBwbHlQcm9wczxUIGV4dGVuZHMgUElYSS5Db250YWluZXI+KG9iajogVCwgcHJvcHM/OiBQaXhpUHJvcHMpOiBUIHtcbiAgaWYgKCFwcm9wcykgcmV0dXJuIG9iajtcblxuICBpZiAocHJvcHMueCAhPT0gdW5kZWZpbmVkKSBvYmoueCA9IHByb3BzLng7XG4gIGlmIChwcm9wcy55ICE9PSB1bmRlZmluZWQpIG9iai55ID0gcHJvcHMueTtcbiAgXG4gIGlmIChwcm9wcy5hbmNob3IgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmICh0eXBlb2YgcHJvcHMuYW5jaG9yID09PSAnbnVtYmVyJykge1xuICAgICAgaWYgKCdhbmNob3InIGluIG9iaiAmJiB0eXBlb2Ygb2JqLmFuY2hvciA9PT0gJ29iamVjdCcgJiYgb2JqLmFuY2hvciAhPT0gbnVsbCkge1xuICAgICAgICAob2JqLmFuY2hvciBhcyBQSVhJLk9ic2VydmFibGVQb2ludCkuc2V0KHByb3BzLmFuY2hvcik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICgnYW5jaG9yJyBpbiBvYmogJiYgdHlwZW9mIG9iai5hbmNob3IgPT09ICdvYmplY3QnICYmIG9iai5hbmNob3IgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgYW5jaG9yID0gb2JqLmFuY2hvciBhcyBQSVhJLk9ic2VydmFibGVQb2ludDtcbiAgICAgICAgaWYgKHByb3BzLmFuY2hvci54ICE9PSB1bmRlZmluZWQpIGFuY2hvci54ID0gcHJvcHMuYW5jaG9yLng7XG4gICAgICAgIGlmIChwcm9wcy5hbmNob3IueSAhPT0gdW5kZWZpbmVkKSBhbmNob3IueSA9IHByb3BzLmFuY2hvci55O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChwcm9wcy5zY2FsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiBwcm9wcy5zY2FsZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIGlmICgnc2NhbGUnIGluIG9iaiAmJiB0eXBlb2Ygb2JqLnNjYWxlID09PSAnb2JqZWN0JyAmJiBvYmouc2NhbGUgIT09IG51bGwpIHtcbiAgICAgICAgKG9iai5zY2FsZSBhcyBQSVhJLk9ic2VydmFibGVQb2ludCkuc2V0KHByb3BzLnNjYWxlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCdzY2FsZScgaW4gb2JqICYmIHR5cGVvZiBvYmouc2NhbGUgPT09ICdvYmplY3QnICYmIG9iai5zY2FsZSAhPT0gbnVsbCkge1xuICAgICAgICBjb25zdCBzY2FsZSA9IG9iai5zY2FsZSBhcyBQSVhJLk9ic2VydmFibGVQb2ludDtcbiAgICAgICAgaWYgKHByb3BzLnNjYWxlLnggIT09IHVuZGVmaW5lZCkgc2NhbGUueCA9IHByb3BzLnNjYWxlLng7XG4gICAgICAgIGlmIChwcm9wcy5zY2FsZS55ICE9PSB1bmRlZmluZWQpIHNjYWxlLnkgPSBwcm9wcy5zY2FsZS55O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChwcm9wcy5yb3RhdGlvbiAhPT0gdW5kZWZpbmVkKSBvYmoucm90YXRpb24gPSBwcm9wcy5yb3RhdGlvbjtcbiAgaWYgKHByb3BzLnRpbnQgIT09IHVuZGVmaW5lZCAmJiAndGludCcgaW4gb2JqKSAob2JqIGFzIGFueSkudGludCA9IHByb3BzLnRpbnQ7XG4gIGlmIChwcm9wcy5hbHBoYSAhPT0gdW5kZWZpbmVkKSBvYmouYWxwaGEgPSBwcm9wcy5hbHBoYTtcbiAgaWYgKHByb3BzLnZpc2libGUgIT09IHVuZGVmaW5lZCkgb2JqLnZpc2libGUgPSBwcm9wcy52aXNpYmxlO1xuICBpZiAocHJvcHMuZXZlbnRNb2RlICE9PSB1bmRlZmluZWQgJiYgJ2V2ZW50TW9kZScgaW4gb2JqKSBvYmouZXZlbnRNb2RlID0gcHJvcHMuZXZlbnRNb2RlO1xuXG4gIGlmIChwcm9wcy5waXZvdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiBwcm9wcy5waXZvdCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGlmICgncGl2b3QnIGluIG9iaiAmJiB0eXBlb2Ygb2JqLnBpdm90ID09PSAnb2JqZWN0JyAmJiBvYmoucGl2b3QgIT09IG51bGwpIHtcbiAgICAgICAgKG9iai5waXZvdCBhcyBQSVhJLk9ic2VydmFibGVQb2ludCkuc2V0KHByb3BzLnBpdm90KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCdwaXZvdCcgaW4gb2JqICYmIHR5cGVvZiBvYmoucGl2b3QgPT09ICdvYmplY3QnICYmIG9iai5waXZvdCAhPT0gbnVsbCkge1xuICAgICAgICBjb25zdCBwaXZvdCA9IG9iai5waXZvdCBhcyBQSVhJLk9ic2VydmFibGVQb2ludDtcbiAgICAgICAgaWYgKHByb3BzLnBpdm90LnggIT09IHVuZGVmaW5lZCkgcGl2b3QueCA9IHByb3BzLnBpdm90Lng7XG4gICAgICAgIGlmIChwcm9wcy5waXZvdC55ICE9PSB1bmRlZmluZWQpIHBpdm90LnkgPSBwcm9wcy5waXZvdC55O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvYmo7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIEJpdG1hcFRleHQgaW5zdGFuY2Ugd2l0aCBjb25zdHJ1Y3RvciBhcmdzIGFuZCBvcHRpb25hbCBwcm9wZXJ0aWVzXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGxhYmVsID0gYXNCaXRtYXBUZXh0KFxuICogICB7IHRleHQ6ICdIZWxsbycsIHN0eWxlOiB7IGZvbnRGYW1pbHk6ICdBcmlhbCcsIGZvbnRTaXplOiAyNCB9LCBwaXhlbFBlcmZlY3Q6IHRydWUgfSxcbiAqICAgeyB4OiAxMDAsIHk6IDUwLCBhbmNob3I6IDAuNSB9XG4gKiApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc0JpdG1hcFRleHQoXG4gIGNvbnN0cnVjdG9yQXJnczogQml0bWFwVGV4dE9wdGlvbnMsXG4gIHByb3BzPzogUGl4aVByb3BzXG4pOiBQSVhJLkJpdG1hcFRleHQge1xuICBjb25zdCB7IHBpeGVsUGVyZmVjdCwgLi4udGV4dEFyZ3MgfSA9IGNvbnN0cnVjdG9yQXJncztcbiAgY29uc3QgdGV4dCA9IG5ldyBQSVhJLkJpdG1hcFRleHQodGV4dEFyZ3MgYXMgYW55KTtcblxuICAvLyBBcHBseSBwaXhlbC1wZXJmZWN0IHJlbmRlcmluZyBpZiByZXF1ZXN0ZWRcbiAgaWYgKHBpeGVsUGVyZmVjdCkge1xuICAgIHRleHQucm91bmRQaXhlbHMgPSB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGFwcGx5UHJvcHModGV4dCwgcHJvcHMpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBTcHJpdGUgaW5zdGFuY2Ugd2l0aCBjb25zdHJ1Y3RvciBhcmdzIGFuZCBvcHRpb25hbCBwcm9wZXJ0aWVzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBzcHJpdGUgPSBhc1Nwcml0ZShcbiAqICAgeyB0ZXh0dXJlIH0sXG4gKiAgIHsgeDogMTAwLCB5OiAxMDAsIGFuY2hvcjogMC41IH1cbiAqICk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzU3ByaXRlKFxuICBjb25zdHJ1Y3RvckFyZ3M6IFNwcml0ZU9wdGlvbnMsXG4gIHByb3BzPzogUGl4aVByb3BzXG4pOiBQSVhJLlNwcml0ZSB7XG4gIGNvbnN0IHNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZShjb25zdHJ1Y3RvckFyZ3MgYXMgYW55KTtcbiAgcmV0dXJuIGFwcGx5UHJvcHMoc3ByaXRlLCBwcm9wcyk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIFRleHQgaW5zdGFuY2Ugd2l0aCBjb25zdHJ1Y3RvciBhcmdzIGFuZCBvcHRpb25hbCBwcm9wZXJ0aWVzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCB0ZXh0ID0gYXNUZXh0KFxuICogICB7IHRleHQ6ICdIZWxsbycsIHN0eWxlOiB7IGZvbnRGYW1pbHk6ICdBcmlhbCcsIGZvbnRTaXplOiAyNCB9IH0sXG4gKiAgIHsgeDogMTAwLCB5OiA1MCB9XG4gKiApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc1RleHQoXG4gIGNvbnN0cnVjdG9yQXJnczogVGV4dE9wdGlvbnMsXG4gIHByb3BzPzogUGl4aVByb3BzXG4pOiBQSVhJLlRleHQge1xuICBjb25zdCB0ZXh0ID0gbmV3IFBJWEkuVGV4dChjb25zdHJ1Y3RvckFyZ3MgYXMgYW55KTtcbiAgcmV0dXJuIGFwcGx5UHJvcHModGV4dCwgcHJvcHMpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBHcmFwaGljcyBpbnN0YW5jZSB3aXRoIG9wdGlvbmFsIHByb3BlcnRpZXNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGdyYXBoaWNzID0gYXNHcmFwaGljcyh7IHg6IDEwMCwgeTogMTAwIH0pO1xuICogZ3JhcGhpY3MucmVjdCgwLCAwLCA1MCwgNTApLmZpbGwoMHhmZjAwMDApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc0dyYXBoaWNzKHByb3BzPzogUGl4aVByb3BzKTogUElYSS5HcmFwaGljcyB7XG4gIGNvbnN0IGdyYXBoaWNzID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgcmV0dXJuIGFwcGx5UHJvcHMoZ3JhcGhpY3MsIHByb3BzKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgQ29udGFpbmVyIGluc3RhbmNlIHdpdGggb3B0aW9uYWwgcHJvcGVydGllc1xuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgY29udGFpbmVyID0gYXNDb250YWluZXIoeyB4OiAxMDAsIHk6IDEwMCB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNDb250YWluZXIocHJvcHM/OiBQaXhpUHJvcHMpOiBQSVhJLkNvbnRhaW5lciB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICByZXR1cm4gYXBwbHlQcm9wcyhjb250YWluZXIsIHByb3BzKTtcbn1cblxuIiwiaW1wb3J0IHsgUG9pbnQgfSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IE9uRXZlbnQsIENsaWVudEV2ZW50c0FyZ3MgfSBmcm9tICcuLic7XG5cbi8qKlxuICogU2luZ2xldG9uIGlucHV0IG1hbmFnZXIgZm9yIGtleWJvYXJkLCBtb3VzZSwgYW5kIHdoZWVsIGV2ZW50cy5cbiAqIFRyYWNrcyBjdXJyZW50IGlucHV0IHN0YXRlIGZvciBwb2xsaW5nLWJhc2VkIGlucHV0IGhhbmRsaW5nLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3QgaW5wdXQgPSBDbGllbnRFdmVudHMuZ2V0SW5zdGFuY2UoKTtcbiAqXG4gKiAvLyBJbiB1cGRhdGUgbG9vcCAtIGNoZWNrIGtleSBzdGF0ZVxuICogaWYgKGlucHV0LmlzS2V5RG93bignQXJyb3dSaWdodCcpKSBwbGF5ZXIubW92ZVJpZ2h0KCk7XG4gKiBpZiAoaW5wdXQuaXNLZXlEb3duKCdTcGFjZScpKSBwbGF5ZXIuanVtcCgpO1xuICpcbiAqIC8vIE1vdXNlIHBvc2l0aW9uIGFuZCBtb3ZlbWVudFxuICogY29uc3QgbW91c2VQb3MgPSBpbnB1dC5tb3ZlUG9zaXRpb247XG4gKiBjb25zdCBkZWx0YSA9IGlucHV0Lm1vdmVEZWx0YTtcbiAqXG4gKiAvLyBXaGVlbCBzY3JvbGxpbmdcbiAqIGNvbnN0IHNjcm9sbCA9IGlucHV0LndoZWVsT2Zmc2V0cztcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgQ2xpZW50RXZlbnRzIHtcbiAgLyoqIEN1cnJlbnQgd2hlZWwgc2Nyb2xsIGRlbHRhLiAqL1xuICB3aGVlbERlbHRhOiB7IHlWYWx1ZTogbnVtYmVyOyB4VmFsdWU6IG51bWJlcjsgfTtcbiAgLyoqIE1vc3QgcmVjZW50IG1vdXNldXAgZXZlbnQuICovXG4gIG1vdXNlVXBFdmVudDogTW91c2VFdmVudDtcbiAgLyoqIE1vc3QgcmVjZW50IG1vdXNlZG93biBldmVudC4gKi9cbiAgbW91c2VEb3duRXZlbnQ6IE1vdXNlRXZlbnQ7XG4gIC8qKiBMYXN0IG1vdXNlZG93biBldmVudC4gKi9cbiAgbGFzdE1vdXNlRG93bjogTW91c2VFdmVudDtcbiAgLyoqIExhc3QgbW91c2V1cCBldmVudC4gKi9cbiAgbGFzdE1vdXNlVXA6IE1vdXNlRXZlbnQ7XG4gIC8qKiBNb3N0IHJlY2VudCBrZXlkb3duIGV2ZW50LiAqL1xuICBrZXlEb3duRXZlbnQ6IEtleWJvYXJkRXZlbnQ7XG4gIC8qKiBNb3N0IHJlY2VudCBrZXl1cCBldmVudC4gKi9cbiAga2V5VXBFdmVudDogS2V5Ym9hcmRFdmVudDtcbiAgLyoqIEBpbnRlcm5hbCBDdXJyZW50bHkgcHJlc3NlZCBrZXlzLiAqL1xuICBrZXlkb3duOiBSZWNvcmQ8c3RyaW5nLCBLZXlib2FyZEV2ZW50PjtcbiAgLyoqIEFjY3VtdWxhdGVkIHdoZWVsIG9mZnNldHMuICovXG4gIHdoZWVsT2Zmc2V0czogUG9pbnQ7XG4gIC8qKiBDdXJyZW50IG1vdXNlIHBvc2l0aW9uLiAqL1xuICBtb3ZlUG9zaXRpb246IFBvaW50O1xuICAvKiogUHJldmlvdXMgbW91c2UgcG9zaXRpb24uICovXG4gIGxhc3RNb3ZlUG9zaXRpb246IFBvaW50O1xuICAvKiogTW91c2UgbW92ZW1lbnQgZGVsdGEuICovXG4gIG1vdmVEZWx0YTogUG9pbnQ7XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogQ2xpZW50RXZlbnRzIHwgbnVsbCA9IG51bGw7XG5cbiAgLyoqIEdldCBzaW5nbGV0b24gaW5zdGFuY2UuICovXG4gIHN0YXRpYyBnZXRJbnN0YW5jZShvcHRpb25zOiBDbGllbnRFdmVudHNBcmdzID0ge30pOiBDbGllbnRFdmVudHMge1xuICAgIGlmICghQ2xpZW50RXZlbnRzLmluc3RhbmNlKSB7XG4gICAgICBDbGllbnRFdmVudHMuaW5zdGFuY2UgPSBuZXcgQ2xpZW50RXZlbnRzKG9wdGlvbnMpO1xuICAgIH1cbiAgICByZXR1cm4gQ2xpZW50RXZlbnRzLmluc3RhbmNlO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCBVc2UgZ2V0SW5zdGFuY2UoKSBpbnN0ZWFkLiAqL1xuICBjb25zdHJ1Y3Rvcih7IGluaXRXaGVlbE9mZnNldCA9IG5ldyBQb2ludCgpLCBvbkFueUV2ZW50ID0gKGV2OiBPbkV2ZW50KSA9PiB7fSB9OiBDbGllbnRFdmVudHNBcmdzID0ge30pIHtcbiAgICAvLyBSZXR1cm4gZXhpc3RpbmcgaW5zdGFuY2UgaWYgb25lIGV4aXN0cyAoc2luZ2xldG9uIHBhdHRlcm4pXG4gICAgaWYgKENsaWVudEV2ZW50cy5pbnN0YW5jZSkge1xuICAgICAgcmV0dXJuIENsaWVudEV2ZW50cy5pbnN0YW5jZTtcbiAgICB9XG4gICAgdGhpcy53aGVlbE9mZnNldHMgPSBpbml0V2hlZWxPZmZzZXQ7XG4gICAgdGhpcy5rZXlkb3duID0ge30gYXMgUmVjb3JkPHN0cmluZywgS2V5Ym9hcmRFdmVudD47XG4gICAgdGhpcy5tb3ZlUG9zaXRpb24gPSBuZXcgUG9pbnQoKTtcblxuICAgIGNvbnN0IGFueUV2ZW50ID0gKGV2OiBPbkV2ZW50KSA9PiB7XG4gICAgICBvbkFueUV2ZW50KGV2KTtcbiAgICB9O1xuXG4gICAgLy8gUmVnaXN0ZXIgd2hlZWwgZXZlbnQgbGlzdGVuZXJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIChldmVudCkgPT4ge1xuICAgICAgY29uc3Qgd2hlZWxEZWx0YSA9IHRoaXMud2hlZWxPZmZzZXRzIHx8IG5ldyBQb2ludCgpO1xuICAgICAgY29uc3QgeFZhbHVlID0gd2hlZWxEZWx0YS54ICsgZXZlbnQuZGVsdGFYO1xuICAgICAgY29uc3QgeVZhbHVlID0gd2hlZWxEZWx0YS55ICsgZXZlbnQuZGVsdGFZO1xuICAgICAgdGhpcy53aGVlbE9mZnNldHMgPSBuZXcgUG9pbnQoeFZhbHVlLCB5VmFsdWUpO1xuICAgICAgYW55RXZlbnQoeyBldmVudFR5cGU6ICd3aGVlbCcsIGV2ZW50IH0pO1xuICAgIH0pO1xuXG4gICAgLy8gUmVnaXN0ZXIgbW91c2UgbW92ZSBldmVudCBsaXN0ZW5lclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5sYXN0TW92ZVBvc2l0aW9uID0gdGhpcy5tb3ZlUG9zaXRpb247XG4gICAgICB0aGlzLm1vdmVQb3NpdGlvbiA9IG5ldyBQb2ludChldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZKTtcbiAgICAgIHRoaXMubW92ZURlbHRhID0gbmV3IFBvaW50KFxuICAgICAgICB0aGlzLm1vdmVQb3NpdGlvbi54IC0gdGhpcy5sYXN0TW92ZVBvc2l0aW9uLngsXG4gICAgICAgIHRoaXMubW92ZVBvc2l0aW9uLnkgLSB0aGlzLmxhc3RNb3ZlUG9zaXRpb24ueVxuICAgICAgKTtcbiAgICAgIGFueUV2ZW50KHsgZXZlbnRUeXBlOiAnbW91c2Vtb3ZlJywgZXZlbnQgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZWdpc3RlciBtb3VzZSBkb3duIGV2ZW50IGxpc3RlbmVyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLm1vdXNlRG93bkV2ZW50ID0gZXZlbnQ7XG4gICAgICB0aGlzLmxhc3RNb3VzZURvd24gPSBldmVudDtcbiAgICAgIHRoaXMubW91c2VVcEV2ZW50ID0gbnVsbDtcbiAgICAgIGFueUV2ZW50KHsgZXZlbnRUeXBlOiAnbW91c2Vkb3duJywgZXZlbnQgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZWdpc3RlciBtb3VzZSB1cCBldmVudCBsaXN0ZW5lclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMubW91c2VVcEV2ZW50ID0gZXZlbnQ7XG4gICAgICB0aGlzLmxhc3RNb3VzZVVwID0gZXZlbnQ7XG4gICAgICB0aGlzLm1vdXNlRG93bkV2ZW50ID0gbnVsbDtcbiAgICAgIGFueUV2ZW50KHsgZXZlbnRUeXBlOiAnbW91c2V1cCcsIGV2ZW50IH0pO1xuICAgIH0pO1xuXG4gICAgLy8gUmVnaXN0ZXIga2V5IGRvd24gZXZlbnQgbGlzdGVuZXJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB7IGtleSB9ID0gZXZlbnQ7XG4gICAgICB0aGlzLmtleURvd25FdmVudCA9IGV2ZW50O1xuICAgICAgdGhpcy5rZXlVcEV2ZW50ID0gbnVsbDtcbiAgICAgIHRoaXMua2V5ZG93bltrZXldID0gZXZlbnQ7XG4gICAgICBhbnlFdmVudCh7IGV2ZW50VHlwZTogJ2tleWRvd24nLCBldmVudCB9KTtcbiAgICB9KTtcblxuICAgIC8vIFJlZ2lzdGVyIGtleSB1cCBldmVudCBsaXN0ZW5lclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB7IGtleSB9ID0gZXZlbnQ7XG4gICAgICB0aGlzLmtleVVwRXZlbnQgPSBldmVudDtcbiAgICAgIHRoaXMua2V5RG93bkV2ZW50ID0gbnVsbDtcbiAgICAgIGRlbGV0ZSB0aGlzLmtleWRvd25ba2V5XTtcbiAgICAgIGFueUV2ZW50KHsgZXZlbnRUeXBlOiAna2V5dXAnLCBldmVudCB9KTtcbiAgICB9KTtcblxuICAgIENsaWVudEV2ZW50cy5pbnN0YW5jZSA9IHRoaXM7XG4gIH1cblxuICAvKiogVHJ1ZSBpZiBrZXkgaXMgY3VycmVudGx5IHByZXNzZWQuICovXG4gIGlzS2V5RG93bihrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBCb29sZWFuKHRoaXMua2V5ZG93bltrZXldKTtcbiAgfVxuXG4gIC8qKiBUcnVlIGlmIGtleSBpcyBub3QgcHJlc3NlZC4gKi9cbiAgaXNLZXlVcChrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhdGhpcy5rZXlkb3duW2tleV07XG4gIH1cbn1cblxuXG5cbiIsImltcG9ydCB7IENvbnRhaW5lciwgR3JhcGhpY3MsIFRleHQgfSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB0eXBlIHsgTG9hZGluZ0FuaW1hdGlvbiwgTG9hZGluZ0FuaW1hdGlvbkNvbnRleHQgfSBmcm9tICcuL2xvYWRpbmctc2NlbmUnO1xuXG4vKipcbiAqIE9wdGlvbnMgZm9yIHRoZSBkZWZhdWx0IGZhbGxpbmcgc3F1YXJlcyBhbmltYXRpb24uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRmFsbGluZ1NxdWFyZXNPcHRpb25zIHtcbiAgLyoqIFNpemUgb2Ygc3F1YXJlcyBpbiBwaXhlbHMgKGRlZmF1bHQ6IDIwKSAqL1xuICBzcXVhcmVTaXplPzogbnVtYmVyO1xuICAvKiogTWF4aW11bSBudW1iZXIgb2YgcGFydGljbGVzIChkZWZhdWx0OiAzMCkgKi9cbiAgbWF4UGFydGljbGVzPzogbnVtYmVyO1xuICAvKiogQ29sb3IgcGFsZXR0ZSAtIGFycmF5IG9mIGhleCBjb2xvcnMgKGRlZmF1bHQ6IHBhc3RlbCBwaXhlbCBhcnQgcGFsZXR0ZSkgKi9cbiAgcGFsZXR0ZT86IG51bWJlcltdO1xuICAvKiogU3Bhd24gcmF0ZSAtIGxvd2VyIGlzIGZhc3RlciAoZGVmYXVsdDogMC41KSAqL1xuICBzcGF3bkludGVydmFsPzogbnVtYmVyO1xufVxuXG4vKiogRGVmYXVsdCBwYXN0ZWwgcGl4ZWwgYXJ0IGNvbG9yIHBhbGV0dGUgKi9cbmNvbnN0IERFRkFVTFRfUEFMRVRURSA9IFsweGYwZGFiMSwgMHhlMzlhYWMsIDB4YzQ1ZDlmLCAweDYzNGI3ZCwgMHg2NDYxYzIsIDB4MmJhOWI0LCAweDkzZDRiNSwgMHhmMGY2ZThdO1xuXG5pbnRlcmZhY2UgUGFydGljbGUge1xuICBzcHJpdGU6IEdyYXBoaWNzO1xuICBzcGF3blRpbWU6IG51bWJlcjtcbiAgZHVyYXRpb246IG51bWJlcjtcbiAgc3BpblJhdGU6IG51bWJlcjtcbiAgc3RhcnRYOiBudW1iZXI7XG4gIHN0YXJ0WTogbnVtYmVyO1xuICBlbmRZOiBudW1iZXI7XG59XG5cbi8qKlxuICogRGVmYXVsdCBsb2FkaW5nIGFuaW1hdGlvbiAtIGNvbG9yZnVsIHNxdWFyZXMgZmFsbGluZyBhYm92ZSB0aGUgbG9hZGluZyB0ZXh0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogLy8gVXNlIHdpdGggY3VzdG9tIG9wdGlvbnNcbiAqIGNvbnN0IGFuaW1hdGlvbiA9IG5ldyBGYWxsaW5nU3F1YXJlc0FuaW1hdGlvbih7XG4gKiAgIHNxdWFyZVNpemU6IDE2LFxuICogICBtYXhQYXJ0aWNsZXM6IDUwLFxuICogICBwYWxldHRlOiBbMHhmZjAwMDAsIDB4MDBmZjAwLCAweDAwMDBmZl1cbiAqIH0pO1xuICpcbiAqIGNvbnN0IHsgbG9hZGluZ1NjZW5lIH0gPSBhd2FpdCBzZXR1cE1veGkoe1xuICogICBzaG93TG9hZGluZ1NjZW5lOiB0cnVlLFxuICogICBsb2FkaW5nU2NlbmVPcHRpb25zOiB7IGFuaW1hdGlvbiB9XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgRmFsbGluZ1NxdWFyZXNBbmltYXRpb24gaW1wbGVtZW50cyBMb2FkaW5nQW5pbWF0aW9uIHtcbiAgcHJpdmF0ZSBwYXJ0aWNsZXM6IFBhcnRpY2xlW10gPSBbXTtcbiAgcHJpdmF0ZSBjb250YWluZXI6IENvbnRhaW5lciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIG5leHRTcGF3bjogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSB0aW1lOiBudW1iZXIgPSAwO1xuXG4gIHByaXZhdGUgc3F1YXJlU2l6ZTogbnVtYmVyO1xuICBwcml2YXRlIG1heFBhcnRpY2xlczogbnVtYmVyO1xuICBwcml2YXRlIHBhbGV0dGU6IG51bWJlcltdO1xuICBwcml2YXRlIHNwYXduSW50ZXJ2YWw6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBGYWxsaW5nU3F1YXJlc09wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMuc3F1YXJlU2l6ZSA9IG9wdGlvbnMuc3F1YXJlU2l6ZSA/PyAyMDtcbiAgICB0aGlzLm1heFBhcnRpY2xlcyA9IG9wdGlvbnMubWF4UGFydGljbGVzID8/IDMwO1xuICAgIHRoaXMucGFsZXR0ZSA9IG9wdGlvbnMucGFsZXR0ZSA/PyBERUZBVUxUX1BBTEVUVEU7XG4gICAgdGhpcy5zcGF3bkludGVydmFsID0gb3B0aW9ucy5zcGF3bkludGVydmFsID8/IDAuNTtcbiAgfVxuXG4gIGluaXQoY29udGFpbmVyOiBDb250YWluZXIpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgfVxuXG4gIHVwZGF0ZShjb250ZXh0OiBMb2FkaW5nQW5pbWF0aW9uQ29udGV4dCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5jb250YWluZXIpIHJldHVybjtcblxuICAgIHRoaXMudGltZSA9IGNvbnRleHQudGltZTtcbiAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQsIHRleHRFbGVtZW50IH0gPSBjb250ZXh0O1xuXG4gICAgLy8gU3Bhd24gbmV3IHBhcnRpY2xlc1xuICAgIHRoaXMuc3Bhd25QYXJ0aWNsZSh3aWR0aCwgaGVpZ2h0LCB0ZXh0RWxlbWVudCk7XG5cbiAgICAvLyBVcGRhdGUgZXhpc3RpbmcgcGFydGljbGVzXG4gICAgdGhpcy5wYXJ0aWNsZXMgPSB0aGlzLnBhcnRpY2xlcy5maWx0ZXIocCA9PiB7XG4gICAgICBjb25zdCBlbGFwc2VkID0gdGhpcy50aW1lIC0gcC5zcGF3blRpbWU7XG4gICAgICBjb25zdCBwcm9ncmVzcyA9IGVsYXBzZWQgLyBwLmR1cmF0aW9uO1xuXG4gICAgICBpZiAocHJvZ3Jlc3MgPCAwIHx8IHByb2dyZXNzID4gMSkge1xuICAgICAgICBwLnNwcml0ZS5kZXN0cm95KCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgcC5zcHJpdGUueCA9IHAuc3RhcnRYO1xuICAgICAgcC5zcHJpdGUueSA9IHAuc3RhcnRZICsgKHAuZW5kWSAtIHAuc3RhcnRZKSAqIHByb2dyZXNzO1xuICAgICAgcC5zcHJpdGUucm90YXRpb24gPSB0aGlzLnRpbWUgKiBwLnNwaW5SYXRlICogTWF0aC5QSSAqIDI7XG4gICAgICBwLnNwcml0ZS5hbHBoYSA9IHByb2dyZXNzIDwgMC4xID8gcHJvZ3Jlc3MgLyAwLjEgOiBwcm9ncmVzcyA+IDAuODUgPyAoMSAtIHByb2dyZXNzKSAvIDAuMTUgOiAxO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHNwYXduUGFydGljbGUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIsIHRleHRFbGVtZW50OiBUZXh0KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmNvbnRhaW5lcikgcmV0dXJuO1xuICAgIGlmICh0aGlzLnBhcnRpY2xlcy5sZW5ndGggPj0gdGhpcy5tYXhQYXJ0aWNsZXMgfHwgdGhpcy50aW1lIDwgdGhpcy5uZXh0U3Bhd24pIHJldHVybjtcblxuICAgIGNvbnN0IHNpemUgPSB0aGlzLnNxdWFyZVNpemUgKiAoMC43ICsgTWF0aC5yYW5kb20oKSAqIDAuNik7XG4gICAgY29uc3Qgc3ByaXRlID0gbmV3IEdyYXBoaWNzKCk7XG4gICAgc3ByaXRlLnJlY3QoMCwgMCwgc2l6ZSwgc2l6ZSk7XG4gICAgc3ByaXRlLmZpbGwoeyBjb2xvcjogdGhpcy5wYWxldHRlW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMucGFsZXR0ZS5sZW5ndGgpXSB9KTtcbiAgICBzcHJpdGUucGl2b3Quc2V0KHNpemUgLyAyLCBzaXplIC8gMik7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQoc3ByaXRlKTtcblxuICAgIGNvbnN0IHRleHRZID0gdGV4dEVsZW1lbnQueTtcbiAgICBjb25zdCB0ZXh0V2lkdGggPSB0ZXh0RWxlbWVudC53aWR0aCB8fCAyMDA7XG4gICAgY29uc3QgdGV4dENlbnRlclggPSB3aWR0aCAvIDI7XG5cbiAgICB0aGlzLnBhcnRpY2xlcy5wdXNoKHtcbiAgICAgIHNwcml0ZSxcbiAgICAgIHNwYXduVGltZTogdGhpcy50aW1lLFxuICAgICAgZHVyYXRpb246IDEgKyBNYXRoLnJhbmRvbSgpICogMi41LFxuICAgICAgc3BpblJhdGU6ICgwLjA1ICsgTWF0aC5yYW5kb20oKSAqIDEuMDc1KSAqIChNYXRoLnJhbmRvbSgpIDwgMC41ID8gMSA6IC0xKSxcbiAgICAgIHN0YXJ0WDogdGV4dENlbnRlclggLSB0ZXh0V2lkdGggLyAyICsgTWF0aC5yYW5kb20oKSAqIHRleHRXaWR0aCAtIDQsXG4gICAgICBzdGFydFk6IHRleHRZIC0gMTAwLFxuICAgICAgZW5kWTogdGV4dFkgLSA0MCxcbiAgICB9KTtcblxuICAgIHRoaXMubmV4dFNwYXduID0gdGhpcy50aW1lICsgTWF0aC5yYW5kb20oKSAqIHRoaXMuc3Bhd25JbnRlcnZhbDtcbiAgfVxuXG4gIHJlc2V0KCk6IHZvaWQge1xuICAgIHRoaXMudGltZSA9IDA7XG4gICAgdGhpcy5uZXh0U3Bhd24gPSAwO1xuICAgIHRoaXMucGFydGljbGVzLmZvckVhY2gocCA9PiBwLnNwcml0ZS5kZXN0cm95KCkpO1xuICAgIHRoaXMucGFydGljbGVzID0gW107XG4gIH1cblxuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMucGFydGljbGVzLmZvckVhY2gocCA9PiBwLnNwcml0ZS5kZXN0cm95KCkpO1xuICAgIHRoaXMucGFydGljbGVzID0gW107XG4gICAgdGhpcy5jb250YWluZXIgPSBudWxsO1xuICB9XG59XG4iLCJpbXBvcnQgRm9udEZhY2VPYnNlcnZlciBmcm9tICdmb250ZmFjZW9ic2VydmVyJztcbmltcG9ydCB7IEJpdG1hcEZvbnQgfSBmcm9tICdwaXhpLmpzJztcblxuZXhwb3J0IGNvbnN0IGxvYWRGb250cyA9IGFzeW5jICgpID0+IHtcbiAgLy8gbm90ZSB0aGF0IHRoaXMgcmVmZXJlbmNlcyB0aGUgZm9udC1mYWNlIHNwZWNpZmllZCBpbiB0aGUgSFRNTCBzdHlsZSBzZWN0aW9uXG4gIC8vIDxzdHlsZT5cbiAgLy8gQGZvbnQtZmFjZSB7XG4gIC8vICAgZm9udC1mYW1pbHk6ICdrZW5mdXR1cmUtdGhpbic7XG4gIC8vICAgc3JjOiB1cmwoJy4vYXNzZXRzL2ZvbnRzL2tlbnZlY3Rvcl9mdXR1cmVfdGhpbi50dGYnKTtcbiAgLy8gfVxuICAvLyA8L3N0eWxlPlxuXG4gIC8vIHVzaW5nIGZvbnRmYWNlb2JzZXJ2ZXIgYWxsb3dzIHVzIGVuc3VyZSB0aGUgZm9udCBpcyBsb2FkZWQgYmVmb3JlIHVzaW5nIGNvbmZpZ3VyYXRpb24gZm9yIGJpdG1hcCBmb250cy5cbiAgY29uc3QgZm9udEtlbmZ1dHVyZVRoaW4gPSBuZXcgRm9udEZhY2VPYnNlcnZlcigna2VuZnV0dXJlLXRoaW4nKTtcblxuICAvLyBQSVhJLkJpdG1hcEZvbnQuaW5zdGFsbCB3aWxsIGNyZWF0ZSBhIGJpdG1hcCBmb250IGZyb20gYSBmb250LWZhY2UgYW5kIFRleHRTdHlsZSBjb25maWd1cmF0aW9uXG4gIC8vIFVzaW5nIGEgQml0bWFwZm9udCBhbGxvd3MgZm9yIGJldHRlciBwZXJmb3JtYW5jZSB3aGVuIHJhcGlkbHkgY2hhbmdpbmcgcmVuZGVyZWQgdGV4dC5cbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgZm9udEtlbmZ1dHVyZVRoaW4ubG9hZCgpLnRoZW4oKCkgPT4ge1xuICAgICAgQml0bWFwRm9udC5pbnN0YWxsKHtcbiAgICAgICAgbmFtZTogJ2tlbmZ1dHVyZS10aGluJyxcbiAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICBmb250RmFtaWx5OiAna2VuZnV0dXJlLXRoaW4nXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmVzb2x2ZSh7IGZvbnRLZW5mdXR1cmVUaGluIH0pO1xuICAgIH0pO1xuICB9KTtcbn07IiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciBncmlkIGdlbmVyYXRpb25cbiAqIEBjYXRlZ29yeSBMaWJyYXJ5XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgR3JpZE9wdGlvbnMge1xuICB3aWR0aDogbnVtYmVyO1xuICBoZWlnaHQ6IG51bWJlcjtcbiAgY2VsbFdpZHRoOiBudW1iZXI7XG4gIGNlbGxIZWlnaHQ6IG51bWJlcjtcbiAgY2VudGVyZWQ/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIENlbGwgcG9zaXRpb24gaW5mb3JtYXRpb24gcGFzc2VkIHRvIGNhbGxiYWNrIGZ1bmN0aW9uc1xuICogQGNhdGVnb3J5IExpYnJhcnlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDZWxsUG9zaXRpb24ge1xuICB4OiBudW1iZXI7XG4gIHk6IG51bWJlcjtcbiAgcGl4ZWxYOiBudW1iZXI7XG4gIHBpeGVsWTogbnVtYmVyO1xuICBpbmRleDogbnVtYmVyO1xuICB0b3RhbDogbnVtYmVyO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBncmlkIG9mIHRpbGVzIHVzaW5nIGEgc2V0IG9mIHRleHR1cmVzXG4gKiBcbiAqIEBjYXRlZ29yeSBMaWJyYXJ5XG4gKiBAcGFyYW0gb3B0aW9ucyAtIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIGdyaWRcbiAqIEBwYXJhbSB0ZXh0dXJlcyAtIEFycmF5IG9mIHRleHR1cmVzIHRvIHVzZSBmb3IgdGhlIHRpbGVzXG4gKiBAcGFyYW0gc2VsZWN0b3IgLSBPcHRpb25hbCBmdW5jdGlvbiB0byBzZWxlY3Qgd2hpY2ggdGV4dHVyZSB0byB1c2UgZm9yIGVhY2ggY2VsbFxuICogQHJldHVybnMgQSBQSVhJIENvbnRhaW5lciB3aXRoIHRoZSBnZW5lcmF0ZWQgdGlsZSBncmlkXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiAvLyBDcmVhdGUgYSByYW5kb20gZ3Jhc3MgZmllbGRcbiAqIGNvbnN0IGdyYXNzRmllbGQgPSBjcmVhdGVUaWxlR3JpZCh7XG4gKiAgIHdpZHRoOiA2NCxcbiAqICAgaGVpZ2h0OiA2NCxcbiAqICAgY2VsbFdpZHRoOiAxNixcbiAqICAgY2VsbEhlaWdodDogMTYsXG4gKiAgIGNlbnRlcmVkOiB0cnVlXG4gKiB9LCBncmFzc1RleHR1cmVzKTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVGlsZUdyaWQoXG4gIG9wdGlvbnM6IEdyaWRPcHRpb25zLFxuICB0ZXh0dXJlczogUElYSS5UZXh0dXJlW10sXG4gIHNlbGVjdG9yPzogKHBvc2l0aW9uOiBDZWxsUG9zaXRpb24pID0+IG51bWJlclxuKTogUElYSS5Db250YWluZXIge1xuICBjb25zdCB7IHdpZHRoLCBoZWlnaHQsIGNlbGxXaWR0aCwgY2VsbEhlaWdodCwgY2VudGVyZWQgPSBmYWxzZSB9ID0gb3B0aW9ucztcbiAgXG4gIC8vIERlZmF1bHQgc2VsZWN0b3IgcmFuZG9tbHkgY2hvb3NlcyB0ZXh0dXJlc1xuICBjb25zdCBkZWZhdWx0U2VsZWN0b3IgPSAoKSA9PiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0ZXh0dXJlcy5sZW5ndGgpO1xuICBjb25zdCBnZXRUZXh0dXJlSW5kZXggPSBzZWxlY3RvciB8fCBkZWZhdWx0U2VsZWN0b3I7XG4gIFxuICAvLyBDcmVhdGUgY29udGFpbmVyIGZvciB0aGUgZ3JpZFxuICBjb25zdCBjb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgXG4gIC8vIENhbGN1bGF0ZSB0b3RhbCBudW1iZXIgb2YgY2VsbHNcbiAgY29uc3QgdG90YWxDZWxscyA9IHdpZHRoICogaGVpZ2h0O1xuICBcbiAgLy8gR2VuZXJhdGUgZWFjaCBjZWxsIGluIHRoZSBncmlkXG4gIGZvciAobGV0IHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHtcbiAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHtcbiAgICAgIC8vIENhbGN1bGF0ZSBwaXhlbCBjb29yZGluYXRlc1xuICAgICAgY29uc3QgcGl4ZWxYID0geCAqIGNlbGxXaWR0aDtcbiAgICAgIGNvbnN0IHBpeGVsWSA9IHkgKiBjZWxsSGVpZ2h0O1xuICAgICAgXG4gICAgICAvLyBDYWxjdWxhdGUgaW5kZXhcbiAgICAgIGNvbnN0IGluZGV4ID0geSAqIHdpZHRoICsgeDtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIGNlbGwgcG9zaXRpb24gaW5mb1xuICAgICAgY29uc3QgcG9zaXRpb246IENlbGxQb3NpdGlvbiA9IHtcbiAgICAgICAgeCwgeSwgcGl4ZWxYLCBwaXhlbFksIGluZGV4LCB0b3RhbDogdG90YWxDZWxsc1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gR2V0IHRleHR1cmUgaW5kZXggZm9yIHRoaXMgcG9zaXRpb25cbiAgICAgIGNvbnN0IHRleHR1cmVJbmRleCA9IGdldFRleHR1cmVJbmRleChwb3NpdGlvbik7XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSBzcHJpdGUgd2l0aCB0aGUgc2VsZWN0ZWQgdGV4dHVyZVxuICAgICAgY29uc3QgY2VsbCA9IG5ldyBQSVhJLlNwcml0ZSh0ZXh0dXJlc1t0ZXh0dXJlSW5kZXhdKTtcbiAgICAgIGNlbGwucG9zaXRpb24uc2V0KHBpeGVsWCwgcGl4ZWxZKTtcbiAgICAgIFxuICAgICAgLy8gQWRkIHRvIGNvbnRhaW5lclxuICAgICAgY29udGFpbmVyLmFkZENoaWxkKGNlbGwpO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gQ2VudGVyIHRoZSBncmlkIGlmIHJlcXVlc3RlZFxuICBpZiAoY2VudGVyZWQpIHtcbiAgICBjb25zdCBncmlkV2lkdGggPSB3aWR0aCAqIGNlbGxXaWR0aDtcbiAgICBjb25zdCBncmlkSGVpZ2h0ID0gaGVpZ2h0ICogY2VsbEhlaWdodDtcbiAgICBjb250YWluZXIucG9zaXRpb24uc2V0KC1ncmlkV2lkdGggLyAyLCAtZ3JpZEhlaWdodCAvIDIpO1xuICB9XG4gIFxuICByZXR1cm4gY29udGFpbmVyO1xufVxuXG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgYSByYW5nZSBvZiB0ZXh0dXJlc1xuICogXG4gKiBAY2F0ZWdvcnkgTGlicmFyeVxuICogQHBhcmFtIHRleHR1cmVzIC0gRnVsbCBhcnJheSBvZiB0ZXh0dXJlc1xuICogQHBhcmFtIHN0YXJ0SW5kZXggLSBTdGFydGluZyBpbmRleCAoZnJvbSAwKVxuICogQHBhcmFtIGNvdW50IC0gTnVtYmVyIG9mIHRleHR1cmVzIHRvIGluY2x1ZGVcbiAqIEByZXR1cm5zIFN1YnNldCBvZiB0ZXh0dXJlc1xuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogLy8gR2V0IHRoZSBsYXN0IDEyIGZyYW1lcyBmcm9tIGEgc3ByaXRlc2hlZXRcbiAqIGNvbnN0IHRpbGVWYXJpYXRpb25zID0gZ2V0VGV4dHVyZVJhbmdlKGdyYXNzRnJhbWVzLCBncmFzc0ZyYW1lcy5sZW5ndGggLSAxMiwgMTIpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUZXh0dXJlUmFuZ2UoXG4gIHRleHR1cmVzOiBQSVhJLlRleHR1cmVbXSxcbiAgc3RhcnRJbmRleDogbnVtYmVyLFxuICBjb3VudDogbnVtYmVyXG4pOiBQSVhJLlRleHR1cmVbXSB7XG4gIHJldHVybiB0ZXh0dXJlcy5zbGljZShzdGFydEluZGV4LCBzdGFydEluZGV4ICsgY291bnQpO1xufVxuXG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IENvbnRhaW5lciwgR3JhcGhpY3MsIFRleHQgfSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IEZhbGxpbmdTcXVhcmVzQW5pbWF0aW9uLCBGYWxsaW5nU3F1YXJlc09wdGlvbnMgfSBmcm9tICcuL2ZhbGxpbmctc3F1YXJlcy1hbmltYXRpb24nO1xuXG4vLyBSZS1leHBvcnQgZm9yIGNvbnZlbmllbmNlXG5leHBvcnQgeyBGYWxsaW5nU3F1YXJlc0FuaW1hdGlvbiB9O1xuZXhwb3J0IHR5cGUgeyBGYWxsaW5nU3F1YXJlc09wdGlvbnMgfTtcblxuLyoqXG4gKiBJbnRlcmZhY2UgZm9yIGN1c3RvbSBsb2FkaW5nIGFuaW1hdGlvbnMuXG4gKiBJbXBsZW1lbnQgdGhpcyB0byBjcmVhdGUgeW91ciBvd24gbG9hZGluZyBhbmltYXRpb24gcGx1Z2luLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY2xhc3MgU3Bpbm5lckFuaW1hdGlvbiBpbXBsZW1lbnRzIExvYWRpbmdBbmltYXRpb24ge1xuICogICBwcml2YXRlIHNwaW5uZXI6IEdyYXBoaWNzO1xuICogICBwcml2YXRlIHJvdGF0aW9uID0gMDtcbiAqXG4gKiAgIGluaXQoY29udGFpbmVyOiBDb250YWluZXIpIHtcbiAqICAgICB0aGlzLnNwaW5uZXIgPSBuZXcgR3JhcGhpY3MoKTtcbiAqICAgICB0aGlzLnNwaW5uZXIuYXJjKDAsIDAsIDMwLCAwLCBNYXRoLlBJICogMS41KTtcbiAqICAgICB0aGlzLnNwaW5uZXIuc3Ryb2tlKHsgd2lkdGg6IDQsIGNvbG9yOiAweGZmZmZmZiB9KTtcbiAqICAgICBjb250YWluZXIuYWRkQ2hpbGQodGhpcy5zcGlubmVyKTtcbiAqICAgfVxuICpcbiAqICAgdXBkYXRlKGNvbnRleHQ6IExvYWRpbmdBbmltYXRpb25Db250ZXh0KSB7XG4gKiAgICAgdGhpcy5yb3RhdGlvbiArPSBjb250ZXh0LmRlbHRhVGltZSAqIDU7XG4gKiAgICAgdGhpcy5zcGlubmVyLnJvdGF0aW9uID0gdGhpcy5yb3RhdGlvbjtcbiAqICAgICB0aGlzLnNwaW5uZXIueCA9IGNvbnRleHQud2lkdGggLyAyO1xuICogICAgIHRoaXMuc3Bpbm5lci55ID0gY29udGV4dC5oZWlnaHQgLyAyIC0gMjA7XG4gKiAgIH1cbiAqXG4gKiAgIHJlc2V0KCkgeyB0aGlzLnJvdGF0aW9uID0gMDsgfVxuICogICBkZXN0cm95KCkgeyB0aGlzLnNwaW5uZXI/LmRlc3Ryb3koKTsgfVxuICogfVxuICogYGBgXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTG9hZGluZ0FuaW1hdGlvbiB7XG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHRoZSBhbmltYXRpb24uIEFkZCB5b3VyIGRpc3BsYXkgb2JqZWN0cyB0byB0aGUgY29udGFpbmVyLlxuICAgKiBAcGFyYW0gY29udGFpbmVyIC0gUGFyZW50IGNvbnRhaW5lciB0byBhZGQgYW5pbWF0aW9uIGVsZW1lbnRzIHRvXG4gICAqL1xuICBpbml0KGNvbnRhaW5lcjogQ29udGFpbmVyKTogdm9pZDtcblxuICAvKipcbiAgICogVXBkYXRlIGFuaW1hdGlvbiBlYWNoIGZyYW1lLlxuICAgKiBAcGFyYW0gY29udGV4dCAtIEN1cnJlbnQgYW5pbWF0aW9uIGNvbnRleHQgd2l0aCB0aW1pbmcgYW5kIGRpbWVuc2lvbnNcbiAgICovXG4gIHVwZGF0ZShjb250ZXh0OiBMb2FkaW5nQW5pbWF0aW9uQ29udGV4dCk6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIFJlc2V0IGFuaW1hdGlvbiBzdGF0ZSB3aGVuIGxvYWRpbmcgc3RhcnRzLlxuICAgKi9cbiAgcmVzZXQoKTogdm9pZDtcblxuICAvKipcbiAgICogQ2xlYW4gdXAgYW5pbWF0aW9uIHJlc291cmNlcy5cbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZDtcbn1cblxuLyoqXG4gKiBDb250ZXh0IHBhc3NlZCB0byBMb2FkaW5nQW5pbWF0aW9uLnVwZGF0ZSgpIGVhY2ggZnJhbWUuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTG9hZGluZ0FuaW1hdGlvbkNvbnRleHQge1xuICAvKiogVG90YWwgZWxhcHNlZCB0aW1lIGluIHNlY29uZHMgc2luY2UgbG9hZGluZyBzdGFydGVkICovXG4gIHRpbWU6IG51bWJlcjtcbiAgLyoqIERlbHRhIHRpbWUgaW4gc2Vjb25kcyBzaW5jZSBsYXN0IGZyYW1lICovXG4gIGRlbHRhVGltZTogbnVtYmVyO1xuICAvKiogU2NyZWVuIHdpZHRoIGluIHBpeGVscyAqL1xuICB3aWR0aDogbnVtYmVyO1xuICAvKiogU2NyZWVuIGhlaWdodCBpbiBwaXhlbHMgKi9cbiAgaGVpZ2h0OiBudW1iZXI7XG4gIC8qKiBMb2FkaW5nIHRleHQgZWxlbWVudCAoZm9yIHBvc2l0aW9uaW5nIHJlbGF0aXZlIHRvIHRleHQpICovXG4gIHRleHRFbGVtZW50OiBUZXh0O1xufVxuXG4vKipcbiAqIExvYWRpbmcgc2NlbmUgb3B0aW9ucy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBMb2FkaW5nU2NlbmVPcHRpb25zIHtcbiAgLyoqIEJhY2tncm91bmQgY29sb3IgKGRlZmF1bHQ6IDB4MWExYTFhKSAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBMb2FkaW5nIHRleHQgKGRlZmF1bHQ6ICdMT0FESU5HLi4uJykgKi9cbiAgdGV4dD86IHN0cmluZztcbiAgLyoqIFRleHQgc3R5bGUgb3ZlcnJpZGVzICovXG4gIHRleHRTdHlsZT86IFBhcnRpYWw8UElYSS5UZXh0U3R5bGU+O1xuICAvKipcbiAgICogQ3VzdG9tIGxvYWRpbmcgYW5pbWF0aW9uIHBsdWdpbi5cbiAgICogSWYgbm90IHByb3ZpZGVkLCB1c2VzIEZhbGxpbmdTcXVhcmVzQW5pbWF0aW9uLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0c1xuICAgKiAvLyBDdXN0b20gYW5pbWF0aW9uXG4gICAqIGNvbnN0IG9wdGlvbnM6IExvYWRpbmdTY2VuZU9wdGlvbnMgPSB7XG4gICAqICAgYW5pbWF0aW9uOiBuZXcgTXlDdXN0b21BbmltYXRpb24oKVxuICAgKiB9O1xuICAgKlxuICAgKiAvLyBPciBjdXN0b21pemUgdGhlIGRlZmF1bHRcbiAgICogY29uc3Qgb3B0aW9uczogTG9hZGluZ1NjZW5lT3B0aW9ucyA9IHtcbiAgICogICBhbmltYXRpb246IG5ldyBGYWxsaW5nU3F1YXJlc0FuaW1hdGlvbih7XG4gICAqICAgICBzcXVhcmVTaXplOiAxNixcbiAgICogICAgIHBhbGV0dGU6IFsweGZmMDAwMCwgMHgwMGZmMDBdXG4gICAqICAgfSlcbiAgICogfTtcbiAgICogYGBgXG4gICAqL1xuICBhbmltYXRpb24/OiBMb2FkaW5nQW5pbWF0aW9uO1xuICAvKiogT3B0aW9ucyBmb3IgZGVmYXVsdCBGYWxsaW5nU3F1YXJlc0FuaW1hdGlvbiAoaWdub3JlZCBpZiBjdXN0b20gYW5pbWF0aW9uIHByb3ZpZGVkKSAqL1xuICBmYWxsaW5nU3F1YXJlc09wdGlvbnM/OiBGYWxsaW5nU3F1YXJlc09wdGlvbnM7XG59XG5cbi8qKlxuICogTG9hZGluZyBzY2VuZSBjb21wb25lbnQgZm9yIE1veGkuXG4gKiBTaG93cyBhbiBhbmltYXRlZCBsb2FkaW5nIHNjcmVlbiBkdXJpbmcgYXNzZXQgbG9hZGluZy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIC8vIFZpYSBzZXR1cE1veGkgKHJlY29tbWVuZGVkKVxuICogY29uc3QgeyBsb2FkaW5nU2NlbmUgfSA9IGF3YWl0IHNldHVwTW94aSh7XG4gKiAgIHNob3dMb2FkaW5nU2NlbmU6IHRydWUsXG4gKiAgIGxvYWRpbmdTY2VuZU9wdGlvbnM6IHtcbiAqICAgICBiYWNrZ3JvdW5kQ29sb3I6IDB4MjIyMjIyLFxuICogICAgIHRleHQ6ICdQbGVhc2Ugd2FpdC4uLicsXG4gKiAgICAgYW5pbWF0aW9uOiBuZXcgRmFsbGluZ1NxdWFyZXNBbmltYXRpb24oeyBzcXVhcmVTaXplOiAxNiB9KVxuICogICB9XG4gKiB9KTtcbiAqXG4gKiAvLyBNYW51YWwgY29udHJvbFxuICogbG9hZGluZ1NjZW5lLnNob3coKTtcbiAqIGF3YWl0IGxvYWRBc3NldHMoWy4uLl0pO1xuICogbG9hZGluZ1NjZW5lLmhpZGUoKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgTG9hZGluZ1NjZW5lIGV4dGVuZHMgQ29udGFpbmVyIHtcbiAgcHJpdmF0ZSB0ZXh0OiBUZXh0O1xuICBwcml2YXRlIGJhY2tncm91bmQ6IEdyYXBoaWNzO1xuICBwcml2YXRlIGFuaW1hdGlvbkNvbnRhaW5lcjogQ29udGFpbmVyO1xuICBwcml2YXRlIGFuaW1hdGlvbjogTG9hZGluZ0FuaW1hdGlvbjtcbiAgcHJpdmF0ZSB0aWNrZXI6IFBJWEkuVGlja2VyO1xuICBwcml2YXRlIHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgdGltZTogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kQ29sb3I6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBMb2FkaW5nU2NlbmVPcHRpb25zID0ge30pIHtcbiAgICBzdXBlcigpO1xuXG4gICAgY29uc3Qge1xuICAgICAgYmFja2dyb3VuZENvbG9yID0gMHgxYTFhMWEsXG4gICAgICB0ZXh0ID0gJ0xPQURJTkcuLi4nLFxuICAgICAgdGV4dFN0eWxlID0ge30sXG4gICAgICBhbmltYXRpb24sXG4gICAgICBmYWxsaW5nU3F1YXJlc09wdGlvbnNcbiAgICB9ID0gb3B0aW9ucztcblxuICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gYmFja2dyb3VuZENvbG9yO1xuXG4gICAgLy8gVXNlIHByb3ZpZGVkIGFuaW1hdGlvbiBvciBjcmVhdGUgZGVmYXVsdFxuICAgIHRoaXMuYW5pbWF0aW9uID0gYW5pbWF0aW9uID8/IG5ldyBGYWxsaW5nU3F1YXJlc0FuaW1hdGlvbihmYWxsaW5nU3F1YXJlc09wdGlvbnMpO1xuXG4gICAgLy8gQmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBHcmFwaGljcygpO1xuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kKTtcblxuICAgIC8vIEFuaW1hdGlvbiBjb250YWluZXIgKGJldHdlZW4gYmFja2dyb3VuZCBhbmQgdGV4dClcbiAgICB0aGlzLmFuaW1hdGlvbkNvbnRhaW5lciA9IG5ldyBDb250YWluZXIoKTtcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuYW5pbWF0aW9uQ29udGFpbmVyKTtcblxuICAgIC8vIFRleHRcbiAgICB0aGlzLnRleHQgPSBuZXcgVGV4dCh7XG4gICAgICB0ZXh0LFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgZm9udEZhbWlseTogJ0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnLFxuICAgICAgICBmb250U2l6ZTogMTYsXG4gICAgICAgIGZpbGw6IDB4ZmZmZmZmLFxuICAgICAgICBmb250V2VpZ2h0OiAnYm9sZCcsXG4gICAgICAgIC4uLnRleHRTdHlsZVxuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMudGV4dC5hbmNob3Iuc2V0KDAuNSk7XG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLnRleHQpO1xuXG4gICAgLy8gSW5pdGlhbGl6ZSBhbmltYXRpb25cbiAgICB0aGlzLmFuaW1hdGlvbi5pbml0KHRoaXMuYW5pbWF0aW9uQ29udGFpbmVyKTtcblxuICAgIC8vIFRpY2tlclxuICAgIHRoaXMudGlja2VyID0gbmV3IFBJWEkuVGlja2VyKCk7XG4gICAgdGhpcy50aWNrZXIuYXV0b1N0YXJ0ID0gZmFsc2U7XG4gICAgdGhpcy50aWNrZXIuYWRkKCgpID0+IHtcbiAgICAgIGlmICh0aGlzLnZpc2libGUgJiYgdGhpcy5yZW5kZXJlcikge1xuICAgICAgICBjb25zdCBkZWx0YVRpbWUgPSB0aGlzLnRpY2tlci5kZWx0YVRpbWUgLyA2MDtcbiAgICAgICAgdGhpcy50aW1lICs9IGRlbHRhVGltZTtcbiAgICAgICAgdGhpcy51cGRhdGUodGhpcy5yZW5kZXJlci53aWR0aCwgdGhpcy5yZW5kZXJlci5oZWlnaHQsIGRlbHRhVGltZSk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHRoaXMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIsIGRlbHRhVGltZTogbnVtYmVyKTogdm9pZCB7XG4gICAgLy8gQmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZC5jbGVhcigpO1xuICAgIHRoaXMuYmFja2dyb3VuZC5yZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuICAgIHRoaXMuYmFja2dyb3VuZC5maWxsKHsgY29sb3I6IHRoaXMuYmFja2dyb3VuZENvbG9yIH0pO1xuXG4gICAgLy8gVGV4dCBwb3NpdGlvblxuICAgIHRoaXMudGV4dC54ID0gd2lkdGggLyAyIC0gNDtcbiAgICB0aGlzLnRleHQueSA9IGhlaWdodCAvIDIgKyA2MDtcblxuICAgIC8vIFVwZGF0ZSBhbmltYXRpb25cbiAgICB0aGlzLmFuaW1hdGlvbi51cGRhdGUoe1xuICAgICAgdGltZTogdGhpcy50aW1lLFxuICAgICAgZGVsdGFUaW1lLFxuICAgICAgd2lkdGgsXG4gICAgICBoZWlnaHQsXG4gICAgICB0ZXh0RWxlbWVudDogdGhpcy50ZXh0XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSB3aXRoIHJlbmRlcmVyIHJlZmVyZW5jZS5cbiAgICogQHBhcmFtIHJlbmRlcmVyIC0gUElYSSByZW5kZXJlclxuICAgKi9cbiAgaW5pdChyZW5kZXJlcjogUElYSS5SZW5kZXJlcik6IHZvaWQge1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBTaG93IHRoZSBsb2FkaW5nIHNjZW5lIGFuZCBzdGFydCBhbmltYXRpb24uXG4gICAqL1xuICBzaG93KCk6IHZvaWQge1xuICAgIHRoaXMudmlzaWJsZSA9IHRydWU7XG4gICAgdGhpcy50aW1lID0gMDtcbiAgICB0aGlzLmFuaW1hdGlvbi5yZXNldCgpO1xuICAgIGlmICghdGhpcy50aWNrZXIuc3RhcnRlZCkge1xuICAgICAgdGhpcy50aWNrZXIuc3RhcnQoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGlkZSB0aGUgbG9hZGluZyBzY2VuZSBhbmQgc3RvcCBhbmltYXRpb24uXG4gICAqL1xuICBoaWRlKCk6IHZvaWQge1xuICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnRpY2tlci5zdGFydGVkKSB7XG4gICAgICB0aGlzLnRpY2tlci5zdG9wKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENsZWFuIHVwIHJlc291cmNlcy5cbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHRoaXMudGlja2VyLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMudGlja2VyLnN0b3AoKTtcbiAgICB9XG4gICAgdGhpcy50aWNrZXIuZGVzdHJveSgpO1xuICAgIHRoaXMuYW5pbWF0aW9uLmRlc3Ryb3koKTtcbiAgICBzdXBlci5kZXN0cm95KCk7XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBNb3hpRW50aXR5LCBBc0VudGl0eSwgYXNFbnRpdHkgfSBmcm9tICcuLi9jb3JlL21veGktZW50aXR5JztcbmltcG9ydCB7IExvZ2ljIH0gZnJvbSAnLi4vY29yZS9sb2dpYyc7XG5pbXBvcnQgeyBDYW1lcmEgfSBmcm9tICcuLi9jb3JlL2NhbWVyYSc7XG5pbXBvcnQgeyBQYXJhbGxheExheWVyIH0gZnJvbSAnLi9wYXJhbGxheC1sYXllcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFyYWxsYXhCYWNrZ3JvdW5kT3B0aW9ucyB7XG4gIGNhbWVyYT86IENhbWVyYTsgICAgICAgICAgICAgICAgICAgIC8vIFJlZmVyZW5jZSB0byBjYW1lcmEgKGF1dG8tZGV0ZWN0ZWQgaWYgbm90IHByb3ZpZGVkKVxuICBzY3JvbGxPZmZzZXQ/OiBQSVhJLlBvaW50OyAgICAgICAgICAvLyBCYXNlIHNjcm9sbCBvZmZzZXRcbiAgc2Nyb2xsQmFzZVNjYWxlPzogUElYSS5Qb2ludDsgICAgICAgLy8gQmFzZSBzY2FsZSBtdWx0aXBsaWVyXG4gIHNjcm9sbElnbm9yZUNhbWVyYVpvb20/OiBib29sZWFuOyAgIC8vIERpc2FibGUgem9vbSBhZmZlY3RpbmcgcGFyYWxsYXhcbiAgYXV0b3Njcm9sbD86IFBJWEkuUG9pbnQ7ICAgICAgICAgICAgLy8gQXV0b21hdGljIHNjcm9sbGluZyBpbmRlcGVuZGVudCBvZiBjYW1lcmFcbn1cblxuLyoqXG4gKiBDb250YWluZXIgZm9yIGFsbCBwYXJhbGxheCBsYXllcnMgdGhhdCBtYW5hZ2VzIGdsb2JhbCBwYXJhbGxheCBiZWhhdmlvclxuICogYW5kIGNvb3JkaW5hdGVzIHdpdGggdGhlIENhbWVyYSBzeXN0ZW0uXG4gKlxuICogSW5zcGlyZWQgYnkgR29kb3QncyBQYXJhbGxheEJhY2tncm91bmQgbm9kZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgcGFyYWxsYXggPSBuZXcgUGFyYWxsYXhCYWNrZ3JvdW5kKCk7XG4gKiBjb25zdCBza3lMYXllciA9IG5ldyBUaWxpbmdQYXJhbGxheExheWVyKHtcbiAqICAgdGV4dHVyZTogc2t5VGV4dHVyZSxcbiAqICAgc2Nyb2xsU2NhbGU6IG5ldyBQSVhJLlBvaW50KDAuMiwgMC4yKVxuICogfSk7XG4gKiBwYXJhbGxheC5hZGRMYXllcihza3lMYXllcik7XG4gKiBzY2VuZS5hZGRDaGlsZChwYXJhbGxheCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFBhcmFsbGF4QmFja2dyb3VuZCBleHRlbmRzIFBJWEkuQ29udGFpbmVyIGltcGxlbWVudHMgQXNFbnRpdHk8UElYSS5Db250YWluZXI+IHtcbiAgcHVibGljIG1veGlFbnRpdHk6IE1veGlFbnRpdHk8UElYSS5Db250YWluZXI+O1xuICBwdWJsaWMgY2FtZXJhOiBDYW1lcmEgfCBudWxsID0gbnVsbDtcbiAgcHVibGljIHNjcm9sbE9mZnNldDogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICBwdWJsaWMgc2Nyb2xsQmFzZVNjYWxlOiBQSVhJLlBvaW50ID0gbmV3IFBJWEkuUG9pbnQoMSwgMSk7XG4gIHB1YmxpYyBzY3JvbGxJZ25vcmVDYW1lcmFab29tOiBib29sZWFuID0gZmFsc2U7XG4gIHB1YmxpYyBhdXRvc2Nyb2xsOiBQSVhJLlBvaW50ID0gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogUGFyYWxsYXhCYWNrZ3JvdW5kT3B0aW9ucyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcblxuICAgIC8vIEFwcGx5IG9wdGlvbnNcbiAgICB0aGlzLmNhbWVyYSA9IG9wdGlvbnMuY2FtZXJhID8/IG51bGw7XG4gICAgdGhpcy5zY3JvbGxPZmZzZXQgPSBvcHRpb25zLnNjcm9sbE9mZnNldCA/PyBuZXcgUElYSS5Qb2ludCgwLCAwKTtcbiAgICB0aGlzLnNjcm9sbEJhc2VTY2FsZSA9IG9wdGlvbnMuc2Nyb2xsQmFzZVNjYWxlID8/IG5ldyBQSVhJLlBvaW50KDEsIDEpO1xuICAgIHRoaXMuc2Nyb2xsSWdub3JlQ2FtZXJhWm9vbSA9IG9wdGlvbnMuc2Nyb2xsSWdub3JlQ2FtZXJhWm9vbSA/PyBmYWxzZTtcbiAgICB0aGlzLmF1dG9zY3JvbGwgPSBvcHRpb25zLmF1dG9zY3JvbGwgPz8gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG5cbiAgICAvLyBDb252ZXJ0IHRvIE1veGkgZW50aXR5IHdpdGggUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWNcbiAgICBjb25zdCBlbnRpdHkgPSBhc0VudGl0eSh0aGlzKTtcbiAgICBlbnRpdHkubW94aUVudGl0eS5hZGRMb2dpYyhuZXcgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMoKSk7XG4gICAgdGhpcy5tb3hpRW50aXR5ID0gZW50aXR5Lm1veGlFbnRpdHk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIFBhcmFsbGF4TGF5ZXIgdG8gdGhlIGJhY2tncm91bmRcbiAgICovXG4gIGFkZExheWVyKGxheWVyOiBQYXJhbGxheExheWVyKTogdm9pZCB7XG4gICAgdGhpcy5hZGRDaGlsZChsYXllcik7XG4gIH1cblxuICAvKipcbiAgICogQXV0by1kZXRlY3QgY2FtZXJhIGZyb20gc2NlbmUgaGllcmFyY2h5XG4gICAqL1xuICBwcml2YXRlIGRldGVjdENhbWVyYSgpOiBDYW1lcmEgfCBudWxsIHtcbiAgICBsZXQgY3VycmVudCA9IHRoaXMucGFyZW50O1xuICAgIHdoaWxlIChjdXJyZW50KSB7XG4gICAgICBpZiAoY3VycmVudCBpbnN0YW5jZW9mIENhbWVyYSkge1xuICAgICAgICByZXR1cm4gY3VycmVudDtcbiAgICAgIH1cbiAgICAgIGN1cnJlbnQgPSBjdXJyZW50LnBhcmVudDtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBlZmZlY3RpdmUgY2FtZXJhIHBvc2l0aW9uIGZvciBwYXJhbGxheCBjYWxjdWxhdGlvblxuICAgKi9cbiAgZ2V0Q2FtZXJhUG9zaXRpb24oKTogUElYSS5Qb2ludCB7XG4gICAgY29uc3QgY2FtZXJhID0gdGhpcy5jYW1lcmEgPz8gdGhpcy5kZXRlY3RDYW1lcmEoKTtcbiAgICBpZiAoIWNhbWVyYSkge1xuICAgICAgcmV0dXJuIG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICAgIH1cblxuICAgIC8vIEluIE1PWEkncyBjYW1lcmEgc3lzdGVtLCBjYW1lcmEucG9zaXRpb24gcmVwcmVzZW50cyB3aGVyZSB0aGUgY2FtZXJhIGlzIGxvb2tpbmdcbiAgICAvLyBUaGUgc2NlbmUgaXMgcG9zaXRpb25lZCBhdCAtY2FtZXJhLnBvc2l0aW9uIHRvIGNyZWF0ZSB0aGUgY2FtZXJhIGVmZmVjdFxuICAgIHJldHVybiBuZXcgUElYSS5Qb2ludChcbiAgICAgIGNhbWVyYS5wb3NpdGlvbi54LFxuICAgICAgY2FtZXJhLnBvc2l0aW9uLnlcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgZWZmZWN0aXZlIGNhbWVyYSBzY2FsZS96b29tIGZvciBwYXJhbGxheCBjYWxjdWxhdGlvblxuICAgKi9cbiAgZ2V0Q2FtZXJhU2NhbGUoKTogUElYSS5Qb2ludCB7XG4gICAgaWYgKHRoaXMuc2Nyb2xsSWdub3JlQ2FtZXJhWm9vbSkge1xuICAgICAgcmV0dXJuIG5ldyBQSVhJLlBvaW50KDEsIDEpO1xuICAgIH1cblxuICAgIGNvbnN0IGNhbWVyYSA9IHRoaXMuY2FtZXJhID8/IHRoaXMuZGV0ZWN0Q2FtZXJhKCk7XG4gICAgaWYgKCFjYW1lcmEpIHtcbiAgICAgIHJldHVybiBuZXcgUElYSS5Qb2ludCgxLCAxKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFBJWEkuUG9pbnQoY2FtZXJhLnNjYWxlLngsIGNhbWVyYS5zY2FsZS55KTtcbiAgfVxufVxuXG4vKipcbiAqIExvZ2ljIGNvbXBvbmVudCB0aGF0IHVwZGF0ZXMgdGhlIHBhcmFsbGF4IGJhY2tncm91bmQgYmFzZWQgb24gY2FtZXJhIG1vdmVtZW50IGFuZCBhdXRvc2Nyb2xsLlxuICovXG5leHBvcnQgY2xhc3MgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMgZXh0ZW5kcyBMb2dpYzxQYXJhbGxheEJhY2tncm91bmQ+IHtcbiAgbmFtZSA9ICdQYXJhbGxheEJhY2tncm91bmRMb2dpYyc7XG5cbiAgdXBkYXRlKGVudGl0eTogUGFyYWxsYXhCYWNrZ3JvdW5kLCBkZWx0YVRpbWU6IG51bWJlcikge1xuICAgIC8vIEFwcGx5IGF1dG9zY3JvbGxcbiAgICBpZiAoZW50aXR5LmF1dG9zY3JvbGwueCAhPT0gMCB8fCBlbnRpdHkuYXV0b3Njcm9sbC55ICE9PSAwKSB7XG4gICAgICBlbnRpdHkuc2Nyb2xsT2Zmc2V0LnggKz0gZW50aXR5LmF1dG9zY3JvbGwueCAqIGRlbHRhVGltZTtcbiAgICAgIGVudGl0eS5zY3JvbGxPZmZzZXQueSArPSBlbnRpdHkuYXV0b3Njcm9sbC55ICogZGVsdGFUaW1lO1xuICAgIH1cblxuICAgIC8vIEdldCBjYW1lcmEgcG9zaXRpb24gZm9yIGNoaWxkIGxheWVycyB0byByZWZlcmVuY2VcbiAgICBjb25zdCBjYW1lcmFQb3MgPSBlbnRpdHkuZ2V0Q2FtZXJhUG9zaXRpb24oKTtcbiAgICBjb25zdCBjYW1lcmFTY2FsZSA9IGVudGl0eS5nZXRDYW1lcmFTY2FsZSgpO1xuXG4gICAgLy8gUG9zaXRpb24gdGhlIFBhcmFsbGF4QmFja2dyb3VuZCB0byBzdGF5IHNjcmVlbi1hbGlnbmVkXG4gICAgLy8gU2luY2UgUGFyYWxsYXhCYWNrZ3JvdW5kIGlzIGEgY2hpbGQgb2Ygc2NlbmUgd2l0aCBwaXZvdCBhdCB2aWV3cG9ydCBjZW50ZXIsXG4gICAgLy8gd2UgbmVlZCB0byBjb3VudGVyLXNjYWxlIHRvIGtlZXAgbGF5ZXJzIGF0IDE6MSBzY3JlZW4gc2NhbGVcbiAgICBjb25zdCBzY2VuZSA9IGVudGl0eS5wYXJlbnQ7XG4gICAgaWYgKHNjZW5lKSB7XG4gICAgICAvLyBQb3NpdGlvbiB0byBzdGF5IGNlbnRlcmVkIG9uIHZpZXdwb3J0IGRlc3BpdGUgY2FtZXJhIG1vdmVtZW50XG4gICAgICAvLyBBY2NvdW50IGZvciBzY2VuZSBzY2FsZSBzaW5jZSBzY2VuZS5wb3NpdGlvbiBpcyBzY2FsZWRcbiAgICAgIGVudGl0eS5wb3NpdGlvbi54ID0gY2FtZXJhUG9zLnggLyBzY2VuZS5zY2FsZS54O1xuICAgICAgZW50aXR5LnBvc2l0aW9uLnkgPSBjYW1lcmFQb3MueSAvIHNjZW5lLnNjYWxlLnk7XG5cbiAgICAgIC8vIENvdW50ZXItc2NhbGUgdG8gY2FuY2VsIGluaGVyaXRlZCBzY2VuZSBzY2FsZVxuICAgICAgLy8gVGhpcyBrZWVwcyBUaWxpbmdTcHJpdGUgc2l6aW5nIGluIHNjcmVlbi1zcGFjZSBjb29yZGluYXRlc1xuICAgICAgZW50aXR5LnNjYWxlLnggPSAxIC8gc2NlbmUuc2NhbGUueDtcbiAgICAgIGVudGl0eS5zY2FsZS55ID0gMSAvIHNjZW5lLnNjYWxlLnk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVudGl0eS5wb3NpdGlvbi54ID0gY2FtZXJhUG9zLng7XG4gICAgICBlbnRpdHkucG9zaXRpb24ueSA9IGNhbWVyYVBvcy55O1xuICAgICAgZW50aXR5LnNjYWxlLnNldCgxLCAxKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgYWxsIGNoaWxkIFBhcmFsbGF4TGF5ZXJzXG4gICAgZW50aXR5LmNoaWxkcmVuLmZvckVhY2goKGNoaWxkOiBhbnkpID0+IHtcbiAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIFBhcmFsbGF4TGF5ZXIpIHtcbiAgICAgICAgY2hpbGQudXBkYXRlUGFyYWxsYXgoY2FtZXJhUG9zLCBjYW1lcmFTY2FsZSwgZW50aXR5LnNjcm9sbE9mZnNldCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBNb3hpRW50aXR5LCBBc0VudGl0eSwgYXNFbnRpdHkgfSBmcm9tICcuLi9jb3JlL21veGktZW50aXR5JztcblxuZXhwb3J0IGludGVyZmFjZSBQYXJhbGxheExheWVyT3B0aW9ucyB7XG4gIHNjcm9sbFNjYWxlPzogUElYSS5Qb2ludDsgICAgICAvLyBNb3Rpb24gbXVsdGlwbGllciAoMC41ID0gaGFsZiBzcGVlZCwgbGlrZSBHb2RvdCdzIG1vdGlvbl9zY2FsZSlcbiAgc2Nyb2xsT2Zmc2V0PzogUElYSS5Qb2ludDsgICAgIC8vIExheWVyIG9mZnNldCBmb3IgcG9zaXRpb25pbmcgKGxpa2UgR29kb3QncyBtb3Rpb25fb2Zmc2V0KVxuICByZXBlYXRTaXplPzogUElYSS5Qb2ludDsgICAgICAgLy8gTWlycm9yaW5nL3JlcGVhdCBpbnRlcnZhbCAoMCA9IG5vIHJlcGVhdCwgbGlrZSBHb2RvdCdzIG1vdGlvbl9taXJyb3JpbmcpXG4gIG1pcnJvcmluZz86IGJvb2xlYW47ICAgICAgICAgICAvLyBFbmFibGUgYXV0b21hdGljIG1pcnJvcmluZyAocmVxdWlyZXMgcmVwZWF0U2l6ZSlcbn1cblxuLyoqXG4gKiBJbmRpdmlkdWFsIHBhcmFsbGF4IGxheWVyIHRoYXQgc2Nyb2xscyBhdCBhIGRpZmZlcmVudCBzcGVlZCBiYXNlZCBvbiBzY3JvbGxTY2FsZS5cbiAqXG4gKiBJbnNwaXJlZCBieSBHb2RvdCdzIFBhcmFsbGF4TGF5ZXIgbm9kZS5cbiAqXG4gKiBUaGUgc2Nyb2xsU2NhbGUgcHJvcGVydHkgY29udHJvbHMgaG93IGZhc3QgdGhlIGxheWVyIG1vdmVzIHJlbGF0aXZlIHRvIHRoZSBjYW1lcmE6XG4gKiAtIDAuMCA9IFN0YXRpYyAoZG9lc24ndCBtb3ZlIHdpdGggY2FtZXJhLCBnb29kIGZvciBVSS9IVUQpXG4gKiAtIDAuMiA9IFNsb3cgKGFwcGVhcnMgZmFyIGF3YXksIGxpa2Ugc2t5KVxuICogLSAwLjUgPSBNZWRpdW0gKG1pZC1ncm91bmQgZWxlbWVudHMpXG4gKiAtIDAuOSA9IEZhc3QgKGZvcmVncm91bmQgZWxlbWVudHMpXG4gKiAtIDEuMCA9IE1vdmVzIHdpdGggY2FtZXJhIChnYW1lIGVudGl0aWVzKVxuICogLSA+MS4wID0gRmFzdGVyIHRoYW4gY2FtZXJhIChyZXZlcnNlIHBhcmFsbGF4IGVmZmVjdClcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgbGF5ZXIgPSBuZXcgUGFyYWxsYXhMYXllcih7XG4gKiAgIHNjcm9sbFNjYWxlOiBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSksIC8vIEhhbGYgY2FtZXJhIHNwZWVkXG4gKiAgIHNjcm9sbE9mZnNldDogbmV3IFBJWEkuUG9pbnQoMCwgMClcbiAqIH0pO1xuICpcbiAqIC8vIEFkZCBzcHJpdGVzIHRvIHRoZSBsYXllclxuICogY29uc3Qgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xuICogbGF5ZXIuYWRkQ2hpbGQoc3ByaXRlKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgUGFyYWxsYXhMYXllciBleHRlbmRzIFBJWEkuQ29udGFpbmVyIGltcGxlbWVudHMgQXNFbnRpdHk8UElYSS5Db250YWluZXI+IHtcbiAgcHVibGljIG1veGlFbnRpdHk6IE1veGlFbnRpdHk8UElYSS5Db250YWluZXI+O1xuICBwdWJsaWMgc2Nyb2xsU2NhbGU6IFBJWEkuUG9pbnQgPSBuZXcgUElYSS5Qb2ludCgxLCAxKTtcbiAgcHVibGljIHNjcm9sbE9mZnNldDogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICBwdWJsaWMgcmVwZWF0U2l6ZTogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICBwdWJsaWMgbWlycm9yaW5nOiBib29sZWFuID0gZmFsc2U7XG5cbiAgLy8gSW50ZXJuYWwgc3RhdGVcbiAgcHJpdmF0ZSBfbGFzdENhbWVyYVBvczogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IFBhcmFsbGF4TGF5ZXJPcHRpb25zID0ge30pIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5zY3JvbGxTY2FsZSA9IG9wdGlvbnMuc2Nyb2xsU2NhbGUgPz8gbmV3IFBJWEkuUG9pbnQoMSwgMSk7XG4gICAgdGhpcy5zY3JvbGxPZmZzZXQgPSBvcHRpb25zLnNjcm9sbE9mZnNldCA/PyBuZXcgUElYSS5Qb2ludCgwLCAwKTtcbiAgICB0aGlzLnJlcGVhdFNpemUgPSBvcHRpb25zLnJlcGVhdFNpemUgPz8gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG4gICAgdGhpcy5taXJyb3JpbmcgPSBvcHRpb25zLm1pcnJvcmluZyA/PyBmYWxzZTtcblxuICAgIC8vIENvbnZlcnQgdG8gTW94aSBlbnRpdHlcbiAgICBjb25zdCBlbnRpdHkgPSBhc0VudGl0eSh0aGlzKTtcbiAgICB0aGlzLm1veGlFbnRpdHkgPSBlbnRpdHkubW94aUVudGl0eTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgbGF5ZXIgcG9zaXRpb24gYmFzZWQgb24gY2FtZXJhIG1vdmVtZW50LlxuICAgKiBDYWxsZWQgYnkgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMgZWFjaCBmcmFtZS5cbiAgICpcbiAgICogQHBhcmFtIGNhbWVyYVBvcyAtIEN1cnJlbnQgY2FtZXJhIHBvc2l0aW9uIGluIHdvcmxkIHNwYWNlXG4gICAqIEBwYXJhbSBjYW1lcmFTY2FsZSAtIEN1cnJlbnQgY2FtZXJhIHNjYWxlL3pvb21cbiAgICogQHBhcmFtIGJhY2tncm91bmRPZmZzZXQgLSBHbG9iYWwgYmFja2dyb3VuZCBzY3JvbGwgb2Zmc2V0XG4gICAqL1xuICB1cGRhdGVQYXJhbGxheChcbiAgICBjYW1lcmFQb3M6IFBJWEkuUG9pbnQsXG4gICAgY2FtZXJhU2NhbGU6IFBJWEkuUG9pbnQsXG4gICAgYmFja2dyb3VuZE9mZnNldDogUElYSS5Qb2ludFxuICApOiB2b2lkIHtcbiAgICAvLyBDYWxjdWxhdGUgZWZmZWN0aXZlIHNjcm9sbCBvZmZzZXRcbiAgICBjb25zdCBzY3JvbGxYID0gKGNhbWVyYVBvcy54ICsgYmFja2dyb3VuZE9mZnNldC54KSAqIHRoaXMuc2Nyb2xsU2NhbGUueDtcbiAgICBjb25zdCBzY3JvbGxZID0gKGNhbWVyYVBvcy55ICsgYmFja2dyb3VuZE9mZnNldC55KSAqIHRoaXMuc2Nyb2xsU2NhbGUueTtcblxuICAgIC8vIEFwcGx5IHRvIGxheWVyIHBvc2l0aW9uXG4gICAgdGhpcy5wb3NpdGlvbi54ID0gLXNjcm9sbFggKyB0aGlzLnNjcm9sbE9mZnNldC54O1xuICAgIHRoaXMucG9zaXRpb24ueSA9IC1zY3JvbGxZICsgdGhpcy5zY3JvbGxPZmZzZXQueTtcblxuICAgIC8vIEhhbmRsZSBtaXJyb3Jpbmcvd3JhcHBpbmcgaWYgZW5hYmxlZFxuICAgIGlmICh0aGlzLm1pcnJvcmluZykge1xuICAgICAgaWYgKHRoaXMucmVwZWF0U2l6ZS54ID4gMCkge1xuICAgICAgICB0aGlzLnBvc2l0aW9uLnggPSB0aGlzLnBvc2l0aW9uLnggJSB0aGlzLnJlcGVhdFNpemUueDtcbiAgICAgICAgaWYgKHRoaXMucG9zaXRpb24ueCA+IDApIHRoaXMucG9zaXRpb24ueCAtPSB0aGlzLnJlcGVhdFNpemUueDtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnJlcGVhdFNpemUueSA+IDApIHtcbiAgICAgICAgdGhpcy5wb3NpdGlvbi55ID0gdGhpcy5wb3NpdGlvbi55ICUgdGhpcy5yZXBlYXRTaXplLnk7XG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnkgPiAwKSB0aGlzLnBvc2l0aW9uLnkgLT0gdGhpcy5yZXBlYXRTaXplLnk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5fbGFzdENhbWVyYVBvcy5jb3B5RnJvbShjYW1lcmFQb3MpO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGlsaW5nUGFyYWxsYXhMYXllck9wdGlvbnMgZXh0ZW5kcyBQYXJhbGxheExheWVyT3B0aW9ucyB7XG4gIHRleHR1cmU6IFBJWEkuVGV4dHVyZTtcbiAgd2lkdGg/OiBudW1iZXI7XG4gIGhlaWdodD86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBTcGVjaWFsaXplZCBwYXJhbGxheCBsYXllciB1c2luZyBQSVhJLlRpbGluZ1Nwcml0ZSBmb3IgZWZmaWNpZW50IGluZmluaXRlIHNjcm9sbGluZy5cbiAqXG4gKiBUaGlzIGlzIHRoZSByZWNvbW1lbmRlZCBhcHByb2FjaCBmb3IgbGFyZ2UsIHJlcGVhdGluZyBiYWNrZ3JvdW5kcyBsaWtlIHNreSwgY2xvdWRzLFxuICogb3IgZ3JvdW5kIHRleHR1cmVzLiBUaWxpbmdTcHJpdGUgaXMgb3B0aW1pemVkIGZvciByZXBlYXRpbmcgcGF0dGVybnMgYW5kIHVzZXNcbiAqIHRpbGVQb3NpdGlvbiBmb3Igc2VhbWxlc3Mgc2Nyb2xsaW5nIHdpdGhvdXQgcmVwb3NpdGlvbmluZyB0aGUgY29udGFpbmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBza3lMYXllciA9IG5ldyBUaWxpbmdQYXJhbGxheExheWVyKHtcbiAqICAgdGV4dHVyZTogc2t5VGV4dHVyZSxcbiAqICAgc2Nyb2xsU2NhbGU6IG5ldyBQSVhJLlBvaW50KDAuMiwgMC4yKVxuICogICAvLyB3aWR0aC9oZWlnaHQgYXV0by1kZXRlY3RlZCBmcm9tIHJlbmRlcmVyXG4gKiB9KTtcbiAqIHBhcmFsbGF4QmFja2dyb3VuZC5hZGRMYXllcihza3lMYXllcik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFRpbGluZ1BhcmFsbGF4TGF5ZXIgZXh0ZW5kcyBQYXJhbGxheExheWVyIHtcbiAgcHVibGljIHRpbGluZ1Nwcml0ZTogUElYSS5UaWxpbmdTcHJpdGU7XG4gIHByaXZhdGUgX2F1dG9TaXplZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IFRpbGluZ1BhcmFsbGF4TGF5ZXJPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICAvLyBFbnN1cmUgdGV4dHVyZSB3cmFwcyBmb3Igc2VhbWxlc3MgdGlsaW5nXG4gICAgb3B0aW9ucy50ZXh0dXJlLnNvdXJjZS5zdHlsZS5hZGRyZXNzTW9kZSA9ICdyZXBlYXQnO1xuXG4gICAgLy8gSWYgZGltZW5zaW9ucyBub3QgcHJvdmlkZWQsIHVzZSB0ZW1wb3JhcnkgdmFsdWVzIGFuZCBhdXRvLWRldGVjdCBvbiBmaXJzdCB1cGRhdGVcbiAgICBjb25zdCB3aWR0aCA9IG9wdGlvbnMud2lkdGggPz8gMTtcbiAgICBjb25zdCBoZWlnaHQgPSBvcHRpb25zLmhlaWdodCA/PyAxO1xuXG4gICAgLy8gQ3JlYXRlIFRpbGluZ1Nwcml0ZSBhcyBjaGlsZFxuICAgIHRoaXMudGlsaW5nU3ByaXRlID0gbmV3IFBJWEkuVGlsaW5nU3ByaXRlKHtcbiAgICAgIHRleHR1cmU6IG9wdGlvbnMudGV4dHVyZSxcbiAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIH0pO1xuXG4gICAgLy8gUG9zaXRpb24gVGlsaW5nU3ByaXRlIHRvIHN0YXJ0IGZyb20gb3JpZ2luICgwLCAwKSB0byBjb3ZlciB0aGUgdmlld3BvcnRcbiAgICB0aGlzLnRpbGluZ1Nwcml0ZS5wb3NpdGlvbi5zZXQoMCwgMCk7XG5cbiAgICB0aGlzLmFkZENoaWxkKHRoaXMudGlsaW5nU3ByaXRlKTtcblxuICAgIC8vIE1hcmsgaWYgd2UgbmVlZCB0byBhdXRvLWRldGVjdCBkaW1lbnNpb25zXG4gICAgdGhpcy5fYXV0b1NpemVkID0gIW9wdGlvbnMud2lkdGggJiYgIW9wdGlvbnMuaGVpZ2h0O1xuICB9XG5cbiAgLyoqXG4gICAqIEF1dG8tZGV0ZWN0IHJlbmRlcmVyIGRpbWVuc2lvbnMgZnJvbSB0aGUgc2NlbmUgaGllcmFyY2h5XG4gICAqL1xuICBwcml2YXRlIGF1dG9EZXRlY3REaW1lbnNpb25zKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5fYXV0b1NpemVkKSByZXR1cm47XG5cbiAgICAvLyBXYWxrIHVwIHBhcmVudCBjaGFpbiB0byBmaW5kIGEgbm9kZSB3aXRoIGEgcmVuZGVyZXJcbiAgICBsZXQgY3VycmVudDogYW55ID0gdGhpcy5wYXJlbnQ7XG4gICAgd2hpbGUgKGN1cnJlbnQpIHtcbiAgICAgIGlmIChjdXJyZW50LnJlbmRlcmVyKSB7XG4gICAgICAgIC8vIEZvdW5kIGEgcmVuZGVyZXIgKHVzdWFsbHkgb24gU2NlbmUpXG4gICAgICAgIHRoaXMucmVzaXplKGN1cnJlbnQucmVuZGVyZXIud2lkdGgsIGN1cnJlbnQucmVuZGVyZXIuaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5fYXV0b1NpemVkID0gZmFsc2U7IC8vIE9ubHkgbmVlZCB0byBkbyB0aGlzIG9uY2VcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBPdmVycmlkZSB1cGRhdGVQYXJhbGxheCB0byB1c2UgdGlsZVBvc2l0aW9uIGluc3RlYWQgb2YgY29udGFpbmVyIHBvc2l0aW9uLlxuICAgKiBUaGlzIHByb3ZpZGVzIHNlYW1sZXNzIGluZmluaXRlIHNjcm9sbGluZyB3aXRob3V0IHZpc2libGUgc2VhbXMuXG4gICAqXG4gICAqIFNpbmNlIHRoZSBQYXJhbGxheEJhY2tncm91bmQgY29udGFpbmVyIG5vdyBmb2xsb3dzIHRoZSBjYW1lcmEsIGxheWVycyBpbnNpZGVcbiAgICogc3RheSBhdCAoMCwwKSBhbmQgb25seSB1c2UgdGlsZVBvc2l0aW9uIGZvciB0aGUgcGFyYWxsYXggc2Nyb2xsaW5nIGVmZmVjdC5cbiAgICpcbiAgICogQ2FtZXJhIHNjYWxlIGlzIHVzZWQgdG8gcmVzaXplIHRoZSBUaWxpbmdTcHJpdGUgdG8gY292ZXIgdGhlIHZpZXdwb3J0IGF0IGRpZmZlcmVudCB6b29tIGxldmVscy5cbiAgICovXG4gIHVwZGF0ZVBhcmFsbGF4KFxuICAgIGNhbWVyYVBvczogUElYSS5Qb2ludCxcbiAgICBjYW1lcmFTY2FsZTogUElYSS5Qb2ludCxcbiAgICBiYWNrZ3JvdW5kT2Zmc2V0OiBQSVhJLlBvaW50XG4gICk6IHZvaWQge1xuICAgIC8vIEF1dG8tZGV0ZWN0IGRpbWVuc2lvbnMgb24gZmlyc3QgdXBkYXRlIGlmIG5vdCBtYW51YWxseSBzcGVjaWZpZWRcbiAgICB0aGlzLmF1dG9EZXRlY3REaW1lbnNpb25zKCk7XG4gICAgLy8gY29uc29sZS5sb2coJ3VwZGF0ZVBhcmFsbGF4JywgY2FtZXJhU2NhbGUpO1xuXG4gICAgLy8gR2V0IHJlbmRlcmVyIGRpbWVuc2lvbnMgdG8gdXNlIGFzIGJhc2Ugc2l6ZVxuICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcy5wYXJlbnQ/LnBhcmVudCBhcyBhbnk7IC8vIEdldCByZW5kZXJlciBmcm9tIHNjZW5lXG4gICAgaWYgKHJlbmRlcmVyPy5yZW5kZXJlcikge1xuICAgICAgY29uc3QgYmFzZVdpZHRoID0gcmVuZGVyZXIucmVuZGVyZXIud2lkdGg7XG4gICAgICBjb25zdCBiYXNlSGVpZ2h0ID0gcmVuZGVyZXIucmVuZGVyZXIuaGVpZ2h0O1xuXG4gICAgICAvLyBQYXJhbGxheEJhY2tncm91bmQgY291bnRlci1zY2FsZXMsIHNvIHdlJ3JlIGluIHNjcmVlbi1zcGFjZVxuICAgICAgLy8gSnVzdCBzZXQgdG8gcmVuZGVyZXIgc2l6ZSAtIG5vIHpvb20gYWRqdXN0bWVudCBuZWVkZWRcbiAgICAgIHRoaXMudGlsaW5nU3ByaXRlLndpZHRoID0gYmFzZVdpZHRoO1xuICAgICAgdGhpcy50aWxpbmdTcHJpdGUuaGVpZ2h0ID0gYmFzZUhlaWdodDtcblxuICAgICAgLy8gS2VlcCBzcHJpdGUgYXQgb3JpZ2luXG4gICAgICB0aGlzLnRpbGluZ1Nwcml0ZS5waXZvdC5zZXQoMCwgMCk7XG4gICAgICB0aGlzLnRpbGluZ1Nwcml0ZS5wb3NpdGlvbi5zZXQoMCwgMCk7XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIGVmZmVjdGl2ZSBzY3JvbGwgb2Zmc2V0IGZvciB0aWxlUG9zaXRpb25cbiAgICBjb25zdCBzY3JvbGxYID0gKGNhbWVyYVBvcy54ICsgYmFja2dyb3VuZE9mZnNldC54KSAqIHRoaXMuc2Nyb2xsU2NhbGUueDtcbiAgICBjb25zdCBzY3JvbGxZID0gKGNhbWVyYVBvcy55ICsgYmFja2dyb3VuZE9mZnNldC55KSAqIHRoaXMuc2Nyb2xsU2NhbGUueTtcblxuICAgIC8vIEFwcGx5IHRvIHRpbGVQb3NpdGlvbiAod2l0aCBsYXllcidzIG93biBzY3JvbGxPZmZzZXQgZm9yIHBvc2l0aW9uaW5nKVxuICAgIHRoaXMudGlsaW5nU3ByaXRlLnRpbGVQb3NpdGlvbi54ID0gLXNjcm9sbFggKyB0aGlzLnNjcm9sbE9mZnNldC54O1xuICAgIHRoaXMudGlsaW5nU3ByaXRlLnRpbGVQb3NpdGlvbi55ID0gLXNjcm9sbFkgKyB0aGlzLnNjcm9sbE9mZnNldC55O1xuXG4gICAgLy8gTGF5ZXIgY29udGFpbmVyIHN0YXlzIGF0IG9yaWdpbiAtIHNjZW5lIHBpdm90IGhhbmRsZXMgem9vbSBhbmNob3JpbmdcbiAgICB0aGlzLnBvc2l0aW9uLnNldCgwLCAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgVGlsaW5nU3ByaXRlIGRpbWVuc2lvbnMgKGUuZy4sIG9uIHdpbmRvdyByZXNpemUpXG4gICAqL1xuICByZXNpemUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnRpbGluZ1Nwcml0ZS53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMudGlsaW5nU3ByaXRlLmhlaWdodCA9IGhlaWdodDtcbiAgfVxufVxuIiwiLyoqXG4gKiBQaHlzaWNzIG1vZHVsZSAtIFBsYW5jay5qcyBpbnRlZ3JhdGlvbiBmb3IgTU9YSVxuICpcbiAqIEBwYWNrYWdlRG9jdW1lbnRhdGlvblxuICovXG5cbi8vIENvcmUgY2xhc3Nlc1xuZXhwb3J0IHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi9waHlzaWNzLXdvcmxkJztcbmV4cG9ydCB7IFBoeXNpY3NCb2R5TG9naWMgfSBmcm9tICcuL3BoeXNpY3MtYm9keS1sb2dpYyc7XG5leHBvcnQgeyBDb2xsaXNpb25SZWdpc3RyeSwgQ29sbGlzaW9uTWFuYWdlciB9IGZyb20gJy4vcGh5c2ljcy1jb2xsaXNpb24nO1xuZXhwb3J0IHsgUGh5c2ljc0RlYnVnUmVuZGVyZXIgfSBmcm9tICcuL3BoeXNpY3MtZGVidWctcmVuZGVyZXInO1xuXG4vLyBVdGlsaXRpZXNcbmV4cG9ydCB7XG4gIGFzUGh5c2ljc0VudGl0eSxcbiAgaGFzUGh5c2ljcyxcbiAgZ2V0UGh5c2ljc0JvZHksXG4gIGNyZWF0ZVNoYXBlRnJvbVNwcml0ZVxufSBmcm9tICcuL3BoeXNpY3MtdXRpbHMnO1xuXG4vLyBNYXRlcmlhbHNcbmV4cG9ydCB7IFBoeXNpY3NNYXRlcmlhbHMsIGFwcGx5TWF0ZXJpYWwgfSBmcm9tICcuL3BoeXNpY3MtbWF0ZXJpYWxzJztcblxuLy8gVHlwZXNcbmV4cG9ydCB0eXBlIHtcbiAgQm9keVR5cGUsXG4gIFN5bmNNb2RlLFxuICBTaGFwZVR5cGUsXG4gIENvbGxpc2lvblRhZyxcbiAgU2hhcGVDb25maWcsXG4gIFBoeXNpY3NXb3JsZE9wdGlvbnMsXG4gIFBoeXNpY3NCb2R5T3B0aW9ucyxcbiAgUGh5c2ljc0RlYnVnT3B0aW9ucyxcbiAgQ29sbGlzaW9uRXZlbnQsXG4gIFJheWNhc3RDYWxsYmFja1xufSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCAqIGFzIHBsYW5jayBmcm9tICdwbGFuY2snO1xuaW1wb3J0IHsgTG9naWMgfSBmcm9tICcuLi8uLi9jb3JlL2xvZ2ljJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi9waHlzaWNzLXdvcmxkJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc0JvZHlPcHRpb25zLCBCb2R5VHlwZSwgU2hhcGVUeXBlIH0gZnJvbSAnLi9waHlzaWNzLXR5cGVzJztcbmltcG9ydCB7IHBhcnNlR3JhcGhpY3NTaGFwZSB9IGZyb20gJy4vcGh5c2ljcy1ncmFwaGljcy1wYXJzZXInO1xuXG4vKipcbiAqIExvZ2ljIGNvbXBvbmVudCB0aGF0IHN5bmNzIGEgUElYSSBlbnRpdHkgd2l0aCBhIFBsYW5jay5qcyBwaHlzaWNzIGJvZHkuXG4gKiBIYW5kbGVzIHBvc2l0aW9uL3JvdGF0aW9uIHN5bmMsIGNvbGxpc2lvbiBmaWx0ZXJpbmcsIGFuZCBmb3JjZSBhcHBsaWNhdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIC8vIENyZWF0ZSBwaHlzaWNzIGJvZHkgZm9yIGEgc3ByaXRlXG4gKiBjb25zdCBzcHJpdGUgPSBhc0VudGl0eShuZXcgUElYSS5TcHJpdGUodGV4dHVyZSkpO1xuICogY29uc3QgYm9keSA9IG5ldyBQaHlzaWNzQm9keUxvZ2ljKHBoeXNpY3NXb3JsZCwge1xuICogICB0eXBlOiAnZHluYW1pYycsXG4gKiAgIGNvbGxpc2lvblRhZ3M6IFsncGxheWVyJ10sXG4gKiAgIGNvbGxpZGVzV2l0aDogWyd0ZXJyYWluJywgJ2VuZW15J10sXG4gKiAgIGRlbnNpdHk6IDEuMCxcbiAqICAgZnJpY3Rpb246IDAuM1xuICogfSk7XG4gKiBzcHJpdGUubW94aUVudGl0eS5hZGRMb2dpYyhib2R5KTtcbiAqXG4gKiAvLyBBcHBseSBmb3JjZXMgaW4gdXBkYXRlIGxvb3BcbiAqIGJvZHkuYXBwbHlJbXB1bHNlKG5ldyBQSVhJLlBvaW50KDEwMCwgMCkpO1xuICogYm9keS5zZXRWZWxvY2l0eShuZXcgUElYSS5Qb2ludCgwLCAtMjAwKSk7XG4gKlxuICogLy8gQ29sbGlzaW9uIGNhbGxiYWNrc1xuICogYm9keS5vbkNvbGxpc2lvbkJlZ2luID0gKG90aGVyLCBjb250YWN0KSA9PiBjb25zb2xlLmxvZygnaGl0IScpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBQaHlzaWNzQm9keUxvZ2ljIGV4dGVuZHMgTG9naWM8UElYSS5Db250YWluZXI+IHtcbiAgbmFtZSA9ICdQaHlzaWNzQm9keUxvZ2ljJztcblxuICAvKiogUGxhbmNrLmpzIGJvZHkgaW5zdGFuY2UuICovXG4gIHB1YmxpYyBib2R5ITogcGxhbmNrLkJvZHk7XG5cbiAgLyoqIFBhcmVudCBwaHlzaWNzIHdvcmxkLiAqL1xuICBwdWJsaWMgd29ybGQ6IFBoeXNpY3NXb3JsZDtcblxuICAvKiogQm9keSBjb25maWd1cmF0aW9uLiAqL1xuICBwdWJsaWMgb3B0aW9uczogUGh5c2ljc0JvZHlPcHRpb25zO1xuXG4gIC8qKiBDYWxsZWQgd2hlbiBjb2xsaXNpb24gYmVnaW5zLiAqL1xuICBwdWJsaWMgb25Db2xsaXNpb25CZWdpbj86IChvdGhlcjogUGh5c2ljc0JvZHlMb2dpYywgY29udGFjdDogcGxhbmNrLkNvbnRhY3QpID0+IHZvaWQ7XG5cbiAgLyoqIENhbGxlZCB3aGVuIGNvbGxpc2lvbiBlbmRzLiAqL1xuICBwdWJsaWMgb25Db2xsaXNpb25FbmQ/OiAob3RoZXI6IFBoeXNpY3NCb2R5TG9naWMsIGNvbnRhY3Q6IHBsYW5jay5Db250YWN0KSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKHdvcmxkOiBQaHlzaWNzV29ybGQsIG9wdGlvbnM6IFBoeXNpY3NCb2R5T3B0aW9ucyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLndvcmxkID0gd29ybGQ7XG4gICAgdGhpcy5vcHRpb25zID0ge1xuICAgICAgdHlwZTogJ2R5bmFtaWMnLFxuICAgICAgc3luY01vZGU6ICdwaHlzaWNzLWRyaXZlbicsXG4gICAgICBzeW5jUG9zaXRpb246IHRydWUsXG4gICAgICBzeW5jUm90YXRpb246IHRydWUsXG4gICAgICBkZW5zaXR5OiAxLjAsXG4gICAgICBmcmljdGlvbjogMC4zLFxuICAgICAgcmVzdGl0dXRpb246IDAuMCxcbiAgICAgIGZpeGVkUm90YXRpb246IGZhbHNlLFxuICAgICAgaXNTZW5zb3I6IGZhbHNlLFxuICAgICAgYnVsbGV0OiBmYWxzZSxcbiAgICAgIC4uLm9wdGlvbnNcbiAgICB9O1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCBDcmVhdGVzIHBoeXNpY3MgYm9keSBhbmQgcmVnaXN0ZXJzIHdpdGggd29ybGQuICovXG4gIGluaXQoZW50aXR5OiBQSVhJLkNvbnRhaW5lciwgcmVuZGVyZXI/OiBQSVhJLlJlbmRlcmVyKTogdm9pZCB7XG4gICAgLy8gQ3JlYXRlIHRoZSBwaHlzaWNzIGJvZHlcbiAgICB0aGlzLmNyZWF0ZVBoeXNpY3NCb2R5KGVudGl0eSk7XG5cbiAgICAvLyBTZXQgdXNlciBkYXRhIHRvIHJlZmVyZW5jZSB0aGlzIGxvZ2ljIGNvbXBvbmVudFxuICAgIHRoaXMuYm9keS5zZXRVc2VyRGF0YSh0aGlzKTtcblxuICAgIC8vIFJlZ2lzdGVyIHdpdGggcGh5c2ljcyB3b3JsZFxuICAgIHRoaXMud29ybGQucmVnaXN0ZXJCb2R5KHRoaXMuYm9keSwgdGhpcyk7XG4gIH1cblxuICAvKiogQGludGVybmFsIFN5bmNzIHBoeXNpY3Mg4oaUIHNwcml0ZSBiYXNlZCBvbiBzeW5jTW9kZS4gKi9cbiAgdXBkYXRlKGVudGl0eTogUElYSS5Db250YWluZXIsIGRlbHRhVGltZT86IG51bWJlcik6IHZvaWQge1xuICAgIGlmICghdGhpcy5ib2R5KSByZXR1cm47XG5cbiAgICAvLyBTeW5jIGJhc2VkIG9uIG1vZGVcbiAgICBzd2l0Y2ggKHRoaXMub3B0aW9ucy5zeW5jTW9kZSkge1xuICAgICAgY2FzZSAncGh5c2ljcy1kcml2ZW4nOlxuICAgICAgICB0aGlzLnN5bmNGcm9tUGh5c2ljcyhlbnRpdHkpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3Nwcml0ZS1kcml2ZW4nOlxuICAgICAgICB0aGlzLnN5bmNUb1BoeXNpY3MoZW50aXR5KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdtYW51YWwnOlxuICAgICAgICAvLyBVc2VyIGhhbmRsZXMgc3luYyBtYW51YWxseVxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvKiogUmVtb3ZlcyBib2R5IGZyb20gcGh5c2ljcyB3b3JsZC4gKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5ib2R5KSB7XG4gICAgICB0aGlzLndvcmxkLmRlc3Ryb3lCb2R5KHRoaXMuYm9keSk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCBVcGRhdGVzIHNwcml0ZSBwb3NpdGlvbi9yb3RhdGlvbiBmcm9tIHBoeXNpY3MuICovXG4gIHByaXZhdGUgc3luY0Zyb21QaHlzaWNzKGVudGl0eTogUElYSS5Db250YWluZXIpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYm9keSkgcmV0dXJuO1xuXG4gICAgY29uc3QgcG9zID0gdGhpcy5ib2R5LmdldFBvc2l0aW9uKCk7XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnN5bmNQb3NpdGlvbikge1xuICAgICAgZW50aXR5LnggPSB0aGlzLndvcmxkLnRvUGl4ZWxzKHBvcy54KTtcbiAgICAgIGVudGl0eS55ID0gdGhpcy53b3JsZC50b1BpeGVscyhwb3MueSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zeW5jUm90YXRpb24pIHtcbiAgICAgIGVudGl0eS5yb3RhdGlvbiA9IHRoaXMuYm9keS5nZXRBbmdsZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBVcGRhdGVzIHBoeXNpY3MgYm9keSBmcm9tIHNwcml0ZSBwb3NpdGlvbi9yb3RhdGlvbi4gKi9cbiAgc3luY1RvUGh5c2ljcyhlbnRpdHk6IFBJWEkuQ29udGFpbmVyKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmJvZHkpIHJldHVybjtcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuc3luY1Bvc2l0aW9uKSB7XG4gICAgICBjb25zdCB4ID0gdGhpcy53b3JsZC50b1BoeXNpY3MoZW50aXR5LngpO1xuICAgICAgY29uc3QgeSA9IHRoaXMud29ybGQudG9QaHlzaWNzKGVudGl0eS55KTtcbiAgICAgIHRoaXMuYm9keS5zZXRQb3NpdGlvbihwbGFuY2suVmVjMih4LCB5KSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zeW5jUm90YXRpb24pIHtcbiAgICAgIHRoaXMuYm9keS5zZXRBbmdsZShlbnRpdHkucm90YXRpb24pO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBjcmVhdGVQaHlzaWNzQm9keShlbnRpdHk6IFBJWEkuQ29udGFpbmVyKTogdm9pZCB7XG4gICAgLy8gRGV0ZXJtaW5lIGJvZHkgdHlwZVxuICAgIGxldCBib2R5VHlwZTogcGxhbmNrLkJvZHlUeXBlO1xuICAgIHN3aXRjaCAodGhpcy5vcHRpb25zLnR5cGUpIHtcbiAgICAgIGNhc2UgJ3N0YXRpYyc6XG4gICAgICAgIGJvZHlUeXBlID0gJ3N0YXRpYyc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAna2luZW1hdGljJzpcbiAgICAgICAgYm9keVR5cGUgPSAna2luZW1hdGljJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdkeW5hbWljJzpcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJvZHlUeXBlID0gJ2R5bmFtaWMnO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYm9keSBkZWZpbml0aW9uXG4gICAgY29uc3QgYm9keURlZjogcGxhbmNrLkJvZHlEZWYgPSB7XG4gICAgICB0eXBlOiBib2R5VHlwZSxcbiAgICAgIHBvc2l0aW9uOiB0aGlzLm9wdGlvbnMucG9zaXRpb25cbiAgICAgICAgPyB0aGlzLndvcmxkLnRvUGh5c2ljc1BvaW50KHRoaXMub3B0aW9ucy5wb3NpdGlvbilcbiAgICAgICAgOiBwbGFuY2suVmVjMih0aGlzLndvcmxkLnRvUGh5c2ljcyhlbnRpdHkueCksIHRoaXMud29ybGQudG9QaHlzaWNzKGVudGl0eS55KSksXG4gICAgICBhbmdsZTogdGhpcy5vcHRpb25zLnJvdGF0aW9uID8/IGVudGl0eS5yb3RhdGlvbixcbiAgICAgIGxpbmVhclZlbG9jaXR5OiB0aGlzLm9wdGlvbnMubGluZWFyVmVsb2NpdHlcbiAgICAgICAgPyB0aGlzLndvcmxkLnRvUGh5c2ljc1BvaW50KHRoaXMub3B0aW9ucy5saW5lYXJWZWxvY2l0eSlcbiAgICAgICAgOiBwbGFuY2suVmVjMigwLCAwKSxcbiAgICAgIGFuZ3VsYXJWZWxvY2l0eTogdGhpcy5vcHRpb25zLmFuZ3VsYXJWZWxvY2l0eSA/PyAwLFxuICAgICAgZml4ZWRSb3RhdGlvbjogdGhpcy5vcHRpb25zLmZpeGVkUm90YXRpb24gPz8gZmFsc2UsXG4gICAgICBidWxsZXQ6IHRoaXMub3B0aW9ucy5idWxsZXQgPz8gZmFsc2VcbiAgICB9O1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBib2R5XG4gICAgdGhpcy5ib2R5ID0gdGhpcy53b3JsZC5jcmVhdGVCb2R5KGJvZHlEZWYpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBzaGFwZSBhbmQgZml4dHVyZVxuICAgIHRoaXMuY3JlYXRlRml4dHVyZShlbnRpdHkpO1xuXG4gICAgLy8gU2V0IGluaXRpYWwgdmVsb2NpdGllcyBpZiBwcm92aWRlZFxuICAgIGlmICh0aGlzLm9wdGlvbnMubGluZWFyVmVsb2NpdHkpIHtcbiAgICAgIHRoaXMuc2V0VmVsb2NpdHkodGhpcy5vcHRpb25zLmxpbmVhclZlbG9jaXR5KTtcbiAgICB9XG4gICAgaWYgKHRoaXMub3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpIHtcbiAgICAgIHRoaXMuc2V0QW5ndWxhclZlbG9jaXR5KHRoaXMub3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBjcmVhdGVGaXh0dXJlKGVudGl0eTogUElYSS5Db250YWluZXIpOiB2b2lkIHtcbiAgICBjb25zdCBzaGFwZSA9IHRoaXMuY3JlYXRlU2hhcGUoZW50aXR5KTtcblxuICAgIC8vIFNldHVwIGNvbGxpc2lvbiBmaWx0ZXJpbmdcbiAgICBjb25zdCBjYXRlZ29yeUJpdHMgPSB0aGlzLm9wdGlvbnMuY29sbGlzaW9uVGFnc1xuICAgICAgPyB0aGlzLndvcmxkLmNvbGxpc2lvblJlZ2lzdHJ5LnRhZ3NUb0JpdHModGhpcy5vcHRpb25zLmNvbGxpc2lvblRhZ3MpXG4gICAgICA6IHRoaXMud29ybGQuY29sbGlzaW9uUmVnaXN0cnkuZ2V0Qml0KCdkZWZhdWx0Jyk7XG5cbiAgICBjb25zdCBtYXNrQml0cyA9IHRoaXMub3B0aW9ucy5jb2xsaWRlc1dpdGhcbiAgICAgID8gdGhpcy53b3JsZC5jb2xsaXNpb25SZWdpc3RyeS50YWdzVG9CaXRzKHRoaXMub3B0aW9ucy5jb2xsaWRlc1dpdGgpXG4gICAgICA6IDB4RkZGRjsgLy8gQ29sbGlkZSB3aXRoIGV2ZXJ5dGhpbmcgYnkgZGVmYXVsdFxuXG4gICAgY29uc3QgZ3JvdXBJbmRleCA9IHRoaXMub3B0aW9ucy5jb2xsaXNpb25Hcm91cCA/PyAwO1xuXG4gICAgLy8gQ3JlYXRlIGZpeHR1cmVcbiAgICB0aGlzLmJvZHkuY3JlYXRlRml4dHVyZSh7XG4gICAgICBzaGFwZTogc2hhcGUsXG4gICAgICBkZW5zaXR5OiB0aGlzLm9wdGlvbnMuZGVuc2l0eSA/PyAxLjAsXG4gICAgICBmcmljdGlvbjogdGhpcy5vcHRpb25zLmZyaWN0aW9uID8/IDAuMyxcbiAgICAgIHJlc3RpdHV0aW9uOiB0aGlzLm9wdGlvbnMucmVzdGl0dXRpb24gPz8gMC4wLFxuICAgICAgaXNTZW5zb3I6IHRoaXMub3B0aW9ucy5pc1NlbnNvciA/PyBmYWxzZSxcbiAgICAgIGZpbHRlckNhdGVnb3J5Qml0czogY2F0ZWdvcnlCaXRzLFxuICAgICAgZmlsdGVyTWFza0JpdHM6IG1hc2tCaXRzLFxuICAgICAgZmlsdGVyR3JvdXBJbmRleDogZ3JvdXBJbmRleFxuICAgIH0pO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCBFeHRyYWN0cyBzaGFwZSBmcm9tIEdyYXBoaWNzLCBjb2xsaXNpb25TaGFwZSwgb3IgbGVnYWN5IG9wdGlvbnMuICovXG4gIHByaXZhdGUgY3JlYXRlU2hhcGUoZW50aXR5OiBQSVhJLkNvbnRhaW5lcik6IHBsYW5jay5TaGFwZSB7XG4gICAgLy8gUHJpb3JpdHkgMTogRXhwbGljaXQgY29sbGlzaW9uIHNoYXBlIHByb3ZpZGVkXG4gICAgaWYgKHRoaXMub3B0aW9ucy5jb2xsaXNpb25TaGFwZSkge1xuICAgICAgY29uc3QgcGFyc2VkID0gcGFyc2VHcmFwaGljc1NoYXBlKHRoaXMub3B0aW9ucy5jb2xsaXNpb25TaGFwZSwgdGhpcy53b3JsZCk7XG4gICAgICByZXR1cm4gcGFyc2VkLnNoYXBlO1xuICAgIH1cblxuICAgIC8vIFByaW9yaXR5IDI6IEVudGl0eSBpdHNlbGYgaXMgR3JhcGhpY3Mg4oaSIGV4dHJhY3QgZnJvbSBpdFxuICAgIGlmIChlbnRpdHkgaW5zdGFuY2VvZiBQSVhJLkdyYXBoaWNzKSB7XG4gICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZUdyYXBoaWNzU2hhcGUoZW50aXR5LCB0aGlzLndvcmxkKTtcbiAgICAgIHJldHVybiBwYXJzZWQuc2hhcGU7XG4gICAgfVxuXG4gICAgLy8gUHJpb3JpdHkgMzogTGVnYWN5IHNoYXBlIHByb3BlcnRpZXMgKGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zaGFwZSkge1xuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlU2hhcGVGcm9tVHlwZSh0aGlzLm9wdGlvbnMuc2hhcGUpO1xuICAgIH1cblxuICAgIC8vIE5vIGNvbGxpc2lvbiBzaGFwZSBkZWZpbmVkIC0gZXJyb3IgZm9yIG5vbi1HcmFwaGljcyBlbnRpdGllc1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICdDb2xsaXNpb24gc2hhcGUgcmVxdWlyZWQgZm9yIG5vbi1HcmFwaGljcyBlbnRpdGllcy4gJyArXG4gICAgICAnRWl0aGVyIHByb3ZpZGUgYSBHcmFwaGljcyBlbnRpdHksIG9yIHNwZWNpZnkgb3B0aW9ucy5jb2xsaXNpb25TaGFwZSwgJyArXG4gICAgICAnb3IgdXNlIGxlZ2FjeSBvcHRpb25zLnNoYXBlIHdpdGggZGltZW5zaW9ucy4nXG4gICAgKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBjcmVhdGVTaGFwZUZyb21UeXBlKHNoYXBlVHlwZTogU2hhcGVUeXBlKTogcGxhbmNrLlNoYXBlIHtcbiAgICBzd2l0Y2ggKHNoYXBlVHlwZSkge1xuICAgICAgY2FzZSAnY2lyY2xlJzpcbiAgICAgICAgY29uc3QgcmFkaXVzID0gdGhpcy5vcHRpb25zLnJhZGl1cyA/PyAyNTtcbiAgICAgICAgcmV0dXJuIHBsYW5jay5DaXJjbGUodGhpcy53b3JsZC50b1BoeXNpY3MocmFkaXVzKSk7XG5cbiAgICAgIGNhc2UgJ3JlY3RhbmdsZSc6XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5vcHRpb25zLndpZHRoID8/IDUwO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSB0aGlzLm9wdGlvbnMuaGVpZ2h0ID8/IDUwO1xuICAgICAgICByZXR1cm4gcGxhbmNrLkJveChcbiAgICAgICAgICB0aGlzLndvcmxkLnRvUGh5c2ljcyh3aWR0aCAvIDIpLFxuICAgICAgICAgIHRoaXMud29ybGQudG9QaHlzaWNzKGhlaWdodCAvIDIpXG4gICAgICAgICk7XG5cbiAgICAgIGNhc2UgJ3BvbHlnb24nOlxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy52ZXJ0aWNlcyB8fCB0aGlzLm9wdGlvbnMudmVydGljZXMubGVuZ3RoIDwgMykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUG9seWdvbiBzaGFwZSByZXF1aXJlcyBhdCBsZWFzdCAzIHZlcnRpY2VzJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLm9wdGlvbnMudmVydGljZXMubWFwKHYgPT5cbiAgICAgICAgICBwbGFuY2suVmVjMih0aGlzLndvcmxkLnRvUGh5c2ljcyh2LngpLCB0aGlzLndvcmxkLnRvUGh5c2ljcyh2LnkpKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gcGxhbmNrLlBvbHlnb24odmVydGljZXMpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gc2hhcGUgdHlwZTogJHtzaGFwZVR5cGV9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCBGYWxsYmFjazogY3JlYXRlcyBib3ggZnJvbSBlbnRpdHkgYm91bmRzLiAqL1xuICBwcml2YXRlIGF1dG9EZXRlY3RTaGFwZShlbnRpdHk6IFBJWEkuQ29udGFpbmVyKTogcGxhbmNrLlNoYXBlIHtcbiAgICAvLyBGb3Igc3ByaXRlcywgdXNlIHRleHR1cmUgYm91bmRzXG4gICAgY29uc3QgYm91bmRzID0gZW50aXR5LmdldExvY2FsQm91bmRzKCk7XG5cbiAgICAvLyBEZWZhdWx0IHRvIHJlY3RhbmdsZVxuICAgIHJldHVybiBwbGFuY2suQm94KFxuICAgICAgdGhpcy53b3JsZC50b1BoeXNpY3MoYm91bmRzLndpZHRoIC8gMiksXG4gICAgICB0aGlzLndvcmxkLnRvUGh5c2ljcyhib3VuZHMuaGVpZ2h0IC8gMilcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5IGNvbnRpbnVvdXMgZm9yY2UgYXQgYSBwb2ludC4gRm9yY2UgaXMgaW4gcGl4ZWxzL3NlY8KyLlxuICAgKiBAcGFyYW0gZm9yY2UgLSBGb3JjZSB2ZWN0b3IgaW4gcGl4ZWxzXG4gICAqIEBwYXJhbSBwb2ludCAtIEFwcGxpY2F0aW9uIHBvaW50IChkZWZhdWx0cyB0byBjZW50ZXIgb2YgbWFzcylcbiAgICovXG4gIGFwcGx5Rm9yY2UoZm9yY2U6IFBJWEkuUG9pbnQsIHBvaW50PzogUElYSS5Qb2ludCk6IHZvaWQge1xuICAgIGNvbnN0IGZvcmNlVmVjID0gdGhpcy53b3JsZC50b1BoeXNpY3NQb2ludChmb3JjZSk7XG4gICAgY29uc3QgcG9pbnRWZWMgPSBwb2ludFxuICAgICAgPyB0aGlzLndvcmxkLnRvUGh5c2ljc1BvaW50KHBvaW50KVxuICAgICAgOiB0aGlzLmJvZHkuZ2V0V29ybGRDZW50ZXIoKTtcbiAgICB0aGlzLmJvZHkuYXBwbHlGb3JjZShmb3JjZVZlYywgcG9pbnRWZWMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5IGluc3RhbnQgaW1wdWxzZSBhdCBhIHBvaW50LiBHb29kIGZvciBqdW1wcywgZXhwbG9zaW9ucy5cbiAgICogQHBhcmFtIGltcHVsc2UgLSBJbXB1bHNlIHZlY3RvciBpbiBwaXhlbHNcbiAgICogQHBhcmFtIHBvaW50IC0gQXBwbGljYXRpb24gcG9pbnQgKGRlZmF1bHRzIHRvIGNlbnRlciBvZiBtYXNzKVxuICAgKi9cbiAgYXBwbHlJbXB1bHNlKGltcHVsc2U6IFBJWEkuUG9pbnQsIHBvaW50PzogUElYSS5Qb2ludCk6IHZvaWQge1xuICAgIGNvbnN0IGltcHVsc2VWZWMgPSB0aGlzLndvcmxkLnRvUGh5c2ljc1BvaW50KGltcHVsc2UpO1xuICAgIGNvbnN0IHBvaW50VmVjID0gcG9pbnRcbiAgICAgID8gdGhpcy53b3JsZC50b1BoeXNpY3NQb2ludChwb2ludClcbiAgICAgIDogdGhpcy5ib2R5LmdldFdvcmxkQ2VudGVyKCk7XG4gICAgdGhpcy5ib2R5LmFwcGx5TGluZWFySW1wdWxzZShpbXB1bHNlVmVjLCBwb2ludFZlYyk7XG4gIH1cblxuICAvKiogQXBwbHkgcm90YXRpb25hbCB0b3JxdWUuICovXG4gIGFwcGx5VG9ycXVlKHRvcnF1ZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5ib2R5LmFwcGx5VG9ycXVlKHRvcnF1ZSk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IGxpbmVhciB2ZWxvY2l0eSBkaXJlY3RseS5cbiAgICogQHBhcmFtIHZlbG9jaXR5IC0gVmVsb2NpdHkgaW4gcGl4ZWxzL3NlY1xuICAgKi9cbiAgc2V0VmVsb2NpdHkodmVsb2NpdHk6IFBJWEkuUG9pbnQpOiB2b2lkIHtcbiAgICBjb25zdCB2ZWxvY2l0eVZlYyA9IHRoaXMud29ybGQudG9QaHlzaWNzUG9pbnQodmVsb2NpdHkpO1xuICAgIHRoaXMuYm9keS5zZXRMaW5lYXJWZWxvY2l0eSh2ZWxvY2l0eVZlYyk7XG4gIH1cblxuICAvKiogU2V0IHJvdGF0aW9uIHNwZWVkIChyYWRpYW5zL3NlYykuICovXG4gIHNldEFuZ3VsYXJWZWxvY2l0eShvbWVnYTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5ib2R5LnNldEFuZ3VsYXJWZWxvY2l0eShvbWVnYSk7XG4gIH1cblxuICAvKiogR2V0IGN1cnJlbnQgdmVsb2NpdHkgKHBpeGVscy9zZWMpLiAqL1xuICBnZXRWZWxvY2l0eSgpOiBQSVhJLlBvaW50IHtcbiAgICBjb25zdCB2ZWwgPSB0aGlzLmJvZHkuZ2V0TGluZWFyVmVsb2NpdHkoKTtcbiAgICByZXR1cm4gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHZlbCk7XG4gIH1cblxuICAvKiogR2V0IHJvdGF0aW9uIHNwZWVkIChyYWRpYW5zL3NlYykuICovXG4gIGdldEFuZ3VsYXJWZWxvY2l0eSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmJvZHkuZ2V0QW5ndWxhclZlbG9jaXR5KCk7XG4gIH1cblxuICAvKiogR2V0IGJvZHkgbWFzcyAoa2cgaW4gcGh5c2ljcyB1bml0cykuICovXG4gIGdldE1hc3MoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5ib2R5LmdldE1hc3MoKTtcbiAgfVxuXG4gIC8qKiBUcnVlIGlmIGJvZHkgaXMgYWN0aXZlIChub3Qgc2xlZXBpbmcpLiAqL1xuICBpc0F3YWtlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmJvZHkuaXNBd2FrZSgpO1xuICB9XG5cbiAgLyoqIFRydWUgaWYgYm9keSBpcyBzbGVlcGluZyAoaW5hY3RpdmUpLiAqL1xuICBpc1NsZWVwaW5nKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhdGhpcy5ib2R5LmlzQXdha2UoKTtcbiAgfVxuXG4gIC8qKiBXYWtlIHVwIG9yIHB1dCBib2R5IHRvIHNsZWVwLiAqL1xuICBzZXRBd2FrZShhd2FrZTogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuYm9keS5zZXRBd2FrZShhd2FrZSk7XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgKiBhcyBwbGFuY2sgZnJvbSAncGxhbmNrJztcbmltcG9ydCB0eXBlIHsgQ29sbGlzaW9uVGFnLCBDb2xsaXNpb25FdmVudCB9IGZyb20gJy4vcGh5c2ljcy10eXBlcyc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NXb3JsZCB9IGZyb20gJy4vcGh5c2ljcy13b3JsZCc7XG5cbi8qKlxuICogVGFnLXRvLWJpdG1hc2sgY29udmVydGVyIGZvciBjb2xsaXNpb24gZmlsdGVyaW5nLlxuICogQXV0by1yZWdpc3RlcnMgdGFncyBvbiBmaXJzdCB1c2UuIE1heCAxNiB1bmlxdWUgdGFncy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIC8vIFRhZ3MgYXJlIGF1dG8tcmVnaXN0ZXJlZCwgbm8gY29uZmlnIG5lZWRlZFxuICogY29uc3QgYml0cyA9IHJlZ2lzdHJ5LnRhZ3NUb0JpdHMoWydwbGF5ZXInLCAnZW5lbXknXSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIENvbGxpc2lvblJlZ2lzdHJ5IHtcbiAgcHJpdmF0ZSB0YWdUb0JpdDogTWFwPENvbGxpc2lvblRhZywgbnVtYmVyPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBiaXRUb1RhZzogTWFwPG51bWJlciwgQ29sbGlzaW9uVGFnPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBuZXh0Qml0OiBudW1iZXIgPSAxO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8vIFByZS1yZWdpc3RlciAnZGVmYXVsdCcgdGFnXG4gICAgdGhpcy5yZWdpc3RlcignZGVmYXVsdCcpO1xuICB9XG5cbiAgLyoqIFJlZ2lzdGVyIHRhZyBtYW51YWxseS4gQ2FsbGVkIGF1dG9tYXRpY2FsbHkgYnkgZ2V0Qml0KCkuICovXG4gIHJlZ2lzdGVyKHRhZzogQ29sbGlzaW9uVGFnKTogdm9pZCB7XG4gICAgaWYgKHRoaXMudGFnVG9CaXQuaGFzKHRhZykpIHJldHVybjtcblxuICAgIGlmICh0aGlzLm5leHRCaXQgPiAweDgwMDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWF4aW11bSBjb2xsaXNpb24gdGFncyByZWFjaGVkICgxNiB0YWdzKScpO1xuICAgIH1cblxuICAgIHRoaXMudGFnVG9CaXQuc2V0KHRhZywgdGhpcy5uZXh0Qml0KTtcbiAgICB0aGlzLmJpdFRvVGFnLnNldCh0aGlzLm5leHRCaXQsIHRhZyk7XG4gICAgdGhpcy5uZXh0Qml0IDw8PSAxO1xuICB9XG5cbiAgLyoqIEdldCBiaXRtYXNrIGZvciB0YWcuIEF1dG8tcmVnaXN0ZXJzIG5ldyB0YWdzLiAqL1xuICBnZXRCaXQodGFnOiBDb2xsaXNpb25UYWcpOiBudW1iZXIge1xuICAgIGlmICghdGhpcy50YWdUb0JpdC5oYXModGFnKSkge1xuICAgICAgdGhpcy5yZWdpc3Rlcih0YWcpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy50YWdUb0JpdC5nZXQodGFnKSE7XG4gIH1cblxuICAvKiogUmV2ZXJzZSBsb29rdXA6IGJpdCDihpIgdGFnLiAqL1xuICBnZXRUYWcoYml0OiBudW1iZXIpOiBDb2xsaXNpb25UYWcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmJpdFRvVGFnLmdldChiaXQpO1xuICB9XG5cbiAgLyoqIENvbnZlcnQgWydwbGF5ZXInLCAnZW5lbXknXSDihpIgY29tYmluZWQgYml0bWFzay4gKi9cbiAgdGFnc1RvQml0cyh0YWdzOiBDb2xsaXNpb25UYWdbXSk6IG51bWJlciB7XG4gICAgaWYgKCF0YWdzIHx8IHRhZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRCaXQoJ2RlZmF1bHQnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRhZ3MucmVkdWNlKChiaXRzLCB0YWcpID0+IGJpdHMgfCB0aGlzLmdldEJpdCh0YWcpLCAwKTtcbiAgfVxuXG4gIC8qKiBDb252ZXJ0IGJpdG1hc2sg4oaSIHRhZyBhcnJheS4gKi9cbiAgYml0c1RvVGFncyhiaXRzOiBudW1iZXIpOiBDb2xsaXNpb25UYWdbXSB7XG4gICAgY29uc3QgdGFnczogQ29sbGlzaW9uVGFnW10gPSBbXTtcbiAgICBmb3IgKGNvbnN0IFtiaXQsIHRhZ10gb2YgdGhpcy5iaXRUb1RhZykge1xuICAgICAgaWYgKGJpdHMgJiBiaXQpIHtcbiAgICAgICAgdGFncy5wdXNoKHRhZyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YWdzO1xuICB9XG59XG5cbi8qKiBAaW50ZXJuYWwgUGh5c2ljcyBib2R5IHVzZXIgZGF0YSBzdHJ1Y3R1cmUuICovXG5pbnRlcmZhY2UgUGh5c2ljc0JvZHlVc2VyRGF0YSB7XG4gIG9wdGlvbnM6IHtcbiAgICBjb2xsaXNpb25UYWdzPzogQ29sbGlzaW9uVGFnW107XG4gIH07XG4gIG9uQ29sbGlzaW9uQmVnaW4/OiAob3RoZXI6IFBoeXNpY3NCb2R5VXNlckRhdGEsIGNvbnRhY3Q6IHBsYW5jay5Db250YWN0KSA9PiB2b2lkO1xuICBvbkNvbGxpc2lvbkVuZD86IChvdGhlcjogUGh5c2ljc0JvZHlVc2VyRGF0YSwgY29udGFjdDogcGxhbmNrLkNvbnRhY3QpID0+IHZvaWQ7XG59XG5cbi8qKiBAaW50ZXJuYWwgVHlwZSBndWFyZCBmb3IgYm9keSB1c2VyIGRhdGEuICovXG5mdW5jdGlvbiBpc1BoeXNpY3NCb2R5VXNlckRhdGEob2JqOiB1bmtub3duKTogb2JqIGlzIFBoeXNpY3NCb2R5VXNlckRhdGEge1xuICByZXR1cm4gKFxuICAgIG9iaiAhPT0gbnVsbCAmJlxuICAgIHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmXG4gICAgJ29wdGlvbnMnIGluIG9iaiAmJlxuICAgIHR5cGVvZiAob2JqIGFzIGFueSkub3B0aW9ucyA9PT0gJ29iamVjdCdcbiAgKTtcbn1cblxuLyoqXG4gKiBNYW5hZ2VzIHRhZy1iYXNlZCBjb2xsaXNpb24gY2FsbGJhY2tzIGJldHdlZW4gcGh5c2ljcyBib2RpZXMuXG4gKiBSZWdpc3RlciBjYWxsYmFja3MgZm9yIHNwZWNpZmljIHRhZyBwYWlycyB0byBoYW5kbGUgY29sbGlzaW9ucy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIC8vIFJlZ2lzdGVyIGNvbGxpc2lvbiBoYW5kbGVyXG4gKiBwaHlzaWNzV29ybGQuY29sbGlzaW9uTWFuYWdlci5vbkNvbGxpc2lvbigncGxheWVyJywgJ2VuZW15JywgKGV2ZW50KSA9PiB7XG4gKiAgIGNvbnNvbGUubG9nKCdQbGF5ZXIgaGl0IGVuZW15IScpO1xuICogICBjb25zdCBwbGF5ZXJCb2R5ID0gZXZlbnQuYm9keUE7XG4gKiAgIGNvbnN0IGVuZW15Qm9keSA9IGV2ZW50LmJvZHlCO1xuICogfSk7XG4gKlxuICogLy8gTXVsdGlwbGUgdGFnIGNvbWJpbmF0aW9uc1xuICogcGh5c2ljc1dvcmxkLmNvbGxpc2lvbk1hbmFnZXIub25Db2xsaXNpb24oJ3Byb2plY3RpbGUnLCAnZW5lbXknLCAoZSkgPT4ge1xuICogICBlLmJvZHlCLmRlc3Ryb3koKTsgLy8gRGVzdHJveSBlbmVteVxuICogfSk7XG4gKlxuICogLy8gUmVtb3ZlIGNhbGxiYWNrXG4gKiBwaHlzaWNzV29ybGQuY29sbGlzaW9uTWFuYWdlci5vZmZDb2xsaXNpb24oJ3BsYXllcicsICdlbmVteScsIGhhbmRsZXIpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBDb2xsaXNpb25NYW5hZ2VyIHtcbiAgcHJpdmF0ZSB3b3JsZDogUGh5c2ljc1dvcmxkO1xuICBwcml2YXRlIHJlZ2lzdHJ5OiBDb2xsaXNpb25SZWdpc3RyeTtcbiAgcHJpdmF0ZSBjYWxsYmFja3M6IE1hcDxzdHJpbmcsIFNldDwoZXZlbnQ6IENvbGxpc2lvbkV2ZW50KSA9PiB2b2lkPj4gPSBuZXcgTWFwKCk7XG5cbiAgY29uc3RydWN0b3Iod29ybGQ6IFBoeXNpY3NXb3JsZCwgcmVnaXN0cnk6IENvbGxpc2lvblJlZ2lzdHJ5KSB7XG4gICAgdGhpcy53b3JsZCA9IHdvcmxkO1xuICAgIHRoaXMucmVnaXN0cnkgPSByZWdpc3RyeTtcbiAgICB0aGlzLnNldHVwTGlzdGVuZXJzKCk7XG4gIH1cblxuICBwcml2YXRlIHNldHVwTGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIHRoaXMud29ybGQud29ybGQub24oJ2JlZ2luLWNvbnRhY3QnLCAoY29udGFjdDogcGxhbmNrLkNvbnRhY3QpID0+IHtcbiAgICAgIHRoaXMuaGFuZGxlQmVnaW5Db250YWN0KGNvbnRhY3QpO1xuICAgIH0pO1xuXG4gICAgdGhpcy53b3JsZC53b3JsZC5vbignZW5kLWNvbnRhY3QnLCAoY29udGFjdDogcGxhbmNrLkNvbnRhY3QpID0+IHtcbiAgICAgIHRoaXMuaGFuZGxlRW5kQ29udGFjdChjb250YWN0KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBSZWdpc3RlciBjYWxsYmFjayBmb3IgY29sbGlzaW9ucyBiZXR3ZWVuIHR3byB0YWdzLiAqL1xuICBvbkNvbGxpc2lvbihcbiAgICB0YWdBOiBDb2xsaXNpb25UYWcsXG4gICAgdGFnQjogQ29sbGlzaW9uVGFnLFxuICAgIGNhbGxiYWNrOiAoZXZlbnQ6IENvbGxpc2lvbkV2ZW50KSA9PiB2b2lkXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGtleSA9IHRoaXMubWFrZUtleSh0YWdBLCB0YWdCKTtcbiAgICBpZiAoIXRoaXMuY2FsbGJhY2tzLmhhcyhrZXkpKSB7XG4gICAgICB0aGlzLmNhbGxiYWNrcy5zZXQoa2V5LCBuZXcgU2V0KCkpO1xuICAgIH1cbiAgICB0aGlzLmNhbGxiYWNrcy5nZXQoa2V5KSEuYWRkKGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKiBSZW1vdmUgY29sbGlzaW9uIGNhbGxiYWNrLiAqL1xuICBvZmZDb2xsaXNpb24oXG4gICAgdGFnQTogQ29sbGlzaW9uVGFnLFxuICAgIHRhZ0I6IENvbGxpc2lvblRhZyxcbiAgICBjYWxsYmFjazogKGV2ZW50OiBDb2xsaXNpb25FdmVudCkgPT4gdm9pZFxuICApOiB2b2lkIHtcbiAgICBjb25zdCBrZXkgPSB0aGlzLm1ha2VLZXkodGFnQSwgdGFnQik7XG4gICAgdGhpcy5jYWxsYmFja3MuZ2V0KGtleSk/LmRlbGV0ZShjYWxsYmFjayk7XG4gIH1cblxuICBwcml2YXRlIG1ha2VLZXkodGFnQTogQ29sbGlzaW9uVGFnLCB0YWdCOiBDb2xsaXNpb25UYWcpOiBzdHJpbmcge1xuICAgIC8vIFNvcnQgdGFncyB0byBlbnN1cmUgY29uc2lzdGVudCBrZXkgcmVnYXJkbGVzcyBvZiBvcmRlclxuICAgIHJldHVybiB0YWdBIDwgdGFnQiA/IGAke3RhZ0F9OiR7dGFnQn1gIDogYCR7dGFnQn06JHt0YWdBfWA7XG4gIH1cblxuICAvLyBUcmlnZ2VyIGNhbGxiYWNrc1xuICBwcml2YXRlIGhhbmRsZUJlZ2luQ29udGFjdChjb250YWN0OiBwbGFuY2suQ29udGFjdCk6IHZvaWQge1xuICAgIGNvbnN0IGJvZHlBID0gY29udGFjdC5nZXRGaXh0dXJlQSgpLmdldEJvZHkoKS5nZXRVc2VyRGF0YSgpO1xuICAgIGNvbnN0IGJvZHlCID0gY29udGFjdC5nZXRGaXh0dXJlQigpLmdldEJvZHkoKS5nZXRVc2VyRGF0YSgpO1xuXG4gICAgaWYgKCFpc1BoeXNpY3NCb2R5VXNlckRhdGEoYm9keUEpIHx8ICFpc1BoeXNpY3NCb2R5VXNlckRhdGEoYm9keUIpKSByZXR1cm47XG5cbiAgICAvLyBDYWxsIGVudGl0eS1sZXZlbCBjYWxsYmFja3NcbiAgICBib2R5QS5vbkNvbGxpc2lvbkJlZ2luPy4oYm9keUIsIGNvbnRhY3QpO1xuICAgIGJvZHlCLm9uQ29sbGlzaW9uQmVnaW4/Lihib2R5QSwgY29udGFjdCk7XG5cbiAgICAvLyBDYWxsIGdsb2JhbCB0YWctYmFzZWQgY2FsbGJhY2tzXG4gICAgdGhpcy50cmlnZ2VyVGFnQ2FsbGJhY2tzKGJvZHlBLCBib2R5QiwgY29udGFjdCk7XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZUVuZENvbnRhY3QoY29udGFjdDogcGxhbmNrLkNvbnRhY3QpOiB2b2lkIHtcbiAgICBjb25zdCBib2R5QSA9IGNvbnRhY3QuZ2V0Rml4dHVyZUEoKS5nZXRCb2R5KCkuZ2V0VXNlckRhdGEoKTtcbiAgICBjb25zdCBib2R5QiA9IGNvbnRhY3QuZ2V0Rml4dHVyZUIoKS5nZXRCb2R5KCkuZ2V0VXNlckRhdGEoKTtcblxuICAgIGlmICghaXNQaHlzaWNzQm9keVVzZXJEYXRhKGJvZHlBKSB8fCAhaXNQaHlzaWNzQm9keVVzZXJEYXRhKGJvZHlCKSkgcmV0dXJuO1xuXG4gICAgYm9keUEub25Db2xsaXNpb25FbmQ/Lihib2R5QiwgY29udGFjdCk7XG4gICAgYm9keUIub25Db2xsaXNpb25FbmQ/Lihib2R5QSwgY29udGFjdCk7XG4gIH1cblxuICBwcml2YXRlIHRyaWdnZXJUYWdDYWxsYmFja3MoXG4gICAgYm9keUE6IFBoeXNpY3NCb2R5VXNlckRhdGEsXG4gICAgYm9keUI6IFBoeXNpY3NCb2R5VXNlckRhdGEsXG4gICAgY29udGFjdDogcGxhbmNrLkNvbnRhY3RcbiAgKTogdm9pZCB7XG4gICAgLy8gR2V0IHRhZ3MgZnJvbSBib3RoIGJvZGllc1xuICAgIGNvbnN0IHRhZ3NBID0gYm9keUEub3B0aW9ucy5jb2xsaXNpb25UYWdzIHx8IFtdO1xuICAgIGNvbnN0IHRhZ3NCID0gYm9keUIub3B0aW9ucy5jb2xsaXNpb25UYWdzIHx8IFtdO1xuXG4gICAgLy8gQ2hlY2sgYWxsIHRhZyBjb21iaW5hdGlvbnNcbiAgICBmb3IgKGNvbnN0IHRhZ0Egb2YgdGFnc0EpIHtcbiAgICAgIGZvciAoY29uc3QgdGFnQiBvZiB0YWdzQikge1xuICAgICAgICBjb25zdCBrZXkgPSB0aGlzLm1ha2VLZXkodGFnQSwgdGFnQik7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9IHRoaXMuY2FsbGJhY2tzLmdldChrZXkpO1xuXG4gICAgICAgIGlmIChjYWxsYmFja3MpIHtcbiAgICAgICAgICBjb25zdCBldmVudDogQ29sbGlzaW9uRXZlbnQgPSB7XG4gICAgICAgICAgICBib2R5QSxcbiAgICAgICAgICAgIGJvZHlCLFxuICAgICAgICAgICAgY29udGFjdCxcbiAgICAgICAgICAgIG5vcm1hbDogbmV3IFBJWEkuUG9pbnQoMCwgMCksIC8vIFRPRE86IEV4dHJhY3QgZnJvbSBjb250YWN0XG4gICAgICAgICAgICBpbXB1bHNlOiAwIC8vIFRPRE86IEV4dHJhY3QgZnJvbSBjb250YWN0XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGNhbGxiYWNrcy5mb3JFYWNoKGNiID0+IGNiKGV2ZW50KSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgKiBhcyBwbGFuY2sgZnJvbSAncGxhbmNrJztcbmltcG9ydCB7IExvZ2ljIH0gZnJvbSAnLi4vLi4vY29yZS9sb2dpYyc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NXb3JsZCB9IGZyb20gJy4vcGh5c2ljcy13b3JsZCc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NEZWJ1Z09wdGlvbnMgfSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuXG4vKipcbiAqIFJlbmRlcnMgcGh5c2ljcyBjb2xsaXNpb24gc2hhcGVzLCB2ZWxvY2l0aWVzLCBBQUJCcyBmb3IgZGVidWdnaW5nLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3QgZGVidWcgPSBwaHlzaWNzV29ybGQuZW5hYmxlRGVidWdSZW5kZXJlcihzY2VuZSk7XG4gKiBkZWJ1Zy50b2dnbGUoKTsgLy8gVG9nZ2xlIHZpc2liaWxpdHlcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgUGh5c2ljc0RlYnVnUmVuZGVyZXIgZXh0ZW5kcyBMb2dpYzxQSVhJLkdyYXBoaWNzPiB7XG4gIG5hbWUgPSAnUGh5c2ljc0RlYnVnUmVuZGVyZXInO1xuXG4gIHByaXZhdGUgd29ybGQ6IFBoeXNpY3NXb3JsZDtcbiAgcHJpdmF0ZSBncmFwaGljcyE6IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgb3B0aW9uczogUmVxdWlyZWQ8UGh5c2ljc0RlYnVnT3B0aW9ucz47XG4gIHByaXZhdGUgaXNWaXNpYmxlOiBib29sZWFuID0gdHJ1ZTtcblxuICBjb25zdHJ1Y3Rvcih3b3JsZDogUGh5c2ljc1dvcmxkLCBvcHRpb25zOiBQaHlzaWNzRGVidWdPcHRpb25zID0ge30pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMud29ybGQgPSB3b3JsZDtcbiAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICBzaG93U2hhcGVzOiBvcHRpb25zLnNob3dTaGFwZXMgPz8gdHJ1ZSxcbiAgICAgIHNob3dWZWxvY2l0aWVzOiBvcHRpb25zLnNob3dWZWxvY2l0aWVzID8/IGZhbHNlLFxuICAgICAgc2hvd0FBQkJzOiBvcHRpb25zLnNob3dBQUJCcyA/PyBmYWxzZSxcbiAgICAgIHNob3dDZW50ZXJPZk1hc3M6IG9wdGlvbnMuc2hvd0NlbnRlck9mTWFzcyA/PyBmYWxzZSxcbiAgICAgIHNob3dDb250YWN0UG9pbnRzOiBvcHRpb25zLnNob3dDb250YWN0UG9pbnRzID8/IGZhbHNlLFxuICAgICAgc2hvd0pvaW50czogb3B0aW9ucy5zaG93Sm9pbnRzID8/IGZhbHNlLFxuICAgICAgY29sb3JTdGF0aWM6IG9wdGlvbnMuY29sb3JTdGF0aWMgPz8gMHgwMEZGMDAsXG4gICAgICBjb2xvckR5bmFtaWM6IG9wdGlvbnMuY29sb3JEeW5hbWljID8/IDB4RkYwMDAwLFxuICAgICAgY29sb3JLaW5lbWF0aWM6IG9wdGlvbnMuY29sb3JLaW5lbWF0aWMgPz8gMHgwMDAwRkYsXG4gICAgICBjb2xvclNsZWVwaW5nOiBvcHRpb25zLmNvbG9yU2xlZXBpbmcgPz8gMHhBQUFBQUEsXG4gICAgICBjb2xvclNlbnNvcjogb3B0aW9ucy5jb2xvclNlbnNvciA/PyAweEZGRkYwMCxcbiAgICAgIGFscGhhOiBvcHRpb25zLmFscGhhID8/IDAuNSxcbiAgICAgIGxpbmVXaWR0aDogb3B0aW9ucy5saW5lV2lkdGggPz8gMlxuICAgIH07XG4gIH1cblxuICBpbml0KGVudGl0eTogUElYSS5HcmFwaGljcywgcmVuZGVyZXI/OiBQSVhJLlJlbmRlcmVyKTogdm9pZCB7XG4gICAgdGhpcy5ncmFwaGljcyA9IGVudGl0eTtcbiAgfVxuXG4gIHVwZGF0ZShlbnRpdHk6IFBJWEkuR3JhcGhpY3MsIGRlbHRhVGltZT86IG51bWJlcik6IHZvaWQge1xuICAgIGlmICghdGhpcy5pc1Zpc2libGUpIHtcbiAgICAgIHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmdyYXBoaWNzLmNsZWFyKCk7XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnNob3dTaGFwZXMpIHtcbiAgICAgIC8vIEl0ZXJhdGUgYWxsIGJvZGllcyBpbiBwaHlzaWNzIHdvcmxkXG4gICAgICBmb3IgKGxldCBib2R5ID0gdGhpcy53b3JsZC53b3JsZC5nZXRCb2R5TGlzdCgpOyBib2R5OyBib2R5ID0gYm9keS5nZXROZXh0KCkpIHtcbiAgICAgICAgdGhpcy5kcmF3Qm9keShib2R5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnNob3dDb250YWN0UG9pbnRzKSB7XG4gICAgICB0aGlzLmRyYXdDb250YWN0cygpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZHJhd0JvZHkoYm9keTogcGxhbmNrLkJvZHkpOiB2b2lkIHtcbiAgICBjb25zdCB0cmFuc2Zvcm0gPSBib2R5LmdldFRyYW5zZm9ybSgpO1xuXG4gICAgLy8gRGV0ZXJtaW5lIGNvbG9yIGJhc2VkIG9uIGJvZHkgdHlwZSBhbmQgc3RhdGVcbiAgICBsZXQgY29sb3I6IG51bWJlcjtcblxuICAgIGlmICghYm9keS5pc0F3YWtlKCkgJiYgYm9keS5pc0R5bmFtaWMoKSkge1xuICAgICAgY29sb3IgPSB0aGlzLm9wdGlvbnMuY29sb3JTbGVlcGluZztcbiAgICB9IGVsc2UgaWYgKGJvZHkuaXNTdGF0aWMoKSkge1xuICAgICAgY29sb3IgPSB0aGlzLm9wdGlvbnMuY29sb3JTdGF0aWM7XG4gICAgfSBlbHNlIGlmIChib2R5LmlzS2luZW1hdGljKCkpIHtcbiAgICAgIGNvbG9yID0gdGhpcy5vcHRpb25zLmNvbG9yS2luZW1hdGljO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb2xvciA9IHRoaXMub3B0aW9ucy5jb2xvckR5bmFtaWM7XG4gICAgfVxuXG4gICAgLy8gRHJhdyBlYWNoIGZpeHR1cmVcbiAgICBmb3IgKGxldCBmaXh0dXJlID0gYm9keS5nZXRGaXh0dXJlTGlzdCgpOyBmaXh0dXJlOyBmaXh0dXJlID0gZml4dHVyZS5nZXROZXh0KCkpIHtcbiAgICAgIGNvbnN0IHNoYXBlID0gZml4dHVyZS5nZXRTaGFwZSgpO1xuXG4gICAgICAvLyBVc2UgeWVsbG93IHNlbWktdHJhbnNwYXJlbnQgZm9yIHNlbnNvcnNcbiAgICAgIGNvbnN0IGZpeHR1cmVDb2xvciA9IGZpeHR1cmUuaXNTZW5zb3IoKSA/IHRoaXMub3B0aW9ucy5jb2xvclNlbnNvciA6IGNvbG9yO1xuICAgICAgY29uc3QgYWxwaGEgPSBmaXh0dXJlLmlzU2Vuc29yKCkgPyB0aGlzLm9wdGlvbnMuYWxwaGEgKiAwLjUgOiB0aGlzLm9wdGlvbnMuYWxwaGE7XG5cbiAgICAgIHRoaXMuZHJhd1NoYXBlKHNoYXBlLCB0cmFuc2Zvcm0sIGZpeHR1cmVDb2xvciwgYWxwaGEpO1xuICAgIH1cblxuICAgIC8vIERyYXcgdmVsb2NpdHkgdmVjdG9yIGlmIGVuYWJsZWRcbiAgICBpZiAodGhpcy5vcHRpb25zLnNob3dWZWxvY2l0aWVzICYmIGJvZHkuaXNEeW5hbWljKCkpIHtcbiAgICAgIHRoaXMuZHJhd1ZlbG9jaXR5KGJvZHkpO1xuICAgIH1cblxuICAgIC8vIERyYXcgQUFCQiBpZiBlbmFibGVkXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zaG93QUFCQnMpIHtcbiAgICAgIHRoaXMuZHJhd0FBQkIoYm9keSk7XG4gICAgfVxuXG4gICAgLy8gRHJhdyBjZW50ZXIgb2YgbWFzcyBpZiBlbmFibGVkXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zaG93Q2VudGVyT2ZNYXNzKSB7XG4gICAgICB0aGlzLmRyYXdDZW50ZXJPZk1hc3MoYm9keSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBkcmF3U2hhcGUoc2hhcGU6IHBsYW5jay5TaGFwZSwgdHJhbnNmb3JtOiBwbGFuY2suVHJhbnNmb3JtLCBjb2xvcjogbnVtYmVyLCBhbHBoYTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5ncmFwaGljcy5zdHJva2Uoe1xuICAgICAgd2lkdGg6IHRoaXMub3B0aW9ucy5saW5lV2lkdGgsXG4gICAgICBjb2xvcjogY29sb3IsXG4gICAgICBhbHBoYTogYWxwaGFcbiAgICB9KTtcblxuICAgIGNvbnN0IHNoYXBlVHlwZSA9IHNoYXBlLmdldFR5cGUoKTtcblxuICAgIGlmIChzaGFwZVR5cGUgPT09ICdjaXJjbGUnKSB7XG4gICAgICBjb25zdCBjaXJjbGUgPSBzaGFwZSBhcyBwbGFuY2suQ2lyY2xlU2hhcGU7XG4gICAgICBjb25zdCBjZW50ZXIgPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgY2lyY2xlLmdldENlbnRlcigpKSk7XG4gICAgICBjb25zdCByYWRpdXMgPSBjaXJjbGUuZ2V0UmFkaXVzKCk7XG5cbiAgICAgIGNvbnN0IHBpeGVsQ2VudGVyID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KGNlbnRlcik7XG4gICAgICBjb25zdCBwaXhlbFJhZGl1cyA9IHRoaXMud29ybGQudG9QaXhlbHMocmFkaXVzKTtcblxuICAgICAgdGhpcy5ncmFwaGljcy5jaXJjbGUocGl4ZWxDZW50ZXIueCwgcGl4ZWxDZW50ZXIueSwgcGl4ZWxSYWRpdXMpO1xuICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcblxuICAgICAgLy8gRHJhdyByYWRpdXMgbGluZSB0byBzaG93IHJvdGF0aW9uXG4gICAgICBjb25zdCBhbmdsZSA9IHRyYW5zZm9ybS5xLmdldEFuZ2xlKCk7XG4gICAgICBjb25zdCBlbmRYID0gcGl4ZWxDZW50ZXIueCArIE1hdGguY29zKGFuZ2xlKSAqIHBpeGVsUmFkaXVzO1xuICAgICAgY29uc3QgZW5kWSA9IHBpeGVsQ2VudGVyLnkgKyBNYXRoLnNpbihhbmdsZSkgKiBwaXhlbFJhZGl1cztcbiAgICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsQ2VudGVyLngsIHBpeGVsQ2VudGVyLnkpO1xuICAgICAgdGhpcy5ncmFwaGljcy5saW5lVG8oZW5kWCwgZW5kWSk7XG4gICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xuICAgIH0gZWxzZSBpZiAoc2hhcGVUeXBlID09PSAncG9seWdvbicpIHtcbiAgICAgIGNvbnN0IHBvbHkgPSBzaGFwZSBhcyBwbGFuY2suUG9seWdvblNoYXBlO1xuICAgICAgY29uc3QgdmVydGljZXMgPSBwb2x5Lm1fdmVydGljZXM7XG5cbiAgICAgIGlmICh2ZXJ0aWNlcyAmJiB2ZXJ0aWNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIFRyYW5zZm9ybSBmaXJzdCB2ZXJ0ZXhcbiAgICAgICAgY29uc3QgZmlyc3RWZXJ0ZXggPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgdmVydGljZXNbMF0pKTtcbiAgICAgICAgY29uc3QgcGl4ZWxGaXJzdCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChmaXJzdFZlcnRleCk7XG5cbiAgICAgICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxGaXJzdC54LCBwaXhlbEZpcnN0LnkpO1xuXG4gICAgICAgIC8vIFRyYW5zZm9ybSBhbmQgZHJhdyByZW1haW5pbmcgdmVydGljZXNcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB2ZXJ0aWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IHZlcnRleCA9IHBsYW5jay5WZWMyLmFkZCh0cmFuc2Zvcm0ucCwgcGxhbmNrLlJvdC5tdWxWZWMyKHRyYW5zZm9ybS5xLCB2ZXJ0aWNlc1tpXSkpO1xuICAgICAgICAgIGNvbnN0IHBpeGVsVmVydGV4ID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHZlcnRleCk7XG4gICAgICAgICAgdGhpcy5ncmFwaGljcy5saW5lVG8ocGl4ZWxWZXJ0ZXgueCwgcGl4ZWxWZXJ0ZXgueSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDbG9zZSB0aGUgcG9seWdvblxuICAgICAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhwaXhlbEZpcnN0LngsIHBpeGVsRmlyc3QueSk7XG4gICAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzaGFwZVR5cGUgPT09ICdlZGdlJykge1xuICAgICAgY29uc3QgZWRnZSA9IHNoYXBlIGFzIHBsYW5jay5FZGdlU2hhcGU7XG4gICAgICBjb25zdCB2MSA9IHBsYW5jay5WZWMyLmFkZCh0cmFuc2Zvcm0ucCwgcGxhbmNrLlJvdC5tdWxWZWMyKHRyYW5zZm9ybS5xLCBlZGdlLm1fdmVydGV4MSkpO1xuICAgICAgY29uc3QgdjIgPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgZWRnZS5tX3ZlcnRleDIpKTtcblxuICAgICAgY29uc3QgcDEgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQodjEpO1xuICAgICAgY29uc3QgcDIgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQodjIpO1xuXG4gICAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwMS54LCBwMS55KTtcbiAgICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKHAyLngsIHAyLnkpO1xuICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcbiAgICB9IGVsc2UgaWYgKHNoYXBlVHlwZSA9PT0gJ2NoYWluJykge1xuICAgICAgY29uc3QgY2hhaW4gPSBzaGFwZSBhcyBwbGFuY2suQ2hhaW5TaGFwZTtcbiAgICAgIGNvbnN0IHZlcnRpY2VzID0gY2hhaW4ubV92ZXJ0aWNlcztcblxuICAgICAgaWYgKHZlcnRpY2VzICYmIHZlcnRpY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgZmlyc3RWZXJ0ZXggPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgdmVydGljZXNbMF0pKTtcbiAgICAgICAgY29uc3QgcGl4ZWxGaXJzdCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChmaXJzdFZlcnRleCk7XG4gICAgICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsRmlyc3QueCwgcGl4ZWxGaXJzdC55KTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgdmVydGV4ID0gcGxhbmNrLlZlYzIuYWRkKHRyYW5zZm9ybS5wLCBwbGFuY2suUm90Lm11bFZlYzIodHJhbnNmb3JtLnEsIHZlcnRpY2VzW2ldKSk7XG4gICAgICAgICAgY29uc3QgcGl4ZWxWZXJ0ZXggPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQodmVydGV4KTtcbiAgICAgICAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhwaXhlbFZlcnRleC54LCBwaXhlbFZlcnRleC55KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBkcmF3VmVsb2NpdHkoYm9keTogcGxhbmNrLkJvZHkpOiB2b2lkIHtcbiAgICBjb25zdCBwb3NpdGlvbiA9IGJvZHkuZ2V0UG9zaXRpb24oKTtcbiAgICBjb25zdCB2ZWxvY2l0eSA9IGJvZHkuZ2V0TGluZWFyVmVsb2NpdHkoKTtcblxuICAgIC8vIFNjYWxlIHZlbG9jaXR5IGZvciB2aXNpYmlsaXR5XG4gICAgY29uc3Qgc2NhbGUgPSAwLjU7XG4gICAgY29uc3QgZW5kUG9pbnQgPSBwbGFuY2suVmVjMi5hZGQocG9zaXRpb24sIHBsYW5jay5WZWMyLm11bCh2ZWxvY2l0eSwgc2NhbGUpKTtcblxuICAgIGNvbnN0IHBpeGVsU3RhcnQgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQocG9zaXRpb24pO1xuICAgIGNvbnN0IHBpeGVsRW5kID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KGVuZFBvaW50KTtcblxuICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKHtcbiAgICAgIHdpZHRoOiAyLFxuICAgICAgY29sb3I6IDB4MDBGRkZGLFxuICAgICAgYWxwaGE6IDAuOFxuICAgIH0pO1xuXG4gICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxTdGFydC54LCBwaXhlbFN0YXJ0LnkpO1xuICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKHBpeGVsRW5kLngsIHBpeGVsRW5kLnkpO1xuICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG5cbiAgICAvLyBEcmF3IGFycm93IGhlYWRcbiAgICBjb25zdCBhbmdsZSA9IE1hdGguYXRhbjIocGl4ZWxFbmQueSAtIHBpeGVsU3RhcnQueSwgcGl4ZWxFbmQueCAtIHBpeGVsU3RhcnQueCk7XG4gICAgY29uc3QgYXJyb3dTaXplID0gNTtcbiAgICBjb25zdCBhbmdsZTEgPSBhbmdsZSArIE1hdGguUEkgKiAwLjg7XG4gICAgY29uc3QgYW5nbGUyID0gYW5nbGUgLSBNYXRoLlBJICogMC44O1xuXG4gICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxFbmQueCwgcGl4ZWxFbmQueSk7XG4gICAgdGhpcy5ncmFwaGljcy5saW5lVG8oXG4gICAgICBwaXhlbEVuZC54ICsgTWF0aC5jb3MoYW5nbGUxKSAqIGFycm93U2l6ZSxcbiAgICAgIHBpeGVsRW5kLnkgKyBNYXRoLnNpbihhbmdsZTEpICogYXJyb3dTaXplXG4gICAgKTtcbiAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwaXhlbEVuZC54LCBwaXhlbEVuZC55KTtcbiAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhcbiAgICAgIHBpeGVsRW5kLnggKyBNYXRoLmNvcyhhbmdsZTIpICogYXJyb3dTaXplLFxuICAgICAgcGl4ZWxFbmQueSArIE1hdGguc2luKGFuZ2xlMikgKiBhcnJvd1NpemVcbiAgICApO1xuICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG4gIH1cblxuICBwcml2YXRlIGRyYXdBQUJCKGJvZHk6IHBsYW5jay5Cb2R5KTogdm9pZCB7XG4gICAgZm9yIChsZXQgZml4dHVyZSA9IGJvZHkuZ2V0Rml4dHVyZUxpc3QoKTsgZml4dHVyZTsgZml4dHVyZSA9IGZpeHR1cmUuZ2V0TmV4dCgpKSB7XG4gICAgICBjb25zdCBhYWJiID0gZml4dHVyZS5nZXRBQUJCKDApO1xuXG4gICAgICBjb25zdCBsb3dlckJvdW5kID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KGFhYmIubG93ZXJCb3VuZCk7XG4gICAgICBjb25zdCB1cHBlckJvdW5kID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KGFhYmIudXBwZXJCb3VuZCk7XG5cbiAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKHtcbiAgICAgICAgd2lkdGg6IDEsXG4gICAgICAgIGNvbG9yOiAweEZGMDBGRixcbiAgICAgICAgYWxwaGE6IDAuM1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuZ3JhcGhpY3MucmVjdChcbiAgICAgICAgbG93ZXJCb3VuZC54LFxuICAgICAgICBsb3dlckJvdW5kLnksXG4gICAgICAgIHVwcGVyQm91bmQueCAtIGxvd2VyQm91bmQueCxcbiAgICAgICAgdXBwZXJCb3VuZC55IC0gbG93ZXJCb3VuZC55XG4gICAgICApO1xuICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRyYXdDZW50ZXJPZk1hc3MoYm9keTogcGxhbmNrLkJvZHkpOiB2b2lkIHtcbiAgICBjb25zdCBwb3NpdGlvbiA9IGJvZHkuZ2V0V29ybGRDZW50ZXIoKTtcbiAgICBjb25zdCBwaXhlbFBvcyA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChwb3NpdGlvbik7XG5cbiAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSh7XG4gICAgICB3aWR0aDogMSxcbiAgICAgIGNvbG9yOiAweEZGRkZGRixcbiAgICAgIGFscGhhOiAxXG4gICAgfSk7XG5cbiAgICBjb25zdCBzaXplID0gNTtcbiAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwaXhlbFBvcy54IC0gc2l6ZSwgcGl4ZWxQb3MueSk7XG4gICAgdGhpcy5ncmFwaGljcy5saW5lVG8ocGl4ZWxQb3MueCArIHNpemUsIHBpeGVsUG9zLnkpO1xuICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsUG9zLngsIHBpeGVsUG9zLnkgLSBzaXplKTtcbiAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhwaXhlbFBvcy54LCBwaXhlbFBvcy55ICsgc2l6ZSk7XG4gICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcbiAgfVxuXG4gIHByaXZhdGUgZHJhd0NvbnRhY3RzKCk6IHZvaWQge1xuICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBhbGwgY29udGFjdHMgaW4gdGhlIHdvcmxkXG4gICAgZm9yIChsZXQgY29udGFjdCA9IHRoaXMud29ybGQud29ybGQuZ2V0Q29udGFjdExpc3QoKTsgY29udGFjdDsgY29udGFjdCA9IGNvbnRhY3QuZ2V0TmV4dCgpKSB7XG4gICAgICBpZiAoIWNvbnRhY3QuaXNUb3VjaGluZygpKSBjb250aW51ZTtcblxuICAgICAgY29uc3QgbWFuaWZvbGQgPSBjb250YWN0LmdldE1hbmlmb2xkKCk7XG4gICAgICBpZiAoIW1hbmlmb2xkKSBjb250aW51ZTtcblxuICAgICAgY29uc3Qgd29ybGRNYW5pZm9sZCA9IGNvbnRhY3QuZ2V0V29ybGRNYW5pZm9sZChudWxsKTtcbiAgICAgIGlmICghd29ybGRNYW5pZm9sZCkgY29udGludWU7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFuaWZvbGQucG9pbnRDb3VudDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHBvaW50ID0gd29ybGRNYW5pZm9sZC5wb2ludHNbaV07XG4gICAgICAgIGlmICghcG9pbnQpIGNvbnRpbnVlO1xuICAgICAgICBjb25zdCBwaXhlbFBvaW50ID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHBsYW5jay5WZWMyKHBvaW50LngsIHBvaW50LnkpKTtcblxuICAgICAgICB0aGlzLmdyYXBoaWNzLmNpcmNsZShwaXhlbFBvaW50LngsIHBpeGVsUG9pbnQueSwgMyk7XG4gICAgICAgIHRoaXMuZ3JhcGhpY3MuZmlsbCh7IGNvbG9yOiAweEZGMDAwMCwgYWxwaGE6IDAuOCB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKiogU2hvdyBvciBoaWRlIGRlYnVnIHZpc3VhbGl6YXRpb24uICovXG4gIHNldFZpc2libGUodmlzaWJsZTogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuaXNWaXNpYmxlID0gdmlzaWJsZTtcbiAgICBpZiAoIXZpc2libGUpIHtcbiAgICAgIHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcbiAgICB9XG4gIH1cblxuICAvKiogVG9nZ2xlIHZpc2liaWxpdHkuICovXG4gIHRvZ2dsZSgpOiB2b2lkIHtcbiAgICB0aGlzLnNldFZpc2libGUoIXRoaXMuaXNWaXNpYmxlKTtcbiAgfVxuXG4gIC8qKiBDaGVjayBjdXJyZW50IHZpc2liaWxpdHkuICovXG4gIGdldFZpc2libGUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaXNWaXNpYmxlO1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0ICogYXMgcGxhbmNrIGZyb20gJ3BsYW5jayc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NXb3JsZCB9IGZyb20gJy4vcGh5c2ljcy13b3JsZCc7XG5cbi8qKiBSZXN1bHQgZnJvbSBwYXJzZUdyYXBoaWNzU2hhcGUoKS4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUGFyc2VkU2hhcGUge1xuICB0eXBlOiAnY2lyY2xlJyB8ICdyZWN0YW5nbGUnIHwgJ3BvbHlnb24nO1xuICBzaGFwZTogcGxhbmNrLlNoYXBlO1xufVxuXG4vKiogQGludGVybmFsIE1ldGFkYXRhIHN0b3JlZCBvbiBHcmFwaGljcyBmb3IgcGh5c2ljcyBleHRyYWN0aW9uLiAqL1xuZXhwb3J0IGludGVyZmFjZSBQaHlzaWNzU2hhcGVNZXRhZGF0YSB7XG4gIHR5cGU6ICdjaXJjbGUnIHwgJ3JlY3RhbmdsZScgfCAncG9seWdvbic7XG4gIHJhZGl1cz86IG51bWJlcjtcbiAgd2lkdGg/OiBudW1iZXI7XG4gIGhlaWdodD86IG51bWJlcjtcbiAgdmVydGljZXM/OiBudW1iZXJbXTtcbn1cblxuY29uc3QgUEhZU0lDU19TSEFQRV9LRVkgPSAnX19waHlzaWNzU2hhcGVfXyc7XG5cbi8qKiBAaW50ZXJuYWwgQXR0YWNoIHNoYXBlIG1ldGFkYXRhIHRvIEdyYXBoaWNzLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldEdyYXBoaWNzUGh5c2ljc1NoYXBlKGdyYXBoaWNzOiBQSVhJLkdyYXBoaWNzLCBtZXRhZGF0YTogUGh5c2ljc1NoYXBlTWV0YWRhdGEpOiB2b2lkIHtcbiAgKGdyYXBoaWNzIGFzIGFueSlbUEhZU0lDU19TSEFQRV9LRVldID0gbWV0YWRhdGE7XG59XG5cbi8qKiBAaW50ZXJuYWwgUGF0Y2hlcyBQSVhJLkdyYXBoaWNzLnJlY3QvY2lyY2xlL3BvbHkgdG8gYXV0by10cmFjayBzaGFwZXMuIENhbGxlZCBvbmNlIGJ5IFBoeXNpY3NXb3JsZC4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0R3JhcGhpY3NQaHlzaWNzVHJhY2tpbmcoKTogdm9pZCB7XG4gIC8vIFNhdmUgb3JpZ2luYWwgbWV0aG9kc1xuICBjb25zdCBvcmlnaW5hbFJlY3QgPSBQSVhJLkdyYXBoaWNzLnByb3RvdHlwZS5yZWN0O1xuICBjb25zdCBvcmlnaW5hbENpcmNsZSA9IFBJWEkuR3JhcGhpY3MucHJvdG90eXBlLmNpcmNsZTtcbiAgY29uc3Qgb3JpZ2luYWxQb2x5ID0gUElYSS5HcmFwaGljcy5wcm90b3R5cGUucG9seTtcblxuICAvLyBQYXRjaCByZWN0KCkgdG8gc3RvcmUgbWV0YWRhdGFcbiAgUElYSS5HcmFwaGljcy5wcm90b3R5cGUucmVjdCA9IGZ1bmN0aW9uICh4OiBudW1iZXIsIHk6IG51bWJlciwgdzogbnVtYmVyLCBoOiBudW1iZXIpIHtcbiAgICBzZXRHcmFwaGljc1BoeXNpY3NTaGFwZSh0aGlzLCB7XG4gICAgICB0eXBlOiAncmVjdGFuZ2xlJyxcbiAgICAgIHdpZHRoOiB3LFxuICAgICAgaGVpZ2h0OiBoXG4gICAgfSk7XG4gICAgcmV0dXJuIG9yaWdpbmFsUmVjdC5jYWxsKHRoaXMsIHgsIHksIHcsIGgpO1xuICB9O1xuXG4gIC8vIFBhdGNoIGNpcmNsZSgpIHRvIHN0b3JlIG1ldGFkYXRhXG4gIFBJWEkuR3JhcGhpY3MucHJvdG90eXBlLmNpcmNsZSA9IGZ1bmN0aW9uICh4OiBudW1iZXIsIHk6IG51bWJlciwgcmFkaXVzOiBudW1iZXIpIHtcbiAgICBzZXRHcmFwaGljc1BoeXNpY3NTaGFwZSh0aGlzLCB7XG4gICAgICB0eXBlOiAnY2lyY2xlJyxcbiAgICAgIHJhZGl1czogcmFkaXVzXG4gICAgfSk7XG4gICAgcmV0dXJuIG9yaWdpbmFsQ2lyY2xlLmNhbGwodGhpcywgeCwgeSwgcmFkaXVzKTtcbiAgfTtcblxuICAvLyBQYXRjaCBwb2x5KCkgdG8gc3RvcmUgbWV0YWRhdGFcbiAgUElYSS5HcmFwaGljcy5wcm90b3R5cGUucG9seSA9IGZ1bmN0aW9uIChwb2ludHM6IFBJWEkuUG9pbnREYXRhW10gfCBudW1iZXJbXSkge1xuICAgIGNvbnN0IGZsYXRQb2ludHMgPSBBcnJheS5pc0FycmF5KHBvaW50c1swXSkgPyBwb2ludHMuZmxhdCgpIDogcG9pbnRzO1xuICAgIHNldEdyYXBoaWNzUGh5c2ljc1NoYXBlKHRoaXMsIHtcbiAgICAgIHR5cGU6ICdwb2x5Z29uJyxcbiAgICAgIHZlcnRpY2VzOiBmbGF0UG9pbnRzIGFzIG51bWJlcltdXG4gICAgfSk7XG4gICAgcmV0dXJuIG9yaWdpbmFsUG9seS5jYWxsKHRoaXMsIHBvaW50cyBhcyBhbnkpO1xuICB9O1xufVxuXG4vKiogRXh0cmFjdCBQbGFuY2sgc2hhcGUgZnJvbSBQSVhJLkdyYXBoaWNzLiBVc2VzIHN0b3JlZCBtZXRhZGF0YSBvciBmYWxscyBiYWNrIHRvIGJvdW5kcy4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUdyYXBoaWNzU2hhcGUoZ3JhcGhpY3M6IFBJWEkuR3JhcGhpY3MsIHdvcmxkOiBQaHlzaWNzV29ybGQpOiBQYXJzZWRTaGFwZSB7XG4gIC8vIENoZWNrIGlmIHNoYXBlIG1ldGFkYXRhIHdhcyBzdG9yZWRcbiAgY29uc3QgbWV0YWRhdGEgPSAoZ3JhcGhpY3MgYXMgYW55KVtQSFlTSUNTX1NIQVBFX0tFWV0gYXMgUGh5c2ljc1NoYXBlTWV0YWRhdGEgfCB1bmRlZmluZWQ7XG5cbiAgaWYgKG1ldGFkYXRhKSB7XG4gICAgLy8gVXNlIHN0b3JlZCBtZXRhZGF0YVxuICAgIHN3aXRjaCAobWV0YWRhdGEudHlwZSkge1xuICAgICAgY2FzZSAnY2lyY2xlJzpcbiAgICAgICAgaWYgKCFtZXRhZGF0YS5yYWRpdXMpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NpcmNsZSBtZXRhZGF0YSBtaXNzaW5nIHJhZGl1cycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogJ2NpcmNsZScsXG4gICAgICAgICAgc2hhcGU6IHBsYW5jay5DaXJjbGUod29ybGQudG9QaHlzaWNzKG1ldGFkYXRhLnJhZGl1cykpXG4gICAgICAgIH07XG5cbiAgICAgIGNhc2UgJ3JlY3RhbmdsZSc6XG4gICAgICAgIGlmICghbWV0YWRhdGEud2lkdGggfHwgIW1ldGFkYXRhLmhlaWdodCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVjdGFuZ2xlIG1ldGFkYXRhIG1pc3Npbmcgd2lkdGgvaGVpZ2h0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiAncmVjdGFuZ2xlJyxcbiAgICAgICAgICBzaGFwZTogcGxhbmNrLkJveChcbiAgICAgICAgICAgIHdvcmxkLnRvUGh5c2ljcyhtZXRhZGF0YS53aWR0aCAvIDIpLFxuICAgICAgICAgICAgd29ybGQudG9QaHlzaWNzKG1ldGFkYXRhLmhlaWdodCAvIDIpXG4gICAgICAgICAgKVxuICAgICAgICB9O1xuXG4gICAgICBjYXNlICdwb2x5Z29uJzpcbiAgICAgICAgaWYgKCFtZXRhZGF0YS52ZXJ0aWNlcyB8fCBtZXRhZGF0YS52ZXJ0aWNlcy5sZW5ndGggPCA2KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQb2x5Z29uIG1ldGFkYXRhIG1pc3NpbmcgdmVydGljZXMgKG5lZWQgYXQgbGVhc3QgMyBwb2ludHMgPSA2IHZhbHVlcyknKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB2ZXJ0aWNlczogcGxhbmNrLlZlYzJbXSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1ldGFkYXRhLnZlcnRpY2VzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICAgICAgdmVydGljZXMucHVzaChcbiAgICAgICAgICAgIHBsYW5jay5WZWMyKFxuICAgICAgICAgICAgICB3b3JsZC50b1BoeXNpY3MobWV0YWRhdGEudmVydGljZXNbaV0pLFxuICAgICAgICAgICAgICB3b3JsZC50b1BoeXNpY3MobWV0YWRhdGEudmVydGljZXNbaSArIDFdKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiAncG9seWdvbicsXG4gICAgICAgICAgc2hhcGU6IHBsYW5jay5Qb2x5Z29uKHZlcnRpY2VzKVxuICAgICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8vIEZhbGxiYWNrOiBVc2UgYm91bmRpbmcgYm94IGFzIHJlY3RhbmdsZVxuICBjb25zdCBib3VuZHMgPSBncmFwaGljcy5nZXRMb2NhbEJvdW5kcygpO1xuXG4gIGlmIChib3VuZHMud2lkdGggPT09IDAgfHwgYm91bmRzLmhlaWdodCA9PT0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICdHcmFwaGljcyBoYXMgbm8gZGltZW5zaW9ucy4gRWl0aGVyIGRyYXcgc2hhcGVzIHVzaW5nIHJlY3QoKSwgY2lyY2xlKCksIG9yIHBvbHkoKSwgJyArXG4gICAgICAnb3IgcHJvdmlkZSBhbiBleHBsaWNpdCBjb2xsaXNpb25TaGFwZSBvcHRpb24uJ1xuICAgICk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHR5cGU6ICdyZWN0YW5nbGUnLFxuICAgIHNoYXBlOiBwbGFuY2suQm94KFxuICAgICAgd29ybGQudG9QaHlzaWNzKGJvdW5kcy53aWR0aCAvIDIpLFxuICAgICAgd29ybGQudG9QaHlzaWNzKGJvdW5kcy5oZWlnaHQgLyAyKVxuICAgIClcbiAgfTtcbn1cbiIsImltcG9ydCB0eXBlIHsgUGh5c2ljc0JvZHlPcHRpb25zIH0gZnJvbSAnLi9waHlzaWNzLXR5cGVzJztcblxuLyoqXG4gKiBQcmVkZWZpbmVkIG1hdGVyaWFsIHByZXNldHMgZm9yIGNvbW1vbiBwaHlzaWNzIGJlaGF2aW9yc1xuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBiYWxsID0gYXNQaHlzaWNzRW50aXR5KHNwcml0ZSwgd29ybGQsIHtcbiAqICAgdHlwZTogJ2R5bmFtaWMnLFxuICogICAuLi5QaHlzaWNzTWF0ZXJpYWxzLmJvdW5jeVxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNvbnN0IFBoeXNpY3NNYXRlcmlhbHMgPSB7XG4gIC8qKlxuICAgKiBCb3VuY3kgYmFsbCAtIGhpZ2ggcmVzdGl0dXRpb24sIGxvdyBmcmljdGlvblxuICAgKi9cbiAgYm91bmN5OiB7XG4gICAgZGVuc2l0eTogMC41LFxuICAgIGZyaWN0aW9uOiAwLjEsXG4gICAgcmVzdGl0dXRpb246IDAuOVxuICB9LFxuXG4gIC8qKlxuICAgKiBXb29kZW4gYm94IC0gbWVkaXVtIGRlbnNpdHksIG1lZGl1bSBmcmljdGlvblxuICAgKi9cbiAgd29vZDoge1xuICAgIGRlbnNpdHk6IDAuNyxcbiAgICBmcmljdGlvbjogMC40LFxuICAgIHJlc3RpdHV0aW9uOiAwLjJcbiAgfSxcblxuICAvKipcbiAgICogTWV0YWwgb2JqZWN0IC0gaGlnaCBkZW5zaXR5LCBsb3cgcmVzdGl0dXRpb25cbiAgICovXG4gIG1ldGFsOiB7XG4gICAgZGVuc2l0eTogMS41LFxuICAgIGZyaWN0aW9uOiAwLjMsXG4gICAgcmVzdGl0dXRpb246IDAuMVxuICB9LFxuXG4gIC8qKlxuICAgKiBJY2UgLSB2ZXJ5IGxvdyBmcmljdGlvbiwgbG93IHJlc3RpdHV0aW9uXG4gICAqL1xuICBpY2U6IHtcbiAgICBkZW5zaXR5OiAwLjksXG4gICAgZnJpY3Rpb246IDAuMDIsXG4gICAgcmVzdGl0dXRpb246IDAuMDVcbiAgfSxcblxuICAvKipcbiAgICogUnViYmVyIC0gaGlnaCBmcmljdGlvbiwgaGlnaCByZXN0aXR1dGlvblxuICAgKi9cbiAgcnViYmVyOiB7XG4gICAgZGVuc2l0eTogMS4wLFxuICAgIGZyaWN0aW9uOiAwLjksXG4gICAgcmVzdGl0dXRpb246IDAuN1xuICB9LFxuXG4gIC8qKlxuICAgKiBDaGFyYWN0ZXIgLSBubyByb3RhdGlvbiwgbWVkaXVtIGZyaWN0aW9uXG4gICAqL1xuICBjaGFyYWN0ZXI6IHtcbiAgICBkZW5zaXR5OiAxLjAsXG4gICAgZnJpY3Rpb246IDAuNSxcbiAgICByZXN0aXR1dGlvbjogMC4wLFxuICAgIGZpeGVkUm90YXRpb246IHRydWVcbiAgfSxcblxuICAvKipcbiAgICogU3RhdGljIHRlcnJhaW4gLSBubyBkZW5zaXR5IChpbW1vdmFibGUpLCBoaWdoIGZyaWN0aW9uXG4gICAqL1xuICB0ZXJyYWluOiB7XG4gICAgZGVuc2l0eTogMCxcbiAgICBmcmljdGlvbjogMC42LFxuICAgIHJlc3RpdHV0aW9uOiAwLjBcbiAgfVxufSBhcyBjb25zdDtcblxuLyoqXG4gKiBBcHBseSBtYXRlcmlhbCBwcmVzZXQgdG8gb3B0aW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlNYXRlcmlhbChcbiAgb3B0aW9uczogUGh5c2ljc0JvZHlPcHRpb25zLFxuICBtYXRlcmlhbDoga2V5b2YgdHlwZW9mIFBoeXNpY3NNYXRlcmlhbHNcbik6IFBoeXNpY3NCb2R5T3B0aW9ucyB7XG4gIHJldHVybiB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICAuLi5QaHlzaWNzTWF0ZXJpYWxzW21hdGVyaWFsXVxuICB9O1xufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IGFzRW50aXR5LCBBc0VudGl0eSB9IGZyb20gJy4uLy4uL2NvcmUvbW94aS1lbnRpdHknO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzV29ybGQgfSBmcm9tICcuL3BoeXNpY3Mtd29ybGQnO1xuaW1wb3J0IHsgUGh5c2ljc0JvZHlMb2dpYyB9IGZyb20gJy4vcGh5c2ljcy1ib2R5LWxvZ2ljJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc0JvZHlPcHRpb25zLCBTaGFwZUNvbmZpZyB9IGZyb20gJy4vcGh5c2ljcy10eXBlcyc7XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIHBoeXNpY3MtZW5hYmxlZCBlbnRpdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3Qgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xuICogY29uc3QgcGh5c2ljc0VudGl0eSA9IGFzUGh5c2ljc0VudGl0eShzcHJpdGUsIHBoeXNpY3NXb3JsZCwge1xuICogICB0eXBlOiAnZHluYW1pYycsXG4gKiAgIHNoYXBlOiAnY2lyY2xlJyxcbiAqICAgcmFkaXVzOiAyNVxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzUGh5c2ljc0VudGl0eTxUIGV4dGVuZHMgUElYSS5Db250YWluZXI+KFxuICBwaXhpT2JqZWN0OiBULFxuICB3b3JsZDogUGh5c2ljc1dvcmxkLFxuICBvcHRpb25zOiBQaHlzaWNzQm9keU9wdGlvbnMgPSB7fVxuKTogQXNFbnRpdHk8VD4ge1xuICBjb25zdCBlbnRpdHkgPSBhc0VudGl0eShwaXhpT2JqZWN0KTtcbiAgY29uc3QgcGh5c2ljc0xvZ2ljID0gbmV3IFBoeXNpY3NCb2R5TG9naWMod29ybGQsIG9wdGlvbnMpO1xuICBlbnRpdHkubW94aUVudGl0eS5hZGRMb2dpYyhwaHlzaWNzTG9naWMpO1xuICByZXR1cm4gZW50aXR5IGFzIEFzRW50aXR5PFQ+O1xufVxuXG4vKipcbiAqIENoZWNrIGlmIGVudGl0eSBoYXMgcGh5c2ljcyBib2R5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNQaHlzaWNzKGVudGl0eTogYW55KTogYm9vbGVhbiB7XG4gIGlmICghZW50aXR5Lm1veGlFbnRpdHkpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIGVudGl0eS5tb3hpRW50aXR5LmdldExvZ2ljKCdQaHlzaWNzQm9keUxvZ2ljJykgIT09IHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBHZXQgcGh5c2ljcyBib2R5IGxvZ2ljIGZyb20gZW50aXR5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQaHlzaWNzQm9keShlbnRpdHk6IGFueSk6IFBoeXNpY3NCb2R5TG9naWMgfCB1bmRlZmluZWQge1xuICBpZiAoIWVudGl0eS5tb3hpRW50aXR5KSByZXR1cm4gdW5kZWZpbmVkO1xuICByZXR1cm4gZW50aXR5Lm1veGlFbnRpdHkuZ2V0TG9naWMoJ1BoeXNpY3NCb2R5TG9naWMnKSBhcyBQaHlzaWNzQm9keUxvZ2ljIHwgdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIFNoYXBlIGNyZWF0aW9uIGZyb20gc3ByaXRlIGJvdW5kc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2hhcGVGcm9tU3ByaXRlKFxuICBzcHJpdGU6IFBJWEkuU3ByaXRlLFxuICB0eXBlOiAncmVjdGFuZ2xlJyB8ICdjaXJjbGUnIHwgJ2F1dG8nID0gJ2F1dG8nXG4pOiBTaGFwZUNvbmZpZyB7XG4gIGNvbnN0IGJvdW5kcyA9IHNwcml0ZS5nZXRMb2NhbEJvdW5kcygpO1xuXG4gIGlmICh0eXBlID09PSAnYXV0bycpIHtcbiAgICAvLyBDaGVjayBpZiByb3VnaGx5IHNxdWFyZSAtPiBjaXJjbGUsIGVsc2UgcmVjdGFuZ2xlXG4gICAgY29uc3QgcmF0aW8gPSBib3VuZHMud2lkdGggLyBib3VuZHMuaGVpZ2h0O1xuICAgIHR5cGUgPSAocmF0aW8gPiAwLjggJiYgcmF0aW8gPCAxLjIpID8gJ2NpcmNsZScgOiAncmVjdGFuZ2xlJztcbiAgfVxuXG4gIGlmICh0eXBlID09PSAnY2lyY2xlJykge1xuICAgIHJldHVybiB7XG4gICAgICBzaGFwZTogJ2NpcmNsZScsXG4gICAgICByYWRpdXM6IE1hdGgubWF4KGJvdW5kcy53aWR0aCwgYm91bmRzLmhlaWdodCkgLyAyXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2hhcGU6ICdyZWN0YW5nbGUnLFxuICAgICAgd2lkdGg6IGJvdW5kcy53aWR0aCxcbiAgICAgIGhlaWdodDogYm91bmRzLmhlaWdodFxuICAgIH07XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgKiBhcyBwbGFuY2sgZnJvbSAncGxhbmNrJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkT3B0aW9ucywgUmF5Y2FzdENhbGxiYWNrLCBQaHlzaWNzRGVidWdPcHRpb25zIH0gZnJvbSAnLi9waHlzaWNzLXR5cGVzJztcbmltcG9ydCB7IENvbGxpc2lvblJlZ2lzdHJ5LCBDb2xsaXNpb25NYW5hZ2VyIH0gZnJvbSAnLi9waHlzaWNzLWNvbGxpc2lvbic7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NCb2R5TG9naWMgfSBmcm9tICcuL3BoeXNpY3MtYm9keS1sb2dpYyc7XG5pbXBvcnQgeyBQaHlzaWNzRGVidWdSZW5kZXJlciB9IGZyb20gJy4vcGh5c2ljcy1kZWJ1Zy1yZW5kZXJlcic7XG5pbXBvcnQgeyBhc0VudGl0eSB9IGZyb20gJy4uLy4uL2NvcmUvbW94aS1lbnRpdHknO1xuaW1wb3J0IHsgaW5pdEdyYXBoaWNzUGh5c2ljc1RyYWNraW5nIH0gZnJvbSAnLi9waHlzaWNzLWdyYXBoaWNzLXBhcnNlcic7XG5cbi8qKlxuICogUGxhbmNrLmpzIHBoeXNpY3Mgc2ltdWxhdGlvbiBtYW5hZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogLy8gVmlhIHNldHVwTW94aSAocmVjb21tZW5kZWQpXG4gKiBjb25zdCB7IHBoeXNpY3NXb3JsZCB9ID0gYXdhaXQgc2V0dXBNb3hpKHsgcGh5c2ljczogdHJ1ZSB9KTtcbiAqXG4gKiAvLyBPciBtYW51YWxseVxuICogY29uc3QgcGh5c2ljc1dvcmxkID0gbmV3IFBoeXNpY3NXb3JsZCh7IGdyYXZpdHk6IHsgeDogMCwgeTogOS44IH0gfSk7XG4gKiBlbmdpbmUuYWRkUGh5c2ljc1dvcmxkKHBoeXNpY3NXb3JsZCk7XG4gKlxuICogLy8gQ29sbGlzaW9uIGNhbGxiYWNrc1xuICogcGh5c2ljc1dvcmxkLm9uQ29sbGlzaW9uKCdwbGF5ZXInLCAnZW5lbXknLCAoZSkgPT4gY29uc29sZS5sb2coJ2hpdCEnKSk7XG4gKlxuICogLy8gRGVidWcgdmlzdWFsaXphdGlvblxuICogcGh5c2ljc1dvcmxkLmVuYWJsZURlYnVnUmVuZGVyZXIoc2NlbmUpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBQaHlzaWNzV29ybGQge1xuICAvKiogUGxhbmNrLmpzIHdvcmxkLiAqL1xuICBwdWJsaWMgd29ybGQ6IHBsYW5jay5Xb3JsZDtcblxuICAvKiogQ29udmVyc2lvbiBmYWN0b3IuIERlZmF1bHQgMzAuICovXG4gIHB1YmxpYyBwaXhlbHNQZXJNZXRlcjogbnVtYmVyID0gMzA7XG5cbiAgLyoqIEZpeGVkIHRpbWVzdGVwIChzZWNvbmRzKS4gRGVmYXVsdCAxLzYwLiAqL1xuICBwdWJsaWMgdGltZXN0ZXA6IG51bWJlciA9IDEvNjA7XG5cbiAgLyoqIENvbGxpc2lvbiB0YWcgcmVnaXN0cnkgZm9yIHRhZy10by1iaXRtYXNrIGNvbnZlcnNpb24uICovXG4gIHB1YmxpYyBjb2xsaXNpb25SZWdpc3RyeTogQ29sbGlzaW9uUmVnaXN0cnk7XG5cbiAgLyoqIEhhbmRsZXMgY29sbGlzaW9uIGNhbGxiYWNrcyBiZXR3ZWVuIHRhZ3MuICovXG4gIHB1YmxpYyBjb2xsaXNpb25NYW5hZ2VyOiBDb2xsaXNpb25NYW5hZ2VyO1xuXG4gIHByaXZhdGUgdmVsb2NpdHlJdGVyYXRpb25zOiBudW1iZXIgPSA4O1xuICBwcml2YXRlIHBvc2l0aW9uSXRlcmF0aW9uczogbnVtYmVyID0gMztcbiAgcHJpdmF0ZSBhY2N1bXVsYXRvcjogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBib2RpZXM6IE1hcDxwbGFuY2suQm9keSwgUGh5c2ljc0JvZHlMb2dpYz4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgZGVidWdSZW5kZXJlcj86IFBoeXNpY3NEZWJ1Z1JlbmRlcmVyO1xuICBwcml2YXRlIGRlYnVnR3JhcGhpY3M/OiBQSVhJLkdyYXBoaWNzO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IFBoeXNpY3NXb3JsZE9wdGlvbnMgPSB7fSkge1xuICAgIC8vIEluaXRpYWxpemUgR3JhcGhpY3MgcGh5c2ljcyB0cmFja2luZyAocGF0Y2hlcyBQSVhJLkdyYXBoaWNzIG1ldGhvZHMpXG4gICAgaW5pdEdyYXBoaWNzUGh5c2ljc1RyYWNraW5nKCk7XG5cbiAgICBjb25zdCB7XG4gICAgICBncmF2aXR5ID0geyB4OiAwLCB5OiA5LjggfSxcbiAgICAgIHBpeGVsc1Blck1ldGVyID0gMzAsXG4gICAgICB2ZWxvY2l0eUl0ZXJhdGlvbnMgPSA4LFxuICAgICAgcG9zaXRpb25JdGVyYXRpb25zID0gMyxcbiAgICAgIGVuYWJsZVNsZWVwaW5nID0gdHJ1ZSxcbiAgICAgIHRpbWVzdGVwID0gMS82MFxuICAgIH0gPSBvcHRpb25zO1xuXG4gICAgdGhpcy5waXhlbHNQZXJNZXRlciA9IHBpeGVsc1Blck1ldGVyO1xuICAgIHRoaXMudmVsb2NpdHlJdGVyYXRpb25zID0gdmVsb2NpdHlJdGVyYXRpb25zO1xuICAgIHRoaXMucG9zaXRpb25JdGVyYXRpb25zID0gcG9zaXRpb25JdGVyYXRpb25zO1xuICAgIHRoaXMudGltZXN0ZXAgPSB0aW1lc3RlcDtcblxuICAgIC8vIENyZWF0ZSBQbGFuY2sgd29ybGRcbiAgICB0aGlzLndvcmxkID0gcGxhbmNrLldvcmxkKHtcbiAgICAgIGdyYXZpdHk6IHBsYW5jay5WZWMyKGdyYXZpdHkueCwgZ3Jhdml0eS55KVxuICAgIH0pO1xuXG4gICAgLy8gQ29uZmlndXJlIHNsZWVwaW5nXG4gICAgdGhpcy53b3JsZC5zZXRBbGxvd1NsZWVwaW5nKGVuYWJsZVNsZWVwaW5nKTtcblxuICAgIC8vIEluaXRpYWxpemUgY29sbGlzaW9uIHN5c3RlbVxuICAgIHRoaXMuY29sbGlzaW9uUmVnaXN0cnkgPSBuZXcgQ29sbGlzaW9uUmVnaXN0cnkoKTtcbiAgICB0aGlzLmNvbGxpc2lvbk1hbmFnZXIgPSBuZXcgQ29sbGlzaW9uTWFuYWdlcih0aGlzLCB0aGlzLmNvbGxpc2lvblJlZ2lzdHJ5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGVwIHRoZSBwaHlzaWNzIHNpbXVsYXRpb24gKGNhbGxlZCBieSBFbmdpbmUgdXBkYXRlIGxvb3ApXG4gICAqIFVzZXMgZml4ZWQgdGltZXN0ZXAgZm9yIGRldGVybWluaXN0aWMgcGh5c2ljc1xuICAgKi9cbiAgc3RlcChkZWx0YVRpbWU6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuYWNjdW11bGF0b3IgKz0gZGVsdGFUaW1lO1xuXG4gICAgLy8gRml4ZWQgdGltZXN0ZXAgdXBkYXRlc1xuICAgIHdoaWxlICh0aGlzLmFjY3VtdWxhdG9yID49IHRoaXMudGltZXN0ZXApIHtcbiAgICAgIHRoaXMud29ybGQuc3RlcCh0aGlzLnRpbWVzdGVwLCB0aGlzLnZlbG9jaXR5SXRlcmF0aW9ucywgdGhpcy5wb3NpdGlvbkl0ZXJhdGlvbnMpO1xuICAgICAgdGhpcy5hY2N1bXVsYXRvciAtPSB0aGlzLnRpbWVzdGVwO1xuICAgIH1cblxuICAgIC8vIE5vdGU6IEludGVycG9sYXRpb24gZm9yIHJlbmRlcmluZyBzbW9vdGhuZXNzIGNvdWxkIGJlIGFkZGVkIGhlcmVcbiAgICAvLyBjb25zdCBhbHBoYSA9IHRoaXMuYWNjdW11bGF0b3IgLyB0aGlzLnRpbWVzdGVwO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIHBoeXNpY3MgYm9keVxuICAgKi9cbiAgY3JlYXRlQm9keShkZWY6IHBsYW5jay5Cb2R5RGVmKTogcGxhbmNrLkJvZHkge1xuICAgIHJldHVybiB0aGlzLndvcmxkLmNyZWF0ZUJvZHkoZGVmKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXN0cm95IGEgcGh5c2ljcyBib2R5XG4gICAqL1xuICBkZXN0cm95Qm9keShib2R5OiBwbGFuY2suQm9keSk6IHZvaWQge1xuICAgIHRoaXMuYm9kaWVzLmRlbGV0ZShib2R5KTtcbiAgICB0aGlzLndvcmxkLmRlc3Ryb3lCb2R5KGJvZHkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGEgcGh5c2ljcyBib2R5IGxvZ2ljIGNvbXBvbmVudFxuICAgKi9cbiAgcmVnaXN0ZXJCb2R5KGJvZHk6IHBsYW5jay5Cb2R5LCBsb2dpYzogUGh5c2ljc0JvZHlMb2dpYyk6IHZvaWQge1xuICAgIHRoaXMuYm9kaWVzLnNldChib2R5LCBsb2dpYyk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHBoeXNpY3MgYm9keSBsb2dpYyBmcm9tIFBsYW5jayBib2R5XG4gICAqL1xuICBnZXRCb2R5TG9naWMoYm9keTogcGxhbmNrLkJvZHkpOiBQaHlzaWNzQm9keUxvZ2ljIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5ib2RpZXMuZ2V0KGJvZHkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJheWNhc3QgZnJvbSBvbmUgcG9pbnQgdG8gYW5vdGhlclxuICAgKi9cbiAgcmF5Y2FzdChmcm9tOiBQSVhJLlBvaW50LCB0bzogUElYSS5Qb2ludCwgY2FsbGJhY2s6IFJheWNhc3RDYWxsYmFjayk6IHZvaWQge1xuICAgIGNvbnN0IHAxID0gdGhpcy50b1BoeXNpY3NQb2ludChmcm9tKTtcbiAgICBjb25zdCBwMiA9IHRoaXMudG9QaHlzaWNzUG9pbnQodG8pO1xuXG4gICAgdGhpcy53b3JsZC5yYXlDYXN0KHAxLCBwMiwgKGZpeHR1cmUsIHBvaW50LCBub3JtYWwsIGZyYWN0aW9uKSA9PiB7XG4gICAgICBjb25zdCBwaXhlbFBvaW50ID0gdGhpcy50b1BpeGVsc1BvaW50KHBvaW50KTtcbiAgICAgIGNvbnN0IHBpeGVsTm9ybWFsID0gbmV3IFBJWEkuUG9pbnQobm9ybWFsLngsIG5vcm1hbC55KTtcbiAgICAgIHJldHVybiBjYWxsYmFjayhmaXh0dXJlLCBwaXhlbFBvaW50LCBwaXhlbE5vcm1hbCwgZnJhY3Rpb24pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFF1ZXJ5IEFBQkIgKGF4aXMtYWxpZ25lZCBib3VuZGluZyBib3gpXG4gICAqL1xuICBxdWVyeUFBQkIoYm91bmRzOiBQSVhJLlJlY3RhbmdsZSwgY2FsbGJhY2s6IChib2R5OiBwbGFuY2suQm9keSkgPT4gYm9vbGVhbik6IHZvaWQge1xuICAgIGNvbnN0IGxvd2VyQm91bmQgPSB0aGlzLnRvUGh5c2ljc1BvaW50KG5ldyBQSVhJLlBvaW50KGJvdW5kcy54LCBib3VuZHMueSkpO1xuICAgIGNvbnN0IHVwcGVyQm91bmQgPSB0aGlzLnRvUGh5c2ljc1BvaW50KG5ldyBQSVhJLlBvaW50KGJvdW5kcy54ICsgYm91bmRzLndpZHRoLCBib3VuZHMueSArIGJvdW5kcy5oZWlnaHQpKTtcblxuICAgIHRoaXMud29ybGQucXVlcnlBQUJCKHBsYW5jay5BQUJCKGxvd2VyQm91bmQsIHVwcGVyQm91bmQpLCAoZml4dHVyZSkgPT4ge1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKGZpeHR1cmUuZ2V0Qm9keSgpKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBRdWVyeSBwb2ludFxuICAgKi9cbiAgcXVlcnlQb2ludChwb2ludDogUElYSS5Qb2ludCwgY2FsbGJhY2s6IChmaXh0dXJlOiBwbGFuY2suRml4dHVyZSkgPT4gYm9vbGVhbik6IHZvaWQge1xuICAgIGNvbnN0IHBoeXNpY3NQb2ludCA9IHRoaXMudG9QaHlzaWNzUG9pbnQocG9pbnQpO1xuXG4gICAgdGhpcy53b3JsZC5xdWVyeUFBQkIoXG4gICAgICBwbGFuY2suQUFCQihcbiAgICAgICAgcGxhbmNrLlZlYzIocGh5c2ljc1BvaW50LnggLSAwLjAwMSwgcGh5c2ljc1BvaW50LnkgLSAwLjAwMSksXG4gICAgICAgIHBsYW5jay5WZWMyKHBoeXNpY3NQb2ludC54ICsgMC4wMDEsIHBoeXNpY3NQb2ludC55ICsgMC4wMDEpXG4gICAgICApLFxuICAgICAgKGZpeHR1cmUpID0+IHtcbiAgICAgICAgaWYgKGZpeHR1cmUudGVzdFBvaW50KHBoeXNpY3NQb2ludCkpIHtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZml4dHVyZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IHBpeGVscyB0byBtZXRlcnNcbiAgICovXG4gIHRvUGh5c2ljcyhwaXhlbHM6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHBpeGVscyAvIHRoaXMucGl4ZWxzUGVyTWV0ZXI7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBtZXRlcnMgdG8gcGl4ZWxzXG4gICAqL1xuICB0b1BpeGVscyhtZXRlcnM6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIG1ldGVycyAqIHRoaXMucGl4ZWxzUGVyTWV0ZXI7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBQSVhJIFBvaW50IChwaXhlbHMpIHRvIFBsYW5jayBWZWMyIChtZXRlcnMpXG4gICAqL1xuICB0b1BoeXNpY3NQb2ludChwb2ludDogUElYSS5Qb2ludCk6IHBsYW5jay5WZWMyIHtcbiAgICByZXR1cm4gcGxhbmNrLlZlYzIodGhpcy50b1BoeXNpY3MocG9pbnQueCksIHRoaXMudG9QaHlzaWNzKHBvaW50LnkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IFBsYW5jayBWZWMyIChtZXRlcnMpIHRvIFBJWEkgUG9pbnQgKHBpeGVscylcbiAgICovXG4gIHRvUGl4ZWxzUG9pbnQodmVjOiBwbGFuY2suVmVjMik6IFBJWEkuUG9pbnQge1xuICAgIHJldHVybiBuZXcgUElYSS5Qb2ludCh0aGlzLnRvUGl4ZWxzKHZlYy54KSwgdGhpcy50b1BpeGVscyh2ZWMueSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEVuYWJsZSBkZWJ1ZyByZW5kZXJlclxuICAgKi9cbiAgZW5hYmxlRGVidWdSZW5kZXJlcihzY2VuZTogUElYSS5Db250YWluZXIsIG9wdGlvbnM6IFBoeXNpY3NEZWJ1Z09wdGlvbnMgPSB7fSk6IFBoeXNpY3NEZWJ1Z1JlbmRlcmVyIHtcbiAgICAvLyBDbGVhbiB1cCBleGlzdGluZyBkZWJ1ZyByZW5kZXJlciBpZiBhbnlcbiAgICBpZiAodGhpcy5kZWJ1Z1JlbmRlcmVyKSB7XG4gICAgICB0aGlzLmRpc2FibGVEZWJ1Z1JlbmRlcmVyKCk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGRlYnVnIGdyYXBoaWNzXG4gICAgdGhpcy5kZWJ1Z0dyYXBoaWNzID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcblxuICAgIC8vIENyZWF0ZSBkZWJ1ZyByZW5kZXJlciBsb2dpY1xuICAgIHRoaXMuZGVidWdSZW5kZXJlciA9IG5ldyBQaHlzaWNzRGVidWdSZW5kZXJlcih0aGlzLCBvcHRpb25zKTtcblxuICAgIC8vIE1ha2UgaXQgYW4gZW50aXR5IGFuZCBhZGQgdG8gc2NlbmVcbiAgICBjb25zdCBkZWJ1Z0VudGl0eSA9IGFzRW50aXR5KHRoaXMuZGVidWdHcmFwaGljcyk7XG4gICAgZGVidWdFbnRpdHkubW94aUVudGl0eS5hZGRMb2dpYyh0aGlzLmRlYnVnUmVuZGVyZXIpO1xuXG4gICAgLy8gU2V0IGhpZ2hlc3Qgei1pbmRleCBzbyBpdCByZW5kZXJzIG9uIHRvcCBvZiBldmVyeXRoaW5nXG4gICAgZGVidWdFbnRpdHkuekluZGV4ID0gMTAwMDA7XG5cbiAgICAvLyBFbmFibGUgc29ydGFibGUgY2hpbGRyZW4gb24gc2NlbmUgc28gekluZGV4IHdvcmtzXG4gICAgc2NlbmUuc29ydGFibGVDaGlsZHJlbiA9IHRydWU7XG5cbiAgICAvLyBBZGQgdG8gc2NlbmUgYXQgaGlnaGVzdCB6LWluZGV4IHNvIGl0IHJlbmRlcnMgb24gdG9wXG4gICAgc2NlbmUuYWRkQ2hpbGQoZGVidWdFbnRpdHkpO1xuXG4gICAgY29uc29sZS5sb2coJ1BoeXNpY3MgZGVidWcgcmVuZGVyZXIgZW5hYmxlZC4gUHJlc3MgXCJQXCIgdG8gdG9nZ2xlIHZpc2liaWxpdHkuJyk7XG5cbiAgICByZXR1cm4gdGhpcy5kZWJ1Z1JlbmRlcmVyO1xuICB9XG5cbiAgLyoqXG4gICAqIERpc2FibGUgZGVidWcgcmVuZGVyZXJcbiAgICovXG4gIGRpc2FibGVEZWJ1Z1JlbmRlcmVyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmRlYnVnUmVuZGVyZXIgJiYgdGhpcy5kZWJ1Z0dyYXBoaWNzKSB7XG4gICAgICAvLyBSZW1vdmUgZnJvbSBzY2VuZVxuICAgICAgaWYgKHRoaXMuZGVidWdHcmFwaGljcy5wYXJlbnQpIHtcbiAgICAgICAgdGhpcy5kZWJ1Z0dyYXBoaWNzLnBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLmRlYnVnR3JhcGhpY3MpO1xuICAgICAgfVxuXG4gICAgICAvLyBDbGVhbiB1cFxuICAgICAgdGhpcy5kZWJ1Z0dyYXBoaWNzLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMuZGVidWdHcmFwaGljcyA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMuZGVidWdSZW5kZXJlciA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGRlYnVnIHJlbmRlcmVyIGlmIGVuYWJsZWRcbiAgICovXG4gIGdldERlYnVnUmVuZGVyZXIoKTogUGh5c2ljc0RlYnVnUmVuZGVyZXIgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmRlYnVnUmVuZGVyZXI7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCBib2RpZXMgaW4gdGhlIHdvcmxkXG4gICAqL1xuICBnZXRCb2RpZXMoKTogcGxhbmNrLkJvZHlbXSB7XG4gICAgY29uc3QgYm9kaWVzOiBwbGFuY2suQm9keVtdID0gW107XG4gICAgZm9yIChsZXQgYm9keSA9IHRoaXMud29ybGQuZ2V0Qm9keUxpc3QoKTsgYm9keTsgYm9keSA9IGJvZHkuZ2V0TmV4dCgpKSB7XG4gICAgICBib2RpZXMucHVzaChib2R5KTtcbiAgICB9XG4gICAgcmV0dXJuIGJvZGllcztcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbiB1cCBhbmQgZGVzdHJveSB0aGUgcGh5c2ljcyB3b3JsZFxuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAvLyBEZXN0cm95IGFsbCBib2RpZXNcbiAgICBjb25zdCBib2RpZXMgPSB0aGlzLmdldEJvZGllcygpO1xuICAgIGJvZGllcy5mb3JFYWNoKGJvZHkgPT4gdGhpcy53b3JsZC5kZXN0cm95Qm9keShib2R5KSk7XG5cbiAgICB0aGlzLmJvZGllcy5jbGVhcigpO1xuICAgIHRoaXMuZGVidWdSZW5kZXJlciA9IHVuZGVmaW5lZDtcbiAgfVxufVxuIiwiLyoqXG4gKiBPcHRpb25zIGZvciBjb25maWd1cmluZyB0aGUgcmVzaXplIGhhbmRsZXJcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSZXNpemVIYW5kbGVyT3B0aW9ucyB7XG4gIC8qKiBSb290IGVsZW1lbnQgY29udGFpbmluZyB0aGUgY2FudmFzICovXG4gIHJvb3RFbGVtZW50OiBIVE1MRWxlbWVudDtcbiAgLyoqIFRoZSBkZXNpcmVkIHdpZHRoIG9mIHRoZSBnYW1lIHZpZXdwb3J0ICovXG4gIHdpZHRoOiBudW1iZXI7XG4gIC8qKiBUaGUgZGVzaXJlZCBoZWlnaHQgb2YgdGhlIGdhbWUgdmlld3BvcnQgKi9cbiAgaGVpZ2h0OiBudW1iZXI7XG4gIC8qKiBPcHRpb25hbCBDU1MgcHJvcGVydGllcyB0byBhcHBseSB0byB0aGUgcm9vdCBlbGVtZW50ICovXG4gIHJvb3RTdHlsZXM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICAvKiogT3B0aW9uYWwgQ1NTIHByb3BlcnRpZXMgdG8gYXBwbHkgdG8gdGhlIGNhbnZhcyBlbGVtZW50ICovXG4gIGNhbnZhc1N0eWxlcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gIC8qKiBXaGV0aGVyIHRvIHVzZSBwaXhlbCBhcnQgb3B0aW1pemVkIHJlbmRlcmluZyAqL1xuICBwaXhlbEFydE1vZGU/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIERlZmF1bHQgc3R5bGVzIGFwcGxpZWQgdG8gdGhlIHJvb3QgZWxlbWVudFxuICovXG5jb25zdCBERUZBVUxUX1JPT1RfU1RZTEVTOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICBkaXNwbGF5OiAnZmxleCcsXG4gIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJyxcbiAgYWxpZ25JdGVtczogJ2NlbnRlcicsXG4gIG92ZXJmbG93OiAnaGlkZGVuJ1xufTtcblxuLyoqXG4gKiBEZWZhdWx0IHN0eWxlcyBhcHBsaWVkIHRvIHRoZSBjYW52YXMgZWxlbWVudCBpbiBwaXhlbCBhcnQgbW9kZVxuICovXG5jb25zdCBQSVhFTF9BUlRfQ0FOVkFTX1NUWUxFUzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgaW1hZ2VSZW5kZXJpbmc6ICdwaXhlbGF0ZWQnXG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSByZXNpemUgaGFuZGxlciBmdW5jdGlvbiB0aGF0IG1haW50YWlucyB0aGUgYXNwZWN0IHJhdGlvIG9mIGEgY2FudmFzXG4gKiBhbmQgY2VudGVycyBpdCB3aXRoaW4gaXRzIHBhcmVudCBlbGVtZW50LlxuICogXG4gKiBAcGFyYW0gb3B0aW9ucyAtIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIHJlc2l6ZSBoYW5kbGVyXG4gKiBAcmV0dXJucyBBIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIGNhbGxlZCB0byBoYW5kbGUgcmVzaXplIGV2ZW50c1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmVzaXplSGFuZGxlcihvcHRpb25zOiBSZXNpemVIYW5kbGVyT3B0aW9ucyk6ICgpID0+IHZvaWQge1xuICBjb25zdCB7XG4gICAgcm9vdEVsZW1lbnQsXG4gICAgd2lkdGgsXG4gICAgaGVpZ2h0LFxuICAgIHJvb3RTdHlsZXMgPSBERUZBVUxUX1JPT1RfU1RZTEVTLFxuICAgIGNhbnZhc1N0eWxlcyA9IHt9LFxuICAgIHBpeGVsQXJ0TW9kZSA9IGZhbHNlXG4gIH0gPSBvcHRpb25zO1xuXG4gIC8vIEFwcGx5IHJvb3QgZWxlbWVudCBzdHlsZXNcbiAgT2JqZWN0LmVudHJpZXMocm9vdFN0eWxlcykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgcm9vdEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoa2V5LCB2YWx1ZSk7XG4gIH0pO1xuXG4gIC8vIENvbWJpbmUgZGVmYXVsdCBjYW52YXMgc3R5bGVzIHdpdGggdXNlci1wcm92aWRlZCBvbmVzXG4gIGNvbnN0IGZpbmFsQ2FudmFzU3R5bGVzID0gcGl4ZWxBcnRNb2RlXG4gICAgPyB7IC4uLlBJWEVMX0FSVF9DQU5WQVNfU1RZTEVTLCAuLi5jYW52YXNTdHlsZXMgfVxuICAgIDogY2FudmFzU3R5bGVzO1xuXG4gIHJldHVybiAoKSA9PiB7XG4gICAgLy8gR2V0IHRoZSBwYXJlbnQgZGltZW5zaW9uc1xuICAgIGNvbnN0IHBhcmVudFdpZHRoID0gcm9vdEVsZW1lbnQuY2xpZW50V2lkdGg7XG4gICAgY29uc3QgcGFyZW50SGVpZ2h0ID0gcm9vdEVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuXG4gICAgLy8gTWFpbnRhaW4gYXNwZWN0IHJhdGlvXG4gICAgY29uc3QgcmF0aW8gPSBNYXRoLm1pbihcbiAgICAgIHBhcmVudFdpZHRoIC8gd2lkdGgsXG4gICAgICBwYXJlbnRIZWlnaHQgLyBoZWlnaHRcbiAgICApO1xuXG4gICAgLy8gVXBkYXRlIHRoZSBjYW52YXMgZWxlbWVudCBpZiBpdCBleGlzdHNcbiAgICBpZiAocm9vdEVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQgaW5zdGFuY2VvZiBIVE1MQ2FudmFzRWxlbWVudCkge1xuICAgICAgY29uc3QgY2FudmFzID0gcm9vdEVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgICBcbiAgICAgIC8vIFNldCBkaW1lbnNpb25zIHdoaWxlIG1haW50YWluaW5nIGFzcGVjdCByYXRpb1xuICAgICAgY2FudmFzLnN0eWxlLndpZHRoID0gYCR7TWF0aC5yb3VuZCh3aWR0aCAqIHJhdGlvKX1weGA7XG4gICAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gYCR7TWF0aC5yb3VuZChoZWlnaHQgKiByYXRpbyl9cHhgO1xuICAgICAgY2FudmFzLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgXG4gICAgICAvLyBBcHBseSBjdXN0b20gY2FudmFzIHN0eWxlc1xuICAgICAgT2JqZWN0LmVudHJpZXMoZmluYWxDYW52YXNTdHlsZXMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBjYW52YXMuc3R5bGUuc2V0UHJvcGVydHkoa2V5LCB2YWx1ZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogU2V0cyB1cCByZXNwb25zaXZlIHJlc2l6aW5nIGZvciBhIFBJWEkgY2FudmFzIGFwcGxpY2F0aW9uXG4gKiBcbiAqIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgcmVzaXplIGhhbmRsZXJcbiAqIEByZXR1cm5zIEEgY2xlYW51cCBmdW5jdGlvbiB0byByZW1vdmUgdGhlIGV2ZW50IGxpc3RlbmVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXR1cFJlc3BvbnNpdmVDYW52YXMob3B0aW9uczogUmVzaXplSGFuZGxlck9wdGlvbnMpOiAoKSA9PiB2b2lkIHtcbiAgY29uc3QgcmVzaXplSGFuZGxlciA9IGNyZWF0ZVJlc2l6ZUhhbmRsZXIob3B0aW9ucyk7XG4gIFxuICAvLyBJbml0aWFsIHJlc2l6ZVxuICByZXNpemVIYW5kbGVyKCk7XG4gIFxuICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHJlc2l6ZUhhbmRsZXIpO1xuICBcbiAgLy8gUmV0dXJuIGNsZWFudXAgZnVuY3Rpb25cbiAgcmV0dXJuICgpID0+IHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcmVzaXplSGFuZGxlcik7XG4gIH07XG59ICIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgQXNzZXRMb2FkZXIgfSBmcm9tICcuLi9jb3JlL2Fzc2V0LWxvYWRlcic7XG5pbXBvcnQgeyBDYW1lcmEgfSBmcm9tICcuLi9jb3JlL2NhbWVyYSc7XG5pbXBvcnQgeyBFbmdpbmUgfSBmcm9tICcuLi9jb3JlL2VuZ2luZSc7XG5pbXBvcnQgeyBSZW5kZXJNYW5hZ2VyIH0gZnJvbSAnLi4vY29yZS9yZW5kZXItbWFuYWdlcic7XG5pbXBvcnQgeyBTY2VuZSB9IGZyb20gJy4uL2NvcmUvc2NlbmUnO1xuaW1wb3J0IHsgUGh5c2ljc1dvcmxkLCB0eXBlIFBoeXNpY3NXb3JsZE9wdGlvbnMgfSBmcm9tICcuL3BoeXNpY3MnO1xuaW1wb3J0IHsgTG9hZGluZ1NjZW5lLCB0eXBlIExvYWRpbmdTY2VuZU9wdGlvbnMgfSBmcm9tICcuL2xvYWRpbmctc2NlbmUnO1xuXG4vKiogT3B0aW9ucyBmb3IgcGl4ZWwtcGVyZmVjdCByZW5kZXJpbmcgKHBpeGVsIGFydCBnYW1lcykuICovXG5leHBvcnQgaW50ZXJmYWNlIFBpeGVsUGVyZmVjdE9wdGlvbnMge1xuICAvKiogRW5hYmxlIHJlc29sdXRpb246MSwgYW50aWFsaWFzOmZhbHNlLCByb3VuZFBpeGVsczp0cnVlLiBEZWZhdWx0IHRydWUuICovXG4gIGVuYWJsZWQ/OiBib29sZWFuO1xuICAvKiogQXBwbHkgQ1NTIGltYWdlUmVuZGVyaW5nOnBpeGVsYXRlZCB0byBjYW52YXMuIERlZmF1bHQgdHJ1ZS4gKi9cbiAgaW1hZ2VSZW5kZXJpbmc/OiBib29sZWFuO1xufVxuXG4vKiogQ29uZmlndXJhdGlvbiBmb3Igc2V0dXBNb3hpKCkuICovXG5leHBvcnQgaW50ZXJmYWNlIFNldHVwTW94aUFyZ3Mge1xuICAvKiogQ29udGFpbmVyIGVsZW1lbnQgdG8gYXR0YWNoIHRoZSBjYW52YXMuICovXG4gIGhvc3RFbGVtZW50OiBIVE1MRWxlbWVudDtcbiAgLyoqIFBJWEkgcmVuZGVyIG9wdGlvbnMgKHdpZHRoLCBoZWlnaHQsIGJhY2tncm91bmRDb2xvciwgZXRjKS4gKi9cbiAgcmVuZGVyT3B0aW9ucz86IFBhcnRpYWw8UElYSS5BdXRvRGV0ZWN0T3B0aW9ucz47XG4gIC8qKiBFbmFibGUgcGh5c2ljcy4gUGFzcyB0cnVlIGZvciBkZWZhdWx0cyBvciBQaHlzaWNzV29ybGRPcHRpb25zLiAqL1xuICBwaHlzaWNzPzogUGh5c2ljc1dvcmxkT3B0aW9ucyB8IGJvb2xlYW47XG4gIC8qKiBTaG93IGxvYWRpbmcgb3ZlcmxheSBkdXJpbmcgYXNzZXQgbG9hZGluZy4gKi9cbiAgc2hvd0xvYWRpbmdTY2VuZT86IGJvb2xlYW47XG4gIC8qKiBDdXN0b21pemUgbG9hZGluZyBzY2VuZSBhcHBlYXJhbmNlLiAqL1xuICBsb2FkaW5nU2NlbmVPcHRpb25zPzogTG9hZGluZ1NjZW5lT3B0aW9ucztcbiAgLyoqIEVuYWJsZSBwaXhlbC1wZXJmZWN0IHJlbmRlcmluZy4gUGFzcyB0cnVlIGZvciBkZWZhdWx0cy4gKi9cbiAgcGl4ZWxQZXJmZWN0PzogYm9vbGVhbiB8IFBpeGVsUGVyZmVjdE9wdGlvbnM7XG59XG5cbi8qKiBSZXR1cm4gdmFsdWUgZnJvbSBzZXR1cE1veGkoKS4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU2V0dXBNb3hpUmVzdWx0IHtcbiAgc2NlbmU6IFNjZW5lO1xuICBlbmdpbmU6IEVuZ2luZTtcbiAgUElYSUFzc2V0czogQXNzZXRMb2FkZXJbJ1BJWElBc3NldHMnXTtcbiAgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI7XG4gIGxvYWRBc3NldHM6IEFzc2V0TG9hZGVyWydsb2FkQXNzZXRzJ107XG4gIGNhbWVyYTogQ2FtZXJhO1xuICBwaHlzaWNzV29ybGQ/OiBQaHlzaWNzV29ybGQ7XG4gIGxvYWRpbmdTY2VuZT86IExvYWRpbmdTY2VuZTtcbn1cblxuLyoqIERlZmF1bHQgUElYSSByZW5kZXIgb3B0aW9ucy4gKi9cbmV4cG9ydCBjb25zdCBkZWZhdWx0UmVuZGVyT3B0aW9ucyA9IHtcbiAgd2lkdGg6IDEyODAsXG4gIGhlaWdodDogNzIwLFxuICBiYWNrZ3JvdW5kQ29sb3I6IDB4MTA5OWJiLFxuICByZXNvbHV0aW9uOiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxLFxuICBhdXRvRGVuc2l0eTogdHJ1ZSxcbiAgYW50aWFsaWFzOiB0cnVlXG59IGFzIFBhcnRpYWw8UElYSS5BdXRvRGV0ZWN0T3B0aW9ucz47XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBNb3hpLiBNYWluIGVudHJ5IHBvaW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3QgeyBzY2VuZSwgZW5naW5lLCBsb2FkQXNzZXRzLCBjYW1lcmEgfSA9IGF3YWl0IHNldHVwTW94aSh7XG4gKiAgIGhvc3RFbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwJyksXG4gKiAgIHJlbmRlck9wdGlvbnM6IHsgd2lkdGg6IDEyODAsIGhlaWdodDogNzIwIH0sXG4gKiAgIHBoeXNpY3M6IHRydWUsXG4gKiAgIHBpeGVsUGVyZmVjdDogdHJ1ZVxuICogfSk7XG4gKlxuICogYXdhaXQgbG9hZEFzc2V0cyhbeyBzcmM6ICcuL3Nwcml0ZS5wbmcnLCBhbGlhczogJ3Nwcml0ZScgfV0pO1xuICogc2NlbmUuYWRkQ2hpbGQoYXNFbnRpdHkobmV3IFBJWEkuU3ByaXRlKFBJWElBc3NldHMuZ2V0KCdzcHJpdGUnKSkpKTtcbiAqIHNjZW5lLmluaXQoKTtcbiAqIGVuZ2luZS5zdGFydCgpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXR1cE1veGkoe1xuICBob3N0RWxlbWVudCxcbiAgcmVuZGVyT3B0aW9ucyA9IGRlZmF1bHRSZW5kZXJPcHRpb25zLFxuICBwaHlzaWNzLFxuICBzaG93TG9hZGluZ1NjZW5lID0gZmFsc2UsXG4gIGxvYWRpbmdTY2VuZU9wdGlvbnMgPSB7fSxcbiAgcGl4ZWxQZXJmZWN0XG59ID0ge30gYXMgU2V0dXBNb3hpQXJncykge1xuICAvLyBQcm9jZXNzIHBpeGVsLXBlcmZlY3Qgb3B0aW9uc1xuICBsZXQgZmluYWxSZW5kZXJPcHRpb25zID0geyAuLi5yZW5kZXJPcHRpb25zIH07XG4gIGxldCBhcHBseUltYWdlUmVuZGVyaW5nID0gZmFsc2U7XG5cbiAgaWYgKHBpeGVsUGVyZmVjdCkge1xuICAgIGNvbnN0IHBwT3B0aW9ucyA9IHR5cGVvZiBwaXhlbFBlcmZlY3QgPT09ICdib29sZWFuJ1xuICAgICAgPyB7IGVuYWJsZWQ6IHRydWUsIGltYWdlUmVuZGVyaW5nOiB0cnVlIH1cbiAgICAgIDogcGl4ZWxQZXJmZWN0O1xuXG4gICAgaWYgKHBwT3B0aW9ucy5lbmFibGVkICE9PSBmYWxzZSkge1xuICAgICAgLy8gQXBwbHkgcGl4ZWwtcGVyZmVjdCByZW5kZXIgc2V0dGluZ3NcbiAgICAgIGZpbmFsUmVuZGVyT3B0aW9ucyA9IHtcbiAgICAgICAgLi4uZmluYWxSZW5kZXJPcHRpb25zLFxuICAgICAgICByZXNvbHV0aW9uOiAxLFxuICAgICAgICBhbnRpYWxpYXM6IGZhbHNlLFxuICAgICAgICByb3VuZFBpeGVsczogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBhcHBseUltYWdlUmVuZGVyaW5nID0gcHBPcHRpb25zLmltYWdlUmVuZGVyaW5nICE9PSBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IHsgcmVuZGVyZXIgfSA9IGF3YWl0IFJlbmRlck1hbmFnZXIuY3JlYXRlKGhvc3RFbGVtZW50LCBmaW5hbFJlbmRlck9wdGlvbnMpO1xuXG4gIC8vIEFwcGx5IGNhbnZhcyBDU1MgZm9yIHBpeGVsLXBlcmZlY3Qgc2NhbGluZyBpZiByZXF1ZXN0ZWRcbiAgaWYgKGFwcGx5SW1hZ2VSZW5kZXJpbmcpIHtcbiAgICBjb25zdCBjYW52YXMgPSByZW5kZXJlci5jYW52YXMgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XG4gICAgY2FudmFzLnN0eWxlLmltYWdlUmVuZGVyaW5nID0gJ3BpeGVsYXRlZCc7XG4gICAgY2FudmFzLnN0eWxlLmltYWdlUmVuZGVyaW5nID0gJy1tb3otY3Jpc3AtZWRnZXMnO1xuICAgIGNhbnZhcy5zdHlsZS5pbWFnZVJlbmRlcmluZyA9ICdjcmlzcC1lZGdlcyc7XG4gIH1cblxuICBjb25zdCBzY2VuZSA9IG5ldyBTY2VuZShyZW5kZXJlcik7XG4gIGNvbnN0IGVuZ2luZSA9IG5ldyBFbmdpbmUoc2NlbmUpO1xuXG4gIC8vIEdldCB0aGUgQXNzZXRMb2FkZXIgaW5zdGFuY2VcbiAgY29uc3QgYXNzZXRMb2FkZXIgPSBuZXcgQXNzZXRMb2FkZXIoKTtcbiAgY29uc3QgeyBQSVhJQXNzZXRzLCBsb2FkQXNzZXRzIH0gPSBhc3NldExvYWRlcjtcblxuICBjb25zdCBjYW1lcmEgPSBuZXcgQ2FtZXJhKHNjZW5lLCByZW5kZXJlcik7XG5cbiAgLy8gU2V0dXAgcGh5c2ljcyBpZiByZXF1ZXN0ZWRcbiAgbGV0IHBoeXNpY3NXb3JsZDogUGh5c2ljc1dvcmxkIHwgdW5kZWZpbmVkO1xuXG4gIGlmIChwaHlzaWNzKSB7XG4gICAgY29uc3QgcGh5c2ljc09wdGlvbnMgPSB0eXBlb2YgcGh5c2ljcyA9PT0gJ2Jvb2xlYW4nXG4gICAgICA/IHt9XG4gICAgICA6IHBoeXNpY3M7XG5cbiAgICBwaHlzaWNzV29ybGQgPSBuZXcgUGh5c2ljc1dvcmxkKHBoeXNpY3NPcHRpb25zKTtcbiAgICBlbmdpbmUuYWRkUGh5c2ljc1dvcmxkKHBoeXNpY3NXb3JsZCk7XG4gIH1cblxuICAvLyBTZXR1cCBsb2FkaW5nIHNjZW5lIGlmIHJlcXVlc3RlZFxuICBsZXQgbG9hZGluZ1NjZW5lOiBMb2FkaW5nU2NlbmUgfCB1bmRlZmluZWQ7XG4gIGlmIChzaG93TG9hZGluZ1NjZW5lKSB7XG4gICAgbG9hZGluZ1NjZW5lID0gbmV3IExvYWRpbmdTY2VuZShsb2FkaW5nU2NlbmVPcHRpb25zKTtcbiAgICBsb2FkaW5nU2NlbmUuekluZGV4ID0gMTAwMDA7IC8vIEVuc3VyZSBpdCdzIG9uIHRvcFxuICAgIGxvYWRpbmdTY2VuZS5pbml0KHJlbmRlcmVyKTtcbiAgICBzY2VuZS5hZGRDaGlsZChsb2FkaW5nU2NlbmUpO1xuICAgIGxvYWRpbmdTY2VuZS5oaWRlKCk7XG5cbiAgICAvLyBIb29rIGludG8gYXNzZXQgbG9hZGluZyBldmVudHNcbiAgICBhc3NldExvYWRlci5vbignbG9hZGluZzpzdGFydCcsICgpID0+IHtcbiAgICAgIGlmIChsb2FkaW5nU2NlbmUpIHtcbiAgICAgICAgbG9hZGluZ1NjZW5lLnNob3coKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGFzc2V0TG9hZGVyLm9uKCdsb2FkaW5nOmVuZCcsICgpID0+IHtcbiAgICAgIGlmIChsb2FkaW5nU2NlbmUpIHtcbiAgICAgICAgbG9hZGluZ1NjZW5lLmhpZGUoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgc2NlbmUsXG4gICAgZW5naW5lLFxuICAgIFBJWElBc3NldHMsXG4gICAgcmVuZGVyZXIsXG4gICAgbG9hZEFzc2V0cyxcbiAgICBjYW1lcmEsXG4gICAgcGh5c2ljc1dvcmxkLFxuICAgIGxvYWRpbmdTY2VuZVxuICB9O1xufVxuXG4iLCJpbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4uL2NvcmUvbG9naWMnO1xuaW1wb3J0IHsgQ29udGFpbmVyLCBSZW5kZXJlciB9IGZyb20gJ3BpeGkuanMnO1xuXG5leHBvcnQgY2xhc3MgU3RhdGVMb2dpYyBleHRlbmRzIExvZ2ljPENvbnRhaW5lcj4ge1xuICBwcml2YXRlIF9lbnRpdHk6IENvbnRhaW5lcjtcblxuICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gIH1cblxuICBnZXQgZW50aXR5KCkge1xuICAgIHJldHVybiB0aGlzLl9lbnRpdHk7XG4gIH1cblxuICBpbml0KGVudGl0eTogQ29udGFpbmVyLCByZW5kZXJlcjogUmVuZGVyZXIpIHtcbiAgICB0aGlzLl9lbnRpdHkgPSBlbnRpdHk7XG4gICAgc3VwZXIuaW5pdChlbnRpdHksIHJlbmRlcmVyKTtcbiAgfVxuXG4gIG9uRW50ZXIoc3RhdGU6IHN0cmluZykge1xuICB9XG5cbiAgb25FeGl0KHN0YXRlOiBzdHJpbmcpIHtcbiAgfVxuXG4gIHVwZGF0ZShlbnRpdHk6IENvbnRhaW5lciwgZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgfVxuICBcbn1cblxuIiwiaW1wb3J0IHsgU3RhdGVMb2dpYyB9IGZyb20gJy4vc3RhdGUtbG9naWMnO1xuXG4vKiogRW1pdHRlZCBvbiBzdGF0ZSB0cmFuc2l0aW9ucy4gKi9cbmV4cG9ydCB0eXBlIFN0YXRlQ2hhbmdlRXZlbnQgPSB7XG4gIHByZXZTdGF0ZTogc3RyaW5nIHwgbnVsbDtcbiAgbmV3U3RhdGU6IHN0cmluZztcbn07XG5cbnR5cGUgU3RhdGVDaGFuZ2VFdmVudExpc3RlbmVyID0gKGV2ZW50OiBTdGF0ZUNoYW5nZUV2ZW50KSA9PiB2b2lkO1xudHlwZSBTdGF0ZUxvZ2ljUmVjb3JkcyA9IFJlY29yZDxzdHJpbmcsIFN0YXRlTG9naWM+O1xuXG4vKipcbiAqIEZpbml0ZSBTdGF0ZSBNYWNoaW5lIGZvciBtYW5hZ2luZyBlbnRpdHkgc3RhdGVzLlxuICogU3RhdGVzIGFyZSBTdGF0ZUxvZ2ljIGluc3RhbmNlcyB3aXRoIG9uRW50ZXIvb25FeGl0L3VwZGF0ZSBtZXRob2RzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogLy8gQ3JlYXRlIHN0YXRlc1xuICogY2xhc3MgSWRsZVN0YXRlIGV4dGVuZHMgU3RhdGVMb2dpYyB7IC4uLiB9XG4gKiBjbGFzcyBSdW5TdGF0ZSBleHRlbmRzIFN0YXRlTG9naWMgeyAuLi4gfVxuICpcbiAqIC8vIENyZWF0ZSBGU00gd2l0aCBzdGF0ZXNcbiAqIGNvbnN0IGZzbSA9IG5ldyBTdGF0ZU1hY2hpbmUoe1xuICogICBpZGxlOiBuZXcgSWRsZVN0YXRlKCksXG4gKiAgIHJ1bjogbmV3IFJ1blN0YXRlKClcbiAqIH0pO1xuICpcbiAqIC8vIENoYW5nZSBzdGF0ZVxuICogZnNtLnNldFN0YXRlKCdpZGxlJyk7XG4gKiBmc20uc2V0U3RhdGUoJ3J1bicpO1xuICpcbiAqIC8vIExpc3RlbiBmb3Igc3RhdGUgY2hhbmdlc1xuICogZnNtLmFkZEV2ZW50TGlzdGVuZXIoJ3N0YXRlQ2hhbmdlJywgKGUpID0+IHtcbiAqICAgY29uc29sZS5sb2coYCR7ZS5kZXRhaWwucHJldlN0YXRlfSAtPiAke2UuZGV0YWlsLm5ld1N0YXRlfWApO1xuICogfSk7XG4gKlxuICogLy8gQ2FsbCBpbiB1cGRhdGUgbG9vcFxuICogZnNtLnVwZGF0ZShkZWx0YVRpbWUpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBTdGF0ZU1hY2hpbmUgZXh0ZW5kcyBFdmVudFRhcmdldCB7XG4gIHByaXZhdGUgX3N0YXRlczogU3RhdGVMb2dpY1JlY29yZHMgPSB7fTtcbiAgcHJpdmF0ZSBfY3VycmVudFN0YXRlOiBTdGF0ZUxvZ2ljIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgX2N1cnJlbnRTdGF0ZU5hbWU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKHN0YXRlczogU3RhdGVMb2dpY1JlY29yZHMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fc3RhdGVzID0gc3RhdGVzO1xuICB9XG5cbiAgdXBkYXRlKGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgaWYgKHRoaXMuX2N1cnJlbnRTdGF0ZSkge1xuICAgICAgdGhpcy5fY3VycmVudFN0YXRlLnVwZGF0ZSh0aGlzLl9jdXJyZW50U3RhdGUuZW50aXR5LCBkZWx0YVRpbWUpO1xuICAgIH1cbiAgfVxuICBcbiAgc2V0U3RhdGUoc3RhdGVOYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBuZXh0U3RhdGUgPSB0aGlzLl9zdGF0ZXNbc3RhdGVOYW1lXTtcbiAgICBpZighbmV4dFN0YXRlKSByZXR1cm47XG5cbiAgICBjb25zdCBwcmV2U3RhdGVOYW1lID0gdGhpcy5fY3VycmVudFN0YXRlTmFtZTtcbiAgICBcbiAgICBpZiAodGhpcy5fY3VycmVudFN0YXRlKSB7XG4gICAgICB0aGlzLl9jdXJyZW50U3RhdGUub25FeGl0KHN0YXRlTmFtZSk7XG4gICAgfVxuXG4gICAgdGhpcy5fY3VycmVudFN0YXRlID0gdGhpcy5fc3RhdGVzW3N0YXRlTmFtZV07XG4gICAgdGhpcy5fY3VycmVudFN0YXRlTmFtZSA9IHN0YXRlTmFtZTtcbiAgICB0aGlzLl9jdXJyZW50U3RhdGUub25FbnRlcihzdGF0ZU5hbWUpO1xuICAgIFxuICAgIC8vIERpc3BhdGNoIHRoZSBzdGF0ZSBjaGFuZ2UgZXZlbnRcbiAgICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudDxTdGF0ZUNoYW5nZUV2ZW50Pignc3RhdGVDaGFuZ2UnLCB7XG4gICAgICBkZXRhaWw6IHtcbiAgICAgICAgcHJldlN0YXRlOiBwcmV2U3RhdGVOYW1lLFxuICAgICAgICBuZXdTdGF0ZTogc3RhdGVOYW1lXG4gICAgICB9XG4gICAgfSk7XG4gICAgXG4gICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgfVxuXG4gIGFkZFN0YXRlKHN0YXRlOiBTdGF0ZUxvZ2ljKSB7XG4gICAgdGhpcy5fc3RhdGVzW3N0YXRlLm5hbWVdID0gc3RhdGU7XG4gIH1cbiAgXG4gIGdldCBjdXJyZW50U3RhdGUoKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRTdGF0ZU5hbWU7XG4gIH1cbn1cblxuIiwiLyoqXG4gKiBVdGlsaXR5IHRvIGNvbnZlcnQgU1ZHIHRvIFBJWEkgdGV4dHVyZVxuICovXG5pbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNWR1RvVGV4dHVyZU9wdGlvbnMge1xuICBzdmdTdHJpbmc6IHN0cmluZztcbiAgd2lkdGg6IG51bWJlcjsgIC8vIERlc2lyZWQgd2lkdGggaW4gYWN0dWFsIHBpeGVsc1xuICBoZWlnaHQ6IG51bWJlcjsgLy8gRGVzaXJlZCBoZWlnaHQgaW4gYWN0dWFsIHBpeGVsc1xuICBjb2xvcj86IG51bWJlcjsgLy8gQ29sb3IgdG8gcmVwbGFjZSBcImN1cnJlbnRDb2xvclwiIHdpdGhcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhbiBTVkcgc3RyaW5nIHRvIGEgUElYSSB0ZXh0dXJlXG4gKiBBY2NvdW50cyBmb3IgcHJvcGVyIHNjYWxpbmcgYW5kIHJlbmRlcnMgYXQgdGhlIGV4YWN0IHBpeGVsIGRpbWVuc2lvbnMgbmVlZGVkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdmdUb1RleHR1cmUob3B0aW9uczogU1ZHVG9UZXh0dXJlT3B0aW9ucyk6IFByb21pc2U8UElYSS5UZXh0dXJlPiB7XG4gIGNvbnN0IHsgc3ZnU3RyaW5nLCB3aWR0aCwgaGVpZ2h0LCBjb2xvciA9IDB4MDAwMDAwIH0gPSBvcHRpb25zO1xuXG4gIC8vIFJlcGxhY2UgY3VycmVudENvbG9yIHdpdGggYWN0dWFsIGNvbG9yXG4gIGNvbnN0IGNvbG9ySGV4ID0gJyMnICsgY29sb3IudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDYsICcwJyk7XG4gIGNvbnN0IHByb2Nlc3NlZFNWRyA9IHN2Z1N0cmluZy5yZXBsYWNlKC9jdXJyZW50Q29sb3IvZywgY29sb3JIZXgpO1xuXG4gIC8vIENyZWF0ZSBhIGJsb2IgZnJvbSB0aGUgU1ZHIHN0cmluZ1xuICBjb25zdCBibG9iID0gbmV3IEJsb2IoW3Byb2Nlc3NlZFNWR10sIHsgdHlwZTogJ2ltYWdlL3N2Zyt4bWwnIH0pO1xuICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuXG4gIC8vIExvYWQgYXMgaW1hZ2VcbiAgY29uc3QgaW1nID0gbmV3IEltYWdlKCk7XG4gIGltZy53aWR0aCA9IHdpZHRoO1xuICBpbWcuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpbWcub25sb2FkID0gKCkgPT4gcmVzb2x2ZSgpO1xuICAgIGltZy5vbmVycm9yID0gcmVqZWN0O1xuICAgIGltZy5zcmMgPSB1cmw7XG4gIH0pO1xuXG4gIC8vIENyZWF0ZSBjYW52YXMgYW5kIGRyYXcgdGhlIGltYWdlIGF0IHRoZSBleGFjdCBzaXplXG4gIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICBjYW52YXMud2lkdGggPSB3aWR0aDtcbiAgY2FudmFzLmhlaWdodCA9IGhlaWdodDtcbiAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgaWYgKCFjdHgpIHtcbiAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IGNhbnZhcyBjb250ZXh0Jyk7XG4gIH1cblxuICAvLyBEcmF3IHRoZSBpbWFnZVxuICBjdHguZHJhd0ltYWdlKGltZywgMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgLy8gQ2xlYW4gdXBcbiAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xuXG4gIC8vIENyZWF0ZSB0ZXh0dXJlIGZyb20gY2FudmFzXG4gIGNvbnN0IHRleHR1cmUgPSBQSVhJLlRleHR1cmUuZnJvbShjYW52YXMpO1xuICB0ZXh0dXJlLnNvdXJjZS5zY2FsZU1vZGUgPSAnbGluZWFyJzsgLy8gU21vb3RoIHNjYWxpbmcgZm9yIFNWR1xuXG4gIHJldHVybiB0ZXh0dXJlO1xufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbi8qKlxuICogU2VxdWVuY2UgaW5mb3JtYXRpb24gZm9yIGFuIGFuaW1hdGlvblxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNlcXVlbmNlSW5mbyB7XG4gIC8qKiBBcnJheSBvZiBmcmFtZSBpbmRpY2VzIGZyb20gdGhlIHRleHR1cmUgYXRsYXMgKi9cbiAgZnJhbWVzOiBudW1iZXJbXTtcbiAgLyoqIFNwZWVkIG9mIGFuaW1hdGlvbiAoZnJhbWVzIHBlciBtcykgKi9cbiAgYW5pbWF0aW9uU3BlZWQ6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBNYW5hZ2VzIGZyYW1lIHNlcXVlbmNlcyBmb3IgYW5pbWF0ZWQgc3ByaXRlc1xuICogUHJvdmlkZXMgdXRpbGl0eSBmdW5jdGlvbnMgZm9yIHdvcmtpbmcgd2l0aCBzcHJpdGUgc2hlZXQgYW5pbWF0aW9uc1xuICovXG5leHBvcnQgY2xhc3MgVGV4dHVyZUZyYW1lU2VxdWVuY2VzIHtcbiAgcHJpdmF0ZSBmcmFtZXM6IFBJWEkuVGV4dHVyZVtdID0gW107XG4gIHByaXZhdGUgc2VxdWVuY2VzOiBSZWNvcmQ8c3RyaW5nLCBTZXF1ZW5jZUluZm8+ID0ge307XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIG5ldyBUZXh0dXJlRnJhbWVTZXF1ZW5jZXNcbiAgICogQHBhcmFtIGZyYW1lcyAtIEFycmF5IG9mIHRleHR1cmVzIGZyb20gYSBzcHJpdGVzaGVldFxuICAgKiBAcGFyYW0gc2VxdWVuY2VzIC0gTmFtZWQgc2VxdWVuY2VzIHdpdGggZnJhbWUgaW5kaWNlcyBhbmQgYW5pbWF0aW9uIHNwZWVkXG4gICAqL1xuICBjb25zdHJ1Y3RvcihmcmFtZXM6IFBJWEkuVGV4dHVyZVtdLCBzZXF1ZW5jZXM6IFJlY29yZDxzdHJpbmcsIFNlcXVlbmNlSW5mbz4gPSB7fSkge1xuICAgIHRoaXMuZnJhbWVzID0gZnJhbWVzO1xuICAgIHRoaXMuc2VxdWVuY2VzID0gc2VxdWVuY2VzO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhIG5ldyBhbmltYXRpb24gc2VxdWVuY2VcbiAgICogQHBhcmFtIG5hbWUgLSBVbmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHNlcXVlbmNlXG4gICAqIEBwYXJhbSBmcmFtZUluZGljZXMgLSBBcnJheSBvZiBmcmFtZSBpbmRpY2VzIGZyb20gdGhlIHRleHR1cmUgYXRsYXNcbiAgICogQHBhcmFtIGFuaW1hdGlvblNwZWVkIC0gU3BlZWQgb2YgYW5pbWF0aW9uIChmcmFtZXMgcGVyIG1zKVxuICAgKi9cbiAgYWRkU2VxdWVuY2UobmFtZTogc3RyaW5nLCBmcmFtZUluZGljZXM6IG51bWJlcltdLCBhbmltYXRpb25TcGVlZDogbnVtYmVyID0gMSkge1xuICAgIHRoaXMuc2VxdWVuY2VzW25hbWVdID0ge1xuICAgICAgZnJhbWVzOiBmcmFtZUluZGljZXMsXG4gICAgICBhbmltYXRpb25TcGVlZFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgc2VxdWVuY2UgYnkgbmFtZVxuICAgKi9cbiAgZ2V0U2VxdWVuY2UobmFtZTogc3RyaW5nKTogU2VxdWVuY2VJbmZvIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuc2VxdWVuY2VzW25hbWVdIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgc3BlY2lmaWMgZnJhbWUgYnkgaW5kZXhcbiAgICovXG4gIGdldEZyYW1lKGluZGV4OiBudW1iZXIpOiBQSVhJLlRleHR1cmUgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5mcmFtZXNbaW5kZXhdIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgc3BlY2lmaWMgZnJhbWUgZnJvbSBhIHNlcXVlbmNlIGJ5IGluZGV4XG4gICAqL1xuICBnZXRGcmFtZUZyb21TZXF1ZW5jZShzZXF1ZW5jZU5hbWU6IHN0cmluZywgZnJhbWVJbmRleDogbnVtYmVyKTogUElYSS5UZXh0dXJlIHwgbnVsbCB7XG4gICAgY29uc3Qgc2VxdWVuY2UgPSB0aGlzLmdldFNlcXVlbmNlKHNlcXVlbmNlTmFtZSk7XG4gICAgaWYgKCFzZXF1ZW5jZSkgcmV0dXJuIG51bGw7XG4gICAgXG4gICAgLy8gR2V0IHRoZSBhcHByb3ByaWF0ZSBmcmFtZSBpbmRleCBmcm9tIHRoZSBzZXF1ZW5jZVxuICAgIGNvbnN0IHNlcXVlbmNlRnJhbWVJbmRleCA9IHNlcXVlbmNlLmZyYW1lc1tmcmFtZUluZGV4ICUgc2VxdWVuY2UuZnJhbWVzLmxlbmd0aF07XG4gICAgXG4gICAgLy8gUmV0dXJuIHRoZSB0ZXh0dXJlXG4gICAgcmV0dXJuIHRoaXMuZnJhbWVzW3NlcXVlbmNlRnJhbWVJbmRleF0gfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIGZyYW1lcyBmb3IgYSBzZXF1ZW5jZVxuICAgKi9cbiAgZ2V0RnJhbWVTZXF1ZW5jZShuYW1lOiBzdHJpbmcpOiBQSVhJLlRleHR1cmVbXSB7XG4gICAgY29uc3Qgc2VxdWVuY2UgPSB0aGlzLmdldFNlcXVlbmNlKG5hbWUpO1xuICAgIGlmICghc2VxdWVuY2UpIHJldHVybiBbXTtcbiAgICBcbiAgICByZXR1cm4gc2VxdWVuY2UuZnJhbWVzLm1hcChpbmRleCA9PiB0aGlzLmZyYW1lc1tpbmRleF0pLmZpbHRlcihCb29sZWFuKTtcbiAgfVxufSAiLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcblxuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGNyZWF0aW5nIHRleHR1cmUgZnJhbWVzIGZyb20gYSBzcHJpdGVzaGVldFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEFzVGV4dHVyZUZyYW1lc09wdGlvbnMge1xuICAvKipcbiAgICogV2lkdGggb2YgZWFjaCBmcmFtZSBpbiBwaXhlbHNcbiAgICovXG4gIGZyYW1lV2lkdGg6IG51bWJlcjtcbiAgXG4gIC8qKlxuICAgKiBIZWlnaHQgb2YgZWFjaCBmcmFtZSBpbiBwaXhlbHNcbiAgICovXG4gIGZyYW1lSGVpZ2h0OiBudW1iZXI7XG4gIFxuICAvKipcbiAgICogTnVtYmVyIG9mIGNvbHVtbnMgaW4gdGhlIHNwcml0ZXNoZWV0XG4gICAqL1xuICBjb2x1bW5zOiBudW1iZXI7XG4gIFxuICAvKipcbiAgICogTnVtYmVyIG9mIHJvd3MgaW4gdGhlIHNwcml0ZXNoZWV0XG4gICAqL1xuICByb3dzOiBudW1iZXI7XG59XG5cbi8qKlxuICogRGVmYXVsdCB0ZXh0dXJlIGZyYW1lIG9wdGlvbnNcbiAqL1xuY29uc3QgZGVmYXVsdE9wdGlvbnM6IEFzVGV4dHVyZUZyYW1lc09wdGlvbnMgPSB7IFxuICBmcmFtZVdpZHRoOiA0OCwgXG4gIGZyYW1lSGVpZ2h0OiA0OCwgXG4gIGNvbHVtbnM6IDQsIFxuICByb3dzOiA0IFxufTtcblxuLyoqXG4gKiBTcGxpdHMgYSB0ZXh0dXJlIHNvdXJjZSBpbnRvIGluZGl2aWR1YWwgdGV4dHVyZSBmcmFtZXMgYmFzZWQgb24gYSBncmlkIGxheW91dFxuICogXG4gKiBAcGFyYW0gdGV4dHVyZVNvdXJjZSAtIFRoZSBzb3VyY2UgdGV4dHVyZSB0byBzcGxpdCBpbnRvIGZyYW1lc1xuICogQHBhcmFtIG9wdGlvbnMgLSBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIGZyYW1lIGV4dHJhY3Rpb25cbiAqIEByZXR1cm5zIEFycmF5IG9mIGluZGl2aWR1YWwgdGV4dHVyZSBmcmFtZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzVGV4dHVyZUZyYW1lcyhcbiAgUElYSSxcbiAgdGV4dHVyZVNvdXJjZTogUElYSS5UZXh0dXJlU291cmNlLCBcbiAgb3B0aW9uczogQXNUZXh0dXJlRnJhbWVzT3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zLFxuKTogUElYSS5UZXh0dXJlPFBJWEkuVGV4dHVyZVNvdXJjZTxhbnk+PltdIHtcbiAgY29uc3QgeyBmcmFtZVdpZHRoLCBmcmFtZUhlaWdodCwgY29sdW1ucywgcm93cyB9ID0gb3B0aW9ucztcbiAgY29uc3QgZnJhbWVzOiBQSVhJLlRleHR1cmU8UElYSS5UZXh0dXJlU291cmNlPGFueT4+W10gPSBbXTtcblxuICAvLyBFbnN1cmUgd2UncmUgd29ya2luZyB3aXRoIGEgdmFsaWRhdGVkIHRleHR1cmUgc291cmNlXG4gIGlmICghdGV4dHVyZVNvdXJjZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgdGV4dHVyZSBzb3VyY2UgcHJvdmlkZWQgdG8gYXNUZXh0dXJlRnJhbWVzJyk7XG4gICAgcmV0dXJuIGZyYW1lcztcbiAgfVxuXG4gIC8vIENyZWF0ZSB0ZXh0dXJlcyBmcm9tIHRoZSB0ZXh0dXJlIHNvdXJjZSAtIGtlZXBpbmcgaW1wbGVtZW50YXRpb24gaWRlbnRpY2FsIHRvIHdvcmtpbmcgdmVyc2lvblxuICBmb3IgKGxldCB5ID0gMDsgeSA8IHJvd3M7IHkrKykge1xuICAgIGZvciAobGV0IHggPSAwOyB4IDwgY29sdW1uczsgeCsrKSB7XG4gICAgICBjb25zdCBmcmFtZSA9IG5ldyBQSVhJLlJlY3RhbmdsZSh4ICogZnJhbWVXaWR0aCwgeSAqIGZyYW1lSGVpZ2h0LCBmcmFtZVdpZHRoLCBmcmFtZUhlaWdodCk7XG4gICAgICBcbiAgICAgIC8vIEtlZXAgdGhlIGV4YWN0IHNhbWUgaW1wbGVtZW50YXRpb24gYXMgdGhlIHdvcmtpbmcgZXhhbXBsZVxuICAgICAgY29uc3QgZnJhbWV0ZXh0dXJlID0gbmV3IFBJWEkuVGV4dHVyZSh7XG4gICAgICAgIHNvdXJjZTogdGV4dHVyZVNvdXJjZSxcbiAgICAgICAgZnJhbWU6IGZyYW1lLFxuICAgICAgfSkgYXMgUElYSS5UZXh0dXJlPFBJWEkuVGV4dHVyZVNvdXJjZTxhbnk+PjtcbiAgICAgIFxuICAgICAgZnJhbWVzLnB1c2goZnJhbWV0ZXh0dXJlKTtcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiBmcmFtZXMgYXMgUElYSS5UZXh0dXJlPFBJWEkuVGV4dHVyZVNvdXJjZTxhbnk+PltdO1xufVxuIiwiaW1wb3J0IHsgUG9pbnQgfSBmcm9tICdwaXhpLmpzJztcblxuLyoqXG4gKiBDb21tb25seSB1c2VkIFBvaW50IGZhY3RvcnkgZnVuY3Rpb25zXG4gKiBUaGVzZSByZWR1Y2Ugb2JqZWN0IGFsbG9jYXRpb25zIGFuZCBjbGFyaWZ5IGludGVudFxuICovXG5leHBvcnQgY29uc3QgY3JlYXRlUG9pbnQgPSAoeCA9IDAsIHkgPSAwKTogUG9pbnQgPT4gbmV3IFBvaW50KHgsIHkpO1xuZXhwb3J0IGNvbnN0IFpFUk9fUE9JTlQgPSAoKTogUG9pbnQgPT4gbmV3IFBvaW50KDAsIDApO1xuZXhwb3J0IGNvbnN0IE9ORV9QT0lOVCA9ICgpOiBQb2ludCA9PiBuZXcgUG9pbnQoMSwgMSk7XG5cbmV4cG9ydCBjb25zdCB1YyA9IChzID0gJycpID0+IHMudG9VcHBlckNhc2UoKTtcbmV4cG9ydCBjb25zdCBsYyA9IChzID0gJycpID0+IHMudG9Mb3dlckNhc2UoKTtcblxuZXhwb3J0IGNvbnN0IHBhZFJpZ2h0ID0gKHZhbCA9ICcnLCBsZW5ndGggPSAwLCBwYWRXaXRoID0gJyAnKSA9PiB7XG4gIGxldCByZXN1bHQgPSB2YWwrJyc7XG4gIHdoaWxlKHJlc3VsdC5sZW5ndGggPCBsZW5ndGgpe1xuICAgIHJlc3VsdCArPSBwYWRXaXRoO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5leHBvcnQgY29uc3QgcHIgPSBwYWRSaWdodDtcblxuLyoqXG4gKiBHZW5lcmF0ZSByYW5kb20gaW50ZWdlciBiZXR3ZWVuIG1pbiBhbmQgbWF4IChpbmNsdXNpdmUpXG4gKiBAcGFyYW0gbWluIC0gTWluaW11bSB2YWx1ZSAoaW5jbHVzaXZlKVxuICogQHBhcmFtIG1heCAtIE1heGltdW0gdmFsdWUgKGluY2x1c2l2ZSlcbiAqIEByZXR1cm5zIFJhbmRvbSBpbnRlZ2VyIGluIHJhbmdlIFttaW4sIG1heF1cbiAqL1xuZXhwb3J0IGNvbnN0IGdldFJhbmRvbUludCA9IChtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIgPT4gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggKyAxIC0gbWluKSkgKyBtaW4pO1xuXG5leHBvcnQgY29uc3Qgcm91bmRUbyA9IChwbGFjZXMsIHZhbHVlKSA9PiAoTWF0aC5yb3VuZCh2YWx1ZSAqIE1hdGgucG93KDEwLCBwbGFjZXMpKSAvIE1hdGgucG93KDEwLCBwbGFjZXMpKTtcblxuZXhwb3J0IGNvbnN0IGxlcnAgPSAoYmVnaW4sIGVuZCwgbWFnKSA9PiAoKDEgLSBtYWcpICogYmVnaW4gKyBtYWcgKiBlbmQpO1xuXG5leHBvcnQgZnVuY3Rpb24gbWV0ZXJzVG9QaXhlbHMobTogbnVtYmVyKTogbnVtYmVyIHsgcmV0dXJuIG0gKiAyMDsgfVxuXG5leHBvcnQgZnVuY3Rpb24gcGl4ZWxzVG9NZXRlcnMocDogbnVtYmVyKTogbnVtYmVyIHsgcmV0dXJuIHAgKiAwLjA1OyB9XG5cbmV4cG9ydCBjb25zdCBmZXRjaFhtbCA9IGFzeW5jICh1cmw6IHN0cmluZykgPT4gKGF3YWl0IChhd2FpdCBmZXRjaCh1cmwpKS50ZXh0KCkpO1xuXG5leHBvcnQgY29uc3QgcmFkMmRlZyA9IChyYWQ6IG51bWJlcikgPT4gcmFkICogKDE4MCAvIE1hdGguUEkpO1xuZXhwb3J0IGNvbnN0IGRlZzJyYWQgPSAoZGVnOiBudW1iZXIpID0+IGRlZyAqIChNYXRoLlBJIC8gMTgwKTtcbiAgIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJU2NhbGVNb2RlIH0gZnJvbSAnLi9VSVNjYWxlTW9kZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVUlMYXllck9wdGlvbnMge1xuICAvKipcbiAgICogU2NhbGluZyBtb2RlIGZvciB0aGlzIFVJIGxheWVyXG4gICAqIEBkZWZhdWx0IFVJU2NhbGVNb2RlLk5vbmVcbiAgICovXG4gIHNjYWxlTW9kZT86IFVJU2NhbGVNb2RlO1xuXG4gIC8qKlxuICAgKiBUYXJnZXQgd2lkdGggZm9yIHRoZSBVSSBsYXllciAodXNlZCBhcyByZWZlcmVuY2UgZm9yIHNjYWxpbmcpXG4gICAqIElmIG5vdCBwcm92aWRlZCwgdXNlcyB0aGUgZmlyc3QgY2hpbGQncyB3aWR0aFxuICAgKi9cbiAgdGFyZ2V0V2lkdGg/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRhcmdldCBoZWlnaHQgZm9yIHRoZSBVSSBsYXllciAodXNlZCBhcyByZWZlcmVuY2UgZm9yIHNjYWxpbmcpXG4gICAqIElmIG5vdCBwcm92aWRlZCwgdXNlcyB0aGUgZmlyc3QgY2hpbGQncyBoZWlnaHRcbiAgICovXG4gIHRhcmdldEhlaWdodD86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBVSUxheWVyIGlzIGEgY29udGFpbmVyIHRoYXQgbWFuYWdlcyBzY2FsaW5nIGJlaGF2aW9yIGZvciBhbGwgaXRzIGNoaWxkcmVuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGh1ZExheWVyID0gbmV3IFVJTGF5ZXIoeyBzY2FsZU1vZGU6IFVJU2NhbGVNb2RlLlNjYWxlVUkgfSk7XG4gKiBzY2VuZS5hZGRDaGlsZChodWRMYXllcik7XG4gKiBodWRMYXllci5hZGRDaGlsZCh0YWJzLmNvbnRhaW5lcik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJTGF5ZXIgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lciB7XG4gIHByaXZhdGUgc2NhbGVNb2RlOiBVSVNjYWxlTW9kZTtcbiAgcHJpdmF0ZSB0YXJnZXRXaWR0aD86IG51bWJlcjtcbiAgcHJpdmF0ZSB0YXJnZXRIZWlnaHQ/OiBudW1iZXI7XG4gIHByaXZhdGUgaW5pdGlhbEJvdW5kc1JlY29yZGVkID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogVUlMYXllck9wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5zY2FsZU1vZGUgPSBvcHRpb25zLnNjYWxlTW9kZSA/PyBVSVNjYWxlTW9kZS5Ob25lO1xuICAgIHRoaXMudGFyZ2V0V2lkdGggPSBvcHRpb25zLnRhcmdldFdpZHRoO1xuICAgIHRoaXMudGFyZ2V0SGVpZ2h0ID0gb3B0aW9ucy50YXJnZXRIZWlnaHQ7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBsYXllcidzIHNjYWxlIGJhc2VkIG9uIHRoZSBjdXJyZW50IGNhbnZhcyBzaXplXG4gICAqL1xuICB1cGRhdGVTY2FsZShjYW52YXNXaWR0aDogbnVtYmVyLCBjYW52YXNIZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGlmICh0aGlzLnNjYWxlTW9kZSA9PT0gVUlTY2FsZU1vZGUuTm9uZSkge1xuICAgICAgdGhpcy5zY2FsZS5zZXQoMSwgMSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gUmVjb3JkIGluaXRpYWwgYm91bmRzIGZyb20gZmlyc3QgY2hpbGQgaWYgbm90IGV4cGxpY2l0bHkgc2V0XG4gICAgaWYgKCF0aGlzLmluaXRpYWxCb3VuZHNSZWNvcmRlZCAmJiB0aGlzLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgIGlmICghdGhpcy50YXJnZXRXaWR0aCB8fCAhdGhpcy50YXJnZXRIZWlnaHQpIHtcbiAgICAgICAgY29uc3QgYm91bmRzID0gdGhpcy5nZXRMb2NhbEJvdW5kcygpO1xuICAgICAgICB0aGlzLnRhcmdldFdpZHRoID0gdGhpcy50YXJnZXRXaWR0aCA/PyBib3VuZHMud2lkdGg7XG4gICAgICAgIHRoaXMudGFyZ2V0SGVpZ2h0ID0gdGhpcy50YXJnZXRIZWlnaHQgPz8gYm91bmRzLmhlaWdodDtcbiAgICAgIH1cbiAgICAgIHRoaXMuaW5pdGlhbEJvdW5kc1JlY29yZGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMudGFyZ2V0V2lkdGggfHwgIXRoaXMudGFyZ2V0SGVpZ2h0KSB7XG4gICAgICAvLyBObyBkaW1lbnNpb25zIHRvIHNjYWxlIGZyb20geWV0XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgc2NhbGVYID0gY2FudmFzV2lkdGggLyB0aGlzLnRhcmdldFdpZHRoO1xuICAgIGNvbnN0IHNjYWxlWSA9IGNhbnZhc0hlaWdodCAvIHRoaXMudGFyZ2V0SGVpZ2h0O1xuXG4gICAgc3dpdGNoICh0aGlzLnNjYWxlTW9kZSkge1xuICAgICAgY2FzZSBVSVNjYWxlTW9kZS5TY2FsZVVJOlxuICAgICAgICAvLyBTY2FsZSB0byBmaWxsLCBzdHJldGNoaW5nIGlmIG5lY2Vzc2FyeVxuICAgICAgICB0aGlzLnNjYWxlLnNldChzY2FsZVgsIHNjYWxlWSk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFVJU2NhbGVNb2RlLkxvY2tSYXRpbzpcbiAgICAgICAgLy8gU2NhbGUgbWFpbnRhaW5pbmcgYXNwZWN0IHJhdGlvXG4gICAgICAgIGNvbnN0IHNjYWxlID0gTWF0aC5taW4oc2NhbGVYLCBzY2FsZVkpO1xuICAgICAgICB0aGlzLnNjYWxlLnNldChzY2FsZSwgc2NhbGUpO1xuICAgICAgICAvLyBDZW50ZXIgdGhlIGNvbnRlbnRcbiAgICAgICAgdGhpcy5wb3NpdGlvbi5zZXQoXG4gICAgICAgICAgKGNhbnZhc1dpZHRoIC0gdGhpcy50YXJnZXRXaWR0aCAqIHNjYWxlKSAvIDIsXG4gICAgICAgICAgKGNhbnZhc0hlaWdodCAtIHRoaXMudGFyZ2V0SGVpZ2h0ICogc2NhbGUpIC8gMlxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgY2hpbGQgYW5kIHRyaWdnZXIgc2NhbGUgdXBkYXRlIGlmIG5lZWRlZFxuICAgKi9cbiAgb3ZlcnJpZGUgYWRkQ2hpbGQ8VCBleHRlbmRzIFBJWEkuQ29udGFpbmVyW10+KC4uLmNoaWxkcmVuOiBUKTogVFswXSB7XG4gICAgY29uc3QgcmVzdWx0ID0gc3VwZXIuYWRkQ2hpbGQoLi4uY2hpbGRyZW4pO1xuICAgIHRoaXMuaW5pdGlhbEJvdW5kc1JlY29yZGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxufVxuIiwiLyoqXG4gKiBVSSBTY2FsaW5nIG1vZGVzIGZvciBVSUxheWVyXG4gKi9cbmV4cG9ydCBlbnVtIFVJU2NhbGVNb2RlIHtcbiAgLyoqXG4gICAqIE5vIHNjYWxpbmcgLSAxOjEgcGl4ZWwgbWFwcGluZywgbm8gb2Zmc2V0IGNhbGN1bGF0aW9uc1xuICAgKi9cbiAgTm9uZSA9ICdub25lJyxcblxuICAvKipcbiAgICogU2NhbGUgVUkgcHJvcG9ydGlvbmFsbHkgdG8gZmlsbCB0aGUgYXZhaWxhYmxlIHNwYWNlXG4gICAqL1xuICBTY2FsZVVJID0gJ3NjYWxlVUknLFxuXG4gIC8qKlxuICAgKiBTY2FsZSB3aGlsZSBtYWludGFpbmluZyBhc3BlY3QgcmF0aW8gKG1heSBsZXR0ZXJib3gvcGlsbGFyYm94KVxuICAgKi9cbiAgTG9ja1JhdGlvID0gJ2xvY2tSYXRpbydcbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgQnV0dG9uU3RhdGUgfSBmcm9tICcuL3VpLWJ1dHRvbic7XG5pbXBvcnQgeyBVSVBhbmVsIH0gZnJvbSAnLi91aS1wYW5lbCc7XG5cbi8qKlxuICogU3RyYXRlZ3kgaW50ZXJmYWNlIGZvciBidXR0b24gYmFja2dyb3VuZCByZW5kZXJpbmdcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBCdXR0b25CYWNrZ3JvdW5kU3RyYXRlZ3kge1xuICAvKipcbiAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyB0aGUgYmFja2dyb3VuZCBjb250YWluZXJcbiAgICovXG4gIGNyZWF0ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IFBJWEkuQ29udGFpbmVyO1xuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSB2aXN1YWwgc3RhdGUgb2YgdGhlIGJhY2tncm91bmRcbiAgICovXG4gIHVwZGF0ZVN0YXRlKHN0YXRlOiBCdXR0b25TdGF0ZSk6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGFjdHVhbCByZW5kZXJlZCBoZWlnaHQgb2YgdGhlIGJhY2tncm91bmRcbiAgICovXG4gIGdldEFjdHVhbEhlaWdodCgpOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIENsZWFucyB1cCByZXNvdXJjZXNcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZDtcbn1cblxuLyoqXG4gKiBTb2xpZCBjb2xvciBiYWNrZ3JvdW5kIHN0cmF0ZWd5IHVzaW5nIFVJUGFuZWxcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGNsYXNzIFNvbGlkQ29sb3JCYWNrZ3JvdW5kU3RyYXRlZ3kgaW1wbGVtZW50cyBCdXR0b25CYWNrZ3JvdW5kU3RyYXRlZ3kge1xuICBwcml2YXRlIHBhbmVsPzogVUlQYW5lbDtcbiAgcHJpdmF0ZSBub3JtYWxDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIGhvdmVyQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBwcmVzc2VkQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBkaXNhYmxlZENvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgd2lkdGg6IG51bWJlcjtcbiAgcHJpdmF0ZSBoZWlnaHQ6IG51bWJlcjtcbiAgcHJpdmF0ZSBib3JkZXJSYWRpdXM6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IG51bWJlcixcbiAgICB3aWR0aDogbnVtYmVyLFxuICAgIGhlaWdodDogbnVtYmVyLFxuICAgIGJvcmRlclJhZGl1czogbnVtYmVyXG4gICkge1xuICAgIHRoaXMubm9ybWFsQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3I7XG4gICAgdGhpcy5ob3ZlckNvbG9yID0gdGhpcy5kYXJrZW5Db2xvcihiYWNrZ3JvdW5kQ29sb3IsIDAuOSk7XG4gICAgdGhpcy5wcmVzc2VkQ29sb3IgPSB0aGlzLmRhcmtlbkNvbG9yKGJhY2tncm91bmRDb2xvciwgMC44KTtcbiAgICB0aGlzLmRpc2FibGVkQ29sb3IgPSAweDg4ODg4ODtcbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgdGhpcy5ib3JkZXJSYWRpdXMgPSBib3JkZXJSYWRpdXM7XG4gIH1cblxuICBjcmVhdGUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiBQSVhJLkNvbnRhaW5lciB7XG4gICAgdGhpcy5wYW5lbCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5ub3JtYWxDb2xvcixcbiAgICAgIHdpZHRoLFxuICAgICAgaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuXG4gICAgdGhpcy5wYW5lbC5sYXlvdXQod2lkdGgsIGhlaWdodCk7XG4gICAgcmV0dXJuIHRoaXMucGFuZWwuY29udGFpbmVyO1xuICB9XG5cbiAgdXBkYXRlU3RhdGUoc3RhdGU6IEJ1dHRvblN0YXRlKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLnBhbmVsKSByZXR1cm47XG5cbiAgICBsZXQgY29sb3I6IG51bWJlcjtcbiAgICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgICBjYXNlIEJ1dHRvblN0YXRlLk5vcm1hbDpcbiAgICAgICAgY29sb3IgPSB0aGlzLm5vcm1hbENvbG9yO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgQnV0dG9uU3RhdGUuSG92ZXI6XG4gICAgICAgIGNvbG9yID0gdGhpcy5ob3ZlckNvbG9yO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgQnV0dG9uU3RhdGUuUHJlc3NlZDpcbiAgICAgICAgY29sb3IgPSB0aGlzLnByZXNzZWRDb2xvcjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEJ1dHRvblN0YXRlLkRpc2FibGVkOlxuICAgICAgICBjb2xvciA9IHRoaXMuZGlzYWJsZWRDb2xvcjtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgdGhpcy5wYW5lbC5zZXRCYWNrZ3JvdW5kQ29sb3IoY29sb3IpO1xuICB9XG5cbiAgZ2V0QWN0dWFsSGVpZ2h0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuaGVpZ2h0O1xuICB9XG5cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAvLyBVSVBhbmVsIGNsZWFudXAgaGFuZGxlZCBieSBjb250YWluZXJcbiAgfVxuXG4gIHByaXZhdGUgZGFya2VuQ29sb3IoY29sb3I6IG51bWJlciwgZmFjdG9yOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IHIgPSAoKGNvbG9yID4+IDE2KSAmIDB4ZmYpICogZmFjdG9yO1xuICAgIGNvbnN0IGcgPSAoKGNvbG9yID4+IDgpICYgMHhmZikgKiBmYWN0b3I7XG4gICAgY29uc3QgYiA9IChjb2xvciAmIDB4ZmYpICogZmFjdG9yO1xuICAgIHJldHVybiAoKHIgPDwgMTYpIHwgKGcgPDwgOCkgfCBiKSA+Pj4gMDtcbiAgfVxufVxuXG4vKipcbiAqIENvbmZpZ3VyYXRpb24gZm9yIGljb24gb3ZlcmxheXNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJY29uQ29uZmlnIHtcbiAgLyoqIFNwcml0ZXNoZWV0IGNvbnRhaW5pbmcgdGhlIGljb24gdGV4dHVyZSAqL1xuICBzcHJpdGVzaGVldDogUElYSS5TcHJpdGVzaGVldDtcbiAgLyoqIFRleHR1cmUgbmFtZSBpbiB0aGUgc3ByaXRlc2hlZXQgKi9cbiAgdGV4dHVyZU5hbWU6IHN0cmluZztcbiAgLyoqIEljb24gc2NhbGUgKGRlZmF1bHQ6IDEuMCkgKi9cbiAgc2NhbGU/OiBudW1iZXI7XG4gIC8qKiBVc2UgcGl4ZWwtcGVyZmVjdCByZW5kZXJpbmcgKi9cbiAgcGl4ZWxQZXJmZWN0PzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIGZvciBzcHJpdGUtYmFzZWQgYmFja2dyb3VuZHNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnIHtcbiAgLyoqIFNwcml0ZXNoZWV0IGNvbnRhaW5pbmcgdGhlIGJ1dHRvbiB0ZXh0dXJlcyAqL1xuICBzcHJpdGVzaGVldDogUElYSS5TcHJpdGVzaGVldDtcbiAgLyoqIFRleHR1cmUgbmFtZSBwYXR0ZXJuIC0gdXNlIHtjb2xvcn0gcGxhY2Vob2xkZXIuIEV4YW1wbGU6IFwiYmFySG9yaXpvbnRhbF97Y29sb3J9X2xlZnQucG5nXCIgKi9cbiAgdGV4dHVyZVBhdHRlcm46IHN0cmluZztcbiAgLyoqIENvbG9yIHZhcmlhbnQgdG8gdXNlIChlLmcuLCAnYmx1ZScsICdncmVlbicsICdyZWQnKSAqL1xuICBjb2xvcjogc3RyaW5nO1xuICAvKiogVXNlIHBpeGVsLXBlcmZlY3QgcmVuZGVyaW5nIChuZWFyZXN0IG5laWdoYm9yKSAqL1xuICBwaXhlbFBlcmZlY3Q/OiBib29sZWFuO1xuICAvKiogVXNlIDktc2xpY2UgcmVuZGVyaW5nIGluc3RlYWQgb2YgdGhyZWUtcGllY2UgaG9yaXpvbnRhbCAqL1xuICB1c2VOaW5lU2xpY2U/OiBib29sZWFuO1xuICAvKiogOS1zbGljZSBib3JkZXIgd2lkdGhzIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIC0gcmVxdWlyZWQgaWYgdXNlTmluZVNsaWNlIGlzIHRydWUgKi9cbiAgbmluZVNsaWNlQm9yZGVycz86IHsgbGVmdDogbnVtYmVyOyB0b3A6IG51bWJlcjsgcmlnaHQ6IG51bWJlcjsgYm90dG9tOiBudW1iZXIgfTtcbiAgLyoqIFRleHR1cmUgbmFtZSBmb3IgcHJlc3NlZC9kb3duIHN0YXRlIC0gdXNlIHtjb2xvcn0gcGxhY2Vob2xkZXIgaWYgbmVlZGVkICovXG4gIHByZXNzZWRUZXh0dXJlUGF0dGVybj86IHN0cmluZztcbiAgLyoqIEljb24gY29uZmlndXJhdGlvbiBmb3Igb3ZlcmxheSAqL1xuICBpY29uPzogSWNvbkNvbmZpZztcbn1cblxuLyoqXG4gKiBTcHJpdGUtYmFzZWQgYmFja2dyb3VuZCBzdHJhdGVneSB1c2luZyB0aHJlZS1waWVjZSBob3Jpem9udGFsIHRleHR1cmVzIG9yIDktc2xpY2VcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGNsYXNzIFNwcml0ZUJhY2tncm91bmRTdHJhdGVneSBpbXBsZW1lbnRzIEJ1dHRvbkJhY2tncm91bmRTdHJhdGVneSB7XG4gIHByaXZhdGUgY29udGFpbmVyPzogUElYSS5Db250YWluZXI7XG4gIHByaXZhdGUgc3ByaXRlTGVmdD86IFBJWEkuU3ByaXRlO1xuICBwcml2YXRlIHNwcml0ZU1pZD86IFBJWEkuU3ByaXRlO1xuICBwcml2YXRlIHNwcml0ZVJpZ2h0PzogUElYSS5TcHJpdGU7XG4gIHByaXZhdGUgbmluZVNsaWNlU3ByaXRlPzogUElYSS5OaW5lU2xpY2VTcHJpdGU7XG4gIHByaXZhdGUgbmluZVNsaWNlU3ByaXRlUHJlc3NlZD86IFBJWEkuTmluZVNsaWNlU3ByaXRlO1xuICBwcml2YXRlIGljb25TcHJpdGU/OiBQSVhJLlNwcml0ZTtcbiAgcHJpdmF0ZSBjb25maWc6IFNwcml0ZUJhY2tncm91bmRDb25maWc7XG4gIHByaXZhdGUgd2lkdGg6IG51bWJlcjtcbiAgcHJpdmF0ZSBoZWlnaHQ6IG51bWJlcjtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IFNwcml0ZUJhY2tncm91bmRDb25maWcsIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICB9XG5cbiAgY3JlYXRlKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogUElYSS5Db250YWluZXIge1xuICAgIHRoaXMuY29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgY29uc3QgeyBzcHJpdGVzaGVldCwgdGV4dHVyZVBhdHRlcm4sIGNvbG9yLCBwaXhlbFBlcmZlY3QsIHVzZU5pbmVTbGljZSwgbmluZVNsaWNlQm9yZGVycywgcHJlc3NlZFRleHR1cmVQYXR0ZXJuLCBpY29uIH0gPSB0aGlzLmNvbmZpZztcblxuICAgIC8vIFNldCBwaXhlbC1wZXJmZWN0IHJlbmRlcmluZyBpZiByZXF1ZXN0ZWRcbiAgICBpZiAocGl4ZWxQZXJmZWN0ICYmIHNwcml0ZXNoZWV0LnRleHR1cmVTb3VyY2UpIHtcbiAgICAgIHNwcml0ZXNoZWV0LnRleHR1cmVTb3VyY2Uuc2NhbGVNb2RlID0gJ25lYXJlc3QnO1xuICAgIH1cblxuICAgIGlmICh1c2VOaW5lU2xpY2UgJiYgbmluZVNsaWNlQm9yZGVycykge1xuICAgICAgLy8gVXNlIDktc2xpY2Ugc3ByaXRlXG4gICAgICBjb25zdCB0ZXh0dXJlTmFtZSA9IHRleHR1cmVQYXR0ZXJuLmluY2x1ZGVzKCd7Y29sb3J9JylcbiAgICAgICAgPyB0ZXh0dXJlUGF0dGVybi5yZXBsYWNlKCd7Y29sb3J9JywgY29sb3IpXG4gICAgICAgIDogdGV4dHVyZVBhdHRlcm47XG4gICAgICBjb25zdCB0ZXh0dXJlID0gc3ByaXRlc2hlZXQudGV4dHVyZXNbdGV4dHVyZU5hbWVdO1xuXG4gICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZSA9IG5ldyBQSVhJLk5pbmVTbGljZVNwcml0ZSh7XG4gICAgICAgIHRleHR1cmUsXG4gICAgICAgIGxlZnRXaWR0aDogbmluZVNsaWNlQm9yZGVycy5sZWZ0LFxuICAgICAgICB0b3BIZWlnaHQ6IG5pbmVTbGljZUJvcmRlcnMudG9wLFxuICAgICAgICByaWdodFdpZHRoOiBuaW5lU2xpY2VCb3JkZXJzLnJpZ2h0LFxuICAgICAgICBib3R0b21IZWlnaHQ6IG5pbmVTbGljZUJvcmRlcnMuYm90dG9tLFxuICAgICAgICB3aWR0aCxcbiAgICAgICAgaGVpZ2h0XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5uaW5lU2xpY2VTcHJpdGUpO1xuXG4gICAgICAvLyBDcmVhdGUgcHJlc3NlZCBzdGF0ZSBzcHJpdGUgaWYgcHJvdmlkZWRcbiAgICAgIGlmIChwcmVzc2VkVGV4dHVyZVBhdHRlcm4pIHtcbiAgICAgICAgY29uc3QgcHJlc3NlZFRleHR1cmVOYW1lID0gcHJlc3NlZFRleHR1cmVQYXR0ZXJuLmluY2x1ZGVzKCd7Y29sb3J9JylcbiAgICAgICAgICA/IHByZXNzZWRUZXh0dXJlUGF0dGVybi5yZXBsYWNlKCd7Y29sb3J9JywgY29sb3IpXG4gICAgICAgICAgOiBwcmVzc2VkVGV4dHVyZVBhdHRlcm47XG4gICAgICAgIGNvbnN0IHByZXNzZWRUZXh0dXJlID0gc3ByaXRlc2hlZXQudGV4dHVyZXNbcHJlc3NlZFRleHR1cmVOYW1lXTtcblxuICAgICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZVByZXNzZWQgPSBuZXcgUElYSS5OaW5lU2xpY2VTcHJpdGUoe1xuICAgICAgICAgIHRleHR1cmU6IHByZXNzZWRUZXh0dXJlLFxuICAgICAgICAgIGxlZnRXaWR0aDogbmluZVNsaWNlQm9yZGVycy5sZWZ0LFxuICAgICAgICAgIHRvcEhlaWdodDogbmluZVNsaWNlQm9yZGVycy50b3AsXG4gICAgICAgICAgcmlnaHRXaWR0aDogbmluZVNsaWNlQm9yZGVycy5yaWdodCxcbiAgICAgICAgICBib3R0b21IZWlnaHQ6IG5pbmVTbGljZUJvcmRlcnMuYm90dG9tLFxuICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgIGhlaWdodFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBPZmZzZXQgcHJlc3NlZCBzdGF0ZSBkb3duIGJ5IDQgcGl4ZWxzIHRvIG1hdGNoIHRoZSBiZXZlbCBoZWlnaHRcbiAgICAgICAgdGhpcy5uaW5lU2xpY2VTcHJpdGVQcmVzc2VkLnkgPSA0O1xuICAgICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZVByZXNzZWQudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLm5pbmVTbGljZVNwcml0ZVByZXNzZWQpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBVc2UgdGhyZWUtcGllY2UgaG9yaXpvbnRhbCBzcHJpdGVzXG4gICAgICBjb25zdCBsZWZ0VGV4dHVyZU5hbWUgPSB0aGlzLmdldFRleHR1cmVOYW1lKHRleHR1cmVQYXR0ZXJuLCBjb2xvciwgJ2xlZnQnKTtcbiAgICAgIGNvbnN0IG1pZFRleHR1cmVOYW1lID0gdGhpcy5nZXRUZXh0dXJlTmFtZSh0ZXh0dXJlUGF0dGVybiwgY29sb3IsICdtaWQnKTtcbiAgICAgIGNvbnN0IHJpZ2h0VGV4dHVyZU5hbWUgPSB0aGlzLmdldFRleHR1cmVOYW1lKHRleHR1cmVQYXR0ZXJuLCBjb2xvciwgJ3JpZ2h0Jyk7XG5cbiAgICAgIHRoaXMuc3ByaXRlTGVmdCA9IG5ldyBQSVhJLlNwcml0ZShzcHJpdGVzaGVldC50ZXh0dXJlc1tsZWZ0VGV4dHVyZU5hbWVdKTtcbiAgICAgIHRoaXMuc3ByaXRlTWlkID0gbmV3IFBJWEkuU3ByaXRlKHNwcml0ZXNoZWV0LnRleHR1cmVzW21pZFRleHR1cmVOYW1lXSk7XG4gICAgICB0aGlzLnNwcml0ZVJpZ2h0ID0gbmV3IFBJWEkuU3ByaXRlKHNwcml0ZXNoZWV0LnRleHR1cmVzW3JpZ2h0VGV4dHVyZU5hbWVdKTtcblxuICAgICAgLy8gU2NhbGUgdG8gbWF0Y2ggYnV0dG9uIGhlaWdodFxuICAgICAgY29uc3Qgc2NhbGVZID0gaGVpZ2h0IC8gdGhpcy5zcHJpdGVMZWZ0LmhlaWdodDtcbiAgICAgIHRoaXMuc3ByaXRlTGVmdC5zY2FsZS55ID0gc2NhbGVZO1xuICAgICAgdGhpcy5zcHJpdGVNaWQuc2NhbGUueSA9IHNjYWxlWTtcbiAgICAgIHRoaXMuc3ByaXRlUmlnaHQuc2NhbGUueSA9IHNjYWxlWTtcblxuICAgICAgLy8gUG9zaXRpb24gc3ByaXRlcyBob3Jpem9udGFsbHlcbiAgICAgIHRoaXMuc3ByaXRlTGVmdC54ID0gMDtcblxuICAgICAgY29uc3QgbWlkZGxlV2lkdGggPSB3aWR0aCAtIHRoaXMuc3ByaXRlTGVmdC53aWR0aCAtIHRoaXMuc3ByaXRlUmlnaHQud2lkdGg7XG4gICAgICB0aGlzLnNwcml0ZU1pZC53aWR0aCA9IG1pZGRsZVdpZHRoO1xuICAgICAgdGhpcy5zcHJpdGVNaWQueCA9IHRoaXMuc3ByaXRlTGVmdC53aWR0aDtcblxuICAgICAgdGhpcy5zcHJpdGVSaWdodC54ID0gdGhpcy5zcHJpdGVMZWZ0LndpZHRoICsgbWlkZGxlV2lkdGg7XG5cbiAgICAgIC8vIEFkZCB0byBjb250YWluZXJcbiAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuc3ByaXRlTGVmdCk7XG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnNwcml0ZU1pZCk7XG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnNwcml0ZVJpZ2h0KTtcbiAgICB9XG5cbiAgICAvLyBBZGQgaWNvbiBpZiBwcm92aWRlZFxuICAgIGlmIChpY29uKSB7XG4gICAgICBjb25zdCBpY29uVGV4dHVyZSA9IGljb24uc3ByaXRlc2hlZXQudGV4dHVyZXNbaWNvbi50ZXh0dXJlTmFtZV07XG4gICAgICB0aGlzLmljb25TcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoaWNvblRleHR1cmUpO1xuXG4gICAgICBpZiAoaWNvbi5waXhlbFBlcmZlY3QgJiYgaWNvbi5zcHJpdGVzaGVldC50ZXh0dXJlU291cmNlKSB7XG4gICAgICAgIGljb24uc3ByaXRlc2hlZXQudGV4dHVyZVNvdXJjZS5zY2FsZU1vZGUgPSAnbmVhcmVzdCc7XG4gICAgICB9XG5cbiAgICAgIGlmIChpY29uLnNjYWxlKSB7XG4gICAgICAgIHRoaXMuaWNvblNwcml0ZS5zY2FsZS5zZXQoaWNvbi5zY2FsZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENlbnRlciB0aGUgaWNvblxuICAgICAgdGhpcy5pY29uU3ByaXRlLmFuY2hvci5zZXQoMC41KTtcbiAgICAgIHRoaXMuaWNvblNwcml0ZS54ID0gd2lkdGggLyAyO1xuICAgICAgdGhpcy5pY29uU3ByaXRlLnkgPSBoZWlnaHQgLyAyO1xuXG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmljb25TcHJpdGUpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmNvbnRhaW5lcjtcbiAgfVxuXG4gIHVwZGF0ZVN0YXRlKHN0YXRlOiBCdXR0b25TdGF0ZSk6IHZvaWQge1xuICAgIC8vIEhhbmRsZSB1cC9kb3duIHN0YXRlIHN3aXRjaGluZyBmb3IgOS1zbGljZSBzcHJpdGVzXG4gICAgaWYgKHRoaXMubmluZVNsaWNlU3ByaXRlICYmIHRoaXMubmluZVNsaWNlU3ByaXRlUHJlc3NlZCkge1xuICAgICAgY29uc3QgaXNQcmVzc2VkID0gc3RhdGUgPT09IEJ1dHRvblN0YXRlLlByZXNzZWQ7XG4gICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZS52aXNpYmxlID0gIWlzUHJlc3NlZDtcbiAgICAgIHRoaXMubmluZVNsaWNlU3ByaXRlUHJlc3NlZC52aXNpYmxlID0gaXNQcmVzc2VkO1xuXG4gICAgICAvLyBPZmZzZXQgaWNvbiB3aGVuIHByZXNzZWRcbiAgICAgIGlmICh0aGlzLmljb25TcHJpdGUpIHtcbiAgICAgICAgdGhpcy5pY29uU3ByaXRlLnkgPSAodGhpcy5oZWlnaHQgLyAyKSArIChpc1ByZXNzZWQgPyA0IDogMCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFVzZSB0aW50aW5nIGZvciBzdGF0ZXMgd2hlbiBubyBwcmVzc2VkIHRleHR1cmUgaXMgYXZhaWxhYmxlXG4gICAgICBsZXQgdGludDogbnVtYmVyO1xuICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICBjYXNlIEJ1dHRvblN0YXRlLk5vcm1hbDpcbiAgICAgICAgICB0aW50ID0gMHhmZmZmZmY7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQnV0dG9uU3RhdGUuSG92ZXI6XG4gICAgICAgICAgdGludCA9IDB4Y2NjY2NjO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEJ1dHRvblN0YXRlLlByZXNzZWQ6XG4gICAgICAgICAgdGludCA9IDB4OTk5OTk5O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEJ1dHRvblN0YXRlLkRpc2FibGVkOlxuICAgICAgICAgIHRpbnQgPSAweDg4ODg4ODtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMubmluZVNsaWNlU3ByaXRlKSB7XG4gICAgICAgIHRoaXMubmluZVNsaWNlU3ByaXRlLnRpbnQgPSB0aW50O1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnNwcml0ZUxlZnQgJiYgdGhpcy5zcHJpdGVNaWQgJiYgdGhpcy5zcHJpdGVSaWdodCkge1xuICAgICAgICB0aGlzLnNwcml0ZUxlZnQudGludCA9IHRpbnQ7XG4gICAgICAgIHRoaXMuc3ByaXRlTWlkLnRpbnQgPSB0aW50O1xuICAgICAgICB0aGlzLnNwcml0ZVJpZ2h0LnRpbnQgPSB0aW50O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldEFjdHVhbEhlaWdodCgpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLm5pbmVTbGljZVNwcml0ZSkge1xuICAgICAgcmV0dXJuIHRoaXMubmluZVNsaWNlU3ByaXRlLmhlaWdodDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuc3ByaXRlTGVmdD8uaGVpZ2h0ID8/IHRoaXMuaGVpZ2h0O1xuICB9XG5cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lcj8uZGVzdHJveSh7IGNoaWxkcmVuOiB0cnVlIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRUZXh0dXJlTmFtZShwYXR0ZXJuOiBzdHJpbmcsIGNvbG9yOiBzdHJpbmcsIHBhcnQ6ICdsZWZ0JyB8ICdtaWQnIHwgJ3JpZ2h0Jyk6IHN0cmluZyB7XG4gICAgLy8gUmVwbGFjZSB7Y29sb3J9IHBsYWNlaG9sZGVyIGFuZCBlbnN1cmUgY29ycmVjdCBwYXJ0XG4gICAgbGV0IG5hbWUgPSBwYXR0ZXJuLnJlcGxhY2UoJ3tjb2xvcn0nLCBjb2xvcik7XG5cbiAgICAvLyBSZXBsYWNlIGFueSBleGlzdGluZyBwYXJ0IHN1ZmZpeCB3aXRoIHRoZSBkZXNpcmVkIG9uZVxuICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoL18oPzpsZWZ0fG1pZHxyaWdodClcXC5wbmckLywgYF8ke3BhcnR9LnBuZ2ApO1xuXG4gICAgcmV0dXJuIG5hbWU7XG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJQm94XG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlCb3hQcm9wcyB7XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yIChoZXggbnVtYmVyLCBlLmcuLCAweGZmMDAwMCBmb3IgcmVkKSAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBCYWNrZ3JvdW5kIGFscGhhL29wYWNpdHkgKDAtMSkgKi9cbiAgYmFja2dyb3VuZEFscGhhPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIGNvbG9yICovXG4gIGJvcmRlckNvbG9yPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHdpZHRoIGluIHBpeGVscyAqL1xuICBib3JkZXJXaWR0aD86IG51bWJlcjtcbiAgLyoqIEJvcmRlciByYWRpdXMgZm9yIHJvdW5kZWQgY29ybmVycyAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG4gIC8qKiBGaXhlZCB3aWR0aCAqL1xuICB3aWR0aD86IG51bWJlcjtcbiAgLyoqIEZpeGVkIGhlaWdodCAqL1xuICBoZWlnaHQ/OiBudW1iZXI7XG59XG5cbi8qKlxuICogQSBzaW1wbGUgcmVjdGFuZ3VsYXIgYm94IGNvbXBvbmVudCB3aXRoIG9wdGlvbmFsIGJhY2tncm91bmQgYW5kIGJvcmRlclxuICogRm91bmRhdGlvbiBmb3IgcGFuZWxzLCBidXR0b25zLCBhbmQgb3RoZXIgdmlzdWFsIFVJIGVsZW1lbnRzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGJveCA9IG5ldyBVSUJveCh7XG4gKiAgIGJhY2tncm91bmRDb2xvcjogMHg0YTkwZTIsXG4gKiAgIHdpZHRoOiAyMDAsXG4gKiAgIGhlaWdodDogMTAwLFxuICogICBib3JkZXJSYWRpdXM6IDhcbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSUJveCBleHRlbmRzIFVJQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBwcm9wczogVUlCb3hQcm9wcztcbiAgcHJpdmF0ZSBncmFwaGljczogUElYSS5HcmFwaGljcztcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlCb3hQcm9wcyA9IHt9LCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IDB4MDAwMDAwLFxuICAgICAgYmFja2dyb3VuZEFscGhhOiAxLFxuICAgICAgYm9yZGVyV2lkdGg6IDAsXG4gICAgICBib3JkZXJSYWRpdXM6IDAsXG4gICAgICAuLi5wcm9wc1xuICAgIH07XG5cbiAgICAvLyBDcmVhdGUgZ3JhcGhpY3Mgb2JqZWN0IGZvciByZW5kZXJpbmdcbiAgICB0aGlzLmdyYXBoaWNzID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmdyYXBoaWNzKTtcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9ucyBpZiBwcm92aWRlZFxuICAgIGlmIChwcm9wcy53aWR0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmJveE1vZGVsLndpZHRoID0gcHJvcHMud2lkdGg7XG4gICAgfVxuICAgIGlmIChwcm9wcy5oZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPSBwcm9wcy5oZWlnaHQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmVzIHRoZSBzaXplIG5lZWRlZCBmb3IgdGhpcyBib3hcbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuICAgIGNvbnN0IGJvcmRlciA9IHRoaXMuYm94TW9kZWwuYm9yZGVyO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGNvbnRlbnQgc2l6ZVxuICAgIGxldCBjb250ZW50V2lkdGggPSAwO1xuICAgIGxldCBjb250ZW50SGVpZ2h0ID0gMDtcblxuICAgIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnRlbnRXaWR0aCA9IHRoaXMuYm94TW9kZWwud2lkdGg7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLndpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnRlbnRXaWR0aCA9IHRoaXMucHJvcHMud2lkdGg7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnRlbnRIZWlnaHQgPSB0aGlzLmJveE1vZGVsLmhlaWdodDtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuaGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnRlbnRIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcbiAgICB9XG5cbiAgICAvLyBBZGQgcGFkZGluZyBhbmQgYm9yZGVyXG4gICAgY29uc3QgdG90YWxXaWR0aCA9IGNvbnRlbnRXaWR0aCArIHBhZGRpbmcuaG9yaXpvbnRhbCArIChib3JkZXI/Lmhvcml6b250YWwgPz8gMCk7XG4gICAgY29uc3QgdG90YWxIZWlnaHQgPSBjb250ZW50SGVpZ2h0ICsgcGFkZGluZy52ZXJ0aWNhbCArIChib3JkZXI/LnZlcnRpY2FsID8/IDApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiBNYXRoLm1heCh0b3RhbFdpZHRoLCB0aGlzLmJveE1vZGVsLm1pbldpZHRoID8/IDApLFxuICAgICAgaGVpZ2h0OiBNYXRoLm1heCh0b3RhbEhlaWdodCwgdGhpcy5ib3hNb2RlbC5taW5IZWlnaHQgPz8gMClcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGxheW91dCBmb3IgdGhpcyBib3hcbiAgICovXG4gIGxheW91dChhdmFpbGFibGVXaWR0aDogbnVtYmVyLCBhdmFpbGFibGVIZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICBjb25zdCBib3JkZXIgPSB0aGlzLmJveE1vZGVsLmJvcmRlciA/PyB7IGhvcml6b250YWw6IDAsIHZlcnRpY2FsOiAwLCB0b3A6IDAsIHJpZ2h0OiAwLCBib3R0b206IDAsIGxlZnQ6IDAgfTtcblxuICAgIC8vIENhbGN1bGF0ZSBmaW5hbCBkaW1lbnNpb25zXG4gICAgbGV0IGZpbmFsV2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICBsZXQgZmluYWxIZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG5cbiAgICAvLyBIYW5kbGUgJ2ZpbGwnIGNvbnN0cmFpbnRcbiAgICBpZiAodGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ2ZpbGwnKSB7XG4gICAgICBmaW5hbFdpZHRoID0gYXZhaWxhYmxlV2lkdGg7XG4gICAgfVxuICAgIGlmICh0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ2ZpbGwnKSB7XG4gICAgICBmaW5hbEhlaWdodCA9IGF2YWlsYWJsZUhlaWdodDtcbiAgICB9XG5cbiAgICAvLyBBcHBseSBtYXggY29uc3RyYWludHNcbiAgICBpZiAodGhpcy5ib3hNb2RlbC5tYXhXaWR0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBmaW5hbFdpZHRoID0gTWF0aC5taW4oZmluYWxXaWR0aCwgdGhpcy5ib3hNb2RlbC5tYXhXaWR0aCk7XG4gICAgfVxuICAgIGlmICh0aGlzLmJveE1vZGVsLm1heEhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBmaW5hbEhlaWdodCA9IE1hdGgubWluKGZpbmFsSGVpZ2h0LCB0aGlzLmJveE1vZGVsLm1heEhlaWdodCk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGNvbXB1dGVkIGxheW91dFxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBmaW5hbFdpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gZmluYWxIZWlnaHQ7XG5cbiAgICAvLyBDb250ZW50IGFyZWEgKGluc2lkZSBwYWRkaW5nIGFuZCBib3JkZXIpXG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50WCA9IHBhZGRpbmcubGVmdCArIGJvcmRlci5sZWZ0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFkgPSBwYWRkaW5nLnRvcCArIGJvcmRlci50b3A7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50V2lkdGggPSBmaW5hbFdpZHRoIC0gcGFkZGluZy5ob3Jpem9udGFsIC0gYm9yZGVyLmhvcml6b250YWw7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50SGVpZ2h0ID0gZmluYWxIZWlnaHQgLSBwYWRkaW5nLnZlcnRpY2FsIC0gYm9yZGVyLnZlcnRpY2FsO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgYm94IHZpc3VhbHNcbiAgICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgdGhpcy5ncmFwaGljcy5jbGVhcigpO1xuXG4gICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSB0aGlzLmNvbXB1dGVkTGF5b3V0O1xuICAgIGNvbnN0IHsgYmFja2dyb3VuZENvbG9yLCBiYWNrZ3JvdW5kQWxwaGEsIGJvcmRlckNvbG9yLCBib3JkZXJXaWR0aCwgYm9yZGVyUmFkaXVzIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgLy8gRHJhdyBib3JkZXIgaWYgc3BlY2lmaWVkXG4gICAgaWYgKGJvcmRlcldpZHRoICYmIGJvcmRlcldpZHRoID4gMCAmJiBib3JkZXJDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmdyYXBoaWNzLnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSh7IGNvbG9yOiBib3JkZXJDb2xvciwgd2lkdGg6IGJvcmRlcldpZHRoIH0pO1xuICAgIH1cblxuICAgIC8vIERyYXcgYmFja2dyb3VuZFxuICAgIGlmIChiYWNrZ3JvdW5kQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKGJvcmRlclJhZGl1cyAmJiBib3JkZXJSYWRpdXMgPiAwKSB7XG4gICAgICAgIHRoaXMuZ3JhcGhpY3Mucm91bmRSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQsIGJvcmRlclJhZGl1cyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmdyYXBoaWNzLnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICB9XG4gICAgICB0aGlzLmdyYXBoaWNzLmZpbGwoeyBjb2xvcjogYmFja2dyb3VuZENvbG9yLCBhbHBoYTogYmFja2dyb3VuZEFscGhhIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBiYWNrZ3JvdW5kIGNvbG9yXG4gICAqL1xuICBzZXRCYWNrZ3JvdW5kQ29sb3IoY29sb3I6IG51bWJlciwgYWxwaGE6IG51bWJlciA9IDEpOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xuICAgIHRoaXMucHJvcHMuYmFja2dyb3VuZEFscGhhID0gYWxwaGE7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBib3JkZXJcbiAgICovXG4gIHNldEJvcmRlcihjb2xvcjogbnVtYmVyLCB3aWR0aDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy5ib3JkZXJDb2xvciA9IGNvbG9yO1xuICAgIHRoaXMucHJvcHMuYm9yZGVyV2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcbmltcG9ydCB7IFVJTGFiZWwgfSBmcm9tICcuL3VpLWxhYmVsJztcbmltcG9ydCB7IEVkZ2VJbnNldHMgfSBmcm9tICcuLi9jb3JlL2VkZ2UtaW5zZXRzJztcbmltcG9ydCB7IFVJRm9jdXNNYW5hZ2VyIH0gZnJvbSAnLi4vY29yZS91aS1mb2N1cy1tYW5hZ2VyJztcbmltcG9ydCB7XG4gIEJ1dHRvbkJhY2tncm91bmRTdHJhdGVneSxcbiAgU29saWRDb2xvckJhY2tncm91bmRTdHJhdGVneSxcbiAgU3ByaXRlQmFja2dyb3VuZFN0cmF0ZWd5LFxuICBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnXG59IGZyb20gJy4vYnV0dG9uLWJhY2tncm91bmQtc3RyYXRlZ3knO1xuXG4vKiogQnV0dG9uIHZpc3VhbCBzdGF0ZXMuICovXG5leHBvcnQgZW51bSBCdXR0b25TdGF0ZSB7XG4gIE5vcm1hbCA9ICdub3JtYWwnLFxuICBIb3ZlciA9ICdob3ZlcicsXG4gIFByZXNzZWQgPSAncHJlc3NlZCcsXG4gIERpc2FibGVkID0gJ2Rpc2FibGVkJ1xufVxuXG4vLyBSZS1leHBvcnQgU3ByaXRlQmFja2dyb3VuZENvbmZpZyBmb3IgY29udmVuaWVuY2VcbmV4cG9ydCB0eXBlIHsgU3ByaXRlQmFja2dyb3VuZENvbmZpZyB9IGZyb20gJy4vYnV0dG9uLWJhY2tncm91bmQtc3RyYXRlZ3knO1xuXG4vKiogVUlCdXR0b24gY29uZmlndXJhdGlvbi4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlCdXR0b25Qcm9wcyB7XG4gIC8qKiBCdXR0b24gbGFiZWwgdGV4dCAqL1xuICBsYWJlbD86IHN0cmluZztcbiAgLyoqIEJ1dHRvbiB3aWR0aCAqL1xuICB3aWR0aD86IG51bWJlcjtcbiAgLyoqIEJ1dHRvbiBoZWlnaHQgKi9cbiAgaGVpZ2h0PzogbnVtYmVyO1xuICAvKiogQmFja2dyb3VuZCBjb2xvciAob25seSB1c2VkIGlmIHNwcml0ZUJhY2tncm91bmQgaXMgbm90IHByb3ZpZGVkKSAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBTcHJpdGUtYmFzZWQgYmFja2dyb3VuZCBjb25maWd1cmF0aW9uICovXG4gIHNwcml0ZUJhY2tncm91bmQ/OiBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnO1xuICAvKiogVGV4dCBjb2xvciAqL1xuICB0ZXh0Q29sb3I/OiBudW1iZXI7XG4gIC8qKiBGb250IHNpemUgKi9cbiAgZm9udFNpemU/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgcmFkaXVzIChvbmx5IHVzZWQgd2l0aCBiYWNrZ3JvdW5kQ29sb3IpICovXG4gIGJvcmRlclJhZGl1cz86IG51bWJlcjtcbiAgLyoqIFBhZGRpbmcgaW5zaWRlIGJ1dHRvbiAqL1xuICBwYWRkaW5nPzogRWRnZUluc2V0cztcbiAgLyoqIFVzZSBCaXRtYXBUZXh0IGluc3RlYWQgb2YgcmVndWxhciB0ZXh0ICovXG4gIHVzZUJpdG1hcFRleHQ/OiBib29sZWFuO1xuICAvKiogQml0bWFwVGV4dCBmb250IGZhbWlseSAocmVxdWlyZWQgaWYgdXNlQml0bWFwVGV4dCBpcyB0cnVlKSAqL1xuICBiaXRtYXBGb250RmFtaWx5Pzogc3RyaW5nO1xuICAvKiogQ2xpY2sgY2FsbGJhY2sgKi9cbiAgb25DbGljaz86ICgpID0+IHZvaWQ7XG4gIC8qKiBIb3ZlciBjYWxsYmFjayAqL1xuICBvbkhvdmVyPzogKCkgPT4gdm9pZDtcbiAgLyoqIEVuYWJsZWQgc3RhdGUgKi9cbiAgZW5hYmxlZD86IGJvb2xlYW47XG59XG5cbi8qKlxuICogSW50ZXJhY3RpdmUgYnV0dG9uIGNvbXBvbmVudCB3aXRoIGhvdmVyLCBwcmVzcywgYW5kIGRpc2FibGVkIHN0YXRlcy5cbiAqIFN1cHBvcnRzIHNvbGlkIGNvbG9yIG9yIHNwcml0ZS1iYXNlZCBiYWNrZ3JvdW5kcywgYml0bWFwIHRleHQsIGFuZCBrZXlib2FyZCBmb2N1cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIC8vIEJhc2ljIGJ1dHRvblxuICogY29uc3QgYnRuID0gbmV3IFVJQnV0dG9uKHtcbiAqICAgbGFiZWw6ICdDbGljayBNZScsXG4gKiAgIHdpZHRoOiAxNTAsXG4gKiAgIGhlaWdodDogNDAsXG4gKiAgIGJhY2tncm91bmRDb2xvcjogMHg0YTkwZTIsXG4gKiAgIHRleHRDb2xvcjogMHhmZmZmZmYsXG4gKiAgIG9uQ2xpY2s6ICgpID0+IGNvbnNvbGUubG9nKCdjbGlja2VkJylcbiAqIH0pO1xuICpcbiAqIC8vIFNwcml0ZS1iYXNlZCBidXR0b25cbiAqIGNvbnN0IHNwcml0ZUJ0biA9IG5ldyBVSUJ1dHRvbih7XG4gKiAgIGxhYmVsOiAnUGxheScsXG4gKiAgIHNwcml0ZUJhY2tncm91bmQ6IHtcbiAqICAgICBub3JtYWw6IG5vcm1hbFRleHR1cmUsXG4gKiAgICAgaG92ZXI6IGhvdmVyVGV4dHVyZSxcbiAqICAgICBwcmVzc2VkOiBwcmVzc2VkVGV4dHVyZVxuICogICB9XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlCdXR0b24gZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFJlcXVpcmVkPE9taXQ8VUlCdXR0b25Qcm9wcywgJ29uQ2xpY2snIHwgJ29uSG92ZXInIHwgJ3Nwcml0ZUJhY2tncm91bmQnIHwgJ3VzZUJpdG1hcFRleHQnIHwgJ2JpdG1hcEZvbnRGYW1pbHknPj47XG4gIHByaXZhdGUgdXNlQml0bWFwVGV4dDogYm9vbGVhbjtcbiAgcHJpdmF0ZSBiaXRtYXBGb250RmFtaWx5Pzogc3RyaW5nO1xuICBwcml2YXRlIG9uQ2xpY2s/OiAoKSA9PiB2b2lkO1xuICBwcml2YXRlIG9uSG92ZXI/OiAoKSA9PiB2b2lkO1xuXG4gIHByaXZhdGUgc3RhdGU6IEJ1dHRvblN0YXRlID0gQnV0dG9uU3RhdGUuTm9ybWFsO1xuICBwcml2YXRlIGJhY2tncm91bmRTdHJhdGVneTogQnV0dG9uQmFja2dyb3VuZFN0cmF0ZWd5O1xuICBwcml2YXRlIGxhYmVsPzogVUlMYWJlbDtcbiAgcHJpdmF0ZSBiaXRtYXBMYWJlbD86IFBJWEkuQml0bWFwVGV4dDtcblxuICAvLyBDYWNoZWQgbGFiZWwgY2VudGVyIHBvc2l0aW9uXG4gIHByaXZhdGUgbGFiZWxDZW50ZXJYOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGxhYmVsQ2VudGVyWTogbnVtYmVyID0gMDtcblxuICAvLyBLZXlib2FyZCBoYW5kbGVyIGZvciBjbGVhbnVwXG4gIHByaXZhdGUga2V5ZG93bkhhbmRsZXI/OiAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlCdXR0b25Qcm9wcyA9IHt9LCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIGxhYmVsOiBwcm9wcy5sYWJlbCA/PyAnJyxcbiAgICAgIHdpZHRoOiBwcm9wcy53aWR0aCA/PyAxMjAsXG4gICAgICBoZWlnaHQ6IHByb3BzLmhlaWdodCA/PyA0MCxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogcHJvcHMuYmFja2dyb3VuZENvbG9yID8/IDB4NGE5MGUyLFxuICAgICAgdGV4dENvbG9yOiBwcm9wcy50ZXh0Q29sb3IgPz8gMHhmZmZmZmYsXG4gICAgICBmb250U2l6ZTogcHJvcHMuZm9udFNpemUgPz8gMTYsXG4gICAgICBib3JkZXJSYWRpdXM6IHByb3BzLmJvcmRlclJhZGl1cyA/PyA0LFxuICAgICAgcGFkZGluZzogcHJvcHMucGFkZGluZyA/PyBFZGdlSW5zZXRzLnN5bW1ldHJpYyg4LCAxNiksXG4gICAgICBlbmFibGVkOiBwcm9wcy5lbmFibGVkID8/IHRydWVcbiAgICB9O1xuXG4gICAgdGhpcy51c2VCaXRtYXBUZXh0ID0gcHJvcHMudXNlQml0bWFwVGV4dCA/PyBmYWxzZTtcbiAgICB0aGlzLmJpdG1hcEZvbnRGYW1pbHkgPSBwcm9wcy5iaXRtYXBGb250RmFtaWx5O1xuICAgIHRoaXMub25DbGljayA9IHByb3BzLm9uQ2xpY2s7XG4gICAgdGhpcy5vbkhvdmVyID0gcHJvcHMub25Ib3ZlcjtcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9uc1xuICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSB0aGlzLnByb3BzLndpZHRoO1xuICAgIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG5cbiAgICAvLyBNYWtlIGJ1dHRvbnMgZm9jdXNhYmxlIGJ5IGRlZmF1bHRcbiAgICB0aGlzLnRhYkluZGV4ID0gMDtcblxuICAgIC8vIENyZWF0ZSBiYWNrZ3JvdW5kIHN0cmF0ZWd5IGJhc2VkIG9uIGNvbmZpZ3VyYXRpb25cbiAgICBpZiAocHJvcHMuc3ByaXRlQmFja2dyb3VuZCkge1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kU3RyYXRlZ3kgPSBuZXcgU3ByaXRlQmFja2dyb3VuZFN0cmF0ZWd5KFxuICAgICAgICBwcm9wcy5zcHJpdGVCYWNrZ3JvdW5kLFxuICAgICAgICB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgICB0aGlzLnByb3BzLmhlaWdodFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kU3RyYXRlZ3kgPSBuZXcgU29saWRDb2xvckJhY2tncm91bmRTdHJhdGVneShcbiAgICAgICAgdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICAgIHRoaXMucHJvcHMud2lkdGgsXG4gICAgICAgIHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgICB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYW5kIGFkZCBiYWNrZ3JvdW5kXG4gICAgY29uc3QgYmFja2dyb3VuZENvbnRhaW5lciA9IHRoaXMuYmFja2dyb3VuZFN0cmF0ZWd5LmNyZWF0ZSh0aGlzLnByb3BzLndpZHRoLCB0aGlzLnByb3BzLmhlaWdodCk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQoYmFja2dyb3VuZENvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgbGFiZWwgaWYgdGV4dCBwcm92aWRlZFxuICAgIGlmICh0aGlzLnByb3BzLmxhYmVsKSB7XG4gICAgICBpZiAodGhpcy51c2VCaXRtYXBUZXh0ICYmIHRoaXMuYml0bWFwRm9udEZhbWlseSkge1xuICAgICAgICB0aGlzLmNyZWF0ZUJpdG1hcExhYmVsKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxhYmVsID0gbmV3IFVJTGFiZWwoe1xuICAgICAgICAgIHRleHQ6IHRoaXMucHJvcHMubGFiZWwsXG4gICAgICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMuZm9udFNpemUsXG4gICAgICAgICAgY29sb3I6IHRoaXMucHJvcHMudGV4dENvbG9yLFxuICAgICAgICAgIGFsaWduOiAnY2VudGVyJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgcGFkZGluZzogRWRnZUluc2V0cy56ZXJvKClcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMubGFiZWwuY29udGFpbmVyKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBTZXR1cCBpbnRlcmFjdGl2aXR5XG4gICAgdGhpcy5zZXR1cEludGVyYWN0aXZpdHkoKTtcblxuICAgIC8vIEluaXRpYWwgc3RhdGVcbiAgICBpZiAoIXRoaXMucHJvcHMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5EaXNhYmxlZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIGNyZWF0ZUJpdG1hcExhYmVsKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5iaXRtYXBGb250RmFtaWx5KSByZXR1cm47XG5cbiAgICB0aGlzLmJpdG1hcExhYmVsID0gbmV3IFBJWEkuQml0bWFwVGV4dCh7XG4gICAgICB0ZXh0OiB0aGlzLnByb3BzLmxhYmVsLFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgZm9udEZhbWlseTogdGhpcy5iaXRtYXBGb250RmFtaWx5LFxuICAgICAgICBmb250U2l6ZTogdGhpcy5wcm9wcy5mb250U2l6ZSxcbiAgICAgICAgZmlsbDogdGhpcy5wcm9wcy50ZXh0Q29sb3JcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuYml0bWFwTGFiZWwpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIHNldHVwSW50ZXJhY3Rpdml0eSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICB0aGlzLmNvbnRhaW5lci5jdXJzb3IgPSAncG9pbnRlcic7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5vbigncG9pbnRlcm92ZXInLCB0aGlzLmhhbmRsZVBvaW50ZXJPdmVyLmJpbmQodGhpcykpO1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVyb3V0JywgdGhpcy5oYW5kbGVQb2ludGVyT3V0LmJpbmQodGhpcykpO1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVyZG93bicsIHRoaXMuaGFuZGxlUG9pbnRlckRvd24uYmluZCh0aGlzKSk7XG4gICAgdGhpcy5jb250YWluZXIub24oJ3BvaW50ZXJ1cCcsIHRoaXMuaGFuZGxlUG9pbnRlclVwLmJpbmQodGhpcykpO1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVydXBvdXRzaWRlJywgdGhpcy5oYW5kbGVQb2ludGVyVXBPdXRzaWRlLmJpbmQodGhpcykpO1xuXG4gICAgLy8gSGFuZGxlIGtleWJvYXJkIGludGVyYWN0aW9uIHdoZW4gZm9jdXNlZFxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5rZXlkb3duSGFuZGxlciA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmlzRm9jdXNlZCgpICYmIHRoaXMucHJvcHMuZW5hYmxlZCkge1xuICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyB8fCBlLmtleSA9PT0gJyAnKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIC8vIFNob3cgcHJlc3NlZCBzdGF0ZVxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5QcmVzc2VkKTtcblxuICAgICAgICAgICAgLy8gVHJpZ2dlciBjbGlja1xuICAgICAgICAgICAgdGhpcy5vbkNsaWNrPy4oKTtcblxuICAgICAgICAgICAgLy8gUmV0dXJuIHRvIGhvdmVyIHN0YXRlIGFmdGVyIGEgc2hvcnQgZGVsYXkgKHNpbXVsYXRpbmcgYnV0dG9uIHJlbGVhc2UpXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuZW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuTm9ybWFsKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5ZG93bkhhbmRsZXIpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlck92ZXIoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZW5hYmxlZCAmJiB0aGlzLnN0YXRlID09PSBCdXR0b25TdGF0ZS5Ob3JtYWwpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuSG92ZXIpO1xuICAgICAgdGhpcy5vbkhvdmVyPy4oKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJPdXQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZW5hYmxlZCAmJiB0aGlzLnN0YXRlICE9PSBCdXR0b25TdGF0ZS5QcmVzc2VkKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKEJ1dHRvblN0YXRlLk5vcm1hbCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyRG93bigpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wcm9wcy5lbmFibGVkKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKEJ1dHRvblN0YXRlLlByZXNzZWQpO1xuXG4gICAgICAvLyBSZXF1ZXN0IGZvY3VzIHRocm91Z2ggdGhlIGZvY3VzIG1hbmFnZXJcbiAgICAgIGlmICh0aGlzLmNhbkZvY3VzKCkpIHtcbiAgICAgICAgY29uc3QgZm9jdXNNYW5hZ2VyID0gVUlGb2N1c01hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICAgICAgaWYgKGZvY3VzTWFuYWdlcikge1xuICAgICAgICAgIGZvY3VzTWFuYWdlci5yZXF1ZXN0Rm9jdXModGhpcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gRmFsbGJhY2sgaWYgbm8gZm9jdXMgbWFuYWdlclxuICAgICAgICAgIHRoaXMub25Gb2N1cygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyVXAoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5Ib3Zlcik7XG4gICAgICB0aGlzLm9uQ2xpY2s/LigpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlclVwT3V0c2lkZSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wcm9wcy5lbmFibGVkKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKEJ1dHRvblN0YXRlLk5vcm1hbCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIHNldFN0YXRlKG5ld1N0YXRlOiBCdXR0b25TdGF0ZSk6IHZvaWQge1xuICAgIHRoaXMuc3RhdGUgPSBuZXdTdGF0ZTtcbiAgICB0aGlzLnVwZGF0ZVZpc3VhbHMoKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSB1cGRhdGVWaXN1YWxzKCk6IHZvaWQge1xuICAgIC8vIFVwZGF0ZSBiYWNrZ3JvdW5kIHVzaW5nIHN0cmF0ZWd5XG4gICAgdGhpcy5iYWNrZ3JvdW5kU3RyYXRlZ3kudXBkYXRlU3RhdGUodGhpcy5zdGF0ZSk7XG5cbiAgICAvLyBDYWxjdWxhdGUgZGVwdGggb2Zmc2V0IGZvciBwcmVzc2VkIHN0YXRlXG4gICAgY29uc3QgeU9mZnNldCA9IHRoaXMuc3RhdGUgPT09IEJ1dHRvblN0YXRlLlByZXNzZWQgPyAyIDogMDtcblxuICAgIC8vIFVwZGF0ZSBjdXJzb3IgZm9yIGRpc2FibGVkIHN0YXRlXG4gICAgaWYgKHRoaXMuc3RhdGUgPT09IEJ1dHRvblN0YXRlLkRpc2FibGVkKSB7XG4gICAgICB0aGlzLmNvbnRhaW5lci5jdXJzb3IgPSAnZGVmYXVsdCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29udGFpbmVyLmN1cnNvciA9ICdwb2ludGVyJztcbiAgICB9XG5cbiAgICAvLyBBcHBseSBkZXB0aCBvZmZzZXQgdG8gbGFiZWxcbiAgICBpZiAodGhpcy5sYWJlbCkge1xuICAgICAgdGhpcy5sYWJlbC5zZXRQb3NpdGlvbih0aGlzLmxhYmVsQ2VudGVyWCwgdGhpcy5sYWJlbENlbnRlclkgKyB5T2Zmc2V0KTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuYml0bWFwTGFiZWwpIHtcbiAgICAgIHRoaXMuYml0bWFwTGFiZWwueCA9IHRoaXMubGFiZWxDZW50ZXJYO1xuICAgICAgdGhpcy5iaXRtYXBMYWJlbC55ID0gdGhpcy5sYWJlbENlbnRlclkgKyB5T2Zmc2V0O1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHRcbiAgICB9O1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuXG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgLy8gR2V0IGFjdHVhbCBiYWNrZ3JvdW5kIGhlaWdodCBmcm9tIHN0cmF0ZWd5XG4gICAgY29uc3QgYWN0dWFsSGVpZ2h0ID0gdGhpcy5iYWNrZ3JvdW5kU3RyYXRlZ3kuZ2V0QWN0dWFsSGVpZ2h0KCk7XG5cbiAgICAvLyBMYXlvdXQgYW5kIGNlbnRlciBsYWJlbFxuICAgIGlmICh0aGlzLmxhYmVsKSB7XG4gICAgICB0aGlzLmxhYmVsLmxheW91dChtZWFzdXJlZC53aWR0aCwgbWVhc3VyZWQuaGVpZ2h0KTtcblxuICAgICAgLy8gQ2VudGVyIHRoZSBsYWJlbCBhbmQgY2FjaGUgdGhlIHBvc2l0aW9uXG4gICAgICBjb25zdCBsYWJlbExheW91dCA9IHRoaXMubGFiZWwuZ2V0TGF5b3V0KCk7XG4gICAgICB0aGlzLmxhYmVsQ2VudGVyWCA9IChtZWFzdXJlZC53aWR0aCAtIGxhYmVsTGF5b3V0LndpZHRoKSAvIDI7XG4gICAgICB0aGlzLmxhYmVsQ2VudGVyWSA9IChhY3R1YWxIZWlnaHQgLSBsYWJlbExheW91dC5oZWlnaHQpIC8gMjtcbiAgICAgIHRoaXMubGFiZWwuc2V0UG9zaXRpb24odGhpcy5sYWJlbENlbnRlclgsIHRoaXMubGFiZWxDZW50ZXJZKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuYml0bWFwTGFiZWwpIHtcbiAgICAgIC8vIENlbnRlciB0aGUgYml0bWFwIHRleHQgdXNpbmcgYWN0dWFsIGJhY2tncm91bmQgaGVpZ2h0XG4gICAgICB0aGlzLmxhYmVsQ2VudGVyWCA9IChtZWFzdXJlZC53aWR0aCAtIHRoaXMuYml0bWFwTGFiZWwud2lkdGgpIC8gMjtcbiAgICAgIHRoaXMubGFiZWxDZW50ZXJZID0gKGFjdHVhbEhlaWdodCAtIHRoaXMuYml0bWFwTGFiZWwuaGVpZ2h0KSAvIDI7XG4gICAgICB0aGlzLmJpdG1hcExhYmVsLnggPSB0aGlzLmxhYmVsQ2VudGVyWDtcbiAgICAgIHRoaXMuYml0bWFwTGFiZWwueSA9IHRoaXMubGFiZWxDZW50ZXJZO1xuICAgIH1cblxuICAgIHRoaXMubGF5b3V0RGlydHkgPSBmYWxzZTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIC8vIFJlbmRlcmluZyBpcyBoYW5kbGVkIGJ5IGJhY2tncm91bmQgYW5kIGxhYmVsXG4gIH1cblxuICAvKiogVXBkYXRlIGJ1dHRvbiB0ZXh0LiAqL1xuICBzZXRMYWJlbCh0ZXh0OiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5sYWJlbCkge1xuICAgICAgdGhpcy5sYWJlbC5zZXRUZXh0KHRleHQpO1xuICAgICAgdGhpcy5tYXJrTGF5b3V0RGlydHkoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuYml0bWFwTGFiZWwpIHtcbiAgICAgIHRoaXMuYml0bWFwTGFiZWwudGV4dCA9IHRleHQ7XG4gICAgICB0aGlzLm1hcmtMYXlvdXREaXJ0eSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBFbmFibGUgb3IgZGlzYWJsZSB0aGUgYnV0dG9uLiAqL1xuICBzZXRFbmFibGVkKGVuYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLmVuYWJsZWQgPSBlbmFibGVkO1xuICAgIHRoaXMuc2V0U3RhdGUoZW5hYmxlZCA/IEJ1dHRvblN0YXRlLk5vcm1hbCA6IEJ1dHRvblN0YXRlLkRpc2FibGVkKTtcbiAgfVxuXG4gIC8qKiBHZXQgY3VycmVudCB2aXN1YWwgc3RhdGUuICovXG4gIGdldFN0YXRlKCk6IEJ1dHRvblN0YXRlIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZTtcbiAgfVxuXG4gIC8qKiBDbGVhbiB1cCBldmVudCBsaXN0ZW5lcnMuICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHRoaXMua2V5ZG93bkhhbmRsZXIpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlkb3duSGFuZGxlcik7XG4gICAgfVxuICAgIHN1cGVyLmRlc3Ryb3koKTtcbiAgfVxuXG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcblxuLyoqIFRleHQgYWxpZ25tZW50IG9wdGlvbnMuICovXG5leHBvcnQgdHlwZSBUZXh0QWxpZ24gPSAnbGVmdCcgfCAnY2VudGVyJyB8ICdyaWdodCc7XG5cbi8qKiBVSUxhYmVsIGNvbmZpZ3VyYXRpb24uICovXG5leHBvcnQgaW50ZXJmYWNlIFVJTGFiZWxQcm9wcyB7XG4gIC8qKiBUaGUgdGV4dCB0byBkaXNwbGF5ICovXG4gIHRleHQ6IHN0cmluZztcbiAgLyoqIEZvbnQgc2l6ZSBpbiBwaXhlbHMgKi9cbiAgZm9udFNpemU/OiBudW1iZXI7XG4gIC8qKiBGb250IGZhbWlseSBuYW1lICovXG4gIGZvbnRGYW1pbHk/OiBzdHJpbmc7XG4gIC8qKiBUZXh0IGNvbG9yIChoZXggbnVtYmVyKSAqL1xuICBjb2xvcj86IG51bWJlcjtcbiAgLyoqIFRleHQgYWxpZ25tZW50ICovXG4gIGFsaWduPzogVGV4dEFsaWduO1xuICAvKiogRW5hYmxlIHdvcmQgd3JhcHBpbmcgKi9cbiAgd29yZFdyYXA/OiBib29sZWFuO1xuICAvKiogV29yZCB3cmFwIHdpZHRoIChyZXF1aXJlZCBpZiB3b3JkV3JhcCBpcyB0cnVlKSAqL1xuICB3b3JkV3JhcFdpZHRoPzogbnVtYmVyO1xuICAvKiogRm9udCB3ZWlnaHQgKi9cbiAgZm9udFdlaWdodD86IHN0cmluZztcbiAgLyoqIExpbmUgaGVpZ2h0IG11bHRpcGxpZXIgKi9cbiAgbGluZUhlaWdodD86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBUZXh0IGxhYmVsIGNvbXBvbmVudCB3cmFwcGluZyBQSVhJLlRleHQgd2l0aCBsYXlvdXQgaW50ZWdyYXRpb24uXG4gKiBTdXBwb3J0cyB3b3JkIHdyYXBwaW5nLCBjdXN0b20gZm9udHMsIGFuZCBhbGlnbm1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjb25zdCBsYWJlbCA9IG5ldyBVSUxhYmVsKHtcbiAqICAgdGV4dDogJ0hlbGxvIFdvcmxkJyxcbiAqICAgZm9udFNpemU6IDI0LFxuICogICBjb2xvcjogMHhmZmZmZmYsXG4gKiAgIGZvbnRGYW1pbHk6ICdBcmlhbCcsXG4gKiAgIGFsaWduOiAnY2VudGVyJ1xuICogfSk7XG4gKlxuICogLy8gV2l0aCB3b3JkIHdyYXBcbiAqIGNvbnN0IHBhcmFncmFwaCA9IG5ldyBVSUxhYmVsKHtcbiAqICAgdGV4dDogJ0xvbmcgdGV4dCB0aGF0IG5lZWRzIHdyYXBwaW5nLi4uJyxcbiAqICAgd29yZFdyYXA6IHRydWUsXG4gKiAgIHdvcmRXcmFwV2lkdGg6IDIwMFxuICogfSk7XG4gKlxuICogLy8gVXBkYXRlIHRleHQgZHluYW1pY2FsbHlcbiAqIGxhYmVsLnNldFRleHQoJ05ldyB0ZXh0Jyk7XG4gKiBsYWJlbC5zZXRDb2xvcigweGZmMDAwMCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJTGFiZWwgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFJlcXVpcmVkPFVJTGFiZWxQcm9wcz47XG4gIHByaXZhdGUgdGV4dE9iamVjdDogUElYSS5UZXh0O1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSUxhYmVsUHJvcHMsIGJveE1vZGVsPzogUGFydGlhbDxCb3hNb2RlbD4pIHtcbiAgICBzdXBlcihib3hNb2RlbCk7XG5cbiAgICB0aGlzLnByb3BzID0ge1xuICAgICAgdGV4dDogcHJvcHMudGV4dCxcbiAgICAgIGZvbnRTaXplOiBwcm9wcy5mb250U2l6ZSA/PyAxNixcbiAgICAgIGZvbnRGYW1pbHk6IHByb3BzLmZvbnRGYW1pbHkgPz8gJ0FyaWFsJyxcbiAgICAgIGNvbG9yOiBwcm9wcy5jb2xvciA/PyAweGZmZmZmZixcbiAgICAgIGFsaWduOiBwcm9wcy5hbGlnbiA/PyAnbGVmdCcsXG4gICAgICB3b3JkV3JhcDogcHJvcHMud29yZFdyYXAgPz8gZmFsc2UsXG4gICAgICB3b3JkV3JhcFdpZHRoOiBwcm9wcy53b3JkV3JhcFdpZHRoID8/IDAsXG4gICAgICBmb250V2VpZ2h0OiBwcm9wcy5mb250V2VpZ2h0ID8/ICdub3JtYWwnLFxuICAgICAgbGluZUhlaWdodDogcHJvcHMubGluZUhlaWdodCA/PyAxLjJcbiAgICB9O1xuXG4gICAgLy8gQ3JlYXRlIFBJWEkuVGV4dCB3aXRoIGluaXRpYWwgc3R5bGVcbiAgICB0aGlzLnRleHRPYmplY3QgPSBuZXcgUElYSS5UZXh0KHtcbiAgICAgIHRleHQ6IHRoaXMucHJvcHMudGV4dCxcbiAgICAgIHN0eWxlOiB0aGlzLmdldFRleHRTdHlsZSgpLFxuICAgICAgcmVzb2x1dGlvbjogd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMiAvLyBNYXRjaCBkZXZpY2UgcmVzb2x1dGlvbiBmb3IgY3Jpc3AgdGV4dFxuICAgIH0pO1xuXG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy50ZXh0T2JqZWN0KTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBnZXRUZXh0U3R5bGUoKTogUElYSS5UZXh0U3R5bGUge1xuICAgIGNvbnN0IHN0eWxlOiBhbnkgPSB7XG4gICAgICBmb250RmFtaWx5OiB0aGlzLnByb3BzLmZvbnRGYW1pbHksXG4gICAgICBmb250U2l6ZTogdGhpcy5wcm9wcy5mb250U2l6ZSxcbiAgICAgIGZpbGw6IHRoaXMucHJvcHMuY29sb3IsXG4gICAgICBhbGlnbjogdGhpcy5wcm9wcy5hbGlnbixcbiAgICAgIGZvbnRXZWlnaHQ6IHRoaXMucHJvcHMuZm9udFdlaWdodCxcbiAgICAgIGxpbmVIZWlnaHQ6IHRoaXMucHJvcHMuZm9udFNpemUgKiB0aGlzLnByb3BzLmxpbmVIZWlnaHRcbiAgICB9O1xuXG4gICAgaWYgKHRoaXMucHJvcHMud29yZFdyYXApIHtcbiAgICAgIHN0eWxlLndvcmRXcmFwID0gdHJ1ZTtcbiAgICAgIHN0eWxlLndvcmRXcmFwV2lkdGggPSB0aGlzLnByb3BzLndvcmRXcmFwV2lkdGg7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0eWxlO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICBjb25zdCBtZXRyaWNzID0gdGhpcy50ZXh0T2JqZWN0O1xuXG4gICAgLy8gR2V0IHRleHQgYm91bmRzXG4gICAgY29uc3QgdGV4dFdpZHRoID0gbWV0cmljcy53aWR0aDtcbiAgICBjb25zdCB0ZXh0SGVpZ2h0ID0gbWV0cmljcy5oZWlnaHQ7XG5cbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRleHRXaWR0aCArIHBhZGRpbmcuaG9yaXpvbnRhbCxcbiAgICAgIGhlaWdodDogdGV4dEhlaWdodCArIHBhZGRpbmcudmVydGljYWxcbiAgICB9O1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuXG4gICAgLy8gVXBkYXRlIHdvcmQgd3JhcCB3aWR0aCBpZiBuZWVkZWRcbiAgICBpZiAodGhpcy5wcm9wcy53b3JkV3JhcCAmJiB0aGlzLnByb3BzLndvcmRXcmFwV2lkdGggPT09IDApIHtcbiAgICAgIC8vIFVzZSBhdmFpbGFibGUgd2lkdGggbWludXMgcGFkZGluZ1xuICAgICAgY29uc3Qgd3JhcFdpZHRoID0gYXZhaWxhYmxlV2lkdGggLSBwYWRkaW5nLmhvcml6b250YWw7XG4gICAgICB0aGlzLnByb3BzLndvcmRXcmFwV2lkdGggPSB3cmFwV2lkdGg7XG4gICAgICB0aGlzLnRleHRPYmplY3Quc3R5bGUgPSB0aGlzLmdldFRleHRTdHlsZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG5cbiAgICAvLyBIYW5kbGUgJ2ZpbGwnIGNvbnN0cmFpbnRzXG4gICAgbGV0IGZpbmFsV2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICBsZXQgZmluYWxIZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG5cbiAgICBpZiAodGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ2ZpbGwnKSB7XG4gICAgICBmaW5hbFdpZHRoID0gYXZhaWxhYmxlV2lkdGg7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGZpbmFsV2lkdGggPSB0aGlzLmJveE1vZGVsLndpZHRoICsgcGFkZGluZy5ob3Jpem9udGFsO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ2ZpbGwnKSB7XG4gICAgICBmaW5hbEhlaWdodCA9IGF2YWlsYWJsZUhlaWdodDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGZpbmFsSGVpZ2h0ID0gdGhpcy5ib3hNb2RlbC5oZWlnaHQgKyBwYWRkaW5nLnZlcnRpY2FsO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb21wdXRlZCBsYXlvdXRcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gZmluYWxXaWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IGZpbmFsSGVpZ2h0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFggPSBwYWRkaW5nLmxlZnQ7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50WSA9IHBhZGRpbmcudG9wO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFdpZHRoID0gZmluYWxXaWR0aCAtIHBhZGRpbmcuaG9yaXpvbnRhbDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRIZWlnaHQgPSBmaW5hbEhlaWdodCAtIHBhZGRpbmcudmVydGljYWw7XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuICAgIHRoaXMudGV4dE9iamVjdC5wb3NpdGlvbi5zZXQocGFkZGluZy5sZWZ0LCBwYWRkaW5nLnRvcCk7XG4gIH1cblxuICAvKiogVXBkYXRlIGRpc3BsYXllZCB0ZXh0LiAqL1xuICBzZXRUZXh0KHRleHQ6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMucHJvcHMudGV4dCA9IHRleHQ7XG4gICAgdGhpcy50ZXh0T2JqZWN0LnRleHQgPSB0ZXh0O1xuICAgIHRoaXMubWFya0xheW91dERpcnR5KCk7XG4gIH1cblxuICAvKiogVXBkYXRlIHRleHQgY29sb3IuICovXG4gIHNldENvbG9yKGNvbG9yOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLmNvbG9yID0gY29sb3I7XG4gICAgdGhpcy50ZXh0T2JqZWN0LnN0eWxlLmZpbGwgPSBjb2xvcjtcbiAgfVxuXG4gIC8qKiBVcGRhdGUgZm9udCBzaXplLiAqL1xuICBzZXRGb250U2l6ZShzaXplOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLmZvbnRTaXplID0gc2l6ZTtcbiAgICB0aGlzLnRleHRPYmplY3Quc3R5bGUuZm9udFNpemUgPSBzaXplO1xuICAgIHRoaXMubWFya0xheW91dERpcnR5KCk7XG4gIH1cblxuICAvKiogR2V0IGN1cnJlbnQgdGV4dC4gKi9cbiAgZ2V0VGV4dCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnByb3BzLnRleHQ7XG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuXG4vKiogOS1zbGljZSBjb25maWd1cmF0aW9uIGZvciBzY2FsYWJsZSBzcHJpdGVzLiAqL1xuZXhwb3J0IGludGVyZmFjZSBOaW5lU2xpY2VDb25maWcge1xuICAvKiogV2lkdGggb2YgbGVmdCBlZGdlIHRoYXQgZG9lc24ndCBzY2FsZSAqL1xuICBsZWZ0V2lkdGg6IG51bWJlcjtcbiAgLyoqIEhlaWdodCBvZiB0b3AgZWRnZSB0aGF0IGRvZXNuJ3Qgc2NhbGUgKi9cbiAgdG9wSGVpZ2h0OiBudW1iZXI7XG4gIC8qKiBXaWR0aCBvZiByaWdodCBlZGdlIHRoYXQgZG9lc24ndCBzY2FsZSAqL1xuICByaWdodFdpZHRoOiBudW1iZXI7XG4gIC8qKiBIZWlnaHQgb2YgYm90dG9tIGVkZ2UgdGhhdCBkb2Vzbid0IHNjYWxlICovXG4gIGJvdHRvbUhlaWdodDogbnVtYmVyO1xufVxuXG4vKiogVUlQYW5lbCBjb25maWd1cmF0aW9uLiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSVBhbmVsUHJvcHMge1xuICAvKiogQmFja2dyb3VuZCB0ZXh0dXJlICovXG4gIHRleHR1cmU/OiBQSVhJLlRleHR1cmU7XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yIChpZiBubyB0ZXh0dXJlKSAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBCYWNrZ3JvdW5kIGFscGhhICovXG4gIGJhY2tncm91bmRBbHBoYT86IG51bWJlcjtcbiAgLyoqIDktc2xpY2UgY29uZmlndXJhdGlvbiAoaWYgdXNpbmcgdGV4dHVyZSkgKi9cbiAgbmluZVNsaWNlPzogTmluZVNsaWNlQ29uZmlnO1xuICAvKiogRml4ZWQgd2lkdGggKi9cbiAgd2lkdGg/OiBudW1iZXI7XG4gIC8qKiBGaXhlZCBoZWlnaHQgKi9cbiAgaGVpZ2h0PzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyAoaWYgdXNpbmcgc29saWQgY29sb3IpICovXG4gIGJvcmRlclJhZGl1cz86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBQYW5lbCBjb21wb25lbnQgd2l0aCA5LXNsaWNlIHNwcml0ZSBvciBzb2xpZCBjb2xvciBiYWNrZ3JvdW5kLlxuICogVXNlIGZvciBjb250YWluZXJzLCB3aW5kb3dzLCBjYXJkcywgYW5kIG90aGVyIFVJIGJhY2tncm91bmRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogLy8gOS1zbGljZSBzcHJpdGUgYmFja2dyb3VuZCAoc2NhbGVzIHdpdGhvdXQgZGlzdG9ydGluZyBjb3JuZXJzKVxuICogY29uc3QgcGFuZWwgPSBuZXcgVUlQYW5lbCh7XG4gKiAgIHRleHR1cmU6IHBhbmVsVGV4dHVyZSxcbiAqICAgbmluZVNsaWNlOiB7IGxlZnRXaWR0aDogMTYsIHRvcEhlaWdodDogMTYsIHJpZ2h0V2lkdGg6IDE2LCBib3R0b21IZWlnaHQ6IDE2IH0sXG4gKiAgIHdpZHRoOiAzMDAsXG4gKiAgIGhlaWdodDogMjAwXG4gKiB9KTtcbiAqXG4gKiAvLyBTb2xpZCBjb2xvciBiYWNrZ3JvdW5kXG4gKiBjb25zdCBjb2xvclBhbmVsID0gbmV3IFVJUGFuZWwoe1xuICogICBiYWNrZ3JvdW5kQ29sb3I6IDB4MmMzZTUwLFxuICogICBiYWNrZ3JvdW5kQWxwaGE6IDAuOSxcbiAqICAgd2lkdGg6IDMwMCxcbiAqICAgaGVpZ2h0OiAyMDAsXG4gKiAgIGJvcmRlclJhZGl1czogOFxuICogfSk7XG4gKlxuICogLy8gVXBkYXRlIGF0IHJ1bnRpbWVcbiAqIHBhbmVsLnNldEJhY2tncm91bmRDb2xvcigweGZmMDAwMCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJUGFuZWwgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFVJUGFuZWxQcm9wcztcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kPzogUElYSS5OaW5lU2xpY2VTcHJpdGUgfCBQSVhJLkdyYXBoaWNzO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSVBhbmVsUHJvcHMgPSB7fSwgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBiYWNrZ3JvdW5kQWxwaGE6IHByb3BzLmJhY2tncm91bmRBbHBoYSA/PyAxLFxuICAgICAgLi4ucHJvcHNcbiAgICB9O1xuXG4gICAgLy8gU2V0IGJveCBtb2RlbCBkaW1lbnNpb25zIGlmIHByb3ZpZGVkXG4gICAgaWYgKHByb3BzLndpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSBwcm9wcy53aWR0aDtcbiAgICB9XG4gICAgaWYgKHByb3BzLmhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmJveE1vZGVsLmhlaWdodCA9IHByb3BzLmhlaWdodDtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYmFja2dyb3VuZFxuICAgIHRoaXMuY3JlYXRlQmFja2dyb3VuZCgpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIGNyZWF0ZUJhY2tncm91bmQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMudGV4dHVyZSAmJiB0aGlzLnByb3BzLm5pbmVTbGljZSkge1xuICAgICAgLy8gVXNlIDktc2xpY2Ugc3ByaXRlXG4gICAgICBjb25zdCB7IGxlZnRXaWR0aCwgdG9wSGVpZ2h0LCByaWdodFdpZHRoLCBib3R0b21IZWlnaHQgfSA9IHRoaXMucHJvcHMubmluZVNsaWNlO1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFBJWEkuTmluZVNsaWNlU3ByaXRlKHtcbiAgICAgICAgdGV4dHVyZTogdGhpcy5wcm9wcy50ZXh0dXJlLFxuICAgICAgICBsZWZ0V2lkdGgsXG4gICAgICAgIHRvcEhlaWdodCxcbiAgICAgICAgcmlnaHRXaWR0aCxcbiAgICAgICAgYm90dG9tSGVpZ2h0XG4gICAgICB9KTtcbiAgICAgIHRoaXMuYmFja2dyb3VuZC5hbHBoYSA9IHRoaXMucHJvcHMuYmFja2dyb3VuZEFscGhhID8/IDE7XG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gVXNlIGdyYXBoaWNzIGZvciBzb2xpZCBjb2xvclxuICAgICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuYmFja2dyb3VuZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcblxuICAgIGxldCBjb250ZW50V2lkdGggPSAwO1xuICAgIGxldCBjb250ZW50SGVpZ2h0ID0gMDtcblxuICAgIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnRlbnRXaWR0aCA9IHRoaXMuYm94TW9kZWwud2lkdGg7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLndpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnRlbnRXaWR0aCA9IHRoaXMucHJvcHMud2lkdGg7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnRlbnRIZWlnaHQgPSB0aGlzLmJveE1vZGVsLmhlaWdodDtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuaGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnRlbnRIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IGNvbnRlbnRXaWR0aCArIHBhZGRpbmcuaG9yaXpvbnRhbCxcbiAgICAgIGhlaWdodDogY29udGVudEhlaWdodCArIHBhZGRpbmcudmVydGljYWxcbiAgICB9O1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG5cbiAgICAvLyBDYWxjdWxhdGUgZmluYWwgZGltZW5zaW9uc1xuICAgIGxldCBmaW5hbFdpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgbGV0IGZpbmFsSGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgaWYgKHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdmaWxsJykge1xuICAgICAgZmluYWxXaWR0aCA9IGF2YWlsYWJsZVdpZHRoO1xuICAgIH1cbiAgICBpZiAodGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdmaWxsJykge1xuICAgICAgZmluYWxIZWlnaHQgPSBhdmFpbGFibGVIZWlnaHQ7XG4gICAgfVxuXG4gICAgLy8gQXBwbHkgbWF4IGNvbnN0cmFpbnRzXG4gICAgaWYgKHRoaXMuYm94TW9kZWwubWF4V2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgZmluYWxXaWR0aCA9IE1hdGgubWluKGZpbmFsV2lkdGgsIHRoaXMuYm94TW9kZWwubWF4V2lkdGgpO1xuICAgIH1cbiAgICBpZiAodGhpcy5ib3hNb2RlbC5tYXhIZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZmluYWxIZWlnaHQgPSBNYXRoLm1pbihmaW5hbEhlaWdodCwgdGhpcy5ib3hNb2RlbC5tYXhIZWlnaHQpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb21wdXRlZCBsYXlvdXRcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gZmluYWxXaWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IGZpbmFsSGVpZ2h0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFggPSBwYWRkaW5nLmxlZnQ7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50WSA9IHBhZGRpbmcudG9wO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFdpZHRoID0gZmluYWxXaWR0aCAtIHBhZGRpbmcuaG9yaXpvbnRhbDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRIZWlnaHQgPSBmaW5hbEhlaWdodCAtIHBhZGRpbmcudmVydGljYWw7XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYmFja2dyb3VuZCkgcmV0dXJuO1xuXG4gICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSB0aGlzLmNvbXB1dGVkTGF5b3V0O1xuXG4gICAgaWYgKHRoaXMuYmFja2dyb3VuZCBpbnN0YW5jZW9mIFBJWEkuTmluZVNsaWNlU3ByaXRlKSB7XG4gICAgICAvLyBVcGRhdGUgOS1zbGljZSBzcHJpdGUgc2l6ZVxuICAgICAgdGhpcy5iYWNrZ3JvdW5kLndpZHRoID0gd2lkdGg7XG4gICAgICB0aGlzLmJhY2tncm91bmQuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIH0gZWxzZSBpZiAodGhpcy5iYWNrZ3JvdW5kIGluc3RhbmNlb2YgUElYSS5HcmFwaGljcykge1xuICAgICAgLy8gUmVkcmF3IGdyYXBoaWNzXG4gICAgICB0aGlzLmJhY2tncm91bmQuY2xlYXIoKTtcblxuICAgICAgaWYgKHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzICYmIHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzID4gMCkge1xuICAgICAgICB0aGlzLmJhY2tncm91bmQucm91bmRSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQsIHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYmFja2dyb3VuZC5yZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmJhY2tncm91bmQuZmlsbCh7XG4gICAgICAgICAgY29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgICAgIGFscGhhOiB0aGlzLnByb3BzLmJhY2tncm91bmRBbHBoYVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKiogVXBkYXRlIGJhY2tncm91bmQgY29sb3IgKHNvbGlkIGNvbG9yIHBhbmVscyBvbmx5KS4gKi9cbiAgc2V0QmFja2dyb3VuZENvbG9yKGNvbG9yOiBudW1iZXIsIGFscGhhOiBudW1iZXIgPSAxKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuYmFja2dyb3VuZCBpbnN0YW5jZW9mIFBJWEkuR3JhcGhpY3MpIHtcbiAgICAgIHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XG4gICAgICB0aGlzLnByb3BzLmJhY2tncm91bmRBbHBoYSA9IGFscGhhO1xuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG4gIH1cblxuICAvKiogVXBkYXRlIHRleHR1cmUgKHRleHR1cmUtYmFzZWQgcGFuZWxzIG9ubHkpLiAqL1xuICBzZXRUZXh0dXJlKHRleHR1cmU6IFBJWEkuVGV4dHVyZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLmJhY2tncm91bmQgaW5zdGFuY2VvZiBQSVhJLk5pbmVTbGljZVNwcml0ZSkge1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kLnRleHR1cmUgPSB0ZXh0dXJlO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5pbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi4vY29yZS9lZGdlLWluc2V0cyc7XG5cbi8qKlxuICogUHJvcHMgZm9yIGNvbmZpZ3VyaW5nIGEgVUlTY3JvbGxDb250YWluZXJcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSVNjcm9sbENvbnRhaW5lclByb3BzIHtcbiAgLyoqIFdpZHRoIG9mIHRoZSBzY3JvbGwgY29udGFpbmVyICovXG4gIHdpZHRoOiBudW1iZXI7XG4gIC8qKiBIZWlnaHQgb2YgdGhlIHNjcm9sbCBjb250YWluZXIgKHZpZXdwb3J0IGhlaWdodCkgKi9cbiAgaGVpZ2h0OiBudW1iZXI7XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yIG9mIHRoZSBjb250YWluZXIgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG4gIC8qKiBTY3JvbGxiYXIgd2lkdGggKi9cbiAgc2Nyb2xsYmFyV2lkdGg/OiBudW1iZXI7XG4gIC8qKiBTY3JvbGxiYXIgdHJhY2sgY29sb3IgKi9cbiAgc2Nyb2xsYmFyVHJhY2tDb2xvcj86IG51bWJlcjtcbiAgLyoqIFNjcm9sbGJhciB0aHVtYiBjb2xvciAqL1xuICBzY3JvbGxiYXJUaHVtYkNvbG9yPzogbnVtYmVyO1xuICAvKiogU2Nyb2xsYmFyIHRodW1iIGhvdmVyIGNvbG9yICovXG4gIHNjcm9sbGJhclRodW1iSG92ZXJDb2xvcj86IG51bWJlcjtcbiAgLyoqIFdoZXRoZXIgdG8gc2hvdyBzY3JvbGxiYXIgb25seSBvbiBob3ZlciAqL1xuICBzY3JvbGxiYXJBdXRvSGlkZT86IGJvb2xlYW47XG4gIC8qKiBQYWRkaW5nIGluc2lkZSB0aGUgc2Nyb2xsIGNvbnRhaW5lciAqL1xuICBwYWRkaW5nPzogRWRnZUluc2V0cztcbn1cblxuLyoqXG4gKiBBIHNjcm9sbGFibGUgY29udGFpbmVyIHdpdGggYSB2aXN1YWwgc2Nyb2xsYmFyXG4gKiBTdXBwb3J0cyBtb3VzZSB3aGVlbCBzY3JvbGxpbmcgYW5kIGRyYWdnYWJsZSBzY3JvbGxiYXIgdGh1bWJcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3Qgc2Nyb2xsQ29udGFpbmVyID0gbmV3IFVJU2Nyb2xsQ29udGFpbmVyKHtcbiAqICAgd2lkdGg6IDQwMCxcbiAqICAgaGVpZ2h0OiAzMDAsXG4gKiAgIGJhY2tncm91bmRDb2xvcjogMHhmZmZmZmZcbiAqIH0pO1xuICpcbiAqIC8vIEFkZCBjaGlsZHJlbiB0aGF0IGV4Y2VlZCB0aGUgdmlld3BvcnQgaGVpZ2h0XG4gKiBzY3JvbGxDb250YWluZXIuYWRkQ2hpbGQoc29tZVVJQ29tcG9uZW50KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlTY3JvbGxDb250YWluZXIgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFJlcXVpcmVkPFVJU2Nyb2xsQ29udGFpbmVyUHJvcHM+O1xuICBwcml2YXRlIGJhY2tncm91bmQ6IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgY29udGVudENvbnRhaW5lcjogUElYSS5Db250YWluZXI7XG4gIHByaXZhdGUgY29udGVudE1hc2s6IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgc2Nyb2xsYmFyVHJhY2s6IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgc2Nyb2xsYmFyVGh1bWI6IFBJWEkuR3JhcGhpY3M7XG5cbiAgLy8gUHVibGljIGNoaWxkcmVuIGFycmF5IGZvciBmb2N1cyBtYW5hZ2VyIGRpc2NvdmVyeVxuICBwdWJsaWMgY2hpbGRyZW46IFVJQ29tcG9uZW50W10gPSBbXTtcblxuICBwcml2YXRlIHNjcm9sbFk6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgbWF4U2Nyb2xsWTogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBjb250ZW50SGVpZ2h0OiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGlzRHJhZ2dpbmc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBkcmFnU3RhcnRZOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGRyYWdTdGFydFNjcm9sbFk6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgaXNIb3ZlcmluZ1RodW1iOiBib29sZWFuID0gZmFsc2U7XG5cbiAgLy8gQm91bmQgaGFuZGxlcnMgZm9yIHByb3BlciBjbGVhbnVwXG4gIHByaXZhdGUgYm91bmRHbG9iYWxQb2ludGVyTW92ZTogKChlOiBQb2ludGVyRXZlbnQpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgYm91bmRHbG9iYWxQb2ludGVyVXA6ICgoKSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSVNjcm9sbENvbnRhaW5lclByb3BzLCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIHdpZHRoOiBwcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogcHJvcHMuaGVpZ2h0LFxuICAgICAgYmFja2dyb3VuZENvbG9yOiBwcm9wcy5iYWNrZ3JvdW5kQ29sb3IgPz8gMHhmZmZmZmYsXG4gICAgICBib3JkZXJSYWRpdXM6IHByb3BzLmJvcmRlclJhZGl1cyA/PyAwLFxuICAgICAgc2Nyb2xsYmFyV2lkdGg6IHByb3BzLnNjcm9sbGJhcldpZHRoID8/IDEyLFxuICAgICAgc2Nyb2xsYmFyVHJhY2tDb2xvcjogcHJvcHMuc2Nyb2xsYmFyVHJhY2tDb2xvciA/PyAweGUwZTBlMCxcbiAgICAgIHNjcm9sbGJhclRodW1iQ29sb3I6IHByb3BzLnNjcm9sbGJhclRodW1iQ29sb3IgPz8gMHg4ODg4ODgsXG4gICAgICBzY3JvbGxiYXJUaHVtYkhvdmVyQ29sb3I6IHByb3BzLnNjcm9sbGJhclRodW1iSG92ZXJDb2xvciA/PyAweDU1NTU1NSxcbiAgICAgIHNjcm9sbGJhckF1dG9IaWRlOiBwcm9wcy5zY3JvbGxiYXJBdXRvSGlkZSA/PyBmYWxzZSxcbiAgICAgIHBhZGRpbmc6IHByb3BzLnBhZGRpbmcgPz8gRWRnZUluc2V0cy5hbGwoMClcbiAgICB9O1xuXG4gICAgLy8gU2V0IGJveCBtb2RlbCBkaW1lbnNpb25zXG4gICAgdGhpcy5ib3hNb2RlbC53aWR0aCA9IHRoaXMucHJvcHMud2lkdGg7XG4gICAgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcblxuICAgIC8vIENyZWF0ZSBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0aGlzLnVwZGF0ZUJhY2tncm91bmQoKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQpO1xuXG4gICAgLy8gQ3JlYXRlIGNvbnRlbnQgY29udGFpbmVyXG4gICAgdGhpcy5jb250ZW50Q29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgdGhpcy5jb250ZW50Q29udGFpbmVyLnggPSB0aGlzLnByb3BzLnBhZGRpbmcubGVmdDtcbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIueSA9IHRoaXMucHJvcHMucGFkZGluZy50b3A7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5jb250ZW50Q29udGFpbmVyKTtcblxuICAgIC8vIENyZWF0ZSBtYXNrIGZvciBjb250ZW50XG4gICAgdGhpcy5jb250ZW50TWFzayA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy51cGRhdGVNYXNrKCk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5jb250ZW50TWFzayk7XG4gICAgdGhpcy5jb250ZW50Q29udGFpbmVyLm1hc2sgPSB0aGlzLmNvbnRlbnRNYXNrO1xuXG4gICAgLy8gQ3JlYXRlIHNjcm9sbGJhciB0cmFja1xuICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2sgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2suZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgdGhpcy5zY3JvbGxiYXJUcmFjay5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5zY3JvbGxiYXJUcmFjayk7XG5cbiAgICAvLyBDcmVhdGUgc2Nyb2xsYmFyIHRodW1iXG4gICAgdGhpcy5zY3JvbGxiYXJUaHVtYiA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICB0aGlzLnNjcm9sbGJhclRodW1iLmN1cnNvciA9ICdwb2ludGVyJztcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnNjcm9sbGJhclRodW1iKTtcblxuICAgIC8vIFNldHVwIGludGVyYWN0aXZpdHlcbiAgICB0aGlzLnNldHVwSW50ZXJhY3Rpdml0eSgpO1xuXG4gICAgLy8gSW5pdGlhbCBzY3JvbGxiYXIgdXBkYXRlXG4gICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBiYWNrZ3JvdW5kIGdyYXBoaWNzXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZUJhY2tncm91bmQoKTogdm9pZCB7XG4gICAgdGhpcy5iYWNrZ3JvdW5kLmNsZWFyKCk7XG4gICAgdGhpcy5iYWNrZ3JvdW5kLnJvdW5kUmVjdChcbiAgICAgIDAsXG4gICAgICAwLFxuICAgICAgdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICApO1xuICAgIHRoaXMuYmFja2dyb3VuZC5maWxsKHsgY29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGNvbnRlbnQgbWFza1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVNYXNrKCk6IHZvaWQge1xuICAgIGNvbnN0IGNvbnRlbnRXaWR0aCA9IHRoaXMucHJvcHMud2lkdGggLSB0aGlzLnByb3BzLnBhZGRpbmcubGVmdCAtIHRoaXMucHJvcHMucGFkZGluZy5yaWdodCAtIHRoaXMucHJvcHMuc2Nyb2xsYmFyV2lkdGg7XG4gICAgY29uc3QgY29udGVudEhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0IC0gdGhpcy5wcm9wcy5wYWRkaW5nLnRvcCAtIHRoaXMucHJvcHMucGFkZGluZy5ib3R0b207XG5cbiAgICB0aGlzLmNvbnRlbnRNYXNrLmNsZWFyKCk7XG4gICAgdGhpcy5jb250ZW50TWFzay5yZWN0KFxuICAgICAgdGhpcy5wcm9wcy5wYWRkaW5nLmxlZnQsXG4gICAgICB0aGlzLnByb3BzLnBhZGRpbmcudG9wLFxuICAgICAgY29udGVudFdpZHRoLFxuICAgICAgY29udGVudEhlaWdodFxuICAgICk7XG4gICAgdGhpcy5jb250ZW50TWFzay5maWxsKHsgY29sb3I6IDB4ZmZmZmZmIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgbW91c2Uvd2hlZWwgZXZlbnQgaGFuZGxlcnNcbiAgICovXG4gIHByaXZhdGUgc2V0dXBJbnRlcmFjdGl2aXR5KCk6IHZvaWQge1xuICAgIC8vIE1vdXNlIHdoZWVsIHNjcm9sbGluZ1xuICAgIHRoaXMuY29udGFpbmVyLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCd3aGVlbCcsIHRoaXMuaGFuZGxlV2hlZWwuYmluZCh0aGlzKSk7XG5cbiAgICAvLyBTY3JvbGxiYXIgdGh1bWIgZHJhZ2dpbmdcbiAgICB0aGlzLnNjcm9sbGJhclRodW1iLm9uKCdwb2ludGVyZG93bicsIHRoaXMuaGFuZGxlVGh1bWJQb2ludGVyRG93bi5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLnNjcm9sbGJhclRodW1iLm9uKCdwb2ludGVyb3ZlcicsICgpID0+IHtcbiAgICAgIHRoaXMuaXNIb3ZlcmluZ1RodW1iID0gdHJ1ZTtcbiAgICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gICAgfSk7XG4gICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5vbigncG9pbnRlcm91dCcsICgpID0+IHtcbiAgICAgIGlmICghdGhpcy5pc0RyYWdnaW5nKSB7XG4gICAgICAgIHRoaXMuaXNIb3ZlcmluZ1RodW1iID0gZmFsc2U7XG4gICAgICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBUcmFjayBjbGljayBmb3IganVtcGluZ1xuICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2sub24oJ3BvaW50ZXJkb3duJywgdGhpcy5oYW5kbGVUcmFja1BvaW50ZXJEb3duLmJpbmQodGhpcykpO1xuXG4gICAgLy8gR2xvYmFsIHBvaW50ZXIgZXZlbnRzIGZvciBkcmFnZ2luZyAtIHN0b3JlIGJvdW5kIHJlZmVyZW5jZXMgZm9yIGNsZWFudXBcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRoaXMuYm91bmRHbG9iYWxQb2ludGVyTW92ZSA9IHRoaXMuaGFuZGxlR2xvYmFsUG9pbnRlck1vdmUuYmluZCh0aGlzKTtcbiAgICAgIHRoaXMuYm91bmRHbG9iYWxQb2ludGVyVXAgPSB0aGlzLmhhbmRsZUdsb2JhbFBvaW50ZXJVcC5iaW5kKHRoaXMpO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJtb3ZlJywgdGhpcy5ib3VuZEdsb2JhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCB0aGlzLmJvdW5kR2xvYmFsUG9pbnRlclVwKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBtb3VzZSB3aGVlbCBldmVudHNcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlV2hlZWwoZTogUElYSS5GZWRlcmF0ZWRXaGVlbEV2ZW50KTogdm9pZCB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgZGVsdGEgPSBlLmRlbHRhWTtcbiAgICB0aGlzLnNjcm9sbFkgKz0gZGVsdGE7XG4gICAgdGhpcy5zY3JvbGxZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4odGhpcy5tYXhTY3JvbGxZLCB0aGlzLnNjcm9sbFkpKTtcblxuICAgIHRoaXMudXBkYXRlQ29udGVudFBvc2l0aW9uKCk7XG4gICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIHBvaW50ZXIgZG93biBvbiBzY3JvbGxiYXIgdGh1bWJcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlVGh1bWJQb2ludGVyRG93bihlOiBQSVhJLkZlZGVyYXRlZFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIHRoaXMuaXNEcmFnZ2luZyA9IHRydWU7XG4gICAgdGhpcy5kcmFnU3RhcnRZID0gZS5nbG9iYWxZO1xuICAgIHRoaXMuZHJhZ1N0YXJ0U2Nyb2xsWSA9IHRoaXMuc2Nyb2xsWTtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgcG9pbnRlciBkb3duIG9uIHNjcm9sbGJhciB0cmFja1xuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVUcmFja1BvaW50ZXJEb3duKGU6IFBJWEkuRmVkZXJhdGVkUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgbG9jYWxZID0gZS5nbG9iYWxZIC0gdGhpcy5jb250YWluZXIud29ybGRUcmFuc2Zvcm0udHk7XG4gICAgY29uc3QgdGh1bWJIZWlnaHQgPSB0aGlzLmdldFRodW1iSGVpZ2h0KCk7XG4gICAgY29uc3QgdHJhY2tUb3AgPSAwO1xuICAgIGNvbnN0IHRyYWNrQm90dG9tID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG5cbiAgICAvLyBDYWxjdWxhdGUgdGFyZ2V0IHNjcm9sbCBwb3NpdGlvblxuICAgIGNvbnN0IGNsaWNrUmF0aW8gPSAobG9jYWxZIC0gdHJhY2tUb3ApIC8gKHRyYWNrQm90dG9tIC0gdHJhY2tUb3ApO1xuICAgIHRoaXMuc2Nyb2xsWSA9IGNsaWNrUmF0aW8gKiB0aGlzLm1heFNjcm9sbFk7XG4gICAgdGhpcy5zY3JvbGxZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4odGhpcy5tYXhTY3JvbGxZLCB0aGlzLnNjcm9sbFkpKTtcblxuICAgIHRoaXMudXBkYXRlQ29udGVudFBvc2l0aW9uKCk7XG4gICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGdsb2JhbCBwb2ludGVyIG1vdmUgZm9yIHRodW1iIGRyYWdnaW5nXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZUdsb2JhbFBvaW50ZXJNb3ZlKGU6IFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5pc0RyYWdnaW5nKSByZXR1cm47XG5cbiAgICBjb25zdCBkZWx0YVkgPSBlLmNsaWVudFkgLSB0aGlzLmRyYWdTdGFydFk7XG4gICAgY29uc3QgdHJhY2tIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcbiAgICBjb25zdCB0aHVtYkhlaWdodCA9IHRoaXMuZ2V0VGh1bWJIZWlnaHQoKTtcbiAgICBjb25zdCBzY3JvbGxhYmxlVHJhY2tIZWlnaHQgPSB0cmFja0hlaWdodCAtIHRodW1iSGVpZ2h0O1xuXG4gICAgaWYgKHNjcm9sbGFibGVUcmFja0hlaWdodCA8PSAwKSByZXR1cm47XG5cbiAgICBjb25zdCBzY3JvbGxEZWx0YSA9IChkZWx0YVkgLyBzY3JvbGxhYmxlVHJhY2tIZWlnaHQpICogdGhpcy5tYXhTY3JvbGxZO1xuICAgIHRoaXMuc2Nyb2xsWSA9IHRoaXMuZHJhZ1N0YXJ0U2Nyb2xsWSArIHNjcm9sbERlbHRhO1xuICAgIHRoaXMuc2Nyb2xsWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMubWF4U2Nyb2xsWSwgdGhpcy5zY3JvbGxZKSk7XG5cbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRQb3NpdGlvbigpO1xuICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBnbG9iYWwgcG9pbnRlciB1cCB0byBlbmQgZHJhZ2dpbmdcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlR2xvYmFsUG9pbnRlclVwKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlzRHJhZ2dpbmcpIHtcbiAgICAgIHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlO1xuICAgICAgaWYgKCF0aGlzLmlzSG92ZXJpbmdUaHVtYikge1xuICAgICAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBjb250ZW50IHBvc2l0aW9uIGJhc2VkIG9uIHNjcm9sbFxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVDb250ZW50UG9zaXRpb24oKTogdm9pZCB7XG4gICAgdGhpcy5jb250ZW50Q29udGFpbmVyLnkgPSB0aGlzLnByb3BzLnBhZGRpbmcudG9wIC0gdGhpcy5zY3JvbGxZO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIHRodW1iIGhlaWdodCBiYXNlZCBvbiBjb250ZW50IHJhdGlvXG4gICAqL1xuICBwcml2YXRlIGdldFRodW1iSGVpZ2h0KCk6IG51bWJlciB7XG4gICAgaWYgKHRoaXMuY29udGVudEhlaWdodCA8PSAwKSByZXR1cm4gMDtcblxuICAgIGNvbnN0IHZpZXdwb3J0SGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQgLSB0aGlzLnByb3BzLnBhZGRpbmcudG9wIC0gdGhpcy5wcm9wcy5wYWRkaW5nLmJvdHRvbTtcbiAgICBjb25zdCByYXRpbyA9IHZpZXdwb3J0SGVpZ2h0IC8gdGhpcy5jb250ZW50SGVpZ2h0O1xuICAgIGNvbnN0IHRodW1iSGVpZ2h0ID0gTWF0aC5tYXgoMzAsIHRoaXMucHJvcHMuaGVpZ2h0ICogcmF0aW8pO1xuXG4gICAgcmV0dXJuIE1hdGgubWluKHRodW1iSGVpZ2h0LCB0aGlzLnByb3BzLmhlaWdodCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgdGh1bWIgWSBwb3NpdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBnZXRUaHVtYlkoKTogbnVtYmVyIHtcbiAgICBpZiAodGhpcy5tYXhTY3JvbGxZIDw9IDApIHJldHVybiAwO1xuXG4gICAgY29uc3QgdHJhY2tIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcbiAgICBjb25zdCB0aHVtYkhlaWdodCA9IHRoaXMuZ2V0VGh1bWJIZWlnaHQoKTtcbiAgICBjb25zdCBzY3JvbGxhYmxlVHJhY2tIZWlnaHQgPSB0cmFja0hlaWdodCAtIHRodW1iSGVpZ2h0O1xuXG4gICAgY29uc3Qgc2Nyb2xsUmF0aW8gPSB0aGlzLnNjcm9sbFkgLyB0aGlzLm1heFNjcm9sbFk7XG4gICAgcmV0dXJuIHNjcm9sbFJhdGlvICogc2Nyb2xsYWJsZVRyYWNrSGVpZ2h0O1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIHNjcm9sbGJhciBhcHBlYXJhbmNlXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZVNjcm9sbGJhcigpOiB2b2lkIHtcbiAgICBjb25zdCB0cmFja1ggPSB0aGlzLnByb3BzLndpZHRoIC0gdGhpcy5wcm9wcy5zY3JvbGxiYXJXaWR0aDtcbiAgICBjb25zdCB0cmFja1dpZHRoID0gdGhpcy5wcm9wcy5zY3JvbGxiYXJXaWR0aDtcbiAgICBjb25zdCB0cmFja0hlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuXG4gICAgLy8gVXBkYXRlIHRyYWNrXG4gICAgdGhpcy5zY3JvbGxiYXJUcmFjay5jbGVhcigpO1xuICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2sucmVjdCh0cmFja1gsIDAsIHRyYWNrV2lkdGgsIHRyYWNrSGVpZ2h0KTtcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrLmZpbGwoeyBjb2xvcjogdGhpcy5wcm9wcy5zY3JvbGxiYXJUcmFja0NvbG9yIH0pO1xuXG4gICAgLy8gVXBkYXRlIHRodW1iXG4gICAgY29uc3QgdGh1bWJIZWlnaHQgPSB0aGlzLmdldFRodW1iSGVpZ2h0KCk7XG4gICAgY29uc3QgdGh1bWJZID0gdGhpcy5nZXRUaHVtYlkoKTtcbiAgICBjb25zdCB0aHVtYkNvbG9yID0gKHRoaXMuaXNIb3ZlcmluZ1RodW1iIHx8IHRoaXMuaXNEcmFnZ2luZylcbiAgICAgID8gdGhpcy5wcm9wcy5zY3JvbGxiYXJUaHVtYkhvdmVyQ29sb3JcbiAgICAgIDogdGhpcy5wcm9wcy5zY3JvbGxiYXJUaHVtYkNvbG9yO1xuXG4gICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5jbGVhcigpO1xuXG4gICAgLy8gT25seSBzaG93IHRodW1iIGlmIGNvbnRlbnQgaXMgc2Nyb2xsYWJsZVxuICAgIGlmICh0aGlzLm1heFNjcm9sbFkgPiAwKSB7XG4gICAgICB0aGlzLnNjcm9sbGJhclRodW1iLnJvdW5kUmVjdChcbiAgICAgICAgdHJhY2tYICsgMixcbiAgICAgICAgdGh1bWJZICsgMixcbiAgICAgICAgdHJhY2tXaWR0aCAtIDQsXG4gICAgICAgIHRodW1iSGVpZ2h0IC0gNCxcbiAgICAgICAgNFxuICAgICAgKTtcbiAgICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIuZmlsbCh7IGNvbG9yOiB0aHVtYkNvbG9yIH0pO1xuICAgICAgdGhpcy5zY3JvbGxiYXJUaHVtYi52aXNpYmxlID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zY3JvbGxiYXJUaHVtYi52aXNpYmxlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIGF1dG8taGlkZVxuICAgIGlmICh0aGlzLnByb3BzLnNjcm9sbGJhckF1dG9IaWRlICYmICF0aGlzLmlzRHJhZ2dpbmcgJiYgIXRoaXMuaXNIb3ZlcmluZ1RodW1iKSB7XG4gICAgICB0aGlzLnNjcm9sbGJhclRyYWNrLmFscGhhID0gMDtcbiAgICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIuYWxwaGEgPSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNjcm9sbGJhclRyYWNrLmFscGhhID0gMTtcbiAgICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIuYWxwaGEgPSAxO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZWNhbGN1bGF0ZXMgY29udGVudCBoZWlnaHQgYW5kIG1heCBzY3JvbGxcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlQ29udGVudEJvdW5kcygpOiB2b2lkIHtcbiAgICAvLyBDYWxjdWxhdGUgY29udGVudCBoZWlnaHQgZnJvbSBjaGlsZHJlbidzIGNvbXB1dGVkIGxheW91dHNcbiAgICBsZXQgbWF4SGVpZ2h0ID0gMDtcblxuICAgIHRoaXMuY29udGVudENvbnRhaW5lci5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZDogYW55KSA9PiB7XG4gICAgICBpZiAoY2hpbGQgJiYgdHlwZW9mIGNoaWxkLnkgPT09ICdudW1iZXInICYmIHR5cGVvZiBjaGlsZC5oZWlnaHQgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkQm90dG9tID0gY2hpbGQueSArIGNoaWxkLmhlaWdodDtcbiAgICAgICAgaWYgKGNoaWxkQm90dG9tID4gbWF4SGVpZ2h0KSB7XG4gICAgICAgICAgbWF4SGVpZ2h0ID0gY2hpbGRCb3R0b207XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuY29udGVudEhlaWdodCA9IG1heEhlaWdodDtcblxuICAgIGNvbnN0IHZpZXdwb3J0SGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQgLSB0aGlzLnByb3BzLnBhZGRpbmcudG9wIC0gdGhpcy5wcm9wcy5wYWRkaW5nLmJvdHRvbTtcbiAgICB0aGlzLm1heFNjcm9sbFkgPSBNYXRoLm1heCgwLCB0aGlzLmNvbnRlbnRIZWlnaHQgLSB2aWV3cG9ydEhlaWdodCk7XG5cbiAgICAvLyBDbGFtcCBjdXJyZW50IHNjcm9sbCBwb3NpdGlvblxuICAgIHRoaXMuc2Nyb2xsWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMubWF4U2Nyb2xsWSwgdGhpcy5zY3JvbGxZKSk7XG5cbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRQb3NpdGlvbigpO1xuICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIGNoaWxkIHRvIHRoZSBzY3JvbGxhYmxlIGNvbnRlbnRcbiAgICovXG4gIGFkZENoaWxkKGNoaWxkOiBVSUNvbXBvbmVudCk6IHZvaWQge1xuICAgIC8vIFNldCBwYXJlbnQgcmVmZXJlbmNlIGZvciBzY3JvbGwtaW50by12aWV3IHN1cHBvcnRcbiAgICBjaGlsZC5wYXJlbnQgPSB0aGlzIGFzIGFueTtcblxuICAgIC8vIFRyYWNrIGNoaWxkIGZvciBmb2N1cyBtYW5hZ2VyIGRpc2NvdmVyeVxuICAgIHRoaXMuY2hpbGRyZW4ucHVzaChjaGlsZCk7XG5cbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIuYWRkQ2hpbGQoY2hpbGQuY29udGFpbmVyKTtcblxuICAgIC8vIExheW91dCB0aGUgY2hpbGQgd2l0aCBhdmFpbGFibGUgY29udGVudCB3aWR0aFxuICAgIGNvbnN0IGNvbnRlbnRXaWR0aCA9IHRoaXMucHJvcHMud2lkdGggLSB0aGlzLnByb3BzLnBhZGRpbmcubGVmdCAtIHRoaXMucHJvcHMucGFkZGluZy5yaWdodCAtIHRoaXMucHJvcHMuc2Nyb2xsYmFyV2lkdGg7XG4gICAgY29uc3QgY29udGVudEhlaWdodCA9IDk5OTk5OTsgLy8gQWxsb3cgdW5saW1pdGVkIGhlaWdodCBmb3Igc2Nyb2xsaW5nXG4gICAgY2hpbGQubGF5b3V0KGNvbnRlbnRXaWR0aCwgY29udGVudEhlaWdodCk7XG5cbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRCb3VuZHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGEgY2hpbGQgZnJvbSB0aGUgc2Nyb2xsYWJsZSBjb250ZW50XG4gICAqL1xuICByZW1vdmVDaGlsZChjaGlsZDogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICBjaGlsZC5wYXJlbnQgPSB1bmRlZmluZWQ7XG5cbiAgICAvLyBSZW1vdmUgZnJvbSBjaGlsZHJlbiB0cmFja2luZ1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jaGlsZHJlbi5pbmRleE9mKGNoaWxkKTtcbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuXG4gICAgdGhpcy5jb250ZW50Q29udGFpbmVyLnJlbW92ZUNoaWxkKGNoaWxkLmNvbnRhaW5lcik7XG4gICAgdGhpcy51cGRhdGVDb250ZW50Qm91bmRzKCk7XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xscyB0byBhIHNwZWNpZmljIFkgcG9zaXRpb25cbiAgICovXG4gIHNjcm9sbFRvKHk6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuc2Nyb2xsWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMubWF4U2Nyb2xsWSwgeSkpO1xuICAgIHRoaXMudXBkYXRlQ29udGVudFBvc2l0aW9uKCk7XG4gICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRvIHRoZSB0b3BcbiAgICovXG4gIHNjcm9sbFRvVG9wKCk6IHZvaWQge1xuICAgIHRoaXMuc2Nyb2xsVG8oMCk7XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xscyB0byB0aGUgYm90dG9tXG4gICAqL1xuICBzY3JvbGxUb0JvdHRvbSgpOiB2b2lkIHtcbiAgICB0aGlzLnNjcm9sbFRvKHRoaXMubWF4U2Nyb2xsWSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCBzY3JvbGwgcG9zaXRpb25cbiAgICovXG4gIGdldFNjcm9sbFkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5zY3JvbGxZO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIG1heGltdW0gc2Nyb2xsIHBvc2l0aW9uXG4gICAqL1xuICBnZXRNYXhTY3JvbGxZKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMubWF4U2Nyb2xsWTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRvIG1ha2UgYSBjaGlsZCBjb21wb25lbnQgdmlzaWJsZVxuICAgKi9cbiAgc2Nyb2xsVG9Db21wb25lbnQoY29tcG9uZW50OiBVSUNvbXBvbmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGNvbXBvbmVudEJvdW5kcyA9IGNvbXBvbmVudC5nZXRHbG9iYWxCb3VuZHMoKTtcbiAgICBjb25zdCBjb250YWluZXJCb3VuZHMgPSB0aGlzLmdldEdsb2JhbEJvdW5kcygpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGNvbXBvbmVudCBwb3NpdGlvbiByZWxhdGl2ZSB0byBzY3JvbGwgY29udGFpbmVyJ3MgY29udGVudCBhcmVhXG4gICAgY29uc3QgcmVsYXRpdmVZID0gY29tcG9uZW50Qm91bmRzLnkgLSBjb250YWluZXJCb3VuZHMueSAtIHRoaXMucHJvcHMucGFkZGluZy50b3AgKyB0aGlzLnNjcm9sbFk7XG4gICAgY29uc3Qgdmlld3BvcnRIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodCAtIHRoaXMucHJvcHMucGFkZGluZy50b3AgLSB0aGlzLnByb3BzLnBhZGRpbmcuYm90dG9tO1xuXG4gICAgLy8gQ2hlY2sgaWYgY29tcG9uZW50IGlzIGFib3ZlIHZpZXdwb3J0XG4gICAgaWYgKHJlbGF0aXZlWSA8IHRoaXMuc2Nyb2xsWSkge1xuICAgICAgLy8gU2Nyb2xsIHVwIHRvIHNob3cgY29tcG9uZW50IGF0IHRvcFxuICAgICAgdGhpcy5zY3JvbGxUbyhyZWxhdGl2ZVkpO1xuICAgIH1cbiAgICAvLyBDaGVjayBpZiBjb21wb25lbnQgaXMgYmVsb3cgdmlld3BvcnRcbiAgICBlbHNlIGlmIChyZWxhdGl2ZVkgKyBjb21wb25lbnRCb3VuZHMuaGVpZ2h0ID4gdGhpcy5zY3JvbGxZICsgdmlld3BvcnRIZWlnaHQpIHtcbiAgICAgIC8vIFNjcm9sbCBkb3duIHRvIHNob3cgY29tcG9uZW50IGF0IGJvdHRvbVxuICAgICAgY29uc3QgdGFyZ2V0U2Nyb2xsID0gcmVsYXRpdmVZICsgY29tcG9uZW50Qm91bmRzLmhlaWdodCAtIHZpZXdwb3J0SGVpZ2h0O1xuICAgICAgdGhpcy5zY3JvbGxUbyh0YXJnZXRTY3JvbGwpO1xuICAgIH1cbiAgICAvLyBDb21wb25lbnQgaXMgYWxyZWFkeSB2aXNpYmxlLCBubyBuZWVkIHRvIHNjcm9sbFxuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmVzIHRoZSBzaXplIG5lZWRlZCBmb3IgdGhpcyBjb250YWluZXJcbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBsYXlvdXQgZm9yIHRoaXMgY29udGFpbmVyXG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuXG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgdGhpcy51cGRhdGVDb250ZW50Qm91bmRzKCk7XG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgY29udGFpbmVyXG4gICAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIC8vIFJlbmRlcmluZyBoYW5kbGVkIGJ5IGJhY2tncm91bmQsIGNvbnRlbnQsIG1hc2ssIGFuZCBzY3JvbGxiYXJcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIHdoZW4gZGVzdHJveWluZ1xuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGlmICh0aGlzLmJvdW5kR2xvYmFsUG9pbnRlck1vdmUpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJtb3ZlJywgdGhpcy5ib3VuZEdsb2JhbFBvaW50ZXJNb3ZlKTtcbiAgICAgICAgdGhpcy5ib3VuZEdsb2JhbFBvaW50ZXJNb3ZlID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmJvdW5kR2xvYmFsUG9pbnRlclVwKSB7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCB0aGlzLmJvdW5kR2xvYmFsUG9pbnRlclVwKTtcbiAgICAgICAgdGhpcy5ib3VuZEdsb2JhbFBvaW50ZXJVcCA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICAgIHN1cGVyLmRlc3Ryb3koKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5pbXBvcnQgeyBVSVBhbmVsIH0gZnJvbSAnLi91aS1wYW5lbCc7XG5pbXBvcnQgeyBVSUxhYmVsIH0gZnJvbSAnLi91aS1sYWJlbCc7XG5pbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi4vY29yZS9lZGdlLWluc2V0cyc7XG5cbi8qKlxuICogT3B0aW9uIHN0cnVjdHVyZSBmb3IgU2VsZWN0IGNvbXBvbmVudFxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdE9wdGlvbiB7XG4gIC8qKiBEaXNwbGF5IHRleHQgZm9yIHRoZSBvcHRpb24gKi9cbiAgbGFiZWw6IHN0cmluZztcbiAgLyoqIFRoZSBhY3R1YWwgdmFsdWUgKi9cbiAgdmFsdWU6IGFueTtcbiAgLyoqIFdoZXRoZXIgdGhpcyBvcHRpb24gaXMgZGlzYWJsZWQgKi9cbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJU2VsZWN0XG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlTZWxlY3RQcm9wcyB7XG4gIC8qKiBBcnJheSBvZiBvcHRpb25zICovXG4gIG9wdGlvbnM6IFNlbGVjdE9wdGlvbltdO1xuICAvKiogQ3VycmVudCBzZWxlY3RlZCB2YWx1ZSAoY29udHJvbGxlZCkgKi9cbiAgdmFsdWU/OiBhbnk7XG4gIC8qKiBEZWZhdWx0IHNlbGVjdGVkIHZhbHVlICh1bmNvbnRyb2xsZWQpICovXG4gIGRlZmF1bHRWYWx1ZT86IGFueTtcbiAgLyoqIENoYW5nZSBjYWxsYmFjayAqL1xuICBvbkNoYW5nZT86ICh2YWx1ZTogYW55KSA9PiB2b2lkO1xuICAvKiogV2lkdGggb2YgdGhlIHNlbGVjdCAqL1xuICB3aWR0aD86IG51bWJlcjtcbiAgLyoqIEhlaWdodCBvZiB0aGUgc2VsZWN0ICovXG4gIGhlaWdodD86IG51bWJlcjtcbiAgLyoqIFBsYWNlaG9sZGVyIHRleHQgd2hlbiBub3RoaW5nIHNlbGVjdGVkICovXG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xuICAvKiogV2hldGhlciB0aGUgc2VsZWN0IGlzIGRpc2FibGVkICovXG4gIGRpc2FibGVkPzogYm9vbGVhbjtcbiAgLyoqIEJhY2tncm91bmQgY29sb3IgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogVGV4dCBjb2xvciAqL1xuICB0ZXh0Q29sb3I/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgcmFkaXVzICovXG4gIGJvcmRlclJhZGl1cz86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBIHNlbGVjdC9kcm9wZG93biBjb21wb25lbnQgd2l0aCBvcHRpb25zXG4gKiBGb2xsb3dzIEFudCBEZXNpZ24ncyBkYXRhLWRyaXZlbiBwYXR0ZXJuXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHNlbGVjdCA9IG5ldyBVSVNlbGVjdCh7XG4gKiAgIG9wdGlvbnM6IFtcbiAqICAgICB7IGxhYmVsOiAnT3B0aW9uIDEnLCB2YWx1ZTogMSB9LFxuICogICAgIHsgbGFiZWw6ICdPcHRpb24gMicsIHZhbHVlOiAyIH0sXG4gKiAgICAgeyBsYWJlbDogJ09wdGlvbiAzJywgdmFsdWU6IDMgfVxuICogICBdLFxuICogICBwbGFjZWhvbGRlcjogJ0Nob29zZSBhbiBvcHRpb24nLFxuICogICBvbkNoYW5nZTogKHZhbHVlKSA9PiBjb25zb2xlLmxvZygnU2VsZWN0ZWQ6JywgdmFsdWUpXG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlTZWxlY3QgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFJlcXVpcmVkPE9taXQ8VUlTZWxlY3RQcm9wcywgJ29uQ2hhbmdlJyB8ICd2YWx1ZScgfCAnZGVmYXVsdFZhbHVlJz4+O1xuICBwcml2YXRlIG9uQ2hhbmdlPzogKHZhbHVlOiBhbnkpID0+IHZvaWQ7XG5cbiAgcHJpdmF0ZSBzZWxlY3RlZFZhbHVlOiBhbnk7XG4gIHByaXZhdGUgYmFja2dyb3VuZDogVUlQYW5lbDtcbiAgcHJpdmF0ZSBsYWJlbDogVUlMYWJlbDtcbiAgcHJpdmF0ZSBkcm9wZG93bkNvbnRhaW5lcj86IFBJWEkuQ29udGFpbmVyO1xuICBwcml2YXRlIGRyb3Bkb3duUGFuZWw/OiBVSVBhbmVsO1xuICBwcml2YXRlIG9wdGlvbkxhYmVsczogVUlMYWJlbFtdID0gW107XG4gIHByaXZhdGUgaXNPcGVuOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBob3ZlckNvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgc2VsZWN0ZWRDb2xvcjogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSVNlbGVjdFByb3BzLCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIG9wdGlvbnM6IHByb3BzLm9wdGlvbnMgPz8gW10sXG4gICAgICBwbGFjZWhvbGRlcjogcHJvcHMucGxhY2Vob2xkZXIgPz8gJ1NlbGVjdC4uLicsXG4gICAgICB3aWR0aDogcHJvcHMud2lkdGggPz8gMjAwLFxuICAgICAgaGVpZ2h0OiBwcm9wcy5oZWlnaHQgPz8gMzYsXG4gICAgICBkaXNhYmxlZDogcHJvcHMuZGlzYWJsZWQgPz8gZmFsc2UsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHByb3BzLmJhY2tncm91bmRDb2xvciA/PyAweGZmZmZmZixcbiAgICAgIHRleHRDb2xvcjogcHJvcHMudGV4dENvbG9yID8/IDB4MDAwMDAwLFxuICAgICAgYm9yZGVyUmFkaXVzOiBwcm9wcy5ib3JkZXJSYWRpdXMgPz8gNFxuICAgIH07XG5cbiAgICB0aGlzLm9uQ2hhbmdlID0gcHJvcHMub25DaGFuZ2U7XG4gICAgdGhpcy5zZWxlY3RlZFZhbHVlID0gcHJvcHMudmFsdWUgPz8gcHJvcHMuZGVmYXVsdFZhbHVlO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGNvbG9yc1xuICAgIHRoaXMuaG92ZXJDb2xvciA9IHRoaXMuZGFya2VuQ29sb3IodGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsIDAuOTUpO1xuICAgIHRoaXMuc2VsZWN0ZWRDb2xvciA9IHRoaXMuZGFya2VuQ29sb3IodGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsIDAuOSk7XG5cbiAgICAvLyBTZXQgYm94IG1vZGVsIGRpbWVuc2lvbnNcbiAgICB0aGlzLmJveE1vZGVsLndpZHRoID0gdGhpcy5wcm9wcy53aWR0aDtcbiAgICB0aGlzLmJveE1vZGVsLmhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuXG4gICAgLy8gQ3JlYXRlIGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuYmFja2dyb3VuZC5jb250YWluZXIpO1xuXG4gICAgLy8gQ3JlYXRlIGxhYmVsIGZvciBzZWxlY3RlZCB2YWx1ZVxuICAgIGNvbnN0IGRpc3BsYXlUZXh0ID0gdGhpcy5nZXREaXNwbGF5VGV4dCgpO1xuICAgIHRoaXMubGFiZWwgPSBuZXcgVUlMYWJlbCh7XG4gICAgICB0ZXh0OiBkaXNwbGF5VGV4dCxcbiAgICAgIGZvbnRTaXplOiAxNCxcbiAgICAgIGNvbG9yOiB0aGlzLnNlbGVjdGVkVmFsdWUgPyB0aGlzLnByb3BzLnRleHRDb2xvciA6IDB4OTk5OTk5LFxuICAgICAgYWxpZ246ICdsZWZ0J1xuICAgIH0sIHtcbiAgICAgIHBhZGRpbmc6IEVkZ2VJbnNldHMuc3ltbWV0cmljKDgsIDEyKVxuICAgIH0pO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMubGFiZWwuY29udGFpbmVyKTtcblxuICAgIC8vIFNldHVwIGludGVyYWN0aXZpdHlcbiAgICB0aGlzLnNldHVwSW50ZXJhY3Rpdml0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGRpc3BsYXkgdGV4dCBiYXNlZCBvbiBzZWxlY3RlZCB2YWx1ZVxuICAgKi9cbiAgcHJpdmF0ZSBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xuICAgIGlmICghdGhpcy5zZWxlY3RlZFZhbHVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5wcm9wcy5wbGFjZWhvbGRlcjtcbiAgICB9XG5cbiAgICBjb25zdCBvcHRpb24gPSB0aGlzLnByb3BzLm9wdGlvbnMuZmluZChvcHQgPT4gb3B0LnZhbHVlID09PSB0aGlzLnNlbGVjdGVkVmFsdWUpO1xuICAgIHJldHVybiBvcHRpb24gPyBvcHRpb24ubGFiZWwgOiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgbW91c2UvdG91Y2ggZXZlbnQgaGFuZGxlcnNcbiAgICovXG4gIHByaXZhdGUgc2V0dXBJbnRlcmFjdGl2aXR5KCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgIHRoaXMuY29udGFpbmVyLmN1cnNvciA9ICdwb2ludGVyJztcblxuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVyZG93bicsIHRoaXMuaGFuZGxlUG9pbnRlckRvd24uYmluZCh0aGlzKSk7XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJEb3duKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLmRpc2FibGVkKSByZXR1cm47XG5cbiAgICBpZiAodGhpcy5pc09wZW4pIHtcbiAgICAgIHRoaXMuY2xvc2VEcm9wZG93bigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9wZW5Ecm9wZG93bigpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBPcGVucyB0aGUgZHJvcGRvd24gbWVudVxuICAgKi9cbiAgcHJpdmF0ZSBvcGVuRHJvcGRvd24oKTogdm9pZCB7XG4gICAgdGhpcy5pc09wZW4gPSB0cnVlO1xuXG4gICAgLy8gQ3JlYXRlIGRyb3Bkb3duIGNvbnRhaW5lclxuICAgIHRoaXMuZHJvcGRvd25Db250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICB0aGlzLmRyb3Bkb3duQ29udGFpbmVyLnBvc2l0aW9uLnNldCgwLCB0aGlzLnByb3BzLmhlaWdodCArIDQpO1xuXG4gICAgLy8gQ3JlYXRlIGRyb3Bkb3duIHBhbmVsXG4gICAgY29uc3QgZHJvcGRvd25IZWlnaHQgPSBNYXRoLm1pbih0aGlzLnByb3BzLm9wdGlvbnMubGVuZ3RoICogMzIsIDIwMCk7XG4gICAgdGhpcy5kcm9wZG93blBhbmVsID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiBkcm9wZG93bkhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgICB0aGlzLmRyb3Bkb3duQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuZHJvcGRvd25QYW5lbC5jb250YWluZXIpO1xuXG4gICAgLy8gQ3JlYXRlIG9wdGlvbiBsYWJlbHNcbiAgICB0aGlzLm9wdGlvbkxhYmVscyA9IFtdO1xuICAgIHRoaXMucHJvcHMub3B0aW9ucy5mb3JFYWNoKChvcHRpb24sIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBvcHRpb25Db250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICAgIG9wdGlvbkNvbnRhaW5lci5wb3NpdGlvbi5zZXQoMCwgaW5kZXggKiAzMik7XG5cbiAgICAgIC8vIE9wdGlvbiBiYWNrZ3JvdW5kXG4gICAgICBjb25zdCBvcHRpb25CZyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgICBvcHRpb25CZy5yZWN0KDAsIDAsIHRoaXMucHJvcHMud2lkdGgsIDMyKTtcbiAgICAgIG9wdGlvbkJnLmZpbGwoeyBjb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsIGFscGhhOiAwIH0pO1xuICAgICAgb3B0aW9uQ29udGFpbmVyLmFkZENoaWxkKG9wdGlvbkJnKTtcblxuICAgICAgLy8gT3B0aW9uIGxhYmVsXG4gICAgICBjb25zdCBvcHRpb25MYWJlbCA9IG5ldyBVSUxhYmVsKHtcbiAgICAgICAgdGV4dDogb3B0aW9uLmxhYmVsLFxuICAgICAgICBmb250U2l6ZTogMTQsXG4gICAgICAgIGNvbG9yOiBvcHRpb24uZGlzYWJsZWQgPyAweDk5OTk5OSA6IHRoaXMucHJvcHMudGV4dENvbG9yLFxuICAgICAgICBhbGlnbjogJ2xlZnQnXG4gICAgICB9LCB7XG4gICAgICAgIHBhZGRpbmc6IEVkZ2VJbnNldHMuc3ltbWV0cmljKDgsIDEyKVxuICAgICAgfSk7XG4gICAgICBvcHRpb25MYWJlbC5sYXlvdXQodGhpcy5wcm9wcy53aWR0aCwgMzIpO1xuICAgICAgb3B0aW9uQ29udGFpbmVyLmFkZENoaWxkKG9wdGlvbkxhYmVsLmNvbnRhaW5lcik7XG5cbiAgICAgIGlmICghb3B0aW9uLmRpc2FibGVkKSB7XG4gICAgICAgIG9wdGlvbkNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICAgICAgb3B0aW9uQ29udGFpbmVyLmN1cnNvciA9ICdwb2ludGVyJztcblxuICAgICAgICAvLyBIb3ZlciBlZmZlY3RcbiAgICAgICAgb3B0aW9uQ29udGFpbmVyLm9uKCdwb2ludGVyb3ZlcicsICgpID0+IHtcbiAgICAgICAgICBvcHRpb25CZy5jbGVhcigpO1xuICAgICAgICAgIG9wdGlvbkJnLnJlY3QoMCwgMCwgdGhpcy5wcm9wcy53aWR0aCwgMzIpO1xuICAgICAgICAgIG9wdGlvbkJnLmZpbGwoeyBjb2xvcjogdGhpcy5ob3ZlckNvbG9yIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBvcHRpb25Db250YWluZXIub24oJ3BvaW50ZXJvdXQnLCAoKSA9PiB7XG4gICAgICAgICAgb3B0aW9uQmcuY2xlYXIoKTtcbiAgICAgICAgICBvcHRpb25CZy5yZWN0KDAsIDAsIHRoaXMucHJvcHMud2lkdGgsIDMyKTtcbiAgICAgICAgICBvcHRpb25CZy5maWxsKHsgY29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLCBhbHBoYTogMCB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2xpY2sgaGFuZGxlclxuICAgICAgICBvcHRpb25Db250YWluZXIub24oJ3BvaW50ZXJkb3duJywgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuc2VsZWN0T3B0aW9uKG9wdGlvbi52YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmRyb3Bkb3duQ29udGFpbmVyIS5hZGRDaGlsZChvcHRpb25Db250YWluZXIpO1xuICAgICAgdGhpcy5vcHRpb25MYWJlbHMucHVzaChvcHRpb25MYWJlbCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmRyb3Bkb3duQ29udGFpbmVyKTtcblxuICAgIC8vIEFkZCBjbGljayBvdXRzaWRlIGxpc3RlbmVyXG4gICAgdGhpcy5zZXR1cENsaWNrT3V0c2lkZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIENsb3NlcyB0aGUgZHJvcGRvd24gbWVudVxuICAgKi9cbiAgcHJpdmF0ZSBjbG9zZURyb3Bkb3duKCk6IHZvaWQge1xuICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7XG5cbiAgICBpZiAodGhpcy5kcm9wZG93bkNvbnRhaW5lcikge1xuICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5kcm9wZG93bkNvbnRhaW5lcik7XG4gICAgICB0aGlzLmRyb3Bkb3duQ29udGFpbmVyID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5kcm9wZG93blBhbmVsID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5vcHRpb25MYWJlbHMgPSBbXTtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgY2xpY2sgb3V0c2lkZSBsaXN0ZW5lclxuICAgIHRoaXMucmVtb3ZlQ2xpY2tPdXRzaWRlKCk7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0cyBhbiBvcHRpb25cbiAgICovXG4gIHByaXZhdGUgc2VsZWN0T3B0aW9uKHZhbHVlOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLnNlbGVjdGVkVmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLmxhYmVsLnNldFRleHQodGhpcy5nZXREaXNwbGF5VGV4dCgpKTtcbiAgICB0aGlzLmxhYmVsLnNldENvbG9yKHRoaXMucHJvcHMudGV4dENvbG9yKTtcblxuICAgIHRoaXMub25DaGFuZ2U/Lih2YWx1ZSk7XG4gICAgdGhpcy5jbG9zZURyb3Bkb3duKCk7XG4gIH1cblxuICAvKipcbiAgICogU2V0dXAgY2xpY2sgb3V0c2lkZSBkZXRlY3Rpb25cbiAgICovXG4gIHByaXZhdGUgc2V0dXBDbGlja091dHNpZGUoKTogdm9pZCB7XG4gICAgLy8gU2ltcGxlIGFwcHJvYWNoOiBjbG9zZSBvbiBhbnkgb3V0c2lkZSBjbGlja1xuICAgIGNvbnN0IHN0YWdlID0gdGhpcy5jb250YWluZXIucGFyZW50O1xuICAgIGlmIChzdGFnZSkge1xuICAgICAgc3RhZ2UuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgICBzdGFnZS5vbmNlKCdwb2ludGVyZG93bicsIChlKSA9PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIGNsaWNrIGlzIG91dHNpZGVcbiAgICAgICAgY29uc3QgcG9pbnQgPSBlLmdsb2JhbDtcbiAgICAgICAgY29uc3QgYm91bmRzID0gdGhpcy5jb250YWluZXIuZ2V0Qm91bmRzKCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgcG9pbnQgaXMgd2l0aGluIGJvdW5kcyBtYW51YWxseVxuICAgICAgICBpZiAocG9pbnQueCA8IGJvdW5kcy54IHx8IHBvaW50LnggPiBib3VuZHMueCArIGJvdW5kcy53aWR0aCB8fFxuICAgICAgICAgICAgcG9pbnQueSA8IGJvdW5kcy55IHx8IHBvaW50LnkgPiBib3VuZHMueSArIGJvdW5kcy5oZWlnaHQpIHtcbiAgICAgICAgICB0aGlzLmNsb3NlRHJvcGRvd24oKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBjbGljayBvdXRzaWRlIGRldGVjdGlvblxuICAgKi9cbiAgcHJpdmF0ZSByZW1vdmVDbGlja091dHNpZGUoKTogdm9pZCB7XG4gICAgLy8gSGFuZGxlZCBieSAnb25jZScgaW4gc2V0dXBDbGlja091dHNpZGVcbiAgfVxuXG4gIC8qKlxuICAgKiBEYXJrZW5zIGEgY29sb3IgYnkgYSBmYWN0b3JcbiAgICovXG4gIHByaXZhdGUgZGFya2VuQ29sb3IoY29sb3I6IG51bWJlciwgZmFjdG9yOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IHIgPSAoKGNvbG9yID4+IDE2KSAmIDB4ZmYpICogZmFjdG9yO1xuICAgIGNvbnN0IGcgPSAoKGNvbG9yID4+IDgpICYgMHhmZikgKiBmYWN0b3I7XG4gICAgY29uc3QgYiA9IChjb2xvciAmIDB4ZmYpICogZmFjdG9yO1xuICAgIHJldHVybiAoKHIgPDwgMTYpIHwgKGcgPDwgOCkgfCBiKSA+Pj4gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgc2VsZWN0XG4gICAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIHNlbGVjdFxuICAgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcblxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcblxuICAgIC8vIExheW91dCBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kLmxheW91dChtZWFzdXJlZC53aWR0aCwgbWVhc3VyZWQuaGVpZ2h0KTtcblxuICAgIC8vIExheW91dCBsYWJlbFxuICAgIHRoaXMubGFiZWwubGF5b3V0KG1lYXN1cmVkLndpZHRoLCBtZWFzdXJlZC5oZWlnaHQpO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgc2VsZWN0XG4gICAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIC8vIFJlbmRlcmluZyBoYW5kbGVkIGJ5IGJhY2tncm91bmQgYW5kIGxhYmVsXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgc2VsZWN0ZWQgdmFsdWUgcHJvZ3JhbW1hdGljYWxseVxuICAgKi9cbiAgc2V0VmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xuICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMubGFiZWwuc2V0VGV4dCh0aGlzLmdldERpc3BsYXlUZXh0KCkpO1xuICAgIHRoaXMubGFiZWwuc2V0Q29sb3IodGhpcy5wcm9wcy50ZXh0Q29sb3IpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgc2VsZWN0ZWQgdmFsdWVcbiAgICovXG4gIGdldFZhbHVlKCk6IGFueSB7XG4gICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRWYWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBvcHRpb25zXG4gICAqL1xuICBzZXRPcHRpb25zKG9wdGlvbnM6IFNlbGVjdE9wdGlvbltdKTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICBpZiAodGhpcy5pc09wZW4pIHtcbiAgICAgIHRoaXMuY2xvc2VEcm9wZG93bigpO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcbmltcG9ydCB7IFVJTGFiZWwgfSBmcm9tICcuL3VpLWxhYmVsJztcbmltcG9ydCB7IFVJUGFuZWwgfSBmcm9tICcuL3VpLXBhbmVsJztcblxuZXhwb3J0IGludGVyZmFjZSBUYWJJdGVtIHtcbiAga2V5OiBzdHJpbmc7XG4gIGxhYmVsOiBzdHJpbmc7XG4gIGNvbnRlbnQ6IFVJQ29tcG9uZW50O1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVUlUYWJzUHJvcHMge1xuICBpdGVtczogVGFiSXRlbVtdO1xuICBhY3RpdmVLZXk/OiBzdHJpbmc7XG4gIGRlZmF1bHRBY3RpdmVLZXk/OiBzdHJpbmc7XG4gIG9uQ2hhbmdlPzogKGFjdGl2ZUtleTogc3RyaW5nKSA9PiB2b2lkO1xuICB0eXBlPzogJ2xpbmUnIHwgJ2NhcmQnO1xuICB0YWJQb3NpdGlvbj86ICd0b3AnIHwgJ2JvdHRvbSc7XG4gIHdpZHRoPzogbnVtYmVyO1xuICBoZWlnaHQ/OiBudW1iZXI7XG4gIHRhYkJhckJhY2tncm91bmRDb2xvcj86IG51bWJlcjtcbiAgdGFiQmFySGVpZ2h0PzogbnVtYmVyO1xuICBhY3RpdmVUYWJDb2xvcj86IG51bWJlcjtcbiAgaW5hY3RpdmVUYWJDb2xvcj86IG51bWJlcjtcbiAgdGV4dENvbG9yPzogbnVtYmVyO1xuICBhY3RpdmVUZXh0Q29sb3I/OiBudW1iZXI7XG4gIGhhc2hQcmVmaXg/OiBzdHJpbmc7IC8vIGUuZy4sIFwidWktc2hvd2Nhc2VcIiBjcmVhdGVzIFVSTHMgbGlrZSAjdWktc2hvd2Nhc2UvYmFzaWNzXG59XG5cbmV4cG9ydCBjbGFzcyBVSVRhYnMgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgaXRlbXM6IFRhYkl0ZW1bXTtcbiAgcHJpdmF0ZSBhY3RpdmVLZXk6IHN0cmluZztcbiAgcHJpdmF0ZSBvbkNoYW5nZT86IChhY3RpdmVLZXk6IHN0cmluZykgPT4gdm9pZDtcbiAgcHJpdmF0ZSB0eXBlOiAnbGluZScgfCAnY2FyZCc7XG4gIHByaXZhdGUgdGFiUG9zaXRpb246ICd0b3AnIHwgJ2JvdHRvbSc7XG4gIHByaXZhdGUgd2lkdGg6IG51bWJlcjtcbiAgcHJpdmF0ZSBoZWlnaHQ6IG51bWJlcjtcbiAgcHJpdmF0ZSB0YWJCYXJCYWNrZ3JvdW5kQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSB0YWJCYXJIZWlnaHQ6IG51bWJlcjtcbiAgcHJpdmF0ZSBhY3RpdmVUYWJDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIGluYWN0aXZlVGFiQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSB0ZXh0Q29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBhY3RpdmVUZXh0Q29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBoYXNoUHJlZml4Pzogc3RyaW5nO1xuXG4gIHByaXZhdGUgdGFiQmFyOiBQSVhJLkNvbnRhaW5lcjtcbiAgcHJpdmF0ZSBjb250ZW50QXJlYTogUElYSS5Db250YWluZXI7XG4gIHByaXZhdGUgdGFiQnV0dG9uczogTWFwPHN0cmluZywgeyBjb250YWluZXI6IFBJWEkuQ29udGFpbmVyOyBsYWJlbDogVUlMYWJlbDsgYmc6IFBJWEkuR3JhcGhpY3MgfT4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgYWN0aXZlSW5kaWNhdG9yPzogUElYSS5HcmFwaGljcztcbiAgcHJpdmF0ZSBoYXNoQ2hhbmdlSGFuZGxlcj86ICgpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJVGFic1Byb3BzLCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5pdGVtcyA9IHByb3BzLml0ZW1zIHx8IFtdO1xuICAgIHRoaXMub25DaGFuZ2UgPSBwcm9wcy5vbkNoYW5nZTtcbiAgICB0aGlzLnR5cGUgPSBwcm9wcy50eXBlIHx8ICdsaW5lJztcbiAgICB0aGlzLnRhYlBvc2l0aW9uID0gcHJvcHMudGFiUG9zaXRpb24gfHwgJ3RvcCc7XG4gICAgdGhpcy50YWJCYXJCYWNrZ3JvdW5kQ29sb3IgPSBwcm9wcy50YWJCYXJCYWNrZ3JvdW5kQ29sb3IgPz8gMHgyZDJkNDQ7XG4gICAgdGhpcy50YWJCYXJIZWlnaHQgPSBwcm9wcy50YWJCYXJIZWlnaHQgPz8gNDg7XG4gICAgdGhpcy5hY3RpdmVUYWJDb2xvciA9IHByb3BzLmFjdGl2ZVRhYkNvbG9yID8/IDB4MTg5MGZmO1xuICAgIHRoaXMuaW5hY3RpdmVUYWJDb2xvciA9IHByb3BzLmluYWN0aXZlVGFiQ29sb3IgPz8gMHgzZDNkNTQ7XG4gICAgdGhpcy50ZXh0Q29sb3IgPSBwcm9wcy50ZXh0Q29sb3IgPz8gMHhhYWFhYWE7XG4gICAgdGhpcy5hY3RpdmVUZXh0Q29sb3IgPSBwcm9wcy5hY3RpdmVUZXh0Q29sb3IgPz8gMHhmZmZmZmY7XG4gICAgdGhpcy5oYXNoUHJlZml4ID0gcHJvcHMuaGFzaFByZWZpeDtcblxuICAgIC8vIERldGVybWluZSBhY3RpdmUga2V5IC0gY2hlY2sgVVJMIGhhc2ggZmlyc3QgaWYgaGFzaFByZWZpeCBpcyBwcm92aWRlZFxuICAgIGxldCBpbml0aWFsS2V5ID0gcHJvcHMuYWN0aXZlS2V5IHx8IHByb3BzLmRlZmF1bHRBY3RpdmVLZXkgfHwgKHRoaXMuaXRlbXMubGVuZ3RoID4gMCA/IHRoaXMuaXRlbXNbMF0ua2V5IDogJycpO1xuICAgIGlmICh0aGlzLmhhc2hQcmVmaXggJiYgIXByb3BzLmFjdGl2ZUtleSkge1xuICAgICAgY29uc3QgaGFzaEtleSA9IHRoaXMuZ2V0S2V5RnJvbUhhc2goKTtcbiAgICAgIGlmIChoYXNoS2V5ICYmIHRoaXMuaXRlbXMuZmluZChpdGVtID0+IGl0ZW0ua2V5ID09PSBoYXNoS2V5KSkge1xuICAgICAgICBpbml0aWFsS2V5ID0gaGFzaEtleTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5hY3RpdmVLZXkgPSBpbml0aWFsS2V5O1xuXG4gICAgdGhpcy53aWR0aCA9IHByb3BzLndpZHRoID8/IDgwMDtcbiAgICB0aGlzLmhlaWdodCA9IHByb3BzLmhlaWdodCA/PyA2MDA7XG5cbiAgICB0aGlzLnRhYkJhciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgIHRoaXMuY29udGVudEFyZWEgPSBuZXcgUElYSS5Db250YWluZXIoKTtcblxuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMudGFiQmFyKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmNvbnRlbnRBcmVhKTtcblxuICAgIHRoaXMuYnVpbGRUYWJzKCk7XG4gICAgdGhpcy5zaG93QWN0aXZlVGFiKCk7XG5cbiAgICAvLyBTZXQgdXAgaGFzaCBjaGFuZ2UgbGlzdGVuZXIgaWYgaGFzaFByZWZpeCBpcyBwcm92aWRlZFxuICAgIGlmICh0aGlzLmhhc2hQcmVmaXgpIHtcbiAgICAgIHRoaXMuc2V0dXBIYXNoTGlzdGVuZXIoKTtcbiAgICAgIC8vIFVwZGF0ZSBoYXNoIHRvIG1hdGNoIGluaXRpYWwgYWN0aXZlIGtleVxuICAgICAgdGhpcy51cGRhdGVIYXNoKHRoaXMuYWN0aXZlS2V5KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEtleUZyb21IYXNoKCk6IHN0cmluZyB8IG51bGwge1xuICAgIGlmICghdGhpcy5oYXNoUHJlZml4KSByZXR1cm4gbnVsbDtcbiAgICBjb25zdCBoYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2guc2xpY2UoMSk7IC8vIFJlbW92ZSAjXG4gICAgY29uc3QgcHJlZml4ID0gYCR7dGhpcy5oYXNoUHJlZml4fS9gO1xuICAgIGlmIChoYXNoLnN0YXJ0c1dpdGgocHJlZml4KSkge1xuICAgICAgcmV0dXJuIGhhc2guc2xpY2UocHJlZml4Lmxlbmd0aCk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVIYXNoKGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmhhc2hQcmVmaXgpIHJldHVybjtcbiAgICBjb25zdCBuZXdIYXNoID0gYCMke3RoaXMuaGFzaFByZWZpeH0vJHtrZXl9YDtcbiAgICBpZiAod2luZG93LmxvY2F0aW9uLmhhc2ggIT09IG5ld0hhc2gpIHtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gbmV3SGFzaDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNldHVwSGFzaExpc3RlbmVyKCk6IHZvaWQge1xuICAgIHRoaXMuaGFzaENoYW5nZUhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICBjb25zdCBoYXNoS2V5ID0gdGhpcy5nZXRLZXlGcm9tSGFzaCgpO1xuICAgICAgaWYgKGhhc2hLZXkgJiYgaGFzaEtleSAhPT0gdGhpcy5hY3RpdmVLZXkpIHtcbiAgICAgICAgdGhpcy5zZXRBY3RpdmVLZXkoaGFzaEtleSwgZmFsc2UpOyAvLyBmYWxzZSA9IGRvbid0IHVwZGF0ZSBoYXNoIChhbHJlYWR5IGNoYW5nZWQpXG4gICAgICB9XG4gICAgfTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIHRoaXMuaGFzaENoYW5nZUhhbmRsZXIpO1xuICB9XG5cbiAgcHVibGljIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaGFzaENoYW5nZUhhbmRsZXIpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgdGhpcy5oYXNoQ2hhbmdlSGFuZGxlcik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBidWlsZFRhYnMoKTogdm9pZCB7XG4gICAgLy8gQ2xlYXIgZXhpc3RpbmcgdGFic1xuICAgIHRoaXMudGFiQmFyLnJlbW92ZUNoaWxkcmVuKCk7XG4gICAgdGhpcy50YWJCdXR0b25zLmNsZWFyKCk7XG5cbiAgICAvLyBDcmVhdGUgdGFiIGJhciBiYWNrZ3JvdW5kXG4gICAgY29uc3QgdGFiQmFyQmcgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRhYkJhckJnLnJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy50YWJCYXJIZWlnaHQpO1xuICAgIHRhYkJhckJnLmZpbGwoeyBjb2xvcjogdGhpcy50YWJCYXJCYWNrZ3JvdW5kQ29sb3IgfSk7XG4gICAgdGhpcy50YWJCYXIuYWRkQ2hpbGQodGFiQmFyQmcpO1xuXG4gICAgLy8gQWRkIGJvdHRvbSBib3JkZXIgbGluZSBmb3IgbGluZSB0eXBlXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ2xpbmUnKSB7XG4gICAgICBjb25zdCBib3JkZXJMaW5lID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICAgIGJvcmRlckxpbmUucmVjdCgwLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIHRoaXMud2lkdGgsIDIpO1xuICAgICAgYm9yZGVyTGluZS5maWxsKHsgY29sb3I6IDB4M2QzZDU0LCBhbHBoYTogMC41IH0pO1xuICAgICAgdGhpcy50YWJCYXIuYWRkQ2hpbGQoYm9yZGVyTGluZSk7XG4gICAgfVxuXG4gICAgLy8gUG9zaXRpb24gdGFiIGJhclxuICAgIGlmICh0aGlzLnRhYlBvc2l0aW9uID09PSAnYm90dG9tJykge1xuICAgICAgdGhpcy50YWJCYXIueSA9IHRoaXMuaGVpZ2h0IC0gdGhpcy50YWJCYXJIZWlnaHQ7XG4gICAgICB0aGlzLmNvbnRlbnRBcmVhLnkgPSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRhYkJhci55ID0gMDtcbiAgICAgIHRoaXMuY29udGVudEFyZWEueSA9IHRoaXMudGFiQmFySGVpZ2h0O1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSB0YWJzXG4gICAgbGV0IHhPZmZzZXQgPSA4OyAvLyBTdGFydCB3aXRoIHNvbWUgbGVmdCBwYWRkaW5nXG4gICAgY29uc3QgdGFiUGFkZGluZyA9IDI0O1xuICAgIGNvbnN0IHRhYkdhcCA9IDg7XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5pdGVtcykge1xuICAgICAgaWYgKGl0ZW0uZGlzYWJsZWQpIGNvbnRpbnVlO1xuXG4gICAgICBjb25zdCB0YWJDb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICAgIHRhYkNvbnRhaW5lci54ID0geE9mZnNldDtcblxuICAgICAgLy8gVGFiIGxhYmVsXG4gICAgICBjb25zdCBpc0FjdGl2ZSA9IHRoaXMuYWN0aXZlS2V5ID09PSBpdGVtLmtleTtcbiAgICAgIGNvbnN0IGxhYmVsID0gbmV3IFVJTGFiZWwoe1xuICAgICAgICB0ZXh0OiBpdGVtLmxhYmVsLFxuICAgICAgICBmb250U2l6ZTogMTUsXG4gICAgICAgIGZvbnRXZWlnaHQ6IGlzQWN0aXZlID8gJ2JvbGQnIDogJ25vcm1hbCcsXG4gICAgICAgIGNvbG9yOiBpc0FjdGl2ZSA/IHRoaXMuYWN0aXZlVGV4dENvbG9yIDogdGhpcy50ZXh0Q29sb3JcbiAgICAgIH0pO1xuXG4gICAgICAvLyBNZWFzdXJlIGxhYmVsIHRvIGRldGVybWluZSB0YWIgd2lkdGhcbiAgICAgIGxhYmVsLm1lYXN1cmUoKTtcbiAgICAgIGxhYmVsLmxheW91dCh0aGlzLndpZHRoLCB0aGlzLnRhYkJhckhlaWdodCk7XG4gICAgICBjb25zdCBsYWJlbEJvdW5kcyA9IGxhYmVsLmNvbnRhaW5lci5nZXRMb2NhbEJvdW5kcygpO1xuICAgICAgY29uc3QgdGFiV2lkdGggPSBsYWJlbEJvdW5kcy53aWR0aCArICh0YWJQYWRkaW5nICogMik7XG5cbiAgICAgIC8vIFRhYiBiYWNrZ3JvdW5kXG4gICAgICBsZXQgYmc6IFBJWEkuR3JhcGhpY3M7XG4gICAgICBpZiAodGhpcy50eXBlID09PSAnY2FyZCcpIHtcbiAgICAgICAgYmcgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgICAgICBiZy5yb3VuZFJlY3QoMCwgMCwgdGFiV2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgNik7XG4gICAgICAgIGJnLmZpbGwoeyBjb2xvcjogaXNBY3RpdmUgPyB0aGlzLmFjdGl2ZVRhYkNvbG9yIDogdGhpcy5pbmFjdGl2ZVRhYkNvbG9yIH0pO1xuICAgICAgICAvLyBBZGQgYm9yZGVyIGZvciBjYXJkIHR5cGVcbiAgICAgICAgYmcucm91bmRSZWN0KDAsIDAsIHRhYldpZHRoLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIDYpO1xuICAgICAgICBiZy5zdHJva2UoeyBjb2xvcjogaXNBY3RpdmUgPyB0aGlzLmFjdGl2ZVRhYkNvbG9yIDogMHg0ZDRkNjQsIHdpZHRoOiAyIH0pO1xuICAgICAgICB0YWJDb250YWluZXIuYWRkQ2hpbGQoYmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRm9yIGxpbmUgdHlwZSwgTk8gYmFja2dyb3VuZCBvciBib3JkZXIgLSBqdXN0IHRyYW5zcGFyZW50IGhpdCBhcmVhXG4gICAgICAgIGJnID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICAgICAgYmcucmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQpO1xuICAgICAgICBiZy5maWxsKHsgY29sb3I6IDB4MDAwMDAwLCBhbHBoYTogMCB9KTtcbiAgICAgICAgdGFiQ29udGFpbmVyLmFkZENoaWxkKGJnKTtcbiAgICAgIH1cblxuICAgICAgLy8gUG9zaXRpb24gbGFiZWwgY2VudGVyZWQgaW4gdGFiXG4gICAgICBsYWJlbC5jb250YWluZXIueCA9IHRhYlBhZGRpbmc7XG4gICAgICBsYWJlbC5jb250YWluZXIueSA9ICh0aGlzLnRhYkJhckhlaWdodCAtIGxhYmVsQm91bmRzLmhlaWdodCkgLyAyO1xuICAgICAgdGFiQ29udGFpbmVyLmFkZENoaWxkKGxhYmVsLmNvbnRhaW5lcik7XG5cbiAgICAgIC8vIE1ha2UgdGFiIGludGVyYWN0aXZlXG4gICAgICB0YWJDb250YWluZXIuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgICB0YWJDb250YWluZXIuY3Vyc29yID0gJ3BvaW50ZXInO1xuXG4gICAgICBjb25zdCB0YWJLZXkgPSBpdGVtLmtleTtcbiAgICAgIHRhYkNvbnRhaW5lci5vbigncG9pbnRlcmRvd24nLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0QWN0aXZlS2V5KHRhYktleSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gSG92ZXIgZWZmZWN0XG4gICAgICB0YWJDb250YWluZXIub24oJ3BvaW50ZXJvdmVyJywgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5hY3RpdmVLZXkgIT09IHRhYktleSkge1xuICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdjYXJkJykge1xuICAgICAgICAgICAgYmcuY2xlYXIoKTtcbiAgICAgICAgICAgIGJnLnJvdW5kUmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgICAgIGJnLmZpbGwoeyBjb2xvcjogdGhpcy5hY3RpdmVUYWJDb2xvciwgYWxwaGE6IDAuNSB9KTtcbiAgICAgICAgICAgIGJnLnJvdW5kUmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgICAgIGJnLnN0cm9rZSh7IGNvbG9yOiB0aGlzLmFjdGl2ZVRhYkNvbG9yLCB3aWR0aDogMiB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRm9yIGxpbmUgdHlwZSwganVzdCBjaGFuZ2UgdGV4dCBjb2xvciBvbiBob3ZlclxuICAgICAgICAgICAgbGFiZWwuc2V0Q29sb3IodGhpcy5hY3RpdmVUZXh0Q29sb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHRhYkNvbnRhaW5lci5vbigncG9pbnRlcm91dCcsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlS2V5ICE9PSB0YWJLZXkpIHtcbiAgICAgICAgICBpZiAodGhpcy50eXBlID09PSAnY2FyZCcpIHtcbiAgICAgICAgICAgIGJnLmNsZWFyKCk7XG4gICAgICAgICAgICBiZy5yb3VuZFJlY3QoMCwgMCwgdGFiV2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgNik7XG4gICAgICAgICAgICBiZy5maWxsKHsgY29sb3I6IHRoaXMuaW5hY3RpdmVUYWJDb2xvciB9KTtcbiAgICAgICAgICAgIGJnLnJvdW5kUmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgICAgIGJnLnN0cm9rZSh7IGNvbG9yOiAweDRkNGQ2NCwgd2lkdGg6IDIgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFJlc3RvcmUgbXV0ZWQgdGV4dCBjb2xvclxuICAgICAgICAgICAgbGFiZWwuc2V0Q29sb3IodGhpcy50ZXh0Q29sb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMudGFiQmFyLmFkZENoaWxkKHRhYkNvbnRhaW5lcik7XG4gICAgICB0aGlzLnRhYkJ1dHRvbnMuc2V0KGl0ZW0ua2V5LCB7IGNvbnRhaW5lcjogdGFiQ29udGFpbmVyLCBsYWJlbCwgYmcgfSk7XG5cbiAgICAgIHhPZmZzZXQgKz0gdGFiV2lkdGggKyB0YWJHYXA7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGFjdGl2ZSBpbmRpY2F0b3IgZm9yIGxpbmUgdHlwZVxuICAgIGlmICh0aGlzLnR5cGUgPT09ICdsaW5lJykge1xuICAgICAgdGhpcy5hY3RpdmVJbmRpY2F0b3IgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgICAgdGhpcy50YWJCYXIuYWRkQ2hpbGQodGhpcy5hY3RpdmVJbmRpY2F0b3IpO1xuICAgICAgdGhpcy51cGRhdGVBY3RpdmVJbmRpY2F0b3IoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUFjdGl2ZUluZGljYXRvcigpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYWN0aXZlSW5kaWNhdG9yIHx8IHRoaXMudHlwZSAhPT0gJ2xpbmUnKSByZXR1cm47XG5cbiAgICB0aGlzLmFjdGl2ZUluZGljYXRvci5jbGVhcigpO1xuXG4gICAgY29uc3QgYWN0aXZlVGFiID0gdGhpcy50YWJCdXR0b25zLmdldCh0aGlzLmFjdGl2ZUtleSk7XG4gICAgaWYgKCFhY3RpdmVUYWIpIHJldHVybjtcblxuICAgIGNvbnN0IHRhYlggPSBhY3RpdmVUYWIuY29udGFpbmVyLng7XG4gICAgY29uc3QgdGFiQm91bmRzID0gYWN0aXZlVGFiLmJnLmdldExvY2FsQm91bmRzKCk7XG4gICAgY29uc3QgdGFiV2lkdGggPSB0YWJCb3VuZHMud2lkdGg7XG4gICAgY29uc3QgaW5kaWNhdG9ySGVpZ2h0ID0gMztcbiAgICBjb25zdCBpbmRpY2F0b3JZID0gdGhpcy50YWJCYXJIZWlnaHQgLSBpbmRpY2F0b3JIZWlnaHQ7XG5cbiAgICAvLyBEcmF3IGluZGljYXRvciBhdCB0aGUgdmVyeSBib3R0b20sIHNwYW5uaW5nIG1vc3Qgb2YgdGhlIHRhYiB3aWR0aFxuICAgIHRoaXMuYWN0aXZlSW5kaWNhdG9yLnJvdW5kUmVjdCh0YWJYICsgOCwgaW5kaWNhdG9yWSwgdGFiV2lkdGggLSAxNiwgaW5kaWNhdG9ySGVpZ2h0LCAxLjUpO1xuICAgIHRoaXMuYWN0aXZlSW5kaWNhdG9yLmZpbGwoeyBjb2xvcjogdGhpcy5hY3RpdmVUYWJDb2xvciB9KTtcbiAgfVxuXG4gIHByaXZhdGUgc2hvd0FjdGl2ZVRhYigpOiB2b2lkIHtcbiAgICAvLyBDbGVhciBjb250ZW50IGFyZWFcbiAgICB0aGlzLmNvbnRlbnRBcmVhLnJlbW92ZUNoaWxkcmVuKCk7XG5cbiAgICAvLyBGaW5kIGFjdGl2ZSBpdGVtXG4gICAgY29uc3QgYWN0aXZlSXRlbSA9IHRoaXMuaXRlbXMuZmluZChpdGVtID0+IGl0ZW0ua2V5ID09PSB0aGlzLmFjdGl2ZUtleSk7XG4gICAgaWYgKCFhY3RpdmVJdGVtKSByZXR1cm47XG5cbiAgICAvLyBBZGQgY29udGVudFxuICAgIGNvbnN0IGNvbnRlbnRIZWlnaHQgPSB0aGlzLmhlaWdodCAtIHRoaXMudGFiQmFySGVpZ2h0O1xuICAgIGFjdGl2ZUl0ZW0uY29udGVudC5sYXlvdXQodGhpcy53aWR0aCwgY29udGVudEhlaWdodCk7XG4gICAgdGhpcy5jb250ZW50QXJlYS5hZGRDaGlsZChhY3RpdmVJdGVtLmNvbnRlbnQuY29udGFpbmVyKTtcblxuICAgIC8vIFVwZGF0ZSB0YWIgc3R5bGVzXG4gICAgdGhpcy50YWJCdXR0b25zLmZvckVhY2goKHRhYiwga2V5KSA9PiB7XG4gICAgICBjb25zdCBpc0FjdGl2ZSA9IGtleSA9PT0gdGhpcy5hY3RpdmVLZXk7XG4gICAgICBjb25zdCB0YWJCb3VuZHMgPSB0YWIuYmcuZ2V0TG9jYWxCb3VuZHMoKTtcblxuICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2NhcmQnKSB7XG4gICAgICAgIHRhYi5iZy5jbGVhcigpO1xuICAgICAgICB0YWIuYmcucm91bmRSZWN0KDAsIDAsIHRhYkJvdW5kcy53aWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgdGFiLmJnLmZpbGwoeyBjb2xvcjogaXNBY3RpdmUgPyB0aGlzLmFjdGl2ZVRhYkNvbG9yIDogdGhpcy5pbmFjdGl2ZVRhYkNvbG9yIH0pO1xuICAgICAgICB0YWIuYmcucm91bmRSZWN0KDAsIDAsIHRhYkJvdW5kcy53aWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgdGFiLmJnLnN0cm9rZSh7IGNvbG9yOiBpc0FjdGl2ZSA/IHRoaXMuYWN0aXZlVGFiQ29sb3IgOiAweDRkNGQ2NCwgd2lkdGg6IDIgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGb3IgbGluZSB0eXBlLCBrZWVwIHRyYW5zcGFyZW50IGJhY2tncm91bmRcbiAgICAgICAgdGFiLmJnLmNsZWFyKCk7XG4gICAgICAgIHRhYi5iZy5yZWN0KDAsIDAsIHRhYkJvdW5kcy53aWR0aCwgdGhpcy50YWJCYXJIZWlnaHQpO1xuICAgICAgICB0YWIuYmcuZmlsbCh7IGNvbG9yOiAweDAwMDAwMCwgYWxwaGE6IDAgfSk7XG4gICAgICB9XG5cbiAgICAgIHRhYi5sYWJlbC5zZXRDb2xvcihpc0FjdGl2ZSA/IHRoaXMuYWN0aXZlVGV4dENvbG9yIDogdGhpcy50ZXh0Q29sb3IpO1xuICAgICAgdGFiLmxhYmVsLmNvbnRhaW5lci5hbHBoYSA9IDE7XG4gICAgfSk7XG5cbiAgICAvLyBVcGRhdGUgYWN0aXZlIGluZGljYXRvclxuICAgIGlmICh0aGlzLnR5cGUgPT09ICdsaW5lJykge1xuICAgICAgdGhpcy51cGRhdGVBY3RpdmVJbmRpY2F0b3IoKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgc2V0QWN0aXZlS2V5KGtleTogc3RyaW5nLCB1cGRhdGVIYXNoOiBib29sZWFuID0gdHJ1ZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLmFjdGl2ZUtleSA9PT0ga2V5KSByZXR1cm47XG5cbiAgICBjb25zdCBpdGVtID0gdGhpcy5pdGVtcy5maW5kKGl0ZW0gPT4gaXRlbS5rZXkgPT09IGtleSk7XG4gICAgaWYgKCFpdGVtIHx8IGl0ZW0uZGlzYWJsZWQpIHJldHVybjtcblxuICAgIHRoaXMuYWN0aXZlS2V5ID0ga2V5O1xuICAgIHRoaXMuc2hvd0FjdGl2ZVRhYigpO1xuXG4gICAgLy8gVXBkYXRlIFVSTCBoYXNoIGlmIGVuYWJsZWRcbiAgICBpZiAodXBkYXRlSGFzaCAmJiB0aGlzLmhhc2hQcmVmaXgpIHtcbiAgICAgIHRoaXMudXBkYXRlSGFzaChrZXkpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm9uQ2hhbmdlKSB7XG4gICAgICB0aGlzLm9uQ2hhbmdlKGtleSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGdldEFjdGl2ZUtleSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmFjdGl2ZUtleTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRJdGVtcyhpdGVtczogVGFiSXRlbVtdKTogdm9pZCB7XG4gICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xuXG4gICAgLy8gSWYgYWN0aXZlIGtleSBubyBsb25nZXIgZXhpc3RzLCBzd2l0Y2ggdG8gZmlyc3QgdGFiXG4gICAgaWYgKCF0aGlzLml0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLmtleSA9PT0gdGhpcy5hY3RpdmVLZXkpKSB7XG4gICAgICB0aGlzLmFjdGl2ZUtleSA9IHRoaXMuaXRlbXMubGVuZ3RoID4gMCA/IHRoaXMuaXRlbXNbMF0ua2V5IDogJyc7XG4gICAgfVxuXG4gICAgdGhpcy5idWlsZFRhYnMoKTtcbiAgICB0aGlzLnNob3dBY3RpdmVUYWIoKTtcbiAgfVxuXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIGxheW91dCh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcblxuICAgIC8vIFJlYnVpbGQgdGFicyB3aXRoIG5ldyBkaW1lbnNpb25zXG4gICAgdGhpcy5idWlsZFRhYnMoKTtcbiAgICB0aGlzLnNob3dBY3RpdmVUYWIoKTtcbiAgfVxuXG4gIHJlbmRlcigpOiB2b2lkIHtcbiAgICAvLyBSZW5kZXJpbmcgaXMgaGFuZGxlZCBieSBjaGlsZCBjb21wb25lbnRzXG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuaW1wb3J0IHsgVUlQYW5lbCB9IGZyb20gJy4vdWktcGFuZWwnO1xuaW1wb3J0IHsgRWRnZUluc2V0cyB9IGZyb20gJy4uL2NvcmUvZWRnZS1pbnNldHMnO1xuaW1wb3J0IHsgVUlGb2N1c01hbmFnZXIgfSBmcm9tICcuLi9jb3JlL3VpLWZvY3VzLW1hbmFnZXInO1xuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJVGV4dElucHV0XG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlUZXh0SW5wdXRQcm9wcyB7XG4gIC8qKiBDdXJyZW50IHZhbHVlIChjb250cm9sbGVkKSAqL1xuICB2YWx1ZT86IHN0cmluZztcbiAgLyoqIERlZmF1bHQgdmFsdWUgKHVuY29udHJvbGxlZCkgKi9cbiAgZGVmYXVsdFZhbHVlPzogc3RyaW5nO1xuICAvKiogQ2hhbmdlIGNhbGxiYWNrICovXG4gIG9uQ2hhbmdlPzogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG4gIC8qKiBQbGFjZWhvbGRlciB0ZXh0IHdoZW4gZW1wdHkgKi9cbiAgcGxhY2Vob2xkZXI/OiBzdHJpbmc7XG4gIC8qKiBNYXhpbXVtIGNoYXJhY3RlciBsZW5ndGggKi9cbiAgbWF4TGVuZ3RoPzogbnVtYmVyO1xuICAvKiogV2lkdGggb2YgdGhlIGlucHV0ICovXG4gIHdpZHRoPzogbnVtYmVyO1xuICAvKiogSGVpZ2h0IG9mIHRoZSBpbnB1dCAqL1xuICBoZWlnaHQ/OiBudW1iZXI7XG4gIC8qKiBXaGV0aGVyIHRoZSBpbnB1dCBpcyBkaXNhYmxlZCAqL1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yICovXG4gIGJhY2tncm91bmRDb2xvcj86IG51bWJlcjtcbiAgLyoqIFRleHQgY29sb3IgKi9cbiAgdGV4dENvbG9yPzogbnVtYmVyO1xuICAvKiogUGxhY2Vob2xkZXIgdGV4dCBjb2xvciAqL1xuICBwbGFjZWhvbGRlckNvbG9yPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG4gIC8qKiBGb250IHNpemUgKi9cbiAgZm9udFNpemU/OiBudW1iZXI7XG4gIC8qKiBJbnB1dCB0eXBlIGZvciB2YWxpZGF0aW9uICovXG4gIHR5cGU/OiAndGV4dCcgfCAnbnVtYmVyJztcbn1cblxuLyoqXG4gKiBBIHRleHQgaW5wdXQgY29tcG9uZW50IGZvbGxvd2luZyBBbnQgRGVzaWduIHBhdHRlcm5zXG4gKiBTdXBwb3J0cyBib3RoIGNvbnRyb2xsZWQgYW5kIHVuY29udHJvbGxlZCBtb2Rlc1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBpbnB1dCA9IG5ldyBVSVRleHRJbnB1dCh7XG4gKiAgIHBsYWNlaG9sZGVyOiAnRW50ZXIgeW91ciBuYW1lLi4uJyxcbiAqICAgb25DaGFuZ2U6ICh2YWx1ZSkgPT4gY29uc29sZS5sb2coJ0lucHV0OicsIHZhbHVlKSxcbiAqICAgbWF4TGVuZ3RoOiA1MFxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJVGV4dElucHV0IGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxPbWl0PFVJVGV4dElucHV0UHJvcHMsICdvbkNoYW5nZScgfCAndmFsdWUnIHwgJ2RlZmF1bHRWYWx1ZSc+PjtcbiAgcHJpdmF0ZSBvbkNoYW5nZT86ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xuXG4gIHByaXZhdGUgY3VycmVudFZhbHVlOiBzdHJpbmc7XG4gIHByaXZhdGUgYmFja2dyb3VuZDogVUlQYW5lbDtcbiAgcHJpdmF0ZSB0ZXh0RGlzcGxheTogUElYSS5UZXh0O1xuICBwcml2YXRlIGN1cnNvcjogUElYSS5HcmFwaGljcztcbiAgcHJpdmF0ZSBjdXJzb3JQb3NpdGlvbjogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBjdXJzb3JCbGlua0ludGVydmFsPzogbnVtYmVyO1xuICBwcml2YXRlIGN1cnNvclZpc2libGU6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSVRleHRJbnB1dFByb3BzLCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIHBsYWNlaG9sZGVyOiBwcm9wcy5wbGFjZWhvbGRlciA/PyAnJyxcbiAgICAgIG1heExlbmd0aDogcHJvcHMubWF4TGVuZ3RoID8/IDEwMCxcbiAgICAgIHdpZHRoOiBwcm9wcy53aWR0aCA/PyAyMDAsXG4gICAgICBoZWlnaHQ6IHByb3BzLmhlaWdodCA/PyAzNixcbiAgICAgIGRpc2FibGVkOiBwcm9wcy5kaXNhYmxlZCA/PyBmYWxzZSxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogcHJvcHMuYmFja2dyb3VuZENvbG9yID8/IDB4ZmZmZmZmLFxuICAgICAgdGV4dENvbG9yOiBwcm9wcy50ZXh0Q29sb3IgPz8gMHgwMDAwMDAsXG4gICAgICBwbGFjZWhvbGRlckNvbG9yOiBwcm9wcy5wbGFjZWhvbGRlckNvbG9yID8/IDB4OTk5OTk5LFxuICAgICAgYm9yZGVyUmFkaXVzOiBwcm9wcy5ib3JkZXJSYWRpdXMgPz8gNCxcbiAgICAgIGZvbnRTaXplOiBwcm9wcy5mb250U2l6ZSA/PyAxNCxcbiAgICAgIHR5cGU6IHByb3BzLnR5cGUgPz8gJ3RleHQnXG4gICAgfTtcblxuICAgIHRoaXMub25DaGFuZ2UgPSBwcm9wcy5vbkNoYW5nZTtcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHByb3BzLnZhbHVlID8/IHByb3BzLmRlZmF1bHRWYWx1ZSA/PyAnJztcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9uc1xuICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSB0aGlzLnByb3BzLndpZHRoO1xuICAgIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG5cbiAgICAvLyBDcmVhdGUgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kLmNvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgdGV4dCBkaXNwbGF5XG4gICAgdGhpcy50ZXh0RGlzcGxheSA9IG5ldyBQSVhJLlRleHQoe1xuICAgICAgdGV4dDogdGhpcy5nZXREaXNwbGF5VGV4dCgpLFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgZm9udEZhbWlseTogJ0FyaWFsJyxcbiAgICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMuZm9udFNpemUsXG4gICAgICAgIGZpbGw6IHRoaXMuY3VycmVudFZhbHVlID8gdGhpcy5wcm9wcy50ZXh0Q29sb3IgOiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyQ29sb3IsXG4gICAgICAgIGFsaWduOiAnbGVmdCdcbiAgICAgIH0sXG4gICAgICByZXNvbHV0aW9uOiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAyXG4gICAgfSk7XG4gICAgdGhpcy50ZXh0RGlzcGxheS5wb3NpdGlvbi5zZXQoMTIsICh0aGlzLnByb3BzLmhlaWdodCAtIHRoaXMucHJvcHMuZm9udFNpemUpIC8gMik7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy50ZXh0RGlzcGxheSk7XG5cbiAgICAvLyBDcmVhdGUgY3Vyc29yXG4gICAgdGhpcy5jdXJzb3IgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMuY3Vyc29yLnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmN1cnNvcik7XG5cbiAgICAvLyBTZXR1cCBpbnRlcmFjdGl2aXR5XG4gICAgdGhpcy5zZXR1cEludGVyYWN0aXZpdHkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBkaXNwbGF5IHRleHQgKHZhbHVlIG9yIHBsYWNlaG9sZGVyKVxuICAgKi9cbiAgcHJpdmF0ZSBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLmN1cnJlbnRWYWx1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5wcm9wcy5wbGFjZWhvbGRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHVwIG1vdXNlL2tleWJvYXJkIGV2ZW50IGhhbmRsZXJzXG4gICAqL1xuICBwcml2YXRlIHNldHVwSW50ZXJhY3Rpdml0eSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICB0aGlzLmNvbnRhaW5lci5jdXJzb3IgPSAndGV4dCc7XG5cbiAgICAvLyBDbGljayB0byBmb2N1c1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVyZG93bicsIHRoaXMuaGFuZGxlUG9pbnRlckRvd24uYmluZCh0aGlzKSk7XG5cbiAgICAvLyBMaXN0ZW4gZm9yIGdsb2JhbCBjbGljayB0byBibHVyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJEb3duKGU6IFBJWEkuRmVkZXJhdGVkUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZGlzYWJsZWQpIHJldHVybjtcblxuICAgIC8vIFJlcXVlc3QgZm9jdXMgdGhyb3VnaCB0aGUgZm9jdXMgbWFuYWdlclxuICAgIGNvbnN0IGZvY3VzTWFuYWdlciA9IFVJRm9jdXNNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gICAgaWYgKGZvY3VzTWFuYWdlcikge1xuICAgICAgZm9jdXNNYW5hZ2VyLnJlcXVlc3RGb2N1cyh0aGlzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRmFsbGJhY2sgaWYgbm8gZm9jdXMgbWFuYWdlclxuICAgICAgdGhpcy5vbkZvY3VzKCk7XG4gICAgfVxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gaW5wdXQgcmVjZWl2ZXMgZm9jdXMgKG92ZXJyaWRlIGZyb20gYmFzZSBjbGFzcylcbiAgICovXG4gIG92ZXJyaWRlIG9uRm9jdXMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNlZCkgcmV0dXJuO1xuXG4gICAgc3VwZXIub25Gb2N1cygpO1xuICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGg7XG4gICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IHRydWU7XG4gICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICB0aGlzLnN0YXJ0Q3Vyc29yQmxpbmsoKTtcblxuICAgIC8vIFVwZGF0ZSBiYWNrZ3JvdW5kIHRvIHNob3cgZm9jdXMgc3RhdGVcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMubGlnaHRlbkNvbG9yKHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLCAwLjk1KSxcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBpbnB1dCBsb3NlcyBmb2N1cyAob3ZlcnJpZGUgZnJvbSBiYXNlIGNsYXNzKVxuICAgKi9cbiAgb3ZlcnJpZGUgb25CbHVyKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5mb2N1c2VkKSByZXR1cm47XG5cbiAgICBzdXBlci5vbkJsdXIoKTtcbiAgICB0aGlzLmN1cnNvci52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5zdG9wQ3Vyc29yQmxpbmsoKTtcblxuICAgIC8vIFJlc3RvcmUgbm9ybWFsIGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVLZXlEb3duKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZm9jdXNlZCB8fCB0aGlzLnByb3BzLmRpc2FibGVkKSByZXR1cm47XG5cbiAgICAvLyBTdG9wIGV2ZW50IGZyb20gcHJvcGFnYXRpbmdcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgIGNvbnN0IGtleSA9IGUua2V5O1xuXG4gICAgaWYgKGtleSA9PT0gJ0VudGVyJykge1xuICAgICAgdGhpcy5vbkJsdXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5vbkJsdXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQmFja3NwYWNlJykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPiAwKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlID1cbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbiAtIDEpICtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcodGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24tLTtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0RlbGV0ZScpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uIDwgdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlID1cbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbikgK1xuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZyh0aGlzLmN1cnNvclBvc2l0aW9uICsgMSk7XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdBcnJvd0xlZnQnKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3JQb3NpdGlvbiA+IDApIHtcbiAgICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbi0tO1xuICAgICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdBcnJvd1JpZ2h0Jykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPCB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbisrO1xuICAgICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdIb21lJykge1xuICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IDA7XG4gICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdFbmQnKSB7XG4gICAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoO1xuICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgY2hhcmFjdGVyIGlucHV0XG4gICAgaWYgKGtleS5sZW5ndGggPT09IDEgJiYgIWUuY3RybEtleSAmJiAhZS5tZXRhS2V5KSB7XG4gICAgICAvLyBUeXBlIHZhbGlkYXRpb25cbiAgICAgIGlmICh0aGlzLnByb3BzLnR5cGUgPT09ICdudW1iZXInICYmICEvWzAtOS4tXS8udGVzdChrZXkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgbWF4IGxlbmd0aFxuICAgICAgaWYgKHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCA+PSB0aGlzLnByb3BzLm1heExlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIEluc2VydCBjaGFyYWN0ZXIgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uKSArXG4gICAgICAgIGtleSArXG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZyh0aGlzLmN1cnNvclBvc2l0aW9uKTtcbiAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24rKztcbiAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSB0ZXh0IGRpc3BsYXkgYW5kIHRyaWdnZXJzIG9uQ2hhbmdlXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZVRleHQoKTogdm9pZCB7XG4gICAgdGhpcy50ZXh0RGlzcGxheS50ZXh0ID0gdGhpcy5nZXREaXNwbGF5VGV4dCgpO1xuICAgIHRoaXMudGV4dERpc3BsYXkuc3R5bGUuZmlsbCA9IHRoaXMuY3VycmVudFZhbHVlID8gdGhpcy5wcm9wcy50ZXh0Q29sb3IgOiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyQ29sb3I7XG4gICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICB0aGlzLm9uQ2hhbmdlPy4odGhpcy5jdXJyZW50VmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgY3Vyc29yIHBvc2l0aW9uIHZpc3VhbGx5XG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZUN1cnNvcigpOiB2b2lkIHtcbiAgICAvLyBNZWFzdXJlIHRleHQgdXAgdG8gY3Vyc29yIHBvc2l0aW9uIGJ5IGNyZWF0aW5nIGEgdGVtcG9yYXJ5IHRleHQgb2JqZWN0XG4gICAgY29uc3QgdGV4dFVwVG9DdXJzb3IgPSB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgY29uc3QgdGVtcFRleHQgPSBuZXcgUElYSS5UZXh0KHtcbiAgICAgIHRleHQ6IHRleHRVcFRvQ3Vyc29yLFxuICAgICAgc3R5bGU6IHRoaXMudGV4dERpc3BsYXkuc3R5bGVcbiAgICB9KTtcblxuICAgIGNvbnN0IGN1cnNvclggPSAxMiArIHRlbXBUZXh0LndpZHRoO1xuICAgIGNvbnN0IGN1cnNvclkgPSAodGhpcy5wcm9wcy5oZWlnaHQgLSB0aGlzLnByb3BzLmZvbnRTaXplKSAvIDI7XG5cbiAgICB0aGlzLmN1cnNvci5jbGVhcigpO1xuICAgIHRoaXMuY3Vyc29yLnJlY3QoY3Vyc29yWCwgY3Vyc29yWSwgMSwgdGhpcy5wcm9wcy5mb250U2l6ZSk7XG4gICAgdGhpcy5jdXJzb3IuZmlsbCh7IGNvbG9yOiB0aGlzLnByb3BzLnRleHRDb2xvciB9KTtcblxuICAgIC8vIENsZWFuIHVwIHRlbXAgdGV4dFxuICAgIHRlbXBUZXh0LmRlc3Ryb3koKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydHMgY3Vyc29yIGJsaW5raW5nIGFuaW1hdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBzdGFydEN1cnNvckJsaW5rKCk6IHZvaWQge1xuICAgIHRoaXMuc3RvcEN1cnNvckJsaW5rKCk7XG4gICAgdGhpcy5jdXJzb3JWaXNpYmxlID0gdHJ1ZTtcblxuICAgIHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLmN1cnNvclZpc2libGUgPSAhdGhpcy5jdXJzb3JWaXNpYmxlO1xuICAgICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IHRoaXMuY3Vyc29yVmlzaWJsZTtcbiAgICB9LCA1MzApO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3BzIGN1cnNvciBibGlua2luZyBhbmltYXRpb25cbiAgICovXG4gIHByaXZhdGUgc3RvcEN1cnNvckJsaW5rKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmN1cnNvckJsaW5rSW50ZXJ2YWwpIHtcbiAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCk7XG4gICAgICB0aGlzLmN1cnNvckJsaW5rSW50ZXJ2YWwgPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIExpZ2h0ZW5zIGEgY29sb3IgYnkgYSBmYWN0b3JcbiAgICovXG4gIHByaXZhdGUgbGlnaHRlbkNvbG9yKGNvbG9yOiBudW1iZXIsIGZhY3RvcjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBjb25zdCByID0gTWF0aC5taW4oMjU1LCAoKGNvbG9yID4+IDE2KSAmIDB4ZmYpIC8gZmFjdG9yKTtcbiAgICBjb25zdCBnID0gTWF0aC5taW4oMjU1LCAoKGNvbG9yID4+IDgpICYgMHhmZikgLyBmYWN0b3IpO1xuICAgIGNvbnN0IGIgPSBNYXRoLm1pbigyNTUsIChjb2xvciAmIDB4ZmYpIC8gZmFjdG9yKTtcbiAgICByZXR1cm4gKChyIDw8IDE2KSB8IChnIDw8IDgpIHwgYikgPj4+IDA7XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgdGhlIHNpemUgbmVlZGVkIGZvciB0aGlzIGlucHV0XG4gICAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIGlucHV0XG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuXG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgLy8gTGF5b3V0IGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQubGF5b3V0KG1lYXN1cmVkLndpZHRoLCBtZWFzdXJlZC5oZWlnaHQpO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgaW5wdXRcbiAgICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgLy8gUmVuZGVyaW5nIGhhbmRsZWQgYnkgYmFja2dyb3VuZCwgdGV4dCwgYW5kIGN1cnNvclxuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHZhbHVlIHByb2dyYW1tYXRpY2FsbHlcbiAgICovXG4gIHNldFZhbHVlKHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSB2YWx1ZS5sZW5ndGg7XG4gICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCB2YWx1ZVxuICAgKi9cbiAgZ2V0VmFsdWUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCB3aGVuIGRlc3Ryb3lpbmdcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5zdG9wQ3Vyc29yQmxpbmsoKTtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlEb3duLmJpbmQodGhpcykpO1xuICAgIH1cbiAgICBzdXBlci5kZXN0cm95KCk7XG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuaW1wb3J0IHsgVUlQYW5lbCB9IGZyb20gJy4vdWktcGFuZWwnO1xuaW1wb3J0IHsgVUlGb2N1c01hbmFnZXIgfSBmcm9tICcuLi9jb3JlL3VpLWZvY3VzLW1hbmFnZXInO1xuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJVGV4dEFyZWFcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSVRleHRBcmVhUHJvcHMge1xuICAvKiogQ3VycmVudCB2YWx1ZSAoY29udHJvbGxlZCkgKi9cbiAgdmFsdWU/OiBzdHJpbmc7XG4gIC8qKiBEZWZhdWx0IHZhbHVlICh1bmNvbnRyb2xsZWQpICovXG4gIGRlZmF1bHRWYWx1ZT86IHN0cmluZztcbiAgLyoqIENoYW5nZSBjYWxsYmFjayAqL1xuICBvbkNoYW5nZT86ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xuICAvKiogUGxhY2Vob2xkZXIgdGV4dCB3aGVuIGVtcHR5ICovXG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xuICAvKiogTWF4aW11bSBjaGFyYWN0ZXIgbGVuZ3RoICovXG4gIG1heExlbmd0aD86IG51bWJlcjtcbiAgLyoqIFdpZHRoIG9mIHRoZSB0ZXh0YXJlYSAqL1xuICB3aWR0aD86IG51bWJlcjtcbiAgLyoqIEhlaWdodCBvZiB0aGUgdGV4dGFyZWEgKi9cbiAgaGVpZ2h0PzogbnVtYmVyO1xuICAvKiogV2hldGhlciB0aGUgdGV4dGFyZWEgaXMgZGlzYWJsZWQgKi9cbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICAvKiogQmFja2dyb3VuZCBjb2xvciAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBUZXh0IGNvbG9yICovXG4gIHRleHRDb2xvcj86IG51bWJlcjtcbiAgLyoqIFBsYWNlaG9sZGVyIHRleHQgY29sb3IgKi9cbiAgcGxhY2Vob2xkZXJDb2xvcj86IG51bWJlcjtcbiAgLyoqIEJvcmRlciByYWRpdXMgKi9cbiAgYm9yZGVyUmFkaXVzPzogbnVtYmVyO1xuICAvKiogRm9udCBzaXplICovXG4gIGZvbnRTaXplPzogbnVtYmVyO1xuICAvKiogTGluZSBoZWlnaHQgbXVsdGlwbGllciAoZS5nLiwgMS41IG1lYW5zIDEuNXggdGhlIGZvbnQgc2l6ZSkgKi9cbiAgbGluZUhlaWdodD86IG51bWJlcjtcbiAgLyoqIE51bWJlciBvZiB2aXNpYmxlIHJvd3MgKi9cbiAgcm93cz86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBIG11bHRpLWxpbmUgdGV4dCBhcmVhIGNvbXBvbmVudFxuICogU3VwcG9ydHMgd29yZCB3cmFwcGluZyBhbmQgc2Nyb2xsaW5nXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHRleHRhcmVhID0gbmV3IFVJVGV4dEFyZWEoe1xuICogICBwbGFjZWhvbGRlcjogJ0VudGVyIHlvdXIgbWVzc2FnZS4uLicsXG4gKiAgIG9uQ2hhbmdlOiAodmFsdWUpID0+IGNvbnNvbGUubG9nKCdNZXNzYWdlOicsIHZhbHVlKSxcbiAqICAgd2lkdGg6IDQwMCxcbiAqICAgaGVpZ2h0OiAxMjAsXG4gKiAgIHJvd3M6IDRcbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSVRleHRBcmVhIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxPbWl0PFVJVGV4dEFyZWFQcm9wcywgJ29uQ2hhbmdlJyB8ICd2YWx1ZScgfCAnZGVmYXVsdFZhbHVlJz4+O1xuICBwcml2YXRlIG9uQ2hhbmdlPzogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG5cbiAgcHJpdmF0ZSBjdXJyZW50VmFsdWU6IHN0cmluZztcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kOiBVSVBhbmVsO1xuICBwcml2YXRlIHRleHREaXNwbGF5OiBQSVhJLlRleHQ7XG4gIHByaXZhdGUgY3Vyc29yOiBQSVhJLkdyYXBoaWNzO1xuICBwcml2YXRlIGN1cnNvclBvc2l0aW9uOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGN1cnNvckJsaW5rSW50ZXJ2YWw/OiBudW1iZXI7XG4gIHByaXZhdGUgY3Vyc29yVmlzaWJsZTogYm9vbGVhbiA9IHRydWU7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJVGV4dEFyZWFQcm9wcywgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIGNvbnN0IGRlZmF1bHRIZWlnaHQgPSAocHJvcHMucm93cyA/PyA0KSAqIChwcm9wcy5mb250U2l6ZSA/PyAxNCkgKiAocHJvcHMubGluZUhlaWdodCA/PyAxLjUpICsgMjQ7XG5cbiAgICB0aGlzLnByb3BzID0ge1xuICAgICAgcGxhY2Vob2xkZXI6IHByb3BzLnBsYWNlaG9sZGVyID8/ICcnLFxuICAgICAgbWF4TGVuZ3RoOiBwcm9wcy5tYXhMZW5ndGggPz8gMTAwMCxcbiAgICAgIHdpZHRoOiBwcm9wcy53aWR0aCA/PyA0MDAsXG4gICAgICBoZWlnaHQ6IHByb3BzLmhlaWdodCA/PyBkZWZhdWx0SGVpZ2h0LFxuICAgICAgZGlzYWJsZWQ6IHByb3BzLmRpc2FibGVkID8/IGZhbHNlLFxuICAgICAgYmFja2dyb3VuZENvbG9yOiBwcm9wcy5iYWNrZ3JvdW5kQ29sb3IgPz8gMHhmZmZmZmYsXG4gICAgICB0ZXh0Q29sb3I6IHByb3BzLnRleHRDb2xvciA/PyAweDAwMDAwMCxcbiAgICAgIHBsYWNlaG9sZGVyQ29sb3I6IHByb3BzLnBsYWNlaG9sZGVyQ29sb3IgPz8gMHg5OTk5OTksXG4gICAgICBib3JkZXJSYWRpdXM6IHByb3BzLmJvcmRlclJhZGl1cyA/PyA0LFxuICAgICAgZm9udFNpemU6IHByb3BzLmZvbnRTaXplID8/IDE0LFxuICAgICAgbGluZUhlaWdodDogcHJvcHMubGluZUhlaWdodCA/PyAxLjUsXG4gICAgICByb3dzOiBwcm9wcy5yb3dzID8/IDRcbiAgICB9O1xuXG4gICAgdGhpcy5vbkNoYW5nZSA9IHByb3BzLm9uQ2hhbmdlO1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gcHJvcHMudmFsdWUgPz8gcHJvcHMuZGVmYXVsdFZhbHVlID8/ICcnO1xuXG4gICAgLy8gU2V0IGJveCBtb2RlbCBkaW1lbnNpb25zXG4gICAgdGhpcy5ib3hNb2RlbC53aWR0aCA9IHRoaXMucHJvcHMud2lkdGg7XG4gICAgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcblxuICAgIC8vIENyZWF0ZSBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQuY29udGFpbmVyKTtcblxuICAgIC8vIENyZWF0ZSB0ZXh0IGRpc3BsYXkgd2l0aCB3b3JkIHdyYXBwaW5nXG4gICAgdGhpcy50ZXh0RGlzcGxheSA9IG5ldyBQSVhJLlRleHQoe1xuICAgICAgdGV4dDogdGhpcy5nZXREaXNwbGF5VGV4dCgpLFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgZm9udEZhbWlseTogJ0FyaWFsJyxcbiAgICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMuZm9udFNpemUsXG4gICAgICAgIGZpbGw6IHRoaXMuY3VycmVudFZhbHVlID8gdGhpcy5wcm9wcy50ZXh0Q29sb3IgOiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyQ29sb3IsXG4gICAgICAgIGFsaWduOiAnbGVmdCcsXG4gICAgICAgIHdvcmRXcmFwOiB0cnVlLFxuICAgICAgICB3b3JkV3JhcFdpZHRoOiB0aGlzLnByb3BzLndpZHRoIC0gMjQsXG4gICAgICAgIGxpbmVIZWlnaHQ6IHRoaXMucHJvcHMuZm9udFNpemUgKiB0aGlzLnByb3BzLmxpbmVIZWlnaHRcbiAgICAgIH0sXG4gICAgICByZXNvbHV0aW9uOiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAyXG4gICAgfSk7XG4gICAgdGhpcy50ZXh0RGlzcGxheS5wb3NpdGlvbi5zZXQoMTIsIDEyKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnRleHREaXNwbGF5KTtcblxuICAgIC8vIENyZWF0ZSBjdXJzb3JcbiAgICB0aGlzLmN1cnNvciA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IGZhbHNlO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuY3Vyc29yKTtcblxuICAgIC8vIFNldHVwIGludGVyYWN0aXZpdHlcbiAgICB0aGlzLnNldHVwSW50ZXJhY3Rpdml0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGRpc3BsYXkgdGV4dCAodmFsdWUgb3IgcGxhY2Vob2xkZXIpXG4gICAqL1xuICBwcml2YXRlIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuY3VycmVudFZhbHVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFsdWU7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgbW91c2Uva2V5Ym9hcmQgZXZlbnQgaGFuZGxlcnNcbiAgICovXG4gIHByaXZhdGUgc2V0dXBJbnRlcmFjdGl2aXR5KCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgIHRoaXMuY29udGFpbmVyLmN1cnNvciA9ICd0ZXh0JztcblxuICAgIC8vIENsaWNrIHRvIGZvY3VzXG4gICAgdGhpcy5jb250YWluZXIub24oJ3BvaW50ZXJkb3duJywgdGhpcy5oYW5kbGVQb2ludGVyRG93bi5iaW5kKHRoaXMpKTtcblxuICAgIC8vIExpc3RlbiBmb3IgZ2xvYmFsIGtleWJvYXJkIGV2ZW50c1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleURvd24uYmluZCh0aGlzKSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyRG93bihlOiBQSVhJLkZlZGVyYXRlZFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLmRpc2FibGVkKSByZXR1cm47XG5cbiAgICAvLyBSZXF1ZXN0IGZvY3VzIHRocm91Z2ggdGhlIGZvY3VzIG1hbmFnZXJcbiAgICBjb25zdCBmb2N1c01hbmFnZXIgPSBVSUZvY3VzTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuICAgIGlmIChmb2N1c01hbmFnZXIpIHtcbiAgICAgIGZvY3VzTWFuYWdlci5yZXF1ZXN0Rm9jdXModGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZhbGxiYWNrIGlmIG5vIGZvY3VzIG1hbmFnZXJcbiAgICAgIHRoaXMub25Gb2N1cygpO1xuICAgIH1cbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHRleHRhcmVhIHJlY2VpdmVzIGZvY3VzIChvdmVycmlkZSBmcm9tIGJhc2UgY2xhc3MpXG4gICAqL1xuICBvdmVycmlkZSBvbkZvY3VzKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzZWQpIHJldHVybjtcblxuICAgIHN1cGVyLm9uRm9jdXMoKTtcbiAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoO1xuICAgIHRoaXMuY3Vyc29yLnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgdGhpcy5zdGFydEN1cnNvckJsaW5rKCk7XG5cbiAgICAvLyBVcGRhdGUgYmFja2dyb3VuZCB0byBzaG93IGZvY3VzIHN0YXRlXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLmxpZ2h0ZW5Db2xvcih0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciwgMC45NSksXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gdGV4dGFyZWEgbG9zZXMgZm9jdXMgKG92ZXJyaWRlIGZyb20gYmFzZSBjbGFzcylcbiAgICovXG4gIG92ZXJyaWRlIG9uQmx1cigpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZm9jdXNlZCkgcmV0dXJuO1xuXG4gICAgc3VwZXIub25CbHVyKCk7XG4gICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IGZhbHNlO1xuICAgIHRoaXMuc3RvcEN1cnNvckJsaW5rKCk7XG5cbiAgICAvLyBSZXN0b3JlIG5vcm1hbCBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlS2V5RG93bihlOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmZvY3VzZWQgfHwgdGhpcy5wcm9wcy5kaXNhYmxlZCkgcmV0dXJuO1xuXG4gICAgLy8gRG9uJ3QgcHJldmVudCBkZWZhdWx0IGZvciBUYWIgKGFsbG93IHRhYiBuYXZpZ2F0aW9uKVxuICAgIGlmIChlLmtleSAhPT0gJ1RhYicpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgfVxuXG4gICAgY29uc3Qga2V5ID0gZS5rZXk7XG5cbiAgICAvLyBFbnRlciBhZGRzIG5ldyBsaW5lIGluIHRleHRhcmVhXG4gICAgaWYgKGtleSA9PT0gJ0VudGVyJykge1xuICAgICAgaWYgKHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCA8IHRoaXMucHJvcHMubWF4TGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlID1cbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbikgK1xuICAgICAgICAgICdcXG4nICtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcodGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24rKztcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHRoaXMub25CbHVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0JhY2tzcGFjZScpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uID4gMCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24gLSAxKSArXG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKHRoaXMuY3Vyc29yUG9zaXRpb24pO1xuICAgICAgICB0aGlzLmN1cnNvclBvc2l0aW9uLS07XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdEZWxldGUnKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3JQb3NpdGlvbiA8IHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24pICtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcodGhpcy5jdXJzb3JQb3NpdGlvbiArIDEpO1xuICAgICAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQXJyb3dMZWZ0Jykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPiAwKSB7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24tLTtcbiAgICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQXJyb3dSaWdodCcpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uIDwgdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24rKztcbiAgICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQXJyb3dVcCcpIHtcbiAgICAgIC8vIE1vdmUgY3Vyc29yIHVwIG9uZSBsaW5lXG4gICAgICB0aGlzLm1vdmVDdXJzb3JWZXJ0aWNhbGx5KC0xKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQXJyb3dEb3duJykge1xuICAgICAgLy8gTW92ZSBjdXJzb3IgZG93biBvbmUgbGluZVxuICAgICAgdGhpcy5tb3ZlQ3Vyc29yVmVydGljYWxseSgxKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnSG9tZScpIHtcbiAgICAgIC8vIE1vdmUgdG8gc3RhcnQgb2YgY3VycmVudCBsaW5lXG4gICAgICBjb25zdCBsaW5lU3RhcnQgPSB0aGlzLmN1cnJlbnRWYWx1ZS5sYXN0SW5kZXhPZignXFxuJywgdGhpcy5jdXJzb3JQb3NpdGlvbiAtIDEpICsgMTtcbiAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSBsaW5lU3RhcnQ7XG4gICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdFbmQnKSB7XG4gICAgICAvLyBNb3ZlIHRvIGVuZCBvZiBjdXJyZW50IGxpbmVcbiAgICAgIGxldCBsaW5lRW5kID0gdGhpcy5jdXJyZW50VmFsdWUuaW5kZXhPZignXFxuJywgdGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgICBpZiAobGluZUVuZCA9PT0gLTEpIGxpbmVFbmQgPSB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGg7XG4gICAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gbGluZUVuZDtcbiAgICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIGNoYXJhY3RlciBpbnB1dFxuICAgIGlmIChrZXkubGVuZ3RoID09PSAxICYmICFlLmN0cmxLZXkgJiYgIWUubWV0YUtleSkge1xuICAgICAgLy8gQ2hlY2sgbWF4IGxlbmd0aFxuICAgICAgaWYgKHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCA+PSB0aGlzLnByb3BzLm1heExlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIEluc2VydCBjaGFyYWN0ZXIgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uKSArXG4gICAgICAgIGtleSArXG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZyh0aGlzLmN1cnNvclBvc2l0aW9uKTtcbiAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24rKztcbiAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNb3ZlcyBjdXJzb3IgdmVydGljYWxseSBieSB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiBsaW5lc1xuICAgKi9cbiAgcHJpdmF0ZSBtb3ZlQ3Vyc29yVmVydGljYWxseShkaXJlY3Rpb246IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IGxpbmVzID0gdGhpcy5jdXJyZW50VmFsdWUuc3BsaXQoJ1xcbicpO1xuICAgIGxldCBjdXJyZW50TGluZSA9IDA7XG4gICAgbGV0IHBvc2l0aW9uSW5MaW5lID0gMDtcbiAgICBsZXQgY2hhckNvdW50ID0gMDtcblxuICAgIC8vIEZpbmQgY3VycmVudCBsaW5lIGFuZCBwb3NpdGlvblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChjaGFyQ291bnQgKyBsaW5lc1tpXS5sZW5ndGggPj0gdGhpcy5jdXJzb3JQb3NpdGlvbikge1xuICAgICAgICBjdXJyZW50TGluZSA9IGk7XG4gICAgICAgIHBvc2l0aW9uSW5MaW5lID0gdGhpcy5jdXJzb3JQb3NpdGlvbiAtIGNoYXJDb3VudDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjaGFyQ291bnQgKz0gbGluZXNbaV0ubGVuZ3RoICsgMTsgLy8gKzEgZm9yIG5ld2xpbmVcbiAgICB9XG5cbiAgICAvLyBNb3ZlIHRvIHRhcmdldCBsaW5lXG4gICAgY29uc3QgdGFyZ2V0TGluZSA9IE1hdGgubWF4KDAsIE1hdGgubWluKGxpbmVzLmxlbmd0aCAtIDEsIGN1cnJlbnRMaW5lICsgZGlyZWN0aW9uKSk7XG4gICAgaWYgKHRhcmdldExpbmUgPT09IGN1cnJlbnRMaW5lKSByZXR1cm47XG5cbiAgICAvLyBDYWxjdWxhdGUgbmV3IGN1cnNvciBwb3NpdGlvblxuICAgIGxldCBuZXdQb3NpdGlvbiA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRMaW5lOyBpKyspIHtcbiAgICAgIG5ld1Bvc2l0aW9uICs9IGxpbmVzW2ldLmxlbmd0aCArIDE7XG4gICAgfVxuICAgIG5ld1Bvc2l0aW9uICs9IE1hdGgubWluKHBvc2l0aW9uSW5MaW5lLCBsaW5lc1t0YXJnZXRMaW5lXS5sZW5ndGgpO1xuXG4gICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IG5ld1Bvc2l0aW9uO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgdGV4dCBkaXNwbGF5IGFuZCB0cmlnZ2VycyBvbkNoYW5nZVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVUZXh0KCk6IHZvaWQge1xuICAgIHRoaXMudGV4dERpc3BsYXkudGV4dCA9IHRoaXMuZ2V0RGlzcGxheVRleHQoKTtcbiAgICB0aGlzLnRleHREaXNwbGF5LnN0eWxlLmZpbGwgPSB0aGlzLmN1cnJlbnRWYWx1ZSA/IHRoaXMucHJvcHMudGV4dENvbG9yIDogdGhpcy5wcm9wcy5wbGFjZWhvbGRlckNvbG9yO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgdGhpcy5vbkNoYW5nZT8uKHRoaXMuY3VycmVudFZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIGN1cnNvciBwb3NpdGlvbiB2aXN1YWxseVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVDdXJzb3IoKTogdm9pZCB7XG4gICAgLy8gR2V0IHRleHQgbWV0cmljcyB1cCB0byBjdXJzb3IgcG9zaXRpb25cbiAgICBjb25zdCB0ZXh0VXBUb0N1cnNvciA9IHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uKTtcblxuICAgIC8vIENyZWF0ZSB0ZW1wb3JhcnkgdGV4dCB0byBtZWFzdXJlXG4gICAgY29uc3QgdGVtcFRleHQgPSBuZXcgUElYSS5UZXh0KHtcbiAgICAgIHRleHQ6IHRleHRVcFRvQ3Vyc29yLFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgLi4udGhpcy50ZXh0RGlzcGxheS5zdHlsZSxcbiAgICAgICAgd29yZFdyYXA6IHRydWUsXG4gICAgICAgIHdvcmRXcmFwV2lkdGg6IHRoaXMucHJvcHMud2lkdGggLSAyNFxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gR2V0IHRoZSBib3VuZHMgdG8gZmluZCBjdXJzb3IgcG9zaXRpb25cbiAgICBjb25zdCBtZXRyaWNzID0gdGVtcFRleHQuZ2V0TG9jYWxCb3VuZHMoKTtcblxuICAgIC8vIEZvciBtdWx0aS1saW5lLCB3ZSBuZWVkIHRvIGZpbmQgdGhlIGxhc3QgbGluZSBwb3NpdGlvblxuICAgIGNvbnN0IGxpbmVzID0gdGV4dFVwVG9DdXJzb3Iuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGxhc3RMaW5lID0gbGluZXNbbGluZXMubGVuZ3RoIC0gMV07XG5cbiAgICBjb25zdCBsYXN0TGluZVRleHQgPSBuZXcgUElYSS5UZXh0KHtcbiAgICAgIHRleHQ6IGxhc3RMaW5lLFxuICAgICAgc3R5bGU6IHRoaXMudGV4dERpc3BsYXkuc3R5bGVcbiAgICB9KTtcblxuICAgIGNvbnN0IGN1cnNvclggPSAxMiArIGxhc3RMaW5lVGV4dC53aWR0aDtcbiAgICBjb25zdCBjdXJzb3JZID0gMTIgKyAobGluZXMubGVuZ3RoIC0gMSkgKiAodGhpcy5wcm9wcy5mb250U2l6ZSAqIHRoaXMucHJvcHMubGluZUhlaWdodCk7XG5cbiAgICB0aGlzLmN1cnNvci5jbGVhcigpO1xuICAgIHRoaXMuY3Vyc29yLnJlY3QoY3Vyc29yWCwgY3Vyc29yWSwgMSwgdGhpcy5wcm9wcy5mb250U2l6ZSk7XG4gICAgdGhpcy5jdXJzb3IuZmlsbCh7IGNvbG9yOiB0aGlzLnByb3BzLnRleHRDb2xvciB9KTtcblxuICAgIC8vIENsZWFuIHVwIHRlbXAgb2JqZWN0c1xuICAgIHRlbXBUZXh0LmRlc3Ryb3koKTtcbiAgICBsYXN0TGluZVRleHQuZGVzdHJveSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0cyBjdXJzb3IgYmxpbmtpbmcgYW5pbWF0aW9uXG4gICAqL1xuICBwcml2YXRlIHN0YXJ0Q3Vyc29yQmxpbmsoKTogdm9pZCB7XG4gICAgdGhpcy5zdG9wQ3Vyc29yQmxpbmsoKTtcbiAgICB0aGlzLmN1cnNvclZpc2libGUgPSB0cnVlO1xuXG4gICAgdGhpcy5jdXJzb3JCbGlua0ludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHRoaXMuY3Vyc29yVmlzaWJsZSA9ICF0aGlzLmN1cnNvclZpc2libGU7XG4gICAgICB0aGlzLmN1cnNvci52aXNpYmxlID0gdGhpcy5jdXJzb3JWaXNpYmxlO1xuICAgIH0sIDUzMCk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcHMgY3Vyc29yIGJsaW5raW5nIGFuaW1hdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBzdG9wQ3Vyc29yQmxpbmsoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCkge1xuICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5jdXJzb3JCbGlua0ludGVydmFsKTtcbiAgICAgIHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTGlnaHRlbnMgYSBjb2xvciBieSBhIGZhY3RvclxuICAgKi9cbiAgcHJpdmF0ZSBsaWdodGVuQ29sb3IoY29sb3I6IG51bWJlciwgZmFjdG9yOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IHIgPSBNYXRoLm1pbigyNTUsICgoY29sb3IgPj4gMTYpICYgMHhmZikgLyBmYWN0b3IpO1xuICAgIGNvbnN0IGcgPSBNYXRoLm1pbigyNTUsICgoY29sb3IgPj4gOCkgJiAweGZmKSAvIGZhY3Rvcik7XG4gICAgY29uc3QgYiA9IE1hdGgubWluKDI1NSwgKGNvbG9yICYgMHhmZikgLyBmYWN0b3IpO1xuICAgIHJldHVybiAoKHIgPDwgMTYpIHwgKGcgPDwgOCkgfCBiKSA+Pj4gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgdGV4dGFyZWFcbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBsYXlvdXQgZm9yIHRoaXMgdGV4dGFyZWFcbiAgICovXG4gIGxheW91dChhdmFpbGFibGVXaWR0aDogbnVtYmVyLCBhdmFpbGFibGVIZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG5cbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG5cbiAgICAvLyBMYXlvdXQgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZC5sYXlvdXQobWVhc3VyZWQud2lkdGgsIG1lYXN1cmVkLmhlaWdodCk7XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSB0ZXh0YXJlYVxuICAgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICAvLyBSZW5kZXJpbmcgaGFuZGxlZCBieSBiYWNrZ3JvdW5kLCB0ZXh0LCBhbmQgY3Vyc29yXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgdmFsdWUgcHJvZ3JhbW1hdGljYWxseVxuICAgKi9cbiAgc2V0VmFsdWUodmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gdmFsdWU7XG4gICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IHZhbHVlLmxlbmd0aDtcbiAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IHZhbHVlXG4gICAqL1xuICBnZXRWYWx1ZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIHdoZW4gZGVzdHJveWluZ1xuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLnN0b3BDdXJzb3JCbGluaygpO1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleURvd24uYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIHN1cGVyLmRlc3Ryb3koKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgRWRnZUluc2V0cyB9IGZyb20gJy4vZWRnZS1pbnNldHMnO1xuXG4vKipcbiAqIFNpemUgY29uc3RyYWludCB2YWx1ZXMgZm9yIFVJIGNvbXBvbmVudHNcbiAqIENhbiBiZSBhIGZpeGVkIG51bWJlciwgJ2F1dG8nIHRvIGZpdCBjb250ZW50LCBvciAnZmlsbCcgdG8gZXhwYW5kXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCB0eXBlIFNpemVDb25zdHJhaW50ID0gbnVtYmVyIHwgJ2F1dG8nIHwgJ2ZpbGwnO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIGJveCBtb2RlbCBmb3IgYSBVSSBjb21wb25lbnRcbiAqIFNpbWlsYXIgdG8gQ1NTIGJveCBtb2RlbCB3aXRoIHdpZHRoLCBoZWlnaHQsIHBhZGRpbmcsIG1hcmdpbiwgYW5kIGJvcmRlclxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIEJveE1vZGVsIHtcbiAgLy8gQ29udGVudCBhcmVhIGRpbWVuc2lvbnNcbiAgd2lkdGg6IFNpemVDb25zdHJhaW50O1xuICBoZWlnaHQ6IFNpemVDb25zdHJhaW50O1xuXG4gIC8vIFNpemUgY29uc3RyYWludHNcbiAgbWluV2lkdGg/OiBudW1iZXI7XG4gIG1pbkhlaWdodD86IG51bWJlcjtcbiAgbWF4V2lkdGg/OiBudW1iZXI7XG4gIG1heEhlaWdodD86IG51bWJlcjtcblxuICAvLyBTcGFjaW5nXG4gIHBhZGRpbmc6IEVkZ2VJbnNldHM7XG4gIG1hcmdpbjogRWRnZUluc2V0cztcblxuICAvLyBCb3JkZXIgKHZpc3VhbCBib3JkZXIgd2lsbCBiZSBpbXBsZW1lbnRlZCBsYXRlcilcbiAgYm9yZGVyPzogRWRnZUluc2V0cztcbn1cblxuLyoqXG4gKiBUaGUgY29tcHV0ZWQvYWN0dWFsIGxheW91dCBvZiBhIGNvbXBvbmVudCBhZnRlciBtZWFzdXJlbWVudFxuICogQWxsIHZhbHVlcyBhcmUgY29uY3JldGUgcGl4ZWwgdmFsdWVzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcHV0ZWRMYXlvdXQge1xuICAvLyBQb3NpdGlvbiByZWxhdGl2ZSB0byBwYXJlbnRcbiAgeDogbnVtYmVyO1xuICB5OiBudW1iZXI7XG5cbiAgLy8gRmluYWwgZGltZW5zaW9uc1xuICB3aWR0aDogbnVtYmVyO1xuICBoZWlnaHQ6IG51bWJlcjtcblxuICAvLyBDb250ZW50IGFyZWEgKGluc2lkZSBwYWRkaW5nKVxuICBjb250ZW50WDogbnVtYmVyO1xuICBjb250ZW50WTogbnVtYmVyO1xuICBjb250ZW50V2lkdGg6IG51bWJlcjtcbiAgY29udGVudEhlaWdodDogbnVtYmVyO1xufVxuXG4vKipcbiAqIFJlc3VsdCBvZiBtZWFzdXJpbmcgYSBjb21wb25lbnQncyBzaXplXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTWVhc3VyZWRTaXplIHtcbiAgd2lkdGg6IG51bWJlcjtcbiAgaGVpZ2h0OiBudW1iZXI7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGNyZWF0ZSBhIGRlZmF1bHQgQm94TW9kZWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURlZmF1bHRCb3hNb2RlbChvdmVycmlkZXM/OiBQYXJ0aWFsPEJveE1vZGVsPik6IEJveE1vZGVsIHtcbiAgcmV0dXJuIHtcbiAgICB3aWR0aDogJ2F1dG8nLFxuICAgIGhlaWdodDogJ2F1dG8nLFxuICAgIHBhZGRpbmc6IEVkZ2VJbnNldHMuemVybygpLFxuICAgIG1hcmdpbjogRWRnZUluc2V0cy56ZXJvKCksXG4gICAgLi4ub3ZlcnJpZGVzXG4gIH07XG59XG4iLCIvKipcbiAqIFJlcHJlc2VudHMgc3BhY2luZyB2YWx1ZXMgZm9yIHRoZSBlZGdlcyBvZiBhIGJveCAodG9wLCByaWdodCwgYm90dG9tLCBsZWZ0KS5cbiAqIFNpbWlsYXIgdG8gQ1NTIHBhZGRpbmcvbWFyZ2luIHN5bnRheC5cbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGNsYXNzIEVkZ2VJbnNldHMge1xuICAvKipcbiAgICogQ3JlYXRlcyBhbiBFZGdlSW5zZXRzIHdpdGggc3BlY2lmaWMgdmFsdWVzIGZvciBlYWNoIGVkZ2VcbiAgICpcbiAgICogQHBhcmFtIHRvcCAtIFRvcCBlZGdlIHNwYWNpbmdcbiAgICogQHBhcmFtIHJpZ2h0IC0gUmlnaHQgZWRnZSBzcGFjaW5nXG4gICAqIEBwYXJhbSBib3R0b20gLSBCb3R0b20gZWRnZSBzcGFjaW5nXG4gICAqIEBwYXJhbSBsZWZ0IC0gTGVmdCBlZGdlIHNwYWNpbmdcbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyB0b3A6IG51bWJlcixcbiAgICBwdWJsaWMgcmlnaHQ6IG51bWJlcixcbiAgICBwdWJsaWMgYm90dG9tOiBudW1iZXIsXG4gICAgcHVibGljIGxlZnQ6IG51bWJlclxuICApIHt9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgRWRnZUluc2V0cyB3aXRoIHRoZSBzYW1lIHZhbHVlIGZvciBhbGwgZWRnZXNcbiAgICogU2ltaWxhciB0byBDU1M6IHBhZGRpbmc6IDEwcHhcbiAgICpcbiAgICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIHRvIGFwcGx5IHRvIGFsbCBlZGdlc1xuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IHBhZGRpbmcgPSBFZGdlSW5zZXRzLmFsbCgyMCk7IC8vIDIwcHggb24gYWxsIHNpZGVzXG4gICAqIGBgYFxuICAgKi9cbiAgc3RhdGljIGFsbCh2YWx1ZTogbnVtYmVyKTogRWRnZUluc2V0cyB7XG4gICAgcmV0dXJuIG5ldyBFZGdlSW5zZXRzKHZhbHVlLCB2YWx1ZSwgdmFsdWUsIHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIEVkZ2VJbnNldHMgd2l0aCBzeW1tZXRyaWMgdmVydGljYWwgYW5kIGhvcml6b250YWwgdmFsdWVzXG4gICAqIFNpbWlsYXIgdG8gQ1NTOiBwYWRkaW5nOiAxMHB4IDIwcHhcbiAgICpcbiAgICogQHBhcmFtIHZlcnRpY2FsIC0gVmFsdWUgZm9yIHRvcCBhbmQgYm90dG9tIGVkZ2VzXG4gICAqIEBwYXJhbSBob3Jpem9udGFsIC0gVmFsdWUgZm9yIGxlZnQgYW5kIHJpZ2h0IGVkZ2VzXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogY29uc3QgcGFkZGluZyA9IEVkZ2VJbnNldHMuc3ltbWV0cmljKDEwLCAyMCk7IC8vIDEwcHggdG9wL2JvdHRvbSwgMjBweCBsZWZ0L3JpZ2h0XG4gICAqIGBgYFxuICAgKi9cbiAgc3RhdGljIHN5bW1ldHJpYyh2ZXJ0aWNhbDogbnVtYmVyLCBob3Jpem9udGFsOiBudW1iZXIpOiBFZGdlSW5zZXRzIHtcbiAgICByZXR1cm4gbmV3IEVkZ2VJbnNldHModmVydGljYWwsIGhvcml6b250YWwsIHZlcnRpY2FsLCBob3Jpem9udGFsKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIEVkZ2VJbnNldHMgd2l0aCBzcGVjaWZpYyB2YWx1ZXMgZm9yIGluZGl2aWR1YWwgZWRnZXNcbiAgICogU2ltaWxhciB0byBDU1M6IHBhZGRpbmctdG9wLCBwYWRkaW5nLXJpZ2h0LCBldGMuXG4gICAqXG4gICAqIEBwYXJhbSBlZGdlcyAtIE9iamVjdCB3aXRoIG9wdGlvbmFsIHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdCB2YWx1ZXMgKGRlZmF1bHRzIHRvIDApXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogY29uc3QgcGFkZGluZyA9IEVkZ2VJbnNldHMub25seSh7IHRvcDogMTAsIGxlZnQ6IDIwIH0pOyAvLyAxMHB4IHRvcCwgMjBweCBsZWZ0LCAwcHggcmlnaHQvYm90dG9tXG4gICAqIGBgYFxuICAgKi9cbiAgc3RhdGljIG9ubHkoZWRnZXM6IHsgdG9wPzogbnVtYmVyOyByaWdodD86IG51bWJlcjsgYm90dG9tPzogbnVtYmVyOyBsZWZ0PzogbnVtYmVyIH0pOiBFZGdlSW5zZXRzIHtcbiAgICByZXR1cm4gbmV3IEVkZ2VJbnNldHMoXG4gICAgICBlZGdlcy50b3AgPz8gMCxcbiAgICAgIGVkZ2VzLnJpZ2h0ID8/IDAsXG4gICAgICBlZGdlcy5ib3R0b20gPz8gMCxcbiAgICAgIGVkZ2VzLmxlZnQgPz8gMFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBFZGdlSW5zZXRzIHdpdGggemVybyBzcGFjaW5nIG9uIGFsbCBlZGdlc1xuICAgKiBTaW1pbGFyIHRvIENTUzogcGFkZGluZzogMFxuICAgKi9cbiAgc3RhdGljIHplcm8oKTogRWRnZUluc2V0cyB7XG4gICAgcmV0dXJuIG5ldyBFZGdlSW5zZXRzKDAsIDAsIDAsIDApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHRvdGFsIGhvcml6b250YWwgc3BhY2luZyAobGVmdCArIHJpZ2h0KVxuICAgKi9cbiAgZ2V0IGhvcml6b250YWwoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5sZWZ0ICsgdGhpcy5yaWdodDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSB0b3RhbCB2ZXJ0aWNhbCBzcGFjaW5nICh0b3AgKyBib3R0b20pXG4gICAqL1xuICBnZXQgdmVydGljYWwoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy50b3AgKyB0aGlzLmJvdHRvbTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgY29weSBvZiB0aGVzZSBFZGdlSW5zZXRzXG4gICAqL1xuICBjbG9uZSgpOiBFZGdlSW5zZXRzIHtcbiAgICByZXR1cm4gbmV3IEVkZ2VJbnNldHModGhpcy50b3AsIHRoaXMucmlnaHQsIHRoaXMuYm90dG9tLCB0aGlzLmxlZnQpO1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IEJveE1vZGVsLCBDb21wdXRlZExheW91dCwgTWVhc3VyZWRTaXplLCBjcmVhdGVEZWZhdWx0Qm94TW9kZWwgfSBmcm9tICcuL2JveC1tb2RlbCc7XG5cbi8qKlxuICogQmFzZSBhYnN0cmFjdCBjbGFzcyBmb3IgYWxsIFVJIGNvbXBvbmVudHNcbiAqIFByb3ZpZGVzIGJveCBtb2RlbCwgbGF5b3V0LCBhbmQgcmVuZGVyaW5nIGZ1bmN0aW9uYWxpdHlcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFVJQ29tcG9uZW50IHtcbiAgLyoqXG4gICAqIFRoZSBQSVhJIGNvbnRhaW5lciB0aGF0IGhvbGRzIHRoaXMgY29tcG9uZW50J3MgdmlzdWFsIHJlcHJlc2VudGF0aW9uXG4gICAqL1xuICBwdWJsaWMgY29udGFpbmVyOiBQSVhJLkNvbnRhaW5lcjtcblxuICAvKipcbiAgICogVGhlIGJveCBtb2RlbCBkZWZpbmluZyB0aGlzIGNvbXBvbmVudCdzIHNpemluZyBhbmQgc3BhY2luZ1xuICAgKi9cbiAgcHJvdGVjdGVkIGJveE1vZGVsOiBCb3hNb2RlbDtcblxuICAvKipcbiAgICogRm9jdXMgcmluZyBmb3IgdmlzdWFsIGZvY3VzIGluZGljYXRpb25cbiAgICovXG4gIHByb3RlY3RlZCBmb2N1c1Jpbmc/OiBQSVhJLkdyYXBoaWNzO1xuXG4gIC8qKlxuICAgKiBUaGUgY29tcHV0ZWQgbGF5b3V0IGFmdGVyIG1lYXN1cmVtZW50IGFuZCBwb3NpdGlvbmluZ1xuICAgKi9cbiAgcHJvdGVjdGVkIGNvbXB1dGVkTGF5b3V0OiBDb21wdXRlZExheW91dDtcblxuICAvKipcbiAgICogUmVmZXJlbmNlIHRvIHBhcmVudCBjb21wb25lbnQgKGlmIGFueSlcbiAgICovXG4gIHB1YmxpYyBwYXJlbnQ/OiBVSUNvbXBvbmVudDtcblxuICAvKipcbiAgICogV2hldGhlciB0aGlzIGNvbXBvbmVudCBpcyBjdXJyZW50bHkgdmlzaWJsZVxuICAgKi9cbiAgcHVibGljIHZpc2libGU6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoaXMgY29tcG9uZW50IGlzIGVuYWJsZWQgZm9yIGludGVyYWN0aW9uXG4gICAqL1xuICBwdWJsaWMgZW5hYmxlZDogYm9vbGVhbiA9IHRydWU7XG5cbiAgLyoqXG4gICAqIEZsYWcgaW5kaWNhdGluZyBpZiBsYXlvdXQgbmVlZHMgdG8gYmUgcmVjYWxjdWxhdGVkXG4gICAqL1xuICBwcm90ZWN0ZWQgbGF5b3V0RGlydHk6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIC8qKlxuICAgKiBUYWIgaW5kZXggZm9yIGZvY3VzIG9yZGVyICgtMSBtZWFucyBub3QgZm9jdXNhYmxlIGJ5IHRhYilcbiAgICovXG4gIHB1YmxpYyB0YWJJbmRleDogbnVtYmVyID0gLTE7XG5cbiAgLyoqXG4gICAqIEludGVybmFsIGZvY3VzIHN0YXRlXG4gICAqL1xuICBwcm90ZWN0ZWQgZm9jdXNlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKGJveE1vZGVsPzogUGFydGlhbDxCb3hNb2RlbD4pIHtcbiAgICB0aGlzLmNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgIHRoaXMuYm94TW9kZWwgPSBjcmVhdGVEZWZhdWx0Qm94TW9kZWwoYm94TW9kZWwpO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQgPSB7XG4gICAgICB4OiAwLFxuICAgICAgeTogMCxcbiAgICAgIHdpZHRoOiAwLFxuICAgICAgaGVpZ2h0OiAwLFxuICAgICAgY29udGVudFg6IDAsXG4gICAgICBjb250ZW50WTogMCxcbiAgICAgIGNvbnRlbnRXaWR0aDogMCxcbiAgICAgIGNvbnRlbnRIZWlnaHQ6IDBcbiAgICB9O1xuXG4gICAgLy8gQ3JlYXRlIGZvY3VzIHJpbmcgKGluaXRpYWxseSBoaWRkZW4pXG4gICAgdGhpcy5jcmVhdGVGb2N1c1JpbmcoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIHRoZSBmb2N1cyByaW5nIGdyYXBoaWNzXG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZUZvY3VzUmluZygpOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzUmluZyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy5mb2N1c1JpbmcudmlzaWJsZSA9IGZhbHNlO1xuICAgIC8vIEFkZCBhcyBmaXJzdCBjaGlsZCBzbyBpdCByZW5kZXJzIGJlaGluZCBjb250ZW50XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGRBdCh0aGlzLmZvY3VzUmluZywgMCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgZm9jdXMgcmluZyBhcHBlYXJhbmNlIGJhc2VkIG9uIGNvbXBvbmVudCBzaXplXG4gICAqL1xuICBwcm90ZWN0ZWQgdXBkYXRlRm9jdXNSaW5nKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5mb2N1c1JpbmcpIHJldHVybjtcblxuICAgIHRoaXMuZm9jdXNSaW5nLmNsZWFyKCk7XG5cbiAgICBjb25zdCB3aWR0aCA9IHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGg7XG4gICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQ7XG5cbiAgICBpZiAod2lkdGggPD0gMCB8fCBoZWlnaHQgPD0gMCkgcmV0dXJuO1xuXG4gICAgLy8gQW5pbWF0ZWQgcHVsc2luZyBlZmZlY3Qgd2l0aCBkYXNoZWQgb3V0bGluZVxuICAgIGNvbnN0IG9mZnNldCA9IDQ7XG4gICAgY29uc3Qgc3Ryb2tlV2lkdGggPSAzO1xuXG4gICAgLy8gRHJhdyBvdXRlciBnbG93XG4gICAgdGhpcy5mb2N1c1Jpbmcucm91bmRSZWN0KFxuICAgICAgLW9mZnNldCAtIDIsXG4gICAgICAtb2Zmc2V0IC0gMixcbiAgICAgIHdpZHRoICsgKG9mZnNldCArIDIpICogMixcbiAgICAgIGhlaWdodCArIChvZmZzZXQgKyAyKSAqIDIsXG4gICAgICA4XG4gICAgKTtcbiAgICB0aGlzLmZvY3VzUmluZy5zdHJva2Uoe1xuICAgICAgY29sb3I6IDB4MDBkOWZmLFxuICAgICAgd2lkdGg6IHN0cm9rZVdpZHRoICsgMixcbiAgICAgIGFscGhhOiAwLjNcbiAgICB9KTtcblxuICAgIC8vIERyYXcgbWFpbiBmb2N1cyByaW5nXG4gICAgdGhpcy5mb2N1c1Jpbmcucm91bmRSZWN0KFxuICAgICAgLW9mZnNldCxcbiAgICAgIC1vZmZzZXQsXG4gICAgICB3aWR0aCArIG9mZnNldCAqIDIsXG4gICAgICBoZWlnaHQgKyBvZmZzZXQgKiAyLFxuICAgICAgOFxuICAgICk7XG4gICAgdGhpcy5mb2N1c1Jpbmcuc3Ryb2tlKHtcbiAgICAgIGNvbG9yOiAweDAwZDlmZixcbiAgICAgIHdpZHRoOiBzdHJva2VXaWR0aFxuICAgIH0pO1xuXG4gICAgLy8gRHJhdyBpbm5lciBoaWdobGlnaHRcbiAgICB0aGlzLmZvY3VzUmluZy5yb3VuZFJlY3QoXG4gICAgICAtb2Zmc2V0ICsgc3Ryb2tlV2lkdGgsXG4gICAgICAtb2Zmc2V0ICsgc3Ryb2tlV2lkdGgsXG4gICAgICB3aWR0aCArIChvZmZzZXQgLSBzdHJva2VXaWR0aCkgKiAyLFxuICAgICAgaGVpZ2h0ICsgKG9mZnNldCAtIHN0cm9rZVdpZHRoKSAqIDIsXG4gICAgICA2XG4gICAgKTtcbiAgICB0aGlzLmZvY3VzUmluZy5zdHJva2Uoe1xuICAgICAgY29sb3I6IDB4ZmZmZmZmLFxuICAgICAgd2lkdGg6IDEsXG4gICAgICBhbHBoYTogMC42XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgdGhlIHNpemUgdGhpcyBjb21wb25lbnQgbmVlZHNcbiAgICogTXVzdCBiZSBpbXBsZW1lbnRlZCBieSBzdWJjbGFzc2VzXG4gICAqXG4gICAqIEByZXR1cm5zIFRoZSBtZWFzdXJlZCB3aWR0aCBhbmQgaGVpZ2h0XG4gICAqL1xuICBhYnN0cmFjdCBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZTtcblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIGNvbXBvbmVudCB3aXRoaW4gdGhlIGdpdmVuIGF2YWlsYWJsZSBzcGFjZVxuICAgKiBNdXN0IGJlIGltcGxlbWVudGVkIGJ5IHN1YmNsYXNzZXNcbiAgICpcbiAgICogQHBhcmFtIGF2YWlsYWJsZVdpZHRoIC0gQXZhaWxhYmxlIHdpZHRoIGluIHBpeGVsc1xuICAgKiBAcGFyYW0gYXZhaWxhYmxlSGVpZ2h0IC0gQXZhaWxhYmxlIGhlaWdodCBpbiBwaXhlbHNcbiAgICovXG4gIGFic3RyYWN0IGxheW91dChhdmFpbGFibGVXaWR0aDogbnVtYmVyLCBhdmFpbGFibGVIZWlnaHQ6IG51bWJlcik6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIGNvbXBvbmVudCdzIHZpc3VhbHNcbiAgICogQ2FsbGVkIGFmdGVyIGxheW91dCBpcyBjb21wbGV0ZVxuICAgKi9cbiAgcHJvdGVjdGVkIGFic3RyYWN0IHJlbmRlcigpOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBNYXJrcyB0aGlzIGNvbXBvbmVudCdzIGxheW91dCBhcyBkaXJ0eSwgcmVxdWlyaW5nIHJlY2FsY3VsYXRpb25cbiAgICovXG4gIHB1YmxpYyBtYXJrTGF5b3V0RGlydHkoKTogdm9pZCB7XG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IHRydWU7XG4gICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICB0aGlzLnBhcmVudC5tYXJrTGF5b3V0RGlydHkoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY29tcHV0ZWQgbGF5b3V0IG9mIHRoaXMgY29tcG9uZW50XG4gICAqL1xuICBwdWJsaWMgZ2V0TGF5b3V0KCk6IENvbXB1dGVkTGF5b3V0IHtcbiAgICByZXR1cm4gdGhpcy5jb21wdXRlZExheW91dDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBib3ggbW9kZWwgb2YgdGhpcyBjb21wb25lbnRcbiAgICovXG4gIHB1YmxpYyBnZXRCb3hNb2RlbCgpOiBCb3hNb2RlbCB7XG4gICAgcmV0dXJuIHRoaXMuYm94TW9kZWw7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgZ2xvYmFsIGJvdW5kcyBvZiB0aGlzIGNvbXBvbmVudCAocG9zaXRpb24gcmVsYXRpdmUgdG8gc3RhZ2UpXG4gICAqL1xuICBwdWJsaWMgZ2V0R2xvYmFsQm91bmRzKCk6IHsgeDogbnVtYmVyOyB5OiBudW1iZXI7IHdpZHRoOiBudW1iZXI7IGhlaWdodDogbnVtYmVyIH0ge1xuICAgIGNvbnN0IGdsb2JhbFBvcyA9IHRoaXMuY29udGFpbmVyLmdldEdsb2JhbFBvc2l0aW9uKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHg6IGdsb2JhbFBvcy54LFxuICAgICAgeTogZ2xvYmFsUG9zLnksXG4gICAgICB3aWR0aDogdGhpcy5jb21wdXRlZExheW91dC53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHRcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHBvc2l0aW9uIG9mIHRoaXMgY29tcG9uZW50XG4gICAqL1xuICBwdWJsaWMgc2V0UG9zaXRpb24oeDogbnVtYmVyLCB5OiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LnggPSB4O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQueSA9IHk7XG4gICAgdGhpcy5jb250YWluZXIucG9zaXRpb24uc2V0KHgsIHkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNob3dzIHRoaXMgY29tcG9uZW50XG4gICAqL1xuICBwdWJsaWMgc2hvdygpOiB2b2lkIHtcbiAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMuY29udGFpbmVyLnZpc2libGUgPSB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEhpZGVzIHRoaXMgY29tcG9uZW50XG4gICAqL1xuICBwdWJsaWMgaGlkZSgpOiB2b2lkIHtcbiAgICB0aGlzLnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmNvbnRhaW5lci52aXNpYmxlID0gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0aGlzIGNvbXBvbmVudCBjYW4gcmVjZWl2ZSBmb2N1c1xuICAgKi9cbiAgcHVibGljIGNhbkZvY3VzKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmVuYWJsZWQgJiYgdGhpcy52aXNpYmxlICYmIHRoaXMudGFiSW5kZXggPj0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoaXMgY29tcG9uZW50IGlzIGN1cnJlbnRseSBmb2N1c2VkXG4gICAqL1xuICBwdWJsaWMgaXNGb2N1c2VkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmZvY3VzZWQ7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gY29tcG9uZW50IHJlY2VpdmVzIGZvY3VzXG4gICAqIE92ZXJyaWRlIGluIHN1YmNsYXNzZXMgdG8gY3VzdG9taXplIGZvY3VzIGJlaGF2aW9yXG4gICAqL1xuICBwdWJsaWMgb25Gb2N1cygpOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzZWQgPSB0cnVlO1xuICAgIHRoaXMuc2hvd0ZvY3VzUmluZygpO1xuICAgIHRoaXMuc2Nyb2xsSW50b1ZpZXcoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTaG93cyB0aGUgZm9jdXMgcmluZ1xuICAgKi9cbiAgcHJvdGVjdGVkIHNob3dGb2N1c1JpbmcoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNSaW5nKSB7XG4gICAgICB0aGlzLnVwZGF0ZUZvY3VzUmluZygpO1xuICAgICAgdGhpcy5mb2N1c1JpbmcudmlzaWJsZSA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNjcm9sbHMgdGhpcyBjb21wb25lbnQgaW50byB2aWV3IGlmIGl0J3MgaW5zaWRlIGEgc2Nyb2xsIGNvbnRhaW5lclxuICAgKi9cbiAgcHJpdmF0ZSBzY3JvbGxJbnRvVmlldygpOiB2b2lkIHtcbiAgICAvLyBXYWxrIHVwIHRoZSBwYXJlbnQgY2hhaW4gdG8gZmluZCBhIHNjcm9sbCBjb250YWluZXJcbiAgICBsZXQgY3VycmVudFBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgIHdoaWxlIChjdXJyZW50UGFyZW50KSB7XG4gICAgICAvLyBDaGVjayBpZiBwYXJlbnQgaGFzIHNjcm9sbFRvQ29tcG9uZW50IG1ldGhvZCAoZHVjayB0eXBpbmcgZm9yIFVJU2Nyb2xsQ29udGFpbmVyKVxuICAgICAgaWYgKCdzY3JvbGxUb0NvbXBvbmVudCcgaW4gY3VycmVudFBhcmVudCAmJiB0eXBlb2YgKGN1cnJlbnRQYXJlbnQgYXMgYW55KS5zY3JvbGxUb0NvbXBvbmVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAoY3VycmVudFBhcmVudCBhcyBhbnkpLnNjcm9sbFRvQ29tcG9uZW50KHRoaXMpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGN1cnJlbnRQYXJlbnQgPSBjdXJyZW50UGFyZW50LnBhcmVudDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gY29tcG9uZW50IGxvc2VzIGZvY3VzXG4gICAqIE92ZXJyaWRlIGluIHN1YmNsYXNzZXMgdG8gY3VzdG9taXplIGJsdXIgYmVoYXZpb3JcbiAgICovXG4gIHB1YmxpYyBvbkJsdXIoKTogdm9pZCB7XG4gICAgdGhpcy5mb2N1c2VkID0gZmFsc2U7XG4gICAgdGhpcy5oaWRlRm9jdXNSaW5nKCk7XG4gIH1cblxuICAvKipcbiAgICogSGlkZXMgdGhlIGZvY3VzIHJpbmdcbiAgICovXG4gIHByb3RlY3RlZCBoaWRlRm9jdXNSaW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzUmluZykge1xuICAgICAgdGhpcy5mb2N1c1JpbmcudmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZXN0cm95cyB0aGlzIGNvbXBvbmVudCBhbmQgY2xlYW5zIHVwIHJlc291cmNlc1xuICAgKi9cbiAgcHVibGljIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZGVzdHJveSh7IGNoaWxkcmVuOiB0cnVlIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4vdWktY29tcG9uZW50JztcblxuLyoqXG4gKiBJbnRlcmZhY2UgZm9yIGZvY3VzYWJsZSBVSSBjb21wb25lbnRzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRm9jdXNhYmxlIHtcbiAgLyoqIFdoZXRoZXIgdGhpcyBjb21wb25lbnQgY2FuIHJlY2VpdmUgZm9jdXMgKi9cbiAgY2FuRm9jdXMoKTogYm9vbGVhbjtcbiAgLyoqIENhbGxlZCB3aGVuIGNvbXBvbmVudCByZWNlaXZlcyBmb2N1cyAqL1xuICBvbkZvY3VzKCk6IHZvaWQ7XG4gIC8qKiBDYWxsZWQgd2hlbiBjb21wb25lbnQgbG9zZXMgZm9jdXMgKi9cbiAgb25CbHVyKCk6IHZvaWQ7XG4gIC8qKiBUaGUgdGFiIGluZGV4IGZvciBmb2N1cyBvcmRlciAobG93ZXIgdmFsdWVzIGZvY3VzZWQgZmlyc3QpICovXG4gIHRhYkluZGV4OiBudW1iZXI7XG4gIC8qKiBXaGV0aGVyIHRoaXMgY29tcG9uZW50IGlzIGN1cnJlbnRseSBmb2N1c2VkICovXG4gIGlzRm9jdXNlZCgpOiBib29sZWFuO1xufVxuXG4vKipcbiAqIE1hbmFnZXMga2V5Ym9hcmQgZm9jdXMgYW5kIHRhYiBuYXZpZ2F0aW9uIGZvciBVSSBjb21wb25lbnRzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGZvY3VzTWFuYWdlciA9IG5ldyBVSUZvY3VzTWFuYWdlcigpO1xuICogZm9jdXNNYW5hZ2VyLnJlZ2lzdGVyKGJ1dHRvbjEpO1xuICogZm9jdXNNYW5hZ2VyLnJlZ2lzdGVyKHRleHRJbnB1dDEpO1xuICogZm9jdXNNYW5hZ2VyLnJlZ2lzdGVyKGJ1dHRvbjIpO1xuICpcbiAqIC8vIEZvY3VzIGZpcnN0IGNvbXBvbmVudFxuICogZm9jdXNNYW5hZ2VyLmZvY3VzRmlyc3QoKTtcbiAqXG4gKiAvLyBPciBmb2N1cyBzcGVjaWZpYyBjb21wb25lbnRcbiAqIGZvY3VzTWFuYWdlci5mb2N1cyh0ZXh0SW5wdXQxKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlGb2N1c01hbmFnZXIge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogVUlGb2N1c01hbmFnZXIgfCBudWxsID0gbnVsbDtcblxuICBwcml2YXRlIGZvY3VzYWJsZUNvbXBvbmVudHM6IChVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSlbXSA9IFtdO1xuICBwcml2YXRlIGN1cnJlbnRGb2N1c0luZGV4OiBudW1iZXIgPSAtMTtcbiAgcHJpdmF0ZSBrZXlkb3duSGFuZGxlcjogKChlOiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc2V0dXBLZXlib2FyZExpc3RlbmVycygpO1xuICAgIC8vIFNldCBhcyBzaW5nbGV0b24gaW5zdGFuY2VcbiAgICBVSUZvY3VzTWFuYWdlci5pbnN0YW5jZSA9IHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCBnbG9iYWwgZm9jdXMgbWFuYWdlciBpbnN0YW5jZVxuICAgKi9cbiAgc3RhdGljIGdldEluc3RhbmNlKCk6IFVJRm9jdXNNYW5hZ2VyIHwgbnVsbCB7XG4gICAgcmV0dXJuIFVJRm9jdXNNYW5hZ2VyLmluc3RhbmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgZ2xvYmFsIGtleWJvYXJkIGxpc3RlbmVycyBmb3IgdGFiIG5hdmlnYXRpb25cbiAgICovXG4gIHByaXZhdGUgc2V0dXBLZXlib2FyZExpc3RlbmVycygpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybjtcblxuICAgIC8vIFJlbW92ZSBleGlzdGluZyBoYW5kbGVyIGlmIHByZXNlbnQgdG8gcHJldmVudCBkdXBsaWNhdGVzXG4gICAgaWYgKHRoaXMua2V5ZG93bkhhbmRsZXIpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlkb3duSGFuZGxlcik7XG4gICAgfVxuXG4gICAgdGhpcy5rZXlkb3duSGFuZGxlciA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09ICdUYWInKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBpZiAoZS5zaGlmdEtleSkge1xuICAgICAgICAgIHRoaXMuZm9jdXNQcmV2aW91cygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZm9jdXNOZXh0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmtleWRvd25IYW5kbGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlcnMgYSBmb2N1c2FibGUgY29tcG9uZW50XG4gICAqL1xuICByZWdpc3Rlcihjb21wb25lbnQ6IFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMuaW5jbHVkZXMoY29tcG9uZW50KSkge1xuICAgICAgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICAgIHRoaXMuc29ydEJ5VGFiSW5kZXgoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXV0b21hdGljYWxseSBkaXNjb3ZlcnMgYW5kIHJlZ2lzdGVycyBhbGwgZm9jdXNhYmxlIGNvbXBvbmVudHMgaW4gYSBjb250YWluZXJcbiAgICogV2Fsa3MgdGhlIGNvbXBvbmVudCB0cmVlIGFuZCBmaW5kcyBhbGwgY29tcG9uZW50cyB3aXRoIHRhYkluZGV4ID49IDBcbiAgICovXG4gIHJlZ2lzdGVyQ29udGFpbmVyKGNvbnRhaW5lcjogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICB0aGlzLmRpc2NvdmVyRm9jdXNhYmxlQ29tcG9uZW50cyhjb250YWluZXIpO1xuICAgIHRoaXMuc29ydEJ5VGFiSW5kZXgoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWN1cnNpdmVseSBkaXNjb3ZlcnMgZm9jdXNhYmxlIGNvbXBvbmVudHMgaW4gdGhlIHRyZWVcbiAgICovXG4gIHByaXZhdGUgZGlzY292ZXJGb2N1c2FibGVDb21wb25lbnRzKGNvbXBvbmVudDogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICAvLyBDaGVjayBpZiB0aGlzIGNvbXBvbmVudCBpcyBmb2N1c2FibGVcbiAgICBpZiAodGhpcy5pc0ZvY3VzYWJsZUNvbXBvbmVudChjb21wb25lbnQpKSB7XG4gICAgICB0aGlzLnJlZ2lzdGVyKGNvbXBvbmVudCBhcyBVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSk7XG4gICAgfVxuXG4gICAgLy8gUmVjdXJzaXZlbHkgY2hlY2sgY2hpbGRyZW4gKGlmIGl0J3MgYSBjb250YWluZXIgdHlwZSlcbiAgICBpZiAoJ2NoaWxkcmVuJyBpbiBjb21wb25lbnQgJiYgQXJyYXkuaXNBcnJheSgoY29tcG9uZW50IGFzIGFueSkuY2hpbGRyZW4pKSB7XG4gICAgICBjb25zdCBjaGlsZHJlbiA9IChjb21wb25lbnQgYXMgYW55KS5jaGlsZHJlbiBhcyBVSUNvbXBvbmVudFtdO1xuICAgICAgY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB0aGlzLmRpc2NvdmVyRm9jdXNhYmxlQ29tcG9uZW50cyhjaGlsZCkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgYSBjb21wb25lbnQgaW1wbGVtZW50cyB0aGUgRm9jdXNhYmxlIGludGVyZmFjZVxuICAgKi9cbiAgcHJpdmF0ZSBpc0ZvY3VzYWJsZUNvbXBvbmVudChjb21wb25lbnQ6IFVJQ29tcG9uZW50KTogY29tcG9uZW50IGlzIFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlIHtcbiAgICByZXR1cm4gKFxuICAgICAgdHlwZW9mIGNvbXBvbmVudC50YWJJbmRleCA9PT0gJ251bWJlcicgJiZcbiAgICAgIGNvbXBvbmVudC50YWJJbmRleCA+PSAwICYmXG4gICAgICB0eXBlb2YgY29tcG9uZW50LmNhbkZvY3VzID09PSAnZnVuY3Rpb24nICYmXG4gICAgICB0eXBlb2YgY29tcG9uZW50Lm9uRm9jdXMgPT09ICdmdW5jdGlvbicgJiZcbiAgICAgIHR5cGVvZiBjb21wb25lbnQub25CbHVyID09PSAnZnVuY3Rpb24nICYmXG4gICAgICB0eXBlb2YgY29tcG9uZW50LmlzRm9jdXNlZCA9PT0gJ2Z1bmN0aW9uJ1xuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogVW5yZWdpc3RlcnMgYSBmb2N1c2FibGUgY29tcG9uZW50XG4gICAqL1xuICB1bnJlZ2lzdGVyKGNvbXBvbmVudDogVUlDb21wb25lbnQgJiBGb2N1c2FibGUpOiB2b2lkIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5pbmRleE9mKGNvbXBvbmVudCk7XG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgaWYgKGluZGV4ID09PSB0aGlzLmN1cnJlbnRGb2N1c0luZGV4KSB7XG4gICAgICAgIHRoaXMuYmx1cigpO1xuICAgICAgfVxuICAgICAgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICBpZiAodGhpcy5jdXJyZW50Rm9jdXNJbmRleCA+IGluZGV4KSB7XG4gICAgICAgIHRoaXMuY3VycmVudEZvY3VzSW5kZXgtLTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU29ydHMgY29tcG9uZW50cyBieSB0YWIgaW5kZXhcbiAgICovXG4gIHByaXZhdGUgc29ydEJ5VGFiSW5kZXgoKTogdm9pZCB7XG4gICAgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLnNvcnQoKGEsIGIpID0+IGEudGFiSW5kZXggLSBiLnRhYkluZGV4KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb2N1c2VzIGEgc3BlY2lmaWMgY29tcG9uZW50XG4gICAqL1xuICBmb2N1cyhjb21wb25lbnQ6IFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKTogdm9pZCB7XG4gICAgaWYgKCFjb21wb25lbnQuY2FuRm9jdXMoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmluZGV4T2YoY29tcG9uZW50KTtcbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQmx1ciBjdXJyZW50IGZvY3VzXG4gICAgaWYgKHRoaXMuY3VycmVudEZvY3VzSW5kZXggIT09IC0xICYmIHRoaXMuY3VycmVudEZvY3VzSW5kZXggIT09IGluZGV4KSB7XG4gICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzW3RoaXMuY3VycmVudEZvY3VzSW5kZXhdO1xuICAgICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgICAgY3VycmVudC5vbkJsdXIoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGb2N1cyBuZXcgY29tcG9uZW50XG4gICAgdGhpcy5jdXJyZW50Rm9jdXNJbmRleCA9IGluZGV4O1xuICAgIGNvbXBvbmVudC5vbkZvY3VzKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVxdWVzdCBmb2N1cyBmb3IgYSBjb21wb25lbnQgKGNhbGxlZCBieSBjb21wb25lbnRzIHdoZW4gY2xpY2tlZClcbiAgICogVGhpcyBpcyBhIGhlbHBlciB0aGF0IGZpbmRzIHRoZSBjb21wb25lbnQgYW5kIGNhbGxzIGZvY3VzKClcbiAgICovXG4gIHJlcXVlc3RGb2N1cyhjb21wb25lbnQ6IFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKTogdm9pZCB7XG4gICAgdGhpcy5mb2N1cyhjb21wb25lbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEJsdXJzIHRoZSBjdXJyZW50bHkgZm9jdXNlZCBjb21wb25lbnRcbiAgICovXG4gIGJsdXIoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY3VycmVudEZvY3VzSW5kZXggIT09IC0xKSB7XG4gICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzW3RoaXMuY3VycmVudEZvY3VzSW5kZXhdO1xuICAgICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgICAgY3VycmVudC5vbkJsdXIoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY3VycmVudEZvY3VzSW5kZXggPSAtMTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRm9jdXNlcyB0aGUgbmV4dCBjb21wb25lbnQgaW4gdGFiIG9yZGVyXG4gICAqL1xuICBmb2N1c05leHQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIGxldCBuZXh0SW5kZXggPSB0aGlzLmN1cnJlbnRGb2N1c0luZGV4ICsgMTtcbiAgICBsZXQgYXR0ZW1wdHMgPSAwO1xuXG4gICAgLy8gRmluZCBuZXh0IGZvY3VzYWJsZSBjb21wb25lbnRcbiAgICB3aGlsZSAoYXR0ZW1wdHMgPCB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoKSB7XG4gICAgICBpZiAobmV4dEluZGV4ID49IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGgpIHtcbiAgICAgICAgbmV4dEluZGV4ID0gMDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY29tcG9uZW50ID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzW25leHRJbmRleF07XG4gICAgICBpZiAoY29tcG9uZW50ICYmIGNvbXBvbmVudC5jYW5Gb2N1cygpKSB7XG4gICAgICAgIHRoaXMuZm9jdXMoY29tcG9uZW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBuZXh0SW5kZXgrKztcbiAgICAgIGF0dGVtcHRzKys7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZvY3VzZXMgdGhlIHByZXZpb3VzIGNvbXBvbmVudCBpbiB0YWIgb3JkZXJcbiAgICovXG4gIGZvY3VzUHJldmlvdXMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIGxldCBwcmV2SW5kZXggPSB0aGlzLmN1cnJlbnRGb2N1c0luZGV4IC0gMTtcbiAgICBsZXQgYXR0ZW1wdHMgPSAwO1xuXG4gICAgLy8gRmluZCBwcmV2aW91cyBmb2N1c2FibGUgY29tcG9uZW50XG4gICAgd2hpbGUgKGF0dGVtcHRzIDwgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmxlbmd0aCkge1xuICAgICAgaWYgKHByZXZJbmRleCA8IDApIHtcbiAgICAgICAgcHJldkluZGV4ID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmxlbmd0aCAtIDE7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1twcmV2SW5kZXhdO1xuICAgICAgaWYgKGNvbXBvbmVudCAmJiBjb21wb25lbnQuY2FuRm9jdXMoKSkge1xuICAgICAgICB0aGlzLmZvY3VzKGNvbXBvbmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgcHJldkluZGV4LS07XG4gICAgICBhdHRlbXB0cysrO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGb2N1c2VzIHRoZSBmaXJzdCBmb2N1c2FibGUgY29tcG9uZW50XG4gICAqL1xuICBmb2N1c0ZpcnN0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMpIHtcbiAgICAgIGlmIChjb21wb25lbnQuY2FuRm9jdXMoKSkge1xuICAgICAgICB0aGlzLmZvY3VzKGNvbXBvbmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRm9jdXNlcyB0aGUgbGFzdCBmb2N1c2FibGUgY29tcG9uZW50XG4gICAqL1xuICBmb2N1c0xhc3QoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIGZvciAobGV0IGkgPSB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1tpXTtcbiAgICAgIGlmIChjb21wb25lbnQuY2FuRm9jdXMoKSkge1xuICAgICAgICB0aGlzLmZvY3VzKGNvbXBvbmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudGx5IGZvY3VzZWQgY29tcG9uZW50XG4gICAqL1xuICBnZXRDdXJyZW50Rm9jdXMoKTogKFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKSB8IG51bGwge1xuICAgIGlmICh0aGlzLmN1cnJlbnRGb2N1c0luZGV4ID09PSAtMSkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1t0aGlzLmN1cnJlbnRGb2N1c0luZGV4XSB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgYWxsIHJlZ2lzdGVyZWQgZm9jdXNhYmxlIGNvbXBvbmVudHNcbiAgICovXG4gIGdldEZvY3VzYWJsZUNvbXBvbmVudHMoKTogKFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKVtdIHtcbiAgICByZXR1cm4gWy4uLnRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c107XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXJzIGFsbCByZWdpc3RlcmVkIGNvbXBvbmVudHNcbiAgICovXG4gIGNsZWFyKCk6IHZvaWQge1xuICAgIHRoaXMuYmx1cigpO1xuICAgIHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cyA9IFtdO1xuICAgIHRoaXMuY3VycmVudEZvY3VzSW5kZXggPSAtMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIHdoZW4gZGVzdHJveWluZyB0aGUgZm9jdXMgbWFuYWdlclxuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdGhpcy5rZXlkb3duSGFuZGxlcikge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmtleWRvd25IYW5kbGVyKTtcbiAgICB9XG4gICAgdGhpcy5jbGVhcigpO1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcbmltcG9ydCB7IEVkZ2VJbnNldHMgfSBmcm9tICcuLi9jb3JlL2VkZ2UtaW5zZXRzJztcblxuLyoqIEZsZXhib3ggZGlyZWN0aW9uLiAqL1xuZXhwb3J0IGVudW0gRmxleERpcmVjdGlvbiB7XG4gIFJvdyA9ICdyb3cnLCAgICAgICAgICAgICAgLy8gSG9yaXpvbnRhbCwgbGVmdCB0byByaWdodFxuICBSb3dSZXZlcnNlID0gJ3Jvdy1yZXZlcnNlJyxcbiAgQ29sdW1uID0gJ2NvbHVtbicsICAgICAgICAvLyBWZXJ0aWNhbCwgdG9wIHRvIGJvdHRvbVxuICBDb2x1bW5SZXZlcnNlID0gJ2NvbHVtbi1yZXZlcnNlJ1xufVxuXG4vKiogTWFpbiBheGlzIGFsaWdubWVudC4gKi9cbmV4cG9ydCBlbnVtIEZsZXhKdXN0aWZ5IHtcbiAgU3RhcnQgPSAnc3RhcnQnLCAgICAgICAgICAvLyBQYWNrIGl0ZW1zIHRvIHN0YXJ0XG4gIEVuZCA9ICdlbmQnLCAgICAgICAgICAgICAgLy8gUGFjayBpdGVtcyB0byBlbmRcbiAgQ2VudGVyID0gJ2NlbnRlcicsICAgICAgICAvLyBDZW50ZXIgaXRlbXNcbiAgU3BhY2VCZXR3ZWVuID0gJ3NwYWNlLWJldHdlZW4nLCAgLy8gU3BhY2UgYmV0d2VlbiBpdGVtc1xuICBTcGFjZUFyb3VuZCA9ICdzcGFjZS1hcm91bmQnLCAgICAvLyBTcGFjZSBhcm91bmQgaXRlbXNcbiAgU3BhY2VFdmVubHkgPSAnc3BhY2UtZXZlbmx5JyAgICAgLy8gRXZlbiBzcGFjZSBiZXR3ZWVuIGl0ZW1zXG59XG5cbi8qKiBDcm9zcyBheGlzIGFsaWdubWVudC4gKi9cbmV4cG9ydCBlbnVtIEZsZXhBbGlnbiB7XG4gIFN0YXJ0ID0gJ3N0YXJ0JyxcbiAgRW5kID0gJ2VuZCcsXG4gIENlbnRlciA9ICdjZW50ZXInLFxuICBTdHJldGNoID0gJ3N0cmV0Y2gnICAgICAgIC8vIFN0cmV0Y2ggdG8gZmlsbCBjcm9zcyBheGlzXG59XG5cbi8qKiBGbGV4Q29udGFpbmVyIGNvbmZpZ3VyYXRpb24uICovXG5leHBvcnQgaW50ZXJmYWNlIEZsZXhDb250YWluZXJQcm9wcyB7XG4gIGRpcmVjdGlvbj86IEZsZXhEaXJlY3Rpb247XG4gIGp1c3RpZnk/OiBGbGV4SnVzdGlmeTtcbiAgYWxpZ24/OiBGbGV4QWxpZ247XG4gIGdhcD86IG51bWJlcjsgICAgICAgICAgICAgIC8vIFNwYWNlIGJldHdlZW4gY2hpbGRyZW5cbiAgd3JhcD86IGJvb2xlYW47ICAgICAgICAgICAgLy8gQWxsb3cgd3JhcHBpbmcgKFBoYXNlIDIpXG4gIHBhZGRpbmc/OiBFZGdlSW5zZXRzO1xuICB3aWR0aD86IG51bWJlciB8ICdmaWxsJztcbiAgaGVpZ2h0PzogbnVtYmVyIHwgJ2ZpbGwnO1xufVxuXG4vKipcbiAqIEZsZXhib3gtc3R5bGUgbGF5b3V0IGNvbnRhaW5lciBmb3IgYXJyYW5naW5nIFVJIGNvbXBvbmVudHMuXG4gKiBTdXBwb3J0cyByb3cvY29sdW1uIGRpcmVjdGlvbiwgYWxpZ25tZW50LCBqdXN0aWZ5LCBhbmQgZ2Fwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIC8vIEhvcml6b250YWwgcm93IHdpdGggY2VudGVyZWQgaXRlbXNcbiAqIGNvbnN0IHRvb2xiYXIgPSBuZXcgRmxleENvbnRhaW5lcih7XG4gKiAgIGRpcmVjdGlvbjogRmxleERpcmVjdGlvbi5Sb3csXG4gKiAgIGp1c3RpZnk6IEZsZXhKdXN0aWZ5LkNlbnRlcixcbiAqICAgYWxpZ246IEZsZXhBbGlnbi5DZW50ZXIsXG4gKiAgIGdhcDogMTAsXG4gKiAgIHBhZGRpbmc6IEVkZ2VJbnNldHMuYWxsKDIwKVxuICogfSk7XG4gKiB0b29sYmFyLmFkZENoaWxkKGJ1dHRvbjEpO1xuICogdG9vbGJhci5hZGRDaGlsZChidXR0b24yKTtcbiAqIHRvb2xiYXIuYWRkQ2hpbGQoYnV0dG9uMyk7XG4gKlxuICogLy8gVmVydGljYWwgY29sdW1uIHdpdGggc3BhY2UgYmV0d2VlblxuICogY29uc3Qgc2lkZWJhciA9IG5ldyBGbGV4Q29udGFpbmVyKHtcbiAqICAgZGlyZWN0aW9uOiBGbGV4RGlyZWN0aW9uLkNvbHVtbixcbiAqICAganVzdGlmeTogRmxleEp1c3RpZnkuU3BhY2VCZXR3ZWVuLFxuICogICB3aWR0aDogMjAwLFxuICogICBoZWlnaHQ6ICdmaWxsJ1xuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIEZsZXhDb250YWluZXIgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFJlcXVpcmVkPE9taXQ8RmxleENvbnRhaW5lclByb3BzLCAncGFkZGluZycgfCAnd2lkdGgnIHwgJ2hlaWdodCc+PjtcbiAgcHVibGljIGNoaWxkcmVuOiBVSUNvbXBvbmVudFtdID0gW107XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IEZsZXhDb250YWluZXJQcm9wcyA9IHt9KSB7XG4gICAgY29uc3QgYm94TW9kZWw6IFBhcnRpYWw8Qm94TW9kZWw+ID0ge1xuICAgICAgcGFkZGluZzogcHJvcHMucGFkZGluZyA/PyBFZGdlSW5zZXRzLnplcm8oKSxcbiAgICAgIHdpZHRoOiBwcm9wcy53aWR0aCA/PyAnYXV0bycsXG4gICAgICBoZWlnaHQ6IHByb3BzLmhlaWdodCA/PyAnYXV0bydcbiAgICB9O1xuXG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIGRpcmVjdGlvbjogcHJvcHMuZGlyZWN0aW9uID8/IEZsZXhEaXJlY3Rpb24uUm93LFxuICAgICAganVzdGlmeTogcHJvcHMuanVzdGlmeSA/PyBGbGV4SnVzdGlmeS5TdGFydCxcbiAgICAgIGFsaWduOiBwcm9wcy5hbGlnbiA/PyBGbGV4QWxpZ24uU3RhcnQsXG4gICAgICBnYXA6IHByb3BzLmdhcCA/PyAwLFxuICAgICAgd3JhcDogcHJvcHMud3JhcCA/PyBmYWxzZVxuICAgIH07XG4gIH1cblxuICAvKiogQWRkIGNoaWxkIGNvbXBvbmVudC4gKi9cbiAgYWRkQ2hpbGQoY2hpbGQ6IFVJQ29tcG9uZW50KTogdm9pZCB7XG4gICAgY2hpbGQucGFyZW50ID0gdGhpcztcbiAgICB0aGlzLmNoaWxkcmVuLnB1c2goY2hpbGQpO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKGNoaWxkLmNvbnRhaW5lcik7XG4gICAgdGhpcy5tYXJrTGF5b3V0RGlydHkoKTtcbiAgfVxuXG4gIC8qKiBSZW1vdmUgY2hpbGQgY29tcG9uZW50LiAqL1xuICByZW1vdmVDaGlsZChjaGlsZDogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuY2hpbGRyZW4uaW5kZXhPZihjaGlsZCk7XG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlQ2hpbGQoY2hpbGQuY29udGFpbmVyKTtcbiAgICAgIGNoaWxkLnBhcmVudCA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMubWFya0xheW91dERpcnR5KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgaWYgKHRoaXMuY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd2lkdGg6IHBhZGRpbmcuaG9yaXpvbnRhbCxcbiAgICAgICAgaGVpZ2h0OiBwYWRkaW5nLnZlcnRpY2FsXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIE1lYXN1cmUgYWxsIGNoaWxkcmVuXG4gICAgY29uc3QgY2hpbGRTaXplcyA9IHRoaXMuY2hpbGRyZW4ubWFwKGNoaWxkID0+IGNoaWxkLm1lYXN1cmUoKSk7XG4gICAgY29uc3QgeyBkaXJlY3Rpb24sIGdhcCB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuXG4gICAgY29uc3QgaXNSb3cgPSBkaXJlY3Rpb24gPT09IEZsZXhEaXJlY3Rpb24uUm93IHx8IGRpcmVjdGlvbiA9PT0gRmxleERpcmVjdGlvbi5Sb3dSZXZlcnNlO1xuICAgIGNvbnN0IHRvdGFsR2FwID0gZ2FwICogKHRoaXMuY2hpbGRyZW4ubGVuZ3RoIC0gMSk7XG5cbiAgICBsZXQgbWVhc3VyZWRXaWR0aCA9IDA7XG4gICAgbGV0IG1lYXN1cmVkSGVpZ2h0ID0gMDtcblxuICAgIGlmIChpc1Jvdykge1xuICAgICAgLy8gUm93OiBzdW0gd2lkdGhzLCBtYXggaGVpZ2h0XG4gICAgICBtZWFzdXJlZFdpZHRoID0gY2hpbGRTaXplcy5yZWR1Y2UoKHN1bSwgc2l6ZSkgPT4gc3VtICsgc2l6ZS53aWR0aCwgMCkgKyB0b3RhbEdhcDtcbiAgICAgIG1lYXN1cmVkSGVpZ2h0ID0gTWF0aC5tYXgoLi4uY2hpbGRTaXplcy5tYXAoc2l6ZSA9PiBzaXplLmhlaWdodCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDb2x1bW46IG1heCB3aWR0aCwgc3VtIGhlaWdodHNcbiAgICAgIG1lYXN1cmVkV2lkdGggPSBNYXRoLm1heCguLi5jaGlsZFNpemVzLm1hcChzaXplID0+IHNpemUud2lkdGgpKTtcbiAgICAgIG1lYXN1cmVkSGVpZ2h0ID0gY2hpbGRTaXplcy5yZWR1Y2UoKHN1bSwgc2l6ZSkgPT4gc3VtICsgc2l6ZS5oZWlnaHQsIDApICsgdG90YWxHYXA7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiBtZWFzdXJlZFdpZHRoICsgcGFkZGluZy5ob3Jpem9udGFsLFxuICAgICAgaGVpZ2h0OiBtZWFzdXJlZEhlaWdodCArIHBhZGRpbmcudmVydGljYWxcbiAgICB9O1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuICAgIGNvbnN0IHsgZGlyZWN0aW9uLCBqdXN0aWZ5LCBhbGlnbiwgZ2FwIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgLy8gRGV0ZXJtaW5lIGNvbnRhaW5lciBzaXplXG4gICAgbGV0IGNvbnRhaW5lcldpZHRoOiBudW1iZXI7XG4gICAgbGV0IGNvbnRhaW5lckhlaWdodDogbnVtYmVyO1xuXG4gICAgaWYgKHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdmaWxsJykge1xuICAgICAgY29udGFpbmVyV2lkdGggPSBhdmFpbGFibGVXaWR0aDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLndpZHRoID09PSAnbnVtYmVyJykge1xuICAgICAgY29udGFpbmVyV2lkdGggPSB0aGlzLmJveE1vZGVsLndpZHRoO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuICAgICAgY29udGFpbmVyV2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdmaWxsJykge1xuICAgICAgY29udGFpbmVySGVpZ2h0ID0gYXZhaWxhYmxlSGVpZ2h0O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID09PSAnbnVtYmVyJykge1xuICAgICAgY29udGFpbmVySGVpZ2h0ID0gdGhpcy5ib3hNb2RlbC5oZWlnaHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG4gICAgICBjb250YWluZXJIZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGNvbXB1dGVkIGxheW91dFxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBjb250YWluZXJXaWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IGNvbnRhaW5lckhlaWdodDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRYID0gcGFkZGluZy5sZWZ0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFkgPSBwYWRkaW5nLnRvcDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRXaWR0aCA9IGNvbnRhaW5lcldpZHRoIC0gcGFkZGluZy5ob3Jpem9udGFsO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudEhlaWdodCA9IGNvbnRhaW5lckhlaWdodCAtIHBhZGRpbmcudmVydGljYWw7XG5cbiAgICAvLyBMYXlvdXQgY2hpbGRyZW5cbiAgICBpZiAodGhpcy5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmxheW91dENoaWxkcmVuKCk7XG4gICAgfVxuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIHByaXZhdGUgbGF5b3V0Q2hpbGRyZW4oKTogdm9pZCB7XG4gICAgY29uc3QgeyBkaXJlY3Rpb24sIGp1c3RpZnksIGFsaWduLCBnYXAgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICBjb25zdCBjb250ZW50V2lkdGggPSB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRXaWR0aDtcbiAgICBjb25zdCBjb250ZW50SGVpZ2h0ID0gdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50SGVpZ2h0O1xuXG4gICAgY29uc3QgaXNSb3cgPSBkaXJlY3Rpb24gPT09IEZsZXhEaXJlY3Rpb24uUm93IHx8IGRpcmVjdGlvbiA9PT0gRmxleERpcmVjdGlvbi5Sb3dSZXZlcnNlO1xuXG4gICAgLy8gTWVhc3VyZSBjaGlsZHJlblxuICAgIGNvbnN0IGNoaWxkU2l6ZXMgPSB0aGlzLmNoaWxkcmVuLm1hcChjaGlsZCA9PiBjaGlsZC5tZWFzdXJlKCkpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIHRvdGFsIG1haW4gYXhpcyBzaXplXG4gICAgY29uc3QgdG90YWxHYXAgPSBnYXAgKiAodGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxKTtcbiAgICBjb25zdCB0b3RhbENoaWxkU2l6ZSA9IGlzUm93XG4gICAgICA/IGNoaWxkU2l6ZXMucmVkdWNlKChzdW0sIHNpemUpID0+IHN1bSArIHNpemUud2lkdGgsIDApXG4gICAgICA6IGNoaWxkU2l6ZXMucmVkdWNlKChzdW0sIHNpemUpID0+IHN1bSArIHNpemUuaGVpZ2h0LCAwKTtcblxuICAgIGNvbnN0IG1haW5BeGlzU2l6ZSA9IGlzUm93ID8gY29udGVudFdpZHRoIDogY29udGVudEhlaWdodDtcbiAgICBjb25zdCBjcm9zc0F4aXNTaXplID0gaXNSb3cgPyBjb250ZW50SGVpZ2h0IDogY29udGVudFdpZHRoO1xuICAgIGNvbnN0IGZyZWVTcGFjZSA9IG1haW5BeGlzU2l6ZSAtIHRvdGFsQ2hpbGRTaXplIC0gdG90YWxHYXA7XG5cbiAgICAvLyBDYWxjdWxhdGUgc3RhcnRpbmcgcG9zaXRpb24gYmFzZWQgb24ganVzdGlmeVxuICAgIGxldCBtYWluQXhpc09mZnNldCA9IDA7XG4gICAgbGV0IHNwYWNlQmV0d2VlbiA9IDA7XG5cbiAgICBzd2l0Y2ggKGp1c3RpZnkpIHtcbiAgICAgIGNhc2UgRmxleEp1c3RpZnkuU3RhcnQ6XG4gICAgICAgIG1haW5BeGlzT2Zmc2V0ID0gMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEZsZXhKdXN0aWZ5LkVuZDpcbiAgICAgICAgbWFpbkF4aXNPZmZzZXQgPSBmcmVlU3BhY2U7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBGbGV4SnVzdGlmeS5DZW50ZXI6XG4gICAgICAgIG1haW5BeGlzT2Zmc2V0ID0gZnJlZVNwYWNlIC8gMjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEZsZXhKdXN0aWZ5LlNwYWNlQmV0d2VlbjpcbiAgICAgICAgc3BhY2VCZXR3ZWVuID0gdGhpcy5jaGlsZHJlbi5sZW5ndGggPiAxID8gZnJlZVNwYWNlIC8gKHRoaXMuY2hpbGRyZW4ubGVuZ3RoIC0gMSkgOiAwO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgRmxleEp1c3RpZnkuU3BhY2VBcm91bmQ6XG4gICAgICAgIHNwYWNlQmV0d2VlbiA9IGZyZWVTcGFjZSAvIHRoaXMuY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICBtYWluQXhpc09mZnNldCA9IHNwYWNlQmV0d2VlbiAvIDI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBGbGV4SnVzdGlmeS5TcGFjZUV2ZW5seTpcbiAgICAgICAgc3BhY2VCZXR3ZWVuID0gZnJlZVNwYWNlIC8gKHRoaXMuY2hpbGRyZW4ubGVuZ3RoICsgMSk7XG4gICAgICAgIG1haW5BeGlzT2Zmc2V0ID0gc3BhY2VCZXR3ZWVuO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICAvLyBQb3NpdGlvbiBjaGlsZHJlblxuICAgIGxldCBjdXJyZW50UG9zaXRpb24gPSBtYWluQXhpc09mZnNldDtcblxuICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBjaGlsZFNpemUgPSBjaGlsZFNpemVzW2luZGV4XTtcblxuICAgICAgLy8gTGF5b3V0IGNoaWxkXG4gICAgICBjaGlsZC5sYXlvdXQoY2hpbGRTaXplLndpZHRoLCBjaGlsZFNpemUuaGVpZ2h0KTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIGNyb3NzIGF4aXMgcG9zaXRpb24gYmFzZWQgb24gYWxpZ25cbiAgICAgIGxldCBjcm9zc0F4aXNQb3NpdGlvbiA9IDA7XG5cbiAgICAgIHN3aXRjaCAoYWxpZ24pIHtcbiAgICAgICAgY2FzZSBGbGV4QWxpZ24uU3RhcnQ6XG4gICAgICAgICAgY3Jvc3NBeGlzUG9zaXRpb24gPSAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEZsZXhBbGlnbi5FbmQ6XG4gICAgICAgICAgY3Jvc3NBeGlzUG9zaXRpb24gPSBjcm9zc0F4aXNTaXplIC0gKGlzUm93ID8gY2hpbGRTaXplLmhlaWdodCA6IGNoaWxkU2l6ZS53aWR0aCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgRmxleEFsaWduLkNlbnRlcjpcbiAgICAgICAgICBjcm9zc0F4aXNQb3NpdGlvbiA9IChjcm9zc0F4aXNTaXplIC0gKGlzUm93ID8gY2hpbGRTaXplLmhlaWdodCA6IGNoaWxkU2l6ZS53aWR0aCkpIC8gMjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGbGV4QWxpZ24uU3RyZXRjaDpcbiAgICAgICAgICAvLyBTdHJldGNoIGNoaWxkIHRvIGZpbGwgY3Jvc3MgYXhpcyAoaW1wbGVtZW50IGxhdGVyKVxuICAgICAgICAgIGNyb3NzQXhpc1Bvc2l0aW9uID0gMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgLy8gU2V0IGNoaWxkIHBvc2l0aW9uXG4gICAgICBpZiAoaXNSb3cpIHtcbiAgICAgICAgY2hpbGQuc2V0UG9zaXRpb24oXG4gICAgICAgICAgcGFkZGluZy5sZWZ0ICsgY3VycmVudFBvc2l0aW9uLFxuICAgICAgICAgIHBhZGRpbmcudG9wICsgY3Jvc3NBeGlzUG9zaXRpb25cbiAgICAgICAgKTtcbiAgICAgICAgY3VycmVudFBvc2l0aW9uICs9IGNoaWxkU2l6ZS53aWR0aCArIGdhcCArIHNwYWNlQmV0d2VlbjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoaWxkLnNldFBvc2l0aW9uKFxuICAgICAgICAgIHBhZGRpbmcubGVmdCArIGNyb3NzQXhpc1Bvc2l0aW9uLFxuICAgICAgICAgIHBhZGRpbmcudG9wICsgY3VycmVudFBvc2l0aW9uXG4gICAgICAgICk7XG4gICAgICAgIGN1cnJlbnRQb3NpdGlvbiArPSBjaGlsZFNpemUuaGVpZ2h0ICsgZ2FwICsgc3BhY2VCZXR3ZWVuO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIC8vIEZsZXhDb250YWluZXIgaXRzZWxmIGhhcyBubyB2aXN1YWwgcmVwcmVzZW50YXRpb25cbiAgICAvLyBDb3VsZCBhZGQgZGVidWcgYm9yZGVycyBoZXJlIGlmIG5lZWRlZFxuICB9XG59XG4iLCIvKipcbiAqIFBpeGVsLXBlcmZlY3QgZ3JpZCBzeXN0ZW0gZm9yIGNvbnNpc3RlbnQgVUkgbWVhc3VyZW1lbnRzLlxuICogQWxsIG1lYXN1cmVtZW50cyBhcmUgaW4gZ3JpZCB1bml0cyB0aGF0IHNjYWxlIHRvIGFjdHVhbCBwaXhlbHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiAvLyBVc2UgZ2xvYmFsIGhlbHBlcnMgKGRlZmF1bHQgNHggc2NhbGUpXG4gKiBjb25zdCB3aWR0aCA9IHB4KDEwKTsgICAgICAvLyAxMCB1bml0cyA9IDQwcHhcbiAqIGNvbnN0IGdyaWRVbml0cyA9IHVuaXRzKDQwKTsgLy8gNDBweCA9IDEwIHVuaXRzXG4gKlxuICogLy8gQWNjZXNzIGdyaWQgY29uc3RhbnRzXG4gKiBjb25zdCBwYWRkaW5nID0gcHgoR1JJRC5wYWRkaW5nKTsgIC8vIERlZmF1bHQgcGFkZGluZyBpbiBwaXhlbHNcbiAqIGNvbnN0IGdhcCA9IHB4KEdSSUQuZ2FwKTsgICAgICAgICAgLy8gRGVmYXVsdCBnYXAgaW4gcGl4ZWxzXG4gKlxuICogLy8gQ3JlYXRlIGN1c3RvbSBncmlkIHdpdGggZGlmZmVyZW50IHNjYWxlXG4gKiBjb25zdCBncmlkMnggPSBuZXcgUGl4ZWxHcmlkKHsgc2NhbGU6IDIgfSk7XG4gKiBjb25zdCB3aWR0aDJ4ID0gZ3JpZDJ4LnB4KDEwKTsgIC8vIDEwIHVuaXRzID0gMjBweCBhdCAyeFxuICogYGBgXG4gKi9cblxuLyoqIFBpeGVsR3JpZCBjb25maWd1cmF0aW9uLiAqL1xuZXhwb3J0IGludGVyZmFjZSBQaXhlbEdyaWRDb25maWcge1xuICAvKiogQmFzZSBwaXhlbCB1bml0IGF0IDF4IHNjYWxlIChkZWZhdWx0OiAxKSAqL1xuICB1bml0PzogbnVtYmVyO1xuICAvKiogU2NhbGUgbXVsdGlwbGllciBmb3IgYWxsIG1lYXN1cmVtZW50cyAoZGVmYXVsdDogNCkgKi9cbiAgc2NhbGU/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgd2lkdGggaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogMSkgKi9cbiAgYm9yZGVyPzogbnVtYmVyO1xuICAvKiogU3RhbmRhcmQgcGFkZGluZyBpbiBncmlkIHVuaXRzIChkZWZhdWx0OiAxKSAqL1xuICBwYWRkaW5nPzogbnVtYmVyO1xuICAvKiogR2FwIGJldHdlZW4gZWxlbWVudHMgaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogMSkgKi9cbiAgZ2FwPzogbnVtYmVyO1xuICAvKiogTWFyZ2luL3NwYWNpbmcgaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogNSwgZS5nLiwgNSAqIDQgPSAyMHB4KSAqL1xuICBtYXJnaW4/OiBudW1iZXI7XG4gIC8qKiBGb250IHNjYWxlIG11bHRpcGxpZXIgKGRlZmF1bHQ6IDAuMjUsIGUuZy4sIDY0cHggKiAwLjI1ID0gMTZweCkgKi9cbiAgZm9udFNjYWxlPzogbnVtYmVyO1xufVxuXG4vKiogTXVsdGktbGF5ZXIgYm9yZGVyIGNvbmZpZ3VyYXRpb24uICovXG5leHBvcnQgaW50ZXJmYWNlIEJvcmRlckNvbmZpZyB7XG4gIC8qKiBPdXRlciBib3JkZXIgd2lkdGggaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogMSkgKi9cbiAgb3V0ZXI/OiBudW1iZXI7XG4gIC8qKiBNaWRkbGUgYm9yZGVyIHdpZHRoIGluIGdyaWQgdW5pdHMgKGRlZmF1bHQ6IDEpICovXG4gIG1pZGRsZT86IG51bWJlcjtcbiAgLyoqIElubmVyIGJvcmRlciB3aWR0aCBpbiBncmlkIHVuaXRzIChkZWZhdWx0OiAxKSAqL1xuICBpbm5lcj86IG51bWJlcjtcbiAgLyoqIFRvdGFsIGJvcmRlciB3aWR0aCAoY2FsY3VsYXRlZCBhdXRvbWF0aWNhbGx5KSAqL1xuICB0b3RhbD86IG51bWJlcjtcbn1cblxuLyoqIEdyaWQgc3lzdGVtIGNvbnZlcnRpbmcgdW5pdHMgdG8gcGl4ZWxzIGF0IGNvbnNpc3RlbnQgc2NhbGUuICovXG5leHBvcnQgY2xhc3MgUGl4ZWxHcmlkIHtcbiAgcHVibGljIHJlYWRvbmx5IHVuaXQ6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IHNjYWxlOiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSBib3JkZXI6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IHBhZGRpbmc6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IGdhcDogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgbWFyZ2luOiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSBmb250U2NhbGU6IG51bWJlcjtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IFBpeGVsR3JpZENvbmZpZyA9IHt9KSB7XG4gICAgdGhpcy51bml0ID0gY29uZmlnLnVuaXQgPz8gMTtcbiAgICB0aGlzLnNjYWxlID0gY29uZmlnLnNjYWxlID8/IDQ7XG4gICAgdGhpcy5ib3JkZXIgPSBjb25maWcuYm9yZGVyID8/IDE7XG4gICAgdGhpcy5wYWRkaW5nID0gY29uZmlnLnBhZGRpbmcgPz8gMTtcbiAgICB0aGlzLmdhcCA9IGNvbmZpZy5nYXAgPz8gMTtcbiAgICB0aGlzLm1hcmdpbiA9IGNvbmZpZy5tYXJnaW4gPz8gNTsgLy8gNSB1bml0cyAqIDQgc2NhbGUgPSAyMHB4IGRlZmF1bHRcbiAgICAvLyBGb250IHNjYWxlIGlzIHByb3BvcnRpb25hbCB0byBHUklEIHNjYWxlICgwLjI1IGF0IDR4IHNjYWxlKVxuICAgIC8vIEF0IDR4OiA2NHB4ICogMC4yNSA9IDE2cHgsIEF0IDN4OiA2NHB4ICogMC4xODc1ID0gMTJweCwgZXRjLlxuICAgIHRoaXMuZm9udFNjYWxlID0gY29uZmlnLmZvbnRTY2FsZSA/PyAodGhpcy5zY2FsZSAvIDE2KTtcbiAgfVxuXG4gIC8qKiBDb252ZXJ0IGdyaWQgdW5pdHMg4oaSIHBpeGVscy4gKi9cbiAgcHgodW5pdHM6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHVuaXRzICogdGhpcy51bml0ICogdGhpcy5zY2FsZTtcbiAgfVxuXG4gIC8qKiBDb252ZXJ0IHBpeGVscyDihpIgZ3JpZCB1bml0cyAocm91bmRlZCkuICovXG4gIHVuaXRzKHBpeGVsczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5yb3VuZChwaXhlbHMgLyAodGhpcy51bml0ICogdGhpcy5zY2FsZSkpO1xuICB9XG59XG5cbi8qKiBEZWZhdWx0IGdyaWQ6IDR4IHNjYWxlLCAxcHggYmFzZSB1bml0LiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfUElYRUxfR1JJRCA9ICgoKSA9PiB7XG4gIC8vIFRFTVBPUkFSWTogQ2hlY2sgZm9yIHNjYWxlIG92ZXJyaWRlIGluIGxvY2FsU3RvcmFnZVxuICBjb25zdCB0ZW1wU2NhbGUgPSB0eXBlb2YgbG9jYWxTdG9yYWdlICE9PSAndW5kZWZpbmVkJ1xuICAgID8gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RlbXAtZ3JpZC1zY2FsZScpXG4gICAgOiBudWxsO1xuXG4gIGlmICh0ZW1wU2NhbGUpIHtcbiAgICBjb25zdCBzY2FsZSA9IHBhcnNlSW50KHRlbXBTY2FsZSwgMTApO1xuICAgIGlmICghaXNOYU4oc2NhbGUpICYmIHNjYWxlID49IDEgJiYgc2NhbGUgPD0gNCkge1xuICAgICAgcmV0dXJuIG5ldyBQaXhlbEdyaWQoeyBzY2FsZSB9KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmV3IFBpeGVsR3JpZCgpO1xufSkoKTtcblxuLyoqIENvbnZlcnQgZ3JpZCB1bml0cyDihpIgcGl4ZWxzIChkZWZhdWx0IGdyaWQpLiAqL1xuZXhwb3J0IGNvbnN0IHB4ID0gKHVuaXRzOiBudW1iZXIpOiBudW1iZXIgPT4gREVGQVVMVF9QSVhFTF9HUklELnB4KHVuaXRzKTtcblxuLyoqIENvbnZlcnQgcGl4ZWxzIOKGkiBncmlkIHVuaXRzIChkZWZhdWx0IGdyaWQpLiAqL1xuZXhwb3J0IGNvbnN0IHVuaXRzID0gKHBpeGVsczogbnVtYmVyKTogbnVtYmVyID0+IERFRkFVTFRfUElYRUxfR1JJRC51bml0cyhwaXhlbHMpO1xuXG4vKiogRGVmYXVsdCBncmlkIGNvbnN0YW50cy4gKi9cbmV4cG9ydCBjb25zdCBHUklEID0ge1xuICB1bml0OiBERUZBVUxUX1BJWEVMX0dSSUQudW5pdCxcbiAgc2NhbGU6IERFRkFVTFRfUElYRUxfR1JJRC5zY2FsZSxcbiAgYm9yZGVyOiBERUZBVUxUX1BJWEVMX0dSSUQuYm9yZGVyLFxuICBwYWRkaW5nOiBERUZBVUxUX1BJWEVMX0dSSUQucGFkZGluZyxcbiAgZ2FwOiBERUZBVUxUX1BJWEVMX0dSSUQuZ2FwLFxuICBtYXJnaW46IERFRkFVTFRfUElYRUxfR1JJRC5tYXJnaW4sXG4gIGZvbnRTY2FsZTogREVGQVVMVF9QSVhFTF9HUklELmZvbnRTY2FsZVxufSBhcyBjb25zdDtcblxuLyoqIERlZmF1bHQgdHJpcGxlIGJvcmRlciAob3V0ZXIvbWlkZGxlL2lubmVyKS4gKi9cbmV4cG9ydCBjb25zdCBCT1JERVIgPSB7XG4gIG91dGVyOiAxLCAgIC8vIE91dGVyIGJvcmRlciAoMSBncmlkIHVuaXQpXG4gIG1pZGRsZTogMSwgIC8vIE1pZGRsZSBib3JkZXIgKDEgZ3JpZCB1bml0KVxuICBpbm5lcjogMSwgICAvLyBJbm5lciBib3JkZXIgKDEgZ3JpZCB1bml0KVxuICB0b3RhbDogMyAgICAvLyBUb3RhbCBib3JkZXIgd2lkdGggKDMgZ3JpZCB1bml0cylcbn0gYXMgY29uc3Q7XG5cbi8qKiBDcmVhdGUgY3VzdG9tIGJvcmRlciBjb25maWcgd2l0aCBjYWxjdWxhdGVkIHRvdGFsLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJvcmRlckNvbmZpZyhjb25maWc6IEJvcmRlckNvbmZpZyA9IHt9KTogUmVxdWlyZWQ8Qm9yZGVyQ29uZmlnPiB7XG4gIGNvbnN0IG91dGVyID0gY29uZmlnLm91dGVyID8/IDE7XG4gIGNvbnN0IG1pZGRsZSA9IGNvbmZpZy5taWRkbGUgPz8gMTtcbiAgY29uc3QgaW5uZXIgPSBjb25maWcuaW5uZXIgPz8gMTtcbiAgY29uc3QgdG90YWwgPSBvdXRlciArIG1pZGRsZSArIGlubmVyO1xuXG4gIHJldHVybiB7XG4gICAgb3V0ZXIsXG4gICAgbWlkZGxlLFxuICAgIGlubmVyLFxuICAgIHRvdGFsXG4gIH07XG59XG4iLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfcGl4aV9qc19fOyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oXCIuL3NyYy9pbmRleC50c1wiKTtcbiIsIiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==