# @moxijs/ui

> UI component library for PIXI.js games with theming and flexbox layout.

## Install

```bash
npm install @moxijs/ui pixi.js
```

## Quick Start

```ts
import { FlexContainer, FlexDirection, UIButton, UILabel, EdgeInsets } from '@moxijs/ui';

const container = new FlexContainer({
  direction: FlexDirection.Column,
  gap: 16,
  padding: EdgeInsets.all(20),
});

container.addChild(new UILabel({ text: 'Welcome!', fontSize: 24 }));
container.addChild(new UIButton({
  label: 'Start',
  width: 150,
  height: 40,
  onClick: () => console.log('Clicked!'),
}));

container.layout(800, 600);
stage.addChild(container.container);
```

## Layout

### FlexContainer
Flexbox-style layout container.

```ts
const row = new FlexContainer({
  direction: FlexDirection.Row,       // Row | Column
  justify: FlexJustify.SpaceBetween,  // Start | End | Center | SpaceBetween | SpaceAround
  align: FlexAlign.Center,            // Start | End | Center | Stretch
  gap: 8,
  padding: EdgeInsets.symmetric(16, 24),
  backgroundColor: 0x333333,
});
row.addChild(child1);
row.addChild(child2);
row.layout(width, height);
```

### EdgeInsets
Padding/margin helper.

```ts
EdgeInsets.all(16);                     // All sides
EdgeInsets.symmetric(8, 16);            // Vertical, Horizontal
EdgeInsets.only({ top: 10, left: 20 }); // Specific sides
EdgeInsets.zero();                      // No padding
```

## Components

### UIButton

```ts
const button = new UIButton({
  label: 'Click Me',
  width: 120,
  height: 40,
  backgroundColor: 0x4a90e2,
  textColor: 0xffffff,
  onClick: () => {},
  onHover: () => {},
});
```

### UILabel

```ts
const label = new UILabel({
  text: 'Hello',
  fontSize: 16,
  color: 0xffffff,
  fontFamily: 'Arial',
  align: 'center',  // 'left' | 'center' | 'right'
});
label.setText('Updated');
label.setColor(0xff0000);
```

### UITextInput

```ts
const input = new UITextInput({
  width: 200,
  height: 32,
  placeholder: 'Enter text...',
  value: '',
  onChange: (value) => {},
});
input.getValue();
input.setValue('new value');
```

### UITextArea

```ts
const textarea = new UITextArea({
  width: 300,
  height: 100,
  placeholder: 'Description...',
  onChange: (value) => {},
});
```

### UICheckbox

```ts
const checkbox = new UICheckbox({
  checked: false,
  size: 20,
  onChange: (checked) => {},
});
```

### UIRadioGroup

```ts
const radio = new UIRadioGroup({
  options: [
    { value: 'a', label: 'Option A' },
    { value: 'b', label: 'Option B' },
  ],
  value: 'a',
  direction: 'vertical',
  onChange: (value) => {},
});
```

### UISelect

```ts
const select = new UISelect({
  width: 200,
  options: [
    { value: 'opt1', label: 'Option 1' },
    { value: 'opt2', label: 'Option 2' },
  ],
  value: 'opt1',
  onChange: (value) => {},
});
```

### UIPanel

```ts
const panel = new UIPanel({
  width: 300,
  height: 200,
  backgroundColor: 0x222222,
  borderRadius: 8,
  borderColor: 0x444444,
  borderWidth: 1,
});
```

### UITabs

```ts
const tabs = new UITabs({
  width: 400,
  height: 300,
  items: [
    { key: 'tab1', label: 'Tab 1', content: panel1 },
    { key: 'tab2', label: 'Tab 2', content: panel2 },
  ],
  activeKey: 'tab1',
  onChange: (key) => {},
});
```

### UIScrollContainer

```ts
const scroll = new UIScrollContainer({
  width: 300,
  height: 400,
  scrollbarWidth: 12,
});
scroll.setContent(content);
scroll.scrollTo(y);
scroll.scrollToBottom();
```

### CardPanel

```ts
const card = new CardPanel({
  title: 'Settings',
  width: 300,
  height: 200,
});
card.body.addChild(content);
```

## Theming

### ThemeManager

```ts
import { ThemeManager, createDefaultDarkTheme, createDefaultLightTheme } from '@moxijs/ui';

const manager = new ThemeManager('app-theme');
manager.registerTheme({ name: 'Dark', variant: 'dark', theme: createDefaultDarkTheme() });
manager.registerTheme({ name: 'Light', variant: 'light', theme: createDefaultLightTheme() });
manager.setTheme('Dark');
manager.addListener((theme, info) => { /* rebuild UI */ });
```

### ThemeResolver

```ts
import { ThemeResolver } from '@moxijs/ui';

const resolver = new ThemeResolver(manager.getTheme());

// Pass to components for automatic theming
const button = new UIButton({ themeResolver: resolver, label: 'OK' });
const input = new UITextInput({ themeResolver: resolver });
```

## Focus Management

```ts
import { UIFocusManager } from '@moxijs/ui';

const focus = new UIFocusManager();
focus.register(input1);
focus.register(input2);
focus.focusFirst();
focus.focusNext();  // Tab navigation
```

## UILayer & Scaling

```ts
import { UILayer, UIScaleMode } from '@moxijs/ui';

const ui = new UILayer({
  scaleMode: UIScaleMode.LockRatio,  // None | ScaleUI | LockRatio
  targetWidth: 1280,
  targetHeight: 720,
});
stage.addChild(ui);
```

## Font Standardization

All text components support unified font configuration with inheritance:

```ts
import { Assets } from 'pixi.js';
import { FontType, UIFontConfig } from '@moxijs/ui';

// Load MSDF font (requires .fnt extension for PixiJS v8)
await Assets.load({ alias: 'GameFont', src: 'fonts/GameFont.fnt' });

// Set font at container - all children inherit
const container = new FlexContainer({
  fontFamily: 'GameFont',
  fontType: 'msdf' as FontType,  // 'canvas' | 'msdf' | 'bitmap'
  direction: FlexDirection.Column
});

// Children automatically inherit font settings
container.addChild(new UILabel({ text: 'Title' }));
container.addChild(new UIButton({ label: 'Click' }));
container.addChild(new UITextInput({ placeholder: 'Name' }));
```

## Common Patterns

### Game HUD with MSDF Fonts
```ts
await Assets.load({ alias: 'UI-Font', src: 'fonts/PixelOperator8.fnt' });

const hud = new FlexContainer({
  direction: FlexDirection.Row,
  justify: FlexJustify.SpaceBetween,
  fontFamily: 'PixelOperator8',
  fontType: 'msdf',
  padding: EdgeInsets.all(20)
});

const score = new UILabel({ text: 'Score: 0', fontSize: 16 });
const lives = new UILabel({ text: '❤️ × 3', fontSize: 16 });

hud.addChild(score);
hud.addChild(lives);

// Update in game loop
game.on('scoreChange', (s) => score.setText(`Score: ${s}`));
```

### Settings Form with Validation
```ts
const form = new FlexContainer({
  direction: FlexDirection.Column,
  gap: 15,
  padding: EdgeInsets.all(20)
});

const volumeSlider = new UISelect({
  width: 200,
  options: [
    { value: '0', label: 'Muted' },
    { value: '50', label: 'Medium' },
    { value: '100', label: 'Max' }
  ],
  value: '50',
  onChange: (val) => setVolume(parseInt(val))
});

const graphicsSelect = new UIRadioGroup({
  options: [
    { value: 'low', label: 'Low' },
    { value: 'high', label: 'High' }
  ],
  value: 'high',
  onChange: (val) => setGraphicsQuality(val)
});

form.addChild(new UILabel({ text: 'Volume:' }));
form.addChild(volumeSlider);
form.addChild(new UILabel({ text: 'Graphics:' }));
form.addChild(graphicsSelect);
```

### Dialog/Modal Panel
```ts
const modal = new CardPanel({
  title: 'Confirm Action',
  width: 400,
  height: 250,
  backgroundColor: 0x1e1e1e,
  borderRadius: 12
});

const message = new UILabel({
  text: 'Are you sure you want to quit?',
  fontSize: 14,
  align: 'center',
  wordWrap: true,
  wordWrapWidth: 350
});

const buttons = new FlexContainer({
  direction: FlexDirection.Row,
  justify: FlexJustify.Center,
  gap: 10
});

buttons.addChild(new UIButton({
  label: 'Cancel',
  width: 100,
  onClick: () => modal.destroy()
}));

buttons.addChild(new UIButton({
  label: 'Quit',
  width: 100,
  backgroundColor: 0xff4444,
  onClick: () => quitGame()
}));

modal.body.addChild(message);
modal.body.addChild(buttons.container);
```

### Inventory Grid
```ts
const inventory = new FlexContainer({
  direction: FlexDirection.Row,
  gap: 8,
  padding: EdgeInsets.all(10),
  backgroundColor: 0x2d2d44,
  flexWrap: 'wrap'  // Grid-like behavior
});

for (let i = 0; i < 20; i++) {
  const slot = new UIPanel({
    width: 64,
    height: 64,
    backgroundColor: 0x3d3d54,
    borderRadius: 4
  });
  
  slot.container.eventMode = 'static';
  slot.container.cursor = 'pointer';
  slot.container.on('pointerdown', () => selectItem(i));
  
  inventory.addChild(slot);
}
```

### Tab-Based UI
```ts
const tabs = new UITabs({
  width: 800,
  height: 600,
  fontFamily: 'PixelOperator8',
  fontType: 'msdf',
  items: [
    { key: 'inventory', label: 'Inventory', content: inventoryPanel },
    { key: 'skills', label: 'Skills', content: skillsPanel },
    { key: 'map', label: 'Map', content: mapPanel }
  ],
  defaultActiveKey: 'inventory',
  hashPrefix: 'game-ui',  // URL: #game-ui/inventory
  onChange: (key) => console.log('Tab:', key)
});
```

### Scrollable Chat Log
```ts
const chat = new UIScrollContainer({
  width: 300,
  height: 400,
  scrollDirection: 'vertical',
  backgroundColor: 0x1e1e1e,
  scrollbarWidth: 8
});

function addMessage(text: string) {
  const msg = new UILabel({
    text,
    fontSize: 12,
    wordWrap: true,
    wordWrapWidth: 280,
    padding: EdgeInsets.all(8)
  });
  chat.addChild(msg);
  chat.scrollToBottom();
}

game.on('chat', (msg) => addMessage(msg));
```

## Exports Summary

**Layout:** `FlexContainer`, `FlexDirection`, `FlexJustify`, `FlexAlign`, `EdgeInsets`, `BoxModel`

**Components:** `UIButton`, `UILabel`, `UIPanel`, `UITextInput`, `UITextArea`, `UICheckbox`, `UIRadioGroup`, `UISelect`, `UITabs`, `UIScrollContainer`, `CardPanel`

**Theming:** `ThemeManager`, `ThemeResolver`, `createDefaultDarkTheme`, `createDefaultLightTheme`

**Base:** `UIComponent`, `UIFocusManager`, `UILayer`, `UIScaleMode`

**Fonts:** `FontType`, `FontProps`, `UIFontConfig`

## See Also

- **@moxijs/core** - Game engine, physics, entity system
- **Docs:** https://ineffably.github.io/moxijs/docs/ui/
- **Examples:** https://ineffably.github.io/moxijs/
