(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("pixi.js"));
	else if(typeof define === 'function' && define.amd)
		define(["pixi.js"], factory);
	else if(typeof exports === 'object')
		exports["moxi"] = factory(require("pixi.js"));
	else
		root["moxi"] = factory(root["PIXI"]);
})(self, (__WEBPACK_EXTERNAL_MODULE_pixi_js__) => {
return /******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js":
/*!**************************************************************************!*\
  !*** ../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js ***!
  \**************************************************************************/
/***/ ((module) => {

/* Font Face Observer v2.3.0 - Â© Bram Stein. License: BSD-3-Clause */(function(){function p(a,c){document.addEventListener?a.addEventListener("scroll",c,!1):a.attachEvent("scroll",c)}function u(a){document.body?a():document.addEventListener?document.addEventListener("DOMContentLoaded",function b(){document.removeEventListener("DOMContentLoaded",b);a()}):document.attachEvent("onreadystatechange",function g(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",g),a()})};function w(a){this.g=document.createElement("div");this.g.setAttribute("aria-hidden","true");this.g.appendChild(document.createTextNode(a));this.h=document.createElement("span");this.i=document.createElement("span");this.m=document.createElement("span");this.j=document.createElement("span");this.l=-1;this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.h.appendChild(this.m);this.i.appendChild(this.j);this.g.appendChild(this.h);this.g.appendChild(this.i)}
function x(a,c){a.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+c+";"}function B(a){var c=a.g.offsetWidth,b=c+100;a.j.style.width=b+"px";a.i.scrollLeft=b;a.h.scrollLeft=a.h.scrollWidth+100;return a.l!==c?(a.l=c,!0):!1}function C(a,c){function b(){var e=g;B(e)&&null!==e.g.parentNode&&c(e.l)}var g=a;p(a.h,b);p(a.i,b);B(a)};function D(a,c,b){c=c||{};b=b||window;this.family=a;this.style=c.style||"normal";this.weight=c.weight||"normal";this.stretch=c.stretch||"normal";this.context=b}var E=null,F=null,G=null,H=null;function I(a){null===F&&(M(a)&&/Apple/.test(window.navigator.vendor)?(a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),F=!!a&&603>parseInt(a[1],10)):F=!1);return F}function M(a){null===H&&(H=!!a.document.fonts);return H}
function N(a,c){var b=a.style,g=a.weight;if(null===G){var e=document.createElement("div");try{e.style.font="condensed 100px sans-serif"}catch(q){}G=""!==e.style.font}return[b,g,G?a.stretch:"","100px",c].join(" ")}
D.prototype.load=function(a,c){var b=this,g=a||"BESbswy",e=0,q=c||3E3,J=(new Date).getTime();return new Promise(function(K,L){if(M(b.context)&&!I(b.context)){var O=new Promise(function(r,t){function h(){(new Date).getTime()-J>=q?t(Error(""+q+"ms timeout exceeded")):b.context.document.fonts.load(N(b,'"'+b.family+'"'),g).then(function(n){1<=n.length?r():setTimeout(h,25)},t)}h()}),P=new Promise(function(r,t){e=setTimeout(function(){t(Error(""+q+"ms timeout exceeded"))},q)});Promise.race([P,O]).then(function(){clearTimeout(e);
K(b)},L)}else u(function(){function r(){var d;if(d=-1!=k&&-1!=l||-1!=k&&-1!=m||-1!=l&&-1!=m)(d=k!=l&&k!=m&&l!=m)||(null===E&&(d=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),E=!!d&&(536>parseInt(d[1],10)||536===parseInt(d[1],10)&&11>=parseInt(d[2],10))),d=E&&(k==y&&l==y&&m==y||k==z&&l==z&&m==z||k==A&&l==A&&m==A)),d=!d;d&&(null!==f.parentNode&&f.parentNode.removeChild(f),clearTimeout(e),K(b))}function t(){if((new Date).getTime()-J>=q)null!==f.parentNode&&f.parentNode.removeChild(f),
L(Error(""+q+"ms timeout exceeded"));else{var d=b.context.document.hidden;if(!0===d||void 0===d)k=h.g.offsetWidth,l=n.g.offsetWidth,m=v.g.offsetWidth,r();e=setTimeout(t,50)}}var h=new w(g),n=new w(g),v=new w(g),k=-1,l=-1,m=-1,y=-1,z=-1,A=-1,f=document.createElement("div");f.dir="ltr";x(h,N(b,"sans-serif"));x(n,N(b,"serif"));x(v,N(b,"monospace"));f.appendChild(h.g);f.appendChild(n.g);f.appendChild(v.g);b.context.document.body.appendChild(f);y=h.g.offsetWidth;z=n.g.offsetWidth;A=v.g.offsetWidth;t();
C(h,function(d){k=d;r()});x(h,N(b,'"'+b.family+'",sans-serif'));C(n,function(d){l=d;r()});x(n,N(b,'"'+b.family+'",serif'));C(v,function(d){m=d;r()});x(v,N(b,'"'+b.family+'",monospace'))})})}; true?module.exports=D:(0);}());


/***/ }),

/***/ "../../node_modules/planck/dist/planck.js":
/*!************************************************!*\
  !*** ../../node_modules/planck/dist/planck.js ***!
  \************************************************/
/***/ (function(__unused_webpack_module, exports) {

(function(global, factory) {
   true ? factory(exports) : 0;
})(this, function(exports2) {
  "use strict";/**
 * Planck.js v1.4.2
 * @license The MIT license
 * @copyright Copyright (c) 2025 Erin Catto, Ali Shakiba
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

  /*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */
  var extendStatics = function(d2, b2) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d3, b3) {
      d3.__proto__ = b3;
    } || function(d3, b3) {
      for (var p in b3) if (Object.prototype.hasOwnProperty.call(b3, p)) d3[p] = b3[p];
    };
    return extendStatics(d2, b2);
  };
  function __extends(d2, b2) {
    if (typeof b2 !== "function" && b2 !== null)
      throw new TypeError("Class extends value " + String(b2) + " is not a constructor or null");
    extendStatics(d2, b2);
    function __() {
      this.constructor = d2;
    }
    d2.prototype = b2 === null ? Object.create(b2) : (__.prototype = b2.prototype, new __());
  }
  var __assign = function() {
    __assign = Object.assign || function __assign2(t) {
      for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
        s2 = arguments[i];
        for (var p in s2) if (Object.prototype.hasOwnProperty.call(s2, p)) t[p] = s2[p];
      }
      return t;
    };
    return __assign.apply(this, arguments);
  };
  var options = function(input2, defaults) {
    if (input2 === null || typeof input2 === "undefined") {
      input2 = {};
    }
    var output2 = __assign({}, input2);
    for (var key in defaults) {
      if (defaults.hasOwnProperty(key) && typeof input2[key] === "undefined") {
        output2[key] = defaults[key];
      }
    }
    if (typeof Object.getOwnPropertySymbols === "function") {
      var symbols = Object.getOwnPropertySymbols(defaults);
      for (var i = 0; i < symbols.length; i++) {
        var symbol = symbols[i];
        if (defaults.propertyIsEnumerable(symbol) && typeof input2[symbol] === "undefined") {
          output2[symbol] = defaults[symbol];
        }
      }
    }
    return output2;
  };
  var math_random = Math.random;
  var EPSILON = 1e-9;
  var isFinite = Number.isFinite;
  function nextPowerOfTwo(x2) {
    x2 |= x2 >> 1;
    x2 |= x2 >> 2;
    x2 |= x2 >> 4;
    x2 |= x2 >> 8;
    x2 |= x2 >> 16;
    return x2 + 1;
  }
  function isPowerOfTwo(x2) {
    return x2 > 0 && (x2 & x2 - 1) === 0;
  }
  function mod(num, min, max) {
    if (typeof min === "undefined") {
      max = 1;
      min = 0;
    } else if (typeof max === "undefined") {
      max = min;
      min = 0;
    }
    if (max > min) {
      num = (num - min) % (max - min);
      return num + (num < 0 ? max : min);
    } else {
      num = (num - max) % (min - max);
      return num + (num <= 0 ? min : max);
    }
  }
  function clamp(num, min, max) {
    if (num < min) {
      return min;
    } else if (num > max) {
      return max;
    } else {
      return num;
    }
  }
  function random(min, max) {
    if (typeof min === "undefined") {
      max = 1;
      min = 0;
    } else if (typeof max === "undefined") {
      max = min;
      min = 0;
    }
    return min === max ? min : math_random() * (max - min) + min;
  }
  var math = Object.create(Math);
  math.EPSILON = EPSILON;
  math.isFinite = isFinite;
  math.nextPowerOfTwo = nextPowerOfTwo;
  math.isPowerOfTwo = isPowerOfTwo;
  math.mod = mod;
  math.clamp = clamp;
  math.random = random;
  var math_abs$9 = Math.abs;
  var math_sqrt$5 = Math.sqrt;
  var math_max$8 = Math.max;
  var math_min$8 = Math.min;
  var Vec2 = (
    /** @class */
    function() {
      function Vec22(x2, y) {
        if (!(this instanceof Vec22)) {
          return new Vec22(x2, y);
        }
        if (typeof x2 === "undefined") {
          this.x = 0;
          this.y = 0;
        } else if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
        } else {
          this.x = x2;
          this.y = y;
        }
      }
      Vec22.prototype._serialize = function() {
        return {
          x: this.x,
          y: this.y
        };
      };
      Vec22._deserialize = function(data) {
        var obj = Object.create(Vec22.prototype);
        obj.x = data.x;
        obj.y = data.y;
        return obj;
      };
      Vec22.zero = function() {
        var obj = Object.create(Vec22.prototype);
        obj.x = 0;
        obj.y = 0;
        return obj;
      };
      Vec22.neo = function(x2, y) {
        var obj = Object.create(Vec22.prototype);
        obj.x = x2;
        obj.y = y;
        return obj;
      };
      Vec22.clone = function(v3) {
        return Vec22.neo(v3.x, v3.y);
      };
      Vec22.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Vec22.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.x) && Number.isFinite(obj.y);
      };
      Vec22.assert = function(o) {
      };
      Vec22.prototype.clone = function() {
        return Vec22.clone(this);
      };
      Vec22.prototype.setZero = function() {
        this.x = 0;
        this.y = 0;
        return this;
      };
      Vec22.prototype.set = function(x2, y) {
        if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
        } else {
          this.x = x2;
          this.y = y;
        }
        return this;
      };
      Vec22.prototype.setNum = function(x2, y) {
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.setVec2 = function(value) {
        this.x = value.x;
        this.y = value.y;
        return this;
      };
      Vec22.prototype.wSet = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.setCombine(a2, v3, b2, w);
        } else {
          return this.setMul(a2, v3);
        }
      };
      Vec22.prototype.setCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.setMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.add = function(w) {
        this.x += w.x;
        this.y += w.y;
        return this;
      };
      Vec22.prototype.wAdd = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.addCombine(a2, v3, b2, w);
        } else {
          return this.addMul(a2, v3);
        }
      };
      Vec22.prototype.addCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x += x2;
        this.y += y;
        return this;
      };
      Vec22.prototype.addMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x += x2;
        this.y += y;
        return this;
      };
      Vec22.prototype.wSub = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.subCombine(a2, v3, b2, w);
        } else {
          return this.subMul(a2, v3);
        }
      };
      Vec22.prototype.subCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x -= x2;
        this.y -= y;
        return this;
      };
      Vec22.prototype.subMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x -= x2;
        this.y -= y;
        return this;
      };
      Vec22.prototype.sub = function(w) {
        this.x -= w.x;
        this.y -= w.y;
        return this;
      };
      Vec22.prototype.mul = function(m) {
        this.x *= m;
        this.y *= m;
        return this;
      };
      Vec22.prototype.length = function() {
        return Vec22.lengthOf(this);
      };
      Vec22.prototype.lengthSquared = function() {
        return Vec22.lengthSquared(this);
      };
      Vec22.prototype.normalize = function() {
        var length = this.length();
        if (length < EPSILON) {
          return 0;
        }
        var invLength = 1 / length;
        this.x *= invLength;
        this.y *= invLength;
        return length;
      };
      Vec22.normalize = function(v3) {
        var length = Vec22.lengthOf(v3);
        if (length < EPSILON) {
          return Vec22.zero();
        }
        var invLength = 1 / length;
        return Vec22.neo(v3.x * invLength, v3.y * invLength);
      };
      Vec22.lengthOf = function(v3) {
        return math_sqrt$5(v3.x * v3.x + v3.y * v3.y);
      };
      Vec22.lengthSquared = function(v3) {
        return v3.x * v3.x + v3.y * v3.y;
      };
      Vec22.distance = function(v3, w) {
        var dx = v3.x - w.x;
        var dy = v3.y - w.y;
        return math_sqrt$5(dx * dx + dy * dy);
      };
      Vec22.distanceSquared = function(v3, w) {
        var dx = v3.x - w.x;
        var dy = v3.y - w.y;
        return dx * dx + dy * dy;
      };
      Vec22.areEqual = function(v3, w) {
        return v3 === w || typeof w === "object" && w !== null && v3.x === w.x && v3.y === w.y;
      };
      Vec22.skew = function(v3) {
        return Vec22.neo(-v3.y, v3.x);
      };
      Vec22.dot = function(v3, w) {
        return v3.x * w.x + v3.y * w.y;
      };
      Vec22.cross = function(v3, w) {
        if (typeof w === "number") {
          return Vec22.neo(w * v3.y, -w * v3.x);
        } else if (typeof v3 === "number") {
          return Vec22.neo(-v3 * w.y, v3 * w.x);
        } else {
          return v3.x * w.y - v3.y * w.x;
        }
      };
      Vec22.crossVec2Vec2 = function(v3, w) {
        return v3.x * w.y - v3.y * w.x;
      };
      Vec22.crossVec2Num = function(v3, w) {
        return Vec22.neo(w * v3.y, -w * v3.x);
      };
      Vec22.crossNumVec2 = function(v3, w) {
        return Vec22.neo(-v3 * w.y, v3 * w.x);
      };
      Vec22.addCross = function(a2, v3, w) {
        if (typeof w === "number") {
          return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);
        } else if (typeof v3 === "number") {
          return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);
        }
      };
      Vec22.addCrossVec2Num = function(a2, v3, w) {
        return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);
      };
      Vec22.addCrossNumVec2 = function(a2, v3, w) {
        return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);
      };
      Vec22.add = function(v3, w) {
        return Vec22.neo(v3.x + w.x, v3.y + w.y);
      };
      Vec22.wAdd = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return Vec22.combine(a2, v3, b2, w);
        } else {
          return Vec22.mulNumVec2(a2, v3);
        }
      };
      Vec22.combine = function(a2, v3, b2, w) {
        return Vec22.zero().setCombine(a2, v3, b2, w);
      };
      Vec22.sub = function(v3, w) {
        return Vec22.neo(v3.x - w.x, v3.y - w.y);
      };
      Vec22.mul = function(a2, b2) {
        if (typeof a2 === "object") {
          return Vec22.neo(a2.x * b2, a2.y * b2);
        } else if (typeof b2 === "object") {
          return Vec22.neo(a2 * b2.x, a2 * b2.y);
        }
      };
      Vec22.mulVec2Num = function(a2, b2) {
        return Vec22.neo(a2.x * b2, a2.y * b2);
      };
      Vec22.mulNumVec2 = function(a2, b2) {
        return Vec22.neo(a2 * b2.x, a2 * b2.y);
      };
      Vec22.prototype.neg = function() {
        this.x = -this.x;
        this.y = -this.y;
        return this;
      };
      Vec22.neg = function(v3) {
        return Vec22.neo(-v3.x, -v3.y);
      };
      Vec22.abs = function(v3) {
        return Vec22.neo(math_abs$9(v3.x), math_abs$9(v3.y));
      };
      Vec22.mid = function(v3, w) {
        return Vec22.neo((v3.x + w.x) * 0.5, (v3.y + w.y) * 0.5);
      };
      Vec22.upper = function(v3, w) {
        return Vec22.neo(math_max$8(v3.x, w.x), math_max$8(v3.y, w.y));
      };
      Vec22.lower = function(v3, w) {
        return Vec22.neo(math_min$8(v3.x, w.x), math_min$8(v3.y, w.y));
      };
      Vec22.prototype.clamp = function(max) {
        var lengthSqr = this.x * this.x + this.y * this.y;
        if (lengthSqr > max * max) {
          var scale = max / math_sqrt$5(lengthSqr);
          this.x *= scale;
          this.y *= scale;
        }
        return this;
      };
      Vec22.clamp = function(v3, max) {
        var r = Vec22.neo(v3.x, v3.y);
        r.clamp(max);
        return r;
      };
      Vec22.clampVec2 = function(v3, min, max) {
        return {
          x: clamp(v3.x, min === null || min === void 0 ? void 0 : min.x, max === null || max === void 0 ? void 0 : max.x),
          y: clamp(v3.y, min === null || min === void 0 ? void 0 : min.y, max === null || max === void 0 ? void 0 : max.y)
        };
      };
      Vec22.scaleFn = function(x2, y) {
        return function(v3) {
          return Vec22.neo(v3.x * x2, v3.y * y);
        };
      };
      Vec22.translateFn = function(x2, y) {
        return function(v3) {
          return Vec22.neo(v3.x + x2, v3.y + y);
        };
      };
      return Vec22;
    }()
  );
  var math_max$7 = Math.max;
  var math_min$7 = Math.min;
  var AABB = (
    /** @class */
    function() {
      function AABB2(lower, upper) {
        if (!(this instanceof AABB2)) {
          return new AABB2(lower, upper);
        }
        this.lowerBound = Vec2.zero();
        this.upperBound = Vec2.zero();
        if (typeof lower === "object") {
          this.lowerBound.setVec2(lower);
        }
        if (typeof upper === "object") {
          this.upperBound.setVec2(upper);
        } else if (typeof lower === "object") {
          this.upperBound.setVec2(lower);
        }
      }
      AABB2.prototype.isValid = function() {
        return AABB2.isValid(this);
      };
      AABB2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.lowerBound) && Vec2.isValid(obj.upperBound) && Vec2.sub(obj.upperBound, obj.lowerBound).lengthSquared() >= 0;
      };
      AABB2.assert = function(o) {
      };
      AABB2.prototype.getCenter = function() {
        return Vec2.neo((this.lowerBound.x + this.upperBound.x) * 0.5, (this.lowerBound.y + this.upperBound.y) * 0.5);
      };
      AABB2.prototype.getExtents = function() {
        return Vec2.neo((this.upperBound.x - this.lowerBound.x) * 0.5, (this.upperBound.y - this.lowerBound.y) * 0.5);
      };
      AABB2.prototype.getPerimeter = function() {
        return 2 * (this.upperBound.x - this.lowerBound.x + this.upperBound.y - this.lowerBound.y);
      };
      AABB2.prototype.combine = function(a2, b2) {
        b2 = b2 || this;
        var lowerA = a2.lowerBound;
        var upperA = a2.upperBound;
        var lowerB = b2.lowerBound;
        var upperB = b2.upperBound;
        var lowerX = math_min$7(lowerA.x, lowerB.x);
        var lowerY = math_min$7(lowerA.y, lowerB.y);
        var upperX = math_max$7(upperB.x, upperA.x);
        var upperY = math_max$7(upperB.y, upperA.y);
        this.lowerBound.setNum(lowerX, lowerY);
        this.upperBound.setNum(upperX, upperY);
      };
      AABB2.prototype.combinePoints = function(a2, b2) {
        this.lowerBound.setNum(math_min$7(a2.x, b2.x), math_min$7(a2.y, b2.y));
        this.upperBound.setNum(math_max$7(a2.x, b2.x), math_max$7(a2.y, b2.y));
      };
      AABB2.prototype.set = function(aabb) {
        this.lowerBound.setNum(aabb.lowerBound.x, aabb.lowerBound.y);
        this.upperBound.setNum(aabb.upperBound.x, aabb.upperBound.y);
      };
      AABB2.prototype.contains = function(aabb) {
        var result = true;
        result = result && this.lowerBound.x <= aabb.lowerBound.x;
        result = result && this.lowerBound.y <= aabb.lowerBound.y;
        result = result && aabb.upperBound.x <= this.upperBound.x;
        result = result && aabb.upperBound.y <= this.upperBound.y;
        return result;
      };
      AABB2.prototype.extend = function(value) {
        AABB2.extend(this, value);
        return this;
      };
      AABB2.extend = function(out, value) {
        out.lowerBound.x -= value;
        out.lowerBound.y -= value;
        out.upperBound.x += value;
        out.upperBound.y += value;
        return out;
      };
      AABB2.testOverlap = function(a2, b2) {
        var d1x = b2.lowerBound.x - a2.upperBound.x;
        var d2x = a2.lowerBound.x - b2.upperBound.x;
        var d1y = b2.lowerBound.y - a2.upperBound.y;
        var d2y = a2.lowerBound.y - b2.upperBound.y;
        if (d1x > 0 || d1y > 0 || d2x > 0 || d2y > 0) {
          return false;
        }
        return true;
      };
      AABB2.areEqual = function(a2, b2) {
        return Vec2.areEqual(a2.lowerBound, b2.lowerBound) && Vec2.areEqual(a2.upperBound, b2.upperBound);
      };
      AABB2.diff = function(a2, b2) {
        var wD = math_max$7(0, math_min$7(a2.upperBound.x, b2.upperBound.x) - math_max$7(b2.lowerBound.x, a2.lowerBound.x));
        var hD = math_max$7(0, math_min$7(a2.upperBound.y, b2.upperBound.y) - math_max$7(b2.lowerBound.y, a2.lowerBound.y));
        var wA = a2.upperBound.x - a2.lowerBound.x;
        var hA = a2.upperBound.y - a2.lowerBound.y;
        var wB = b2.upperBound.x - b2.lowerBound.x;
        var hB = b2.upperBound.y - b2.lowerBound.y;
        return wA * hA + wB * hB - wD * hD;
      };
      AABB2.prototype.rayCast = function(output2, input2) {
        var tmin = -Infinity;
        var tmax = Infinity;
        var p = input2.p1;
        var d2 = Vec2.sub(input2.p2, input2.p1);
        var absD = Vec2.abs(d2);
        var normal3 = Vec2.zero();
        {
          if (absD.x < EPSILON) {
            if (p.x < this.lowerBound.x || this.upperBound.x < p.x) {
              return false;
            }
          } else {
            var inv_d = 1 / d2.x;
            var t1 = (this.lowerBound.x - p.x) * inv_d;
            var t2 = (this.upperBound.x - p.x) * inv_d;
            var s2 = -1;
            if (t1 > t2) {
              var temp3 = t1;
              t1 = t2;
              t2 = temp3;
              s2 = 1;
            }
            if (t1 > tmin) {
              normal3.setZero();
              normal3.x = s2;
              tmin = t1;
            }
            tmax = math_min$7(tmax, t2);
            if (tmin > tmax) {
              return false;
            }
          }
        }
        {
          if (absD.y < EPSILON) {
            if (p.y < this.lowerBound.y || this.upperBound.y < p.y) {
              return false;
            }
          } else {
            var inv_d = 1 / d2.y;
            var t1 = (this.lowerBound.y - p.y) * inv_d;
            var t2 = (this.upperBound.y - p.y) * inv_d;
            var s2 = -1;
            if (t1 > t2) {
              var temp3 = t1;
              t1 = t2;
              t2 = temp3;
              s2 = 1;
            }
            if (t1 > tmin) {
              normal3.setZero();
              normal3.y = s2;
              tmin = t1;
            }
            tmax = math_min$7(tmax, t2);
            if (tmin > tmax) {
              return false;
            }
          }
        }
        if (tmin < 0 || input2.maxFraction < tmin) {
          return false;
        }
        output2.fraction = tmin;
        output2.normal = normal3;
        return true;
      };
      AABB2.prototype.toString = function() {
        return JSON.stringify(this);
      };
      AABB2.combinePoints = function(out, a2, b2) {
        out.lowerBound.x = math_min$7(a2.x, b2.x);
        out.lowerBound.y = math_min$7(a2.y, b2.y);
        out.upperBound.x = math_max$7(a2.x, b2.x);
        out.upperBound.y = math_max$7(a2.y, b2.y);
        return out;
      };
      AABB2.combinedPerimeter = function(a2, b2) {
        var lx = math_min$7(a2.lowerBound.x, b2.lowerBound.x);
        var ly = math_min$7(a2.lowerBound.y, b2.lowerBound.y);
        var ux = math_max$7(a2.upperBound.x, b2.upperBound.x);
        var uy = math_max$7(a2.upperBound.y, b2.upperBound.y);
        return 2 * (ux - lx + uy - ly);
      };
      return AABB2;
    }()
  );
  var math_PI$6 = Math.PI;
  var Settings = (
    /** @class */
    function() {
      function Settings2() {
      }
      Object.defineProperty(Settings2, "polygonRadius", {
        /**
         * The radius of the polygon/edge shape skin. This should not be modified.
         * Making this smaller means polygons will have an insufficient buffer for
         * continuous collision. Making it larger may create artifacts for vertex
         * collision.
         */
        get: function() {
          return 2 * Settings2.linearSlop;
        },
        enumerable: false,
        configurable: true
      });
      Settings2.lengthUnitsPerMeter = 1;
      Settings2.maxManifoldPoints = 2;
      Settings2.maxPolygonVertices = 12;
      Settings2.aabbExtension = 0.1;
      Settings2.aabbMultiplier = 2;
      Settings2.linearSlop = 5e-3;
      Settings2.angularSlop = 2 / 180 * math_PI$6;
      Settings2.maxSubSteps = 8;
      Settings2.maxTOIContacts = 32;
      Settings2.maxTOIIterations = 20;
      Settings2.maxDistanceIterations = 20;
      Settings2.velocityThreshold = 1;
      Settings2.maxLinearCorrection = 0.2;
      Settings2.maxAngularCorrection = 8 / 180 * math_PI$6;
      Settings2.maxTranslation = 2;
      Settings2.maxRotation = 0.5 * math_PI$6;
      Settings2.baumgarte = 0.2;
      Settings2.toiBaugarte = 0.75;
      Settings2.timeToSleep = 0.5;
      Settings2.linearSleepTolerance = 0.01;
      Settings2.angularSleepTolerance = 2 / 180 * math_PI$6;
      return Settings2;
    }()
  );
  var SettingsInternal = (
    /** @class */
    function() {
      function SettingsInternal2() {
      }
      Object.defineProperty(SettingsInternal2, "maxManifoldPoints", {
        get: function() {
          return Settings.maxManifoldPoints;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxPolygonVertices", {
        get: function() {
          return Settings.maxPolygonVertices;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "aabbExtension", {
        get: function() {
          return Settings.aabbExtension * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "aabbMultiplier", {
        get: function() {
          return Settings.aabbMultiplier;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSlop", {
        get: function() {
          return Settings.linearSlop * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSlopSquared", {
        get: function() {
          return Settings.linearSlop * Settings.lengthUnitsPerMeter * Settings.linearSlop * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSlop", {
        get: function() {
          return Settings.angularSlop;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "polygonRadius", {
        get: function() {
          return 2 * Settings.linearSlop;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxSubSteps", {
        get: function() {
          return Settings.maxSubSteps;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTOIContacts", {
        get: function() {
          return Settings.maxTOIContacts;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTOIIterations", {
        get: function() {
          return Settings.maxTOIIterations;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxDistanceIterations", {
        get: function() {
          return Settings.maxDistanceIterations;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "velocityThreshold", {
        get: function() {
          return Settings.velocityThreshold * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxLinearCorrection", {
        get: function() {
          return Settings.maxLinearCorrection * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxAngularCorrection", {
        get: function() {
          return Settings.maxAngularCorrection;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTranslation", {
        get: function() {
          return Settings.maxTranslation * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTranslationSquared", {
        get: function() {
          return Settings.maxTranslation * Settings.lengthUnitsPerMeter * Settings.maxTranslation * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxRotation", {
        get: function() {
          return Settings.maxRotation;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxRotationSquared", {
        get: function() {
          return Settings.maxRotation * Settings.maxRotation;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "baumgarte", {
        get: function() {
          return Settings.baumgarte;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "toiBaugarte", {
        get: function() {
          return Settings.toiBaugarte;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "timeToSleep", {
        get: function() {
          return Settings.timeToSleep;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSleepTolerance", {
        get: function() {
          return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSleepToleranceSqr", {
        get: function() {
          return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter * Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSleepTolerance", {
        get: function() {
          return Settings.angularSleepTolerance;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSleepToleranceSqr", {
        get: function() {
          return Settings.angularSleepTolerance * Settings.angularSleepTolerance;
        },
        enumerable: false,
        configurable: true
      });
      return SettingsInternal2;
    }()
  );
  var Pool = (
    /** @class */
    function() {
      function Pool2(opts) {
        this._list = [];
        this._max = Infinity;
        this._hasCreateFn = false;
        this._createCount = 0;
        this._hasAllocateFn = false;
        this._allocateCount = 0;
        this._hasReleaseFn = false;
        this._releaseCount = 0;
        this._hasDisposeFn = false;
        this._disposeCount = 0;
        this._list = [];
        this._max = opts.max || this._max;
        this._createFn = opts.create;
        this._hasCreateFn = typeof this._createFn === "function";
        this._allocateFn = opts.allocate;
        this._hasAllocateFn = typeof this._allocateFn === "function";
        this._releaseFn = opts.release;
        this._hasReleaseFn = typeof this._releaseFn === "function";
        this._disposeFn = opts.dispose;
        this._hasDisposeFn = typeof this._disposeFn === "function";
      }
      Pool2.prototype.max = function(n2) {
        if (typeof n2 === "number") {
          this._max = n2;
          return this;
        }
        return this._max;
      };
      Pool2.prototype.size = function() {
        return this._list.length;
      };
      Pool2.prototype.allocate = function() {
        var item;
        if (this._list.length > 0) {
          item = this._list.shift();
        } else {
          this._createCount++;
          if (this._hasCreateFn) {
            item = this._createFn();
          } else {
            item = {};
          }
        }
        this._allocateCount++;
        if (this._hasAllocateFn) {
          this._allocateFn(item);
        }
        return item;
      };
      Pool2.prototype.release = function(item) {
        if (this._list.length < this._max) {
          this._releaseCount++;
          if (this._hasReleaseFn) {
            this._releaseFn(item);
          }
          this._list.push(item);
        } else {
          this._disposeCount++;
          if (this._hasDisposeFn) {
            item = this._disposeFn(item);
          }
        }
      };
      Pool2.prototype.toString = function() {
        return " +" + this._createCount + " >" + this._allocateCount + " <" + this._releaseCount + " -" + this._disposeCount + " =" + this._list.length + "/" + this._max;
      };
      return Pool2;
    }()
  );
  var math_abs$8 = Math.abs;
  var math_max$6 = Math.max;
  var TreeNode = (
    /** @class */
    function() {
      function TreeNode2(id) {
        this.aabb = new AABB();
        this.userData = null;
        this.parent = null;
        this.child1 = null;
        this.child2 = null;
        this.height = -1;
        this.id = id;
      }
      TreeNode2.prototype.toString = function() {
        return this.id + ": " + this.userData;
      };
      TreeNode2.prototype.isLeaf = function() {
        return this.child1 == null;
      };
      return TreeNode2;
    }()
  );
  var poolTreeNode = new Pool({
    create: function() {
      return new TreeNode();
    },
    release: function(node) {
      node.userData = null;
      node.parent = null;
      node.child1 = null;
      node.child2 = null;
      node.height = -1;
      node.id = void 0;
    }
  });
  var DynamicTree = (
    /** @class */
    function() {
      function DynamicTree2() {
        this.inputPool = new Pool({
          create: function() {
            return {};
          },
          release: function(stack) {
          }
        });
        this.stackPool = new Pool({
          create: function() {
            return [];
          },
          release: function(stack) {
            stack.length = 0;
          }
        });
        this.iteratorPool = new Pool({
          create: function() {
            return new Iterator();
          },
          release: function(iterator) {
            iterator.close();
          }
        });
        this.m_root = null;
        this.m_nodes = {};
        this.m_lastProxyId = 0;
      }
      DynamicTree2.prototype.getUserData = function(id) {
        var node = this.m_nodes[id];
        return node.userData;
      };
      DynamicTree2.prototype.getFatAABB = function(id) {
        var node = this.m_nodes[id];
        return node.aabb;
      };
      DynamicTree2.prototype.allocateNode = function() {
        var node = poolTreeNode.allocate();
        node.id = ++this.m_lastProxyId;
        this.m_nodes[node.id] = node;
        return node;
      };
      DynamicTree2.prototype.freeNode = function(node) {
        delete this.m_nodes[node.id];
        poolTreeNode.release(node);
      };
      DynamicTree2.prototype.createProxy = function(aabb, userData) {
        var node = this.allocateNode();
        node.aabb.set(aabb);
        AABB.extend(node.aabb, SettingsInternal.aabbExtension);
        node.userData = userData;
        node.height = 0;
        this.insertLeaf(node);
        return node.id;
      };
      DynamicTree2.prototype.destroyProxy = function(id) {
        var node = this.m_nodes[id];
        this.removeLeaf(node);
        this.freeNode(node);
      };
      DynamicTree2.prototype.moveProxy = function(id, aabb, d2) {
        var node = this.m_nodes[id];
        if (node.aabb.contains(aabb)) {
          return false;
        }
        this.removeLeaf(node);
        node.aabb.set(aabb);
        aabb = node.aabb;
        AABB.extend(aabb, SettingsInternal.aabbExtension);
        if (d2.x < 0) {
          aabb.lowerBound.x += d2.x * SettingsInternal.aabbMultiplier;
        } else {
          aabb.upperBound.x += d2.x * SettingsInternal.aabbMultiplier;
        }
        if (d2.y < 0) {
          aabb.lowerBound.y += d2.y * SettingsInternal.aabbMultiplier;
        } else {
          aabb.upperBound.y += d2.y * SettingsInternal.aabbMultiplier;
        }
        this.insertLeaf(node);
        return true;
      };
      DynamicTree2.prototype.insertLeaf = function(leaf) {
        if (this.m_root == null) {
          this.m_root = leaf;
          this.m_root.parent = null;
          return;
        }
        var leafAABB = leaf.aabb;
        var index = this.m_root;
        while (!index.isLeaf()) {
          var child1 = index.child1;
          var child2 = index.child2;
          var area = index.aabb.getPerimeter();
          var combinedArea = AABB.combinedPerimeter(index.aabb, leafAABB);
          var cost = 2 * combinedArea;
          var inheritanceCost = 2 * (combinedArea - area);
          var newArea1 = AABB.combinedPerimeter(leafAABB, child1.aabb);
          var cost1 = newArea1 + inheritanceCost;
          if (!child1.isLeaf()) {
            var oldArea = child1.aabb.getPerimeter();
            cost1 -= oldArea;
          }
          var newArea2 = AABB.combinedPerimeter(leafAABB, child2.aabb);
          var cost2 = newArea2 + inheritanceCost;
          if (!child2.isLeaf()) {
            var oldArea = child2.aabb.getPerimeter();
            cost2 -= oldArea;
          }
          if (cost < cost1 && cost < cost2) {
            break;
          }
          if (cost1 < cost2) {
            index = child1;
          } else {
            index = child2;
          }
        }
        var sibling = index;
        var oldParent = sibling.parent;
        var newParent = this.allocateNode();
        newParent.parent = oldParent;
        newParent.userData = null;
        newParent.aabb.combine(leafAABB, sibling.aabb);
        newParent.height = sibling.height + 1;
        if (oldParent != null) {
          if (oldParent.child1 === sibling) {
            oldParent.child1 = newParent;
          } else {
            oldParent.child2 = newParent;
          }
          newParent.child1 = sibling;
          newParent.child2 = leaf;
          sibling.parent = newParent;
          leaf.parent = newParent;
        } else {
          newParent.child1 = sibling;
          newParent.child2 = leaf;
          sibling.parent = newParent;
          leaf.parent = newParent;
          this.m_root = newParent;
        }
        index = leaf.parent;
        while (index != null) {
          index = this.balance(index);
          var child1 = index.child1;
          var child2 = index.child2;
          index.height = 1 + math_max$6(child1.height, child2.height);
          index.aabb.combine(child1.aabb, child2.aabb);
          index = index.parent;
        }
      };
      DynamicTree2.prototype.removeLeaf = function(leaf) {
        if (leaf === this.m_root) {
          this.m_root = null;
          return;
        }
        var parent = leaf.parent;
        var grandParent = parent.parent;
        var sibling;
        if (parent.child1 === leaf) {
          sibling = parent.child2;
        } else {
          sibling = parent.child1;
        }
        if (grandParent != null) {
          if (grandParent.child1 === parent) {
            grandParent.child1 = sibling;
          } else {
            grandParent.child2 = sibling;
          }
          sibling.parent = grandParent;
          this.freeNode(parent);
          var index = grandParent;
          while (index != null) {
            index = this.balance(index);
            var child1 = index.child1;
            var child2 = index.child2;
            index.aabb.combine(child1.aabb, child2.aabb);
            index.height = 1 + math_max$6(child1.height, child2.height);
            index = index.parent;
          }
        } else {
          this.m_root = sibling;
          sibling.parent = null;
          this.freeNode(parent);
        }
      };
      DynamicTree2.prototype.balance = function(iA) {
        var A = iA;
        if (A.isLeaf() || A.height < 2) {
          return iA;
        }
        var B = A.child1;
        var C = A.child2;
        var balance = C.height - B.height;
        if (balance > 1) {
          var F = C.child1;
          var G = C.child2;
          C.child1 = A;
          C.parent = A.parent;
          A.parent = C;
          if (C.parent != null) {
            if (C.parent.child1 === iA) {
              C.parent.child1 = C;
            } else {
              C.parent.child2 = C;
            }
          } else {
            this.m_root = C;
          }
          if (F.height > G.height) {
            C.child2 = F;
            A.child2 = G;
            G.parent = A;
            A.aabb.combine(B.aabb, G.aabb);
            C.aabb.combine(A.aabb, F.aabb);
            A.height = 1 + math_max$6(B.height, G.height);
            C.height = 1 + math_max$6(A.height, F.height);
          } else {
            C.child2 = G;
            A.child2 = F;
            F.parent = A;
            A.aabb.combine(B.aabb, F.aabb);
            C.aabb.combine(A.aabb, G.aabb);
            A.height = 1 + math_max$6(B.height, F.height);
            C.height = 1 + math_max$6(A.height, G.height);
          }
          return C;
        }
        if (balance < -1) {
          var D = B.child1;
          var E = B.child2;
          B.child1 = A;
          B.parent = A.parent;
          A.parent = B;
          if (B.parent != null) {
            if (B.parent.child1 === A) {
              B.parent.child1 = B;
            } else {
              B.parent.child2 = B;
            }
          } else {
            this.m_root = B;
          }
          if (D.height > E.height) {
            B.child2 = D;
            A.child1 = E;
            E.parent = A;
            A.aabb.combine(C.aabb, E.aabb);
            B.aabb.combine(A.aabb, D.aabb);
            A.height = 1 + math_max$6(C.height, E.height);
            B.height = 1 + math_max$6(A.height, D.height);
          } else {
            B.child2 = E;
            A.child1 = D;
            D.parent = A;
            A.aabb.combine(C.aabb, D.aabb);
            B.aabb.combine(A.aabb, E.aabb);
            A.height = 1 + math_max$6(C.height, D.height);
            B.height = 1 + math_max$6(A.height, E.height);
          }
          return B;
        }
        return A;
      };
      DynamicTree2.prototype.getHeight = function() {
        if (this.m_root == null) {
          return 0;
        }
        return this.m_root.height;
      };
      DynamicTree2.prototype.getAreaRatio = function() {
        if (this.m_root == null) {
          return 0;
        }
        var root = this.m_root;
        var rootArea = root.aabb.getPerimeter();
        var totalArea = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height < 0) {
            continue;
          }
          totalArea += node.aabb.getPerimeter();
        }
        this.iteratorPool.release(it);
        return totalArea / rootArea;
      };
      DynamicTree2.prototype.computeHeight = function(id) {
        var node;
        if (typeof id !== "undefined") {
          node = this.m_nodes[id];
        } else {
          node = this.m_root;
        }
        if (node.isLeaf()) {
          return 0;
        }
        var height1 = this.computeHeight(node.child1.id);
        var height2 = this.computeHeight(node.child2.id);
        return 1 + math_max$6(height1, height2);
      };
      DynamicTree2.prototype.validateStructure = function(node) {
        if (node == null) {
          return;
        }
        if (node === this.m_root) ;
        var child1 = node.child1;
        var child2 = node.child2;
        if (node.isLeaf()) {
          return;
        }
        this.validateStructure(child1);
        this.validateStructure(child2);
      };
      DynamicTree2.prototype.validateMetrics = function(node) {
        if (node == null) {
          return;
        }
        var child1 = node.child1;
        var child2 = node.child2;
        if (node.isLeaf()) {
          return;
        }
        this.validateMetrics(child1);
        this.validateMetrics(child2);
      };
      DynamicTree2.prototype.validate = function() {
        return;
      };
      DynamicTree2.prototype.getMaxBalance = function() {
        var maxBalance = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height <= 1) {
            continue;
          }
          var balance = math_abs$8(node.child2.height - node.child1.height);
          maxBalance = math_max$6(maxBalance, balance);
        }
        this.iteratorPool.release(it);
        return maxBalance;
      };
      DynamicTree2.prototype.rebuildBottomUp = function() {
        var nodes = [];
        var count = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height < 0) {
            continue;
          }
          if (node.isLeaf()) {
            node.parent = null;
            nodes[count] = node;
            ++count;
          } else {
            this.freeNode(node);
          }
        }
        this.iteratorPool.release(it);
        while (count > 1) {
          var minCost = Infinity;
          var iMin = -1;
          var jMin = -1;
          for (var i = 0; i < count; ++i) {
            var aabbi = nodes[i].aabb;
            for (var j = i + 1; j < count; ++j) {
              var aabbj = nodes[j].aabb;
              var cost = AABB.combinedPerimeter(aabbi, aabbj);
              if (cost < minCost) {
                iMin = i;
                jMin = j;
                minCost = cost;
              }
            }
          }
          var child1 = nodes[iMin];
          var child2 = nodes[jMin];
          var parent_1 = this.allocateNode();
          parent_1.child1 = child1;
          parent_1.child2 = child2;
          parent_1.height = 1 + math_max$6(child1.height, child2.height);
          parent_1.aabb.combine(child1.aabb, child2.aabb);
          parent_1.parent = null;
          child1.parent = parent_1;
          child2.parent = parent_1;
          nodes[jMin] = nodes[count - 1];
          nodes[iMin] = parent_1;
          --count;
        }
        this.m_root = nodes[0];
      };
      DynamicTree2.prototype.shiftOrigin = function(newOrigin) {
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          var aabb = node.aabb;
          aabb.lowerBound.x -= newOrigin.x;
          aabb.lowerBound.y -= newOrigin.y;
          aabb.upperBound.x -= newOrigin.x;
          aabb.upperBound.y -= newOrigin.y;
        }
        this.iteratorPool.release(it);
      };
      DynamicTree2.prototype.query = function(aabb, queryCallback) {
        var stack = this.stackPool.allocate();
        stack.push(this.m_root);
        while (stack.length > 0) {
          var node = stack.pop();
          if (node == null) {
            continue;
          }
          if (AABB.testOverlap(node.aabb, aabb)) {
            if (node.isLeaf()) {
              var proceed = queryCallback(node.id);
              if (proceed === false) {
                return;
              }
            } else {
              stack.push(node.child1);
              stack.push(node.child2);
            }
          }
        }
        this.stackPool.release(stack);
      };
      DynamicTree2.prototype.rayCast = function(input2, rayCastCallback) {
        var p1 = input2.p1;
        var p2 = input2.p2;
        var r = Vec2.sub(p2, p1);
        r.normalize();
        var v3 = Vec2.crossNumVec2(1, r);
        var abs_v = Vec2.abs(v3);
        var maxFraction = input2.maxFraction;
        var segmentAABB = new AABB();
        var t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);
        segmentAABB.combinePoints(p1, t);
        var stack = this.stackPool.allocate();
        var subInput = this.inputPool.allocate();
        stack.push(this.m_root);
        while (stack.length > 0) {
          var node = stack.pop();
          if (node == null) {
            continue;
          }
          if (AABB.testOverlap(node.aabb, segmentAABB) === false) {
            continue;
          }
          var c2 = node.aabb.getCenter();
          var h = node.aabb.getExtents();
          var separation = math_abs$8(Vec2.dot(v3, Vec2.sub(p1, c2))) - Vec2.dot(abs_v, h);
          if (separation > 0) {
            continue;
          }
          if (node.isLeaf()) {
            subInput.p1 = Vec2.clone(input2.p1);
            subInput.p2 = Vec2.clone(input2.p2);
            subInput.maxFraction = maxFraction;
            var value = rayCastCallback(subInput, node.id);
            if (value === 0) {
              break;
            } else if (value > 0) {
              maxFraction = value;
              t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);
              segmentAABB.combinePoints(p1, t);
            }
          } else {
            stack.push(node.child1);
            stack.push(node.child2);
          }
        }
        this.stackPool.release(stack);
        this.inputPool.release(subInput);
      };
      return DynamicTree2;
    }()
  );
  var Iterator = (
    /** @class */
    function() {
      function Iterator2() {
        this.parents = [];
        this.states = [];
      }
      Iterator2.prototype.preorder = function(root) {
        this.parents.length = 0;
        this.parents.push(root);
        this.states.length = 0;
        this.states.push(0);
        return this;
      };
      Iterator2.prototype.next = function() {
        while (this.parents.length > 0) {
          var i = this.parents.length - 1;
          var node = this.parents[i];
          if (this.states[i] === 0) {
            this.states[i] = 1;
            return node;
          }
          if (this.states[i] === 1) {
            this.states[i] = 2;
            if (node.child1) {
              this.parents.push(node.child1);
              this.states.push(1);
              return node.child1;
            }
          }
          if (this.states[i] === 2) {
            this.states[i] = 3;
            if (node.child2) {
              this.parents.push(node.child2);
              this.states.push(1);
              return node.child2;
            }
          }
          this.parents.pop();
          this.states.pop();
        }
      };
      Iterator2.prototype.close = function() {
        this.parents.length = 0;
      };
      return Iterator2;
    }()
  );
  var math_max$5 = Math.max;
  var math_min$6 = Math.min;
  var BroadPhase = (
    /** @class */
    function() {
      function BroadPhase2() {
        var _this = this;
        this.m_tree = new DynamicTree();
        this.m_moveBuffer = [];
        this.query = function(aabb, queryCallback) {
          _this.m_tree.query(aabb, queryCallback);
        };
        this.queryCallback = function(proxyId) {
          if (proxyId === _this.m_queryProxyId) {
            return true;
          }
          var proxyIdA = math_min$6(proxyId, _this.m_queryProxyId);
          var proxyIdB = math_max$5(proxyId, _this.m_queryProxyId);
          var userDataA = _this.m_tree.getUserData(proxyIdA);
          var userDataB = _this.m_tree.getUserData(proxyIdB);
          _this.m_callback(userDataA, userDataB);
          return true;
        };
      }
      BroadPhase2.prototype.getUserData = function(proxyId) {
        return this.m_tree.getUserData(proxyId);
      };
      BroadPhase2.prototype.testOverlap = function(proxyIdA, proxyIdB) {
        var aabbA = this.m_tree.getFatAABB(proxyIdA);
        var aabbB = this.m_tree.getFatAABB(proxyIdB);
        return AABB.testOverlap(aabbA, aabbB);
      };
      BroadPhase2.prototype.getFatAABB = function(proxyId) {
        return this.m_tree.getFatAABB(proxyId);
      };
      BroadPhase2.prototype.getProxyCount = function() {
        return this.m_moveBuffer.length;
      };
      BroadPhase2.prototype.getTreeHeight = function() {
        return this.m_tree.getHeight();
      };
      BroadPhase2.prototype.getTreeBalance = function() {
        return this.m_tree.getMaxBalance();
      };
      BroadPhase2.prototype.getTreeQuality = function() {
        return this.m_tree.getAreaRatio();
      };
      BroadPhase2.prototype.rayCast = function(input2, rayCastCallback) {
        this.m_tree.rayCast(input2, rayCastCallback);
      };
      BroadPhase2.prototype.shiftOrigin = function(newOrigin) {
        this.m_tree.shiftOrigin(newOrigin);
      };
      BroadPhase2.prototype.createProxy = function(aabb, userData) {
        var proxyId = this.m_tree.createProxy(aabb, userData);
        this.bufferMove(proxyId);
        return proxyId;
      };
      BroadPhase2.prototype.destroyProxy = function(proxyId) {
        this.unbufferMove(proxyId);
        this.m_tree.destroyProxy(proxyId);
      };
      BroadPhase2.prototype.moveProxy = function(proxyId, aabb, displacement2) {
        var changed = this.m_tree.moveProxy(proxyId, aabb, displacement2);
        if (changed) {
          this.bufferMove(proxyId);
        }
      };
      BroadPhase2.prototype.touchProxy = function(proxyId) {
        this.bufferMove(proxyId);
      };
      BroadPhase2.prototype.bufferMove = function(proxyId) {
        this.m_moveBuffer.push(proxyId);
      };
      BroadPhase2.prototype.unbufferMove = function(proxyId) {
        for (var i = 0; i < this.m_moveBuffer.length; ++i) {
          if (this.m_moveBuffer[i] === proxyId) {
            this.m_moveBuffer[i] = null;
          }
        }
      };
      BroadPhase2.prototype.updatePairs = function(addPairCallback) {
        this.m_callback = addPairCallback;
        while (this.m_moveBuffer.length > 0) {
          this.m_queryProxyId = this.m_moveBuffer.pop();
          if (this.m_queryProxyId === null) {
            continue;
          }
          var fatAABB = this.m_tree.getFatAABB(this.m_queryProxyId);
          this.m_tree.query(fatAABB, this.queryCallback);
        }
      };
      return BroadPhase2;
    }()
  );
  var math_sin$2 = Math.sin;
  var math_cos$2 = Math.cos;
  var math_sqrt$4 = Math.sqrt;
  function vec2(x2, y) {
    return { x: x2, y };
  }
  function rotation(angle) {
    return { s: math_sin$2(angle), c: math_cos$2(angle) };
  }
  function setVec2(out, x2, y) {
    out.x = x2;
    out.y = y;
    return out;
  }
  function copyVec2(out, w) {
    out.x = w.x;
    out.y = w.y;
    return out;
  }
  function zeroVec2(out) {
    out.x = 0;
    out.y = 0;
    return out;
  }
  function negVec2(out) {
    out.x = -out.x;
    out.y = -out.y;
    return out;
  }
  function plusVec2(out, w) {
    out.x += w.x;
    out.y += w.y;
    return out;
  }
  function addVec2(out, v3, w) {
    out.x = v3.x + w.x;
    out.y = v3.x + w.y;
    return out;
  }
  function minusVec2(out, w) {
    out.x -= w.x;
    out.y -= w.y;
    return out;
  }
  function subVec2(out, v3, w) {
    out.x = v3.x - w.x;
    out.y = v3.y - w.y;
    return out;
  }
  function mulVec2(out, m) {
    out.x *= m;
    out.y *= m;
    return out;
  }
  function scaleVec2(out, m, w) {
    out.x = m * w.x;
    out.y = m * w.y;
    return out;
  }
  function plusScaleVec2(out, m, w) {
    out.x += m * w.x;
    out.y += m * w.y;
    return out;
  }
  function minusScaleVec2(out, m, w) {
    out.x -= m * w.x;
    out.y -= m * w.y;
    return out;
  }
  function combine2Vec2(out, am, a2, bm, b2) {
    out.x = am * a2.x + bm * b2.x;
    out.y = am * a2.y + bm * b2.y;
    return out;
  }
  function combine3Vec2(out, am, a2, bm, b2, cm, c2) {
    out.x = am * a2.x + bm * b2.x + cm * c2.x;
    out.y = am * a2.y + bm * b2.y + cm * c2.y;
    return out;
  }
  function normalizeVec2Length(out) {
    var length = math_sqrt$4(out.x * out.x + out.y * out.y);
    if (length !== 0) {
      var invLength = 1 / length;
      out.x *= invLength;
      out.y *= invLength;
    }
    return length;
  }
  function normalizeVec2(out) {
    var length = math_sqrt$4(out.x * out.x + out.y * out.y);
    if (length > 0) {
      var invLength = 1 / length;
      out.x *= invLength;
      out.y *= invLength;
    }
    return out;
  }
  function crossVec2Num(out, v3, w) {
    var x2 = w * v3.y;
    var y = -w * v3.x;
    out.x = x2;
    out.y = y;
    return out;
  }
  function crossNumVec2(out, w, v3) {
    var x2 = -w * v3.y;
    var y = w * v3.x;
    out.x = x2;
    out.y = y;
    return out;
  }
  function crossVec2Vec2(a2, b2) {
    return a2.x * b2.y - a2.y * b2.x;
  }
  function dotVec2(a2, b2) {
    return a2.x * b2.x + a2.y * b2.y;
  }
  function lengthSqrVec2(a2) {
    return a2.x * a2.x + a2.y * a2.y;
  }
  function distVec2(a2, b2) {
    var dx = a2.x - b2.x;
    var dy = a2.y - b2.y;
    return math_sqrt$4(dx * dx + dy * dy);
  }
  function distSqrVec2(a2, b2) {
    var dx = a2.x - b2.x;
    var dy = a2.y - b2.y;
    return dx * dx + dy * dy;
  }
  function setRotAngle(out, a2) {
    out.c = math_cos$2(a2);
    out.s = math_sin$2(a2);
    return out;
  }
  function rotVec2(out, q, v3) {
    out.x = q.c * v3.x - q.s * v3.y;
    out.y = q.s * v3.x + q.c * v3.y;
    return out;
  }
  function derotVec2(out, q, v3) {
    var x2 = q.c * v3.x + q.s * v3.y;
    var y = -q.s * v3.x + q.c * v3.y;
    out.x = x2;
    out.y = y;
    return out;
  }
  function rerotVec2(out, before, after, v3) {
    var x0 = before.c * v3.x + before.s * v3.y;
    var y0 = -before.s * v3.x + before.c * v3.y;
    var x2 = after.c * x0 - after.s * y0;
    var y = after.s * x0 + after.c * y0;
    out.x = x2;
    out.y = y;
    return out;
  }
  function transform(x2, y, a2) {
    return { p: vec2(x2, y), q: rotation(a2) };
  }
  function copyTransform(out, transform2) {
    out.p.x = transform2.p.x;
    out.p.y = transform2.p.y;
    out.q.s = transform2.q.s;
    out.q.c = transform2.q.c;
    return out;
  }
  function transformVec2(out, xf2, v3) {
    var x2 = xf2.q.c * v3.x - xf2.q.s * v3.y + xf2.p.x;
    var y = xf2.q.s * v3.x + xf2.q.c * v3.y + xf2.p.y;
    out.x = x2;
    out.y = y;
    return out;
  }
  function detransformVec2(out, xf2, v3) {
    var px = v3.x - xf2.p.x;
    var py = v3.y - xf2.p.y;
    var x2 = xf2.q.c * px + xf2.q.s * py;
    var y = -xf2.q.s * px + xf2.q.c * py;
    out.x = x2;
    out.y = y;
    return out;
  }
  function retransformVec2(out, from, to, v3) {
    var x0 = from.q.c * v3.x - from.q.s * v3.y + from.p.x;
    var y0 = from.q.s * v3.x + from.q.c * v3.y + from.p.y;
    var px = x0 - to.p.x;
    var py = y0 - to.p.y;
    var x2 = to.q.c * px + to.q.s * py;
    var y = -to.q.s * px + to.q.c * py;
    out.x = x2;
    out.y = y;
    return out;
  }
  function detransformTransform(out, a2, b2) {
    var c2 = a2.q.c * b2.q.c + a2.q.s * b2.q.s;
    var s2 = a2.q.c * b2.q.s - a2.q.s * b2.q.c;
    var x2 = a2.q.c * (b2.p.x - a2.p.x) + a2.q.s * (b2.p.y - a2.p.y);
    var y = -a2.q.s * (b2.p.x - a2.p.x) + a2.q.c * (b2.p.y - a2.p.y);
    out.q.c = c2;
    out.q.s = s2;
    out.p.x = x2;
    out.p.y = y;
    return out;
  }
  var math_sin$1 = Math.sin;
  var math_cos$1 = Math.cos;
  var math_atan2$1 = Math.atan2;
  var Rot = (
    /** @class */
    function() {
      function Rot2(angle) {
        if (!(this instanceof Rot2)) {
          return new Rot2(angle);
        }
        if (typeof angle === "number") {
          this.setAngle(angle);
        } else if (typeof angle === "object") {
          this.setRot(angle);
        } else {
          this.setIdentity();
        }
      }
      Rot2.neo = function(angle) {
        var obj = Object.create(Rot2.prototype);
        obj.setAngle(angle);
        return obj;
      };
      Rot2.clone = function(rot) {
        var obj = Object.create(Rot2.prototype);
        obj.s = rot.s;
        obj.c = rot.c;
        return obj;
      };
      Rot2.identity = function() {
        var obj = Object.create(Rot2.prototype);
        obj.s = 0;
        obj.c = 1;
        return obj;
      };
      Rot2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.s) && Number.isFinite(obj.c);
      };
      Rot2.assert = function(o) {
      };
      Rot2.prototype.setIdentity = function() {
        this.s = 0;
        this.c = 1;
      };
      Rot2.prototype.set = function(angle) {
        if (typeof angle === "object") {
          this.s = angle.s;
          this.c = angle.c;
        } else {
          this.s = math_sin$1(angle);
          this.c = math_cos$1(angle);
        }
      };
      Rot2.prototype.setRot = function(angle) {
        this.s = angle.s;
        this.c = angle.c;
      };
      Rot2.prototype.setAngle = function(angle) {
        this.s = math_sin$1(angle);
        this.c = math_cos$1(angle);
      };
      Rot2.prototype.getAngle = function() {
        return math_atan2$1(this.s, this.c);
      };
      Rot2.prototype.getXAxis = function() {
        return Vec2.neo(this.c, this.s);
      };
      Rot2.prototype.getYAxis = function() {
        return Vec2.neo(-this.s, this.c);
      };
      Rot2.mul = function(rot, m) {
        if ("c" in m && "s" in m) {
          var qr = Rot2.identity();
          qr.s = rot.s * m.c + rot.c * m.s;
          qr.c = rot.c * m.c - rot.s * m.s;
          return qr;
        } else if ("x" in m && "y" in m) {
          return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);
        }
      };
      Rot2.mulRot = function(rot, m) {
        var qr = Rot2.identity();
        qr.s = rot.s * m.c + rot.c * m.s;
        qr.c = rot.c * m.c - rot.s * m.s;
        return qr;
      };
      Rot2.mulVec2 = function(rot, m) {
        return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);
      };
      Rot2.mulSub = function(rot, v3, w) {
        var x2 = rot.c * (v3.x - w.x) - rot.s * (v3.y - w.y);
        var y = rot.s * (v3.x - w.x) + rot.c * (v3.y - w.y);
        return Vec2.neo(x2, y);
      };
      Rot2.mulT = function(rot, m) {
        if ("c" in m && "s" in m) {
          var qr = Rot2.identity();
          qr.s = rot.c * m.s - rot.s * m.c;
          qr.c = rot.c * m.c + rot.s * m.s;
          return qr;
        } else if ("x" in m && "y" in m) {
          return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);
        }
      };
      Rot2.mulTRot = function(rot, m) {
        var qr = Rot2.identity();
        qr.s = rot.c * m.s - rot.s * m.c;
        qr.c = rot.c * m.c + rot.s * m.s;
        return qr;
      };
      Rot2.mulTVec2 = function(rot, m) {
        return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);
      };
      return Rot2;
    }()
  );
  var math_atan2 = Math.atan2;
  var math_PI$5 = Math.PI;
  var temp$7 = vec2(0, 0);
  var Sweep = (
    /** @class */
    function() {
      function Sweep2() {
        this.localCenter = Vec2.zero();
        this.c = Vec2.zero();
        this.a = 0;
        this.alpha0 = 0;
        this.c0 = Vec2.zero();
        this.a0 = 0;
      }
      Sweep2.prototype.recycle = function() {
        zeroVec2(this.localCenter);
        zeroVec2(this.c);
        this.a = 0;
        this.alpha0 = 0;
        zeroVec2(this.c0);
        this.a0 = 0;
      };
      Sweep2.prototype.setTransform = function(xf2) {
        transformVec2(temp$7, xf2, this.localCenter);
        copyVec2(this.c, temp$7);
        copyVec2(this.c0, temp$7);
        this.a = this.a0 = math_atan2(xf2.q.s, xf2.q.c);
      };
      Sweep2.prototype.setLocalCenter = function(localCenter2, xf2) {
        copyVec2(this.localCenter, localCenter2);
        transformVec2(temp$7, xf2, this.localCenter);
        copyVec2(this.c, temp$7);
        copyVec2(this.c0, temp$7);
      };
      Sweep2.prototype.getTransform = function(xf2, beta) {
        if (beta === void 0) {
          beta = 0;
        }
        setRotAngle(xf2.q, (1 - beta) * this.a0 + beta * this.a);
        combine2Vec2(xf2.p, 1 - beta, this.c0, beta, this.c);
        minusVec2(xf2.p, rotVec2(temp$7, xf2.q, this.localCenter));
      };
      Sweep2.prototype.advance = function(alpha) {
        var beta = (alpha - this.alpha0) / (1 - this.alpha0);
        combine2Vec2(this.c0, beta, this.c, 1 - beta, this.c0);
        this.a0 = beta * this.a + (1 - beta) * this.a0;
        this.alpha0 = alpha;
      };
      Sweep2.prototype.forward = function() {
        this.a0 = this.a;
        copyVec2(this.c0, this.c);
      };
      Sweep2.prototype.normalize = function() {
        var a0 = mod(this.a0, -math_PI$5, +math_PI$5);
        this.a -= this.a0 - a0;
        this.a0 = a0;
      };
      Sweep2.prototype.set = function(that) {
        copyVec2(this.localCenter, that.localCenter);
        copyVec2(this.c, that.c);
        this.a = that.a;
        this.alpha0 = that.alpha0;
        copyVec2(this.c0, that.c0);
        this.a0 = that.a0;
      };
      return Sweep2;
    }()
  );
  var Transform = (
    /** @class */
    function() {
      function Transform2(position, rotation2) {
        if (!(this instanceof Transform2)) {
          return new Transform2(position, rotation2);
        }
        this.p = Vec2.zero();
        this.q = Rot.identity();
        if (typeof position !== "undefined") {
          this.p.setVec2(position);
        }
        if (typeof rotation2 !== "undefined") {
          this.q.setAngle(rotation2);
        }
      }
      Transform2.clone = function(xf2) {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.clone(xf2.p);
        obj.q = Rot.clone(xf2.q);
        return obj;
      };
      Transform2.neo = function(position, rotation2) {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.clone(position);
        obj.q = Rot.clone(rotation2);
        return obj;
      };
      Transform2.identity = function() {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.zero();
        obj.q = Rot.identity();
        return obj;
      };
      Transform2.prototype.setIdentity = function() {
        this.p.setZero();
        this.q.setIdentity();
      };
      Transform2.prototype.set = function(a2, b2) {
        if (typeof b2 === "undefined") {
          this.p.set(a2.p);
          this.q.set(a2.q);
        } else {
          this.p.set(a2);
          this.q.set(b2);
        }
      };
      Transform2.prototype.setNum = function(position, rotation2) {
        this.p.setVec2(position);
        this.q.setAngle(rotation2);
      };
      Transform2.prototype.setTransform = function(xf2) {
        this.p.setVec2(xf2.p);
        this.q.setRot(xf2.q);
      };
      Transform2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.p) && Rot.isValid(obj.q);
      };
      Transform2.assert = function(o) {
      };
      Transform2.mul = function(a2, b2) {
        if (Array.isArray(b2)) {
          var arr = [];
          for (var i = 0; i < b2.length; i++) {
            arr[i] = Transform2.mul(a2, b2[i]);
          }
          return arr;
        } else if ("x" in b2 && "y" in b2) {
          return Transform2.mulVec2(a2, b2);
        } else if ("p" in b2 && "q" in b2) {
          return Transform2.mulXf(a2, b2);
        }
      };
      Transform2.mulAll = function(a2, b2) {
        var arr = [];
        for (var i = 0; i < b2.length; i++) {
          arr[i] = Transform2.mul(a2, b2[i]);
        }
        return arr;
      };
      Transform2.mulFn = function(a2) {
        return function(b2) {
          return Transform2.mul(a2, b2);
        };
      };
      Transform2.mulVec2 = function(a2, b2) {
        var x2 = a2.q.c * b2.x - a2.q.s * b2.y + a2.p.x;
        var y = a2.q.s * b2.x + a2.q.c * b2.y + a2.p.y;
        return Vec2.neo(x2, y);
      };
      Transform2.mulXf = function(a2, b2) {
        var xf2 = Transform2.identity();
        xf2.q = Rot.mulRot(a2.q, b2.q);
        xf2.p = Vec2.add(Rot.mulVec2(a2.q, b2.p), a2.p);
        return xf2;
      };
      Transform2.mulT = function(a2, b2) {
        if ("x" in b2 && "y" in b2) {
          return Transform2.mulTVec2(a2, b2);
        } else if ("p" in b2 && "q" in b2) {
          return Transform2.mulTXf(a2, b2);
        }
      };
      Transform2.mulTVec2 = function(a2, b2) {
        var px = b2.x - a2.p.x;
        var py = b2.y - a2.p.y;
        var x2 = a2.q.c * px + a2.q.s * py;
        var y = -a2.q.s * px + a2.q.c * py;
        return Vec2.neo(x2, y);
      };
      Transform2.mulTXf = function(a2, b2) {
        var xf2 = Transform2.identity();
        xf2.q.setRot(Rot.mulTRot(a2.q, b2.q));
        xf2.p.setVec2(Rot.mulTVec2(a2.q, Vec2.sub(b2.p, a2.p)));
        return xf2;
      };
      return Transform2;
    }()
  );
  var Velocity = (
    /** @class */
    /* @__PURE__ */ function() {
      function Velocity2() {
        this.v = Vec2.zero();
        this.w = 0;
      }
      return Velocity2;
    }()
  );
  var math_sin = Math.sin;
  var math_cos = Math.cos;
  var Position = (
    /** @class */
    function() {
      function Position2() {
        this.c = Vec2.zero();
        this.a = 0;
      }
      Position2.prototype.getTransform = function(xf2, p) {
        xf2.q.c = math_cos(this.a);
        xf2.q.s = math_sin(this.a);
        xf2.p.x = this.c.x - (xf2.q.c * p.x - xf2.q.s * p.y);
        xf2.p.y = this.c.y - (xf2.q.s * p.x + xf2.q.c * p.y);
        return xf2;
      };
      return Position2;
    }()
  );
  function getTransform(xf2, p, c2, a2) {
    xf2.q.c = math_cos(a2);
    xf2.q.s = math_sin(a2);
    xf2.p.x = c2.x - (xf2.q.c * p.x - xf2.q.s * p.y);
    xf2.p.y = c2.y - (xf2.q.s * p.x + xf2.q.c * p.y);
    return xf2;
  }
  var Shape = (
    /** @class */
    function() {
      function Shape2() {
        this.style = {};
        this.appData = {};
      }
      Shape2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return typeof obj.m_type === "string" && typeof obj.m_radius === "number";
      };
      return Shape2;
    }()
  );
  var synchronize_aabb1 = new AABB();
  var synchronize_aabb2 = new AABB();
  var displacement = vec2(0, 0);
  var FixtureDefDefault = {
    userData: null,
    friction: 0.2,
    restitution: 0,
    density: 0,
    isSensor: false,
    filterGroupIndex: 0,
    filterCategoryBits: 1,
    filterMaskBits: 65535
  };
  var FixtureProxy = (
    /** @class */
    /* @__PURE__ */ function() {
      function FixtureProxy2(fixture, childIndex) {
        this.aabb = new AABB();
        this.fixture = fixture;
        this.childIndex = childIndex;
      }
      return FixtureProxy2;
    }()
  );
  var Fixture = (
    /** @class */
    function() {
      function Fixture2(body, shape, def) {
        this.style = {};
        this.appData = {};
        if (shape.shape) {
          def = shape;
          shape = shape.shape;
        } else if (typeof def === "number") {
          def = { density: def };
        }
        def = options(def, FixtureDefDefault);
        this.m_body = body;
        this.m_friction = def.friction;
        this.m_restitution = def.restitution;
        this.m_density = def.density;
        this.m_isSensor = def.isSensor;
        this.m_filterGroupIndex = def.filterGroupIndex;
        this.m_filterCategoryBits = def.filterCategoryBits;
        this.m_filterMaskBits = def.filterMaskBits;
        this.m_shape = shape;
        this.m_next = null;
        this.m_proxies = [];
        this.m_proxyCount = 0;
        var childCount = this.m_shape.getChildCount();
        for (var i = 0; i < childCount; ++i) {
          this.m_proxies[i] = new FixtureProxy(this, i);
        }
        this.m_userData = def.userData;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Fixture2.prototype._reset = function() {
        var body = this.getBody();
        var broadPhase = body.m_world.m_broadPhase;
        this.destroyProxies(broadPhase);
        if (this.m_shape._reset) {
          this.m_shape._reset();
        }
        var childCount = this.m_shape.getChildCount();
        for (var i = 0; i < childCount; ++i) {
          this.m_proxies[i] = new FixtureProxy(this, i);
        }
        this.createProxies(broadPhase, body.m_xf);
        body.resetMassData();
      };
      Fixture2.prototype._serialize = function() {
        return {
          friction: this.m_friction,
          restitution: this.m_restitution,
          density: this.m_density,
          isSensor: this.m_isSensor,
          filterGroupIndex: this.m_filterGroupIndex,
          filterCategoryBits: this.m_filterCategoryBits,
          filterMaskBits: this.m_filterMaskBits,
          shape: this.m_shape
        };
      };
      Fixture2._deserialize = function(data, body, restore) {
        var shape = restore(Shape, data.shape);
        var fixture = shape && new Fixture2(body, shape, data);
        return fixture;
      };
      Fixture2.prototype.getType = function() {
        return this.m_shape.m_type;
      };
      Fixture2.prototype.getShape = function() {
        return this.m_shape;
      };
      Fixture2.prototype.isSensor = function() {
        return this.m_isSensor;
      };
      Fixture2.prototype.setSensor = function(sensor) {
        if (sensor != this.m_isSensor) {
          this.m_body.setAwake(true);
          this.m_isSensor = sensor;
        }
      };
      Fixture2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Fixture2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Fixture2.prototype.getBody = function() {
        return this.m_body;
      };
      Fixture2.prototype.getNext = function() {
        return this.m_next;
      };
      Fixture2.prototype.getDensity = function() {
        return this.m_density;
      };
      Fixture2.prototype.setDensity = function(density) {
        this.m_density = density;
      };
      Fixture2.prototype.getFriction = function() {
        return this.m_friction;
      };
      Fixture2.prototype.setFriction = function(friction) {
        this.m_friction = friction;
      };
      Fixture2.prototype.getRestitution = function() {
        return this.m_restitution;
      };
      Fixture2.prototype.setRestitution = function(restitution) {
        this.m_restitution = restitution;
      };
      Fixture2.prototype.testPoint = function(p) {
        return this.m_shape.testPoint(this.m_body.getTransform(), p);
      };
      Fixture2.prototype.rayCast = function(output2, input2, childIndex) {
        return this.m_shape.rayCast(output2, input2, this.m_body.getTransform(), childIndex);
      };
      Fixture2.prototype.getMassData = function(massData) {
        this.m_shape.computeMass(massData, this.m_density);
      };
      Fixture2.prototype.getAABB = function(childIndex) {
        return this.m_proxies[childIndex].aabb;
      };
      Fixture2.prototype.createProxies = function(broadPhase, xf2) {
        this.m_proxyCount = this.m_shape.getChildCount();
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          this.m_shape.computeAABB(proxy.aabb, xf2, i);
          proxy.proxyId = broadPhase.createProxy(proxy.aabb, proxy);
        }
      };
      Fixture2.prototype.destroyProxies = function(broadPhase) {
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          broadPhase.destroyProxy(proxy.proxyId);
          proxy.proxyId = null;
        }
        this.m_proxyCount = 0;
      };
      Fixture2.prototype.synchronize = function(broadPhase, xf1, xf2) {
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          this.m_shape.computeAABB(synchronize_aabb1, xf1, proxy.childIndex);
          this.m_shape.computeAABB(synchronize_aabb2, xf2, proxy.childIndex);
          proxy.aabb.combine(synchronize_aabb1, synchronize_aabb2);
          subVec2(displacement, xf2.p, xf1.p);
          broadPhase.moveProxy(proxy.proxyId, proxy.aabb, displacement);
        }
      };
      Fixture2.prototype.setFilterData = function(filter) {
        this.m_filterGroupIndex = filter.groupIndex;
        this.m_filterCategoryBits = filter.categoryBits;
        this.m_filterMaskBits = filter.maskBits;
        this.refilter();
      };
      Fixture2.prototype.getFilterGroupIndex = function() {
        return this.m_filterGroupIndex;
      };
      Fixture2.prototype.setFilterGroupIndex = function(groupIndex) {
        this.m_filterGroupIndex = groupIndex;
        this.refilter();
      };
      Fixture2.prototype.getFilterCategoryBits = function() {
        return this.m_filterCategoryBits;
      };
      Fixture2.prototype.setFilterCategoryBits = function(categoryBits) {
        this.m_filterCategoryBits = categoryBits;
        this.refilter();
      };
      Fixture2.prototype.getFilterMaskBits = function() {
        return this.m_filterMaskBits;
      };
      Fixture2.prototype.setFilterMaskBits = function(maskBits) {
        this.m_filterMaskBits = maskBits;
        this.refilter();
      };
      Fixture2.prototype.refilter = function() {
        if (this.m_body == null) {
          return;
        }
        var edge = this.m_body.getContactList();
        while (edge) {
          var contact = edge.contact;
          var fixtureA = contact.getFixtureA();
          var fixtureB = contact.getFixtureB();
          if (fixtureA == this || fixtureB == this) {
            contact.flagForFiltering();
          }
          edge = edge.next;
        }
        var world = this.m_body.getWorld();
        if (world == null) {
          return;
        }
        var broadPhase = world.m_broadPhase;
        for (var i = 0; i < this.m_proxyCount; ++i) {
          broadPhase.touchProxy(this.m_proxies[i].proxyId);
        }
      };
      Fixture2.prototype.shouldCollide = function(that) {
        if (that.m_filterGroupIndex === this.m_filterGroupIndex && that.m_filterGroupIndex !== 0) {
          return that.m_filterGroupIndex > 0;
        }
        var collideA = (that.m_filterMaskBits & this.m_filterCategoryBits) !== 0;
        var collideB = (that.m_filterCategoryBits & this.m_filterMaskBits) !== 0;
        var collide = collideA && collideB;
        return collide;
      };
      return Fixture2;
    }()
  );
  var STATIC = "static";
  var KINEMATIC = "kinematic";
  var DYNAMIC = "dynamic";
  var oldCenter = vec2(0, 0);
  var localCenter = vec2(0, 0);
  var shift = vec2(0, 0);
  var temp$6 = vec2(0, 0);
  var xf$2 = transform(0, 0, 0);
  var BodyDefDefault = {
    type: STATIC,
    position: Vec2.zero(),
    angle: 0,
    linearVelocity: Vec2.zero(),
    angularVelocity: 0,
    linearDamping: 0,
    angularDamping: 0,
    fixedRotation: false,
    bullet: false,
    gravityScale: 1,
    allowSleep: true,
    awake: true,
    active: true,
    userData: null
  };
  var Body = (
    /** @class */
    function() {
      function Body2(world, def) {
        this.style = {};
        this.appData = {};
        def = options(def, BodyDefDefault);
        this.m_world = world;
        this.m_awakeFlag = def.awake;
        this.m_autoSleepFlag = def.allowSleep;
        this.m_bulletFlag = def.bullet;
        this.m_fixedRotationFlag = def.fixedRotation;
        this.m_activeFlag = def.active;
        this.m_islandFlag = false;
        this.m_toiFlag = false;
        this.m_userData = def.userData;
        this.m_type = def.type;
        if (this.m_type == DYNAMIC) {
          this.m_mass = 1;
          this.m_invMass = 1;
        } else {
          this.m_mass = 0;
          this.m_invMass = 0;
        }
        this.m_I = 0;
        this.m_invI = 0;
        this.m_xf = Transform.identity();
        this.m_xf.p.setVec2(def.position);
        this.m_xf.q.setAngle(def.angle);
        this.m_sweep = new Sweep();
        this.m_sweep.setTransform(this.m_xf);
        this.c_velocity = new Velocity();
        this.c_position = new Position();
        this.m_force = Vec2.zero();
        this.m_torque = 0;
        this.m_linearVelocity = Vec2.clone(def.linearVelocity);
        this.m_angularVelocity = def.angularVelocity;
        this.m_linearDamping = def.linearDamping;
        this.m_angularDamping = def.angularDamping;
        this.m_gravityScale = def.gravityScale;
        this.m_sleepTime = 0;
        this.m_jointList = null;
        this.m_contactList = null;
        this.m_fixtureList = null;
        this.m_prev = null;
        this.m_next = null;
        this.m_destroyed = false;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Body2.prototype._serialize = function() {
        var fixtures = [];
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          fixtures.push(f);
        }
        return {
          type: this.m_type,
          bullet: this.m_bulletFlag,
          position: this.m_xf.p,
          angle: this.m_xf.q.getAngle(),
          linearVelocity: this.m_linearVelocity,
          angularVelocity: this.m_angularVelocity,
          fixtures
        };
      };
      Body2._deserialize = function(data, world, restore) {
        var body = new Body2(world, data);
        if (data.fixtures) {
          for (var i = data.fixtures.length - 1; i >= 0; i--) {
            var fixture = restore(Fixture, data.fixtures[i], body);
            body._addFixture(fixture);
          }
        }
        return body;
      };
      Body2.prototype.isWorldLocked = function() {
        return this.m_world && this.m_world.isLocked() ? true : false;
      };
      Body2.prototype.getWorld = function() {
        return this.m_world;
      };
      Body2.prototype.getNext = function() {
        return this.m_next;
      };
      Body2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Body2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Body2.prototype.getFixtureList = function() {
        return this.m_fixtureList;
      };
      Body2.prototype.getJointList = function() {
        return this.m_jointList;
      };
      Body2.prototype.getContactList = function() {
        return this.m_contactList;
      };
      Body2.prototype.isStatic = function() {
        return this.m_type == STATIC;
      };
      Body2.prototype.isDynamic = function() {
        return this.m_type == DYNAMIC;
      };
      Body2.prototype.isKinematic = function() {
        return this.m_type == KINEMATIC;
      };
      Body2.prototype.setStatic = function() {
        this.setType(STATIC);
        return this;
      };
      Body2.prototype.setDynamic = function() {
        this.setType(DYNAMIC);
        return this;
      };
      Body2.prototype.setKinematic = function() {
        this.setType(KINEMATIC);
        return this;
      };
      Body2.prototype.getType = function() {
        return this.m_type;
      };
      Body2.prototype.setType = function(type) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_type == type) {
          return;
        }
        this.m_type = type;
        this.resetMassData();
        if (this.m_type == STATIC) {
          this.m_linearVelocity.setZero();
          this.m_angularVelocity = 0;
          this.m_sweep.forward();
          this.synchronizeFixtures();
        }
        this.setAwake(true);
        this.m_force.setZero();
        this.m_torque = 0;
        var ce = this.m_contactList;
        while (ce) {
          var ce0 = ce;
          ce = ce.next;
          this.m_world.destroyContact(ce0.contact);
        }
        this.m_contactList = null;
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          for (var i = 0; i < f.m_proxyCount; ++i) {
            broadPhase.touchProxy(f.m_proxies[i].proxyId);
          }
        }
      };
      Body2.prototype.isBullet = function() {
        return this.m_bulletFlag;
      };
      Body2.prototype.setBullet = function(flag) {
        this.m_bulletFlag = !!flag;
      };
      Body2.prototype.isSleepingAllowed = function() {
        return this.m_autoSleepFlag;
      };
      Body2.prototype.setSleepingAllowed = function(flag) {
        this.m_autoSleepFlag = !!flag;
        if (this.m_autoSleepFlag == false) {
          this.setAwake(true);
        }
      };
      Body2.prototype.isAwake = function() {
        return this.m_awakeFlag;
      };
      Body2.prototype.setAwake = function(flag) {
        if (flag) {
          this.m_awakeFlag = true;
          this.m_sleepTime = 0;
        } else {
          this.m_awakeFlag = false;
          this.m_sleepTime = 0;
          this.m_linearVelocity.setZero();
          this.m_angularVelocity = 0;
          this.m_force.setZero();
          this.m_torque = 0;
        }
      };
      Body2.prototype.isActive = function() {
        return this.m_activeFlag;
      };
      Body2.prototype.setActive = function(flag) {
        if (flag == this.m_activeFlag) {
          return;
        }
        this.m_activeFlag = !!flag;
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          for (var f = this.m_fixtureList; f; f = f.m_next) {
            f.createProxies(broadPhase, this.m_xf);
          }
          this.m_world.m_newFixture = true;
        } else {
          var broadPhase = this.m_world.m_broadPhase;
          for (var f = this.m_fixtureList; f; f = f.m_next) {
            f.destroyProxies(broadPhase);
          }
          var ce = this.m_contactList;
          while (ce) {
            var ce0 = ce;
            ce = ce.next;
            this.m_world.destroyContact(ce0.contact);
          }
          this.m_contactList = null;
        }
      };
      Body2.prototype.isFixedRotation = function() {
        return this.m_fixedRotationFlag;
      };
      Body2.prototype.setFixedRotation = function(flag) {
        if (this.m_fixedRotationFlag == flag) {
          return;
        }
        this.m_fixedRotationFlag = !!flag;
        this.m_angularVelocity = 0;
        this.resetMassData();
      };
      Body2.prototype.getTransform = function() {
        return this.m_xf;
      };
      Body2.prototype.setTransform = function(a2, b2) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (typeof b2 === "number") {
          this.m_xf.setNum(a2, b2);
        } else {
          this.m_xf.setTransform(a2);
        }
        this.m_sweep.setTransform(this.m_xf);
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          f.synchronize(broadPhase, this.m_xf, this.m_xf);
        }
        this.setAwake(true);
      };
      Body2.prototype.synchronizeTransform = function() {
        this.m_sweep.getTransform(this.m_xf, 1);
      };
      Body2.prototype.synchronizeFixtures = function() {
        this.m_sweep.getTransform(xf$2, 0);
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          f.synchronize(broadPhase, xf$2, this.m_xf);
        }
      };
      Body2.prototype.advance = function(alpha) {
        this.m_sweep.advance(alpha);
        copyVec2(this.m_sweep.c, this.m_sweep.c0);
        this.m_sweep.a = this.m_sweep.a0;
        this.m_sweep.getTransform(this.m_xf, 1);
      };
      Body2.prototype.getPosition = function() {
        return this.m_xf.p;
      };
      Body2.prototype.setPosition = function(p) {
        this.setTransform(p, this.m_sweep.a);
      };
      Body2.prototype.getAngle = function() {
        return this.m_sweep.a;
      };
      Body2.prototype.setAngle = function(angle) {
        this.setTransform(this.m_xf.p, angle);
      };
      Body2.prototype.getWorldCenter = function() {
        return this.m_sweep.c;
      };
      Body2.prototype.getLocalCenter = function() {
        return this.m_sweep.localCenter;
      };
      Body2.prototype.getLinearVelocity = function() {
        return this.m_linearVelocity;
      };
      Body2.prototype.getLinearVelocityFromWorldPoint = function(worldPoint) {
        var localCenter2 = Vec2.sub(worldPoint, this.m_sweep.c);
        return Vec2.add(this.m_linearVelocity, Vec2.crossNumVec2(this.m_angularVelocity, localCenter2));
      };
      Body2.prototype.getLinearVelocityFromLocalPoint = function(localPoint) {
        return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(localPoint));
      };
      Body2.prototype.setLinearVelocity = function(v3) {
        if (this.m_type == STATIC) {
          return;
        }
        if (Vec2.dot(v3, v3) > 0) {
          this.setAwake(true);
        }
        this.m_linearVelocity.setVec2(v3);
      };
      Body2.prototype.getAngularVelocity = function() {
        return this.m_angularVelocity;
      };
      Body2.prototype.setAngularVelocity = function(w) {
        if (this.m_type == STATIC) {
          return;
        }
        if (w * w > 0) {
          this.setAwake(true);
        }
        this.m_angularVelocity = w;
      };
      Body2.prototype.getLinearDamping = function() {
        return this.m_linearDamping;
      };
      Body2.prototype.setLinearDamping = function(linearDamping) {
        this.m_linearDamping = linearDamping;
      };
      Body2.prototype.getAngularDamping = function() {
        return this.m_angularDamping;
      };
      Body2.prototype.setAngularDamping = function(angularDamping) {
        this.m_angularDamping = angularDamping;
      };
      Body2.prototype.getGravityScale = function() {
        return this.m_gravityScale;
      };
      Body2.prototype.setGravityScale = function(scale) {
        this.m_gravityScale = scale;
      };
      Body2.prototype.getMass = function() {
        return this.m_mass;
      };
      Body2.prototype.getInertia = function() {
        return this.m_I + this.m_mass * Vec2.dot(this.m_sweep.localCenter, this.m_sweep.localCenter);
      };
      Body2.prototype.getMassData = function(data) {
        data.mass = this.m_mass;
        data.I = this.getInertia();
        copyVec2(data.center, this.m_sweep.localCenter);
      };
      Body2.prototype.resetMassData = function() {
        this.m_mass = 0;
        this.m_invMass = 0;
        this.m_I = 0;
        this.m_invI = 0;
        zeroVec2(this.m_sweep.localCenter);
        if (this.isStatic() || this.isKinematic()) {
          copyVec2(this.m_sweep.c0, this.m_xf.p);
          copyVec2(this.m_sweep.c, this.m_xf.p);
          this.m_sweep.a0 = this.m_sweep.a;
          return;
        }
        zeroVec2(localCenter);
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          if (f.m_density == 0) {
            continue;
          }
          var massData = {
            mass: 0,
            center: vec2(0, 0),
            I: 0
          };
          f.getMassData(massData);
          this.m_mass += massData.mass;
          plusScaleVec2(localCenter, massData.mass, massData.center);
          this.m_I += massData.I;
        }
        if (this.m_mass > 0) {
          this.m_invMass = 1 / this.m_mass;
          scaleVec2(localCenter, this.m_invMass, localCenter);
        } else {
          this.m_mass = 1;
          this.m_invMass = 1;
        }
        if (this.m_I > 0 && this.m_fixedRotationFlag == false) {
          this.m_I -= this.m_mass * dotVec2(localCenter, localCenter);
          this.m_invI = 1 / this.m_I;
        } else {
          this.m_I = 0;
          this.m_invI = 0;
        }
        copyVec2(oldCenter, this.m_sweep.c);
        this.m_sweep.setLocalCenter(localCenter, this.m_xf);
        subVec2(shift, this.m_sweep.c, oldCenter);
        crossNumVec2(temp$6, this.m_angularVelocity, shift);
        plusVec2(this.m_linearVelocity, temp$6);
      };
      Body2.prototype.setMassData = function(massData) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        this.m_invMass = 0;
        this.m_I = 0;
        this.m_invI = 0;
        this.m_mass = massData.mass;
        if (this.m_mass <= 0) {
          this.m_mass = 1;
        }
        this.m_invMass = 1 / this.m_mass;
        if (massData.I > 0 && this.m_fixedRotationFlag == false) {
          this.m_I = massData.I - this.m_mass * dotVec2(massData.center, massData.center);
          this.m_invI = 1 / this.m_I;
        }
        copyVec2(oldCenter, this.m_sweep.c);
        this.m_sweep.setLocalCenter(massData.center, this.m_xf);
        subVec2(shift, this.m_sweep.c, oldCenter);
        crossNumVec2(temp$6, this.m_angularVelocity, shift);
        plusVec2(this.m_linearVelocity, temp$6);
      };
      Body2.prototype.applyForce = function(force, point2, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_force.add(force);
          this.m_torque += Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), force);
        }
      };
      Body2.prototype.applyForceToCenter = function(force, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_force.add(force);
        }
      };
      Body2.prototype.applyTorque = function(torque, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_torque += torque;
        }
      };
      Body2.prototype.applyLinearImpulse = function(impulse, point2, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_linearVelocity.addMul(this.m_invMass, impulse);
          this.m_angularVelocity += this.m_invI * Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), impulse);
        }
      };
      Body2.prototype.applyAngularImpulse = function(impulse, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_angularVelocity += this.m_invI * impulse;
        }
      };
      Body2.prototype.shouldCollide = function(that) {
        if (this.m_type != DYNAMIC && that.m_type != DYNAMIC) {
          return false;
        }
        for (var jn = this.m_jointList; jn; jn = jn.next) {
          if (jn.other == that) {
            if (jn.joint.m_collideConnected == false) {
              return false;
            }
          }
        }
        return true;
      };
      Body2.prototype._addFixture = function(fixture) {
        if (this.isWorldLocked() == true) {
          return null;
        }
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          fixture.createProxies(broadPhase, this.m_xf);
        }
        fixture.m_next = this.m_fixtureList;
        this.m_fixtureList = fixture;
        if (fixture.m_density > 0) {
          this.resetMassData();
        }
        this.m_world.m_newFixture = true;
        return fixture;
      };
      Body2.prototype.createFixture = function(shape, fixdef) {
        if (this.isWorldLocked() == true) {
          return null;
        }
        var fixture = new Fixture(this, shape, fixdef);
        this._addFixture(fixture);
        return fixture;
      };
      Body2.prototype.destroyFixture = function(fixture) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_fixtureList === fixture) {
          this.m_fixtureList = fixture.m_next;
        } else {
          var node = this.m_fixtureList;
          while (node != null) {
            if (node.m_next === fixture) {
              node.m_next = fixture.m_next;
              break;
            }
            node = node.m_next;
          }
        }
        var edge = this.m_contactList;
        while (edge) {
          var c2 = edge.contact;
          edge = edge.next;
          var fixtureA = c2.getFixtureA();
          var fixtureB = c2.getFixtureB();
          if (fixture == fixtureA || fixture == fixtureB) {
            this.m_world.destroyContact(c2);
          }
        }
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          fixture.destroyProxies(broadPhase);
        }
        fixture.m_body = null;
        fixture.m_next = null;
        this.m_world.publish("remove-fixture", fixture);
        this.resetMassData();
      };
      Body2.prototype.getWorldPoint = function(localPoint) {
        return Transform.mulVec2(this.m_xf, localPoint);
      };
      Body2.prototype.getWorldVector = function(localVector) {
        return Rot.mulVec2(this.m_xf.q, localVector);
      };
      Body2.prototype.getLocalPoint = function(worldPoint) {
        return Transform.mulTVec2(this.m_xf, worldPoint);
      };
      Body2.prototype.getLocalVector = function(worldVector) {
        return Rot.mulTVec2(this.m_xf.q, worldVector);
      };
      Body2.STATIC = "static";
      Body2.KINEMATIC = "kinematic";
      Body2.DYNAMIC = "dynamic";
      return Body2;
    }()
  );
  var JointEdge = (
    /** @class */
    /* @__PURE__ */ function() {
      function JointEdge2() {
        this.other = null;
        this.joint = null;
        this.prev = null;
        this.next = null;
      }
      return JointEdge2;
    }()
  );
  var Joint = (
    /** @class */
    function() {
      function Joint2(def, bodyA, bodyB) {
        this.m_type = "unknown-joint";
        this.m_prev = null;
        this.m_next = null;
        this.m_edgeA = new JointEdge();
        this.m_edgeB = new JointEdge();
        this.m_islandFlag = false;
        this.style = {};
        this.appData = {};
        bodyA = "bodyA" in def ? def.bodyA : bodyA;
        bodyB = "bodyB" in def ? def.bodyB : bodyB;
        this.m_bodyA = bodyA;
        this.m_bodyB = bodyB;
        this.m_collideConnected = !!def.collideConnected;
        this.m_userData = def.userData;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Joint2.prototype.isActive = function() {
        return this.m_bodyA.isActive() && this.m_bodyB.isActive();
      };
      Joint2.prototype.getType = function() {
        return this.m_type;
      };
      Joint2.prototype.getBodyA = function() {
        return this.m_bodyA;
      };
      Joint2.prototype.getBodyB = function() {
        return this.m_bodyB;
      };
      Joint2.prototype.getNext = function() {
        return this.m_next;
      };
      Joint2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Joint2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Joint2.prototype.getCollideConnected = function() {
        return this.m_collideConnected;
      };
      Joint2.prototype.shiftOrigin = function(newOrigin) {
      };
      Joint2.prototype._resetAnchors = function(def) {
        return this._reset(def);
      };
      return Joint2;
    }()
  );
  var stats = {
    gjkCalls: 0,
    gjkIters: 0,
    gjkMaxIters: 0,
    toiTime: 0,
    toiMaxTime: 0,
    toiCalls: 0,
    toiIters: 0,
    toiMaxIters: 0,
    toiRootIters: 0,
    toiMaxRootIters: 0,
    toString: function(newline) {
      newline = typeof newline === "string" ? newline : "\n";
      var string = "";
      for (var name_1 in this) {
        if (typeof this[name_1] !== "function" && typeof this[name_1] !== "object") {
          string += name_1 + ": " + this[name_1] + newline;
        }
      }
      return string;
    }
  };
  var now = function() {
    return Date.now();
  };
  var diff = function(time) {
    return Date.now() - time;
  };
  const Timer = {
    now,
    diff
  };
  var math_max$4 = Math.max;
  var temp$5 = vec2(0, 0);
  var normal$4 = vec2(0, 0);
  var e12 = vec2(0, 0);
  var e13 = vec2(0, 0);
  var e23 = vec2(0, 0);
  var temp1 = vec2(0, 0);
  var temp2 = vec2(0, 0);
  stats.gjkCalls = 0;
  stats.gjkIters = 0;
  stats.gjkMaxIters = 0;
  var DistanceInput = (
    /** @class */
    function() {
      function DistanceInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.transformA = Transform.identity();
        this.transformB = Transform.identity();
        this.useRadii = false;
      }
      DistanceInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.transformA.setIdentity();
        this.transformB.setIdentity();
        this.useRadii = false;
      };
      return DistanceInput2;
    }()
  );
  var DistanceOutput = (
    /** @class */
    function() {
      function DistanceOutput2() {
        this.pointA = vec2(0, 0);
        this.pointB = vec2(0, 0);
        this.distance = 0;
        this.iterations = 0;
      }
      DistanceOutput2.prototype.recycle = function() {
        zeroVec2(this.pointA);
        zeroVec2(this.pointB);
        this.distance = 0;
        this.iterations = 0;
      };
      return DistanceOutput2;
    }()
  );
  var SimplexCache = (
    /** @class */
    function() {
      function SimplexCache2() {
        this.metric = 0;
        this.indexA = [];
        this.indexB = [];
        this.count = 0;
      }
      SimplexCache2.prototype.recycle = function() {
        this.metric = 0;
        this.indexA.length = 0;
        this.indexB.length = 0;
        this.count = 0;
      };
      return SimplexCache2;
    }()
  );
  var Distance = function(output2, cache2, input2) {
    ++stats.gjkCalls;
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var xfA2 = input2.transformA;
    var xfB2 = input2.transformB;
    simplex.recycle();
    simplex.readCache(cache2, proxyA, xfA2, proxyB, xfB2);
    var vertices = simplex.m_v;
    var k_maxIters = SettingsInternal.maxDistanceIterations;
    var saveA = [];
    var saveB = [];
    var saveCount = 0;
    var iter = 0;
    while (iter < k_maxIters) {
      saveCount = simplex.m_count;
      for (var i = 0; i < saveCount; ++i) {
        saveA[i] = vertices[i].indexA;
        saveB[i] = vertices[i].indexB;
      }
      simplex.solve();
      if (simplex.m_count === 3) {
        break;
      }
      var d2 = simplex.getSearchDirection();
      if (lengthSqrVec2(d2) < EPSILON * EPSILON) {
        break;
      }
      var vertex = vertices[simplex.m_count];
      vertex.indexA = proxyA.getSupport(derotVec2(temp$5, xfA2.q, scaleVec2(temp$5, -1, d2)));
      transformVec2(vertex.wA, xfA2, proxyA.getVertex(vertex.indexA));
      vertex.indexB = proxyB.getSupport(derotVec2(temp$5, xfB2.q, d2));
      transformVec2(vertex.wB, xfB2, proxyB.getVertex(vertex.indexB));
      subVec2(vertex.w, vertex.wB, vertex.wA);
      ++iter;
      ++stats.gjkIters;
      var duplicate = false;
      for (var i = 0; i < saveCount; ++i) {
        if (vertex.indexA === saveA[i] && vertex.indexB === saveB[i]) {
          duplicate = true;
          break;
        }
      }
      if (duplicate) {
        break;
      }
      ++simplex.m_count;
    }
    stats.gjkMaxIters = math_max$4(stats.gjkMaxIters, iter);
    simplex.getWitnessPoints(output2.pointA, output2.pointB);
    output2.distance = distVec2(output2.pointA, output2.pointB);
    output2.iterations = iter;
    simplex.writeCache(cache2);
    if (input2.useRadii) {
      var rA2 = proxyA.m_radius;
      var rB2 = proxyB.m_radius;
      if (output2.distance > rA2 + rB2 && output2.distance > EPSILON) {
        output2.distance -= rA2 + rB2;
        subVec2(normal$4, output2.pointB, output2.pointA);
        normalizeVec2(normal$4);
        plusScaleVec2(output2.pointA, rA2, normal$4);
        minusScaleVec2(output2.pointB, rB2, normal$4);
      } else {
        var p = subVec2(temp$5, output2.pointA, output2.pointB);
        copyVec2(output2.pointA, p);
        copyVec2(output2.pointB, p);
        output2.distance = 0;
      }
    }
  };
  var DistanceProxy = (
    /** @class */
    function() {
      function DistanceProxy2() {
        this.m_vertices = [];
        this.m_count = 0;
        this.m_radius = 0;
      }
      DistanceProxy2.prototype.recycle = function() {
        this.m_vertices.length = 0;
        this.m_count = 0;
        this.m_radius = 0;
      };
      DistanceProxy2.prototype.getVertexCount = function() {
        return this.m_count;
      };
      DistanceProxy2.prototype.getVertex = function(index) {
        return this.m_vertices[index];
      };
      DistanceProxy2.prototype.getSupport = function(d2) {
        var bestIndex = -1;
        var bestValue = -Infinity;
        for (var i = 0; i < this.m_count; ++i) {
          var value = dotVec2(this.m_vertices[i], d2);
          if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
          }
        }
        return bestIndex;
      };
      DistanceProxy2.prototype.getSupportVertex = function(d2) {
        return this.m_vertices[this.getSupport(d2)];
      };
      DistanceProxy2.prototype.set = function(shape, index) {
        shape.computeDistanceProxy(this, index);
      };
      DistanceProxy2.prototype.setVertices = function(vertices, count, radius) {
        this.m_vertices = vertices;
        this.m_count = count;
        this.m_radius = radius;
      };
      return DistanceProxy2;
    }()
  );
  var SimplexVertex = (
    /** @class */
    function() {
      function SimplexVertex2() {
        this.wA = vec2(0, 0);
        this.indexA = 0;
        this.wB = vec2(0, 0);
        this.indexB = 0;
        this.w = vec2(0, 0);
        this.a = 0;
      }
      SimplexVertex2.prototype.recycle = function() {
        this.indexA = 0;
        this.indexB = 0;
        zeroVec2(this.wA);
        zeroVec2(this.wB);
        zeroVec2(this.w);
        this.a = 0;
      };
      SimplexVertex2.prototype.set = function(v3) {
        this.indexA = v3.indexA;
        this.indexB = v3.indexB;
        copyVec2(this.wA, v3.wA);
        copyVec2(this.wB, v3.wB);
        copyVec2(this.w, v3.w);
        this.a = v3.a;
      };
      return SimplexVertex2;
    }()
  );
  var searchDirection_reuse = vec2(0, 0);
  var closestPoint_reuse = vec2(0, 0);
  var Simplex = (
    /** @class */
    function() {
      function Simplex2() {
        this.m_v1 = new SimplexVertex();
        this.m_v2 = new SimplexVertex();
        this.m_v3 = new SimplexVertex();
        this.m_v = [this.m_v1, this.m_v2, this.m_v3];
      }
      Simplex2.prototype.recycle = function() {
        this.m_v1.recycle();
        this.m_v2.recycle();
        this.m_v3.recycle();
        this.m_count = 0;
      };
      Simplex2.prototype.toString = function() {
        if (this.m_count === 3) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y,
            this.m_v2.a,
            this.m_v2.wA.x,
            this.m_v2.wA.y,
            this.m_v2.wB.x,
            this.m_v2.wB.y,
            this.m_v3.a,
            this.m_v3.wA.x,
            this.m_v3.wA.y,
            this.m_v3.wB.x,
            this.m_v3.wB.y
          ].toString();
        } else if (this.m_count === 2) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y,
            this.m_v2.a,
            this.m_v2.wA.x,
            this.m_v2.wA.y,
            this.m_v2.wB.x,
            this.m_v2.wB.y
          ].toString();
        } else if (this.m_count === 1) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y
          ].toString();
        } else {
          return "+" + this.m_count;
        }
      };
      Simplex2.prototype.readCache = function(cache2, proxyA, transformA, proxyB, transformB) {
        this.m_count = cache2.count;
        for (var i = 0; i < this.m_count; ++i) {
          var v3 = this.m_v[i];
          v3.indexA = cache2.indexA[i];
          v3.indexB = cache2.indexB[i];
          var wALocal = proxyA.getVertex(v3.indexA);
          var wBLocal = proxyB.getVertex(v3.indexB);
          transformVec2(v3.wA, transformA, wALocal);
          transformVec2(v3.wB, transformB, wBLocal);
          subVec2(v3.w, v3.wB, v3.wA);
          v3.a = 0;
        }
        if (this.m_count > 1) {
          var metric1 = cache2.metric;
          var metric2 = this.getMetric();
          if (metric2 < 0.5 * metric1 || 2 * metric1 < metric2 || metric2 < EPSILON) {
            this.m_count = 0;
          }
        }
        if (this.m_count === 0) {
          var v3 = this.m_v[0];
          v3.indexA = 0;
          v3.indexB = 0;
          var wALocal = proxyA.getVertex(0);
          var wBLocal = proxyB.getVertex(0);
          transformVec2(v3.wA, transformA, wALocal);
          transformVec2(v3.wB, transformB, wBLocal);
          subVec2(v3.w, v3.wB, v3.wA);
          v3.a = 1;
          this.m_count = 1;
        }
      };
      Simplex2.prototype.writeCache = function(cache2) {
        cache2.metric = this.getMetric();
        cache2.count = this.m_count;
        for (var i = 0; i < this.m_count; ++i) {
          cache2.indexA[i] = this.m_v[i].indexA;
          cache2.indexB[i] = this.m_v[i].indexB;
        }
      };
      Simplex2.prototype.getSearchDirection = function() {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        switch (this.m_count) {
          case 1:
            return setVec2(searchDirection_reuse, -v13.w.x, -v13.w.y);
          case 2: {
            subVec2(e12, v22.w, v13.w);
            var sgn = -crossVec2Vec2(e12, v13.w);
            if (sgn > 0) {
              return setVec2(searchDirection_reuse, -e12.y, e12.x);
            } else {
              return setVec2(searchDirection_reuse, e12.y, -e12.x);
            }
          }
          default:
            return zeroVec2(searchDirection_reuse);
        }
      };
      Simplex2.prototype.getClosestPoint = function() {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        switch (this.m_count) {
          case 0:
            return zeroVec2(closestPoint_reuse);
          case 1:
            return copyVec2(closestPoint_reuse, v13.w);
          case 2:
            return combine2Vec2(closestPoint_reuse, v13.a, v13.w, v22.a, v22.w);
          case 3:
            return zeroVec2(closestPoint_reuse);
          default:
            return zeroVec2(closestPoint_reuse);
        }
      };
      Simplex2.prototype.getWitnessPoints = function(pA2, pB2) {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        var v3 = this.m_v3;
        switch (this.m_count) {
          case 0:
            break;
          case 1:
            copyVec2(pA2, v13.wA);
            copyVec2(pB2, v13.wB);
            break;
          case 2:
            combine2Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA);
            combine2Vec2(pB2, v13.a, v13.wB, v22.a, v22.wB);
            break;
          case 3:
            combine3Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA, v3.a, v3.wA);
            copyVec2(pB2, pA2);
            break;
        }
      };
      Simplex2.prototype.getMetric = function() {
        switch (this.m_count) {
          case 0:
            return 0;
          case 1:
            return 0;
          case 2:
            return distVec2(this.m_v1.w, this.m_v2.w);
          case 3:
            return crossVec2Vec2(subVec2(temp1, this.m_v2.w, this.m_v1.w), subVec2(temp2, this.m_v3.w, this.m_v1.w));
          default:
            return 0;
        }
      };
      Simplex2.prototype.solve = function() {
        switch (this.m_count) {
          case 1:
            break;
          case 2:
            this.solve2();
            break;
          case 3:
            this.solve3();
            break;
        }
      };
      Simplex2.prototype.solve2 = function() {
        var w1 = this.m_v1.w;
        var w2 = this.m_v2.w;
        subVec2(e12, w2, w1);
        var d12_2 = -dotVec2(w1, e12);
        if (d12_2 <= 0) {
          this.m_v1.a = 1;
          this.m_count = 1;
          return;
        }
        var d12_1 = dotVec2(w2, e12);
        if (d12_1 <= 0) {
          this.m_v2.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v2);
          return;
        }
        var inv_d12 = 1 / (d12_1 + d12_2);
        this.m_v1.a = d12_1 * inv_d12;
        this.m_v2.a = d12_2 * inv_d12;
        this.m_count = 2;
      };
      Simplex2.prototype.solve3 = function() {
        var w1 = this.m_v1.w;
        var w2 = this.m_v2.w;
        var w3 = this.m_v3.w;
        subVec2(e12, w2, w1);
        var w1e12 = dotVec2(w1, e12);
        var w2e12 = dotVec2(w2, e12);
        var d12_1 = w2e12;
        var d12_2 = -w1e12;
        subVec2(e13, w3, w1);
        var w1e13 = dotVec2(w1, e13);
        var w3e13 = dotVec2(w3, e13);
        var d13_1 = w3e13;
        var d13_2 = -w1e13;
        subVec2(e23, w3, w2);
        var w2e23 = dotVec2(w2, e23);
        var w3e23 = dotVec2(w3, e23);
        var d23_1 = w3e23;
        var d23_2 = -w2e23;
        var n123 = crossVec2Vec2(e12, e13);
        var d123_1 = n123 * crossVec2Vec2(w2, w3);
        var d123_2 = n123 * crossVec2Vec2(w3, w1);
        var d123_3 = n123 * crossVec2Vec2(w1, w2);
        if (d12_2 <= 0 && d13_2 <= 0) {
          this.m_v1.a = 1;
          this.m_count = 1;
          return;
        }
        if (d12_1 > 0 && d12_2 > 0 && d123_3 <= 0) {
          var inv_d12 = 1 / (d12_1 + d12_2);
          this.m_v1.a = d12_1 * inv_d12;
          this.m_v2.a = d12_2 * inv_d12;
          this.m_count = 2;
          return;
        }
        if (d13_1 > 0 && d13_2 > 0 && d123_2 <= 0) {
          var inv_d13 = 1 / (d13_1 + d13_2);
          this.m_v1.a = d13_1 * inv_d13;
          this.m_v3.a = d13_2 * inv_d13;
          this.m_count = 2;
          this.m_v2.set(this.m_v3);
          return;
        }
        if (d12_1 <= 0 && d23_2 <= 0) {
          this.m_v2.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v2);
          return;
        }
        if (d13_1 <= 0 && d23_1 <= 0) {
          this.m_v3.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v3);
          return;
        }
        if (d23_1 > 0 && d23_2 > 0 && d123_1 <= 0) {
          var inv_d23 = 1 / (d23_1 + d23_2);
          this.m_v2.a = d23_1 * inv_d23;
          this.m_v3.a = d23_2 * inv_d23;
          this.m_count = 2;
          this.m_v1.set(this.m_v3);
          return;
        }
        var inv_d123 = 1 / (d123_1 + d123_2 + d123_3);
        this.m_v1.a = d123_1 * inv_d123;
        this.m_v2.a = d123_2 * inv_d123;
        this.m_v3.a = d123_3 * inv_d123;
        this.m_count = 3;
      };
      return Simplex2;
    }()
  );
  var simplex = new Simplex();
  var input$1 = new DistanceInput();
  var cache$1 = new SimplexCache();
  var output$1 = new DistanceOutput();
  var testOverlap = function(shapeA, indexA, shapeB, indexB, xfA2, xfB2) {
    input$1.recycle();
    input$1.proxyA.set(shapeA, indexA);
    input$1.proxyB.set(shapeB, indexB);
    copyTransform(input$1.transformA, xfA2);
    copyTransform(input$1.transformB, xfB2);
    input$1.useRadii = true;
    output$1.recycle();
    cache$1.recycle();
    Distance(output$1, cache$1, input$1);
    return output$1.distance < 10 * EPSILON;
  };
  Distance.testOverlap = testOverlap;
  Distance.Input = DistanceInput;
  Distance.Output = DistanceOutput;
  Distance.Proxy = DistanceProxy;
  Distance.Cache = SimplexCache;
  var ShapeCastInput = (
    /** @class */
    function() {
      function ShapeCastInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.transformA = Transform.identity();
        this.transformB = Transform.identity();
        this.translationB = Vec2.zero();
      }
      ShapeCastInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.transformA.setIdentity();
        this.transformB.setIdentity();
        zeroVec2(this.translationB);
      };
      return ShapeCastInput2;
    }()
  );
  var ShapeCastOutput = (
    /** @class */
    /* @__PURE__ */ function() {
      function ShapeCastOutput2() {
        this.point = Vec2.zero();
        this.normal = Vec2.zero();
        this.lambda = 1;
        this.iterations = 0;
      }
      return ShapeCastOutput2;
    }()
  );
  var ShapeCast = function(output2, input2) {
    output2.iterations = 0;
    output2.lambda = 1;
    output2.normal.setZero();
    output2.point.setZero();
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var radiusA = math_max$4(proxyA.m_radius, SettingsInternal.polygonRadius);
    var radiusB = math_max$4(proxyB.m_radius, SettingsInternal.polygonRadius);
    var radius = radiusA + radiusB;
    var xfA2 = input2.transformA;
    var xfB2 = input2.transformB;
    var r = input2.translationB;
    var n2 = Vec2.zero();
    var lambda = 0;
    var simplex2 = new Simplex();
    simplex2.m_count = 0;
    var vertices = simplex2.m_v;
    var indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(r)));
    var wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));
    var indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, r));
    var wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));
    var v3 = Vec2.sub(wA, wB);
    var sigma = math_max$4(SettingsInternal.polygonRadius, radius - SettingsInternal.polygonRadius);
    var tolerance = 0.5 * SettingsInternal.linearSlop;
    var k_maxIters = 20;
    var iter = 0;
    while (iter < k_maxIters && v3.length() - sigma > tolerance) {
      output2.iterations += 1;
      indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(v3)));
      wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));
      indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, v3));
      wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));
      var p = Vec2.sub(wA, wB);
      v3.normalize();
      var vp = Vec2.dot(v3, p);
      var vr = Vec2.dot(v3, r);
      if (vp - sigma > lambda * vr) {
        if (vr <= 0) {
          return false;
        }
        lambda = (vp - sigma) / vr;
        if (lambda > 1) {
          return false;
        }
        n2.setMul(-1, v3);
        simplex2.m_count = 0;
      }
      var vertex = vertices[simplex2.m_count];
      vertex.indexA = indexB;
      vertex.wA = Vec2.combine(1, wB, lambda, r);
      vertex.indexB = indexA;
      vertex.wB = wA;
      vertex.w = Vec2.sub(vertex.wB, vertex.wA);
      vertex.a = 1;
      simplex2.m_count += 1;
      switch (simplex2.m_count) {
        case 1:
          break;
        case 2:
          simplex2.solve2();
          break;
        case 3:
          simplex2.solve3();
          break;
      }
      if (simplex2.m_count == 3) {
        return false;
      }
      v3.setVec2(simplex2.getClosestPoint());
      ++iter;
    }
    if (iter == 0) {
      return false;
    }
    var pointA2 = Vec2.zero();
    var pointB2 = Vec2.zero();
    simplex2.getWitnessPoints(pointB2, pointA2);
    if (v3.lengthSquared() > 0) {
      n2.setMul(-1, v3);
      n2.normalize();
    }
    output2.point = Vec2.combine(1, pointA2, radiusA, n2);
    output2.normal = n2;
    output2.lambda = lambda;
    output2.iterations = iter;
    return true;
  };
  var math_abs$7 = Math.abs;
  var math_max$3 = Math.max;
  var TOIInput = (
    /** @class */
    function() {
      function TOIInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.sweepA = new Sweep();
        this.sweepB = new Sweep();
      }
      TOIInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.sweepA.recycle();
        this.sweepB.recycle();
        this.tMax = -1;
      };
      return TOIInput2;
    }()
  );
  exports2.TOIOutputState = void 0;
  (function(TOIOutputState2) {
    TOIOutputState2[TOIOutputState2["e_unset"] = -1] = "e_unset";
    TOIOutputState2[TOIOutputState2["e_unknown"] = 0] = "e_unknown";
    TOIOutputState2[TOIOutputState2["e_failed"] = 1] = "e_failed";
    TOIOutputState2[TOIOutputState2["e_overlapped"] = 2] = "e_overlapped";
    TOIOutputState2[TOIOutputState2["e_touching"] = 3] = "e_touching";
    TOIOutputState2[TOIOutputState2["e_separated"] = 4] = "e_separated";
  })(exports2.TOIOutputState || (exports2.TOIOutputState = {}));
  var TOIOutput = (
    /** @class */
    function() {
      function TOIOutput2() {
        this.state = exports2.TOIOutputState.e_unset;
        this.t = -1;
      }
      TOIOutput2.prototype.recycle = function() {
        this.state = exports2.TOIOutputState.e_unset;
        this.t = -1;
      };
      return TOIOutput2;
    }()
  );
  stats.toiTime = 0;
  stats.toiMaxTime = 0;
  stats.toiCalls = 0;
  stats.toiIters = 0;
  stats.toiMaxIters = 0;
  stats.toiRootIters = 0;
  stats.toiMaxRootIters = 0;
  var distanceInput = new DistanceInput();
  var distanceOutput = new DistanceOutput();
  var cache = new SimplexCache();
  var xfA$1 = transform(0, 0, 0);
  var xfB$1 = transform(0, 0, 0);
  var temp$4 = vec2(0, 0);
  var pointA$2 = vec2(0, 0);
  var pointB$2 = vec2(0, 0);
  var normal$3 = vec2(0, 0);
  var axisA = vec2(0, 0);
  var axisB = vec2(0, 0);
  var localPointA = vec2(0, 0);
  var localPointB = vec2(0, 0);
  var TimeOfImpact = function(output2, input2) {
    var timer = Timer.now();
    ++stats.toiCalls;
    output2.state = exports2.TOIOutputState.e_unknown;
    output2.t = input2.tMax;
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var sweepA = input2.sweepA;
    var sweepB = input2.sweepB;
    sweepA.normalize();
    sweepB.normalize();
    var tMax = input2.tMax;
    var totalRadius = proxyA.m_radius + proxyB.m_radius;
    var target = math_max$3(SettingsInternal.linearSlop, totalRadius - 3 * SettingsInternal.linearSlop);
    var tolerance = 0.25 * SettingsInternal.linearSlop;
    var t1 = 0;
    var k_maxIterations = SettingsInternal.maxTOIIterations;
    var iter = 0;
    cache.recycle();
    distanceInput.proxyA.setVertices(proxyA.m_vertices, proxyA.m_count, proxyA.m_radius);
    distanceInput.proxyB.setVertices(proxyB.m_vertices, proxyB.m_count, proxyB.m_radius);
    distanceInput.useRadii = false;
    while (true) {
      sweepA.getTransform(xfA$1, t1);
      sweepB.getTransform(xfB$1, t1);
      copyTransform(distanceInput.transformA, xfA$1);
      copyTransform(distanceInput.transformB, xfB$1);
      Distance(distanceOutput, cache, distanceInput);
      if (distanceOutput.distance <= 0) {
        output2.state = exports2.TOIOutputState.e_overlapped;
        output2.t = 0;
        break;
      }
      if (distanceOutput.distance < target + tolerance) {
        output2.state = exports2.TOIOutputState.e_touching;
        output2.t = t1;
        break;
      }
      separationFunction.initialize(cache, proxyA, sweepA, proxyB, sweepB, t1);
      var done = false;
      var t2 = tMax;
      var pushBackIter = 0;
      while (true) {
        var s2 = separationFunction.findMinSeparation(t2);
        if (s2 > target + tolerance) {
          output2.state = exports2.TOIOutputState.e_separated;
          output2.t = tMax;
          done = true;
          break;
        }
        if (s2 > target - tolerance) {
          t1 = t2;
          break;
        }
        var s1 = separationFunction.evaluate(t1);
        if (s1 < target - tolerance) {
          output2.state = exports2.TOIOutputState.e_failed;
          output2.t = t1;
          done = true;
          break;
        }
        if (s1 <= target + tolerance) {
          output2.state = exports2.TOIOutputState.e_touching;
          output2.t = t1;
          done = true;
          break;
        }
        var rootIterCount = 0;
        var a1 = t1;
        var a2 = t2;
        while (true) {
          var t = void 0;
          if (rootIterCount & 1) {
            t = a1 + (target - s1) * (a2 - a1) / (s2 - s1);
          } else {
            t = 0.5 * (a1 + a2);
          }
          ++rootIterCount;
          ++stats.toiRootIters;
          var s3 = separationFunction.evaluate(t);
          if (math_abs$7(s3 - target) < tolerance) {
            t2 = t;
            break;
          }
          if (s3 > target) {
            a1 = t;
            s1 = s3;
          } else {
            a2 = t;
            s2 = s3;
          }
          if (rootIterCount === 50) {
            break;
          }
        }
        stats.toiMaxRootIters = math_max$3(stats.toiMaxRootIters, rootIterCount);
        ++pushBackIter;
        if (pushBackIter === SettingsInternal.maxPolygonVertices) {
          break;
        }
      }
      ++iter;
      ++stats.toiIters;
      if (done) {
        break;
      }
      if (iter === k_maxIterations) {
        output2.state = exports2.TOIOutputState.e_failed;
        output2.t = t1;
        break;
      }
    }
    stats.toiMaxIters = math_max$3(stats.toiMaxIters, iter);
    var time = Timer.diff(timer);
    stats.toiMaxTime = math_max$3(stats.toiMaxTime, time);
    stats.toiTime += time;
    separationFunction.recycle();
  };
  var SeparationFunctionType;
  (function(SeparationFunctionType2) {
    SeparationFunctionType2[SeparationFunctionType2["e_unset"] = -1] = "e_unset";
    SeparationFunctionType2[SeparationFunctionType2["e_points"] = 1] = "e_points";
    SeparationFunctionType2[SeparationFunctionType2["e_faceA"] = 2] = "e_faceA";
    SeparationFunctionType2[SeparationFunctionType2["e_faceB"] = 3] = "e_faceB";
  })(SeparationFunctionType || (SeparationFunctionType = {}));
  var SeparationFunction = (
    /** @class */
    function() {
      function SeparationFunction2() {
        this.m_proxyA = null;
        this.m_proxyB = null;
        this.m_sweepA = null;
        this.m_sweepB = null;
        this.m_type = SeparationFunctionType.e_unset;
        this.m_localPoint = vec2(0, 0);
        this.m_axis = vec2(0, 0);
        this.indexA = -1;
        this.indexB = -1;
      }
      SeparationFunction2.prototype.recycle = function() {
        this.m_proxyA = null;
        this.m_proxyB = null;
        this.m_sweepA = null;
        this.m_sweepB = null;
        this.m_type = SeparationFunctionType.e_unset;
        zeroVec2(this.m_localPoint);
        zeroVec2(this.m_axis);
        this.indexA = -1;
        this.indexB = -1;
      };
      SeparationFunction2.prototype.initialize = function(cache2, proxyA, sweepA, proxyB, sweepB, t1) {
        var count = cache2.count;
        this.m_proxyA = proxyA;
        this.m_proxyB = proxyB;
        this.m_sweepA = sweepA;
        this.m_sweepB = sweepB;
        this.m_sweepA.getTransform(xfA$1, t1);
        this.m_sweepB.getTransform(xfB$1, t1);
        if (count === 1) {
          this.m_type = SeparationFunctionType.e_points;
          var localPointA_1 = this.m_proxyA.getVertex(cache2.indexA[0]);
          var localPointB_1 = this.m_proxyB.getVertex(cache2.indexB[0]);
          transformVec2(pointA$2, xfA$1, localPointA_1);
          transformVec2(pointB$2, xfB$1, localPointB_1);
          subVec2(this.m_axis, pointB$2, pointA$2);
          var s2 = normalizeVec2Length(this.m_axis);
          return s2;
        } else if (cache2.indexA[0] === cache2.indexA[1]) {
          this.m_type = SeparationFunctionType.e_faceB;
          var localPointB1 = proxyB.getVertex(cache2.indexB[0]);
          var localPointB2 = proxyB.getVertex(cache2.indexB[1]);
          crossVec2Num(this.m_axis, subVec2(temp$4, localPointB2, localPointB1), 1);
          normalizeVec2(this.m_axis);
          rotVec2(normal$3, xfB$1.q, this.m_axis);
          combine2Vec2(this.m_localPoint, 0.5, localPointB1, 0.5, localPointB2);
          transformVec2(pointB$2, xfB$1, this.m_localPoint);
          var localPointA_2 = proxyA.getVertex(cache2.indexA[0]);
          var pointA_1 = Transform.mulVec2(xfA$1, localPointA_2);
          var s2 = dotVec2(pointA_1, normal$3) - dotVec2(pointB$2, normal$3);
          if (s2 < 0) {
            negVec2(this.m_axis);
            s2 = -s2;
          }
          return s2;
        } else {
          this.m_type = SeparationFunctionType.e_faceA;
          var localPointA1 = this.m_proxyA.getVertex(cache2.indexA[0]);
          var localPointA2 = this.m_proxyA.getVertex(cache2.indexA[1]);
          crossVec2Num(this.m_axis, subVec2(temp$4, localPointA2, localPointA1), 1);
          normalizeVec2(this.m_axis);
          rotVec2(normal$3, xfA$1.q, this.m_axis);
          combine2Vec2(this.m_localPoint, 0.5, localPointA1, 0.5, localPointA2);
          transformVec2(pointA$2, xfA$1, this.m_localPoint);
          var localPointB_2 = this.m_proxyB.getVertex(cache2.indexB[0]);
          transformVec2(pointB$2, xfB$1, localPointB_2);
          var s2 = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);
          if (s2 < 0) {
            negVec2(this.m_axis);
            s2 = -s2;
          }
          return s2;
        }
      };
      SeparationFunction2.prototype.compute = function(find, t) {
        this.m_sweepA.getTransform(xfA$1, t);
        this.m_sweepB.getTransform(xfB$1, t);
        switch (this.m_type) {
          case SeparationFunctionType.e_points: {
            if (find) {
              derotVec2(axisA, xfA$1.q, this.m_axis);
              derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, this.m_axis));
              this.indexA = this.m_proxyA.getSupport(axisA);
              this.indexB = this.m_proxyB.getSupport(axisB);
            }
            copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));
            copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));
            transformVec2(pointA$2, xfA$1, localPointA);
            transformVec2(pointB$2, xfB$1, localPointB);
            var sep = dotVec2(pointB$2, this.m_axis) - dotVec2(pointA$2, this.m_axis);
            return sep;
          }
          case SeparationFunctionType.e_faceA: {
            rotVec2(normal$3, xfA$1.q, this.m_axis);
            transformVec2(pointA$2, xfA$1, this.m_localPoint);
            if (find) {
              derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, normal$3));
              this.indexA = -1;
              this.indexB = this.m_proxyB.getSupport(axisB);
            }
            copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));
            transformVec2(pointB$2, xfB$1, localPointB);
            var sep = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);
            return sep;
          }
          case SeparationFunctionType.e_faceB: {
            rotVec2(normal$3, xfB$1.q, this.m_axis);
            transformVec2(pointB$2, xfB$1, this.m_localPoint);
            if (find) {
              derotVec2(axisA, xfA$1.q, scaleVec2(temp$4, -1, normal$3));
              this.indexB = -1;
              this.indexA = this.m_proxyA.getSupport(axisA);
            }
            copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));
            transformVec2(pointA$2, xfA$1, localPointA);
            var sep = dotVec2(pointA$2, normal$3) - dotVec2(pointB$2, normal$3);
            return sep;
          }
          default:
            if (find) {
              this.indexA = -1;
              this.indexB = -1;
            }
            return 0;
        }
      };
      SeparationFunction2.prototype.findMinSeparation = function(t) {
        return this.compute(true, t);
      };
      SeparationFunction2.prototype.evaluate = function(t) {
        return this.compute(false, t);
      };
      return SeparationFunction2;
    }()
  );
  var separationFunction = new SeparationFunction();
  TimeOfImpact.Input = TOIInput;
  TimeOfImpact.Output = TOIOutput;
  var math_abs$6 = Math.abs;
  var math_sqrt$3 = Math.sqrt;
  var math_min$5 = Math.min;
  var TimeStep = (
    /** @class */
    function() {
      function TimeStep2() {
        this.dt = 0;
        this.inv_dt = 0;
        this.velocityIterations = 0;
        this.positionIterations = 0;
        this.warmStarting = false;
        this.blockSolve = true;
        this.inv_dt0 = 0;
        this.dtRatio = 1;
      }
      TimeStep2.prototype.reset = function(dt) {
        if (this.dt > 0) {
          this.inv_dt0 = this.inv_dt;
        }
        this.dt = dt;
        this.inv_dt = dt == 0 ? 0 : 1 / dt;
        this.dtRatio = dt * this.inv_dt0;
      };
      return TimeStep2;
    }()
  );
  var s_subStep = new TimeStep();
  var c = vec2(0, 0);
  var v = vec2(0, 0);
  var translation = vec2(0, 0);
  var input = new TOIInput();
  var output = new TOIOutput();
  var backup = new Sweep();
  var backup1 = new Sweep();
  var backup2 = new Sweep();
  var ContactImpulse = (
    /** @class */
    function() {
      function ContactImpulse2(contact) {
        this.contact = contact;
        this.normals = [];
        this.tangents = [];
      }
      ContactImpulse2.prototype.recycle = function() {
        this.normals.length = 0;
        this.tangents.length = 0;
      };
      Object.defineProperty(ContactImpulse2.prototype, "normalImpulses", {
        get: function() {
          var contact = this.contact;
          var normals = this.normals;
          normals.length = 0;
          for (var p = 0; p < contact.v_points.length; ++p) {
            normals.push(contact.v_points[p].normalImpulse);
          }
          return normals;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(ContactImpulse2.prototype, "tangentImpulses", {
        get: function() {
          var contact = this.contact;
          var tangents = this.tangents;
          tangents.length = 0;
          for (var p = 0; p < contact.v_points.length; ++p) {
            tangents.push(contact.v_points[p].tangentImpulse);
          }
          return tangents;
        },
        enumerable: false,
        configurable: true
      });
      return ContactImpulse2;
    }()
  );
  var Solver = (
    /** @class */
    function() {
      function Solver2(world) {
        this.m_world = world;
        this.m_stack = [];
        this.m_bodies = [];
        this.m_contacts = [];
        this.m_joints = [];
      }
      Solver2.prototype.clear = function() {
        this.m_stack.length = 0;
        this.m_bodies.length = 0;
        this.m_contacts.length = 0;
        this.m_joints.length = 0;
      };
      Solver2.prototype.addBody = function(body) {
        this.m_bodies.push(body);
      };
      Solver2.prototype.addContact = function(contact) {
        this.m_contacts.push(contact);
      };
      Solver2.prototype.addJoint = function(joint) {
        this.m_joints.push(joint);
      };
      Solver2.prototype.solveWorld = function(step) {
        var world = this.m_world;
        for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {
          b2.m_islandFlag = false;
        }
        for (var c_1 = world.m_contactList; c_1; c_1 = c_1.m_next) {
          c_1.m_islandFlag = false;
        }
        for (var j = world.m_jointList; j; j = j.m_next) {
          j.m_islandFlag = false;
        }
        var stack = this.m_stack;
        for (var seed = world.m_bodyList; seed; seed = seed.m_next) {
          if (seed.m_islandFlag) {
            continue;
          }
          if (seed.isAwake() == false || seed.isActive() == false) {
            continue;
          }
          if (seed.isStatic()) {
            continue;
          }
          this.clear();
          stack.push(seed);
          seed.m_islandFlag = true;
          while (stack.length > 0) {
            var b2 = stack.pop();
            this.addBody(b2);
            b2.m_awakeFlag = true;
            if (b2.isStatic()) {
              continue;
            }
            for (var ce = b2.m_contactList; ce; ce = ce.next) {
              var contact = ce.contact;
              if (contact.m_islandFlag) {
                continue;
              }
              if (contact.isEnabled() == false || contact.isTouching() == false) {
                continue;
              }
              var sensorA = contact.m_fixtureA.m_isSensor;
              var sensorB = contact.m_fixtureB.m_isSensor;
              if (sensorA || sensorB) {
                continue;
              }
              this.addContact(contact);
              contact.m_islandFlag = true;
              var other = ce.other;
              if (other.m_islandFlag) {
                continue;
              }
              stack.push(other);
              other.m_islandFlag = true;
            }
            for (var je = b2.m_jointList; je; je = je.next) {
              if (je.joint.m_islandFlag == true) {
                continue;
              }
              var other = je.other;
              if (other.isActive() == false) {
                continue;
              }
              this.addJoint(je.joint);
              je.joint.m_islandFlag = true;
              if (other.m_islandFlag) {
                continue;
              }
              stack.push(other);
              other.m_islandFlag = true;
            }
          }
          this.solveIsland(step);
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var b2 = this.m_bodies[i];
            if (b2.isStatic()) {
              b2.m_islandFlag = false;
            }
          }
        }
      };
      Solver2.prototype.solveIsland = function(step) {
        var world = this.m_world;
        var gravity = world.m_gravity;
        var allowSleep = world.m_allowSleep;
        var h = step.dt;
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.m_sweep.c);
          var a2 = body.m_sweep.a;
          copyVec2(v, body.m_linearVelocity);
          var w = body.m_angularVelocity;
          copyVec2(body.m_sweep.c0, body.m_sweep.c);
          body.m_sweep.a0 = body.m_sweep.a;
          if (body.isDynamic()) {
            plusScaleVec2(v, h * body.m_gravityScale, gravity);
            plusScaleVec2(v, h * body.m_invMass, body.m_force);
            w += h * body.m_invI * body.m_torque;
            scaleVec2(v, 1 / (1 + h * body.m_linearDamping), v);
            w *= 1 / (1 + h * body.m_angularDamping);
          }
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initConstraint(step);
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initVelocityConstraint(step);
        }
        if (step.warmStarting) {
          for (var i = 0; i < this.m_contacts.length; ++i) {
            var contact = this.m_contacts[i];
            contact.warmStartConstraint(step);
          }
        }
        for (var i = 0; i < this.m_joints.length; ++i) {
          var joint = this.m_joints[i];
          joint.initVelocityConstraints(step);
        }
        for (var i = 0; i < step.velocityIterations; ++i) {
          for (var j = 0; j < this.m_joints.length; ++j) {
            var joint = this.m_joints[j];
            joint.solveVelocityConstraints(step);
          }
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            contact.solveVelocityConstraint(step);
          }
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.storeConstraintImpulses(step);
        }
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.c_position.c);
          var a2 = body.c_position.a;
          copyVec2(v, body.c_velocity.v);
          var w = body.c_velocity.w;
          scaleVec2(translation, h, v);
          var translationLengthSqr = lengthSqrVec2(translation);
          if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {
            var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);
            mulVec2(v, ratio);
          }
          var rotation2 = h * w;
          if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {
            var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);
            w *= ratio;
          }
          plusScaleVec2(c, h, v);
          a2 += h * w;
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
        }
        var positionSolved = false;
        for (var i = 0; i < step.positionIterations; ++i) {
          var minSeparation = 0;
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            var separation = contact.solvePositionConstraint(step);
            minSeparation = math_min$5(minSeparation, separation);
          }
          var contactsOkay = minSeparation >= -3 * SettingsInternal.linearSlop;
          var jointsOkay = true;
          for (var j = 0; j < this.m_joints.length; ++j) {
            var joint = this.m_joints[j];
            var jointOkay = joint.solvePositionConstraints(step);
            jointsOkay = jointsOkay && jointOkay;
          }
          if (contactsOkay && jointsOkay) {
            positionSolved = true;
            break;
          }
        }
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(body.m_sweep.c, body.c_position.c);
          body.m_sweep.a = body.c_position.a;
          copyVec2(body.m_linearVelocity, body.c_velocity.v);
          body.m_angularVelocity = body.c_velocity.w;
          body.synchronizeTransform();
        }
        this.postSolveIsland();
        if (allowSleep) {
          var minSleepTime = Infinity;
          var linTolSqr = SettingsInternal.linearSleepToleranceSqr;
          var angTolSqr = SettingsInternal.angularSleepToleranceSqr;
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var body = this.m_bodies[i];
            if (body.isStatic()) {
              continue;
            }
            if (body.m_autoSleepFlag == false || body.m_angularVelocity * body.m_angularVelocity > angTolSqr || lengthSqrVec2(body.m_linearVelocity) > linTolSqr) {
              body.m_sleepTime = 0;
              minSleepTime = 0;
            } else {
              body.m_sleepTime += h;
              minSleepTime = math_min$5(minSleepTime, body.m_sleepTime);
            }
          }
          if (minSleepTime >= SettingsInternal.timeToSleep && positionSolved) {
            for (var i = 0; i < this.m_bodies.length; ++i) {
              var body = this.m_bodies[i];
              body.setAwake(false);
            }
          }
        }
      };
      Solver2.prototype.solveWorldTOI = function(step) {
        var world = this.m_world;
        if (world.m_stepComplete) {
          for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {
            b2.m_islandFlag = false;
            b2.m_sweep.alpha0 = 0;
          }
          for (var c_2 = world.m_contactList; c_2; c_2 = c_2.m_next) {
            c_2.m_toiFlag = false;
            c_2.m_islandFlag = false;
            c_2.m_toiCount = 0;
            c_2.m_toi = 1;
          }
        }
        while (true) {
          var minContact = null;
          var minAlpha = 1;
          for (var c_3 = world.m_contactList; c_3; c_3 = c_3.m_next) {
            if (c_3.isEnabled() == false) {
              continue;
            }
            if (c_3.m_toiCount > SettingsInternal.maxSubSteps) {
              continue;
            }
            var alpha = 1;
            if (c_3.m_toiFlag) {
              alpha = c_3.m_toi;
            } else {
              var fA_1 = c_3.getFixtureA();
              var fB_1 = c_3.getFixtureB();
              if (fA_1.isSensor() || fB_1.isSensor()) {
                continue;
              }
              var bA_1 = fA_1.getBody();
              var bB_1 = fB_1.getBody();
              var activeA = bA_1.isAwake() && !bA_1.isStatic();
              var activeB = bB_1.isAwake() && !bB_1.isStatic();
              if (activeA == false && activeB == false) {
                continue;
              }
              var collideA = bA_1.isBullet() || !bA_1.isDynamic();
              var collideB = bB_1.isBullet() || !bB_1.isDynamic();
              if (collideA == false && collideB == false) {
                continue;
              }
              var alpha0 = bA_1.m_sweep.alpha0;
              if (bA_1.m_sweep.alpha0 < bB_1.m_sweep.alpha0) {
                alpha0 = bB_1.m_sweep.alpha0;
                bA_1.m_sweep.advance(alpha0);
              } else if (bB_1.m_sweep.alpha0 < bA_1.m_sweep.alpha0) {
                alpha0 = bA_1.m_sweep.alpha0;
                bB_1.m_sweep.advance(alpha0);
              }
              var indexA = c_3.getChildIndexA();
              var indexB = c_3.getChildIndexB();
              input.proxyA.set(fA_1.getShape(), indexA);
              input.proxyB.set(fB_1.getShape(), indexB);
              input.sweepA.set(bA_1.m_sweep);
              input.sweepB.set(bB_1.m_sweep);
              input.tMax = 1;
              TimeOfImpact(output, input);
              var beta = output.t;
              if (output.state == exports2.TOIOutputState.e_touching) {
                alpha = math_min$5(alpha0 + (1 - alpha0) * beta, 1);
              } else {
                alpha = 1;
              }
              c_3.m_toi = alpha;
              c_3.m_toiFlag = true;
            }
            if (alpha < minAlpha) {
              minContact = c_3;
              minAlpha = alpha;
            }
          }
          if (minContact == null || 1 - 10 * EPSILON < minAlpha) {
            world.m_stepComplete = true;
            break;
          }
          var fA = minContact.getFixtureA();
          var fB = minContact.getFixtureB();
          var bA = fA.getBody();
          var bB = fB.getBody();
          backup1.set(bA.m_sweep);
          backup2.set(bB.m_sweep);
          bA.advance(minAlpha);
          bB.advance(minAlpha);
          minContact.update(world);
          minContact.m_toiFlag = false;
          ++minContact.m_toiCount;
          if (minContact.isEnabled() == false || minContact.isTouching() == false) {
            minContact.setEnabled(false);
            bA.m_sweep.set(backup1);
            bB.m_sweep.set(backup2);
            bA.synchronizeTransform();
            bB.synchronizeTransform();
            continue;
          }
          bA.setAwake(true);
          bB.setAwake(true);
          this.clear();
          this.addBody(bA);
          this.addBody(bB);
          this.addContact(minContact);
          bA.m_islandFlag = true;
          bB.m_islandFlag = true;
          minContact.m_islandFlag = true;
          var bodies = [bA, bB];
          for (var i = 0; i < bodies.length; ++i) {
            var body = bodies[i];
            if (body.isDynamic()) {
              for (var ce = body.m_contactList; ce; ce = ce.next) {
                var contact = ce.contact;
                if (contact.m_islandFlag) {
                  continue;
                }
                var other = ce.other;
                if (other.isDynamic() && !body.isBullet() && !other.isBullet()) {
                  continue;
                }
                var sensorA = contact.m_fixtureA.m_isSensor;
                var sensorB = contact.m_fixtureB.m_isSensor;
                if (sensorA || sensorB) {
                  continue;
                }
                backup.set(other.m_sweep);
                if (other.m_islandFlag == false) {
                  other.advance(minAlpha);
                }
                contact.update(world);
                if (contact.isEnabled() == false || contact.isTouching() == false) {
                  other.m_sweep.set(backup);
                  other.synchronizeTransform();
                  continue;
                }
                contact.m_islandFlag = true;
                this.addContact(contact);
                if (other.m_islandFlag) {
                  continue;
                }
                other.m_islandFlag = true;
                if (!other.isStatic()) {
                  other.setAwake(true);
                }
                this.addBody(other);
              }
            }
          }
          s_subStep.reset((1 - minAlpha) * step.dt);
          s_subStep.dtRatio = 1;
          s_subStep.positionIterations = 20;
          s_subStep.velocityIterations = step.velocityIterations;
          s_subStep.warmStarting = false;
          this.solveIslandTOI(s_subStep, bA, bB);
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var body = this.m_bodies[i];
            body.m_islandFlag = false;
            if (!body.isDynamic()) {
              continue;
            }
            body.synchronizeFixtures();
            for (var ce = body.m_contactList; ce; ce = ce.next) {
              ce.contact.m_toiFlag = false;
              ce.contact.m_islandFlag = false;
            }
          }
          world.findNewContacts();
          if (world.m_subStepping) {
            world.m_stepComplete = false;
            break;
          }
        }
      };
      Solver2.prototype.solveIslandTOI = function(subStep, toiA, toiB) {
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(body.c_position.c, body.m_sweep.c);
          body.c_position.a = body.m_sweep.a;
          copyVec2(body.c_velocity.v, body.m_linearVelocity);
          body.c_velocity.w = body.m_angularVelocity;
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initConstraint(subStep);
        }
        for (var i = 0; i < subStep.positionIterations; ++i) {
          var minSeparation = 0;
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            var separation = contact.solvePositionConstraintTOI(subStep, toiA, toiB);
            minSeparation = math_min$5(minSeparation, separation);
          }
          var contactsOkay = minSeparation >= -1.5 * SettingsInternal.linearSlop;
          if (contactsOkay) {
            break;
          }
        }
        var i;
        copyVec2(toiA.m_sweep.c0, toiA.c_position.c);
        toiA.m_sweep.a0 = toiA.c_position.a;
        copyVec2(toiB.m_sweep.c0, toiB.c_position.c);
        toiB.m_sweep.a0 = toiB.c_position.a;
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initVelocityConstraint(subStep);
        }
        for (var i = 0; i < subStep.velocityIterations; ++i) {
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            contact.solveVelocityConstraint(subStep);
          }
        }
        var h = subStep.dt;
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.c_position.c);
          var a2 = body.c_position.a;
          copyVec2(v, body.c_velocity.v);
          var w = body.c_velocity.w;
          scaleVec2(translation, h, v);
          var translationLengthSqr = lengthSqrVec2(translation);
          if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {
            var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);
            mulVec2(v, ratio);
          }
          var rotation2 = h * w;
          if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {
            var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);
            w *= ratio;
          }
          plusScaleVec2(c, h, v);
          a2 += h * w;
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
          copyVec2(body.m_sweep.c, c);
          body.m_sweep.a = a2;
          copyVec2(body.m_linearVelocity, v);
          body.m_angularVelocity = w;
          body.synchronizeTransform();
        }
        this.postSolveIsland();
      };
      Solver2.prototype.postSolveIsland = function() {
        for (var c_5 = 0; c_5 < this.m_contacts.length; ++c_5) {
          var contact = this.m_contacts[c_5];
          this.m_world.postSolve(contact, contact.m_impulse);
        }
      };
      return Solver2;
    }()
  );
  Solver.TimeStep = TimeStep;
  var Mat22 = (
    /** @class */
    function() {
      function Mat222(a2, b2, c2, d2) {
        if (typeof a2 === "object" && a2 !== null) {
          this.ex = Vec2.clone(a2);
          this.ey = Vec2.clone(b2);
        } else if (typeof a2 === "number") {
          this.ex = Vec2.neo(a2, c2);
          this.ey = Vec2.neo(b2, d2);
        } else {
          this.ex = Vec2.zero();
          this.ey = Vec2.zero();
        }
      }
      Mat222.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Mat222.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.ex) && Vec2.isValid(obj.ey);
      };
      Mat222.assert = function(o) {
      };
      Mat222.prototype.set = function(a2, b2, c2, d2) {
        if (typeof a2 === "number" && typeof b2 === "number" && typeof c2 === "number" && typeof d2 === "number") {
          this.ex.setNum(a2, c2);
          this.ey.setNum(b2, d2);
        } else if (typeof a2 === "object" && typeof b2 === "object") {
          this.ex.setVec2(a2);
          this.ey.setVec2(b2);
        } else if (typeof a2 === "object") {
          this.ex.setVec2(a2.ex);
          this.ey.setVec2(a2.ey);
        } else ;
      };
      Mat222.prototype.setIdentity = function() {
        this.ex.x = 1;
        this.ey.x = 0;
        this.ex.y = 0;
        this.ey.y = 1;
      };
      Mat222.prototype.setZero = function() {
        this.ex.x = 0;
        this.ey.x = 0;
        this.ex.y = 0;
        this.ey.y = 0;
      };
      Mat222.prototype.getInverse = function() {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        var imx = new Mat222();
        imx.ex.x = det * d2;
        imx.ey.x = -det * b2;
        imx.ex.y = -det * c2;
        imx.ey.y = det * a2;
        return imx;
      };
      Mat222.prototype.solve = function(v3) {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        var w = Vec2.zero();
        w.x = det * (d2 * v3.x - b2 * v3.y);
        w.y = det * (a2 * v3.y - c2 * v3.x);
        return w;
      };
      Mat222.mul = function(mx, v3) {
        if (v3 && "x" in v3 && "y" in v3) {
          var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;
          var y = mx.ex.y * v3.x + mx.ey.y * v3.y;
          return Vec2.neo(x2, y);
        } else if (v3 && "ex" in v3 && "ey" in v3) {
          var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;
          var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;
          var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;
          var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;
          return new Mat222(a2, b2, c2, d2);
        }
      };
      Mat222.mulVec2 = function(mx, v3) {
        var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;
        var y = mx.ex.y * v3.x + mx.ey.y * v3.y;
        return Vec2.neo(x2, y);
      };
      Mat222.mulMat22 = function(mx, v3) {
        var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;
        var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;
        var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;
        var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;
        return new Mat222(a2, b2, c2, d2);
      };
      Mat222.mulT = function(mx, v3) {
        if (v3 && "x" in v3 && "y" in v3) {
          return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));
        } else if (v3 && "ex" in v3 && "ey" in v3) {
          var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));
          var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));
          return new Mat222(c1, c2);
        }
      };
      Mat222.mulTVec2 = function(mx, v3) {
        return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));
      };
      Mat222.mulTMat22 = function(mx, v3) {
        var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));
        var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));
        return new Mat222(c1, c2);
      };
      Mat222.abs = function(mx) {
        return new Mat222(Vec2.abs(mx.ex), Vec2.abs(mx.ey));
      };
      Mat222.add = function(mx1, mx2) {
        return new Mat222(Vec2.add(mx1.ex, mx2.ex), Vec2.add(mx1.ey, mx2.ey));
      };
      return Mat222;
    }()
  );
  var math_sqrt$2 = Math.sqrt;
  var pointA$1 = vec2(0, 0);
  var pointB$1 = vec2(0, 0);
  var temp$3 = vec2(0, 0);
  var cA$1 = vec2(0, 0);
  var cB$1 = vec2(0, 0);
  var dist = vec2(0, 0);
  var planePoint$2 = vec2(0, 0);
  var clipPoint$1 = vec2(0, 0);
  exports2.ManifoldType = void 0;
  (function(ManifoldType2) {
    ManifoldType2[ManifoldType2["e_unset"] = -1] = "e_unset";
    ManifoldType2[ManifoldType2["e_circles"] = 0] = "e_circles";
    ManifoldType2[ManifoldType2["e_faceA"] = 1] = "e_faceA";
    ManifoldType2[ManifoldType2["e_faceB"] = 2] = "e_faceB";
  })(exports2.ManifoldType || (exports2.ManifoldType = {}));
  exports2.ContactFeatureType = void 0;
  (function(ContactFeatureType2) {
    ContactFeatureType2[ContactFeatureType2["e_unset"] = -1] = "e_unset";
    ContactFeatureType2[ContactFeatureType2["e_vertex"] = 0] = "e_vertex";
    ContactFeatureType2[ContactFeatureType2["e_face"] = 1] = "e_face";
  })(exports2.ContactFeatureType || (exports2.ContactFeatureType = {}));
  exports2.PointState = void 0;
  (function(PointState2) {
    PointState2[PointState2["nullState"] = 0] = "nullState";
    PointState2[PointState2["addState"] = 1] = "addState";
    PointState2[PointState2["persistState"] = 2] = "persistState";
    PointState2[PointState2["removeState"] = 3] = "removeState";
  })(exports2.PointState || (exports2.PointState = {}));
  var ClipVertex = (
    /** @class */
    function() {
      function ClipVertex2() {
        this.v = vec2(0, 0);
        this.id = new ContactID();
      }
      ClipVertex2.prototype.set = function(o) {
        copyVec2(this.v, o.v);
        this.id.set(o.id);
      };
      ClipVertex2.prototype.recycle = function() {
        zeroVec2(this.v);
        this.id.recycle();
      };
      return ClipVertex2;
    }()
  );
  var Manifold = (
    /** @class */
    function() {
      function Manifold2() {
        this.localNormal = vec2(0, 0);
        this.localPoint = vec2(0, 0);
        this.points = [new ManifoldPoint(), new ManifoldPoint()];
        this.pointCount = 0;
      }
      Manifold2.prototype.set = function(that) {
        this.type = that.type;
        copyVec2(this.localNormal, that.localNormal);
        copyVec2(this.localPoint, that.localPoint);
        this.pointCount = that.pointCount;
        this.points[0].set(that.points[0]);
        this.points[1].set(that.points[1]);
      };
      Manifold2.prototype.recycle = function() {
        this.type = exports2.ManifoldType.e_unset;
        zeroVec2(this.localNormal);
        zeroVec2(this.localPoint);
        this.pointCount = 0;
        this.points[0].recycle();
        this.points[1].recycle();
      };
      Manifold2.prototype.getWorldManifold = function(wm, xfA2, radiusA, xfB2, radiusB) {
        if (this.pointCount == 0) {
          return wm;
        }
        wm = wm || new WorldManifold();
        wm.pointCount = this.pointCount;
        var normal3 = wm.normal;
        var points = wm.points;
        var separations = wm.separations;
        switch (this.type) {
          case exports2.ManifoldType.e_circles: {
            setVec2(normal3, 1, 0);
            var manifoldPoint = this.points[0];
            transformVec2(pointA$1, xfA2, this.localPoint);
            transformVec2(pointB$1, xfB2, manifoldPoint.localPoint);
            subVec2(dist, pointB$1, pointA$1);
            var lengthSqr = lengthSqrVec2(dist);
            if (lengthSqr > EPSILON * EPSILON) {
              var length_1 = math_sqrt$2(lengthSqr);
              scaleVec2(normal3, 1 / length_1, dist);
            }
            combine2Vec2(cA$1, 1, pointA$1, radiusA, normal3);
            combine2Vec2(cB$1, 1, pointB$1, -radiusB, normal3);
            combine2Vec2(points[0], 0.5, cA$1, 0.5, cB$1);
            separations[0] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);
            break;
          }
          case exports2.ManifoldType.e_faceA: {
            rotVec2(normal3, xfA2.q, this.localNormal);
            transformVec2(planePoint$2, xfA2, this.localPoint);
            for (var i = 0; i < this.pointCount; ++i) {
              var manifoldPoint = this.points[i];
              transformVec2(clipPoint$1, xfB2, manifoldPoint.localPoint);
              combine2Vec2(cA$1, 1, clipPoint$1, radiusA - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);
              combine2Vec2(cB$1, 1, clipPoint$1, -radiusB, normal3);
              combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);
              separations[i] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);
            }
            break;
          }
          case exports2.ManifoldType.e_faceB: {
            rotVec2(normal3, xfB2.q, this.localNormal);
            transformVec2(planePoint$2, xfB2, this.localPoint);
            for (var i = 0; i < this.pointCount; ++i) {
              var manifoldPoint = this.points[i];
              transformVec2(clipPoint$1, xfA2, manifoldPoint.localPoint);
              combine2Vec2(cB$1, 1, clipPoint$1, radiusB - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);
              combine2Vec2(cA$1, 1, clipPoint$1, -radiusA, normal3);
              combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);
              separations[i] = dotVec2(subVec2(temp$3, cA$1, cB$1), normal3);
            }
            negVec2(normal3);
            break;
          }
        }
        return wm;
      };
      Manifold2.clipSegmentToLine = clipSegmentToLine;
      Manifold2.ClipVertex = ClipVertex;
      Manifold2.getPointStates = getPointStates;
      Manifold2.PointState = exports2.PointState;
      return Manifold2;
    }()
  );
  var ManifoldPoint = (
    /** @class */
    function() {
      function ManifoldPoint2() {
        this.localPoint = vec2(0, 0);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.id = new ContactID();
      }
      ManifoldPoint2.prototype.set = function(that) {
        copyVec2(this.localPoint, that.localPoint);
        this.normalImpulse = that.normalImpulse;
        this.tangentImpulse = that.tangentImpulse;
        this.id.set(that.id);
      };
      ManifoldPoint2.prototype.recycle = function() {
        zeroVec2(this.localPoint);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.id.recycle();
      };
      return ManifoldPoint2;
    }()
  );
  var ContactID = (
    /** @class */
    function() {
      function ContactID2() {
        this.key = -1;
        this.indexA = -1;
        this.indexB = -1;
        this.typeA = exports2.ContactFeatureType.e_unset;
        this.typeB = exports2.ContactFeatureType.e_unset;
      }
      ContactID2.prototype.setFeatures = function(indexA, typeA, indexB, typeB) {
        this.indexA = indexA;
        this.indexB = indexB;
        this.typeA = typeA;
        this.typeB = typeB;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.set = function(that) {
        this.indexA = that.indexA;
        this.indexB = that.indexB;
        this.typeA = that.typeA;
        this.typeB = that.typeB;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.swapFeatures = function() {
        var indexA = this.indexA;
        var indexB = this.indexB;
        var typeA = this.typeA;
        var typeB = this.typeB;
        this.indexA = indexB;
        this.indexB = indexA;
        this.typeA = typeB;
        this.typeB = typeA;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.recycle = function() {
        this.indexA = 0;
        this.indexB = 0;
        this.typeA = exports2.ContactFeatureType.e_unset;
        this.typeB = exports2.ContactFeatureType.e_unset;
        this.key = -1;
      };
      return ContactID2;
    }()
  );
  var WorldManifold = (
    /** @class */
    function() {
      function WorldManifold2() {
        this.normal = vec2(0, 0);
        this.points = [vec2(0, 0), vec2(0, 0)];
        this.separations = [0, 0];
        this.pointCount = 0;
      }
      WorldManifold2.prototype.recycle = function() {
        zeroVec2(this.normal);
        zeroVec2(this.points[0]);
        zeroVec2(this.points[1]);
        this.separations[0] = 0;
        this.separations[1] = 0;
        this.pointCount = 0;
      };
      return WorldManifold2;
    }()
  );
  function getPointStates(state1, state2, manifold1, manifold2) {
    for (var i = 0; i < manifold1.pointCount; ++i) {
      var id = manifold1.points[i].id;
      state1[i] = exports2.PointState.removeState;
      for (var j = 0; j < manifold2.pointCount; ++j) {
        if (manifold2.points[j].id.key === id.key) {
          state1[i] = exports2.PointState.persistState;
          break;
        }
      }
    }
    for (var i = 0; i < manifold2.pointCount; ++i) {
      var id = manifold2.points[i].id;
      state2[i] = exports2.PointState.addState;
      for (var j = 0; j < manifold1.pointCount; ++j) {
        if (manifold1.points[j].id.key === id.key) {
          state2[i] = exports2.PointState.persistState;
          break;
        }
      }
    }
  }
  function clipSegmentToLine(vOut, vIn, normal3, offset, vertexIndexA) {
    var numOut = 0;
    var distance0 = dotVec2(normal3, vIn[0].v) - offset;
    var distance1 = dotVec2(normal3, vIn[1].v) - offset;
    if (distance0 <= 0)
      vOut[numOut++].set(vIn[0]);
    if (distance1 <= 0)
      vOut[numOut++].set(vIn[1]);
    if (distance0 * distance1 < 0) {
      var interp = distance0 / (distance0 - distance1);
      combine2Vec2(vOut[numOut].v, 1 - interp, vIn[0].v, interp, vIn[1].v);
      vOut[numOut].id.setFeatures(vertexIndexA, exports2.ContactFeatureType.e_vertex, vIn[0].id.indexB, exports2.ContactFeatureType.e_face);
      ++numOut;
    }
    return numOut;
  }
  var math_sqrt$1 = Math.sqrt;
  var math_max$2 = Math.max;
  var math_min$4 = Math.min;
  var contactPool = new Pool({
    create: function() {
      return new Contact();
    },
    release: function(contact) {
      contact.recycle();
    }
  });
  var oldManifold = new Manifold();
  var worldManifold = new WorldManifold();
  var ContactEdge = (
    /** @class */
    function() {
      function ContactEdge2(contact) {
        this.prev = null;
        this.next = null;
        this.other = null;
        this.contact = contact;
      }
      ContactEdge2.prototype.recycle = function() {
        this.prev = null;
        this.next = null;
        this.other = null;
      };
      return ContactEdge2;
    }()
  );
  function mixFriction(friction1, friction2) {
    return math_sqrt$1(friction1 * friction2);
  }
  function mixRestitution(restitution1, restitution2) {
    return restitution1 > restitution2 ? restitution1 : restitution2;
  }
  var s_registers = [];
  var VelocityConstraintPoint = (
    /** @class */
    function() {
      function VelocityConstraintPoint2() {
        this.rA = vec2(0, 0);
        this.rB = vec2(0, 0);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.normalMass = 0;
        this.tangentMass = 0;
        this.velocityBias = 0;
      }
      VelocityConstraintPoint2.prototype.recycle = function() {
        zeroVec2(this.rA);
        zeroVec2(this.rB);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.normalMass = 0;
        this.tangentMass = 0;
        this.velocityBias = 0;
      };
      return VelocityConstraintPoint2;
    }()
  );
  var cA = vec2(0, 0);
  var vA = vec2(0, 0);
  var cB = vec2(0, 0);
  var vB = vec2(0, 0);
  var tangent$1 = vec2(0, 0);
  var xfA = transform(0, 0, 0);
  var xfB = transform(0, 0, 0);
  var pointA = vec2(0, 0);
  var pointB = vec2(0, 0);
  var clipPoint = vec2(0, 0);
  var planePoint$1 = vec2(0, 0);
  var rA = vec2(0, 0);
  var rB = vec2(0, 0);
  var P$1 = vec2(0, 0);
  var normal$2 = vec2(0, 0);
  var point = vec2(0, 0);
  var dv = vec2(0, 0);
  var dv1 = vec2(0, 0);
  var dv2 = vec2(0, 0);
  var b = vec2(0, 0);
  var a = vec2(0, 0);
  var x = vec2(0, 0);
  var d = vec2(0, 0);
  var P1 = vec2(0, 0);
  var P2 = vec2(0, 0);
  var temp$2 = vec2(0, 0);
  var Contact = (
    /** @class */
    function() {
      function Contact2() {
        this.m_nodeA = new ContactEdge(this);
        this.m_nodeB = new ContactEdge(this);
        this.m_fixtureA = null;
        this.m_fixtureB = null;
        this.m_indexA = -1;
        this.m_indexB = -1;
        this.m_evaluateFcn = null;
        this.m_manifold = new Manifold();
        this.m_prev = null;
        this.m_next = null;
        this.m_toi = 1;
        this.m_toiCount = 0;
        this.m_toiFlag = false;
        this.m_friction = 0;
        this.m_restitution = 0;
        this.m_tangentSpeed = 0;
        this.m_enabledFlag = true;
        this.m_islandFlag = false;
        this.m_touchingFlag = false;
        this.m_filterFlag = false;
        this.m_bulletHitFlag = false;
        this.m_impulse = new ContactImpulse(this);
        this.v_points = [new VelocityConstraintPoint(), new VelocityConstraintPoint()];
        this.v_normal = vec2(0, 0);
        this.v_normalMass = new Mat22();
        this.v_K = new Mat22();
        this.v_pointCount = 0;
        this.v_tangentSpeed = 0;
        this.v_friction = 0;
        this.v_restitution = 0;
        this.v_invMassA = 0;
        this.v_invMassB = 0;
        this.v_invIA = 0;
        this.v_invIB = 0;
        this.p_localPoints = [vec2(0, 0), vec2(0, 0)];
        this.p_localNormal = vec2(0, 0);
        this.p_localPoint = vec2(0, 0);
        this.p_localCenterA = vec2(0, 0);
        this.p_localCenterB = vec2(0, 0);
        this.p_type = exports2.ManifoldType.e_unset;
        this.p_radiusA = 0;
        this.p_radiusB = 0;
        this.p_pointCount = 0;
        this.p_invMassA = 0;
        this.p_invMassB = 0;
        this.p_invIA = 0;
        this.p_invIB = 0;
      }
      Contact2.prototype.initialize = function(fA, indexA, fB, indexB, evaluateFcn) {
        this.m_fixtureA = fA;
        this.m_fixtureB = fB;
        this.m_indexA = indexA;
        this.m_indexB = indexB;
        this.m_evaluateFcn = evaluateFcn;
        this.m_friction = mixFriction(this.m_fixtureA.m_friction, this.m_fixtureB.m_friction);
        this.m_restitution = mixRestitution(this.m_fixtureA.m_restitution, this.m_fixtureB.m_restitution);
      };
      Contact2.prototype.recycle = function() {
        this.m_nodeA.recycle();
        this.m_nodeB.recycle();
        this.m_fixtureA = null;
        this.m_fixtureB = null;
        this.m_indexA = -1;
        this.m_indexB = -1;
        this.m_evaluateFcn = null;
        this.m_manifold.recycle();
        this.m_prev = null;
        this.m_next = null;
        this.m_toi = 1;
        this.m_toiCount = 0;
        this.m_toiFlag = false;
        this.m_friction = 0;
        this.m_restitution = 0;
        this.m_tangentSpeed = 0;
        this.m_enabledFlag = true;
        this.m_islandFlag = false;
        this.m_touchingFlag = false;
        this.m_filterFlag = false;
        this.m_bulletHitFlag = false;
        this.m_impulse.recycle();
        for (var _i = 0, _a2 = this.v_points; _i < _a2.length; _i++) {
          var point_1 = _a2[_i];
          point_1.recycle();
        }
        zeroVec2(this.v_normal);
        this.v_normalMass.setZero();
        this.v_K.setZero();
        this.v_pointCount = 0;
        this.v_tangentSpeed = 0;
        this.v_friction = 0;
        this.v_restitution = 0;
        this.v_invMassA = 0;
        this.v_invMassB = 0;
        this.v_invIA = 0;
        this.v_invIB = 0;
        for (var _b = 0, _c = this.p_localPoints; _b < _c.length; _b++) {
          var point_2 = _c[_b];
          zeroVec2(point_2);
        }
        zeroVec2(this.p_localNormal);
        zeroVec2(this.p_localPoint);
        zeroVec2(this.p_localCenterA);
        zeroVec2(this.p_localCenterB);
        this.p_type = exports2.ManifoldType.e_unset;
        this.p_radiusA = 0;
        this.p_radiusB = 0;
        this.p_pointCount = 0;
        this.p_invMassA = 0;
        this.p_invMassB = 0;
        this.p_invIA = 0;
        this.p_invIB = 0;
      };
      Contact2.prototype.initConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        var manifold = this.m_manifold;
        var pointCount = manifold.pointCount;
        this.v_invMassA = bodyA.m_invMass;
        this.v_invMassB = bodyB.m_invMass;
        this.v_invIA = bodyA.m_invI;
        this.v_invIB = bodyB.m_invI;
        this.v_friction = this.m_friction;
        this.v_restitution = this.m_restitution;
        this.v_tangentSpeed = this.m_tangentSpeed;
        this.v_pointCount = pointCount;
        this.v_K.setZero();
        this.v_normalMass.setZero();
        this.p_invMassA = bodyA.m_invMass;
        this.p_invMassB = bodyB.m_invMass;
        this.p_invIA = bodyA.m_invI;
        this.p_invIB = bodyB.m_invI;
        copyVec2(this.p_localCenterA, bodyA.m_sweep.localCenter);
        copyVec2(this.p_localCenterB, bodyB.m_sweep.localCenter);
        this.p_radiusA = shapeA.m_radius;
        this.p_radiusB = shapeB.m_radius;
        this.p_type = manifold.type;
        copyVec2(this.p_localNormal, manifold.localNormal);
        copyVec2(this.p_localPoint, manifold.localPoint);
        this.p_pointCount = pointCount;
        for (var j = 0; j < SettingsInternal.maxManifoldPoints; ++j) {
          this.v_points[j].recycle();
          zeroVec2(this.p_localPoints[j]);
        }
        for (var j = 0; j < pointCount; ++j) {
          var cp = manifold.points[j];
          var vcp = this.v_points[j];
          if (step.warmStarting) {
            vcp.normalImpulse = step.dtRatio * cp.normalImpulse;
            vcp.tangentImpulse = step.dtRatio * cp.tangentImpulse;
          }
          copyVec2(this.p_localPoints[j], cp.localPoint);
        }
      };
      Contact2.prototype.getManifold = function() {
        return this.m_manifold;
      };
      Contact2.prototype.getWorldManifold = function(worldManifold2) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        return this.m_manifold.getWorldManifold(worldManifold2, bodyA.getTransform(), shapeA.m_radius, bodyB.getTransform(), shapeB.m_radius);
      };
      Contact2.prototype.setEnabled = function(flag) {
        this.m_enabledFlag = !!flag;
      };
      Contact2.prototype.isEnabled = function() {
        return this.m_enabledFlag;
      };
      Contact2.prototype.isTouching = function() {
        return this.m_touchingFlag;
      };
      Contact2.prototype.getNext = function() {
        return this.m_next;
      };
      Contact2.prototype.getFixtureA = function() {
        return this.m_fixtureA;
      };
      Contact2.prototype.getFixtureB = function() {
        return this.m_fixtureB;
      };
      Contact2.prototype.getChildIndexA = function() {
        return this.m_indexA;
      };
      Contact2.prototype.getChildIndexB = function() {
        return this.m_indexB;
      };
      Contact2.prototype.flagForFiltering = function() {
        this.m_filterFlag = true;
      };
      Contact2.prototype.setFriction = function(friction) {
        this.m_friction = friction;
      };
      Contact2.prototype.getFriction = function() {
        return this.m_friction;
      };
      Contact2.prototype.resetFriction = function() {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_friction = mixFriction(fixtureA.m_friction, fixtureB.m_friction);
      };
      Contact2.prototype.setRestitution = function(restitution) {
        this.m_restitution = restitution;
      };
      Contact2.prototype.getRestitution = function() {
        return this.m_restitution;
      };
      Contact2.prototype.resetRestitution = function() {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_restitution = mixRestitution(fixtureA.m_restitution, fixtureB.m_restitution);
      };
      Contact2.prototype.setTangentSpeed = function(speed) {
        this.m_tangentSpeed = speed;
      };
      Contact2.prototype.getTangentSpeed = function() {
        return this.m_tangentSpeed;
      };
      Contact2.prototype.evaluate = function(manifold, xfA2, xfB2) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_evaluateFcn(manifold, xfA2, fixtureA, this.m_indexA, xfB2, fixtureB, this.m_indexB);
      };
      Contact2.prototype.update = function(listener) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        this.m_enabledFlag = true;
        var touching = false;
        var wasTouching = this.m_touchingFlag;
        var sensorA = fixtureA.m_isSensor;
        var sensorB = fixtureB.m_isSensor;
        var sensor = sensorA || sensorB;
        var xfA2 = bodyA.m_xf;
        var xfB2 = bodyB.m_xf;
        if (sensor) {
          touching = testOverlap(shapeA, this.m_indexA, shapeB, this.m_indexB, xfA2, xfB2);
          this.m_manifold.pointCount = 0;
        } else {
          oldManifold.recycle();
          oldManifold.set(this.m_manifold);
          this.m_manifold.recycle();
          this.evaluate(this.m_manifold, xfA2, xfB2);
          touching = this.m_manifold.pointCount > 0;
          for (var i = 0; i < this.m_manifold.pointCount; ++i) {
            var nmp = this.m_manifold.points[i];
            nmp.normalImpulse = 0;
            nmp.tangentImpulse = 0;
            for (var j = 0; j < oldManifold.pointCount; ++j) {
              var omp = oldManifold.points[j];
              if (omp.id.key === nmp.id.key) {
                nmp.normalImpulse = omp.normalImpulse;
                nmp.tangentImpulse = omp.tangentImpulse;
                break;
              }
            }
          }
          if (touching !== wasTouching) {
            bodyA.setAwake(true);
            bodyB.setAwake(true);
          }
        }
        this.m_touchingFlag = touching;
        var hasListener = typeof listener === "object" && listener !== null;
        if (!wasTouching && touching && hasListener) {
          listener.beginContact(this);
        }
        if (wasTouching && !touching && hasListener) {
          listener.endContact(this);
        }
        if (!sensor && touching && hasListener && oldManifold) {
          listener.preSolve(this, oldManifold);
        }
      };
      Contact2.prototype.solvePositionConstraint = function(step) {
        return this._solvePositionConstraint(step, null, null);
      };
      Contact2.prototype.solvePositionConstraintTOI = function(step, toiA, toiB) {
        return this._solvePositionConstraint(step, toiA, toiB);
      };
      Contact2.prototype._solvePositionConstraint = function(step, toiA, toiB) {
        var toi = toiA !== null && toiB !== null ? true : false;
        var minSeparation = 0;
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return minSeparation;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return minSeparation;
        var positionA = bodyA.c_position;
        var positionB = bodyB.c_position;
        var localCenterA = this.p_localCenterA;
        var localCenterB = this.p_localCenterB;
        var mA = 0;
        var iA = 0;
        if (!toi || bodyA === toiA || bodyA === toiB) {
          mA = this.p_invMassA;
          iA = this.p_invIA;
        }
        var mB = 0;
        var iB = 0;
        if (!toi || bodyB === toiA || bodyB === toiB) {
          mB = this.p_invMassB;
          iB = this.p_invIB;
        }
        copyVec2(cA, positionA.c);
        var aA = positionA.a;
        copyVec2(cB, positionB.c);
        var aB = positionB.a;
        for (var j = 0; j < this.p_pointCount; ++j) {
          getTransform(xfA, localCenterA, cA, aA);
          getTransform(xfB, localCenterB, cB, aB);
          var separation = void 0;
          switch (this.p_type) {
            case exports2.ManifoldType.e_circles: {
              transformVec2(pointA, xfA, this.p_localPoint);
              transformVec2(pointB, xfB, this.p_localPoints[0]);
              subVec2(normal$2, pointB, pointA);
              normalizeVec2(normal$2);
              combine2Vec2(point, 0.5, pointA, 0.5, pointB);
              separation = dotVec2(pointB, normal$2) - dotVec2(pointA, normal$2) - this.p_radiusA - this.p_radiusB;
              break;
            }
            case exports2.ManifoldType.e_faceA: {
              rotVec2(normal$2, xfA.q, this.p_localNormal);
              transformVec2(planePoint$1, xfA, this.p_localPoint);
              transformVec2(clipPoint, xfB, this.p_localPoints[j]);
              separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;
              copyVec2(point, clipPoint);
              break;
            }
            case exports2.ManifoldType.e_faceB: {
              rotVec2(normal$2, xfB.q, this.p_localNormal);
              transformVec2(planePoint$1, xfB, this.p_localPoint);
              transformVec2(clipPoint, xfA, this.p_localPoints[j]);
              separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;
              copyVec2(point, clipPoint);
              negVec2(normal$2);
              break;
            }
            default: {
              return minSeparation;
            }
          }
          subVec2(rA, point, cA);
          subVec2(rB, point, cB);
          minSeparation = math_min$4(minSeparation, separation);
          var baumgarte = toi ? SettingsInternal.toiBaugarte : SettingsInternal.baumgarte;
          var linearSlop = SettingsInternal.linearSlop;
          var maxLinearCorrection = SettingsInternal.maxLinearCorrection;
          var C = clamp(baumgarte * (separation + linearSlop), -maxLinearCorrection, 0);
          var rnA = crossVec2Vec2(rA, normal$2);
          var rnB = crossVec2Vec2(rB, normal$2);
          var K = mA + mB + iA * rnA * rnA + iB * rnB * rnB;
          var impulse = K > 0 ? -C / K : 0;
          scaleVec2(P$1, impulse, normal$2);
          minusScaleVec2(cA, mA, P$1);
          aA -= iA * crossVec2Vec2(rA, P$1);
          plusScaleVec2(cB, mB, P$1);
          aB += iB * crossVec2Vec2(rB, P$1);
        }
        copyVec2(positionA.c, cA);
        positionA.a = aA;
        copyVec2(positionB.c, cB);
        positionB.a = aB;
        return minSeparation;
      };
      Contact2.prototype.initVelocityConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var positionA = bodyA.c_position;
        var positionB = bodyB.c_position;
        var radiusA = this.p_radiusA;
        var radiusB = this.p_radiusB;
        var manifold = this.m_manifold;
        var mA = this.v_invMassA;
        var mB = this.v_invMassB;
        var iA = this.v_invIA;
        var iB = this.v_invIB;
        var localCenterA = this.p_localCenterA;
        var localCenterB = this.p_localCenterB;
        copyVec2(cA, positionA.c);
        var aA = positionA.a;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(cB, positionB.c);
        var aB = positionB.a;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        getTransform(xfA, localCenterA, cA, aA);
        getTransform(xfB, localCenterB, cB, aB);
        worldManifold.recycle();
        manifold.getWorldManifold(worldManifold, xfA, radiusA, xfB, radiusB);
        copyVec2(this.v_normal, worldManifold.normal);
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          var wmp = worldManifold.points[j];
          subVec2(vcp.rA, wmp, cA);
          subVec2(vcp.rB, wmp, cB);
          var rnA = crossVec2Vec2(vcp.rA, this.v_normal);
          var rnB = crossVec2Vec2(vcp.rB, this.v_normal);
          var kNormal = mA + mB + iA * rnA * rnA + iB * rnB * rnB;
          vcp.normalMass = kNormal > 0 ? 1 / kNormal : 0;
          crossVec2Num(tangent$1, this.v_normal, 1);
          var rtA = crossVec2Vec2(vcp.rA, tangent$1);
          var rtB = crossVec2Vec2(vcp.rB, tangent$1);
          var kTangent = mA + mB + iA * rtA * rtA + iB * rtB * rtB;
          vcp.tangentMass = kTangent > 0 ? 1 / kTangent : 0;
          vcp.velocityBias = 0;
          var vRel = 0;
          vRel += dotVec2(this.v_normal, vB);
          vRel += dotVec2(this.v_normal, crossNumVec2(temp$2, wB, vcp.rB));
          vRel -= dotVec2(this.v_normal, vA);
          vRel -= dotVec2(this.v_normal, crossNumVec2(temp$2, wA, vcp.rA));
          if (vRel < -SettingsInternal.velocityThreshold) {
            vcp.velocityBias = -this.v_restitution * vRel;
          }
        }
        if (this.v_pointCount == 2 && step.blockSolve) {
          var vcp1 = this.v_points[0];
          var vcp2 = this.v_points[1];
          var rn1A = crossVec2Vec2(vcp1.rA, this.v_normal);
          var rn1B = crossVec2Vec2(vcp1.rB, this.v_normal);
          var rn2A = crossVec2Vec2(vcp2.rA, this.v_normal);
          var rn2B = crossVec2Vec2(vcp2.rB, this.v_normal);
          var k11 = mA + mB + iA * rn1A * rn1A + iB * rn1B * rn1B;
          var k22 = mA + mB + iA * rn2A * rn2A + iB * rn2B * rn2B;
          var k12 = mA + mB + iA * rn1A * rn2A + iB * rn1B * rn2B;
          var k_maxConditionNumber = 1e3;
          if (k11 * k11 < k_maxConditionNumber * (k11 * k22 - k12 * k12)) {
            this.v_K.ex.setNum(k11, k12);
            this.v_K.ey.setNum(k12, k22);
            var a_1 = this.v_K.ex.x;
            var b_1 = this.v_K.ey.x;
            var c2 = this.v_K.ex.y;
            var d_1 = this.v_K.ey.y;
            var det = a_1 * d_1 - b_1 * c2;
            if (det !== 0) {
              det = 1 / det;
            }
            this.v_normalMass.ex.x = det * d_1;
            this.v_normalMass.ey.x = -det * b_1;
            this.v_normalMass.ex.y = -det * c2;
            this.v_normalMass.ey.y = det * a_1;
          } else {
            this.v_pointCount = 1;
          }
        }
        copyVec2(positionA.c, cA);
        positionA.a = aA;
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(positionB.c, cB);
        positionB.a = aB;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.prototype.warmStartConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var mA = this.v_invMassA;
        var iA = this.v_invIA;
        var mB = this.v_invMassB;
        var iB = this.v_invIB;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        copyVec2(normal$2, this.v_normal);
        crossVec2Num(tangent$1, normal$2, 1);
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          combine2Vec2(P$1, vcp.normalImpulse, normal$2, vcp.tangentImpulse, tangent$1);
          wA -= iA * crossVec2Vec2(vcp.rA, P$1);
          minusScaleVec2(vA, mA, P$1);
          wB += iB * crossVec2Vec2(vcp.rB, P$1);
          plusScaleVec2(vB, mB, P$1);
        }
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.prototype.storeConstraintImpulses = function(step) {
        var manifold = this.m_manifold;
        for (var j = 0; j < this.v_pointCount; ++j) {
          manifold.points[j].normalImpulse = this.v_points[j].normalImpulse;
          manifold.points[j].tangentImpulse = this.v_points[j].tangentImpulse;
        }
      };
      Contact2.prototype.solveVelocityConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var mA = this.v_invMassA;
        var iA = this.v_invIA;
        var mB = this.v_invMassB;
        var iB = this.v_invIB;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        copyVec2(normal$2, this.v_normal);
        crossVec2Num(tangent$1, normal$2, 1);
        var friction = this.v_friction;
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          zeroVec2(dv);
          plusVec2(dv, vB);
          plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));
          minusVec2(dv, vA);
          minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));
          var vt = dotVec2(dv, tangent$1) - this.v_tangentSpeed;
          var lambda = vcp.tangentMass * -vt;
          var maxFriction = friction * vcp.normalImpulse;
          var newImpulse = clamp(vcp.tangentImpulse + lambda, -maxFriction, maxFriction);
          lambda = newImpulse - vcp.tangentImpulse;
          vcp.tangentImpulse = newImpulse;
          scaleVec2(P$1, lambda, tangent$1);
          minusScaleVec2(vA, mA, P$1);
          wA -= iA * crossVec2Vec2(vcp.rA, P$1);
          plusScaleVec2(vB, mB, P$1);
          wB += iB * crossVec2Vec2(vcp.rB, P$1);
        }
        if (this.v_pointCount == 1 || step.blockSolve == false) {
          for (var i = 0; i < this.v_pointCount; ++i) {
            var vcp = this.v_points[i];
            zeroVec2(dv);
            plusVec2(dv, vB);
            plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));
            minusVec2(dv, vA);
            minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));
            var vn = dotVec2(dv, normal$2);
            var lambda = -vcp.normalMass * (vn - vcp.velocityBias);
            var newImpulse = math_max$2(vcp.normalImpulse + lambda, 0);
            lambda = newImpulse - vcp.normalImpulse;
            vcp.normalImpulse = newImpulse;
            scaleVec2(P$1, lambda, normal$2);
            minusScaleVec2(vA, mA, P$1);
            wA -= iA * crossVec2Vec2(vcp.rA, P$1);
            plusScaleVec2(vB, mB, P$1);
            wB += iB * crossVec2Vec2(vcp.rB, P$1);
          }
        } else {
          var vcp1 = this.v_points[0];
          var vcp2 = this.v_points[1];
          setVec2(a, vcp1.normalImpulse, vcp2.normalImpulse);
          zeroVec2(dv1);
          plusVec2(dv1, vB);
          plusVec2(dv1, crossNumVec2(temp$2, wB, vcp1.rB));
          minusVec2(dv1, vA);
          minusVec2(dv1, crossNumVec2(temp$2, wA, vcp1.rA));
          zeroVec2(dv2);
          plusVec2(dv2, vB);
          plusVec2(dv2, crossNumVec2(temp$2, wB, vcp2.rB));
          minusVec2(dv2, vA);
          minusVec2(dv2, crossNumVec2(temp$2, wA, vcp2.rA));
          var vn1 = dotVec2(dv1, normal$2);
          var vn2 = dotVec2(dv2, normal$2);
          setVec2(b, vn1 - vcp1.velocityBias, vn2 - vcp2.velocityBias);
          b.x -= this.v_K.ex.x * a.x + this.v_K.ey.x * a.y;
          b.y -= this.v_K.ex.y * a.x + this.v_K.ey.y * a.y;
          while (true) {
            zeroVec2(x);
            x.x = -(this.v_normalMass.ex.x * b.x + this.v_normalMass.ey.x * b.y);
            x.y = -(this.v_normalMass.ex.y * b.x + this.v_normalMass.ey.y * b.y);
            if (x.x >= 0 && x.y >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = -vcp1.normalMass * b.x;
            x.y = 0;
            vn1 = 0;
            vn2 = this.v_K.ex.y * x.x + b.y;
            if (x.x >= 0 && vn2 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = 0;
            x.y = -vcp2.normalMass * b.y;
            vn1 = this.v_K.ey.x * x.y + b.x;
            vn2 = 0;
            if (x.y >= 0 && vn1 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = 0;
            x.y = 0;
            vn1 = b.x;
            vn2 = b.y;
            if (vn1 >= 0 && vn2 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            break;
          }
        }
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.addType = function(type1, type2, callback) {
        s_registers[type1] = s_registers[type1] || {};
        s_registers[type1][type2] = callback;
      };
      Contact2.create = function(fixtureA, indexA, fixtureB, indexB) {
        var typeA = fixtureA.m_shape.m_type;
        var typeB = fixtureB.m_shape.m_type;
        var contact = contactPool.allocate();
        var evaluateFcn;
        if (evaluateFcn = s_registers[typeA] && s_registers[typeA][typeB]) {
          contact.initialize(fixtureA, indexA, fixtureB, indexB, evaluateFcn);
        } else if (evaluateFcn = s_registers[typeB] && s_registers[typeB][typeA]) {
          contact.initialize(fixtureB, indexB, fixtureA, indexA, evaluateFcn);
        } else {
          return null;
        }
        fixtureA = contact.m_fixtureA;
        fixtureB = contact.m_fixtureB;
        indexA = contact.getChildIndexA();
        indexB = contact.getChildIndexB();
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        contact.m_nodeA.contact = contact;
        contact.m_nodeA.other = bodyB;
        contact.m_nodeA.prev = null;
        contact.m_nodeA.next = bodyA.m_contactList;
        if (bodyA.m_contactList != null) {
          bodyA.m_contactList.prev = contact.m_nodeA;
        }
        bodyA.m_contactList = contact.m_nodeA;
        contact.m_nodeB.contact = contact;
        contact.m_nodeB.other = bodyA;
        contact.m_nodeB.prev = null;
        contact.m_nodeB.next = bodyB.m_contactList;
        if (bodyB.m_contactList != null) {
          bodyB.m_contactList.prev = contact.m_nodeB;
        }
        bodyB.m_contactList = contact.m_nodeB;
        if (fixtureA.isSensor() == false && fixtureB.isSensor() == false) {
          bodyA.setAwake(true);
          bodyB.setAwake(true);
        }
        return contact;
      };
      Contact2.destroy = function(contact, listener) {
        var fixtureA = contact.m_fixtureA;
        var fixtureB = contact.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        if (contact.isTouching()) {
          listener.endContact(contact);
        }
        if (contact.m_nodeA.prev) {
          contact.m_nodeA.prev.next = contact.m_nodeA.next;
        }
        if (contact.m_nodeA.next) {
          contact.m_nodeA.next.prev = contact.m_nodeA.prev;
        }
        if (contact.m_nodeA == bodyA.m_contactList) {
          bodyA.m_contactList = contact.m_nodeA.next;
        }
        if (contact.m_nodeB.prev) {
          contact.m_nodeB.prev.next = contact.m_nodeB.next;
        }
        if (contact.m_nodeB.next) {
          contact.m_nodeB.next.prev = contact.m_nodeB.prev;
        }
        if (contact.m_nodeB == bodyB.m_contactList) {
          bodyB.m_contactList = contact.m_nodeB.next;
        }
        if (contact.m_manifold.pointCount > 0 && !fixtureA.m_isSensor && !fixtureB.m_isSensor) {
          bodyA.setAwake(true);
          bodyB.setAwake(true);
        }
        contactPool.release(contact);
      };
      return Contact2;
    }()
  );
  var DEFAULTS$b = {
    gravity: Vec2.zero(),
    allowSleep: true,
    warmStarting: true,
    continuousPhysics: true,
    subStepping: false,
    blockSolve: true,
    velocityIterations: 8,
    positionIterations: 3
  };
  var World = (
    /** @class */
    function() {
      function World2(def) {
        if (!(this instanceof World2)) {
          return new World2(def);
        }
        this.s_step = new TimeStep();
        if (!def) {
          def = {};
        } else if (Vec2.isValid(def)) {
          def = { gravity: def };
        }
        def = options(def, DEFAULTS$b);
        this.m_solver = new Solver(this);
        this.m_broadPhase = new BroadPhase();
        this.m_contactList = null;
        this.m_contactCount = 0;
        this.m_bodyList = null;
        this.m_bodyCount = 0;
        this.m_jointList = null;
        this.m_jointCount = 0;
        this.m_stepComplete = true;
        this.m_allowSleep = def.allowSleep;
        this.m_gravity = Vec2.clone(def.gravity);
        this.m_clearForces = true;
        this.m_newFixture = false;
        this.m_locked = false;
        this.m_warmStarting = def.warmStarting;
        this.m_continuousPhysics = def.continuousPhysics;
        this.m_subStepping = def.subStepping;
        this.m_blockSolve = def.blockSolve;
        this.m_velocityIterations = def.velocityIterations;
        this.m_positionIterations = def.positionIterations;
        this.m_t = 0;
        this.m_step_callback = [];
      }
      World2.prototype._serialize = function() {
        var bodies = [];
        var joints = [];
        for (var b2 = this.getBodyList(); b2; b2 = b2.getNext()) {
          bodies.push(b2);
        }
        for (var j = this.getJointList(); j; j = j.getNext()) {
          if (typeof j._serialize === "function") {
            joints.push(j);
          }
        }
        return {
          gravity: this.m_gravity,
          bodies,
          joints
        };
      };
      World2._deserialize = function(data, context, restore) {
        if (!data) {
          return new World2();
        }
        var world = new World2(data.gravity);
        if (data.bodies) {
          for (var i = data.bodies.length - 1; i >= 0; i -= 1) {
            world._addBody(restore(Body, data.bodies[i], world));
          }
        }
        if (data.joints) {
          for (var i = data.joints.length - 1; i >= 0; i--) {
            world.createJoint(restore(Joint, data.joints[i], world));
          }
        }
        return world;
      };
      World2.prototype.getBodyList = function() {
        return this.m_bodyList;
      };
      World2.prototype.getJointList = function() {
        return this.m_jointList;
      };
      World2.prototype.getContactList = function() {
        return this.m_contactList;
      };
      World2.prototype.getBodyCount = function() {
        return this.m_bodyCount;
      };
      World2.prototype.getJointCount = function() {
        return this.m_jointCount;
      };
      World2.prototype.getContactCount = function() {
        return this.m_contactCount;
      };
      World2.prototype.setGravity = function(gravity) {
        this.m_gravity.set(gravity);
      };
      World2.prototype.getGravity = function() {
        return this.m_gravity;
      };
      World2.prototype.isLocked = function() {
        return this.m_locked;
      };
      World2.prototype.setAllowSleeping = function(flag) {
        if (flag == this.m_allowSleep) {
          return;
        }
        this.m_allowSleep = flag;
        if (this.m_allowSleep == false) {
          for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {
            b2.setAwake(true);
          }
        }
      };
      World2.prototype.getAllowSleeping = function() {
        return this.m_allowSleep;
      };
      World2.prototype.setWarmStarting = function(flag) {
        this.m_warmStarting = flag;
      };
      World2.prototype.getWarmStarting = function() {
        return this.m_warmStarting;
      };
      World2.prototype.setContinuousPhysics = function(flag) {
        this.m_continuousPhysics = flag;
      };
      World2.prototype.getContinuousPhysics = function() {
        return this.m_continuousPhysics;
      };
      World2.prototype.setSubStepping = function(flag) {
        this.m_subStepping = flag;
      };
      World2.prototype.getSubStepping = function() {
        return this.m_subStepping;
      };
      World2.prototype.setAutoClearForces = function(flag) {
        this.m_clearForces = flag;
      };
      World2.prototype.getAutoClearForces = function() {
        return this.m_clearForces;
      };
      World2.prototype.clearForces = function() {
        for (var body = this.m_bodyList; body; body = body.getNext()) {
          body.m_force.setZero();
          body.m_torque = 0;
        }
      };
      World2.prototype.queryAABB = function(aabb, callback) {
        var broadPhase = this.m_broadPhase;
        this.m_broadPhase.query(aabb, function(proxyId) {
          var proxy = broadPhase.getUserData(proxyId);
          return callback(proxy.fixture);
        });
      };
      World2.prototype.rayCast = function(point1, point2, callback) {
        var broadPhase = this.m_broadPhase;
        this.m_broadPhase.rayCast({
          maxFraction: 1,
          p1: point1,
          p2: point2
        }, function(input2, proxyId) {
          var proxy = broadPhase.getUserData(proxyId);
          var fixture = proxy.fixture;
          var index = proxy.childIndex;
          var output2 = {};
          var hit = fixture.rayCast(output2, input2, index);
          if (hit) {
            var fraction = output2.fraction;
            var point3 = Vec2.add(Vec2.mulNumVec2(1 - fraction, input2.p1), Vec2.mulNumVec2(fraction, input2.p2));
            return callback(fixture, point3, output2.normal, fraction);
          }
          return input2.maxFraction;
        });
      };
      World2.prototype.getProxyCount = function() {
        return this.m_broadPhase.getProxyCount();
      };
      World2.prototype.getTreeHeight = function() {
        return this.m_broadPhase.getTreeHeight();
      };
      World2.prototype.getTreeBalance = function() {
        return this.m_broadPhase.getTreeBalance();
      };
      World2.prototype.getTreeQuality = function() {
        return this.m_broadPhase.getTreeQuality();
      };
      World2.prototype.shiftOrigin = function(newOrigin) {
        if (this.isLocked()) {
          return;
        }
        for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {
          b2.m_xf.p.sub(newOrigin);
          b2.m_sweep.c0.sub(newOrigin);
          b2.m_sweep.c.sub(newOrigin);
        }
        for (var j = this.m_jointList; j; j = j.m_next) {
          j.shiftOrigin(newOrigin);
        }
        this.m_broadPhase.shiftOrigin(newOrigin);
      };
      World2.prototype._addBody = function(body) {
        if (this.isLocked()) {
          return;
        }
        body.m_prev = null;
        body.m_next = this.m_bodyList;
        if (this.m_bodyList) {
          this.m_bodyList.m_prev = body;
        }
        this.m_bodyList = body;
        ++this.m_bodyCount;
      };
      World2.prototype.createBody = function(arg1, arg2) {
        if (this.isLocked()) {
          return null;
        }
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        var body = new Body(this, def);
        this._addBody(body);
        return body;
      };
      World2.prototype.createDynamicBody = function(arg1, arg2) {
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        def.type = "dynamic";
        return this.createBody(def);
      };
      World2.prototype.createKinematicBody = function(arg1, arg2) {
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        def.type = "kinematic";
        return this.createBody(def);
      };
      World2.prototype.destroyBody = function(b2) {
        if (this.isLocked()) {
          return;
        }
        if (b2.m_destroyed) {
          return false;
        }
        var je = b2.m_jointList;
        while (je) {
          var je0 = je;
          je = je.next;
          this.publish("remove-joint", je0.joint);
          this.destroyJoint(je0.joint);
          b2.m_jointList = je;
        }
        b2.m_jointList = null;
        var ce = b2.m_contactList;
        while (ce) {
          var ce0 = ce;
          ce = ce.next;
          this.destroyContact(ce0.contact);
          b2.m_contactList = ce;
        }
        b2.m_contactList = null;
        var f = b2.m_fixtureList;
        while (f) {
          var f0 = f;
          f = f.m_next;
          this.publish("remove-fixture", f0);
          f0.destroyProxies(this.m_broadPhase);
          b2.m_fixtureList = f;
        }
        b2.m_fixtureList = null;
        if (b2.m_prev) {
          b2.m_prev.m_next = b2.m_next;
        }
        if (b2.m_next) {
          b2.m_next.m_prev = b2.m_prev;
        }
        if (b2 == this.m_bodyList) {
          this.m_bodyList = b2.m_next;
        }
        b2.m_destroyed = true;
        --this.m_bodyCount;
        this.publish("remove-body", b2);
        return true;
      };
      World2.prototype.createJoint = function(joint) {
        if (this.isLocked()) {
          return null;
        }
        joint.m_prev = null;
        joint.m_next = this.m_jointList;
        if (this.m_jointList) {
          this.m_jointList.m_prev = joint;
        }
        this.m_jointList = joint;
        ++this.m_jointCount;
        joint.m_edgeA.joint = joint;
        joint.m_edgeA.other = joint.m_bodyB;
        joint.m_edgeA.prev = null;
        joint.m_edgeA.next = joint.m_bodyA.m_jointList;
        if (joint.m_bodyA.m_jointList)
          joint.m_bodyA.m_jointList.prev = joint.m_edgeA;
        joint.m_bodyA.m_jointList = joint.m_edgeA;
        joint.m_edgeB.joint = joint;
        joint.m_edgeB.other = joint.m_bodyA;
        joint.m_edgeB.prev = null;
        joint.m_edgeB.next = joint.m_bodyB.m_jointList;
        if (joint.m_bodyB.m_jointList)
          joint.m_bodyB.m_jointList.prev = joint.m_edgeB;
        joint.m_bodyB.m_jointList = joint.m_edgeB;
        if (joint.m_collideConnected == false) {
          for (var edge = joint.m_bodyB.getContactList(); edge; edge = edge.next) {
            if (edge.other == joint.m_bodyA) {
              edge.contact.flagForFiltering();
            }
          }
        }
        return joint;
      };
      World2.prototype.destroyJoint = function(joint) {
        if (this.isLocked()) {
          return;
        }
        if (joint.m_prev) {
          joint.m_prev.m_next = joint.m_next;
        }
        if (joint.m_next) {
          joint.m_next.m_prev = joint.m_prev;
        }
        if (joint == this.m_jointList) {
          this.m_jointList = joint.m_next;
        }
        var bodyA = joint.m_bodyA;
        var bodyB = joint.m_bodyB;
        bodyA.setAwake(true);
        bodyB.setAwake(true);
        if (joint.m_edgeA.prev) {
          joint.m_edgeA.prev.next = joint.m_edgeA.next;
        }
        if (joint.m_edgeA.next) {
          joint.m_edgeA.next.prev = joint.m_edgeA.prev;
        }
        if (joint.m_edgeA == bodyA.m_jointList) {
          bodyA.m_jointList = joint.m_edgeA.next;
        }
        joint.m_edgeA.prev = null;
        joint.m_edgeA.next = null;
        if (joint.m_edgeB.prev) {
          joint.m_edgeB.prev.next = joint.m_edgeB.next;
        }
        if (joint.m_edgeB.next) {
          joint.m_edgeB.next.prev = joint.m_edgeB.prev;
        }
        if (joint.m_edgeB == bodyB.m_jointList) {
          bodyB.m_jointList = joint.m_edgeB.next;
        }
        joint.m_edgeB.prev = null;
        joint.m_edgeB.next = null;
        --this.m_jointCount;
        if (joint.m_collideConnected == false) {
          var edge = bodyB.getContactList();
          while (edge) {
            if (edge.other == bodyA) {
              edge.contact.flagForFiltering();
            }
            edge = edge.next;
          }
        }
        this.publish("remove-joint", joint);
      };
      World2.prototype.step = function(timeStep, velocityIterations, positionIterations) {
        this.publish("pre-step", timeStep);
        if ((velocityIterations | 0) !== velocityIterations) {
          velocityIterations = 0;
        }
        velocityIterations = velocityIterations || this.m_velocityIterations;
        positionIterations = positionIterations || this.m_positionIterations;
        if (this.m_newFixture) {
          this.findNewContacts();
          this.m_newFixture = false;
        }
        this.m_locked = true;
        this.s_step.reset(timeStep);
        this.s_step.velocityIterations = velocityIterations;
        this.s_step.positionIterations = positionIterations;
        this.s_step.warmStarting = this.m_warmStarting;
        this.s_step.blockSolve = this.m_blockSolve;
        this.updateContacts();
        if (this.m_stepComplete && timeStep > 0) {
          this.m_solver.solveWorld(this.s_step);
          for (var b2 = this.m_bodyList; b2; b2 = b2.getNext()) {
            if (b2.m_islandFlag == false) {
              continue;
            }
            if (b2.isStatic()) {
              continue;
            }
            b2.synchronizeFixtures();
          }
          this.findNewContacts();
        }
        if (this.m_continuousPhysics && timeStep > 0) {
          this.m_solver.solveWorldTOI(this.s_step);
        }
        if (this.m_clearForces) {
          this.clearForces();
        }
        this.m_locked = false;
        var callback;
        while (callback = this.m_step_callback.shift()) {
          callback(this);
        }
        this.publish("post-step", timeStep);
      };
      World2.prototype.queueUpdate = function(callback) {
        if (!this.isLocked()) {
          callback(this);
        } else {
          this.m_step_callback.push(callback);
        }
      };
      World2.prototype.findNewContacts = function() {
        var _this = this;
        this.m_broadPhase.updatePairs(function(proxyA, proxyB) {
          return _this.createContact(proxyA, proxyB);
        });
      };
      World2.prototype.createContact = function(proxyA, proxyB) {
        var fixtureA = proxyA.fixture;
        var fixtureB = proxyB.fixture;
        var indexA = proxyA.childIndex;
        var indexB = proxyB.childIndex;
        var bodyA = fixtureA.getBody();
        var bodyB = fixtureB.getBody();
        if (bodyA == bodyB) {
          return;
        }
        var edge = bodyB.getContactList();
        while (edge) {
          if (edge.other == bodyA) {
            var fA = edge.contact.getFixtureA();
            var fB = edge.contact.getFixtureB();
            var iA = edge.contact.getChildIndexA();
            var iB = edge.contact.getChildIndexB();
            if (fA == fixtureA && fB == fixtureB && iA == indexA && iB == indexB) {
              return;
            }
            if (fA == fixtureB && fB == fixtureA && iA == indexB && iB == indexA) {
              return;
            }
          }
          edge = edge.next;
        }
        if (bodyB.shouldCollide(bodyA) == false) {
          return;
        }
        if (fixtureB.shouldCollide(fixtureA) == false) {
          return;
        }
        var contact = Contact.create(fixtureA, indexA, fixtureB, indexB);
        if (contact == null) {
          return;
        }
        contact.m_prev = null;
        if (this.m_contactList != null) {
          contact.m_next = this.m_contactList;
          this.m_contactList.m_prev = contact;
        }
        this.m_contactList = contact;
        ++this.m_contactCount;
      };
      World2.prototype.updateContacts = function() {
        var c2;
        var next_c = this.m_contactList;
        while (c2 = next_c) {
          next_c = c2.getNext();
          var fixtureA = c2.getFixtureA();
          var fixtureB = c2.getFixtureB();
          var indexA = c2.getChildIndexA();
          var indexB = c2.getChildIndexB();
          var bodyA = fixtureA.getBody();
          var bodyB = fixtureB.getBody();
          if (c2.m_filterFlag) {
            if (bodyB.shouldCollide(bodyA) == false) {
              this.destroyContact(c2);
              continue;
            }
            if (fixtureB.shouldCollide(fixtureA) == false) {
              this.destroyContact(c2);
              continue;
            }
            c2.m_filterFlag = false;
          }
          var activeA = bodyA.isAwake() && !bodyA.isStatic();
          var activeB = bodyB.isAwake() && !bodyB.isStatic();
          if (activeA == false && activeB == false) {
            continue;
          }
          var proxyIdA = fixtureA.m_proxies[indexA].proxyId;
          var proxyIdB = fixtureB.m_proxies[indexB].proxyId;
          var overlap = this.m_broadPhase.testOverlap(proxyIdA, proxyIdB);
          if (overlap == false) {
            this.destroyContact(c2);
            continue;
          }
          c2.update(this);
        }
      };
      World2.prototype.destroyContact = function(contact) {
        if (contact.m_prev) {
          contact.m_prev.m_next = contact.m_next;
        }
        if (contact.m_next) {
          contact.m_next.m_prev = contact.m_prev;
        }
        if (contact == this.m_contactList) {
          this.m_contactList = contact.m_next;
        }
        Contact.destroy(contact, this);
        --this.m_contactCount;
      };
      World2.prototype.on = function(name, listener) {
        if (typeof name !== "string" || typeof listener !== "function") {
          return this;
        }
        if (!this._listeners) {
          this._listeners = {};
        }
        if (!this._listeners[name]) {
          this._listeners[name] = [];
        }
        this._listeners[name].push(listener);
        return this;
      };
      World2.prototype.off = function(name, listener) {
        if (typeof name !== "string" || typeof listener !== "function") {
          return this;
        }
        var listeners = this._listeners && this._listeners[name];
        if (!listeners || !listeners.length) {
          return this;
        }
        var index = listeners.indexOf(listener);
        if (index >= 0) {
          listeners.splice(index, 1);
        }
        return this;
      };
      World2.prototype.publish = function(name, arg1, arg2, arg3) {
        var listeners = this._listeners && this._listeners[name];
        if (!listeners || !listeners.length) {
          return 0;
        }
        for (var l = 0; l < listeners.length; l++) {
          listeners[l].call(this, arg1, arg2, arg3);
        }
        return listeners.length;
      };
      World2.prototype.beginContact = function(contact) {
        this.publish("begin-contact", contact);
      };
      World2.prototype.endContact = function(contact) {
        this.publish("end-contact", contact);
      };
      World2.prototype.preSolve = function(contact, oldManifold2) {
        this.publish("pre-solve", contact, oldManifold2);
      };
      World2.prototype.postSolve = function(contact, impulse) {
        this.publish("post-solve", contact, impulse);
      };
      return World2;
    }()
  );
  var Vec3 = (
    /** @class */
    function() {
      function Vec32(x2, y, z) {
        if (!(this instanceof Vec32)) {
          return new Vec32(x2, y, z);
        }
        if (typeof x2 === "undefined") {
          this.x = 0;
          this.y = 0;
          this.z = 0;
        } else if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
          this.z = x2.z;
        } else {
          this.x = x2;
          this.y = y;
          this.z = z;
        }
      }
      Vec32.prototype._serialize = function() {
        return {
          x: this.x,
          y: this.y,
          z: this.z
        };
      };
      Vec32._deserialize = function(data) {
        var obj = Object.create(Vec32.prototype);
        obj.x = data.x;
        obj.y = data.y;
        obj.z = data.z;
        return obj;
      };
      Vec32.neo = function(x2, y, z) {
        var obj = Object.create(Vec32.prototype);
        obj.x = x2;
        obj.y = y;
        obj.z = z;
        return obj;
      };
      Vec32.zero = function() {
        var obj = Object.create(Vec32.prototype);
        obj.x = 0;
        obj.y = 0;
        obj.z = 0;
        return obj;
      };
      Vec32.clone = function(v3) {
        return Vec32.neo(v3.x, v3.y, v3.z);
      };
      Vec32.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Vec32.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.x) && Number.isFinite(obj.y) && Number.isFinite(obj.z);
      };
      Vec32.assert = function(o) {
      };
      Vec32.prototype.setZero = function() {
        this.x = 0;
        this.y = 0;
        this.z = 0;
        return this;
      };
      Vec32.prototype.set = function(x2, y, z) {
        this.x = x2;
        this.y = y;
        this.z = z;
        return this;
      };
      Vec32.prototype.add = function(w) {
        this.x += w.x;
        this.y += w.y;
        this.z += w.z;
        return this;
      };
      Vec32.prototype.sub = function(w) {
        this.x -= w.x;
        this.y -= w.y;
        this.z -= w.z;
        return this;
      };
      Vec32.prototype.mul = function(m) {
        this.x *= m;
        this.y *= m;
        this.z *= m;
        return this;
      };
      Vec32.areEqual = function(v3, w) {
        return v3 === w || typeof v3 === "object" && v3 !== null && typeof w === "object" && w !== null && v3.x === w.x && v3.y === w.y && v3.z === w.z;
      };
      Vec32.dot = function(v3, w) {
        return v3.x * w.x + v3.y * w.y + v3.z * w.z;
      };
      Vec32.cross = function(v3, w) {
        return new Vec32(v3.y * w.z - v3.z * w.y, v3.z * w.x - v3.x * w.z, v3.x * w.y - v3.y * w.x);
      };
      Vec32.add = function(v3, w) {
        return new Vec32(v3.x + w.x, v3.y + w.y, v3.z + w.z);
      };
      Vec32.sub = function(v3, w) {
        return new Vec32(v3.x - w.x, v3.y - w.y, v3.z - w.z);
      };
      Vec32.mul = function(v3, m) {
        return new Vec32(m * v3.x, m * v3.y, m * v3.z);
      };
      Vec32.prototype.neg = function() {
        this.x = -this.x;
        this.y = -this.y;
        this.z = -this.z;
        return this;
      };
      Vec32.neg = function(v3) {
        return new Vec32(-v3.x, -v3.y, -v3.z);
      };
      return Vec32;
    }()
  );
  var v1$2 = vec2(0, 0);
  var v2$1 = vec2(0, 0);
  var EdgeShape = (
    /** @class */
    function(_super) {
      __extends(EdgeShape2, _super);
      function EdgeShape2(v122, v22) {
        var _this = this;
        if (!(_this instanceof EdgeShape2)) {
          return new EdgeShape2(v122, v22);
        }
        _this = _super.call(this) || this;
        _this.m_type = EdgeShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_vertex1 = v122 ? Vec2.clone(v122) : Vec2.zero();
        _this.m_vertex2 = v22 ? Vec2.clone(v22) : Vec2.zero();
        _this.m_vertex0 = Vec2.zero();
        _this.m_vertex3 = Vec2.zero();
        _this.m_hasVertex0 = false;
        _this.m_hasVertex3 = false;
        return _this;
      }
      EdgeShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          vertex1: this.m_vertex1,
          vertex2: this.m_vertex2,
          vertex0: this.m_vertex0,
          vertex3: this.m_vertex3,
          hasVertex0: this.m_hasVertex0,
          hasVertex3: this.m_hasVertex3
        };
      };
      EdgeShape2._deserialize = function(data) {
        var shape = new EdgeShape2(data.vertex1, data.vertex2);
        if (shape.m_hasVertex0) {
          shape.setPrevVertex(data.vertex0);
        }
        if (shape.m_hasVertex3) {
          shape.setNextVertex(data.vertex3);
        }
        return shape;
      };
      EdgeShape2.prototype._reset = function() {
      };
      EdgeShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      EdgeShape2.prototype.getType = function() {
        return this.m_type;
      };
      EdgeShape2.prototype.setNext = function(v3) {
        return this.setNextVertex(v3);
      };
      EdgeShape2.prototype.setNextVertex = function(v3) {
        if (v3) {
          this.m_vertex3.setVec2(v3);
          this.m_hasVertex3 = true;
        } else {
          this.m_vertex3.setZero();
          this.m_hasVertex3 = false;
        }
        return this;
      };
      EdgeShape2.prototype.getNextVertex = function() {
        return this.m_vertex3;
      };
      EdgeShape2.prototype.setPrev = function(v3) {
        return this.setPrevVertex(v3);
      };
      EdgeShape2.prototype.setPrevVertex = function(v3) {
        if (v3) {
          this.m_vertex0.setVec2(v3);
          this.m_hasVertex0 = true;
        } else {
          this.m_vertex0.setZero();
          this.m_hasVertex0 = false;
        }
        return this;
      };
      EdgeShape2.prototype.getPrevVertex = function() {
        return this.m_vertex0;
      };
      EdgeShape2.prototype._set = function(v122, v22) {
        this.m_vertex1.setVec2(v122);
        this.m_vertex2.setVec2(v22);
        this.m_hasVertex0 = false;
        this.m_hasVertex3 = false;
        return this;
      };
      EdgeShape2.prototype._clone = function() {
        var clone = new EdgeShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_vertex1.setVec2(this.m_vertex1);
        clone.m_vertex2.setVec2(this.m_vertex2);
        clone.m_vertex0.setVec2(this.m_vertex0);
        clone.m_vertex3.setVec2(this.m_vertex3);
        clone.m_hasVertex0 = this.m_hasVertex0;
        clone.m_hasVertex3 = this.m_hasVertex3;
        return clone;
      };
      EdgeShape2.prototype.getChildCount = function() {
        return 1;
      };
      EdgeShape2.prototype.testPoint = function(xf2, p) {
        return false;
      };
      EdgeShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));
        var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));
        var d2 = Vec2.sub(p2, p1);
        var v122 = this.m_vertex1;
        var v22 = this.m_vertex2;
        var e3 = Vec2.sub(v22, v122);
        var normal3 = Vec2.neo(e3.y, -e3.x);
        normal3.normalize();
        var numerator = Vec2.dot(normal3, Vec2.sub(v122, p1));
        var denominator = Vec2.dot(normal3, d2);
        if (denominator == 0) {
          return false;
        }
        var t = numerator / denominator;
        if (t < 0 || input2.maxFraction < t) {
          return false;
        }
        var q = Vec2.add(p1, Vec2.mulNumVec2(t, d2));
        var r = Vec2.sub(v22, v122);
        var rr = Vec2.dot(r, r);
        if (rr == 0) {
          return false;
        }
        var s2 = Vec2.dot(Vec2.sub(q, v122), r) / rr;
        if (s2 < 0 || 1 < s2) {
          return false;
        }
        output2.fraction = t;
        if (numerator > 0) {
          output2.normal = Rot.mulVec2(xf2.q, normal3).neg();
        } else {
          output2.normal = Rot.mulVec2(xf2.q, normal3);
        }
        return true;
      };
      EdgeShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        transformVec2(v1$2, xf2, this.m_vertex1);
        transformVec2(v2$1, xf2, this.m_vertex2);
        AABB.combinePoints(aabb, v1$2, v2$1);
        AABB.extend(aabb, this.m_radius);
      };
      EdgeShape2.prototype.computeMass = function(massData, density) {
        massData.mass = 0;
        combine2Vec2(massData.center, 0.5, this.m_vertex1, 0.5, this.m_vertex2);
        massData.I = 0;
      };
      EdgeShape2.prototype.computeDistanceProxy = function(proxy) {
        proxy.m_vertices[0] = this.m_vertex1;
        proxy.m_vertices[1] = this.m_vertex2;
        proxy.m_vertices.length = 2;
        proxy.m_count = 2;
        proxy.m_radius = this.m_radius;
      };
      EdgeShape2.TYPE = "edge";
      return EdgeShape2;
    }(Shape)
  );
  var v1$1 = vec2(0, 0);
  var v2 = vec2(0, 0);
  var ChainShape = (
    /** @class */
    function(_super) {
      __extends(ChainShape2, _super);
      function ChainShape2(vertices, loop) {
        var _this = this;
        if (!(_this instanceof ChainShape2)) {
          return new ChainShape2(vertices, loop);
        }
        _this = _super.call(this) || this;
        _this.m_type = ChainShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_vertices = [];
        _this.m_count = 0;
        _this.m_prevVertex = null;
        _this.m_nextVertex = null;
        _this.m_hasPrevVertex = false;
        _this.m_hasNextVertex = false;
        _this.m_isLoop = !!loop;
        if (vertices && vertices.length) {
          if (loop) {
            _this._createLoop(vertices);
          } else {
            _this._createChain(vertices);
          }
        }
        return _this;
      }
      ChainShape2.prototype._serialize = function() {
        var data = {
          type: this.m_type,
          vertices: this.m_isLoop ? this.m_vertices.slice(0, this.m_vertices.length - 1) : this.m_vertices,
          isLoop: this.m_isLoop,
          hasPrevVertex: this.m_hasPrevVertex,
          hasNextVertex: this.m_hasNextVertex,
          prevVertex: null,
          nextVertex: null
        };
        if (this.m_prevVertex) {
          data.prevVertex = this.m_prevVertex;
        }
        if (this.m_nextVertex) {
          data.nextVertex = this.m_nextVertex;
        }
        return data;
      };
      ChainShape2._deserialize = function(data, fixture, restore) {
        var vertices = [];
        if (data.vertices) {
          for (var i = 0; i < data.vertices.length; i++) {
            vertices.push(restore(Vec2, data.vertices[i]));
          }
        }
        var shape = new ChainShape2(vertices, data.isLoop);
        if (data.prevVertex) {
          shape.setPrevVertex(data.prevVertex);
        }
        if (data.nextVertex) {
          shape.setNextVertex(data.nextVertex);
        }
        return shape;
      };
      ChainShape2.prototype.getType = function() {
        return this.m_type;
      };
      ChainShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      ChainShape2.prototype._createLoop = function(vertices) {
        if (vertices.length < 3) {
          return;
        }
        var i;
        this.m_vertices = [];
        this.m_count = vertices.length + 1;
        for (var i = 0; i < vertices.length; ++i) {
          this.m_vertices[i] = Vec2.clone(vertices[i]);
        }
        this.m_vertices[vertices.length] = Vec2.clone(vertices[0]);
        this.m_prevVertex = this.m_vertices[this.m_count - 2];
        this.m_nextVertex = this.m_vertices[1];
        this.m_hasPrevVertex = true;
        this.m_hasNextVertex = true;
        return this;
      };
      ChainShape2.prototype._createChain = function(vertices) {
        var i;
        this.m_vertices = [];
        this.m_count = vertices.length;
        for (var i = 0; i < vertices.length; ++i) {
          this.m_vertices[i] = Vec2.clone(vertices[i]);
        }
        this.m_prevVertex = null;
        this.m_nextVertex = null;
        this.m_hasPrevVertex = false;
        this.m_hasNextVertex = false;
        return this;
      };
      ChainShape2.prototype._reset = function() {
        if (this.m_isLoop) {
          this._createLoop(this.m_vertices.slice(0, this.m_vertices.length - 1));
        } else {
          this._createChain(this.m_vertices);
        }
      };
      ChainShape2.prototype.setPrevVertex = function(prevVertex) {
        this.m_prevVertex = prevVertex;
        this.m_hasPrevVertex = true;
      };
      ChainShape2.prototype.getPrevVertex = function() {
        return this.m_prevVertex;
      };
      ChainShape2.prototype.setNextVertex = function(nextVertex) {
        this.m_nextVertex = nextVertex;
        this.m_hasNextVertex = true;
      };
      ChainShape2.prototype.getNextVertex = function() {
        return this.m_nextVertex;
      };
      ChainShape2.prototype._clone = function() {
        var clone = new ChainShape2();
        clone._createChain(this.m_vertices);
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_prevVertex = this.m_prevVertex;
        clone.m_nextVertex = this.m_nextVertex;
        clone.m_hasPrevVertex = this.m_hasPrevVertex;
        clone.m_hasNextVertex = this.m_hasNextVertex;
        return clone;
      };
      ChainShape2.prototype.getChildCount = function() {
        return this.m_count - 1;
      };
      ChainShape2.prototype.getChildEdge = function(edge, childIndex) {
        edge.m_type = EdgeShape.TYPE;
        edge.m_radius = this.m_radius;
        edge.m_vertex1 = this.m_vertices[childIndex];
        edge.m_vertex2 = this.m_vertices[childIndex + 1];
        if (childIndex > 0) {
          edge.m_vertex0 = this.m_vertices[childIndex - 1];
          edge.m_hasVertex0 = true;
        } else {
          edge.m_vertex0 = this.m_prevVertex;
          edge.m_hasVertex0 = this.m_hasPrevVertex;
        }
        if (childIndex < this.m_count - 2) {
          edge.m_vertex3 = this.m_vertices[childIndex + 2];
          edge.m_hasVertex3 = true;
        } else {
          edge.m_vertex3 = this.m_nextVertex;
          edge.m_hasVertex3 = this.m_hasNextVertex;
        }
      };
      ChainShape2.prototype.getVertex = function(index) {
        if (index < this.m_count) {
          return this.m_vertices[index];
        } else {
          return this.m_vertices[0];
        }
      };
      ChainShape2.prototype.isLoop = function() {
        return this.m_isLoop;
      };
      ChainShape2.prototype.testPoint = function(xf2, p) {
        return false;
      };
      ChainShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var edgeShape = new EdgeShape(this.getVertex(childIndex), this.getVertex(childIndex + 1));
        return edgeShape.rayCast(output2, input2, xf2, 0);
      };
      ChainShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        transformVec2(v1$1, xf2, this.getVertex(childIndex));
        transformVec2(v2, xf2, this.getVertex(childIndex + 1));
        AABB.combinePoints(aabb, v1$1, v2);
      };
      ChainShape2.prototype.computeMass = function(massData, density) {
        massData.mass = 0;
        zeroVec2(massData.center);
        massData.I = 0;
      };
      ChainShape2.prototype.computeDistanceProxy = function(proxy, childIndex) {
        proxy.m_vertices[0] = this.getVertex(childIndex);
        proxy.m_vertices[1] = this.getVertex(childIndex + 1);
        proxy.m_count = 2;
        proxy.m_radius = this.m_radius;
      };
      ChainShape2.TYPE = "chain";
      return ChainShape2;
    }(Shape)
  );
  var math_max$1 = Math.max;
  var math_min$3 = Math.min;
  var temp$1 = vec2(0, 0);
  var e$1 = vec2(0, 0);
  var e1$1 = vec2(0, 0);
  var e2$1 = vec2(0, 0);
  var center = vec2(0, 0);
  var s = vec2(0, 0);
  var PolygonShape = (
    /** @class */
    function(_super) {
      __extends(PolygonShape2, _super);
      function PolygonShape2(vertices) {
        var _this = this;
        if (!(_this instanceof PolygonShape2)) {
          return new PolygonShape2(vertices);
        }
        _this = _super.call(this) || this;
        _this.m_type = PolygonShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_centroid = Vec2.zero();
        _this.m_vertices = [];
        _this.m_normals = [];
        _this.m_count = 0;
        if (vertices && vertices.length) {
          _this._set(vertices);
        }
        return _this;
      }
      PolygonShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          vertices: this.m_vertices
        };
      };
      PolygonShape2._deserialize = function(data, fixture, restore) {
        var vertices = [];
        if (data.vertices) {
          for (var i = 0; i < data.vertices.length; i++) {
            vertices.push(restore(Vec2, data.vertices[i]));
          }
        }
        var shape = new PolygonShape2(vertices);
        return shape;
      };
      PolygonShape2.prototype.getType = function() {
        return this.m_type;
      };
      PolygonShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      PolygonShape2.prototype._clone = function() {
        var clone = new PolygonShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_count = this.m_count;
        clone.m_centroid.setVec2(this.m_centroid);
        for (var i = 0; i < this.m_count; i++) {
          clone.m_vertices.push(this.m_vertices[i].clone());
        }
        for (var i = 0; i < this.m_normals.length; i++) {
          clone.m_normals.push(this.m_normals[i].clone());
        }
        return clone;
      };
      PolygonShape2.prototype.getChildCount = function() {
        return 1;
      };
      PolygonShape2.prototype._reset = function() {
        this._set(this.m_vertices);
      };
      PolygonShape2.prototype._set = function(vertices) {
        if (vertices.length < 3) {
          this._setAsBox(1, 1);
          return;
        }
        var n2 = math_min$3(vertices.length, SettingsInternal.maxPolygonVertices);
        var ps = [];
        for (var i = 0; i < n2; ++i) {
          var v3 = vertices[i];
          var unique = true;
          for (var j = 0; j < ps.length; ++j) {
            if (Vec2.distanceSquared(v3, ps[j]) < 0.25 * SettingsInternal.linearSlopSquared) {
              unique = false;
              break;
            }
          }
          if (unique) {
            ps.push(Vec2.clone(v3));
          }
        }
        n2 = ps.length;
        if (n2 < 3) {
          this._setAsBox(1, 1);
          return;
        }
        var i0 = 0;
        var x0 = ps[0].x;
        for (var i = 1; i < n2; ++i) {
          var x2 = ps[i].x;
          if (x2 > x0 || x2 === x0 && ps[i].y < ps[i0].y) {
            i0 = i;
            x0 = x2;
          }
        }
        var hull = [];
        var m = 0;
        var ih = i0;
        while (true) {
          hull[m] = ih;
          var ie2 = 0;
          for (var j = 1; j < n2; ++j) {
            if (ie2 === ih) {
              ie2 = j;
              continue;
            }
            var r = Vec2.sub(ps[ie2], ps[hull[m]]);
            var v3 = Vec2.sub(ps[j], ps[hull[m]]);
            var c2 = Vec2.crossVec2Vec2(r, v3);
            if (c2 < 0) {
              ie2 = j;
            }
            if (c2 === 0 && v3.lengthSquared() > r.lengthSquared()) {
              ie2 = j;
            }
          }
          ++m;
          ih = ie2;
          if (ie2 === i0) {
            break;
          }
        }
        if (m < 3) {
          this._setAsBox(1, 1);
          return;
        }
        this.m_count = m;
        this.m_vertices = [];
        for (var i = 0; i < m; ++i) {
          this.m_vertices[i] = ps[hull[i]];
        }
        for (var i = 0; i < m; ++i) {
          var i1 = i;
          var i2 = i + 1 < m ? i + 1 : 0;
          var edge = Vec2.sub(this.m_vertices[i2], this.m_vertices[i1]);
          this.m_normals[i] = Vec2.crossVec2Num(edge, 1);
          this.m_normals[i].normalize();
        }
        this.m_centroid = computeCentroid(this.m_vertices, m);
      };
      PolygonShape2.prototype._setAsBox = function(hx, hy, center2, angle) {
        this.m_vertices[0] = Vec2.neo(hx, -hy);
        this.m_vertices[1] = Vec2.neo(hx, hy);
        this.m_vertices[2] = Vec2.neo(-hx, hy);
        this.m_vertices[3] = Vec2.neo(-hx, -hy);
        this.m_normals[0] = Vec2.neo(1, 0);
        this.m_normals[1] = Vec2.neo(0, 1);
        this.m_normals[2] = Vec2.neo(-1, 0);
        this.m_normals[3] = Vec2.neo(0, -1);
        this.m_count = 4;
        if (center2 && Vec2.isValid(center2)) {
          angle = angle || 0;
          copyVec2(this.m_centroid, center2);
          var xf2 = Transform.identity();
          xf2.p.setVec2(center2);
          xf2.q.setAngle(angle);
          for (var i = 0; i < this.m_count; ++i) {
            this.m_vertices[i] = Transform.mulVec2(xf2, this.m_vertices[i]);
            this.m_normals[i] = Rot.mulVec2(xf2.q, this.m_normals[i]);
          }
        }
      };
      PolygonShape2.prototype.testPoint = function(xf2, p) {
        var pLocal = detransformVec2(temp$1, xf2, p);
        for (var i = 0; i < this.m_count; ++i) {
          var dot = dotVec2(this.m_normals[i], pLocal) - dotVec2(this.m_normals[i], this.m_vertices[i]);
          if (dot > 0) {
            return false;
          }
        }
        return true;
      };
      PolygonShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));
        var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));
        var d2 = Vec2.sub(p2, p1);
        var lower = 0;
        var upper = input2.maxFraction;
        var index = -1;
        for (var i = 0; i < this.m_count; ++i) {
          var numerator = Vec2.dot(this.m_normals[i], Vec2.sub(this.m_vertices[i], p1));
          var denominator = Vec2.dot(this.m_normals[i], d2);
          if (denominator == 0) {
            if (numerator < 0) {
              return false;
            }
          } else {
            if (denominator < 0 && numerator < lower * denominator) {
              lower = numerator / denominator;
              index = i;
            } else if (denominator > 0 && numerator < upper * denominator) {
              upper = numerator / denominator;
            }
          }
          if (upper < lower) {
            return false;
          }
        }
        if (index >= 0) {
          output2.fraction = lower;
          output2.normal = Rot.mulVec2(xf2.q, this.m_normals[index]);
          return true;
        }
        return false;
      };
      PolygonShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        var minX = Infinity;
        var minY = Infinity;
        var maxX = -Infinity;
        var maxY = -Infinity;
        for (var i = 0; i < this.m_count; ++i) {
          var v3 = transformVec2(temp$1, xf2, this.m_vertices[i]);
          minX = math_min$3(minX, v3.x);
          maxX = math_max$1(maxX, v3.x);
          minY = math_min$3(minY, v3.y);
          maxY = math_max$1(maxY, v3.y);
        }
        setVec2(aabb.lowerBound, minX - this.m_radius, minY - this.m_radius);
        setVec2(aabb.upperBound, maxX + this.m_radius, maxY + this.m_radius);
      };
      PolygonShape2.prototype.computeMass = function(massData, density) {
        zeroVec2(center);
        var area = 0;
        var I = 0;
        zeroVec2(s);
        for (var i = 0; i < this.m_count; ++i) {
          plusVec2(s, this.m_vertices[i]);
        }
        scaleVec2(s, 1 / this.m_count, s);
        var k_inv3 = 1 / 3;
        for (var i = 0; i < this.m_count; ++i) {
          subVec2(e1$1, this.m_vertices[i], s);
          if (i + 1 < this.m_count) {
            subVec2(e2$1, this.m_vertices[i + 1], s);
          } else {
            subVec2(e2$1, this.m_vertices[0], s);
          }
          var D = crossVec2Vec2(e1$1, e2$1);
          var triangleArea = 0.5 * D;
          area += triangleArea;
          combine2Vec2(temp$1, triangleArea * k_inv3, e1$1, triangleArea * k_inv3, e2$1);
          plusVec2(center, temp$1);
          var ex1 = e1$1.x;
          var ey1 = e1$1.y;
          var ex2 = e2$1.x;
          var ey2 = e2$1.y;
          var intx2 = ex1 * ex1 + ex2 * ex1 + ex2 * ex2;
          var inty2 = ey1 * ey1 + ey2 * ey1 + ey2 * ey2;
          I += 0.25 * k_inv3 * D * (intx2 + inty2);
        }
        massData.mass = density * area;
        scaleVec2(center, 1 / area, center);
        addVec2(massData.center, center, s);
        massData.I = density * I;
        massData.I += massData.mass * (dotVec2(massData.center, massData.center) - dotVec2(center, center));
      };
      PolygonShape2.prototype.validate = function() {
        for (var i = 0; i < this.m_count; ++i) {
          var i1 = i;
          var i2 = i < this.m_count - 1 ? i1 + 1 : 0;
          var p = this.m_vertices[i1];
          subVec2(e$1, this.m_vertices[i2], p);
          for (var j = 0; j < this.m_count; ++j) {
            if (j == i1 || j == i2) {
              continue;
            }
            var c2 = crossVec2Vec2(e$1, subVec2(temp$1, this.m_vertices[j], p));
            if (c2 < 0) {
              return false;
            }
          }
        }
        return true;
      };
      PolygonShape2.prototype.computeDistanceProxy = function(proxy) {
        for (var i = 0; i < this.m_count; ++i) {
          proxy.m_vertices[i] = this.m_vertices[i];
        }
        proxy.m_vertices.length = this.m_count;
        proxy.m_count = this.m_count;
        proxy.m_radius = this.m_radius;
      };
      PolygonShape2.TYPE = "polygon";
      return PolygonShape2;
    }(Shape)
  );
  function computeCentroid(vs, count) {
    var c2 = Vec2.zero();
    var area = 0;
    var pRef = Vec2.zero();
    var i;
    var inv3 = 1 / 3;
    for (var i = 0; i < count; ++i) {
      var p1 = pRef;
      var p2 = vs[i];
      var p3 = i + 1 < count ? vs[i + 1] : vs[0];
      var e1_1 = Vec2.sub(p2, p1);
      var e2_1 = Vec2.sub(p3, p1);
      var D = Vec2.crossVec2Vec2(e1_1, e2_1);
      var triangleArea = 0.5 * D;
      area += triangleArea;
      combine3Vec2(temp$1, 1, p1, 1, p2, 1, p3);
      plusScaleVec2(c2, triangleArea * inv3, temp$1);
    }
    c2.mul(1 / area);
    return c2;
  }
  var math_sqrt = Math.sqrt;
  var math_PI$4 = Math.PI;
  var temp = vec2(0, 0);
  var CircleShape = (
    /** @class */
    function(_super) {
      __extends(CircleShape2, _super);
      function CircleShape2(a2, b2) {
        var _this = this;
        if (!(_this instanceof CircleShape2)) {
          return new CircleShape2(a2, b2);
        }
        _this = _super.call(this) || this;
        _this.m_type = CircleShape2.TYPE;
        _this.m_p = Vec2.zero();
        _this.m_radius = 1;
        if (typeof a2 === "object" && Vec2.isValid(a2)) {
          _this.m_p.setVec2(a2);
          if (typeof b2 === "number") {
            _this.m_radius = b2;
          }
        } else if (typeof a2 === "number") {
          _this.m_radius = a2;
        }
        return _this;
      }
      CircleShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          p: this.m_p,
          radius: this.m_radius
        };
      };
      CircleShape2._deserialize = function(data) {
        return new CircleShape2(data.p, data.radius);
      };
      CircleShape2.prototype._reset = function() {
      };
      CircleShape2.prototype.getType = function() {
        return this.m_type;
      };
      CircleShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      CircleShape2.prototype.getCenter = function() {
        return this.m_p;
      };
      CircleShape2.prototype._clone = function() {
        var clone = new CircleShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_p = this.m_p.clone();
        return clone;
      };
      CircleShape2.prototype.getChildCount = function() {
        return 1;
      };
      CircleShape2.prototype.testPoint = function(xf2, p) {
        var center2 = transformVec2(temp, xf2, this.m_p);
        return distSqrVec2(p, center2) <= this.m_radius * this.m_radius;
      };
      CircleShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var position = Vec2.add(xf2.p, Rot.mulVec2(xf2.q, this.m_p));
        var s2 = Vec2.sub(input2.p1, position);
        var b2 = Vec2.dot(s2, s2) - this.m_radius * this.m_radius;
        var r = Vec2.sub(input2.p2, input2.p1);
        var c2 = Vec2.dot(s2, r);
        var rr = Vec2.dot(r, r);
        var sigma = c2 * c2 - rr * b2;
        if (sigma < 0 || rr < EPSILON) {
          return false;
        }
        var a2 = -(c2 + math_sqrt(sigma));
        if (0 <= a2 && a2 <= input2.maxFraction * rr) {
          a2 /= rr;
          output2.fraction = a2;
          output2.normal = Vec2.add(s2, Vec2.mulNumVec2(a2, r));
          output2.normal.normalize();
          return true;
        }
        return false;
      };
      CircleShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        var p = transformVec2(temp, xf2, this.m_p);
        setVec2(aabb.lowerBound, p.x - this.m_radius, p.y - this.m_radius);
        setVec2(aabb.upperBound, p.x + this.m_radius, p.y + this.m_radius);
      };
      CircleShape2.prototype.computeMass = function(massData, density) {
        massData.mass = density * math_PI$4 * this.m_radius * this.m_radius;
        copyVec2(massData.center, this.m_p);
        massData.I = massData.mass * (0.5 * this.m_radius * this.m_radius + lengthSqrVec2(this.m_p));
      };
      CircleShape2.prototype.computeDistanceProxy = function(proxy) {
        proxy.m_vertices[0] = this.m_p;
        proxy.m_vertices.length = 1;
        proxy.m_count = 1;
        proxy.m_radius = this.m_radius;
      };
      CircleShape2.TYPE = "circle";
      return CircleShape2;
    }(Shape)
  );
  var math_abs$5 = Math.abs;
  var math_PI$3 = Math.PI;
  var DEFAULTS$a = {
    frequencyHz: 0,
    dampingRatio: 0
  };
  var DistanceJoint = (
    /** @class */
    function(_super) {
      __extends(DistanceJoint2, _super);
      function DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB) {
        var _this = this;
        if (!(_this instanceof DistanceJoint2)) {
          return new DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB);
        }
        if (bodyB && anchorA && "m_type" in anchorA && "x" in bodyB && "y" in bodyB) {
          var temp3 = bodyB;
          bodyB = anchorA;
          anchorA = temp3;
        }
        def = options(def, DEFAULTS$a);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = DistanceJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.zero());
        _this.m_length = Number.isFinite(def.length) ? def.length : Vec2.distance(bodyA.getWorldPoint(_this.m_localAnchorA), bodyB.getWorldPoint(_this.m_localAnchorB));
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_impulse = 0;
        _this.m_gamma = 0;
        _this.m_bias = 0;
        return _this;
      }
      DistanceJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          length: this.m_length,
          impulse: this.m_impulse,
          gamma: this.m_gamma,
          bias: this.m_bias
        };
      };
      DistanceJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new DistanceJoint2(data);
        return joint;
      };
      DistanceJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.length > 0) {
          this.m_length = +def.length;
        } else if (def.length < 0) ;
        else if (def.anchorA || def.anchorA || def.anchorA || def.anchorA) {
          this.m_length = Vec2.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA), this.m_bodyB.getWorldPoint(this.m_localAnchorB));
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      DistanceJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      DistanceJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      DistanceJoint2.prototype.setLength = function(length) {
        this.m_length = length;
      };
      DistanceJoint2.prototype.getLength = function() {
        return this.m_length;
      };
      DistanceJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      DistanceJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      DistanceJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      DistanceJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      DistanceJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      DistanceJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      DistanceJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);
      };
      DistanceJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      DistanceJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        this.m_u = Vec2.sub(Vec2.add(cB2, this.m_rB), Vec2.add(cA2, this.m_rA));
        var length = this.m_u.length();
        if (length > SettingsInternal.linearSlop) {
          this.m_u.mul(1 / length);
        } else {
          this.m_u.setNum(0, 0);
        }
        var crAu = Vec2.crossVec2Vec2(this.m_rA, this.m_u);
        var crBu = Vec2.crossVec2Vec2(this.m_rB, this.m_u);
        var invMass = this.m_invMassA + this.m_invIA * crAu * crAu + this.m_invMassB + this.m_invIB * crBu * crBu;
        this.m_mass = invMass != 0 ? 1 / invMass : 0;
        if (this.m_frequencyHz > 0) {
          var C = length - this.m_length;
          var omega = 2 * math_PI$3 * this.m_frequencyHz;
          var d2 = 2 * this.m_mass * this.m_dampingRatio * omega;
          var k = this.m_mass * omega * omega;
          var h = step.dt;
          this.m_gamma = h * (d2 + h * k);
          this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;
          this.m_bias = C * h * k * this.m_gamma;
          invMass += this.m_gamma;
          this.m_mass = invMass != 0 ? 1 / invMass : 0;
        } else {
          this.m_gamma = 0;
          this.m_bias = 0;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      DistanceJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));
        var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));
        var Cdot = Vec2.dot(this.m_u, vpB) - Vec2.dot(this.m_u, vpA);
        var impulse = -this.m_mass * (Cdot + this.m_bias + this.m_gamma * this.m_impulse);
        this.m_impulse += impulse;
        var P3 = Vec2.mulNumVec2(impulse, this.m_u);
        vA2.subMul(this.m_invMassA, P3);
        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
        vB2.addMul(this.m_invMassB, P3);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      DistanceJoint2.prototype.solvePositionConstraints = function(step) {
        if (this.m_frequencyHz > 0) {
          return true;
        }
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        var u = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));
        var length = u.normalize();
        var C = clamp(length - this.m_length, -SettingsInternal.maxLinearCorrection, SettingsInternal.maxLinearCorrection);
        var impulse = -this.m_mass * C;
        var P3 = Vec2.mulNumVec2(impulse, u);
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return math_abs$5(C) < SettingsInternal.linearSlop;
      };
      DistanceJoint2.TYPE = "distance-joint";
      return DistanceJoint2;
    }(Joint)
  );
  var DEFAULTS$9 = {
    maxForce: 0,
    maxTorque: 0
  };
  var FrictionJoint = (
    /** @class */
    function(_super) {
      __extends(FrictionJoint2, _super);
      function FrictionJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof FrictionJoint2)) {
          return new FrictionJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$9);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = FrictionJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_linearImpulse = Vec2.zero();
        _this.m_angularImpulse = 0;
        _this.m_maxForce = def.maxForce;
        _this.m_maxTorque = def.maxTorque;
        return _this;
      }
      FrictionJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          maxForce: this.m_maxForce,
          maxTorque: this.m_maxTorque,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB
        };
      };
      FrictionJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new FrictionJoint2(data);
        return joint;
      };
      FrictionJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.maxTorque)) {
          this.m_maxTorque = def.maxTorque;
        }
      };
      FrictionJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      FrictionJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      FrictionJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      FrictionJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      FrictionJoint2.prototype.setMaxTorque = function(torque) {
        this.m_maxTorque = torque;
      };
      FrictionJoint2.prototype.getMaxTorque = function() {
        return this.m_maxTorque;
      };
      FrictionJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      FrictionJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      FrictionJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);
      };
      FrictionJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_angularImpulse;
      };
      FrictionJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat22();
        K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;
        K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;
        this.m_linearMass = K.getInverse();
        this.m_angularMass = iA + iB;
        if (this.m_angularMass > 0) {
          this.m_angularMass = 1 / this.m_angularMass;
        }
        if (step.warmStarting) {
          this.m_linearImpulse.mul(step.dtRatio);
          this.m_angularImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);
        } else {
          this.m_linearImpulse.setZero();
          this.m_angularImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      FrictionJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var h = step.dt;
        {
          var Cdot = wB - wA;
          var impulse = -this.m_angularMass * Cdot;
          var oldImpulse = this.m_angularImpulse;
          var maxImpulse = h * this.m_maxTorque;
          this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_angularImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.sub(Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB)), Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA)));
          var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));
          var oldImpulse = this.m_linearImpulse;
          this.m_linearImpulse.add(impulse);
          var maxImpulse = h * this.m_maxForce;
          if (this.m_linearImpulse.lengthSquared() > maxImpulse * maxImpulse) {
            this.m_linearImpulse.normalize();
            this.m_linearImpulse.mul(maxImpulse);
          }
          impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      FrictionJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      FrictionJoint2.TYPE = "friction-joint";
      return FrictionJoint2;
    }(Joint)
  );
  var Mat33 = (
    /** @class */
    function() {
      function Mat332(a2, b2, c2) {
        if (typeof a2 === "object" && a2 !== null) {
          this.ex = Vec3.clone(a2);
          this.ey = Vec3.clone(b2);
          this.ez = Vec3.clone(c2);
        } else {
          this.ex = Vec3.zero();
          this.ey = Vec3.zero();
          this.ez = Vec3.zero();
        }
      }
      Mat332.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Mat332.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec3.isValid(obj.ex) && Vec3.isValid(obj.ey) && Vec3.isValid(obj.ez);
      };
      Mat332.assert = function(o) {
      };
      Mat332.prototype.setZero = function() {
        this.ex.setZero();
        this.ey.setZero();
        this.ez.setZero();
        return this;
      };
      Mat332.prototype.solve33 = function(v3) {
        var cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;
        var cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;
        var cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;
        var det = this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z;
        if (det !== 0) {
          det = 1 / det;
        }
        var r = new Vec3();
        cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;
        cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;
        cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;
        r.x = det * (v3.x * cross_x + v3.y * cross_y + v3.z * cross_z);
        cross_x = v3.y * this.ez.z - v3.z * this.ez.y;
        cross_y = v3.z * this.ez.x - v3.x * this.ez.z;
        cross_z = v3.x * this.ez.y - v3.y * this.ez.x;
        r.y = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);
        cross_x = this.ey.y * v3.z - this.ey.z * v3.y;
        cross_y = this.ey.z * v3.x - this.ey.x * v3.z;
        cross_z = this.ey.x * v3.y - this.ey.y * v3.x;
        r.z = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);
        return r;
      };
      Mat332.prototype.solve22 = function(v3) {
        var a11 = this.ex.x;
        var a12 = this.ey.x;
        var a21 = this.ex.y;
        var a22 = this.ey.y;
        var det = a11 * a22 - a12 * a21;
        if (det !== 0) {
          det = 1 / det;
        }
        var r = Vec2.zero();
        r.x = det * (a22 * v3.x - a12 * v3.y);
        r.y = det * (a11 * v3.y - a21 * v3.x);
        return r;
      };
      Mat332.prototype.getInverse22 = function(M) {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        M.ex.x = det * d2;
        M.ey.x = -det * b2;
        M.ex.z = 0;
        M.ex.y = -det * c2;
        M.ey.y = det * a2;
        M.ey.z = 0;
        M.ez.x = 0;
        M.ez.y = 0;
        M.ez.z = 0;
      };
      Mat332.prototype.getSymInverse33 = function(M) {
        var det = Vec3.dot(this.ex, Vec3.cross(this.ey, this.ez));
        if (det !== 0) {
          det = 1 / det;
        }
        var a11 = this.ex.x;
        var a12 = this.ey.x;
        var a13 = this.ez.x;
        var a22 = this.ey.y;
        var a23 = this.ez.y;
        var a33 = this.ez.z;
        M.ex.x = det * (a22 * a33 - a23 * a23);
        M.ex.y = det * (a13 * a23 - a12 * a33);
        M.ex.z = det * (a12 * a23 - a13 * a22);
        M.ey.x = M.ex.y;
        M.ey.y = det * (a11 * a33 - a13 * a13);
        M.ey.z = det * (a13 * a12 - a11 * a23);
        M.ez.x = M.ex.z;
        M.ez.y = M.ey.z;
        M.ez.z = det * (a11 * a22 - a12 * a12);
      };
      Mat332.mul = function(a2, b2) {
        if (b2 && "z" in b2 && "y" in b2 && "x" in b2) {
          var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;
          var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;
          var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;
          return new Vec3(x2, y, z);
        } else if (b2 && "y" in b2 && "x" in b2) {
          var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;
          var y = a2.ex.y * b2.x + a2.ey.y * b2.y;
          return Vec2.neo(x2, y);
        }
      };
      Mat332.mulVec3 = function(a2, b2) {
        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;
        var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;
        var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;
        return new Vec3(x2, y, z);
      };
      Mat332.mulVec2 = function(a2, b2) {
        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;
        var y = a2.ex.y * b2.x + a2.ey.y * b2.y;
        return Vec2.neo(x2, y);
      };
      Mat332.add = function(a2, b2) {
        return new Mat332(Vec3.add(a2.ex, b2.ex), Vec3.add(a2.ey, b2.ey), Vec3.add(a2.ez, b2.ez));
      };
      return Mat332;
    }()
  );
  var math_abs$4 = Math.abs;
  var LimitState$2;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState$2 || (LimitState$2 = {}));
  var DEFAULTS$8 = {
    lowerAngle: 0,
    upperAngle: 0,
    maxMotorTorque: 0,
    motorSpeed: 0,
    enableLimit: false,
    enableMotor: false
  };
  var RevoluteJoint = (
    /** @class */
    function(_super) {
      __extends(RevoluteJoint2, _super);
      function RevoluteJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        var _a2, _b, _c, _d, _e, _f;
        if (!(_this instanceof RevoluteJoint2)) {
          return new RevoluteJoint2(def, bodyA, bodyB, anchor);
        }
        def = def !== null && def !== void 0 ? def : {};
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_mass = new Mat33();
        _this.m_limitState = LimitState$2.inactiveLimit;
        _this.m_type = RevoluteJoint2.TYPE;
        if (Vec2.isValid(anchor)) {
          _this.m_localAnchorA = bodyA.getLocalPoint(anchor);
        } else if (Vec2.isValid(def.localAnchorA)) {
          _this.m_localAnchorA = Vec2.clone(def.localAnchorA);
        } else {
          _this.m_localAnchorA = Vec2.zero();
        }
        if (Vec2.isValid(anchor)) {
          _this.m_localAnchorB = bodyB.getLocalPoint(anchor);
        } else if (Vec2.isValid(def.localAnchorB)) {
          _this.m_localAnchorB = Vec2.clone(def.localAnchorB);
        } else {
          _this.m_localAnchorB = Vec2.zero();
        }
        if (Number.isFinite(def.referenceAngle)) {
          _this.m_referenceAngle = def.referenceAngle;
        } else {
          _this.m_referenceAngle = bodyB.getAngle() - bodyA.getAngle();
        }
        _this.m_impulse = new Vec3();
        _this.m_motorImpulse = 0;
        _this.m_lowerAngle = (_a2 = def.lowerAngle) !== null && _a2 !== void 0 ? _a2 : DEFAULTS$8.lowerAngle;
        _this.m_upperAngle = (_b = def.upperAngle) !== null && _b !== void 0 ? _b : DEFAULTS$8.upperAngle;
        _this.m_maxMotorTorque = (_c = def.maxMotorTorque) !== null && _c !== void 0 ? _c : DEFAULTS$8.maxMotorTorque;
        _this.m_motorSpeed = (_d = def.motorSpeed) !== null && _d !== void 0 ? _d : DEFAULTS$8.motorSpeed;
        _this.m_enableLimit = (_e = def.enableLimit) !== null && _e !== void 0 ? _e : DEFAULTS$8.enableLimit;
        _this.m_enableMotor = (_f = def.enableMotor) !== null && _f !== void 0 ? _f : DEFAULTS$8.enableMotor;
        return _this;
      }
      RevoluteJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          lowerAngle: this.m_lowerAngle,
          upperAngle: this.m_upperAngle,
          maxMotorTorque: this.m_maxMotorTorque,
          motorSpeed: this.m_motorSpeed,
          enableLimit: this.m_enableLimit,
          enableMotor: this.m_enableMotor,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          referenceAngle: this.m_referenceAngle
        };
      };
      RevoluteJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new RevoluteJoint2(data);
        return joint;
      };
      RevoluteJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.referenceAngle)) {
          this.m_referenceAngle = def.referenceAngle;
        }
        if (def.enableLimit !== void 0) {
          this.m_enableLimit = def.enableLimit;
        }
        if (Number.isFinite(def.lowerAngle)) {
          this.m_lowerAngle = def.lowerAngle;
        }
        if (Number.isFinite(def.upperAngle)) {
          this.m_upperAngle = def.upperAngle;
        }
        if (Number.isFinite(def.maxMotorTorque)) {
          this.m_maxMotorTorque = def.maxMotorTorque;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
        if (def.enableMotor !== void 0) {
          this.m_enableMotor = def.enableMotor;
        }
      };
      RevoluteJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      RevoluteJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      RevoluteJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      RevoluteJoint2.prototype.getJointAngle = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        return bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
      };
      RevoluteJoint2.prototype.getJointSpeed = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        return bB.m_angularVelocity - bA.m_angularVelocity;
      };
      RevoluteJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      RevoluteJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      RevoluteJoint2.prototype.getMotorTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      RevoluteJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      RevoluteJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      RevoluteJoint2.prototype.setMaxMotorTorque = function(torque) {
        if (torque == this.m_maxMotorTorque)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorTorque = torque;
      };
      RevoluteJoint2.prototype.getMaxMotorTorque = function() {
        return this.m_maxMotorTorque;
      };
      RevoluteJoint2.prototype.isLimitEnabled = function() {
        return this.m_enableLimit;
      };
      RevoluteJoint2.prototype.enableLimit = function(flag) {
        if (flag != this.m_enableLimit) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_enableLimit = flag;
          this.m_impulse.z = 0;
        }
      };
      RevoluteJoint2.prototype.getLowerLimit = function() {
        return this.m_lowerAngle;
      };
      RevoluteJoint2.prototype.getUpperLimit = function() {
        return this.m_upperAngle;
      };
      RevoluteJoint2.prototype.setLimits = function(lower, upper) {
        if (lower != this.m_lowerAngle || upper != this.m_upperAngle) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_impulse.z = 0;
          this.m_lowerAngle = lower;
          this.m_upperAngle = upper;
        }
      };
      RevoluteJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      RevoluteJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      RevoluteJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);
      };
      RevoluteJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.z;
      };
      RevoluteJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var fixedRotation = iA + iB === 0;
        this.m_mass.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;
        this.m_mass.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;
        this.m_mass.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;
        this.m_mass.ex.y = this.m_mass.ey.x;
        this.m_mass.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;
        this.m_mass.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;
        this.m_mass.ex.z = this.m_mass.ez.x;
        this.m_mass.ey.z = this.m_mass.ez.y;
        this.m_mass.ez.z = iA + iB;
        this.m_motorMass = iA + iB;
        if (this.m_motorMass > 0) {
          this.m_motorMass = 1 / this.m_motorMass;
        }
        if (this.m_enableMotor == false || fixedRotation) {
          this.m_motorImpulse = 0;
        }
        if (this.m_enableLimit && fixedRotation == false) {
          var jointAngle = aB - aA - this.m_referenceAngle;
          if (math_abs$4(this.m_upperAngle - this.m_lowerAngle) < 2 * SettingsInternal.angularSlop) {
            this.m_limitState = LimitState$2.equalLimits;
          } else if (jointAngle <= this.m_lowerAngle) {
            if (this.m_limitState != LimitState$2.atLowerLimit) {
              this.m_impulse.z = 0;
            }
            this.m_limitState = LimitState$2.atLowerLimit;
          } else if (jointAngle >= this.m_upperAngle) {
            if (this.m_limitState != LimitState$2.atUpperLimit) {
              this.m_impulse.z = 0;
            }
            this.m_limitState = LimitState$2.atUpperLimit;
          } else {
            this.m_limitState = LimitState$2.inactiveLimit;
            this.m_impulse.z = 0;
          }
        } else {
          this.m_limitState = LimitState$2.inactiveLimit;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_motorImpulse + this.m_impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_motorImpulse + this.m_impulse.z);
        } else {
          this.m_impulse.setZero();
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RevoluteJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var fixedRotation = iA + iB === 0;
        if (this.m_enableMotor && this.m_limitState != LimitState$2.equalLimits && fixedRotation == false) {
          var Cdot = wB - wA - this.m_motorSpeed;
          var impulse = -this.m_motorMass * Cdot;
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorTorque;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var Cdot2 = wB - wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var impulse = Vec3.neg(this.m_mass.solve33(Cdot));
          if (this.m_limitState == LimitState$2.equalLimits) {
            this.m_impulse.add(impulse);
          } else if (this.m_limitState == LimitState$2.atLowerLimit) {
            var newImpulse = this.m_impulse.z + impulse.z;
            if (newImpulse < 0) {
              var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));
              var reduced = this.m_mass.solve22(rhs);
              impulse.x = reduced.x;
              impulse.y = reduced.y;
              impulse.z = -this.m_impulse.z;
              this.m_impulse.x += reduced.x;
              this.m_impulse.y += reduced.y;
              this.m_impulse.z = 0;
            } else {
              this.m_impulse.add(impulse);
            }
          } else if (this.m_limitState == LimitState$2.atUpperLimit) {
            var newImpulse = this.m_impulse.z + impulse.z;
            if (newImpulse > 0) {
              var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));
              var reduced = this.m_mass.solve22(rhs);
              impulse.x = reduced.x;
              impulse.y = reduced.y;
              impulse.z = -this.m_impulse.z;
              this.m_impulse.x += reduced.x;
              this.m_impulse.y += reduced.y;
              this.m_impulse.z = 0;
            } else {
              this.m_impulse.add(impulse);
            }
          }
          var P3 = Vec2.neo(impulse.x, impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);
        } else {
          var Cdot = Vec2.zero();
          Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var impulse = this.m_mass.solve22(Vec2.neg(Cdot));
          this.m_impulse.x += impulse.x;
          this.m_impulse.y += impulse.y;
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RevoluteJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var angularError = 0;
        var positionError = 0;
        var fixedRotation = this.m_invIA + this.m_invIB == 0;
        if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {
          var angle = aB - aA - this.m_referenceAngle;
          var limitImpulse = 0;
          if (this.m_limitState == LimitState$2.equalLimits) {
            var C = clamp(angle - this.m_lowerAngle, -SettingsInternal.maxAngularCorrection, SettingsInternal.maxAngularCorrection);
            limitImpulse = -this.m_motorMass * C;
            angularError = math_abs$4(C);
          } else if (this.m_limitState == LimitState$2.atLowerLimit) {
            var C = angle - this.m_lowerAngle;
            angularError = -C;
            C = clamp(C + SettingsInternal.angularSlop, -SettingsInternal.maxAngularCorrection, 0);
            limitImpulse = -this.m_motorMass * C;
          } else if (this.m_limitState == LimitState$2.atUpperLimit) {
            var C = angle - this.m_upperAngle;
            angularError = C;
            C = clamp(C - SettingsInternal.angularSlop, 0, SettingsInternal.maxAngularCorrection);
            limitImpulse = -this.m_motorMass * C;
          }
          aA -= this.m_invIA * limitImpulse;
          aB += this.m_invIB * limitImpulse;
        }
        {
          qA.setAngle(aA);
          qB.setAngle(aB);
          var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
          var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
          var C = Vec2.zero();
          C.addCombine(1, cB2, 1, rB2);
          C.subCombine(1, cA2, 1, rA2);
          positionError = C.length();
          var mA = this.m_invMassA;
          var mB = this.m_invMassB;
          var iA = this.m_invIA;
          var iB = this.m_invIB;
          var K = new Mat22();
          K.ex.x = mA + mB + iA * rA2.y * rA2.y + iB * rB2.y * rB2.y;
          K.ex.y = -iA * rA2.x * rA2.y - iB * rB2.x * rB2.y;
          K.ey.x = K.ex.y;
          K.ey.y = mA + mB + iA * rA2.x * rA2.x + iB * rB2.x * rB2.x;
          var impulse = Vec2.neg(K.solve(C));
          cA2.subMul(mA, impulse);
          aA -= iA * Vec2.crossVec2Vec2(rA2, impulse);
          cB2.addMul(mB, impulse);
          aB += iB * Vec2.crossVec2Vec2(rB2, impulse);
        }
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      RevoluteJoint2.TYPE = "revolute-joint";
      return RevoluteJoint2;
    }(Joint)
  );
  var math_abs$3 = Math.abs;
  var math_max = Math.max;
  var math_min$2 = Math.min;
  var LimitState$1;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState$1 || (LimitState$1 = {}));
  var DEFAULTS$7 = {
    enableLimit: false,
    lowerTranslation: 0,
    upperTranslation: 0,
    enableMotor: false,
    maxMotorForce: 0,
    motorSpeed: 0
  };
  var PrismaticJoint = (
    /** @class */
    function(_super) {
      __extends(PrismaticJoint2, _super);
      function PrismaticJoint2(def, bodyA, bodyB, anchor, axis) {
        var _this = this;
        if (!(_this instanceof PrismaticJoint2)) {
          return new PrismaticJoint2(def, bodyA, bodyB, anchor, axis);
        }
        def = options(def, DEFAULTS$7);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = PrismaticJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_localXAxisA = Vec2.clone(axis ? bodyA.getLocalVector(axis) : def.localAxisA || Vec2.neo(1, 0));
        _this.m_localXAxisA.normalize();
        _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);
        _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();
        _this.m_impulse = new Vec3();
        _this.m_motorMass = 0;
        _this.m_motorImpulse = 0;
        _this.m_lowerTranslation = def.lowerTranslation;
        _this.m_upperTranslation = def.upperTranslation;
        _this.m_maxMotorForce = def.maxMotorForce;
        _this.m_motorSpeed = def.motorSpeed;
        _this.m_enableLimit = def.enableLimit;
        _this.m_enableMotor = def.enableMotor;
        _this.m_limitState = LimitState$1.inactiveLimit;
        _this.m_axis = Vec2.zero();
        _this.m_perp = Vec2.zero();
        _this.m_K = new Mat33();
        return _this;
      }
      PrismaticJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          lowerTranslation: this.m_lowerTranslation,
          upperTranslation: this.m_upperTranslation,
          maxMotorForce: this.m_maxMotorForce,
          motorSpeed: this.m_motorSpeed,
          enableLimit: this.m_enableLimit,
          enableMotor: this.m_enableMotor,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          localAxisA: this.m_localXAxisA,
          referenceAngle: this.m_referenceAngle
        };
      };
      PrismaticJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.localAxisA = Vec2.clone(data.localAxisA);
        var joint = new PrismaticJoint2(data);
        return joint;
      };
      PrismaticJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.localAxisA) {
          this.m_localXAxisA.setVec2(def.localAxisA);
          this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));
        }
        if (Number.isFinite(def.referenceAngle)) {
          this.m_referenceAngle = def.referenceAngle;
        }
        if (typeof def.enableLimit !== "undefined") {
          this.m_enableLimit = !!def.enableLimit;
        }
        if (Number.isFinite(def.lowerTranslation)) {
          this.m_lowerTranslation = def.lowerTranslation;
        }
        if (Number.isFinite(def.upperTranslation)) {
          this.m_upperTranslation = def.upperTranslation;
        }
        if (typeof def.enableMotor !== "undefined") {
          this.m_enableMotor = !!def.enableMotor;
        }
        if (Number.isFinite(def.maxMotorForce)) {
          this.m_maxMotorForce = def.maxMotorForce;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
      };
      PrismaticJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      PrismaticJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      PrismaticJoint2.prototype.getLocalAxisA = function() {
        return this.m_localXAxisA;
      };
      PrismaticJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      PrismaticJoint2.prototype.getJointTranslation = function() {
        var pA2 = this.m_bodyA.getWorldPoint(this.m_localAnchorA);
        var pB2 = this.m_bodyB.getWorldPoint(this.m_localAnchorB);
        var d2 = Vec2.sub(pB2, pA2);
        var axis = this.m_bodyA.getWorldVector(this.m_localXAxisA);
        var translation2 = Vec2.dot(d2, axis);
        return translation2;
      };
      PrismaticJoint2.prototype.getJointSpeed = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        var rA2 = Rot.mulVec2(bA.m_xf.q, Vec2.sub(this.m_localAnchorA, bA.m_sweep.localCenter));
        var rB2 = Rot.mulVec2(bB.m_xf.q, Vec2.sub(this.m_localAnchorB, bB.m_sweep.localCenter));
        var p1 = Vec2.add(bA.m_sweep.c, rA2);
        var p2 = Vec2.add(bB.m_sweep.c, rB2);
        var d2 = Vec2.sub(p2, p1);
        var axis = Rot.mulVec2(bA.m_xf.q, this.m_localXAxisA);
        var vA2 = bA.m_linearVelocity;
        var vB2 = bB.m_linearVelocity;
        var wA = bA.m_angularVelocity;
        var wB = bB.m_angularVelocity;
        var speed = Vec2.dot(d2, Vec2.crossNumVec2(wA, axis)) + Vec2.dot(axis, Vec2.sub(Vec2.addCrossNumVec2(vB2, wB, rB2), Vec2.addCrossNumVec2(vA2, wA, rA2)));
        return speed;
      };
      PrismaticJoint2.prototype.isLimitEnabled = function() {
        return this.m_enableLimit;
      };
      PrismaticJoint2.prototype.enableLimit = function(flag) {
        if (flag != this.m_enableLimit) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_enableLimit = flag;
          this.m_impulse.z = 0;
        }
      };
      PrismaticJoint2.prototype.getLowerLimit = function() {
        return this.m_lowerTranslation;
      };
      PrismaticJoint2.prototype.getUpperLimit = function() {
        return this.m_upperTranslation;
      };
      PrismaticJoint2.prototype.setLimits = function(lower, upper) {
        if (lower != this.m_lowerTranslation || upper != this.m_upperTranslation) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_lowerTranslation = lower;
          this.m_upperTranslation = upper;
          this.m_impulse.z = 0;
        }
      };
      PrismaticJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      PrismaticJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      PrismaticJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      PrismaticJoint2.prototype.setMaxMotorForce = function(force) {
        if (force == this.m_maxMotorForce)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorForce = force;
      };
      PrismaticJoint2.prototype.getMaxMotorForce = function() {
        return this.m_maxMotorForce;
      };
      PrismaticJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      PrismaticJoint2.prototype.getMotorForce = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      PrismaticJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      PrismaticJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      PrismaticJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis).mul(inv_dt);
      };
      PrismaticJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.y;
      };
      PrismaticJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        {
          this.m_axis = Rot.mulVec2(qA, this.m_localXAxisA);
          this.m_a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_axis);
          this.m_a2 = Vec2.crossVec2Vec2(rB2, this.m_axis);
          this.m_motorMass = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;
          if (this.m_motorMass > 0) {
            this.m_motorMass = 1 / this.m_motorMass;
          }
        }
        {
          this.m_perp = Rot.mulVec2(qA, this.m_localYAxisA);
          this.m_s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_perp);
          this.m_s2 = Vec2.crossVec2Vec2(rB2, this.m_perp);
          Vec2.crossVec2Vec2(rA2, this.m_perp);
          var k11 = mA + mB + iA * this.m_s1 * this.m_s1 + iB * this.m_s2 * this.m_s2;
          var k12 = iA * this.m_s1 + iB * this.m_s2;
          var k13 = iA * this.m_s1 * this.m_a1 + iB * this.m_s2 * this.m_a2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var k23 = iA * this.m_a1 + iB * this.m_a2;
          var k33 = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;
          this.m_K.ex.set(k11, k12, k13);
          this.m_K.ey.set(k12, k22, k23);
          this.m_K.ez.set(k13, k23, k33);
        }
        if (this.m_enableLimit) {
          var jointTranslation = Vec2.dot(this.m_axis, d2);
          if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * SettingsInternal.linearSlop) {
            this.m_limitState = LimitState$1.equalLimits;
          } else if (jointTranslation <= this.m_lowerTranslation) {
            if (this.m_limitState != LimitState$1.atLowerLimit) {
              this.m_limitState = LimitState$1.atLowerLimit;
              this.m_impulse.z = 0;
            }
          } else if (jointTranslation >= this.m_upperTranslation) {
            if (this.m_limitState != LimitState$1.atUpperLimit) {
              this.m_limitState = LimitState$1.atUpperLimit;
              this.m_impulse.z = 0;
            }
          } else {
            this.m_limitState = LimitState$1.inactiveLimit;
            this.m_impulse.z = 0;
          }
        } else {
          this.m_limitState = LimitState$1.inactiveLimit;
          this.m_impulse.z = 0;
        }
        if (this.m_enableMotor == false) {
          this.m_motorImpulse = 0;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis);
          var LA = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1;
          var LB = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        } else {
          this.m_impulse.setZero();
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      PrismaticJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        if (this.m_enableMotor && this.m_limitState != LimitState$1.equalLimits) {
          var Cdot = Vec2.dot(this.m_axis, Vec2.sub(vB2, vA2)) + this.m_a2 * wB - this.m_a1 * wA;
          var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorForce;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_axis);
          var LA = impulse * this.m_a1;
          var LB = impulse * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        var Cdot1 = Vec2.zero();
        Cdot1.x += Vec2.dot(this.m_perp, vB2) + this.m_s2 * wB;
        Cdot1.x -= Vec2.dot(this.m_perp, vA2) + this.m_s1 * wA;
        Cdot1.y = wB - wA;
        if (this.m_enableLimit && this.m_limitState != LimitState$1.inactiveLimit) {
          var Cdot2 = 0;
          Cdot2 += Vec2.dot(this.m_axis, vB2) + this.m_a2 * wB;
          Cdot2 -= Vec2.dot(this.m_axis, vA2) + this.m_a1 * wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var f1 = Vec3.clone(this.m_impulse);
          var df = this.m_K.solve33(Vec3.neg(Cdot));
          this.m_impulse.add(df);
          if (this.m_limitState == LimitState$1.atLowerLimit) {
            this.m_impulse.z = math_max(this.m_impulse.z, 0);
          } else if (this.m_limitState == LimitState$1.atUpperLimit) {
            this.m_impulse.z = math_min$2(this.m_impulse.z, 0);
          }
          var b2 = Vec2.combine(-1, Cdot1, -(this.m_impulse.z - f1.z), Vec2.neo(this.m_K.ez.x, this.m_K.ez.y));
          var f2r = Vec2.add(this.m_K.solve22(b2), Vec2.neo(f1.x, f1.y));
          this.m_impulse.x = f2r.x;
          this.m_impulse.y = f2r.y;
          df = Vec3.sub(this.m_impulse, f1);
          var P3 = Vec2.combine(df.x, this.m_perp, df.z, this.m_axis);
          var LA = df.x * this.m_s1 + df.y + df.z * this.m_a1;
          var LB = df.x * this.m_s2 + df.y + df.z * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        } else {
          var df = this.m_K.solve22(Vec2.neg(Cdot1));
          this.m_impulse.x += df.x;
          this.m_impulse.y += df.y;
          var P3 = Vec2.mulNumVec2(df.x, this.m_perp);
          var LA = df.x * this.m_s1 + df.y;
          var LB = df.x * this.m_s2 + df.y;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PrismaticJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));
        var axis = Rot.mulVec2(qA, this.m_localXAxisA);
        var a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), axis);
        var a2 = Vec2.crossVec2Vec2(rB2, axis);
        var perp2 = Rot.mulVec2(qA, this.m_localYAxisA);
        var s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), perp2);
        var s2 = Vec2.crossVec2Vec2(rB2, perp2);
        var impulse = new Vec3();
        var C1 = Vec2.zero();
        C1.x = Vec2.dot(perp2, d2);
        C1.y = aB - aA - this.m_referenceAngle;
        var linearError = math_abs$3(C1.x);
        var angularError = math_abs$3(C1.y);
        var linearSlop = SettingsInternal.linearSlop;
        var maxLinearCorrection = SettingsInternal.maxLinearCorrection;
        var active = false;
        var C2 = 0;
        if (this.m_enableLimit) {
          var translation2 = Vec2.dot(axis, d2);
          if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * linearSlop) {
            C2 = clamp(translation2, -maxLinearCorrection, maxLinearCorrection);
            linearError = math_max(linearError, math_abs$3(translation2));
            active = true;
          } else if (translation2 <= this.m_lowerTranslation) {
            C2 = clamp(translation2 - this.m_lowerTranslation + linearSlop, -maxLinearCorrection, 0);
            linearError = Math.max(linearError, this.m_lowerTranslation - translation2);
            active = true;
          } else if (translation2 >= this.m_upperTranslation) {
            C2 = clamp(translation2 - this.m_upperTranslation - linearSlop, 0, maxLinearCorrection);
            linearError = Math.max(linearError, translation2 - this.m_upperTranslation);
            active = true;
          }
        }
        if (active) {
          var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;
          var k12 = iA * s1 + iB * s2;
          var k13 = iA * s1 * a1 + iB * s2 * a2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var k23 = iA * a1 + iB * a2;
          var k33 = mA + mB + iA * a1 * a1 + iB * a2 * a2;
          var K = new Mat33();
          K.ex.set(k11, k12, k13);
          K.ey.set(k12, k22, k23);
          K.ez.set(k13, k23, k33);
          var C = new Vec3();
          C.x = C1.x;
          C.y = C1.y;
          C.z = C2;
          impulse = K.solve33(Vec3.neg(C));
        } else {
          var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;
          var k12 = iA * s1 + iB * s2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var K = new Mat22();
          K.ex.setNum(k11, k12);
          K.ey.setNum(k12, k22);
          var impulse1 = K.solve(Vec2.neg(C1));
          impulse.x = impulse1.x;
          impulse.y = impulse1.y;
          impulse.z = 0;
        }
        var P3 = Vec2.combine(impulse.x, perp2, impulse.z, axis);
        var LA = impulse.x * s1 + impulse.y + impulse.z * a1;
        var LB = impulse.x * s2 + impulse.y + impulse.z * a2;
        cA2.subMul(mA, P3);
        aA -= iA * LA;
        cB2.addMul(mB, P3);
        aB += iB * LB;
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return linearError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      PrismaticJoint2.TYPE = "prismatic-joint";
      return PrismaticJoint2;
    }(Joint)
  );
  var DEFAULTS$6 = {
    ratio: 1
  };
  var GearJoint = (
    /** @class */
    function(_super) {
      __extends(GearJoint2, _super);
      function GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio) {
        var _this = this;
        if (!(_this instanceof GearJoint2)) {
          return new GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio);
        }
        def = options(def, DEFAULTS$6);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = GearJoint2.TYPE;
        _this.m_joint1 = joint1 ? joint1 : def.joint1;
        _this.m_joint2 = joint2 ? joint2 : def.joint2;
        _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;
        _this.m_type1 = _this.m_joint1.getType();
        _this.m_type2 = _this.m_joint2.getType();
        var coordinateA;
        var coordinateB;
        _this.m_bodyC = _this.m_joint1.getBodyA();
        _this.m_bodyA = _this.m_joint1.getBodyB();
        var xfA2 = _this.m_bodyA.m_xf;
        var aA = _this.m_bodyA.m_sweep.a;
        var xfC = _this.m_bodyC.m_xf;
        var aC = _this.m_bodyC.m_sweep.a;
        if (_this.m_type1 === RevoluteJoint.TYPE) {
          var revolute = _this.m_joint1;
          _this.m_localAnchorC = revolute.m_localAnchorA;
          _this.m_localAnchorA = revolute.m_localAnchorB;
          _this.m_referenceAngleA = revolute.m_referenceAngle;
          _this.m_localAxisC = Vec2.zero();
          coordinateA = aA - aC - _this.m_referenceAngleA;
        } else {
          var prismatic = _this.m_joint1;
          _this.m_localAnchorC = prismatic.m_localAnchorA;
          _this.m_localAnchorA = prismatic.m_localAnchorB;
          _this.m_referenceAngleA = prismatic.m_referenceAngle;
          _this.m_localAxisC = prismatic.m_localXAxisA;
          var pC = _this.m_localAnchorC;
          var pA2 = Rot.mulTVec2(xfC.q, Vec2.add(Rot.mulVec2(xfA2.q, _this.m_localAnchorA), Vec2.sub(xfA2.p, xfC.p)));
          coordinateA = Vec2.dot(pA2, _this.m_localAxisC) - Vec2.dot(pC, _this.m_localAxisC);
        }
        _this.m_bodyD = _this.m_joint2.getBodyA();
        _this.m_bodyB = _this.m_joint2.getBodyB();
        var xfB2 = _this.m_bodyB.m_xf;
        var aB = _this.m_bodyB.m_sweep.a;
        var xfD = _this.m_bodyD.m_xf;
        var aD = _this.m_bodyD.m_sweep.a;
        if (_this.m_type2 === RevoluteJoint.TYPE) {
          var revolute = _this.m_joint2;
          _this.m_localAnchorD = revolute.m_localAnchorA;
          _this.m_localAnchorB = revolute.m_localAnchorB;
          _this.m_referenceAngleB = revolute.m_referenceAngle;
          _this.m_localAxisD = Vec2.zero();
          coordinateB = aB - aD - _this.m_referenceAngleB;
        } else {
          var prismatic = _this.m_joint2;
          _this.m_localAnchorD = prismatic.m_localAnchorA;
          _this.m_localAnchorB = prismatic.m_localAnchorB;
          _this.m_referenceAngleB = prismatic.m_referenceAngle;
          _this.m_localAxisD = prismatic.m_localXAxisA;
          var pD = _this.m_localAnchorD;
          var pB2 = Rot.mulTVec2(xfD.q, Vec2.add(Rot.mulVec2(xfB2.q, _this.m_localAnchorB), Vec2.sub(xfB2.p, xfD.p)));
          coordinateB = Vec2.dot(pB2, _this.m_localAxisD) - Vec2.dot(pD, _this.m_localAxisD);
        }
        _this.m_constant = coordinateA + _this.m_ratio * coordinateB;
        _this.m_impulse = 0;
        return _this;
      }
      GearJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          joint1: this.m_joint1,
          joint2: this.m_joint2,
          ratio: this.m_ratio
          // _constant: this.m_constant,
        };
      };
      GearJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.joint1 = restore(Joint, data.joint1, world);
        data.joint2 = restore(Joint, data.joint2, world);
        var joint = new GearJoint2(data);
        return joint;
      };
      GearJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.ratio)) {
          this.m_ratio = def.ratio;
        }
      };
      GearJoint2.prototype.getJoint1 = function() {
        return this.m_joint1;
      };
      GearJoint2.prototype.getJoint2 = function() {
        return this.m_joint2;
      };
      GearJoint2.prototype.setRatio = function(ratio) {
        this.m_ratio = ratio;
      };
      GearJoint2.prototype.getRatio = function() {
        return this.m_ratio;
      };
      GearJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      GearJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      GearJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_JvAC).mul(inv_dt);
      };
      GearJoint2.prototype.getReactionTorque = function(inv_dt) {
        var L = this.m_impulse * this.m_JwA;
        return inv_dt * L;
      };
      GearJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_lcA = this.m_bodyA.m_sweep.localCenter;
        this.m_lcB = this.m_bodyB.m_sweep.localCenter;
        this.m_lcC = this.m_bodyC.m_sweep.localCenter;
        this.m_lcD = this.m_bodyD.m_sweep.localCenter;
        this.m_mA = this.m_bodyA.m_invMass;
        this.m_mB = this.m_bodyB.m_invMass;
        this.m_mC = this.m_bodyC.m_invMass;
        this.m_mD = this.m_bodyD.m_invMass;
        this.m_iA = this.m_bodyA.m_invI;
        this.m_iB = this.m_bodyB.m_invI;
        this.m_iC = this.m_bodyC.m_invI;
        this.m_iD = this.m_bodyD.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var aC = this.m_bodyC.c_position.a;
        var vC = this.m_bodyC.c_velocity.v;
        var wC = this.m_bodyC.c_velocity.w;
        var aD = this.m_bodyD.c_position.a;
        var vD = this.m_bodyD.c_velocity.v;
        var wD = this.m_bodyD.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var qC = Rot.neo(aC);
        var qD = Rot.neo(aD);
        this.m_mass = 0;
        if (this.m_type1 == RevoluteJoint.TYPE) {
          this.m_JvAC = Vec2.zero();
          this.m_JwA = 1;
          this.m_JwC = 1;
          this.m_mass += this.m_iA + this.m_iC;
        } else {
          var u = Rot.mulVec2(qC, this.m_localAxisC);
          var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);
          var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);
          this.m_JvAC = u;
          this.m_JwC = Vec2.crossVec2Vec2(rC, u);
          this.m_JwA = Vec2.crossVec2Vec2(rA2, u);
          this.m_mass += this.m_mC + this.m_mA + this.m_iC * this.m_JwC * this.m_JwC + this.m_iA * this.m_JwA * this.m_JwA;
        }
        if (this.m_type2 == RevoluteJoint.TYPE) {
          this.m_JvBD = Vec2.zero();
          this.m_JwB = this.m_ratio;
          this.m_JwD = this.m_ratio;
          this.m_mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);
        } else {
          var u = Rot.mulVec2(qD, this.m_localAxisD);
          var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);
          var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);
          this.m_JvBD = Vec2.mulNumVec2(this.m_ratio, u);
          this.m_JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);
          this.m_JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);
          this.m_mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * this.m_JwD * this.m_JwD + this.m_iB * this.m_JwB * this.m_JwB;
        }
        this.m_mass = this.m_mass > 0 ? 1 / this.m_mass : 0;
        if (step.warmStarting) {
          vA2.addMul(this.m_mA * this.m_impulse, this.m_JvAC);
          wA += this.m_iA * this.m_impulse * this.m_JwA;
          vB2.addMul(this.m_mB * this.m_impulse, this.m_JvBD);
          wB += this.m_iB * this.m_impulse * this.m_JwB;
          vC.subMul(this.m_mC * this.m_impulse, this.m_JvAC);
          wC -= this.m_iC * this.m_impulse * this.m_JwC;
          vD.subMul(this.m_mD * this.m_impulse, this.m_JvBD);
          wD -= this.m_iD * this.m_impulse * this.m_JwD;
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
        this.m_bodyC.c_velocity.v.setVec2(vC);
        this.m_bodyC.c_velocity.w = wC;
        this.m_bodyD.c_velocity.v.setVec2(vD);
        this.m_bodyD.c_velocity.w = wD;
      };
      GearJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vC = this.m_bodyC.c_velocity.v;
        var wC = this.m_bodyC.c_velocity.w;
        var vD = this.m_bodyD.c_velocity.v;
        var wD = this.m_bodyD.c_velocity.w;
        var Cdot = Vec2.dot(this.m_JvAC, vA2) - Vec2.dot(this.m_JvAC, vC) + Vec2.dot(this.m_JvBD, vB2) - Vec2.dot(this.m_JvBD, vD);
        Cdot += this.m_JwA * wA - this.m_JwC * wC + (this.m_JwB * wB - this.m_JwD * wD);
        var impulse = -this.m_mass * Cdot;
        this.m_impulse += impulse;
        vA2.addMul(this.m_mA * impulse, this.m_JvAC);
        wA += this.m_iA * impulse * this.m_JwA;
        vB2.addMul(this.m_mB * impulse, this.m_JvBD);
        wB += this.m_iB * impulse * this.m_JwB;
        vC.subMul(this.m_mC * impulse, this.m_JvAC);
        wC -= this.m_iC * impulse * this.m_JwC;
        vD.subMul(this.m_mD * impulse, this.m_JvBD);
        wD -= this.m_iD * impulse * this.m_JwD;
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
        this.m_bodyC.c_velocity.v.setVec2(vC);
        this.m_bodyC.c_velocity.w = wC;
        this.m_bodyD.c_velocity.v.setVec2(vD);
        this.m_bodyD.c_velocity.w = wD;
      };
      GearJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var cC = this.m_bodyC.c_position.c;
        var aC = this.m_bodyC.c_position.a;
        var cD = this.m_bodyD.c_position.c;
        var aD = this.m_bodyD.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var qC = Rot.neo(aC);
        var qD = Rot.neo(aD);
        var linearError = 0;
        var coordinateA;
        var coordinateB;
        var JvAC;
        var JvBD;
        var JwA;
        var JwB;
        var JwC;
        var JwD;
        var mass = 0;
        if (this.m_type1 == RevoluteJoint.TYPE) {
          JvAC = Vec2.zero();
          JwA = 1;
          JwC = 1;
          mass += this.m_iA + this.m_iC;
          coordinateA = aA - aC - this.m_referenceAngleA;
        } else {
          var u = Rot.mulVec2(qC, this.m_localAxisC);
          var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);
          var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);
          JvAC = u;
          JwC = Vec2.crossVec2Vec2(rC, u);
          JwA = Vec2.crossVec2Vec2(rA2, u);
          mass += this.m_mC + this.m_mA + this.m_iC * JwC * JwC + this.m_iA * JwA * JwA;
          var pC = Vec2.sub(this.m_localAnchorC, this.m_lcC);
          var pA2 = Rot.mulTVec2(qC, Vec2.add(rA2, Vec2.sub(cA2, cC)));
          coordinateA = Vec2.dot(Vec2.sub(pA2, pC), this.m_localAxisC);
        }
        if (this.m_type2 == RevoluteJoint.TYPE) {
          JvBD = Vec2.zero();
          JwB = this.m_ratio;
          JwD = this.m_ratio;
          mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);
          coordinateB = aB - aD - this.m_referenceAngleB;
        } else {
          var u = Rot.mulVec2(qD, this.m_localAxisD);
          var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);
          var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);
          JvBD = Vec2.mulNumVec2(this.m_ratio, u);
          JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);
          JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);
          mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * JwD * JwD + this.m_iB * JwB * JwB;
          var pD = Vec2.sub(this.m_localAnchorD, this.m_lcD);
          var pB2 = Rot.mulTVec2(qD, Vec2.add(rB2, Vec2.sub(cB2, cD)));
          coordinateB = Vec2.dot(pB2, this.m_localAxisD) - Vec2.dot(pD, this.m_localAxisD);
        }
        var C = coordinateA + this.m_ratio * coordinateB - this.m_constant;
        var impulse = 0;
        if (mass > 0) {
          impulse = -C / mass;
        }
        cA2.addMul(this.m_mA * impulse, JvAC);
        aA += this.m_iA * impulse * JwA;
        cB2.addMul(this.m_mB * impulse, JvBD);
        aB += this.m_iB * impulse * JwB;
        cC.subMul(this.m_mC * impulse, JvAC);
        aC -= this.m_iC * impulse * JwC;
        cD.subMul(this.m_mD * impulse, JvBD);
        aD -= this.m_iD * impulse * JwD;
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        this.m_bodyC.c_position.c.setVec2(cC);
        this.m_bodyC.c_position.a = aC;
        this.m_bodyD.c_position.c.setVec2(cD);
        this.m_bodyD.c_position.a = aD;
        return linearError < SettingsInternal.linearSlop;
      };
      GearJoint2.TYPE = "gear-joint";
      return GearJoint2;
    }(Joint)
  );
  var DEFAULTS$5 = {
    maxForce: 1,
    maxTorque: 1,
    correctionFactor: 0.3
  };
  var MotorJoint = (
    /** @class */
    function(_super) {
      __extends(MotorJoint2, _super);
      function MotorJoint2(def, bodyA, bodyB) {
        var _this = this;
        if (!(_this instanceof MotorJoint2)) {
          return new MotorJoint2(def, bodyA, bodyB);
        }
        def = options(def, DEFAULTS$5);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = MotorJoint2.TYPE;
        _this.m_linearOffset = Vec2.isValid(def.linearOffset) ? Vec2.clone(def.linearOffset) : bodyA.getLocalPoint(bodyB.getPosition());
        _this.m_angularOffset = Number.isFinite(def.angularOffset) ? def.angularOffset : bodyB.getAngle() - bodyA.getAngle();
        _this.m_linearImpulse = Vec2.zero();
        _this.m_angularImpulse = 0;
        _this.m_maxForce = def.maxForce;
        _this.m_maxTorque = def.maxTorque;
        _this.m_correctionFactor = def.correctionFactor;
        return _this;
      }
      MotorJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          maxForce: this.m_maxForce,
          maxTorque: this.m_maxTorque,
          correctionFactor: this.m_correctionFactor,
          linearOffset: this.m_linearOffset,
          angularOffset: this.m_angularOffset
        };
      };
      MotorJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new MotorJoint2(data);
        return joint;
      };
      MotorJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.angularOffset)) {
          this.m_angularOffset = def.angularOffset;
        }
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.maxTorque)) {
          this.m_maxTorque = def.maxTorque;
        }
        if (Number.isFinite(def.correctionFactor)) {
          this.m_correctionFactor = def.correctionFactor;
        }
        if (Vec2.isValid(def.linearOffset)) {
          this.m_linearOffset.set(def.linearOffset);
        }
      };
      MotorJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      MotorJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      MotorJoint2.prototype.setMaxTorque = function(torque) {
        this.m_maxTorque = torque;
      };
      MotorJoint2.prototype.getMaxTorque = function() {
        return this.m_maxTorque;
      };
      MotorJoint2.prototype.setCorrectionFactor = function(factor) {
        this.m_correctionFactor = factor;
      };
      MotorJoint2.prototype.getCorrectionFactor = function() {
        return this.m_correctionFactor;
      };
      MotorJoint2.prototype.setLinearOffset = function(linearOffset) {
        if (linearOffset.x != this.m_linearOffset.x || linearOffset.y != this.m_linearOffset.y) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_linearOffset.set(linearOffset);
        }
      };
      MotorJoint2.prototype.getLinearOffset = function() {
        return this.m_linearOffset;
      };
      MotorJoint2.prototype.setAngularOffset = function(angularOffset) {
        if (angularOffset != this.m_angularOffset) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_angularOffset = angularOffset;
        }
      };
      MotorJoint2.prototype.getAngularOffset = function() {
        return this.m_angularOffset;
      };
      MotorJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getPosition();
      };
      MotorJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getPosition();
      };
      MotorJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);
      };
      MotorJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_angularImpulse;
      };
      MotorJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_linearOffset, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.neg(this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat22();
        K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;
        K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;
        this.m_linearMass = K.getInverse();
        this.m_angularMass = iA + iB;
        if (this.m_angularMass > 0) {
          this.m_angularMass = 1 / this.m_angularMass;
        }
        this.m_linearError = Vec2.zero();
        this.m_linearError.addCombine(1, cB2, 1, this.m_rB);
        this.m_linearError.subCombine(1, cA2, 1, this.m_rA);
        this.m_angularError = aB - aA - this.m_angularOffset;
        if (step.warmStarting) {
          this.m_linearImpulse.mul(step.dtRatio);
          this.m_angularImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);
        } else {
          this.m_linearImpulse.setZero();
          this.m_angularImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      MotorJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var h = step.dt;
        var inv_h = step.inv_dt;
        {
          var Cdot = wB - wA + inv_h * this.m_correctionFactor * this.m_angularError;
          var impulse = -this.m_angularMass * Cdot;
          var oldImpulse = this.m_angularImpulse;
          var maxImpulse = h * this.m_maxTorque;
          this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_angularImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.zero();
          Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          Cdot.addMul(inv_h * this.m_correctionFactor, this.m_linearError);
          var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));
          var oldImpulse = Vec2.clone(this.m_linearImpulse);
          this.m_linearImpulse.add(impulse);
          var maxImpulse = h * this.m_maxForce;
          this.m_linearImpulse.clamp(maxImpulse);
          impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      MotorJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      MotorJoint2.TYPE = "motor-joint";
      return MotorJoint2;
    }(Joint)
  );
  var math_PI$2 = Math.PI;
  var DEFAULTS$4 = {
    maxForce: 0,
    frequencyHz: 5,
    dampingRatio: 0.7
  };
  var MouseJoint = (
    /** @class */
    function(_super) {
      __extends(MouseJoint2, _super);
      function MouseJoint2(def, bodyA, bodyB, target) {
        var _this = this;
        if (!(_this instanceof MouseJoint2)) {
          return new MouseJoint2(def, bodyA, bodyB, target);
        }
        def = options(def, DEFAULTS$4);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = MouseJoint2.TYPE;
        if (Vec2.isValid(target)) {
          _this.m_targetA = Vec2.clone(target);
        } else if (Vec2.isValid(def.target)) {
          _this.m_targetA = Vec2.clone(def.target);
        } else {
          _this.m_targetA = Vec2.zero();
        }
        _this.m_localAnchorB = Transform.mulTVec2(bodyB.getTransform(), _this.m_targetA);
        _this.m_maxForce = def.maxForce;
        _this.m_impulse = Vec2.zero();
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_beta = 0;
        _this.m_gamma = 0;
        _this.m_rB = Vec2.zero();
        _this.m_localCenterB = Vec2.zero();
        _this.m_invMassB = 0;
        _this.m_invIB = 0;
        _this.m_mass = new Mat22();
        _this.m_C = Vec2.zero();
        return _this;
      }
      MouseJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          target: this.m_targetA,
          maxForce: this.m_maxForce,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          _localAnchorB: this.m_localAnchorB
        };
      };
      MouseJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.target = Vec2.clone(data.target);
        var joint = new MouseJoint2(data);
        if (data._localAnchorB) {
          joint.m_localAnchorB = data._localAnchorB;
        }
        return joint;
      };
      MouseJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      MouseJoint2.prototype.setTarget = function(target) {
        if (Vec2.areEqual(target, this.m_targetA))
          return;
        this.m_bodyB.setAwake(true);
        this.m_targetA.set(target);
      };
      MouseJoint2.prototype.getTarget = function() {
        return this.m_targetA;
      };
      MouseJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      MouseJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      MouseJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      MouseJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      MouseJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      MouseJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      MouseJoint2.prototype.getAnchorA = function() {
        return Vec2.clone(this.m_targetA);
      };
      MouseJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      MouseJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_impulse);
      };
      MouseJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * 0;
      };
      MouseJoint2.prototype.shiftOrigin = function(newOrigin) {
        this.m_targetA.sub(newOrigin);
      };
      MouseJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIB = this.m_bodyB.m_invI;
        var position = this.m_bodyB.c_position;
        var velocity = this.m_bodyB.c_velocity;
        var cB2 = position.c;
        var aB = position.a;
        var vB2 = velocity.v;
        var wB = velocity.w;
        var qB = Rot.neo(aB);
        var mass = this.m_bodyB.getMass();
        var omega = 2 * math_PI$2 * this.m_frequencyHz;
        var d2 = 2 * mass * this.m_dampingRatio * omega;
        var k = mass * (omega * omega);
        var h = step.dt;
        this.m_gamma = h * (d2 + h * k);
        if (this.m_gamma != 0) {
          this.m_gamma = 1 / this.m_gamma;
        }
        this.m_beta = h * k * this.m_gamma;
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var K = new Mat22();
        K.ex.x = this.m_invMassB + this.m_invIB * this.m_rB.y * this.m_rB.y + this.m_gamma;
        K.ex.y = -this.m_invIB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = this.m_invMassB + this.m_invIB * this.m_rB.x * this.m_rB.x + this.m_gamma;
        this.m_mass = K.getInverse();
        this.m_C.setVec2(cB2);
        this.m_C.addCombine(1, this.m_rB, -1, this.m_targetA);
        this.m_C.mul(this.m_beta);
        wB *= 0.98;
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          vB2.addMul(this.m_invMassB, this.m_impulse);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, this.m_impulse);
        } else {
          this.m_impulse.setZero();
        }
        velocity.v.setVec2(vB2);
        velocity.w = wB;
      };
      MouseJoint2.prototype.solveVelocityConstraints = function(step) {
        var velocity = this.m_bodyB.c_velocity;
        var vB2 = Vec2.clone(velocity.v);
        var wB = velocity.w;
        var Cdot = Vec2.crossNumVec2(wB, this.m_rB);
        Cdot.add(vB2);
        Cdot.addCombine(1, this.m_C, this.m_gamma, this.m_impulse);
        Cdot.neg();
        var impulse = Mat22.mulVec2(this.m_mass, Cdot);
        var oldImpulse = Vec2.clone(this.m_impulse);
        this.m_impulse.add(impulse);
        var maxImpulse = step.dt * this.m_maxForce;
        this.m_impulse.clamp(maxImpulse);
        impulse = Vec2.sub(this.m_impulse, oldImpulse);
        vB2.addMul(this.m_invMassB, impulse);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        velocity.v.setVec2(vB2);
        velocity.w = wB;
      };
      MouseJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      MouseJoint2.TYPE = "mouse-joint";
      return MouseJoint2;
    }(Joint)
  );
  var math_abs$2 = Math.abs;
  var DEFAULTS$3 = {
    collideConnected: true
  };
  var PulleyJoint = (
    /** @class */
    function(_super) {
      __extends(PulleyJoint2, _super);
      function PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio) {
        var _this = this;
        if (!(_this instanceof PulleyJoint2)) {
          return new PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio);
        }
        def = options(def, DEFAULTS$3);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = PulleyJoint2.TYPE;
        _this.m_groundAnchorA = Vec2.clone(groundA ? groundA : def.groundAnchorA || Vec2.neo(-1, 1));
        _this.m_groundAnchorB = Vec2.clone(groundB ? groundB : def.groundAnchorB || Vec2.neo(1, 1));
        _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.neo(-1, 0));
        _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.neo(1, 0));
        _this.m_lengthA = Number.isFinite(def.lengthA) ? def.lengthA : Vec2.distance(anchorA, groundA);
        _this.m_lengthB = Number.isFinite(def.lengthB) ? def.lengthB : Vec2.distance(anchorB, groundB);
        _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;
        _this.m_constant = _this.m_lengthA + _this.m_ratio * _this.m_lengthB;
        _this.m_impulse = 0;
        return _this;
      }
      PulleyJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          groundAnchorA: this.m_groundAnchorA,
          groundAnchorB: this.m_groundAnchorB,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          lengthA: this.m_lengthA,
          lengthB: this.m_lengthB,
          ratio: this.m_ratio
        };
      };
      PulleyJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new PulleyJoint2(data);
        return joint;
      };
      PulleyJoint2.prototype._reset = function(def) {
        if (Vec2.isValid(def.groundAnchorA)) {
          this.m_groundAnchorA.set(def.groundAnchorA);
        }
        if (Vec2.isValid(def.groundAnchorB)) {
          this.m_groundAnchorB.set(def.groundAnchorB);
        }
        if (Vec2.isValid(def.localAnchorA)) {
          this.m_localAnchorA.set(def.localAnchorA);
        } else if (Vec2.isValid(def.anchorA)) {
          this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(def.anchorA));
        }
        if (Vec2.isValid(def.localAnchorB)) {
          this.m_localAnchorB.set(def.localAnchorB);
        } else if (Vec2.isValid(def.anchorB)) {
          this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(def.anchorB));
        }
        if (Number.isFinite(def.lengthA)) {
          this.m_lengthA = def.lengthA;
        }
        if (Number.isFinite(def.lengthB)) {
          this.m_lengthB = def.lengthB;
        }
        if (Number.isFinite(def.ratio)) {
          this.m_ratio = def.ratio;
        }
      };
      PulleyJoint2.prototype.getGroundAnchorA = function() {
        return this.m_groundAnchorA;
      };
      PulleyJoint2.prototype.getGroundAnchorB = function() {
        return this.m_groundAnchorB;
      };
      PulleyJoint2.prototype.getLengthA = function() {
        return this.m_lengthA;
      };
      PulleyJoint2.prototype.getLengthB = function() {
        return this.m_lengthB;
      };
      PulleyJoint2.prototype.getRatio = function() {
        return this.m_ratio;
      };
      PulleyJoint2.prototype.getCurrentLengthA = function() {
        var p = this.m_bodyA.getWorldPoint(this.m_localAnchorA);
        var s2 = this.m_groundAnchorA;
        return Vec2.distance(p, s2);
      };
      PulleyJoint2.prototype.getCurrentLengthB = function() {
        var p = this.m_bodyB.getWorldPoint(this.m_localAnchorB);
        var s2 = this.m_groundAnchorB;
        return Vec2.distance(p, s2);
      };
      PulleyJoint2.prototype.shiftOrigin = function(newOrigin) {
        this.m_groundAnchorA.sub(newOrigin);
        this.m_groundAnchorB.sub(newOrigin);
      };
      PulleyJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      PulleyJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      PulleyJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_uB).mul(inv_dt);
      };
      PulleyJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      PulleyJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        this.m_uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);
        this.m_uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);
        var lengthA = this.m_uA.length();
        var lengthB = this.m_uB.length();
        if (lengthA > 10 * SettingsInternal.linearSlop) {
          this.m_uA.mul(1 / lengthA);
        } else {
          this.m_uA.setZero();
        }
        if (lengthB > 10 * SettingsInternal.linearSlop) {
          this.m_uB.mul(1 / lengthB);
        } else {
          this.m_uB.setZero();
        }
        var ruA = Vec2.crossVec2Vec2(this.m_rA, this.m_uA);
        var ruB = Vec2.crossVec2Vec2(this.m_rB, this.m_uB);
        var mA = this.m_invMassA + this.m_invIA * ruA * ruA;
        var mB = this.m_invMassB + this.m_invIB * ruB * ruB;
        this.m_mass = mA + this.m_ratio * this.m_ratio * mB;
        if (this.m_mass > 0) {
          this.m_mass = 1 / this.m_mass;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var PA = Vec2.mulNumVec2(-this.m_impulse, this.m_uA);
          var PB = Vec2.mulNumVec2(-this.m_ratio * this.m_impulse, this.m_uB);
          vA2.addMul(this.m_invMassA, PA);
          wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);
          vB2.addMul(this.m_invMassB, PB);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PulleyJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));
        var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));
        var Cdot = -Vec2.dot(this.m_uA, vpA) - this.m_ratio * Vec2.dot(this.m_uB, vpB);
        var impulse = -this.m_mass * Cdot;
        this.m_impulse += impulse;
        var PA = Vec2.mulNumVec2(-impulse, this.m_uA);
        var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, this.m_uB);
        vA2.addMul(this.m_invMassA, PA);
        wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);
        vB2.addMul(this.m_invMassB, PB);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PulleyJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);
        var uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);
        var lengthA = uA.length();
        var lengthB = uB.length();
        if (lengthA > 10 * SettingsInternal.linearSlop) {
          uA.mul(1 / lengthA);
        } else {
          uA.setZero();
        }
        if (lengthB > 10 * SettingsInternal.linearSlop) {
          uB.mul(1 / lengthB);
        } else {
          uB.setZero();
        }
        var ruA = Vec2.crossVec2Vec2(rA2, uA);
        var ruB = Vec2.crossVec2Vec2(rB2, uB);
        var mA = this.m_invMassA + this.m_invIA * ruA * ruA;
        var mB = this.m_invMassB + this.m_invIB * ruB * ruB;
        var mass = mA + this.m_ratio * this.m_ratio * mB;
        if (mass > 0) {
          mass = 1 / mass;
        }
        var C = this.m_constant - lengthA - this.m_ratio * lengthB;
        var linearError = math_abs$2(C);
        var impulse = -mass * C;
        var PA = Vec2.mulNumVec2(-impulse, uA);
        var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, uB);
        cA2.addMul(this.m_invMassA, PA);
        aA += this.m_invIA * Vec2.crossVec2Vec2(rA2, PA);
        cB2.addMul(this.m_invMassB, PB);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, PB);
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return linearError < SettingsInternal.linearSlop;
      };
      PulleyJoint2.TYPE = "pulley-joint";
      return PulleyJoint2;
    }(Joint)
  );
  var math_min$1 = Math.min;
  var LimitState;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState || (LimitState = {}));
  var DEFAULTS$2 = {
    maxLength: 0
  };
  var RopeJoint = (
    /** @class */
    function(_super) {
      __extends(RopeJoint2, _super);
      function RopeJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof RopeJoint2)) {
          return new RopeJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$2);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = RopeJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.neo(-1, 0));
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.neo(1, 0));
        _this.m_maxLength = def.maxLength;
        _this.m_mass = 0;
        _this.m_impulse = 0;
        _this.m_length = 0;
        _this.m_state = LimitState.inactiveLimit;
        return _this;
      }
      RopeJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          maxLength: this.m_maxLength
        };
      };
      RopeJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new RopeJoint2(data);
        return joint;
      };
      RopeJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.maxLength)) {
          this.m_maxLength = def.maxLength;
        }
      };
      RopeJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      RopeJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      RopeJoint2.prototype.setMaxLength = function(length) {
        this.m_maxLength = length;
      };
      RopeJoint2.prototype.getMaxLength = function() {
        return this.m_maxLength;
      };
      RopeJoint2.prototype.getLimitState = function() {
        return this.m_state;
      };
      RopeJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      RopeJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      RopeJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);
      };
      RopeJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      RopeJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        this.m_rB = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        this.m_u = Vec2.zero();
        this.m_u.addCombine(1, cB2, 1, this.m_rB);
        this.m_u.subCombine(1, cA2, 1, this.m_rA);
        this.m_length = this.m_u.length();
        var C = this.m_length - this.m_maxLength;
        if (C > 0) {
          this.m_state = LimitState.atUpperLimit;
        } else {
          this.m_state = LimitState.inactiveLimit;
        }
        if (this.m_length > SettingsInternal.linearSlop) {
          this.m_u.mul(1 / this.m_length);
        } else {
          this.m_u.setZero();
          this.m_mass = 0;
          this.m_impulse = 0;
          return;
        }
        var crA = Vec2.crossVec2Vec2(this.m_rA, this.m_u);
        var crB = Vec2.crossVec2Vec2(this.m_rB, this.m_u);
        var invMass = this.m_invMassA + this.m_invIA * crA * crA + this.m_invMassB + this.m_invIB * crB * crB;
        this.m_mass = invMass != 0 ? 1 / invMass : 0;
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      RopeJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.addCrossNumVec2(vA2, wA, this.m_rA);
        var vpB = Vec2.addCrossNumVec2(vB2, wB, this.m_rB);
        var C = this.m_length - this.m_maxLength;
        var Cdot = Vec2.dot(this.m_u, Vec2.sub(vpB, vpA));
        if (C < 0) {
          Cdot += step.inv_dt * C;
        }
        var impulse = -this.m_mass * Cdot;
        var oldImpulse = this.m_impulse;
        this.m_impulse = math_min$1(0, this.m_impulse + impulse);
        impulse = this.m_impulse - oldImpulse;
        var P3 = Vec2.mulNumVec2(impulse, this.m_u);
        vA2.subMul(this.m_invMassA, P3);
        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
        vB2.addMul(this.m_invMassB, P3);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RopeJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        var u = Vec2.zero();
        u.addCombine(1, cB2, 1, rB2);
        u.subCombine(1, cA2, 1, rA2);
        var length = u.normalize();
        var C = length - this.m_maxLength;
        C = clamp(C, 0, SettingsInternal.maxLinearCorrection);
        var impulse = -this.m_mass * C;
        var P3 = Vec2.mulNumVec2(impulse, u);
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return length - this.m_maxLength < SettingsInternal.linearSlop;
      };
      RopeJoint2.TYPE = "rope-joint";
      return RopeJoint2;
    }(Joint)
  );
  var math_abs$1 = Math.abs;
  var math_PI$1 = Math.PI;
  var DEFAULTS$1 = {
    frequencyHz: 0,
    dampingRatio: 0
  };
  var WeldJoint = (
    /** @class */
    function(_super) {
      __extends(WeldJoint2, _super);
      function WeldJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof WeldJoint2)) {
          return new WeldJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$1);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = WeldJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_impulse = new Vec3();
        _this.m_bias = 0;
        _this.m_gamma = 0;
        _this.m_mass = new Mat33();
        return _this;
      }
      WeldJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          referenceAngle: this.m_referenceAngle
        };
      };
      WeldJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new WeldJoint2(data);
        return joint;
      };
      WeldJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      WeldJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      WeldJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      WeldJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      WeldJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      WeldJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      WeldJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      WeldJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      WeldJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      WeldJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      WeldJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);
      };
      WeldJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.z;
      };
      WeldJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat33();
        K.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;
        K.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;
        K.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;
        K.ex.y = K.ey.x;
        K.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;
        K.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;
        K.ex.z = K.ez.x;
        K.ey.z = K.ez.y;
        K.ez.z = iA + iB;
        if (this.m_frequencyHz > 0) {
          K.getInverse22(this.m_mass);
          var invM = iA + iB;
          var m = invM > 0 ? 1 / invM : 0;
          var C = aB - aA - this.m_referenceAngle;
          var omega = 2 * math_PI$1 * this.m_frequencyHz;
          var d2 = 2 * m * this.m_dampingRatio * omega;
          var k = m * omega * omega;
          var h = step.dt;
          this.m_gamma = h * (d2 + h * k);
          this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;
          this.m_bias = C * h * k * this.m_gamma;
          invM += this.m_gamma;
          this.m_mass.ez.z = invM != 0 ? 1 / invM : 0;
        } else if (K.ez.z == 0) {
          K.getInverse22(this.m_mass);
          this.m_gamma = 0;
          this.m_bias = 0;
        } else {
          K.getSymInverse33(this.m_mass);
          this.m_gamma = 0;
          this.m_bias = 0;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_impulse.z);
        } else {
          this.m_impulse.setZero();
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      WeldJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        if (this.m_frequencyHz > 0) {
          var Cdot2 = wB - wA;
          var impulse2 = -this.m_mass.ez.z * (Cdot2 + this.m_bias + this.m_gamma * this.m_impulse.z);
          this.m_impulse.z += impulse2;
          wA -= iA * impulse2;
          wB += iB * impulse2;
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var impulse1 = Vec2.neg(Mat33.mulVec2(this.m_mass, Cdot1));
          this.m_impulse.x += impulse1.x;
          this.m_impulse.y += impulse1.y;
          var P3 = Vec2.clone(impulse1);
          vA2.subMul(mA, P3);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(mB, P3);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var Cdot2 = wB - wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var impulse = Vec3.neg(Mat33.mulVec3(this.m_mass, Cdot));
          this.m_impulse.add(impulse);
          var P3 = Vec2.neo(impulse.x, impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      WeldJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var positionError;
        var angularError;
        var K = new Mat33();
        K.ex.x = mA + mB + rA2.y * rA2.y * iA + rB2.y * rB2.y * iB;
        K.ey.x = -rA2.y * rA2.x * iA - rB2.y * rB2.x * iB;
        K.ez.x = -rA2.y * iA - rB2.y * iB;
        K.ex.y = K.ey.x;
        K.ey.y = mA + mB + rA2.x * rA2.x * iA + rB2.x * rB2.x * iB;
        K.ez.y = rA2.x * iA + rB2.x * iB;
        K.ex.z = K.ez.x;
        K.ey.z = K.ez.y;
        K.ez.z = iA + iB;
        if (this.m_frequencyHz > 0) {
          var C1 = Vec2.zero();
          C1.addCombine(1, cB2, 1, rB2);
          C1.subCombine(1, cA2, 1, rA2);
          positionError = C1.length();
          angularError = 0;
          var P3 = Vec2.neg(K.solve22(C1));
          cA2.subMul(mA, P3);
          aA -= iA * Vec2.crossVec2Vec2(rA2, P3);
          cB2.addMul(mB, P3);
          aB += iB * Vec2.crossVec2Vec2(rB2, P3);
        } else {
          var C1 = Vec2.zero();
          C1.addCombine(1, cB2, 1, rB2);
          C1.subCombine(1, cA2, 1, rA2);
          var C2 = aB - aA - this.m_referenceAngle;
          positionError = C1.length();
          angularError = math_abs$1(C2);
          var C = new Vec3(C1.x, C1.y, C2);
          var impulse = new Vec3();
          if (K.ez.z > 0) {
            impulse = Vec3.neg(K.solve33(C));
          } else {
            var impulse2 = Vec2.neg(K.solve22(C1));
            impulse.set(impulse2.x, impulse2.y, 0);
          }
          var P3 = Vec2.neo(impulse.x, impulse.y);
          cA2.subMul(mA, P3);
          aA -= iA * (Vec2.crossVec2Vec2(rA2, P3) + impulse.z);
          cB2.addMul(mB, P3);
          aB += iB * (Vec2.crossVec2Vec2(rB2, P3) + impulse.z);
        }
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      WeldJoint2.TYPE = "weld-joint";
      return WeldJoint2;
    }(Joint)
  );
  var math_abs = Math.abs;
  var math_PI = Math.PI;
  var DEFAULTS = {
    enableMotor: false,
    maxMotorTorque: 0,
    motorSpeed: 0,
    frequencyHz: 2,
    dampingRatio: 0.7
  };
  var WheelJoint = (
    /** @class */
    function(_super) {
      __extends(WheelJoint2, _super);
      function WheelJoint2(def, bodyA, bodyB, anchor, axis) {
        var _this = this;
        if (!(_this instanceof WheelJoint2)) {
          return new WheelJoint2(def, bodyA, bodyB, anchor, axis);
        }
        def = options(def, DEFAULTS);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_ax = Vec2.zero();
        _this.m_ay = Vec2.zero();
        _this.m_type = WheelJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        if (Vec2.isValid(axis)) {
          _this.m_localXAxisA = bodyA.getLocalVector(axis);
        } else if (Vec2.isValid(def.localAxisA)) {
          _this.m_localXAxisA = Vec2.clone(def.localAxisA);
        } else if (Vec2.isValid(def.localAxis)) {
          _this.m_localXAxisA = Vec2.clone(def.localAxis);
        } else {
          _this.m_localXAxisA = Vec2.neo(1, 0);
        }
        _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);
        _this.m_mass = 0;
        _this.m_impulse = 0;
        _this.m_motorMass = 0;
        _this.m_motorImpulse = 0;
        _this.m_springMass = 0;
        _this.m_springImpulse = 0;
        _this.m_maxMotorTorque = def.maxMotorTorque;
        _this.m_motorSpeed = def.motorSpeed;
        _this.m_enableMotor = def.enableMotor;
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_bias = 0;
        _this.m_gamma = 0;
        return _this;
      }
      WheelJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          enableMotor: this.m_enableMotor,
          maxMotorTorque: this.m_maxMotorTorque,
          motorSpeed: this.m_motorSpeed,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          localAxisA: this.m_localXAxisA
        };
      };
      WheelJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new WheelJoint2(data);
        return joint;
      };
      WheelJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.localAxisA) {
          this.m_localXAxisA.setVec2(def.localAxisA);
          this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));
        }
        if (def.enableMotor !== void 0) {
          this.m_enableMotor = def.enableMotor;
        }
        if (Number.isFinite(def.maxMotorTorque)) {
          this.m_maxMotorTorque = def.maxMotorTorque;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      WheelJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      WheelJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      WheelJoint2.prototype.getLocalAxisA = function() {
        return this.m_localXAxisA;
      };
      WheelJoint2.prototype.getJointTranslation = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        var pA2 = bA.getWorldPoint(this.m_localAnchorA);
        var pB2 = bB.getWorldPoint(this.m_localAnchorB);
        var d2 = Vec2.sub(pB2, pA2);
        var axis = bA.getWorldVector(this.m_localXAxisA);
        var translation2 = Vec2.dot(d2, axis);
        return translation2;
      };
      WheelJoint2.prototype.getJointSpeed = function() {
        var wA = this.m_bodyA.m_angularVelocity;
        var wB = this.m_bodyB.m_angularVelocity;
        return wB - wA;
      };
      WheelJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      WheelJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      WheelJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      WheelJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      WheelJoint2.prototype.setMaxMotorTorque = function(torque) {
        if (torque == this.m_maxMotorTorque)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorTorque = torque;
      };
      WheelJoint2.prototype.getMaxMotorTorque = function() {
        return this.m_maxMotorTorque;
      };
      WheelJoint2.prototype.getMotorTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      WheelJoint2.prototype.setSpringFrequencyHz = function(hz) {
        this.m_frequencyHz = hz;
      };
      WheelJoint2.prototype.getSpringFrequencyHz = function() {
        return this.m_frequencyHz;
      };
      WheelJoint2.prototype.setSpringDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      WheelJoint2.prototype.getSpringDampingRatio = function() {
        return this.m_dampingRatio;
      };
      WheelJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      WheelJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      WheelJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax).mul(inv_dt);
      };
      WheelJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      WheelJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        {
          this.m_ay = Rot.mulVec2(qA, this.m_localYAxisA);
          this.m_sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ay);
          this.m_sBy = Vec2.crossVec2Vec2(rB2, this.m_ay);
          this.m_mass = mA + mB + iA * this.m_sAy * this.m_sAy + iB * this.m_sBy * this.m_sBy;
          if (this.m_mass > 0) {
            this.m_mass = 1 / this.m_mass;
          }
        }
        this.m_springMass = 0;
        this.m_bias = 0;
        this.m_gamma = 0;
        if (this.m_frequencyHz > 0) {
          this.m_ax = Rot.mulVec2(qA, this.m_localXAxisA);
          this.m_sAx = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ax);
          this.m_sBx = Vec2.crossVec2Vec2(rB2, this.m_ax);
          var invMass = mA + mB + iA * this.m_sAx * this.m_sAx + iB * this.m_sBx * this.m_sBx;
          if (invMass > 0) {
            this.m_springMass = 1 / invMass;
            var C = Vec2.dot(d2, this.m_ax);
            var omega = 2 * math_PI * this.m_frequencyHz;
            var damp = 2 * this.m_springMass * this.m_dampingRatio * omega;
            var k = this.m_springMass * omega * omega;
            var h = step.dt;
            this.m_gamma = h * (damp + h * k);
            if (this.m_gamma > 0) {
              this.m_gamma = 1 / this.m_gamma;
            }
            this.m_bias = C * h * k * this.m_gamma;
            this.m_springMass = invMass + this.m_gamma;
            if (this.m_springMass > 0) {
              this.m_springMass = 1 / this.m_springMass;
            }
          }
        } else {
          this.m_springImpulse = 0;
        }
        if (this.m_enableMotor) {
          this.m_motorMass = iA + iB;
          if (this.m_motorMass > 0) {
            this.m_motorMass = 1 / this.m_motorMass;
          }
        } else {
          this.m_motorMass = 0;
          this.m_motorImpulse = 0;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          this.m_springImpulse *= step.dtRatio;
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax);
          var LA = this.m_impulse * this.m_sAy + this.m_springImpulse * this.m_sAx + this.m_motorImpulse;
          var LB = this.m_impulse * this.m_sBy + this.m_springImpulse * this.m_sBx + this.m_motorImpulse;
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * LA;
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * LB;
        } else {
          this.m_impulse = 0;
          this.m_springImpulse = 0;
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      WheelJoint2.prototype.solveVelocityConstraints = function(step) {
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        {
          var Cdot = Vec2.dot(this.m_ax, vB2) - Vec2.dot(this.m_ax, vA2) + this.m_sBx * wB - this.m_sAx * wA;
          var impulse = -this.m_springMass * (Cdot + this.m_bias + this.m_gamma * this.m_springImpulse);
          this.m_springImpulse += impulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_ax);
          var LA = impulse * this.m_sAx;
          var LB = impulse * this.m_sBx;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        {
          var Cdot = wB - wA - this.m_motorSpeed;
          var impulse = -this.m_motorMass * Cdot;
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorTorque;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.dot(this.m_ay, vB2) - Vec2.dot(this.m_ay, vA2) + this.m_sBy * wB - this.m_sAy * wA;
          var impulse = -this.m_mass * Cdot;
          this.m_impulse += impulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_ay);
          var LA = impulse * this.m_sAy;
          var LB = impulse * this.m_sBy;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      WheelJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        var ay = Rot.mulVec2(qA, this.m_localYAxisA);
        var sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), ay);
        var sBy = Vec2.crossVec2Vec2(rB2, ay);
        var C = Vec2.dot(d2, ay);
        var k = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_sAy * this.m_sAy + this.m_invIB * this.m_sBy * this.m_sBy;
        var impulse = k != 0 ? -C / k : 0;
        var P3 = Vec2.mulNumVec2(impulse, ay);
        var LA = impulse * sAy;
        var LB = impulse * sBy;
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * LA;
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * LB;
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return math_abs(C) <= SettingsInternal.linearSlop;
      };
      WheelJoint2.TYPE = "wheel-joint";
      return WheelJoint2;
    }(Joint)
  );
  var _a;
  var SID = 0;
  var SERIALIZE_REF_TYPES = {
    "World": World,
    "Body": Body,
    "Joint": Joint,
    "Fixture": Fixture,
    "Shape": Shape
  };
  var DESERIALIZE_BY_REF_TYPE = {
    "Vec2": Vec2,
    "Vec3": Vec3,
    "World": World,
    "Body": Body,
    "Joint": Joint,
    "Fixture": Fixture,
    "Shape": Shape
  };
  var DESERIALIZE_BY_TYPE_FIELD = (_a = {}, _a[Body.STATIC] = Body, _a[Body.DYNAMIC] = Body, _a[Body.KINEMATIC] = Body, _a[ChainShape.TYPE] = ChainShape, // [BoxShape.TYPE]: BoxShape,
  _a[PolygonShape.TYPE] = PolygonShape, _a[EdgeShape.TYPE] = EdgeShape, _a[CircleShape.TYPE] = CircleShape, _a[DistanceJoint.TYPE] = DistanceJoint, _a[FrictionJoint.TYPE] = FrictionJoint, _a[GearJoint.TYPE] = GearJoint, _a[MotorJoint.TYPE] = MotorJoint, _a[MouseJoint.TYPE] = MouseJoint, _a[PrismaticJoint.TYPE] = PrismaticJoint, _a[PulleyJoint.TYPE] = PulleyJoint, _a[RevoluteJoint.TYPE] = RevoluteJoint, _a[RopeJoint.TYPE] = RopeJoint, _a[WeldJoint.TYPE] = WeldJoint, _a[WheelJoint.TYPE] = WheelJoint, _a);
  var DEFAULT_OPTIONS = {
    rootClass: World,
    preSerialize: function(obj) {
      return obj;
    },
    postSerialize: function(data, obj) {
      return data;
    },
    preDeserialize: function(data) {
      return data;
    },
    postDeserialize: function(obj, data) {
      return obj;
    }
  };
  var Serializer = (
    /** @class */
    /* @__PURE__ */ function() {
      function Serializer2(options2) {
        var _this = this;
        this.toJson = function(root) {
          var preSerialize = _this.options.preSerialize;
          var postSerialize = _this.options.postSerialize;
          var json = [];
          var refQueue = [root];
          var refMemoById = {};
          function addToRefQueue(value, typeName) {
            value.__sid = value.__sid || ++SID;
            if (!refMemoById[value.__sid]) {
              refQueue.push(value);
              var index = json.length + refQueue.length;
              var ref = {
                refIndex: index,
                refType: typeName
              };
              refMemoById[value.__sid] = ref;
            }
            return refMemoById[value.__sid];
          }
          function serializeWithHooks(obj2) {
            obj2 = preSerialize(obj2);
            var data = obj2._serialize();
            data = postSerialize(data, obj2);
            return data;
          }
          function traverse(value, noRefType) {
            if (noRefType === void 0) {
              noRefType = false;
            }
            if (typeof value !== "object" || value === null) {
              return value;
            }
            if (typeof value._serialize === "function") {
              if (!noRefType) {
                for (var typeName in SERIALIZE_REF_TYPES) {
                  if (value instanceof SERIALIZE_REF_TYPES[typeName]) {
                    return addToRefQueue(value, typeName);
                  }
                }
              }
              value = serializeWithHooks(value);
            }
            if (Array.isArray(value)) {
              var newValue = [];
              for (var key = 0; key < value.length; key++) {
                newValue[key] = traverse(value[key]);
              }
              value = newValue;
            } else {
              var newValue = {};
              for (var key in value) {
                if (value.hasOwnProperty(key)) {
                  newValue[key] = traverse(value[key]);
                }
              }
              value = newValue;
            }
            return value;
          }
          while (refQueue.length) {
            var obj = refQueue.shift();
            var str = traverse(obj, true);
            json.push(str);
          }
          return json;
        };
        this.fromJson = function(json) {
          var preDeserialize = _this.options.preDeserialize;
          var postDeserialize = _this.options.postDeserialize;
          var rootClass = _this.options.rootClass;
          var deserializedRefMemoByIndex = {};
          function deserializeWithHooks(classHint, data, context) {
            if (!classHint || !classHint._deserialize) {
              classHint = DESERIALIZE_BY_TYPE_FIELD[data.type];
            }
            var deserializer = classHint && classHint._deserialize;
            if (!deserializer) {
              return;
            }
            data = preDeserialize(data);
            var classDeserializeFn = classHint._deserialize;
            var obj = classDeserializeFn(data, context, deserializeChild);
            obj = postDeserialize(obj, data);
            return obj;
          }
          function deserializeChild(classHint, dataOrRef, context) {
            var isRefObject = dataOrRef.refIndex && dataOrRef.refType;
            if (!isRefObject) {
              return deserializeWithHooks(classHint, dataOrRef, context);
            }
            var ref = dataOrRef;
            if (DESERIALIZE_BY_REF_TYPE[ref.refType]) {
              classHint = DESERIALIZE_BY_REF_TYPE[ref.refType];
            }
            var refIndex = ref.refIndex;
            if (!deserializedRefMemoByIndex[refIndex]) {
              var data = json[refIndex];
              var obj = deserializeWithHooks(classHint, data, context);
              deserializedRefMemoByIndex[refIndex] = obj;
            }
            return deserializedRefMemoByIndex[refIndex];
          }
          var root = deserializeWithHooks(rootClass, json[0], null);
          return root;
        };
        this.options = __assign(__assign({}, DEFAULT_OPTIONS), options2);
      }
      return Serializer2;
    }()
  );
  var worldSerializer = new Serializer({
    rootClass: World
  });
  Serializer.fromJson = worldSerializer.fromJson;
  Serializer.toJson = worldSerializer.toJson;
  var Testbed = (
    /** @class */
    function() {
      function Testbed2() {
      }
      Testbed2.mount = function(options2) {
        throw new Error("Not implemented");
      };
      Testbed2.start = function(world) {
        var testbed2 = Testbed2.mount();
        testbed2.start(world);
        return testbed2;
      };
      return Testbed2;
    }()
  );
  function testbed(a2, b2) {
    var callback;
    var options2;
    if (typeof a2 === "function") {
      callback = a2;
      options2 = b2;
    } else if (typeof b2 === "function") {
      callback = b2;
      options2 = a2;
    } else {
      options2 = a2 !== null && a2 !== void 0 ? a2 : b2;
    }
    var testbed2 = Testbed.mount(options2);
    if (callback) {
      var world = callback(testbed2) || testbed2.world;
      testbed2.start(world);
    } else {
      return testbed2;
    }
  }
  var BoxShape = (
    /** @class */
    function(_super) {
      __extends(BoxShape2, _super);
      function BoxShape2(halfWidth, halfHeight, center2, angle) {
        var _this = this;
        if (!(_this instanceof BoxShape2)) {
          return new BoxShape2(halfWidth, halfHeight, center2, angle);
        }
        _this = _super.call(this) || this;
        _this._setAsBox(halfWidth, halfHeight, center2, angle);
        return _this;
      }
      BoxShape2.TYPE = "polygon";
      return BoxShape2;
    }(PolygonShape)
  );
  Contact.addType(CircleShape.TYPE, CircleShape.TYPE, CircleCircleContact);
  function CircleCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollideCircles(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  var pA = vec2(0, 0);
  var pB = vec2(0, 0);
  var CollideCircles = function(manifold, circleA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    transformVec2(pA, xfA2, circleA.m_p);
    transformVec2(pB, xfB2, circleB.m_p);
    var distSqr = distSqrVec2(pB, pA);
    var rA2 = circleA.m_radius;
    var rB2 = circleB.m_radius;
    var radius = rA2 + rB2;
    if (distSqr > radius * radius) {
      return;
    }
    manifold.type = exports2.ManifoldType.e_circles;
    copyVec2(manifold.localPoint, circleA.m_p);
    zeroVec2(manifold.localNormal);
    manifold.pointCount = 1;
    copyVec2(manifold.points[0].localPoint, circleB.m_p);
    manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
  };
  Contact.addType(EdgeShape.TYPE, CircleShape.TYPE, EdgeCircleContact);
  Contact.addType(ChainShape.TYPE, CircleShape.TYPE, ChainCircleContact);
  function EdgeCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    var shapeA = fixtureA.getShape();
    var shapeB = fixtureB.getShape();
    CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);
  }
  function ChainCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    var chain = fixtureA.getShape();
    var edge = new EdgeShape();
    chain.getChildEdge(edge, indexA);
    var shapeA = edge;
    var shapeB = fixtureB.getShape();
    CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);
  }
  var e = vec2(0, 0);
  var e1 = vec2(0, 0);
  var e2 = vec2(0, 0);
  var Q = vec2(0, 0);
  var P = vec2(0, 0);
  var n$2 = vec2(0, 0);
  var CollideEdgeCircle = function(manifold, edgeA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    retransformVec2(Q, xfB2, xfA2, circleB.m_p);
    var A = edgeA.m_vertex1;
    var B = edgeA.m_vertex2;
    subVec2(e, B, A);
    var u = dotVec2(e, B) - dotVec2(e, Q);
    var v3 = dotVec2(e, Q) - dotVec2(e, A);
    var radius = edgeA.m_radius + circleB.m_radius;
    if (v3 <= 0) {
      copyVec2(P, A);
      var dd_1 = distSqrVec2(Q, A);
      if (dd_1 > radius * radius) {
        return;
      }
      if (edgeA.m_hasVertex0) {
        var A1 = edgeA.m_vertex0;
        var B1 = A;
        subVec2(e1, B1, A1);
        var u1 = dotVec2(e1, B1) - dotVec2(e1, Q);
        if (u1 > 0) {
          return;
        }
      }
      manifold.type = exports2.ManifoldType.e_circles;
      zeroVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, P);
      manifold.pointCount = 1;
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    if (u <= 0) {
      copyVec2(P, B);
      var dd_2 = distSqrVec2(Q, P);
      if (dd_2 > radius * radius) {
        return;
      }
      if (edgeA.m_hasVertex3) {
        var B2 = edgeA.m_vertex3;
        var A2 = B;
        subVec2(e2, B2, A2);
        var v22 = dotVec2(e2, Q) - dotVec2(e2, A2);
        if (v22 > 0) {
          return;
        }
      }
      manifold.type = exports2.ManifoldType.e_circles;
      zeroVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, P);
      manifold.pointCount = 1;
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(1, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    var den = lengthSqrVec2(e);
    combine2Vec2(P, u / den, A, v3 / den, B);
    var dd = distSqrVec2(Q, P);
    if (dd > radius * radius) {
      return;
    }
    crossNumVec2(n$2, 1, e);
    if (dotVec2(n$2, Q) - dotVec2(n$2, A) < 0) {
      negVec2(n$2);
    }
    normalizeVec2(n$2);
    manifold.type = exports2.ManifoldType.e_faceA;
    copyVec2(manifold.localNormal, n$2);
    copyVec2(manifold.localPoint, A);
    manifold.pointCount = 1;
    copyVec2(manifold.points[0].localPoint, circleB.m_p);
    manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_face, 0, exports2.ContactFeatureType.e_vertex);
  };
  var incidentEdge = [new ClipVertex(), new ClipVertex()];
  var clipPoints1$1 = [new ClipVertex(), new ClipVertex()];
  var clipPoints2$1 = [new ClipVertex(), new ClipVertex()];
  var clipSegmentToLineNormal = vec2(0, 0);
  var v1 = vec2(0, 0);
  var n$1 = vec2(0, 0);
  var xf$1 = transform(0, 0, 0);
  var v11 = vec2(0, 0);
  var v12 = vec2(0, 0);
  var localTangent = vec2(0, 0);
  var localNormal = vec2(0, 0);
  var planePoint = vec2(0, 0);
  var tangent = vec2(0, 0);
  var normal$1 = vec2(0, 0);
  var normal1$1 = vec2(0, 0);
  Contact.addType(PolygonShape.TYPE, PolygonShape.TYPE, PolygonContact);
  function PolygonContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollidePolygons(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  function findMaxSeparation(poly1, xf1, poly2, xf2, output2) {
    var count1 = poly1.m_count;
    var count2 = poly2.m_count;
    var n1s = poly1.m_normals;
    var v1s = poly1.m_vertices;
    var v2s = poly2.m_vertices;
    detransformTransform(xf$1, xf2, xf1);
    var bestIndex = 0;
    var maxSeparation2 = -Infinity;
    for (var i = 0; i < count1; ++i) {
      rotVec2(n$1, xf$1.q, n1s[i]);
      transformVec2(v1, xf$1, v1s[i]);
      var si = Infinity;
      for (var j = 0; j < count2; ++j) {
        var sij = dotVec2(n$1, v2s[j]) - dotVec2(n$1, v1);
        if (sij < si) {
          si = sij;
        }
      }
      if (si > maxSeparation2) {
        maxSeparation2 = si;
        bestIndex = i;
      }
    }
    output2.maxSeparation = maxSeparation2;
    output2.bestIndex = bestIndex;
  }
  function findIncidentEdge(clipVertex, poly1, xf1, edge12, poly2, xf2) {
    var normals1 = poly1.m_normals;
    var count2 = poly2.m_count;
    var vertices2 = poly2.m_vertices;
    var normals2 = poly2.m_normals;
    rerotVec2(normal1$1, xf2.q, xf1.q, normals1[edge12]);
    var index = 0;
    var minDot = Infinity;
    for (var i = 0; i < count2; ++i) {
      var dot = dotVec2(normal1$1, normals2[i]);
      if (dot < minDot) {
        minDot = dot;
        index = i;
      }
    }
    var i1 = index;
    var i2 = i1 + 1 < count2 ? i1 + 1 : 0;
    transformVec2(clipVertex[0].v, xf2, vertices2[i1]);
    clipVertex[0].id.setFeatures(edge12, exports2.ContactFeatureType.e_face, i1, exports2.ContactFeatureType.e_vertex);
    transformVec2(clipVertex[1].v, xf2, vertices2[i2]);
    clipVertex[1].id.setFeatures(edge12, exports2.ContactFeatureType.e_face, i2, exports2.ContactFeatureType.e_vertex);
  }
  var maxSeparation = {
    maxSeparation: 0,
    bestIndex: 0
  };
  var CollidePolygons = function(manifold, polyA, xfA2, polyB, xfB2) {
    manifold.pointCount = 0;
    var totalRadius = polyA.m_radius + polyB.m_radius;
    findMaxSeparation(polyA, xfA2, polyB, xfB2, maxSeparation);
    var edgeA = maxSeparation.bestIndex;
    var separationA = maxSeparation.maxSeparation;
    if (separationA > totalRadius)
      return;
    findMaxSeparation(polyB, xfB2, polyA, xfA2, maxSeparation);
    var edgeB = maxSeparation.bestIndex;
    var separationB = maxSeparation.maxSeparation;
    if (separationB > totalRadius)
      return;
    var poly1;
    var poly2;
    var xf1;
    var xf2;
    var edge12;
    var flip;
    var k_tol = 0.1 * SettingsInternal.linearSlop;
    if (separationB > separationA + k_tol) {
      poly1 = polyB;
      poly2 = polyA;
      xf1 = xfB2;
      xf2 = xfA2;
      edge12 = edgeB;
      manifold.type = exports2.ManifoldType.e_faceB;
      flip = true;
    } else {
      poly1 = polyA;
      poly2 = polyB;
      xf1 = xfA2;
      xf2 = xfB2;
      edge12 = edgeA;
      manifold.type = exports2.ManifoldType.e_faceA;
      flip = false;
    }
    incidentEdge[0].recycle();
    incidentEdge[1].recycle();
    findIncidentEdge(incidentEdge, poly1, xf1, edge12, poly2, xf2);
    var count1 = poly1.m_count;
    var vertices1 = poly1.m_vertices;
    var iv1 = edge12;
    var iv2 = edge12 + 1 < count1 ? edge12 + 1 : 0;
    copyVec2(v11, vertices1[iv1]);
    copyVec2(v12, vertices1[iv2]);
    subVec2(localTangent, v12, v11);
    normalizeVec2(localTangent);
    crossVec2Num(localNormal, localTangent, 1);
    combine2Vec2(planePoint, 0.5, v11, 0.5, v12);
    rotVec2(tangent, xf1.q, localTangent);
    crossVec2Num(normal$1, tangent, 1);
    transformVec2(v11, xf1, v11);
    transformVec2(v12, xf1, v12);
    var frontOffset = dotVec2(normal$1, v11);
    var sideOffset1 = -dotVec2(tangent, v11) + totalRadius;
    var sideOffset2 = dotVec2(tangent, v12) + totalRadius;
    clipPoints1$1[0].recycle();
    clipPoints1$1[1].recycle();
    clipPoints2$1[0].recycle();
    clipPoints2$1[1].recycle();
    setVec2(clipSegmentToLineNormal, -tangent.x, -tangent.y);
    var np1 = clipSegmentToLine(clipPoints1$1, incidentEdge, clipSegmentToLineNormal, sideOffset1, iv1);
    if (np1 < 2) {
      return;
    }
    setVec2(clipSegmentToLineNormal, tangent.x, tangent.y);
    var np2 = clipSegmentToLine(clipPoints2$1, clipPoints1$1, clipSegmentToLineNormal, sideOffset2, iv2);
    if (np2 < 2) {
      return;
    }
    copyVec2(manifold.localNormal, localNormal);
    copyVec2(manifold.localPoint, planePoint);
    var pointCount = 0;
    for (var i = 0; i < clipPoints2$1.length; ++i) {
      var separation = dotVec2(normal$1, clipPoints2$1[i].v) - frontOffset;
      if (separation <= totalRadius) {
        var cp = manifold.points[pointCount];
        detransformVec2(cp.localPoint, xf2, clipPoints2$1[i].v);
        cp.id.set(clipPoints2$1[i].id);
        if (flip) {
          cp.id.swapFeatures();
        }
        ++pointCount;
      }
    }
    manifold.pointCount = pointCount;
  };
  Contact.addType(PolygonShape.TYPE, CircleShape.TYPE, PolygonCircleContact);
  function PolygonCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollidePolygonCircle(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  var cLocal = vec2(0, 0);
  var faceCenter = vec2(0, 0);
  var CollidePolygonCircle = function(manifold, polygonA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    retransformVec2(cLocal, xfB2, xfA2, circleB.m_p);
    var normalIndex = 0;
    var separation = -Infinity;
    var radius = polygonA.m_radius + circleB.m_radius;
    var vertexCount = polygonA.m_count;
    var vertices = polygonA.m_vertices;
    var normals = polygonA.m_normals;
    for (var i = 0; i < vertexCount; ++i) {
      var s2 = dotVec2(normals[i], cLocal) - dotVec2(normals[i], vertices[i]);
      if (s2 > radius) {
        return;
      }
      if (s2 > separation) {
        separation = s2;
        normalIndex = i;
      }
    }
    var vertIndex1 = normalIndex;
    var vertIndex2 = vertIndex1 + 1 < vertexCount ? vertIndex1 + 1 : 0;
    var v13 = vertices[vertIndex1];
    var v22 = vertices[vertIndex2];
    if (separation < EPSILON) {
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      copyVec2(manifold.localNormal, normals[normalIndex]);
      combine2Vec2(manifold.localPoint, 0.5, v13, 0.5, v22);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    var u1 = dotVec2(cLocal, v22) - dotVec2(cLocal, v13) - dotVec2(v13, v22) + dotVec2(v13, v13);
    var u2 = dotVec2(cLocal, v13) - dotVec2(cLocal, v22) - dotVec2(v22, v13) + dotVec2(v22, v22);
    if (u1 <= 0) {
      if (distSqrVec2(cLocal, v13) > radius * radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      subVec2(manifold.localNormal, cLocal, v13);
      normalizeVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, v13);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    } else if (u2 <= 0) {
      if (distSqrVec2(cLocal, v22) > radius * radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      subVec2(manifold.localNormal, cLocal, v22);
      normalizeVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, v22);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    } else {
      combine2Vec2(faceCenter, 0.5, v13, 0.5, v22);
      var separation_1 = dotVec2(cLocal, normals[vertIndex1]) - dotVec2(faceCenter, normals[vertIndex1]);
      if (separation_1 > radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      copyVec2(manifold.localNormal, normals[vertIndex1]);
      copyVec2(manifold.localPoint, faceCenter);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    }
  };
  var math_min = Math.min;
  Contact.addType(EdgeShape.TYPE, PolygonShape.TYPE, EdgePolygonContact);
  Contact.addType(ChainShape.TYPE, PolygonShape.TYPE, ChainPolygonContact);
  function EdgePolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {
    CollideEdgePolygon(manifold, fA.getShape(), xfA2, fB.getShape(), xfB2);
  }
  var edge_reuse = new EdgeShape();
  function ChainPolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {
    var chain = fA.getShape();
    chain.getChildEdge(edge_reuse, indexA);
    CollideEdgePolygon(manifold, edge_reuse, xfA2, fB.getShape(), xfB2);
  }
  var EPAxisType;
  (function(EPAxisType2) {
    EPAxisType2[EPAxisType2["e_unknown"] = -1] = "e_unknown";
    EPAxisType2[EPAxisType2["e_edgeA"] = 1] = "e_edgeA";
    EPAxisType2[EPAxisType2["e_edgeB"] = 2] = "e_edgeB";
  })(EPAxisType || (EPAxisType = {}));
  var VertexType;
  (function(VertexType2) {
    VertexType2[VertexType2["e_isolated"] = 0] = "e_isolated";
    VertexType2[VertexType2["e_concave"] = 1] = "e_concave";
    VertexType2[VertexType2["e_convex"] = 2] = "e_convex";
  })(VertexType || (VertexType = {}));
  var EPAxis = (
    /** @class */
    /* @__PURE__ */ function() {
      function EPAxis2() {
      }
      return EPAxis2;
    }()
  );
  var TempPolygon = (
    /** @class */
    /* @__PURE__ */ function() {
      function TempPolygon2() {
        this.vertices = [];
        this.normals = [];
        this.count = 0;
        for (var i = 0; i < SettingsInternal.maxPolygonVertices; i++) {
          this.vertices.push(vec2(0, 0));
          this.normals.push(vec2(0, 0));
        }
      }
      return TempPolygon2;
    }()
  );
  var ReferenceFace = (
    /** @class */
    function() {
      function ReferenceFace2() {
        this.v1 = vec2(0, 0);
        this.v2 = vec2(0, 0);
        this.normal = vec2(0, 0);
        this.sideNormal1 = vec2(0, 0);
        this.sideNormal2 = vec2(0, 0);
      }
      ReferenceFace2.prototype.recycle = function() {
        zeroVec2(this.v1);
        zeroVec2(this.v2);
        zeroVec2(this.normal);
        zeroVec2(this.sideNormal1);
        zeroVec2(this.sideNormal2);
      };
      return ReferenceFace2;
    }()
  );
  var clipPoints1 = [new ClipVertex(), new ClipVertex()];
  var clipPoints2 = [new ClipVertex(), new ClipVertex()];
  var ie = [new ClipVertex(), new ClipVertex()];
  var edgeAxis = new EPAxis();
  var polygonAxis = new EPAxis();
  var polygonBA = new TempPolygon();
  var rf = new ReferenceFace();
  var centroidB = vec2(0, 0);
  var edge0 = vec2(0, 0);
  var edge1 = vec2(0, 0);
  var edge2 = vec2(0, 0);
  var xf = transform(0, 0, 0);
  var normal = vec2(0, 0);
  var normal0 = vec2(0, 0);
  var normal1 = vec2(0, 0);
  var normal2 = vec2(0, 0);
  var lowerLimit = vec2(0, 0);
  var upperLimit = vec2(0, 0);
  var perp = vec2(0, 0);
  var n = vec2(0, 0);
  var CollideEdgePolygon = function(manifold, edgeA, xfA2, polygonB, xfB2) {
    detransformTransform(xf, xfA2, xfB2);
    transformVec2(centroidB, xf, polygonB.m_centroid);
    var v0 = edgeA.m_vertex0;
    var v13 = edgeA.m_vertex1;
    var v22 = edgeA.m_vertex2;
    var v3 = edgeA.m_vertex3;
    var hasVertex0 = edgeA.m_hasVertex0;
    var hasVertex3 = edgeA.m_hasVertex3;
    subVec2(edge1, v22, v13);
    normalizeVec2(edge1);
    setVec2(normal1, edge1.y, -edge1.x);
    var offset1 = dotVec2(normal1, centroidB) - dotVec2(normal1, v13);
    var offset0 = 0;
    var offset2 = 0;
    var convex1 = false;
    var convex2 = false;
    zeroVec2(normal0);
    zeroVec2(normal2);
    if (hasVertex0) {
      subVec2(edge0, v13, v0);
      normalizeVec2(edge0);
      setVec2(normal0, edge0.y, -edge0.x);
      convex1 = crossVec2Vec2(edge0, edge1) >= 0;
      offset0 = Vec2.dot(normal0, centroidB) - Vec2.dot(normal0, v0);
    }
    if (hasVertex3) {
      subVec2(edge2, v3, v22);
      normalizeVec2(edge2);
      setVec2(normal2, edge2.y, -edge2.x);
      convex2 = Vec2.crossVec2Vec2(edge1, edge2) > 0;
      offset2 = Vec2.dot(normal2, centroidB) - Vec2.dot(normal2, v22);
    }
    var front;
    zeroVec2(normal);
    zeroVec2(lowerLimit);
    zeroVec2(upperLimit);
    if (hasVertex0 && hasVertex3) {
      if (convex1 && convex2) {
        front = offset0 >= 0 || offset1 >= 0 || offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else if (convex1) {
        front = offset0 >= 0 || offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else if (convex2) {
        front = offset2 >= 0 || offset0 >= 0 && offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          scaleVec2(upperLimit, -1, normal0);
        }
      } else {
        front = offset0 >= 0 && offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          scaleVec2(upperLimit, -1, normal0);
        }
      }
    } else if (hasVertex0) {
      if (convex1) {
        front = offset0 >= 0 || offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          scaleVec2(upperLimit, -1, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else {
        front = offset0 >= 0 && offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal0);
        }
      }
    } else if (hasVertex3) {
      if (convex2) {
        front = offset1 >= 0 || offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal1);
        }
      } else {
        front = offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          copyVec2(upperLimit, normal1);
        }
      }
    } else {
      front = offset1 >= 0;
      if (front) {
        copyVec2(normal, normal1);
        scaleVec2(lowerLimit, -1, normal1);
        scaleVec2(upperLimit, -1, normal1);
      } else {
        scaleVec2(normal, -1, normal1);
        copyVec2(lowerLimit, normal1);
        copyVec2(upperLimit, normal1);
      }
    }
    polygonBA.count = polygonB.m_count;
    for (var i = 0; i < polygonB.m_count; ++i) {
      transformVec2(polygonBA.vertices[i], xf, polygonB.m_vertices[i]);
      rotVec2(polygonBA.normals[i], xf.q, polygonB.m_normals[i]);
    }
    var radius = polygonB.m_radius + edgeA.m_radius;
    manifold.pointCount = 0;
    {
      edgeAxis.type = EPAxisType.e_edgeA;
      edgeAxis.index = front ? 0 : 1;
      edgeAxis.separation = Infinity;
      for (var i = 0; i < polygonBA.count; ++i) {
        var v4 = polygonBA.vertices[i];
        var s2 = dotVec2(normal, v4) - dotVec2(normal, v13);
        if (s2 < edgeAxis.separation) {
          edgeAxis.separation = s2;
        }
      }
    }
    if (edgeAxis.type == EPAxisType.e_unknown) {
      return;
    }
    if (edgeAxis.separation > radius) {
      return;
    }
    {
      polygonAxis.type = EPAxisType.e_unknown;
      polygonAxis.index = -1;
      polygonAxis.separation = -Infinity;
      setVec2(perp, -normal.y, normal.x);
      for (var i = 0; i < polygonBA.count; ++i) {
        scaleVec2(n, -1, polygonBA.normals[i]);
        var s1 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v13);
        var s22 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v22);
        var s2 = math_min(s1, s22);
        if (s2 > radius) {
          polygonAxis.type = EPAxisType.e_edgeB;
          polygonAxis.index = i;
          polygonAxis.separation = s2;
          break;
        }
        if (dotVec2(n, perp) >= 0) {
          if (dotVec2(n, normal) - dotVec2(upperLimit, normal) < -SettingsInternal.angularSlop) {
            continue;
          }
        } else {
          if (dotVec2(n, normal) - dotVec2(lowerLimit, normal) < -SettingsInternal.angularSlop) {
            continue;
          }
        }
        if (s2 > polygonAxis.separation) {
          polygonAxis.type = EPAxisType.e_edgeB;
          polygonAxis.index = i;
          polygonAxis.separation = s2;
        }
      }
    }
    if (polygonAxis.type != EPAxisType.e_unknown && polygonAxis.separation > radius) {
      return;
    }
    var k_relativeTol = 0.98;
    var k_absoluteTol = 1e-3;
    var primaryAxis;
    if (polygonAxis.type == EPAxisType.e_unknown) {
      primaryAxis = edgeAxis;
    } else if (polygonAxis.separation > k_relativeTol * edgeAxis.separation + k_absoluteTol) {
      primaryAxis = polygonAxis;
    } else {
      primaryAxis = edgeAxis;
    }
    ie[0].recycle();
    ie[1].recycle();
    if (primaryAxis.type == EPAxisType.e_edgeA) {
      manifold.type = exports2.ManifoldType.e_faceA;
      var bestIndex = 0;
      var bestValue = dotVec2(normal, polygonBA.normals[0]);
      for (var i = 1; i < polygonBA.count; ++i) {
        var value = dotVec2(normal, polygonBA.normals[i]);
        if (value < bestValue) {
          bestValue = value;
          bestIndex = i;
        }
      }
      var i1 = bestIndex;
      var i2 = i1 + 1 < polygonBA.count ? i1 + 1 : 0;
      copyVec2(ie[0].v, polygonBA.vertices[i1]);
      ie[0].id.setFeatures(0, exports2.ContactFeatureType.e_face, i1, exports2.ContactFeatureType.e_vertex);
      copyVec2(ie[1].v, polygonBA.vertices[i2]);
      ie[1].id.setFeatures(0, exports2.ContactFeatureType.e_face, i2, exports2.ContactFeatureType.e_vertex);
      if (front) {
        rf.i1 = 0;
        rf.i2 = 1;
        copyVec2(rf.v1, v13);
        copyVec2(rf.v2, v22);
        copyVec2(rf.normal, normal1);
      } else {
        rf.i1 = 1;
        rf.i2 = 0;
        copyVec2(rf.v1, v22);
        copyVec2(rf.v2, v13);
        scaleVec2(rf.normal, -1, normal1);
      }
    } else {
      manifold.type = exports2.ManifoldType.e_faceB;
      copyVec2(ie[0].v, v13);
      ie[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, primaryAxis.index, exports2.ContactFeatureType.e_face);
      copyVec2(ie[1].v, v22);
      ie[1].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, primaryAxis.index, exports2.ContactFeatureType.e_face);
      rf.i1 = primaryAxis.index;
      rf.i2 = rf.i1 + 1 < polygonBA.count ? rf.i1 + 1 : 0;
      copyVec2(rf.v1, polygonBA.vertices[rf.i1]);
      copyVec2(rf.v2, polygonBA.vertices[rf.i2]);
      copyVec2(rf.normal, polygonBA.normals[rf.i1]);
    }
    setVec2(rf.sideNormal1, rf.normal.y, -rf.normal.x);
    setVec2(rf.sideNormal2, -rf.sideNormal1.x, -rf.sideNormal1.y);
    rf.sideOffset1 = dotVec2(rf.sideNormal1, rf.v1);
    rf.sideOffset2 = dotVec2(rf.sideNormal2, rf.v2);
    clipPoints1[0].recycle();
    clipPoints1[1].recycle();
    clipPoints2[0].recycle();
    clipPoints2[1].recycle();
    var np1 = clipSegmentToLine(clipPoints1, ie, rf.sideNormal1, rf.sideOffset1, rf.i1);
    if (np1 < SettingsInternal.maxManifoldPoints) {
      return;
    }
    var np2 = clipSegmentToLine(clipPoints2, clipPoints1, rf.sideNormal2, rf.sideOffset2, rf.i2);
    if (np2 < SettingsInternal.maxManifoldPoints) {
      return;
    }
    if (primaryAxis.type == EPAxisType.e_edgeA) {
      copyVec2(manifold.localNormal, rf.normal);
      copyVec2(manifold.localPoint, rf.v1);
    } else {
      copyVec2(manifold.localNormal, polygonB.m_normals[rf.i1]);
      copyVec2(manifold.localPoint, polygonB.m_vertices[rf.i1]);
    }
    var pointCount = 0;
    for (var i = 0; i < SettingsInternal.maxManifoldPoints; ++i) {
      var separation = dotVec2(rf.normal, clipPoints2[i].v) - dotVec2(rf.normal, rf.v1);
      if (separation <= radius) {
        var cp = manifold.points[pointCount];
        if (primaryAxis.type == EPAxisType.e_edgeA) {
          detransformVec2(cp.localPoint, xf, clipPoints2[i].v);
          cp.id.set(clipPoints2[i].id);
        } else {
          copyVec2(cp.localPoint, clipPoints2[i].v);
          cp.id.set(clipPoints2[i].id);
          cp.id.swapFeatures();
        }
        ++pointCount;
      }
    }
    manifold.pointCount = pointCount;
  };
  var internal = {
    CollidePolygons,
    Settings,
    Sweep,
    Manifold,
    Distance,
    TimeOfImpact,
    DynamicTree,
    stats
  };
  var DataDriver = (
    /** @class */
    function() {
      function DataDriver2(key, listener) {
        this._refMap = {};
        this._map = {};
        this._xmap = {};
        this._data = [];
        this._entered = [];
        this._exited = [];
        this._key = key;
        this._listener = listener;
      }
      DataDriver2.prototype.update = function(data) {
        if (!Array.isArray(data))
          throw "Invalid data: " + data;
        this._entered.length = 0;
        this._exited.length = 0;
        this._data.length = data.length;
        for (var i = 0; i < data.length; i++) {
          if (typeof data[i] !== "object" || data[i] === null)
            continue;
          var d2 = data[i];
          var id = this._key(d2);
          if (!this._map[id]) {
            this._entered.push(d2);
          } else {
            delete this._map[id];
          }
          this._data[i] = d2;
          this._xmap[id] = d2;
        }
        for (var id in this._map) {
          this._exited.push(this._map[id]);
          delete this._map[id];
        }
        var temp3 = this._map;
        this._map = this._xmap;
        this._xmap = temp3;
        for (var i = 0; i < this._exited.length; i++) {
          var d2 = this._exited[i];
          var key = this._key(d2);
          var ref = this._refMap[key];
          this._listener.exit(d2, ref);
          delete this._refMap[key];
        }
        for (var i = 0; i < this._entered.length; i++) {
          var d2 = this._entered[i];
          var key = this._key(d2);
          var ref = this._listener.enter(d2);
          if (ref) {
            this._refMap[key] = ref;
          }
        }
        for (var i = 0; i < this._data.length; i++) {
          if (typeof data[i] !== "object" || data[i] === null)
            continue;
          var d2 = this._data[i];
          var key = this._key(d2);
          var ref = this._refMap[key];
          this._listener.update(d2, ref);
        }
        this._entered.length = 0;
        this._exited.length = 0;
        this._data.length = 0;
      };
      DataDriver2.prototype.ref = function(d2) {
        return this._refMap[this._key(d2)];
      };
      return DataDriver2;
    }()
  );
  const planck = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
    __proto__: null,
    AABB,
    Body,
    Box: BoxShape,
    BoxShape,
    BroadPhase,
    Chain: ChainShape,
    ChainShape,
    Circle: CircleShape,
    CircleShape,
    ClipVertex,
    CollideCircles,
    CollideEdgeCircle,
    CollideEdgePolygon,
    CollidePolygonCircle,
    CollidePolygons,
    Contact,
    ContactEdge,
    get ContactFeatureType() {
      return exports2.ContactFeatureType;
    },
    ContactID,
    ContactImpulse,
    DataDriver,
    Distance,
    DistanceInput,
    DistanceJoint,
    DistanceOutput,
    DistanceProxy,
    DynamicTree,
    Edge: EdgeShape,
    EdgeShape,
    Fixture,
    FixtureProxy,
    FrictionJoint,
    GearJoint,
    Joint,
    JointEdge,
    Manifold,
    ManifoldPoint,
    get ManifoldType() {
      return exports2.ManifoldType;
    },
    Mat22,
    Mat33,
    Math: math,
    MotorJoint,
    MouseJoint,
    get PointState() {
      return exports2.PointState;
    },
    Polygon: PolygonShape,
    PolygonShape,
    PrismaticJoint,
    PulleyJoint,
    RevoluteJoint,
    RopeJoint,
    Rot,
    Serializer,
    Settings,
    SettingsInternal,
    Shape,
    ShapeCast,
    ShapeCastInput,
    ShapeCastOutput,
    SimplexCache,
    Solver,
    Sweep,
    TOIInput,
    TOIOutput,
    get TOIOutputState() {
      return exports2.TOIOutputState;
    },
    Testbed,
    TimeOfImpact,
    TimeStep,
    Transform,
    TreeNode,
    Vec2,
    Vec3,
    VelocityConstraintPoint,
    WeldJoint,
    WheelJoint,
    World,
    WorldManifold,
    clipSegmentToLine,
    getPointStates,
    internal,
    mixFriction,
    mixRestitution,
    stats,
    testOverlap,
    testbed
  }, Symbol.toStringTag, { value: "Module" }));
  exports2.AABB = AABB;
  exports2.Body = Body;
  exports2.Box = BoxShape;
  exports2.BoxShape = BoxShape;
  exports2.BroadPhase = BroadPhase;
  exports2.Chain = ChainShape;
  exports2.ChainShape = ChainShape;
  exports2.Circle = CircleShape;
  exports2.CircleShape = CircleShape;
  exports2.ClipVertex = ClipVertex;
  exports2.CollideCircles = CollideCircles;
  exports2.CollideEdgeCircle = CollideEdgeCircle;
  exports2.CollideEdgePolygon = CollideEdgePolygon;
  exports2.CollidePolygonCircle = CollidePolygonCircle;
  exports2.CollidePolygons = CollidePolygons;
  exports2.Contact = Contact;
  exports2.ContactEdge = ContactEdge;
  exports2.ContactID = ContactID;
  exports2.ContactImpulse = ContactImpulse;
  exports2.DataDriver = DataDriver;
  exports2.Distance = Distance;
  exports2.DistanceInput = DistanceInput;
  exports2.DistanceJoint = DistanceJoint;
  exports2.DistanceOutput = DistanceOutput;
  exports2.DistanceProxy = DistanceProxy;
  exports2.DynamicTree = DynamicTree;
  exports2.Edge = EdgeShape;
  exports2.EdgeShape = EdgeShape;
  exports2.Fixture = Fixture;
  exports2.FixtureProxy = FixtureProxy;
  exports2.FrictionJoint = FrictionJoint;
  exports2.GearJoint = GearJoint;
  exports2.Joint = Joint;
  exports2.JointEdge = JointEdge;
  exports2.Manifold = Manifold;
  exports2.ManifoldPoint = ManifoldPoint;
  exports2.Mat22 = Mat22;
  exports2.Mat33 = Mat33;
  exports2.Math = math;
  exports2.MotorJoint = MotorJoint;
  exports2.MouseJoint = MouseJoint;
  exports2.Polygon = PolygonShape;
  exports2.PolygonShape = PolygonShape;
  exports2.PrismaticJoint = PrismaticJoint;
  exports2.PulleyJoint = PulleyJoint;
  exports2.RevoluteJoint = RevoluteJoint;
  exports2.RopeJoint = RopeJoint;
  exports2.Rot = Rot;
  exports2.Serializer = Serializer;
  exports2.Settings = Settings;
  exports2.SettingsInternal = SettingsInternal;
  exports2.Shape = Shape;
  exports2.ShapeCast = ShapeCast;
  exports2.ShapeCastInput = ShapeCastInput;
  exports2.ShapeCastOutput = ShapeCastOutput;
  exports2.SimplexCache = SimplexCache;
  exports2.Solver = Solver;
  exports2.Sweep = Sweep;
  exports2.TOIInput = TOIInput;
  exports2.TOIOutput = TOIOutput;
  exports2.Testbed = Testbed;
  exports2.TimeOfImpact = TimeOfImpact;
  exports2.TimeStep = TimeStep;
  exports2.Transform = Transform;
  exports2.TreeNode = TreeNode;
  exports2.Vec2 = Vec2;
  exports2.Vec3 = Vec3;
  exports2.VelocityConstraintPoint = VelocityConstraintPoint;
  exports2.WeldJoint = WeldJoint;
  exports2.WheelJoint = WheelJoint;
  exports2.World = World;
  exports2.WorldManifold = WorldManifold;
  exports2.clipSegmentToLine = clipSegmentToLine;
  exports2.default = planck;
  exports2.getPointStates = getPointStates;
  exports2.internal = internal;
  exports2.mixFriction = mixFriction;
  exports2.mixRestitution = mixRestitution;
  exports2.stats = stats;
  exports2.testOverlap = testOverlap;
  exports2.testbed = testbed;
  Object.defineProperties(exports2, { __esModule: { value: true }, [Symbol.toStringTag]: { value: "Module" } });
});
//# sourceMappingURL=planck.js.map


/***/ }),

/***/ "./src/core/asset-loader.ts":
/*!**********************************!*\
  !*** ./src/core/asset-loader.ts ***!
  \**********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.AssetLoader = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const event_system_1 = __webpack_require__(/*! ./event-system */ "./src/core/event-system.ts");
class AssetLoader {
    PIXIAssets = pixi_js_1.default.Assets;
    textures = [];
    isLoading = false;
    events = new event_system_1.EventEmitter();
    on(event, listener) {
        this.events.on(event, listener);
    }
    off(event, listener) {
        this.events.off(event, listener);
    }
    loadAssets = async (assets) => {
        const { PIXIAssets } = this;
        this.isLoading = true;
        this.events.emit('loading:start');
        try {
            for (let i = 0; i < assets.length; i++) {
                const { src, alias } = assets[i];
                if (alias) {
                    if (!PIXIAssets.cache.has(alias)) {
                        const texture = await PIXIAssets.load({ alias, src });
                        this.textures.push(texture);
                    }
                }
                else {
                    const texture = await PIXIAssets.load(src);
                    this.textures.push(texture);
                }
            }
            return this;
        }
        finally {
            this.isLoading = false;
            this.events.emit('loading:end');
        }
    };
}
exports.AssetLoader = AssetLoader;


/***/ }),

/***/ "./src/core/camera.ts":
/*!****************************!*\
  !*** ./src/core/camera.ts ***!
  \****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Camera = exports.CameraLogic = void 0;
const pixi_js_1 = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const logic_1 = __webpack_require__(/*! ./logic */ "./src/core/logic.ts");
const moxi_entity_1 = __webpack_require__(/*! ./moxi-entity */ "./src/core/moxi-entity.ts");
const utils_1 = __webpack_require__(/*! ../library/utils */ "./src/library/utils.ts");
class CameraLogic extends logic_1.Logic {
    name = 'CameraLogic';
    speed = 0.1;
    target = null;
    entity;
    renderer;
    init(entity, renderer) {
        this.entity = entity;
        this.renderer = renderer;
    }
    update(entity, deltaTime) {
        const { speed } = this;
        const deltaSpeed = Math.min(deltaTime * speed, 1);
        const isZooming = Math.abs(entity.scale.x - entity.desiredScale.x) > 0.01 ||
            Math.abs(entity.scale.y - entity.desiredScale.y) > 0.01;
        if (entity.desiredScale !== entity.scale) {
            entity.scale.x = (0, utils_1.lerp)(entity.scale.x, entity.desiredScale.x, deltaSpeed);
            entity.scale.y = (0, utils_1.lerp)(entity.scale.y, entity.desiredScale.y, deltaSpeed);
        }
        if (this.target) {
            const screenCenterX = this.renderer.width / 2;
            const screenCenterY = this.renderer.height / 2;
            const desiredX = -(this.target.position.x * entity.scale.x) + screenCenterX;
            const desiredY = -(this.target.position.y * entity.scale.y) + screenCenterY;
            entity.desiredPosition.set(-desiredX, -desiredY);
        }
        if (entity.desiredPosition !== entity.position) {
            if (isZooming) {
                entity.position.copyFrom(entity.desiredPosition);
            }
            else {
                entity.position.x = (0, utils_1.lerp)(entity.position.x, entity.desiredPosition.x, deltaSpeed);
                entity.position.y = (0, utils_1.lerp)(entity.position.y, entity.desiredPosition.y, deltaSpeed);
            }
        }
        entity.scene.scale.set(entity.scale.x, entity.scale.y);
        entity.scene.position.set(-entity.position.x, -entity.position.y);
    }
}
exports.CameraLogic = CameraLogic;
class Camera extends pixi_js_1.default.Container {
    scene;
    renderer;
    speed = 0.1;
    moxiEntity;
    desiredScale = new pixi_js_1.Point(1, 1);
    desiredPosition = new pixi_js_1.Point(0, 0);
    constructor(scene, renderer, logic = {}) {
        super();
        this.scene = scene;
        this.renderer = renderer;
        const cameraLogic = new CameraLogic();
        cameraLogic.init(this, renderer);
        this.moxiEntity = new moxi_entity_1.MoxiEntity(this, logic);
        this.moxiEntity.addLogic(cameraLogic);
        this.scene.addChild(this);
    }
}
exports.Camera = Camera;


/***/ }),

/***/ "./src/core/engine.ts":
/*!****************************!*\
  !*** ./src/core/engine.ts ***!
  \****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Engine = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
class Engine {
    ticker;
    root;
    physicsWorld;
    logger;
    loggerFrequencyMs;
    nextLogTime;
    constructor(stage = null) {
        this.root = stage;
        const ticker = pixi_js_1.default.Ticker.shared;
        ticker.autoStart = false;
        ticker.add(this.gameLoop);
        this.ticker = ticker;
        this.loggerFrequencyMs = 500;
        this.nextLogTime = 0;
        this.logger = (msg) => null;
    }
    start() {
        this.ticker.start();
        return this;
    }
    stop() {
        this.ticker.stop();
        return this;
    }
    addPhysicsWorld(physicsWorld) {
        this.physicsWorld = physicsWorld;
        return this;
    }
    gameLoop = (tikerTime) => {
        if (this.root) {
            const { deltaTime, deltaMS } = tikerTime;
            if (this.physicsWorld) {
                const deltaSeconds = deltaMS / 1000;
                this.physicsWorld.step(deltaSeconds);
            }
            this.root.update(deltaTime);
            this.root.draw(deltaTime);
        }
    };
    loadStage(stage) {
        this.root = stage;
        return this;
    }
}
exports.Engine = Engine;


/***/ }),

/***/ "./src/core/event-system.ts":
/*!**********************************!*\
  !*** ./src/core/event-system.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.EventEmitter = void 0;
class EventEmitter {
    listeners = {};
    static instance = new EventEmitter();
    on(event, listener) {
        (this.listeners[event] || (this.listeners[event] = [])).push(listener);
    }
    off(event, listener) {
        const eventListeners = this.listeners[event];
        if (eventListeners) {
            this.listeners[event] = eventListeners.filter(l => l !== listener);
        }
    }
    emit(event, ...args) {
        (this.listeners[event] || []).forEach(listener => listener(...args));
    }
    once(event, listener) {
        const onceListener = (...args) => {
            listener(...args);
            this.off(event, listener);
        };
        this.on(event, onceListener);
    }
    static getInstance() {
        if (!EventEmitter.instance) {
            EventEmitter.instance = new EventEmitter();
        }
        return EventEmitter.instance;
    }
}
exports.EventEmitter = EventEmitter;


/***/ }),

/***/ "./src/core/logic.ts":
/*!***************************!*\
  !*** ./src/core/logic.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.InstancedLogic = exports.Logic = void 0;
class Logic {
    name;
    active = true;
    init(entity, renderer, ...args) {
    }
    update(entity, deltaTime) {
    }
}
exports.Logic = Logic;
class InstancedLogic extends Logic {
}
exports.InstancedLogic = InstancedLogic;


/***/ }),

/***/ "./src/core/moxi-entity.ts":
/*!*********************************!*\
  !*** ./src/core/moxi-entity.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.MoxiEntity = void 0;
exports.asEntity = asEntity;
class MoxiEntity {
    logic = {};
    entity;
    constructor(entity, logic = {}) {
        this.logic = logic;
        this.entity = entity;
    }
    update(deltaTime) {
        for (const className in this.logic) {
            const logicComponent = this.logic[className];
            if (logicComponent.update && this.entity && logicComponent.active) {
                logicComponent.update(this.entity, deltaTime);
            }
        }
    }
    init(renderer, ...args) {
        for (const className in this.logic) {
            const logicComponent = this.logic[className];
            if (logicComponent.init && this.entity) {
                logicComponent.init(this.entity, renderer, ...args);
            }
        }
    }
    addLogic(logic) {
        const logicName = logic.name || logic.constructor.name;
        this.logic[logicName] = logic;
    }
    getLogic(name) {
        return this.logic[name];
    }
}
exports.MoxiEntity = MoxiEntity;
function asEntity(entity, logic = {}) {
    const target = entity;
    target.isInteractive = () => false;
    target.moxiEntity = new MoxiEntity(target, logic);
    return entity;
}


/***/ }),

/***/ "./src/core/render-manager.ts":
/*!************************************!*\
  !*** ./src/core/render-manager.ts ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.RenderManager = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
class RenderManager {
    static getRenderer;
    static create;
    htmlRoot;
    renderer;
    fitToWindow = false;
    constructor(htmlRoot, renderer) {
        this.htmlRoot = htmlRoot;
        this.renderer = renderer;
        htmlRoot.appendChild(this.renderer.canvas);
        window.addEventListener('resize', () => this.onResize());
        this.onResize();
    }
    render(stage) {
        this.renderer.render(stage);
    }
    onResize = () => {
        const { renderer, htmlRoot: root } = this;
        const canvas = renderer.canvas;
        const parentWidth = root.clientWidth;
        const parentHeight = root.clientHeight;
        const canvasWidth = renderer.width;
        const canvasHeight = renderer.height;
        const scale = Math.min(parentWidth / canvasWidth, parentHeight / canvasHeight);
        canvas.style.width = `${Math.floor(canvasWidth * scale)}px`;
        canvas.style.height = `${Math.floor(canvasHeight * scale)}px`;
    };
}
exports.RenderManager = RenderManager;
RenderManager.getRenderer = async (options) => (await pixi_js_1.default.autoDetectRenderer(options));
RenderManager.create = async (htmlRoot, options) => (new RenderManager(htmlRoot, await RenderManager.getRenderer(options)));


/***/ }),

/***/ "./src/core/scene.ts":
/*!***************************!*\
  !*** ./src/core/scene.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Scene = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function isMoxiEntity(entity) {
    return entity != null && typeof entity === 'object' && 'moxiEntity' in entity;
}
class Scene extends pixi_js_1.default.Container {
    renderer;
    constructor(renderer) {
        super();
        this.renderer = renderer;
    }
    init() {
        this.children.forEach((child) => {
            if (isMoxiEntity(child)) {
                child.moxiEntity.init(this.renderer);
            }
        });
    }
    update(deltaTime) {
        this.children.forEach((child) => {
            if (isMoxiEntity(child)) {
                child.moxiEntity.update(deltaTime);
            }
        });
    }
    draw(deltaTime) {
        this.renderer.render(this);
    }
}
exports.Scene = Scene;


/***/ }),

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.FlexJustify = exports.FlexDirection = exports.FlexContainer = exports.UIFocusManager = exports.UIComponent = exports.EdgeInsets = exports.applyMaterial = exports.PhysicsMaterials = exports.createShapeFromSprite = exports.getPhysicsBody = exports.hasPhysics = exports.asPhysicsEntity = exports.CollisionManager = exports.CollisionRegistry = exports.PhysicsDebugRenderer = exports.PhysicsBodyLogic = exports.PhysicsWorld = exports.StateLogic = exports.StateMachine = exports.utils = exports.TilingParallaxLayer = exports.TextureFrameSequences = exports.setupResponsiveCanvas = exports.Scene = exports.RenderManager = exports.setupMoxi = exports.LoadingScene = exports.ParallaxLayer = exports.ParallaxBackgroundLogic = exports.ParallaxBackground = exports.MoxiEntity = exports.loadFonts = exports.getTextureRange = exports.EventEmitter = exports.Engine = exports.defaultRenderOptions = exports.createTileGrid = exports.createResizeHandler = exports.ClientEvents = exports.CameraLogic = exports.Camera = exports.Logic = exports.asContainer = exports.asGraphics = exports.asText = exports.asSprite = exports.asBitmapText = exports.asTextureFrames = exports.asEntity = exports.AssetLoader = void 0;
exports.createBorderConfig = exports.BORDER = exports.GRID = exports.units = exports.px = exports.PixelGrid = exports.svgToTexture = exports.UIScaleMode = exports.UILayer = exports.UITabs = exports.UIScrollContainer = exports.UITextArea = exports.UITextInput = exports.UISelect = exports.ButtonState = exports.UIButton = exports.UIPanel = exports.UILabel = exports.UIBox = exports.FlexAlign = void 0;
const utils = __importStar(__webpack_require__(/*! ./library/utils */ "./src/library/utils.ts"));
exports.utils = utils;
const render_manager_1 = __webpack_require__(/*! ./core/render-manager */ "./src/core/render-manager.ts");
Object.defineProperty(exports, "RenderManager", ({ enumerable: true, get: function () { return render_manager_1.RenderManager; } }));
const scene_1 = __webpack_require__(/*! ./core/scene */ "./src/core/scene.ts");
Object.defineProperty(exports, "Scene", ({ enumerable: true, get: function () { return scene_1.Scene; } }));
const engine_1 = __webpack_require__(/*! ./core/engine */ "./src/core/engine.ts");
Object.defineProperty(exports, "Engine", ({ enumerable: true, get: function () { return engine_1.Engine; } }));
const event_system_1 = __webpack_require__(/*! ./core/event-system */ "./src/core/event-system.ts");
Object.defineProperty(exports, "EventEmitter", ({ enumerable: true, get: function () { return event_system_1.EventEmitter; } }));
const client_events_1 = __webpack_require__(/*! ./library/client-events */ "./src/library/client-events.ts");
Object.defineProperty(exports, "ClientEvents", ({ enumerable: true, get: function () { return client_events_1.ClientEvents; } }));
const asset_loader_1 = __webpack_require__(/*! ./core/asset-loader */ "./src/core/asset-loader.ts");
Object.defineProperty(exports, "AssetLoader", ({ enumerable: true, get: function () { return asset_loader_1.AssetLoader; } }));
const logic_1 = __webpack_require__(/*! ./core/logic */ "./src/core/logic.ts");
Object.defineProperty(exports, "Logic", ({ enumerable: true, get: function () { return logic_1.Logic; } }));
const setup_1 = __webpack_require__(/*! ./library/setup */ "./src/library/setup.ts");
Object.defineProperty(exports, "defaultRenderOptions", ({ enumerable: true, get: function () { return setup_1.defaultRenderOptions; } }));
Object.defineProperty(exports, "setupMoxi", ({ enumerable: true, get: function () { return setup_1.setupMoxi; } }));
const font_loader_1 = __webpack_require__(/*! ./library/font-loader */ "./src/library/font-loader.ts");
Object.defineProperty(exports, "loadFonts", ({ enumerable: true, get: function () { return font_loader_1.loadFonts; } }));
const moxi_entity_1 = __webpack_require__(/*! ./core/moxi-entity */ "./src/core/moxi-entity.ts");
Object.defineProperty(exports, "asEntity", ({ enumerable: true, get: function () { return moxi_entity_1.asEntity; } }));
Object.defineProperty(exports, "MoxiEntity", ({ enumerable: true, get: function () { return moxi_entity_1.MoxiEntity; } }));
const camera_1 = __webpack_require__(/*! ./core/camera */ "./src/core/camera.ts");
Object.defineProperty(exports, "Camera", ({ enumerable: true, get: function () { return camera_1.Camera; } }));
Object.defineProperty(exports, "CameraLogic", ({ enumerable: true, get: function () { return camera_1.CameraLogic; } }));
const texture_frames_1 = __webpack_require__(/*! ./library/texture-frames */ "./src/library/texture-frames.ts");
Object.defineProperty(exports, "asTextureFrames", ({ enumerable: true, get: function () { return texture_frames_1.asTextureFrames; } }));
const as_pixi_1 = __webpack_require__(/*! ./library/as-pixi */ "./src/library/as-pixi.ts");
Object.defineProperty(exports, "asBitmapText", ({ enumerable: true, get: function () { return as_pixi_1.asBitmapText; } }));
Object.defineProperty(exports, "asSprite", ({ enumerable: true, get: function () { return as_pixi_1.asSprite; } }));
Object.defineProperty(exports, "asText", ({ enumerable: true, get: function () { return as_pixi_1.asText; } }));
Object.defineProperty(exports, "asGraphics", ({ enumerable: true, get: function () { return as_pixi_1.asGraphics; } }));
Object.defineProperty(exports, "asContainer", ({ enumerable: true, get: function () { return as_pixi_1.asContainer; } }));
const texture_frame_sequences_1 = __webpack_require__(/*! ./library/texture-frame-sequences */ "./src/library/texture-frame-sequences.ts");
Object.defineProperty(exports, "TextureFrameSequences", ({ enumerable: true, get: function () { return texture_frame_sequences_1.TextureFrameSequences; } }));
const resize_handler_1 = __webpack_require__(/*! ./library/resize-handler */ "./src/library/resize-handler.ts");
Object.defineProperty(exports, "createResizeHandler", ({ enumerable: true, get: function () { return resize_handler_1.createResizeHandler; } }));
Object.defineProperty(exports, "setupResponsiveCanvas", ({ enumerable: true, get: function () { return resize_handler_1.setupResponsiveCanvas; } }));
const edge_insets_1 = __webpack_require__(/*! ./ui/core/edge-insets */ "./src/ui/core/edge-insets.ts");
Object.defineProperty(exports, "EdgeInsets", ({ enumerable: true, get: function () { return edge_insets_1.EdgeInsets; } }));
const ui_component_1 = __webpack_require__(/*! ./ui/core/ui-component */ "./src/ui/core/ui-component.ts");
Object.defineProperty(exports, "UIComponent", ({ enumerable: true, get: function () { return ui_component_1.UIComponent; } }));
const ui_focus_manager_1 = __webpack_require__(/*! ./ui/core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
Object.defineProperty(exports, "UIFocusManager", ({ enumerable: true, get: function () { return ui_focus_manager_1.UIFocusManager; } }));
const flex_container_1 = __webpack_require__(/*! ./ui/layout/flex-container */ "./src/ui/layout/flex-container.ts");
Object.defineProperty(exports, "FlexContainer", ({ enumerable: true, get: function () { return flex_container_1.FlexContainer; } }));
Object.defineProperty(exports, "FlexDirection", ({ enumerable: true, get: function () { return flex_container_1.FlexDirection; } }));
Object.defineProperty(exports, "FlexJustify", ({ enumerable: true, get: function () { return flex_container_1.FlexJustify; } }));
Object.defineProperty(exports, "FlexAlign", ({ enumerable: true, get: function () { return flex_container_1.FlexAlign; } }));
const ui_box_1 = __webpack_require__(/*! ./ui/components/ui-box */ "./src/ui/components/ui-box.ts");
Object.defineProperty(exports, "UIBox", ({ enumerable: true, get: function () { return ui_box_1.UIBox; } }));
const ui_label_1 = __webpack_require__(/*! ./ui/components/ui-label */ "./src/ui/components/ui-label.ts");
Object.defineProperty(exports, "UILabel", ({ enumerable: true, get: function () { return ui_label_1.UILabel; } }));
const ui_panel_1 = __webpack_require__(/*! ./ui/components/ui-panel */ "./src/ui/components/ui-panel.ts");
Object.defineProperty(exports, "UIPanel", ({ enumerable: true, get: function () { return ui_panel_1.UIPanel; } }));
const ui_button_1 = __webpack_require__(/*! ./ui/components/ui-button */ "./src/ui/components/ui-button.ts");
Object.defineProperty(exports, "UIButton", ({ enumerable: true, get: function () { return ui_button_1.UIButton; } }));
Object.defineProperty(exports, "ButtonState", ({ enumerable: true, get: function () { return ui_button_1.ButtonState; } }));
const ui_select_1 = __webpack_require__(/*! ./ui/components/ui-select */ "./src/ui/components/ui-select.ts");
Object.defineProperty(exports, "UISelect", ({ enumerable: true, get: function () { return ui_select_1.UISelect; } }));
const ui_text_input_1 = __webpack_require__(/*! ./ui/components/ui-text-input */ "./src/ui/components/ui-text-input.ts");
Object.defineProperty(exports, "UITextInput", ({ enumerable: true, get: function () { return ui_text_input_1.UITextInput; } }));
const ui_textarea_1 = __webpack_require__(/*! ./ui/components/ui-textarea */ "./src/ui/components/ui-textarea.ts");
Object.defineProperty(exports, "UITextArea", ({ enumerable: true, get: function () { return ui_textarea_1.UITextArea; } }));
const ui_scroll_container_1 = __webpack_require__(/*! ./ui/components/ui-scroll-container */ "./src/ui/components/ui-scroll-container.ts");
Object.defineProperty(exports, "UIScrollContainer", ({ enumerable: true, get: function () { return ui_scroll_container_1.UIScrollContainer; } }));
const ui_tabs_1 = __webpack_require__(/*! ./ui/components/ui-tabs */ "./src/ui/components/ui-tabs.ts");
Object.defineProperty(exports, "UITabs", ({ enumerable: true, get: function () { return ui_tabs_1.UITabs; } }));
const UILayer_1 = __webpack_require__(/*! ./ui/UILayer */ "./src/ui/UILayer.ts");
Object.defineProperty(exports, "UILayer", ({ enumerable: true, get: function () { return UILayer_1.UILayer; } }));
const UIScaleMode_1 = __webpack_require__(/*! ./ui/UIScaleMode */ "./src/ui/UIScaleMode.ts");
Object.defineProperty(exports, "UIScaleMode", ({ enumerable: true, get: function () { return UIScaleMode_1.UIScaleMode; } }));
const state_machine_1 = __webpack_require__(/*! ./library/state-machine */ "./src/library/state-machine.ts");
Object.defineProperty(exports, "StateMachine", ({ enumerable: true, get: function () { return state_machine_1.StateMachine; } }));
const state_logic_1 = __webpack_require__(/*! ./library/state-logic */ "./src/library/state-logic.ts");
Object.defineProperty(exports, "StateLogic", ({ enumerable: true, get: function () { return state_logic_1.StateLogic; } }));
const grid_generator_1 = __webpack_require__(/*! ./library/grid-generator */ "./src/library/grid-generator.ts");
Object.defineProperty(exports, "createTileGrid", ({ enumerable: true, get: function () { return grid_generator_1.createTileGrid; } }));
Object.defineProperty(exports, "getTextureRange", ({ enumerable: true, get: function () { return grid_generator_1.getTextureRange; } }));
const svg_to_texture_1 = __webpack_require__(/*! ./library/svg-utils/svg-to-texture */ "./src/library/svg-utils/svg-to-texture.ts");
Object.defineProperty(exports, "svgToTexture", ({ enumerable: true, get: function () { return svg_to_texture_1.svgToTexture; } }));
const pixel_grid_1 = __webpack_require__(/*! ./ui/pixel-grid */ "./src/ui/pixel-grid.ts");
Object.defineProperty(exports, "PixelGrid", ({ enumerable: true, get: function () { return pixel_grid_1.PixelGrid; } }));
Object.defineProperty(exports, "px", ({ enumerable: true, get: function () { return pixel_grid_1.px; } }));
Object.defineProperty(exports, "units", ({ enumerable: true, get: function () { return pixel_grid_1.units; } }));
Object.defineProperty(exports, "GRID", ({ enumerable: true, get: function () { return pixel_grid_1.GRID; } }));
Object.defineProperty(exports, "BORDER", ({ enumerable: true, get: function () { return pixel_grid_1.BORDER; } }));
Object.defineProperty(exports, "createBorderConfig", ({ enumerable: true, get: function () { return pixel_grid_1.createBorderConfig; } }));
const parallax_background_1 = __webpack_require__(/*! ./library/parallax-background */ "./src/library/parallax-background.ts");
Object.defineProperty(exports, "ParallaxBackground", ({ enumerable: true, get: function () { return parallax_background_1.ParallaxBackground; } }));
Object.defineProperty(exports, "ParallaxBackgroundLogic", ({ enumerable: true, get: function () { return parallax_background_1.ParallaxBackgroundLogic; } }));
const parallax_layer_1 = __webpack_require__(/*! ./library/parallax-layer */ "./src/library/parallax-layer.ts");
Object.defineProperty(exports, "ParallaxLayer", ({ enumerable: true, get: function () { return parallax_layer_1.ParallaxLayer; } }));
Object.defineProperty(exports, "TilingParallaxLayer", ({ enumerable: true, get: function () { return parallax_layer_1.TilingParallaxLayer; } }));
const loading_scene_1 = __webpack_require__(/*! ./library/loading-scene */ "./src/library/loading-scene.ts");
Object.defineProperty(exports, "LoadingScene", ({ enumerable: true, get: function () { return loading_scene_1.LoadingScene; } }));
const physics_1 = __webpack_require__(/*! ./library/physics */ "./src/library/physics/index.ts");
Object.defineProperty(exports, "PhysicsWorld", ({ enumerable: true, get: function () { return physics_1.PhysicsWorld; } }));
Object.defineProperty(exports, "PhysicsBodyLogic", ({ enumerable: true, get: function () { return physics_1.PhysicsBodyLogic; } }));
Object.defineProperty(exports, "PhysicsDebugRenderer", ({ enumerable: true, get: function () { return physics_1.PhysicsDebugRenderer; } }));
Object.defineProperty(exports, "CollisionRegistry", ({ enumerable: true, get: function () { return physics_1.CollisionRegistry; } }));
Object.defineProperty(exports, "CollisionManager", ({ enumerable: true, get: function () { return physics_1.CollisionManager; } }));
Object.defineProperty(exports, "asPhysicsEntity", ({ enumerable: true, get: function () { return physics_1.asPhysicsEntity; } }));
Object.defineProperty(exports, "hasPhysics", ({ enumerable: true, get: function () { return physics_1.hasPhysics; } }));
Object.defineProperty(exports, "getPhysicsBody", ({ enumerable: true, get: function () { return physics_1.getPhysicsBody; } }));
Object.defineProperty(exports, "createShapeFromSprite", ({ enumerable: true, get: function () { return physics_1.createShapeFromSprite; } }));
Object.defineProperty(exports, "PhysicsMaterials", ({ enumerable: true, get: function () { return physics_1.PhysicsMaterials; } }));
Object.defineProperty(exports, "applyMaterial", ({ enumerable: true, get: function () { return physics_1.applyMaterial; } }));
const exportedObjects = {
    AssetLoader: asset_loader_1.AssetLoader,
    asEntity: moxi_entity_1.asEntity,
    asTextureFrames: texture_frames_1.asTextureFrames,
    asBitmapText: as_pixi_1.asBitmapText,
    asSprite: as_pixi_1.asSprite,
    asText: as_pixi_1.asText,
    asGraphics: as_pixi_1.asGraphics,
    asContainer: as_pixi_1.asContainer,
    Logic: logic_1.Logic,
    Camera: camera_1.Camera,
    CameraLogic: camera_1.CameraLogic,
    ClientEvents: client_events_1.ClientEvents,
    createResizeHandler: resize_handler_1.createResizeHandler,
    createTileGrid: grid_generator_1.createTileGrid,
    defaultRenderOptions: setup_1.defaultRenderOptions,
    Engine: engine_1.Engine,
    EventEmitter: event_system_1.EventEmitter,
    getTextureRange: grid_generator_1.getTextureRange,
    loadFonts: font_loader_1.loadFonts,
    MoxiEntity: moxi_entity_1.MoxiEntity,
    ParallaxBackground: parallax_background_1.ParallaxBackground,
    ParallaxBackgroundLogic: parallax_background_1.ParallaxBackgroundLogic,
    ParallaxLayer: parallax_layer_1.ParallaxLayer,
    LoadingScene: loading_scene_1.LoadingScene,
    setupMoxi: setup_1.setupMoxi,
    RenderManager: render_manager_1.RenderManager,
    Scene: scene_1.Scene,
    setupResponsiveCanvas: resize_handler_1.setupResponsiveCanvas,
    TextureFrameSequences: texture_frame_sequences_1.TextureFrameSequences,
    TilingParallaxLayer: parallax_layer_1.TilingParallaxLayer,
    utils,
    StateMachine: state_machine_1.StateMachine,
    StateLogic: state_logic_1.StateLogic,
    PhysicsWorld: physics_1.PhysicsWorld,
    PhysicsBodyLogic: physics_1.PhysicsBodyLogic,
    PhysicsDebugRenderer: physics_1.PhysicsDebugRenderer,
    CollisionRegistry: physics_1.CollisionRegistry,
    CollisionManager: physics_1.CollisionManager,
    asPhysicsEntity: physics_1.asPhysicsEntity,
    hasPhysics: physics_1.hasPhysics,
    getPhysicsBody: physics_1.getPhysicsBody,
    createShapeFromSprite: physics_1.createShapeFromSprite,
    PhysicsMaterials: physics_1.PhysicsMaterials,
    applyMaterial: physics_1.applyMaterial,
    EdgeInsets: edge_insets_1.EdgeInsets,
    UIComponent: ui_component_1.UIComponent,
    UIFocusManager: ui_focus_manager_1.UIFocusManager,
    FlexContainer: flex_container_1.FlexContainer,
    FlexDirection: flex_container_1.FlexDirection,
    FlexJustify: flex_container_1.FlexJustify,
    FlexAlign: flex_container_1.FlexAlign,
    UIBox: ui_box_1.UIBox,
    UILabel: ui_label_1.UILabel,
    UIPanel: ui_panel_1.UIPanel,
    UIButton: ui_button_1.UIButton,
    ButtonState: ui_button_1.ButtonState,
    UISelect: ui_select_1.UISelect,
    UITextInput: ui_text_input_1.UITextInput,
    UITextArea: ui_textarea_1.UITextArea,
    UIScrollContainer: ui_scroll_container_1.UIScrollContainer,
    UITabs: ui_tabs_1.UITabs,
    UILayer: UILayer_1.UILayer,
    UIScaleMode: UIScaleMode_1.UIScaleMode,
    svgToTexture: svg_to_texture_1.svgToTexture,
    PixelGrid: pixel_grid_1.PixelGrid,
    px: pixel_grid_1.px,
    units: pixel_grid_1.units,
    GRID: pixel_grid_1.GRID,
    BORDER: pixel_grid_1.BORDER,
    createBorderConfig: pixel_grid_1.createBorderConfig
};
exports["default"] = exportedObjects;


/***/ }),

/***/ "./src/library/as-pixi.ts":
/*!********************************!*\
  !*** ./src/library/as-pixi.ts ***!
  \********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asBitmapText = asBitmapText;
exports.asSprite = asSprite;
exports.asText = asText;
exports.asGraphics = asGraphics;
exports.asContainer = asContainer;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function applyProps(obj, props) {
    if (!props)
        return obj;
    if (props.x !== undefined)
        obj.x = props.x;
    if (props.y !== undefined)
        obj.y = props.y;
    if (props.anchor !== undefined) {
        if (typeof props.anchor === 'number') {
            if ('anchor' in obj && typeof obj.anchor === 'object' && obj.anchor !== null) {
                obj.anchor.set(props.anchor);
            }
        }
        else {
            if ('anchor' in obj && typeof obj.anchor === 'object' && obj.anchor !== null) {
                const anchor = obj.anchor;
                if (props.anchor.x !== undefined)
                    anchor.x = props.anchor.x;
                if (props.anchor.y !== undefined)
                    anchor.y = props.anchor.y;
            }
        }
    }
    if (props.scale !== undefined) {
        if (typeof props.scale === 'number') {
            if ('scale' in obj && typeof obj.scale === 'object' && obj.scale !== null) {
                obj.scale.set(props.scale);
            }
        }
        else {
            if ('scale' in obj && typeof obj.scale === 'object' && obj.scale !== null) {
                const scale = obj.scale;
                if (props.scale.x !== undefined)
                    scale.x = props.scale.x;
                if (props.scale.y !== undefined)
                    scale.y = props.scale.y;
            }
        }
    }
    if (props.rotation !== undefined)
        obj.rotation = props.rotation;
    if (props.tint !== undefined && 'tint' in obj)
        obj.tint = props.tint;
    if (props.alpha !== undefined)
        obj.alpha = props.alpha;
    if (props.visible !== undefined)
        obj.visible = props.visible;
    if (props.eventMode !== undefined && 'eventMode' in obj)
        obj.eventMode = props.eventMode;
    if (props.pivot !== undefined) {
        if (typeof props.pivot === 'number') {
            if ('pivot' in obj && typeof obj.pivot === 'object' && obj.pivot !== null) {
                obj.pivot.set(props.pivot);
            }
        }
        else {
            if ('pivot' in obj && typeof obj.pivot === 'object' && obj.pivot !== null) {
                const pivot = obj.pivot;
                if (props.pivot.x !== undefined)
                    pivot.x = props.pivot.x;
                if (props.pivot.y !== undefined)
                    pivot.y = props.pivot.y;
            }
        }
    }
    return obj;
}
function asBitmapText(constructorArgs, props) {
    const { pixelPerfect, ...textArgs } = constructorArgs;
    const text = new pixi_js_1.default.BitmapText(textArgs);
    if (pixelPerfect) {
        text.roundPixels = true;
    }
    return applyProps(text, props);
}
function asSprite(constructorArgs, props) {
    const sprite = new pixi_js_1.default.Sprite(constructorArgs);
    return applyProps(sprite, props);
}
function asText(constructorArgs, props) {
    const text = new pixi_js_1.default.Text(constructorArgs);
    return applyProps(text, props);
}
function asGraphics(props) {
    const graphics = new pixi_js_1.default.Graphics();
    return applyProps(graphics, props);
}
function asContainer(props) {
    const container = new pixi_js_1.default.Container();
    return applyProps(container, props);
}


/***/ }),

/***/ "./src/library/client-events.ts":
/*!**************************************!*\
  !*** ./src/library/client-events.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.ClientEvents = void 0;
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
class ClientEvents {
    wheelDelta;
    mouseUpEvent;
    mouseDownEvent;
    lastMouseDown;
    lastMouseUp;
    keyDownEvent;
    keyUpEvent;
    keydown;
    wheelOffsets;
    movePosition;
    lastMovePosition;
    moveDelta;
    static instance = null;
    constructor({ initWheelOffset = new pixi_js_1.Point(), onAnyEvent = (ev) => { } } = {}) {
        if (ClientEvents.instance) {
            return ClientEvents.instance;
        }
        this.wheelOffsets = initWheelOffset;
        this.keydown = {};
        this.movePosition = new pixi_js_1.Point();
        const anyEvent = (ev) => {
            onAnyEvent(ev);
        };
        document.addEventListener('wheel', (event) => {
            const wheelDelta = this.wheelOffsets || new pixi_js_1.Point();
            const xValue = wheelDelta.x + event.deltaX;
            const yValue = wheelDelta.y + event.deltaY;
            this.wheelOffsets = new pixi_js_1.Point(xValue, yValue);
            anyEvent({ eventType: 'wheel', event });
        });
        document.addEventListener('mousemove', (event) => {
            this.lastMovePosition = this.movePosition;
            this.movePosition = new pixi_js_1.Point(event.clientX, event.clientY);
            this.moveDelta = new pixi_js_1.Point(this.movePosition.x - this.lastMovePosition.x, this.movePosition.y - this.lastMovePosition.y);
            anyEvent({ eventType: 'mousemove', event });
        });
        document.addEventListener('mousedown', (event) => {
            this.mouseDownEvent = event;
            this.lastMouseDown = event;
            this.mouseUpEvent = null;
            anyEvent({ eventType: 'mousedown', event });
        });
        document.addEventListener('mouseup', (event) => {
            this.mouseUpEvent = event;
            this.lastMouseUp = event;
            this.mouseDownEvent = null;
            anyEvent({ eventType: 'mouseup', event });
        });
        document.addEventListener('keydown', (event) => {
            const { key } = event;
            this.keyDownEvent = event;
            this.keyUpEvent = null;
            this.keydown[key] = event;
            anyEvent({ eventType: 'keydown', event });
        });
        document.addEventListener('keyup', (event) => {
            const { key } = event;
            this.keyUpEvent = event;
            this.keyDownEvent = null;
            delete this.keydown[key];
            anyEvent({ eventType: 'keyup', event });
        });
        ClientEvents.instance = this;
    }
    isKeyDown(key) {
        return Boolean(this.keydown[key]);
    }
    isKeyUp(key) {
        return !this.keydown[key];
    }
}
exports.ClientEvents = ClientEvents;


/***/ }),

/***/ "./src/library/font-loader.ts":
/*!************************************!*\
  !*** ./src/library/font-loader.ts ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.loadFonts = void 0;
const fontfaceobserver_1 = __importDefault(__webpack_require__(/*! fontfaceobserver */ "../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js"));
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
const loadFonts = async () => {
    const fontKenfutureThin = new fontfaceobserver_1.default('kenfuture-thin');
    return new Promise((resolve) => {
        fontKenfutureThin.load().then(() => {
            pixi_js_1.BitmapFont.install({
                name: 'kenfuture-thin',
                style: {
                    fontFamily: 'kenfuture-thin'
                }
            });
            resolve({ fontKenfutureThin });
        });
    });
};
exports.loadFonts = loadFonts;


/***/ }),

/***/ "./src/library/grid-generator.ts":
/*!***************************************!*\
  !*** ./src/library/grid-generator.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createTileGrid = createTileGrid;
exports.getTextureRange = getTextureRange;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function createTileGrid(options, textures, selector) {
    const { width, height, cellWidth, cellHeight, centered = false } = options;
    const defaultSelector = () => Math.floor(Math.random() * textures.length);
    const getTextureIndex = selector || defaultSelector;
    const container = new pixi_js_1.default.Container();
    const totalCells = width * height;
    for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
            const pixelX = x * cellWidth;
            const pixelY = y * cellHeight;
            const index = y * width + x;
            const position = {
                x, y, pixelX, pixelY, index, total: totalCells
            };
            const textureIndex = getTextureIndex(position);
            const cell = new pixi_js_1.default.Sprite(textures[textureIndex]);
            cell.position.set(pixelX, pixelY);
            container.addChild(cell);
        }
    }
    if (centered) {
        const gridWidth = width * cellWidth;
        const gridHeight = height * cellHeight;
        container.position.set(-gridWidth / 2, -gridHeight / 2);
    }
    return container;
}
function getTextureRange(textures, startIndex, count) {
    return textures.slice(startIndex, startIndex + count);
}


/***/ }),

/***/ "./src/library/loading-scene.ts":
/*!**************************************!*\
  !*** ./src/library/loading-scene.ts ***!
  \**************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.LoadingScene = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const pixi_js_2 = __webpack_require__(/*! pixi.js */ "pixi.js");
const PALETTE = [0xf0dab1, 0xe39aac, 0xc45d9f, 0x634b7d, 0x6461c2, 0x2ba9b4, 0x93d4b5, 0xf0f6e8];
class LoadingScene extends pixi_js_2.Container {
    particles = [];
    text;
    background;
    ticker;
    renderer = null;
    time = 0;
    nextSpawn = 0;
    maxParticles;
    baseSize;
    backgroundColor;
    constructor(options = {}) {
        super();
        const { backgroundColor = 0x1a1a1a, squareSize = 20, numSquares = 30, text = 'LOADING...', textStyle = {} } = options;
        this.maxParticles = numSquares;
        this.baseSize = squareSize;
        this.backgroundColor = backgroundColor;
        this.background = new pixi_js_2.Graphics();
        this.addChild(this.background);
        this.text = new pixi_js_2.Text({
            text,
            style: {
                fontFamily: 'Courier New, monospace',
                fontSize: 16,
                fill: 0xffffff,
                fontWeight: 'bold',
                ...textStyle
            }
        });
        this.text.anchor.set(0.5);
        this.addChild(this.text);
        this.ticker = new pixi_js_1.default.Ticker();
        this.ticker.autoStart = false;
        this.ticker.add(() => {
            if (this.visible && this.renderer) {
                this.time += this.ticker.deltaTime / 60;
                this.update(this.renderer.width, this.renderer.height);
                this.renderer.render(this);
            }
        });
    }
    spawnParticle(width, height) {
        if (this.particles.length >= this.maxParticles || this.time < this.nextSpawn)
            return;
        const size = this.baseSize * (0.7 + Math.random() * 0.6);
        const sprite = new pixi_js_2.Graphics();
        sprite.rect(0, 0, size, size);
        sprite.fill({ color: PALETTE[Math.floor(Math.random() * PALETTE.length)] });
        sprite.pivot.set(size / 2, size / 2);
        this.addChild(sprite);
        const textY = height / 2 + 60;
        const textWidth = this.text.width || 200;
        const textCenterX = width / 2;
        this.particles.push({
            sprite,
            spawnTime: this.time,
            duration: 1 + Math.random() * 2.5,
            spinRate: (0.05 + Math.random() * 1.075) * (Math.random() < 0.5 ? 1 : -1),
            startX: textCenterX - textWidth / 2 + Math.random() * textWidth - 4,
            startY: textY - 100,
            endY: textY - 40,
        });
        this.nextSpawn = this.time + Math.random() * 0.5;
    }
    update(width, height) {
        this.background.clear();
        this.background.rect(0, 0, width, height);
        this.background.fill({ color: this.backgroundColor });
        this.text.x = width / 2 - 4;
        this.text.y = height / 2 + 60;
        this.spawnParticle(width, height);
        this.particles = this.particles.filter(p => {
            const elapsed = this.time - p.spawnTime;
            const progress = elapsed / p.duration;
            if (progress < 0 || progress > 1) {
                p.sprite.destroy();
                return false;
            }
            p.sprite.x = p.startX;
            p.sprite.y = p.startY + (p.endY - p.startY) * progress;
            p.sprite.rotation = this.time * p.spinRate * Math.PI * 2;
            p.sprite.alpha = progress < 0.1 ? progress / 0.1 : progress > 0.85 ? (1 - progress) / 0.15 : 1;
            return true;
        });
    }
    init(renderer) {
        this.renderer = renderer;
    }
    show() {
        this.visible = true;
        this.time = 0;
        this.nextSpawn = 0;
        this.particles.forEach(p => p.sprite.destroy());
        this.particles = [];
        if (!this.ticker.started) {
            this.ticker.start();
        }
    }
    hide() {
        this.visible = false;
        if (this.ticker.started) {
            this.ticker.stop();
        }
    }
    destroy() {
        if (this.ticker.started) {
            this.ticker.stop();
        }
        this.ticker.destroy();
        this.particles.forEach(p => p.sprite.destroy());
        super.destroy();
    }
}
exports.LoadingScene = LoadingScene;


/***/ }),

/***/ "./src/library/parallax-background.ts":
/*!********************************************!*\
  !*** ./src/library/parallax-background.ts ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.ParallaxBackgroundLogic = exports.ParallaxBackground = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const moxi_entity_1 = __webpack_require__(/*! ../core/moxi-entity */ "./src/core/moxi-entity.ts");
const logic_1 = __webpack_require__(/*! ../core/logic */ "./src/core/logic.ts");
const camera_1 = __webpack_require__(/*! ../core/camera */ "./src/core/camera.ts");
const parallax_layer_1 = __webpack_require__(/*! ./parallax-layer */ "./src/library/parallax-layer.ts");
class ParallaxBackground extends PIXI.Container {
    moxiEntity;
    camera = null;
    scrollOffset = new PIXI.Point(0, 0);
    scrollBaseScale = new PIXI.Point(1, 1);
    scrollIgnoreCameraZoom = false;
    autoscroll = new PIXI.Point(0, 0);
    constructor(options = {}) {
        super();
        this.camera = options.camera ?? null;
        this.scrollOffset = options.scrollOffset ?? new PIXI.Point(0, 0);
        this.scrollBaseScale = options.scrollBaseScale ?? new PIXI.Point(1, 1);
        this.scrollIgnoreCameraZoom = options.scrollIgnoreCameraZoom ?? false;
        this.autoscroll = options.autoscroll ?? new PIXI.Point(0, 0);
        const entity = (0, moxi_entity_1.asEntity)(this);
        entity.moxiEntity.addLogic(new ParallaxBackgroundLogic());
        this.moxiEntity = entity.moxiEntity;
    }
    addLayer(layer) {
        this.addChild(layer);
    }
    detectCamera() {
        let current = this.parent;
        while (current) {
            if (current instanceof camera_1.Camera) {
                return current;
            }
            current = current.parent;
        }
        return null;
    }
    getCameraPosition() {
        const camera = this.camera ?? this.detectCamera();
        if (!camera) {
            return new PIXI.Point(0, 0);
        }
        return new PIXI.Point(camera.position.x, camera.position.y);
    }
    getCameraScale() {
        if (this.scrollIgnoreCameraZoom) {
            return new PIXI.Point(1, 1);
        }
        const camera = this.camera ?? this.detectCamera();
        if (!camera) {
            return new PIXI.Point(1, 1);
        }
        return new PIXI.Point(camera.scale.x, camera.scale.y);
    }
}
exports.ParallaxBackground = ParallaxBackground;
class ParallaxBackgroundLogic extends logic_1.Logic {
    name = 'ParallaxBackgroundLogic';
    update(entity, deltaTime) {
        if (entity.autoscroll.x !== 0 || entity.autoscroll.y !== 0) {
            entity.scrollOffset.x += entity.autoscroll.x * deltaTime;
            entity.scrollOffset.y += entity.autoscroll.y * deltaTime;
        }
        const cameraPos = entity.getCameraPosition();
        const cameraScale = entity.getCameraScale();
        const scene = entity.parent;
        if (scene) {
            entity.position.x = cameraPos.x / scene.scale.x;
            entity.position.y = cameraPos.y / scene.scale.y;
            entity.scale.x = 1 / scene.scale.x;
            entity.scale.y = 1 / scene.scale.y;
        }
        else {
            entity.position.x = cameraPos.x;
            entity.position.y = cameraPos.y;
            entity.scale.set(1, 1);
        }
        entity.children.forEach((child) => {
            if (child instanceof parallax_layer_1.ParallaxLayer) {
                child.updateParallax(cameraPos, cameraScale, entity.scrollOffset);
            }
        });
    }
}
exports.ParallaxBackgroundLogic = ParallaxBackgroundLogic;


/***/ }),

/***/ "./src/library/parallax-layer.ts":
/*!***************************************!*\
  !*** ./src/library/parallax-layer.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.TilingParallaxLayer = exports.ParallaxLayer = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const moxi_entity_1 = __webpack_require__(/*! ../core/moxi-entity */ "./src/core/moxi-entity.ts");
class ParallaxLayer extends PIXI.Container {
    moxiEntity;
    scrollScale = new PIXI.Point(1, 1);
    scrollOffset = new PIXI.Point(0, 0);
    repeatSize = new PIXI.Point(0, 0);
    mirroring = false;
    _lastCameraPos = new PIXI.Point(0, 0);
    constructor(options = {}) {
        super();
        this.scrollScale = options.scrollScale ?? new PIXI.Point(1, 1);
        this.scrollOffset = options.scrollOffset ?? new PIXI.Point(0, 0);
        this.repeatSize = options.repeatSize ?? new PIXI.Point(0, 0);
        this.mirroring = options.mirroring ?? false;
        const entity = (0, moxi_entity_1.asEntity)(this);
        this.moxiEntity = entity.moxiEntity;
    }
    updateParallax(cameraPos, cameraScale, backgroundOffset) {
        const scrollX = (cameraPos.x + backgroundOffset.x) * this.scrollScale.x;
        const scrollY = (cameraPos.y + backgroundOffset.y) * this.scrollScale.y;
        this.position.x = -scrollX + this.scrollOffset.x;
        this.position.y = -scrollY + this.scrollOffset.y;
        if (this.mirroring) {
            if (this.repeatSize.x > 0) {
                this.position.x = this.position.x % this.repeatSize.x;
                if (this.position.x > 0)
                    this.position.x -= this.repeatSize.x;
            }
            if (this.repeatSize.y > 0) {
                this.position.y = this.position.y % this.repeatSize.y;
                if (this.position.y > 0)
                    this.position.y -= this.repeatSize.y;
            }
        }
        this._lastCameraPos.copyFrom(cameraPos);
    }
}
exports.ParallaxLayer = ParallaxLayer;
class TilingParallaxLayer extends ParallaxLayer {
    tilingSprite;
    _autoSized = false;
    constructor(options) {
        super(options);
        options.texture.source.style.addressMode = 'repeat';
        const width = options.width ?? 1;
        const height = options.height ?? 1;
        this.tilingSprite = new PIXI.TilingSprite({
            texture: options.texture,
            width: width,
            height: height,
        });
        this.tilingSprite.position.set(0, 0);
        this.addChild(this.tilingSprite);
        this._autoSized = !options.width && !options.height;
    }
    autoDetectDimensions() {
        if (!this._autoSized)
            return;
        let current = this.parent;
        while (current) {
            if (current.renderer) {
                this.resize(current.renderer.width, current.renderer.height);
                this._autoSized = false;
                return;
            }
            current = current.parent;
        }
    }
    updateParallax(cameraPos, cameraScale, backgroundOffset) {
        this.autoDetectDimensions();
        const renderer = this.parent?.parent;
        if (renderer?.renderer) {
            const baseWidth = renderer.renderer.width;
            const baseHeight = renderer.renderer.height;
            this.tilingSprite.width = baseWidth;
            this.tilingSprite.height = baseHeight;
            this.tilingSprite.pivot.set(0, 0);
            this.tilingSprite.position.set(0, 0);
        }
        const scrollX = (cameraPos.x + backgroundOffset.x) * this.scrollScale.x;
        const scrollY = (cameraPos.y + backgroundOffset.y) * this.scrollScale.y;
        this.tilingSprite.tilePosition.x = -scrollX + this.scrollOffset.x;
        this.tilingSprite.tilePosition.y = -scrollY + this.scrollOffset.y;
        this.position.set(0, 0);
    }
    resize(width, height) {
        this.tilingSprite.width = width;
        this.tilingSprite.height = height;
    }
}
exports.TilingParallaxLayer = TilingParallaxLayer;


/***/ }),

/***/ "./src/library/physics/index.ts":
/*!**************************************!*\
  !*** ./src/library/physics/index.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.applyMaterial = exports.PhysicsMaterials = exports.createShapeFromSprite = exports.getPhysicsBody = exports.hasPhysics = exports.asPhysicsEntity = exports.PhysicsDebugRenderer = exports.CollisionManager = exports.CollisionRegistry = exports.PhysicsBodyLogic = exports.PhysicsWorld = void 0;
var physics_world_1 = __webpack_require__(/*! ./physics-world */ "./src/library/physics/physics-world.ts");
Object.defineProperty(exports, "PhysicsWorld", ({ enumerable: true, get: function () { return physics_world_1.PhysicsWorld; } }));
var physics_body_logic_1 = __webpack_require__(/*! ./physics-body-logic */ "./src/library/physics/physics-body-logic.ts");
Object.defineProperty(exports, "PhysicsBodyLogic", ({ enumerable: true, get: function () { return physics_body_logic_1.PhysicsBodyLogic; } }));
var physics_collision_1 = __webpack_require__(/*! ./physics-collision */ "./src/library/physics/physics-collision.ts");
Object.defineProperty(exports, "CollisionRegistry", ({ enumerable: true, get: function () { return physics_collision_1.CollisionRegistry; } }));
Object.defineProperty(exports, "CollisionManager", ({ enumerable: true, get: function () { return physics_collision_1.CollisionManager; } }));
var physics_debug_renderer_1 = __webpack_require__(/*! ./physics-debug-renderer */ "./src/library/physics/physics-debug-renderer.ts");
Object.defineProperty(exports, "PhysicsDebugRenderer", ({ enumerable: true, get: function () { return physics_debug_renderer_1.PhysicsDebugRenderer; } }));
var physics_utils_1 = __webpack_require__(/*! ./physics-utils */ "./src/library/physics/physics-utils.ts");
Object.defineProperty(exports, "asPhysicsEntity", ({ enumerable: true, get: function () { return physics_utils_1.asPhysicsEntity; } }));
Object.defineProperty(exports, "hasPhysics", ({ enumerable: true, get: function () { return physics_utils_1.hasPhysics; } }));
Object.defineProperty(exports, "getPhysicsBody", ({ enumerable: true, get: function () { return physics_utils_1.getPhysicsBody; } }));
Object.defineProperty(exports, "createShapeFromSprite", ({ enumerable: true, get: function () { return physics_utils_1.createShapeFromSprite; } }));
var physics_materials_1 = __webpack_require__(/*! ./physics-materials */ "./src/library/physics/physics-materials.ts");
Object.defineProperty(exports, "PhysicsMaterials", ({ enumerable: true, get: function () { return physics_materials_1.PhysicsMaterials; } }));
Object.defineProperty(exports, "applyMaterial", ({ enumerable: true, get: function () { return physics_materials_1.applyMaterial; } }));


/***/ }),

/***/ "./src/library/physics/physics-body-logic.ts":
/*!***************************************************!*\
  !*** ./src/library/physics/physics-body-logic.ts ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsBodyLogic = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const logic_1 = __webpack_require__(/*! ../../core/logic */ "./src/core/logic.ts");
const physics_graphics_parser_1 = __webpack_require__(/*! ./physics-graphics-parser */ "./src/library/physics/physics-graphics-parser.ts");
class PhysicsBodyLogic extends logic_1.Logic {
    name = 'PhysicsBodyLogic';
    body;
    world;
    options;
    onCollisionBegin;
    onCollisionEnd;
    constructor(world, options = {}) {
        super();
        this.world = world;
        this.options = {
            type: 'dynamic',
            syncMode: 'physics-driven',
            syncPosition: true,
            syncRotation: true,
            density: 1.0,
            friction: 0.3,
            restitution: 0.0,
            fixedRotation: false,
            isSensor: false,
            bullet: false,
            ...options
        };
    }
    init(entity, renderer) {
        this.createPhysicsBody(entity);
        this.body.setUserData(this);
        this.world.registerBody(this.body, this);
    }
    update(entity, deltaTime) {
        if (!this.body)
            return;
        switch (this.options.syncMode) {
            case 'physics-driven':
                this.syncFromPhysics(entity);
                break;
            case 'sprite-driven':
                this.syncToPhysics(entity);
                break;
            case 'manual':
                break;
        }
    }
    destroy() {
        if (this.body) {
            this.world.destroyBody(this.body);
        }
    }
    syncFromPhysics(entity) {
        if (!this.body)
            return;
        const pos = this.body.getPosition();
        if (this.options.syncPosition) {
            entity.x = this.world.toPixels(pos.x);
            entity.y = this.world.toPixels(pos.y);
        }
        if (this.options.syncRotation) {
            entity.rotation = this.body.getAngle();
        }
    }
    syncToPhysics(entity) {
        if (!this.body)
            return;
        if (this.options.syncPosition) {
            const x = this.world.toPhysics(entity.x);
            const y = this.world.toPhysics(entity.y);
            this.body.setPosition(planck.Vec2(x, y));
        }
        if (this.options.syncRotation) {
            this.body.setAngle(entity.rotation);
        }
    }
    createPhysicsBody(entity) {
        let bodyType;
        switch (this.options.type) {
            case 'static':
                bodyType = 'static';
                break;
            case 'kinematic':
                bodyType = 'kinematic';
                break;
            case 'dynamic':
            default:
                bodyType = 'dynamic';
                break;
        }
        const bodyDef = {
            type: bodyType,
            position: this.options.position
                ? this.world.toPhysicsPoint(this.options.position)
                : planck.Vec2(this.world.toPhysics(entity.x), this.world.toPhysics(entity.y)),
            angle: this.options.rotation ?? entity.rotation,
            linearVelocity: this.options.linearVelocity
                ? this.world.toPhysicsPoint(this.options.linearVelocity)
                : planck.Vec2(0, 0),
            angularVelocity: this.options.angularVelocity ?? 0,
            fixedRotation: this.options.fixedRotation ?? false,
            bullet: this.options.bullet ?? false
        };
        this.body = this.world.createBody(bodyDef);
        this.createFixture(entity);
        if (this.options.linearVelocity) {
            this.setVelocity(this.options.linearVelocity);
        }
        if (this.options.angularVelocity) {
            this.setAngularVelocity(this.options.angularVelocity);
        }
    }
    createFixture(entity) {
        const shape = this.createShape(entity);
        const categoryBits = this.options.collisionTags
            ? this.world.collisionRegistry.tagsToBits(this.options.collisionTags)
            : this.world.collisionRegistry.getBit('default');
        const maskBits = this.options.collidesWith
            ? this.world.collisionRegistry.tagsToBits(this.options.collidesWith)
            : 0xFFFF;
        const groupIndex = this.options.collisionGroup ?? 0;
        this.body.createFixture({
            shape: shape,
            density: this.options.density ?? 1.0,
            friction: this.options.friction ?? 0.3,
            restitution: this.options.restitution ?? 0.0,
            isSensor: this.options.isSensor ?? false,
            filterCategoryBits: categoryBits,
            filterMaskBits: maskBits,
            filterGroupIndex: groupIndex
        });
    }
    createShape(entity) {
        if (this.options.collisionShape) {
            const parsed = (0, physics_graphics_parser_1.parseGraphicsShape)(this.options.collisionShape, this.world);
            return parsed.shape;
        }
        if (entity instanceof PIXI.Graphics) {
            const parsed = (0, physics_graphics_parser_1.parseGraphicsShape)(entity, this.world);
            return parsed.shape;
        }
        if (this.options.shape) {
            return this.createShapeFromType(this.options.shape);
        }
        throw new Error('Collision shape required for non-Graphics entities. ' +
            'Either provide a Graphics entity, or specify options.collisionShape, ' +
            'or use legacy options.shape with dimensions.');
    }
    createShapeFromType(shapeType) {
        switch (shapeType) {
            case 'circle':
                const radius = this.options.radius ?? 25;
                return planck.Circle(this.world.toPhysics(radius));
            case 'rectangle':
                const width = this.options.width ?? 50;
                const height = this.options.height ?? 50;
                return planck.Box(this.world.toPhysics(width / 2), this.world.toPhysics(height / 2));
            case 'polygon':
                if (!this.options.vertices || this.options.vertices.length < 3) {
                    throw new Error('Polygon shape requires at least 3 vertices');
                }
                const vertices = this.options.vertices.map(v => planck.Vec2(this.world.toPhysics(v.x), this.world.toPhysics(v.y)));
                return planck.Polygon(vertices);
            default:
                throw new Error(`Unknown shape type: ${shapeType}`);
        }
    }
    autoDetectShape(entity) {
        const bounds = entity.getLocalBounds();
        return planck.Box(this.world.toPhysics(bounds.width / 2), this.world.toPhysics(bounds.height / 2));
    }
    applyForce(force, point) {
        const forceVec = this.world.toPhysicsPoint(force);
        const pointVec = point
            ? this.world.toPhysicsPoint(point)
            : this.body.getWorldCenter();
        this.body.applyForce(forceVec, pointVec);
    }
    applyImpulse(impulse, point) {
        const impulseVec = this.world.toPhysicsPoint(impulse);
        const pointVec = point
            ? this.world.toPhysicsPoint(point)
            : this.body.getWorldCenter();
        this.body.applyLinearImpulse(impulseVec, pointVec);
    }
    applyTorque(torque) {
        this.body.applyTorque(torque);
    }
    setVelocity(velocity) {
        const velocityVec = this.world.toPhysicsPoint(velocity);
        this.body.setLinearVelocity(velocityVec);
    }
    setAngularVelocity(omega) {
        this.body.setAngularVelocity(omega);
    }
    getVelocity() {
        const vel = this.body.getLinearVelocity();
        return this.world.toPixelsPoint(vel);
    }
    getAngularVelocity() {
        return this.body.getAngularVelocity();
    }
    getMass() {
        return this.body.getMass();
    }
    isAwake() {
        return this.body.isAwake();
    }
    isSleeping() {
        return !this.body.isAwake();
    }
    setAwake(awake) {
        this.body.setAwake(awake);
    }
}
exports.PhysicsBodyLogic = PhysicsBodyLogic;


/***/ }),

/***/ "./src/library/physics/physics-collision.ts":
/*!**************************************************!*\
  !*** ./src/library/physics/physics-collision.ts ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.CollisionManager = exports.CollisionRegistry = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
class CollisionRegistry {
    tagToBit = new Map();
    bitToTag = new Map();
    nextBit = 1;
    constructor() {
        this.register('default');
    }
    register(tag) {
        if (this.tagToBit.has(tag))
            return;
        if (this.nextBit > 0x8000) {
            throw new Error('Maximum collision tags reached (16 tags)');
        }
        this.tagToBit.set(tag, this.nextBit);
        this.bitToTag.set(this.nextBit, tag);
        this.nextBit <<= 1;
    }
    getBit(tag) {
        if (!this.tagToBit.has(tag)) {
            this.register(tag);
        }
        return this.tagToBit.get(tag);
    }
    getTag(bit) {
        return this.bitToTag.get(bit);
    }
    tagsToBits(tags) {
        if (!tags || tags.length === 0) {
            return this.getBit('default');
        }
        return tags.reduce((bits, tag) => bits | this.getBit(tag), 0);
    }
    bitsToTags(bits) {
        const tags = [];
        for (const [bit, tag] of this.bitToTag) {
            if (bits & bit) {
                tags.push(tag);
            }
        }
        return tags;
    }
}
exports.CollisionRegistry = CollisionRegistry;
class CollisionManager {
    world;
    registry;
    callbacks = new Map();
    constructor(world, registry) {
        this.world = world;
        this.registry = registry;
        this.setupListeners();
    }
    setupListeners() {
        this.world.world.on('begin-contact', (contact) => {
            this.handleBeginContact(contact);
        });
        this.world.world.on('end-contact', (contact) => {
            this.handleEndContact(contact);
        });
    }
    onCollision(tagA, tagB, callback) {
        const key = this.makeKey(tagA, tagB);
        if (!this.callbacks.has(key)) {
            this.callbacks.set(key, new Set());
        }
        this.callbacks.get(key).add(callback);
    }
    offCollision(tagA, tagB, callback) {
        const key = this.makeKey(tagA, tagB);
        this.callbacks.get(key)?.delete(callback);
    }
    makeKey(tagA, tagB) {
        return tagA < tagB ? `${tagA}:${tagB}` : `${tagB}:${tagA}`;
    }
    handleBeginContact(contact) {
        const bodyA = contact.getFixtureA().getBody().getUserData();
        const bodyB = contact.getFixtureB().getBody().getUserData();
        if (!bodyA || !bodyB)
            return;
        bodyA.onCollisionBegin?.(bodyB, contact);
        bodyB.onCollisionBegin?.(bodyA, contact);
        this.triggerTagCallbacks(bodyA, bodyB, contact);
    }
    handleEndContact(contact) {
        const bodyA = contact.getFixtureA().getBody().getUserData();
        const bodyB = contact.getFixtureB().getBody().getUserData();
        if (!bodyA || !bodyB)
            return;
        bodyA.onCollisionEnd?.(bodyB, contact);
        bodyB.onCollisionEnd?.(bodyA, contact);
    }
    triggerTagCallbacks(bodyA, bodyB, contact) {
        const tagsA = bodyA.options.collisionTags || [];
        const tagsB = bodyB.options.collisionTags || [];
        for (const tagA of tagsA) {
            for (const tagB of tagsB) {
                const key = this.makeKey(tagA, tagB);
                const callbacks = this.callbacks.get(key);
                if (callbacks) {
                    const event = {
                        bodyA,
                        bodyB,
                        contact,
                        normal: new PIXI.Point(0, 0),
                        impulse: 0
                    };
                    callbacks.forEach(cb => cb(event));
                }
            }
        }
    }
}
exports.CollisionManager = CollisionManager;


/***/ }),

/***/ "./src/library/physics/physics-debug-renderer.ts":
/*!*******************************************************!*\
  !*** ./src/library/physics/physics-debug-renderer.ts ***!
  \*******************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsDebugRenderer = void 0;
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const logic_1 = __webpack_require__(/*! ../../core/logic */ "./src/core/logic.ts");
class PhysicsDebugRenderer extends logic_1.Logic {
    name = 'PhysicsDebugRenderer';
    world;
    graphics;
    options;
    isVisible = true;
    constructor(world, options = {}) {
        super();
        this.world = world;
        this.options = {
            showShapes: options.showShapes ?? true,
            showVelocities: options.showVelocities ?? false,
            showAABBs: options.showAABBs ?? false,
            showCenterOfMass: options.showCenterOfMass ?? false,
            showContactPoints: options.showContactPoints ?? false,
            showJoints: options.showJoints ?? false,
            colorStatic: options.colorStatic ?? 0x00FF00,
            colorDynamic: options.colorDynamic ?? 0xFF0000,
            colorKinematic: options.colorKinematic ?? 0x0000FF,
            colorSleeping: options.colorSleeping ?? 0xAAAAAA,
            colorSensor: options.colorSensor ?? 0xFFFF00,
            alpha: options.alpha ?? 0.5,
            lineWidth: options.lineWidth ?? 2
        };
    }
    init(entity, renderer) {
        this.graphics = entity;
    }
    update(entity, deltaTime) {
        if (!this.isVisible) {
            this.graphics.clear();
            return;
        }
        this.graphics.clear();
        if (this.options.showShapes) {
            for (let body = this.world.world.getBodyList(); body; body = body.getNext()) {
                this.drawBody(body);
            }
        }
        if (this.options.showContactPoints) {
            this.drawContacts();
        }
    }
    drawBody(body) {
        const transform = body.getTransform();
        let color;
        if (!body.isAwake() && body.isDynamic()) {
            color = this.options.colorSleeping;
        }
        else if (body.isStatic()) {
            color = this.options.colorStatic;
        }
        else if (body.isKinematic()) {
            color = this.options.colorKinematic;
        }
        else {
            color = this.options.colorDynamic;
        }
        for (let fixture = body.getFixtureList(); fixture; fixture = fixture.getNext()) {
            const shape = fixture.getShape();
            const fixtureColor = fixture.isSensor() ? this.options.colorSensor : color;
            const alpha = fixture.isSensor() ? this.options.alpha * 0.5 : this.options.alpha;
            this.drawShape(shape, transform, fixtureColor, alpha);
        }
        if (this.options.showVelocities && body.isDynamic()) {
            this.drawVelocity(body);
        }
        if (this.options.showAABBs) {
            this.drawAABB(body);
        }
        if (this.options.showCenterOfMass) {
            this.drawCenterOfMass(body);
        }
    }
    drawShape(shape, transform, color, alpha) {
        this.graphics.stroke({
            width: this.options.lineWidth,
            color: color,
            alpha: alpha
        });
        const shapeType = shape.getType();
        if (shapeType === 'circle') {
            const circle = shape;
            const center = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, circle.getCenter()));
            const radius = circle.getRadius();
            const pixelCenter = this.world.toPixelsPoint(center);
            const pixelRadius = this.world.toPixels(radius);
            this.graphics.circle(pixelCenter.x, pixelCenter.y, pixelRadius);
            this.graphics.stroke();
            const angle = transform.q.getAngle();
            const endX = pixelCenter.x + Math.cos(angle) * pixelRadius;
            const endY = pixelCenter.y + Math.sin(angle) * pixelRadius;
            this.graphics.moveTo(pixelCenter.x, pixelCenter.y);
            this.graphics.lineTo(endX, endY);
            this.graphics.stroke();
        }
        else if (shapeType === 'polygon') {
            const poly = shape;
            const vertices = poly.m_vertices;
            if (vertices && vertices.length > 0) {
                const firstVertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[0]));
                const pixelFirst = this.world.toPixelsPoint(firstVertex);
                this.graphics.moveTo(pixelFirst.x, pixelFirst.y);
                for (let i = 1; i < vertices.length; i++) {
                    const vertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[i]));
                    const pixelVertex = this.world.toPixelsPoint(vertex);
                    this.graphics.lineTo(pixelVertex.x, pixelVertex.y);
                }
                this.graphics.lineTo(pixelFirst.x, pixelFirst.y);
                this.graphics.stroke();
            }
        }
        else if (shapeType === 'edge') {
            const edge = shape;
            const v1 = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, edge.m_vertex1));
            const v2 = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, edge.m_vertex2));
            const p1 = this.world.toPixelsPoint(v1);
            const p2 = this.world.toPixelsPoint(v2);
            this.graphics.moveTo(p1.x, p1.y);
            this.graphics.lineTo(p2.x, p2.y);
            this.graphics.stroke();
        }
        else if (shapeType === 'chain') {
            const chain = shape;
            const vertices = chain.m_vertices;
            if (vertices && vertices.length > 0) {
                const firstVertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[0]));
                const pixelFirst = this.world.toPixelsPoint(firstVertex);
                this.graphics.moveTo(pixelFirst.x, pixelFirst.y);
                for (let i = 1; i < vertices.length; i++) {
                    const vertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[i]));
                    const pixelVertex = this.world.toPixelsPoint(vertex);
                    this.graphics.lineTo(pixelVertex.x, pixelVertex.y);
                }
                this.graphics.stroke();
            }
        }
    }
    drawVelocity(body) {
        const position = body.getPosition();
        const velocity = body.getLinearVelocity();
        const scale = 0.5;
        const endPoint = planck.Vec2.add(position, planck.Vec2.mul(velocity, scale));
        const pixelStart = this.world.toPixelsPoint(position);
        const pixelEnd = this.world.toPixelsPoint(endPoint);
        this.graphics.stroke({
            width: 2,
            color: 0x00FFFF,
            alpha: 0.8
        });
        this.graphics.moveTo(pixelStart.x, pixelStart.y);
        this.graphics.lineTo(pixelEnd.x, pixelEnd.y);
        this.graphics.stroke();
        const angle = Math.atan2(pixelEnd.y - pixelStart.y, pixelEnd.x - pixelStart.x);
        const arrowSize = 5;
        const angle1 = angle + Math.PI * 0.8;
        const angle2 = angle - Math.PI * 0.8;
        this.graphics.moveTo(pixelEnd.x, pixelEnd.y);
        this.graphics.lineTo(pixelEnd.x + Math.cos(angle1) * arrowSize, pixelEnd.y + Math.sin(angle1) * arrowSize);
        this.graphics.moveTo(pixelEnd.x, pixelEnd.y);
        this.graphics.lineTo(pixelEnd.x + Math.cos(angle2) * arrowSize, pixelEnd.y + Math.sin(angle2) * arrowSize);
        this.graphics.stroke();
    }
    drawAABB(body) {
        for (let fixture = body.getFixtureList(); fixture; fixture = fixture.getNext()) {
            const aabb = fixture.getAABB(0);
            const lowerBound = this.world.toPixelsPoint(aabb.lowerBound);
            const upperBound = this.world.toPixelsPoint(aabb.upperBound);
            this.graphics.stroke({
                width: 1,
                color: 0xFF00FF,
                alpha: 0.3
            });
            this.graphics.rect(lowerBound.x, lowerBound.y, upperBound.x - lowerBound.x, upperBound.y - lowerBound.y);
            this.graphics.stroke();
        }
    }
    drawCenterOfMass(body) {
        const position = body.getWorldCenter();
        const pixelPos = this.world.toPixelsPoint(position);
        this.graphics.stroke({
            width: 1,
            color: 0xFFFFFF,
            alpha: 1
        });
        const size = 5;
        this.graphics.moveTo(pixelPos.x - size, pixelPos.y);
        this.graphics.lineTo(pixelPos.x + size, pixelPos.y);
        this.graphics.moveTo(pixelPos.x, pixelPos.y - size);
        this.graphics.lineTo(pixelPos.x, pixelPos.y + size);
        this.graphics.stroke();
    }
    drawContacts() {
        for (let contact = this.world.world.getContactList(); contact; contact = contact.getNext()) {
            if (!contact.isTouching())
                continue;
            const manifold = contact.getManifold();
            if (!manifold)
                continue;
            const worldManifold = contact.getWorldManifold(null);
            if (!worldManifold)
                continue;
            for (let i = 0; i < manifold.pointCount; i++) {
                const point = worldManifold.points[i];
                if (!point)
                    continue;
                const pixelPoint = this.world.toPixelsPoint(planck.Vec2(point.x, point.y));
                this.graphics.circle(pixelPoint.x, pixelPoint.y, 3);
                this.graphics.fill({ color: 0xFF0000, alpha: 0.8 });
            }
        }
    }
    setVisible(visible) {
        this.isVisible = visible;
        if (!visible) {
            this.graphics.clear();
        }
    }
    toggle() {
        this.setVisible(!this.isVisible);
    }
    getVisible() {
        return this.isVisible;
    }
}
exports.PhysicsDebugRenderer = PhysicsDebugRenderer;


/***/ }),

/***/ "./src/library/physics/physics-graphics-parser.ts":
/*!********************************************************!*\
  !*** ./src/library/physics/physics-graphics-parser.ts ***!
  \********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.setGraphicsPhysicsShape = setGraphicsPhysicsShape;
exports.initGraphicsPhysicsTracking = initGraphicsPhysicsTracking;
exports.parseGraphicsShape = parseGraphicsShape;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const PHYSICS_SHAPE_KEY = '__physicsShape__';
function setGraphicsPhysicsShape(graphics, metadata) {
    graphics[PHYSICS_SHAPE_KEY] = metadata;
}
function initGraphicsPhysicsTracking() {
    const originalRect = PIXI.Graphics.prototype.rect;
    const originalCircle = PIXI.Graphics.prototype.circle;
    const originalPoly = PIXI.Graphics.prototype.poly;
    PIXI.Graphics.prototype.rect = function (x, y, w, h) {
        setGraphicsPhysicsShape(this, {
            type: 'rectangle',
            width: w,
            height: h
        });
        return originalRect.call(this, x, y, w, h);
    };
    PIXI.Graphics.prototype.circle = function (x, y, radius) {
        setGraphicsPhysicsShape(this, {
            type: 'circle',
            radius: radius
        });
        return originalCircle.call(this, x, y, radius);
    };
    PIXI.Graphics.prototype.poly = function (points) {
        const flatPoints = Array.isArray(points[0]) ? points.flat() : points;
        setGraphicsPhysicsShape(this, {
            type: 'polygon',
            vertices: flatPoints
        });
        return originalPoly.call(this, points);
    };
}
function parseGraphicsShape(graphics, world) {
    const metadata = graphics[PHYSICS_SHAPE_KEY];
    if (metadata) {
        switch (metadata.type) {
            case 'circle':
                if (!metadata.radius) {
                    throw new Error('Circle metadata missing radius');
                }
                return {
                    type: 'circle',
                    shape: planck.Circle(world.toPhysics(metadata.radius))
                };
            case 'rectangle':
                if (!metadata.width || !metadata.height) {
                    throw new Error('Rectangle metadata missing width/height');
                }
                return {
                    type: 'rectangle',
                    shape: planck.Box(world.toPhysics(metadata.width / 2), world.toPhysics(metadata.height / 2))
                };
            case 'polygon':
                if (!metadata.vertices || metadata.vertices.length < 6) {
                    throw new Error('Polygon metadata missing vertices (need at least 3 points = 6 values)');
                }
                const vertices = [];
                for (let i = 0; i < metadata.vertices.length; i += 2) {
                    vertices.push(planck.Vec2(world.toPhysics(metadata.vertices[i]), world.toPhysics(metadata.vertices[i + 1])));
                }
                return {
                    type: 'polygon',
                    shape: planck.Polygon(vertices)
                };
        }
    }
    const bounds = graphics.getLocalBounds();
    if (bounds.width === 0 || bounds.height === 0) {
        throw new Error('Graphics has no dimensions. Either draw shapes using rect(), circle(), or poly(), ' +
            'or provide an explicit collisionShape option.');
    }
    return {
        type: 'rectangle',
        shape: planck.Box(world.toPhysics(bounds.width / 2), world.toPhysics(bounds.height / 2))
    };
}


/***/ }),

/***/ "./src/library/physics/physics-materials.ts":
/*!**************************************************!*\
  !*** ./src/library/physics/physics-materials.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsMaterials = void 0;
exports.applyMaterial = applyMaterial;
exports.PhysicsMaterials = {
    bouncy: {
        density: 0.5,
        friction: 0.1,
        restitution: 0.9
    },
    wood: {
        density: 0.7,
        friction: 0.4,
        restitution: 0.2
    },
    metal: {
        density: 1.5,
        friction: 0.3,
        restitution: 0.1
    },
    ice: {
        density: 0.9,
        friction: 0.02,
        restitution: 0.05
    },
    rubber: {
        density: 1.0,
        friction: 0.9,
        restitution: 0.7
    },
    character: {
        density: 1.0,
        friction: 0.5,
        restitution: 0.0,
        fixedRotation: true
    },
    terrain: {
        density: 0,
        friction: 0.6,
        restitution: 0.0
    }
};
function applyMaterial(options, material) {
    return {
        ...options,
        ...exports.PhysicsMaterials[material]
    };
}


/***/ }),

/***/ "./src/library/physics/physics-utils.ts":
/*!**********************************************!*\
  !*** ./src/library/physics/physics-utils.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asPhysicsEntity = asPhysicsEntity;
exports.hasPhysics = hasPhysics;
exports.getPhysicsBody = getPhysicsBody;
exports.createShapeFromSprite = createShapeFromSprite;
const moxi_entity_1 = __webpack_require__(/*! ../../core/moxi-entity */ "./src/core/moxi-entity.ts");
const physics_body_logic_1 = __webpack_require__(/*! ./physics-body-logic */ "./src/library/physics/physics-body-logic.ts");
function asPhysicsEntity(pixiObject, world, options = {}) {
    const entity = (0, moxi_entity_1.asEntity)(pixiObject);
    const physicsLogic = new physics_body_logic_1.PhysicsBodyLogic(world, options);
    entity.moxiEntity.addLogic(physicsLogic);
    return entity;
}
function hasPhysics(entity) {
    if (!entity.moxiEntity)
        return false;
    return entity.moxiEntity.getLogic('PhysicsBodyLogic') !== undefined;
}
function getPhysicsBody(entity) {
    if (!entity.moxiEntity)
        return undefined;
    return entity.moxiEntity.getLogic('PhysicsBodyLogic');
}
function createShapeFromSprite(sprite, type = 'auto') {
    const bounds = sprite.getLocalBounds();
    if (type === 'auto') {
        const ratio = bounds.width / bounds.height;
        type = (ratio > 0.8 && ratio < 1.2) ? 'circle' : 'rectangle';
    }
    if (type === 'circle') {
        return {
            shape: 'circle',
            radius: Math.max(bounds.width, bounds.height) / 2
        };
    }
    else {
        return {
            shape: 'rectangle',
            width: bounds.width,
            height: bounds.height
        };
    }
}


/***/ }),

/***/ "./src/library/physics/physics-world.ts":
/*!**********************************************!*\
  !*** ./src/library/physics/physics-world.ts ***!
  \**********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsWorld = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const physics_collision_1 = __webpack_require__(/*! ./physics-collision */ "./src/library/physics/physics-collision.ts");
const physics_debug_renderer_1 = __webpack_require__(/*! ./physics-debug-renderer */ "./src/library/physics/physics-debug-renderer.ts");
const moxi_entity_1 = __webpack_require__(/*! ../../core/moxi-entity */ "./src/core/moxi-entity.ts");
const physics_graphics_parser_1 = __webpack_require__(/*! ./physics-graphics-parser */ "./src/library/physics/physics-graphics-parser.ts");
class PhysicsWorld {
    world;
    pixelsPerMeter = 30;
    timestep = 1 / 60;
    collisionRegistry;
    collisionManager;
    velocityIterations = 8;
    positionIterations = 3;
    accumulator = 0;
    bodies = new Map();
    debugRenderer;
    debugGraphics;
    constructor(options = {}) {
        (0, physics_graphics_parser_1.initGraphicsPhysicsTracking)();
        const { gravity = { x: 0, y: 9.8 }, pixelsPerMeter = 30, velocityIterations = 8, positionIterations = 3, enableSleeping = true, timestep = 1 / 60 } = options;
        this.pixelsPerMeter = pixelsPerMeter;
        this.velocityIterations = velocityIterations;
        this.positionIterations = positionIterations;
        this.timestep = timestep;
        this.world = planck.World({
            gravity: planck.Vec2(gravity.x, gravity.y)
        });
        this.world.setAllowSleeping(enableSleeping);
        this.collisionRegistry = new physics_collision_1.CollisionRegistry();
        this.collisionManager = new physics_collision_1.CollisionManager(this, this.collisionRegistry);
    }
    step(deltaTime) {
        this.accumulator += deltaTime;
        while (this.accumulator >= this.timestep) {
            this.world.step(this.timestep, this.velocityIterations, this.positionIterations);
            this.accumulator -= this.timestep;
        }
    }
    createBody(def) {
        return this.world.createBody(def);
    }
    destroyBody(body) {
        this.bodies.delete(body);
        this.world.destroyBody(body);
    }
    registerBody(body, logic) {
        this.bodies.set(body, logic);
    }
    getBodyLogic(body) {
        return this.bodies.get(body);
    }
    raycast(from, to, callback) {
        const p1 = this.toPhysicsPoint(from);
        const p2 = this.toPhysicsPoint(to);
        this.world.rayCast(p1, p2, (fixture, point, normal, fraction) => {
            const pixelPoint = this.toPixelsPoint(point);
            const pixelNormal = new PIXI.Point(normal.x, normal.y);
            return callback(fixture, pixelPoint, pixelNormal, fraction);
        });
    }
    queryAABB(bounds, callback) {
        const lowerBound = this.toPhysicsPoint(new PIXI.Point(bounds.x, bounds.y));
        const upperBound = this.toPhysicsPoint(new PIXI.Point(bounds.x + bounds.width, bounds.y + bounds.height));
        this.world.queryAABB(planck.AABB(lowerBound, upperBound), (fixture) => {
            return callback(fixture.getBody());
        });
    }
    queryPoint(point, callback) {
        const physicsPoint = this.toPhysicsPoint(point);
        this.world.queryAABB(planck.AABB(planck.Vec2(physicsPoint.x - 0.001, physicsPoint.y - 0.001), planck.Vec2(physicsPoint.x + 0.001, physicsPoint.y + 0.001)), (fixture) => {
            if (fixture.testPoint(physicsPoint)) {
                return callback(fixture);
            }
            return true;
        });
    }
    toPhysics(pixels) {
        return pixels / this.pixelsPerMeter;
    }
    toPixels(meters) {
        return meters * this.pixelsPerMeter;
    }
    toPhysicsPoint(point) {
        return planck.Vec2(this.toPhysics(point.x), this.toPhysics(point.y));
    }
    toPixelsPoint(vec) {
        return new PIXI.Point(this.toPixels(vec.x), this.toPixels(vec.y));
    }
    enableDebugRenderer(scene, options = {}) {
        if (this.debugRenderer) {
            this.disableDebugRenderer();
        }
        this.debugGraphics = new PIXI.Graphics();
        this.debugRenderer = new physics_debug_renderer_1.PhysicsDebugRenderer(this, options);
        const debugEntity = (0, moxi_entity_1.asEntity)(this.debugGraphics);
        debugEntity.moxiEntity.addLogic(this.debugRenderer);
        debugEntity.zIndex = 10000;
        scene.sortableChildren = true;
        scene.addChild(debugEntity);
        console.log('Physics debug renderer enabled. Press "P" to toggle visibility.');
        return this.debugRenderer;
    }
    disableDebugRenderer() {
        if (this.debugRenderer && this.debugGraphics) {
            if (this.debugGraphics.parent) {
                this.debugGraphics.parent.removeChild(this.debugGraphics);
            }
            this.debugGraphics.destroy();
            this.debugGraphics = undefined;
            this.debugRenderer = undefined;
        }
    }
    getDebugRenderer() {
        return this.debugRenderer;
    }
    getBodies() {
        const bodies = [];
        for (let body = this.world.getBodyList(); body; body = body.getNext()) {
            bodies.push(body);
        }
        return bodies;
    }
    destroy() {
        const bodies = this.getBodies();
        bodies.forEach(body => this.world.destroyBody(body));
        this.bodies.clear();
        this.debugRenderer = undefined;
    }
}
exports.PhysicsWorld = PhysicsWorld;


/***/ }),

/***/ "./src/library/resize-handler.ts":
/*!***************************************!*\
  !*** ./src/library/resize-handler.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createResizeHandler = createResizeHandler;
exports.setupResponsiveCanvas = setupResponsiveCanvas;
const DEFAULT_ROOT_STYLES = {
    display: 'flex',
    justifyContent: 'center',
    alignItems: 'center',
    overflow: 'hidden'
};
const PIXEL_ART_CANVAS_STYLES = {
    imageRendering: 'pixelated'
};
function createResizeHandler(options) {
    const { rootElement, width, height, rootStyles = DEFAULT_ROOT_STYLES, canvasStyles = {}, pixelArtMode = false } = options;
    Object.entries(rootStyles).forEach(([key, value]) => {
        rootElement.style.setProperty(key, value);
    });
    const finalCanvasStyles = pixelArtMode
        ? { ...PIXEL_ART_CANVAS_STYLES, ...canvasStyles }
        : canvasStyles;
    return () => {
        const parentWidth = rootElement.clientWidth;
        const parentHeight = rootElement.clientHeight;
        const ratio = Math.min(parentWidth / width, parentHeight / height);
        if (rootElement.firstElementChild instanceof HTMLCanvasElement) {
            const canvas = rootElement.firstElementChild;
            canvas.style.width = `${Math.round(width * ratio)}px`;
            canvas.style.height = `${Math.round(height * ratio)}px`;
            canvas.style.display = 'block';
            Object.entries(finalCanvasStyles).forEach(([key, value]) => {
                canvas.style.setProperty(key, value);
            });
        }
    };
}
function setupResponsiveCanvas(options) {
    const resizeHandler = createResizeHandler(options);
    resizeHandler();
    window.addEventListener('resize', resizeHandler);
    return () => {
        window.removeEventListener('resize', resizeHandler);
    };
}


/***/ }),

/***/ "./src/library/setup.ts":
/*!******************************!*\
  !*** ./src/library/setup.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.defaultRenderOptions = void 0;
exports.setupMoxi = setupMoxi;
const asset_loader_1 = __webpack_require__(/*! ../core/asset-loader */ "./src/core/asset-loader.ts");
const camera_1 = __webpack_require__(/*! ../core/camera */ "./src/core/camera.ts");
const engine_1 = __webpack_require__(/*! ../core/engine */ "./src/core/engine.ts");
const render_manager_1 = __webpack_require__(/*! ../core/render-manager */ "./src/core/render-manager.ts");
const scene_1 = __webpack_require__(/*! ../core/scene */ "./src/core/scene.ts");
const physics_1 = __webpack_require__(/*! ./physics */ "./src/library/physics/index.ts");
const loading_scene_1 = __webpack_require__(/*! ./loading-scene */ "./src/library/loading-scene.ts");
exports.defaultRenderOptions = {
    width: 1280,
    height: 720,
    backgroundColor: 0x1099bb,
    resolution: window.devicePixelRatio || 1,
    autoDensity: true,
    antialias: true
};
async function setupMoxi({ hostElement, renderOptions = exports.defaultRenderOptions, physics, showLoadingScene = false, loadingSceneOptions = {}, pixelPerfect } = {}) {
    let finalRenderOptions = { ...renderOptions };
    let applyImageRendering = false;
    if (pixelPerfect) {
        const ppOptions = typeof pixelPerfect === 'boolean'
            ? { enabled: true, imageRendering: true }
            : pixelPerfect;
        if (ppOptions.enabled !== false) {
            finalRenderOptions = {
                ...finalRenderOptions,
                resolution: 1,
                antialias: false,
                roundPixels: true
            };
        }
        applyImageRendering = ppOptions.imageRendering !== false;
    }
    const { renderer } = await render_manager_1.RenderManager.create(hostElement, finalRenderOptions);
    if (applyImageRendering) {
        const canvas = renderer.canvas;
        canvas.style.imageRendering = 'pixelated';
        canvas.style.imageRendering = '-moz-crisp-edges';
        canvas.style.imageRendering = 'crisp-edges';
    }
    const scene = new scene_1.Scene(renderer);
    const engine = new engine_1.Engine(scene);
    const assetLoader = new asset_loader_1.AssetLoader();
    const { PIXIAssets, loadAssets } = assetLoader;
    const camera = new camera_1.Camera(scene, renderer);
    let physicsWorld;
    if (physics) {
        const physicsOptions = typeof physics === 'boolean'
            ? {}
            : physics;
        physicsWorld = new physics_1.PhysicsWorld(physicsOptions);
        engine.addPhysicsWorld(physicsWorld);
    }
    let loadingScene;
    if (showLoadingScene) {
        loadingScene = new loading_scene_1.LoadingScene(loadingSceneOptions);
        loadingScene.zIndex = 10000;
        loadingScene.init(renderer);
        scene.addChild(loadingScene);
        loadingScene.hide();
        assetLoader.on('loading:start', () => {
            if (loadingScene) {
                loadingScene.show();
            }
        });
        assetLoader.on('loading:end', () => {
            if (loadingScene) {
                loadingScene.hide();
            }
        });
    }
    return {
        scene,
        engine,
        PIXIAssets,
        renderer,
        loadAssets,
        camera,
        physicsWorld,
        loadingScene
    };
}


/***/ }),

/***/ "./src/library/state-logic.ts":
/*!************************************!*\
  !*** ./src/library/state-logic.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.StateLogic = void 0;
const logic_1 = __webpack_require__(/*! ../core/logic */ "./src/core/logic.ts");
class StateLogic extends logic_1.Logic {
    _entity;
    constructor(name) {
        super();
        this.name = name;
    }
    get entity() {
        return this._entity;
    }
    init(entity, renderer) {
        this._entity = entity;
        super.init(entity, renderer);
    }
    onEnter(state) {
    }
    onExit(state) {
    }
    update(entity, deltaTime) {
    }
}
exports.StateLogic = StateLogic;


/***/ }),

/***/ "./src/library/state-machine.ts":
/*!**************************************!*\
  !*** ./src/library/state-machine.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.StateMachine = void 0;
class StateMachine extends EventTarget {
    _states = {};
    _currentState = null;
    _currentStateName = null;
    constructor(states = {}) {
        super();
        this._states = states;
    }
    update(deltaTime) {
        if (this._currentState) {
            this._currentState.update(this._currentState.entity, deltaTime);
        }
    }
    setState(stateName) {
        const nextState = this._states[stateName];
        if (!nextState)
            return;
        const prevStateName = this._currentStateName;
        if (this._currentState) {
            this._currentState.onExit(stateName);
        }
        this._currentState = this._states[stateName];
        this._currentStateName = stateName;
        this._currentState.onEnter(stateName);
        const event = new CustomEvent('stateChange', {
            detail: {
                prevState: prevStateName,
                newState: stateName
            }
        });
        this.dispatchEvent(event);
    }
    addState(state) {
        this._states[state.name] = state;
    }
    get currentState() {
        return this._currentStateName;
    }
}
exports.StateMachine = StateMachine;


/***/ }),

/***/ "./src/library/svg-utils/svg-to-texture.ts":
/*!*************************************************!*\
  !*** ./src/library/svg-utils/svg-to-texture.ts ***!
  \*************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.svgToTexture = svgToTexture;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
async function svgToTexture(options) {
    const { svgString, width, height, color = 0x000000 } = options;
    const colorHex = '#' + color.toString(16).padStart(6, '0');
    const processedSVG = svgString.replace(/currentColor/g, colorHex);
    const blob = new Blob([processedSVG], { type: 'image/svg+xml' });
    const url = URL.createObjectURL(blob);
    const img = new Image();
    img.width = width;
    img.height = height;
    await new Promise((resolve, reject) => {
        img.onload = () => resolve();
        img.onerror = reject;
        img.src = url;
    });
    const canvas = document.createElement('canvas');
    canvas.width = width;
    canvas.height = height;
    const ctx = canvas.getContext('2d');
    if (!ctx) {
        URL.revokeObjectURL(url);
        throw new Error('Failed to get canvas context');
    }
    ctx.drawImage(img, 0, 0, width, height);
    URL.revokeObjectURL(url);
    const texture = PIXI.Texture.from(canvas);
    texture.source.scaleMode = 'linear';
    return texture;
}


/***/ }),

/***/ "./src/library/texture-frame-sequences.ts":
/*!************************************************!*\
  !*** ./src/library/texture-frame-sequences.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.TextureFrameSequences = void 0;
class TextureFrameSequences {
    frames = [];
    sequences = {};
    constructor(frames, sequences = {}) {
        this.frames = frames;
        this.sequences = sequences;
    }
    addSequence(name, frameIndices, animationSpeed = 1) {
        this.sequences[name] = {
            frames: frameIndices,
            animationSpeed
        };
    }
    getSequence(name) {
        return this.sequences[name] || null;
    }
    getFrame(index) {
        return this.frames[index] || null;
    }
    getFrameFromSequence(sequenceName, frameIndex) {
        const sequence = this.getSequence(sequenceName);
        if (!sequence)
            return null;
        const sequenceFrameIndex = sequence.frames[frameIndex % sequence.frames.length];
        return this.frames[sequenceFrameIndex] || null;
    }
    getFrameSequence(name) {
        const sequence = this.getSequence(name);
        if (!sequence)
            return [];
        return sequence.frames.map(index => this.frames[index]).filter(Boolean);
    }
}
exports.TextureFrameSequences = TextureFrameSequences;


/***/ }),

/***/ "./src/library/texture-frames.ts":
/*!***************************************!*\
  !*** ./src/library/texture-frames.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asTextureFrames = asTextureFrames;
const defaultOptions = {
    frameWidth: 48,
    frameHeight: 48,
    columns: 4,
    rows: 4
};
function asTextureFrames(PIXI, textureSource, options = defaultOptions) {
    const { frameWidth, frameHeight, columns, rows } = options;
    const frames = [];
    if (!textureSource) {
        console.error('Invalid texture source provided to asTextureFrames');
        return frames;
    }
    for (let y = 0; y < rows; y++) {
        for (let x = 0; x < columns; x++) {
            const frame = new PIXI.Rectangle(x * frameWidth, y * frameHeight, frameWidth, frameHeight);
            const frametexture = new PIXI.Texture({
                source: textureSource,
                frame: frame,
            });
            frames.push(frametexture);
        }
    }
    return frames;
}


/***/ }),

/***/ "./src/library/utils.ts":
/*!******************************!*\
  !*** ./src/library/utils.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.deg2rad = exports.rad2deg = exports.fetchXml = exports.lerp = exports.roundTo = exports.getRandomInt = exports.pr = exports.padRight = exports.lc = exports.uc = exports.ONE_POINT = exports.ZERO_POINT = exports.createPoint = void 0;
exports.metersToPixels = metersToPixels;
exports.pixelsToMeters = pixelsToMeters;
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
const createPoint = (x = 0, y = 0) => new pixi_js_1.Point(x, y);
exports.createPoint = createPoint;
const ZERO_POINT = () => new pixi_js_1.Point(0, 0);
exports.ZERO_POINT = ZERO_POINT;
const ONE_POINT = () => new pixi_js_1.Point(1, 1);
exports.ONE_POINT = ONE_POINT;
const uc = (s = '') => s.toUpperCase();
exports.uc = uc;
const lc = (s = '') => s.toLowerCase();
exports.lc = lc;
const padRight = (val = '', length = 0, padWith = ' ') => {
    let result = val + '';
    while (result.length < length) {
        result += padWith;
    }
    return result;
};
exports.padRight = padRight;
exports.pr = exports.padRight;
const getRandomInt = (min, max) => (Math.floor(Math.random() * (max + 1 - min)) + min);
exports.getRandomInt = getRandomInt;
const roundTo = (places, value) => (Math.round(value * Math.pow(10, places)) / Math.pow(10, places));
exports.roundTo = roundTo;
const lerp = (begin, end, mag) => ((1 - mag) * begin + mag * end);
exports.lerp = lerp;
function metersToPixels(m) { return m * 20; }
function pixelsToMeters(p) { return p * 0.05; }
const fetchXml = async (url) => (await (await fetch(url)).text());
exports.fetchXml = fetchXml;
const rad2deg = (rad) => rad * (180 / Math.PI);
exports.rad2deg = rad2deg;
const deg2rad = (deg) => deg * (Math.PI / 180);
exports.deg2rad = deg2rad;


/***/ }),

/***/ "./src/ui/UILayer.ts":
/*!***************************!*\
  !*** ./src/ui/UILayer.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UILayer = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const UIScaleMode_1 = __webpack_require__(/*! ./UIScaleMode */ "./src/ui/UIScaleMode.ts");
class UILayer extends PIXI.Container {
    scaleMode;
    targetWidth;
    targetHeight;
    initialBoundsRecorded = false;
    constructor(options = {}) {
        super();
        this.scaleMode = options.scaleMode ?? UIScaleMode_1.UIScaleMode.None;
        this.targetWidth = options.targetWidth;
        this.targetHeight = options.targetHeight;
    }
    updateScale(canvasWidth, canvasHeight) {
        if (this.scaleMode === UIScaleMode_1.UIScaleMode.None) {
            this.scale.set(1, 1);
            return;
        }
        if (!this.initialBoundsRecorded && this.children.length > 0) {
            if (!this.targetWidth || !this.targetHeight) {
                const bounds = this.getLocalBounds();
                this.targetWidth = this.targetWidth ?? bounds.width;
                this.targetHeight = this.targetHeight ?? bounds.height;
            }
            this.initialBoundsRecorded = true;
        }
        if (!this.targetWidth || !this.targetHeight) {
            return;
        }
        const scaleX = canvasWidth / this.targetWidth;
        const scaleY = canvasHeight / this.targetHeight;
        switch (this.scaleMode) {
            case UIScaleMode_1.UIScaleMode.ScaleUI:
                this.scale.set(scaleX, scaleY);
                break;
            case UIScaleMode_1.UIScaleMode.LockRatio:
                const scale = Math.min(scaleX, scaleY);
                this.scale.set(scale, scale);
                this.position.set((canvasWidth - this.targetWidth * scale) / 2, (canvasHeight - this.targetHeight * scale) / 2);
                break;
        }
    }
    addChild(...children) {
        const result = super.addChild(...children);
        this.initialBoundsRecorded = false;
        return result;
    }
}
exports.UILayer = UILayer;


/***/ }),

/***/ "./src/ui/UIScaleMode.ts":
/*!*******************************!*\
  !*** ./src/ui/UIScaleMode.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIScaleMode = void 0;
var UIScaleMode;
(function (UIScaleMode) {
    UIScaleMode["None"] = "none";
    UIScaleMode["ScaleUI"] = "scaleUI";
    UIScaleMode["LockRatio"] = "lockRatio";
})(UIScaleMode || (exports.UIScaleMode = UIScaleMode = {}));


/***/ }),

/***/ "./src/ui/components/button-background-strategy.ts":
/*!*********************************************************!*\
  !*** ./src/ui/components/button-background-strategy.ts ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.SpriteBackgroundStrategy = exports.SolidColorBackgroundStrategy = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_button_1 = __webpack_require__(/*! ./ui-button */ "./src/ui/components/ui-button.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
class SolidColorBackgroundStrategy {
    panel;
    normalColor;
    hoverColor;
    pressedColor;
    disabledColor;
    width;
    height;
    borderRadius;
    constructor(backgroundColor, width, height, borderRadius) {
        this.normalColor = backgroundColor;
        this.hoverColor = this.darkenColor(backgroundColor, 0.9);
        this.pressedColor = this.darkenColor(backgroundColor, 0.8);
        this.disabledColor = 0x888888;
        this.width = width;
        this.height = height;
        this.borderRadius = borderRadius;
    }
    create(width, height) {
        this.panel = new ui_panel_1.UIPanel({
            backgroundColor: this.normalColor,
            width,
            height,
            borderRadius: this.borderRadius
        });
        this.panel.layout(width, height);
        return this.panel.container;
    }
    updateState(state) {
        if (!this.panel)
            return;
        let color;
        switch (state) {
            case ui_button_1.ButtonState.Normal:
                color = this.normalColor;
                break;
            case ui_button_1.ButtonState.Hover:
                color = this.hoverColor;
                break;
            case ui_button_1.ButtonState.Pressed:
                color = this.pressedColor;
                break;
            case ui_button_1.ButtonState.Disabled:
                color = this.disabledColor;
                break;
        }
        this.panel.setBackgroundColor(color);
    }
    getActualHeight() {
        return this.height;
    }
    destroy() {
    }
    darkenColor(color, factor) {
        const r = ((color >> 16) & 0xff) * factor;
        const g = ((color >> 8) & 0xff) * factor;
        const b = (color & 0xff) * factor;
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
}
exports.SolidColorBackgroundStrategy = SolidColorBackgroundStrategy;
class SpriteBackgroundStrategy {
    container;
    spriteLeft;
    spriteMid;
    spriteRight;
    nineSliceSprite;
    nineSliceSpritePressed;
    iconSprite;
    config;
    width;
    height;
    constructor(config, width, height) {
        this.config = config;
        this.width = width;
        this.height = height;
    }
    create(width, height) {
        this.container = new pixi_js_1.default.Container();
        const { spritesheet, texturePattern, color, pixelPerfect, useNineSlice, nineSliceBorders, pressedTexturePattern, icon } = this.config;
        if (pixelPerfect && spritesheet.textureSource) {
            spritesheet.textureSource.scaleMode = 'nearest';
        }
        if (useNineSlice && nineSliceBorders) {
            const textureName = texturePattern.includes('{color}')
                ? texturePattern.replace('{color}', color)
                : texturePattern;
            const texture = spritesheet.textures[textureName];
            this.nineSliceSprite = new pixi_js_1.default.NineSliceSprite({
                texture,
                leftWidth: nineSliceBorders.left,
                topHeight: nineSliceBorders.top,
                rightWidth: nineSliceBorders.right,
                bottomHeight: nineSliceBorders.bottom,
                width,
                height
            });
            this.container.addChild(this.nineSliceSprite);
            if (pressedTexturePattern) {
                const pressedTextureName = pressedTexturePattern.includes('{color}')
                    ? pressedTexturePattern.replace('{color}', color)
                    : pressedTexturePattern;
                const pressedTexture = spritesheet.textures[pressedTextureName];
                this.nineSliceSpritePressed = new pixi_js_1.default.NineSliceSprite({
                    texture: pressedTexture,
                    leftWidth: nineSliceBorders.left,
                    topHeight: nineSliceBorders.top,
                    rightWidth: nineSliceBorders.right,
                    bottomHeight: nineSliceBorders.bottom,
                    width,
                    height
                });
                this.nineSliceSpritePressed.y = 4;
                this.nineSliceSpritePressed.visible = false;
                this.container.addChild(this.nineSliceSpritePressed);
            }
        }
        else {
            const leftTextureName = this.getTextureName(texturePattern, color, 'left');
            const midTextureName = this.getTextureName(texturePattern, color, 'mid');
            const rightTextureName = this.getTextureName(texturePattern, color, 'right');
            this.spriteLeft = new pixi_js_1.default.Sprite(spritesheet.textures[leftTextureName]);
            this.spriteMid = new pixi_js_1.default.Sprite(spritesheet.textures[midTextureName]);
            this.spriteRight = new pixi_js_1.default.Sprite(spritesheet.textures[rightTextureName]);
            const scaleY = height / this.spriteLeft.height;
            this.spriteLeft.scale.y = scaleY;
            this.spriteMid.scale.y = scaleY;
            this.spriteRight.scale.y = scaleY;
            this.spriteLeft.x = 0;
            const middleWidth = width - this.spriteLeft.width - this.spriteRight.width;
            this.spriteMid.width = middleWidth;
            this.spriteMid.x = this.spriteLeft.width;
            this.spriteRight.x = this.spriteLeft.width + middleWidth;
            this.container.addChild(this.spriteLeft);
            this.container.addChild(this.spriteMid);
            this.container.addChild(this.spriteRight);
        }
        if (icon) {
            const iconTexture = icon.spritesheet.textures[icon.textureName];
            this.iconSprite = new pixi_js_1.default.Sprite(iconTexture);
            if (icon.pixelPerfect && icon.spritesheet.textureSource) {
                icon.spritesheet.textureSource.scaleMode = 'nearest';
            }
            if (icon.scale) {
                this.iconSprite.scale.set(icon.scale);
            }
            this.iconSprite.anchor.set(0.5);
            this.iconSprite.x = width / 2;
            this.iconSprite.y = height / 2;
            this.container.addChild(this.iconSprite);
        }
        return this.container;
    }
    updateState(state) {
        if (this.nineSliceSprite && this.nineSliceSpritePressed) {
            const isPressed = state === ui_button_1.ButtonState.Pressed;
            this.nineSliceSprite.visible = !isPressed;
            this.nineSliceSpritePressed.visible = isPressed;
            if (this.iconSprite) {
                this.iconSprite.y = (this.height / 2) + (isPressed ? 4 : 0);
            }
        }
        else {
            let tint;
            switch (state) {
                case ui_button_1.ButtonState.Normal:
                    tint = 0xffffff;
                    break;
                case ui_button_1.ButtonState.Hover:
                    tint = 0xcccccc;
                    break;
                case ui_button_1.ButtonState.Pressed:
                    tint = 0x999999;
                    break;
                case ui_button_1.ButtonState.Disabled:
                    tint = 0x888888;
                    break;
            }
            if (this.nineSliceSprite) {
                this.nineSliceSprite.tint = tint;
            }
            else if (this.spriteLeft && this.spriteMid && this.spriteRight) {
                this.spriteLeft.tint = tint;
                this.spriteMid.tint = tint;
                this.spriteRight.tint = tint;
            }
        }
    }
    getActualHeight() {
        if (this.nineSliceSprite) {
            return this.nineSliceSprite.height;
        }
        return this.spriteLeft?.height ?? this.height;
    }
    destroy() {
        this.container?.destroy({ children: true });
    }
    getTextureName(pattern, color, part) {
        let name = pattern.replace('{color}', color);
        name = name.replace(/_(?:left|mid|right)\.png$/, `_${part}.png`);
        return name;
    }
}
exports.SpriteBackgroundStrategy = SpriteBackgroundStrategy;


/***/ }),

/***/ "./src/ui/components/ui-box.ts":
/*!*************************************!*\
  !*** ./src/ui/components/ui-box.ts ***!
  \*************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIBox = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UIBox extends ui_component_1.UIComponent {
    props;
    graphics;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            backgroundColor: 0x000000,
            backgroundAlpha: 1,
            borderWidth: 0,
            borderRadius: 0,
            ...props
        };
        this.graphics = new pixi_js_1.default.Graphics();
        this.container.addChild(this.graphics);
        if (props.width !== undefined) {
            this.boxModel.width = props.width;
        }
        if (props.height !== undefined) {
            this.boxModel.height = props.height;
        }
    }
    measure() {
        const padding = this.boxModel.padding;
        const border = this.boxModel.border;
        let contentWidth = 0;
        let contentHeight = 0;
        if (typeof this.boxModel.width === 'number') {
            contentWidth = this.boxModel.width;
        }
        else if (this.props.width !== undefined) {
            contentWidth = this.props.width;
        }
        if (typeof this.boxModel.height === 'number') {
            contentHeight = this.boxModel.height;
        }
        else if (this.props.height !== undefined) {
            contentHeight = this.props.height;
        }
        const totalWidth = contentWidth + padding.horizontal + (border?.horizontal ?? 0);
        const totalHeight = contentHeight + padding.vertical + (border?.vertical ?? 0);
        return {
            width: Math.max(totalWidth, this.boxModel.minWidth ?? 0),
            height: Math.max(totalHeight, this.boxModel.minHeight ?? 0)
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        const padding = this.boxModel.padding;
        const border = this.boxModel.border ?? { horizontal: 0, vertical: 0, top: 0, right: 0, bottom: 0, left: 0 };
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        if (this.boxModel.maxWidth !== undefined) {
            finalWidth = Math.min(finalWidth, this.boxModel.maxWidth);
        }
        if (this.boxModel.maxHeight !== undefined) {
            finalHeight = Math.min(finalHeight, this.boxModel.maxHeight);
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left + border.left;
        this.computedLayout.contentY = padding.top + border.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal - border.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical - border.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        this.graphics.clear();
        const { width, height } = this.computedLayout;
        const { backgroundColor, backgroundAlpha, borderColor, borderWidth, borderRadius } = this.props;
        if (borderWidth && borderWidth > 0 && borderColor !== undefined) {
            this.graphics.rect(0, 0, width, height);
            this.graphics.stroke({ color: borderColor, width: borderWidth });
        }
        if (backgroundColor !== undefined) {
            if (borderRadius && borderRadius > 0) {
                this.graphics.roundRect(0, 0, width, height, borderRadius);
            }
            else {
                this.graphics.rect(0, 0, width, height);
            }
            this.graphics.fill({ color: backgroundColor, alpha: backgroundAlpha });
        }
    }
    setBackgroundColor(color, alpha = 1) {
        this.props.backgroundColor = color;
        this.props.backgroundAlpha = alpha;
        this.render();
    }
    setBorder(color, width) {
        this.props.borderColor = color;
        this.props.borderWidth = width;
        this.render();
    }
}
exports.UIBox = UIBox;


/***/ }),

/***/ "./src/ui/components/ui-button.ts":
/*!****************************************!*\
  !*** ./src/ui/components/ui-button.ts ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIButton = exports.ButtonState = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
const button_background_strategy_1 = __webpack_require__(/*! ./button-background-strategy */ "./src/ui/components/button-background-strategy.ts");
var ButtonState;
(function (ButtonState) {
    ButtonState["Normal"] = "normal";
    ButtonState["Hover"] = "hover";
    ButtonState["Pressed"] = "pressed";
    ButtonState["Disabled"] = "disabled";
})(ButtonState || (exports.ButtonState = ButtonState = {}));
class UIButton extends ui_component_1.UIComponent {
    props;
    useBitmapText;
    bitmapFontFamily;
    onClick;
    onHover;
    state = ButtonState.Normal;
    backgroundStrategy;
    label;
    bitmapLabel;
    labelCenterX = 0;
    labelCenterY = 0;
    keydownHandler;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            label: props.label ?? '',
            width: props.width ?? 120,
            height: props.height ?? 40,
            backgroundColor: props.backgroundColor ?? 0x4a90e2,
            textColor: props.textColor ?? 0xffffff,
            fontSize: props.fontSize ?? 16,
            borderRadius: props.borderRadius ?? 4,
            padding: props.padding ?? edge_insets_1.EdgeInsets.symmetric(8, 16),
            enabled: props.enabled ?? true
        };
        this.useBitmapText = props.useBitmapText ?? false;
        this.bitmapFontFamily = props.bitmapFontFamily;
        this.onClick = props.onClick;
        this.onHover = props.onHover;
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.tabIndex = 0;
        if (props.spriteBackground) {
            this.backgroundStrategy = new button_background_strategy_1.SpriteBackgroundStrategy(props.spriteBackground, this.props.width, this.props.height);
        }
        else {
            this.backgroundStrategy = new button_background_strategy_1.SolidColorBackgroundStrategy(this.props.backgroundColor, this.props.width, this.props.height, this.props.borderRadius);
        }
        const backgroundContainer = this.backgroundStrategy.create(this.props.width, this.props.height);
        this.container.addChild(backgroundContainer);
        if (this.props.label) {
            if (this.useBitmapText && this.bitmapFontFamily) {
                this.createBitmapLabel();
            }
            else {
                this.label = new ui_label_1.UILabel({
                    text: this.props.label,
                    fontSize: this.props.fontSize,
                    color: this.props.textColor,
                    align: 'center'
                }, {
                    padding: edge_insets_1.EdgeInsets.zero()
                });
                this.container.addChild(this.label.container);
            }
        }
        this.setupInteractivity();
        if (!this.props.enabled) {
            this.setState(ButtonState.Disabled);
        }
    }
    createBitmapLabel() {
        if (!this.bitmapFontFamily)
            return;
        this.bitmapLabel = new pixi_js_1.default.BitmapText({
            text: this.props.label,
            style: {
                fontFamily: this.bitmapFontFamily,
                fontSize: this.props.fontSize,
                fill: this.props.textColor
            }
        });
        this.container.addChild(this.bitmapLabel);
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'pointer';
        this.container.on('pointerover', this.handlePointerOver.bind(this));
        this.container.on('pointerout', this.handlePointerOut.bind(this));
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        this.container.on('pointerup', this.handlePointerUp.bind(this));
        this.container.on('pointerupoutside', this.handlePointerUpOutside.bind(this));
        if (typeof window !== 'undefined') {
            this.keydownHandler = (e) => {
                if (this.isFocused() && this.props.enabled) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.setState(ButtonState.Pressed);
                        this.onClick?.();
                        setTimeout(() => {
                            if (this.props.enabled) {
                                this.setState(ButtonState.Normal);
                            }
                        }, 100);
                    }
                }
            };
            window.addEventListener('keydown', this.keydownHandler);
        }
    }
    handlePointerOver() {
        if (this.props.enabled && this.state === ButtonState.Normal) {
            this.setState(ButtonState.Hover);
            this.onHover?.();
        }
    }
    handlePointerOut() {
        if (this.props.enabled && this.state !== ButtonState.Pressed) {
            this.setState(ButtonState.Normal);
        }
    }
    handlePointerDown() {
        console.log('ðµ Button handlePointerDown called');
        console.log('  - enabled:', this.props.enabled);
        console.log('  - canFocus:', this.canFocus());
        console.log('  - tabIndex:', this.tabIndex);
        if (this.props.enabled) {
            this.setState(ButtonState.Pressed);
            if (this.canFocus()) {
                const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
                console.log('  - focusManager:', focusManager);
                if (focusManager) {
                    console.log('  - Calling requestFocus');
                    focusManager.requestFocus(this);
                }
                else {
                    console.log('  - No focus manager, calling onFocus directly');
                    this.onFocus();
                }
            }
            else {
                console.log('  - canFocus returned false, NOT focusing');
            }
        }
    }
    handlePointerUp() {
        if (this.props.enabled) {
            this.setState(ButtonState.Hover);
            this.onClick?.();
        }
    }
    handlePointerUpOutside() {
        if (this.props.enabled) {
            this.setState(ButtonState.Normal);
        }
    }
    setState(newState) {
        this.state = newState;
        this.updateVisuals();
    }
    updateVisuals() {
        this.backgroundStrategy.updateState(this.state);
        const yOffset = this.state === ButtonState.Pressed ? 2 : 0;
        if (this.state === ButtonState.Disabled) {
            this.container.cursor = 'default';
        }
        else {
            this.container.cursor = 'pointer';
        }
        if (this.label) {
            this.label.setPosition(this.labelCenterX, this.labelCenterY + yOffset);
        }
        else if (this.bitmapLabel) {
            this.bitmapLabel.x = this.labelCenterX;
            this.bitmapLabel.y = this.labelCenterY + yOffset;
        }
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        const actualHeight = this.backgroundStrategy.getActualHeight();
        if (this.label) {
            this.label.layout(measured.width, measured.height);
            const labelLayout = this.label.getLayout();
            this.labelCenterX = (measured.width - labelLayout.width) / 2;
            this.labelCenterY = (actualHeight - labelLayout.height) / 2;
            this.label.setPosition(this.labelCenterX, this.labelCenterY);
        }
        else if (this.bitmapLabel) {
            this.labelCenterX = (measured.width - this.bitmapLabel.width) / 2;
            this.labelCenterY = (actualHeight - this.bitmapLabel.height) / 2;
            this.bitmapLabel.x = this.labelCenterX;
            this.bitmapLabel.y = this.labelCenterY;
        }
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setLabel(text) {
        if (this.label) {
            this.label.setText(text);
            this.markLayoutDirty();
        }
        else if (this.bitmapLabel) {
            this.bitmapLabel.text = text;
            this.markLayoutDirty();
        }
    }
    setEnabled(enabled) {
        this.props.enabled = enabled;
        this.setState(enabled ? ButtonState.Normal : ButtonState.Disabled);
    }
    getState() {
        return this.state;
    }
    destroy() {
        if (typeof window !== 'undefined' && this.keydownHandler) {
            window.removeEventListener('keydown', this.keydownHandler);
        }
        super.destroy();
    }
}
exports.UIButton = UIButton;


/***/ }),

/***/ "./src/ui/components/ui-label.ts":
/*!***************************************!*\
  !*** ./src/ui/components/ui-label.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UILabel = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UILabel extends ui_component_1.UIComponent {
    props;
    textObject;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            text: props.text,
            fontSize: props.fontSize ?? 16,
            fontFamily: props.fontFamily ?? 'Arial',
            color: props.color ?? 0xffffff,
            align: props.align ?? 'left',
            wordWrap: props.wordWrap ?? false,
            wordWrapWidth: props.wordWrapWidth ?? 0,
            fontWeight: props.fontWeight ?? 'normal',
            lineHeight: props.lineHeight ?? 1.2
        };
        this.textObject = new pixi_js_1.default.Text({
            text: this.props.text,
            style: this.getTextStyle(),
            resolution: window.devicePixelRatio || 2
        });
        this.container.addChild(this.textObject);
    }
    getTextStyle() {
        const style = {
            fontFamily: this.props.fontFamily,
            fontSize: this.props.fontSize,
            fill: this.props.color,
            align: this.props.align,
            fontWeight: this.props.fontWeight,
            lineHeight: this.props.fontSize * this.props.lineHeight
        };
        if (this.props.wordWrap) {
            style.wordWrap = true;
            style.wordWrapWidth = this.props.wordWrapWidth;
        }
        return style;
    }
    measure() {
        const padding = this.boxModel.padding;
        const metrics = this.textObject;
        const textWidth = metrics.width;
        const textHeight = metrics.height;
        return {
            width: textWidth + padding.horizontal,
            height: textHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const padding = this.boxModel.padding;
        if (this.props.wordWrap && this.props.wordWrapWidth === 0) {
            const wrapWidth = availableWidth - padding.horizontal;
            this.props.wordWrapWidth = wrapWidth;
            this.textObject.style = this.getTextStyle();
        }
        const measured = this.measure();
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        else if (typeof this.boxModel.width === 'number') {
            finalWidth = this.boxModel.width + padding.horizontal;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        else if (typeof this.boxModel.height === 'number') {
            finalHeight = this.boxModel.height + padding.vertical;
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        const padding = this.boxModel.padding;
        this.textObject.position.set(padding.left, padding.top);
    }
    setText(text) {
        this.props.text = text;
        this.textObject.text = text;
        this.markLayoutDirty();
    }
    setColor(color) {
        this.props.color = color;
        this.textObject.style.fill = color;
    }
    setFontSize(size) {
        this.props.fontSize = size;
        this.textObject.style.fontSize = size;
        this.markLayoutDirty();
    }
    getText() {
        return this.props.text;
    }
}
exports.UILabel = UILabel;


/***/ }),

/***/ "./src/ui/components/ui-panel.ts":
/*!***************************************!*\
  !*** ./src/ui/components/ui-panel.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIPanel = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UIPanel extends ui_component_1.UIComponent {
    props;
    background;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            backgroundAlpha: props.backgroundAlpha ?? 1,
            ...props
        };
        if (props.width !== undefined) {
            this.boxModel.width = props.width;
        }
        if (props.height !== undefined) {
            this.boxModel.height = props.height;
        }
        this.createBackground();
    }
    createBackground() {
        if (this.props.texture && this.props.nineSlice) {
            const { leftWidth, topHeight, rightWidth, bottomHeight } = this.props.nineSlice;
            this.background = new pixi_js_1.default.NineSliceSprite({
                texture: this.props.texture,
                leftWidth,
                topHeight,
                rightWidth,
                bottomHeight
            });
            this.background.alpha = this.props.backgroundAlpha ?? 1;
            this.container.addChild(this.background);
        }
        else if (this.props.backgroundColor !== undefined) {
            this.background = new pixi_js_1.default.Graphics();
            this.container.addChild(this.background);
        }
    }
    measure() {
        const padding = this.boxModel.padding;
        let contentWidth = 0;
        let contentHeight = 0;
        if (typeof this.boxModel.width === 'number') {
            contentWidth = this.boxModel.width;
        }
        else if (this.props.width !== undefined) {
            contentWidth = this.props.width;
        }
        if (typeof this.boxModel.height === 'number') {
            contentHeight = this.boxModel.height;
        }
        else if (this.props.height !== undefined) {
            contentHeight = this.props.height;
        }
        return {
            width: contentWidth + padding.horizontal,
            height: contentHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        const padding = this.boxModel.padding;
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        if (this.boxModel.maxWidth !== undefined) {
            finalWidth = Math.min(finalWidth, this.boxModel.maxWidth);
        }
        if (this.boxModel.maxHeight !== undefined) {
            finalHeight = Math.min(finalHeight, this.boxModel.maxHeight);
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        if (!this.background)
            return;
        const { width, height } = this.computedLayout;
        if (this.background instanceof pixi_js_1.default.NineSliceSprite) {
            this.background.width = width;
            this.background.height = height;
        }
        else if (this.background instanceof pixi_js_1.default.Graphics) {
            this.background.clear();
            if (this.props.borderRadius && this.props.borderRadius > 0) {
                this.background.roundRect(0, 0, width, height, this.props.borderRadius);
            }
            else {
                this.background.rect(0, 0, width, height);
            }
            if (this.props.backgroundColor !== undefined) {
                this.background.fill({
                    color: this.props.backgroundColor,
                    alpha: this.props.backgroundAlpha
                });
            }
        }
    }
    setBackgroundColor(color, alpha = 1) {
        if (this.background instanceof pixi_js_1.default.Graphics) {
            this.props.backgroundColor = color;
            this.props.backgroundAlpha = alpha;
            this.render();
        }
    }
    setTexture(texture) {
        if (this.background instanceof pixi_js_1.default.NineSliceSprite) {
            this.background.texture = texture;
        }
    }
}
exports.UIPanel = UIPanel;


/***/ }),

/***/ "./src/ui/components/ui-scroll-container.ts":
/*!**************************************************!*\
  !*** ./src/ui/components/ui-scroll-container.ts ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIScrollContainer = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
class UIScrollContainer extends ui_component_1.UIComponent {
    props;
    background;
    contentContainer;
    contentMask;
    scrollbarTrack;
    scrollbarThumb;
    children = [];
    scrollY = 0;
    maxScrollY = 0;
    contentHeight = 0;
    isDragging = false;
    dragStartY = 0;
    dragStartScrollY = 0;
    isHoveringThumb = false;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            width: props.width,
            height: props.height,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            borderRadius: props.borderRadius ?? 0,
            scrollbarWidth: props.scrollbarWidth ?? 12,
            scrollbarTrackColor: props.scrollbarTrackColor ?? 0xe0e0e0,
            scrollbarThumbColor: props.scrollbarThumbColor ?? 0x888888,
            scrollbarThumbHoverColor: props.scrollbarThumbHoverColor ?? 0x555555,
            scrollbarAutoHide: props.scrollbarAutoHide ?? false,
            padding: props.padding ?? edge_insets_1.EdgeInsets.all(0)
        };
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new pixi_js_1.default.Graphics();
        this.updateBackground();
        this.container.addChild(this.background);
        this.contentContainer = new pixi_js_1.default.Container();
        this.contentContainer.x = this.props.padding.left;
        this.contentContainer.y = this.props.padding.top;
        this.container.addChild(this.contentContainer);
        this.contentMask = new pixi_js_1.default.Graphics();
        this.updateMask();
        this.container.addChild(this.contentMask);
        this.contentContainer.mask = this.contentMask;
        this.scrollbarTrack = new pixi_js_1.default.Graphics();
        this.scrollbarTrack.eventMode = 'static';
        this.scrollbarTrack.cursor = 'pointer';
        this.container.addChild(this.scrollbarTrack);
        this.scrollbarThumb = new pixi_js_1.default.Graphics();
        this.scrollbarThumb.eventMode = 'static';
        this.scrollbarThumb.cursor = 'pointer';
        this.container.addChild(this.scrollbarThumb);
        this.setupInteractivity();
        this.updateScrollbar();
    }
    updateBackground() {
        this.background.clear();
        this.background.roundRect(0, 0, this.props.width, this.props.height, this.props.borderRadius);
        this.background.fill({ color: this.props.backgroundColor });
    }
    updateMask() {
        const contentWidth = this.props.width - this.props.padding.left - this.props.padding.right - this.props.scrollbarWidth;
        const contentHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        this.contentMask.clear();
        this.contentMask.rect(this.props.padding.left, this.props.padding.top, contentWidth, contentHeight);
        this.contentMask.fill({ color: 0xffffff });
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.on('wheel', this.handleWheel.bind(this));
        this.scrollbarThumb.on('pointerdown', this.handleThumbPointerDown.bind(this));
        this.scrollbarThumb.on('pointerover', () => {
            this.isHoveringThumb = true;
            this.updateScrollbar();
        });
        this.scrollbarThumb.on('pointerout', () => {
            if (!this.isDragging) {
                this.isHoveringThumb = false;
                this.updateScrollbar();
            }
        });
        this.scrollbarTrack.on('pointerdown', this.handleTrackPointerDown.bind(this));
        if (typeof window !== 'undefined') {
            window.addEventListener('pointermove', this.handleGlobalPointerMove.bind(this));
            window.addEventListener('pointerup', this.handleGlobalPointerUp.bind(this));
        }
    }
    handleWheel(e) {
        e.preventDefault();
        const delta = e.deltaY;
        this.scrollY += delta;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleThumbPointerDown(e) {
        this.isDragging = true;
        this.dragStartY = e.globalY;
        this.dragStartScrollY = this.scrollY;
        e.stopPropagation();
    }
    handleTrackPointerDown(e) {
        const localY = e.globalY - this.container.worldTransform.ty;
        const thumbHeight = this.getThumbHeight();
        const trackTop = 0;
        const trackBottom = this.props.height;
        const clickRatio = (localY - trackTop) / (trackBottom - trackTop);
        this.scrollY = clickRatio * this.maxScrollY;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleGlobalPointerMove(e) {
        if (!this.isDragging)
            return;
        const deltaY = e.clientY - this.dragStartY;
        const trackHeight = this.props.height;
        const thumbHeight = this.getThumbHeight();
        const scrollableTrackHeight = trackHeight - thumbHeight;
        if (scrollableTrackHeight <= 0)
            return;
        const scrollDelta = (deltaY / scrollableTrackHeight) * this.maxScrollY;
        this.scrollY = this.dragStartScrollY + scrollDelta;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleGlobalPointerUp() {
        if (this.isDragging) {
            this.isDragging = false;
            if (!this.isHoveringThumb) {
                this.updateScrollbar();
            }
        }
    }
    updateContentPosition() {
        this.contentContainer.y = this.props.padding.top - this.scrollY;
    }
    getThumbHeight() {
        if (this.contentHeight <= 0)
            return 0;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        const ratio = viewportHeight / this.contentHeight;
        const thumbHeight = Math.max(30, this.props.height * ratio);
        return Math.min(thumbHeight, this.props.height);
    }
    getThumbY() {
        if (this.maxScrollY <= 0)
            return 0;
        const trackHeight = this.props.height;
        const thumbHeight = this.getThumbHeight();
        const scrollableTrackHeight = trackHeight - thumbHeight;
        const scrollRatio = this.scrollY / this.maxScrollY;
        return scrollRatio * scrollableTrackHeight;
    }
    updateScrollbar() {
        const trackX = this.props.width - this.props.scrollbarWidth;
        const trackWidth = this.props.scrollbarWidth;
        const trackHeight = this.props.height;
        this.scrollbarTrack.clear();
        this.scrollbarTrack.rect(trackX, 0, trackWidth, trackHeight);
        this.scrollbarTrack.fill({ color: this.props.scrollbarTrackColor });
        const thumbHeight = this.getThumbHeight();
        const thumbY = this.getThumbY();
        const thumbColor = (this.isHoveringThumb || this.isDragging)
            ? this.props.scrollbarThumbHoverColor
            : this.props.scrollbarThumbColor;
        this.scrollbarThumb.clear();
        if (this.maxScrollY > 0) {
            this.scrollbarThumb.roundRect(trackX + 2, thumbY + 2, trackWidth - 4, thumbHeight - 4, 4);
            this.scrollbarThumb.fill({ color: thumbColor });
            this.scrollbarThumb.visible = true;
        }
        else {
            this.scrollbarThumb.visible = false;
        }
        if (this.props.scrollbarAutoHide && !this.isDragging && !this.isHoveringThumb) {
            this.scrollbarTrack.alpha = 0;
            this.scrollbarThumb.alpha = 0;
        }
        else {
            this.scrollbarTrack.alpha = 1;
            this.scrollbarThumb.alpha = 1;
        }
    }
    updateContentBounds() {
        let maxHeight = 0;
        this.contentContainer.children.forEach((child) => {
            const childBottom = child.y + child.height;
            if (childBottom > maxHeight) {
                maxHeight = childBottom;
            }
        });
        this.contentHeight = maxHeight;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        this.maxScrollY = Math.max(0, this.contentHeight - viewportHeight);
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    addChild(child) {
        child.parent = this;
        this.children.push(child);
        this.contentContainer.addChild(child.container);
        const contentWidth = this.props.width - this.props.padding.left - this.props.padding.right - this.props.scrollbarWidth;
        const contentHeight = 999999;
        child.layout(contentWidth, contentHeight);
        this.updateContentBounds();
    }
    removeChild(child) {
        child.parent = undefined;
        const index = this.children.indexOf(child);
        if (index !== -1) {
            this.children.splice(index, 1);
        }
        this.contentContainer.removeChild(child.container);
        this.updateContentBounds();
    }
    scrollTo(y) {
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, y));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    scrollToTop() {
        this.scrollTo(0);
    }
    scrollToBottom() {
        this.scrollTo(this.maxScrollY);
    }
    getScrollY() {
        return this.scrollY;
    }
    getMaxScrollY() {
        return this.maxScrollY;
    }
    scrollToComponent(component) {
        const componentBounds = component.getGlobalBounds();
        const containerBounds = this.getGlobalBounds();
        const relativeY = componentBounds.y - containerBounds.y - this.props.padding.top + this.scrollY;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        if (relativeY < this.scrollY) {
            this.scrollTo(relativeY);
        }
        else if (relativeY + componentBounds.height > this.scrollY + viewportHeight) {
            const targetScroll = relativeY + componentBounds.height - viewportHeight;
            this.scrollTo(targetScroll);
        }
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.updateContentBounds();
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    destroy() {
        if (typeof window !== 'undefined') {
            window.removeEventListener('pointermove', this.handleGlobalPointerMove.bind(this));
            window.removeEventListener('pointerup', this.handleGlobalPointerUp.bind(this));
        }
        super.destroy();
    }
}
exports.UIScrollContainer = UIScrollContainer;


/***/ }),

/***/ "./src/ui/components/ui-select.ts":
/*!****************************************!*\
  !*** ./src/ui/components/ui-select.ts ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UISelect = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
class UISelect extends ui_component_1.UIComponent {
    props;
    onChange;
    selectedValue;
    background;
    label;
    dropdownContainer;
    dropdownPanel;
    optionLabels = [];
    isOpen = false;
    hoverColor;
    selectedColor;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            options: props.options ?? [],
            placeholder: props.placeholder ?? 'Select...',
            width: props.width ?? 200,
            height: props.height ?? 36,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            borderRadius: props.borderRadius ?? 4
        };
        this.onChange = props.onChange;
        this.selectedValue = props.value ?? props.defaultValue;
        this.hoverColor = this.darkenColor(this.props.backgroundColor, 0.95);
        this.selectedColor = this.darkenColor(this.props.backgroundColor, 0.9);
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        const displayText = this.getDisplayText();
        this.label = new ui_label_1.UILabel({
            text: displayText,
            fontSize: 14,
            color: this.selectedValue ? this.props.textColor : 0x999999,
            align: 'left'
        }, {
            padding: edge_insets_1.EdgeInsets.symmetric(8, 12)
        });
        this.container.addChild(this.label.container);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (!this.selectedValue) {
            return this.props.placeholder;
        }
        const option = this.props.options.find(opt => opt.value === this.selectedValue);
        return option ? option.label : this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'pointer';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
    }
    handlePointerDown() {
        if (this.props.disabled)
            return;
        if (this.isOpen) {
            this.closeDropdown();
        }
        else {
            this.openDropdown();
        }
    }
    openDropdown() {
        this.isOpen = true;
        this.dropdownContainer = new pixi_js_1.default.Container();
        this.dropdownContainer.position.set(0, this.props.height + 4);
        const dropdownHeight = Math.min(this.props.options.length * 32, 200);
        this.dropdownPanel = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: dropdownHeight,
            borderRadius: this.props.borderRadius
        });
        this.dropdownContainer.addChild(this.dropdownPanel.container);
        this.optionLabels = [];
        this.props.options.forEach((option, index) => {
            const optionContainer = new pixi_js_1.default.Container();
            optionContainer.position.set(0, index * 32);
            const optionBg = new pixi_js_1.default.Graphics();
            optionBg.rect(0, 0, this.props.width, 32);
            optionBg.fill({ color: this.props.backgroundColor, alpha: 0 });
            optionContainer.addChild(optionBg);
            const optionLabel = new ui_label_1.UILabel({
                text: option.label,
                fontSize: 14,
                color: option.disabled ? 0x999999 : this.props.textColor,
                align: 'left'
            }, {
                padding: edge_insets_1.EdgeInsets.symmetric(8, 12)
            });
            optionLabel.layout(this.props.width, 32);
            optionContainer.addChild(optionLabel.container);
            if (!option.disabled) {
                optionContainer.eventMode = 'static';
                optionContainer.cursor = 'pointer';
                optionContainer.on('pointerover', () => {
                    optionBg.clear();
                    optionBg.rect(0, 0, this.props.width, 32);
                    optionBg.fill({ color: this.hoverColor });
                });
                optionContainer.on('pointerout', () => {
                    optionBg.clear();
                    optionBg.rect(0, 0, this.props.width, 32);
                    optionBg.fill({ color: this.props.backgroundColor, alpha: 0 });
                });
                optionContainer.on('pointerdown', () => {
                    this.selectOption(option.value);
                });
            }
            this.dropdownContainer.addChild(optionContainer);
            this.optionLabels.push(optionLabel);
        });
        this.container.addChild(this.dropdownContainer);
        this.setupClickOutside();
    }
    closeDropdown() {
        this.isOpen = false;
        if (this.dropdownContainer) {
            this.container.removeChild(this.dropdownContainer);
            this.dropdownContainer = undefined;
            this.dropdownPanel = undefined;
            this.optionLabels = [];
        }
        this.removeClickOutside();
    }
    selectOption(value) {
        this.selectedValue = value;
        this.label.setText(this.getDisplayText());
        this.label.setColor(this.props.textColor);
        this.onChange?.(value);
        this.closeDropdown();
    }
    setupClickOutside() {
        const stage = this.container.parent;
        if (stage) {
            stage.eventMode = 'static';
            stage.once('pointerdown', (e) => {
                const point = e.global;
                const bounds = this.container.getBounds();
                if (point.x < bounds.x || point.x > bounds.x + bounds.width ||
                    point.y < bounds.y || point.y > bounds.y + bounds.height) {
                    this.closeDropdown();
                }
            });
        }
    }
    removeClickOutside() {
    }
    darkenColor(color, factor) {
        const r = ((color >> 16) & 0xff) * factor;
        const g = ((color >> 8) & 0xff) * factor;
        const b = (color & 0xff) * factor;
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.label.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.selectedValue = value;
        this.label.setText(this.getDisplayText());
        this.label.setColor(this.props.textColor);
    }
    getValue() {
        return this.selectedValue;
    }
    setOptions(options) {
        this.props.options = options;
        if (this.isOpen) {
            this.closeDropdown();
        }
    }
}
exports.UISelect = UISelect;


/***/ }),

/***/ "./src/ui/components/ui-tabs.ts":
/*!**************************************!*\
  !*** ./src/ui/components/ui-tabs.ts ***!
  \**************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITabs = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
class UITabs extends ui_component_1.UIComponent {
    items;
    activeKey;
    onChange;
    type;
    tabPosition;
    width;
    height;
    tabBarBackgroundColor;
    tabBarHeight;
    activeTabColor;
    inactiveTabColor;
    textColor;
    activeTextColor;
    hashPrefix;
    tabBar;
    contentArea;
    tabButtons = new Map();
    activeIndicator;
    hashChangeHandler;
    constructor(props, boxModel) {
        super(boxModel);
        this.items = props.items || [];
        this.onChange = props.onChange;
        this.type = props.type || 'line';
        this.tabPosition = props.tabPosition || 'top';
        this.tabBarBackgroundColor = props.tabBarBackgroundColor ?? 0x2d2d44;
        this.tabBarHeight = props.tabBarHeight ?? 48;
        this.activeTabColor = props.activeTabColor ?? 0x1890ff;
        this.inactiveTabColor = props.inactiveTabColor ?? 0x3d3d54;
        this.textColor = props.textColor ?? 0xaaaaaa;
        this.activeTextColor = props.activeTextColor ?? 0xffffff;
        this.hashPrefix = props.hashPrefix;
        let initialKey = props.activeKey || props.defaultActiveKey || (this.items.length > 0 ? this.items[0].key : '');
        if (this.hashPrefix && !props.activeKey) {
            const hashKey = this.getKeyFromHash();
            if (hashKey && this.items.find(item => item.key === hashKey)) {
                initialKey = hashKey;
            }
        }
        this.activeKey = initialKey;
        this.width = props.width ?? 800;
        this.height = props.height ?? 600;
        this.tabBar = new PIXI.Container();
        this.contentArea = new PIXI.Container();
        this.container.addChild(this.tabBar);
        this.container.addChild(this.contentArea);
        this.buildTabs();
        this.showActiveTab();
        if (this.hashPrefix) {
            this.setupHashListener();
            this.updateHash(this.activeKey);
        }
    }
    getKeyFromHash() {
        if (!this.hashPrefix)
            return null;
        const hash = window.location.hash.slice(1);
        const prefix = `${this.hashPrefix}/`;
        if (hash.startsWith(prefix)) {
            return hash.slice(prefix.length);
        }
        return null;
    }
    updateHash(key) {
        if (!this.hashPrefix)
            return;
        const newHash = `#${this.hashPrefix}/${key}`;
        if (window.location.hash !== newHash) {
            window.location.hash = newHash;
        }
    }
    setupHashListener() {
        this.hashChangeHandler = () => {
            const hashKey = this.getKeyFromHash();
            if (hashKey && hashKey !== this.activeKey) {
                this.setActiveKey(hashKey, false);
            }
        };
        window.addEventListener('hashchange', this.hashChangeHandler);
    }
    destroy() {
        if (this.hashChangeHandler) {
            window.removeEventListener('hashchange', this.hashChangeHandler);
        }
    }
    buildTabs() {
        this.tabBar.removeChildren();
        this.tabButtons.clear();
        const tabBarBg = new PIXI.Graphics();
        tabBarBg.rect(0, 0, this.width, this.tabBarHeight);
        tabBarBg.fill({ color: this.tabBarBackgroundColor });
        this.tabBar.addChild(tabBarBg);
        if (this.type === 'line') {
            const borderLine = new PIXI.Graphics();
            borderLine.rect(0, this.tabBarHeight - 2, this.width, 2);
            borderLine.fill({ color: 0x3d3d54, alpha: 0.5 });
            this.tabBar.addChild(borderLine);
        }
        if (this.tabPosition === 'bottom') {
            this.tabBar.y = this.height - this.tabBarHeight;
            this.contentArea.y = 0;
        }
        else {
            this.tabBar.y = 0;
            this.contentArea.y = this.tabBarHeight;
        }
        let xOffset = 8;
        const tabPadding = 24;
        const tabGap = 8;
        for (const item of this.items) {
            if (item.disabled)
                continue;
            const tabContainer = new PIXI.Container();
            tabContainer.x = xOffset;
            const isActive = this.activeKey === item.key;
            const label = new ui_label_1.UILabel({
                text: item.label,
                fontSize: 15,
                fontWeight: isActive ? 'bold' : 'normal',
                color: isActive ? this.activeTextColor : this.textColor
            });
            label.measure();
            label.layout(this.width, this.tabBarHeight);
            const labelBounds = label.container.getLocalBounds();
            const tabWidth = labelBounds.width + (tabPadding * 2);
            let bg;
            if (this.type === 'card') {
                bg = new PIXI.Graphics();
                bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                bg.fill({ color: isActive ? this.activeTabColor : this.inactiveTabColor });
                bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                bg.stroke({ color: isActive ? this.activeTabColor : 0x4d4d64, width: 2 });
                tabContainer.addChild(bg);
            }
            else {
                bg = new PIXI.Graphics();
                bg.rect(0, 0, tabWidth, this.tabBarHeight);
                bg.fill({ color: 0x000000, alpha: 0 });
                tabContainer.addChild(bg);
            }
            label.container.x = tabPadding;
            label.container.y = (this.tabBarHeight - labelBounds.height) / 2;
            tabContainer.addChild(label.container);
            tabContainer.eventMode = 'static';
            tabContainer.cursor = 'pointer';
            const tabKey = item.key;
            tabContainer.on('pointerdown', () => {
                this.setActiveKey(tabKey);
            });
            tabContainer.on('pointerover', () => {
                if (this.activeKey !== tabKey) {
                    if (this.type === 'card') {
                        bg.clear();
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.fill({ color: this.activeTabColor, alpha: 0.5 });
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.stroke({ color: this.activeTabColor, width: 2 });
                    }
                    else {
                        label.setColor(this.activeTextColor);
                    }
                }
            });
            tabContainer.on('pointerout', () => {
                if (this.activeKey !== tabKey) {
                    if (this.type === 'card') {
                        bg.clear();
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.fill({ color: this.inactiveTabColor });
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.stroke({ color: 0x4d4d64, width: 2 });
                    }
                    else {
                        label.setColor(this.textColor);
                    }
                }
            });
            this.tabBar.addChild(tabContainer);
            this.tabButtons.set(item.key, { container: tabContainer, label, bg });
            xOffset += tabWidth + tabGap;
        }
        if (this.type === 'line') {
            this.activeIndicator = new PIXI.Graphics();
            this.tabBar.addChild(this.activeIndicator);
            this.updateActiveIndicator();
        }
    }
    updateActiveIndicator() {
        if (!this.activeIndicator || this.type !== 'line')
            return;
        this.activeIndicator.clear();
        const activeTab = this.tabButtons.get(this.activeKey);
        if (!activeTab)
            return;
        const tabX = activeTab.container.x;
        const tabBounds = activeTab.bg.getLocalBounds();
        const tabWidth = tabBounds.width;
        const indicatorHeight = 3;
        const indicatorY = this.tabBarHeight - indicatorHeight;
        this.activeIndicator.roundRect(tabX + 8, indicatorY, tabWidth - 16, indicatorHeight, 1.5);
        this.activeIndicator.fill({ color: this.activeTabColor });
    }
    showActiveTab() {
        this.contentArea.removeChildren();
        const activeItem = this.items.find(item => item.key === this.activeKey);
        if (!activeItem)
            return;
        const contentHeight = this.height - this.tabBarHeight;
        activeItem.content.layout(this.width, contentHeight);
        this.contentArea.addChild(activeItem.content.container);
        this.tabButtons.forEach((tab, key) => {
            const isActive = key === this.activeKey;
            const tabBounds = tab.bg.getLocalBounds();
            if (this.type === 'card') {
                tab.bg.clear();
                tab.bg.roundRect(0, 0, tabBounds.width, this.tabBarHeight - 2, 6);
                tab.bg.fill({ color: isActive ? this.activeTabColor : this.inactiveTabColor });
                tab.bg.roundRect(0, 0, tabBounds.width, this.tabBarHeight - 2, 6);
                tab.bg.stroke({ color: isActive ? this.activeTabColor : 0x4d4d64, width: 2 });
            }
            else {
                tab.bg.clear();
                tab.bg.rect(0, 0, tabBounds.width, this.tabBarHeight);
                tab.bg.fill({ color: 0x000000, alpha: 0 });
            }
            tab.label.setColor(isActive ? this.activeTextColor : this.textColor);
            tab.label.container.alpha = 1;
        });
        if (this.type === 'line') {
            this.updateActiveIndicator();
        }
    }
    setActiveKey(key, updateHash = true) {
        if (this.activeKey === key)
            return;
        const item = this.items.find(item => item.key === key);
        if (!item || item.disabled)
            return;
        this.activeKey = key;
        this.showActiveTab();
        if (updateHash && this.hashPrefix) {
            this.updateHash(key);
        }
        if (this.onChange) {
            this.onChange(key);
        }
    }
    getActiveKey() {
        return this.activeKey;
    }
    setItems(items) {
        this.items = items;
        if (!this.items.find(item => item.key === this.activeKey)) {
            this.activeKey = this.items.length > 0 ? this.items[0].key : '';
        }
        this.buildTabs();
        this.showActiveTab();
    }
    measure() {
        return {
            width: this.width,
            height: this.height
        };
    }
    layout(width, height) {
        this.width = width;
        this.height = height;
        this.buildTabs();
        this.showActiveTab();
    }
    render() {
    }
}
exports.UITabs = UITabs;


/***/ }),

/***/ "./src/ui/components/ui-text-input.ts":
/*!********************************************!*\
  !*** ./src/ui/components/ui-text-input.ts ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITextInput = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
class UITextInput extends ui_component_1.UIComponent {
    props;
    onChange;
    currentValue;
    background;
    textDisplay;
    cursor;
    cursorPosition = 0;
    cursorBlinkInterval;
    cursorVisible = true;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            placeholder: props.placeholder ?? '',
            maxLength: props.maxLength ?? 100,
            width: props.width ?? 200,
            height: props.height ?? 36,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            placeholderColor: props.placeholderColor ?? 0x999999,
            borderRadius: props.borderRadius ?? 4,
            fontSize: props.fontSize ?? 14,
            type: props.type ?? 'text'
        };
        this.onChange = props.onChange;
        this.currentValue = props.value ?? props.defaultValue ?? '';
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        this.textDisplay = new pixi_js_1.default.Text({
            text: this.getDisplayText(),
            style: {
                fontFamily: 'Arial',
                fontSize: this.props.fontSize,
                fill: this.currentValue ? this.props.textColor : this.props.placeholderColor,
                align: 'left'
            },
            resolution: window.devicePixelRatio || 2
        });
        this.textDisplay.position.set(12, (this.props.height - this.props.fontSize) / 2);
        this.container.addChild(this.textDisplay);
        this.cursor = new pixi_js_1.default.Graphics();
        this.cursor.visible = false;
        this.container.addChild(this.cursor);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (this.currentValue) {
            return this.currentValue;
        }
        return this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'text';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        if (typeof window !== 'undefined') {
            window.addEventListener('keydown', this.handleKeyDown.bind(this));
        }
    }
    handlePointerDown(e) {
        if (this.props.disabled)
            return;
        const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
        if (focusManager) {
            focusManager.requestFocus(this);
        }
        else {
            this.onFocus();
        }
        e.stopPropagation();
    }
    onFocus() {
        if (this.focused)
            return;
        super.onFocus();
        this.cursorPosition = this.currentValue.length;
        this.cursor.visible = true;
        this.updateCursor();
        this.startCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.lightenColor(this.props.backgroundColor, 0.95),
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    onBlur() {
        if (!this.focused)
            return;
        super.onBlur();
        this.cursor.visible = false;
        this.stopCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    handleKeyDown(e) {
        if (!this.focused || this.props.disabled)
            return;
        e.preventDefault();
        e.stopPropagation();
        const key = e.key;
        if (key === 'Enter') {
            this.onBlur();
            return;
        }
        if (key === 'Escape') {
            this.onBlur();
            return;
        }
        if (key === 'Backspace') {
            if (this.cursorPosition > 0) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition - 1) +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition--;
                this.updateText();
            }
            return;
        }
        if (key === 'Delete') {
            if (this.cursorPosition < this.currentValue.length) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        this.currentValue.substring(this.cursorPosition + 1);
                this.updateText();
            }
            return;
        }
        if (key === 'ArrowLeft') {
            if (this.cursorPosition > 0) {
                this.cursorPosition--;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowRight') {
            if (this.cursorPosition < this.currentValue.length) {
                this.cursorPosition++;
                this.updateCursor();
            }
            return;
        }
        if (key === 'Home') {
            this.cursorPosition = 0;
            this.updateCursor();
            return;
        }
        if (key === 'End') {
            this.cursorPosition = this.currentValue.length;
            this.updateCursor();
            return;
        }
        if (key.length === 1 && !e.ctrlKey && !e.metaKey) {
            if (this.props.type === 'number' && !/[0-9.-]/.test(key)) {
                return;
            }
            if (this.currentValue.length >= this.props.maxLength) {
                return;
            }
            this.currentValue =
                this.currentValue.substring(0, this.cursorPosition) +
                    key +
                    this.currentValue.substring(this.cursorPosition);
            this.cursorPosition++;
            this.updateText();
        }
    }
    updateText() {
        this.textDisplay.text = this.getDisplayText();
        this.textDisplay.style.fill = this.currentValue ? this.props.textColor : this.props.placeholderColor;
        this.updateCursor();
        this.onChange?.(this.currentValue);
    }
    updateCursor() {
        const textUpToCursor = this.currentValue.substring(0, this.cursorPosition);
        const tempText = new pixi_js_1.default.Text({
            text: textUpToCursor,
            style: this.textDisplay.style
        });
        const cursorX = 12 + tempText.width;
        const cursorY = (this.props.height - this.props.fontSize) / 2;
        this.cursor.clear();
        this.cursor.rect(cursorX, cursorY, 1, this.props.fontSize);
        this.cursor.fill({ color: this.props.textColor });
        tempText.destroy();
    }
    startCursorBlink() {
        this.stopCursorBlink();
        this.cursorVisible = true;
        this.cursorBlinkInterval = window.setInterval(() => {
            this.cursorVisible = !this.cursorVisible;
            this.cursor.visible = this.cursorVisible;
        }, 530);
    }
    stopCursorBlink() {
        if (this.cursorBlinkInterval) {
            window.clearInterval(this.cursorBlinkInterval);
            this.cursorBlinkInterval = undefined;
        }
    }
    lightenColor(color, factor) {
        const r = Math.min(255, ((color >> 16) & 0xff) / factor);
        const g = Math.min(255, ((color >> 8) & 0xff) / factor);
        const b = Math.min(255, (color & 0xff) / factor);
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.currentValue = value;
        this.cursorPosition = value.length;
        this.updateText();
    }
    getValue() {
        return this.currentValue;
    }
    destroy() {
        this.stopCursorBlink();
        if (typeof window !== 'undefined') {
            window.removeEventListener('keydown', this.handleKeyDown.bind(this));
        }
        super.destroy();
    }
}
exports.UITextInput = UITextInput;


/***/ }),

/***/ "./src/ui/components/ui-textarea.ts":
/*!******************************************!*\
  !*** ./src/ui/components/ui-textarea.ts ***!
  \******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITextArea = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
class UITextArea extends ui_component_1.UIComponent {
    props;
    onChange;
    currentValue;
    background;
    textDisplay;
    cursor;
    cursorPosition = 0;
    cursorBlinkInterval;
    cursorVisible = true;
    constructor(props, boxModel) {
        super(boxModel);
        const defaultHeight = (props.rows ?? 4) * (props.fontSize ?? 14) * (props.lineHeight ?? 1.5) + 24;
        this.props = {
            placeholder: props.placeholder ?? '',
            maxLength: props.maxLength ?? 1000,
            width: props.width ?? 400,
            height: props.height ?? defaultHeight,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            placeholderColor: props.placeholderColor ?? 0x999999,
            borderRadius: props.borderRadius ?? 4,
            fontSize: props.fontSize ?? 14,
            lineHeight: props.lineHeight ?? 1.5,
            rows: props.rows ?? 4
        };
        this.onChange = props.onChange;
        this.currentValue = props.value ?? props.defaultValue ?? '';
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        this.textDisplay = new pixi_js_1.default.Text({
            text: this.getDisplayText(),
            style: {
                fontFamily: 'Arial',
                fontSize: this.props.fontSize,
                fill: this.currentValue ? this.props.textColor : this.props.placeholderColor,
                align: 'left',
                wordWrap: true,
                wordWrapWidth: this.props.width - 24,
                lineHeight: this.props.fontSize * this.props.lineHeight
            },
            resolution: window.devicePixelRatio || 2
        });
        this.textDisplay.position.set(12, 12);
        this.container.addChild(this.textDisplay);
        this.cursor = new pixi_js_1.default.Graphics();
        this.cursor.visible = false;
        this.container.addChild(this.cursor);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (this.currentValue) {
            return this.currentValue;
        }
        return this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'text';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        if (typeof window !== 'undefined') {
            window.addEventListener('keydown', this.handleKeyDown.bind(this));
        }
    }
    handlePointerDown(e) {
        if (this.props.disabled)
            return;
        const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
        if (focusManager) {
            focusManager.requestFocus(this);
        }
        else {
            this.onFocus();
        }
        e.stopPropagation();
    }
    onFocus() {
        if (this.focused)
            return;
        super.onFocus();
        this.cursorPosition = this.currentValue.length;
        this.cursor.visible = true;
        this.updateCursor();
        this.startCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.lightenColor(this.props.backgroundColor, 0.95),
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    onBlur() {
        if (!this.focused)
            return;
        super.onBlur();
        this.cursor.visible = false;
        this.stopCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    handleKeyDown(e) {
        if (!this.focused || this.props.disabled)
            return;
        if (e.key !== 'Tab') {
            e.preventDefault();
            e.stopPropagation();
        }
        const key = e.key;
        if (key === 'Enter') {
            if (this.currentValue.length < this.props.maxLength) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        '\n' +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition++;
                this.updateText();
            }
            return;
        }
        if (key === 'Escape') {
            this.onBlur();
            return;
        }
        if (key === 'Backspace') {
            if (this.cursorPosition > 0) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition - 1) +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition--;
                this.updateText();
            }
            return;
        }
        if (key === 'Delete') {
            if (this.cursorPosition < this.currentValue.length) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        this.currentValue.substring(this.cursorPosition + 1);
                this.updateText();
            }
            return;
        }
        if (key === 'ArrowLeft') {
            if (this.cursorPosition > 0) {
                this.cursorPosition--;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowRight') {
            if (this.cursorPosition < this.currentValue.length) {
                this.cursorPosition++;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowUp') {
            this.moveCursorVertically(-1);
            return;
        }
        if (key === 'ArrowDown') {
            this.moveCursorVertically(1);
            return;
        }
        if (key === 'Home') {
            const lineStart = this.currentValue.lastIndexOf('\n', this.cursorPosition - 1) + 1;
            this.cursorPosition = lineStart;
            this.updateCursor();
            return;
        }
        if (key === 'End') {
            let lineEnd = this.currentValue.indexOf('\n', this.cursorPosition);
            if (lineEnd === -1)
                lineEnd = this.currentValue.length;
            this.cursorPosition = lineEnd;
            this.updateCursor();
            return;
        }
        if (key.length === 1 && !e.ctrlKey && !e.metaKey) {
            if (this.currentValue.length >= this.props.maxLength) {
                return;
            }
            this.currentValue =
                this.currentValue.substring(0, this.cursorPosition) +
                    key +
                    this.currentValue.substring(this.cursorPosition);
            this.cursorPosition++;
            this.updateText();
        }
    }
    moveCursorVertically(direction) {
        const lines = this.currentValue.split('\n');
        let currentLine = 0;
        let positionInLine = 0;
        let charCount = 0;
        for (let i = 0; i < lines.length; i++) {
            if (charCount + lines[i].length >= this.cursorPosition) {
                currentLine = i;
                positionInLine = this.cursorPosition - charCount;
                break;
            }
            charCount += lines[i].length + 1;
        }
        const targetLine = Math.max(0, Math.min(lines.length - 1, currentLine + direction));
        if (targetLine === currentLine)
            return;
        let newPosition = 0;
        for (let i = 0; i < targetLine; i++) {
            newPosition += lines[i].length + 1;
        }
        newPosition += Math.min(positionInLine, lines[targetLine].length);
        this.cursorPosition = newPosition;
        this.updateCursor();
    }
    updateText() {
        this.textDisplay.text = this.getDisplayText();
        this.textDisplay.style.fill = this.currentValue ? this.props.textColor : this.props.placeholderColor;
        this.updateCursor();
        this.onChange?.(this.currentValue);
    }
    updateCursor() {
        const textUpToCursor = this.currentValue.substring(0, this.cursorPosition);
        const tempText = new pixi_js_1.default.Text({
            text: textUpToCursor,
            style: {
                ...this.textDisplay.style,
                wordWrap: true,
                wordWrapWidth: this.props.width - 24
            }
        });
        const metrics = tempText.getLocalBounds();
        const lines = textUpToCursor.split('\n');
        const lastLine = lines[lines.length - 1];
        const lastLineText = new pixi_js_1.default.Text({
            text: lastLine,
            style: this.textDisplay.style
        });
        const cursorX = 12 + lastLineText.width;
        const cursorY = 12 + (lines.length - 1) * (this.props.fontSize * this.props.lineHeight);
        this.cursor.clear();
        this.cursor.rect(cursorX, cursorY, 1, this.props.fontSize);
        this.cursor.fill({ color: this.props.textColor });
        tempText.destroy();
        lastLineText.destroy();
    }
    startCursorBlink() {
        this.stopCursorBlink();
        this.cursorVisible = true;
        this.cursorBlinkInterval = window.setInterval(() => {
            this.cursorVisible = !this.cursorVisible;
            this.cursor.visible = this.cursorVisible;
        }, 530);
    }
    stopCursorBlink() {
        if (this.cursorBlinkInterval) {
            window.clearInterval(this.cursorBlinkInterval);
            this.cursorBlinkInterval = undefined;
        }
    }
    lightenColor(color, factor) {
        const r = Math.min(255, ((color >> 16) & 0xff) / factor);
        const g = Math.min(255, ((color >> 8) & 0xff) / factor);
        const b = Math.min(255, (color & 0xff) / factor);
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.currentValue = value;
        this.cursorPosition = value.length;
        this.updateText();
    }
    getValue() {
        return this.currentValue;
    }
    destroy() {
        this.stopCursorBlink();
        if (typeof window !== 'undefined') {
            window.removeEventListener('keydown', this.handleKeyDown.bind(this));
        }
        super.destroy();
    }
}
exports.UITextArea = UITextArea;


/***/ }),

/***/ "./src/ui/core/box-model.ts":
/*!**********************************!*\
  !*** ./src/ui/core/box-model.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createDefaultBoxModel = createDefaultBoxModel;
const edge_insets_1 = __webpack_require__(/*! ./edge-insets */ "./src/ui/core/edge-insets.ts");
function createDefaultBoxModel(overrides) {
    return {
        width: 'auto',
        height: 'auto',
        padding: edge_insets_1.EdgeInsets.zero(),
        margin: edge_insets_1.EdgeInsets.zero(),
        ...overrides
    };
}


/***/ }),

/***/ "./src/ui/core/edge-insets.ts":
/*!************************************!*\
  !*** ./src/ui/core/edge-insets.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.EdgeInsets = void 0;
class EdgeInsets {
    top;
    right;
    bottom;
    left;
    constructor(top, right, bottom, left) {
        this.top = top;
        this.right = right;
        this.bottom = bottom;
        this.left = left;
    }
    static all(value) {
        return new EdgeInsets(value, value, value, value);
    }
    static symmetric(vertical, horizontal) {
        return new EdgeInsets(vertical, horizontal, vertical, horizontal);
    }
    static only(edges) {
        return new EdgeInsets(edges.top ?? 0, edges.right ?? 0, edges.bottom ?? 0, edges.left ?? 0);
    }
    static zero() {
        return new EdgeInsets(0, 0, 0, 0);
    }
    get horizontal() {
        return this.left + this.right;
    }
    get vertical() {
        return this.top + this.bottom;
    }
    clone() {
        return new EdgeInsets(this.top, this.right, this.bottom, this.left);
    }
}
exports.EdgeInsets = EdgeInsets;


/***/ }),

/***/ "./src/ui/core/ui-component.ts":
/*!*************************************!*\
  !*** ./src/ui/core/ui-component.ts ***!
  \*************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIComponent = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const box_model_1 = __webpack_require__(/*! ./box-model */ "./src/ui/core/box-model.ts");
class UIComponent {
    container;
    boxModel;
    focusRing;
    computedLayout;
    parent;
    visible = true;
    enabled = true;
    layoutDirty = true;
    tabIndex = -1;
    focused = false;
    constructor(boxModel) {
        this.container = new pixi_js_1.default.Container();
        this.boxModel = (0, box_model_1.createDefaultBoxModel)(boxModel);
        this.computedLayout = {
            x: 0,
            y: 0,
            width: 0,
            height: 0,
            contentX: 0,
            contentY: 0,
            contentWidth: 0,
            contentHeight: 0
        };
        this.createFocusRing();
    }
    createFocusRing() {
        this.focusRing = new pixi_js_1.default.Graphics();
        this.focusRing.visible = false;
        this.container.addChildAt(this.focusRing, 0);
    }
    updateFocusRing() {
        if (!this.focusRing)
            return;
        this.focusRing.clear();
        const width = this.computedLayout.width;
        const height = this.computedLayout.height;
        if (width <= 0 || height <= 0)
            return;
        const offset = 4;
        const strokeWidth = 3;
        this.focusRing.roundRect(-offset - 2, -offset - 2, width + (offset + 2) * 2, height + (offset + 2) * 2, 8);
        this.focusRing.stroke({
            color: 0x00d9ff,
            width: strokeWidth + 2,
            alpha: 0.3
        });
        this.focusRing.roundRect(-offset, -offset, width + offset * 2, height + offset * 2, 8);
        this.focusRing.stroke({
            color: 0x00d9ff,
            width: strokeWidth
        });
        this.focusRing.roundRect(-offset + strokeWidth, -offset + strokeWidth, width + (offset - strokeWidth) * 2, height + (offset - strokeWidth) * 2, 6);
        this.focusRing.stroke({
            color: 0xffffff,
            width: 1,
            alpha: 0.6
        });
    }
    markLayoutDirty() {
        this.layoutDirty = true;
        if (this.parent) {
            this.parent.markLayoutDirty();
        }
    }
    getLayout() {
        return this.computedLayout;
    }
    getBoxModel() {
        return this.boxModel;
    }
    getGlobalBounds() {
        const globalPos = this.container.getGlobalPosition();
        return {
            x: globalPos.x,
            y: globalPos.y,
            width: this.computedLayout.width,
            height: this.computedLayout.height
        };
    }
    setPosition(x, y) {
        this.computedLayout.x = x;
        this.computedLayout.y = y;
        this.container.position.set(x, y);
    }
    show() {
        this.visible = true;
        this.container.visible = true;
    }
    hide() {
        this.visible = false;
        this.container.visible = false;
    }
    canFocus() {
        return this.enabled && this.visible && this.tabIndex >= 0;
    }
    isFocused() {
        return this.focused;
    }
    onFocus() {
        this.focused = true;
        this.showFocusRing();
        this.scrollIntoView();
    }
    showFocusRing() {
        if (this.focusRing) {
            this.updateFocusRing();
            this.focusRing.visible = true;
        }
    }
    scrollIntoView() {
        let currentParent = this.parent;
        while (currentParent) {
            if ('scrollToComponent' in currentParent && typeof currentParent.scrollToComponent === 'function') {
                currentParent.scrollToComponent(this);
                break;
            }
            currentParent = currentParent.parent;
        }
    }
    onBlur() {
        this.focused = false;
        this.hideFocusRing();
    }
    hideFocusRing() {
        if (this.focusRing) {
            this.focusRing.visible = false;
        }
    }
    destroy() {
        this.container.destroy({ children: true });
    }
}
exports.UIComponent = UIComponent;


/***/ }),

/***/ "./src/ui/core/ui-focus-manager.ts":
/*!*****************************************!*\
  !*** ./src/ui/core/ui-focus-manager.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIFocusManager = void 0;
class UIFocusManager {
    static instance = null;
    focusableComponents = [];
    currentFocusIndex = -1;
    keydownHandler = null;
    constructor() {
        this.setupKeyboardListeners();
        UIFocusManager.instance = this;
    }
    static getInstance() {
        return UIFocusManager.instance;
    }
    setupKeyboardListeners() {
        if (typeof window === 'undefined')
            return;
        this.keydownHandler = (e) => {
            if (e.key === 'Tab') {
                e.preventDefault();
                if (e.shiftKey) {
                    this.focusPrevious();
                }
                else {
                    this.focusNext();
                }
            }
        };
        window.addEventListener('keydown', this.keydownHandler);
    }
    register(component) {
        if (!this.focusableComponents.includes(component)) {
            this.focusableComponents.push(component);
            this.sortByTabIndex();
        }
    }
    registerContainer(container) {
        this.discoverFocusableComponents(container);
        this.sortByTabIndex();
    }
    discoverFocusableComponents(component) {
        console.log('ð Discovering in component:', component.constructor.name, 'tabIndex:', component.tabIndex);
        if (this.isFocusableComponent(component)) {
            console.log('  â Registering focusable:', component.constructor.name);
            this.register(component);
        }
        if ('children' in component && Array.isArray(component.children)) {
            const children = component.children;
            console.log(`  ð¦ Has ${children.length} children`);
            children.forEach(child => this.discoverFocusableComponents(child));
        }
    }
    isFocusableComponent(component) {
        return (typeof component.tabIndex === 'number' &&
            component.tabIndex >= 0 &&
            typeof component.canFocus === 'function' &&
            typeof component.onFocus === 'function' &&
            typeof component.onBlur === 'function' &&
            typeof component.isFocused === 'function');
    }
    unregister(component) {
        const index = this.focusableComponents.indexOf(component);
        if (index !== -1) {
            if (index === this.currentFocusIndex) {
                this.blur();
            }
            this.focusableComponents.splice(index, 1);
            if (this.currentFocusIndex > index) {
                this.currentFocusIndex--;
            }
        }
    }
    sortByTabIndex() {
        this.focusableComponents.sort((a, b) => a.tabIndex - b.tabIndex);
    }
    focus(component) {
        if (!component.canFocus()) {
            console.log('â Component cannot focus');
            return;
        }
        const index = this.focusableComponents.indexOf(component);
        if (index === -1) {
            console.log('â Component not registered in focus manager');
            return;
        }
        console.log(`ð¯ Focusing component at index ${index}, current index: ${this.currentFocusIndex}`);
        if (this.currentFocusIndex !== -1 && this.currentFocusIndex !== index) {
            const current = this.focusableComponents[this.currentFocusIndex];
            if (current) {
                console.log(`  ð Blurring component at index ${this.currentFocusIndex}`);
                current.onBlur();
            }
        }
        this.currentFocusIndex = index;
        console.log(`  â Calling onFocus() on component`);
        component.onFocus();
    }
    requestFocus(component) {
        this.focus(component);
    }
    blur() {
        if (this.currentFocusIndex !== -1) {
            const current = this.focusableComponents[this.currentFocusIndex];
            if (current) {
                current.onBlur();
            }
            this.currentFocusIndex = -1;
        }
    }
    focusNext() {
        if (this.focusableComponents.length === 0)
            return;
        let nextIndex = this.currentFocusIndex + 1;
        let attempts = 0;
        while (attempts < this.focusableComponents.length) {
            if (nextIndex >= this.focusableComponents.length) {
                nextIndex = 0;
            }
            const component = this.focusableComponents[nextIndex];
            if (component && component.canFocus()) {
                this.focus(component);
                return;
            }
            nextIndex++;
            attempts++;
        }
    }
    focusPrevious() {
        if (this.focusableComponents.length === 0)
            return;
        let prevIndex = this.currentFocusIndex - 1;
        let attempts = 0;
        while (attempts < this.focusableComponents.length) {
            if (prevIndex < 0) {
                prevIndex = this.focusableComponents.length - 1;
            }
            const component = this.focusableComponents[prevIndex];
            if (component && component.canFocus()) {
                this.focus(component);
                return;
            }
            prevIndex--;
            attempts++;
        }
    }
    focusFirst() {
        if (this.focusableComponents.length === 0)
            return;
        for (const component of this.focusableComponents) {
            if (component.canFocus()) {
                this.focus(component);
                return;
            }
        }
    }
    focusLast() {
        if (this.focusableComponents.length === 0)
            return;
        for (let i = this.focusableComponents.length - 1; i >= 0; i--) {
            const component = this.focusableComponents[i];
            if (component.canFocus()) {
                this.focus(component);
                return;
            }
        }
    }
    getCurrentFocus() {
        if (this.currentFocusIndex === -1)
            return null;
        return this.focusableComponents[this.currentFocusIndex] || null;
    }
    getFocusableComponents() {
        return [...this.focusableComponents];
    }
    clear() {
        this.blur();
        this.focusableComponents = [];
        this.currentFocusIndex = -1;
    }
    destroy() {
        if (typeof window !== 'undefined' && this.keydownHandler) {
            window.removeEventListener('keydown', this.keydownHandler);
        }
        this.clear();
    }
}
exports.UIFocusManager = UIFocusManager;


/***/ }),

/***/ "./src/ui/layout/flex-container.ts":
/*!*****************************************!*\
  !*** ./src/ui/layout/flex-container.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.FlexContainer = exports.FlexAlign = exports.FlexJustify = exports.FlexDirection = void 0;
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
var FlexDirection;
(function (FlexDirection) {
    FlexDirection["Row"] = "row";
    FlexDirection["RowReverse"] = "row-reverse";
    FlexDirection["Column"] = "column";
    FlexDirection["ColumnReverse"] = "column-reverse";
})(FlexDirection || (exports.FlexDirection = FlexDirection = {}));
var FlexJustify;
(function (FlexJustify) {
    FlexJustify["Start"] = "start";
    FlexJustify["End"] = "end";
    FlexJustify["Center"] = "center";
    FlexJustify["SpaceBetween"] = "space-between";
    FlexJustify["SpaceAround"] = "space-around";
    FlexJustify["SpaceEvenly"] = "space-evenly";
})(FlexJustify || (exports.FlexJustify = FlexJustify = {}));
var FlexAlign;
(function (FlexAlign) {
    FlexAlign["Start"] = "start";
    FlexAlign["End"] = "end";
    FlexAlign["Center"] = "center";
    FlexAlign["Stretch"] = "stretch";
})(FlexAlign || (exports.FlexAlign = FlexAlign = {}));
class FlexContainer extends ui_component_1.UIComponent {
    props;
    children = [];
    constructor(props = {}) {
        const boxModel = {
            padding: props.padding ?? edge_insets_1.EdgeInsets.zero(),
            width: props.width ?? 'auto',
            height: props.height ?? 'auto'
        };
        super(boxModel);
        this.props = {
            direction: props.direction ?? FlexDirection.Row,
            justify: props.justify ?? FlexJustify.Start,
            align: props.align ?? FlexAlign.Start,
            gap: props.gap ?? 0,
            wrap: props.wrap ?? false
        };
    }
    addChild(child) {
        child.parent = this;
        this.children.push(child);
        this.container.addChild(child.container);
        this.markLayoutDirty();
    }
    removeChild(child) {
        const index = this.children.indexOf(child);
        if (index !== -1) {
            this.children.splice(index, 1);
            this.container.removeChild(child.container);
            child.parent = undefined;
            this.markLayoutDirty();
        }
    }
    measure() {
        if (this.children.length === 0) {
            const padding = this.boxModel.padding;
            return {
                width: padding.horizontal,
                height: padding.vertical
            };
        }
        const childSizes = this.children.map(child => child.measure());
        const { direction, gap } = this.props;
        const padding = this.boxModel.padding;
        const isRow = direction === FlexDirection.Row || direction === FlexDirection.RowReverse;
        const totalGap = gap * (this.children.length - 1);
        let measuredWidth = 0;
        let measuredHeight = 0;
        if (isRow) {
            measuredWidth = childSizes.reduce((sum, size) => sum + size.width, 0) + totalGap;
            measuredHeight = Math.max(...childSizes.map(size => size.height));
        }
        else {
            measuredWidth = Math.max(...childSizes.map(size => size.width));
            measuredHeight = childSizes.reduce((sum, size) => sum + size.height, 0) + totalGap;
        }
        return {
            width: measuredWidth + padding.horizontal,
            height: measuredHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const padding = this.boxModel.padding;
        const { direction, justify, align, gap } = this.props;
        let containerWidth;
        let containerHeight;
        if (this.boxModel.width === 'fill') {
            containerWidth = availableWidth;
        }
        else if (typeof this.boxModel.width === 'number') {
            containerWidth = this.boxModel.width;
        }
        else {
            const measured = this.measure();
            containerWidth = measured.width;
        }
        if (this.boxModel.height === 'fill') {
            containerHeight = availableHeight;
        }
        else if (typeof this.boxModel.height === 'number') {
            containerHeight = this.boxModel.height;
        }
        else {
            const measured = this.measure();
            containerHeight = measured.height;
        }
        this.computedLayout.width = containerWidth;
        this.computedLayout.height = containerHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = containerWidth - padding.horizontal;
        this.computedLayout.contentHeight = containerHeight - padding.vertical;
        if (this.children.length > 0) {
            this.layoutChildren();
        }
        this.layoutDirty = false;
        this.render();
    }
    layoutChildren() {
        const { direction, justify, align, gap } = this.props;
        const padding = this.boxModel.padding;
        const contentWidth = this.computedLayout.contentWidth;
        const contentHeight = this.computedLayout.contentHeight;
        const isRow = direction === FlexDirection.Row || direction === FlexDirection.RowReverse;
        const childSizes = this.children.map(child => child.measure());
        const totalGap = gap * (this.children.length - 1);
        const totalChildSize = isRow
            ? childSizes.reduce((sum, size) => sum + size.width, 0)
            : childSizes.reduce((sum, size) => sum + size.height, 0);
        const mainAxisSize = isRow ? contentWidth : contentHeight;
        const crossAxisSize = isRow ? contentHeight : contentWidth;
        const freeSpace = mainAxisSize - totalChildSize - totalGap;
        let mainAxisOffset = 0;
        let spaceBetween = 0;
        switch (justify) {
            case FlexJustify.Start:
                mainAxisOffset = 0;
                break;
            case FlexJustify.End:
                mainAxisOffset = freeSpace;
                break;
            case FlexJustify.Center:
                mainAxisOffset = freeSpace / 2;
                break;
            case FlexJustify.SpaceBetween:
                spaceBetween = this.children.length > 1 ? freeSpace / (this.children.length - 1) : 0;
                break;
            case FlexJustify.SpaceAround:
                spaceBetween = freeSpace / this.children.length;
                mainAxisOffset = spaceBetween / 2;
                break;
            case FlexJustify.SpaceEvenly:
                spaceBetween = freeSpace / (this.children.length + 1);
                mainAxisOffset = spaceBetween;
                break;
        }
        let currentPosition = mainAxisOffset;
        this.children.forEach((child, index) => {
            const childSize = childSizes[index];
            child.layout(childSize.width, childSize.height);
            let crossAxisPosition = 0;
            switch (align) {
                case FlexAlign.Start:
                    crossAxisPosition = 0;
                    break;
                case FlexAlign.End:
                    crossAxisPosition = crossAxisSize - (isRow ? childSize.height : childSize.width);
                    break;
                case FlexAlign.Center:
                    crossAxisPosition = (crossAxisSize - (isRow ? childSize.height : childSize.width)) / 2;
                    break;
                case FlexAlign.Stretch:
                    crossAxisPosition = 0;
                    break;
            }
            if (isRow) {
                child.setPosition(padding.left + currentPosition, padding.top + crossAxisPosition);
                currentPosition += childSize.width + gap + spaceBetween;
            }
            else {
                child.setPosition(padding.left + crossAxisPosition, padding.top + currentPosition);
                currentPosition += childSize.height + gap + spaceBetween;
            }
        });
    }
    render() {
    }
}
exports.FlexContainer = FlexContainer;


/***/ }),

/***/ "./src/ui/pixel-grid.ts":
/*!******************************!*\
  !*** ./src/ui/pixel-grid.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.BORDER = exports.GRID = exports.units = exports.px = exports.DEFAULT_PIXEL_GRID = exports.PixelGrid = void 0;
exports.createBorderConfig = createBorderConfig;
class PixelGrid {
    unit;
    scale;
    border;
    padding;
    gap;
    margin;
    fontScale;
    constructor(config = {}) {
        this.unit = config.unit ?? 1;
        this.scale = config.scale ?? 4;
        this.border = config.border ?? 1;
        this.padding = config.padding ?? 1;
        this.gap = config.gap ?? 1;
        this.margin = config.margin ?? 5;
        this.fontScale = config.fontScale ?? (this.scale / 16);
    }
    px(units) {
        return units * this.unit * this.scale;
    }
    units(pixels) {
        return Math.round(pixels / (this.unit * this.scale));
    }
}
exports.PixelGrid = PixelGrid;
exports.DEFAULT_PIXEL_GRID = (() => {
    const tempScale = typeof localStorage !== 'undefined'
        ? localStorage.getItem('temp-grid-scale')
        : null;
    if (tempScale) {
        const scale = parseInt(tempScale, 10);
        if (!isNaN(scale) && scale >= 1 && scale <= 4) {
            console.log(`ð§ TEMPORARY: Using GRID scale override: ${scale}x`);
            return new PixelGrid({ scale });
        }
    }
    return new PixelGrid();
})();
const px = (units) => exports.DEFAULT_PIXEL_GRID.px(units);
exports.px = px;
const units = (pixels) => exports.DEFAULT_PIXEL_GRID.units(pixels);
exports.units = units;
exports.GRID = {
    unit: exports.DEFAULT_PIXEL_GRID.unit,
    scale: exports.DEFAULT_PIXEL_GRID.scale,
    border: exports.DEFAULT_PIXEL_GRID.border,
    padding: exports.DEFAULT_PIXEL_GRID.padding,
    gap: exports.DEFAULT_PIXEL_GRID.gap,
    margin: exports.DEFAULT_PIXEL_GRID.margin,
    fontScale: exports.DEFAULT_PIXEL_GRID.fontScale
};
exports.BORDER = {
    outer: 1,
    middle: 1,
    inner: 1,
    total: 3
};
function createBorderConfig(config = {}) {
    const outer = config.outer ?? 1;
    const middle = config.middle ?? 1;
    const inner = config.inner ?? 1;
    const total = outer + middle + inner;
    return {
        outer,
        middle,
        inner,
        total
    };
}


/***/ }),

/***/ "pixi.js":
/*!*******************************************************************************************!*\
  !*** external {"commonjs":"pixi.js","commonjs2":"pixi.js","amd":"pixi.js","root":"PIXI"} ***!
  \*******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_pixi_js__;

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.ts");
/******/ 	
/******/ 	return __webpack_exports__;
/******/ })()
;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixXQUFXO0FBQ3JDO0FBQ0EsZ0NBQWdDLFdBQVc7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsOEJBQThCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixlQUFlO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Ysa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnQkFBZ0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsR0FBRztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsUUFBUTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLEdBQUc7QUFDNUMsMEJBQTBCLG9CQUFvQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxHQUFHO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLDJDQUEyQyxHQUFHO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLEdBQUc7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsR0FBRztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxHQUFHO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLElBQUk7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGVBQWU7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixlQUFlO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLDBEQUEwRDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyx3REFBd0Q7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNkJBQTZCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNkJBQTZCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLElBQUk7QUFDNUM7QUFDQTtBQUNBLDRDQUE0QyxLQUFLO0FBQ2pEO0FBQ0E7QUFDQSx3Q0FBd0MsR0FBRztBQUMzQztBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsTUFBTTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxJQUFJO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxJQUFJO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNEJBQTRCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw0QkFBNEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNEJBQTRCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkJBQTZCO0FBQ3JELDBCQUEwQiwwQkFBMEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw0QkFBNEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkJBQTZCO0FBQ3JEO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBCQUEwQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDBCQUEwQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsSUFBSTtBQUM5QztBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsbUJBQW1CO0FBQzdDO0FBQ0E7QUFDQSxnREFBZ0QsSUFBSTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxJQUFJO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDRCQUE0QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0NBQWdDO0FBQ3hEO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDRCQUE0QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0NBQWdDO0FBQ3hELDBCQUEwQiw0QkFBNEI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsOEJBQThCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxzREFBc0Q7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsa0VBQWtFO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsa0RBQWtEO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIscUJBQXFCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixxQkFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esb0JBQW9CLDBCQUEwQjtBQUM5QztBQUNBO0FBQ0Esc0JBQXNCLDBCQUEwQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsMEJBQTBCO0FBQzlDO0FBQ0E7QUFDQSxzQkFBc0IsMEJBQTBCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxpQkFBaUI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxnQkFBZ0I7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3Q0FBd0M7QUFDaEU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixnQ0FBZ0M7QUFDMUQ7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDRCQUE0QjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHVCQUF1QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxJQUFJO0FBQzlDO0FBQ0E7QUFDQSwwQ0FBMEMsR0FBRztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxRQUFRO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFFBQVE7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxJQUFJO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsTUFBTTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLElBQUk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsR0FBRztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQixVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsTUFBTTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsSUFBSTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNCQUFzQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBCQUEwQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixxQkFBcUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBLHdCQUF3QiwyQkFBMkI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixRQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsT0FBTztBQUMvQjtBQUNBO0FBQ0Esd0JBQXdCLE9BQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGtCQUFrQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsa0JBQWtCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixXQUFXO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsb0NBQW9DO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLG9DQUFvQztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLGdDQUFnQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msb0JBQW9CO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsWUFBWTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDBCQUEwQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLGdDQUFnQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnQ0FBZ0M7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUNBQXlDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzQkFBc0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHFCQUFxQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IscUJBQXFCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixxQkFBcUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isd0NBQXdDO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlCQUFpQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlCQUF5QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMEJBQTBCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyx3QkFBd0IsaUJBQWlCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRXBELElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDO1lBQ25CLEtBQUssRUFBRSxDQUFDO1lBQ1IsS0FBSyxFQUFFLFFBQVE7WUFDZixLQUFLLEVBQUUsR0FBRztTQUNYLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pELElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdDLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUM7UUFHdkIsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDL0UsTUFBTSxTQUFTLEdBQUcsQ0FBQyxDQUFDO1FBQ3BCLE1BQU0sTUFBTSxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLEdBQUcsQ0FBQztRQUNyQyxNQUFNLE1BQU0sR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUM7UUFFckMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0MsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQ2xCLFFBQVEsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxTQUFTLEVBQ3pDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxTQUFTLENBQzFDLENBQUM7UUFDRixJQUFJLENBQUMsUUFBUSxDQUFD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LENBQUMsS0FBSztJQUMvQixNQUFNLEVBQUUsMEJBQWtCLENBQUMsTUFBTTtJQUNqQyxPQUFPLEVBQUUsMEJBQWtCLENBQUMsT0FBTztJQUNuQyxHQUFHLEVBQUUsMEJBQWtCLENBQUMsR0FBRztJQUMzQixNQUFNLEVBQUUsMEJBQWtCLENBQUMsTUFBTTtJQUNqQyxTQUFTLEVBQUUsMEJBQWtCLENBQUMsU0FBUztDQUMvQixDQUFDO0FBS0UsY0FBTSxHQUFHO0lBQ3BCLEtBQUssRUFBRSxDQUFDO0lBQ1IsTUFBTSxFQUFFLENBQUM7SUFDVCxLQUFLLEVBQUUsQ0FBQztJQUNSLEtBQUssRUFBRSxDQUFDO0NBQ0EsQ0FBQztBQU9YLFNBQWdCLGtCQUFrQixDQUFDLFNBQXVCLEVBQUU7SUFDMUQsTUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUM7SUFDaEMsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sSUFBSSxDQUFDLENBQUM7SUFDbEMsTUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUM7SUFDaEMsTUFBTSxLQUFLLEdBQUcsS0FBSyxHQUFHLE1BQU0sR0FBRyxLQUFLLENBQUM7SUFFckMsT0FBTztRQUNMLEtBQUs7UUFDTCxNQUFNO1FBQ04sS0FBSztRQUNMLEtBQUs7S0FDTixDQUFDO0FBQ0osQ0FBQzs7Ozs7Ozs7Ozs7O0FDeExELHFEOzs7Ozs7VUNBQTtVQUNBOztVQUVBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBOztVQUVBO1VBQ0E7O1VBRUE7VUFDQTtVQUNBOzs7O1VFdEJBO1VBQ0E7VUFDQTtVQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbW94aS93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vbW94aS8uLi8uLi9ub2RlX21vZHVsZXMvZm9udGZhY2VvYnNlcnZlci9mb250ZmFjZW9ic2VydmVyLnN0YW5kYWxvbmUuanMiLCJ3ZWJwYWNrOi8vbW94aS8uLi8uLi9ub2RlX21vZHVsZXMvcGxhbmNrL2Rpc3QvcGxhbmNrLmpzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9hc3NldC1sb2FkZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9jb3JlL2NhbWVyYS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvZW5naW5lLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9ldmVudC1zeXN0ZW0udHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9jb3JlL2xvZ2ljLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9tb3hpLWVudGl0eS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvcmVuZGVyLW1hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9jb3JlL3NjZW5lLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L2FzLXBpeGkudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L2NsaWVudC1ldmVudHMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L2ZvbnQtbG9hZGVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9ncmlkLWdlbmVyYXRvci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvbG9hZGluZy1zY2VuZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGFyYWxsYXgtYmFja2dyb3VuZC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGFyYWxsYXgtbGF5ZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BoeXNpY3MvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BoeXNpY3MvcGh5c2ljcy1ib2R5LWxvZ2ljLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3MtY29sbGlzaW9uLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3MtZGVidWctcmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BoeXNpY3MvcGh5c2ljcy1ncmFwaGljcy1wYXJzZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BoeXNpY3MvcGh5c2ljcy1tYXRlcmlhbHMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BoeXNpY3MvcGh5c2ljcy11dGlscy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGh5c2ljcy9waHlzaWNzLXdvcmxkLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9yZXNpemUtaGFuZGxlci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvc2V0dXAudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3N0YXRlLWxvZ2ljLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9zdGF0ZS1tYWNoaW5lLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9zdmctdXRpbHMvc3ZnLXRvLXRleHR1cmUudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3RleHR1cmUtZnJhbWUtc2VxdWVuY2VzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS90ZXh0dXJlLWZyYW1lcy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9VSUxheWVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvVUlTY2FsZU1vZGUudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL2J1dHRvbi1iYWNrZ3JvdW5kLXN0cmF0ZWd5LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS1ib3gudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL3VpLWJ1dHRvbi50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktbGFiZWwudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL3VpLXBhbmVsLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS1zY3JvbGwtY29udGFpbmVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS1zZWxlY3QudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL3VpLXRhYnMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL3VpLXRleHQtaW5wdXQudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL3VpLXRleHRhcmVhLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29yZS9ib3gtbW9kZWwudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb3JlL2VkZ2UtaW5zZXRzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29yZS91aS1jb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb3JlL3VpLWZvY3VzLW1hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9sYXlvdXQvZmxleC1jb250YWluZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9waXhlbC1ncmlkLnRzIiwid2VicGFjazovL21veGkvZXh0ZXJuYWwgdW1kIHtcImNvbW1vbmpzXCI6XCJwaXhpLmpzXCIsXCJjb21tb25qczJcIjpcInBpeGkuanNcIixcImFtZFwiOlwicGl4aS5qc1wiLFwicm9vdFwiOlwiUElYSVwifSIsIndlYnBhY2s6Ly9tb3hpL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL21veGkvd2VicGFjay9iZWZvcmUtc3RhcnR1cCIsIndlYnBhY2s6Ly9tb3hpL3dlYnBhY2svc3RhcnR1cCIsIndlYnBhY2s6Ly9tb3hpL3dlYnBhY2svYWZ0ZXItc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJwaXhpLmpzXCIpKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtcInBpeGkuanNcIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wibW94aVwiXSA9IGZhY3RvcnkocmVxdWlyZShcInBpeGkuanNcIikpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIm1veGlcIl0gPSBmYWN0b3J5KHJvb3RbXCJQSVhJXCJdKTtcbn0pKHNlbGYsIChfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX3BpeGlfanNfXykgPT4ge1xucmV0dXJuICIsIi8qIEZvbnQgRmFjZSBPYnNlcnZlciB2Mi4zLjAgLSDCqSBCcmFtIFN0ZWluLiBMaWNlbnNlOiBCU0QtMy1DbGF1c2UgKi8oZnVuY3Rpb24oKXtmdW5jdGlvbiBwKGEsYyl7ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcj9hLmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIixjLCExKTphLmF0dGFjaEV2ZW50KFwic2Nyb2xsXCIsYyl9ZnVuY3Rpb24gdShhKXtkb2N1bWVudC5ib2R5P2EoKTpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyP2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsZnVuY3Rpb24gYigpe2RvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsYik7YSgpfSk6ZG9jdW1lbnQuYXR0YWNoRXZlbnQoXCJvbnJlYWR5c3RhdGVjaGFuZ2VcIixmdW5jdGlvbiBnKCl7aWYoXCJpbnRlcmFjdGl2ZVwiPT1kb2N1bWVudC5yZWFkeVN0YXRlfHxcImNvbXBsZXRlXCI9PWRvY3VtZW50LnJlYWR5U3RhdGUpZG9jdW1lbnQuZGV0YWNoRXZlbnQoXCJvbnJlYWR5c3RhdGVjaGFuZ2VcIixnKSxhKCl9KX07ZnVuY3Rpb24gdyhhKXt0aGlzLmc9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTt0aGlzLmcuc2V0QXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIixcInRydWVcIik7dGhpcy5nLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGEpKTt0aGlzLmg9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7dGhpcy5pPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO3RoaXMubT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTt0aGlzLmo9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7dGhpcy5sPS0xO3RoaXMuaC5zdHlsZS5jc3NUZXh0PVwibWF4LXdpZHRoOm5vbmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7cG9zaXRpb246YWJzb2x1dGU7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTtvdmVyZmxvdzpzY3JvbGw7Zm9udC1zaXplOjE2cHg7XCI7dGhpcy5pLnN0eWxlLmNzc1RleHQ9XCJtYXgtd2lkdGg6bm9uZTtkaXNwbGF5OmlubGluZS1ibG9jaztwb3NpdGlvbjphYnNvbHV0ZTtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO292ZXJmbG93OnNjcm9sbDtmb250LXNpemU6MTZweDtcIjtcbnRoaXMuai5zdHlsZS5jc3NUZXh0PVwibWF4LXdpZHRoOm5vbmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7cG9zaXRpb246YWJzb2x1dGU7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTtvdmVyZmxvdzpzY3JvbGw7Zm9udC1zaXplOjE2cHg7XCI7dGhpcy5tLnN0eWxlLmNzc1RleHQ9XCJkaXNwbGF5OmlubGluZS1ibG9jazt3aWR0aDoyMDAlO2hlaWdodDoyMDAlO2ZvbnQtc2l6ZToxNnB4O21heC13aWR0aDpub25lO1wiO3RoaXMuaC5hcHBlbmRDaGlsZCh0aGlzLm0pO3RoaXMuaS5hcHBlbmRDaGlsZCh0aGlzLmopO3RoaXMuZy5hcHBlbmRDaGlsZCh0aGlzLmgpO3RoaXMuZy5hcHBlbmRDaGlsZCh0aGlzLmkpfVxuZnVuY3Rpb24geChhLGMpe2EuZy5zdHlsZS5jc3NUZXh0PVwibWF4LXdpZHRoOm5vbmU7bWluLXdpZHRoOjIwcHg7bWluLWhlaWdodDoyMHB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO292ZXJmbG93OmhpZGRlbjtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDphdXRvO21hcmdpbjowO3BhZGRpbmc6MDt0b3A6LTk5OXB4O3doaXRlLXNwYWNlOm5vd3JhcDtmb250LXN5bnRoZXNpczpub25lO2ZvbnQ6XCIrYytcIjtcIn1mdW5jdGlvbiBCKGEpe3ZhciBjPWEuZy5vZmZzZXRXaWR0aCxiPWMrMTAwO2Euai5zdHlsZS53aWR0aD1iK1wicHhcIjthLmkuc2Nyb2xsTGVmdD1iO2EuaC5zY3JvbGxMZWZ0PWEuaC5zY3JvbGxXaWR0aCsxMDA7cmV0dXJuIGEubCE9PWM/KGEubD1jLCEwKTohMX1mdW5jdGlvbiBDKGEsYyl7ZnVuY3Rpb24gYigpe3ZhciBlPWc7QihlKSYmbnVsbCE9PWUuZy5wYXJlbnROb2RlJiZjKGUubCl9dmFyIGc9YTtwKGEuaCxiKTtwKGEuaSxiKTtCKGEpfTtmdW5jdGlvbiBEKGEsYyxiKXtjPWN8fHt9O2I9Ynx8d2luZG93O3RoaXMuZmFtaWx5PWE7dGhpcy5zdHlsZT1jLnN0eWxlfHxcIm5vcm1hbFwiO3RoaXMud2VpZ2h0PWMud2VpZ2h0fHxcIm5vcm1hbFwiO3RoaXMuc3RyZXRjaD1jLnN0cmV0Y2h8fFwibm9ybWFsXCI7dGhpcy5jb250ZXh0PWJ9dmFyIEU9bnVsbCxGPW51bGwsRz1udWxsLEg9bnVsbDtmdW5jdGlvbiBJKGEpe251bGw9PT1GJiYoTShhKSYmL0FwcGxlLy50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudmVuZG9yKT8oYT0vQXBwbGVXZWJLaXRcXC8oWzAtOV0rKSg/OlxcLihbMC05XSspKSg/OlxcLihbMC05XSspKS8uZXhlYyh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCksRj0hIWEmJjYwMz5wYXJzZUludChhWzFdLDEwKSk6Rj0hMSk7cmV0dXJuIEZ9ZnVuY3Rpb24gTShhKXtudWxsPT09SCYmKEg9ISFhLmRvY3VtZW50LmZvbnRzKTtyZXR1cm4gSH1cbmZ1bmN0aW9uIE4oYSxjKXt2YXIgYj1hLnN0eWxlLGc9YS53ZWlnaHQ7aWYobnVsbD09PUcpe3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dHJ5e2Uuc3R5bGUuZm9udD1cImNvbmRlbnNlZCAxMDBweCBzYW5zLXNlcmlmXCJ9Y2F0Y2gocSl7fUc9XCJcIiE9PWUuc3R5bGUuZm9udH1yZXR1cm5bYixnLEc/YS5zdHJldGNoOlwiXCIsXCIxMDBweFwiLGNdLmpvaW4oXCIgXCIpfVxuRC5wcm90b3R5cGUubG9hZD1mdW5jdGlvbihhLGMpe3ZhciBiPXRoaXMsZz1hfHxcIkJFU2Jzd3lcIixlPTAscT1jfHwzRTMsSj0obmV3IERhdGUpLmdldFRpbWUoKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oSyxMKXtpZihNKGIuY29udGV4dCkmJiFJKGIuY29udGV4dCkpe3ZhciBPPW5ldyBQcm9taXNlKGZ1bmN0aW9uKHIsdCl7ZnVuY3Rpb24gaCgpeyhuZXcgRGF0ZSkuZ2V0VGltZSgpLUo+PXE/dChFcnJvcihcIlwiK3ErXCJtcyB0aW1lb3V0IGV4Y2VlZGVkXCIpKTpiLmNvbnRleHQuZG9jdW1lbnQuZm9udHMubG9hZChOKGIsJ1wiJytiLmZhbWlseSsnXCInKSxnKS50aGVuKGZ1bmN0aW9uKG4pezE8PW4ubGVuZ3RoP3IoKTpzZXRUaW1lb3V0KGgsMjUpfSx0KX1oKCl9KSxQPW5ldyBQcm9taXNlKGZ1bmN0aW9uKHIsdCl7ZT1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dChFcnJvcihcIlwiK3ErXCJtcyB0aW1lb3V0IGV4Y2VlZGVkXCIpKX0scSl9KTtQcm9taXNlLnJhY2UoW1AsT10pLnRoZW4oZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQoZSk7XG5LKGIpfSxMKX1lbHNlIHUoZnVuY3Rpb24oKXtmdW5jdGlvbiByKCl7dmFyIGQ7aWYoZD0tMSE9ayYmLTEhPWx8fC0xIT1rJiYtMSE9bXx8LTEhPWwmJi0xIT1tKShkPWshPWwmJmshPW0mJmwhPW0pfHwobnVsbD09PUUmJihkPS9BcHBsZVdlYktpdFxcLyhbMC05XSspKD86XFwuKFswLTldKykpLy5leGVjKHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KSxFPSEhZCYmKDUzNj5wYXJzZUludChkWzFdLDEwKXx8NTM2PT09cGFyc2VJbnQoZFsxXSwxMCkmJjExPj1wYXJzZUludChkWzJdLDEwKSkpLGQ9RSYmKGs9PXkmJmw9PXkmJm09PXl8fGs9PXomJmw9PXomJm09PXp8fGs9PUEmJmw9PUEmJm09PUEpKSxkPSFkO2QmJihudWxsIT09Zi5wYXJlbnROb2RlJiZmLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZiksY2xlYXJUaW1lb3V0KGUpLEsoYikpfWZ1bmN0aW9uIHQoKXtpZigobmV3IERhdGUpLmdldFRpbWUoKS1KPj1xKW51bGwhPT1mLnBhcmVudE5vZGUmJmYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmKSxcbkwoRXJyb3IoXCJcIitxK1wibXMgdGltZW91dCBleGNlZWRlZFwiKSk7ZWxzZXt2YXIgZD1iLmNvbnRleHQuZG9jdW1lbnQuaGlkZGVuO2lmKCEwPT09ZHx8dm9pZCAwPT09ZClrPWguZy5vZmZzZXRXaWR0aCxsPW4uZy5vZmZzZXRXaWR0aCxtPXYuZy5vZmZzZXRXaWR0aCxyKCk7ZT1zZXRUaW1lb3V0KHQsNTApfX12YXIgaD1uZXcgdyhnKSxuPW5ldyB3KGcpLHY9bmV3IHcoZyksaz0tMSxsPS0xLG09LTEseT0tMSx6PS0xLEE9LTEsZj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2YuZGlyPVwibHRyXCI7eChoLE4oYixcInNhbnMtc2VyaWZcIikpO3gobixOKGIsXCJzZXJpZlwiKSk7eCh2LE4oYixcIm1vbm9zcGFjZVwiKSk7Zi5hcHBlbmRDaGlsZChoLmcpO2YuYXBwZW5kQ2hpbGQobi5nKTtmLmFwcGVuZENoaWxkKHYuZyk7Yi5jb250ZXh0LmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZik7eT1oLmcub2Zmc2V0V2lkdGg7ej1uLmcub2Zmc2V0V2lkdGg7QT12Lmcub2Zmc2V0V2lkdGg7dCgpO1xuQyhoLGZ1bmN0aW9uKGQpe2s9ZDtyKCl9KTt4KGgsTihiLCdcIicrYi5mYW1pbHkrJ1wiLHNhbnMtc2VyaWYnKSk7QyhuLGZ1bmN0aW9uKGQpe2w9ZDtyKCl9KTt4KG4sTihiLCdcIicrYi5mYW1pbHkrJ1wiLHNlcmlmJykpO0ModixmdW5jdGlvbihkKXttPWQ7cigpfSk7eCh2LE4oYiwnXCInK2IuZmFtaWx5KydcIixtb25vc3BhY2UnKSl9KX0pfTtcIm9iamVjdFwiPT09dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1EOih3aW5kb3cuRm9udEZhY2VPYnNlcnZlcj1ELHdpbmRvdy5Gb250RmFjZU9ic2VydmVyLnByb3RvdHlwZS5sb2FkPUQucHJvdG90eXBlLmxvYWQpO30oKSk7XG4iLCIoZnVuY3Rpb24oZ2xvYmFsLCBmYWN0b3J5KSB7XG4gIHR5cGVvZiBleHBvcnRzID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIgPyBmYWN0b3J5KGV4cG9ydHMpIDogdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoW1wiZXhwb3J0c1wiXSwgZmFjdG9yeSkgOiAoZ2xvYmFsID0gdHlwZW9mIGdsb2JhbFRoaXMgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxUaGlzIDogZ2xvYmFsIHx8IHNlbGYsIGZhY3RvcnkoZ2xvYmFsLnBsYW5jayA9IHt9KSk7XG59KSh0aGlzLCBmdW5jdGlvbihleHBvcnRzMikge1xuICBcInVzZSBzdHJpY3RcIjsvKipcbiAqIFBsYW5jay5qcyB2MS40LjJcbiAqIEBsaWNlbnNlIFRoZSBNSVQgbGljZW5zZVxuICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMjUgRXJpbiBDYXR0bywgQWxpIFNoYWtpYmFcbiAqXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gKlxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICpcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcbiAqIFNPRlRXQVJFLlxuICovXG5cbiAgLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cbiAgXG4gICAgICBQZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcbiAgICAgIHB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cbiAgXG4gICAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXG4gICAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcbiAgICAgIEFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcbiAgICAgIElORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxuICAgICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcbiAgICAgIE9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcbiAgICAgIFBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXG4gICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xuICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQyLCBiMikge1xuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbihkMywgYjMpIHtcbiAgICAgIGQzLl9fcHJvdG9fXyA9IGIzO1xuICAgIH0gfHwgZnVuY3Rpb24oZDMsIGIzKSB7XG4gICAgICBmb3IgKHZhciBwIGluIGIzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIzLCBwKSkgZDNbcF0gPSBiM1twXTtcbiAgICB9O1xuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQyLCBiMik7XG4gIH07XG4gIGZ1bmN0aW9uIF9fZXh0ZW5kcyhkMiwgYjIpIHtcbiAgICBpZiAodHlwZW9mIGIyICE9PSBcImZ1bmN0aW9uXCIgJiYgYjIgIT09IG51bGwpXG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiMikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgIGV4dGVuZFN0YXRpY3MoZDIsIGIyKTtcbiAgICBmdW5jdGlvbiBfXygpIHtcbiAgICAgIHRoaXMuY29uc3RydWN0b3IgPSBkMjtcbiAgICB9XG4gICAgZDIucHJvdG90eXBlID0gYjIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIyKSA6IChfXy5wcm90b3R5cGUgPSBiMi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgfVxuICB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24yKHQpIHtcbiAgICAgIGZvciAodmFyIHMyLCBpID0gMSwgbjIgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjI7IGkrKykge1xuICAgICAgICBzMiA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgZm9yICh2YXIgcCBpbiBzMikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzMiwgcCkpIHRbcF0gPSBzMltwXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0O1xuICAgIH07XG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG4gIHZhciBvcHRpb25zID0gZnVuY3Rpb24oaW5wdXQyLCBkZWZhdWx0cykge1xuICAgIGlmIChpbnB1dDIgPT09IG51bGwgfHwgdHlwZW9mIGlucHV0MiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgaW5wdXQyID0ge307XG4gICAgfVxuICAgIHZhciBvdXRwdXQyID0gX19hc3NpZ24oe30sIGlucHV0Mik7XG4gICAgZm9yICh2YXIga2V5IGluIGRlZmF1bHRzKSB7XG4gICAgICBpZiAoZGVmYXVsdHMuaGFzT3duUHJvcGVydHkoa2V5KSAmJiB0eXBlb2YgaW5wdXQyW2tleV0gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgb3V0cHV0MltrZXldID0gZGVmYXVsdHNba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhkZWZhdWx0cyk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN5bWJvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHN5bWJvbCA9IHN5bWJvbHNbaV07XG4gICAgICAgIGlmIChkZWZhdWx0cy5wcm9wZXJ0eUlzRW51bWVyYWJsZShzeW1ib2wpICYmIHR5cGVvZiBpbnB1dDJbc3ltYm9sXSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIG91dHB1dDJbc3ltYm9sXSA9IGRlZmF1bHRzW3N5bWJvbF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dDI7XG4gIH07XG4gIHZhciBtYXRoX3JhbmRvbSA9IE1hdGgucmFuZG9tO1xuICB2YXIgRVBTSUxPTiA9IDFlLTk7XG4gIHZhciBpc0Zpbml0ZSA9IE51bWJlci5pc0Zpbml0ZTtcbiAgZnVuY3Rpb24gbmV4dFBvd2VyT2ZUd28oeDIpIHtcbiAgICB4MiB8PSB4MiA+PiAxO1xuICAgIHgyIHw9IHgyID4+IDI7XG4gICAgeDIgfD0geDIgPj4gNDtcbiAgICB4MiB8PSB4MiA+PiA4O1xuICAgIHgyIHw9IHgyID4+IDE2O1xuICAgIHJldHVybiB4MiArIDE7XG4gIH1cbiAgZnVuY3Rpb24gaXNQb3dlck9mVHdvKHgyKSB7XG4gICAgcmV0dXJuIHgyID4gMCAmJiAoeDIgJiB4MiAtIDEpID09PSAwO1xuICB9XG4gIGZ1bmN0aW9uIG1vZChudW0sIG1pbiwgbWF4KSB7XG4gICAgaWYgKHR5cGVvZiBtaW4gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIG1heCA9IDE7XG4gICAgICBtaW4gPSAwO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIG1heCA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgbWF4ID0gbWluO1xuICAgICAgbWluID0gMDtcbiAgICB9XG4gICAgaWYgKG1heCA+IG1pbikge1xuICAgICAgbnVtID0gKG51bSAtIG1pbikgJSAobWF4IC0gbWluKTtcbiAgICAgIHJldHVybiBudW0gKyAobnVtIDwgMCA/IG1heCA6IG1pbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIG51bSA9IChudW0gLSBtYXgpICUgKG1pbiAtIG1heCk7XG4gICAgICByZXR1cm4gbnVtICsgKG51bSA8PSAwID8gbWluIDogbWF4KTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gY2xhbXAobnVtLCBtaW4sIG1heCkge1xuICAgIGlmIChudW0gPCBtaW4pIHtcbiAgICAgIHJldHVybiBtaW47XG4gICAgfSBlbHNlIGlmIChudW0gPiBtYXgpIHtcbiAgICAgIHJldHVybiBtYXg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBudW07XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIHJhbmRvbShtaW4sIG1heCkge1xuICAgIGlmICh0eXBlb2YgbWluID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBtYXggPSAxO1xuICAgICAgbWluID0gMDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBtYXggPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIG1heCA9IG1pbjtcbiAgICAgIG1pbiA9IDA7XG4gICAgfVxuICAgIHJldHVybiBtaW4gPT09IG1heCA/IG1pbiA6IG1hdGhfcmFuZG9tKCkgKiAobWF4IC0gbWluKSArIG1pbjtcbiAgfVxuICB2YXIgbWF0aCA9IE9iamVjdC5jcmVhdGUoTWF0aCk7XG4gIG1hdGguRVBTSUxPTiA9IEVQU0lMT047XG4gIG1hdGguaXNGaW5pdGUgPSBpc0Zpbml0ZTtcbiAgbWF0aC5uZXh0UG93ZXJPZlR3byA9IG5leHRQb3dlck9mVHdvO1xuICBtYXRoLmlzUG93ZXJPZlR3byA9IGlzUG93ZXJPZlR3bztcbiAgbWF0aC5tb2QgPSBtb2Q7XG4gIG1hdGguY2xhbXAgPSBjbGFtcDtcbiAgbWF0aC5yYW5kb20gPSByYW5kb207XG4gIHZhciBtYXRoX2FicyQ5ID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX3NxcnQkNSA9IE1hdGguc3FydDtcbiAgdmFyIG1hdGhfbWF4JDggPSBNYXRoLm1heDtcbiAgdmFyIG1hdGhfbWluJDggPSBNYXRoLm1pbjtcbiAgdmFyIFZlYzIgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVmVjMjIoeDIsIHkpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFZlYzIyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgVmVjMjIoeDIsIHkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgeDIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0aGlzLnggPSAwO1xuICAgICAgICAgIHRoaXMueSA9IDA7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHgyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy54ID0geDIueDtcbiAgICAgICAgICB0aGlzLnkgPSB4Mi55O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMueCA9IHgyO1xuICAgICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFZlYzIyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgeDogdGhpcy54LFxuICAgICAgICAgIHk6IHRoaXMueVxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFZlYzIyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVmVjMjIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnggPSBkYXRhLng7XG4gICAgICAgIG9iai55ID0gZGF0YS55O1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnplcm8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVmVjMjIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnggPSAwO1xuICAgICAgICBvYmoueSA9IDA7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVmVjMjIubmVvID0gZnVuY3Rpb24oeDIsIHkpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVmVjMjIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnggPSB4MjtcbiAgICAgICAgb2JqLnkgPSB5O1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmNsb25lID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh2My54LCB2My55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOdW1iZXIuaXNGaW5pdGUob2JqLngpICYmIE51bWJlci5pc0Zpbml0ZShvYmoueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuYXNzZXJ0ID0gZnVuY3Rpb24obykge1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVmVjMjIuY2xvbmUodGhpcyk7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnNldFplcm8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy54ID0gMDtcbiAgICAgICAgdGhpcy55ID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHgyLCB5KSB7XG4gICAgICAgIGlmICh0eXBlb2YgeDIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLnggPSB4Mi54O1xuICAgICAgICAgIHRoaXMueSA9IHgyLnk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy54ID0geDI7XG4gICAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc2V0TnVtID0gZnVuY3Rpb24oeDIsIHkpIHtcbiAgICAgICAgdGhpcy54ID0geDI7XG4gICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zZXRWZWMyID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdGhpcy54ID0gdmFsdWUueDtcbiAgICAgICAgdGhpcy55ID0gdmFsdWUueTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLndTZXQgPSBmdW5jdGlvbihhMiwgdjMsIGIyLCB3KSB7XG4gICAgICAgIGlmICh0eXBlb2YgYjIgIT09IFwidW5kZWZpbmVkXCIgfHwgdHlwZW9mIHcgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zZXRDb21iaW5lKGEyLCB2MywgYjIsIHcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLnNldE11bChhMiwgdjMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnNldENvbWJpbmUgPSBmdW5jdGlvbihhMiwgdjMsIGIyLCB3KSB7XG4gICAgICAgIHZhciB4MiA9IGEyICogdjMueCArIGIyICogdy54O1xuICAgICAgICB2YXIgeSA9IGEyICogdjMueSArIGIyICogdy55O1xuICAgICAgICB0aGlzLnggPSB4MjtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnNldE11bCA9IGZ1bmN0aW9uKGEyLCB2Mykge1xuICAgICAgICB2YXIgeDIgPSBhMiAqIHYzLng7XG4gICAgICAgIHZhciB5ID0gYTIgKiB2My55O1xuICAgICAgICB0aGlzLnggPSB4MjtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKHcpIHtcbiAgICAgICAgdGhpcy54ICs9IHcueDtcbiAgICAgICAgdGhpcy55ICs9IHcueTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLndBZGQgPSBmdW5jdGlvbihhMiwgdjMsIGIyLCB3KSB7XG4gICAgICAgIGlmICh0eXBlb2YgYjIgIT09IFwidW5kZWZpbmVkXCIgfHwgdHlwZW9mIHcgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5hZGRDb21iaW5lKGEyLCB2MywgYjIsIHcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLmFkZE11bChhMiwgdjMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLmFkZENvbWJpbmUgPSBmdW5jdGlvbihhMiwgdjMsIGIyLCB3KSB7XG4gICAgICAgIHZhciB4MiA9IGEyICogdjMueCArIGIyICogdy54O1xuICAgICAgICB2YXIgeSA9IGEyICogdjMueSArIGIyICogdy55O1xuICAgICAgICB0aGlzLnggKz0geDI7XG4gICAgICAgIHRoaXMueSArPSB5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuYWRkTXVsID0gZnVuY3Rpb24oYTIsIHYzKSB7XG4gICAgICAgIHZhciB4MiA9IGEyICogdjMueDtcbiAgICAgICAgdmFyIHkgPSBhMiAqIHYzLnk7XG4gICAgICAgIHRoaXMueCArPSB4MjtcbiAgICAgICAgdGhpcy55ICs9IHk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS53U3ViID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICBpZiAodHlwZW9mIGIyICE9PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiB3ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc3ViQ29tYmluZShhMiwgdjMsIGIyLCB3KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zdWJNdWwoYTIsIHYzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zdWJDb21iaW5lID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICB2YXIgeDIgPSBhMiAqIHYzLnggKyBiMiAqIHcueDtcbiAgICAgICAgdmFyIHkgPSBhMiAqIHYzLnkgKyBiMiAqIHcueTtcbiAgICAgICAgdGhpcy54IC09IHgyO1xuICAgICAgICB0aGlzLnkgLT0geTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnN1Yk11bCA9IGZ1bmN0aW9uKGEyLCB2Mykge1xuICAgICAgICB2YXIgeDIgPSBhMiAqIHYzLng7XG4gICAgICAgIHZhciB5ID0gYTIgKiB2My55O1xuICAgICAgICB0aGlzLnggLT0geDI7XG4gICAgICAgIHRoaXMueSAtPSB5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc3ViID0gZnVuY3Rpb24odykge1xuICAgICAgICB0aGlzLnggLT0gdy54O1xuICAgICAgICB0aGlzLnkgLT0gdy55O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUubXVsID0gZnVuY3Rpb24obSkge1xuICAgICAgICB0aGlzLnggKj0gbTtcbiAgICAgICAgdGhpcy55ICo9IG07XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLmxlbmd0aE9mKHRoaXMpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5sZW5ndGhTcXVhcmVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5sZW5ndGhTcXVhcmVkKHRoaXMpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5ub3JtYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHRoaXMubGVuZ3RoKCk7XG4gICAgICAgIGlmIChsZW5ndGggPCBFUFNJTE9OKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGludkxlbmd0aCA9IDEgLyBsZW5ndGg7XG4gICAgICAgIHRoaXMueCAqPSBpbnZMZW5ndGg7XG4gICAgICAgIHRoaXMueSAqPSBpbnZMZW5ndGg7XG4gICAgICAgIHJldHVybiBsZW5ndGg7XG4gICAgICB9O1xuICAgICAgVmVjMjIubm9ybWFsaXplID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IFZlYzIyLmxlbmd0aE9mKHYzKTtcbiAgICAgICAgaWYgKGxlbmd0aCA8IEVQU0lMT04pIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIuemVybygpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnZMZW5ndGggPSAxIC8gbGVuZ3RoO1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKHYzLnggKiBpbnZMZW5ndGgsIHYzLnkgKiBpbnZMZW5ndGgpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmxlbmd0aE9mID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIG1hdGhfc3FydCQ1KHYzLnggKiB2My54ICsgdjMueSAqIHYzLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmxlbmd0aFNxdWFyZWQgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICByZXR1cm4gdjMueCAqIHYzLnggKyB2My55ICogdjMueTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5kaXN0YW5jZSA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHZhciBkeCA9IHYzLnggLSB3Lng7XG4gICAgICAgIHZhciBkeSA9IHYzLnkgLSB3Lnk7XG4gICAgICAgIHJldHVybiBtYXRoX3NxcnQkNShkeCAqIGR4ICsgZHkgKiBkeSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuZGlzdGFuY2VTcXVhcmVkID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgdmFyIGR4ID0gdjMueCAtIHcueDtcbiAgICAgICAgdmFyIGR5ID0gdjMueSAtIHcueTtcbiAgICAgICAgcmV0dXJuIGR4ICogZHggKyBkeSAqIGR5O1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmFyZUVxdWFsID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIHYzID09PSB3IHx8IHR5cGVvZiB3ID09PSBcIm9iamVjdFwiICYmIHcgIT09IG51bGwgJiYgdjMueCA9PT0gdy54ICYmIHYzLnkgPT09IHcueTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5za2V3ID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMueSwgdjMueCk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuZG90ID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIHYzLnggKiB3LnggKyB2My55ICogdy55O1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmNyb3NzID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3ID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh3ICogdjMueSwgLXcgKiB2My54KTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdjMgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIubmVvKC12MyAqIHcueSwgdjMgKiB3LngpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB2My54ICogdy55IC0gdjMueSAqIHcueDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFZlYzIyLmNyb3NzVmVjMlZlYzIgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gdjMueCAqIHcueSAtIHYzLnkgKiB3Lng7XG4gICAgICB9O1xuICAgICAgVmVjMjIuY3Jvc3NWZWMyTnVtID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh3ICogdjMueSwgLXcgKiB2My54KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5jcm9zc051bVZlYzIgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKC12MyAqIHcueSwgdjMgKiB3LngpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmFkZENyb3NzID0gZnVuY3Rpb24oYTIsIHYzLCB3KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8odyAqIHYzLnkgKyBhMi54LCAtdyAqIHYzLnggKyBhMi55KTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdjMgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIubmVvKC12MyAqIHcueSArIGEyLngsIHYzICogdy54ICsgYTIueSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBWZWMyMi5hZGRDcm9zc1ZlYzJOdW0gPSBmdW5jdGlvbihhMiwgdjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh3ICogdjMueSArIGEyLngsIC13ICogdjMueCArIGEyLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmFkZENyb3NzTnVtVmVjMiA9IGZ1bmN0aW9uKGEyLCB2Mywgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKC12MyAqIHcueSArIGEyLngsIHYzICogdy54ICsgYTIueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuYWRkID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh2My54ICsgdy54LCB2My55ICsgdy55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi53QWRkID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICBpZiAodHlwZW9mIGIyICE9PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiB3ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLmNvbWJpbmUoYTIsIHYzLCBiMiwgdyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm11bE51bVZlYzIoYTIsIHYzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFZlYzIyLmNvbWJpbmUgPSBmdW5jdGlvbihhMiwgdjMsIGIyLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi56ZXJvKCkuc2V0Q29tYmluZShhMiwgdjMsIGIyLCB3KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5zdWIgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKHYzLnggLSB3LngsIHYzLnkgLSB3LnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLm11bCA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICBpZiAodHlwZW9mIGEyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyhhMi54ICogYjIsIGEyLnkgKiBiMik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGIyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyhhMiAqIGIyLngsIGEyICogYjIueSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBWZWMyMi5tdWxWZWMyTnVtID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8oYTIueCAqIGIyLCBhMi55ICogYjIpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLm11bE51bVZlYzIgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyhhMiAqIGIyLngsIGEyICogYjIueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLm5lZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnggPSAtdGhpcy54O1xuICAgICAgICB0aGlzLnkgPSAtdGhpcy55O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5uZWcgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKC12My54LCAtdjMueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuYWJzID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyhtYXRoX2FicyQ5KHYzLngpLCBtYXRoX2FicyQ5KHYzLnkpKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5taWQgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKCh2My54ICsgdy54KSAqIDAuNSwgKHYzLnkgKyB3LnkpICogMC41KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi51cHBlciA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8obWF0aF9tYXgkOCh2My54LCB3LngpLCBtYXRoX21heCQ4KHYzLnksIHcueSkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmxvd2VyID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyhtYXRoX21pbiQ4KHYzLngsIHcueCksIG1hdGhfbWluJDgodjMueSwgdy55KSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLmNsYW1wID0gZnVuY3Rpb24obWF4KSB7XG4gICAgICAgIHZhciBsZW5ndGhTcXIgPSB0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnk7XG4gICAgICAgIGlmIChsZW5ndGhTcXIgPiBtYXggKiBtYXgpIHtcbiAgICAgICAgICB2YXIgc2NhbGUgPSBtYXggLyBtYXRoX3NxcnQkNShsZW5ndGhTcXIpO1xuICAgICAgICAgIHRoaXMueCAqPSBzY2FsZTtcbiAgICAgICAgICB0aGlzLnkgKj0gc2NhbGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIuY2xhbXAgPSBmdW5jdGlvbih2MywgbWF4KSB7XG4gICAgICAgIHZhciByID0gVmVjMjIubmVvKHYzLngsIHYzLnkpO1xuICAgICAgICByLmNsYW1wKG1heCk7XG4gICAgICAgIHJldHVybiByO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmNsYW1wVmVjMiA9IGZ1bmN0aW9uKHYzLCBtaW4sIG1heCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHg6IGNsYW1wKHYzLngsIG1pbiA9PT0gbnVsbCB8fCBtaW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG1pbi54LCBtYXggPT09IG51bGwgfHwgbWF4ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtYXgueCksXG4gICAgICAgICAgeTogY2xhbXAodjMueSwgbWluID09PSBudWxsIHx8IG1pbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbWluLnksIG1heCA9PT0gbnVsbCB8fCBtYXggPT09IHZvaWQgMCA/IHZvaWQgMCA6IG1heC55KVxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnNjYWxlRm4gPSBmdW5jdGlvbih4MiwgeSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIubmVvKHYzLnggKiB4MiwgdjMueSAqIHkpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnRyYW5zbGF0ZUZuID0gZnVuY3Rpb24oeDIsIHkpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh2My54ICsgeDIsIHYzLnkgKyB5KTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVmVjMjI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX21heCQ3ID0gTWF0aC5tYXg7XG4gIHZhciBtYXRoX21pbiQ3ID0gTWF0aC5taW47XG4gIHZhciBBQUJCID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEFBQkIyKGxvd2VyLCB1cHBlcikge1xuICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgQUFCQjIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBBQUJCMihsb3dlciwgdXBwZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubG93ZXJCb3VuZCA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLnVwcGVyQm91bmQgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgaWYgKHR5cGVvZiBsb3dlciA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMubG93ZXJCb3VuZC5zZXRWZWMyKGxvd2VyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHVwcGVyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy51cHBlckJvdW5kLnNldFZlYzIodXBwZXIpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBsb3dlciA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMudXBwZXJCb3VuZC5zZXRWZWMyKGxvd2VyKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgQUFCQjIucHJvdG90eXBlLmlzVmFsaWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEFBQkIyLmlzVmFsaWQodGhpcyk7XG4gICAgICB9O1xuICAgICAgQUFCQjIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFZlYzIuaXNWYWxpZChvYmoubG93ZXJCb3VuZCkgJiYgVmVjMi5pc1ZhbGlkKG9iai51cHBlckJvdW5kKSAmJiBWZWMyLnN1YihvYmoudXBwZXJCb3VuZCwgb2JqLmxvd2VyQm91bmQpLmxlbmd0aFNxdWFyZWQoKSA+PSAwO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLmFzc2VydCA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUuZ2V0Q2VudGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbygodGhpcy5sb3dlckJvdW5kLnggKyB0aGlzLnVwcGVyQm91bmQueCkgKiAwLjUsICh0aGlzLmxvd2VyQm91bmQueSArIHRoaXMudXBwZXJCb3VuZC55KSAqIDAuNSk7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmdldEV4dGVudHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKCh0aGlzLnVwcGVyQm91bmQueCAtIHRoaXMubG93ZXJCb3VuZC54KSAqIDAuNSwgKHRoaXMudXBwZXJCb3VuZC55IC0gdGhpcy5sb3dlckJvdW5kLnkpICogMC41KTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUuZ2V0UGVyaW1ldGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAyICogKHRoaXMudXBwZXJCb3VuZC54IC0gdGhpcy5sb3dlckJvdW5kLnggKyB0aGlzLnVwcGVyQm91bmQueSAtIHRoaXMubG93ZXJCb3VuZC55KTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUuY29tYmluZSA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICBiMiA9IGIyIHx8IHRoaXM7XG4gICAgICAgIHZhciBsb3dlckEgPSBhMi5sb3dlckJvdW5kO1xuICAgICAgICB2YXIgdXBwZXJBID0gYTIudXBwZXJCb3VuZDtcbiAgICAgICAgdmFyIGxvd2VyQiA9IGIyLmxvd2VyQm91bmQ7XG4gICAgICAgIHZhciB1cHBlckIgPSBiMi51cHBlckJvdW5kO1xuICAgICAgICB2YXIgbG93ZXJYID0gbWF0aF9taW4kNyhsb3dlckEueCwgbG93ZXJCLngpO1xuICAgICAgICB2YXIgbG93ZXJZID0gbWF0aF9taW4kNyhsb3dlckEueSwgbG93ZXJCLnkpO1xuICAgICAgICB2YXIgdXBwZXJYID0gbWF0aF9tYXgkNyh1cHBlckIueCwgdXBwZXJBLngpO1xuICAgICAgICB2YXIgdXBwZXJZID0gbWF0aF9tYXgkNyh1cHBlckIueSwgdXBwZXJBLnkpO1xuICAgICAgICB0aGlzLmxvd2VyQm91bmQuc2V0TnVtKGxvd2VyWCwgbG93ZXJZKTtcbiAgICAgICAgdGhpcy51cHBlckJvdW5kLnNldE51bSh1cHBlclgsIHVwcGVyWSk7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmNvbWJpbmVQb2ludHMgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdGhpcy5sb3dlckJvdW5kLnNldE51bShtYXRoX21pbiQ3KGEyLngsIGIyLngpLCBtYXRoX21pbiQ3KGEyLnksIGIyLnkpKTtcbiAgICAgICAgdGhpcy51cHBlckJvdW5kLnNldE51bShtYXRoX21heCQ3KGEyLngsIGIyLngpLCBtYXRoX21heCQ3KGEyLnksIGIyLnkpKTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24oYWFiYikge1xuICAgICAgICB0aGlzLmxvd2VyQm91bmQuc2V0TnVtKGFhYmIubG93ZXJCb3VuZC54LCBhYWJiLmxvd2VyQm91bmQueSk7XG4gICAgICAgIHRoaXMudXBwZXJCb3VuZC5zZXROdW0oYWFiYi51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC55KTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUuY29udGFpbnMgPSBmdW5jdGlvbihhYWJiKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB0cnVlO1xuICAgICAgICByZXN1bHQgPSByZXN1bHQgJiYgdGhpcy5sb3dlckJvdW5kLnggPD0gYWFiYi5sb3dlckJvdW5kLng7XG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiB0aGlzLmxvd2VyQm91bmQueSA8PSBhYWJiLmxvd2VyQm91bmQueTtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIGFhYmIudXBwZXJCb3VuZC54IDw9IHRoaXMudXBwZXJCb3VuZC54O1xuICAgICAgICByZXN1bHQgPSByZXN1bHQgJiYgYWFiYi51cHBlckJvdW5kLnkgPD0gdGhpcy51cHBlckJvdW5kLnk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmV4dGVuZCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIEFBQkIyLmV4dGVuZCh0aGlzLCB2YWx1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLmV4dGVuZCA9IGZ1bmN0aW9uKG91dCwgdmFsdWUpIHtcbiAgICAgICAgb3V0Lmxvd2VyQm91bmQueCAtPSB2YWx1ZTtcbiAgICAgICAgb3V0Lmxvd2VyQm91bmQueSAtPSB2YWx1ZTtcbiAgICAgICAgb3V0LnVwcGVyQm91bmQueCArPSB2YWx1ZTtcbiAgICAgICAgb3V0LnVwcGVyQm91bmQueSArPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgIH07XG4gICAgICBBQUJCMi50ZXN0T3ZlcmxhcCA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgZDF4ID0gYjIubG93ZXJCb3VuZC54IC0gYTIudXBwZXJCb3VuZC54O1xuICAgICAgICB2YXIgZDJ4ID0gYTIubG93ZXJCb3VuZC54IC0gYjIudXBwZXJCb3VuZC54O1xuICAgICAgICB2YXIgZDF5ID0gYjIubG93ZXJCb3VuZC55IC0gYTIudXBwZXJCb3VuZC55O1xuICAgICAgICB2YXIgZDJ5ID0gYTIubG93ZXJCb3VuZC55IC0gYjIudXBwZXJCb3VuZC55O1xuICAgICAgICBpZiAoZDF4ID4gMCB8fCBkMXkgPiAwIHx8IGQyeCA+IDAgfHwgZDJ5ID4gMCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5hcmVFcXVhbCA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICByZXR1cm4gVmVjMi5hcmVFcXVhbChhMi5sb3dlckJvdW5kLCBiMi5sb3dlckJvdW5kKSAmJiBWZWMyLmFyZUVxdWFsKGEyLnVwcGVyQm91bmQsIGIyLnVwcGVyQm91bmQpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLmRpZmYgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIHdEID0gbWF0aF9tYXgkNygwLCBtYXRoX21pbiQ3KGEyLnVwcGVyQm91bmQueCwgYjIudXBwZXJCb3VuZC54KSAtIG1hdGhfbWF4JDcoYjIubG93ZXJCb3VuZC54LCBhMi5sb3dlckJvdW5kLngpKTtcbiAgICAgICAgdmFyIGhEID0gbWF0aF9tYXgkNygwLCBtYXRoX21pbiQ3KGEyLnVwcGVyQm91bmQueSwgYjIudXBwZXJCb3VuZC55KSAtIG1hdGhfbWF4JDcoYjIubG93ZXJCb3VuZC55LCBhMi5sb3dlckJvdW5kLnkpKTtcbiAgICAgICAgdmFyIHdBID0gYTIudXBwZXJCb3VuZC54IC0gYTIubG93ZXJCb3VuZC54O1xuICAgICAgICB2YXIgaEEgPSBhMi51cHBlckJvdW5kLnkgLSBhMi5sb3dlckJvdW5kLnk7XG4gICAgICAgIHZhciB3QiA9IGIyLnVwcGVyQm91bmQueCAtIGIyLmxvd2VyQm91bmQueDtcbiAgICAgICAgdmFyIGhCID0gYjIudXBwZXJCb3VuZC55IC0gYjIubG93ZXJCb3VuZC55O1xuICAgICAgICByZXR1cm4gd0EgKiBoQSArIHdCICogaEIgLSB3RCAqIGhEO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyKSB7XG4gICAgICAgIHZhciB0bWluID0gLUluZmluaXR5O1xuICAgICAgICB2YXIgdG1heCA9IEluZmluaXR5O1xuICAgICAgICB2YXIgcCA9IGlucHV0Mi5wMTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi5zdWIoaW5wdXQyLnAyLCBpbnB1dDIucDEpO1xuICAgICAgICB2YXIgYWJzRCA9IFZlYzIuYWJzKGQyKTtcbiAgICAgICAgdmFyIG5vcm1hbDMgPSBWZWMyLnplcm8oKTtcbiAgICAgICAge1xuICAgICAgICAgIGlmIChhYnNELnggPCBFUFNJTE9OKSB7XG4gICAgICAgICAgICBpZiAocC54IDwgdGhpcy5sb3dlckJvdW5kLnggfHwgdGhpcy51cHBlckJvdW5kLnggPCBwLngpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgaW52X2QgPSAxIC8gZDIueDtcbiAgICAgICAgICAgIHZhciB0MSA9ICh0aGlzLmxvd2VyQm91bmQueCAtIHAueCkgKiBpbnZfZDtcbiAgICAgICAgICAgIHZhciB0MiA9ICh0aGlzLnVwcGVyQm91bmQueCAtIHAueCkgKiBpbnZfZDtcbiAgICAgICAgICAgIHZhciBzMiA9IC0xO1xuICAgICAgICAgICAgaWYgKHQxID4gdDIpIHtcbiAgICAgICAgICAgICAgdmFyIHRlbXAzID0gdDE7XG4gICAgICAgICAgICAgIHQxID0gdDI7XG4gICAgICAgICAgICAgIHQyID0gdGVtcDM7XG4gICAgICAgICAgICAgIHMyID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0MSA+IHRtaW4pIHtcbiAgICAgICAgICAgICAgbm9ybWFsMy5zZXRaZXJvKCk7XG4gICAgICAgICAgICAgIG5vcm1hbDMueCA9IHMyO1xuICAgICAgICAgICAgICB0bWluID0gdDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0bWF4ID0gbWF0aF9taW4kNyh0bWF4LCB0Mik7XG4gICAgICAgICAgICBpZiAodG1pbiA+IHRtYXgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgaWYgKGFic0QueSA8IEVQU0lMT04pIHtcbiAgICAgICAgICAgIGlmIChwLnkgPCB0aGlzLmxvd2VyQm91bmQueSB8fCB0aGlzLnVwcGVyQm91bmQueSA8IHAueSkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBpbnZfZCA9IDEgLyBkMi55O1xuICAgICAgICAgICAgdmFyIHQxID0gKHRoaXMubG93ZXJCb3VuZC55IC0gcC55KSAqIGludl9kO1xuICAgICAgICAgICAgdmFyIHQyID0gKHRoaXMudXBwZXJCb3VuZC55IC0gcC55KSAqIGludl9kO1xuICAgICAgICAgICAgdmFyIHMyID0gLTE7XG4gICAgICAgICAgICBpZiAodDEgPiB0Mikge1xuICAgICAgICAgICAgICB2YXIgdGVtcDMgPSB0MTtcbiAgICAgICAgICAgICAgdDEgPSB0MjtcbiAgICAgICAgICAgICAgdDIgPSB0ZW1wMztcbiAgICAgICAgICAgICAgczIgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHQxID4gdG1pbikge1xuICAgICAgICAgICAgICBub3JtYWwzLnNldFplcm8oKTtcbiAgICAgICAgICAgICAgbm9ybWFsMy55ID0gczI7XG4gICAgICAgICAgICAgIHRtaW4gPSB0MTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRtYXggPSBtYXRoX21pbiQ3KHRtYXgsIHQyKTtcbiAgICAgICAgICAgIGlmICh0bWluID4gdG1heCkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0bWluIDwgMCB8fCBpbnB1dDIubWF4RnJhY3Rpb24gPCB0bWluKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIG91dHB1dDIuZnJhY3Rpb24gPSB0bWluO1xuICAgICAgICBvdXRwdXQyLm5vcm1hbCA9IG5vcm1hbDM7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyk7XG4gICAgICB9O1xuICAgICAgQUFCQjIuY29tYmluZVBvaW50cyA9IGZ1bmN0aW9uKG91dCwgYTIsIGIyKSB7XG4gICAgICAgIG91dC5sb3dlckJvdW5kLnggPSBtYXRoX21pbiQ3KGEyLngsIGIyLngpO1xuICAgICAgICBvdXQubG93ZXJCb3VuZC55ID0gbWF0aF9taW4kNyhhMi55LCBiMi55KTtcbiAgICAgICAgb3V0LnVwcGVyQm91bmQueCA9IG1hdGhfbWF4JDcoYTIueCwgYjIueCk7XG4gICAgICAgIG91dC51cHBlckJvdW5kLnkgPSBtYXRoX21heCQ3KGEyLnksIGIyLnkpO1xuICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgfTtcbiAgICAgIEFBQkIyLmNvbWJpbmVkUGVyaW1ldGVyID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciBseCA9IG1hdGhfbWluJDcoYTIubG93ZXJCb3VuZC54LCBiMi5sb3dlckJvdW5kLngpO1xuICAgICAgICB2YXIgbHkgPSBtYXRoX21pbiQ3KGEyLmxvd2VyQm91bmQueSwgYjIubG93ZXJCb3VuZC55KTtcbiAgICAgICAgdmFyIHV4ID0gbWF0aF9tYXgkNyhhMi51cHBlckJvdW5kLngsIGIyLnVwcGVyQm91bmQueCk7XG4gICAgICAgIHZhciB1eSA9IG1hdGhfbWF4JDcoYTIudXBwZXJCb3VuZC55LCBiMi51cHBlckJvdW5kLnkpO1xuICAgICAgICByZXR1cm4gMiAqICh1eCAtIGx4ICsgdXkgLSBseSk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIEFBQkIyO1xuICAgIH0oKVxuICApO1xuICB2YXIgbWF0aF9QSSQ2ID0gTWF0aC5QSTtcbiAgdmFyIFNldHRpbmdzID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNldHRpbmdzMigpIHtcbiAgICAgIH1cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nczIsIFwicG9seWdvblJhZGl1c1wiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcmFkaXVzIG9mIHRoZSBwb2x5Z29uL2VkZ2Ugc2hhcGUgc2tpbi4gVGhpcyBzaG91bGQgbm90IGJlIG1vZGlmaWVkLlxuICAgICAgICAgKiBNYWtpbmcgdGhpcyBzbWFsbGVyIG1lYW5zIHBvbHlnb25zIHdpbGwgaGF2ZSBhbiBpbnN1ZmZpY2llbnQgYnVmZmVyIGZvclxuICAgICAgICAgKiBjb250aW51b3VzIGNvbGxpc2lvbi4gTWFraW5nIGl0IGxhcmdlciBtYXkgY3JlYXRlIGFydGlmYWN0cyBmb3IgdmVydGV4XG4gICAgICAgICAqIGNvbGxpc2lvbi5cbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIDIgKiBTZXR0aW5nczIubGluZWFyU2xvcDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBTZXR0aW5nczIubGVuZ3RoVW5pdHNQZXJNZXRlciA9IDE7XG4gICAgICBTZXR0aW5nczIubWF4TWFuaWZvbGRQb2ludHMgPSAyO1xuICAgICAgU2V0dGluZ3MyLm1heFBvbHlnb25WZXJ0aWNlcyA9IDEyO1xuICAgICAgU2V0dGluZ3MyLmFhYmJFeHRlbnNpb24gPSAwLjE7XG4gICAgICBTZXR0aW5nczIuYWFiYk11bHRpcGxpZXIgPSAyO1xuICAgICAgU2V0dGluZ3MyLmxpbmVhclNsb3AgPSA1ZS0zO1xuICAgICAgU2V0dGluZ3MyLmFuZ3VsYXJTbG9wID0gMiAvIDE4MCAqIG1hdGhfUEkkNjtcbiAgICAgIFNldHRpbmdzMi5tYXhTdWJTdGVwcyA9IDg7XG4gICAgICBTZXR0aW5nczIubWF4VE9JQ29udGFjdHMgPSAzMjtcbiAgICAgIFNldHRpbmdzMi5tYXhUT0lJdGVyYXRpb25zID0gMjA7XG4gICAgICBTZXR0aW5nczIubWF4RGlzdGFuY2VJdGVyYXRpb25zID0gMjA7XG4gICAgICBTZXR0aW5nczIudmVsb2NpdHlUaHJlc2hvbGQgPSAxO1xuICAgICAgU2V0dGluZ3MyLm1heExpbmVhckNvcnJlY3Rpb24gPSAwLjI7XG4gICAgICBTZXR0aW5nczIubWF4QW5ndWxhckNvcnJlY3Rpb24gPSA4IC8gMTgwICogbWF0aF9QSSQ2O1xuICAgICAgU2V0dGluZ3MyLm1heFRyYW5zbGF0aW9uID0gMjtcbiAgICAgIFNldHRpbmdzMi5tYXhSb3RhdGlvbiA9IDAuNSAqIG1hdGhfUEkkNjtcbiAgICAgIFNldHRpbmdzMi5iYXVtZ2FydGUgPSAwLjI7XG4gICAgICBTZXR0aW5nczIudG9pQmF1Z2FydGUgPSAwLjc1O1xuICAgICAgU2V0dGluZ3MyLnRpbWVUb1NsZWVwID0gMC41O1xuICAgICAgU2V0dGluZ3MyLmxpbmVhclNsZWVwVG9sZXJhbmNlID0gMC4wMTtcbiAgICAgIFNldHRpbmdzMi5hbmd1bGFyU2xlZXBUb2xlcmFuY2UgPSAyIC8gMTgwICogbWF0aF9QSSQ2O1xuICAgICAgcmV0dXJuIFNldHRpbmdzMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFNldHRpbmdzSW50ZXJuYWwgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2V0dGluZ3NJbnRlcm5hbDIoKSB7XG4gICAgICB9XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4TWFuaWZvbGRQb2ludHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhNYW5pZm9sZFBvaW50cztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4UG9seWdvblZlcnRpY2VzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4UG9seWdvblZlcnRpY2VzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJhYWJiRXh0ZW5zaW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MuYWFiYkV4dGVuc2lvbiAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImFhYmJNdWx0aXBsaWVyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MuYWFiYk11bHRpcGxpZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImxpbmVhclNsb3BcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5saW5lYXJTbG9wICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibGluZWFyU2xvcFNxdWFyZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5saW5lYXJTbG9wICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlciAqIFNldHRpbmdzLmxpbmVhclNsb3AgKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJhbmd1bGFyU2xvcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmFuZ3VsYXJTbG9wO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJwb2x5Z29uUmFkaXVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gMiAqIFNldHRpbmdzLmxpbmVhclNsb3A7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heFN1YlN0ZXBzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4U3ViU3RlcHM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heFRPSUNvbnRhY3RzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4VE9JQ29udGFjdHM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heFRPSUl0ZXJhdGlvbnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhUT0lJdGVyYXRpb25zO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhEaXN0YW5jZUl0ZXJhdGlvbnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhEaXN0YW5jZUl0ZXJhdGlvbnM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcInZlbG9jaXR5VGhyZXNob2xkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MudmVsb2NpdHlUaHJlc2hvbGQgKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhMaW5lYXJDb3JyZWN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4TGluZWFyQ29ycmVjdGlvbiAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heEFuZ3VsYXJDb3JyZWN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4QW5ndWxhckNvcnJlY3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heFRyYW5zbGF0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4VHJhbnNsYXRpb24gKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhUcmFuc2xhdGlvblNxdWFyZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhUcmFuc2xhdGlvbiAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXIgKiBTZXR0aW5ncy5tYXhUcmFuc2xhdGlvbiAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heFJvdGF0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4Um90YXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heFJvdGF0aW9uU3F1YXJlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFJvdGF0aW9uICogU2V0dGluZ3MubWF4Um90YXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImJhdW1nYXJ0ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmJhdW1nYXJ0ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwidG9pQmF1Z2FydGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy50b2lCYXVnYXJ0ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwidGltZVRvU2xlZXBcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy50aW1lVG9TbGVlcDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibGluZWFyU2xlZXBUb2xlcmFuY2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5saW5lYXJTbGVlcFRvbGVyYW5jZSAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImxpbmVhclNsZWVwVG9sZXJhbmNlU3FyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubGluZWFyU2xlZXBUb2xlcmFuY2UgKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyICogU2V0dGluZ3MubGluZWFyU2xlZXBUb2xlcmFuY2UgKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJhbmd1bGFyU2xlZXBUb2xlcmFuY2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5hbmd1bGFyU2xlZXBUb2xlcmFuY2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImFuZ3VsYXJTbGVlcFRvbGVyYW5jZVNxclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmFuZ3VsYXJTbGVlcFRvbGVyYW5jZSAqIFNldHRpbmdzLmFuZ3VsYXJTbGVlcFRvbGVyYW5jZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gU2V0dGluZ3NJbnRlcm5hbDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBQb29sID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFBvb2wyKG9wdHMpIHtcbiAgICAgICAgdGhpcy5fbGlzdCA9IFtdO1xuICAgICAgICB0aGlzLl9tYXggPSBJbmZpbml0eTtcbiAgICAgICAgdGhpcy5faGFzQ3JlYXRlRm4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY3JlYXRlQ291bnQgPSAwO1xuICAgICAgICB0aGlzLl9oYXNBbGxvY2F0ZUZuID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2FsbG9jYXRlQ291bnQgPSAwO1xuICAgICAgICB0aGlzLl9oYXNSZWxlYXNlRm4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fcmVsZWFzZUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5faGFzRGlzcG9zZUZuID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2VDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuX2xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5fbWF4ID0gb3B0cy5tYXggfHwgdGhpcy5fbWF4O1xuICAgICAgICB0aGlzLl9jcmVhdGVGbiA9IG9wdHMuY3JlYXRlO1xuICAgICAgICB0aGlzLl9oYXNDcmVhdGVGbiA9IHR5cGVvZiB0aGlzLl9jcmVhdGVGbiA9PT0gXCJmdW5jdGlvblwiO1xuICAgICAgICB0aGlzLl9hbGxvY2F0ZUZuID0gb3B0cy5hbGxvY2F0ZTtcbiAgICAgICAgdGhpcy5faGFzQWxsb2NhdGVGbiA9IHR5cGVvZiB0aGlzLl9hbGxvY2F0ZUZuID09PSBcImZ1bmN0aW9uXCI7XG4gICAgICAgIHRoaXMuX3JlbGVhc2VGbiA9IG9wdHMucmVsZWFzZTtcbiAgICAgICAgdGhpcy5faGFzUmVsZWFzZUZuID0gdHlwZW9mIHRoaXMuX3JlbGVhc2VGbiA9PT0gXCJmdW5jdGlvblwiO1xuICAgICAgICB0aGlzLl9kaXNwb3NlRm4gPSBvcHRzLmRpc3Bvc2U7XG4gICAgICAgIHRoaXMuX2hhc0Rpc3Bvc2VGbiA9IHR5cGVvZiB0aGlzLl9kaXNwb3NlRm4gPT09IFwiZnVuY3Rpb25cIjtcbiAgICAgIH1cbiAgICAgIFBvb2wyLnByb3RvdHlwZS5tYXggPSBmdW5jdGlvbihuMikge1xuICAgICAgICBpZiAodHlwZW9mIG4yID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgdGhpcy5fbWF4ID0gbjI7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX21heDtcbiAgICAgIH07XG4gICAgICBQb29sMi5wcm90b3R5cGUuc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGlzdC5sZW5ndGg7XG4gICAgICB9O1xuICAgICAgUG9vbDIucHJvdG90eXBlLmFsbG9jYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpdGVtO1xuICAgICAgICBpZiAodGhpcy5fbGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgaXRlbSA9IHRoaXMuX2xpc3Quc2hpZnQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9jcmVhdGVDb3VudCsrO1xuICAgICAgICAgIGlmICh0aGlzLl9oYXNDcmVhdGVGbikge1xuICAgICAgICAgICAgaXRlbSA9IHRoaXMuX2NyZWF0ZUZuKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGl0ZW0gPSB7fTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYWxsb2NhdGVDb3VudCsrO1xuICAgICAgICBpZiAodGhpcy5faGFzQWxsb2NhdGVGbikge1xuICAgICAgICAgIHRoaXMuX2FsbG9jYXRlRm4oaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICB9O1xuICAgICAgUG9vbDIucHJvdG90eXBlLnJlbGVhc2UgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGlmICh0aGlzLl9saXN0Lmxlbmd0aCA8IHRoaXMuX21heCkge1xuICAgICAgICAgIHRoaXMuX3JlbGVhc2VDb3VudCsrO1xuICAgICAgICAgIGlmICh0aGlzLl9oYXNSZWxlYXNlRm4pIHtcbiAgICAgICAgICAgIHRoaXMuX3JlbGVhc2VGbihpdGVtKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5fbGlzdC5wdXNoKGl0ZW0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX2Rpc3Bvc2VDb3VudCsrO1xuICAgICAgICAgIGlmICh0aGlzLl9oYXNEaXNwb3NlRm4pIHtcbiAgICAgICAgICAgIGl0ZW0gPSB0aGlzLl9kaXNwb3NlRm4oaXRlbSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUG9vbDIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBcIiArXCIgKyB0aGlzLl9jcmVhdGVDb3VudCArIFwiID5cIiArIHRoaXMuX2FsbG9jYXRlQ291bnQgKyBcIiA8XCIgKyB0aGlzLl9yZWxlYXNlQ291bnQgKyBcIiAtXCIgKyB0aGlzLl9kaXNwb3NlQ291bnQgKyBcIiA9XCIgKyB0aGlzLl9saXN0Lmxlbmd0aCArIFwiL1wiICsgdGhpcy5fbWF4O1xuICAgICAgfTtcbiAgICAgIHJldHVybiBQb29sMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfYWJzJDggPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfbWF4JDYgPSBNYXRoLm1heDtcbiAgdmFyIFRyZWVOb2RlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFRyZWVOb2RlMihpZCkge1xuICAgICAgICB0aGlzLmFhYmIgPSBuZXcgQUFCQigpO1xuICAgICAgICB0aGlzLnVzZXJEYXRhID0gbnVsbDtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBudWxsO1xuICAgICAgICB0aGlzLmNoaWxkMSA9IG51bGw7XG4gICAgICAgIHRoaXMuY2hpbGQyID0gbnVsbDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSAtMTtcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgfVxuICAgICAgVHJlZU5vZGUyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pZCArIFwiOiBcIiArIHRoaXMudXNlckRhdGE7XG4gICAgICB9O1xuICAgICAgVHJlZU5vZGUyLnByb3RvdHlwZS5pc0xlYWYgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGQxID09IG51bGw7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFRyZWVOb2RlMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIHBvb2xUcmVlTm9kZSA9IG5ldyBQb29sKHtcbiAgICBjcmVhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5ldyBUcmVlTm9kZSgpO1xuICAgIH0sXG4gICAgcmVsZWFzZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgbm9kZS51c2VyRGF0YSA9IG51bGw7XG4gICAgICBub2RlLnBhcmVudCA9IG51bGw7XG4gICAgICBub2RlLmNoaWxkMSA9IG51bGw7XG4gICAgICBub2RlLmNoaWxkMiA9IG51bGw7XG4gICAgICBub2RlLmhlaWdodCA9IC0xO1xuICAgICAgbm9kZS5pZCA9IHZvaWQgMDtcbiAgICB9XG4gIH0pO1xuICB2YXIgRHluYW1pY1RyZWUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRHluYW1pY1RyZWUyKCkge1xuICAgICAgICB0aGlzLmlucHV0UG9vbCA9IG5ldyBQb29sKHtcbiAgICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVsZWFzZTogZnVuY3Rpb24oc3RhY2spIHtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN0YWNrUG9vbCA9IG5ldyBQb29sKHtcbiAgICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVsZWFzZTogZnVuY3Rpb24oc3RhY2spIHtcbiAgICAgICAgICAgIHN0YWNrLmxlbmd0aCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pdGVyYXRvclBvb2wgPSBuZXcgUG9vbCh7XG4gICAgICAgICAgY3JlYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgSXRlcmF0b3IoKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlbGVhc2U6IGZ1bmN0aW9uKGl0ZXJhdG9yKSB7XG4gICAgICAgICAgICBpdGVyYXRvci5jbG9zZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubV9yb290ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX25vZGVzID0ge307XG4gICAgICAgIHRoaXMubV9sYXN0UHJveHlJZCA9IDA7XG4gICAgICB9XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmdldFVzZXJEYXRhID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fbm9kZXNbaWRdO1xuICAgICAgICByZXR1cm4gbm9kZS51c2VyRGF0YTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmdldEZhdEFBQkIgPSBmdW5jdGlvbihpZCkge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMubV9ub2Rlc1tpZF07XG4gICAgICAgIHJldHVybiBub2RlLmFhYmI7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5hbGxvY2F0ZU5vZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBwb29sVHJlZU5vZGUuYWxsb2NhdGUoKTtcbiAgICAgICAgbm9kZS5pZCA9ICsrdGhpcy5tX2xhc3RQcm94eUlkO1xuICAgICAgICB0aGlzLm1fbm9kZXNbbm9kZS5pZF0gPSBub2RlO1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmZyZWVOb2RlID0gZnVuY3Rpb24obm9kZSkge1xuICAgICAgICBkZWxldGUgdGhpcy5tX25vZGVzW25vZGUuaWRdO1xuICAgICAgICBwb29sVHJlZU5vZGUucmVsZWFzZShub2RlKTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmNyZWF0ZVByb3h5ID0gZnVuY3Rpb24oYWFiYiwgdXNlckRhdGEpIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLmFsbG9jYXRlTm9kZSgpO1xuICAgICAgICBub2RlLmFhYmIuc2V0KGFhYmIpO1xuICAgICAgICBBQUJCLmV4dGVuZChub2RlLmFhYmIsIFNldHRpbmdzSW50ZXJuYWwuYWFiYkV4dGVuc2lvbik7XG4gICAgICAgIG5vZGUudXNlckRhdGEgPSB1c2VyRGF0YTtcbiAgICAgICAgbm9kZS5oZWlnaHQgPSAwO1xuICAgICAgICB0aGlzLmluc2VydExlYWYobm9kZSk7XG4gICAgICAgIHJldHVybiBub2RlLmlkO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuZGVzdHJveVByb3h5ID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fbm9kZXNbaWRdO1xuICAgICAgICB0aGlzLnJlbW92ZUxlYWYobm9kZSk7XG4gICAgICAgIHRoaXMuZnJlZU5vZGUobm9kZSk7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5tb3ZlUHJveHkgPSBmdW5jdGlvbihpZCwgYWFiYiwgZDIpIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fbm9kZXNbaWRdO1xuICAgICAgICBpZiAobm9kZS5hYWJiLmNvbnRhaW5zKGFhYmIpKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVtb3ZlTGVhZihub2RlKTtcbiAgICAgICAgbm9kZS5hYWJiLnNldChhYWJiKTtcbiAgICAgICAgYWFiYiA9IG5vZGUuYWFiYjtcbiAgICAgICAgQUFCQi5leHRlbmQoYWFiYiwgU2V0dGluZ3NJbnRlcm5hbC5hYWJiRXh0ZW5zaW9uKTtcbiAgICAgICAgaWYgKGQyLnggPCAwKSB7XG4gICAgICAgICAgYWFiYi5sb3dlckJvdW5kLnggKz0gZDIueCAqIFNldHRpbmdzSW50ZXJuYWwuYWFiYk11bHRpcGxpZXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWFiYi51cHBlckJvdW5kLnggKz0gZDIueCAqIFNldHRpbmdzSW50ZXJuYWwuYWFiYk11bHRpcGxpZXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQyLnkgPCAwKSB7XG4gICAgICAgICAgYWFiYi5sb3dlckJvdW5kLnkgKz0gZDIueSAqIFNldHRpbmdzSW50ZXJuYWwuYWFiYk11bHRpcGxpZXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWFiYi51cHBlckJvdW5kLnkgKz0gZDIueSAqIFNldHRpbmdzSW50ZXJuYWwuYWFiYk11bHRpcGxpZXI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnNlcnRMZWFmKG5vZGUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmluc2VydExlYWYgPSBmdW5jdGlvbihsZWFmKSB7XG4gICAgICAgIGlmICh0aGlzLm1fcm9vdCA9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5tX3Jvb3QgPSBsZWFmO1xuICAgICAgICAgIHRoaXMubV9yb290LnBhcmVudCA9IG51bGw7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZWFmQUFCQiA9IGxlYWYuYWFiYjtcbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5tX3Jvb3Q7XG4gICAgICAgIHdoaWxlICghaW5kZXguaXNMZWFmKCkpIHtcbiAgICAgICAgICB2YXIgY2hpbGQxID0gaW5kZXguY2hpbGQxO1xuICAgICAgICAgIHZhciBjaGlsZDIgPSBpbmRleC5jaGlsZDI7XG4gICAgICAgICAgdmFyIGFyZWEgPSBpbmRleC5hYWJiLmdldFBlcmltZXRlcigpO1xuICAgICAgICAgIHZhciBjb21iaW5lZEFyZWEgPSBBQUJCLmNvbWJpbmVkUGVyaW1ldGVyKGluZGV4LmFhYmIsIGxlYWZBQUJCKTtcbiAgICAgICAgICB2YXIgY29zdCA9IDIgKiBjb21iaW5lZEFyZWE7XG4gICAgICAgICAgdmFyIGluaGVyaXRhbmNlQ29zdCA9IDIgKiAoY29tYmluZWRBcmVhIC0gYXJlYSk7XG4gICAgICAgICAgdmFyIG5ld0FyZWExID0gQUFCQi5jb21iaW5lZFBlcmltZXRlcihsZWFmQUFCQiwgY2hpbGQxLmFhYmIpO1xuICAgICAgICAgIHZhciBjb3N0MSA9IG5ld0FyZWExICsgaW5oZXJpdGFuY2VDb3N0O1xuICAgICAgICAgIGlmICghY2hpbGQxLmlzTGVhZigpKSB7XG4gICAgICAgICAgICB2YXIgb2xkQXJlYSA9IGNoaWxkMS5hYWJiLmdldFBlcmltZXRlcigpO1xuICAgICAgICAgICAgY29zdDEgLT0gb2xkQXJlYTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIG5ld0FyZWEyID0gQUFCQi5jb21iaW5lZFBlcmltZXRlcihsZWFmQUFCQiwgY2hpbGQyLmFhYmIpO1xuICAgICAgICAgIHZhciBjb3N0MiA9IG5ld0FyZWEyICsgaW5oZXJpdGFuY2VDb3N0O1xuICAgICAgICAgIGlmICghY2hpbGQyLmlzTGVhZigpKSB7XG4gICAgICAgICAgICB2YXIgb2xkQXJlYSA9IGNoaWxkMi5hYWJiLmdldFBlcmltZXRlcigpO1xuICAgICAgICAgICAgY29zdDIgLT0gb2xkQXJlYTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNvc3QgPCBjb3N0MSAmJiBjb3N0IDwgY29zdDIpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY29zdDEgPCBjb3N0Mikge1xuICAgICAgICAgICAgaW5kZXggPSBjaGlsZDE7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGluZGV4ID0gY2hpbGQyO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgc2libGluZyA9IGluZGV4O1xuICAgICAgICB2YXIgb2xkUGFyZW50ID0gc2libGluZy5wYXJlbnQ7XG4gICAgICAgIHZhciBuZXdQYXJlbnQgPSB0aGlzLmFsbG9jYXRlTm9kZSgpO1xuICAgICAgICBuZXdQYXJlbnQucGFyZW50ID0gb2xkUGFyZW50O1xuICAgICAgICBuZXdQYXJlbnQudXNlckRhdGEgPSBudWxsO1xuICAgICAgICBuZXdQYXJlbnQuYWFiYi5jb21iaW5lKGxlYWZBQUJCLCBzaWJsaW5nLmFhYmIpO1xuICAgICAgICBuZXdQYXJlbnQuaGVpZ2h0ID0gc2libGluZy5oZWlnaHQgKyAxO1xuICAgICAgICBpZiAob2xkUGFyZW50ICE9IG51bGwpIHtcbiAgICAgICAgICBpZiAob2xkUGFyZW50LmNoaWxkMSA9PT0gc2libGluZykge1xuICAgICAgICAgICAgb2xkUGFyZW50LmNoaWxkMSA9IG5ld1BhcmVudDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb2xkUGFyZW50LmNoaWxkMiA9IG5ld1BhcmVudDtcbiAgICAgICAgICB9XG4gICAgICAgICAgbmV3UGFyZW50LmNoaWxkMSA9IHNpYmxpbmc7XG4gICAgICAgICAgbmV3UGFyZW50LmNoaWxkMiA9IGxlYWY7XG4gICAgICAgICAgc2libGluZy5wYXJlbnQgPSBuZXdQYXJlbnQ7XG4gICAgICAgICAgbGVhZi5wYXJlbnQgPSBuZXdQYXJlbnQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3UGFyZW50LmNoaWxkMSA9IHNpYmxpbmc7XG4gICAgICAgICAgbmV3UGFyZW50LmNoaWxkMiA9IGxlYWY7XG4gICAgICAgICAgc2libGluZy5wYXJlbnQgPSBuZXdQYXJlbnQ7XG4gICAgICAgICAgbGVhZi5wYXJlbnQgPSBuZXdQYXJlbnQ7XG4gICAgICAgICAgdGhpcy5tX3Jvb3QgPSBuZXdQYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaW5kZXggPSBsZWFmLnBhcmVudDtcbiAgICAgICAgd2hpbGUgKGluZGV4ICE9IG51bGwpIHtcbiAgICAgICAgICBpbmRleCA9IHRoaXMuYmFsYW5jZShpbmRleCk7XG4gICAgICAgICAgdmFyIGNoaWxkMSA9IGluZGV4LmNoaWxkMTtcbiAgICAgICAgICB2YXIgY2hpbGQyID0gaW5kZXguY2hpbGQyO1xuICAgICAgICAgIGluZGV4LmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KGNoaWxkMS5oZWlnaHQsIGNoaWxkMi5oZWlnaHQpO1xuICAgICAgICAgIGluZGV4LmFhYmIuY29tYmluZShjaGlsZDEuYWFiYiwgY2hpbGQyLmFhYmIpO1xuICAgICAgICAgIGluZGV4ID0gaW5kZXgucGFyZW50O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5yZW1vdmVMZWFmID0gZnVuY3Rpb24obGVhZikge1xuICAgICAgICBpZiAobGVhZiA9PT0gdGhpcy5tX3Jvb3QpIHtcbiAgICAgICAgICB0aGlzLm1fcm9vdCA9IG51bGw7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJlbnQgPSBsZWFmLnBhcmVudDtcbiAgICAgICAgdmFyIGdyYW5kUGFyZW50ID0gcGFyZW50LnBhcmVudDtcbiAgICAgICAgdmFyIHNpYmxpbmc7XG4gICAgICAgIGlmIChwYXJlbnQuY2hpbGQxID09PSBsZWFmKSB7XG4gICAgICAgICAgc2libGluZyA9IHBhcmVudC5jaGlsZDI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2libGluZyA9IHBhcmVudC5jaGlsZDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdyYW5kUGFyZW50ICE9IG51bGwpIHtcbiAgICAgICAgICBpZiAoZ3JhbmRQYXJlbnQuY2hpbGQxID09PSBwYXJlbnQpIHtcbiAgICAgICAgICAgIGdyYW5kUGFyZW50LmNoaWxkMSA9IHNpYmxpbmc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdyYW5kUGFyZW50LmNoaWxkMiA9IHNpYmxpbmc7XG4gICAgICAgICAgfVxuICAgICAgICAgIHNpYmxpbmcucGFyZW50ID0gZ3JhbmRQYXJlbnQ7XG4gICAgICAgICAgdGhpcy5mcmVlTm9kZShwYXJlbnQpO1xuICAgICAgICAgIHZhciBpbmRleCA9IGdyYW5kUGFyZW50O1xuICAgICAgICAgIHdoaWxlIChpbmRleCAhPSBudWxsKSB7XG4gICAgICAgICAgICBpbmRleCA9IHRoaXMuYmFsYW5jZShpbmRleCk7XG4gICAgICAgICAgICB2YXIgY2hpbGQxID0gaW5kZXguY2hpbGQxO1xuICAgICAgICAgICAgdmFyIGNoaWxkMiA9IGluZGV4LmNoaWxkMjtcbiAgICAgICAgICAgIGluZGV4LmFhYmIuY29tYmluZShjaGlsZDEuYWFiYiwgY2hpbGQyLmFhYmIpO1xuICAgICAgICAgICAgaW5kZXguaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoY2hpbGQxLmhlaWdodCwgY2hpbGQyLmhlaWdodCk7XG4gICAgICAgICAgICBpbmRleCA9IGluZGV4LnBhcmVudDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3Jvb3QgPSBzaWJsaW5nO1xuICAgICAgICAgIHNpYmxpbmcucGFyZW50ID0gbnVsbDtcbiAgICAgICAgICB0aGlzLmZyZWVOb2RlKHBhcmVudCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmJhbGFuY2UgPSBmdW5jdGlvbihpQSkge1xuICAgICAgICB2YXIgQSA9IGlBO1xuICAgICAgICBpZiAoQS5pc0xlYWYoKSB8fCBBLmhlaWdodCA8IDIpIHtcbiAgICAgICAgICByZXR1cm4gaUE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIEIgPSBBLmNoaWxkMTtcbiAgICAgICAgdmFyIEMgPSBBLmNoaWxkMjtcbiAgICAgICAgdmFyIGJhbGFuY2UgPSBDLmhlaWdodCAtIEIuaGVpZ2h0O1xuICAgICAgICBpZiAoYmFsYW5jZSA+IDEpIHtcbiAgICAgICAgICB2YXIgRiA9IEMuY2hpbGQxO1xuICAgICAgICAgIHZhciBHID0gQy5jaGlsZDI7XG4gICAgICAgICAgQy5jaGlsZDEgPSBBO1xuICAgICAgICAgIEMucGFyZW50ID0gQS5wYXJlbnQ7XG4gICAgICAgICAgQS5wYXJlbnQgPSBDO1xuICAgICAgICAgIGlmIChDLnBhcmVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICBpZiAoQy5wYXJlbnQuY2hpbGQxID09PSBpQSkge1xuICAgICAgICAgICAgICBDLnBhcmVudC5jaGlsZDEgPSBDO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgQy5wYXJlbnQuY2hpbGQyID0gQztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX3Jvb3QgPSBDO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoRi5oZWlnaHQgPiBHLmhlaWdodCkge1xuICAgICAgICAgICAgQy5jaGlsZDIgPSBGO1xuICAgICAgICAgICAgQS5jaGlsZDIgPSBHO1xuICAgICAgICAgICAgRy5wYXJlbnQgPSBBO1xuICAgICAgICAgICAgQS5hYWJiLmNvbWJpbmUoQi5hYWJiLCBHLmFhYmIpO1xuICAgICAgICAgICAgQy5hYWJiLmNvbWJpbmUoQS5hYWJiLCBGLmFhYmIpO1xuICAgICAgICAgICAgQS5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihCLmhlaWdodCwgRy5oZWlnaHQpO1xuICAgICAgICAgICAgQy5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihBLmhlaWdodCwgRi5oZWlnaHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBDLmNoaWxkMiA9IEc7XG4gICAgICAgICAgICBBLmNoaWxkMiA9IEY7XG4gICAgICAgICAgICBGLnBhcmVudCA9IEE7XG4gICAgICAgICAgICBBLmFhYmIuY29tYmluZShCLmFhYmIsIEYuYWFiYik7XG4gICAgICAgICAgICBDLmFhYmIuY29tYmluZShBLmFhYmIsIEcuYWFiYik7XG4gICAgICAgICAgICBBLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KEIuaGVpZ2h0LCBGLmhlaWdodCk7XG4gICAgICAgICAgICBDLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KEEuaGVpZ2h0LCBHLmhlaWdodCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBDO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiYWxhbmNlIDwgLTEpIHtcbiAgICAgICAgICB2YXIgRCA9IEIuY2hpbGQxO1xuICAgICAgICAgIHZhciBFID0gQi5jaGlsZDI7XG4gICAgICAgICAgQi5jaGlsZDEgPSBBO1xuICAgICAgICAgIEIucGFyZW50ID0gQS5wYXJlbnQ7XG4gICAgICAgICAgQS5wYXJlbnQgPSBCO1xuICAgICAgICAgIGlmIChCLnBhcmVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICBpZiAoQi5wYXJlbnQuY2hpbGQxID09PSBBKSB7XG4gICAgICAgICAgICAgIEIucGFyZW50LmNoaWxkMSA9IEI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBCLnBhcmVudC5jaGlsZDIgPSBCO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1fcm9vdCA9IEI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChELmhlaWdodCA+IEUuaGVpZ2h0KSB7XG4gICAgICAgICAgICBCLmNoaWxkMiA9IEQ7XG4gICAgICAgICAgICBBLmNoaWxkMSA9IEU7XG4gICAgICAgICAgICBFLnBhcmVudCA9IEE7XG4gICAgICAgICAgICBBLmFhYmIuY29tYmluZShDLmFhYmIsIEUuYWFiYik7XG4gICAgICAgICAgICBCLmFhYmIuY29tYmluZShBLmFhYmIsIEQuYWFiYik7XG4gICAgICAgICAgICBBLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KEMuaGVpZ2h0LCBFLmhlaWdodCk7XG4gICAgICAgICAgICBCLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KEEuaGVpZ2h0LCBELmhlaWdodCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIEIuY2hpbGQyID0gRTtcbiAgICAgICAgICAgIEEuY2hpbGQxID0gRDtcbiAgICAgICAgICAgIEQucGFyZW50ID0gQTtcbiAgICAgICAgICAgIEEuYWFiYi5jb21iaW5lKEMuYWFiYiwgRC5hYWJiKTtcbiAgICAgICAgICAgIEIuYWFiYi5jb21iaW5lKEEuYWFiYiwgRS5hYWJiKTtcbiAgICAgICAgICAgIEEuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoQy5oZWlnaHQsIEQuaGVpZ2h0KTtcbiAgICAgICAgICAgIEIuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoQS5oZWlnaHQsIEUuaGVpZ2h0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIEI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEE7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMubV9yb290ID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5tX3Jvb3QuaGVpZ2h0O1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuZ2V0QXJlYVJhdGlvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm1fcm9vdCA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvb3QgPSB0aGlzLm1fcm9vdDtcbiAgICAgICAgdmFyIHJvb3RBcmVhID0gcm9vdC5hYWJiLmdldFBlcmltZXRlcigpO1xuICAgICAgICB2YXIgdG90YWxBcmVhID0gMDtcbiAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgIHZhciBpdCA9IHRoaXMuaXRlcmF0b3JQb29sLmFsbG9jYXRlKCkucHJlb3JkZXIodGhpcy5tX3Jvb3QpO1xuICAgICAgICB3aGlsZSAobm9kZSA9IGl0Lm5leHQoKSkge1xuICAgICAgICAgIGlmIChub2RlLmhlaWdodCA8IDApIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0b3RhbEFyZWEgKz0gbm9kZS5hYWJiLmdldFBlcmltZXRlcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXRlcmF0b3JQb29sLnJlbGVhc2UoaXQpO1xuICAgICAgICByZXR1cm4gdG90YWxBcmVhIC8gcm9vdEFyZWE7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5jb21wdXRlSGVpZ2h0ID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgIGlmICh0eXBlb2YgaWQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICBub2RlID0gdGhpcy5tX25vZGVzW2lkXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBub2RlID0gdGhpcy5tX3Jvb3Q7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGUuaXNMZWFmKCkpIHtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaGVpZ2h0MSA9IHRoaXMuY29tcHV0ZUhlaWdodChub2RlLmNoaWxkMS5pZCk7XG4gICAgICAgIHZhciBoZWlnaHQyID0gdGhpcy5jb21wdXRlSGVpZ2h0KG5vZGUuY2hpbGQyLmlkKTtcbiAgICAgICAgcmV0dXJuIDEgKyBtYXRoX21heCQ2KGhlaWdodDEsIGhlaWdodDIpO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUudmFsaWRhdGVTdHJ1Y3R1cmUgPSBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIGlmIChub2RlID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGUgPT09IHRoaXMubV9yb290KSA7XG4gICAgICAgIHZhciBjaGlsZDEgPSBub2RlLmNoaWxkMTtcbiAgICAgICAgdmFyIGNoaWxkMiA9IG5vZGUuY2hpbGQyO1xuICAgICAgICBpZiAobm9kZS5pc0xlYWYoKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbGlkYXRlU3RydWN0dXJlKGNoaWxkMSk7XG4gICAgICAgIHRoaXMudmFsaWRhdGVTdHJ1Y3R1cmUoY2hpbGQyKTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLnZhbGlkYXRlTWV0cmljcyA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hpbGQxID0gbm9kZS5jaGlsZDE7XG4gICAgICAgIHZhciBjaGlsZDIgPSBub2RlLmNoaWxkMjtcbiAgICAgICAgaWYgKG5vZGUuaXNMZWFmKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52YWxpZGF0ZU1ldHJpY3MoY2hpbGQxKTtcbiAgICAgICAgdGhpcy52YWxpZGF0ZU1ldHJpY3MoY2hpbGQyKTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmdldE1heEJhbGFuY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG1heEJhbGFuY2UgPSAwO1xuICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgdmFyIGl0ID0gdGhpcy5pdGVyYXRvclBvb2wuYWxsb2NhdGUoKS5wcmVvcmRlcih0aGlzLm1fcm9vdCk7XG4gICAgICAgIHdoaWxlIChub2RlID0gaXQubmV4dCgpKSB7XG4gICAgICAgICAgaWYgKG5vZGUuaGVpZ2h0IDw9IDEpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgYmFsYW5jZSA9IG1hdGhfYWJzJDgobm9kZS5jaGlsZDIuaGVpZ2h0IC0gbm9kZS5jaGlsZDEuaGVpZ2h0KTtcbiAgICAgICAgICBtYXhCYWxhbmNlID0gbWF0aF9tYXgkNihtYXhCYWxhbmNlLCBiYWxhbmNlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLml0ZXJhdG9yUG9vbC5yZWxlYXNlKGl0KTtcbiAgICAgICAgcmV0dXJuIG1heEJhbGFuY2U7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5yZWJ1aWxkQm90dG9tVXAgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG5vZGVzID0gW107XG4gICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgIHZhciBub2RlO1xuICAgICAgICB2YXIgaXQgPSB0aGlzLml0ZXJhdG9yUG9vbC5hbGxvY2F0ZSgpLnByZW9yZGVyKHRoaXMubV9yb290KTtcbiAgICAgICAgd2hpbGUgKG5vZGUgPSBpdC5uZXh0KCkpIHtcbiAgICAgICAgICBpZiAobm9kZS5oZWlnaHQgPCAwKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG5vZGUuaXNMZWFmKCkpIHtcbiAgICAgICAgICAgIG5vZGUucGFyZW50ID0gbnVsbDtcbiAgICAgICAgICAgIG5vZGVzW2NvdW50XSA9IG5vZGU7XG4gICAgICAgICAgICArK2NvdW50O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZyZWVOb2RlKG5vZGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLml0ZXJhdG9yUG9vbC5yZWxlYXNlKGl0KTtcbiAgICAgICAgd2hpbGUgKGNvdW50ID4gMSkge1xuICAgICAgICAgIHZhciBtaW5Db3N0ID0gSW5maW5pdHk7XG4gICAgICAgICAgdmFyIGlNaW4gPSAtMTtcbiAgICAgICAgICB2YXIgak1pbiA9IC0xO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIGFhYmJpID0gbm9kZXNbaV0uYWFiYjtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSBpICsgMTsgaiA8IGNvdW50OyArK2opIHtcbiAgICAgICAgICAgICAgdmFyIGFhYmJqID0gbm9kZXNbal0uYWFiYjtcbiAgICAgICAgICAgICAgdmFyIGNvc3QgPSBBQUJCLmNvbWJpbmVkUGVyaW1ldGVyKGFhYmJpLCBhYWJiaik7XG4gICAgICAgICAgICAgIGlmIChjb3N0IDwgbWluQ29zdCkge1xuICAgICAgICAgICAgICAgIGlNaW4gPSBpO1xuICAgICAgICAgICAgICAgIGpNaW4gPSBqO1xuICAgICAgICAgICAgICAgIG1pbkNvc3QgPSBjb3N0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjaGlsZDEgPSBub2Rlc1tpTWluXTtcbiAgICAgICAgICB2YXIgY2hpbGQyID0gbm9kZXNbak1pbl07XG4gICAgICAgICAgdmFyIHBhcmVudF8xID0gdGhpcy5hbGxvY2F0ZU5vZGUoKTtcbiAgICAgICAgICBwYXJlbnRfMS5jaGlsZDEgPSBjaGlsZDE7XG4gICAgICAgICAgcGFyZW50XzEuY2hpbGQyID0gY2hpbGQyO1xuICAgICAgICAgIHBhcmVudF8xLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KGNoaWxkMS5oZWlnaHQsIGNoaWxkMi5oZWlnaHQpO1xuICAgICAgICAgIHBhcmVudF8xLmFhYmIuY29tYmluZShjaGlsZDEuYWFiYiwgY2hpbGQyLmFhYmIpO1xuICAgICAgICAgIHBhcmVudF8xLnBhcmVudCA9IG51bGw7XG4gICAgICAgICAgY2hpbGQxLnBhcmVudCA9IHBhcmVudF8xO1xuICAgICAgICAgIGNoaWxkMi5wYXJlbnQgPSBwYXJlbnRfMTtcbiAgICAgICAgICBub2Rlc1tqTWluXSA9IG5vZGVzW2NvdW50IC0gMV07XG4gICAgICAgICAgbm9kZXNbaU1pbl0gPSBwYXJlbnRfMTtcbiAgICAgICAgICAtLWNvdW50O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9yb290ID0gbm9kZXNbMF07XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5zaGlmdE9yaWdpbiA9IGZ1bmN0aW9uKG5ld09yaWdpbikge1xuICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgdmFyIGl0ID0gdGhpcy5pdGVyYXRvclBvb2wuYWxsb2NhdGUoKS5wcmVvcmRlcih0aGlzLm1fcm9vdCk7XG4gICAgICAgIHdoaWxlIChub2RlID0gaXQubmV4dCgpKSB7XG4gICAgICAgICAgdmFyIGFhYmIgPSBub2RlLmFhYmI7XG4gICAgICAgICAgYWFiYi5sb3dlckJvdW5kLnggLT0gbmV3T3JpZ2luLng7XG4gICAgICAgICAgYWFiYi5sb3dlckJvdW5kLnkgLT0gbmV3T3JpZ2luLnk7XG4gICAgICAgICAgYWFiYi51cHBlckJvdW5kLnggLT0gbmV3T3JpZ2luLng7XG4gICAgICAgICAgYWFiYi51cHBlckJvdW5kLnkgLT0gbmV3T3JpZ2luLnk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVyYXRvclBvb2wucmVsZWFzZShpdCk7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5xdWVyeSA9IGZ1bmN0aW9uKGFhYmIsIHF1ZXJ5Q2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHN0YWNrID0gdGhpcy5zdGFja1Bvb2wuYWxsb2NhdGUoKTtcbiAgICAgICAgc3RhY2sucHVzaCh0aGlzLm1fcm9vdCk7XG4gICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdmFyIG5vZGUgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKEFBQkIudGVzdE92ZXJsYXAobm9kZS5hYWJiLCBhYWJiKSkge1xuICAgICAgICAgICAgaWYgKG5vZGUuaXNMZWFmKCkpIHtcbiAgICAgICAgICAgICAgdmFyIHByb2NlZWQgPSBxdWVyeUNhbGxiYWNrKG5vZGUuaWQpO1xuICAgICAgICAgICAgICBpZiAocHJvY2VlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHN0YWNrLnB1c2gobm9kZS5jaGlsZDEpO1xuICAgICAgICAgICAgICBzdGFjay5wdXNoKG5vZGUuY2hpbGQyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGFja1Bvb2wucmVsZWFzZShzdGFjayk7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24oaW5wdXQyLCByYXlDYXN0Q2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHAxID0gaW5wdXQyLnAxO1xuICAgICAgICB2YXIgcDIgPSBpbnB1dDIucDI7XG4gICAgICAgIHZhciByID0gVmVjMi5zdWIocDIsIHAxKTtcbiAgICAgICAgci5ub3JtYWxpemUoKTtcbiAgICAgICAgdmFyIHYzID0gVmVjMi5jcm9zc051bVZlYzIoMSwgcik7XG4gICAgICAgIHZhciBhYnNfdiA9IFZlYzIuYWJzKHYzKTtcbiAgICAgICAgdmFyIG1heEZyYWN0aW9uID0gaW5wdXQyLm1heEZyYWN0aW9uO1xuICAgICAgICB2YXIgc2VnbWVudEFBQkIgPSBuZXcgQUFCQigpO1xuICAgICAgICB2YXIgdCA9IFZlYzIuY29tYmluZSgxIC0gbWF4RnJhY3Rpb24sIHAxLCBtYXhGcmFjdGlvbiwgcDIpO1xuICAgICAgICBzZWdtZW50QUFCQi5jb21iaW5lUG9pbnRzKHAxLCB0KTtcbiAgICAgICAgdmFyIHN0YWNrID0gdGhpcy5zdGFja1Bvb2wuYWxsb2NhdGUoKTtcbiAgICAgICAgdmFyIHN1YklucHV0ID0gdGhpcy5pbnB1dFBvb2wuYWxsb2NhdGUoKTtcbiAgICAgICAgc3RhY2sucHVzaCh0aGlzLm1fcm9vdCk7XG4gICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdmFyIG5vZGUgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKEFBQkIudGVzdE92ZXJsYXAobm9kZS5hYWJiLCBzZWdtZW50QUFCQikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGMyID0gbm9kZS5hYWJiLmdldENlbnRlcigpO1xuICAgICAgICAgIHZhciBoID0gbm9kZS5hYWJiLmdldEV4dGVudHMoKTtcbiAgICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IG1hdGhfYWJzJDgoVmVjMi5kb3QodjMsIFZlYzIuc3ViKHAxLCBjMikpKSAtIFZlYzIuZG90KGFic192LCBoKTtcbiAgICAgICAgICBpZiAoc2VwYXJhdGlvbiA+IDApIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobm9kZS5pc0xlYWYoKSkge1xuICAgICAgICAgICAgc3ViSW5wdXQucDEgPSBWZWMyLmNsb25lKGlucHV0Mi5wMSk7XG4gICAgICAgICAgICBzdWJJbnB1dC5wMiA9IFZlYzIuY2xvbmUoaW5wdXQyLnAyKTtcbiAgICAgICAgICAgIHN1YklucHV0Lm1heEZyYWN0aW9uID0gbWF4RnJhY3Rpb247XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSByYXlDYXN0Q2FsbGJhY2soc3ViSW5wdXQsIG5vZGUuaWQpO1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSAwKSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+IDApIHtcbiAgICAgICAgICAgICAgbWF4RnJhY3Rpb24gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgdCA9IFZlYzIuY29tYmluZSgxIC0gbWF4RnJhY3Rpb24sIHAxLCBtYXhGcmFjdGlvbiwgcDIpO1xuICAgICAgICAgICAgICBzZWdtZW50QUFCQi5jb21iaW5lUG9pbnRzKHAxLCB0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RhY2sucHVzaChub2RlLmNoaWxkMSk7XG4gICAgICAgICAgICBzdGFjay5wdXNoKG5vZGUuY2hpbGQyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGFja1Bvb2wucmVsZWFzZShzdGFjayk7XG4gICAgICAgIHRoaXMuaW5wdXRQb29sLnJlbGVhc2Uoc3ViSW5wdXQpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBEeW5hbWljVHJlZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBJdGVyYXRvciA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBJdGVyYXRvcjIoKSB7XG4gICAgICAgIHRoaXMucGFyZW50cyA9IFtdO1xuICAgICAgICB0aGlzLnN0YXRlcyA9IFtdO1xuICAgICAgfVxuICAgICAgSXRlcmF0b3IyLnByb3RvdHlwZS5wcmVvcmRlciA9IGZ1bmN0aW9uKHJvb3QpIHtcbiAgICAgICAgdGhpcy5wYXJlbnRzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMucGFyZW50cy5wdXNoKHJvb3QpO1xuICAgICAgICB0aGlzLnN0YXRlcy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLnN0YXRlcy5wdXNoKDApO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBJdGVyYXRvcjIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgd2hpbGUgKHRoaXMucGFyZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdmFyIGkgPSB0aGlzLnBhcmVudHMubGVuZ3RoIC0gMTtcbiAgICAgICAgICB2YXIgbm9kZSA9IHRoaXMucGFyZW50c1tpXTtcbiAgICAgICAgICBpZiAodGhpcy5zdGF0ZXNbaV0gPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGVzW2ldID0gMTtcbiAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5zdGF0ZXNbaV0gPT09IDEpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGVzW2ldID0gMjtcbiAgICAgICAgICAgIGlmIChub2RlLmNoaWxkMSkge1xuICAgICAgICAgICAgICB0aGlzLnBhcmVudHMucHVzaChub2RlLmNoaWxkMSk7XG4gICAgICAgICAgICAgIHRoaXMuc3RhdGVzLnB1c2goMSk7XG4gICAgICAgICAgICAgIHJldHVybiBub2RlLmNoaWxkMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGVzW2ldID09PSAyKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlc1tpXSA9IDM7XG4gICAgICAgICAgICBpZiAobm9kZS5jaGlsZDIpIHtcbiAgICAgICAgICAgICAgdGhpcy5wYXJlbnRzLnB1c2gobm9kZS5jaGlsZDIpO1xuICAgICAgICAgICAgICB0aGlzLnN0YXRlcy5wdXNoKDEpO1xuICAgICAgICAgICAgICByZXR1cm4gbm9kZS5jaGlsZDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMucGFyZW50cy5wb3AoKTtcbiAgICAgICAgICB0aGlzLnN0YXRlcy5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEl0ZXJhdG9yMi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5wYXJlbnRzLmxlbmd0aCA9IDA7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIEl0ZXJhdG9yMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfbWF4JDUgPSBNYXRoLm1heDtcbiAgdmFyIG1hdGhfbWluJDYgPSBNYXRoLm1pbjtcbiAgdmFyIEJyb2FkUGhhc2UgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gQnJvYWRQaGFzZTIoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMubV90cmVlID0gbmV3IER5bmFtaWNUcmVlKCk7XG4gICAgICAgIHRoaXMubV9tb3ZlQnVmZmVyID0gW107XG4gICAgICAgIHRoaXMucXVlcnkgPSBmdW5jdGlvbihhYWJiLCBxdWVyeUNhbGxiYWNrKSB7XG4gICAgICAgICAgX3RoaXMubV90cmVlLnF1ZXJ5KGFhYmIsIHF1ZXJ5Q2FsbGJhY2spO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnF1ZXJ5Q2FsbGJhY2sgPSBmdW5jdGlvbihwcm94eUlkKSB7XG4gICAgICAgICAgaWYgKHByb3h5SWQgPT09IF90aGlzLm1fcXVlcnlQcm94eUlkKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHByb3h5SWRBID0gbWF0aF9taW4kNihwcm94eUlkLCBfdGhpcy5tX3F1ZXJ5UHJveHlJZCk7XG4gICAgICAgICAgdmFyIHByb3h5SWRCID0gbWF0aF9tYXgkNShwcm94eUlkLCBfdGhpcy5tX3F1ZXJ5UHJveHlJZCk7XG4gICAgICAgICAgdmFyIHVzZXJEYXRhQSA9IF90aGlzLm1fdHJlZS5nZXRVc2VyRGF0YShwcm94eUlkQSk7XG4gICAgICAgICAgdmFyIHVzZXJEYXRhQiA9IF90aGlzLm1fdHJlZS5nZXRVc2VyRGF0YShwcm94eUlkQik7XG4gICAgICAgICAgX3RoaXMubV9jYWxsYmFjayh1c2VyRGF0YUEsIHVzZXJEYXRhQik7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuZ2V0VXNlckRhdGEgPSBmdW5jdGlvbihwcm94eUlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHJlZS5nZXRVc2VyRGF0YShwcm94eUlkKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUudGVzdE92ZXJsYXAgPSBmdW5jdGlvbihwcm94eUlkQSwgcHJveHlJZEIpIHtcbiAgICAgICAgdmFyIGFhYmJBID0gdGhpcy5tX3RyZWUuZ2V0RmF0QUFCQihwcm94eUlkQSk7XG4gICAgICAgIHZhciBhYWJiQiA9IHRoaXMubV90cmVlLmdldEZhdEFBQkIocHJveHlJZEIpO1xuICAgICAgICByZXR1cm4gQUFCQi50ZXN0T3ZlcmxhcChhYWJiQSwgYWFiYkIpO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5nZXRGYXRBQUJCID0gZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RyZWUuZ2V0RmF0QUFCQihwcm94eUlkKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuZ2V0UHJveHlDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21vdmVCdWZmZXIubGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5nZXRUcmVlSGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHJlZS5nZXRIZWlnaHQoKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuZ2V0VHJlZUJhbGFuY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90cmVlLmdldE1heEJhbGFuY2UoKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuZ2V0VHJlZVF1YWxpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90cmVlLmdldEFyZWFSYXRpbygpO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24oaW5wdXQyLCByYXlDYXN0Q2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5tX3RyZWUucmF5Q2FzdChpbnB1dDIsIHJheUNhc3RDYWxsYmFjayk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLnNoaWZ0T3JpZ2luID0gZnVuY3Rpb24obmV3T3JpZ2luKSB7XG4gICAgICAgIHRoaXMubV90cmVlLnNoaWZ0T3JpZ2luKG5ld09yaWdpbik7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmNyZWF0ZVByb3h5ID0gZnVuY3Rpb24oYWFiYiwgdXNlckRhdGEpIHtcbiAgICAgICAgdmFyIHByb3h5SWQgPSB0aGlzLm1fdHJlZS5jcmVhdGVQcm94eShhYWJiLCB1c2VyRGF0YSk7XG4gICAgICAgIHRoaXMuYnVmZmVyTW92ZShwcm94eUlkKTtcbiAgICAgICAgcmV0dXJuIHByb3h5SWQ7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmRlc3Ryb3lQcm94eSA9IGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgdGhpcy51bmJ1ZmZlck1vdmUocHJveHlJZCk7XG4gICAgICAgIHRoaXMubV90cmVlLmRlc3Ryb3lQcm94eShwcm94eUlkKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUubW92ZVByb3h5ID0gZnVuY3Rpb24ocHJveHlJZCwgYWFiYiwgZGlzcGxhY2VtZW50Mikge1xuICAgICAgICB2YXIgY2hhbmdlZCA9IHRoaXMubV90cmVlLm1vdmVQcm94eShwcm94eUlkLCBhYWJiLCBkaXNwbGFjZW1lbnQyKTtcbiAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICB0aGlzLmJ1ZmZlck1vdmUocHJveHlJZCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUudG91Y2hQcm94eSA9IGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgdGhpcy5idWZmZXJNb3ZlKHByb3h5SWQpO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5idWZmZXJNb3ZlID0gZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICB0aGlzLm1fbW92ZUJ1ZmZlci5wdXNoKHByb3h5SWQpO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS51bmJ1ZmZlck1vdmUgPSBmdW5jdGlvbihwcm94eUlkKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX21vdmVCdWZmZXIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICBpZiAodGhpcy5tX21vdmVCdWZmZXJbaV0gPT09IHByb3h5SWQpIHtcbiAgICAgICAgICAgIHRoaXMubV9tb3ZlQnVmZmVyW2ldID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUudXBkYXRlUGFpcnMgPSBmdW5jdGlvbihhZGRQYWlyQ2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5tX2NhbGxiYWNrID0gYWRkUGFpckNhbGxiYWNrO1xuICAgICAgICB3aGlsZSAodGhpcy5tX21vdmVCdWZmZXIubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHRoaXMubV9xdWVyeVByb3h5SWQgPSB0aGlzLm1fbW92ZUJ1ZmZlci5wb3AoKTtcbiAgICAgICAgICBpZiAodGhpcy5tX3F1ZXJ5UHJveHlJZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBmYXRBQUJCID0gdGhpcy5tX3RyZWUuZ2V0RmF0QUFCQih0aGlzLm1fcXVlcnlQcm94eUlkKTtcbiAgICAgICAgICB0aGlzLm1fdHJlZS5xdWVyeShmYXRBQUJCLCB0aGlzLnF1ZXJ5Q2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgcmV0dXJuIEJyb2FkUGhhc2UyO1xuICAgIH0oKVxuICApO1xuICB2YXIgbWF0aF9zaW4kMiA9IE1hdGguc2luO1xuICB2YXIgbWF0aF9jb3MkMiA9IE1hdGguY29zO1xuICB2YXIgbWF0aF9zcXJ0JDQgPSBNYXRoLnNxcnQ7XG4gIGZ1bmN0aW9uIHZlYzIoeDIsIHkpIHtcbiAgICByZXR1cm4geyB4OiB4MiwgeSB9O1xuICB9XG4gIGZ1bmN0aW9uIHJvdGF0aW9uKGFuZ2xlKSB7XG4gICAgcmV0dXJuIHsgczogbWF0aF9zaW4kMihhbmdsZSksIGM6IG1hdGhfY29zJDIoYW5nbGUpIH07XG4gIH1cbiAgZnVuY3Rpb24gc2V0VmVjMihvdXQsIHgyLCB5KSB7XG4gICAgb3V0LnggPSB4MjtcbiAgICBvdXQueSA9IHk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBjb3B5VmVjMihvdXQsIHcpIHtcbiAgICBvdXQueCA9IHcueDtcbiAgICBvdXQueSA9IHcueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHplcm9WZWMyKG91dCkge1xuICAgIG91dC54ID0gMDtcbiAgICBvdXQueSA9IDA7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBuZWdWZWMyKG91dCkge1xuICAgIG91dC54ID0gLW91dC54O1xuICAgIG91dC55ID0gLW91dC55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gcGx1c1ZlYzIob3V0LCB3KSB7XG4gICAgb3V0LnggKz0gdy54O1xuICAgIG91dC55ICs9IHcueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGFkZFZlYzIob3V0LCB2Mywgdykge1xuICAgIG91dC54ID0gdjMueCArIHcueDtcbiAgICBvdXQueSA9IHYzLnggKyB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBtaW51c1ZlYzIob3V0LCB3KSB7XG4gICAgb3V0LnggLT0gdy54O1xuICAgIG91dC55IC09IHcueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHN1YlZlYzIob3V0LCB2Mywgdykge1xuICAgIG91dC54ID0gdjMueCAtIHcueDtcbiAgICBvdXQueSA9IHYzLnkgLSB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBtdWxWZWMyKG91dCwgbSkge1xuICAgIG91dC54ICo9IG07XG4gICAgb3V0LnkgKj0gbTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHNjYWxlVmVjMihvdXQsIG0sIHcpIHtcbiAgICBvdXQueCA9IG0gKiB3Lng7XG4gICAgb3V0LnkgPSBtICogdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gcGx1c1NjYWxlVmVjMihvdXQsIG0sIHcpIHtcbiAgICBvdXQueCArPSBtICogdy54O1xuICAgIG91dC55ICs9IG0gKiB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBtaW51c1NjYWxlVmVjMihvdXQsIG0sIHcpIHtcbiAgICBvdXQueCAtPSBtICogdy54O1xuICAgIG91dC55IC09IG0gKiB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBjb21iaW5lMlZlYzIob3V0LCBhbSwgYTIsIGJtLCBiMikge1xuICAgIG91dC54ID0gYW0gKiBhMi54ICsgYm0gKiBiMi54O1xuICAgIG91dC55ID0gYW0gKiBhMi55ICsgYm0gKiBiMi55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gY29tYmluZTNWZWMyKG91dCwgYW0sIGEyLCBibSwgYjIsIGNtLCBjMikge1xuICAgIG91dC54ID0gYW0gKiBhMi54ICsgYm0gKiBiMi54ICsgY20gKiBjMi54O1xuICAgIG91dC55ID0gYW0gKiBhMi55ICsgYm0gKiBiMi55ICsgY20gKiBjMi55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gbm9ybWFsaXplVmVjMkxlbmd0aChvdXQpIHtcbiAgICB2YXIgbGVuZ3RoID0gbWF0aF9zcXJ0JDQob3V0LnggKiBvdXQueCArIG91dC55ICogb3V0LnkpO1xuICAgIGlmIChsZW5ndGggIT09IDApIHtcbiAgICAgIHZhciBpbnZMZW5ndGggPSAxIC8gbGVuZ3RoO1xuICAgICAgb3V0LnggKj0gaW52TGVuZ3RoO1xuICAgICAgb3V0LnkgKj0gaW52TGVuZ3RoO1xuICAgIH1cbiAgICByZXR1cm4gbGVuZ3RoO1xuICB9XG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZVZlYzIob3V0KSB7XG4gICAgdmFyIGxlbmd0aCA9IG1hdGhfc3FydCQ0KG91dC54ICogb3V0LnggKyBvdXQueSAqIG91dC55KTtcbiAgICBpZiAobGVuZ3RoID4gMCkge1xuICAgICAgdmFyIGludkxlbmd0aCA9IDEgLyBsZW5ndGg7XG4gICAgICBvdXQueCAqPSBpbnZMZW5ndGg7XG4gICAgICBvdXQueSAqPSBpbnZMZW5ndGg7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gY3Jvc3NWZWMyTnVtKG91dCwgdjMsIHcpIHtcbiAgICB2YXIgeDIgPSB3ICogdjMueTtcbiAgICB2YXIgeSA9IC13ICogdjMueDtcbiAgICBvdXQueCA9IHgyO1xuICAgIG91dC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGNyb3NzTnVtVmVjMihvdXQsIHcsIHYzKSB7XG4gICAgdmFyIHgyID0gLXcgKiB2My55O1xuICAgIHZhciB5ID0gdyAqIHYzLng7XG4gICAgb3V0LnggPSB4MjtcbiAgICBvdXQueSA9IHk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBjcm9zc1ZlYzJWZWMyKGEyLCBiMikge1xuICAgIHJldHVybiBhMi54ICogYjIueSAtIGEyLnkgKiBiMi54O1xuICB9XG4gIGZ1bmN0aW9uIGRvdFZlYzIoYTIsIGIyKSB7XG4gICAgcmV0dXJuIGEyLnggKiBiMi54ICsgYTIueSAqIGIyLnk7XG4gIH1cbiAgZnVuY3Rpb24gbGVuZ3RoU3FyVmVjMihhMikge1xuICAgIHJldHVybiBhMi54ICogYTIueCArIGEyLnkgKiBhMi55O1xuICB9XG4gIGZ1bmN0aW9uIGRpc3RWZWMyKGEyLCBiMikge1xuICAgIHZhciBkeCA9IGEyLnggLSBiMi54O1xuICAgIHZhciBkeSA9IGEyLnkgLSBiMi55O1xuICAgIHJldHVybiBtYXRoX3NxcnQkNChkeCAqIGR4ICsgZHkgKiBkeSk7XG4gIH1cbiAgZnVuY3Rpb24gZGlzdFNxclZlYzIoYTIsIGIyKSB7XG4gICAgdmFyIGR4ID0gYTIueCAtIGIyLng7XG4gICAgdmFyIGR5ID0gYTIueSAtIGIyLnk7XG4gICAgcmV0dXJuIGR4ICogZHggKyBkeSAqIGR5O1xuICB9XG4gIGZ1bmN0aW9uIHNldFJvdEFuZ2xlKG91dCwgYTIpIHtcbiAgICBvdXQuYyA9IG1hdGhfY29zJDIoYTIpO1xuICAgIG91dC5zID0gbWF0aF9zaW4kMihhMik7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiByb3RWZWMyKG91dCwgcSwgdjMpIHtcbiAgICBvdXQueCA9IHEuYyAqIHYzLnggLSBxLnMgKiB2My55O1xuICAgIG91dC55ID0gcS5zICogdjMueCArIHEuYyAqIHYzLnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBkZXJvdFZlYzIob3V0LCBxLCB2Mykge1xuICAgIHZhciB4MiA9IHEuYyAqIHYzLnggKyBxLnMgKiB2My55O1xuICAgIHZhciB5ID0gLXEucyAqIHYzLnggKyBxLmMgKiB2My55O1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gcmVyb3RWZWMyKG91dCwgYmVmb3JlLCBhZnRlciwgdjMpIHtcbiAgICB2YXIgeDAgPSBiZWZvcmUuYyAqIHYzLnggKyBiZWZvcmUucyAqIHYzLnk7XG4gICAgdmFyIHkwID0gLWJlZm9yZS5zICogdjMueCArIGJlZm9yZS5jICogdjMueTtcbiAgICB2YXIgeDIgPSBhZnRlci5jICogeDAgLSBhZnRlci5zICogeTA7XG4gICAgdmFyIHkgPSBhZnRlci5zICogeDAgKyBhZnRlci5jICogeTA7XG4gICAgb3V0LnggPSB4MjtcbiAgICBvdXQueSA9IHk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiB0cmFuc2Zvcm0oeDIsIHksIGEyKSB7XG4gICAgcmV0dXJuIHsgcDogdmVjMih4MiwgeSksIHE6IHJvdGF0aW9uKGEyKSB9O1xuICB9XG4gIGZ1bmN0aW9uIGNvcHlUcmFuc2Zvcm0ob3V0LCB0cmFuc2Zvcm0yKSB7XG4gICAgb3V0LnAueCA9IHRyYW5zZm9ybTIucC54O1xuICAgIG91dC5wLnkgPSB0cmFuc2Zvcm0yLnAueTtcbiAgICBvdXQucS5zID0gdHJhbnNmb3JtMi5xLnM7XG4gICAgb3V0LnEuYyA9IHRyYW5zZm9ybTIucS5jO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gdHJhbnNmb3JtVmVjMihvdXQsIHhmMiwgdjMpIHtcbiAgICB2YXIgeDIgPSB4ZjIucS5jICogdjMueCAtIHhmMi5xLnMgKiB2My55ICsgeGYyLnAueDtcbiAgICB2YXIgeSA9IHhmMi5xLnMgKiB2My54ICsgeGYyLnEuYyAqIHYzLnkgKyB4ZjIucC55O1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gZGV0cmFuc2Zvcm1WZWMyKG91dCwgeGYyLCB2Mykge1xuICAgIHZhciBweCA9IHYzLnggLSB4ZjIucC54O1xuICAgIHZhciBweSA9IHYzLnkgLSB4ZjIucC55O1xuICAgIHZhciB4MiA9IHhmMi5xLmMgKiBweCArIHhmMi5xLnMgKiBweTtcbiAgICB2YXIgeSA9IC14ZjIucS5zICogcHggKyB4ZjIucS5jICogcHk7XG4gICAgb3V0LnggPSB4MjtcbiAgICBvdXQueSA9IHk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiByZXRyYW5zZm9ybVZlYzIob3V0LCBmcm9tLCB0bywgdjMpIHtcbiAgICB2YXIgeDAgPSBmcm9tLnEuYyAqIHYzLnggLSBmcm9tLnEucyAqIHYzLnkgKyBmcm9tLnAueDtcbiAgICB2YXIgeTAgPSBmcm9tLnEucyAqIHYzLnggKyBmcm9tLnEuYyAqIHYzLnkgKyBmcm9tLnAueTtcbiAgICB2YXIgcHggPSB4MCAtIHRvLnAueDtcbiAgICB2YXIgcHkgPSB5MCAtIHRvLnAueTtcbiAgICB2YXIgeDIgPSB0by5xLmMgKiBweCArIHRvLnEucyAqIHB5O1xuICAgIHZhciB5ID0gLXRvLnEucyAqIHB4ICsgdG8ucS5jICogcHk7XG4gICAgb3V0LnggPSB4MjtcbiAgICBvdXQueSA9IHk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBkZXRyYW5zZm9ybVRyYW5zZm9ybShvdXQsIGEyLCBiMikge1xuICAgIHZhciBjMiA9IGEyLnEuYyAqIGIyLnEuYyArIGEyLnEucyAqIGIyLnEucztcbiAgICB2YXIgczIgPSBhMi5xLmMgKiBiMi5xLnMgLSBhMi5xLnMgKiBiMi5xLmM7XG4gICAgdmFyIHgyID0gYTIucS5jICogKGIyLnAueCAtIGEyLnAueCkgKyBhMi5xLnMgKiAoYjIucC55IC0gYTIucC55KTtcbiAgICB2YXIgeSA9IC1hMi5xLnMgKiAoYjIucC54IC0gYTIucC54KSArIGEyLnEuYyAqIChiMi5wLnkgLSBhMi5wLnkpO1xuICAgIG91dC5xLmMgPSBjMjtcbiAgICBvdXQucS5zID0gczI7XG4gICAgb3V0LnAueCA9IHgyO1xuICAgIG91dC5wLnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgdmFyIG1hdGhfc2luJDEgPSBNYXRoLnNpbjtcbiAgdmFyIG1hdGhfY29zJDEgPSBNYXRoLmNvcztcbiAgdmFyIG1hdGhfYXRhbjIkMSA9IE1hdGguYXRhbjI7XG4gIHZhciBSb3QgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gUm90MihhbmdsZSkge1xuICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUm90MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFJvdDIoYW5nbGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgYW5nbGUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICB0aGlzLnNldEFuZ2xlKGFuZ2xlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYW5nbGUgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLnNldFJvdChhbmdsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5zZXRJZGVudGl0eSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBSb3QyLm5lbyA9IGZ1bmN0aW9uKGFuZ2xlKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFJvdDIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnNldEFuZ2xlKGFuZ2xlKTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBSb3QyLmNsb25lID0gZnVuY3Rpb24ocm90KSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFJvdDIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnMgPSByb3QucztcbiAgICAgICAgb2JqLmMgPSByb3QuYztcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBSb3QyLmlkZW50aXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFJvdDIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnMgPSAwO1xuICAgICAgICBvYmouYyA9IDE7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgUm90Mi5pc1ZhbGlkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKG9iai5zKSAmJiBOdW1iZXIuaXNGaW5pdGUob2JqLmMpO1xuICAgICAgfTtcbiAgICAgIFJvdDIuYXNzZXJ0ID0gZnVuY3Rpb24obykge1xuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLnNldElkZW50aXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucyA9IDA7XG4gICAgICAgIHRoaXMuYyA9IDE7XG4gICAgICB9O1xuICAgICAgUm90Mi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24oYW5nbGUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhbmdsZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMucyA9IGFuZ2xlLnM7XG4gICAgICAgICAgdGhpcy5jID0gYW5nbGUuYztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnMgPSBtYXRoX3NpbiQxKGFuZ2xlKTtcbiAgICAgICAgICB0aGlzLmMgPSBtYXRoX2NvcyQxKGFuZ2xlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLnNldFJvdCA9IGZ1bmN0aW9uKGFuZ2xlKSB7XG4gICAgICAgIHRoaXMucyA9IGFuZ2xlLnM7XG4gICAgICAgIHRoaXMuYyA9IGFuZ2xlLmM7XG4gICAgICB9O1xuICAgICAgUm90Mi5wcm90b3R5cGUuc2V0QW5nbGUgPSBmdW5jdGlvbihhbmdsZSkge1xuICAgICAgICB0aGlzLnMgPSBtYXRoX3NpbiQxKGFuZ2xlKTtcbiAgICAgICAgdGhpcy5jID0gbWF0aF9jb3MkMShhbmdsZSk7XG4gICAgICB9O1xuICAgICAgUm90Mi5wcm90b3R5cGUuZ2V0QW5nbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG1hdGhfYXRhbjIkMSh0aGlzLnMsIHRoaXMuYyk7XG4gICAgICB9O1xuICAgICAgUm90Mi5wcm90b3R5cGUuZ2V0WEF4aXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHRoaXMuYywgdGhpcy5zKTtcbiAgICAgIH07XG4gICAgICBSb3QyLnByb3RvdHlwZS5nZXRZQXhpcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oLXRoaXMucywgdGhpcy5jKTtcbiAgICAgIH07XG4gICAgICBSb3QyLm11bCA9IGZ1bmN0aW9uKHJvdCwgbSkge1xuICAgICAgICBpZiAoXCJjXCIgaW4gbSAmJiBcInNcIiBpbiBtKSB7XG4gICAgICAgICAgdmFyIHFyID0gUm90Mi5pZGVudGl0eSgpO1xuICAgICAgICAgIHFyLnMgPSByb3QucyAqIG0uYyArIHJvdC5jICogbS5zO1xuICAgICAgICAgIHFyLmMgPSByb3QuYyAqIG0uYyAtIHJvdC5zICogbS5zO1xuICAgICAgICAgIHJldHVybiBxcjtcbiAgICAgICAgfSBlbHNlIGlmIChcInhcIiBpbiBtICYmIFwieVwiIGluIG0pIHtcbiAgICAgICAgICByZXR1cm4gVmVjMi5uZW8ocm90LmMgKiBtLnggLSByb3QucyAqIG0ueSwgcm90LnMgKiBtLnggKyByb3QuYyAqIG0ueSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSb3QyLm11bFJvdCA9IGZ1bmN0aW9uKHJvdCwgbSkge1xuICAgICAgICB2YXIgcXIgPSBSb3QyLmlkZW50aXR5KCk7XG4gICAgICAgIHFyLnMgPSByb3QucyAqIG0uYyArIHJvdC5jICogbS5zO1xuICAgICAgICBxci5jID0gcm90LmMgKiBtLmMgLSByb3QucyAqIG0ucztcbiAgICAgICAgcmV0dXJuIHFyO1xuICAgICAgfTtcbiAgICAgIFJvdDIubXVsVmVjMiA9IGZ1bmN0aW9uKHJvdCwgbSkge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8ocm90LmMgKiBtLnggLSByb3QucyAqIG0ueSwgcm90LnMgKiBtLnggKyByb3QuYyAqIG0ueSk7XG4gICAgICB9O1xuICAgICAgUm90Mi5tdWxTdWIgPSBmdW5jdGlvbihyb3QsIHYzLCB3KSB7XG4gICAgICAgIHZhciB4MiA9IHJvdC5jICogKHYzLnggLSB3LngpIC0gcm90LnMgKiAodjMueSAtIHcueSk7XG4gICAgICAgIHZhciB5ID0gcm90LnMgKiAodjMueCAtIHcueCkgKyByb3QuYyAqICh2My55IC0gdy55KTtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHgyLCB5KTtcbiAgICAgIH07XG4gICAgICBSb3QyLm11bFQgPSBmdW5jdGlvbihyb3QsIG0pIHtcbiAgICAgICAgaWYgKFwiY1wiIGluIG0gJiYgXCJzXCIgaW4gbSkge1xuICAgICAgICAgIHZhciBxciA9IFJvdDIuaWRlbnRpdHkoKTtcbiAgICAgICAgICBxci5zID0gcm90LmMgKiBtLnMgLSByb3QucyAqIG0uYztcbiAgICAgICAgICBxci5jID0gcm90LmMgKiBtLmMgKyByb3QucyAqIG0ucztcbiAgICAgICAgICByZXR1cm4gcXI7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJ4XCIgaW4gbSAmJiBcInlcIiBpbiBtKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIubmVvKHJvdC5jICogbS54ICsgcm90LnMgKiBtLnksIC1yb3QucyAqIG0ueCArIHJvdC5jICogbS55KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFJvdDIubXVsVFJvdCA9IGZ1bmN0aW9uKHJvdCwgbSkge1xuICAgICAgICB2YXIgcXIgPSBSb3QyLmlkZW50aXR5KCk7XG4gICAgICAgIHFyLnMgPSByb3QuYyAqIG0ucyAtIHJvdC5zICogbS5jO1xuICAgICAgICBxci5jID0gcm90LmMgKiBtLmMgKyByb3QucyAqIG0ucztcbiAgICAgICAgcmV0dXJuIHFyO1xuICAgICAgfTtcbiAgICAgIFJvdDIubXVsVFZlYzIgPSBmdW5jdGlvbihyb3QsIG0pIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHJvdC5jICogbS54ICsgcm90LnMgKiBtLnksIC1yb3QucyAqIG0ueCArIHJvdC5jICogbS55KTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gUm90MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfYXRhbjIgPSBNYXRoLmF0YW4yO1xuICB2YXIgbWF0aF9QSSQ1ID0gTWF0aC5QSTtcbiAgdmFyIHRlbXAkNyA9IHZlYzIoMCwgMCk7XG4gIHZhciBTd2VlcCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTd2VlcDIoKSB7XG4gICAgICAgIHRoaXMubG9jYWxDZW50ZXIgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5jID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMuYSA9IDA7XG4gICAgICAgIHRoaXMuYWxwaGEwID0gMDtcbiAgICAgICAgdGhpcy5jMCA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLmEwID0gMDtcbiAgICAgIH1cbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB6ZXJvVmVjMih0aGlzLmxvY2FsQ2VudGVyKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5jKTtcbiAgICAgICAgdGhpcy5hID0gMDtcbiAgICAgICAgdGhpcy5hbHBoYTAgPSAwO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLmMwKTtcbiAgICAgICAgdGhpcy5hMCA9IDA7XG4gICAgICB9O1xuICAgICAgU3dlZXAyLnByb3RvdHlwZS5zZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbih4ZjIpIHtcbiAgICAgICAgdHJhbnNmb3JtVmVjMih0ZW1wJDcsIHhmMiwgdGhpcy5sb2NhbENlbnRlcik7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMuYywgdGVtcCQ3KTtcbiAgICAgICAgY29weVZlYzIodGhpcy5jMCwgdGVtcCQ3KTtcbiAgICAgICAgdGhpcy5hID0gdGhpcy5hMCA9IG1hdGhfYXRhbjIoeGYyLnEucywgeGYyLnEuYyk7XG4gICAgICB9O1xuICAgICAgU3dlZXAyLnByb3RvdHlwZS5zZXRMb2NhbENlbnRlciA9IGZ1bmN0aW9uKGxvY2FsQ2VudGVyMiwgeGYyKSB7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMubG9jYWxDZW50ZXIsIGxvY2FsQ2VudGVyMik7XG4gICAgICAgIHRyYW5zZm9ybVZlYzIodGVtcCQ3LCB4ZjIsIHRoaXMubG9jYWxDZW50ZXIpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmMsIHRlbXAkNyk7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMuYzAsIHRlbXAkNyk7XG4gICAgICB9O1xuICAgICAgU3dlZXAyLnByb3RvdHlwZS5nZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbih4ZjIsIGJldGEpIHtcbiAgICAgICAgaWYgKGJldGEgPT09IHZvaWQgMCkge1xuICAgICAgICAgIGJldGEgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHNldFJvdEFuZ2xlKHhmMi5xLCAoMSAtIGJldGEpICogdGhpcy5hMCArIGJldGEgKiB0aGlzLmEpO1xuICAgICAgICBjb21iaW5lMlZlYzIoeGYyLnAsIDEgLSBiZXRhLCB0aGlzLmMwLCBiZXRhLCB0aGlzLmMpO1xuICAgICAgICBtaW51c1ZlYzIoeGYyLnAsIHJvdFZlYzIodGVtcCQ3LCB4ZjIucSwgdGhpcy5sb2NhbENlbnRlcikpO1xuICAgICAgfTtcbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUuYWR2YW5jZSA9IGZ1bmN0aW9uKGFscGhhKSB7XG4gICAgICAgIHZhciBiZXRhID0gKGFscGhhIC0gdGhpcy5hbHBoYTApIC8gKDEgLSB0aGlzLmFscGhhMCk7XG4gICAgICAgIGNvbWJpbmUyVmVjMih0aGlzLmMwLCBiZXRhLCB0aGlzLmMsIDEgLSBiZXRhLCB0aGlzLmMwKTtcbiAgICAgICAgdGhpcy5hMCA9IGJldGEgKiB0aGlzLmEgKyAoMSAtIGJldGEpICogdGhpcy5hMDtcbiAgICAgICAgdGhpcy5hbHBoYTAgPSBhbHBoYTtcbiAgICAgIH07XG4gICAgICBTd2VlcDIucHJvdG90eXBlLmZvcndhcmQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5hMCA9IHRoaXMuYTtcbiAgICAgICAgY29weVZlYzIodGhpcy5jMCwgdGhpcy5jKTtcbiAgICAgIH07XG4gICAgICBTd2VlcDIucHJvdG90eXBlLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYTAgPSBtb2QodGhpcy5hMCwgLW1hdGhfUEkkNSwgK21hdGhfUEkkNSk7XG4gICAgICAgIHRoaXMuYSAtPSB0aGlzLmEwIC0gYTA7XG4gICAgICAgIHRoaXMuYTAgPSBhMDtcbiAgICAgIH07XG4gICAgICBTd2VlcDIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRoYXQpIHtcbiAgICAgICAgY29weVZlYzIodGhpcy5sb2NhbENlbnRlciwgdGhhdC5sb2NhbENlbnRlcik7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMuYywgdGhhdC5jKTtcbiAgICAgICAgdGhpcy5hID0gdGhhdC5hO1xuICAgICAgICB0aGlzLmFscGhhMCA9IHRoYXQuYWxwaGEwO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmMwLCB0aGF0LmMwKTtcbiAgICAgICAgdGhpcy5hMCA9IHRoYXQuYTA7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFN3ZWVwMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFRyYW5zZm9ybSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBUcmFuc2Zvcm0yKHBvc2l0aW9uLCByb3RhdGlvbjIpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFRyYW5zZm9ybTIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2Zvcm0yKHBvc2l0aW9uLCByb3RhdGlvbjIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucCA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLnEgPSBSb3QuaWRlbnRpdHkoKTtcbiAgICAgICAgaWYgKHR5cGVvZiBwb3NpdGlvbiAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHRoaXMucC5zZXRWZWMyKHBvc2l0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHJvdGF0aW9uMiAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHRoaXMucS5zZXRBbmdsZShyb3RhdGlvbjIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBUcmFuc2Zvcm0yLmNsb25lID0gZnVuY3Rpb24oeGYyKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFRyYW5zZm9ybTIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnAgPSBWZWMyLmNsb25lKHhmMi5wKTtcbiAgICAgICAgb2JqLnEgPSBSb3QuY2xvbmUoeGYyLnEpO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubmVvID0gZnVuY3Rpb24ocG9zaXRpb24sIHJvdGF0aW9uMikge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShUcmFuc2Zvcm0yLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5wID0gVmVjMi5jbG9uZShwb3NpdGlvbik7XG4gICAgICAgIG9iai5xID0gUm90LmNsb25lKHJvdGF0aW9uMik7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5pZGVudGl0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShUcmFuc2Zvcm0yLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5wID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIG9iai5xID0gUm90LmlkZW50aXR5KCk7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5wcm90b3R5cGUuc2V0SWRlbnRpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5wLnNldFplcm8oKTtcbiAgICAgICAgdGhpcy5xLnNldElkZW50aXR5KCk7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYjIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0aGlzLnAuc2V0KGEyLnApO1xuICAgICAgICAgIHRoaXMucS5zZXQoYTIucSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5wLnNldChhMik7XG4gICAgICAgICAgdGhpcy5xLnNldChiMik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLnByb3RvdHlwZS5zZXROdW0gPSBmdW5jdGlvbihwb3NpdGlvbiwgcm90YXRpb24yKSB7XG4gICAgICAgIHRoaXMucC5zZXRWZWMyKHBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5xLnNldEFuZ2xlKHJvdGF0aW9uMik7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5wcm90b3R5cGUuc2V0VHJhbnNmb3JtID0gZnVuY3Rpb24oeGYyKSB7XG4gICAgICAgIHRoaXMucC5zZXRWZWMyKHhmMi5wKTtcbiAgICAgICAgdGhpcy5xLnNldFJvdCh4ZjIucSk7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5pc1ZhbGlkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gVmVjMi5pc1ZhbGlkKG9iai5wKSAmJiBSb3QuaXNWYWxpZChvYmoucSk7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5hc3NlcnQgPSBmdW5jdGlvbihvKSB7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5tdWwgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYjIpKSB7XG4gICAgICAgICAgdmFyIGFyciA9IFtdO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYjIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFycltpXSA9IFRyYW5zZm9ybTIubXVsKGEyLCBiMltpXSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBhcnI7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJ4XCIgaW4gYjIgJiYgXCJ5XCIgaW4gYjIpIHtcbiAgICAgICAgICByZXR1cm4gVHJhbnNmb3JtMi5tdWxWZWMyKGEyLCBiMik7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJwXCIgaW4gYjIgJiYgXCJxXCIgaW4gYjIpIHtcbiAgICAgICAgICByZXR1cm4gVHJhbnNmb3JtMi5tdWxYZihhMiwgYjIpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5tdWxBbGwgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIGFyciA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgYXJyW2ldID0gVHJhbnNmb3JtMi5tdWwoYTIsIGIyW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsRm4gPSBmdW5jdGlvbihhMikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oYjIpIHtcbiAgICAgICAgICByZXR1cm4gVHJhbnNmb3JtMi5tdWwoYTIsIGIyKTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm11bFZlYzIgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIHgyID0gYTIucS5jICogYjIueCAtIGEyLnEucyAqIGIyLnkgKyBhMi5wLng7XG4gICAgICAgIHZhciB5ID0gYTIucS5zICogYjIueCArIGEyLnEuYyAqIGIyLnkgKyBhMi5wLnk7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh4MiwgeSk7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5tdWxYZiA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgeGYyID0gVHJhbnNmb3JtMi5pZGVudGl0eSgpO1xuICAgICAgICB4ZjIucSA9IFJvdC5tdWxSb3QoYTIucSwgYjIucSk7XG4gICAgICAgIHhmMi5wID0gVmVjMi5hZGQoUm90Lm11bFZlYzIoYTIucSwgYjIucCksIGEyLnApO1xuICAgICAgICByZXR1cm4geGYyO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsVCA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICBpZiAoXCJ4XCIgaW4gYjIgJiYgXCJ5XCIgaW4gYjIpIHtcbiAgICAgICAgICByZXR1cm4gVHJhbnNmb3JtMi5tdWxUVmVjMihhMiwgYjIpO1xuICAgICAgICB9IGVsc2UgaWYgKFwicFwiIGluIGIyICYmIFwicVwiIGluIGIyKSB7XG4gICAgICAgICAgcmV0dXJuIFRyYW5zZm9ybTIubXVsVFhmKGEyLCBiMik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm11bFRWZWMyID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciBweCA9IGIyLnggLSBhMi5wLng7XG4gICAgICAgIHZhciBweSA9IGIyLnkgLSBhMi5wLnk7XG4gICAgICAgIHZhciB4MiA9IGEyLnEuYyAqIHB4ICsgYTIucS5zICogcHk7XG4gICAgICAgIHZhciB5ID0gLWEyLnEucyAqIHB4ICsgYTIucS5jICogcHk7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh4MiwgeSk7XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5tdWxUWGYgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIHhmMiA9IFRyYW5zZm9ybTIuaWRlbnRpdHkoKTtcbiAgICAgICAgeGYyLnEuc2V0Um90KFJvdC5tdWxUUm90KGEyLnEsIGIyLnEpKTtcbiAgICAgICAgeGYyLnAuc2V0VmVjMihSb3QubXVsVFZlYzIoYTIucSwgVmVjMi5zdWIoYjIucCwgYTIucCkpKTtcbiAgICAgICAgcmV0dXJuIHhmMjtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVHJhbnNmb3JtMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFZlbG9jaXR5ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICAvKiBAX19QVVJFX18gKi8gZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBWZWxvY2l0eTIoKSB7XG4gICAgICAgIHRoaXMudiA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLncgPSAwO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFZlbG9jaXR5MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfc2luID0gTWF0aC5zaW47XG4gIHZhciBtYXRoX2NvcyA9IE1hdGguY29zO1xuICB2YXIgUG9zaXRpb24gPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gUG9zaXRpb24yKCkge1xuICAgICAgICB0aGlzLmMgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5hID0gMDtcbiAgICAgIH1cbiAgICAgIFBvc2l0aW9uMi5wcm90b3R5cGUuZ2V0VHJhbnNmb3JtID0gZnVuY3Rpb24oeGYyLCBwKSB7XG4gICAgICAgIHhmMi5xLmMgPSBtYXRoX2Nvcyh0aGlzLmEpO1xuICAgICAgICB4ZjIucS5zID0gbWF0aF9zaW4odGhpcy5hKTtcbiAgICAgICAgeGYyLnAueCA9IHRoaXMuYy54IC0gKHhmMi5xLmMgKiBwLnggLSB4ZjIucS5zICogcC55KTtcbiAgICAgICAgeGYyLnAueSA9IHRoaXMuYy55IC0gKHhmMi5xLnMgKiBwLnggKyB4ZjIucS5jICogcC55KTtcbiAgICAgICAgcmV0dXJuIHhmMjtcbiAgICAgIH07XG4gICAgICByZXR1cm4gUG9zaXRpb24yO1xuICAgIH0oKVxuICApO1xuICBmdW5jdGlvbiBnZXRUcmFuc2Zvcm0oeGYyLCBwLCBjMiwgYTIpIHtcbiAgICB4ZjIucS5jID0gbWF0aF9jb3MoYTIpO1xuICAgIHhmMi5xLnMgPSBtYXRoX3NpbihhMik7XG4gICAgeGYyLnAueCA9IGMyLnggLSAoeGYyLnEuYyAqIHAueCAtIHhmMi5xLnMgKiBwLnkpO1xuICAgIHhmMi5wLnkgPSBjMi55IC0gKHhmMi5xLnMgKiBwLnggKyB4ZjIucS5jICogcC55KTtcbiAgICByZXR1cm4geGYyO1xuICB9XG4gIHZhciBTaGFwZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTaGFwZTIoKSB7XG4gICAgICAgIHRoaXMuc3R5bGUgPSB7fTtcbiAgICAgICAgdGhpcy5hcHBEYXRhID0ge307XG4gICAgICB9XG4gICAgICBTaGFwZTIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHR5cGVvZiBvYmoubV90eXBlID09PSBcInN0cmluZ1wiICYmIHR5cGVvZiBvYmoubV9yYWRpdXMgPT09IFwibnVtYmVyXCI7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFNoYXBlMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIHN5bmNocm9uaXplX2FhYmIxID0gbmV3IEFBQkIoKTtcbiAgdmFyIHN5bmNocm9uaXplX2FhYmIyID0gbmV3IEFBQkIoKTtcbiAgdmFyIGRpc3BsYWNlbWVudCA9IHZlYzIoMCwgMCk7XG4gIHZhciBGaXh0dXJlRGVmRGVmYXVsdCA9IHtcbiAgICB1c2VyRGF0YTogbnVsbCxcbiAgICBmcmljdGlvbjogMC4yLFxuICAgIHJlc3RpdHV0aW9uOiAwLFxuICAgIGRlbnNpdHk6IDAsXG4gICAgaXNTZW5zb3I6IGZhbHNlLFxuICAgIGZpbHRlckdyb3VwSW5kZXg6IDAsXG4gICAgZmlsdGVyQ2F0ZWdvcnlCaXRzOiAxLFxuICAgIGZpbHRlck1hc2tCaXRzOiA2NTUzNVxuICB9O1xuICB2YXIgRml4dHVyZVByb3h5ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICAvKiBAX19QVVJFX18gKi8gZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBGaXh0dXJlUHJveHkyKGZpeHR1cmUsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdGhpcy5hYWJiID0gbmV3IEFBQkIoKTtcbiAgICAgICAgdGhpcy5maXh0dXJlID0gZml4dHVyZTtcbiAgICAgICAgdGhpcy5jaGlsZEluZGV4ID0gY2hpbGRJbmRleDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBGaXh0dXJlUHJveHkyO1xuICAgIH0oKVxuICApO1xuICB2YXIgRml4dHVyZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBGaXh0dXJlMihib2R5LCBzaGFwZSwgZGVmKSB7XG4gICAgICAgIHRoaXMuc3R5bGUgPSB7fTtcbiAgICAgICAgdGhpcy5hcHBEYXRhID0ge307XG4gICAgICAgIGlmIChzaGFwZS5zaGFwZSkge1xuICAgICAgICAgIGRlZiA9IHNoYXBlO1xuICAgICAgICAgIHNoYXBlID0gc2hhcGUuc2hhcGU7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGRlZiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIGRlZiA9IHsgZGVuc2l0eTogZGVmIH07XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIEZpeHR1cmVEZWZEZWZhdWx0KTtcbiAgICAgICAgdGhpcy5tX2JvZHkgPSBib2R5O1xuICAgICAgICB0aGlzLm1fZnJpY3Rpb24gPSBkZWYuZnJpY3Rpb247XG4gICAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IGRlZi5yZXN0aXR1dGlvbjtcbiAgICAgICAgdGhpcy5tX2RlbnNpdHkgPSBkZWYuZGVuc2l0eTtcbiAgICAgICAgdGhpcy5tX2lzU2Vuc29yID0gZGVmLmlzU2Vuc29yO1xuICAgICAgICB0aGlzLm1fZmlsdGVyR3JvdXBJbmRleCA9IGRlZi5maWx0ZXJHcm91cEluZGV4O1xuICAgICAgICB0aGlzLm1fZmlsdGVyQ2F0ZWdvcnlCaXRzID0gZGVmLmZpbHRlckNhdGVnb3J5Qml0cztcbiAgICAgICAgdGhpcy5tX2ZpbHRlck1hc2tCaXRzID0gZGVmLmZpbHRlck1hc2tCaXRzO1xuICAgICAgICB0aGlzLm1fc2hhcGUgPSBzaGFwZTtcbiAgICAgICAgdGhpcy5tX25leHQgPSBudWxsO1xuICAgICAgICB0aGlzLm1fcHJveGllcyA9IFtdO1xuICAgICAgICB0aGlzLm1fcHJveHlDb3VudCA9IDA7XG4gICAgICAgIHZhciBjaGlsZENvdW50ID0gdGhpcy5tX3NoYXBlLmdldENoaWxkQ291bnQoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZENvdW50OyArK2kpIHtcbiAgICAgICAgICB0aGlzLm1fcHJveGllc1tpXSA9IG5ldyBGaXh0dXJlUHJveHkodGhpcywgaSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3VzZXJEYXRhID0gZGVmLnVzZXJEYXRhO1xuICAgICAgICBpZiAodHlwZW9mIGRlZi5zdHlsZSA9PT0gXCJvYmplY3RcIiAmJiBkZWYuc3R5bGUgIT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLnN0eWxlID0gZGVmLnN0eWxlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBib2R5ID0gdGhpcy5nZXRCb2R5KCk7XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gYm9keS5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgdGhpcy5kZXN0cm95UHJveGllcyhicm9hZFBoYXNlKTtcbiAgICAgICAgaWYgKHRoaXMubV9zaGFwZS5fcmVzZXQpIHtcbiAgICAgICAgICB0aGlzLm1fc2hhcGUuX3Jlc2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkQ291bnQgPSB0aGlzLm1fc2hhcGUuZ2V0Q2hpbGRDb3VudCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkQ291bnQ7ICsraSkge1xuICAgICAgICAgIHRoaXMubV9wcm94aWVzW2ldID0gbmV3IEZpeHR1cmVQcm94eSh0aGlzLCBpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNyZWF0ZVByb3hpZXMoYnJvYWRQaGFzZSwgYm9keS5tX3hmKTtcbiAgICAgICAgYm9keS5yZXNldE1hc3NEYXRhKCk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBmcmljdGlvbjogdGhpcy5tX2ZyaWN0aW9uLFxuICAgICAgICAgIHJlc3RpdHV0aW9uOiB0aGlzLm1fcmVzdGl0dXRpb24sXG4gICAgICAgICAgZGVuc2l0eTogdGhpcy5tX2RlbnNpdHksXG4gICAgICAgICAgaXNTZW5zb3I6IHRoaXMubV9pc1NlbnNvcixcbiAgICAgICAgICBmaWx0ZXJHcm91cEluZGV4OiB0aGlzLm1fZmlsdGVyR3JvdXBJbmRleCxcbiAgICAgICAgICBmaWx0ZXJDYXRlZ29yeUJpdHM6IHRoaXMubV9maWx0ZXJDYXRlZ29yeUJpdHMsXG4gICAgICAgICAgZmlsdGVyTWFza0JpdHM6IHRoaXMubV9maWx0ZXJNYXNrQml0cyxcbiAgICAgICAgICBzaGFwZTogdGhpcy5tX3NoYXBlXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgYm9keSwgcmVzdG9yZSkge1xuICAgICAgICB2YXIgc2hhcGUgPSByZXN0b3JlKFNoYXBlLCBkYXRhLnNoYXBlKTtcbiAgICAgICAgdmFyIGZpeHR1cmUgPSBzaGFwZSAmJiBuZXcgRml4dHVyZTIoYm9keSwgc2hhcGUsIGRhdGEpO1xuICAgICAgICByZXR1cm4gZml4dHVyZTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3NoYXBlLm1fdHlwZTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0U2hhcGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9zaGFwZTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuaXNTZW5zb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9pc1NlbnNvcjtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0U2Vuc29yID0gZnVuY3Rpb24oc2Vuc29yKSB7XG4gICAgICAgIGlmIChzZW5zb3IgIT0gdGhpcy5tX2lzU2Vuc29yKSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHkuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2lzU2Vuc29yID0gc2Vuc29yO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldFVzZXJEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdXNlckRhdGE7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldFVzZXJEYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICB0aGlzLm1fdXNlckRhdGEgPSBkYXRhO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRCb2R5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0TmV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX25leHQ7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldERlbnNpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9kZW5zaXR5O1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXREZW5zaXR5ID0gZnVuY3Rpb24oZGVuc2l0eSkge1xuICAgICAgICB0aGlzLm1fZGVuc2l0eSA9IGRlbnNpdHk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldEZyaWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZnJpY3Rpb247XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldEZyaWN0aW9uID0gZnVuY3Rpb24oZnJpY3Rpb24pIHtcbiAgICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gZnJpY3Rpb247XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldFJlc3RpdHV0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmVzdGl0dXRpb247XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldFJlc3RpdHV0aW9uID0gZnVuY3Rpb24ocmVzdGl0dXRpb24pIHtcbiAgICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gcmVzdGl0dXRpb247XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnRlc3RQb2ludCA9IGZ1bmN0aW9uKHApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9zaGFwZS50ZXN0UG9pbnQodGhpcy5tX2JvZHkuZ2V0VHJhbnNmb3JtKCksIHApO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc2hhcGUucmF5Q2FzdChvdXRwdXQyLCBpbnB1dDIsIHRoaXMubV9ib2R5LmdldFRyYW5zZm9ybSgpLCBjaGlsZEluZGV4KTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0TWFzc0RhdGEgPSBmdW5jdGlvbihtYXNzRGF0YSkge1xuICAgICAgICB0aGlzLm1fc2hhcGUuY29tcHV0ZU1hc3MobWFzc0RhdGEsIHRoaXMubV9kZW5zaXR5KTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0QUFCQiA9IGZ1bmN0aW9uKGNoaWxkSW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9wcm94aWVzW2NoaWxkSW5kZXhdLmFhYmI7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmNyZWF0ZVByb3hpZXMgPSBmdW5jdGlvbihicm9hZFBoYXNlLCB4ZjIpIHtcbiAgICAgICAgdGhpcy5tX3Byb3h5Q291bnQgPSB0aGlzLm1fc2hhcGUuZ2V0Q2hpbGRDb3VudCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9wcm94eUNvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgcHJveHkgPSB0aGlzLm1fcHJveGllc1tpXTtcbiAgICAgICAgICB0aGlzLm1fc2hhcGUuY29tcHV0ZUFBQkIocHJveHkuYWFiYiwgeGYyLCBpKTtcbiAgICAgICAgICBwcm94eS5wcm94eUlkID0gYnJvYWRQaGFzZS5jcmVhdGVQcm94eShwcm94eS5hYWJiLCBwcm94eSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZGVzdHJveVByb3hpZXMgPSBmdW5jdGlvbihicm9hZFBoYXNlKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX3Byb3h5Q291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciBwcm94eSA9IHRoaXMubV9wcm94aWVzW2ldO1xuICAgICAgICAgIGJyb2FkUGhhc2UuZGVzdHJveVByb3h5KHByb3h5LnByb3h5SWQpO1xuICAgICAgICAgIHByb3h5LnByb3h5SWQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9wcm94eUNvdW50ID0gMDtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc3luY2hyb25pemUgPSBmdW5jdGlvbihicm9hZFBoYXNlLCB4ZjEsIHhmMikge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9wcm94eUNvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgcHJveHkgPSB0aGlzLm1fcHJveGllc1tpXTtcbiAgICAgICAgICB0aGlzLm1fc2hhcGUuY29tcHV0ZUFBQkIoc3luY2hyb25pemVfYWFiYjEsIHhmMSwgcHJveHkuY2hpbGRJbmRleCk7XG4gICAgICAgICAgdGhpcy5tX3NoYXBlLmNvbXB1dGVBQUJCKHN5bmNocm9uaXplX2FhYmIyLCB4ZjIsIHByb3h5LmNoaWxkSW5kZXgpO1xuICAgICAgICAgIHByb3h5LmFhYmIuY29tYmluZShzeW5jaHJvbml6ZV9hYWJiMSwgc3luY2hyb25pemVfYWFiYjIpO1xuICAgICAgICAgIHN1YlZlYzIoZGlzcGxhY2VtZW50LCB4ZjIucCwgeGYxLnApO1xuICAgICAgICAgIGJyb2FkUGhhc2UubW92ZVByb3h5KHByb3h5LnByb3h5SWQsIHByb3h5LmFhYmIsIGRpc3BsYWNlbWVudCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0RmlsdGVyRGF0YSA9IGZ1bmN0aW9uKGZpbHRlcikge1xuICAgICAgICB0aGlzLm1fZmlsdGVyR3JvdXBJbmRleCA9IGZpbHRlci5ncm91cEluZGV4O1xuICAgICAgICB0aGlzLm1fZmlsdGVyQ2F0ZWdvcnlCaXRzID0gZmlsdGVyLmNhdGVnb3J5Qml0cztcbiAgICAgICAgdGhpcy5tX2ZpbHRlck1hc2tCaXRzID0gZmlsdGVyLm1hc2tCaXRzO1xuICAgICAgICB0aGlzLnJlZmlsdGVyKCk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldEZpbHRlckdyb3VwSW5kZXggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9maWx0ZXJHcm91cEluZGV4O1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRGaWx0ZXJHcm91cEluZGV4ID0gZnVuY3Rpb24oZ3JvdXBJbmRleCkge1xuICAgICAgICB0aGlzLm1fZmlsdGVyR3JvdXBJbmRleCA9IGdyb3VwSW5kZXg7XG4gICAgICAgIHRoaXMucmVmaWx0ZXIoKTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0RmlsdGVyQ2F0ZWdvcnlCaXRzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZmlsdGVyQ2F0ZWdvcnlCaXRzO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRGaWx0ZXJDYXRlZ29yeUJpdHMgPSBmdW5jdGlvbihjYXRlZ29yeUJpdHMpIHtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckNhdGVnb3J5Qml0cyA9IGNhdGVnb3J5Qml0cztcbiAgICAgICAgdGhpcy5yZWZpbHRlcigpO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRGaWx0ZXJNYXNrQml0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZpbHRlck1hc2tCaXRzO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRGaWx0ZXJNYXNrQml0cyA9IGZ1bmN0aW9uKG1hc2tCaXRzKSB7XG4gICAgICAgIHRoaXMubV9maWx0ZXJNYXNrQml0cyA9IG1hc2tCaXRzO1xuICAgICAgICB0aGlzLnJlZmlsdGVyKCk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnJlZmlsdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm1fYm9keSA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlZGdlID0gdGhpcy5tX2JvZHkuZ2V0Q29udGFjdExpc3QoKTtcbiAgICAgICAgd2hpbGUgKGVkZ2UpIHtcbiAgICAgICAgICB2YXIgY29udGFjdCA9IGVkZ2UuY29udGFjdDtcbiAgICAgICAgICB2YXIgZml4dHVyZUEgPSBjb250YWN0LmdldEZpeHR1cmVBKCk7XG4gICAgICAgICAgdmFyIGZpeHR1cmVCID0gY29udGFjdC5nZXRGaXh0dXJlQigpO1xuICAgICAgICAgIGlmIChmaXh0dXJlQSA9PSB0aGlzIHx8IGZpeHR1cmVCID09IHRoaXMpIHtcbiAgICAgICAgICAgIGNvbnRhY3QuZmxhZ0ZvckZpbHRlcmluZygpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIHZhciB3b3JsZCA9IHRoaXMubV9ib2R5LmdldFdvcmxkKCk7XG4gICAgICAgIGlmICh3b3JsZCA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9wcm94eUNvdW50OyArK2kpIHtcbiAgICAgICAgICBicm9hZFBoYXNlLnRvdWNoUHJveHkodGhpcy5tX3Byb3hpZXNbaV0ucHJveHlJZCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2hvdWxkQ29sbGlkZSA9IGZ1bmN0aW9uKHRoYXQpIHtcbiAgICAgICAgaWYgKHRoYXQubV9maWx0ZXJHcm91cEluZGV4ID09PSB0aGlzLm1fZmlsdGVyR3JvdXBJbmRleCAmJiB0aGF0Lm1fZmlsdGVyR3JvdXBJbmRleCAhPT0gMCkge1xuICAgICAgICAgIHJldHVybiB0aGF0Lm1fZmlsdGVyR3JvdXBJbmRleCA+IDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbGxpZGVBID0gKHRoYXQubV9maWx0ZXJNYXNrQml0cyAmIHRoaXMubV9maWx0ZXJDYXRlZ29yeUJpdHMpICE9PSAwO1xuICAgICAgICB2YXIgY29sbGlkZUIgPSAodGhhdC5tX2ZpbHRlckNhdGVnb3J5Qml0cyAmIHRoaXMubV9maWx0ZXJNYXNrQml0cykgIT09IDA7XG4gICAgICAgIHZhciBjb2xsaWRlID0gY29sbGlkZUEgJiYgY29sbGlkZUI7XG4gICAgICAgIHJldHVybiBjb2xsaWRlO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBGaXh0dXJlMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFNUQVRJQyA9IFwic3RhdGljXCI7XG4gIHZhciBLSU5FTUFUSUMgPSBcImtpbmVtYXRpY1wiO1xuICB2YXIgRFlOQU1JQyA9IFwiZHluYW1pY1wiO1xuICB2YXIgb2xkQ2VudGVyID0gdmVjMigwLCAwKTtcbiAgdmFyIGxvY2FsQ2VudGVyID0gdmVjMigwLCAwKTtcbiAgdmFyIHNoaWZ0ID0gdmVjMigwLCAwKTtcbiAgdmFyIHRlbXAkNiA9IHZlYzIoMCwgMCk7XG4gIHZhciB4ZiQyID0gdHJhbnNmb3JtKDAsIDAsIDApO1xuICB2YXIgQm9keURlZkRlZmF1bHQgPSB7XG4gICAgdHlwZTogU1RBVElDLFxuICAgIHBvc2l0aW9uOiBWZWMyLnplcm8oKSxcbiAgICBhbmdsZTogMCxcbiAgICBsaW5lYXJWZWxvY2l0eTogVmVjMi56ZXJvKCksXG4gICAgYW5ndWxhclZlbG9jaXR5OiAwLFxuICAgIGxpbmVhckRhbXBpbmc6IDAsXG4gICAgYW5ndWxhckRhbXBpbmc6IDAsXG4gICAgZml4ZWRSb3RhdGlvbjogZmFsc2UsXG4gICAgYnVsbGV0OiBmYWxzZSxcbiAgICBncmF2aXR5U2NhbGU6IDEsXG4gICAgYWxsb3dTbGVlcDogdHJ1ZSxcbiAgICBhd2FrZTogdHJ1ZSxcbiAgICBhY3RpdmU6IHRydWUsXG4gICAgdXNlckRhdGE6IG51bGxcbiAgfTtcbiAgdmFyIEJvZHkgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gQm9keTIod29ybGQsIGRlZikge1xuICAgICAgICB0aGlzLnN0eWxlID0ge307XG4gICAgICAgIHRoaXMuYXBwRGF0YSA9IHt9O1xuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgQm9keURlZkRlZmF1bHQpO1xuICAgICAgICB0aGlzLm1fd29ybGQgPSB3b3JsZDtcbiAgICAgICAgdGhpcy5tX2F3YWtlRmxhZyA9IGRlZi5hd2FrZTtcbiAgICAgICAgdGhpcy5tX2F1dG9TbGVlcEZsYWcgPSBkZWYuYWxsb3dTbGVlcDtcbiAgICAgICAgdGhpcy5tX2J1bGxldEZsYWcgPSBkZWYuYnVsbGV0O1xuICAgICAgICB0aGlzLm1fZml4ZWRSb3RhdGlvbkZsYWcgPSBkZWYuZml4ZWRSb3RhdGlvbjtcbiAgICAgICAgdGhpcy5tX2FjdGl2ZUZsYWcgPSBkZWYuYWN0aXZlO1xuICAgICAgICB0aGlzLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fdG9pRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fdXNlckRhdGEgPSBkZWYudXNlckRhdGE7XG4gICAgICAgIHRoaXMubV90eXBlID0gZGVmLnR5cGU7XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSBEWU5BTUlDKSB7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSAxO1xuICAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fbWFzcyA9IDA7XG4gICAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9JID0gMDtcbiAgICAgICAgdGhpcy5tX2ludkkgPSAwO1xuICAgICAgICB0aGlzLm1feGYgPSBUcmFuc2Zvcm0uaWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy5tX3hmLnAuc2V0VmVjMihkZWYucG9zaXRpb24pO1xuICAgICAgICB0aGlzLm1feGYucS5zZXRBbmdsZShkZWYuYW5nbGUpO1xuICAgICAgICB0aGlzLm1fc3dlZXAgPSBuZXcgU3dlZXAoKTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLnNldFRyYW5zZm9ybSh0aGlzLm1feGYpO1xuICAgICAgICB0aGlzLmNfdmVsb2NpdHkgPSBuZXcgVmVsb2NpdHkoKTtcbiAgICAgICAgdGhpcy5jX3Bvc2l0aW9uID0gbmV3IFBvc2l0aW9uKCk7XG4gICAgICAgIHRoaXMubV9mb3JjZSA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLm1fdG9ycXVlID0gMDtcbiAgICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5ID0gVmVjMi5jbG9uZShkZWYubGluZWFyVmVsb2NpdHkpO1xuICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gZGVmLmFuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgdGhpcy5tX2xpbmVhckRhbXBpbmcgPSBkZWYubGluZWFyRGFtcGluZztcbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJEYW1waW5nID0gZGVmLmFuZ3VsYXJEYW1waW5nO1xuICAgICAgICB0aGlzLm1fZ3Jhdml0eVNjYWxlID0gZGVmLmdyYXZpdHlTY2FsZTtcbiAgICAgICAgdGhpcy5tX3NsZWVwVGltZSA9IDA7XG4gICAgICAgIHRoaXMubV9qb2ludExpc3QgPSBudWxsO1xuICAgICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBudWxsO1xuICAgICAgICB0aGlzLm1fZml4dHVyZUxpc3QgPSBudWxsO1xuICAgICAgICB0aGlzLm1fcHJldiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2Rlc3Ryb3llZCA9IGZhbHNlO1xuICAgICAgICBpZiAodHlwZW9mIGRlZi5zdHlsZSA9PT0gXCJvYmplY3RcIiAmJiBkZWYuc3R5bGUgIT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLnN0eWxlID0gZGVmLnN0eWxlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZml4dHVyZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgZml4dHVyZXMucHVzaChmKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJ1bGxldDogdGhpcy5tX2J1bGxldEZsYWcsXG4gICAgICAgICAgcG9zaXRpb246IHRoaXMubV94Zi5wLFxuICAgICAgICAgIGFuZ2xlOiB0aGlzLm1feGYucS5nZXRBbmdsZSgpLFxuICAgICAgICAgIGxpbmVhclZlbG9jaXR5OiB0aGlzLm1fbGluZWFyVmVsb2NpdHksXG4gICAgICAgICAgYW5ndWxhclZlbG9jaXR5OiB0aGlzLm1fYW5ndWxhclZlbG9jaXR5LFxuICAgICAgICAgIGZpeHR1cmVzXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgQm9keTIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgdmFyIGJvZHkgPSBuZXcgQm9keTIod29ybGQsIGRhdGEpO1xuICAgICAgICBpZiAoZGF0YS5maXh0dXJlcykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSBkYXRhLmZpeHR1cmVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgZml4dHVyZSA9IHJlc3RvcmUoRml4dHVyZSwgZGF0YS5maXh0dXJlc1tpXSwgYm9keSk7XG4gICAgICAgICAgICBib2R5Ll9hZGRGaXh0dXJlKGZpeHR1cmUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYm9keTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNXb3JsZExvY2tlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3dvcmxkICYmIHRoaXMubV93b3JsZC5pc0xvY2tlZCgpID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRXb3JsZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3dvcmxkO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXROZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0VXNlckRhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRhdGE7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldFVzZXJEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdXNlckRhdGE7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldEZpeHR1cmVMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZml4dHVyZUxpc3Q7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldEpvaW50TGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2pvaW50TGlzdDtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0Q29udGFjdExpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNTdGF0aWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlID09IFNUQVRJQztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNEeW5hbWljID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZSA9PSBEWU5BTUlDO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc0tpbmVtYXRpYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGUgPT0gS0lORU1BVElDO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRTdGF0aWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zZXRUeXBlKFNUQVRJQyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXREeW5hbWljID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2V0VHlwZShEWU5BTUlDKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEtpbmVtYXRpYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNldFR5cGUoS0lORU1BVElDKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRUeXBlID0gZnVuY3Rpb24odHlwZSkge1xuICAgICAgICBpZiAodGhpcy5pc1dvcmxkTG9ja2VkKCkgPT0gdHJ1ZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX3R5cGUgPT0gdHlwZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fdHlwZSA9IHR5cGU7XG4gICAgICAgIHRoaXMucmVzZXRNYXNzRGF0YSgpO1xuICAgICAgICBpZiAodGhpcy5tX3R5cGUgPT0gU1RBVElDKSB7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gMDtcbiAgICAgICAgICB0aGlzLm1fc3dlZXAuZm9yd2FyZCgpO1xuICAgICAgICAgIHRoaXMuc3luY2hyb25pemVGaXh0dXJlcygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9mb3JjZS5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMubV90b3JxdWUgPSAwO1xuICAgICAgICB2YXIgY2UgPSB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICAgIHdoaWxlIChjZSkge1xuICAgICAgICAgIHZhciBjZTAgPSBjZTtcbiAgICAgICAgICBjZSA9IGNlLm5leHQ7XG4gICAgICAgICAgdGhpcy5tX3dvcmxkLmRlc3Ryb3lDb250YWN0KGNlMC5jb250YWN0KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBudWxsO1xuICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgIGZvciAodmFyIGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZi5tX3Byb3h5Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgYnJvYWRQaGFzZS50b3VjaFByb3h5KGYubV9wcm94aWVzW2ldLnByb3h5SWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc0J1bGxldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2J1bGxldEZsYWc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEJ1bGxldCA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX2J1bGxldEZsYWcgPSAhIWZsYWc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzU2xlZXBpbmdBbGxvd2VkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYXV0b1NsZWVwRmxhZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0U2xlZXBpbmdBbGxvd2VkID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICB0aGlzLm1fYXV0b1NsZWVwRmxhZyA9ICEhZmxhZztcbiAgICAgICAgaWYgKHRoaXMubV9hdXRvU2xlZXBGbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc0F3YWtlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYXdha2VGbGFnO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRBd2FrZSA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcpIHtcbiAgICAgICAgICB0aGlzLm1fYXdha2VGbGFnID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLm1fc2xlZXBUaW1lID0gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fYXdha2VGbGFnID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5tX3NsZWVwVGltZSA9IDA7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gMDtcbiAgICAgICAgICB0aGlzLm1fZm9yY2Uuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV90b3JxdWUgPSAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzQWN0aXZlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYWN0aXZlRmxhZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0QWN0aXZlID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAoZmxhZyA9PSB0aGlzLm1fYWN0aXZlRmxhZykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYWN0aXZlRmxhZyA9ICEhZmxhZztcbiAgICAgICAgaWYgKHRoaXMubV9hY3RpdmVGbGFnKSB7XG4gICAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICAgIGZvciAodmFyIGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgICAgZi5jcmVhdGVQcm94aWVzKGJyb2FkUGhhc2UsIHRoaXMubV94Zik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMubV93b3JsZC5tX25ld0ZpeHR1cmUgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgICBmb3IgKHZhciBmID0gdGhpcy5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgICAgIGYuZGVzdHJveVByb3hpZXMoYnJvYWRQaGFzZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjZSA9IHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgICAgICB3aGlsZSAoY2UpIHtcbiAgICAgICAgICAgIHZhciBjZTAgPSBjZTtcbiAgICAgICAgICAgIGNlID0gY2UubmV4dDtcbiAgICAgICAgICAgIHRoaXMubV93b3JsZC5kZXN0cm95Q29udGFjdChjZTAuY29udGFjdCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNGaXhlZFJvdGF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZml4ZWRSb3RhdGlvbkZsYWc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEZpeGVkUm90YXRpb24gPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmICh0aGlzLm1fZml4ZWRSb3RhdGlvbkZsYWcgPT0gZmxhZykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fZml4ZWRSb3RhdGlvbkZsYWcgPSAhIWZsYWc7XG4gICAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgPSAwO1xuICAgICAgICB0aGlzLnJlc2V0TWFzc0RhdGEoKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0VHJhbnNmb3JtID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1feGY7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldFRyYW5zZm9ybSA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICBpZiAodGhpcy5pc1dvcmxkTG9ja2VkKCkgPT0gdHJ1ZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGIyID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgdGhpcy5tX3hmLnNldE51bShhMiwgYjIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV94Zi5zZXRUcmFuc2Zvcm0oYTIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9zd2VlcC5zZXRUcmFuc2Zvcm0odGhpcy5tX3hmKTtcbiAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICBmb3IgKHZhciBmID0gdGhpcy5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgICBmLnN5bmNocm9uaXplKGJyb2FkUGhhc2UsIHRoaXMubV94ZiwgdGhpcy5tX3hmKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zeW5jaHJvbml6ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fc3dlZXAuZ2V0VHJhbnNmb3JtKHRoaXMubV94ZiwgMSk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnN5bmNocm9uaXplRml4dHVyZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLmdldFRyYW5zZm9ybSh4ZiQyLCAwKTtcbiAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICBmb3IgKHZhciBmID0gdGhpcy5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgICBmLnN5bmNocm9uaXplKGJyb2FkUGhhc2UsIHhmJDIsIHRoaXMubV94Zik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuYWR2YW5jZSA9IGZ1bmN0aW9uKGFscGhhKSB7XG4gICAgICAgIHRoaXMubV9zd2VlcC5hZHZhbmNlKGFscGhhKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5tX3N3ZWVwLmMsIHRoaXMubV9zd2VlcC5jMCk7XG4gICAgICAgIHRoaXMubV9zd2VlcC5hID0gdGhpcy5tX3N3ZWVwLmEwO1xuICAgICAgICB0aGlzLm1fc3dlZXAuZ2V0VHJhbnNmb3JtKHRoaXMubV94ZiwgMSk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldFBvc2l0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1feGYucDtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0UG9zaXRpb24gPSBmdW5jdGlvbihwKSB7XG4gICAgICAgIHRoaXMuc2V0VHJhbnNmb3JtKHAsIHRoaXMubV9zd2VlcC5hKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0QW5nbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9zd2VlcC5hO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRBbmdsZSA9IGZ1bmN0aW9uKGFuZ2xlKSB7XG4gICAgICAgIHRoaXMuc2V0VHJhbnNmb3JtKHRoaXMubV94Zi5wLCBhbmdsZSk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldFdvcmxkQ2VudGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc3dlZXAuYztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TG9jYWxDZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TGluZWFyVmVsb2NpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TGluZWFyVmVsb2NpdHlGcm9tV29ybGRQb2ludCA9IGZ1bmN0aW9uKHdvcmxkUG9pbnQpIHtcbiAgICAgICAgdmFyIGxvY2FsQ2VudGVyMiA9IFZlYzIuc3ViKHdvcmxkUG9pbnQsIHRoaXMubV9zd2VlcC5jKTtcbiAgICAgICAgcmV0dXJuIFZlYzIuYWRkKHRoaXMubV9saW5lYXJWZWxvY2l0eSwgVmVjMi5jcm9zc051bVZlYzIodGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSwgbG9jYWxDZW50ZXIyKSk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExpbmVhclZlbG9jaXR5RnJvbUxvY2FsUG9pbnQgPSBmdW5jdGlvbihsb2NhbFBvaW50KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldExpbmVhclZlbG9jaXR5RnJvbVdvcmxkUG9pbnQodGhpcy5nZXRXb3JsZFBvaW50KGxvY2FsUG9pbnQpKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0TGluZWFyVmVsb2NpdHkgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICBpZiAodGhpcy5tX3R5cGUgPT0gU1RBVElDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChWZWMyLmRvdCh2MywgdjMpID4gMCkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnNldFZlYzIodjMpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRBbmd1bGFyVmVsb2NpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEFuZ3VsYXJWZWxvY2l0eSA9IGZ1bmN0aW9uKHcpIHtcbiAgICAgICAgaWYgKHRoaXMubV90eXBlID09IFNUQVRJQykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodyAqIHcgPiAwKSB7XG4gICAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gdztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TGluZWFyRGFtcGluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xpbmVhckRhbXBpbmc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldExpbmVhckRhbXBpbmcgPSBmdW5jdGlvbihsaW5lYXJEYW1waW5nKSB7XG4gICAgICAgIHRoaXMubV9saW5lYXJEYW1waW5nID0gbGluZWFyRGFtcGluZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0QW5ndWxhckRhbXBpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9hbmd1bGFyRGFtcGluZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0QW5ndWxhckRhbXBpbmcgPSBmdW5jdGlvbihhbmd1bGFyRGFtcGluZykge1xuICAgICAgICB0aGlzLm1fYW5ndWxhckRhbXBpbmcgPSBhbmd1bGFyRGFtcGluZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0R3Jhdml0eVNjYWxlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZ3Jhdml0eVNjYWxlO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRHcmF2aXR5U2NhbGUgPSBmdW5jdGlvbihzY2FsZSkge1xuICAgICAgICB0aGlzLm1fZ3Jhdml0eVNjYWxlID0gc2NhbGU7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldE1hc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXNzO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRJbmVydGlhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fSSArIHRoaXMubV9tYXNzICogVmVjMi5kb3QodGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyLCB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRNYXNzRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgZGF0YS5tYXNzID0gdGhpcy5tX21hc3M7XG4gICAgICAgIGRhdGEuSSA9IHRoaXMuZ2V0SW5lcnRpYSgpO1xuICAgICAgICBjb3B5VmVjMihkYXRhLmNlbnRlciwgdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUucmVzZXRNYXNzRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fbWFzcyA9IDA7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzID0gMDtcbiAgICAgICAgdGhpcy5tX0kgPSAwO1xuICAgICAgICB0aGlzLm1faW52SSA9IDA7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcik7XG4gICAgICAgIGlmICh0aGlzLmlzU3RhdGljKCkgfHwgdGhpcy5pc0tpbmVtYXRpYygpKSB7XG4gICAgICAgICAgY29weVZlYzIodGhpcy5tX3N3ZWVwLmMwLCB0aGlzLm1feGYucCk7XG4gICAgICAgICAgY29weVZlYzIodGhpcy5tX3N3ZWVwLmMsIHRoaXMubV94Zi5wKTtcbiAgICAgICAgICB0aGlzLm1fc3dlZXAuYTAgPSB0aGlzLm1fc3dlZXAuYTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgemVyb1ZlYzIobG9jYWxDZW50ZXIpO1xuICAgICAgICBmb3IgKHZhciBmID0gdGhpcy5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgICBpZiAoZi5tX2RlbnNpdHkgPT0gMCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBtYXNzRGF0YSA9IHtcbiAgICAgICAgICAgIG1hc3M6IDAsXG4gICAgICAgICAgICBjZW50ZXI6IHZlYzIoMCwgMCksXG4gICAgICAgICAgICBJOiAwXG4gICAgICAgICAgfTtcbiAgICAgICAgICBmLmdldE1hc3NEYXRhKG1hc3NEYXRhKTtcbiAgICAgICAgICB0aGlzLm1fbWFzcyArPSBtYXNzRGF0YS5tYXNzO1xuICAgICAgICAgIHBsdXNTY2FsZVZlYzIobG9jYWxDZW50ZXIsIG1hc3NEYXRhLm1hc3MsIG1hc3NEYXRhLmNlbnRlcik7XG4gICAgICAgICAgdGhpcy5tX0kgKz0gbWFzc0RhdGEuSTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX21hc3MgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAxIC8gdGhpcy5tX21hc3M7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvY2FsQ2VudGVyLCB0aGlzLm1faW52TWFzcywgbG9jYWxDZW50ZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gMTtcbiAgICAgICAgICB0aGlzLm1faW52TWFzcyA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9JID4gMCAmJiB0aGlzLm1fZml4ZWRSb3RhdGlvbkZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLm1fSSAtPSB0aGlzLm1fbWFzcyAqIGRvdFZlYzIobG9jYWxDZW50ZXIsIGxvY2FsQ2VudGVyKTtcbiAgICAgICAgICB0aGlzLm1faW52SSA9IDEgLyB0aGlzLm1fSTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fSSA9IDA7XG4gICAgICAgICAgdGhpcy5tX2ludkkgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGNvcHlWZWMyKG9sZENlbnRlciwgdGhpcy5tX3N3ZWVwLmMpO1xuICAgICAgICB0aGlzLm1fc3dlZXAuc2V0TG9jYWxDZW50ZXIobG9jYWxDZW50ZXIsIHRoaXMubV94Zik7XG4gICAgICAgIHN1YlZlYzIoc2hpZnQsIHRoaXMubV9zd2VlcC5jLCBvbGRDZW50ZXIpO1xuICAgICAgICBjcm9zc051bVZlYzIodGVtcCQ2LCB0aGlzLm1fYW5ndWxhclZlbG9jaXR5LCBzaGlmdCk7XG4gICAgICAgIHBsdXNWZWMyKHRoaXMubV9saW5lYXJWZWxvY2l0eSwgdGVtcCQ2KTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0TWFzc0RhdGEgPSBmdW5jdGlvbihtYXNzRGF0YSkge1xuICAgICAgICBpZiAodGhpcy5pc1dvcmxkTG9ja2VkKCkgPT0gdHJ1ZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX3R5cGUgIT0gRFlOQU1JQykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1faW52TWFzcyA9IDA7XG4gICAgICAgIHRoaXMubV9JID0gMDtcbiAgICAgICAgdGhpcy5tX2ludkkgPSAwO1xuICAgICAgICB0aGlzLm1fbWFzcyA9IG1hc3NEYXRhLm1hc3M7XG4gICAgICAgIGlmICh0aGlzLm1fbWFzcyA8PSAwKSB7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9pbnZNYXNzID0gMSAvIHRoaXMubV9tYXNzO1xuICAgICAgICBpZiAobWFzc0RhdGEuSSA+IDAgJiYgdGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5tX0kgPSBtYXNzRGF0YS5JIC0gdGhpcy5tX21hc3MgKiBkb3RWZWMyKG1hc3NEYXRhLmNlbnRlciwgbWFzc0RhdGEuY2VudGVyKTtcbiAgICAgICAgICB0aGlzLm1faW52SSA9IDEgLyB0aGlzLm1fSTtcbiAgICAgICAgfVxuICAgICAgICBjb3B5VmVjMihvbGRDZW50ZXIsIHRoaXMubV9zd2VlcC5jKTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLnNldExvY2FsQ2VudGVyKG1hc3NEYXRhLmNlbnRlciwgdGhpcy5tX3hmKTtcbiAgICAgICAgc3ViVmVjMihzaGlmdCwgdGhpcy5tX3N3ZWVwLmMsIG9sZENlbnRlcik7XG4gICAgICAgIGNyb3NzTnVtVmVjMih0ZW1wJDYsIHRoaXMubV9hbmd1bGFyVmVsb2NpdHksIHNoaWZ0KTtcbiAgICAgICAgcGx1c1ZlYzIodGhpcy5tX2xpbmVhclZlbG9jaXR5LCB0ZW1wJDYpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5hcHBseUZvcmNlID0gZnVuY3Rpb24oZm9yY2UsIHBvaW50Miwgd2FrZSkge1xuICAgICAgICBpZiAod2FrZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgd2FrZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdha2UgJiYgdGhpcy5tX2F3YWtlRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9hd2FrZUZsYWcpIHtcbiAgICAgICAgICB0aGlzLm1fZm9yY2UuYWRkKGZvcmNlKTtcbiAgICAgICAgICB0aGlzLm1fdG9ycXVlICs9IFZlYzIuY3Jvc3NWZWMyVmVjMihWZWMyLnN1Yihwb2ludDIsIHRoaXMubV9zd2VlcC5jKSwgZm9yY2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmFwcGx5Rm9yY2VUb0NlbnRlciA9IGZ1bmN0aW9uKGZvcmNlLCB3YWtlKSB7XG4gICAgICAgIGlmICh3YWtlID09PSB2b2lkIDApIHtcbiAgICAgICAgICB3YWtlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX3R5cGUgIT0gRFlOQU1JQykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAod2FrZSAmJiB0aGlzLm1fYXdha2VGbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2F3YWtlRmxhZykge1xuICAgICAgICAgIHRoaXMubV9mb3JjZS5hZGQoZm9yY2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmFwcGx5VG9ycXVlID0gZnVuY3Rpb24odG9ycXVlLCB3YWtlKSB7XG4gICAgICAgIGlmICh3YWtlID09PSB2b2lkIDApIHtcbiAgICAgICAgICB3YWtlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX3R5cGUgIT0gRFlOQU1JQykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAod2FrZSAmJiB0aGlzLm1fYXdha2VGbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2F3YWtlRmxhZykge1xuICAgICAgICAgIHRoaXMubV90b3JxdWUgKz0gdG9ycXVlO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmFwcGx5TGluZWFySW1wdWxzZSA9IGZ1bmN0aW9uKGltcHVsc2UsIHBvaW50Miwgd2FrZSkge1xuICAgICAgICBpZiAod2FrZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgd2FrZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdha2UgJiYgdGhpcy5tX2F3YWtlRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9hd2FrZUZsYWcpIHtcbiAgICAgICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkuYWRkTXVsKHRoaXMubV9pbnZNYXNzLCBpbXB1bHNlKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICs9IHRoaXMubV9pbnZJICogVmVjMi5jcm9zc1ZlYzJWZWMyKFZlYzIuc3ViKHBvaW50MiwgdGhpcy5tX3N3ZWVwLmMpLCBpbXB1bHNlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5hcHBseUFuZ3VsYXJJbXB1bHNlID0gZnVuY3Rpb24oaW1wdWxzZSwgd2FrZSkge1xuICAgICAgICBpZiAod2FrZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgd2FrZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdha2UgJiYgdGhpcy5tX2F3YWtlRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9hd2FrZUZsYWcpIHtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICs9IHRoaXMubV9pbnZJICogaW1wdWxzZTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zaG91bGRDb2xsaWRlID0gZnVuY3Rpb24odGhhdCkge1xuICAgICAgICBpZiAodGhpcy5tX3R5cGUgIT0gRFlOQU1JQyAmJiB0aGF0Lm1fdHlwZSAhPSBEWU5BTUlDKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGpuID0gdGhpcy5tX2pvaW50TGlzdDsgam47IGpuID0gam4ubmV4dCkge1xuICAgICAgICAgIGlmIChqbi5vdGhlciA9PSB0aGF0KSB7XG4gICAgICAgICAgICBpZiAoam4uam9pbnQubV9jb2xsaWRlQ29ubmVjdGVkID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLl9hZGRGaXh0dXJlID0gZnVuY3Rpb24oZml4dHVyZSkge1xuICAgICAgICBpZiAodGhpcy5pc1dvcmxkTG9ja2VkKCkgPT0gdHJ1ZSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYWN0aXZlRmxhZykge1xuICAgICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgICBmaXh0dXJlLmNyZWF0ZVByb3hpZXMoYnJvYWRQaGFzZSwgdGhpcy5tX3hmKTtcbiAgICAgICAgfVxuICAgICAgICBmaXh0dXJlLm1fbmV4dCA9IHRoaXMubV9maXh0dXJlTGlzdDtcbiAgICAgICAgdGhpcy5tX2ZpeHR1cmVMaXN0ID0gZml4dHVyZTtcbiAgICAgICAgaWYgKGZpeHR1cmUubV9kZW5zaXR5ID4gMCkge1xuICAgICAgICAgIHRoaXMucmVzZXRNYXNzRGF0YSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV93b3JsZC5tX25ld0ZpeHR1cmUgPSB0cnVlO1xuICAgICAgICByZXR1cm4gZml4dHVyZTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuY3JlYXRlRml4dHVyZSA9IGZ1bmN0aW9uKHNoYXBlLCBmaXhkZWYpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNXb3JsZExvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZml4dHVyZSA9IG5ldyBGaXh0dXJlKHRoaXMsIHNoYXBlLCBmaXhkZWYpO1xuICAgICAgICB0aGlzLl9hZGRGaXh0dXJlKGZpeHR1cmUpO1xuICAgICAgICByZXR1cm4gZml4dHVyZTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZGVzdHJveUZpeHR1cmUgPSBmdW5jdGlvbihmaXh0dXJlKSB7XG4gICAgICAgIGlmICh0aGlzLmlzV29ybGRMb2NrZWQoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZml4dHVyZUxpc3QgPT09IGZpeHR1cmUpIHtcbiAgICAgICAgICB0aGlzLm1fZml4dHVyZUxpc3QgPSBmaXh0dXJlLm1fbmV4dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgbm9kZSA9IHRoaXMubV9maXh0dXJlTGlzdDtcbiAgICAgICAgICB3aGlsZSAobm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5tX25leHQgPT09IGZpeHR1cmUpIHtcbiAgICAgICAgICAgICAgbm9kZS5tX25leHQgPSBmaXh0dXJlLm1fbmV4dDtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub2RlID0gbm9kZS5tX25leHQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBlZGdlID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgICAgICB3aGlsZSAoZWRnZSkge1xuICAgICAgICAgIHZhciBjMiA9IGVkZ2UuY29udGFjdDtcbiAgICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xuICAgICAgICAgIHZhciBmaXh0dXJlQSA9IGMyLmdldEZpeHR1cmVBKCk7XG4gICAgICAgICAgdmFyIGZpeHR1cmVCID0gYzIuZ2V0Rml4dHVyZUIoKTtcbiAgICAgICAgICBpZiAoZml4dHVyZSA9PSBmaXh0dXJlQSB8fCBmaXh0dXJlID09IGZpeHR1cmVCKSB7XG4gICAgICAgICAgICB0aGlzLm1fd29ybGQuZGVzdHJveUNvbnRhY3QoYzIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2FjdGl2ZUZsYWcpIHtcbiAgICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgICAgZml4dHVyZS5kZXN0cm95UHJveGllcyhicm9hZFBoYXNlKTtcbiAgICAgICAgfVxuICAgICAgICBmaXh0dXJlLm1fYm9keSA9IG51bGw7XG4gICAgICAgIGZpeHR1cmUubV9uZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3dvcmxkLnB1Ymxpc2goXCJyZW1vdmUtZml4dHVyZVwiLCBmaXh0dXJlKTtcbiAgICAgICAgdGhpcy5yZXNldE1hc3NEYXRhKCk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldFdvcmxkUG9pbnQgPSBmdW5jdGlvbihsb2NhbFBvaW50KSB7XG4gICAgICAgIHJldHVybiBUcmFuc2Zvcm0ubXVsVmVjMih0aGlzLm1feGYsIGxvY2FsUG9pbnQpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRXb3JsZFZlY3RvciA9IGZ1bmN0aW9uKGxvY2FsVmVjdG9yKSB7XG4gICAgICAgIHJldHVybiBSb3QubXVsVmVjMih0aGlzLm1feGYucSwgbG9jYWxWZWN0b3IpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRMb2NhbFBvaW50ID0gZnVuY3Rpb24od29ybGRQb2ludCkge1xuICAgICAgICByZXR1cm4gVHJhbnNmb3JtLm11bFRWZWMyKHRoaXMubV94Ziwgd29ybGRQb2ludCk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExvY2FsVmVjdG9yID0gZnVuY3Rpb24od29ybGRWZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIFJvdC5tdWxUVmVjMih0aGlzLm1feGYucSwgd29ybGRWZWN0b3IpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLlNUQVRJQyA9IFwic3RhdGljXCI7XG4gICAgICBCb2R5Mi5LSU5FTUFUSUMgPSBcImtpbmVtYXRpY1wiO1xuICAgICAgQm9keTIuRFlOQU1JQyA9IFwiZHluYW1pY1wiO1xuICAgICAgcmV0dXJuIEJvZHkyO1xuICAgIH0oKVxuICApO1xuICB2YXIgSm9pbnRFZGdlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICAvKiBAX19QVVJFX18gKi8gZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBKb2ludEVkZ2UyKCkge1xuICAgICAgICB0aGlzLm90aGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5qb2ludCA9IG51bGw7XG4gICAgICAgIHRoaXMucHJldiA9IG51bGw7XG4gICAgICAgIHRoaXMubmV4dCA9IG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gSm9pbnRFZGdlMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIEpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEpvaW50MihkZWYsIGJvZHlBLCBib2R5Qikge1xuICAgICAgICB0aGlzLm1fdHlwZSA9IFwidW5rbm93bi1qb2ludFwiO1xuICAgICAgICB0aGlzLm1fcHJldiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2VkZ2VBID0gbmV3IEpvaW50RWRnZSgpO1xuICAgICAgICB0aGlzLm1fZWRnZUIgPSBuZXcgSm9pbnRFZGdlKCk7XG4gICAgICAgIHRoaXMubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3R5bGUgPSB7fTtcbiAgICAgICAgdGhpcy5hcHBEYXRhID0ge307XG4gICAgICAgIGJvZHlBID0gXCJib2R5QVwiIGluIGRlZiA/IGRlZi5ib2R5QSA6IGJvZHlBO1xuICAgICAgICBib2R5QiA9IFwiYm9keUJcIiBpbiBkZWYgPyBkZWYuYm9keUIgOiBib2R5QjtcbiAgICAgICAgdGhpcy5tX2JvZHlBID0gYm9keUE7XG4gICAgICAgIHRoaXMubV9ib2R5QiA9IGJvZHlCO1xuICAgICAgICB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCA9ICEhZGVmLmNvbGxpZGVDb25uZWN0ZWQ7XG4gICAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRlZi51c2VyRGF0YTtcbiAgICAgICAgaWYgKHR5cGVvZiBkZWYuc3R5bGUgPT09IFwib2JqZWN0XCIgJiYgZGVmLnN0eWxlICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5zdHlsZSA9IGRlZi5zdHlsZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgSm9pbnQyLnByb3RvdHlwZS5pc0FjdGl2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmlzQWN0aXZlKCkgJiYgdGhpcy5tX2JvZHlCLmlzQWN0aXZlKCk7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLmdldEJvZHlBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUE7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5nZXRCb2R5QiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCO1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuZ2V0TmV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX25leHQ7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5nZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3VzZXJEYXRhO1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuc2V0VXNlckRhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRhdGE7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5nZXRDb2xsaWRlQ29ubmVjdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZDtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLnNoaWZ0T3JpZ2luID0gZnVuY3Rpb24obmV3T3JpZ2luKSB7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5fcmVzZXRBbmNob3JzID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXNldChkZWYpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBKb2ludDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBzdGF0cyA9IHtcbiAgICBnamtDYWxsczogMCxcbiAgICBnamtJdGVyczogMCxcbiAgICBnamtNYXhJdGVyczogMCxcbiAgICB0b2lUaW1lOiAwLFxuICAgIHRvaU1heFRpbWU6IDAsXG4gICAgdG9pQ2FsbHM6IDAsXG4gICAgdG9pSXRlcnM6IDAsXG4gICAgdG9pTWF4SXRlcnM6IDAsXG4gICAgdG9pUm9vdEl0ZXJzOiAwLFxuICAgIHRvaU1heFJvb3RJdGVyczogMCxcbiAgICB0b1N0cmluZzogZnVuY3Rpb24obmV3bGluZSkge1xuICAgICAgbmV3bGluZSA9IHR5cGVvZiBuZXdsaW5lID09PSBcInN0cmluZ1wiID8gbmV3bGluZSA6IFwiXFxuXCI7XG4gICAgICB2YXIgc3RyaW5nID0gXCJcIjtcbiAgICAgIGZvciAodmFyIG5hbWVfMSBpbiB0aGlzKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpc1tuYW1lXzFdICE9PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIHRoaXNbbmFtZV8xXSAhPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHN0cmluZyArPSBuYW1lXzEgKyBcIjogXCIgKyB0aGlzW25hbWVfMV0gKyBuZXdsaW5lO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH1cbiAgfTtcbiAgdmFyIG5vdyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBEYXRlLm5vdygpO1xuICB9O1xuICB2YXIgZGlmZiA9IGZ1bmN0aW9uKHRpbWUpIHtcbiAgICByZXR1cm4gRGF0ZS5ub3coKSAtIHRpbWU7XG4gIH07XG4gIGNvbnN0IFRpbWVyID0ge1xuICAgIG5vdyxcbiAgICBkaWZmXG4gIH07XG4gIHZhciBtYXRoX21heCQ0ID0gTWF0aC5tYXg7XG4gIHZhciB0ZW1wJDUgPSB2ZWMyKDAsIDApO1xuICB2YXIgbm9ybWFsJDQgPSB2ZWMyKDAsIDApO1xuICB2YXIgZTEyID0gdmVjMigwLCAwKTtcbiAgdmFyIGUxMyA9IHZlYzIoMCwgMCk7XG4gIHZhciBlMjMgPSB2ZWMyKDAsIDApO1xuICB2YXIgdGVtcDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgdGVtcDIgPSB2ZWMyKDAsIDApO1xuICBzdGF0cy5namtDYWxscyA9IDA7XG4gIHN0YXRzLmdqa0l0ZXJzID0gMDtcbiAgc3RhdHMuZ2prTWF4SXRlcnMgPSAwO1xuICB2YXIgRGlzdGFuY2VJbnB1dCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBEaXN0YW5jZUlucHV0MigpIHtcbiAgICAgICAgdGhpcy5wcm94eUEgPSBuZXcgRGlzdGFuY2VQcm94eSgpO1xuICAgICAgICB0aGlzLnByb3h5QiA9IG5ldyBEaXN0YW5jZVByb3h5KCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtQSA9IFRyYW5zZm9ybS5pZGVudGl0eSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUIgPSBUcmFuc2Zvcm0uaWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy51c2VSYWRpaSA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgRGlzdGFuY2VJbnB1dDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5wcm94eUEucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnByb3h5Qi5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtQS5zZXRJZGVudGl0eSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUIuc2V0SWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy51c2VSYWRpaSA9IGZhbHNlO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBEaXN0YW5jZUlucHV0MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIERpc3RhbmNlT3V0cHV0ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIERpc3RhbmNlT3V0cHV0MigpIHtcbiAgICAgICAgdGhpcy5wb2ludEEgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnBvaW50QiA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMuZGlzdGFuY2UgPSAwO1xuICAgICAgICB0aGlzLml0ZXJhdGlvbnMgPSAwO1xuICAgICAgfVxuICAgICAgRGlzdGFuY2VPdXRwdXQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHplcm9WZWMyKHRoaXMucG9pbnRBKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5wb2ludEIpO1xuICAgICAgICB0aGlzLmRpc3RhbmNlID0gMDtcbiAgICAgICAgdGhpcy5pdGVyYXRpb25zID0gMDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gRGlzdGFuY2VPdXRwdXQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgU2ltcGxleENhY2hlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNpbXBsZXhDYWNoZTIoKSB7XG4gICAgICAgIHRoaXMubWV0cmljID0gMDtcbiAgICAgICAgdGhpcy5pbmRleEEgPSBbXTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSBbXTtcbiAgICAgICAgdGhpcy5jb3VudCA9IDA7XG4gICAgICB9XG4gICAgICBTaW1wbGV4Q2FjaGUyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubWV0cmljID0gMDtcbiAgICAgICAgdGhpcy5pbmRleEEubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5pbmRleEIubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5jb3VudCA9IDA7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFNpbXBsZXhDYWNoZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBEaXN0YW5jZSA9IGZ1bmN0aW9uKG91dHB1dDIsIGNhY2hlMiwgaW5wdXQyKSB7XG4gICAgKytzdGF0cy5namtDYWxscztcbiAgICB2YXIgcHJveHlBID0gaW5wdXQyLnByb3h5QTtcbiAgICB2YXIgcHJveHlCID0gaW5wdXQyLnByb3h5QjtcbiAgICB2YXIgeGZBMiA9IGlucHV0Mi50cmFuc2Zvcm1BO1xuICAgIHZhciB4ZkIyID0gaW5wdXQyLnRyYW5zZm9ybUI7XG4gICAgc2ltcGxleC5yZWN5Y2xlKCk7XG4gICAgc2ltcGxleC5yZWFkQ2FjaGUoY2FjaGUyLCBwcm94eUEsIHhmQTIsIHByb3h5QiwgeGZCMik7XG4gICAgdmFyIHZlcnRpY2VzID0gc2ltcGxleC5tX3Y7XG4gICAgdmFyIGtfbWF4SXRlcnMgPSBTZXR0aW5nc0ludGVybmFsLm1heERpc3RhbmNlSXRlcmF0aW9ucztcbiAgICB2YXIgc2F2ZUEgPSBbXTtcbiAgICB2YXIgc2F2ZUIgPSBbXTtcbiAgICB2YXIgc2F2ZUNvdW50ID0gMDtcbiAgICB2YXIgaXRlciA9IDA7XG4gICAgd2hpbGUgKGl0ZXIgPCBrX21heEl0ZXJzKSB7XG4gICAgICBzYXZlQ291bnQgPSBzaW1wbGV4Lm1fY291bnQ7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNhdmVDb3VudDsgKytpKSB7XG4gICAgICAgIHNhdmVBW2ldID0gdmVydGljZXNbaV0uaW5kZXhBO1xuICAgICAgICBzYXZlQltpXSA9IHZlcnRpY2VzW2ldLmluZGV4QjtcbiAgICAgIH1cbiAgICAgIHNpbXBsZXguc29sdmUoKTtcbiAgICAgIGlmIChzaW1wbGV4Lm1fY291bnQgPT09IDMpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICB2YXIgZDIgPSBzaW1wbGV4LmdldFNlYXJjaERpcmVjdGlvbigpO1xuICAgICAgaWYgKGxlbmd0aFNxclZlYzIoZDIpIDwgRVBTSUxPTiAqIEVQU0lMT04pIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICB2YXIgdmVydGV4ID0gdmVydGljZXNbc2ltcGxleC5tX2NvdW50XTtcbiAgICAgIHZlcnRleC5pbmRleEEgPSBwcm94eUEuZ2V0U3VwcG9ydChkZXJvdFZlYzIodGVtcCQ1LCB4ZkEyLnEsIHNjYWxlVmVjMih0ZW1wJDUsIC0xLCBkMikpKTtcbiAgICAgIHRyYW5zZm9ybVZlYzIodmVydGV4LndBLCB4ZkEyLCBwcm94eUEuZ2V0VmVydGV4KHZlcnRleC5pbmRleEEpKTtcbiAgICAgIHZlcnRleC5pbmRleEIgPSBwcm94eUIuZ2V0U3VwcG9ydChkZXJvdFZlYzIodGVtcCQ1LCB4ZkIyLnEsIGQyKSk7XG4gICAgICB0cmFuc2Zvcm1WZWMyKHZlcnRleC53QiwgeGZCMiwgcHJveHlCLmdldFZlcnRleCh2ZXJ0ZXguaW5kZXhCKSk7XG4gICAgICBzdWJWZWMyKHZlcnRleC53LCB2ZXJ0ZXgud0IsIHZlcnRleC53QSk7XG4gICAgICArK2l0ZXI7XG4gICAgICArK3N0YXRzLmdqa0l0ZXJzO1xuICAgICAgdmFyIGR1cGxpY2F0ZSA9IGZhbHNlO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzYXZlQ291bnQ7ICsraSkge1xuICAgICAgICBpZiAodmVydGV4LmluZGV4QSA9PT0gc2F2ZUFbaV0gJiYgdmVydGV4LmluZGV4QiA9PT0gc2F2ZUJbaV0pIHtcbiAgICAgICAgICBkdXBsaWNhdGUgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZHVwbGljYXRlKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgKytzaW1wbGV4Lm1fY291bnQ7XG4gICAgfVxuICAgIHN0YXRzLmdqa01heEl0ZXJzID0gbWF0aF9tYXgkNChzdGF0cy5namtNYXhJdGVycywgaXRlcik7XG4gICAgc2ltcGxleC5nZXRXaXRuZXNzUG9pbnRzKG91dHB1dDIucG9pbnRBLCBvdXRwdXQyLnBvaW50Qik7XG4gICAgb3V0cHV0Mi5kaXN0YW5jZSA9IGRpc3RWZWMyKG91dHB1dDIucG9pbnRBLCBvdXRwdXQyLnBvaW50Qik7XG4gICAgb3V0cHV0Mi5pdGVyYXRpb25zID0gaXRlcjtcbiAgICBzaW1wbGV4LndyaXRlQ2FjaGUoY2FjaGUyKTtcbiAgICBpZiAoaW5wdXQyLnVzZVJhZGlpKSB7XG4gICAgICB2YXIgckEyID0gcHJveHlBLm1fcmFkaXVzO1xuICAgICAgdmFyIHJCMiA9IHByb3h5Qi5tX3JhZGl1cztcbiAgICAgIGlmIChvdXRwdXQyLmRpc3RhbmNlID4gckEyICsgckIyICYmIG91dHB1dDIuZGlzdGFuY2UgPiBFUFNJTE9OKSB7XG4gICAgICAgIG91dHB1dDIuZGlzdGFuY2UgLT0gckEyICsgckIyO1xuICAgICAgICBzdWJWZWMyKG5vcm1hbCQ0LCBvdXRwdXQyLnBvaW50Qiwgb3V0cHV0Mi5wb2ludEEpO1xuICAgICAgICBub3JtYWxpemVWZWMyKG5vcm1hbCQ0KTtcbiAgICAgICAgcGx1c1NjYWxlVmVjMihvdXRwdXQyLnBvaW50QSwgckEyLCBub3JtYWwkNCk7XG4gICAgICAgIG1pbnVzU2NhbGVWZWMyKG91dHB1dDIucG9pbnRCLCByQjIsIG5vcm1hbCQ0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBwID0gc3ViVmVjMih0ZW1wJDUsIG91dHB1dDIucG9pbnRBLCBvdXRwdXQyLnBvaW50Qik7XG4gICAgICAgIGNvcHlWZWMyKG91dHB1dDIucG9pbnRBLCBwKTtcbiAgICAgICAgY29weVZlYzIob3V0cHV0Mi5wb2ludEIsIHApO1xuICAgICAgICBvdXRwdXQyLmRpc3RhbmNlID0gMDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIHZhciBEaXN0YW5jZVByb3h5ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIERpc3RhbmNlUHJveHkyKCkge1xuICAgICAgICB0aGlzLm1fdmVydGljZXMgPSBbXTtcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gMDtcbiAgICAgICAgdGhpcy5tX3JhZGl1cyA9IDA7XG4gICAgICB9XG4gICAgICBEaXN0YW5jZVByb3h5Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fdmVydGljZXMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gMDtcbiAgICAgICAgdGhpcy5tX3JhZGl1cyA9IDA7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VQcm94eTIucHJvdG90eXBlLmdldFZlcnRleENvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY291bnQ7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VQcm94eTIucHJvdG90eXBlLmdldFZlcnRleCA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdmVydGljZXNbaW5kZXhdO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5nZXRTdXBwb3J0ID0gZnVuY3Rpb24oZDIpIHtcbiAgICAgICAgdmFyIGJlc3RJbmRleCA9IC0xO1xuICAgICAgICB2YXIgYmVzdFZhbHVlID0gLUluZmluaXR5O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIHZhbHVlID0gZG90VmVjMih0aGlzLm1fdmVydGljZXNbaV0sIGQyKTtcbiAgICAgICAgICBpZiAodmFsdWUgPiBiZXN0VmFsdWUpIHtcbiAgICAgICAgICAgIGJlc3RJbmRleCA9IGk7XG4gICAgICAgICAgICBiZXN0VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJlc3RJbmRleDtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZVByb3h5Mi5wcm90b3R5cGUuZ2V0U3VwcG9ydFZlcnRleCA9IGZ1bmN0aW9uKGQyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdmVydGljZXNbdGhpcy5nZXRTdXBwb3J0KGQyKV07XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VQcm94eTIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHNoYXBlLCBpbmRleCkge1xuICAgICAgICBzaGFwZS5jb21wdXRlRGlzdGFuY2VQcm94eSh0aGlzLCBpbmRleCk7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VQcm94eTIucHJvdG90eXBlLnNldFZlcnRpY2VzID0gZnVuY3Rpb24odmVydGljZXMsIGNvdW50LCByYWRpdXMpIHtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gdmVydGljZXM7XG4gICAgICAgIHRoaXMubV9jb3VudCA9IGNvdW50O1xuICAgICAgICB0aGlzLm1fcmFkaXVzID0gcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBEaXN0YW5jZVByb3h5MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFNpbXBsZXhWZXJ0ZXggPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2ltcGxleFZlcnRleDIoKSB7XG4gICAgICAgIHRoaXMud0EgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLmluZGV4QSA9IDA7XG4gICAgICAgIHRoaXMud0IgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLmluZGV4QiA9IDA7XG4gICAgICAgIHRoaXMudyA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMuYSA9IDA7XG4gICAgICB9XG4gICAgICBTaW1wbGV4VmVydGV4Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmluZGV4QSA9IDA7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gMDtcbiAgICAgICAgemVyb1ZlYzIodGhpcy53QSk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMud0IpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLncpO1xuICAgICAgICB0aGlzLmEgPSAwO1xuICAgICAgfTtcbiAgICAgIFNpbXBsZXhWZXJ0ZXgyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICB0aGlzLmluZGV4QSA9IHYzLmluZGV4QTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSB2My5pbmRleEI7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMud0EsIHYzLndBKTtcbiAgICAgICAgY29weVZlYzIodGhpcy53QiwgdjMud0IpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLncsIHYzLncpO1xuICAgICAgICB0aGlzLmEgPSB2My5hO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTaW1wbGV4VmVydGV4MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIHNlYXJjaERpcmVjdGlvbl9yZXVzZSA9IHZlYzIoMCwgMCk7XG4gIHZhciBjbG9zZXN0UG9pbnRfcmV1c2UgPSB2ZWMyKDAsIDApO1xuICB2YXIgU2ltcGxleCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTaW1wbGV4MigpIHtcbiAgICAgICAgdGhpcy5tX3YxID0gbmV3IFNpbXBsZXhWZXJ0ZXgoKTtcbiAgICAgICAgdGhpcy5tX3YyID0gbmV3IFNpbXBsZXhWZXJ0ZXgoKTtcbiAgICAgICAgdGhpcy5tX3YzID0gbmV3IFNpbXBsZXhWZXJ0ZXgoKTtcbiAgICAgICAgdGhpcy5tX3YgPSBbdGhpcy5tX3YxLCB0aGlzLm1fdjIsIHRoaXMubV92M107XG4gICAgICB9XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fdjEucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLm1fdjIucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLm1fdjMucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLm1fY291bnQgPSAwO1xuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5tX2NvdW50ID09PSAzKSB7XG4gICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFwiK1wiICsgdGhpcy5tX2NvdW50LFxuICAgICAgICAgICAgdGhpcy5tX3YxLmEsXG4gICAgICAgICAgICB0aGlzLm1fdjEud0EueCxcbiAgICAgICAgICAgIHRoaXMubV92MS53QS55LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndCLngsXG4gICAgICAgICAgICB0aGlzLm1fdjEud0IueSxcbiAgICAgICAgICAgIHRoaXMubV92Mi5hLFxuICAgICAgICAgICAgdGhpcy5tX3YyLndBLngsXG4gICAgICAgICAgICB0aGlzLm1fdjIud0EueSxcbiAgICAgICAgICAgIHRoaXMubV92Mi53Qi54LFxuICAgICAgICAgICAgdGhpcy5tX3YyLndCLnksXG4gICAgICAgICAgICB0aGlzLm1fdjMuYSxcbiAgICAgICAgICAgIHRoaXMubV92My53QS54LFxuICAgICAgICAgICAgdGhpcy5tX3YzLndBLnksXG4gICAgICAgICAgICB0aGlzLm1fdjMud0IueCxcbiAgICAgICAgICAgIHRoaXMubV92My53Qi55XG4gICAgICAgICAgXS50b1N0cmluZygpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubV9jb3VudCA9PT0gMikge1xuICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBcIitcIiArIHRoaXMubV9jb3VudCxcbiAgICAgICAgICAgIHRoaXMubV92MS5hLFxuICAgICAgICAgICAgdGhpcy5tX3YxLndBLngsXG4gICAgICAgICAgICB0aGlzLm1fdjEud0EueSxcbiAgICAgICAgICAgIHRoaXMubV92MS53Qi54LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndCLnksXG4gICAgICAgICAgICB0aGlzLm1fdjIuYSxcbiAgICAgICAgICAgIHRoaXMubV92Mi53QS54LFxuICAgICAgICAgICAgdGhpcy5tX3YyLndBLnksXG4gICAgICAgICAgICB0aGlzLm1fdjIud0IueCxcbiAgICAgICAgICAgIHRoaXMubV92Mi53Qi55XG4gICAgICAgICAgXS50b1N0cmluZygpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubV9jb3VudCA9PT0gMSkge1xuICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBcIitcIiArIHRoaXMubV9jb3VudCxcbiAgICAgICAgICAgIHRoaXMubV92MS5hLFxuICAgICAgICAgICAgdGhpcy5tX3YxLndBLngsXG4gICAgICAgICAgICB0aGlzLm1fdjEud0EueSxcbiAgICAgICAgICAgIHRoaXMubV92MS53Qi54LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndCLnlcbiAgICAgICAgICBdLnRvU3RyaW5nKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIFwiK1wiICsgdGhpcy5tX2NvdW50O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLnJlYWRDYWNoZSA9IGZ1bmN0aW9uKGNhY2hlMiwgcHJveHlBLCB0cmFuc2Zvcm1BLCBwcm94eUIsIHRyYW5zZm9ybUIpIHtcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gY2FjaGUyLmNvdW50O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIHYzID0gdGhpcy5tX3ZbaV07XG4gICAgICAgICAgdjMuaW5kZXhBID0gY2FjaGUyLmluZGV4QVtpXTtcbiAgICAgICAgICB2My5pbmRleEIgPSBjYWNoZTIuaW5kZXhCW2ldO1xuICAgICAgICAgIHZhciB3QUxvY2FsID0gcHJveHlBLmdldFZlcnRleCh2My5pbmRleEEpO1xuICAgICAgICAgIHZhciB3QkxvY2FsID0gcHJveHlCLmdldFZlcnRleCh2My5pbmRleEIpO1xuICAgICAgICAgIHRyYW5zZm9ybVZlYzIodjMud0EsIHRyYW5zZm9ybUEsIHdBTG9jYWwpO1xuICAgICAgICAgIHRyYW5zZm9ybVZlYzIodjMud0IsIHRyYW5zZm9ybUIsIHdCTG9jYWwpO1xuICAgICAgICAgIHN1YlZlYzIodjMudywgdjMud0IsIHYzLndBKTtcbiAgICAgICAgICB2My5hID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2NvdW50ID4gMSkge1xuICAgICAgICAgIHZhciBtZXRyaWMxID0gY2FjaGUyLm1ldHJpYztcbiAgICAgICAgICB2YXIgbWV0cmljMiA9IHRoaXMuZ2V0TWV0cmljKCk7XG4gICAgICAgICAgaWYgKG1ldHJpYzIgPCAwLjUgKiBtZXRyaWMxIHx8IDIgKiBtZXRyaWMxIDwgbWV0cmljMiB8fCBtZXRyaWMyIDwgRVBTSUxPTikge1xuICAgICAgICAgICAgdGhpcy5tX2NvdW50ID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9jb3VudCA9PT0gMCkge1xuICAgICAgICAgIHZhciB2MyA9IHRoaXMubV92WzBdO1xuICAgICAgICAgIHYzLmluZGV4QSA9IDA7XG4gICAgICAgICAgdjMuaW5kZXhCID0gMDtcbiAgICAgICAgICB2YXIgd0FMb2NhbCA9IHByb3h5QS5nZXRWZXJ0ZXgoMCk7XG4gICAgICAgICAgdmFyIHdCTG9jYWwgPSBwcm94eUIuZ2V0VmVydGV4KDApO1xuICAgICAgICAgIHRyYW5zZm9ybVZlYzIodjMud0EsIHRyYW5zZm9ybUEsIHdBTG9jYWwpO1xuICAgICAgICAgIHRyYW5zZm9ybVZlYzIodjMud0IsIHRyYW5zZm9ybUIsIHdCTG9jYWwpO1xuICAgICAgICAgIHN1YlZlYzIodjMudywgdjMud0IsIHYzLndBKTtcbiAgICAgICAgICB2My5hID0gMTtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLndyaXRlQ2FjaGUgPSBmdW5jdGlvbihjYWNoZTIpIHtcbiAgICAgICAgY2FjaGUyLm1ldHJpYyA9IHRoaXMuZ2V0TWV0cmljKCk7XG4gICAgICAgIGNhY2hlMi5jb3VudCA9IHRoaXMubV9jb3VudDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIGNhY2hlMi5pbmRleEFbaV0gPSB0aGlzLm1fdltpXS5pbmRleEE7XG4gICAgICAgICAgY2FjaGUyLmluZGV4QltpXSA9IHRoaXMubV92W2ldLmluZGV4QjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5nZXRTZWFyY2hEaXJlY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHYxMyA9IHRoaXMubV92MTtcbiAgICAgICAgdmFyIHYyMiA9IHRoaXMubV92MjtcbiAgICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gc2V0VmVjMihzZWFyY2hEaXJlY3Rpb25fcmV1c2UsIC12MTMudy54LCAtdjEzLncueSk7XG4gICAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgICBzdWJWZWMyKGUxMiwgdjIyLncsIHYxMy53KTtcbiAgICAgICAgICAgIHZhciBzZ24gPSAtY3Jvc3NWZWMyVmVjMihlMTIsIHYxMy53KTtcbiAgICAgICAgICAgIGlmIChzZ24gPiAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBzZXRWZWMyKHNlYXJjaERpcmVjdGlvbl9yZXVzZSwgLWUxMi55LCBlMTIueCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gc2V0VmVjMihzZWFyY2hEaXJlY3Rpb25fcmV1c2UsIGUxMi55LCAtZTEyLngpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHplcm9WZWMyKHNlYXJjaERpcmVjdGlvbl9yZXVzZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUuZ2V0Q2xvc2VzdFBvaW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2MTMgPSB0aGlzLm1fdjE7XG4gICAgICAgIHZhciB2MjIgPSB0aGlzLm1fdjI7XG4gICAgICAgIHN3aXRjaCAodGhpcy5tX2NvdW50KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIHplcm9WZWMyKGNsb3Nlc3RQb2ludF9yZXVzZSk7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGNvcHlWZWMyKGNsb3Nlc3RQb2ludF9yZXVzZSwgdjEzLncpO1xuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiBjb21iaW5lMlZlYzIoY2xvc2VzdFBvaW50X3JldXNlLCB2MTMuYSwgdjEzLncsIHYyMi5hLCB2MjIudyk7XG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIHplcm9WZWMyKGNsb3Nlc3RQb2ludF9yZXVzZSk7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB6ZXJvVmVjMihjbG9zZXN0UG9pbnRfcmV1c2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLmdldFdpdG5lc3NQb2ludHMgPSBmdW5jdGlvbihwQTIsIHBCMikge1xuICAgICAgICB2YXIgdjEzID0gdGhpcy5tX3YxO1xuICAgICAgICB2YXIgdjIyID0gdGhpcy5tX3YyO1xuICAgICAgICB2YXIgdjMgPSB0aGlzLm1fdjM7XG4gICAgICAgIHN3aXRjaCAodGhpcy5tX2NvdW50KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgY29weVZlYzIocEEyLCB2MTMud0EpO1xuICAgICAgICAgICAgY29weVZlYzIocEIyLCB2MTMud0IpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgY29tYmluZTJWZWMyKHBBMiwgdjEzLmEsIHYxMy53QSwgdjIyLmEsIHYyMi53QSk7XG4gICAgICAgICAgICBjb21iaW5lMlZlYzIocEIyLCB2MTMuYSwgdjEzLndCLCB2MjIuYSwgdjIyLndCKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIGNvbWJpbmUzVmVjMihwQTIsIHYxMy5hLCB2MTMud0EsIHYyMi5hLCB2MjIud0EsIHYzLmEsIHYzLndBKTtcbiAgICAgICAgICAgIGNvcHlWZWMyKHBCMiwgcEEyKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLmdldE1ldHJpYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiBkaXN0VmVjMih0aGlzLm1fdjEudywgdGhpcy5tX3YyLncpO1xuICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiBjcm9zc1ZlYzJWZWMyKHN1YlZlYzIodGVtcDEsIHRoaXMubV92Mi53LCB0aGlzLm1fdjEudyksIHN1YlZlYzIodGVtcDIsIHRoaXMubV92My53LCB0aGlzLm1fdjEudykpO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5zb2x2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHRoaXMuc29sdmUyKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICB0aGlzLnNvbHZlMygpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUuc29sdmUyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB3MSA9IHRoaXMubV92MS53O1xuICAgICAgICB2YXIgdzIgPSB0aGlzLm1fdjIudztcbiAgICAgICAgc3ViVmVjMihlMTIsIHcyLCB3MSk7XG4gICAgICAgIHZhciBkMTJfMiA9IC1kb3RWZWMyKHcxLCBlMTIpO1xuICAgICAgICBpZiAoZDEyXzIgPD0gMCkge1xuICAgICAgICAgIHRoaXMubV92MS5hID0gMTtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZDEyXzEgPSBkb3RWZWMyKHcyLCBlMTIpO1xuICAgICAgICBpZiAoZDEyXzEgPD0gMCkge1xuICAgICAgICAgIHRoaXMubV92Mi5hID0gMTtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xuICAgICAgICAgIHRoaXMubV92MS5zZXQodGhpcy5tX3YyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGludl9kMTIgPSAxIC8gKGQxMl8xICsgZDEyXzIpO1xuICAgICAgICB0aGlzLm1fdjEuYSA9IGQxMl8xICogaW52X2QxMjtcbiAgICAgICAgdGhpcy5tX3YyLmEgPSBkMTJfMiAqIGludl9kMTI7XG4gICAgICAgIHRoaXMubV9jb3VudCA9IDI7XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLnNvbHZlMyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdzEgPSB0aGlzLm1fdjEudztcbiAgICAgICAgdmFyIHcyID0gdGhpcy5tX3YyLnc7XG4gICAgICAgIHZhciB3MyA9IHRoaXMubV92My53O1xuICAgICAgICBzdWJWZWMyKGUxMiwgdzIsIHcxKTtcbiAgICAgICAgdmFyIHcxZTEyID0gZG90VmVjMih3MSwgZTEyKTtcbiAgICAgICAgdmFyIHcyZTEyID0gZG90VmVjMih3MiwgZTEyKTtcbiAgICAgICAgdmFyIGQxMl8xID0gdzJlMTI7XG4gICAgICAgIHZhciBkMTJfMiA9IC13MWUxMjtcbiAgICAgICAgc3ViVmVjMihlMTMsIHczLCB3MSk7XG4gICAgICAgIHZhciB3MWUxMyA9IGRvdFZlYzIodzEsIGUxMyk7XG4gICAgICAgIHZhciB3M2UxMyA9IGRvdFZlYzIodzMsIGUxMyk7XG4gICAgICAgIHZhciBkMTNfMSA9IHczZTEzO1xuICAgICAgICB2YXIgZDEzXzIgPSAtdzFlMTM7XG4gICAgICAgIHN1YlZlYzIoZTIzLCB3MywgdzIpO1xuICAgICAgICB2YXIgdzJlMjMgPSBkb3RWZWMyKHcyLCBlMjMpO1xuICAgICAgICB2YXIgdzNlMjMgPSBkb3RWZWMyKHczLCBlMjMpO1xuICAgICAgICB2YXIgZDIzXzEgPSB3M2UyMztcbiAgICAgICAgdmFyIGQyM18yID0gLXcyZTIzO1xuICAgICAgICB2YXIgbjEyMyA9IGNyb3NzVmVjMlZlYzIoZTEyLCBlMTMpO1xuICAgICAgICB2YXIgZDEyM18xID0gbjEyMyAqIGNyb3NzVmVjMlZlYzIodzIsIHczKTtcbiAgICAgICAgdmFyIGQxMjNfMiA9IG4xMjMgKiBjcm9zc1ZlYzJWZWMyKHczLCB3MSk7XG4gICAgICAgIHZhciBkMTIzXzMgPSBuMTIzICogY3Jvc3NWZWMyVmVjMih3MSwgdzIpO1xuICAgICAgICBpZiAoZDEyXzIgPD0gMCAmJiBkMTNfMiA8PSAwKSB7XG4gICAgICAgICAgdGhpcy5tX3YxLmEgPSAxO1xuICAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkMTJfMSA+IDAgJiYgZDEyXzIgPiAwICYmIGQxMjNfMyA8PSAwKSB7XG4gICAgICAgICAgdmFyIGludl9kMTIgPSAxIC8gKGQxMl8xICsgZDEyXzIpO1xuICAgICAgICAgIHRoaXMubV92MS5hID0gZDEyXzEgKiBpbnZfZDEyO1xuICAgICAgICAgIHRoaXMubV92Mi5hID0gZDEyXzIgKiBpbnZfZDEyO1xuICAgICAgICAgIHRoaXMubV9jb3VudCA9IDI7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkMTNfMSA+IDAgJiYgZDEzXzIgPiAwICYmIGQxMjNfMiA8PSAwKSB7XG4gICAgICAgICAgdmFyIGludl9kMTMgPSAxIC8gKGQxM18xICsgZDEzXzIpO1xuICAgICAgICAgIHRoaXMubV92MS5hID0gZDEzXzEgKiBpbnZfZDEzO1xuICAgICAgICAgIHRoaXMubV92My5hID0gZDEzXzIgKiBpbnZfZDEzO1xuICAgICAgICAgIHRoaXMubV9jb3VudCA9IDI7XG4gICAgICAgICAgdGhpcy5tX3YyLnNldCh0aGlzLm1fdjMpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZDEyXzEgPD0gMCAmJiBkMjNfMiA8PSAwKSB7XG4gICAgICAgICAgdGhpcy5tX3YyLmEgPSAxO1xuICAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XG4gICAgICAgICAgdGhpcy5tX3YxLnNldCh0aGlzLm1fdjIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZDEzXzEgPD0gMCAmJiBkMjNfMSA8PSAwKSB7XG4gICAgICAgICAgdGhpcy5tX3YzLmEgPSAxO1xuICAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XG4gICAgICAgICAgdGhpcy5tX3YxLnNldCh0aGlzLm1fdjMpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZDIzXzEgPiAwICYmIGQyM18yID4gMCAmJiBkMTIzXzEgPD0gMCkge1xuICAgICAgICAgIHZhciBpbnZfZDIzID0gMSAvIChkMjNfMSArIGQyM18yKTtcbiAgICAgICAgICB0aGlzLm1fdjIuYSA9IGQyM18xICogaW52X2QyMztcbiAgICAgICAgICB0aGlzLm1fdjMuYSA9IGQyM18yICogaW52X2QyMztcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAyO1xuICAgICAgICAgIHRoaXMubV92MS5zZXQodGhpcy5tX3YzKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGludl9kMTIzID0gMSAvIChkMTIzXzEgKyBkMTIzXzIgKyBkMTIzXzMpO1xuICAgICAgICB0aGlzLm1fdjEuYSA9IGQxMjNfMSAqIGludl9kMTIzO1xuICAgICAgICB0aGlzLm1fdjIuYSA9IGQxMjNfMiAqIGludl9kMTIzO1xuICAgICAgICB0aGlzLm1fdjMuYSA9IGQxMjNfMyAqIGludl9kMTIzO1xuICAgICAgICB0aGlzLm1fY291bnQgPSAzO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTaW1wbGV4MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIHNpbXBsZXggPSBuZXcgU2ltcGxleCgpO1xuICB2YXIgaW5wdXQkMSA9IG5ldyBEaXN0YW5jZUlucHV0KCk7XG4gIHZhciBjYWNoZSQxID0gbmV3IFNpbXBsZXhDYWNoZSgpO1xuICB2YXIgb3V0cHV0JDEgPSBuZXcgRGlzdGFuY2VPdXRwdXQoKTtcbiAgdmFyIHRlc3RPdmVybGFwID0gZnVuY3Rpb24oc2hhcGVBLCBpbmRleEEsIHNoYXBlQiwgaW5kZXhCLCB4ZkEyLCB4ZkIyKSB7XG4gICAgaW5wdXQkMS5yZWN5Y2xlKCk7XG4gICAgaW5wdXQkMS5wcm94eUEuc2V0KHNoYXBlQSwgaW5kZXhBKTtcbiAgICBpbnB1dCQxLnByb3h5Qi5zZXQoc2hhcGVCLCBpbmRleEIpO1xuICAgIGNvcHlUcmFuc2Zvcm0oaW5wdXQkMS50cmFuc2Zvcm1BLCB4ZkEyKTtcbiAgICBjb3B5VHJhbnNmb3JtKGlucHV0JDEudHJhbnNmb3JtQiwgeGZCMik7XG4gICAgaW5wdXQkMS51c2VSYWRpaSA9IHRydWU7XG4gICAgb3V0cHV0JDEucmVjeWNsZSgpO1xuICAgIGNhY2hlJDEucmVjeWNsZSgpO1xuICAgIERpc3RhbmNlKG91dHB1dCQxLCBjYWNoZSQxLCBpbnB1dCQxKTtcbiAgICByZXR1cm4gb3V0cHV0JDEuZGlzdGFuY2UgPCAxMCAqIEVQU0lMT047XG4gIH07XG4gIERpc3RhbmNlLnRlc3RPdmVybGFwID0gdGVzdE92ZXJsYXA7XG4gIERpc3RhbmNlLklucHV0ID0gRGlzdGFuY2VJbnB1dDtcbiAgRGlzdGFuY2UuT3V0cHV0ID0gRGlzdGFuY2VPdXRwdXQ7XG4gIERpc3RhbmNlLlByb3h5ID0gRGlzdGFuY2VQcm94eTtcbiAgRGlzdGFuY2UuQ2FjaGUgPSBTaW1wbGV4Q2FjaGU7XG4gIHZhciBTaGFwZUNhc3RJbnB1dCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTaGFwZUNhc3RJbnB1dDIoKSB7XG4gICAgICAgIHRoaXMucHJveHlBID0gbmV3IERpc3RhbmNlUHJveHkoKTtcbiAgICAgICAgdGhpcy5wcm94eUIgPSBuZXcgRGlzdGFuY2VQcm94eSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUEgPSBUcmFuc2Zvcm0uaWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1CID0gVHJhbnNmb3JtLmlkZW50aXR5KCk7XG4gICAgICAgIHRoaXMudHJhbnNsYXRpb25CID0gVmVjMi56ZXJvKCk7XG4gICAgICB9XG4gICAgICBTaGFwZUNhc3RJbnB1dDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5wcm94eUEucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnByb3h5Qi5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtQS5zZXRJZGVudGl0eSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUIuc2V0SWRlbnRpdHkoKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy50cmFuc2xhdGlvbkIpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTaGFwZUNhc3RJbnB1dDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBTaGFwZUNhc3RPdXRwdXQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIC8qIEBfX1BVUkVfXyAqLyBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNoYXBlQ2FzdE91dHB1dDIoKSB7XG4gICAgICAgIHRoaXMucG9pbnQgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5ub3JtYWwgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5sYW1iZGEgPSAxO1xuICAgICAgICB0aGlzLml0ZXJhdGlvbnMgPSAwO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFNoYXBlQ2FzdE91dHB1dDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBTaGFwZUNhc3QgPSBmdW5jdGlvbihvdXRwdXQyLCBpbnB1dDIpIHtcbiAgICBvdXRwdXQyLml0ZXJhdGlvbnMgPSAwO1xuICAgIG91dHB1dDIubGFtYmRhID0gMTtcbiAgICBvdXRwdXQyLm5vcm1hbC5zZXRaZXJvKCk7XG4gICAgb3V0cHV0Mi5wb2ludC5zZXRaZXJvKCk7XG4gICAgdmFyIHByb3h5QSA9IGlucHV0Mi5wcm94eUE7XG4gICAgdmFyIHByb3h5QiA9IGlucHV0Mi5wcm94eUI7XG4gICAgdmFyIHJhZGl1c0EgPSBtYXRoX21heCQ0KHByb3h5QS5tX3JhZGl1cywgU2V0dGluZ3NJbnRlcm5hbC5wb2x5Z29uUmFkaXVzKTtcbiAgICB2YXIgcmFkaXVzQiA9IG1hdGhfbWF4JDQocHJveHlCLm1fcmFkaXVzLCBTZXR0aW5nc0ludGVybmFsLnBvbHlnb25SYWRpdXMpO1xuICAgIHZhciByYWRpdXMgPSByYWRpdXNBICsgcmFkaXVzQjtcbiAgICB2YXIgeGZBMiA9IGlucHV0Mi50cmFuc2Zvcm1BO1xuICAgIHZhciB4ZkIyID0gaW5wdXQyLnRyYW5zZm9ybUI7XG4gICAgdmFyIHIgPSBpbnB1dDIudHJhbnNsYXRpb25CO1xuICAgIHZhciBuMiA9IFZlYzIuemVybygpO1xuICAgIHZhciBsYW1iZGEgPSAwO1xuICAgIHZhciBzaW1wbGV4MiA9IG5ldyBTaW1wbGV4KCk7XG4gICAgc2ltcGxleDIubV9jb3VudCA9IDA7XG4gICAgdmFyIHZlcnRpY2VzID0gc2ltcGxleDIubV92O1xuICAgIHZhciBpbmRleEEgPSBwcm94eUEuZ2V0U3VwcG9ydChSb3QubXVsVFZlYzIoeGZBMi5xLCBWZWMyLm5lZyhyKSkpO1xuICAgIHZhciB3QSA9IFRyYW5zZm9ybS5tdWxWZWMyKHhmQTIsIHByb3h5QS5nZXRWZXJ0ZXgoaW5kZXhBKSk7XG4gICAgdmFyIGluZGV4QiA9IHByb3h5Qi5nZXRTdXBwb3J0KFJvdC5tdWxUVmVjMih4ZkIyLnEsIHIpKTtcbiAgICB2YXIgd0IgPSBUcmFuc2Zvcm0ubXVsVmVjMih4ZkIyLCBwcm94eUIuZ2V0VmVydGV4KGluZGV4QikpO1xuICAgIHZhciB2MyA9IFZlYzIuc3ViKHdBLCB3Qik7XG4gICAgdmFyIHNpZ21hID0gbWF0aF9tYXgkNChTZXR0aW5nc0ludGVybmFsLnBvbHlnb25SYWRpdXMsIHJhZGl1cyAtIFNldHRpbmdzSW50ZXJuYWwucG9seWdvblJhZGl1cyk7XG4gICAgdmFyIHRvbGVyYW5jZSA9IDAuNSAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICB2YXIga19tYXhJdGVycyA9IDIwO1xuICAgIHZhciBpdGVyID0gMDtcbiAgICB3aGlsZSAoaXRlciA8IGtfbWF4SXRlcnMgJiYgdjMubGVuZ3RoKCkgLSBzaWdtYSA+IHRvbGVyYW5jZSkge1xuICAgICAgb3V0cHV0Mi5pdGVyYXRpb25zICs9IDE7XG4gICAgICBpbmRleEEgPSBwcm94eUEuZ2V0U3VwcG9ydChSb3QubXVsVFZlYzIoeGZBMi5xLCBWZWMyLm5lZyh2MykpKTtcbiAgICAgIHdBID0gVHJhbnNmb3JtLm11bFZlYzIoeGZBMiwgcHJveHlBLmdldFZlcnRleChpbmRleEEpKTtcbiAgICAgIGluZGV4QiA9IHByb3h5Qi5nZXRTdXBwb3J0KFJvdC5tdWxUVmVjMih4ZkIyLnEsIHYzKSk7XG4gICAgICB3QiA9IFRyYW5zZm9ybS5tdWxWZWMyKHhmQjIsIHByb3h5Qi5nZXRWZXJ0ZXgoaW5kZXhCKSk7XG4gICAgICB2YXIgcCA9IFZlYzIuc3ViKHdBLCB3Qik7XG4gICAgICB2My5ub3JtYWxpemUoKTtcbiAgICAgIHZhciB2cCA9IFZlYzIuZG90KHYzLCBwKTtcbiAgICAgIHZhciB2ciA9IFZlYzIuZG90KHYzLCByKTtcbiAgICAgIGlmICh2cCAtIHNpZ21hID4gbGFtYmRhICogdnIpIHtcbiAgICAgICAgaWYgKHZyIDw9IDApIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgbGFtYmRhID0gKHZwIC0gc2lnbWEpIC8gdnI7XG4gICAgICAgIGlmIChsYW1iZGEgPiAxKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIG4yLnNldE11bCgtMSwgdjMpO1xuICAgICAgICBzaW1wbGV4Mi5tX2NvdW50ID0gMDtcbiAgICAgIH1cbiAgICAgIHZhciB2ZXJ0ZXggPSB2ZXJ0aWNlc1tzaW1wbGV4Mi5tX2NvdW50XTtcbiAgICAgIHZlcnRleC5pbmRleEEgPSBpbmRleEI7XG4gICAgICB2ZXJ0ZXgud0EgPSBWZWMyLmNvbWJpbmUoMSwgd0IsIGxhbWJkYSwgcik7XG4gICAgICB2ZXJ0ZXguaW5kZXhCID0gaW5kZXhBO1xuICAgICAgdmVydGV4LndCID0gd0E7XG4gICAgICB2ZXJ0ZXgudyA9IFZlYzIuc3ViKHZlcnRleC53QiwgdmVydGV4LndBKTtcbiAgICAgIHZlcnRleC5hID0gMTtcbiAgICAgIHNpbXBsZXgyLm1fY291bnQgKz0gMTtcbiAgICAgIHN3aXRjaCAoc2ltcGxleDIubV9jb3VudCkge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBzaW1wbGV4Mi5zb2x2ZTIoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHNpbXBsZXgyLnNvbHZlMygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKHNpbXBsZXgyLm1fY291bnQgPT0gMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2My5zZXRWZWMyKHNpbXBsZXgyLmdldENsb3Nlc3RQb2ludCgpKTtcbiAgICAgICsraXRlcjtcbiAgICB9XG4gICAgaWYgKGl0ZXIgPT0gMCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgcG9pbnRBMiA9IFZlYzIuemVybygpO1xuICAgIHZhciBwb2ludEIyID0gVmVjMi56ZXJvKCk7XG4gICAgc2ltcGxleDIuZ2V0V2l0bmVzc1BvaW50cyhwb2ludEIyLCBwb2ludEEyKTtcbiAgICBpZiAodjMubGVuZ3RoU3F1YXJlZCgpID4gMCkge1xuICAgICAgbjIuc2V0TXVsKC0xLCB2Myk7XG4gICAgICBuMi5ub3JtYWxpemUoKTtcbiAgICB9XG4gICAgb3V0cHV0Mi5wb2ludCA9IFZlYzIuY29tYmluZSgxLCBwb2ludEEyLCByYWRpdXNBLCBuMik7XG4gICAgb3V0cHV0Mi5ub3JtYWwgPSBuMjtcbiAgICBvdXRwdXQyLmxhbWJkYSA9IGxhbWJkYTtcbiAgICBvdXRwdXQyLml0ZXJhdGlvbnMgPSBpdGVyO1xuICAgIHJldHVybiB0cnVlO1xuICB9O1xuICB2YXIgbWF0aF9hYnMkNyA9IE1hdGguYWJzO1xuICB2YXIgbWF0aF9tYXgkMyA9IE1hdGgubWF4O1xuICB2YXIgVE9JSW5wdXQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVE9JSW5wdXQyKCkge1xuICAgICAgICB0aGlzLnByb3h5QSA9IG5ldyBEaXN0YW5jZVByb3h5KCk7XG4gICAgICAgIHRoaXMucHJveHlCID0gbmV3IERpc3RhbmNlUHJveHkoKTtcbiAgICAgICAgdGhpcy5zd2VlcEEgPSBuZXcgU3dlZXAoKTtcbiAgICAgICAgdGhpcy5zd2VlcEIgPSBuZXcgU3dlZXAoKTtcbiAgICAgIH1cbiAgICAgIFRPSUlucHV0Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnByb3h5QS5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMucHJveHlCLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5zd2VlcEEucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnN3ZWVwQi5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMudE1heCA9IC0xO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBUT0lJbnB1dDI7XG4gICAgfSgpXG4gICk7XG4gIGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlID0gdm9pZCAwO1xuICAoZnVuY3Rpb24oVE9JT3V0cHV0U3RhdGUyKSB7XG4gICAgVE9JT3V0cHV0U3RhdGUyW1RPSU91dHB1dFN0YXRlMltcImVfdW5zZXRcIl0gPSAtMV0gPSBcImVfdW5zZXRcIjtcbiAgICBUT0lPdXRwdXRTdGF0ZTJbVE9JT3V0cHV0U3RhdGUyW1wiZV91bmtub3duXCJdID0gMF0gPSBcImVfdW5rbm93blwiO1xuICAgIFRPSU91dHB1dFN0YXRlMltUT0lPdXRwdXRTdGF0ZTJbXCJlX2ZhaWxlZFwiXSA9IDFdID0gXCJlX2ZhaWxlZFwiO1xuICAgIFRPSU91dHB1dFN0YXRlMltUT0lPdXRwdXRTdGF0ZTJbXCJlX292ZXJsYXBwZWRcIl0gPSAyXSA9IFwiZV9vdmVybGFwcGVkXCI7XG4gICAgVE9JT3V0cHV0U3RhdGUyW1RPSU91dHB1dFN0YXRlMltcImVfdG91Y2hpbmdcIl0gPSAzXSA9IFwiZV90b3VjaGluZ1wiO1xuICAgIFRPSU91dHB1dFN0YXRlMltUT0lPdXRwdXRTdGF0ZTJbXCJlX3NlcGFyYXRlZFwiXSA9IDRdID0gXCJlX3NlcGFyYXRlZFwiO1xuICB9KShleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZSB8fCAoZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUgPSB7fSkpO1xuICB2YXIgVE9JT3V0cHV0ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFRPSU91dHB1dDIoKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLnQgPSAtMTtcbiAgICAgIH1cbiAgICAgIFRPSU91dHB1dDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfdW5zZXQ7XG4gICAgICAgIHRoaXMudCA9IC0xO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBUT0lPdXRwdXQyO1xuICAgIH0oKVxuICApO1xuICBzdGF0cy50b2lUaW1lID0gMDtcbiAgc3RhdHMudG9pTWF4VGltZSA9IDA7XG4gIHN0YXRzLnRvaUNhbGxzID0gMDtcbiAgc3RhdHMudG9pSXRlcnMgPSAwO1xuICBzdGF0cy50b2lNYXhJdGVycyA9IDA7XG4gIHN0YXRzLnRvaVJvb3RJdGVycyA9IDA7XG4gIHN0YXRzLnRvaU1heFJvb3RJdGVycyA9IDA7XG4gIHZhciBkaXN0YW5jZUlucHV0ID0gbmV3IERpc3RhbmNlSW5wdXQoKTtcbiAgdmFyIGRpc3RhbmNlT3V0cHV0ID0gbmV3IERpc3RhbmNlT3V0cHV0KCk7XG4gIHZhciBjYWNoZSA9IG5ldyBTaW1wbGV4Q2FjaGUoKTtcbiAgdmFyIHhmQSQxID0gdHJhbnNmb3JtKDAsIDAsIDApO1xuICB2YXIgeGZCJDEgPSB0cmFuc2Zvcm0oMCwgMCwgMCk7XG4gIHZhciB0ZW1wJDQgPSB2ZWMyKDAsIDApO1xuICB2YXIgcG9pbnRBJDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgcG9pbnRCJDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgbm9ybWFsJDMgPSB2ZWMyKDAsIDApO1xuICB2YXIgYXhpc0EgPSB2ZWMyKDAsIDApO1xuICB2YXIgYXhpc0IgPSB2ZWMyKDAsIDApO1xuICB2YXIgbG9jYWxQb2ludEEgPSB2ZWMyKDAsIDApO1xuICB2YXIgbG9jYWxQb2ludEIgPSB2ZWMyKDAsIDApO1xuICB2YXIgVGltZU9mSW1wYWN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyKSB7XG4gICAgdmFyIHRpbWVyID0gVGltZXIubm93KCk7XG4gICAgKytzdGF0cy50b2lDYWxscztcbiAgICBvdXRwdXQyLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV91bmtub3duO1xuICAgIG91dHB1dDIudCA9IGlucHV0Mi50TWF4O1xuICAgIHZhciBwcm94eUEgPSBpbnB1dDIucHJveHlBO1xuICAgIHZhciBwcm94eUIgPSBpbnB1dDIucHJveHlCO1xuICAgIHZhciBzd2VlcEEgPSBpbnB1dDIuc3dlZXBBO1xuICAgIHZhciBzd2VlcEIgPSBpbnB1dDIuc3dlZXBCO1xuICAgIHN3ZWVwQS5ub3JtYWxpemUoKTtcbiAgICBzd2VlcEIubm9ybWFsaXplKCk7XG4gICAgdmFyIHRNYXggPSBpbnB1dDIudE1heDtcbiAgICB2YXIgdG90YWxSYWRpdXMgPSBwcm94eUEubV9yYWRpdXMgKyBwcm94eUIubV9yYWRpdXM7XG4gICAgdmFyIHRhcmdldCA9IG1hdGhfbWF4JDMoU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wLCB0b3RhbFJhZGl1cyAtIDMgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3ApO1xuICAgIHZhciB0b2xlcmFuY2UgPSAwLjI1ICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgIHZhciB0MSA9IDA7XG4gICAgdmFyIGtfbWF4SXRlcmF0aW9ucyA9IFNldHRpbmdzSW50ZXJuYWwubWF4VE9JSXRlcmF0aW9ucztcbiAgICB2YXIgaXRlciA9IDA7XG4gICAgY2FjaGUucmVjeWNsZSgpO1xuICAgIGRpc3RhbmNlSW5wdXQucHJveHlBLnNldFZlcnRpY2VzKHByb3h5QS5tX3ZlcnRpY2VzLCBwcm94eUEubV9jb3VudCwgcHJveHlBLm1fcmFkaXVzKTtcbiAgICBkaXN0YW5jZUlucHV0LnByb3h5Qi5zZXRWZXJ0aWNlcyhwcm94eUIubV92ZXJ0aWNlcywgcHJveHlCLm1fY291bnQsIHByb3h5Qi5tX3JhZGl1cyk7XG4gICAgZGlzdGFuY2VJbnB1dC51c2VSYWRpaSA9IGZhbHNlO1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBzd2VlcEEuZ2V0VHJhbnNmb3JtKHhmQSQxLCB0MSk7XG4gICAgICBzd2VlcEIuZ2V0VHJhbnNmb3JtKHhmQiQxLCB0MSk7XG4gICAgICBjb3B5VHJhbnNmb3JtKGRpc3RhbmNlSW5wdXQudHJhbnNmb3JtQSwgeGZBJDEpO1xuICAgICAgY29weVRyYW5zZm9ybShkaXN0YW5jZUlucHV0LnRyYW5zZm9ybUIsIHhmQiQxKTtcbiAgICAgIERpc3RhbmNlKGRpc3RhbmNlT3V0cHV0LCBjYWNoZSwgZGlzdGFuY2VJbnB1dCk7XG4gICAgICBpZiAoZGlzdGFuY2VPdXRwdXQuZGlzdGFuY2UgPD0gMCkge1xuICAgICAgICBvdXRwdXQyLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV9vdmVybGFwcGVkO1xuICAgICAgICBvdXRwdXQyLnQgPSAwO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmIChkaXN0YW5jZU91dHB1dC5kaXN0YW5jZSA8IHRhcmdldCArIHRvbGVyYW5jZSkge1xuICAgICAgICBvdXRwdXQyLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV90b3VjaGluZztcbiAgICAgICAgb3V0cHV0Mi50ID0gdDE7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgc2VwYXJhdGlvbkZ1bmN0aW9uLmluaXRpYWxpemUoY2FjaGUsIHByb3h5QSwgc3dlZXBBLCBwcm94eUIsIHN3ZWVwQiwgdDEpO1xuICAgICAgdmFyIGRvbmUgPSBmYWxzZTtcbiAgICAgIHZhciB0MiA9IHRNYXg7XG4gICAgICB2YXIgcHVzaEJhY2tJdGVyID0gMDtcbiAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBzMiA9IHNlcGFyYXRpb25GdW5jdGlvbi5maW5kTWluU2VwYXJhdGlvbih0Mik7XG4gICAgICAgIGlmIChzMiA+IHRhcmdldCArIHRvbGVyYW5jZSkge1xuICAgICAgICAgIG91dHB1dDIuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX3NlcGFyYXRlZDtcbiAgICAgICAgICBvdXRwdXQyLnQgPSB0TWF4O1xuICAgICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzMiA+IHRhcmdldCAtIHRvbGVyYW5jZSkge1xuICAgICAgICAgIHQxID0gdDI7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHMxID0gc2VwYXJhdGlvbkZ1bmN0aW9uLmV2YWx1YXRlKHQxKTtcbiAgICAgICAgaWYgKHMxIDwgdGFyZ2V0IC0gdG9sZXJhbmNlKSB7XG4gICAgICAgICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfZmFpbGVkO1xuICAgICAgICAgIG91dHB1dDIudCA9IHQxO1xuICAgICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzMSA8PSB0YXJnZXQgKyB0b2xlcmFuY2UpIHtcbiAgICAgICAgICBvdXRwdXQyLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV90b3VjaGluZztcbiAgICAgICAgICBvdXRwdXQyLnQgPSB0MTtcbiAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgcm9vdEl0ZXJDb3VudCA9IDA7XG4gICAgICAgIHZhciBhMSA9IHQxO1xuICAgICAgICB2YXIgYTIgPSB0MjtcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICB2YXIgdCA9IHZvaWQgMDtcbiAgICAgICAgICBpZiAocm9vdEl0ZXJDb3VudCAmIDEpIHtcbiAgICAgICAgICAgIHQgPSBhMSArICh0YXJnZXQgLSBzMSkgKiAoYTIgLSBhMSkgLyAoczIgLSBzMSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHQgPSAwLjUgKiAoYTEgKyBhMik7XG4gICAgICAgICAgfVxuICAgICAgICAgICsrcm9vdEl0ZXJDb3VudDtcbiAgICAgICAgICArK3N0YXRzLnRvaVJvb3RJdGVycztcbiAgICAgICAgICB2YXIgczMgPSBzZXBhcmF0aW9uRnVuY3Rpb24uZXZhbHVhdGUodCk7XG4gICAgICAgICAgaWYgKG1hdGhfYWJzJDcoczMgLSB0YXJnZXQpIDwgdG9sZXJhbmNlKSB7XG4gICAgICAgICAgICB0MiA9IHQ7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHMzID4gdGFyZ2V0KSB7XG4gICAgICAgICAgICBhMSA9IHQ7XG4gICAgICAgICAgICBzMSA9IHMzO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhMiA9IHQ7XG4gICAgICAgICAgICBzMiA9IHMzO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocm9vdEl0ZXJDb3VudCA9PT0gNTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzdGF0cy50b2lNYXhSb290SXRlcnMgPSBtYXRoX21heCQzKHN0YXRzLnRvaU1heFJvb3RJdGVycywgcm9vdEl0ZXJDb3VudCk7XG4gICAgICAgICsrcHVzaEJhY2tJdGVyO1xuICAgICAgICBpZiAocHVzaEJhY2tJdGVyID09PSBTZXR0aW5nc0ludGVybmFsLm1heFBvbHlnb25WZXJ0aWNlcykge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICArK2l0ZXI7XG4gICAgICArK3N0YXRzLnRvaUl0ZXJzO1xuICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAoaXRlciA9PT0ga19tYXhJdGVyYXRpb25zKSB7XG4gICAgICAgIG91dHB1dDIuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX2ZhaWxlZDtcbiAgICAgICAgb3V0cHV0Mi50ID0gdDE7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICBzdGF0cy50b2lNYXhJdGVycyA9IG1hdGhfbWF4JDMoc3RhdHMudG9pTWF4SXRlcnMsIGl0ZXIpO1xuICAgIHZhciB0aW1lID0gVGltZXIuZGlmZih0aW1lcik7XG4gICAgc3RhdHMudG9pTWF4VGltZSA9IG1hdGhfbWF4JDMoc3RhdHMudG9pTWF4VGltZSwgdGltZSk7XG4gICAgc3RhdHMudG9pVGltZSArPSB0aW1lO1xuICAgIHNlcGFyYXRpb25GdW5jdGlvbi5yZWN5Y2xlKCk7XG4gIH07XG4gIHZhciBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlO1xuICAoZnVuY3Rpb24oU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTIpIHtcbiAgICBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlMltTZXBhcmF0aW9uRnVuY3Rpb25UeXBlMltcImVfdW5zZXRcIl0gPSAtMV0gPSBcImVfdW5zZXRcIjtcbiAgICBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlMltTZXBhcmF0aW9uRnVuY3Rpb25UeXBlMltcImVfcG9pbnRzXCJdID0gMV0gPSBcImVfcG9pbnRzXCI7XG4gICAgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbXCJlX2ZhY2VBXCJdID0gMl0gPSBcImVfZmFjZUFcIjtcbiAgICBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlMltTZXBhcmF0aW9uRnVuY3Rpb25UeXBlMltcImVfZmFjZUJcIl0gPSAzXSA9IFwiZV9mYWNlQlwiO1xuICB9KShTZXBhcmF0aW9uRnVuY3Rpb25UeXBlIHx8IChTZXBhcmF0aW9uRnVuY3Rpb25UeXBlID0ge30pKTtcbiAgdmFyIFNlcGFyYXRpb25GdW5jdGlvbiA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTZXBhcmF0aW9uRnVuY3Rpb24yKCkge1xuICAgICAgICB0aGlzLm1fcHJveHlBID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3Byb3h5QiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9zd2VlcEEgPSBudWxsO1xuICAgICAgICB0aGlzLm1fc3dlZXBCID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3R5cGUgPSBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlLmVfdW5zZXQ7XG4gICAgICAgIHRoaXMubV9sb2NhbFBvaW50ID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5tX2F4aXMgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLmluZGV4QSA9IC0xO1xuICAgICAgICB0aGlzLmluZGV4QiA9IC0xO1xuICAgICAgfVxuICAgICAgU2VwYXJhdGlvbkZ1bmN0aW9uMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fcHJveHlBID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3Byb3h5QiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9zd2VlcEEgPSBudWxsO1xuICAgICAgICB0aGlzLm1fc3dlZXBCID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3R5cGUgPSBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlLmVfdW5zZXQ7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubV9sb2NhbFBvaW50KTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5tX2F4aXMpO1xuICAgICAgICB0aGlzLmluZGV4QSA9IC0xO1xuICAgICAgICB0aGlzLmluZGV4QiA9IC0xO1xuICAgICAgfTtcbiAgICAgIFNlcGFyYXRpb25GdW5jdGlvbjIucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbihjYWNoZTIsIHByb3h5QSwgc3dlZXBBLCBwcm94eUIsIHN3ZWVwQiwgdDEpIHtcbiAgICAgICAgdmFyIGNvdW50ID0gY2FjaGUyLmNvdW50O1xuICAgICAgICB0aGlzLm1fcHJveHlBID0gcHJveHlBO1xuICAgICAgICB0aGlzLm1fcHJveHlCID0gcHJveHlCO1xuICAgICAgICB0aGlzLm1fc3dlZXBBID0gc3dlZXBBO1xuICAgICAgICB0aGlzLm1fc3dlZXBCID0gc3dlZXBCO1xuICAgICAgICB0aGlzLm1fc3dlZXBBLmdldFRyYW5zZm9ybSh4ZkEkMSwgdDEpO1xuICAgICAgICB0aGlzLm1fc3dlZXBCLmdldFRyYW5zZm9ybSh4ZkIkMSwgdDEpO1xuICAgICAgICBpZiAoY291bnQgPT09IDEpIHtcbiAgICAgICAgICB0aGlzLm1fdHlwZSA9IFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV9wb2ludHM7XG4gICAgICAgICAgdmFyIGxvY2FsUG9pbnRBXzEgPSB0aGlzLm1fcHJveHlBLmdldFZlcnRleChjYWNoZTIuaW5kZXhBWzBdKTtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEJfMSA9IHRoaXMubV9wcm94eUIuZ2V0VmVydGV4KGNhY2hlMi5pbmRleEJbMF0pO1xuICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRBJDIsIHhmQSQxLCBsb2NhbFBvaW50QV8xKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QiQyLCB4ZkIkMSwgbG9jYWxQb2ludEJfMSk7XG4gICAgICAgICAgc3ViVmVjMih0aGlzLm1fYXhpcywgcG9pbnRCJDIsIHBvaW50QSQyKTtcbiAgICAgICAgICB2YXIgczIgPSBub3JtYWxpemVWZWMyTGVuZ3RoKHRoaXMubV9heGlzKTtcbiAgICAgICAgICByZXR1cm4gczI7XG4gICAgICAgIH0gZWxzZSBpZiAoY2FjaGUyLmluZGV4QVswXSA9PT0gY2FjaGUyLmluZGV4QVsxXSkge1xuICAgICAgICAgIHRoaXMubV90eXBlID0gU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZS5lX2ZhY2VCO1xuICAgICAgICAgIHZhciBsb2NhbFBvaW50QjEgPSBwcm94eUIuZ2V0VmVydGV4KGNhY2hlMi5pbmRleEJbMF0pO1xuICAgICAgICAgIHZhciBsb2NhbFBvaW50QjIgPSBwcm94eUIuZ2V0VmVydGV4KGNhY2hlMi5pbmRleEJbMV0pO1xuICAgICAgICAgIGNyb3NzVmVjMk51bSh0aGlzLm1fYXhpcywgc3ViVmVjMih0ZW1wJDQsIGxvY2FsUG9pbnRCMiwgbG9jYWxQb2ludEIxKSwgMSk7XG4gICAgICAgICAgbm9ybWFsaXplVmVjMih0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgcm90VmVjMihub3JtYWwkMywgeGZCJDEucSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgIGNvbWJpbmUyVmVjMih0aGlzLm1fbG9jYWxQb2ludCwgMC41LCBsb2NhbFBvaW50QjEsIDAuNSwgbG9jYWxQb2ludEIyKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QiQyLCB4ZkIkMSwgdGhpcy5tX2xvY2FsUG9pbnQpO1xuICAgICAgICAgIHZhciBsb2NhbFBvaW50QV8yID0gcHJveHlBLmdldFZlcnRleChjYWNoZTIuaW5kZXhBWzBdKTtcbiAgICAgICAgICB2YXIgcG9pbnRBXzEgPSBUcmFuc2Zvcm0ubXVsVmVjMih4ZkEkMSwgbG9jYWxQb2ludEFfMik7XG4gICAgICAgICAgdmFyIHMyID0gZG90VmVjMihwb2ludEFfMSwgbm9ybWFsJDMpIC0gZG90VmVjMihwb2ludEIkMiwgbm9ybWFsJDMpO1xuICAgICAgICAgIGlmIChzMiA8IDApIHtcbiAgICAgICAgICAgIG5lZ1ZlYzIodGhpcy5tX2F4aXMpO1xuICAgICAgICAgICAgczIgPSAtczI7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBzMjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdHlwZSA9IFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV9mYWNlQTtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEExID0gdGhpcy5tX3Byb3h5QS5nZXRWZXJ0ZXgoY2FjaGUyLmluZGV4QVswXSk7XG4gICAgICAgICAgdmFyIGxvY2FsUG9pbnRBMiA9IHRoaXMubV9wcm94eUEuZ2V0VmVydGV4KGNhY2hlMi5pbmRleEFbMV0pO1xuICAgICAgICAgIGNyb3NzVmVjMk51bSh0aGlzLm1fYXhpcywgc3ViVmVjMih0ZW1wJDQsIGxvY2FsUG9pbnRBMiwgbG9jYWxQb2ludEExKSwgMSk7XG4gICAgICAgICAgbm9ybWFsaXplVmVjMih0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgcm90VmVjMihub3JtYWwkMywgeGZBJDEucSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgIGNvbWJpbmUyVmVjMih0aGlzLm1fbG9jYWxQb2ludCwgMC41LCBsb2NhbFBvaW50QTEsIDAuNSwgbG9jYWxQb2ludEEyKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSQyLCB4ZkEkMSwgdGhpcy5tX2xvY2FsUG9pbnQpO1xuICAgICAgICAgIHZhciBsb2NhbFBvaW50Ql8yID0gdGhpcy5tX3Byb3h5Qi5nZXRWZXJ0ZXgoY2FjaGUyLmluZGV4QlswXSk7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIGxvY2FsUG9pbnRCXzIpO1xuICAgICAgICAgIHZhciBzMiA9IGRvdFZlYzIocG9pbnRCJDIsIG5vcm1hbCQzKSAtIGRvdFZlYzIocG9pbnRBJDIsIG5vcm1hbCQzKTtcbiAgICAgICAgICBpZiAoczIgPCAwKSB7XG4gICAgICAgICAgICBuZWdWZWMyKHRoaXMubV9heGlzKTtcbiAgICAgICAgICAgIHMyID0gLXMyO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gczI7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTZXBhcmF0aW9uRnVuY3Rpb24yLnByb3RvdHlwZS5jb21wdXRlID0gZnVuY3Rpb24oZmluZCwgdCkge1xuICAgICAgICB0aGlzLm1fc3dlZXBBLmdldFRyYW5zZm9ybSh4ZkEkMSwgdCk7XG4gICAgICAgIHRoaXMubV9zd2VlcEIuZ2V0VHJhbnNmb3JtKHhmQiQxLCB0KTtcbiAgICAgICAgc3dpdGNoICh0aGlzLm1fdHlwZSkge1xuICAgICAgICAgIGNhc2UgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZS5lX3BvaW50czoge1xuICAgICAgICAgICAgaWYgKGZpbmQpIHtcbiAgICAgICAgICAgICAgZGVyb3RWZWMyKGF4aXNBLCB4ZkEkMS5xLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgICAgIGRlcm90VmVjMihheGlzQiwgeGZCJDEucSwgc2NhbGVWZWMyKHRlbXAkNCwgLTEsIHRoaXMubV9heGlzKSk7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhBID0gdGhpcy5tX3Byb3h5QS5nZXRTdXBwb3J0KGF4aXNBKTtcbiAgICAgICAgICAgICAgdGhpcy5pbmRleEIgPSB0aGlzLm1fcHJveHlCLmdldFN1cHBvcnQoYXhpc0IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29weVZlYzIobG9jYWxQb2ludEEsIHRoaXMubV9wcm94eUEuZ2V0VmVydGV4KHRoaXMuaW5kZXhBKSk7XG4gICAgICAgICAgICBjb3B5VmVjMihsb2NhbFBvaW50QiwgdGhpcy5tX3Byb3h5Qi5nZXRWZXJ0ZXgodGhpcy5pbmRleEIpKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRBJDIsIHhmQSQxLCBsb2NhbFBvaW50QSk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QiQyLCB4ZkIkMSwgbG9jYWxQb2ludEIpO1xuICAgICAgICAgICAgdmFyIHNlcCA9IGRvdFZlYzIocG9pbnRCJDIsIHRoaXMubV9heGlzKSAtIGRvdFZlYzIocG9pbnRBJDIsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICAgIHJldHVybiBzZXA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhc2UgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZS5lX2ZhY2VBOiB7XG4gICAgICAgICAgICByb3RWZWMyKG5vcm1hbCQzLCB4ZkEkMS5xLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSQyLCB4ZkEkMSwgdGhpcy5tX2xvY2FsUG9pbnQpO1xuICAgICAgICAgICAgaWYgKGZpbmQpIHtcbiAgICAgICAgICAgICAgZGVyb3RWZWMyKGF4aXNCLCB4ZkIkMS5xLCBzY2FsZVZlYzIodGVtcCQ0LCAtMSwgbm9ybWFsJDMpKTtcbiAgICAgICAgICAgICAgdGhpcy5pbmRleEEgPSAtMTtcbiAgICAgICAgICAgICAgdGhpcy5pbmRleEIgPSB0aGlzLm1fcHJveHlCLmdldFN1cHBvcnQoYXhpc0IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29weVZlYzIobG9jYWxQb2ludEIsIHRoaXMubV9wcm94eUIuZ2V0VmVydGV4KHRoaXMuaW5kZXhCKSk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QiQyLCB4ZkIkMSwgbG9jYWxQb2ludEIpO1xuICAgICAgICAgICAgdmFyIHNlcCA9IGRvdFZlYzIocG9pbnRCJDIsIG5vcm1hbCQzKSAtIGRvdFZlYzIocG9pbnRBJDIsIG5vcm1hbCQzKTtcbiAgICAgICAgICAgIHJldHVybiBzZXA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhc2UgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZS5lX2ZhY2VCOiB7XG4gICAgICAgICAgICByb3RWZWMyKG5vcm1hbCQzLCB4ZkIkMS5xLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QiQyLCB4ZkIkMSwgdGhpcy5tX2xvY2FsUG9pbnQpO1xuICAgICAgICAgICAgaWYgKGZpbmQpIHtcbiAgICAgICAgICAgICAgZGVyb3RWZWMyKGF4aXNBLCB4ZkEkMS5xLCBzY2FsZVZlYzIodGVtcCQ0LCAtMSwgbm9ybWFsJDMpKTtcbiAgICAgICAgICAgICAgdGhpcy5pbmRleEIgPSAtMTtcbiAgICAgICAgICAgICAgdGhpcy5pbmRleEEgPSB0aGlzLm1fcHJveHlBLmdldFN1cHBvcnQoYXhpc0EpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29weVZlYzIobG9jYWxQb2ludEEsIHRoaXMubV9wcm94eUEuZ2V0VmVydGV4KHRoaXMuaW5kZXhBKSk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSQyLCB4ZkEkMSwgbG9jYWxQb2ludEEpO1xuICAgICAgICAgICAgdmFyIHNlcCA9IGRvdFZlYzIocG9pbnRBJDIsIG5vcm1hbCQzKSAtIGRvdFZlYzIocG9pbnRCJDIsIG5vcm1hbCQzKTtcbiAgICAgICAgICAgIHJldHVybiBzZXA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBpZiAoZmluZCkge1xuICAgICAgICAgICAgICB0aGlzLmluZGV4QSA9IC0xO1xuICAgICAgICAgICAgICB0aGlzLmluZGV4QiA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTZXBhcmF0aW9uRnVuY3Rpb24yLnByb3RvdHlwZS5maW5kTWluU2VwYXJhdGlvbiA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcHV0ZSh0cnVlLCB0KTtcbiAgICAgIH07XG4gICAgICBTZXBhcmF0aW9uRnVuY3Rpb24yLnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcHV0ZShmYWxzZSwgdCk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFNlcGFyYXRpb25GdW5jdGlvbjI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBzZXBhcmF0aW9uRnVuY3Rpb24gPSBuZXcgU2VwYXJhdGlvbkZ1bmN0aW9uKCk7XG4gIFRpbWVPZkltcGFjdC5JbnB1dCA9IFRPSUlucHV0O1xuICBUaW1lT2ZJbXBhY3QuT3V0cHV0ID0gVE9JT3V0cHV0O1xuICB2YXIgbWF0aF9hYnMkNiA9IE1hdGguYWJzO1xuICB2YXIgbWF0aF9zcXJ0JDMgPSBNYXRoLnNxcnQ7XG4gIHZhciBtYXRoX21pbiQ1ID0gTWF0aC5taW47XG4gIHZhciBUaW1lU3RlcCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBUaW1lU3RlcDIoKSB7XG4gICAgICAgIHRoaXMuZHQgPSAwO1xuICAgICAgICB0aGlzLmludl9kdCA9IDA7XG4gICAgICAgIHRoaXMudmVsb2NpdHlJdGVyYXRpb25zID0gMDtcbiAgICAgICAgdGhpcy5wb3NpdGlvbkl0ZXJhdGlvbnMgPSAwO1xuICAgICAgICB0aGlzLndhcm1TdGFydGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJsb2NrU29sdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmludl9kdDAgPSAwO1xuICAgICAgICB0aGlzLmR0UmF0aW8gPSAxO1xuICAgICAgfVxuICAgICAgVGltZVN0ZXAyLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKGR0KSB7XG4gICAgICAgIGlmICh0aGlzLmR0ID4gMCkge1xuICAgICAgICAgIHRoaXMuaW52X2R0MCA9IHRoaXMuaW52X2R0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZHQgPSBkdDtcbiAgICAgICAgdGhpcy5pbnZfZHQgPSBkdCA9PSAwID8gMCA6IDEgLyBkdDtcbiAgICAgICAgdGhpcy5kdFJhdGlvID0gZHQgKiB0aGlzLmludl9kdDA7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFRpbWVTdGVwMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIHNfc3ViU3RlcCA9IG5ldyBUaW1lU3RlcCgpO1xuICB2YXIgYyA9IHZlYzIoMCwgMCk7XG4gIHZhciB2ID0gdmVjMigwLCAwKTtcbiAgdmFyIHRyYW5zbGF0aW9uID0gdmVjMigwLCAwKTtcbiAgdmFyIGlucHV0ID0gbmV3IFRPSUlucHV0KCk7XG4gIHZhciBvdXRwdXQgPSBuZXcgVE9JT3V0cHV0KCk7XG4gIHZhciBiYWNrdXAgPSBuZXcgU3dlZXAoKTtcbiAgdmFyIGJhY2t1cDEgPSBuZXcgU3dlZXAoKTtcbiAgdmFyIGJhY2t1cDIgPSBuZXcgU3dlZXAoKTtcbiAgdmFyIENvbnRhY3RJbXB1bHNlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIENvbnRhY3RJbXB1bHNlMihjb250YWN0KSB7XG4gICAgICAgIHRoaXMuY29udGFjdCA9IGNvbnRhY3Q7XG4gICAgICAgIHRoaXMubm9ybWFscyA9IFtdO1xuICAgICAgICB0aGlzLnRhbmdlbnRzID0gW107XG4gICAgICB9XG4gICAgICBDb250YWN0SW1wdWxzZTIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5ub3JtYWxzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMudGFuZ2VudHMubGVuZ3RoID0gMDtcbiAgICAgIH07XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29udGFjdEltcHVsc2UyLnByb3RvdHlwZSwgXCJub3JtYWxJbXB1bHNlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLmNvbnRhY3Q7XG4gICAgICAgICAgdmFyIG5vcm1hbHMgPSB0aGlzLm5vcm1hbHM7XG4gICAgICAgICAgbm9ybWFscy5sZW5ndGggPSAwO1xuICAgICAgICAgIGZvciAodmFyIHAgPSAwOyBwIDwgY29udGFjdC52X3BvaW50cy5sZW5ndGg7ICsrcCkge1xuICAgICAgICAgICAgbm9ybWFscy5wdXNoKGNvbnRhY3Qudl9wb2ludHNbcF0ubm9ybWFsSW1wdWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBub3JtYWxzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb250YWN0SW1wdWxzZTIucHJvdG90eXBlLCBcInRhbmdlbnRJbXB1bHNlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLmNvbnRhY3Q7XG4gICAgICAgICAgdmFyIHRhbmdlbnRzID0gdGhpcy50YW5nZW50cztcbiAgICAgICAgICB0YW5nZW50cy5sZW5ndGggPSAwO1xuICAgICAgICAgIGZvciAodmFyIHAgPSAwOyBwIDwgY29udGFjdC52X3BvaW50cy5sZW5ndGg7ICsrcCkge1xuICAgICAgICAgICAgdGFuZ2VudHMucHVzaChjb250YWN0LnZfcG9pbnRzW3BdLnRhbmdlbnRJbXB1bHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRhbmdlbnRzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBDb250YWN0SW1wdWxzZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBTb2x2ZXIgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU29sdmVyMih3b3JsZCkge1xuICAgICAgICB0aGlzLm1fd29ybGQgPSB3b3JsZDtcbiAgICAgICAgdGhpcy5tX3N0YWNrID0gW107XG4gICAgICAgIHRoaXMubV9ib2RpZXMgPSBbXTtcbiAgICAgICAgdGhpcy5tX2NvbnRhY3RzID0gW107XG4gICAgICAgIHRoaXMubV9qb2ludHMgPSBbXTtcbiAgICAgIH1cbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV9zdGFjay5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLm1fYm9kaWVzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMubV9jb250YWN0cy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLm1fam9pbnRzLmxlbmd0aCA9IDA7XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUuYWRkQm9keSA9IGZ1bmN0aW9uKGJvZHkpIHtcbiAgICAgICAgdGhpcy5tX2JvZGllcy5wdXNoKGJvZHkpO1xuICAgICAgfTtcbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLmFkZENvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0KSB7XG4gICAgICAgIHRoaXMubV9jb250YWN0cy5wdXNoKGNvbnRhY3QpO1xuICAgICAgfTtcbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLmFkZEpvaW50ID0gZnVuY3Rpb24oam9pbnQpIHtcbiAgICAgICAgdGhpcy5tX2pvaW50cy5wdXNoKGpvaW50KTtcbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5zb2x2ZVdvcmxkID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgd29ybGQgPSB0aGlzLm1fd29ybGQ7XG4gICAgICAgIGZvciAodmFyIGIyID0gd29ybGQubV9ib2R5TGlzdDsgYjI7IGIyID0gYjIubV9uZXh0KSB7XG4gICAgICAgICAgYjIubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgY18xID0gd29ybGQubV9jb250YWN0TGlzdDsgY18xOyBjXzEgPSBjXzEubV9uZXh0KSB7XG4gICAgICAgICAgY18xLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGogPSB3b3JsZC5tX2pvaW50TGlzdDsgajsgaiA9IGoubV9uZXh0KSB7XG4gICAgICAgICAgai5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3RhY2sgPSB0aGlzLm1fc3RhY2s7XG4gICAgICAgIGZvciAodmFyIHNlZWQgPSB3b3JsZC5tX2JvZHlMaXN0OyBzZWVkOyBzZWVkID0gc2VlZC5tX25leHQpIHtcbiAgICAgICAgICBpZiAoc2VlZC5tX2lzbGFuZEZsYWcpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoc2VlZC5pc0F3YWtlKCkgPT0gZmFsc2UgfHwgc2VlZC5pc0FjdGl2ZSgpID09IGZhbHNlKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHNlZWQuaXNTdGF0aWMoKSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgICBzdGFjay5wdXNoKHNlZWQpO1xuICAgICAgICAgIHNlZWQubV9pc2xhbmRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIGIyID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgICB0aGlzLmFkZEJvZHkoYjIpO1xuICAgICAgICAgICAgYjIubV9hd2FrZUZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGIyLmlzU3RhdGljKCkpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBjZSA9IGIyLm1fY29udGFjdExpc3Q7IGNlOyBjZSA9IGNlLm5leHQpIHtcbiAgICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSBjZS5jb250YWN0O1xuICAgICAgICAgICAgICBpZiAoY29udGFjdC5tX2lzbGFuZEZsYWcpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAoY29udGFjdC5pc0VuYWJsZWQoKSA9PSBmYWxzZSB8fCBjb250YWN0LmlzVG91Y2hpbmcoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhciBzZW5zb3JBID0gY29udGFjdC5tX2ZpeHR1cmVBLm1faXNTZW5zb3I7XG4gICAgICAgICAgICAgIHZhciBzZW5zb3JCID0gY29udGFjdC5tX2ZpeHR1cmVCLm1faXNTZW5zb3I7XG4gICAgICAgICAgICAgIGlmIChzZW5zb3JBIHx8IHNlbnNvckIpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB0aGlzLmFkZENvbnRhY3QoY29udGFjdCk7XG4gICAgICAgICAgICAgIGNvbnRhY3QubV9pc2xhbmRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgdmFyIG90aGVyID0gY2Uub3RoZXI7XG4gICAgICAgICAgICAgIGlmIChvdGhlci5tX2lzbGFuZEZsYWcpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzdGFjay5wdXNoKG90aGVyKTtcbiAgICAgICAgICAgICAgb3RoZXIubV9pc2xhbmRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGplID0gYjIubV9qb2ludExpc3Q7IGplOyBqZSA9IGplLm5leHQpIHtcbiAgICAgICAgICAgICAgaWYgKGplLmpvaW50Lm1faXNsYW5kRmxhZyA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIG90aGVyID0gamUub3RoZXI7XG4gICAgICAgICAgICAgIGlmIChvdGhlci5pc0FjdGl2ZSgpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdGhpcy5hZGRKb2ludChqZS5qb2ludCk7XG4gICAgICAgICAgICAgIGplLmpvaW50Lm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgIGlmIChvdGhlci5tX2lzbGFuZEZsYWcpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzdGFjay5wdXNoKG90aGVyKTtcbiAgICAgICAgICAgICAgb3RoZXIubV9pc2xhbmRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5zb2x2ZUlzbGFuZChzdGVwKTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9ib2RpZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBiMiA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgICBpZiAoYjIuaXNTdGF0aWMoKSkge1xuICAgICAgICAgICAgICBiMi5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5zb2x2ZUlzbGFuZCA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHdvcmxkID0gdGhpcy5tX3dvcmxkO1xuICAgICAgICB2YXIgZ3Jhdml0eSA9IHdvcmxkLm1fZ3Jhdml0eTtcbiAgICAgICAgdmFyIGFsbG93U2xlZXAgPSB3b3JsZC5tX2FsbG93U2xlZXA7XG4gICAgICAgIHZhciBoID0gc3RlcC5kdDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgIGNvcHlWZWMyKGMsIGJvZHkubV9zd2VlcC5jKTtcbiAgICAgICAgICB2YXIgYTIgPSBib2R5Lm1fc3dlZXAuYTtcbiAgICAgICAgICBjb3B5VmVjMih2LCBib2R5Lm1fbGluZWFyVmVsb2NpdHkpO1xuICAgICAgICAgIHZhciB3ID0gYm9keS5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgICBjb3B5VmVjMihib2R5Lm1fc3dlZXAuYzAsIGJvZHkubV9zd2VlcC5jKTtcbiAgICAgICAgICBib2R5Lm1fc3dlZXAuYTAgPSBib2R5Lm1fc3dlZXAuYTtcbiAgICAgICAgICBpZiAoYm9keS5pc0R5bmFtaWMoKSkge1xuICAgICAgICAgICAgcGx1c1NjYWxlVmVjMih2LCBoICogYm9keS5tX2dyYXZpdHlTY2FsZSwgZ3Jhdml0eSk7XG4gICAgICAgICAgICBwbHVzU2NhbGVWZWMyKHYsIGggKiBib2R5Lm1faW52TWFzcywgYm9keS5tX2ZvcmNlKTtcbiAgICAgICAgICAgIHcgKz0gaCAqIGJvZHkubV9pbnZJICogYm9keS5tX3RvcnF1ZTtcbiAgICAgICAgICAgIHNjYWxlVmVjMih2LCAxIC8gKDEgKyBoICogYm9keS5tX2xpbmVhckRhbXBpbmcpLCB2KTtcbiAgICAgICAgICAgIHcgKj0gMSAvICgxICsgaCAqIGJvZHkubV9hbmd1bGFyRGFtcGluZyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY19wb3NpdGlvbi5jLCBjKTtcbiAgICAgICAgICBib2R5LmNfcG9zaXRpb24uYSA9IGEyO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY192ZWxvY2l0eS52LCB2KTtcbiAgICAgICAgICBib2R5LmNfdmVsb2NpdHkudyA9IHc7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tpXTtcbiAgICAgICAgICBjb250YWN0LmluaXRDb25zdHJhaW50KHN0ZXApO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbaV07XG4gICAgICAgICAgY29udGFjdC5pbml0VmVsb2NpdHlDb25zdHJhaW50KHN0ZXApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tpXTtcbiAgICAgICAgICAgIGNvbnRhY3Qud2FybVN0YXJ0Q29uc3RyYWludChzdGVwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fam9pbnRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGpvaW50ID0gdGhpcy5tX2pvaW50c1tpXTtcbiAgICAgICAgICBqb2ludC5pbml0VmVsb2NpdHlDb25zdHJhaW50cyhzdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ZXAudmVsb2NpdHlJdGVyYXRpb25zOyArK2kpIHtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9qb2ludHMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIHZhciBqb2ludCA9IHRoaXMubV9qb2ludHNbal07XG4gICAgICAgICAgICBqb2ludC5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMoc3RlcCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tqXTtcbiAgICAgICAgICAgIGNvbnRhY3Quc29sdmVWZWxvY2l0eUNvbnN0cmFpbnQoc3RlcCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbaV07XG4gICAgICAgICAgY29udGFjdC5zdG9yZUNvbnN0cmFpbnRJbXB1bHNlcyhzdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9ib2RpZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgYm9keSA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgY29weVZlYzIoYywgYm9keS5jX3Bvc2l0aW9uLmMpO1xuICAgICAgICAgIHZhciBhMiA9IGJvZHkuY19wb3NpdGlvbi5hO1xuICAgICAgICAgIGNvcHlWZWMyKHYsIGJvZHkuY192ZWxvY2l0eS52KTtcbiAgICAgICAgICB2YXIgdyA9IGJvZHkuY192ZWxvY2l0eS53O1xuICAgICAgICAgIHNjYWxlVmVjMih0cmFuc2xhdGlvbiwgaCwgdik7XG4gICAgICAgICAgdmFyIHRyYW5zbGF0aW9uTGVuZ3RoU3FyID0gbGVuZ3RoU3FyVmVjMih0cmFuc2xhdGlvbik7XG4gICAgICAgICAgaWYgKHRyYW5zbGF0aW9uTGVuZ3RoU3FyID4gU2V0dGluZ3NJbnRlcm5hbC5tYXhUcmFuc2xhdGlvblNxdWFyZWQpIHtcbiAgICAgICAgICAgIHZhciByYXRpbyA9IFNldHRpbmdzSW50ZXJuYWwubWF4VHJhbnNsYXRpb24gLyBtYXRoX3NxcnQkMyh0cmFuc2xhdGlvbkxlbmd0aFNxcik7XG4gICAgICAgICAgICBtdWxWZWMyKHYsIHJhdGlvKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHJvdGF0aW9uMiA9IGggKiB3O1xuICAgICAgICAgIGlmIChyb3RhdGlvbjIgKiByb3RhdGlvbjIgPiBTZXR0aW5nc0ludGVybmFsLm1heFJvdGF0aW9uU3F1YXJlZCkge1xuICAgICAgICAgICAgdmFyIHJhdGlvID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhSb3RhdGlvbiAvIG1hdGhfYWJzJDYocm90YXRpb24yKTtcbiAgICAgICAgICAgIHcgKj0gcmF0aW87XG4gICAgICAgICAgfVxuICAgICAgICAgIHBsdXNTY2FsZVZlYzIoYywgaCwgdik7XG4gICAgICAgICAgYTIgKz0gaCAqIHc7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5jX3Bvc2l0aW9uLmMsIGMpO1xuICAgICAgICAgIGJvZHkuY19wb3NpdGlvbi5hID0gYTI7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5jX3ZlbG9jaXR5LnYsIHYpO1xuICAgICAgICAgIGJvZHkuY192ZWxvY2l0eS53ID0gdztcbiAgICAgICAgfVxuICAgICAgICB2YXIgcG9zaXRpb25Tb2x2ZWQgPSBmYWxzZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGVwLnBvc2l0aW9uSXRlcmF0aW9uczsgKytpKSB7XG4gICAgICAgICAgdmFyIG1pblNlcGFyYXRpb24gPSAwO1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tqXTtcbiAgICAgICAgICAgIHZhciBzZXBhcmF0aW9uID0gY29udGFjdC5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludChzdGVwKTtcbiAgICAgICAgICAgIG1pblNlcGFyYXRpb24gPSBtYXRoX21pbiQ1KG1pblNlcGFyYXRpb24sIHNlcGFyYXRpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgY29udGFjdHNPa2F5ID0gbWluU2VwYXJhdGlvbiA+PSAtMyAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgICAgICB2YXIgam9pbnRzT2theSA9IHRydWU7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLm1fam9pbnRzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICB2YXIgam9pbnQgPSB0aGlzLm1fam9pbnRzW2pdO1xuICAgICAgICAgICAgdmFyIGpvaW50T2theSA9IGpvaW50LnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyhzdGVwKTtcbiAgICAgICAgICAgIGpvaW50c09rYXkgPSBqb2ludHNPa2F5ICYmIGpvaW50T2theTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNvbnRhY3RzT2theSAmJiBqb2ludHNPa2F5KSB7XG4gICAgICAgICAgICBwb3NpdGlvblNvbHZlZCA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkubV9zd2VlcC5jLCBib2R5LmNfcG9zaXRpb24uYyk7XG4gICAgICAgICAgYm9keS5tX3N3ZWVwLmEgPSBib2R5LmNfcG9zaXRpb24uYTtcbiAgICAgICAgICBjb3B5VmVjMihib2R5Lm1fbGluZWFyVmVsb2NpdHksIGJvZHkuY192ZWxvY2l0eS52KTtcbiAgICAgICAgICBib2R5Lm1fYW5ndWxhclZlbG9jaXR5ID0gYm9keS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgICAgYm9keS5zeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucG9zdFNvbHZlSXNsYW5kKCk7XG4gICAgICAgIGlmIChhbGxvd1NsZWVwKSB7XG4gICAgICAgICAgdmFyIG1pblNsZWVwVGltZSA9IEluZmluaXR5O1xuICAgICAgICAgIHZhciBsaW5Ub2xTcXIgPSBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsZWVwVG9sZXJhbmNlU3FyO1xuICAgICAgICAgIHZhciBhbmdUb2xTcXIgPSBTZXR0aW5nc0ludGVybmFsLmFuZ3VsYXJTbGVlcFRvbGVyYW5jZVNxcjtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9ib2RpZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICAgIGlmIChib2R5LmlzU3RhdGljKCkpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYm9keS5tX2F1dG9TbGVlcEZsYWcgPT0gZmFsc2UgfHwgYm9keS5tX2FuZ3VsYXJWZWxvY2l0eSAqIGJvZHkubV9hbmd1bGFyVmVsb2NpdHkgPiBhbmdUb2xTcXIgfHwgbGVuZ3RoU3FyVmVjMihib2R5Lm1fbGluZWFyVmVsb2NpdHkpID4gbGluVG9sU3FyKSB7XG4gICAgICAgICAgICAgIGJvZHkubV9zbGVlcFRpbWUgPSAwO1xuICAgICAgICAgICAgICBtaW5TbGVlcFRpbWUgPSAwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgYm9keS5tX3NsZWVwVGltZSArPSBoO1xuICAgICAgICAgICAgICBtaW5TbGVlcFRpbWUgPSBtYXRoX21pbiQ1KG1pblNsZWVwVGltZSwgYm9keS5tX3NsZWVwVGltZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChtaW5TbGVlcFRpbWUgPj0gU2V0dGluZ3NJbnRlcm5hbC50aW1lVG9TbGVlcCAmJiBwb3NpdGlvblNvbHZlZCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICAgICAgYm9keS5zZXRBd2FrZShmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUuc29sdmVXb3JsZFRPSSA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHdvcmxkID0gdGhpcy5tX3dvcmxkO1xuICAgICAgICBpZiAod29ybGQubV9zdGVwQ29tcGxldGUpIHtcbiAgICAgICAgICBmb3IgKHZhciBiMiA9IHdvcmxkLm1fYm9keUxpc3Q7IGIyOyBiMiA9IGIyLm1fbmV4dCkge1xuICAgICAgICAgICAgYjIubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICBiMi5tX3N3ZWVwLmFscGhhMCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvciAodmFyIGNfMiA9IHdvcmxkLm1fY29udGFjdExpc3Q7IGNfMjsgY18yID0gY18yLm1fbmV4dCkge1xuICAgICAgICAgICAgY18yLm1fdG9pRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgY18yLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgY18yLm1fdG9pQ291bnQgPSAwO1xuICAgICAgICAgICAgY18yLm1fdG9pID0gMTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICB2YXIgbWluQ29udGFjdCA9IG51bGw7XG4gICAgICAgICAgdmFyIG1pbkFscGhhID0gMTtcbiAgICAgICAgICBmb3IgKHZhciBjXzMgPSB3b3JsZC5tX2NvbnRhY3RMaXN0OyBjXzM7IGNfMyA9IGNfMy5tX25leHQpIHtcbiAgICAgICAgICAgIGlmIChjXzMuaXNFbmFibGVkKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY18zLm1fdG9pQ291bnQgPiBTZXR0aW5nc0ludGVybmFsLm1heFN1YlN0ZXBzKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFscGhhID0gMTtcbiAgICAgICAgICAgIGlmIChjXzMubV90b2lGbGFnKSB7XG4gICAgICAgICAgICAgIGFscGhhID0gY18zLm1fdG9pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIGZBXzEgPSBjXzMuZ2V0Rml4dHVyZUEoKTtcbiAgICAgICAgICAgICAgdmFyIGZCXzEgPSBjXzMuZ2V0Rml4dHVyZUIoKTtcbiAgICAgICAgICAgICAgaWYgKGZBXzEuaXNTZW5zb3IoKSB8fCBmQl8xLmlzU2Vuc29yKCkpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgYkFfMSA9IGZBXzEuZ2V0Qm9keSgpO1xuICAgICAgICAgICAgICB2YXIgYkJfMSA9IGZCXzEuZ2V0Qm9keSgpO1xuICAgICAgICAgICAgICB2YXIgYWN0aXZlQSA9IGJBXzEuaXNBd2FrZSgpICYmICFiQV8xLmlzU3RhdGljKCk7XG4gICAgICAgICAgICAgIHZhciBhY3RpdmVCID0gYkJfMS5pc0F3YWtlKCkgJiYgIWJCXzEuaXNTdGF0aWMoKTtcbiAgICAgICAgICAgICAgaWYgKGFjdGl2ZUEgPT0gZmFsc2UgJiYgYWN0aXZlQiA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhciBjb2xsaWRlQSA9IGJBXzEuaXNCdWxsZXQoKSB8fCAhYkFfMS5pc0R5bmFtaWMoKTtcbiAgICAgICAgICAgICAgdmFyIGNvbGxpZGVCID0gYkJfMS5pc0J1bGxldCgpIHx8ICFiQl8xLmlzRHluYW1pYygpO1xuICAgICAgICAgICAgICBpZiAoY29sbGlkZUEgPT0gZmFsc2UgJiYgY29sbGlkZUIgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgYWxwaGEwID0gYkFfMS5tX3N3ZWVwLmFscGhhMDtcbiAgICAgICAgICAgICAgaWYgKGJBXzEubV9zd2VlcC5hbHBoYTAgPCBiQl8xLm1fc3dlZXAuYWxwaGEwKSB7XG4gICAgICAgICAgICAgICAgYWxwaGEwID0gYkJfMS5tX3N3ZWVwLmFscGhhMDtcbiAgICAgICAgICAgICAgICBiQV8xLm1fc3dlZXAuYWR2YW5jZShhbHBoYTApO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJCXzEubV9zd2VlcC5hbHBoYTAgPCBiQV8xLm1fc3dlZXAuYWxwaGEwKSB7XG4gICAgICAgICAgICAgICAgYWxwaGEwID0gYkFfMS5tX3N3ZWVwLmFscGhhMDtcbiAgICAgICAgICAgICAgICBiQl8xLm1fc3dlZXAuYWR2YW5jZShhbHBoYTApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhciBpbmRleEEgPSBjXzMuZ2V0Q2hpbGRJbmRleEEoKTtcbiAgICAgICAgICAgICAgdmFyIGluZGV4QiA9IGNfMy5nZXRDaGlsZEluZGV4QigpO1xuICAgICAgICAgICAgICBpbnB1dC5wcm94eUEuc2V0KGZBXzEuZ2V0U2hhcGUoKSwgaW5kZXhBKTtcbiAgICAgICAgICAgICAgaW5wdXQucHJveHlCLnNldChmQl8xLmdldFNoYXBlKCksIGluZGV4Qik7XG4gICAgICAgICAgICAgIGlucHV0LnN3ZWVwQS5zZXQoYkFfMS5tX3N3ZWVwKTtcbiAgICAgICAgICAgICAgaW5wdXQuc3dlZXBCLnNldChiQl8xLm1fc3dlZXApO1xuICAgICAgICAgICAgICBpbnB1dC50TWF4ID0gMTtcbiAgICAgICAgICAgICAgVGltZU9mSW1wYWN0KG91dHB1dCwgaW5wdXQpO1xuICAgICAgICAgICAgICB2YXIgYmV0YSA9IG91dHB1dC50O1xuICAgICAgICAgICAgICBpZiAob3V0cHV0LnN0YXRlID09IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfdG91Y2hpbmcpIHtcbiAgICAgICAgICAgICAgICBhbHBoYSA9IG1hdGhfbWluJDUoYWxwaGEwICsgKDEgLSBhbHBoYTApICogYmV0YSwgMSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWxwaGEgPSAxO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNfMy5tX3RvaSA9IGFscGhhO1xuICAgICAgICAgICAgICBjXzMubV90b2lGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhbHBoYSA8IG1pbkFscGhhKSB7XG4gICAgICAgICAgICAgIG1pbkNvbnRhY3QgPSBjXzM7XG4gICAgICAgICAgICAgIG1pbkFscGhhID0gYWxwaGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChtaW5Db250YWN0ID09IG51bGwgfHwgMSAtIDEwICogRVBTSUxPTiA8IG1pbkFscGhhKSB7XG4gICAgICAgICAgICB3b3JsZC5tX3N0ZXBDb21wbGV0ZSA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGZBID0gbWluQ29udGFjdC5nZXRGaXh0dXJlQSgpO1xuICAgICAgICAgIHZhciBmQiA9IG1pbkNvbnRhY3QuZ2V0Rml4dHVyZUIoKTtcbiAgICAgICAgICB2YXIgYkEgPSBmQS5nZXRCb2R5KCk7XG4gICAgICAgICAgdmFyIGJCID0gZkIuZ2V0Qm9keSgpO1xuICAgICAgICAgIGJhY2t1cDEuc2V0KGJBLm1fc3dlZXApO1xuICAgICAgICAgIGJhY2t1cDIuc2V0KGJCLm1fc3dlZXApO1xuICAgICAgICAgIGJBLmFkdmFuY2UobWluQWxwaGEpO1xuICAgICAgICAgIGJCLmFkdmFuY2UobWluQWxwaGEpO1xuICAgICAgICAgIG1pbkNvbnRhY3QudXBkYXRlKHdvcmxkKTtcbiAgICAgICAgICBtaW5Db250YWN0Lm1fdG9pRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICsrbWluQ29udGFjdC5tX3RvaUNvdW50O1xuICAgICAgICAgIGlmIChtaW5Db250YWN0LmlzRW5hYmxlZCgpID09IGZhbHNlIHx8IG1pbkNvbnRhY3QuaXNUb3VjaGluZygpID09IGZhbHNlKSB7XG4gICAgICAgICAgICBtaW5Db250YWN0LnNldEVuYWJsZWQoZmFsc2UpO1xuICAgICAgICAgICAgYkEubV9zd2VlcC5zZXQoYmFja3VwMSk7XG4gICAgICAgICAgICBiQi5tX3N3ZWVwLnNldChiYWNrdXAyKTtcbiAgICAgICAgICAgIGJBLnN5bmNocm9uaXplVHJhbnNmb3JtKCk7XG4gICAgICAgICAgICBiQi5zeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIGJCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgICB0aGlzLmFkZEJvZHkoYkEpO1xuICAgICAgICAgIHRoaXMuYWRkQm9keShiQik7XG4gICAgICAgICAgdGhpcy5hZGRDb250YWN0KG1pbkNvbnRhY3QpO1xuICAgICAgICAgIGJBLm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgYkIubV9pc2xhbmRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICBtaW5Db250YWN0Lm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgdmFyIGJvZGllcyA9IFtiQSwgYkJdO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgYm9keSA9IGJvZGllc1tpXTtcbiAgICAgICAgICAgIGlmIChib2R5LmlzRHluYW1pYygpKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGNlID0gYm9keS5tX2NvbnRhY3RMaXN0OyBjZTsgY2UgPSBjZS5uZXh0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSBjZS5jb250YWN0O1xuICAgICAgICAgICAgICAgIGlmIChjb250YWN0Lm1faXNsYW5kRmxhZykge1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvdGhlciA9IGNlLm90aGVyO1xuICAgICAgICAgICAgICAgIGlmIChvdGhlci5pc0R5bmFtaWMoKSAmJiAhYm9keS5pc0J1bGxldCgpICYmICFvdGhlci5pc0J1bGxldCgpKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHNlbnNvckEgPSBjb250YWN0Lm1fZml4dHVyZUEubV9pc1NlbnNvcjtcbiAgICAgICAgICAgICAgICB2YXIgc2Vuc29yQiA9IGNvbnRhY3QubV9maXh0dXJlQi5tX2lzU2Vuc29yO1xuICAgICAgICAgICAgICAgIGlmIChzZW5zb3JBIHx8IHNlbnNvckIpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBiYWNrdXAuc2V0KG90aGVyLm1fc3dlZXApO1xuICAgICAgICAgICAgICAgIGlmIChvdGhlci5tX2lzbGFuZEZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgIG90aGVyLmFkdmFuY2UobWluQWxwaGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250YWN0LnVwZGF0ZSh3b3JsZCk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRhY3QuaXNFbmFibGVkKCkgPT0gZmFsc2UgfHwgY29udGFjdC5pc1RvdWNoaW5nKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgIG90aGVyLm1fc3dlZXAuc2V0KGJhY2t1cCk7XG4gICAgICAgICAgICAgICAgICBvdGhlci5zeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnRhY3QubV9pc2xhbmRGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZENvbnRhY3QoY29udGFjdCk7XG4gICAgICAgICAgICAgICAgaWYgKG90aGVyLm1faXNsYW5kRmxhZykge1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG90aGVyLm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKCFvdGhlci5pc1N0YXRpYygpKSB7XG4gICAgICAgICAgICAgICAgICBvdGhlci5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCb2R5KG90aGVyKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBzX3N1YlN0ZXAucmVzZXQoKDEgLSBtaW5BbHBoYSkgKiBzdGVwLmR0KTtcbiAgICAgICAgICBzX3N1YlN0ZXAuZHRSYXRpbyA9IDE7XG4gICAgICAgICAgc19zdWJTdGVwLnBvc2l0aW9uSXRlcmF0aW9ucyA9IDIwO1xuICAgICAgICAgIHNfc3ViU3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnMgPSBzdGVwLnZlbG9jaXR5SXRlcmF0aW9ucztcbiAgICAgICAgICBzX3N1YlN0ZXAud2FybVN0YXJ0aW5nID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5zb2x2ZUlzbGFuZFRPSShzX3N1YlN0ZXAsIGJBLCBiQik7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgYm9keSA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgICBib2R5Lm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFib2R5LmlzRHluYW1pYygpKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYm9keS5zeW5jaHJvbml6ZUZpeHR1cmVzKCk7XG4gICAgICAgICAgICBmb3IgKHZhciBjZSA9IGJvZHkubV9jb250YWN0TGlzdDsgY2U7IGNlID0gY2UubmV4dCkge1xuICAgICAgICAgICAgICBjZS5jb250YWN0Lm1fdG9pRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICBjZS5jb250YWN0Lm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB3b3JsZC5maW5kTmV3Q29udGFjdHMoKTtcbiAgICAgICAgICBpZiAod29ybGQubV9zdWJTdGVwcGluZykge1xuICAgICAgICAgICAgd29ybGQubV9zdGVwQ29tcGxldGUgPSBmYWxzZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLnNvbHZlSXNsYW5kVE9JID0gZnVuY3Rpb24oc3ViU3RlcCwgdG9pQSwgdG9pQikge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9ib2RpZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgYm9keSA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgY29weVZlYzIoYm9keS5jX3Bvc2l0aW9uLmMsIGJvZHkubV9zd2VlcC5jKTtcbiAgICAgICAgICBib2R5LmNfcG9zaXRpb24uYSA9IGJvZHkubV9zd2VlcC5hO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY192ZWxvY2l0eS52LCBib2R5Lm1fbGluZWFyVmVsb2NpdHkpO1xuICAgICAgICAgIGJvZHkuY192ZWxvY2l0eS53ID0gYm9keS5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2ldO1xuICAgICAgICAgIGNvbnRhY3QuaW5pdENvbnN0cmFpbnQoc3ViU3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJTdGVwLnBvc2l0aW9uSXRlcmF0aW9uczsgKytpKSB7XG4gICAgICAgICAgdmFyIG1pblNlcGFyYXRpb24gPSAwO1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tqXTtcbiAgICAgICAgICAgIHZhciBzZXBhcmF0aW9uID0gY29udGFjdC5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludFRPSShzdWJTdGVwLCB0b2lBLCB0b2lCKTtcbiAgICAgICAgICAgIG1pblNlcGFyYXRpb24gPSBtYXRoX21pbiQ1KG1pblNlcGFyYXRpb24sIHNlcGFyYXRpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgY29udGFjdHNPa2F5ID0gbWluU2VwYXJhdGlvbiA+PSAtMS41ICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgICAgIGlmIChjb250YWN0c09rYXkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgaTtcbiAgICAgICAgY29weVZlYzIodG9pQS5tX3N3ZWVwLmMwLCB0b2lBLmNfcG9zaXRpb24uYyk7XG4gICAgICAgIHRvaUEubV9zd2VlcC5hMCA9IHRvaUEuY19wb3NpdGlvbi5hO1xuICAgICAgICBjb3B5VmVjMih0b2lCLm1fc3dlZXAuYzAsIHRvaUIuY19wb3NpdGlvbi5jKTtcbiAgICAgICAgdG9pQi5tX3N3ZWVwLmEwID0gdG9pQi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbaV07XG4gICAgICAgICAgY29udGFjdC5pbml0VmVsb2NpdHlDb25zdHJhaW50KHN1YlN0ZXApO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3ViU3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnM7ICsraSkge1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tqXTtcbiAgICAgICAgICAgIGNvbnRhY3Quc29sdmVWZWxvY2l0eUNvbnN0cmFpbnQoc3ViU3RlcCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBoID0gc3ViU3RlcC5kdDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgIGNvcHlWZWMyKGMsIGJvZHkuY19wb3NpdGlvbi5jKTtcbiAgICAgICAgICB2YXIgYTIgPSBib2R5LmNfcG9zaXRpb24uYTtcbiAgICAgICAgICBjb3B5VmVjMih2LCBib2R5LmNfdmVsb2NpdHkudik7XG4gICAgICAgICAgdmFyIHcgPSBib2R5LmNfdmVsb2NpdHkudztcbiAgICAgICAgICBzY2FsZVZlYzIodHJhbnNsYXRpb24sIGgsIHYpO1xuICAgICAgICAgIHZhciB0cmFuc2xhdGlvbkxlbmd0aFNxciA9IGxlbmd0aFNxclZlYzIodHJhbnNsYXRpb24pO1xuICAgICAgICAgIGlmICh0cmFuc2xhdGlvbkxlbmd0aFNxciA+IFNldHRpbmdzSW50ZXJuYWwubWF4VHJhbnNsYXRpb25TcXVhcmVkKSB7XG4gICAgICAgICAgICB2YXIgcmF0aW8gPSBTZXR0aW5nc0ludGVybmFsLm1heFRyYW5zbGF0aW9uIC8gbWF0aF9zcXJ0JDModHJhbnNsYXRpb25MZW5ndGhTcXIpO1xuICAgICAgICAgICAgbXVsVmVjMih2LCByYXRpbyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciByb3RhdGlvbjIgPSBoICogdztcbiAgICAgICAgICBpZiAocm90YXRpb24yICogcm90YXRpb24yID4gU2V0dGluZ3NJbnRlcm5hbC5tYXhSb3RhdGlvblNxdWFyZWQpIHtcbiAgICAgICAgICAgIHZhciByYXRpbyA9IFNldHRpbmdzSW50ZXJuYWwubWF4Um90YXRpb24gLyBtYXRoX2FicyQ2KHJvdGF0aW9uMik7XG4gICAgICAgICAgICB3ICo9IHJhdGlvO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwbHVzU2NhbGVWZWMyKGMsIGgsIHYpO1xuICAgICAgICAgIGEyICs9IGggKiB3O1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY19wb3NpdGlvbi5jLCBjKTtcbiAgICAgICAgICBib2R5LmNfcG9zaXRpb24uYSA9IGEyO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY192ZWxvY2l0eS52LCB2KTtcbiAgICAgICAgICBib2R5LmNfdmVsb2NpdHkudyA9IHc7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5tX3N3ZWVwLmMsIGMpO1xuICAgICAgICAgIGJvZHkubV9zd2VlcC5hID0gYTI7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5tX2xpbmVhclZlbG9jaXR5LCB2KTtcbiAgICAgICAgICBib2R5Lm1fYW5ndWxhclZlbG9jaXR5ID0gdztcbiAgICAgICAgICBib2R5LnN5bmNocm9uaXplVHJhbnNmb3JtKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wb3N0U29sdmVJc2xhbmQoKTtcbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5wb3N0U29sdmVJc2xhbmQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgZm9yICh2YXIgY181ID0gMDsgY181IDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytjXzUpIHtcbiAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tjXzVdO1xuICAgICAgICAgIHRoaXMubV93b3JsZC5wb3N0U29sdmUoY29udGFjdCwgY29udGFjdC5tX2ltcHVsc2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFNvbHZlcjI7XG4gICAgfSgpXG4gICk7XG4gIFNvbHZlci5UaW1lU3RlcCA9IFRpbWVTdGVwO1xuICB2YXIgTWF0MjIgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gTWF0MjIyKGEyLCBiMiwgYzIsIGQyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYTIgPT09IFwib2JqZWN0XCIgJiYgYTIgIT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLmV4ID0gVmVjMi5jbG9uZShhMik7XG4gICAgICAgICAgdGhpcy5leSA9IFZlYzIuY2xvbmUoYjIpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhMiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHRoaXMuZXggPSBWZWMyLm5lbyhhMiwgYzIpO1xuICAgICAgICAgIHRoaXMuZXkgPSBWZWMyLm5lbyhiMiwgZDIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZXggPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICB0aGlzLmV5ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIE1hdDIyMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMpO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5pc1ZhbGlkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gVmVjMi5pc1ZhbGlkKG9iai5leCkgJiYgVmVjMi5pc1ZhbGlkKG9iai5leSk7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLmFzc2VydCA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIH07XG4gICAgICBNYXQyMjIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKGEyLCBiMiwgYzIsIGQyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYTIgPT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGIyID09PSBcIm51bWJlclwiICYmIHR5cGVvZiBjMiA9PT0gXCJudW1iZXJcIiAmJiB0eXBlb2YgZDIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICB0aGlzLmV4LnNldE51bShhMiwgYzIpO1xuICAgICAgICAgIHRoaXMuZXkuc2V0TnVtKGIyLCBkMik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGEyID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBiMiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMuZXguc2V0VmVjMihhMik7XG4gICAgICAgICAgdGhpcy5leS5zZXRWZWMyKGIyKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYTIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLmV4LnNldFZlYzIoYTIuZXgpO1xuICAgICAgICAgIHRoaXMuZXkuc2V0VmVjMihhMi5leSk7XG4gICAgICAgIH0gZWxzZSA7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLnByb3RvdHlwZS5zZXRJZGVudGl0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmV4LnggPSAxO1xuICAgICAgICB0aGlzLmV5LnggPSAwO1xuICAgICAgICB0aGlzLmV4LnkgPSAwO1xuICAgICAgICB0aGlzLmV5LnkgPSAxO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5wcm90b3R5cGUuc2V0WmVybyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmV4LnggPSAwO1xuICAgICAgICB0aGlzLmV5LnggPSAwO1xuICAgICAgICB0aGlzLmV4LnkgPSAwO1xuICAgICAgICB0aGlzLmV5LnkgPSAwO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5wcm90b3R5cGUuZ2V0SW52ZXJzZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYTIgPSB0aGlzLmV4Lng7XG4gICAgICAgIHZhciBiMiA9IHRoaXMuZXkueDtcbiAgICAgICAgdmFyIGMyID0gdGhpcy5leC55O1xuICAgICAgICB2YXIgZDIgPSB0aGlzLmV5Lnk7XG4gICAgICAgIHZhciBkZXQgPSBhMiAqIGQyIC0gYjIgKiBjMjtcbiAgICAgICAgaWYgKGRldCAhPT0gMCkge1xuICAgICAgICAgIGRldCA9IDEgLyBkZXQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlteCA9IG5ldyBNYXQyMjIoKTtcbiAgICAgICAgaW14LmV4LnggPSBkZXQgKiBkMjtcbiAgICAgICAgaW14LmV5LnggPSAtZGV0ICogYjI7XG4gICAgICAgIGlteC5leC55ID0gLWRldCAqIGMyO1xuICAgICAgICBpbXguZXkueSA9IGRldCAqIGEyO1xuICAgICAgICByZXR1cm4gaW14O1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5wcm90b3R5cGUuc29sdmUgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICB2YXIgYTIgPSB0aGlzLmV4Lng7XG4gICAgICAgIHZhciBiMiA9IHRoaXMuZXkueDtcbiAgICAgICAgdmFyIGMyID0gdGhpcy5leC55O1xuICAgICAgICB2YXIgZDIgPSB0aGlzLmV5Lnk7XG4gICAgICAgIHZhciBkZXQgPSBhMiAqIGQyIC0gYjIgKiBjMjtcbiAgICAgICAgaWYgKGRldCAhPT0gMCkge1xuICAgICAgICAgIGRldCA9IDEgLyBkZXQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHcgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdy54ID0gZGV0ICogKGQyICogdjMueCAtIGIyICogdjMueSk7XG4gICAgICAgIHcueSA9IGRldCAqIChhMiAqIHYzLnkgLSBjMiAqIHYzLngpO1xuICAgICAgICByZXR1cm4gdztcbiAgICAgIH07XG4gICAgICBNYXQyMjIubXVsID0gZnVuY3Rpb24obXgsIHYzKSB7XG4gICAgICAgIGlmICh2MyAmJiBcInhcIiBpbiB2MyAmJiBcInlcIiBpbiB2Mykge1xuICAgICAgICAgIHZhciB4MiA9IG14LmV4LnggKiB2My54ICsgbXguZXkueCAqIHYzLnk7XG4gICAgICAgICAgdmFyIHkgPSBteC5leC55ICogdjMueCArIG14LmV5LnkgKiB2My55O1xuICAgICAgICAgIHJldHVybiBWZWMyLm5lbyh4MiwgeSk7XG4gICAgICAgIH0gZWxzZSBpZiAodjMgJiYgXCJleFwiIGluIHYzICYmIFwiZXlcIiBpbiB2Mykge1xuICAgICAgICAgIHZhciBhMiA9IG14LmV4LnggKiB2My5leC54ICsgbXguZXkueCAqIHYzLmV4Lnk7XG4gICAgICAgICAgdmFyIGIyID0gbXguZXgueCAqIHYzLmV5LnggKyBteC5leS54ICogdjMuZXkueTtcbiAgICAgICAgICB2YXIgYzIgPSBteC5leC55ICogdjMuZXgueCArIG14LmV5LnkgKiB2My5leC55O1xuICAgICAgICAgIHZhciBkMiA9IG14LmV4LnkgKiB2My5leS54ICsgbXguZXkueSAqIHYzLmV5Lnk7XG4gICAgICAgICAgcmV0dXJuIG5ldyBNYXQyMjIoYTIsIGIyLCBjMiwgZDIpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgTWF0MjIyLm11bFZlYzIgPSBmdW5jdGlvbihteCwgdjMpIHtcbiAgICAgICAgdmFyIHgyID0gbXguZXgueCAqIHYzLnggKyBteC5leS54ICogdjMueTtcbiAgICAgICAgdmFyIHkgPSBteC5leC55ICogdjMueCArIG14LmV5LnkgKiB2My55O1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5tdWxNYXQyMiA9IGZ1bmN0aW9uKG14LCB2Mykge1xuICAgICAgICB2YXIgYTIgPSBteC5leC54ICogdjMuZXgueCArIG14LmV5LnggKiB2My5leC55O1xuICAgICAgICB2YXIgYjIgPSBteC5leC54ICogdjMuZXkueCArIG14LmV5LnggKiB2My5leS55O1xuICAgICAgICB2YXIgYzIgPSBteC5leC55ICogdjMuZXgueCArIG14LmV5LnkgKiB2My5leC55O1xuICAgICAgICB2YXIgZDIgPSBteC5leC55ICogdjMuZXkueCArIG14LmV5LnkgKiB2My5leS55O1xuICAgICAgICByZXR1cm4gbmV3IE1hdDIyMihhMiwgYjIsIGMyLCBkMik7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLm11bFQgPSBmdW5jdGlvbihteCwgdjMpIHtcbiAgICAgICAgaWYgKHYzICYmIFwieFwiIGluIHYzICYmIFwieVwiIGluIHYzKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIubmVvKFZlYzIuZG90KHYzLCBteC5leCksIFZlYzIuZG90KHYzLCBteC5leSkpO1xuICAgICAgICB9IGVsc2UgaWYgKHYzICYmIFwiZXhcIiBpbiB2MyAmJiBcImV5XCIgaW4gdjMpIHtcbiAgICAgICAgICB2YXIgYzEgPSBWZWMyLm5lbyhWZWMyLmRvdChteC5leCwgdjMuZXgpLCBWZWMyLmRvdChteC5leSwgdjMuZXgpKTtcbiAgICAgICAgICB2YXIgYzIgPSBWZWMyLm5lbyhWZWMyLmRvdChteC5leCwgdjMuZXkpLCBWZWMyLmRvdChteC5leSwgdjMuZXkpKTtcbiAgICAgICAgICByZXR1cm4gbmV3IE1hdDIyMihjMSwgYzIpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgTWF0MjIyLm11bFRWZWMyID0gZnVuY3Rpb24obXgsIHYzKSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyhWZWMyLmRvdCh2MywgbXguZXgpLCBWZWMyLmRvdCh2MywgbXguZXkpKTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIubXVsVE1hdDIyID0gZnVuY3Rpb24obXgsIHYzKSB7XG4gICAgICAgIHZhciBjMSA9IFZlYzIubmVvKFZlYzIuZG90KG14LmV4LCB2My5leCksIFZlYzIuZG90KG14LmV5LCB2My5leCkpO1xuICAgICAgICB2YXIgYzIgPSBWZWMyLm5lbyhWZWMyLmRvdChteC5leCwgdjMuZXkpLCBWZWMyLmRvdChteC5leSwgdjMuZXkpKTtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXQyMjIoYzEsIGMyKTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIuYWJzID0gZnVuY3Rpb24obXgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXQyMjIoVmVjMi5hYnMobXguZXgpLCBWZWMyLmFicyhteC5leSkpO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5hZGQgPSBmdW5jdGlvbihteDEsIG14Mikge1xuICAgICAgICByZXR1cm4gbmV3IE1hdDIyMihWZWMyLmFkZChteDEuZXgsIG14Mi5leCksIFZlYzIuYWRkKG14MS5leSwgbXgyLmV5KSk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIE1hdDIyMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfc3FydCQyID0gTWF0aC5zcXJ0O1xuICB2YXIgcG9pbnRBJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgcG9pbnRCJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgdGVtcCQzID0gdmVjMigwLCAwKTtcbiAgdmFyIGNBJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgY0IkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBkaXN0ID0gdmVjMigwLCAwKTtcbiAgdmFyIHBsYW5lUG9pbnQkMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBjbGlwUG9pbnQkMSA9IHZlYzIoMCwgMCk7XG4gIGV4cG9ydHMyLk1hbmlmb2xkVHlwZSA9IHZvaWQgMDtcbiAgKGZ1bmN0aW9uKE1hbmlmb2xkVHlwZTIpIHtcbiAgICBNYW5pZm9sZFR5cGUyW01hbmlmb2xkVHlwZTJbXCJlX3Vuc2V0XCJdID0gLTFdID0gXCJlX3Vuc2V0XCI7XG4gICAgTWFuaWZvbGRUeXBlMltNYW5pZm9sZFR5cGUyW1wiZV9jaXJjbGVzXCJdID0gMF0gPSBcImVfY2lyY2xlc1wiO1xuICAgIE1hbmlmb2xkVHlwZTJbTWFuaWZvbGRUeXBlMltcImVfZmFjZUFcIl0gPSAxXSA9IFwiZV9mYWNlQVwiO1xuICAgIE1hbmlmb2xkVHlwZTJbTWFuaWZvbGRUeXBlMltcImVfZmFjZUJcIl0gPSAyXSA9IFwiZV9mYWNlQlwiO1xuICB9KShleHBvcnRzMi5NYW5pZm9sZFR5cGUgfHwgKGV4cG9ydHMyLk1hbmlmb2xkVHlwZSA9IHt9KSk7XG4gIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZSA9IHZvaWQgMDtcbiAgKGZ1bmN0aW9uKENvbnRhY3RGZWF0dXJlVHlwZTIpIHtcbiAgICBDb250YWN0RmVhdHVyZVR5cGUyW0NvbnRhY3RGZWF0dXJlVHlwZTJbXCJlX3Vuc2V0XCJdID0gLTFdID0gXCJlX3Vuc2V0XCI7XG4gICAgQ29udGFjdEZlYXR1cmVUeXBlMltDb250YWN0RmVhdHVyZVR5cGUyW1wiZV92ZXJ0ZXhcIl0gPSAwXSA9IFwiZV92ZXJ0ZXhcIjtcbiAgICBDb250YWN0RmVhdHVyZVR5cGUyW0NvbnRhY3RGZWF0dXJlVHlwZTJbXCJlX2ZhY2VcIl0gPSAxXSA9IFwiZV9mYWNlXCI7XG4gIH0pKGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZSB8fCAoZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlID0ge30pKTtcbiAgZXhwb3J0czIuUG9pbnRTdGF0ZSA9IHZvaWQgMDtcbiAgKGZ1bmN0aW9uKFBvaW50U3RhdGUyKSB7XG4gICAgUG9pbnRTdGF0ZTJbUG9pbnRTdGF0ZTJbXCJudWxsU3RhdGVcIl0gPSAwXSA9IFwibnVsbFN0YXRlXCI7XG4gICAgUG9pbnRTdGF0ZTJbUG9pbnRTdGF0ZTJbXCJhZGRTdGF0ZVwiXSA9IDFdID0gXCJhZGRTdGF0ZVwiO1xuICAgIFBvaW50U3RhdGUyW1BvaW50U3RhdGUyW1wicGVyc2lzdFN0YXRlXCJdID0gMl0gPSBcInBlcnNpc3RTdGF0ZVwiO1xuICAgIFBvaW50U3RhdGUyW1BvaW50U3RhdGUyW1wicmVtb3ZlU3RhdGVcIl0gPSAzXSA9IFwicmVtb3ZlU3RhdGVcIjtcbiAgfSkoZXhwb3J0czIuUG9pbnRTdGF0ZSB8fCAoZXhwb3J0czIuUG9pbnRTdGF0ZSA9IHt9KSk7XG4gIHZhciBDbGlwVmVydGV4ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIENsaXBWZXJ0ZXgyKCkge1xuICAgICAgICB0aGlzLnYgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLmlkID0gbmV3IENvbnRhY3RJRCgpO1xuICAgICAgfVxuICAgICAgQ2xpcFZlcnRleDIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgICAgY29weVZlYzIodGhpcy52LCBvLnYpO1xuICAgICAgICB0aGlzLmlkLnNldChvLmlkKTtcbiAgICAgIH07XG4gICAgICBDbGlwVmVydGV4Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnYpO1xuICAgICAgICB0aGlzLmlkLnJlY3ljbGUoKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gQ2xpcFZlcnRleDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBNYW5pZm9sZCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBNYW5pZm9sZDIoKSB7XG4gICAgICAgIHRoaXMubG9jYWxOb3JtYWwgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLmxvY2FsUG9pbnQgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnBvaW50cyA9IFtuZXcgTWFuaWZvbGRQb2ludCgpLCBuZXcgTWFuaWZvbGRQb2ludCgpXTtcbiAgICAgICAgdGhpcy5wb2ludENvdW50ID0gMDtcbiAgICAgIH1cbiAgICAgIE1hbmlmb2xkMi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24odGhhdCkge1xuICAgICAgICB0aGlzLnR5cGUgPSB0aGF0LnR5cGU7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMubG9jYWxOb3JtYWwsIHRoYXQubG9jYWxOb3JtYWwpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmxvY2FsUG9pbnQsIHRoYXQubG9jYWxQb2ludCk7XG4gICAgICAgIHRoaXMucG9pbnRDb3VudCA9IHRoYXQucG9pbnRDb3VudDtcbiAgICAgICAgdGhpcy5wb2ludHNbMF0uc2V0KHRoYXQucG9pbnRzWzBdKTtcbiAgICAgICAgdGhpcy5wb2ludHNbMV0uc2V0KHRoYXQucG9pbnRzWzFdKTtcbiAgICAgIH07XG4gICAgICBNYW5pZm9sZDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfdW5zZXQ7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubG9jYWxOb3JtYWwpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLmxvY2FsUG9pbnQpO1xuICAgICAgICB0aGlzLnBvaW50Q291bnQgPSAwO1xuICAgICAgICB0aGlzLnBvaW50c1swXS5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMucG9pbnRzWzFdLnJlY3ljbGUoKTtcbiAgICAgIH07XG4gICAgICBNYW5pZm9sZDIucHJvdG90eXBlLmdldFdvcmxkTWFuaWZvbGQgPSBmdW5jdGlvbih3bSwgeGZBMiwgcmFkaXVzQSwgeGZCMiwgcmFkaXVzQikge1xuICAgICAgICBpZiAodGhpcy5wb2ludENvdW50ID09IDApIHtcbiAgICAgICAgICByZXR1cm4gd207XG4gICAgICAgIH1cbiAgICAgICAgd20gPSB3bSB8fCBuZXcgV29ybGRNYW5pZm9sZCgpO1xuICAgICAgICB3bS5wb2ludENvdW50ID0gdGhpcy5wb2ludENvdW50O1xuICAgICAgICB2YXIgbm9ybWFsMyA9IHdtLm5vcm1hbDtcbiAgICAgICAgdmFyIHBvaW50cyA9IHdtLnBvaW50cztcbiAgICAgICAgdmFyIHNlcGFyYXRpb25zID0gd20uc2VwYXJhdGlvbnM7XG4gICAgICAgIHN3aXRjaCAodGhpcy50eXBlKSB7XG4gICAgICAgICAgY2FzZSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9jaXJjbGVzOiB7XG4gICAgICAgICAgICBzZXRWZWMyKG5vcm1hbDMsIDEsIDApO1xuICAgICAgICAgICAgdmFyIG1hbmlmb2xkUG9pbnQgPSB0aGlzLnBvaW50c1swXTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRBJDEsIHhmQTIsIHRoaXMubG9jYWxQb2ludCk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QiQxLCB4ZkIyLCBtYW5pZm9sZFBvaW50LmxvY2FsUG9pbnQpO1xuICAgICAgICAgICAgc3ViVmVjMihkaXN0LCBwb2ludEIkMSwgcG9pbnRBJDEpO1xuICAgICAgICAgICAgdmFyIGxlbmd0aFNxciA9IGxlbmd0aFNxclZlYzIoZGlzdCk7XG4gICAgICAgICAgICBpZiAobGVuZ3RoU3FyID4gRVBTSUxPTiAqIEVQU0lMT04pIHtcbiAgICAgICAgICAgICAgdmFyIGxlbmd0aF8xID0gbWF0aF9zcXJ0JDIobGVuZ3RoU3FyKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbDMsIDEgLyBsZW5ndGhfMSwgZGlzdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb21iaW5lMlZlYzIoY0EkMSwgMSwgcG9pbnRBJDEsIHJhZGl1c0EsIG5vcm1hbDMpO1xuICAgICAgICAgICAgY29tYmluZTJWZWMyKGNCJDEsIDEsIHBvaW50QiQxLCAtcmFkaXVzQiwgbm9ybWFsMyk7XG4gICAgICAgICAgICBjb21iaW5lMlZlYzIocG9pbnRzWzBdLCAwLjUsIGNBJDEsIDAuNSwgY0IkMSk7XG4gICAgICAgICAgICBzZXBhcmF0aW9uc1swXSA9IGRvdFZlYzIoc3ViVmVjMih0ZW1wJDMsIGNCJDEsIGNBJDEpLCBub3JtYWwzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBOiB7XG4gICAgICAgICAgICByb3RWZWMyKG5vcm1hbDMsIHhmQTIucSwgdGhpcy5sb2NhbE5vcm1hbCk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBsYW5lUG9pbnQkMiwgeGZBMiwgdGhpcy5sb2NhbFBvaW50KTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wb2ludENvdW50OyArK2kpIHtcbiAgICAgICAgICAgICAgdmFyIG1hbmlmb2xkUG9pbnQgPSB0aGlzLnBvaW50c1tpXTtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihjbGlwUG9pbnQkMSwgeGZCMiwgbWFuaWZvbGRQb2ludC5sb2NhbFBvaW50KTtcbiAgICAgICAgICAgICAgY29tYmluZTJWZWMyKGNBJDEsIDEsIGNsaXBQb2ludCQxLCByYWRpdXNBIC0gZG90VmVjMihzdWJWZWMyKHRlbXAkMywgY2xpcFBvaW50JDEsIHBsYW5lUG9pbnQkMiksIG5vcm1hbDMpLCBub3JtYWwzKTtcbiAgICAgICAgICAgICAgY29tYmluZTJWZWMyKGNCJDEsIDEsIGNsaXBQb2ludCQxLCAtcmFkaXVzQiwgbm9ybWFsMyk7XG4gICAgICAgICAgICAgIGNvbWJpbmUyVmVjMihwb2ludHNbaV0sIDAuNSwgY0EkMSwgMC41LCBjQiQxKTtcbiAgICAgICAgICAgICAgc2VwYXJhdGlvbnNbaV0gPSBkb3RWZWMyKHN1YlZlYzIodGVtcCQzLCBjQiQxLCBjQSQxKSwgbm9ybWFsMyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQjoge1xuICAgICAgICAgICAgcm90VmVjMihub3JtYWwzLCB4ZkIyLnEsIHRoaXMubG9jYWxOb3JtYWwpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwbGFuZVBvaW50JDIsIHhmQjIsIHRoaXMubG9jYWxQb2ludCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucG9pbnRDb3VudDsgKytpKSB7XG4gICAgICAgICAgICAgIHZhciBtYW5pZm9sZFBvaW50ID0gdGhpcy5wb2ludHNbaV07XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIoY2xpcFBvaW50JDEsIHhmQTIsIG1hbmlmb2xkUG9pbnQubG9jYWxQb2ludCk7XG4gICAgICAgICAgICAgIGNvbWJpbmUyVmVjMihjQiQxLCAxLCBjbGlwUG9pbnQkMSwgcmFkaXVzQiAtIGRvdFZlYzIoc3ViVmVjMih0ZW1wJDMsIGNsaXBQb2ludCQxLCBwbGFuZVBvaW50JDIpLCBub3JtYWwzKSwgbm9ybWFsMyk7XG4gICAgICAgICAgICAgIGNvbWJpbmUyVmVjMihjQSQxLCAxLCBjbGlwUG9pbnQkMSwgLXJhZGl1c0EsIG5vcm1hbDMpO1xuICAgICAgICAgICAgICBjb21iaW5lMlZlYzIocG9pbnRzW2ldLCAwLjUsIGNBJDEsIDAuNSwgY0IkMSk7XG4gICAgICAgICAgICAgIHNlcGFyYXRpb25zW2ldID0gZG90VmVjMihzdWJWZWMyKHRlbXAkMywgY0EkMSwgY0IkMSksIG5vcm1hbDMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmVnVmVjMihub3JtYWwzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gd207XG4gICAgICB9O1xuICAgICAgTWFuaWZvbGQyLmNsaXBTZWdtZW50VG9MaW5lID0gY2xpcFNlZ21lbnRUb0xpbmU7XG4gICAgICBNYW5pZm9sZDIuQ2xpcFZlcnRleCA9IENsaXBWZXJ0ZXg7XG4gICAgICBNYW5pZm9sZDIuZ2V0UG9pbnRTdGF0ZXMgPSBnZXRQb2ludFN0YXRlcztcbiAgICAgIE1hbmlmb2xkMi5Qb2ludFN0YXRlID0gZXhwb3J0czIuUG9pbnRTdGF0ZTtcbiAgICAgIHJldHVybiBNYW5pZm9sZDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBNYW5pZm9sZFBvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIE1hbmlmb2xkUG9pbnQyKCkge1xuICAgICAgICB0aGlzLmxvY2FsUG9pbnQgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLm5vcm1hbEltcHVsc2UgPSAwO1xuICAgICAgICB0aGlzLnRhbmdlbnRJbXB1bHNlID0gMDtcbiAgICAgICAgdGhpcy5pZCA9IG5ldyBDb250YWN0SUQoKTtcbiAgICAgIH1cbiAgICAgIE1hbmlmb2xkUG9pbnQyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih0aGF0KSB7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMubG9jYWxQb2ludCwgdGhhdC5sb2NhbFBvaW50KTtcbiAgICAgICAgdGhpcy5ub3JtYWxJbXB1bHNlID0gdGhhdC5ub3JtYWxJbXB1bHNlO1xuICAgICAgICB0aGlzLnRhbmdlbnRJbXB1bHNlID0gdGhhdC50YW5nZW50SW1wdWxzZTtcbiAgICAgICAgdGhpcy5pZC5zZXQodGhhdC5pZCk7XG4gICAgICB9O1xuICAgICAgTWFuaWZvbGRQb2ludDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5sb2NhbFBvaW50KTtcbiAgICAgICAgdGhpcy5ub3JtYWxJbXB1bHNlID0gMDtcbiAgICAgICAgdGhpcy50YW5nZW50SW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMuaWQucmVjeWNsZSgpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBNYW5pZm9sZFBvaW50MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIENvbnRhY3RJRCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBDb250YWN0SUQyKCkge1xuICAgICAgICB0aGlzLmtleSA9IC0xO1xuICAgICAgICB0aGlzLmluZGV4QSA9IC0xO1xuICAgICAgICB0aGlzLmluZGV4QiA9IC0xO1xuICAgICAgICB0aGlzLnR5cGVBID0gZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdW5zZXQ7XG4gICAgICAgIHRoaXMudHlwZUIgPSBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV91bnNldDtcbiAgICAgIH1cbiAgICAgIENvbnRhY3RJRDIucHJvdG90eXBlLnNldEZlYXR1cmVzID0gZnVuY3Rpb24oaW5kZXhBLCB0eXBlQSwgaW5kZXhCLCB0eXBlQikge1xuICAgICAgICB0aGlzLmluZGV4QSA9IGluZGV4QTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSBpbmRleEI7XG4gICAgICAgIHRoaXMudHlwZUEgPSB0eXBlQTtcbiAgICAgICAgdGhpcy50eXBlQiA9IHR5cGVCO1xuICAgICAgICB0aGlzLmtleSA9IHRoaXMuaW5kZXhBICsgdGhpcy5pbmRleEIgKiA0ICsgdGhpcy50eXBlQSAqIDE2ICsgdGhpcy50eXBlQiAqIDY0O1xuICAgICAgfTtcbiAgICAgIENvbnRhY3RJRDIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRoYXQpIHtcbiAgICAgICAgdGhpcy5pbmRleEEgPSB0aGF0LmluZGV4QTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSB0aGF0LmluZGV4QjtcbiAgICAgICAgdGhpcy50eXBlQSA9IHRoYXQudHlwZUE7XG4gICAgICAgIHRoaXMudHlwZUIgPSB0aGF0LnR5cGVCO1xuICAgICAgICB0aGlzLmtleSA9IHRoaXMuaW5kZXhBICsgdGhpcy5pbmRleEIgKiA0ICsgdGhpcy50eXBlQSAqIDE2ICsgdGhpcy50eXBlQiAqIDY0O1xuICAgICAgfTtcbiAgICAgIENvbnRhY3RJRDIucHJvdG90eXBlLnN3YXBGZWF0dXJlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaW5kZXhBID0gdGhpcy5pbmRleEE7XG4gICAgICAgIHZhciBpbmRleEIgPSB0aGlzLmluZGV4QjtcbiAgICAgICAgdmFyIHR5cGVBID0gdGhpcy50eXBlQTtcbiAgICAgICAgdmFyIHR5cGVCID0gdGhpcy50eXBlQjtcbiAgICAgICAgdGhpcy5pbmRleEEgPSBpbmRleEI7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gaW5kZXhBO1xuICAgICAgICB0aGlzLnR5cGVBID0gdHlwZUI7XG4gICAgICAgIHRoaXMudHlwZUIgPSB0eXBlQTtcbiAgICAgICAgdGhpcy5rZXkgPSB0aGlzLmluZGV4QSArIHRoaXMuaW5kZXhCICogNCArIHRoaXMudHlwZUEgKiAxNiArIHRoaXMudHlwZUIgKiA2NDtcbiAgICAgIH07XG4gICAgICBDb250YWN0SUQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gMDtcbiAgICAgICAgdGhpcy5pbmRleEIgPSAwO1xuICAgICAgICB0aGlzLnR5cGVBID0gZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdW5zZXQ7XG4gICAgICAgIHRoaXMudHlwZUIgPSBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV91bnNldDtcbiAgICAgICAgdGhpcy5rZXkgPSAtMTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gQ29udGFjdElEMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFdvcmxkTWFuaWZvbGQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gV29ybGRNYW5pZm9sZDIoKSB7XG4gICAgICAgIHRoaXMubm9ybWFsID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5wb2ludHMgPSBbdmVjMigwLCAwKSwgdmVjMigwLCAwKV07XG4gICAgICAgIHRoaXMuc2VwYXJhdGlvbnMgPSBbMCwgMF07XG4gICAgICAgIHRoaXMucG9pbnRDb3VudCA9IDA7XG4gICAgICB9XG4gICAgICBXb3JsZE1hbmlmb2xkMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB6ZXJvVmVjMih0aGlzLm5vcm1hbCk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMucG9pbnRzWzBdKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5wb2ludHNbMV0pO1xuICAgICAgICB0aGlzLnNlcGFyYXRpb25zWzBdID0gMDtcbiAgICAgICAgdGhpcy5zZXBhcmF0aW9uc1sxXSA9IDA7XG4gICAgICAgIHRoaXMucG9pbnRDb3VudCA9IDA7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFdvcmxkTWFuaWZvbGQyO1xuICAgIH0oKVxuICApO1xuICBmdW5jdGlvbiBnZXRQb2ludFN0YXRlcyhzdGF0ZTEsIHN0YXRlMiwgbWFuaWZvbGQxLCBtYW5pZm9sZDIpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hbmlmb2xkMS5wb2ludENvdW50OyArK2kpIHtcbiAgICAgIHZhciBpZCA9IG1hbmlmb2xkMS5wb2ludHNbaV0uaWQ7XG4gICAgICBzdGF0ZTFbaV0gPSBleHBvcnRzMi5Qb2ludFN0YXRlLnJlbW92ZVN0YXRlO1xuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBtYW5pZm9sZDIucG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgIGlmIChtYW5pZm9sZDIucG9pbnRzW2pdLmlkLmtleSA9PT0gaWQua2V5KSB7XG4gICAgICAgICAgc3RhdGUxW2ldID0gZXhwb3J0czIuUG9pbnRTdGF0ZS5wZXJzaXN0U3RhdGU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYW5pZm9sZDIucG9pbnRDb3VudDsgKytpKSB7XG4gICAgICB2YXIgaWQgPSBtYW5pZm9sZDIucG9pbnRzW2ldLmlkO1xuICAgICAgc3RhdGUyW2ldID0gZXhwb3J0czIuUG9pbnRTdGF0ZS5hZGRTdGF0ZTtcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbWFuaWZvbGQxLnBvaW50Q291bnQ7ICsraikge1xuICAgICAgICBpZiAobWFuaWZvbGQxLnBvaW50c1tqXS5pZC5rZXkgPT09IGlkLmtleSkge1xuICAgICAgICAgIHN0YXRlMltpXSA9IGV4cG9ydHMyLlBvaW50U3RhdGUucGVyc2lzdFN0YXRlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGNsaXBTZWdtZW50VG9MaW5lKHZPdXQsIHZJbiwgbm9ybWFsMywgb2Zmc2V0LCB2ZXJ0ZXhJbmRleEEpIHtcbiAgICB2YXIgbnVtT3V0ID0gMDtcbiAgICB2YXIgZGlzdGFuY2UwID0gZG90VmVjMihub3JtYWwzLCB2SW5bMF0udikgLSBvZmZzZXQ7XG4gICAgdmFyIGRpc3RhbmNlMSA9IGRvdFZlYzIobm9ybWFsMywgdkluWzFdLnYpIC0gb2Zmc2V0O1xuICAgIGlmIChkaXN0YW5jZTAgPD0gMClcbiAgICAgIHZPdXRbbnVtT3V0KytdLnNldCh2SW5bMF0pO1xuICAgIGlmIChkaXN0YW5jZTEgPD0gMClcbiAgICAgIHZPdXRbbnVtT3V0KytdLnNldCh2SW5bMV0pO1xuICAgIGlmIChkaXN0YW5jZTAgKiBkaXN0YW5jZTEgPCAwKSB7XG4gICAgICB2YXIgaW50ZXJwID0gZGlzdGFuY2UwIC8gKGRpc3RhbmNlMCAtIGRpc3RhbmNlMSk7XG4gICAgICBjb21iaW5lMlZlYzIodk91dFtudW1PdXRdLnYsIDEgLSBpbnRlcnAsIHZJblswXS52LCBpbnRlcnAsIHZJblsxXS52KTtcbiAgICAgIHZPdXRbbnVtT3V0XS5pZC5zZXRGZWF0dXJlcyh2ZXJ0ZXhJbmRleEEsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgdkluWzBdLmlkLmluZGV4QiwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfZmFjZSk7XG4gICAgICArK251bU91dDtcbiAgICB9XG4gICAgcmV0dXJuIG51bU91dDtcbiAgfVxuICB2YXIgbWF0aF9zcXJ0JDEgPSBNYXRoLnNxcnQ7XG4gIHZhciBtYXRoX21heCQyID0gTWF0aC5tYXg7XG4gIHZhciBtYXRoX21pbiQ0ID0gTWF0aC5taW47XG4gIHZhciBjb250YWN0UG9vbCA9IG5ldyBQb29sKHtcbiAgICBjcmVhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5ldyBDb250YWN0KCk7XG4gICAgfSxcbiAgICByZWxlYXNlOiBmdW5jdGlvbihjb250YWN0KSB7XG4gICAgICBjb250YWN0LnJlY3ljbGUoKTtcbiAgICB9XG4gIH0pO1xuICB2YXIgb2xkTWFuaWZvbGQgPSBuZXcgTWFuaWZvbGQoKTtcbiAgdmFyIHdvcmxkTWFuaWZvbGQgPSBuZXcgV29ybGRNYW5pZm9sZCgpO1xuICB2YXIgQ29udGFjdEVkZ2UgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gQ29udGFjdEVkZ2UyKGNvbnRhY3QpIHtcbiAgICAgICAgdGhpcy5wcmV2ID0gbnVsbDtcbiAgICAgICAgdGhpcy5uZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5vdGhlciA9IG51bGw7XG4gICAgICAgIHRoaXMuY29udGFjdCA9IGNvbnRhY3Q7XG4gICAgICB9XG4gICAgICBDb250YWN0RWRnZTIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5wcmV2ID0gbnVsbDtcbiAgICAgICAgdGhpcy5uZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5vdGhlciA9IG51bGw7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIENvbnRhY3RFZGdlMjtcbiAgICB9KClcbiAgKTtcbiAgZnVuY3Rpb24gbWl4RnJpY3Rpb24oZnJpY3Rpb24xLCBmcmljdGlvbjIpIHtcbiAgICByZXR1cm4gbWF0aF9zcXJ0JDEoZnJpY3Rpb24xICogZnJpY3Rpb24yKTtcbiAgfVxuICBmdW5jdGlvbiBtaXhSZXN0aXR1dGlvbihyZXN0aXR1dGlvbjEsIHJlc3RpdHV0aW9uMikge1xuICAgIHJldHVybiByZXN0aXR1dGlvbjEgPiByZXN0aXR1dGlvbjIgPyByZXN0aXR1dGlvbjEgOiByZXN0aXR1dGlvbjI7XG4gIH1cbiAgdmFyIHNfcmVnaXN0ZXJzID0gW107XG4gIHZhciBWZWxvY2l0eUNvbnN0cmFpbnRQb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBWZWxvY2l0eUNvbnN0cmFpbnRQb2ludDIoKSB7XG4gICAgICAgIHRoaXMuckEgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnJCID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5ub3JtYWxJbXB1bHNlID0gMDtcbiAgICAgICAgdGhpcy50YW5nZW50SW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMubm9ybWFsTWFzcyA9IDA7XG4gICAgICAgIHRoaXMudGFuZ2VudE1hc3MgPSAwO1xuICAgICAgICB0aGlzLnZlbG9jaXR5QmlhcyA9IDA7XG4gICAgICB9XG4gICAgICBWZWxvY2l0eUNvbnN0cmFpbnRQb2ludDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5yQSk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMuckIpO1xuICAgICAgICB0aGlzLm5vcm1hbEltcHVsc2UgPSAwO1xuICAgICAgICB0aGlzLnRhbmdlbnRJbXB1bHNlID0gMDtcbiAgICAgICAgdGhpcy5ub3JtYWxNYXNzID0gMDtcbiAgICAgICAgdGhpcy50YW5nZW50TWFzcyA9IDA7XG4gICAgICAgIHRoaXMudmVsb2NpdHlCaWFzID0gMDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVmVsb2NpdHlDb25zdHJhaW50UG9pbnQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgY0EgPSB2ZWMyKDAsIDApO1xuICB2YXIgdkEgPSB2ZWMyKDAsIDApO1xuICB2YXIgY0IgPSB2ZWMyKDAsIDApO1xuICB2YXIgdkIgPSB2ZWMyKDAsIDApO1xuICB2YXIgdGFuZ2VudCQxID0gdmVjMigwLCAwKTtcbiAgdmFyIHhmQSA9IHRyYW5zZm9ybSgwLCAwLCAwKTtcbiAgdmFyIHhmQiA9IHRyYW5zZm9ybSgwLCAwLCAwKTtcbiAgdmFyIHBvaW50QSA9IHZlYzIoMCwgMCk7XG4gIHZhciBwb2ludEIgPSB2ZWMyKDAsIDApO1xuICB2YXIgY2xpcFBvaW50ID0gdmVjMigwLCAwKTtcbiAgdmFyIHBsYW5lUG9pbnQkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciByQSA9IHZlYzIoMCwgMCk7XG4gIHZhciByQiA9IHZlYzIoMCwgMCk7XG4gIHZhciBQJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgbm9ybWFsJDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgcG9pbnQgPSB2ZWMyKDAsIDApO1xuICB2YXIgZHYgPSB2ZWMyKDAsIDApO1xuICB2YXIgZHYxID0gdmVjMigwLCAwKTtcbiAgdmFyIGR2MiA9IHZlYzIoMCwgMCk7XG4gIHZhciBiID0gdmVjMigwLCAwKTtcbiAgdmFyIGEgPSB2ZWMyKDAsIDApO1xuICB2YXIgeCA9IHZlYzIoMCwgMCk7XG4gIHZhciBkID0gdmVjMigwLCAwKTtcbiAgdmFyIFAxID0gdmVjMigwLCAwKTtcbiAgdmFyIFAyID0gdmVjMigwLCAwKTtcbiAgdmFyIHRlbXAkMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBDb250YWN0ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIENvbnRhY3QyKCkge1xuICAgICAgICB0aGlzLm1fbm9kZUEgPSBuZXcgQ29udGFjdEVkZ2UodGhpcyk7XG4gICAgICAgIHRoaXMubV9ub2RlQiA9IG5ldyBDb250YWN0RWRnZSh0aGlzKTtcbiAgICAgICAgdGhpcy5tX2ZpeHR1cmVBID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2ZpeHR1cmVCID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2luZGV4QSA9IC0xO1xuICAgICAgICB0aGlzLm1faW5kZXhCID0gLTE7XG4gICAgICAgIHRoaXMubV9ldmFsdWF0ZUZjbiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9tYW5pZm9sZCA9IG5ldyBNYW5pZm9sZCgpO1xuICAgICAgICB0aGlzLm1fcHJldiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3RvaSA9IDE7XG4gICAgICAgIHRoaXMubV90b2lDb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV90b2lGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9mcmljdGlvbiA9IDA7XG4gICAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IDA7XG4gICAgICAgIHRoaXMubV90YW5nZW50U3BlZWQgPSAwO1xuICAgICAgICB0aGlzLm1fZW5hYmxlZEZsYWcgPSB0cnVlO1xuICAgICAgICB0aGlzLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fdG91Y2hpbmdGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9maWx0ZXJGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9idWxsZXRIaXRGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9pbXB1bHNlID0gbmV3IENvbnRhY3RJbXB1bHNlKHRoaXMpO1xuICAgICAgICB0aGlzLnZfcG9pbnRzID0gW25ldyBWZWxvY2l0eUNvbnN0cmFpbnRQb2ludCgpLCBuZXcgVmVsb2NpdHlDb25zdHJhaW50UG9pbnQoKV07XG4gICAgICAgIHRoaXMudl9ub3JtYWwgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnZfbm9ybWFsTWFzcyA9IG5ldyBNYXQyMigpO1xuICAgICAgICB0aGlzLnZfSyA9IG5ldyBNYXQyMigpO1xuICAgICAgICB0aGlzLnZfcG9pbnRDb3VudCA9IDA7XG4gICAgICAgIHRoaXMudl90YW5nZW50U3BlZWQgPSAwO1xuICAgICAgICB0aGlzLnZfZnJpY3Rpb24gPSAwO1xuICAgICAgICB0aGlzLnZfcmVzdGl0dXRpb24gPSAwO1xuICAgICAgICB0aGlzLnZfaW52TWFzc0EgPSAwO1xuICAgICAgICB0aGlzLnZfaW52TWFzc0IgPSAwO1xuICAgICAgICB0aGlzLnZfaW52SUEgPSAwO1xuICAgICAgICB0aGlzLnZfaW52SUIgPSAwO1xuICAgICAgICB0aGlzLnBfbG9jYWxQb2ludHMgPSBbdmVjMigwLCAwKSwgdmVjMigwLCAwKV07XG4gICAgICAgIHRoaXMucF9sb2NhbE5vcm1hbCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMucF9sb2NhbFBvaW50ID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5wX2xvY2FsQ2VudGVyQSA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMucF9sb2NhbENlbnRlckIgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnBfdHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLnBfcmFkaXVzQSA9IDA7XG4gICAgICAgIHRoaXMucF9yYWRpdXNCID0gMDtcbiAgICAgICAgdGhpcy5wX3BvaW50Q291bnQgPSAwO1xuICAgICAgICB0aGlzLnBfaW52TWFzc0EgPSAwO1xuICAgICAgICB0aGlzLnBfaW52TWFzc0IgPSAwO1xuICAgICAgICB0aGlzLnBfaW52SUEgPSAwO1xuICAgICAgICB0aGlzLnBfaW52SUIgPSAwO1xuICAgICAgfVxuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbihmQSwgaW5kZXhBLCBmQiwgaW5kZXhCLCBldmFsdWF0ZUZjbikge1xuICAgICAgICB0aGlzLm1fZml4dHVyZUEgPSBmQTtcbiAgICAgICAgdGhpcy5tX2ZpeHR1cmVCID0gZkI7XG4gICAgICAgIHRoaXMubV9pbmRleEEgPSBpbmRleEE7XG4gICAgICAgIHRoaXMubV9pbmRleEIgPSBpbmRleEI7XG4gICAgICAgIHRoaXMubV9ldmFsdWF0ZUZjbiA9IGV2YWx1YXRlRmNuO1xuICAgICAgICB0aGlzLm1fZnJpY3Rpb24gPSBtaXhGcmljdGlvbih0aGlzLm1fZml4dHVyZUEubV9mcmljdGlvbiwgdGhpcy5tX2ZpeHR1cmVCLm1fZnJpY3Rpb24pO1xuICAgICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSBtaXhSZXN0aXR1dGlvbih0aGlzLm1fZml4dHVyZUEubV9yZXN0aXR1dGlvbiwgdGhpcy5tX2ZpeHR1cmVCLm1fcmVzdGl0dXRpb24pO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV9ub2RlQS5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMubV9ub2RlQi5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMubV9maXh0dXJlQSA9IG51bGw7XG4gICAgICAgIHRoaXMubV9maXh0dXJlQiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9pbmRleEEgPSAtMTtcbiAgICAgICAgdGhpcy5tX2luZGV4QiA9IC0xO1xuICAgICAgICB0aGlzLm1fZXZhbHVhdGVGY24gPSBudWxsO1xuICAgICAgICB0aGlzLm1fbWFuaWZvbGQucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLm1fcHJldiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3RvaSA9IDE7XG4gICAgICAgIHRoaXMubV90b2lDb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV90b2lGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9mcmljdGlvbiA9IDA7XG4gICAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IDA7XG4gICAgICAgIHRoaXMubV90YW5nZW50U3BlZWQgPSAwO1xuICAgICAgICB0aGlzLm1fZW5hYmxlZEZsYWcgPSB0cnVlO1xuICAgICAgICB0aGlzLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fdG91Y2hpbmdGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9maWx0ZXJGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9idWxsZXRIaXRGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9pbXB1bHNlLnJlY3ljbGUoKTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYTIgPSB0aGlzLnZfcG9pbnRzOyBfaSA8IF9hMi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICB2YXIgcG9pbnRfMSA9IF9hMltfaV07XG4gICAgICAgICAgcG9pbnRfMS5yZWN5Y2xlKCk7XG4gICAgICAgIH1cbiAgICAgICAgemVyb1ZlYzIodGhpcy52X25vcm1hbCk7XG4gICAgICAgIHRoaXMudl9ub3JtYWxNYXNzLnNldFplcm8oKTtcbiAgICAgICAgdGhpcy52X0suc2V0WmVybygpO1xuICAgICAgICB0aGlzLnZfcG9pbnRDb3VudCA9IDA7XG4gICAgICAgIHRoaXMudl90YW5nZW50U3BlZWQgPSAwO1xuICAgICAgICB0aGlzLnZfZnJpY3Rpb24gPSAwO1xuICAgICAgICB0aGlzLnZfcmVzdGl0dXRpb24gPSAwO1xuICAgICAgICB0aGlzLnZfaW52TWFzc0EgPSAwO1xuICAgICAgICB0aGlzLnZfaW52TWFzc0IgPSAwO1xuICAgICAgICB0aGlzLnZfaW52SUEgPSAwO1xuICAgICAgICB0aGlzLnZfaW52SUIgPSAwO1xuICAgICAgICBmb3IgKHZhciBfYiA9IDAsIF9jID0gdGhpcy5wX2xvY2FsUG9pbnRzOyBfYiA8IF9jLmxlbmd0aDsgX2IrKykge1xuICAgICAgICAgIHZhciBwb2ludF8yID0gX2NbX2JdO1xuICAgICAgICAgIHplcm9WZWMyKHBvaW50XzIpO1xuICAgICAgICB9XG4gICAgICAgIHplcm9WZWMyKHRoaXMucF9sb2NhbE5vcm1hbCk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMucF9sb2NhbFBvaW50KTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5wX2xvY2FsQ2VudGVyQSk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMucF9sb2NhbENlbnRlckIpO1xuICAgICAgICB0aGlzLnBfdHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLnBfcmFkaXVzQSA9IDA7XG4gICAgICAgIHRoaXMucF9yYWRpdXNCID0gMDtcbiAgICAgICAgdGhpcy5wX3BvaW50Q291bnQgPSAwO1xuICAgICAgICB0aGlzLnBfaW52TWFzc0EgPSAwO1xuICAgICAgICB0aGlzLnBfaW52TWFzc0IgPSAwO1xuICAgICAgICB0aGlzLnBfaW52SUEgPSAwO1xuICAgICAgICB0aGlzLnBfaW52SUIgPSAwO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5pbml0Q29uc3RyYWludCA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgc2hhcGVBID0gZml4dHVyZUEubV9zaGFwZTtcbiAgICAgICAgdmFyIHNoYXBlQiA9IGZpeHR1cmVCLm1fc2hhcGU7XG4gICAgICAgIGlmIChzaGFwZUEgPT09IG51bGwgfHwgc2hhcGVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIG1hbmlmb2xkID0gdGhpcy5tX21hbmlmb2xkO1xuICAgICAgICB2YXIgcG9pbnRDb3VudCA9IG1hbmlmb2xkLnBvaW50Q291bnQ7XG4gICAgICAgIHRoaXMudl9pbnZNYXNzQSA9IGJvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy52X2ludk1hc3NCID0gYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLnZfaW52SUEgPSBib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMudl9pbnZJQiA9IGJvZHlCLm1faW52STtcbiAgICAgICAgdGhpcy52X2ZyaWN0aW9uID0gdGhpcy5tX2ZyaWN0aW9uO1xuICAgICAgICB0aGlzLnZfcmVzdGl0dXRpb24gPSB0aGlzLm1fcmVzdGl0dXRpb247XG4gICAgICAgIHRoaXMudl90YW5nZW50U3BlZWQgPSB0aGlzLm1fdGFuZ2VudFNwZWVkO1xuICAgICAgICB0aGlzLnZfcG9pbnRDb3VudCA9IHBvaW50Q291bnQ7XG4gICAgICAgIHRoaXMudl9LLnNldFplcm8oKTtcbiAgICAgICAgdGhpcy52X25vcm1hbE1hc3Muc2V0WmVybygpO1xuICAgICAgICB0aGlzLnBfaW52TWFzc0EgPSBib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMucF9pbnZNYXNzQiA9IGJvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5wX2ludklBID0gYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLnBfaW52SUIgPSBib2R5Qi5tX2ludkk7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMucF9sb2NhbENlbnRlckEsIGJvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXIpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLnBfbG9jYWxDZW50ZXJCLCBib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyKTtcbiAgICAgICAgdGhpcy5wX3JhZGl1c0EgPSBzaGFwZUEubV9yYWRpdXM7XG4gICAgICAgIHRoaXMucF9yYWRpdXNCID0gc2hhcGVCLm1fcmFkaXVzO1xuICAgICAgICB0aGlzLnBfdHlwZSA9IG1hbmlmb2xkLnR5cGU7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMucF9sb2NhbE5vcm1hbCwgbWFuaWZvbGQubG9jYWxOb3JtYWwpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLnBfbG9jYWxQb2ludCwgbWFuaWZvbGQubG9jYWxQb2ludCk7XG4gICAgICAgIHRoaXMucF9wb2ludENvdW50ID0gcG9pbnRDb3VudDtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBTZXR0aW5nc0ludGVybmFsLm1heE1hbmlmb2xkUG9pbnRzOyArK2opIHtcbiAgICAgICAgICB0aGlzLnZfcG9pbnRzW2pdLnJlY3ljbGUoKTtcbiAgICAgICAgICB6ZXJvVmVjMih0aGlzLnBfbG9jYWxQb2ludHNbal0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgdmFyIGNwID0gbWFuaWZvbGQucG9pbnRzW2pdO1xuICAgICAgICAgIHZhciB2Y3AgPSB0aGlzLnZfcG9pbnRzW2pdO1xuICAgICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgICAgdmNwLm5vcm1hbEltcHVsc2UgPSBzdGVwLmR0UmF0aW8gKiBjcC5ub3JtYWxJbXB1bHNlO1xuICAgICAgICAgICAgdmNwLnRhbmdlbnRJbXB1bHNlID0gc3RlcC5kdFJhdGlvICogY3AudGFuZ2VudEltcHVsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvcHlWZWMyKHRoaXMucF9sb2NhbFBvaW50c1tqXSwgY3AubG9jYWxQb2ludCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0TWFuaWZvbGQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYW5pZm9sZDtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0V29ybGRNYW5pZm9sZCA9IGZ1bmN0aW9uKHdvcmxkTWFuaWZvbGQyKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgaWYgKGJvZHlBID09PSBudWxsIHx8IGJvZHlCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHNoYXBlQSA9IGZpeHR1cmVBLm1fc2hhcGU7XG4gICAgICAgIHZhciBzaGFwZUIgPSBmaXh0dXJlQi5tX3NoYXBlO1xuICAgICAgICBpZiAoc2hhcGVBID09PSBudWxsIHx8IHNoYXBlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWFuaWZvbGQuZ2V0V29ybGRNYW5pZm9sZCh3b3JsZE1hbmlmb2xkMiwgYm9keUEuZ2V0VHJhbnNmb3JtKCksIHNoYXBlQS5tX3JhZGl1cywgYm9keUIuZ2V0VHJhbnNmb3JtKCksIHNoYXBlQi5tX3JhZGl1cyk7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnNldEVuYWJsZWQgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIHRoaXMubV9lbmFibGVkRmxhZyA9ICEhZmxhZztcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuaXNFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlZEZsYWc7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmlzVG91Y2hpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90b3VjaGluZ0ZsYWc7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldE5leHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXRGaXh0dXJlQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXRGaXh0dXJlQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXRDaGlsZEluZGV4QSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2luZGV4QTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0Q2hpbGRJbmRleEIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9pbmRleEI7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmZsYWdGb3JGaWx0ZXJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckZsYWcgPSB0cnVlO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zZXRGcmljdGlvbiA9IGZ1bmN0aW9uKGZyaWN0aW9uKSB7XG4gICAgICAgIHRoaXMubV9mcmljdGlvbiA9IGZyaWN0aW9uO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXRGcmljdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZyaWN0aW9uO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5yZXNldEZyaWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fZnJpY3Rpb24gPSBtaXhGcmljdGlvbihmaXh0dXJlQS5tX2ZyaWN0aW9uLCBmaXh0dXJlQi5tX2ZyaWN0aW9uKTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc2V0UmVzdGl0dXRpb24gPSBmdW5jdGlvbihyZXN0aXR1dGlvbikge1xuICAgICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSByZXN0aXR1dGlvbjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0UmVzdGl0dXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yZXN0aXR1dGlvbjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUucmVzZXRSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gbWl4UmVzdGl0dXRpb24oZml4dHVyZUEubV9yZXN0aXR1dGlvbiwgZml4dHVyZUIubV9yZXN0aXR1dGlvbik7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnNldFRhbmdlbnRTcGVlZCA9IGZ1bmN0aW9uKHNwZWVkKSB7XG4gICAgICAgIHRoaXMubV90YW5nZW50U3BlZWQgPSBzcGVlZDtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0VGFuZ2VudFNwZWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdGFuZ2VudFNwZWVkO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uKG1hbmlmb2xkLCB4ZkEyLCB4ZkIyKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fZXZhbHVhdGVGY24obWFuaWZvbGQsIHhmQTIsIGZpeHR1cmVBLCB0aGlzLm1faW5kZXhBLCB4ZkIyLCBmaXh0dXJlQiwgdGhpcy5tX2luZGV4Qik7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKGxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgaWYgKGJvZHlBID09PSBudWxsIHx8IGJvZHlCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHNoYXBlQSA9IGZpeHR1cmVBLm1fc2hhcGU7XG4gICAgICAgIHZhciBzaGFwZUIgPSBmaXh0dXJlQi5tX3NoYXBlO1xuICAgICAgICBpZiAoc2hhcGVBID09PSBudWxsIHx8IHNoYXBlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9lbmFibGVkRmxhZyA9IHRydWU7XG4gICAgICAgIHZhciB0b3VjaGluZyA9IGZhbHNlO1xuICAgICAgICB2YXIgd2FzVG91Y2hpbmcgPSB0aGlzLm1fdG91Y2hpbmdGbGFnO1xuICAgICAgICB2YXIgc2Vuc29yQSA9IGZpeHR1cmVBLm1faXNTZW5zb3I7XG4gICAgICAgIHZhciBzZW5zb3JCID0gZml4dHVyZUIubV9pc1NlbnNvcjtcbiAgICAgICAgdmFyIHNlbnNvciA9IHNlbnNvckEgfHwgc2Vuc29yQjtcbiAgICAgICAgdmFyIHhmQTIgPSBib2R5QS5tX3hmO1xuICAgICAgICB2YXIgeGZCMiA9IGJvZHlCLm1feGY7XG4gICAgICAgIGlmIChzZW5zb3IpIHtcbiAgICAgICAgICB0b3VjaGluZyA9IHRlc3RPdmVybGFwKHNoYXBlQSwgdGhpcy5tX2luZGV4QSwgc2hhcGVCLCB0aGlzLm1faW5kZXhCLCB4ZkEyLCB4ZkIyKTtcbiAgICAgICAgICB0aGlzLm1fbWFuaWZvbGQucG9pbnRDb3VudCA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb2xkTWFuaWZvbGQucmVjeWNsZSgpO1xuICAgICAgICAgIG9sZE1hbmlmb2xkLnNldCh0aGlzLm1fbWFuaWZvbGQpO1xuICAgICAgICAgIHRoaXMubV9tYW5pZm9sZC5yZWN5Y2xlKCk7XG4gICAgICAgICAgdGhpcy5ldmFsdWF0ZSh0aGlzLm1fbWFuaWZvbGQsIHhmQTIsIHhmQjIpO1xuICAgICAgICAgIHRvdWNoaW5nID0gdGhpcy5tX21hbmlmb2xkLnBvaW50Q291bnQgPiAwO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX21hbmlmb2xkLnBvaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIG5tcCA9IHRoaXMubV9tYW5pZm9sZC5wb2ludHNbaV07XG4gICAgICAgICAgICBubXAubm9ybWFsSW1wdWxzZSA9IDA7XG4gICAgICAgICAgICBubXAudGFuZ2VudEltcHVsc2UgPSAwO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBvbGRNYW5pZm9sZC5wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICAgICAgdmFyIG9tcCA9IG9sZE1hbmlmb2xkLnBvaW50c1tqXTtcbiAgICAgICAgICAgICAgaWYgKG9tcC5pZC5rZXkgPT09IG5tcC5pZC5rZXkpIHtcbiAgICAgICAgICAgICAgICBubXAubm9ybWFsSW1wdWxzZSA9IG9tcC5ub3JtYWxJbXB1bHNlO1xuICAgICAgICAgICAgICAgIG5tcC50YW5nZW50SW1wdWxzZSA9IG9tcC50YW5nZW50SW1wdWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodG91Y2hpbmcgIT09IHdhc1RvdWNoaW5nKSB7XG4gICAgICAgICAgICBib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICAgIGJvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fdG91Y2hpbmdGbGFnID0gdG91Y2hpbmc7XG4gICAgICAgIHZhciBoYXNMaXN0ZW5lciA9IHR5cGVvZiBsaXN0ZW5lciA9PT0gXCJvYmplY3RcIiAmJiBsaXN0ZW5lciAhPT0gbnVsbDtcbiAgICAgICAgaWYgKCF3YXNUb3VjaGluZyAmJiB0b3VjaGluZyAmJiBoYXNMaXN0ZW5lcikge1xuICAgICAgICAgIGxpc3RlbmVyLmJlZ2luQ29udGFjdCh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAod2FzVG91Y2hpbmcgJiYgIXRvdWNoaW5nICYmIGhhc0xpc3RlbmVyKSB7XG4gICAgICAgICAgbGlzdGVuZXIuZW5kQ29udGFjdCh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNlbnNvciAmJiB0b3VjaGluZyAmJiBoYXNMaXN0ZW5lciAmJiBvbGRNYW5pZm9sZCkge1xuICAgICAgICAgIGxpc3RlbmVyLnByZVNvbHZlKHRoaXMsIG9sZE1hbmlmb2xkKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludCA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NvbHZlUG9zaXRpb25Db25zdHJhaW50KHN0ZXAsIG51bGwsIG51bGwpO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludFRPSSA9IGZ1bmN0aW9uKHN0ZXAsIHRvaUEsIHRvaUIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NvbHZlUG9zaXRpb25Db25zdHJhaW50KHN0ZXAsIHRvaUEsIHRvaUIpO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5fc29sdmVQb3NpdGlvbkNvbnN0cmFpbnQgPSBmdW5jdGlvbihzdGVwLCB0b2lBLCB0b2lCKSB7XG4gICAgICAgIHZhciB0b2kgPSB0b2lBICE9PSBudWxsICYmIHRvaUIgIT09IG51bGwgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIHZhciBtaW5TZXBhcmF0aW9uID0gMDtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm4gbWluU2VwYXJhdGlvbjtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGlmIChib2R5QSA9PT0gbnVsbCB8fCBib2R5QiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm4gbWluU2VwYXJhdGlvbjtcbiAgICAgICAgdmFyIHBvc2l0aW9uQSA9IGJvZHlBLmNfcG9zaXRpb247XG4gICAgICAgIHZhciBwb3NpdGlvbkIgPSBib2R5Qi5jX3Bvc2l0aW9uO1xuICAgICAgICB2YXIgbG9jYWxDZW50ZXJBID0gdGhpcy5wX2xvY2FsQ2VudGVyQTtcbiAgICAgICAgdmFyIGxvY2FsQ2VudGVyQiA9IHRoaXMucF9sb2NhbENlbnRlckI7XG4gICAgICAgIHZhciBtQSA9IDA7XG4gICAgICAgIHZhciBpQSA9IDA7XG4gICAgICAgIGlmICghdG9pIHx8IGJvZHlBID09PSB0b2lBIHx8IGJvZHlBID09PSB0b2lCKSB7XG4gICAgICAgICAgbUEgPSB0aGlzLnBfaW52TWFzc0E7XG4gICAgICAgICAgaUEgPSB0aGlzLnBfaW52SUE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1CID0gMDtcbiAgICAgICAgdmFyIGlCID0gMDtcbiAgICAgICAgaWYgKCF0b2kgfHwgYm9keUIgPT09IHRvaUEgfHwgYm9keUIgPT09IHRvaUIpIHtcbiAgICAgICAgICBtQiA9IHRoaXMucF9pbnZNYXNzQjtcbiAgICAgICAgICBpQiA9IHRoaXMucF9pbnZJQjtcbiAgICAgICAgfVxuICAgICAgICBjb3B5VmVjMihjQSwgcG9zaXRpb25BLmMpO1xuICAgICAgICB2YXIgYUEgPSBwb3NpdGlvbkEuYTtcbiAgICAgICAgY29weVZlYzIoY0IsIHBvc2l0aW9uQi5jKTtcbiAgICAgICAgdmFyIGFCID0gcG9zaXRpb25CLmE7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5wX3BvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgIGdldFRyYW5zZm9ybSh4ZkEsIGxvY2FsQ2VudGVyQSwgY0EsIGFBKTtcbiAgICAgICAgICBnZXRUcmFuc2Zvcm0oeGZCLCBsb2NhbENlbnRlckIsIGNCLCBhQik7XG4gICAgICAgICAgdmFyIHNlcGFyYXRpb24gPSB2b2lkIDA7XG4gICAgICAgICAgc3dpdGNoICh0aGlzLnBfdHlwZSkge1xuICAgICAgICAgICAgY2FzZSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9jaXJjbGVzOiB7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRBLCB4ZkEsIHRoaXMucF9sb2NhbFBvaW50KTtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIsIHhmQiwgdGhpcy5wX2xvY2FsUG9pbnRzWzBdKTtcbiAgICAgICAgICAgICAgc3ViVmVjMihub3JtYWwkMiwgcG9pbnRCLCBwb2ludEEpO1xuICAgICAgICAgICAgICBub3JtYWxpemVWZWMyKG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgY29tYmluZTJWZWMyKHBvaW50LCAwLjUsIHBvaW50QSwgMC41LCBwb2ludEIpO1xuICAgICAgICAgICAgICBzZXBhcmF0aW9uID0gZG90VmVjMihwb2ludEIsIG5vcm1hbCQyKSAtIGRvdFZlYzIocG9pbnRBLCBub3JtYWwkMikgLSB0aGlzLnBfcmFkaXVzQSAtIHRoaXMucF9yYWRpdXNCO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUE6IHtcbiAgICAgICAgICAgICAgcm90VmVjMihub3JtYWwkMiwgeGZBLnEsIHRoaXMucF9sb2NhbE5vcm1hbCk7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocGxhbmVQb2ludCQxLCB4ZkEsIHRoaXMucF9sb2NhbFBvaW50KTtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihjbGlwUG9pbnQsIHhmQiwgdGhpcy5wX2xvY2FsUG9pbnRzW2pdKTtcbiAgICAgICAgICAgICAgc2VwYXJhdGlvbiA9IGRvdFZlYzIoY2xpcFBvaW50LCBub3JtYWwkMikgLSBkb3RWZWMyKHBsYW5lUG9pbnQkMSwgbm9ybWFsJDIpIC0gdGhpcy5wX3JhZGl1c0EgLSB0aGlzLnBfcmFkaXVzQjtcbiAgICAgICAgICAgICAgY29weVZlYzIocG9pbnQsIGNsaXBQb2ludCk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQjoge1xuICAgICAgICAgICAgICByb3RWZWMyKG5vcm1hbCQyLCB4ZkIucSwgdGhpcy5wX2xvY2FsTm9ybWFsKTtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwbGFuZVBvaW50JDEsIHhmQiwgdGhpcy5wX2xvY2FsUG9pbnQpO1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKGNsaXBQb2ludCwgeGZBLCB0aGlzLnBfbG9jYWxQb2ludHNbal0pO1xuICAgICAgICAgICAgICBzZXBhcmF0aW9uID0gZG90VmVjMihjbGlwUG9pbnQsIG5vcm1hbCQyKSAtIGRvdFZlYzIocGxhbmVQb2ludCQxLCBub3JtYWwkMikgLSB0aGlzLnBfcmFkaXVzQSAtIHRoaXMucF9yYWRpdXNCO1xuICAgICAgICAgICAgICBjb3B5VmVjMihwb2ludCwgY2xpcFBvaW50KTtcbiAgICAgICAgICAgICAgbmVnVmVjMihub3JtYWwkMik7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgICByZXR1cm4gbWluU2VwYXJhdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgc3ViVmVjMihyQSwgcG9pbnQsIGNBKTtcbiAgICAgICAgICBzdWJWZWMyKHJCLCBwb2ludCwgY0IpO1xuICAgICAgICAgIG1pblNlcGFyYXRpb24gPSBtYXRoX21pbiQ0KG1pblNlcGFyYXRpb24sIHNlcGFyYXRpb24pO1xuICAgICAgICAgIHZhciBiYXVtZ2FydGUgPSB0b2kgPyBTZXR0aW5nc0ludGVybmFsLnRvaUJhdWdhcnRlIDogU2V0dGluZ3NJbnRlcm5hbC5iYXVtZ2FydGU7XG4gICAgICAgICAgdmFyIGxpbmVhclNsb3AgPSBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgICAgICAgdmFyIG1heExpbmVhckNvcnJlY3Rpb24gPSBTZXR0aW5nc0ludGVybmFsLm1heExpbmVhckNvcnJlY3Rpb247XG4gICAgICAgICAgdmFyIEMgPSBjbGFtcChiYXVtZ2FydGUgKiAoc2VwYXJhdGlvbiArIGxpbmVhclNsb3ApLCAtbWF4TGluZWFyQ29ycmVjdGlvbiwgMCk7XG4gICAgICAgICAgdmFyIHJuQSA9IGNyb3NzVmVjMlZlYzIockEsIG5vcm1hbCQyKTtcbiAgICAgICAgICB2YXIgcm5CID0gY3Jvc3NWZWMyVmVjMihyQiwgbm9ybWFsJDIpO1xuICAgICAgICAgIHZhciBLID0gbUEgKyBtQiArIGlBICogcm5BICogcm5BICsgaUIgKiBybkIgKiBybkI7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSBLID4gMCA/IC1DIC8gSyA6IDA7XG4gICAgICAgICAgc2NhbGVWZWMyKFAkMSwgaW1wdWxzZSwgbm9ybWFsJDIpO1xuICAgICAgICAgIG1pbnVzU2NhbGVWZWMyKGNBLCBtQSwgUCQxKTtcbiAgICAgICAgICBhQSAtPSBpQSAqIGNyb3NzVmVjMlZlYzIockEsIFAkMSk7XG4gICAgICAgICAgcGx1c1NjYWxlVmVjMihjQiwgbUIsIFAkMSk7XG4gICAgICAgICAgYUIgKz0gaUIgKiBjcm9zc1ZlYzJWZWMyKHJCLCBQJDEpO1xuICAgICAgICB9XG4gICAgICAgIGNvcHlWZWMyKHBvc2l0aW9uQS5jLCBjQSk7XG4gICAgICAgIHBvc2l0aW9uQS5hID0gYUE7XG4gICAgICAgIGNvcHlWZWMyKHBvc2l0aW9uQi5jLCBjQik7XG4gICAgICAgIHBvc2l0aW9uQi5hID0gYUI7XG4gICAgICAgIHJldHVybiBtaW5TZXBhcmF0aW9uO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50ID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGlmIChib2R5QSA9PT0gbnVsbCB8fCBib2R5QiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciB2ZWxvY2l0eUEgPSBib2R5QS5jX3ZlbG9jaXR5O1xuICAgICAgICB2YXIgdmVsb2NpdHlCID0gYm9keUIuY192ZWxvY2l0eTtcbiAgICAgICAgdmFyIHBvc2l0aW9uQSA9IGJvZHlBLmNfcG9zaXRpb247XG4gICAgICAgIHZhciBwb3NpdGlvbkIgPSBib2R5Qi5jX3Bvc2l0aW9uO1xuICAgICAgICB2YXIgcmFkaXVzQSA9IHRoaXMucF9yYWRpdXNBO1xuICAgICAgICB2YXIgcmFkaXVzQiA9IHRoaXMucF9yYWRpdXNCO1xuICAgICAgICB2YXIgbWFuaWZvbGQgPSB0aGlzLm1fbWFuaWZvbGQ7XG4gICAgICAgIHZhciBtQSA9IHRoaXMudl9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy52X2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLnZfaW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMudl9pbnZJQjtcbiAgICAgICAgdmFyIGxvY2FsQ2VudGVyQSA9IHRoaXMucF9sb2NhbENlbnRlckE7XG4gICAgICAgIHZhciBsb2NhbENlbnRlckIgPSB0aGlzLnBfbG9jYWxDZW50ZXJCO1xuICAgICAgICBjb3B5VmVjMihjQSwgcG9zaXRpb25BLmMpO1xuICAgICAgICB2YXIgYUEgPSBwb3NpdGlvbkEuYTtcbiAgICAgICAgY29weVZlYzIodkEsIHZlbG9jaXR5QS52KTtcbiAgICAgICAgdmFyIHdBID0gdmVsb2NpdHlBLnc7XG4gICAgICAgIGNvcHlWZWMyKGNCLCBwb3NpdGlvbkIuYyk7XG4gICAgICAgIHZhciBhQiA9IHBvc2l0aW9uQi5hO1xuICAgICAgICBjb3B5VmVjMih2QiwgdmVsb2NpdHlCLnYpO1xuICAgICAgICB2YXIgd0IgPSB2ZWxvY2l0eUIudztcbiAgICAgICAgZ2V0VHJhbnNmb3JtKHhmQSwgbG9jYWxDZW50ZXJBLCBjQSwgYUEpO1xuICAgICAgICBnZXRUcmFuc2Zvcm0oeGZCLCBsb2NhbENlbnRlckIsIGNCLCBhQik7XG4gICAgICAgIHdvcmxkTWFuaWZvbGQucmVjeWNsZSgpO1xuICAgICAgICBtYW5pZm9sZC5nZXRXb3JsZE1hbmlmb2xkKHdvcmxkTWFuaWZvbGQsIHhmQSwgcmFkaXVzQSwgeGZCLCByYWRpdXNCKTtcbiAgICAgICAgY29weVZlYzIodGhpcy52X25vcm1hbCwgd29ybGRNYW5pZm9sZC5ub3JtYWwpO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMudl9wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICB2YXIgdmNwID0gdGhpcy52X3BvaW50c1tqXTtcbiAgICAgICAgICB2YXIgd21wID0gd29ybGRNYW5pZm9sZC5wb2ludHNbal07XG4gICAgICAgICAgc3ViVmVjMih2Y3AuckEsIHdtcCwgY0EpO1xuICAgICAgICAgIHN1YlZlYzIodmNwLnJCLCB3bXAsIGNCKTtcbiAgICAgICAgICB2YXIgcm5BID0gY3Jvc3NWZWMyVmVjMih2Y3AuckEsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICAgIHZhciBybkIgPSBjcm9zc1ZlYzJWZWMyKHZjcC5yQiwgdGhpcy52X25vcm1hbCk7XG4gICAgICAgICAgdmFyIGtOb3JtYWwgPSBtQSArIG1CICsgaUEgKiBybkEgKiBybkEgKyBpQiAqIHJuQiAqIHJuQjtcbiAgICAgICAgICB2Y3Aubm9ybWFsTWFzcyA9IGtOb3JtYWwgPiAwID8gMSAvIGtOb3JtYWwgOiAwO1xuICAgICAgICAgIGNyb3NzVmVjMk51bSh0YW5nZW50JDEsIHRoaXMudl9ub3JtYWwsIDEpO1xuICAgICAgICAgIHZhciBydEEgPSBjcm9zc1ZlYzJWZWMyKHZjcC5yQSwgdGFuZ2VudCQxKTtcbiAgICAgICAgICB2YXIgcnRCID0gY3Jvc3NWZWMyVmVjMih2Y3AuckIsIHRhbmdlbnQkMSk7XG4gICAgICAgICAgdmFyIGtUYW5nZW50ID0gbUEgKyBtQiArIGlBICogcnRBICogcnRBICsgaUIgKiBydEIgKiBydEI7XG4gICAgICAgICAgdmNwLnRhbmdlbnRNYXNzID0ga1RhbmdlbnQgPiAwID8gMSAvIGtUYW5nZW50IDogMDtcbiAgICAgICAgICB2Y3AudmVsb2NpdHlCaWFzID0gMDtcbiAgICAgICAgICB2YXIgdlJlbCA9IDA7XG4gICAgICAgICAgdlJlbCArPSBkb3RWZWMyKHRoaXMudl9ub3JtYWwsIHZCKTtcbiAgICAgICAgICB2UmVsICs9IGRvdFZlYzIodGhpcy52X25vcm1hbCwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0IsIHZjcC5yQikpO1xuICAgICAgICAgIHZSZWwgLT0gZG90VmVjMih0aGlzLnZfbm9ybWFsLCB2QSk7XG4gICAgICAgICAgdlJlbCAtPSBkb3RWZWMyKHRoaXMudl9ub3JtYWwsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdBLCB2Y3AuckEpKTtcbiAgICAgICAgICBpZiAodlJlbCA8IC1TZXR0aW5nc0ludGVybmFsLnZlbG9jaXR5VGhyZXNob2xkKSB7XG4gICAgICAgICAgICB2Y3AudmVsb2NpdHlCaWFzID0gLXRoaXMudl9yZXN0aXR1dGlvbiAqIHZSZWw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZfcG9pbnRDb3VudCA9PSAyICYmIHN0ZXAuYmxvY2tTb2x2ZSkge1xuICAgICAgICAgIHZhciB2Y3AxID0gdGhpcy52X3BvaW50c1swXTtcbiAgICAgICAgICB2YXIgdmNwMiA9IHRoaXMudl9wb2ludHNbMV07XG4gICAgICAgICAgdmFyIHJuMUEgPSBjcm9zc1ZlYzJWZWMyKHZjcDEuckEsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICAgIHZhciBybjFCID0gY3Jvc3NWZWMyVmVjMih2Y3AxLnJCLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgICB2YXIgcm4yQSA9IGNyb3NzVmVjMlZlYzIodmNwMi5yQSwgdGhpcy52X25vcm1hbCk7XG4gICAgICAgICAgdmFyIHJuMkIgPSBjcm9zc1ZlYzJWZWMyKHZjcDIuckIsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICAgIHZhciBrMTEgPSBtQSArIG1CICsgaUEgKiBybjFBICogcm4xQSArIGlCICogcm4xQiAqIHJuMUI7XG4gICAgICAgICAgdmFyIGsyMiA9IG1BICsgbUIgKyBpQSAqIHJuMkEgKiBybjJBICsgaUIgKiBybjJCICogcm4yQjtcbiAgICAgICAgICB2YXIgazEyID0gbUEgKyBtQiArIGlBICogcm4xQSAqIHJuMkEgKyBpQiAqIHJuMUIgKiBybjJCO1xuICAgICAgICAgIHZhciBrX21heENvbmRpdGlvbk51bWJlciA9IDFlMztcbiAgICAgICAgICBpZiAoazExICogazExIDwga19tYXhDb25kaXRpb25OdW1iZXIgKiAoazExICogazIyIC0gazEyICogazEyKSkge1xuICAgICAgICAgICAgdGhpcy52X0suZXguc2V0TnVtKGsxMSwgazEyKTtcbiAgICAgICAgICAgIHRoaXMudl9LLmV5LnNldE51bShrMTIsIGsyMik7XG4gICAgICAgICAgICB2YXIgYV8xID0gdGhpcy52X0suZXgueDtcbiAgICAgICAgICAgIHZhciBiXzEgPSB0aGlzLnZfSy5leS54O1xuICAgICAgICAgICAgdmFyIGMyID0gdGhpcy52X0suZXgueTtcbiAgICAgICAgICAgIHZhciBkXzEgPSB0aGlzLnZfSy5leS55O1xuICAgICAgICAgICAgdmFyIGRldCA9IGFfMSAqIGRfMSAtIGJfMSAqIGMyO1xuICAgICAgICAgICAgaWYgKGRldCAhPT0gMCkge1xuICAgICAgICAgICAgICBkZXQgPSAxIC8gZGV0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy52X25vcm1hbE1hc3MuZXgueCA9IGRldCAqIGRfMTtcbiAgICAgICAgICAgIHRoaXMudl9ub3JtYWxNYXNzLmV5LnggPSAtZGV0ICogYl8xO1xuICAgICAgICAgICAgdGhpcy52X25vcm1hbE1hc3MuZXgueSA9IC1kZXQgKiBjMjtcbiAgICAgICAgICAgIHRoaXMudl9ub3JtYWxNYXNzLmV5LnkgPSBkZXQgKiBhXzE7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudl9wb2ludENvdW50ID0gMTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29weVZlYzIocG9zaXRpb25BLmMsIGNBKTtcbiAgICAgICAgcG9zaXRpb25BLmEgPSBhQTtcbiAgICAgICAgY29weVZlYzIodmVsb2NpdHlBLnYsIHZBKTtcbiAgICAgICAgdmVsb2NpdHlBLncgPSB3QTtcbiAgICAgICAgY29weVZlYzIocG9zaXRpb25CLmMsIGNCKTtcbiAgICAgICAgcG9zaXRpb25CLmEgPSBhQjtcbiAgICAgICAgY29weVZlYzIodmVsb2NpdHlCLnYsIHZCKTtcbiAgICAgICAgdmVsb2NpdHlCLncgPSB3QjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUud2FybVN0YXJ0Q29uc3RyYWludCA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgdmVsb2NpdHlBID0gYm9keUEuY192ZWxvY2l0eTtcbiAgICAgICAgdmFyIHZlbG9jaXR5QiA9IGJvZHlCLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMudl9pbnZNYXNzQTtcbiAgICAgICAgdmFyIGlBID0gdGhpcy52X2ludklBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLnZfaW52TWFzc0I7XG4gICAgICAgIHZhciBpQiA9IHRoaXMudl9pbnZJQjtcbiAgICAgICAgY29weVZlYzIodkEsIHZlbG9jaXR5QS52KTtcbiAgICAgICAgdmFyIHdBID0gdmVsb2NpdHlBLnc7XG4gICAgICAgIGNvcHlWZWMyKHZCLCB2ZWxvY2l0eUIudik7XG4gICAgICAgIHZhciB3QiA9IHZlbG9jaXR5Qi53O1xuICAgICAgICBjb3B5VmVjMihub3JtYWwkMiwgdGhpcy52X25vcm1hbCk7XG4gICAgICAgIGNyb3NzVmVjMk51bSh0YW5nZW50JDEsIG5vcm1hbCQyLCAxKTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnZfcG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgdmFyIHZjcCA9IHRoaXMudl9wb2ludHNbal07XG4gICAgICAgICAgY29tYmluZTJWZWMyKFAkMSwgdmNwLm5vcm1hbEltcHVsc2UsIG5vcm1hbCQyLCB2Y3AudGFuZ2VudEltcHVsc2UsIHRhbmdlbnQkMSk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBjcm9zc1ZlYzJWZWMyKHZjcC5yQSwgUCQxKTtcbiAgICAgICAgICBtaW51c1NjYWxlVmVjMih2QSwgbUEsIFAkMSk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBjcm9zc1ZlYzJWZWMyKHZjcC5yQiwgUCQxKTtcbiAgICAgICAgICBwbHVzU2NhbGVWZWMyKHZCLCBtQiwgUCQxKTtcbiAgICAgICAgfVxuICAgICAgICBjb3B5VmVjMih2ZWxvY2l0eUEudiwgdkEpO1xuICAgICAgICB2ZWxvY2l0eUEudyA9IHdBO1xuICAgICAgICBjb3B5VmVjMih2ZWxvY2l0eUIudiwgdkIpO1xuICAgICAgICB2ZWxvY2l0eUIudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zdG9yZUNvbnN0cmFpbnRJbXB1bHNlcyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIG1hbmlmb2xkID0gdGhpcy5tX21hbmlmb2xkO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMudl9wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICBtYW5pZm9sZC5wb2ludHNbal0ubm9ybWFsSW1wdWxzZSA9IHRoaXMudl9wb2ludHNbal0ubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICBtYW5pZm9sZC5wb2ludHNbal0udGFuZ2VudEltcHVsc2UgPSB0aGlzLnZfcG9pbnRzW2pdLnRhbmdlbnRJbXB1bHNlO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50ID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGlmIChib2R5QSA9PT0gbnVsbCB8fCBib2R5QiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciB2ZWxvY2l0eUEgPSBib2R5QS5jX3ZlbG9jaXR5O1xuICAgICAgICB2YXIgdmVsb2NpdHlCID0gYm9keUIuY192ZWxvY2l0eTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy52X2ludk1hc3NBO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLnZfaW52SUE7XG4gICAgICAgIHZhciBtQiA9IHRoaXMudl9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlCID0gdGhpcy52X2ludklCO1xuICAgICAgICBjb3B5VmVjMih2QSwgdmVsb2NpdHlBLnYpO1xuICAgICAgICB2YXIgd0EgPSB2ZWxvY2l0eUEudztcbiAgICAgICAgY29weVZlYzIodkIsIHZlbG9jaXR5Qi52KTtcbiAgICAgICAgdmFyIHdCID0gdmVsb2NpdHlCLnc7XG4gICAgICAgIGNvcHlWZWMyKG5vcm1hbCQyLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgY3Jvc3NWZWMyTnVtKHRhbmdlbnQkMSwgbm9ybWFsJDIsIDEpO1xuICAgICAgICB2YXIgZnJpY3Rpb24gPSB0aGlzLnZfZnJpY3Rpb247XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy52X3BvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgIHZhciB2Y3AgPSB0aGlzLnZfcG9pbnRzW2pdO1xuICAgICAgICAgIHplcm9WZWMyKGR2KTtcbiAgICAgICAgICBwbHVzVmVjMihkdiwgdkIpO1xuICAgICAgICAgIHBsdXNWZWMyKGR2LCBjcm9zc051bVZlYzIodGVtcCQyLCB3QiwgdmNwLnJCKSk7XG4gICAgICAgICAgbWludXNWZWMyKGR2LCB2QSk7XG4gICAgICAgICAgbWludXNWZWMyKGR2LCBjcm9zc051bVZlYzIodGVtcCQyLCB3QSwgdmNwLnJBKSk7XG4gICAgICAgICAgdmFyIHZ0ID0gZG90VmVjMihkdiwgdGFuZ2VudCQxKSAtIHRoaXMudl90YW5nZW50U3BlZWQ7XG4gICAgICAgICAgdmFyIGxhbWJkYSA9IHZjcC50YW5nZW50TWFzcyAqIC12dDtcbiAgICAgICAgICB2YXIgbWF4RnJpY3Rpb24gPSBmcmljdGlvbiAqIHZjcC5ub3JtYWxJbXB1bHNlO1xuICAgICAgICAgIHZhciBuZXdJbXB1bHNlID0gY2xhbXAodmNwLnRhbmdlbnRJbXB1bHNlICsgbGFtYmRhLCAtbWF4RnJpY3Rpb24sIG1heEZyaWN0aW9uKTtcbiAgICAgICAgICBsYW1iZGEgPSBuZXdJbXB1bHNlIC0gdmNwLnRhbmdlbnRJbXB1bHNlO1xuICAgICAgICAgIHZjcC50YW5nZW50SW1wdWxzZSA9IG5ld0ltcHVsc2U7XG4gICAgICAgICAgc2NhbGVWZWMyKFAkMSwgbGFtYmRhLCB0YW5nZW50JDEpO1xuICAgICAgICAgIG1pbnVzU2NhbGVWZWMyKHZBLCBtQSwgUCQxKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIGNyb3NzVmVjMlZlYzIodmNwLnJBLCBQJDEpO1xuICAgICAgICAgIHBsdXNTY2FsZVZlYzIodkIsIG1CLCBQJDEpO1xuICAgICAgICAgIHdCICs9IGlCICogY3Jvc3NWZWMyVmVjMih2Y3AuckIsIFAkMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudl9wb2ludENvdW50ID09IDEgfHwgc3RlcC5ibG9ja1NvbHZlID09IGZhbHNlKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnZfcG9pbnRDb3VudDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgdmNwID0gdGhpcy52X3BvaW50c1tpXTtcbiAgICAgICAgICAgIHplcm9WZWMyKGR2KTtcbiAgICAgICAgICAgIHBsdXNWZWMyKGR2LCB2Qik7XG4gICAgICAgICAgICBwbHVzVmVjMihkdiwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0IsIHZjcC5yQikpO1xuICAgICAgICAgICAgbWludXNWZWMyKGR2LCB2QSk7XG4gICAgICAgICAgICBtaW51c1ZlYzIoZHYsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdBLCB2Y3AuckEpKTtcbiAgICAgICAgICAgIHZhciB2biA9IGRvdFZlYzIoZHYsIG5vcm1hbCQyKTtcbiAgICAgICAgICAgIHZhciBsYW1iZGEgPSAtdmNwLm5vcm1hbE1hc3MgKiAodm4gLSB2Y3AudmVsb2NpdHlCaWFzKTtcbiAgICAgICAgICAgIHZhciBuZXdJbXB1bHNlID0gbWF0aF9tYXgkMih2Y3Aubm9ybWFsSW1wdWxzZSArIGxhbWJkYSwgMCk7XG4gICAgICAgICAgICBsYW1iZGEgPSBuZXdJbXB1bHNlIC0gdmNwLm5vcm1hbEltcHVsc2U7XG4gICAgICAgICAgICB2Y3Aubm9ybWFsSW1wdWxzZSA9IG5ld0ltcHVsc2U7XG4gICAgICAgICAgICBzY2FsZVZlYzIoUCQxLCBsYW1iZGEsIG5vcm1hbCQyKTtcbiAgICAgICAgICAgIG1pbnVzU2NhbGVWZWMyKHZBLCBtQSwgUCQxKTtcbiAgICAgICAgICAgIHdBIC09IGlBICogY3Jvc3NWZWMyVmVjMih2Y3AuckEsIFAkMSk7XG4gICAgICAgICAgICBwbHVzU2NhbGVWZWMyKHZCLCBtQiwgUCQxKTtcbiAgICAgICAgICAgIHdCICs9IGlCICogY3Jvc3NWZWMyVmVjMih2Y3AuckIsIFAkMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciB2Y3AxID0gdGhpcy52X3BvaW50c1swXTtcbiAgICAgICAgICB2YXIgdmNwMiA9IHRoaXMudl9wb2ludHNbMV07XG4gICAgICAgICAgc2V0VmVjMihhLCB2Y3AxLm5vcm1hbEltcHVsc2UsIHZjcDIubm9ybWFsSW1wdWxzZSk7XG4gICAgICAgICAgemVyb1ZlYzIoZHYxKTtcbiAgICAgICAgICBwbHVzVmVjMihkdjEsIHZCKTtcbiAgICAgICAgICBwbHVzVmVjMihkdjEsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdCLCB2Y3AxLnJCKSk7XG4gICAgICAgICAgbWludXNWZWMyKGR2MSwgdkEpO1xuICAgICAgICAgIG1pbnVzVmVjMihkdjEsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdBLCB2Y3AxLnJBKSk7XG4gICAgICAgICAgemVyb1ZlYzIoZHYyKTtcbiAgICAgICAgICBwbHVzVmVjMihkdjIsIHZCKTtcbiAgICAgICAgICBwbHVzVmVjMihkdjIsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdCLCB2Y3AyLnJCKSk7XG4gICAgICAgICAgbWludXNWZWMyKGR2MiwgdkEpO1xuICAgICAgICAgIG1pbnVzVmVjMihkdjIsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdBLCB2Y3AyLnJBKSk7XG4gICAgICAgICAgdmFyIHZuMSA9IGRvdFZlYzIoZHYxLCBub3JtYWwkMik7XG4gICAgICAgICAgdmFyIHZuMiA9IGRvdFZlYzIoZHYyLCBub3JtYWwkMik7XG4gICAgICAgICAgc2V0VmVjMihiLCB2bjEgLSB2Y3AxLnZlbG9jaXR5Qmlhcywgdm4yIC0gdmNwMi52ZWxvY2l0eUJpYXMpO1xuICAgICAgICAgIGIueCAtPSB0aGlzLnZfSy5leC54ICogYS54ICsgdGhpcy52X0suZXkueCAqIGEueTtcbiAgICAgICAgICBiLnkgLT0gdGhpcy52X0suZXgueSAqIGEueCArIHRoaXMudl9LLmV5LnkgKiBhLnk7XG4gICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgIHplcm9WZWMyKHgpO1xuICAgICAgICAgICAgeC54ID0gLSh0aGlzLnZfbm9ybWFsTWFzcy5leC54ICogYi54ICsgdGhpcy52X25vcm1hbE1hc3MuZXkueCAqIGIueSk7XG4gICAgICAgICAgICB4LnkgPSAtKHRoaXMudl9ub3JtYWxNYXNzLmV4LnkgKiBiLnggKyB0aGlzLnZfbm9ybWFsTWFzcy5leS55ICogYi55KTtcbiAgICAgICAgICAgIGlmICh4LnggPj0gMCAmJiB4LnkgPj0gMCkge1xuICAgICAgICAgICAgICBzdWJWZWMyKGQsIHgsIGEpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIoUDEsIGQueCwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIoUDIsIGQueSwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgICBjb21iaW5lM1ZlYzIodkEsIC1tQSwgUDEsIC1tQSwgUDIsIDEsIHZBKTtcbiAgICAgICAgICAgICAgd0EgLT0gaUEgKiAoY3Jvc3NWZWMyVmVjMih2Y3AxLnJBLCBQMSkgKyBjcm9zc1ZlYzJWZWMyKHZjcDIuckEsIFAyKSk7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QiwgbUIsIFAxLCBtQiwgUDIsIDEsIHZCKTtcbiAgICAgICAgICAgICAgd0IgKz0gaUIgKiAoY3Jvc3NWZWMyVmVjMih2Y3AxLnJCLCBQMSkgKyBjcm9zc1ZlYzJWZWMyKHZjcDIuckIsIFAyKSk7XG4gICAgICAgICAgICAgIHZjcDEubm9ybWFsSW1wdWxzZSA9IHgueDtcbiAgICAgICAgICAgICAgdmNwMi5ub3JtYWxJbXB1bHNlID0geC55O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHgueCA9IC12Y3AxLm5vcm1hbE1hc3MgKiBiLng7XG4gICAgICAgICAgICB4LnkgPSAwO1xuICAgICAgICAgICAgdm4xID0gMDtcbiAgICAgICAgICAgIHZuMiA9IHRoaXMudl9LLmV4LnkgKiB4LnggKyBiLnk7XG4gICAgICAgICAgICBpZiAoeC54ID49IDAgJiYgdm4yID49IDApIHtcbiAgICAgICAgICAgICAgc3ViVmVjMihkLCB4LCBhKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKFAxLCBkLngsIG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKFAyLCBkLnksIG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZBLCAtbUEsIFAxLCAtbUEsIFAyLCAxLCB2QSk7XG4gICAgICAgICAgICAgIHdBIC09IGlBICogKGNyb3NzVmVjMlZlYzIodmNwMS5yQSwgUDEpICsgY3Jvc3NWZWMyVmVjMih2Y3AyLnJBLCBQMikpO1xuICAgICAgICAgICAgICBjb21iaW5lM1ZlYzIodkIsIG1CLCBQMSwgbUIsIFAyLCAxLCB2Qik7XG4gICAgICAgICAgICAgIHdCICs9IGlCICogKGNyb3NzVmVjMlZlYzIodmNwMS5yQiwgUDEpICsgY3Jvc3NWZWMyVmVjMih2Y3AyLnJCLCBQMikpO1xuICAgICAgICAgICAgICB2Y3AxLm5vcm1hbEltcHVsc2UgPSB4Lng7XG4gICAgICAgICAgICAgIHZjcDIubm9ybWFsSW1wdWxzZSA9IHgueTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4LnggPSAwO1xuICAgICAgICAgICAgeC55ID0gLXZjcDIubm9ybWFsTWFzcyAqIGIueTtcbiAgICAgICAgICAgIHZuMSA9IHRoaXMudl9LLmV5LnggKiB4LnkgKyBiLng7XG4gICAgICAgICAgICB2bjIgPSAwO1xuICAgICAgICAgICAgaWYgKHgueSA+PSAwICYmIHZuMSA+PSAwKSB7XG4gICAgICAgICAgICAgIHN1YlZlYzIoZCwgeCwgYSk7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMSwgZC54LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMiwgZC55LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QSwgLW1BLCBQMSwgLW1BLCBQMiwgMSwgdkEpO1xuICAgICAgICAgICAgICB3QSAtPSBpQSAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckEsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQSwgUDIpKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZCLCBtQiwgUDEsIG1CLCBQMiwgMSwgdkIpO1xuICAgICAgICAgICAgICB3QiArPSBpQiAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckIsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQiwgUDIpKTtcbiAgICAgICAgICAgICAgdmNwMS5ub3JtYWxJbXB1bHNlID0geC54O1xuICAgICAgICAgICAgICB2Y3AyLm5vcm1hbEltcHVsc2UgPSB4Lnk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeC54ID0gMDtcbiAgICAgICAgICAgIHgueSA9IDA7XG4gICAgICAgICAgICB2bjEgPSBiLng7XG4gICAgICAgICAgICB2bjIgPSBiLnk7XG4gICAgICAgICAgICBpZiAodm4xID49IDAgJiYgdm4yID49IDApIHtcbiAgICAgICAgICAgICAgc3ViVmVjMihkLCB4LCBhKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKFAxLCBkLngsIG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKFAyLCBkLnksIG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZBLCAtbUEsIFAxLCAtbUEsIFAyLCAxLCB2QSk7XG4gICAgICAgICAgICAgIHdBIC09IGlBICogKGNyb3NzVmVjMlZlYzIodmNwMS5yQSwgUDEpICsgY3Jvc3NWZWMyVmVjMih2Y3AyLnJBLCBQMikpO1xuICAgICAgICAgICAgICBjb21iaW5lM1ZlYzIodkIsIG1CLCBQMSwgbUIsIFAyLCAxLCB2Qik7XG4gICAgICAgICAgICAgIHdCICs9IGlCICogKGNyb3NzVmVjMlZlYzIodmNwMS5yQiwgUDEpICsgY3Jvc3NWZWMyVmVjMih2Y3AyLnJCLCBQMikpO1xuICAgICAgICAgICAgICB2Y3AxLm5vcm1hbEltcHVsc2UgPSB4Lng7XG4gICAgICAgICAgICAgIHZjcDIubm9ybWFsSW1wdWxzZSA9IHgueTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29weVZlYzIodmVsb2NpdHlBLnYsIHZBKTtcbiAgICAgICAgdmVsb2NpdHlBLncgPSB3QTtcbiAgICAgICAgY29weVZlYzIodmVsb2NpdHlCLnYsIHZCKTtcbiAgICAgICAgdmVsb2NpdHlCLncgPSB3QjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5hZGRUeXBlID0gZnVuY3Rpb24odHlwZTEsIHR5cGUyLCBjYWxsYmFjaykge1xuICAgICAgICBzX3JlZ2lzdGVyc1t0eXBlMV0gPSBzX3JlZ2lzdGVyc1t0eXBlMV0gfHwge307XG4gICAgICAgIHNfcmVnaXN0ZXJzW3R5cGUxXVt0eXBlMl0gPSBjYWxsYmFjaztcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5jcmVhdGUgPSBmdW5jdGlvbihmaXh0dXJlQSwgaW5kZXhBLCBmaXh0dXJlQiwgaW5kZXhCKSB7XG4gICAgICAgIHZhciB0eXBlQSA9IGZpeHR1cmVBLm1fc2hhcGUubV90eXBlO1xuICAgICAgICB2YXIgdHlwZUIgPSBmaXh0dXJlQi5tX3NoYXBlLm1fdHlwZTtcbiAgICAgICAgdmFyIGNvbnRhY3QgPSBjb250YWN0UG9vbC5hbGxvY2F0ZSgpO1xuICAgICAgICB2YXIgZXZhbHVhdGVGY247XG4gICAgICAgIGlmIChldmFsdWF0ZUZjbiA9IHNfcmVnaXN0ZXJzW3R5cGVBXSAmJiBzX3JlZ2lzdGVyc1t0eXBlQV1bdHlwZUJdKSB7XG4gICAgICAgICAgY29udGFjdC5pbml0aWFsaXplKGZpeHR1cmVBLCBpbmRleEEsIGZpeHR1cmVCLCBpbmRleEIsIGV2YWx1YXRlRmNuKTtcbiAgICAgICAgfSBlbHNlIGlmIChldmFsdWF0ZUZjbiA9IHNfcmVnaXN0ZXJzW3R5cGVCXSAmJiBzX3JlZ2lzdGVyc1t0eXBlQl1bdHlwZUFdKSB7XG4gICAgICAgICAgY29udGFjdC5pbml0aWFsaXplKGZpeHR1cmVCLCBpbmRleEIsIGZpeHR1cmVBLCBpbmRleEEsIGV2YWx1YXRlRmNuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBmaXh0dXJlQSA9IGNvbnRhY3QubV9maXh0dXJlQTtcbiAgICAgICAgZml4dHVyZUIgPSBjb250YWN0Lm1fZml4dHVyZUI7XG4gICAgICAgIGluZGV4QSA9IGNvbnRhY3QuZ2V0Q2hpbGRJbmRleEEoKTtcbiAgICAgICAgaW5kZXhCID0gY29udGFjdC5nZXRDaGlsZEluZGV4QigpO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgY29udGFjdC5tX25vZGVBLmNvbnRhY3QgPSBjb250YWN0O1xuICAgICAgICBjb250YWN0Lm1fbm9kZUEub3RoZXIgPSBib2R5QjtcbiAgICAgICAgY29udGFjdC5tX25vZGVBLnByZXYgPSBudWxsO1xuICAgICAgICBjb250YWN0Lm1fbm9kZUEubmV4dCA9IGJvZHlBLm1fY29udGFjdExpc3Q7XG4gICAgICAgIGlmIChib2R5QS5tX2NvbnRhY3RMaXN0ICE9IG51bGwpIHtcbiAgICAgICAgICBib2R5QS5tX2NvbnRhY3RMaXN0LnByZXYgPSBjb250YWN0Lm1fbm9kZUE7XG4gICAgICAgIH1cbiAgICAgICAgYm9keUEubV9jb250YWN0TGlzdCA9IGNvbnRhY3QubV9ub2RlQTtcbiAgICAgICAgY29udGFjdC5tX25vZGVCLmNvbnRhY3QgPSBjb250YWN0O1xuICAgICAgICBjb250YWN0Lm1fbm9kZUIub3RoZXIgPSBib2R5QTtcbiAgICAgICAgY29udGFjdC5tX25vZGVCLnByZXYgPSBudWxsO1xuICAgICAgICBjb250YWN0Lm1fbm9kZUIubmV4dCA9IGJvZHlCLm1fY29udGFjdExpc3Q7XG4gICAgICAgIGlmIChib2R5Qi5tX2NvbnRhY3RMaXN0ICE9IG51bGwpIHtcbiAgICAgICAgICBib2R5Qi5tX2NvbnRhY3RMaXN0LnByZXYgPSBjb250YWN0Lm1fbm9kZUI7XG4gICAgICAgIH1cbiAgICAgICAgYm9keUIubV9jb250YWN0TGlzdCA9IGNvbnRhY3QubV9ub2RlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBLmlzU2Vuc29yKCkgPT0gZmFsc2UgJiYgZml4dHVyZUIuaXNTZW5zb3IoKSA9PSBmYWxzZSkge1xuICAgICAgICAgIGJvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIGJvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb250YWN0O1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLmRlc3Ryb3kgPSBmdW5jdGlvbihjb250YWN0LCBsaXN0ZW5lcikge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSBjb250YWN0Lm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IGNvbnRhY3QubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGlmIChib2R5QSA9PT0gbnVsbCB8fCBib2R5QiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmIChjb250YWN0LmlzVG91Y2hpbmcoKSkge1xuICAgICAgICAgIGxpc3RlbmVyLmVuZENvbnRhY3QoY29udGFjdCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9ub2RlQS5wcmV2KSB7XG4gICAgICAgICAgY29udGFjdC5tX25vZGVBLnByZXYubmV4dCA9IGNvbnRhY3QubV9ub2RlQS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbm9kZUEubmV4dCkge1xuICAgICAgICAgIGNvbnRhY3QubV9ub2RlQS5uZXh0LnByZXYgPSBjb250YWN0Lm1fbm9kZUEucHJldjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdC5tX25vZGVBID09IGJvZHlBLm1fY29udGFjdExpc3QpIHtcbiAgICAgICAgICBib2R5QS5tX2NvbnRhY3RMaXN0ID0gY29udGFjdC5tX25vZGVBLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9ub2RlQi5wcmV2KSB7XG4gICAgICAgICAgY29udGFjdC5tX25vZGVCLnByZXYubmV4dCA9IGNvbnRhY3QubV9ub2RlQi5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbm9kZUIubmV4dCkge1xuICAgICAgICAgIGNvbnRhY3QubV9ub2RlQi5uZXh0LnByZXYgPSBjb250YWN0Lm1fbm9kZUIucHJldjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdC5tX25vZGVCID09IGJvZHlCLm1fY29udGFjdExpc3QpIHtcbiAgICAgICAgICBib2R5Qi5tX2NvbnRhY3RMaXN0ID0gY29udGFjdC5tX25vZGVCLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9tYW5pZm9sZC5wb2ludENvdW50ID4gMCAmJiAhZml4dHVyZUEubV9pc1NlbnNvciAmJiAhZml4dHVyZUIubV9pc1NlbnNvcikge1xuICAgICAgICAgIGJvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIGJvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRhY3RQb29sLnJlbGVhc2UoY29udGFjdCk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIENvbnRhY3QyO1xuICAgIH0oKVxuICApO1xuICB2YXIgREVGQVVMVFMkYiA9IHtcbiAgICBncmF2aXR5OiBWZWMyLnplcm8oKSxcbiAgICBhbGxvd1NsZWVwOiB0cnVlLFxuICAgIHdhcm1TdGFydGluZzogdHJ1ZSxcbiAgICBjb250aW51b3VzUGh5c2ljczogdHJ1ZSxcbiAgICBzdWJTdGVwcGluZzogZmFsc2UsXG4gICAgYmxvY2tTb2x2ZTogdHJ1ZSxcbiAgICB2ZWxvY2l0eUl0ZXJhdGlvbnM6IDgsXG4gICAgcG9zaXRpb25JdGVyYXRpb25zOiAzXG4gIH07XG4gIHZhciBXb3JsZCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBXb3JsZDIoZGVmKSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBXb3JsZDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBXb3JsZDIoZGVmKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNfc3RlcCA9IG5ldyBUaW1lU3RlcCgpO1xuICAgICAgICBpZiAoIWRlZikge1xuICAgICAgICAgIGRlZiA9IHt9O1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYpKSB7XG4gICAgICAgICAgZGVmID0geyBncmF2aXR5OiBkZWYgfTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkYik7XG4gICAgICAgIHRoaXMubV9zb2x2ZXIgPSBuZXcgU29sdmVyKHRoaXMpO1xuICAgICAgICB0aGlzLm1fYnJvYWRQaGFzZSA9IG5ldyBCcm9hZFBoYXNlKCk7XG4gICAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9jb250YWN0Q291bnQgPSAwO1xuICAgICAgICB0aGlzLm1fYm9keUxpc3QgPSBudWxsO1xuICAgICAgICB0aGlzLm1fYm9keUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5tX2pvaW50TGlzdCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9qb2ludENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5tX3N0ZXBDb21wbGV0ZSA9IHRydWU7XG4gICAgICAgIHRoaXMubV9hbGxvd1NsZWVwID0gZGVmLmFsbG93U2xlZXA7XG4gICAgICAgIHRoaXMubV9ncmF2aXR5ID0gVmVjMi5jbG9uZShkZWYuZ3Jhdml0eSk7XG4gICAgICAgIHRoaXMubV9jbGVhckZvcmNlcyA9IHRydWU7XG4gICAgICAgIHRoaXMubV9uZXdGaXh0dXJlID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX3dhcm1TdGFydGluZyA9IGRlZi53YXJtU3RhcnRpbmc7XG4gICAgICAgIHRoaXMubV9jb250aW51b3VzUGh5c2ljcyA9IGRlZi5jb250aW51b3VzUGh5c2ljcztcbiAgICAgICAgdGhpcy5tX3N1YlN0ZXBwaW5nID0gZGVmLnN1YlN0ZXBwaW5nO1xuICAgICAgICB0aGlzLm1fYmxvY2tTb2x2ZSA9IGRlZi5ibG9ja1NvbHZlO1xuICAgICAgICB0aGlzLm1fdmVsb2NpdHlJdGVyYXRpb25zID0gZGVmLnZlbG9jaXR5SXRlcmF0aW9ucztcbiAgICAgICAgdGhpcy5tX3Bvc2l0aW9uSXRlcmF0aW9ucyA9IGRlZi5wb3NpdGlvbkl0ZXJhdGlvbnM7XG4gICAgICAgIHRoaXMubV90ID0gMDtcbiAgICAgICAgdGhpcy5tX3N0ZXBfY2FsbGJhY2sgPSBbXTtcbiAgICAgIH1cbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYm9kaWVzID0gW107XG4gICAgICAgIHZhciBqb2ludHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgYjIgPSB0aGlzLmdldEJvZHlMaXN0KCk7IGIyOyBiMiA9IGIyLmdldE5leHQoKSkge1xuICAgICAgICAgIGJvZGllcy5wdXNoKGIyKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBqID0gdGhpcy5nZXRKb2ludExpc3QoKTsgajsgaiA9IGouZ2V0TmV4dCgpKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBqLl9zZXJpYWxpemUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgam9pbnRzLnB1c2goaik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZ3Jhdml0eTogdGhpcy5tX2dyYXZpdHksXG4gICAgICAgICAgYm9kaWVzLFxuICAgICAgICAgIGpvaW50c1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCBjb250ZXh0LCByZXN0b3JlKSB7XG4gICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgIHJldHVybiBuZXcgV29ybGQyKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHdvcmxkID0gbmV3IFdvcmxkMihkYXRhLmdyYXZpdHkpO1xuICAgICAgICBpZiAoZGF0YS5ib2RpZXMpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gZGF0YS5ib2RpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpIC09IDEpIHtcbiAgICAgICAgICAgIHdvcmxkLl9hZGRCb2R5KHJlc3RvcmUoQm9keSwgZGF0YS5ib2RpZXNbaV0sIHdvcmxkKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRhLmpvaW50cykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSBkYXRhLmpvaW50cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgd29ybGQuY3JlYXRlSm9pbnQocmVzdG9yZShKb2ludCwgZGF0YS5qb2ludHNbaV0sIHdvcmxkKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3b3JsZDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldEJvZHlMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUxpc3Q7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRKb2ludExpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9qb2ludExpc3Q7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRDb250YWN0TGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0Qm9keUNvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUNvdW50O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0Sm9pbnRDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2pvaW50Q291bnQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRDb250YWN0Q291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jb250YWN0Q291bnQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zZXRHcmF2aXR5ID0gZnVuY3Rpb24oZ3Jhdml0eSkge1xuICAgICAgICB0aGlzLm1fZ3Jhdml0eS5zZXQoZ3Jhdml0eSk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRHcmF2aXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZ3Jhdml0eTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmlzTG9ja2VkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9ja2VkO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuc2V0QWxsb3dTbGVlcGluZyA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcgPT0gdGhpcy5tX2FsbG93U2xlZXApIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2FsbG93U2xlZXAgPSBmbGFnO1xuICAgICAgICBpZiAodGhpcy5tX2FsbG93U2xlZXAgPT0gZmFsc2UpIHtcbiAgICAgICAgICBmb3IgKHZhciBiMiA9IHRoaXMubV9ib2R5TGlzdDsgYjI7IGIyID0gYjIubV9uZXh0KSB7XG4gICAgICAgICAgICBiMi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldEFsbG93U2xlZXBpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9hbGxvd1NsZWVwO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuc2V0V2FybVN0YXJ0aW5nID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICB0aGlzLm1fd2FybVN0YXJ0aW5nID0gZmxhZztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldFdhcm1TdGFydGluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3dhcm1TdGFydGluZztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnNldENvbnRpbnVvdXNQaHlzaWNzID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICB0aGlzLm1fY29udGludW91c1BoeXNpY3MgPSBmbGFnO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0Q29udGludW91c1BoeXNpY3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jb250aW51b3VzUGh5c2ljcztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnNldFN1YlN0ZXBwaW5nID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICB0aGlzLm1fc3ViU3RlcHBpbmcgPSBmbGFnO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0U3ViU3RlcHBpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9zdWJTdGVwcGluZztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnNldEF1dG9DbGVhckZvcmNlcyA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX2NsZWFyRm9yY2VzID0gZmxhZztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldEF1dG9DbGVhckZvcmNlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NsZWFyRm9yY2VzO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuY2xlYXJGb3JjZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgZm9yICh2YXIgYm9keSA9IHRoaXMubV9ib2R5TGlzdDsgYm9keTsgYm9keSA9IGJvZHkuZ2V0TmV4dCgpKSB7XG4gICAgICAgICAgYm9keS5tX2ZvcmNlLnNldFplcm8oKTtcbiAgICAgICAgICBib2R5Lm1fdG9ycXVlID0gMDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUucXVlcnlBQUJCID0gZnVuY3Rpb24oYWFiYiwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgdGhpcy5tX2Jyb2FkUGhhc2UucXVlcnkoYWFiYiwgZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICAgIHZhciBwcm94eSA9IGJyb2FkUGhhc2UuZ2V0VXNlckRhdGEocHJveHlJZCk7XG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKHByb3h5LmZpeHR1cmUpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnJheUNhc3QgPSBmdW5jdGlvbihwb2ludDEsIHBvaW50MiwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgdGhpcy5tX2Jyb2FkUGhhc2UucmF5Q2FzdCh7XG4gICAgICAgICAgbWF4RnJhY3Rpb246IDEsXG4gICAgICAgICAgcDE6IHBvaW50MSxcbiAgICAgICAgICBwMjogcG9pbnQyXG4gICAgICAgIH0sIGZ1bmN0aW9uKGlucHV0MiwgcHJveHlJZCkge1xuICAgICAgICAgIHZhciBwcm94eSA9IGJyb2FkUGhhc2UuZ2V0VXNlckRhdGEocHJveHlJZCk7XG4gICAgICAgICAgdmFyIGZpeHR1cmUgPSBwcm94eS5maXh0dXJlO1xuICAgICAgICAgIHZhciBpbmRleCA9IHByb3h5LmNoaWxkSW5kZXg7XG4gICAgICAgICAgdmFyIG91dHB1dDIgPSB7fTtcbiAgICAgICAgICB2YXIgaGl0ID0gZml4dHVyZS5yYXlDYXN0KG91dHB1dDIsIGlucHV0MiwgaW5kZXgpO1xuICAgICAgICAgIGlmIChoaXQpIHtcbiAgICAgICAgICAgIHZhciBmcmFjdGlvbiA9IG91dHB1dDIuZnJhY3Rpb247XG4gICAgICAgICAgICB2YXIgcG9pbnQzID0gVmVjMi5hZGQoVmVjMi5tdWxOdW1WZWMyKDEgLSBmcmFjdGlvbiwgaW5wdXQyLnAxKSwgVmVjMi5tdWxOdW1WZWMyKGZyYWN0aW9uLCBpbnB1dDIucDIpKTtcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhmaXh0dXJlLCBwb2ludDMsIG91dHB1dDIubm9ybWFsLCBmcmFjdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBpbnB1dDIubWF4RnJhY3Rpb247XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0UHJveHlDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2Jyb2FkUGhhc2UuZ2V0UHJveHlDb3VudCgpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0VHJlZUhlaWdodCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2Jyb2FkUGhhc2UuZ2V0VHJlZUhlaWdodCgpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0VHJlZUJhbGFuY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9icm9hZFBoYXNlLmdldFRyZWVCYWxhbmNlKCk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRUcmVlUXVhbGl0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2Jyb2FkUGhhc2UuZ2V0VHJlZVF1YWxpdHkoKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnNoaWZ0T3JpZ2luID0gZnVuY3Rpb24obmV3T3JpZ2luKSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgYjIgPSB0aGlzLm1fYm9keUxpc3Q7IGIyOyBiMiA9IGIyLm1fbmV4dCkge1xuICAgICAgICAgIGIyLm1feGYucC5zdWIobmV3T3JpZ2luKTtcbiAgICAgICAgICBiMi5tX3N3ZWVwLmMwLnN1YihuZXdPcmlnaW4pO1xuICAgICAgICAgIGIyLm1fc3dlZXAuYy5zdWIobmV3T3JpZ2luKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBqID0gdGhpcy5tX2pvaW50TGlzdDsgajsgaiA9IGoubV9uZXh0KSB7XG4gICAgICAgICAgai5zaGlmdE9yaWdpbihuZXdPcmlnaW4pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9icm9hZFBoYXNlLnNoaWZ0T3JpZ2luKG5ld09yaWdpbik7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5fYWRkQm9keSA9IGZ1bmN0aW9uKGJvZHkpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNMb2NrZWQoKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBib2R5Lm1fcHJldiA9IG51bGw7XG4gICAgICAgIGJvZHkubV9uZXh0ID0gdGhpcy5tX2JvZHlMaXN0O1xuICAgICAgICBpZiAodGhpcy5tX2JvZHlMaXN0KSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlMaXN0Lm1fcHJldiA9IGJvZHk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlMaXN0ID0gYm9keTtcbiAgICAgICAgKyt0aGlzLm1fYm9keUNvdW50O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuY3JlYXRlQm9keSA9IGZ1bmN0aW9uKGFyZzEsIGFyZzIpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNMb2NrZWQoKSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkZWYgPSB7fTtcbiAgICAgICAgaWYgKCFhcmcxKSA7XG4gICAgICAgIGVsc2UgaWYgKFZlYzIuaXNWYWxpZChhcmcxKSkge1xuICAgICAgICAgIGRlZiA9IHsgcG9zaXRpb246IGFyZzEsIGFuZ2xlOiBhcmcyIH07XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZzEgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICBkZWYgPSBhcmcxO1xuICAgICAgICB9XG4gICAgICAgIHZhciBib2R5ID0gbmV3IEJvZHkodGhpcywgZGVmKTtcbiAgICAgICAgdGhpcy5fYWRkQm9keShib2R5KTtcbiAgICAgICAgcmV0dXJuIGJvZHk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5jcmVhdGVEeW5hbWljQm9keSA9IGZ1bmN0aW9uKGFyZzEsIGFyZzIpIHtcbiAgICAgICAgdmFyIGRlZiA9IHt9O1xuICAgICAgICBpZiAoIWFyZzEpIDtcbiAgICAgICAgZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGFyZzEpKSB7XG4gICAgICAgICAgZGVmID0geyBwb3NpdGlvbjogYXJnMSwgYW5nbGU6IGFyZzIgfTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYXJnMSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIGRlZiA9IGFyZzE7XG4gICAgICAgIH1cbiAgICAgICAgZGVmLnR5cGUgPSBcImR5bmFtaWNcIjtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQm9keShkZWYpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuY3JlYXRlS2luZW1hdGljQm9keSA9IGZ1bmN0aW9uKGFyZzEsIGFyZzIpIHtcbiAgICAgICAgdmFyIGRlZiA9IHt9O1xuICAgICAgICBpZiAoIWFyZzEpIDtcbiAgICAgICAgZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGFyZzEpKSB7XG4gICAgICAgICAgZGVmID0geyBwb3NpdGlvbjogYXJnMSwgYW5nbGU6IGFyZzIgfTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYXJnMSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIGRlZiA9IGFyZzE7XG4gICAgICAgIH1cbiAgICAgICAgZGVmLnR5cGUgPSBcImtpbmVtYXRpY1wiO1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVCb2R5KGRlZik7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5kZXN0cm95Qm9keSA9IGZ1bmN0aW9uKGIyKSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGIyLm1fZGVzdHJveWVkKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBqZSA9IGIyLm1fam9pbnRMaXN0O1xuICAgICAgICB3aGlsZSAoamUpIHtcbiAgICAgICAgICB2YXIgamUwID0gamU7XG4gICAgICAgICAgamUgPSBqZS5uZXh0O1xuICAgICAgICAgIHRoaXMucHVibGlzaChcInJlbW92ZS1qb2ludFwiLCBqZTAuam9pbnQpO1xuICAgICAgICAgIHRoaXMuZGVzdHJveUpvaW50KGplMC5qb2ludCk7XG4gICAgICAgICAgYjIubV9qb2ludExpc3QgPSBqZTtcbiAgICAgICAgfVxuICAgICAgICBiMi5tX2pvaW50TGlzdCA9IG51bGw7XG4gICAgICAgIHZhciBjZSA9IGIyLm1fY29udGFjdExpc3Q7XG4gICAgICAgIHdoaWxlIChjZSkge1xuICAgICAgICAgIHZhciBjZTAgPSBjZTtcbiAgICAgICAgICBjZSA9IGNlLm5leHQ7XG4gICAgICAgICAgdGhpcy5kZXN0cm95Q29udGFjdChjZTAuY29udGFjdCk7XG4gICAgICAgICAgYjIubV9jb250YWN0TGlzdCA9IGNlO1xuICAgICAgICB9XG4gICAgICAgIGIyLm1fY29udGFjdExpc3QgPSBudWxsO1xuICAgICAgICB2YXIgZiA9IGIyLm1fZml4dHVyZUxpc3Q7XG4gICAgICAgIHdoaWxlIChmKSB7XG4gICAgICAgICAgdmFyIGYwID0gZjtcbiAgICAgICAgICBmID0gZi5tX25leHQ7XG4gICAgICAgICAgdGhpcy5wdWJsaXNoKFwicmVtb3ZlLWZpeHR1cmVcIiwgZjApO1xuICAgICAgICAgIGYwLmRlc3Ryb3lQcm94aWVzKHRoaXMubV9icm9hZFBoYXNlKTtcbiAgICAgICAgICBiMi5tX2ZpeHR1cmVMaXN0ID0gZjtcbiAgICAgICAgfVxuICAgICAgICBiMi5tX2ZpeHR1cmVMaXN0ID0gbnVsbDtcbiAgICAgICAgaWYgKGIyLm1fcHJldikge1xuICAgICAgICAgIGIyLm1fcHJldi5tX25leHQgPSBiMi5tX25leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGIyLm1fbmV4dCkge1xuICAgICAgICAgIGIyLm1fbmV4dC5tX3ByZXYgPSBiMi5tX3ByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGIyID09IHRoaXMubV9ib2R5TGlzdCkge1xuICAgICAgICAgIHRoaXMubV9ib2R5TGlzdCA9IGIyLm1fbmV4dDtcbiAgICAgICAgfVxuICAgICAgICBiMi5tX2Rlc3Ryb3llZCA9IHRydWU7XG4gICAgICAgIC0tdGhpcy5tX2JvZHlDb3VudDtcbiAgICAgICAgdGhpcy5wdWJsaXNoKFwicmVtb3ZlLWJvZHlcIiwgYjIpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmNyZWF0ZUpvaW50ID0gZnVuY3Rpb24oam9pbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNMb2NrZWQoKSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGpvaW50Lm1fcHJldiA9IG51bGw7XG4gICAgICAgIGpvaW50Lm1fbmV4dCA9IHRoaXMubV9qb2ludExpc3Q7XG4gICAgICAgIGlmICh0aGlzLm1fam9pbnRMaXN0KSB7XG4gICAgICAgICAgdGhpcy5tX2pvaW50TGlzdC5tX3ByZXYgPSBqb2ludDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fam9pbnRMaXN0ID0gam9pbnQ7XG4gICAgICAgICsrdGhpcy5tX2pvaW50Q291bnQ7XG4gICAgICAgIGpvaW50Lm1fZWRnZUEuam9pbnQgPSBqb2ludDtcbiAgICAgICAgam9pbnQubV9lZGdlQS5vdGhlciA9IGpvaW50Lm1fYm9keUI7XG4gICAgICAgIGpvaW50Lm1fZWRnZUEucHJldiA9IG51bGw7XG4gICAgICAgIGpvaW50Lm1fZWRnZUEubmV4dCA9IGpvaW50Lm1fYm9keUEubV9qb2ludExpc3Q7XG4gICAgICAgIGlmIChqb2ludC5tX2JvZHlBLm1fam9pbnRMaXN0KVxuICAgICAgICAgIGpvaW50Lm1fYm9keUEubV9qb2ludExpc3QucHJldiA9IGpvaW50Lm1fZWRnZUE7XG4gICAgICAgIGpvaW50Lm1fYm9keUEubV9qb2ludExpc3QgPSBqb2ludC5tX2VkZ2VBO1xuICAgICAgICBqb2ludC5tX2VkZ2VCLmpvaW50ID0gam9pbnQ7XG4gICAgICAgIGpvaW50Lm1fZWRnZUIub3RoZXIgPSBqb2ludC5tX2JvZHlBO1xuICAgICAgICBqb2ludC5tX2VkZ2VCLnByZXYgPSBudWxsO1xuICAgICAgICBqb2ludC5tX2VkZ2VCLm5leHQgPSBqb2ludC5tX2JvZHlCLm1fam9pbnRMaXN0O1xuICAgICAgICBpZiAoam9pbnQubV9ib2R5Qi5tX2pvaW50TGlzdClcbiAgICAgICAgICBqb2ludC5tX2JvZHlCLm1fam9pbnRMaXN0LnByZXYgPSBqb2ludC5tX2VkZ2VCO1xuICAgICAgICBqb2ludC5tX2JvZHlCLm1fam9pbnRMaXN0ID0gam9pbnQubV9lZGdlQjtcbiAgICAgICAgaWYgKGpvaW50Lm1fY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZSkge1xuICAgICAgICAgIGZvciAodmFyIGVkZ2UgPSBqb2ludC5tX2JvZHlCLmdldENvbnRhY3RMaXN0KCk7IGVkZ2U7IGVkZ2UgPSBlZGdlLm5leHQpIHtcbiAgICAgICAgICAgIGlmIChlZGdlLm90aGVyID09IGpvaW50Lm1fYm9keUEpIHtcbiAgICAgICAgICAgICAgZWRnZS5jb250YWN0LmZsYWdGb3JGaWx0ZXJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZGVzdHJveUpvaW50ID0gZnVuY3Rpb24oam9pbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNMb2NrZWQoKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbnQubV9wcmV2KSB7XG4gICAgICAgICAgam9pbnQubV9wcmV2Lm1fbmV4dCA9IGpvaW50Lm1fbmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbnQubV9uZXh0KSB7XG4gICAgICAgICAgam9pbnQubV9uZXh0Lm1fcHJldiA9IGpvaW50Lm1fcHJldjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbnQgPT0gdGhpcy5tX2pvaW50TGlzdCkge1xuICAgICAgICAgIHRoaXMubV9qb2ludExpc3QgPSBqb2ludC5tX25leHQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJvZHlBID0gam9pbnQubV9ib2R5QTtcbiAgICAgICAgdmFyIGJvZHlCID0gam9pbnQubV9ib2R5QjtcbiAgICAgICAgYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIGJvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICBpZiAoam9pbnQubV9lZGdlQS5wcmV2KSB7XG4gICAgICAgICAgam9pbnQubV9lZGdlQS5wcmV2Lm5leHQgPSBqb2ludC5tX2VkZ2VBLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50Lm1fZWRnZUEubmV4dCkge1xuICAgICAgICAgIGpvaW50Lm1fZWRnZUEubmV4dC5wcmV2ID0gam9pbnQubV9lZGdlQS5wcmV2O1xuICAgICAgICB9XG4gICAgICAgIGlmIChqb2ludC5tX2VkZ2VBID09IGJvZHlBLm1fam9pbnRMaXN0KSB7XG4gICAgICAgICAgYm9keUEubV9qb2ludExpc3QgPSBqb2ludC5tX2VkZ2VBLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgam9pbnQubV9lZGdlQS5wcmV2ID0gbnVsbDtcbiAgICAgICAgam9pbnQubV9lZGdlQS5uZXh0ID0gbnVsbDtcbiAgICAgICAgaWYgKGpvaW50Lm1fZWRnZUIucHJldikge1xuICAgICAgICAgIGpvaW50Lm1fZWRnZUIucHJldi5uZXh0ID0gam9pbnQubV9lZGdlQi5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChqb2ludC5tX2VkZ2VCLm5leHQpIHtcbiAgICAgICAgICBqb2ludC5tX2VkZ2VCLm5leHQucHJldiA9IGpvaW50Lm1fZWRnZUIucHJldjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbnQubV9lZGdlQiA9PSBib2R5Qi5tX2pvaW50TGlzdCkge1xuICAgICAgICAgIGJvZHlCLm1fam9pbnRMaXN0ID0gam9pbnQubV9lZGdlQi5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGpvaW50Lm1fZWRnZUIucHJldiA9IG51bGw7XG4gICAgICAgIGpvaW50Lm1fZWRnZUIubmV4dCA9IG51bGw7XG4gICAgICAgIC0tdGhpcy5tX2pvaW50Q291bnQ7XG4gICAgICAgIGlmIChqb2ludC5tX2NvbGxpZGVDb25uZWN0ZWQgPT0gZmFsc2UpIHtcbiAgICAgICAgICB2YXIgZWRnZSA9IGJvZHlCLmdldENvbnRhY3RMaXN0KCk7XG4gICAgICAgICAgd2hpbGUgKGVkZ2UpIHtcbiAgICAgICAgICAgIGlmIChlZGdlLm90aGVyID09IGJvZHlBKSB7XG4gICAgICAgICAgICAgIGVkZ2UuY29udGFjdC5mbGFnRm9yRmlsdGVyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnB1Ymxpc2goXCJyZW1vdmUtam9pbnRcIiwgam9pbnQpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuc3RlcCA9IGZ1bmN0aW9uKHRpbWVTdGVwLCB2ZWxvY2l0eUl0ZXJhdGlvbnMsIHBvc2l0aW9uSXRlcmF0aW9ucykge1xuICAgICAgICB0aGlzLnB1Ymxpc2goXCJwcmUtc3RlcFwiLCB0aW1lU3RlcCk7XG4gICAgICAgIGlmICgodmVsb2NpdHlJdGVyYXRpb25zIHwgMCkgIT09IHZlbG9jaXR5SXRlcmF0aW9ucykge1xuICAgICAgICAgIHZlbG9jaXR5SXRlcmF0aW9ucyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdmVsb2NpdHlJdGVyYXRpb25zID0gdmVsb2NpdHlJdGVyYXRpb25zIHx8IHRoaXMubV92ZWxvY2l0eUl0ZXJhdGlvbnM7XG4gICAgICAgIHBvc2l0aW9uSXRlcmF0aW9ucyA9IHBvc2l0aW9uSXRlcmF0aW9ucyB8fCB0aGlzLm1fcG9zaXRpb25JdGVyYXRpb25zO1xuICAgICAgICBpZiAodGhpcy5tX25ld0ZpeHR1cmUpIHtcbiAgICAgICAgICB0aGlzLmZpbmROZXdDb250YWN0cygpO1xuICAgICAgICAgIHRoaXMubV9uZXdGaXh0dXJlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2xvY2tlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuc19zdGVwLnJlc2V0KHRpbWVTdGVwKTtcbiAgICAgICAgdGhpcy5zX3N0ZXAudmVsb2NpdHlJdGVyYXRpb25zID0gdmVsb2NpdHlJdGVyYXRpb25zO1xuICAgICAgICB0aGlzLnNfc3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnMgPSBwb3NpdGlvbkl0ZXJhdGlvbnM7XG4gICAgICAgIHRoaXMuc19zdGVwLndhcm1TdGFydGluZyA9IHRoaXMubV93YXJtU3RhcnRpbmc7XG4gICAgICAgIHRoaXMuc19zdGVwLmJsb2NrU29sdmUgPSB0aGlzLm1fYmxvY2tTb2x2ZTtcbiAgICAgICAgdGhpcy51cGRhdGVDb250YWN0cygpO1xuICAgICAgICBpZiAodGhpcy5tX3N0ZXBDb21wbGV0ZSAmJiB0aW1lU3RlcCA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fc29sdmVyLnNvbHZlV29ybGQodGhpcy5zX3N0ZXApO1xuICAgICAgICAgIGZvciAodmFyIGIyID0gdGhpcy5tX2JvZHlMaXN0OyBiMjsgYjIgPSBiMi5nZXROZXh0KCkpIHtcbiAgICAgICAgICAgIGlmIChiMi5tX2lzbGFuZEZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYjIuaXNTdGF0aWMoKSkge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGIyLnN5bmNocm9uaXplRml4dHVyZXMoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5maW5kTmV3Q29udGFjdHMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2NvbnRpbnVvdXNQaHlzaWNzICYmIHRpbWVTdGVwID4gMCkge1xuICAgICAgICAgIHRoaXMubV9zb2x2ZXIuc29sdmVXb3JsZFRPSSh0aGlzLnNfc3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9jbGVhckZvcmNlcykge1xuICAgICAgICAgIHRoaXMuY2xlYXJGb3JjZXMoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgIHZhciBjYWxsYmFjaztcbiAgICAgICAgd2hpbGUgKGNhbGxiYWNrID0gdGhpcy5tX3N0ZXBfY2FsbGJhY2suc2hpZnQoKSkge1xuICAgICAgICAgIGNhbGxiYWNrKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHVibGlzaChcInBvc3Qtc3RlcFwiLCB0aW1lU3RlcCk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5xdWV1ZVVwZGF0ZSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0xvY2tlZCgpKSB7XG4gICAgICAgICAgY2FsbGJhY2sodGhpcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3N0ZXBfY2FsbGJhY2sucHVzaChjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmZpbmROZXdDb250YWN0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLm1fYnJvYWRQaGFzZS51cGRhdGVQYWlycyhmdW5jdGlvbihwcm94eUEsIHByb3h5Qikge1xuICAgICAgICAgIHJldHVybiBfdGhpcy5jcmVhdGVDb250YWN0KHByb3h5QSwgcHJveHlCKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5jcmVhdGVDb250YWN0ID0gZnVuY3Rpb24ocHJveHlBLCBwcm94eUIpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gcHJveHlBLmZpeHR1cmU7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHByb3h5Qi5maXh0dXJlO1xuICAgICAgICB2YXIgaW5kZXhBID0gcHJveHlBLmNoaWxkSW5kZXg7XG4gICAgICAgIHZhciBpbmRleEIgPSBwcm94eUIuY2hpbGRJbmRleDtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEuZ2V0Qm9keSgpO1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5nZXRCb2R5KCk7XG4gICAgICAgIGlmIChib2R5QSA9PSBib2R5Qikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZWRnZSA9IGJvZHlCLmdldENvbnRhY3RMaXN0KCk7XG4gICAgICAgIHdoaWxlIChlZGdlKSB7XG4gICAgICAgICAgaWYgKGVkZ2Uub3RoZXIgPT0gYm9keUEpIHtcbiAgICAgICAgICAgIHZhciBmQSA9IGVkZ2UuY29udGFjdC5nZXRGaXh0dXJlQSgpO1xuICAgICAgICAgICAgdmFyIGZCID0gZWRnZS5jb250YWN0LmdldEZpeHR1cmVCKCk7XG4gICAgICAgICAgICB2YXIgaUEgPSBlZGdlLmNvbnRhY3QuZ2V0Q2hpbGRJbmRleEEoKTtcbiAgICAgICAgICAgIHZhciBpQiA9IGVkZ2UuY29udGFjdC5nZXRDaGlsZEluZGV4QigpO1xuICAgICAgICAgICAgaWYgKGZBID09IGZpeHR1cmVBICYmIGZCID09IGZpeHR1cmVCICYmIGlBID09IGluZGV4QSAmJiBpQiA9PSBpbmRleEIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZBID09IGZpeHR1cmVCICYmIGZCID09IGZpeHR1cmVBICYmIGlBID09IGluZGV4QiAmJiBpQiA9PSBpbmRleEEpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChib2R5Qi5zaG91bGRDb2xsaWRlKGJvZHlBKSA9PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZml4dHVyZUIuc2hvdWxkQ29sbGlkZShmaXh0dXJlQSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbnRhY3QgPSBDb250YWN0LmNyZWF0ZShmaXh0dXJlQSwgaW5kZXhBLCBmaXh0dXJlQiwgaW5kZXhCKTtcbiAgICAgICAgaWYgKGNvbnRhY3QgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb250YWN0Lm1fcHJldiA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLm1fY29udGFjdExpc3QgIT0gbnVsbCkge1xuICAgICAgICAgIGNvbnRhY3QubV9uZXh0ID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgICAgICAgIHRoaXMubV9jb250YWN0TGlzdC5tX3ByZXYgPSBjb250YWN0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IGNvbnRhY3Q7XG4gICAgICAgICsrdGhpcy5tX2NvbnRhY3RDb3VudDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnVwZGF0ZUNvbnRhY3RzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjMjtcbiAgICAgICAgdmFyIG5leHRfYyA9IHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgICAgd2hpbGUgKGMyID0gbmV4dF9jKSB7XG4gICAgICAgICAgbmV4dF9jID0gYzIuZ2V0TmV4dCgpO1xuICAgICAgICAgIHZhciBmaXh0dXJlQSA9IGMyLmdldEZpeHR1cmVBKCk7XG4gICAgICAgICAgdmFyIGZpeHR1cmVCID0gYzIuZ2V0Rml4dHVyZUIoKTtcbiAgICAgICAgICB2YXIgaW5kZXhBID0gYzIuZ2V0Q2hpbGRJbmRleEEoKTtcbiAgICAgICAgICB2YXIgaW5kZXhCID0gYzIuZ2V0Q2hpbGRJbmRleEIoKTtcbiAgICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5nZXRCb2R5KCk7XG4gICAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIuZ2V0Qm9keSgpO1xuICAgICAgICAgIGlmIChjMi5tX2ZpbHRlckZsYWcpIHtcbiAgICAgICAgICAgIGlmIChib2R5Qi5zaG91bGRDb2xsaWRlKGJvZHlBKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3lDb250YWN0KGMyKTtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZml4dHVyZUIuc2hvdWxkQ29sbGlkZShmaXh0dXJlQSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgdGhpcy5kZXN0cm95Q29udGFjdChjMik7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYzIubV9maWx0ZXJGbGFnID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBhY3RpdmVBID0gYm9keUEuaXNBd2FrZSgpICYmICFib2R5QS5pc1N0YXRpYygpO1xuICAgICAgICAgIHZhciBhY3RpdmVCID0gYm9keUIuaXNBd2FrZSgpICYmICFib2R5Qi5pc1N0YXRpYygpO1xuICAgICAgICAgIGlmIChhY3RpdmVBID09IGZhbHNlICYmIGFjdGl2ZUIgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcHJveHlJZEEgPSBmaXh0dXJlQS5tX3Byb3hpZXNbaW5kZXhBXS5wcm94eUlkO1xuICAgICAgICAgIHZhciBwcm94eUlkQiA9IGZpeHR1cmVCLm1fcHJveGllc1tpbmRleEJdLnByb3h5SWQ7XG4gICAgICAgICAgdmFyIG92ZXJsYXAgPSB0aGlzLm1fYnJvYWRQaGFzZS50ZXN0T3ZlcmxhcChwcm94eUlkQSwgcHJveHlJZEIpO1xuICAgICAgICAgIGlmIChvdmVybGFwID09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3lDb250YWN0KGMyKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjMi51cGRhdGUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmRlc3Ryb3lDb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCkge1xuICAgICAgICBpZiAoY29udGFjdC5tX3ByZXYpIHtcbiAgICAgICAgICBjb250YWN0Lm1fcHJldi5tX25leHQgPSBjb250YWN0Lm1fbmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdC5tX25leHQpIHtcbiAgICAgICAgICBjb250YWN0Lm1fbmV4dC5tX3ByZXYgPSBjb250YWN0Lm1fcHJldjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdCA9PSB0aGlzLm1fY29udGFjdExpc3QpIHtcbiAgICAgICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBjb250YWN0Lm1fbmV4dDtcbiAgICAgICAgfVxuICAgICAgICBDb250YWN0LmRlc3Ryb3koY29udGFjdCwgdGhpcyk7XG4gICAgICAgIC0tdGhpcy5tX2NvbnRhY3RDb3VudDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLm9uID0gZnVuY3Rpb24obmFtZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lICE9PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBsaXN0ZW5lciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9saXN0ZW5lcnMpIHtcbiAgICAgICAgICB0aGlzLl9saXN0ZW5lcnMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2xpc3RlbmVyc1tuYW1lXSkge1xuICAgICAgICAgIHRoaXMuX2xpc3RlbmVyc1tuYW1lXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xpc3RlbmVyc1tuYW1lXS5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbihuYW1lLCBsaXN0ZW5lcikge1xuICAgICAgICBpZiAodHlwZW9mIG5hbWUgIT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGxpc3RlbmVyICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzICYmIHRoaXMuX2xpc3RlbmVyc1tuYW1lXTtcbiAgICAgICAgaWYgKCFsaXN0ZW5lcnMgfHwgIWxpc3RlbmVycy5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5kZXggPSBsaXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgICAgbGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5wdWJsaXNoID0gZnVuY3Rpb24obmFtZSwgYXJnMSwgYXJnMiwgYXJnMykge1xuICAgICAgICB2YXIgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzICYmIHRoaXMuX2xpc3RlbmVyc1tuYW1lXTtcbiAgICAgICAgaWYgKCFsaXN0ZW5lcnMgfHwgIWxpc3RlbmVycy5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBsID0gMDsgbCA8IGxpc3RlbmVycy5sZW5ndGg7IGwrKykge1xuICAgICAgICAgIGxpc3RlbmVyc1tsXS5jYWxsKHRoaXMsIGFyZzEsIGFyZzIsIGFyZzMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0ZW5lcnMubGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuYmVnaW5Db250YWN0ID0gZnVuY3Rpb24oY29udGFjdCkge1xuICAgICAgICB0aGlzLnB1Ymxpc2goXCJiZWdpbi1jb250YWN0XCIsIGNvbnRhY3QpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZW5kQ29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QpIHtcbiAgICAgICAgdGhpcy5wdWJsaXNoKFwiZW5kLWNvbnRhY3RcIiwgY29udGFjdCk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5wcmVTb2x2ZSA9IGZ1bmN0aW9uKGNvbnRhY3QsIG9sZE1hbmlmb2xkMikge1xuICAgICAgICB0aGlzLnB1Ymxpc2goXCJwcmUtc29sdmVcIiwgY29udGFjdCwgb2xkTWFuaWZvbGQyKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnBvc3RTb2x2ZSA9IGZ1bmN0aW9uKGNvbnRhY3QsIGltcHVsc2UpIHtcbiAgICAgICAgdGhpcy5wdWJsaXNoKFwicG9zdC1zb2x2ZVwiLCBjb250YWN0LCBpbXB1bHNlKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gV29ybGQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgVmVjMyA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBWZWMzMih4MiwgeSwgeikge1xuICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgVmVjMzIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBWZWMzMih4MiwgeSwgeik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB4MiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHRoaXMueCA9IDA7XG4gICAgICAgICAgdGhpcy55ID0gMDtcbiAgICAgICAgICB0aGlzLnogPSAwO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB4MiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMueCA9IHgyLng7XG4gICAgICAgICAgdGhpcy55ID0geDIueTtcbiAgICAgICAgICB0aGlzLnogPSB4Mi56O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMueCA9IHgyO1xuICAgICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgICAgdGhpcy56ID0gejtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgVmVjMzIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB4OiB0aGlzLngsXG4gICAgICAgICAgeTogdGhpcy55LFxuICAgICAgICAgIHo6IHRoaXMuelxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFZlYzMyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVmVjMzIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnggPSBkYXRhLng7XG4gICAgICAgIG9iai55ID0gZGF0YS55O1xuICAgICAgICBvYmoueiA9IGRhdGEuejtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBWZWMzMi5uZW8gPSBmdW5jdGlvbih4MiwgeSwgeikge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShWZWMzMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoueCA9IHgyO1xuICAgICAgICBvYmoueSA9IHk7XG4gICAgICAgIG9iai56ID0gejtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBWZWMzMi56ZXJvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFZlYzMyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai54ID0gMDtcbiAgICAgICAgb2JqLnkgPSAwO1xuICAgICAgICBvYmoueiA9IDA7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVmVjMzIuY2xvbmUgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICByZXR1cm4gVmVjMzIubmVvKHYzLngsIHYzLnksIHYzLnopO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyk7XG4gICAgICB9O1xuICAgICAgVmVjMzIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShvYmoueCkgJiYgTnVtYmVyLmlzRmluaXRlKG9iai55KSAmJiBOdW1iZXIuaXNGaW5pdGUob2JqLnopO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLmFzc2VydCA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUuc2V0WmVybyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnggPSAwO1xuICAgICAgICB0aGlzLnkgPSAwO1xuICAgICAgICB0aGlzLnogPSAwO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24oeDIsIHksIHopIHtcbiAgICAgICAgdGhpcy54ID0geDI7XG4gICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIHRoaXMueiA9IHo7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbih3KSB7XG4gICAgICAgIHRoaXMueCArPSB3Lng7XG4gICAgICAgIHRoaXMueSArPSB3Lnk7XG4gICAgICAgIHRoaXMueiArPSB3Lno7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLnByb3RvdHlwZS5zdWIgPSBmdW5jdGlvbih3KSB7XG4gICAgICAgIHRoaXMueCAtPSB3Lng7XG4gICAgICAgIHRoaXMueSAtPSB3Lnk7XG4gICAgICAgIHRoaXMueiAtPSB3Lno7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLnByb3RvdHlwZS5tdWwgPSBmdW5jdGlvbihtKSB7XG4gICAgICAgIHRoaXMueCAqPSBtO1xuICAgICAgICB0aGlzLnkgKj0gbTtcbiAgICAgICAgdGhpcy56ICo9IG07XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLmFyZUVxdWFsID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIHYzID09PSB3IHx8IHR5cGVvZiB2MyA9PT0gXCJvYmplY3RcIiAmJiB2MyAhPT0gbnVsbCAmJiB0eXBlb2YgdyA9PT0gXCJvYmplY3RcIiAmJiB3ICE9PSBudWxsICYmIHYzLnggPT09IHcueCAmJiB2My55ID09PSB3LnkgJiYgdjMueiA9PT0gdy56O1xuICAgICAgfTtcbiAgICAgIFZlYzMyLmRvdCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiB2My54ICogdy54ICsgdjMueSAqIHcueSArIHYzLnogKiB3Lno7XG4gICAgICB9O1xuICAgICAgVmVjMzIuY3Jvc3MgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gbmV3IFZlYzMyKHYzLnkgKiB3LnogLSB2My56ICogdy55LCB2My56ICogdy54IC0gdjMueCAqIHcueiwgdjMueCAqIHcueSAtIHYzLnkgKiB3LngpO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLmFkZCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjMzIodjMueCArIHcueCwgdjMueSArIHcueSwgdjMueiArIHcueik7XG4gICAgICB9O1xuICAgICAgVmVjMzIuc3ViID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzMih2My54IC0gdy54LCB2My55IC0gdy55LCB2My56IC0gdy56KTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5tdWwgPSBmdW5jdGlvbih2MywgbSkge1xuICAgICAgICByZXR1cm4gbmV3IFZlYzMyKG0gKiB2My54LCBtICogdjMueSwgbSAqIHYzLnopO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLnByb3RvdHlwZS5uZWcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy54ID0gLXRoaXMueDtcbiAgICAgICAgdGhpcy55ID0gLXRoaXMueTtcbiAgICAgICAgdGhpcy56ID0gLXRoaXMuejtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMzIubmVnID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzMigtdjMueCwgLXYzLnksIC12My56KTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVmVjMzI7XG4gICAgfSgpXG4gICk7XG4gIHZhciB2MSQyID0gdmVjMigwLCAwKTtcbiAgdmFyIHYyJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgRWRnZVNoYXBlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhFZGdlU2hhcGUyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gRWRnZVNoYXBlMih2MTIyLCB2MjIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBFZGdlU2hhcGUyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRWRnZVNoYXBlMih2MTIyLCB2MjIpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMubV90eXBlID0gRWRnZVNoYXBlMi5UWVBFO1xuICAgICAgICBfdGhpcy5tX3JhZGl1cyA9IFNldHRpbmdzSW50ZXJuYWwucG9seWdvblJhZGl1cztcbiAgICAgICAgX3RoaXMubV92ZXJ0ZXgxID0gdjEyMiA/IFZlYzIuY2xvbmUodjEyMikgOiBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV92ZXJ0ZXgyID0gdjIyID8gVmVjMi5jbG9uZSh2MjIpIDogVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fdmVydGV4MCA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX3ZlcnRleDMgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9oYXNWZXJ0ZXgwID0gZmFsc2U7XG4gICAgICAgIF90aGlzLm1faGFzVmVydGV4MyA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgdmVydGV4MTogdGhpcy5tX3ZlcnRleDEsXG4gICAgICAgICAgdmVydGV4MjogdGhpcy5tX3ZlcnRleDIsXG4gICAgICAgICAgdmVydGV4MDogdGhpcy5tX3ZlcnRleDAsXG4gICAgICAgICAgdmVydGV4MzogdGhpcy5tX3ZlcnRleDMsXG4gICAgICAgICAgaGFzVmVydGV4MDogdGhpcy5tX2hhc1ZlcnRleDAsXG4gICAgICAgICAgaGFzVmVydGV4MzogdGhpcy5tX2hhc1ZlcnRleDNcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgdmFyIHNoYXBlID0gbmV3IEVkZ2VTaGFwZTIoZGF0YS52ZXJ0ZXgxLCBkYXRhLnZlcnRleDIpO1xuICAgICAgICBpZiAoc2hhcGUubV9oYXNWZXJ0ZXgwKSB7XG4gICAgICAgICAgc2hhcGUuc2V0UHJldlZlcnRleChkYXRhLnZlcnRleDApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzaGFwZS5tX2hhc1ZlcnRleDMpIHtcbiAgICAgICAgICBzaGFwZS5zZXROZXh0VmVydGV4KGRhdGEudmVydGV4Myk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNoYXBlO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmdldFJhZGl1cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5zZXROZXh0ID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0TmV4dFZlcnRleCh2Myk7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuc2V0TmV4dFZlcnRleCA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIGlmICh2Mykge1xuICAgICAgICAgIHRoaXMubV92ZXJ0ZXgzLnNldFZlYzIodjMpO1xuICAgICAgICAgIHRoaXMubV9oYXNWZXJ0ZXgzID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdmVydGV4My5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX2hhc1ZlcnRleDMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5nZXROZXh0VmVydGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdmVydGV4MztcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5zZXRQcmV2ID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0UHJldlZlcnRleCh2Myk7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuc2V0UHJldlZlcnRleCA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIGlmICh2Mykge1xuICAgICAgICAgIHRoaXMubV92ZXJ0ZXgwLnNldFZlYzIodjMpO1xuICAgICAgICAgIHRoaXMubV9oYXNWZXJ0ZXgwID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdmVydGV4MC5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX2hhc1ZlcnRleDAgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5nZXRQcmV2VmVydGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdmVydGV4MDtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5fc2V0ID0gZnVuY3Rpb24odjEyMiwgdjIyKSB7XG4gICAgICAgIHRoaXMubV92ZXJ0ZXgxLnNldFZlYzIodjEyMik7XG4gICAgICAgIHRoaXMubV92ZXJ0ZXgyLnNldFZlYzIodjIyKTtcbiAgICAgICAgdGhpcy5tX2hhc1ZlcnRleDAgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2hhc1ZlcnRleDMgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuX2Nsb25lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IG5ldyBFZGdlU2hhcGUyKCk7XG4gICAgICAgIGNsb25lLm1fdHlwZSA9IHRoaXMubV90eXBlO1xuICAgICAgICBjbG9uZS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICAgIGNsb25lLm1fdmVydGV4MS5zZXRWZWMyKHRoaXMubV92ZXJ0ZXgxKTtcbiAgICAgICAgY2xvbmUubV92ZXJ0ZXgyLnNldFZlYzIodGhpcy5tX3ZlcnRleDIpO1xuICAgICAgICBjbG9uZS5tX3ZlcnRleDAuc2V0VmVjMih0aGlzLm1fdmVydGV4MCk7XG4gICAgICAgIGNsb25lLm1fdmVydGV4My5zZXRWZWMyKHRoaXMubV92ZXJ0ZXgzKTtcbiAgICAgICAgY2xvbmUubV9oYXNWZXJ0ZXgwID0gdGhpcy5tX2hhc1ZlcnRleDA7XG4gICAgICAgIGNsb25lLm1faGFzVmVydGV4MyA9IHRoaXMubV9oYXNWZXJ0ZXgzO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuZ2V0Q2hpbGRDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS50ZXN0UG9pbnQgPSBmdW5jdGlvbih4ZjIsIHApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLnJheUNhc3QgPSBmdW5jdGlvbihvdXRwdXQyLCBpbnB1dDIsIHhmMiwgY2hpbGRJbmRleCkge1xuICAgICAgICB2YXIgcDEgPSBSb3QubXVsVFZlYzIoeGYyLnEsIFZlYzIuc3ViKGlucHV0Mi5wMSwgeGYyLnApKTtcbiAgICAgICAgdmFyIHAyID0gUm90Lm11bFRWZWMyKHhmMi5xLCBWZWMyLnN1YihpbnB1dDIucDIsIHhmMi5wKSk7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuc3ViKHAyLCBwMSk7XG4gICAgICAgIHZhciB2MTIyID0gdGhpcy5tX3ZlcnRleDE7XG4gICAgICAgIHZhciB2MjIgPSB0aGlzLm1fdmVydGV4MjtcbiAgICAgICAgdmFyIGUzID0gVmVjMi5zdWIodjIyLCB2MTIyKTtcbiAgICAgICAgdmFyIG5vcm1hbDMgPSBWZWMyLm5lbyhlMy55LCAtZTMueCk7XG4gICAgICAgIG5vcm1hbDMubm9ybWFsaXplKCk7XG4gICAgICAgIHZhciBudW1lcmF0b3IgPSBWZWMyLmRvdChub3JtYWwzLCBWZWMyLnN1Yih2MTIyLCBwMSkpO1xuICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBWZWMyLmRvdChub3JtYWwzLCBkMik7XG4gICAgICAgIGlmIChkZW5vbWluYXRvciA9PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0ID0gbnVtZXJhdG9yIC8gZGVub21pbmF0b3I7XG4gICAgICAgIGlmICh0IDwgMCB8fCBpbnB1dDIubWF4RnJhY3Rpb24gPCB0KSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBxID0gVmVjMi5hZGQocDEsIFZlYzIubXVsTnVtVmVjMih0LCBkMikpO1xuICAgICAgICB2YXIgciA9IFZlYzIuc3ViKHYyMiwgdjEyMik7XG4gICAgICAgIHZhciByciA9IFZlYzIuZG90KHIsIHIpO1xuICAgICAgICBpZiAocnIgPT0gMCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgczIgPSBWZWMyLmRvdChWZWMyLnN1YihxLCB2MTIyKSwgcikgLyBycjtcbiAgICAgICAgaWYgKHMyIDwgMCB8fCAxIDwgczIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0Mi5mcmFjdGlvbiA9IHQ7XG4gICAgICAgIGlmIChudW1lcmF0b3IgPiAwKSB7XG4gICAgICAgICAgb3V0cHV0Mi5ub3JtYWwgPSBSb3QubXVsVmVjMih4ZjIucSwgbm9ybWFsMykubmVnKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb3V0cHV0Mi5ub3JtYWwgPSBSb3QubXVsVmVjMih4ZjIucSwgbm9ybWFsMyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZUFBQkIgPSBmdW5jdGlvbihhYWJiLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdHJhbnNmb3JtVmVjMih2MSQyLCB4ZjIsIHRoaXMubV92ZXJ0ZXgxKTtcbiAgICAgICAgdHJhbnNmb3JtVmVjMih2MiQxLCB4ZjIsIHRoaXMubV92ZXJ0ZXgyKTtcbiAgICAgICAgQUFCQi5jb21iaW5lUG9pbnRzKGFhYmIsIHYxJDIsIHYyJDEpO1xuICAgICAgICBBQUJCLmV4dGVuZChhYWJiLCB0aGlzLm1fcmFkaXVzKTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlTWFzcyA9IGZ1bmN0aW9uKG1hc3NEYXRhLCBkZW5zaXR5KSB7XG4gICAgICAgIG1hc3NEYXRhLm1hc3MgPSAwO1xuICAgICAgICBjb21iaW5lMlZlYzIobWFzc0RhdGEuY2VudGVyLCAwLjUsIHRoaXMubV92ZXJ0ZXgxLCAwLjUsIHRoaXMubV92ZXJ0ZXgyKTtcbiAgICAgICAgbWFzc0RhdGEuSSA9IDA7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZURpc3RhbmNlUHJveHkgPSBmdW5jdGlvbihwcm94eSkge1xuICAgICAgICBwcm94eS5tX3ZlcnRpY2VzWzBdID0gdGhpcy5tX3ZlcnRleDE7XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXNbMV0gPSB0aGlzLm1fdmVydGV4MjtcbiAgICAgICAgcHJveHkubV92ZXJ0aWNlcy5sZW5ndGggPSAyO1xuICAgICAgICBwcm94eS5tX2NvdW50ID0gMjtcbiAgICAgICAgcHJveHkubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIuVFlQRSA9IFwiZWRnZVwiO1xuICAgICAgcmV0dXJuIEVkZ2VTaGFwZTI7XG4gICAgfShTaGFwZSlcbiAgKTtcbiAgdmFyIHYxJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgdjIgPSB2ZWMyKDAsIDApO1xuICB2YXIgQ2hhaW5TaGFwZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoQ2hhaW5TaGFwZTIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBDaGFpblNoYXBlMih2ZXJ0aWNlcywgbG9vcCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIENoYWluU2hhcGUyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgQ2hhaW5TaGFwZTIodmVydGljZXMsIGxvb3ApO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMubV90eXBlID0gQ2hhaW5TaGFwZTIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9yYWRpdXMgPSBTZXR0aW5nc0ludGVybmFsLnBvbHlnb25SYWRpdXM7XG4gICAgICAgIF90aGlzLm1fdmVydGljZXMgPSBbXTtcbiAgICAgICAgX3RoaXMubV9jb3VudCA9IDA7XG4gICAgICAgIF90aGlzLm1fcHJldlZlcnRleCA9IG51bGw7XG4gICAgICAgIF90aGlzLm1fbmV4dFZlcnRleCA9IG51bGw7XG4gICAgICAgIF90aGlzLm1faGFzUHJldlZlcnRleCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5tX2hhc05leHRWZXJ0ZXggPSBmYWxzZTtcbiAgICAgICAgX3RoaXMubV9pc0xvb3AgPSAhIWxvb3A7XG4gICAgICAgIGlmICh2ZXJ0aWNlcyAmJiB2ZXJ0aWNlcy5sZW5ndGgpIHtcbiAgICAgICAgICBpZiAobG9vcCkge1xuICAgICAgICAgICAgX3RoaXMuX2NyZWF0ZUxvb3AodmVydGljZXMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfdGhpcy5fY3JlYXRlQ2hhaW4odmVydGljZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICB2ZXJ0aWNlczogdGhpcy5tX2lzTG9vcCA/IHRoaXMubV92ZXJ0aWNlcy5zbGljZSgwLCB0aGlzLm1fdmVydGljZXMubGVuZ3RoIC0gMSkgOiB0aGlzLm1fdmVydGljZXMsXG4gICAgICAgICAgaXNMb29wOiB0aGlzLm1faXNMb29wLFxuICAgICAgICAgIGhhc1ByZXZWZXJ0ZXg6IHRoaXMubV9oYXNQcmV2VmVydGV4LFxuICAgICAgICAgIGhhc05leHRWZXJ0ZXg6IHRoaXMubV9oYXNOZXh0VmVydGV4LFxuICAgICAgICAgIHByZXZWZXJ0ZXg6IG51bGwsXG4gICAgICAgICAgbmV4dFZlcnRleDogbnVsbFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5tX3ByZXZWZXJ0ZXgpIHtcbiAgICAgICAgICBkYXRhLnByZXZWZXJ0ZXggPSB0aGlzLm1fcHJldlZlcnRleDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX25leHRWZXJ0ZXgpIHtcbiAgICAgICAgICBkYXRhLm5leHRWZXJ0ZXggPSB0aGlzLm1fbmV4dFZlcnRleDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCBmaXh0dXJlLCByZXN0b3JlKSB7XG4gICAgICAgIHZhciB2ZXJ0aWNlcyA9IFtdO1xuICAgICAgICBpZiAoZGF0YS52ZXJ0aWNlcykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS52ZXJ0aWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmVydGljZXMucHVzaChyZXN0b3JlKFZlYzIsIGRhdGEudmVydGljZXNbaV0pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNoYXBlID0gbmV3IENoYWluU2hhcGUyKHZlcnRpY2VzLCBkYXRhLmlzTG9vcCk7XG4gICAgICAgIGlmIChkYXRhLnByZXZWZXJ0ZXgpIHtcbiAgICAgICAgICBzaGFwZS5zZXRQcmV2VmVydGV4KGRhdGEucHJldlZlcnRleCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGEubmV4dFZlcnRleCkge1xuICAgICAgICAgIHNoYXBlLnNldE5leHRWZXJ0ZXgoZGF0YS5uZXh0VmVydGV4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hhcGU7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRSYWRpdXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLl9jcmVhdGVMb29wID0gZnVuY3Rpb24odmVydGljZXMpIHtcbiAgICAgICAgaWYgKHZlcnRpY2VzLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGk7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlcyA9IFtdO1xuICAgICAgICB0aGlzLm1fY291bnQgPSB2ZXJ0aWNlcy5sZW5ndGggKyAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZlcnRpY2VzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldID0gVmVjMi5jbG9uZSh2ZXJ0aWNlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW3ZlcnRpY2VzLmxlbmd0aF0gPSBWZWMyLmNsb25lKHZlcnRpY2VzWzBdKTtcbiAgICAgICAgdGhpcy5tX3ByZXZWZXJ0ZXggPSB0aGlzLm1fdmVydGljZXNbdGhpcy5tX2NvdW50IC0gMl07XG4gICAgICAgIHRoaXMubV9uZXh0VmVydGV4ID0gdGhpcy5tX3ZlcnRpY2VzWzFdO1xuICAgICAgICB0aGlzLm1faGFzUHJldlZlcnRleCA9IHRydWU7XG4gICAgICAgIHRoaXMubV9oYXNOZXh0VmVydGV4ID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLl9jcmVhdGVDaGFpbiA9IGZ1bmN0aW9uKHZlcnRpY2VzKSB7XG4gICAgICAgIHZhciBpO1xuICAgICAgICB0aGlzLm1fdmVydGljZXMgPSBbXTtcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gdmVydGljZXMubGVuZ3RoO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZlcnRpY2VzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldID0gVmVjMi5jbG9uZSh2ZXJ0aWNlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3ByZXZWZXJ0ZXggPSBudWxsO1xuICAgICAgICB0aGlzLm1fbmV4dFZlcnRleCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9oYXNQcmV2VmVydGV4ID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9oYXNOZXh0VmVydGV4ID0gZmFsc2U7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMubV9pc0xvb3ApIHtcbiAgICAgICAgICB0aGlzLl9jcmVhdGVMb29wKHRoaXMubV92ZXJ0aWNlcy5zbGljZSgwLCB0aGlzLm1fdmVydGljZXMubGVuZ3RoIC0gMSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX2NyZWF0ZUNoYWluKHRoaXMubV92ZXJ0aWNlcyk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuc2V0UHJldlZlcnRleCA9IGZ1bmN0aW9uKHByZXZWZXJ0ZXgpIHtcbiAgICAgICAgdGhpcy5tX3ByZXZWZXJ0ZXggPSBwcmV2VmVydGV4O1xuICAgICAgICB0aGlzLm1faGFzUHJldlZlcnRleCA9IHRydWU7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmdldFByZXZWZXJ0ZXggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9wcmV2VmVydGV4O1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5zZXROZXh0VmVydGV4ID0gZnVuY3Rpb24obmV4dFZlcnRleCkge1xuICAgICAgICB0aGlzLm1fbmV4dFZlcnRleCA9IG5leHRWZXJ0ZXg7XG4gICAgICAgIHRoaXMubV9oYXNOZXh0VmVydGV4ID0gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuZ2V0TmV4dFZlcnRleCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX25leHRWZXJ0ZXg7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLl9jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgQ2hhaW5TaGFwZTIoKTtcbiAgICAgICAgY2xvbmUuX2NyZWF0ZUNoYWluKHRoaXMubV92ZXJ0aWNlcyk7XG4gICAgICAgIGNsb25lLm1fdHlwZSA9IHRoaXMubV90eXBlO1xuICAgICAgICBjbG9uZS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICAgIGNsb25lLm1fcHJldlZlcnRleCA9IHRoaXMubV9wcmV2VmVydGV4O1xuICAgICAgICBjbG9uZS5tX25leHRWZXJ0ZXggPSB0aGlzLm1fbmV4dFZlcnRleDtcbiAgICAgICAgY2xvbmUubV9oYXNQcmV2VmVydGV4ID0gdGhpcy5tX2hhc1ByZXZWZXJ0ZXg7XG4gICAgICAgIGNsb25lLm1faGFzTmV4dFZlcnRleCA9IHRoaXMubV9oYXNOZXh0VmVydGV4O1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmdldENoaWxkQ291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jb3VudCAtIDE7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmdldENoaWxkRWRnZSA9IGZ1bmN0aW9uKGVkZ2UsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgZWRnZS5tX3R5cGUgPSBFZGdlU2hhcGUuVFlQRTtcbiAgICAgICAgZWRnZS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICAgIGVkZ2UubV92ZXJ0ZXgxID0gdGhpcy5tX3ZlcnRpY2VzW2NoaWxkSW5kZXhdO1xuICAgICAgICBlZGdlLm1fdmVydGV4MiA9IHRoaXMubV92ZXJ0aWNlc1tjaGlsZEluZGV4ICsgMV07XG4gICAgICAgIGlmIChjaGlsZEluZGV4ID4gMCkge1xuICAgICAgICAgIGVkZ2UubV92ZXJ0ZXgwID0gdGhpcy5tX3ZlcnRpY2VzW2NoaWxkSW5kZXggLSAxXTtcbiAgICAgICAgICBlZGdlLm1faGFzVmVydGV4MCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWRnZS5tX3ZlcnRleDAgPSB0aGlzLm1fcHJldlZlcnRleDtcbiAgICAgICAgICBlZGdlLm1faGFzVmVydGV4MCA9IHRoaXMubV9oYXNQcmV2VmVydGV4O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGlsZEluZGV4IDwgdGhpcy5tX2NvdW50IC0gMikge1xuICAgICAgICAgIGVkZ2UubV92ZXJ0ZXgzID0gdGhpcy5tX3ZlcnRpY2VzW2NoaWxkSW5kZXggKyAyXTtcbiAgICAgICAgICBlZGdlLm1faGFzVmVydGV4MyA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWRnZS5tX3ZlcnRleDMgPSB0aGlzLm1fbmV4dFZlcnRleDtcbiAgICAgICAgICBlZGdlLm1faGFzVmVydGV4MyA9IHRoaXMubV9oYXNOZXh0VmVydGV4O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmdldFZlcnRleCA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA8IHRoaXMubV9jb3VudCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLm1fdmVydGljZXNbaW5kZXhdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLm1fdmVydGljZXNbMF07XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuaXNMb29wID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1faXNMb29wO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS50ZXN0UG9pbnQgPSBmdW5jdGlvbih4ZjIsIHApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdmFyIGVkZ2VTaGFwZSA9IG5ldyBFZGdlU2hhcGUodGhpcy5nZXRWZXJ0ZXgoY2hpbGRJbmRleCksIHRoaXMuZ2V0VmVydGV4KGNoaWxkSW5kZXggKyAxKSk7XG4gICAgICAgIHJldHVybiBlZGdlU2hhcGUucmF5Q2FzdChvdXRwdXQyLCBpbnB1dDIsIHhmMiwgMCk7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmNvbXB1dGVBQUJCID0gZnVuY3Rpb24oYWFiYiwgeGYyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHRyYW5zZm9ybVZlYzIodjEkMSwgeGYyLCB0aGlzLmdldFZlcnRleChjaGlsZEluZGV4KSk7XG4gICAgICAgIHRyYW5zZm9ybVZlYzIodjIsIHhmMiwgdGhpcy5nZXRWZXJ0ZXgoY2hpbGRJbmRleCArIDEpKTtcbiAgICAgICAgQUFCQi5jb21iaW5lUG9pbnRzKGFhYmIsIHYxJDEsIHYyKTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZU1hc3MgPSBmdW5jdGlvbihtYXNzRGF0YSwgZGVuc2l0eSkge1xuICAgICAgICBtYXNzRGF0YS5tYXNzID0gMDtcbiAgICAgICAgemVyb1ZlYzIobWFzc0RhdGEuY2VudGVyKTtcbiAgICAgICAgbWFzc0RhdGEuSSA9IDA7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmNvbXB1dGVEaXN0YW5jZVByb3h5ID0gZnVuY3Rpb24ocHJveHksIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgcHJveHkubV92ZXJ0aWNlc1swXSA9IHRoaXMuZ2V0VmVydGV4KGNoaWxkSW5kZXgpO1xuICAgICAgICBwcm94eS5tX3ZlcnRpY2VzWzFdID0gdGhpcy5nZXRWZXJ0ZXgoY2hpbGRJbmRleCArIDEpO1xuICAgICAgICBwcm94eS5tX2NvdW50ID0gMjtcbiAgICAgICAgcHJveHkubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLlRZUEUgPSBcImNoYWluXCI7XG4gICAgICByZXR1cm4gQ2hhaW5TaGFwZTI7XG4gICAgfShTaGFwZSlcbiAgKTtcbiAgdmFyIG1hdGhfbWF4JDEgPSBNYXRoLm1heDtcbiAgdmFyIG1hdGhfbWluJDMgPSBNYXRoLm1pbjtcbiAgdmFyIHRlbXAkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBlJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgZTEkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBlMiQxID0gdmVjMigwLCAwKTtcbiAgdmFyIGNlbnRlciA9IHZlYzIoMCwgMCk7XG4gIHZhciBzID0gdmVjMigwLCAwKTtcbiAgdmFyIFBvbHlnb25TaGFwZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoUG9seWdvblNoYXBlMiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIFBvbHlnb25TaGFwZTIodmVydGljZXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBQb2x5Z29uU2hhcGUyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgUG9seWdvblNoYXBlMih2ZXJ0aWNlcyk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBQb2x5Z29uU2hhcGUyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fcmFkaXVzID0gU2V0dGluZ3NJbnRlcm5hbC5wb2x5Z29uUmFkaXVzO1xuICAgICAgICBfdGhpcy5tX2NlbnRyb2lkID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fdmVydGljZXMgPSBbXTtcbiAgICAgICAgX3RoaXMubV9ub3JtYWxzID0gW107XG4gICAgICAgIF90aGlzLm1fY291bnQgPSAwO1xuICAgICAgICBpZiAodmVydGljZXMgJiYgdmVydGljZXMubGVuZ3RoKSB7XG4gICAgICAgICAgX3RoaXMuX3NldCh2ZXJ0aWNlcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIHZlcnRpY2VzOiB0aGlzLm1fdmVydGljZXNcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIGZpeHR1cmUsIHJlc3RvcmUpIHtcbiAgICAgICAgdmFyIHZlcnRpY2VzID0gW107XG4gICAgICAgIGlmIChkYXRhLnZlcnRpY2VzKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLnZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKHJlc3RvcmUoVmVjMiwgZGF0YS52ZXJ0aWNlc1tpXSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgc2hhcGUgPSBuZXcgUG9seWdvblNoYXBlMih2ZXJ0aWNlcyk7XG4gICAgICAgIHJldHVybiBzaGFwZTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5nZXRSYWRpdXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuX2Nsb25lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IG5ldyBQb2x5Z29uU2hhcGUyKCk7XG4gICAgICAgIGNsb25lLm1fdHlwZSA9IHRoaXMubV90eXBlO1xuICAgICAgICBjbG9uZS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICAgIGNsb25lLm1fY291bnQgPSB0aGlzLm1fY291bnQ7XG4gICAgICAgIGNsb25lLm1fY2VudHJvaWQuc2V0VmVjMih0aGlzLm1fY2VudHJvaWQpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgaSsrKSB7XG4gICAgICAgICAgY2xvbmUubV92ZXJ0aWNlcy5wdXNoKHRoaXMubV92ZXJ0aWNlc1tpXS5jbG9uZSgpKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9ub3JtYWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY2xvbmUubV9ub3JtYWxzLnB1c2godGhpcy5tX25vcm1hbHNbaV0uY2xvbmUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLmdldENoaWxkQ291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3NldCh0aGlzLm1fdmVydGljZXMpO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLl9zZXQgPSBmdW5jdGlvbih2ZXJ0aWNlcykge1xuICAgICAgICBpZiAodmVydGljZXMubGVuZ3RoIDwgMykge1xuICAgICAgICAgIHRoaXMuX3NldEFzQm94KDEsIDEpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbjIgPSBtYXRoX21pbiQzKHZlcnRpY2VzLmxlbmd0aCwgU2V0dGluZ3NJbnRlcm5hbC5tYXhQb2x5Z29uVmVydGljZXMpO1xuICAgICAgICB2YXIgcHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuMjsgKytpKSB7XG4gICAgICAgICAgdmFyIHYzID0gdmVydGljZXNbaV07XG4gICAgICAgICAgdmFyIHVuaXF1ZSA9IHRydWU7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBwcy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgaWYgKFZlYzIuZGlzdGFuY2VTcXVhcmVkKHYzLCBwc1tqXSkgPCAwLjI1ICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wU3F1YXJlZCkge1xuICAgICAgICAgICAgICB1bmlxdWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh1bmlxdWUpIHtcbiAgICAgICAgICAgIHBzLnB1c2goVmVjMi5jbG9uZSh2MykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBuMiA9IHBzLmxlbmd0aDtcbiAgICAgICAgaWYgKG4yIDwgMykge1xuICAgICAgICAgIHRoaXMuX3NldEFzQm94KDEsIDEpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaTAgPSAwO1xuICAgICAgICB2YXIgeDAgPSBwc1swXS54O1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG4yOyArK2kpIHtcbiAgICAgICAgICB2YXIgeDIgPSBwc1tpXS54O1xuICAgICAgICAgIGlmICh4MiA+IHgwIHx8IHgyID09PSB4MCAmJiBwc1tpXS55IDwgcHNbaTBdLnkpIHtcbiAgICAgICAgICAgIGkwID0gaTtcbiAgICAgICAgICAgIHgwID0geDI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBodWxsID0gW107XG4gICAgICAgIHZhciBtID0gMDtcbiAgICAgICAgdmFyIGloID0gaTA7XG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgaHVsbFttXSA9IGloO1xuICAgICAgICAgIHZhciBpZTIgPSAwO1xuICAgICAgICAgIGZvciAodmFyIGogPSAxOyBqIDwgbjI7ICsraikge1xuICAgICAgICAgICAgaWYgKGllMiA9PT0gaWgpIHtcbiAgICAgICAgICAgICAgaWUyID0gajtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgciA9IFZlYzIuc3ViKHBzW2llMl0sIHBzW2h1bGxbbV1dKTtcbiAgICAgICAgICAgIHZhciB2MyA9IFZlYzIuc3ViKHBzW2pdLCBwc1todWxsW21dXSk7XG4gICAgICAgICAgICB2YXIgYzIgPSBWZWMyLmNyb3NzVmVjMlZlYzIociwgdjMpO1xuICAgICAgICAgICAgaWYgKGMyIDwgMCkge1xuICAgICAgICAgICAgICBpZTIgPSBqO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGMyID09PSAwICYmIHYzLmxlbmd0aFNxdWFyZWQoKSA+IHIubGVuZ3RoU3F1YXJlZCgpKSB7XG4gICAgICAgICAgICAgIGllMiA9IGo7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgICsrbTtcbiAgICAgICAgICBpaCA9IGllMjtcbiAgICAgICAgICBpZiAoaWUyID09PSBpMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMykge1xuICAgICAgICAgIHRoaXMuX3NldEFzQm94KDEsIDEpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fY291bnQgPSBtO1xuICAgICAgICB0aGlzLm1fdmVydGljZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtOyArK2kpIHtcbiAgICAgICAgICB0aGlzLm1fdmVydGljZXNbaV0gPSBwc1todWxsW2ldXTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG07ICsraSkge1xuICAgICAgICAgIHZhciBpMSA9IGk7XG4gICAgICAgICAgdmFyIGkyID0gaSArIDEgPCBtID8gaSArIDEgOiAwO1xuICAgICAgICAgIHZhciBlZGdlID0gVmVjMi5zdWIodGhpcy5tX3ZlcnRpY2VzW2kyXSwgdGhpcy5tX3ZlcnRpY2VzW2kxXSk7XG4gICAgICAgICAgdGhpcy5tX25vcm1hbHNbaV0gPSBWZWMyLmNyb3NzVmVjMk51bShlZGdlLCAxKTtcbiAgICAgICAgICB0aGlzLm1fbm9ybWFsc1tpXS5ub3JtYWxpemUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fY2VudHJvaWQgPSBjb21wdXRlQ2VudHJvaWQodGhpcy5tX3ZlcnRpY2VzLCBtKTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5fc2V0QXNCb3ggPSBmdW5jdGlvbihoeCwgaHksIGNlbnRlcjIsIGFuZ2xlKSB7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlc1swXSA9IFZlYzIubmVvKGh4LCAtaHkpO1xuICAgICAgICB0aGlzLm1fdmVydGljZXNbMV0gPSBWZWMyLm5lbyhoeCwgaHkpO1xuICAgICAgICB0aGlzLm1fdmVydGljZXNbMl0gPSBWZWMyLm5lbygtaHgsIGh5KTtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzWzNdID0gVmVjMi5uZW8oLWh4LCAtaHkpO1xuICAgICAgICB0aGlzLm1fbm9ybWFsc1swXSA9IFZlYzIubmVvKDEsIDApO1xuICAgICAgICB0aGlzLm1fbm9ybWFsc1sxXSA9IFZlYzIubmVvKDAsIDEpO1xuICAgICAgICB0aGlzLm1fbm9ybWFsc1syXSA9IFZlYzIubmVvKC0xLCAwKTtcbiAgICAgICAgdGhpcy5tX25vcm1hbHNbM10gPSBWZWMyLm5lbygwLCAtMSk7XG4gICAgICAgIHRoaXMubV9jb3VudCA9IDQ7XG4gICAgICAgIGlmIChjZW50ZXIyICYmIFZlYzIuaXNWYWxpZChjZW50ZXIyKSkge1xuICAgICAgICAgIGFuZ2xlID0gYW5nbGUgfHwgMDtcbiAgICAgICAgICBjb3B5VmVjMih0aGlzLm1fY2VudHJvaWQsIGNlbnRlcjIpO1xuICAgICAgICAgIHZhciB4ZjIgPSBUcmFuc2Zvcm0uaWRlbnRpdHkoKTtcbiAgICAgICAgICB4ZjIucC5zZXRWZWMyKGNlbnRlcjIpO1xuICAgICAgICAgIHhmMi5xLnNldEFuZ2xlKGFuZ2xlKTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgICB0aGlzLm1fdmVydGljZXNbaV0gPSBUcmFuc2Zvcm0ubXVsVmVjMih4ZjIsIHRoaXMubV92ZXJ0aWNlc1tpXSk7XG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsc1tpXSA9IFJvdC5tdWxWZWMyKHhmMi5xLCB0aGlzLm1fbm9ybWFsc1tpXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUudGVzdFBvaW50ID0gZnVuY3Rpb24oeGYyLCBwKSB7XG4gICAgICAgIHZhciBwTG9jYWwgPSBkZXRyYW5zZm9ybVZlYzIodGVtcCQxLCB4ZjIsIHApO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIGRvdCA9IGRvdFZlYzIodGhpcy5tX25vcm1hbHNbaV0sIHBMb2NhbCkgLSBkb3RWZWMyKHRoaXMubV9ub3JtYWxzW2ldLCB0aGlzLm1fdmVydGljZXNbaV0pO1xuICAgICAgICAgIGlmIChkb3QgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLnJheUNhc3QgPSBmdW5jdGlvbihvdXRwdXQyLCBpbnB1dDIsIHhmMiwgY2hpbGRJbmRleCkge1xuICAgICAgICB2YXIgcDEgPSBSb3QubXVsVFZlYzIoeGYyLnEsIFZlYzIuc3ViKGlucHV0Mi5wMSwgeGYyLnApKTtcbiAgICAgICAgdmFyIHAyID0gUm90Lm11bFRWZWMyKHhmMi5xLCBWZWMyLnN1YihpbnB1dDIucDIsIHhmMi5wKSk7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuc3ViKHAyLCBwMSk7XG4gICAgICAgIHZhciBsb3dlciA9IDA7XG4gICAgICAgIHZhciB1cHBlciA9IGlucHV0Mi5tYXhGcmFjdGlvbjtcbiAgICAgICAgdmFyIGluZGV4ID0gLTE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgbnVtZXJhdG9yID0gVmVjMi5kb3QodGhpcy5tX25vcm1hbHNbaV0sIFZlYzIuc3ViKHRoaXMubV92ZXJ0aWNlc1tpXSwgcDEpKTtcbiAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBWZWMyLmRvdCh0aGlzLm1fbm9ybWFsc1tpXSwgZDIpO1xuICAgICAgICAgIGlmIChkZW5vbWluYXRvciA9PSAwKSB7XG4gICAgICAgICAgICBpZiAobnVtZXJhdG9yIDwgMCkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChkZW5vbWluYXRvciA8IDAgJiYgbnVtZXJhdG9yIDwgbG93ZXIgKiBkZW5vbWluYXRvcikge1xuICAgICAgICAgICAgICBsb3dlciA9IG51bWVyYXRvciAvIGRlbm9taW5hdG9yO1xuICAgICAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRlbm9taW5hdG9yID4gMCAmJiBudW1lcmF0b3IgPCB1cHBlciAqIGRlbm9taW5hdG9yKSB7XG4gICAgICAgICAgICAgIHVwcGVyID0gbnVtZXJhdG9yIC8gZGVub21pbmF0b3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh1cHBlciA8IGxvd2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgICAgb3V0cHV0Mi5mcmFjdGlvbiA9IGxvd2VyO1xuICAgICAgICAgIG91dHB1dDIubm9ybWFsID0gUm90Lm11bFZlYzIoeGYyLnEsIHRoaXMubV9ub3JtYWxzW2luZGV4XSk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLmNvbXB1dGVBQUJCID0gZnVuY3Rpb24oYWFiYiwgeGYyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHZhciBtaW5YID0gSW5maW5pdHk7XG4gICAgICAgIHZhciBtaW5ZID0gSW5maW5pdHk7XG4gICAgICAgIHZhciBtYXhYID0gLUluZmluaXR5O1xuICAgICAgICB2YXIgbWF4WSA9IC1JbmZpbml0eTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciB2MyA9IHRyYW5zZm9ybVZlYzIodGVtcCQxLCB4ZjIsIHRoaXMubV92ZXJ0aWNlc1tpXSk7XG4gICAgICAgICAgbWluWCA9IG1hdGhfbWluJDMobWluWCwgdjMueCk7XG4gICAgICAgICAgbWF4WCA9IG1hdGhfbWF4JDEobWF4WCwgdjMueCk7XG4gICAgICAgICAgbWluWSA9IG1hdGhfbWluJDMobWluWSwgdjMueSk7XG4gICAgICAgICAgbWF4WSA9IG1hdGhfbWF4JDEobWF4WSwgdjMueSk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0VmVjMihhYWJiLmxvd2VyQm91bmQsIG1pblggLSB0aGlzLm1fcmFkaXVzLCBtaW5ZIC0gdGhpcy5tX3JhZGl1cyk7XG4gICAgICAgIHNldFZlYzIoYWFiYi51cHBlckJvdW5kLCBtYXhYICsgdGhpcy5tX3JhZGl1cywgbWF4WSArIHRoaXMubV9yYWRpdXMpO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLmNvbXB1dGVNYXNzID0gZnVuY3Rpb24obWFzc0RhdGEsIGRlbnNpdHkpIHtcbiAgICAgICAgemVyb1ZlYzIoY2VudGVyKTtcbiAgICAgICAgdmFyIGFyZWEgPSAwO1xuICAgICAgICB2YXIgSSA9IDA7XG4gICAgICAgIHplcm9WZWMyKHMpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgcGx1c1ZlYzIocywgdGhpcy5tX3ZlcnRpY2VzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICBzY2FsZVZlYzIocywgMSAvIHRoaXMubV9jb3VudCwgcyk7XG4gICAgICAgIHZhciBrX2ludjMgPSAxIC8gMztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHN1YlZlYzIoZTEkMSwgdGhpcy5tX3ZlcnRpY2VzW2ldLCBzKTtcbiAgICAgICAgICBpZiAoaSArIDEgPCB0aGlzLm1fY291bnQpIHtcbiAgICAgICAgICAgIHN1YlZlYzIoZTIkMSwgdGhpcy5tX3ZlcnRpY2VzW2kgKyAxXSwgcyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1YlZlYzIoZTIkMSwgdGhpcy5tX3ZlcnRpY2VzWzBdLCBzKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIEQgPSBjcm9zc1ZlYzJWZWMyKGUxJDEsIGUyJDEpO1xuICAgICAgICAgIHZhciB0cmlhbmdsZUFyZWEgPSAwLjUgKiBEO1xuICAgICAgICAgIGFyZWEgKz0gdHJpYW5nbGVBcmVhO1xuICAgICAgICAgIGNvbWJpbmUyVmVjMih0ZW1wJDEsIHRyaWFuZ2xlQXJlYSAqIGtfaW52MywgZTEkMSwgdHJpYW5nbGVBcmVhICoga19pbnYzLCBlMiQxKTtcbiAgICAgICAgICBwbHVzVmVjMihjZW50ZXIsIHRlbXAkMSk7XG4gICAgICAgICAgdmFyIGV4MSA9IGUxJDEueDtcbiAgICAgICAgICB2YXIgZXkxID0gZTEkMS55O1xuICAgICAgICAgIHZhciBleDIgPSBlMiQxLng7XG4gICAgICAgICAgdmFyIGV5MiA9IGUyJDEueTtcbiAgICAgICAgICB2YXIgaW50eDIgPSBleDEgKiBleDEgKyBleDIgKiBleDEgKyBleDIgKiBleDI7XG4gICAgICAgICAgdmFyIGludHkyID0gZXkxICogZXkxICsgZXkyICogZXkxICsgZXkyICogZXkyO1xuICAgICAgICAgIEkgKz0gMC4yNSAqIGtfaW52MyAqIEQgKiAoaW50eDIgKyBpbnR5Mik7XG4gICAgICAgIH1cbiAgICAgICAgbWFzc0RhdGEubWFzcyA9IGRlbnNpdHkgKiBhcmVhO1xuICAgICAgICBzY2FsZVZlYzIoY2VudGVyLCAxIC8gYXJlYSwgY2VudGVyKTtcbiAgICAgICAgYWRkVmVjMihtYXNzRGF0YS5jZW50ZXIsIGNlbnRlciwgcyk7XG4gICAgICAgIG1hc3NEYXRhLkkgPSBkZW5zaXR5ICogSTtcbiAgICAgICAgbWFzc0RhdGEuSSArPSBtYXNzRGF0YS5tYXNzICogKGRvdFZlYzIobWFzc0RhdGEuY2VudGVyLCBtYXNzRGF0YS5jZW50ZXIpIC0gZG90VmVjMihjZW50ZXIsIGNlbnRlcikpO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgaTEgPSBpO1xuICAgICAgICAgIHZhciBpMiA9IGkgPCB0aGlzLm1fY291bnQgLSAxID8gaTEgKyAxIDogMDtcbiAgICAgICAgICB2YXIgcCA9IHRoaXMubV92ZXJ0aWNlc1tpMV07XG4gICAgICAgICAgc3ViVmVjMihlJDEsIHRoaXMubV92ZXJ0aWNlc1tpMl0sIHApO1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5tX2NvdW50OyArK2opIHtcbiAgICAgICAgICAgIGlmIChqID09IGkxIHx8IGogPT0gaTIpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYzIgPSBjcm9zc1ZlYzJWZWMyKGUkMSwgc3ViVmVjMih0ZW1wJDEsIHRoaXMubV92ZXJ0aWNlc1tqXSwgcCkpO1xuICAgICAgICAgICAgaWYgKGMyIDwgMCkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLmNvbXB1dGVEaXN0YW5jZVByb3h5ID0gZnVuY3Rpb24ocHJveHkpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHByb3h5Lm1fdmVydGljZXNbaV0gPSB0aGlzLm1fdmVydGljZXNbaV07XG4gICAgICAgIH1cbiAgICAgICAgcHJveHkubV92ZXJ0aWNlcy5sZW5ndGggPSB0aGlzLm1fY291bnQ7XG4gICAgICAgIHByb3h5Lm1fY291bnQgPSB0aGlzLm1fY291bnQ7XG4gICAgICAgIHByb3h5Lm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLlRZUEUgPSBcInBvbHlnb25cIjtcbiAgICAgIHJldHVybiBQb2x5Z29uU2hhcGUyO1xuICAgIH0oU2hhcGUpXG4gICk7XG4gIGZ1bmN0aW9uIGNvbXB1dGVDZW50cm9pZCh2cywgY291bnQpIHtcbiAgICB2YXIgYzIgPSBWZWMyLnplcm8oKTtcbiAgICB2YXIgYXJlYSA9IDA7XG4gICAgdmFyIHBSZWYgPSBWZWMyLnplcm8oKTtcbiAgICB2YXIgaTtcbiAgICB2YXIgaW52MyA9IDEgLyAzO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkge1xuICAgICAgdmFyIHAxID0gcFJlZjtcbiAgICAgIHZhciBwMiA9IHZzW2ldO1xuICAgICAgdmFyIHAzID0gaSArIDEgPCBjb3VudCA/IHZzW2kgKyAxXSA6IHZzWzBdO1xuICAgICAgdmFyIGUxXzEgPSBWZWMyLnN1YihwMiwgcDEpO1xuICAgICAgdmFyIGUyXzEgPSBWZWMyLnN1YihwMywgcDEpO1xuICAgICAgdmFyIEQgPSBWZWMyLmNyb3NzVmVjMlZlYzIoZTFfMSwgZTJfMSk7XG4gICAgICB2YXIgdHJpYW5nbGVBcmVhID0gMC41ICogRDtcbiAgICAgIGFyZWEgKz0gdHJpYW5nbGVBcmVhO1xuICAgICAgY29tYmluZTNWZWMyKHRlbXAkMSwgMSwgcDEsIDEsIHAyLCAxLCBwMyk7XG4gICAgICBwbHVzU2NhbGVWZWMyKGMyLCB0cmlhbmdsZUFyZWEgKiBpbnYzLCB0ZW1wJDEpO1xuICAgIH1cbiAgICBjMi5tdWwoMSAvIGFyZWEpO1xuICAgIHJldHVybiBjMjtcbiAgfVxuICB2YXIgbWF0aF9zcXJ0ID0gTWF0aC5zcXJ0O1xuICB2YXIgbWF0aF9QSSQ0ID0gTWF0aC5QSTtcbiAgdmFyIHRlbXAgPSB2ZWMyKDAsIDApO1xuICB2YXIgQ2lyY2xlU2hhcGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKENpcmNsZVNoYXBlMiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIENpcmNsZVNoYXBlMihhMiwgYjIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBDaXJjbGVTaGFwZTIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBDaXJjbGVTaGFwZTIoYTIsIGIyKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IENpcmNsZVNoYXBlMi5UWVBFO1xuICAgICAgICBfdGhpcy5tX3AgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9yYWRpdXMgPSAxO1xuICAgICAgICBpZiAodHlwZW9mIGEyID09PSBcIm9iamVjdFwiICYmIFZlYzIuaXNWYWxpZChhMikpIHtcbiAgICAgICAgICBfdGhpcy5tX3Auc2V0VmVjMihhMik7XG4gICAgICAgICAgaWYgKHR5cGVvZiBiMiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgX3RoaXMubV9yYWRpdXMgPSBiMjtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGEyID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgX3RoaXMubV9yYWRpdXMgPSBhMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBwOiB0aGlzLm1fcCxcbiAgICAgICAgICByYWRpdXM6IHRoaXMubV9yYWRpdXNcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICByZXR1cm4gbmV3IENpcmNsZVNoYXBlMihkYXRhLnAsIGRhdGEucmFkaXVzKTtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5nZXRSYWRpdXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5nZXRDZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9wO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuX2Nsb25lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IG5ldyBDaXJjbGVTaGFwZTIoKTtcbiAgICAgICAgY2xvbmUubV90eXBlID0gdGhpcy5tX3R5cGU7XG4gICAgICAgIGNsb25lLm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgICAgY2xvbmUubV9wID0gdGhpcy5tX3AuY2xvbmUoKTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuZ2V0Q2hpbGRDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLnRlc3RQb2ludCA9IGZ1bmN0aW9uKHhmMiwgcCkge1xuICAgICAgICB2YXIgY2VudGVyMiA9IHRyYW5zZm9ybVZlYzIodGVtcCwgeGYyLCB0aGlzLm1fcCk7XG4gICAgICAgIHJldHVybiBkaXN0U3FyVmVjMihwLCBjZW50ZXIyKSA8PSB0aGlzLm1fcmFkaXVzICogdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLnJheUNhc3QgPSBmdW5jdGlvbihvdXRwdXQyLCBpbnB1dDIsIHhmMiwgY2hpbGRJbmRleCkge1xuICAgICAgICB2YXIgcG9zaXRpb24gPSBWZWMyLmFkZCh4ZjIucCwgUm90Lm11bFZlYzIoeGYyLnEsIHRoaXMubV9wKSk7XG4gICAgICAgIHZhciBzMiA9IFZlYzIuc3ViKGlucHV0Mi5wMSwgcG9zaXRpb24pO1xuICAgICAgICB2YXIgYjIgPSBWZWMyLmRvdChzMiwgczIpIC0gdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXM7XG4gICAgICAgIHZhciByID0gVmVjMi5zdWIoaW5wdXQyLnAyLCBpbnB1dDIucDEpO1xuICAgICAgICB2YXIgYzIgPSBWZWMyLmRvdChzMiwgcik7XG4gICAgICAgIHZhciByciA9IFZlYzIuZG90KHIsIHIpO1xuICAgICAgICB2YXIgc2lnbWEgPSBjMiAqIGMyIC0gcnIgKiBiMjtcbiAgICAgICAgaWYgKHNpZ21hIDwgMCB8fCByciA8IEVQU0lMT04pIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGEyID0gLShjMiArIG1hdGhfc3FydChzaWdtYSkpO1xuICAgICAgICBpZiAoMCA8PSBhMiAmJiBhMiA8PSBpbnB1dDIubWF4RnJhY3Rpb24gKiBycikge1xuICAgICAgICAgIGEyIC89IHJyO1xuICAgICAgICAgIG91dHB1dDIuZnJhY3Rpb24gPSBhMjtcbiAgICAgICAgICBvdXRwdXQyLm5vcm1hbCA9IFZlYzIuYWRkKHMyLCBWZWMyLm11bE51bVZlYzIoYTIsIHIpKTtcbiAgICAgICAgICBvdXRwdXQyLm5vcm1hbC5ub3JtYWxpemUoKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlQUFCQiA9IGZ1bmN0aW9uKGFhYmIsIHhmMiwgY2hpbGRJbmRleCkge1xuICAgICAgICB2YXIgcCA9IHRyYW5zZm9ybVZlYzIodGVtcCwgeGYyLCB0aGlzLm1fcCk7XG4gICAgICAgIHNldFZlYzIoYWFiYi5sb3dlckJvdW5kLCBwLnggLSB0aGlzLm1fcmFkaXVzLCBwLnkgLSB0aGlzLm1fcmFkaXVzKTtcbiAgICAgICAgc2V0VmVjMihhYWJiLnVwcGVyQm91bmQsIHAueCArIHRoaXMubV9yYWRpdXMsIHAueSArIHRoaXMubV9yYWRpdXMpO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZU1hc3MgPSBmdW5jdGlvbihtYXNzRGF0YSwgZGVuc2l0eSkge1xuICAgICAgICBtYXNzRGF0YS5tYXNzID0gZGVuc2l0eSAqIG1hdGhfUEkkNCAqIHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzO1xuICAgICAgICBjb3B5VmVjMihtYXNzRGF0YS5jZW50ZXIsIHRoaXMubV9wKTtcbiAgICAgICAgbWFzc0RhdGEuSSA9IG1hc3NEYXRhLm1hc3MgKiAoMC41ICogdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXMgKyBsZW5ndGhTcXJWZWMyKHRoaXMubV9wKSk7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlRGlzdGFuY2VQcm94eSA9IGZ1bmN0aW9uKHByb3h5KSB7XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXNbMF0gPSB0aGlzLm1fcDtcbiAgICAgICAgcHJveHkubV92ZXJ0aWNlcy5sZW5ndGggPSAxO1xuICAgICAgICBwcm94eS5tX2NvdW50ID0gMTtcbiAgICAgICAgcHJveHkubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5UWVBFID0gXCJjaXJjbGVcIjtcbiAgICAgIHJldHVybiBDaXJjbGVTaGFwZTI7XG4gICAgfShTaGFwZSlcbiAgKTtcbiAgdmFyIG1hdGhfYWJzJDUgPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfUEkkMyA9IE1hdGguUEk7XG4gIHZhciBERUZBVUxUUyRhID0ge1xuICAgIGZyZXF1ZW5jeUh6OiAwLFxuICAgIGRhbXBpbmdSYXRpbzogMFxuICB9O1xuICB2YXIgRGlzdGFuY2VKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoRGlzdGFuY2VKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBEaXN0YW5jZUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yQSwgYW5jaG9yQikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIERpc3RhbmNlSm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRGlzdGFuY2VKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvckEsIGFuY2hvckIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChib2R5QiAmJiBhbmNob3JBICYmIFwibV90eXBlXCIgaW4gYW5jaG9yQSAmJiBcInhcIiBpbiBib2R5QiAmJiBcInlcIiBpbiBib2R5Qikge1xuICAgICAgICAgIHZhciB0ZW1wMyA9IGJvZHlCO1xuICAgICAgICAgIGJvZHlCID0gYW5jaG9yQTtcbiAgICAgICAgICBhbmNob3JBID0gdGVtcDM7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJGEpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gRGlzdGFuY2VKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLmNsb25lKGFuY2hvckEgPyBib2R5QS5nZXRMb2NhbFBvaW50KGFuY2hvckEpIDogZGVmLmxvY2FsQW5jaG9yQSB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVmVjMi5jbG9uZShhbmNob3JCID8gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3JCKSA6IGRlZi5sb2NhbEFuY2hvckIgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xlbmd0aCA9IE51bWJlci5pc0Zpbml0ZShkZWYubGVuZ3RoKSA/IGRlZi5sZW5ndGggOiBWZWMyLmRpc3RhbmNlKGJvZHlBLmdldFdvcmxkUG9pbnQoX3RoaXMubV9sb2NhbEFuY2hvckEpLCBib2R5Qi5nZXRXb3JsZFBvaW50KF90aGlzLm1fbG9jYWxBbmNob3JCKSk7XG4gICAgICAgIF90aGlzLm1fZnJlcXVlbmN5SHogPSBkZWYuZnJlcXVlbmN5SHo7XG4gICAgICAgIF90aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgX3RoaXMubV9nYW1tYSA9IDA7XG4gICAgICAgIF90aGlzLm1fYmlhcyA9IDA7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGZyZXF1ZW5jeUh6OiB0aGlzLm1fZnJlcXVlbmN5SHosXG4gICAgICAgICAgZGFtcGluZ1JhdGlvOiB0aGlzLm1fZGFtcGluZ1JhdGlvLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckIsXG4gICAgICAgICAgbGVuZ3RoOiB0aGlzLm1fbGVuZ3RoLFxuICAgICAgICAgIGltcHVsc2U6IHRoaXMubV9pbXB1bHNlLFxuICAgICAgICAgIGdhbW1hOiB0aGlzLm1fZ2FtbWEsXG4gICAgICAgICAgYmlhczogdGhpcy5tX2JpYXNcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IERpc3RhbmNlSm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoZGVmLmFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIodGhpcy5tX2JvZHlBLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckEpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMih0aGlzLm1fYm9keUIuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQikpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX2xlbmd0aCA9ICtkZWYubGVuZ3RoO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sZW5ndGggPCAwKSA7XG4gICAgICAgIGVsc2UgaWYgKGRlZi5hbmNob3JBIHx8IGRlZi5hbmNob3JBIHx8IGRlZi5hbmNob3JBIHx8IGRlZi5hbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xlbmd0aCA9IFZlYzIuZGlzdGFuY2UodGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSksIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5mcmVxdWVuY3lIeikpIHtcbiAgICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBkZWYuZnJlcXVlbmN5SHo7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZGFtcGluZ1JhdGlvKSkge1xuICAgICAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JCO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5zZXRMZW5ndGggPSBmdW5jdGlvbihsZW5ndGgpIHtcbiAgICAgICAgdGhpcy5tX2xlbmd0aCA9IGxlbmd0aDtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0TGVuZ3RoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5zZXRGcmVxdWVuY3kgPSBmdW5jdGlvbihoeikge1xuICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBoejtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0RnJlcXVlbmN5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLnNldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uKHJhdGlvKSB7XG4gICAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSByYXRpbztcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZGFtcGluZ1JhdGlvO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubXVsTnVtVmVjMih0aGlzLm1faW1wdWxzZSwgdGhpcy5tX3UpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB0aGlzLm1fckEgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB0aGlzLm1fckIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB0aGlzLm1fdSA9IFZlYzIuc3ViKFZlYzIuYWRkKGNCMiwgdGhpcy5tX3JCKSwgVmVjMi5hZGQoY0EyLCB0aGlzLm1fckEpKTtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHRoaXMubV91Lmxlbmd0aCgpO1xuICAgICAgICBpZiAobGVuZ3RoID4gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKSB7XG4gICAgICAgICAgdGhpcy5tX3UubXVsKDEgLyBsZW5ndGgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV91LnNldE51bSgwLCAwKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY3JBdSA9IFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIHRoaXMubV91KTtcbiAgICAgICAgdmFyIGNyQnUgPSBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCB0aGlzLm1fdSk7XG4gICAgICAgIHZhciBpbnZNYXNzID0gdGhpcy5tX2ludk1hc3NBICsgdGhpcy5tX2ludklBICogY3JBdSAqIGNyQXUgKyB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUIgKiBjckJ1ICogY3JCdTtcbiAgICAgICAgdGhpcy5tX21hc3MgPSBpbnZNYXNzICE9IDAgPyAxIC8gaW52TWFzcyA6IDA7XG4gICAgICAgIGlmICh0aGlzLm1fZnJlcXVlbmN5SHogPiAwKSB7XG4gICAgICAgICAgdmFyIEMgPSBsZW5ndGggLSB0aGlzLm1fbGVuZ3RoO1xuICAgICAgICAgIHZhciBvbWVnYSA9IDIgKiBtYXRoX1BJJDMgKiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICAgICAgdmFyIGQyID0gMiAqIHRoaXMubV9tYXNzICogdGhpcy5tX2RhbXBpbmdSYXRpbyAqIG9tZWdhO1xuICAgICAgICAgIHZhciBrID0gdGhpcy5tX21hc3MgKiBvbWVnYSAqIG9tZWdhO1xuICAgICAgICAgIHZhciBoID0gc3RlcC5kdDtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSBoICogKGQyICsgaCAqIGspO1xuICAgICAgICAgIHRoaXMubV9nYW1tYSA9IHRoaXMubV9nYW1tYSAhPSAwID8gMSAvIHRoaXMubV9nYW1tYSA6IDA7XG4gICAgICAgICAgdGhpcy5tX2JpYXMgPSBDICogaCAqIGsgKiB0aGlzLm1fZ2FtbWE7XG4gICAgICAgICAgaW52TWFzcyArPSB0aGlzLm1fZ2FtbWE7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSBpbnZNYXNzICE9IDAgPyAxIC8gaW52TWFzcyA6IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gMDtcbiAgICAgICAgICB0aGlzLm1fYmlhcyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMih0aGlzLm1faW1wdWxzZSwgdGhpcy5tX3UpO1xuICAgICAgICAgIHZBMi5zdWJNdWwodGhpcy5tX2ludk1hc3NBLCBQMyk7XG4gICAgICAgICAgd0EgLT0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpO1xuICAgICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQMyk7XG4gICAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52LnNldFZlYzIodkEyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZwQSA9IFZlYzIuYWRkKHZBMiwgVmVjMi5jcm9zc051bVZlYzIod0EsIHRoaXMubV9yQSkpO1xuICAgICAgICB2YXIgdnBCID0gVmVjMi5hZGQodkIyLCBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKSk7XG4gICAgICAgIHZhciBDZG90ID0gVmVjMi5kb3QodGhpcy5tX3UsIHZwQikgLSBWZWMyLmRvdCh0aGlzLm1fdSwgdnBBKTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21hc3MgKiAoQ2RvdCArIHRoaXMubV9iaWFzICsgdGhpcy5tX2dhbW1hICogdGhpcy5tX2ltcHVsc2UpO1xuICAgICAgICB0aGlzLm1faW1wdWxzZSArPSBpbXB1bHNlO1xuICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoaW1wdWxzZSwgdGhpcy5tX3UpO1xuICAgICAgICB2QTIuc3ViTXVsKHRoaXMubV9pbnZNYXNzQSwgUDMpO1xuICAgICAgICB3QSAtPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMyk7XG4gICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQMyk7XG4gICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICBpZiAodGhpcy5tX2ZyZXF1ZW5jeUh6ID4gMCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFN1YihxQSwgdGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSk7XG4gICAgICAgIHZhciByQjIgPSBSb3QubXVsU3ViKHFCLCB0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKTtcbiAgICAgICAgdmFyIHUgPSBWZWMyLnN1YihWZWMyLmFkZChjQjIsIHJCMiksIFZlYzIuYWRkKGNBMiwgckEyKSk7XG4gICAgICAgIHZhciBsZW5ndGggPSB1Lm5vcm1hbGl6ZSgpO1xuICAgICAgICB2YXIgQyA9IGNsYW1wKGxlbmd0aCAtIHRoaXMubV9sZW5ndGgsIC1TZXR0aW5nc0ludGVybmFsLm1heExpbmVhckNvcnJlY3Rpb24sIFNldHRpbmdzSW50ZXJuYWwubWF4TGluZWFyQ29ycmVjdGlvbik7XG4gICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tYXNzICogQztcbiAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIHUpO1xuICAgICAgICBjQTIuc3ViTXVsKHRoaXMubV9pbnZNYXNzQSwgUDMpO1xuICAgICAgICBhQSAtPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCBQMyk7XG4gICAgICAgIGNCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQMyk7XG4gICAgICAgIGFCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIFAzKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmEgPSBhQTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmEgPSBhQjtcbiAgICAgICAgcmV0dXJuIG1hdGhfYWJzJDUoQykgPCBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIuVFlQRSA9IFwiZGlzdGFuY2Utam9pbnRcIjtcbiAgICAgIHJldHVybiBEaXN0YW5jZUpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgREVGQVVMVFMkOSA9IHtcbiAgICBtYXhGb3JjZTogMCxcbiAgICBtYXhUb3JxdWU6IDBcbiAgfTtcbiAgdmFyIEZyaWN0aW9uSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKEZyaWN0aW9uSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gRnJpY3Rpb25Kb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIEZyaWN0aW9uSm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRnJpY3Rpb25Kb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvcik7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDkpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gRnJpY3Rpb25Kb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fbGluZWFySW1wdWxzZSA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX2FuZ3VsYXJJbXB1bHNlID0gMDtcbiAgICAgICAgX3RoaXMubV9tYXhGb3JjZSA9IGRlZi5tYXhGb3JjZTtcbiAgICAgICAgX3RoaXMubV9tYXhUb3JxdWUgPSBkZWYubWF4VG9ycXVlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBtYXhGb3JjZTogdGhpcy5tX21heEZvcmNlLFxuICAgICAgICAgIG1heFRvcnF1ZTogdGhpcy5tX21heFRvcnF1ZSxcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBGcmljdGlvbkpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKGRlZi5hbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKHRoaXMubV9ib2R5QS5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JBKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMihkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIodGhpcy5tX2JvZHlCLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckIpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1heEZvcmNlKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGRlZi5tYXhGb3JjZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhUb3JxdWUpKSB7XG4gICAgICAgICAgdGhpcy5tX21heFRvcnF1ZSA9IGRlZi5tYXhUb3JxdWU7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLnNldE1heEZvcmNlID0gZnVuY3Rpb24oZm9yY2UpIHtcbiAgICAgICAgdGhpcy5tX21heEZvcmNlID0gZm9yY2U7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmdldE1heEZvcmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4Rm9yY2U7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLnNldE1heFRvcnF1ZSA9IGZ1bmN0aW9uKHRvcnF1ZSkge1xuICAgICAgICB0aGlzLm1fbWF4VG9ycXVlID0gdG9ycXVlO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhUb3JxdWUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhUb3JxdWU7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5tdWxOdW1WZWMyKGludl9kdCwgdGhpcy5tX2xpbmVhckltcHVsc2UpO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2FuZ3VsYXJJbXB1bHNlO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB0aGlzLm1fckEgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB0aGlzLm1fckIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciBLID0gbmV3IE1hdDIyKCk7XG4gICAgICAgIEsuZXgueCA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9yQS55ICogdGhpcy5tX3JBLnkgKyBpQiAqIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnk7XG4gICAgICAgIEsuZXgueSA9IC1pQSAqIHRoaXMubV9yQS54ICogdGhpcy5tX3JBLnkgLSBpQiAqIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLnk7XG4gICAgICAgIEsuZXkueCA9IEsuZXgueTtcbiAgICAgICAgSy5leS55ID0gbUEgKyBtQiArIGlBICogdGhpcy5tX3JBLnggKiB0aGlzLm1fckEueCArIGlCICogdGhpcy5tX3JCLnggKiB0aGlzLm1fckIueDtcbiAgICAgICAgdGhpcy5tX2xpbmVhck1hc3MgPSBLLmdldEludmVyc2UoKTtcbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJNYXNzID0gaUEgKyBpQjtcbiAgICAgICAgaWYgKHRoaXMubV9hbmd1bGFyTWFzcyA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhck1hc3MgPSAxIC8gdGhpcy5tX2FuZ3VsYXJNYXNzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLm11bChzdGVwLmR0UmF0aW8pO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFySW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5uZW8odGhpcy5tX2xpbmVhckltcHVsc2UueCwgdGhpcy5tX2xpbmVhckltcHVsc2UueSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKSArIHRoaXMubV9hbmd1bGFySW1wdWxzZSk7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKSArIHRoaXMubV9hbmd1bGFySW1wdWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2Uuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFySW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciBoID0gc3RlcC5kdDtcbiAgICAgICAge1xuICAgICAgICAgIHZhciBDZG90ID0gd0IgLSB3QTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fYW5ndWxhck1hc3MgKiBDZG90O1xuICAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX2FuZ3VsYXJJbXB1bHNlO1xuICAgICAgICAgIHZhciBtYXhJbXB1bHNlID0gaCAqIHRoaXMubV9tYXhUb3JxdWU7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlID0gY2xhbXAodGhpcy5tX2FuZ3VsYXJJbXB1bHNlICsgaW1wdWxzZSwgLW1heEltcHVsc2UsIG1heEltcHVsc2UpO1xuICAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fYW5ndWxhckltcHVsc2UgLSBvbGRJbXB1bHNlO1xuICAgICAgICAgIHdBIC09IGlBICogaW1wdWxzZTtcbiAgICAgICAgICB3QiArPSBpQiAqIGltcHVsc2U7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIHZhciBDZG90ID0gVmVjMi5zdWIoVmVjMi5hZGQodkIyLCBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKSksIFZlYzIuYWRkKHZBMiwgVmVjMi5jcm9zc051bVZlYzIod0EsIHRoaXMubV9yQSkpKTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IFZlYzIubmVnKE1hdDIyLm11bFZlYzIodGhpcy5tX2xpbmVhck1hc3MsIENkb3QpKTtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9saW5lYXJJbXB1bHNlO1xuICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLmFkZChpbXB1bHNlKTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IGggKiB0aGlzLm1fbWF4Rm9yY2U7XG4gICAgICAgICAgaWYgKHRoaXMubV9saW5lYXJJbXB1bHNlLmxlbmd0aFNxdWFyZWQoKSA+IG1heEltcHVsc2UgKiBtYXhJbXB1bHNlKSB7XG4gICAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5ub3JtYWxpemUoKTtcbiAgICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLm11bChtYXhJbXB1bHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaW1wdWxzZSA9IFZlYzIuc3ViKHRoaXMubV9saW5lYXJJbXB1bHNlLCBvbGRJbXB1bHNlKTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBpbXB1bHNlKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIGltcHVsc2UpO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIGltcHVsc2UpO1xuICAgICAgICAgIHdCICs9IGlCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgaW1wdWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIuVFlQRSA9IFwiZnJpY3Rpb24tam9pbnRcIjtcbiAgICAgIHJldHVybiBGcmljdGlvbkpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgTWF0MzMgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gTWF0MzMyKGEyLCBiMiwgYzIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhMiA9PT0gXCJvYmplY3RcIiAmJiBhMiAhPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuZXggPSBWZWMzLmNsb25lKGEyKTtcbiAgICAgICAgICB0aGlzLmV5ID0gVmVjMy5jbG9uZShiMik7XG4gICAgICAgICAgdGhpcy5leiA9IFZlYzMuY2xvbmUoYzIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZXggPSBWZWMzLnplcm8oKTtcbiAgICAgICAgICB0aGlzLmV5ID0gVmVjMy56ZXJvKCk7XG4gICAgICAgICAgdGhpcy5leiA9IFZlYzMuemVybygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBNYXQzMzIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbiAgICAgIH07XG4gICAgICBNYXQzMzIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFZlYzMuaXNWYWxpZChvYmouZXgpICYmIFZlYzMuaXNWYWxpZChvYmouZXkpICYmIFZlYzMuaXNWYWxpZChvYmouZXopO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5hc3NlcnQgPSBmdW5jdGlvbihvKSB7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLnByb3RvdHlwZS5zZXRaZXJvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuZXguc2V0WmVybygpO1xuICAgICAgICB0aGlzLmV5LnNldFplcm8oKTtcbiAgICAgICAgdGhpcy5lei5zZXRaZXJvKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5wcm90b3R5cGUuc29sdmUzMyA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHZhciBjcm9zc194ID0gdGhpcy5leS55ICogdGhpcy5lei56IC0gdGhpcy5leS56ICogdGhpcy5lei55O1xuICAgICAgICB2YXIgY3Jvc3NfeSA9IHRoaXMuZXkueiAqIHRoaXMuZXoueCAtIHRoaXMuZXkueCAqIHRoaXMuZXouejtcbiAgICAgICAgdmFyIGNyb3NzX3ogPSB0aGlzLmV5LnggKiB0aGlzLmV6LnkgLSB0aGlzLmV5LnkgKiB0aGlzLmV6Lng7XG4gICAgICAgIHZhciBkZXQgPSB0aGlzLmV4LnggKiBjcm9zc194ICsgdGhpcy5leC55ICogY3Jvc3NfeSArIHRoaXMuZXgueiAqIGNyb3NzX3o7XG4gICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICBkZXQgPSAxIC8gZGV0O1xuICAgICAgICB9XG4gICAgICAgIHZhciByID0gbmV3IFZlYzMoKTtcbiAgICAgICAgY3Jvc3NfeCA9IHRoaXMuZXkueSAqIHRoaXMuZXoueiAtIHRoaXMuZXkueiAqIHRoaXMuZXoueTtcbiAgICAgICAgY3Jvc3NfeSA9IHRoaXMuZXkueiAqIHRoaXMuZXoueCAtIHRoaXMuZXkueCAqIHRoaXMuZXouejtcbiAgICAgICAgY3Jvc3NfeiA9IHRoaXMuZXkueCAqIHRoaXMuZXoueSAtIHRoaXMuZXkueSAqIHRoaXMuZXoueDtcbiAgICAgICAgci54ID0gZGV0ICogKHYzLnggKiBjcm9zc194ICsgdjMueSAqIGNyb3NzX3kgKyB2My56ICogY3Jvc3Nfeik7XG4gICAgICAgIGNyb3NzX3ggPSB2My55ICogdGhpcy5lei56IC0gdjMueiAqIHRoaXMuZXoueTtcbiAgICAgICAgY3Jvc3NfeSA9IHYzLnogKiB0aGlzLmV6LnggLSB2My54ICogdGhpcy5lei56O1xuICAgICAgICBjcm9zc196ID0gdjMueCAqIHRoaXMuZXoueSAtIHYzLnkgKiB0aGlzLmV6Lng7XG4gICAgICAgIHIueSA9IGRldCAqICh0aGlzLmV4LnggKiBjcm9zc194ICsgdGhpcy5leC55ICogY3Jvc3NfeSArIHRoaXMuZXgueiAqIGNyb3NzX3opO1xuICAgICAgICBjcm9zc194ID0gdGhpcy5leS55ICogdjMueiAtIHRoaXMuZXkueiAqIHYzLnk7XG4gICAgICAgIGNyb3NzX3kgPSB0aGlzLmV5LnogKiB2My54IC0gdGhpcy5leS54ICogdjMuejtcbiAgICAgICAgY3Jvc3NfeiA9IHRoaXMuZXkueCAqIHYzLnkgLSB0aGlzLmV5LnkgKiB2My54O1xuICAgICAgICByLnogPSBkZXQgKiAodGhpcy5leC54ICogY3Jvc3NfeCArIHRoaXMuZXgueSAqIGNyb3NzX3kgKyB0aGlzLmV4LnogKiBjcm9zc196KTtcbiAgICAgICAgcmV0dXJuIHI7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLnByb3RvdHlwZS5zb2x2ZTIyID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgdmFyIGExMSA9IHRoaXMuZXgueDtcbiAgICAgICAgdmFyIGExMiA9IHRoaXMuZXkueDtcbiAgICAgICAgdmFyIGEyMSA9IHRoaXMuZXgueTtcbiAgICAgICAgdmFyIGEyMiA9IHRoaXMuZXkueTtcbiAgICAgICAgdmFyIGRldCA9IGExMSAqIGEyMiAtIGExMiAqIGEyMTtcbiAgICAgICAgaWYgKGRldCAhPT0gMCkge1xuICAgICAgICAgIGRldCA9IDEgLyBkZXQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHIgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgci54ID0gZGV0ICogKGEyMiAqIHYzLnggLSBhMTIgKiB2My55KTtcbiAgICAgICAgci55ID0gZGV0ICogKGExMSAqIHYzLnkgLSBhMjEgKiB2My54KTtcbiAgICAgICAgcmV0dXJuIHI7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLnByb3RvdHlwZS5nZXRJbnZlcnNlMjIgPSBmdW5jdGlvbihNKSB7XG4gICAgICAgIHZhciBhMiA9IHRoaXMuZXgueDtcbiAgICAgICAgdmFyIGIyID0gdGhpcy5leS54O1xuICAgICAgICB2YXIgYzIgPSB0aGlzLmV4Lnk7XG4gICAgICAgIHZhciBkMiA9IHRoaXMuZXkueTtcbiAgICAgICAgdmFyIGRldCA9IGEyICogZDIgLSBiMiAqIGMyO1xuICAgICAgICBpZiAoZGV0ICE9PSAwKSB7XG4gICAgICAgICAgZGV0ID0gMSAvIGRldDtcbiAgICAgICAgfVxuICAgICAgICBNLmV4LnggPSBkZXQgKiBkMjtcbiAgICAgICAgTS5leS54ID0gLWRldCAqIGIyO1xuICAgICAgICBNLmV4LnogPSAwO1xuICAgICAgICBNLmV4LnkgPSAtZGV0ICogYzI7XG4gICAgICAgIE0uZXkueSA9IGRldCAqIGEyO1xuICAgICAgICBNLmV5LnogPSAwO1xuICAgICAgICBNLmV6LnggPSAwO1xuICAgICAgICBNLmV6LnkgPSAwO1xuICAgICAgICBNLmV6LnogPSAwO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5wcm90b3R5cGUuZ2V0U3ltSW52ZXJzZTMzID0gZnVuY3Rpb24oTSkge1xuICAgICAgICB2YXIgZGV0ID0gVmVjMy5kb3QodGhpcy5leCwgVmVjMy5jcm9zcyh0aGlzLmV5LCB0aGlzLmV6KSk7XG4gICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICBkZXQgPSAxIC8gZGV0O1xuICAgICAgICB9XG4gICAgICAgIHZhciBhMTEgPSB0aGlzLmV4Lng7XG4gICAgICAgIHZhciBhMTIgPSB0aGlzLmV5Lng7XG4gICAgICAgIHZhciBhMTMgPSB0aGlzLmV6Lng7XG4gICAgICAgIHZhciBhMjIgPSB0aGlzLmV5Lnk7XG4gICAgICAgIHZhciBhMjMgPSB0aGlzLmV6Lnk7XG4gICAgICAgIHZhciBhMzMgPSB0aGlzLmV6Lno7XG4gICAgICAgIE0uZXgueCA9IGRldCAqIChhMjIgKiBhMzMgLSBhMjMgKiBhMjMpO1xuICAgICAgICBNLmV4LnkgPSBkZXQgKiAoYTEzICogYTIzIC0gYTEyICogYTMzKTtcbiAgICAgICAgTS5leC56ID0gZGV0ICogKGExMiAqIGEyMyAtIGExMyAqIGEyMik7XG4gICAgICAgIE0uZXkueCA9IE0uZXgueTtcbiAgICAgICAgTS5leS55ID0gZGV0ICogKGExMSAqIGEzMyAtIGExMyAqIGExMyk7XG4gICAgICAgIE0uZXkueiA9IGRldCAqIChhMTMgKiBhMTIgLSBhMTEgKiBhMjMpO1xuICAgICAgICBNLmV6LnggPSBNLmV4Lno7XG4gICAgICAgIE0uZXoueSA9IE0uZXkuejtcbiAgICAgICAgTS5lei56ID0gZGV0ICogKGExMSAqIGEyMiAtIGExMiAqIGExMik7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLm11bCA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICBpZiAoYjIgJiYgXCJ6XCIgaW4gYjIgJiYgXCJ5XCIgaW4gYjIgJiYgXCJ4XCIgaW4gYjIpIHtcbiAgICAgICAgICB2YXIgeDIgPSBhMi5leC54ICogYjIueCArIGEyLmV5LnggKiBiMi55ICsgYTIuZXoueCAqIGIyLno7XG4gICAgICAgICAgdmFyIHkgPSBhMi5leC55ICogYjIueCArIGEyLmV5LnkgKiBiMi55ICsgYTIuZXoueSAqIGIyLno7XG4gICAgICAgICAgdmFyIHogPSBhMi5leC56ICogYjIueCArIGEyLmV5LnogKiBiMi55ICsgYTIuZXoueiAqIGIyLno7XG4gICAgICAgICAgcmV0dXJuIG5ldyBWZWMzKHgyLCB5LCB6KTtcbiAgICAgICAgfSBlbHNlIGlmIChiMiAmJiBcInlcIiBpbiBiMiAmJiBcInhcIiBpbiBiMikge1xuICAgICAgICAgIHZhciB4MiA9IGEyLmV4LnggKiBiMi54ICsgYTIuZXkueCAqIGIyLnk7XG4gICAgICAgICAgdmFyIHkgPSBhMi5leC55ICogYjIueCArIGEyLmV5LnkgKiBiMi55O1xuICAgICAgICAgIHJldHVybiBWZWMyLm5lbyh4MiwgeSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNYXQzMzIubXVsVmVjMyA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgeDIgPSBhMi5leC54ICogYjIueCArIGEyLmV5LnggKiBiMi55ICsgYTIuZXoueCAqIGIyLno7XG4gICAgICAgIHZhciB5ID0gYTIuZXgueSAqIGIyLnggKyBhMi5leS55ICogYjIueSArIGEyLmV6LnkgKiBiMi56O1xuICAgICAgICB2YXIgeiA9IGEyLmV4LnogKiBiMi54ICsgYTIuZXkueiAqIGIyLnkgKyBhMi5lei56ICogYjIuejtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzKHgyLCB5LCB6KTtcbiAgICAgIH07XG4gICAgICBNYXQzMzIubXVsVmVjMiA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgeDIgPSBhMi5leC54ICogYjIueCArIGEyLmV5LnggKiBiMi55O1xuICAgICAgICB2YXIgeSA9IGEyLmV4LnkgKiBiMi54ICsgYTIuZXkueSAqIGIyLnk7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh4MiwgeSk7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLmFkZCA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICByZXR1cm4gbmV3IE1hdDMzMihWZWMzLmFkZChhMi5leCwgYjIuZXgpLCBWZWMzLmFkZChhMi5leSwgYjIuZXkpLCBWZWMzLmFkZChhMi5leiwgYjIuZXopKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gTWF0MzMyO1xuICAgIH0oKVxuICApO1xuICB2YXIgbWF0aF9hYnMkNCA9IE1hdGguYWJzO1xuICB2YXIgTGltaXRTdGF0ZSQyO1xuICAoZnVuY3Rpb24oTGltaXRTdGF0ZTIpIHtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImluYWN0aXZlTGltaXRcIl0gPSAwXSA9IFwiaW5hY3RpdmVMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiYXRMb3dlckxpbWl0XCJdID0gMV0gPSBcImF0TG93ZXJMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiYXRVcHBlckxpbWl0XCJdID0gMl0gPSBcImF0VXBwZXJMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiZXF1YWxMaW1pdHNcIl0gPSAzXSA9IFwiZXF1YWxMaW1pdHNcIjtcbiAgfSkoTGltaXRTdGF0ZSQyIHx8IChMaW1pdFN0YXRlJDIgPSB7fSkpO1xuICB2YXIgREVGQVVMVFMkOCA9IHtcbiAgICBsb3dlckFuZ2xlOiAwLFxuICAgIHVwcGVyQW5nbGU6IDAsXG4gICAgbWF4TW90b3JUb3JxdWU6IDAsXG4gICAgbW90b3JTcGVlZDogMCxcbiAgICBlbmFibGVMaW1pdDogZmFsc2UsXG4gICAgZW5hYmxlTW90b3I6IGZhbHNlXG4gIH07XG4gIHZhciBSZXZvbHV0ZUpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhSZXZvbHV0ZUpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIFJldm9sdXRlSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIF9hMiwgX2IsIF9jLCBfZCwgX2UsIF9mO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIFJldm9sdXRlSm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgUmV2b2x1dGVKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvcik7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gZGVmICE9PSBudWxsICYmIGRlZiAhPT0gdm9pZCAwID8gZGVmIDoge307XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX21hc3MgPSBuZXcgTWF0MzMoKTtcbiAgICAgICAgX3RoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQyLmluYWN0aXZlTGltaXQ7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IFJldm9sdXRlSm9pbnQyLlRZUEU7XG4gICAgICAgIGlmIChWZWMyLmlzVmFsaWQoYW5jaG9yKSkge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3IpO1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYubG9jYWxBbmNob3JBKSkge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuemVybygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChWZWMyLmlzVmFsaWQoYW5jaG9yKSkge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3IpO1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYubG9jYWxBbmNob3JCKSkge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVmVjMi5jbG9uZShkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuemVybygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLnJlZmVyZW5jZUFuZ2xlKSkge1xuICAgICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBkZWYucmVmZXJlbmNlQW5nbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMubV9yZWZlcmVuY2VBbmdsZSA9IGJvZHlCLmdldEFuZ2xlKCkgLSBib2R5QS5nZXRBbmdsZSgpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IG5ldyBWZWMzKCk7XG4gICAgICAgIF90aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgX3RoaXMubV9sb3dlckFuZ2xlID0gKF9hMiA9IGRlZi5sb3dlckFuZ2xlKSAhPT0gbnVsbCAmJiBfYTIgIT09IHZvaWQgMCA/IF9hMiA6IERFRkFVTFRTJDgubG93ZXJBbmdsZTtcbiAgICAgICAgX3RoaXMubV91cHBlckFuZ2xlID0gKF9iID0gZGVmLnVwcGVyQW5nbGUpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IERFRkFVTFRTJDgudXBwZXJBbmdsZTtcbiAgICAgICAgX3RoaXMubV9tYXhNb3RvclRvcnF1ZSA9IChfYyA9IGRlZi5tYXhNb3RvclRvcnF1ZSkgIT09IG51bGwgJiYgX2MgIT09IHZvaWQgMCA/IF9jIDogREVGQVVMVFMkOC5tYXhNb3RvclRvcnF1ZTtcbiAgICAgICAgX3RoaXMubV9tb3RvclNwZWVkID0gKF9kID0gZGVmLm1vdG9yU3BlZWQpICE9PSBudWxsICYmIF9kICE9PSB2b2lkIDAgPyBfZCA6IERFRkFVTFRTJDgubW90b3JTcGVlZDtcbiAgICAgICAgX3RoaXMubV9lbmFibGVMaW1pdCA9IChfZSA9IGRlZi5lbmFibGVMaW1pdCkgIT09IG51bGwgJiYgX2UgIT09IHZvaWQgMCA/IF9lIDogREVGQVVMVFMkOC5lbmFibGVMaW1pdDtcbiAgICAgICAgX3RoaXMubV9lbmFibGVNb3RvciA9IChfZiA9IGRlZi5lbmFibGVNb3RvcikgIT09IG51bGwgJiYgX2YgIT09IHZvaWQgMCA/IF9mIDogREVGQVVMVFMkOC5lbmFibGVNb3RvcjtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgbG93ZXJBbmdsZTogdGhpcy5tX2xvd2VyQW5nbGUsXG4gICAgICAgICAgdXBwZXJBbmdsZTogdGhpcy5tX3VwcGVyQW5nbGUsXG4gICAgICAgICAgbWF4TW90b3JUb3JxdWU6IHRoaXMubV9tYXhNb3RvclRvcnF1ZSxcbiAgICAgICAgICBtb3RvclNwZWVkOiB0aGlzLm1fbW90b3JTcGVlZCxcbiAgICAgICAgICBlbmFibGVMaW1pdDogdGhpcy5tX2VuYWJsZUxpbWl0LFxuICAgICAgICAgIGVuYWJsZU1vdG9yOiB0aGlzLm1fZW5hYmxlTW90b3IsXG4gICAgICAgICAgbG9jYWxBbmNob3JBOiB0aGlzLm1fbG9jYWxBbmNob3JBLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQixcbiAgICAgICAgICByZWZlcmVuY2VBbmdsZTogdGhpcy5tX3JlZmVyZW5jZUFuZ2xlXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBSZXZvbHV0ZUpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKGRlZi5hbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKHRoaXMubV9ib2R5QS5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JBKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMihkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIodGhpcy5tX2JvZHlCLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckIpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLnJlZmVyZW5jZUFuZ2xlKSkge1xuICAgICAgICAgIHRoaXMubV9yZWZlcmVuY2VBbmdsZSA9IGRlZi5yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmVuYWJsZUxpbWl0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSBkZWYuZW5hYmxlTGltaXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubG93ZXJBbmdsZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbG93ZXJBbmdsZSA9IGRlZi5sb3dlckFuZ2xlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLnVwcGVyQW5nbGUpKSB7XG4gICAgICAgICAgdGhpcy5tX3VwcGVyQW5nbGUgPSBkZWYudXBwZXJBbmdsZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhNb3RvclRvcnF1ZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4TW90b3JUb3JxdWUgPSBkZWYubWF4TW90b3JUb3JxdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubW90b3JTcGVlZCkpIHtcbiAgICAgICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuZW5hYmxlTW90b3IgIT09IHZvaWQgMCkge1xuICAgICAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckE7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVmZXJlbmNlQW5nbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnRBbmdsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgICAgcmV0dXJuIGJCLm1fc3dlZXAuYSAtIGJBLm1fc3dlZXAuYSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnRTcGVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgICAgcmV0dXJuIGJCLm1fYW5ndWxhclZlbG9jaXR5IC0gYkEubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmlzTW90b3JFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTW90b3I7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmVuYWJsZU1vdG9yID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAoZmxhZyA9PSB0aGlzLm1fZW5hYmxlTW90b3IpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZmxhZztcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0TW90b3JUb3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLnNldE1vdG9yU3BlZWQgPSBmdW5jdGlvbihzcGVlZCkge1xuICAgICAgICBpZiAoc3BlZWQgPT0gdGhpcy5tX21vdG9yU3BlZWQpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBzcGVlZDtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21vdG9yU3BlZWQ7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLnNldE1heE1vdG9yVG9ycXVlID0gZnVuY3Rpb24odG9ycXVlKSB7XG4gICAgICAgIGlmICh0b3JxdWUgPT0gdGhpcy5tX21heE1vdG9yVG9ycXVlKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9tYXhNb3RvclRvcnF1ZSA9IHRvcnF1ZTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0TWF4TW90b3JUb3JxdWUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhNb3RvclRvcnF1ZTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuaXNMaW1pdEVuYWJsZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9lbmFibGVMaW1pdDtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZW5hYmxlTGltaXQgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnICE9IHRoaXMubV9lbmFibGVMaW1pdCkge1xuICAgICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gZmxhZztcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRMb3dlckxpbWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG93ZXJBbmdsZTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0VXBwZXJMaW1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3VwcGVyQW5nbGU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLnNldExpbWl0cyA9IGZ1bmN0aW9uKGxvd2VyLCB1cHBlcikge1xuICAgICAgICBpZiAobG93ZXIgIT0gdGhpcy5tX2xvd2VyQW5nbGUgfHwgdXBwZXIgIT0gdGhpcy5tX3VwcGVyQW5nbGUpIHtcbiAgICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgIHRoaXMubV9sb3dlckFuZ2xlID0gbG93ZXI7XG4gICAgICAgICAgdGhpcy5tX3VwcGVyQW5nbGUgPSB1cHBlcjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHRoaXMubV9pbXB1bHNlLngsIHRoaXMubV9pbXB1bHNlLnkpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UuejtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgZml4ZWRSb3RhdGlvbiA9IGlBICsgaUIgPT09IDA7XG4gICAgICAgIHRoaXMubV9tYXNzLmV4LnggPSBtQSArIG1CICsgdGhpcy5tX3JBLnkgKiB0aGlzLm1fckEueSAqIGlBICsgdGhpcy5tX3JCLnkgKiB0aGlzLm1fckIueSAqIGlCO1xuICAgICAgICB0aGlzLm1fbWFzcy5leS54ID0gLXRoaXMubV9yQS55ICogdGhpcy5tX3JBLnggKiBpQSAtIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnggKiBpQjtcbiAgICAgICAgdGhpcy5tX21hc3MuZXoueCA9IC10aGlzLm1fckEueSAqIGlBIC0gdGhpcy5tX3JCLnkgKiBpQjtcbiAgICAgICAgdGhpcy5tX21hc3MuZXgueSA9IHRoaXMubV9tYXNzLmV5Lng7XG4gICAgICAgIHRoaXMubV9tYXNzLmV5LnkgPSBtQSArIG1CICsgdGhpcy5tX3JBLnggKiB0aGlzLm1fckEueCAqIGlBICsgdGhpcy5tX3JCLnggKiB0aGlzLm1fckIueCAqIGlCO1xuICAgICAgICB0aGlzLm1fbWFzcy5lei55ID0gdGhpcy5tX3JBLnggKiBpQSArIHRoaXMubV9yQi54ICogaUI7XG4gICAgICAgIHRoaXMubV9tYXNzLmV4LnogPSB0aGlzLm1fbWFzcy5lei54O1xuICAgICAgICB0aGlzLm1fbWFzcy5leS56ID0gdGhpcy5tX21hc3MuZXoueTtcbiAgICAgICAgdGhpcy5tX21hc3MuZXoueiA9IGlBICsgaUI7XG4gICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSBpQSArIGlCO1xuICAgICAgICBpZiAodGhpcy5tX21vdG9yTWFzcyA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gMSAvIHRoaXMubV9tb3Rvck1hc3M7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVNb3RvciA9PSBmYWxzZSB8fCBmaXhlZFJvdGF0aW9uKSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCAmJiBmaXhlZFJvdGF0aW9uID09IGZhbHNlKSB7XG4gICAgICAgICAgdmFyIGpvaW50QW5nbGUgPSBhQiAtIGFBIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIGlmIChtYXRoX2FicyQ0KHRoaXMubV91cHBlckFuZ2xlIC0gdGhpcy5tX2xvd2VyQW5nbGUpIDwgMiAqIFNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsb3ApIHtcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQyLmVxdWFsTGltaXRzO1xuICAgICAgICAgIH0gZWxzZSBpZiAoam9pbnRBbmdsZSA8PSB0aGlzLm1fbG93ZXJBbmdsZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMi5hdExvd2VyTGltaXQpIHtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMi5hdExvd2VyTGltaXQ7XG4gICAgICAgICAgfSBlbHNlIGlmIChqb2ludEFuZ2xlID49IHRoaXMubV91cHBlckFuZ2xlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQyLmF0VXBwZXJMaW1pdCkge1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQyLmF0VXBwZXJMaW1pdDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDIuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMi5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLm11bChzdGVwLmR0UmF0aW8pO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVvKHRoaXMubV9pbXB1bHNlLngsIHRoaXMubV9pbXB1bHNlLnkpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMykgKyB0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKSArIHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciBmaXhlZFJvdGF0aW9uID0gaUEgKyBpQiA9PT0gMDtcbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVNb3RvciAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDIuZXF1YWxMaW1pdHMgJiYgZml4ZWRSb3RhdGlvbiA9PSBmYWxzZSkge1xuICAgICAgICAgIHZhciBDZG90ID0gd0IgLSB3QSAtIHRoaXMubV9tb3RvclNwZWVkO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tb3Rvck1hc3MgKiBDZG90O1xuICAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4TW90b3JUb3JxdWU7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IGNsYW1wKHRoaXMubV9tb3RvckltcHVsc2UgKyBpbXB1bHNlLCAtbWF4SW1wdWxzZSwgbWF4SW1wdWxzZSk7XG4gICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2UgLSBvbGRJbXB1bHNlO1xuICAgICAgICAgIHdBIC09IGlBICogaW1wdWxzZTtcbiAgICAgICAgICB3QiArPSBpQiAqIGltcHVsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDIuaW5hY3RpdmVMaW1pdCAmJiBmaXhlZFJvdGF0aW9uID09IGZhbHNlKSB7XG4gICAgICAgICAgdmFyIENkb3QxID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQ2RvdDEuYWRkQ29tYmluZSgxLCB2QjIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpKTtcbiAgICAgICAgICBDZG90MS5zdWJDb21iaW5lKDEsIHZBMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0EsIHRoaXMubV9yQSkpO1xuICAgICAgICAgIHZhciBDZG90MiA9IHdCIC0gd0E7XG4gICAgICAgICAgdmFyIENkb3QgPSBuZXcgVmVjMyhDZG90MS54LCBDZG90MS55LCBDZG90Mik7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSBWZWMzLm5lZyh0aGlzLm1fbWFzcy5zb2x2ZTMzKENkb3QpKTtcbiAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQyLmVxdWFsTGltaXRzKSB7XG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS5hZGQoaW1wdWxzZSk7XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBMaW1pdFN0YXRlJDIuYXRMb3dlckxpbWl0KSB7XG4gICAgICAgICAgICB2YXIgbmV3SW1wdWxzZSA9IHRoaXMubV9pbXB1bHNlLnogKyBpbXB1bHNlLno7XG4gICAgICAgICAgICBpZiAobmV3SW1wdWxzZSA8IDApIHtcbiAgICAgICAgICAgICAgdmFyIHJocyA9IFZlYzIuY29tYmluZSgtMSwgQ2RvdDEsIHRoaXMubV9pbXB1bHNlLnosIFZlYzIubmVvKHRoaXMubV9tYXNzLmV6LngsIHRoaXMubV9tYXNzLmV6LnkpKTtcbiAgICAgICAgICAgICAgdmFyIHJlZHVjZWQgPSB0aGlzLm1fbWFzcy5zb2x2ZTIyKHJocyk7XG4gICAgICAgICAgICAgIGltcHVsc2UueCA9IHJlZHVjZWQueDtcbiAgICAgICAgICAgICAgaW1wdWxzZS55ID0gcmVkdWNlZC55O1xuICAgICAgICAgICAgICBpbXB1bHNlLnogPSAtdGhpcy5tX2ltcHVsc2UuejtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSByZWR1Y2VkLng7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gcmVkdWNlZC55O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLmFkZChpbXB1bHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IExpbWl0U3RhdGUkMi5hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgICAgIHZhciBuZXdJbXB1bHNlID0gdGhpcy5tX2ltcHVsc2UueiArIGltcHVsc2UuejtcbiAgICAgICAgICAgIGlmIChuZXdJbXB1bHNlID4gMCkge1xuICAgICAgICAgICAgICB2YXIgcmhzID0gVmVjMi5jb21iaW5lKC0xLCBDZG90MSwgdGhpcy5tX2ltcHVsc2UueiwgVmVjMi5uZW8odGhpcy5tX21hc3MuZXoueCwgdGhpcy5tX21hc3MuZXoueSkpO1xuICAgICAgICAgICAgICB2YXIgcmVkdWNlZCA9IHRoaXMubV9tYXNzLnNvbHZlMjIocmhzKTtcbiAgICAgICAgICAgICAgaW1wdWxzZS54ID0gcmVkdWNlZC54O1xuICAgICAgICAgICAgICBpbXB1bHNlLnkgPSByZWR1Y2VkLnk7XG4gICAgICAgICAgICAgIGltcHVsc2UueiA9IC10aGlzLm1faW1wdWxzZS56O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IHJlZHVjZWQueDtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSArPSByZWR1Y2VkLnk7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UuYWRkKGltcHVsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm5lbyhpbXB1bHNlLngsIGltcHVsc2UueSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKSArIGltcHVsc2Uueik7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKSArIGltcHVsc2Uueik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIENkb3QgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBDZG90LmFkZENvbWJpbmUoMSwgdkIyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKSk7XG4gICAgICAgICAgQ2RvdC5zdWJDb21iaW5lKDEsIHZBMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0EsIHRoaXMubV9yQSkpO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gdGhpcy5tX21hc3Muc29sdmUyMihWZWMyLm5lZyhDZG90KSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSBpbXB1bHNlLng7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSArPSBpbXB1bHNlLnk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgaW1wdWxzZSk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBpbXB1bHNlKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBpbXB1bHNlKTtcbiAgICAgICAgICB3QiArPSBpQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIGltcHVsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgYW5ndWxhckVycm9yID0gMDtcbiAgICAgICAgdmFyIHBvc2l0aW9uRXJyb3IgPSAwO1xuICAgICAgICB2YXIgZml4ZWRSb3RhdGlvbiA9IHRoaXMubV9pbnZJQSArIHRoaXMubV9pbnZJQiA9PSAwO1xuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0ICYmIHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMi5pbmFjdGl2ZUxpbWl0ICYmIGZpeGVkUm90YXRpb24gPT0gZmFsc2UpIHtcbiAgICAgICAgICB2YXIgYW5nbGUgPSBhQiAtIGFBIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIHZhciBsaW1pdEltcHVsc2UgPSAwO1xuICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBMaW1pdFN0YXRlJDIuZXF1YWxMaW1pdHMpIHtcbiAgICAgICAgICAgIHZhciBDID0gY2xhbXAoYW5nbGUgLSB0aGlzLm1fbG93ZXJBbmdsZSwgLVNldHRpbmdzSW50ZXJuYWwubWF4QW5ndWxhckNvcnJlY3Rpb24sIFNldHRpbmdzSW50ZXJuYWwubWF4QW5ndWxhckNvcnJlY3Rpb24pO1xuICAgICAgICAgICAgbGltaXRJbXB1bHNlID0gLXRoaXMubV9tb3Rvck1hc3MgKiBDO1xuICAgICAgICAgICAgYW5ndWxhckVycm9yID0gbWF0aF9hYnMkNChDKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IExpbWl0U3RhdGUkMi5hdExvd2VyTGltaXQpIHtcbiAgICAgICAgICAgIHZhciBDID0gYW5nbGUgLSB0aGlzLm1fbG93ZXJBbmdsZTtcbiAgICAgICAgICAgIGFuZ3VsYXJFcnJvciA9IC1DO1xuICAgICAgICAgICAgQyA9IGNsYW1wKEMgKyBTZXR0aW5nc0ludGVybmFsLmFuZ3VsYXJTbG9wLCAtU2V0dGluZ3NJbnRlcm5hbC5tYXhBbmd1bGFyQ29ycmVjdGlvbiwgMCk7XG4gICAgICAgICAgICBsaW1pdEltcHVsc2UgPSAtdGhpcy5tX21vdG9yTWFzcyAqIEM7XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBMaW1pdFN0YXRlJDIuYXRVcHBlckxpbWl0KSB7XG4gICAgICAgICAgICB2YXIgQyA9IGFuZ2xlIC0gdGhpcy5tX3VwcGVyQW5nbGU7XG4gICAgICAgICAgICBhbmd1bGFyRXJyb3IgPSBDO1xuICAgICAgICAgICAgQyA9IGNsYW1wKEMgLSBTZXR0aW5nc0ludGVybmFsLmFuZ3VsYXJTbG9wLCAwLCBTZXR0aW5nc0ludGVybmFsLm1heEFuZ3VsYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgICAgIGxpbWl0SW1wdWxzZSA9IC10aGlzLm1fbW90b3JNYXNzICogQztcbiAgICAgICAgICB9XG4gICAgICAgICAgYUEgLT0gdGhpcy5tX2ludklBICogbGltaXRJbXB1bHNlO1xuICAgICAgICAgIGFCICs9IHRoaXMubV9pbnZJQiAqIGxpbWl0SW1wdWxzZTtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgcUEuc2V0QW5nbGUoYUEpO1xuICAgICAgICAgIHFCLnNldEFuZ2xlKGFCKTtcbiAgICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgICB2YXIgQyA9IFZlYzIuemVybygpO1xuICAgICAgICAgIEMuYWRkQ29tYmluZSgxLCBjQjIsIDEsIHJCMik7XG4gICAgICAgICAgQy5zdWJDb21iaW5lKDEsIGNBMiwgMSwgckEyKTtcbiAgICAgICAgICBwb3NpdGlvbkVycm9yID0gQy5sZW5ndGgoKTtcbiAgICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgICAgdmFyIEsgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgICBLLmV4LnggPSBtQSArIG1CICsgaUEgKiByQTIueSAqIHJBMi55ICsgaUIgKiByQjIueSAqIHJCMi55O1xuICAgICAgICAgIEsuZXgueSA9IC1pQSAqIHJBMi54ICogckEyLnkgLSBpQiAqIHJCMi54ICogckIyLnk7XG4gICAgICAgICAgSy5leS54ID0gSy5leC55O1xuICAgICAgICAgIEsuZXkueSA9IG1BICsgbUIgKyBpQSAqIHJBMi54ICogckEyLnggKyBpQiAqIHJCMi54ICogckIyLng7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSBWZWMyLm5lZyhLLnNvbHZlKEMpKTtcbiAgICAgICAgICBjQTIuc3ViTXVsKG1BLCBpbXB1bHNlKTtcbiAgICAgICAgICBhQSAtPSBpQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIGltcHVsc2UpO1xuICAgICAgICAgIGNCMi5hZGRNdWwobUIsIGltcHVsc2UpO1xuICAgICAgICAgIGFCICs9IGlCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgaW1wdWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmEgPSBhQTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYy5zZXRWZWMyKGNCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmEgPSBhQjtcbiAgICAgICAgcmV0dXJuIHBvc2l0aW9uRXJyb3IgPD0gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wICYmIGFuZ3VsYXJFcnJvciA8PSBTZXR0aW5nc0ludGVybmFsLmFuZ3VsYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLlRZUEUgPSBcInJldm9sdXRlLWpvaW50XCI7XG4gICAgICByZXR1cm4gUmV2b2x1dGVKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIG1hdGhfYWJzJDMgPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfbWF4ID0gTWF0aC5tYXg7XG4gIHZhciBtYXRoX21pbiQyID0gTWF0aC5taW47XG4gIHZhciBMaW1pdFN0YXRlJDE7XG4gIChmdW5jdGlvbihMaW1pdFN0YXRlMikge1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiaW5hY3RpdmVMaW1pdFwiXSA9IDBdID0gXCJpbmFjdGl2ZUxpbWl0XCI7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJhdExvd2VyTGltaXRcIl0gPSAxXSA9IFwiYXRMb3dlckxpbWl0XCI7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJhdFVwcGVyTGltaXRcIl0gPSAyXSA9IFwiYXRVcHBlckxpbWl0XCI7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJlcXVhbExpbWl0c1wiXSA9IDNdID0gXCJlcXVhbExpbWl0c1wiO1xuICB9KShMaW1pdFN0YXRlJDEgfHwgKExpbWl0U3RhdGUkMSA9IHt9KSk7XG4gIHZhciBERUZBVUxUUyQ3ID0ge1xuICAgIGVuYWJsZUxpbWl0OiBmYWxzZSxcbiAgICBsb3dlclRyYW5zbGF0aW9uOiAwLFxuICAgIHVwcGVyVHJhbnNsYXRpb246IDAsXG4gICAgZW5hYmxlTW90b3I6IGZhbHNlLFxuICAgIG1heE1vdG9yRm9yY2U6IDAsXG4gICAgbW90b3JTcGVlZDogMFxuICB9O1xuICB2YXIgUHJpc21hdGljSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFByaXNtYXRpY0pvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIFByaXNtYXRpY0pvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yLCBheGlzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgUHJpc21hdGljSm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgUHJpc21hdGljSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IsIGF4aXMpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQ3KTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IFByaXNtYXRpY0pvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQSB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5Qi5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JCIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbFhBeGlzQSA9IFZlYzIuY2xvbmUoYXhpcyA/IGJvZHlBLmdldExvY2FsVmVjdG9yKGF4aXMpIDogZGVmLmxvY2FsQXhpc0EgfHwgVmVjMi5uZW8oMSwgMCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsWEF4aXNBLm5vcm1hbGl6ZSgpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsWUF4aXNBID0gVmVjMi5jcm9zc051bVZlYzIoMSwgX3RoaXMubV9sb2NhbFhBeGlzQSk7XG4gICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBOdW1iZXIuaXNGaW5pdGUoZGVmLnJlZmVyZW5jZUFuZ2xlKSA/IGRlZi5yZWZlcmVuY2VBbmdsZSA6IGJvZHlCLmdldEFuZ2xlKCkgLSBib2R5QS5nZXRBbmdsZSgpO1xuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSBuZXcgVmVjMygpO1xuICAgICAgICBfdGhpcy5tX21vdG9yTWFzcyA9IDA7XG4gICAgICAgIF90aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgX3RoaXMubV9sb3dlclRyYW5zbGF0aW9uID0gZGVmLmxvd2VyVHJhbnNsYXRpb247XG4gICAgICAgIF90aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiA9IGRlZi51cHBlclRyYW5zbGF0aW9uO1xuICAgICAgICBfdGhpcy5tX21heE1vdG9yRm9yY2UgPSBkZWYubWF4TW90b3JGb3JjZTtcbiAgICAgICAgX3RoaXMubV9tb3RvclNwZWVkID0gZGVmLm1vdG9yU3BlZWQ7XG4gICAgICAgIF90aGlzLm1fZW5hYmxlTGltaXQgPSBkZWYuZW5hYmxlTGltaXQ7XG4gICAgICAgIF90aGlzLm1fZW5hYmxlTW90b3IgPSBkZWYuZW5hYmxlTW90b3I7XG4gICAgICAgIF90aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMS5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICBfdGhpcy5tX2F4aXMgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9wZXJwID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fSyA9IG5ldyBNYXQzMygpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgbG93ZXJUcmFuc2xhdGlvbjogdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24sXG4gICAgICAgICAgdXBwZXJUcmFuc2xhdGlvbjogdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24sXG4gICAgICAgICAgbWF4TW90b3JGb3JjZTogdGhpcy5tX21heE1vdG9yRm9yY2UsXG4gICAgICAgICAgbW90b3JTcGVlZDogdGhpcy5tX21vdG9yU3BlZWQsXG4gICAgICAgICAgZW5hYmxlTGltaXQ6IHRoaXMubV9lbmFibGVMaW1pdCxcbiAgICAgICAgICBlbmFibGVNb3RvcjogdGhpcy5tX2VuYWJsZU1vdG9yLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckIsXG4gICAgICAgICAgbG9jYWxBeGlzQTogdGhpcy5tX2xvY2FsWEF4aXNBLFxuICAgICAgICAgIHJlZmVyZW5jZUFuZ2xlOiB0aGlzLm1fcmVmZXJlbmNlQW5nbGVcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIGRhdGEubG9jYWxBeGlzQSA9IFZlYzIuY2xvbmUoZGF0YS5sb2NhbEF4aXNBKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IFByaXNtYXRpY0pvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMih0aGlzLm1fYm9keUEuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQSkpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5hbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKHRoaXMubV9ib2R5Qi5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JCKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMihkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmxvY2FsQXhpc0EpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxYQXhpc0Euc2V0VmVjMihkZWYubG9jYWxBeGlzQSk7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsWUF4aXNBLnNldFZlYzIoVmVjMi5jcm9zc051bVZlYzIoMSwgZGVmLmxvY2FsQXhpc0EpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5yZWZlcmVuY2VBbmdsZSkpIHtcbiAgICAgICAgICB0aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBkZWYucmVmZXJlbmNlQW5nbGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBkZWYuZW5hYmxlTGltaXQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSAhIWRlZi5lbmFibGVMaW1pdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5sb3dlclRyYW5zbGF0aW9uKSkge1xuICAgICAgICAgIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uID0gZGVmLmxvd2VyVHJhbnNsYXRpb247XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYudXBwZXJUcmFuc2xhdGlvbikpIHtcbiAgICAgICAgICB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiA9IGRlZi51cHBlclRyYW5zbGF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZGVmLmVuYWJsZU1vdG9yICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gISFkZWYuZW5hYmxlTW90b3I7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4TW90b3JGb3JjZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4TW90b3JGb3JjZSA9IGRlZi5tYXhNb3RvckZvcmNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1vdG9yU3BlZWQpKSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JCO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBeGlzQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsWEF4aXNBO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0UmVmZXJlbmNlQW5nbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldEpvaW50VHJhbnNsYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHBBMiA9IHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgICB2YXIgcEIyID0gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuc3ViKHBCMiwgcEEyKTtcbiAgICAgICAgdmFyIGF4aXMgPSB0aGlzLm1fYm9keUEuZ2V0V29ybGRWZWN0b3IodGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgdmFyIHRyYW5zbGF0aW9uMiA9IFZlYzIuZG90KGQyLCBheGlzKTtcbiAgICAgICAgcmV0dXJuIHRyYW5zbGF0aW9uMjtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldEpvaW50U3BlZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihiQS5tX3hmLnEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIpKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKGJCLm1feGYucSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgYkIubV9zd2VlcC5sb2NhbENlbnRlcikpO1xuICAgICAgICB2YXIgcDEgPSBWZWMyLmFkZChiQS5tX3N3ZWVwLmMsIHJBMik7XG4gICAgICAgIHZhciBwMiA9IFZlYzIuYWRkKGJCLm1fc3dlZXAuYywgckIyKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi5zdWIocDIsIHAxKTtcbiAgICAgICAgdmFyIGF4aXMgPSBSb3QubXVsVmVjMihiQS5tX3hmLnEsIHRoaXMubV9sb2NhbFhBeGlzQSk7XG4gICAgICAgIHZhciB2QTIgPSBiQS5tX2xpbmVhclZlbG9jaXR5O1xuICAgICAgICB2YXIgdkIyID0gYkIubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgICAgdmFyIHdBID0gYkEubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgIHZhciB3QiA9IGJCLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICB2YXIgc3BlZWQgPSBWZWMyLmRvdChkMiwgVmVjMi5jcm9zc051bVZlYzIod0EsIGF4aXMpKSArIFZlYzIuZG90KGF4aXMsIFZlYzIuc3ViKFZlYzIuYWRkQ3Jvc3NOdW1WZWMyKHZCMiwgd0IsIHJCMiksIFZlYzIuYWRkQ3Jvc3NOdW1WZWMyKHZBMiwgd0EsIHJBMikpKTtcbiAgICAgICAgcmV0dXJuIHNwZWVkO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuaXNMaW1pdEVuYWJsZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9lbmFibGVMaW1pdDtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmVuYWJsZUxpbWl0ID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAoZmxhZyAhPSB0aGlzLm1fZW5hYmxlTGltaXQpIHtcbiAgICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9IGZsYWc7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldExvd2VyTGltaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0VXBwZXJMaW1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb247XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5zZXRMaW1pdHMgPSBmdW5jdGlvbihsb3dlciwgdXBwZXIpIHtcbiAgICAgICAgaWYgKGxvd2VyICE9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uIHx8IHVwcGVyICE9IHRoaXMubV91cHBlclRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGxvd2VyO1xuICAgICAgICAgIHRoaXMubV91cHBlclRyYW5zbGF0aW9uID0gdXBwZXI7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmlzTW90b3JFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTW90b3I7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5lbmFibGVNb3RvciA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcgPT0gdGhpcy5tX2VuYWJsZU1vdG9yKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGZsYWc7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5zZXRNb3RvclNwZWVkID0gZnVuY3Rpb24oc3BlZWQpIHtcbiAgICAgICAgaWYgKHNwZWVkID09IHRoaXMubV9tb3RvclNwZWVkKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9tb3RvclNwZWVkID0gc3BlZWQ7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhNb3RvckZvcmNlID0gZnVuY3Rpb24oZm9yY2UpIHtcbiAgICAgICAgaWYgKGZvcmNlID09IHRoaXMubV9tYXhNb3RvckZvcmNlKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9tYXhNb3RvckZvcmNlID0gZm9yY2U7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhNb3RvckZvcmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4TW90b3JGb3JjZTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldE1vdG9yU3BlZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tb3RvclNwZWVkO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0TW90b3JGb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLmNvbWJpbmUodGhpcy5tX2ltcHVsc2UueCwgdGhpcy5tX3BlcnAsIHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56LCB0aGlzLm1fYXhpcykubXVsKGludl9kdCk7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHZhciByQjIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgZDIuYWRkQ29tYmluZSgxLCBjQjIsIDEsIHJCMik7XG4gICAgICAgIGQyLnN1YkNvbWJpbmUoMSwgY0EyLCAxLCByQTIpO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHtcbiAgICAgICAgICB0aGlzLm1fYXhpcyA9IFJvdC5tdWxWZWMyKHFBLCB0aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICAgIHRoaXMubV9hMSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihWZWMyLmFkZChkMiwgckEyKSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHRoaXMubV9hMiA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gbUEgKyBtQiArIGlBICogdGhpcy5tX2ExICogdGhpcy5tX2ExICsgaUIgKiB0aGlzLm1fYTIgKiB0aGlzLm1fYTI7XG4gICAgICAgICAgaWYgKHRoaXMubV9tb3Rvck1hc3MgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gMSAvIHRoaXMubV9tb3Rvck1hc3M7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICB0aGlzLm1fcGVycCA9IFJvdC5tdWxWZWMyKHFBLCB0aGlzLm1fbG9jYWxZQXhpc0EpO1xuICAgICAgICAgIHRoaXMubV9zMSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihWZWMyLmFkZChkMiwgckEyKSwgdGhpcy5tX3BlcnApO1xuICAgICAgICAgIHRoaXMubV9zMiA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHRoaXMubV9wZXJwKTtcbiAgICAgICAgICBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCB0aGlzLm1fcGVycCk7XG4gICAgICAgICAgdmFyIGsxMSA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9zMSAqIHRoaXMubV9zMSArIGlCICogdGhpcy5tX3MyICogdGhpcy5tX3MyO1xuICAgICAgICAgIHZhciBrMTIgPSBpQSAqIHRoaXMubV9zMSArIGlCICogdGhpcy5tX3MyO1xuICAgICAgICAgIHZhciBrMTMgPSBpQSAqIHRoaXMubV9zMSAqIHRoaXMubV9hMSArIGlCICogdGhpcy5tX3MyICogdGhpcy5tX2EyO1xuICAgICAgICAgIHZhciBrMjIgPSBpQSArIGlCO1xuICAgICAgICAgIGlmIChrMjIgPT0gMCkge1xuICAgICAgICAgICAgazIyID0gMTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGsyMyA9IGlBICogdGhpcy5tX2ExICsgaUIgKiB0aGlzLm1fYTI7XG4gICAgICAgICAgdmFyIGszMyA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9hMSAqIHRoaXMubV9hMSArIGlCICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xuICAgICAgICAgIHRoaXMubV9LLmV4LnNldChrMTEsIGsxMiwgazEzKTtcbiAgICAgICAgICB0aGlzLm1fSy5leS5zZXQoazEyLCBrMjIsIGsyMyk7XG4gICAgICAgICAgdGhpcy5tX0suZXouc2V0KGsxMywgazIzLCBrMzMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQpIHtcbiAgICAgICAgICB2YXIgam9pbnRUcmFuc2xhdGlvbiA9IFZlYzIuZG90KHRoaXMubV9heGlzLCBkMik7XG4gICAgICAgICAgaWYgKG1hdGhfYWJzJDModGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikgPCAyICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKSB7XG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMS5lcXVhbExpbWl0cztcbiAgICAgICAgICB9IGVsc2UgaWYgKGpvaW50VHJhbnNsYXRpb24gPD0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDEuYXRMb3dlckxpbWl0KSB7XG4gICAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQxLmF0TG93ZXJMaW1pdDtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChqb2ludFRyYW5zbGF0aW9uID49IHRoaXMubV91cHBlclRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQxLmF0VXBwZXJMaW1pdCkge1xuICAgICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMS5hdFVwcGVyTGltaXQ7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMS5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQxLmluYWN0aXZlTGltaXQ7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVNb3RvciA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLm11bChzdGVwLmR0UmF0aW8pO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIuY29tYmluZSh0aGlzLm1faW1wdWxzZS54LCB0aGlzLm1fcGVycCwgdGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnosIHRoaXMubV9heGlzKTtcbiAgICAgICAgICB2YXIgTEEgPSB0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3MxICsgdGhpcy5tX2ltcHVsc2UueSArICh0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueikgKiB0aGlzLm1fYTE7XG4gICAgICAgICAgdmFyIExCID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9zMiArIHRoaXMubV9pbXB1bHNlLnkgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopICogdGhpcy5tX2EyO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIExBO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIExCO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52LnNldFZlYzIodkEyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVNb3RvciAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDEuZXF1YWxMaW1pdHMpIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuZG90KHRoaXMubV9heGlzLCBWZWMyLnN1Yih2QjIsIHZBMikpICsgdGhpcy5tX2EyICogd0IgLSB0aGlzLm1fYTEgKiB3QTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IHRoaXMubV9tb3Rvck1hc3MgKiAodGhpcy5tX21vdG9yU3BlZWQgLSBDZG90KTtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heE1vdG9yRm9yY2U7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IGNsYW1wKHRoaXMubV9tb3RvckltcHVsc2UgKyBpbXB1bHNlLCAtbWF4SW1wdWxzZSwgbWF4SW1wdWxzZSk7XG4gICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2UgLSBvbGRJbXB1bHNlO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihpbXB1bHNlLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgdmFyIExBID0gaW1wdWxzZSAqIHRoaXMubV9hMTtcbiAgICAgICAgICB2YXIgTEIgPSBpbXB1bHNlICogdGhpcy5tX2EyO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIExBO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIExCO1xuICAgICAgICB9XG4gICAgICAgIHZhciBDZG90MSA9IFZlYzIuemVybygpO1xuICAgICAgICBDZG90MS54ICs9IFZlYzIuZG90KHRoaXMubV9wZXJwLCB2QjIpICsgdGhpcy5tX3MyICogd0I7XG4gICAgICAgIENkb3QxLnggLT0gVmVjMi5kb3QodGhpcy5tX3BlcnAsIHZBMikgKyB0aGlzLm1fczEgKiB3QTtcbiAgICAgICAgQ2RvdDEueSA9IHdCIC0gd0E7XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQxLmluYWN0aXZlTGltaXQpIHtcbiAgICAgICAgICB2YXIgQ2RvdDIgPSAwO1xuICAgICAgICAgIENkb3QyICs9IFZlYzIuZG90KHRoaXMubV9heGlzLCB2QjIpICsgdGhpcy5tX2EyICogd0I7XG4gICAgICAgICAgQ2RvdDIgLT0gVmVjMi5kb3QodGhpcy5tX2F4aXMsIHZBMikgKyB0aGlzLm1fYTEgKiB3QTtcbiAgICAgICAgICB2YXIgQ2RvdCA9IG5ldyBWZWMzKENkb3QxLngsIENkb3QxLnksIENkb3QyKTtcbiAgICAgICAgICB2YXIgZjEgPSBWZWMzLmNsb25lKHRoaXMubV9pbXB1bHNlKTtcbiAgICAgICAgICB2YXIgZGYgPSB0aGlzLm1fSy5zb2x2ZTMzKFZlYzMubmVnKENkb3QpKTtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5hZGQoZGYpO1xuICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBMaW1pdFN0YXRlJDEuYXRMb3dlckxpbWl0KSB7XG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gbWF0aF9tYXgodGhpcy5tX2ltcHVsc2UueiwgMCk7XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBMaW1pdFN0YXRlJDEuYXRVcHBlckxpbWl0KSB7XG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gbWF0aF9taW4kMih0aGlzLm1faW1wdWxzZS56LCAwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGIyID0gVmVjMi5jb21iaW5lKC0xLCBDZG90MSwgLSh0aGlzLm1faW1wdWxzZS56IC0gZjEueiksIFZlYzIubmVvKHRoaXMubV9LLmV6LngsIHRoaXMubV9LLmV6LnkpKTtcbiAgICAgICAgICB2YXIgZjJyID0gVmVjMi5hZGQodGhpcy5tX0suc29sdmUyMihiMiksIFZlYzIubmVvKGYxLngsIGYxLnkpKTtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS54ID0gZjJyLng7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSA9IGYyci55O1xuICAgICAgICAgIGRmID0gVmVjMy5zdWIodGhpcy5tX2ltcHVsc2UsIGYxKTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLmNvbWJpbmUoZGYueCwgdGhpcy5tX3BlcnAsIGRmLnosIHRoaXMubV9heGlzKTtcbiAgICAgICAgICB2YXIgTEEgPSBkZi54ICogdGhpcy5tX3MxICsgZGYueSArIGRmLnogKiB0aGlzLm1fYTE7XG4gICAgICAgICAgdmFyIExCID0gZGYueCAqIHRoaXMubV9zMiArIGRmLnkgKyBkZi56ICogdGhpcy5tX2EyO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIExBO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIExCO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBkZiA9IHRoaXMubV9LLnNvbHZlMjIoVmVjMi5uZWcoQ2RvdDEpKTtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IGRmLng7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSArPSBkZi55O1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihkZi54LCB0aGlzLm1fcGVycCk7XG4gICAgICAgICAgdmFyIExBID0gZGYueCAqIHRoaXMubV9zMSArIGRmLnk7XG4gICAgICAgICAgdmFyIExCID0gZGYueCAqIHRoaXMubV9zMiArIGRmLnk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogTEE7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogTEI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi5zdWIoVmVjMi5hZGQoY0IyLCByQjIpLCBWZWMyLmFkZChjQTIsIHJBMikpO1xuICAgICAgICB2YXIgYXhpcyA9IFJvdC5tdWxWZWMyKHFBLCB0aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICB2YXIgYTEgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIGF4aXMpO1xuICAgICAgICB2YXIgYTIgPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBheGlzKTtcbiAgICAgICAgdmFyIHBlcnAyID0gUm90Lm11bFZlYzIocUEsIHRoaXMubV9sb2NhbFlBeGlzQSk7XG4gICAgICAgIHZhciBzMSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihWZWMyLmFkZChkMiwgckEyKSwgcGVycDIpO1xuICAgICAgICB2YXIgczIgPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBwZXJwMik7XG4gICAgICAgIHZhciBpbXB1bHNlID0gbmV3IFZlYzMoKTtcbiAgICAgICAgdmFyIEMxID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIEMxLnggPSBWZWMyLmRvdChwZXJwMiwgZDIpO1xuICAgICAgICBDMS55ID0gYUIgLSBhQSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgdmFyIGxpbmVhckVycm9yID0gbWF0aF9hYnMkMyhDMS54KTtcbiAgICAgICAgdmFyIGFuZ3VsYXJFcnJvciA9IG1hdGhfYWJzJDMoQzEueSk7XG4gICAgICAgIHZhciBsaW5lYXJTbG9wID0gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgICB2YXIgbWF4TGluZWFyQ29ycmVjdGlvbiA9IFNldHRpbmdzSW50ZXJuYWwubWF4TGluZWFyQ29ycmVjdGlvbjtcbiAgICAgICAgdmFyIGFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB2YXIgQzIgPSAwO1xuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0KSB7XG4gICAgICAgICAgdmFyIHRyYW5zbGF0aW9uMiA9IFZlYzIuZG90KGF4aXMsIGQyKTtcbiAgICAgICAgICBpZiAobWF0aF9hYnMkMyh0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiAtIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSA8IDIgKiBsaW5lYXJTbG9wKSB7XG4gICAgICAgICAgICBDMiA9IGNsYW1wKHRyYW5zbGF0aW9uMiwgLW1heExpbmVhckNvcnJlY3Rpb24sIG1heExpbmVhckNvcnJlY3Rpb24pO1xuICAgICAgICAgICAgbGluZWFyRXJyb3IgPSBtYXRoX21heChsaW5lYXJFcnJvciwgbWF0aF9hYnMkMyh0cmFuc2xhdGlvbjIpKTtcbiAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIGlmICh0cmFuc2xhdGlvbjIgPD0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgIEMyID0gY2xhbXAodHJhbnNsYXRpb24yIC0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gKyBsaW5lYXJTbG9wLCAtbWF4TGluZWFyQ29ycmVjdGlvbiwgMCk7XG4gICAgICAgICAgICBsaW5lYXJFcnJvciA9IE1hdGgubWF4KGxpbmVhckVycm9yLCB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiAtIHRyYW5zbGF0aW9uMik7XG4gICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSBpZiAodHJhbnNsYXRpb24yID49IHRoaXMubV91cHBlclRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICBDMiA9IGNsYW1wKHRyYW5zbGF0aW9uMiAtIHRoaXMubV91cHBlclRyYW5zbGF0aW9uIC0gbGluZWFyU2xvcCwgMCwgbWF4TGluZWFyQ29ycmVjdGlvbik7XG4gICAgICAgICAgICBsaW5lYXJFcnJvciA9IE1hdGgubWF4KGxpbmVhckVycm9yLCB0cmFuc2xhdGlvbjIgLSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbik7XG4gICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoYWN0aXZlKSB7XG4gICAgICAgICAgdmFyIGsxMSA9IG1BICsgbUIgKyBpQSAqIHMxICogczEgKyBpQiAqIHMyICogczI7XG4gICAgICAgICAgdmFyIGsxMiA9IGlBICogczEgKyBpQiAqIHMyO1xuICAgICAgICAgIHZhciBrMTMgPSBpQSAqIHMxICogYTEgKyBpQiAqIHMyICogYTI7XG4gICAgICAgICAgdmFyIGsyMiA9IGlBICsgaUI7XG4gICAgICAgICAgaWYgKGsyMiA9PSAwKSB7XG4gICAgICAgICAgICBrMjIgPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgazIzID0gaUEgKiBhMSArIGlCICogYTI7XG4gICAgICAgICAgdmFyIGszMyA9IG1BICsgbUIgKyBpQSAqIGExICogYTEgKyBpQiAqIGEyICogYTI7XG4gICAgICAgICAgdmFyIEsgPSBuZXcgTWF0MzMoKTtcbiAgICAgICAgICBLLmV4LnNldChrMTEsIGsxMiwgazEzKTtcbiAgICAgICAgICBLLmV5LnNldChrMTIsIGsyMiwgazIzKTtcbiAgICAgICAgICBLLmV6LnNldChrMTMsIGsyMywgazMzKTtcbiAgICAgICAgICB2YXIgQyA9IG5ldyBWZWMzKCk7XG4gICAgICAgICAgQy54ID0gQzEueDtcbiAgICAgICAgICBDLnkgPSBDMS55O1xuICAgICAgICAgIEMueiA9IEMyO1xuICAgICAgICAgIGltcHVsc2UgPSBLLnNvbHZlMzMoVmVjMy5uZWcoQykpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBrMTEgPSBtQSArIG1CICsgaUEgKiBzMSAqIHMxICsgaUIgKiBzMiAqIHMyO1xuICAgICAgICAgIHZhciBrMTIgPSBpQSAqIHMxICsgaUIgKiBzMjtcbiAgICAgICAgICB2YXIgazIyID0gaUEgKyBpQjtcbiAgICAgICAgICBpZiAoazIyID09IDApIHtcbiAgICAgICAgICAgIGsyMiA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBLID0gbmV3IE1hdDIyKCk7XG4gICAgICAgICAgSy5leC5zZXROdW0oazExLCBrMTIpO1xuICAgICAgICAgIEsuZXkuc2V0TnVtKGsxMiwgazIyKTtcbiAgICAgICAgICB2YXIgaW1wdWxzZTEgPSBLLnNvbHZlKFZlYzIubmVnKEMxKSk7XG4gICAgICAgICAgaW1wdWxzZS54ID0gaW1wdWxzZTEueDtcbiAgICAgICAgICBpbXB1bHNlLnkgPSBpbXB1bHNlMS55O1xuICAgICAgICAgIGltcHVsc2UueiA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIFAzID0gVmVjMi5jb21iaW5lKGltcHVsc2UueCwgcGVycDIsIGltcHVsc2UueiwgYXhpcyk7XG4gICAgICAgIHZhciBMQSA9IGltcHVsc2UueCAqIHMxICsgaW1wdWxzZS55ICsgaW1wdWxzZS56ICogYTE7XG4gICAgICAgIHZhciBMQiA9IGltcHVsc2UueCAqIHMyICsgaW1wdWxzZS55ICsgaW1wdWxzZS56ICogYTI7XG4gICAgICAgIGNBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgYUEgLT0gaUEgKiBMQTtcbiAgICAgICAgY0IyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICBhQiArPSBpQiAqIExCO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jID0gY0EyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hID0gYUE7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmMgPSBjQjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmEgPSBhQjtcbiAgICAgICAgcmV0dXJuIGxpbmVhckVycm9yIDw9IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCAmJiBhbmd1bGFyRXJyb3IgPD0gU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcDtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIuVFlQRSA9IFwicHJpc21hdGljLWpvaW50XCI7XG4gICAgICByZXR1cm4gUHJpc21hdGljSm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBERUZBVUxUUyQ2ID0ge1xuICAgIHJhdGlvOiAxXG4gIH07XG4gIHZhciBHZWFySm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKEdlYXJKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBHZWFySm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBqb2ludDEsIGpvaW50MiwgcmF0aW8pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBHZWFySm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgR2VhckpvaW50MihkZWYsIGJvZHlBLCBib2R5Qiwgam9pbnQxLCBqb2ludDIsIHJhdGlvKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkNik7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBHZWFySm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fam9pbnQxID0gam9pbnQxID8gam9pbnQxIDogZGVmLmpvaW50MTtcbiAgICAgICAgX3RoaXMubV9qb2ludDIgPSBqb2ludDIgPyBqb2ludDIgOiBkZWYuam9pbnQyO1xuICAgICAgICBfdGhpcy5tX3JhdGlvID0gTnVtYmVyLmlzRmluaXRlKHJhdGlvKSA/IHJhdGlvIDogZGVmLnJhdGlvO1xuICAgICAgICBfdGhpcy5tX3R5cGUxID0gX3RoaXMubV9qb2ludDEuZ2V0VHlwZSgpO1xuICAgICAgICBfdGhpcy5tX3R5cGUyID0gX3RoaXMubV9qb2ludDIuZ2V0VHlwZSgpO1xuICAgICAgICB2YXIgY29vcmRpbmF0ZUE7XG4gICAgICAgIHZhciBjb29yZGluYXRlQjtcbiAgICAgICAgX3RoaXMubV9ib2R5QyA9IF90aGlzLm1fam9pbnQxLmdldEJvZHlBKCk7XG4gICAgICAgIF90aGlzLm1fYm9keUEgPSBfdGhpcy5tX2pvaW50MS5nZXRCb2R5QigpO1xuICAgICAgICB2YXIgeGZBMiA9IF90aGlzLm1fYm9keUEubV94ZjtcbiAgICAgICAgdmFyIGFBID0gX3RoaXMubV9ib2R5QS5tX3N3ZWVwLmE7XG4gICAgICAgIHZhciB4ZkMgPSBfdGhpcy5tX2JvZHlDLm1feGY7XG4gICAgICAgIHZhciBhQyA9IF90aGlzLm1fYm9keUMubV9zd2VlcC5hO1xuICAgICAgICBpZiAoX3RoaXMubV90eXBlMSA9PT0gUmV2b2x1dGVKb2ludC5UWVBFKSB7XG4gICAgICAgICAgdmFyIHJldm9sdXRlID0gX3RoaXMubV9qb2ludDE7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckMgPSByZXZvbHV0ZS5tX2xvY2FsQW5jaG9yQTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IHJldm9sdXRlLm1fbG9jYWxBbmNob3JCO1xuICAgICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGVBID0gcmV2b2x1dGUubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQXhpc0MgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBjb29yZGluYXRlQSA9IGFBIC0gYUMgLSBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgcHJpc21hdGljID0gX3RoaXMubV9qb2ludDE7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckMgPSBwcmlzbWF0aWMubV9sb2NhbEFuY2hvckE7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBwcmlzbWF0aWMubV9sb2NhbEFuY2hvckI7XG4gICAgICAgICAgX3RoaXMubV9yZWZlcmVuY2VBbmdsZUEgPSBwcmlzbWF0aWMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQXhpc0MgPSBwcmlzbWF0aWMubV9sb2NhbFhBeGlzQTtcbiAgICAgICAgICB2YXIgcEMgPSBfdGhpcy5tX2xvY2FsQW5jaG9yQztcbiAgICAgICAgICB2YXIgcEEyID0gUm90Lm11bFRWZWMyKHhmQy5xLCBWZWMyLmFkZChSb3QubXVsVmVjMih4ZkEyLnEsIF90aGlzLm1fbG9jYWxBbmNob3JBKSwgVmVjMi5zdWIoeGZBMi5wLCB4ZkMucCkpKTtcbiAgICAgICAgICBjb29yZGluYXRlQSA9IFZlYzIuZG90KHBBMiwgX3RoaXMubV9sb2NhbEF4aXNDKSAtIFZlYzIuZG90KHBDLCBfdGhpcy5tX2xvY2FsQXhpc0MpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLm1fYm9keUQgPSBfdGhpcy5tX2pvaW50Mi5nZXRCb2R5QSgpO1xuICAgICAgICBfdGhpcy5tX2JvZHlCID0gX3RoaXMubV9qb2ludDIuZ2V0Qm9keUIoKTtcbiAgICAgICAgdmFyIHhmQjIgPSBfdGhpcy5tX2JvZHlCLm1feGY7XG4gICAgICAgIHZhciBhQiA9IF90aGlzLm1fYm9keUIubV9zd2VlcC5hO1xuICAgICAgICB2YXIgeGZEID0gX3RoaXMubV9ib2R5RC5tX3hmO1xuICAgICAgICB2YXIgYUQgPSBfdGhpcy5tX2JvZHlELm1fc3dlZXAuYTtcbiAgICAgICAgaWYgKF90aGlzLm1fdHlwZTIgPT09IFJldm9sdXRlSm9pbnQuVFlQRSkge1xuICAgICAgICAgIHZhciByZXZvbHV0ZSA9IF90aGlzLm1fam9pbnQyO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JEID0gcmV2b2x1dGUubV9sb2NhbEFuY2hvckE7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSByZXZvbHV0ZS5tX2xvY2FsQW5jaG9yQjtcbiAgICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQiA9IHJldm9sdXRlLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEF4aXNEID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgY29vcmRpbmF0ZUIgPSBhQiAtIGFEIC0gX3RoaXMubV9yZWZlcmVuY2VBbmdsZUI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHByaXNtYXRpYyA9IF90aGlzLm1fam9pbnQyO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JEID0gcHJpc21hdGljLm1fbG9jYWxBbmNob3JBO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gcHJpc21hdGljLm1fbG9jYWxBbmNob3JCO1xuICAgICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGVCID0gcHJpc21hdGljLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEF4aXNEID0gcHJpc21hdGljLm1fbG9jYWxYQXhpc0E7XG4gICAgICAgICAgdmFyIHBEID0gX3RoaXMubV9sb2NhbEFuY2hvckQ7XG4gICAgICAgICAgdmFyIHBCMiA9IFJvdC5tdWxUVmVjMih4ZkQucSwgVmVjMi5hZGQoUm90Lm11bFZlYzIoeGZCMi5xLCBfdGhpcy5tX2xvY2FsQW5jaG9yQiksIFZlYzIuc3ViKHhmQjIucCwgeGZELnApKSk7XG4gICAgICAgICAgY29vcmRpbmF0ZUIgPSBWZWMyLmRvdChwQjIsIF90aGlzLm1fbG9jYWxBeGlzRCkgLSBWZWMyLmRvdChwRCwgX3RoaXMubV9sb2NhbEF4aXNEKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5tX2NvbnN0YW50ID0gY29vcmRpbmF0ZUEgKyBfdGhpcy5tX3JhdGlvICogY29vcmRpbmF0ZUI7XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgam9pbnQxOiB0aGlzLm1fam9pbnQxLFxuICAgICAgICAgIGpvaW50MjogdGhpcy5tX2pvaW50MixcbiAgICAgICAgICByYXRpbzogdGhpcy5tX3JhdGlvXG4gICAgICAgICAgLy8gX2NvbnN0YW50OiB0aGlzLm1fY29uc3RhbnQsXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5qb2ludDEgPSByZXN0b3JlKEpvaW50LCBkYXRhLmpvaW50MSwgd29ybGQpO1xuICAgICAgICBkYXRhLmpvaW50MiA9IHJlc3RvcmUoSm9pbnQsIGRhdGEuam9pbnQyLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBHZWFySm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLnJhdGlvKSkge1xuICAgICAgICAgIHRoaXMubV9yYXRpbyA9IGRlZi5yYXRpbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLmdldEpvaW50MSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2pvaW50MTtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludDIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9qb2ludDI7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuc2V0UmF0aW8gPSBmdW5jdGlvbihyYXRpbykge1xuICAgICAgICB0aGlzLm1fcmF0aW8gPSByYXRpbztcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRSYXRpbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3JhdGlvO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubXVsTnVtVmVjMih0aGlzLm1faW1wdWxzZSwgdGhpcy5tX0p2QUMpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHZhciBMID0gdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSndBO1xuICAgICAgICByZXR1cm4gaW52X2R0ICogTDtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xjQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbGNCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sY0MgPSB0aGlzLm1fYm9keUMubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xjRCA9IHRoaXMubV9ib2R5RC5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbUEgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1fbUIgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1fbUMgPSB0aGlzLm1fYm9keUMubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1fbUQgPSB0aGlzLm1fYm9keUQubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB0aGlzLm1faUMgPSB0aGlzLm1fYm9keUMubV9pbnZJO1xuICAgICAgICB0aGlzLm1faUQgPSB0aGlzLm1fYm9keUQubV9pbnZJO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBhQyA9IHRoaXMubV9ib2R5Qy5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QyA9IHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QyA9IHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBhRCA9IHRoaXMubV9ib2R5RC5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2RCA9IHRoaXMubV9ib2R5RC5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3RCA9IHRoaXMubV9ib2R5RC5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIHFDID0gUm90Lm5lbyhhQyk7XG4gICAgICAgIHZhciBxRCA9IFJvdC5uZW8oYUQpO1xuICAgICAgICB0aGlzLm1fbWFzcyA9IDA7XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZTEgPT0gUmV2b2x1dGVKb2ludC5UWVBFKSB7XG4gICAgICAgICAgdGhpcy5tX0p2QUMgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fSndBID0gMTtcbiAgICAgICAgICB0aGlzLm1fSndDID0gMTtcbiAgICAgICAgICB0aGlzLm1fbWFzcyArPSB0aGlzLm1faUEgKyB0aGlzLm1faUM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHUgPSBSb3QubXVsVmVjMihxQywgdGhpcy5tX2xvY2FsQXhpc0MpO1xuICAgICAgICAgIHZhciByQyA9IFJvdC5tdWxTdWIocUMsIHRoaXMubV9sb2NhbEFuY2hvckMsIHRoaXMubV9sY0MpO1xuICAgICAgICAgIHZhciByQTIgPSBSb3QubXVsU3ViKHFBLCB0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbGNBKTtcbiAgICAgICAgICB0aGlzLm1fSnZBQyA9IHU7XG4gICAgICAgICAgdGhpcy5tX0p3QyA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQywgdSk7XG4gICAgICAgICAgdGhpcy5tX0p3QSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIHUpO1xuICAgICAgICAgIHRoaXMubV9tYXNzICs9IHRoaXMubV9tQyArIHRoaXMubV9tQSArIHRoaXMubV9pQyAqIHRoaXMubV9Kd0MgKiB0aGlzLm1fSndDICsgdGhpcy5tX2lBICogdGhpcy5tX0p3QSAqIHRoaXMubV9Kd0E7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlMiA9PSBSZXZvbHV0ZUpvaW50LlRZUEUpIHtcbiAgICAgICAgICB0aGlzLm1fSnZCRCA9IFZlYzIuemVybygpO1xuICAgICAgICAgIHRoaXMubV9Kd0IgPSB0aGlzLm1fcmF0aW87XG4gICAgICAgICAgdGhpcy5tX0p3RCA9IHRoaXMubV9yYXRpbztcbiAgICAgICAgICB0aGlzLm1fbWFzcyArPSB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiAodGhpcy5tX2lCICsgdGhpcy5tX2lEKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgdSA9IFJvdC5tdWxWZWMyKHFELCB0aGlzLm1fbG9jYWxBeGlzRCk7XG4gICAgICAgICAgdmFyIHJEID0gUm90Lm11bFN1YihxRCwgdGhpcy5tX2xvY2FsQW5jaG9yRCwgdGhpcy5tX2xjRCk7XG4gICAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxTdWIocUIsIHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sY0IpO1xuICAgICAgICAgIHRoaXMubV9KdkJEID0gVmVjMi5tdWxOdW1WZWMyKHRoaXMubV9yYXRpbywgdSk7XG4gICAgICAgICAgdGhpcy5tX0p3RCA9IHRoaXMubV9yYXRpbyAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyRCwgdSk7XG4gICAgICAgICAgdGhpcy5tX0p3QiA9IHRoaXMubV9yYXRpbyAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHUpO1xuICAgICAgICAgIHRoaXMubV9tYXNzICs9IHRoaXMubV9yYXRpbyAqIHRoaXMubV9yYXRpbyAqICh0aGlzLm1fbUQgKyB0aGlzLm1fbUIpICsgdGhpcy5tX2lEICogdGhpcy5tX0p3RCAqIHRoaXMubV9Kd0QgKyB0aGlzLm1faUIgKiB0aGlzLm1fSndCICogdGhpcy5tX0p3QjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fbWFzcyA9IHRoaXMubV9tYXNzID4gMCA/IDEgLyB0aGlzLm1fbWFzcyA6IDA7XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHZBMi5hZGRNdWwodGhpcy5tX21BICogdGhpcy5tX2ltcHVsc2UsIHRoaXMubV9KdkFDKTtcbiAgICAgICAgICB3QSArPSB0aGlzLm1faUEgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9Kd0E7XG4gICAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1fbUIgKiB0aGlzLm1faW1wdWxzZSwgdGhpcy5tX0p2QkQpO1xuICAgICAgICAgIHdCICs9IHRoaXMubV9pQiAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0p3QjtcbiAgICAgICAgICB2Qy5zdWJNdWwodGhpcy5tX21DICogdGhpcy5tX2ltcHVsc2UsIHRoaXMubV9KdkFDKTtcbiAgICAgICAgICB3QyAtPSB0aGlzLm1faUMgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9Kd0M7XG4gICAgICAgICAgdkQuc3ViTXVsKHRoaXMubV9tRCAqIHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fSnZCRCk7XG4gICAgICAgICAgd0QgLT0gdGhpcy5tX2lEICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSndEO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52LnNldFZlYzIodkEyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgICB0aGlzLm1fYm9keUMuY192ZWxvY2l0eS52LnNldFZlYzIodkMpO1xuICAgICAgICB0aGlzLm1fYm9keUMuY192ZWxvY2l0eS53ID0gd0M7XG4gICAgICAgIHRoaXMubV9ib2R5RC5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2RCk7XG4gICAgICAgIHRoaXMubV9ib2R5RC5jX3ZlbG9jaXR5LncgPSB3RDtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZDID0gdGhpcy5tX2JvZHlDLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdDID0gdGhpcy5tX2JvZHlDLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZEID0gdGhpcy5tX2JvZHlELmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdEID0gdGhpcy5tX2JvZHlELmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIENkb3QgPSBWZWMyLmRvdCh0aGlzLm1fSnZBQywgdkEyKSAtIFZlYzIuZG90KHRoaXMubV9KdkFDLCB2QykgKyBWZWMyLmRvdCh0aGlzLm1fSnZCRCwgdkIyKSAtIFZlYzIuZG90KHRoaXMubV9KdkJELCB2RCk7XG4gICAgICAgIENkb3QgKz0gdGhpcy5tX0p3QSAqIHdBIC0gdGhpcy5tX0p3QyAqIHdDICsgKHRoaXMubV9Kd0IgKiB3QiAtIHRoaXMubV9Kd0QgKiB3RCk7XG4gICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tYXNzICogQ2RvdDtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UgKz0gaW1wdWxzZTtcbiAgICAgICAgdkEyLmFkZE11bCh0aGlzLm1fbUEgKiBpbXB1bHNlLCB0aGlzLm1fSnZBQyk7XG4gICAgICAgIHdBICs9IHRoaXMubV9pQSAqIGltcHVsc2UgKiB0aGlzLm1fSndBO1xuICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9tQiAqIGltcHVsc2UsIHRoaXMubV9KdkJEKTtcbiAgICAgICAgd0IgKz0gdGhpcy5tX2lCICogaW1wdWxzZSAqIHRoaXMubV9Kd0I7XG4gICAgICAgIHZDLnN1Yk11bCh0aGlzLm1fbUMgKiBpbXB1bHNlLCB0aGlzLm1fSnZBQyk7XG4gICAgICAgIHdDIC09IHRoaXMubV9pQyAqIGltcHVsc2UgKiB0aGlzLm1fSndDO1xuICAgICAgICB2RC5zdWJNdWwodGhpcy5tX21EICogaW1wdWxzZSwgdGhpcy5tX0p2QkQpO1xuICAgICAgICB3RCAtPSB0aGlzLm1faUQgKiBpbXB1bHNlICogdGhpcy5tX0p3RDtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgICAgdGhpcy5tX2JvZHlDLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZDKTtcbiAgICAgICAgdGhpcy5tX2JvZHlDLmNfdmVsb2NpdHkudyA9IHdDO1xuICAgICAgICB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS52LnNldFZlYzIodkQpO1xuICAgICAgICB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS53ID0gd0Q7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQyA9IHRoaXMubV9ib2R5Qy5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQyA9IHRoaXMubV9ib2R5Qy5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjRCA9IHRoaXMubV9ib2R5RC5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhRCA9IHRoaXMubV9ib2R5RC5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIHFDID0gUm90Lm5lbyhhQyk7XG4gICAgICAgIHZhciBxRCA9IFJvdC5uZW8oYUQpO1xuICAgICAgICB2YXIgbGluZWFyRXJyb3IgPSAwO1xuICAgICAgICB2YXIgY29vcmRpbmF0ZUE7XG4gICAgICAgIHZhciBjb29yZGluYXRlQjtcbiAgICAgICAgdmFyIEp2QUM7XG4gICAgICAgIHZhciBKdkJEO1xuICAgICAgICB2YXIgSndBO1xuICAgICAgICB2YXIgSndCO1xuICAgICAgICB2YXIgSndDO1xuICAgICAgICB2YXIgSndEO1xuICAgICAgICB2YXIgbWFzcyA9IDA7XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZTEgPT0gUmV2b2x1dGVKb2ludC5UWVBFKSB7XG4gICAgICAgICAgSnZBQyA9IFZlYzIuemVybygpO1xuICAgICAgICAgIEp3QSA9IDE7XG4gICAgICAgICAgSndDID0gMTtcbiAgICAgICAgICBtYXNzICs9IHRoaXMubV9pQSArIHRoaXMubV9pQztcbiAgICAgICAgICBjb29yZGluYXRlQSA9IGFBIC0gYUMgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGVBO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciB1ID0gUm90Lm11bFZlYzIocUMsIHRoaXMubV9sb2NhbEF4aXNDKTtcbiAgICAgICAgICB2YXIgckMgPSBSb3QubXVsU3ViKHFDLCB0aGlzLm1fbG9jYWxBbmNob3JDLCB0aGlzLm1fbGNDKTtcbiAgICAgICAgICB2YXIgckEyID0gUm90Lm11bFN1YihxQSwgdGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xjQSk7XG4gICAgICAgICAgSnZBQyA9IHU7XG4gICAgICAgICAgSndDID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJDLCB1KTtcbiAgICAgICAgICBKd0EgPSBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCB1KTtcbiAgICAgICAgICBtYXNzICs9IHRoaXMubV9tQyArIHRoaXMubV9tQSArIHRoaXMubV9pQyAqIEp3QyAqIEp3QyArIHRoaXMubV9pQSAqIEp3QSAqIEp3QTtcbiAgICAgICAgICB2YXIgcEMgPSBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JDLCB0aGlzLm1fbGNDKTtcbiAgICAgICAgICB2YXIgcEEyID0gUm90Lm11bFRWZWMyKHFDLCBWZWMyLmFkZChyQTIsIFZlYzIuc3ViKGNBMiwgY0MpKSk7XG4gICAgICAgICAgY29vcmRpbmF0ZUEgPSBWZWMyLmRvdChWZWMyLnN1YihwQTIsIHBDKSwgdGhpcy5tX2xvY2FsQXhpc0MpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZTIgPT0gUmV2b2x1dGVKb2ludC5UWVBFKSB7XG4gICAgICAgICAgSnZCRCA9IFZlYzIuemVybygpO1xuICAgICAgICAgIEp3QiA9IHRoaXMubV9yYXRpbztcbiAgICAgICAgICBKd0QgPSB0aGlzLm1fcmF0aW87XG4gICAgICAgICAgbWFzcyArPSB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiAodGhpcy5tX2lCICsgdGhpcy5tX2lEKTtcbiAgICAgICAgICBjb29yZGluYXRlQiA9IGFCIC0gYUQgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGVCO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciB1ID0gUm90Lm11bFZlYzIocUQsIHRoaXMubV9sb2NhbEF4aXNEKTtcbiAgICAgICAgICB2YXIgckQgPSBSb3QubXVsU3ViKHFELCB0aGlzLm1fbG9jYWxBbmNob3JELCB0aGlzLm1fbGNEKTtcbiAgICAgICAgICB2YXIgckIyID0gUm90Lm11bFN1YihxQiwgdGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xjQik7XG4gICAgICAgICAgSnZCRCA9IFZlYzIubXVsTnVtVmVjMih0aGlzLm1fcmF0aW8sIHUpO1xuICAgICAgICAgIEp3RCA9IHRoaXMubV9yYXRpbyAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyRCwgdSk7XG4gICAgICAgICAgSndCID0gdGhpcy5tX3JhdGlvICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgdSk7XG4gICAgICAgICAgbWFzcyArPSB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiAodGhpcy5tX21EICsgdGhpcy5tX21CKSArIHRoaXMubV9pRCAqIEp3RCAqIEp3RCArIHRoaXMubV9pQiAqIEp3QiAqIEp3QjtcbiAgICAgICAgICB2YXIgcEQgPSBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JELCB0aGlzLm1fbGNEKTtcbiAgICAgICAgICB2YXIgcEIyID0gUm90Lm11bFRWZWMyKHFELCBWZWMyLmFkZChyQjIsIFZlYzIuc3ViKGNCMiwgY0QpKSk7XG4gICAgICAgICAgY29vcmRpbmF0ZUIgPSBWZWMyLmRvdChwQjIsIHRoaXMubV9sb2NhbEF4aXNEKSAtIFZlYzIuZG90KHBELCB0aGlzLm1fbG9jYWxBeGlzRCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIEMgPSBjb29yZGluYXRlQSArIHRoaXMubV9yYXRpbyAqIGNvb3JkaW5hdGVCIC0gdGhpcy5tX2NvbnN0YW50O1xuICAgICAgICB2YXIgaW1wdWxzZSA9IDA7XG4gICAgICAgIGlmIChtYXNzID4gMCkge1xuICAgICAgICAgIGltcHVsc2UgPSAtQyAvIG1hc3M7XG4gICAgICAgIH1cbiAgICAgICAgY0EyLmFkZE11bCh0aGlzLm1fbUEgKiBpbXB1bHNlLCBKdkFDKTtcbiAgICAgICAgYUEgKz0gdGhpcy5tX2lBICogaW1wdWxzZSAqIEp3QTtcbiAgICAgICAgY0IyLmFkZE11bCh0aGlzLm1fbUIgKiBpbXB1bHNlLCBKdkJEKTtcbiAgICAgICAgYUIgKz0gdGhpcy5tX2lCICogaW1wdWxzZSAqIEp3QjtcbiAgICAgICAgY0Muc3ViTXVsKHRoaXMubV9tQyAqIGltcHVsc2UsIEp2QUMpO1xuICAgICAgICBhQyAtPSB0aGlzLm1faUMgKiBpbXB1bHNlICogSndDO1xuICAgICAgICBjRC5zdWJNdWwodGhpcy5tX21EICogaW1wdWxzZSwgSnZCRCk7XG4gICAgICAgIGFEIC09IHRoaXMubV9pRCAqIGltcHVsc2UgKiBKd0Q7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hID0gYUE7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHRoaXMubV9ib2R5Qy5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQyk7XG4gICAgICAgIHRoaXMubV9ib2R5Qy5jX3Bvc2l0aW9uLmEgPSBhQztcbiAgICAgICAgdGhpcy5tX2JvZHlELmNfcG9zaXRpb24uYy5zZXRWZWMyKGNEKTtcbiAgICAgICAgdGhpcy5tX2JvZHlELmNfcG9zaXRpb24uYSA9IGFEO1xuICAgICAgICByZXR1cm4gbGluZWFyRXJyb3IgPCBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5UWVBFID0gXCJnZWFyLWpvaW50XCI7XG4gICAgICByZXR1cm4gR2VhckpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgREVGQVVMVFMkNSA9IHtcbiAgICBtYXhGb3JjZTogMSxcbiAgICBtYXhUb3JxdWU6IDEsXG4gICAgY29ycmVjdGlvbkZhY3RvcjogMC4zXG4gIH07XG4gIHZhciBNb3RvckpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhNb3RvckpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIE1vdG9ySm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgTW90b3JKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBNb3RvckpvaW50MihkZWYsIGJvZHlBLCBib2R5Qik7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDUpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gTW90b3JKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9saW5lYXJPZmZzZXQgPSBWZWMyLmlzVmFsaWQoZGVmLmxpbmVhck9mZnNldCkgPyBWZWMyLmNsb25lKGRlZi5saW5lYXJPZmZzZXQpIDogYm9keUEuZ2V0TG9jYWxQb2ludChib2R5Qi5nZXRQb3NpdGlvbigpKTtcbiAgICAgICAgX3RoaXMubV9hbmd1bGFyT2Zmc2V0ID0gTnVtYmVyLmlzRmluaXRlKGRlZi5hbmd1bGFyT2Zmc2V0KSA/IGRlZi5hbmd1bGFyT2Zmc2V0IDogYm9keUIuZ2V0QW5nbGUoKSAtIGJvZHlBLmdldEFuZ2xlKCk7XG4gICAgICAgIF90aGlzLm1fbGluZWFySW1wdWxzZSA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX2FuZ3VsYXJJbXB1bHNlID0gMDtcbiAgICAgICAgX3RoaXMubV9tYXhGb3JjZSA9IGRlZi5tYXhGb3JjZTtcbiAgICAgICAgX3RoaXMubV9tYXhUb3JxdWUgPSBkZWYubWF4VG9ycXVlO1xuICAgICAgICBfdGhpcy5tX2NvcnJlY3Rpb25GYWN0b3IgPSBkZWYuY29ycmVjdGlvbkZhY3RvcjtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgbWF4Rm9yY2U6IHRoaXMubV9tYXhGb3JjZSxcbiAgICAgICAgICBtYXhUb3JxdWU6IHRoaXMubV9tYXhUb3JxdWUsXG4gICAgICAgICAgY29ycmVjdGlvbkZhY3RvcjogdGhpcy5tX2NvcnJlY3Rpb25GYWN0b3IsXG4gICAgICAgICAgbGluZWFyT2Zmc2V0OiB0aGlzLm1fbGluZWFyT2Zmc2V0LFxuICAgICAgICAgIGFuZ3VsYXJPZmZzZXQ6IHRoaXMubV9hbmd1bGFyT2Zmc2V0XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBNb3RvckpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuYW5ndWxhck9mZnNldCkpIHtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhck9mZnNldCA9IGRlZi5hbmd1bGFyT2Zmc2V0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1heEZvcmNlKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGRlZi5tYXhGb3JjZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhUb3JxdWUpKSB7XG4gICAgICAgICAgdGhpcy5tX21heFRvcnF1ZSA9IGRlZi5tYXhUb3JxdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuY29ycmVjdGlvbkZhY3RvcikpIHtcbiAgICAgICAgICB0aGlzLm1fY29ycmVjdGlvbkZhY3RvciA9IGRlZi5jb3JyZWN0aW9uRmFjdG9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChWZWMyLmlzVmFsaWQoZGVmLmxpbmVhck9mZnNldCkpIHtcbiAgICAgICAgICB0aGlzLm1fbGluZWFyT2Zmc2V0LnNldChkZWYubGluZWFyT2Zmc2V0KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5zZXRNYXhGb3JjZSA9IGZ1bmN0aW9uKGZvcmNlKSB7XG4gICAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGZvcmNlO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRNYXhGb3JjZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heEZvcmNlO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5zZXRNYXhUb3JxdWUgPSBmdW5jdGlvbih0b3JxdWUpIHtcbiAgICAgICAgdGhpcy5tX21heFRvcnF1ZSA9IHRvcnF1ZTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0TWF4VG9ycXVlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4VG9ycXVlO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5zZXRDb3JyZWN0aW9uRmFjdG9yID0gZnVuY3Rpb24oZmFjdG9yKSB7XG4gICAgICAgIHRoaXMubV9jb3JyZWN0aW9uRmFjdG9yID0gZmFjdG9yO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRDb3JyZWN0aW9uRmFjdG9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY29ycmVjdGlvbkZhY3RvcjtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuc2V0TGluZWFyT2Zmc2V0ID0gZnVuY3Rpb24obGluZWFyT2Zmc2V0KSB7XG4gICAgICAgIGlmIChsaW5lYXJPZmZzZXQueCAhPSB0aGlzLm1fbGluZWFyT2Zmc2V0LnggfHwgbGluZWFyT2Zmc2V0LnkgIT0gdGhpcy5tX2xpbmVhck9mZnNldC55KSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fbGluZWFyT2Zmc2V0LnNldChsaW5lYXJPZmZzZXQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldExpbmVhck9mZnNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xpbmVhck9mZnNldDtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuc2V0QW5ndWxhck9mZnNldCA9IGZ1bmN0aW9uKGFuZ3VsYXJPZmZzZXQpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXJPZmZzZXQgIT0gdGhpcy5tX2FuZ3VsYXJPZmZzZXQpIHtcbiAgICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFyT2Zmc2V0ID0gYW5ndWxhck9mZnNldDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRBbmd1bGFyT2Zmc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYW5ndWxhck9mZnNldDtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFBvc2l0aW9uKCk7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRQb3NpdGlvbigpO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm11bE51bVZlYzIoaW52X2R0LCB0aGlzLm1fbGluZWFySW1wdWxzZSk7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1fYW5ndWxhckltcHVsc2U7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9saW5lYXJPZmZzZXQsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFZlYzIocUIsIFZlYzIubmVnKHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgSyA9IG5ldyBNYXQyMigpO1xuICAgICAgICBLLmV4LnggPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fckEueSAqIHRoaXMubV9yQS55ICsgaUIgKiB0aGlzLm1fckIueSAqIHRoaXMubV9yQi55O1xuICAgICAgICBLLmV4LnkgPSAtaUEgKiB0aGlzLm1fckEueCAqIHRoaXMubV9yQS55IC0gaUIgKiB0aGlzLm1fckIueCAqIHRoaXMubV9yQi55O1xuICAgICAgICBLLmV5LnggPSBLLmV4Lnk7XG4gICAgICAgIEsuZXkueSA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9yQS54ICogdGhpcy5tX3JBLnggKyBpQiAqIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLng7XG4gICAgICAgIHRoaXMubV9saW5lYXJNYXNzID0gSy5nZXRJbnZlcnNlKCk7XG4gICAgICAgIHRoaXMubV9hbmd1bGFyTWFzcyA9IGlBICsgaUI7XG4gICAgICAgIGlmICh0aGlzLm1fYW5ndWxhck1hc3MgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJNYXNzID0gMSAvIHRoaXMubV9hbmd1bGFyTWFzcztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fbGluZWFyRXJyb3IgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5tX2xpbmVhckVycm9yLmFkZENvbWJpbmUoMSwgY0IyLCAxLCB0aGlzLm1fckIpO1xuICAgICAgICB0aGlzLm1fbGluZWFyRXJyb3Iuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHRoaXMubV9yQSk7XG4gICAgICAgIHRoaXMubV9hbmd1bGFyRXJyb3IgPSBhQiAtIGFBIC0gdGhpcy5tX2FuZ3VsYXJPZmZzZXQ7XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLm11bChzdGVwLmR0UmF0aW8pO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFySW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5uZW8odGhpcy5tX2xpbmVhckltcHVsc2UueCwgdGhpcy5tX2xpbmVhckltcHVsc2UueSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKSArIHRoaXMubV9hbmd1bGFySW1wdWxzZSk7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKSArIHRoaXMubV9hbmd1bGFySW1wdWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2Uuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFySW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciBoID0gc3RlcC5kdDtcbiAgICAgICAgdmFyIGludl9oID0gc3RlcC5pbnZfZHQ7XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IHdCIC0gd0EgKyBpbnZfaCAqIHRoaXMubV9jb3JyZWN0aW9uRmFjdG9yICogdGhpcy5tX2FuZ3VsYXJFcnJvcjtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fYW5ndWxhck1hc3MgKiBDZG90O1xuICAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX2FuZ3VsYXJJbXB1bHNlO1xuICAgICAgICAgIHZhciBtYXhJbXB1bHNlID0gaCAqIHRoaXMubV9tYXhUb3JxdWU7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlID0gY2xhbXAodGhpcy5tX2FuZ3VsYXJJbXB1bHNlICsgaW1wdWxzZSwgLW1heEltcHVsc2UsIG1heEltcHVsc2UpO1xuICAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fYW5ndWxhckltcHVsc2UgLSBvbGRJbXB1bHNlO1xuICAgICAgICAgIHdBIC09IGlBICogaW1wdWxzZTtcbiAgICAgICAgICB3QiArPSBpQiAqIGltcHVsc2U7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIHZhciBDZG90ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQ2RvdC5hZGRDb21iaW5lKDEsIHZCMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpO1xuICAgICAgICAgIENkb3Quc3ViQ29tYmluZSgxLCB2QTIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgICBDZG90LmFkZE11bChpbnZfaCAqIHRoaXMubV9jb3JyZWN0aW9uRmFjdG9yLCB0aGlzLm1fbGluZWFyRXJyb3IpO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gVmVjMi5uZWcoTWF0MjIubXVsVmVjMih0aGlzLm1fbGluZWFyTWFzcywgQ2RvdCkpO1xuICAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gVmVjMi5jbG9uZSh0aGlzLm1fbGluZWFySW1wdWxzZSk7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuYWRkKGltcHVsc2UpO1xuICAgICAgICAgIHZhciBtYXhJbXB1bHNlID0gaCAqIHRoaXMubV9tYXhGb3JjZTtcbiAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5jbGFtcChtYXhJbXB1bHNlKTtcbiAgICAgICAgICBpbXB1bHNlID0gVmVjMi5zdWIodGhpcy5tX2xpbmVhckltcHVsc2UsIG9sZEltcHVsc2UpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIGltcHVsc2UpO1xuICAgICAgICAgIHdBIC09IGlBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgaW1wdWxzZSk7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgaW1wdWxzZSk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBpbXB1bHNlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5UWVBFID0gXCJtb3Rvci1qb2ludFwiO1xuICAgICAgcmV0dXJuIE1vdG9ySm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBtYXRoX1BJJDIgPSBNYXRoLlBJO1xuICB2YXIgREVGQVVMVFMkNCA9IHtcbiAgICBtYXhGb3JjZTogMCxcbiAgICBmcmVxdWVuY3lIejogNSxcbiAgICBkYW1waW5nUmF0aW86IDAuN1xuICB9O1xuICB2YXIgTW91c2VKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoTW91c2VKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBNb3VzZUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgdGFyZ2V0KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgTW91c2VKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBNb3VzZUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgdGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkNCk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBNb3VzZUpvaW50Mi5UWVBFO1xuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKHRhcmdldCkpIHtcbiAgICAgICAgICBfdGhpcy5tX3RhcmdldEEgPSBWZWMyLmNsb25lKHRhcmdldCk7XG4gICAgICAgIH0gZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGRlZi50YXJnZXQpKSB7XG4gICAgICAgICAgX3RoaXMubV90YXJnZXRBID0gVmVjMi5jbG9uZShkZWYudGFyZ2V0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpcy5tX3RhcmdldEEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFRyYW5zZm9ybS5tdWxUVmVjMihib2R5Qi5nZXRUcmFuc2Zvcm0oKSwgX3RoaXMubV90YXJnZXRBKTtcbiAgICAgICAgX3RoaXMubV9tYXhGb3JjZSA9IGRlZi5tYXhGb3JjZTtcbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fZnJlcXVlbmN5SHogPSBkZWYuZnJlcXVlbmN5SHo7XG4gICAgICAgIF90aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgX3RoaXMubV9iZXRhID0gMDtcbiAgICAgICAgX3RoaXMubV9nYW1tYSA9IDA7XG4gICAgICAgIF90aGlzLm1fckIgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbENlbnRlckIgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9pbnZNYXNzQiA9IDA7XG4gICAgICAgIF90aGlzLm1faW52SUIgPSAwO1xuICAgICAgICBfdGhpcy5tX21hc3MgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgX3RoaXMubV9DID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIHRhcmdldDogdGhpcy5tX3RhcmdldEEsXG4gICAgICAgICAgbWF4Rm9yY2U6IHRoaXMubV9tYXhGb3JjZSxcbiAgICAgICAgICBmcmVxdWVuY3lIejogdGhpcy5tX2ZyZXF1ZW5jeUh6LFxuICAgICAgICAgIGRhbXBpbmdSYXRpbzogdGhpcy5tX2RhbXBpbmdSYXRpbyxcbiAgICAgICAgICBfbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIGRhdGEudGFyZ2V0ID0gVmVjMi5jbG9uZShkYXRhLnRhcmdldCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBNb3VzZUpvaW50MihkYXRhKTtcbiAgICAgICAgaWYgKGRhdGEuX2xvY2FsQW5jaG9yQikge1xuICAgICAgICAgIGpvaW50Lm1fbG9jYWxBbmNob3JCID0gZGF0YS5fbG9jYWxBbmNob3JCO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1heEZvcmNlKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGRlZi5tYXhGb3JjZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5mcmVxdWVuY3lIeikpIHtcbiAgICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBkZWYuZnJlcXVlbmN5SHo7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZGFtcGluZ1JhdGlvKSkge1xuICAgICAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLnNldFRhcmdldCA9IGZ1bmN0aW9uKHRhcmdldCkge1xuICAgICAgICBpZiAoVmVjMi5hcmVFcXVhbCh0YXJnZXQsIHRoaXMubV90YXJnZXRBKSlcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX3RhcmdldEEuc2V0KHRhcmdldCk7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLmdldFRhcmdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RhcmdldEE7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLnNldE1heEZvcmNlID0gZnVuY3Rpb24oZm9yY2UpIHtcbiAgICAgICAgdGhpcy5tX21heEZvcmNlID0gZm9yY2U7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLmdldE1heEZvcmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4Rm9yY2U7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLnNldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uKGh6KSB7XG4gICAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGh6O1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXRGcmVxdWVuY3kgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuc2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24ocmF0aW8pIHtcbiAgICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IHJhdGlvO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9kYW1waW5nUmF0aW87XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIuY2xvbmUodGhpcy5tX3RhcmdldEEpO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5tdWxOdW1WZWMyKGludl9kdCwgdGhpcy5tX2ltcHVsc2UpO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogMDtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuc2hpZnRPcmlnaW4gPSBmdW5jdGlvbihuZXdPcmlnaW4pIHtcbiAgICAgICAgdGhpcy5tX3RhcmdldEEuc3ViKG5ld09yaWdpbik7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBwb3NpdGlvbiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uO1xuICAgICAgICB2YXIgdmVsb2NpdHkgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eTtcbiAgICAgICAgdmFyIGNCMiA9IHBvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHBvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB2ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB2ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIG1hc3MgPSB0aGlzLm1fYm9keUIuZ2V0TWFzcygpO1xuICAgICAgICB2YXIgb21lZ2EgPSAyICogbWF0aF9QSSQyICogdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgICB2YXIgZDIgPSAyICogbWFzcyAqIHRoaXMubV9kYW1waW5nUmF0aW8gKiBvbWVnYTtcbiAgICAgICAgdmFyIGsgPSBtYXNzICogKG9tZWdhICogb21lZ2EpO1xuICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgIHRoaXMubV9nYW1tYSA9IGggKiAoZDIgKyBoICogayk7XG4gICAgICAgIGlmICh0aGlzLm1fZ2FtbWEgIT0gMCkge1xuICAgICAgICAgIHRoaXMubV9nYW1tYSA9IDEgLyB0aGlzLm1fZ2FtbWE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JldGEgPSBoICogayAqIHRoaXMubV9nYW1tYTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIEsgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgSy5leC54ID0gdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklCICogdGhpcy5tX3JCLnkgKiB0aGlzLm1fckIueSArIHRoaXMubV9nYW1tYTtcbiAgICAgICAgSy5leC55ID0gLXRoaXMubV9pbnZJQiAqIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLnk7XG4gICAgICAgIEsuZXkueCA9IEsuZXgueTtcbiAgICAgICAgSy5leS55ID0gdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklCICogdGhpcy5tX3JCLnggKiB0aGlzLm1fckIueCArIHRoaXMubV9nYW1tYTtcbiAgICAgICAgdGhpcy5tX21hc3MgPSBLLmdldEludmVyc2UoKTtcbiAgICAgICAgdGhpcy5tX0Muc2V0VmVjMihjQjIpO1xuICAgICAgICB0aGlzLm1fQy5hZGRDb21iaW5lKDEsIHRoaXMubV9yQiwgLTEsIHRoaXMubV90YXJnZXRBKTtcbiAgICAgICAgdGhpcy5tX0MubXVsKHRoaXMubV9iZXRhKTtcbiAgICAgICAgd0IgKj0gMC45ODtcbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UubXVsKHN0ZXAuZHRSYXRpbyk7XG4gICAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIHRoaXMubV9pbXB1bHNlKTtcbiAgICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCB0aGlzLm1faW1wdWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2Uuc2V0WmVybygpO1xuICAgICAgICB9XG4gICAgICAgIHZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB2ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZlbG9jaXR5ID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciB2QjIgPSBWZWMyLmNsb25lKHZlbG9jaXR5LnYpO1xuICAgICAgICB2YXIgd0IgPSB2ZWxvY2l0eS53O1xuICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpO1xuICAgICAgICBDZG90LmFkZCh2QjIpO1xuICAgICAgICBDZG90LmFkZENvbWJpbmUoMSwgdGhpcy5tX0MsIHRoaXMubV9nYW1tYSwgdGhpcy5tX2ltcHVsc2UpO1xuICAgICAgICBDZG90Lm5lZygpO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IE1hdDIyLm11bFZlYzIodGhpcy5tX21hc3MsIENkb3QpO1xuICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IFZlYzIuY2xvbmUodGhpcy5tX2ltcHVsc2UpO1xuICAgICAgICB0aGlzLm1faW1wdWxzZS5hZGQoaW1wdWxzZSk7XG4gICAgICAgIHZhciBtYXhJbXB1bHNlID0gc3RlcC5kdCAqIHRoaXMubV9tYXhGb3JjZTtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UuY2xhbXAobWF4SW1wdWxzZSk7XG4gICAgICAgIGltcHVsc2UgPSBWZWMyLnN1Yih0aGlzLm1faW1wdWxzZSwgb2xkSW1wdWxzZSk7XG4gICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBpbXB1bHNlKTtcbiAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgaW1wdWxzZSk7XG4gICAgICAgIHZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB2ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIuVFlQRSA9IFwibW91c2Utam9pbnRcIjtcbiAgICAgIHJldHVybiBNb3VzZUpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgbWF0aF9hYnMkMiA9IE1hdGguYWJzO1xuICB2YXIgREVGQVVMVFMkMyA9IHtcbiAgICBjb2xsaWRlQ29ubmVjdGVkOiB0cnVlXG4gIH07XG4gIHZhciBQdWxsZXlKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoUHVsbGV5Sm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gUHVsbGV5Sm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBncm91bmRBLCBncm91bmRCLCBhbmNob3JBLCBhbmNob3JCLCByYXRpbykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIFB1bGxleUpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFB1bGxleUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgZ3JvdW5kQSwgZ3JvdW5kQiwgYW5jaG9yQSwgYW5jaG9yQiwgcmF0aW8pO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQzKTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IFB1bGxleUpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2dyb3VuZEFuY2hvckEgPSBWZWMyLmNsb25lKGdyb3VuZEEgPyBncm91bmRBIDogZGVmLmdyb3VuZEFuY2hvckEgfHwgVmVjMi5uZW8oLTEsIDEpKTtcbiAgICAgICAgX3RoaXMubV9ncm91bmRBbmNob3JCID0gVmVjMi5jbG9uZShncm91bmRCID8gZ3JvdW5kQiA6IGRlZi5ncm91bmRBbmNob3JCIHx8IFZlYzIubmVvKDEsIDEpKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLmNsb25lKGFuY2hvckEgPyBib2R5QS5nZXRMb2NhbFBvaW50KGFuY2hvckEpIDogZGVmLmxvY2FsQW5jaG9yQSB8fCBWZWMyLm5lbygtMSwgMCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yQiA/IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yQikgOiBkZWYubG9jYWxBbmNob3JCIHx8IFZlYzIubmVvKDEsIDApKTtcbiAgICAgICAgX3RoaXMubV9sZW5ndGhBID0gTnVtYmVyLmlzRmluaXRlKGRlZi5sZW5ndGhBKSA/IGRlZi5sZW5ndGhBIDogVmVjMi5kaXN0YW5jZShhbmNob3JBLCBncm91bmRBKTtcbiAgICAgICAgX3RoaXMubV9sZW5ndGhCID0gTnVtYmVyLmlzRmluaXRlKGRlZi5sZW5ndGhCKSA/IGRlZi5sZW5ndGhCIDogVmVjMi5kaXN0YW5jZShhbmNob3JCLCBncm91bmRCKTtcbiAgICAgICAgX3RoaXMubV9yYXRpbyA9IE51bWJlci5pc0Zpbml0ZShyYXRpbykgPyByYXRpbyA6IGRlZi5yYXRpbztcbiAgICAgICAgX3RoaXMubV9jb25zdGFudCA9IF90aGlzLm1fbGVuZ3RoQSArIF90aGlzLm1fcmF0aW8gKiBfdGhpcy5tX2xlbmd0aEI7XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBncm91bmRBbmNob3JBOiB0aGlzLm1fZ3JvdW5kQW5jaG9yQSxcbiAgICAgICAgICBncm91bmRBbmNob3JCOiB0aGlzLm1fZ3JvdW5kQW5jaG9yQixcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCLFxuICAgICAgICAgIGxlbmd0aEE6IHRoaXMubV9sZW5ndGhBLFxuICAgICAgICAgIGxlbmd0aEI6IHRoaXMubV9sZW5ndGhCLFxuICAgICAgICAgIHJhdGlvOiB0aGlzLm1fcmF0aW9cbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBQdWxsZXlKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5ncm91bmRBbmNob3JBKSkge1xuICAgICAgICAgIHRoaXMubV9ncm91bmRBbmNob3JBLnNldChkZWYuZ3JvdW5kQW5jaG9yQSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChkZWYuZ3JvdW5kQW5jaG9yQikpIHtcbiAgICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yQi5zZXQoZGVmLmdyb3VuZEFuY2hvckIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChWZWMyLmlzVmFsaWQoZGVmLmxvY2FsQW5jaG9yQSkpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldChkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmLmFuY2hvckEpKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXQodGhpcy5tX2JvZHlBLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5sb2NhbEFuY2hvckIpKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXQoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH0gZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5hbmNob3JCKSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0KHRoaXMubV9ib2R5Qi5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JCKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubGVuZ3RoQSkpIHtcbiAgICAgICAgICB0aGlzLm1fbGVuZ3RoQSA9IGRlZi5sZW5ndGhBO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmxlbmd0aEIpKSB7XG4gICAgICAgICAgdGhpcy5tX2xlbmd0aEIgPSBkZWYubGVuZ3RoQjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5yYXRpbykpIHtcbiAgICAgICAgICB0aGlzLm1fcmF0aW8gPSBkZWYucmF0aW87XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldEdyb3VuZEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ncm91bmRBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0R3JvdW5kQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2dyb3VuZEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRMZW5ndGhBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbGVuZ3RoQTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldExlbmd0aEIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sZW5ndGhCO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0UmF0aW8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yYXRpbztcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldEN1cnJlbnRMZW5ndGhBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwID0gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICAgIHZhciBzMiA9IHRoaXMubV9ncm91bmRBbmNob3JBO1xuICAgICAgICByZXR1cm4gVmVjMi5kaXN0YW5jZShwLCBzMik7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRDdXJyZW50TGVuZ3RoQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcCA9IHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgICB2YXIgczIgPSB0aGlzLm1fZ3JvdW5kQW5jaG9yQjtcbiAgICAgICAgcmV0dXJuIFZlYzIuZGlzdGFuY2UocCwgczIpO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuc2hpZnRPcmlnaW4gPSBmdW5jdGlvbihuZXdPcmlnaW4pIHtcbiAgICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvckEuc3ViKG5ld09yaWdpbik7XG4gICAgICAgIHRoaXMubV9ncm91bmRBbmNob3JCLnN1YihuZXdPcmlnaW4pO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubXVsTnVtVmVjMih0aGlzLm1faW1wdWxzZSwgdGhpcy5tX3VCKS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB0aGlzLm1fckEgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB0aGlzLm1fckIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB0aGlzLm1fdUEgPSBWZWMyLnN1YihWZWMyLmFkZChjQTIsIHRoaXMubV9yQSksIHRoaXMubV9ncm91bmRBbmNob3JBKTtcbiAgICAgICAgdGhpcy5tX3VCID0gVmVjMi5zdWIoVmVjMi5hZGQoY0IyLCB0aGlzLm1fckIpLCB0aGlzLm1fZ3JvdW5kQW5jaG9yQik7XG4gICAgICAgIHZhciBsZW5ndGhBID0gdGhpcy5tX3VBLmxlbmd0aCgpO1xuICAgICAgICB2YXIgbGVuZ3RoQiA9IHRoaXMubV91Qi5sZW5ndGgoKTtcbiAgICAgICAgaWYgKGxlbmd0aEEgPiAxMCAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCkge1xuICAgICAgICAgIHRoaXMubV91QS5tdWwoMSAvIGxlbmd0aEEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV91QS5zZXRaZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxlbmd0aEIgPiAxMCAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCkge1xuICAgICAgICAgIHRoaXMubV91Qi5tdWwoMSAvIGxlbmd0aEIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV91Qi5zZXRaZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJ1QSA9IFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIHRoaXMubV91QSk7XG4gICAgICAgIHZhciBydUIgPSBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCB0aGlzLm1fdUIpO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0EgKyB0aGlzLm1faW52SUEgKiBydUEgKiBydUE7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQiAqIHJ1QiAqIHJ1QjtcbiAgICAgICAgdGhpcy5tX21hc3MgPSBtQSArIHRoaXMubV9yYXRpbyAqIHRoaXMubV9yYXRpbyAqIG1CO1xuICAgICAgICBpZiAodGhpcy5tX21hc3MgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSAxIC8gdGhpcy5tX21hc3M7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHZhciBQQSA9IFZlYzIubXVsTnVtVmVjMigtdGhpcy5tX2ltcHVsc2UsIHRoaXMubV91QSk7XG4gICAgICAgICAgdmFyIFBCID0gVmVjMi5tdWxOdW1WZWMyKC10aGlzLm1fcmF0aW8gKiB0aGlzLm1faW1wdWxzZSwgdGhpcy5tX3VCKTtcbiAgICAgICAgICB2QTIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQSwgUEEpO1xuICAgICAgICAgIHdBICs9IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFBBKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUEIpO1xuICAgICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFBCKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZwQSA9IFZlYzIuYWRkKHZBMiwgVmVjMi5jcm9zc051bVZlYzIod0EsIHRoaXMubV9yQSkpO1xuICAgICAgICB2YXIgdnBCID0gVmVjMi5hZGQodkIyLCBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKSk7XG4gICAgICAgIHZhciBDZG90ID0gLVZlYzIuZG90KHRoaXMubV91QSwgdnBBKSAtIHRoaXMubV9yYXRpbyAqIFZlYzIuZG90KHRoaXMubV91QiwgdnBCKTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21hc3MgKiBDZG90O1xuICAgICAgICB0aGlzLm1faW1wdWxzZSArPSBpbXB1bHNlO1xuICAgICAgICB2YXIgUEEgPSBWZWMyLm11bE51bVZlYzIoLWltcHVsc2UsIHRoaXMubV91QSk7XG4gICAgICAgIHZhciBQQiA9IFZlYzIubXVsTnVtVmVjMigtdGhpcy5tX3JhdGlvICogaW1wdWxzZSwgdGhpcy5tX3VCKTtcbiAgICAgICAgdkEyLmFkZE11bCh0aGlzLm1faW52TWFzc0EsIFBBKTtcbiAgICAgICAgd0EgKz0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUEEpO1xuICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUEIpO1xuICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQQik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHZhciByQjIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgdUEgPSBWZWMyLnN1YihWZWMyLmFkZChjQTIsIHRoaXMubV9yQSksIHRoaXMubV9ncm91bmRBbmNob3JBKTtcbiAgICAgICAgdmFyIHVCID0gVmVjMi5zdWIoVmVjMi5hZGQoY0IyLCB0aGlzLm1fckIpLCB0aGlzLm1fZ3JvdW5kQW5jaG9yQik7XG4gICAgICAgIHZhciBsZW5ndGhBID0gdUEubGVuZ3RoKCk7XG4gICAgICAgIHZhciBsZW5ndGhCID0gdUIubGVuZ3RoKCk7XG4gICAgICAgIGlmIChsZW5ndGhBID4gMTAgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3ApIHtcbiAgICAgICAgICB1QS5tdWwoMSAvIGxlbmd0aEEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHVBLnNldFplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGVuZ3RoQiA+IDEwICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKSB7XG4gICAgICAgICAgdUIubXVsKDEgLyBsZW5ndGhCKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB1Qi5zZXRaZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJ1QSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIHVBKTtcbiAgICAgICAgdmFyIHJ1QiA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHVCKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBICsgdGhpcy5tX2ludklBICogcnVBICogcnVBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUIgKiBydUIgKiBydUI7XG4gICAgICAgIHZhciBtYXNzID0gbUEgKyB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiBtQjtcbiAgICAgICAgaWYgKG1hc3MgPiAwKSB7XG4gICAgICAgICAgbWFzcyA9IDEgLyBtYXNzO1xuICAgICAgICB9XG4gICAgICAgIHZhciBDID0gdGhpcy5tX2NvbnN0YW50IC0gbGVuZ3RoQSAtIHRoaXMubV9yYXRpbyAqIGxlbmd0aEI7XG4gICAgICAgIHZhciBsaW5lYXJFcnJvciA9IG1hdGhfYWJzJDIoQyk7XG4gICAgICAgIHZhciBpbXB1bHNlID0gLW1hc3MgKiBDO1xuICAgICAgICB2YXIgUEEgPSBWZWMyLm11bE51bVZlYzIoLWltcHVsc2UsIHVBKTtcbiAgICAgICAgdmFyIFBCID0gVmVjMi5tdWxOdW1WZWMyKC10aGlzLm1fcmF0aW8gKiBpbXB1bHNlLCB1Qik7XG4gICAgICAgIGNBMi5hZGRNdWwodGhpcy5tX2ludk1hc3NBLCBQQSk7XG4gICAgICAgIGFBICs9IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIFBBKTtcbiAgICAgICAgY0IyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFBCKTtcbiAgICAgICAgYUIgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgUEIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jID0gY0EyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hID0gYUE7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmMgPSBjQjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmEgPSBhQjtcbiAgICAgICAgcmV0dXJuIGxpbmVhckVycm9yIDwgU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5UWVBFID0gXCJwdWxsZXktam9pbnRcIjtcbiAgICAgIHJldHVybiBQdWxsZXlKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIG1hdGhfbWluJDEgPSBNYXRoLm1pbjtcbiAgdmFyIExpbWl0U3RhdGU7XG4gIChmdW5jdGlvbihMaW1pdFN0YXRlMikge1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiaW5hY3RpdmVMaW1pdFwiXSA9IDBdID0gXCJpbmFjdGl2ZUxpbWl0XCI7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJhdExvd2VyTGltaXRcIl0gPSAxXSA9IFwiYXRMb3dlckxpbWl0XCI7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJhdFVwcGVyTGltaXRcIl0gPSAyXSA9IFwiYXRVcHBlckxpbWl0XCI7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJlcXVhbExpbWl0c1wiXSA9IDNdID0gXCJlcXVhbExpbWl0c1wiO1xuICB9KShMaW1pdFN0YXRlIHx8IChMaW1pdFN0YXRlID0ge30pKTtcbiAgdmFyIERFRkFVTFRTJDIgPSB7XG4gICAgbWF4TGVuZ3RoOiAwXG4gIH07XG4gIHZhciBSb3BlSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFJvcGVKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBSb3BlSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBSb3BlSm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgUm9wZUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkMik7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBSb3BlSm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5QS5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JBIHx8IFZlYzIubmVvKC0xLCAwKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5Qi5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JCIHx8IFZlYzIubmVvKDEsIDApKTtcbiAgICAgICAgX3RoaXMubV9tYXhMZW5ndGggPSBkZWYubWF4TGVuZ3RoO1xuICAgICAgICBfdGhpcy5tX21hc3MgPSAwO1xuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX2xlbmd0aCA9IDA7XG4gICAgICAgIF90aGlzLm1fc3RhdGUgPSBMaW1pdFN0YXRlLmluYWN0aXZlTGltaXQ7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgbG9jYWxBbmNob3JBOiB0aGlzLm1fbG9jYWxBbmNob3JBLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQixcbiAgICAgICAgICBtYXhMZW5ndGg6IHRoaXMubV9tYXhMZW5ndGhcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgUm9wZUpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhMZW5ndGgpKSB7XG4gICAgICAgICAgdGhpcy5tX21heExlbmd0aCA9IGRlZi5tYXhMZW5ndGg7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckE7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JCO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLnNldE1heExlbmd0aCA9IGZ1bmN0aW9uKGxlbmd0aCkge1xuICAgICAgICB0aGlzLm1fbWF4TGVuZ3RoID0gbGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldE1heExlbmd0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heExlbmd0aDtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5nZXRMaW1pdFN0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc3RhdGU7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5tdWxOdW1WZWMyKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fdSkubXVsKGludl9kdCk7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB0aGlzLm1fckEgPSBSb3QubXVsU3ViKHFBLCB0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFN1YihxQiwgdGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQik7XG4gICAgICAgIHRoaXMubV91ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMubV91LmFkZENvbWJpbmUoMSwgY0IyLCAxLCB0aGlzLm1fckIpO1xuICAgICAgICB0aGlzLm1fdS5zdWJDb21iaW5lKDEsIGNBMiwgMSwgdGhpcy5tX3JBKTtcbiAgICAgICAgdGhpcy5tX2xlbmd0aCA9IHRoaXMubV91Lmxlbmd0aCgpO1xuICAgICAgICB2YXIgQyA9IHRoaXMubV9sZW5ndGggLSB0aGlzLm1fbWF4TGVuZ3RoO1xuICAgICAgICBpZiAoQyA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fc3RhdGUgPSBMaW1pdFN0YXRlLmF0VXBwZXJMaW1pdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fc3RhdGUgPSBMaW1pdFN0YXRlLmluYWN0aXZlTGltaXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9sZW5ndGggPiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3ApIHtcbiAgICAgICAgICB0aGlzLm1fdS5tdWwoMSAvIHRoaXMubV9sZW5ndGgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV91LnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fbWFzcyA9IDA7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY3JBID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgdGhpcy5tX3UpO1xuICAgICAgICB2YXIgY3JCID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgdGhpcy5tX3UpO1xuICAgICAgICB2YXIgaW52TWFzcyA9IHRoaXMubV9pbnZNYXNzQSArIHRoaXMubV9pbnZJQSAqIGNyQSAqIGNyQSArIHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQiAqIGNyQiAqIGNyQjtcbiAgICAgICAgdGhpcy5tX21hc3MgPSBpbnZNYXNzICE9IDAgPyAxIC8gaW52TWFzcyA6IDA7XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIodGhpcy5tX2ltcHVsc2UsIHRoaXMubV91KTtcbiAgICAgICAgICB2QTIuc3ViTXVsKHRoaXMubV9pbnZNYXNzQSwgUDMpO1xuICAgICAgICAgIHdBIC09IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZwQSA9IFZlYzIuYWRkQ3Jvc3NOdW1WZWMyKHZBMiwgd0EsIHRoaXMubV9yQSk7XG4gICAgICAgIHZhciB2cEIgPSBWZWMyLmFkZENyb3NzTnVtVmVjMih2QjIsIHdCLCB0aGlzLm1fckIpO1xuICAgICAgICB2YXIgQyA9IHRoaXMubV9sZW5ndGggLSB0aGlzLm1fbWF4TGVuZ3RoO1xuICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuZG90KHRoaXMubV91LCBWZWMyLnN1Yih2cEIsIHZwQSkpO1xuICAgICAgICBpZiAoQyA8IDApIHtcbiAgICAgICAgICBDZG90ICs9IHN0ZXAuaW52X2R0ICogQztcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbWFzcyAqIENkb3Q7XG4gICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX2ltcHVsc2U7XG4gICAgICAgIHRoaXMubV9pbXB1bHNlID0gbWF0aF9taW4kMSgwLCB0aGlzLm1faW1wdWxzZSArIGltcHVsc2UpO1xuICAgICAgICBpbXB1bHNlID0gdGhpcy5tX2ltcHVsc2UgLSBvbGRJbXB1bHNlO1xuICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoaW1wdWxzZSwgdGhpcy5tX3UpO1xuICAgICAgICB2QTIuc3ViTXVsKHRoaXMubV9pbnZNYXNzQSwgUDMpO1xuICAgICAgICB3QSAtPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMyk7XG4gICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQMyk7XG4gICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxTdWIocUEsIHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFN1YihxQiwgdGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQik7XG4gICAgICAgIHZhciB1ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHUuYWRkQ29tYmluZSgxLCBjQjIsIDEsIHJCMik7XG4gICAgICAgIHUuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHJBMik7XG4gICAgICAgIHZhciBsZW5ndGggPSB1Lm5vcm1hbGl6ZSgpO1xuICAgICAgICB2YXIgQyA9IGxlbmd0aCAtIHRoaXMubV9tYXhMZW5ndGg7XG4gICAgICAgIEMgPSBjbGFtcChDLCAwLCBTZXR0aW5nc0ludGVybmFsLm1heExpbmVhckNvcnJlY3Rpb24pO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbWFzcyAqIEM7XG4gICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihpbXB1bHNlLCB1KTtcbiAgICAgICAgY0EyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgYUEgLT0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgUDMpO1xuICAgICAgICBjQjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICBhQiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBQMyk7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hID0gYUE7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBsZW5ndGggLSB0aGlzLm1fbWF4TGVuZ3RoIDwgU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIuVFlQRSA9IFwicm9wZS1qb2ludFwiO1xuICAgICAgcmV0dXJuIFJvcGVKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIG1hdGhfYWJzJDEgPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfUEkkMSA9IE1hdGguUEk7XG4gIHZhciBERUZBVUxUUyQxID0ge1xuICAgIGZyZXF1ZW5jeUh6OiAwLFxuICAgIGRhbXBpbmdSYXRpbzogMFxuICB9O1xuICB2YXIgV2VsZEpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhXZWxkSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gV2VsZEpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgV2VsZEpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFdlbGRKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvcik7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDEpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gV2VsZEpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQSB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5Qi5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JCIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9yZWZlcmVuY2VBbmdsZSA9IE51bWJlci5pc0Zpbml0ZShkZWYucmVmZXJlbmNlQW5nbGUpID8gZGVmLnJlZmVyZW5jZUFuZ2xlIDogYm9keUIuZ2V0QW5nbGUoKSAtIGJvZHlBLmdldEFuZ2xlKCk7XG4gICAgICAgIF90aGlzLm1fZnJlcXVlbmN5SHogPSBkZWYuZnJlcXVlbmN5SHo7XG4gICAgICAgIF90aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gbmV3IFZlYzMoKTtcbiAgICAgICAgX3RoaXMubV9iaWFzID0gMDtcbiAgICAgICAgX3RoaXMubV9nYW1tYSA9IDA7XG4gICAgICAgIF90aGlzLm1fbWFzcyA9IG5ldyBNYXQzMygpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGZyZXF1ZW5jeUh6OiB0aGlzLm1fZnJlcXVlbmN5SHosXG4gICAgICAgICAgZGFtcGluZ1JhdGlvOiB0aGlzLm1fZGFtcGluZ1JhdGlvLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckIsXG4gICAgICAgICAgcmVmZXJlbmNlQW5nbGU6IHRoaXMubV9yZWZlcmVuY2VBbmdsZVxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBXZWxkSm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMih0aGlzLm1fYm9keUEuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQSkpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5hbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKHRoaXMubV9ib2R5Qi5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JCKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMihkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5mcmVxdWVuY3lIeikpIHtcbiAgICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBkZWYuZnJlcXVlbmN5SHo7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZGFtcGluZ1JhdGlvKSkge1xuICAgICAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXRSZWZlcmVuY2VBbmdsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLnNldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uKGh6KSB7XG4gICAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGh6O1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLnNldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uKHJhdGlvKSB7XG4gICAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSByYXRpbztcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9kYW1waW5nUmF0aW87XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8odGhpcy5tX2ltcHVsc2UueCwgdGhpcy5tX2ltcHVsc2UueSkubXVsKGludl9kdCk7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLno7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgSyA9IG5ldyBNYXQzMygpO1xuICAgICAgICBLLmV4LnggPSBtQSArIG1CICsgdGhpcy5tX3JBLnkgKiB0aGlzLm1fckEueSAqIGlBICsgdGhpcy5tX3JCLnkgKiB0aGlzLm1fckIueSAqIGlCO1xuICAgICAgICBLLmV5LnggPSAtdGhpcy5tX3JBLnkgKiB0aGlzLm1fckEueCAqIGlBIC0gdGhpcy5tX3JCLnkgKiB0aGlzLm1fckIueCAqIGlCO1xuICAgICAgICBLLmV6LnggPSAtdGhpcy5tX3JBLnkgKiBpQSAtIHRoaXMubV9yQi55ICogaUI7XG4gICAgICAgIEsuZXgueSA9IEsuZXkueDtcbiAgICAgICAgSy5leS55ID0gbUEgKyBtQiArIHRoaXMubV9yQS54ICogdGhpcy5tX3JBLnggKiBpQSArIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLnggKiBpQjtcbiAgICAgICAgSy5lei55ID0gdGhpcy5tX3JBLnggKiBpQSArIHRoaXMubV9yQi54ICogaUI7XG4gICAgICAgIEsuZXgueiA9IEsuZXoueDtcbiAgICAgICAgSy5leS56ID0gSy5lei55O1xuICAgICAgICBLLmV6LnogPSBpQSArIGlCO1xuICAgICAgICBpZiAodGhpcy5tX2ZyZXF1ZW5jeUh6ID4gMCkge1xuICAgICAgICAgIEsuZ2V0SW52ZXJzZTIyKHRoaXMubV9tYXNzKTtcbiAgICAgICAgICB2YXIgaW52TSA9IGlBICsgaUI7XG4gICAgICAgICAgdmFyIG0gPSBpbnZNID4gMCA/IDEgLyBpbnZNIDogMDtcbiAgICAgICAgICB2YXIgQyA9IGFCIC0gYUEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICAgdmFyIG9tZWdhID0gMiAqIG1hdGhfUEkkMSAqIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgICAgICB2YXIgZDIgPSAyICogbSAqIHRoaXMubV9kYW1waW5nUmF0aW8gKiBvbWVnYTtcbiAgICAgICAgICB2YXIgayA9IG0gKiBvbWVnYSAqIG9tZWdhO1xuICAgICAgICAgIHZhciBoID0gc3RlcC5kdDtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSBoICogKGQyICsgaCAqIGspO1xuICAgICAgICAgIHRoaXMubV9nYW1tYSA9IHRoaXMubV9nYW1tYSAhPSAwID8gMSAvIHRoaXMubV9nYW1tYSA6IDA7XG4gICAgICAgICAgdGhpcy5tX2JpYXMgPSBDICogaCAqIGsgKiB0aGlzLm1fZ2FtbWE7XG4gICAgICAgICAgaW52TSArPSB0aGlzLm1fZ2FtbWE7XG4gICAgICAgICAgdGhpcy5tX21hc3MuZXoueiA9IGludk0gIT0gMCA/IDEgLyBpbnZNIDogMDtcbiAgICAgICAgfSBlbHNlIGlmIChLLmV6LnogPT0gMCkge1xuICAgICAgICAgIEsuZ2V0SW52ZXJzZTIyKHRoaXMubV9tYXNzKTtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICAgIHRoaXMubV9iaWFzID0gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBLLmdldFN5bUludmVyc2UzMyh0aGlzLm1fbWFzcyk7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gMDtcbiAgICAgICAgICB0aGlzLm1fYmlhcyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UubXVsKHN0ZXAuZHRSYXRpbyk7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5uZW8odGhpcy5tX2ltcHVsc2UueCwgdGhpcy5tX2ltcHVsc2UueSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKSArIHRoaXMubV9pbXB1bHNlLnopO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMykgKyB0aGlzLm1faW1wdWxzZS56KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5zZXRaZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgaWYgKHRoaXMubV9mcmVxdWVuY3lIeiA+IDApIHtcbiAgICAgICAgICB2YXIgQ2RvdDIgPSB3QiAtIHdBO1xuICAgICAgICAgIHZhciBpbXB1bHNlMiA9IC10aGlzLm1fbWFzcy5lei56ICogKENkb3QyICsgdGhpcy5tX2JpYXMgKyB0aGlzLm1fZ2FtbWEgKiB0aGlzLm1faW1wdWxzZS56KTtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ICs9IGltcHVsc2UyO1xuICAgICAgICAgIHdBIC09IGlBICogaW1wdWxzZTI7XG4gICAgICAgICAgd0IgKz0gaUIgKiBpbXB1bHNlMjtcbiAgICAgICAgICB2YXIgQ2RvdDEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBDZG90MS5hZGRDb21iaW5lKDEsIHZCMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpO1xuICAgICAgICAgIENkb3QxLnN1YkNvbWJpbmUoMSwgdkEyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QSwgdGhpcy5tX3JBKSk7XG4gICAgICAgICAgdmFyIGltcHVsc2UxID0gVmVjMi5uZWcoTWF0MzMubXVsVmVjMih0aGlzLm1fbWFzcywgQ2RvdDEpKTtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IGltcHVsc2UxLng7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSArPSBpbXB1bHNlMS55O1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIuY2xvbmUoaW1wdWxzZTEpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIENkb3QxID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQ2RvdDEuYWRkQ29tYmluZSgxLCB2QjIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpKTtcbiAgICAgICAgICBDZG90MS5zdWJDb21iaW5lKDEsIHZBMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0EsIHRoaXMubV9yQSkpO1xuICAgICAgICAgIHZhciBDZG90MiA9IHdCIC0gd0E7XG4gICAgICAgICAgdmFyIENkb3QgPSBuZXcgVmVjMyhDZG90MS54LCBDZG90MS55LCBDZG90Mik7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSBWZWMzLm5lZyhNYXQzMy5tdWxWZWMzKHRoaXMubV9tYXNzLCBDZG90KSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UuYWRkKGltcHVsc2UpO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVvKGltcHVsc2UueCwgaW1wdWxzZS55KTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpICsgaW1wdWxzZS56KTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpICsgaW1wdWxzZS56KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHFBID0gUm90Lm5lbyhhQSk7XG4gICAgICAgIHZhciBxQiA9IFJvdC5uZW8oYUIpO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIHBvc2l0aW9uRXJyb3I7XG4gICAgICAgIHZhciBhbmd1bGFyRXJyb3I7XG4gICAgICAgIHZhciBLID0gbmV3IE1hdDMzKCk7XG4gICAgICAgIEsuZXgueCA9IG1BICsgbUIgKyByQTIueSAqIHJBMi55ICogaUEgKyByQjIueSAqIHJCMi55ICogaUI7XG4gICAgICAgIEsuZXkueCA9IC1yQTIueSAqIHJBMi54ICogaUEgLSByQjIueSAqIHJCMi54ICogaUI7XG4gICAgICAgIEsuZXoueCA9IC1yQTIueSAqIGlBIC0gckIyLnkgKiBpQjtcbiAgICAgICAgSy5leC55ID0gSy5leS54O1xuICAgICAgICBLLmV5LnkgPSBtQSArIG1CICsgckEyLnggKiByQTIueCAqIGlBICsgckIyLnggKiByQjIueCAqIGlCO1xuICAgICAgICBLLmV6LnkgPSByQTIueCAqIGlBICsgckIyLnggKiBpQjtcbiAgICAgICAgSy5leC56ID0gSy5lei54O1xuICAgICAgICBLLmV5LnogPSBLLmV6Lnk7XG4gICAgICAgIEsuZXoueiA9IGlBICsgaUI7XG4gICAgICAgIGlmICh0aGlzLm1fZnJlcXVlbmN5SHogPiAwKSB7XG4gICAgICAgICAgdmFyIEMxID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQzEuYWRkQ29tYmluZSgxLCBjQjIsIDEsIHJCMik7XG4gICAgICAgICAgQzEuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHJBMik7XG4gICAgICAgICAgcG9zaXRpb25FcnJvciA9IEMxLmxlbmd0aCgpO1xuICAgICAgICAgIGFuZ3VsYXJFcnJvciA9IDA7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5uZWcoSy5zb2x2ZTIyKEMxKSk7XG4gICAgICAgICAgY0EyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIGFBIC09IGlBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgUDMpO1xuICAgICAgICAgIGNCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICBhQiArPSBpQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIFAzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgQzEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBDMS5hZGRDb21iaW5lKDEsIGNCMiwgMSwgckIyKTtcbiAgICAgICAgICBDMS5zdWJDb21iaW5lKDEsIGNBMiwgMSwgckEyKTtcbiAgICAgICAgICB2YXIgQzIgPSBhQiAtIGFBIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIHBvc2l0aW9uRXJyb3IgPSBDMS5sZW5ndGgoKTtcbiAgICAgICAgICBhbmd1bGFyRXJyb3IgPSBtYXRoX2FicyQxKEMyKTtcbiAgICAgICAgICB2YXIgQyA9IG5ldyBWZWMzKEMxLngsIEMxLnksIEMyKTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IG5ldyBWZWMzKCk7XG4gICAgICAgICAgaWYgKEsuZXoueiA+IDApIHtcbiAgICAgICAgICAgIGltcHVsc2UgPSBWZWMzLm5lZyhLLnNvbHZlMzMoQykpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgaW1wdWxzZTIgPSBWZWMyLm5lZyhLLnNvbHZlMjIoQzEpKTtcbiAgICAgICAgICAgIGltcHVsc2Uuc2V0KGltcHVsc2UyLngsIGltcHVsc2UyLnksIDApO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm5lbyhpbXB1bHNlLngsIGltcHVsc2UueSk7XG4gICAgICAgICAgY0EyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIGFBIC09IGlBICogKFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIFAzKSArIGltcHVsc2Uueik7XG4gICAgICAgICAgY0IyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIGFCICs9IGlCICogKFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIFAzKSArIGltcHVsc2Uueik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYyA9IGNBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jID0gY0IyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBwb3NpdGlvbkVycm9yIDw9IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCAmJiBhbmd1bGFyRXJyb3IgPD0gU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcDtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLlRZUEUgPSBcIndlbGQtam9pbnRcIjtcbiAgICAgIHJldHVybiBXZWxkSm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBtYXRoX2FicyA9IE1hdGguYWJzO1xuICB2YXIgbWF0aF9QSSA9IE1hdGguUEk7XG4gIHZhciBERUZBVUxUUyA9IHtcbiAgICBlbmFibGVNb3RvcjogZmFsc2UsXG4gICAgbWF4TW90b3JUb3JxdWU6IDAsXG4gICAgbW90b3JTcGVlZDogMCxcbiAgICBmcmVxdWVuY3lIejogMixcbiAgICBkYW1waW5nUmF0aW86IDAuN1xuICB9O1xuICB2YXIgV2hlZWxKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoV2hlZWxKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBXaGVlbEpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yLCBheGlzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgV2hlZWxKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBXaGVlbEpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yLCBheGlzKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV9heCA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX2F5ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IFdoZWVsSm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5QS5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JBIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckIgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGF4aXMpKSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbFhBeGlzQSA9IGJvZHlBLmdldExvY2FsVmVjdG9yKGF4aXMpO1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYubG9jYWxBeGlzQSkpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsWEF4aXNBID0gVmVjMi5jbG9uZShkZWYubG9jYWxBeGlzQSk7XG4gICAgICAgIH0gZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5sb2NhbEF4aXMpKSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbFhBeGlzQSA9IFZlYzIuY2xvbmUoZGVmLmxvY2FsQXhpcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbFhBeGlzQSA9IFZlYzIubmVvKDEsIDApO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLm1fbG9jYWxZQXhpc0EgPSBWZWMyLmNyb3NzTnVtVmVjMigxLCBfdGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgX3RoaXMubV9tYXNzID0gMDtcbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgX3RoaXMubV9tb3Rvck1hc3MgPSAwO1xuICAgICAgICBfdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fc3ByaW5nTWFzcyA9IDA7XG4gICAgICAgIF90aGlzLm1fc3ByaW5nSW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbWF4TW90b3JUb3JxdWUgPSBkZWYubWF4TW90b3JUb3JxdWU7XG4gICAgICAgIF90aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xuICAgICAgICBfdGhpcy5tX2VuYWJsZU1vdG9yID0gZGVmLmVuYWJsZU1vdG9yO1xuICAgICAgICBfdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICBfdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIF90aGlzLm1fYmlhcyA9IDA7XG4gICAgICAgIF90aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBlbmFibGVNb3RvcjogdGhpcy5tX2VuYWJsZU1vdG9yLFxuICAgICAgICAgIG1heE1vdG9yVG9ycXVlOiB0aGlzLm1fbWF4TW90b3JUb3JxdWUsXG4gICAgICAgICAgbW90b3JTcGVlZDogdGhpcy5tX21vdG9yU3BlZWQsXG4gICAgICAgICAgZnJlcXVlbmN5SHo6IHRoaXMubV9mcmVxdWVuY3lIeixcbiAgICAgICAgICBkYW1waW5nUmF0aW86IHRoaXMubV9kYW1waW5nUmF0aW8sXG4gICAgICAgICAgbG9jYWxBbmNob3JBOiB0aGlzLm1fbG9jYWxBbmNob3JBLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQixcbiAgICAgICAgICBsb2NhbEF4aXNBOiB0aGlzLm1fbG9jYWxYQXhpc0FcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IFdoZWVsSm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoZGVmLmFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIodGhpcy5tX2JvZHlBLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckEpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMih0aGlzLm1fYm9keUIuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQikpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5sb2NhbEF4aXNBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsWEF4aXNBLnNldFZlYzIoZGVmLmxvY2FsQXhpc0EpO1xuICAgICAgICAgIHRoaXMubV9sb2NhbFlBeGlzQS5zZXRWZWMyKFZlYzIuY3Jvc3NOdW1WZWMyKDEsIGRlZi5sb2NhbEF4aXNBKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5lbmFibGVNb3RvciAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZGVmLmVuYWJsZU1vdG9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1heE1vdG9yVG9ycXVlKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhNb3RvclRvcnF1ZSA9IGRlZi5tYXhNb3RvclRvcnF1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tb3RvclNwZWVkKSkge1xuICAgICAgICAgIHRoaXMubV9tb3RvclNwZWVkID0gZGVmLm1vdG9yU3BlZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZnJlcXVlbmN5SHopKSB7XG4gICAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmRhbXBpbmdSYXRpbykpIHtcbiAgICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckE7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBeGlzQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsWEF4aXNBO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludFRyYW5zbGF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgICB2YXIgcEEyID0gYkEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgICAgdmFyIHBCMiA9IGJCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuc3ViKHBCMiwgcEEyKTtcbiAgICAgICAgdmFyIGF4aXMgPSBiQS5nZXRXb3JsZFZlY3Rvcih0aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICB2YXIgdHJhbnNsYXRpb24yID0gVmVjMi5kb3QoZDIsIGF4aXMpO1xuICAgICAgICByZXR1cm4gdHJhbnNsYXRpb24yO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludFNwZWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICByZXR1cm4gd0IgLSB3QTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuaXNNb3RvckVuYWJsZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9lbmFibGVNb3RvcjtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZW5hYmxlTW90b3IgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnID09IHRoaXMubV9lbmFibGVNb3RvcilcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBmbGFnO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5zZXRNb3RvclNwZWVkID0gZnVuY3Rpb24oc3BlZWQpIHtcbiAgICAgICAgaWYgKHNwZWVkID09IHRoaXMubV9tb3RvclNwZWVkKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9tb3RvclNwZWVkID0gc3BlZWQ7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldE1vdG9yU3BlZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tb3RvclNwZWVkO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhNb3RvclRvcnF1ZSA9IGZ1bmN0aW9uKHRvcnF1ZSkge1xuICAgICAgICBpZiAodG9ycXVlID09IHRoaXMubV9tYXhNb3RvclRvcnF1ZSlcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fbWF4TW90b3JUb3JxdWUgPSB0b3JxdWU7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldE1heE1vdG9yVG9ycXVlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4TW90b3JUb3JxdWU7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldE1vdG9yVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5zZXRTcHJpbmdGcmVxdWVuY3lIeiA9IGZ1bmN0aW9uKGh6KSB7XG4gICAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGh6O1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRTcHJpbmdGcmVxdWVuY3lIeiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5zZXRTcHJpbmdEYW1waW5nUmF0aW8gPSBmdW5jdGlvbihyYXRpbykge1xuICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gcmF0aW87XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldFNwcmluZ0RhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2RhbXBpbmdSYXRpbztcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLmNvbWJpbmUodGhpcy5tX2ltcHVsc2UsIHRoaXMubV9heSwgdGhpcy5tX3NwcmluZ0ltcHVsc2UsIHRoaXMubV9heCkubXVsKGludl9kdCk7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHZhciByQjIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgZDIuYWRkQ29tYmluZSgxLCBjQjIsIDEsIHJCMik7XG4gICAgICAgIGQyLnN1YkNvbWJpbmUoMSwgY0EyLCAxLCByQTIpO1xuICAgICAgICB7XG4gICAgICAgICAgdGhpcy5tX2F5ID0gUm90Lm11bFZlYzIocUEsIHRoaXMubV9sb2NhbFlBeGlzQSk7XG4gICAgICAgICAgdGhpcy5tX3NBeSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihWZWMyLmFkZChkMiwgckEyKSwgdGhpcy5tX2F5KTtcbiAgICAgICAgICB0aGlzLm1fc0J5ID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgdGhpcy5tX2F5KTtcbiAgICAgICAgICB0aGlzLm1fbWFzcyA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9zQXkgKiB0aGlzLm1fc0F5ICsgaUIgKiB0aGlzLm1fc0J5ICogdGhpcy5tX3NCeTtcbiAgICAgICAgICBpZiAodGhpcy5tX21hc3MgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLm1fbWFzcyA9IDEgLyB0aGlzLm1fbWFzcztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3NwcmluZ01hc3MgPSAwO1xuICAgICAgICB0aGlzLm1fYmlhcyA9IDA7XG4gICAgICAgIHRoaXMubV9nYW1tYSA9IDA7XG4gICAgICAgIGlmICh0aGlzLm1fZnJlcXVlbmN5SHogPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX2F4ID0gUm90Lm11bFZlYzIocUEsIHRoaXMubV9sb2NhbFhBeGlzQSk7XG4gICAgICAgICAgdGhpcy5tX3NBeCA9IFZlYzIuY3Jvc3NWZWMyVmVjMihWZWMyLmFkZChkMiwgckEyKSwgdGhpcy5tX2F4KTtcbiAgICAgICAgICB0aGlzLm1fc0J4ID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgdGhpcy5tX2F4KTtcbiAgICAgICAgICB2YXIgaW52TWFzcyA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9zQXggKiB0aGlzLm1fc0F4ICsgaUIgKiB0aGlzLm1fc0J4ICogdGhpcy5tX3NCeDtcbiAgICAgICAgICBpZiAoaW52TWFzcyA+IDApIHtcbiAgICAgICAgICAgIHRoaXMubV9zcHJpbmdNYXNzID0gMSAvIGludk1hc3M7XG4gICAgICAgICAgICB2YXIgQyA9IFZlYzIuZG90KGQyLCB0aGlzLm1fYXgpO1xuICAgICAgICAgICAgdmFyIG9tZWdhID0gMiAqIG1hdGhfUEkgKiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICAgICAgICB2YXIgZGFtcCA9IDIgKiB0aGlzLm1fc3ByaW5nTWFzcyAqIHRoaXMubV9kYW1waW5nUmF0aW8gKiBvbWVnYTtcbiAgICAgICAgICAgIHZhciBrID0gdGhpcy5tX3NwcmluZ01hc3MgKiBvbWVnYSAqIG9tZWdhO1xuICAgICAgICAgICAgdmFyIGggPSBzdGVwLmR0O1xuICAgICAgICAgICAgdGhpcy5tX2dhbW1hID0gaCAqIChkYW1wICsgaCAqIGspO1xuICAgICAgICAgICAgaWYgKHRoaXMubV9nYW1tYSA+IDApIHtcbiAgICAgICAgICAgICAgdGhpcy5tX2dhbW1hID0gMSAvIHRoaXMubV9nYW1tYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubV9iaWFzID0gQyAqIGggKiBrICogdGhpcy5tX2dhbW1hO1xuICAgICAgICAgICAgdGhpcy5tX3NwcmluZ01hc3MgPSBpbnZNYXNzICsgdGhpcy5tX2dhbW1hO1xuICAgICAgICAgICAgaWYgKHRoaXMubV9zcHJpbmdNYXNzID4gMCkge1xuICAgICAgICAgICAgICB0aGlzLm1fc3ByaW5nTWFzcyA9IDEgLyB0aGlzLm1fc3ByaW5nTWFzcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3NwcmluZ0ltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IpIHtcbiAgICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gaUEgKyBpQjtcbiAgICAgICAgICBpZiAodGhpcy5tX21vdG9yTWFzcyA+IDApIHtcbiAgICAgICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSAxIC8gdGhpcy5tX21vdG9yTWFzcztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IDA7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHRoaXMubV9zcHJpbmdJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLmNvbWJpbmUodGhpcy5tX2ltcHVsc2UsIHRoaXMubV9heSwgdGhpcy5tX3NwcmluZ0ltcHVsc2UsIHRoaXMubV9heCk7XG4gICAgICAgICAgdmFyIExBID0gdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fc0F5ICsgdGhpcy5tX3NwcmluZ0ltcHVsc2UgKiB0aGlzLm1fc0F4ICsgdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgICAgICB2YXIgTEIgPSB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9zQnkgKyB0aGlzLm1fc3ByaW5nSW1wdWxzZSAqIHRoaXMubV9zQnggKyB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgICAgIHZBMi5zdWJNdWwodGhpcy5tX2ludk1hc3NBLCBQMyk7XG4gICAgICAgICAgd0EgLT0gdGhpcy5tX2ludklBICogTEE7XG4gICAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFAzKTtcbiAgICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBMQjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgICAgdGhpcy5tX3NwcmluZ0ltcHVsc2UgPSAwO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuZG90KHRoaXMubV9heCwgdkIyKSAtIFZlYzIuZG90KHRoaXMubV9heCwgdkEyKSArIHRoaXMubV9zQnggKiB3QiAtIHRoaXMubV9zQXggKiB3QTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fc3ByaW5nTWFzcyAqIChDZG90ICsgdGhpcy5tX2JpYXMgKyB0aGlzLm1fZ2FtbWEgKiB0aGlzLm1fc3ByaW5nSW1wdWxzZSk7XG4gICAgICAgICAgdGhpcy5tX3NwcmluZ0ltcHVsc2UgKz0gaW1wdWxzZTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoaW1wdWxzZSwgdGhpcy5tX2F4KTtcbiAgICAgICAgICB2YXIgTEEgPSBpbXB1bHNlICogdGhpcy5tX3NBeDtcbiAgICAgICAgICB2YXIgTEIgPSBpbXB1bHNlICogdGhpcy5tX3NCeDtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBMQTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBMQjtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgdmFyIENkb3QgPSB3QiAtIHdBIC0gdGhpcy5tX21vdG9yU3BlZWQ7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21vdG9yTWFzcyAqIENkb3Q7XG4gICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgICAgIHZhciBtYXhJbXB1bHNlID0gc3RlcC5kdCAqIHRoaXMubV9tYXhNb3RvclRvcnF1ZTtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gY2xhbXAodGhpcy5tX21vdG9ySW1wdWxzZSArIGltcHVsc2UsIC1tYXhJbXB1bHNlLCBtYXhJbXB1bHNlKTtcbiAgICAgICAgICBpbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZSAtIG9sZEltcHVsc2U7XG4gICAgICAgICAgd0EgLT0gaUEgKiBpbXB1bHNlO1xuICAgICAgICAgIHdCICs9IGlCICogaW1wdWxzZTtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgdmFyIENkb3QgPSBWZWMyLmRvdCh0aGlzLm1fYXksIHZCMikgLSBWZWMyLmRvdCh0aGlzLm1fYXksIHZBMikgKyB0aGlzLm1fc0J5ICogd0IgLSB0aGlzLm1fc0F5ICogd0E7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21hc3MgKiBDZG90O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlICs9IGltcHVsc2U7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIHRoaXMubV9heSk7XG4gICAgICAgICAgdmFyIExBID0gaW1wdWxzZSAqIHRoaXMubV9zQXk7XG4gICAgICAgICAgdmFyIExCID0gaW1wdWxzZSAqIHRoaXMubV9zQnk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogTEE7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogTEI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHZhciByQjIgPSBSb3QubXVsVmVjMihxQiwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQikpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgZDIuYWRkQ29tYmluZSgxLCBjQjIsIDEsIHJCMik7XG4gICAgICAgIGQyLnN1YkNvbWJpbmUoMSwgY0EyLCAxLCByQTIpO1xuICAgICAgICB2YXIgYXkgPSBSb3QubXVsVmVjMihxQSwgdGhpcy5tX2xvY2FsWUF4aXNBKTtcbiAgICAgICAgdmFyIHNBeSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihWZWMyLmFkZChkMiwgckEyKSwgYXkpO1xuICAgICAgICB2YXIgc0J5ID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgYXkpO1xuICAgICAgICB2YXIgQyA9IFZlYzIuZG90KGQyLCBheSk7XG4gICAgICAgIHZhciBrID0gdGhpcy5tX2ludk1hc3NBICsgdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklBICogdGhpcy5tX3NBeSAqIHRoaXMubV9zQXkgKyB0aGlzLm1faW52SUIgKiB0aGlzLm1fc0J5ICogdGhpcy5tX3NCeTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSBrICE9IDAgPyAtQyAvIGsgOiAwO1xuICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoaW1wdWxzZSwgYXkpO1xuICAgICAgICB2YXIgTEEgPSBpbXB1bHNlICogc0F5O1xuICAgICAgICB2YXIgTEIgPSBpbXB1bHNlICogc0J5O1xuICAgICAgICBjQTIuc3ViTXVsKHRoaXMubV9pbnZNYXNzQSwgUDMpO1xuICAgICAgICBhQSAtPSB0aGlzLm1faW52SUEgKiBMQTtcbiAgICAgICAgY0IyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFAzKTtcbiAgICAgICAgYUIgKz0gdGhpcy5tX2ludklCICogTEI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hID0gYUE7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBtYXRoX2FicyhDKSA8PSBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIuVFlQRSA9IFwid2hlZWwtam9pbnRcIjtcbiAgICAgIHJldHVybiBXaGVlbEpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgX2E7XG4gIHZhciBTSUQgPSAwO1xuICB2YXIgU0VSSUFMSVpFX1JFRl9UWVBFUyA9IHtcbiAgICBcIldvcmxkXCI6IFdvcmxkLFxuICAgIFwiQm9keVwiOiBCb2R5LFxuICAgIFwiSm9pbnRcIjogSm9pbnQsXG4gICAgXCJGaXh0dXJlXCI6IEZpeHR1cmUsXG4gICAgXCJTaGFwZVwiOiBTaGFwZVxuICB9O1xuICB2YXIgREVTRVJJQUxJWkVfQllfUkVGX1RZUEUgPSB7XG4gICAgXCJWZWMyXCI6IFZlYzIsXG4gICAgXCJWZWMzXCI6IFZlYzMsXG4gICAgXCJXb3JsZFwiOiBXb3JsZCxcbiAgICBcIkJvZHlcIjogQm9keSxcbiAgICBcIkpvaW50XCI6IEpvaW50LFxuICAgIFwiRml4dHVyZVwiOiBGaXh0dXJlLFxuICAgIFwiU2hhcGVcIjogU2hhcGVcbiAgfTtcbiAgdmFyIERFU0VSSUFMSVpFX0JZX1RZUEVfRklFTEQgPSAoX2EgPSB7fSwgX2FbQm9keS5TVEFUSUNdID0gQm9keSwgX2FbQm9keS5EWU5BTUlDXSA9IEJvZHksIF9hW0JvZHkuS0lORU1BVElDXSA9IEJvZHksIF9hW0NoYWluU2hhcGUuVFlQRV0gPSBDaGFpblNoYXBlLCAvLyBbQm94U2hhcGUuVFlQRV06IEJveFNoYXBlLFxuICBfYVtQb2x5Z29uU2hhcGUuVFlQRV0gPSBQb2x5Z29uU2hhcGUsIF9hW0VkZ2VTaGFwZS5UWVBFXSA9IEVkZ2VTaGFwZSwgX2FbQ2lyY2xlU2hhcGUuVFlQRV0gPSBDaXJjbGVTaGFwZSwgX2FbRGlzdGFuY2VKb2ludC5UWVBFXSA9IERpc3RhbmNlSm9pbnQsIF9hW0ZyaWN0aW9uSm9pbnQuVFlQRV0gPSBGcmljdGlvbkpvaW50LCBfYVtHZWFySm9pbnQuVFlQRV0gPSBHZWFySm9pbnQsIF9hW01vdG9ySm9pbnQuVFlQRV0gPSBNb3RvckpvaW50LCBfYVtNb3VzZUpvaW50LlRZUEVdID0gTW91c2VKb2ludCwgX2FbUHJpc21hdGljSm9pbnQuVFlQRV0gPSBQcmlzbWF0aWNKb2ludCwgX2FbUHVsbGV5Sm9pbnQuVFlQRV0gPSBQdWxsZXlKb2ludCwgX2FbUmV2b2x1dGVKb2ludC5UWVBFXSA9IFJldm9sdXRlSm9pbnQsIF9hW1JvcGVKb2ludC5UWVBFXSA9IFJvcGVKb2ludCwgX2FbV2VsZEpvaW50LlRZUEVdID0gV2VsZEpvaW50LCBfYVtXaGVlbEpvaW50LlRZUEVdID0gV2hlZWxKb2ludCwgX2EpO1xuICB2YXIgREVGQVVMVF9PUFRJT05TID0ge1xuICAgIHJvb3RDbGFzczogV29ybGQsXG4gICAgcHJlU2VyaWFsaXplOiBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfSxcbiAgICBwb3N0U2VyaWFsaXplOiBmdW5jdGlvbihkYXRhLCBvYmopIHtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH0sXG4gICAgcHJlRGVzZXJpYWxpemU6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH0sXG4gICAgcG9zdERlc2VyaWFsaXplOiBmdW5jdGlvbihvYmosIGRhdGEpIHtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuICB9O1xuICB2YXIgU2VyaWFsaXplciA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2VyaWFsaXplcjIob3B0aW9uczIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy50b0pzb24gPSBmdW5jdGlvbihyb290KSB7XG4gICAgICAgICAgdmFyIHByZVNlcmlhbGl6ZSA9IF90aGlzLm9wdGlvbnMucHJlU2VyaWFsaXplO1xuICAgICAgICAgIHZhciBwb3N0U2VyaWFsaXplID0gX3RoaXMub3B0aW9ucy5wb3N0U2VyaWFsaXplO1xuICAgICAgICAgIHZhciBqc29uID0gW107XG4gICAgICAgICAgdmFyIHJlZlF1ZXVlID0gW3Jvb3RdO1xuICAgICAgICAgIHZhciByZWZNZW1vQnlJZCA9IHt9O1xuICAgICAgICAgIGZ1bmN0aW9uIGFkZFRvUmVmUXVldWUodmFsdWUsIHR5cGVOYW1lKSB7XG4gICAgICAgICAgICB2YWx1ZS5fX3NpZCA9IHZhbHVlLl9fc2lkIHx8ICsrU0lEO1xuICAgICAgICAgICAgaWYgKCFyZWZNZW1vQnlJZFt2YWx1ZS5fX3NpZF0pIHtcbiAgICAgICAgICAgICAgcmVmUXVldWUucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAgIHZhciBpbmRleCA9IGpzb24ubGVuZ3RoICsgcmVmUXVldWUubGVuZ3RoO1xuICAgICAgICAgICAgICB2YXIgcmVmID0ge1xuICAgICAgICAgICAgICAgIHJlZkluZGV4OiBpbmRleCxcbiAgICAgICAgICAgICAgICByZWZUeXBlOiB0eXBlTmFtZVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICByZWZNZW1vQnlJZFt2YWx1ZS5fX3NpZF0gPSByZWY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVmTWVtb0J5SWRbdmFsdWUuX19zaWRdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmdW5jdGlvbiBzZXJpYWxpemVXaXRoSG9va3Mob2JqMikge1xuICAgICAgICAgICAgb2JqMiA9IHByZVNlcmlhbGl6ZShvYmoyKTtcbiAgICAgICAgICAgIHZhciBkYXRhID0gb2JqMi5fc2VyaWFsaXplKCk7XG4gICAgICAgICAgICBkYXRhID0gcG9zdFNlcmlhbGl6ZShkYXRhLCBvYmoyKTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmdW5jdGlvbiB0cmF2ZXJzZSh2YWx1ZSwgbm9SZWZUeXBlKSB7XG4gICAgICAgICAgICBpZiAobm9SZWZUeXBlID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgbm9SZWZUeXBlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSBcIm9iamVjdFwiIHx8IHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUuX3NlcmlhbGl6ZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgIGlmICghbm9SZWZUeXBlKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgdHlwZU5hbWUgaW4gU0VSSUFMSVpFX1JFRl9UWVBFUykge1xuICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgU0VSSUFMSVpFX1JFRl9UWVBFU1t0eXBlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFkZFRvUmVmUXVldWUodmFsdWUsIHR5cGVOYW1lKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFsdWUgPSBzZXJpYWxpemVXaXRoSG9va3ModmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IFtdO1xuICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgPSAwOyBrZXkgPCB2YWx1ZS5sZW5ndGg7IGtleSsrKSB7XG4gICAgICAgICAgICAgICAgbmV3VmFsdWVba2V5XSA9IHRyYXZlcnNlKHZhbHVlW2tleV0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSB7fTtcbiAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlW2tleV0gPSB0cmF2ZXJzZSh2YWx1ZVtrZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgd2hpbGUgKHJlZlF1ZXVlLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIG9iaiA9IHJlZlF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICB2YXIgc3RyID0gdHJhdmVyc2Uob2JqLCB0cnVlKTtcbiAgICAgICAgICAgIGpzb24ucHVzaChzdHIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4ganNvbjtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5mcm9tSnNvbiA9IGZ1bmN0aW9uKGpzb24pIHtcbiAgICAgICAgICB2YXIgcHJlRGVzZXJpYWxpemUgPSBfdGhpcy5vcHRpb25zLnByZURlc2VyaWFsaXplO1xuICAgICAgICAgIHZhciBwb3N0RGVzZXJpYWxpemUgPSBfdGhpcy5vcHRpb25zLnBvc3REZXNlcmlhbGl6ZTtcbiAgICAgICAgICB2YXIgcm9vdENsYXNzID0gX3RoaXMub3B0aW9ucy5yb290Q2xhc3M7XG4gICAgICAgICAgdmFyIGRlc2VyaWFsaXplZFJlZk1lbW9CeUluZGV4ID0ge307XG4gICAgICAgICAgZnVuY3Rpb24gZGVzZXJpYWxpemVXaXRoSG9va3MoY2xhc3NIaW50LCBkYXRhLCBjb250ZXh0KSB7XG4gICAgICAgICAgICBpZiAoIWNsYXNzSGludCB8fCAhY2xhc3NIaW50Ll9kZXNlcmlhbGl6ZSkge1xuICAgICAgICAgICAgICBjbGFzc0hpbnQgPSBERVNFUklBTElaRV9CWV9UWVBFX0ZJRUxEW2RhdGEudHlwZV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVzZXJpYWxpemVyID0gY2xhc3NIaW50ICYmIGNsYXNzSGludC5fZGVzZXJpYWxpemU7XG4gICAgICAgICAgICBpZiAoIWRlc2VyaWFsaXplcikge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhID0gcHJlRGVzZXJpYWxpemUoZGF0YSk7XG4gICAgICAgICAgICB2YXIgY2xhc3NEZXNlcmlhbGl6ZUZuID0gY2xhc3NIaW50Ll9kZXNlcmlhbGl6ZTtcbiAgICAgICAgICAgIHZhciBvYmogPSBjbGFzc0Rlc2VyaWFsaXplRm4oZGF0YSwgY29udGV4dCwgZGVzZXJpYWxpemVDaGlsZCk7XG4gICAgICAgICAgICBvYmogPSBwb3N0RGVzZXJpYWxpemUob2JqLCBkYXRhKTtcbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZ1bmN0aW9uIGRlc2VyaWFsaXplQ2hpbGQoY2xhc3NIaW50LCBkYXRhT3JSZWYsIGNvbnRleHQpIHtcbiAgICAgICAgICAgIHZhciBpc1JlZk9iamVjdCA9IGRhdGFPclJlZi5yZWZJbmRleCAmJiBkYXRhT3JSZWYucmVmVHlwZTtcbiAgICAgICAgICAgIGlmICghaXNSZWZPYmplY3QpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGRlc2VyaWFsaXplV2l0aEhvb2tzKGNsYXNzSGludCwgZGF0YU9yUmVmLCBjb250ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZWYgPSBkYXRhT3JSZWY7XG4gICAgICAgICAgICBpZiAoREVTRVJJQUxJWkVfQllfUkVGX1RZUEVbcmVmLnJlZlR5cGVdKSB7XG4gICAgICAgICAgICAgIGNsYXNzSGludCA9IERFU0VSSUFMSVpFX0JZX1JFRl9UWVBFW3JlZi5yZWZUeXBlXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZWZJbmRleCA9IHJlZi5yZWZJbmRleDtcbiAgICAgICAgICAgIGlmICghZGVzZXJpYWxpemVkUmVmTWVtb0J5SW5kZXhbcmVmSW5kZXhdKSB7XG4gICAgICAgICAgICAgIHZhciBkYXRhID0ganNvbltyZWZJbmRleF07XG4gICAgICAgICAgICAgIHZhciBvYmogPSBkZXNlcmlhbGl6ZVdpdGhIb29rcyhjbGFzc0hpbnQsIGRhdGEsIGNvbnRleHQpO1xuICAgICAgICAgICAgICBkZXNlcmlhbGl6ZWRSZWZNZW1vQnlJbmRleFtyZWZJbmRleF0gPSBvYmo7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZGVzZXJpYWxpemVkUmVmTWVtb0J5SW5kZXhbcmVmSW5kZXhdO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcm9vdCA9IGRlc2VyaWFsaXplV2l0aEhvb2tzKHJvb3RDbGFzcywganNvblswXSwgbnVsbCk7XG4gICAgICAgICAgcmV0dXJuIHJvb3Q7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBERUZBVUxUX09QVElPTlMpLCBvcHRpb25zMik7XG4gICAgICB9XG4gICAgICByZXR1cm4gU2VyaWFsaXplcjI7XG4gICAgfSgpXG4gICk7XG4gIHZhciB3b3JsZFNlcmlhbGl6ZXIgPSBuZXcgU2VyaWFsaXplcih7XG4gICAgcm9vdENsYXNzOiBXb3JsZFxuICB9KTtcbiAgU2VyaWFsaXplci5mcm9tSnNvbiA9IHdvcmxkU2VyaWFsaXplci5mcm9tSnNvbjtcbiAgU2VyaWFsaXplci50b0pzb24gPSB3b3JsZFNlcmlhbGl6ZXIudG9Kc29uO1xuICB2YXIgVGVzdGJlZCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBUZXN0YmVkMigpIHtcbiAgICAgIH1cbiAgICAgIFRlc3RiZWQyLm1vdW50ID0gZnVuY3Rpb24ob3B0aW9uczIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudGVkXCIpO1xuICAgICAgfTtcbiAgICAgIFRlc3RiZWQyLnN0YXJ0ID0gZnVuY3Rpb24od29ybGQpIHtcbiAgICAgICAgdmFyIHRlc3RiZWQyID0gVGVzdGJlZDIubW91bnQoKTtcbiAgICAgICAgdGVzdGJlZDIuc3RhcnQod29ybGQpO1xuICAgICAgICByZXR1cm4gdGVzdGJlZDI7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFRlc3RiZWQyO1xuICAgIH0oKVxuICApO1xuICBmdW5jdGlvbiB0ZXN0YmVkKGEyLCBiMikge1xuICAgIHZhciBjYWxsYmFjaztcbiAgICB2YXIgb3B0aW9uczI7XG4gICAgaWYgKHR5cGVvZiBhMiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBjYWxsYmFjayA9IGEyO1xuICAgICAgb3B0aW9uczIgPSBiMjtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBiMiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBjYWxsYmFjayA9IGIyO1xuICAgICAgb3B0aW9uczIgPSBhMjtcbiAgICB9IGVsc2Uge1xuICAgICAgb3B0aW9uczIgPSBhMiAhPT0gbnVsbCAmJiBhMiAhPT0gdm9pZCAwID8gYTIgOiBiMjtcbiAgICB9XG4gICAgdmFyIHRlc3RiZWQyID0gVGVzdGJlZC5tb3VudChvcHRpb25zMik7XG4gICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICB2YXIgd29ybGQgPSBjYWxsYmFjayh0ZXN0YmVkMikgfHwgdGVzdGJlZDIud29ybGQ7XG4gICAgICB0ZXN0YmVkMi5zdGFydCh3b3JsZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0ZXN0YmVkMjtcbiAgICB9XG4gIH1cbiAgdmFyIEJveFNoYXBlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhCb3hTaGFwZTIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBCb3hTaGFwZTIoaGFsZldpZHRoLCBoYWxmSGVpZ2h0LCBjZW50ZXIyLCBhbmdsZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIEJveFNoYXBlMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEJveFNoYXBlMihoYWxmV2lkdGgsIGhhbGZIZWlnaHQsIGNlbnRlcjIsIGFuZ2xlKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9zZXRBc0JveChoYWxmV2lkdGgsIGhhbGZIZWlnaHQsIGNlbnRlcjIsIGFuZ2xlKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgQm94U2hhcGUyLlRZUEUgPSBcInBvbHlnb25cIjtcbiAgICAgIHJldHVybiBCb3hTaGFwZTI7XG4gICAgfShQb2x5Z29uU2hhcGUpXG4gICk7XG4gIENvbnRhY3QuYWRkVHlwZShDaXJjbGVTaGFwZS5UWVBFLCBDaXJjbGVTaGFwZS5UWVBFLCBDaXJjbGVDaXJjbGVDb250YWN0KTtcbiAgZnVuY3Rpb24gQ2lyY2xlQ2lyY2xlQ29udGFjdChtYW5pZm9sZCwgeGZBMiwgZml4dHVyZUEsIGluZGV4QSwgeGZCMiwgZml4dHVyZUIsIGluZGV4Qikge1xuICAgIENvbGxpZGVDaXJjbGVzKG1hbmlmb2xkLCBmaXh0dXJlQS5nZXRTaGFwZSgpLCB4ZkEyLCBmaXh0dXJlQi5nZXRTaGFwZSgpLCB4ZkIyKTtcbiAgfVxuICB2YXIgcEEgPSB2ZWMyKDAsIDApO1xuICB2YXIgcEIgPSB2ZWMyKDAsIDApO1xuICB2YXIgQ29sbGlkZUNpcmNsZXMgPSBmdW5jdGlvbihtYW5pZm9sZCwgY2lyY2xlQSwgeGZBMiwgY2lyY2xlQiwgeGZCMikge1xuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAwO1xuICAgIHRyYW5zZm9ybVZlYzIocEEsIHhmQTIsIGNpcmNsZUEubV9wKTtcbiAgICB0cmFuc2Zvcm1WZWMyKHBCLCB4ZkIyLCBjaXJjbGVCLm1fcCk7XG4gICAgdmFyIGRpc3RTcXIgPSBkaXN0U3FyVmVjMihwQiwgcEEpO1xuICAgIHZhciByQTIgPSBjaXJjbGVBLm1fcmFkaXVzO1xuICAgIHZhciByQjIgPSBjaXJjbGVCLm1fcmFkaXVzO1xuICAgIHZhciByYWRpdXMgPSByQTIgKyByQjI7XG4gICAgaWYgKGRpc3RTcXIgPiByYWRpdXMgKiByYWRpdXMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2NpcmNsZXM7XG4gICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgY2lyY2xlQS5tX3ApO1xuICAgIHplcm9WZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsKTtcbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMTtcbiAgICBjb3B5VmVjMihtYW5pZm9sZC5wb2ludHNbMF0ubG9jYWxQb2ludCwgY2lyY2xlQi5tX3ApO1xuICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gIH07XG4gIENvbnRhY3QuYWRkVHlwZShFZGdlU2hhcGUuVFlQRSwgQ2lyY2xlU2hhcGUuVFlQRSwgRWRnZUNpcmNsZUNvbnRhY3QpO1xuICBDb250YWN0LmFkZFR5cGUoQ2hhaW5TaGFwZS5UWVBFLCBDaXJjbGVTaGFwZS5UWVBFLCBDaGFpbkNpcmNsZUNvbnRhY3QpO1xuICBmdW5jdGlvbiBFZGdlQ2lyY2xlQ29udGFjdChtYW5pZm9sZCwgeGZBMiwgZml4dHVyZUEsIGluZGV4QSwgeGZCMiwgZml4dHVyZUIsIGluZGV4Qikge1xuICAgIHZhciBzaGFwZUEgPSBmaXh0dXJlQS5nZXRTaGFwZSgpO1xuICAgIHZhciBzaGFwZUIgPSBmaXh0dXJlQi5nZXRTaGFwZSgpO1xuICAgIENvbGxpZGVFZGdlQ2lyY2xlKG1hbmlmb2xkLCBzaGFwZUEsIHhmQTIsIHNoYXBlQiwgeGZCMik7XG4gIH1cbiAgZnVuY3Rpb24gQ2hhaW5DaXJjbGVDb250YWN0KG1hbmlmb2xkLCB4ZkEyLCBmaXh0dXJlQSwgaW5kZXhBLCB4ZkIyLCBmaXh0dXJlQiwgaW5kZXhCKSB7XG4gICAgdmFyIGNoYWluID0gZml4dHVyZUEuZ2V0U2hhcGUoKTtcbiAgICB2YXIgZWRnZSA9IG5ldyBFZGdlU2hhcGUoKTtcbiAgICBjaGFpbi5nZXRDaGlsZEVkZ2UoZWRnZSwgaW5kZXhBKTtcbiAgICB2YXIgc2hhcGVBID0gZWRnZTtcbiAgICB2YXIgc2hhcGVCID0gZml4dHVyZUIuZ2V0U2hhcGUoKTtcbiAgICBDb2xsaWRlRWRnZUNpcmNsZShtYW5pZm9sZCwgc2hhcGVBLCB4ZkEyLCBzaGFwZUIsIHhmQjIpO1xuICB9XG4gIHZhciBlID0gdmVjMigwLCAwKTtcbiAgdmFyIGUxID0gdmVjMigwLCAwKTtcbiAgdmFyIGUyID0gdmVjMigwLCAwKTtcbiAgdmFyIFEgPSB2ZWMyKDAsIDApO1xuICB2YXIgUCA9IHZlYzIoMCwgMCk7XG4gIHZhciBuJDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgQ29sbGlkZUVkZ2VDaXJjbGUgPSBmdW5jdGlvbihtYW5pZm9sZCwgZWRnZUEsIHhmQTIsIGNpcmNsZUIsIHhmQjIpIHtcbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMDtcbiAgICByZXRyYW5zZm9ybVZlYzIoUSwgeGZCMiwgeGZBMiwgY2lyY2xlQi5tX3ApO1xuICAgIHZhciBBID0gZWRnZUEubV92ZXJ0ZXgxO1xuICAgIHZhciBCID0gZWRnZUEubV92ZXJ0ZXgyO1xuICAgIHN1YlZlYzIoZSwgQiwgQSk7XG4gICAgdmFyIHUgPSBkb3RWZWMyKGUsIEIpIC0gZG90VmVjMihlLCBRKTtcbiAgICB2YXIgdjMgPSBkb3RWZWMyKGUsIFEpIC0gZG90VmVjMihlLCBBKTtcbiAgICB2YXIgcmFkaXVzID0gZWRnZUEubV9yYWRpdXMgKyBjaXJjbGVCLm1fcmFkaXVzO1xuICAgIGlmICh2MyA8PSAwKSB7XG4gICAgICBjb3B5VmVjMihQLCBBKTtcbiAgICAgIHZhciBkZF8xID0gZGlzdFNxclZlYzIoUSwgQSk7XG4gICAgICBpZiAoZGRfMSA+IHJhZGl1cyAqIHJhZGl1cykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZWRnZUEubV9oYXNWZXJ0ZXgwKSB7XG4gICAgICAgIHZhciBBMSA9IGVkZ2VBLm1fdmVydGV4MDtcbiAgICAgICAgdmFyIEIxID0gQTtcbiAgICAgICAgc3ViVmVjMihlMSwgQjEsIEExKTtcbiAgICAgICAgdmFyIHUxID0gZG90VmVjMihlMSwgQjEpIC0gZG90VmVjMihlMSwgUSk7XG4gICAgICAgIGlmICh1MSA+IDApIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9jaXJjbGVzO1xuICAgICAgemVyb1ZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgUCk7XG4gICAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLnBvaW50c1swXS5sb2NhbFBvaW50LCBjaXJjbGVCLm1fcCk7XG4gICAgICBtYW5pZm9sZC5wb2ludHNbMF0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCAwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodSA8PSAwKSB7XG4gICAgICBjb3B5VmVjMihQLCBCKTtcbiAgICAgIHZhciBkZF8yID0gZGlzdFNxclZlYzIoUSwgUCk7XG4gICAgICBpZiAoZGRfMiA+IHJhZGl1cyAqIHJhZGl1cykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZWRnZUEubV9oYXNWZXJ0ZXgzKSB7XG4gICAgICAgIHZhciBCMiA9IGVkZ2VBLm1fdmVydGV4MztcbiAgICAgICAgdmFyIEEyID0gQjtcbiAgICAgICAgc3ViVmVjMihlMiwgQjIsIEEyKTtcbiAgICAgICAgdmFyIHYyMiA9IGRvdFZlYzIoZTIsIFEpIC0gZG90VmVjMihlMiwgQTIpO1xuICAgICAgICBpZiAodjIyID4gMCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2NpcmNsZXM7XG4gICAgICB6ZXJvVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCk7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCBQKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygxLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBkZW4gPSBsZW5ndGhTcXJWZWMyKGUpO1xuICAgIGNvbWJpbmUyVmVjMihQLCB1IC8gZGVuLCBBLCB2MyAvIGRlbiwgQik7XG4gICAgdmFyIGRkID0gZGlzdFNxclZlYzIoUSwgUCk7XG4gICAgaWYgKGRkID4gcmFkaXVzICogcmFkaXVzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNyb3NzTnVtVmVjMihuJDIsIDEsIGUpO1xuICAgIGlmIChkb3RWZWMyKG4kMiwgUSkgLSBkb3RWZWMyKG4kMiwgQSkgPCAwKSB7XG4gICAgICBuZWdWZWMyKG4kMik7XG4gICAgfVxuICAgIG5vcm1hbGl6ZVZlYzIobiQyKTtcbiAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUE7XG4gICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIG4kMik7XG4gICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgQSk7XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDE7XG4gICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICBtYW5pZm9sZC5wb2ludHNbMF0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfZmFjZSwgMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgfTtcbiAgdmFyIGluY2lkZW50RWRnZSA9IFtuZXcgQ2xpcFZlcnRleCgpLCBuZXcgQ2xpcFZlcnRleCgpXTtcbiAgdmFyIGNsaXBQb2ludHMxJDEgPSBbbmV3IENsaXBWZXJ0ZXgoKSwgbmV3IENsaXBWZXJ0ZXgoKV07XG4gIHZhciBjbGlwUG9pbnRzMiQxID0gW25ldyBDbGlwVmVydGV4KCksIG5ldyBDbGlwVmVydGV4KCldO1xuICB2YXIgY2xpcFNlZ21lbnRUb0xpbmVOb3JtYWwgPSB2ZWMyKDAsIDApO1xuICB2YXIgdjEgPSB2ZWMyKDAsIDApO1xuICB2YXIgbiQxID0gdmVjMigwLCAwKTtcbiAgdmFyIHhmJDEgPSB0cmFuc2Zvcm0oMCwgMCwgMCk7XG4gIHZhciB2MTEgPSB2ZWMyKDAsIDApO1xuICB2YXIgdjEyID0gdmVjMigwLCAwKTtcbiAgdmFyIGxvY2FsVGFuZ2VudCA9IHZlYzIoMCwgMCk7XG4gIHZhciBsb2NhbE5vcm1hbCA9IHZlYzIoMCwgMCk7XG4gIHZhciBwbGFuZVBvaW50ID0gdmVjMigwLCAwKTtcbiAgdmFyIHRhbmdlbnQgPSB2ZWMyKDAsIDApO1xuICB2YXIgbm9ybWFsJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgbm9ybWFsMSQxID0gdmVjMigwLCAwKTtcbiAgQ29udGFjdC5hZGRUeXBlKFBvbHlnb25TaGFwZS5UWVBFLCBQb2x5Z29uU2hhcGUuVFlQRSwgUG9seWdvbkNvbnRhY3QpO1xuICBmdW5jdGlvbiBQb2x5Z29uQ29udGFjdChtYW5pZm9sZCwgeGZBMiwgZml4dHVyZUEsIGluZGV4QSwgeGZCMiwgZml4dHVyZUIsIGluZGV4Qikge1xuICAgIENvbGxpZGVQb2x5Z29ucyhtYW5pZm9sZCwgZml4dHVyZUEuZ2V0U2hhcGUoKSwgeGZBMiwgZml4dHVyZUIuZ2V0U2hhcGUoKSwgeGZCMik7XG4gIH1cbiAgZnVuY3Rpb24gZmluZE1heFNlcGFyYXRpb24ocG9seTEsIHhmMSwgcG9seTIsIHhmMiwgb3V0cHV0Mikge1xuICAgIHZhciBjb3VudDEgPSBwb2x5MS5tX2NvdW50O1xuICAgIHZhciBjb3VudDIgPSBwb2x5Mi5tX2NvdW50O1xuICAgIHZhciBuMXMgPSBwb2x5MS5tX25vcm1hbHM7XG4gICAgdmFyIHYxcyA9IHBvbHkxLm1fdmVydGljZXM7XG4gICAgdmFyIHYycyA9IHBvbHkyLm1fdmVydGljZXM7XG4gICAgZGV0cmFuc2Zvcm1UcmFuc2Zvcm0oeGYkMSwgeGYyLCB4ZjEpO1xuICAgIHZhciBiZXN0SW5kZXggPSAwO1xuICAgIHZhciBtYXhTZXBhcmF0aW9uMiA9IC1JbmZpbml0eTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50MTsgKytpKSB7XG4gICAgICByb3RWZWMyKG4kMSwgeGYkMS5xLCBuMXNbaV0pO1xuICAgICAgdHJhbnNmb3JtVmVjMih2MSwgeGYkMSwgdjFzW2ldKTtcbiAgICAgIHZhciBzaSA9IEluZmluaXR5O1xuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjb3VudDI7ICsraikge1xuICAgICAgICB2YXIgc2lqID0gZG90VmVjMihuJDEsIHYyc1tqXSkgLSBkb3RWZWMyKG4kMSwgdjEpO1xuICAgICAgICBpZiAoc2lqIDwgc2kpIHtcbiAgICAgICAgICBzaSA9IHNpajtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHNpID4gbWF4U2VwYXJhdGlvbjIpIHtcbiAgICAgICAgbWF4U2VwYXJhdGlvbjIgPSBzaTtcbiAgICAgICAgYmVzdEluZGV4ID0gaTtcbiAgICAgIH1cbiAgICB9XG4gICAgb3V0cHV0Mi5tYXhTZXBhcmF0aW9uID0gbWF4U2VwYXJhdGlvbjI7XG4gICAgb3V0cHV0Mi5iZXN0SW5kZXggPSBiZXN0SW5kZXg7XG4gIH1cbiAgZnVuY3Rpb24gZmluZEluY2lkZW50RWRnZShjbGlwVmVydGV4LCBwb2x5MSwgeGYxLCBlZGdlMTIsIHBvbHkyLCB4ZjIpIHtcbiAgICB2YXIgbm9ybWFsczEgPSBwb2x5MS5tX25vcm1hbHM7XG4gICAgdmFyIGNvdW50MiA9IHBvbHkyLm1fY291bnQ7XG4gICAgdmFyIHZlcnRpY2VzMiA9IHBvbHkyLm1fdmVydGljZXM7XG4gICAgdmFyIG5vcm1hbHMyID0gcG9seTIubV9ub3JtYWxzO1xuICAgIHJlcm90VmVjMihub3JtYWwxJDEsIHhmMi5xLCB4ZjEucSwgbm9ybWFsczFbZWRnZTEyXSk7XG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgbWluRG90ID0gSW5maW5pdHk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDI7ICsraSkge1xuICAgICAgdmFyIGRvdCA9IGRvdFZlYzIobm9ybWFsMSQxLCBub3JtYWxzMltpXSk7XG4gICAgICBpZiAoZG90IDwgbWluRG90KSB7XG4gICAgICAgIG1pbkRvdCA9IGRvdDtcbiAgICAgICAgaW5kZXggPSBpO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgaTEgPSBpbmRleDtcbiAgICB2YXIgaTIgPSBpMSArIDEgPCBjb3VudDIgPyBpMSArIDEgOiAwO1xuICAgIHRyYW5zZm9ybVZlYzIoY2xpcFZlcnRleFswXS52LCB4ZjIsIHZlcnRpY2VzMltpMV0pO1xuICAgIGNsaXBWZXJ0ZXhbMF0uaWQuc2V0RmVhdHVyZXMoZWRnZTEyLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV9mYWNlLCBpMSwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICB0cmFuc2Zvcm1WZWMyKGNsaXBWZXJ0ZXhbMV0udiwgeGYyLCB2ZXJ0aWNlczJbaTJdKTtcbiAgICBjbGlwVmVydGV4WzFdLmlkLnNldEZlYXR1cmVzKGVkZ2UxMiwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfZmFjZSwgaTIsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gIH1cbiAgdmFyIG1heFNlcGFyYXRpb24gPSB7XG4gICAgbWF4U2VwYXJhdGlvbjogMCxcbiAgICBiZXN0SW5kZXg6IDBcbiAgfTtcbiAgdmFyIENvbGxpZGVQb2x5Z29ucyA9IGZ1bmN0aW9uKG1hbmlmb2xkLCBwb2x5QSwgeGZBMiwgcG9seUIsIHhmQjIpIHtcbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMDtcbiAgICB2YXIgdG90YWxSYWRpdXMgPSBwb2x5QS5tX3JhZGl1cyArIHBvbHlCLm1fcmFkaXVzO1xuICAgIGZpbmRNYXhTZXBhcmF0aW9uKHBvbHlBLCB4ZkEyLCBwb2x5QiwgeGZCMiwgbWF4U2VwYXJhdGlvbik7XG4gICAgdmFyIGVkZ2VBID0gbWF4U2VwYXJhdGlvbi5iZXN0SW5kZXg7XG4gICAgdmFyIHNlcGFyYXRpb25BID0gbWF4U2VwYXJhdGlvbi5tYXhTZXBhcmF0aW9uO1xuICAgIGlmIChzZXBhcmF0aW9uQSA+IHRvdGFsUmFkaXVzKVxuICAgICAgcmV0dXJuO1xuICAgIGZpbmRNYXhTZXBhcmF0aW9uKHBvbHlCLCB4ZkIyLCBwb2x5QSwgeGZBMiwgbWF4U2VwYXJhdGlvbik7XG4gICAgdmFyIGVkZ2VCID0gbWF4U2VwYXJhdGlvbi5iZXN0SW5kZXg7XG4gICAgdmFyIHNlcGFyYXRpb25CID0gbWF4U2VwYXJhdGlvbi5tYXhTZXBhcmF0aW9uO1xuICAgIGlmIChzZXBhcmF0aW9uQiA+IHRvdGFsUmFkaXVzKVxuICAgICAgcmV0dXJuO1xuICAgIHZhciBwb2x5MTtcbiAgICB2YXIgcG9seTI7XG4gICAgdmFyIHhmMTtcbiAgICB2YXIgeGYyO1xuICAgIHZhciBlZGdlMTI7XG4gICAgdmFyIGZsaXA7XG4gICAgdmFyIGtfdG9sID0gMC4xICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgIGlmIChzZXBhcmF0aW9uQiA+IHNlcGFyYXRpb25BICsga190b2wpIHtcbiAgICAgIHBvbHkxID0gcG9seUI7XG4gICAgICBwb2x5MiA9IHBvbHlBO1xuICAgICAgeGYxID0geGZCMjtcbiAgICAgIHhmMiA9IHhmQTI7XG4gICAgICBlZGdlMTIgPSBlZGdlQjtcbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQjtcbiAgICAgIGZsaXAgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBwb2x5MSA9IHBvbHlBO1xuICAgICAgcG9seTIgPSBwb2x5QjtcbiAgICAgIHhmMSA9IHhmQTI7XG4gICAgICB4ZjIgPSB4ZkIyO1xuICAgICAgZWRnZTEyID0gZWRnZUE7XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUE7XG4gICAgICBmbGlwID0gZmFsc2U7XG4gICAgfVxuICAgIGluY2lkZW50RWRnZVswXS5yZWN5Y2xlKCk7XG4gICAgaW5jaWRlbnRFZGdlWzFdLnJlY3ljbGUoKTtcbiAgICBmaW5kSW5jaWRlbnRFZGdlKGluY2lkZW50RWRnZSwgcG9seTEsIHhmMSwgZWRnZTEyLCBwb2x5MiwgeGYyKTtcbiAgICB2YXIgY291bnQxID0gcG9seTEubV9jb3VudDtcbiAgICB2YXIgdmVydGljZXMxID0gcG9seTEubV92ZXJ0aWNlcztcbiAgICB2YXIgaXYxID0gZWRnZTEyO1xuICAgIHZhciBpdjIgPSBlZGdlMTIgKyAxIDwgY291bnQxID8gZWRnZTEyICsgMSA6IDA7XG4gICAgY29weVZlYzIodjExLCB2ZXJ0aWNlczFbaXYxXSk7XG4gICAgY29weVZlYzIodjEyLCB2ZXJ0aWNlczFbaXYyXSk7XG4gICAgc3ViVmVjMihsb2NhbFRhbmdlbnQsIHYxMiwgdjExKTtcbiAgICBub3JtYWxpemVWZWMyKGxvY2FsVGFuZ2VudCk7XG4gICAgY3Jvc3NWZWMyTnVtKGxvY2FsTm9ybWFsLCBsb2NhbFRhbmdlbnQsIDEpO1xuICAgIGNvbWJpbmUyVmVjMihwbGFuZVBvaW50LCAwLjUsIHYxMSwgMC41LCB2MTIpO1xuICAgIHJvdFZlYzIodGFuZ2VudCwgeGYxLnEsIGxvY2FsVGFuZ2VudCk7XG4gICAgY3Jvc3NWZWMyTnVtKG5vcm1hbCQxLCB0YW5nZW50LCAxKTtcbiAgICB0cmFuc2Zvcm1WZWMyKHYxMSwgeGYxLCB2MTEpO1xuICAgIHRyYW5zZm9ybVZlYzIodjEyLCB4ZjEsIHYxMik7XG4gICAgdmFyIGZyb250T2Zmc2V0ID0gZG90VmVjMihub3JtYWwkMSwgdjExKTtcbiAgICB2YXIgc2lkZU9mZnNldDEgPSAtZG90VmVjMih0YW5nZW50LCB2MTEpICsgdG90YWxSYWRpdXM7XG4gICAgdmFyIHNpZGVPZmZzZXQyID0gZG90VmVjMih0YW5nZW50LCB2MTIpICsgdG90YWxSYWRpdXM7XG4gICAgY2xpcFBvaW50czEkMVswXS5yZWN5Y2xlKCk7XG4gICAgY2xpcFBvaW50czEkMVsxXS5yZWN5Y2xlKCk7XG4gICAgY2xpcFBvaW50czIkMVswXS5yZWN5Y2xlKCk7XG4gICAgY2xpcFBvaW50czIkMVsxXS5yZWN5Y2xlKCk7XG4gICAgc2V0VmVjMihjbGlwU2VnbWVudFRvTGluZU5vcm1hbCwgLXRhbmdlbnQueCwgLXRhbmdlbnQueSk7XG4gICAgdmFyIG5wMSA9IGNsaXBTZWdtZW50VG9MaW5lKGNsaXBQb2ludHMxJDEsIGluY2lkZW50RWRnZSwgY2xpcFNlZ21lbnRUb0xpbmVOb3JtYWwsIHNpZGVPZmZzZXQxLCBpdjEpO1xuICAgIGlmIChucDEgPCAyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHNldFZlYzIoY2xpcFNlZ21lbnRUb0xpbmVOb3JtYWwsIHRhbmdlbnQueCwgdGFuZ2VudC55KTtcbiAgICB2YXIgbnAyID0gY2xpcFNlZ21lbnRUb0xpbmUoY2xpcFBvaW50czIkMSwgY2xpcFBvaW50czEkMSwgY2xpcFNlZ21lbnRUb0xpbmVOb3JtYWwsIHNpZGVPZmZzZXQyLCBpdjIpO1xuICAgIGlmIChucDIgPCAyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsLCBsb2NhbE5vcm1hbCk7XG4gICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgcGxhbmVQb2ludCk7XG4gICAgdmFyIHBvaW50Q291bnQgPSAwO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2xpcFBvaW50czIkMS5sZW5ndGg7ICsraSkge1xuICAgICAgdmFyIHNlcGFyYXRpb24gPSBkb3RWZWMyKG5vcm1hbCQxLCBjbGlwUG9pbnRzMiQxW2ldLnYpIC0gZnJvbnRPZmZzZXQ7XG4gICAgICBpZiAoc2VwYXJhdGlvbiA8PSB0b3RhbFJhZGl1cykge1xuICAgICAgICB2YXIgY3AgPSBtYW5pZm9sZC5wb2ludHNbcG9pbnRDb3VudF07XG4gICAgICAgIGRldHJhbnNmb3JtVmVjMihjcC5sb2NhbFBvaW50LCB4ZjIsIGNsaXBQb2ludHMyJDFbaV0udik7XG4gICAgICAgIGNwLmlkLnNldChjbGlwUG9pbnRzMiQxW2ldLmlkKTtcbiAgICAgICAgaWYgKGZsaXApIHtcbiAgICAgICAgICBjcC5pZC5zd2FwRmVhdHVyZXMoKTtcbiAgICAgICAgfVxuICAgICAgICArK3BvaW50Q291bnQ7XG4gICAgICB9XG4gICAgfVxuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSBwb2ludENvdW50O1xuICB9O1xuICBDb250YWN0LmFkZFR5cGUoUG9seWdvblNoYXBlLlRZUEUsIENpcmNsZVNoYXBlLlRZUEUsIFBvbHlnb25DaXJjbGVDb250YWN0KTtcbiAgZnVuY3Rpb24gUG9seWdvbkNpcmNsZUNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZpeHR1cmVBLCBpbmRleEEsIHhmQjIsIGZpeHR1cmVCLCBpbmRleEIpIHtcbiAgICBDb2xsaWRlUG9seWdvbkNpcmNsZShtYW5pZm9sZCwgZml4dHVyZUEuZ2V0U2hhcGUoKSwgeGZBMiwgZml4dHVyZUIuZ2V0U2hhcGUoKSwgeGZCMik7XG4gIH1cbiAgdmFyIGNMb2NhbCA9IHZlYzIoMCwgMCk7XG4gIHZhciBmYWNlQ2VudGVyID0gdmVjMigwLCAwKTtcbiAgdmFyIENvbGxpZGVQb2x5Z29uQ2lyY2xlID0gZnVuY3Rpb24obWFuaWZvbGQsIHBvbHlnb25BLCB4ZkEyLCBjaXJjbGVCLCB4ZkIyKSB7XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDA7XG4gICAgcmV0cmFuc2Zvcm1WZWMyKGNMb2NhbCwgeGZCMiwgeGZBMiwgY2lyY2xlQi5tX3ApO1xuICAgIHZhciBub3JtYWxJbmRleCA9IDA7XG4gICAgdmFyIHNlcGFyYXRpb24gPSAtSW5maW5pdHk7XG4gICAgdmFyIHJhZGl1cyA9IHBvbHlnb25BLm1fcmFkaXVzICsgY2lyY2xlQi5tX3JhZGl1cztcbiAgICB2YXIgdmVydGV4Q291bnQgPSBwb2x5Z29uQS5tX2NvdW50O1xuICAgIHZhciB2ZXJ0aWNlcyA9IHBvbHlnb25BLm1fdmVydGljZXM7XG4gICAgdmFyIG5vcm1hbHMgPSBwb2x5Z29uQS5tX25vcm1hbHM7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2ZXJ0ZXhDb3VudDsgKytpKSB7XG4gICAgICB2YXIgczIgPSBkb3RWZWMyKG5vcm1hbHNbaV0sIGNMb2NhbCkgLSBkb3RWZWMyKG5vcm1hbHNbaV0sIHZlcnRpY2VzW2ldKTtcbiAgICAgIGlmIChzMiA+IHJhZGl1cykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoczIgPiBzZXBhcmF0aW9uKSB7XG4gICAgICAgIHNlcGFyYXRpb24gPSBzMjtcbiAgICAgICAgbm9ybWFsSW5kZXggPSBpO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgdmVydEluZGV4MSA9IG5vcm1hbEluZGV4O1xuICAgIHZhciB2ZXJ0SW5kZXgyID0gdmVydEluZGV4MSArIDEgPCB2ZXJ0ZXhDb3VudCA/IHZlcnRJbmRleDEgKyAxIDogMDtcbiAgICB2YXIgdjEzID0gdmVydGljZXNbdmVydEluZGV4MV07XG4gICAgdmFyIHYyMiA9IHZlcnRpY2VzW3ZlcnRJbmRleDJdO1xuICAgIGlmIChzZXBhcmF0aW9uIDwgRVBTSUxPTikge1xuICAgICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDE7XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUE7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgbm9ybWFsc1tub3JtYWxJbmRleF0pO1xuICAgICAgY29tYmluZTJWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIDAuNSwgdjEzLCAwLjUsIHYyMik7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5wb2ludHNbMF0ubG9jYWxQb2ludCwgY2lyY2xlQi5tX3ApO1xuICAgICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHUxID0gZG90VmVjMihjTG9jYWwsIHYyMikgLSBkb3RWZWMyKGNMb2NhbCwgdjEzKSAtIGRvdFZlYzIodjEzLCB2MjIpICsgZG90VmVjMih2MTMsIHYxMyk7XG4gICAgdmFyIHUyID0gZG90VmVjMihjTG9jYWwsIHYxMykgLSBkb3RWZWMyKGNMb2NhbCwgdjIyKSAtIGRvdFZlYzIodjIyLCB2MTMpICsgZG90VmVjMih2MjIsIHYyMik7XG4gICAgaWYgKHUxIDw9IDApIHtcbiAgICAgIGlmIChkaXN0U3FyVmVjMihjTG9jYWwsIHYxMykgPiByYWRpdXMgKiByYWRpdXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDE7XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUE7XG4gICAgICBzdWJWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsLCBjTG9jYWwsIHYxMyk7XG4gICAgICBub3JtYWxpemVWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIHYxMyk7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5wb2ludHNbMF0ubG9jYWxQb2ludCwgY2lyY2xlQi5tX3ApO1xuICAgICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICB9IGVsc2UgaWYgKHUyIDw9IDApIHtcbiAgICAgIGlmIChkaXN0U3FyVmVjMihjTG9jYWwsIHYyMikgPiByYWRpdXMgKiByYWRpdXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDE7XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUE7XG4gICAgICBzdWJWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsLCBjTG9jYWwsIHYyMik7XG4gICAgICBub3JtYWxpemVWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIHYyMik7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5wb2ludHNbMF0ubG9jYWxQb2ludCwgY2lyY2xlQi5tX3ApO1xuICAgICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29tYmluZTJWZWMyKGZhY2VDZW50ZXIsIDAuNSwgdjEzLCAwLjUsIHYyMik7XG4gICAgICB2YXIgc2VwYXJhdGlvbl8xID0gZG90VmVjMihjTG9jYWwsIG5vcm1hbHNbdmVydEluZGV4MV0pIC0gZG90VmVjMihmYWNlQ2VudGVyLCBub3JtYWxzW3ZlcnRJbmRleDFdKTtcbiAgICAgIGlmIChzZXBhcmF0aW9uXzEgPiByYWRpdXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDE7XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUE7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgbm9ybWFsc1t2ZXJ0SW5kZXgxXSk7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCBmYWNlQ2VudGVyKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLnBvaW50c1swXS5sb2NhbFBvaW50LCBjaXJjbGVCLm1fcCk7XG4gICAgICBtYW5pZm9sZC5wb2ludHNbMF0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCAwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICAgIH1cbiAgfTtcbiAgdmFyIG1hdGhfbWluID0gTWF0aC5taW47XG4gIENvbnRhY3QuYWRkVHlwZShFZGdlU2hhcGUuVFlQRSwgUG9seWdvblNoYXBlLlRZUEUsIEVkZ2VQb2x5Z29uQ29udGFjdCk7XG4gIENvbnRhY3QuYWRkVHlwZShDaGFpblNoYXBlLlRZUEUsIFBvbHlnb25TaGFwZS5UWVBFLCBDaGFpblBvbHlnb25Db250YWN0KTtcbiAgZnVuY3Rpb24gRWRnZVBvbHlnb25Db250YWN0KG1hbmlmb2xkLCB4ZkEyLCBmQSwgaW5kZXhBLCB4ZkIyLCBmQiwgaW5kZXhCKSB7XG4gICAgQ29sbGlkZUVkZ2VQb2x5Z29uKG1hbmlmb2xkLCBmQS5nZXRTaGFwZSgpLCB4ZkEyLCBmQi5nZXRTaGFwZSgpLCB4ZkIyKTtcbiAgfVxuICB2YXIgZWRnZV9yZXVzZSA9IG5ldyBFZGdlU2hhcGUoKTtcbiAgZnVuY3Rpb24gQ2hhaW5Qb2x5Z29uQ29udGFjdChtYW5pZm9sZCwgeGZBMiwgZkEsIGluZGV4QSwgeGZCMiwgZkIsIGluZGV4Qikge1xuICAgIHZhciBjaGFpbiA9IGZBLmdldFNoYXBlKCk7XG4gICAgY2hhaW4uZ2V0Q2hpbGRFZGdlKGVkZ2VfcmV1c2UsIGluZGV4QSk7XG4gICAgQ29sbGlkZUVkZ2VQb2x5Z29uKG1hbmlmb2xkLCBlZGdlX3JldXNlLCB4ZkEyLCBmQi5nZXRTaGFwZSgpLCB4ZkIyKTtcbiAgfVxuICB2YXIgRVBBeGlzVHlwZTtcbiAgKGZ1bmN0aW9uKEVQQXhpc1R5cGUyKSB7XG4gICAgRVBBeGlzVHlwZTJbRVBBeGlzVHlwZTJbXCJlX3Vua25vd25cIl0gPSAtMV0gPSBcImVfdW5rbm93blwiO1xuICAgIEVQQXhpc1R5cGUyW0VQQXhpc1R5cGUyW1wiZV9lZGdlQVwiXSA9IDFdID0gXCJlX2VkZ2VBXCI7XG4gICAgRVBBeGlzVHlwZTJbRVBBeGlzVHlwZTJbXCJlX2VkZ2VCXCJdID0gMl0gPSBcImVfZWRnZUJcIjtcbiAgfSkoRVBBeGlzVHlwZSB8fCAoRVBBeGlzVHlwZSA9IHt9KSk7XG4gIHZhciBWZXJ0ZXhUeXBlO1xuICAoZnVuY3Rpb24oVmVydGV4VHlwZTIpIHtcbiAgICBWZXJ0ZXhUeXBlMltWZXJ0ZXhUeXBlMltcImVfaXNvbGF0ZWRcIl0gPSAwXSA9IFwiZV9pc29sYXRlZFwiO1xuICAgIFZlcnRleFR5cGUyW1ZlcnRleFR5cGUyW1wiZV9jb25jYXZlXCJdID0gMV0gPSBcImVfY29uY2F2ZVwiO1xuICAgIFZlcnRleFR5cGUyW1ZlcnRleFR5cGUyW1wiZV9jb252ZXhcIl0gPSAyXSA9IFwiZV9jb252ZXhcIjtcbiAgfSkoVmVydGV4VHlwZSB8fCAoVmVydGV4VHlwZSA9IHt9KSk7XG4gIHZhciBFUEF4aXMgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIC8qIEBfX1BVUkVfXyAqLyBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEVQQXhpczIoKSB7XG4gICAgICB9XG4gICAgICByZXR1cm4gRVBBeGlzMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFRlbXBQb2x5Z29uID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICAvKiBAX19QVVJFX18gKi8gZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBUZW1wUG9seWdvbjIoKSB7XG4gICAgICAgIHRoaXMudmVydGljZXMgPSBbXTtcbiAgICAgICAgdGhpcy5ub3JtYWxzID0gW107XG4gICAgICAgIHRoaXMuY291bnQgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IFNldHRpbmdzSW50ZXJuYWwubWF4UG9seWdvblZlcnRpY2VzOyBpKyspIHtcbiAgICAgICAgICB0aGlzLnZlcnRpY2VzLnB1c2godmVjMigwLCAwKSk7XG4gICAgICAgICAgdGhpcy5ub3JtYWxzLnB1c2godmVjMigwLCAwKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBUZW1wUG9seWdvbjI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBSZWZlcmVuY2VGYWNlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFJlZmVyZW5jZUZhY2UyKCkge1xuICAgICAgICB0aGlzLnYxID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy52MiA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMubm9ybWFsID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5zaWRlTm9ybWFsMSA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMuc2lkZU5vcm1hbDIgPSB2ZWMyKDAsIDApO1xuICAgICAgfVxuICAgICAgUmVmZXJlbmNlRmFjZTIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgemVyb1ZlYzIodGhpcy52MSk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMudjIpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLm5vcm1hbCk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMuc2lkZU5vcm1hbDEpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnNpZGVOb3JtYWwyKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gUmVmZXJlbmNlRmFjZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBjbGlwUG9pbnRzMSA9IFtuZXcgQ2xpcFZlcnRleCgpLCBuZXcgQ2xpcFZlcnRleCgpXTtcbiAgdmFyIGNsaXBQb2ludHMyID0gW25ldyBDbGlwVmVydGV4KCksIG5ldyBDbGlwVmVydGV4KCldO1xuICB2YXIgaWUgPSBbbmV3IENsaXBWZXJ0ZXgoKSwgbmV3IENsaXBWZXJ0ZXgoKV07XG4gIHZhciBlZGdlQXhpcyA9IG5ldyBFUEF4aXMoKTtcbiAgdmFyIHBvbHlnb25BeGlzID0gbmV3IEVQQXhpcygpO1xuICB2YXIgcG9seWdvbkJBID0gbmV3IFRlbXBQb2x5Z29uKCk7XG4gIHZhciByZiA9IG5ldyBSZWZlcmVuY2VGYWNlKCk7XG4gIHZhciBjZW50cm9pZEIgPSB2ZWMyKDAsIDApO1xuICB2YXIgZWRnZTAgPSB2ZWMyKDAsIDApO1xuICB2YXIgZWRnZTEgPSB2ZWMyKDAsIDApO1xuICB2YXIgZWRnZTIgPSB2ZWMyKDAsIDApO1xuICB2YXIgeGYgPSB0cmFuc2Zvcm0oMCwgMCwgMCk7XG4gIHZhciBub3JtYWwgPSB2ZWMyKDAsIDApO1xuICB2YXIgbm9ybWFsMCA9IHZlYzIoMCwgMCk7XG4gIHZhciBub3JtYWwxID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgbG93ZXJMaW1pdCA9IHZlYzIoMCwgMCk7XG4gIHZhciB1cHBlckxpbWl0ID0gdmVjMigwLCAwKTtcbiAgdmFyIHBlcnAgPSB2ZWMyKDAsIDApO1xuICB2YXIgbiA9IHZlYzIoMCwgMCk7XG4gIHZhciBDb2xsaWRlRWRnZVBvbHlnb24gPSBmdW5jdGlvbihtYW5pZm9sZCwgZWRnZUEsIHhmQTIsIHBvbHlnb25CLCB4ZkIyKSB7XG4gICAgZGV0cmFuc2Zvcm1UcmFuc2Zvcm0oeGYsIHhmQTIsIHhmQjIpO1xuICAgIHRyYW5zZm9ybVZlYzIoY2VudHJvaWRCLCB4ZiwgcG9seWdvbkIubV9jZW50cm9pZCk7XG4gICAgdmFyIHYwID0gZWRnZUEubV92ZXJ0ZXgwO1xuICAgIHZhciB2MTMgPSBlZGdlQS5tX3ZlcnRleDE7XG4gICAgdmFyIHYyMiA9IGVkZ2VBLm1fdmVydGV4MjtcbiAgICB2YXIgdjMgPSBlZGdlQS5tX3ZlcnRleDM7XG4gICAgdmFyIGhhc1ZlcnRleDAgPSBlZGdlQS5tX2hhc1ZlcnRleDA7XG4gICAgdmFyIGhhc1ZlcnRleDMgPSBlZGdlQS5tX2hhc1ZlcnRleDM7XG4gICAgc3ViVmVjMihlZGdlMSwgdjIyLCB2MTMpO1xuICAgIG5vcm1hbGl6ZVZlYzIoZWRnZTEpO1xuICAgIHNldFZlYzIobm9ybWFsMSwgZWRnZTEueSwgLWVkZ2UxLngpO1xuICAgIHZhciBvZmZzZXQxID0gZG90VmVjMihub3JtYWwxLCBjZW50cm9pZEIpIC0gZG90VmVjMihub3JtYWwxLCB2MTMpO1xuICAgIHZhciBvZmZzZXQwID0gMDtcbiAgICB2YXIgb2Zmc2V0MiA9IDA7XG4gICAgdmFyIGNvbnZleDEgPSBmYWxzZTtcbiAgICB2YXIgY29udmV4MiA9IGZhbHNlO1xuICAgIHplcm9WZWMyKG5vcm1hbDApO1xuICAgIHplcm9WZWMyKG5vcm1hbDIpO1xuICAgIGlmIChoYXNWZXJ0ZXgwKSB7XG4gICAgICBzdWJWZWMyKGVkZ2UwLCB2MTMsIHYwKTtcbiAgICAgIG5vcm1hbGl6ZVZlYzIoZWRnZTApO1xuICAgICAgc2V0VmVjMihub3JtYWwwLCBlZGdlMC55LCAtZWRnZTAueCk7XG4gICAgICBjb252ZXgxID0gY3Jvc3NWZWMyVmVjMihlZGdlMCwgZWRnZTEpID49IDA7XG4gICAgICBvZmZzZXQwID0gVmVjMi5kb3Qobm9ybWFsMCwgY2VudHJvaWRCKSAtIFZlYzIuZG90KG5vcm1hbDAsIHYwKTtcbiAgICB9XG4gICAgaWYgKGhhc1ZlcnRleDMpIHtcbiAgICAgIHN1YlZlYzIoZWRnZTIsIHYzLCB2MjIpO1xuICAgICAgbm9ybWFsaXplVmVjMihlZGdlMik7XG4gICAgICBzZXRWZWMyKG5vcm1hbDIsIGVkZ2UyLnksIC1lZGdlMi54KTtcbiAgICAgIGNvbnZleDIgPSBWZWMyLmNyb3NzVmVjMlZlYzIoZWRnZTEsIGVkZ2UyKSA+IDA7XG4gICAgICBvZmZzZXQyID0gVmVjMi5kb3Qobm9ybWFsMiwgY2VudHJvaWRCKSAtIFZlYzIuZG90KG5vcm1hbDIsIHYyMik7XG4gICAgfVxuICAgIHZhciBmcm9udDtcbiAgICB6ZXJvVmVjMihub3JtYWwpO1xuICAgIHplcm9WZWMyKGxvd2VyTGltaXQpO1xuICAgIHplcm9WZWMyKHVwcGVyTGltaXQpO1xuICAgIGlmIChoYXNWZXJ0ZXgwICYmIGhhc1ZlcnRleDMpIHtcbiAgICAgIGlmIChjb252ZXgxICYmIGNvbnZleDIpIHtcbiAgICAgICAgZnJvbnQgPSBvZmZzZXQwID49IDAgfHwgb2Zmc2V0MSA+PSAwIHx8IG9mZnNldDIgPj0gMDtcbiAgICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwwKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGNvbnZleDEpIHtcbiAgICAgICAgZnJvbnQgPSBvZmZzZXQwID49IDAgfHwgb2Zmc2V0MSA+PSAwICYmIG9mZnNldDIgPj0gMDtcbiAgICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwwKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwyKTtcbiAgICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGNvbnZleDIpIHtcbiAgICAgICAgZnJvbnQgPSBvZmZzZXQyID49IDAgfHwgb2Zmc2V0MCA+PSAwICYmIG9mZnNldDEgPj0gMDtcbiAgICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmcm9udCA9IG9mZnNldDAgPj0gMCAmJiBvZmZzZXQxID49IDAgJiYgb2Zmc2V0MiA+PSAwO1xuICAgICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDIpO1xuICAgICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGhhc1ZlcnRleDApIHtcbiAgICAgIGlmIChjb252ZXgxKSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MCA+PSAwIHx8IG9mZnNldDEgPj0gMDtcbiAgICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwwKTtcbiAgICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmcm9udCA9IG9mZnNldDAgPj0gMCAmJiBvZmZzZXQxID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoaGFzVmVydGV4Mykge1xuICAgICAgaWYgKGNvbnZleDIpIHtcbiAgICAgICAgZnJvbnQgPSBvZmZzZXQxID49IDAgfHwgb2Zmc2V0MiA+PSAwO1xuICAgICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MSA+PSAwICYmIG9mZnNldDIgPj0gMDtcbiAgICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDIpO1xuICAgICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGZyb250ID0gb2Zmc2V0MSA+PSAwO1xuICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcG9seWdvbkJBLmNvdW50ID0gcG9seWdvbkIubV9jb3VudDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvbHlnb25CLm1fY291bnQ7ICsraSkge1xuICAgICAgdHJhbnNmb3JtVmVjMihwb2x5Z29uQkEudmVydGljZXNbaV0sIHhmLCBwb2x5Z29uQi5tX3ZlcnRpY2VzW2ldKTtcbiAgICAgIHJvdFZlYzIocG9seWdvbkJBLm5vcm1hbHNbaV0sIHhmLnEsIHBvbHlnb25CLm1fbm9ybWFsc1tpXSk7XG4gICAgfVxuICAgIHZhciByYWRpdXMgPSBwb2x5Z29uQi5tX3JhZGl1cyArIGVkZ2VBLm1fcmFkaXVzO1xuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAwO1xuICAgIHtcbiAgICAgIGVkZ2VBeGlzLnR5cGUgPSBFUEF4aXNUeXBlLmVfZWRnZUE7XG4gICAgICBlZGdlQXhpcy5pbmRleCA9IGZyb250ID8gMCA6IDE7XG4gICAgICBlZGdlQXhpcy5zZXBhcmF0aW9uID0gSW5maW5pdHk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvbHlnb25CQS5jb3VudDsgKytpKSB7XG4gICAgICAgIHZhciB2NCA9IHBvbHlnb25CQS52ZXJ0aWNlc1tpXTtcbiAgICAgICAgdmFyIHMyID0gZG90VmVjMihub3JtYWwsIHY0KSAtIGRvdFZlYzIobm9ybWFsLCB2MTMpO1xuICAgICAgICBpZiAoczIgPCBlZGdlQXhpcy5zZXBhcmF0aW9uKSB7XG4gICAgICAgICAgZWRnZUF4aXMuc2VwYXJhdGlvbiA9IHMyO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChlZGdlQXhpcy50eXBlID09IEVQQXhpc1R5cGUuZV91bmtub3duKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChlZGdlQXhpcy5zZXBhcmF0aW9uID4gcmFkaXVzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHtcbiAgICAgIHBvbHlnb25BeGlzLnR5cGUgPSBFUEF4aXNUeXBlLmVfdW5rbm93bjtcbiAgICAgIHBvbHlnb25BeGlzLmluZGV4ID0gLTE7XG4gICAgICBwb2x5Z29uQXhpcy5zZXBhcmF0aW9uID0gLUluZmluaXR5O1xuICAgICAgc2V0VmVjMihwZXJwLCAtbm9ybWFsLnksIG5vcm1hbC54KTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9seWdvbkJBLmNvdW50OyArK2kpIHtcbiAgICAgICAgc2NhbGVWZWMyKG4sIC0xLCBwb2x5Z29uQkEubm9ybWFsc1tpXSk7XG4gICAgICAgIHZhciBzMSA9IGRvdFZlYzIobiwgcG9seWdvbkJBLnZlcnRpY2VzW2ldKSAtIGRvdFZlYzIobiwgdjEzKTtcbiAgICAgICAgdmFyIHMyMiA9IGRvdFZlYzIobiwgcG9seWdvbkJBLnZlcnRpY2VzW2ldKSAtIGRvdFZlYzIobiwgdjIyKTtcbiAgICAgICAgdmFyIHMyID0gbWF0aF9taW4oczEsIHMyMik7XG4gICAgICAgIGlmIChzMiA+IHJhZGl1cykge1xuICAgICAgICAgIHBvbHlnb25BeGlzLnR5cGUgPSBFUEF4aXNUeXBlLmVfZWRnZUI7XG4gICAgICAgICAgcG9seWdvbkF4aXMuaW5kZXggPSBpO1xuICAgICAgICAgIHBvbHlnb25BeGlzLnNlcGFyYXRpb24gPSBzMjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAoZG90VmVjMihuLCBwZXJwKSA+PSAwKSB7XG4gICAgICAgICAgaWYgKGRvdFZlYzIobiwgbm9ybWFsKSAtIGRvdFZlYzIodXBwZXJMaW1pdCwgbm9ybWFsKSA8IC1TZXR0aW5nc0ludGVybmFsLmFuZ3VsYXJTbG9wKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGRvdFZlYzIobiwgbm9ybWFsKSAtIGRvdFZlYzIobG93ZXJMaW1pdCwgbm9ybWFsKSA8IC1TZXR0aW5nc0ludGVybmFsLmFuZ3VsYXJTbG9wKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHMyID4gcG9seWdvbkF4aXMuc2VwYXJhdGlvbikge1xuICAgICAgICAgIHBvbHlnb25BeGlzLnR5cGUgPSBFUEF4aXNUeXBlLmVfZWRnZUI7XG4gICAgICAgICAgcG9seWdvbkF4aXMuaW5kZXggPSBpO1xuICAgICAgICAgIHBvbHlnb25BeGlzLnNlcGFyYXRpb24gPSBzMjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAocG9seWdvbkF4aXMudHlwZSAhPSBFUEF4aXNUeXBlLmVfdW5rbm93biAmJiBwb2x5Z29uQXhpcy5zZXBhcmF0aW9uID4gcmFkaXVzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBrX3JlbGF0aXZlVG9sID0gMC45ODtcbiAgICB2YXIga19hYnNvbHV0ZVRvbCA9IDFlLTM7XG4gICAgdmFyIHByaW1hcnlBeGlzO1xuICAgIGlmIChwb2x5Z29uQXhpcy50eXBlID09IEVQQXhpc1R5cGUuZV91bmtub3duKSB7XG4gICAgICBwcmltYXJ5QXhpcyA9IGVkZ2VBeGlzO1xuICAgIH0gZWxzZSBpZiAocG9seWdvbkF4aXMuc2VwYXJhdGlvbiA+IGtfcmVsYXRpdmVUb2wgKiBlZGdlQXhpcy5zZXBhcmF0aW9uICsga19hYnNvbHV0ZVRvbCkge1xuICAgICAgcHJpbWFyeUF4aXMgPSBwb2x5Z29uQXhpcztcbiAgICB9IGVsc2Uge1xuICAgICAgcHJpbWFyeUF4aXMgPSBlZGdlQXhpcztcbiAgICB9XG4gICAgaWVbMF0ucmVjeWNsZSgpO1xuICAgIGllWzFdLnJlY3ljbGUoKTtcbiAgICBpZiAocHJpbWFyeUF4aXMudHlwZSA9PSBFUEF4aXNUeXBlLmVfZWRnZUEpIHtcbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQTtcbiAgICAgIHZhciBiZXN0SW5kZXggPSAwO1xuICAgICAgdmFyIGJlc3RWYWx1ZSA9IGRvdFZlYzIobm9ybWFsLCBwb2x5Z29uQkEubm9ybWFsc1swXSk7XG4gICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBvbHlnb25CQS5jb3VudDsgKytpKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGRvdFZlYzIobm9ybWFsLCBwb2x5Z29uQkEubm9ybWFsc1tpXSk7XG4gICAgICAgIGlmICh2YWx1ZSA8IGJlc3RWYWx1ZSkge1xuICAgICAgICAgIGJlc3RWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgIGJlc3RJbmRleCA9IGk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBpMSA9IGJlc3RJbmRleDtcbiAgICAgIHZhciBpMiA9IGkxICsgMSA8IHBvbHlnb25CQS5jb3VudCA/IGkxICsgMSA6IDA7XG4gICAgICBjb3B5VmVjMihpZVswXS52LCBwb2x5Z29uQkEudmVydGljZXNbaTFdKTtcbiAgICAgIGllWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UsIGkxLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICAgICAgY29weVZlYzIoaWVbMV0udiwgcG9seWdvbkJBLnZlcnRpY2VzW2kyXSk7XG4gICAgICBpZVsxXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV9mYWNlLCBpMiwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICAgIGlmIChmcm9udCkge1xuICAgICAgICByZi5pMSA9IDA7XG4gICAgICAgIHJmLmkyID0gMTtcbiAgICAgICAgY29weVZlYzIocmYudjEsIHYxMyk7XG4gICAgICAgIGNvcHlWZWMyKHJmLnYyLCB2MjIpO1xuICAgICAgICBjb3B5VmVjMihyZi5ub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmYuaTEgPSAxO1xuICAgICAgICByZi5pMiA9IDA7XG4gICAgICAgIGNvcHlWZWMyKHJmLnYxLCB2MjIpO1xuICAgICAgICBjb3B5VmVjMihyZi52MiwgdjEzKTtcbiAgICAgICAgc2NhbGVWZWMyKHJmLm5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUI7XG4gICAgICBjb3B5VmVjMihpZVswXS52LCB2MTMpO1xuICAgICAgaWVbMF0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCBwcmltYXJ5QXhpcy5pbmRleCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfZmFjZSk7XG4gICAgICBjb3B5VmVjMihpZVsxXS52LCB2MjIpO1xuICAgICAgaWVbMV0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCBwcmltYXJ5QXhpcy5pbmRleCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfZmFjZSk7XG4gICAgICByZi5pMSA9IHByaW1hcnlBeGlzLmluZGV4O1xuICAgICAgcmYuaTIgPSByZi5pMSArIDEgPCBwb2x5Z29uQkEuY291bnQgPyByZi5pMSArIDEgOiAwO1xuICAgICAgY29weVZlYzIocmYudjEsIHBvbHlnb25CQS52ZXJ0aWNlc1tyZi5pMV0pO1xuICAgICAgY29weVZlYzIocmYudjIsIHBvbHlnb25CQS52ZXJ0aWNlc1tyZi5pMl0pO1xuICAgICAgY29weVZlYzIocmYubm9ybWFsLCBwb2x5Z29uQkEubm9ybWFsc1tyZi5pMV0pO1xuICAgIH1cbiAgICBzZXRWZWMyKHJmLnNpZGVOb3JtYWwxLCByZi5ub3JtYWwueSwgLXJmLm5vcm1hbC54KTtcbiAgICBzZXRWZWMyKHJmLnNpZGVOb3JtYWwyLCAtcmYuc2lkZU5vcm1hbDEueCwgLXJmLnNpZGVOb3JtYWwxLnkpO1xuICAgIHJmLnNpZGVPZmZzZXQxID0gZG90VmVjMihyZi5zaWRlTm9ybWFsMSwgcmYudjEpO1xuICAgIHJmLnNpZGVPZmZzZXQyID0gZG90VmVjMihyZi5zaWRlTm9ybWFsMiwgcmYudjIpO1xuICAgIGNsaXBQb2ludHMxWzBdLnJlY3ljbGUoKTtcbiAgICBjbGlwUG9pbnRzMVsxXS5yZWN5Y2xlKCk7XG4gICAgY2xpcFBvaW50czJbMF0ucmVjeWNsZSgpO1xuICAgIGNsaXBQb2ludHMyWzFdLnJlY3ljbGUoKTtcbiAgICB2YXIgbnAxID0gY2xpcFNlZ21lbnRUb0xpbmUoY2xpcFBvaW50czEsIGllLCByZi5zaWRlTm9ybWFsMSwgcmYuc2lkZU9mZnNldDEsIHJmLmkxKTtcbiAgICBpZiAobnAxIDwgU2V0dGluZ3NJbnRlcm5hbC5tYXhNYW5pZm9sZFBvaW50cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgbnAyID0gY2xpcFNlZ21lbnRUb0xpbmUoY2xpcFBvaW50czIsIGNsaXBQb2ludHMxLCByZi5zaWRlTm9ybWFsMiwgcmYuc2lkZU9mZnNldDIsIHJmLmkyKTtcbiAgICBpZiAobnAyIDwgU2V0dGluZ3NJbnRlcm5hbC5tYXhNYW5pZm9sZFBvaW50cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAocHJpbWFyeUF4aXMudHlwZSA9PSBFUEF4aXNUeXBlLmVfZWRnZUEpIHtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsLCByZi5ub3JtYWwpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgcmYudjEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgcG9seWdvbkIubV9ub3JtYWxzW3JmLmkxXSk7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCBwb2x5Z29uQi5tX3ZlcnRpY2VzW3JmLmkxXSk7XG4gICAgfVxuICAgIHZhciBwb2ludENvdW50ID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IFNldHRpbmdzSW50ZXJuYWwubWF4TWFuaWZvbGRQb2ludHM7ICsraSkge1xuICAgICAgdmFyIHNlcGFyYXRpb24gPSBkb3RWZWMyKHJmLm5vcm1hbCwgY2xpcFBvaW50czJbaV0udikgLSBkb3RWZWMyKHJmLm5vcm1hbCwgcmYudjEpO1xuICAgICAgaWYgKHNlcGFyYXRpb24gPD0gcmFkaXVzKSB7XG4gICAgICAgIHZhciBjcCA9IG1hbmlmb2xkLnBvaW50c1twb2ludENvdW50XTtcbiAgICAgICAgaWYgKHByaW1hcnlBeGlzLnR5cGUgPT0gRVBBeGlzVHlwZS5lX2VkZ2VBKSB7XG4gICAgICAgICAgZGV0cmFuc2Zvcm1WZWMyKGNwLmxvY2FsUG9pbnQsIHhmLCBjbGlwUG9pbnRzMltpXS52KTtcbiAgICAgICAgICBjcC5pZC5zZXQoY2xpcFBvaW50czJbaV0uaWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvcHlWZWMyKGNwLmxvY2FsUG9pbnQsIGNsaXBQb2ludHMyW2ldLnYpO1xuICAgICAgICAgIGNwLmlkLnNldChjbGlwUG9pbnRzMltpXS5pZCk7XG4gICAgICAgICAgY3AuaWQuc3dhcEZlYXR1cmVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgKytwb2ludENvdW50O1xuICAgICAgfVxuICAgIH1cbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gcG9pbnRDb3VudDtcbiAgfTtcbiAgdmFyIGludGVybmFsID0ge1xuICAgIENvbGxpZGVQb2x5Z29ucyxcbiAgICBTZXR0aW5ncyxcbiAgICBTd2VlcCxcbiAgICBNYW5pZm9sZCxcbiAgICBEaXN0YW5jZSxcbiAgICBUaW1lT2ZJbXBhY3QsXG4gICAgRHluYW1pY1RyZWUsXG4gICAgc3RhdHNcbiAgfTtcbiAgdmFyIERhdGFEcml2ZXIgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRGF0YURyaXZlcjIoa2V5LCBsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLl9yZWZNYXAgPSB7fTtcbiAgICAgICAgdGhpcy5fbWFwID0ge307XG4gICAgICAgIHRoaXMuX3htYXAgPSB7fTtcbiAgICAgICAgdGhpcy5fZGF0YSA9IFtdO1xuICAgICAgICB0aGlzLl9lbnRlcmVkID0gW107XG4gICAgICAgIHRoaXMuX2V4aXRlZCA9IFtdO1xuICAgICAgICB0aGlzLl9rZXkgPSBrZXk7XG4gICAgICAgIHRoaXMuX2xpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgICB9XG4gICAgICBEYXRhRHJpdmVyMi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZGF0YSkpXG4gICAgICAgICAgdGhyb3cgXCJJbnZhbGlkIGRhdGE6IFwiICsgZGF0YTtcbiAgICAgICAgdGhpcy5fZW50ZXJlZC5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLl9leGl0ZWQubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5fZGF0YS5sZW5ndGggPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBkYXRhW2ldICE9PSBcIm9iamVjdFwiIHx8IGRhdGFbaV0gPT09IG51bGwpXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB2YXIgZDIgPSBkYXRhW2ldO1xuICAgICAgICAgIHZhciBpZCA9IHRoaXMuX2tleShkMik7XG4gICAgICAgICAgaWYgKCF0aGlzLl9tYXBbaWRdKSB7XG4gICAgICAgICAgICB0aGlzLl9lbnRlcmVkLnB1c2goZDIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fbWFwW2lkXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5fZGF0YVtpXSA9IGQyO1xuICAgICAgICAgIHRoaXMuX3htYXBbaWRdID0gZDI7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaWQgaW4gdGhpcy5fbWFwKSB7XG4gICAgICAgICAgdGhpcy5fZXhpdGVkLnB1c2godGhpcy5fbWFwW2lkXSk7XG4gICAgICAgICAgZGVsZXRlIHRoaXMuX21hcFtpZF07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRlbXAzID0gdGhpcy5fbWFwO1xuICAgICAgICB0aGlzLl9tYXAgPSB0aGlzLl94bWFwO1xuICAgICAgICB0aGlzLl94bWFwID0gdGVtcDM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZXhpdGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdmFyIGQyID0gdGhpcy5fZXhpdGVkW2ldO1xuICAgICAgICAgIHZhciBrZXkgPSB0aGlzLl9rZXkoZDIpO1xuICAgICAgICAgIHZhciByZWYgPSB0aGlzLl9yZWZNYXBba2V5XTtcbiAgICAgICAgICB0aGlzLl9saXN0ZW5lci5leGl0KGQyLCByZWYpO1xuICAgICAgICAgIGRlbGV0ZSB0aGlzLl9yZWZNYXBba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2VudGVyZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgZDIgPSB0aGlzLl9lbnRlcmVkW2ldO1xuICAgICAgICAgIHZhciBrZXkgPSB0aGlzLl9rZXkoZDIpO1xuICAgICAgICAgIHZhciByZWYgPSB0aGlzLl9saXN0ZW5lci5lbnRlcihkMik7XG4gICAgICAgICAgaWYgKHJlZikge1xuICAgICAgICAgICAgdGhpcy5fcmVmTWFwW2tleV0gPSByZWY7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmICh0eXBlb2YgZGF0YVtpXSAhPT0gXCJvYmplY3RcIiB8fCBkYXRhW2ldID09PSBudWxsKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgdmFyIGQyID0gdGhpcy5fZGF0YVtpXTtcbiAgICAgICAgICB2YXIga2V5ID0gdGhpcy5fa2V5KGQyKTtcbiAgICAgICAgICB2YXIgcmVmID0gdGhpcy5fcmVmTWFwW2tleV07XG4gICAgICAgICAgdGhpcy5fbGlzdGVuZXIudXBkYXRlKGQyLCByZWYpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2VudGVyZWQubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5fZXhpdGVkLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuX2RhdGEubGVuZ3RoID0gMDtcbiAgICAgIH07XG4gICAgICBEYXRhRHJpdmVyMi5wcm90b3R5cGUucmVmID0gZnVuY3Rpb24oZDIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlZk1hcFt0aGlzLl9rZXkoZDIpXTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gRGF0YURyaXZlcjI7XG4gICAgfSgpXG4gICk7XG4gIGNvbnN0IHBsYW5jayA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuZnJlZXplKC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuZGVmaW5lUHJvcGVydHkoe1xuICAgIF9fcHJvdG9fXzogbnVsbCxcbiAgICBBQUJCLFxuICAgIEJvZHksXG4gICAgQm94OiBCb3hTaGFwZSxcbiAgICBCb3hTaGFwZSxcbiAgICBCcm9hZFBoYXNlLFxuICAgIENoYWluOiBDaGFpblNoYXBlLFxuICAgIENoYWluU2hhcGUsXG4gICAgQ2lyY2xlOiBDaXJjbGVTaGFwZSxcbiAgICBDaXJjbGVTaGFwZSxcbiAgICBDbGlwVmVydGV4LFxuICAgIENvbGxpZGVDaXJjbGVzLFxuICAgIENvbGxpZGVFZGdlQ2lyY2xlLFxuICAgIENvbGxpZGVFZGdlUG9seWdvbixcbiAgICBDb2xsaWRlUG9seWdvbkNpcmNsZSxcbiAgICBDb2xsaWRlUG9seWdvbnMsXG4gICAgQ29udGFjdCxcbiAgICBDb250YWN0RWRnZSxcbiAgICBnZXQgQ29udGFjdEZlYXR1cmVUeXBlKCkge1xuICAgICAgcmV0dXJuIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZTtcbiAgICB9LFxuICAgIENvbnRhY3RJRCxcbiAgICBDb250YWN0SW1wdWxzZSxcbiAgICBEYXRhRHJpdmVyLFxuICAgIERpc3RhbmNlLFxuICAgIERpc3RhbmNlSW5wdXQsXG4gICAgRGlzdGFuY2VKb2ludCxcbiAgICBEaXN0YW5jZU91dHB1dCxcbiAgICBEaXN0YW5jZVByb3h5LFxuICAgIER5bmFtaWNUcmVlLFxuICAgIEVkZ2U6IEVkZ2VTaGFwZSxcbiAgICBFZGdlU2hhcGUsXG4gICAgRml4dHVyZSxcbiAgICBGaXh0dXJlUHJveHksXG4gICAgRnJpY3Rpb25Kb2ludCxcbiAgICBHZWFySm9pbnQsXG4gICAgSm9pbnQsXG4gICAgSm9pbnRFZGdlLFxuICAgIE1hbmlmb2xkLFxuICAgIE1hbmlmb2xkUG9pbnQsXG4gICAgZ2V0IE1hbmlmb2xkVHlwZSgpIHtcbiAgICAgIHJldHVybiBleHBvcnRzMi5NYW5pZm9sZFR5cGU7XG4gICAgfSxcbiAgICBNYXQyMixcbiAgICBNYXQzMyxcbiAgICBNYXRoOiBtYXRoLFxuICAgIE1vdG9ySm9pbnQsXG4gICAgTW91c2VKb2ludCxcbiAgICBnZXQgUG9pbnRTdGF0ZSgpIHtcbiAgICAgIHJldHVybiBleHBvcnRzMi5Qb2ludFN0YXRlO1xuICAgIH0sXG4gICAgUG9seWdvbjogUG9seWdvblNoYXBlLFxuICAgIFBvbHlnb25TaGFwZSxcbiAgICBQcmlzbWF0aWNKb2ludCxcbiAgICBQdWxsZXlKb2ludCxcbiAgICBSZXZvbHV0ZUpvaW50LFxuICAgIFJvcGVKb2ludCxcbiAgICBSb3QsXG4gICAgU2VyaWFsaXplcixcbiAgICBTZXR0aW5ncyxcbiAgICBTZXR0aW5nc0ludGVybmFsLFxuICAgIFNoYXBlLFxuICAgIFNoYXBlQ2FzdCxcbiAgICBTaGFwZUNhc3RJbnB1dCxcbiAgICBTaGFwZUNhc3RPdXRwdXQsXG4gICAgU2ltcGxleENhY2hlLFxuICAgIFNvbHZlcixcbiAgICBTd2VlcCxcbiAgICBUT0lJbnB1dCxcbiAgICBUT0lPdXRwdXQsXG4gICAgZ2V0IFRPSU91dHB1dFN0YXRlKCkge1xuICAgICAgcmV0dXJuIGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlO1xuICAgIH0sXG4gICAgVGVzdGJlZCxcbiAgICBUaW1lT2ZJbXBhY3QsXG4gICAgVGltZVN0ZXAsXG4gICAgVHJhbnNmb3JtLFxuICAgIFRyZWVOb2RlLFxuICAgIFZlYzIsXG4gICAgVmVjMyxcbiAgICBWZWxvY2l0eUNvbnN0cmFpbnRQb2ludCxcbiAgICBXZWxkSm9pbnQsXG4gICAgV2hlZWxKb2ludCxcbiAgICBXb3JsZCxcbiAgICBXb3JsZE1hbmlmb2xkLFxuICAgIGNsaXBTZWdtZW50VG9MaW5lLFxuICAgIGdldFBvaW50U3RhdGVzLFxuICAgIGludGVybmFsLFxuICAgIG1peEZyaWN0aW9uLFxuICAgIG1peFJlc3RpdHV0aW9uLFxuICAgIHN0YXRzLFxuICAgIHRlc3RPdmVybGFwLFxuICAgIHRlc3RiZWRcbiAgfSwgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiBcIk1vZHVsZVwiIH0pKTtcbiAgZXhwb3J0czIuQUFCQiA9IEFBQkI7XG4gIGV4cG9ydHMyLkJvZHkgPSBCb2R5O1xuICBleHBvcnRzMi5Cb3ggPSBCb3hTaGFwZTtcbiAgZXhwb3J0czIuQm94U2hhcGUgPSBCb3hTaGFwZTtcbiAgZXhwb3J0czIuQnJvYWRQaGFzZSA9IEJyb2FkUGhhc2U7XG4gIGV4cG9ydHMyLkNoYWluID0gQ2hhaW5TaGFwZTtcbiAgZXhwb3J0czIuQ2hhaW5TaGFwZSA9IENoYWluU2hhcGU7XG4gIGV4cG9ydHMyLkNpcmNsZSA9IENpcmNsZVNoYXBlO1xuICBleHBvcnRzMi5DaXJjbGVTaGFwZSA9IENpcmNsZVNoYXBlO1xuICBleHBvcnRzMi5DbGlwVmVydGV4ID0gQ2xpcFZlcnRleDtcbiAgZXhwb3J0czIuQ29sbGlkZUNpcmNsZXMgPSBDb2xsaWRlQ2lyY2xlcztcbiAgZXhwb3J0czIuQ29sbGlkZUVkZ2VDaXJjbGUgPSBDb2xsaWRlRWRnZUNpcmNsZTtcbiAgZXhwb3J0czIuQ29sbGlkZUVkZ2VQb2x5Z29uID0gQ29sbGlkZUVkZ2VQb2x5Z29uO1xuICBleHBvcnRzMi5Db2xsaWRlUG9seWdvbkNpcmNsZSA9IENvbGxpZGVQb2x5Z29uQ2lyY2xlO1xuICBleHBvcnRzMi5Db2xsaWRlUG9seWdvbnMgPSBDb2xsaWRlUG9seWdvbnM7XG4gIGV4cG9ydHMyLkNvbnRhY3QgPSBDb250YWN0O1xuICBleHBvcnRzMi5Db250YWN0RWRnZSA9IENvbnRhY3RFZGdlO1xuICBleHBvcnRzMi5Db250YWN0SUQgPSBDb250YWN0SUQ7XG4gIGV4cG9ydHMyLkNvbnRhY3RJbXB1bHNlID0gQ29udGFjdEltcHVsc2U7XG4gIGV4cG9ydHMyLkRhdGFEcml2ZXIgPSBEYXRhRHJpdmVyO1xuICBleHBvcnRzMi5EaXN0YW5jZSA9IERpc3RhbmNlO1xuICBleHBvcnRzMi5EaXN0YW5jZUlucHV0ID0gRGlzdGFuY2VJbnB1dDtcbiAgZXhwb3J0czIuRGlzdGFuY2VKb2ludCA9IERpc3RhbmNlSm9pbnQ7XG4gIGV4cG9ydHMyLkRpc3RhbmNlT3V0cHV0ID0gRGlzdGFuY2VPdXRwdXQ7XG4gIGV4cG9ydHMyLkRpc3RhbmNlUHJveHkgPSBEaXN0YW5jZVByb3h5O1xuICBleHBvcnRzMi5EeW5hbWljVHJlZSA9IER5bmFtaWNUcmVlO1xuICBleHBvcnRzMi5FZGdlID0gRWRnZVNoYXBlO1xuICBleHBvcnRzMi5FZGdlU2hhcGUgPSBFZGdlU2hhcGU7XG4gIGV4cG9ydHMyLkZpeHR1cmUgPSBGaXh0dXJlO1xuICBleHBvcnRzMi5GaXh0dXJlUHJveHkgPSBGaXh0dXJlUHJveHk7XG4gIGV4cG9ydHMyLkZyaWN0aW9uSm9pbnQgPSBGcmljdGlvbkpvaW50O1xuICBleHBvcnRzMi5HZWFySm9pbnQgPSBHZWFySm9pbnQ7XG4gIGV4cG9ydHMyLkpvaW50ID0gSm9pbnQ7XG4gIGV4cG9ydHMyLkpvaW50RWRnZSA9IEpvaW50RWRnZTtcbiAgZXhwb3J0czIuTWFuaWZvbGQgPSBNYW5pZm9sZDtcbiAgZXhwb3J0czIuTWFuaWZvbGRQb2ludCA9IE1hbmlmb2xkUG9pbnQ7XG4gIGV4cG9ydHMyLk1hdDIyID0gTWF0MjI7XG4gIGV4cG9ydHMyLk1hdDMzID0gTWF0MzM7XG4gIGV4cG9ydHMyLk1hdGggPSBtYXRoO1xuICBleHBvcnRzMi5Nb3RvckpvaW50ID0gTW90b3JKb2ludDtcbiAgZXhwb3J0czIuTW91c2VKb2ludCA9IE1vdXNlSm9pbnQ7XG4gIGV4cG9ydHMyLlBvbHlnb24gPSBQb2x5Z29uU2hhcGU7XG4gIGV4cG9ydHMyLlBvbHlnb25TaGFwZSA9IFBvbHlnb25TaGFwZTtcbiAgZXhwb3J0czIuUHJpc21hdGljSm9pbnQgPSBQcmlzbWF0aWNKb2ludDtcbiAgZXhwb3J0czIuUHVsbGV5Sm9pbnQgPSBQdWxsZXlKb2ludDtcbiAgZXhwb3J0czIuUmV2b2x1dGVKb2ludCA9IFJldm9sdXRlSm9pbnQ7XG4gIGV4cG9ydHMyLlJvcGVKb2ludCA9IFJvcGVKb2ludDtcbiAgZXhwb3J0czIuUm90ID0gUm90O1xuICBleHBvcnRzMi5TZXJpYWxpemVyID0gU2VyaWFsaXplcjtcbiAgZXhwb3J0czIuU2V0dGluZ3MgPSBTZXR0aW5ncztcbiAgZXhwb3J0czIuU2V0dGluZ3NJbnRlcm5hbCA9IFNldHRpbmdzSW50ZXJuYWw7XG4gIGV4cG9ydHMyLlNoYXBlID0gU2hhcGU7XG4gIGV4cG9ydHMyLlNoYXBlQ2FzdCA9IFNoYXBlQ2FzdDtcbiAgZXhwb3J0czIuU2hhcGVDYXN0SW5wdXQgPSBTaGFwZUNhc3RJbnB1dDtcbiAgZXhwb3J0czIuU2hhcGVDYXN0T3V0cHV0ID0gU2hhcGVDYXN0T3V0cHV0O1xuICBleHBvcnRzMi5TaW1wbGV4Q2FjaGUgPSBTaW1wbGV4Q2FjaGU7XG4gIGV4cG9ydHMyLlNvbHZlciA9IFNvbHZlcjtcbiAgZXhwb3J0czIuU3dlZXAgPSBTd2VlcDtcbiAgZXhwb3J0czIuVE9JSW5wdXQgPSBUT0lJbnB1dDtcbiAgZXhwb3J0czIuVE9JT3V0cHV0ID0gVE9JT3V0cHV0O1xuICBleHBvcnRzMi5UZXN0YmVkID0gVGVzdGJlZDtcbiAgZXhwb3J0czIuVGltZU9mSW1wYWN0ID0gVGltZU9mSW1wYWN0O1xuICBleHBvcnRzMi5UaW1lU3RlcCA9IFRpbWVTdGVwO1xuICBleHBvcnRzMi5UcmFuc2Zvcm0gPSBUcmFuc2Zvcm07XG4gIGV4cG9ydHMyLlRyZWVOb2RlID0gVHJlZU5vZGU7XG4gIGV4cG9ydHMyLlZlYzIgPSBWZWMyO1xuICBleHBvcnRzMi5WZWMzID0gVmVjMztcbiAgZXhwb3J0czIuVmVsb2NpdHlDb25zdHJhaW50UG9pbnQgPSBWZWxvY2l0eUNvbnN0cmFpbnRQb2ludDtcbiAgZXhwb3J0czIuV2VsZEpvaW50ID0gV2VsZEpvaW50O1xuICBleHBvcnRzMi5XaGVlbEpvaW50ID0gV2hlZWxKb2ludDtcbiAgZXhwb3J0czIuV29ybGQgPSBXb3JsZDtcbiAgZXhwb3J0czIuV29ybGRNYW5pZm9sZCA9IFdvcmxkTWFuaWZvbGQ7XG4gIGV4cG9ydHMyLmNsaXBTZWdtZW50VG9MaW5lID0gY2xpcFNlZ21lbnRUb0xpbmU7XG4gIGV4cG9ydHMyLmRlZmF1bHQgPSBwbGFuY2s7XG4gIGV4cG9ydHMyLmdldFBvaW50U3RhdGVzID0gZ2V0UG9pbnRTdGF0ZXM7XG4gIGV4cG9ydHMyLmludGVybmFsID0gaW50ZXJuYWw7XG4gIGV4cG9ydHMyLm1peEZyaWN0aW9uID0gbWl4RnJpY3Rpb247XG4gIGV4cG9ydHMyLm1peFJlc3RpdHV0aW9uID0gbWl4UmVzdGl0dXRpb247XG4gIGV4cG9ydHMyLnN0YXRzID0gc3RhdHM7XG4gIGV4cG9ydHMyLnRlc3RPdmVybGFwID0gdGVzdE92ZXJsYXA7XG4gIGV4cG9ydHMyLnRlc3RiZWQgPSB0ZXN0YmVkO1xuICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzMiwgeyBfX2VzTW9kdWxlOiB7IHZhbHVlOiB0cnVlIH0sIFtTeW1ib2wudG9TdHJpbmdUYWddOiB7IHZhbHVlOiBcIk1vZHVsZVwiIH0gfSk7XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBsYW5jay5qcy5tYXBcbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgQXNzZXQgfSBmcm9tICcuLic7XG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIgfSBmcm9tICcuL2V2ZW50LXN5c3RlbSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXNzZXRMb2FkZXJFdmVudHMgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCAoLi4uYXJnczogYW55W10pID0+IHZvaWQ+IHtcbiAgJ2xvYWRpbmc6c3RhcnQnOiAoKSA9PiB2b2lkO1xuICAnbG9hZGluZzplbmQnOiAoKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgQXNzZXRMb2FkZXIge1xuICBQSVhJQXNzZXRzOiBQSVhJLkFzc2V0c0NsYXNzID0gUElYSS5Bc3NldHM7XG4gIHRleHR1cmVzOiBQSVhJLlRleHR1cmVbXSA9IFtdO1xuICBpc0xvYWRpbmc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBldmVudHM6IEV2ZW50RW1pdHRlcjxBc3NldExvYWRlckV2ZW50cz4gPSBuZXcgRXZlbnRFbWl0dGVyPEFzc2V0TG9hZGVyRXZlbnRzPigpO1xuXG4gIC8qKlxuICAgKiBTdWJzY3JpYmUgdG8gbG9hZGluZyBldmVudHNcbiAgICovXG4gIG9uPEsgZXh0ZW5kcyBrZXlvZiBBc3NldExvYWRlckV2ZW50cz4oZXZlbnQ6IEssIGxpc3RlbmVyOiBBc3NldExvYWRlckV2ZW50c1tLXSk6IHZvaWQge1xuICAgIHRoaXMuZXZlbnRzLm9uKGV2ZW50LCBsaXN0ZW5lcik7XG4gIH1cblxuICAvKipcbiAgICogVW5zdWJzY3JpYmUgZnJvbSBsb2FkaW5nIGV2ZW50c1xuICAgKi9cbiAgb2ZmPEsgZXh0ZW5kcyBrZXlvZiBBc3NldExvYWRlckV2ZW50cz4oZXZlbnQ6IEssIGxpc3RlbmVyOiBBc3NldExvYWRlckV2ZW50c1tLXSk6IHZvaWQge1xuICAgIHRoaXMuZXZlbnRzLm9mZihldmVudCwgbGlzdGVuZXIpO1xuICB9XG5cbiAgbG9hZEFzc2V0cyA9IGFzeW5jIChhc3NldHM6IEFzc2V0W10pID0+IHtcbiAgICBjb25zdCB7IFBJWElBc3NldHMgfSA9IHRoaXM7XG5cbiAgICAvLyBFbWl0IGxvYWRpbmcgc3RhcnQgZXZlbnRcbiAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7XG4gICAgdGhpcy5ldmVudHMuZW1pdCgnbG9hZGluZzpzdGFydCcpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXNzZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHsgc3JjLCBhbGlhcyB9ID0gYXNzZXRzW2ldO1xuICAgICAgICBcbiAgICAgICAgaWYgKGFsaWFzKSB7XG4gICAgICAgICAgaWYgKCFQSVhJQXNzZXRzLmNhY2hlLmhhcyhhbGlhcykpIHtcbiAgICAgICAgICAgIGNvbnN0IHRleHR1cmUgPSBhd2FpdCBQSVhJQXNzZXRzLmxvYWQoeyBhbGlhcywgc3JjIH0pO1xuICAgICAgICAgICAgdGhpcy50ZXh0dXJlcy5wdXNoKHRleHR1cmUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBjb25zdCB0ZXh0dXJlID0gYXdhaXQgUElYSUFzc2V0cy5sb2FkKHNyYyk7XG4gICAgICAgICAgdGhpcy50ZXh0dXJlcy5wdXNoKHRleHR1cmUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9IGZpbmFsbHkge1xuICAgICAgLy8gRW1pdCBsb2FkaW5nIGVuZCBldmVudFxuICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuZXZlbnRzLmVtaXQoJ2xvYWRpbmc6ZW5kJyk7XG4gICAgfVxuICB9O1xufSIsImltcG9ydCBQSVhJLCB7IFBvaW50IH0gZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4vbG9naWMnO1xuaW1wb3J0IHsgU2NlbmUgfSBmcm9tICcuL3NjZW5lJztcbmltcG9ydCB7IEFzRW50aXR5LCBNb3hpTG9naWMsIE1veGlFbnRpdHkgfSBmcm9tICcuL21veGktZW50aXR5JztcbmltcG9ydCB7IGxlcnAgfSBmcm9tICcuLi9saWJyYXJ5L3V0aWxzJztcblxuLyoqXG4gKiBMb2dpYyB0aGF0IGhhbmRsZXMgY2FtZXJhIG1vdmVtZW50LCBmb2xsb3dpbmcgdGFyZ2V0cywgYW5kIHNtb290aCB0cmFuc2l0aW9ucy5cbiAqIFxuICogQGNhdGVnb3J5IExvZ2ljXG4gKiBAaW1wbGVtZW50cyB7TG9naWM8UElYSS5Db250YWluZXI+fVxuICovXG5leHBvcnQgY2xhc3MgQ2FtZXJhTG9naWMgZXh0ZW5kcyBMb2dpYzxQSVhJLkNvbnRhaW5lcj4ge1xuICAvKipcbiAgICogRXhwbGljaXQgbmFtZSBmb3IgdGhlIGxvZ2ljIGNvbXBvbmVudCAoc3Vydml2ZXMgbWluaWZpY2F0aW9uKVxuICAgKi9cbiAgbmFtZSA9ICdDYW1lcmFMb2dpYyc7XG4gIFxuICAvKipcbiAgICogU3BlZWQgYXQgd2hpY2ggdGhlIGNhbWVyYSB0cmFuc2l0aW9ucyB0byBpdHMgdGFyZ2V0IHBvc2l0aW9uIGFuZCBzY2FsZVxuICAgKiBAZGVmYXVsdCAwLjFcbiAgICovXG4gIHB1YmxpYyBzcGVlZDogbnVtYmVyID0gMC4xO1xuICBcbiAgLyoqXG4gICAqIFRoZSBlbnRpdHkgdGhhdCB0aGUgY2FtZXJhIHdpbGwgZm9sbG93XG4gICAqIEBkZWZhdWx0IG51bGxcbiAgICovXG4gIHB1YmxpYyB0YXJnZXQ6IFBJWEkuQ29udGFpbmVyID0gbnVsbDtcbiAgXG4gIC8qKlxuICAgKiBUaGUgZW50aXR5IHRoaXMgbG9naWMgaXMgYXR0YWNoZWQgdG9cbiAgICovXG4gIGVudGl0eTogUElYSS5Db250YWluZXI8UElYSS5Db250YWluZXJDaGlsZD47XG4gIFxuICAvKipcbiAgICogUmVmZXJlbmNlIHRvIHRoZSByZW5kZXJlciBmb3Igdmlld3BvcnQgY2FsY3VsYXRpb25zXG4gICAqL1xuICByZW5kZXJlcjogUElYSS5SZW5kZXJlcjxIVE1MQ2FudmFzRWxlbWVudD47XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIGNhbWVyYSBsb2dpY1xuICAgKiBAcGFyYW0gZW50aXR5IC0gVGhlIGNvbnRhaW5lciAoY2FtZXJhKSB0aGlzIGxvZ2ljIGlzIGF0dGFjaGVkIHRvXG4gICAqIEBwYXJhbSByZW5kZXJlciAtIFRoZSBQSVhJIHJlbmRlcmVyIGluc3RhbmNlXG4gICAqL1xuICBpbml0KGVudGl0eTogUElYSS5Db250YWluZXIsIHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyKSB7XG4gICAgdGhpcy5lbnRpdHkgPSBlbnRpdHk7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGNhbWVyYSBwb3NpdGlvbiBhbmQgc2NhbGUgYmFzZWQgb24gdGFyZ2V0cyBhbmQgZGVzaXJlZCB2YWx1ZXNcbiAgICogQHBhcmFtIGVudGl0eSAtIFRoZSBDYW1lcmEgZW50aXR5XG4gICAqIEBwYXJhbSBkZWx0YVRpbWUgLSBUaW1lIGVsYXBzZWQgc2luY2UgbGFzdCB1cGRhdGUgaW4gc2Vjb25kc1xuICAgKi9cbiAgdXBkYXRlKGVudGl0eTogQ2FtZXJhLCBkZWx0YVRpbWU6IG51bWJlcikge1xuICAgIGNvbnN0IHsgc3BlZWQgfSA9IHRoaXM7XG4gICAgY29uc3QgZGVsdGFTcGVlZCA9IE1hdGgubWluKGRlbHRhVGltZSAqIHNwZWVkLCAxKTtcblxuICAgIC8vIFRyYWNrIGlmIHNjYWxlIGlzIGFjdGl2ZWx5IGNoYW5naW5nICh6b29taW5nKVxuICAgIGNvbnN0IGlzWm9vbWluZyA9IE1hdGguYWJzKGVudGl0eS5zY2FsZS54IC0gZW50aXR5LmRlc2lyZWRTY2FsZS54KSA+IDAuMDEgfHxcbiAgICAgICAgICAgICAgICAgICAgICBNYXRoLmFicyhlbnRpdHkuc2NhbGUueSAtIGVudGl0eS5kZXNpcmVkU2NhbGUueSkgPiAwLjAxO1xuXG4gICAgLy8gSW50ZXJwb2xhdGUgc2NhbGUgdmFsdWVzIGZpcnN0XG4gICAgaWYgKGVudGl0eS5kZXNpcmVkU2NhbGUgIT09IGVudGl0eS5zY2FsZSkge1xuICAgICAgZW50aXR5LnNjYWxlLnggPSBsZXJwKGVudGl0eS5zY2FsZS54LCBlbnRpdHkuZGVzaXJlZFNjYWxlLngsIGRlbHRhU3BlZWQpO1xuICAgICAgZW50aXR5LnNjYWxlLnkgPSBsZXJwKGVudGl0eS5zY2FsZS55LCBlbnRpdHkuZGVzaXJlZFNjYWxlLnksIGRlbHRhU3BlZWQpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBkZXNpcmVkIHBvc2l0aW9uIGlmIGNhbWVyYSBoYXMgYSB0YXJnZXRcbiAgICBpZiAodGhpcy50YXJnZXQpIHtcbiAgICAgIC8vIEluIGEgUElYSS5qcyBjYW1lcmEgc3lzdGVtLCB3ZSBuZWVkIHRvIHBvc2l0aW9uIHRoZSBjYW1lcmEgKHNjZW5lKVxuICAgICAgLy8gc28gdGhhdCB0aGUgdGFyZ2V0IGFwcGVhcnMgY2VudGVyZWQgaW4gdGhlIHZpZXdwb3J0XG5cbiAgICAgIC8vIEdldCB0aGUgY2VudGVyIG9mIHRoZSB2aWV3cG9ydCBpbiBzY3JlZW4gY29vcmRpbmF0ZXNcbiAgICAgIGNvbnN0IHNjcmVlbkNlbnRlclggPSB0aGlzLnJlbmRlcmVyLndpZHRoIC8gMjtcbiAgICAgIGNvbnN0IHNjcmVlbkNlbnRlclkgPSB0aGlzLnJlbmRlcmVyLmhlaWdodCAvIDI7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSB3aGVyZSB0aGUgc2NlbmUgc2hvdWxkIGJlIHBvc2l0aW9uZWRcbiAgICAgIC8vIFRoZSBmb3JtdWxhIGlzOiAtKHRhcmdldFBvc2l0aW9uICogc2NhbGUpICsgc2NyZWVuQ2VudGVyXG4gICAgICAvLyBUaGlzIGVuc3VyZXMgdGhlIHRhcmdldCBpcyBhdCB0aGUgY2VudGVyIG9mIHRoZSBzY3JlZW5cbiAgICAgIGNvbnN0IGRlc2lyZWRYID0gLSh0aGlzLnRhcmdldC5wb3NpdGlvbi54ICogZW50aXR5LnNjYWxlLngpICsgc2NyZWVuQ2VudGVyWDtcbiAgICAgIGNvbnN0IGRlc2lyZWRZID0gLSh0aGlzLnRhcmdldC5wb3NpdGlvbi55ICogZW50aXR5LnNjYWxlLnkpICsgc2NyZWVuQ2VudGVyWTtcblxuICAgICAgLy8gU2V0IGRlc2lyZWQgcG9zaXRpb24gZm9yIHRoZSBzY2VuZSAodXNpbmcgbmVnYXRpdmUgdmFsdWVzIGZvciBjYW1lcmEgY29vcmRpbmF0ZXMpXG4gICAgICBlbnRpdHkuZGVzaXJlZFBvc2l0aW9uLnNldCgtZGVzaXJlZFgsIC1kZXNpcmVkWSk7XG4gICAgfVxuXG4gICAgLy8gSW50ZXJwb2xhdGUgcG9zaXRpb24gdmFsdWVzXG4gICAgLy8gV2hlbiBhY3RpdmVseSB6b29taW5nLCB1cGRhdGUgcG9zaXRpb24gaW5zdGFudGx5IHRvIGtlZXAgdGFyZ2V0IGNlbnRlcmVkXG4gICAgLy8gT3RoZXJ3aXNlLCBpbnRlcnBvbGF0ZSBzbW9vdGhseSBmb3IgY2FtZXJhIGZvbGxvd2luZ1xuICAgIGlmIChlbnRpdHkuZGVzaXJlZFBvc2l0aW9uICE9PSBlbnRpdHkucG9zaXRpb24pIHtcbiAgICAgIGlmIChpc1pvb21pbmcpIHtcbiAgICAgICAgLy8gSW5zdGFudCBwb3NpdGlvbiB1cGRhdGUgZHVyaW5nIHpvb20gdG8gcHJldmVudCB0YXJnZXQgZHJpZnRcbiAgICAgICAgZW50aXR5LnBvc2l0aW9uLmNvcHlGcm9tKGVudGl0eS5kZXNpcmVkUG9zaXRpb24pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gU21vb3RoIGludGVycG9sYXRpb24gZm9yIG5vcm1hbCBjYW1lcmEgZm9sbG93aW5nXG4gICAgICAgIGVudGl0eS5wb3NpdGlvbi54ID0gbGVycChlbnRpdHkucG9zaXRpb24ueCwgZW50aXR5LmRlc2lyZWRQb3NpdGlvbi54LCBkZWx0YVNwZWVkKTtcbiAgICAgICAgZW50aXR5LnBvc2l0aW9uLnkgPSBsZXJwKGVudGl0eS5wb3NpdGlvbi55LCBlbnRpdHkuZGVzaXJlZFBvc2l0aW9uLnksIGRlbHRhU3BlZWQpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBBcHBseSBjYW1lcmEgdHJhbnNmb3JtYXRpb25zIHRvIHRoZSBzY2VuZVxuICAgIC8vIEluIFBJWEksIHRoZSBcImNhbWVyYVwiIGVmZmVjdCBpcyBjcmVhdGVkIGJ5IHRyYW5zZm9ybWluZyB0aGUgc2NlbmUgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvblxuICAgIGVudGl0eS5zY2VuZS5zY2FsZS5zZXQoZW50aXR5LnNjYWxlLngsIGVudGl0eS5zY2FsZS55KTtcblxuICAgIC8vIFBvc2l0aW9uIHRoZSBzY2VuZSBhdCB0aGUgbmVnYXRpdmUgb2YgdGhlIGNhbWVyYSBwb3NpdGlvbiB0byBjcmVhdGUgY2FtZXJhIG1vdmVtZW50IGVmZmVjdFxuICAgIGVudGl0eS5zY2VuZS5wb3NpdGlvbi5zZXQoLWVudGl0eS5wb3NpdGlvbi54LCAtZW50aXR5LnBvc2l0aW9uLnkpO1xuICB9XG59XG5cbi8qKlxuICogQ2FtZXJhIGVudGl0eSBmb3IgY29udHJvbGxpbmcgdGhlIHZpZXdwb3J0IGFuZCBmb2xsb3dpbmcgZ2FtZSBvYmplY3RzLlxuICogVGhlIENhbWVyYSBhcHBsaWVzIHRyYW5zZm9ybWF0aW9ucyB0byB0aGUgc2NlbmUgdG8gc2ltdWxhdGUgY2FtZXJhIG1vdmVtZW50LlxuICogXG4gKiBAY2F0ZWdvcnkgQ29yZVxuICogQGltcGxlbWVudHMge0FzRW50aXR5PFBJWEkuQ29udGFpbmVyPn1cbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIC8vIE1ha2UgdGhlIGNhbWVyYSBmb2xsb3cgYSBwbGF5ZXIgZW50aXR5XG4gKiBjYW1lcmEubW94aUVudGl0eS5nZXRMb2dpYzxDYW1lcmFMb2dpYz4oJ0NhbWVyYUxvZ2ljJykudGFyZ2V0ID0gcGxheWVyO1xuICogXG4gKiAvLyBTZXQgdGhlIGNhbWVyYSB6b29tIGxldmVsXG4gKiBjYW1lcmEuZGVzaXJlZFNjYWxlLnNldCgyLCAyKTsgLy8gMnggem9vbVxuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBDYW1lcmEgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lciBpbXBsZW1lbnRzIEFzRW50aXR5PFBJWEkuQ29udGFpbmVyPiB7XG4gIC8qKlxuICAgKiBSZWZlcmVuY2UgdG8gdGhlIHNjZW5lIGJlaW5nIHZpZXdlZCBieSB0aGlzIGNhbWVyYVxuICAgKi9cbiAgcHVibGljIHNjZW5lOiBTY2VuZTtcbiAgXG4gIC8qKlxuICAgKiBSZWZlcmVuY2UgdG8gdGhlIHJlbmRlcmVyXG4gICAqL1xuICBwdWJsaWMgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI7XG4gIFxuICAvKipcbiAgICogU3BlZWQgYXQgd2hpY2ggdGhlIGNhbWVyYSB0cmFuc2l0aW9uc1xuICAgKiBAZGVmYXVsdCAwLjFcbiAgICovXG4gIHB1YmxpYyBzcGVlZDogbnVtYmVyID0gMC4xO1xuICBcbiAgLyoqXG4gICAqIE1veGlFbnRpdHkgcmVmZXJlbmNlIGFzIHJlcXVpcmVkIGJ5IHRoZSBBc0VudGl0eSBpbnRlcmZhY2VcbiAgICovXG4gIHB1YmxpYyBtb3hpRW50aXR5OiBNb3hpRW50aXR5PFBJWEkuQ29udGFpbmVyPjtcbiAgXG4gIC8qKlxuICAgKiBUaGUgdGFyZ2V0IHNjYWxlICh6b29tKSBmb3IgdGhlIGNhbWVyYVxuICAgKiBAZGVmYXVsdCBuZXcgUG9pbnQoMSwgMSlcbiAgICovXG4gIHB1YmxpYyBkZXNpcmVkU2NhbGU6IFBvaW50ID0gbmV3IFBvaW50KDEsIDEpO1xuICBcbiAgLyoqXG4gICAqIFRoZSB0YXJnZXQgcG9zaXRpb24gZm9yIHRoZSBjYW1lcmFcbiAgICogQGRlZmF1bHQgbmV3IFBvaW50KDAsIDApXG4gICAqL1xuICBwdWJsaWMgZGVzaXJlZFBvc2l0aW9uOiBQb2ludCA9IG5ldyBQb2ludCgwLCAwKTsgXG4gIFxuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBDYW1lcmEgaW5zdGFuY2VcbiAgICogQHBhcmFtIHNjZW5lIC0gVGhlIHNjZW5lIGJlaW5nIHZpZXdlZCBieSB0aGlzIGNhbWVyYVxuICAgKiBAcGFyYW0gcmVuZGVyZXIgLSBUaGUgUElYSSByZW5kZXJlclxuICAgKiBAcGFyYW0gbG9naWMgLSBBZGRpdGlvbmFsIGxvZ2ljIHRvIGF0dGFjaCB0byB0aGlzIGNhbWVyYVxuICAgKi9cbiAgY29uc3RydWN0b3Ioc2NlbmU6IFNjZW5lLCByZW5kZXJlcjogUElYSS5SZW5kZXJlciwgbG9naWM6IE1veGlMb2dpYzxQSVhJLkNvbnRhaW5lcj4gPSB7fSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5zY2VuZSA9IHNjZW5lO1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcblxuICAgIC8vIEluaXRpYWxpemUgYW5kIGF0dGFjaCB0aGUgY2FtZXJhIGxvZ2ljXG4gICAgY29uc3QgY2FtZXJhTG9naWMgPSBuZXcgQ2FtZXJhTG9naWMoKTtcbiAgICBjYW1lcmFMb2dpYy5pbml0KHRoaXMsIHJlbmRlcmVyKTtcbiAgICB0aGlzLm1veGlFbnRpdHkgPSBuZXcgTW94aUVudGl0eTxQSVhJLkNvbnRhaW5lcj4odGhpcywgbG9naWMpO1xuICAgIHRoaXMubW94aUVudGl0eS5hZGRMb2dpYyhjYW1lcmFMb2dpYyk7XG4gICAgdGhpcy5zY2VuZS5hZGRDaGlsZCh0aGlzKTtcbiAgfVxufSAgXG5cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgU2NlbmUgfSBmcm9tICcuL3NjZW5lJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi4vbGlicmFyeS9waHlzaWNzJztcblxuLyoqXG4gKiBUaGUgY29yZSBnYW1lIGVuZ2luZSBjbGFzcyB0aGF0IG1hbmFnZXMgdGhlIGdhbWUgbG9vcCwgc2NlbmUgcmVuZGVyaW5nLFxuICogYW5kIHVwZGF0ZSBjeWNsZXMuIENvb3JkaW5hdGVzIHdpdGggdGhlIFBJWEkuVGlja2VyIHRvIGRyaXZlIHRoZSBhbmltYXRpb24uXG4gKlxuICogQGNhdGVnb3J5IENvcmVcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiAvLyBDcmVhdGUgYSBuZXcgZW5naW5lIHdpdGggYSBzY2VuZVxuICogY29uc3QgZW5naW5lID0gbmV3IEVuZ2luZShzY2VuZSk7XG4gKlxuICogLy8gU3RhcnQgdGhlIGdhbWUgbG9vcFxuICogZW5naW5lLnN0YXJ0KCk7XG4gKlxuICogLy8gU3RvcCB0aGUgZ2FtZSBsb29wIHdoZW4gbmVlZGVkXG4gKiBlbmdpbmUuc3RvcCgpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBFbmdpbmUge1xuICAvKipcbiAgICogVGhlIFBJWEkgVGlja2VyIGluc3RhbmNlIHRoYXQgZHJpdmVzIHRoZSBnYW1lIGxvb3BcbiAgICovXG4gIHRpY2tlcjogUElYSS5UaWNrZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50IGFjdGl2ZSBzY2VuZS9zdGFnZVxuICAgKi9cbiAgcm9vdDogU2NlbmU7XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsIHBoeXNpY3Mgd29ybGQgaW5zdGFuY2VcbiAgICovXG4gIHBoeXNpY3NXb3JsZD86IFBoeXNpY3NXb3JsZDtcblxuICAvKipcbiAgICogT3B0aW9uYWwgbG9nZ2luZyBmdW5jdGlvbiBmb3IgZGVidWdnaW5nXG4gICAqL1xuICBsb2dnZXI6IChtc2c6IHN0cmluZykgPT4gdm9pZDtcblxuICAvKipcbiAgICogSG93IG9mdGVuIHRvIGxvZyBtZXNzYWdlcyAoaW4gbWlsbGlzZWNvbmRzKVxuICAgKi9cbiAgbG9nZ2VyRnJlcXVlbmN5TXM6IG51bWJlcjtcblxuICAvKipcbiAgICogVGltZXN0YW1wIGZvciB0aGUgbmV4dCBsb2cgbWVzc2FnZVxuICAgKiBAaW50ZXJuYWxcbiAgICovXG4gIG5leHRMb2dUaW1lOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgRW5naW5lIGluc3RhbmNlXG4gICAqIFxuICAgKiBAcGFyYW0gc3RhZ2UgLSBUaGUgaW5pdGlhbCBzY2VuZSB0byB1c2UsIGlmIGFueVxuICAgKi9cbiAgY29uc3RydWN0b3Ioc3RhZ2U6IFNjZW5lID0gbnVsbCkge1xuICAgIHRoaXMucm9vdCA9IHN0YWdlO1xuXG4gICAgY29uc3QgdGlja2VyID0gUElYSS5UaWNrZXIuc2hhcmVkO1xuICAgIHRpY2tlci5hdXRvU3RhcnQgPSBmYWxzZTtcbiAgICB0aWNrZXIuYWRkKHRoaXMuZ2FtZUxvb3ApO1xuICAgIHRoaXMudGlja2VyID0gdGlja2VyO1xuXG4gICAgdGhpcy5sb2dnZXJGcmVxdWVuY3lNcyA9IDUwMDtcbiAgICB0aGlzLm5leHRMb2dUaW1lID0gMDtcbiAgICB0aGlzLmxvZ2dlciA9IChtc2cpID0+IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogU3RhcnRzIHRoZSBnYW1lIGxvb3BcbiAgICogXG4gICAqIEByZXR1cm5zIFRoZSBFbmdpbmUgaW5zdGFuY2UgZm9yIGNoYWluaW5nXG4gICAqL1xuICBzdGFydCgpIHtcbiAgICB0aGlzLnRpY2tlci5zdGFydCgpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3BzIHRoZSBnYW1lIGxvb3BcbiAgICogXG4gICAqIEByZXR1cm5zIFRoZSBFbmdpbmUgaW5zdGFuY2UgZm9yIGNoYWluaW5nXG4gICAqL1xuICBzdG9wKCkge1xuICAgIHRoaXMudGlja2VyLnN0b3AoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgcGh5c2ljcyB3b3JsZCB0byBlbmdpbmVcbiAgICpcbiAgICogQHBhcmFtIHBoeXNpY3NXb3JsZCAtIFRoZSBwaHlzaWNzIHdvcmxkIGluc3RhbmNlXG4gICAqIEByZXR1cm5zIFRoZSBFbmdpbmUgaW5zdGFuY2UgZm9yIGNoYWluaW5nXG4gICAqL1xuICBhZGRQaHlzaWNzV29ybGQocGh5c2ljc1dvcmxkOiBQaHlzaWNzV29ybGQpIHtcbiAgICB0aGlzLnBoeXNpY3NXb3JsZCA9IHBoeXNpY3NXb3JsZDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgbWFpbiBnYW1lIGxvb3AgZnVuY3Rpb24gY2FsbGVkIGJ5IHRoZSB0aWNrZXIgb24gZWFjaCBmcmFtZVxuICAgKiBVcGRhdGVzIGFuZCByZW5kZXJzIHRoZSBhY3RpdmUgc2NlbmVcbiAgICpcbiAgICogQHBhcmFtIHRpa2VyVGltZSAtIFRpY2tlciBpbmZvcm1hdGlvbiBpbmNsdWRpbmcgZGVsdGEgdGltZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2FtZUxvb3AgPSAodGlrZXJUaW1lOiBQSVhJLlRpY2tlcikgPT4ge1xuICAgIGlmICh0aGlzLnJvb3QpIHtcbiAgICAgIGNvbnN0IHsgZGVsdGFUaW1lLCBkZWx0YU1TIH0gPSB0aWtlclRpbWU7XG5cbiAgICAgIC8vIDEuIFVwZGF0ZSBwaHlzaWNzIHNpbXVsYXRpb24gRklSU1QgKG5lZWRzIGRlbHRhVGltZSBpbiBzZWNvbmRzKVxuICAgICAgaWYgKHRoaXMucGh5c2ljc1dvcmxkKSB7XG4gICAgICAgIGNvbnN0IGRlbHRhU2Vjb25kcyA9IGRlbHRhTVMgLyAxMDAwO1xuICAgICAgICB0aGlzLnBoeXNpY3NXb3JsZC5zdGVwKGRlbHRhU2Vjb25kcyk7XG4gICAgICB9XG5cbiAgICAgIC8vIDIuIFRoZW4gdXBkYXRlIGFsbCBsb2dpYyBjb21wb25lbnRzICh0aGV5IHVzZSBmcmFtZS1iYXNlZCBkZWx0YVRpbWUpXG4gICAgICB0aGlzLnJvb3QudXBkYXRlKGRlbHRhVGltZSk7XG4gICAgICB0aGlzLnJvb3QuZHJhdyhkZWx0YVRpbWUpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogU2V0cyBhIG5ldyBhY3RpdmUgc2NlbmVcbiAgICogXG4gICAqIEBwYXJhbSBzdGFnZSAtIFRoZSBuZXcgc2NlbmUgdG8gdXNlXG4gICAqIEByZXR1cm5zIFRoZSBFbmdpbmUgaW5zdGFuY2UgZm9yIGNoYWluaW5nXG4gICAqL1xuICBsb2FkU3RhZ2Uoc3RhZ2U6IFNjZW5lKSB7XG4gICAgdGhpcy5yb290ID0gc3RhZ2U7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn1cbiIsInR5cGUgTW94aUV2ZW50czxUIGV4dGVuZHMgc3RyaW5nIHwgc3ltYm9sID0gc3RyaW5nLCBBID0gYW55PiA9IHtcbiAgW2V2ZW50IGluIFRdOiAoLi4uYXJnczogQSBleHRlbmRzIGFueVtdID8gQSA6IFtBXSkgPT4gdm9pZDtcbn07XG5cbmV4cG9ydCBjbGFzcyBFdmVudEVtaXR0ZXI8VCBleHRlbmRzIE1veGlFdmVudHMgPSBNb3hpRXZlbnRzPiB7XG4gIHByaXZhdGUgbGlzdGVuZXJzOiB7IFtLIGluIGtleW9mIFRdPzogVFtLXVtdIH0gPSB7fTtcbiAgXG4gIC8qKlxuICAgKiBTaW5nbGV0b24gaW5zdGFuY2Ugb2YgRXZlbnRFbWl0dGVyXG4gICAqIEBzdGF0aWNcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgaW5zdGFuY2U6IEV2ZW50RW1pdHRlcjxNb3hpRXZlbnRzPiA9IG5ldyBFdmVudEVtaXR0ZXI8TW94aUV2ZW50cz4oKTtcblxuICBvbjxLIGV4dGVuZHMga2V5b2YgVD4oZXZlbnQ6IEssIGxpc3RlbmVyOiBUW0tdKTogdm9pZCB7XG4gICAgKHRoaXMubGlzdGVuZXJzW2V2ZW50XSB8fCAodGhpcy5saXN0ZW5lcnNbZXZlbnRdID0gW10pKS5wdXNoKGxpc3RlbmVyKTtcbiAgfVxuXG4gIG9mZjxLIGV4dGVuZHMga2V5b2YgVD4oZXZlbnQ6IEssIGxpc3RlbmVyOiBUW0tdKTogdm9pZCB7XG4gICAgY29uc3QgZXZlbnRMaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVyc1tldmVudF07XG4gICAgaWYgKGV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLmxpc3RlbmVyc1tldmVudF0gPSBldmVudExpc3RlbmVycy5maWx0ZXIobCA9PiBsICE9PSBsaXN0ZW5lcik7XG4gICAgfVxuICB9XG5cbiAgZW1pdDxLIGV4dGVuZHMga2V5b2YgVD4oZXZlbnQ6IEssIC4uLmFyZ3M6IFBhcmFtZXRlcnM8VFtLXT4pOiB2b2lkIHtcbiAgICAodGhpcy5saXN0ZW5lcnNbZXZlbnRdIHx8IFtdKS5mb3JFYWNoKGxpc3RlbmVyID0+IGxpc3RlbmVyKC4uLmFyZ3MpKTtcbiAgfVxuXG4gIG9uY2U8SyBleHRlbmRzIGtleW9mIFQ+KGV2ZW50OiBLLCBsaXN0ZW5lcjogVFtLXSk6IHZvaWQge1xuICAgIGNvbnN0IG9uY2VMaXN0ZW5lciA9ICguLi5hcmdzOiBQYXJhbWV0ZXJzPFRbS10+KSA9PiB7XG4gICAgICBsaXN0ZW5lciguLi5hcmdzKTtcbiAgICAgIHRoaXMub2ZmKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgfTtcbiAgICB0aGlzLm9uKGV2ZW50LCBvbmNlTGlzdGVuZXIgYXMgVFtLXSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZXQgdGhlIHNpbmdsZXRvbiBpbnN0YW5jZSBvZiBFdmVudEVtaXR0ZXJcbiAgICogQHN0YXRpY1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZTxUIGV4dGVuZHMgTW94aUV2ZW50cyA9IE1veGlFdmVudHM+KCk6IEV2ZW50RW1pdHRlcjxUPiB7XG4gICAgaWYgKCFFdmVudEVtaXR0ZXIuaW5zdGFuY2UpIHtcbiAgICAgIEV2ZW50RW1pdHRlci5pbnN0YW5jZSA9IG5ldyBFdmVudEVtaXR0ZXI8VD4oKTtcbiAgICB9XG4gICAgcmV0dXJuIEV2ZW50RW1pdHRlci5pbnN0YW5jZSBhcyBFdmVudEVtaXR0ZXI8VD47XG4gIH1cbn1cblxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbi8qKlxuICogQmFzZSBhYnN0cmFjdCBjbGFzcyBmb3IgYWxsIGxvZ2ljIGluIHRoZSBNb3hpIGVuZ2luZS5cbiAqIExvZ2ljIGNvbXBvbmVudHMgY2FuIGJlIGF0dGFjaGVkIHRvIGVudGl0aWVzIHRvIGFkZCBmdW5jdGlvbmFsaXR5LlxuICogXG4gKiBAY2F0ZWdvcnkgTG9naWNcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgZW50aXR5IHRoaXMgbG9naWMgY2FuIGJlIGF0dGFjaGVkIHRvXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjbGFzcyBNeUxvZ2ljIGV4dGVuZHMgTG9naWM8U3ByaXRlPiB7XG4gKiAgIHVwZGF0ZShlbnRpdHk6IFNwcml0ZSwgZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAqICAgICBlbnRpdHkucm90YXRpb24gKz0gZGVsdGFUaW1lO1xuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIExvZ2ljPFQ+IHtcbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoaXMgbG9naWMgY29tcG9uZW50XG4gICAqIFVzZWQgdG8gaWRlbnRpZnkgYW5kIHJldHJpZXZlIGxvZ2ljIGNvbXBvbmVudHNcbiAgICogRGVmYXVsdHMgdG8gY29uc3RydWN0b3IgbmFtZSBidXQgc2hvdWxkIGJlIHNldCBleHBsaWNpdGx5IGZvciBwcm9kdWN0aW9uIGJ1aWxkc1xuICAgKi9cbiAgbmFtZT86IHN0cmluZztcbiAgXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoaXMgbG9naWMgaXMgY3VycmVudGx5IGFjdGl2ZSBhbmQgc2hvdWxkIGJlIHVwZGF0ZWRcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgYWN0aXZlOiBib29sZWFuID0gdHJ1ZTtcbiAgXG4gIC8qKlxuICAgKiBJbml0aWFsaXplcyB0aGUgbG9naWMgd2l0aCB0aGUgZW50aXR5IGl0J3MgYXR0YWNoZWQgdG9cbiAgICogQHBhcmFtIGVudGl0eSAtIFRoZSBlbnRpdHkgdGhpcyBsb2dpYyBpcyBhdHRhY2hlZCB0b1xuICAgKiBAcGFyYW0gcmVuZGVyZXIgLSBUaGUgUElYSSByZW5kZXJlciBpbnN0YW5jZVxuICAgKiBAcGFyYW0gYXJncyAtIEFkZGl0aW9uYWwgaW5pdGlhbGl6YXRpb24gYXJndW1lbnRzXG4gICAqL1xuICBpbml0KGVudGl0eT86IFQsIHJlbmRlcmVyPzogUElYSS5SZW5kZXJlcjxIVE1MQ2FudmFzRWxlbWVudD4sIC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgLy8gSW1wbGVtZW50IGluIHN1YmNsYXNzXG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgbG9naWMncyBzdGF0ZVxuICAgKiBAcGFyYW0gZW50aXR5IC0gVGhlIGVudGl0eSB0aGlzIGxvZ2ljIGlzIGF0dGFjaGVkIHRvXG4gICAqIEBwYXJhbSBkZWx0YVRpbWUgLSBUaW1lIGVsYXBzZWQgc2luY2UgbGFzdCB1cGRhdGUgaW4gc2Vjb25kc1xuICAgKi9cbiAgdXBkYXRlKGVudGl0eT86IFQsIGRlbHRhVGltZT86IG51bWJlcikge1xuICAgIC8vIEltcGxlbWVudCBpbiBzdWJjbGFzc1xuICB9XG59XG5cbi8qKlxuICogTG9naWMgdGhhdCBjYW4gYmUgaW5zdGFudGlhdGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IGNvbmZpZ3VyYXRpb25zXG4gKiBcbiAqIEBjYXRlZ29yeSBMb2dpY1xuICogQHRlbXBsYXRlIFQgLSBUaGUgdHlwZSBvZiBlbnRpdHkgdGhpcyBsb2dpYyBjYW4gYmUgYXR0YWNoZWQgdG9cbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNsYXNzIE15SW5zdGFuY2VkTG9naWMgZXh0ZW5kcyBJbnN0YW5jZWRMb2dpYzxTcHJpdGU+IHtcbiAqICAgY29uc3RydWN0b3IocHVibGljIHNwZWVkOiBudW1iZXIpIHtcbiAqICAgICBzdXBlcigpO1xuICogICB9XG4gKiAgIFxuICogICB1cGRhdGUoZW50aXR5OiBTcHJpdGUsIGRlbHRhVGltZTogbnVtYmVyKSB7XG4gKiAgICAgZW50aXR5LnJvdGF0aW9uICs9IHRoaXMuc3BlZWQgKiBkZWx0YVRpbWU7XG4gKiAgIH1cbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgSW5zdGFuY2VkTG9naWM8VD4gZXh0ZW5kcyBMb2dpYzxUPiB7fVxuXG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IExvZ2ljIH0gZnJvbSAnLi9sb2dpYyc7XG5cbi8qKlxuICogSW50ZXJmYWNlIGRlZmluaW5nIHRoZSBjb250cmFjdCBmb3IgdGhlIE1veGlFbnRpdHkgY2xhc3MuXG4gKiBTcGVjaWZpZXMgcmVxdWlyZWQgbWV0aG9kcyBhbmQgcHJvcGVydGllcyBmb3IgZW50aXR5IG1hbmFnZW1lbnQuXG4gKiBcbiAqIEBpbnRlcm5hbFxuICogQHRlbXBsYXRlIFQgLSBUaGUgdHlwZSBvZiBlbnRpdHkgYmVpbmcgbWFuYWdlZFxuICovXG5pbnRlcmZhY2UgTW94aUVudGl0eUNsYXNzPFQ+IHtcbiAgbG9naWM6IE1veGlMb2dpYzxUPjtcbiAgdXBkYXRlOiAoZGVsdGE6IG51bWJlciwgZW50aXR5OiBUKSA9PiB2b2lkO1xuICBpbml0OiAoLi4uYXJnczogYW55W10pID0+IHZvaWQ7XG4gIGFkZExvZ2ljOiAobG9naWM6IExvZ2ljPFQ+KSA9PiB2b2lkO1xuICBnZXRMb2dpYzogKG5hbWU6IHN0cmluZykgPT4gTG9naWM8VD4gfCB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogVHlwZSBkZWZpbml0aW9uIGZvciBvYmplY3RzIHRoYXQgaGF2ZSBiZWVuIGVuaGFuY2VkIHdpdGggTW94aUVudGl0eSBjYXBhYmlsaXRpZXMuXG4gKiBUaGlzIGlzIHRoZSBwcmltYXJ5IGludGVyZmFjZSBkZXZlbG9wZXJzIHdpbGwgaW50ZXJhY3Qgd2l0aCB3aGVuIHVzaW5nIHRoZSBlbnRpdHkgc3lzdGVtLlxuICogXG4gKiBAY2F0ZWdvcnkgRW50aXRpZXNcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgZW50aXR5IGJlaW5nIG1hbmFnZWQgKHR5cGljYWxseSBleHRlbmRzIFBJWEkuQ29udGFpbmVyKVxuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogLy8gQ3JlYXRlIGEgc3ByaXRlIGFuZCBjb252ZXJ0IGl0IHRvIGFuIEFzRW50aXR5XG4gKiBjb25zdCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gKiBjb25zdCBlbnRpdHlTcHJpdGUgPSBhc0VudGl0eShzcHJpdGUpO1xuICogXG4gKiAvLyBOb3cgaXQgaGFzIGEgbW94aUVudGl0eSBwcm9wZXJ0eVxuICogZW50aXR5U3ByaXRlLm1veGlFbnRpdHkuYWRkTG9naWMobmV3IE1vdmVtZW50TG9naWMoKSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IHR5cGUgQXNFbnRpdHk8VD4gPSBQSVhJLkNvbnRhaW5lciAmIHtcbiAgbW94aUVudGl0eTogTW94aUVudGl0eTxUPjtcbn07XG5cbi8qKlxuICogVHlwZSBkZWZpbml0aW9uIGZvciBhIGNvbGxlY3Rpb24gb2YgbG9naWMgY29tcG9uZW50cyBtYXBwZWQgYnkgbmFtZS5cbiAqIFVzZWQgdG8gc3RvcmUgYW5kIHJldHJpZXZlIGxvZ2ljIGF0dGFjaGVkIHRvIGVudGl0aWVzLlxuICogXG4gKiBAY2F0ZWdvcnkgRW50aXRpZXNcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgZW50aXR5IHRoZXNlIGxvZ2ljIGNvbXBvbmVudHMgY2FuIGJlIGFwcGxpZWQgdG9cbiAqL1xuZXhwb3J0IHR5cGUgTW94aUxvZ2ljPFQ+ID0gUmVjb3JkPHN0cmluZywgTG9naWM8VD4+O1xuXG4vKipcbiAqIFRoZSBjb3JlIGVudGl0eSBtYW5hZ2VtZW50IGNsYXNzIHRoYXQgaGFuZGxlcyBjb21wb25lbnQtYmFzZWQgbG9naWMuXG4gKiBNb3hpRW50aXR5IGNvbm5lY3RzIGVudGl0aWVzIHdpdGggdGhlaXIgbG9naWMgY29tcG9uZW50cyBhbmQgbWFuYWdlcyB0aGUgbG9naWMgbGlmZWN5Y2xlLlxuICogXG4gKiBUaGlzIGNsYXNzIGltcGxlbWVudHMgdGhlIEVudGl0eS1Db21wb25lbnQtU3lzdGVtIHBhdHRlcm4sIHdoZXJlOlxuICogLSBUaGUgZW50aXR5IGlzIHRoZSBvYmplY3QgYmVpbmcgY29udHJvbGxlZCAobGlrZSBhIFBJWEkuU3ByaXRlKVxuICogLSBMb2dpYyBjb21wb25lbnRzIGFkZCBmdW5jdGlvbmFsaXR5XG4gKiAtIFRoaXMgY2xhc3MgcHJvdmlkZXMgdGhlIHN5c3RlbSB0byBtYW5hZ2UgdGhvc2UgY29tcG9uZW50c1xuICogXG4gKiBAY2F0ZWdvcnkgRW50aXRpZXNcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgZW50aXR5IGJlaW5nIG1hbmFnZWRcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIC8vIENyZWF0ZSBhIHNwcml0ZSBhbmQgZW50aXR5XG4gKiBjb25zdCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gKiBjb25zdCBlbnRpdHkgPSBuZXcgTW94aUVudGl0eShzcHJpdGUpO1xuICogXG4gKiAvLyBBZGQgbG9naWNcbiAqIGVudGl0eS5hZGRMb2dpYyhuZXcgTW92ZW1lbnRMb2dpYygpKTtcbiAqIGVudGl0eS5hZGRMb2dpYyhuZXcgQW5pbWF0aW9uTG9naWMoKSk7XG4gKiBcbiAqIC8vIEluaXRpYWxpemUgYWxsIGxvZ2ljXG4gKiBlbnRpdHkuaW5pdChyZW5kZXJlcik7XG4gKiBcbiAqIC8vIFVwZGF0ZSBhbGwgbG9naWMgKHVzdWFsbHkgY2FsbGVkIHdpdGhpbiB0aGUgZ2FtZSBsb29wKVxuICogZW50aXR5LnVwZGF0ZShkZWx0YVRpbWUpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBNb3hpRW50aXR5PFQ+IGltcGxlbWVudHMgTW94aUVudGl0eUNsYXNzPFQ+IHtcbiAgLyoqXG4gICAqIENvbGxlY3Rpb24gb2YgbG9naWMgY29tcG9uZW50cyBhdHRhY2hlZCB0byB0aGlzIGVudGl0eVxuICAgKi9cbiAgbG9naWM6IE1veGlMb2dpYzxUPiA9IHt9O1xuICBcbiAgLyoqXG4gICAqIFJlZmVyZW5jZSB0byB0aGUgYWN0dWFsIGVudGl0eSBiZWluZyBtYW5hZ2VkXG4gICAqL1xuICBlbnRpdHk6IFQ7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgTW94aUVudGl0eVxuICAgKiBcbiAgICogQHBhcmFtIGVudGl0eSAtIFRoZSBlbnRpdHkgdG8gbWFuYWdlXG4gICAqIEBwYXJhbSBsb2dpYyAtIE9wdGlvbmFsIG1hcCBvZiBpbml0aWFsIGxvZ2ljIHRvIGF0dGFjaFxuICAgKi9cbiAgY29uc3RydWN0b3IoZW50aXR5OiBULCBsb2dpYzogTW94aUxvZ2ljPFQ+ID0ge30pIHtcbiAgICB0aGlzLmxvZ2ljID0gbG9naWM7XG4gICAgdGhpcy5lbnRpdHkgPSBlbnRpdHk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyBhbGwgYWN0aXZlIGxvZ2ljIGNvbXBvbmVudHMgYXR0YWNoZWQgdG8gdGhpcyBlbnRpdHlcbiAgICogVHlwaWNhbGx5IGNhbGxlZCBlYWNoIGZyYW1lIGR1cmluZyB0aGUgZ2FtZSBsb29wXG4gICAqIFxuICAgKiBAcGFyYW0gZGVsdGFUaW1lIC0gVGltZSBpbiBzZWNvbmRzIHNpbmNlIHRoZSBsYXN0IHVwZGF0ZVxuICAgKiBcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiAvLyBJbiBnYW1lIGxvb3BcbiAgICogZnVuY3Rpb24gZ2FtZUxvb3AoZGVsdGFUaW1lKSB7XG4gICAqICAgcGxheWVyRW50aXR5Lm1veGlFbnRpdHkudXBkYXRlKGRlbHRhVGltZSk7XG4gICAqIH1cbiAgICogYGBgXG4gICAqL1xuICB1cGRhdGUoZGVsdGFUaW1lOiBudW1iZXIpIHsgXG4gICAgZm9yIChjb25zdCBjbGFzc05hbWUgaW4gdGhpcy5sb2dpYykge1xuICAgICAgY29uc3QgbG9naWNDb21wb25lbnQgPSB0aGlzLmxvZ2ljW2NsYXNzTmFtZV07XG4gICAgICBpZihsb2dpY0NvbXBvbmVudC51cGRhdGUgJiYgdGhpcy5lbnRpdHkgJiYgbG9naWNDb21wb25lbnQuYWN0aXZlKXtcbiAgICAgICAgbG9naWNDb21wb25lbnQudXBkYXRlKHRoaXMuZW50aXR5LCBkZWx0YVRpbWUpOyBcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gVE9ETzogdXBkYXRlIGNoaWxkcmVuP1xuICB9XG4gIFxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgYWxsIGxvZ2ljIGNvbXBvbmVudHMgYXR0YWNoZWQgdG8gdGhpcyBlbnRpdHlcbiAgICogVHlwaWNhbGx5IGNhbGxlZCBvbmNlIHdoZW4gdGhlIGVudGl0eSBpcyBmaXJzdCBjcmVhdGVkIG9yIGFkZGVkIHRvIHRoZSBzY2VuZVxuICAgKiBcbiAgICogQHBhcmFtIHJlbmRlcmVyIC0gVGhlIFBJWEkgcmVuZGVyZXIgaW5zdGFuY2VcbiAgICogQHBhcmFtIGFyZ3MgLSBBZGRpdGlvbmFsIGFyZ3VtZW50cyB0byBwYXNzIHRvIGVhY2ggbG9naWMgY29tcG9uZW50J3MgaW5pdCBtZXRob2RcbiAgICogXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogLy8gV2hlbiBhZGRpbmcgYW4gZW50aXR5IHRvIHRoZSBzY2VuZVxuICAgKiBzY2VuZS5hZGRDaGlsZChlbnRpdHlTcHJpdGUpO1xuICAgKiBlbnRpdHlTcHJpdGUubW94aUVudGl0eS5pbml0KHJlbmRlcmVyKTtcbiAgICogYGBgXG4gICAqL1xuICBpbml0KHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyPEhUTUxDYW52YXNFbGVtZW50PiwgLi4uYXJnczogYW55W10pIHtcbiAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBpbiB0aGlzLmxvZ2ljKSB7XG4gICAgICBjb25zdCBsb2dpY0NvbXBvbmVudCA9IHRoaXMubG9naWNbY2xhc3NOYW1lXTtcbiAgICAgIGlmKGxvZ2ljQ29tcG9uZW50LmluaXQgJiYgdGhpcy5lbnRpdHkpe1xuICAgICAgICBsb2dpY0NvbXBvbmVudC5pbml0KHRoaXMuZW50aXR5LCByZW5kZXJlciwgLi4uYXJncyk7XG4gICAgICB9XG4gICAgfVxuICB9IFxuXG4gIC8qKlxuICAgKiBBZGRzIGEgbG9naWMgY29tcG9uZW50IHRvIHRoaXMgZW50aXR5XG4gICAqIFxuICAgKiBAcGFyYW0gbG9naWMgLSBUaGUgbG9naWMgY29tcG9uZW50IHRvIGFkZFxuICAgKiBcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiAvLyBDcmVhdGUgYW5kIGFkZCBsb2dpY1xuICAgKiBjb25zdCBtb3ZlbWVudExvZ2ljID0gbmV3IE1vdmVtZW50TG9naWMoKTtcbiAgICogbW92ZW1lbnRMb2dpYy5zcGVlZCA9IDU7XG4gICAqIGVudGl0eVNwcml0ZS5tb3hpRW50aXR5LmFkZExvZ2ljKG1vdmVtZW50TG9naWMpO1xuICAgKiBgYGBcbiAgICovXG4gIGFkZExvZ2ljKGxvZ2ljOiBMb2dpYzxUPikge1xuICAgIC8vIFVzZSBleHBsaWNpdCBuYW1lIGlmIHNldCwgb3RoZXJ3aXNlIGZhbGwgYmFjayB0byBjb25zdHJ1Y3RvciBuYW1lXG4gICAgY29uc3QgbG9naWNOYW1lID0gbG9naWMubmFtZSB8fCBsb2dpYy5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgIHRoaXMubG9naWNbbG9naWNOYW1lXSA9IGxvZ2ljO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHJpZXZlcyBhIGxvZ2ljIGNvbXBvbmVudCBieSBuYW1lXG4gICAqIFVzZWZ1bCBmb3IgYWNjZXNzaW5nIGFuZCBjb25maWd1cmluZyBzcGVjaWZpYyBsb2dpYyBjb21wb25lbnRzXG4gICAqIFxuICAgKiBAdGVtcGxhdGUgTCAtIFRoZSB0eXBlIG9mIGxvZ2ljIHRvIHJldHVyblxuICAgKiBAcGFyYW0gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBsb2dpYyB0byByZXRyaWV2ZSAodXN1YWxseSB0aGUgY2xhc3MgbmFtZSlcbiAgICogQHJldHVybnMgVGhlIGxvZ2ljIGluc3RhbmNlLCBvciB1bmRlZmluZWQgaWYgbm90IGZvdW5kXG4gICAqIFxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIC8vIEdldCBhbmQgY29uZmlndXJlIGxvZ2ljXG4gICAqIGNvbnN0IG1vdmVtZW50ID0gZW50aXR5U3ByaXRlLm1veGlFbnRpdHkuZ2V0TG9naWM8TW92ZW1lbnRMb2dpYz4oJ01vdmVtZW50TG9naWMnKTtcbiAgICogaWYgKG1vdmVtZW50KSB7XG4gICAqICAgbW92ZW1lbnQuc3BlZWQgPSAxMDtcbiAgICogICBtb3ZlbWVudC5kaXJlY3Rpb24gPSAncmlnaHQnO1xuICAgKiB9XG4gICAqIGBgYFxuICAgKi9cbiAgZ2V0TG9naWM8TCBleHRlbmRzIExvZ2ljPFQ+PihuYW1lOiBzdHJpbmcpOiBMIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5sb2dpY1tuYW1lXSBhcyBMIHwgdW5kZWZpbmVkO1xuICB9XG59XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgYSBQSVhJIENvbnRhaW5lciBpbnRvIGFuIEFzRW50aXR5XG4gKiBUaGlzIGlzIHRoZSBwcmltYXJ5IHdheSB0byBjcmVhdGUgZW50aXRpZXMgaW4gTW94aVxuICogXG4gKiBAY2F0ZWdvcnkgRW50aXRpZXNcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgY29udGFpbmVyIGJlaW5nIGNvbnZlcnRlZFxuICogQHBhcmFtIGVudGl0eSAtIFRoZSBQSVhJIENvbnRhaW5lciB0byBjb252ZXJ0XG4gKiBAcGFyYW0gbG9naWMgLSBPcHRpb25hbCBpbml0aWFsIGxvZ2ljIHRvIGF0dGFjaFxuICogQHJldHVybnMgVGhlIGVuaGFuY2VkIGNvbnRhaW5lciBhcyBhbiBBc0VudGl0eVxuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogLy8gQmFzaWMgdXNhZ2VcbiAqIGNvbnN0IHNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZSh0ZXh0dXJlKTtcbiAqIGNvbnN0IGVudGl0eVNwcml0ZSA9IGFzRW50aXR5KHNwcml0ZSk7XG4gKiBzY2VuZS5hZGRDaGlsZChlbnRpdHlTcHJpdGUpO1xuICogXG4gKiAvLyBXaXRoIGluaXRpYWwgbG9naWNcbiAqIGNvbnN0IHBsYXllciA9IGFzRW50aXR5KFxuICogICBuZXcgUElYSS5TcHJpdGUocGxheWVyVGV4dHVyZSksXG4gKiAgIHtcbiAqICAgICAnUGxheWVyTW92ZW1lbnQnOiBuZXcgUGxheWVyTW92ZW1lbnRMb2dpYygpLFxuICogICAgICdIZWFsdGgnOiBuZXcgSGVhbHRoTG9naWMoMTAwKVxuICogICB9XG4gKiApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc0VudGl0eTxUIGV4dGVuZHMgUElYSS5Db250YWluZXI+KGVudGl0eTogVCwgbG9naWM6IE1veGlMb2dpYzxUPiA9IHt9KTogQXNFbnRpdHk8VD4ge1xuICBjb25zdCB0YXJnZXQgPSBlbnRpdHk7XG4gIFxuICAvLyBwaXhpIHBhdGNoOiBpdCdzIHRocm93aW5nIGFuIGVycm9yIG9uIGludGVyYWN0aXZlIGV2ZW50cyBpZiBpc0ludGVyYWN0aXZlKCkgZG9lc24ndCBleGlzdC5cbiAgdGFyZ2V0LmlzSW50ZXJhY3RpdmUgPSAoKSA9PiBmYWxzZTsgXG5cbiAgKHRhcmdldCBhcyB1bmtub3duIGFzIEFzRW50aXR5PFQ+KS5tb3hpRW50aXR5ID0gbmV3IE1veGlFbnRpdHk8VD4odGFyZ2V0LCBsb2dpYyk7XG4gIHJldHVybiBlbnRpdHkgYXMgdW5rbm93biBhcyBBc0VudGl0eTxUPjtcbn1cblxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbmV4cG9ydCBjbGFzcyBSZW5kZXJNYW5hZ2VyIHtcbiAgc3RhdGljIGdldFJlbmRlcmVyOiAoXG4gICAgb3B0aW9uczogUGFydGlhbDxQSVhJLkF1dG9EZXRlY3RPcHRpb25zPlxuICApID0+IFByb21pc2U8UElYSS5SZW5kZXJlcj47XG5cbiAgc3RhdGljIGNyZWF0ZTogKFxuICAgICAgaHRtbFJvb3Q6IEhUTUxFbGVtZW50LCBcbiAgICAgIG9wdGlvbnM6IFBhcnRpYWw8UElYSS5BdXRvRGV0ZWN0T3B0aW9ucz4pID0+IFByb21pc2U8UmVuZGVyTWFuYWdlcj47XG5cbiAgaHRtbFJvb3Q6IEhUTUxFbGVtZW50O1xuICByZW5kZXJlcjogUElYSS5SZW5kZXJlcjtcbiAgZml0VG9XaW5kb3cgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihodG1sUm9vdDogSFRNTEVsZW1lbnQsIHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyKSB7XG4gICAgdGhpcy5odG1sUm9vdCA9IGh0bWxSb290O1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcblxuICAgIGh0bWxSb290LmFwcGVuZENoaWxkKHRoaXMucmVuZGVyZXIuY2FudmFzKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gdGhpcy5vblJlc2l6ZSgpKTtcbiAgICB0aGlzLm9uUmVzaXplKCk7XG4gIH1cblxuICByZW5kZXIoc3RhZ2U6IFBJWEkuQ29udGFpbmVyKSB7XG4gICAgdGhpcy5yZW5kZXJlci5yZW5kZXIoc3RhZ2UpO1xuICB9XG5cbiAgb25SZXNpemUgPSAoKSA9PiB7XG4gICAgY29uc3QgeyByZW5kZXJlciwgaHRtbFJvb3Q6IHJvb3QgfSA9IHRoaXM7XG4gICAgY29uc3QgY2FudmFzID0gcmVuZGVyZXIuY2FudmFzO1xuICAgIFxuICAgIC8vIEdldCB0aGUgcGFyZW50IGRpbWVuc2lvbnNcbiAgICBjb25zdCBwYXJlbnRXaWR0aCA9IHJvb3QuY2xpZW50V2lkdGg7XG4gICAgY29uc3QgcGFyZW50SGVpZ2h0ID0gcm9vdC5jbGllbnRIZWlnaHQ7XG4gICAgXG4gICAgLy8gR2V0IHRoZSBjYW52YXMncyBpbnRlbmRlZCBkaW1lbnNpb25zXG4gICAgY29uc3QgY2FudmFzV2lkdGggPSByZW5kZXJlci53aWR0aDtcbiAgICBjb25zdCBjYW52YXNIZWlnaHQgPSByZW5kZXJlci5oZWlnaHQ7XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIHRoZSBzY2FsZSB0byBmaXQgd2hpbGUgbWFpbnRhaW5pbmcgYXNwZWN0IHJhdGlvXG4gICAgY29uc3Qgc2NhbGUgPSBNYXRoLm1pbihcbiAgICAgIHBhcmVudFdpZHRoIC8gY2FudmFzV2lkdGgsXG4gICAgICBwYXJlbnRIZWlnaHQgLyBjYW52YXNIZWlnaHRcbiAgICApO1xuICAgIFxuICAgIC8vIFNldCBDU1MgZGltZW5zaW9ucyB0byBzY2FsZSB0aGUgY2FudmFzXG4gICAgY2FudmFzLnN0eWxlLndpZHRoID0gYCR7TWF0aC5mbG9vcihjYW52YXNXaWR0aCAqIHNjYWxlKX1weGA7XG4gICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IGAke01hdGguZmxvb3IoY2FudmFzSGVpZ2h0ICogc2NhbGUpfXB4YDtcbiAgfTtcbn1cblxuUmVuZGVyTWFuYWdlci5nZXRSZW5kZXJlciA9IGFzeW5jIChvcHRpb25zOiBQYXJ0aWFsPFBJWEkuQXV0b0RldGVjdE9wdGlvbnM+KSA9PiAoXG4gIGF3YWl0IFBJWEkuYXV0b0RldGVjdFJlbmRlcmVyKG9wdGlvbnMpXG4pO1xuXG5SZW5kZXJNYW5hZ2VyLmNyZWF0ZSA9IGFzeW5jIChodG1sUm9vdDogSFRNTEVsZW1lbnQsIG9wdGlvbnM6IFBhcnRpYWw8UElYSS5BdXRvRGV0ZWN0T3B0aW9ucz4pID0+IChcbiAgbmV3IFJlbmRlck1hbmFnZXIoaHRtbFJvb3QsIGF3YWl0IFJlbmRlck1hbmFnZXIuZ2V0UmVuZGVyZXIob3B0aW9ucykpXG4pO1xuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBBc0VudGl0eSB9IGZyb20gJy4vbW94aS1lbnRpdHknO1xuXG5mdW5jdGlvbiBpc01veGlFbnRpdHk8VCBleHRlbmRzIFBJWEkuQ29udGFpbmVyPihlbnRpdHk6IHVua25vd24pOiBlbnRpdHkgaXMgQXNFbnRpdHk8VD4ge1xuICByZXR1cm4gZW50aXR5ICE9IG51bGwgJiYgdHlwZW9mIGVudGl0eSA9PT0gJ29iamVjdCcgJiYgJ21veGlFbnRpdHknIGluIGVudGl0eTtcbn1cblxuZXhwb3J0IGNsYXNzIFNjZW5lIGV4dGVuZHMgUElYSS5Db250YWluZXIge1xuICByZW5kZXJlcjogUElYSS5SZW5kZXJlcjxIVE1MQ2FudmFzRWxlbWVudD47XG5cbiAgY29uc3RydWN0b3IocmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI8SFRNTENhbnZhc0VsZW1lbnQ+KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gIH1cblxuICBpbml0KCkge1xuICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgIGlmIChpc01veGlFbnRpdHkoY2hpbGQpKSB7XG4gICAgICAgIGNoaWxkLm1veGlFbnRpdHkuaW5pdCh0aGlzLnJlbmRlcmVyKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG5cbiAgdXBkYXRlKGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgdGhpcy5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZCkgPT4ge1xuICAgICAgaWYgKGlzTW94aUVudGl0eShjaGlsZCkpIHtcbiAgICAgICAgY2hpbGQubW94aUVudGl0eS51cGRhdGUoZGVsdGFUaW1lKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGRyYXcoZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcih0aGlzKTtcbiAgfVxufSIsImltcG9ydCAqIGFzIHV0aWxzIGZyb20gJy4vbGlicmFyeS91dGlscyc7XG5pbXBvcnQgeyBSZW5kZXJNYW5hZ2VyIH0gZnJvbSAnLi9jb3JlL3JlbmRlci1tYW5hZ2VyJztcbmltcG9ydCB7IFNjZW5lIH0gZnJvbSAnLi9jb3JlL3NjZW5lJztcbmltcG9ydCB7IEVuZ2luZSB9IGZyb20gJy4vY29yZS9lbmdpbmUnO1xuaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnLi9jb3JlL2V2ZW50LXN5c3RlbSc7XG5pbXBvcnQgeyBDbGllbnRFdmVudHMgfSBmcm9tICcuL2xpYnJhcnkvY2xpZW50LWV2ZW50cyc7XG5pbXBvcnQgeyBBc3NldExvYWRlciB9IGZyb20gJy4vY29yZS9hc3NldC1sb2FkZXInO1xuaW1wb3J0IHsgUG9pbnQgfSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IExvZ2ljIH0gZnJvbSAnLi9jb3JlL2xvZ2ljJztcbmltcG9ydCB7IGRlZmF1bHRSZW5kZXJPcHRpb25zLCBzZXR1cE1veGkgfSBmcm9tICcuL2xpYnJhcnkvc2V0dXAnO1xuaW1wb3J0IHsgbG9hZEZvbnRzIH0gZnJvbSAnLi9saWJyYXJ5L2ZvbnQtbG9hZGVyJztcbmltcG9ydCB7IGFzRW50aXR5LCBNb3hpRW50aXR5IH0gZnJvbSAnLi9jb3JlL21veGktZW50aXR5JztcbmltcG9ydCB7IENhbWVyYSwgQ2FtZXJhTG9naWMgfSBmcm9tICcuL2NvcmUvY2FtZXJhJztcbmltcG9ydCB7IGFzVGV4dHVyZUZyYW1lcyB9IGZyb20gJy4vbGlicmFyeS90ZXh0dXJlLWZyYW1lcyc7XG5pbXBvcnQgeyBhc0JpdG1hcFRleHQsIGFzU3ByaXRlLCBhc1RleHQsIGFzR3JhcGhpY3MsIGFzQ29udGFpbmVyLCBQaXhpUHJvcHMgfSBmcm9tICcuL2xpYnJhcnkvYXMtcGl4aSc7XG5pbXBvcnQgeyBUZXh0dXJlRnJhbWVTZXF1ZW5jZXMsIFNlcXVlbmNlSW5mbyB9IGZyb20gJy4vbGlicmFyeS90ZXh0dXJlLWZyYW1lLXNlcXVlbmNlcyc7XG5pbXBvcnQgeyBjcmVhdGVSZXNpemVIYW5kbGVyLCBzZXR1cFJlc3BvbnNpdmVDYW52YXMsIFJlc2l6ZUhhbmRsZXJPcHRpb25zIH0gZnJvbSAnLi9saWJyYXJ5L3Jlc2l6ZS1oYW5kbGVyJztcbmltcG9ydCB7IEVkZ2VJbnNldHMgfSBmcm9tICcuL3VpL2NvcmUvZWRnZS1pbnNldHMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuL3VpL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IFVJRm9jdXNNYW5hZ2VyIH0gZnJvbSAnLi91aS9jb3JlL3VpLWZvY3VzLW1hbmFnZXInO1xuaW1wb3J0IHsgRmxleENvbnRhaW5lciwgRmxleERpcmVjdGlvbiwgRmxleEp1c3RpZnksIEZsZXhBbGlnbiB9IGZyb20gJy4vdWkvbGF5b3V0L2ZsZXgtY29udGFpbmVyJztcbmltcG9ydCB7IFVJQm94IH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWJveCc7XG5pbXBvcnQgeyBVSUxhYmVsIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWxhYmVsJztcbmltcG9ydCB7IFVJUGFuZWwgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktcGFuZWwnO1xuaW1wb3J0IHsgVUlCdXR0b24sIEJ1dHRvblN0YXRlIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWJ1dHRvbic7XG5pbXBvcnQgeyBVSVNlbGVjdCwgU2VsZWN0T3B0aW9uIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXNlbGVjdCc7XG5pbXBvcnQgeyBVSVRleHRJbnB1dCB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS10ZXh0LWlucHV0JztcbmltcG9ydCB7IFVJVGV4dEFyZWEgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktdGV4dGFyZWEnO1xuaW1wb3J0IHsgVUlTY3JvbGxDb250YWluZXIgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktc2Nyb2xsLWNvbnRhaW5lcic7XG5pbXBvcnQgeyBVSVRhYnMsIFRhYkl0ZW0gfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktdGFicyc7XG5pbXBvcnQgeyBVSUxheWVyIH0gZnJvbSAnLi91aS9VSUxheWVyJztcbmltcG9ydCB7IFVJU2NhbGVNb2RlIH0gZnJvbSAnLi91aS9VSVNjYWxlTW9kZSc7XG5pbXBvcnQgeyBTdGF0ZU1hY2hpbmUgfSBmcm9tICcuL2xpYnJhcnkvc3RhdGUtbWFjaGluZSc7XG5pbXBvcnQgeyBTdGF0ZUxvZ2ljIH0gZnJvbSAnLi9saWJyYXJ5L3N0YXRlLWxvZ2ljJztcbmltcG9ydCB7IGNyZWF0ZVRpbGVHcmlkLCBnZXRUZXh0dXJlUmFuZ2UgfSBmcm9tICcuL2xpYnJhcnkvZ3JpZC1nZW5lcmF0b3InO1xuaW1wb3J0IHsgc3ZnVG9UZXh0dXJlIH0gZnJvbSAnLi9saWJyYXJ5L3N2Zy11dGlscy9zdmctdG8tdGV4dHVyZSc7XG5pbXBvcnQgeyBQaXhlbEdyaWQsIHB4LCB1bml0cywgR1JJRCwgQk9SREVSLCBjcmVhdGVCb3JkZXJDb25maWcgfSBmcm9tICcuL3VpL3BpeGVsLWdyaWQnO1xuaW1wb3J0IHsgUGFyYWxsYXhCYWNrZ3JvdW5kLCBQYXJhbGxheEJhY2tncm91bmRMb2dpYyB9IGZyb20gJy4vbGlicmFyeS9wYXJhbGxheC1iYWNrZ3JvdW5kJztcbmltcG9ydCB7IFBhcmFsbGF4TGF5ZXIsIFRpbGluZ1BhcmFsbGF4TGF5ZXIgfSBmcm9tICcuL2xpYnJhcnkvcGFyYWxsYXgtbGF5ZXInO1xuaW1wb3J0IHsgTG9hZGluZ1NjZW5lIH0gZnJvbSAnLi9saWJyYXJ5L2xvYWRpbmctc2NlbmUnO1xuaW1wb3J0IHtcbiAgUGh5c2ljc1dvcmxkLFxuICBQaHlzaWNzQm9keUxvZ2ljLFxuICBQaHlzaWNzRGVidWdSZW5kZXJlcixcbiAgQ29sbGlzaW9uUmVnaXN0cnksXG4gIENvbGxpc2lvbk1hbmFnZXIsXG4gIGFzUGh5c2ljc0VudGl0eSxcbiAgaGFzUGh5c2ljcyxcbiAgZ2V0UGh5c2ljc0JvZHksXG4gIGNyZWF0ZVNoYXBlRnJvbVNwcml0ZSxcbiAgUGh5c2ljc01hdGVyaWFscyxcbiAgYXBwbHlNYXRlcmlhbFxufSBmcm9tICcuL2xpYnJhcnkvcGh5c2ljcyc7XG5cbmV4cG9ydCB0eXBlIHsgU3RhdGVDaGFuZ2VFdmVudCB9IGZyb20gJy4vbGlicmFyeS9zdGF0ZS1tYWNoaW5lJztcbmV4cG9ydCB0eXBlIHsgQXNFbnRpdHksIE1veGlMb2dpYyB9IGZyb20gJy4vY29yZS9tb3hpLWVudGl0eSc7XG5leHBvcnQgdHlwZSB7IEFzVGV4dHVyZUZyYW1lc09wdGlvbnMgfSBmcm9tICcuL2xpYnJhcnkvdGV4dHVyZS1mcmFtZXMnO1xuZXhwb3J0IHR5cGUgeyBHcmlkT3B0aW9ucywgQ2VsbFBvc2l0aW9uIH0gZnJvbSAnLi9saWJyYXJ5L2dyaWQtZ2VuZXJhdG9yJztcbmV4cG9ydCB0eXBlIHsgUGFyYWxsYXhCYWNrZ3JvdW5kT3B0aW9ucyB9IGZyb20gJy4vbGlicmFyeS9wYXJhbGxheC1iYWNrZ3JvdW5kJztcbmV4cG9ydCB0eXBlIHsgUGFyYWxsYXhMYXllck9wdGlvbnMsIFRpbGluZ1BhcmFsbGF4TGF5ZXJPcHRpb25zIH0gZnJvbSAnLi9saWJyYXJ5L3BhcmFsbGF4LWxheWVyJztcbmV4cG9ydCB0eXBlIHsgTG9hZGluZ1NjZW5lT3B0aW9ucyB9IGZyb20gJy4vbGlicmFyeS9sb2FkaW5nLXNjZW5lJztcbmV4cG9ydCB0eXBlIHtcbiAgQm9keVR5cGUsXG4gIFN5bmNNb2RlLFxuICBTaGFwZVR5cGUsXG4gIENvbGxpc2lvblRhZyxcbiAgU2hhcGVDb25maWcsXG4gIFBoeXNpY3NXb3JsZE9wdGlvbnMsXG4gIFBoeXNpY3NCb2R5T3B0aW9ucyxcbiAgUGh5c2ljc0RlYnVnT3B0aW9ucyxcbiAgQ29sbGlzaW9uRXZlbnQsXG4gIFJheWNhc3RDYWxsYmFja1xufSBmcm9tICcuL2xpYnJhcnkvcGh5c2ljcyc7XG5leHBvcnQgdHlwZSB7IEJveE1vZGVsLCBDb21wdXRlZExheW91dCwgTWVhc3VyZWRTaXplLCBTaXplQ29uc3RyYWludCB9IGZyb20gJy4vdWkvY29yZS9ib3gtbW9kZWwnO1xuZXhwb3J0IHR5cGUgeyBGbGV4Q29udGFpbmVyUHJvcHMgfSBmcm9tICcuL3VpL2xheW91dC9mbGV4LWNvbnRhaW5lcic7XG5leHBvcnQgdHlwZSB7IFVJQm94UHJvcHMgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktYm94JztcbmV4cG9ydCB0eXBlIHsgVUlMYWJlbFByb3BzLCBUZXh0QWxpZ24gfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktbGFiZWwnO1xuZXhwb3J0IHR5cGUgeyBVSVBhbmVsUHJvcHMsIE5pbmVTbGljZUNvbmZpZyB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1wYW5lbCc7XG5leHBvcnQgdHlwZSB7IFVJQnV0dG9uUHJvcHMsIFNwcml0ZUJhY2tncm91bmRDb25maWcgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktYnV0dG9uJztcbmV4cG9ydCB0eXBlIHsgVUlTZWxlY3RQcm9wcywgU2VsZWN0T3B0aW9uIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXNlbGVjdCc7XG5leHBvcnQgdHlwZSB7IFVJVGV4dElucHV0UHJvcHMgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktdGV4dC1pbnB1dCc7XG5leHBvcnQgdHlwZSB7IFVJVGFic1Byb3BzLCBUYWJJdGVtIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXRhYnMnO1xuZXhwb3J0IHR5cGUgeyBVSUxheWVyT3B0aW9ucyB9IGZyb20gJy4vdWkvVUlMYXllcic7XG5leHBvcnQgdHlwZSB7IFBpeGVsR3JpZENvbmZpZywgQm9yZGVyQ29uZmlnIH0gZnJvbSAnLi91aS9waXhlbC1ncmlkJztcbmV4cG9ydCB0eXBlIHsgU1ZHVG9UZXh0dXJlT3B0aW9ucyB9IGZyb20gJy4vbGlicmFyeS9zdmctdXRpbHMvc3ZnLXRvLXRleHR1cmUnO1xuXG5leHBvcnQgdHlwZSBBc3NldCA9IHsgc3JjOiBzdHJpbmcsIGFsaWFzPzogc3RyaW5nIH07XG5cbmV4cG9ydCBpbnRlcmZhY2UgT25FdmVudCB7XG4gIGV2ZW50OiBFdmVudDtcbiAgZXZlbnRUeXBlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2xpZW50RXZlbnRzQXJncyB7XG4gIGluaXRXaGVlbE9mZnNldD86IFBvaW50O1xuICBvbkFueUV2ZW50PzogKGV2OiBPbkV2ZW50KSA9PiB2b2lkO1xufVxuXG5leHBvcnQgdHlwZSBDbGllbnRFdmVudHNUeXBlID0ge1xuICBrZXlEb3duRXZlbnQ/OiBLZXlib2FyZEV2ZW50O1xuICBrZXlVcEV2ZW50PzogS2V5Ym9hcmRFdmVudDtcbiAga2V5ZG93bj86IFJlY29yZDxzdHJpbmcsIEtleWJvYXJkRXZlbnQ+O1xuICBtb3VzZURvd25FdmVudD86IE1vdXNlRXZlbnQ7XG4gIG1vdXNlVXBFdmVudD86IE1vdXNlRXZlbnQ7XG4gIGxhc3RNb3VzZURvd24/OiBNb3VzZUV2ZW50O1xuICBsYXN0TW91c2VVcD86IE1vdXNlRXZlbnQ7XG4gIHdoZWVsRXZlbnQ/OiBXaGVlbEV2ZW50O1xuICB3aGVlbERlbHRhPzogeyB5VmFsdWU6IDAgfCBudW1iZXIsIHhWYWx1ZTogMCB8IG51bWJlciwgeExhc3Q6IG51bWJlciwgeUxhc3Q6IG51bWJlciB9XG59XG5cbi8vIFJlLWV4cG9ydCB0eXBlc1xuZXhwb3J0IHsgXG4gIFNlcXVlbmNlSW5mbywgXG4gIFJlc2l6ZUhhbmRsZXJPcHRpb25zXG59O1xuXG5jb25zdCBleHBvcnRlZE9iamVjdHMgPSB7XG4gIEFzc2V0TG9hZGVyLFxuICBhc0VudGl0eSxcbiAgYXNUZXh0dXJlRnJhbWVzLFxuICBhc0JpdG1hcFRleHQsXG4gIGFzU3ByaXRlLFxuICBhc1RleHQsXG4gIGFzR3JhcGhpY3MsXG4gIGFzQ29udGFpbmVyLFxuICBMb2dpYyxcbiAgQ2FtZXJhLFxuICBDYW1lcmFMb2dpYyxcbiAgQ2xpZW50RXZlbnRzLFxuICBjcmVhdGVSZXNpemVIYW5kbGVyLFxuICBjcmVhdGVUaWxlR3JpZCxcbiAgZGVmYXVsdFJlbmRlck9wdGlvbnMsXG4gIEVuZ2luZSxcbiAgRXZlbnRFbWl0dGVyLFxuICBnZXRUZXh0dXJlUmFuZ2UsXG4gIGxvYWRGb250cyxcbiAgTW94aUVudGl0eSxcbiAgUGFyYWxsYXhCYWNrZ3JvdW5kLFxuICBQYXJhbGxheEJhY2tncm91bmRMb2dpYyxcbiAgUGFyYWxsYXhMYXllcixcbiAgTG9hZGluZ1NjZW5lLFxuICBzZXR1cE1veGksXG4gIFJlbmRlck1hbmFnZXIsXG4gIFNjZW5lLFxuICBzZXR1cFJlc3BvbnNpdmVDYW52YXMsXG4gIFRleHR1cmVGcmFtZVNlcXVlbmNlcyxcbiAgVGlsaW5nUGFyYWxsYXhMYXllcixcbiAgdXRpbHMsXG4gIFN0YXRlTWFjaGluZSxcbiAgU3RhdGVMb2dpYyxcbiAgUGh5c2ljc1dvcmxkLFxuICBQaHlzaWNzQm9keUxvZ2ljLFxuICBQaHlzaWNzRGVidWdSZW5kZXJlcixcbiAgQ29sbGlzaW9uUmVnaXN0cnksXG4gIENvbGxpc2lvbk1hbmFnZXIsXG4gIGFzUGh5c2ljc0VudGl0eSxcbiAgaGFzUGh5c2ljcyxcbiAgZ2V0UGh5c2ljc0JvZHksXG4gIGNyZWF0ZVNoYXBlRnJvbVNwcml0ZSxcbiAgUGh5c2ljc01hdGVyaWFscyxcbiAgYXBwbHlNYXRlcmlhbCxcbiAgRWRnZUluc2V0cyxcbiAgVUlDb21wb25lbnQsXG4gIFVJRm9jdXNNYW5hZ2VyLFxuICBGbGV4Q29udGFpbmVyLFxuICBGbGV4RGlyZWN0aW9uLFxuICBGbGV4SnVzdGlmeSxcbiAgRmxleEFsaWduLFxuICBVSUJveCxcbiAgVUlMYWJlbCxcbiAgVUlQYW5lbCxcbiAgVUlCdXR0b24sXG4gIEJ1dHRvblN0YXRlLFxuICBVSVNlbGVjdCxcbiAgVUlUZXh0SW5wdXQsXG4gIFVJVGV4dEFyZWEsXG4gIFVJU2Nyb2xsQ29udGFpbmVyLFxuICBVSVRhYnMsXG4gIFVJTGF5ZXIsXG4gIFVJU2NhbGVNb2RlLFxuICBzdmdUb1RleHR1cmUsXG4gIFBpeGVsR3JpZCxcbiAgcHgsXG4gIHVuaXRzLFxuICBHUklELFxuICBCT1JERVIsXG4gIGNyZWF0ZUJvcmRlckNvbmZpZ1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZXhwb3J0ZWRPYmplY3RzO1xuXG5leHBvcnQge1xuICBBc3NldExvYWRlcixcbiAgYXNFbnRpdHksXG4gIGFzVGV4dHVyZUZyYW1lcyxcbiAgYXNCaXRtYXBUZXh0LFxuICBhc1Nwcml0ZSxcbiAgYXNUZXh0LFxuICBhc0dyYXBoaWNzLFxuICBhc0NvbnRhaW5lcixcbiAgUGl4aVByb3BzLFxuICBMb2dpYyxcbiAgQ2FtZXJhLFxuICBDYW1lcmFMb2dpYyxcbiAgQ2xpZW50RXZlbnRzLFxuICBjcmVhdGVSZXNpemVIYW5kbGVyLFxuICBjcmVhdGVUaWxlR3JpZCxcbiAgZGVmYXVsdFJlbmRlck9wdGlvbnMsXG4gIEVuZ2luZSxcbiAgRXZlbnRFbWl0dGVyLFxuICBnZXRUZXh0dXJlUmFuZ2UsXG4gIGxvYWRGb250cyxcbiAgTW94aUVudGl0eSxcbiAgUGFyYWxsYXhCYWNrZ3JvdW5kLFxuICBQYXJhbGxheEJhY2tncm91bmRMb2dpYyxcbiAgUGFyYWxsYXhMYXllcixcbiAgTG9hZGluZ1NjZW5lLFxuICBzZXR1cE1veGksXG4gIFJlbmRlck1hbmFnZXIsXG4gIFNjZW5lLFxuICBzZXR1cFJlc3BvbnNpdmVDYW52YXMsXG4gIFRleHR1cmVGcmFtZVNlcXVlbmNlcyxcbiAgVGlsaW5nUGFyYWxsYXhMYXllcixcbiAgdXRpbHMsXG4gIFN0YXRlTWFjaGluZSxcbiAgU3RhdGVMb2dpYyxcbiAgUGh5c2ljc1dvcmxkLFxuICBQaHlzaWNzQm9keUxvZ2ljLFxuICBQaHlzaWNzRGVidWdSZW5kZXJlcixcbiAgQ29sbGlzaW9uUmVnaXN0cnksXG4gIENvbGxpc2lvbk1hbmFnZXIsXG4gIGFzUGh5c2ljc0VudGl0eSxcbiAgaGFzUGh5c2ljcyxcbiAgZ2V0UGh5c2ljc0JvZHksXG4gIGNyZWF0ZVNoYXBlRnJvbVNwcml0ZSxcbiAgUGh5c2ljc01hdGVyaWFscyxcbiAgYXBwbHlNYXRlcmlhbCxcbiAgRWRnZUluc2V0cyxcbiAgVUlDb21wb25lbnQsXG4gIFVJRm9jdXNNYW5hZ2VyLFxuICBGbGV4Q29udGFpbmVyLFxuICBGbGV4RGlyZWN0aW9uLFxuICBGbGV4SnVzdGlmeSxcbiAgRmxleEFsaWduLFxuICBVSUJveCxcbiAgVUlMYWJlbCxcbiAgVUlQYW5lbCxcbiAgVUlCdXR0b24sXG4gIEJ1dHRvblN0YXRlLFxuICBVSVNlbGVjdCxcbiAgVUlUZXh0SW5wdXQsXG4gIFVJVGV4dEFyZWEsXG4gIFVJU2Nyb2xsQ29udGFpbmVyLFxuICBVSVRhYnMsXG4gIFVJTGF5ZXIsXG4gIFVJU2NhbGVNb2RlLFxuICBzdmdUb1RleHR1cmUsXG4gIFBpeGVsR3JpZCxcbiAgcHgsXG4gIHVuaXRzLFxuICBHUklELFxuICBCT1JERVIsXG4gIGNyZWF0ZUJvcmRlckNvbmZpZ1xufTtcblxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbi8qKlxuICogT3B0aW9ucyBmb3IgY3JlYXRpbmcgYSBCaXRtYXBUZXh0IGluc3RhbmNlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQml0bWFwVGV4dE9wdGlvbnMge1xuICB0ZXh0Pzogc3RyaW5nIHwgbnVtYmVyIHwgeyB0b1N0cmluZzogKCkgPT4gc3RyaW5nIH07XG4gIHN0eWxlPzoge1xuICAgIGZvbnRGYW1pbHk/OiBzdHJpbmc7XG4gICAgZm9udFNpemU/OiBudW1iZXI7XG4gICAgZm9udFN0eWxlPzogc3RyaW5nO1xuICAgIGZpbGw/OiBudW1iZXIgfCBzdHJpbmc7XG4gICAgW2tleTogc3RyaW5nXTogYW55O1xuICB9O1xuICBwaXhlbFBlcmZlY3Q/OiBib29sZWFuOyAvLyBFbmFibGUgcGl4ZWwtcGVyZmVjdCByZW5kZXJpbmcgKHJvdW5kUGl4ZWxzKVxuICBba2V5OiBzdHJpbmddOiBhbnk7XG59XG5cbi8qKlxuICogT3B0aW9ucyBmb3IgY3JlYXRpbmcgYSBTcHJpdGUgaW5zdGFuY2VcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTcHJpdGVPcHRpb25zIHtcbiAgdGV4dHVyZT86IFBJWEkuVGV4dHVyZSB8IFBJWEkuVGV4dHVyZVNvdXJjZTtcbiAgW2tleTogc3RyaW5nXTogYW55O1xufVxuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGNyZWF0aW5nIGEgVGV4dCBpbnN0YW5jZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFRleHRPcHRpb25zIHtcbiAgdGV4dD86IHN0cmluZyB8IG51bWJlciB8IHsgdG9TdHJpbmc6ICgpID0+IHN0cmluZyB9O1xuICBzdHlsZT86IHtcbiAgICBmb250RmFtaWx5Pzogc3RyaW5nO1xuICAgIGZvbnRTaXplPzogbnVtYmVyO1xuICAgIGZvbnRTdHlsZT86IHN0cmluZztcbiAgICBmaWxsPzogbnVtYmVyIHwgc3RyaW5nO1xuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbiAgfTtcbiAgW2tleTogc3RyaW5nXTogYW55O1xufVxuXG4vKipcbiAqIENvbW1vbiBwcm9wZXJ0aWVzIHRoYXQgY2FuIGJlIGFwcGxpZWQgdG8gUElYSSBkaXNwbGF5IG9iamVjdHNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQaXhpUHJvcHMge1xuICB4PzogbnVtYmVyO1xuICB5PzogbnVtYmVyO1xuICBhbmNob3I/OiB7IHg/OiBudW1iZXI7IHk/OiBudW1iZXIgfSB8IG51bWJlcjtcbiAgc2NhbGU/OiB7IHg/OiBudW1iZXI7IHk/OiBudW1iZXIgfSB8IG51bWJlcjtcbiAgcm90YXRpb24/OiBudW1iZXI7XG4gIHRpbnQ/OiBudW1iZXI7XG4gIGFscGhhPzogbnVtYmVyO1xuICB2aXNpYmxlPzogYm9vbGVhbjtcbiAgZXZlbnRNb2RlPzogJ25vbmUnIHwgJ3Bhc3NpdmUnIHwgJ2F1dG8nIHwgJ3N0YXRpYycgfCAnZHluYW1pYyc7XG4gIHBpdm90PzogeyB4PzogbnVtYmVyOyB5PzogbnVtYmVyIH0gfCBudW1iZXI7XG59XG5cbi8qKlxuICogQXBwbGllcyBjb21tb24gcHJvcGVydGllcyB0byBhIFBJWEkgZGlzcGxheSBvYmplY3RcbiAqL1xuZnVuY3Rpb24gYXBwbHlQcm9wczxUIGV4dGVuZHMgUElYSS5Db250YWluZXI+KG9iajogVCwgcHJvcHM/OiBQaXhpUHJvcHMpOiBUIHtcbiAgaWYgKCFwcm9wcykgcmV0dXJuIG9iajtcblxuICBpZiAocHJvcHMueCAhPT0gdW5kZWZpbmVkKSBvYmoueCA9IHByb3BzLng7XG4gIGlmIChwcm9wcy55ICE9PSB1bmRlZmluZWQpIG9iai55ID0gcHJvcHMueTtcbiAgXG4gIGlmIChwcm9wcy5hbmNob3IgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmICh0eXBlb2YgcHJvcHMuYW5jaG9yID09PSAnbnVtYmVyJykge1xuICAgICAgaWYgKCdhbmNob3InIGluIG9iaiAmJiB0eXBlb2Ygb2JqLmFuY2hvciA9PT0gJ29iamVjdCcgJiYgb2JqLmFuY2hvciAhPT0gbnVsbCkge1xuICAgICAgICAob2JqLmFuY2hvciBhcyBQSVhJLk9ic2VydmFibGVQb2ludCkuc2V0KHByb3BzLmFuY2hvcik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICgnYW5jaG9yJyBpbiBvYmogJiYgdHlwZW9mIG9iai5hbmNob3IgPT09ICdvYmplY3QnICYmIG9iai5hbmNob3IgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgYW5jaG9yID0gb2JqLmFuY2hvciBhcyBQSVhJLk9ic2VydmFibGVQb2ludDtcbiAgICAgICAgaWYgKHByb3BzLmFuY2hvci54ICE9PSB1bmRlZmluZWQpIGFuY2hvci54ID0gcHJvcHMuYW5jaG9yLng7XG4gICAgICAgIGlmIChwcm9wcy5hbmNob3IueSAhPT0gdW5kZWZpbmVkKSBhbmNob3IueSA9IHByb3BzLmFuY2hvci55O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChwcm9wcy5zY2FsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiBwcm9wcy5zY2FsZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIGlmICgnc2NhbGUnIGluIG9iaiAmJiB0eXBlb2Ygb2JqLnNjYWxlID09PSAnb2JqZWN0JyAmJiBvYmouc2NhbGUgIT09IG51bGwpIHtcbiAgICAgICAgKG9iai5zY2FsZSBhcyBQSVhJLk9ic2VydmFibGVQb2ludCkuc2V0KHByb3BzLnNjYWxlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCdzY2FsZScgaW4gb2JqICYmIHR5cGVvZiBvYmouc2NhbGUgPT09ICdvYmplY3QnICYmIG9iai5zY2FsZSAhPT0gbnVsbCkge1xuICAgICAgICBjb25zdCBzY2FsZSA9IG9iai5zY2FsZSBhcyBQSVhJLk9ic2VydmFibGVQb2ludDtcbiAgICAgICAgaWYgKHByb3BzLnNjYWxlLnggIT09IHVuZGVmaW5lZCkgc2NhbGUueCA9IHByb3BzLnNjYWxlLng7XG4gICAgICAgIGlmIChwcm9wcy5zY2FsZS55ICE9PSB1bmRlZmluZWQpIHNjYWxlLnkgPSBwcm9wcy5zY2FsZS55O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChwcm9wcy5yb3RhdGlvbiAhPT0gdW5kZWZpbmVkKSBvYmoucm90YXRpb24gPSBwcm9wcy5yb3RhdGlvbjtcbiAgaWYgKHByb3BzLnRpbnQgIT09IHVuZGVmaW5lZCAmJiAndGludCcgaW4gb2JqKSAob2JqIGFzIGFueSkudGludCA9IHByb3BzLnRpbnQ7XG4gIGlmIChwcm9wcy5hbHBoYSAhPT0gdW5kZWZpbmVkKSBvYmouYWxwaGEgPSBwcm9wcy5hbHBoYTtcbiAgaWYgKHByb3BzLnZpc2libGUgIT09IHVuZGVmaW5lZCkgb2JqLnZpc2libGUgPSBwcm9wcy52aXNpYmxlO1xuICBpZiAocHJvcHMuZXZlbnRNb2RlICE9PSB1bmRlZmluZWQgJiYgJ2V2ZW50TW9kZScgaW4gb2JqKSBvYmouZXZlbnRNb2RlID0gcHJvcHMuZXZlbnRNb2RlO1xuXG4gIGlmIChwcm9wcy5waXZvdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiBwcm9wcy5waXZvdCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGlmICgncGl2b3QnIGluIG9iaiAmJiB0eXBlb2Ygb2JqLnBpdm90ID09PSAnb2JqZWN0JyAmJiBvYmoucGl2b3QgIT09IG51bGwpIHtcbiAgICAgICAgKG9iai5waXZvdCBhcyBQSVhJLk9ic2VydmFibGVQb2ludCkuc2V0KHByb3BzLnBpdm90KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCdwaXZvdCcgaW4gb2JqICYmIHR5cGVvZiBvYmoucGl2b3QgPT09ICdvYmplY3QnICYmIG9iai5waXZvdCAhPT0gbnVsbCkge1xuICAgICAgICBjb25zdCBwaXZvdCA9IG9iai5waXZvdCBhcyBQSVhJLk9ic2VydmFibGVQb2ludDtcbiAgICAgICAgaWYgKHByb3BzLnBpdm90LnggIT09IHVuZGVmaW5lZCkgcGl2b3QueCA9IHByb3BzLnBpdm90Lng7XG4gICAgICAgIGlmIChwcm9wcy5waXZvdC55ICE9PSB1bmRlZmluZWQpIHBpdm90LnkgPSBwcm9wcy5waXZvdC55O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvYmo7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIEJpdG1hcFRleHQgaW5zdGFuY2Ugd2l0aCBjb25zdHJ1Y3RvciBhcmdzIGFuZCBvcHRpb25hbCBwcm9wZXJ0aWVzXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGxhYmVsID0gYXNCaXRtYXBUZXh0KFxuICogICB7IHRleHQ6ICdIZWxsbycsIHN0eWxlOiB7IGZvbnRGYW1pbHk6ICdBcmlhbCcsIGZvbnRTaXplOiAyNCB9LCBwaXhlbFBlcmZlY3Q6IHRydWUgfSxcbiAqICAgeyB4OiAxMDAsIHk6IDUwLCBhbmNob3I6IDAuNSB9XG4gKiApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc0JpdG1hcFRleHQoXG4gIGNvbnN0cnVjdG9yQXJnczogQml0bWFwVGV4dE9wdGlvbnMsXG4gIHByb3BzPzogUGl4aVByb3BzXG4pOiBQSVhJLkJpdG1hcFRleHQge1xuICBjb25zdCB7IHBpeGVsUGVyZmVjdCwgLi4udGV4dEFyZ3MgfSA9IGNvbnN0cnVjdG9yQXJncztcbiAgY29uc3QgdGV4dCA9IG5ldyBQSVhJLkJpdG1hcFRleHQodGV4dEFyZ3MgYXMgYW55KTtcblxuICAvLyBBcHBseSBwaXhlbC1wZXJmZWN0IHJlbmRlcmluZyBpZiByZXF1ZXN0ZWRcbiAgaWYgKHBpeGVsUGVyZmVjdCkge1xuICAgIHRleHQucm91bmRQaXhlbHMgPSB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGFwcGx5UHJvcHModGV4dCwgcHJvcHMpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBTcHJpdGUgaW5zdGFuY2Ugd2l0aCBjb25zdHJ1Y3RvciBhcmdzIGFuZCBvcHRpb25hbCBwcm9wZXJ0aWVzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBzcHJpdGUgPSBhc1Nwcml0ZShcbiAqICAgeyB0ZXh0dXJlIH0sXG4gKiAgIHsgeDogMTAwLCB5OiAxMDAsIGFuY2hvcjogMC41IH1cbiAqICk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzU3ByaXRlKFxuICBjb25zdHJ1Y3RvckFyZ3M6IFNwcml0ZU9wdGlvbnMsXG4gIHByb3BzPzogUGl4aVByb3BzXG4pOiBQSVhJLlNwcml0ZSB7XG4gIGNvbnN0IHNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZShjb25zdHJ1Y3RvckFyZ3MgYXMgYW55KTtcbiAgcmV0dXJuIGFwcGx5UHJvcHMoc3ByaXRlLCBwcm9wcyk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIFRleHQgaW5zdGFuY2Ugd2l0aCBjb25zdHJ1Y3RvciBhcmdzIGFuZCBvcHRpb25hbCBwcm9wZXJ0aWVzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCB0ZXh0ID0gYXNUZXh0KFxuICogICB7IHRleHQ6ICdIZWxsbycsIHN0eWxlOiB7IGZvbnRGYW1pbHk6ICdBcmlhbCcsIGZvbnRTaXplOiAyNCB9IH0sXG4gKiAgIHsgeDogMTAwLCB5OiA1MCB9XG4gKiApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc1RleHQoXG4gIGNvbnN0cnVjdG9yQXJnczogVGV4dE9wdGlvbnMsXG4gIHByb3BzPzogUGl4aVByb3BzXG4pOiBQSVhJLlRleHQge1xuICBjb25zdCB0ZXh0ID0gbmV3IFBJWEkuVGV4dChjb25zdHJ1Y3RvckFyZ3MgYXMgYW55KTtcbiAgcmV0dXJuIGFwcGx5UHJvcHModGV4dCwgcHJvcHMpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBHcmFwaGljcyBpbnN0YW5jZSB3aXRoIG9wdGlvbmFsIHByb3BlcnRpZXNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGdyYXBoaWNzID0gYXNHcmFwaGljcyh7IHg6IDEwMCwgeTogMTAwIH0pO1xuICogZ3JhcGhpY3MucmVjdCgwLCAwLCA1MCwgNTApLmZpbGwoMHhmZjAwMDApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc0dyYXBoaWNzKHByb3BzPzogUGl4aVByb3BzKTogUElYSS5HcmFwaGljcyB7XG4gIGNvbnN0IGdyYXBoaWNzID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgcmV0dXJuIGFwcGx5UHJvcHMoZ3JhcGhpY3MsIHByb3BzKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgQ29udGFpbmVyIGluc3RhbmNlIHdpdGggb3B0aW9uYWwgcHJvcGVydGllc1xuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgY29udGFpbmVyID0gYXNDb250YWluZXIoeyB4OiAxMDAsIHk6IDEwMCB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNDb250YWluZXIocHJvcHM/OiBQaXhpUHJvcHMpOiBQSVhJLkNvbnRhaW5lciB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICByZXR1cm4gYXBwbHlQcm9wcyhjb250YWluZXIsIHByb3BzKTtcbn1cblxuIiwiaW1wb3J0IHsgUG9pbnQgfSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IE9uRXZlbnQsIENsaWVudEV2ZW50c0FyZ3MgfSBmcm9tICcuLic7XG5cbi8qKlxuICogTWFuYWdlcyBpbnB1dCBldmVudHMgZnJvbSB0aGUgY2xpZW50IChrZXlib2FyZCwgbW91c2UsIGV0Yy4pIGFuZCBwcm92aWRlcyBhbiBpbnRlcmZhY2VcbiAqIGZvciBxdWVyeWluZyB0aGUgY3VycmVudCBpbnB1dCBzdGF0ZS5cbiAqIFxuICogSW1wbGVtZW50cyB0aGUgU2luZ2xldG9uIHBhdHRlcm4gdG8gZW5zdXJlIG9ubHkgb25lIGluc3RhbmNlIG9mIGV2ZW50IGhhbmRsZXJzIGV4aXN0cy5cbiAqIFxuICogQGNhdGVnb3J5IENvcmVcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiAvLyBDcmVhdGUvZ2V0IHRoZSBDbGllbnRFdmVudHMgaW5zdGFuY2VcbiAqIGNvbnN0IGV2ZW50cyA9IG5ldyBDbGllbnRFdmVudHMoKTtcbiAqIFxuICogLy8gQ2hlY2sgaWYgYSBrZXkgaXMgY3VycmVudGx5IHByZXNzZWRcbiAqIGlmIChldmVudHMuaXNLZXlEb3duKCdBcnJvd1JpZ2h0JykpIHtcbiAqICAgcGxheWVyLm1vdmVSaWdodCgpO1xuICogfVxuICogXG4gKiAvLyBBY2Nlc3MgbW91c2UgcG9zaXRpb25cbiAqIGNvbnN0IG1vdXNlUG9zID0gZXZlbnRzLm1vdmVQb3NpdGlvbjtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgQ2xpZW50RXZlbnRzIHtcbiAgLyoqXG4gICAqIEN1cnJlbnQgd2hlZWwgc2Nyb2xsIGRlbHRhIHZhbHVlc1xuICAgKi9cbiAgd2hlZWxEZWx0YTogeyB5VmFsdWU6IG51bWJlcjsgeFZhbHVlOiBudW1iZXI7IH07XG4gIFxuICAvKipcbiAgICogVGhlIG1vc3QgcmVjZW50IG1vdXNlIHVwIGV2ZW50XG4gICAqL1xuICBtb3VzZVVwRXZlbnQ6IE1vdXNlRXZlbnQ7XG4gIFxuICAvKipcbiAgICogVGhlIG1vc3QgcmVjZW50IG1vdXNlIGRvd24gZXZlbnRcbiAgICovXG4gIG1vdXNlRG93bkV2ZW50OiBNb3VzZUV2ZW50O1xuICBcbiAgLyoqXG4gICAqIFRoZSBsYXN0IG1vdXNlIGRvd24gZXZlbnQgdGhhdCBvY2N1cnJlZFxuICAgKi9cbiAgbGFzdE1vdXNlRG93bjogTW91c2VFdmVudDtcbiAgXG4gIC8qKlxuICAgKiBUaGUgbGFzdCBtb3VzZSB1cCBldmVudCB0aGF0IG9jY3VycmVkXG4gICAqL1xuICBsYXN0TW91c2VVcDogTW91c2VFdmVudDtcbiAgXG4gIC8qKlxuICAgKiBUaGUgbW9zdCByZWNlbnQga2V5IGRvd24gZXZlbnRcbiAgICovXG4gIGtleURvd25FdmVudDogS2V5Ym9hcmRFdmVudDtcbiAgXG4gIC8qKlxuICAgKiBUaGUgbW9zdCByZWNlbnQga2V5IHVwIGV2ZW50XG4gICAqL1xuICBrZXlVcEV2ZW50OiBLZXlib2FyZEV2ZW50O1xuICBcbiAgLyoqXG4gICAqIE1hcCBvZiBjdXJyZW50bHkgcHJlc3NlZCBrZXlzXG4gICAqIEBpbnRlcm5hbFxuICAgKi9cbiAga2V5ZG93bjogUmVjb3JkPHN0cmluZywgS2V5Ym9hcmRFdmVudD47XG4gIFxuICAvKipcbiAgICogQWNjdW11bGF0ZWQgd2hlZWwgb2Zmc2V0IHZhbHVlc1xuICAgKi9cbiAgd2hlZWxPZmZzZXRzOiBQb2ludDtcbiAgXG4gIC8qKlxuICAgKiBDdXJyZW50IG1vdXNlIHBvc2l0aW9uXG4gICAqL1xuICBtb3ZlUG9zaXRpb246IFBvaW50O1xuICBcbiAgLyoqXG4gICAqIFByZXZpb3VzIG1vdXNlIHBvc2l0aW9uXG4gICAqL1xuICBsYXN0TW92ZVBvc2l0aW9uOiBQb2ludDtcbiAgXG4gIC8qKlxuICAgKiBDaGFuZ2UgaW4gbW91c2UgcG9zaXRpb24gc2luY2UgbGFzdCB1cGRhdGVcbiAgICovXG4gIG1vdmVEZWx0YTogUG9pbnQ7XG5cbiAgLyoqXG4gICAqIFNpbmdsZXRvbiBpbnN0YW5jZSBvZiBDbGllbnRFdmVudHNcbiAgICogQHN0YXRpY1xuICAgKi9cbiAgc3RhdGljIGluc3RhbmNlOiBDbGllbnRFdmVudHMgPSBudWxsO1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IENsaWVudEV2ZW50cyBpbnN0YW5jZSBvciByZXR1cm5zIHRoZSBleGlzdGluZyBzaW5nbGV0b24gaW5zdGFuY2VcbiAgICogXG4gICAqIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zXG4gICAqIEBwYXJhbSBvcHRpb25zLmluaXRXaGVlbE9mZnNldCAtIEluaXRpYWwgd2hlZWwgb2Zmc2V0IHZhbHVlXG4gICAqIEBwYXJhbSBvcHRpb25zLm9uQW55RXZlbnQgLSBDYWxsYmFjayB0aGF0IGZpcmVzIG9uIGFueSBpbnB1dCBldmVudFxuICAgKi9cbiAgY29uc3RydWN0b3IoeyBpbml0V2hlZWxPZmZzZXQgPSBuZXcgUG9pbnQoKSwgb25BbnlFdmVudCA9IChldjogT25FdmVudCkgPT4ge30gfTogQ2xpZW50RXZlbnRzQXJncyA9IHt9KSB7XG4gICAgLy8gc2luY2Ugd2UgYXJlIGhvb2tpbmcgZXZlbnRzIGludG8gdGhlIGRvY3VtZW50LCB3ZSBvbmx5IHdhbnQgb25lIGluc3RhbmNlIG9mIHRoaXMgY2xhc3NcbiAgICBpZiAoQ2xpZW50RXZlbnRzLmluc3RhbmNlKSB7XG4gICAgICByZXR1cm4gQ2xpZW50RXZlbnRzLmluc3RhbmNlO1xuICAgIH1cbiAgICB0aGlzLndoZWVsT2Zmc2V0cyA9IGluaXRXaGVlbE9mZnNldDtcbiAgICB0aGlzLmtleWRvd24gPSB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBLZXlib2FyZEV2ZW50PjtcbiAgICB0aGlzLm1vdmVQb3NpdGlvbiA9IG5ldyBQb2ludCgpO1xuXG4gICAgY29uc3QgYW55RXZlbnQgPSAoZXY6IE9uRXZlbnQpID0+IHtcbiAgICAgIG9uQW55RXZlbnQoZXYpO1xuICAgIH07XG5cbiAgICAvLyBSZWdpc3RlciB3aGVlbCBldmVudCBsaXN0ZW5lclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB3aGVlbERlbHRhID0gdGhpcy53aGVlbE9mZnNldHMgfHwgbmV3IFBvaW50KCk7XG4gICAgICBjb25zdCB4VmFsdWUgPSB3aGVlbERlbHRhLnggKyBldmVudC5kZWx0YVg7XG4gICAgICBjb25zdCB5VmFsdWUgPSB3aGVlbERlbHRhLnkgKyBldmVudC5kZWx0YVk7XG4gICAgICB0aGlzLndoZWVsT2Zmc2V0cyA9IG5ldyBQb2ludCh4VmFsdWUsIHlWYWx1ZSk7XG4gICAgICBhbnlFdmVudCh7IGV2ZW50VHlwZTogJ3doZWVsJywgZXZlbnQgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZWdpc3RlciBtb3VzZSBtb3ZlIGV2ZW50IGxpc3RlbmVyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLmxhc3RNb3ZlUG9zaXRpb24gPSB0aGlzLm1vdmVQb3NpdGlvbjtcbiAgICAgIHRoaXMubW92ZVBvc2l0aW9uID0gbmV3IFBvaW50KGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkpO1xuICAgICAgdGhpcy5tb3ZlRGVsdGEgPSBuZXcgUG9pbnQoXG4gICAgICAgIHRoaXMubW92ZVBvc2l0aW9uLnggLSB0aGlzLmxhc3RNb3ZlUG9zaXRpb24ueCxcbiAgICAgICAgdGhpcy5tb3ZlUG9zaXRpb24ueSAtIHRoaXMubGFzdE1vdmVQb3NpdGlvbi55XG4gICAgICApO1xuICAgICAgYW55RXZlbnQoeyBldmVudFR5cGU6ICdtb3VzZW1vdmUnLCBldmVudCB9KTtcbiAgICB9KTtcblxuICAgIC8vIFJlZ2lzdGVyIG1vdXNlIGRvd24gZXZlbnQgbGlzdGVuZXJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMubW91c2VEb3duRXZlbnQgPSBldmVudDtcbiAgICAgIHRoaXMubGFzdE1vdXNlRG93biA9IGV2ZW50O1xuICAgICAgdGhpcy5tb3VzZVVwRXZlbnQgPSBudWxsO1xuICAgICAgYW55RXZlbnQoeyBldmVudFR5cGU6ICdtb3VzZWRvd24nLCBldmVudCB9KTtcbiAgICB9KTtcblxuICAgIC8vIFJlZ2lzdGVyIG1vdXNlIHVwIGV2ZW50IGxpc3RlbmVyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5tb3VzZVVwRXZlbnQgPSBldmVudDtcbiAgICAgIHRoaXMubGFzdE1vdXNlVXAgPSBldmVudDtcbiAgICAgIHRoaXMubW91c2VEb3duRXZlbnQgPSBudWxsO1xuICAgICAgYW55RXZlbnQoeyBldmVudFR5cGU6ICdtb3VzZXVwJywgZXZlbnQgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZWdpc3RlciBrZXkgZG93biBldmVudCBsaXN0ZW5lclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsga2V5IH0gPSBldmVudDtcbiAgICAgIHRoaXMua2V5RG93bkV2ZW50ID0gZXZlbnQ7XG4gICAgICB0aGlzLmtleVVwRXZlbnQgPSBudWxsO1xuICAgICAgdGhpcy5rZXlkb3duW2tleV0gPSBldmVudDtcbiAgICAgIGFueUV2ZW50KHsgZXZlbnRUeXBlOiAna2V5ZG93bicsIGV2ZW50IH0pO1xuICAgIH0pO1xuXG4gICAgLy8gUmVnaXN0ZXIga2V5IHVwIGV2ZW50IGxpc3RlbmVyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsga2V5IH0gPSBldmVudDtcbiAgICAgIHRoaXMua2V5VXBFdmVudCA9IGV2ZW50O1xuICAgICAgdGhpcy5rZXlEb3duRXZlbnQgPSBudWxsO1xuICAgICAgZGVsZXRlIHRoaXMua2V5ZG93bltrZXldO1xuICAgICAgYW55RXZlbnQoeyBldmVudFR5cGU6ICdrZXl1cCcsIGV2ZW50IH0pO1xuICAgIH0pO1xuXG4gICAgQ2xpZW50RXZlbnRzLmluc3RhbmNlID0gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgYSBzcGVjaWZpYyBrZXkgaXMgY3VycmVudGx5IHByZXNzZWQgZG93blxuICAgKiBcbiAgICogQHBhcmFtIGtleSAtIFRoZSBrZXkgdG8gY2hlY2ssIGUuZy4sICdhJywgJ0Fycm93VXAnLCAnU3BhY2UnXG4gICAqIEByZXR1cm5zIFRydWUgaWYgdGhlIGtleSBpcyBjdXJyZW50bHkgcHJlc3NlZCwgZmFsc2Ugb3RoZXJ3aXNlXG4gICAqIFxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGlmIChldmVudHMuaXNLZXlEb3duKCdTcGFjZScpKSB7XG4gICAqICAgcGxheWVyLmp1bXAoKTtcbiAgICogfVxuICAgKiBgYGBcbiAgICovXG4gIGlzS2V5RG93bihrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBCb29sZWFuKHRoaXMua2V5ZG93bltrZXldKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgYSBzcGVjaWZpYyBrZXkgaXMgY3VycmVudGx5IG5vdCBwcmVzc2VkXG4gICAqIFxuICAgKiBAcGFyYW0ga2V5IC0gVGhlIGtleSB0byBjaGVjaywgZS5nLiwgJ2EnLCAnQXJyb3dVcCcsICdTcGFjZSdcbiAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGUga2V5IGlzIGN1cnJlbnRseSBub3QgcHJlc3NlZCwgZmFsc2UgaWYgaXQgaXMgcHJlc3NlZFxuICAgKi9cbiAgaXNLZXlVcChrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhdGhpcy5rZXlkb3duW2tleV07XG4gIH1cbn1cblxuXG5cbiIsImltcG9ydCBGb250RmFjZU9ic2VydmVyIGZyb20gJ2ZvbnRmYWNlb2JzZXJ2ZXInO1xuaW1wb3J0IHsgQml0bWFwRm9udCB9IGZyb20gJ3BpeGkuanMnO1xuXG5leHBvcnQgY29uc3QgbG9hZEZvbnRzID0gYXN5bmMgKCkgPT4ge1xuICAvLyBub3RlIHRoYXQgdGhpcyByZWZlcmVuY2VzIHRoZSBmb250LWZhY2Ugc3BlY2lmaWVkIGluIHRoZSBIVE1MIHN0eWxlIHNlY3Rpb25cbiAgLy8gPHN0eWxlPlxuICAvLyBAZm9udC1mYWNlIHtcbiAgLy8gICBmb250LWZhbWlseTogJ2tlbmZ1dHVyZS10aGluJztcbiAgLy8gICBzcmM6IHVybCgnLi9hc3NldHMvZm9udHMva2VudmVjdG9yX2Z1dHVyZV90aGluLnR0ZicpO1xuICAvLyB9XG4gIC8vIDwvc3R5bGU+XG5cbiAgLy8gdXNpbmcgZm9udGZhY2VvYnNlcnZlciBhbGxvd3MgdXMgZW5zdXJlIHRoZSBmb250IGlzIGxvYWRlZCBiZWZvcmUgdXNpbmcgY29uZmlndXJhdGlvbiBmb3IgYml0bWFwIGZvbnRzLlxuICBjb25zdCBmb250S2VuZnV0dXJlVGhpbiA9IG5ldyBGb250RmFjZU9ic2VydmVyKCdrZW5mdXR1cmUtdGhpbicpO1xuXG4gIC8vIFBJWEkuQml0bWFwRm9udC5pbnN0YWxsIHdpbGwgY3JlYXRlIGEgYml0bWFwIGZvbnQgZnJvbSBhIGZvbnQtZmFjZSBhbmQgVGV4dFN0eWxlIGNvbmZpZ3VyYXRpb25cbiAgLy8gVXNpbmcgYSBCaXRtYXBmb250IGFsbG93cyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlIHdoZW4gcmFwaWRseSBjaGFuZ2luZyByZW5kZXJlZCB0ZXh0LlxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBmb250S2VuZnV0dXJlVGhpbi5sb2FkKCkudGhlbigoKSA9PiB7XG4gICAgICBCaXRtYXBGb250Lmluc3RhbGwoe1xuICAgICAgICBuYW1lOiAna2VuZnV0dXJlLXRoaW4nLFxuICAgICAgICBzdHlsZToge1xuICAgICAgICAgIGZvbnRGYW1pbHk6ICdrZW5mdXR1cmUtdGhpbidcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXNvbHZlKHsgZm9udEtlbmZ1dHVyZVRoaW4gfSk7XG4gICAgfSk7XG4gIH0pO1xufTsiLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIGdyaWQgZ2VuZXJhdGlvblxuICogQGNhdGVnb3J5IExpYnJhcnlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHcmlkT3B0aW9ucyB7XG4gIHdpZHRoOiBudW1iZXI7XG4gIGhlaWdodDogbnVtYmVyO1xuICBjZWxsV2lkdGg6IG51bWJlcjtcbiAgY2VsbEhlaWdodDogbnVtYmVyO1xuICBjZW50ZXJlZD86IGJvb2xlYW47XG59XG5cbi8qKlxuICogQ2VsbCBwb3NpdGlvbiBpbmZvcm1hdGlvbiBwYXNzZWQgdG8gY2FsbGJhY2sgZnVuY3Rpb25zXG4gKiBAY2F0ZWdvcnkgTGlicmFyeVxuICovXG5leHBvcnQgaW50ZXJmYWNlIENlbGxQb3NpdGlvbiB7XG4gIHg6IG51bWJlcjtcbiAgeTogbnVtYmVyO1xuICBwaXhlbFg6IG51bWJlcjtcbiAgcGl4ZWxZOiBudW1iZXI7XG4gIGluZGV4OiBudW1iZXI7XG4gIHRvdGFsOiBudW1iZXI7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGdyaWQgb2YgdGlsZXMgdXNpbmcgYSBzZXQgb2YgdGV4dHVyZXNcbiAqIFxuICogQGNhdGVnb3J5IExpYnJhcnlcbiAqIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgZ3JpZFxuICogQHBhcmFtIHRleHR1cmVzIC0gQXJyYXkgb2YgdGV4dHVyZXMgdG8gdXNlIGZvciB0aGUgdGlsZXNcbiAqIEBwYXJhbSBzZWxlY3RvciAtIE9wdGlvbmFsIGZ1bmN0aW9uIHRvIHNlbGVjdCB3aGljaCB0ZXh0dXJlIHRvIHVzZSBmb3IgZWFjaCBjZWxsXG4gKiBAcmV0dXJucyBBIFBJWEkgQ29udGFpbmVyIHdpdGggdGhlIGdlbmVyYXRlZCB0aWxlIGdyaWRcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIC8vIENyZWF0ZSBhIHJhbmRvbSBncmFzcyBmaWVsZFxuICogY29uc3QgZ3Jhc3NGaWVsZCA9IGNyZWF0ZVRpbGVHcmlkKHtcbiAqICAgd2lkdGg6IDY0LFxuICogICBoZWlnaHQ6IDY0LFxuICogICBjZWxsV2lkdGg6IDE2LFxuICogICBjZWxsSGVpZ2h0OiAxNixcbiAqICAgY2VudGVyZWQ6IHRydWVcbiAqIH0sIGdyYXNzVGV4dHVyZXMpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUaWxlR3JpZChcbiAgb3B0aW9uczogR3JpZE9wdGlvbnMsXG4gIHRleHR1cmVzOiBQSVhJLlRleHR1cmVbXSxcbiAgc2VsZWN0b3I/OiAocG9zaXRpb246IENlbGxQb3NpdGlvbikgPT4gbnVtYmVyXG4pOiBQSVhJLkNvbnRhaW5lciB7XG4gIGNvbnN0IHsgd2lkdGgsIGhlaWdodCwgY2VsbFdpZHRoLCBjZWxsSGVpZ2h0LCBjZW50ZXJlZCA9IGZhbHNlIH0gPSBvcHRpb25zO1xuICBcbiAgLy8gRGVmYXVsdCBzZWxlY3RvciByYW5kb21seSBjaG9vc2VzIHRleHR1cmVzXG4gIGNvbnN0IGRlZmF1bHRTZWxlY3RvciA9ICgpID0+IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRleHR1cmVzLmxlbmd0aCk7XG4gIGNvbnN0IGdldFRleHR1cmVJbmRleCA9IHNlbGVjdG9yIHx8IGRlZmF1bHRTZWxlY3RvcjtcbiAgXG4gIC8vIENyZWF0ZSBjb250YWluZXIgZm9yIHRoZSBncmlkXG4gIGNvbnN0IGNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICBcbiAgLy8gQ2FsY3VsYXRlIHRvdGFsIG51bWJlciBvZiBjZWxsc1xuICBjb25zdCB0b3RhbENlbGxzID0gd2lkdGggKiBoZWlnaHQ7XG4gIFxuICAvLyBHZW5lcmF0ZSBlYWNoIGNlbGwgaW4gdGhlIGdyaWRcbiAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykge1xuICAgIGZvciAobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykge1xuICAgICAgLy8gQ2FsY3VsYXRlIHBpeGVsIGNvb3JkaW5hdGVzXG4gICAgICBjb25zdCBwaXhlbFggPSB4ICogY2VsbFdpZHRoO1xuICAgICAgY29uc3QgcGl4ZWxZID0geSAqIGNlbGxIZWlnaHQ7XG4gICAgICBcbiAgICAgIC8vIENhbGN1bGF0ZSBpbmRleFxuICAgICAgY29uc3QgaW5kZXggPSB5ICogd2lkdGggKyB4O1xuICAgICAgXG4gICAgICAvLyBDcmVhdGUgY2VsbCBwb3NpdGlvbiBpbmZvXG4gICAgICBjb25zdCBwb3NpdGlvbjogQ2VsbFBvc2l0aW9uID0ge1xuICAgICAgICB4LCB5LCBwaXhlbFgsIHBpeGVsWSwgaW5kZXgsIHRvdGFsOiB0b3RhbENlbGxzXG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBHZXQgdGV4dHVyZSBpbmRleCBmb3IgdGhpcyBwb3NpdGlvblxuICAgICAgY29uc3QgdGV4dHVyZUluZGV4ID0gZ2V0VGV4dHVyZUluZGV4KHBvc2l0aW9uKTtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHNwcml0ZSB3aXRoIHRoZSBzZWxlY3RlZCB0ZXh0dXJlXG4gICAgICBjb25zdCBjZWxsID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmVzW3RleHR1cmVJbmRleF0pO1xuICAgICAgY2VsbC5wb3NpdGlvbi5zZXQocGl4ZWxYLCBwaXhlbFkpO1xuICAgICAgXG4gICAgICAvLyBBZGQgdG8gY29udGFpbmVyXG4gICAgICBjb250YWluZXIuYWRkQ2hpbGQoY2VsbCk7XG4gICAgfVxuICB9XG4gIFxuICAvLyBDZW50ZXIgdGhlIGdyaWQgaWYgcmVxdWVzdGVkXG4gIGlmIChjZW50ZXJlZCkge1xuICAgIGNvbnN0IGdyaWRXaWR0aCA9IHdpZHRoICogY2VsbFdpZHRoO1xuICAgIGNvbnN0IGdyaWRIZWlnaHQgPSBoZWlnaHQgKiBjZWxsSGVpZ2h0O1xuICAgIGNvbnRhaW5lci5wb3NpdGlvbi5zZXQoLWdyaWRXaWR0aCAvIDIsIC1ncmlkSGVpZ2h0IC8gMik7XG4gIH1cbiAgXG4gIHJldHVybiBjb250YWluZXI7XG59XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBhIHJhbmdlIG9mIHRleHR1cmVzXG4gKiBcbiAqIEBjYXRlZ29yeSBMaWJyYXJ5XG4gKiBAcGFyYW0gdGV4dHVyZXMgLSBGdWxsIGFycmF5IG9mIHRleHR1cmVzXG4gKiBAcGFyYW0gc3RhcnRJbmRleCAtIFN0YXJ0aW5nIGluZGV4IChmcm9tIDApXG4gKiBAcGFyYW0gY291bnQgLSBOdW1iZXIgb2YgdGV4dHVyZXMgdG8gaW5jbHVkZVxuICogQHJldHVybnMgU3Vic2V0IG9mIHRleHR1cmVzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiAvLyBHZXQgdGhlIGxhc3QgMTIgZnJhbWVzIGZyb20gYSBzcHJpdGVzaGVldFxuICogY29uc3QgdGlsZVZhcmlhdGlvbnMgPSBnZXRUZXh0dXJlUmFuZ2UoZ3Jhc3NGcmFtZXMsIGdyYXNzRnJhbWVzLmxlbmd0aCAtIDEyLCAxMik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRleHR1cmVSYW5nZShcbiAgdGV4dHVyZXM6IFBJWEkuVGV4dHVyZVtdLFxuICBzdGFydEluZGV4OiBudW1iZXIsXG4gIGNvdW50OiBudW1iZXJcbik6IFBJWEkuVGV4dHVyZVtdIHtcbiAgcmV0dXJuIHRleHR1cmVzLnNsaWNlKHN0YXJ0SW5kZXgsIHN0YXJ0SW5kZXggKyBjb3VudCk7XG59XG5cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgQ29udGFpbmVyLCBHcmFwaGljcywgVGV4dCB9IGZyb20gJ3BpeGkuanMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIExvYWRpbmdTY2VuZU9wdGlvbnMge1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIHNxdWFyZVNpemU/OiBudW1iZXI7XG4gIG51bVNxdWFyZXM/OiBudW1iZXI7XG4gIHRleHQ/OiBzdHJpbmc7XG4gIHRleHRTdHlsZT86IFBhcnRpYWw8UElYSS5UZXh0U3R5bGU+O1xufVxuXG5jb25zdCBQQUxFVFRFID0gWzB4ZjBkYWIxLCAweGUzOWFhYywgMHhjNDVkOWYsIDB4NjM0YjdkLCAweDY0NjFjMiwgMHgyYmE5YjQsIDB4OTNkNGI1LCAweGYwZjZlOF07XG5cbmludGVyZmFjZSBQYXJ0aWNsZSB7XG4gIHNwcml0ZTogR3JhcGhpY3M7XG4gIHNwYXduVGltZTogbnVtYmVyO1xuICBkdXJhdGlvbjogbnVtYmVyO1xuICBzcGluUmF0ZTogbnVtYmVyO1xuICBzdGFydFg6IG51bWJlcjtcbiAgc3RhcnRZOiBudW1iZXI7XG4gIGVuZFk6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBEZWZhdWx0IGxvYWRpbmcgc2NlbmUgY29tcG9uZW50IGZvciBNb3hpXG4gKiBEaXNwbGF5cyBhbmltYXRlZCBwaXhlbCBzcXVhcmVzIGZhbGxpbmcgYWJvdmUgbG9hZGluZyB0ZXh0XG4gKiBcbiAqIEBjYXRlZ29yeSBMaWJyYXJ5XG4gKi9cbmV4cG9ydCBjbGFzcyBMb2FkaW5nU2NlbmUgZXh0ZW5kcyBDb250YWluZXIge1xuICBwcml2YXRlIHBhcnRpY2xlczogUGFydGljbGVbXSA9IFtdO1xuICBwcml2YXRlIHRleHQ6IFRleHQ7XG4gIHByaXZhdGUgYmFja2dyb3VuZDogR3JhcGhpY3M7XG4gIHByaXZhdGUgdGlja2VyOiBQSVhJLlRpY2tlcjtcbiAgcHJpdmF0ZSByZW5kZXJlcjogUElYSS5SZW5kZXJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHRpbWU6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgbmV4dFNwYXduOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIG1heFBhcnRpY2xlczogbnVtYmVyO1xuICBwcml2YXRlIGJhc2VTaXplOiBudW1iZXI7XG4gIHByaXZhdGUgYmFja2dyb3VuZENvbG9yOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogTG9hZGluZ1NjZW5lT3B0aW9ucyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcblxuICAgIGNvbnN0IHtcbiAgICAgIGJhY2tncm91bmRDb2xvciA9IDB4MWExYTFhLFxuICAgICAgc3F1YXJlU2l6ZSA9IDIwLFxuICAgICAgbnVtU3F1YXJlcyA9IDMwLFxuICAgICAgdGV4dCA9ICdMT0FESU5HLi4uJyxcbiAgICAgIHRleHRTdHlsZSA9IHt9XG4gICAgfSA9IG9wdGlvbnM7XG5cbiAgICB0aGlzLm1heFBhcnRpY2xlcyA9IG51bVNxdWFyZXM7XG4gICAgdGhpcy5iYXNlU2l6ZSA9IHNxdWFyZVNpemU7XG4gICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3I7XG5cbiAgICAvLyBCYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IEdyYXBoaWNzKCk7XG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQpO1xuXG4gICAgLy8gVGV4dFxuICAgIHRoaXMudGV4dCA9IG5ldyBUZXh0KHtcbiAgICAgIHRleHQsXG4gICAgICBzdHlsZToge1xuICAgICAgICBmb250RmFtaWx5OiAnQ291cmllciBOZXcsIG1vbm9zcGFjZScsXG4gICAgICAgIGZvbnRTaXplOiAxNixcbiAgICAgICAgZmlsbDogMHhmZmZmZmYsXG4gICAgICAgIGZvbnRXZWlnaHQ6ICdib2xkJyxcbiAgICAgICAgLi4udGV4dFN0eWxlXG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy50ZXh0LmFuY2hvci5zZXQoMC41KTtcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMudGV4dCk7XG5cbiAgICAvLyBUaWNrZXJcbiAgICB0aGlzLnRpY2tlciA9IG5ldyBQSVhJLlRpY2tlcigpO1xuICAgIHRoaXMudGlja2VyLmF1dG9TdGFydCA9IGZhbHNlO1xuICAgIHRoaXMudGlja2VyLmFkZCgoKSA9PiB7XG4gICAgICBpZiAodGhpcy52aXNpYmxlICYmIHRoaXMucmVuZGVyZXIpIHtcbiAgICAgICAgdGhpcy50aW1lICs9IHRoaXMudGlja2VyLmRlbHRhVGltZSAvIDYwO1xuICAgICAgICB0aGlzLnVwZGF0ZSh0aGlzLnJlbmRlcmVyLndpZHRoLCB0aGlzLnJlbmRlcmVyLmhlaWdodCk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHRoaXMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBzcGF3blBhcnRpY2xlKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucGFydGljbGVzLmxlbmd0aCA+PSB0aGlzLm1heFBhcnRpY2xlcyB8fCB0aGlzLnRpbWUgPCB0aGlzLm5leHRTcGF3bikgcmV0dXJuO1xuXG4gICAgY29uc3Qgc2l6ZSA9IHRoaXMuYmFzZVNpemUgKiAoMC43ICsgTWF0aC5yYW5kb20oKSAqIDAuNik7XG4gICAgY29uc3Qgc3ByaXRlID0gbmV3IEdyYXBoaWNzKCk7XG4gICAgc3ByaXRlLnJlY3QoMCwgMCwgc2l6ZSwgc2l6ZSk7XG4gICAgc3ByaXRlLmZpbGwoeyBjb2xvcjogUEFMRVRURVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBQQUxFVFRFLmxlbmd0aCldIH0pO1xuICAgIHNwcml0ZS5waXZvdC5zZXQoc2l6ZSAvIDIsIHNpemUgLyAyKTtcbiAgICB0aGlzLmFkZENoaWxkKHNwcml0ZSk7XG5cbiAgICBjb25zdCB0ZXh0WSA9IGhlaWdodCAvIDIgKyA2MDtcbiAgICBjb25zdCB0ZXh0V2lkdGggPSB0aGlzLnRleHQud2lkdGggfHwgMjAwO1xuICAgIGNvbnN0IHRleHRDZW50ZXJYID0gd2lkdGggLyAyO1xuXG4gICAgdGhpcy5wYXJ0aWNsZXMucHVzaCh7XG4gICAgICBzcHJpdGUsXG4gICAgICBzcGF3blRpbWU6IHRoaXMudGltZSxcbiAgICAgIGR1cmF0aW9uOiAxICsgTWF0aC5yYW5kb20oKSAqIDIuNSxcbiAgICAgIHNwaW5SYXRlOiAoMC4wNSArIE1hdGgucmFuZG9tKCkgKiAxLjA3NSkgKiAoTWF0aC5yYW5kb20oKSA8IDAuNSA/IDEgOiAtMSksXG4gICAgICBzdGFydFg6IHRleHRDZW50ZXJYIC0gdGV4dFdpZHRoIC8gMiArIE1hdGgucmFuZG9tKCkgKiB0ZXh0V2lkdGggLSA0LFxuICAgICAgc3RhcnRZOiB0ZXh0WSAtIDEwMCxcbiAgICAgIGVuZFk6IHRleHRZIC0gNDAsXG4gICAgfSk7XG5cbiAgICB0aGlzLm5leHRTcGF3biA9IHRoaXMudGltZSArIE1hdGgucmFuZG9tKCkgKiAwLjU7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIC8vIEJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQuY2xlYXIoKTtcbiAgICB0aGlzLmJhY2tncm91bmQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB0aGlzLmJhY2tncm91bmQuZmlsbCh7IGNvbG9yOiB0aGlzLmJhY2tncm91bmRDb2xvciB9KTtcblxuICAgIC8vIFRleHQgcG9zaXRpb25cbiAgICB0aGlzLnRleHQueCA9IHdpZHRoIC8gMiAtIDQ7XG4gICAgdGhpcy50ZXh0LnkgPSBoZWlnaHQgLyAyICsgNjA7XG5cbiAgICAvLyBTcGF3biBwYXJ0aWNsZXNcbiAgICB0aGlzLnNwYXduUGFydGljbGUod2lkdGgsIGhlaWdodCk7XG5cbiAgICAvLyBVcGRhdGUgcGFydGljbGVzXG4gICAgdGhpcy5wYXJ0aWNsZXMgPSB0aGlzLnBhcnRpY2xlcy5maWx0ZXIocCA9PiB7XG4gICAgICBjb25zdCBlbGFwc2VkID0gdGhpcy50aW1lIC0gcC5zcGF3blRpbWU7XG4gICAgICBjb25zdCBwcm9ncmVzcyA9IGVsYXBzZWQgLyBwLmR1cmF0aW9uO1xuXG4gICAgICBpZiAocHJvZ3Jlc3MgPCAwIHx8IHByb2dyZXNzID4gMSkge1xuICAgICAgICBwLnNwcml0ZS5kZXN0cm95KCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgcC5zcHJpdGUueCA9IHAuc3RhcnRYO1xuICAgICAgcC5zcHJpdGUueSA9IHAuc3RhcnRZICsgKHAuZW5kWSAtIHAuc3RhcnRZKSAqIHByb2dyZXNzO1xuICAgICAgcC5zcHJpdGUucm90YXRpb24gPSB0aGlzLnRpbWUgKiBwLnNwaW5SYXRlICogTWF0aC5QSSAqIDI7XG4gICAgICBwLnNwcml0ZS5hbHBoYSA9IHByb2dyZXNzIDwgMC4xID8gcHJvZ3Jlc3MgLyAwLjEgOiBwcm9ncmVzcyA+IDAuODUgPyAoMSAtIHByb2dyZXNzKSAvIDAuMTUgOiAxO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG4gIH1cblxuICBpbml0KHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyKTogdm9pZCB7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICB9XG5cbiAgc2hvdygpOiB2b2lkIHtcbiAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMudGltZSA9IDA7XG4gICAgdGhpcy5uZXh0U3Bhd24gPSAwO1xuICAgIHRoaXMucGFydGljbGVzLmZvckVhY2gocCA9PiBwLnNwcml0ZS5kZXN0cm95KCkpO1xuICAgIHRoaXMucGFydGljbGVzID0gW107XG4gICAgaWYgKCF0aGlzLnRpY2tlci5zdGFydGVkKSB7XG4gICAgICB0aGlzLnRpY2tlci5zdGFydCgpO1xuICAgIH1cbiAgfVxuXG4gIGhpZGUoKTogdm9pZCB7XG4gICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XG4gICAgaWYgKHRoaXMudGlja2VyLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMudGlja2VyLnN0b3AoKTtcbiAgICB9XG4gIH1cblxuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnRpY2tlci5zdGFydGVkKSB7XG4gICAgICB0aGlzLnRpY2tlci5zdG9wKCk7XG4gICAgfVxuICAgIHRoaXMudGlja2VyLmRlc3Ryb3koKTtcbiAgICB0aGlzLnBhcnRpY2xlcy5mb3JFYWNoKHAgPT4gcC5zcHJpdGUuZGVzdHJveSgpKTtcbiAgICBzdXBlci5kZXN0cm95KCk7XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBNb3hpRW50aXR5LCBBc0VudGl0eSwgYXNFbnRpdHkgfSBmcm9tICcuLi9jb3JlL21veGktZW50aXR5JztcbmltcG9ydCB7IExvZ2ljIH0gZnJvbSAnLi4vY29yZS9sb2dpYyc7XG5pbXBvcnQgeyBDYW1lcmEgfSBmcm9tICcuLi9jb3JlL2NhbWVyYSc7XG5pbXBvcnQgeyBQYXJhbGxheExheWVyIH0gZnJvbSAnLi9wYXJhbGxheC1sYXllcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFyYWxsYXhCYWNrZ3JvdW5kT3B0aW9ucyB7XG4gIGNhbWVyYT86IENhbWVyYTsgICAgICAgICAgICAgICAgICAgIC8vIFJlZmVyZW5jZSB0byBjYW1lcmEgKGF1dG8tZGV0ZWN0ZWQgaWYgbm90IHByb3ZpZGVkKVxuICBzY3JvbGxPZmZzZXQ/OiBQSVhJLlBvaW50OyAgICAgICAgICAvLyBCYXNlIHNjcm9sbCBvZmZzZXRcbiAgc2Nyb2xsQmFzZVNjYWxlPzogUElYSS5Qb2ludDsgICAgICAgLy8gQmFzZSBzY2FsZSBtdWx0aXBsaWVyXG4gIHNjcm9sbElnbm9yZUNhbWVyYVpvb20/OiBib29sZWFuOyAgIC8vIERpc2FibGUgem9vbSBhZmZlY3RpbmcgcGFyYWxsYXhcbiAgYXV0b3Njcm9sbD86IFBJWEkuUG9pbnQ7ICAgICAgICAgICAgLy8gQXV0b21hdGljIHNjcm9sbGluZyBpbmRlcGVuZGVudCBvZiBjYW1lcmFcbn1cblxuLyoqXG4gKiBDb250YWluZXIgZm9yIGFsbCBwYXJhbGxheCBsYXllcnMgdGhhdCBtYW5hZ2VzIGdsb2JhbCBwYXJhbGxheCBiZWhhdmlvclxuICogYW5kIGNvb3JkaW5hdGVzIHdpdGggdGhlIENhbWVyYSBzeXN0ZW0uXG4gKlxuICogSW5zcGlyZWQgYnkgR29kb3QncyBQYXJhbGxheEJhY2tncm91bmQgbm9kZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgcGFyYWxsYXggPSBuZXcgUGFyYWxsYXhCYWNrZ3JvdW5kKCk7XG4gKiBjb25zdCBza3lMYXllciA9IG5ldyBUaWxpbmdQYXJhbGxheExheWVyKHtcbiAqICAgdGV4dHVyZTogc2t5VGV4dHVyZSxcbiAqICAgc2Nyb2xsU2NhbGU6IG5ldyBQSVhJLlBvaW50KDAuMiwgMC4yKVxuICogfSk7XG4gKiBwYXJhbGxheC5hZGRMYXllcihza3lMYXllcik7XG4gKiBzY2VuZS5hZGRDaGlsZChwYXJhbGxheCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFBhcmFsbGF4QmFja2dyb3VuZCBleHRlbmRzIFBJWEkuQ29udGFpbmVyIGltcGxlbWVudHMgQXNFbnRpdHk8UElYSS5Db250YWluZXI+IHtcbiAgcHVibGljIG1veGlFbnRpdHk6IE1veGlFbnRpdHk8UElYSS5Db250YWluZXI+O1xuICBwdWJsaWMgY2FtZXJhOiBDYW1lcmEgfCBudWxsID0gbnVsbDtcbiAgcHVibGljIHNjcm9sbE9mZnNldDogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICBwdWJsaWMgc2Nyb2xsQmFzZVNjYWxlOiBQSVhJLlBvaW50ID0gbmV3IFBJWEkuUG9pbnQoMSwgMSk7XG4gIHB1YmxpYyBzY3JvbGxJZ25vcmVDYW1lcmFab29tOiBib29sZWFuID0gZmFsc2U7XG4gIHB1YmxpYyBhdXRvc2Nyb2xsOiBQSVhJLlBvaW50ID0gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogUGFyYWxsYXhCYWNrZ3JvdW5kT3B0aW9ucyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcblxuICAgIC8vIEFwcGx5IG9wdGlvbnNcbiAgICB0aGlzLmNhbWVyYSA9IG9wdGlvbnMuY2FtZXJhID8/IG51bGw7XG4gICAgdGhpcy5zY3JvbGxPZmZzZXQgPSBvcHRpb25zLnNjcm9sbE9mZnNldCA/PyBuZXcgUElYSS5Qb2ludCgwLCAwKTtcbiAgICB0aGlzLnNjcm9sbEJhc2VTY2FsZSA9IG9wdGlvbnMuc2Nyb2xsQmFzZVNjYWxlID8/IG5ldyBQSVhJLlBvaW50KDEsIDEpO1xuICAgIHRoaXMuc2Nyb2xsSWdub3JlQ2FtZXJhWm9vbSA9IG9wdGlvbnMuc2Nyb2xsSWdub3JlQ2FtZXJhWm9vbSA/PyBmYWxzZTtcbiAgICB0aGlzLmF1dG9zY3JvbGwgPSBvcHRpb25zLmF1dG9zY3JvbGwgPz8gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG5cbiAgICAvLyBDb252ZXJ0IHRvIE1veGkgZW50aXR5IHdpdGggUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWNcbiAgICBjb25zdCBlbnRpdHkgPSBhc0VudGl0eSh0aGlzKTtcbiAgICBlbnRpdHkubW94aUVudGl0eS5hZGRMb2dpYyhuZXcgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMoKSk7XG4gICAgdGhpcy5tb3hpRW50aXR5ID0gZW50aXR5Lm1veGlFbnRpdHk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIFBhcmFsbGF4TGF5ZXIgdG8gdGhlIGJhY2tncm91bmRcbiAgICovXG4gIGFkZExheWVyKGxheWVyOiBQYXJhbGxheExheWVyKTogdm9pZCB7XG4gICAgdGhpcy5hZGRDaGlsZChsYXllcik7XG4gIH1cblxuICAvKipcbiAgICogQXV0by1kZXRlY3QgY2FtZXJhIGZyb20gc2NlbmUgaGllcmFyY2h5XG4gICAqL1xuICBwcml2YXRlIGRldGVjdENhbWVyYSgpOiBDYW1lcmEgfCBudWxsIHtcbiAgICBsZXQgY3VycmVudCA9IHRoaXMucGFyZW50O1xuICAgIHdoaWxlIChjdXJyZW50KSB7XG4gICAgICBpZiAoY3VycmVudCBpbnN0YW5jZW9mIENhbWVyYSkge1xuICAgICAgICByZXR1cm4gY3VycmVudDtcbiAgICAgIH1cbiAgICAgIGN1cnJlbnQgPSBjdXJyZW50LnBhcmVudDtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBlZmZlY3RpdmUgY2FtZXJhIHBvc2l0aW9uIGZvciBwYXJhbGxheCBjYWxjdWxhdGlvblxuICAgKi9cbiAgZ2V0Q2FtZXJhUG9zaXRpb24oKTogUElYSS5Qb2ludCB7XG4gICAgY29uc3QgY2FtZXJhID0gdGhpcy5jYW1lcmEgPz8gdGhpcy5kZXRlY3RDYW1lcmEoKTtcbiAgICBpZiAoIWNhbWVyYSkge1xuICAgICAgcmV0dXJuIG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICAgIH1cblxuICAgIC8vIEluIE1PWEkncyBjYW1lcmEgc3lzdGVtLCBjYW1lcmEucG9zaXRpb24gcmVwcmVzZW50cyB3aGVyZSB0aGUgY2FtZXJhIGlzIGxvb2tpbmdcbiAgICAvLyBUaGUgc2NlbmUgaXMgcG9zaXRpb25lZCBhdCAtY2FtZXJhLnBvc2l0aW9uIHRvIGNyZWF0ZSB0aGUgY2FtZXJhIGVmZmVjdFxuICAgIHJldHVybiBuZXcgUElYSS5Qb2ludChcbiAgICAgIGNhbWVyYS5wb3NpdGlvbi54LFxuICAgICAgY2FtZXJhLnBvc2l0aW9uLnlcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgZWZmZWN0aXZlIGNhbWVyYSBzY2FsZS96b29tIGZvciBwYXJhbGxheCBjYWxjdWxhdGlvblxuICAgKi9cbiAgZ2V0Q2FtZXJhU2NhbGUoKTogUElYSS5Qb2ludCB7XG4gICAgaWYgKHRoaXMuc2Nyb2xsSWdub3JlQ2FtZXJhWm9vbSkge1xuICAgICAgcmV0dXJuIG5ldyBQSVhJLlBvaW50KDEsIDEpO1xuICAgIH1cblxuICAgIGNvbnN0IGNhbWVyYSA9IHRoaXMuY2FtZXJhID8/IHRoaXMuZGV0ZWN0Q2FtZXJhKCk7XG4gICAgaWYgKCFjYW1lcmEpIHtcbiAgICAgIHJldHVybiBuZXcgUElYSS5Qb2ludCgxLCAxKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFBJWEkuUG9pbnQoY2FtZXJhLnNjYWxlLngsIGNhbWVyYS5zY2FsZS55KTtcbiAgfVxufVxuXG4vKipcbiAqIExvZ2ljIGNvbXBvbmVudCB0aGF0IHVwZGF0ZXMgdGhlIHBhcmFsbGF4IGJhY2tncm91bmQgYmFzZWQgb24gY2FtZXJhIG1vdmVtZW50IGFuZCBhdXRvc2Nyb2xsLlxuICovXG5leHBvcnQgY2xhc3MgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMgZXh0ZW5kcyBMb2dpYzxQYXJhbGxheEJhY2tncm91bmQ+IHtcbiAgbmFtZSA9ICdQYXJhbGxheEJhY2tncm91bmRMb2dpYyc7XG5cbiAgdXBkYXRlKGVudGl0eTogUGFyYWxsYXhCYWNrZ3JvdW5kLCBkZWx0YVRpbWU6IG51bWJlcikge1xuICAgIC8vIEFwcGx5IGF1dG9zY3JvbGxcbiAgICBpZiAoZW50aXR5LmF1dG9zY3JvbGwueCAhPT0gMCB8fCBlbnRpdHkuYXV0b3Njcm9sbC55ICE9PSAwKSB7XG4gICAgICBlbnRpdHkuc2Nyb2xsT2Zmc2V0LnggKz0gZW50aXR5LmF1dG9zY3JvbGwueCAqIGRlbHRhVGltZTtcbiAgICAgIGVudGl0eS5zY3JvbGxPZmZzZXQueSArPSBlbnRpdHkuYXV0b3Njcm9sbC55ICogZGVsdGFUaW1lO1xuICAgIH1cblxuICAgIC8vIEdldCBjYW1lcmEgcG9zaXRpb24gZm9yIGNoaWxkIGxheWVycyB0byByZWZlcmVuY2VcbiAgICBjb25zdCBjYW1lcmFQb3MgPSBlbnRpdHkuZ2V0Q2FtZXJhUG9zaXRpb24oKTtcbiAgICBjb25zdCBjYW1lcmFTY2FsZSA9IGVudGl0eS5nZXRDYW1lcmFTY2FsZSgpO1xuXG4gICAgLy8gUG9zaXRpb24gdGhlIFBhcmFsbGF4QmFja2dyb3VuZCB0byBzdGF5IHNjcmVlbi1hbGlnbmVkXG4gICAgLy8gU2luY2UgUGFyYWxsYXhCYWNrZ3JvdW5kIGlzIGEgY2hpbGQgb2Ygc2NlbmUgd2l0aCBwaXZvdCBhdCB2aWV3cG9ydCBjZW50ZXIsXG4gICAgLy8gd2UgbmVlZCB0byBjb3VudGVyLXNjYWxlIHRvIGtlZXAgbGF5ZXJzIGF0IDE6MSBzY3JlZW4gc2NhbGVcbiAgICBjb25zdCBzY2VuZSA9IGVudGl0eS5wYXJlbnQ7XG4gICAgaWYgKHNjZW5lKSB7XG4gICAgICAvLyBQb3NpdGlvbiB0byBzdGF5IGNlbnRlcmVkIG9uIHZpZXdwb3J0IGRlc3BpdGUgY2FtZXJhIG1vdmVtZW50XG4gICAgICAvLyBBY2NvdW50IGZvciBzY2VuZSBzY2FsZSBzaW5jZSBzY2VuZS5wb3NpdGlvbiBpcyBzY2FsZWRcbiAgICAgIGVudGl0eS5wb3NpdGlvbi54ID0gY2FtZXJhUG9zLnggLyBzY2VuZS5zY2FsZS54O1xuICAgICAgZW50aXR5LnBvc2l0aW9uLnkgPSBjYW1lcmFQb3MueSAvIHNjZW5lLnNjYWxlLnk7XG5cbiAgICAgIC8vIENvdW50ZXItc2NhbGUgdG8gY2FuY2VsIGluaGVyaXRlZCBzY2VuZSBzY2FsZVxuICAgICAgLy8gVGhpcyBrZWVwcyBUaWxpbmdTcHJpdGUgc2l6aW5nIGluIHNjcmVlbi1zcGFjZSBjb29yZGluYXRlc1xuICAgICAgZW50aXR5LnNjYWxlLnggPSAxIC8gc2NlbmUuc2NhbGUueDtcbiAgICAgIGVudGl0eS5zY2FsZS55ID0gMSAvIHNjZW5lLnNjYWxlLnk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVudGl0eS5wb3NpdGlvbi54ID0gY2FtZXJhUG9zLng7XG4gICAgICBlbnRpdHkucG9zaXRpb24ueSA9IGNhbWVyYVBvcy55O1xuICAgICAgZW50aXR5LnNjYWxlLnNldCgxLCAxKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgYWxsIGNoaWxkIFBhcmFsbGF4TGF5ZXJzXG4gICAgZW50aXR5LmNoaWxkcmVuLmZvckVhY2goKGNoaWxkOiBhbnkpID0+IHtcbiAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIFBhcmFsbGF4TGF5ZXIpIHtcbiAgICAgICAgY2hpbGQudXBkYXRlUGFyYWxsYXgoY2FtZXJhUG9zLCBjYW1lcmFTY2FsZSwgZW50aXR5LnNjcm9sbE9mZnNldCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBNb3hpRW50aXR5LCBBc0VudGl0eSwgYXNFbnRpdHkgfSBmcm9tICcuLi9jb3JlL21veGktZW50aXR5JztcblxuZXhwb3J0IGludGVyZmFjZSBQYXJhbGxheExheWVyT3B0aW9ucyB7XG4gIHNjcm9sbFNjYWxlPzogUElYSS5Qb2ludDsgICAgICAvLyBNb3Rpb24gbXVsdGlwbGllciAoMC41ID0gaGFsZiBzcGVlZCwgbGlrZSBHb2RvdCdzIG1vdGlvbl9zY2FsZSlcbiAgc2Nyb2xsT2Zmc2V0PzogUElYSS5Qb2ludDsgICAgIC8vIExheWVyIG9mZnNldCBmb3IgcG9zaXRpb25pbmcgKGxpa2UgR29kb3QncyBtb3Rpb25fb2Zmc2V0KVxuICByZXBlYXRTaXplPzogUElYSS5Qb2ludDsgICAgICAgLy8gTWlycm9yaW5nL3JlcGVhdCBpbnRlcnZhbCAoMCA9IG5vIHJlcGVhdCwgbGlrZSBHb2RvdCdzIG1vdGlvbl9taXJyb3JpbmcpXG4gIG1pcnJvcmluZz86IGJvb2xlYW47ICAgICAgICAgICAvLyBFbmFibGUgYXV0b21hdGljIG1pcnJvcmluZyAocmVxdWlyZXMgcmVwZWF0U2l6ZSlcbn1cblxuLyoqXG4gKiBJbmRpdmlkdWFsIHBhcmFsbGF4IGxheWVyIHRoYXQgc2Nyb2xscyBhdCBhIGRpZmZlcmVudCBzcGVlZCBiYXNlZCBvbiBzY3JvbGxTY2FsZS5cbiAqXG4gKiBJbnNwaXJlZCBieSBHb2RvdCdzIFBhcmFsbGF4TGF5ZXIgbm9kZS5cbiAqXG4gKiBUaGUgc2Nyb2xsU2NhbGUgcHJvcGVydHkgY29udHJvbHMgaG93IGZhc3QgdGhlIGxheWVyIG1vdmVzIHJlbGF0aXZlIHRvIHRoZSBjYW1lcmE6XG4gKiAtIDAuMCA9IFN0YXRpYyAoZG9lc24ndCBtb3ZlIHdpdGggY2FtZXJhLCBnb29kIGZvciBVSS9IVUQpXG4gKiAtIDAuMiA9IFNsb3cgKGFwcGVhcnMgZmFyIGF3YXksIGxpa2Ugc2t5KVxuICogLSAwLjUgPSBNZWRpdW0gKG1pZC1ncm91bmQgZWxlbWVudHMpXG4gKiAtIDAuOSA9IEZhc3QgKGZvcmVncm91bmQgZWxlbWVudHMpXG4gKiAtIDEuMCA9IE1vdmVzIHdpdGggY2FtZXJhIChnYW1lIGVudGl0aWVzKVxuICogLSA+MS4wID0gRmFzdGVyIHRoYW4gY2FtZXJhIChyZXZlcnNlIHBhcmFsbGF4IGVmZmVjdClcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgbGF5ZXIgPSBuZXcgUGFyYWxsYXhMYXllcih7XG4gKiAgIHNjcm9sbFNjYWxlOiBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSksIC8vIEhhbGYgY2FtZXJhIHNwZWVkXG4gKiAgIHNjcm9sbE9mZnNldDogbmV3IFBJWEkuUG9pbnQoMCwgMClcbiAqIH0pO1xuICpcbiAqIC8vIEFkZCBzcHJpdGVzIHRvIHRoZSBsYXllclxuICogY29uc3Qgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xuICogbGF5ZXIuYWRkQ2hpbGQoc3ByaXRlKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgUGFyYWxsYXhMYXllciBleHRlbmRzIFBJWEkuQ29udGFpbmVyIGltcGxlbWVudHMgQXNFbnRpdHk8UElYSS5Db250YWluZXI+IHtcbiAgcHVibGljIG1veGlFbnRpdHk6IE1veGlFbnRpdHk8UElYSS5Db250YWluZXI+O1xuICBwdWJsaWMgc2Nyb2xsU2NhbGU6IFBJWEkuUG9pbnQgPSBuZXcgUElYSS5Qb2ludCgxLCAxKTtcbiAgcHVibGljIHNjcm9sbE9mZnNldDogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICBwdWJsaWMgcmVwZWF0U2l6ZTogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICBwdWJsaWMgbWlycm9yaW5nOiBib29sZWFuID0gZmFsc2U7XG5cbiAgLy8gSW50ZXJuYWwgc3RhdGVcbiAgcHJpdmF0ZSBfbGFzdENhbWVyYVBvczogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IFBhcmFsbGF4TGF5ZXJPcHRpb25zID0ge30pIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5zY3JvbGxTY2FsZSA9IG9wdGlvbnMuc2Nyb2xsU2NhbGUgPz8gbmV3IFBJWEkuUG9pbnQoMSwgMSk7XG4gICAgdGhpcy5zY3JvbGxPZmZzZXQgPSBvcHRpb25zLnNjcm9sbE9mZnNldCA/PyBuZXcgUElYSS5Qb2ludCgwLCAwKTtcbiAgICB0aGlzLnJlcGVhdFNpemUgPSBvcHRpb25zLnJlcGVhdFNpemUgPz8gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG4gICAgdGhpcy5taXJyb3JpbmcgPSBvcHRpb25zLm1pcnJvcmluZyA/PyBmYWxzZTtcblxuICAgIC8vIENvbnZlcnQgdG8gTW94aSBlbnRpdHlcbiAgICBjb25zdCBlbnRpdHkgPSBhc0VudGl0eSh0aGlzKTtcbiAgICB0aGlzLm1veGlFbnRpdHkgPSBlbnRpdHkubW94aUVudGl0eTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgbGF5ZXIgcG9zaXRpb24gYmFzZWQgb24gY2FtZXJhIG1vdmVtZW50LlxuICAgKiBDYWxsZWQgYnkgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMgZWFjaCBmcmFtZS5cbiAgICpcbiAgICogQHBhcmFtIGNhbWVyYVBvcyAtIEN1cnJlbnQgY2FtZXJhIHBvc2l0aW9uIGluIHdvcmxkIHNwYWNlXG4gICAqIEBwYXJhbSBjYW1lcmFTY2FsZSAtIEN1cnJlbnQgY2FtZXJhIHNjYWxlL3pvb21cbiAgICogQHBhcmFtIGJhY2tncm91bmRPZmZzZXQgLSBHbG9iYWwgYmFja2dyb3VuZCBzY3JvbGwgb2Zmc2V0XG4gICAqL1xuICB1cGRhdGVQYXJhbGxheChcbiAgICBjYW1lcmFQb3M6IFBJWEkuUG9pbnQsXG4gICAgY2FtZXJhU2NhbGU6IFBJWEkuUG9pbnQsXG4gICAgYmFja2dyb3VuZE9mZnNldDogUElYSS5Qb2ludFxuICApOiB2b2lkIHtcbiAgICAvLyBDYWxjdWxhdGUgZWZmZWN0aXZlIHNjcm9sbCBvZmZzZXRcbiAgICBjb25zdCBzY3JvbGxYID0gKGNhbWVyYVBvcy54ICsgYmFja2dyb3VuZE9mZnNldC54KSAqIHRoaXMuc2Nyb2xsU2NhbGUueDtcbiAgICBjb25zdCBzY3JvbGxZID0gKGNhbWVyYVBvcy55ICsgYmFja2dyb3VuZE9mZnNldC55KSAqIHRoaXMuc2Nyb2xsU2NhbGUueTtcblxuICAgIC8vIEFwcGx5IHRvIGxheWVyIHBvc2l0aW9uXG4gICAgdGhpcy5wb3NpdGlvbi54ID0gLXNjcm9sbFggKyB0aGlzLnNjcm9sbE9mZnNldC54O1xuICAgIHRoaXMucG9zaXRpb24ueSA9IC1zY3JvbGxZICsgdGhpcy5zY3JvbGxPZmZzZXQueTtcblxuICAgIC8vIEhhbmRsZSBtaXJyb3Jpbmcvd3JhcHBpbmcgaWYgZW5hYmxlZFxuICAgIGlmICh0aGlzLm1pcnJvcmluZykge1xuICAgICAgaWYgKHRoaXMucmVwZWF0U2l6ZS54ID4gMCkge1xuICAgICAgICB0aGlzLnBvc2l0aW9uLnggPSB0aGlzLnBvc2l0aW9uLnggJSB0aGlzLnJlcGVhdFNpemUueDtcbiAgICAgICAgaWYgKHRoaXMucG9zaXRpb24ueCA+IDApIHRoaXMucG9zaXRpb24ueCAtPSB0aGlzLnJlcGVhdFNpemUueDtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnJlcGVhdFNpemUueSA+IDApIHtcbiAgICAgICAgdGhpcy5wb3NpdGlvbi55ID0gdGhpcy5wb3NpdGlvbi55ICUgdGhpcy5yZXBlYXRTaXplLnk7XG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnkgPiAwKSB0aGlzLnBvc2l0aW9uLnkgLT0gdGhpcy5yZXBlYXRTaXplLnk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5fbGFzdENhbWVyYVBvcy5jb3B5RnJvbShjYW1lcmFQb3MpO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGlsaW5nUGFyYWxsYXhMYXllck9wdGlvbnMgZXh0ZW5kcyBQYXJhbGxheExheWVyT3B0aW9ucyB7XG4gIHRleHR1cmU6IFBJWEkuVGV4dHVyZTtcbiAgd2lkdGg/OiBudW1iZXI7XG4gIGhlaWdodD86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBTcGVjaWFsaXplZCBwYXJhbGxheCBsYXllciB1c2luZyBQSVhJLlRpbGluZ1Nwcml0ZSBmb3IgZWZmaWNpZW50IGluZmluaXRlIHNjcm9sbGluZy5cbiAqXG4gKiBUaGlzIGlzIHRoZSByZWNvbW1lbmRlZCBhcHByb2FjaCBmb3IgbGFyZ2UsIHJlcGVhdGluZyBiYWNrZ3JvdW5kcyBsaWtlIHNreSwgY2xvdWRzLFxuICogb3IgZ3JvdW5kIHRleHR1cmVzLiBUaWxpbmdTcHJpdGUgaXMgb3B0aW1pemVkIGZvciByZXBlYXRpbmcgcGF0dGVybnMgYW5kIHVzZXNcbiAqIHRpbGVQb3NpdGlvbiBmb3Igc2VhbWxlc3Mgc2Nyb2xsaW5nIHdpdGhvdXQgcmVwb3NpdGlvbmluZyB0aGUgY29udGFpbmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBza3lMYXllciA9IG5ldyBUaWxpbmdQYXJhbGxheExheWVyKHtcbiAqICAgdGV4dHVyZTogc2t5VGV4dHVyZSxcbiAqICAgc2Nyb2xsU2NhbGU6IG5ldyBQSVhJLlBvaW50KDAuMiwgMC4yKVxuICogICAvLyB3aWR0aC9oZWlnaHQgYXV0by1kZXRlY3RlZCBmcm9tIHJlbmRlcmVyXG4gKiB9KTtcbiAqIHBhcmFsbGF4QmFja2dyb3VuZC5hZGRMYXllcihza3lMYXllcik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFRpbGluZ1BhcmFsbGF4TGF5ZXIgZXh0ZW5kcyBQYXJhbGxheExheWVyIHtcbiAgcHVibGljIHRpbGluZ1Nwcml0ZTogUElYSS5UaWxpbmdTcHJpdGU7XG4gIHByaXZhdGUgX2F1dG9TaXplZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IFRpbGluZ1BhcmFsbGF4TGF5ZXJPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICAvLyBFbnN1cmUgdGV4dHVyZSB3cmFwcyBmb3Igc2VhbWxlc3MgdGlsaW5nXG4gICAgb3B0aW9ucy50ZXh0dXJlLnNvdXJjZS5zdHlsZS5hZGRyZXNzTW9kZSA9ICdyZXBlYXQnO1xuXG4gICAgLy8gSWYgZGltZW5zaW9ucyBub3QgcHJvdmlkZWQsIHVzZSB0ZW1wb3JhcnkgdmFsdWVzIGFuZCBhdXRvLWRldGVjdCBvbiBmaXJzdCB1cGRhdGVcbiAgICBjb25zdCB3aWR0aCA9IG9wdGlvbnMud2lkdGggPz8gMTtcbiAgICBjb25zdCBoZWlnaHQgPSBvcHRpb25zLmhlaWdodCA/PyAxO1xuXG4gICAgLy8gQ3JlYXRlIFRpbGluZ1Nwcml0ZSBhcyBjaGlsZFxuICAgIHRoaXMudGlsaW5nU3ByaXRlID0gbmV3IFBJWEkuVGlsaW5nU3ByaXRlKHtcbiAgICAgIHRleHR1cmU6IG9wdGlvbnMudGV4dHVyZSxcbiAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIH0pO1xuXG4gICAgLy8gUG9zaXRpb24gVGlsaW5nU3ByaXRlIHRvIHN0YXJ0IGZyb20gb3JpZ2luICgwLCAwKSB0byBjb3ZlciB0aGUgdmlld3BvcnRcbiAgICB0aGlzLnRpbGluZ1Nwcml0ZS5wb3NpdGlvbi5zZXQoMCwgMCk7XG5cbiAgICB0aGlzLmFkZENoaWxkKHRoaXMudGlsaW5nU3ByaXRlKTtcblxuICAgIC8vIE1hcmsgaWYgd2UgbmVlZCB0byBhdXRvLWRldGVjdCBkaW1lbnNpb25zXG4gICAgdGhpcy5fYXV0b1NpemVkID0gIW9wdGlvbnMud2lkdGggJiYgIW9wdGlvbnMuaGVpZ2h0O1xuICB9XG5cbiAgLyoqXG4gICAqIEF1dG8tZGV0ZWN0IHJlbmRlcmVyIGRpbWVuc2lvbnMgZnJvbSB0aGUgc2NlbmUgaGllcmFyY2h5XG4gICAqL1xuICBwcml2YXRlIGF1dG9EZXRlY3REaW1lbnNpb25zKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5fYXV0b1NpemVkKSByZXR1cm47XG5cbiAgICAvLyBXYWxrIHVwIHBhcmVudCBjaGFpbiB0byBmaW5kIGEgbm9kZSB3aXRoIGEgcmVuZGVyZXJcbiAgICBsZXQgY3VycmVudDogYW55ID0gdGhpcy5wYXJlbnQ7XG4gICAgd2hpbGUgKGN1cnJlbnQpIHtcbiAgICAgIGlmIChjdXJyZW50LnJlbmRlcmVyKSB7XG4gICAgICAgIC8vIEZvdW5kIGEgcmVuZGVyZXIgKHVzdWFsbHkgb24gU2NlbmUpXG4gICAgICAgIHRoaXMucmVzaXplKGN1cnJlbnQucmVuZGVyZXIud2lkdGgsIGN1cnJlbnQucmVuZGVyZXIuaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5fYXV0b1NpemVkID0gZmFsc2U7IC8vIE9ubHkgbmVlZCB0byBkbyB0aGlzIG9uY2VcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBPdmVycmlkZSB1cGRhdGVQYXJhbGxheCB0byB1c2UgdGlsZVBvc2l0aW9uIGluc3RlYWQgb2YgY29udGFpbmVyIHBvc2l0aW9uLlxuICAgKiBUaGlzIHByb3ZpZGVzIHNlYW1sZXNzIGluZmluaXRlIHNjcm9sbGluZyB3aXRob3V0IHZpc2libGUgc2VhbXMuXG4gICAqXG4gICAqIFNpbmNlIHRoZSBQYXJhbGxheEJhY2tncm91bmQgY29udGFpbmVyIG5vdyBmb2xsb3dzIHRoZSBjYW1lcmEsIGxheWVycyBpbnNpZGVcbiAgICogc3RheSBhdCAoMCwwKSBhbmQgb25seSB1c2UgdGlsZVBvc2l0aW9uIGZvciB0aGUgcGFyYWxsYXggc2Nyb2xsaW5nIGVmZmVjdC5cbiAgICpcbiAgICogQ2FtZXJhIHNjYWxlIGlzIHVzZWQgdG8gcmVzaXplIHRoZSBUaWxpbmdTcHJpdGUgdG8gY292ZXIgdGhlIHZpZXdwb3J0IGF0IGRpZmZlcmVudCB6b29tIGxldmVscy5cbiAgICovXG4gIHVwZGF0ZVBhcmFsbGF4KFxuICAgIGNhbWVyYVBvczogUElYSS5Qb2ludCxcbiAgICBjYW1lcmFTY2FsZTogUElYSS5Qb2ludCxcbiAgICBiYWNrZ3JvdW5kT2Zmc2V0OiBQSVhJLlBvaW50XG4gICk6IHZvaWQge1xuICAgIC8vIEF1dG8tZGV0ZWN0IGRpbWVuc2lvbnMgb24gZmlyc3QgdXBkYXRlIGlmIG5vdCBtYW51YWxseSBzcGVjaWZpZWRcbiAgICB0aGlzLmF1dG9EZXRlY3REaW1lbnNpb25zKCk7XG4gICAgLy8gY29uc29sZS5sb2coJ3VwZGF0ZVBhcmFsbGF4JywgY2FtZXJhU2NhbGUpO1xuXG4gICAgLy8gR2V0IHJlbmRlcmVyIGRpbWVuc2lvbnMgdG8gdXNlIGFzIGJhc2Ugc2l6ZVxuICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcy5wYXJlbnQ/LnBhcmVudCBhcyBhbnk7IC8vIEdldCByZW5kZXJlciBmcm9tIHNjZW5lXG4gICAgaWYgKHJlbmRlcmVyPy5yZW5kZXJlcikge1xuICAgICAgY29uc3QgYmFzZVdpZHRoID0gcmVuZGVyZXIucmVuZGVyZXIud2lkdGg7XG4gICAgICBjb25zdCBiYXNlSGVpZ2h0ID0gcmVuZGVyZXIucmVuZGVyZXIuaGVpZ2h0O1xuXG4gICAgICAvLyBQYXJhbGxheEJhY2tncm91bmQgY291bnRlci1zY2FsZXMsIHNvIHdlJ3JlIGluIHNjcmVlbi1zcGFjZVxuICAgICAgLy8gSnVzdCBzZXQgdG8gcmVuZGVyZXIgc2l6ZSAtIG5vIHpvb20gYWRqdXN0bWVudCBuZWVkZWRcbiAgICAgIHRoaXMudGlsaW5nU3ByaXRlLndpZHRoID0gYmFzZVdpZHRoO1xuICAgICAgdGhpcy50aWxpbmdTcHJpdGUuaGVpZ2h0ID0gYmFzZUhlaWdodDtcblxuICAgICAgLy8gS2VlcCBzcHJpdGUgYXQgb3JpZ2luXG4gICAgICB0aGlzLnRpbGluZ1Nwcml0ZS5waXZvdC5zZXQoMCwgMCk7XG4gICAgICB0aGlzLnRpbGluZ1Nwcml0ZS5wb3NpdGlvbi5zZXQoMCwgMCk7XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIGVmZmVjdGl2ZSBzY3JvbGwgb2Zmc2V0IGZvciB0aWxlUG9zaXRpb25cbiAgICBjb25zdCBzY3JvbGxYID0gKGNhbWVyYVBvcy54ICsgYmFja2dyb3VuZE9mZnNldC54KSAqIHRoaXMuc2Nyb2xsU2NhbGUueDtcbiAgICBjb25zdCBzY3JvbGxZID0gKGNhbWVyYVBvcy55ICsgYmFja2dyb3VuZE9mZnNldC55KSAqIHRoaXMuc2Nyb2xsU2NhbGUueTtcblxuICAgIC8vIEFwcGx5IHRvIHRpbGVQb3NpdGlvbiAod2l0aCBsYXllcidzIG93biBzY3JvbGxPZmZzZXQgZm9yIHBvc2l0aW9uaW5nKVxuICAgIHRoaXMudGlsaW5nU3ByaXRlLnRpbGVQb3NpdGlvbi54ID0gLXNjcm9sbFggKyB0aGlzLnNjcm9sbE9mZnNldC54O1xuICAgIHRoaXMudGlsaW5nU3ByaXRlLnRpbGVQb3NpdGlvbi55ID0gLXNjcm9sbFkgKyB0aGlzLnNjcm9sbE9mZnNldC55O1xuXG4gICAgLy8gTGF5ZXIgY29udGFpbmVyIHN0YXlzIGF0IG9yaWdpbiAtIHNjZW5lIHBpdm90IGhhbmRsZXMgem9vbSBhbmNob3JpbmdcbiAgICB0aGlzLnBvc2l0aW9uLnNldCgwLCAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgVGlsaW5nU3ByaXRlIGRpbWVuc2lvbnMgKGUuZy4sIG9uIHdpbmRvdyByZXNpemUpXG4gICAqL1xuICByZXNpemUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnRpbGluZ1Nwcml0ZS53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMudGlsaW5nU3ByaXRlLmhlaWdodCA9IGhlaWdodDtcbiAgfVxufVxuIiwiLyoqXG4gKiBQaHlzaWNzIG1vZHVsZSAtIFBsYW5jay5qcyBpbnRlZ3JhdGlvbiBmb3IgTU9YSVxuICpcbiAqIEBwYWNrYWdlRG9jdW1lbnRhdGlvblxuICovXG5cbi8vIENvcmUgY2xhc3Nlc1xuZXhwb3J0IHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi9waHlzaWNzLXdvcmxkJztcbmV4cG9ydCB7IFBoeXNpY3NCb2R5TG9naWMgfSBmcm9tICcuL3BoeXNpY3MtYm9keS1sb2dpYyc7XG5leHBvcnQgeyBDb2xsaXNpb25SZWdpc3RyeSwgQ29sbGlzaW9uTWFuYWdlciB9IGZyb20gJy4vcGh5c2ljcy1jb2xsaXNpb24nO1xuZXhwb3J0IHsgUGh5c2ljc0RlYnVnUmVuZGVyZXIgfSBmcm9tICcuL3BoeXNpY3MtZGVidWctcmVuZGVyZXInO1xuXG4vLyBVdGlsaXRpZXNcbmV4cG9ydCB7XG4gIGFzUGh5c2ljc0VudGl0eSxcbiAgaGFzUGh5c2ljcyxcbiAgZ2V0UGh5c2ljc0JvZHksXG4gIGNyZWF0ZVNoYXBlRnJvbVNwcml0ZVxufSBmcm9tICcuL3BoeXNpY3MtdXRpbHMnO1xuXG4vLyBNYXRlcmlhbHNcbmV4cG9ydCB7IFBoeXNpY3NNYXRlcmlhbHMsIGFwcGx5TWF0ZXJpYWwgfSBmcm9tICcuL3BoeXNpY3MtbWF0ZXJpYWxzJztcblxuLy8gVHlwZXNcbmV4cG9ydCB0eXBlIHtcbiAgQm9keVR5cGUsXG4gIFN5bmNNb2RlLFxuICBTaGFwZVR5cGUsXG4gIENvbGxpc2lvblRhZyxcbiAgU2hhcGVDb25maWcsXG4gIFBoeXNpY3NXb3JsZE9wdGlvbnMsXG4gIFBoeXNpY3NCb2R5T3B0aW9ucyxcbiAgUGh5c2ljc0RlYnVnT3B0aW9ucyxcbiAgQ29sbGlzaW9uRXZlbnQsXG4gIFJheWNhc3RDYWxsYmFja1xufSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCAqIGFzIHBsYW5jayBmcm9tICdwbGFuY2snO1xuaW1wb3J0IHsgTG9naWMgfSBmcm9tICcuLi8uLi9jb3JlL2xvZ2ljJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi9waHlzaWNzLXdvcmxkJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc0JvZHlPcHRpb25zLCBCb2R5VHlwZSwgU2hhcGVUeXBlIH0gZnJvbSAnLi9waHlzaWNzLXR5cGVzJztcbmltcG9ydCB7IHBhcnNlR3JhcGhpY3NTaGFwZSB9IGZyb20gJy4vcGh5c2ljcy1ncmFwaGljcy1wYXJzZXInO1xuXG4vKipcbiAqIFBoeXNpY3NCb2R5TG9naWMgLSBMb2dpYyBjb21wb25lbnQgdGhhdCBzeW5jaHJvbml6ZXMgYSBQSVhJIGVudGl0eSB3aXRoIGEgUGxhbmNrLmpzIHBoeXNpY3MgYm9keVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gKiBjb25zdCBlbnRpdHkgPSBhc0VudGl0eShzcHJpdGUpO1xuICpcbiAqIGNvbnN0IHBoeXNpY3NCb2R5ID0gbmV3IFBoeXNpY3NCb2R5TG9naWMocGh5c2ljc1dvcmxkLCB7XG4gKiAgIHR5cGU6ICdkeW5hbWljJyxcbiAqICAgc2hhcGU6ICdjaXJjbGUnLFxuICogICByYWRpdXM6IDI1LFxuICogICBkZW5zaXR5OiAxLjBcbiAqIH0pO1xuICpcbiAqIGVudGl0eS5tb3hpRW50aXR5LmFkZExvZ2ljKHBoeXNpY3NCb2R5KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgUGh5c2ljc0JvZHlMb2dpYyBleHRlbmRzIExvZ2ljPFBJWEkuQ29udGFpbmVyPiB7XG4gIG5hbWUgPSAnUGh5c2ljc0JvZHlMb2dpYyc7XG5cbiAgLyoqIFRoZSBQbGFuY2suanMgcGh5c2ljcyBib2R5ICovXG4gIHB1YmxpYyBib2R5ITogcGxhbmNrLkJvZHk7XG5cbiAgLyoqIFJlZmVyZW5jZSB0byB0aGUgcGh5c2ljcyB3b3JsZCAqL1xuICBwdWJsaWMgd29ybGQ6IFBoeXNpY3NXb3JsZDtcblxuICAvKiogUGh5c2ljcyBib2R5IG9wdGlvbnMgKi9cbiAgcHVibGljIG9wdGlvbnM6IFBoeXNpY3NCb2R5T3B0aW9ucztcblxuICAvKiogQ29sbGlzaW9uIGJlZ2luIGNhbGxiYWNrICovXG4gIHB1YmxpYyBvbkNvbGxpc2lvbkJlZ2luPzogKG90aGVyOiBQaHlzaWNzQm9keUxvZ2ljLCBjb250YWN0OiBwbGFuY2suQ29udGFjdCkgPT4gdm9pZDtcblxuICAvKiogQ29sbGlzaW9uIGVuZCBjYWxsYmFjayAqL1xuICBwdWJsaWMgb25Db2xsaXNpb25FbmQ/OiAob3RoZXI6IFBoeXNpY3NCb2R5TG9naWMsIGNvbnRhY3Q6IHBsYW5jay5Db250YWN0KSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKHdvcmxkOiBQaHlzaWNzV29ybGQsIG9wdGlvbnM6IFBoeXNpY3NCb2R5T3B0aW9ucyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLndvcmxkID0gd29ybGQ7XG4gICAgdGhpcy5vcHRpb25zID0ge1xuICAgICAgdHlwZTogJ2R5bmFtaWMnLFxuICAgICAgc3luY01vZGU6ICdwaHlzaWNzLWRyaXZlbicsXG4gICAgICBzeW5jUG9zaXRpb246IHRydWUsXG4gICAgICBzeW5jUm90YXRpb246IHRydWUsXG4gICAgICBkZW5zaXR5OiAxLjAsXG4gICAgICBmcmljdGlvbjogMC4zLFxuICAgICAgcmVzdGl0dXRpb246IDAuMCxcbiAgICAgIGZpeGVkUm90YXRpb246IGZhbHNlLFxuICAgICAgaXNTZW5zb3I6IGZhbHNlLFxuICAgICAgYnVsbGV0OiBmYWxzZSxcbiAgICAgIC4uLm9wdGlvbnNcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIHBoeXNpY3MgYm9keVxuICAgKi9cbiAgaW5pdChlbnRpdHk6IFBJWEkuQ29udGFpbmVyLCByZW5kZXJlcj86IFBJWEkuUmVuZGVyZXIpOiB2b2lkIHtcbiAgICAvLyBDcmVhdGUgdGhlIHBoeXNpY3MgYm9keVxuICAgIHRoaXMuY3JlYXRlUGh5c2ljc0JvZHkoZW50aXR5KTtcblxuICAgIC8vIFNldCB1c2VyIGRhdGEgdG8gcmVmZXJlbmNlIHRoaXMgbG9naWMgY29tcG9uZW50XG4gICAgdGhpcy5ib2R5LnNldFVzZXJEYXRhKHRoaXMpO1xuXG4gICAgLy8gUmVnaXN0ZXIgd2l0aCBwaHlzaWNzIHdvcmxkXG4gICAgdGhpcy53b3JsZC5yZWdpc3RlckJvZHkodGhpcy5ib2R5LCB0aGlzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgc3luY2hyb25pemF0aW9uIGJldHdlZW4gcGh5c2ljcyBhbmQgc3ByaXRlXG4gICAqL1xuICB1cGRhdGUoZW50aXR5OiBQSVhJLkNvbnRhaW5lciwgZGVsdGFUaW1lPzogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmJvZHkpIHJldHVybjtcblxuICAgIC8vIFN5bmMgYmFzZWQgb24gbW9kZVxuICAgIHN3aXRjaCAodGhpcy5vcHRpb25zLnN5bmNNb2RlKSB7XG4gICAgICBjYXNlICdwaHlzaWNzLWRyaXZlbic6XG4gICAgICAgIHRoaXMuc3luY0Zyb21QaHlzaWNzKGVudGl0eSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc3ByaXRlLWRyaXZlbic6XG4gICAgICAgIHRoaXMuc3luY1RvUGh5c2ljcyhlbnRpdHkpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ21hbnVhbCc6XG4gICAgICAgIC8vIFVzZXIgaGFuZGxlcyBzeW5jIG1hbnVhbGx5XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbiB1cCBwaHlzaWNzIGJvZHlcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuYm9keSkge1xuICAgICAgdGhpcy53b3JsZC5kZXN0cm95Qm9keSh0aGlzLmJvZHkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTeW5jIHNwcml0ZSBmcm9tIHBoeXNpY3MgYm9keVxuICAgKi9cbiAgcHJpdmF0ZSBzeW5jRnJvbVBoeXNpY3MoZW50aXR5OiBQSVhJLkNvbnRhaW5lcik6IHZvaWQge1xuICAgIGlmICghdGhpcy5ib2R5KSByZXR1cm47XG5cbiAgICBjb25zdCBwb3MgPSB0aGlzLmJvZHkuZ2V0UG9zaXRpb24oKTtcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuc3luY1Bvc2l0aW9uKSB7XG4gICAgICBlbnRpdHkueCA9IHRoaXMud29ybGQudG9QaXhlbHMocG9zLngpO1xuICAgICAgZW50aXR5LnkgPSB0aGlzLndvcmxkLnRvUGl4ZWxzKHBvcy55KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnN5bmNSb3RhdGlvbikge1xuICAgICAgZW50aXR5LnJvdGF0aW9uID0gdGhpcy5ib2R5LmdldEFuZ2xlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFN5bmMgcGh5c2ljcyBib2R5IGZyb20gc3ByaXRlXG4gICAqL1xuICBzeW5jVG9QaHlzaWNzKGVudGl0eTogUElYSS5Db250YWluZXIpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYm9keSkgcmV0dXJuO1xuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zeW5jUG9zaXRpb24pIHtcbiAgICAgIGNvbnN0IHggPSB0aGlzLndvcmxkLnRvUGh5c2ljcyhlbnRpdHkueCk7XG4gICAgICBjb25zdCB5ID0gdGhpcy53b3JsZC50b1BoeXNpY3MoZW50aXR5LnkpO1xuICAgICAgdGhpcy5ib2R5LnNldFBvc2l0aW9uKHBsYW5jay5WZWMyKHgsIHkpKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnN5bmNSb3RhdGlvbikge1xuICAgICAgdGhpcy5ib2R5LnNldEFuZ2xlKGVudGl0eS5yb3RhdGlvbik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSB0aGUgUGxhbmNrLmpzIHBoeXNpY3MgYm9keVxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVQaHlzaWNzQm9keShlbnRpdHk6IFBJWEkuQ29udGFpbmVyKTogdm9pZCB7XG4gICAgLy8gRGV0ZXJtaW5lIGJvZHkgdHlwZVxuICAgIGxldCBib2R5VHlwZTogcGxhbmNrLkJvZHlUeXBlO1xuICAgIHN3aXRjaCAodGhpcy5vcHRpb25zLnR5cGUpIHtcbiAgICAgIGNhc2UgJ3N0YXRpYyc6XG4gICAgICAgIGJvZHlUeXBlID0gJ3N0YXRpYyc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAna2luZW1hdGljJzpcbiAgICAgICAgYm9keVR5cGUgPSAna2luZW1hdGljJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdkeW5hbWljJzpcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJvZHlUeXBlID0gJ2R5bmFtaWMnO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYm9keSBkZWZpbml0aW9uXG4gICAgY29uc3QgYm9keURlZjogcGxhbmNrLkJvZHlEZWYgPSB7XG4gICAgICB0eXBlOiBib2R5VHlwZSxcbiAgICAgIHBvc2l0aW9uOiB0aGlzLm9wdGlvbnMucG9zaXRpb25cbiAgICAgICAgPyB0aGlzLndvcmxkLnRvUGh5c2ljc1BvaW50KHRoaXMub3B0aW9ucy5wb3NpdGlvbilcbiAgICAgICAgOiBwbGFuY2suVmVjMih0aGlzLndvcmxkLnRvUGh5c2ljcyhlbnRpdHkueCksIHRoaXMud29ybGQudG9QaHlzaWNzKGVudGl0eS55KSksXG4gICAgICBhbmdsZTogdGhpcy5vcHRpb25zLnJvdGF0aW9uID8/IGVudGl0eS5yb3RhdGlvbixcbiAgICAgIGxpbmVhclZlbG9jaXR5OiB0aGlzLm9wdGlvbnMubGluZWFyVmVsb2NpdHlcbiAgICAgICAgPyB0aGlzLndvcmxkLnRvUGh5c2ljc1BvaW50KHRoaXMub3B0aW9ucy5saW5lYXJWZWxvY2l0eSlcbiAgICAgICAgOiBwbGFuY2suVmVjMigwLCAwKSxcbiAgICAgIGFuZ3VsYXJWZWxvY2l0eTogdGhpcy5vcHRpb25zLmFuZ3VsYXJWZWxvY2l0eSA/PyAwLFxuICAgICAgZml4ZWRSb3RhdGlvbjogdGhpcy5vcHRpb25zLmZpeGVkUm90YXRpb24gPz8gZmFsc2UsXG4gICAgICBidWxsZXQ6IHRoaXMub3B0aW9ucy5idWxsZXQgPz8gZmFsc2VcbiAgICB9O1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBib2R5XG4gICAgdGhpcy5ib2R5ID0gdGhpcy53b3JsZC5jcmVhdGVCb2R5KGJvZHlEZWYpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBzaGFwZSBhbmQgZml4dHVyZVxuICAgIHRoaXMuY3JlYXRlRml4dHVyZShlbnRpdHkpO1xuXG4gICAgLy8gU2V0IGluaXRpYWwgdmVsb2NpdGllcyBpZiBwcm92aWRlZFxuICAgIGlmICh0aGlzLm9wdGlvbnMubGluZWFyVmVsb2NpdHkpIHtcbiAgICAgIHRoaXMuc2V0VmVsb2NpdHkodGhpcy5vcHRpb25zLmxpbmVhclZlbG9jaXR5KTtcbiAgICB9XG4gICAgaWYgKHRoaXMub3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpIHtcbiAgICAgIHRoaXMuc2V0QW5ndWxhclZlbG9jaXR5KHRoaXMub3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgZml4dHVyZSB3aXRoIHNoYXBlXG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZUZpeHR1cmUoZW50aXR5OiBQSVhJLkNvbnRhaW5lcik6IHZvaWQge1xuICAgIGNvbnN0IHNoYXBlID0gdGhpcy5jcmVhdGVTaGFwZShlbnRpdHkpO1xuXG4gICAgLy8gU2V0dXAgY29sbGlzaW9uIGZpbHRlcmluZ1xuICAgIGNvbnN0IGNhdGVnb3J5Qml0cyA9IHRoaXMub3B0aW9ucy5jb2xsaXNpb25UYWdzXG4gICAgICA/IHRoaXMud29ybGQuY29sbGlzaW9uUmVnaXN0cnkudGFnc1RvQml0cyh0aGlzLm9wdGlvbnMuY29sbGlzaW9uVGFncylcbiAgICAgIDogdGhpcy53b3JsZC5jb2xsaXNpb25SZWdpc3RyeS5nZXRCaXQoJ2RlZmF1bHQnKTtcblxuICAgIGNvbnN0IG1hc2tCaXRzID0gdGhpcy5vcHRpb25zLmNvbGxpZGVzV2l0aFxuICAgICAgPyB0aGlzLndvcmxkLmNvbGxpc2lvblJlZ2lzdHJ5LnRhZ3NUb0JpdHModGhpcy5vcHRpb25zLmNvbGxpZGVzV2l0aClcbiAgICAgIDogMHhGRkZGOyAvLyBDb2xsaWRlIHdpdGggZXZlcnl0aGluZyBieSBkZWZhdWx0XG5cbiAgICBjb25zdCBncm91cEluZGV4ID0gdGhpcy5vcHRpb25zLmNvbGxpc2lvbkdyb3VwID8/IDA7XG5cbiAgICAvLyBDcmVhdGUgZml4dHVyZVxuICAgIHRoaXMuYm9keS5jcmVhdGVGaXh0dXJlKHtcbiAgICAgIHNoYXBlOiBzaGFwZSxcbiAgICAgIGRlbnNpdHk6IHRoaXMub3B0aW9ucy5kZW5zaXR5ID8/IDEuMCxcbiAgICAgIGZyaWN0aW9uOiB0aGlzLm9wdGlvbnMuZnJpY3Rpb24gPz8gMC4zLFxuICAgICAgcmVzdGl0dXRpb246IHRoaXMub3B0aW9ucy5yZXN0aXR1dGlvbiA/PyAwLjAsXG4gICAgICBpc1NlbnNvcjogdGhpcy5vcHRpb25zLmlzU2Vuc29yID8/IGZhbHNlLFxuICAgICAgZmlsdGVyQ2F0ZWdvcnlCaXRzOiBjYXRlZ29yeUJpdHMsXG4gICAgICBmaWx0ZXJNYXNrQml0czogbWFza0JpdHMsXG4gICAgICBmaWx0ZXJHcm91cEluZGV4OiBncm91cEluZGV4XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIFBsYW5jayBzaGFwZSBmcm9tIEdyYXBoaWNzIGdlb21ldHJ5IG9yIGxlZ2FjeSBvcHRpb25zXG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZVNoYXBlKGVudGl0eTogUElYSS5Db250YWluZXIpOiBwbGFuY2suU2hhcGUge1xuICAgIC8vIFByaW9yaXR5IDE6IEV4cGxpY2l0IGNvbGxpc2lvbiBzaGFwZSBwcm92aWRlZFxuICAgIGlmICh0aGlzLm9wdGlvbnMuY29sbGlzaW9uU2hhcGUpIHtcbiAgICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlR3JhcGhpY3NTaGFwZSh0aGlzLm9wdGlvbnMuY29sbGlzaW9uU2hhcGUsIHRoaXMud29ybGQpO1xuICAgICAgcmV0dXJuIHBhcnNlZC5zaGFwZTtcbiAgICB9XG5cbiAgICAvLyBQcmlvcml0eSAyOiBFbnRpdHkgaXRzZWxmIGlzIEdyYXBoaWNzIOKGkiBleHRyYWN0IGZyb20gaXRcbiAgICBpZiAoZW50aXR5IGluc3RhbmNlb2YgUElYSS5HcmFwaGljcykge1xuICAgICAgY29uc3QgcGFyc2VkID0gcGFyc2VHcmFwaGljc1NoYXBlKGVudGl0eSwgdGhpcy53b3JsZCk7XG4gICAgICByZXR1cm4gcGFyc2VkLnNoYXBlO1xuICAgIH1cblxuICAgIC8vIFByaW9yaXR5IDM6IExlZ2FjeSBzaGFwZSBwcm9wZXJ0aWVzIChiYWNrd2FyZCBjb21wYXRpYmlsaXR5KVxuICAgIGlmICh0aGlzLm9wdGlvbnMuc2hhcGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVNoYXBlRnJvbVR5cGUodGhpcy5vcHRpb25zLnNoYXBlKTtcbiAgICB9XG5cbiAgICAvLyBObyBjb2xsaXNpb24gc2hhcGUgZGVmaW5lZCAtIGVycm9yIGZvciBub24tR3JhcGhpY3MgZW50aXRpZXNcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnQ29sbGlzaW9uIHNoYXBlIHJlcXVpcmVkIGZvciBub24tR3JhcGhpY3MgZW50aXRpZXMuICcgK1xuICAgICAgJ0VpdGhlciBwcm92aWRlIGEgR3JhcGhpY3MgZW50aXR5LCBvciBzcGVjaWZ5IG9wdGlvbnMuY29sbGlzaW9uU2hhcGUsICcgK1xuICAgICAgJ29yIHVzZSBsZWdhY3kgb3B0aW9ucy5zaGFwZSB3aXRoIGRpbWVuc2lvbnMuJ1xuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIHNoYXBlIGZyb20gZXhwbGljaXQgdHlwZVxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVTaGFwZUZyb21UeXBlKHNoYXBlVHlwZTogU2hhcGVUeXBlKTogcGxhbmNrLlNoYXBlIHtcbiAgICBzd2l0Y2ggKHNoYXBlVHlwZSkge1xuICAgICAgY2FzZSAnY2lyY2xlJzpcbiAgICAgICAgY29uc3QgcmFkaXVzID0gdGhpcy5vcHRpb25zLnJhZGl1cyA/PyAyNTtcbiAgICAgICAgcmV0dXJuIHBsYW5jay5DaXJjbGUodGhpcy53b3JsZC50b1BoeXNpY3MocmFkaXVzKSk7XG5cbiAgICAgIGNhc2UgJ3JlY3RhbmdsZSc6XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5vcHRpb25zLndpZHRoID8/IDUwO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSB0aGlzLm9wdGlvbnMuaGVpZ2h0ID8/IDUwO1xuICAgICAgICByZXR1cm4gcGxhbmNrLkJveChcbiAgICAgICAgICB0aGlzLndvcmxkLnRvUGh5c2ljcyh3aWR0aCAvIDIpLFxuICAgICAgICAgIHRoaXMud29ybGQudG9QaHlzaWNzKGhlaWdodCAvIDIpXG4gICAgICAgICk7XG5cbiAgICAgIGNhc2UgJ3BvbHlnb24nOlxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy52ZXJ0aWNlcyB8fCB0aGlzLm9wdGlvbnMudmVydGljZXMubGVuZ3RoIDwgMykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUG9seWdvbiBzaGFwZSByZXF1aXJlcyBhdCBsZWFzdCAzIHZlcnRpY2VzJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLm9wdGlvbnMudmVydGljZXMubWFwKHYgPT5cbiAgICAgICAgICBwbGFuY2suVmVjMih0aGlzLndvcmxkLnRvUGh5c2ljcyh2LngpLCB0aGlzLndvcmxkLnRvUGh5c2ljcyh2LnkpKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gcGxhbmNrLlBvbHlnb24odmVydGljZXMpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gc2hhcGUgdHlwZTogJHtzaGFwZVR5cGV9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEF1dG8tZGV0ZWN0IHNoYXBlIGZyb20gc3ByaXRlIGJvdW5kc1xuICAgKi9cbiAgcHJpdmF0ZSBhdXRvRGV0ZWN0U2hhcGUoZW50aXR5OiBQSVhJLkNvbnRhaW5lcik6IHBsYW5jay5TaGFwZSB7XG4gICAgLy8gRm9yIHNwcml0ZXMsIHVzZSB0ZXh0dXJlIGJvdW5kc1xuICAgIGNvbnN0IGJvdW5kcyA9IGVudGl0eS5nZXRMb2NhbEJvdW5kcygpO1xuXG4gICAgLy8gRGVmYXVsdCB0byByZWN0YW5nbGVcbiAgICByZXR1cm4gcGxhbmNrLkJveChcbiAgICAgIHRoaXMud29ybGQudG9QaHlzaWNzKGJvdW5kcy53aWR0aCAvIDIpLFxuICAgICAgdGhpcy53b3JsZC50b1BoeXNpY3MoYm91bmRzLmhlaWdodCAvIDIpXG4gICAgKTtcbiAgfVxuXG4gIC8vIFBoeXNpY3MgYm9keSBtYW5pcHVsYXRpb24gbWV0aG9kc1xuXG4gIC8qKlxuICAgKiBBcHBseSBmb3JjZSBhdCBhIHBvaW50XG4gICAqL1xuICBhcHBseUZvcmNlKGZvcmNlOiBQSVhJLlBvaW50LCBwb2ludD86IFBJWEkuUG9pbnQpOiB2b2lkIHtcbiAgICBjb25zdCBmb3JjZVZlYyA9IHRoaXMud29ybGQudG9QaHlzaWNzUG9pbnQoZm9yY2UpO1xuICAgIGNvbnN0IHBvaW50VmVjID0gcG9pbnRcbiAgICAgID8gdGhpcy53b3JsZC50b1BoeXNpY3NQb2ludChwb2ludClcbiAgICAgIDogdGhpcy5ib2R5LmdldFdvcmxkQ2VudGVyKCk7XG4gICAgdGhpcy5ib2R5LmFwcGx5Rm9yY2UoZm9yY2VWZWMsIHBvaW50VmVjKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcHBseSBpbXB1bHNlIGF0IGEgcG9pbnRcbiAgICovXG4gIGFwcGx5SW1wdWxzZShpbXB1bHNlOiBQSVhJLlBvaW50LCBwb2ludD86IFBJWEkuUG9pbnQpOiB2b2lkIHtcbiAgICBjb25zdCBpbXB1bHNlVmVjID0gdGhpcy53b3JsZC50b1BoeXNpY3NQb2ludChpbXB1bHNlKTtcbiAgICBjb25zdCBwb2ludFZlYyA9IHBvaW50XG4gICAgICA/IHRoaXMud29ybGQudG9QaHlzaWNzUG9pbnQocG9pbnQpXG4gICAgICA6IHRoaXMuYm9keS5nZXRXb3JsZENlbnRlcigpO1xuICAgIHRoaXMuYm9keS5hcHBseUxpbmVhckltcHVsc2UoaW1wdWxzZVZlYywgcG9pbnRWZWMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5IHRvcnF1ZVxuICAgKi9cbiAgYXBwbHlUb3JxdWUodG9ycXVlOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLmJvZHkuYXBwbHlUb3JxdWUodG9ycXVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgbGluZWFyIHZlbG9jaXR5XG4gICAqL1xuICBzZXRWZWxvY2l0eSh2ZWxvY2l0eTogUElYSS5Qb2ludCk6IHZvaWQge1xuICAgIGNvbnN0IHZlbG9jaXR5VmVjID0gdGhpcy53b3JsZC50b1BoeXNpY3NQb2ludCh2ZWxvY2l0eSk7XG4gICAgdGhpcy5ib2R5LnNldExpbmVhclZlbG9jaXR5KHZlbG9jaXR5VmVjKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgYW5ndWxhciB2ZWxvY2l0eVxuICAgKi9cbiAgc2V0QW5ndWxhclZlbG9jaXR5KG9tZWdhOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLmJvZHkuc2V0QW5ndWxhclZlbG9jaXR5KG9tZWdhKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgbGluZWFyIHZlbG9jaXR5XG4gICAqL1xuICBnZXRWZWxvY2l0eSgpOiBQSVhJLlBvaW50IHtcbiAgICBjb25zdCB2ZWwgPSB0aGlzLmJvZHkuZ2V0TGluZWFyVmVsb2NpdHkoKTtcbiAgICByZXR1cm4gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHZlbCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFuZ3VsYXIgdmVsb2NpdHlcbiAgICovXG4gIGdldEFuZ3VsYXJWZWxvY2l0eSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmJvZHkuZ2V0QW5ndWxhclZlbG9jaXR5KCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IG1hc3NcbiAgICovXG4gIGdldE1hc3MoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5ib2R5LmdldE1hc3MoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBib2R5IGlzIGF3YWtlXG4gICAqL1xuICBpc0F3YWtlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmJvZHkuaXNBd2FrZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGJvZHkgaXMgc2xlZXBpbmdcbiAgICovXG4gIGlzU2xlZXBpbmcoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICF0aGlzLmJvZHkuaXNBd2FrZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBhd2FrZSBzdGF0ZVxuICAgKi9cbiAgc2V0QXdha2UoYXdha2U6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0aGlzLmJvZHkuc2V0QXdha2UoYXdha2UpO1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0ICogYXMgcGxhbmNrIGZyb20gJ3BsYW5jayc7XG5pbXBvcnQgdHlwZSB7IENvbGxpc2lvblRhZywgQ29sbGlzaW9uRXZlbnQgfSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzV29ybGQgfSBmcm9tICcuL3BoeXNpY3Mtd29ybGQnO1xuXG4vKipcbiAqIENvbGxpc2lvbiBjYXRlZ29yeSByZWdpc3RyeSAtIGNvbnZlcnRzIHRhZ3MgdG8gYml0IG1hc2tzXG4gKiBBdXRvLXJlZ2lzdGVycyB0YWdzIGFzIHRoZXkncmUgdXNlZCAobm8gY29uZmlndXJhdGlvbiBuZWVkZWQpXG4gKlxuICogTW9kZXJuIHRhZy1iYXNlZCBjb2xsaXNpb24gc3lzdGVtIChjb252ZXJ0ZWQgdG8gYml0IG1hc2tzIGludGVybmFsbHkgZm9yIFBsYW5jay5qcylcbiAqXG4gKiBJbnN0ZWFkIG9mIG9sZC1zY2hvb2wgYml0IG1hc2tzLCB3ZSB1c2Ugc3RyaW5ncyBmb3IgYmV0dGVyIERYOlxuICogLSBjb2xsaXNpb25UYWdzOiBbJ3BsYXllciddIGluc3RlYWQgb2YgYml0bWFzayAweDAwMDJcbiAqIC0gY29sbGlkZXNXaXRoOiBbJ3RlcnJhaW4nLCAnZW5lbXknXSBpbnN0ZWFkIG9mIG1hc2sgb3BlcmF0aW9uc1xuICpcbiAqIFRoaXMgaXMgY29udmVydGVkIHRvIGJpdCBtYXNrcyB1bmRlciB0aGUgaG9vZCBmb3IgUGxhbmNrLmpzIGVmZmljaWVuY3kuXG4gKi9cbmV4cG9ydCBjbGFzcyBDb2xsaXNpb25SZWdpc3RyeSB7XG4gIHByaXZhdGUgdGFnVG9CaXQ6IE1hcDxDb2xsaXNpb25UYWcsIG51bWJlcj4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgYml0VG9UYWc6IE1hcDxudW1iZXIsIENvbGxpc2lvblRhZz4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgbmV4dEJpdDogbnVtYmVyID0gMTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyBQcmUtcmVnaXN0ZXIgJ2RlZmF1bHQnIHRhZ1xuICAgIHRoaXMucmVnaXN0ZXIoJ2RlZmF1bHQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBhIGNvbGxpc2lvbiB0YWcgKGNhbGxlZCBhdXRvbWF0aWNhbGx5IHdoZW4gbmVlZGVkKVxuICAgKi9cbiAgcmVnaXN0ZXIodGFnOiBDb2xsaXNpb25UYWcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50YWdUb0JpdC5oYXModGFnKSkgcmV0dXJuO1xuXG4gICAgaWYgKHRoaXMubmV4dEJpdCA+IDB4ODAwMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNYXhpbXVtIGNvbGxpc2lvbiB0YWdzIHJlYWNoZWQgKDE2IHRhZ3MpJyk7XG4gICAgfVxuXG4gICAgdGhpcy50YWdUb0JpdC5zZXQodGFnLCB0aGlzLm5leHRCaXQpO1xuICAgIHRoaXMuYml0VG9UYWcuc2V0KHRoaXMubmV4dEJpdCwgdGFnKTtcbiAgICB0aGlzLm5leHRCaXQgPDw9IDE7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGJpdCB2YWx1ZSBmb3IgYSB0YWcgKGF1dG8tcmVnaXN0ZXJzIGlmIG5ldylcbiAgICovXG4gIGdldEJpdCh0YWc6IENvbGxpc2lvblRhZyk6IG51bWJlciB7XG4gICAgaWYgKCF0aGlzLnRhZ1RvQml0Lmhhcyh0YWcpKSB7XG4gICAgICB0aGlzLnJlZ2lzdGVyKHRhZyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnRhZ1RvQml0LmdldCh0YWcpITtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGFnIGZyb20gYml0IHZhbHVlXG4gICAqL1xuICBnZXRUYWcoYml0OiBudW1iZXIpOiBDb2xsaXNpb25UYWcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmJpdFRvVGFnLmdldChiaXQpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgYXJyYXkgb2YgdGFncyB0byBiaXQgbWFza1xuICAgKi9cbiAgdGFnc1RvQml0cyh0YWdzOiBDb2xsaXNpb25UYWdbXSk6IG51bWJlciB7XG4gICAgaWYgKCF0YWdzIHx8IHRhZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRCaXQoJ2RlZmF1bHQnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRhZ3MucmVkdWNlKChiaXRzLCB0YWcpID0+IGJpdHMgfCB0aGlzLmdldEJpdCh0YWcpLCAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IGJpdCBtYXNrIHRvIGFycmF5IG9mIHRhZ3NcbiAgICovXG4gIGJpdHNUb1RhZ3MoYml0czogbnVtYmVyKTogQ29sbGlzaW9uVGFnW10ge1xuICAgIGNvbnN0IHRhZ3M6IENvbGxpc2lvblRhZ1tdID0gW107XG4gICAgZm9yIChjb25zdCBbYml0LCB0YWddIG9mIHRoaXMuYml0VG9UYWcpIHtcbiAgICAgIGlmIChiaXRzICYgYml0KSB7XG4gICAgICAgIHRhZ3MucHVzaCh0YWcpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFncztcbiAgfVxufVxuXG4vKipcbiAqIENvbGxpc2lvbiBtYW5hZ2VyIC0gaGFuZGxlcyBjYWxsYmFja3NcbiAqL1xuZXhwb3J0IGNsYXNzIENvbGxpc2lvbk1hbmFnZXIge1xuICBwcml2YXRlIHdvcmxkOiBQaHlzaWNzV29ybGQ7XG4gIHByaXZhdGUgcmVnaXN0cnk6IENvbGxpc2lvblJlZ2lzdHJ5O1xuICBwcml2YXRlIGNhbGxiYWNrczogTWFwPHN0cmluZywgU2V0PChldmVudDogQ29sbGlzaW9uRXZlbnQpID0+IHZvaWQ+PiA9IG5ldyBNYXAoKTtcblxuICBjb25zdHJ1Y3Rvcih3b3JsZDogUGh5c2ljc1dvcmxkLCByZWdpc3RyeTogQ29sbGlzaW9uUmVnaXN0cnkpIHtcbiAgICB0aGlzLndvcmxkID0gd29ybGQ7XG4gICAgdGhpcy5yZWdpc3RyeSA9IHJlZ2lzdHJ5O1xuICAgIHRoaXMuc2V0dXBMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0dXBMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgdGhpcy53b3JsZC53b3JsZC5vbignYmVnaW4tY29udGFjdCcsIChjb250YWN0OiBwbGFuY2suQ29udGFjdCkgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVCZWdpbkNvbnRhY3QoY29udGFjdCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLndvcmxkLndvcmxkLm9uKCdlbmQtY29udGFjdCcsIChjb250YWN0OiBwbGFuY2suQ29udGFjdCkgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVFbmRDb250YWN0KGNvbnRhY3QpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGNvbGxpc2lvbiBjYWxsYmFjayBiZXR3ZWVuIHR3byB0YWcgY2F0ZWdvcmllc1xuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBjb2xsaXNpb25NYW5hZ2VyLm9uQ29sbGlzaW9uKCdwbGF5ZXInLCAnZW5lbXknLCAoZXZlbnQpID0+IHtcbiAgICogICBjb25zb2xlLmxvZygnUGxheWVyIGhpdCBlbmVteSEnKTtcbiAgICogfSk7XG4gICAqL1xuICBvbkNvbGxpc2lvbihcbiAgICB0YWdBOiBDb2xsaXNpb25UYWcsXG4gICAgdGFnQjogQ29sbGlzaW9uVGFnLFxuICAgIGNhbGxiYWNrOiAoZXZlbnQ6IENvbGxpc2lvbkV2ZW50KSA9PiB2b2lkXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGtleSA9IHRoaXMubWFrZUtleSh0YWdBLCB0YWdCKTtcbiAgICBpZiAoIXRoaXMuY2FsbGJhY2tzLmhhcyhrZXkpKSB7XG4gICAgICB0aGlzLmNhbGxiYWNrcy5zZXQoa2V5LCBuZXcgU2V0KCkpO1xuICAgIH1cbiAgICB0aGlzLmNhbGxiYWNrcy5nZXQoa2V5KSEuYWRkKGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgY29sbGlzaW9uIGNhbGxiYWNrXG4gICAqL1xuICBvZmZDb2xsaXNpb24oXG4gICAgdGFnQTogQ29sbGlzaW9uVGFnLFxuICAgIHRhZ0I6IENvbGxpc2lvblRhZyxcbiAgICBjYWxsYmFjazogKGV2ZW50OiBDb2xsaXNpb25FdmVudCkgPT4gdm9pZFxuICApOiB2b2lkIHtcbiAgICBjb25zdCBrZXkgPSB0aGlzLm1ha2VLZXkodGFnQSwgdGFnQik7XG4gICAgdGhpcy5jYWxsYmFja3MuZ2V0KGtleSk/LmRlbGV0ZShjYWxsYmFjayk7XG4gIH1cblxuICBwcml2YXRlIG1ha2VLZXkodGFnQTogQ29sbGlzaW9uVGFnLCB0YWdCOiBDb2xsaXNpb25UYWcpOiBzdHJpbmcge1xuICAgIC8vIFNvcnQgdGFncyB0byBlbnN1cmUgY29uc2lzdGVudCBrZXkgcmVnYXJkbGVzcyBvZiBvcmRlclxuICAgIHJldHVybiB0YWdBIDwgdGFnQiA/IGAke3RhZ0F9OiR7dGFnQn1gIDogYCR7dGFnQn06JHt0YWdBfWA7XG4gIH1cblxuICAvLyBUcmlnZ2VyIGNhbGxiYWNrc1xuICBwcml2YXRlIGhhbmRsZUJlZ2luQ29udGFjdChjb250YWN0OiBwbGFuY2suQ29udGFjdCk6IHZvaWQge1xuICAgIGNvbnN0IGJvZHlBID0gY29udGFjdC5nZXRGaXh0dXJlQSgpLmdldEJvZHkoKS5nZXRVc2VyRGF0YSgpIGFzIGFueTtcbiAgICBjb25zdCBib2R5QiA9IGNvbnRhY3QuZ2V0Rml4dHVyZUIoKS5nZXRCb2R5KCkuZ2V0VXNlckRhdGEoKSBhcyBhbnk7XG5cbiAgICBpZiAoIWJvZHlBIHx8ICFib2R5QikgcmV0dXJuO1xuXG4gICAgLy8gQ2FsbCBlbnRpdHktbGV2ZWwgY2FsbGJhY2tzXG4gICAgYm9keUEub25Db2xsaXNpb25CZWdpbj8uKGJvZHlCLCBjb250YWN0KTtcbiAgICBib2R5Qi5vbkNvbGxpc2lvbkJlZ2luPy4oYm9keUEsIGNvbnRhY3QpO1xuXG4gICAgLy8gQ2FsbCBnbG9iYWwgdGFnLWJhc2VkIGNhbGxiYWNrc1xuICAgIHRoaXMudHJpZ2dlclRhZ0NhbGxiYWNrcyhib2R5QSwgYm9keUIsIGNvbnRhY3QpO1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVFbmRDb250YWN0KGNvbnRhY3Q6IHBsYW5jay5Db250YWN0KTogdm9pZCB7XG4gICAgY29uc3QgYm9keUEgPSBjb250YWN0LmdldEZpeHR1cmVBKCkuZ2V0Qm9keSgpLmdldFVzZXJEYXRhKCkgYXMgYW55O1xuICAgIGNvbnN0IGJvZHlCID0gY29udGFjdC5nZXRGaXh0dXJlQigpLmdldEJvZHkoKS5nZXRVc2VyRGF0YSgpIGFzIGFueTtcblxuICAgIGlmICghYm9keUEgfHwgIWJvZHlCKSByZXR1cm47XG5cbiAgICBib2R5QS5vbkNvbGxpc2lvbkVuZD8uKGJvZHlCLCBjb250YWN0KTtcbiAgICBib2R5Qi5vbkNvbGxpc2lvbkVuZD8uKGJvZHlBLCBjb250YWN0KTtcbiAgfVxuXG4gIHByaXZhdGUgdHJpZ2dlclRhZ0NhbGxiYWNrcyhcbiAgICBib2R5QTogYW55LFxuICAgIGJvZHlCOiBhbnksXG4gICAgY29udGFjdDogcGxhbmNrLkNvbnRhY3RcbiAgKTogdm9pZCB7XG4gICAgLy8gR2V0IHRhZ3MgZnJvbSBib3RoIGJvZGllc1xuICAgIGNvbnN0IHRhZ3NBID0gYm9keUEub3B0aW9ucy5jb2xsaXNpb25UYWdzIHx8IFtdO1xuICAgIGNvbnN0IHRhZ3NCID0gYm9keUIub3B0aW9ucy5jb2xsaXNpb25UYWdzIHx8IFtdO1xuXG4gICAgLy8gQ2hlY2sgYWxsIHRhZyBjb21iaW5hdGlvbnNcbiAgICBmb3IgKGNvbnN0IHRhZ0Egb2YgdGFnc0EpIHtcbiAgICAgIGZvciAoY29uc3QgdGFnQiBvZiB0YWdzQikge1xuICAgICAgICBjb25zdCBrZXkgPSB0aGlzLm1ha2VLZXkodGFnQSwgdGFnQik7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9IHRoaXMuY2FsbGJhY2tzLmdldChrZXkpO1xuXG4gICAgICAgIGlmIChjYWxsYmFja3MpIHtcbiAgICAgICAgICBjb25zdCBldmVudDogQ29sbGlzaW9uRXZlbnQgPSB7XG4gICAgICAgICAgICBib2R5QSxcbiAgICAgICAgICAgIGJvZHlCLFxuICAgICAgICAgICAgY29udGFjdCxcbiAgICAgICAgICAgIG5vcm1hbDogbmV3IFBJWEkuUG9pbnQoMCwgMCksIC8vIFRPRE86IEV4dHJhY3QgZnJvbSBjb250YWN0XG4gICAgICAgICAgICBpbXB1bHNlOiAwIC8vIFRPRE86IEV4dHJhY3QgZnJvbSBjb250YWN0XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGNhbGxiYWNrcy5mb3JFYWNoKGNiID0+IGNiKGV2ZW50KSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgKiBhcyBwbGFuY2sgZnJvbSAncGxhbmNrJztcbmltcG9ydCB7IExvZ2ljIH0gZnJvbSAnLi4vLi4vY29yZS9sb2dpYyc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NXb3JsZCB9IGZyb20gJy4vcGh5c2ljcy13b3JsZCc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NEZWJ1Z09wdGlvbnMgfSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuXG4vKipcbiAqIFBoeXNpY3NEZWJ1Z1JlbmRlcmVyIC0gVmlzdWFsaXplcyBjb2xsaXNpb24gc2hhcGVzLCB2ZWxvY2l0eSB2ZWN0b3JzLCBhbmQgcGh5c2ljcyBzdGF0ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBkZWJ1Z1JlbmRlcmVyID0gcGh5c2ljc1dvcmxkLmVuYWJsZURlYnVnUmVuZGVyZXIoc2NlbmUpO1xuICpcbiAqIC8vIFRvZ2dsZSB3aXRoIGtleWJvYXJkXG4gKiBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcbiAqICAgaWYgKGUua2V5ID09PSAncCcpIGRlYnVnUmVuZGVyZXIudG9nZ2xlKCk7XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgUGh5c2ljc0RlYnVnUmVuZGVyZXIgZXh0ZW5kcyBMb2dpYzxQSVhJLkdyYXBoaWNzPiB7XG4gIG5hbWUgPSAnUGh5c2ljc0RlYnVnUmVuZGVyZXInO1xuXG4gIHByaXZhdGUgd29ybGQ6IFBoeXNpY3NXb3JsZDtcbiAgcHJpdmF0ZSBncmFwaGljcyE6IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgb3B0aW9uczogUmVxdWlyZWQ8UGh5c2ljc0RlYnVnT3B0aW9ucz47XG4gIHByaXZhdGUgaXNWaXNpYmxlOiBib29sZWFuID0gdHJ1ZTtcblxuICBjb25zdHJ1Y3Rvcih3b3JsZDogUGh5c2ljc1dvcmxkLCBvcHRpb25zOiBQaHlzaWNzRGVidWdPcHRpb25zID0ge30pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMud29ybGQgPSB3b3JsZDtcbiAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICBzaG93U2hhcGVzOiBvcHRpb25zLnNob3dTaGFwZXMgPz8gdHJ1ZSxcbiAgICAgIHNob3dWZWxvY2l0aWVzOiBvcHRpb25zLnNob3dWZWxvY2l0aWVzID8/IGZhbHNlLFxuICAgICAgc2hvd0FBQkJzOiBvcHRpb25zLnNob3dBQUJCcyA/PyBmYWxzZSxcbiAgICAgIHNob3dDZW50ZXJPZk1hc3M6IG9wdGlvbnMuc2hvd0NlbnRlck9mTWFzcyA/PyBmYWxzZSxcbiAgICAgIHNob3dDb250YWN0UG9pbnRzOiBvcHRpb25zLnNob3dDb250YWN0UG9pbnRzID8/IGZhbHNlLFxuICAgICAgc2hvd0pvaW50czogb3B0aW9ucy5zaG93Sm9pbnRzID8/IGZhbHNlLFxuICAgICAgY29sb3JTdGF0aWM6IG9wdGlvbnMuY29sb3JTdGF0aWMgPz8gMHgwMEZGMDAsXG4gICAgICBjb2xvckR5bmFtaWM6IG9wdGlvbnMuY29sb3JEeW5hbWljID8/IDB4RkYwMDAwLFxuICAgICAgY29sb3JLaW5lbWF0aWM6IG9wdGlvbnMuY29sb3JLaW5lbWF0aWMgPz8gMHgwMDAwRkYsXG4gICAgICBjb2xvclNsZWVwaW5nOiBvcHRpb25zLmNvbG9yU2xlZXBpbmcgPz8gMHhBQUFBQUEsXG4gICAgICBjb2xvclNlbnNvcjogb3B0aW9ucy5jb2xvclNlbnNvciA/PyAweEZGRkYwMCxcbiAgICAgIGFscGhhOiBvcHRpb25zLmFscGhhID8/IDAuNSxcbiAgICAgIGxpbmVXaWR0aDogb3B0aW9ucy5saW5lV2lkdGggPz8gMlxuICAgIH07XG4gIH1cblxuICBpbml0KGVudGl0eTogUElYSS5HcmFwaGljcywgcmVuZGVyZXI/OiBQSVhJLlJlbmRlcmVyKTogdm9pZCB7XG4gICAgdGhpcy5ncmFwaGljcyA9IGVudGl0eTtcbiAgfVxuXG4gIHVwZGF0ZShlbnRpdHk6IFBJWEkuR3JhcGhpY3MsIGRlbHRhVGltZT86IG51bWJlcik6IHZvaWQge1xuICAgIGlmICghdGhpcy5pc1Zpc2libGUpIHtcbiAgICAgIHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmdyYXBoaWNzLmNsZWFyKCk7XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnNob3dTaGFwZXMpIHtcbiAgICAgIC8vIEl0ZXJhdGUgYWxsIGJvZGllcyBpbiBwaHlzaWNzIHdvcmxkXG4gICAgICBmb3IgKGxldCBib2R5ID0gdGhpcy53b3JsZC53b3JsZC5nZXRCb2R5TGlzdCgpOyBib2R5OyBib2R5ID0gYm9keS5nZXROZXh0KCkpIHtcbiAgICAgICAgdGhpcy5kcmF3Qm9keShib2R5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnNob3dDb250YWN0UG9pbnRzKSB7XG4gICAgICB0aGlzLmRyYXdDb250YWN0cygpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZHJhd0JvZHkoYm9keTogcGxhbmNrLkJvZHkpOiB2b2lkIHtcbiAgICBjb25zdCB0cmFuc2Zvcm0gPSBib2R5LmdldFRyYW5zZm9ybSgpO1xuXG4gICAgLy8gRGV0ZXJtaW5lIGNvbG9yIGJhc2VkIG9uIGJvZHkgdHlwZSBhbmQgc3RhdGVcbiAgICBsZXQgY29sb3I6IG51bWJlcjtcblxuICAgIGlmICghYm9keS5pc0F3YWtlKCkgJiYgYm9keS5pc0R5bmFtaWMoKSkge1xuICAgICAgY29sb3IgPSB0aGlzLm9wdGlvbnMuY29sb3JTbGVlcGluZztcbiAgICB9IGVsc2UgaWYgKGJvZHkuaXNTdGF0aWMoKSkge1xuICAgICAgY29sb3IgPSB0aGlzLm9wdGlvbnMuY29sb3JTdGF0aWM7XG4gICAgfSBlbHNlIGlmIChib2R5LmlzS2luZW1hdGljKCkpIHtcbiAgICAgIGNvbG9yID0gdGhpcy5vcHRpb25zLmNvbG9yS2luZW1hdGljO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb2xvciA9IHRoaXMub3B0aW9ucy5jb2xvckR5bmFtaWM7XG4gICAgfVxuXG4gICAgLy8gRHJhdyBlYWNoIGZpeHR1cmVcbiAgICBmb3IgKGxldCBmaXh0dXJlID0gYm9keS5nZXRGaXh0dXJlTGlzdCgpOyBmaXh0dXJlOyBmaXh0dXJlID0gZml4dHVyZS5nZXROZXh0KCkpIHtcbiAgICAgIGNvbnN0IHNoYXBlID0gZml4dHVyZS5nZXRTaGFwZSgpO1xuXG4gICAgICAvLyBVc2UgeWVsbG93IHNlbWktdHJhbnNwYXJlbnQgZm9yIHNlbnNvcnNcbiAgICAgIGNvbnN0IGZpeHR1cmVDb2xvciA9IGZpeHR1cmUuaXNTZW5zb3IoKSA/IHRoaXMub3B0aW9ucy5jb2xvclNlbnNvciA6IGNvbG9yO1xuICAgICAgY29uc3QgYWxwaGEgPSBmaXh0dXJlLmlzU2Vuc29yKCkgPyB0aGlzLm9wdGlvbnMuYWxwaGEgKiAwLjUgOiB0aGlzLm9wdGlvbnMuYWxwaGE7XG5cbiAgICAgIHRoaXMuZHJhd1NoYXBlKHNoYXBlLCB0cmFuc2Zvcm0sIGZpeHR1cmVDb2xvciwgYWxwaGEpO1xuICAgIH1cblxuICAgIC8vIERyYXcgdmVsb2NpdHkgdmVjdG9yIGlmIGVuYWJsZWRcbiAgICBpZiAodGhpcy5vcHRpb25zLnNob3dWZWxvY2l0aWVzICYmIGJvZHkuaXNEeW5hbWljKCkpIHtcbiAgICAgIHRoaXMuZHJhd1ZlbG9jaXR5KGJvZHkpO1xuICAgIH1cblxuICAgIC8vIERyYXcgQUFCQiBpZiBlbmFibGVkXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zaG93QUFCQnMpIHtcbiAgICAgIHRoaXMuZHJhd0FBQkIoYm9keSk7XG4gICAgfVxuXG4gICAgLy8gRHJhdyBjZW50ZXIgb2YgbWFzcyBpZiBlbmFibGVkXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zaG93Q2VudGVyT2ZNYXNzKSB7XG4gICAgICB0aGlzLmRyYXdDZW50ZXJPZk1hc3MoYm9keSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBkcmF3U2hhcGUoc2hhcGU6IHBsYW5jay5TaGFwZSwgdHJhbnNmb3JtOiBwbGFuY2suVHJhbnNmb3JtLCBjb2xvcjogbnVtYmVyLCBhbHBoYTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5ncmFwaGljcy5zdHJva2Uoe1xuICAgICAgd2lkdGg6IHRoaXMub3B0aW9ucy5saW5lV2lkdGgsXG4gICAgICBjb2xvcjogY29sb3IsXG4gICAgICBhbHBoYTogYWxwaGFcbiAgICB9KTtcblxuICAgIGNvbnN0IHNoYXBlVHlwZSA9IHNoYXBlLmdldFR5cGUoKTtcblxuICAgIGlmIChzaGFwZVR5cGUgPT09ICdjaXJjbGUnKSB7XG4gICAgICBjb25zdCBjaXJjbGUgPSBzaGFwZSBhcyBwbGFuY2suQ2lyY2xlU2hhcGU7XG4gICAgICBjb25zdCBjZW50ZXIgPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgY2lyY2xlLmdldENlbnRlcigpKSk7XG4gICAgICBjb25zdCByYWRpdXMgPSBjaXJjbGUuZ2V0UmFkaXVzKCk7XG5cbiAgICAgIGNvbnN0IHBpeGVsQ2VudGVyID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KGNlbnRlcik7XG4gICAgICBjb25zdCBwaXhlbFJhZGl1cyA9IHRoaXMud29ybGQudG9QaXhlbHMocmFkaXVzKTtcblxuICAgICAgdGhpcy5ncmFwaGljcy5jaXJjbGUocGl4ZWxDZW50ZXIueCwgcGl4ZWxDZW50ZXIueSwgcGl4ZWxSYWRpdXMpO1xuICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcblxuICAgICAgLy8gRHJhdyByYWRpdXMgbGluZSB0byBzaG93IHJvdGF0aW9uXG4gICAgICBjb25zdCBhbmdsZSA9IHRyYW5zZm9ybS5xLmdldEFuZ2xlKCk7XG4gICAgICBjb25zdCBlbmRYID0gcGl4ZWxDZW50ZXIueCArIE1hdGguY29zKGFuZ2xlKSAqIHBpeGVsUmFkaXVzO1xuICAgICAgY29uc3QgZW5kWSA9IHBpeGVsQ2VudGVyLnkgKyBNYXRoLnNpbihhbmdsZSkgKiBwaXhlbFJhZGl1cztcbiAgICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsQ2VudGVyLngsIHBpeGVsQ2VudGVyLnkpO1xuICAgICAgdGhpcy5ncmFwaGljcy5saW5lVG8oZW5kWCwgZW5kWSk7XG4gICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xuICAgIH0gZWxzZSBpZiAoc2hhcGVUeXBlID09PSAncG9seWdvbicpIHtcbiAgICAgIGNvbnN0IHBvbHkgPSBzaGFwZSBhcyBwbGFuY2suUG9seWdvblNoYXBlO1xuICAgICAgY29uc3QgdmVydGljZXMgPSBwb2x5Lm1fdmVydGljZXM7XG5cbiAgICAgIGlmICh2ZXJ0aWNlcyAmJiB2ZXJ0aWNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIFRyYW5zZm9ybSBmaXJzdCB2ZXJ0ZXhcbiAgICAgICAgY29uc3QgZmlyc3RWZXJ0ZXggPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgdmVydGljZXNbMF0pKTtcbiAgICAgICAgY29uc3QgcGl4ZWxGaXJzdCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChmaXJzdFZlcnRleCk7XG5cbiAgICAgICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxGaXJzdC54LCBwaXhlbEZpcnN0LnkpO1xuXG4gICAgICAgIC8vIFRyYW5zZm9ybSBhbmQgZHJhdyByZW1haW5pbmcgdmVydGljZXNcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB2ZXJ0aWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IHZlcnRleCA9IHBsYW5jay5WZWMyLmFkZCh0cmFuc2Zvcm0ucCwgcGxhbmNrLlJvdC5tdWxWZWMyKHRyYW5zZm9ybS5xLCB2ZXJ0aWNlc1tpXSkpO1xuICAgICAgICAgIGNvbnN0IHBpeGVsVmVydGV4ID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHZlcnRleCk7XG4gICAgICAgICAgdGhpcy5ncmFwaGljcy5saW5lVG8ocGl4ZWxWZXJ0ZXgueCwgcGl4ZWxWZXJ0ZXgueSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDbG9zZSB0aGUgcG9seWdvblxuICAgICAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhwaXhlbEZpcnN0LngsIHBpeGVsRmlyc3QueSk7XG4gICAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzaGFwZVR5cGUgPT09ICdlZGdlJykge1xuICAgICAgY29uc3QgZWRnZSA9IHNoYXBlIGFzIHBsYW5jay5FZGdlU2hhcGU7XG4gICAgICBjb25zdCB2MSA9IHBsYW5jay5WZWMyLmFkZCh0cmFuc2Zvcm0ucCwgcGxhbmNrLlJvdC5tdWxWZWMyKHRyYW5zZm9ybS5xLCBlZGdlLm1fdmVydGV4MSkpO1xuICAgICAgY29uc3QgdjIgPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgZWRnZS5tX3ZlcnRleDIpKTtcblxuICAgICAgY29uc3QgcDEgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQodjEpO1xuICAgICAgY29uc3QgcDIgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQodjIpO1xuXG4gICAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwMS54LCBwMS55KTtcbiAgICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKHAyLngsIHAyLnkpO1xuICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcbiAgICB9IGVsc2UgaWYgKHNoYXBlVHlwZSA9PT0gJ2NoYWluJykge1xuICAgICAgY29uc3QgY2hhaW4gPSBzaGFwZSBhcyBwbGFuY2suQ2hhaW5TaGFwZTtcbiAgICAgIGNvbnN0IHZlcnRpY2VzID0gY2hhaW4ubV92ZXJ0aWNlcztcblxuICAgICAgaWYgKHZlcnRpY2VzICYmIHZlcnRpY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgZmlyc3RWZXJ0ZXggPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgdmVydGljZXNbMF0pKTtcbiAgICAgICAgY29uc3QgcGl4ZWxGaXJzdCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChmaXJzdFZlcnRleCk7XG4gICAgICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsRmlyc3QueCwgcGl4ZWxGaXJzdC55KTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgdmVydGV4ID0gcGxhbmNrLlZlYzIuYWRkKHRyYW5zZm9ybS5wLCBwbGFuY2suUm90Lm11bFZlYzIodHJhbnNmb3JtLnEsIHZlcnRpY2VzW2ldKSk7XG4gICAgICAgICAgY29uc3QgcGl4ZWxWZXJ0ZXggPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQodmVydGV4KTtcbiAgICAgICAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhwaXhlbFZlcnRleC54LCBwaXhlbFZlcnRleC55KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBkcmF3VmVsb2NpdHkoYm9keTogcGxhbmNrLkJvZHkpOiB2b2lkIHtcbiAgICBjb25zdCBwb3NpdGlvbiA9IGJvZHkuZ2V0UG9zaXRpb24oKTtcbiAgICBjb25zdCB2ZWxvY2l0eSA9IGJvZHkuZ2V0TGluZWFyVmVsb2NpdHkoKTtcblxuICAgIC8vIFNjYWxlIHZlbG9jaXR5IGZvciB2aXNpYmlsaXR5XG4gICAgY29uc3Qgc2NhbGUgPSAwLjU7XG4gICAgY29uc3QgZW5kUG9pbnQgPSBwbGFuY2suVmVjMi5hZGQocG9zaXRpb24sIHBsYW5jay5WZWMyLm11bCh2ZWxvY2l0eSwgc2NhbGUpKTtcblxuICAgIGNvbnN0IHBpeGVsU3RhcnQgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQocG9zaXRpb24pO1xuICAgIGNvbnN0IHBpeGVsRW5kID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KGVuZFBvaW50KTtcblxuICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKHtcbiAgICAgIHdpZHRoOiAyLFxuICAgICAgY29sb3I6IDB4MDBGRkZGLFxuICAgICAgYWxwaGE6IDAuOFxuICAgIH0pO1xuXG4gICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxTdGFydC54LCBwaXhlbFN0YXJ0LnkpO1xuICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKHBpeGVsRW5kLngsIHBpeGVsRW5kLnkpO1xuICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG5cbiAgICAvLyBEcmF3IGFycm93IGhlYWRcbiAgICBjb25zdCBhbmdsZSA9IE1hdGguYXRhbjIocGl4ZWxFbmQueSAtIHBpeGVsU3RhcnQueSwgcGl4ZWxFbmQueCAtIHBpeGVsU3RhcnQueCk7XG4gICAgY29uc3QgYXJyb3dTaXplID0gNTtcbiAgICBjb25zdCBhbmdsZTEgPSBhbmdsZSArIE1hdGguUEkgKiAwLjg7XG4gICAgY29uc3QgYW5nbGUyID0gYW5nbGUgLSBNYXRoLlBJICogMC44O1xuXG4gICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxFbmQueCwgcGl4ZWxFbmQueSk7XG4gICAgdGhpcy5ncmFwaGljcy5saW5lVG8oXG4gICAgICBwaXhlbEVuZC54ICsgTWF0aC5jb3MoYW5nbGUxKSAqIGFycm93U2l6ZSxcbiAgICAgIHBpeGVsRW5kLnkgKyBNYXRoLnNpbihhbmdsZTEpICogYXJyb3dTaXplXG4gICAgKTtcbiAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwaXhlbEVuZC54LCBwaXhlbEVuZC55KTtcbiAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhcbiAgICAgIHBpeGVsRW5kLnggKyBNYXRoLmNvcyhhbmdsZTIpICogYXJyb3dTaXplLFxuICAgICAgcGl4ZWxFbmQueSArIE1hdGguc2luKGFuZ2xlMikgKiBhcnJvd1NpemVcbiAgICApO1xuICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG4gIH1cblxuICBwcml2YXRlIGRyYXdBQUJCKGJvZHk6IHBsYW5jay5Cb2R5KTogdm9pZCB7XG4gICAgZm9yIChsZXQgZml4dHVyZSA9IGJvZHkuZ2V0Rml4dHVyZUxpc3QoKTsgZml4dHVyZTsgZml4dHVyZSA9IGZpeHR1cmUuZ2V0TmV4dCgpKSB7XG4gICAgICBjb25zdCBhYWJiID0gZml4dHVyZS5nZXRBQUJCKDApO1xuXG4gICAgICBjb25zdCBsb3dlckJvdW5kID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KGFhYmIubG93ZXJCb3VuZCk7XG4gICAgICBjb25zdCB1cHBlckJvdW5kID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KGFhYmIudXBwZXJCb3VuZCk7XG5cbiAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKHtcbiAgICAgICAgd2lkdGg6IDEsXG4gICAgICAgIGNvbG9yOiAweEZGMDBGRixcbiAgICAgICAgYWxwaGE6IDAuM1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuZ3JhcGhpY3MucmVjdChcbiAgICAgICAgbG93ZXJCb3VuZC54LFxuICAgICAgICBsb3dlckJvdW5kLnksXG4gICAgICAgIHVwcGVyQm91bmQueCAtIGxvd2VyQm91bmQueCxcbiAgICAgICAgdXBwZXJCb3VuZC55IC0gbG93ZXJCb3VuZC55XG4gICAgICApO1xuICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRyYXdDZW50ZXJPZk1hc3MoYm9keTogcGxhbmNrLkJvZHkpOiB2b2lkIHtcbiAgICBjb25zdCBwb3NpdGlvbiA9IGJvZHkuZ2V0V29ybGRDZW50ZXIoKTtcbiAgICBjb25zdCBwaXhlbFBvcyA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChwb3NpdGlvbik7XG5cbiAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSh7XG4gICAgICB3aWR0aDogMSxcbiAgICAgIGNvbG9yOiAweEZGRkZGRixcbiAgICAgIGFscGhhOiAxXG4gICAgfSk7XG5cbiAgICBjb25zdCBzaXplID0gNTtcbiAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwaXhlbFBvcy54IC0gc2l6ZSwgcGl4ZWxQb3MueSk7XG4gICAgdGhpcy5ncmFwaGljcy5saW5lVG8ocGl4ZWxQb3MueCArIHNpemUsIHBpeGVsUG9zLnkpO1xuICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsUG9zLngsIHBpeGVsUG9zLnkgLSBzaXplKTtcbiAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhwaXhlbFBvcy54LCBwaXhlbFBvcy55ICsgc2l6ZSk7XG4gICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcbiAgfVxuXG4gIHByaXZhdGUgZHJhd0NvbnRhY3RzKCk6IHZvaWQge1xuICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBhbGwgY29udGFjdHMgaW4gdGhlIHdvcmxkXG4gICAgZm9yIChsZXQgY29udGFjdCA9IHRoaXMud29ybGQud29ybGQuZ2V0Q29udGFjdExpc3QoKTsgY29udGFjdDsgY29udGFjdCA9IGNvbnRhY3QuZ2V0TmV4dCgpKSB7XG4gICAgICBpZiAoIWNvbnRhY3QuaXNUb3VjaGluZygpKSBjb250aW51ZTtcblxuICAgICAgY29uc3QgbWFuaWZvbGQgPSBjb250YWN0LmdldE1hbmlmb2xkKCk7XG4gICAgICBpZiAoIW1hbmlmb2xkKSBjb250aW51ZTtcblxuICAgICAgY29uc3Qgd29ybGRNYW5pZm9sZCA9IGNvbnRhY3QuZ2V0V29ybGRNYW5pZm9sZChudWxsKTtcbiAgICAgIGlmICghd29ybGRNYW5pZm9sZCkgY29udGludWU7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFuaWZvbGQucG9pbnRDb3VudDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHBvaW50ID0gd29ybGRNYW5pZm9sZC5wb2ludHNbaV07XG4gICAgICAgIGlmICghcG9pbnQpIGNvbnRpbnVlO1xuICAgICAgICBjb25zdCBwaXhlbFBvaW50ID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHBsYW5jay5WZWMyKHBvaW50LngsIHBvaW50LnkpKTtcblxuICAgICAgICB0aGlzLmdyYXBoaWNzLmNpcmNsZShwaXhlbFBvaW50LngsIHBpeGVsUG9pbnQueSwgMyk7XG4gICAgICAgIHRoaXMuZ3JhcGhpY3MuZmlsbCh7IGNvbG9yOiAweEZGMDAwMCwgYWxwaGE6IDAuOCB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0IHZpc2liaWxpdHkgb2YgZGVidWcgcmVuZGVyZXJcbiAgICovXG4gIHNldFZpc2libGUodmlzaWJsZTogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuaXNWaXNpYmxlID0gdmlzaWJsZTtcbiAgICBpZiAoIXZpc2libGUpIHtcbiAgICAgIHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVG9nZ2xlIGRlYnVnIHJlbmRlcmVyIHZpc2liaWxpdHlcbiAgICovXG4gIHRvZ2dsZSgpOiB2b2lkIHtcbiAgICB0aGlzLnNldFZpc2libGUoIXRoaXMuaXNWaXNpYmxlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBkZWJ1ZyByZW5kZXJlciBpcyB2aXNpYmxlXG4gICAqL1xuICBnZXRWaXNpYmxlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmlzVmlzaWJsZTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCAqIGFzIHBsYW5jayBmcm9tICdwbGFuY2snO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzV29ybGQgfSBmcm9tICcuL3BoeXNpY3Mtd29ybGQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFBhcnNlZFNoYXBlIHtcbiAgdHlwZTogJ2NpcmNsZScgfCAncmVjdGFuZ2xlJyB8ICdwb2x5Z29uJztcbiAgc2hhcGU6IHBsYW5jay5TaGFwZTtcbn1cblxuLyoqXG4gKiBTaGFwZSBtZXRhZGF0YSBzdG9yZWQgb24gR3JhcGhpY3MgZm9yIHBoeXNpY3MgcGFyc2luZ1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFBoeXNpY3NTaGFwZU1ldGFkYXRhIHtcbiAgdHlwZTogJ2NpcmNsZScgfCAncmVjdGFuZ2xlJyB8ICdwb2x5Z29uJztcbiAgcmFkaXVzPzogbnVtYmVyO1xuICB3aWR0aD86IG51bWJlcjtcbiAgaGVpZ2h0PzogbnVtYmVyO1xuICB2ZXJ0aWNlcz86IG51bWJlcltdO1xufVxuXG5jb25zdCBQSFlTSUNTX1NIQVBFX0tFWSA9ICdfX3BoeXNpY3NTaGFwZV9fJztcblxuLyoqXG4gKiBTdG9yZSBzaGFwZSBtZXRhZGF0YSBvbiBHcmFwaGljcyBvYmplY3RcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldEdyYXBoaWNzUGh5c2ljc1NoYXBlKGdyYXBoaWNzOiBQSVhJLkdyYXBoaWNzLCBtZXRhZGF0YTogUGh5c2ljc1NoYXBlTWV0YWRhdGEpOiB2b2lkIHtcbiAgKGdyYXBoaWNzIGFzIGFueSlbUEhZU0lDU19TSEFQRV9LRVldID0gbWV0YWRhdGE7XG59XG5cbi8qKlxuICogRXh0ZW5kIFBJWEkgR3JhcGhpY3MgdG8gYXV0b21hdGljYWxseSB0cmFjayBzaGFwZSBkYXRhIGZvciBwaHlzaWNzXG4gKiBUaGlzIHBhdGNoZXMgR3JhcGhpY3MgbWV0aG9kcyB0byBzdG9yZSBtZXRhZGF0YSBmb3IgcGh5c2ljcyBjb2xsaXNpb24gc2hhcGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0R3JhcGhpY3NQaHlzaWNzVHJhY2tpbmcoKTogdm9pZCB7XG4gIC8vIFNhdmUgb3JpZ2luYWwgbWV0aG9kc1xuICBjb25zdCBvcmlnaW5hbFJlY3QgPSBQSVhJLkdyYXBoaWNzLnByb3RvdHlwZS5yZWN0O1xuICBjb25zdCBvcmlnaW5hbENpcmNsZSA9IFBJWEkuR3JhcGhpY3MucHJvdG90eXBlLmNpcmNsZTtcbiAgY29uc3Qgb3JpZ2luYWxQb2x5ID0gUElYSS5HcmFwaGljcy5wcm90b3R5cGUucG9seTtcblxuICAvLyBQYXRjaCByZWN0KCkgdG8gc3RvcmUgbWV0YWRhdGFcbiAgUElYSS5HcmFwaGljcy5wcm90b3R5cGUucmVjdCA9IGZ1bmN0aW9uICh4OiBudW1iZXIsIHk6IG51bWJlciwgdzogbnVtYmVyLCBoOiBudW1iZXIpIHtcbiAgICBzZXRHcmFwaGljc1BoeXNpY3NTaGFwZSh0aGlzLCB7XG4gICAgICB0eXBlOiAncmVjdGFuZ2xlJyxcbiAgICAgIHdpZHRoOiB3LFxuICAgICAgaGVpZ2h0OiBoXG4gICAgfSk7XG4gICAgcmV0dXJuIG9yaWdpbmFsUmVjdC5jYWxsKHRoaXMsIHgsIHksIHcsIGgpO1xuICB9O1xuXG4gIC8vIFBhdGNoIGNpcmNsZSgpIHRvIHN0b3JlIG1ldGFkYXRhXG4gIFBJWEkuR3JhcGhpY3MucHJvdG90eXBlLmNpcmNsZSA9IGZ1bmN0aW9uICh4OiBudW1iZXIsIHk6IG51bWJlciwgcmFkaXVzOiBudW1iZXIpIHtcbiAgICBzZXRHcmFwaGljc1BoeXNpY3NTaGFwZSh0aGlzLCB7XG4gICAgICB0eXBlOiAnY2lyY2xlJyxcbiAgICAgIHJhZGl1czogcmFkaXVzXG4gICAgfSk7XG4gICAgcmV0dXJuIG9yaWdpbmFsQ2lyY2xlLmNhbGwodGhpcywgeCwgeSwgcmFkaXVzKTtcbiAgfTtcblxuICAvLyBQYXRjaCBwb2x5KCkgdG8gc3RvcmUgbWV0YWRhdGFcbiAgUElYSS5HcmFwaGljcy5wcm90b3R5cGUucG9seSA9IGZ1bmN0aW9uIChwb2ludHM6IFBJWEkuUG9pbnREYXRhW10gfCBudW1iZXJbXSkge1xuICAgIGNvbnN0IGZsYXRQb2ludHMgPSBBcnJheS5pc0FycmF5KHBvaW50c1swXSkgPyBwb2ludHMuZmxhdCgpIDogcG9pbnRzO1xuICAgIHNldEdyYXBoaWNzUGh5c2ljc1NoYXBlKHRoaXMsIHtcbiAgICAgIHR5cGU6ICdwb2x5Z29uJyxcbiAgICAgIHZlcnRpY2VzOiBmbGF0UG9pbnRzIGFzIG51bWJlcltdXG4gICAgfSk7XG4gICAgcmV0dXJuIG9yaWdpbmFsUG9seS5jYWxsKHRoaXMsIHBvaW50cyBhcyBhbnkpO1xuICB9O1xufVxuXG4vKipcbiAqIFBhcnNlIFBJWEkgR3JhcGhpY3MgZ2VvbWV0cnkgdG8gZXh0cmFjdCBjb2xsaXNpb24gc2hhcGUgZm9yIHBoeXNpY3NcbiAqXG4gKiBVc2VzIG1ldGFkYXRhIHN0b3JlZCBieSBoZWxwZXIgZnVuY3Rpb25zIG9yIGZhbGxzIGJhY2sgdG8gYm91bmRzLWJhc2VkIHJlY3RhbmdsZVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VHcmFwaGljc1NoYXBlKGdyYXBoaWNzOiBQSVhJLkdyYXBoaWNzLCB3b3JsZDogUGh5c2ljc1dvcmxkKTogUGFyc2VkU2hhcGUge1xuICAvLyBDaGVjayBpZiBzaGFwZSBtZXRhZGF0YSB3YXMgc3RvcmVkXG4gIGNvbnN0IG1ldGFkYXRhID0gKGdyYXBoaWNzIGFzIGFueSlbUEhZU0lDU19TSEFQRV9LRVldIGFzIFBoeXNpY3NTaGFwZU1ldGFkYXRhIHwgdW5kZWZpbmVkO1xuXG4gIGlmIChtZXRhZGF0YSkge1xuICAgIC8vIFVzZSBzdG9yZWQgbWV0YWRhdGFcbiAgICBzd2l0Y2ggKG1ldGFkYXRhLnR5cGUpIHtcbiAgICAgIGNhc2UgJ2NpcmNsZSc6XG4gICAgICAgIGlmICghbWV0YWRhdGEucmFkaXVzKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDaXJjbGUgbWV0YWRhdGEgbWlzc2luZyByYWRpdXMnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6ICdjaXJjbGUnLFxuICAgICAgICAgIHNoYXBlOiBwbGFuY2suQ2lyY2xlKHdvcmxkLnRvUGh5c2ljcyhtZXRhZGF0YS5yYWRpdXMpKVxuICAgICAgICB9O1xuXG4gICAgICBjYXNlICdyZWN0YW5nbGUnOlxuICAgICAgICBpZiAoIW1ldGFkYXRhLndpZHRoIHx8ICFtZXRhZGF0YS5oZWlnaHQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlY3RhbmdsZSBtZXRhZGF0YSBtaXNzaW5nIHdpZHRoL2hlaWdodCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogJ3JlY3RhbmdsZScsXG4gICAgICAgICAgc2hhcGU6IHBsYW5jay5Cb3goXG4gICAgICAgICAgICB3b3JsZC50b1BoeXNpY3MobWV0YWRhdGEud2lkdGggLyAyKSxcbiAgICAgICAgICAgIHdvcmxkLnRvUGh5c2ljcyhtZXRhZGF0YS5oZWlnaHQgLyAyKVxuICAgICAgICAgIClcbiAgICAgICAgfTtcblxuICAgICAgY2FzZSAncG9seWdvbic6XG4gICAgICAgIGlmICghbWV0YWRhdGEudmVydGljZXMgfHwgbWV0YWRhdGEudmVydGljZXMubGVuZ3RoIDwgNikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUG9seWdvbiBtZXRhZGF0YSBtaXNzaW5nIHZlcnRpY2VzIChuZWVkIGF0IGxlYXN0IDMgcG9pbnRzID0gNiB2YWx1ZXMpJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmVydGljZXM6IHBsYW5jay5WZWMyW10gPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZXRhZGF0YS52ZXJ0aWNlcy5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgICAgIHZlcnRpY2VzLnB1c2goXG4gICAgICAgICAgICBwbGFuY2suVmVjMihcbiAgICAgICAgICAgICAgd29ybGQudG9QaHlzaWNzKG1ldGFkYXRhLnZlcnRpY2VzW2ldKSxcbiAgICAgICAgICAgICAgd29ybGQudG9QaHlzaWNzKG1ldGFkYXRhLnZlcnRpY2VzW2kgKyAxXSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogJ3BvbHlnb24nLFxuICAgICAgICAgIHNoYXBlOiBwbGFuY2suUG9seWdvbih2ZXJ0aWNlcylcbiAgICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvLyBGYWxsYmFjazogVXNlIGJvdW5kaW5nIGJveCBhcyByZWN0YW5nbGVcbiAgY29uc3QgYm91bmRzID0gZ3JhcGhpY3MuZ2V0TG9jYWxCb3VuZHMoKTtcblxuICBpZiAoYm91bmRzLndpZHRoID09PSAwIHx8IGJvdW5kcy5oZWlnaHQgPT09IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnR3JhcGhpY3MgaGFzIG5vIGRpbWVuc2lvbnMuIEVpdGhlciBkcmF3IHNoYXBlcyB1c2luZyByZWN0KCksIGNpcmNsZSgpLCBvciBwb2x5KCksICcgK1xuICAgICAgJ29yIHByb3ZpZGUgYW4gZXhwbGljaXQgY29sbGlzaW9uU2hhcGUgb3B0aW9uLidcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAncmVjdGFuZ2xlJyxcbiAgICBzaGFwZTogcGxhbmNrLkJveChcbiAgICAgIHdvcmxkLnRvUGh5c2ljcyhib3VuZHMud2lkdGggLyAyKSxcbiAgICAgIHdvcmxkLnRvUGh5c2ljcyhib3VuZHMuaGVpZ2h0IC8gMilcbiAgICApXG4gIH07XG59XG4iLCJpbXBvcnQgdHlwZSB7IFBoeXNpY3NCb2R5T3B0aW9ucyB9IGZyb20gJy4vcGh5c2ljcy10eXBlcyc7XG5cbi8qKlxuICogUHJlZGVmaW5lZCBtYXRlcmlhbCBwcmVzZXRzIGZvciBjb21tb24gcGh5c2ljcyBiZWhhdmlvcnNcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgYmFsbCA9IGFzUGh5c2ljc0VudGl0eShzcHJpdGUsIHdvcmxkLCB7XG4gKiAgIHR5cGU6ICdkeW5hbWljJyxcbiAqICAgLi4uUGh5c2ljc01hdGVyaWFscy5ib3VuY3lcbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjb25zdCBQaHlzaWNzTWF0ZXJpYWxzID0ge1xuICAvKipcbiAgICogQm91bmN5IGJhbGwgLSBoaWdoIHJlc3RpdHV0aW9uLCBsb3cgZnJpY3Rpb25cbiAgICovXG4gIGJvdW5jeToge1xuICAgIGRlbnNpdHk6IDAuNSxcbiAgICBmcmljdGlvbjogMC4xLFxuICAgIHJlc3RpdHV0aW9uOiAwLjlcbiAgfSxcblxuICAvKipcbiAgICogV29vZGVuIGJveCAtIG1lZGl1bSBkZW5zaXR5LCBtZWRpdW0gZnJpY3Rpb25cbiAgICovXG4gIHdvb2Q6IHtcbiAgICBkZW5zaXR5OiAwLjcsXG4gICAgZnJpY3Rpb246IDAuNCxcbiAgICByZXN0aXR1dGlvbjogMC4yXG4gIH0sXG5cbiAgLyoqXG4gICAqIE1ldGFsIG9iamVjdCAtIGhpZ2ggZGVuc2l0eSwgbG93IHJlc3RpdHV0aW9uXG4gICAqL1xuICBtZXRhbDoge1xuICAgIGRlbnNpdHk6IDEuNSxcbiAgICBmcmljdGlvbjogMC4zLFxuICAgIHJlc3RpdHV0aW9uOiAwLjFcbiAgfSxcblxuICAvKipcbiAgICogSWNlIC0gdmVyeSBsb3cgZnJpY3Rpb24sIGxvdyByZXN0aXR1dGlvblxuICAgKi9cbiAgaWNlOiB7XG4gICAgZGVuc2l0eTogMC45LFxuICAgIGZyaWN0aW9uOiAwLjAyLFxuICAgIHJlc3RpdHV0aW9uOiAwLjA1XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJ1YmJlciAtIGhpZ2ggZnJpY3Rpb24sIGhpZ2ggcmVzdGl0dXRpb25cbiAgICovXG4gIHJ1YmJlcjoge1xuICAgIGRlbnNpdHk6IDEuMCxcbiAgICBmcmljdGlvbjogMC45LFxuICAgIHJlc3RpdHV0aW9uOiAwLjdcbiAgfSxcblxuICAvKipcbiAgICogQ2hhcmFjdGVyIC0gbm8gcm90YXRpb24sIG1lZGl1bSBmcmljdGlvblxuICAgKi9cbiAgY2hhcmFjdGVyOiB7XG4gICAgZGVuc2l0eTogMS4wLFxuICAgIGZyaWN0aW9uOiAwLjUsXG4gICAgcmVzdGl0dXRpb246IDAuMCxcbiAgICBmaXhlZFJvdGF0aW9uOiB0cnVlXG4gIH0sXG5cbiAgLyoqXG4gICAqIFN0YXRpYyB0ZXJyYWluIC0gbm8gZGVuc2l0eSAoaW1tb3ZhYmxlKSwgaGlnaCBmcmljdGlvblxuICAgKi9cbiAgdGVycmFpbjoge1xuICAgIGRlbnNpdHk6IDAsXG4gICAgZnJpY3Rpb246IDAuNixcbiAgICByZXN0aXR1dGlvbjogMC4wXG4gIH1cbn0gYXMgY29uc3Q7XG5cbi8qKlxuICogQXBwbHkgbWF0ZXJpYWwgcHJlc2V0IHRvIG9wdGlvbnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5TWF0ZXJpYWwoXG4gIG9wdGlvbnM6IFBoeXNpY3NCb2R5T3B0aW9ucyxcbiAgbWF0ZXJpYWw6IGtleW9mIHR5cGVvZiBQaHlzaWNzTWF0ZXJpYWxzXG4pOiBQaHlzaWNzQm9keU9wdGlvbnMge1xuICByZXR1cm4ge1xuICAgIC4uLm9wdGlvbnMsXG4gICAgLi4uUGh5c2ljc01hdGVyaWFsc1ttYXRlcmlhbF1cbiAgfTtcbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBhc0VudGl0eSwgQXNFbnRpdHkgfSBmcm9tICcuLi8uLi9jb3JlL21veGktZW50aXR5JztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi9waHlzaWNzLXdvcmxkJztcbmltcG9ydCB7IFBoeXNpY3NCb2R5TG9naWMgfSBmcm9tICcuL3BoeXNpY3MtYm9keS1sb2dpYyc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NCb2R5T3B0aW9ucywgU2hhcGVDb25maWcgfSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuXG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBjcmVhdGUgYSBwaHlzaWNzLWVuYWJsZWQgZW50aXR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZSh0ZXh0dXJlKTtcbiAqIGNvbnN0IHBoeXNpY3NFbnRpdHkgPSBhc1BoeXNpY3NFbnRpdHkoc3ByaXRlLCBwaHlzaWNzV29ybGQsIHtcbiAqICAgdHlwZTogJ2R5bmFtaWMnLFxuICogICBzaGFwZTogJ2NpcmNsZScsXG4gKiAgIHJhZGl1czogMjVcbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc1BoeXNpY3NFbnRpdHk8VCBleHRlbmRzIFBJWEkuQ29udGFpbmVyPihcbiAgcGl4aU9iamVjdDogVCxcbiAgd29ybGQ6IFBoeXNpY3NXb3JsZCxcbiAgb3B0aW9uczogUGh5c2ljc0JvZHlPcHRpb25zID0ge31cbik6IEFzRW50aXR5PFQ+IHtcbiAgY29uc3QgZW50aXR5ID0gYXNFbnRpdHkocGl4aU9iamVjdCk7XG4gIGNvbnN0IHBoeXNpY3NMb2dpYyA9IG5ldyBQaHlzaWNzQm9keUxvZ2ljKHdvcmxkLCBvcHRpb25zKTtcbiAgZW50aXR5Lm1veGlFbnRpdHkuYWRkTG9naWMocGh5c2ljc0xvZ2ljKTtcbiAgcmV0dXJuIGVudGl0eSBhcyBBc0VudGl0eTxUPjtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiBlbnRpdHkgaGFzIHBoeXNpY3MgYm9keVxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzUGh5c2ljcyhlbnRpdHk6IGFueSk6IGJvb2xlYW4ge1xuICBpZiAoIWVudGl0eS5tb3hpRW50aXR5KSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiBlbnRpdHkubW94aUVudGl0eS5nZXRMb2dpYygnUGh5c2ljc0JvZHlMb2dpYycpICE9PSB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogR2V0IHBoeXNpY3MgYm9keSBsb2dpYyBmcm9tIGVudGl0eVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGh5c2ljc0JvZHkoZW50aXR5OiBhbnkpOiBQaHlzaWNzQm9keUxvZ2ljIHwgdW5kZWZpbmVkIHtcbiAgaWYgKCFlbnRpdHkubW94aUVudGl0eSkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgcmV0dXJuIGVudGl0eS5tb3hpRW50aXR5LmdldExvZ2ljKCdQaHlzaWNzQm9keUxvZ2ljJykgYXMgUGh5c2ljc0JvZHlMb2dpYyB8IHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBTaGFwZSBjcmVhdGlvbiBmcm9tIHNwcml0ZSBib3VuZHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNoYXBlRnJvbVNwcml0ZShcbiAgc3ByaXRlOiBQSVhJLlNwcml0ZSxcbiAgdHlwZTogJ3JlY3RhbmdsZScgfCAnY2lyY2xlJyB8ICdhdXRvJyA9ICdhdXRvJ1xuKTogU2hhcGVDb25maWcge1xuICBjb25zdCBib3VuZHMgPSBzcHJpdGUuZ2V0TG9jYWxCb3VuZHMoKTtcblxuICBpZiAodHlwZSA9PT0gJ2F1dG8nKSB7XG4gICAgLy8gQ2hlY2sgaWYgcm91Z2hseSBzcXVhcmUgLT4gY2lyY2xlLCBlbHNlIHJlY3RhbmdsZVxuICAgIGNvbnN0IHJhdGlvID0gYm91bmRzLndpZHRoIC8gYm91bmRzLmhlaWdodDtcbiAgICB0eXBlID0gKHJhdGlvID4gMC44ICYmIHJhdGlvIDwgMS4yKSA/ICdjaXJjbGUnIDogJ3JlY3RhbmdsZSc7XG4gIH1cblxuICBpZiAodHlwZSA9PT0gJ2NpcmNsZScpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2hhcGU6ICdjaXJjbGUnLFxuICAgICAgcmFkaXVzOiBNYXRoLm1heChib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHQpIC8gMlxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNoYXBlOiAncmVjdGFuZ2xlJyxcbiAgICAgIHdpZHRoOiBib3VuZHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IGJvdW5kcy5oZWlnaHRcbiAgICB9O1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0ICogYXMgcGxhbmNrIGZyb20gJ3BsYW5jayc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NXb3JsZE9wdGlvbnMsIFJheWNhc3RDYWxsYmFjaywgUGh5c2ljc0RlYnVnT3B0aW9ucyB9IGZyb20gJy4vcGh5c2ljcy10eXBlcyc7XG5pbXBvcnQgeyBDb2xsaXNpb25SZWdpc3RyeSwgQ29sbGlzaW9uTWFuYWdlciB9IGZyb20gJy4vcGh5c2ljcy1jb2xsaXNpb24nO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzQm9keUxvZ2ljIH0gZnJvbSAnLi9waHlzaWNzLWJvZHktbG9naWMnO1xuaW1wb3J0IHsgUGh5c2ljc0RlYnVnUmVuZGVyZXIgfSBmcm9tICcuL3BoeXNpY3MtZGVidWctcmVuZGVyZXInO1xuaW1wb3J0IHsgYXNFbnRpdHkgfSBmcm9tICcuLi8uLi9jb3JlL21veGktZW50aXR5JztcbmltcG9ydCB7IGluaXRHcmFwaGljc1BoeXNpY3NUcmFja2luZyB9IGZyb20gJy4vcGh5c2ljcy1ncmFwaGljcy1wYXJzZXInO1xuXG4vKipcbiAqIFBoeXNpY3NXb3JsZCBtYW5hZ2VzIHRoZSBQbGFuY2suanMgcGh5c2ljcyBzaW11bGF0aW9uIGFuZCBwcm92aWRlc1xuICogaW50ZWdyYXRpb24gd2l0aCBNT1hJJ3MgU2NlbmUvRW5naW5lLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBwaHlzaWNzV29ybGQgPSBuZXcgUGh5c2ljc1dvcmxkKHtcbiAqICAgZ3Jhdml0eTogeyB4OiAwLCB5OiA5LjggfSxcbiAqICAgcGl4ZWxzUGVyTWV0ZXI6IDMwXG4gKiB9KTtcbiAqXG4gKiAvLyBJbnRlZ3JhdGUgd2l0aCBlbmdpbmVcbiAqIGVuZ2luZS5hZGRQaHlzaWNzV29ybGQocGh5c2ljc1dvcmxkKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgUGh5c2ljc1dvcmxkIHtcbiAgLyoqIFRoZSBQbGFuY2suanMgd29ybGQgaW5zdGFuY2UgKi9cbiAgcHVibGljIHdvcmxkOiBwbGFuY2suV29ybGQ7XG5cbiAgLyoqIFBpeGVscyBwZXIgbWV0ZXIgY29udmVyc2lvbiBmYWN0b3IgKi9cbiAgcHVibGljIHBpeGVsc1Blck1ldGVyOiBudW1iZXIgPSAzMDtcblxuICAvKiogRml4ZWQgdGltZXN0ZXAgaW4gc2Vjb25kcyAqL1xuICBwdWJsaWMgdGltZXN0ZXA6IG51bWJlciA9IDEvNjA7XG5cbiAgLyoqIENvbGxpc2lvbiB0YWcgcmVnaXN0cnkgKi9cbiAgcHVibGljIGNvbGxpc2lvblJlZ2lzdHJ5OiBDb2xsaXNpb25SZWdpc3RyeTtcblxuICAvKiogQ29sbGlzaW9uIGV2ZW50IG1hbmFnZXIgKi9cbiAgcHVibGljIGNvbGxpc2lvbk1hbmFnZXI6IENvbGxpc2lvbk1hbmFnZXI7XG5cbiAgLyoqIFZlbG9jaXR5IGl0ZXJhdGlvbnMgZm9yIHNvbHZlciAqL1xuICBwcml2YXRlIHZlbG9jaXR5SXRlcmF0aW9uczogbnVtYmVyID0gODtcblxuICAvKiogUG9zaXRpb24gaXRlcmF0aW9ucyBmb3Igc29sdmVyICovXG4gIHByaXZhdGUgcG9zaXRpb25JdGVyYXRpb25zOiBudW1iZXIgPSAzO1xuXG4gIC8qKiBUaW1lIGFjY3VtdWxhdG9yIGZvciBmaXhlZCB0aW1lc3RlcCAqL1xuICBwcml2YXRlIGFjY3VtdWxhdG9yOiBudW1iZXIgPSAwO1xuXG4gIC8qKiBSZWdpc3RyeSBvZiBwaHlzaWNzIGJvZGllcyAqL1xuICBwcml2YXRlIGJvZGllczogTWFwPHBsYW5jay5Cb2R5LCBQaHlzaWNzQm9keUxvZ2ljPiA9IG5ldyBNYXAoKTtcblxuICAvKiogRGVidWcgcmVuZGVyZXIgcmVmZXJlbmNlICovXG4gIHByaXZhdGUgZGVidWdSZW5kZXJlcj86IFBoeXNpY3NEZWJ1Z1JlbmRlcmVyO1xuXG4gIC8qKiBEZWJ1ZyBncmFwaGljcyBjb250YWluZXIgKi9cbiAgcHJpdmF0ZSBkZWJ1Z0dyYXBoaWNzPzogUElYSS5HcmFwaGljcztcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBQaHlzaWNzV29ybGRPcHRpb25zID0ge30pIHtcbiAgICAvLyBJbml0aWFsaXplIEdyYXBoaWNzIHBoeXNpY3MgdHJhY2tpbmcgKHBhdGNoZXMgUElYSS5HcmFwaGljcyBtZXRob2RzKVxuICAgIGluaXRHcmFwaGljc1BoeXNpY3NUcmFja2luZygpO1xuXG4gICAgY29uc3Qge1xuICAgICAgZ3Jhdml0eSA9IHsgeDogMCwgeTogOS44IH0sXG4gICAgICBwaXhlbHNQZXJNZXRlciA9IDMwLFxuICAgICAgdmVsb2NpdHlJdGVyYXRpb25zID0gOCxcbiAgICAgIHBvc2l0aW9uSXRlcmF0aW9ucyA9IDMsXG4gICAgICBlbmFibGVTbGVlcGluZyA9IHRydWUsXG4gICAgICB0aW1lc3RlcCA9IDEvNjBcbiAgICB9ID0gb3B0aW9ucztcblxuICAgIHRoaXMucGl4ZWxzUGVyTWV0ZXIgPSBwaXhlbHNQZXJNZXRlcjtcbiAgICB0aGlzLnZlbG9jaXR5SXRlcmF0aW9ucyA9IHZlbG9jaXR5SXRlcmF0aW9ucztcbiAgICB0aGlzLnBvc2l0aW9uSXRlcmF0aW9ucyA9IHBvc2l0aW9uSXRlcmF0aW9ucztcbiAgICB0aGlzLnRpbWVzdGVwID0gdGltZXN0ZXA7XG5cbiAgICAvLyBDcmVhdGUgUGxhbmNrIHdvcmxkXG4gICAgdGhpcy53b3JsZCA9IHBsYW5jay5Xb3JsZCh7XG4gICAgICBncmF2aXR5OiBwbGFuY2suVmVjMihncmF2aXR5LngsIGdyYXZpdHkueSlcbiAgICB9KTtcblxuICAgIC8vIENvbmZpZ3VyZSBzbGVlcGluZ1xuICAgIHRoaXMud29ybGQuc2V0QWxsb3dTbGVlcGluZyhlbmFibGVTbGVlcGluZyk7XG5cbiAgICAvLyBJbml0aWFsaXplIGNvbGxpc2lvbiBzeXN0ZW1cbiAgICB0aGlzLmNvbGxpc2lvblJlZ2lzdHJ5ID0gbmV3IENvbGxpc2lvblJlZ2lzdHJ5KCk7XG4gICAgdGhpcy5jb2xsaXNpb25NYW5hZ2VyID0gbmV3IENvbGxpc2lvbk1hbmFnZXIodGhpcywgdGhpcy5jb2xsaXNpb25SZWdpc3RyeSk7XG4gIH1cblxuICAvKipcbiAgICogU3RlcCB0aGUgcGh5c2ljcyBzaW11bGF0aW9uIChjYWxsZWQgYnkgRW5naW5lIHVwZGF0ZSBsb29wKVxuICAgKiBVc2VzIGZpeGVkIHRpbWVzdGVwIGZvciBkZXRlcm1pbmlzdGljIHBoeXNpY3NcbiAgICovXG4gIHN0ZXAoZGVsdGFUaW1lOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLmFjY3VtdWxhdG9yICs9IGRlbHRhVGltZTtcblxuICAgIC8vIEZpeGVkIHRpbWVzdGVwIHVwZGF0ZXNcbiAgICB3aGlsZSAodGhpcy5hY2N1bXVsYXRvciA+PSB0aGlzLnRpbWVzdGVwKSB7XG4gICAgICB0aGlzLndvcmxkLnN0ZXAodGhpcy50aW1lc3RlcCwgdGhpcy52ZWxvY2l0eUl0ZXJhdGlvbnMsIHRoaXMucG9zaXRpb25JdGVyYXRpb25zKTtcbiAgICAgIHRoaXMuYWNjdW11bGF0b3IgLT0gdGhpcy50aW1lc3RlcDtcbiAgICB9XG5cbiAgICAvLyBOb3RlOiBJbnRlcnBvbGF0aW9uIGZvciByZW5kZXJpbmcgc21vb3RobmVzcyBjb3VsZCBiZSBhZGRlZCBoZXJlXG4gICAgLy8gY29uc3QgYWxwaGEgPSB0aGlzLmFjY3VtdWxhdG9yIC8gdGhpcy50aW1lc3RlcDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBwaHlzaWNzIGJvZHlcbiAgICovXG4gIGNyZWF0ZUJvZHkoZGVmOiBwbGFuY2suQm9keURlZik6IHBsYW5jay5Cb2R5IHtcbiAgICByZXR1cm4gdGhpcy53b3JsZC5jcmVhdGVCb2R5KGRlZik7XG4gIH1cblxuICAvKipcbiAgICogRGVzdHJveSBhIHBoeXNpY3MgYm9keVxuICAgKi9cbiAgZGVzdHJveUJvZHkoYm9keTogcGxhbmNrLkJvZHkpOiB2b2lkIHtcbiAgICB0aGlzLmJvZGllcy5kZWxldGUoYm9keSk7XG4gICAgdGhpcy53b3JsZC5kZXN0cm95Qm9keShib2R5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBhIHBoeXNpY3MgYm9keSBsb2dpYyBjb21wb25lbnRcbiAgICovXG4gIHJlZ2lzdGVyQm9keShib2R5OiBwbGFuY2suQm9keSwgbG9naWM6IFBoeXNpY3NCb2R5TG9naWMpOiB2b2lkIHtcbiAgICB0aGlzLmJvZGllcy5zZXQoYm9keSwgbG9naWMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBwaHlzaWNzIGJvZHkgbG9naWMgZnJvbSBQbGFuY2sgYm9keVxuICAgKi9cbiAgZ2V0Qm9keUxvZ2ljKGJvZHk6IHBsYW5jay5Cb2R5KTogUGh5c2ljc0JvZHlMb2dpYyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuYm9kaWVzLmdldChib2R5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSYXljYXN0IGZyb20gb25lIHBvaW50IHRvIGFub3RoZXJcbiAgICovXG4gIHJheWNhc3QoZnJvbTogUElYSS5Qb2ludCwgdG86IFBJWEkuUG9pbnQsIGNhbGxiYWNrOiBSYXljYXN0Q2FsbGJhY2spOiB2b2lkIHtcbiAgICBjb25zdCBwMSA9IHRoaXMudG9QaHlzaWNzUG9pbnQoZnJvbSk7XG4gICAgY29uc3QgcDIgPSB0aGlzLnRvUGh5c2ljc1BvaW50KHRvKTtcblxuICAgIHRoaXMud29ybGQucmF5Q2FzdChwMSwgcDIsIChmaXh0dXJlLCBwb2ludCwgbm9ybWFsLCBmcmFjdGlvbikgPT4ge1xuICAgICAgY29uc3QgcGl4ZWxQb2ludCA9IHRoaXMudG9QaXhlbHNQb2ludChwb2ludCk7XG4gICAgICBjb25zdCBwaXhlbE5vcm1hbCA9IG5ldyBQSVhJLlBvaW50KG5vcm1hbC54LCBub3JtYWwueSk7XG4gICAgICByZXR1cm4gY2FsbGJhY2soZml4dHVyZSwgcGl4ZWxQb2ludCwgcGl4ZWxOb3JtYWwsIGZyYWN0aW9uKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBRdWVyeSBBQUJCIChheGlzLWFsaWduZWQgYm91bmRpbmcgYm94KVxuICAgKi9cbiAgcXVlcnlBQUJCKGJvdW5kczogUElYSS5SZWN0YW5nbGUsIGNhbGxiYWNrOiAoYm9keTogcGxhbmNrLkJvZHkpID0+IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBjb25zdCBsb3dlckJvdW5kID0gdGhpcy50b1BoeXNpY3NQb2ludChuZXcgUElYSS5Qb2ludChib3VuZHMueCwgYm91bmRzLnkpKTtcbiAgICBjb25zdCB1cHBlckJvdW5kID0gdGhpcy50b1BoeXNpY3NQb2ludChuZXcgUElYSS5Qb2ludChib3VuZHMueCArIGJvdW5kcy53aWR0aCwgYm91bmRzLnkgKyBib3VuZHMuaGVpZ2h0KSk7XG5cbiAgICB0aGlzLndvcmxkLnF1ZXJ5QUFCQihwbGFuY2suQUFCQihsb3dlckJvdW5kLCB1cHBlckJvdW5kKSwgKGZpeHR1cmUpID0+IHtcbiAgICAgIHJldHVybiBjYWxsYmFjayhmaXh0dXJlLmdldEJvZHkoKSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUXVlcnkgcG9pbnRcbiAgICovXG4gIHF1ZXJ5UG9pbnQocG9pbnQ6IFBJWEkuUG9pbnQsIGNhbGxiYWNrOiAoZml4dHVyZTogcGxhbmNrLkZpeHR1cmUpID0+IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBjb25zdCBwaHlzaWNzUG9pbnQgPSB0aGlzLnRvUGh5c2ljc1BvaW50KHBvaW50KTtcblxuICAgIHRoaXMud29ybGQucXVlcnlBQUJCKFxuICAgICAgcGxhbmNrLkFBQkIoXG4gICAgICAgIHBsYW5jay5WZWMyKHBoeXNpY3NQb2ludC54IC0gMC4wMDEsIHBoeXNpY3NQb2ludC55IC0gMC4wMDEpLFxuICAgICAgICBwbGFuY2suVmVjMihwaHlzaWNzUG9pbnQueCArIDAuMDAxLCBwaHlzaWNzUG9pbnQueSArIDAuMDAxKVxuICAgICAgKSxcbiAgICAgIChmaXh0dXJlKSA9PiB7XG4gICAgICAgIGlmIChmaXh0dXJlLnRlc3RQb2ludChwaHlzaWNzUG9pbnQpKSB7XG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGZpeHR1cmUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBwaXhlbHMgdG8gbWV0ZXJzXG4gICAqL1xuICB0b1BoeXNpY3MocGl4ZWxzOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBwaXhlbHMgLyB0aGlzLnBpeGVsc1Blck1ldGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgbWV0ZXJzIHRvIHBpeGVsc1xuICAgKi9cbiAgdG9QaXhlbHMobWV0ZXJzOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBtZXRlcnMgKiB0aGlzLnBpeGVsc1Blck1ldGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgUElYSSBQb2ludCAocGl4ZWxzKSB0byBQbGFuY2sgVmVjMiAobWV0ZXJzKVxuICAgKi9cbiAgdG9QaHlzaWNzUG9pbnQocG9pbnQ6IFBJWEkuUG9pbnQpOiBwbGFuY2suVmVjMiB7XG4gICAgcmV0dXJuIHBsYW5jay5WZWMyKHRoaXMudG9QaHlzaWNzKHBvaW50LngpLCB0aGlzLnRvUGh5c2ljcyhwb2ludC55KSk7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBQbGFuY2sgVmVjMiAobWV0ZXJzKSB0byBQSVhJIFBvaW50IChwaXhlbHMpXG4gICAqL1xuICB0b1BpeGVsc1BvaW50KHZlYzogcGxhbmNrLlZlYzIpOiBQSVhJLlBvaW50IHtcbiAgICByZXR1cm4gbmV3IFBJWEkuUG9pbnQodGhpcy50b1BpeGVscyh2ZWMueCksIHRoaXMudG9QaXhlbHModmVjLnkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbmFibGUgZGVidWcgcmVuZGVyZXJcbiAgICovXG4gIGVuYWJsZURlYnVnUmVuZGVyZXIoc2NlbmU6IFBJWEkuQ29udGFpbmVyLCBvcHRpb25zOiBQaHlzaWNzRGVidWdPcHRpb25zID0ge30pOiBQaHlzaWNzRGVidWdSZW5kZXJlciB7XG4gICAgLy8gQ2xlYW4gdXAgZXhpc3RpbmcgZGVidWcgcmVuZGVyZXIgaWYgYW55XG4gICAgaWYgKHRoaXMuZGVidWdSZW5kZXJlcikge1xuICAgICAgdGhpcy5kaXNhYmxlRGVidWdSZW5kZXJlcigpO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBkZWJ1ZyBncmFwaGljc1xuICAgIHRoaXMuZGVidWdHcmFwaGljcyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG5cbiAgICAvLyBDcmVhdGUgZGVidWcgcmVuZGVyZXIgbG9naWNcbiAgICB0aGlzLmRlYnVnUmVuZGVyZXIgPSBuZXcgUGh5c2ljc0RlYnVnUmVuZGVyZXIodGhpcywgb3B0aW9ucyk7XG5cbiAgICAvLyBNYWtlIGl0IGFuIGVudGl0eSBhbmQgYWRkIHRvIHNjZW5lXG4gICAgY29uc3QgZGVidWdFbnRpdHkgPSBhc0VudGl0eSh0aGlzLmRlYnVnR3JhcGhpY3MpO1xuICAgIGRlYnVnRW50aXR5Lm1veGlFbnRpdHkuYWRkTG9naWModGhpcy5kZWJ1Z1JlbmRlcmVyKTtcblxuICAgIC8vIFNldCBoaWdoZXN0IHotaW5kZXggc28gaXQgcmVuZGVycyBvbiB0b3Agb2YgZXZlcnl0aGluZ1xuICAgIGRlYnVnRW50aXR5LnpJbmRleCA9IDEwMDAwO1xuXG4gICAgLy8gRW5hYmxlIHNvcnRhYmxlIGNoaWxkcmVuIG9uIHNjZW5lIHNvIHpJbmRleCB3b3Jrc1xuICAgIHNjZW5lLnNvcnRhYmxlQ2hpbGRyZW4gPSB0cnVlO1xuXG4gICAgLy8gQWRkIHRvIHNjZW5lIGF0IGhpZ2hlc3Qgei1pbmRleCBzbyBpdCByZW5kZXJzIG9uIHRvcFxuICAgIHNjZW5lLmFkZENoaWxkKGRlYnVnRW50aXR5KTtcblxuICAgIGNvbnNvbGUubG9nKCdQaHlzaWNzIGRlYnVnIHJlbmRlcmVyIGVuYWJsZWQuIFByZXNzIFwiUFwiIHRvIHRvZ2dsZSB2aXNpYmlsaXR5LicpO1xuXG4gICAgcmV0dXJuIHRoaXMuZGVidWdSZW5kZXJlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBEaXNhYmxlIGRlYnVnIHJlbmRlcmVyXG4gICAqL1xuICBkaXNhYmxlRGVidWdSZW5kZXJlcigpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5kZWJ1Z1JlbmRlcmVyICYmIHRoaXMuZGVidWdHcmFwaGljcykge1xuICAgICAgLy8gUmVtb3ZlIGZyb20gc2NlbmVcbiAgICAgIGlmICh0aGlzLmRlYnVnR3JhcGhpY3MucGFyZW50KSB7XG4gICAgICAgIHRoaXMuZGVidWdHcmFwaGljcy5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcy5kZWJ1Z0dyYXBoaWNzKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2xlYW4gdXBcbiAgICAgIHRoaXMuZGVidWdHcmFwaGljcy5kZXN0cm95KCk7XG4gICAgICB0aGlzLmRlYnVnR3JhcGhpY3MgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmRlYnVnUmVuZGVyZXIgPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBkZWJ1ZyByZW5kZXJlciBpZiBlbmFibGVkXG4gICAqL1xuICBnZXREZWJ1Z1JlbmRlcmVyKCk6IFBoeXNpY3NEZWJ1Z1JlbmRlcmVyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5kZWJ1Z1JlbmRlcmVyO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgYm9kaWVzIGluIHRoZSB3b3JsZFxuICAgKi9cbiAgZ2V0Qm9kaWVzKCk6IHBsYW5jay5Cb2R5W10ge1xuICAgIGNvbnN0IGJvZGllczogcGxhbmNrLkJvZHlbXSA9IFtdO1xuICAgIGZvciAobGV0IGJvZHkgPSB0aGlzLndvcmxkLmdldEJvZHlMaXN0KCk7IGJvZHk7IGJvZHkgPSBib2R5LmdldE5leHQoKSkge1xuICAgICAgYm9kaWVzLnB1c2goYm9keSk7XG4gICAgfVxuICAgIHJldHVybiBib2RpZXM7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW4gdXAgYW5kIGRlc3Ryb3kgdGhlIHBoeXNpY3Mgd29ybGRcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgLy8gRGVzdHJveSBhbGwgYm9kaWVzXG4gICAgY29uc3QgYm9kaWVzID0gdGhpcy5nZXRCb2RpZXMoKTtcbiAgICBib2RpZXMuZm9yRWFjaChib2R5ID0+IHRoaXMud29ybGQuZGVzdHJveUJvZHkoYm9keSkpO1xuXG4gICAgdGhpcy5ib2RpZXMuY2xlYXIoKTtcbiAgICB0aGlzLmRlYnVnUmVuZGVyZXIgPSB1bmRlZmluZWQ7XG4gIH1cbn1cbiIsIi8qKlxuICogT3B0aW9ucyBmb3IgY29uZmlndXJpbmcgdGhlIHJlc2l6ZSBoYW5kbGVyXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUmVzaXplSGFuZGxlck9wdGlvbnMge1xuICAvKiogUm9vdCBlbGVtZW50IGNvbnRhaW5pbmcgdGhlIGNhbnZhcyAqL1xuICByb290RWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gIC8qKiBUaGUgZGVzaXJlZCB3aWR0aCBvZiB0aGUgZ2FtZSB2aWV3cG9ydCAqL1xuICB3aWR0aDogbnVtYmVyO1xuICAvKiogVGhlIGRlc2lyZWQgaGVpZ2h0IG9mIHRoZSBnYW1lIHZpZXdwb3J0ICovXG4gIGhlaWdodDogbnVtYmVyO1xuICAvKiogT3B0aW9uYWwgQ1NTIHByb3BlcnRpZXMgdG8gYXBwbHkgdG8gdGhlIHJvb3QgZWxlbWVudCAqL1xuICByb290U3R5bGVzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgLyoqIE9wdGlvbmFsIENTUyBwcm9wZXJ0aWVzIHRvIGFwcGx5IHRvIHRoZSBjYW52YXMgZWxlbWVudCAqL1xuICBjYW52YXNTdHlsZXM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICAvKiogV2hldGhlciB0byB1c2UgcGl4ZWwgYXJ0IG9wdGltaXplZCByZW5kZXJpbmcgKi9cbiAgcGl4ZWxBcnRNb2RlPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBEZWZhdWx0IHN0eWxlcyBhcHBsaWVkIHRvIHRoZSByb290IGVsZW1lbnRcbiAqL1xuY29uc3QgREVGQVVMVF9ST09UX1NUWUxFUzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgZGlzcGxheTogJ2ZsZXgnLFxuICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICBvdmVyZmxvdzogJ2hpZGRlbidcbn07XG5cbi8qKlxuICogRGVmYXVsdCBzdHlsZXMgYXBwbGllZCB0byB0aGUgY2FudmFzIGVsZW1lbnQgaW4gcGl4ZWwgYXJ0IG1vZGVcbiAqL1xuY29uc3QgUElYRUxfQVJUX0NBTlZBU19TVFlMRVM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gIGltYWdlUmVuZGVyaW5nOiAncGl4ZWxhdGVkJ1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgcmVzaXplIGhhbmRsZXIgZnVuY3Rpb24gdGhhdCBtYWludGFpbnMgdGhlIGFzcGVjdCByYXRpbyBvZiBhIGNhbnZhc1xuICogYW5kIGNlbnRlcnMgaXQgd2l0aGluIGl0cyBwYXJlbnQgZWxlbWVudC5cbiAqIFxuICogQHBhcmFtIG9wdGlvbnMgLSBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSByZXNpemUgaGFuZGxlclxuICogQHJldHVybnMgQSBmdW5jdGlvbiB0aGF0IGNhbiBiZSBjYWxsZWQgdG8gaGFuZGxlIHJlc2l6ZSBldmVudHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJlc2l6ZUhhbmRsZXIob3B0aW9uczogUmVzaXplSGFuZGxlck9wdGlvbnMpOiAoKSA9PiB2b2lkIHtcbiAgY29uc3Qge1xuICAgIHJvb3RFbGVtZW50LFxuICAgIHdpZHRoLFxuICAgIGhlaWdodCxcbiAgICByb290U3R5bGVzID0gREVGQVVMVF9ST09UX1NUWUxFUyxcbiAgICBjYW52YXNTdHlsZXMgPSB7fSxcbiAgICBwaXhlbEFydE1vZGUgPSBmYWxzZVxuICB9ID0gb3B0aW9ucztcblxuICAvLyBBcHBseSByb290IGVsZW1lbnQgc3R5bGVzXG4gIE9iamVjdC5lbnRyaWVzKHJvb3RTdHlsZXMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgIHJvb3RFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KGtleSwgdmFsdWUpO1xuICB9KTtcblxuICAvLyBDb21iaW5lIGRlZmF1bHQgY2FudmFzIHN0eWxlcyB3aXRoIHVzZXItcHJvdmlkZWQgb25lc1xuICBjb25zdCBmaW5hbENhbnZhc1N0eWxlcyA9IHBpeGVsQXJ0TW9kZVxuICAgID8geyAuLi5QSVhFTF9BUlRfQ0FOVkFTX1NUWUxFUywgLi4uY2FudmFzU3R5bGVzIH1cbiAgICA6IGNhbnZhc1N0eWxlcztcblxuICByZXR1cm4gKCkgPT4ge1xuICAgIC8vIEdldCB0aGUgcGFyZW50IGRpbWVuc2lvbnNcbiAgICBjb25zdCBwYXJlbnRXaWR0aCA9IHJvb3RFbGVtZW50LmNsaWVudFdpZHRoO1xuICAgIGNvbnN0IHBhcmVudEhlaWdodCA9IHJvb3RFbGVtZW50LmNsaWVudEhlaWdodDtcblxuICAgIC8vIE1haW50YWluIGFzcGVjdCByYXRpb1xuICAgIGNvbnN0IHJhdGlvID0gTWF0aC5taW4oXG4gICAgICBwYXJlbnRXaWR0aCAvIHdpZHRoLFxuICAgICAgcGFyZW50SGVpZ2h0IC8gaGVpZ2h0XG4gICAgKTtcblxuICAgIC8vIFVwZGF0ZSB0aGUgY2FudmFzIGVsZW1lbnQgaWYgaXQgZXhpc3RzXG4gICAgaWYgKHJvb3RFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkIGluc3RhbmNlb2YgSFRNTENhbnZhc0VsZW1lbnQpIHtcbiAgICAgIGNvbnN0IGNhbnZhcyA9IHJvb3RFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkO1xuICAgICAgXG4gICAgICAvLyBTZXQgZGltZW5zaW9ucyB3aGlsZSBtYWludGFpbmluZyBhc3BlY3QgcmF0aW9cbiAgICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9IGAke01hdGgucm91bmQod2lkdGggKiByYXRpbyl9cHhgO1xuICAgICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IGAke01hdGgucm91bmQoaGVpZ2h0ICogcmF0aW8pfXB4YDtcbiAgICAgIGNhbnZhcy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIFxuICAgICAgLy8gQXBwbHkgY3VzdG9tIGNhbnZhcyBzdHlsZXNcbiAgICAgIE9iamVjdC5lbnRyaWVzKGZpbmFsQ2FudmFzU3R5bGVzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgY2FudmFzLnN0eWxlLnNldFByb3BlcnR5KGtleSwgdmFsdWUpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIFNldHMgdXAgcmVzcG9uc2l2ZSByZXNpemluZyBmb3IgYSBQSVhJIGNhbnZhcyBhcHBsaWNhdGlvblxuICogXG4gKiBAcGFyYW0gb3B0aW9ucyAtIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIHJlc2l6ZSBoYW5kbGVyXG4gKiBAcmV0dXJucyBBIGNsZWFudXAgZnVuY3Rpb24gdG8gcmVtb3ZlIHRoZSBldmVudCBsaXN0ZW5lclxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBSZXNwb25zaXZlQ2FudmFzKG9wdGlvbnM6IFJlc2l6ZUhhbmRsZXJPcHRpb25zKTogKCkgPT4gdm9pZCB7XG4gIGNvbnN0IHJlc2l6ZUhhbmRsZXIgPSBjcmVhdGVSZXNpemVIYW5kbGVyKG9wdGlvbnMpO1xuICBcbiAgLy8gSW5pdGlhbCByZXNpemVcbiAgcmVzaXplSGFuZGxlcigpO1xuICBcbiAgLy8gQWRkIGV2ZW50IGxpc3RlbmVyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVIYW5kbGVyKTtcbiAgXG4gIC8vIFJldHVybiBjbGVhbnVwIGZ1bmN0aW9uXG4gIHJldHVybiAoKSA9PiB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHJlc2l6ZUhhbmRsZXIpO1xuICB9O1xufSAiLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IEFzc2V0TG9hZGVyIH0gZnJvbSAnLi4vY29yZS9hc3NldC1sb2FkZXInO1xuaW1wb3J0IHsgQ2FtZXJhIH0gZnJvbSAnLi4vY29yZS9jYW1lcmEnO1xuaW1wb3J0IHsgRW5naW5lIH0gZnJvbSAnLi4vY29yZS9lbmdpbmUnO1xuaW1wb3J0IHsgUmVuZGVyTWFuYWdlciB9IGZyb20gJy4uL2NvcmUvcmVuZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgU2NlbmUgfSBmcm9tICcuLi9jb3JlL3NjZW5lJztcbmltcG9ydCB7IFBoeXNpY3NXb3JsZCwgdHlwZSBQaHlzaWNzV29ybGRPcHRpb25zIH0gZnJvbSAnLi9waHlzaWNzJztcbmltcG9ydCB7IExvYWRpbmdTY2VuZSwgdHlwZSBMb2FkaW5nU2NlbmVPcHRpb25zIH0gZnJvbSAnLi9sb2FkaW5nLXNjZW5lJztcblxuZXhwb3J0IGludGVyZmFjZSBQaXhlbFBlcmZlY3RPcHRpb25zIHtcbiAgLyoqIEVuYWJsZSBhbGwgcGl4ZWwtcGVyZmVjdCBzZXR0aW5ncyAocmVzb2x1dGlvbjogMSwgYW50aWFsaWFzOiBmYWxzZSwgcm91bmRQaXhlbHM6IHRydWUsIGNhbnZhcyBpbWFnZVJlbmRlcmluZykgKi9cbiAgZW5hYmxlZD86IGJvb2xlYW47XG4gIC8qKiBBcHBseSBjYW52YXMgQ1NTIGltYWdlUmVuZGVyaW5nIGZvciBuZWFyZXN0LW5laWdoYm9yIHNjYWxpbmcgKi9cbiAgaW1hZ2VSZW5kZXJpbmc/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNldHVwTW94aUFyZ3Mge1xuICBob3N0RWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gIHJlbmRlck9wdGlvbnM/OiBQYXJ0aWFsPFBJWEkuQXV0b0RldGVjdE9wdGlvbnM+O1xuICBwaHlzaWNzPzogUGh5c2ljc1dvcmxkT3B0aW9ucyB8IGJvb2xlYW47XG4gIHNob3dMb2FkaW5nU2NlbmU/OiBib29sZWFuO1xuICBsb2FkaW5nU2NlbmVPcHRpb25zPzogTG9hZGluZ1NjZW5lT3B0aW9ucztcbiAgLyoqIFBpeGVsLXBlcmZlY3QgcmVuZGVyaW5nIG9wdGlvbnMuIENhbiBiZSB0cnVlIGZvciBhbGwgZGVmYXVsdHMsIG9yIGFuIG9iamVjdCBmb3IgZmluZSBjb250cm9sICovXG4gIHBpeGVsUGVyZmVjdD86IGJvb2xlYW4gfCBQaXhlbFBlcmZlY3RPcHRpb25zO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNldHVwTW94aVJlc3VsdCB7XG4gIHNjZW5lOiBTY2VuZTtcbiAgZW5naW5lOiBFbmdpbmU7XG4gIFBJWElBc3NldHM6IEFzc2V0TG9hZGVyWydQSVhJQXNzZXRzJ107XG4gIHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyO1xuICBsb2FkQXNzZXRzOiBBc3NldExvYWRlclsnbG9hZEFzc2V0cyddO1xuICBjYW1lcmE6IENhbWVyYTtcbiAgcGh5c2ljc1dvcmxkPzogUGh5c2ljc1dvcmxkO1xuICBsb2FkaW5nU2NlbmU/OiBMb2FkaW5nU2NlbmU7XG59XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0UmVuZGVyT3B0aW9ucyA9IHtcbiAgd2lkdGg6IDEyODAsXG4gIGhlaWdodDogNzIwLFxuICBiYWNrZ3JvdW5kQ29sb3I6IDB4MTA5OWJiLFxuICByZXNvbHV0aW9uOiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxLFxuICBhdXRvRGVuc2l0eTogdHJ1ZSxcbiAgYW50aWFsaWFzOiB0cnVlXG59IGFzIFBhcnRpYWw8UElYSS5BdXRvRGV0ZWN0T3B0aW9ucz47XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXR1cE1veGkoe1xuICBob3N0RWxlbWVudCxcbiAgcmVuZGVyT3B0aW9ucyA9IGRlZmF1bHRSZW5kZXJPcHRpb25zLFxuICBwaHlzaWNzLFxuICBzaG93TG9hZGluZ1NjZW5lID0gZmFsc2UsXG4gIGxvYWRpbmdTY2VuZU9wdGlvbnMgPSB7fSxcbiAgcGl4ZWxQZXJmZWN0XG59ID0ge30gYXMgU2V0dXBNb3hpQXJncykge1xuICAvLyBQcm9jZXNzIHBpeGVsLXBlcmZlY3Qgb3B0aW9uc1xuICBsZXQgZmluYWxSZW5kZXJPcHRpb25zID0geyAuLi5yZW5kZXJPcHRpb25zIH07XG4gIGxldCBhcHBseUltYWdlUmVuZGVyaW5nID0gZmFsc2U7XG5cbiAgaWYgKHBpeGVsUGVyZmVjdCkge1xuICAgIGNvbnN0IHBwT3B0aW9ucyA9IHR5cGVvZiBwaXhlbFBlcmZlY3QgPT09ICdib29sZWFuJ1xuICAgICAgPyB7IGVuYWJsZWQ6IHRydWUsIGltYWdlUmVuZGVyaW5nOiB0cnVlIH1cbiAgICAgIDogcGl4ZWxQZXJmZWN0O1xuXG4gICAgaWYgKHBwT3B0aW9ucy5lbmFibGVkICE9PSBmYWxzZSkge1xuICAgICAgLy8gQXBwbHkgcGl4ZWwtcGVyZmVjdCByZW5kZXIgc2V0dGluZ3NcbiAgICAgIGZpbmFsUmVuZGVyT3B0aW9ucyA9IHtcbiAgICAgICAgLi4uZmluYWxSZW5kZXJPcHRpb25zLFxuICAgICAgICByZXNvbHV0aW9uOiAxLFxuICAgICAgICBhbnRpYWxpYXM6IGZhbHNlLFxuICAgICAgICByb3VuZFBpeGVsczogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBhcHBseUltYWdlUmVuZGVyaW5nID0gcHBPcHRpb25zLmltYWdlUmVuZGVyaW5nICE9PSBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IHsgcmVuZGVyZXIgfSA9IGF3YWl0IFJlbmRlck1hbmFnZXIuY3JlYXRlKGhvc3RFbGVtZW50LCBmaW5hbFJlbmRlck9wdGlvbnMpO1xuXG4gIC8vIEFwcGx5IGNhbnZhcyBDU1MgZm9yIHBpeGVsLXBlcmZlY3Qgc2NhbGluZyBpZiByZXF1ZXN0ZWRcbiAgaWYgKGFwcGx5SW1hZ2VSZW5kZXJpbmcpIHtcbiAgICBjb25zdCBjYW52YXMgPSByZW5kZXJlci5jYW52YXMgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XG4gICAgY2FudmFzLnN0eWxlLmltYWdlUmVuZGVyaW5nID0gJ3BpeGVsYXRlZCc7XG4gICAgY2FudmFzLnN0eWxlLmltYWdlUmVuZGVyaW5nID0gJy1tb3otY3Jpc3AtZWRnZXMnO1xuICAgIGNhbnZhcy5zdHlsZS5pbWFnZVJlbmRlcmluZyA9ICdjcmlzcC1lZGdlcyc7XG4gIH1cblxuICBjb25zdCBzY2VuZSA9IG5ldyBTY2VuZShyZW5kZXJlcik7XG4gIGNvbnN0IGVuZ2luZSA9IG5ldyBFbmdpbmUoc2NlbmUpO1xuXG4gIC8vIEdldCB0aGUgQXNzZXRMb2FkZXIgaW5zdGFuY2VcbiAgY29uc3QgYXNzZXRMb2FkZXIgPSBuZXcgQXNzZXRMb2FkZXIoKTtcbiAgY29uc3QgeyBQSVhJQXNzZXRzLCBsb2FkQXNzZXRzIH0gPSBhc3NldExvYWRlcjtcblxuICBjb25zdCBjYW1lcmEgPSBuZXcgQ2FtZXJhKHNjZW5lLCByZW5kZXJlcik7XG5cbiAgLy8gU2V0dXAgcGh5c2ljcyBpZiByZXF1ZXN0ZWRcbiAgbGV0IHBoeXNpY3NXb3JsZDogUGh5c2ljc1dvcmxkIHwgdW5kZWZpbmVkO1xuXG4gIGlmIChwaHlzaWNzKSB7XG4gICAgY29uc3QgcGh5c2ljc09wdGlvbnMgPSB0eXBlb2YgcGh5c2ljcyA9PT0gJ2Jvb2xlYW4nXG4gICAgICA/IHt9XG4gICAgICA6IHBoeXNpY3M7XG5cbiAgICBwaHlzaWNzV29ybGQgPSBuZXcgUGh5c2ljc1dvcmxkKHBoeXNpY3NPcHRpb25zKTtcbiAgICBlbmdpbmUuYWRkUGh5c2ljc1dvcmxkKHBoeXNpY3NXb3JsZCk7XG4gIH1cblxuICAvLyBTZXR1cCBsb2FkaW5nIHNjZW5lIGlmIHJlcXVlc3RlZFxuICBsZXQgbG9hZGluZ1NjZW5lOiBMb2FkaW5nU2NlbmUgfCB1bmRlZmluZWQ7XG4gIGlmIChzaG93TG9hZGluZ1NjZW5lKSB7XG4gICAgbG9hZGluZ1NjZW5lID0gbmV3IExvYWRpbmdTY2VuZShsb2FkaW5nU2NlbmVPcHRpb25zKTtcbiAgICBsb2FkaW5nU2NlbmUuekluZGV4ID0gMTAwMDA7IC8vIEVuc3VyZSBpdCdzIG9uIHRvcFxuICAgIGxvYWRpbmdTY2VuZS5pbml0KHJlbmRlcmVyKTtcbiAgICBzY2VuZS5hZGRDaGlsZChsb2FkaW5nU2NlbmUpO1xuICAgIGxvYWRpbmdTY2VuZS5oaWRlKCk7XG5cbiAgICAvLyBIb29rIGludG8gYXNzZXQgbG9hZGluZyBldmVudHNcbiAgICBhc3NldExvYWRlci5vbignbG9hZGluZzpzdGFydCcsICgpID0+IHtcbiAgICAgIGlmIChsb2FkaW5nU2NlbmUpIHtcbiAgICAgICAgbG9hZGluZ1NjZW5lLnNob3coKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGFzc2V0TG9hZGVyLm9uKCdsb2FkaW5nOmVuZCcsICgpID0+IHtcbiAgICAgIGlmIChsb2FkaW5nU2NlbmUpIHtcbiAgICAgICAgbG9hZGluZ1NjZW5lLmhpZGUoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgc2NlbmUsXG4gICAgZW5naW5lLFxuICAgIFBJWElBc3NldHMsXG4gICAgcmVuZGVyZXIsXG4gICAgbG9hZEFzc2V0cyxcbiAgICBjYW1lcmEsXG4gICAgcGh5c2ljc1dvcmxkLFxuICAgIGxvYWRpbmdTY2VuZVxuICB9O1xufVxuXG4iLCJpbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4uL2NvcmUvbG9naWMnO1xuaW1wb3J0IHsgQ29udGFpbmVyLCBSZW5kZXJlciB9IGZyb20gJ3BpeGkuanMnO1xuXG5leHBvcnQgY2xhc3MgU3RhdGVMb2dpYyBleHRlbmRzIExvZ2ljPENvbnRhaW5lcj4ge1xuICBwcml2YXRlIF9lbnRpdHk6IENvbnRhaW5lcjtcblxuICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gIH1cblxuICBnZXQgZW50aXR5KCkge1xuICAgIHJldHVybiB0aGlzLl9lbnRpdHk7XG4gIH1cblxuICBpbml0KGVudGl0eTogQ29udGFpbmVyLCByZW5kZXJlcjogUmVuZGVyZXIpIHtcbiAgICB0aGlzLl9lbnRpdHkgPSBlbnRpdHk7XG4gICAgc3VwZXIuaW5pdChlbnRpdHksIHJlbmRlcmVyKTtcbiAgfVxuXG4gIG9uRW50ZXIoc3RhdGU6IHN0cmluZykge1xuICB9XG5cbiAgb25FeGl0KHN0YXRlOiBzdHJpbmcpIHtcbiAgfVxuXG4gIHVwZGF0ZShlbnRpdHk6IENvbnRhaW5lciwgZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgfVxuICBcbn1cblxuIiwiaW1wb3J0IHsgU3RhdGVMb2dpYyB9IGZyb20gJy4vc3RhdGUtbG9naWMnO1xuXG4vLyBEZWZpbmUgdGhlIGN1c3RvbSBldmVudCB0eXBlIGZvciBzdGF0ZSBjaGFuZ2VzXG5leHBvcnQgdHlwZSBTdGF0ZUNoYW5nZUV2ZW50ID0ge1xuICBwcmV2U3RhdGU6IHN0cmluZyB8IG51bGw7XG4gIG5ld1N0YXRlOiBzdHJpbmc7XG59O1xuXG50eXBlIFN0YXRlQ2hhbmdlRXZlbnRMaXN0ZW5lciA9IChldmVudDogU3RhdGVDaGFuZ2VFdmVudCkgPT4gdm9pZDtcbnR5cGUgU3RhdGVMb2dpY1JlY29yZHMgPSBSZWNvcmQ8c3RyaW5nLCBTdGF0ZUxvZ2ljPjtcblxuZXhwb3J0IGNsYXNzIFN0YXRlTWFjaGluZSBleHRlbmRzIEV2ZW50VGFyZ2V0IHtcbiAgcHJpdmF0ZSBfc3RhdGVzOiBTdGF0ZUxvZ2ljUmVjb3JkcyA9IHt9O1xuICBwcml2YXRlIF9jdXJyZW50U3RhdGU6IFN0YXRlTG9naWMgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBfY3VycmVudFN0YXRlTmFtZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3Ioc3RhdGVzOiBTdGF0ZUxvZ2ljUmVjb3JkcyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9zdGF0ZXMgPSBzdGF0ZXM7XG4gIH1cblxuICB1cGRhdGUoZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgICBpZiAodGhpcy5fY3VycmVudFN0YXRlKSB7XG4gICAgICB0aGlzLl9jdXJyZW50U3RhdGUudXBkYXRlKHRoaXMuX2N1cnJlbnRTdGF0ZS5lbnRpdHksIGRlbHRhVGltZSk7XG4gICAgfVxuICB9XG4gIFxuICBzZXRTdGF0ZShzdGF0ZU5hbWU6IHN0cmluZykge1xuICAgIGNvbnN0IG5leHRTdGF0ZSA9IHRoaXMuX3N0YXRlc1tzdGF0ZU5hbWVdO1xuICAgIGlmKCFuZXh0U3RhdGUpIHJldHVybjtcblxuICAgIGNvbnN0IHByZXZTdGF0ZU5hbWUgPSB0aGlzLl9jdXJyZW50U3RhdGVOYW1lO1xuICAgIFxuICAgIGlmICh0aGlzLl9jdXJyZW50U3RhdGUpIHtcbiAgICAgIHRoaXMuX2N1cnJlbnRTdGF0ZS5vbkV4aXQoc3RhdGVOYW1lKTtcbiAgICB9XG5cbiAgICB0aGlzLl9jdXJyZW50U3RhdGUgPSB0aGlzLl9zdGF0ZXNbc3RhdGVOYW1lXTtcbiAgICB0aGlzLl9jdXJyZW50U3RhdGVOYW1lID0gc3RhdGVOYW1lO1xuICAgIHRoaXMuX2N1cnJlbnRTdGF0ZS5vbkVudGVyKHN0YXRlTmFtZSk7XG4gICAgXG4gICAgLy8gRGlzcGF0Y2ggdGhlIHN0YXRlIGNoYW5nZSBldmVudFxuICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50PFN0YXRlQ2hhbmdlRXZlbnQ+KCdzdGF0ZUNoYW5nZScsIHtcbiAgICAgIGRldGFpbDoge1xuICAgICAgICBwcmV2U3RhdGU6IHByZXZTdGF0ZU5hbWUsXG4gICAgICAgIG5ld1N0YXRlOiBzdGF0ZU5hbWVcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICB9XG5cbiAgYWRkU3RhdGUoc3RhdGU6IFN0YXRlTG9naWMpIHtcbiAgICB0aGlzLl9zdGF0ZXNbc3RhdGUubmFtZV0gPSBzdGF0ZTtcbiAgfVxuICBcbiAgZ2V0IGN1cnJlbnRTdGF0ZSgpOiBzdHJpbmcgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5fY3VycmVudFN0YXRlTmFtZTtcbiAgfVxufVxuXG4iLCIvKipcbiAqIFV0aWxpdHkgdG8gY29udmVydCBTVkcgdG8gUElYSSB0ZXh0dXJlXG4gKi9cbmltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU1ZHVG9UZXh0dXJlT3B0aW9ucyB7XG4gIHN2Z1N0cmluZzogc3RyaW5nO1xuICB3aWR0aDogbnVtYmVyOyAgLy8gRGVzaXJlZCB3aWR0aCBpbiBhY3R1YWwgcGl4ZWxzXG4gIGhlaWdodDogbnVtYmVyOyAvLyBEZXNpcmVkIGhlaWdodCBpbiBhY3R1YWwgcGl4ZWxzXG4gIGNvbG9yPzogbnVtYmVyOyAvLyBDb2xvciB0byByZXBsYWNlIFwiY3VycmVudENvbG9yXCIgd2l0aFxufVxuXG4vKipcbiAqIENvbnZlcnRzIGFuIFNWRyBzdHJpbmcgdG8gYSBQSVhJIHRleHR1cmVcbiAqIEFjY291bnRzIGZvciBwcm9wZXIgc2NhbGluZyBhbmQgcmVuZGVycyBhdCB0aGUgZXhhY3QgcGl4ZWwgZGltZW5zaW9ucyBuZWVkZWRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN2Z1RvVGV4dHVyZShvcHRpb25zOiBTVkdUb1RleHR1cmVPcHRpb25zKTogUHJvbWlzZTxQSVhJLlRleHR1cmU+IHtcbiAgY29uc3QgeyBzdmdTdHJpbmcsIHdpZHRoLCBoZWlnaHQsIGNvbG9yID0gMHgwMDAwMDAgfSA9IG9wdGlvbnM7XG5cbiAgLy8gUmVwbGFjZSBjdXJyZW50Q29sb3Igd2l0aCBhY3R1YWwgY29sb3JcbiAgY29uc3QgY29sb3JIZXggPSAnIycgKyBjb2xvci50b1N0cmluZygxNikucGFkU3RhcnQoNiwgJzAnKTtcbiAgY29uc3QgcHJvY2Vzc2VkU1ZHID0gc3ZnU3RyaW5nLnJlcGxhY2UoL2N1cnJlbnRDb2xvci9nLCBjb2xvckhleCk7XG5cbiAgLy8gQ3JlYXRlIGEgYmxvYiBmcm9tIHRoZSBTVkcgc3RyaW5nXG4gIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbcHJvY2Vzc2VkU1ZHXSwgeyB0eXBlOiAnaW1hZ2Uvc3ZnK3htbCcgfSk7XG4gIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG5cbiAgLy8gTG9hZCBhcyBpbWFnZVxuICBjb25zdCBpbWcgPSBuZXcgSW1hZ2UoKTtcbiAgaW1nLndpZHRoID0gd2lkdGg7XG4gIGltZy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgYXdhaXQgbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGltZy5vbmxvYWQgPSAoKSA9PiByZXNvbHZlKCk7XG4gICAgaW1nLm9uZXJyb3IgPSByZWplY3Q7XG4gICAgaW1nLnNyYyA9IHVybDtcbiAgfSk7XG5cbiAgLy8gQ3JlYXRlIGNhbnZhcyBhbmQgZHJhdyB0aGUgaW1hZ2UgYXQgdGhlIGV4YWN0IHNpemVcbiAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gIGNhbnZhcy53aWR0aCA9IHdpZHRoO1xuICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICBpZiAoIWN0eCkge1xuICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgY2FudmFzIGNvbnRleHQnKTtcbiAgfVxuXG4gIC8vIERyYXcgdGhlIGltYWdlXG4gIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAvLyBDbGVhbiB1cFxuICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG5cbiAgLy8gQ3JlYXRlIHRleHR1cmUgZnJvbSBjYW52YXNcbiAgY29uc3QgdGV4dHVyZSA9IFBJWEkuVGV4dHVyZS5mcm9tKGNhbnZhcyk7XG4gIHRleHR1cmUuc291cmNlLnNjYWxlTW9kZSA9ICdsaW5lYXInOyAvLyBTbW9vdGggc2NhbGluZyBmb3IgU1ZHXG5cbiAgcmV0dXJuIHRleHR1cmU7XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcblxuLyoqXG4gKiBTZXF1ZW5jZSBpbmZvcm1hdGlvbiBmb3IgYW4gYW5pbWF0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU2VxdWVuY2VJbmZvIHtcbiAgLyoqIEFycmF5IG9mIGZyYW1lIGluZGljZXMgZnJvbSB0aGUgdGV4dHVyZSBhdGxhcyAqL1xuICBmcmFtZXM6IG51bWJlcltdO1xuICAvKiogU3BlZWQgb2YgYW5pbWF0aW9uIChmcmFtZXMgcGVyIG1zKSAqL1xuICBhbmltYXRpb25TcGVlZDogbnVtYmVyO1xufVxuXG4vKipcbiAqIE1hbmFnZXMgZnJhbWUgc2VxdWVuY2VzIGZvciBhbmltYXRlZCBzcHJpdGVzXG4gKiBQcm92aWRlcyB1dGlsaXR5IGZ1bmN0aW9ucyBmb3Igd29ya2luZyB3aXRoIHNwcml0ZSBzaGVldCBhbmltYXRpb25zXG4gKi9cbmV4cG9ydCBjbGFzcyBUZXh0dXJlRnJhbWVTZXF1ZW5jZXMge1xuICBwcml2YXRlIGZyYW1lczogUElYSS5UZXh0dXJlW10gPSBbXTtcbiAgcHJpdmF0ZSBzZXF1ZW5jZXM6IFJlY29yZDxzdHJpbmcsIFNlcXVlbmNlSW5mbz4gPSB7fTtcblxuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IFRleHR1cmVGcmFtZVNlcXVlbmNlc1xuICAgKiBAcGFyYW0gZnJhbWVzIC0gQXJyYXkgb2YgdGV4dHVyZXMgZnJvbSBhIHNwcml0ZXNoZWV0XG4gICAqIEBwYXJhbSBzZXF1ZW5jZXMgLSBOYW1lZCBzZXF1ZW5jZXMgd2l0aCBmcmFtZSBpbmRpY2VzIGFuZCBhbmltYXRpb24gc3BlZWRcbiAgICovXG4gIGNvbnN0cnVjdG9yKGZyYW1lczogUElYSS5UZXh0dXJlW10sIHNlcXVlbmNlczogUmVjb3JkPHN0cmluZywgU2VxdWVuY2VJbmZvPiA9IHt9KSB7XG4gICAgdGhpcy5mcmFtZXMgPSBmcmFtZXM7XG4gICAgdGhpcy5zZXF1ZW5jZXMgPSBzZXF1ZW5jZXM7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgbmV3IGFuaW1hdGlvbiBzZXF1ZW5jZVxuICAgKiBAcGFyYW0gbmFtZSAtIFVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgc2VxdWVuY2VcbiAgICogQHBhcmFtIGZyYW1lSW5kaWNlcyAtIEFycmF5IG9mIGZyYW1lIGluZGljZXMgZnJvbSB0aGUgdGV4dHVyZSBhdGxhc1xuICAgKiBAcGFyYW0gYW5pbWF0aW9uU3BlZWQgLSBTcGVlZCBvZiBhbmltYXRpb24gKGZyYW1lcyBwZXIgbXMpXG4gICAqL1xuICBhZGRTZXF1ZW5jZShuYW1lOiBzdHJpbmcsIGZyYW1lSW5kaWNlczogbnVtYmVyW10sIGFuaW1hdGlvblNwZWVkOiBudW1iZXIgPSAxKSB7XG4gICAgdGhpcy5zZXF1ZW5jZXNbbmFtZV0gPSB7XG4gICAgICBmcmFtZXM6IGZyYW1lSW5kaWNlcyxcbiAgICAgIGFuaW1hdGlvblNwZWVkXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYSBzZXF1ZW5jZSBieSBuYW1lXG4gICAqL1xuICBnZXRTZXF1ZW5jZShuYW1lOiBzdHJpbmcpOiBTZXF1ZW5jZUluZm8gfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5zZXF1ZW5jZXNbbmFtZV0gfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYSBzcGVjaWZpYyBmcmFtZSBieSBpbmRleFxuICAgKi9cbiAgZ2V0RnJhbWUoaW5kZXg6IG51bWJlcik6IFBJWEkuVGV4dHVyZSB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLmZyYW1lc1tpbmRleF0gfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYSBzcGVjaWZpYyBmcmFtZSBmcm9tIGEgc2VxdWVuY2UgYnkgaW5kZXhcbiAgICovXG4gIGdldEZyYW1lRnJvbVNlcXVlbmNlKHNlcXVlbmNlTmFtZTogc3RyaW5nLCBmcmFtZUluZGV4OiBudW1iZXIpOiBQSVhJLlRleHR1cmUgfCBudWxsIHtcbiAgICBjb25zdCBzZXF1ZW5jZSA9IHRoaXMuZ2V0U2VxdWVuY2Uoc2VxdWVuY2VOYW1lKTtcbiAgICBpZiAoIXNlcXVlbmNlKSByZXR1cm4gbnVsbDtcbiAgICBcbiAgICAvLyBHZXQgdGhlIGFwcHJvcHJpYXRlIGZyYW1lIGluZGV4IGZyb20gdGhlIHNlcXVlbmNlXG4gICAgY29uc3Qgc2VxdWVuY2VGcmFtZUluZGV4ID0gc2VxdWVuY2UuZnJhbWVzW2ZyYW1lSW5kZXggJSBzZXF1ZW5jZS5mcmFtZXMubGVuZ3RoXTtcbiAgICBcbiAgICAvLyBSZXR1cm4gdGhlIHRleHR1cmVcbiAgICByZXR1cm4gdGhpcy5mcmFtZXNbc2VxdWVuY2VGcmFtZUluZGV4XSB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgZnJhbWVzIGZvciBhIHNlcXVlbmNlXG4gICAqL1xuICBnZXRGcmFtZVNlcXVlbmNlKG5hbWU6IHN0cmluZyk6IFBJWEkuVGV4dHVyZVtdIHtcbiAgICBjb25zdCBzZXF1ZW5jZSA9IHRoaXMuZ2V0U2VxdWVuY2UobmFtZSk7XG4gICAgaWYgKCFzZXF1ZW5jZSkgcmV0dXJuIFtdO1xuICAgIFxuICAgIHJldHVybiBzZXF1ZW5jZS5mcmFtZXMubWFwKGluZGV4ID0+IHRoaXMuZnJhbWVzW2luZGV4XSkuZmlsdGVyKEJvb2xlYW4pO1xuICB9XG59ICIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuXG5cbi8qKlxuICogT3B0aW9ucyBmb3IgY3JlYXRpbmcgdGV4dHVyZSBmcmFtZXMgZnJvbSBhIHNwcml0ZXNoZWV0XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQXNUZXh0dXJlRnJhbWVzT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBXaWR0aCBvZiBlYWNoIGZyYW1lIGluIHBpeGVsc1xuICAgKi9cbiAgZnJhbWVXaWR0aDogbnVtYmVyO1xuICBcbiAgLyoqXG4gICAqIEhlaWdodCBvZiBlYWNoIGZyYW1lIGluIHBpeGVsc1xuICAgKi9cbiAgZnJhbWVIZWlnaHQ6IG51bWJlcjtcbiAgXG4gIC8qKlxuICAgKiBOdW1iZXIgb2YgY29sdW1ucyBpbiB0aGUgc3ByaXRlc2hlZXRcbiAgICovXG4gIGNvbHVtbnM6IG51bWJlcjtcbiAgXG4gIC8qKlxuICAgKiBOdW1iZXIgb2Ygcm93cyBpbiB0aGUgc3ByaXRlc2hlZXRcbiAgICovXG4gIHJvd3M6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBEZWZhdWx0IHRleHR1cmUgZnJhbWUgb3B0aW9uc1xuICovXG5jb25zdCBkZWZhdWx0T3B0aW9uczogQXNUZXh0dXJlRnJhbWVzT3B0aW9ucyA9IHsgXG4gIGZyYW1lV2lkdGg6IDQ4LCBcbiAgZnJhbWVIZWlnaHQ6IDQ4LCBcbiAgY29sdW1uczogNCwgXG4gIHJvd3M6IDQgXG59O1xuXG4vKipcbiAqIFNwbGl0cyBhIHRleHR1cmUgc291cmNlIGludG8gaW5kaXZpZHVhbCB0ZXh0dXJlIGZyYW1lcyBiYXNlZCBvbiBhIGdyaWQgbGF5b3V0XG4gKiBcbiAqIEBwYXJhbSB0ZXh0dXJlU291cmNlIC0gVGhlIHNvdXJjZSB0ZXh0dXJlIHRvIHNwbGl0IGludG8gZnJhbWVzXG4gKiBAcGFyYW0gb3B0aW9ucyAtIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgZnJhbWUgZXh0cmFjdGlvblxuICogQHJldHVybnMgQXJyYXkgb2YgaW5kaXZpZHVhbCB0ZXh0dXJlIGZyYW1lc1xuICovXG5leHBvcnQgZnVuY3Rpb24gYXNUZXh0dXJlRnJhbWVzKFxuICBQSVhJLFxuICB0ZXh0dXJlU291cmNlOiBQSVhJLlRleHR1cmVTb3VyY2UsIFxuICBvcHRpb25zOiBBc1RleHR1cmVGcmFtZXNPcHRpb25zID0gZGVmYXVsdE9wdGlvbnMsXG4pOiBQSVhJLlRleHR1cmU8UElYSS5UZXh0dXJlU291cmNlPGFueT4+W10ge1xuICBjb25zdCB7IGZyYW1lV2lkdGgsIGZyYW1lSGVpZ2h0LCBjb2x1bW5zLCByb3dzIH0gPSBvcHRpb25zO1xuICBjb25zdCBmcmFtZXM6IFBJWEkuVGV4dHVyZTxQSVhJLlRleHR1cmVTb3VyY2U8YW55Pj5bXSA9IFtdO1xuXG4gIC8vIEVuc3VyZSB3ZSdyZSB3b3JraW5nIHdpdGggYSB2YWxpZGF0ZWQgdGV4dHVyZSBzb3VyY2VcbiAgaWYgKCF0ZXh0dXJlU291cmNlKSB7XG4gICAgY29uc29sZS5lcnJvcignSW52YWxpZCB0ZXh0dXJlIHNvdXJjZSBwcm92aWRlZCB0byBhc1RleHR1cmVGcmFtZXMnKTtcbiAgICByZXR1cm4gZnJhbWVzO1xuICB9XG5cbiAgLy8gQ3JlYXRlIHRleHR1cmVzIGZyb20gdGhlIHRleHR1cmUgc291cmNlIC0ga2VlcGluZyBpbXBsZW1lbnRhdGlvbiBpZGVudGljYWwgdG8gd29ya2luZyB2ZXJzaW9uXG4gIGZvciAobGV0IHkgPSAwOyB5IDwgcm93czsgeSsrKSB7XG4gICAgZm9yIChsZXQgeCA9IDA7IHggPCBjb2x1bW5zOyB4KyspIHtcbiAgICAgIGNvbnN0IGZyYW1lID0gbmV3IFBJWEkuUmVjdGFuZ2xlKHggKiBmcmFtZVdpZHRoLCB5ICogZnJhbWVIZWlnaHQsIGZyYW1lV2lkdGgsIGZyYW1lSGVpZ2h0KTtcbiAgICAgIFxuICAgICAgLy8gS2VlcCB0aGUgZXhhY3Qgc2FtZSBpbXBsZW1lbnRhdGlvbiBhcyB0aGUgd29ya2luZyBleGFtcGxlXG4gICAgICBjb25zdCBmcmFtZXRleHR1cmUgPSBuZXcgUElYSS5UZXh0dXJlKHtcbiAgICAgICAgc291cmNlOiB0ZXh0dXJlU291cmNlLFxuICAgICAgICBmcmFtZTogZnJhbWUsXG4gICAgICB9KSBhcyBQSVhJLlRleHR1cmU8UElYSS5UZXh0dXJlU291cmNlPGFueT4+O1xuICAgICAgXG4gICAgICBmcmFtZXMucHVzaChmcmFtZXRleHR1cmUpO1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIGZyYW1lcyBhcyBQSVhJLlRleHR1cmU8UElYSS5UZXh0dXJlU291cmNlPGFueT4+W107XG59XG4iLCJpbXBvcnQgeyBQb2ludCB9IGZyb20gJ3BpeGkuanMnO1xuXG4vKipcbiAqIENvbW1vbmx5IHVzZWQgUG9pbnQgZmFjdG9yeSBmdW5jdGlvbnNcbiAqIFRoZXNlIHJlZHVjZSBvYmplY3QgYWxsb2NhdGlvbnMgYW5kIGNsYXJpZnkgaW50ZW50XG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVQb2ludCA9ICh4ID0gMCwgeSA9IDApOiBQb2ludCA9PiBuZXcgUG9pbnQoeCwgeSk7XG5leHBvcnQgY29uc3QgWkVST19QT0lOVCA9ICgpOiBQb2ludCA9PiBuZXcgUG9pbnQoMCwgMCk7XG5leHBvcnQgY29uc3QgT05FX1BPSU5UID0gKCk6IFBvaW50ID0+IG5ldyBQb2ludCgxLCAxKTtcblxuZXhwb3J0IGNvbnN0IHVjID0gKHMgPSAnJykgPT4gcy50b1VwcGVyQ2FzZSgpO1xuZXhwb3J0IGNvbnN0IGxjID0gKHMgPSAnJykgPT4gcy50b0xvd2VyQ2FzZSgpO1xuXG5leHBvcnQgY29uc3QgcGFkUmlnaHQgPSAodmFsID0gJycsIGxlbmd0aCA9IDAsIHBhZFdpdGggPSAnICcpID0+IHtcbiAgbGV0IHJlc3VsdCA9IHZhbCsnJztcbiAgd2hpbGUocmVzdWx0Lmxlbmd0aCA8IGxlbmd0aCl7XG4gICAgcmVzdWx0ICs9IHBhZFdpdGg7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbmV4cG9ydCBjb25zdCBwciA9IHBhZFJpZ2h0O1xuXG4vKipcbiAqIEdlbmVyYXRlIHJhbmRvbSBpbnRlZ2VyIGJldHdlZW4gbWluIGFuZCBtYXggKGluY2x1c2l2ZSlcbiAqIEBwYXJhbSBtaW4gLSBNaW5pbXVtIHZhbHVlIChpbmNsdXNpdmUpXG4gKiBAcGFyYW0gbWF4IC0gTWF4aW11bSB2YWx1ZSAoaW5jbHVzaXZlKVxuICogQHJldHVybnMgUmFuZG9tIGludGVnZXIgaW4gcmFuZ2UgW21pbiwgbWF4XVxuICovXG5leHBvcnQgY29uc3QgZ2V0UmFuZG9tSW50ID0gKG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciA9PiAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCArIDEgLSBtaW4pKSArIG1pbik7XG5cbmV4cG9ydCBjb25zdCByb3VuZFRvID0gKHBsYWNlcywgdmFsdWUpID0+IChNYXRoLnJvdW5kKHZhbHVlICogTWF0aC5wb3coMTAsIHBsYWNlcykpIC8gTWF0aC5wb3coMTAsIHBsYWNlcykpO1xuXG5leHBvcnQgY29uc3QgbGVycCA9IChiZWdpbiwgZW5kLCBtYWcpID0+ICgoMSAtIG1hZykgKiBiZWdpbiArIG1hZyAqIGVuZCk7XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXRlcnNUb1BpeGVscyhtOiBudW1iZXIpOiBudW1iZXIgeyByZXR1cm4gbSAqIDIwOyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBwaXhlbHNUb01ldGVycyhwOiBudW1iZXIpOiBudW1iZXIgeyByZXR1cm4gcCAqIDAuMDU7IH1cblxuZXhwb3J0IGNvbnN0IGZldGNoWG1sID0gYXN5bmMgKHVybDogc3RyaW5nKSA9PiAoYXdhaXQgKGF3YWl0IGZldGNoKHVybCkpLnRleHQoKSk7XG5cbmV4cG9ydCBjb25zdCByYWQyZGVnID0gKHJhZDogbnVtYmVyKSA9PiByYWQgKiAoMTgwIC8gTWF0aC5QSSk7XG5leHBvcnQgY29uc3QgZGVnMnJhZCA9IChkZWc6IG51bWJlcikgPT4gZGVnICogKE1hdGguUEkgLyAxODApO1xuICAiLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlTY2FsZU1vZGUgfSBmcm9tICcuL1VJU2NhbGVNb2RlJztcblxuZXhwb3J0IGludGVyZmFjZSBVSUxheWVyT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBTY2FsaW5nIG1vZGUgZm9yIHRoaXMgVUkgbGF5ZXJcbiAgICogQGRlZmF1bHQgVUlTY2FsZU1vZGUuTm9uZVxuICAgKi9cbiAgc2NhbGVNb2RlPzogVUlTY2FsZU1vZGU7XG5cbiAgLyoqXG4gICAqIFRhcmdldCB3aWR0aCBmb3IgdGhlIFVJIGxheWVyICh1c2VkIGFzIHJlZmVyZW5jZSBmb3Igc2NhbGluZylcbiAgICogSWYgbm90IHByb3ZpZGVkLCB1c2VzIHRoZSBmaXJzdCBjaGlsZCdzIHdpZHRoXG4gICAqL1xuICB0YXJnZXRXaWR0aD86IG51bWJlcjtcblxuICAvKipcbiAgICogVGFyZ2V0IGhlaWdodCBmb3IgdGhlIFVJIGxheWVyICh1c2VkIGFzIHJlZmVyZW5jZSBmb3Igc2NhbGluZylcbiAgICogSWYgbm90IHByb3ZpZGVkLCB1c2VzIHRoZSBmaXJzdCBjaGlsZCdzIGhlaWdodFxuICAgKi9cbiAgdGFyZ2V0SGVpZ2h0PzogbnVtYmVyO1xufVxuXG4vKipcbiAqIFVJTGF5ZXIgaXMgYSBjb250YWluZXIgdGhhdCBtYW5hZ2VzIHNjYWxpbmcgYmVoYXZpb3IgZm9yIGFsbCBpdHMgY2hpbGRyZW5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgaHVkTGF5ZXIgPSBuZXcgVUlMYXllcih7IHNjYWxlTW9kZTogVUlTY2FsZU1vZGUuU2NhbGVVSSB9KTtcbiAqIHNjZW5lLmFkZENoaWxkKGh1ZExheWVyKTtcbiAqIGh1ZExheWVyLmFkZENoaWxkKHRhYnMuY29udGFpbmVyKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlMYXllciBleHRlbmRzIFBJWEkuQ29udGFpbmVyIHtcbiAgcHJpdmF0ZSBzY2FsZU1vZGU6IFVJU2NhbGVNb2RlO1xuICBwcml2YXRlIHRhcmdldFdpZHRoPzogbnVtYmVyO1xuICBwcml2YXRlIHRhcmdldEhlaWdodD86IG51bWJlcjtcbiAgcHJpdmF0ZSBpbml0aWFsQm91bmRzUmVjb3JkZWQgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBVSUxheWVyT3B0aW9ucyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnNjYWxlTW9kZSA9IG9wdGlvbnMuc2NhbGVNb2RlID8/IFVJU2NhbGVNb2RlLk5vbmU7XG4gICAgdGhpcy50YXJnZXRXaWR0aCA9IG9wdGlvbnMudGFyZ2V0V2lkdGg7XG4gICAgdGhpcy50YXJnZXRIZWlnaHQgPSBvcHRpb25zLnRhcmdldEhlaWdodDtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIGxheWVyJ3Mgc2NhbGUgYmFzZWQgb24gdGhlIGN1cnJlbnQgY2FudmFzIHNpemVcbiAgICovXG4gIHVwZGF0ZVNjYWxlKGNhbnZhc1dpZHRoOiBudW1iZXIsIGNhbnZhc0hlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuc2NhbGVNb2RlID09PSBVSVNjYWxlTW9kZS5Ob25lKSB7XG4gICAgICB0aGlzLnNjYWxlLnNldCgxLCAxKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBSZWNvcmQgaW5pdGlhbCBib3VuZHMgZnJvbSBmaXJzdCBjaGlsZCBpZiBub3QgZXhwbGljaXRseSBzZXRcbiAgICBpZiAoIXRoaXMuaW5pdGlhbEJvdW5kc1JlY29yZGVkICYmIHRoaXMuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKCF0aGlzLnRhcmdldFdpZHRoIHx8ICF0aGlzLnRhcmdldEhlaWdodCkge1xuICAgICAgICBjb25zdCBib3VuZHMgPSB0aGlzLmdldExvY2FsQm91bmRzKCk7XG4gICAgICAgIHRoaXMudGFyZ2V0V2lkdGggPSB0aGlzLnRhcmdldFdpZHRoID8/IGJvdW5kcy53aWR0aDtcbiAgICAgICAgdGhpcy50YXJnZXRIZWlnaHQgPSB0aGlzLnRhcmdldEhlaWdodCA/PyBib3VuZHMuaGVpZ2h0O1xuICAgICAgfVxuICAgICAgdGhpcy5pbml0aWFsQm91bmRzUmVjb3JkZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmICghdGhpcy50YXJnZXRXaWR0aCB8fCAhdGhpcy50YXJnZXRIZWlnaHQpIHtcbiAgICAgIC8vIE5vIGRpbWVuc2lvbnMgdG8gc2NhbGUgZnJvbSB5ZXRcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBzY2FsZVggPSBjYW52YXNXaWR0aCAvIHRoaXMudGFyZ2V0V2lkdGg7XG4gICAgY29uc3Qgc2NhbGVZID0gY2FudmFzSGVpZ2h0IC8gdGhpcy50YXJnZXRIZWlnaHQ7XG5cbiAgICBzd2l0Y2ggKHRoaXMuc2NhbGVNb2RlKSB7XG4gICAgICBjYXNlIFVJU2NhbGVNb2RlLlNjYWxlVUk6XG4gICAgICAgIC8vIFNjYWxlIHRvIGZpbGwsIHN0cmV0Y2hpbmcgaWYgbmVjZXNzYXJ5XG4gICAgICAgIHRoaXMuc2NhbGUuc2V0KHNjYWxlWCwgc2NhbGVZKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgVUlTY2FsZU1vZGUuTG9ja1JhdGlvOlxuICAgICAgICAvLyBTY2FsZSBtYWludGFpbmluZyBhc3BlY3QgcmF0aW9cbiAgICAgICAgY29uc3Qgc2NhbGUgPSBNYXRoLm1pbihzY2FsZVgsIHNjYWxlWSk7XG4gICAgICAgIHRoaXMuc2NhbGUuc2V0KHNjYWxlLCBzY2FsZSk7XG4gICAgICAgIC8vIENlbnRlciB0aGUgY29udGVudFxuICAgICAgICB0aGlzLnBvc2l0aW9uLnNldChcbiAgICAgICAgICAoY2FudmFzV2lkdGggLSB0aGlzLnRhcmdldFdpZHRoICogc2NhbGUpIC8gMixcbiAgICAgICAgICAoY2FudmFzSGVpZ2h0IC0gdGhpcy50YXJnZXRIZWlnaHQgKiBzY2FsZSkgLyAyXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYSBjaGlsZCBhbmQgdHJpZ2dlciBzY2FsZSB1cGRhdGUgaWYgbmVlZGVkXG4gICAqL1xuICBvdmVycmlkZSBhZGRDaGlsZDxUIGV4dGVuZHMgUElYSS5Db250YWluZXJbXT4oLi4uY2hpbGRyZW46IFQpOiBUWzBdIHtcbiAgICBjb25zdCByZXN1bHQgPSBzdXBlci5hZGRDaGlsZCguLi5jaGlsZHJlbik7XG4gICAgdGhpcy5pbml0aWFsQm91bmRzUmVjb3JkZWQgPSBmYWxzZTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG4iLCIvKipcbiAqIFVJIFNjYWxpbmcgbW9kZXMgZm9yIFVJTGF5ZXJcbiAqL1xuZXhwb3J0IGVudW0gVUlTY2FsZU1vZGUge1xuICAvKipcbiAgICogTm8gc2NhbGluZyAtIDE6MSBwaXhlbCBtYXBwaW5nLCBubyBvZmZzZXQgY2FsY3VsYXRpb25zXG4gICAqL1xuICBOb25lID0gJ25vbmUnLFxuXG4gIC8qKlxuICAgKiBTY2FsZSBVSSBwcm9wb3J0aW9uYWxseSB0byBmaWxsIHRoZSBhdmFpbGFibGUgc3BhY2VcbiAgICovXG4gIFNjYWxlVUkgPSAnc2NhbGVVSScsXG5cbiAgLyoqXG4gICAqIFNjYWxlIHdoaWxlIG1haW50YWluaW5nIGFzcGVjdCByYXRpbyAobWF5IGxldHRlcmJveC9waWxsYXJib3gpXG4gICAqL1xuICBMb2NrUmF0aW8gPSAnbG9ja1JhdGlvJ1xufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBCdXR0b25TdGF0ZSB9IGZyb20gJy4vdWktYnV0dG9uJztcbmltcG9ydCB7IFVJUGFuZWwgfSBmcm9tICcuL3VpLXBhbmVsJztcblxuLyoqXG4gKiBTdHJhdGVneSBpbnRlcmZhY2UgZm9yIGJ1dHRvbiBiYWNrZ3JvdW5kIHJlbmRlcmluZ1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIEJ1dHRvbkJhY2tncm91bmRTdHJhdGVneSB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIHRoZSBiYWNrZ3JvdW5kIGNvbnRhaW5lclxuICAgKi9cbiAgY3JlYXRlKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogUElYSS5Db250YWluZXI7XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIHZpc3VhbCBzdGF0ZSBvZiB0aGUgYmFja2dyb3VuZFxuICAgKi9cbiAgdXBkYXRlU3RhdGUoc3RhdGU6IEJ1dHRvblN0YXRlKTogdm9pZDtcblxuICAvKipcbiAgICogR2V0cyB0aGUgYWN0dWFsIHJlbmRlcmVkIGhlaWdodCBvZiB0aGUgYmFja2dyb3VuZFxuICAgKi9cbiAgZ2V0QWN0dWFsSGVpZ2h0KCk6IG51bWJlcjtcblxuICAvKipcbiAgICogQ2xlYW5zIHVwIHJlc291cmNlc1xuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkO1xufVxuXG4vKipcbiAqIFNvbGlkIGNvbG9yIGJhY2tncm91bmQgc3RyYXRlZ3kgdXNpbmcgVUlQYW5lbFxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgY2xhc3MgU29saWRDb2xvckJhY2tncm91bmRTdHJhdGVneSBpbXBsZW1lbnRzIEJ1dHRvbkJhY2tncm91bmRTdHJhdGVneSB7XG4gIHByaXZhdGUgcGFuZWw/OiBVSVBhbmVsO1xuICBwcml2YXRlIG5vcm1hbENvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgaG92ZXJDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIHByZXNzZWRDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIGRpc2FibGVkQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSB3aWR0aDogbnVtYmVyO1xuICBwcml2YXRlIGhlaWdodDogbnVtYmVyO1xuICBwcml2YXRlIGJvcmRlclJhZGl1czogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIGJhY2tncm91bmRDb2xvcjogbnVtYmVyLFxuICAgIHdpZHRoOiBudW1iZXIsXG4gICAgaGVpZ2h0OiBudW1iZXIsXG4gICAgYm9yZGVyUmFkaXVzOiBudW1iZXJcbiAgKSB7XG4gICAgdGhpcy5ub3JtYWxDb2xvciA9IGJhY2tncm91bmRDb2xvcjtcbiAgICB0aGlzLmhvdmVyQ29sb3IgPSB0aGlzLmRhcmtlbkNvbG9yKGJhY2tncm91bmRDb2xvciwgMC45KTtcbiAgICB0aGlzLnByZXNzZWRDb2xvciA9IHRoaXMuZGFya2VuQ29sb3IoYmFja2dyb3VuZENvbG9yLCAwLjgpO1xuICAgIHRoaXMuZGlzYWJsZWRDb2xvciA9IDB4ODg4ODg4O1xuICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICB0aGlzLmJvcmRlclJhZGl1cyA9IGJvcmRlclJhZGl1cztcbiAgfVxuXG4gIGNyZWF0ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IFBJWEkuQ29udGFpbmVyIHtcbiAgICB0aGlzLnBhbmVsID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLm5vcm1hbENvbG9yLFxuICAgICAgd2lkdGgsXG4gICAgICBoZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG5cbiAgICB0aGlzLnBhbmVsLmxheW91dCh3aWR0aCwgaGVpZ2h0KTtcbiAgICByZXR1cm4gdGhpcy5wYW5lbC5jb250YWluZXI7XG4gIH1cblxuICB1cGRhdGVTdGF0ZShzdGF0ZTogQnV0dG9uU3RhdGUpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMucGFuZWwpIHJldHVybjtcblxuICAgIGxldCBjb2xvcjogbnVtYmVyO1xuICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgIGNhc2UgQnV0dG9uU3RhdGUuTm9ybWFsOlxuICAgICAgICBjb2xvciA9IHRoaXMubm9ybWFsQ29sb3I7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBCdXR0b25TdGF0ZS5Ib3ZlcjpcbiAgICAgICAgY29sb3IgPSB0aGlzLmhvdmVyQ29sb3I7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBCdXR0b25TdGF0ZS5QcmVzc2VkOlxuICAgICAgICBjb2xvciA9IHRoaXMucHJlc3NlZENvbG9yO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgQnV0dG9uU3RhdGUuRGlzYWJsZWQ6XG4gICAgICAgIGNvbG9yID0gdGhpcy5kaXNhYmxlZENvbG9yO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICB0aGlzLnBhbmVsLnNldEJhY2tncm91bmRDb2xvcihjb2xvcik7XG4gIH1cblxuICBnZXRBY3R1YWxIZWlnaHQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5oZWlnaHQ7XG4gIH1cblxuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIC8vIFVJUGFuZWwgY2xlYW51cCBoYW5kbGVkIGJ5IGNvbnRhaW5lclxuICB9XG5cbiAgcHJpdmF0ZSBkYXJrZW5Db2xvcihjb2xvcjogbnVtYmVyLCBmYWN0b3I6IG51bWJlcik6IG51bWJlciB7XG4gICAgY29uc3QgciA9ICgoY29sb3IgPj4gMTYpICYgMHhmZikgKiBmYWN0b3I7XG4gICAgY29uc3QgZyA9ICgoY29sb3IgPj4gOCkgJiAweGZmKSAqIGZhY3RvcjtcbiAgICBjb25zdCBiID0gKGNvbG9yICYgMHhmZikgKiBmYWN0b3I7XG4gICAgcmV0dXJuICgociA8PCAxNikgfCAoZyA8PCA4KSB8IGIpID4+PiAwO1xuICB9XG59XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiBmb3IgaWNvbiBvdmVybGF5c1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIEljb25Db25maWcge1xuICAvKiogU3ByaXRlc2hlZXQgY29udGFpbmluZyB0aGUgaWNvbiB0ZXh0dXJlICovXG4gIHNwcml0ZXNoZWV0OiBQSVhJLlNwcml0ZXNoZWV0O1xuICAvKiogVGV4dHVyZSBuYW1lIGluIHRoZSBzcHJpdGVzaGVldCAqL1xuICB0ZXh0dXJlTmFtZTogc3RyaW5nO1xuICAvKiogSWNvbiBzY2FsZSAoZGVmYXVsdDogMS4wKSAqL1xuICBzY2FsZT86IG51bWJlcjtcbiAgLyoqIFVzZSBwaXhlbC1wZXJmZWN0IHJlbmRlcmluZyAqL1xuICBwaXhlbFBlcmZlY3Q/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIENvbmZpZ3VyYXRpb24gZm9yIHNwcml0ZS1iYXNlZCBiYWNrZ3JvdW5kc1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNwcml0ZUJhY2tncm91bmRDb25maWcge1xuICAvKiogU3ByaXRlc2hlZXQgY29udGFpbmluZyB0aGUgYnV0dG9uIHRleHR1cmVzICovXG4gIHNwcml0ZXNoZWV0OiBQSVhJLlNwcml0ZXNoZWV0O1xuICAvKiogVGV4dHVyZSBuYW1lIHBhdHRlcm4gLSB1c2Uge2NvbG9yfSBwbGFjZWhvbGRlci4gRXhhbXBsZTogXCJiYXJIb3Jpem9udGFsX3tjb2xvcn1fbGVmdC5wbmdcIiAqL1xuICB0ZXh0dXJlUGF0dGVybjogc3RyaW5nO1xuICAvKiogQ29sb3IgdmFyaWFudCB0byB1c2UgKGUuZy4sICdibHVlJywgJ2dyZWVuJywgJ3JlZCcpICovXG4gIGNvbG9yOiBzdHJpbmc7XG4gIC8qKiBVc2UgcGl4ZWwtcGVyZmVjdCByZW5kZXJpbmcgKG5lYXJlc3QgbmVpZ2hib3IpICovXG4gIHBpeGVsUGVyZmVjdD86IGJvb2xlYW47XG4gIC8qKiBVc2UgOS1zbGljZSByZW5kZXJpbmcgaW5zdGVhZCBvZiB0aHJlZS1waWVjZSBob3Jpem9udGFsICovXG4gIHVzZU5pbmVTbGljZT86IGJvb2xlYW47XG4gIC8qKiA5LXNsaWNlIGJvcmRlciB3aWR0aHMgKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkgLSByZXF1aXJlZCBpZiB1c2VOaW5lU2xpY2UgaXMgdHJ1ZSAqL1xuICBuaW5lU2xpY2VCb3JkZXJzPzogeyBsZWZ0OiBudW1iZXI7IHRvcDogbnVtYmVyOyByaWdodDogbnVtYmVyOyBib3R0b206IG51bWJlciB9O1xuICAvKiogVGV4dHVyZSBuYW1lIGZvciBwcmVzc2VkL2Rvd24gc3RhdGUgLSB1c2Uge2NvbG9yfSBwbGFjZWhvbGRlciBpZiBuZWVkZWQgKi9cbiAgcHJlc3NlZFRleHR1cmVQYXR0ZXJuPzogc3RyaW5nO1xuICAvKiogSWNvbiBjb25maWd1cmF0aW9uIGZvciBvdmVybGF5ICovXG4gIGljb24/OiBJY29uQ29uZmlnO1xufVxuXG4vKipcbiAqIFNwcml0ZS1iYXNlZCBiYWNrZ3JvdW5kIHN0cmF0ZWd5IHVzaW5nIHRocmVlLXBpZWNlIGhvcml6b250YWwgdGV4dHVyZXMgb3IgOS1zbGljZVxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgY2xhc3MgU3ByaXRlQmFja2dyb3VuZFN0cmF0ZWd5IGltcGxlbWVudHMgQnV0dG9uQmFja2dyb3VuZFN0cmF0ZWd5IHtcbiAgcHJpdmF0ZSBjb250YWluZXI/OiBQSVhJLkNvbnRhaW5lcjtcbiAgcHJpdmF0ZSBzcHJpdGVMZWZ0PzogUElYSS5TcHJpdGU7XG4gIHByaXZhdGUgc3ByaXRlTWlkPzogUElYSS5TcHJpdGU7XG4gIHByaXZhdGUgc3ByaXRlUmlnaHQ/OiBQSVhJLlNwcml0ZTtcbiAgcHJpdmF0ZSBuaW5lU2xpY2VTcHJpdGU/OiBQSVhJLk5pbmVTbGljZVNwcml0ZTtcbiAgcHJpdmF0ZSBuaW5lU2xpY2VTcHJpdGVQcmVzc2VkPzogUElYSS5OaW5lU2xpY2VTcHJpdGU7XG4gIHByaXZhdGUgaWNvblNwcml0ZT86IFBJWEkuU3ByaXRlO1xuICBwcml2YXRlIGNvbmZpZzogU3ByaXRlQmFja2dyb3VuZENvbmZpZztcbiAgcHJpdmF0ZSB3aWR0aDogbnVtYmVyO1xuICBwcml2YXRlIGhlaWdodDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogU3ByaXRlQmFja2dyb3VuZENvbmZpZywgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gIH1cblxuICBjcmVhdGUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiBQSVhJLkNvbnRhaW5lciB7XG4gICAgdGhpcy5jb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICBjb25zdCB7IHNwcml0ZXNoZWV0LCB0ZXh0dXJlUGF0dGVybiwgY29sb3IsIHBpeGVsUGVyZmVjdCwgdXNlTmluZVNsaWNlLCBuaW5lU2xpY2VCb3JkZXJzLCBwcmVzc2VkVGV4dHVyZVBhdHRlcm4sIGljb24gfSA9IHRoaXMuY29uZmlnO1xuXG4gICAgLy8gU2V0IHBpeGVsLXBlcmZlY3QgcmVuZGVyaW5nIGlmIHJlcXVlc3RlZFxuICAgIGlmIChwaXhlbFBlcmZlY3QgJiYgc3ByaXRlc2hlZXQudGV4dHVyZVNvdXJjZSkge1xuICAgICAgc3ByaXRlc2hlZXQudGV4dHVyZVNvdXJjZS5zY2FsZU1vZGUgPSAnbmVhcmVzdCc7XG4gICAgfVxuXG4gICAgaWYgKHVzZU5pbmVTbGljZSAmJiBuaW5lU2xpY2VCb3JkZXJzKSB7XG4gICAgICAvLyBVc2UgOS1zbGljZSBzcHJpdGVcbiAgICAgIGNvbnN0IHRleHR1cmVOYW1lID0gdGV4dHVyZVBhdHRlcm4uaW5jbHVkZXMoJ3tjb2xvcn0nKVxuICAgICAgICA/IHRleHR1cmVQYXR0ZXJuLnJlcGxhY2UoJ3tjb2xvcn0nLCBjb2xvcilcbiAgICAgICAgOiB0ZXh0dXJlUGF0dGVybjtcbiAgICAgIGNvbnN0IHRleHR1cmUgPSBzcHJpdGVzaGVldC50ZXh0dXJlc1t0ZXh0dXJlTmFtZV07XG5cbiAgICAgIHRoaXMubmluZVNsaWNlU3ByaXRlID0gbmV3IFBJWEkuTmluZVNsaWNlU3ByaXRlKHtcbiAgICAgICAgdGV4dHVyZSxcbiAgICAgICAgbGVmdFdpZHRoOiBuaW5lU2xpY2VCb3JkZXJzLmxlZnQsXG4gICAgICAgIHRvcEhlaWdodDogbmluZVNsaWNlQm9yZGVycy50b3AsXG4gICAgICAgIHJpZ2h0V2lkdGg6IG5pbmVTbGljZUJvcmRlcnMucmlnaHQsXG4gICAgICAgIGJvdHRvbUhlaWdodDogbmluZVNsaWNlQm9yZGVycy5ib3R0b20sXG4gICAgICAgIHdpZHRoLFxuICAgICAgICBoZWlnaHRcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLm5pbmVTbGljZVNwcml0ZSk7XG5cbiAgICAgIC8vIENyZWF0ZSBwcmVzc2VkIHN0YXRlIHNwcml0ZSBpZiBwcm92aWRlZFxuICAgICAgaWYgKHByZXNzZWRUZXh0dXJlUGF0dGVybikge1xuICAgICAgICBjb25zdCBwcmVzc2VkVGV4dHVyZU5hbWUgPSBwcmVzc2VkVGV4dHVyZVBhdHRlcm4uaW5jbHVkZXMoJ3tjb2xvcn0nKVxuICAgICAgICAgID8gcHJlc3NlZFRleHR1cmVQYXR0ZXJuLnJlcGxhY2UoJ3tjb2xvcn0nLCBjb2xvcilcbiAgICAgICAgICA6IHByZXNzZWRUZXh0dXJlUGF0dGVybjtcbiAgICAgICAgY29uc3QgcHJlc3NlZFRleHR1cmUgPSBzcHJpdGVzaGVldC50ZXh0dXJlc1twcmVzc2VkVGV4dHVyZU5hbWVdO1xuXG4gICAgICAgIHRoaXMubmluZVNsaWNlU3ByaXRlUHJlc3NlZCA9IG5ldyBQSVhJLk5pbmVTbGljZVNwcml0ZSh7XG4gICAgICAgICAgdGV4dHVyZTogcHJlc3NlZFRleHR1cmUsXG4gICAgICAgICAgbGVmdFdpZHRoOiBuaW5lU2xpY2VCb3JkZXJzLmxlZnQsXG4gICAgICAgICAgdG9wSGVpZ2h0OiBuaW5lU2xpY2VCb3JkZXJzLnRvcCxcbiAgICAgICAgICByaWdodFdpZHRoOiBuaW5lU2xpY2VCb3JkZXJzLnJpZ2h0LFxuICAgICAgICAgIGJvdHRvbUhlaWdodDogbmluZVNsaWNlQm9yZGVycy5ib3R0b20sXG4gICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgaGVpZ2h0XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIE9mZnNldCBwcmVzc2VkIHN0YXRlIGRvd24gYnkgNCBwaXhlbHMgdG8gbWF0Y2ggdGhlIGJldmVsIGhlaWdodFxuICAgICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZVByZXNzZWQueSA9IDQ7XG4gICAgICAgIHRoaXMubmluZVNsaWNlU3ByaXRlUHJlc3NlZC52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMubmluZVNsaWNlU3ByaXRlUHJlc3NlZCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFVzZSB0aHJlZS1waWVjZSBob3Jpem9udGFsIHNwcml0ZXNcbiAgICAgIGNvbnN0IGxlZnRUZXh0dXJlTmFtZSA9IHRoaXMuZ2V0VGV4dHVyZU5hbWUodGV4dHVyZVBhdHRlcm4sIGNvbG9yLCAnbGVmdCcpO1xuICAgICAgY29uc3QgbWlkVGV4dHVyZU5hbWUgPSB0aGlzLmdldFRleHR1cmVOYW1lKHRleHR1cmVQYXR0ZXJuLCBjb2xvciwgJ21pZCcpO1xuICAgICAgY29uc3QgcmlnaHRUZXh0dXJlTmFtZSA9IHRoaXMuZ2V0VGV4dHVyZU5hbWUodGV4dHVyZVBhdHRlcm4sIGNvbG9yLCAncmlnaHQnKTtcblxuICAgICAgdGhpcy5zcHJpdGVMZWZ0ID0gbmV3IFBJWEkuU3ByaXRlKHNwcml0ZXNoZWV0LnRleHR1cmVzW2xlZnRUZXh0dXJlTmFtZV0pO1xuICAgICAgdGhpcy5zcHJpdGVNaWQgPSBuZXcgUElYSS5TcHJpdGUoc3ByaXRlc2hlZXQudGV4dHVyZXNbbWlkVGV4dHVyZU5hbWVdKTtcbiAgICAgIHRoaXMuc3ByaXRlUmlnaHQgPSBuZXcgUElYSS5TcHJpdGUoc3ByaXRlc2hlZXQudGV4dHVyZXNbcmlnaHRUZXh0dXJlTmFtZV0pO1xuXG4gICAgICAvLyBTY2FsZSB0byBtYXRjaCBidXR0b24gaGVpZ2h0XG4gICAgICBjb25zdCBzY2FsZVkgPSBoZWlnaHQgLyB0aGlzLnNwcml0ZUxlZnQuaGVpZ2h0O1xuICAgICAgdGhpcy5zcHJpdGVMZWZ0LnNjYWxlLnkgPSBzY2FsZVk7XG4gICAgICB0aGlzLnNwcml0ZU1pZC5zY2FsZS55ID0gc2NhbGVZO1xuICAgICAgdGhpcy5zcHJpdGVSaWdodC5zY2FsZS55ID0gc2NhbGVZO1xuXG4gICAgICAvLyBQb3NpdGlvbiBzcHJpdGVzIGhvcml6b250YWxseVxuICAgICAgdGhpcy5zcHJpdGVMZWZ0LnggPSAwO1xuXG4gICAgICBjb25zdCBtaWRkbGVXaWR0aCA9IHdpZHRoIC0gdGhpcy5zcHJpdGVMZWZ0LndpZHRoIC0gdGhpcy5zcHJpdGVSaWdodC53aWR0aDtcbiAgICAgIHRoaXMuc3ByaXRlTWlkLndpZHRoID0gbWlkZGxlV2lkdGg7XG4gICAgICB0aGlzLnNwcml0ZU1pZC54ID0gdGhpcy5zcHJpdGVMZWZ0LndpZHRoO1xuXG4gICAgICB0aGlzLnNwcml0ZVJpZ2h0LnggPSB0aGlzLnNwcml0ZUxlZnQud2lkdGggKyBtaWRkbGVXaWR0aDtcblxuICAgICAgLy8gQWRkIHRvIGNvbnRhaW5lclxuICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5zcHJpdGVMZWZ0KTtcbiAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuc3ByaXRlTWlkKTtcbiAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuc3ByaXRlUmlnaHQpO1xuICAgIH1cblxuICAgIC8vIEFkZCBpY29uIGlmIHByb3ZpZGVkXG4gICAgaWYgKGljb24pIHtcbiAgICAgIGNvbnN0IGljb25UZXh0dXJlID0gaWNvbi5zcHJpdGVzaGVldC50ZXh0dXJlc1tpY29uLnRleHR1cmVOYW1lXTtcbiAgICAgIHRoaXMuaWNvblNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZShpY29uVGV4dHVyZSk7XG5cbiAgICAgIGlmIChpY29uLnBpeGVsUGVyZmVjdCAmJiBpY29uLnNwcml0ZXNoZWV0LnRleHR1cmVTb3VyY2UpIHtcbiAgICAgICAgaWNvbi5zcHJpdGVzaGVldC50ZXh0dXJlU291cmNlLnNjYWxlTW9kZSA9ICduZWFyZXN0JztcbiAgICAgIH1cblxuICAgICAgaWYgKGljb24uc2NhbGUpIHtcbiAgICAgICAgdGhpcy5pY29uU3ByaXRlLnNjYWxlLnNldChpY29uLnNjYWxlKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2VudGVyIHRoZSBpY29uXG4gICAgICB0aGlzLmljb25TcHJpdGUuYW5jaG9yLnNldCgwLjUpO1xuICAgICAgdGhpcy5pY29uU3ByaXRlLnggPSB3aWR0aCAvIDI7XG4gICAgICB0aGlzLmljb25TcHJpdGUueSA9IGhlaWdodCAvIDI7XG5cbiAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuaWNvblNwcml0ZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuY29udGFpbmVyO1xuICB9XG5cbiAgdXBkYXRlU3RhdGUoc3RhdGU6IEJ1dHRvblN0YXRlKTogdm9pZCB7XG4gICAgLy8gSGFuZGxlIHVwL2Rvd24gc3RhdGUgc3dpdGNoaW5nIGZvciA5LXNsaWNlIHNwcml0ZXNcbiAgICBpZiAodGhpcy5uaW5lU2xpY2VTcHJpdGUgJiYgdGhpcy5uaW5lU2xpY2VTcHJpdGVQcmVzc2VkKSB7XG4gICAgICBjb25zdCBpc1ByZXNzZWQgPSBzdGF0ZSA9PT0gQnV0dG9uU3RhdGUuUHJlc3NlZDtcbiAgICAgIHRoaXMubmluZVNsaWNlU3ByaXRlLnZpc2libGUgPSAhaXNQcmVzc2VkO1xuICAgICAgdGhpcy5uaW5lU2xpY2VTcHJpdGVQcmVzc2VkLnZpc2libGUgPSBpc1ByZXNzZWQ7XG5cbiAgICAgIC8vIE9mZnNldCBpY29uIHdoZW4gcHJlc3NlZFxuICAgICAgaWYgKHRoaXMuaWNvblNwcml0ZSkge1xuICAgICAgICB0aGlzLmljb25TcHJpdGUueSA9ICh0aGlzLmhlaWdodCAvIDIpICsgKGlzUHJlc3NlZCA/IDQgOiAwKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVXNlIHRpbnRpbmcgZm9yIHN0YXRlcyB3aGVuIG5vIHByZXNzZWQgdGV4dHVyZSBpcyBhdmFpbGFibGVcbiAgICAgIGxldCB0aW50OiBudW1iZXI7XG4gICAgICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgICAgIGNhc2UgQnV0dG9uU3RhdGUuTm9ybWFsOlxuICAgICAgICAgIHRpbnQgPSAweGZmZmZmZjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBCdXR0b25TdGF0ZS5Ib3ZlcjpcbiAgICAgICAgICB0aW50ID0gMHhjY2NjY2M7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQnV0dG9uU3RhdGUuUHJlc3NlZDpcbiAgICAgICAgICB0aW50ID0gMHg5OTk5OTk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQnV0dG9uU3RhdGUuRGlzYWJsZWQ6XG4gICAgICAgICAgdGludCA9IDB4ODg4ODg4O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5uaW5lU2xpY2VTcHJpdGUpIHtcbiAgICAgICAgdGhpcy5uaW5lU2xpY2VTcHJpdGUudGludCA9IHRpbnQ7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuc3ByaXRlTGVmdCAmJiB0aGlzLnNwcml0ZU1pZCAmJiB0aGlzLnNwcml0ZVJpZ2h0KSB7XG4gICAgICAgIHRoaXMuc3ByaXRlTGVmdC50aW50ID0gdGludDtcbiAgICAgICAgdGhpcy5zcHJpdGVNaWQudGludCA9IHRpbnQ7XG4gICAgICAgIHRoaXMuc3ByaXRlUmlnaHQudGludCA9IHRpbnQ7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0QWN0dWFsSGVpZ2h0KCk6IG51bWJlciB7XG4gICAgaWYgKHRoaXMubmluZVNsaWNlU3ByaXRlKSB7XG4gICAgICByZXR1cm4gdGhpcy5uaW5lU2xpY2VTcHJpdGUuaGVpZ2h0O1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zcHJpdGVMZWZ0Py5oZWlnaHQgPz8gdGhpcy5oZWlnaHQ7XG4gIH1cblxuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyPy5kZXN0cm95KHsgY2hpbGRyZW46IHRydWUgfSk7XG4gIH1cblxuICBwcml2YXRlIGdldFRleHR1cmVOYW1lKHBhdHRlcm46IHN0cmluZywgY29sb3I6IHN0cmluZywgcGFydDogJ2xlZnQnIHwgJ21pZCcgfCAncmlnaHQnKTogc3RyaW5nIHtcbiAgICAvLyBSZXBsYWNlIHtjb2xvcn0gcGxhY2Vob2xkZXIgYW5kIGVuc3VyZSBjb3JyZWN0IHBhcnRcbiAgICBsZXQgbmFtZSA9IHBhdHRlcm4ucmVwbGFjZSgne2NvbG9yfScsIGNvbG9yKTtcblxuICAgIC8vIFJlcGxhY2UgYW55IGV4aXN0aW5nIHBhcnQgc3VmZml4IHdpdGggdGhlIGRlc2lyZWQgb25lXG4gICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvXyg/OmxlZnR8bWlkfHJpZ2h0KVxcLnBuZyQvLCBgXyR7cGFydH0ucG5nYCk7XG5cbiAgICByZXR1cm4gbmFtZTtcbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5cbi8qKlxuICogUHJvcHMgZm9yIGNvbmZpZ3VyaW5nIGEgVUlCb3hcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSUJveFByb3BzIHtcbiAgLyoqIEJhY2tncm91bmQgY29sb3IgKGhleCBudW1iZXIsIGUuZy4sIDB4ZmYwMDAwIGZvciByZWQpICovXG4gIGJhY2tncm91bmRDb2xvcj86IG51bWJlcjtcbiAgLyoqIEJhY2tncm91bmQgYWxwaGEvb3BhY2l0eSAoMC0xKSAqL1xuICBiYWNrZ3JvdW5kQWxwaGE/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgY29sb3IgKi9cbiAgYm9yZGVyQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgd2lkdGggaW4gcGl4ZWxzICovXG4gIGJvcmRlcldpZHRoPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyBmb3Igcm91bmRlZCBjb3JuZXJzICovXG4gIGJvcmRlclJhZGl1cz86IG51bWJlcjtcbiAgLyoqIEZpeGVkIHdpZHRoICovXG4gIHdpZHRoPzogbnVtYmVyO1xuICAvKiogRml4ZWQgaGVpZ2h0ICovXG4gIGhlaWdodD86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBIHNpbXBsZSByZWN0YW5ndWxhciBib3ggY29tcG9uZW50IHdpdGggb3B0aW9uYWwgYmFja2dyb3VuZCBhbmQgYm9yZGVyXG4gKiBGb3VuZGF0aW9uIGZvciBwYW5lbHMsIGJ1dHRvbnMsIGFuZCBvdGhlciB2aXN1YWwgVUkgZWxlbWVudHNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgYm94ID0gbmV3IFVJQm94KHtcbiAqICAgYmFja2dyb3VuZENvbG9yOiAweDRhOTBlMixcbiAqICAgd2lkdGg6IDIwMCxcbiAqICAgaGVpZ2h0OiAxMDAsXG4gKiAgIGJvcmRlclJhZGl1czogOFxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJQm94IGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBVSUJveFByb3BzO1xuICBwcml2YXRlIGdyYXBoaWNzOiBQSVhJLkdyYXBoaWNzO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSUJveFByb3BzID0ge30sIGJveE1vZGVsPzogUGFydGlhbDxCb3hNb2RlbD4pIHtcbiAgICBzdXBlcihib3hNb2RlbCk7XG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogMHgwMDAwMDAsXG4gICAgICBiYWNrZ3JvdW5kQWxwaGE6IDEsXG4gICAgICBib3JkZXJXaWR0aDogMCxcbiAgICAgIGJvcmRlclJhZGl1czogMCxcbiAgICAgIC4uLnByb3BzXG4gICAgfTtcblxuICAgIC8vIENyZWF0ZSBncmFwaGljcyBvYmplY3QgZm9yIHJlbmRlcmluZ1xuICAgIHRoaXMuZ3JhcGhpY3MgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuZ3JhcGhpY3MpO1xuXG4gICAgLy8gU2V0IGJveCBtb2RlbCBkaW1lbnNpb25zIGlmIHByb3ZpZGVkXG4gICAgaWYgKHByb3BzLndpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSBwcm9wcy53aWR0aDtcbiAgICB9XG4gICAgaWYgKHByb3BzLmhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmJveE1vZGVsLmhlaWdodCA9IHByb3BzLmhlaWdodDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgdGhlIHNpemUgbmVlZGVkIGZvciB0aGlzIGJveFxuICAgKi9cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG4gICAgY29uc3QgYm9yZGVyID0gdGhpcy5ib3hNb2RlbC5ib3JkZXI7XG5cbiAgICAvLyBDYWxjdWxhdGUgY29udGVudCBzaXplXG4gICAgbGV0IGNvbnRlbnRXaWR0aCA9IDA7XG4gICAgbGV0IGNvbnRlbnRIZWlnaHQgPSAwO1xuXG4gICAgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLndpZHRoID09PSAnbnVtYmVyJykge1xuICAgICAgY29udGVudFdpZHRoID0gdGhpcy5ib3hNb2RlbC53aWR0aDtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMud2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29udGVudFdpZHRoID0gdGhpcy5wcm9wcy53aWR0aDtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID09PSAnbnVtYmVyJykge1xuICAgICAgY29udGVudEhlaWdodCA9IHRoaXMuYm94TW9kZWwuaGVpZ2h0O1xuICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5oZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29udGVudEhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuICAgIH1cblxuICAgIC8vIEFkZCBwYWRkaW5nIGFuZCBib3JkZXJcbiAgICBjb25zdCB0b3RhbFdpZHRoID0gY29udGVudFdpZHRoICsgcGFkZGluZy5ob3Jpem9udGFsICsgKGJvcmRlcj8uaG9yaXpvbnRhbCA/PyAwKTtcbiAgICBjb25zdCB0b3RhbEhlaWdodCA9IGNvbnRlbnRIZWlnaHQgKyBwYWRkaW5nLnZlcnRpY2FsICsgKGJvcmRlcj8udmVydGljYWwgPz8gMCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IE1hdGgubWF4KHRvdGFsV2lkdGgsIHRoaXMuYm94TW9kZWwubWluV2lkdGggPz8gMCksXG4gICAgICBoZWlnaHQ6IE1hdGgubWF4KHRvdGFsSGVpZ2h0LCB0aGlzLmJveE1vZGVsLm1pbkhlaWdodCA/PyAwKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIGJveFxuICAgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuICAgIGNvbnN0IGJvcmRlciA9IHRoaXMuYm94TW9kZWwuYm9yZGVyID8/IHsgaG9yaXpvbnRhbDogMCwgdmVydGljYWw6IDAsIHRvcDogMCwgcmlnaHQ6IDAsIGJvdHRvbTogMCwgbGVmdDogMCB9O1xuXG4gICAgLy8gQ2FsY3VsYXRlIGZpbmFsIGRpbWVuc2lvbnNcbiAgICBsZXQgZmluYWxXaWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIGxldCBmaW5hbEhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcblxuICAgIC8vIEhhbmRsZSAnZmlsbCcgY29uc3RyYWludFxuICAgIGlmICh0aGlzLmJveE1vZGVsLndpZHRoID09PSAnZmlsbCcpIHtcbiAgICAgIGZpbmFsV2lkdGggPSBhdmFpbGFibGVXaWR0aDtcbiAgICB9XG4gICAgaWYgKHRoaXMuYm94TW9kZWwuaGVpZ2h0ID09PSAnZmlsbCcpIHtcbiAgICAgIGZpbmFsSGVpZ2h0ID0gYXZhaWxhYmxlSGVpZ2h0O1xuICAgIH1cblxuICAgIC8vIEFwcGx5IG1heCBjb25zdHJhaW50c1xuICAgIGlmICh0aGlzLmJveE1vZGVsLm1heFdpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZpbmFsV2lkdGggPSBNYXRoLm1pbihmaW5hbFdpZHRoLCB0aGlzLmJveE1vZGVsLm1heFdpZHRoKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuYm94TW9kZWwubWF4SGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZpbmFsSGVpZ2h0ID0gTWF0aC5taW4oZmluYWxIZWlnaHQsIHRoaXMuYm94TW9kZWwubWF4SGVpZ2h0KTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgY29tcHV0ZWQgbGF5b3V0XG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IGZpbmFsV2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBmaW5hbEhlaWdodDtcblxuICAgIC8vIENvbnRlbnQgYXJlYSAoaW5zaWRlIHBhZGRpbmcgYW5kIGJvcmRlcilcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRYID0gcGFkZGluZy5sZWZ0ICsgYm9yZGVyLmxlZnQ7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50WSA9IHBhZGRpbmcudG9wICsgYm9yZGVyLnRvcDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRXaWR0aCA9IGZpbmFsV2lkdGggLSBwYWRkaW5nLmhvcml6b250YWwgLSBib3JkZXIuaG9yaXpvbnRhbDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRIZWlnaHQgPSBmaW5hbEhlaWdodCAtIHBhZGRpbmcudmVydGljYWwgLSBib3JkZXIudmVydGljYWw7XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSBib3ggdmlzdWFsc1xuICAgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICB0aGlzLmdyYXBoaWNzLmNsZWFyKCk7XG5cbiAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IHRoaXMuY29tcHV0ZWRMYXlvdXQ7XG4gICAgY29uc3QgeyBiYWNrZ3JvdW5kQ29sb3IsIGJhY2tncm91bmRBbHBoYSwgYm9yZGVyQ29sb3IsIGJvcmRlcldpZHRoLCBib3JkZXJSYWRpdXMgfSA9IHRoaXMucHJvcHM7XG5cbiAgICAvLyBEcmF3IGJvcmRlciBpZiBzcGVjaWZpZWRcbiAgICBpZiAoYm9yZGVyV2lkdGggJiYgYm9yZGVyV2lkdGggPiAwICYmIGJvcmRlckNvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuZ3JhcGhpY3MucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKHsgY29sb3I6IGJvcmRlckNvbG9yLCB3aWR0aDogYm9yZGVyV2lkdGggfSk7XG4gICAgfVxuXG4gICAgLy8gRHJhdyBiYWNrZ3JvdW5kXG4gICAgaWYgKGJhY2tncm91bmRDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAoYm9yZGVyUmFkaXVzICYmIGJvcmRlclJhZGl1cyA+IDApIHtcbiAgICAgICAgdGhpcy5ncmFwaGljcy5yb3VuZFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCwgYm9yZGVyUmFkaXVzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZ3JhcGhpY3MucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZ3JhcGhpY3MuZmlsbCh7IGNvbG9yOiBiYWNrZ3JvdW5kQ29sb3IsIGFscGhhOiBiYWNrZ3JvdW5kQWxwaGEgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGJhY2tncm91bmQgY29sb3JcbiAgICovXG4gIHNldEJhY2tncm91bmRDb2xvcihjb2xvcjogbnVtYmVyLCBhbHBoYTogbnVtYmVyID0gMSk6IHZvaWQge1xuICAgIHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XG4gICAgdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQWxwaGEgPSBhbHBoYTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGJvcmRlclxuICAgKi9cbiAgc2V0Qm9yZGVyKGNvbG9yOiBudW1iZXIsIHdpZHRoOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLmJvcmRlckNvbG9yID0gY29sb3I7XG4gICAgdGhpcy5wcm9wcy5ib3JkZXJXaWR0aCA9IHdpZHRoO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuaW1wb3J0IHsgVUlMYWJlbCB9IGZyb20gJy4vdWktbGFiZWwnO1xuaW1wb3J0IHsgRWRnZUluc2V0cyB9IGZyb20gJy4uL2NvcmUvZWRnZS1pbnNldHMnO1xuaW1wb3J0IHsgVUlGb2N1c01hbmFnZXIgfSBmcm9tICcuLi9jb3JlL3VpLWZvY3VzLW1hbmFnZXInO1xuaW1wb3J0IHtcbiAgQnV0dG9uQmFja2dyb3VuZFN0cmF0ZWd5LFxuICBTb2xpZENvbG9yQmFja2dyb3VuZFN0cmF0ZWd5LFxuICBTcHJpdGVCYWNrZ3JvdW5kU3RyYXRlZ3ksXG4gIFNwcml0ZUJhY2tncm91bmRDb25maWdcbn0gZnJvbSAnLi9idXR0b24tYmFja2dyb3VuZC1zdHJhdGVneSc7XG5cbi8qKlxuICogQnV0dG9uIHZpc3VhbCBzdGF0ZXNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGVudW0gQnV0dG9uU3RhdGUge1xuICBOb3JtYWwgPSAnbm9ybWFsJyxcbiAgSG92ZXIgPSAnaG92ZXInLFxuICBQcmVzc2VkID0gJ3ByZXNzZWQnLFxuICBEaXNhYmxlZCA9ICdkaXNhYmxlZCdcbn1cblxuLy8gUmUtZXhwb3J0IFNwcml0ZUJhY2tncm91bmRDb25maWcgZm9yIGNvbnZlbmllbmNlXG5leHBvcnQgdHlwZSB7IFNwcml0ZUJhY2tncm91bmRDb25maWcgfSBmcm9tICcuL2J1dHRvbi1iYWNrZ3JvdW5kLXN0cmF0ZWd5JztcblxuLyoqXG4gKiBQcm9wcyBmb3IgY29uZmlndXJpbmcgYSBVSUJ1dHRvblxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFVJQnV0dG9uUHJvcHMge1xuICAvKiogQnV0dG9uIGxhYmVsIHRleHQgKi9cbiAgbGFiZWw/OiBzdHJpbmc7XG4gIC8qKiBCdXR0b24gd2lkdGggKi9cbiAgd2lkdGg/OiBudW1iZXI7XG4gIC8qKiBCdXR0b24gaGVpZ2h0ICovXG4gIGhlaWdodD86IG51bWJlcjtcbiAgLyoqIEJhY2tncm91bmQgY29sb3IgKG9ubHkgdXNlZCBpZiBzcHJpdGVCYWNrZ3JvdW5kIGlzIG5vdCBwcm92aWRlZCkgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogU3ByaXRlLWJhc2VkIGJhY2tncm91bmQgY29uZmlndXJhdGlvbiAqL1xuICBzcHJpdGVCYWNrZ3JvdW5kPzogU3ByaXRlQmFja2dyb3VuZENvbmZpZztcbiAgLyoqIFRleHQgY29sb3IgKi9cbiAgdGV4dENvbG9yPzogbnVtYmVyO1xuICAvKiogRm9udCBzaXplICovXG4gIGZvbnRTaXplPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyAob25seSB1c2VkIHdpdGggYmFja2dyb3VuZENvbG9yKSAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG4gIC8qKiBQYWRkaW5nIGluc2lkZSBidXR0b24gKi9cbiAgcGFkZGluZz86IEVkZ2VJbnNldHM7XG4gIC8qKiBVc2UgQml0bWFwVGV4dCBpbnN0ZWFkIG9mIHJlZ3VsYXIgdGV4dCAqL1xuICB1c2VCaXRtYXBUZXh0PzogYm9vbGVhbjtcbiAgLyoqIEJpdG1hcFRleHQgZm9udCBmYW1pbHkgKHJlcXVpcmVkIGlmIHVzZUJpdG1hcFRleHQgaXMgdHJ1ZSkgKi9cbiAgYml0bWFwRm9udEZhbWlseT86IHN0cmluZztcbiAgLyoqIENsaWNrIGNhbGxiYWNrICovXG4gIG9uQ2xpY2s/OiAoKSA9PiB2b2lkO1xuICAvKiogSG92ZXIgY2FsbGJhY2sgKi9cbiAgb25Ib3Zlcj86ICgpID0+IHZvaWQ7XG4gIC8qKiBFbmFibGVkIHN0YXRlICovXG4gIGVuYWJsZWQ/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIEFuIGludGVyYWN0aXZlIGJ1dHRvbiBjb21wb25lbnRcbiAqIFN1cHBvcnRzIGhvdmVyLCBwcmVzcywgYW5kIGRpc2FibGVkIHN0YXRlc1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBidXR0b24gPSBuZXcgVUlCdXR0b24oe1xuICogICBsYWJlbDogJ0NsaWNrIE1lJyxcbiAqICAgd2lkdGg6IDE1MCxcbiAqICAgaGVpZ2h0OiA0MCxcbiAqICAgYmFja2dyb3VuZENvbG9yOiAweDRhOTBlMixcbiAqICAgdGV4dENvbG9yOiAweGZmZmZmZixcbiAqICAgb25DbGljazogKCkgPT4gY29uc29sZS5sb2coJ0J1dHRvbiBjbGlja2VkIScpXG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlCdXR0b24gZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFJlcXVpcmVkPE9taXQ8VUlCdXR0b25Qcm9wcywgJ29uQ2xpY2snIHwgJ29uSG92ZXInIHwgJ3Nwcml0ZUJhY2tncm91bmQnIHwgJ3VzZUJpdG1hcFRleHQnIHwgJ2JpdG1hcEZvbnRGYW1pbHknPj47XG4gIHByaXZhdGUgdXNlQml0bWFwVGV4dDogYm9vbGVhbjtcbiAgcHJpdmF0ZSBiaXRtYXBGb250RmFtaWx5Pzogc3RyaW5nO1xuICBwcml2YXRlIG9uQ2xpY2s/OiAoKSA9PiB2b2lkO1xuICBwcml2YXRlIG9uSG92ZXI/OiAoKSA9PiB2b2lkO1xuXG4gIHByaXZhdGUgc3RhdGU6IEJ1dHRvblN0YXRlID0gQnV0dG9uU3RhdGUuTm9ybWFsO1xuICBwcml2YXRlIGJhY2tncm91bmRTdHJhdGVneTogQnV0dG9uQmFja2dyb3VuZFN0cmF0ZWd5O1xuICBwcml2YXRlIGxhYmVsPzogVUlMYWJlbDtcbiAgcHJpdmF0ZSBiaXRtYXBMYWJlbD86IFBJWEkuQml0bWFwVGV4dDtcblxuICAvLyBDYWNoZWQgbGFiZWwgY2VudGVyIHBvc2l0aW9uXG4gIHByaXZhdGUgbGFiZWxDZW50ZXJYOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGxhYmVsQ2VudGVyWTogbnVtYmVyID0gMDtcblxuICAvLyBLZXlib2FyZCBoYW5kbGVyIGZvciBjbGVhbnVwXG4gIHByaXZhdGUga2V5ZG93bkhhbmRsZXI/OiAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlCdXR0b25Qcm9wcyA9IHt9LCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIGxhYmVsOiBwcm9wcy5sYWJlbCA/PyAnJyxcbiAgICAgIHdpZHRoOiBwcm9wcy53aWR0aCA/PyAxMjAsXG4gICAgICBoZWlnaHQ6IHByb3BzLmhlaWdodCA/PyA0MCxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogcHJvcHMuYmFja2dyb3VuZENvbG9yID8/IDB4NGE5MGUyLFxuICAgICAgdGV4dENvbG9yOiBwcm9wcy50ZXh0Q29sb3IgPz8gMHhmZmZmZmYsXG4gICAgICBmb250U2l6ZTogcHJvcHMuZm9udFNpemUgPz8gMTYsXG4gICAgICBib3JkZXJSYWRpdXM6IHByb3BzLmJvcmRlclJhZGl1cyA/PyA0LFxuICAgICAgcGFkZGluZzogcHJvcHMucGFkZGluZyA/PyBFZGdlSW5zZXRzLnN5bW1ldHJpYyg4LCAxNiksXG4gICAgICBlbmFibGVkOiBwcm9wcy5lbmFibGVkID8/IHRydWVcbiAgICB9O1xuXG4gICAgdGhpcy51c2VCaXRtYXBUZXh0ID0gcHJvcHMudXNlQml0bWFwVGV4dCA/PyBmYWxzZTtcbiAgICB0aGlzLmJpdG1hcEZvbnRGYW1pbHkgPSBwcm9wcy5iaXRtYXBGb250RmFtaWx5O1xuICAgIHRoaXMub25DbGljayA9IHByb3BzLm9uQ2xpY2s7XG4gICAgdGhpcy5vbkhvdmVyID0gcHJvcHMub25Ib3ZlcjtcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9uc1xuICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSB0aGlzLnByb3BzLndpZHRoO1xuICAgIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG5cbiAgICAvLyBNYWtlIGJ1dHRvbnMgZm9jdXNhYmxlIGJ5IGRlZmF1bHRcbiAgICB0aGlzLnRhYkluZGV4ID0gMDtcblxuICAgIC8vIENyZWF0ZSBiYWNrZ3JvdW5kIHN0cmF0ZWd5IGJhc2VkIG9uIGNvbmZpZ3VyYXRpb25cbiAgICBpZiAocHJvcHMuc3ByaXRlQmFja2dyb3VuZCkge1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kU3RyYXRlZ3kgPSBuZXcgU3ByaXRlQmFja2dyb3VuZFN0cmF0ZWd5KFxuICAgICAgICBwcm9wcy5zcHJpdGVCYWNrZ3JvdW5kLFxuICAgICAgICB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgICB0aGlzLnByb3BzLmhlaWdodFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kU3RyYXRlZ3kgPSBuZXcgU29saWRDb2xvckJhY2tncm91bmRTdHJhdGVneShcbiAgICAgICAgdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICAgIHRoaXMucHJvcHMud2lkdGgsXG4gICAgICAgIHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgICB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYW5kIGFkZCBiYWNrZ3JvdW5kXG4gICAgY29uc3QgYmFja2dyb3VuZENvbnRhaW5lciA9IHRoaXMuYmFja2dyb3VuZFN0cmF0ZWd5LmNyZWF0ZSh0aGlzLnByb3BzLndpZHRoLCB0aGlzLnByb3BzLmhlaWdodCk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQoYmFja2dyb3VuZENvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgbGFiZWwgaWYgdGV4dCBwcm92aWRlZFxuICAgIGlmICh0aGlzLnByb3BzLmxhYmVsKSB7XG4gICAgICBpZiAodGhpcy51c2VCaXRtYXBUZXh0ICYmIHRoaXMuYml0bWFwRm9udEZhbWlseSkge1xuICAgICAgICB0aGlzLmNyZWF0ZUJpdG1hcExhYmVsKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxhYmVsID0gbmV3IFVJTGFiZWwoe1xuICAgICAgICAgIHRleHQ6IHRoaXMucHJvcHMubGFiZWwsXG4gICAgICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMuZm9udFNpemUsXG4gICAgICAgICAgY29sb3I6IHRoaXMucHJvcHMudGV4dENvbG9yLFxuICAgICAgICAgIGFsaWduOiAnY2VudGVyJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgcGFkZGluZzogRWRnZUluc2V0cy56ZXJvKClcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMubGFiZWwuY29udGFpbmVyKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBTZXR1cCBpbnRlcmFjdGl2aXR5XG4gICAgdGhpcy5zZXR1cEludGVyYWN0aXZpdHkoKTtcblxuICAgIC8vIEluaXRpYWwgc3RhdGVcbiAgICBpZiAoIXRoaXMucHJvcHMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5EaXNhYmxlZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBCaXRtYXBUZXh0IGxhYmVsXG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZUJpdG1hcExhYmVsKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5iaXRtYXBGb250RmFtaWx5KSByZXR1cm47XG5cbiAgICB0aGlzLmJpdG1hcExhYmVsID0gbmV3IFBJWEkuQml0bWFwVGV4dCh7XG4gICAgICB0ZXh0OiB0aGlzLnByb3BzLmxhYmVsLFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgZm9udEZhbWlseTogdGhpcy5iaXRtYXBGb250RmFtaWx5LFxuICAgICAgICBmb250U2l6ZTogdGhpcy5wcm9wcy5mb250U2l6ZSxcbiAgICAgICAgZmlsbDogdGhpcy5wcm9wcy50ZXh0Q29sb3JcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuYml0bWFwTGFiZWwpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgbW91c2UvdG91Y2ggZXZlbnQgaGFuZGxlcnNcbiAgICovXG4gIHByaXZhdGUgc2V0dXBJbnRlcmFjdGl2aXR5KCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgIHRoaXMuY29udGFpbmVyLmN1cnNvciA9ICdwb2ludGVyJztcblxuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVyb3ZlcicsIHRoaXMuaGFuZGxlUG9pbnRlck92ZXIuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5jb250YWluZXIub24oJ3BvaW50ZXJvdXQnLCB0aGlzLmhhbmRsZVBvaW50ZXJPdXQuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5jb250YWluZXIub24oJ3BvaW50ZXJkb3duJywgdGhpcy5oYW5kbGVQb2ludGVyRG93bi5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmNvbnRhaW5lci5vbigncG9pbnRlcnVwJywgdGhpcy5oYW5kbGVQb2ludGVyVXAuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5jb250YWluZXIub24oJ3BvaW50ZXJ1cG91dHNpZGUnLCB0aGlzLmhhbmRsZVBvaW50ZXJVcE91dHNpZGUuYmluZCh0aGlzKSk7XG5cbiAgICAvLyBIYW5kbGUga2V5Ym9hcmQgaW50ZXJhY3Rpb24gd2hlbiBmb2N1c2VkXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzLmtleWRvd25IYW5kbGVyID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuaXNGb2N1c2VkKCkgJiYgdGhpcy5wcm9wcy5lbmFibGVkKSB7XG4gICAgICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInIHx8IGUua2V5ID09PSAnICcpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgLy8gU2hvdyBwcmVzc2VkIHN0YXRlXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKEJ1dHRvblN0YXRlLlByZXNzZWQpO1xuXG4gICAgICAgICAgICAvLyBUcmlnZ2VyIGNsaWNrXG4gICAgICAgICAgICB0aGlzLm9uQ2xpY2s/LigpO1xuXG4gICAgICAgICAgICAvLyBSZXR1cm4gdG8gaG92ZXIgc3RhdGUgYWZ0ZXIgYSBzaG9ydCBkZWxheSAoc2ltdWxhdGluZyBidXR0b24gcmVsZWFzZSlcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5lbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5Ob3JtYWwpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlkb3duSGFuZGxlcik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyT3ZlcigpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wcm9wcy5lbmFibGVkICYmIHRoaXMuc3RhdGUgPT09IEJ1dHRvblN0YXRlLk5vcm1hbCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5Ib3Zlcik7XG4gICAgICB0aGlzLm9uSG92ZXI/LigpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlck91dCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wcm9wcy5lbmFibGVkICYmIHRoaXMuc3RhdGUgIT09IEJ1dHRvblN0YXRlLlByZXNzZWQpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuTm9ybWFsKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJEb3duKCk6IHZvaWQge1xuICAgIGNvbnNvbGUubG9nKCfwn5S1IEJ1dHRvbiBoYW5kbGVQb2ludGVyRG93biBjYWxsZWQnKTtcbiAgICBjb25zb2xlLmxvZygnICAtIGVuYWJsZWQ6JywgdGhpcy5wcm9wcy5lbmFibGVkKTtcbiAgICBjb25zb2xlLmxvZygnICAtIGNhbkZvY3VzOicsIHRoaXMuY2FuRm9jdXMoKSk7XG4gICAgY29uc29sZS5sb2coJyAgLSB0YWJJbmRleDonLCB0aGlzLnRhYkluZGV4KTtcblxuICAgIGlmICh0aGlzLnByb3BzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuUHJlc3NlZCk7XG5cbiAgICAgIC8vIFJlcXVlc3QgZm9jdXMgdGhyb3VnaCB0aGUgZm9jdXMgbWFuYWdlclxuICAgICAgaWYgKHRoaXMuY2FuRm9jdXMoKSkge1xuICAgICAgICBjb25zdCBmb2N1c01hbmFnZXIgPSBVSUZvY3VzTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuICAgICAgICBjb25zb2xlLmxvZygnICAtIGZvY3VzTWFuYWdlcjonLCBmb2N1c01hbmFnZXIpO1xuICAgICAgICBpZiAoZm9jdXNNYW5hZ2VyKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJyAgLSBDYWxsaW5nIHJlcXVlc3RGb2N1cycpO1xuICAgICAgICAgIGZvY3VzTWFuYWdlci5yZXF1ZXN0Rm9jdXModGhpcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJyAgLSBObyBmb2N1cyBtYW5hZ2VyLCBjYWxsaW5nIG9uRm9jdXMgZGlyZWN0bHknKTtcbiAgICAgICAgICAvLyBGYWxsYmFjayBpZiBubyBmb2N1cyBtYW5hZ2VyXG4gICAgICAgICAgdGhpcy5vbkZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCcgIC0gY2FuRm9jdXMgcmV0dXJuZWQgZmFsc2UsIE5PVCBmb2N1c2luZycpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlclVwKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuSG92ZXIpO1xuICAgICAgdGhpcy5vbkNsaWNrPy4oKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJVcE91dHNpZGUoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5Ob3JtYWwpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBidXR0b24ncyB2aXN1YWwgc3RhdGVcbiAgICovXG4gIHByaXZhdGUgc2V0U3RhdGUobmV3U3RhdGU6IEJ1dHRvblN0YXRlKTogdm9pZCB7XG4gICAgdGhpcy5zdGF0ZSA9IG5ld1N0YXRlO1xuICAgIHRoaXMudXBkYXRlVmlzdWFscygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdmlzdWFscyBiYXNlZCBvbiBjdXJyZW50IHN0YXRlXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZVZpc3VhbHMoKTogdm9pZCB7XG4gICAgLy8gVXBkYXRlIGJhY2tncm91bmQgdXNpbmcgc3RyYXRlZ3lcbiAgICB0aGlzLmJhY2tncm91bmRTdHJhdGVneS51cGRhdGVTdGF0ZSh0aGlzLnN0YXRlKTtcblxuICAgIC8vIENhbGN1bGF0ZSBkZXB0aCBvZmZzZXQgZm9yIHByZXNzZWQgc3RhdGVcbiAgICBjb25zdCB5T2Zmc2V0ID0gdGhpcy5zdGF0ZSA9PT0gQnV0dG9uU3RhdGUuUHJlc3NlZCA/IDIgOiAwO1xuXG4gICAgLy8gVXBkYXRlIGN1cnNvciBmb3IgZGlzYWJsZWQgc3RhdGVcbiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gQnV0dG9uU3RhdGUuRGlzYWJsZWQpIHtcbiAgICAgIHRoaXMuY29udGFpbmVyLmN1cnNvciA9ICdkZWZhdWx0JztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jb250YWluZXIuY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgIH1cblxuICAgIC8vIEFwcGx5IGRlcHRoIG9mZnNldCB0byBsYWJlbFxuICAgIGlmICh0aGlzLmxhYmVsKSB7XG4gICAgICB0aGlzLmxhYmVsLnNldFBvc2l0aW9uKHRoaXMubGFiZWxDZW50ZXJYLCB0aGlzLmxhYmVsQ2VudGVyWSArIHlPZmZzZXQpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5iaXRtYXBMYWJlbCkge1xuICAgICAgdGhpcy5iaXRtYXBMYWJlbC54ID0gdGhpcy5sYWJlbENlbnRlclg7XG4gICAgICB0aGlzLmJpdG1hcExhYmVsLnkgPSB0aGlzLmxhYmVsQ2VudGVyWSArIHlPZmZzZXQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmVzIHRoZSBzaXplIG5lZWRlZCBmb3IgdGhpcyBidXR0b25cbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBsYXlvdXQgZm9yIHRoaXMgYnV0dG9uXG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuXG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgLy8gR2V0IGFjdHVhbCBiYWNrZ3JvdW5kIGhlaWdodCBmcm9tIHN0cmF0ZWd5XG4gICAgY29uc3QgYWN0dWFsSGVpZ2h0ID0gdGhpcy5iYWNrZ3JvdW5kU3RyYXRlZ3kuZ2V0QWN0dWFsSGVpZ2h0KCk7XG5cbiAgICAvLyBMYXlvdXQgYW5kIGNlbnRlciBsYWJlbFxuICAgIGlmICh0aGlzLmxhYmVsKSB7XG4gICAgICB0aGlzLmxhYmVsLmxheW91dChtZWFzdXJlZC53aWR0aCwgbWVhc3VyZWQuaGVpZ2h0KTtcblxuICAgICAgLy8gQ2VudGVyIHRoZSBsYWJlbCBhbmQgY2FjaGUgdGhlIHBvc2l0aW9uXG4gICAgICBjb25zdCBsYWJlbExheW91dCA9IHRoaXMubGFiZWwuZ2V0TGF5b3V0KCk7XG4gICAgICB0aGlzLmxhYmVsQ2VudGVyWCA9IChtZWFzdXJlZC53aWR0aCAtIGxhYmVsTGF5b3V0LndpZHRoKSAvIDI7XG4gICAgICB0aGlzLmxhYmVsQ2VudGVyWSA9IChhY3R1YWxIZWlnaHQgLSBsYWJlbExheW91dC5oZWlnaHQpIC8gMjtcbiAgICAgIHRoaXMubGFiZWwuc2V0UG9zaXRpb24odGhpcy5sYWJlbENlbnRlclgsIHRoaXMubGFiZWxDZW50ZXJZKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuYml0bWFwTGFiZWwpIHtcbiAgICAgIC8vIENlbnRlciB0aGUgYml0bWFwIHRleHQgdXNpbmcgYWN0dWFsIGJhY2tncm91bmQgaGVpZ2h0XG4gICAgICB0aGlzLmxhYmVsQ2VudGVyWCA9IChtZWFzdXJlZC53aWR0aCAtIHRoaXMuYml0bWFwTGFiZWwud2lkdGgpIC8gMjtcbiAgICAgIHRoaXMubGFiZWxDZW50ZXJZID0gKGFjdHVhbEhlaWdodCAtIHRoaXMuYml0bWFwTGFiZWwuaGVpZ2h0KSAvIDI7XG4gICAgICB0aGlzLmJpdG1hcExhYmVsLnggPSB0aGlzLmxhYmVsQ2VudGVyWDtcbiAgICAgIHRoaXMuYml0bWFwTGFiZWwueSA9IHRoaXMubGFiZWxDZW50ZXJZO1xuICAgIH1cblxuICAgIHRoaXMubGF5b3V0RGlydHkgPSBmYWxzZTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIGJ1dHRvbiAoY2FsbGVkIGFmdGVyIGxheW91dClcbiAgICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgLy8gUmVuZGVyaW5nIGlzIGhhbmRsZWQgYnkgYmFja2dyb3VuZCBhbmQgbGFiZWxcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBidXR0b24gbGFiZWxcbiAgICovXG4gIHNldExhYmVsKHRleHQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICh0aGlzLmxhYmVsKSB7XG4gICAgICB0aGlzLmxhYmVsLnNldFRleHQodGV4dCk7XG4gICAgICB0aGlzLm1hcmtMYXlvdXREaXJ0eSgpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5iaXRtYXBMYWJlbCkge1xuICAgICAgdGhpcy5iaXRtYXBMYWJlbC50ZXh0ID0gdGV4dDtcbiAgICAgIHRoaXMubWFya0xheW91dERpcnR5KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIGVuYWJsZWQgc3RhdGVcbiAgICovXG4gIHNldEVuYWJsZWQoZW5hYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMucHJvcHMuZW5hYmxlZCA9IGVuYWJsZWQ7XG4gICAgdGhpcy5zZXRTdGF0ZShlbmFibGVkID8gQnV0dG9uU3RhdGUuTm9ybWFsIDogQnV0dG9uU3RhdGUuRGlzYWJsZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgc3RhdGVcbiAgICovXG4gIGdldFN0YXRlKCk6IEJ1dHRvblN0YXRlIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIHdoZW4gZGVzdHJveWluZyB0aGUgYnV0dG9uXG4gICAqL1xuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB0aGlzLmtleWRvd25IYW5kbGVyKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5ZG93bkhhbmRsZXIpO1xuICAgIH1cbiAgICBzdXBlci5kZXN0cm95KCk7XG4gIH1cblxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5cbi8qKlxuICogVGV4dCBhbGlnbm1lbnQgb3B0aW9uc1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgdHlwZSBUZXh0QWxpZ24gPSAnbGVmdCcgfCAnY2VudGVyJyB8ICdyaWdodCc7XG5cbi8qKlxuICogUHJvcHMgZm9yIGNvbmZpZ3VyaW5nIGEgVUlMYWJlbFxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFVJTGFiZWxQcm9wcyB7XG4gIC8qKiBUaGUgdGV4dCB0byBkaXNwbGF5ICovXG4gIHRleHQ6IHN0cmluZztcbiAgLyoqIEZvbnQgc2l6ZSBpbiBwaXhlbHMgKi9cbiAgZm9udFNpemU/OiBudW1iZXI7XG4gIC8qKiBGb250IGZhbWlseSBuYW1lICovXG4gIGZvbnRGYW1pbHk/OiBzdHJpbmc7XG4gIC8qKiBUZXh0IGNvbG9yIChoZXggbnVtYmVyKSAqL1xuICBjb2xvcj86IG51bWJlcjtcbiAgLyoqIFRleHQgYWxpZ25tZW50ICovXG4gIGFsaWduPzogVGV4dEFsaWduO1xuICAvKiogRW5hYmxlIHdvcmQgd3JhcHBpbmcgKi9cbiAgd29yZFdyYXA/OiBib29sZWFuO1xuICAvKiogV29yZCB3cmFwIHdpZHRoIChyZXF1aXJlZCBpZiB3b3JkV3JhcCBpcyB0cnVlKSAqL1xuICB3b3JkV3JhcFdpZHRoPzogbnVtYmVyO1xuICAvKiogRm9udCB3ZWlnaHQgKi9cbiAgZm9udFdlaWdodD86IHN0cmluZztcbiAgLyoqIExpbmUgaGVpZ2h0IG11bHRpcGxpZXIgKi9cbiAgbGluZUhlaWdodD86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBIHRleHQgbGFiZWwgY29tcG9uZW50XG4gKiBXcmFwcyBQSVhJLlRleHQgd2l0aCBsYXlvdXQgaW50ZWdyYXRpb25cbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgbGFiZWwgPSBuZXcgVUlMYWJlbCh7XG4gKiAgIHRleHQ6ICdIZWxsbyBXb3JsZCcsXG4gKiAgIGZvbnRTaXplOiAyNCxcbiAqICAgY29sb3I6IDB4ZmZmZmZmLFxuICogICBhbGlnbjogJ2NlbnRlcidcbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSUxhYmVsIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxVSUxhYmVsUHJvcHM+O1xuICBwcml2YXRlIHRleHRPYmplY3Q6IFBJWEkuVGV4dDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlMYWJlbFByb3BzLCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIHRleHQ6IHByb3BzLnRleHQsXG4gICAgICBmb250U2l6ZTogcHJvcHMuZm9udFNpemUgPz8gMTYsXG4gICAgICBmb250RmFtaWx5OiBwcm9wcy5mb250RmFtaWx5ID8/ICdBcmlhbCcsXG4gICAgICBjb2xvcjogcHJvcHMuY29sb3IgPz8gMHhmZmZmZmYsXG4gICAgICBhbGlnbjogcHJvcHMuYWxpZ24gPz8gJ2xlZnQnLFxuICAgICAgd29yZFdyYXA6IHByb3BzLndvcmRXcmFwID8/IGZhbHNlLFxuICAgICAgd29yZFdyYXBXaWR0aDogcHJvcHMud29yZFdyYXBXaWR0aCA/PyAwLFxuICAgICAgZm9udFdlaWdodDogcHJvcHMuZm9udFdlaWdodCA/PyAnbm9ybWFsJyxcbiAgICAgIGxpbmVIZWlnaHQ6IHByb3BzLmxpbmVIZWlnaHQgPz8gMS4yXG4gICAgfTtcblxuICAgIC8vIENyZWF0ZSBQSVhJLlRleHQgd2l0aCBpbml0aWFsIHN0eWxlXG4gICAgdGhpcy50ZXh0T2JqZWN0ID0gbmV3IFBJWEkuVGV4dCh7XG4gICAgICB0ZXh0OiB0aGlzLnByb3BzLnRleHQsXG4gICAgICBzdHlsZTogdGhpcy5nZXRUZXh0U3R5bGUoKSxcbiAgICAgIHJlc29sdXRpb246IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDIgLy8gTWF0Y2ggZGV2aWNlIHJlc29sdXRpb24gZm9yIGNyaXNwIHRleHRcbiAgICB9KTtcblxuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMudGV4dE9iamVjdCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgUElYSSB0ZXh0IHN0eWxlIGJhc2VkIG9uIGN1cnJlbnQgcHJvcHNcbiAgICovXG4gIHByaXZhdGUgZ2V0VGV4dFN0eWxlKCk6IFBJWEkuVGV4dFN0eWxlIHtcbiAgICBjb25zdCBzdHlsZTogYW55ID0ge1xuICAgICAgZm9udEZhbWlseTogdGhpcy5wcm9wcy5mb250RmFtaWx5LFxuICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMuZm9udFNpemUsXG4gICAgICBmaWxsOiB0aGlzLnByb3BzLmNvbG9yLFxuICAgICAgYWxpZ246IHRoaXMucHJvcHMuYWxpZ24sXG4gICAgICBmb250V2VpZ2h0OiB0aGlzLnByb3BzLmZvbnRXZWlnaHQsXG4gICAgICBsaW5lSGVpZ2h0OiB0aGlzLnByb3BzLmZvbnRTaXplICogdGhpcy5wcm9wcy5saW5lSGVpZ2h0XG4gICAgfTtcblxuICAgIGlmICh0aGlzLnByb3BzLndvcmRXcmFwKSB7XG4gICAgICBzdHlsZS53b3JkV3JhcCA9IHRydWU7XG4gICAgICBzdHlsZS53b3JkV3JhcFdpZHRoID0gdGhpcy5wcm9wcy53b3JkV3JhcFdpZHRoO1xuICAgIH1cblxuICAgIHJldHVybiBzdHlsZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgbGFiZWxcbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuICAgIGNvbnN0IG1ldHJpY3MgPSB0aGlzLnRleHRPYmplY3Q7XG5cbiAgICAvLyBHZXQgdGV4dCBib3VuZHNcbiAgICBjb25zdCB0ZXh0V2lkdGggPSBtZXRyaWNzLndpZHRoO1xuICAgIGNvbnN0IHRleHRIZWlnaHQgPSBtZXRyaWNzLmhlaWdodDtcblxuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogdGV4dFdpZHRoICsgcGFkZGluZy5ob3Jpem9udGFsLFxuICAgICAgaGVpZ2h0OiB0ZXh0SGVpZ2h0ICsgcGFkZGluZy52ZXJ0aWNhbFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIGxhYmVsXG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuXG4gICAgLy8gVXBkYXRlIHdvcmQgd3JhcCB3aWR0aCBpZiBuZWVkZWRcbiAgICBpZiAodGhpcy5wcm9wcy53b3JkV3JhcCAmJiB0aGlzLnByb3BzLndvcmRXcmFwV2lkdGggPT09IDApIHtcbiAgICAgIC8vIFVzZSBhdmFpbGFibGUgd2lkdGggbWludXMgcGFkZGluZ1xuICAgICAgY29uc3Qgd3JhcFdpZHRoID0gYXZhaWxhYmxlV2lkdGggLSBwYWRkaW5nLmhvcml6b250YWw7XG4gICAgICB0aGlzLnByb3BzLndvcmRXcmFwV2lkdGggPSB3cmFwV2lkdGg7XG4gICAgICB0aGlzLnRleHRPYmplY3Quc3R5bGUgPSB0aGlzLmdldFRleHRTdHlsZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG5cbiAgICAvLyBIYW5kbGUgJ2ZpbGwnIGNvbnN0cmFpbnRzXG4gICAgbGV0IGZpbmFsV2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICBsZXQgZmluYWxIZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG5cbiAgICBpZiAodGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ2ZpbGwnKSB7XG4gICAgICBmaW5hbFdpZHRoID0gYXZhaWxhYmxlV2lkdGg7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGZpbmFsV2lkdGggPSB0aGlzLmJveE1vZGVsLndpZHRoICsgcGFkZGluZy5ob3Jpem9udGFsO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ2ZpbGwnKSB7XG4gICAgICBmaW5hbEhlaWdodCA9IGF2YWlsYWJsZUhlaWdodDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGZpbmFsSGVpZ2h0ID0gdGhpcy5ib3hNb2RlbC5oZWlnaHQgKyBwYWRkaW5nLnZlcnRpY2FsO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb21wdXRlZCBsYXlvdXRcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gZmluYWxXaWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IGZpbmFsSGVpZ2h0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFggPSBwYWRkaW5nLmxlZnQ7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50WSA9IHBhZGRpbmcudG9wO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFdpZHRoID0gZmluYWxXaWR0aCAtIHBhZGRpbmcuaG9yaXpvbnRhbDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRIZWlnaHQgPSBmaW5hbEhlaWdodCAtIHBhZGRpbmcudmVydGljYWw7XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSBsYWJlbCAocG9zaXRpb25zIHRoZSB0ZXh0IG9iamVjdClcbiAgICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICB0aGlzLnRleHRPYmplY3QucG9zaXRpb24uc2V0KHBhZGRpbmcubGVmdCwgcGFkZGluZy50b3ApO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIHRleHQgY29udGVudFxuICAgKi9cbiAgc2V0VGV4dCh0ZXh0OiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLnRleHQgPSB0ZXh0O1xuICAgIHRoaXMudGV4dE9iamVjdC50ZXh0ID0gdGV4dDtcbiAgICB0aGlzLm1hcmtMYXlvdXREaXJ0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIHRleHQgY29sb3JcbiAgICovXG4gIHNldENvbG9yKGNvbG9yOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLmNvbG9yID0gY29sb3I7XG4gICAgdGhpcy50ZXh0T2JqZWN0LnN0eWxlLmZpbGwgPSBjb2xvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBmb250IHNpemVcbiAgICovXG4gIHNldEZvbnRTaXplKHNpemU6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMucHJvcHMuZm9udFNpemUgPSBzaXplO1xuICAgIHRoaXMudGV4dE9iamVjdC5zdHlsZS5mb250U2l6ZSA9IHNpemU7XG4gICAgdGhpcy5tYXJrTGF5b3V0RGlydHkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IHRleHRcbiAgICovXG4gIGdldFRleHQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy50ZXh0O1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcblxuLyoqXG4gKiA5LXNsaWNlIGNvbmZpZ3VyYXRpb24gZm9yIHNjYWxhYmxlIHNwcml0ZXNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBOaW5lU2xpY2VDb25maWcge1xuICAvKiogV2lkdGggb2YgbGVmdCBlZGdlIHRoYXQgZG9lc24ndCBzY2FsZSAqL1xuICBsZWZ0V2lkdGg6IG51bWJlcjtcbiAgLyoqIEhlaWdodCBvZiB0b3AgZWRnZSB0aGF0IGRvZXNuJ3Qgc2NhbGUgKi9cbiAgdG9wSGVpZ2h0OiBudW1iZXI7XG4gIC8qKiBXaWR0aCBvZiByaWdodCBlZGdlIHRoYXQgZG9lc24ndCBzY2FsZSAqL1xuICByaWdodFdpZHRoOiBudW1iZXI7XG4gIC8qKiBIZWlnaHQgb2YgYm90dG9tIGVkZ2UgdGhhdCBkb2Vzbid0IHNjYWxlICovXG4gIGJvdHRvbUhlaWdodDogbnVtYmVyO1xufVxuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJUGFuZWxcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSVBhbmVsUHJvcHMge1xuICAvKiogQmFja2dyb3VuZCB0ZXh0dXJlICovXG4gIHRleHR1cmU/OiBQSVhJLlRleHR1cmU7XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yIChpZiBubyB0ZXh0dXJlKSAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBCYWNrZ3JvdW5kIGFscGhhICovXG4gIGJhY2tncm91bmRBbHBoYT86IG51bWJlcjtcbiAgLyoqIDktc2xpY2UgY29uZmlndXJhdGlvbiAoaWYgdXNpbmcgdGV4dHVyZSkgKi9cbiAgbmluZVNsaWNlPzogTmluZVNsaWNlQ29uZmlnO1xuICAvKiogRml4ZWQgd2lkdGggKi9cbiAgd2lkdGg/OiBudW1iZXI7XG4gIC8qKiBGaXhlZCBoZWlnaHQgKi9cbiAgaGVpZ2h0PzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyAoaWYgdXNpbmcgc29saWQgY29sb3IpICovXG4gIGJvcmRlclJhZGl1cz86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBIHBhbmVsIGNvbXBvbmVudCB3aXRoIG9wdGlvbmFsIDktc2xpY2UgYmFja2dyb3VuZFxuICogQ2FuIHVzZSBlaXRoZXIgYSB0ZXh0dXJlIG9yIHNvbGlkIGNvbG9yIGJhY2tncm91bmRcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogLy8gV2l0aCB0ZXh0dXJlIGFuZCA5LXNsaWNlXG4gKiBjb25zdCBwYW5lbCA9IG5ldyBVSVBhbmVsKHtcbiAqICAgdGV4dHVyZTogcGFuZWxUZXh0dXJlLFxuICogICBuaW5lU2xpY2U6IHsgbGVmdFdpZHRoOiAxNiwgdG9wSGVpZ2h0OiAxNiwgcmlnaHRXaWR0aDogMTYsIGJvdHRvbUhlaWdodDogMTYgfSxcbiAqICAgd2lkdGg6IDMwMCxcbiAqICAgaGVpZ2h0OiAyMDBcbiAqIH0pO1xuICpcbiAqIC8vIFdpdGggc29saWQgY29sb3JcbiAqIGNvbnN0IHBhbmVsID0gbmV3IFVJUGFuZWwoe1xuICogICBiYWNrZ3JvdW5kQ29sb3I6IDB4MmMzZTUwLFxuICogICB3aWR0aDogMzAwLFxuICogICBoZWlnaHQ6IDIwMCxcbiAqICAgYm9yZGVyUmFkaXVzOiA4XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlQYW5lbCBleHRlbmRzIFVJQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBwcm9wczogVUlQYW5lbFByb3BzO1xuICBwcml2YXRlIGJhY2tncm91bmQ/OiBQSVhJLk5pbmVTbGljZVNwcml0ZSB8IFBJWEkuR3JhcGhpY3M7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJUGFuZWxQcm9wcyA9IHt9LCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIGJhY2tncm91bmRBbHBoYTogcHJvcHMuYmFja2dyb3VuZEFscGhhID8/IDEsXG4gICAgICAuLi5wcm9wc1xuICAgIH07XG5cbiAgICAvLyBTZXQgYm94IG1vZGVsIGRpbWVuc2lvbnMgaWYgcHJvdmlkZWRcbiAgICBpZiAocHJvcHMud2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5ib3hNb2RlbC53aWR0aCA9IHByb3BzLndpZHRoO1xuICAgIH1cbiAgICBpZiAocHJvcHMuaGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID0gcHJvcHMuaGVpZ2h0O1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBiYWNrZ3JvdW5kXG4gICAgdGhpcy5jcmVhdGVCYWNrZ3JvdW5kKCk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyB0aGUgYmFja2dyb3VuZCAoZWl0aGVyIDktc2xpY2Ugc3ByaXRlIG9yIGdyYXBoaWNzKVxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVCYWNrZ3JvdW5kKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLnRleHR1cmUgJiYgdGhpcy5wcm9wcy5uaW5lU2xpY2UpIHtcbiAgICAgIC8vIFVzZSA5LXNsaWNlIHNwcml0ZVxuICAgICAgY29uc3QgeyBsZWZ0V2lkdGgsIHRvcEhlaWdodCwgcmlnaHRXaWR0aCwgYm90dG9tSGVpZ2h0IH0gPSB0aGlzLnByb3BzLm5pbmVTbGljZTtcbiAgICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBQSVhJLk5pbmVTbGljZVNwcml0ZSh7XG4gICAgICAgIHRleHR1cmU6IHRoaXMucHJvcHMudGV4dHVyZSxcbiAgICAgICAgbGVmdFdpZHRoLFxuICAgICAgICB0b3BIZWlnaHQsXG4gICAgICAgIHJpZ2h0V2lkdGgsXG4gICAgICAgIGJvdHRvbUhlaWdodFxuICAgICAgfSk7XG4gICAgICB0aGlzLmJhY2tncm91bmQuYWxwaGEgPSB0aGlzLnByb3BzLmJhY2tncm91bmRBbHBoYSA/PyAxO1xuICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIFVzZSBncmFwaGljcyBmb3Igc29saWQgY29sb3JcbiAgICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgcGFuZWxcbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuXG4gICAgbGV0IGNvbnRlbnRXaWR0aCA9IDA7XG4gICAgbGV0IGNvbnRlbnRIZWlnaHQgPSAwO1xuXG4gICAgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLndpZHRoID09PSAnbnVtYmVyJykge1xuICAgICAgY29udGVudFdpZHRoID0gdGhpcy5ib3hNb2RlbC53aWR0aDtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMud2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29udGVudFdpZHRoID0gdGhpcy5wcm9wcy53aWR0aDtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID09PSAnbnVtYmVyJykge1xuICAgICAgY29udGVudEhlaWdodCA9IHRoaXMuYm94TW9kZWwuaGVpZ2h0O1xuICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5oZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29udGVudEhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogY29udGVudFdpZHRoICsgcGFkZGluZy5ob3Jpem9udGFsLFxuICAgICAgaGVpZ2h0OiBjb250ZW50SGVpZ2h0ICsgcGFkZGluZy52ZXJ0aWNhbFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIHBhbmVsXG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG5cbiAgICAvLyBDYWxjdWxhdGUgZmluYWwgZGltZW5zaW9uc1xuICAgIGxldCBmaW5hbFdpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgbGV0IGZpbmFsSGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgaWYgKHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdmaWxsJykge1xuICAgICAgZmluYWxXaWR0aCA9IGF2YWlsYWJsZVdpZHRoO1xuICAgIH1cbiAgICBpZiAodGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdmaWxsJykge1xuICAgICAgZmluYWxIZWlnaHQgPSBhdmFpbGFibGVIZWlnaHQ7XG4gICAgfVxuXG4gICAgLy8gQXBwbHkgbWF4IGNvbnN0cmFpbnRzXG4gICAgaWYgKHRoaXMuYm94TW9kZWwubWF4V2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgZmluYWxXaWR0aCA9IE1hdGgubWluKGZpbmFsV2lkdGgsIHRoaXMuYm94TW9kZWwubWF4V2lkdGgpO1xuICAgIH1cbiAgICBpZiAodGhpcy5ib3hNb2RlbC5tYXhIZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZmluYWxIZWlnaHQgPSBNYXRoLm1pbihmaW5hbEhlaWdodCwgdGhpcy5ib3hNb2RlbC5tYXhIZWlnaHQpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb21wdXRlZCBsYXlvdXRcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gZmluYWxXaWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IGZpbmFsSGVpZ2h0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFggPSBwYWRkaW5nLmxlZnQ7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50WSA9IHBhZGRpbmcudG9wO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFdpZHRoID0gZmluYWxXaWR0aCAtIHBhZGRpbmcuaG9yaXpvbnRhbDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRIZWlnaHQgPSBmaW5hbEhlaWdodCAtIHBhZGRpbmcudmVydGljYWw7XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSBwYW5lbCBiYWNrZ3JvdW5kXG4gICAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5iYWNrZ3JvdW5kKSByZXR1cm47XG5cbiAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IHRoaXMuY29tcHV0ZWRMYXlvdXQ7XG5cbiAgICBpZiAodGhpcy5iYWNrZ3JvdW5kIGluc3RhbmNlb2YgUElYSS5OaW5lU2xpY2VTcHJpdGUpIHtcbiAgICAgIC8vIFVwZGF0ZSA5LXNsaWNlIHNwcml0ZSBzaXplXG4gICAgICB0aGlzLmJhY2tncm91bmQud2lkdGggPSB3aWR0aDtcbiAgICAgIHRoaXMuYmFja2dyb3VuZC5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgfSBlbHNlIGlmICh0aGlzLmJhY2tncm91bmQgaW5zdGFuY2VvZiBQSVhJLkdyYXBoaWNzKSB7XG4gICAgICAvLyBSZWRyYXcgZ3JhcGhpY3NcbiAgICAgIHRoaXMuYmFja2dyb3VuZC5jbGVhcigpO1xuXG4gICAgICBpZiAodGhpcy5wcm9wcy5ib3JkZXJSYWRpdXMgJiYgdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXMgPiAwKSB7XG4gICAgICAgIHRoaXMuYmFja2dyb3VuZC5yb3VuZFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCwgdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kLnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXMuYmFja2dyb3VuZC5maWxsKHtcbiAgICAgICAgICBjb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICAgICAgYWxwaGE6IHRoaXMucHJvcHMuYmFja2dyb3VuZEFscGhhXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBiYWNrZ3JvdW5kIGNvbG9yIChvbmx5IHdvcmtzIGZvciBzb2xpZCBjb2xvciBwYW5lbHMpXG4gICAqL1xuICBzZXRCYWNrZ3JvdW5kQ29sb3IoY29sb3I6IG51bWJlciwgYWxwaGE6IG51bWJlciA9IDEpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5iYWNrZ3JvdW5kIGluc3RhbmNlb2YgUElYSS5HcmFwaGljcykge1xuICAgICAgdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcbiAgICAgIHRoaXMucHJvcHMuYmFja2dyb3VuZEFscGhhID0gYWxwaGE7XG4gICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSB0ZXh0dXJlIChvbmx5IHdvcmtzIGZvciB0ZXh0dXJlLWJhc2VkIHBhbmVscylcbiAgICovXG4gIHNldFRleHR1cmUodGV4dHVyZTogUElYSS5UZXh0dXJlKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuYmFja2dyb3VuZCBpbnN0YW5jZW9mIFBJWEkuTmluZVNsaWNlU3ByaXRlKSB7XG4gICAgICB0aGlzLmJhY2tncm91bmQudGV4dHVyZSA9IHRleHR1cmU7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcbmltcG9ydCB7IEVkZ2VJbnNldHMgfSBmcm9tICcuLi9jb3JlL2VkZ2UtaW5zZXRzJztcblxuLyoqXG4gKiBQcm9wcyBmb3IgY29uZmlndXJpbmcgYSBVSVNjcm9sbENvbnRhaW5lclxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFVJU2Nyb2xsQ29udGFpbmVyUHJvcHMge1xuICAvKiogV2lkdGggb2YgdGhlIHNjcm9sbCBjb250YWluZXIgKi9cbiAgd2lkdGg6IG51bWJlcjtcbiAgLyoqIEhlaWdodCBvZiB0aGUgc2Nyb2xsIGNvbnRhaW5lciAodmlld3BvcnQgaGVpZ2h0KSAqL1xuICBoZWlnaHQ6IG51bWJlcjtcbiAgLyoqIEJhY2tncm91bmQgY29sb3Igb2YgdGhlIGNvbnRhaW5lciAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgcmFkaXVzICovXG4gIGJvcmRlclJhZGl1cz86IG51bWJlcjtcbiAgLyoqIFNjcm9sbGJhciB3aWR0aCAqL1xuICBzY3JvbGxiYXJXaWR0aD86IG51bWJlcjtcbiAgLyoqIFNjcm9sbGJhciB0cmFjayBjb2xvciAqL1xuICBzY3JvbGxiYXJUcmFja0NvbG9yPzogbnVtYmVyO1xuICAvKiogU2Nyb2xsYmFyIHRodW1iIGNvbG9yICovXG4gIHNjcm9sbGJhclRodW1iQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBTY3JvbGxiYXIgdGh1bWIgaG92ZXIgY29sb3IgKi9cbiAgc2Nyb2xsYmFyVGh1bWJIb3ZlckNvbG9yPzogbnVtYmVyO1xuICAvKiogV2hldGhlciB0byBzaG93IHNjcm9sbGJhciBvbmx5IG9uIGhvdmVyICovXG4gIHNjcm9sbGJhckF1dG9IaWRlPzogYm9vbGVhbjtcbiAgLyoqIFBhZGRpbmcgaW5zaWRlIHRoZSBzY3JvbGwgY29udGFpbmVyICovXG4gIHBhZGRpbmc/OiBFZGdlSW5zZXRzO1xufVxuXG4vKipcbiAqIEEgc2Nyb2xsYWJsZSBjb250YWluZXIgd2l0aCBhIHZpc3VhbCBzY3JvbGxiYXJcbiAqIFN1cHBvcnRzIG1vdXNlIHdoZWVsIHNjcm9sbGluZyBhbmQgZHJhZ2dhYmxlIHNjcm9sbGJhciB0aHVtYlxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBzY3JvbGxDb250YWluZXIgPSBuZXcgVUlTY3JvbGxDb250YWluZXIoe1xuICogICB3aWR0aDogNDAwLFxuICogICBoZWlnaHQ6IDMwMCxcbiAqICAgYmFja2dyb3VuZENvbG9yOiAweGZmZmZmZlxuICogfSk7XG4gKlxuICogLy8gQWRkIGNoaWxkcmVuIHRoYXQgZXhjZWVkIHRoZSB2aWV3cG9ydCBoZWlnaHRcbiAqIHNjcm9sbENvbnRhaW5lci5hZGRDaGlsZChzb21lVUlDb21wb25lbnQpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSVNjcm9sbENvbnRhaW5lciBleHRlbmRzIFVJQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBwcm9wczogUmVxdWlyZWQ8VUlTY3JvbGxDb250YWluZXJQcm9wcz47XG4gIHByaXZhdGUgYmFja2dyb3VuZDogUElYSS5HcmFwaGljcztcbiAgcHJpdmF0ZSBjb250ZW50Q29udGFpbmVyOiBQSVhJLkNvbnRhaW5lcjtcbiAgcHJpdmF0ZSBjb250ZW50TWFzazogUElYSS5HcmFwaGljcztcbiAgcHJpdmF0ZSBzY3JvbGxiYXJUcmFjazogUElYSS5HcmFwaGljcztcbiAgcHJpdmF0ZSBzY3JvbGxiYXJUaHVtYjogUElYSS5HcmFwaGljcztcblxuICAvLyBQdWJsaWMgY2hpbGRyZW4gYXJyYXkgZm9yIGZvY3VzIG1hbmFnZXIgZGlzY292ZXJ5XG4gIHB1YmxpYyBjaGlsZHJlbjogVUlDb21wb25lbnRbXSA9IFtdO1xuXG4gIHByaXZhdGUgc2Nyb2xsWTogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBtYXhTY3JvbGxZOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGNvbnRlbnRIZWlnaHQ6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgaXNEcmFnZ2luZzogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIGRyYWdTdGFydFk6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgZHJhZ1N0YXJ0U2Nyb2xsWTogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBpc0hvdmVyaW5nVGh1bWI6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlTY3JvbGxDb250YWluZXJQcm9wcywgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICB3aWR0aDogcHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHByb3BzLmhlaWdodCxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogcHJvcHMuYmFja2dyb3VuZENvbG9yID8/IDB4ZmZmZmZmLFxuICAgICAgYm9yZGVyUmFkaXVzOiBwcm9wcy5ib3JkZXJSYWRpdXMgPz8gMCxcbiAgICAgIHNjcm9sbGJhcldpZHRoOiBwcm9wcy5zY3JvbGxiYXJXaWR0aCA/PyAxMixcbiAgICAgIHNjcm9sbGJhclRyYWNrQ29sb3I6IHByb3BzLnNjcm9sbGJhclRyYWNrQ29sb3IgPz8gMHhlMGUwZTAsXG4gICAgICBzY3JvbGxiYXJUaHVtYkNvbG9yOiBwcm9wcy5zY3JvbGxiYXJUaHVtYkNvbG9yID8/IDB4ODg4ODg4LFxuICAgICAgc2Nyb2xsYmFyVGh1bWJIb3ZlckNvbG9yOiBwcm9wcy5zY3JvbGxiYXJUaHVtYkhvdmVyQ29sb3IgPz8gMHg1NTU1NTUsXG4gICAgICBzY3JvbGxiYXJBdXRvSGlkZTogcHJvcHMuc2Nyb2xsYmFyQXV0b0hpZGUgPz8gZmFsc2UsXG4gICAgICBwYWRkaW5nOiBwcm9wcy5wYWRkaW5nID8/IEVkZ2VJbnNldHMuYWxsKDApXG4gICAgfTtcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9uc1xuICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSB0aGlzLnByb3BzLndpZHRoO1xuICAgIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG5cbiAgICAvLyBDcmVhdGUgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy51cGRhdGVCYWNrZ3JvdW5kKCk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kKTtcblxuICAgIC8vIENyZWF0ZSBjb250ZW50IGNvbnRhaW5lclxuICAgIHRoaXMuY29udGVudENvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgIHRoaXMuY29udGVudENvbnRhaW5lci54ID0gdGhpcy5wcm9wcy5wYWRkaW5nLmxlZnQ7XG4gICAgdGhpcy5jb250ZW50Q29udGFpbmVyLnkgPSB0aGlzLnByb3BzLnBhZGRpbmcudG9wO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuY29udGVudENvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgbWFzayBmb3IgY29udGVudFxuICAgIHRoaXMuY29udGVudE1hc2sgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMudXBkYXRlTWFzaygpO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuY29udGVudE1hc2spO1xuICAgIHRoaXMuY29udGVudENvbnRhaW5lci5tYXNrID0gdGhpcy5jb250ZW50TWFzaztcblxuICAgIC8vIENyZWF0ZSBzY3JvbGxiYXIgdHJhY2tcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2suY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuc2Nyb2xsYmFyVHJhY2spO1xuXG4gICAgLy8gQ3JlYXRlIHNjcm9sbGJhciB0aHVtYlxuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5zY3JvbGxiYXJUaHVtYik7XG5cbiAgICAvLyBTZXR1cCBpbnRlcmFjdGl2aXR5XG4gICAgdGhpcy5zZXR1cEludGVyYWN0aXZpdHkoKTtcblxuICAgIC8vIEluaXRpYWwgc2Nyb2xsYmFyIHVwZGF0ZVxuICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgYmFja2dyb3VuZCBncmFwaGljc1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVCYWNrZ3JvdW5kKCk6IHZvaWQge1xuICAgIHRoaXMuYmFja2dyb3VuZC5jbGVhcigpO1xuICAgIHRoaXMuYmFja2dyb3VuZC5yb3VuZFJlY3QoXG4gICAgICAwLFxuICAgICAgMCxcbiAgICAgIHRoaXMucHJvcHMud2lkdGgsXG4gICAgICB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgKTtcbiAgICB0aGlzLmJhY2tncm91bmQuZmlsbCh7IGNvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBjb250ZW50IG1hc2tcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlTWFzaygpOiB2b2lkIHtcbiAgICBjb25zdCBjb250ZW50V2lkdGggPSB0aGlzLnByb3BzLndpZHRoIC0gdGhpcy5wcm9wcy5wYWRkaW5nLmxlZnQgLSB0aGlzLnByb3BzLnBhZGRpbmcucmlnaHQgLSB0aGlzLnByb3BzLnNjcm9sbGJhcldpZHRoO1xuICAgIGNvbnN0IGNvbnRlbnRIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodCAtIHRoaXMucHJvcHMucGFkZGluZy50b3AgLSB0aGlzLnByb3BzLnBhZGRpbmcuYm90dG9tO1xuXG4gICAgdGhpcy5jb250ZW50TWFzay5jbGVhcigpO1xuICAgIHRoaXMuY29udGVudE1hc2sucmVjdChcbiAgICAgIHRoaXMucHJvcHMucGFkZGluZy5sZWZ0LFxuICAgICAgdGhpcy5wcm9wcy5wYWRkaW5nLnRvcCxcbiAgICAgIGNvbnRlbnRXaWR0aCxcbiAgICAgIGNvbnRlbnRIZWlnaHRcbiAgICApO1xuICAgIHRoaXMuY29udGVudE1hc2suZmlsbCh7IGNvbG9yOiAweGZmZmZmZiB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHVwIG1vdXNlL3doZWVsIGV2ZW50IGhhbmRsZXJzXG4gICAqL1xuICBwcml2YXRlIHNldHVwSW50ZXJhY3Rpdml0eSgpOiB2b2lkIHtcbiAgICAvLyBNb3VzZSB3aGVlbCBzY3JvbGxpbmdcbiAgICB0aGlzLmNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICB0aGlzLmNvbnRhaW5lci5vbignd2hlZWwnLCB0aGlzLmhhbmRsZVdoZWVsLmJpbmQodGhpcykpO1xuXG4gICAgLy8gU2Nyb2xsYmFyIHRodW1iIGRyYWdnaW5nXG4gICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5vbigncG9pbnRlcmRvd24nLCB0aGlzLmhhbmRsZVRodW1iUG9pbnRlckRvd24uYmluZCh0aGlzKSk7XG4gICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5vbigncG9pbnRlcm92ZXInLCAoKSA9PiB7XG4gICAgICB0aGlzLmlzSG92ZXJpbmdUaHVtYiA9IHRydWU7XG4gICAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICAgIH0pO1xuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIub24oJ3BvaW50ZXJvdXQnLCAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuaXNEcmFnZ2luZykge1xuICAgICAgICB0aGlzLmlzSG92ZXJpbmdUaHVtYiA9IGZhbHNlO1xuICAgICAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gVHJhY2sgY2xpY2sgZm9yIGp1bXBpbmdcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrLm9uKCdwb2ludGVyZG93bicsIHRoaXMuaGFuZGxlVHJhY2tQb2ludGVyRG93bi5iaW5kKHRoaXMpKTtcblxuICAgIC8vIEdsb2JhbCBwb2ludGVyIGV2ZW50cyBmb3IgZHJhZ2dpbmdcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIHRoaXMuaGFuZGxlR2xvYmFsUG9pbnRlck1vdmUuYmluZCh0aGlzKSk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgdGhpcy5oYW5kbGVHbG9iYWxQb2ludGVyVXAuYmluZCh0aGlzKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgbW91c2Ugd2hlZWwgZXZlbnRzXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVdoZWVsKGU6IFBJWEkuRmVkZXJhdGVkV2hlZWxFdmVudCk6IHZvaWQge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IGRlbHRhID0gZS5kZWx0YVk7XG4gICAgdGhpcy5zY3JvbGxZICs9IGRlbHRhO1xuICAgIHRoaXMuc2Nyb2xsWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMubWF4U2Nyb2xsWSwgdGhpcy5zY3JvbGxZKSk7XG5cbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRQb3NpdGlvbigpO1xuICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBwb2ludGVyIGRvd24gb24gc2Nyb2xsYmFyIHRodW1iXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVRodW1iUG9pbnRlckRvd24oZTogUElYSS5GZWRlcmF0ZWRQb2ludGVyRXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLmlzRHJhZ2dpbmcgPSB0cnVlO1xuICAgIHRoaXMuZHJhZ1N0YXJ0WSA9IGUuZ2xvYmFsWTtcbiAgICB0aGlzLmRyYWdTdGFydFNjcm9sbFkgPSB0aGlzLnNjcm9sbFk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIHBvaW50ZXIgZG93biBvbiBzY3JvbGxiYXIgdHJhY2tcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlVHJhY2tQb2ludGVyRG93bihlOiBQSVhJLkZlZGVyYXRlZFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGxvY2FsWSA9IGUuZ2xvYmFsWSAtIHRoaXMuY29udGFpbmVyLndvcmxkVHJhbnNmb3JtLnR5O1xuICAgIGNvbnN0IHRodW1iSGVpZ2h0ID0gdGhpcy5nZXRUaHVtYkhlaWdodCgpO1xuICAgIGNvbnN0IHRyYWNrVG9wID0gMDtcbiAgICBjb25zdCB0cmFja0JvdHRvbSA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuXG4gICAgLy8gQ2FsY3VsYXRlIHRhcmdldCBzY3JvbGwgcG9zaXRpb25cbiAgICBjb25zdCBjbGlja1JhdGlvID0gKGxvY2FsWSAtIHRyYWNrVG9wKSAvICh0cmFja0JvdHRvbSAtIHRyYWNrVG9wKTtcbiAgICB0aGlzLnNjcm9sbFkgPSBjbGlja1JhdGlvICogdGhpcy5tYXhTY3JvbGxZO1xuICAgIHRoaXMuc2Nyb2xsWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMubWF4U2Nyb2xsWSwgdGhpcy5zY3JvbGxZKSk7XG5cbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRQb3NpdGlvbigpO1xuICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBnbG9iYWwgcG9pbnRlciBtb3ZlIGZvciB0aHVtYiBkcmFnZ2luZ1xuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVHbG9iYWxQb2ludGVyTW92ZShlOiBQb2ludGVyRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuaXNEcmFnZ2luZykgcmV0dXJuO1xuXG4gICAgY29uc3QgZGVsdGFZID0gZS5jbGllbnRZIC0gdGhpcy5kcmFnU3RhcnRZO1xuICAgIGNvbnN0IHRyYWNrSGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG4gICAgY29uc3QgdGh1bWJIZWlnaHQgPSB0aGlzLmdldFRodW1iSGVpZ2h0KCk7XG4gICAgY29uc3Qgc2Nyb2xsYWJsZVRyYWNrSGVpZ2h0ID0gdHJhY2tIZWlnaHQgLSB0aHVtYkhlaWdodDtcblxuICAgIGlmIChzY3JvbGxhYmxlVHJhY2tIZWlnaHQgPD0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3Qgc2Nyb2xsRGVsdGEgPSAoZGVsdGFZIC8gc2Nyb2xsYWJsZVRyYWNrSGVpZ2h0KSAqIHRoaXMubWF4U2Nyb2xsWTtcbiAgICB0aGlzLnNjcm9sbFkgPSB0aGlzLmRyYWdTdGFydFNjcm9sbFkgKyBzY3JvbGxEZWx0YTtcbiAgICB0aGlzLnNjcm9sbFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbih0aGlzLm1heFNjcm9sbFksIHRoaXMuc2Nyb2xsWSkpO1xuXG4gICAgdGhpcy51cGRhdGVDb250ZW50UG9zaXRpb24oKTtcbiAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgZ2xvYmFsIHBvaW50ZXIgdXAgdG8gZW5kIGRyYWdnaW5nXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZUdsb2JhbFBvaW50ZXJVcCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5pc0RyYWdnaW5nKSB7XG4gICAgICB0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgIGlmICghdGhpcy5pc0hvdmVyaW5nVGh1bWIpIHtcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgY29udGVudCBwb3NpdGlvbiBiYXNlZCBvbiBzY3JvbGxcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlQ29udGVudFBvc2l0aW9uKCk6IHZvaWQge1xuICAgIHRoaXMuY29udGVudENvbnRhaW5lci55ID0gdGhpcy5wcm9wcy5wYWRkaW5nLnRvcCAtIHRoaXMuc2Nyb2xsWTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGVzIHRoZSB0aHVtYiBoZWlnaHQgYmFzZWQgb24gY29udGVudCByYXRpb1xuICAgKi9cbiAgcHJpdmF0ZSBnZXRUaHVtYkhlaWdodCgpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLmNvbnRlbnRIZWlnaHQgPD0gMCkgcmV0dXJuIDA7XG5cbiAgICBjb25zdCB2aWV3cG9ydEhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0IC0gdGhpcy5wcm9wcy5wYWRkaW5nLnRvcCAtIHRoaXMucHJvcHMucGFkZGluZy5ib3R0b207XG4gICAgY29uc3QgcmF0aW8gPSB2aWV3cG9ydEhlaWdodCAvIHRoaXMuY29udGVudEhlaWdodDtcbiAgICBjb25zdCB0aHVtYkhlaWdodCA9IE1hdGgubWF4KDMwLCB0aGlzLnByb3BzLmhlaWdodCAqIHJhdGlvKTtcblxuICAgIHJldHVybiBNYXRoLm1pbih0aHVtYkhlaWdodCwgdGhpcy5wcm9wcy5oZWlnaHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHRodW1iIFkgcG9zaXRpb25cbiAgICovXG4gIHByaXZhdGUgZ2V0VGh1bWJZKCk6IG51bWJlciB7XG4gICAgaWYgKHRoaXMubWF4U2Nyb2xsWSA8PSAwKSByZXR1cm4gMDtcblxuICAgIGNvbnN0IHRyYWNrSGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG4gICAgY29uc3QgdGh1bWJIZWlnaHQgPSB0aGlzLmdldFRodW1iSGVpZ2h0KCk7XG4gICAgY29uc3Qgc2Nyb2xsYWJsZVRyYWNrSGVpZ2h0ID0gdHJhY2tIZWlnaHQgLSB0aHVtYkhlaWdodDtcblxuICAgIGNvbnN0IHNjcm9sbFJhdGlvID0gdGhpcy5zY3JvbGxZIC8gdGhpcy5tYXhTY3JvbGxZO1xuICAgIHJldHVybiBzY3JvbGxSYXRpbyAqIHNjcm9sbGFibGVUcmFja0hlaWdodDtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBzY3JvbGxiYXIgYXBwZWFyYW5jZVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVTY3JvbGxiYXIoKTogdm9pZCB7XG4gICAgY29uc3QgdHJhY2tYID0gdGhpcy5wcm9wcy53aWR0aCAtIHRoaXMucHJvcHMuc2Nyb2xsYmFyV2lkdGg7XG4gICAgY29uc3QgdHJhY2tXaWR0aCA9IHRoaXMucHJvcHMuc2Nyb2xsYmFyV2lkdGg7XG4gICAgY29uc3QgdHJhY2tIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcblxuICAgIC8vIFVwZGF0ZSB0cmFja1xuICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2suY2xlYXIoKTtcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrLnJlY3QodHJhY2tYLCAwLCB0cmFja1dpZHRoLCB0cmFja0hlaWdodCk7XG4gICAgdGhpcy5zY3JvbGxiYXJUcmFjay5maWxsKHsgY29sb3I6IHRoaXMucHJvcHMuc2Nyb2xsYmFyVHJhY2tDb2xvciB9KTtcblxuICAgIC8vIFVwZGF0ZSB0aHVtYlxuICAgIGNvbnN0IHRodW1iSGVpZ2h0ID0gdGhpcy5nZXRUaHVtYkhlaWdodCgpO1xuICAgIGNvbnN0IHRodW1iWSA9IHRoaXMuZ2V0VGh1bWJZKCk7XG4gICAgY29uc3QgdGh1bWJDb2xvciA9ICh0aGlzLmlzSG92ZXJpbmdUaHVtYiB8fCB0aGlzLmlzRHJhZ2dpbmcpXG4gICAgICA/IHRoaXMucHJvcHMuc2Nyb2xsYmFyVGh1bWJIb3ZlckNvbG9yXG4gICAgICA6IHRoaXMucHJvcHMuc2Nyb2xsYmFyVGh1bWJDb2xvcjtcblxuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIuY2xlYXIoKTtcblxuICAgIC8vIE9ubHkgc2hvdyB0aHVtYiBpZiBjb250ZW50IGlzIHNjcm9sbGFibGVcbiAgICBpZiAodGhpcy5tYXhTY3JvbGxZID4gMCkge1xuICAgICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5yb3VuZFJlY3QoXG4gICAgICAgIHRyYWNrWCArIDIsXG4gICAgICAgIHRodW1iWSArIDIsXG4gICAgICAgIHRyYWNrV2lkdGggLSA0LFxuICAgICAgICB0aHVtYkhlaWdodCAtIDQsXG4gICAgICAgIDRcbiAgICAgICk7XG4gICAgICB0aGlzLnNjcm9sbGJhclRodW1iLmZpbGwoeyBjb2xvcjogdGh1bWJDb2xvciB9KTtcbiAgICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIudmlzaWJsZSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIudmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8vIEhhbmRsZSBhdXRvLWhpZGVcbiAgICBpZiAodGhpcy5wcm9wcy5zY3JvbGxiYXJBdXRvSGlkZSAmJiAhdGhpcy5pc0RyYWdnaW5nICYmICF0aGlzLmlzSG92ZXJpbmdUaHVtYikge1xuICAgICAgdGhpcy5zY3JvbGxiYXJUcmFjay5hbHBoYSA9IDA7XG4gICAgICB0aGlzLnNjcm9sbGJhclRodW1iLmFscGhhID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zY3JvbGxiYXJUcmFjay5hbHBoYSA9IDE7XG4gICAgICB0aGlzLnNjcm9sbGJhclRodW1iLmFscGhhID0gMTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjYWxjdWxhdGVzIGNvbnRlbnQgaGVpZ2h0IGFuZCBtYXggc2Nyb2xsXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZUNvbnRlbnRCb3VuZHMoKTogdm9pZCB7XG4gICAgLy8gQ2FsY3VsYXRlIGNvbnRlbnQgaGVpZ2h0IGZyb20gY2hpbGRyZW4ncyBjb21wdXRlZCBsYXlvdXRzXG4gICAgbGV0IG1heEhlaWdodCA9IDA7XG5cbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQ6IGFueSkgPT4ge1xuICAgICAgY29uc3QgY2hpbGRCb3R0b20gPSBjaGlsZC55ICsgY2hpbGQuaGVpZ2h0O1xuICAgICAgaWYgKGNoaWxkQm90dG9tID4gbWF4SGVpZ2h0KSB7XG4gICAgICAgIG1heEhlaWdodCA9IGNoaWxkQm90dG9tO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5jb250ZW50SGVpZ2h0ID0gbWF4SGVpZ2h0O1xuXG4gICAgY29uc3Qgdmlld3BvcnRIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodCAtIHRoaXMucHJvcHMucGFkZGluZy50b3AgLSB0aGlzLnByb3BzLnBhZGRpbmcuYm90dG9tO1xuICAgIHRoaXMubWF4U2Nyb2xsWSA9IE1hdGgubWF4KDAsIHRoaXMuY29udGVudEhlaWdodCAtIHZpZXdwb3J0SGVpZ2h0KTtcblxuICAgIC8vIENsYW1wIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uXG4gICAgdGhpcy5zY3JvbGxZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4odGhpcy5tYXhTY3JvbGxZLCB0aGlzLnNjcm9sbFkpKTtcblxuICAgIHRoaXMudXBkYXRlQ29udGVudFBvc2l0aW9uKCk7XG4gICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgY2hpbGQgdG8gdGhlIHNjcm9sbGFibGUgY29udGVudFxuICAgKi9cbiAgYWRkQ2hpbGQoY2hpbGQ6IFVJQ29tcG9uZW50KTogdm9pZCB7XG4gICAgLy8gU2V0IHBhcmVudCByZWZlcmVuY2UgZm9yIHNjcm9sbC1pbnRvLXZpZXcgc3VwcG9ydFxuICAgIGNoaWxkLnBhcmVudCA9IHRoaXMgYXMgYW55O1xuXG4gICAgLy8gVHJhY2sgY2hpbGQgZm9yIGZvY3VzIG1hbmFnZXIgZGlzY292ZXJ5XG4gICAgdGhpcy5jaGlsZHJlbi5wdXNoKGNoaWxkKTtcblxuICAgIHRoaXMuY29udGVudENvbnRhaW5lci5hZGRDaGlsZChjaGlsZC5jb250YWluZXIpO1xuXG4gICAgLy8gTGF5b3V0IHRoZSBjaGlsZCB3aXRoIGF2YWlsYWJsZSBjb250ZW50IHdpZHRoXG4gICAgY29uc3QgY29udGVudFdpZHRoID0gdGhpcy5wcm9wcy53aWR0aCAtIHRoaXMucHJvcHMucGFkZGluZy5sZWZ0IC0gdGhpcy5wcm9wcy5wYWRkaW5nLnJpZ2h0IC0gdGhpcy5wcm9wcy5zY3JvbGxiYXJXaWR0aDtcbiAgICBjb25zdCBjb250ZW50SGVpZ2h0ID0gOTk5OTk5OyAvLyBBbGxvdyB1bmxpbWl0ZWQgaGVpZ2h0IGZvciBzY3JvbGxpbmdcbiAgICBjaGlsZC5sYXlvdXQoY29udGVudFdpZHRoLCBjb250ZW50SGVpZ2h0KTtcblxuICAgIHRoaXMudXBkYXRlQ29udGVudEJvdW5kcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgYSBjaGlsZCBmcm9tIHRoZSBzY3JvbGxhYmxlIGNvbnRlbnRcbiAgICovXG4gIHJlbW92ZUNoaWxkKGNoaWxkOiBVSUNvbXBvbmVudCk6IHZvaWQge1xuICAgIGNoaWxkLnBhcmVudCA9IHVuZGVmaW5lZDtcblxuICAgIC8vIFJlbW92ZSBmcm9tIGNoaWxkcmVuIHRyYWNraW5nXG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmNoaWxkcmVuLmluZGV4T2YoY2hpbGQpO1xuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIHRoaXMuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG5cbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIucmVtb3ZlQ2hpbGQoY2hpbGQuY29udGFpbmVyKTtcbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRCb3VuZHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRvIGEgc3BlY2lmaWMgWSBwb3NpdGlvblxuICAgKi9cbiAgc2Nyb2xsVG8oeTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5zY3JvbGxZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4odGhpcy5tYXhTY3JvbGxZLCB5KSk7XG4gICAgdGhpcy51cGRhdGVDb250ZW50UG9zaXRpb24oKTtcbiAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNjcm9sbHMgdG8gdGhlIHRvcFxuICAgKi9cbiAgc2Nyb2xsVG9Ub3AoKTogdm9pZCB7XG4gICAgdGhpcy5zY3JvbGxUbygwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRvIHRoZSBib3R0b21cbiAgICovXG4gIHNjcm9sbFRvQm90dG9tKCk6IHZvaWQge1xuICAgIHRoaXMuc2Nyb2xsVG8odGhpcy5tYXhTY3JvbGxZKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IHNjcm9sbCBwb3NpdGlvblxuICAgKi9cbiAgZ2V0U2Nyb2xsWSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnNjcm9sbFk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgbWF4aW11bSBzY3JvbGwgcG9zaXRpb25cbiAgICovXG4gIGdldE1heFNjcm9sbFkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5tYXhTY3JvbGxZO1xuICB9XG5cbiAgLyoqXG4gICAqIFNjcm9sbHMgdG8gbWFrZSBhIGNoaWxkIGNvbXBvbmVudCB2aXNpYmxlXG4gICAqL1xuICBzY3JvbGxUb0NvbXBvbmVudChjb21wb25lbnQ6IFVJQ29tcG9uZW50KTogdm9pZCB7XG4gICAgY29uc3QgY29tcG9uZW50Qm91bmRzID0gY29tcG9uZW50LmdldEdsb2JhbEJvdW5kcygpO1xuICAgIGNvbnN0IGNvbnRhaW5lckJvdW5kcyA9IHRoaXMuZ2V0R2xvYmFsQm91bmRzKCk7XG5cbiAgICAvLyBDYWxjdWxhdGUgY29tcG9uZW50IHBvc2l0aW9uIHJlbGF0aXZlIHRvIHNjcm9sbCBjb250YWluZXIncyBjb250ZW50IGFyZWFcbiAgICBjb25zdCByZWxhdGl2ZVkgPSBjb21wb25lbnRCb3VuZHMueSAtIGNvbnRhaW5lckJvdW5kcy55IC0gdGhpcy5wcm9wcy5wYWRkaW5nLnRvcCArIHRoaXMuc2Nyb2xsWTtcbiAgICBjb25zdCB2aWV3cG9ydEhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0IC0gdGhpcy5wcm9wcy5wYWRkaW5nLnRvcCAtIHRoaXMucHJvcHMucGFkZGluZy5ib3R0b207XG5cbiAgICAvLyBDaGVjayBpZiBjb21wb25lbnQgaXMgYWJvdmUgdmlld3BvcnRcbiAgICBpZiAocmVsYXRpdmVZIDwgdGhpcy5zY3JvbGxZKSB7XG4gICAgICAvLyBTY3JvbGwgdXAgdG8gc2hvdyBjb21wb25lbnQgYXQgdG9wXG4gICAgICB0aGlzLnNjcm9sbFRvKHJlbGF0aXZlWSk7XG4gICAgfVxuICAgIC8vIENoZWNrIGlmIGNvbXBvbmVudCBpcyBiZWxvdyB2aWV3cG9ydFxuICAgIGVsc2UgaWYgKHJlbGF0aXZlWSArIGNvbXBvbmVudEJvdW5kcy5oZWlnaHQgPiB0aGlzLnNjcm9sbFkgKyB2aWV3cG9ydEhlaWdodCkge1xuICAgICAgLy8gU2Nyb2xsIGRvd24gdG8gc2hvdyBjb21wb25lbnQgYXQgYm90dG9tXG4gICAgICBjb25zdCB0YXJnZXRTY3JvbGwgPSByZWxhdGl2ZVkgKyBjb21wb25lbnRCb3VuZHMuaGVpZ2h0IC0gdmlld3BvcnRIZWlnaHQ7XG4gICAgICB0aGlzLnNjcm9sbFRvKHRhcmdldFNjcm9sbCk7XG4gICAgfVxuICAgIC8vIENvbXBvbmVudCBpcyBhbHJlYWR5IHZpc2libGUsIG5vIG5lZWQgdG8gc2Nyb2xsXG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgdGhlIHNpemUgbmVlZGVkIGZvciB0aGlzIGNvbnRhaW5lclxuICAgKi9cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHRcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGxheW91dCBmb3IgdGhpcyBjb250YWluZXJcbiAgICovXG4gIGxheW91dChhdmFpbGFibGVXaWR0aDogbnVtYmVyLCBhdmFpbGFibGVIZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG5cbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG5cbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRCb3VuZHMoKTtcbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSBjb250YWluZXJcbiAgICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgLy8gUmVuZGVyaW5nIGhhbmRsZWQgYnkgYmFja2dyb3VuZCwgY29udGVudCwgbWFzaywgYW5kIHNjcm9sbGJhclxuICB9XG5cbiAgLyoqXG4gICAqIENsZWFudXAgd2hlbiBkZXN0cm95aW5nXG4gICAqL1xuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJtb3ZlJywgdGhpcy5oYW5kbGVHbG9iYWxQb2ludGVyTW92ZS5iaW5kKHRoaXMpKTtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCB0aGlzLmhhbmRsZUdsb2JhbFBvaW50ZXJVcC5iaW5kKHRoaXMpKTtcbiAgICB9XG4gICAgc3VwZXIuZGVzdHJveSgpO1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcbmltcG9ydCB7IFVJUGFuZWwgfSBmcm9tICcuL3VpLXBhbmVsJztcbmltcG9ydCB7IFVJTGFiZWwgfSBmcm9tICcuL3VpLWxhYmVsJztcbmltcG9ydCB7IEVkZ2VJbnNldHMgfSBmcm9tICcuLi9jb3JlL2VkZ2UtaW5zZXRzJztcblxuLyoqXG4gKiBPcHRpb24gc3RydWN0dXJlIGZvciBTZWxlY3QgY29tcG9uZW50XG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU2VsZWN0T3B0aW9uIHtcbiAgLyoqIERpc3BsYXkgdGV4dCBmb3IgdGhlIG9wdGlvbiAqL1xuICBsYWJlbDogc3RyaW5nO1xuICAvKiogVGhlIGFjdHVhbCB2YWx1ZSAqL1xuICB2YWx1ZTogYW55O1xuICAvKiogV2hldGhlciB0aGlzIG9wdGlvbiBpcyBkaXNhYmxlZCAqL1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG59XG5cbi8qKlxuICogUHJvcHMgZm9yIGNvbmZpZ3VyaW5nIGEgVUlTZWxlY3RcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSVNlbGVjdFByb3BzIHtcbiAgLyoqIEFycmF5IG9mIG9wdGlvbnMgKi9cbiAgb3B0aW9uczogU2VsZWN0T3B0aW9uW107XG4gIC8qKiBDdXJyZW50IHNlbGVjdGVkIHZhbHVlIChjb250cm9sbGVkKSAqL1xuICB2YWx1ZT86IGFueTtcbiAgLyoqIERlZmF1bHQgc2VsZWN0ZWQgdmFsdWUgKHVuY29udHJvbGxlZCkgKi9cbiAgZGVmYXVsdFZhbHVlPzogYW55O1xuICAvKiogQ2hhbmdlIGNhbGxiYWNrICovXG4gIG9uQ2hhbmdlPzogKHZhbHVlOiBhbnkpID0+IHZvaWQ7XG4gIC8qKiBXaWR0aCBvZiB0aGUgc2VsZWN0ICovXG4gIHdpZHRoPzogbnVtYmVyO1xuICAvKiogSGVpZ2h0IG9mIHRoZSBzZWxlY3QgKi9cbiAgaGVpZ2h0PzogbnVtYmVyO1xuICAvKiogUGxhY2Vob2xkZXIgdGV4dCB3aGVuIG5vdGhpbmcgc2VsZWN0ZWQgKi9cbiAgcGxhY2Vob2xkZXI/OiBzdHJpbmc7XG4gIC8qKiBXaGV0aGVyIHRoZSBzZWxlY3QgaXMgZGlzYWJsZWQgKi9cbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICAvKiogQmFja2dyb3VuZCBjb2xvciAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBUZXh0IGNvbG9yICovXG4gIHRleHRDb2xvcj86IG51bWJlcjtcbiAgLyoqIEJvcmRlciByYWRpdXMgKi9cbiAgYm9yZGVyUmFkaXVzPzogbnVtYmVyO1xufVxuXG4vKipcbiAqIEEgc2VsZWN0L2Ryb3Bkb3duIGNvbXBvbmVudCB3aXRoIG9wdGlvbnNcbiAqIEZvbGxvd3MgQW50IERlc2lnbidzIGRhdGEtZHJpdmVuIHBhdHRlcm5cbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3Qgc2VsZWN0ID0gbmV3IFVJU2VsZWN0KHtcbiAqICAgb3B0aW9uczogW1xuICogICAgIHsgbGFiZWw6ICdPcHRpb24gMScsIHZhbHVlOiAxIH0sXG4gKiAgICAgeyBsYWJlbDogJ09wdGlvbiAyJywgdmFsdWU6IDIgfSxcbiAqICAgICB7IGxhYmVsOiAnT3B0aW9uIDMnLCB2YWx1ZTogMyB9XG4gKiAgIF0sXG4gKiAgIHBsYWNlaG9sZGVyOiAnQ2hvb3NlIGFuIG9wdGlvbicsXG4gKiAgIG9uQ2hhbmdlOiAodmFsdWUpID0+IGNvbnNvbGUubG9nKCdTZWxlY3RlZDonLCB2YWx1ZSlcbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSVNlbGVjdCBleHRlbmRzIFVJQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBwcm9wczogUmVxdWlyZWQ8T21pdDxVSVNlbGVjdFByb3BzLCAnb25DaGFuZ2UnIHwgJ3ZhbHVlJyB8ICdkZWZhdWx0VmFsdWUnPj47XG4gIHByaXZhdGUgb25DaGFuZ2U/OiAodmFsdWU6IGFueSkgPT4gdm9pZDtcblxuICBwcml2YXRlIHNlbGVjdGVkVmFsdWU6IGFueTtcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kOiBVSVBhbmVsO1xuICBwcml2YXRlIGxhYmVsOiBVSUxhYmVsO1xuICBwcml2YXRlIGRyb3Bkb3duQ29udGFpbmVyPzogUElYSS5Db250YWluZXI7XG4gIHByaXZhdGUgZHJvcGRvd25QYW5lbD86IFVJUGFuZWw7XG4gIHByaXZhdGUgb3B0aW9uTGFiZWxzOiBVSUxhYmVsW10gPSBbXTtcbiAgcHJpdmF0ZSBpc09wZW46IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcml2YXRlIGhvdmVyQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBzZWxlY3RlZENvbG9yOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJU2VsZWN0UHJvcHMsIGJveE1vZGVsPzogUGFydGlhbDxCb3hNb2RlbD4pIHtcbiAgICBzdXBlcihib3hNb2RlbCk7XG5cbiAgICB0aGlzLnByb3BzID0ge1xuICAgICAgb3B0aW9uczogcHJvcHMub3B0aW9ucyA/PyBbXSxcbiAgICAgIHBsYWNlaG9sZGVyOiBwcm9wcy5wbGFjZWhvbGRlciA/PyAnU2VsZWN0Li4uJyxcbiAgICAgIHdpZHRoOiBwcm9wcy53aWR0aCA/PyAyMDAsXG4gICAgICBoZWlnaHQ6IHByb3BzLmhlaWdodCA/PyAzNixcbiAgICAgIGRpc2FibGVkOiBwcm9wcy5kaXNhYmxlZCA/PyBmYWxzZSxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogcHJvcHMuYmFja2dyb3VuZENvbG9yID8/IDB4ZmZmZmZmLFxuICAgICAgdGV4dENvbG9yOiBwcm9wcy50ZXh0Q29sb3IgPz8gMHgwMDAwMDAsXG4gICAgICBib3JkZXJSYWRpdXM6IHByb3BzLmJvcmRlclJhZGl1cyA/PyA0XG4gICAgfTtcblxuICAgIHRoaXMub25DaGFuZ2UgPSBwcm9wcy5vbkNoYW5nZTtcbiAgICB0aGlzLnNlbGVjdGVkVmFsdWUgPSBwcm9wcy52YWx1ZSA/PyBwcm9wcy5kZWZhdWx0VmFsdWU7XG5cbiAgICAvLyBDYWxjdWxhdGUgY29sb3JzXG4gICAgdGhpcy5ob3ZlckNvbG9yID0gdGhpcy5kYXJrZW5Db2xvcih0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciwgMC45NSk7XG4gICAgdGhpcy5zZWxlY3RlZENvbG9yID0gdGhpcy5kYXJrZW5Db2xvcih0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciwgMC45KTtcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9uc1xuICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSB0aGlzLnByb3BzLndpZHRoO1xuICAgIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG5cbiAgICAvLyBDcmVhdGUgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kLmNvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgbGFiZWwgZm9yIHNlbGVjdGVkIHZhbHVlXG4gICAgY29uc3QgZGlzcGxheVRleHQgPSB0aGlzLmdldERpc3BsYXlUZXh0KCk7XG4gICAgdGhpcy5sYWJlbCA9IG5ldyBVSUxhYmVsKHtcbiAgICAgIHRleHQ6IGRpc3BsYXlUZXh0LFxuICAgICAgZm9udFNpemU6IDE0LFxuICAgICAgY29sb3I6IHRoaXMuc2VsZWN0ZWRWYWx1ZSA/IHRoaXMucHJvcHMudGV4dENvbG9yIDogMHg5OTk5OTksXG4gICAgICBhbGlnbjogJ2xlZnQnXG4gICAgfSwge1xuICAgICAgcGFkZGluZzogRWRnZUluc2V0cy5zeW1tZXRyaWMoOCwgMTIpXG4gICAgfSk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5sYWJlbC5jb250YWluZXIpO1xuXG4gICAgLy8gU2V0dXAgaW50ZXJhY3Rpdml0eVxuICAgIHRoaXMuc2V0dXBJbnRlcmFjdGl2aXR5KCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgZGlzcGxheSB0ZXh0IGJhc2VkIG9uIHNlbGVjdGVkIHZhbHVlXG4gICAqL1xuICBwcml2YXRlIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZyB7XG4gICAgaWYgKCF0aGlzLnNlbGVjdGVkVmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyO1xuICAgIH1cblxuICAgIGNvbnN0IG9wdGlvbiA9IHRoaXMucHJvcHMub3B0aW9ucy5maW5kKG9wdCA9PiBvcHQudmFsdWUgPT09IHRoaXMuc2VsZWN0ZWRWYWx1ZSk7XG4gICAgcmV0dXJuIG9wdGlvbiA/IG9wdGlvbi5sYWJlbCA6IHRoaXMucHJvcHMucGxhY2Vob2xkZXI7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB1cCBtb3VzZS90b3VjaCBldmVudCBoYW5kbGVyc1xuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cEludGVyYWN0aXZpdHkoKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgdGhpcy5jb250YWluZXIuY3Vyc29yID0gJ3BvaW50ZXInO1xuXG4gICAgdGhpcy5jb250YWluZXIub24oJ3BvaW50ZXJkb3duJywgdGhpcy5oYW5kbGVQb2ludGVyRG93bi5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlckRvd24oKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZGlzYWJsZWQpIHJldHVybjtcblxuICAgIGlmICh0aGlzLmlzT3Blbikge1xuICAgICAgdGhpcy5jbG9zZURyb3Bkb3duKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMub3BlbkRyb3Bkb3duKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE9wZW5zIHRoZSBkcm9wZG93biBtZW51XG4gICAqL1xuICBwcml2YXRlIG9wZW5Ecm9wZG93bigpOiB2b2lkIHtcbiAgICB0aGlzLmlzT3BlbiA9IHRydWU7XG5cbiAgICAvLyBDcmVhdGUgZHJvcGRvd24gY29udGFpbmVyXG4gICAgdGhpcy5kcm9wZG93bkNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgIHRoaXMuZHJvcGRvd25Db250YWluZXIucG9zaXRpb24uc2V0KDAsIHRoaXMucHJvcHMuaGVpZ2h0ICsgNCk7XG5cbiAgICAvLyBDcmVhdGUgZHJvcGRvd24gcGFuZWxcbiAgICBjb25zdCBkcm9wZG93bkhlaWdodCA9IE1hdGgubWluKHRoaXMucHJvcHMub3B0aW9ucy5sZW5ndGggKiAzMiwgMjAwKTtcbiAgICB0aGlzLmRyb3Bkb3duUGFuZWwgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IGRyb3Bkb3duSGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuICAgIHRoaXMuZHJvcGRvd25Db250YWluZXIuYWRkQ2hpbGQodGhpcy5kcm9wZG93blBhbmVsLmNvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgb3B0aW9uIGxhYmVsc1xuICAgIHRoaXMub3B0aW9uTGFiZWxzID0gW107XG4gICAgdGhpcy5wcm9wcy5vcHRpb25zLmZvckVhY2goKG9wdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IG9wdGlvbkNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgICAgb3B0aW9uQ29udGFpbmVyLnBvc2l0aW9uLnNldCgwLCBpbmRleCAqIDMyKTtcblxuICAgICAgLy8gT3B0aW9uIGJhY2tncm91bmRcbiAgICAgIGNvbnN0IG9wdGlvbkJnID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICAgIG9wdGlvbkJnLnJlY3QoMCwgMCwgdGhpcy5wcm9wcy53aWR0aCwgMzIpO1xuICAgICAgb3B0aW9uQmcuZmlsbCh7IGNvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciwgYWxwaGE6IDAgfSk7XG4gICAgICBvcHRpb25Db250YWluZXIuYWRkQ2hpbGQob3B0aW9uQmcpO1xuXG4gICAgICAvLyBPcHRpb24gbGFiZWxcbiAgICAgIGNvbnN0IG9wdGlvbkxhYmVsID0gbmV3IFVJTGFiZWwoe1xuICAgICAgICB0ZXh0OiBvcHRpb24ubGFiZWwsXG4gICAgICAgIGZvbnRTaXplOiAxNCxcbiAgICAgICAgY29sb3I6IG9wdGlvbi5kaXNhYmxlZCA/IDB4OTk5OTk5IDogdGhpcy5wcm9wcy50ZXh0Q29sb3IsXG4gICAgICAgIGFsaWduOiAnbGVmdCdcbiAgICAgIH0sIHtcbiAgICAgICAgcGFkZGluZzogRWRnZUluc2V0cy5zeW1tZXRyaWMoOCwgMTIpXG4gICAgICB9KTtcbiAgICAgIG9wdGlvbkxhYmVsLmxheW91dCh0aGlzLnByb3BzLndpZHRoLCAzMik7XG4gICAgICBvcHRpb25Db250YWluZXIuYWRkQ2hpbGQob3B0aW9uTGFiZWwuY29udGFpbmVyKTtcblxuICAgICAgaWYgKCFvcHRpb24uZGlzYWJsZWQpIHtcbiAgICAgICAgb3B0aW9uQ29udGFpbmVyLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgICAgICBvcHRpb25Db250YWluZXIuY3Vyc29yID0gJ3BvaW50ZXInO1xuXG4gICAgICAgIC8vIEhvdmVyIGVmZmVjdFxuICAgICAgICBvcHRpb25Db250YWluZXIub24oJ3BvaW50ZXJvdmVyJywgKCkgPT4ge1xuICAgICAgICAgIG9wdGlvbkJnLmNsZWFyKCk7XG4gICAgICAgICAgb3B0aW9uQmcucmVjdCgwLCAwLCB0aGlzLnByb3BzLndpZHRoLCAzMik7XG4gICAgICAgICAgb3B0aW9uQmcuZmlsbCh7IGNvbG9yOiB0aGlzLmhvdmVyQ29sb3IgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG9wdGlvbkNvbnRhaW5lci5vbigncG9pbnRlcm91dCcsICgpID0+IHtcbiAgICAgICAgICBvcHRpb25CZy5jbGVhcigpO1xuICAgICAgICAgIG9wdGlvbkJnLnJlY3QoMCwgMCwgdGhpcy5wcm9wcy53aWR0aCwgMzIpO1xuICAgICAgICAgIG9wdGlvbkJnLmZpbGwoeyBjb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsIGFscGhhOiAwIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDbGljayBoYW5kbGVyXG4gICAgICAgIG9wdGlvbkNvbnRhaW5lci5vbigncG9pbnRlcmRvd24nLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5zZWxlY3RPcHRpb24ob3B0aW9uLnZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZHJvcGRvd25Db250YWluZXIhLmFkZENoaWxkKG9wdGlvbkNvbnRhaW5lcik7XG4gICAgICB0aGlzLm9wdGlvbkxhYmVscy5wdXNoKG9wdGlvbkxhYmVsKTtcbiAgICB9KTtcblxuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuZHJvcGRvd25Db250YWluZXIpO1xuXG4gICAgLy8gQWRkIGNsaWNrIG91dHNpZGUgbGlzdGVuZXJcbiAgICB0aGlzLnNldHVwQ2xpY2tPdXRzaWRlKCk7XG4gIH1cblxuICAvKipcbiAgICogQ2xvc2VzIHRoZSBkcm9wZG93biBtZW51XG4gICAqL1xuICBwcml2YXRlIGNsb3NlRHJvcGRvd24oKTogdm9pZCB7XG4gICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcblxuICAgIGlmICh0aGlzLmRyb3Bkb3duQ29udGFpbmVyKSB7XG4gICAgICB0aGlzLmNvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLmRyb3Bkb3duQ29udGFpbmVyKTtcbiAgICAgIHRoaXMuZHJvcGRvd25Db250YWluZXIgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmRyb3Bkb3duUGFuZWwgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLm9wdGlvbkxhYmVscyA9IFtdO1xuICAgIH1cblxuICAgIC8vIFJlbW92ZSBjbGljayBvdXRzaWRlIGxpc3RlbmVyXG4gICAgdGhpcy5yZW1vdmVDbGlja091dHNpZGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZWxlY3RzIGFuIG9wdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBzZWxlY3RPcHRpb24odmFsdWU6IGFueSk6IHZvaWQge1xuICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMubGFiZWwuc2V0VGV4dCh0aGlzLmdldERpc3BsYXlUZXh0KCkpO1xuICAgIHRoaXMubGFiZWwuc2V0Q29sb3IodGhpcy5wcm9wcy50ZXh0Q29sb3IpO1xuXG4gICAgdGhpcy5vbkNoYW5nZT8uKHZhbHVlKTtcbiAgICB0aGlzLmNsb3NlRHJvcGRvd24oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXR1cCBjbGljayBvdXRzaWRlIGRldGVjdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cENsaWNrT3V0c2lkZSgpOiB2b2lkIHtcbiAgICAvLyBTaW1wbGUgYXBwcm9hY2g6IGNsb3NlIG9uIGFueSBvdXRzaWRlIGNsaWNrXG4gICAgY29uc3Qgc3RhZ2UgPSB0aGlzLmNvbnRhaW5lci5wYXJlbnQ7XG4gICAgaWYgKHN0YWdlKSB7XG4gICAgICBzdGFnZS5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICAgIHN0YWdlLm9uY2UoJ3BvaW50ZXJkb3duJywgKGUpID0+IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgY2xpY2sgaXMgb3V0c2lkZVxuICAgICAgICBjb25zdCBwb2ludCA9IGUuZ2xvYmFsO1xuICAgICAgICBjb25zdCBib3VuZHMgPSB0aGlzLmNvbnRhaW5lci5nZXRCb3VuZHMoKTtcblxuICAgICAgICAvLyBDaGVjayBpZiBwb2ludCBpcyB3aXRoaW4gYm91bmRzIG1hbnVhbGx5XG4gICAgICAgIGlmIChwb2ludC54IDwgYm91bmRzLnggfHwgcG9pbnQueCA+IGJvdW5kcy54ICsgYm91bmRzLndpZHRoIHx8XG4gICAgICAgICAgICBwb2ludC55IDwgYm91bmRzLnkgfHwgcG9pbnQueSA+IGJvdW5kcy55ICsgYm91bmRzLmhlaWdodCkge1xuICAgICAgICAgIHRoaXMuY2xvc2VEcm9wZG93bigpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGNsaWNrIG91dHNpZGUgZGV0ZWN0aW9uXG4gICAqL1xuICBwcml2YXRlIHJlbW92ZUNsaWNrT3V0c2lkZSgpOiB2b2lkIHtcbiAgICAvLyBIYW5kbGVkIGJ5ICdvbmNlJyBpbiBzZXR1cENsaWNrT3V0c2lkZVxuICB9XG5cbiAgLyoqXG4gICAqIERhcmtlbnMgYSBjb2xvciBieSBhIGZhY3RvclxuICAgKi9cbiAgcHJpdmF0ZSBkYXJrZW5Db2xvcihjb2xvcjogbnVtYmVyLCBmYWN0b3I6IG51bWJlcik6IG51bWJlciB7XG4gICAgY29uc3QgciA9ICgoY29sb3IgPj4gMTYpICYgMHhmZikgKiBmYWN0b3I7XG4gICAgY29uc3QgZyA9ICgoY29sb3IgPj4gOCkgJiAweGZmKSAqIGZhY3RvcjtcbiAgICBjb25zdCBiID0gKGNvbG9yICYgMHhmZikgKiBmYWN0b3I7XG4gICAgcmV0dXJuICgociA8PCAxNikgfCAoZyA8PCA4KSB8IGIpID4+PiAwO1xuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmVzIHRoZSBzaXplIG5lZWRlZCBmb3IgdGhpcyBzZWxlY3RcbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBsYXlvdXQgZm9yIHRoaXMgc2VsZWN0XG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuXG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgLy8gTGF5b3V0IGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQubGF5b3V0KG1lYXN1cmVkLndpZHRoLCBtZWFzdXJlZC5oZWlnaHQpO1xuXG4gICAgLy8gTGF5b3V0IGxhYmVsXG4gICAgdGhpcy5sYWJlbC5sYXlvdXQobWVhc3VyZWQud2lkdGgsIG1lYXN1cmVkLmhlaWdodCk7XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSBzZWxlY3RcbiAgICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgLy8gUmVuZGVyaW5nIGhhbmRsZWQgYnkgYmFja2dyb3VuZCBhbmQgbGFiZWxcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBzZWxlY3RlZCB2YWx1ZSBwcm9ncmFtbWF0aWNhbGx5XG4gICAqL1xuICBzZXRWYWx1ZSh2YWx1ZTogYW55KTogdm9pZCB7XG4gICAgdGhpcy5zZWxlY3RlZFZhbHVlID0gdmFsdWU7XG4gICAgdGhpcy5sYWJlbC5zZXRUZXh0KHRoaXMuZ2V0RGlzcGxheVRleHQoKSk7XG4gICAgdGhpcy5sYWJlbC5zZXRDb2xvcih0aGlzLnByb3BzLnRleHRDb2xvcik7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCBzZWxlY3RlZCB2YWx1ZVxuICAgKi9cbiAgZ2V0VmFsdWUoKTogYW55IHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3RlZFZhbHVlO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIG9wdGlvbnNcbiAgICovXG4gIHNldE9wdGlvbnMob3B0aW9uczogU2VsZWN0T3B0aW9uW10pOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIGlmICh0aGlzLmlzT3Blbikge1xuICAgICAgdGhpcy5jbG9zZURyb3Bkb3duKCk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuaW1wb3J0IHsgVUlMYWJlbCB9IGZyb20gJy4vdWktbGFiZWwnO1xuaW1wb3J0IHsgVUlQYW5lbCB9IGZyb20gJy4vdWktcGFuZWwnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRhYkl0ZW0ge1xuICBrZXk6IHN0cmluZztcbiAgbGFiZWw6IHN0cmluZztcbiAgY29udGVudDogVUlDb21wb25lbnQ7XG4gIGRpc2FibGVkPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBVSVRhYnNQcm9wcyB7XG4gIGl0ZW1zOiBUYWJJdGVtW107XG4gIGFjdGl2ZUtleT86IHN0cmluZztcbiAgZGVmYXVsdEFjdGl2ZUtleT86IHN0cmluZztcbiAgb25DaGFuZ2U/OiAoYWN0aXZlS2V5OiBzdHJpbmcpID0+IHZvaWQ7XG4gIHR5cGU/OiAnbGluZScgfCAnY2FyZCc7XG4gIHRhYlBvc2l0aW9uPzogJ3RvcCcgfCAnYm90dG9tJztcbiAgd2lkdGg/OiBudW1iZXI7XG4gIGhlaWdodD86IG51bWJlcjtcbiAgdGFiQmFyQmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICB0YWJCYXJIZWlnaHQ/OiBudW1iZXI7XG4gIGFjdGl2ZVRhYkNvbG9yPzogbnVtYmVyO1xuICBpbmFjdGl2ZVRhYkNvbG9yPzogbnVtYmVyO1xuICB0ZXh0Q29sb3I/OiBudW1iZXI7XG4gIGFjdGl2ZVRleHRDb2xvcj86IG51bWJlcjtcbiAgaGFzaFByZWZpeD86IHN0cmluZzsgLy8gZS5nLiwgXCJ1aS1zaG93Y2FzZVwiIGNyZWF0ZXMgVVJMcyBsaWtlICN1aS1zaG93Y2FzZS9iYXNpY3Ncbn1cblxuZXhwb3J0IGNsYXNzIFVJVGFicyBleHRlbmRzIFVJQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBpdGVtczogVGFiSXRlbVtdO1xuICBwcml2YXRlIGFjdGl2ZUtleTogc3RyaW5nO1xuICBwcml2YXRlIG9uQ2hhbmdlPzogKGFjdGl2ZUtleTogc3RyaW5nKSA9PiB2b2lkO1xuICBwcml2YXRlIHR5cGU6ICdsaW5lJyB8ICdjYXJkJztcbiAgcHJpdmF0ZSB0YWJQb3NpdGlvbjogJ3RvcCcgfCAnYm90dG9tJztcbiAgcHJpdmF0ZSB3aWR0aDogbnVtYmVyO1xuICBwcml2YXRlIGhlaWdodDogbnVtYmVyO1xuICBwcml2YXRlIHRhYkJhckJhY2tncm91bmRDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIHRhYkJhckhlaWdodDogbnVtYmVyO1xuICBwcml2YXRlIGFjdGl2ZVRhYkNvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgaW5hY3RpdmVUYWJDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIHRleHRDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIGFjdGl2ZVRleHRDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIGhhc2hQcmVmaXg/OiBzdHJpbmc7XG5cbiAgcHJpdmF0ZSB0YWJCYXI6IFBJWEkuQ29udGFpbmVyO1xuICBwcml2YXRlIGNvbnRlbnRBcmVhOiBQSVhJLkNvbnRhaW5lcjtcbiAgcHJpdmF0ZSB0YWJCdXR0b25zOiBNYXA8c3RyaW5nLCB7IGNvbnRhaW5lcjogUElYSS5Db250YWluZXI7IGxhYmVsOiBVSUxhYmVsOyBiZzogUElYSS5HcmFwaGljcyB9PiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBhY3RpdmVJbmRpY2F0b3I/OiBQSVhJLkdyYXBoaWNzO1xuICBwcml2YXRlIGhhc2hDaGFuZ2VIYW5kbGVyPzogKCkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlUYWJzUHJvcHMsIGJveE1vZGVsPzogUGFydGlhbDxCb3hNb2RlbD4pIHtcbiAgICBzdXBlcihib3hNb2RlbCk7XG5cbiAgICB0aGlzLml0ZW1zID0gcHJvcHMuaXRlbXMgfHwgW107XG4gICAgdGhpcy5vbkNoYW5nZSA9IHByb3BzLm9uQ2hhbmdlO1xuICAgIHRoaXMudHlwZSA9IHByb3BzLnR5cGUgfHwgJ2xpbmUnO1xuICAgIHRoaXMudGFiUG9zaXRpb24gPSBwcm9wcy50YWJQb3NpdGlvbiB8fCAndG9wJztcbiAgICB0aGlzLnRhYkJhckJhY2tncm91bmRDb2xvciA9IHByb3BzLnRhYkJhckJhY2tncm91bmRDb2xvciA/PyAweDJkMmQ0NDtcbiAgICB0aGlzLnRhYkJhckhlaWdodCA9IHByb3BzLnRhYkJhckhlaWdodCA/PyA0ODtcbiAgICB0aGlzLmFjdGl2ZVRhYkNvbG9yID0gcHJvcHMuYWN0aXZlVGFiQ29sb3IgPz8gMHgxODkwZmY7XG4gICAgdGhpcy5pbmFjdGl2ZVRhYkNvbG9yID0gcHJvcHMuaW5hY3RpdmVUYWJDb2xvciA/PyAweDNkM2Q1NDtcbiAgICB0aGlzLnRleHRDb2xvciA9IHByb3BzLnRleHRDb2xvciA/PyAweGFhYWFhYTtcbiAgICB0aGlzLmFjdGl2ZVRleHRDb2xvciA9IHByb3BzLmFjdGl2ZVRleHRDb2xvciA/PyAweGZmZmZmZjtcbiAgICB0aGlzLmhhc2hQcmVmaXggPSBwcm9wcy5oYXNoUHJlZml4O1xuXG4gICAgLy8gRGV0ZXJtaW5lIGFjdGl2ZSBrZXkgLSBjaGVjayBVUkwgaGFzaCBmaXJzdCBpZiBoYXNoUHJlZml4IGlzIHByb3ZpZGVkXG4gICAgbGV0IGluaXRpYWxLZXkgPSBwcm9wcy5hY3RpdmVLZXkgfHwgcHJvcHMuZGVmYXVsdEFjdGl2ZUtleSB8fCAodGhpcy5pdGVtcy5sZW5ndGggPiAwID8gdGhpcy5pdGVtc1swXS5rZXkgOiAnJyk7XG4gICAgaWYgKHRoaXMuaGFzaFByZWZpeCAmJiAhcHJvcHMuYWN0aXZlS2V5KSB7XG4gICAgICBjb25zdCBoYXNoS2V5ID0gdGhpcy5nZXRLZXlGcm9tSGFzaCgpO1xuICAgICAgaWYgKGhhc2hLZXkgJiYgdGhpcy5pdGVtcy5maW5kKGl0ZW0gPT4gaXRlbS5rZXkgPT09IGhhc2hLZXkpKSB7XG4gICAgICAgIGluaXRpYWxLZXkgPSBoYXNoS2V5O1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmFjdGl2ZUtleSA9IGluaXRpYWxLZXk7XG5cbiAgICB0aGlzLndpZHRoID0gcHJvcHMud2lkdGggPz8gODAwO1xuICAgIHRoaXMuaGVpZ2h0ID0gcHJvcHMuaGVpZ2h0ID8/IDYwMDtcblxuICAgIHRoaXMudGFiQmFyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgdGhpcy5jb250ZW50QXJlYSA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy50YWJCYXIpO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuY29udGVudEFyZWEpO1xuXG4gICAgdGhpcy5idWlsZFRhYnMoKTtcbiAgICB0aGlzLnNob3dBY3RpdmVUYWIoKTtcblxuICAgIC8vIFNldCB1cCBoYXNoIGNoYW5nZSBsaXN0ZW5lciBpZiBoYXNoUHJlZml4IGlzIHByb3ZpZGVkXG4gICAgaWYgKHRoaXMuaGFzaFByZWZpeCkge1xuICAgICAgdGhpcy5zZXR1cEhhc2hMaXN0ZW5lcigpO1xuICAgICAgLy8gVXBkYXRlIGhhc2ggdG8gbWF0Y2ggaW5pdGlhbCBhY3RpdmUga2V5XG4gICAgICB0aGlzLnVwZGF0ZUhhc2godGhpcy5hY3RpdmVLZXkpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0S2V5RnJvbUhhc2goKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgaWYgKCF0aGlzLmhhc2hQcmVmaXgpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IGhhc2ggPSB3aW5kb3cubG9jYXRpb24uaGFzaC5zbGljZSgxKTsgLy8gUmVtb3ZlICNcbiAgICBjb25zdCBwcmVmaXggPSBgJHt0aGlzLmhhc2hQcmVmaXh9L2A7XG4gICAgaWYgKGhhc2guc3RhcnRzV2l0aChwcmVmaXgpKSB7XG4gICAgICByZXR1cm4gaGFzaC5zbGljZShwcmVmaXgubGVuZ3RoKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUhhc2goa2V5OiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuaGFzaFByZWZpeCkgcmV0dXJuO1xuICAgIGNvbnN0IG5ld0hhc2ggPSBgIyR7dGhpcy5oYXNoUHJlZml4fS8ke2tleX1gO1xuICAgIGlmICh3aW5kb3cubG9jYXRpb24uaGFzaCAhPT0gbmV3SGFzaCkge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBuZXdIYXNoO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0dXBIYXNoTGlzdGVuZXIoKTogdm9pZCB7XG4gICAgdGhpcy5oYXNoQ2hhbmdlSGFuZGxlciA9ICgpID0+IHtcbiAgICAgIGNvbnN0IGhhc2hLZXkgPSB0aGlzLmdldEtleUZyb21IYXNoKCk7XG4gICAgICBpZiAoaGFzaEtleSAmJiBoYXNoS2V5ICE9PSB0aGlzLmFjdGl2ZUtleSkge1xuICAgICAgICB0aGlzLnNldEFjdGl2ZUtleShoYXNoS2V5LCBmYWxzZSk7IC8vIGZhbHNlID0gZG9uJ3QgdXBkYXRlIGhhc2ggKGFscmVhZHkgY2hhbmdlZClcbiAgICAgIH1cbiAgICB9O1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgdGhpcy5oYXNoQ2hhbmdlSGFuZGxlcik7XG4gIH1cblxuICBwdWJsaWMgZGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5oYXNoQ2hhbmdlSGFuZGxlcikge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2hhc2hjaGFuZ2UnLCB0aGlzLmhhc2hDaGFuZ2VIYW5kbGVyKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkVGFicygpOiB2b2lkIHtcbiAgICAvLyBDbGVhciBleGlzdGluZyB0YWJzXG4gICAgdGhpcy50YWJCYXIucmVtb3ZlQ2hpbGRyZW4oKTtcbiAgICB0aGlzLnRhYkJ1dHRvbnMuY2xlYXIoKTtcblxuICAgIC8vIENyZWF0ZSB0YWIgYmFyIGJhY2tncm91bmRcbiAgICBjb25zdCB0YWJCYXJCZyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGFiQmFyQmcucmVjdCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLnRhYkJhckhlaWdodCk7XG4gICAgdGFiQmFyQmcuZmlsbCh7IGNvbG9yOiB0aGlzLnRhYkJhckJhY2tncm91bmRDb2xvciB9KTtcbiAgICB0aGlzLnRhYkJhci5hZGRDaGlsZCh0YWJCYXJCZyk7XG5cbiAgICAvLyBBZGQgYm90dG9tIGJvcmRlciBsaW5lIGZvciBsaW5lIHR5cGVcbiAgICBpZiAodGhpcy50eXBlID09PSAnbGluZScpIHtcbiAgICAgIGNvbnN0IGJvcmRlckxpbmUgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgICAgYm9yZGVyTGluZS5yZWN0KDAsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgdGhpcy53aWR0aCwgMik7XG4gICAgICBib3JkZXJMaW5lLmZpbGwoeyBjb2xvcjogMHgzZDNkNTQsIGFscGhhOiAwLjUgfSk7XG4gICAgICB0aGlzLnRhYkJhci5hZGRDaGlsZChib3JkZXJMaW5lKTtcbiAgICB9XG5cbiAgICAvLyBQb3NpdGlvbiB0YWIgYmFyXG4gICAgaWYgKHRoaXMudGFiUG9zaXRpb24gPT09ICdib3R0b20nKSB7XG4gICAgICB0aGlzLnRhYkJhci55ID0gdGhpcy5oZWlnaHQgLSB0aGlzLnRhYkJhckhlaWdodDtcbiAgICAgIHRoaXMuY29udGVudEFyZWEueSA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudGFiQmFyLnkgPSAwO1xuICAgICAgdGhpcy5jb250ZW50QXJlYS55ID0gdGhpcy50YWJCYXJIZWlnaHQ7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHRhYnNcbiAgICBsZXQgeE9mZnNldCA9IDg7IC8vIFN0YXJ0IHdpdGggc29tZSBsZWZ0IHBhZGRpbmdcbiAgICBjb25zdCB0YWJQYWRkaW5nID0gMjQ7XG4gICAgY29uc3QgdGFiR2FwID0gODtcblxuICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzLml0ZW1zKSB7XG4gICAgICBpZiAoaXRlbS5kaXNhYmxlZCkgY29udGludWU7XG5cbiAgICAgIGNvbnN0IHRhYkNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgICAgdGFiQ29udGFpbmVyLnggPSB4T2Zmc2V0O1xuXG4gICAgICAvLyBUYWIgbGFiZWxcbiAgICAgIGNvbnN0IGlzQWN0aXZlID0gdGhpcy5hY3RpdmVLZXkgPT09IGl0ZW0ua2V5O1xuICAgICAgY29uc3QgbGFiZWwgPSBuZXcgVUlMYWJlbCh7XG4gICAgICAgIHRleHQ6IGl0ZW0ubGFiZWwsXG4gICAgICAgIGZvbnRTaXplOiAxNSxcbiAgICAgICAgZm9udFdlaWdodDogaXNBY3RpdmUgPyAnYm9sZCcgOiAnbm9ybWFsJyxcbiAgICAgICAgY29sb3I6IGlzQWN0aXZlID8gdGhpcy5hY3RpdmVUZXh0Q29sb3IgOiB0aGlzLnRleHRDb2xvclxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1lYXN1cmUgbGFiZWwgdG8gZGV0ZXJtaW5lIHRhYiB3aWR0aFxuICAgICAgbGFiZWwubWVhc3VyZSgpO1xuICAgICAgbGFiZWwubGF5b3V0KHRoaXMud2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0KTtcbiAgICAgIGNvbnN0IGxhYmVsQm91bmRzID0gbGFiZWwuY29udGFpbmVyLmdldExvY2FsQm91bmRzKCk7XG4gICAgICBjb25zdCB0YWJXaWR0aCA9IGxhYmVsQm91bmRzLndpZHRoICsgKHRhYlBhZGRpbmcgKiAyKTtcblxuICAgICAgLy8gVGFiIGJhY2tncm91bmRcbiAgICAgIGxldCBiZzogUElYSS5HcmFwaGljcztcbiAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdjYXJkJykge1xuICAgICAgICBiZyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgICAgIGJnLnJvdW5kUmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgYmcuZmlsbCh7IGNvbG9yOiBpc0FjdGl2ZSA/IHRoaXMuYWN0aXZlVGFiQ29sb3IgOiB0aGlzLmluYWN0aXZlVGFiQ29sb3IgfSk7XG4gICAgICAgIC8vIEFkZCBib3JkZXIgZm9yIGNhcmQgdHlwZVxuICAgICAgICBiZy5yb3VuZFJlY3QoMCwgMCwgdGFiV2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgNik7XG4gICAgICAgIGJnLnN0cm9rZSh7IGNvbG9yOiBpc0FjdGl2ZSA/IHRoaXMuYWN0aXZlVGFiQ29sb3IgOiAweDRkNGQ2NCwgd2lkdGg6IDIgfSk7XG4gICAgICAgIHRhYkNvbnRhaW5lci5hZGRDaGlsZChiZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGb3IgbGluZSB0eXBlLCBOTyBiYWNrZ3JvdW5kIG9yIGJvcmRlciAtIGp1c3QgdHJhbnNwYXJlbnQgaGl0IGFyZWFcbiAgICAgICAgYmcgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgICAgICBiZy5yZWN0KDAsIDAsIHRhYldpZHRoLCB0aGlzLnRhYkJhckhlaWdodCk7XG4gICAgICAgIGJnLmZpbGwoeyBjb2xvcjogMHgwMDAwMDAsIGFscGhhOiAwIH0pO1xuICAgICAgICB0YWJDb250YWluZXIuYWRkQ2hpbGQoYmcpO1xuICAgICAgfVxuXG4gICAgICAvLyBQb3NpdGlvbiBsYWJlbCBjZW50ZXJlZCBpbiB0YWJcbiAgICAgIGxhYmVsLmNvbnRhaW5lci54ID0gdGFiUGFkZGluZztcbiAgICAgIGxhYmVsLmNvbnRhaW5lci55ID0gKHRoaXMudGFiQmFySGVpZ2h0IC0gbGFiZWxCb3VuZHMuaGVpZ2h0KSAvIDI7XG4gICAgICB0YWJDb250YWluZXIuYWRkQ2hpbGQobGFiZWwuY29udGFpbmVyKTtcblxuICAgICAgLy8gTWFrZSB0YWIgaW50ZXJhY3RpdmVcbiAgICAgIHRhYkNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICAgIHRhYkNvbnRhaW5lci5jdXJzb3IgPSAncG9pbnRlcic7XG5cbiAgICAgIGNvbnN0IHRhYktleSA9IGl0ZW0ua2V5O1xuICAgICAgdGFiQ29udGFpbmVyLm9uKCdwb2ludGVyZG93bicsICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRBY3RpdmVLZXkodGFiS2V5KTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBIb3ZlciBlZmZlY3RcbiAgICAgIHRhYkNvbnRhaW5lci5vbigncG9pbnRlcm92ZXInLCAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZUtleSAhPT0gdGFiS2V5KSB7XG4gICAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2NhcmQnKSB7XG4gICAgICAgICAgICBiZy5jbGVhcigpO1xuICAgICAgICAgICAgYmcucm91bmRSZWN0KDAsIDAsIHRhYldpZHRoLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIDYpO1xuICAgICAgICAgICAgYmcuZmlsbCh7IGNvbG9yOiB0aGlzLmFjdGl2ZVRhYkNvbG9yLCBhbHBoYTogMC41IH0pO1xuICAgICAgICAgICAgYmcucm91bmRSZWN0KDAsIDAsIHRhYldpZHRoLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIDYpO1xuICAgICAgICAgICAgYmcuc3Ryb2tlKHsgY29sb3I6IHRoaXMuYWN0aXZlVGFiQ29sb3IsIHdpZHRoOiAyIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBGb3IgbGluZSB0eXBlLCBqdXN0IGNoYW5nZSB0ZXh0IGNvbG9yIG9uIGhvdmVyXG4gICAgICAgICAgICBsYWJlbC5zZXRDb2xvcih0aGlzLmFjdGl2ZVRleHRDb2xvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgdGFiQ29udGFpbmVyLm9uKCdwb2ludGVyb3V0JywgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5hY3RpdmVLZXkgIT09IHRhYktleSkge1xuICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdjYXJkJykge1xuICAgICAgICAgICAgYmcuY2xlYXIoKTtcbiAgICAgICAgICAgIGJnLnJvdW5kUmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgICAgIGJnLmZpbGwoeyBjb2xvcjogdGhpcy5pbmFjdGl2ZVRhYkNvbG9yIH0pO1xuICAgICAgICAgICAgYmcucm91bmRSZWN0KDAsIDAsIHRhYldpZHRoLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIDYpO1xuICAgICAgICAgICAgYmcuc3Ryb2tlKHsgY29sb3I6IDB4NGQ0ZDY0LCB3aWR0aDogMiB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gUmVzdG9yZSBtdXRlZCB0ZXh0IGNvbG9yXG4gICAgICAgICAgICBsYWJlbC5zZXRDb2xvcih0aGlzLnRleHRDb2xvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgdGhpcy50YWJCYXIuYWRkQ2hpbGQodGFiQ29udGFpbmVyKTtcbiAgICAgIHRoaXMudGFiQnV0dG9ucy5zZXQoaXRlbS5rZXksIHsgY29udGFpbmVyOiB0YWJDb250YWluZXIsIGxhYmVsLCBiZyB9KTtcblxuICAgICAgeE9mZnNldCArPSB0YWJXaWR0aCArIHRhYkdhcDtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYWN0aXZlIGluZGljYXRvciBmb3IgbGluZSB0eXBlXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ2xpbmUnKSB7XG4gICAgICB0aGlzLmFjdGl2ZUluZGljYXRvciA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgICB0aGlzLnRhYkJhci5hZGRDaGlsZCh0aGlzLmFjdGl2ZUluZGljYXRvcik7XG4gICAgICB0aGlzLnVwZGF0ZUFjdGl2ZUluZGljYXRvcigpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlQWN0aXZlSW5kaWNhdG9yKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5hY3RpdmVJbmRpY2F0b3IgfHwgdGhpcy50eXBlICE9PSAnbGluZScpIHJldHVybjtcblxuICAgIHRoaXMuYWN0aXZlSW5kaWNhdG9yLmNsZWFyKCk7XG5cbiAgICBjb25zdCBhY3RpdmVUYWIgPSB0aGlzLnRhYkJ1dHRvbnMuZ2V0KHRoaXMuYWN0aXZlS2V5KTtcbiAgICBpZiAoIWFjdGl2ZVRhYikgcmV0dXJuO1xuXG4gICAgY29uc3QgdGFiWCA9IGFjdGl2ZVRhYi5jb250YWluZXIueDtcbiAgICBjb25zdCB0YWJCb3VuZHMgPSBhY3RpdmVUYWIuYmcuZ2V0TG9jYWxCb3VuZHMoKTtcbiAgICBjb25zdCB0YWJXaWR0aCA9IHRhYkJvdW5kcy53aWR0aDtcbiAgICBjb25zdCBpbmRpY2F0b3JIZWlnaHQgPSAzO1xuICAgIGNvbnN0IGluZGljYXRvclkgPSB0aGlzLnRhYkJhckhlaWdodCAtIGluZGljYXRvckhlaWdodDtcblxuICAgIC8vIERyYXcgaW5kaWNhdG9yIGF0IHRoZSB2ZXJ5IGJvdHRvbSwgc3Bhbm5pbmcgbW9zdCBvZiB0aGUgdGFiIHdpZHRoXG4gICAgdGhpcy5hY3RpdmVJbmRpY2F0b3Iucm91bmRSZWN0KHRhYlggKyA4LCBpbmRpY2F0b3JZLCB0YWJXaWR0aCAtIDE2LCBpbmRpY2F0b3JIZWlnaHQsIDEuNSk7XG4gICAgdGhpcy5hY3RpdmVJbmRpY2F0b3IuZmlsbCh7IGNvbG9yOiB0aGlzLmFjdGl2ZVRhYkNvbG9yIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBzaG93QWN0aXZlVGFiKCk6IHZvaWQge1xuICAgIC8vIENsZWFyIGNvbnRlbnQgYXJlYVxuICAgIHRoaXMuY29udGVudEFyZWEucmVtb3ZlQ2hpbGRyZW4oKTtcblxuICAgIC8vIEZpbmQgYWN0aXZlIGl0ZW1cbiAgICBjb25zdCBhY3RpdmVJdGVtID0gdGhpcy5pdGVtcy5maW5kKGl0ZW0gPT4gaXRlbS5rZXkgPT09IHRoaXMuYWN0aXZlS2V5KTtcbiAgICBpZiAoIWFjdGl2ZUl0ZW0pIHJldHVybjtcblxuICAgIC8vIEFkZCBjb250ZW50XG4gICAgY29uc3QgY29udGVudEhlaWdodCA9IHRoaXMuaGVpZ2h0IC0gdGhpcy50YWJCYXJIZWlnaHQ7XG4gICAgYWN0aXZlSXRlbS5jb250ZW50LmxheW91dCh0aGlzLndpZHRoLCBjb250ZW50SGVpZ2h0KTtcbiAgICB0aGlzLmNvbnRlbnRBcmVhLmFkZENoaWxkKGFjdGl2ZUl0ZW0uY29udGVudC5jb250YWluZXIpO1xuXG4gICAgLy8gVXBkYXRlIHRhYiBzdHlsZXNcbiAgICB0aGlzLnRhYkJ1dHRvbnMuZm9yRWFjaCgodGFiLCBrZXkpID0+IHtcbiAgICAgIGNvbnN0IGlzQWN0aXZlID0ga2V5ID09PSB0aGlzLmFjdGl2ZUtleTtcbiAgICAgIGNvbnN0IHRhYkJvdW5kcyA9IHRhYi5iZy5nZXRMb2NhbEJvdW5kcygpO1xuXG4gICAgICBpZiAodGhpcy50eXBlID09PSAnY2FyZCcpIHtcbiAgICAgICAgdGFiLmJnLmNsZWFyKCk7XG4gICAgICAgIHRhYi5iZy5yb3VuZFJlY3QoMCwgMCwgdGFiQm91bmRzLndpZHRoLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIDYpO1xuICAgICAgICB0YWIuYmcuZmlsbCh7IGNvbG9yOiBpc0FjdGl2ZSA/IHRoaXMuYWN0aXZlVGFiQ29sb3IgOiB0aGlzLmluYWN0aXZlVGFiQ29sb3IgfSk7XG4gICAgICAgIHRhYi5iZy5yb3VuZFJlY3QoMCwgMCwgdGFiQm91bmRzLndpZHRoLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIDYpO1xuICAgICAgICB0YWIuYmcuc3Ryb2tlKHsgY29sb3I6IGlzQWN0aXZlID8gdGhpcy5hY3RpdmVUYWJDb2xvciA6IDB4NGQ0ZDY0LCB3aWR0aDogMiB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZvciBsaW5lIHR5cGUsIGtlZXAgdHJhbnNwYXJlbnQgYmFja2dyb3VuZFxuICAgICAgICB0YWIuYmcuY2xlYXIoKTtcbiAgICAgICAgdGFiLmJnLnJlY3QoMCwgMCwgdGFiQm91bmRzLndpZHRoLCB0aGlzLnRhYkJhckhlaWdodCk7XG4gICAgICAgIHRhYi5iZy5maWxsKHsgY29sb3I6IDB4MDAwMDAwLCBhbHBoYTogMCB9KTtcbiAgICAgIH1cblxuICAgICAgdGFiLmxhYmVsLnNldENvbG9yKGlzQWN0aXZlID8gdGhpcy5hY3RpdmVUZXh0Q29sb3IgOiB0aGlzLnRleHRDb2xvcik7XG4gICAgICB0YWIubGFiZWwuY29udGFpbmVyLmFscGhhID0gMTtcbiAgICB9KTtcblxuICAgIC8vIFVwZGF0ZSBhY3RpdmUgaW5kaWNhdG9yXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ2xpbmUnKSB7XG4gICAgICB0aGlzLnVwZGF0ZUFjdGl2ZUluZGljYXRvcigpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzZXRBY3RpdmVLZXkoa2V5OiBzdHJpbmcsIHVwZGF0ZUhhc2g6IGJvb2xlYW4gPSB0cnVlKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuYWN0aXZlS2V5ID09PSBrZXkpIHJldHVybjtcblxuICAgIGNvbnN0IGl0ZW0gPSB0aGlzLml0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLmtleSA9PT0ga2V5KTtcbiAgICBpZiAoIWl0ZW0gfHwgaXRlbS5kaXNhYmxlZCkgcmV0dXJuO1xuXG4gICAgdGhpcy5hY3RpdmVLZXkgPSBrZXk7XG4gICAgdGhpcy5zaG93QWN0aXZlVGFiKCk7XG5cbiAgICAvLyBVcGRhdGUgVVJMIGhhc2ggaWYgZW5hYmxlZFxuICAgIGlmICh1cGRhdGVIYXNoICYmIHRoaXMuaGFzaFByZWZpeCkge1xuICAgICAgdGhpcy51cGRhdGVIYXNoKGtleSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub25DaGFuZ2UpIHtcbiAgICAgIHRoaXMub25DaGFuZ2Uoa2V5KTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgZ2V0QWN0aXZlS2V5KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuYWN0aXZlS2V5O1xuICB9XG5cbiAgcHVibGljIHNldEl0ZW1zKGl0ZW1zOiBUYWJJdGVtW10pOiB2b2lkIHtcbiAgICB0aGlzLml0ZW1zID0gaXRlbXM7XG5cbiAgICAvLyBJZiBhY3RpdmUga2V5IG5vIGxvbmdlciBleGlzdHMsIHN3aXRjaCB0byBmaXJzdCB0YWJcbiAgICBpZiAoIXRoaXMuaXRlbXMuZmluZChpdGVtID0+IGl0ZW0ua2V5ID09PSB0aGlzLmFjdGl2ZUtleSkpIHtcbiAgICAgIHRoaXMuYWN0aXZlS2V5ID0gdGhpcy5pdGVtcy5sZW5ndGggPiAwID8gdGhpcy5pdGVtc1swXS5rZXkgOiAnJztcbiAgICB9XG5cbiAgICB0aGlzLmJ1aWxkVGFicygpO1xuICAgIHRoaXMuc2hvd0FjdGl2ZVRhYigpO1xuICB9XG5cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogdGhpcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5oZWlnaHRcbiAgICB9O1xuICB9XG5cbiAgbGF5b3V0KHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgLy8gUmVidWlsZCB0YWJzIHdpdGggbmV3IGRpbWVuc2lvbnNcbiAgICB0aGlzLmJ1aWxkVGFicygpO1xuICAgIHRoaXMuc2hvd0FjdGl2ZVRhYigpO1xuICB9XG5cbiAgcmVuZGVyKCk6IHZvaWQge1xuICAgIC8vIFJlbmRlcmluZyBpcyBoYW5kbGVkIGJ5IGNoaWxkIGNvbXBvbmVudHNcbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5pbXBvcnQgeyBVSVBhbmVsIH0gZnJvbSAnLi91aS1wYW5lbCc7XG5pbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi4vY29yZS9lZGdlLWluc2V0cyc7XG5pbXBvcnQgeyBVSUZvY3VzTWFuYWdlciB9IGZyb20gJy4uL2NvcmUvdWktZm9jdXMtbWFuYWdlcic7XG5cbi8qKlxuICogUHJvcHMgZm9yIGNvbmZpZ3VyaW5nIGEgVUlUZXh0SW5wdXRcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSVRleHRJbnB1dFByb3BzIHtcbiAgLyoqIEN1cnJlbnQgdmFsdWUgKGNvbnRyb2xsZWQpICovXG4gIHZhbHVlPzogc3RyaW5nO1xuICAvKiogRGVmYXVsdCB2YWx1ZSAodW5jb250cm9sbGVkKSAqL1xuICBkZWZhdWx0VmFsdWU/OiBzdHJpbmc7XG4gIC8qKiBDaGFuZ2UgY2FsbGJhY2sgKi9cbiAgb25DaGFuZ2U/OiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcbiAgLyoqIFBsYWNlaG9sZGVyIHRleHQgd2hlbiBlbXB0eSAqL1xuICBwbGFjZWhvbGRlcj86IHN0cmluZztcbiAgLyoqIE1heGltdW0gY2hhcmFjdGVyIGxlbmd0aCAqL1xuICBtYXhMZW5ndGg/OiBudW1iZXI7XG4gIC8qKiBXaWR0aCBvZiB0aGUgaW5wdXQgKi9cbiAgd2lkdGg/OiBudW1iZXI7XG4gIC8qKiBIZWlnaHQgb2YgdGhlIGlucHV0ICovXG4gIGhlaWdodD86IG51bWJlcjtcbiAgLyoqIFdoZXRoZXIgdGhlIGlucHV0IGlzIGRpc2FibGVkICovXG4gIGRpc2FibGVkPzogYm9vbGVhbjtcbiAgLyoqIEJhY2tncm91bmQgY29sb3IgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogVGV4dCBjb2xvciAqL1xuICB0ZXh0Q29sb3I/OiBudW1iZXI7XG4gIC8qKiBQbGFjZWhvbGRlciB0ZXh0IGNvbG9yICovXG4gIHBsYWNlaG9sZGVyQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgcmFkaXVzICovXG4gIGJvcmRlclJhZGl1cz86IG51bWJlcjtcbiAgLyoqIEZvbnQgc2l6ZSAqL1xuICBmb250U2l6ZT86IG51bWJlcjtcbiAgLyoqIElucHV0IHR5cGUgZm9yIHZhbGlkYXRpb24gKi9cbiAgdHlwZT86ICd0ZXh0JyB8ICdudW1iZXInO1xufVxuXG4vKipcbiAqIEEgdGV4dCBpbnB1dCBjb21wb25lbnQgZm9sbG93aW5nIEFudCBEZXNpZ24gcGF0dGVybnNcbiAqIFN1cHBvcnRzIGJvdGggY29udHJvbGxlZCBhbmQgdW5jb250cm9sbGVkIG1vZGVzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGlucHV0ID0gbmV3IFVJVGV4dElucHV0KHtcbiAqICAgcGxhY2Vob2xkZXI6ICdFbnRlciB5b3VyIG5hbWUuLi4nLFxuICogICBvbkNoYW5nZTogKHZhbHVlKSA9PiBjb25zb2xlLmxvZygnSW5wdXQ6JywgdmFsdWUpLFxuICogICBtYXhMZW5ndGg6IDUwXG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlUZXh0SW5wdXQgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFJlcXVpcmVkPE9taXQ8VUlUZXh0SW5wdXRQcm9wcywgJ29uQ2hhbmdlJyB8ICd2YWx1ZScgfCAnZGVmYXVsdFZhbHVlJz4+O1xuICBwcml2YXRlIG9uQ2hhbmdlPzogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG5cbiAgcHJpdmF0ZSBjdXJyZW50VmFsdWU6IHN0cmluZztcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kOiBVSVBhbmVsO1xuICBwcml2YXRlIHRleHREaXNwbGF5OiBQSVhJLlRleHQ7XG4gIHByaXZhdGUgY3Vyc29yOiBQSVhJLkdyYXBoaWNzO1xuICBwcml2YXRlIGN1cnNvclBvc2l0aW9uOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGN1cnNvckJsaW5rSW50ZXJ2YWw/OiBudW1iZXI7XG4gIHByaXZhdGUgY3Vyc29yVmlzaWJsZTogYm9vbGVhbiA9IHRydWU7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJVGV4dElucHV0UHJvcHMsIGJveE1vZGVsPzogUGFydGlhbDxCb3hNb2RlbD4pIHtcbiAgICBzdXBlcihib3hNb2RlbCk7XG5cbiAgICB0aGlzLnByb3BzID0ge1xuICAgICAgcGxhY2Vob2xkZXI6IHByb3BzLnBsYWNlaG9sZGVyID8/ICcnLFxuICAgICAgbWF4TGVuZ3RoOiBwcm9wcy5tYXhMZW5ndGggPz8gMTAwLFxuICAgICAgd2lkdGg6IHByb3BzLndpZHRoID8/IDIwMCxcbiAgICAgIGhlaWdodDogcHJvcHMuaGVpZ2h0ID8/IDM2LFxuICAgICAgZGlzYWJsZWQ6IHByb3BzLmRpc2FibGVkID8/IGZhbHNlLFxuICAgICAgYmFja2dyb3VuZENvbG9yOiBwcm9wcy5iYWNrZ3JvdW5kQ29sb3IgPz8gMHhmZmZmZmYsXG4gICAgICB0ZXh0Q29sb3I6IHByb3BzLnRleHRDb2xvciA/PyAweDAwMDAwMCxcbiAgICAgIHBsYWNlaG9sZGVyQ29sb3I6IHByb3BzLnBsYWNlaG9sZGVyQ29sb3IgPz8gMHg5OTk5OTksXG4gICAgICBib3JkZXJSYWRpdXM6IHByb3BzLmJvcmRlclJhZGl1cyA/PyA0LFxuICAgICAgZm9udFNpemU6IHByb3BzLmZvbnRTaXplID8/IDE0LFxuICAgICAgdHlwZTogcHJvcHMudHlwZSA/PyAndGV4dCdcbiAgICB9O1xuXG4gICAgdGhpcy5vbkNoYW5nZSA9IHByb3BzLm9uQ2hhbmdlO1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gcHJvcHMudmFsdWUgPz8gcHJvcHMuZGVmYXVsdFZhbHVlID8/ICcnO1xuXG4gICAgLy8gU2V0IGJveCBtb2RlbCBkaW1lbnNpb25zXG4gICAgdGhpcy5ib3hNb2RlbC53aWR0aCA9IHRoaXMucHJvcHMud2lkdGg7XG4gICAgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcblxuICAgIC8vIENyZWF0ZSBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQuY29udGFpbmVyKTtcblxuICAgIC8vIENyZWF0ZSB0ZXh0IGRpc3BsYXlcbiAgICB0aGlzLnRleHREaXNwbGF5ID0gbmV3IFBJWEkuVGV4dCh7XG4gICAgICB0ZXh0OiB0aGlzLmdldERpc3BsYXlUZXh0KCksXG4gICAgICBzdHlsZToge1xuICAgICAgICBmb250RmFtaWx5OiAnQXJpYWwnLFxuICAgICAgICBmb250U2l6ZTogdGhpcy5wcm9wcy5mb250U2l6ZSxcbiAgICAgICAgZmlsbDogdGhpcy5jdXJyZW50VmFsdWUgPyB0aGlzLnByb3BzLnRleHRDb2xvciA6IHRoaXMucHJvcHMucGxhY2Vob2xkZXJDb2xvcixcbiAgICAgICAgYWxpZ246ICdsZWZ0J1xuICAgICAgfSxcbiAgICAgIHJlc29sdXRpb246IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDJcbiAgICB9KTtcbiAgICB0aGlzLnRleHREaXNwbGF5LnBvc2l0aW9uLnNldCgxMiwgKHRoaXMucHJvcHMuaGVpZ2h0IC0gdGhpcy5wcm9wcy5mb250U2l6ZSkgLyAyKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnRleHREaXNwbGF5KTtcblxuICAgIC8vIENyZWF0ZSBjdXJzb3JcbiAgICB0aGlzLmN1cnNvciA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IGZhbHNlO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuY3Vyc29yKTtcblxuICAgIC8vIFNldHVwIGludGVyYWN0aXZpdHlcbiAgICB0aGlzLnNldHVwSW50ZXJhY3Rpdml0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGRpc3BsYXkgdGV4dCAodmFsdWUgb3IgcGxhY2Vob2xkZXIpXG4gICAqL1xuICBwcml2YXRlIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuY3VycmVudFZhbHVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFsdWU7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgbW91c2Uva2V5Ym9hcmQgZXZlbnQgaGFuZGxlcnNcbiAgICovXG4gIHByaXZhdGUgc2V0dXBJbnRlcmFjdGl2aXR5KCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgIHRoaXMuY29udGFpbmVyLmN1cnNvciA9ICd0ZXh0JztcblxuICAgIC8vIENsaWNrIHRvIGZvY3VzXG4gICAgdGhpcy5jb250YWluZXIub24oJ3BvaW50ZXJkb3duJywgdGhpcy5oYW5kbGVQb2ludGVyRG93bi5iaW5kKHRoaXMpKTtcblxuICAgIC8vIExpc3RlbiBmb3IgZ2xvYmFsIGNsaWNrIHRvIGJsdXJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlEb3duLmJpbmQodGhpcykpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlckRvd24oZTogUElYSS5GZWRlcmF0ZWRQb2ludGVyRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wcm9wcy5kaXNhYmxlZCkgcmV0dXJuO1xuXG4gICAgLy8gUmVxdWVzdCBmb2N1cyB0aHJvdWdoIHRoZSBmb2N1cyBtYW5hZ2VyXG4gICAgY29uc3QgZm9jdXNNYW5hZ2VyID0gVUlGb2N1c01hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICBpZiAoZm9jdXNNYW5hZ2VyKSB7XG4gICAgICBmb2N1c01hbmFnZXIucmVxdWVzdEZvY3VzKHRoaXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBGYWxsYmFjayBpZiBubyBmb2N1cyBtYW5hZ2VyXG4gICAgICB0aGlzLm9uRm9jdXMoKTtcbiAgICB9XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBpbnB1dCByZWNlaXZlcyBmb2N1cyAob3ZlcnJpZGUgZnJvbSBiYXNlIGNsYXNzKVxuICAgKi9cbiAgb3ZlcnJpZGUgb25Gb2N1cygpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5mb2N1c2VkKSByZXR1cm47XG5cbiAgICBzdXBlci5vbkZvY3VzKCk7XG4gICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aDtcbiAgICB0aGlzLmN1cnNvci52aXNpYmxlID0gdHJ1ZTtcbiAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgIHRoaXMuc3RhcnRDdXJzb3JCbGluaygpO1xuXG4gICAgLy8gVXBkYXRlIGJhY2tncm91bmQgdG8gc2hvdyBmb2N1cyBzdGF0ZVxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5saWdodGVuQ29sb3IodGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsIDAuOTUpLFxuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGlucHV0IGxvc2VzIGZvY3VzIChvdmVycmlkZSBmcm9tIGJhc2UgY2xhc3MpXG4gICAqL1xuICBvdmVycmlkZSBvbkJsdXIoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmZvY3VzZWQpIHJldHVybjtcblxuICAgIHN1cGVyLm9uQmx1cigpO1xuICAgIHRoaXMuY3Vyc29yLnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLnN0b3BDdXJzb3JCbGluaygpO1xuXG4gICAgLy8gUmVzdG9yZSBub3JtYWwgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZUtleURvd24oZTogS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5mb2N1c2VkIHx8IHRoaXMucHJvcHMuZGlzYWJsZWQpIHJldHVybjtcblxuICAgIC8vIFN0b3AgZXZlbnQgZnJvbSBwcm9wYWdhdGluZ1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgY29uc3Qga2V5ID0gZS5rZXk7XG5cbiAgICBpZiAoa2V5ID09PSAnRW50ZXInKSB7XG4gICAgICB0aGlzLm9uQmx1cigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICB0aGlzLm9uQmx1cigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdCYWNrc3BhY2UnKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3JQb3NpdGlvbiA+IDApIHtcbiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPVxuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uIC0gMSkgK1xuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZyh0aGlzLmN1cnNvclBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbi0tO1xuICAgICAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnRGVsZXRlJykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPCB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPVxuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uKSArXG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKHRoaXMuY3Vyc29yUG9zaXRpb24gKyAxKTtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0Fycm93TGVmdCcpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uID4gMCkge1xuICAgICAgICB0aGlzLmN1cnNvclBvc2l0aW9uLS07XG4gICAgICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0Fycm93UmlnaHQnKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3JQb3NpdGlvbiA8IHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCkge1xuICAgICAgICB0aGlzLmN1cnNvclBvc2l0aW9uKys7XG4gICAgICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0hvbWUnKSB7XG4gICAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gMDtcbiAgICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0VuZCcpIHtcbiAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGg7XG4gICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEhhbmRsZSBjaGFyYWN0ZXIgaW5wdXRcbiAgICBpZiAoa2V5Lmxlbmd0aCA9PT0gMSAmJiAhZS5jdHJsS2V5ICYmICFlLm1ldGFLZXkpIHtcbiAgICAgIC8vIFR5cGUgdmFsaWRhdGlvblxuICAgICAgaWYgKHRoaXMucHJvcHMudHlwZSA9PT0gJ251bWJlcicgJiYgIS9bMC05Li1dLy50ZXN0KGtleSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBtYXggbGVuZ3RoXG4gICAgICBpZiAodGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoID49IHRoaXMucHJvcHMubWF4TGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gSW5zZXJ0IGNoYXJhY3RlciBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgIHRoaXMuY3VycmVudFZhbHVlID1cbiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24pICtcbiAgICAgICAga2V5ICtcbiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKHRoaXMuY3Vyc29yUG9zaXRpb24pO1xuICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbisrO1xuICAgICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIHRleHQgZGlzcGxheSBhbmQgdHJpZ2dlcnMgb25DaGFuZ2VcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlVGV4dCgpOiB2b2lkIHtcbiAgICB0aGlzLnRleHREaXNwbGF5LnRleHQgPSB0aGlzLmdldERpc3BsYXlUZXh0KCk7XG4gICAgdGhpcy50ZXh0RGlzcGxheS5zdHlsZS5maWxsID0gdGhpcy5jdXJyZW50VmFsdWUgPyB0aGlzLnByb3BzLnRleHRDb2xvciA6IHRoaXMucHJvcHMucGxhY2Vob2xkZXJDb2xvcjtcbiAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgIHRoaXMub25DaGFuZ2U/Lih0aGlzLmN1cnJlbnRWYWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyBjdXJzb3IgcG9zaXRpb24gdmlzdWFsbHlcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlQ3Vyc29yKCk6IHZvaWQge1xuICAgIC8vIE1lYXN1cmUgdGV4dCB1cCB0byBjdXJzb3IgcG9zaXRpb24gYnkgY3JlYXRpbmcgYSB0ZW1wb3JhcnkgdGV4dCBvYmplY3RcbiAgICBjb25zdCB0ZXh0VXBUb0N1cnNvciA9IHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uKTtcbiAgICBjb25zdCB0ZW1wVGV4dCA9IG5ldyBQSVhJLlRleHQoe1xuICAgICAgdGV4dDogdGV4dFVwVG9DdXJzb3IsXG4gICAgICBzdHlsZTogdGhpcy50ZXh0RGlzcGxheS5zdHlsZVxuICAgIH0pO1xuXG4gICAgY29uc3QgY3Vyc29yWCA9IDEyICsgdGVtcFRleHQud2lkdGg7XG4gICAgY29uc3QgY3Vyc29yWSA9ICh0aGlzLnByb3BzLmhlaWdodCAtIHRoaXMucHJvcHMuZm9udFNpemUpIC8gMjtcblxuICAgIHRoaXMuY3Vyc29yLmNsZWFyKCk7XG4gICAgdGhpcy5jdXJzb3IucmVjdChjdXJzb3JYLCBjdXJzb3JZLCAxLCB0aGlzLnByb3BzLmZvbnRTaXplKTtcbiAgICB0aGlzLmN1cnNvci5maWxsKHsgY29sb3I6IHRoaXMucHJvcHMudGV4dENvbG9yIH0pO1xuXG4gICAgLy8gQ2xlYW4gdXAgdGVtcCB0ZXh0XG4gICAgdGVtcFRleHQuZGVzdHJveSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0cyBjdXJzb3IgYmxpbmtpbmcgYW5pbWF0aW9uXG4gICAqL1xuICBwcml2YXRlIHN0YXJ0Q3Vyc29yQmxpbmsoKTogdm9pZCB7XG4gICAgdGhpcy5zdG9wQ3Vyc29yQmxpbmsoKTtcbiAgICB0aGlzLmN1cnNvclZpc2libGUgPSB0cnVlO1xuXG4gICAgdGhpcy5jdXJzb3JCbGlua0ludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHRoaXMuY3Vyc29yVmlzaWJsZSA9ICF0aGlzLmN1cnNvclZpc2libGU7XG4gICAgICB0aGlzLmN1cnNvci52aXNpYmxlID0gdGhpcy5jdXJzb3JWaXNpYmxlO1xuICAgIH0sIDUzMCk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcHMgY3Vyc29yIGJsaW5raW5nIGFuaW1hdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBzdG9wQ3Vyc29yQmxpbmsoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCkge1xuICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5jdXJzb3JCbGlua0ludGVydmFsKTtcbiAgICAgIHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTGlnaHRlbnMgYSBjb2xvciBieSBhIGZhY3RvclxuICAgKi9cbiAgcHJpdmF0ZSBsaWdodGVuQ29sb3IoY29sb3I6IG51bWJlciwgZmFjdG9yOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IHIgPSBNYXRoLm1pbigyNTUsICgoY29sb3IgPj4gMTYpICYgMHhmZikgLyBmYWN0b3IpO1xuICAgIGNvbnN0IGcgPSBNYXRoLm1pbigyNTUsICgoY29sb3IgPj4gOCkgJiAweGZmKSAvIGZhY3Rvcik7XG4gICAgY29uc3QgYiA9IE1hdGgubWluKDI1NSwgKGNvbG9yICYgMHhmZikgLyBmYWN0b3IpO1xuICAgIHJldHVybiAoKHIgPDwgMTYpIHwgKGcgPDwgOCkgfCBiKSA+Pj4gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgaW5wdXRcbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBsYXlvdXQgZm9yIHRoaXMgaW5wdXRcbiAgICovXG4gIGxheW91dChhdmFpbGFibGVXaWR0aDogbnVtYmVyLCBhdmFpbGFibGVIZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG5cbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG5cbiAgICAvLyBMYXlvdXQgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZC5sYXlvdXQobWVhc3VyZWQud2lkdGgsIG1lYXN1cmVkLmhlaWdodCk7XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSBpbnB1dFxuICAgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICAvLyBSZW5kZXJpbmcgaGFuZGxlZCBieSBiYWNrZ3JvdW5kLCB0ZXh0LCBhbmQgY3Vyc29yXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgdmFsdWUgcHJvZ3JhbW1hdGljYWxseVxuICAgKi9cbiAgc2V0VmFsdWUodmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gdmFsdWU7XG4gICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IHZhbHVlLmxlbmd0aDtcbiAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IHZhbHVlXG4gICAqL1xuICBnZXRWYWx1ZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIHdoZW4gZGVzdHJveWluZ1xuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLnN0b3BDdXJzb3JCbGluaygpO1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleURvd24uYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIHN1cGVyLmRlc3Ryb3koKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5pbXBvcnQgeyBVSVBhbmVsIH0gZnJvbSAnLi91aS1wYW5lbCc7XG5pbXBvcnQgeyBVSUZvY3VzTWFuYWdlciB9IGZyb20gJy4uL2NvcmUvdWktZm9jdXMtbWFuYWdlcic7XG5cbi8qKlxuICogUHJvcHMgZm9yIGNvbmZpZ3VyaW5nIGEgVUlUZXh0QXJlYVxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFVJVGV4dEFyZWFQcm9wcyB7XG4gIC8qKiBDdXJyZW50IHZhbHVlIChjb250cm9sbGVkKSAqL1xuICB2YWx1ZT86IHN0cmluZztcbiAgLyoqIERlZmF1bHQgdmFsdWUgKHVuY29udHJvbGxlZCkgKi9cbiAgZGVmYXVsdFZhbHVlPzogc3RyaW5nO1xuICAvKiogQ2hhbmdlIGNhbGxiYWNrICovXG4gIG9uQ2hhbmdlPzogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG4gIC8qKiBQbGFjZWhvbGRlciB0ZXh0IHdoZW4gZW1wdHkgKi9cbiAgcGxhY2Vob2xkZXI/OiBzdHJpbmc7XG4gIC8qKiBNYXhpbXVtIGNoYXJhY3RlciBsZW5ndGggKi9cbiAgbWF4TGVuZ3RoPzogbnVtYmVyO1xuICAvKiogV2lkdGggb2YgdGhlIHRleHRhcmVhICovXG4gIHdpZHRoPzogbnVtYmVyO1xuICAvKiogSGVpZ2h0IG9mIHRoZSB0ZXh0YXJlYSAqL1xuICBoZWlnaHQ/OiBudW1iZXI7XG4gIC8qKiBXaGV0aGVyIHRoZSB0ZXh0YXJlYSBpcyBkaXNhYmxlZCAqL1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yICovXG4gIGJhY2tncm91bmRDb2xvcj86IG51bWJlcjtcbiAgLyoqIFRleHQgY29sb3IgKi9cbiAgdGV4dENvbG9yPzogbnVtYmVyO1xuICAvKiogUGxhY2Vob2xkZXIgdGV4dCBjb2xvciAqL1xuICBwbGFjZWhvbGRlckNvbG9yPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG4gIC8qKiBGb250IHNpemUgKi9cbiAgZm9udFNpemU/OiBudW1iZXI7XG4gIC8qKiBMaW5lIGhlaWdodCBtdWx0aXBsaWVyIChlLmcuLCAxLjUgbWVhbnMgMS41eCB0aGUgZm9udCBzaXplKSAqL1xuICBsaW5lSGVpZ2h0PzogbnVtYmVyO1xuICAvKiogTnVtYmVyIG9mIHZpc2libGUgcm93cyAqL1xuICByb3dzPzogbnVtYmVyO1xufVxuXG4vKipcbiAqIEEgbXVsdGktbGluZSB0ZXh0IGFyZWEgY29tcG9uZW50XG4gKiBTdXBwb3J0cyB3b3JkIHdyYXBwaW5nIGFuZCBzY3JvbGxpbmdcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgdGV4dGFyZWEgPSBuZXcgVUlUZXh0QXJlYSh7XG4gKiAgIHBsYWNlaG9sZGVyOiAnRW50ZXIgeW91ciBtZXNzYWdlLi4uJyxcbiAqICAgb25DaGFuZ2U6ICh2YWx1ZSkgPT4gY29uc29sZS5sb2coJ01lc3NhZ2U6JywgdmFsdWUpLFxuICogICB3aWR0aDogNDAwLFxuICogICBoZWlnaHQ6IDEyMCxcbiAqICAgcm93czogNFxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJVGV4dEFyZWEgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFJlcXVpcmVkPE9taXQ8VUlUZXh0QXJlYVByb3BzLCAnb25DaGFuZ2UnIHwgJ3ZhbHVlJyB8ICdkZWZhdWx0VmFsdWUnPj47XG4gIHByaXZhdGUgb25DaGFuZ2U/OiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcblxuICBwcml2YXRlIGN1cnJlbnRWYWx1ZTogc3RyaW5nO1xuICBwcml2YXRlIGJhY2tncm91bmQ6IFVJUGFuZWw7XG4gIHByaXZhdGUgdGV4dERpc3BsYXk6IFBJWEkuVGV4dDtcbiAgcHJpdmF0ZSBjdXJzb3I6IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgY3Vyc29yUG9zaXRpb246IG51bWJlciA9IDA7XG4gIHByaXZhdGUgY3Vyc29yQmxpbmtJbnRlcnZhbD86IG51bWJlcjtcbiAgcHJpdmF0ZSBjdXJzb3JWaXNpYmxlOiBib29sZWFuID0gdHJ1ZTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlUZXh0QXJlYVByb3BzLCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgY29uc3QgZGVmYXVsdEhlaWdodCA9IChwcm9wcy5yb3dzID8/IDQpICogKHByb3BzLmZvbnRTaXplID8/IDE0KSAqIChwcm9wcy5saW5lSGVpZ2h0ID8/IDEuNSkgKyAyNDtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBwbGFjZWhvbGRlcjogcHJvcHMucGxhY2Vob2xkZXIgPz8gJycsXG4gICAgICBtYXhMZW5ndGg6IHByb3BzLm1heExlbmd0aCA/PyAxMDAwLFxuICAgICAgd2lkdGg6IHByb3BzLndpZHRoID8/IDQwMCxcbiAgICAgIGhlaWdodDogcHJvcHMuaGVpZ2h0ID8/IGRlZmF1bHRIZWlnaHQsXG4gICAgICBkaXNhYmxlZDogcHJvcHMuZGlzYWJsZWQgPz8gZmFsc2UsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHByb3BzLmJhY2tncm91bmRDb2xvciA/PyAweGZmZmZmZixcbiAgICAgIHRleHRDb2xvcjogcHJvcHMudGV4dENvbG9yID8/IDB4MDAwMDAwLFxuICAgICAgcGxhY2Vob2xkZXJDb2xvcjogcHJvcHMucGxhY2Vob2xkZXJDb2xvciA/PyAweDk5OTk5OSxcbiAgICAgIGJvcmRlclJhZGl1czogcHJvcHMuYm9yZGVyUmFkaXVzID8/IDQsXG4gICAgICBmb250U2l6ZTogcHJvcHMuZm9udFNpemUgPz8gMTQsXG4gICAgICBsaW5lSGVpZ2h0OiBwcm9wcy5saW5lSGVpZ2h0ID8/IDEuNSxcbiAgICAgIHJvd3M6IHByb3BzLnJvd3MgPz8gNFxuICAgIH07XG5cbiAgICB0aGlzLm9uQ2hhbmdlID0gcHJvcHMub25DaGFuZ2U7XG4gICAgdGhpcy5jdXJyZW50VmFsdWUgPSBwcm9wcy52YWx1ZSA/PyBwcm9wcy5kZWZhdWx0VmFsdWUgPz8gJyc7XG5cbiAgICAvLyBTZXQgYm94IG1vZGVsIGRpbWVuc2lvbnNcbiAgICB0aGlzLmJveE1vZGVsLndpZHRoID0gdGhpcy5wcm9wcy53aWR0aDtcbiAgICB0aGlzLmJveE1vZGVsLmhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuXG4gICAgLy8gQ3JlYXRlIGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuYmFja2dyb3VuZC5jb250YWluZXIpO1xuXG4gICAgLy8gQ3JlYXRlIHRleHQgZGlzcGxheSB3aXRoIHdvcmQgd3JhcHBpbmdcbiAgICB0aGlzLnRleHREaXNwbGF5ID0gbmV3IFBJWEkuVGV4dCh7XG4gICAgICB0ZXh0OiB0aGlzLmdldERpc3BsYXlUZXh0KCksXG4gICAgICBzdHlsZToge1xuICAgICAgICBmb250RmFtaWx5OiAnQXJpYWwnLFxuICAgICAgICBmb250U2l6ZTogdGhpcy5wcm9wcy5mb250U2l6ZSxcbiAgICAgICAgZmlsbDogdGhpcy5jdXJyZW50VmFsdWUgPyB0aGlzLnByb3BzLnRleHRDb2xvciA6IHRoaXMucHJvcHMucGxhY2Vob2xkZXJDb2xvcixcbiAgICAgICAgYWxpZ246ICdsZWZ0JyxcbiAgICAgICAgd29yZFdyYXA6IHRydWUsXG4gICAgICAgIHdvcmRXcmFwV2lkdGg6IHRoaXMucHJvcHMud2lkdGggLSAyNCxcbiAgICAgICAgbGluZUhlaWdodDogdGhpcy5wcm9wcy5mb250U2l6ZSAqIHRoaXMucHJvcHMubGluZUhlaWdodFxuICAgICAgfSxcbiAgICAgIHJlc29sdXRpb246IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDJcbiAgICB9KTtcbiAgICB0aGlzLnRleHREaXNwbGF5LnBvc2l0aW9uLnNldCgxMiwgMTIpO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMudGV4dERpc3BsYXkpO1xuXG4gICAgLy8gQ3JlYXRlIGN1cnNvclxuICAgIHRoaXMuY3Vyc29yID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0aGlzLmN1cnNvci52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5jdXJzb3IpO1xuXG4gICAgLy8gU2V0dXAgaW50ZXJhY3Rpdml0eVxuICAgIHRoaXMuc2V0dXBJbnRlcmFjdGl2aXR5KCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgZGlzcGxheSB0ZXh0ICh2YWx1ZSBvciBwbGFjZWhvbGRlcilcbiAgICovXG4gIHByaXZhdGUgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcbiAgICBpZiAodGhpcy5jdXJyZW50VmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucHJvcHMucGxhY2Vob2xkZXI7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB1cCBtb3VzZS9rZXlib2FyZCBldmVudCBoYW5kbGVyc1xuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cEludGVyYWN0aXZpdHkoKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgdGhpcy5jb250YWluZXIuY3Vyc29yID0gJ3RleHQnO1xuXG4gICAgLy8gQ2xpY2sgdG8gZm9jdXNcbiAgICB0aGlzLmNvbnRhaW5lci5vbigncG9pbnRlcmRvd24nLCB0aGlzLmhhbmRsZVBvaW50ZXJEb3duLmJpbmQodGhpcykpO1xuXG4gICAgLy8gTGlzdGVuIGZvciBnbG9iYWwga2V5Ym9hcmQgZXZlbnRzXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJEb3duKGU6IFBJWEkuRmVkZXJhdGVkUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZGlzYWJsZWQpIHJldHVybjtcblxuICAgIC8vIFJlcXVlc3QgZm9jdXMgdGhyb3VnaCB0aGUgZm9jdXMgbWFuYWdlclxuICAgIGNvbnN0IGZvY3VzTWFuYWdlciA9IFVJRm9jdXNNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gICAgaWYgKGZvY3VzTWFuYWdlcikge1xuICAgICAgZm9jdXNNYW5hZ2VyLnJlcXVlc3RGb2N1cyh0aGlzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRmFsbGJhY2sgaWYgbm8gZm9jdXMgbWFuYWdlclxuICAgICAgdGhpcy5vbkZvY3VzKCk7XG4gICAgfVxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gdGV4dGFyZWEgcmVjZWl2ZXMgZm9jdXMgKG92ZXJyaWRlIGZyb20gYmFzZSBjbGFzcylcbiAgICovXG4gIG92ZXJyaWRlIG9uRm9jdXMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNlZCkgcmV0dXJuO1xuXG4gICAgc3VwZXIub25Gb2N1cygpO1xuICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGg7XG4gICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IHRydWU7XG4gICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICB0aGlzLnN0YXJ0Q3Vyc29yQmxpbmsoKTtcblxuICAgIC8vIFVwZGF0ZSBiYWNrZ3JvdW5kIHRvIHNob3cgZm9jdXMgc3RhdGVcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMubGlnaHRlbkNvbG9yKHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLCAwLjk1KSxcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiB0ZXh0YXJlYSBsb3NlcyBmb2N1cyAob3ZlcnJpZGUgZnJvbSBiYXNlIGNsYXNzKVxuICAgKi9cbiAgb3ZlcnJpZGUgb25CbHVyKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5mb2N1c2VkKSByZXR1cm47XG5cbiAgICBzdXBlci5vbkJsdXIoKTtcbiAgICB0aGlzLmN1cnNvci52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5zdG9wQ3Vyc29yQmxpbmsoKTtcblxuICAgIC8vIFJlc3RvcmUgbm9ybWFsIGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVLZXlEb3duKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZm9jdXNlZCB8fCB0aGlzLnByb3BzLmRpc2FibGVkKSByZXR1cm47XG5cbiAgICAvLyBEb24ndCBwcmV2ZW50IGRlZmF1bHQgZm9yIFRhYiAoYWxsb3cgdGFiIG5hdmlnYXRpb24pXG4gICAgaWYgKGUua2V5ICE9PSAnVGFiJykge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG5cbiAgICBjb25zdCBrZXkgPSBlLmtleTtcblxuICAgIC8vIEVudGVyIGFkZHMgbmV3IGxpbmUgaW4gdGV4dGFyZWFcbiAgICBpZiAoa2V5ID09PSAnRW50ZXInKSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoIDwgdGhpcy5wcm9wcy5tYXhMZW5ndGgpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPVxuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uKSArXG4gICAgICAgICAgJ1xcbicgK1xuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZyh0aGlzLmN1cnNvclBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbisrO1xuICAgICAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5vbkJsdXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQmFja3NwYWNlJykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPiAwKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlID1cbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbiAtIDEpICtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcodGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24tLTtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0RlbGV0ZScpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uIDwgdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlID1cbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbikgK1xuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZyh0aGlzLmN1cnNvclBvc2l0aW9uICsgMSk7XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdBcnJvd0xlZnQnKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3JQb3NpdGlvbiA+IDApIHtcbiAgICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbi0tO1xuICAgICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdBcnJvd1JpZ2h0Jykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPCB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbisrO1xuICAgICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdBcnJvd1VwJykge1xuICAgICAgLy8gTW92ZSBjdXJzb3IgdXAgb25lIGxpbmVcbiAgICAgIHRoaXMubW92ZUN1cnNvclZlcnRpY2FsbHkoLTEpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdBcnJvd0Rvd24nKSB7XG4gICAgICAvLyBNb3ZlIGN1cnNvciBkb3duIG9uZSBsaW5lXG4gICAgICB0aGlzLm1vdmVDdXJzb3JWZXJ0aWNhbGx5KDEpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdIb21lJykge1xuICAgICAgLy8gTW92ZSB0byBzdGFydCBvZiBjdXJyZW50IGxpbmVcbiAgICAgIGNvbnN0IGxpbmVTdGFydCA9IHRoaXMuY3VycmVudFZhbHVlLmxhc3RJbmRleE9mKCdcXG4nLCB0aGlzLmN1cnNvclBvc2l0aW9uIC0gMSkgKyAxO1xuICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IGxpbmVTdGFydDtcbiAgICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0VuZCcpIHtcbiAgICAgIC8vIE1vdmUgdG8gZW5kIG9mIGN1cnJlbnQgbGluZVxuICAgICAgbGV0IGxpbmVFbmQgPSB0aGlzLmN1cnJlbnRWYWx1ZS5pbmRleE9mKCdcXG4nLCB0aGlzLmN1cnNvclBvc2l0aW9uKTtcbiAgICAgIGlmIChsaW5lRW5kID09PSAtMSkgbGluZUVuZCA9IHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aDtcbiAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSBsaW5lRW5kO1xuICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgY2hhcmFjdGVyIGlucHV0XG4gICAgaWYgKGtleS5sZW5ndGggPT09IDEgJiYgIWUuY3RybEtleSAmJiAhZS5tZXRhS2V5KSB7XG4gICAgICAvLyBDaGVjayBtYXggbGVuZ3RoXG4gICAgICBpZiAodGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoID49IHRoaXMucHJvcHMubWF4TGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gSW5zZXJ0IGNoYXJhY3RlciBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgIHRoaXMuY3VycmVudFZhbHVlID1cbiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24pICtcbiAgICAgICAga2V5ICtcbiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKHRoaXMuY3Vyc29yUG9zaXRpb24pO1xuICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbisrO1xuICAgICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1vdmVzIGN1cnNvciB2ZXJ0aWNhbGx5IGJ5IHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIGxpbmVzXG4gICAqL1xuICBwcml2YXRlIG1vdmVDdXJzb3JWZXJ0aWNhbGx5KGRpcmVjdGlvbjogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbGluZXMgPSB0aGlzLmN1cnJlbnRWYWx1ZS5zcGxpdCgnXFxuJyk7XG4gICAgbGV0IGN1cnJlbnRMaW5lID0gMDtcbiAgICBsZXQgcG9zaXRpb25JbkxpbmUgPSAwO1xuICAgIGxldCBjaGFyQ291bnQgPSAwO1xuXG4gICAgLy8gRmluZCBjdXJyZW50IGxpbmUgYW5kIHBvc2l0aW9uXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGNoYXJDb3VudCArIGxpbmVzW2ldLmxlbmd0aCA+PSB0aGlzLmN1cnNvclBvc2l0aW9uKSB7XG4gICAgICAgIGN1cnJlbnRMaW5lID0gaTtcbiAgICAgICAgcG9zaXRpb25JbkxpbmUgPSB0aGlzLmN1cnNvclBvc2l0aW9uIC0gY2hhckNvdW50O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNoYXJDb3VudCArPSBsaW5lc1tpXS5sZW5ndGggKyAxOyAvLyArMSBmb3IgbmV3bGluZVxuICAgIH1cblxuICAgIC8vIE1vdmUgdG8gdGFyZ2V0IGxpbmVcbiAgICBjb25zdCB0YXJnZXRMaW5lID0gTWF0aC5tYXgoMCwgTWF0aC5taW4obGluZXMubGVuZ3RoIC0gMSwgY3VycmVudExpbmUgKyBkaXJlY3Rpb24pKTtcbiAgICBpZiAodGFyZ2V0TGluZSA9PT0gY3VycmVudExpbmUpIHJldHVybjtcblxuICAgIC8vIENhbGN1bGF0ZSBuZXcgY3Vyc29yIHBvc2l0aW9uXG4gICAgbGV0IG5ld1Bvc2l0aW9uID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldExpbmU7IGkrKykge1xuICAgICAgbmV3UG9zaXRpb24gKz0gbGluZXNbaV0ubGVuZ3RoICsgMTtcbiAgICB9XG4gICAgbmV3UG9zaXRpb24gKz0gTWF0aC5taW4ocG9zaXRpb25JbkxpbmUsIGxpbmVzW3RhcmdldExpbmVdLmxlbmd0aCk7XG5cbiAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gbmV3UG9zaXRpb247XG4gICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSB0ZXh0IGRpc3BsYXkgYW5kIHRyaWdnZXJzIG9uQ2hhbmdlXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZVRleHQoKTogdm9pZCB7XG4gICAgdGhpcy50ZXh0RGlzcGxheS50ZXh0ID0gdGhpcy5nZXREaXNwbGF5VGV4dCgpO1xuICAgIHRoaXMudGV4dERpc3BsYXkuc3R5bGUuZmlsbCA9IHRoaXMuY3VycmVudFZhbHVlID8gdGhpcy5wcm9wcy50ZXh0Q29sb3IgOiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyQ29sb3I7XG4gICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICB0aGlzLm9uQ2hhbmdlPy4odGhpcy5jdXJyZW50VmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgY3Vyc29yIHBvc2l0aW9uIHZpc3VhbGx5XG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZUN1cnNvcigpOiB2b2lkIHtcbiAgICAvLyBHZXQgdGV4dCBtZXRyaWNzIHVwIHRvIGN1cnNvciBwb3NpdGlvblxuICAgIGNvbnN0IHRleHRVcFRvQ3Vyc29yID0gdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24pO1xuXG4gICAgLy8gQ3JlYXRlIHRlbXBvcmFyeSB0ZXh0IHRvIG1lYXN1cmVcbiAgICBjb25zdCB0ZW1wVGV4dCA9IG5ldyBQSVhJLlRleHQoe1xuICAgICAgdGV4dDogdGV4dFVwVG9DdXJzb3IsXG4gICAgICBzdHlsZToge1xuICAgICAgICAuLi50aGlzLnRleHREaXNwbGF5LnN0eWxlLFxuICAgICAgICB3b3JkV3JhcDogdHJ1ZSxcbiAgICAgICAgd29yZFdyYXBXaWR0aDogdGhpcy5wcm9wcy53aWR0aCAtIDI0XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBHZXQgdGhlIGJvdW5kcyB0byBmaW5kIGN1cnNvciBwb3NpdGlvblxuICAgIGNvbnN0IG1ldHJpY3MgPSB0ZW1wVGV4dC5nZXRMb2NhbEJvdW5kcygpO1xuXG4gICAgLy8gRm9yIG11bHRpLWxpbmUsIHdlIG5lZWQgdG8gZmluZCB0aGUgbGFzdCBsaW5lIHBvc2l0aW9uXG4gICAgY29uc3QgbGluZXMgPSB0ZXh0VXBUb0N1cnNvci5zcGxpdCgnXFxuJyk7XG4gICAgY29uc3QgbGFzdExpbmUgPSBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXTtcblxuICAgIGNvbnN0IGxhc3RMaW5lVGV4dCA9IG5ldyBQSVhJLlRleHQoe1xuICAgICAgdGV4dDogbGFzdExpbmUsXG4gICAgICBzdHlsZTogdGhpcy50ZXh0RGlzcGxheS5zdHlsZVxuICAgIH0pO1xuXG4gICAgY29uc3QgY3Vyc29yWCA9IDEyICsgbGFzdExpbmVUZXh0LndpZHRoO1xuICAgIGNvbnN0IGN1cnNvclkgPSAxMiArIChsaW5lcy5sZW5ndGggLSAxKSAqICh0aGlzLnByb3BzLmZvbnRTaXplICogdGhpcy5wcm9wcy5saW5lSGVpZ2h0KTtcblxuICAgIHRoaXMuY3Vyc29yLmNsZWFyKCk7XG4gICAgdGhpcy5jdXJzb3IucmVjdChjdXJzb3JYLCBjdXJzb3JZLCAxLCB0aGlzLnByb3BzLmZvbnRTaXplKTtcbiAgICB0aGlzLmN1cnNvci5maWxsKHsgY29sb3I6IHRoaXMucHJvcHMudGV4dENvbG9yIH0pO1xuXG4gICAgLy8gQ2xlYW4gdXAgdGVtcCBvYmplY3RzXG4gICAgdGVtcFRleHQuZGVzdHJveSgpO1xuICAgIGxhc3RMaW5lVGV4dC5kZXN0cm95KCk7XG4gIH1cblxuICAvKipcbiAgICogU3RhcnRzIGN1cnNvciBibGlua2luZyBhbmltYXRpb25cbiAgICovXG4gIHByaXZhdGUgc3RhcnRDdXJzb3JCbGluaygpOiB2b2lkIHtcbiAgICB0aGlzLnN0b3BDdXJzb3JCbGluaygpO1xuICAgIHRoaXMuY3Vyc29yVmlzaWJsZSA9IHRydWU7XG5cbiAgICB0aGlzLmN1cnNvckJsaW5rSW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgdGhpcy5jdXJzb3JWaXNpYmxlID0gIXRoaXMuY3Vyc29yVmlzaWJsZTtcbiAgICAgIHRoaXMuY3Vyc29yLnZpc2libGUgPSB0aGlzLmN1cnNvclZpc2libGU7XG4gICAgfSwgNTMwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wcyBjdXJzb3IgYmxpbmtpbmcgYW5pbWF0aW9uXG4gICAqL1xuICBwcml2YXRlIHN0b3BDdXJzb3JCbGluaygpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jdXJzb3JCbGlua0ludGVydmFsKSB7XG4gICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmN1cnNvckJsaW5rSW50ZXJ2YWwpO1xuICAgICAgdGhpcy5jdXJzb3JCbGlua0ludGVydmFsID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMaWdodGVucyBhIGNvbG9yIGJ5IGEgZmFjdG9yXG4gICAqL1xuICBwcml2YXRlIGxpZ2h0ZW5Db2xvcihjb2xvcjogbnVtYmVyLCBmYWN0b3I6IG51bWJlcik6IG51bWJlciB7XG4gICAgY29uc3QgciA9IE1hdGgubWluKDI1NSwgKChjb2xvciA+PiAxNikgJiAweGZmKSAvIGZhY3Rvcik7XG4gICAgY29uc3QgZyA9IE1hdGgubWluKDI1NSwgKChjb2xvciA+PiA4KSAmIDB4ZmYpIC8gZmFjdG9yKTtcbiAgICBjb25zdCBiID0gTWF0aC5taW4oMjU1LCAoY29sb3IgJiAweGZmKSAvIGZhY3Rvcik7XG4gICAgcmV0dXJuICgociA8PCAxNikgfCAoZyA8PCA4KSB8IGIpID4+PiAwO1xuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmVzIHRoZSBzaXplIG5lZWRlZCBmb3IgdGhpcyB0ZXh0YXJlYVxuICAgKi9cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHRcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGxheW91dCBmb3IgdGhpcyB0ZXh0YXJlYVxuICAgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcblxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcblxuICAgIC8vIExheW91dCBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kLmxheW91dChtZWFzdXJlZC53aWR0aCwgbWVhc3VyZWQuaGVpZ2h0KTtcblxuICAgIHRoaXMubGF5b3V0RGlydHkgPSBmYWxzZTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIHRleHRhcmVhXG4gICAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIC8vIFJlbmRlcmluZyBoYW5kbGVkIGJ5IGJhY2tncm91bmQsIHRleHQsIGFuZCBjdXJzb3JcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSB2YWx1ZSBwcm9ncmFtbWF0aWNhbGx5XG4gICAqL1xuICBzZXRWYWx1ZSh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5jdXJyZW50VmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gdmFsdWUubGVuZ3RoO1xuICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgdmFsdWVcbiAgICovXG4gIGdldFZhbHVlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFZhbHVlO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFudXAgd2hlbiBkZXN0cm95aW5nXG4gICAqL1xuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuc3RvcEN1cnNvckJsaW5rKCk7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpKTtcbiAgICB9XG4gICAgc3VwZXIuZGVzdHJveSgpO1xuICB9XG59XG4iLCJpbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi9lZGdlLWluc2V0cyc7XG5cbi8qKlxuICogU2l6ZSBjb25zdHJhaW50IHZhbHVlcyBmb3IgVUkgY29tcG9uZW50c1xuICogQ2FuIGJlIGEgZml4ZWQgbnVtYmVyLCAnYXV0bycgdG8gZml0IGNvbnRlbnQsIG9yICdmaWxsJyB0byBleHBhbmRcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IHR5cGUgU2l6ZUNvbnN0cmFpbnQgPSBudW1iZXIgfCAnYXV0bycgfCAnZmlsbCc7XG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgYm94IG1vZGVsIGZvciBhIFVJIGNvbXBvbmVudFxuICogU2ltaWxhciB0byBDU1MgYm94IG1vZGVsIHdpdGggd2lkdGgsIGhlaWdodCwgcGFkZGluZywgbWFyZ2luLCBhbmQgYm9yZGVyXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQm94TW9kZWwge1xuICAvLyBDb250ZW50IGFyZWEgZGltZW5zaW9uc1xuICB3aWR0aDogU2l6ZUNvbnN0cmFpbnQ7XG4gIGhlaWdodDogU2l6ZUNvbnN0cmFpbnQ7XG5cbiAgLy8gU2l6ZSBjb25zdHJhaW50c1xuICBtaW5XaWR0aD86IG51bWJlcjtcbiAgbWluSGVpZ2h0PzogbnVtYmVyO1xuICBtYXhXaWR0aD86IG51bWJlcjtcbiAgbWF4SGVpZ2h0PzogbnVtYmVyO1xuXG4gIC8vIFNwYWNpbmdcbiAgcGFkZGluZzogRWRnZUluc2V0cztcbiAgbWFyZ2luOiBFZGdlSW5zZXRzO1xuXG4gIC8vIEJvcmRlciAodmlzdWFsIGJvcmRlciB3aWxsIGJlIGltcGxlbWVudGVkIGxhdGVyKVxuICBib3JkZXI/OiBFZGdlSW5zZXRzO1xufVxuXG4vKipcbiAqIFRoZSBjb21wdXRlZC9hY3R1YWwgbGF5b3V0IG9mIGEgY29tcG9uZW50IGFmdGVyIG1lYXN1cmVtZW50XG4gKiBBbGwgdmFsdWVzIGFyZSBjb25jcmV0ZSBwaXhlbCB2YWx1ZXNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDb21wdXRlZExheW91dCB7XG4gIC8vIFBvc2l0aW9uIHJlbGF0aXZlIHRvIHBhcmVudFxuICB4OiBudW1iZXI7XG4gIHk6IG51bWJlcjtcblxuICAvLyBGaW5hbCBkaW1lbnNpb25zXG4gIHdpZHRoOiBudW1iZXI7XG4gIGhlaWdodDogbnVtYmVyO1xuXG4gIC8vIENvbnRlbnQgYXJlYSAoaW5zaWRlIHBhZGRpbmcpXG4gIGNvbnRlbnRYOiBudW1iZXI7XG4gIGNvbnRlbnRZOiBudW1iZXI7XG4gIGNvbnRlbnRXaWR0aDogbnVtYmVyO1xuICBjb250ZW50SGVpZ2h0OiBudW1iZXI7XG59XG5cbi8qKlxuICogUmVzdWx0IG9mIG1lYXN1cmluZyBhIGNvbXBvbmVudCdzIHNpemVcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBNZWFzdXJlZFNpemUge1xuICB3aWR0aDogbnVtYmVyO1xuICBoZWlnaHQ6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gY3JlYXRlIGEgZGVmYXVsdCBCb3hNb2RlbFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEJveE1vZGVsKG92ZXJyaWRlcz86IFBhcnRpYWw8Qm94TW9kZWw+KTogQm94TW9kZWwge1xuICByZXR1cm4ge1xuICAgIHdpZHRoOiAnYXV0bycsXG4gICAgaGVpZ2h0OiAnYXV0bycsXG4gICAgcGFkZGluZzogRWRnZUluc2V0cy56ZXJvKCksXG4gICAgbWFyZ2luOiBFZGdlSW5zZXRzLnplcm8oKSxcbiAgICAuLi5vdmVycmlkZXNcbiAgfTtcbn1cbiIsIi8qKlxuICogUmVwcmVzZW50cyBzcGFjaW5nIHZhbHVlcyBmb3IgdGhlIGVkZ2VzIG9mIGEgYm94ICh0b3AsIHJpZ2h0LCBib3R0b20sIGxlZnQpLlxuICogU2ltaWxhciB0byBDU1MgcGFkZGluZy9tYXJnaW4gc3ludGF4LlxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgY2xhc3MgRWRnZUluc2V0cyB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIEVkZ2VJbnNldHMgd2l0aCBzcGVjaWZpYyB2YWx1ZXMgZm9yIGVhY2ggZWRnZVxuICAgKlxuICAgKiBAcGFyYW0gdG9wIC0gVG9wIGVkZ2Ugc3BhY2luZ1xuICAgKiBAcGFyYW0gcmlnaHQgLSBSaWdodCBlZGdlIHNwYWNpbmdcbiAgICogQHBhcmFtIGJvdHRvbSAtIEJvdHRvbSBlZGdlIHNwYWNpbmdcbiAgICogQHBhcmFtIGxlZnQgLSBMZWZ0IGVkZ2Ugc3BhY2luZ1xuICAgKi9cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHRvcDogbnVtYmVyLFxuICAgIHB1YmxpYyByaWdodDogbnVtYmVyLFxuICAgIHB1YmxpYyBib3R0b206IG51bWJlcixcbiAgICBwdWJsaWMgbGVmdDogbnVtYmVyXG4gICkge31cblxuICAvKipcbiAgICogQ3JlYXRlcyBFZGdlSW5zZXRzIHdpdGggdGhlIHNhbWUgdmFsdWUgZm9yIGFsbCBlZGdlc1xuICAgKiBTaW1pbGFyIHRvIENTUzogcGFkZGluZzogMTBweFxuICAgKlxuICAgKiBAcGFyYW0gdmFsdWUgLSBUaGUgdmFsdWUgdG8gYXBwbHkgdG8gYWxsIGVkZ2VzXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogY29uc3QgcGFkZGluZyA9IEVkZ2VJbnNldHMuYWxsKDIwKTsgLy8gMjBweCBvbiBhbGwgc2lkZXNcbiAgICogYGBgXG4gICAqL1xuICBzdGF0aWMgYWxsKHZhbHVlOiBudW1iZXIpOiBFZGdlSW5zZXRzIHtcbiAgICByZXR1cm4gbmV3IEVkZ2VJbnNldHModmFsdWUsIHZhbHVlLCB2YWx1ZSwgdmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgRWRnZUluc2V0cyB3aXRoIHN5bW1ldHJpYyB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCB2YWx1ZXNcbiAgICogU2ltaWxhciB0byBDU1M6IHBhZGRpbmc6IDEwcHggMjBweFxuICAgKlxuICAgKiBAcGFyYW0gdmVydGljYWwgLSBWYWx1ZSBmb3IgdG9wIGFuZCBib3R0b20gZWRnZXNcbiAgICogQHBhcmFtIGhvcml6b250YWwgLSBWYWx1ZSBmb3IgbGVmdCBhbmQgcmlnaHQgZWRnZXNcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBjb25zdCBwYWRkaW5nID0gRWRnZUluc2V0cy5zeW1tZXRyaWMoMTAsIDIwKTsgLy8gMTBweCB0b3AvYm90dG9tLCAyMHB4IGxlZnQvcmlnaHRcbiAgICogYGBgXG4gICAqL1xuICBzdGF0aWMgc3ltbWV0cmljKHZlcnRpY2FsOiBudW1iZXIsIGhvcml6b250YWw6IG51bWJlcik6IEVkZ2VJbnNldHMge1xuICAgIHJldHVybiBuZXcgRWRnZUluc2V0cyh2ZXJ0aWNhbCwgaG9yaXpvbnRhbCwgdmVydGljYWwsIGhvcml6b250YWwpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgRWRnZUluc2V0cyB3aXRoIHNwZWNpZmljIHZhbHVlcyBmb3IgaW5kaXZpZHVhbCBlZGdlc1xuICAgKiBTaW1pbGFyIHRvIENTUzogcGFkZGluZy10b3AsIHBhZGRpbmctcmlnaHQsIGV0Yy5cbiAgICpcbiAgICogQHBhcmFtIGVkZ2VzIC0gT2JqZWN0IHdpdGggb3B0aW9uYWwgdG9wLCByaWdodCwgYm90dG9tLCBsZWZ0IHZhbHVlcyAoZGVmYXVsdHMgdG8gMClcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBjb25zdCBwYWRkaW5nID0gRWRnZUluc2V0cy5vbmx5KHsgdG9wOiAxMCwgbGVmdDogMjAgfSk7IC8vIDEwcHggdG9wLCAyMHB4IGxlZnQsIDBweCByaWdodC9ib3R0b21cbiAgICogYGBgXG4gICAqL1xuICBzdGF0aWMgb25seShlZGdlczogeyB0b3A/OiBudW1iZXI7IHJpZ2h0PzogbnVtYmVyOyBib3R0b20/OiBudW1iZXI7IGxlZnQ/OiBudW1iZXIgfSk6IEVkZ2VJbnNldHMge1xuICAgIHJldHVybiBuZXcgRWRnZUluc2V0cyhcbiAgICAgIGVkZ2VzLnRvcCA/PyAwLFxuICAgICAgZWRnZXMucmlnaHQgPz8gMCxcbiAgICAgIGVkZ2VzLmJvdHRvbSA/PyAwLFxuICAgICAgZWRnZXMubGVmdCA/PyAwXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIEVkZ2VJbnNldHMgd2l0aCB6ZXJvIHNwYWNpbmcgb24gYWxsIGVkZ2VzXG4gICAqIFNpbWlsYXIgdG8gQ1NTOiBwYWRkaW5nOiAwXG4gICAqL1xuICBzdGF0aWMgemVybygpOiBFZGdlSW5zZXRzIHtcbiAgICByZXR1cm4gbmV3IEVkZ2VJbnNldHMoMCwgMCwgMCwgMCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgdG90YWwgaG9yaXpvbnRhbCBzcGFjaW5nIChsZWZ0ICsgcmlnaHQpXG4gICAqL1xuICBnZXQgaG9yaXpvbnRhbCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmxlZnQgKyB0aGlzLnJpZ2h0O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHRvdGFsIHZlcnRpY2FsIHNwYWNpbmcgKHRvcCArIGJvdHRvbSlcbiAgICovXG4gIGdldCB2ZXJ0aWNhbCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnRvcCArIHRoaXMuYm90dG9tO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBjb3B5IG9mIHRoZXNlIEVkZ2VJbnNldHNcbiAgICovXG4gIGNsb25lKCk6IEVkZ2VJbnNldHMge1xuICAgIHJldHVybiBuZXcgRWRnZUluc2V0cyh0aGlzLnRvcCwgdGhpcy5yaWdodCwgdGhpcy5ib3R0b20sIHRoaXMubGVmdCk7XG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgQm94TW9kZWwsIENvbXB1dGVkTGF5b3V0LCBNZWFzdXJlZFNpemUsIGNyZWF0ZURlZmF1bHRCb3hNb2RlbCB9IGZyb20gJy4vYm94LW1vZGVsJztcblxuLyoqXG4gKiBCYXNlIGFic3RyYWN0IGNsYXNzIGZvciBhbGwgVUkgY29tcG9uZW50c1xuICogUHJvdmlkZXMgYm94IG1vZGVsLCBsYXlvdXQsIGFuZCByZW5kZXJpbmcgZnVuY3Rpb25hbGl0eVxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgVUlDb21wb25lbnQge1xuICAvKipcbiAgICogVGhlIFBJWEkgY29udGFpbmVyIHRoYXQgaG9sZHMgdGhpcyBjb21wb25lbnQncyB2aXN1YWwgcmVwcmVzZW50YXRpb25cbiAgICovXG4gIHB1YmxpYyBjb250YWluZXI6IFBJWEkuQ29udGFpbmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgYm94IG1vZGVsIGRlZmluaW5nIHRoaXMgY29tcG9uZW50J3Mgc2l6aW5nIGFuZCBzcGFjaW5nXG4gICAqL1xuICBwcm90ZWN0ZWQgYm94TW9kZWw6IEJveE1vZGVsO1xuXG4gIC8qKlxuICAgKiBGb2N1cyByaW5nIGZvciB2aXN1YWwgZm9jdXMgaW5kaWNhdGlvblxuICAgKi9cbiAgcHJvdGVjdGVkIGZvY3VzUmluZz86IFBJWEkuR3JhcGhpY3M7XG5cbiAgLyoqXG4gICAqIFRoZSBjb21wdXRlZCBsYXlvdXQgYWZ0ZXIgbWVhc3VyZW1lbnQgYW5kIHBvc2l0aW9uaW5nXG4gICAqL1xuICBwcm90ZWN0ZWQgY29tcHV0ZWRMYXlvdXQ6IENvbXB1dGVkTGF5b3V0O1xuXG4gIC8qKlxuICAgKiBSZWZlcmVuY2UgdG8gcGFyZW50IGNvbXBvbmVudCAoaWYgYW55KVxuICAgKi9cbiAgcHVibGljIHBhcmVudD86IFVJQ29tcG9uZW50O1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoaXMgY29tcG9uZW50IGlzIGN1cnJlbnRseSB2aXNpYmxlXG4gICAqL1xuICBwdWJsaWMgdmlzaWJsZTogYm9vbGVhbiA9IHRydWU7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhpcyBjb21wb25lbnQgaXMgZW5hYmxlZCBmb3IgaW50ZXJhY3Rpb25cbiAgICovXG4gIHB1YmxpYyBlbmFibGVkOiBib29sZWFuID0gdHJ1ZTtcblxuICAvKipcbiAgICogRmxhZyBpbmRpY2F0aW5nIGlmIGxheW91dCBuZWVkcyB0byBiZSByZWNhbGN1bGF0ZWRcbiAgICovXG4gIHByb3RlY3RlZCBsYXlvdXREaXJ0eTogYm9vbGVhbiA9IHRydWU7XG5cbiAgLyoqXG4gICAqIFRhYiBpbmRleCBmb3IgZm9jdXMgb3JkZXIgKC0xIG1lYW5zIG5vdCBmb2N1c2FibGUgYnkgdGFiKVxuICAgKi9cbiAgcHVibGljIHRhYkluZGV4OiBudW1iZXIgPSAtMTtcblxuICAvKipcbiAgICogSW50ZXJuYWwgZm9jdXMgc3RhdGVcbiAgICovXG4gIHByb3RlY3RlZCBmb2N1c2VkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHRoaXMuY29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgdGhpcy5ib3hNb2RlbCA9IGNyZWF0ZURlZmF1bHRCb3hNb2RlbChib3hNb2RlbCk7XG4gICAgdGhpcy5jb21wdXRlZExheW91dCA9IHtcbiAgICAgIHg6IDAsXG4gICAgICB5OiAwLFxuICAgICAgd2lkdGg6IDAsXG4gICAgICBoZWlnaHQ6IDAsXG4gICAgICBjb250ZW50WDogMCxcbiAgICAgIGNvbnRlbnRZOiAwLFxuICAgICAgY29udGVudFdpZHRoOiAwLFxuICAgICAgY29udGVudEhlaWdodDogMFxuICAgIH07XG5cbiAgICAvLyBDcmVhdGUgZm9jdXMgcmluZyAoaW5pdGlhbGx5IGhpZGRlbilcbiAgICB0aGlzLmNyZWF0ZUZvY3VzUmluZygpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgdGhlIGZvY3VzIHJpbmcgZ3JhcGhpY3NcbiAgICovXG4gIHByaXZhdGUgY3JlYXRlRm9jdXNSaW5nKCk6IHZvaWQge1xuICAgIHRoaXMuZm9jdXNSaW5nID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0aGlzLmZvY3VzUmluZy52aXNpYmxlID0gZmFsc2U7XG4gICAgLy8gQWRkIGFzIGZpcnN0IGNoaWxkIHNvIGl0IHJlbmRlcnMgYmVoaW5kIGNvbnRlbnRcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZEF0KHRoaXMuZm9jdXNSaW5nLCAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBmb2N1cyByaW5nIGFwcGVhcmFuY2UgYmFzZWQgb24gY29tcG9uZW50IHNpemVcbiAgICovXG4gIHByb3RlY3RlZCB1cGRhdGVGb2N1c1JpbmcoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmZvY3VzUmluZykgcmV0dXJuO1xuXG4gICAgdGhpcy5mb2N1c1JpbmcuY2xlYXIoKTtcblxuICAgIGNvbnN0IHdpZHRoID0gdGhpcy5jb21wdXRlZExheW91dC53aWR0aDtcbiAgICBjb25zdCBoZWlnaHQgPSB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodDtcblxuICAgIGlmICh3aWR0aCA8PSAwIHx8IGhlaWdodCA8PSAwKSByZXR1cm47XG5cbiAgICAvLyBBbmltYXRlZCBwdWxzaW5nIGVmZmVjdCB3aXRoIGRhc2hlZCBvdXRsaW5lXG4gICAgY29uc3Qgb2Zmc2V0ID0gNDtcbiAgICBjb25zdCBzdHJva2VXaWR0aCA9IDM7XG5cbiAgICAvLyBEcmF3IG91dGVyIGdsb3dcbiAgICB0aGlzLmZvY3VzUmluZy5yb3VuZFJlY3QoXG4gICAgICAtb2Zmc2V0IC0gMixcbiAgICAgIC1vZmZzZXQgLSAyLFxuICAgICAgd2lkdGggKyAob2Zmc2V0ICsgMikgKiAyLFxuICAgICAgaGVpZ2h0ICsgKG9mZnNldCArIDIpICogMixcbiAgICAgIDhcbiAgICApO1xuICAgIHRoaXMuZm9jdXNSaW5nLnN0cm9rZSh7XG4gICAgICBjb2xvcjogMHgwMGQ5ZmYsXG4gICAgICB3aWR0aDogc3Ryb2tlV2lkdGggKyAyLFxuICAgICAgYWxwaGE6IDAuM1xuICAgIH0pO1xuXG4gICAgLy8gRHJhdyBtYWluIGZvY3VzIHJpbmdcbiAgICB0aGlzLmZvY3VzUmluZy5yb3VuZFJlY3QoXG4gICAgICAtb2Zmc2V0LFxuICAgICAgLW9mZnNldCxcbiAgICAgIHdpZHRoICsgb2Zmc2V0ICogMixcbiAgICAgIGhlaWdodCArIG9mZnNldCAqIDIsXG4gICAgICA4XG4gICAgKTtcbiAgICB0aGlzLmZvY3VzUmluZy5zdHJva2Uoe1xuICAgICAgY29sb3I6IDB4MDBkOWZmLFxuICAgICAgd2lkdGg6IHN0cm9rZVdpZHRoXG4gICAgfSk7XG5cbiAgICAvLyBEcmF3IGlubmVyIGhpZ2hsaWdodFxuICAgIHRoaXMuZm9jdXNSaW5nLnJvdW5kUmVjdChcbiAgICAgIC1vZmZzZXQgKyBzdHJva2VXaWR0aCxcbiAgICAgIC1vZmZzZXQgKyBzdHJva2VXaWR0aCxcbiAgICAgIHdpZHRoICsgKG9mZnNldCAtIHN0cm9rZVdpZHRoKSAqIDIsXG4gICAgICBoZWlnaHQgKyAob2Zmc2V0IC0gc3Ryb2tlV2lkdGgpICogMixcbiAgICAgIDZcbiAgICApO1xuICAgIHRoaXMuZm9jdXNSaW5nLnN0cm9rZSh7XG4gICAgICBjb2xvcjogMHhmZmZmZmYsXG4gICAgICB3aWR0aDogMSxcbiAgICAgIGFscGhhOiAwLjZcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSB0aGlzIGNvbXBvbmVudCBuZWVkc1xuICAgKiBNdXN0IGJlIGltcGxlbWVudGVkIGJ5IHN1YmNsYXNzZXNcbiAgICpcbiAgICogQHJldHVybnMgVGhlIG1lYXN1cmVkIHdpZHRoIGFuZCBoZWlnaHRcbiAgICovXG4gIGFic3RyYWN0IG1lYXN1cmUoKTogTWVhc3VyZWRTaXplO1xuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBsYXlvdXQgZm9yIHRoaXMgY29tcG9uZW50IHdpdGhpbiB0aGUgZ2l2ZW4gYXZhaWxhYmxlIHNwYWNlXG4gICAqIE11c3QgYmUgaW1wbGVtZW50ZWQgYnkgc3ViY2xhc3Nlc1xuICAgKlxuICAgKiBAcGFyYW0gYXZhaWxhYmxlV2lkdGggLSBBdmFpbGFibGUgd2lkdGggaW4gcGl4ZWxzXG4gICAqIEBwYXJhbSBhdmFpbGFibGVIZWlnaHQgLSBBdmFpbGFibGUgaGVpZ2h0IGluIHBpeGVsc1xuICAgKi9cbiAgYWJzdHJhY3QgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZDtcblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgY29tcG9uZW50J3MgdmlzdWFsc1xuICAgKiBDYWxsZWQgYWZ0ZXIgbGF5b3V0IGlzIGNvbXBsZXRlXG4gICAqL1xuICBwcm90ZWN0ZWQgYWJzdHJhY3QgcmVuZGVyKCk6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIE1hcmtzIHRoaXMgY29tcG9uZW50J3MgbGF5b3V0IGFzIGRpcnR5LCByZXF1aXJpbmcgcmVjYWxjdWxhdGlvblxuICAgKi9cbiAgcHVibGljIG1hcmtMYXlvdXREaXJ0eSgpOiB2b2lkIHtcbiAgICB0aGlzLmxheW91dERpcnR5ID0gdHJ1ZTtcbiAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgIHRoaXMucGFyZW50Lm1hcmtMYXlvdXREaXJ0eSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjb21wdXRlZCBsYXlvdXQgb2YgdGhpcyBjb21wb25lbnRcbiAgICovXG4gIHB1YmxpYyBnZXRMYXlvdXQoKTogQ29tcHV0ZWRMYXlvdXQge1xuICAgIHJldHVybiB0aGlzLmNvbXB1dGVkTGF5b3V0O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGJveCBtb2RlbCBvZiB0aGlzIGNvbXBvbmVudFxuICAgKi9cbiAgcHVibGljIGdldEJveE1vZGVsKCk6IEJveE1vZGVsIHtcbiAgICByZXR1cm4gdGhpcy5ib3hNb2RlbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBnbG9iYWwgYm91bmRzIG9mIHRoaXMgY29tcG9uZW50IChwb3NpdGlvbiByZWxhdGl2ZSB0byBzdGFnZSlcbiAgICovXG4gIHB1YmxpYyBnZXRHbG9iYWxCb3VuZHMoKTogeyB4OiBudW1iZXI7IHk6IG51bWJlcjsgd2lkdGg6IG51bWJlcjsgaGVpZ2h0OiBudW1iZXIgfSB7XG4gICAgY29uc3QgZ2xvYmFsUG9zID0gdGhpcy5jb250YWluZXIuZ2V0R2xvYmFsUG9zaXRpb24oKTtcbiAgICByZXR1cm4ge1xuICAgICAgeDogZ2xvYmFsUG9zLngsXG4gICAgICB5OiBnbG9iYWxQb3MueSxcbiAgICAgIHdpZHRoOiB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgcG9zaXRpb24gb2YgdGhpcyBjb21wb25lbnRcbiAgICovXG4gIHB1YmxpYyBzZXRQb3NpdGlvbih4OiBudW1iZXIsIHk6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQueCA9IHg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC55ID0geTtcbiAgICB0aGlzLmNvbnRhaW5lci5wb3NpdGlvbi5zZXQoeCwgeSk7XG4gIH1cblxuICAvKipcbiAgICogU2hvd3MgdGhpcyBjb21wb25lbnRcbiAgICovXG4gIHB1YmxpYyBzaG93KCk6IHZvaWQge1xuICAgIHRoaXMudmlzaWJsZSA9IHRydWU7XG4gICAgdGhpcy5jb250YWluZXIudmlzaWJsZSA9IHRydWU7XG4gIH1cblxuICAvKipcbiAgICogSGlkZXMgdGhpcyBjb21wb25lbnRcbiAgICovXG4gIHB1YmxpYyBoaWRlKCk6IHZvaWQge1xuICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlO1xuICAgIHRoaXMuY29udGFpbmVyLnZpc2libGUgPSBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoaXMgY29tcG9uZW50IGNhbiByZWNlaXZlIGZvY3VzXG4gICAqL1xuICBwdWJsaWMgY2FuRm9jdXMoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZW5hYmxlZCAmJiB0aGlzLnZpc2libGUgJiYgdGhpcy50YWJJbmRleCA+PSAwO1xuICB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhpcyBjb21wb25lbnQgaXMgY3VycmVudGx5IGZvY3VzZWRcbiAgICovXG4gIHB1YmxpYyBpc0ZvY3VzZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZm9jdXNlZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBjb21wb25lbnQgcmVjZWl2ZXMgZm9jdXNcbiAgICogT3ZlcnJpZGUgaW4gc3ViY2xhc3NlcyB0byBjdXN0b21pemUgZm9jdXMgYmVoYXZpb3JcbiAgICovXG4gIHB1YmxpYyBvbkZvY3VzKCk6IHZvaWQge1xuICAgIHRoaXMuZm9jdXNlZCA9IHRydWU7XG4gICAgdGhpcy5zaG93Rm9jdXNSaW5nKCk7XG4gICAgdGhpcy5zY3JvbGxJbnRvVmlldygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNob3dzIHRoZSBmb2N1cyByaW5nXG4gICAqL1xuICBwcm90ZWN0ZWQgc2hvd0ZvY3VzUmluZygpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5mb2N1c1JpbmcpIHtcbiAgICAgIHRoaXMudXBkYXRlRm9jdXNSaW5nKCk7XG4gICAgICB0aGlzLmZvY3VzUmluZy52aXNpYmxlID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xscyB0aGlzIGNvbXBvbmVudCBpbnRvIHZpZXcgaWYgaXQncyBpbnNpZGUgYSBzY3JvbGwgY29udGFpbmVyXG4gICAqL1xuICBwcml2YXRlIHNjcm9sbEludG9WaWV3KCk6IHZvaWQge1xuICAgIC8vIFdhbGsgdXAgdGhlIHBhcmVudCBjaGFpbiB0byBmaW5kIGEgc2Nyb2xsIGNvbnRhaW5lclxuICAgIGxldCBjdXJyZW50UGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgd2hpbGUgKGN1cnJlbnRQYXJlbnQpIHtcbiAgICAgIC8vIENoZWNrIGlmIHBhcmVudCBoYXMgc2Nyb2xsVG9Db21wb25lbnQgbWV0aG9kIChkdWNrIHR5cGluZyBmb3IgVUlTY3JvbGxDb250YWluZXIpXG4gICAgICBpZiAoJ3Njcm9sbFRvQ29tcG9uZW50JyBpbiBjdXJyZW50UGFyZW50ICYmIHR5cGVvZiAoY3VycmVudFBhcmVudCBhcyBhbnkpLnNjcm9sbFRvQ29tcG9uZW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIChjdXJyZW50UGFyZW50IGFzIGFueSkuc2Nyb2xsVG9Db21wb25lbnQodGhpcyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY3VycmVudFBhcmVudCA9IGN1cnJlbnRQYXJlbnQucGFyZW50O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBjb21wb25lbnQgbG9zZXMgZm9jdXNcbiAgICogT3ZlcnJpZGUgaW4gc3ViY2xhc3NlcyB0byBjdXN0b21pemUgYmx1ciBiZWhhdmlvclxuICAgKi9cbiAgcHVibGljIG9uQmx1cigpOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzZWQgPSBmYWxzZTtcbiAgICB0aGlzLmhpZGVGb2N1c1JpbmcoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIaWRlcyB0aGUgZm9jdXMgcmluZ1xuICAgKi9cbiAgcHJvdGVjdGVkIGhpZGVGb2N1c1JpbmcoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNSaW5nKSB7XG4gICAgICB0aGlzLmZvY3VzUmluZy52aXNpYmxlID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERlc3Ryb3lzIHRoaXMgY29tcG9uZW50IGFuZCBjbGVhbnMgdXAgcmVzb3VyY2VzXG4gICAqL1xuICBwdWJsaWMgZGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5kZXN0cm95KHsgY2hpbGRyZW46IHRydWUgfSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi91aS1jb21wb25lbnQnO1xuXG4vKipcbiAqIEludGVyZmFjZSBmb3IgZm9jdXNhYmxlIFVJIGNvbXBvbmVudHNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGb2N1c2FibGUge1xuICAvKiogV2hldGhlciB0aGlzIGNvbXBvbmVudCBjYW4gcmVjZWl2ZSBmb2N1cyAqL1xuICBjYW5Gb2N1cygpOiBib29sZWFuO1xuICAvKiogQ2FsbGVkIHdoZW4gY29tcG9uZW50IHJlY2VpdmVzIGZvY3VzICovXG4gIG9uRm9jdXMoKTogdm9pZDtcbiAgLyoqIENhbGxlZCB3aGVuIGNvbXBvbmVudCBsb3NlcyBmb2N1cyAqL1xuICBvbkJsdXIoKTogdm9pZDtcbiAgLyoqIFRoZSB0YWIgaW5kZXggZm9yIGZvY3VzIG9yZGVyIChsb3dlciB2YWx1ZXMgZm9jdXNlZCBmaXJzdCkgKi9cbiAgdGFiSW5kZXg6IG51bWJlcjtcbiAgLyoqIFdoZXRoZXIgdGhpcyBjb21wb25lbnQgaXMgY3VycmVudGx5IGZvY3VzZWQgKi9cbiAgaXNGb2N1c2VkKCk6IGJvb2xlYW47XG59XG5cbi8qKlxuICogTWFuYWdlcyBrZXlib2FyZCBmb2N1cyBhbmQgdGFiIG5hdmlnYXRpb24gZm9yIFVJIGNvbXBvbmVudHNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgZm9jdXNNYW5hZ2VyID0gbmV3IFVJRm9jdXNNYW5hZ2VyKCk7XG4gKiBmb2N1c01hbmFnZXIucmVnaXN0ZXIoYnV0dG9uMSk7XG4gKiBmb2N1c01hbmFnZXIucmVnaXN0ZXIodGV4dElucHV0MSk7XG4gKiBmb2N1c01hbmFnZXIucmVnaXN0ZXIoYnV0dG9uMik7XG4gKlxuICogLy8gRm9jdXMgZmlyc3QgY29tcG9uZW50XG4gKiBmb2N1c01hbmFnZXIuZm9jdXNGaXJzdCgpO1xuICpcbiAqIC8vIE9yIGZvY3VzIHNwZWNpZmljIGNvbXBvbmVudFxuICogZm9jdXNNYW5hZ2VyLmZvY3VzKHRleHRJbnB1dDEpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSUZvY3VzTWFuYWdlciB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBVSUZvY3VzTWFuYWdlciB8IG51bGwgPSBudWxsO1xuXG4gIHByaXZhdGUgZm9jdXNhYmxlQ29tcG9uZW50czogKFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKVtdID0gW107XG4gIHByaXZhdGUgY3VycmVudEZvY3VzSW5kZXg6IG51bWJlciA9IC0xO1xuICBwcml2YXRlIGtleWRvd25IYW5kbGVyOiAoKGU6IEtleWJvYXJkRXZlbnQpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zZXR1cEtleWJvYXJkTGlzdGVuZXJzKCk7XG4gICAgLy8gU2V0IGFzIHNpbmdsZXRvbiBpbnN0YW5jZVxuICAgIFVJRm9jdXNNYW5hZ2VyLmluc3RhbmNlID0gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IGdsb2JhbCBmb2N1cyBtYW5hZ2VyIGluc3RhbmNlXG4gICAqL1xuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogVUlGb2N1c01hbmFnZXIgfCBudWxsIHtcbiAgICByZXR1cm4gVUlGb2N1c01hbmFnZXIuaW5zdGFuY2U7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB1cCBnbG9iYWwga2V5Ym9hcmQgbGlzdGVuZXJzIGZvciB0YWIgbmF2aWdhdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cEtleWJvYXJkTGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykgcmV0dXJuO1xuXG4gICAgdGhpcy5rZXlkb3duSGFuZGxlciA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09ICdUYWInKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBpZiAoZS5zaGlmdEtleSkge1xuICAgICAgICAgIHRoaXMuZm9jdXNQcmV2aW91cygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZm9jdXNOZXh0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmtleWRvd25IYW5kbGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlcnMgYSBmb2N1c2FibGUgY29tcG9uZW50XG4gICAqL1xuICByZWdpc3Rlcihjb21wb25lbnQ6IFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMuaW5jbHVkZXMoY29tcG9uZW50KSkge1xuICAgICAgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICAgIHRoaXMuc29ydEJ5VGFiSW5kZXgoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXV0b21hdGljYWxseSBkaXNjb3ZlcnMgYW5kIHJlZ2lzdGVycyBhbGwgZm9jdXNhYmxlIGNvbXBvbmVudHMgaW4gYSBjb250YWluZXJcbiAgICogV2Fsa3MgdGhlIGNvbXBvbmVudCB0cmVlIGFuZCBmaW5kcyBhbGwgY29tcG9uZW50cyB3aXRoIHRhYkluZGV4ID49IDBcbiAgICovXG4gIHJlZ2lzdGVyQ29udGFpbmVyKGNvbnRhaW5lcjogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICB0aGlzLmRpc2NvdmVyRm9jdXNhYmxlQ29tcG9uZW50cyhjb250YWluZXIpO1xuICAgIHRoaXMuc29ydEJ5VGFiSW5kZXgoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWN1cnNpdmVseSBkaXNjb3ZlcnMgZm9jdXNhYmxlIGNvbXBvbmVudHMgaW4gdGhlIHRyZWVcbiAgICovXG4gIHByaXZhdGUgZGlzY292ZXJGb2N1c2FibGVDb21wb25lbnRzKGNvbXBvbmVudDogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygn8J+UjiBEaXNjb3ZlcmluZyBpbiBjb21wb25lbnQ6JywgY29tcG9uZW50LmNvbnN0cnVjdG9yLm5hbWUsICd0YWJJbmRleDonLCBjb21wb25lbnQudGFiSW5kZXgpO1xuXG4gICAgLy8gQ2hlY2sgaWYgdGhpcyBjb21wb25lbnQgaXMgZm9jdXNhYmxlXG4gICAgaWYgKHRoaXMuaXNGb2N1c2FibGVDb21wb25lbnQoY29tcG9uZW50KSkge1xuICAgICAgY29uc29sZS5sb2coJyAg4pyFIFJlZ2lzdGVyaW5nIGZvY3VzYWJsZTonLCBjb21wb25lbnQuY29uc3RydWN0b3IubmFtZSk7XG4gICAgICB0aGlzLnJlZ2lzdGVyKGNvbXBvbmVudCBhcyBVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSk7XG4gICAgfVxuXG4gICAgLy8gUmVjdXJzaXZlbHkgY2hlY2sgY2hpbGRyZW4gKGlmIGl0J3MgYSBjb250YWluZXIgdHlwZSlcbiAgICBpZiAoJ2NoaWxkcmVuJyBpbiBjb21wb25lbnQgJiYgQXJyYXkuaXNBcnJheSgoY29tcG9uZW50IGFzIGFueSkuY2hpbGRyZW4pKSB7XG4gICAgICBjb25zdCBjaGlsZHJlbiA9IChjb21wb25lbnQgYXMgYW55KS5jaGlsZHJlbiBhcyBVSUNvbXBvbmVudFtdO1xuICAgICAgY29uc29sZS5sb2coYCAg8J+TpiBIYXMgJHtjaGlsZHJlbi5sZW5ndGh9IGNoaWxkcmVuYCk7XG4gICAgICBjaGlsZHJlbi5mb3JFYWNoKGNoaWxkID0+IHRoaXMuZGlzY292ZXJGb2N1c2FibGVDb21wb25lbnRzKGNoaWxkKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBhIGNvbXBvbmVudCBpbXBsZW1lbnRzIHRoZSBGb2N1c2FibGUgaW50ZXJmYWNlXG4gICAqL1xuICBwcml2YXRlIGlzRm9jdXNhYmxlQ29tcG9uZW50KGNvbXBvbmVudDogVUlDb21wb25lbnQpOiBjb21wb25lbnQgaXMgVUlDb21wb25lbnQgJiBGb2N1c2FibGUge1xuICAgIHJldHVybiAoXG4gICAgICB0eXBlb2YgY29tcG9uZW50LnRhYkluZGV4ID09PSAnbnVtYmVyJyAmJlxuICAgICAgY29tcG9uZW50LnRhYkluZGV4ID49IDAgJiZcbiAgICAgIHR5cGVvZiBjb21wb25lbnQuY2FuRm9jdXMgPT09ICdmdW5jdGlvbicgJiZcbiAgICAgIHR5cGVvZiBjb21wb25lbnQub25Gb2N1cyA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgdHlwZW9mIGNvbXBvbmVudC5vbkJsdXIgPT09ICdmdW5jdGlvbicgJiZcbiAgICAgIHR5cGVvZiBjb21wb25lbnQuaXNGb2N1c2VkID09PSAnZnVuY3Rpb24nXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVbnJlZ2lzdGVycyBhIGZvY3VzYWJsZSBjb21wb25lbnRcbiAgICovXG4gIHVucmVnaXN0ZXIoY29tcG9uZW50OiBVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSk6IHZvaWQge1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmluZGV4T2YoY29tcG9uZW50KTtcbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICBpZiAoaW5kZXggPT09IHRoaXMuY3VycmVudEZvY3VzSW5kZXgpIHtcbiAgICAgICAgdGhpcy5ibHVyKCk7XG4gICAgICB9XG4gICAgICB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRGb2N1c0luZGV4ID4gaW5kZXgpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50Rm9jdXNJbmRleC0tO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTb3J0cyBjb21wb25lbnRzIGJ5IHRhYiBpbmRleFxuICAgKi9cbiAgcHJpdmF0ZSBzb3J0QnlUYWJJbmRleCgpOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMuc29ydCgoYSwgYikgPT4gYS50YWJJbmRleCAtIGIudGFiSW5kZXgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEZvY3VzZXMgYSBzcGVjaWZpYyBjb21wb25lbnRcbiAgICovXG4gIGZvY3VzKGNvbXBvbmVudDogVUlDb21wb25lbnQgJiBGb2N1c2FibGUpOiB2b2lkIHtcbiAgICBpZiAoIWNvbXBvbmVudC5jYW5Gb2N1cygpKSB7XG4gICAgICBjb25zb2xlLmxvZygn4p2MIENvbXBvbmVudCBjYW5ub3QgZm9jdXMnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBpbmRleCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5pbmRleE9mKGNvbXBvbmVudCk7XG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgY29uc29sZS5sb2coJ+KdjCBDb21wb25lbnQgbm90IHJlZ2lzdGVyZWQgaW4gZm9jdXMgbWFuYWdlcicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGDwn46vIEZvY3VzaW5nIGNvbXBvbmVudCBhdCBpbmRleCAke2luZGV4fSwgY3VycmVudCBpbmRleDogJHt0aGlzLmN1cnJlbnRGb2N1c0luZGV4fWApO1xuXG4gICAgLy8gQmx1ciBjdXJyZW50IGZvY3VzXG4gICAgaWYgKHRoaXMuY3VycmVudEZvY3VzSW5kZXggIT09IC0xICYmIHRoaXMuY3VycmVudEZvY3VzSW5kZXggIT09IGluZGV4KSB7XG4gICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzW3RoaXMuY3VycmVudEZvY3VzSW5kZXhdO1xuICAgICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgICAgY29uc29sZS5sb2coYCAg8J+RiyBCbHVycmluZyBjb21wb25lbnQgYXQgaW5kZXggJHt0aGlzLmN1cnJlbnRGb2N1c0luZGV4fWApO1xuICAgICAgICBjdXJyZW50Lm9uQmx1cigpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZvY3VzIG5ldyBjb21wb25lbnRcbiAgICB0aGlzLmN1cnJlbnRGb2N1c0luZGV4ID0gaW5kZXg7XG4gICAgY29uc29sZS5sb2coYCAg4pyFIENhbGxpbmcgb25Gb2N1cygpIG9uIGNvbXBvbmVudGApO1xuICAgIGNvbXBvbmVudC5vbkZvY3VzKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVxdWVzdCBmb2N1cyBmb3IgYSBjb21wb25lbnQgKGNhbGxlZCBieSBjb21wb25lbnRzIHdoZW4gY2xpY2tlZClcbiAgICogVGhpcyBpcyBhIGhlbHBlciB0aGF0IGZpbmRzIHRoZSBjb21wb25lbnQgYW5kIGNhbGxzIGZvY3VzKClcbiAgICovXG4gIHJlcXVlc3RGb2N1cyhjb21wb25lbnQ6IFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKTogdm9pZCB7XG4gICAgdGhpcy5mb2N1cyhjb21wb25lbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEJsdXJzIHRoZSBjdXJyZW50bHkgZm9jdXNlZCBjb21wb25lbnRcbiAgICovXG4gIGJsdXIoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY3VycmVudEZvY3VzSW5kZXggIT09IC0xKSB7XG4gICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzW3RoaXMuY3VycmVudEZvY3VzSW5kZXhdO1xuICAgICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgICAgY3VycmVudC5vbkJsdXIoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY3VycmVudEZvY3VzSW5kZXggPSAtMTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRm9jdXNlcyB0aGUgbmV4dCBjb21wb25lbnQgaW4gdGFiIG9yZGVyXG4gICAqL1xuICBmb2N1c05leHQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIGxldCBuZXh0SW5kZXggPSB0aGlzLmN1cnJlbnRGb2N1c0luZGV4ICsgMTtcbiAgICBsZXQgYXR0ZW1wdHMgPSAwO1xuXG4gICAgLy8gRmluZCBuZXh0IGZvY3VzYWJsZSBjb21wb25lbnRcbiAgICB3aGlsZSAoYXR0ZW1wdHMgPCB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoKSB7XG4gICAgICBpZiAobmV4dEluZGV4ID49IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGgpIHtcbiAgICAgICAgbmV4dEluZGV4ID0gMDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY29tcG9uZW50ID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzW25leHRJbmRleF07XG4gICAgICBpZiAoY29tcG9uZW50ICYmIGNvbXBvbmVudC5jYW5Gb2N1cygpKSB7XG4gICAgICAgIHRoaXMuZm9jdXMoY29tcG9uZW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBuZXh0SW5kZXgrKztcbiAgICAgIGF0dGVtcHRzKys7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZvY3VzZXMgdGhlIHByZXZpb3VzIGNvbXBvbmVudCBpbiB0YWIgb3JkZXJcbiAgICovXG4gIGZvY3VzUHJldmlvdXMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIGxldCBwcmV2SW5kZXggPSB0aGlzLmN1cnJlbnRGb2N1c0luZGV4IC0gMTtcbiAgICBsZXQgYXR0ZW1wdHMgPSAwO1xuXG4gICAgLy8gRmluZCBwcmV2aW91cyBmb2N1c2FibGUgY29tcG9uZW50XG4gICAgd2hpbGUgKGF0dGVtcHRzIDwgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmxlbmd0aCkge1xuICAgICAgaWYgKHByZXZJbmRleCA8IDApIHtcbiAgICAgICAgcHJldkluZGV4ID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmxlbmd0aCAtIDE7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1twcmV2SW5kZXhdO1xuICAgICAgaWYgKGNvbXBvbmVudCAmJiBjb21wb25lbnQuY2FuRm9jdXMoKSkge1xuICAgICAgICB0aGlzLmZvY3VzKGNvbXBvbmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgcHJldkluZGV4LS07XG4gICAgICBhdHRlbXB0cysrO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGb2N1c2VzIHRoZSBmaXJzdCBmb2N1c2FibGUgY29tcG9uZW50XG4gICAqL1xuICBmb2N1c0ZpcnN0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMpIHtcbiAgICAgIGlmIChjb21wb25lbnQuY2FuRm9jdXMoKSkge1xuICAgICAgICB0aGlzLmZvY3VzKGNvbXBvbmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRm9jdXNlcyB0aGUgbGFzdCBmb2N1c2FibGUgY29tcG9uZW50XG4gICAqL1xuICBmb2N1c0xhc3QoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIGZvciAobGV0IGkgPSB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1tpXTtcbiAgICAgIGlmIChjb21wb25lbnQuY2FuRm9jdXMoKSkge1xuICAgICAgICB0aGlzLmZvY3VzKGNvbXBvbmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudGx5IGZvY3VzZWQgY29tcG9uZW50XG4gICAqL1xuICBnZXRDdXJyZW50Rm9jdXMoKTogKFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKSB8IG51bGwge1xuICAgIGlmICh0aGlzLmN1cnJlbnRGb2N1c0luZGV4ID09PSAtMSkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1t0aGlzLmN1cnJlbnRGb2N1c0luZGV4XSB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgYWxsIHJlZ2lzdGVyZWQgZm9jdXNhYmxlIGNvbXBvbmVudHNcbiAgICovXG4gIGdldEZvY3VzYWJsZUNvbXBvbmVudHMoKTogKFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKVtdIHtcbiAgICByZXR1cm4gWy4uLnRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c107XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXJzIGFsbCByZWdpc3RlcmVkIGNvbXBvbmVudHNcbiAgICovXG4gIGNsZWFyKCk6IHZvaWQge1xuICAgIHRoaXMuYmx1cigpO1xuICAgIHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cyA9IFtdO1xuICAgIHRoaXMuY3VycmVudEZvY3VzSW5kZXggPSAtMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIHdoZW4gZGVzdHJveWluZyB0aGUgZm9jdXMgbWFuYWdlclxuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdGhpcy5rZXlkb3duSGFuZGxlcikge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmtleWRvd25IYW5kbGVyKTtcbiAgICB9XG4gICAgdGhpcy5jbGVhcigpO1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcbmltcG9ydCB7IEVkZ2VJbnNldHMgfSBmcm9tICcuLi9jb3JlL2VkZ2UtaW5zZXRzJztcblxuLyoqXG4gKiBGbGV4Ym94IGRpcmVjdGlvbiAoaG93IGNoaWxkcmVuIGFyZSBhcnJhbmdlZClcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGVudW0gRmxleERpcmVjdGlvbiB7XG4gIFJvdyA9ICdyb3cnLCAgICAgICAgICAgICAgLy8gSG9yaXpvbnRhbCwgbGVmdCB0byByaWdodFxuICBSb3dSZXZlcnNlID0gJ3Jvdy1yZXZlcnNlJyxcbiAgQ29sdW1uID0gJ2NvbHVtbicsICAgICAgICAvLyBWZXJ0aWNhbCwgdG9wIHRvIGJvdHRvbVxuICBDb2x1bW5SZXZlcnNlID0gJ2NvbHVtbi1yZXZlcnNlJ1xufVxuXG4vKipcbiAqIEZsZXhib3gganVzdGlmeSBjb250ZW50IChtYWluIGF4aXMgYWxpZ25tZW50KVxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgZW51bSBGbGV4SnVzdGlmeSB7XG4gIFN0YXJ0ID0gJ3N0YXJ0JywgICAgICAgICAgLy8gUGFjayBpdGVtcyB0byBzdGFydFxuICBFbmQgPSAnZW5kJywgICAgICAgICAgICAgIC8vIFBhY2sgaXRlbXMgdG8gZW5kXG4gIENlbnRlciA9ICdjZW50ZXInLCAgICAgICAgLy8gQ2VudGVyIGl0ZW1zXG4gIFNwYWNlQmV0d2VlbiA9ICdzcGFjZS1iZXR3ZWVuJywgIC8vIFNwYWNlIGJldHdlZW4gaXRlbXNcbiAgU3BhY2VBcm91bmQgPSAnc3BhY2UtYXJvdW5kJywgICAgLy8gU3BhY2UgYXJvdW5kIGl0ZW1zXG4gIFNwYWNlRXZlbmx5ID0gJ3NwYWNlLWV2ZW5seScgICAgIC8vIEV2ZW4gc3BhY2UgYmV0d2VlbiBpdGVtc1xufVxuXG4vKipcbiAqIEZsZXhib3ggYWxpZ24gaXRlbXMgKGNyb3NzIGF4aXMgYWxpZ25tZW50KVxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgZW51bSBGbGV4QWxpZ24ge1xuICBTdGFydCA9ICdzdGFydCcsXG4gIEVuZCA9ICdlbmQnLFxuICBDZW50ZXIgPSAnY2VudGVyJyxcbiAgU3RyZXRjaCA9ICdzdHJldGNoJyAgICAgICAvLyBTdHJldGNoIHRvIGZpbGwgY3Jvc3MgYXhpc1xufVxuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIEZsZXhDb250YWluZXJcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGbGV4Q29udGFpbmVyUHJvcHMge1xuICBkaXJlY3Rpb24/OiBGbGV4RGlyZWN0aW9uO1xuICBqdXN0aWZ5PzogRmxleEp1c3RpZnk7XG4gIGFsaWduPzogRmxleEFsaWduO1xuICBnYXA/OiBudW1iZXI7ICAgICAgICAgICAgICAvLyBTcGFjZSBiZXR3ZWVuIGNoaWxkcmVuXG4gIHdyYXA/OiBib29sZWFuOyAgICAgICAgICAgIC8vIEFsbG93IHdyYXBwaW5nIChQaGFzZSAyKVxuICBwYWRkaW5nPzogRWRnZUluc2V0cztcbiAgd2lkdGg/OiBudW1iZXIgfCAnZmlsbCc7XG4gIGhlaWdodD86IG51bWJlciB8ICdmaWxsJztcbn1cblxuLyoqXG4gKiBBIGZsZXhib3gtc3R5bGUgbGF5b3V0IGNvbnRhaW5lclxuICogQXJyYW5nZXMgY2hpbGRyZW4gaW4gcm93cyBvciBjb2x1bW5zIHdpdGggZmxleGlibGUgc2l6aW5nIGFuZCBhbGlnbm1lbnRcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgY29udGFpbmVyID0gbmV3IEZsZXhDb250YWluZXIoe1xuICogICBkaXJlY3Rpb246IEZsZXhEaXJlY3Rpb24uUm93LFxuICogICBqdXN0aWZ5OiBGbGV4SnVzdGlmeS5DZW50ZXIsXG4gKiAgIGdhcDogMTAsXG4gKiAgIHBhZGRpbmc6IEVkZ2VJbnNldHMuYWxsKDIwKVxuICogfSk7XG4gKlxuICogY29udGFpbmVyLmFkZENoaWxkKGJveDEpO1xuICogY29udGFpbmVyLmFkZENoaWxkKGJveDIpO1xuICogY29udGFpbmVyLmFkZENoaWxkKGJveDMpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBGbGV4Q29udGFpbmVyIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxPbWl0PEZsZXhDb250YWluZXJQcm9wcywgJ3BhZGRpbmcnIHwgJ3dpZHRoJyB8ICdoZWlnaHQnPj47XG4gIHB1YmxpYyBjaGlsZHJlbjogVUlDb21wb25lbnRbXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBGbGV4Q29udGFpbmVyUHJvcHMgPSB7fSkge1xuICAgIGNvbnN0IGJveE1vZGVsOiBQYXJ0aWFsPEJveE1vZGVsPiA9IHtcbiAgICAgIHBhZGRpbmc6IHByb3BzLnBhZGRpbmcgPz8gRWRnZUluc2V0cy56ZXJvKCksXG4gICAgICB3aWR0aDogcHJvcHMud2lkdGggPz8gJ2F1dG8nLFxuICAgICAgaGVpZ2h0OiBwcm9wcy5oZWlnaHQgPz8gJ2F1dG8nXG4gICAgfTtcblxuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBkaXJlY3Rpb246IHByb3BzLmRpcmVjdGlvbiA/PyBGbGV4RGlyZWN0aW9uLlJvdyxcbiAgICAgIGp1c3RpZnk6IHByb3BzLmp1c3RpZnkgPz8gRmxleEp1c3RpZnkuU3RhcnQsXG4gICAgICBhbGlnbjogcHJvcHMuYWxpZ24gPz8gRmxleEFsaWduLlN0YXJ0LFxuICAgICAgZ2FwOiBwcm9wcy5nYXAgPz8gMCxcbiAgICAgIHdyYXA6IHByb3BzLndyYXAgPz8gZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBjaGlsZCBjb21wb25lbnQgdG8gdGhpcyBjb250YWluZXJcbiAgICovXG4gIGFkZENoaWxkKGNoaWxkOiBVSUNvbXBvbmVudCk6IHZvaWQge1xuICAgIGNoaWxkLnBhcmVudCA9IHRoaXM7XG4gICAgdGhpcy5jaGlsZHJlbi5wdXNoKGNoaWxkKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZChjaGlsZC5jb250YWluZXIpO1xuICAgIHRoaXMubWFya0xheW91dERpcnR5KCk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhIGNoaWxkIGNvbXBvbmVudCBmcm9tIHRoaXMgY29udGFpbmVyXG4gICAqL1xuICByZW1vdmVDaGlsZChjaGlsZDogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuY2hpbGRyZW4uaW5kZXhPZihjaGlsZCk7XG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlQ2hpbGQoY2hpbGQuY29udGFpbmVyKTtcbiAgICAgIGNoaWxkLnBhcmVudCA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMubWFya0xheW91dERpcnR5KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmVzIHRoZSBzaXplIG5lZWRlZCBmb3IgdGhpcyBjb250YWluZXIgYW5kIGl0cyBjaGlsZHJlblxuICAgKi9cbiAgbWVhc3VyZSgpOiBNZWFzdXJlZFNpemUge1xuICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdpZHRoOiBwYWRkaW5nLmhvcml6b250YWwsXG4gICAgICAgIGhlaWdodDogcGFkZGluZy52ZXJ0aWNhbFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBNZWFzdXJlIGFsbCBjaGlsZHJlblxuICAgIGNvbnN0IGNoaWxkU2l6ZXMgPSB0aGlzLmNoaWxkcmVuLm1hcChjaGlsZCA9PiBjaGlsZC5tZWFzdXJlKCkpO1xuICAgIGNvbnN0IHsgZGlyZWN0aW9uLCBnYXAgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcblxuICAgIGNvbnN0IGlzUm93ID0gZGlyZWN0aW9uID09PSBGbGV4RGlyZWN0aW9uLlJvdyB8fCBkaXJlY3Rpb24gPT09IEZsZXhEaXJlY3Rpb24uUm93UmV2ZXJzZTtcbiAgICBjb25zdCB0b3RhbEdhcCA9IGdhcCAqICh0aGlzLmNoaWxkcmVuLmxlbmd0aCAtIDEpO1xuXG4gICAgbGV0IG1lYXN1cmVkV2lkdGggPSAwO1xuICAgIGxldCBtZWFzdXJlZEhlaWdodCA9IDA7XG5cbiAgICBpZiAoaXNSb3cpIHtcbiAgICAgIC8vIFJvdzogc3VtIHdpZHRocywgbWF4IGhlaWdodFxuICAgICAgbWVhc3VyZWRXaWR0aCA9IGNoaWxkU2l6ZXMucmVkdWNlKChzdW0sIHNpemUpID0+IHN1bSArIHNpemUud2lkdGgsIDApICsgdG90YWxHYXA7XG4gICAgICBtZWFzdXJlZEhlaWdodCA9IE1hdGgubWF4KC4uLmNoaWxkU2l6ZXMubWFwKHNpemUgPT4gc2l6ZS5oZWlnaHQpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ29sdW1uOiBtYXggd2lkdGgsIHN1bSBoZWlnaHRzXG4gICAgICBtZWFzdXJlZFdpZHRoID0gTWF0aC5tYXgoLi4uY2hpbGRTaXplcy5tYXAoc2l6ZSA9PiBzaXplLndpZHRoKSk7XG4gICAgICBtZWFzdXJlZEhlaWdodCA9IGNoaWxkU2l6ZXMucmVkdWNlKChzdW0sIHNpemUpID0+IHN1bSArIHNpemUuaGVpZ2h0LCAwKSArIHRvdGFsR2FwO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogbWVhc3VyZWRXaWR0aCArIHBhZGRpbmcuaG9yaXpvbnRhbCxcbiAgICAgIGhlaWdodDogbWVhc3VyZWRIZWlnaHQgKyBwYWRkaW5nLnZlcnRpY2FsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBsYXlvdXQgZm9yIHRoaXMgY29udGFpbmVyIGFuZCBwb3NpdGlvbnMgY2hpbGRyZW5cbiAgICovXG4gIGxheW91dChhdmFpbGFibGVXaWR0aDogbnVtYmVyLCBhdmFpbGFibGVIZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG4gICAgY29uc3QgeyBkaXJlY3Rpb24sIGp1c3RpZnksIGFsaWduLCBnYXAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICAvLyBEZXRlcm1pbmUgY29udGFpbmVyIHNpemVcbiAgICBsZXQgY29udGFpbmVyV2lkdGg6IG51bWJlcjtcbiAgICBsZXQgY29udGFpbmVySGVpZ2h0OiBudW1iZXI7XG5cbiAgICBpZiAodGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ2ZpbGwnKSB7XG4gICAgICBjb250YWluZXJXaWR0aCA9IGF2YWlsYWJsZVdpZHRoO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdudW1iZXInKSB7XG4gICAgICBjb250YWluZXJXaWR0aCA9IHRoaXMuYm94TW9kZWwud2lkdGg7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG4gICAgICBjb250YWluZXJXaWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ2ZpbGwnKSB7XG4gICAgICBjb250YWluZXJIZWlnaHQgPSBhdmFpbGFibGVIZWlnaHQ7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdudW1iZXInKSB7XG4gICAgICBjb250YWluZXJIZWlnaHQgPSB0aGlzLmJveE1vZGVsLmhlaWdodDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcbiAgICAgIGNvbnRhaW5lckhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgY29tcHV0ZWQgbGF5b3V0XG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IGNvbnRhaW5lcldpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gY29udGFpbmVySGVpZ2h0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFggPSBwYWRkaW5nLmxlZnQ7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50WSA9IHBhZGRpbmcudG9wO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFdpZHRoID0gY29udGFpbmVyV2lkdGggLSBwYWRkaW5nLmhvcml6b250YWw7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50SGVpZ2h0ID0gY29udGFpbmVySGVpZ2h0IC0gcGFkZGluZy52ZXJ0aWNhbDtcblxuICAgIC8vIExheW91dCBjaGlsZHJlblxuICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMubGF5b3V0Q2hpbGRyZW4oKTtcbiAgICB9XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMYXlvdXRzIGFuZCBwb3NpdGlvbnMgY2hpbGQgY29tcG9uZW50c1xuICAgKi9cbiAgcHJpdmF0ZSBsYXlvdXRDaGlsZHJlbigpOiB2b2lkIHtcbiAgICBjb25zdCB7IGRpcmVjdGlvbiwganVzdGlmeSwgYWxpZ24sIGdhcCB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuICAgIGNvbnN0IGNvbnRlbnRXaWR0aCA9IHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFdpZHRoO1xuICAgIGNvbnN0IGNvbnRlbnRIZWlnaHQgPSB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRIZWlnaHQ7XG5cbiAgICBjb25zdCBpc1JvdyA9IGRpcmVjdGlvbiA9PT0gRmxleERpcmVjdGlvbi5Sb3cgfHwgZGlyZWN0aW9uID09PSBGbGV4RGlyZWN0aW9uLlJvd1JldmVyc2U7XG5cbiAgICAvLyBNZWFzdXJlIGNoaWxkcmVuXG4gICAgY29uc3QgY2hpbGRTaXplcyA9IHRoaXMuY2hpbGRyZW4ubWFwKGNoaWxkID0+IGNoaWxkLm1lYXN1cmUoKSk7XG5cbiAgICAvLyBDYWxjdWxhdGUgdG90YWwgbWFpbiBheGlzIHNpemVcbiAgICBjb25zdCB0b3RhbEdhcCA9IGdhcCAqICh0aGlzLmNoaWxkcmVuLmxlbmd0aCAtIDEpO1xuICAgIGNvbnN0IHRvdGFsQ2hpbGRTaXplID0gaXNSb3dcbiAgICAgID8gY2hpbGRTaXplcy5yZWR1Y2UoKHN1bSwgc2l6ZSkgPT4gc3VtICsgc2l6ZS53aWR0aCwgMClcbiAgICAgIDogY2hpbGRTaXplcy5yZWR1Y2UoKHN1bSwgc2l6ZSkgPT4gc3VtICsgc2l6ZS5oZWlnaHQsIDApO1xuXG4gICAgY29uc3QgbWFpbkF4aXNTaXplID0gaXNSb3cgPyBjb250ZW50V2lkdGggOiBjb250ZW50SGVpZ2h0O1xuICAgIGNvbnN0IGNyb3NzQXhpc1NpemUgPSBpc1JvdyA/IGNvbnRlbnRIZWlnaHQgOiBjb250ZW50V2lkdGg7XG4gICAgY29uc3QgZnJlZVNwYWNlID0gbWFpbkF4aXNTaXplIC0gdG90YWxDaGlsZFNpemUgLSB0b3RhbEdhcDtcblxuICAgIC8vIENhbGN1bGF0ZSBzdGFydGluZyBwb3NpdGlvbiBiYXNlZCBvbiBqdXN0aWZ5XG4gICAgbGV0IG1haW5BeGlzT2Zmc2V0ID0gMDtcbiAgICBsZXQgc3BhY2VCZXR3ZWVuID0gMDtcblxuICAgIHN3aXRjaCAoanVzdGlmeSkge1xuICAgICAgY2FzZSBGbGV4SnVzdGlmeS5TdGFydDpcbiAgICAgICAgbWFpbkF4aXNPZmZzZXQgPSAwO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgRmxleEp1c3RpZnkuRW5kOlxuICAgICAgICBtYWluQXhpc09mZnNldCA9IGZyZWVTcGFjZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEZsZXhKdXN0aWZ5LkNlbnRlcjpcbiAgICAgICAgbWFpbkF4aXNPZmZzZXQgPSBmcmVlU3BhY2UgLyAyO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgRmxleEp1c3RpZnkuU3BhY2VCZXR3ZWVuOlxuICAgICAgICBzcGFjZUJldHdlZW4gPSB0aGlzLmNoaWxkcmVuLmxlbmd0aCA+IDEgPyBmcmVlU3BhY2UgLyAodGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxKSA6IDA7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBGbGV4SnVzdGlmeS5TcGFjZUFyb3VuZDpcbiAgICAgICAgc3BhY2VCZXR3ZWVuID0gZnJlZVNwYWNlIC8gdGhpcy5jaGlsZHJlbi5sZW5ndGg7XG4gICAgICAgIG1haW5BeGlzT2Zmc2V0ID0gc3BhY2VCZXR3ZWVuIC8gMjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEZsZXhKdXN0aWZ5LlNwYWNlRXZlbmx5OlxuICAgICAgICBzcGFjZUJldHdlZW4gPSBmcmVlU3BhY2UgLyAodGhpcy5jaGlsZHJlbi5sZW5ndGggKyAxKTtcbiAgICAgICAgbWFpbkF4aXNPZmZzZXQgPSBzcGFjZUJldHdlZW47XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIC8vIFBvc2l0aW9uIGNoaWxkcmVuXG4gICAgbGV0IGN1cnJlbnRQb3NpdGlvbiA9IG1haW5BeGlzT2Zmc2V0O1xuXG4gICAgdGhpcy5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZCwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IGNoaWxkU2l6ZSA9IGNoaWxkU2l6ZXNbaW5kZXhdO1xuXG4gICAgICAvLyBMYXlvdXQgY2hpbGRcbiAgICAgIGNoaWxkLmxheW91dChjaGlsZFNpemUud2lkdGgsIGNoaWxkU2l6ZS5oZWlnaHQpO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgY3Jvc3MgYXhpcyBwb3NpdGlvbiBiYXNlZCBvbiBhbGlnblxuICAgICAgbGV0IGNyb3NzQXhpc1Bvc2l0aW9uID0gMDtcblxuICAgICAgc3dpdGNoIChhbGlnbikge1xuICAgICAgICBjYXNlIEZsZXhBbGlnbi5TdGFydDpcbiAgICAgICAgICBjcm9zc0F4aXNQb3NpdGlvbiA9IDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgRmxleEFsaWduLkVuZDpcbiAgICAgICAgICBjcm9zc0F4aXNQb3NpdGlvbiA9IGNyb3NzQXhpc1NpemUgLSAoaXNSb3cgPyBjaGlsZFNpemUuaGVpZ2h0IDogY2hpbGRTaXplLndpZHRoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGbGV4QWxpZ24uQ2VudGVyOlxuICAgICAgICAgIGNyb3NzQXhpc1Bvc2l0aW9uID0gKGNyb3NzQXhpc1NpemUgLSAoaXNSb3cgPyBjaGlsZFNpemUuaGVpZ2h0IDogY2hpbGRTaXplLndpZHRoKSkgLyAyO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEZsZXhBbGlnbi5TdHJldGNoOlxuICAgICAgICAgIC8vIFN0cmV0Y2ggY2hpbGQgdG8gZmlsbCBjcm9zcyBheGlzIChpbXBsZW1lbnQgbGF0ZXIpXG4gICAgICAgICAgY3Jvc3NBeGlzUG9zaXRpb24gPSAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXQgY2hpbGQgcG9zaXRpb25cbiAgICAgIGlmIChpc1Jvdykge1xuICAgICAgICBjaGlsZC5zZXRQb3NpdGlvbihcbiAgICAgICAgICBwYWRkaW5nLmxlZnQgKyBjdXJyZW50UG9zaXRpb24sXG4gICAgICAgICAgcGFkZGluZy50b3AgKyBjcm9zc0F4aXNQb3NpdGlvblxuICAgICAgICApO1xuICAgICAgICBjdXJyZW50UG9zaXRpb24gKz0gY2hpbGRTaXplLndpZHRoICsgZ2FwICsgc3BhY2VCZXR3ZWVuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hpbGQuc2V0UG9zaXRpb24oXG4gICAgICAgICAgcGFkZGluZy5sZWZ0ICsgY3Jvc3NBeGlzUG9zaXRpb24sXG4gICAgICAgICAgcGFkZGluZy50b3AgKyBjdXJyZW50UG9zaXRpb25cbiAgICAgICAgKTtcbiAgICAgICAgY3VycmVudFBvc2l0aW9uICs9IGNoaWxkU2l6ZS5oZWlnaHQgKyBnYXAgKyBzcGFjZUJldHdlZW47XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgY29udGFpbmVyIChjdXJyZW50bHkgbm8gdmlzdWFsIHJlcHJlc2VudGF0aW9uKVxuICAgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICAvLyBGbGV4Q29udGFpbmVyIGl0c2VsZiBoYXMgbm8gdmlzdWFsIHJlcHJlc2VudGF0aW9uXG4gICAgLy8gQ291bGQgYWRkIGRlYnVnIGJvcmRlcnMgaGVyZSBpZiBuZWVkZWRcbiAgfVxufVxuIiwiLyoqXG4gKiBQaXhlbC1QZXJmZWN0IEdyaWQgU3lzdGVtXG4gKlxuICogUHJvdmlkZXMgYSBjb25zaXN0ZW50IGdyaWQtYmFzZWQgbGF5b3V0IHN5c3RlbSBmb3IgcGl4ZWwtcGVyZmVjdCBVSXMsXG4gKiBjb21tb25seSB1c2VkIGluIHJldHJvLXN0eWxlIGdhbWVzIGFuZCBwaXhlbCBhcnQgYXBwbGljYXRpb25zLlxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiAvLyBVc2UgdGhlIGRlZmF1bHQgZ3JpZFxuICogY29uc3Qgd2lkdGggPSBweCgxMCk7IC8vIDEwIGdyaWQgdW5pdHMgPSA0MCBwaXhlbHMgYXQgNHggc2NhbGVcbiAqXG4gKiAvLyBDcmVhdGUgYSBjdXN0b20gZ3JpZFxuICogY29uc3QgY3VzdG9tR3JpZCA9IG5ldyBQaXhlbEdyaWQoe1xuICogICB1bml0OiAxLFxuICogICBzY2FsZTogMiwgIC8vIDJ4IHNjYWxlIGluc3RlYWQgb2YgNHhcbiAqICAgYm9yZGVyOiAxLFxuICogICBwYWRkaW5nOiAyLFxuICogICBnYXA6IDFcbiAqIH0pO1xuICogY29uc3Qgd2lkdGggPSBjdXN0b21HcmlkLnB4KDEwKTsgLy8gMjAgcGl4ZWxzIGF0IDJ4IHNjYWxlXG4gKiBgYGBcbiAqL1xuXG4vKipcbiAqIENvbmZpZ3VyYXRpb24gZm9yIGEgcGl4ZWwgZ3JpZCBzeXN0ZW1cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQaXhlbEdyaWRDb25maWcge1xuICAvKiogQmFzZSBwaXhlbCB1bml0IGF0IDF4IHNjYWxlIChkZWZhdWx0OiAxKSAqL1xuICB1bml0PzogbnVtYmVyO1xuICAvKiogU2NhbGUgbXVsdGlwbGllciBmb3IgYWxsIG1lYXN1cmVtZW50cyAoZGVmYXVsdDogNCkgKi9cbiAgc2NhbGU/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgd2lkdGggaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogMSkgKi9cbiAgYm9yZGVyPzogbnVtYmVyO1xuICAvKiogU3RhbmRhcmQgcGFkZGluZyBpbiBncmlkIHVuaXRzIChkZWZhdWx0OiAxKSAqL1xuICBwYWRkaW5nPzogbnVtYmVyO1xuICAvKiogR2FwIGJldHdlZW4gZWxlbWVudHMgaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogMSkgKi9cbiAgZ2FwPzogbnVtYmVyO1xuICAvKiogTWFyZ2luL3NwYWNpbmcgaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogNSwgZS5nLiwgNSAqIDQgPSAyMHB4KSAqL1xuICBtYXJnaW4/OiBudW1iZXI7XG4gIC8qKiBGb250IHNjYWxlIG11bHRpcGxpZXIgKGRlZmF1bHQ6IDAuMjUsIGUuZy4sIDY0cHggKiAwLjI1ID0gMTZweCkgKi9cbiAgZm9udFNjYWxlPzogbnVtYmVyO1xufVxuXG4vKipcbiAqIEJvcmRlciBjb25maWd1cmF0aW9uIGZvciBtdWx0aS1sYXllciBib3JkZXJzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQm9yZGVyQ29uZmlnIHtcbiAgLyoqIE91dGVyIGJvcmRlciB3aWR0aCBpbiBncmlkIHVuaXRzIChkZWZhdWx0OiAxKSAqL1xuICBvdXRlcj86IG51bWJlcjtcbiAgLyoqIE1pZGRsZSBib3JkZXIgd2lkdGggaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogMSkgKi9cbiAgbWlkZGxlPzogbnVtYmVyO1xuICAvKiogSW5uZXIgYm9yZGVyIHdpZHRoIGluIGdyaWQgdW5pdHMgKGRlZmF1bHQ6IDEpICovXG4gIGlubmVyPzogbnVtYmVyO1xuICAvKiogVG90YWwgYm9yZGVyIHdpZHRoIChjYWxjdWxhdGVkIGF1dG9tYXRpY2FsbHkpICovXG4gIHRvdGFsPzogbnVtYmVyO1xufVxuXG4vKipcbiAqIEEgcGl4ZWwtcGVyZmVjdCBncmlkIHN5c3RlbSBmb3IgY29uc2lzdGVudCBVSSBtZWFzdXJlbWVudHNcbiAqXG4gKiBBbGwgbWVhc3VyZW1lbnRzIGFyZSBpbiBncmlkIHVuaXRzIHRoYXQgZ2V0IHNjYWxlZCB0byBhY3R1YWwgcGl4ZWxzLlxuICogVGhpcyBlbnN1cmVzIHBpeGVsLXBlcmZlY3QgYWxpZ25tZW50IGF0IGFueSBzY2FsZSBmYWN0b3IuXG4gKi9cbmV4cG9ydCBjbGFzcyBQaXhlbEdyaWQge1xuICBwdWJsaWMgcmVhZG9ubHkgdW5pdDogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgc2NhbGU6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IGJvcmRlcjogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgcGFkZGluZzogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgZ2FwOiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSBtYXJnaW46IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IGZvbnRTY2FsZTogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogUGl4ZWxHcmlkQ29uZmlnID0ge30pIHtcbiAgICB0aGlzLnVuaXQgPSBjb25maWcudW5pdCA/PyAxO1xuICAgIHRoaXMuc2NhbGUgPSBjb25maWcuc2NhbGUgPz8gNDtcbiAgICB0aGlzLmJvcmRlciA9IGNvbmZpZy5ib3JkZXIgPz8gMTtcbiAgICB0aGlzLnBhZGRpbmcgPSBjb25maWcucGFkZGluZyA/PyAxO1xuICAgIHRoaXMuZ2FwID0gY29uZmlnLmdhcCA/PyAxO1xuICAgIHRoaXMubWFyZ2luID0gY29uZmlnLm1hcmdpbiA/PyA1OyAvLyA1IHVuaXRzICogNCBzY2FsZSA9IDIwcHggZGVmYXVsdFxuICAgIC8vIEZvbnQgc2NhbGUgaXMgcHJvcG9ydGlvbmFsIHRvIEdSSUQgc2NhbGUgKDAuMjUgYXQgNHggc2NhbGUpXG4gICAgLy8gQXQgNHg6IDY0cHggKiAwLjI1ID0gMTZweCwgQXQgM3g6IDY0cHggKiAwLjE4NzUgPSAxMnB4LCBldGMuXG4gICAgdGhpcy5mb250U2NhbGUgPSBjb25maWcuZm9udFNjYWxlID8/ICh0aGlzLnNjYWxlIC8gMTYpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgZ3JpZCB1bml0cyB0byBhY3R1YWwgcGl4ZWxzXG4gICAqIEBwYXJhbSB1bml0cyAtIE51bWJlciBvZiBncmlkIHVuaXRzXG4gICAqIEByZXR1cm5zIEFjdHVhbCBwaXhlbCB2YWx1ZVxuICAgKi9cbiAgcHgodW5pdHM6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHVuaXRzICogdGhpcy51bml0ICogdGhpcy5zY2FsZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IHBpeGVscyB0byBncmlkIHVuaXRzXG4gICAqIEBwYXJhbSBwaXhlbHMgLSBOdW1iZXIgb2YgcGl4ZWxzXG4gICAqIEByZXR1cm5zIEdyaWQgdW5pdHMgKHJvdW5kZWQpXG4gICAqL1xuICB1bml0cyhwaXhlbHM6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGgucm91bmQocGl4ZWxzIC8gKHRoaXMudW5pdCAqIHRoaXMuc2NhbGUpKTtcbiAgfVxufVxuXG4vKipcbiAqIERlZmF1bHQgcGl4ZWwgZ3JpZCBpbnN0YW5jZVxuICogLSAxcHggYmFzZSB1bml0XG4gKiAtIDR4IHNjYWxlIChjb21tb24gZm9yIHJldHJvL3BpeGVsIGdhbWVzKVxuICogLSAxIHVuaXQgYm9yZGVycywgcGFkZGluZywgYW5kIGdhcHNcbiAqXG4gKiBURU1QT1JBUlk6IENoZWNrcyBsb2NhbFN0b3JhZ2UgZm9yICd0ZW1wLWdyaWQtc2NhbGUnIHRvIG92ZXJyaWRlIHNjYWxlIGZvciB0ZXN0aW5nXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX1BJWEVMX0dSSUQgPSAoKCkgPT4ge1xuICAvLyBURU1QT1JBUlk6IENoZWNrIGZvciBzY2FsZSBvdmVycmlkZSBpbiBsb2NhbFN0b3JhZ2VcbiAgY29uc3QgdGVtcFNjYWxlID0gdHlwZW9mIGxvY2FsU3RvcmFnZSAhPT0gJ3VuZGVmaW5lZCdcbiAgICA/IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0ZW1wLWdyaWQtc2NhbGUnKVxuICAgIDogbnVsbDtcblxuICBpZiAodGVtcFNjYWxlKSB7XG4gICAgY29uc3Qgc2NhbGUgPSBwYXJzZUludCh0ZW1wU2NhbGUsIDEwKTtcbiAgICBpZiAoIWlzTmFOKHNjYWxlKSAmJiBzY2FsZSA+PSAxICYmIHNjYWxlIDw9IDQpIHtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5SnIFRFTVBPUkFSWTogVXNpbmcgR1JJRCBzY2FsZSBvdmVycmlkZTogJHtzY2FsZX14YCk7XG4gICAgICByZXR1cm4gbmV3IFBpeGVsR3JpZCh7IHNjYWxlIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgUGl4ZWxHcmlkKCk7XG59KSgpO1xuXG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBjb252ZXJ0IGdyaWQgdW5pdHMgdG8gcGl4ZWxzIHVzaW5nIHRoZSBkZWZhdWx0IGdyaWRcbiAqIEBwYXJhbSB1bml0cyAtIE51bWJlciBvZiBncmlkIHVuaXRzXG4gKiBAcmV0dXJucyBBY3R1YWwgcGl4ZWwgdmFsdWVcbiAqL1xuZXhwb3J0IGNvbnN0IHB4ID0gKHVuaXRzOiBudW1iZXIpOiBudW1iZXIgPT4gREVGQVVMVF9QSVhFTF9HUklELnB4KHVuaXRzKTtcblxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gY29udmVydCBwaXhlbHMgdG8gZ3JpZCB1bml0cyB1c2luZyB0aGUgZGVmYXVsdCBncmlkXG4gKiBAcGFyYW0gcGl4ZWxzIC0gTnVtYmVyIG9mIHBpeGVsc1xuICogQHJldHVybnMgR3JpZCB1bml0cyAocm91bmRlZClcbiAqL1xuZXhwb3J0IGNvbnN0IHVuaXRzID0gKHBpeGVsczogbnVtYmVyKTogbnVtYmVyID0+IERFRkFVTFRfUElYRUxfR1JJRC51bml0cyhwaXhlbHMpO1xuXG4vKipcbiAqIERlZmF1bHQgZ3JpZCBjb25zdGFudHMgZm9yIGVhc3kgYWNjZXNzXG4gKi9cbmV4cG9ydCBjb25zdCBHUklEID0ge1xuICB1bml0OiBERUZBVUxUX1BJWEVMX0dSSUQudW5pdCxcbiAgc2NhbGU6IERFRkFVTFRfUElYRUxfR1JJRC5zY2FsZSxcbiAgYm9yZGVyOiBERUZBVUxUX1BJWEVMX0dSSUQuYm9yZGVyLFxuICBwYWRkaW5nOiBERUZBVUxUX1BJWEVMX0dSSUQucGFkZGluZyxcbiAgZ2FwOiBERUZBVUxUX1BJWEVMX0dSSUQuZ2FwLFxuICBtYXJnaW46IERFRkFVTFRfUElYRUxfR1JJRC5tYXJnaW4sXG4gIGZvbnRTY2FsZTogREVGQVVMVF9QSVhFTF9HUklELmZvbnRTY2FsZVxufSBhcyBjb25zdDtcblxuLyoqXG4gKiBEZWZhdWx0IGJvcmRlciBjb25maWd1cmF0aW9uICh0cmlwbGUgYm9yZGVyOiBvdXRlci9taWRkbGUvaW5uZXIpXG4gKi9cbmV4cG9ydCBjb25zdCBCT1JERVIgPSB7XG4gIG91dGVyOiAxLCAgIC8vIE91dGVyIGJvcmRlciAoMSBncmlkIHVuaXQpXG4gIG1pZGRsZTogMSwgIC8vIE1pZGRsZSBib3JkZXIgKDEgZ3JpZCB1bml0KVxuICBpbm5lcjogMSwgICAvLyBJbm5lciBib3JkZXIgKDEgZ3JpZCB1bml0KVxuICB0b3RhbDogMyAgICAvLyBUb3RhbCBib3JkZXIgd2lkdGggKDMgZ3JpZCB1bml0cylcbn0gYXMgY29uc3Q7XG5cbi8qKlxuICogQ3JlYXRlIGEgY3VzdG9tIGJvcmRlciBjb25maWd1cmF0aW9uXG4gKiBAcGFyYW0gY29uZmlnIC0gQm9yZGVyIGNvbmZpZ3VyYXRpb25cbiAqIEByZXR1cm5zIEJvcmRlciBjb25maWd1cmF0aW9uIHdpdGggY2FsY3VsYXRlZCB0b3RhbFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQm9yZGVyQ29uZmlnKGNvbmZpZzogQm9yZGVyQ29uZmlnID0ge30pOiBSZXF1aXJlZDxCb3JkZXJDb25maWc+IHtcbiAgY29uc3Qgb3V0ZXIgPSBjb25maWcub3V0ZXIgPz8gMTtcbiAgY29uc3QgbWlkZGxlID0gY29uZmlnLm1pZGRsZSA/PyAxO1xuICBjb25zdCBpbm5lciA9IGNvbmZpZy5pbm5lciA/PyAxO1xuICBjb25zdCB0b3RhbCA9IG91dGVyICsgbWlkZGxlICsgaW5uZXI7XG5cbiAgcmV0dXJuIHtcbiAgICBvdXRlcixcbiAgICBtaWRkbGUsXG4gICAgaW5uZXIsXG4gICAgdG90YWxcbiAgfTtcbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9waXhpX2pzX187IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcIi4vc3JjL2luZGV4LnRzXCIpO1xuIiwiIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9