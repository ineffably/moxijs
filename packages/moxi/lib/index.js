(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("pixi.js"));
	else if(typeof define === 'function' && define.amd)
		define(["pixi.js"], factory);
	else if(typeof exports === 'object')
		exports["moxi"] = factory(require("pixi.js"));
	else
		root["moxi"] = factory(root["PIXI"]);
})(self, (__WEBPACK_EXTERNAL_MODULE_pixi_js__) => {
return /******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js":
/*!**************************************************************************!*\
  !*** ../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js ***!
  \**************************************************************************/
/***/ ((module) => {

/* Font Face Observer v2.3.0 - Â© Bram Stein. License: BSD-3-Clause */(function(){function p(a,c){document.addEventListener?a.addEventListener("scroll",c,!1):a.attachEvent("scroll",c)}function u(a){document.body?a():document.addEventListener?document.addEventListener("DOMContentLoaded",function b(){document.removeEventListener("DOMContentLoaded",b);a()}):document.attachEvent("onreadystatechange",function g(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",g),a()})};function w(a){this.g=document.createElement("div");this.g.setAttribute("aria-hidden","true");this.g.appendChild(document.createTextNode(a));this.h=document.createElement("span");this.i=document.createElement("span");this.m=document.createElement("span");this.j=document.createElement("span");this.l=-1;this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.h.appendChild(this.m);this.i.appendChild(this.j);this.g.appendChild(this.h);this.g.appendChild(this.i)}
function x(a,c){a.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+c+";"}function B(a){var c=a.g.offsetWidth,b=c+100;a.j.style.width=b+"px";a.i.scrollLeft=b;a.h.scrollLeft=a.h.scrollWidth+100;return a.l!==c?(a.l=c,!0):!1}function C(a,c){function b(){var e=g;B(e)&&null!==e.g.parentNode&&c(e.l)}var g=a;p(a.h,b);p(a.i,b);B(a)};function D(a,c,b){c=c||{};b=b||window;this.family=a;this.style=c.style||"normal";this.weight=c.weight||"normal";this.stretch=c.stretch||"normal";this.context=b}var E=null,F=null,G=null,H=null;function I(a){null===F&&(M(a)&&/Apple/.test(window.navigator.vendor)?(a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),F=!!a&&603>parseInt(a[1],10)):F=!1);return F}function M(a){null===H&&(H=!!a.document.fonts);return H}
function N(a,c){var b=a.style,g=a.weight;if(null===G){var e=document.createElement("div");try{e.style.font="condensed 100px sans-serif"}catch(q){}G=""!==e.style.font}return[b,g,G?a.stretch:"","100px",c].join(" ")}
D.prototype.load=function(a,c){var b=this,g=a||"BESbswy",e=0,q=c||3E3,J=(new Date).getTime();return new Promise(function(K,L){if(M(b.context)&&!I(b.context)){var O=new Promise(function(r,t){function h(){(new Date).getTime()-J>=q?t(Error(""+q+"ms timeout exceeded")):b.context.document.fonts.load(N(b,'"'+b.family+'"'),g).then(function(n){1<=n.length?r():setTimeout(h,25)},t)}h()}),P=new Promise(function(r,t){e=setTimeout(function(){t(Error(""+q+"ms timeout exceeded"))},q)});Promise.race([P,O]).then(function(){clearTimeout(e);
K(b)},L)}else u(function(){function r(){var d;if(d=-1!=k&&-1!=l||-1!=k&&-1!=m||-1!=l&&-1!=m)(d=k!=l&&k!=m&&l!=m)||(null===E&&(d=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),E=!!d&&(536>parseInt(d[1],10)||536===parseInt(d[1],10)&&11>=parseInt(d[2],10))),d=E&&(k==y&&l==y&&m==y||k==z&&l==z&&m==z||k==A&&l==A&&m==A)),d=!d;d&&(null!==f.parentNode&&f.parentNode.removeChild(f),clearTimeout(e),K(b))}function t(){if((new Date).getTime()-J>=q)null!==f.parentNode&&f.parentNode.removeChild(f),
L(Error(""+q+"ms timeout exceeded"));else{var d=b.context.document.hidden;if(!0===d||void 0===d)k=h.g.offsetWidth,l=n.g.offsetWidth,m=v.g.offsetWidth,r();e=setTimeout(t,50)}}var h=new w(g),n=new w(g),v=new w(g),k=-1,l=-1,m=-1,y=-1,z=-1,A=-1,f=document.createElement("div");f.dir="ltr";x(h,N(b,"sans-serif"));x(n,N(b,"serif"));x(v,N(b,"monospace"));f.appendChild(h.g);f.appendChild(n.g);f.appendChild(v.g);b.context.document.body.appendChild(f);y=h.g.offsetWidth;z=n.g.offsetWidth;A=v.g.offsetWidth;t();
C(h,function(d){k=d;r()});x(h,N(b,'"'+b.family+'",sans-serif'));C(n,function(d){l=d;r()});x(n,N(b,'"'+b.family+'",serif'));C(v,function(d){m=d;r()});x(v,N(b,'"'+b.family+'",monospace'))})})}; true?module.exports=D:(0);}());


/***/ }),

/***/ "../../node_modules/planck/dist/planck.js":
/*!************************************************!*\
  !*** ../../node_modules/planck/dist/planck.js ***!
  \************************************************/
/***/ (function(__unused_webpack_module, exports) {

(function(global, factory) {
   true ? factory(exports) : 0;
})(this, function(exports2) {
  "use strict";/**
 * Planck.js v1.4.2
 * @license The MIT license
 * @copyright Copyright (c) 2025 Erin Catto, Ali Shakiba
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

  /*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */
  var extendStatics = function(d2, b2) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d3, b3) {
      d3.__proto__ = b3;
    } || function(d3, b3) {
      for (var p in b3) if (Object.prototype.hasOwnProperty.call(b3, p)) d3[p] = b3[p];
    };
    return extendStatics(d2, b2);
  };
  function __extends(d2, b2) {
    if (typeof b2 !== "function" && b2 !== null)
      throw new TypeError("Class extends value " + String(b2) + " is not a constructor or null");
    extendStatics(d2, b2);
    function __() {
      this.constructor = d2;
    }
    d2.prototype = b2 === null ? Object.create(b2) : (__.prototype = b2.prototype, new __());
  }
  var __assign = function() {
    __assign = Object.assign || function __assign2(t) {
      for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
        s2 = arguments[i];
        for (var p in s2) if (Object.prototype.hasOwnProperty.call(s2, p)) t[p] = s2[p];
      }
      return t;
    };
    return __assign.apply(this, arguments);
  };
  var options = function(input2, defaults) {
    if (input2 === null || typeof input2 === "undefined") {
      input2 = {};
    }
    var output2 = __assign({}, input2);
    for (var key in defaults) {
      if (defaults.hasOwnProperty(key) && typeof input2[key] === "undefined") {
        output2[key] = defaults[key];
      }
    }
    if (typeof Object.getOwnPropertySymbols === "function") {
      var symbols = Object.getOwnPropertySymbols(defaults);
      for (var i = 0; i < symbols.length; i++) {
        var symbol = symbols[i];
        if (defaults.propertyIsEnumerable(symbol) && typeof input2[symbol] === "undefined") {
          output2[symbol] = defaults[symbol];
        }
      }
    }
    return output2;
  };
  var math_random = Math.random;
  var EPSILON = 1e-9;
  var isFinite = Number.isFinite;
  function nextPowerOfTwo(x2) {
    x2 |= x2 >> 1;
    x2 |= x2 >> 2;
    x2 |= x2 >> 4;
    x2 |= x2 >> 8;
    x2 |= x2 >> 16;
    return x2 + 1;
  }
  function isPowerOfTwo(x2) {
    return x2 > 0 && (x2 & x2 - 1) === 0;
  }
  function mod(num, min, max) {
    if (typeof min === "undefined") {
      max = 1;
      min = 0;
    } else if (typeof max === "undefined") {
      max = min;
      min = 0;
    }
    if (max > min) {
      num = (num - min) % (max - min);
      return num + (num < 0 ? max : min);
    } else {
      num = (num - max) % (min - max);
      return num + (num <= 0 ? min : max);
    }
  }
  function clamp(num, min, max) {
    if (num < min) {
      return min;
    } else if (num > max) {
      return max;
    } else {
      return num;
    }
  }
  function random(min, max) {
    if (typeof min === "undefined") {
      max = 1;
      min = 0;
    } else if (typeof max === "undefined") {
      max = min;
      min = 0;
    }
    return min === max ? min : math_random() * (max - min) + min;
  }
  var math = Object.create(Math);
  math.EPSILON = EPSILON;
  math.isFinite = isFinite;
  math.nextPowerOfTwo = nextPowerOfTwo;
  math.isPowerOfTwo = isPowerOfTwo;
  math.mod = mod;
  math.clamp = clamp;
  math.random = random;
  var math_abs$9 = Math.abs;
  var math_sqrt$5 = Math.sqrt;
  var math_max$8 = Math.max;
  var math_min$8 = Math.min;
  var Vec2 = (
    /** @class */
    function() {
      function Vec22(x2, y) {
        if (!(this instanceof Vec22)) {
          return new Vec22(x2, y);
        }
        if (typeof x2 === "undefined") {
          this.x = 0;
          this.y = 0;
        } else if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
        } else {
          this.x = x2;
          this.y = y;
        }
      }
      Vec22.prototype._serialize = function() {
        return {
          x: this.x,
          y: this.y
        };
      };
      Vec22._deserialize = function(data) {
        var obj = Object.create(Vec22.prototype);
        obj.x = data.x;
        obj.y = data.y;
        return obj;
      };
      Vec22.zero = function() {
        var obj = Object.create(Vec22.prototype);
        obj.x = 0;
        obj.y = 0;
        return obj;
      };
      Vec22.neo = function(x2, y) {
        var obj = Object.create(Vec22.prototype);
        obj.x = x2;
        obj.y = y;
        return obj;
      };
      Vec22.clone = function(v3) {
        return Vec22.neo(v3.x, v3.y);
      };
      Vec22.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Vec22.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.x) && Number.isFinite(obj.y);
      };
      Vec22.assert = function(o) {
      };
      Vec22.prototype.clone = function() {
        return Vec22.clone(this);
      };
      Vec22.prototype.setZero = function() {
        this.x = 0;
        this.y = 0;
        return this;
      };
      Vec22.prototype.set = function(x2, y) {
        if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
        } else {
          this.x = x2;
          this.y = y;
        }
        return this;
      };
      Vec22.prototype.setNum = function(x2, y) {
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.setVec2 = function(value) {
        this.x = value.x;
        this.y = value.y;
        return this;
      };
      Vec22.prototype.wSet = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.setCombine(a2, v3, b2, w);
        } else {
          return this.setMul(a2, v3);
        }
      };
      Vec22.prototype.setCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.setMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x = x2;
        this.y = y;
        return this;
      };
      Vec22.prototype.add = function(w) {
        this.x += w.x;
        this.y += w.y;
        return this;
      };
      Vec22.prototype.wAdd = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.addCombine(a2, v3, b2, w);
        } else {
          return this.addMul(a2, v3);
        }
      };
      Vec22.prototype.addCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x += x2;
        this.y += y;
        return this;
      };
      Vec22.prototype.addMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x += x2;
        this.y += y;
        return this;
      };
      Vec22.prototype.wSub = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return this.subCombine(a2, v3, b2, w);
        } else {
          return this.subMul(a2, v3);
        }
      };
      Vec22.prototype.subCombine = function(a2, v3, b2, w) {
        var x2 = a2 * v3.x + b2 * w.x;
        var y = a2 * v3.y + b2 * w.y;
        this.x -= x2;
        this.y -= y;
        return this;
      };
      Vec22.prototype.subMul = function(a2, v3) {
        var x2 = a2 * v3.x;
        var y = a2 * v3.y;
        this.x -= x2;
        this.y -= y;
        return this;
      };
      Vec22.prototype.sub = function(w) {
        this.x -= w.x;
        this.y -= w.y;
        return this;
      };
      Vec22.prototype.mul = function(m) {
        this.x *= m;
        this.y *= m;
        return this;
      };
      Vec22.prototype.length = function() {
        return Vec22.lengthOf(this);
      };
      Vec22.prototype.lengthSquared = function() {
        return Vec22.lengthSquared(this);
      };
      Vec22.prototype.normalize = function() {
        var length = this.length();
        if (length < EPSILON) {
          return 0;
        }
        var invLength = 1 / length;
        this.x *= invLength;
        this.y *= invLength;
        return length;
      };
      Vec22.normalize = function(v3) {
        var length = Vec22.lengthOf(v3);
        if (length < EPSILON) {
          return Vec22.zero();
        }
        var invLength = 1 / length;
        return Vec22.neo(v3.x * invLength, v3.y * invLength);
      };
      Vec22.lengthOf = function(v3) {
        return math_sqrt$5(v3.x * v3.x + v3.y * v3.y);
      };
      Vec22.lengthSquared = function(v3) {
        return v3.x * v3.x + v3.y * v3.y;
      };
      Vec22.distance = function(v3, w) {
        var dx = v3.x - w.x;
        var dy = v3.y - w.y;
        return math_sqrt$5(dx * dx + dy * dy);
      };
      Vec22.distanceSquared = function(v3, w) {
        var dx = v3.x - w.x;
        var dy = v3.y - w.y;
        return dx * dx + dy * dy;
      };
      Vec22.areEqual = function(v3, w) {
        return v3 === w || typeof w === "object" && w !== null && v3.x === w.x && v3.y === w.y;
      };
      Vec22.skew = function(v3) {
        return Vec22.neo(-v3.y, v3.x);
      };
      Vec22.dot = function(v3, w) {
        return v3.x * w.x + v3.y * w.y;
      };
      Vec22.cross = function(v3, w) {
        if (typeof w === "number") {
          return Vec22.neo(w * v3.y, -w * v3.x);
        } else if (typeof v3 === "number") {
          return Vec22.neo(-v3 * w.y, v3 * w.x);
        } else {
          return v3.x * w.y - v3.y * w.x;
        }
      };
      Vec22.crossVec2Vec2 = function(v3, w) {
        return v3.x * w.y - v3.y * w.x;
      };
      Vec22.crossVec2Num = function(v3, w) {
        return Vec22.neo(w * v3.y, -w * v3.x);
      };
      Vec22.crossNumVec2 = function(v3, w) {
        return Vec22.neo(-v3 * w.y, v3 * w.x);
      };
      Vec22.addCross = function(a2, v3, w) {
        if (typeof w === "number") {
          return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);
        } else if (typeof v3 === "number") {
          return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);
        }
      };
      Vec22.addCrossVec2Num = function(a2, v3, w) {
        return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);
      };
      Vec22.addCrossNumVec2 = function(a2, v3, w) {
        return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);
      };
      Vec22.add = function(v3, w) {
        return Vec22.neo(v3.x + w.x, v3.y + w.y);
      };
      Vec22.wAdd = function(a2, v3, b2, w) {
        if (typeof b2 !== "undefined" || typeof w !== "undefined") {
          return Vec22.combine(a2, v3, b2, w);
        } else {
          return Vec22.mulNumVec2(a2, v3);
        }
      };
      Vec22.combine = function(a2, v3, b2, w) {
        return Vec22.zero().setCombine(a2, v3, b2, w);
      };
      Vec22.sub = function(v3, w) {
        return Vec22.neo(v3.x - w.x, v3.y - w.y);
      };
      Vec22.mul = function(a2, b2) {
        if (typeof a2 === "object") {
          return Vec22.neo(a2.x * b2, a2.y * b2);
        } else if (typeof b2 === "object") {
          return Vec22.neo(a2 * b2.x, a2 * b2.y);
        }
      };
      Vec22.mulVec2Num = function(a2, b2) {
        return Vec22.neo(a2.x * b2, a2.y * b2);
      };
      Vec22.mulNumVec2 = function(a2, b2) {
        return Vec22.neo(a2 * b2.x, a2 * b2.y);
      };
      Vec22.prototype.neg = function() {
        this.x = -this.x;
        this.y = -this.y;
        return this;
      };
      Vec22.neg = function(v3) {
        return Vec22.neo(-v3.x, -v3.y);
      };
      Vec22.abs = function(v3) {
        return Vec22.neo(math_abs$9(v3.x), math_abs$9(v3.y));
      };
      Vec22.mid = function(v3, w) {
        return Vec22.neo((v3.x + w.x) * 0.5, (v3.y + w.y) * 0.5);
      };
      Vec22.upper = function(v3, w) {
        return Vec22.neo(math_max$8(v3.x, w.x), math_max$8(v3.y, w.y));
      };
      Vec22.lower = function(v3, w) {
        return Vec22.neo(math_min$8(v3.x, w.x), math_min$8(v3.y, w.y));
      };
      Vec22.prototype.clamp = function(max) {
        var lengthSqr = this.x * this.x + this.y * this.y;
        if (lengthSqr > max * max) {
          var scale = max / math_sqrt$5(lengthSqr);
          this.x *= scale;
          this.y *= scale;
        }
        return this;
      };
      Vec22.clamp = function(v3, max) {
        var r = Vec22.neo(v3.x, v3.y);
        r.clamp(max);
        return r;
      };
      Vec22.clampVec2 = function(v3, min, max) {
        return {
          x: clamp(v3.x, min === null || min === void 0 ? void 0 : min.x, max === null || max === void 0 ? void 0 : max.x),
          y: clamp(v3.y, min === null || min === void 0 ? void 0 : min.y, max === null || max === void 0 ? void 0 : max.y)
        };
      };
      Vec22.scaleFn = function(x2, y) {
        return function(v3) {
          return Vec22.neo(v3.x * x2, v3.y * y);
        };
      };
      Vec22.translateFn = function(x2, y) {
        return function(v3) {
          return Vec22.neo(v3.x + x2, v3.y + y);
        };
      };
      return Vec22;
    }()
  );
  var math_max$7 = Math.max;
  var math_min$7 = Math.min;
  var AABB = (
    /** @class */
    function() {
      function AABB2(lower, upper) {
        if (!(this instanceof AABB2)) {
          return new AABB2(lower, upper);
        }
        this.lowerBound = Vec2.zero();
        this.upperBound = Vec2.zero();
        if (typeof lower === "object") {
          this.lowerBound.setVec2(lower);
        }
        if (typeof upper === "object") {
          this.upperBound.setVec2(upper);
        } else if (typeof lower === "object") {
          this.upperBound.setVec2(lower);
        }
      }
      AABB2.prototype.isValid = function() {
        return AABB2.isValid(this);
      };
      AABB2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.lowerBound) && Vec2.isValid(obj.upperBound) && Vec2.sub(obj.upperBound, obj.lowerBound).lengthSquared() >= 0;
      };
      AABB2.assert = function(o) {
      };
      AABB2.prototype.getCenter = function() {
        return Vec2.neo((this.lowerBound.x + this.upperBound.x) * 0.5, (this.lowerBound.y + this.upperBound.y) * 0.5);
      };
      AABB2.prototype.getExtents = function() {
        return Vec2.neo((this.upperBound.x - this.lowerBound.x) * 0.5, (this.upperBound.y - this.lowerBound.y) * 0.5);
      };
      AABB2.prototype.getPerimeter = function() {
        return 2 * (this.upperBound.x - this.lowerBound.x + this.upperBound.y - this.lowerBound.y);
      };
      AABB2.prototype.combine = function(a2, b2) {
        b2 = b2 || this;
        var lowerA = a2.lowerBound;
        var upperA = a2.upperBound;
        var lowerB = b2.lowerBound;
        var upperB = b2.upperBound;
        var lowerX = math_min$7(lowerA.x, lowerB.x);
        var lowerY = math_min$7(lowerA.y, lowerB.y);
        var upperX = math_max$7(upperB.x, upperA.x);
        var upperY = math_max$7(upperB.y, upperA.y);
        this.lowerBound.setNum(lowerX, lowerY);
        this.upperBound.setNum(upperX, upperY);
      };
      AABB2.prototype.combinePoints = function(a2, b2) {
        this.lowerBound.setNum(math_min$7(a2.x, b2.x), math_min$7(a2.y, b2.y));
        this.upperBound.setNum(math_max$7(a2.x, b2.x), math_max$7(a2.y, b2.y));
      };
      AABB2.prototype.set = function(aabb) {
        this.lowerBound.setNum(aabb.lowerBound.x, aabb.lowerBound.y);
        this.upperBound.setNum(aabb.upperBound.x, aabb.upperBound.y);
      };
      AABB2.prototype.contains = function(aabb) {
        var result = true;
        result = result && this.lowerBound.x <= aabb.lowerBound.x;
        result = result && this.lowerBound.y <= aabb.lowerBound.y;
        result = result && aabb.upperBound.x <= this.upperBound.x;
        result = result && aabb.upperBound.y <= this.upperBound.y;
        return result;
      };
      AABB2.prototype.extend = function(value) {
        AABB2.extend(this, value);
        return this;
      };
      AABB2.extend = function(out, value) {
        out.lowerBound.x -= value;
        out.lowerBound.y -= value;
        out.upperBound.x += value;
        out.upperBound.y += value;
        return out;
      };
      AABB2.testOverlap = function(a2, b2) {
        var d1x = b2.lowerBound.x - a2.upperBound.x;
        var d2x = a2.lowerBound.x - b2.upperBound.x;
        var d1y = b2.lowerBound.y - a2.upperBound.y;
        var d2y = a2.lowerBound.y - b2.upperBound.y;
        if (d1x > 0 || d1y > 0 || d2x > 0 || d2y > 0) {
          return false;
        }
        return true;
      };
      AABB2.areEqual = function(a2, b2) {
        return Vec2.areEqual(a2.lowerBound, b2.lowerBound) && Vec2.areEqual(a2.upperBound, b2.upperBound);
      };
      AABB2.diff = function(a2, b2) {
        var wD = math_max$7(0, math_min$7(a2.upperBound.x, b2.upperBound.x) - math_max$7(b2.lowerBound.x, a2.lowerBound.x));
        var hD = math_max$7(0, math_min$7(a2.upperBound.y, b2.upperBound.y) - math_max$7(b2.lowerBound.y, a2.lowerBound.y));
        var wA = a2.upperBound.x - a2.lowerBound.x;
        var hA = a2.upperBound.y - a2.lowerBound.y;
        var wB = b2.upperBound.x - b2.lowerBound.x;
        var hB = b2.upperBound.y - b2.lowerBound.y;
        return wA * hA + wB * hB - wD * hD;
      };
      AABB2.prototype.rayCast = function(output2, input2) {
        var tmin = -Infinity;
        var tmax = Infinity;
        var p = input2.p1;
        var d2 = Vec2.sub(input2.p2, input2.p1);
        var absD = Vec2.abs(d2);
        var normal3 = Vec2.zero();
        {
          if (absD.x < EPSILON) {
            if (p.x < this.lowerBound.x || this.upperBound.x < p.x) {
              return false;
            }
          } else {
            var inv_d = 1 / d2.x;
            var t1 = (this.lowerBound.x - p.x) * inv_d;
            var t2 = (this.upperBound.x - p.x) * inv_d;
            var s2 = -1;
            if (t1 > t2) {
              var temp3 = t1;
              t1 = t2;
              t2 = temp3;
              s2 = 1;
            }
            if (t1 > tmin) {
              normal3.setZero();
              normal3.x = s2;
              tmin = t1;
            }
            tmax = math_min$7(tmax, t2);
            if (tmin > tmax) {
              return false;
            }
          }
        }
        {
          if (absD.y < EPSILON) {
            if (p.y < this.lowerBound.y || this.upperBound.y < p.y) {
              return false;
            }
          } else {
            var inv_d = 1 / d2.y;
            var t1 = (this.lowerBound.y - p.y) * inv_d;
            var t2 = (this.upperBound.y - p.y) * inv_d;
            var s2 = -1;
            if (t1 > t2) {
              var temp3 = t1;
              t1 = t2;
              t2 = temp3;
              s2 = 1;
            }
            if (t1 > tmin) {
              normal3.setZero();
              normal3.y = s2;
              tmin = t1;
            }
            tmax = math_min$7(tmax, t2);
            if (tmin > tmax) {
              return false;
            }
          }
        }
        if (tmin < 0 || input2.maxFraction < tmin) {
          return false;
        }
        output2.fraction = tmin;
        output2.normal = normal3;
        return true;
      };
      AABB2.prototype.toString = function() {
        return JSON.stringify(this);
      };
      AABB2.combinePoints = function(out, a2, b2) {
        out.lowerBound.x = math_min$7(a2.x, b2.x);
        out.lowerBound.y = math_min$7(a2.y, b2.y);
        out.upperBound.x = math_max$7(a2.x, b2.x);
        out.upperBound.y = math_max$7(a2.y, b2.y);
        return out;
      };
      AABB2.combinedPerimeter = function(a2, b2) {
        var lx = math_min$7(a2.lowerBound.x, b2.lowerBound.x);
        var ly = math_min$7(a2.lowerBound.y, b2.lowerBound.y);
        var ux = math_max$7(a2.upperBound.x, b2.upperBound.x);
        var uy = math_max$7(a2.upperBound.y, b2.upperBound.y);
        return 2 * (ux - lx + uy - ly);
      };
      return AABB2;
    }()
  );
  var math_PI$6 = Math.PI;
  var Settings = (
    /** @class */
    function() {
      function Settings2() {
      }
      Object.defineProperty(Settings2, "polygonRadius", {
        /**
         * The radius of the polygon/edge shape skin. This should not be modified.
         * Making this smaller means polygons will have an insufficient buffer for
         * continuous collision. Making it larger may create artifacts for vertex
         * collision.
         */
        get: function() {
          return 2 * Settings2.linearSlop;
        },
        enumerable: false,
        configurable: true
      });
      Settings2.lengthUnitsPerMeter = 1;
      Settings2.maxManifoldPoints = 2;
      Settings2.maxPolygonVertices = 12;
      Settings2.aabbExtension = 0.1;
      Settings2.aabbMultiplier = 2;
      Settings2.linearSlop = 5e-3;
      Settings2.angularSlop = 2 / 180 * math_PI$6;
      Settings2.maxSubSteps = 8;
      Settings2.maxTOIContacts = 32;
      Settings2.maxTOIIterations = 20;
      Settings2.maxDistanceIterations = 20;
      Settings2.velocityThreshold = 1;
      Settings2.maxLinearCorrection = 0.2;
      Settings2.maxAngularCorrection = 8 / 180 * math_PI$6;
      Settings2.maxTranslation = 2;
      Settings2.maxRotation = 0.5 * math_PI$6;
      Settings2.baumgarte = 0.2;
      Settings2.toiBaugarte = 0.75;
      Settings2.timeToSleep = 0.5;
      Settings2.linearSleepTolerance = 0.01;
      Settings2.angularSleepTolerance = 2 / 180 * math_PI$6;
      return Settings2;
    }()
  );
  var SettingsInternal = (
    /** @class */
    function() {
      function SettingsInternal2() {
      }
      Object.defineProperty(SettingsInternal2, "maxManifoldPoints", {
        get: function() {
          return Settings.maxManifoldPoints;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxPolygonVertices", {
        get: function() {
          return Settings.maxPolygonVertices;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "aabbExtension", {
        get: function() {
          return Settings.aabbExtension * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "aabbMultiplier", {
        get: function() {
          return Settings.aabbMultiplier;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSlop", {
        get: function() {
          return Settings.linearSlop * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSlopSquared", {
        get: function() {
          return Settings.linearSlop * Settings.lengthUnitsPerMeter * Settings.linearSlop * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSlop", {
        get: function() {
          return Settings.angularSlop;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "polygonRadius", {
        get: function() {
          return 2 * Settings.linearSlop;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxSubSteps", {
        get: function() {
          return Settings.maxSubSteps;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTOIContacts", {
        get: function() {
          return Settings.maxTOIContacts;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTOIIterations", {
        get: function() {
          return Settings.maxTOIIterations;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxDistanceIterations", {
        get: function() {
          return Settings.maxDistanceIterations;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "velocityThreshold", {
        get: function() {
          return Settings.velocityThreshold * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxLinearCorrection", {
        get: function() {
          return Settings.maxLinearCorrection * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxAngularCorrection", {
        get: function() {
          return Settings.maxAngularCorrection;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTranslation", {
        get: function() {
          return Settings.maxTranslation * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxTranslationSquared", {
        get: function() {
          return Settings.maxTranslation * Settings.lengthUnitsPerMeter * Settings.maxTranslation * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxRotation", {
        get: function() {
          return Settings.maxRotation;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "maxRotationSquared", {
        get: function() {
          return Settings.maxRotation * Settings.maxRotation;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "baumgarte", {
        get: function() {
          return Settings.baumgarte;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "toiBaugarte", {
        get: function() {
          return Settings.toiBaugarte;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "timeToSleep", {
        get: function() {
          return Settings.timeToSleep;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSleepTolerance", {
        get: function() {
          return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "linearSleepToleranceSqr", {
        get: function() {
          return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter * Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSleepTolerance", {
        get: function() {
          return Settings.angularSleepTolerance;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(SettingsInternal2, "angularSleepToleranceSqr", {
        get: function() {
          return Settings.angularSleepTolerance * Settings.angularSleepTolerance;
        },
        enumerable: false,
        configurable: true
      });
      return SettingsInternal2;
    }()
  );
  var Pool = (
    /** @class */
    function() {
      function Pool2(opts) {
        this._list = [];
        this._max = Infinity;
        this._hasCreateFn = false;
        this._createCount = 0;
        this._hasAllocateFn = false;
        this._allocateCount = 0;
        this._hasReleaseFn = false;
        this._releaseCount = 0;
        this._hasDisposeFn = false;
        this._disposeCount = 0;
        this._list = [];
        this._max = opts.max || this._max;
        this._createFn = opts.create;
        this._hasCreateFn = typeof this._createFn === "function";
        this._allocateFn = opts.allocate;
        this._hasAllocateFn = typeof this._allocateFn === "function";
        this._releaseFn = opts.release;
        this._hasReleaseFn = typeof this._releaseFn === "function";
        this._disposeFn = opts.dispose;
        this._hasDisposeFn = typeof this._disposeFn === "function";
      }
      Pool2.prototype.max = function(n2) {
        if (typeof n2 === "number") {
          this._max = n2;
          return this;
        }
        return this._max;
      };
      Pool2.prototype.size = function() {
        return this._list.length;
      };
      Pool2.prototype.allocate = function() {
        var item;
        if (this._list.length > 0) {
          item = this._list.shift();
        } else {
          this._createCount++;
          if (this._hasCreateFn) {
            item = this._createFn();
          } else {
            item = {};
          }
        }
        this._allocateCount++;
        if (this._hasAllocateFn) {
          this._allocateFn(item);
        }
        return item;
      };
      Pool2.prototype.release = function(item) {
        if (this._list.length < this._max) {
          this._releaseCount++;
          if (this._hasReleaseFn) {
            this._releaseFn(item);
          }
          this._list.push(item);
        } else {
          this._disposeCount++;
          if (this._hasDisposeFn) {
            item = this._disposeFn(item);
          }
        }
      };
      Pool2.prototype.toString = function() {
        return " +" + this._createCount + " >" + this._allocateCount + " <" + this._releaseCount + " -" + this._disposeCount + " =" + this._list.length + "/" + this._max;
      };
      return Pool2;
    }()
  );
  var math_abs$8 = Math.abs;
  var math_max$6 = Math.max;
  var TreeNode = (
    /** @class */
    function() {
      function TreeNode2(id) {
        this.aabb = new AABB();
        this.userData = null;
        this.parent = null;
        this.child1 = null;
        this.child2 = null;
        this.height = -1;
        this.id = id;
      }
      TreeNode2.prototype.toString = function() {
        return this.id + ": " + this.userData;
      };
      TreeNode2.prototype.isLeaf = function() {
        return this.child1 == null;
      };
      return TreeNode2;
    }()
  );
  var poolTreeNode = new Pool({
    create: function() {
      return new TreeNode();
    },
    release: function(node) {
      node.userData = null;
      node.parent = null;
      node.child1 = null;
      node.child2 = null;
      node.height = -1;
      node.id = void 0;
    }
  });
  var DynamicTree = (
    /** @class */
    function() {
      function DynamicTree2() {
        this.inputPool = new Pool({
          create: function() {
            return {};
          },
          release: function(stack) {
          }
        });
        this.stackPool = new Pool({
          create: function() {
            return [];
          },
          release: function(stack) {
            stack.length = 0;
          }
        });
        this.iteratorPool = new Pool({
          create: function() {
            return new Iterator();
          },
          release: function(iterator) {
            iterator.close();
          }
        });
        this.m_root = null;
        this.m_nodes = {};
        this.m_lastProxyId = 0;
      }
      DynamicTree2.prototype.getUserData = function(id) {
        var node = this.m_nodes[id];
        return node.userData;
      };
      DynamicTree2.prototype.getFatAABB = function(id) {
        var node = this.m_nodes[id];
        return node.aabb;
      };
      DynamicTree2.prototype.allocateNode = function() {
        var node = poolTreeNode.allocate();
        node.id = ++this.m_lastProxyId;
        this.m_nodes[node.id] = node;
        return node;
      };
      DynamicTree2.prototype.freeNode = function(node) {
        delete this.m_nodes[node.id];
        poolTreeNode.release(node);
      };
      DynamicTree2.prototype.createProxy = function(aabb, userData) {
        var node = this.allocateNode();
        node.aabb.set(aabb);
        AABB.extend(node.aabb, SettingsInternal.aabbExtension);
        node.userData = userData;
        node.height = 0;
        this.insertLeaf(node);
        return node.id;
      };
      DynamicTree2.prototype.destroyProxy = function(id) {
        var node = this.m_nodes[id];
        this.removeLeaf(node);
        this.freeNode(node);
      };
      DynamicTree2.prototype.moveProxy = function(id, aabb, d2) {
        var node = this.m_nodes[id];
        if (node.aabb.contains(aabb)) {
          return false;
        }
        this.removeLeaf(node);
        node.aabb.set(aabb);
        aabb = node.aabb;
        AABB.extend(aabb, SettingsInternal.aabbExtension);
        if (d2.x < 0) {
          aabb.lowerBound.x += d2.x * SettingsInternal.aabbMultiplier;
        } else {
          aabb.upperBound.x += d2.x * SettingsInternal.aabbMultiplier;
        }
        if (d2.y < 0) {
          aabb.lowerBound.y += d2.y * SettingsInternal.aabbMultiplier;
        } else {
          aabb.upperBound.y += d2.y * SettingsInternal.aabbMultiplier;
        }
        this.insertLeaf(node);
        return true;
      };
      DynamicTree2.prototype.insertLeaf = function(leaf) {
        if (this.m_root == null) {
          this.m_root = leaf;
          this.m_root.parent = null;
          return;
        }
        var leafAABB = leaf.aabb;
        var index = this.m_root;
        while (!index.isLeaf()) {
          var child1 = index.child1;
          var child2 = index.child2;
          var area = index.aabb.getPerimeter();
          var combinedArea = AABB.combinedPerimeter(index.aabb, leafAABB);
          var cost = 2 * combinedArea;
          var inheritanceCost = 2 * (combinedArea - area);
          var newArea1 = AABB.combinedPerimeter(leafAABB, child1.aabb);
          var cost1 = newArea1 + inheritanceCost;
          if (!child1.isLeaf()) {
            var oldArea = child1.aabb.getPerimeter();
            cost1 -= oldArea;
          }
          var newArea2 = AABB.combinedPerimeter(leafAABB, child2.aabb);
          var cost2 = newArea2 + inheritanceCost;
          if (!child2.isLeaf()) {
            var oldArea = child2.aabb.getPerimeter();
            cost2 -= oldArea;
          }
          if (cost < cost1 && cost < cost2) {
            break;
          }
          if (cost1 < cost2) {
            index = child1;
          } else {
            index = child2;
          }
        }
        var sibling = index;
        var oldParent = sibling.parent;
        var newParent = this.allocateNode();
        newParent.parent = oldParent;
        newParent.userData = null;
        newParent.aabb.combine(leafAABB, sibling.aabb);
        newParent.height = sibling.height + 1;
        if (oldParent != null) {
          if (oldParent.child1 === sibling) {
            oldParent.child1 = newParent;
          } else {
            oldParent.child2 = newParent;
          }
          newParent.child1 = sibling;
          newParent.child2 = leaf;
          sibling.parent = newParent;
          leaf.parent = newParent;
        } else {
          newParent.child1 = sibling;
          newParent.child2 = leaf;
          sibling.parent = newParent;
          leaf.parent = newParent;
          this.m_root = newParent;
        }
        index = leaf.parent;
        while (index != null) {
          index = this.balance(index);
          var child1 = index.child1;
          var child2 = index.child2;
          index.height = 1 + math_max$6(child1.height, child2.height);
          index.aabb.combine(child1.aabb, child2.aabb);
          index = index.parent;
        }
      };
      DynamicTree2.prototype.removeLeaf = function(leaf) {
        if (leaf === this.m_root) {
          this.m_root = null;
          return;
        }
        var parent = leaf.parent;
        var grandParent = parent.parent;
        var sibling;
        if (parent.child1 === leaf) {
          sibling = parent.child2;
        } else {
          sibling = parent.child1;
        }
        if (grandParent != null) {
          if (grandParent.child1 === parent) {
            grandParent.child1 = sibling;
          } else {
            grandParent.child2 = sibling;
          }
          sibling.parent = grandParent;
          this.freeNode(parent);
          var index = grandParent;
          while (index != null) {
            index = this.balance(index);
            var child1 = index.child1;
            var child2 = index.child2;
            index.aabb.combine(child1.aabb, child2.aabb);
            index.height = 1 + math_max$6(child1.height, child2.height);
            index = index.parent;
          }
        } else {
          this.m_root = sibling;
          sibling.parent = null;
          this.freeNode(parent);
        }
      };
      DynamicTree2.prototype.balance = function(iA) {
        var A = iA;
        if (A.isLeaf() || A.height < 2) {
          return iA;
        }
        var B = A.child1;
        var C = A.child2;
        var balance = C.height - B.height;
        if (balance > 1) {
          var F = C.child1;
          var G = C.child2;
          C.child1 = A;
          C.parent = A.parent;
          A.parent = C;
          if (C.parent != null) {
            if (C.parent.child1 === iA) {
              C.parent.child1 = C;
            } else {
              C.parent.child2 = C;
            }
          } else {
            this.m_root = C;
          }
          if (F.height > G.height) {
            C.child2 = F;
            A.child2 = G;
            G.parent = A;
            A.aabb.combine(B.aabb, G.aabb);
            C.aabb.combine(A.aabb, F.aabb);
            A.height = 1 + math_max$6(B.height, G.height);
            C.height = 1 + math_max$6(A.height, F.height);
          } else {
            C.child2 = G;
            A.child2 = F;
            F.parent = A;
            A.aabb.combine(B.aabb, F.aabb);
            C.aabb.combine(A.aabb, G.aabb);
            A.height = 1 + math_max$6(B.height, F.height);
            C.height = 1 + math_max$6(A.height, G.height);
          }
          return C;
        }
        if (balance < -1) {
          var D = B.child1;
          var E = B.child2;
          B.child1 = A;
          B.parent = A.parent;
          A.parent = B;
          if (B.parent != null) {
            if (B.parent.child1 === A) {
              B.parent.child1 = B;
            } else {
              B.parent.child2 = B;
            }
          } else {
            this.m_root = B;
          }
          if (D.height > E.height) {
            B.child2 = D;
            A.child1 = E;
            E.parent = A;
            A.aabb.combine(C.aabb, E.aabb);
            B.aabb.combine(A.aabb, D.aabb);
            A.height = 1 + math_max$6(C.height, E.height);
            B.height = 1 + math_max$6(A.height, D.height);
          } else {
            B.child2 = E;
            A.child1 = D;
            D.parent = A;
            A.aabb.combine(C.aabb, D.aabb);
            B.aabb.combine(A.aabb, E.aabb);
            A.height = 1 + math_max$6(C.height, D.height);
            B.height = 1 + math_max$6(A.height, E.height);
          }
          return B;
        }
        return A;
      };
      DynamicTree2.prototype.getHeight = function() {
        if (this.m_root == null) {
          return 0;
        }
        return this.m_root.height;
      };
      DynamicTree2.prototype.getAreaRatio = function() {
        if (this.m_root == null) {
          return 0;
        }
        var root = this.m_root;
        var rootArea = root.aabb.getPerimeter();
        var totalArea = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height < 0) {
            continue;
          }
          totalArea += node.aabb.getPerimeter();
        }
        this.iteratorPool.release(it);
        return totalArea / rootArea;
      };
      DynamicTree2.prototype.computeHeight = function(id) {
        var node;
        if (typeof id !== "undefined") {
          node = this.m_nodes[id];
        } else {
          node = this.m_root;
        }
        if (node.isLeaf()) {
          return 0;
        }
        var height1 = this.computeHeight(node.child1.id);
        var height2 = this.computeHeight(node.child2.id);
        return 1 + math_max$6(height1, height2);
      };
      DynamicTree2.prototype.validateStructure = function(node) {
        if (node == null) {
          return;
        }
        if (node === this.m_root) ;
        var child1 = node.child1;
        var child2 = node.child2;
        if (node.isLeaf()) {
          return;
        }
        this.validateStructure(child1);
        this.validateStructure(child2);
      };
      DynamicTree2.prototype.validateMetrics = function(node) {
        if (node == null) {
          return;
        }
        var child1 = node.child1;
        var child2 = node.child2;
        if (node.isLeaf()) {
          return;
        }
        this.validateMetrics(child1);
        this.validateMetrics(child2);
      };
      DynamicTree2.prototype.validate = function() {
        return;
      };
      DynamicTree2.prototype.getMaxBalance = function() {
        var maxBalance = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height <= 1) {
            continue;
          }
          var balance = math_abs$8(node.child2.height - node.child1.height);
          maxBalance = math_max$6(maxBalance, balance);
        }
        this.iteratorPool.release(it);
        return maxBalance;
      };
      DynamicTree2.prototype.rebuildBottomUp = function() {
        var nodes = [];
        var count = 0;
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          if (node.height < 0) {
            continue;
          }
          if (node.isLeaf()) {
            node.parent = null;
            nodes[count] = node;
            ++count;
          } else {
            this.freeNode(node);
          }
        }
        this.iteratorPool.release(it);
        while (count > 1) {
          var minCost = Infinity;
          var iMin = -1;
          var jMin = -1;
          for (var i = 0; i < count; ++i) {
            var aabbi = nodes[i].aabb;
            for (var j = i + 1; j < count; ++j) {
              var aabbj = nodes[j].aabb;
              var cost = AABB.combinedPerimeter(aabbi, aabbj);
              if (cost < minCost) {
                iMin = i;
                jMin = j;
                minCost = cost;
              }
            }
          }
          var child1 = nodes[iMin];
          var child2 = nodes[jMin];
          var parent_1 = this.allocateNode();
          parent_1.child1 = child1;
          parent_1.child2 = child2;
          parent_1.height = 1 + math_max$6(child1.height, child2.height);
          parent_1.aabb.combine(child1.aabb, child2.aabb);
          parent_1.parent = null;
          child1.parent = parent_1;
          child2.parent = parent_1;
          nodes[jMin] = nodes[count - 1];
          nodes[iMin] = parent_1;
          --count;
        }
        this.m_root = nodes[0];
      };
      DynamicTree2.prototype.shiftOrigin = function(newOrigin) {
        var node;
        var it = this.iteratorPool.allocate().preorder(this.m_root);
        while (node = it.next()) {
          var aabb = node.aabb;
          aabb.lowerBound.x -= newOrigin.x;
          aabb.lowerBound.y -= newOrigin.y;
          aabb.upperBound.x -= newOrigin.x;
          aabb.upperBound.y -= newOrigin.y;
        }
        this.iteratorPool.release(it);
      };
      DynamicTree2.prototype.query = function(aabb, queryCallback) {
        var stack = this.stackPool.allocate();
        stack.push(this.m_root);
        while (stack.length > 0) {
          var node = stack.pop();
          if (node == null) {
            continue;
          }
          if (AABB.testOverlap(node.aabb, aabb)) {
            if (node.isLeaf()) {
              var proceed = queryCallback(node.id);
              if (proceed === false) {
                return;
              }
            } else {
              stack.push(node.child1);
              stack.push(node.child2);
            }
          }
        }
        this.stackPool.release(stack);
      };
      DynamicTree2.prototype.rayCast = function(input2, rayCastCallback) {
        var p1 = input2.p1;
        var p2 = input2.p2;
        var r = Vec2.sub(p2, p1);
        r.normalize();
        var v3 = Vec2.crossNumVec2(1, r);
        var abs_v = Vec2.abs(v3);
        var maxFraction = input2.maxFraction;
        var segmentAABB = new AABB();
        var t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);
        segmentAABB.combinePoints(p1, t);
        var stack = this.stackPool.allocate();
        var subInput = this.inputPool.allocate();
        stack.push(this.m_root);
        while (stack.length > 0) {
          var node = stack.pop();
          if (node == null) {
            continue;
          }
          if (AABB.testOverlap(node.aabb, segmentAABB) === false) {
            continue;
          }
          var c2 = node.aabb.getCenter();
          var h = node.aabb.getExtents();
          var separation = math_abs$8(Vec2.dot(v3, Vec2.sub(p1, c2))) - Vec2.dot(abs_v, h);
          if (separation > 0) {
            continue;
          }
          if (node.isLeaf()) {
            subInput.p1 = Vec2.clone(input2.p1);
            subInput.p2 = Vec2.clone(input2.p2);
            subInput.maxFraction = maxFraction;
            var value = rayCastCallback(subInput, node.id);
            if (value === 0) {
              break;
            } else if (value > 0) {
              maxFraction = value;
              t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);
              segmentAABB.combinePoints(p1, t);
            }
          } else {
            stack.push(node.child1);
            stack.push(node.child2);
          }
        }
        this.stackPool.release(stack);
        this.inputPool.release(subInput);
      };
      return DynamicTree2;
    }()
  );
  var Iterator = (
    /** @class */
    function() {
      function Iterator2() {
        this.parents = [];
        this.states = [];
      }
      Iterator2.prototype.preorder = function(root) {
        this.parents.length = 0;
        this.parents.push(root);
        this.states.length = 0;
        this.states.push(0);
        return this;
      };
      Iterator2.prototype.next = function() {
        while (this.parents.length > 0) {
          var i = this.parents.length - 1;
          var node = this.parents[i];
          if (this.states[i] === 0) {
            this.states[i] = 1;
            return node;
          }
          if (this.states[i] === 1) {
            this.states[i] = 2;
            if (node.child1) {
              this.parents.push(node.child1);
              this.states.push(1);
              return node.child1;
            }
          }
          if (this.states[i] === 2) {
            this.states[i] = 3;
            if (node.child2) {
              this.parents.push(node.child2);
              this.states.push(1);
              return node.child2;
            }
          }
          this.parents.pop();
          this.states.pop();
        }
      };
      Iterator2.prototype.close = function() {
        this.parents.length = 0;
      };
      return Iterator2;
    }()
  );
  var math_max$5 = Math.max;
  var math_min$6 = Math.min;
  var BroadPhase = (
    /** @class */
    function() {
      function BroadPhase2() {
        var _this = this;
        this.m_tree = new DynamicTree();
        this.m_moveBuffer = [];
        this.query = function(aabb, queryCallback) {
          _this.m_tree.query(aabb, queryCallback);
        };
        this.queryCallback = function(proxyId) {
          if (proxyId === _this.m_queryProxyId) {
            return true;
          }
          var proxyIdA = math_min$6(proxyId, _this.m_queryProxyId);
          var proxyIdB = math_max$5(proxyId, _this.m_queryProxyId);
          var userDataA = _this.m_tree.getUserData(proxyIdA);
          var userDataB = _this.m_tree.getUserData(proxyIdB);
          _this.m_callback(userDataA, userDataB);
          return true;
        };
      }
      BroadPhase2.prototype.getUserData = function(proxyId) {
        return this.m_tree.getUserData(proxyId);
      };
      BroadPhase2.prototype.testOverlap = function(proxyIdA, proxyIdB) {
        var aabbA = this.m_tree.getFatAABB(proxyIdA);
        var aabbB = this.m_tree.getFatAABB(proxyIdB);
        return AABB.testOverlap(aabbA, aabbB);
      };
      BroadPhase2.prototype.getFatAABB = function(proxyId) {
        return this.m_tree.getFatAABB(proxyId);
      };
      BroadPhase2.prototype.getProxyCount = function() {
        return this.m_moveBuffer.length;
      };
      BroadPhase2.prototype.getTreeHeight = function() {
        return this.m_tree.getHeight();
      };
      BroadPhase2.prototype.getTreeBalance = function() {
        return this.m_tree.getMaxBalance();
      };
      BroadPhase2.prototype.getTreeQuality = function() {
        return this.m_tree.getAreaRatio();
      };
      BroadPhase2.prototype.rayCast = function(input2, rayCastCallback) {
        this.m_tree.rayCast(input2, rayCastCallback);
      };
      BroadPhase2.prototype.shiftOrigin = function(newOrigin) {
        this.m_tree.shiftOrigin(newOrigin);
      };
      BroadPhase2.prototype.createProxy = function(aabb, userData) {
        var proxyId = this.m_tree.createProxy(aabb, userData);
        this.bufferMove(proxyId);
        return proxyId;
      };
      BroadPhase2.prototype.destroyProxy = function(proxyId) {
        this.unbufferMove(proxyId);
        this.m_tree.destroyProxy(proxyId);
      };
      BroadPhase2.prototype.moveProxy = function(proxyId, aabb, displacement2) {
        var changed = this.m_tree.moveProxy(proxyId, aabb, displacement2);
        if (changed) {
          this.bufferMove(proxyId);
        }
      };
      BroadPhase2.prototype.touchProxy = function(proxyId) {
        this.bufferMove(proxyId);
      };
      BroadPhase2.prototype.bufferMove = function(proxyId) {
        this.m_moveBuffer.push(proxyId);
      };
      BroadPhase2.prototype.unbufferMove = function(proxyId) {
        for (var i = 0; i < this.m_moveBuffer.length; ++i) {
          if (this.m_moveBuffer[i] === proxyId) {
            this.m_moveBuffer[i] = null;
          }
        }
      };
      BroadPhase2.prototype.updatePairs = function(addPairCallback) {
        this.m_callback = addPairCallback;
        while (this.m_moveBuffer.length > 0) {
          this.m_queryProxyId = this.m_moveBuffer.pop();
          if (this.m_queryProxyId === null) {
            continue;
          }
          var fatAABB = this.m_tree.getFatAABB(this.m_queryProxyId);
          this.m_tree.query(fatAABB, this.queryCallback);
        }
      };
      return BroadPhase2;
    }()
  );
  var math_sin$2 = Math.sin;
  var math_cos$2 = Math.cos;
  var math_sqrt$4 = Math.sqrt;
  function vec2(x2, y) {
    return { x: x2, y };
  }
  function rotation(angle) {
    return { s: math_sin$2(angle), c: math_cos$2(angle) };
  }
  function setVec2(out, x2, y) {
    out.x = x2;
    out.y = y;
    return out;
  }
  function copyVec2(out, w) {
    out.x = w.x;
    out.y = w.y;
    return out;
  }
  function zeroVec2(out) {
    out.x = 0;
    out.y = 0;
    return out;
  }
  function negVec2(out) {
    out.x = -out.x;
    out.y = -out.y;
    return out;
  }
  function plusVec2(out, w) {
    out.x += w.x;
    out.y += w.y;
    return out;
  }
  function addVec2(out, v3, w) {
    out.x = v3.x + w.x;
    out.y = v3.x + w.y;
    return out;
  }
  function minusVec2(out, w) {
    out.x -= w.x;
    out.y -= w.y;
    return out;
  }
  function subVec2(out, v3, w) {
    out.x = v3.x - w.x;
    out.y = v3.y - w.y;
    return out;
  }
  function mulVec2(out, m) {
    out.x *= m;
    out.y *= m;
    return out;
  }
  function scaleVec2(out, m, w) {
    out.x = m * w.x;
    out.y = m * w.y;
    return out;
  }
  function plusScaleVec2(out, m, w) {
    out.x += m * w.x;
    out.y += m * w.y;
    return out;
  }
  function minusScaleVec2(out, m, w) {
    out.x -= m * w.x;
    out.y -= m * w.y;
    return out;
  }
  function combine2Vec2(out, am, a2, bm, b2) {
    out.x = am * a2.x + bm * b2.x;
    out.y = am * a2.y + bm * b2.y;
    return out;
  }
  function combine3Vec2(out, am, a2, bm, b2, cm, c2) {
    out.x = am * a2.x + bm * b2.x + cm * c2.x;
    out.y = am * a2.y + bm * b2.y + cm * c2.y;
    return out;
  }
  function normalizeVec2Length(out) {
    var length = math_sqrt$4(out.x * out.x + out.y * out.y);
    if (length !== 0) {
      var invLength = 1 / length;
      out.x *= invLength;
      out.y *= invLength;
    }
    return length;
  }
  function normalizeVec2(out) {
    var length = math_sqrt$4(out.x * out.x + out.y * out.y);
    if (length > 0) {
      var invLength = 1 / length;
      out.x *= invLength;
      out.y *= invLength;
    }
    return out;
  }
  function crossVec2Num(out, v3, w) {
    var x2 = w * v3.y;
    var y = -w * v3.x;
    out.x = x2;
    out.y = y;
    return out;
  }
  function crossNumVec2(out, w, v3) {
    var x2 = -w * v3.y;
    var y = w * v3.x;
    out.x = x2;
    out.y = y;
    return out;
  }
  function crossVec2Vec2(a2, b2) {
    return a2.x * b2.y - a2.y * b2.x;
  }
  function dotVec2(a2, b2) {
    return a2.x * b2.x + a2.y * b2.y;
  }
  function lengthSqrVec2(a2) {
    return a2.x * a2.x + a2.y * a2.y;
  }
  function distVec2(a2, b2) {
    var dx = a2.x - b2.x;
    var dy = a2.y - b2.y;
    return math_sqrt$4(dx * dx + dy * dy);
  }
  function distSqrVec2(a2, b2) {
    var dx = a2.x - b2.x;
    var dy = a2.y - b2.y;
    return dx * dx + dy * dy;
  }
  function setRotAngle(out, a2) {
    out.c = math_cos$2(a2);
    out.s = math_sin$2(a2);
    return out;
  }
  function rotVec2(out, q, v3) {
    out.x = q.c * v3.x - q.s * v3.y;
    out.y = q.s * v3.x + q.c * v3.y;
    return out;
  }
  function derotVec2(out, q, v3) {
    var x2 = q.c * v3.x + q.s * v3.y;
    var y = -q.s * v3.x + q.c * v3.y;
    out.x = x2;
    out.y = y;
    return out;
  }
  function rerotVec2(out, before, after, v3) {
    var x0 = before.c * v3.x + before.s * v3.y;
    var y0 = -before.s * v3.x + before.c * v3.y;
    var x2 = after.c * x0 - after.s * y0;
    var y = after.s * x0 + after.c * y0;
    out.x = x2;
    out.y = y;
    return out;
  }
  function transform(x2, y, a2) {
    return { p: vec2(x2, y), q: rotation(a2) };
  }
  function copyTransform(out, transform2) {
    out.p.x = transform2.p.x;
    out.p.y = transform2.p.y;
    out.q.s = transform2.q.s;
    out.q.c = transform2.q.c;
    return out;
  }
  function transformVec2(out, xf2, v3) {
    var x2 = xf2.q.c * v3.x - xf2.q.s * v3.y + xf2.p.x;
    var y = xf2.q.s * v3.x + xf2.q.c * v3.y + xf2.p.y;
    out.x = x2;
    out.y = y;
    return out;
  }
  function detransformVec2(out, xf2, v3) {
    var px = v3.x - xf2.p.x;
    var py = v3.y - xf2.p.y;
    var x2 = xf2.q.c * px + xf2.q.s * py;
    var y = -xf2.q.s * px + xf2.q.c * py;
    out.x = x2;
    out.y = y;
    return out;
  }
  function retransformVec2(out, from, to, v3) {
    var x0 = from.q.c * v3.x - from.q.s * v3.y + from.p.x;
    var y0 = from.q.s * v3.x + from.q.c * v3.y + from.p.y;
    var px = x0 - to.p.x;
    var py = y0 - to.p.y;
    var x2 = to.q.c * px + to.q.s * py;
    var y = -to.q.s * px + to.q.c * py;
    out.x = x2;
    out.y = y;
    return out;
  }
  function detransformTransform(out, a2, b2) {
    var c2 = a2.q.c * b2.q.c + a2.q.s * b2.q.s;
    var s2 = a2.q.c * b2.q.s - a2.q.s * b2.q.c;
    var x2 = a2.q.c * (b2.p.x - a2.p.x) + a2.q.s * (b2.p.y - a2.p.y);
    var y = -a2.q.s * (b2.p.x - a2.p.x) + a2.q.c * (b2.p.y - a2.p.y);
    out.q.c = c2;
    out.q.s = s2;
    out.p.x = x2;
    out.p.y = y;
    return out;
  }
  var math_sin$1 = Math.sin;
  var math_cos$1 = Math.cos;
  var math_atan2$1 = Math.atan2;
  var Rot = (
    /** @class */
    function() {
      function Rot2(angle) {
        if (!(this instanceof Rot2)) {
          return new Rot2(angle);
        }
        if (typeof angle === "number") {
          this.setAngle(angle);
        } else if (typeof angle === "object") {
          this.setRot(angle);
        } else {
          this.setIdentity();
        }
      }
      Rot2.neo = function(angle) {
        var obj = Object.create(Rot2.prototype);
        obj.setAngle(angle);
        return obj;
      };
      Rot2.clone = function(rot) {
        var obj = Object.create(Rot2.prototype);
        obj.s = rot.s;
        obj.c = rot.c;
        return obj;
      };
      Rot2.identity = function() {
        var obj = Object.create(Rot2.prototype);
        obj.s = 0;
        obj.c = 1;
        return obj;
      };
      Rot2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.s) && Number.isFinite(obj.c);
      };
      Rot2.assert = function(o) {
      };
      Rot2.prototype.setIdentity = function() {
        this.s = 0;
        this.c = 1;
      };
      Rot2.prototype.set = function(angle) {
        if (typeof angle === "object") {
          this.s = angle.s;
          this.c = angle.c;
        } else {
          this.s = math_sin$1(angle);
          this.c = math_cos$1(angle);
        }
      };
      Rot2.prototype.setRot = function(angle) {
        this.s = angle.s;
        this.c = angle.c;
      };
      Rot2.prototype.setAngle = function(angle) {
        this.s = math_sin$1(angle);
        this.c = math_cos$1(angle);
      };
      Rot2.prototype.getAngle = function() {
        return math_atan2$1(this.s, this.c);
      };
      Rot2.prototype.getXAxis = function() {
        return Vec2.neo(this.c, this.s);
      };
      Rot2.prototype.getYAxis = function() {
        return Vec2.neo(-this.s, this.c);
      };
      Rot2.mul = function(rot, m) {
        if ("c" in m && "s" in m) {
          var qr = Rot2.identity();
          qr.s = rot.s * m.c + rot.c * m.s;
          qr.c = rot.c * m.c - rot.s * m.s;
          return qr;
        } else if ("x" in m && "y" in m) {
          return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);
        }
      };
      Rot2.mulRot = function(rot, m) {
        var qr = Rot2.identity();
        qr.s = rot.s * m.c + rot.c * m.s;
        qr.c = rot.c * m.c - rot.s * m.s;
        return qr;
      };
      Rot2.mulVec2 = function(rot, m) {
        return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);
      };
      Rot2.mulSub = function(rot, v3, w) {
        var x2 = rot.c * (v3.x - w.x) - rot.s * (v3.y - w.y);
        var y = rot.s * (v3.x - w.x) + rot.c * (v3.y - w.y);
        return Vec2.neo(x2, y);
      };
      Rot2.mulT = function(rot, m) {
        if ("c" in m && "s" in m) {
          var qr = Rot2.identity();
          qr.s = rot.c * m.s - rot.s * m.c;
          qr.c = rot.c * m.c + rot.s * m.s;
          return qr;
        } else if ("x" in m && "y" in m) {
          return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);
        }
      };
      Rot2.mulTRot = function(rot, m) {
        var qr = Rot2.identity();
        qr.s = rot.c * m.s - rot.s * m.c;
        qr.c = rot.c * m.c + rot.s * m.s;
        return qr;
      };
      Rot2.mulTVec2 = function(rot, m) {
        return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);
      };
      return Rot2;
    }()
  );
  var math_atan2 = Math.atan2;
  var math_PI$5 = Math.PI;
  var temp$7 = vec2(0, 0);
  var Sweep = (
    /** @class */
    function() {
      function Sweep2() {
        this.localCenter = Vec2.zero();
        this.c = Vec2.zero();
        this.a = 0;
        this.alpha0 = 0;
        this.c0 = Vec2.zero();
        this.a0 = 0;
      }
      Sweep2.prototype.recycle = function() {
        zeroVec2(this.localCenter);
        zeroVec2(this.c);
        this.a = 0;
        this.alpha0 = 0;
        zeroVec2(this.c0);
        this.a0 = 0;
      };
      Sweep2.prototype.setTransform = function(xf2) {
        transformVec2(temp$7, xf2, this.localCenter);
        copyVec2(this.c, temp$7);
        copyVec2(this.c0, temp$7);
        this.a = this.a0 = math_atan2(xf2.q.s, xf2.q.c);
      };
      Sweep2.prototype.setLocalCenter = function(localCenter2, xf2) {
        copyVec2(this.localCenter, localCenter2);
        transformVec2(temp$7, xf2, this.localCenter);
        copyVec2(this.c, temp$7);
        copyVec2(this.c0, temp$7);
      };
      Sweep2.prototype.getTransform = function(xf2, beta) {
        if (beta === void 0) {
          beta = 0;
        }
        setRotAngle(xf2.q, (1 - beta) * this.a0 + beta * this.a);
        combine2Vec2(xf2.p, 1 - beta, this.c0, beta, this.c);
        minusVec2(xf2.p, rotVec2(temp$7, xf2.q, this.localCenter));
      };
      Sweep2.prototype.advance = function(alpha) {
        var beta = (alpha - this.alpha0) / (1 - this.alpha0);
        combine2Vec2(this.c0, beta, this.c, 1 - beta, this.c0);
        this.a0 = beta * this.a + (1 - beta) * this.a0;
        this.alpha0 = alpha;
      };
      Sweep2.prototype.forward = function() {
        this.a0 = this.a;
        copyVec2(this.c0, this.c);
      };
      Sweep2.prototype.normalize = function() {
        var a0 = mod(this.a0, -math_PI$5, +math_PI$5);
        this.a -= this.a0 - a0;
        this.a0 = a0;
      };
      Sweep2.prototype.set = function(that) {
        copyVec2(this.localCenter, that.localCenter);
        copyVec2(this.c, that.c);
        this.a = that.a;
        this.alpha0 = that.alpha0;
        copyVec2(this.c0, that.c0);
        this.a0 = that.a0;
      };
      return Sweep2;
    }()
  );
  var Transform = (
    /** @class */
    function() {
      function Transform2(position, rotation2) {
        if (!(this instanceof Transform2)) {
          return new Transform2(position, rotation2);
        }
        this.p = Vec2.zero();
        this.q = Rot.identity();
        if (typeof position !== "undefined") {
          this.p.setVec2(position);
        }
        if (typeof rotation2 !== "undefined") {
          this.q.setAngle(rotation2);
        }
      }
      Transform2.clone = function(xf2) {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.clone(xf2.p);
        obj.q = Rot.clone(xf2.q);
        return obj;
      };
      Transform2.neo = function(position, rotation2) {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.clone(position);
        obj.q = Rot.clone(rotation2);
        return obj;
      };
      Transform2.identity = function() {
        var obj = Object.create(Transform2.prototype);
        obj.p = Vec2.zero();
        obj.q = Rot.identity();
        return obj;
      };
      Transform2.prototype.setIdentity = function() {
        this.p.setZero();
        this.q.setIdentity();
      };
      Transform2.prototype.set = function(a2, b2) {
        if (typeof b2 === "undefined") {
          this.p.set(a2.p);
          this.q.set(a2.q);
        } else {
          this.p.set(a2);
          this.q.set(b2);
        }
      };
      Transform2.prototype.setNum = function(position, rotation2) {
        this.p.setVec2(position);
        this.q.setAngle(rotation2);
      };
      Transform2.prototype.setTransform = function(xf2) {
        this.p.setVec2(xf2.p);
        this.q.setRot(xf2.q);
      };
      Transform2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.p) && Rot.isValid(obj.q);
      };
      Transform2.assert = function(o) {
      };
      Transform2.mul = function(a2, b2) {
        if (Array.isArray(b2)) {
          var arr = [];
          for (var i = 0; i < b2.length; i++) {
            arr[i] = Transform2.mul(a2, b2[i]);
          }
          return arr;
        } else if ("x" in b2 && "y" in b2) {
          return Transform2.mulVec2(a2, b2);
        } else if ("p" in b2 && "q" in b2) {
          return Transform2.mulXf(a2, b2);
        }
      };
      Transform2.mulAll = function(a2, b2) {
        var arr = [];
        for (var i = 0; i < b2.length; i++) {
          arr[i] = Transform2.mul(a2, b2[i]);
        }
        return arr;
      };
      Transform2.mulFn = function(a2) {
        return function(b2) {
          return Transform2.mul(a2, b2);
        };
      };
      Transform2.mulVec2 = function(a2, b2) {
        var x2 = a2.q.c * b2.x - a2.q.s * b2.y + a2.p.x;
        var y = a2.q.s * b2.x + a2.q.c * b2.y + a2.p.y;
        return Vec2.neo(x2, y);
      };
      Transform2.mulXf = function(a2, b2) {
        var xf2 = Transform2.identity();
        xf2.q = Rot.mulRot(a2.q, b2.q);
        xf2.p = Vec2.add(Rot.mulVec2(a2.q, b2.p), a2.p);
        return xf2;
      };
      Transform2.mulT = function(a2, b2) {
        if ("x" in b2 && "y" in b2) {
          return Transform2.mulTVec2(a2, b2);
        } else if ("p" in b2 && "q" in b2) {
          return Transform2.mulTXf(a2, b2);
        }
      };
      Transform2.mulTVec2 = function(a2, b2) {
        var px = b2.x - a2.p.x;
        var py = b2.y - a2.p.y;
        var x2 = a2.q.c * px + a2.q.s * py;
        var y = -a2.q.s * px + a2.q.c * py;
        return Vec2.neo(x2, y);
      };
      Transform2.mulTXf = function(a2, b2) {
        var xf2 = Transform2.identity();
        xf2.q.setRot(Rot.mulTRot(a2.q, b2.q));
        xf2.p.setVec2(Rot.mulTVec2(a2.q, Vec2.sub(b2.p, a2.p)));
        return xf2;
      };
      return Transform2;
    }()
  );
  var Velocity = (
    /** @class */
    /* @__PURE__ */ function() {
      function Velocity2() {
        this.v = Vec2.zero();
        this.w = 0;
      }
      return Velocity2;
    }()
  );
  var math_sin = Math.sin;
  var math_cos = Math.cos;
  var Position = (
    /** @class */
    function() {
      function Position2() {
        this.c = Vec2.zero();
        this.a = 0;
      }
      Position2.prototype.getTransform = function(xf2, p) {
        xf2.q.c = math_cos(this.a);
        xf2.q.s = math_sin(this.a);
        xf2.p.x = this.c.x - (xf2.q.c * p.x - xf2.q.s * p.y);
        xf2.p.y = this.c.y - (xf2.q.s * p.x + xf2.q.c * p.y);
        return xf2;
      };
      return Position2;
    }()
  );
  function getTransform(xf2, p, c2, a2) {
    xf2.q.c = math_cos(a2);
    xf2.q.s = math_sin(a2);
    xf2.p.x = c2.x - (xf2.q.c * p.x - xf2.q.s * p.y);
    xf2.p.y = c2.y - (xf2.q.s * p.x + xf2.q.c * p.y);
    return xf2;
  }
  var Shape = (
    /** @class */
    function() {
      function Shape2() {
        this.style = {};
        this.appData = {};
      }
      Shape2.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return typeof obj.m_type === "string" && typeof obj.m_radius === "number";
      };
      return Shape2;
    }()
  );
  var synchronize_aabb1 = new AABB();
  var synchronize_aabb2 = new AABB();
  var displacement = vec2(0, 0);
  var FixtureDefDefault = {
    userData: null,
    friction: 0.2,
    restitution: 0,
    density: 0,
    isSensor: false,
    filterGroupIndex: 0,
    filterCategoryBits: 1,
    filterMaskBits: 65535
  };
  var FixtureProxy = (
    /** @class */
    /* @__PURE__ */ function() {
      function FixtureProxy2(fixture, childIndex) {
        this.aabb = new AABB();
        this.fixture = fixture;
        this.childIndex = childIndex;
      }
      return FixtureProxy2;
    }()
  );
  var Fixture = (
    /** @class */
    function() {
      function Fixture2(body, shape, def) {
        this.style = {};
        this.appData = {};
        if (shape.shape) {
          def = shape;
          shape = shape.shape;
        } else if (typeof def === "number") {
          def = { density: def };
        }
        def = options(def, FixtureDefDefault);
        this.m_body = body;
        this.m_friction = def.friction;
        this.m_restitution = def.restitution;
        this.m_density = def.density;
        this.m_isSensor = def.isSensor;
        this.m_filterGroupIndex = def.filterGroupIndex;
        this.m_filterCategoryBits = def.filterCategoryBits;
        this.m_filterMaskBits = def.filterMaskBits;
        this.m_shape = shape;
        this.m_next = null;
        this.m_proxies = [];
        this.m_proxyCount = 0;
        var childCount = this.m_shape.getChildCount();
        for (var i = 0; i < childCount; ++i) {
          this.m_proxies[i] = new FixtureProxy(this, i);
        }
        this.m_userData = def.userData;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Fixture2.prototype._reset = function() {
        var body = this.getBody();
        var broadPhase = body.m_world.m_broadPhase;
        this.destroyProxies(broadPhase);
        if (this.m_shape._reset) {
          this.m_shape._reset();
        }
        var childCount = this.m_shape.getChildCount();
        for (var i = 0; i < childCount; ++i) {
          this.m_proxies[i] = new FixtureProxy(this, i);
        }
        this.createProxies(broadPhase, body.m_xf);
        body.resetMassData();
      };
      Fixture2.prototype._serialize = function() {
        return {
          friction: this.m_friction,
          restitution: this.m_restitution,
          density: this.m_density,
          isSensor: this.m_isSensor,
          filterGroupIndex: this.m_filterGroupIndex,
          filterCategoryBits: this.m_filterCategoryBits,
          filterMaskBits: this.m_filterMaskBits,
          shape: this.m_shape
        };
      };
      Fixture2._deserialize = function(data, body, restore) {
        var shape = restore(Shape, data.shape);
        var fixture = shape && new Fixture2(body, shape, data);
        return fixture;
      };
      Fixture2.prototype.getType = function() {
        return this.m_shape.m_type;
      };
      Fixture2.prototype.getShape = function() {
        return this.m_shape;
      };
      Fixture2.prototype.isSensor = function() {
        return this.m_isSensor;
      };
      Fixture2.prototype.setSensor = function(sensor) {
        if (sensor != this.m_isSensor) {
          this.m_body.setAwake(true);
          this.m_isSensor = sensor;
        }
      };
      Fixture2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Fixture2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Fixture2.prototype.getBody = function() {
        return this.m_body;
      };
      Fixture2.prototype.getNext = function() {
        return this.m_next;
      };
      Fixture2.prototype.getDensity = function() {
        return this.m_density;
      };
      Fixture2.prototype.setDensity = function(density) {
        this.m_density = density;
      };
      Fixture2.prototype.getFriction = function() {
        return this.m_friction;
      };
      Fixture2.prototype.setFriction = function(friction) {
        this.m_friction = friction;
      };
      Fixture2.prototype.getRestitution = function() {
        return this.m_restitution;
      };
      Fixture2.prototype.setRestitution = function(restitution) {
        this.m_restitution = restitution;
      };
      Fixture2.prototype.testPoint = function(p) {
        return this.m_shape.testPoint(this.m_body.getTransform(), p);
      };
      Fixture2.prototype.rayCast = function(output2, input2, childIndex) {
        return this.m_shape.rayCast(output2, input2, this.m_body.getTransform(), childIndex);
      };
      Fixture2.prototype.getMassData = function(massData) {
        this.m_shape.computeMass(massData, this.m_density);
      };
      Fixture2.prototype.getAABB = function(childIndex) {
        return this.m_proxies[childIndex].aabb;
      };
      Fixture2.prototype.createProxies = function(broadPhase, xf2) {
        this.m_proxyCount = this.m_shape.getChildCount();
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          this.m_shape.computeAABB(proxy.aabb, xf2, i);
          proxy.proxyId = broadPhase.createProxy(proxy.aabb, proxy);
        }
      };
      Fixture2.prototype.destroyProxies = function(broadPhase) {
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          broadPhase.destroyProxy(proxy.proxyId);
          proxy.proxyId = null;
        }
        this.m_proxyCount = 0;
      };
      Fixture2.prototype.synchronize = function(broadPhase, xf1, xf2) {
        for (var i = 0; i < this.m_proxyCount; ++i) {
          var proxy = this.m_proxies[i];
          this.m_shape.computeAABB(synchronize_aabb1, xf1, proxy.childIndex);
          this.m_shape.computeAABB(synchronize_aabb2, xf2, proxy.childIndex);
          proxy.aabb.combine(synchronize_aabb1, synchronize_aabb2);
          subVec2(displacement, xf2.p, xf1.p);
          broadPhase.moveProxy(proxy.proxyId, proxy.aabb, displacement);
        }
      };
      Fixture2.prototype.setFilterData = function(filter) {
        this.m_filterGroupIndex = filter.groupIndex;
        this.m_filterCategoryBits = filter.categoryBits;
        this.m_filterMaskBits = filter.maskBits;
        this.refilter();
      };
      Fixture2.prototype.getFilterGroupIndex = function() {
        return this.m_filterGroupIndex;
      };
      Fixture2.prototype.setFilterGroupIndex = function(groupIndex) {
        this.m_filterGroupIndex = groupIndex;
        this.refilter();
      };
      Fixture2.prototype.getFilterCategoryBits = function() {
        return this.m_filterCategoryBits;
      };
      Fixture2.prototype.setFilterCategoryBits = function(categoryBits) {
        this.m_filterCategoryBits = categoryBits;
        this.refilter();
      };
      Fixture2.prototype.getFilterMaskBits = function() {
        return this.m_filterMaskBits;
      };
      Fixture2.prototype.setFilterMaskBits = function(maskBits) {
        this.m_filterMaskBits = maskBits;
        this.refilter();
      };
      Fixture2.prototype.refilter = function() {
        if (this.m_body == null) {
          return;
        }
        var edge = this.m_body.getContactList();
        while (edge) {
          var contact = edge.contact;
          var fixtureA = contact.getFixtureA();
          var fixtureB = contact.getFixtureB();
          if (fixtureA == this || fixtureB == this) {
            contact.flagForFiltering();
          }
          edge = edge.next;
        }
        var world = this.m_body.getWorld();
        if (world == null) {
          return;
        }
        var broadPhase = world.m_broadPhase;
        for (var i = 0; i < this.m_proxyCount; ++i) {
          broadPhase.touchProxy(this.m_proxies[i].proxyId);
        }
      };
      Fixture2.prototype.shouldCollide = function(that) {
        if (that.m_filterGroupIndex === this.m_filterGroupIndex && that.m_filterGroupIndex !== 0) {
          return that.m_filterGroupIndex > 0;
        }
        var collideA = (that.m_filterMaskBits & this.m_filterCategoryBits) !== 0;
        var collideB = (that.m_filterCategoryBits & this.m_filterMaskBits) !== 0;
        var collide = collideA && collideB;
        return collide;
      };
      return Fixture2;
    }()
  );
  var STATIC = "static";
  var KINEMATIC = "kinematic";
  var DYNAMIC = "dynamic";
  var oldCenter = vec2(0, 0);
  var localCenter = vec2(0, 0);
  var shift = vec2(0, 0);
  var temp$6 = vec2(0, 0);
  var xf$2 = transform(0, 0, 0);
  var BodyDefDefault = {
    type: STATIC,
    position: Vec2.zero(),
    angle: 0,
    linearVelocity: Vec2.zero(),
    angularVelocity: 0,
    linearDamping: 0,
    angularDamping: 0,
    fixedRotation: false,
    bullet: false,
    gravityScale: 1,
    allowSleep: true,
    awake: true,
    active: true,
    userData: null
  };
  var Body = (
    /** @class */
    function() {
      function Body2(world, def) {
        this.style = {};
        this.appData = {};
        def = options(def, BodyDefDefault);
        this.m_world = world;
        this.m_awakeFlag = def.awake;
        this.m_autoSleepFlag = def.allowSleep;
        this.m_bulletFlag = def.bullet;
        this.m_fixedRotationFlag = def.fixedRotation;
        this.m_activeFlag = def.active;
        this.m_islandFlag = false;
        this.m_toiFlag = false;
        this.m_userData = def.userData;
        this.m_type = def.type;
        if (this.m_type == DYNAMIC) {
          this.m_mass = 1;
          this.m_invMass = 1;
        } else {
          this.m_mass = 0;
          this.m_invMass = 0;
        }
        this.m_I = 0;
        this.m_invI = 0;
        this.m_xf = Transform.identity();
        this.m_xf.p.setVec2(def.position);
        this.m_xf.q.setAngle(def.angle);
        this.m_sweep = new Sweep();
        this.m_sweep.setTransform(this.m_xf);
        this.c_velocity = new Velocity();
        this.c_position = new Position();
        this.m_force = Vec2.zero();
        this.m_torque = 0;
        this.m_linearVelocity = Vec2.clone(def.linearVelocity);
        this.m_angularVelocity = def.angularVelocity;
        this.m_linearDamping = def.linearDamping;
        this.m_angularDamping = def.angularDamping;
        this.m_gravityScale = def.gravityScale;
        this.m_sleepTime = 0;
        this.m_jointList = null;
        this.m_contactList = null;
        this.m_fixtureList = null;
        this.m_prev = null;
        this.m_next = null;
        this.m_destroyed = false;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Body2.prototype._serialize = function() {
        var fixtures = [];
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          fixtures.push(f);
        }
        return {
          type: this.m_type,
          bullet: this.m_bulletFlag,
          position: this.m_xf.p,
          angle: this.m_xf.q.getAngle(),
          linearVelocity: this.m_linearVelocity,
          angularVelocity: this.m_angularVelocity,
          fixtures
        };
      };
      Body2._deserialize = function(data, world, restore) {
        var body = new Body2(world, data);
        if (data.fixtures) {
          for (var i = data.fixtures.length - 1; i >= 0; i--) {
            var fixture = restore(Fixture, data.fixtures[i], body);
            body._addFixture(fixture);
          }
        }
        return body;
      };
      Body2.prototype.isWorldLocked = function() {
        return this.m_world && this.m_world.isLocked() ? true : false;
      };
      Body2.prototype.getWorld = function() {
        return this.m_world;
      };
      Body2.prototype.getNext = function() {
        return this.m_next;
      };
      Body2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Body2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Body2.prototype.getFixtureList = function() {
        return this.m_fixtureList;
      };
      Body2.prototype.getJointList = function() {
        return this.m_jointList;
      };
      Body2.prototype.getContactList = function() {
        return this.m_contactList;
      };
      Body2.prototype.isStatic = function() {
        return this.m_type == STATIC;
      };
      Body2.prototype.isDynamic = function() {
        return this.m_type == DYNAMIC;
      };
      Body2.prototype.isKinematic = function() {
        return this.m_type == KINEMATIC;
      };
      Body2.prototype.setStatic = function() {
        this.setType(STATIC);
        return this;
      };
      Body2.prototype.setDynamic = function() {
        this.setType(DYNAMIC);
        return this;
      };
      Body2.prototype.setKinematic = function() {
        this.setType(KINEMATIC);
        return this;
      };
      Body2.prototype.getType = function() {
        return this.m_type;
      };
      Body2.prototype.setType = function(type) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_type == type) {
          return;
        }
        this.m_type = type;
        this.resetMassData();
        if (this.m_type == STATIC) {
          this.m_linearVelocity.setZero();
          this.m_angularVelocity = 0;
          this.m_sweep.forward();
          this.synchronizeFixtures();
        }
        this.setAwake(true);
        this.m_force.setZero();
        this.m_torque = 0;
        var ce = this.m_contactList;
        while (ce) {
          var ce0 = ce;
          ce = ce.next;
          this.m_world.destroyContact(ce0.contact);
        }
        this.m_contactList = null;
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          for (var i = 0; i < f.m_proxyCount; ++i) {
            broadPhase.touchProxy(f.m_proxies[i].proxyId);
          }
        }
      };
      Body2.prototype.isBullet = function() {
        return this.m_bulletFlag;
      };
      Body2.prototype.setBullet = function(flag) {
        this.m_bulletFlag = !!flag;
      };
      Body2.prototype.isSleepingAllowed = function() {
        return this.m_autoSleepFlag;
      };
      Body2.prototype.setSleepingAllowed = function(flag) {
        this.m_autoSleepFlag = !!flag;
        if (this.m_autoSleepFlag == false) {
          this.setAwake(true);
        }
      };
      Body2.prototype.isAwake = function() {
        return this.m_awakeFlag;
      };
      Body2.prototype.setAwake = function(flag) {
        if (flag) {
          this.m_awakeFlag = true;
          this.m_sleepTime = 0;
        } else {
          this.m_awakeFlag = false;
          this.m_sleepTime = 0;
          this.m_linearVelocity.setZero();
          this.m_angularVelocity = 0;
          this.m_force.setZero();
          this.m_torque = 0;
        }
      };
      Body2.prototype.isActive = function() {
        return this.m_activeFlag;
      };
      Body2.prototype.setActive = function(flag) {
        if (flag == this.m_activeFlag) {
          return;
        }
        this.m_activeFlag = !!flag;
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          for (var f = this.m_fixtureList; f; f = f.m_next) {
            f.createProxies(broadPhase, this.m_xf);
          }
          this.m_world.m_newFixture = true;
        } else {
          var broadPhase = this.m_world.m_broadPhase;
          for (var f = this.m_fixtureList; f; f = f.m_next) {
            f.destroyProxies(broadPhase);
          }
          var ce = this.m_contactList;
          while (ce) {
            var ce0 = ce;
            ce = ce.next;
            this.m_world.destroyContact(ce0.contact);
          }
          this.m_contactList = null;
        }
      };
      Body2.prototype.isFixedRotation = function() {
        return this.m_fixedRotationFlag;
      };
      Body2.prototype.setFixedRotation = function(flag) {
        if (this.m_fixedRotationFlag == flag) {
          return;
        }
        this.m_fixedRotationFlag = !!flag;
        this.m_angularVelocity = 0;
        this.resetMassData();
      };
      Body2.prototype.getTransform = function() {
        return this.m_xf;
      };
      Body2.prototype.setTransform = function(a2, b2) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (typeof b2 === "number") {
          this.m_xf.setNum(a2, b2);
        } else {
          this.m_xf.setTransform(a2);
        }
        this.m_sweep.setTransform(this.m_xf);
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          f.synchronize(broadPhase, this.m_xf, this.m_xf);
        }
        this.setAwake(true);
      };
      Body2.prototype.synchronizeTransform = function() {
        this.m_sweep.getTransform(this.m_xf, 1);
      };
      Body2.prototype.synchronizeFixtures = function() {
        this.m_sweep.getTransform(xf$2, 0);
        var broadPhase = this.m_world.m_broadPhase;
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          f.synchronize(broadPhase, xf$2, this.m_xf);
        }
      };
      Body2.prototype.advance = function(alpha) {
        this.m_sweep.advance(alpha);
        copyVec2(this.m_sweep.c, this.m_sweep.c0);
        this.m_sweep.a = this.m_sweep.a0;
        this.m_sweep.getTransform(this.m_xf, 1);
      };
      Body2.prototype.getPosition = function() {
        return this.m_xf.p;
      };
      Body2.prototype.setPosition = function(p) {
        this.setTransform(p, this.m_sweep.a);
      };
      Body2.prototype.getAngle = function() {
        return this.m_sweep.a;
      };
      Body2.prototype.setAngle = function(angle) {
        this.setTransform(this.m_xf.p, angle);
      };
      Body2.prototype.getWorldCenter = function() {
        return this.m_sweep.c;
      };
      Body2.prototype.getLocalCenter = function() {
        return this.m_sweep.localCenter;
      };
      Body2.prototype.getLinearVelocity = function() {
        return this.m_linearVelocity;
      };
      Body2.prototype.getLinearVelocityFromWorldPoint = function(worldPoint) {
        var localCenter2 = Vec2.sub(worldPoint, this.m_sweep.c);
        return Vec2.add(this.m_linearVelocity, Vec2.crossNumVec2(this.m_angularVelocity, localCenter2));
      };
      Body2.prototype.getLinearVelocityFromLocalPoint = function(localPoint) {
        return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(localPoint));
      };
      Body2.prototype.setLinearVelocity = function(v3) {
        if (this.m_type == STATIC) {
          return;
        }
        if (Vec2.dot(v3, v3) > 0) {
          this.setAwake(true);
        }
        this.m_linearVelocity.setVec2(v3);
      };
      Body2.prototype.getAngularVelocity = function() {
        return this.m_angularVelocity;
      };
      Body2.prototype.setAngularVelocity = function(w) {
        if (this.m_type == STATIC) {
          return;
        }
        if (w * w > 0) {
          this.setAwake(true);
        }
        this.m_angularVelocity = w;
      };
      Body2.prototype.getLinearDamping = function() {
        return this.m_linearDamping;
      };
      Body2.prototype.setLinearDamping = function(linearDamping) {
        this.m_linearDamping = linearDamping;
      };
      Body2.prototype.getAngularDamping = function() {
        return this.m_angularDamping;
      };
      Body2.prototype.setAngularDamping = function(angularDamping) {
        this.m_angularDamping = angularDamping;
      };
      Body2.prototype.getGravityScale = function() {
        return this.m_gravityScale;
      };
      Body2.prototype.setGravityScale = function(scale) {
        this.m_gravityScale = scale;
      };
      Body2.prototype.getMass = function() {
        return this.m_mass;
      };
      Body2.prototype.getInertia = function() {
        return this.m_I + this.m_mass * Vec2.dot(this.m_sweep.localCenter, this.m_sweep.localCenter);
      };
      Body2.prototype.getMassData = function(data) {
        data.mass = this.m_mass;
        data.I = this.getInertia();
        copyVec2(data.center, this.m_sweep.localCenter);
      };
      Body2.prototype.resetMassData = function() {
        this.m_mass = 0;
        this.m_invMass = 0;
        this.m_I = 0;
        this.m_invI = 0;
        zeroVec2(this.m_sweep.localCenter);
        if (this.isStatic() || this.isKinematic()) {
          copyVec2(this.m_sweep.c0, this.m_xf.p);
          copyVec2(this.m_sweep.c, this.m_xf.p);
          this.m_sweep.a0 = this.m_sweep.a;
          return;
        }
        zeroVec2(localCenter);
        for (var f = this.m_fixtureList; f; f = f.m_next) {
          if (f.m_density == 0) {
            continue;
          }
          var massData = {
            mass: 0,
            center: vec2(0, 0),
            I: 0
          };
          f.getMassData(massData);
          this.m_mass += massData.mass;
          plusScaleVec2(localCenter, massData.mass, massData.center);
          this.m_I += massData.I;
        }
        if (this.m_mass > 0) {
          this.m_invMass = 1 / this.m_mass;
          scaleVec2(localCenter, this.m_invMass, localCenter);
        } else {
          this.m_mass = 1;
          this.m_invMass = 1;
        }
        if (this.m_I > 0 && this.m_fixedRotationFlag == false) {
          this.m_I -= this.m_mass * dotVec2(localCenter, localCenter);
          this.m_invI = 1 / this.m_I;
        } else {
          this.m_I = 0;
          this.m_invI = 0;
        }
        copyVec2(oldCenter, this.m_sweep.c);
        this.m_sweep.setLocalCenter(localCenter, this.m_xf);
        subVec2(shift, this.m_sweep.c, oldCenter);
        crossNumVec2(temp$6, this.m_angularVelocity, shift);
        plusVec2(this.m_linearVelocity, temp$6);
      };
      Body2.prototype.setMassData = function(massData) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        this.m_invMass = 0;
        this.m_I = 0;
        this.m_invI = 0;
        this.m_mass = massData.mass;
        if (this.m_mass <= 0) {
          this.m_mass = 1;
        }
        this.m_invMass = 1 / this.m_mass;
        if (massData.I > 0 && this.m_fixedRotationFlag == false) {
          this.m_I = massData.I - this.m_mass * dotVec2(massData.center, massData.center);
          this.m_invI = 1 / this.m_I;
        }
        copyVec2(oldCenter, this.m_sweep.c);
        this.m_sweep.setLocalCenter(massData.center, this.m_xf);
        subVec2(shift, this.m_sweep.c, oldCenter);
        crossNumVec2(temp$6, this.m_angularVelocity, shift);
        plusVec2(this.m_linearVelocity, temp$6);
      };
      Body2.prototype.applyForce = function(force, point2, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_force.add(force);
          this.m_torque += Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), force);
        }
      };
      Body2.prototype.applyForceToCenter = function(force, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_force.add(force);
        }
      };
      Body2.prototype.applyTorque = function(torque, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_torque += torque;
        }
      };
      Body2.prototype.applyLinearImpulse = function(impulse, point2, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_linearVelocity.addMul(this.m_invMass, impulse);
          this.m_angularVelocity += this.m_invI * Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), impulse);
        }
      };
      Body2.prototype.applyAngularImpulse = function(impulse, wake) {
        if (wake === void 0) {
          wake = true;
        }
        if (this.m_type != DYNAMIC) {
          return;
        }
        if (wake && this.m_awakeFlag == false) {
          this.setAwake(true);
        }
        if (this.m_awakeFlag) {
          this.m_angularVelocity += this.m_invI * impulse;
        }
      };
      Body2.prototype.shouldCollide = function(that) {
        if (this.m_type != DYNAMIC && that.m_type != DYNAMIC) {
          return false;
        }
        for (var jn = this.m_jointList; jn; jn = jn.next) {
          if (jn.other == that) {
            if (jn.joint.m_collideConnected == false) {
              return false;
            }
          }
        }
        return true;
      };
      Body2.prototype._addFixture = function(fixture) {
        if (this.isWorldLocked() == true) {
          return null;
        }
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          fixture.createProxies(broadPhase, this.m_xf);
        }
        fixture.m_next = this.m_fixtureList;
        this.m_fixtureList = fixture;
        if (fixture.m_density > 0) {
          this.resetMassData();
        }
        this.m_world.m_newFixture = true;
        return fixture;
      };
      Body2.prototype.createFixture = function(shape, fixdef) {
        if (this.isWorldLocked() == true) {
          return null;
        }
        var fixture = new Fixture(this, shape, fixdef);
        this._addFixture(fixture);
        return fixture;
      };
      Body2.prototype.destroyFixture = function(fixture) {
        if (this.isWorldLocked() == true) {
          return;
        }
        if (this.m_fixtureList === fixture) {
          this.m_fixtureList = fixture.m_next;
        } else {
          var node = this.m_fixtureList;
          while (node != null) {
            if (node.m_next === fixture) {
              node.m_next = fixture.m_next;
              break;
            }
            node = node.m_next;
          }
        }
        var edge = this.m_contactList;
        while (edge) {
          var c2 = edge.contact;
          edge = edge.next;
          var fixtureA = c2.getFixtureA();
          var fixtureB = c2.getFixtureB();
          if (fixture == fixtureA || fixture == fixtureB) {
            this.m_world.destroyContact(c2);
          }
        }
        if (this.m_activeFlag) {
          var broadPhase = this.m_world.m_broadPhase;
          fixture.destroyProxies(broadPhase);
        }
        fixture.m_body = null;
        fixture.m_next = null;
        this.m_world.publish("remove-fixture", fixture);
        this.resetMassData();
      };
      Body2.prototype.getWorldPoint = function(localPoint) {
        return Transform.mulVec2(this.m_xf, localPoint);
      };
      Body2.prototype.getWorldVector = function(localVector) {
        return Rot.mulVec2(this.m_xf.q, localVector);
      };
      Body2.prototype.getLocalPoint = function(worldPoint) {
        return Transform.mulTVec2(this.m_xf, worldPoint);
      };
      Body2.prototype.getLocalVector = function(worldVector) {
        return Rot.mulTVec2(this.m_xf.q, worldVector);
      };
      Body2.STATIC = "static";
      Body2.KINEMATIC = "kinematic";
      Body2.DYNAMIC = "dynamic";
      return Body2;
    }()
  );
  var JointEdge = (
    /** @class */
    /* @__PURE__ */ function() {
      function JointEdge2() {
        this.other = null;
        this.joint = null;
        this.prev = null;
        this.next = null;
      }
      return JointEdge2;
    }()
  );
  var Joint = (
    /** @class */
    function() {
      function Joint2(def, bodyA, bodyB) {
        this.m_type = "unknown-joint";
        this.m_prev = null;
        this.m_next = null;
        this.m_edgeA = new JointEdge();
        this.m_edgeB = new JointEdge();
        this.m_islandFlag = false;
        this.style = {};
        this.appData = {};
        bodyA = "bodyA" in def ? def.bodyA : bodyA;
        bodyB = "bodyB" in def ? def.bodyB : bodyB;
        this.m_bodyA = bodyA;
        this.m_bodyB = bodyB;
        this.m_collideConnected = !!def.collideConnected;
        this.m_userData = def.userData;
        if (typeof def.style === "object" && def.style !== null) {
          this.style = def.style;
        }
      }
      Joint2.prototype.isActive = function() {
        return this.m_bodyA.isActive() && this.m_bodyB.isActive();
      };
      Joint2.prototype.getType = function() {
        return this.m_type;
      };
      Joint2.prototype.getBodyA = function() {
        return this.m_bodyA;
      };
      Joint2.prototype.getBodyB = function() {
        return this.m_bodyB;
      };
      Joint2.prototype.getNext = function() {
        return this.m_next;
      };
      Joint2.prototype.getUserData = function() {
        return this.m_userData;
      };
      Joint2.prototype.setUserData = function(data) {
        this.m_userData = data;
      };
      Joint2.prototype.getCollideConnected = function() {
        return this.m_collideConnected;
      };
      Joint2.prototype.shiftOrigin = function(newOrigin) {
      };
      Joint2.prototype._resetAnchors = function(def) {
        return this._reset(def);
      };
      return Joint2;
    }()
  );
  var stats = {
    gjkCalls: 0,
    gjkIters: 0,
    gjkMaxIters: 0,
    toiTime: 0,
    toiMaxTime: 0,
    toiCalls: 0,
    toiIters: 0,
    toiMaxIters: 0,
    toiRootIters: 0,
    toiMaxRootIters: 0,
    toString: function(newline) {
      newline = typeof newline === "string" ? newline : "\n";
      var string = "";
      for (var name_1 in this) {
        if (typeof this[name_1] !== "function" && typeof this[name_1] !== "object") {
          string += name_1 + ": " + this[name_1] + newline;
        }
      }
      return string;
    }
  };
  var now = function() {
    return Date.now();
  };
  var diff = function(time) {
    return Date.now() - time;
  };
  const Timer = {
    now,
    diff
  };
  var math_max$4 = Math.max;
  var temp$5 = vec2(0, 0);
  var normal$4 = vec2(0, 0);
  var e12 = vec2(0, 0);
  var e13 = vec2(0, 0);
  var e23 = vec2(0, 0);
  var temp1 = vec2(0, 0);
  var temp2 = vec2(0, 0);
  stats.gjkCalls = 0;
  stats.gjkIters = 0;
  stats.gjkMaxIters = 0;
  var DistanceInput = (
    /** @class */
    function() {
      function DistanceInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.transformA = Transform.identity();
        this.transformB = Transform.identity();
        this.useRadii = false;
      }
      DistanceInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.transformA.setIdentity();
        this.transformB.setIdentity();
        this.useRadii = false;
      };
      return DistanceInput2;
    }()
  );
  var DistanceOutput = (
    /** @class */
    function() {
      function DistanceOutput2() {
        this.pointA = vec2(0, 0);
        this.pointB = vec2(0, 0);
        this.distance = 0;
        this.iterations = 0;
      }
      DistanceOutput2.prototype.recycle = function() {
        zeroVec2(this.pointA);
        zeroVec2(this.pointB);
        this.distance = 0;
        this.iterations = 0;
      };
      return DistanceOutput2;
    }()
  );
  var SimplexCache = (
    /** @class */
    function() {
      function SimplexCache2() {
        this.metric = 0;
        this.indexA = [];
        this.indexB = [];
        this.count = 0;
      }
      SimplexCache2.prototype.recycle = function() {
        this.metric = 0;
        this.indexA.length = 0;
        this.indexB.length = 0;
        this.count = 0;
      };
      return SimplexCache2;
    }()
  );
  var Distance = function(output2, cache2, input2) {
    ++stats.gjkCalls;
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var xfA2 = input2.transformA;
    var xfB2 = input2.transformB;
    simplex.recycle();
    simplex.readCache(cache2, proxyA, xfA2, proxyB, xfB2);
    var vertices = simplex.m_v;
    var k_maxIters = SettingsInternal.maxDistanceIterations;
    var saveA = [];
    var saveB = [];
    var saveCount = 0;
    var iter = 0;
    while (iter < k_maxIters) {
      saveCount = simplex.m_count;
      for (var i = 0; i < saveCount; ++i) {
        saveA[i] = vertices[i].indexA;
        saveB[i] = vertices[i].indexB;
      }
      simplex.solve();
      if (simplex.m_count === 3) {
        break;
      }
      var d2 = simplex.getSearchDirection();
      if (lengthSqrVec2(d2) < EPSILON * EPSILON) {
        break;
      }
      var vertex = vertices[simplex.m_count];
      vertex.indexA = proxyA.getSupport(derotVec2(temp$5, xfA2.q, scaleVec2(temp$5, -1, d2)));
      transformVec2(vertex.wA, xfA2, proxyA.getVertex(vertex.indexA));
      vertex.indexB = proxyB.getSupport(derotVec2(temp$5, xfB2.q, d2));
      transformVec2(vertex.wB, xfB2, proxyB.getVertex(vertex.indexB));
      subVec2(vertex.w, vertex.wB, vertex.wA);
      ++iter;
      ++stats.gjkIters;
      var duplicate = false;
      for (var i = 0; i < saveCount; ++i) {
        if (vertex.indexA === saveA[i] && vertex.indexB === saveB[i]) {
          duplicate = true;
          break;
        }
      }
      if (duplicate) {
        break;
      }
      ++simplex.m_count;
    }
    stats.gjkMaxIters = math_max$4(stats.gjkMaxIters, iter);
    simplex.getWitnessPoints(output2.pointA, output2.pointB);
    output2.distance = distVec2(output2.pointA, output2.pointB);
    output2.iterations = iter;
    simplex.writeCache(cache2);
    if (input2.useRadii) {
      var rA2 = proxyA.m_radius;
      var rB2 = proxyB.m_radius;
      if (output2.distance > rA2 + rB2 && output2.distance > EPSILON) {
        output2.distance -= rA2 + rB2;
        subVec2(normal$4, output2.pointB, output2.pointA);
        normalizeVec2(normal$4);
        plusScaleVec2(output2.pointA, rA2, normal$4);
        minusScaleVec2(output2.pointB, rB2, normal$4);
      } else {
        var p = subVec2(temp$5, output2.pointA, output2.pointB);
        copyVec2(output2.pointA, p);
        copyVec2(output2.pointB, p);
        output2.distance = 0;
      }
    }
  };
  var DistanceProxy = (
    /** @class */
    function() {
      function DistanceProxy2() {
        this.m_vertices = [];
        this.m_count = 0;
        this.m_radius = 0;
      }
      DistanceProxy2.prototype.recycle = function() {
        this.m_vertices.length = 0;
        this.m_count = 0;
        this.m_radius = 0;
      };
      DistanceProxy2.prototype.getVertexCount = function() {
        return this.m_count;
      };
      DistanceProxy2.prototype.getVertex = function(index) {
        return this.m_vertices[index];
      };
      DistanceProxy2.prototype.getSupport = function(d2) {
        var bestIndex = -1;
        var bestValue = -Infinity;
        for (var i = 0; i < this.m_count; ++i) {
          var value = dotVec2(this.m_vertices[i], d2);
          if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
          }
        }
        return bestIndex;
      };
      DistanceProxy2.prototype.getSupportVertex = function(d2) {
        return this.m_vertices[this.getSupport(d2)];
      };
      DistanceProxy2.prototype.set = function(shape, index) {
        shape.computeDistanceProxy(this, index);
      };
      DistanceProxy2.prototype.setVertices = function(vertices, count, radius) {
        this.m_vertices = vertices;
        this.m_count = count;
        this.m_radius = radius;
      };
      return DistanceProxy2;
    }()
  );
  var SimplexVertex = (
    /** @class */
    function() {
      function SimplexVertex2() {
        this.wA = vec2(0, 0);
        this.indexA = 0;
        this.wB = vec2(0, 0);
        this.indexB = 0;
        this.w = vec2(0, 0);
        this.a = 0;
      }
      SimplexVertex2.prototype.recycle = function() {
        this.indexA = 0;
        this.indexB = 0;
        zeroVec2(this.wA);
        zeroVec2(this.wB);
        zeroVec2(this.w);
        this.a = 0;
      };
      SimplexVertex2.prototype.set = function(v3) {
        this.indexA = v3.indexA;
        this.indexB = v3.indexB;
        copyVec2(this.wA, v3.wA);
        copyVec2(this.wB, v3.wB);
        copyVec2(this.w, v3.w);
        this.a = v3.a;
      };
      return SimplexVertex2;
    }()
  );
  var searchDirection_reuse = vec2(0, 0);
  var closestPoint_reuse = vec2(0, 0);
  var Simplex = (
    /** @class */
    function() {
      function Simplex2() {
        this.m_v1 = new SimplexVertex();
        this.m_v2 = new SimplexVertex();
        this.m_v3 = new SimplexVertex();
        this.m_v = [this.m_v1, this.m_v2, this.m_v3];
      }
      Simplex2.prototype.recycle = function() {
        this.m_v1.recycle();
        this.m_v2.recycle();
        this.m_v3.recycle();
        this.m_count = 0;
      };
      Simplex2.prototype.toString = function() {
        if (this.m_count === 3) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y,
            this.m_v2.a,
            this.m_v2.wA.x,
            this.m_v2.wA.y,
            this.m_v2.wB.x,
            this.m_v2.wB.y,
            this.m_v3.a,
            this.m_v3.wA.x,
            this.m_v3.wA.y,
            this.m_v3.wB.x,
            this.m_v3.wB.y
          ].toString();
        } else if (this.m_count === 2) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y,
            this.m_v2.a,
            this.m_v2.wA.x,
            this.m_v2.wA.y,
            this.m_v2.wB.x,
            this.m_v2.wB.y
          ].toString();
        } else if (this.m_count === 1) {
          return [
            "+" + this.m_count,
            this.m_v1.a,
            this.m_v1.wA.x,
            this.m_v1.wA.y,
            this.m_v1.wB.x,
            this.m_v1.wB.y
          ].toString();
        } else {
          return "+" + this.m_count;
        }
      };
      Simplex2.prototype.readCache = function(cache2, proxyA, transformA, proxyB, transformB) {
        this.m_count = cache2.count;
        for (var i = 0; i < this.m_count; ++i) {
          var v3 = this.m_v[i];
          v3.indexA = cache2.indexA[i];
          v3.indexB = cache2.indexB[i];
          var wALocal = proxyA.getVertex(v3.indexA);
          var wBLocal = proxyB.getVertex(v3.indexB);
          transformVec2(v3.wA, transformA, wALocal);
          transformVec2(v3.wB, transformB, wBLocal);
          subVec2(v3.w, v3.wB, v3.wA);
          v3.a = 0;
        }
        if (this.m_count > 1) {
          var metric1 = cache2.metric;
          var metric2 = this.getMetric();
          if (metric2 < 0.5 * metric1 || 2 * metric1 < metric2 || metric2 < EPSILON) {
            this.m_count = 0;
          }
        }
        if (this.m_count === 0) {
          var v3 = this.m_v[0];
          v3.indexA = 0;
          v3.indexB = 0;
          var wALocal = proxyA.getVertex(0);
          var wBLocal = proxyB.getVertex(0);
          transformVec2(v3.wA, transformA, wALocal);
          transformVec2(v3.wB, transformB, wBLocal);
          subVec2(v3.w, v3.wB, v3.wA);
          v3.a = 1;
          this.m_count = 1;
        }
      };
      Simplex2.prototype.writeCache = function(cache2) {
        cache2.metric = this.getMetric();
        cache2.count = this.m_count;
        for (var i = 0; i < this.m_count; ++i) {
          cache2.indexA[i] = this.m_v[i].indexA;
          cache2.indexB[i] = this.m_v[i].indexB;
        }
      };
      Simplex2.prototype.getSearchDirection = function() {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        switch (this.m_count) {
          case 1:
            return setVec2(searchDirection_reuse, -v13.w.x, -v13.w.y);
          case 2: {
            subVec2(e12, v22.w, v13.w);
            var sgn = -crossVec2Vec2(e12, v13.w);
            if (sgn > 0) {
              return setVec2(searchDirection_reuse, -e12.y, e12.x);
            } else {
              return setVec2(searchDirection_reuse, e12.y, -e12.x);
            }
          }
          default:
            return zeroVec2(searchDirection_reuse);
        }
      };
      Simplex2.prototype.getClosestPoint = function() {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        switch (this.m_count) {
          case 0:
            return zeroVec2(closestPoint_reuse);
          case 1:
            return copyVec2(closestPoint_reuse, v13.w);
          case 2:
            return combine2Vec2(closestPoint_reuse, v13.a, v13.w, v22.a, v22.w);
          case 3:
            return zeroVec2(closestPoint_reuse);
          default:
            return zeroVec2(closestPoint_reuse);
        }
      };
      Simplex2.prototype.getWitnessPoints = function(pA2, pB2) {
        var v13 = this.m_v1;
        var v22 = this.m_v2;
        var v3 = this.m_v3;
        switch (this.m_count) {
          case 0:
            break;
          case 1:
            copyVec2(pA2, v13.wA);
            copyVec2(pB2, v13.wB);
            break;
          case 2:
            combine2Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA);
            combine2Vec2(pB2, v13.a, v13.wB, v22.a, v22.wB);
            break;
          case 3:
            combine3Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA, v3.a, v3.wA);
            copyVec2(pB2, pA2);
            break;
        }
      };
      Simplex2.prototype.getMetric = function() {
        switch (this.m_count) {
          case 0:
            return 0;
          case 1:
            return 0;
          case 2:
            return distVec2(this.m_v1.w, this.m_v2.w);
          case 3:
            return crossVec2Vec2(subVec2(temp1, this.m_v2.w, this.m_v1.w), subVec2(temp2, this.m_v3.w, this.m_v1.w));
          default:
            return 0;
        }
      };
      Simplex2.prototype.solve = function() {
        switch (this.m_count) {
          case 1:
            break;
          case 2:
            this.solve2();
            break;
          case 3:
            this.solve3();
            break;
        }
      };
      Simplex2.prototype.solve2 = function() {
        var w1 = this.m_v1.w;
        var w2 = this.m_v2.w;
        subVec2(e12, w2, w1);
        var d12_2 = -dotVec2(w1, e12);
        if (d12_2 <= 0) {
          this.m_v1.a = 1;
          this.m_count = 1;
          return;
        }
        var d12_1 = dotVec2(w2, e12);
        if (d12_1 <= 0) {
          this.m_v2.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v2);
          return;
        }
        var inv_d12 = 1 / (d12_1 + d12_2);
        this.m_v1.a = d12_1 * inv_d12;
        this.m_v2.a = d12_2 * inv_d12;
        this.m_count = 2;
      };
      Simplex2.prototype.solve3 = function() {
        var w1 = this.m_v1.w;
        var w2 = this.m_v2.w;
        var w3 = this.m_v3.w;
        subVec2(e12, w2, w1);
        var w1e12 = dotVec2(w1, e12);
        var w2e12 = dotVec2(w2, e12);
        var d12_1 = w2e12;
        var d12_2 = -w1e12;
        subVec2(e13, w3, w1);
        var w1e13 = dotVec2(w1, e13);
        var w3e13 = dotVec2(w3, e13);
        var d13_1 = w3e13;
        var d13_2 = -w1e13;
        subVec2(e23, w3, w2);
        var w2e23 = dotVec2(w2, e23);
        var w3e23 = dotVec2(w3, e23);
        var d23_1 = w3e23;
        var d23_2 = -w2e23;
        var n123 = crossVec2Vec2(e12, e13);
        var d123_1 = n123 * crossVec2Vec2(w2, w3);
        var d123_2 = n123 * crossVec2Vec2(w3, w1);
        var d123_3 = n123 * crossVec2Vec2(w1, w2);
        if (d12_2 <= 0 && d13_2 <= 0) {
          this.m_v1.a = 1;
          this.m_count = 1;
          return;
        }
        if (d12_1 > 0 && d12_2 > 0 && d123_3 <= 0) {
          var inv_d12 = 1 / (d12_1 + d12_2);
          this.m_v1.a = d12_1 * inv_d12;
          this.m_v2.a = d12_2 * inv_d12;
          this.m_count = 2;
          return;
        }
        if (d13_1 > 0 && d13_2 > 0 && d123_2 <= 0) {
          var inv_d13 = 1 / (d13_1 + d13_2);
          this.m_v1.a = d13_1 * inv_d13;
          this.m_v3.a = d13_2 * inv_d13;
          this.m_count = 2;
          this.m_v2.set(this.m_v3);
          return;
        }
        if (d12_1 <= 0 && d23_2 <= 0) {
          this.m_v2.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v2);
          return;
        }
        if (d13_1 <= 0 && d23_1 <= 0) {
          this.m_v3.a = 1;
          this.m_count = 1;
          this.m_v1.set(this.m_v3);
          return;
        }
        if (d23_1 > 0 && d23_2 > 0 && d123_1 <= 0) {
          var inv_d23 = 1 / (d23_1 + d23_2);
          this.m_v2.a = d23_1 * inv_d23;
          this.m_v3.a = d23_2 * inv_d23;
          this.m_count = 2;
          this.m_v1.set(this.m_v3);
          return;
        }
        var inv_d123 = 1 / (d123_1 + d123_2 + d123_3);
        this.m_v1.a = d123_1 * inv_d123;
        this.m_v2.a = d123_2 * inv_d123;
        this.m_v3.a = d123_3 * inv_d123;
        this.m_count = 3;
      };
      return Simplex2;
    }()
  );
  var simplex = new Simplex();
  var input$1 = new DistanceInput();
  var cache$1 = new SimplexCache();
  var output$1 = new DistanceOutput();
  var testOverlap = function(shapeA, indexA, shapeB, indexB, xfA2, xfB2) {
    input$1.recycle();
    input$1.proxyA.set(shapeA, indexA);
    input$1.proxyB.set(shapeB, indexB);
    copyTransform(input$1.transformA, xfA2);
    copyTransform(input$1.transformB, xfB2);
    input$1.useRadii = true;
    output$1.recycle();
    cache$1.recycle();
    Distance(output$1, cache$1, input$1);
    return output$1.distance < 10 * EPSILON;
  };
  Distance.testOverlap = testOverlap;
  Distance.Input = DistanceInput;
  Distance.Output = DistanceOutput;
  Distance.Proxy = DistanceProxy;
  Distance.Cache = SimplexCache;
  var ShapeCastInput = (
    /** @class */
    function() {
      function ShapeCastInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.transformA = Transform.identity();
        this.transformB = Transform.identity();
        this.translationB = Vec2.zero();
      }
      ShapeCastInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.transformA.setIdentity();
        this.transformB.setIdentity();
        zeroVec2(this.translationB);
      };
      return ShapeCastInput2;
    }()
  );
  var ShapeCastOutput = (
    /** @class */
    /* @__PURE__ */ function() {
      function ShapeCastOutput2() {
        this.point = Vec2.zero();
        this.normal = Vec2.zero();
        this.lambda = 1;
        this.iterations = 0;
      }
      return ShapeCastOutput2;
    }()
  );
  var ShapeCast = function(output2, input2) {
    output2.iterations = 0;
    output2.lambda = 1;
    output2.normal.setZero();
    output2.point.setZero();
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var radiusA = math_max$4(proxyA.m_radius, SettingsInternal.polygonRadius);
    var radiusB = math_max$4(proxyB.m_radius, SettingsInternal.polygonRadius);
    var radius = radiusA + radiusB;
    var xfA2 = input2.transformA;
    var xfB2 = input2.transformB;
    var r = input2.translationB;
    var n2 = Vec2.zero();
    var lambda = 0;
    var simplex2 = new Simplex();
    simplex2.m_count = 0;
    var vertices = simplex2.m_v;
    var indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(r)));
    var wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));
    var indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, r));
    var wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));
    var v3 = Vec2.sub(wA, wB);
    var sigma = math_max$4(SettingsInternal.polygonRadius, radius - SettingsInternal.polygonRadius);
    var tolerance = 0.5 * SettingsInternal.linearSlop;
    var k_maxIters = 20;
    var iter = 0;
    while (iter < k_maxIters && v3.length() - sigma > tolerance) {
      output2.iterations += 1;
      indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(v3)));
      wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));
      indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, v3));
      wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));
      var p = Vec2.sub(wA, wB);
      v3.normalize();
      var vp = Vec2.dot(v3, p);
      var vr = Vec2.dot(v3, r);
      if (vp - sigma > lambda * vr) {
        if (vr <= 0) {
          return false;
        }
        lambda = (vp - sigma) / vr;
        if (lambda > 1) {
          return false;
        }
        n2.setMul(-1, v3);
        simplex2.m_count = 0;
      }
      var vertex = vertices[simplex2.m_count];
      vertex.indexA = indexB;
      vertex.wA = Vec2.combine(1, wB, lambda, r);
      vertex.indexB = indexA;
      vertex.wB = wA;
      vertex.w = Vec2.sub(vertex.wB, vertex.wA);
      vertex.a = 1;
      simplex2.m_count += 1;
      switch (simplex2.m_count) {
        case 1:
          break;
        case 2:
          simplex2.solve2();
          break;
        case 3:
          simplex2.solve3();
          break;
      }
      if (simplex2.m_count == 3) {
        return false;
      }
      v3.setVec2(simplex2.getClosestPoint());
      ++iter;
    }
    if (iter == 0) {
      return false;
    }
    var pointA2 = Vec2.zero();
    var pointB2 = Vec2.zero();
    simplex2.getWitnessPoints(pointB2, pointA2);
    if (v3.lengthSquared() > 0) {
      n2.setMul(-1, v3);
      n2.normalize();
    }
    output2.point = Vec2.combine(1, pointA2, radiusA, n2);
    output2.normal = n2;
    output2.lambda = lambda;
    output2.iterations = iter;
    return true;
  };
  var math_abs$7 = Math.abs;
  var math_max$3 = Math.max;
  var TOIInput = (
    /** @class */
    function() {
      function TOIInput2() {
        this.proxyA = new DistanceProxy();
        this.proxyB = new DistanceProxy();
        this.sweepA = new Sweep();
        this.sweepB = new Sweep();
      }
      TOIInput2.prototype.recycle = function() {
        this.proxyA.recycle();
        this.proxyB.recycle();
        this.sweepA.recycle();
        this.sweepB.recycle();
        this.tMax = -1;
      };
      return TOIInput2;
    }()
  );
  exports2.TOIOutputState = void 0;
  (function(TOIOutputState2) {
    TOIOutputState2[TOIOutputState2["e_unset"] = -1] = "e_unset";
    TOIOutputState2[TOIOutputState2["e_unknown"] = 0] = "e_unknown";
    TOIOutputState2[TOIOutputState2["e_failed"] = 1] = "e_failed";
    TOIOutputState2[TOIOutputState2["e_overlapped"] = 2] = "e_overlapped";
    TOIOutputState2[TOIOutputState2["e_touching"] = 3] = "e_touching";
    TOIOutputState2[TOIOutputState2["e_separated"] = 4] = "e_separated";
  })(exports2.TOIOutputState || (exports2.TOIOutputState = {}));
  var TOIOutput = (
    /** @class */
    function() {
      function TOIOutput2() {
        this.state = exports2.TOIOutputState.e_unset;
        this.t = -1;
      }
      TOIOutput2.prototype.recycle = function() {
        this.state = exports2.TOIOutputState.e_unset;
        this.t = -1;
      };
      return TOIOutput2;
    }()
  );
  stats.toiTime = 0;
  stats.toiMaxTime = 0;
  stats.toiCalls = 0;
  stats.toiIters = 0;
  stats.toiMaxIters = 0;
  stats.toiRootIters = 0;
  stats.toiMaxRootIters = 0;
  var distanceInput = new DistanceInput();
  var distanceOutput = new DistanceOutput();
  var cache = new SimplexCache();
  var xfA$1 = transform(0, 0, 0);
  var xfB$1 = transform(0, 0, 0);
  var temp$4 = vec2(0, 0);
  var pointA$2 = vec2(0, 0);
  var pointB$2 = vec2(0, 0);
  var normal$3 = vec2(0, 0);
  var axisA = vec2(0, 0);
  var axisB = vec2(0, 0);
  var localPointA = vec2(0, 0);
  var localPointB = vec2(0, 0);
  var TimeOfImpact = function(output2, input2) {
    var timer = Timer.now();
    ++stats.toiCalls;
    output2.state = exports2.TOIOutputState.e_unknown;
    output2.t = input2.tMax;
    var proxyA = input2.proxyA;
    var proxyB = input2.proxyB;
    var sweepA = input2.sweepA;
    var sweepB = input2.sweepB;
    sweepA.normalize();
    sweepB.normalize();
    var tMax = input2.tMax;
    var totalRadius = proxyA.m_radius + proxyB.m_radius;
    var target = math_max$3(SettingsInternal.linearSlop, totalRadius - 3 * SettingsInternal.linearSlop);
    var tolerance = 0.25 * SettingsInternal.linearSlop;
    var t1 = 0;
    var k_maxIterations = SettingsInternal.maxTOIIterations;
    var iter = 0;
    cache.recycle();
    distanceInput.proxyA.setVertices(proxyA.m_vertices, proxyA.m_count, proxyA.m_radius);
    distanceInput.proxyB.setVertices(proxyB.m_vertices, proxyB.m_count, proxyB.m_radius);
    distanceInput.useRadii = false;
    while (true) {
      sweepA.getTransform(xfA$1, t1);
      sweepB.getTransform(xfB$1, t1);
      copyTransform(distanceInput.transformA, xfA$1);
      copyTransform(distanceInput.transformB, xfB$1);
      Distance(distanceOutput, cache, distanceInput);
      if (distanceOutput.distance <= 0) {
        output2.state = exports2.TOIOutputState.e_overlapped;
        output2.t = 0;
        break;
      }
      if (distanceOutput.distance < target + tolerance) {
        output2.state = exports2.TOIOutputState.e_touching;
        output2.t = t1;
        break;
      }
      separationFunction.initialize(cache, proxyA, sweepA, proxyB, sweepB, t1);
      var done = false;
      var t2 = tMax;
      var pushBackIter = 0;
      while (true) {
        var s2 = separationFunction.findMinSeparation(t2);
        if (s2 > target + tolerance) {
          output2.state = exports2.TOIOutputState.e_separated;
          output2.t = tMax;
          done = true;
          break;
        }
        if (s2 > target - tolerance) {
          t1 = t2;
          break;
        }
        var s1 = separationFunction.evaluate(t1);
        if (s1 < target - tolerance) {
          output2.state = exports2.TOIOutputState.e_failed;
          output2.t = t1;
          done = true;
          break;
        }
        if (s1 <= target + tolerance) {
          output2.state = exports2.TOIOutputState.e_touching;
          output2.t = t1;
          done = true;
          break;
        }
        var rootIterCount = 0;
        var a1 = t1;
        var a2 = t2;
        while (true) {
          var t = void 0;
          if (rootIterCount & 1) {
            t = a1 + (target - s1) * (a2 - a1) / (s2 - s1);
          } else {
            t = 0.5 * (a1 + a2);
          }
          ++rootIterCount;
          ++stats.toiRootIters;
          var s3 = separationFunction.evaluate(t);
          if (math_abs$7(s3 - target) < tolerance) {
            t2 = t;
            break;
          }
          if (s3 > target) {
            a1 = t;
            s1 = s3;
          } else {
            a2 = t;
            s2 = s3;
          }
          if (rootIterCount === 50) {
            break;
          }
        }
        stats.toiMaxRootIters = math_max$3(stats.toiMaxRootIters, rootIterCount);
        ++pushBackIter;
        if (pushBackIter === SettingsInternal.maxPolygonVertices) {
          break;
        }
      }
      ++iter;
      ++stats.toiIters;
      if (done) {
        break;
      }
      if (iter === k_maxIterations) {
        output2.state = exports2.TOIOutputState.e_failed;
        output2.t = t1;
        break;
      }
    }
    stats.toiMaxIters = math_max$3(stats.toiMaxIters, iter);
    var time = Timer.diff(timer);
    stats.toiMaxTime = math_max$3(stats.toiMaxTime, time);
    stats.toiTime += time;
    separationFunction.recycle();
  };
  var SeparationFunctionType;
  (function(SeparationFunctionType2) {
    SeparationFunctionType2[SeparationFunctionType2["e_unset"] = -1] = "e_unset";
    SeparationFunctionType2[SeparationFunctionType2["e_points"] = 1] = "e_points";
    SeparationFunctionType2[SeparationFunctionType2["e_faceA"] = 2] = "e_faceA";
    SeparationFunctionType2[SeparationFunctionType2["e_faceB"] = 3] = "e_faceB";
  })(SeparationFunctionType || (SeparationFunctionType = {}));
  var SeparationFunction = (
    /** @class */
    function() {
      function SeparationFunction2() {
        this.m_proxyA = null;
        this.m_proxyB = null;
        this.m_sweepA = null;
        this.m_sweepB = null;
        this.m_type = SeparationFunctionType.e_unset;
        this.m_localPoint = vec2(0, 0);
        this.m_axis = vec2(0, 0);
        this.indexA = -1;
        this.indexB = -1;
      }
      SeparationFunction2.prototype.recycle = function() {
        this.m_proxyA = null;
        this.m_proxyB = null;
        this.m_sweepA = null;
        this.m_sweepB = null;
        this.m_type = SeparationFunctionType.e_unset;
        zeroVec2(this.m_localPoint);
        zeroVec2(this.m_axis);
        this.indexA = -1;
        this.indexB = -1;
      };
      SeparationFunction2.prototype.initialize = function(cache2, proxyA, sweepA, proxyB, sweepB, t1) {
        var count = cache2.count;
        this.m_proxyA = proxyA;
        this.m_proxyB = proxyB;
        this.m_sweepA = sweepA;
        this.m_sweepB = sweepB;
        this.m_sweepA.getTransform(xfA$1, t1);
        this.m_sweepB.getTransform(xfB$1, t1);
        if (count === 1) {
          this.m_type = SeparationFunctionType.e_points;
          var localPointA_1 = this.m_proxyA.getVertex(cache2.indexA[0]);
          var localPointB_1 = this.m_proxyB.getVertex(cache2.indexB[0]);
          transformVec2(pointA$2, xfA$1, localPointA_1);
          transformVec2(pointB$2, xfB$1, localPointB_1);
          subVec2(this.m_axis, pointB$2, pointA$2);
          var s2 = normalizeVec2Length(this.m_axis);
          return s2;
        } else if (cache2.indexA[0] === cache2.indexA[1]) {
          this.m_type = SeparationFunctionType.e_faceB;
          var localPointB1 = proxyB.getVertex(cache2.indexB[0]);
          var localPointB2 = proxyB.getVertex(cache2.indexB[1]);
          crossVec2Num(this.m_axis, subVec2(temp$4, localPointB2, localPointB1), 1);
          normalizeVec2(this.m_axis);
          rotVec2(normal$3, xfB$1.q, this.m_axis);
          combine2Vec2(this.m_localPoint, 0.5, localPointB1, 0.5, localPointB2);
          transformVec2(pointB$2, xfB$1, this.m_localPoint);
          var localPointA_2 = proxyA.getVertex(cache2.indexA[0]);
          var pointA_1 = Transform.mulVec2(xfA$1, localPointA_2);
          var s2 = dotVec2(pointA_1, normal$3) - dotVec2(pointB$2, normal$3);
          if (s2 < 0) {
            negVec2(this.m_axis);
            s2 = -s2;
          }
          return s2;
        } else {
          this.m_type = SeparationFunctionType.e_faceA;
          var localPointA1 = this.m_proxyA.getVertex(cache2.indexA[0]);
          var localPointA2 = this.m_proxyA.getVertex(cache2.indexA[1]);
          crossVec2Num(this.m_axis, subVec2(temp$4, localPointA2, localPointA1), 1);
          normalizeVec2(this.m_axis);
          rotVec2(normal$3, xfA$1.q, this.m_axis);
          combine2Vec2(this.m_localPoint, 0.5, localPointA1, 0.5, localPointA2);
          transformVec2(pointA$2, xfA$1, this.m_localPoint);
          var localPointB_2 = this.m_proxyB.getVertex(cache2.indexB[0]);
          transformVec2(pointB$2, xfB$1, localPointB_2);
          var s2 = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);
          if (s2 < 0) {
            negVec2(this.m_axis);
            s2 = -s2;
          }
          return s2;
        }
      };
      SeparationFunction2.prototype.compute = function(find, t) {
        this.m_sweepA.getTransform(xfA$1, t);
        this.m_sweepB.getTransform(xfB$1, t);
        switch (this.m_type) {
          case SeparationFunctionType.e_points: {
            if (find) {
              derotVec2(axisA, xfA$1.q, this.m_axis);
              derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, this.m_axis));
              this.indexA = this.m_proxyA.getSupport(axisA);
              this.indexB = this.m_proxyB.getSupport(axisB);
            }
            copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));
            copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));
            transformVec2(pointA$2, xfA$1, localPointA);
            transformVec2(pointB$2, xfB$1, localPointB);
            var sep = dotVec2(pointB$2, this.m_axis) - dotVec2(pointA$2, this.m_axis);
            return sep;
          }
          case SeparationFunctionType.e_faceA: {
            rotVec2(normal$3, xfA$1.q, this.m_axis);
            transformVec2(pointA$2, xfA$1, this.m_localPoint);
            if (find) {
              derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, normal$3));
              this.indexA = -1;
              this.indexB = this.m_proxyB.getSupport(axisB);
            }
            copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));
            transformVec2(pointB$2, xfB$1, localPointB);
            var sep = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);
            return sep;
          }
          case SeparationFunctionType.e_faceB: {
            rotVec2(normal$3, xfB$1.q, this.m_axis);
            transformVec2(pointB$2, xfB$1, this.m_localPoint);
            if (find) {
              derotVec2(axisA, xfA$1.q, scaleVec2(temp$4, -1, normal$3));
              this.indexB = -1;
              this.indexA = this.m_proxyA.getSupport(axisA);
            }
            copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));
            transformVec2(pointA$2, xfA$1, localPointA);
            var sep = dotVec2(pointA$2, normal$3) - dotVec2(pointB$2, normal$3);
            return sep;
          }
          default:
            if (find) {
              this.indexA = -1;
              this.indexB = -1;
            }
            return 0;
        }
      };
      SeparationFunction2.prototype.findMinSeparation = function(t) {
        return this.compute(true, t);
      };
      SeparationFunction2.prototype.evaluate = function(t) {
        return this.compute(false, t);
      };
      return SeparationFunction2;
    }()
  );
  var separationFunction = new SeparationFunction();
  TimeOfImpact.Input = TOIInput;
  TimeOfImpact.Output = TOIOutput;
  var math_abs$6 = Math.abs;
  var math_sqrt$3 = Math.sqrt;
  var math_min$5 = Math.min;
  var TimeStep = (
    /** @class */
    function() {
      function TimeStep2() {
        this.dt = 0;
        this.inv_dt = 0;
        this.velocityIterations = 0;
        this.positionIterations = 0;
        this.warmStarting = false;
        this.blockSolve = true;
        this.inv_dt0 = 0;
        this.dtRatio = 1;
      }
      TimeStep2.prototype.reset = function(dt) {
        if (this.dt > 0) {
          this.inv_dt0 = this.inv_dt;
        }
        this.dt = dt;
        this.inv_dt = dt == 0 ? 0 : 1 / dt;
        this.dtRatio = dt * this.inv_dt0;
      };
      return TimeStep2;
    }()
  );
  var s_subStep = new TimeStep();
  var c = vec2(0, 0);
  var v = vec2(0, 0);
  var translation = vec2(0, 0);
  var input = new TOIInput();
  var output = new TOIOutput();
  var backup = new Sweep();
  var backup1 = new Sweep();
  var backup2 = new Sweep();
  var ContactImpulse = (
    /** @class */
    function() {
      function ContactImpulse2(contact) {
        this.contact = contact;
        this.normals = [];
        this.tangents = [];
      }
      ContactImpulse2.prototype.recycle = function() {
        this.normals.length = 0;
        this.tangents.length = 0;
      };
      Object.defineProperty(ContactImpulse2.prototype, "normalImpulses", {
        get: function() {
          var contact = this.contact;
          var normals = this.normals;
          normals.length = 0;
          for (var p = 0; p < contact.v_points.length; ++p) {
            normals.push(contact.v_points[p].normalImpulse);
          }
          return normals;
        },
        enumerable: false,
        configurable: true
      });
      Object.defineProperty(ContactImpulse2.prototype, "tangentImpulses", {
        get: function() {
          var contact = this.contact;
          var tangents = this.tangents;
          tangents.length = 0;
          for (var p = 0; p < contact.v_points.length; ++p) {
            tangents.push(contact.v_points[p].tangentImpulse);
          }
          return tangents;
        },
        enumerable: false,
        configurable: true
      });
      return ContactImpulse2;
    }()
  );
  var Solver = (
    /** @class */
    function() {
      function Solver2(world) {
        this.m_world = world;
        this.m_stack = [];
        this.m_bodies = [];
        this.m_contacts = [];
        this.m_joints = [];
      }
      Solver2.prototype.clear = function() {
        this.m_stack.length = 0;
        this.m_bodies.length = 0;
        this.m_contacts.length = 0;
        this.m_joints.length = 0;
      };
      Solver2.prototype.addBody = function(body) {
        this.m_bodies.push(body);
      };
      Solver2.prototype.addContact = function(contact) {
        this.m_contacts.push(contact);
      };
      Solver2.prototype.addJoint = function(joint) {
        this.m_joints.push(joint);
      };
      Solver2.prototype.solveWorld = function(step) {
        var world = this.m_world;
        for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {
          b2.m_islandFlag = false;
        }
        for (var c_1 = world.m_contactList; c_1; c_1 = c_1.m_next) {
          c_1.m_islandFlag = false;
        }
        for (var j = world.m_jointList; j; j = j.m_next) {
          j.m_islandFlag = false;
        }
        var stack = this.m_stack;
        for (var seed = world.m_bodyList; seed; seed = seed.m_next) {
          if (seed.m_islandFlag) {
            continue;
          }
          if (seed.isAwake() == false || seed.isActive() == false) {
            continue;
          }
          if (seed.isStatic()) {
            continue;
          }
          this.clear();
          stack.push(seed);
          seed.m_islandFlag = true;
          while (stack.length > 0) {
            var b2 = stack.pop();
            this.addBody(b2);
            b2.m_awakeFlag = true;
            if (b2.isStatic()) {
              continue;
            }
            for (var ce = b2.m_contactList; ce; ce = ce.next) {
              var contact = ce.contact;
              if (contact.m_islandFlag) {
                continue;
              }
              if (contact.isEnabled() == false || contact.isTouching() == false) {
                continue;
              }
              var sensorA = contact.m_fixtureA.m_isSensor;
              var sensorB = contact.m_fixtureB.m_isSensor;
              if (sensorA || sensorB) {
                continue;
              }
              this.addContact(contact);
              contact.m_islandFlag = true;
              var other = ce.other;
              if (other.m_islandFlag) {
                continue;
              }
              stack.push(other);
              other.m_islandFlag = true;
            }
            for (var je = b2.m_jointList; je; je = je.next) {
              if (je.joint.m_islandFlag == true) {
                continue;
              }
              var other = je.other;
              if (other.isActive() == false) {
                continue;
              }
              this.addJoint(je.joint);
              je.joint.m_islandFlag = true;
              if (other.m_islandFlag) {
                continue;
              }
              stack.push(other);
              other.m_islandFlag = true;
            }
          }
          this.solveIsland(step);
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var b2 = this.m_bodies[i];
            if (b2.isStatic()) {
              b2.m_islandFlag = false;
            }
          }
        }
      };
      Solver2.prototype.solveIsland = function(step) {
        var world = this.m_world;
        var gravity = world.m_gravity;
        var allowSleep = world.m_allowSleep;
        var h = step.dt;
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.m_sweep.c);
          var a2 = body.m_sweep.a;
          copyVec2(v, body.m_linearVelocity);
          var w = body.m_angularVelocity;
          copyVec2(body.m_sweep.c0, body.m_sweep.c);
          body.m_sweep.a0 = body.m_sweep.a;
          if (body.isDynamic()) {
            plusScaleVec2(v, h * body.m_gravityScale, gravity);
            plusScaleVec2(v, h * body.m_invMass, body.m_force);
            w += h * body.m_invI * body.m_torque;
            scaleVec2(v, 1 / (1 + h * body.m_linearDamping), v);
            w *= 1 / (1 + h * body.m_angularDamping);
          }
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initConstraint(step);
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initVelocityConstraint(step);
        }
        if (step.warmStarting) {
          for (var i = 0; i < this.m_contacts.length; ++i) {
            var contact = this.m_contacts[i];
            contact.warmStartConstraint(step);
          }
        }
        for (var i = 0; i < this.m_joints.length; ++i) {
          var joint = this.m_joints[i];
          joint.initVelocityConstraints(step);
        }
        for (var i = 0; i < step.velocityIterations; ++i) {
          for (var j = 0; j < this.m_joints.length; ++j) {
            var joint = this.m_joints[j];
            joint.solveVelocityConstraints(step);
          }
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            contact.solveVelocityConstraint(step);
          }
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.storeConstraintImpulses(step);
        }
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.c_position.c);
          var a2 = body.c_position.a;
          copyVec2(v, body.c_velocity.v);
          var w = body.c_velocity.w;
          scaleVec2(translation, h, v);
          var translationLengthSqr = lengthSqrVec2(translation);
          if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {
            var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);
            mulVec2(v, ratio);
          }
          var rotation2 = h * w;
          if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {
            var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);
            w *= ratio;
          }
          plusScaleVec2(c, h, v);
          a2 += h * w;
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
        }
        var positionSolved = false;
        for (var i = 0; i < step.positionIterations; ++i) {
          var minSeparation = 0;
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            var separation = contact.solvePositionConstraint(step);
            minSeparation = math_min$5(minSeparation, separation);
          }
          var contactsOkay = minSeparation >= -3 * SettingsInternal.linearSlop;
          var jointsOkay = true;
          for (var j = 0; j < this.m_joints.length; ++j) {
            var joint = this.m_joints[j];
            var jointOkay = joint.solvePositionConstraints(step);
            jointsOkay = jointsOkay && jointOkay;
          }
          if (contactsOkay && jointsOkay) {
            positionSolved = true;
            break;
          }
        }
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(body.m_sweep.c, body.c_position.c);
          body.m_sweep.a = body.c_position.a;
          copyVec2(body.m_linearVelocity, body.c_velocity.v);
          body.m_angularVelocity = body.c_velocity.w;
          body.synchronizeTransform();
        }
        this.postSolveIsland();
        if (allowSleep) {
          var minSleepTime = Infinity;
          var linTolSqr = SettingsInternal.linearSleepToleranceSqr;
          var angTolSqr = SettingsInternal.angularSleepToleranceSqr;
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var body = this.m_bodies[i];
            if (body.isStatic()) {
              continue;
            }
            if (body.m_autoSleepFlag == false || body.m_angularVelocity * body.m_angularVelocity > angTolSqr || lengthSqrVec2(body.m_linearVelocity) > linTolSqr) {
              body.m_sleepTime = 0;
              minSleepTime = 0;
            } else {
              body.m_sleepTime += h;
              minSleepTime = math_min$5(minSleepTime, body.m_sleepTime);
            }
          }
          if (minSleepTime >= SettingsInternal.timeToSleep && positionSolved) {
            for (var i = 0; i < this.m_bodies.length; ++i) {
              var body = this.m_bodies[i];
              body.setAwake(false);
            }
          }
        }
      };
      Solver2.prototype.solveWorldTOI = function(step) {
        var world = this.m_world;
        if (world.m_stepComplete) {
          for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {
            b2.m_islandFlag = false;
            b2.m_sweep.alpha0 = 0;
          }
          for (var c_2 = world.m_contactList; c_2; c_2 = c_2.m_next) {
            c_2.m_toiFlag = false;
            c_2.m_islandFlag = false;
            c_2.m_toiCount = 0;
            c_2.m_toi = 1;
          }
        }
        while (true) {
          var minContact = null;
          var minAlpha = 1;
          for (var c_3 = world.m_contactList; c_3; c_3 = c_3.m_next) {
            if (c_3.isEnabled() == false) {
              continue;
            }
            if (c_3.m_toiCount > SettingsInternal.maxSubSteps) {
              continue;
            }
            var alpha = 1;
            if (c_3.m_toiFlag) {
              alpha = c_3.m_toi;
            } else {
              var fA_1 = c_3.getFixtureA();
              var fB_1 = c_3.getFixtureB();
              if (fA_1.isSensor() || fB_1.isSensor()) {
                continue;
              }
              var bA_1 = fA_1.getBody();
              var bB_1 = fB_1.getBody();
              var activeA = bA_1.isAwake() && !bA_1.isStatic();
              var activeB = bB_1.isAwake() && !bB_1.isStatic();
              if (activeA == false && activeB == false) {
                continue;
              }
              var collideA = bA_1.isBullet() || !bA_1.isDynamic();
              var collideB = bB_1.isBullet() || !bB_1.isDynamic();
              if (collideA == false && collideB == false) {
                continue;
              }
              var alpha0 = bA_1.m_sweep.alpha0;
              if (bA_1.m_sweep.alpha0 < bB_1.m_sweep.alpha0) {
                alpha0 = bB_1.m_sweep.alpha0;
                bA_1.m_sweep.advance(alpha0);
              } else if (bB_1.m_sweep.alpha0 < bA_1.m_sweep.alpha0) {
                alpha0 = bA_1.m_sweep.alpha0;
                bB_1.m_sweep.advance(alpha0);
              }
              var indexA = c_3.getChildIndexA();
              var indexB = c_3.getChildIndexB();
              input.proxyA.set(fA_1.getShape(), indexA);
              input.proxyB.set(fB_1.getShape(), indexB);
              input.sweepA.set(bA_1.m_sweep);
              input.sweepB.set(bB_1.m_sweep);
              input.tMax = 1;
              TimeOfImpact(output, input);
              var beta = output.t;
              if (output.state == exports2.TOIOutputState.e_touching) {
                alpha = math_min$5(alpha0 + (1 - alpha0) * beta, 1);
              } else {
                alpha = 1;
              }
              c_3.m_toi = alpha;
              c_3.m_toiFlag = true;
            }
            if (alpha < minAlpha) {
              minContact = c_3;
              minAlpha = alpha;
            }
          }
          if (minContact == null || 1 - 10 * EPSILON < minAlpha) {
            world.m_stepComplete = true;
            break;
          }
          var fA = minContact.getFixtureA();
          var fB = minContact.getFixtureB();
          var bA = fA.getBody();
          var bB = fB.getBody();
          backup1.set(bA.m_sweep);
          backup2.set(bB.m_sweep);
          bA.advance(minAlpha);
          bB.advance(minAlpha);
          minContact.update(world);
          minContact.m_toiFlag = false;
          ++minContact.m_toiCount;
          if (minContact.isEnabled() == false || minContact.isTouching() == false) {
            minContact.setEnabled(false);
            bA.m_sweep.set(backup1);
            bB.m_sweep.set(backup2);
            bA.synchronizeTransform();
            bB.synchronizeTransform();
            continue;
          }
          bA.setAwake(true);
          bB.setAwake(true);
          this.clear();
          this.addBody(bA);
          this.addBody(bB);
          this.addContact(minContact);
          bA.m_islandFlag = true;
          bB.m_islandFlag = true;
          minContact.m_islandFlag = true;
          var bodies = [bA, bB];
          for (var i = 0; i < bodies.length; ++i) {
            var body = bodies[i];
            if (body.isDynamic()) {
              for (var ce = body.m_contactList; ce; ce = ce.next) {
                var contact = ce.contact;
                if (contact.m_islandFlag) {
                  continue;
                }
                var other = ce.other;
                if (other.isDynamic() && !body.isBullet() && !other.isBullet()) {
                  continue;
                }
                var sensorA = contact.m_fixtureA.m_isSensor;
                var sensorB = contact.m_fixtureB.m_isSensor;
                if (sensorA || sensorB) {
                  continue;
                }
                backup.set(other.m_sweep);
                if (other.m_islandFlag == false) {
                  other.advance(minAlpha);
                }
                contact.update(world);
                if (contact.isEnabled() == false || contact.isTouching() == false) {
                  other.m_sweep.set(backup);
                  other.synchronizeTransform();
                  continue;
                }
                contact.m_islandFlag = true;
                this.addContact(contact);
                if (other.m_islandFlag) {
                  continue;
                }
                other.m_islandFlag = true;
                if (!other.isStatic()) {
                  other.setAwake(true);
                }
                this.addBody(other);
              }
            }
          }
          s_subStep.reset((1 - minAlpha) * step.dt);
          s_subStep.dtRatio = 1;
          s_subStep.positionIterations = 20;
          s_subStep.velocityIterations = step.velocityIterations;
          s_subStep.warmStarting = false;
          this.solveIslandTOI(s_subStep, bA, bB);
          for (var i = 0; i < this.m_bodies.length; ++i) {
            var body = this.m_bodies[i];
            body.m_islandFlag = false;
            if (!body.isDynamic()) {
              continue;
            }
            body.synchronizeFixtures();
            for (var ce = body.m_contactList; ce; ce = ce.next) {
              ce.contact.m_toiFlag = false;
              ce.contact.m_islandFlag = false;
            }
          }
          world.findNewContacts();
          if (world.m_subStepping) {
            world.m_stepComplete = false;
            break;
          }
        }
      };
      Solver2.prototype.solveIslandTOI = function(subStep, toiA, toiB) {
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(body.c_position.c, body.m_sweep.c);
          body.c_position.a = body.m_sweep.a;
          copyVec2(body.c_velocity.v, body.m_linearVelocity);
          body.c_velocity.w = body.m_angularVelocity;
        }
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initConstraint(subStep);
        }
        for (var i = 0; i < subStep.positionIterations; ++i) {
          var minSeparation = 0;
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            var separation = contact.solvePositionConstraintTOI(subStep, toiA, toiB);
            minSeparation = math_min$5(minSeparation, separation);
          }
          var contactsOkay = minSeparation >= -1.5 * SettingsInternal.linearSlop;
          if (contactsOkay) {
            break;
          }
        }
        var i;
        copyVec2(toiA.m_sweep.c0, toiA.c_position.c);
        toiA.m_sweep.a0 = toiA.c_position.a;
        copyVec2(toiB.m_sweep.c0, toiB.c_position.c);
        toiB.m_sweep.a0 = toiB.c_position.a;
        for (var i = 0; i < this.m_contacts.length; ++i) {
          var contact = this.m_contacts[i];
          contact.initVelocityConstraint(subStep);
        }
        for (var i = 0; i < subStep.velocityIterations; ++i) {
          for (var j = 0; j < this.m_contacts.length; ++j) {
            var contact = this.m_contacts[j];
            contact.solveVelocityConstraint(subStep);
          }
        }
        var h = subStep.dt;
        for (var i = 0; i < this.m_bodies.length; ++i) {
          var body = this.m_bodies[i];
          copyVec2(c, body.c_position.c);
          var a2 = body.c_position.a;
          copyVec2(v, body.c_velocity.v);
          var w = body.c_velocity.w;
          scaleVec2(translation, h, v);
          var translationLengthSqr = lengthSqrVec2(translation);
          if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {
            var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);
            mulVec2(v, ratio);
          }
          var rotation2 = h * w;
          if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {
            var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);
            w *= ratio;
          }
          plusScaleVec2(c, h, v);
          a2 += h * w;
          copyVec2(body.c_position.c, c);
          body.c_position.a = a2;
          copyVec2(body.c_velocity.v, v);
          body.c_velocity.w = w;
          copyVec2(body.m_sweep.c, c);
          body.m_sweep.a = a2;
          copyVec2(body.m_linearVelocity, v);
          body.m_angularVelocity = w;
          body.synchronizeTransform();
        }
        this.postSolveIsland();
      };
      Solver2.prototype.postSolveIsland = function() {
        for (var c_5 = 0; c_5 < this.m_contacts.length; ++c_5) {
          var contact = this.m_contacts[c_5];
          this.m_world.postSolve(contact, contact.m_impulse);
        }
      };
      return Solver2;
    }()
  );
  Solver.TimeStep = TimeStep;
  var Mat22 = (
    /** @class */
    function() {
      function Mat222(a2, b2, c2, d2) {
        if (typeof a2 === "object" && a2 !== null) {
          this.ex = Vec2.clone(a2);
          this.ey = Vec2.clone(b2);
        } else if (typeof a2 === "number") {
          this.ex = Vec2.neo(a2, c2);
          this.ey = Vec2.neo(b2, d2);
        } else {
          this.ex = Vec2.zero();
          this.ey = Vec2.zero();
        }
      }
      Mat222.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Mat222.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec2.isValid(obj.ex) && Vec2.isValid(obj.ey);
      };
      Mat222.assert = function(o) {
      };
      Mat222.prototype.set = function(a2, b2, c2, d2) {
        if (typeof a2 === "number" && typeof b2 === "number" && typeof c2 === "number" && typeof d2 === "number") {
          this.ex.setNum(a2, c2);
          this.ey.setNum(b2, d2);
        } else if (typeof a2 === "object" && typeof b2 === "object") {
          this.ex.setVec2(a2);
          this.ey.setVec2(b2);
        } else if (typeof a2 === "object") {
          this.ex.setVec2(a2.ex);
          this.ey.setVec2(a2.ey);
        } else ;
      };
      Mat222.prototype.setIdentity = function() {
        this.ex.x = 1;
        this.ey.x = 0;
        this.ex.y = 0;
        this.ey.y = 1;
      };
      Mat222.prototype.setZero = function() {
        this.ex.x = 0;
        this.ey.x = 0;
        this.ex.y = 0;
        this.ey.y = 0;
      };
      Mat222.prototype.getInverse = function() {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        var imx = new Mat222();
        imx.ex.x = det * d2;
        imx.ey.x = -det * b2;
        imx.ex.y = -det * c2;
        imx.ey.y = det * a2;
        return imx;
      };
      Mat222.prototype.solve = function(v3) {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        var w = Vec2.zero();
        w.x = det * (d2 * v3.x - b2 * v3.y);
        w.y = det * (a2 * v3.y - c2 * v3.x);
        return w;
      };
      Mat222.mul = function(mx, v3) {
        if (v3 && "x" in v3 && "y" in v3) {
          var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;
          var y = mx.ex.y * v3.x + mx.ey.y * v3.y;
          return Vec2.neo(x2, y);
        } else if (v3 && "ex" in v3 && "ey" in v3) {
          var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;
          var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;
          var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;
          var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;
          return new Mat222(a2, b2, c2, d2);
        }
      };
      Mat222.mulVec2 = function(mx, v3) {
        var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;
        var y = mx.ex.y * v3.x + mx.ey.y * v3.y;
        return Vec2.neo(x2, y);
      };
      Mat222.mulMat22 = function(mx, v3) {
        var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;
        var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;
        var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;
        var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;
        return new Mat222(a2, b2, c2, d2);
      };
      Mat222.mulT = function(mx, v3) {
        if (v3 && "x" in v3 && "y" in v3) {
          return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));
        } else if (v3 && "ex" in v3 && "ey" in v3) {
          var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));
          var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));
          return new Mat222(c1, c2);
        }
      };
      Mat222.mulTVec2 = function(mx, v3) {
        return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));
      };
      Mat222.mulTMat22 = function(mx, v3) {
        var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));
        var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));
        return new Mat222(c1, c2);
      };
      Mat222.abs = function(mx) {
        return new Mat222(Vec2.abs(mx.ex), Vec2.abs(mx.ey));
      };
      Mat222.add = function(mx1, mx2) {
        return new Mat222(Vec2.add(mx1.ex, mx2.ex), Vec2.add(mx1.ey, mx2.ey));
      };
      return Mat222;
    }()
  );
  var math_sqrt$2 = Math.sqrt;
  var pointA$1 = vec2(0, 0);
  var pointB$1 = vec2(0, 0);
  var temp$3 = vec2(0, 0);
  var cA$1 = vec2(0, 0);
  var cB$1 = vec2(0, 0);
  var dist = vec2(0, 0);
  var planePoint$2 = vec2(0, 0);
  var clipPoint$1 = vec2(0, 0);
  exports2.ManifoldType = void 0;
  (function(ManifoldType2) {
    ManifoldType2[ManifoldType2["e_unset"] = -1] = "e_unset";
    ManifoldType2[ManifoldType2["e_circles"] = 0] = "e_circles";
    ManifoldType2[ManifoldType2["e_faceA"] = 1] = "e_faceA";
    ManifoldType2[ManifoldType2["e_faceB"] = 2] = "e_faceB";
  })(exports2.ManifoldType || (exports2.ManifoldType = {}));
  exports2.ContactFeatureType = void 0;
  (function(ContactFeatureType2) {
    ContactFeatureType2[ContactFeatureType2["e_unset"] = -1] = "e_unset";
    ContactFeatureType2[ContactFeatureType2["e_vertex"] = 0] = "e_vertex";
    ContactFeatureType2[ContactFeatureType2["e_face"] = 1] = "e_face";
  })(exports2.ContactFeatureType || (exports2.ContactFeatureType = {}));
  exports2.PointState = void 0;
  (function(PointState2) {
    PointState2[PointState2["nullState"] = 0] = "nullState";
    PointState2[PointState2["addState"] = 1] = "addState";
    PointState2[PointState2["persistState"] = 2] = "persistState";
    PointState2[PointState2["removeState"] = 3] = "removeState";
  })(exports2.PointState || (exports2.PointState = {}));
  var ClipVertex = (
    /** @class */
    function() {
      function ClipVertex2() {
        this.v = vec2(0, 0);
        this.id = new ContactID();
      }
      ClipVertex2.prototype.set = function(o) {
        copyVec2(this.v, o.v);
        this.id.set(o.id);
      };
      ClipVertex2.prototype.recycle = function() {
        zeroVec2(this.v);
        this.id.recycle();
      };
      return ClipVertex2;
    }()
  );
  var Manifold = (
    /** @class */
    function() {
      function Manifold2() {
        this.localNormal = vec2(0, 0);
        this.localPoint = vec2(0, 0);
        this.points = [new ManifoldPoint(), new ManifoldPoint()];
        this.pointCount = 0;
      }
      Manifold2.prototype.set = function(that) {
        this.type = that.type;
        copyVec2(this.localNormal, that.localNormal);
        copyVec2(this.localPoint, that.localPoint);
        this.pointCount = that.pointCount;
        this.points[0].set(that.points[0]);
        this.points[1].set(that.points[1]);
      };
      Manifold2.prototype.recycle = function() {
        this.type = exports2.ManifoldType.e_unset;
        zeroVec2(this.localNormal);
        zeroVec2(this.localPoint);
        this.pointCount = 0;
        this.points[0].recycle();
        this.points[1].recycle();
      };
      Manifold2.prototype.getWorldManifold = function(wm, xfA2, radiusA, xfB2, radiusB) {
        if (this.pointCount == 0) {
          return wm;
        }
        wm = wm || new WorldManifold();
        wm.pointCount = this.pointCount;
        var normal3 = wm.normal;
        var points = wm.points;
        var separations = wm.separations;
        switch (this.type) {
          case exports2.ManifoldType.e_circles: {
            setVec2(normal3, 1, 0);
            var manifoldPoint = this.points[0];
            transformVec2(pointA$1, xfA2, this.localPoint);
            transformVec2(pointB$1, xfB2, manifoldPoint.localPoint);
            subVec2(dist, pointB$1, pointA$1);
            var lengthSqr = lengthSqrVec2(dist);
            if (lengthSqr > EPSILON * EPSILON) {
              var length_1 = math_sqrt$2(lengthSqr);
              scaleVec2(normal3, 1 / length_1, dist);
            }
            combine2Vec2(cA$1, 1, pointA$1, radiusA, normal3);
            combine2Vec2(cB$1, 1, pointB$1, -radiusB, normal3);
            combine2Vec2(points[0], 0.5, cA$1, 0.5, cB$1);
            separations[0] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);
            break;
          }
          case exports2.ManifoldType.e_faceA: {
            rotVec2(normal3, xfA2.q, this.localNormal);
            transformVec2(planePoint$2, xfA2, this.localPoint);
            for (var i = 0; i < this.pointCount; ++i) {
              var manifoldPoint = this.points[i];
              transformVec2(clipPoint$1, xfB2, manifoldPoint.localPoint);
              combine2Vec2(cA$1, 1, clipPoint$1, radiusA - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);
              combine2Vec2(cB$1, 1, clipPoint$1, -radiusB, normal3);
              combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);
              separations[i] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);
            }
            break;
          }
          case exports2.ManifoldType.e_faceB: {
            rotVec2(normal3, xfB2.q, this.localNormal);
            transformVec2(planePoint$2, xfB2, this.localPoint);
            for (var i = 0; i < this.pointCount; ++i) {
              var manifoldPoint = this.points[i];
              transformVec2(clipPoint$1, xfA2, manifoldPoint.localPoint);
              combine2Vec2(cB$1, 1, clipPoint$1, radiusB - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);
              combine2Vec2(cA$1, 1, clipPoint$1, -radiusA, normal3);
              combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);
              separations[i] = dotVec2(subVec2(temp$3, cA$1, cB$1), normal3);
            }
            negVec2(normal3);
            break;
          }
        }
        return wm;
      };
      Manifold2.clipSegmentToLine = clipSegmentToLine;
      Manifold2.ClipVertex = ClipVertex;
      Manifold2.getPointStates = getPointStates;
      Manifold2.PointState = exports2.PointState;
      return Manifold2;
    }()
  );
  var ManifoldPoint = (
    /** @class */
    function() {
      function ManifoldPoint2() {
        this.localPoint = vec2(0, 0);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.id = new ContactID();
      }
      ManifoldPoint2.prototype.set = function(that) {
        copyVec2(this.localPoint, that.localPoint);
        this.normalImpulse = that.normalImpulse;
        this.tangentImpulse = that.tangentImpulse;
        this.id.set(that.id);
      };
      ManifoldPoint2.prototype.recycle = function() {
        zeroVec2(this.localPoint);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.id.recycle();
      };
      return ManifoldPoint2;
    }()
  );
  var ContactID = (
    /** @class */
    function() {
      function ContactID2() {
        this.key = -1;
        this.indexA = -1;
        this.indexB = -1;
        this.typeA = exports2.ContactFeatureType.e_unset;
        this.typeB = exports2.ContactFeatureType.e_unset;
      }
      ContactID2.prototype.setFeatures = function(indexA, typeA, indexB, typeB) {
        this.indexA = indexA;
        this.indexB = indexB;
        this.typeA = typeA;
        this.typeB = typeB;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.set = function(that) {
        this.indexA = that.indexA;
        this.indexB = that.indexB;
        this.typeA = that.typeA;
        this.typeB = that.typeB;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.swapFeatures = function() {
        var indexA = this.indexA;
        var indexB = this.indexB;
        var typeA = this.typeA;
        var typeB = this.typeB;
        this.indexA = indexB;
        this.indexB = indexA;
        this.typeA = typeB;
        this.typeB = typeA;
        this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;
      };
      ContactID2.prototype.recycle = function() {
        this.indexA = 0;
        this.indexB = 0;
        this.typeA = exports2.ContactFeatureType.e_unset;
        this.typeB = exports2.ContactFeatureType.e_unset;
        this.key = -1;
      };
      return ContactID2;
    }()
  );
  var WorldManifold = (
    /** @class */
    function() {
      function WorldManifold2() {
        this.normal = vec2(0, 0);
        this.points = [vec2(0, 0), vec2(0, 0)];
        this.separations = [0, 0];
        this.pointCount = 0;
      }
      WorldManifold2.prototype.recycle = function() {
        zeroVec2(this.normal);
        zeroVec2(this.points[0]);
        zeroVec2(this.points[1]);
        this.separations[0] = 0;
        this.separations[1] = 0;
        this.pointCount = 0;
      };
      return WorldManifold2;
    }()
  );
  function getPointStates(state1, state2, manifold1, manifold2) {
    for (var i = 0; i < manifold1.pointCount; ++i) {
      var id = manifold1.points[i].id;
      state1[i] = exports2.PointState.removeState;
      for (var j = 0; j < manifold2.pointCount; ++j) {
        if (manifold2.points[j].id.key === id.key) {
          state1[i] = exports2.PointState.persistState;
          break;
        }
      }
    }
    for (var i = 0; i < manifold2.pointCount; ++i) {
      var id = manifold2.points[i].id;
      state2[i] = exports2.PointState.addState;
      for (var j = 0; j < manifold1.pointCount; ++j) {
        if (manifold1.points[j].id.key === id.key) {
          state2[i] = exports2.PointState.persistState;
          break;
        }
      }
    }
  }
  function clipSegmentToLine(vOut, vIn, normal3, offset, vertexIndexA) {
    var numOut = 0;
    var distance0 = dotVec2(normal3, vIn[0].v) - offset;
    var distance1 = dotVec2(normal3, vIn[1].v) - offset;
    if (distance0 <= 0)
      vOut[numOut++].set(vIn[0]);
    if (distance1 <= 0)
      vOut[numOut++].set(vIn[1]);
    if (distance0 * distance1 < 0) {
      var interp = distance0 / (distance0 - distance1);
      combine2Vec2(vOut[numOut].v, 1 - interp, vIn[0].v, interp, vIn[1].v);
      vOut[numOut].id.setFeatures(vertexIndexA, exports2.ContactFeatureType.e_vertex, vIn[0].id.indexB, exports2.ContactFeatureType.e_face);
      ++numOut;
    }
    return numOut;
  }
  var math_sqrt$1 = Math.sqrt;
  var math_max$2 = Math.max;
  var math_min$4 = Math.min;
  var contactPool = new Pool({
    create: function() {
      return new Contact();
    },
    release: function(contact) {
      contact.recycle();
    }
  });
  var oldManifold = new Manifold();
  var worldManifold = new WorldManifold();
  var ContactEdge = (
    /** @class */
    function() {
      function ContactEdge2(contact) {
        this.prev = null;
        this.next = null;
        this.other = null;
        this.contact = contact;
      }
      ContactEdge2.prototype.recycle = function() {
        this.prev = null;
        this.next = null;
        this.other = null;
      };
      return ContactEdge2;
    }()
  );
  function mixFriction(friction1, friction2) {
    return math_sqrt$1(friction1 * friction2);
  }
  function mixRestitution(restitution1, restitution2) {
    return restitution1 > restitution2 ? restitution1 : restitution2;
  }
  var s_registers = [];
  var VelocityConstraintPoint = (
    /** @class */
    function() {
      function VelocityConstraintPoint2() {
        this.rA = vec2(0, 0);
        this.rB = vec2(0, 0);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.normalMass = 0;
        this.tangentMass = 0;
        this.velocityBias = 0;
      }
      VelocityConstraintPoint2.prototype.recycle = function() {
        zeroVec2(this.rA);
        zeroVec2(this.rB);
        this.normalImpulse = 0;
        this.tangentImpulse = 0;
        this.normalMass = 0;
        this.tangentMass = 0;
        this.velocityBias = 0;
      };
      return VelocityConstraintPoint2;
    }()
  );
  var cA = vec2(0, 0);
  var vA = vec2(0, 0);
  var cB = vec2(0, 0);
  var vB = vec2(0, 0);
  var tangent$1 = vec2(0, 0);
  var xfA = transform(0, 0, 0);
  var xfB = transform(0, 0, 0);
  var pointA = vec2(0, 0);
  var pointB = vec2(0, 0);
  var clipPoint = vec2(0, 0);
  var planePoint$1 = vec2(0, 0);
  var rA = vec2(0, 0);
  var rB = vec2(0, 0);
  var P$1 = vec2(0, 0);
  var normal$2 = vec2(0, 0);
  var point = vec2(0, 0);
  var dv = vec2(0, 0);
  var dv1 = vec2(0, 0);
  var dv2 = vec2(0, 0);
  var b = vec2(0, 0);
  var a = vec2(0, 0);
  var x = vec2(0, 0);
  var d = vec2(0, 0);
  var P1 = vec2(0, 0);
  var P2 = vec2(0, 0);
  var temp$2 = vec2(0, 0);
  var Contact = (
    /** @class */
    function() {
      function Contact2() {
        this.m_nodeA = new ContactEdge(this);
        this.m_nodeB = new ContactEdge(this);
        this.m_fixtureA = null;
        this.m_fixtureB = null;
        this.m_indexA = -1;
        this.m_indexB = -1;
        this.m_evaluateFcn = null;
        this.m_manifold = new Manifold();
        this.m_prev = null;
        this.m_next = null;
        this.m_toi = 1;
        this.m_toiCount = 0;
        this.m_toiFlag = false;
        this.m_friction = 0;
        this.m_restitution = 0;
        this.m_tangentSpeed = 0;
        this.m_enabledFlag = true;
        this.m_islandFlag = false;
        this.m_touchingFlag = false;
        this.m_filterFlag = false;
        this.m_bulletHitFlag = false;
        this.m_impulse = new ContactImpulse(this);
        this.v_points = [new VelocityConstraintPoint(), new VelocityConstraintPoint()];
        this.v_normal = vec2(0, 0);
        this.v_normalMass = new Mat22();
        this.v_K = new Mat22();
        this.v_pointCount = 0;
        this.v_tangentSpeed = 0;
        this.v_friction = 0;
        this.v_restitution = 0;
        this.v_invMassA = 0;
        this.v_invMassB = 0;
        this.v_invIA = 0;
        this.v_invIB = 0;
        this.p_localPoints = [vec2(0, 0), vec2(0, 0)];
        this.p_localNormal = vec2(0, 0);
        this.p_localPoint = vec2(0, 0);
        this.p_localCenterA = vec2(0, 0);
        this.p_localCenterB = vec2(0, 0);
        this.p_type = exports2.ManifoldType.e_unset;
        this.p_radiusA = 0;
        this.p_radiusB = 0;
        this.p_pointCount = 0;
        this.p_invMassA = 0;
        this.p_invMassB = 0;
        this.p_invIA = 0;
        this.p_invIB = 0;
      }
      Contact2.prototype.initialize = function(fA, indexA, fB, indexB, evaluateFcn) {
        this.m_fixtureA = fA;
        this.m_fixtureB = fB;
        this.m_indexA = indexA;
        this.m_indexB = indexB;
        this.m_evaluateFcn = evaluateFcn;
        this.m_friction = mixFriction(this.m_fixtureA.m_friction, this.m_fixtureB.m_friction);
        this.m_restitution = mixRestitution(this.m_fixtureA.m_restitution, this.m_fixtureB.m_restitution);
      };
      Contact2.prototype.recycle = function() {
        this.m_nodeA.recycle();
        this.m_nodeB.recycle();
        this.m_fixtureA = null;
        this.m_fixtureB = null;
        this.m_indexA = -1;
        this.m_indexB = -1;
        this.m_evaluateFcn = null;
        this.m_manifold.recycle();
        this.m_prev = null;
        this.m_next = null;
        this.m_toi = 1;
        this.m_toiCount = 0;
        this.m_toiFlag = false;
        this.m_friction = 0;
        this.m_restitution = 0;
        this.m_tangentSpeed = 0;
        this.m_enabledFlag = true;
        this.m_islandFlag = false;
        this.m_touchingFlag = false;
        this.m_filterFlag = false;
        this.m_bulletHitFlag = false;
        this.m_impulse.recycle();
        for (var _i = 0, _a2 = this.v_points; _i < _a2.length; _i++) {
          var point_1 = _a2[_i];
          point_1.recycle();
        }
        zeroVec2(this.v_normal);
        this.v_normalMass.setZero();
        this.v_K.setZero();
        this.v_pointCount = 0;
        this.v_tangentSpeed = 0;
        this.v_friction = 0;
        this.v_restitution = 0;
        this.v_invMassA = 0;
        this.v_invMassB = 0;
        this.v_invIA = 0;
        this.v_invIB = 0;
        for (var _b = 0, _c = this.p_localPoints; _b < _c.length; _b++) {
          var point_2 = _c[_b];
          zeroVec2(point_2);
        }
        zeroVec2(this.p_localNormal);
        zeroVec2(this.p_localPoint);
        zeroVec2(this.p_localCenterA);
        zeroVec2(this.p_localCenterB);
        this.p_type = exports2.ManifoldType.e_unset;
        this.p_radiusA = 0;
        this.p_radiusB = 0;
        this.p_pointCount = 0;
        this.p_invMassA = 0;
        this.p_invMassB = 0;
        this.p_invIA = 0;
        this.p_invIB = 0;
      };
      Contact2.prototype.initConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        var manifold = this.m_manifold;
        var pointCount = manifold.pointCount;
        this.v_invMassA = bodyA.m_invMass;
        this.v_invMassB = bodyB.m_invMass;
        this.v_invIA = bodyA.m_invI;
        this.v_invIB = bodyB.m_invI;
        this.v_friction = this.m_friction;
        this.v_restitution = this.m_restitution;
        this.v_tangentSpeed = this.m_tangentSpeed;
        this.v_pointCount = pointCount;
        this.v_K.setZero();
        this.v_normalMass.setZero();
        this.p_invMassA = bodyA.m_invMass;
        this.p_invMassB = bodyB.m_invMass;
        this.p_invIA = bodyA.m_invI;
        this.p_invIB = bodyB.m_invI;
        copyVec2(this.p_localCenterA, bodyA.m_sweep.localCenter);
        copyVec2(this.p_localCenterB, bodyB.m_sweep.localCenter);
        this.p_radiusA = shapeA.m_radius;
        this.p_radiusB = shapeB.m_radius;
        this.p_type = manifold.type;
        copyVec2(this.p_localNormal, manifold.localNormal);
        copyVec2(this.p_localPoint, manifold.localPoint);
        this.p_pointCount = pointCount;
        for (var j = 0; j < SettingsInternal.maxManifoldPoints; ++j) {
          this.v_points[j].recycle();
          zeroVec2(this.p_localPoints[j]);
        }
        for (var j = 0; j < pointCount; ++j) {
          var cp = manifold.points[j];
          var vcp = this.v_points[j];
          if (step.warmStarting) {
            vcp.normalImpulse = step.dtRatio * cp.normalImpulse;
            vcp.tangentImpulse = step.dtRatio * cp.tangentImpulse;
          }
          copyVec2(this.p_localPoints[j], cp.localPoint);
        }
      };
      Contact2.prototype.getManifold = function() {
        return this.m_manifold;
      };
      Contact2.prototype.getWorldManifold = function(worldManifold2) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        return this.m_manifold.getWorldManifold(worldManifold2, bodyA.getTransform(), shapeA.m_radius, bodyB.getTransform(), shapeB.m_radius);
      };
      Contact2.prototype.setEnabled = function(flag) {
        this.m_enabledFlag = !!flag;
      };
      Contact2.prototype.isEnabled = function() {
        return this.m_enabledFlag;
      };
      Contact2.prototype.isTouching = function() {
        return this.m_touchingFlag;
      };
      Contact2.prototype.getNext = function() {
        return this.m_next;
      };
      Contact2.prototype.getFixtureA = function() {
        return this.m_fixtureA;
      };
      Contact2.prototype.getFixtureB = function() {
        return this.m_fixtureB;
      };
      Contact2.prototype.getChildIndexA = function() {
        return this.m_indexA;
      };
      Contact2.prototype.getChildIndexB = function() {
        return this.m_indexB;
      };
      Contact2.prototype.flagForFiltering = function() {
        this.m_filterFlag = true;
      };
      Contact2.prototype.setFriction = function(friction) {
        this.m_friction = friction;
      };
      Contact2.prototype.getFriction = function() {
        return this.m_friction;
      };
      Contact2.prototype.resetFriction = function() {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_friction = mixFriction(fixtureA.m_friction, fixtureB.m_friction);
      };
      Contact2.prototype.setRestitution = function(restitution) {
        this.m_restitution = restitution;
      };
      Contact2.prototype.getRestitution = function() {
        return this.m_restitution;
      };
      Contact2.prototype.resetRestitution = function() {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_restitution = mixRestitution(fixtureA.m_restitution, fixtureB.m_restitution);
      };
      Contact2.prototype.setTangentSpeed = function(speed) {
        this.m_tangentSpeed = speed;
      };
      Contact2.prototype.getTangentSpeed = function() {
        return this.m_tangentSpeed;
      };
      Contact2.prototype.evaluate = function(manifold, xfA2, xfB2) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        this.m_evaluateFcn(manifold, xfA2, fixtureA, this.m_indexA, xfB2, fixtureB, this.m_indexB);
      };
      Contact2.prototype.update = function(listener) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var shapeA = fixtureA.m_shape;
        var shapeB = fixtureB.m_shape;
        if (shapeA === null || shapeB === null)
          return;
        this.m_enabledFlag = true;
        var touching = false;
        var wasTouching = this.m_touchingFlag;
        var sensorA = fixtureA.m_isSensor;
        var sensorB = fixtureB.m_isSensor;
        var sensor = sensorA || sensorB;
        var xfA2 = bodyA.m_xf;
        var xfB2 = bodyB.m_xf;
        if (sensor) {
          touching = testOverlap(shapeA, this.m_indexA, shapeB, this.m_indexB, xfA2, xfB2);
          this.m_manifold.pointCount = 0;
        } else {
          oldManifold.recycle();
          oldManifold.set(this.m_manifold);
          this.m_manifold.recycle();
          this.evaluate(this.m_manifold, xfA2, xfB2);
          touching = this.m_manifold.pointCount > 0;
          for (var i = 0; i < this.m_manifold.pointCount; ++i) {
            var nmp = this.m_manifold.points[i];
            nmp.normalImpulse = 0;
            nmp.tangentImpulse = 0;
            for (var j = 0; j < oldManifold.pointCount; ++j) {
              var omp = oldManifold.points[j];
              if (omp.id.key === nmp.id.key) {
                nmp.normalImpulse = omp.normalImpulse;
                nmp.tangentImpulse = omp.tangentImpulse;
                break;
              }
            }
          }
          if (touching !== wasTouching) {
            bodyA.setAwake(true);
            bodyB.setAwake(true);
          }
        }
        this.m_touchingFlag = touching;
        var hasListener = typeof listener === "object" && listener !== null;
        if (!wasTouching && touching && hasListener) {
          listener.beginContact(this);
        }
        if (wasTouching && !touching && hasListener) {
          listener.endContact(this);
        }
        if (!sensor && touching && hasListener && oldManifold) {
          listener.preSolve(this, oldManifold);
        }
      };
      Contact2.prototype.solvePositionConstraint = function(step) {
        return this._solvePositionConstraint(step, null, null);
      };
      Contact2.prototype.solvePositionConstraintTOI = function(step, toiA, toiB) {
        return this._solvePositionConstraint(step, toiA, toiB);
      };
      Contact2.prototype._solvePositionConstraint = function(step, toiA, toiB) {
        var toi = toiA !== null && toiB !== null ? true : false;
        var minSeparation = 0;
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return minSeparation;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return minSeparation;
        var positionA = bodyA.c_position;
        var positionB = bodyB.c_position;
        var localCenterA = this.p_localCenterA;
        var localCenterB = this.p_localCenterB;
        var mA = 0;
        var iA = 0;
        if (!toi || bodyA === toiA || bodyA === toiB) {
          mA = this.p_invMassA;
          iA = this.p_invIA;
        }
        var mB = 0;
        var iB = 0;
        if (!toi || bodyB === toiA || bodyB === toiB) {
          mB = this.p_invMassB;
          iB = this.p_invIB;
        }
        copyVec2(cA, positionA.c);
        var aA = positionA.a;
        copyVec2(cB, positionB.c);
        var aB = positionB.a;
        for (var j = 0; j < this.p_pointCount; ++j) {
          getTransform(xfA, localCenterA, cA, aA);
          getTransform(xfB, localCenterB, cB, aB);
          var separation = void 0;
          switch (this.p_type) {
            case exports2.ManifoldType.e_circles: {
              transformVec2(pointA, xfA, this.p_localPoint);
              transformVec2(pointB, xfB, this.p_localPoints[0]);
              subVec2(normal$2, pointB, pointA);
              normalizeVec2(normal$2);
              combine2Vec2(point, 0.5, pointA, 0.5, pointB);
              separation = dotVec2(pointB, normal$2) - dotVec2(pointA, normal$2) - this.p_radiusA - this.p_radiusB;
              break;
            }
            case exports2.ManifoldType.e_faceA: {
              rotVec2(normal$2, xfA.q, this.p_localNormal);
              transformVec2(planePoint$1, xfA, this.p_localPoint);
              transformVec2(clipPoint, xfB, this.p_localPoints[j]);
              separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;
              copyVec2(point, clipPoint);
              break;
            }
            case exports2.ManifoldType.e_faceB: {
              rotVec2(normal$2, xfB.q, this.p_localNormal);
              transformVec2(planePoint$1, xfB, this.p_localPoint);
              transformVec2(clipPoint, xfA, this.p_localPoints[j]);
              separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;
              copyVec2(point, clipPoint);
              negVec2(normal$2);
              break;
            }
            default: {
              return minSeparation;
            }
          }
          subVec2(rA, point, cA);
          subVec2(rB, point, cB);
          minSeparation = math_min$4(minSeparation, separation);
          var baumgarte = toi ? SettingsInternal.toiBaugarte : SettingsInternal.baumgarte;
          var linearSlop = SettingsInternal.linearSlop;
          var maxLinearCorrection = SettingsInternal.maxLinearCorrection;
          var C = clamp(baumgarte * (separation + linearSlop), -maxLinearCorrection, 0);
          var rnA = crossVec2Vec2(rA, normal$2);
          var rnB = crossVec2Vec2(rB, normal$2);
          var K = mA + mB + iA * rnA * rnA + iB * rnB * rnB;
          var impulse = K > 0 ? -C / K : 0;
          scaleVec2(P$1, impulse, normal$2);
          minusScaleVec2(cA, mA, P$1);
          aA -= iA * crossVec2Vec2(rA, P$1);
          plusScaleVec2(cB, mB, P$1);
          aB += iB * crossVec2Vec2(rB, P$1);
        }
        copyVec2(positionA.c, cA);
        positionA.a = aA;
        copyVec2(positionB.c, cB);
        positionB.a = aB;
        return minSeparation;
      };
      Contact2.prototype.initVelocityConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var positionA = bodyA.c_position;
        var positionB = bodyB.c_position;
        var radiusA = this.p_radiusA;
        var radiusB = this.p_radiusB;
        var manifold = this.m_manifold;
        var mA = this.v_invMassA;
        var mB = this.v_invMassB;
        var iA = this.v_invIA;
        var iB = this.v_invIB;
        var localCenterA = this.p_localCenterA;
        var localCenterB = this.p_localCenterB;
        copyVec2(cA, positionA.c);
        var aA = positionA.a;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(cB, positionB.c);
        var aB = positionB.a;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        getTransform(xfA, localCenterA, cA, aA);
        getTransform(xfB, localCenterB, cB, aB);
        worldManifold.recycle();
        manifold.getWorldManifold(worldManifold, xfA, radiusA, xfB, radiusB);
        copyVec2(this.v_normal, worldManifold.normal);
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          var wmp = worldManifold.points[j];
          subVec2(vcp.rA, wmp, cA);
          subVec2(vcp.rB, wmp, cB);
          var rnA = crossVec2Vec2(vcp.rA, this.v_normal);
          var rnB = crossVec2Vec2(vcp.rB, this.v_normal);
          var kNormal = mA + mB + iA * rnA * rnA + iB * rnB * rnB;
          vcp.normalMass = kNormal > 0 ? 1 / kNormal : 0;
          crossVec2Num(tangent$1, this.v_normal, 1);
          var rtA = crossVec2Vec2(vcp.rA, tangent$1);
          var rtB = crossVec2Vec2(vcp.rB, tangent$1);
          var kTangent = mA + mB + iA * rtA * rtA + iB * rtB * rtB;
          vcp.tangentMass = kTangent > 0 ? 1 / kTangent : 0;
          vcp.velocityBias = 0;
          var vRel = 0;
          vRel += dotVec2(this.v_normal, vB);
          vRel += dotVec2(this.v_normal, crossNumVec2(temp$2, wB, vcp.rB));
          vRel -= dotVec2(this.v_normal, vA);
          vRel -= dotVec2(this.v_normal, crossNumVec2(temp$2, wA, vcp.rA));
          if (vRel < -SettingsInternal.velocityThreshold) {
            vcp.velocityBias = -this.v_restitution * vRel;
          }
        }
        if (this.v_pointCount == 2 && step.blockSolve) {
          var vcp1 = this.v_points[0];
          var vcp2 = this.v_points[1];
          var rn1A = crossVec2Vec2(vcp1.rA, this.v_normal);
          var rn1B = crossVec2Vec2(vcp1.rB, this.v_normal);
          var rn2A = crossVec2Vec2(vcp2.rA, this.v_normal);
          var rn2B = crossVec2Vec2(vcp2.rB, this.v_normal);
          var k11 = mA + mB + iA * rn1A * rn1A + iB * rn1B * rn1B;
          var k22 = mA + mB + iA * rn2A * rn2A + iB * rn2B * rn2B;
          var k12 = mA + mB + iA * rn1A * rn2A + iB * rn1B * rn2B;
          var k_maxConditionNumber = 1e3;
          if (k11 * k11 < k_maxConditionNumber * (k11 * k22 - k12 * k12)) {
            this.v_K.ex.setNum(k11, k12);
            this.v_K.ey.setNum(k12, k22);
            var a_1 = this.v_K.ex.x;
            var b_1 = this.v_K.ey.x;
            var c2 = this.v_K.ex.y;
            var d_1 = this.v_K.ey.y;
            var det = a_1 * d_1 - b_1 * c2;
            if (det !== 0) {
              det = 1 / det;
            }
            this.v_normalMass.ex.x = det * d_1;
            this.v_normalMass.ey.x = -det * b_1;
            this.v_normalMass.ex.y = -det * c2;
            this.v_normalMass.ey.y = det * a_1;
          } else {
            this.v_pointCount = 1;
          }
        }
        copyVec2(positionA.c, cA);
        positionA.a = aA;
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(positionB.c, cB);
        positionB.a = aB;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.prototype.warmStartConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var mA = this.v_invMassA;
        var iA = this.v_invIA;
        var mB = this.v_invMassB;
        var iB = this.v_invIB;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        copyVec2(normal$2, this.v_normal);
        crossVec2Num(tangent$1, normal$2, 1);
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          combine2Vec2(P$1, vcp.normalImpulse, normal$2, vcp.tangentImpulse, tangent$1);
          wA -= iA * crossVec2Vec2(vcp.rA, P$1);
          minusScaleVec2(vA, mA, P$1);
          wB += iB * crossVec2Vec2(vcp.rB, P$1);
          plusScaleVec2(vB, mB, P$1);
        }
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.prototype.storeConstraintImpulses = function(step) {
        var manifold = this.m_manifold;
        for (var j = 0; j < this.v_pointCount; ++j) {
          manifold.points[j].normalImpulse = this.v_points[j].normalImpulse;
          manifold.points[j].tangentImpulse = this.v_points[j].tangentImpulse;
        }
      };
      Contact2.prototype.solveVelocityConstraint = function(step) {
        var fixtureA = this.m_fixtureA;
        var fixtureB = this.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        var velocityA = bodyA.c_velocity;
        var velocityB = bodyB.c_velocity;
        var mA = this.v_invMassA;
        var iA = this.v_invIA;
        var mB = this.v_invMassB;
        var iB = this.v_invIB;
        copyVec2(vA, velocityA.v);
        var wA = velocityA.w;
        copyVec2(vB, velocityB.v);
        var wB = velocityB.w;
        copyVec2(normal$2, this.v_normal);
        crossVec2Num(tangent$1, normal$2, 1);
        var friction = this.v_friction;
        for (var j = 0; j < this.v_pointCount; ++j) {
          var vcp = this.v_points[j];
          zeroVec2(dv);
          plusVec2(dv, vB);
          plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));
          minusVec2(dv, vA);
          minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));
          var vt = dotVec2(dv, tangent$1) - this.v_tangentSpeed;
          var lambda = vcp.tangentMass * -vt;
          var maxFriction = friction * vcp.normalImpulse;
          var newImpulse = clamp(vcp.tangentImpulse + lambda, -maxFriction, maxFriction);
          lambda = newImpulse - vcp.tangentImpulse;
          vcp.tangentImpulse = newImpulse;
          scaleVec2(P$1, lambda, tangent$1);
          minusScaleVec2(vA, mA, P$1);
          wA -= iA * crossVec2Vec2(vcp.rA, P$1);
          plusScaleVec2(vB, mB, P$1);
          wB += iB * crossVec2Vec2(vcp.rB, P$1);
        }
        if (this.v_pointCount == 1 || step.blockSolve == false) {
          for (var i = 0; i < this.v_pointCount; ++i) {
            var vcp = this.v_points[i];
            zeroVec2(dv);
            plusVec2(dv, vB);
            plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));
            minusVec2(dv, vA);
            minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));
            var vn = dotVec2(dv, normal$2);
            var lambda = -vcp.normalMass * (vn - vcp.velocityBias);
            var newImpulse = math_max$2(vcp.normalImpulse + lambda, 0);
            lambda = newImpulse - vcp.normalImpulse;
            vcp.normalImpulse = newImpulse;
            scaleVec2(P$1, lambda, normal$2);
            minusScaleVec2(vA, mA, P$1);
            wA -= iA * crossVec2Vec2(vcp.rA, P$1);
            plusScaleVec2(vB, mB, P$1);
            wB += iB * crossVec2Vec2(vcp.rB, P$1);
          }
        } else {
          var vcp1 = this.v_points[0];
          var vcp2 = this.v_points[1];
          setVec2(a, vcp1.normalImpulse, vcp2.normalImpulse);
          zeroVec2(dv1);
          plusVec2(dv1, vB);
          plusVec2(dv1, crossNumVec2(temp$2, wB, vcp1.rB));
          minusVec2(dv1, vA);
          minusVec2(dv1, crossNumVec2(temp$2, wA, vcp1.rA));
          zeroVec2(dv2);
          plusVec2(dv2, vB);
          plusVec2(dv2, crossNumVec2(temp$2, wB, vcp2.rB));
          minusVec2(dv2, vA);
          minusVec2(dv2, crossNumVec2(temp$2, wA, vcp2.rA));
          var vn1 = dotVec2(dv1, normal$2);
          var vn2 = dotVec2(dv2, normal$2);
          setVec2(b, vn1 - vcp1.velocityBias, vn2 - vcp2.velocityBias);
          b.x -= this.v_K.ex.x * a.x + this.v_K.ey.x * a.y;
          b.y -= this.v_K.ex.y * a.x + this.v_K.ey.y * a.y;
          while (true) {
            zeroVec2(x);
            x.x = -(this.v_normalMass.ex.x * b.x + this.v_normalMass.ey.x * b.y);
            x.y = -(this.v_normalMass.ex.y * b.x + this.v_normalMass.ey.y * b.y);
            if (x.x >= 0 && x.y >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = -vcp1.normalMass * b.x;
            x.y = 0;
            vn1 = 0;
            vn2 = this.v_K.ex.y * x.x + b.y;
            if (x.x >= 0 && vn2 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = 0;
            x.y = -vcp2.normalMass * b.y;
            vn1 = this.v_K.ey.x * x.y + b.x;
            vn2 = 0;
            if (x.y >= 0 && vn1 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            x.x = 0;
            x.y = 0;
            vn1 = b.x;
            vn2 = b.y;
            if (vn1 >= 0 && vn2 >= 0) {
              subVec2(d, x, a);
              scaleVec2(P1, d.x, normal$2);
              scaleVec2(P2, d.y, normal$2);
              combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);
              wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));
              combine3Vec2(vB, mB, P1, mB, P2, 1, vB);
              wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));
              vcp1.normalImpulse = x.x;
              vcp2.normalImpulse = x.y;
              break;
            }
            break;
          }
        }
        copyVec2(velocityA.v, vA);
        velocityA.w = wA;
        copyVec2(velocityB.v, vB);
        velocityB.w = wB;
      };
      Contact2.addType = function(type1, type2, callback) {
        s_registers[type1] = s_registers[type1] || {};
        s_registers[type1][type2] = callback;
      };
      Contact2.create = function(fixtureA, indexA, fixtureB, indexB) {
        var typeA = fixtureA.m_shape.m_type;
        var typeB = fixtureB.m_shape.m_type;
        var contact = contactPool.allocate();
        var evaluateFcn;
        if (evaluateFcn = s_registers[typeA] && s_registers[typeA][typeB]) {
          contact.initialize(fixtureA, indexA, fixtureB, indexB, evaluateFcn);
        } else if (evaluateFcn = s_registers[typeB] && s_registers[typeB][typeA]) {
          contact.initialize(fixtureB, indexB, fixtureA, indexA, evaluateFcn);
        } else {
          return null;
        }
        fixtureA = contact.m_fixtureA;
        fixtureB = contact.m_fixtureB;
        indexA = contact.getChildIndexA();
        indexB = contact.getChildIndexB();
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        contact.m_nodeA.contact = contact;
        contact.m_nodeA.other = bodyB;
        contact.m_nodeA.prev = null;
        contact.m_nodeA.next = bodyA.m_contactList;
        if (bodyA.m_contactList != null) {
          bodyA.m_contactList.prev = contact.m_nodeA;
        }
        bodyA.m_contactList = contact.m_nodeA;
        contact.m_nodeB.contact = contact;
        contact.m_nodeB.other = bodyA;
        contact.m_nodeB.prev = null;
        contact.m_nodeB.next = bodyB.m_contactList;
        if (bodyB.m_contactList != null) {
          bodyB.m_contactList.prev = contact.m_nodeB;
        }
        bodyB.m_contactList = contact.m_nodeB;
        if (fixtureA.isSensor() == false && fixtureB.isSensor() == false) {
          bodyA.setAwake(true);
          bodyB.setAwake(true);
        }
        return contact;
      };
      Contact2.destroy = function(contact, listener) {
        var fixtureA = contact.m_fixtureA;
        var fixtureB = contact.m_fixtureB;
        if (fixtureA === null || fixtureB === null)
          return;
        var bodyA = fixtureA.m_body;
        var bodyB = fixtureB.m_body;
        if (bodyA === null || bodyB === null)
          return;
        if (contact.isTouching()) {
          listener.endContact(contact);
        }
        if (contact.m_nodeA.prev) {
          contact.m_nodeA.prev.next = contact.m_nodeA.next;
        }
        if (contact.m_nodeA.next) {
          contact.m_nodeA.next.prev = contact.m_nodeA.prev;
        }
        if (contact.m_nodeA == bodyA.m_contactList) {
          bodyA.m_contactList = contact.m_nodeA.next;
        }
        if (contact.m_nodeB.prev) {
          contact.m_nodeB.prev.next = contact.m_nodeB.next;
        }
        if (contact.m_nodeB.next) {
          contact.m_nodeB.next.prev = contact.m_nodeB.prev;
        }
        if (contact.m_nodeB == bodyB.m_contactList) {
          bodyB.m_contactList = contact.m_nodeB.next;
        }
        if (contact.m_manifold.pointCount > 0 && !fixtureA.m_isSensor && !fixtureB.m_isSensor) {
          bodyA.setAwake(true);
          bodyB.setAwake(true);
        }
        contactPool.release(contact);
      };
      return Contact2;
    }()
  );
  var DEFAULTS$b = {
    gravity: Vec2.zero(),
    allowSleep: true,
    warmStarting: true,
    continuousPhysics: true,
    subStepping: false,
    blockSolve: true,
    velocityIterations: 8,
    positionIterations: 3
  };
  var World = (
    /** @class */
    function() {
      function World2(def) {
        if (!(this instanceof World2)) {
          return new World2(def);
        }
        this.s_step = new TimeStep();
        if (!def) {
          def = {};
        } else if (Vec2.isValid(def)) {
          def = { gravity: def };
        }
        def = options(def, DEFAULTS$b);
        this.m_solver = new Solver(this);
        this.m_broadPhase = new BroadPhase();
        this.m_contactList = null;
        this.m_contactCount = 0;
        this.m_bodyList = null;
        this.m_bodyCount = 0;
        this.m_jointList = null;
        this.m_jointCount = 0;
        this.m_stepComplete = true;
        this.m_allowSleep = def.allowSleep;
        this.m_gravity = Vec2.clone(def.gravity);
        this.m_clearForces = true;
        this.m_newFixture = false;
        this.m_locked = false;
        this.m_warmStarting = def.warmStarting;
        this.m_continuousPhysics = def.continuousPhysics;
        this.m_subStepping = def.subStepping;
        this.m_blockSolve = def.blockSolve;
        this.m_velocityIterations = def.velocityIterations;
        this.m_positionIterations = def.positionIterations;
        this.m_t = 0;
        this.m_step_callback = [];
      }
      World2.prototype._serialize = function() {
        var bodies = [];
        var joints = [];
        for (var b2 = this.getBodyList(); b2; b2 = b2.getNext()) {
          bodies.push(b2);
        }
        for (var j = this.getJointList(); j; j = j.getNext()) {
          if (typeof j._serialize === "function") {
            joints.push(j);
          }
        }
        return {
          gravity: this.m_gravity,
          bodies,
          joints
        };
      };
      World2._deserialize = function(data, context, restore) {
        if (!data) {
          return new World2();
        }
        var world = new World2(data.gravity);
        if (data.bodies) {
          for (var i = data.bodies.length - 1; i >= 0; i -= 1) {
            world._addBody(restore(Body, data.bodies[i], world));
          }
        }
        if (data.joints) {
          for (var i = data.joints.length - 1; i >= 0; i--) {
            world.createJoint(restore(Joint, data.joints[i], world));
          }
        }
        return world;
      };
      World2.prototype.getBodyList = function() {
        return this.m_bodyList;
      };
      World2.prototype.getJointList = function() {
        return this.m_jointList;
      };
      World2.prototype.getContactList = function() {
        return this.m_contactList;
      };
      World2.prototype.getBodyCount = function() {
        return this.m_bodyCount;
      };
      World2.prototype.getJointCount = function() {
        return this.m_jointCount;
      };
      World2.prototype.getContactCount = function() {
        return this.m_contactCount;
      };
      World2.prototype.setGravity = function(gravity) {
        this.m_gravity.set(gravity);
      };
      World2.prototype.getGravity = function() {
        return this.m_gravity;
      };
      World2.prototype.isLocked = function() {
        return this.m_locked;
      };
      World2.prototype.setAllowSleeping = function(flag) {
        if (flag == this.m_allowSleep) {
          return;
        }
        this.m_allowSleep = flag;
        if (this.m_allowSleep == false) {
          for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {
            b2.setAwake(true);
          }
        }
      };
      World2.prototype.getAllowSleeping = function() {
        return this.m_allowSleep;
      };
      World2.prototype.setWarmStarting = function(flag) {
        this.m_warmStarting = flag;
      };
      World2.prototype.getWarmStarting = function() {
        return this.m_warmStarting;
      };
      World2.prototype.setContinuousPhysics = function(flag) {
        this.m_continuousPhysics = flag;
      };
      World2.prototype.getContinuousPhysics = function() {
        return this.m_continuousPhysics;
      };
      World2.prototype.setSubStepping = function(flag) {
        this.m_subStepping = flag;
      };
      World2.prototype.getSubStepping = function() {
        return this.m_subStepping;
      };
      World2.prototype.setAutoClearForces = function(flag) {
        this.m_clearForces = flag;
      };
      World2.prototype.getAutoClearForces = function() {
        return this.m_clearForces;
      };
      World2.prototype.clearForces = function() {
        for (var body = this.m_bodyList; body; body = body.getNext()) {
          body.m_force.setZero();
          body.m_torque = 0;
        }
      };
      World2.prototype.queryAABB = function(aabb, callback) {
        var broadPhase = this.m_broadPhase;
        this.m_broadPhase.query(aabb, function(proxyId) {
          var proxy = broadPhase.getUserData(proxyId);
          return callback(proxy.fixture);
        });
      };
      World2.prototype.rayCast = function(point1, point2, callback) {
        var broadPhase = this.m_broadPhase;
        this.m_broadPhase.rayCast({
          maxFraction: 1,
          p1: point1,
          p2: point2
        }, function(input2, proxyId) {
          var proxy = broadPhase.getUserData(proxyId);
          var fixture = proxy.fixture;
          var index = proxy.childIndex;
          var output2 = {};
          var hit = fixture.rayCast(output2, input2, index);
          if (hit) {
            var fraction = output2.fraction;
            var point3 = Vec2.add(Vec2.mulNumVec2(1 - fraction, input2.p1), Vec2.mulNumVec2(fraction, input2.p2));
            return callback(fixture, point3, output2.normal, fraction);
          }
          return input2.maxFraction;
        });
      };
      World2.prototype.getProxyCount = function() {
        return this.m_broadPhase.getProxyCount();
      };
      World2.prototype.getTreeHeight = function() {
        return this.m_broadPhase.getTreeHeight();
      };
      World2.prototype.getTreeBalance = function() {
        return this.m_broadPhase.getTreeBalance();
      };
      World2.prototype.getTreeQuality = function() {
        return this.m_broadPhase.getTreeQuality();
      };
      World2.prototype.shiftOrigin = function(newOrigin) {
        if (this.isLocked()) {
          return;
        }
        for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {
          b2.m_xf.p.sub(newOrigin);
          b2.m_sweep.c0.sub(newOrigin);
          b2.m_sweep.c.sub(newOrigin);
        }
        for (var j = this.m_jointList; j; j = j.m_next) {
          j.shiftOrigin(newOrigin);
        }
        this.m_broadPhase.shiftOrigin(newOrigin);
      };
      World2.prototype._addBody = function(body) {
        if (this.isLocked()) {
          return;
        }
        body.m_prev = null;
        body.m_next = this.m_bodyList;
        if (this.m_bodyList) {
          this.m_bodyList.m_prev = body;
        }
        this.m_bodyList = body;
        ++this.m_bodyCount;
      };
      World2.prototype.createBody = function(arg1, arg2) {
        if (this.isLocked()) {
          return null;
        }
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        var body = new Body(this, def);
        this._addBody(body);
        return body;
      };
      World2.prototype.createDynamicBody = function(arg1, arg2) {
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        def.type = "dynamic";
        return this.createBody(def);
      };
      World2.prototype.createKinematicBody = function(arg1, arg2) {
        var def = {};
        if (!arg1) ;
        else if (Vec2.isValid(arg1)) {
          def = { position: arg1, angle: arg2 };
        } else if (typeof arg1 === "object") {
          def = arg1;
        }
        def.type = "kinematic";
        return this.createBody(def);
      };
      World2.prototype.destroyBody = function(b2) {
        if (this.isLocked()) {
          return;
        }
        if (b2.m_destroyed) {
          return false;
        }
        var je = b2.m_jointList;
        while (je) {
          var je0 = je;
          je = je.next;
          this.publish("remove-joint", je0.joint);
          this.destroyJoint(je0.joint);
          b2.m_jointList = je;
        }
        b2.m_jointList = null;
        var ce = b2.m_contactList;
        while (ce) {
          var ce0 = ce;
          ce = ce.next;
          this.destroyContact(ce0.contact);
          b2.m_contactList = ce;
        }
        b2.m_contactList = null;
        var f = b2.m_fixtureList;
        while (f) {
          var f0 = f;
          f = f.m_next;
          this.publish("remove-fixture", f0);
          f0.destroyProxies(this.m_broadPhase);
          b2.m_fixtureList = f;
        }
        b2.m_fixtureList = null;
        if (b2.m_prev) {
          b2.m_prev.m_next = b2.m_next;
        }
        if (b2.m_next) {
          b2.m_next.m_prev = b2.m_prev;
        }
        if (b2 == this.m_bodyList) {
          this.m_bodyList = b2.m_next;
        }
        b2.m_destroyed = true;
        --this.m_bodyCount;
        this.publish("remove-body", b2);
        return true;
      };
      World2.prototype.createJoint = function(joint) {
        if (this.isLocked()) {
          return null;
        }
        joint.m_prev = null;
        joint.m_next = this.m_jointList;
        if (this.m_jointList) {
          this.m_jointList.m_prev = joint;
        }
        this.m_jointList = joint;
        ++this.m_jointCount;
        joint.m_edgeA.joint = joint;
        joint.m_edgeA.other = joint.m_bodyB;
        joint.m_edgeA.prev = null;
        joint.m_edgeA.next = joint.m_bodyA.m_jointList;
        if (joint.m_bodyA.m_jointList)
          joint.m_bodyA.m_jointList.prev = joint.m_edgeA;
        joint.m_bodyA.m_jointList = joint.m_edgeA;
        joint.m_edgeB.joint = joint;
        joint.m_edgeB.other = joint.m_bodyA;
        joint.m_edgeB.prev = null;
        joint.m_edgeB.next = joint.m_bodyB.m_jointList;
        if (joint.m_bodyB.m_jointList)
          joint.m_bodyB.m_jointList.prev = joint.m_edgeB;
        joint.m_bodyB.m_jointList = joint.m_edgeB;
        if (joint.m_collideConnected == false) {
          for (var edge = joint.m_bodyB.getContactList(); edge; edge = edge.next) {
            if (edge.other == joint.m_bodyA) {
              edge.contact.flagForFiltering();
            }
          }
        }
        return joint;
      };
      World2.prototype.destroyJoint = function(joint) {
        if (this.isLocked()) {
          return;
        }
        if (joint.m_prev) {
          joint.m_prev.m_next = joint.m_next;
        }
        if (joint.m_next) {
          joint.m_next.m_prev = joint.m_prev;
        }
        if (joint == this.m_jointList) {
          this.m_jointList = joint.m_next;
        }
        var bodyA = joint.m_bodyA;
        var bodyB = joint.m_bodyB;
        bodyA.setAwake(true);
        bodyB.setAwake(true);
        if (joint.m_edgeA.prev) {
          joint.m_edgeA.prev.next = joint.m_edgeA.next;
        }
        if (joint.m_edgeA.next) {
          joint.m_edgeA.next.prev = joint.m_edgeA.prev;
        }
        if (joint.m_edgeA == bodyA.m_jointList) {
          bodyA.m_jointList = joint.m_edgeA.next;
        }
        joint.m_edgeA.prev = null;
        joint.m_edgeA.next = null;
        if (joint.m_edgeB.prev) {
          joint.m_edgeB.prev.next = joint.m_edgeB.next;
        }
        if (joint.m_edgeB.next) {
          joint.m_edgeB.next.prev = joint.m_edgeB.prev;
        }
        if (joint.m_edgeB == bodyB.m_jointList) {
          bodyB.m_jointList = joint.m_edgeB.next;
        }
        joint.m_edgeB.prev = null;
        joint.m_edgeB.next = null;
        --this.m_jointCount;
        if (joint.m_collideConnected == false) {
          var edge = bodyB.getContactList();
          while (edge) {
            if (edge.other == bodyA) {
              edge.contact.flagForFiltering();
            }
            edge = edge.next;
          }
        }
        this.publish("remove-joint", joint);
      };
      World2.prototype.step = function(timeStep, velocityIterations, positionIterations) {
        this.publish("pre-step", timeStep);
        if ((velocityIterations | 0) !== velocityIterations) {
          velocityIterations = 0;
        }
        velocityIterations = velocityIterations || this.m_velocityIterations;
        positionIterations = positionIterations || this.m_positionIterations;
        if (this.m_newFixture) {
          this.findNewContacts();
          this.m_newFixture = false;
        }
        this.m_locked = true;
        this.s_step.reset(timeStep);
        this.s_step.velocityIterations = velocityIterations;
        this.s_step.positionIterations = positionIterations;
        this.s_step.warmStarting = this.m_warmStarting;
        this.s_step.blockSolve = this.m_blockSolve;
        this.updateContacts();
        if (this.m_stepComplete && timeStep > 0) {
          this.m_solver.solveWorld(this.s_step);
          for (var b2 = this.m_bodyList; b2; b2 = b2.getNext()) {
            if (b2.m_islandFlag == false) {
              continue;
            }
            if (b2.isStatic()) {
              continue;
            }
            b2.synchronizeFixtures();
          }
          this.findNewContacts();
        }
        if (this.m_continuousPhysics && timeStep > 0) {
          this.m_solver.solveWorldTOI(this.s_step);
        }
        if (this.m_clearForces) {
          this.clearForces();
        }
        this.m_locked = false;
        var callback;
        while (callback = this.m_step_callback.shift()) {
          callback(this);
        }
        this.publish("post-step", timeStep);
      };
      World2.prototype.queueUpdate = function(callback) {
        if (!this.isLocked()) {
          callback(this);
        } else {
          this.m_step_callback.push(callback);
        }
      };
      World2.prototype.findNewContacts = function() {
        var _this = this;
        this.m_broadPhase.updatePairs(function(proxyA, proxyB) {
          return _this.createContact(proxyA, proxyB);
        });
      };
      World2.prototype.createContact = function(proxyA, proxyB) {
        var fixtureA = proxyA.fixture;
        var fixtureB = proxyB.fixture;
        var indexA = proxyA.childIndex;
        var indexB = proxyB.childIndex;
        var bodyA = fixtureA.getBody();
        var bodyB = fixtureB.getBody();
        if (bodyA == bodyB) {
          return;
        }
        var edge = bodyB.getContactList();
        while (edge) {
          if (edge.other == bodyA) {
            var fA = edge.contact.getFixtureA();
            var fB = edge.contact.getFixtureB();
            var iA = edge.contact.getChildIndexA();
            var iB = edge.contact.getChildIndexB();
            if (fA == fixtureA && fB == fixtureB && iA == indexA && iB == indexB) {
              return;
            }
            if (fA == fixtureB && fB == fixtureA && iA == indexB && iB == indexA) {
              return;
            }
          }
          edge = edge.next;
        }
        if (bodyB.shouldCollide(bodyA) == false) {
          return;
        }
        if (fixtureB.shouldCollide(fixtureA) == false) {
          return;
        }
        var contact = Contact.create(fixtureA, indexA, fixtureB, indexB);
        if (contact == null) {
          return;
        }
        contact.m_prev = null;
        if (this.m_contactList != null) {
          contact.m_next = this.m_contactList;
          this.m_contactList.m_prev = contact;
        }
        this.m_contactList = contact;
        ++this.m_contactCount;
      };
      World2.prototype.updateContacts = function() {
        var c2;
        var next_c = this.m_contactList;
        while (c2 = next_c) {
          next_c = c2.getNext();
          var fixtureA = c2.getFixtureA();
          var fixtureB = c2.getFixtureB();
          var indexA = c2.getChildIndexA();
          var indexB = c2.getChildIndexB();
          var bodyA = fixtureA.getBody();
          var bodyB = fixtureB.getBody();
          if (c2.m_filterFlag) {
            if (bodyB.shouldCollide(bodyA) == false) {
              this.destroyContact(c2);
              continue;
            }
            if (fixtureB.shouldCollide(fixtureA) == false) {
              this.destroyContact(c2);
              continue;
            }
            c2.m_filterFlag = false;
          }
          var activeA = bodyA.isAwake() && !bodyA.isStatic();
          var activeB = bodyB.isAwake() && !bodyB.isStatic();
          if (activeA == false && activeB == false) {
            continue;
          }
          var proxyIdA = fixtureA.m_proxies[indexA].proxyId;
          var proxyIdB = fixtureB.m_proxies[indexB].proxyId;
          var overlap = this.m_broadPhase.testOverlap(proxyIdA, proxyIdB);
          if (overlap == false) {
            this.destroyContact(c2);
            continue;
          }
          c2.update(this);
        }
      };
      World2.prototype.destroyContact = function(contact) {
        if (contact.m_prev) {
          contact.m_prev.m_next = contact.m_next;
        }
        if (contact.m_next) {
          contact.m_next.m_prev = contact.m_prev;
        }
        if (contact == this.m_contactList) {
          this.m_contactList = contact.m_next;
        }
        Contact.destroy(contact, this);
        --this.m_contactCount;
      };
      World2.prototype.on = function(name, listener) {
        if (typeof name !== "string" || typeof listener !== "function") {
          return this;
        }
        if (!this._listeners) {
          this._listeners = {};
        }
        if (!this._listeners[name]) {
          this._listeners[name] = [];
        }
        this._listeners[name].push(listener);
        return this;
      };
      World2.prototype.off = function(name, listener) {
        if (typeof name !== "string" || typeof listener !== "function") {
          return this;
        }
        var listeners = this._listeners && this._listeners[name];
        if (!listeners || !listeners.length) {
          return this;
        }
        var index = listeners.indexOf(listener);
        if (index >= 0) {
          listeners.splice(index, 1);
        }
        return this;
      };
      World2.prototype.publish = function(name, arg1, arg2, arg3) {
        var listeners = this._listeners && this._listeners[name];
        if (!listeners || !listeners.length) {
          return 0;
        }
        for (var l = 0; l < listeners.length; l++) {
          listeners[l].call(this, arg1, arg2, arg3);
        }
        return listeners.length;
      };
      World2.prototype.beginContact = function(contact) {
        this.publish("begin-contact", contact);
      };
      World2.prototype.endContact = function(contact) {
        this.publish("end-contact", contact);
      };
      World2.prototype.preSolve = function(contact, oldManifold2) {
        this.publish("pre-solve", contact, oldManifold2);
      };
      World2.prototype.postSolve = function(contact, impulse) {
        this.publish("post-solve", contact, impulse);
      };
      return World2;
    }()
  );
  var Vec3 = (
    /** @class */
    function() {
      function Vec32(x2, y, z) {
        if (!(this instanceof Vec32)) {
          return new Vec32(x2, y, z);
        }
        if (typeof x2 === "undefined") {
          this.x = 0;
          this.y = 0;
          this.z = 0;
        } else if (typeof x2 === "object") {
          this.x = x2.x;
          this.y = x2.y;
          this.z = x2.z;
        } else {
          this.x = x2;
          this.y = y;
          this.z = z;
        }
      }
      Vec32.prototype._serialize = function() {
        return {
          x: this.x,
          y: this.y,
          z: this.z
        };
      };
      Vec32._deserialize = function(data) {
        var obj = Object.create(Vec32.prototype);
        obj.x = data.x;
        obj.y = data.y;
        obj.z = data.z;
        return obj;
      };
      Vec32.neo = function(x2, y, z) {
        var obj = Object.create(Vec32.prototype);
        obj.x = x2;
        obj.y = y;
        obj.z = z;
        return obj;
      };
      Vec32.zero = function() {
        var obj = Object.create(Vec32.prototype);
        obj.x = 0;
        obj.y = 0;
        obj.z = 0;
        return obj;
      };
      Vec32.clone = function(v3) {
        return Vec32.neo(v3.x, v3.y, v3.z);
      };
      Vec32.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Vec32.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Number.isFinite(obj.x) && Number.isFinite(obj.y) && Number.isFinite(obj.z);
      };
      Vec32.assert = function(o) {
      };
      Vec32.prototype.setZero = function() {
        this.x = 0;
        this.y = 0;
        this.z = 0;
        return this;
      };
      Vec32.prototype.set = function(x2, y, z) {
        this.x = x2;
        this.y = y;
        this.z = z;
        return this;
      };
      Vec32.prototype.add = function(w) {
        this.x += w.x;
        this.y += w.y;
        this.z += w.z;
        return this;
      };
      Vec32.prototype.sub = function(w) {
        this.x -= w.x;
        this.y -= w.y;
        this.z -= w.z;
        return this;
      };
      Vec32.prototype.mul = function(m) {
        this.x *= m;
        this.y *= m;
        this.z *= m;
        return this;
      };
      Vec32.areEqual = function(v3, w) {
        return v3 === w || typeof v3 === "object" && v3 !== null && typeof w === "object" && w !== null && v3.x === w.x && v3.y === w.y && v3.z === w.z;
      };
      Vec32.dot = function(v3, w) {
        return v3.x * w.x + v3.y * w.y + v3.z * w.z;
      };
      Vec32.cross = function(v3, w) {
        return new Vec32(v3.y * w.z - v3.z * w.y, v3.z * w.x - v3.x * w.z, v3.x * w.y - v3.y * w.x);
      };
      Vec32.add = function(v3, w) {
        return new Vec32(v3.x + w.x, v3.y + w.y, v3.z + w.z);
      };
      Vec32.sub = function(v3, w) {
        return new Vec32(v3.x - w.x, v3.y - w.y, v3.z - w.z);
      };
      Vec32.mul = function(v3, m) {
        return new Vec32(m * v3.x, m * v3.y, m * v3.z);
      };
      Vec32.prototype.neg = function() {
        this.x = -this.x;
        this.y = -this.y;
        this.z = -this.z;
        return this;
      };
      Vec32.neg = function(v3) {
        return new Vec32(-v3.x, -v3.y, -v3.z);
      };
      return Vec32;
    }()
  );
  var v1$2 = vec2(0, 0);
  var v2$1 = vec2(0, 0);
  var EdgeShape = (
    /** @class */
    function(_super) {
      __extends(EdgeShape2, _super);
      function EdgeShape2(v122, v22) {
        var _this = this;
        if (!(_this instanceof EdgeShape2)) {
          return new EdgeShape2(v122, v22);
        }
        _this = _super.call(this) || this;
        _this.m_type = EdgeShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_vertex1 = v122 ? Vec2.clone(v122) : Vec2.zero();
        _this.m_vertex2 = v22 ? Vec2.clone(v22) : Vec2.zero();
        _this.m_vertex0 = Vec2.zero();
        _this.m_vertex3 = Vec2.zero();
        _this.m_hasVertex0 = false;
        _this.m_hasVertex3 = false;
        return _this;
      }
      EdgeShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          vertex1: this.m_vertex1,
          vertex2: this.m_vertex2,
          vertex0: this.m_vertex0,
          vertex3: this.m_vertex3,
          hasVertex0: this.m_hasVertex0,
          hasVertex3: this.m_hasVertex3
        };
      };
      EdgeShape2._deserialize = function(data) {
        var shape = new EdgeShape2(data.vertex1, data.vertex2);
        if (shape.m_hasVertex0) {
          shape.setPrevVertex(data.vertex0);
        }
        if (shape.m_hasVertex3) {
          shape.setNextVertex(data.vertex3);
        }
        return shape;
      };
      EdgeShape2.prototype._reset = function() {
      };
      EdgeShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      EdgeShape2.prototype.getType = function() {
        return this.m_type;
      };
      EdgeShape2.prototype.setNext = function(v3) {
        return this.setNextVertex(v3);
      };
      EdgeShape2.prototype.setNextVertex = function(v3) {
        if (v3) {
          this.m_vertex3.setVec2(v3);
          this.m_hasVertex3 = true;
        } else {
          this.m_vertex3.setZero();
          this.m_hasVertex3 = false;
        }
        return this;
      };
      EdgeShape2.prototype.getNextVertex = function() {
        return this.m_vertex3;
      };
      EdgeShape2.prototype.setPrev = function(v3) {
        return this.setPrevVertex(v3);
      };
      EdgeShape2.prototype.setPrevVertex = function(v3) {
        if (v3) {
          this.m_vertex0.setVec2(v3);
          this.m_hasVertex0 = true;
        } else {
          this.m_vertex0.setZero();
          this.m_hasVertex0 = false;
        }
        return this;
      };
      EdgeShape2.prototype.getPrevVertex = function() {
        return this.m_vertex0;
      };
      EdgeShape2.prototype._set = function(v122, v22) {
        this.m_vertex1.setVec2(v122);
        this.m_vertex2.setVec2(v22);
        this.m_hasVertex0 = false;
        this.m_hasVertex3 = false;
        return this;
      };
      EdgeShape2.prototype._clone = function() {
        var clone = new EdgeShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_vertex1.setVec2(this.m_vertex1);
        clone.m_vertex2.setVec2(this.m_vertex2);
        clone.m_vertex0.setVec2(this.m_vertex0);
        clone.m_vertex3.setVec2(this.m_vertex3);
        clone.m_hasVertex0 = this.m_hasVertex0;
        clone.m_hasVertex3 = this.m_hasVertex3;
        return clone;
      };
      EdgeShape2.prototype.getChildCount = function() {
        return 1;
      };
      EdgeShape2.prototype.testPoint = function(xf2, p) {
        return false;
      };
      EdgeShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));
        var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));
        var d2 = Vec2.sub(p2, p1);
        var v122 = this.m_vertex1;
        var v22 = this.m_vertex2;
        var e3 = Vec2.sub(v22, v122);
        var normal3 = Vec2.neo(e3.y, -e3.x);
        normal3.normalize();
        var numerator = Vec2.dot(normal3, Vec2.sub(v122, p1));
        var denominator = Vec2.dot(normal3, d2);
        if (denominator == 0) {
          return false;
        }
        var t = numerator / denominator;
        if (t < 0 || input2.maxFraction < t) {
          return false;
        }
        var q = Vec2.add(p1, Vec2.mulNumVec2(t, d2));
        var r = Vec2.sub(v22, v122);
        var rr = Vec2.dot(r, r);
        if (rr == 0) {
          return false;
        }
        var s2 = Vec2.dot(Vec2.sub(q, v122), r) / rr;
        if (s2 < 0 || 1 < s2) {
          return false;
        }
        output2.fraction = t;
        if (numerator > 0) {
          output2.normal = Rot.mulVec2(xf2.q, normal3).neg();
        } else {
          output2.normal = Rot.mulVec2(xf2.q, normal3);
        }
        return true;
      };
      EdgeShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        transformVec2(v1$2, xf2, this.m_vertex1);
        transformVec2(v2$1, xf2, this.m_vertex2);
        AABB.combinePoints(aabb, v1$2, v2$1);
        AABB.extend(aabb, this.m_radius);
      };
      EdgeShape2.prototype.computeMass = function(massData, density) {
        massData.mass = 0;
        combine2Vec2(massData.center, 0.5, this.m_vertex1, 0.5, this.m_vertex2);
        massData.I = 0;
      };
      EdgeShape2.prototype.computeDistanceProxy = function(proxy) {
        proxy.m_vertices[0] = this.m_vertex1;
        proxy.m_vertices[1] = this.m_vertex2;
        proxy.m_vertices.length = 2;
        proxy.m_count = 2;
        proxy.m_radius = this.m_radius;
      };
      EdgeShape2.TYPE = "edge";
      return EdgeShape2;
    }(Shape)
  );
  var v1$1 = vec2(0, 0);
  var v2 = vec2(0, 0);
  var ChainShape = (
    /** @class */
    function(_super) {
      __extends(ChainShape2, _super);
      function ChainShape2(vertices, loop) {
        var _this = this;
        if (!(_this instanceof ChainShape2)) {
          return new ChainShape2(vertices, loop);
        }
        _this = _super.call(this) || this;
        _this.m_type = ChainShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_vertices = [];
        _this.m_count = 0;
        _this.m_prevVertex = null;
        _this.m_nextVertex = null;
        _this.m_hasPrevVertex = false;
        _this.m_hasNextVertex = false;
        _this.m_isLoop = !!loop;
        if (vertices && vertices.length) {
          if (loop) {
            _this._createLoop(vertices);
          } else {
            _this._createChain(vertices);
          }
        }
        return _this;
      }
      ChainShape2.prototype._serialize = function() {
        var data = {
          type: this.m_type,
          vertices: this.m_isLoop ? this.m_vertices.slice(0, this.m_vertices.length - 1) : this.m_vertices,
          isLoop: this.m_isLoop,
          hasPrevVertex: this.m_hasPrevVertex,
          hasNextVertex: this.m_hasNextVertex,
          prevVertex: null,
          nextVertex: null
        };
        if (this.m_prevVertex) {
          data.prevVertex = this.m_prevVertex;
        }
        if (this.m_nextVertex) {
          data.nextVertex = this.m_nextVertex;
        }
        return data;
      };
      ChainShape2._deserialize = function(data, fixture, restore) {
        var vertices = [];
        if (data.vertices) {
          for (var i = 0; i < data.vertices.length; i++) {
            vertices.push(restore(Vec2, data.vertices[i]));
          }
        }
        var shape = new ChainShape2(vertices, data.isLoop);
        if (data.prevVertex) {
          shape.setPrevVertex(data.prevVertex);
        }
        if (data.nextVertex) {
          shape.setNextVertex(data.nextVertex);
        }
        return shape;
      };
      ChainShape2.prototype.getType = function() {
        return this.m_type;
      };
      ChainShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      ChainShape2.prototype._createLoop = function(vertices) {
        if (vertices.length < 3) {
          return;
        }
        var i;
        this.m_vertices = [];
        this.m_count = vertices.length + 1;
        for (var i = 0; i < vertices.length; ++i) {
          this.m_vertices[i] = Vec2.clone(vertices[i]);
        }
        this.m_vertices[vertices.length] = Vec2.clone(vertices[0]);
        this.m_prevVertex = this.m_vertices[this.m_count - 2];
        this.m_nextVertex = this.m_vertices[1];
        this.m_hasPrevVertex = true;
        this.m_hasNextVertex = true;
        return this;
      };
      ChainShape2.prototype._createChain = function(vertices) {
        var i;
        this.m_vertices = [];
        this.m_count = vertices.length;
        for (var i = 0; i < vertices.length; ++i) {
          this.m_vertices[i] = Vec2.clone(vertices[i]);
        }
        this.m_prevVertex = null;
        this.m_nextVertex = null;
        this.m_hasPrevVertex = false;
        this.m_hasNextVertex = false;
        return this;
      };
      ChainShape2.prototype._reset = function() {
        if (this.m_isLoop) {
          this._createLoop(this.m_vertices.slice(0, this.m_vertices.length - 1));
        } else {
          this._createChain(this.m_vertices);
        }
      };
      ChainShape2.prototype.setPrevVertex = function(prevVertex) {
        this.m_prevVertex = prevVertex;
        this.m_hasPrevVertex = true;
      };
      ChainShape2.prototype.getPrevVertex = function() {
        return this.m_prevVertex;
      };
      ChainShape2.prototype.setNextVertex = function(nextVertex) {
        this.m_nextVertex = nextVertex;
        this.m_hasNextVertex = true;
      };
      ChainShape2.prototype.getNextVertex = function() {
        return this.m_nextVertex;
      };
      ChainShape2.prototype._clone = function() {
        var clone = new ChainShape2();
        clone._createChain(this.m_vertices);
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_prevVertex = this.m_prevVertex;
        clone.m_nextVertex = this.m_nextVertex;
        clone.m_hasPrevVertex = this.m_hasPrevVertex;
        clone.m_hasNextVertex = this.m_hasNextVertex;
        return clone;
      };
      ChainShape2.prototype.getChildCount = function() {
        return this.m_count - 1;
      };
      ChainShape2.prototype.getChildEdge = function(edge, childIndex) {
        edge.m_type = EdgeShape.TYPE;
        edge.m_radius = this.m_radius;
        edge.m_vertex1 = this.m_vertices[childIndex];
        edge.m_vertex2 = this.m_vertices[childIndex + 1];
        if (childIndex > 0) {
          edge.m_vertex0 = this.m_vertices[childIndex - 1];
          edge.m_hasVertex0 = true;
        } else {
          edge.m_vertex0 = this.m_prevVertex;
          edge.m_hasVertex0 = this.m_hasPrevVertex;
        }
        if (childIndex < this.m_count - 2) {
          edge.m_vertex3 = this.m_vertices[childIndex + 2];
          edge.m_hasVertex3 = true;
        } else {
          edge.m_vertex3 = this.m_nextVertex;
          edge.m_hasVertex3 = this.m_hasNextVertex;
        }
      };
      ChainShape2.prototype.getVertex = function(index) {
        if (index < this.m_count) {
          return this.m_vertices[index];
        } else {
          return this.m_vertices[0];
        }
      };
      ChainShape2.prototype.isLoop = function() {
        return this.m_isLoop;
      };
      ChainShape2.prototype.testPoint = function(xf2, p) {
        return false;
      };
      ChainShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var edgeShape = new EdgeShape(this.getVertex(childIndex), this.getVertex(childIndex + 1));
        return edgeShape.rayCast(output2, input2, xf2, 0);
      };
      ChainShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        transformVec2(v1$1, xf2, this.getVertex(childIndex));
        transformVec2(v2, xf2, this.getVertex(childIndex + 1));
        AABB.combinePoints(aabb, v1$1, v2);
      };
      ChainShape2.prototype.computeMass = function(massData, density) {
        massData.mass = 0;
        zeroVec2(massData.center);
        massData.I = 0;
      };
      ChainShape2.prototype.computeDistanceProxy = function(proxy, childIndex) {
        proxy.m_vertices[0] = this.getVertex(childIndex);
        proxy.m_vertices[1] = this.getVertex(childIndex + 1);
        proxy.m_count = 2;
        proxy.m_radius = this.m_radius;
      };
      ChainShape2.TYPE = "chain";
      return ChainShape2;
    }(Shape)
  );
  var math_max$1 = Math.max;
  var math_min$3 = Math.min;
  var temp$1 = vec2(0, 0);
  var e$1 = vec2(0, 0);
  var e1$1 = vec2(0, 0);
  var e2$1 = vec2(0, 0);
  var center = vec2(0, 0);
  var s = vec2(0, 0);
  var PolygonShape = (
    /** @class */
    function(_super) {
      __extends(PolygonShape2, _super);
      function PolygonShape2(vertices) {
        var _this = this;
        if (!(_this instanceof PolygonShape2)) {
          return new PolygonShape2(vertices);
        }
        _this = _super.call(this) || this;
        _this.m_type = PolygonShape2.TYPE;
        _this.m_radius = SettingsInternal.polygonRadius;
        _this.m_centroid = Vec2.zero();
        _this.m_vertices = [];
        _this.m_normals = [];
        _this.m_count = 0;
        if (vertices && vertices.length) {
          _this._set(vertices);
        }
        return _this;
      }
      PolygonShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          vertices: this.m_vertices
        };
      };
      PolygonShape2._deserialize = function(data, fixture, restore) {
        var vertices = [];
        if (data.vertices) {
          for (var i = 0; i < data.vertices.length; i++) {
            vertices.push(restore(Vec2, data.vertices[i]));
          }
        }
        var shape = new PolygonShape2(vertices);
        return shape;
      };
      PolygonShape2.prototype.getType = function() {
        return this.m_type;
      };
      PolygonShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      PolygonShape2.prototype._clone = function() {
        var clone = new PolygonShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_count = this.m_count;
        clone.m_centroid.setVec2(this.m_centroid);
        for (var i = 0; i < this.m_count; i++) {
          clone.m_vertices.push(this.m_vertices[i].clone());
        }
        for (var i = 0; i < this.m_normals.length; i++) {
          clone.m_normals.push(this.m_normals[i].clone());
        }
        return clone;
      };
      PolygonShape2.prototype.getChildCount = function() {
        return 1;
      };
      PolygonShape2.prototype._reset = function() {
        this._set(this.m_vertices);
      };
      PolygonShape2.prototype._set = function(vertices) {
        if (vertices.length < 3) {
          this._setAsBox(1, 1);
          return;
        }
        var n2 = math_min$3(vertices.length, SettingsInternal.maxPolygonVertices);
        var ps = [];
        for (var i = 0; i < n2; ++i) {
          var v3 = vertices[i];
          var unique = true;
          for (var j = 0; j < ps.length; ++j) {
            if (Vec2.distanceSquared(v3, ps[j]) < 0.25 * SettingsInternal.linearSlopSquared) {
              unique = false;
              break;
            }
          }
          if (unique) {
            ps.push(Vec2.clone(v3));
          }
        }
        n2 = ps.length;
        if (n2 < 3) {
          this._setAsBox(1, 1);
          return;
        }
        var i0 = 0;
        var x0 = ps[0].x;
        for (var i = 1; i < n2; ++i) {
          var x2 = ps[i].x;
          if (x2 > x0 || x2 === x0 && ps[i].y < ps[i0].y) {
            i0 = i;
            x0 = x2;
          }
        }
        var hull = [];
        var m = 0;
        var ih = i0;
        while (true) {
          hull[m] = ih;
          var ie2 = 0;
          for (var j = 1; j < n2; ++j) {
            if (ie2 === ih) {
              ie2 = j;
              continue;
            }
            var r = Vec2.sub(ps[ie2], ps[hull[m]]);
            var v3 = Vec2.sub(ps[j], ps[hull[m]]);
            var c2 = Vec2.crossVec2Vec2(r, v3);
            if (c2 < 0) {
              ie2 = j;
            }
            if (c2 === 0 && v3.lengthSquared() > r.lengthSquared()) {
              ie2 = j;
            }
          }
          ++m;
          ih = ie2;
          if (ie2 === i0) {
            break;
          }
        }
        if (m < 3) {
          this._setAsBox(1, 1);
          return;
        }
        this.m_count = m;
        this.m_vertices = [];
        for (var i = 0; i < m; ++i) {
          this.m_vertices[i] = ps[hull[i]];
        }
        for (var i = 0; i < m; ++i) {
          var i1 = i;
          var i2 = i + 1 < m ? i + 1 : 0;
          var edge = Vec2.sub(this.m_vertices[i2], this.m_vertices[i1]);
          this.m_normals[i] = Vec2.crossVec2Num(edge, 1);
          this.m_normals[i].normalize();
        }
        this.m_centroid = computeCentroid(this.m_vertices, m);
      };
      PolygonShape2.prototype._setAsBox = function(hx, hy, center2, angle) {
        this.m_vertices[0] = Vec2.neo(hx, -hy);
        this.m_vertices[1] = Vec2.neo(hx, hy);
        this.m_vertices[2] = Vec2.neo(-hx, hy);
        this.m_vertices[3] = Vec2.neo(-hx, -hy);
        this.m_normals[0] = Vec2.neo(1, 0);
        this.m_normals[1] = Vec2.neo(0, 1);
        this.m_normals[2] = Vec2.neo(-1, 0);
        this.m_normals[3] = Vec2.neo(0, -1);
        this.m_count = 4;
        if (center2 && Vec2.isValid(center2)) {
          angle = angle || 0;
          copyVec2(this.m_centroid, center2);
          var xf2 = Transform.identity();
          xf2.p.setVec2(center2);
          xf2.q.setAngle(angle);
          for (var i = 0; i < this.m_count; ++i) {
            this.m_vertices[i] = Transform.mulVec2(xf2, this.m_vertices[i]);
            this.m_normals[i] = Rot.mulVec2(xf2.q, this.m_normals[i]);
          }
        }
      };
      PolygonShape2.prototype.testPoint = function(xf2, p) {
        var pLocal = detransformVec2(temp$1, xf2, p);
        for (var i = 0; i < this.m_count; ++i) {
          var dot = dotVec2(this.m_normals[i], pLocal) - dotVec2(this.m_normals[i], this.m_vertices[i]);
          if (dot > 0) {
            return false;
          }
        }
        return true;
      };
      PolygonShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));
        var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));
        var d2 = Vec2.sub(p2, p1);
        var lower = 0;
        var upper = input2.maxFraction;
        var index = -1;
        for (var i = 0; i < this.m_count; ++i) {
          var numerator = Vec2.dot(this.m_normals[i], Vec2.sub(this.m_vertices[i], p1));
          var denominator = Vec2.dot(this.m_normals[i], d2);
          if (denominator == 0) {
            if (numerator < 0) {
              return false;
            }
          } else {
            if (denominator < 0 && numerator < lower * denominator) {
              lower = numerator / denominator;
              index = i;
            } else if (denominator > 0 && numerator < upper * denominator) {
              upper = numerator / denominator;
            }
          }
          if (upper < lower) {
            return false;
          }
        }
        if (index >= 0) {
          output2.fraction = lower;
          output2.normal = Rot.mulVec2(xf2.q, this.m_normals[index]);
          return true;
        }
        return false;
      };
      PolygonShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        var minX = Infinity;
        var minY = Infinity;
        var maxX = -Infinity;
        var maxY = -Infinity;
        for (var i = 0; i < this.m_count; ++i) {
          var v3 = transformVec2(temp$1, xf2, this.m_vertices[i]);
          minX = math_min$3(minX, v3.x);
          maxX = math_max$1(maxX, v3.x);
          minY = math_min$3(minY, v3.y);
          maxY = math_max$1(maxY, v3.y);
        }
        setVec2(aabb.lowerBound, minX - this.m_radius, minY - this.m_radius);
        setVec2(aabb.upperBound, maxX + this.m_radius, maxY + this.m_radius);
      };
      PolygonShape2.prototype.computeMass = function(massData, density) {
        zeroVec2(center);
        var area = 0;
        var I = 0;
        zeroVec2(s);
        for (var i = 0; i < this.m_count; ++i) {
          plusVec2(s, this.m_vertices[i]);
        }
        scaleVec2(s, 1 / this.m_count, s);
        var k_inv3 = 1 / 3;
        for (var i = 0; i < this.m_count; ++i) {
          subVec2(e1$1, this.m_vertices[i], s);
          if (i + 1 < this.m_count) {
            subVec2(e2$1, this.m_vertices[i + 1], s);
          } else {
            subVec2(e2$1, this.m_vertices[0], s);
          }
          var D = crossVec2Vec2(e1$1, e2$1);
          var triangleArea = 0.5 * D;
          area += triangleArea;
          combine2Vec2(temp$1, triangleArea * k_inv3, e1$1, triangleArea * k_inv3, e2$1);
          plusVec2(center, temp$1);
          var ex1 = e1$1.x;
          var ey1 = e1$1.y;
          var ex2 = e2$1.x;
          var ey2 = e2$1.y;
          var intx2 = ex1 * ex1 + ex2 * ex1 + ex2 * ex2;
          var inty2 = ey1 * ey1 + ey2 * ey1 + ey2 * ey2;
          I += 0.25 * k_inv3 * D * (intx2 + inty2);
        }
        massData.mass = density * area;
        scaleVec2(center, 1 / area, center);
        addVec2(massData.center, center, s);
        massData.I = density * I;
        massData.I += massData.mass * (dotVec2(massData.center, massData.center) - dotVec2(center, center));
      };
      PolygonShape2.prototype.validate = function() {
        for (var i = 0; i < this.m_count; ++i) {
          var i1 = i;
          var i2 = i < this.m_count - 1 ? i1 + 1 : 0;
          var p = this.m_vertices[i1];
          subVec2(e$1, this.m_vertices[i2], p);
          for (var j = 0; j < this.m_count; ++j) {
            if (j == i1 || j == i2) {
              continue;
            }
            var c2 = crossVec2Vec2(e$1, subVec2(temp$1, this.m_vertices[j], p));
            if (c2 < 0) {
              return false;
            }
          }
        }
        return true;
      };
      PolygonShape2.prototype.computeDistanceProxy = function(proxy) {
        for (var i = 0; i < this.m_count; ++i) {
          proxy.m_vertices[i] = this.m_vertices[i];
        }
        proxy.m_vertices.length = this.m_count;
        proxy.m_count = this.m_count;
        proxy.m_radius = this.m_radius;
      };
      PolygonShape2.TYPE = "polygon";
      return PolygonShape2;
    }(Shape)
  );
  function computeCentroid(vs, count) {
    var c2 = Vec2.zero();
    var area = 0;
    var pRef = Vec2.zero();
    var i;
    var inv3 = 1 / 3;
    for (var i = 0; i < count; ++i) {
      var p1 = pRef;
      var p2 = vs[i];
      var p3 = i + 1 < count ? vs[i + 1] : vs[0];
      var e1_1 = Vec2.sub(p2, p1);
      var e2_1 = Vec2.sub(p3, p1);
      var D = Vec2.crossVec2Vec2(e1_1, e2_1);
      var triangleArea = 0.5 * D;
      area += triangleArea;
      combine3Vec2(temp$1, 1, p1, 1, p2, 1, p3);
      plusScaleVec2(c2, triangleArea * inv3, temp$1);
    }
    c2.mul(1 / area);
    return c2;
  }
  var math_sqrt = Math.sqrt;
  var math_PI$4 = Math.PI;
  var temp = vec2(0, 0);
  var CircleShape = (
    /** @class */
    function(_super) {
      __extends(CircleShape2, _super);
      function CircleShape2(a2, b2) {
        var _this = this;
        if (!(_this instanceof CircleShape2)) {
          return new CircleShape2(a2, b2);
        }
        _this = _super.call(this) || this;
        _this.m_type = CircleShape2.TYPE;
        _this.m_p = Vec2.zero();
        _this.m_radius = 1;
        if (typeof a2 === "object" && Vec2.isValid(a2)) {
          _this.m_p.setVec2(a2);
          if (typeof b2 === "number") {
            _this.m_radius = b2;
          }
        } else if (typeof a2 === "number") {
          _this.m_radius = a2;
        }
        return _this;
      }
      CircleShape2.prototype._serialize = function() {
        return {
          type: this.m_type,
          p: this.m_p,
          radius: this.m_radius
        };
      };
      CircleShape2._deserialize = function(data) {
        return new CircleShape2(data.p, data.radius);
      };
      CircleShape2.prototype._reset = function() {
      };
      CircleShape2.prototype.getType = function() {
        return this.m_type;
      };
      CircleShape2.prototype.getRadius = function() {
        return this.m_radius;
      };
      CircleShape2.prototype.getCenter = function() {
        return this.m_p;
      };
      CircleShape2.prototype._clone = function() {
        var clone = new CircleShape2();
        clone.m_type = this.m_type;
        clone.m_radius = this.m_radius;
        clone.m_p = this.m_p.clone();
        return clone;
      };
      CircleShape2.prototype.getChildCount = function() {
        return 1;
      };
      CircleShape2.prototype.testPoint = function(xf2, p) {
        var center2 = transformVec2(temp, xf2, this.m_p);
        return distSqrVec2(p, center2) <= this.m_radius * this.m_radius;
      };
      CircleShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {
        var position = Vec2.add(xf2.p, Rot.mulVec2(xf2.q, this.m_p));
        var s2 = Vec2.sub(input2.p1, position);
        var b2 = Vec2.dot(s2, s2) - this.m_radius * this.m_radius;
        var r = Vec2.sub(input2.p2, input2.p1);
        var c2 = Vec2.dot(s2, r);
        var rr = Vec2.dot(r, r);
        var sigma = c2 * c2 - rr * b2;
        if (sigma < 0 || rr < EPSILON) {
          return false;
        }
        var a2 = -(c2 + math_sqrt(sigma));
        if (0 <= a2 && a2 <= input2.maxFraction * rr) {
          a2 /= rr;
          output2.fraction = a2;
          output2.normal = Vec2.add(s2, Vec2.mulNumVec2(a2, r));
          output2.normal.normalize();
          return true;
        }
        return false;
      };
      CircleShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {
        var p = transformVec2(temp, xf2, this.m_p);
        setVec2(aabb.lowerBound, p.x - this.m_radius, p.y - this.m_radius);
        setVec2(aabb.upperBound, p.x + this.m_radius, p.y + this.m_radius);
      };
      CircleShape2.prototype.computeMass = function(massData, density) {
        massData.mass = density * math_PI$4 * this.m_radius * this.m_radius;
        copyVec2(massData.center, this.m_p);
        massData.I = massData.mass * (0.5 * this.m_radius * this.m_radius + lengthSqrVec2(this.m_p));
      };
      CircleShape2.prototype.computeDistanceProxy = function(proxy) {
        proxy.m_vertices[0] = this.m_p;
        proxy.m_vertices.length = 1;
        proxy.m_count = 1;
        proxy.m_radius = this.m_radius;
      };
      CircleShape2.TYPE = "circle";
      return CircleShape2;
    }(Shape)
  );
  var math_abs$5 = Math.abs;
  var math_PI$3 = Math.PI;
  var DEFAULTS$a = {
    frequencyHz: 0,
    dampingRatio: 0
  };
  var DistanceJoint = (
    /** @class */
    function(_super) {
      __extends(DistanceJoint2, _super);
      function DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB) {
        var _this = this;
        if (!(_this instanceof DistanceJoint2)) {
          return new DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB);
        }
        if (bodyB && anchorA && "m_type" in anchorA && "x" in bodyB && "y" in bodyB) {
          var temp3 = bodyB;
          bodyB = anchorA;
          anchorA = temp3;
        }
        def = options(def, DEFAULTS$a);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = DistanceJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.zero());
        _this.m_length = Number.isFinite(def.length) ? def.length : Vec2.distance(bodyA.getWorldPoint(_this.m_localAnchorA), bodyB.getWorldPoint(_this.m_localAnchorB));
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_impulse = 0;
        _this.m_gamma = 0;
        _this.m_bias = 0;
        return _this;
      }
      DistanceJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          length: this.m_length,
          impulse: this.m_impulse,
          gamma: this.m_gamma,
          bias: this.m_bias
        };
      };
      DistanceJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new DistanceJoint2(data);
        return joint;
      };
      DistanceJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.length > 0) {
          this.m_length = +def.length;
        } else if (def.length < 0) ;
        else if (def.anchorA || def.anchorA || def.anchorA || def.anchorA) {
          this.m_length = Vec2.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA), this.m_bodyB.getWorldPoint(this.m_localAnchorB));
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      DistanceJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      DistanceJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      DistanceJoint2.prototype.setLength = function(length) {
        this.m_length = length;
      };
      DistanceJoint2.prototype.getLength = function() {
        return this.m_length;
      };
      DistanceJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      DistanceJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      DistanceJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      DistanceJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      DistanceJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      DistanceJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      DistanceJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);
      };
      DistanceJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      DistanceJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        this.m_u = Vec2.sub(Vec2.add(cB2, this.m_rB), Vec2.add(cA2, this.m_rA));
        var length = this.m_u.length();
        if (length > SettingsInternal.linearSlop) {
          this.m_u.mul(1 / length);
        } else {
          this.m_u.setNum(0, 0);
        }
        var crAu = Vec2.crossVec2Vec2(this.m_rA, this.m_u);
        var crBu = Vec2.crossVec2Vec2(this.m_rB, this.m_u);
        var invMass = this.m_invMassA + this.m_invIA * crAu * crAu + this.m_invMassB + this.m_invIB * crBu * crBu;
        this.m_mass = invMass != 0 ? 1 / invMass : 0;
        if (this.m_frequencyHz > 0) {
          var C = length - this.m_length;
          var omega = 2 * math_PI$3 * this.m_frequencyHz;
          var d2 = 2 * this.m_mass * this.m_dampingRatio * omega;
          var k = this.m_mass * omega * omega;
          var h = step.dt;
          this.m_gamma = h * (d2 + h * k);
          this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;
          this.m_bias = C * h * k * this.m_gamma;
          invMass += this.m_gamma;
          this.m_mass = invMass != 0 ? 1 / invMass : 0;
        } else {
          this.m_gamma = 0;
          this.m_bias = 0;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      DistanceJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));
        var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));
        var Cdot = Vec2.dot(this.m_u, vpB) - Vec2.dot(this.m_u, vpA);
        var impulse = -this.m_mass * (Cdot + this.m_bias + this.m_gamma * this.m_impulse);
        this.m_impulse += impulse;
        var P3 = Vec2.mulNumVec2(impulse, this.m_u);
        vA2.subMul(this.m_invMassA, P3);
        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
        vB2.addMul(this.m_invMassB, P3);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      DistanceJoint2.prototype.solvePositionConstraints = function(step) {
        if (this.m_frequencyHz > 0) {
          return true;
        }
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        var u = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));
        var length = u.normalize();
        var C = clamp(length - this.m_length, -SettingsInternal.maxLinearCorrection, SettingsInternal.maxLinearCorrection);
        var impulse = -this.m_mass * C;
        var P3 = Vec2.mulNumVec2(impulse, u);
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return math_abs$5(C) < SettingsInternal.linearSlop;
      };
      DistanceJoint2.TYPE = "distance-joint";
      return DistanceJoint2;
    }(Joint)
  );
  var DEFAULTS$9 = {
    maxForce: 0,
    maxTorque: 0
  };
  var FrictionJoint = (
    /** @class */
    function(_super) {
      __extends(FrictionJoint2, _super);
      function FrictionJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof FrictionJoint2)) {
          return new FrictionJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$9);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = FrictionJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_linearImpulse = Vec2.zero();
        _this.m_angularImpulse = 0;
        _this.m_maxForce = def.maxForce;
        _this.m_maxTorque = def.maxTorque;
        return _this;
      }
      FrictionJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          maxForce: this.m_maxForce,
          maxTorque: this.m_maxTorque,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB
        };
      };
      FrictionJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new FrictionJoint2(data);
        return joint;
      };
      FrictionJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.maxTorque)) {
          this.m_maxTorque = def.maxTorque;
        }
      };
      FrictionJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      FrictionJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      FrictionJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      FrictionJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      FrictionJoint2.prototype.setMaxTorque = function(torque) {
        this.m_maxTorque = torque;
      };
      FrictionJoint2.prototype.getMaxTorque = function() {
        return this.m_maxTorque;
      };
      FrictionJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      FrictionJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      FrictionJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);
      };
      FrictionJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_angularImpulse;
      };
      FrictionJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat22();
        K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;
        K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;
        this.m_linearMass = K.getInverse();
        this.m_angularMass = iA + iB;
        if (this.m_angularMass > 0) {
          this.m_angularMass = 1 / this.m_angularMass;
        }
        if (step.warmStarting) {
          this.m_linearImpulse.mul(step.dtRatio);
          this.m_angularImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);
        } else {
          this.m_linearImpulse.setZero();
          this.m_angularImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      FrictionJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var h = step.dt;
        {
          var Cdot = wB - wA;
          var impulse = -this.m_angularMass * Cdot;
          var oldImpulse = this.m_angularImpulse;
          var maxImpulse = h * this.m_maxTorque;
          this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_angularImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.sub(Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB)), Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA)));
          var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));
          var oldImpulse = this.m_linearImpulse;
          this.m_linearImpulse.add(impulse);
          var maxImpulse = h * this.m_maxForce;
          if (this.m_linearImpulse.lengthSquared() > maxImpulse * maxImpulse) {
            this.m_linearImpulse.normalize();
            this.m_linearImpulse.mul(maxImpulse);
          }
          impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      FrictionJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      FrictionJoint2.TYPE = "friction-joint";
      return FrictionJoint2;
    }(Joint)
  );
  var Mat33 = (
    /** @class */
    function() {
      function Mat332(a2, b2, c2) {
        if (typeof a2 === "object" && a2 !== null) {
          this.ex = Vec3.clone(a2);
          this.ey = Vec3.clone(b2);
          this.ez = Vec3.clone(c2);
        } else {
          this.ex = Vec3.zero();
          this.ey = Vec3.zero();
          this.ez = Vec3.zero();
        }
      }
      Mat332.prototype.toString = function() {
        return JSON.stringify(this);
      };
      Mat332.isValid = function(obj) {
        if (obj === null || typeof obj === "undefined") {
          return false;
        }
        return Vec3.isValid(obj.ex) && Vec3.isValid(obj.ey) && Vec3.isValid(obj.ez);
      };
      Mat332.assert = function(o) {
      };
      Mat332.prototype.setZero = function() {
        this.ex.setZero();
        this.ey.setZero();
        this.ez.setZero();
        return this;
      };
      Mat332.prototype.solve33 = function(v3) {
        var cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;
        var cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;
        var cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;
        var det = this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z;
        if (det !== 0) {
          det = 1 / det;
        }
        var r = new Vec3();
        cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;
        cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;
        cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;
        r.x = det * (v3.x * cross_x + v3.y * cross_y + v3.z * cross_z);
        cross_x = v3.y * this.ez.z - v3.z * this.ez.y;
        cross_y = v3.z * this.ez.x - v3.x * this.ez.z;
        cross_z = v3.x * this.ez.y - v3.y * this.ez.x;
        r.y = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);
        cross_x = this.ey.y * v3.z - this.ey.z * v3.y;
        cross_y = this.ey.z * v3.x - this.ey.x * v3.z;
        cross_z = this.ey.x * v3.y - this.ey.y * v3.x;
        r.z = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);
        return r;
      };
      Mat332.prototype.solve22 = function(v3) {
        var a11 = this.ex.x;
        var a12 = this.ey.x;
        var a21 = this.ex.y;
        var a22 = this.ey.y;
        var det = a11 * a22 - a12 * a21;
        if (det !== 0) {
          det = 1 / det;
        }
        var r = Vec2.zero();
        r.x = det * (a22 * v3.x - a12 * v3.y);
        r.y = det * (a11 * v3.y - a21 * v3.x);
        return r;
      };
      Mat332.prototype.getInverse22 = function(M) {
        var a2 = this.ex.x;
        var b2 = this.ey.x;
        var c2 = this.ex.y;
        var d2 = this.ey.y;
        var det = a2 * d2 - b2 * c2;
        if (det !== 0) {
          det = 1 / det;
        }
        M.ex.x = det * d2;
        M.ey.x = -det * b2;
        M.ex.z = 0;
        M.ex.y = -det * c2;
        M.ey.y = det * a2;
        M.ey.z = 0;
        M.ez.x = 0;
        M.ez.y = 0;
        M.ez.z = 0;
      };
      Mat332.prototype.getSymInverse33 = function(M) {
        var det = Vec3.dot(this.ex, Vec3.cross(this.ey, this.ez));
        if (det !== 0) {
          det = 1 / det;
        }
        var a11 = this.ex.x;
        var a12 = this.ey.x;
        var a13 = this.ez.x;
        var a22 = this.ey.y;
        var a23 = this.ez.y;
        var a33 = this.ez.z;
        M.ex.x = det * (a22 * a33 - a23 * a23);
        M.ex.y = det * (a13 * a23 - a12 * a33);
        M.ex.z = det * (a12 * a23 - a13 * a22);
        M.ey.x = M.ex.y;
        M.ey.y = det * (a11 * a33 - a13 * a13);
        M.ey.z = det * (a13 * a12 - a11 * a23);
        M.ez.x = M.ex.z;
        M.ez.y = M.ey.z;
        M.ez.z = det * (a11 * a22 - a12 * a12);
      };
      Mat332.mul = function(a2, b2) {
        if (b2 && "z" in b2 && "y" in b2 && "x" in b2) {
          var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;
          var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;
          var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;
          return new Vec3(x2, y, z);
        } else if (b2 && "y" in b2 && "x" in b2) {
          var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;
          var y = a2.ex.y * b2.x + a2.ey.y * b2.y;
          return Vec2.neo(x2, y);
        }
      };
      Mat332.mulVec3 = function(a2, b2) {
        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;
        var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;
        var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;
        return new Vec3(x2, y, z);
      };
      Mat332.mulVec2 = function(a2, b2) {
        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;
        var y = a2.ex.y * b2.x + a2.ey.y * b2.y;
        return Vec2.neo(x2, y);
      };
      Mat332.add = function(a2, b2) {
        return new Mat332(Vec3.add(a2.ex, b2.ex), Vec3.add(a2.ey, b2.ey), Vec3.add(a2.ez, b2.ez));
      };
      return Mat332;
    }()
  );
  var math_abs$4 = Math.abs;
  var LimitState$2;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState$2 || (LimitState$2 = {}));
  var DEFAULTS$8 = {
    lowerAngle: 0,
    upperAngle: 0,
    maxMotorTorque: 0,
    motorSpeed: 0,
    enableLimit: false,
    enableMotor: false
  };
  var RevoluteJoint = (
    /** @class */
    function(_super) {
      __extends(RevoluteJoint2, _super);
      function RevoluteJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        var _a2, _b, _c, _d, _e, _f;
        if (!(_this instanceof RevoluteJoint2)) {
          return new RevoluteJoint2(def, bodyA, bodyB, anchor);
        }
        def = def !== null && def !== void 0 ? def : {};
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_mass = new Mat33();
        _this.m_limitState = LimitState$2.inactiveLimit;
        _this.m_type = RevoluteJoint2.TYPE;
        if (Vec2.isValid(anchor)) {
          _this.m_localAnchorA = bodyA.getLocalPoint(anchor);
        } else if (Vec2.isValid(def.localAnchorA)) {
          _this.m_localAnchorA = Vec2.clone(def.localAnchorA);
        } else {
          _this.m_localAnchorA = Vec2.zero();
        }
        if (Vec2.isValid(anchor)) {
          _this.m_localAnchorB = bodyB.getLocalPoint(anchor);
        } else if (Vec2.isValid(def.localAnchorB)) {
          _this.m_localAnchorB = Vec2.clone(def.localAnchorB);
        } else {
          _this.m_localAnchorB = Vec2.zero();
        }
        if (Number.isFinite(def.referenceAngle)) {
          _this.m_referenceAngle = def.referenceAngle;
        } else {
          _this.m_referenceAngle = bodyB.getAngle() - bodyA.getAngle();
        }
        _this.m_impulse = new Vec3();
        _this.m_motorImpulse = 0;
        _this.m_lowerAngle = (_a2 = def.lowerAngle) !== null && _a2 !== void 0 ? _a2 : DEFAULTS$8.lowerAngle;
        _this.m_upperAngle = (_b = def.upperAngle) !== null && _b !== void 0 ? _b : DEFAULTS$8.upperAngle;
        _this.m_maxMotorTorque = (_c = def.maxMotorTorque) !== null && _c !== void 0 ? _c : DEFAULTS$8.maxMotorTorque;
        _this.m_motorSpeed = (_d = def.motorSpeed) !== null && _d !== void 0 ? _d : DEFAULTS$8.motorSpeed;
        _this.m_enableLimit = (_e = def.enableLimit) !== null && _e !== void 0 ? _e : DEFAULTS$8.enableLimit;
        _this.m_enableMotor = (_f = def.enableMotor) !== null && _f !== void 0 ? _f : DEFAULTS$8.enableMotor;
        return _this;
      }
      RevoluteJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          lowerAngle: this.m_lowerAngle,
          upperAngle: this.m_upperAngle,
          maxMotorTorque: this.m_maxMotorTorque,
          motorSpeed: this.m_motorSpeed,
          enableLimit: this.m_enableLimit,
          enableMotor: this.m_enableMotor,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          referenceAngle: this.m_referenceAngle
        };
      };
      RevoluteJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new RevoluteJoint2(data);
        return joint;
      };
      RevoluteJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.referenceAngle)) {
          this.m_referenceAngle = def.referenceAngle;
        }
        if (def.enableLimit !== void 0) {
          this.m_enableLimit = def.enableLimit;
        }
        if (Number.isFinite(def.lowerAngle)) {
          this.m_lowerAngle = def.lowerAngle;
        }
        if (Number.isFinite(def.upperAngle)) {
          this.m_upperAngle = def.upperAngle;
        }
        if (Number.isFinite(def.maxMotorTorque)) {
          this.m_maxMotorTorque = def.maxMotorTorque;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
        if (def.enableMotor !== void 0) {
          this.m_enableMotor = def.enableMotor;
        }
      };
      RevoluteJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      RevoluteJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      RevoluteJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      RevoluteJoint2.prototype.getJointAngle = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        return bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
      };
      RevoluteJoint2.prototype.getJointSpeed = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        return bB.m_angularVelocity - bA.m_angularVelocity;
      };
      RevoluteJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      RevoluteJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      RevoluteJoint2.prototype.getMotorTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      RevoluteJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      RevoluteJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      RevoluteJoint2.prototype.setMaxMotorTorque = function(torque) {
        if (torque == this.m_maxMotorTorque)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorTorque = torque;
      };
      RevoluteJoint2.prototype.getMaxMotorTorque = function() {
        return this.m_maxMotorTorque;
      };
      RevoluteJoint2.prototype.isLimitEnabled = function() {
        return this.m_enableLimit;
      };
      RevoluteJoint2.prototype.enableLimit = function(flag) {
        if (flag != this.m_enableLimit) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_enableLimit = flag;
          this.m_impulse.z = 0;
        }
      };
      RevoluteJoint2.prototype.getLowerLimit = function() {
        return this.m_lowerAngle;
      };
      RevoluteJoint2.prototype.getUpperLimit = function() {
        return this.m_upperAngle;
      };
      RevoluteJoint2.prototype.setLimits = function(lower, upper) {
        if (lower != this.m_lowerAngle || upper != this.m_upperAngle) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_impulse.z = 0;
          this.m_lowerAngle = lower;
          this.m_upperAngle = upper;
        }
      };
      RevoluteJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      RevoluteJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      RevoluteJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);
      };
      RevoluteJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.z;
      };
      RevoluteJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var fixedRotation = iA + iB === 0;
        this.m_mass.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;
        this.m_mass.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;
        this.m_mass.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;
        this.m_mass.ex.y = this.m_mass.ey.x;
        this.m_mass.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;
        this.m_mass.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;
        this.m_mass.ex.z = this.m_mass.ez.x;
        this.m_mass.ey.z = this.m_mass.ez.y;
        this.m_mass.ez.z = iA + iB;
        this.m_motorMass = iA + iB;
        if (this.m_motorMass > 0) {
          this.m_motorMass = 1 / this.m_motorMass;
        }
        if (this.m_enableMotor == false || fixedRotation) {
          this.m_motorImpulse = 0;
        }
        if (this.m_enableLimit && fixedRotation == false) {
          var jointAngle = aB - aA - this.m_referenceAngle;
          if (math_abs$4(this.m_upperAngle - this.m_lowerAngle) < 2 * SettingsInternal.angularSlop) {
            this.m_limitState = LimitState$2.equalLimits;
          } else if (jointAngle <= this.m_lowerAngle) {
            if (this.m_limitState != LimitState$2.atLowerLimit) {
              this.m_impulse.z = 0;
            }
            this.m_limitState = LimitState$2.atLowerLimit;
          } else if (jointAngle >= this.m_upperAngle) {
            if (this.m_limitState != LimitState$2.atUpperLimit) {
              this.m_impulse.z = 0;
            }
            this.m_limitState = LimitState$2.atUpperLimit;
          } else {
            this.m_limitState = LimitState$2.inactiveLimit;
            this.m_impulse.z = 0;
          }
        } else {
          this.m_limitState = LimitState$2.inactiveLimit;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_motorImpulse + this.m_impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_motorImpulse + this.m_impulse.z);
        } else {
          this.m_impulse.setZero();
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RevoluteJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var fixedRotation = iA + iB === 0;
        if (this.m_enableMotor && this.m_limitState != LimitState$2.equalLimits && fixedRotation == false) {
          var Cdot = wB - wA - this.m_motorSpeed;
          var impulse = -this.m_motorMass * Cdot;
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorTorque;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var Cdot2 = wB - wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var impulse = Vec3.neg(this.m_mass.solve33(Cdot));
          if (this.m_limitState == LimitState$2.equalLimits) {
            this.m_impulse.add(impulse);
          } else if (this.m_limitState == LimitState$2.atLowerLimit) {
            var newImpulse = this.m_impulse.z + impulse.z;
            if (newImpulse < 0) {
              var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));
              var reduced = this.m_mass.solve22(rhs);
              impulse.x = reduced.x;
              impulse.y = reduced.y;
              impulse.z = -this.m_impulse.z;
              this.m_impulse.x += reduced.x;
              this.m_impulse.y += reduced.y;
              this.m_impulse.z = 0;
            } else {
              this.m_impulse.add(impulse);
            }
          } else if (this.m_limitState == LimitState$2.atUpperLimit) {
            var newImpulse = this.m_impulse.z + impulse.z;
            if (newImpulse > 0) {
              var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));
              var reduced = this.m_mass.solve22(rhs);
              impulse.x = reduced.x;
              impulse.y = reduced.y;
              impulse.z = -this.m_impulse.z;
              this.m_impulse.x += reduced.x;
              this.m_impulse.y += reduced.y;
              this.m_impulse.z = 0;
            } else {
              this.m_impulse.add(impulse);
            }
          }
          var P3 = Vec2.neo(impulse.x, impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);
        } else {
          var Cdot = Vec2.zero();
          Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var impulse = this.m_mass.solve22(Vec2.neg(Cdot));
          this.m_impulse.x += impulse.x;
          this.m_impulse.y += impulse.y;
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RevoluteJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var angularError = 0;
        var positionError = 0;
        var fixedRotation = this.m_invIA + this.m_invIB == 0;
        if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {
          var angle = aB - aA - this.m_referenceAngle;
          var limitImpulse = 0;
          if (this.m_limitState == LimitState$2.equalLimits) {
            var C = clamp(angle - this.m_lowerAngle, -SettingsInternal.maxAngularCorrection, SettingsInternal.maxAngularCorrection);
            limitImpulse = -this.m_motorMass * C;
            angularError = math_abs$4(C);
          } else if (this.m_limitState == LimitState$2.atLowerLimit) {
            var C = angle - this.m_lowerAngle;
            angularError = -C;
            C = clamp(C + SettingsInternal.angularSlop, -SettingsInternal.maxAngularCorrection, 0);
            limitImpulse = -this.m_motorMass * C;
          } else if (this.m_limitState == LimitState$2.atUpperLimit) {
            var C = angle - this.m_upperAngle;
            angularError = C;
            C = clamp(C - SettingsInternal.angularSlop, 0, SettingsInternal.maxAngularCorrection);
            limitImpulse = -this.m_motorMass * C;
          }
          aA -= this.m_invIA * limitImpulse;
          aB += this.m_invIB * limitImpulse;
        }
        {
          qA.setAngle(aA);
          qB.setAngle(aB);
          var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
          var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
          var C = Vec2.zero();
          C.addCombine(1, cB2, 1, rB2);
          C.subCombine(1, cA2, 1, rA2);
          positionError = C.length();
          var mA = this.m_invMassA;
          var mB = this.m_invMassB;
          var iA = this.m_invIA;
          var iB = this.m_invIB;
          var K = new Mat22();
          K.ex.x = mA + mB + iA * rA2.y * rA2.y + iB * rB2.y * rB2.y;
          K.ex.y = -iA * rA2.x * rA2.y - iB * rB2.x * rB2.y;
          K.ey.x = K.ex.y;
          K.ey.y = mA + mB + iA * rA2.x * rA2.x + iB * rB2.x * rB2.x;
          var impulse = Vec2.neg(K.solve(C));
          cA2.subMul(mA, impulse);
          aA -= iA * Vec2.crossVec2Vec2(rA2, impulse);
          cB2.addMul(mB, impulse);
          aB += iB * Vec2.crossVec2Vec2(rB2, impulse);
        }
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      RevoluteJoint2.TYPE = "revolute-joint";
      return RevoluteJoint2;
    }(Joint)
  );
  var math_abs$3 = Math.abs;
  var math_max = Math.max;
  var math_min$2 = Math.min;
  var LimitState$1;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState$1 || (LimitState$1 = {}));
  var DEFAULTS$7 = {
    enableLimit: false,
    lowerTranslation: 0,
    upperTranslation: 0,
    enableMotor: false,
    maxMotorForce: 0,
    motorSpeed: 0
  };
  var PrismaticJoint = (
    /** @class */
    function(_super) {
      __extends(PrismaticJoint2, _super);
      function PrismaticJoint2(def, bodyA, bodyB, anchor, axis) {
        var _this = this;
        if (!(_this instanceof PrismaticJoint2)) {
          return new PrismaticJoint2(def, bodyA, bodyB, anchor, axis);
        }
        def = options(def, DEFAULTS$7);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = PrismaticJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_localXAxisA = Vec2.clone(axis ? bodyA.getLocalVector(axis) : def.localAxisA || Vec2.neo(1, 0));
        _this.m_localXAxisA.normalize();
        _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);
        _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();
        _this.m_impulse = new Vec3();
        _this.m_motorMass = 0;
        _this.m_motorImpulse = 0;
        _this.m_lowerTranslation = def.lowerTranslation;
        _this.m_upperTranslation = def.upperTranslation;
        _this.m_maxMotorForce = def.maxMotorForce;
        _this.m_motorSpeed = def.motorSpeed;
        _this.m_enableLimit = def.enableLimit;
        _this.m_enableMotor = def.enableMotor;
        _this.m_limitState = LimitState$1.inactiveLimit;
        _this.m_axis = Vec2.zero();
        _this.m_perp = Vec2.zero();
        _this.m_K = new Mat33();
        return _this;
      }
      PrismaticJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          lowerTranslation: this.m_lowerTranslation,
          upperTranslation: this.m_upperTranslation,
          maxMotorForce: this.m_maxMotorForce,
          motorSpeed: this.m_motorSpeed,
          enableLimit: this.m_enableLimit,
          enableMotor: this.m_enableMotor,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          localAxisA: this.m_localXAxisA,
          referenceAngle: this.m_referenceAngle
        };
      };
      PrismaticJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.localAxisA = Vec2.clone(data.localAxisA);
        var joint = new PrismaticJoint2(data);
        return joint;
      };
      PrismaticJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.localAxisA) {
          this.m_localXAxisA.setVec2(def.localAxisA);
          this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));
        }
        if (Number.isFinite(def.referenceAngle)) {
          this.m_referenceAngle = def.referenceAngle;
        }
        if (typeof def.enableLimit !== "undefined") {
          this.m_enableLimit = !!def.enableLimit;
        }
        if (Number.isFinite(def.lowerTranslation)) {
          this.m_lowerTranslation = def.lowerTranslation;
        }
        if (Number.isFinite(def.upperTranslation)) {
          this.m_upperTranslation = def.upperTranslation;
        }
        if (typeof def.enableMotor !== "undefined") {
          this.m_enableMotor = !!def.enableMotor;
        }
        if (Number.isFinite(def.maxMotorForce)) {
          this.m_maxMotorForce = def.maxMotorForce;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
      };
      PrismaticJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      PrismaticJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      PrismaticJoint2.prototype.getLocalAxisA = function() {
        return this.m_localXAxisA;
      };
      PrismaticJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      PrismaticJoint2.prototype.getJointTranslation = function() {
        var pA2 = this.m_bodyA.getWorldPoint(this.m_localAnchorA);
        var pB2 = this.m_bodyB.getWorldPoint(this.m_localAnchorB);
        var d2 = Vec2.sub(pB2, pA2);
        var axis = this.m_bodyA.getWorldVector(this.m_localXAxisA);
        var translation2 = Vec2.dot(d2, axis);
        return translation2;
      };
      PrismaticJoint2.prototype.getJointSpeed = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        var rA2 = Rot.mulVec2(bA.m_xf.q, Vec2.sub(this.m_localAnchorA, bA.m_sweep.localCenter));
        var rB2 = Rot.mulVec2(bB.m_xf.q, Vec2.sub(this.m_localAnchorB, bB.m_sweep.localCenter));
        var p1 = Vec2.add(bA.m_sweep.c, rA2);
        var p2 = Vec2.add(bB.m_sweep.c, rB2);
        var d2 = Vec2.sub(p2, p1);
        var axis = Rot.mulVec2(bA.m_xf.q, this.m_localXAxisA);
        var vA2 = bA.m_linearVelocity;
        var vB2 = bB.m_linearVelocity;
        var wA = bA.m_angularVelocity;
        var wB = bB.m_angularVelocity;
        var speed = Vec2.dot(d2, Vec2.crossNumVec2(wA, axis)) + Vec2.dot(axis, Vec2.sub(Vec2.addCrossNumVec2(vB2, wB, rB2), Vec2.addCrossNumVec2(vA2, wA, rA2)));
        return speed;
      };
      PrismaticJoint2.prototype.isLimitEnabled = function() {
        return this.m_enableLimit;
      };
      PrismaticJoint2.prototype.enableLimit = function(flag) {
        if (flag != this.m_enableLimit) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_enableLimit = flag;
          this.m_impulse.z = 0;
        }
      };
      PrismaticJoint2.prototype.getLowerLimit = function() {
        return this.m_lowerTranslation;
      };
      PrismaticJoint2.prototype.getUpperLimit = function() {
        return this.m_upperTranslation;
      };
      PrismaticJoint2.prototype.setLimits = function(lower, upper) {
        if (lower != this.m_lowerTranslation || upper != this.m_upperTranslation) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_lowerTranslation = lower;
          this.m_upperTranslation = upper;
          this.m_impulse.z = 0;
        }
      };
      PrismaticJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      PrismaticJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      PrismaticJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      PrismaticJoint2.prototype.setMaxMotorForce = function(force) {
        if (force == this.m_maxMotorForce)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorForce = force;
      };
      PrismaticJoint2.prototype.getMaxMotorForce = function() {
        return this.m_maxMotorForce;
      };
      PrismaticJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      PrismaticJoint2.prototype.getMotorForce = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      PrismaticJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      PrismaticJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      PrismaticJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis).mul(inv_dt);
      };
      PrismaticJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.y;
      };
      PrismaticJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        {
          this.m_axis = Rot.mulVec2(qA, this.m_localXAxisA);
          this.m_a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_axis);
          this.m_a2 = Vec2.crossVec2Vec2(rB2, this.m_axis);
          this.m_motorMass = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;
          if (this.m_motorMass > 0) {
            this.m_motorMass = 1 / this.m_motorMass;
          }
        }
        {
          this.m_perp = Rot.mulVec2(qA, this.m_localYAxisA);
          this.m_s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_perp);
          this.m_s2 = Vec2.crossVec2Vec2(rB2, this.m_perp);
          Vec2.crossVec2Vec2(rA2, this.m_perp);
          var k11 = mA + mB + iA * this.m_s1 * this.m_s1 + iB * this.m_s2 * this.m_s2;
          var k12 = iA * this.m_s1 + iB * this.m_s2;
          var k13 = iA * this.m_s1 * this.m_a1 + iB * this.m_s2 * this.m_a2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var k23 = iA * this.m_a1 + iB * this.m_a2;
          var k33 = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;
          this.m_K.ex.set(k11, k12, k13);
          this.m_K.ey.set(k12, k22, k23);
          this.m_K.ez.set(k13, k23, k33);
        }
        if (this.m_enableLimit) {
          var jointTranslation = Vec2.dot(this.m_axis, d2);
          if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * SettingsInternal.linearSlop) {
            this.m_limitState = LimitState$1.equalLimits;
          } else if (jointTranslation <= this.m_lowerTranslation) {
            if (this.m_limitState != LimitState$1.atLowerLimit) {
              this.m_limitState = LimitState$1.atLowerLimit;
              this.m_impulse.z = 0;
            }
          } else if (jointTranslation >= this.m_upperTranslation) {
            if (this.m_limitState != LimitState$1.atUpperLimit) {
              this.m_limitState = LimitState$1.atUpperLimit;
              this.m_impulse.z = 0;
            }
          } else {
            this.m_limitState = LimitState$1.inactiveLimit;
            this.m_impulse.z = 0;
          }
        } else {
          this.m_limitState = LimitState$1.inactiveLimit;
          this.m_impulse.z = 0;
        }
        if (this.m_enableMotor == false) {
          this.m_motorImpulse = 0;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis);
          var LA = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1;
          var LB = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        } else {
          this.m_impulse.setZero();
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      PrismaticJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        if (this.m_enableMotor && this.m_limitState != LimitState$1.equalLimits) {
          var Cdot = Vec2.dot(this.m_axis, Vec2.sub(vB2, vA2)) + this.m_a2 * wB - this.m_a1 * wA;
          var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorForce;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_axis);
          var LA = impulse * this.m_a1;
          var LB = impulse * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        var Cdot1 = Vec2.zero();
        Cdot1.x += Vec2.dot(this.m_perp, vB2) + this.m_s2 * wB;
        Cdot1.x -= Vec2.dot(this.m_perp, vA2) + this.m_s1 * wA;
        Cdot1.y = wB - wA;
        if (this.m_enableLimit && this.m_limitState != LimitState$1.inactiveLimit) {
          var Cdot2 = 0;
          Cdot2 += Vec2.dot(this.m_axis, vB2) + this.m_a2 * wB;
          Cdot2 -= Vec2.dot(this.m_axis, vA2) + this.m_a1 * wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var f1 = Vec3.clone(this.m_impulse);
          var df = this.m_K.solve33(Vec3.neg(Cdot));
          this.m_impulse.add(df);
          if (this.m_limitState == LimitState$1.atLowerLimit) {
            this.m_impulse.z = math_max(this.m_impulse.z, 0);
          } else if (this.m_limitState == LimitState$1.atUpperLimit) {
            this.m_impulse.z = math_min$2(this.m_impulse.z, 0);
          }
          var b2 = Vec2.combine(-1, Cdot1, -(this.m_impulse.z - f1.z), Vec2.neo(this.m_K.ez.x, this.m_K.ez.y));
          var f2r = Vec2.add(this.m_K.solve22(b2), Vec2.neo(f1.x, f1.y));
          this.m_impulse.x = f2r.x;
          this.m_impulse.y = f2r.y;
          df = Vec3.sub(this.m_impulse, f1);
          var P3 = Vec2.combine(df.x, this.m_perp, df.z, this.m_axis);
          var LA = df.x * this.m_s1 + df.y + df.z * this.m_a1;
          var LB = df.x * this.m_s2 + df.y + df.z * this.m_a2;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        } else {
          var df = this.m_K.solve22(Vec2.neg(Cdot1));
          this.m_impulse.x += df.x;
          this.m_impulse.y += df.y;
          var P3 = Vec2.mulNumVec2(df.x, this.m_perp);
          var LA = df.x * this.m_s1 + df.y;
          var LB = df.x * this.m_s2 + df.y;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PrismaticJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));
        var axis = Rot.mulVec2(qA, this.m_localXAxisA);
        var a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), axis);
        var a2 = Vec2.crossVec2Vec2(rB2, axis);
        var perp2 = Rot.mulVec2(qA, this.m_localYAxisA);
        var s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), perp2);
        var s2 = Vec2.crossVec2Vec2(rB2, perp2);
        var impulse = new Vec3();
        var C1 = Vec2.zero();
        C1.x = Vec2.dot(perp2, d2);
        C1.y = aB - aA - this.m_referenceAngle;
        var linearError = math_abs$3(C1.x);
        var angularError = math_abs$3(C1.y);
        var linearSlop = SettingsInternal.linearSlop;
        var maxLinearCorrection = SettingsInternal.maxLinearCorrection;
        var active = false;
        var C2 = 0;
        if (this.m_enableLimit) {
          var translation2 = Vec2.dot(axis, d2);
          if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * linearSlop) {
            C2 = clamp(translation2, -maxLinearCorrection, maxLinearCorrection);
            linearError = math_max(linearError, math_abs$3(translation2));
            active = true;
          } else if (translation2 <= this.m_lowerTranslation) {
            C2 = clamp(translation2 - this.m_lowerTranslation + linearSlop, -maxLinearCorrection, 0);
            linearError = Math.max(linearError, this.m_lowerTranslation - translation2);
            active = true;
          } else if (translation2 >= this.m_upperTranslation) {
            C2 = clamp(translation2 - this.m_upperTranslation - linearSlop, 0, maxLinearCorrection);
            linearError = Math.max(linearError, translation2 - this.m_upperTranslation);
            active = true;
          }
        }
        if (active) {
          var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;
          var k12 = iA * s1 + iB * s2;
          var k13 = iA * s1 * a1 + iB * s2 * a2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var k23 = iA * a1 + iB * a2;
          var k33 = mA + mB + iA * a1 * a1 + iB * a2 * a2;
          var K = new Mat33();
          K.ex.set(k11, k12, k13);
          K.ey.set(k12, k22, k23);
          K.ez.set(k13, k23, k33);
          var C = new Vec3();
          C.x = C1.x;
          C.y = C1.y;
          C.z = C2;
          impulse = K.solve33(Vec3.neg(C));
        } else {
          var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;
          var k12 = iA * s1 + iB * s2;
          var k22 = iA + iB;
          if (k22 == 0) {
            k22 = 1;
          }
          var K = new Mat22();
          K.ex.setNum(k11, k12);
          K.ey.setNum(k12, k22);
          var impulse1 = K.solve(Vec2.neg(C1));
          impulse.x = impulse1.x;
          impulse.y = impulse1.y;
          impulse.z = 0;
        }
        var P3 = Vec2.combine(impulse.x, perp2, impulse.z, axis);
        var LA = impulse.x * s1 + impulse.y + impulse.z * a1;
        var LB = impulse.x * s2 + impulse.y + impulse.z * a2;
        cA2.subMul(mA, P3);
        aA -= iA * LA;
        cB2.addMul(mB, P3);
        aB += iB * LB;
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return linearError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      PrismaticJoint2.TYPE = "prismatic-joint";
      return PrismaticJoint2;
    }(Joint)
  );
  var DEFAULTS$6 = {
    ratio: 1
  };
  var GearJoint = (
    /** @class */
    function(_super) {
      __extends(GearJoint2, _super);
      function GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio) {
        var _this = this;
        if (!(_this instanceof GearJoint2)) {
          return new GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio);
        }
        def = options(def, DEFAULTS$6);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = GearJoint2.TYPE;
        _this.m_joint1 = joint1 ? joint1 : def.joint1;
        _this.m_joint2 = joint2 ? joint2 : def.joint2;
        _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;
        _this.m_type1 = _this.m_joint1.getType();
        _this.m_type2 = _this.m_joint2.getType();
        var coordinateA;
        var coordinateB;
        _this.m_bodyC = _this.m_joint1.getBodyA();
        _this.m_bodyA = _this.m_joint1.getBodyB();
        var xfA2 = _this.m_bodyA.m_xf;
        var aA = _this.m_bodyA.m_sweep.a;
        var xfC = _this.m_bodyC.m_xf;
        var aC = _this.m_bodyC.m_sweep.a;
        if (_this.m_type1 === RevoluteJoint.TYPE) {
          var revolute = _this.m_joint1;
          _this.m_localAnchorC = revolute.m_localAnchorA;
          _this.m_localAnchorA = revolute.m_localAnchorB;
          _this.m_referenceAngleA = revolute.m_referenceAngle;
          _this.m_localAxisC = Vec2.zero();
          coordinateA = aA - aC - _this.m_referenceAngleA;
        } else {
          var prismatic = _this.m_joint1;
          _this.m_localAnchorC = prismatic.m_localAnchorA;
          _this.m_localAnchorA = prismatic.m_localAnchorB;
          _this.m_referenceAngleA = prismatic.m_referenceAngle;
          _this.m_localAxisC = prismatic.m_localXAxisA;
          var pC = _this.m_localAnchorC;
          var pA2 = Rot.mulTVec2(xfC.q, Vec2.add(Rot.mulVec2(xfA2.q, _this.m_localAnchorA), Vec2.sub(xfA2.p, xfC.p)));
          coordinateA = Vec2.dot(pA2, _this.m_localAxisC) - Vec2.dot(pC, _this.m_localAxisC);
        }
        _this.m_bodyD = _this.m_joint2.getBodyA();
        _this.m_bodyB = _this.m_joint2.getBodyB();
        var xfB2 = _this.m_bodyB.m_xf;
        var aB = _this.m_bodyB.m_sweep.a;
        var xfD = _this.m_bodyD.m_xf;
        var aD = _this.m_bodyD.m_sweep.a;
        if (_this.m_type2 === RevoluteJoint.TYPE) {
          var revolute = _this.m_joint2;
          _this.m_localAnchorD = revolute.m_localAnchorA;
          _this.m_localAnchorB = revolute.m_localAnchorB;
          _this.m_referenceAngleB = revolute.m_referenceAngle;
          _this.m_localAxisD = Vec2.zero();
          coordinateB = aB - aD - _this.m_referenceAngleB;
        } else {
          var prismatic = _this.m_joint2;
          _this.m_localAnchorD = prismatic.m_localAnchorA;
          _this.m_localAnchorB = prismatic.m_localAnchorB;
          _this.m_referenceAngleB = prismatic.m_referenceAngle;
          _this.m_localAxisD = prismatic.m_localXAxisA;
          var pD = _this.m_localAnchorD;
          var pB2 = Rot.mulTVec2(xfD.q, Vec2.add(Rot.mulVec2(xfB2.q, _this.m_localAnchorB), Vec2.sub(xfB2.p, xfD.p)));
          coordinateB = Vec2.dot(pB2, _this.m_localAxisD) - Vec2.dot(pD, _this.m_localAxisD);
        }
        _this.m_constant = coordinateA + _this.m_ratio * coordinateB;
        _this.m_impulse = 0;
        return _this;
      }
      GearJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          joint1: this.m_joint1,
          joint2: this.m_joint2,
          ratio: this.m_ratio
          // _constant: this.m_constant,
        };
      };
      GearJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.joint1 = restore(Joint, data.joint1, world);
        data.joint2 = restore(Joint, data.joint2, world);
        var joint = new GearJoint2(data);
        return joint;
      };
      GearJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.ratio)) {
          this.m_ratio = def.ratio;
        }
      };
      GearJoint2.prototype.getJoint1 = function() {
        return this.m_joint1;
      };
      GearJoint2.prototype.getJoint2 = function() {
        return this.m_joint2;
      };
      GearJoint2.prototype.setRatio = function(ratio) {
        this.m_ratio = ratio;
      };
      GearJoint2.prototype.getRatio = function() {
        return this.m_ratio;
      };
      GearJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      GearJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      GearJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_JvAC).mul(inv_dt);
      };
      GearJoint2.prototype.getReactionTorque = function(inv_dt) {
        var L = this.m_impulse * this.m_JwA;
        return inv_dt * L;
      };
      GearJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_lcA = this.m_bodyA.m_sweep.localCenter;
        this.m_lcB = this.m_bodyB.m_sweep.localCenter;
        this.m_lcC = this.m_bodyC.m_sweep.localCenter;
        this.m_lcD = this.m_bodyD.m_sweep.localCenter;
        this.m_mA = this.m_bodyA.m_invMass;
        this.m_mB = this.m_bodyB.m_invMass;
        this.m_mC = this.m_bodyC.m_invMass;
        this.m_mD = this.m_bodyD.m_invMass;
        this.m_iA = this.m_bodyA.m_invI;
        this.m_iB = this.m_bodyB.m_invI;
        this.m_iC = this.m_bodyC.m_invI;
        this.m_iD = this.m_bodyD.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var aC = this.m_bodyC.c_position.a;
        var vC = this.m_bodyC.c_velocity.v;
        var wC = this.m_bodyC.c_velocity.w;
        var aD = this.m_bodyD.c_position.a;
        var vD = this.m_bodyD.c_velocity.v;
        var wD = this.m_bodyD.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var qC = Rot.neo(aC);
        var qD = Rot.neo(aD);
        this.m_mass = 0;
        if (this.m_type1 == RevoluteJoint.TYPE) {
          this.m_JvAC = Vec2.zero();
          this.m_JwA = 1;
          this.m_JwC = 1;
          this.m_mass += this.m_iA + this.m_iC;
        } else {
          var u = Rot.mulVec2(qC, this.m_localAxisC);
          var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);
          var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);
          this.m_JvAC = u;
          this.m_JwC = Vec2.crossVec2Vec2(rC, u);
          this.m_JwA = Vec2.crossVec2Vec2(rA2, u);
          this.m_mass += this.m_mC + this.m_mA + this.m_iC * this.m_JwC * this.m_JwC + this.m_iA * this.m_JwA * this.m_JwA;
        }
        if (this.m_type2 == RevoluteJoint.TYPE) {
          this.m_JvBD = Vec2.zero();
          this.m_JwB = this.m_ratio;
          this.m_JwD = this.m_ratio;
          this.m_mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);
        } else {
          var u = Rot.mulVec2(qD, this.m_localAxisD);
          var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);
          var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);
          this.m_JvBD = Vec2.mulNumVec2(this.m_ratio, u);
          this.m_JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);
          this.m_JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);
          this.m_mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * this.m_JwD * this.m_JwD + this.m_iB * this.m_JwB * this.m_JwB;
        }
        this.m_mass = this.m_mass > 0 ? 1 / this.m_mass : 0;
        if (step.warmStarting) {
          vA2.addMul(this.m_mA * this.m_impulse, this.m_JvAC);
          wA += this.m_iA * this.m_impulse * this.m_JwA;
          vB2.addMul(this.m_mB * this.m_impulse, this.m_JvBD);
          wB += this.m_iB * this.m_impulse * this.m_JwB;
          vC.subMul(this.m_mC * this.m_impulse, this.m_JvAC);
          wC -= this.m_iC * this.m_impulse * this.m_JwC;
          vD.subMul(this.m_mD * this.m_impulse, this.m_JvBD);
          wD -= this.m_iD * this.m_impulse * this.m_JwD;
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
        this.m_bodyC.c_velocity.v.setVec2(vC);
        this.m_bodyC.c_velocity.w = wC;
        this.m_bodyD.c_velocity.v.setVec2(vD);
        this.m_bodyD.c_velocity.w = wD;
      };
      GearJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vC = this.m_bodyC.c_velocity.v;
        var wC = this.m_bodyC.c_velocity.w;
        var vD = this.m_bodyD.c_velocity.v;
        var wD = this.m_bodyD.c_velocity.w;
        var Cdot = Vec2.dot(this.m_JvAC, vA2) - Vec2.dot(this.m_JvAC, vC) + Vec2.dot(this.m_JvBD, vB2) - Vec2.dot(this.m_JvBD, vD);
        Cdot += this.m_JwA * wA - this.m_JwC * wC + (this.m_JwB * wB - this.m_JwD * wD);
        var impulse = -this.m_mass * Cdot;
        this.m_impulse += impulse;
        vA2.addMul(this.m_mA * impulse, this.m_JvAC);
        wA += this.m_iA * impulse * this.m_JwA;
        vB2.addMul(this.m_mB * impulse, this.m_JvBD);
        wB += this.m_iB * impulse * this.m_JwB;
        vC.subMul(this.m_mC * impulse, this.m_JvAC);
        wC -= this.m_iC * impulse * this.m_JwC;
        vD.subMul(this.m_mD * impulse, this.m_JvBD);
        wD -= this.m_iD * impulse * this.m_JwD;
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
        this.m_bodyC.c_velocity.v.setVec2(vC);
        this.m_bodyC.c_velocity.w = wC;
        this.m_bodyD.c_velocity.v.setVec2(vD);
        this.m_bodyD.c_velocity.w = wD;
      };
      GearJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var cC = this.m_bodyC.c_position.c;
        var aC = this.m_bodyC.c_position.a;
        var cD = this.m_bodyD.c_position.c;
        var aD = this.m_bodyD.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var qC = Rot.neo(aC);
        var qD = Rot.neo(aD);
        var linearError = 0;
        var coordinateA;
        var coordinateB;
        var JvAC;
        var JvBD;
        var JwA;
        var JwB;
        var JwC;
        var JwD;
        var mass = 0;
        if (this.m_type1 == RevoluteJoint.TYPE) {
          JvAC = Vec2.zero();
          JwA = 1;
          JwC = 1;
          mass += this.m_iA + this.m_iC;
          coordinateA = aA - aC - this.m_referenceAngleA;
        } else {
          var u = Rot.mulVec2(qC, this.m_localAxisC);
          var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);
          var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);
          JvAC = u;
          JwC = Vec2.crossVec2Vec2(rC, u);
          JwA = Vec2.crossVec2Vec2(rA2, u);
          mass += this.m_mC + this.m_mA + this.m_iC * JwC * JwC + this.m_iA * JwA * JwA;
          var pC = Vec2.sub(this.m_localAnchorC, this.m_lcC);
          var pA2 = Rot.mulTVec2(qC, Vec2.add(rA2, Vec2.sub(cA2, cC)));
          coordinateA = Vec2.dot(Vec2.sub(pA2, pC), this.m_localAxisC);
        }
        if (this.m_type2 == RevoluteJoint.TYPE) {
          JvBD = Vec2.zero();
          JwB = this.m_ratio;
          JwD = this.m_ratio;
          mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);
          coordinateB = aB - aD - this.m_referenceAngleB;
        } else {
          var u = Rot.mulVec2(qD, this.m_localAxisD);
          var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);
          var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);
          JvBD = Vec2.mulNumVec2(this.m_ratio, u);
          JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);
          JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);
          mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * JwD * JwD + this.m_iB * JwB * JwB;
          var pD = Vec2.sub(this.m_localAnchorD, this.m_lcD);
          var pB2 = Rot.mulTVec2(qD, Vec2.add(rB2, Vec2.sub(cB2, cD)));
          coordinateB = Vec2.dot(pB2, this.m_localAxisD) - Vec2.dot(pD, this.m_localAxisD);
        }
        var C = coordinateA + this.m_ratio * coordinateB - this.m_constant;
        var impulse = 0;
        if (mass > 0) {
          impulse = -C / mass;
        }
        cA2.addMul(this.m_mA * impulse, JvAC);
        aA += this.m_iA * impulse * JwA;
        cB2.addMul(this.m_mB * impulse, JvBD);
        aB += this.m_iB * impulse * JwB;
        cC.subMul(this.m_mC * impulse, JvAC);
        aC -= this.m_iC * impulse * JwC;
        cD.subMul(this.m_mD * impulse, JvBD);
        aD -= this.m_iD * impulse * JwD;
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        this.m_bodyC.c_position.c.setVec2(cC);
        this.m_bodyC.c_position.a = aC;
        this.m_bodyD.c_position.c.setVec2(cD);
        this.m_bodyD.c_position.a = aD;
        return linearError < SettingsInternal.linearSlop;
      };
      GearJoint2.TYPE = "gear-joint";
      return GearJoint2;
    }(Joint)
  );
  var DEFAULTS$5 = {
    maxForce: 1,
    maxTorque: 1,
    correctionFactor: 0.3
  };
  var MotorJoint = (
    /** @class */
    function(_super) {
      __extends(MotorJoint2, _super);
      function MotorJoint2(def, bodyA, bodyB) {
        var _this = this;
        if (!(_this instanceof MotorJoint2)) {
          return new MotorJoint2(def, bodyA, bodyB);
        }
        def = options(def, DEFAULTS$5);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = MotorJoint2.TYPE;
        _this.m_linearOffset = Vec2.isValid(def.linearOffset) ? Vec2.clone(def.linearOffset) : bodyA.getLocalPoint(bodyB.getPosition());
        _this.m_angularOffset = Number.isFinite(def.angularOffset) ? def.angularOffset : bodyB.getAngle() - bodyA.getAngle();
        _this.m_linearImpulse = Vec2.zero();
        _this.m_angularImpulse = 0;
        _this.m_maxForce = def.maxForce;
        _this.m_maxTorque = def.maxTorque;
        _this.m_correctionFactor = def.correctionFactor;
        return _this;
      }
      MotorJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          maxForce: this.m_maxForce,
          maxTorque: this.m_maxTorque,
          correctionFactor: this.m_correctionFactor,
          linearOffset: this.m_linearOffset,
          angularOffset: this.m_angularOffset
        };
      };
      MotorJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new MotorJoint2(data);
        return joint;
      };
      MotorJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.angularOffset)) {
          this.m_angularOffset = def.angularOffset;
        }
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.maxTorque)) {
          this.m_maxTorque = def.maxTorque;
        }
        if (Number.isFinite(def.correctionFactor)) {
          this.m_correctionFactor = def.correctionFactor;
        }
        if (Vec2.isValid(def.linearOffset)) {
          this.m_linearOffset.set(def.linearOffset);
        }
      };
      MotorJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      MotorJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      MotorJoint2.prototype.setMaxTorque = function(torque) {
        this.m_maxTorque = torque;
      };
      MotorJoint2.prototype.getMaxTorque = function() {
        return this.m_maxTorque;
      };
      MotorJoint2.prototype.setCorrectionFactor = function(factor) {
        this.m_correctionFactor = factor;
      };
      MotorJoint2.prototype.getCorrectionFactor = function() {
        return this.m_correctionFactor;
      };
      MotorJoint2.prototype.setLinearOffset = function(linearOffset) {
        if (linearOffset.x != this.m_linearOffset.x || linearOffset.y != this.m_linearOffset.y) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_linearOffset.set(linearOffset);
        }
      };
      MotorJoint2.prototype.getLinearOffset = function() {
        return this.m_linearOffset;
      };
      MotorJoint2.prototype.setAngularOffset = function(angularOffset) {
        if (angularOffset != this.m_angularOffset) {
          this.m_bodyA.setAwake(true);
          this.m_bodyB.setAwake(true);
          this.m_angularOffset = angularOffset;
        }
      };
      MotorJoint2.prototype.getAngularOffset = function() {
        return this.m_angularOffset;
      };
      MotorJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getPosition();
      };
      MotorJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getPosition();
      };
      MotorJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);
      };
      MotorJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_angularImpulse;
      };
      MotorJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_linearOffset, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.neg(this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat22();
        K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;
        K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;
        this.m_linearMass = K.getInverse();
        this.m_angularMass = iA + iB;
        if (this.m_angularMass > 0) {
          this.m_angularMass = 1 / this.m_angularMass;
        }
        this.m_linearError = Vec2.zero();
        this.m_linearError.addCombine(1, cB2, 1, this.m_rB);
        this.m_linearError.subCombine(1, cA2, 1, this.m_rA);
        this.m_angularError = aB - aA - this.m_angularOffset;
        if (step.warmStarting) {
          this.m_linearImpulse.mul(step.dtRatio);
          this.m_angularImpulse *= step.dtRatio;
          var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);
        } else {
          this.m_linearImpulse.setZero();
          this.m_angularImpulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      MotorJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var h = step.dt;
        var inv_h = step.inv_dt;
        {
          var Cdot = wB - wA + inv_h * this.m_correctionFactor * this.m_angularError;
          var impulse = -this.m_angularMass * Cdot;
          var oldImpulse = this.m_angularImpulse;
          var maxImpulse = h * this.m_maxTorque;
          this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_angularImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.zero();
          Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          Cdot.addMul(inv_h * this.m_correctionFactor, this.m_linearError);
          var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));
          var oldImpulse = Vec2.clone(this.m_linearImpulse);
          this.m_linearImpulse.add(impulse);
          var maxImpulse = h * this.m_maxForce;
          this.m_linearImpulse.clamp(maxImpulse);
          impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);
          vA2.subMul(mA, impulse);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);
          vB2.addMul(mB, impulse);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      MotorJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      MotorJoint2.TYPE = "motor-joint";
      return MotorJoint2;
    }(Joint)
  );
  var math_PI$2 = Math.PI;
  var DEFAULTS$4 = {
    maxForce: 0,
    frequencyHz: 5,
    dampingRatio: 0.7
  };
  var MouseJoint = (
    /** @class */
    function(_super) {
      __extends(MouseJoint2, _super);
      function MouseJoint2(def, bodyA, bodyB, target) {
        var _this = this;
        if (!(_this instanceof MouseJoint2)) {
          return new MouseJoint2(def, bodyA, bodyB, target);
        }
        def = options(def, DEFAULTS$4);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = MouseJoint2.TYPE;
        if (Vec2.isValid(target)) {
          _this.m_targetA = Vec2.clone(target);
        } else if (Vec2.isValid(def.target)) {
          _this.m_targetA = Vec2.clone(def.target);
        } else {
          _this.m_targetA = Vec2.zero();
        }
        _this.m_localAnchorB = Transform.mulTVec2(bodyB.getTransform(), _this.m_targetA);
        _this.m_maxForce = def.maxForce;
        _this.m_impulse = Vec2.zero();
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_beta = 0;
        _this.m_gamma = 0;
        _this.m_rB = Vec2.zero();
        _this.m_localCenterB = Vec2.zero();
        _this.m_invMassB = 0;
        _this.m_invIB = 0;
        _this.m_mass = new Mat22();
        _this.m_C = Vec2.zero();
        return _this;
      }
      MouseJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          target: this.m_targetA,
          maxForce: this.m_maxForce,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          _localAnchorB: this.m_localAnchorB
        };
      };
      MouseJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        data.target = Vec2.clone(data.target);
        var joint = new MouseJoint2(data);
        if (data._localAnchorB) {
          joint.m_localAnchorB = data._localAnchorB;
        }
        return joint;
      };
      MouseJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.maxForce)) {
          this.m_maxForce = def.maxForce;
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      MouseJoint2.prototype.setTarget = function(target) {
        if (Vec2.areEqual(target, this.m_targetA))
          return;
        this.m_bodyB.setAwake(true);
        this.m_targetA.set(target);
      };
      MouseJoint2.prototype.getTarget = function() {
        return this.m_targetA;
      };
      MouseJoint2.prototype.setMaxForce = function(force) {
        this.m_maxForce = force;
      };
      MouseJoint2.prototype.getMaxForce = function() {
        return this.m_maxForce;
      };
      MouseJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      MouseJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      MouseJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      MouseJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      MouseJoint2.prototype.getAnchorA = function() {
        return Vec2.clone(this.m_targetA);
      };
      MouseJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      MouseJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(inv_dt, this.m_impulse);
      };
      MouseJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * 0;
      };
      MouseJoint2.prototype.shiftOrigin = function(newOrigin) {
        this.m_targetA.sub(newOrigin);
      };
      MouseJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIB = this.m_bodyB.m_invI;
        var position = this.m_bodyB.c_position;
        var velocity = this.m_bodyB.c_velocity;
        var cB2 = position.c;
        var aB = position.a;
        var vB2 = velocity.v;
        var wB = velocity.w;
        var qB = Rot.neo(aB);
        var mass = this.m_bodyB.getMass();
        var omega = 2 * math_PI$2 * this.m_frequencyHz;
        var d2 = 2 * mass * this.m_dampingRatio * omega;
        var k = mass * (omega * omega);
        var h = step.dt;
        this.m_gamma = h * (d2 + h * k);
        if (this.m_gamma != 0) {
          this.m_gamma = 1 / this.m_gamma;
        }
        this.m_beta = h * k * this.m_gamma;
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var K = new Mat22();
        K.ex.x = this.m_invMassB + this.m_invIB * this.m_rB.y * this.m_rB.y + this.m_gamma;
        K.ex.y = -this.m_invIB * this.m_rB.x * this.m_rB.y;
        K.ey.x = K.ex.y;
        K.ey.y = this.m_invMassB + this.m_invIB * this.m_rB.x * this.m_rB.x + this.m_gamma;
        this.m_mass = K.getInverse();
        this.m_C.setVec2(cB2);
        this.m_C.addCombine(1, this.m_rB, -1, this.m_targetA);
        this.m_C.mul(this.m_beta);
        wB *= 0.98;
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          vB2.addMul(this.m_invMassB, this.m_impulse);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, this.m_impulse);
        } else {
          this.m_impulse.setZero();
        }
        velocity.v.setVec2(vB2);
        velocity.w = wB;
      };
      MouseJoint2.prototype.solveVelocityConstraints = function(step) {
        var velocity = this.m_bodyB.c_velocity;
        var vB2 = Vec2.clone(velocity.v);
        var wB = velocity.w;
        var Cdot = Vec2.crossNumVec2(wB, this.m_rB);
        Cdot.add(vB2);
        Cdot.addCombine(1, this.m_C, this.m_gamma, this.m_impulse);
        Cdot.neg();
        var impulse = Mat22.mulVec2(this.m_mass, Cdot);
        var oldImpulse = Vec2.clone(this.m_impulse);
        this.m_impulse.add(impulse);
        var maxImpulse = step.dt * this.m_maxForce;
        this.m_impulse.clamp(maxImpulse);
        impulse = Vec2.sub(this.m_impulse, oldImpulse);
        vB2.addMul(this.m_invMassB, impulse);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, impulse);
        velocity.v.setVec2(vB2);
        velocity.w = wB;
      };
      MouseJoint2.prototype.solvePositionConstraints = function(step) {
        return true;
      };
      MouseJoint2.TYPE = "mouse-joint";
      return MouseJoint2;
    }(Joint)
  );
  var math_abs$2 = Math.abs;
  var DEFAULTS$3 = {
    collideConnected: true
  };
  var PulleyJoint = (
    /** @class */
    function(_super) {
      __extends(PulleyJoint2, _super);
      function PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio) {
        var _this = this;
        if (!(_this instanceof PulleyJoint2)) {
          return new PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio);
        }
        def = options(def, DEFAULTS$3);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = PulleyJoint2.TYPE;
        _this.m_groundAnchorA = Vec2.clone(groundA ? groundA : def.groundAnchorA || Vec2.neo(-1, 1));
        _this.m_groundAnchorB = Vec2.clone(groundB ? groundB : def.groundAnchorB || Vec2.neo(1, 1));
        _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.neo(-1, 0));
        _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.neo(1, 0));
        _this.m_lengthA = Number.isFinite(def.lengthA) ? def.lengthA : Vec2.distance(anchorA, groundA);
        _this.m_lengthB = Number.isFinite(def.lengthB) ? def.lengthB : Vec2.distance(anchorB, groundB);
        _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;
        _this.m_constant = _this.m_lengthA + _this.m_ratio * _this.m_lengthB;
        _this.m_impulse = 0;
        return _this;
      }
      PulleyJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          groundAnchorA: this.m_groundAnchorA,
          groundAnchorB: this.m_groundAnchorB,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          lengthA: this.m_lengthA,
          lengthB: this.m_lengthB,
          ratio: this.m_ratio
        };
      };
      PulleyJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new PulleyJoint2(data);
        return joint;
      };
      PulleyJoint2.prototype._reset = function(def) {
        if (Vec2.isValid(def.groundAnchorA)) {
          this.m_groundAnchorA.set(def.groundAnchorA);
        }
        if (Vec2.isValid(def.groundAnchorB)) {
          this.m_groundAnchorB.set(def.groundAnchorB);
        }
        if (Vec2.isValid(def.localAnchorA)) {
          this.m_localAnchorA.set(def.localAnchorA);
        } else if (Vec2.isValid(def.anchorA)) {
          this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(def.anchorA));
        }
        if (Vec2.isValid(def.localAnchorB)) {
          this.m_localAnchorB.set(def.localAnchorB);
        } else if (Vec2.isValid(def.anchorB)) {
          this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(def.anchorB));
        }
        if (Number.isFinite(def.lengthA)) {
          this.m_lengthA = def.lengthA;
        }
        if (Number.isFinite(def.lengthB)) {
          this.m_lengthB = def.lengthB;
        }
        if (Number.isFinite(def.ratio)) {
          this.m_ratio = def.ratio;
        }
      };
      PulleyJoint2.prototype.getGroundAnchorA = function() {
        return this.m_groundAnchorA;
      };
      PulleyJoint2.prototype.getGroundAnchorB = function() {
        return this.m_groundAnchorB;
      };
      PulleyJoint2.prototype.getLengthA = function() {
        return this.m_lengthA;
      };
      PulleyJoint2.prototype.getLengthB = function() {
        return this.m_lengthB;
      };
      PulleyJoint2.prototype.getRatio = function() {
        return this.m_ratio;
      };
      PulleyJoint2.prototype.getCurrentLengthA = function() {
        var p = this.m_bodyA.getWorldPoint(this.m_localAnchorA);
        var s2 = this.m_groundAnchorA;
        return Vec2.distance(p, s2);
      };
      PulleyJoint2.prototype.getCurrentLengthB = function() {
        var p = this.m_bodyB.getWorldPoint(this.m_localAnchorB);
        var s2 = this.m_groundAnchorB;
        return Vec2.distance(p, s2);
      };
      PulleyJoint2.prototype.shiftOrigin = function(newOrigin) {
        this.m_groundAnchorA.sub(newOrigin);
        this.m_groundAnchorB.sub(newOrigin);
      };
      PulleyJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      PulleyJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      PulleyJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_uB).mul(inv_dt);
      };
      PulleyJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      PulleyJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        this.m_uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);
        this.m_uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);
        var lengthA = this.m_uA.length();
        var lengthB = this.m_uB.length();
        if (lengthA > 10 * SettingsInternal.linearSlop) {
          this.m_uA.mul(1 / lengthA);
        } else {
          this.m_uA.setZero();
        }
        if (lengthB > 10 * SettingsInternal.linearSlop) {
          this.m_uB.mul(1 / lengthB);
        } else {
          this.m_uB.setZero();
        }
        var ruA = Vec2.crossVec2Vec2(this.m_rA, this.m_uA);
        var ruB = Vec2.crossVec2Vec2(this.m_rB, this.m_uB);
        var mA = this.m_invMassA + this.m_invIA * ruA * ruA;
        var mB = this.m_invMassB + this.m_invIB * ruB * ruB;
        this.m_mass = mA + this.m_ratio * this.m_ratio * mB;
        if (this.m_mass > 0) {
          this.m_mass = 1 / this.m_mass;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var PA = Vec2.mulNumVec2(-this.m_impulse, this.m_uA);
          var PB = Vec2.mulNumVec2(-this.m_ratio * this.m_impulse, this.m_uB);
          vA2.addMul(this.m_invMassA, PA);
          wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);
          vB2.addMul(this.m_invMassB, PB);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PulleyJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));
        var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));
        var Cdot = -Vec2.dot(this.m_uA, vpA) - this.m_ratio * Vec2.dot(this.m_uB, vpB);
        var impulse = -this.m_mass * Cdot;
        this.m_impulse += impulse;
        var PA = Vec2.mulNumVec2(-impulse, this.m_uA);
        var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, this.m_uB);
        vA2.addMul(this.m_invMassA, PA);
        wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);
        vB2.addMul(this.m_invMassB, PB);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      PulleyJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);
        var uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);
        var lengthA = uA.length();
        var lengthB = uB.length();
        if (lengthA > 10 * SettingsInternal.linearSlop) {
          uA.mul(1 / lengthA);
        } else {
          uA.setZero();
        }
        if (lengthB > 10 * SettingsInternal.linearSlop) {
          uB.mul(1 / lengthB);
        } else {
          uB.setZero();
        }
        var ruA = Vec2.crossVec2Vec2(rA2, uA);
        var ruB = Vec2.crossVec2Vec2(rB2, uB);
        var mA = this.m_invMassA + this.m_invIA * ruA * ruA;
        var mB = this.m_invMassB + this.m_invIB * ruB * ruB;
        var mass = mA + this.m_ratio * this.m_ratio * mB;
        if (mass > 0) {
          mass = 1 / mass;
        }
        var C = this.m_constant - lengthA - this.m_ratio * lengthB;
        var linearError = math_abs$2(C);
        var impulse = -mass * C;
        var PA = Vec2.mulNumVec2(-impulse, uA);
        var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, uB);
        cA2.addMul(this.m_invMassA, PA);
        aA += this.m_invIA * Vec2.crossVec2Vec2(rA2, PA);
        cB2.addMul(this.m_invMassB, PB);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, PB);
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return linearError < SettingsInternal.linearSlop;
      };
      PulleyJoint2.TYPE = "pulley-joint";
      return PulleyJoint2;
    }(Joint)
  );
  var math_min$1 = Math.min;
  var LimitState;
  (function(LimitState2) {
    LimitState2[LimitState2["inactiveLimit"] = 0] = "inactiveLimit";
    LimitState2[LimitState2["atLowerLimit"] = 1] = "atLowerLimit";
    LimitState2[LimitState2["atUpperLimit"] = 2] = "atUpperLimit";
    LimitState2[LimitState2["equalLimits"] = 3] = "equalLimits";
  })(LimitState || (LimitState = {}));
  var DEFAULTS$2 = {
    maxLength: 0
  };
  var RopeJoint = (
    /** @class */
    function(_super) {
      __extends(RopeJoint2, _super);
      function RopeJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof RopeJoint2)) {
          return new RopeJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$2);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = RopeJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.neo(-1, 0));
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.neo(1, 0));
        _this.m_maxLength = def.maxLength;
        _this.m_mass = 0;
        _this.m_impulse = 0;
        _this.m_length = 0;
        _this.m_state = LimitState.inactiveLimit;
        return _this;
      }
      RopeJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          maxLength: this.m_maxLength
        };
      };
      RopeJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new RopeJoint2(data);
        return joint;
      };
      RopeJoint2.prototype._reset = function(def) {
        if (Number.isFinite(def.maxLength)) {
          this.m_maxLength = def.maxLength;
        }
      };
      RopeJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      RopeJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      RopeJoint2.prototype.setMaxLength = function(length) {
        this.m_maxLength = length;
      };
      RopeJoint2.prototype.getMaxLength = function() {
        return this.m_maxLength;
      };
      RopeJoint2.prototype.getLimitState = function() {
        return this.m_state;
      };
      RopeJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      RopeJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      RopeJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);
      };
      RopeJoint2.prototype.getReactionTorque = function(inv_dt) {
        return 0;
      };
      RopeJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        this.m_rB = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        this.m_u = Vec2.zero();
        this.m_u.addCombine(1, cB2, 1, this.m_rB);
        this.m_u.subCombine(1, cA2, 1, this.m_rA);
        this.m_length = this.m_u.length();
        var C = this.m_length - this.m_maxLength;
        if (C > 0) {
          this.m_state = LimitState.atUpperLimit;
        } else {
          this.m_state = LimitState.inactiveLimit;
        }
        if (this.m_length > SettingsInternal.linearSlop) {
          this.m_u.mul(1 / this.m_length);
        } else {
          this.m_u.setZero();
          this.m_mass = 0;
          this.m_impulse = 0;
          return;
        }
        var crA = Vec2.crossVec2Vec2(this.m_rA, this.m_u);
        var crB = Vec2.crossVec2Vec2(this.m_rB, this.m_u);
        var invMass = this.m_invMassA + this.m_invIA * crA * crA + this.m_invMassB + this.m_invIB * crB * crB;
        this.m_mass = invMass != 0 ? 1 / invMass : 0;
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          this.m_impulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      RopeJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var vpA = Vec2.addCrossNumVec2(vA2, wA, this.m_rA);
        var vpB = Vec2.addCrossNumVec2(vB2, wB, this.m_rB);
        var C = this.m_length - this.m_maxLength;
        var Cdot = Vec2.dot(this.m_u, Vec2.sub(vpB, vpA));
        if (C < 0) {
          Cdot += step.inv_dt * C;
        }
        var impulse = -this.m_mass * Cdot;
        var oldImpulse = this.m_impulse;
        this.m_impulse = math_min$1(0, this.m_impulse + impulse);
        impulse = this.m_impulse - oldImpulse;
        var P3 = Vec2.mulNumVec2(impulse, this.m_u);
        vA2.subMul(this.m_invMassA, P3);
        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);
        vB2.addMul(this.m_invMassB, P3);
        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      RopeJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);
        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);
        var u = Vec2.zero();
        u.addCombine(1, cB2, 1, rB2);
        u.subCombine(1, cA2, 1, rA2);
        var length = u.normalize();
        var C = length - this.m_maxLength;
        C = clamp(C, 0, SettingsInternal.maxLinearCorrection);
        var impulse = -this.m_mass * C;
        var P3 = Vec2.mulNumVec2(impulse, u);
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return length - this.m_maxLength < SettingsInternal.linearSlop;
      };
      RopeJoint2.TYPE = "rope-joint";
      return RopeJoint2;
    }(Joint)
  );
  var math_abs$1 = Math.abs;
  var math_PI$1 = Math.PI;
  var DEFAULTS$1 = {
    frequencyHz: 0,
    dampingRatio: 0
  };
  var WeldJoint = (
    /** @class */
    function(_super) {
      __extends(WeldJoint2, _super);
      function WeldJoint2(def, bodyA, bodyB, anchor) {
        var _this = this;
        if (!(_this instanceof WeldJoint2)) {
          return new WeldJoint2(def, bodyA, bodyB, anchor);
        }
        def = options(def, DEFAULTS$1);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_type = WeldJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_impulse = new Vec3();
        _this.m_bias = 0;
        _this.m_gamma = 0;
        _this.m_mass = new Mat33();
        return _this;
      }
      WeldJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          referenceAngle: this.m_referenceAngle
        };
      };
      WeldJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new WeldJoint2(data);
        return joint;
      };
      WeldJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      WeldJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      WeldJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      WeldJoint2.prototype.getReferenceAngle = function() {
        return this.m_referenceAngle;
      };
      WeldJoint2.prototype.setFrequency = function(hz) {
        this.m_frequencyHz = hz;
      };
      WeldJoint2.prototype.getFrequency = function() {
        return this.m_frequencyHz;
      };
      WeldJoint2.prototype.setDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      WeldJoint2.prototype.getDampingRatio = function() {
        return this.m_dampingRatio;
      };
      WeldJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      WeldJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      WeldJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);
      };
      WeldJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_impulse.z;
      };
      WeldJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var K = new Mat33();
        K.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;
        K.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;
        K.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;
        K.ex.y = K.ey.x;
        K.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;
        K.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;
        K.ex.z = K.ez.x;
        K.ey.z = K.ez.y;
        K.ez.z = iA + iB;
        if (this.m_frequencyHz > 0) {
          K.getInverse22(this.m_mass);
          var invM = iA + iB;
          var m = invM > 0 ? 1 / invM : 0;
          var C = aB - aA - this.m_referenceAngle;
          var omega = 2 * math_PI$1 * this.m_frequencyHz;
          var d2 = 2 * m * this.m_dampingRatio * omega;
          var k = m * omega * omega;
          var h = step.dt;
          this.m_gamma = h * (d2 + h * k);
          this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;
          this.m_bias = C * h * k * this.m_gamma;
          invM += this.m_gamma;
          this.m_mass.ez.z = invM != 0 ? 1 / invM : 0;
        } else if (K.ez.z == 0) {
          K.getInverse22(this.m_mass);
          this.m_gamma = 0;
          this.m_bias = 0;
        } else {
          K.getSymInverse33(this.m_mass);
          this.m_gamma = 0;
          this.m_bias = 0;
        }
        if (step.warmStarting) {
          this.m_impulse.mul(step.dtRatio);
          var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_impulse.z);
        } else {
          this.m_impulse.setZero();
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      WeldJoint2.prototype.solveVelocityConstraints = function(step) {
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        if (this.m_frequencyHz > 0) {
          var Cdot2 = wB - wA;
          var impulse2 = -this.m_mass.ez.z * (Cdot2 + this.m_bias + this.m_gamma * this.m_impulse.z);
          this.m_impulse.z += impulse2;
          wA -= iA * impulse2;
          wB += iB * impulse2;
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var impulse1 = Vec2.neg(Mat33.mulVec2(this.m_mass, Cdot1));
          this.m_impulse.x += impulse1.x;
          this.m_impulse.y += impulse1.y;
          var P3 = Vec2.clone(impulse1);
          vA2.subMul(mA, P3);
          wA -= iA * Vec2.crossVec2Vec2(this.m_rA, P3);
          vB2.addMul(mB, P3);
          wB += iB * Vec2.crossVec2Vec2(this.m_rB, P3);
        } else {
          var Cdot1 = Vec2.zero();
          Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));
          Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));
          var Cdot2 = wB - wA;
          var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);
          var impulse = Vec3.neg(Mat33.mulVec3(this.m_mass, Cdot));
          this.m_impulse.add(impulse);
          var P3 = Vec2.neo(impulse.x, impulse.y);
          vA2.subMul(mA, P3);
          wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);
          vB2.addMul(mB, P3);
          wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);
        }
        this.m_bodyA.c_velocity.v = vA2;
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v = vB2;
        this.m_bodyB.c_velocity.w = wB;
      };
      WeldJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var positionError;
        var angularError;
        var K = new Mat33();
        K.ex.x = mA + mB + rA2.y * rA2.y * iA + rB2.y * rB2.y * iB;
        K.ey.x = -rA2.y * rA2.x * iA - rB2.y * rB2.x * iB;
        K.ez.x = -rA2.y * iA - rB2.y * iB;
        K.ex.y = K.ey.x;
        K.ey.y = mA + mB + rA2.x * rA2.x * iA + rB2.x * rB2.x * iB;
        K.ez.y = rA2.x * iA + rB2.x * iB;
        K.ex.z = K.ez.x;
        K.ey.z = K.ez.y;
        K.ez.z = iA + iB;
        if (this.m_frequencyHz > 0) {
          var C1 = Vec2.zero();
          C1.addCombine(1, cB2, 1, rB2);
          C1.subCombine(1, cA2, 1, rA2);
          positionError = C1.length();
          angularError = 0;
          var P3 = Vec2.neg(K.solve22(C1));
          cA2.subMul(mA, P3);
          aA -= iA * Vec2.crossVec2Vec2(rA2, P3);
          cB2.addMul(mB, P3);
          aB += iB * Vec2.crossVec2Vec2(rB2, P3);
        } else {
          var C1 = Vec2.zero();
          C1.addCombine(1, cB2, 1, rB2);
          C1.subCombine(1, cA2, 1, rA2);
          var C2 = aB - aA - this.m_referenceAngle;
          positionError = C1.length();
          angularError = math_abs$1(C2);
          var C = new Vec3(C1.x, C1.y, C2);
          var impulse = new Vec3();
          if (K.ez.z > 0) {
            impulse = Vec3.neg(K.solve33(C));
          } else {
            var impulse2 = Vec2.neg(K.solve22(C1));
            impulse.set(impulse2.x, impulse2.y, 0);
          }
          var P3 = Vec2.neo(impulse.x, impulse.y);
          cA2.subMul(mA, P3);
          aA -= iA * (Vec2.crossVec2Vec2(rA2, P3) + impulse.z);
          cB2.addMul(mB, P3);
          aB += iB * (Vec2.crossVec2Vec2(rB2, P3) + impulse.z);
        }
        this.m_bodyA.c_position.c = cA2;
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c = cB2;
        this.m_bodyB.c_position.a = aB;
        return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;
      };
      WeldJoint2.TYPE = "weld-joint";
      return WeldJoint2;
    }(Joint)
  );
  var math_abs = Math.abs;
  var math_PI = Math.PI;
  var DEFAULTS = {
    enableMotor: false,
    maxMotorTorque: 0,
    motorSpeed: 0,
    frequencyHz: 2,
    dampingRatio: 0.7
  };
  var WheelJoint = (
    /** @class */
    function(_super) {
      __extends(WheelJoint2, _super);
      function WheelJoint2(def, bodyA, bodyB, anchor, axis) {
        var _this = this;
        if (!(_this instanceof WheelJoint2)) {
          return new WheelJoint2(def, bodyA, bodyB, anchor, axis);
        }
        def = options(def, DEFAULTS);
        _this = _super.call(this, def, bodyA, bodyB) || this;
        bodyA = _this.m_bodyA;
        bodyB = _this.m_bodyB;
        _this.m_ax = Vec2.zero();
        _this.m_ay = Vec2.zero();
        _this.m_type = WheelJoint2.TYPE;
        _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());
        _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());
        if (Vec2.isValid(axis)) {
          _this.m_localXAxisA = bodyA.getLocalVector(axis);
        } else if (Vec2.isValid(def.localAxisA)) {
          _this.m_localXAxisA = Vec2.clone(def.localAxisA);
        } else if (Vec2.isValid(def.localAxis)) {
          _this.m_localXAxisA = Vec2.clone(def.localAxis);
        } else {
          _this.m_localXAxisA = Vec2.neo(1, 0);
        }
        _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);
        _this.m_mass = 0;
        _this.m_impulse = 0;
        _this.m_motorMass = 0;
        _this.m_motorImpulse = 0;
        _this.m_springMass = 0;
        _this.m_springImpulse = 0;
        _this.m_maxMotorTorque = def.maxMotorTorque;
        _this.m_motorSpeed = def.motorSpeed;
        _this.m_enableMotor = def.enableMotor;
        _this.m_frequencyHz = def.frequencyHz;
        _this.m_dampingRatio = def.dampingRatio;
        _this.m_bias = 0;
        _this.m_gamma = 0;
        return _this;
      }
      WheelJoint2.prototype._serialize = function() {
        return {
          type: this.m_type,
          bodyA: this.m_bodyA,
          bodyB: this.m_bodyB,
          collideConnected: this.m_collideConnected,
          enableMotor: this.m_enableMotor,
          maxMotorTorque: this.m_maxMotorTorque,
          motorSpeed: this.m_motorSpeed,
          frequencyHz: this.m_frequencyHz,
          dampingRatio: this.m_dampingRatio,
          localAnchorA: this.m_localAnchorA,
          localAnchorB: this.m_localAnchorB,
          localAxisA: this.m_localXAxisA
        };
      };
      WheelJoint2._deserialize = function(data, world, restore) {
        data = __assign({}, data);
        data.bodyA = restore(Body, data.bodyA, world);
        data.bodyB = restore(Body, data.bodyB, world);
        var joint = new WheelJoint2(data);
        return joint;
      };
      WheelJoint2.prototype._reset = function(def) {
        if (def.anchorA) {
          this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));
        } else if (def.localAnchorA) {
          this.m_localAnchorA.setVec2(def.localAnchorA);
        }
        if (def.anchorB) {
          this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));
        } else if (def.localAnchorB) {
          this.m_localAnchorB.setVec2(def.localAnchorB);
        }
        if (def.localAxisA) {
          this.m_localXAxisA.setVec2(def.localAxisA);
          this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));
        }
        if (def.enableMotor !== void 0) {
          this.m_enableMotor = def.enableMotor;
        }
        if (Number.isFinite(def.maxMotorTorque)) {
          this.m_maxMotorTorque = def.maxMotorTorque;
        }
        if (Number.isFinite(def.motorSpeed)) {
          this.m_motorSpeed = def.motorSpeed;
        }
        if (Number.isFinite(def.frequencyHz)) {
          this.m_frequencyHz = def.frequencyHz;
        }
        if (Number.isFinite(def.dampingRatio)) {
          this.m_dampingRatio = def.dampingRatio;
        }
      };
      WheelJoint2.prototype.getLocalAnchorA = function() {
        return this.m_localAnchorA;
      };
      WheelJoint2.prototype.getLocalAnchorB = function() {
        return this.m_localAnchorB;
      };
      WheelJoint2.prototype.getLocalAxisA = function() {
        return this.m_localXAxisA;
      };
      WheelJoint2.prototype.getJointTranslation = function() {
        var bA = this.m_bodyA;
        var bB = this.m_bodyB;
        var pA2 = bA.getWorldPoint(this.m_localAnchorA);
        var pB2 = bB.getWorldPoint(this.m_localAnchorB);
        var d2 = Vec2.sub(pB2, pA2);
        var axis = bA.getWorldVector(this.m_localXAxisA);
        var translation2 = Vec2.dot(d2, axis);
        return translation2;
      };
      WheelJoint2.prototype.getJointSpeed = function() {
        var wA = this.m_bodyA.m_angularVelocity;
        var wB = this.m_bodyB.m_angularVelocity;
        return wB - wA;
      };
      WheelJoint2.prototype.isMotorEnabled = function() {
        return this.m_enableMotor;
      };
      WheelJoint2.prototype.enableMotor = function(flag) {
        if (flag == this.m_enableMotor)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_enableMotor = flag;
      };
      WheelJoint2.prototype.setMotorSpeed = function(speed) {
        if (speed == this.m_motorSpeed)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_motorSpeed = speed;
      };
      WheelJoint2.prototype.getMotorSpeed = function() {
        return this.m_motorSpeed;
      };
      WheelJoint2.prototype.setMaxMotorTorque = function(torque) {
        if (torque == this.m_maxMotorTorque)
          return;
        this.m_bodyA.setAwake(true);
        this.m_bodyB.setAwake(true);
        this.m_maxMotorTorque = torque;
      };
      WheelJoint2.prototype.getMaxMotorTorque = function() {
        return this.m_maxMotorTorque;
      };
      WheelJoint2.prototype.getMotorTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      WheelJoint2.prototype.setSpringFrequencyHz = function(hz) {
        this.m_frequencyHz = hz;
      };
      WheelJoint2.prototype.getSpringFrequencyHz = function() {
        return this.m_frequencyHz;
      };
      WheelJoint2.prototype.setSpringDampingRatio = function(ratio) {
        this.m_dampingRatio = ratio;
      };
      WheelJoint2.prototype.getSpringDampingRatio = function() {
        return this.m_dampingRatio;
      };
      WheelJoint2.prototype.getAnchorA = function() {
        return this.m_bodyA.getWorldPoint(this.m_localAnchorA);
      };
      WheelJoint2.prototype.getAnchorB = function() {
        return this.m_bodyB.getWorldPoint(this.m_localAnchorB);
      };
      WheelJoint2.prototype.getReactionForce = function(inv_dt) {
        return Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax).mul(inv_dt);
      };
      WheelJoint2.prototype.getReactionTorque = function(inv_dt) {
        return inv_dt * this.m_motorImpulse;
      };
      WheelJoint2.prototype.initVelocityConstraints = function(step) {
        this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;
        this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;
        this.m_invMassA = this.m_bodyA.m_invMass;
        this.m_invMassB = this.m_bodyB.m_invMass;
        this.m_invIA = this.m_bodyA.m_invI;
        this.m_invIB = this.m_bodyB.m_invI;
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        {
          this.m_ay = Rot.mulVec2(qA, this.m_localYAxisA);
          this.m_sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ay);
          this.m_sBy = Vec2.crossVec2Vec2(rB2, this.m_ay);
          this.m_mass = mA + mB + iA * this.m_sAy * this.m_sAy + iB * this.m_sBy * this.m_sBy;
          if (this.m_mass > 0) {
            this.m_mass = 1 / this.m_mass;
          }
        }
        this.m_springMass = 0;
        this.m_bias = 0;
        this.m_gamma = 0;
        if (this.m_frequencyHz > 0) {
          this.m_ax = Rot.mulVec2(qA, this.m_localXAxisA);
          this.m_sAx = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ax);
          this.m_sBx = Vec2.crossVec2Vec2(rB2, this.m_ax);
          var invMass = mA + mB + iA * this.m_sAx * this.m_sAx + iB * this.m_sBx * this.m_sBx;
          if (invMass > 0) {
            this.m_springMass = 1 / invMass;
            var C = Vec2.dot(d2, this.m_ax);
            var omega = 2 * math_PI * this.m_frequencyHz;
            var damp = 2 * this.m_springMass * this.m_dampingRatio * omega;
            var k = this.m_springMass * omega * omega;
            var h = step.dt;
            this.m_gamma = h * (damp + h * k);
            if (this.m_gamma > 0) {
              this.m_gamma = 1 / this.m_gamma;
            }
            this.m_bias = C * h * k * this.m_gamma;
            this.m_springMass = invMass + this.m_gamma;
            if (this.m_springMass > 0) {
              this.m_springMass = 1 / this.m_springMass;
            }
          }
        } else {
          this.m_springImpulse = 0;
        }
        if (this.m_enableMotor) {
          this.m_motorMass = iA + iB;
          if (this.m_motorMass > 0) {
            this.m_motorMass = 1 / this.m_motorMass;
          }
        } else {
          this.m_motorMass = 0;
          this.m_motorImpulse = 0;
        }
        if (step.warmStarting) {
          this.m_impulse *= step.dtRatio;
          this.m_springImpulse *= step.dtRatio;
          this.m_motorImpulse *= step.dtRatio;
          var P3 = Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax);
          var LA = this.m_impulse * this.m_sAy + this.m_springImpulse * this.m_sAx + this.m_motorImpulse;
          var LB = this.m_impulse * this.m_sBy + this.m_springImpulse * this.m_sBx + this.m_motorImpulse;
          vA2.subMul(this.m_invMassA, P3);
          wA -= this.m_invIA * LA;
          vB2.addMul(this.m_invMassB, P3);
          wB += this.m_invIB * LB;
        } else {
          this.m_impulse = 0;
          this.m_springImpulse = 0;
          this.m_motorImpulse = 0;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      WheelJoint2.prototype.solveVelocityConstraints = function(step) {
        var mA = this.m_invMassA;
        var mB = this.m_invMassB;
        var iA = this.m_invIA;
        var iB = this.m_invIB;
        var vA2 = this.m_bodyA.c_velocity.v;
        var wA = this.m_bodyA.c_velocity.w;
        var vB2 = this.m_bodyB.c_velocity.v;
        var wB = this.m_bodyB.c_velocity.w;
        {
          var Cdot = Vec2.dot(this.m_ax, vB2) - Vec2.dot(this.m_ax, vA2) + this.m_sBx * wB - this.m_sAx * wA;
          var impulse = -this.m_springMass * (Cdot + this.m_bias + this.m_gamma * this.m_springImpulse);
          this.m_springImpulse += impulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_ax);
          var LA = impulse * this.m_sAx;
          var LB = impulse * this.m_sBx;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        {
          var Cdot = wB - wA - this.m_motorSpeed;
          var impulse = -this.m_motorMass * Cdot;
          var oldImpulse = this.m_motorImpulse;
          var maxImpulse = step.dt * this.m_maxMotorTorque;
          this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);
          impulse = this.m_motorImpulse - oldImpulse;
          wA -= iA * impulse;
          wB += iB * impulse;
        }
        {
          var Cdot = Vec2.dot(this.m_ay, vB2) - Vec2.dot(this.m_ay, vA2) + this.m_sBy * wB - this.m_sAy * wA;
          var impulse = -this.m_mass * Cdot;
          this.m_impulse += impulse;
          var P3 = Vec2.mulNumVec2(impulse, this.m_ay);
          var LA = impulse * this.m_sAy;
          var LB = impulse * this.m_sBy;
          vA2.subMul(mA, P3);
          wA -= iA * LA;
          vB2.addMul(mB, P3);
          wB += iB * LB;
        }
        this.m_bodyA.c_velocity.v.setVec2(vA2);
        this.m_bodyA.c_velocity.w = wA;
        this.m_bodyB.c_velocity.v.setVec2(vB2);
        this.m_bodyB.c_velocity.w = wB;
      };
      WheelJoint2.prototype.solvePositionConstraints = function(step) {
        var cA2 = this.m_bodyA.c_position.c;
        var aA = this.m_bodyA.c_position.a;
        var cB2 = this.m_bodyB.c_position.c;
        var aB = this.m_bodyB.c_position.a;
        var qA = Rot.neo(aA);
        var qB = Rot.neo(aB);
        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));
        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));
        var d2 = Vec2.zero();
        d2.addCombine(1, cB2, 1, rB2);
        d2.subCombine(1, cA2, 1, rA2);
        var ay = Rot.mulVec2(qA, this.m_localYAxisA);
        var sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), ay);
        var sBy = Vec2.crossVec2Vec2(rB2, ay);
        var C = Vec2.dot(d2, ay);
        var k = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_sAy * this.m_sAy + this.m_invIB * this.m_sBy * this.m_sBy;
        var impulse = k != 0 ? -C / k : 0;
        var P3 = Vec2.mulNumVec2(impulse, ay);
        var LA = impulse * sAy;
        var LB = impulse * sBy;
        cA2.subMul(this.m_invMassA, P3);
        aA -= this.m_invIA * LA;
        cB2.addMul(this.m_invMassB, P3);
        aB += this.m_invIB * LB;
        this.m_bodyA.c_position.c.setVec2(cA2);
        this.m_bodyA.c_position.a = aA;
        this.m_bodyB.c_position.c.setVec2(cB2);
        this.m_bodyB.c_position.a = aB;
        return math_abs(C) <= SettingsInternal.linearSlop;
      };
      WheelJoint2.TYPE = "wheel-joint";
      return WheelJoint2;
    }(Joint)
  );
  var _a;
  var SID = 0;
  var SERIALIZE_REF_TYPES = {
    "World": World,
    "Body": Body,
    "Joint": Joint,
    "Fixture": Fixture,
    "Shape": Shape
  };
  var DESERIALIZE_BY_REF_TYPE = {
    "Vec2": Vec2,
    "Vec3": Vec3,
    "World": World,
    "Body": Body,
    "Joint": Joint,
    "Fixture": Fixture,
    "Shape": Shape
  };
  var DESERIALIZE_BY_TYPE_FIELD = (_a = {}, _a[Body.STATIC] = Body, _a[Body.DYNAMIC] = Body, _a[Body.KINEMATIC] = Body, _a[ChainShape.TYPE] = ChainShape, // [BoxShape.TYPE]: BoxShape,
  _a[PolygonShape.TYPE] = PolygonShape, _a[EdgeShape.TYPE] = EdgeShape, _a[CircleShape.TYPE] = CircleShape, _a[DistanceJoint.TYPE] = DistanceJoint, _a[FrictionJoint.TYPE] = FrictionJoint, _a[GearJoint.TYPE] = GearJoint, _a[MotorJoint.TYPE] = MotorJoint, _a[MouseJoint.TYPE] = MouseJoint, _a[PrismaticJoint.TYPE] = PrismaticJoint, _a[PulleyJoint.TYPE] = PulleyJoint, _a[RevoluteJoint.TYPE] = RevoluteJoint, _a[RopeJoint.TYPE] = RopeJoint, _a[WeldJoint.TYPE] = WeldJoint, _a[WheelJoint.TYPE] = WheelJoint, _a);
  var DEFAULT_OPTIONS = {
    rootClass: World,
    preSerialize: function(obj) {
      return obj;
    },
    postSerialize: function(data, obj) {
      return data;
    },
    preDeserialize: function(data) {
      return data;
    },
    postDeserialize: function(obj, data) {
      return obj;
    }
  };
  var Serializer = (
    /** @class */
    /* @__PURE__ */ function() {
      function Serializer2(options2) {
        var _this = this;
        this.toJson = function(root) {
          var preSerialize = _this.options.preSerialize;
          var postSerialize = _this.options.postSerialize;
          var json = [];
          var refQueue = [root];
          var refMemoById = {};
          function addToRefQueue(value, typeName) {
            value.__sid = value.__sid || ++SID;
            if (!refMemoById[value.__sid]) {
              refQueue.push(value);
              var index = json.length + refQueue.length;
              var ref = {
                refIndex: index,
                refType: typeName
              };
              refMemoById[value.__sid] = ref;
            }
            return refMemoById[value.__sid];
          }
          function serializeWithHooks(obj2) {
            obj2 = preSerialize(obj2);
            var data = obj2._serialize();
            data = postSerialize(data, obj2);
            return data;
          }
          function traverse(value, noRefType) {
            if (noRefType === void 0) {
              noRefType = false;
            }
            if (typeof value !== "object" || value === null) {
              return value;
            }
            if (typeof value._serialize === "function") {
              if (!noRefType) {
                for (var typeName in SERIALIZE_REF_TYPES) {
                  if (value instanceof SERIALIZE_REF_TYPES[typeName]) {
                    return addToRefQueue(value, typeName);
                  }
                }
              }
              value = serializeWithHooks(value);
            }
            if (Array.isArray(value)) {
              var newValue = [];
              for (var key = 0; key < value.length; key++) {
                newValue[key] = traverse(value[key]);
              }
              value = newValue;
            } else {
              var newValue = {};
              for (var key in value) {
                if (value.hasOwnProperty(key)) {
                  newValue[key] = traverse(value[key]);
                }
              }
              value = newValue;
            }
            return value;
          }
          while (refQueue.length) {
            var obj = refQueue.shift();
            var str = traverse(obj, true);
            json.push(str);
          }
          return json;
        };
        this.fromJson = function(json) {
          var preDeserialize = _this.options.preDeserialize;
          var postDeserialize = _this.options.postDeserialize;
          var rootClass = _this.options.rootClass;
          var deserializedRefMemoByIndex = {};
          function deserializeWithHooks(classHint, data, context) {
            if (!classHint || !classHint._deserialize) {
              classHint = DESERIALIZE_BY_TYPE_FIELD[data.type];
            }
            var deserializer = classHint && classHint._deserialize;
            if (!deserializer) {
              return;
            }
            data = preDeserialize(data);
            var classDeserializeFn = classHint._deserialize;
            var obj = classDeserializeFn(data, context, deserializeChild);
            obj = postDeserialize(obj, data);
            return obj;
          }
          function deserializeChild(classHint, dataOrRef, context) {
            var isRefObject = dataOrRef.refIndex && dataOrRef.refType;
            if (!isRefObject) {
              return deserializeWithHooks(classHint, dataOrRef, context);
            }
            var ref = dataOrRef;
            if (DESERIALIZE_BY_REF_TYPE[ref.refType]) {
              classHint = DESERIALIZE_BY_REF_TYPE[ref.refType];
            }
            var refIndex = ref.refIndex;
            if (!deserializedRefMemoByIndex[refIndex]) {
              var data = json[refIndex];
              var obj = deserializeWithHooks(classHint, data, context);
              deserializedRefMemoByIndex[refIndex] = obj;
            }
            return deserializedRefMemoByIndex[refIndex];
          }
          var root = deserializeWithHooks(rootClass, json[0], null);
          return root;
        };
        this.options = __assign(__assign({}, DEFAULT_OPTIONS), options2);
      }
      return Serializer2;
    }()
  );
  var worldSerializer = new Serializer({
    rootClass: World
  });
  Serializer.fromJson = worldSerializer.fromJson;
  Serializer.toJson = worldSerializer.toJson;
  var Testbed = (
    /** @class */
    function() {
      function Testbed2() {
      }
      Testbed2.mount = function(options2) {
        throw new Error("Not implemented");
      };
      Testbed2.start = function(world) {
        var testbed2 = Testbed2.mount();
        testbed2.start(world);
        return testbed2;
      };
      return Testbed2;
    }()
  );
  function testbed(a2, b2) {
    var callback;
    var options2;
    if (typeof a2 === "function") {
      callback = a2;
      options2 = b2;
    } else if (typeof b2 === "function") {
      callback = b2;
      options2 = a2;
    } else {
      options2 = a2 !== null && a2 !== void 0 ? a2 : b2;
    }
    var testbed2 = Testbed.mount(options2);
    if (callback) {
      var world = callback(testbed2) || testbed2.world;
      testbed2.start(world);
    } else {
      return testbed2;
    }
  }
  var BoxShape = (
    /** @class */
    function(_super) {
      __extends(BoxShape2, _super);
      function BoxShape2(halfWidth, halfHeight, center2, angle) {
        var _this = this;
        if (!(_this instanceof BoxShape2)) {
          return new BoxShape2(halfWidth, halfHeight, center2, angle);
        }
        _this = _super.call(this) || this;
        _this._setAsBox(halfWidth, halfHeight, center2, angle);
        return _this;
      }
      BoxShape2.TYPE = "polygon";
      return BoxShape2;
    }(PolygonShape)
  );
  Contact.addType(CircleShape.TYPE, CircleShape.TYPE, CircleCircleContact);
  function CircleCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollideCircles(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  var pA = vec2(0, 0);
  var pB = vec2(0, 0);
  var CollideCircles = function(manifold, circleA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    transformVec2(pA, xfA2, circleA.m_p);
    transformVec2(pB, xfB2, circleB.m_p);
    var distSqr = distSqrVec2(pB, pA);
    var rA2 = circleA.m_radius;
    var rB2 = circleB.m_radius;
    var radius = rA2 + rB2;
    if (distSqr > radius * radius) {
      return;
    }
    manifold.type = exports2.ManifoldType.e_circles;
    copyVec2(manifold.localPoint, circleA.m_p);
    zeroVec2(manifold.localNormal);
    manifold.pointCount = 1;
    copyVec2(manifold.points[0].localPoint, circleB.m_p);
    manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
  };
  Contact.addType(EdgeShape.TYPE, CircleShape.TYPE, EdgeCircleContact);
  Contact.addType(ChainShape.TYPE, CircleShape.TYPE, ChainCircleContact);
  function EdgeCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    var shapeA = fixtureA.getShape();
    var shapeB = fixtureB.getShape();
    CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);
  }
  function ChainCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    var chain = fixtureA.getShape();
    var edge = new EdgeShape();
    chain.getChildEdge(edge, indexA);
    var shapeA = edge;
    var shapeB = fixtureB.getShape();
    CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);
  }
  var e = vec2(0, 0);
  var e1 = vec2(0, 0);
  var e2 = vec2(0, 0);
  var Q = vec2(0, 0);
  var P = vec2(0, 0);
  var n$2 = vec2(0, 0);
  var CollideEdgeCircle = function(manifold, edgeA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    retransformVec2(Q, xfB2, xfA2, circleB.m_p);
    var A = edgeA.m_vertex1;
    var B = edgeA.m_vertex2;
    subVec2(e, B, A);
    var u = dotVec2(e, B) - dotVec2(e, Q);
    var v3 = dotVec2(e, Q) - dotVec2(e, A);
    var radius = edgeA.m_radius + circleB.m_radius;
    if (v3 <= 0) {
      copyVec2(P, A);
      var dd_1 = distSqrVec2(Q, A);
      if (dd_1 > radius * radius) {
        return;
      }
      if (edgeA.m_hasVertex0) {
        var A1 = edgeA.m_vertex0;
        var B1 = A;
        subVec2(e1, B1, A1);
        var u1 = dotVec2(e1, B1) - dotVec2(e1, Q);
        if (u1 > 0) {
          return;
        }
      }
      manifold.type = exports2.ManifoldType.e_circles;
      zeroVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, P);
      manifold.pointCount = 1;
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    if (u <= 0) {
      copyVec2(P, B);
      var dd_2 = distSqrVec2(Q, P);
      if (dd_2 > radius * radius) {
        return;
      }
      if (edgeA.m_hasVertex3) {
        var B2 = edgeA.m_vertex3;
        var A2 = B;
        subVec2(e2, B2, A2);
        var v22 = dotVec2(e2, Q) - dotVec2(e2, A2);
        if (v22 > 0) {
          return;
        }
      }
      manifold.type = exports2.ManifoldType.e_circles;
      zeroVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, P);
      manifold.pointCount = 1;
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(1, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    var den = lengthSqrVec2(e);
    combine2Vec2(P, u / den, A, v3 / den, B);
    var dd = distSqrVec2(Q, P);
    if (dd > radius * radius) {
      return;
    }
    crossNumVec2(n$2, 1, e);
    if (dotVec2(n$2, Q) - dotVec2(n$2, A) < 0) {
      negVec2(n$2);
    }
    normalizeVec2(n$2);
    manifold.type = exports2.ManifoldType.e_faceA;
    copyVec2(manifold.localNormal, n$2);
    copyVec2(manifold.localPoint, A);
    manifold.pointCount = 1;
    copyVec2(manifold.points[0].localPoint, circleB.m_p);
    manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_face, 0, exports2.ContactFeatureType.e_vertex);
  };
  var incidentEdge = [new ClipVertex(), new ClipVertex()];
  var clipPoints1$1 = [new ClipVertex(), new ClipVertex()];
  var clipPoints2$1 = [new ClipVertex(), new ClipVertex()];
  var clipSegmentToLineNormal = vec2(0, 0);
  var v1 = vec2(0, 0);
  var n$1 = vec2(0, 0);
  var xf$1 = transform(0, 0, 0);
  var v11 = vec2(0, 0);
  var v12 = vec2(0, 0);
  var localTangent = vec2(0, 0);
  var localNormal = vec2(0, 0);
  var planePoint = vec2(0, 0);
  var tangent = vec2(0, 0);
  var normal$1 = vec2(0, 0);
  var normal1$1 = vec2(0, 0);
  Contact.addType(PolygonShape.TYPE, PolygonShape.TYPE, PolygonContact);
  function PolygonContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollidePolygons(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  function findMaxSeparation(poly1, xf1, poly2, xf2, output2) {
    var count1 = poly1.m_count;
    var count2 = poly2.m_count;
    var n1s = poly1.m_normals;
    var v1s = poly1.m_vertices;
    var v2s = poly2.m_vertices;
    detransformTransform(xf$1, xf2, xf1);
    var bestIndex = 0;
    var maxSeparation2 = -Infinity;
    for (var i = 0; i < count1; ++i) {
      rotVec2(n$1, xf$1.q, n1s[i]);
      transformVec2(v1, xf$1, v1s[i]);
      var si = Infinity;
      for (var j = 0; j < count2; ++j) {
        var sij = dotVec2(n$1, v2s[j]) - dotVec2(n$1, v1);
        if (sij < si) {
          si = sij;
        }
      }
      if (si > maxSeparation2) {
        maxSeparation2 = si;
        bestIndex = i;
      }
    }
    output2.maxSeparation = maxSeparation2;
    output2.bestIndex = bestIndex;
  }
  function findIncidentEdge(clipVertex, poly1, xf1, edge12, poly2, xf2) {
    var normals1 = poly1.m_normals;
    var count2 = poly2.m_count;
    var vertices2 = poly2.m_vertices;
    var normals2 = poly2.m_normals;
    rerotVec2(normal1$1, xf2.q, xf1.q, normals1[edge12]);
    var index = 0;
    var minDot = Infinity;
    for (var i = 0; i < count2; ++i) {
      var dot = dotVec2(normal1$1, normals2[i]);
      if (dot < minDot) {
        minDot = dot;
        index = i;
      }
    }
    var i1 = index;
    var i2 = i1 + 1 < count2 ? i1 + 1 : 0;
    transformVec2(clipVertex[0].v, xf2, vertices2[i1]);
    clipVertex[0].id.setFeatures(edge12, exports2.ContactFeatureType.e_face, i1, exports2.ContactFeatureType.e_vertex);
    transformVec2(clipVertex[1].v, xf2, vertices2[i2]);
    clipVertex[1].id.setFeatures(edge12, exports2.ContactFeatureType.e_face, i2, exports2.ContactFeatureType.e_vertex);
  }
  var maxSeparation = {
    maxSeparation: 0,
    bestIndex: 0
  };
  var CollidePolygons = function(manifold, polyA, xfA2, polyB, xfB2) {
    manifold.pointCount = 0;
    var totalRadius = polyA.m_radius + polyB.m_radius;
    findMaxSeparation(polyA, xfA2, polyB, xfB2, maxSeparation);
    var edgeA = maxSeparation.bestIndex;
    var separationA = maxSeparation.maxSeparation;
    if (separationA > totalRadius)
      return;
    findMaxSeparation(polyB, xfB2, polyA, xfA2, maxSeparation);
    var edgeB = maxSeparation.bestIndex;
    var separationB = maxSeparation.maxSeparation;
    if (separationB > totalRadius)
      return;
    var poly1;
    var poly2;
    var xf1;
    var xf2;
    var edge12;
    var flip;
    var k_tol = 0.1 * SettingsInternal.linearSlop;
    if (separationB > separationA + k_tol) {
      poly1 = polyB;
      poly2 = polyA;
      xf1 = xfB2;
      xf2 = xfA2;
      edge12 = edgeB;
      manifold.type = exports2.ManifoldType.e_faceB;
      flip = true;
    } else {
      poly1 = polyA;
      poly2 = polyB;
      xf1 = xfA2;
      xf2 = xfB2;
      edge12 = edgeA;
      manifold.type = exports2.ManifoldType.e_faceA;
      flip = false;
    }
    incidentEdge[0].recycle();
    incidentEdge[1].recycle();
    findIncidentEdge(incidentEdge, poly1, xf1, edge12, poly2, xf2);
    var count1 = poly1.m_count;
    var vertices1 = poly1.m_vertices;
    var iv1 = edge12;
    var iv2 = edge12 + 1 < count1 ? edge12 + 1 : 0;
    copyVec2(v11, vertices1[iv1]);
    copyVec2(v12, vertices1[iv2]);
    subVec2(localTangent, v12, v11);
    normalizeVec2(localTangent);
    crossVec2Num(localNormal, localTangent, 1);
    combine2Vec2(planePoint, 0.5, v11, 0.5, v12);
    rotVec2(tangent, xf1.q, localTangent);
    crossVec2Num(normal$1, tangent, 1);
    transformVec2(v11, xf1, v11);
    transformVec2(v12, xf1, v12);
    var frontOffset = dotVec2(normal$1, v11);
    var sideOffset1 = -dotVec2(tangent, v11) + totalRadius;
    var sideOffset2 = dotVec2(tangent, v12) + totalRadius;
    clipPoints1$1[0].recycle();
    clipPoints1$1[1].recycle();
    clipPoints2$1[0].recycle();
    clipPoints2$1[1].recycle();
    setVec2(clipSegmentToLineNormal, -tangent.x, -tangent.y);
    var np1 = clipSegmentToLine(clipPoints1$1, incidentEdge, clipSegmentToLineNormal, sideOffset1, iv1);
    if (np1 < 2) {
      return;
    }
    setVec2(clipSegmentToLineNormal, tangent.x, tangent.y);
    var np2 = clipSegmentToLine(clipPoints2$1, clipPoints1$1, clipSegmentToLineNormal, sideOffset2, iv2);
    if (np2 < 2) {
      return;
    }
    copyVec2(manifold.localNormal, localNormal);
    copyVec2(manifold.localPoint, planePoint);
    var pointCount = 0;
    for (var i = 0; i < clipPoints2$1.length; ++i) {
      var separation = dotVec2(normal$1, clipPoints2$1[i].v) - frontOffset;
      if (separation <= totalRadius) {
        var cp = manifold.points[pointCount];
        detransformVec2(cp.localPoint, xf2, clipPoints2$1[i].v);
        cp.id.set(clipPoints2$1[i].id);
        if (flip) {
          cp.id.swapFeatures();
        }
        ++pointCount;
      }
    }
    manifold.pointCount = pointCount;
  };
  Contact.addType(PolygonShape.TYPE, CircleShape.TYPE, PolygonCircleContact);
  function PolygonCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {
    CollidePolygonCircle(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);
  }
  var cLocal = vec2(0, 0);
  var faceCenter = vec2(0, 0);
  var CollidePolygonCircle = function(manifold, polygonA, xfA2, circleB, xfB2) {
    manifold.pointCount = 0;
    retransformVec2(cLocal, xfB2, xfA2, circleB.m_p);
    var normalIndex = 0;
    var separation = -Infinity;
    var radius = polygonA.m_radius + circleB.m_radius;
    var vertexCount = polygonA.m_count;
    var vertices = polygonA.m_vertices;
    var normals = polygonA.m_normals;
    for (var i = 0; i < vertexCount; ++i) {
      var s2 = dotVec2(normals[i], cLocal) - dotVec2(normals[i], vertices[i]);
      if (s2 > radius) {
        return;
      }
      if (s2 > separation) {
        separation = s2;
        normalIndex = i;
      }
    }
    var vertIndex1 = normalIndex;
    var vertIndex2 = vertIndex1 + 1 < vertexCount ? vertIndex1 + 1 : 0;
    var v13 = vertices[vertIndex1];
    var v22 = vertices[vertIndex2];
    if (separation < EPSILON) {
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      copyVec2(manifold.localNormal, normals[normalIndex]);
      combine2Vec2(manifold.localPoint, 0.5, v13, 0.5, v22);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
      return;
    }
    var u1 = dotVec2(cLocal, v22) - dotVec2(cLocal, v13) - dotVec2(v13, v22) + dotVec2(v13, v13);
    var u2 = dotVec2(cLocal, v13) - dotVec2(cLocal, v22) - dotVec2(v22, v13) + dotVec2(v22, v22);
    if (u1 <= 0) {
      if (distSqrVec2(cLocal, v13) > radius * radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      subVec2(manifold.localNormal, cLocal, v13);
      normalizeVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, v13);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    } else if (u2 <= 0) {
      if (distSqrVec2(cLocal, v22) > radius * radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      subVec2(manifold.localNormal, cLocal, v22);
      normalizeVec2(manifold.localNormal);
      copyVec2(manifold.localPoint, v22);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    } else {
      combine2Vec2(faceCenter, 0.5, v13, 0.5, v22);
      var separation_1 = dotVec2(cLocal, normals[vertIndex1]) - dotVec2(faceCenter, normals[vertIndex1]);
      if (separation_1 > radius) {
        return;
      }
      manifold.pointCount = 1;
      manifold.type = exports2.ManifoldType.e_faceA;
      copyVec2(manifold.localNormal, normals[vertIndex1]);
      copyVec2(manifold.localPoint, faceCenter);
      copyVec2(manifold.points[0].localPoint, circleB.m_p);
      manifold.points[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, 0, exports2.ContactFeatureType.e_vertex);
    }
  };
  var math_min = Math.min;
  Contact.addType(EdgeShape.TYPE, PolygonShape.TYPE, EdgePolygonContact);
  Contact.addType(ChainShape.TYPE, PolygonShape.TYPE, ChainPolygonContact);
  function EdgePolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {
    CollideEdgePolygon(manifold, fA.getShape(), xfA2, fB.getShape(), xfB2);
  }
  var edge_reuse = new EdgeShape();
  function ChainPolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {
    var chain = fA.getShape();
    chain.getChildEdge(edge_reuse, indexA);
    CollideEdgePolygon(manifold, edge_reuse, xfA2, fB.getShape(), xfB2);
  }
  var EPAxisType;
  (function(EPAxisType2) {
    EPAxisType2[EPAxisType2["e_unknown"] = -1] = "e_unknown";
    EPAxisType2[EPAxisType2["e_edgeA"] = 1] = "e_edgeA";
    EPAxisType2[EPAxisType2["e_edgeB"] = 2] = "e_edgeB";
  })(EPAxisType || (EPAxisType = {}));
  var VertexType;
  (function(VertexType2) {
    VertexType2[VertexType2["e_isolated"] = 0] = "e_isolated";
    VertexType2[VertexType2["e_concave"] = 1] = "e_concave";
    VertexType2[VertexType2["e_convex"] = 2] = "e_convex";
  })(VertexType || (VertexType = {}));
  var EPAxis = (
    /** @class */
    /* @__PURE__ */ function() {
      function EPAxis2() {
      }
      return EPAxis2;
    }()
  );
  var TempPolygon = (
    /** @class */
    /* @__PURE__ */ function() {
      function TempPolygon2() {
        this.vertices = [];
        this.normals = [];
        this.count = 0;
        for (var i = 0; i < SettingsInternal.maxPolygonVertices; i++) {
          this.vertices.push(vec2(0, 0));
          this.normals.push(vec2(0, 0));
        }
      }
      return TempPolygon2;
    }()
  );
  var ReferenceFace = (
    /** @class */
    function() {
      function ReferenceFace2() {
        this.v1 = vec2(0, 0);
        this.v2 = vec2(0, 0);
        this.normal = vec2(0, 0);
        this.sideNormal1 = vec2(0, 0);
        this.sideNormal2 = vec2(0, 0);
      }
      ReferenceFace2.prototype.recycle = function() {
        zeroVec2(this.v1);
        zeroVec2(this.v2);
        zeroVec2(this.normal);
        zeroVec2(this.sideNormal1);
        zeroVec2(this.sideNormal2);
      };
      return ReferenceFace2;
    }()
  );
  var clipPoints1 = [new ClipVertex(), new ClipVertex()];
  var clipPoints2 = [new ClipVertex(), new ClipVertex()];
  var ie = [new ClipVertex(), new ClipVertex()];
  var edgeAxis = new EPAxis();
  var polygonAxis = new EPAxis();
  var polygonBA = new TempPolygon();
  var rf = new ReferenceFace();
  var centroidB = vec2(0, 0);
  var edge0 = vec2(0, 0);
  var edge1 = vec2(0, 0);
  var edge2 = vec2(0, 0);
  var xf = transform(0, 0, 0);
  var normal = vec2(0, 0);
  var normal0 = vec2(0, 0);
  var normal1 = vec2(0, 0);
  var normal2 = vec2(0, 0);
  var lowerLimit = vec2(0, 0);
  var upperLimit = vec2(0, 0);
  var perp = vec2(0, 0);
  var n = vec2(0, 0);
  var CollideEdgePolygon = function(manifold, edgeA, xfA2, polygonB, xfB2) {
    detransformTransform(xf, xfA2, xfB2);
    transformVec2(centroidB, xf, polygonB.m_centroid);
    var v0 = edgeA.m_vertex0;
    var v13 = edgeA.m_vertex1;
    var v22 = edgeA.m_vertex2;
    var v3 = edgeA.m_vertex3;
    var hasVertex0 = edgeA.m_hasVertex0;
    var hasVertex3 = edgeA.m_hasVertex3;
    subVec2(edge1, v22, v13);
    normalizeVec2(edge1);
    setVec2(normal1, edge1.y, -edge1.x);
    var offset1 = dotVec2(normal1, centroidB) - dotVec2(normal1, v13);
    var offset0 = 0;
    var offset2 = 0;
    var convex1 = false;
    var convex2 = false;
    zeroVec2(normal0);
    zeroVec2(normal2);
    if (hasVertex0) {
      subVec2(edge0, v13, v0);
      normalizeVec2(edge0);
      setVec2(normal0, edge0.y, -edge0.x);
      convex1 = crossVec2Vec2(edge0, edge1) >= 0;
      offset0 = Vec2.dot(normal0, centroidB) - Vec2.dot(normal0, v0);
    }
    if (hasVertex3) {
      subVec2(edge2, v3, v22);
      normalizeVec2(edge2);
      setVec2(normal2, edge2.y, -edge2.x);
      convex2 = Vec2.crossVec2Vec2(edge1, edge2) > 0;
      offset2 = Vec2.dot(normal2, centroidB) - Vec2.dot(normal2, v22);
    }
    var front;
    zeroVec2(normal);
    zeroVec2(lowerLimit);
    zeroVec2(upperLimit);
    if (hasVertex0 && hasVertex3) {
      if (convex1 && convex2) {
        front = offset0 >= 0 || offset1 >= 0 || offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else if (convex1) {
        front = offset0 >= 0 || offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else if (convex2) {
        front = offset2 >= 0 || offset0 >= 0 && offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          scaleVec2(upperLimit, -1, normal0);
        }
      } else {
        front = offset0 >= 0 && offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          scaleVec2(upperLimit, -1, normal0);
        }
      }
    } else if (hasVertex0) {
      if (convex1) {
        front = offset0 >= 0 || offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal0);
          scaleVec2(upperLimit, -1, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal1);
        }
      } else {
        front = offset0 >= 0 && offset1 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          copyVec2(lowerLimit, normal1);
          scaleVec2(upperLimit, -1, normal0);
        }
      }
    } else if (hasVertex3) {
      if (convex2) {
        front = offset1 >= 0 || offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal2);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal1);
        }
      } else {
        front = offset1 >= 0 && offset2 >= 0;
        if (front) {
          copyVec2(normal, normal1);
          scaleVec2(lowerLimit, -1, normal1);
          copyVec2(upperLimit, normal1);
        } else {
          scaleVec2(normal, -1, normal1);
          scaleVec2(lowerLimit, -1, normal2);
          copyVec2(upperLimit, normal1);
        }
      }
    } else {
      front = offset1 >= 0;
      if (front) {
        copyVec2(normal, normal1);
        scaleVec2(lowerLimit, -1, normal1);
        scaleVec2(upperLimit, -1, normal1);
      } else {
        scaleVec2(normal, -1, normal1);
        copyVec2(lowerLimit, normal1);
        copyVec2(upperLimit, normal1);
      }
    }
    polygonBA.count = polygonB.m_count;
    for (var i = 0; i < polygonB.m_count; ++i) {
      transformVec2(polygonBA.vertices[i], xf, polygonB.m_vertices[i]);
      rotVec2(polygonBA.normals[i], xf.q, polygonB.m_normals[i]);
    }
    var radius = polygonB.m_radius + edgeA.m_radius;
    manifold.pointCount = 0;
    {
      edgeAxis.type = EPAxisType.e_edgeA;
      edgeAxis.index = front ? 0 : 1;
      edgeAxis.separation = Infinity;
      for (var i = 0; i < polygonBA.count; ++i) {
        var v4 = polygonBA.vertices[i];
        var s2 = dotVec2(normal, v4) - dotVec2(normal, v13);
        if (s2 < edgeAxis.separation) {
          edgeAxis.separation = s2;
        }
      }
    }
    if (edgeAxis.type == EPAxisType.e_unknown) {
      return;
    }
    if (edgeAxis.separation > radius) {
      return;
    }
    {
      polygonAxis.type = EPAxisType.e_unknown;
      polygonAxis.index = -1;
      polygonAxis.separation = -Infinity;
      setVec2(perp, -normal.y, normal.x);
      for (var i = 0; i < polygonBA.count; ++i) {
        scaleVec2(n, -1, polygonBA.normals[i]);
        var s1 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v13);
        var s22 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v22);
        var s2 = math_min(s1, s22);
        if (s2 > radius) {
          polygonAxis.type = EPAxisType.e_edgeB;
          polygonAxis.index = i;
          polygonAxis.separation = s2;
          break;
        }
        if (dotVec2(n, perp) >= 0) {
          if (dotVec2(n, normal) - dotVec2(upperLimit, normal) < -SettingsInternal.angularSlop) {
            continue;
          }
        } else {
          if (dotVec2(n, normal) - dotVec2(lowerLimit, normal) < -SettingsInternal.angularSlop) {
            continue;
          }
        }
        if (s2 > polygonAxis.separation) {
          polygonAxis.type = EPAxisType.e_edgeB;
          polygonAxis.index = i;
          polygonAxis.separation = s2;
        }
      }
    }
    if (polygonAxis.type != EPAxisType.e_unknown && polygonAxis.separation > radius) {
      return;
    }
    var k_relativeTol = 0.98;
    var k_absoluteTol = 1e-3;
    var primaryAxis;
    if (polygonAxis.type == EPAxisType.e_unknown) {
      primaryAxis = edgeAxis;
    } else if (polygonAxis.separation > k_relativeTol * edgeAxis.separation + k_absoluteTol) {
      primaryAxis = polygonAxis;
    } else {
      primaryAxis = edgeAxis;
    }
    ie[0].recycle();
    ie[1].recycle();
    if (primaryAxis.type == EPAxisType.e_edgeA) {
      manifold.type = exports2.ManifoldType.e_faceA;
      var bestIndex = 0;
      var bestValue = dotVec2(normal, polygonBA.normals[0]);
      for (var i = 1; i < polygonBA.count; ++i) {
        var value = dotVec2(normal, polygonBA.normals[i]);
        if (value < bestValue) {
          bestValue = value;
          bestIndex = i;
        }
      }
      var i1 = bestIndex;
      var i2 = i1 + 1 < polygonBA.count ? i1 + 1 : 0;
      copyVec2(ie[0].v, polygonBA.vertices[i1]);
      ie[0].id.setFeatures(0, exports2.ContactFeatureType.e_face, i1, exports2.ContactFeatureType.e_vertex);
      copyVec2(ie[1].v, polygonBA.vertices[i2]);
      ie[1].id.setFeatures(0, exports2.ContactFeatureType.e_face, i2, exports2.ContactFeatureType.e_vertex);
      if (front) {
        rf.i1 = 0;
        rf.i2 = 1;
        copyVec2(rf.v1, v13);
        copyVec2(rf.v2, v22);
        copyVec2(rf.normal, normal1);
      } else {
        rf.i1 = 1;
        rf.i2 = 0;
        copyVec2(rf.v1, v22);
        copyVec2(rf.v2, v13);
        scaleVec2(rf.normal, -1, normal1);
      }
    } else {
      manifold.type = exports2.ManifoldType.e_faceB;
      copyVec2(ie[0].v, v13);
      ie[0].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, primaryAxis.index, exports2.ContactFeatureType.e_face);
      copyVec2(ie[1].v, v22);
      ie[1].id.setFeatures(0, exports2.ContactFeatureType.e_vertex, primaryAxis.index, exports2.ContactFeatureType.e_face);
      rf.i1 = primaryAxis.index;
      rf.i2 = rf.i1 + 1 < polygonBA.count ? rf.i1 + 1 : 0;
      copyVec2(rf.v1, polygonBA.vertices[rf.i1]);
      copyVec2(rf.v2, polygonBA.vertices[rf.i2]);
      copyVec2(rf.normal, polygonBA.normals[rf.i1]);
    }
    setVec2(rf.sideNormal1, rf.normal.y, -rf.normal.x);
    setVec2(rf.sideNormal2, -rf.sideNormal1.x, -rf.sideNormal1.y);
    rf.sideOffset1 = dotVec2(rf.sideNormal1, rf.v1);
    rf.sideOffset2 = dotVec2(rf.sideNormal2, rf.v2);
    clipPoints1[0].recycle();
    clipPoints1[1].recycle();
    clipPoints2[0].recycle();
    clipPoints2[1].recycle();
    var np1 = clipSegmentToLine(clipPoints1, ie, rf.sideNormal1, rf.sideOffset1, rf.i1);
    if (np1 < SettingsInternal.maxManifoldPoints) {
      return;
    }
    var np2 = clipSegmentToLine(clipPoints2, clipPoints1, rf.sideNormal2, rf.sideOffset2, rf.i2);
    if (np2 < SettingsInternal.maxManifoldPoints) {
      return;
    }
    if (primaryAxis.type == EPAxisType.e_edgeA) {
      copyVec2(manifold.localNormal, rf.normal);
      copyVec2(manifold.localPoint, rf.v1);
    } else {
      copyVec2(manifold.localNormal, polygonB.m_normals[rf.i1]);
      copyVec2(manifold.localPoint, polygonB.m_vertices[rf.i1]);
    }
    var pointCount = 0;
    for (var i = 0; i < SettingsInternal.maxManifoldPoints; ++i) {
      var separation = dotVec2(rf.normal, clipPoints2[i].v) - dotVec2(rf.normal, rf.v1);
      if (separation <= radius) {
        var cp = manifold.points[pointCount];
        if (primaryAxis.type == EPAxisType.e_edgeA) {
          detransformVec2(cp.localPoint, xf, clipPoints2[i].v);
          cp.id.set(clipPoints2[i].id);
        } else {
          copyVec2(cp.localPoint, clipPoints2[i].v);
          cp.id.set(clipPoints2[i].id);
          cp.id.swapFeatures();
        }
        ++pointCount;
      }
    }
    manifold.pointCount = pointCount;
  };
  var internal = {
    CollidePolygons,
    Settings,
    Sweep,
    Manifold,
    Distance,
    TimeOfImpact,
    DynamicTree,
    stats
  };
  var DataDriver = (
    /** @class */
    function() {
      function DataDriver2(key, listener) {
        this._refMap = {};
        this._map = {};
        this._xmap = {};
        this._data = [];
        this._entered = [];
        this._exited = [];
        this._key = key;
        this._listener = listener;
      }
      DataDriver2.prototype.update = function(data) {
        if (!Array.isArray(data))
          throw "Invalid data: " + data;
        this._entered.length = 0;
        this._exited.length = 0;
        this._data.length = data.length;
        for (var i = 0; i < data.length; i++) {
          if (typeof data[i] !== "object" || data[i] === null)
            continue;
          var d2 = data[i];
          var id = this._key(d2);
          if (!this._map[id]) {
            this._entered.push(d2);
          } else {
            delete this._map[id];
          }
          this._data[i] = d2;
          this._xmap[id] = d2;
        }
        for (var id in this._map) {
          this._exited.push(this._map[id]);
          delete this._map[id];
        }
        var temp3 = this._map;
        this._map = this._xmap;
        this._xmap = temp3;
        for (var i = 0; i < this._exited.length; i++) {
          var d2 = this._exited[i];
          var key = this._key(d2);
          var ref = this._refMap[key];
          this._listener.exit(d2, ref);
          delete this._refMap[key];
        }
        for (var i = 0; i < this._entered.length; i++) {
          var d2 = this._entered[i];
          var key = this._key(d2);
          var ref = this._listener.enter(d2);
          if (ref) {
            this._refMap[key] = ref;
          }
        }
        for (var i = 0; i < this._data.length; i++) {
          if (typeof data[i] !== "object" || data[i] === null)
            continue;
          var d2 = this._data[i];
          var key = this._key(d2);
          var ref = this._refMap[key];
          this._listener.update(d2, ref);
        }
        this._entered.length = 0;
        this._exited.length = 0;
        this._data.length = 0;
      };
      DataDriver2.prototype.ref = function(d2) {
        return this._refMap[this._key(d2)];
      };
      return DataDriver2;
    }()
  );
  const planck = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
    __proto__: null,
    AABB,
    Body,
    Box: BoxShape,
    BoxShape,
    BroadPhase,
    Chain: ChainShape,
    ChainShape,
    Circle: CircleShape,
    CircleShape,
    ClipVertex,
    CollideCircles,
    CollideEdgeCircle,
    CollideEdgePolygon,
    CollidePolygonCircle,
    CollidePolygons,
    Contact,
    ContactEdge,
    get ContactFeatureType() {
      return exports2.ContactFeatureType;
    },
    ContactID,
    ContactImpulse,
    DataDriver,
    Distance,
    DistanceInput,
    DistanceJoint,
    DistanceOutput,
    DistanceProxy,
    DynamicTree,
    Edge: EdgeShape,
    EdgeShape,
    Fixture,
    FixtureProxy,
    FrictionJoint,
    GearJoint,
    Joint,
    JointEdge,
    Manifold,
    ManifoldPoint,
    get ManifoldType() {
      return exports2.ManifoldType;
    },
    Mat22,
    Mat33,
    Math: math,
    MotorJoint,
    MouseJoint,
    get PointState() {
      return exports2.PointState;
    },
    Polygon: PolygonShape,
    PolygonShape,
    PrismaticJoint,
    PulleyJoint,
    RevoluteJoint,
    RopeJoint,
    Rot,
    Serializer,
    Settings,
    SettingsInternal,
    Shape,
    ShapeCast,
    ShapeCastInput,
    ShapeCastOutput,
    SimplexCache,
    Solver,
    Sweep,
    TOIInput,
    TOIOutput,
    get TOIOutputState() {
      return exports2.TOIOutputState;
    },
    Testbed,
    TimeOfImpact,
    TimeStep,
    Transform,
    TreeNode,
    Vec2,
    Vec3,
    VelocityConstraintPoint,
    WeldJoint,
    WheelJoint,
    World,
    WorldManifold,
    clipSegmentToLine,
    getPointStates,
    internal,
    mixFriction,
    mixRestitution,
    stats,
    testOverlap,
    testbed
  }, Symbol.toStringTag, { value: "Module" }));
  exports2.AABB = AABB;
  exports2.Body = Body;
  exports2.Box = BoxShape;
  exports2.BoxShape = BoxShape;
  exports2.BroadPhase = BroadPhase;
  exports2.Chain = ChainShape;
  exports2.ChainShape = ChainShape;
  exports2.Circle = CircleShape;
  exports2.CircleShape = CircleShape;
  exports2.ClipVertex = ClipVertex;
  exports2.CollideCircles = CollideCircles;
  exports2.CollideEdgeCircle = CollideEdgeCircle;
  exports2.CollideEdgePolygon = CollideEdgePolygon;
  exports2.CollidePolygonCircle = CollidePolygonCircle;
  exports2.CollidePolygons = CollidePolygons;
  exports2.Contact = Contact;
  exports2.ContactEdge = ContactEdge;
  exports2.ContactID = ContactID;
  exports2.ContactImpulse = ContactImpulse;
  exports2.DataDriver = DataDriver;
  exports2.Distance = Distance;
  exports2.DistanceInput = DistanceInput;
  exports2.DistanceJoint = DistanceJoint;
  exports2.DistanceOutput = DistanceOutput;
  exports2.DistanceProxy = DistanceProxy;
  exports2.DynamicTree = DynamicTree;
  exports2.Edge = EdgeShape;
  exports2.EdgeShape = EdgeShape;
  exports2.Fixture = Fixture;
  exports2.FixtureProxy = FixtureProxy;
  exports2.FrictionJoint = FrictionJoint;
  exports2.GearJoint = GearJoint;
  exports2.Joint = Joint;
  exports2.JointEdge = JointEdge;
  exports2.Manifold = Manifold;
  exports2.ManifoldPoint = ManifoldPoint;
  exports2.Mat22 = Mat22;
  exports2.Mat33 = Mat33;
  exports2.Math = math;
  exports2.MotorJoint = MotorJoint;
  exports2.MouseJoint = MouseJoint;
  exports2.Polygon = PolygonShape;
  exports2.PolygonShape = PolygonShape;
  exports2.PrismaticJoint = PrismaticJoint;
  exports2.PulleyJoint = PulleyJoint;
  exports2.RevoluteJoint = RevoluteJoint;
  exports2.RopeJoint = RopeJoint;
  exports2.Rot = Rot;
  exports2.Serializer = Serializer;
  exports2.Settings = Settings;
  exports2.SettingsInternal = SettingsInternal;
  exports2.Shape = Shape;
  exports2.ShapeCast = ShapeCast;
  exports2.ShapeCastInput = ShapeCastInput;
  exports2.ShapeCastOutput = ShapeCastOutput;
  exports2.SimplexCache = SimplexCache;
  exports2.Solver = Solver;
  exports2.Sweep = Sweep;
  exports2.TOIInput = TOIInput;
  exports2.TOIOutput = TOIOutput;
  exports2.Testbed = Testbed;
  exports2.TimeOfImpact = TimeOfImpact;
  exports2.TimeStep = TimeStep;
  exports2.Transform = Transform;
  exports2.TreeNode = TreeNode;
  exports2.Vec2 = Vec2;
  exports2.Vec3 = Vec3;
  exports2.VelocityConstraintPoint = VelocityConstraintPoint;
  exports2.WeldJoint = WeldJoint;
  exports2.WheelJoint = WheelJoint;
  exports2.World = World;
  exports2.WorldManifold = WorldManifold;
  exports2.clipSegmentToLine = clipSegmentToLine;
  exports2.default = planck;
  exports2.getPointStates = getPointStates;
  exports2.internal = internal;
  exports2.mixFriction = mixFriction;
  exports2.mixRestitution = mixRestitution;
  exports2.stats = stats;
  exports2.testOverlap = testOverlap;
  exports2.testbed = testbed;
  Object.defineProperties(exports2, { __esModule: { value: true }, [Symbol.toStringTag]: { value: "Module" } });
});
//# sourceMappingURL=planck.js.map


/***/ }),

/***/ "./src/core/asset-loader.ts":
/*!**********************************!*\
  !*** ./src/core/asset-loader.ts ***!
  \**********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.AssetLoader = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const event_system_1 = __webpack_require__(/*! ./event-system */ "./src/core/event-system.ts");
class AssetLoader {
    PIXIAssets = pixi_js_1.default.Assets;
    textures = [];
    isLoading = false;
    events = new event_system_1.EventEmitter();
    on(event, listener) {
        this.events.on(event, listener);
    }
    off(event, listener) {
        this.events.off(event, listener);
    }
    loadAssets = async (assets) => {
        const { PIXIAssets } = this;
        this.isLoading = true;
        this.events.emit('loading:start');
        try {
            for (let i = 0; i < assets.length; i++) {
                const { src, alias } = assets[i];
                if (alias) {
                    if (!PIXIAssets.cache.has(alias)) {
                        const texture = await PIXIAssets.load({ alias, src });
                        this.textures.push(texture);
                    }
                }
                else {
                    const texture = await PIXIAssets.load(src);
                    this.textures.push(texture);
                }
            }
            return this;
        }
        finally {
            this.isLoading = false;
            this.events.emit('loading:end');
        }
    };
}
exports.AssetLoader = AssetLoader;


/***/ }),

/***/ "./src/core/camera.ts":
/*!****************************!*\
  !*** ./src/core/camera.ts ***!
  \****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Camera = exports.CameraLogic = void 0;
const pixi_js_1 = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const logic_1 = __webpack_require__(/*! ./logic */ "./src/core/logic.ts");
const moxi_entity_1 = __webpack_require__(/*! ./moxi-entity */ "./src/core/moxi-entity.ts");
const utils_1 = __webpack_require__(/*! ../library/utils */ "./src/library/utils.ts");
class CameraLogic extends logic_1.Logic {
    name = 'CameraLogic';
    speed = 0.1;
    target = null;
    entity;
    renderer;
    init(entity, renderer) {
        this.entity = entity;
        this.renderer = renderer;
    }
    update(entity, deltaTime) {
        const { speed } = this;
        const deltaSpeed = Math.min(deltaTime * speed, 1);
        const isZooming = Math.abs(entity.scale.x - entity.desiredScale.x) > 0.01 ||
            Math.abs(entity.scale.y - entity.desiredScale.y) > 0.01;
        if (entity.desiredScale !== entity.scale) {
            entity.scale.x = (0, utils_1.lerp)(entity.scale.x, entity.desiredScale.x, deltaSpeed);
            entity.scale.y = (0, utils_1.lerp)(entity.scale.y, entity.desiredScale.y, deltaSpeed);
        }
        if (this.target) {
            const screenCenterX = this.renderer.width / 2;
            const screenCenterY = this.renderer.height / 2;
            const desiredX = -(this.target.position.x * entity.scale.x) + screenCenterX;
            const desiredY = -(this.target.position.y * entity.scale.y) + screenCenterY;
            entity.desiredPosition.set(-desiredX, -desiredY);
        }
        if (entity.desiredPosition !== entity.position) {
            if (isZooming) {
                entity.position.copyFrom(entity.desiredPosition);
            }
            else {
                entity.position.x = (0, utils_1.lerp)(entity.position.x, entity.desiredPosition.x, deltaSpeed);
                entity.position.y = (0, utils_1.lerp)(entity.position.y, entity.desiredPosition.y, deltaSpeed);
            }
        }
        entity.scene.scale.set(entity.scale.x, entity.scale.y);
        entity.scene.position.set(-entity.position.x, -entity.position.y);
    }
}
exports.CameraLogic = CameraLogic;
class Camera extends pixi_js_1.default.Container {
    scene;
    renderer;
    speed = 0.1;
    moxiEntity;
    desiredScale = new pixi_js_1.Point(1, 1);
    desiredPosition = new pixi_js_1.Point(0, 0);
    constructor(scene, renderer, logic = {}) {
        super();
        this.scene = scene;
        this.renderer = renderer;
        const cameraLogic = new CameraLogic();
        cameraLogic.init(this, renderer);
        this.moxiEntity = new moxi_entity_1.MoxiEntity(this, logic);
        this.moxiEntity.addLogic(cameraLogic);
        this.scene.addChild(this);
    }
}
exports.Camera = Camera;


/***/ }),

/***/ "./src/core/engine.ts":
/*!****************************!*\
  !*** ./src/core/engine.ts ***!
  \****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Engine = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
class Engine {
    ticker;
    root;
    physicsWorld;
    logger;
    loggerFrequencyMs;
    nextLogTime;
    constructor(stage = null) {
        this.root = stage;
        const ticker = pixi_js_1.default.Ticker.shared;
        ticker.autoStart = false;
        ticker.add(this.gameLoop);
        this.ticker = ticker;
        this.loggerFrequencyMs = 500;
        this.nextLogTime = 0;
        this.logger = (msg) => null;
    }
    start() {
        this.ticker.start();
        return this;
    }
    stop() {
        this.ticker.stop();
        return this;
    }
    addPhysicsWorld(physicsWorld) {
        this.physicsWorld = physicsWorld;
        return this;
    }
    gameLoop = (tikerTime) => {
        if (this.root) {
            const { deltaTime, deltaMS } = tikerTime;
            if (this.physicsWorld) {
                const deltaSeconds = deltaMS / 1000;
                this.physicsWorld.step(deltaSeconds);
            }
            this.root.update(deltaTime);
            this.root.draw(deltaTime);
        }
    };
    loadStage(stage) {
        this.root = stage;
        return this;
    }
}
exports.Engine = Engine;


/***/ }),

/***/ "./src/core/event-system.ts":
/*!**********************************!*\
  !*** ./src/core/event-system.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.EventEmitter = void 0;
class EventEmitter {
    listeners = {};
    static instance = new EventEmitter();
    on(event, listener) {
        (this.listeners[event] || (this.listeners[event] = [])).push(listener);
    }
    off(event, listener) {
        const eventListeners = this.listeners[event];
        if (eventListeners) {
            this.listeners[event] = eventListeners.filter(l => l !== listener);
        }
    }
    emit(event, ...args) {
        (this.listeners[event] || []).forEach(listener => listener(...args));
    }
    once(event, listener) {
        const onceListener = (...args) => {
            listener(...args);
            this.off(event, listener);
        };
        this.on(event, onceListener);
    }
    static getInstance() {
        if (!EventEmitter.instance) {
            EventEmitter.instance = new EventEmitter();
        }
        return EventEmitter.instance;
    }
}
exports.EventEmitter = EventEmitter;


/***/ }),

/***/ "./src/core/logic.ts":
/*!***************************!*\
  !*** ./src/core/logic.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.InstancedLogic = exports.Logic = void 0;
class Logic {
    name;
    active = true;
    init(entity, renderer, ...args) {
    }
    update(entity, deltaTime) {
    }
}
exports.Logic = Logic;
class InstancedLogic extends Logic {
}
exports.InstancedLogic = InstancedLogic;


/***/ }),

/***/ "./src/core/moxi-entity.ts":
/*!*********************************!*\
  !*** ./src/core/moxi-entity.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.MoxiEntity = void 0;
exports.asEntity = asEntity;
class MoxiEntity {
    logic = {};
    entity;
    constructor(entity, logic = {}) {
        this.logic = logic;
        this.entity = entity;
    }
    update(deltaTime) {
        for (const className in this.logic) {
            const logicComponent = this.logic[className];
            if (logicComponent.update && this.entity && logicComponent.active) {
                logicComponent.update(this.entity, deltaTime);
            }
        }
    }
    init(renderer, ...args) {
        for (const className in this.logic) {
            const logicComponent = this.logic[className];
            if (logicComponent.init && this.entity) {
                logicComponent.init(this.entity, renderer, ...args);
            }
        }
    }
    addLogic(logic) {
        const logicName = logic.name || logic.constructor.name;
        this.logic[logicName] = logic;
    }
    getLogic(name) {
        return this.logic[name];
    }
}
exports.MoxiEntity = MoxiEntity;
function asEntity(entity, logic = {}) {
    const target = entity;
    target.isInteractive = () => false;
    target.moxiEntity = new MoxiEntity(target, logic);
    return entity;
}


/***/ }),

/***/ "./src/core/render-manager.ts":
/*!************************************!*\
  !*** ./src/core/render-manager.ts ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.RenderManager = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
class RenderManager {
    static getRenderer;
    static create;
    htmlRoot;
    renderer;
    fitToWindow = false;
    constructor(htmlRoot, renderer) {
        this.htmlRoot = htmlRoot;
        this.renderer = renderer;
        htmlRoot.appendChild(this.renderer.canvas);
        window.addEventListener('resize', () => this.onResize());
        this.onResize();
    }
    render(stage) {
        this.renderer.render(stage);
    }
    onResize = () => {
        const { renderer, htmlRoot: root } = this;
        const canvas = renderer.canvas;
        const parentWidth = root.clientWidth;
        const parentHeight = root.clientHeight;
        const canvasWidth = renderer.width;
        const canvasHeight = renderer.height;
        const scale = Math.min(parentWidth / canvasWidth, parentHeight / canvasHeight);
        canvas.style.width = `${Math.floor(canvasWidth * scale)}px`;
        canvas.style.height = `${Math.floor(canvasHeight * scale)}px`;
    };
}
exports.RenderManager = RenderManager;
RenderManager.getRenderer = async (options) => (await pixi_js_1.default.autoDetectRenderer(options));
RenderManager.create = async (htmlRoot, options) => (new RenderManager(htmlRoot, await RenderManager.getRenderer(options)));


/***/ }),

/***/ "./src/core/scene.ts":
/*!***************************!*\
  !*** ./src/core/scene.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Scene = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function isMoxiEntity(entity) {
    return entity != null && typeof entity === 'object' && 'moxiEntity' in entity;
}
class Scene extends pixi_js_1.default.Container {
    renderer;
    constructor(renderer) {
        super();
        this.renderer = renderer;
    }
    init() {
        this.children.forEach((child) => {
            if (isMoxiEntity(child)) {
                child.moxiEntity.init(this.renderer);
            }
        });
    }
    update(deltaTime) {
        this.children.forEach((child) => {
            if (isMoxiEntity(child)) {
                child.moxiEntity.update(deltaTime);
            }
        });
    }
    draw(deltaTime) {
        this.renderer.render(this);
    }
}
exports.Scene = Scene;


/***/ }),

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.FlexJustify = exports.FlexDirection = exports.FlexContainer = exports.UIFocusManager = exports.UIComponent = exports.EdgeInsets = exports.applyMaterial = exports.PhysicsMaterials = exports.createShapeFromSprite = exports.getPhysicsBody = exports.hasPhysics = exports.asPhysicsEntity = exports.CollisionManager = exports.CollisionRegistry = exports.PhysicsDebugRenderer = exports.PhysicsBodyLogic = exports.PhysicsWorld = exports.StateLogic = exports.StateMachine = exports.utils = exports.TilingParallaxLayer = exports.TextureFrameSequences = exports.setupResponsiveCanvas = exports.Scene = exports.RenderManager = exports.setupMoxi = exports.LoadingScene = exports.ParallaxLayer = exports.ParallaxBackgroundLogic = exports.ParallaxBackground = exports.MoxiEntity = exports.loadFonts = exports.getTextureRange = exports.EventEmitter = exports.Engine = exports.defaultRenderOptions = exports.createTileGrid = exports.createResizeHandler = exports.ClientEvents = exports.CameraLogic = exports.Camera = exports.Logic = exports.asContainer = exports.asGraphics = exports.asText = exports.asSprite = exports.asBitmapText = exports.asTextureFrames = exports.asEntity = exports.AssetLoader = void 0;
exports.createBorderConfig = exports.BORDER = exports.GRID = exports.units = exports.px = exports.PixelGrid = exports.svgToTexture = exports.UIScaleMode = exports.UILayer = exports.UITabs = exports.UIScrollContainer = exports.UITextArea = exports.UITextInput = exports.UISelect = exports.ButtonState = exports.UIButton = exports.UIPanel = exports.UILabel = exports.UIBox = exports.FlexAlign = void 0;
const utils = __importStar(__webpack_require__(/*! ./library/utils */ "./src/library/utils.ts"));
exports.utils = utils;
const render_manager_1 = __webpack_require__(/*! ./core/render-manager */ "./src/core/render-manager.ts");
Object.defineProperty(exports, "RenderManager", ({ enumerable: true, get: function () { return render_manager_1.RenderManager; } }));
const scene_1 = __webpack_require__(/*! ./core/scene */ "./src/core/scene.ts");
Object.defineProperty(exports, "Scene", ({ enumerable: true, get: function () { return scene_1.Scene; } }));
const engine_1 = __webpack_require__(/*! ./core/engine */ "./src/core/engine.ts");
Object.defineProperty(exports, "Engine", ({ enumerable: true, get: function () { return engine_1.Engine; } }));
const event_system_1 = __webpack_require__(/*! ./core/event-system */ "./src/core/event-system.ts");
Object.defineProperty(exports, "EventEmitter", ({ enumerable: true, get: function () { return event_system_1.EventEmitter; } }));
const client_events_1 = __webpack_require__(/*! ./library/client-events */ "./src/library/client-events.ts");
Object.defineProperty(exports, "ClientEvents", ({ enumerable: true, get: function () { return client_events_1.ClientEvents; } }));
const asset_loader_1 = __webpack_require__(/*! ./core/asset-loader */ "./src/core/asset-loader.ts");
Object.defineProperty(exports, "AssetLoader", ({ enumerable: true, get: function () { return asset_loader_1.AssetLoader; } }));
const logic_1 = __webpack_require__(/*! ./core/logic */ "./src/core/logic.ts");
Object.defineProperty(exports, "Logic", ({ enumerable: true, get: function () { return logic_1.Logic; } }));
const setup_1 = __webpack_require__(/*! ./library/setup */ "./src/library/setup.ts");
Object.defineProperty(exports, "defaultRenderOptions", ({ enumerable: true, get: function () { return setup_1.defaultRenderOptions; } }));
Object.defineProperty(exports, "setupMoxi", ({ enumerable: true, get: function () { return setup_1.setupMoxi; } }));
const font_loader_1 = __webpack_require__(/*! ./library/font-loader */ "./src/library/font-loader.ts");
Object.defineProperty(exports, "loadFonts", ({ enumerable: true, get: function () { return font_loader_1.loadFonts; } }));
const moxi_entity_1 = __webpack_require__(/*! ./core/moxi-entity */ "./src/core/moxi-entity.ts");
Object.defineProperty(exports, "asEntity", ({ enumerable: true, get: function () { return moxi_entity_1.asEntity; } }));
Object.defineProperty(exports, "MoxiEntity", ({ enumerable: true, get: function () { return moxi_entity_1.MoxiEntity; } }));
const camera_1 = __webpack_require__(/*! ./core/camera */ "./src/core/camera.ts");
Object.defineProperty(exports, "Camera", ({ enumerable: true, get: function () { return camera_1.Camera; } }));
Object.defineProperty(exports, "CameraLogic", ({ enumerable: true, get: function () { return camera_1.CameraLogic; } }));
const texture_frames_1 = __webpack_require__(/*! ./library/texture-frames */ "./src/library/texture-frames.ts");
Object.defineProperty(exports, "asTextureFrames", ({ enumerable: true, get: function () { return texture_frames_1.asTextureFrames; } }));
const as_pixi_1 = __webpack_require__(/*! ./library/as-pixi */ "./src/library/as-pixi.ts");
Object.defineProperty(exports, "asBitmapText", ({ enumerable: true, get: function () { return as_pixi_1.asBitmapText; } }));
Object.defineProperty(exports, "asSprite", ({ enumerable: true, get: function () { return as_pixi_1.asSprite; } }));
Object.defineProperty(exports, "asText", ({ enumerable: true, get: function () { return as_pixi_1.asText; } }));
Object.defineProperty(exports, "asGraphics", ({ enumerable: true, get: function () { return as_pixi_1.asGraphics; } }));
Object.defineProperty(exports, "asContainer", ({ enumerable: true, get: function () { return as_pixi_1.asContainer; } }));
const texture_frame_sequences_1 = __webpack_require__(/*! ./library/texture-frame-sequences */ "./src/library/texture-frame-sequences.ts");
Object.defineProperty(exports, "TextureFrameSequences", ({ enumerable: true, get: function () { return texture_frame_sequences_1.TextureFrameSequences; } }));
const resize_handler_1 = __webpack_require__(/*! ./library/resize-handler */ "./src/library/resize-handler.ts");
Object.defineProperty(exports, "createResizeHandler", ({ enumerable: true, get: function () { return resize_handler_1.createResizeHandler; } }));
Object.defineProperty(exports, "setupResponsiveCanvas", ({ enumerable: true, get: function () { return resize_handler_1.setupResponsiveCanvas; } }));
const edge_insets_1 = __webpack_require__(/*! ./ui/core/edge-insets */ "./src/ui/core/edge-insets.ts");
Object.defineProperty(exports, "EdgeInsets", ({ enumerable: true, get: function () { return edge_insets_1.EdgeInsets; } }));
const ui_component_1 = __webpack_require__(/*! ./ui/core/ui-component */ "./src/ui/core/ui-component.ts");
Object.defineProperty(exports, "UIComponent", ({ enumerable: true, get: function () { return ui_component_1.UIComponent; } }));
const ui_focus_manager_1 = __webpack_require__(/*! ./ui/core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
Object.defineProperty(exports, "UIFocusManager", ({ enumerable: true, get: function () { return ui_focus_manager_1.UIFocusManager; } }));
const flex_container_1 = __webpack_require__(/*! ./ui/layout/flex-container */ "./src/ui/layout/flex-container.ts");
Object.defineProperty(exports, "FlexContainer", ({ enumerable: true, get: function () { return flex_container_1.FlexContainer; } }));
Object.defineProperty(exports, "FlexDirection", ({ enumerable: true, get: function () { return flex_container_1.FlexDirection; } }));
Object.defineProperty(exports, "FlexJustify", ({ enumerable: true, get: function () { return flex_container_1.FlexJustify; } }));
Object.defineProperty(exports, "FlexAlign", ({ enumerable: true, get: function () { return flex_container_1.FlexAlign; } }));
const ui_box_1 = __webpack_require__(/*! ./ui/components/ui-box */ "./src/ui/components/ui-box.ts");
Object.defineProperty(exports, "UIBox", ({ enumerable: true, get: function () { return ui_box_1.UIBox; } }));
const ui_label_1 = __webpack_require__(/*! ./ui/components/ui-label */ "./src/ui/components/ui-label.ts");
Object.defineProperty(exports, "UILabel", ({ enumerable: true, get: function () { return ui_label_1.UILabel; } }));
const ui_panel_1 = __webpack_require__(/*! ./ui/components/ui-panel */ "./src/ui/components/ui-panel.ts");
Object.defineProperty(exports, "UIPanel", ({ enumerable: true, get: function () { return ui_panel_1.UIPanel; } }));
const ui_button_1 = __webpack_require__(/*! ./ui/components/ui-button */ "./src/ui/components/ui-button.ts");
Object.defineProperty(exports, "UIButton", ({ enumerable: true, get: function () { return ui_button_1.UIButton; } }));
Object.defineProperty(exports, "ButtonState", ({ enumerable: true, get: function () { return ui_button_1.ButtonState; } }));
const ui_select_1 = __webpack_require__(/*! ./ui/components/ui-select */ "./src/ui/components/ui-select.ts");
Object.defineProperty(exports, "UISelect", ({ enumerable: true, get: function () { return ui_select_1.UISelect; } }));
const ui_text_input_1 = __webpack_require__(/*! ./ui/components/ui-text-input */ "./src/ui/components/ui-text-input.ts");
Object.defineProperty(exports, "UITextInput", ({ enumerable: true, get: function () { return ui_text_input_1.UITextInput; } }));
const ui_textarea_1 = __webpack_require__(/*! ./ui/components/ui-textarea */ "./src/ui/components/ui-textarea.ts");
Object.defineProperty(exports, "UITextArea", ({ enumerable: true, get: function () { return ui_textarea_1.UITextArea; } }));
const ui_scroll_container_1 = __webpack_require__(/*! ./ui/components/ui-scroll-container */ "./src/ui/components/ui-scroll-container.ts");
Object.defineProperty(exports, "UIScrollContainer", ({ enumerable: true, get: function () { return ui_scroll_container_1.UIScrollContainer; } }));
const ui_tabs_1 = __webpack_require__(/*! ./ui/components/ui-tabs */ "./src/ui/components/ui-tabs.ts");
Object.defineProperty(exports, "UITabs", ({ enumerable: true, get: function () { return ui_tabs_1.UITabs; } }));
const UILayer_1 = __webpack_require__(/*! ./ui/UILayer */ "./src/ui/UILayer.ts");
Object.defineProperty(exports, "UILayer", ({ enumerable: true, get: function () { return UILayer_1.UILayer; } }));
const UIScaleMode_1 = __webpack_require__(/*! ./ui/UIScaleMode */ "./src/ui/UIScaleMode.ts");
Object.defineProperty(exports, "UIScaleMode", ({ enumerable: true, get: function () { return UIScaleMode_1.UIScaleMode; } }));
const state_machine_1 = __webpack_require__(/*! ./library/state-machine */ "./src/library/state-machine.ts");
Object.defineProperty(exports, "StateMachine", ({ enumerable: true, get: function () { return state_machine_1.StateMachine; } }));
const state_logic_1 = __webpack_require__(/*! ./library/state-logic */ "./src/library/state-logic.ts");
Object.defineProperty(exports, "StateLogic", ({ enumerable: true, get: function () { return state_logic_1.StateLogic; } }));
const grid_generator_1 = __webpack_require__(/*! ./library/grid-generator */ "./src/library/grid-generator.ts");
Object.defineProperty(exports, "createTileGrid", ({ enumerable: true, get: function () { return grid_generator_1.createTileGrid; } }));
Object.defineProperty(exports, "getTextureRange", ({ enumerable: true, get: function () { return grid_generator_1.getTextureRange; } }));
const svg_to_texture_1 = __webpack_require__(/*! ./library/svg-utils/svg-to-texture */ "./src/library/svg-utils/svg-to-texture.ts");
Object.defineProperty(exports, "svgToTexture", ({ enumerable: true, get: function () { return svg_to_texture_1.svgToTexture; } }));
const pixel_grid_1 = __webpack_require__(/*! ./ui/pixel-grid */ "./src/ui/pixel-grid.ts");
Object.defineProperty(exports, "PixelGrid", ({ enumerable: true, get: function () { return pixel_grid_1.PixelGrid; } }));
Object.defineProperty(exports, "px", ({ enumerable: true, get: function () { return pixel_grid_1.px; } }));
Object.defineProperty(exports, "units", ({ enumerable: true, get: function () { return pixel_grid_1.units; } }));
Object.defineProperty(exports, "GRID", ({ enumerable: true, get: function () { return pixel_grid_1.GRID; } }));
Object.defineProperty(exports, "BORDER", ({ enumerable: true, get: function () { return pixel_grid_1.BORDER; } }));
Object.defineProperty(exports, "createBorderConfig", ({ enumerable: true, get: function () { return pixel_grid_1.createBorderConfig; } }));
const parallax_background_1 = __webpack_require__(/*! ./library/parallax-background */ "./src/library/parallax-background.ts");
Object.defineProperty(exports, "ParallaxBackground", ({ enumerable: true, get: function () { return parallax_background_1.ParallaxBackground; } }));
Object.defineProperty(exports, "ParallaxBackgroundLogic", ({ enumerable: true, get: function () { return parallax_background_1.ParallaxBackgroundLogic; } }));
const parallax_layer_1 = __webpack_require__(/*! ./library/parallax-layer */ "./src/library/parallax-layer.ts");
Object.defineProperty(exports, "ParallaxLayer", ({ enumerable: true, get: function () { return parallax_layer_1.ParallaxLayer; } }));
Object.defineProperty(exports, "TilingParallaxLayer", ({ enumerable: true, get: function () { return parallax_layer_1.TilingParallaxLayer; } }));
const loading_scene_1 = __webpack_require__(/*! ./library/loading-scene */ "./src/library/loading-scene.ts");
Object.defineProperty(exports, "LoadingScene", ({ enumerable: true, get: function () { return loading_scene_1.LoadingScene; } }));
const physics_1 = __webpack_require__(/*! ./library/physics */ "./src/library/physics/index.ts");
Object.defineProperty(exports, "PhysicsWorld", ({ enumerable: true, get: function () { return physics_1.PhysicsWorld; } }));
Object.defineProperty(exports, "PhysicsBodyLogic", ({ enumerable: true, get: function () { return physics_1.PhysicsBodyLogic; } }));
Object.defineProperty(exports, "PhysicsDebugRenderer", ({ enumerable: true, get: function () { return physics_1.PhysicsDebugRenderer; } }));
Object.defineProperty(exports, "CollisionRegistry", ({ enumerable: true, get: function () { return physics_1.CollisionRegistry; } }));
Object.defineProperty(exports, "CollisionManager", ({ enumerable: true, get: function () { return physics_1.CollisionManager; } }));
Object.defineProperty(exports, "asPhysicsEntity", ({ enumerable: true, get: function () { return physics_1.asPhysicsEntity; } }));
Object.defineProperty(exports, "hasPhysics", ({ enumerable: true, get: function () { return physics_1.hasPhysics; } }));
Object.defineProperty(exports, "getPhysicsBody", ({ enumerable: true, get: function () { return physics_1.getPhysicsBody; } }));
Object.defineProperty(exports, "createShapeFromSprite", ({ enumerable: true, get: function () { return physics_1.createShapeFromSprite; } }));
Object.defineProperty(exports, "PhysicsMaterials", ({ enumerable: true, get: function () { return physics_1.PhysicsMaterials; } }));
Object.defineProperty(exports, "applyMaterial", ({ enumerable: true, get: function () { return physics_1.applyMaterial; } }));
const exportedObjects = {
    AssetLoader: asset_loader_1.AssetLoader,
    asEntity: moxi_entity_1.asEntity,
    asTextureFrames: texture_frames_1.asTextureFrames,
    asBitmapText: as_pixi_1.asBitmapText,
    asSprite: as_pixi_1.asSprite,
    asText: as_pixi_1.asText,
    asGraphics: as_pixi_1.asGraphics,
    asContainer: as_pixi_1.asContainer,
    Logic: logic_1.Logic,
    Camera: camera_1.Camera,
    CameraLogic: camera_1.CameraLogic,
    ClientEvents: client_events_1.ClientEvents,
    createResizeHandler: resize_handler_1.createResizeHandler,
    createTileGrid: grid_generator_1.createTileGrid,
    defaultRenderOptions: setup_1.defaultRenderOptions,
    Engine: engine_1.Engine,
    EventEmitter: event_system_1.EventEmitter,
    getTextureRange: grid_generator_1.getTextureRange,
    loadFonts: font_loader_1.loadFonts,
    MoxiEntity: moxi_entity_1.MoxiEntity,
    ParallaxBackground: parallax_background_1.ParallaxBackground,
    ParallaxBackgroundLogic: parallax_background_1.ParallaxBackgroundLogic,
    ParallaxLayer: parallax_layer_1.ParallaxLayer,
    LoadingScene: loading_scene_1.LoadingScene,
    setupMoxi: setup_1.setupMoxi,
    RenderManager: render_manager_1.RenderManager,
    Scene: scene_1.Scene,
    setupResponsiveCanvas: resize_handler_1.setupResponsiveCanvas,
    TextureFrameSequences: texture_frame_sequences_1.TextureFrameSequences,
    TilingParallaxLayer: parallax_layer_1.TilingParallaxLayer,
    utils,
    StateMachine: state_machine_1.StateMachine,
    StateLogic: state_logic_1.StateLogic,
    PhysicsWorld: physics_1.PhysicsWorld,
    PhysicsBodyLogic: physics_1.PhysicsBodyLogic,
    PhysicsDebugRenderer: physics_1.PhysicsDebugRenderer,
    CollisionRegistry: physics_1.CollisionRegistry,
    CollisionManager: physics_1.CollisionManager,
    asPhysicsEntity: physics_1.asPhysicsEntity,
    hasPhysics: physics_1.hasPhysics,
    getPhysicsBody: physics_1.getPhysicsBody,
    createShapeFromSprite: physics_1.createShapeFromSprite,
    PhysicsMaterials: physics_1.PhysicsMaterials,
    applyMaterial: physics_1.applyMaterial,
    EdgeInsets: edge_insets_1.EdgeInsets,
    UIComponent: ui_component_1.UIComponent,
    UIFocusManager: ui_focus_manager_1.UIFocusManager,
    FlexContainer: flex_container_1.FlexContainer,
    FlexDirection: flex_container_1.FlexDirection,
    FlexJustify: flex_container_1.FlexJustify,
    FlexAlign: flex_container_1.FlexAlign,
    UIBox: ui_box_1.UIBox,
    UILabel: ui_label_1.UILabel,
    UIPanel: ui_panel_1.UIPanel,
    UIButton: ui_button_1.UIButton,
    ButtonState: ui_button_1.ButtonState,
    UISelect: ui_select_1.UISelect,
    UITextInput: ui_text_input_1.UITextInput,
    UITextArea: ui_textarea_1.UITextArea,
    UIScrollContainer: ui_scroll_container_1.UIScrollContainer,
    UITabs: ui_tabs_1.UITabs,
    UILayer: UILayer_1.UILayer,
    UIScaleMode: UIScaleMode_1.UIScaleMode,
    svgToTexture: svg_to_texture_1.svgToTexture,
    PixelGrid: pixel_grid_1.PixelGrid,
    px: pixel_grid_1.px,
    units: pixel_grid_1.units,
    GRID: pixel_grid_1.GRID,
    BORDER: pixel_grid_1.BORDER,
    createBorderConfig: pixel_grid_1.createBorderConfig
};
exports["default"] = exportedObjects;


/***/ }),

/***/ "./src/library/as-pixi.ts":
/*!********************************!*\
  !*** ./src/library/as-pixi.ts ***!
  \********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asBitmapText = asBitmapText;
exports.asSprite = asSprite;
exports.asText = asText;
exports.asGraphics = asGraphics;
exports.asContainer = asContainer;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function applyProps(obj, props) {
    if (!props)
        return obj;
    if (props.x !== undefined)
        obj.x = props.x;
    if (props.y !== undefined)
        obj.y = props.y;
    if (props.anchor !== undefined) {
        if (typeof props.anchor === 'number') {
            if ('anchor' in obj && typeof obj.anchor === 'object' && obj.anchor !== null) {
                obj.anchor.set(props.anchor);
            }
        }
        else {
            if ('anchor' in obj && typeof obj.anchor === 'object' && obj.anchor !== null) {
                const anchor = obj.anchor;
                if (props.anchor.x !== undefined)
                    anchor.x = props.anchor.x;
                if (props.anchor.y !== undefined)
                    anchor.y = props.anchor.y;
            }
        }
    }
    if (props.scale !== undefined) {
        if (typeof props.scale === 'number') {
            if ('scale' in obj && typeof obj.scale === 'object' && obj.scale !== null) {
                obj.scale.set(props.scale);
            }
        }
        else {
            if ('scale' in obj && typeof obj.scale === 'object' && obj.scale !== null) {
                const scale = obj.scale;
                if (props.scale.x !== undefined)
                    scale.x = props.scale.x;
                if (props.scale.y !== undefined)
                    scale.y = props.scale.y;
            }
        }
    }
    if (props.rotation !== undefined)
        obj.rotation = props.rotation;
    if (props.tint !== undefined && 'tint' in obj)
        obj.tint = props.tint;
    if (props.alpha !== undefined)
        obj.alpha = props.alpha;
    if (props.visible !== undefined)
        obj.visible = props.visible;
    if (props.eventMode !== undefined && 'eventMode' in obj)
        obj.eventMode = props.eventMode;
    if (props.pivot !== undefined) {
        if (typeof props.pivot === 'number') {
            if ('pivot' in obj && typeof obj.pivot === 'object' && obj.pivot !== null) {
                obj.pivot.set(props.pivot);
            }
        }
        else {
            if ('pivot' in obj && typeof obj.pivot === 'object' && obj.pivot !== null) {
                const pivot = obj.pivot;
                if (props.pivot.x !== undefined)
                    pivot.x = props.pivot.x;
                if (props.pivot.y !== undefined)
                    pivot.y = props.pivot.y;
            }
        }
    }
    return obj;
}
function asBitmapText(constructorArgs, props) {
    const { pixelPerfect, ...textArgs } = constructorArgs;
    const text = new pixi_js_1.default.BitmapText(textArgs);
    if (pixelPerfect) {
        text.roundPixels = true;
    }
    return applyProps(text, props);
}
function asSprite(constructorArgs, props) {
    const sprite = new pixi_js_1.default.Sprite(constructorArgs);
    return applyProps(sprite, props);
}
function asText(constructorArgs, props) {
    const text = new pixi_js_1.default.Text(constructorArgs);
    return applyProps(text, props);
}
function asGraphics(props) {
    const graphics = new pixi_js_1.default.Graphics();
    return applyProps(graphics, props);
}
function asContainer(props) {
    const container = new pixi_js_1.default.Container();
    return applyProps(container, props);
}


/***/ }),

/***/ "./src/library/client-events.ts":
/*!**************************************!*\
  !*** ./src/library/client-events.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.ClientEvents = void 0;
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
class ClientEvents {
    wheelDelta;
    mouseUpEvent;
    mouseDownEvent;
    lastMouseDown;
    lastMouseUp;
    keyDownEvent;
    keyUpEvent;
    keydown;
    wheelOffsets;
    movePosition;
    lastMovePosition;
    moveDelta;
    static instance = null;
    constructor({ initWheelOffset = new pixi_js_1.Point(), onAnyEvent = (ev) => { } } = {}) {
        if (ClientEvents.instance) {
            return ClientEvents.instance;
        }
        this.wheelOffsets = initWheelOffset;
        this.keydown = {};
        this.movePosition = new pixi_js_1.Point();
        const anyEvent = (ev) => {
            onAnyEvent(ev);
        };
        document.addEventListener('wheel', (event) => {
            const wheelDelta = this.wheelOffsets || new pixi_js_1.Point();
            const xValue = wheelDelta.x + event.deltaX;
            const yValue = wheelDelta.y + event.deltaY;
            this.wheelOffsets = new pixi_js_1.Point(xValue, yValue);
            anyEvent({ eventType: 'wheel', event });
        });
        document.addEventListener('mousemove', (event) => {
            this.lastMovePosition = this.movePosition;
            this.movePosition = new pixi_js_1.Point(event.clientX, event.clientY);
            this.moveDelta = new pixi_js_1.Point(this.movePosition.x - this.lastMovePosition.x, this.movePosition.y - this.lastMovePosition.y);
            anyEvent({ eventType: 'mousemove', event });
        });
        document.addEventListener('mousedown', (event) => {
            this.mouseDownEvent = event;
            this.lastMouseDown = event;
            this.mouseUpEvent = null;
            anyEvent({ eventType: 'mousedown', event });
        });
        document.addEventListener('mouseup', (event) => {
            this.mouseUpEvent = event;
            this.lastMouseUp = event;
            this.mouseDownEvent = null;
            anyEvent({ eventType: 'mouseup', event });
        });
        document.addEventListener('keydown', (event) => {
            const { key } = event;
            this.keyDownEvent = event;
            this.keyUpEvent = null;
            this.keydown[key] = event;
            anyEvent({ eventType: 'keydown', event });
        });
        document.addEventListener('keyup', (event) => {
            const { key } = event;
            this.keyUpEvent = event;
            this.keyDownEvent = null;
            delete this.keydown[key];
            anyEvent({ eventType: 'keyup', event });
        });
        ClientEvents.instance = this;
    }
    isKeyDown(key) {
        return Boolean(this.keydown[key]);
    }
    isKeyUp(key) {
        return !this.keydown[key];
    }
}
exports.ClientEvents = ClientEvents;


/***/ }),

/***/ "./src/library/font-loader.ts":
/*!************************************!*\
  !*** ./src/library/font-loader.ts ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.loadFonts = void 0;
const fontfaceobserver_1 = __importDefault(__webpack_require__(/*! fontfaceobserver */ "../../node_modules/fontfaceobserver/fontfaceobserver.standalone.js"));
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
const loadFonts = async () => {
    const fontKenfutureThin = new fontfaceobserver_1.default('kenfuture-thin');
    return new Promise((resolve) => {
        fontKenfutureThin.load().then(() => {
            pixi_js_1.BitmapFont.install({
                name: 'kenfuture-thin',
                style: {
                    fontFamily: 'kenfuture-thin'
                }
            });
            resolve({ fontKenfutureThin });
        });
    });
};
exports.loadFonts = loadFonts;


/***/ }),

/***/ "./src/library/grid-generator.ts":
/*!***************************************!*\
  !*** ./src/library/grid-generator.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createTileGrid = createTileGrid;
exports.getTextureRange = getTextureRange;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
function createTileGrid(options, textures, selector) {
    const { width, height, cellWidth, cellHeight, centered = false } = options;
    const defaultSelector = () => Math.floor(Math.random() * textures.length);
    const getTextureIndex = selector || defaultSelector;
    const container = new pixi_js_1.default.Container();
    const totalCells = width * height;
    for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
            const pixelX = x * cellWidth;
            const pixelY = y * cellHeight;
            const index = y * width + x;
            const position = {
                x, y, pixelX, pixelY, index, total: totalCells
            };
            const textureIndex = getTextureIndex(position);
            const cell = new pixi_js_1.default.Sprite(textures[textureIndex]);
            cell.position.set(pixelX, pixelY);
            container.addChild(cell);
        }
    }
    if (centered) {
        const gridWidth = width * cellWidth;
        const gridHeight = height * cellHeight;
        container.position.set(-gridWidth / 2, -gridHeight / 2);
    }
    return container;
}
function getTextureRange(textures, startIndex, count) {
    return textures.slice(startIndex, startIndex + count);
}


/***/ }),

/***/ "./src/library/loading-scene.ts":
/*!**************************************!*\
  !*** ./src/library/loading-scene.ts ***!
  \**************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.LoadingScene = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const pixi_js_2 = __webpack_require__(/*! pixi.js */ "pixi.js");
const PALETTE = [0xf0dab1, 0xe39aac, 0xc45d9f, 0x634b7d, 0x6461c2, 0x2ba9b4, 0x93d4b5, 0xf0f6e8];
class LoadingScene extends pixi_js_2.Container {
    particles = [];
    text;
    background;
    ticker;
    renderer = null;
    time = 0;
    nextSpawn = 0;
    maxParticles;
    baseSize;
    backgroundColor;
    constructor(options = {}) {
        super();
        const { backgroundColor = 0x1a1a1a, squareSize = 20, numSquares = 30, text = 'LOADING...', textStyle = {} } = options;
        this.maxParticles = numSquares;
        this.baseSize = squareSize;
        this.backgroundColor = backgroundColor;
        this.background = new pixi_js_2.Graphics();
        this.addChild(this.background);
        this.text = new pixi_js_2.Text({
            text,
            style: {
                fontFamily: 'Courier New, monospace',
                fontSize: 16,
                fill: 0xffffff,
                fontWeight: 'bold',
                ...textStyle
            }
        });
        this.text.anchor.set(0.5);
        this.addChild(this.text);
        this.ticker = new pixi_js_1.default.Ticker();
        this.ticker.autoStart = false;
        this.ticker.add(() => {
            if (this.visible && this.renderer) {
                this.time += this.ticker.deltaTime / 60;
                this.update(this.renderer.width, this.renderer.height);
                this.renderer.render(this);
            }
        });
    }
    spawnParticle(width, height) {
        if (this.particles.length >= this.maxParticles || this.time < this.nextSpawn)
            return;
        const size = this.baseSize * (0.7 + Math.random() * 0.6);
        const sprite = new pixi_js_2.Graphics();
        sprite.rect(0, 0, size, size);
        sprite.fill({ color: PALETTE[Math.floor(Math.random() * PALETTE.length)] });
        sprite.pivot.set(size / 2, size / 2);
        this.addChild(sprite);
        const textY = height / 2 + 60;
        const textWidth = this.text.width || 200;
        const textCenterX = width / 2;
        this.particles.push({
            sprite,
            spawnTime: this.time,
            duration: 1 + Math.random() * 2.5,
            spinRate: (0.05 + Math.random() * 1.075) * (Math.random() < 0.5 ? 1 : -1),
            startX: textCenterX - textWidth / 2 + Math.random() * textWidth - 4,
            startY: textY - 100,
            endY: textY - 40,
        });
        this.nextSpawn = this.time + Math.random() * 0.5;
    }
    update(width, height) {
        this.background.clear();
        this.background.rect(0, 0, width, height);
        this.background.fill({ color: this.backgroundColor });
        this.text.x = width / 2 - 4;
        this.text.y = height / 2 + 60;
        this.spawnParticle(width, height);
        this.particles = this.particles.filter(p => {
            const elapsed = this.time - p.spawnTime;
            const progress = elapsed / p.duration;
            if (progress < 0 || progress > 1) {
                p.sprite.destroy();
                return false;
            }
            p.sprite.x = p.startX;
            p.sprite.y = p.startY + (p.endY - p.startY) * progress;
            p.sprite.rotation = this.time * p.spinRate * Math.PI * 2;
            p.sprite.alpha = progress < 0.1 ? progress / 0.1 : progress > 0.85 ? (1 - progress) / 0.15 : 1;
            return true;
        });
    }
    init(renderer) {
        this.renderer = renderer;
    }
    show() {
        this.visible = true;
        this.time = 0;
        this.nextSpawn = 0;
        this.particles.forEach(p => p.sprite.destroy());
        this.particles = [];
        if (!this.ticker.started) {
            this.ticker.start();
        }
    }
    hide() {
        this.visible = false;
        if (this.ticker.started) {
            this.ticker.stop();
        }
    }
    destroy() {
        if (this.ticker.started) {
            this.ticker.stop();
        }
        this.ticker.destroy();
        this.particles.forEach(p => p.sprite.destroy());
        super.destroy();
    }
}
exports.LoadingScene = LoadingScene;


/***/ }),

/***/ "./src/library/parallax-background.ts":
/*!********************************************!*\
  !*** ./src/library/parallax-background.ts ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.ParallaxBackgroundLogic = exports.ParallaxBackground = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const moxi_entity_1 = __webpack_require__(/*! ../core/moxi-entity */ "./src/core/moxi-entity.ts");
const logic_1 = __webpack_require__(/*! ../core/logic */ "./src/core/logic.ts");
const camera_1 = __webpack_require__(/*! ../core/camera */ "./src/core/camera.ts");
const parallax_layer_1 = __webpack_require__(/*! ./parallax-layer */ "./src/library/parallax-layer.ts");
class ParallaxBackground extends PIXI.Container {
    moxiEntity;
    camera = null;
    scrollOffset = new PIXI.Point(0, 0);
    scrollBaseScale = new PIXI.Point(1, 1);
    scrollIgnoreCameraZoom = false;
    autoscroll = new PIXI.Point(0, 0);
    constructor(options = {}) {
        super();
        this.camera = options.camera ?? null;
        this.scrollOffset = options.scrollOffset ?? new PIXI.Point(0, 0);
        this.scrollBaseScale = options.scrollBaseScale ?? new PIXI.Point(1, 1);
        this.scrollIgnoreCameraZoom = options.scrollIgnoreCameraZoom ?? false;
        this.autoscroll = options.autoscroll ?? new PIXI.Point(0, 0);
        const entity = (0, moxi_entity_1.asEntity)(this);
        entity.moxiEntity.addLogic(new ParallaxBackgroundLogic());
        this.moxiEntity = entity.moxiEntity;
    }
    addLayer(layer) {
        this.addChild(layer);
    }
    detectCamera() {
        let current = this.parent;
        while (current) {
            if (current instanceof camera_1.Camera) {
                return current;
            }
            current = current.parent;
        }
        return null;
    }
    getCameraPosition() {
        const camera = this.camera ?? this.detectCamera();
        if (!camera) {
            return new PIXI.Point(0, 0);
        }
        return new PIXI.Point(camera.position.x, camera.position.y);
    }
    getCameraScale() {
        if (this.scrollIgnoreCameraZoom) {
            return new PIXI.Point(1, 1);
        }
        const camera = this.camera ?? this.detectCamera();
        if (!camera) {
            return new PIXI.Point(1, 1);
        }
        return new PIXI.Point(camera.scale.x, camera.scale.y);
    }
}
exports.ParallaxBackground = ParallaxBackground;
class ParallaxBackgroundLogic extends logic_1.Logic {
    name = 'ParallaxBackgroundLogic';
    update(entity, deltaTime) {
        if (entity.autoscroll.x !== 0 || entity.autoscroll.y !== 0) {
            entity.scrollOffset.x += entity.autoscroll.x * deltaTime;
            entity.scrollOffset.y += entity.autoscroll.y * deltaTime;
        }
        const cameraPos = entity.getCameraPosition();
        const cameraScale = entity.getCameraScale();
        const scene = entity.parent;
        if (scene) {
            entity.position.x = cameraPos.x / scene.scale.x;
            entity.position.y = cameraPos.y / scene.scale.y;
            entity.scale.x = 1 / scene.scale.x;
            entity.scale.y = 1 / scene.scale.y;
        }
        else {
            entity.position.x = cameraPos.x;
            entity.position.y = cameraPos.y;
            entity.scale.set(1, 1);
        }
        entity.children.forEach((child) => {
            if (child instanceof parallax_layer_1.ParallaxLayer) {
                child.updateParallax(cameraPos, cameraScale, entity.scrollOffset);
            }
        });
    }
}
exports.ParallaxBackgroundLogic = ParallaxBackgroundLogic;


/***/ }),

/***/ "./src/library/parallax-layer.ts":
/*!***************************************!*\
  !*** ./src/library/parallax-layer.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.TilingParallaxLayer = exports.ParallaxLayer = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const moxi_entity_1 = __webpack_require__(/*! ../core/moxi-entity */ "./src/core/moxi-entity.ts");
class ParallaxLayer extends PIXI.Container {
    moxiEntity;
    scrollScale = new PIXI.Point(1, 1);
    scrollOffset = new PIXI.Point(0, 0);
    repeatSize = new PIXI.Point(0, 0);
    mirroring = false;
    _lastCameraPos = new PIXI.Point(0, 0);
    constructor(options = {}) {
        super();
        this.scrollScale = options.scrollScale ?? new PIXI.Point(1, 1);
        this.scrollOffset = options.scrollOffset ?? new PIXI.Point(0, 0);
        this.repeatSize = options.repeatSize ?? new PIXI.Point(0, 0);
        this.mirroring = options.mirroring ?? false;
        const entity = (0, moxi_entity_1.asEntity)(this);
        this.moxiEntity = entity.moxiEntity;
    }
    updateParallax(cameraPos, cameraScale, backgroundOffset) {
        const scrollX = (cameraPos.x + backgroundOffset.x) * this.scrollScale.x;
        const scrollY = (cameraPos.y + backgroundOffset.y) * this.scrollScale.y;
        this.position.x = -scrollX + this.scrollOffset.x;
        this.position.y = -scrollY + this.scrollOffset.y;
        if (this.mirroring) {
            if (this.repeatSize.x > 0) {
                this.position.x = this.position.x % this.repeatSize.x;
                if (this.position.x > 0)
                    this.position.x -= this.repeatSize.x;
            }
            if (this.repeatSize.y > 0) {
                this.position.y = this.position.y % this.repeatSize.y;
                if (this.position.y > 0)
                    this.position.y -= this.repeatSize.y;
            }
        }
        this._lastCameraPos.copyFrom(cameraPos);
    }
}
exports.ParallaxLayer = ParallaxLayer;
class TilingParallaxLayer extends ParallaxLayer {
    tilingSprite;
    _autoSized = false;
    constructor(options) {
        super(options);
        options.texture.source.style.addressMode = 'repeat';
        const width = options.width ?? 1;
        const height = options.height ?? 1;
        this.tilingSprite = new PIXI.TilingSprite({
            texture: options.texture,
            width: width,
            height: height,
        });
        this.tilingSprite.position.set(0, 0);
        this.addChild(this.tilingSprite);
        this._autoSized = !options.width && !options.height;
    }
    autoDetectDimensions() {
        if (!this._autoSized)
            return;
        let current = this.parent;
        while (current) {
            if (current.renderer) {
                this.resize(current.renderer.width, current.renderer.height);
                this._autoSized = false;
                return;
            }
            current = current.parent;
        }
    }
    updateParallax(cameraPos, cameraScale, backgroundOffset) {
        this.autoDetectDimensions();
        const renderer = this.parent?.parent;
        if (renderer?.renderer) {
            const baseWidth = renderer.renderer.width;
            const baseHeight = renderer.renderer.height;
            this.tilingSprite.width = baseWidth;
            this.tilingSprite.height = baseHeight;
            this.tilingSprite.pivot.set(0, 0);
            this.tilingSprite.position.set(0, 0);
        }
        const scrollX = (cameraPos.x + backgroundOffset.x) * this.scrollScale.x;
        const scrollY = (cameraPos.y + backgroundOffset.y) * this.scrollScale.y;
        this.tilingSprite.tilePosition.x = -scrollX + this.scrollOffset.x;
        this.tilingSprite.tilePosition.y = -scrollY + this.scrollOffset.y;
        this.position.set(0, 0);
    }
    resize(width, height) {
        this.tilingSprite.width = width;
        this.tilingSprite.height = height;
    }
}
exports.TilingParallaxLayer = TilingParallaxLayer;


/***/ }),

/***/ "./src/library/physics/index.ts":
/*!**************************************!*\
  !*** ./src/library/physics/index.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.applyMaterial = exports.PhysicsMaterials = exports.createShapeFromSprite = exports.getPhysicsBody = exports.hasPhysics = exports.asPhysicsEntity = exports.PhysicsDebugRenderer = exports.CollisionManager = exports.CollisionRegistry = exports.PhysicsBodyLogic = exports.PhysicsWorld = void 0;
var physics_world_1 = __webpack_require__(/*! ./physics-world */ "./src/library/physics/physics-world.ts");
Object.defineProperty(exports, "PhysicsWorld", ({ enumerable: true, get: function () { return physics_world_1.PhysicsWorld; } }));
var physics_body_logic_1 = __webpack_require__(/*! ./physics-body-logic */ "./src/library/physics/physics-body-logic.ts");
Object.defineProperty(exports, "PhysicsBodyLogic", ({ enumerable: true, get: function () { return physics_body_logic_1.PhysicsBodyLogic; } }));
var physics_collision_1 = __webpack_require__(/*! ./physics-collision */ "./src/library/physics/physics-collision.ts");
Object.defineProperty(exports, "CollisionRegistry", ({ enumerable: true, get: function () { return physics_collision_1.CollisionRegistry; } }));
Object.defineProperty(exports, "CollisionManager", ({ enumerable: true, get: function () { return physics_collision_1.CollisionManager; } }));
var physics_debug_renderer_1 = __webpack_require__(/*! ./physics-debug-renderer */ "./src/library/physics/physics-debug-renderer.ts");
Object.defineProperty(exports, "PhysicsDebugRenderer", ({ enumerable: true, get: function () { return physics_debug_renderer_1.PhysicsDebugRenderer; } }));
var physics_utils_1 = __webpack_require__(/*! ./physics-utils */ "./src/library/physics/physics-utils.ts");
Object.defineProperty(exports, "asPhysicsEntity", ({ enumerable: true, get: function () { return physics_utils_1.asPhysicsEntity; } }));
Object.defineProperty(exports, "hasPhysics", ({ enumerable: true, get: function () { return physics_utils_1.hasPhysics; } }));
Object.defineProperty(exports, "getPhysicsBody", ({ enumerable: true, get: function () { return physics_utils_1.getPhysicsBody; } }));
Object.defineProperty(exports, "createShapeFromSprite", ({ enumerable: true, get: function () { return physics_utils_1.createShapeFromSprite; } }));
var physics_materials_1 = __webpack_require__(/*! ./physics-materials */ "./src/library/physics/physics-materials.ts");
Object.defineProperty(exports, "PhysicsMaterials", ({ enumerable: true, get: function () { return physics_materials_1.PhysicsMaterials; } }));
Object.defineProperty(exports, "applyMaterial", ({ enumerable: true, get: function () { return physics_materials_1.applyMaterial; } }));


/***/ }),

/***/ "./src/library/physics/physics-body-logic.ts":
/*!***************************************************!*\
  !*** ./src/library/physics/physics-body-logic.ts ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsBodyLogic = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const logic_1 = __webpack_require__(/*! ../../core/logic */ "./src/core/logic.ts");
const physics_graphics_parser_1 = __webpack_require__(/*! ./physics-graphics-parser */ "./src/library/physics/physics-graphics-parser.ts");
class PhysicsBodyLogic extends logic_1.Logic {
    name = 'PhysicsBodyLogic';
    body;
    world;
    options;
    onCollisionBegin;
    onCollisionEnd;
    constructor(world, options = {}) {
        super();
        this.world = world;
        this.options = {
            type: 'dynamic',
            syncMode: 'physics-driven',
            syncPosition: true,
            syncRotation: true,
            density: 1.0,
            friction: 0.3,
            restitution: 0.0,
            fixedRotation: false,
            isSensor: false,
            bullet: false,
            ...options
        };
    }
    init(entity, renderer) {
        this.createPhysicsBody(entity);
        this.body.setUserData(this);
        this.world.registerBody(this.body, this);
    }
    update(entity, deltaTime) {
        if (!this.body)
            return;
        switch (this.options.syncMode) {
            case 'physics-driven':
                this.syncFromPhysics(entity);
                break;
            case 'sprite-driven':
                this.syncToPhysics(entity);
                break;
            case 'manual':
                break;
        }
    }
    destroy() {
        if (this.body) {
            this.world.destroyBody(this.body);
        }
    }
    syncFromPhysics(entity) {
        if (!this.body)
            return;
        const pos = this.body.getPosition();
        if (this.options.syncPosition) {
            entity.x = this.world.toPixels(pos.x);
            entity.y = this.world.toPixels(pos.y);
        }
        if (this.options.syncRotation) {
            entity.rotation = this.body.getAngle();
        }
    }
    syncToPhysics(entity) {
        if (!this.body)
            return;
        if (this.options.syncPosition) {
            const x = this.world.toPhysics(entity.x);
            const y = this.world.toPhysics(entity.y);
            this.body.setPosition(planck.Vec2(x, y));
        }
        if (this.options.syncRotation) {
            this.body.setAngle(entity.rotation);
        }
    }
    createPhysicsBody(entity) {
        let bodyType;
        switch (this.options.type) {
            case 'static':
                bodyType = 'static';
                break;
            case 'kinematic':
                bodyType = 'kinematic';
                break;
            case 'dynamic':
            default:
                bodyType = 'dynamic';
                break;
        }
        const bodyDef = {
            type: bodyType,
            position: this.options.position
                ? this.world.toPhysicsPoint(this.options.position)
                : planck.Vec2(this.world.toPhysics(entity.x), this.world.toPhysics(entity.y)),
            angle: this.options.rotation ?? entity.rotation,
            linearVelocity: this.options.linearVelocity
                ? this.world.toPhysicsPoint(this.options.linearVelocity)
                : planck.Vec2(0, 0),
            angularVelocity: this.options.angularVelocity ?? 0,
            fixedRotation: this.options.fixedRotation ?? false,
            bullet: this.options.bullet ?? false
        };
        this.body = this.world.createBody(bodyDef);
        this.createFixture(entity);
        if (this.options.linearVelocity) {
            this.setVelocity(this.options.linearVelocity);
        }
        if (this.options.angularVelocity) {
            this.setAngularVelocity(this.options.angularVelocity);
        }
    }
    createFixture(entity) {
        const shape = this.createShape(entity);
        const categoryBits = this.options.collisionTags
            ? this.world.collisionRegistry.tagsToBits(this.options.collisionTags)
            : this.world.collisionRegistry.getBit('default');
        const maskBits = this.options.collidesWith
            ? this.world.collisionRegistry.tagsToBits(this.options.collidesWith)
            : 0xFFFF;
        const groupIndex = this.options.collisionGroup ?? 0;
        this.body.createFixture({
            shape: shape,
            density: this.options.density ?? 1.0,
            friction: this.options.friction ?? 0.3,
            restitution: this.options.restitution ?? 0.0,
            isSensor: this.options.isSensor ?? false,
            filterCategoryBits: categoryBits,
            filterMaskBits: maskBits,
            filterGroupIndex: groupIndex
        });
    }
    createShape(entity) {
        if (this.options.collisionShape) {
            const parsed = (0, physics_graphics_parser_1.parseGraphicsShape)(this.options.collisionShape, this.world);
            return parsed.shape;
        }
        if (entity instanceof PIXI.Graphics) {
            const parsed = (0, physics_graphics_parser_1.parseGraphicsShape)(entity, this.world);
            return parsed.shape;
        }
        if (this.options.shape) {
            return this.createShapeFromType(this.options.shape);
        }
        throw new Error('Collision shape required for non-Graphics entities. ' +
            'Either provide a Graphics entity, or specify options.collisionShape, ' +
            'or use legacy options.shape with dimensions.');
    }
    createShapeFromType(shapeType) {
        switch (shapeType) {
            case 'circle':
                const radius = this.options.radius ?? 25;
                return planck.Circle(this.world.toPhysics(radius));
            case 'rectangle':
                const width = this.options.width ?? 50;
                const height = this.options.height ?? 50;
                return planck.Box(this.world.toPhysics(width / 2), this.world.toPhysics(height / 2));
            case 'polygon':
                if (!this.options.vertices || this.options.vertices.length < 3) {
                    throw new Error('Polygon shape requires at least 3 vertices');
                }
                const vertices = this.options.vertices.map(v => planck.Vec2(this.world.toPhysics(v.x), this.world.toPhysics(v.y)));
                return planck.Polygon(vertices);
            default:
                throw new Error(`Unknown shape type: ${shapeType}`);
        }
    }
    autoDetectShape(entity) {
        const bounds = entity.getLocalBounds();
        return planck.Box(this.world.toPhysics(bounds.width / 2), this.world.toPhysics(bounds.height / 2));
    }
    applyForce(force, point) {
        const forceVec = this.world.toPhysicsPoint(force);
        const pointVec = point
            ? this.world.toPhysicsPoint(point)
            : this.body.getWorldCenter();
        this.body.applyForce(forceVec, pointVec);
    }
    applyImpulse(impulse, point) {
        const impulseVec = this.world.toPhysicsPoint(impulse);
        const pointVec = point
            ? this.world.toPhysicsPoint(point)
            : this.body.getWorldCenter();
        this.body.applyLinearImpulse(impulseVec, pointVec);
    }
    applyTorque(torque) {
        this.body.applyTorque(torque);
    }
    setVelocity(velocity) {
        const velocityVec = this.world.toPhysicsPoint(velocity);
        this.body.setLinearVelocity(velocityVec);
    }
    setAngularVelocity(omega) {
        this.body.setAngularVelocity(omega);
    }
    getVelocity() {
        const vel = this.body.getLinearVelocity();
        return this.world.toPixelsPoint(vel);
    }
    getAngularVelocity() {
        return this.body.getAngularVelocity();
    }
    getMass() {
        return this.body.getMass();
    }
    isAwake() {
        return this.body.isAwake();
    }
    isSleeping() {
        return !this.body.isAwake();
    }
    setAwake(awake) {
        this.body.setAwake(awake);
    }
}
exports.PhysicsBodyLogic = PhysicsBodyLogic;


/***/ }),

/***/ "./src/library/physics/physics-collision.ts":
/*!**************************************************!*\
  !*** ./src/library/physics/physics-collision.ts ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.CollisionManager = exports.CollisionRegistry = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
class CollisionRegistry {
    tagToBit = new Map();
    bitToTag = new Map();
    nextBit = 1;
    constructor() {
        this.register('default');
    }
    register(tag) {
        if (this.tagToBit.has(tag))
            return;
        if (this.nextBit > 0x8000) {
            throw new Error('Maximum collision tags reached (16 tags)');
        }
        this.tagToBit.set(tag, this.nextBit);
        this.bitToTag.set(this.nextBit, tag);
        this.nextBit <<= 1;
    }
    getBit(tag) {
        if (!this.tagToBit.has(tag)) {
            this.register(tag);
        }
        return this.tagToBit.get(tag);
    }
    getTag(bit) {
        return this.bitToTag.get(bit);
    }
    tagsToBits(tags) {
        if (!tags || tags.length === 0) {
            return this.getBit('default');
        }
        return tags.reduce((bits, tag) => bits | this.getBit(tag), 0);
    }
    bitsToTags(bits) {
        const tags = [];
        for (const [bit, tag] of this.bitToTag) {
            if (bits & bit) {
                tags.push(tag);
            }
        }
        return tags;
    }
}
exports.CollisionRegistry = CollisionRegistry;
class CollisionManager {
    world;
    registry;
    callbacks = new Map();
    constructor(world, registry) {
        this.world = world;
        this.registry = registry;
        this.setupListeners();
    }
    setupListeners() {
        this.world.world.on('begin-contact', (contact) => {
            this.handleBeginContact(contact);
        });
        this.world.world.on('end-contact', (contact) => {
            this.handleEndContact(contact);
        });
    }
    onCollision(tagA, tagB, callback) {
        const key = this.makeKey(tagA, tagB);
        if (!this.callbacks.has(key)) {
            this.callbacks.set(key, new Set());
        }
        this.callbacks.get(key).add(callback);
    }
    offCollision(tagA, tagB, callback) {
        const key = this.makeKey(tagA, tagB);
        this.callbacks.get(key)?.delete(callback);
    }
    makeKey(tagA, tagB) {
        return tagA < tagB ? `${tagA}:${tagB}` : `${tagB}:${tagA}`;
    }
    handleBeginContact(contact) {
        const bodyA = contact.getFixtureA().getBody().getUserData();
        const bodyB = contact.getFixtureB().getBody().getUserData();
        if (!bodyA || !bodyB)
            return;
        bodyA.onCollisionBegin?.(bodyB, contact);
        bodyB.onCollisionBegin?.(bodyA, contact);
        this.triggerTagCallbacks(bodyA, bodyB, contact);
    }
    handleEndContact(contact) {
        const bodyA = contact.getFixtureA().getBody().getUserData();
        const bodyB = contact.getFixtureB().getBody().getUserData();
        if (!bodyA || !bodyB)
            return;
        bodyA.onCollisionEnd?.(bodyB, contact);
        bodyB.onCollisionEnd?.(bodyA, contact);
    }
    triggerTagCallbacks(bodyA, bodyB, contact) {
        const tagsA = bodyA.options.collisionTags || [];
        const tagsB = bodyB.options.collisionTags || [];
        for (const tagA of tagsA) {
            for (const tagB of tagsB) {
                const key = this.makeKey(tagA, tagB);
                const callbacks = this.callbacks.get(key);
                if (callbacks) {
                    const event = {
                        bodyA,
                        bodyB,
                        contact,
                        normal: new PIXI.Point(0, 0),
                        impulse: 0
                    };
                    callbacks.forEach(cb => cb(event));
                }
            }
        }
    }
}
exports.CollisionManager = CollisionManager;


/***/ }),

/***/ "./src/library/physics/physics-debug-renderer.ts":
/*!*******************************************************!*\
  !*** ./src/library/physics/physics-debug-renderer.ts ***!
  \*******************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsDebugRenderer = void 0;
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const logic_1 = __webpack_require__(/*! ../../core/logic */ "./src/core/logic.ts");
class PhysicsDebugRenderer extends logic_1.Logic {
    name = 'PhysicsDebugRenderer';
    world;
    graphics;
    options;
    isVisible = true;
    constructor(world, options = {}) {
        super();
        this.world = world;
        this.options = {
            showShapes: options.showShapes ?? true,
            showVelocities: options.showVelocities ?? false,
            showAABBs: options.showAABBs ?? false,
            showCenterOfMass: options.showCenterOfMass ?? false,
            showContactPoints: options.showContactPoints ?? false,
            showJoints: options.showJoints ?? false,
            colorStatic: options.colorStatic ?? 0x00FF00,
            colorDynamic: options.colorDynamic ?? 0xFF0000,
            colorKinematic: options.colorKinematic ?? 0x0000FF,
            colorSleeping: options.colorSleeping ?? 0xAAAAAA,
            colorSensor: options.colorSensor ?? 0xFFFF00,
            alpha: options.alpha ?? 0.5,
            lineWidth: options.lineWidth ?? 2
        };
    }
    init(entity, renderer) {
        this.graphics = entity;
    }
    update(entity, deltaTime) {
        if (!this.isVisible) {
            this.graphics.clear();
            return;
        }
        this.graphics.clear();
        if (this.options.showShapes) {
            for (let body = this.world.world.getBodyList(); body; body = body.getNext()) {
                this.drawBody(body);
            }
        }
        if (this.options.showContactPoints) {
            this.drawContacts();
        }
    }
    drawBody(body) {
        const transform = body.getTransform();
        let color;
        if (!body.isAwake() && body.isDynamic()) {
            color = this.options.colorSleeping;
        }
        else if (body.isStatic()) {
            color = this.options.colorStatic;
        }
        else if (body.isKinematic()) {
            color = this.options.colorKinematic;
        }
        else {
            color = this.options.colorDynamic;
        }
        for (let fixture = body.getFixtureList(); fixture; fixture = fixture.getNext()) {
            const shape = fixture.getShape();
            const fixtureColor = fixture.isSensor() ? this.options.colorSensor : color;
            const alpha = fixture.isSensor() ? this.options.alpha * 0.5 : this.options.alpha;
            this.drawShape(shape, transform, fixtureColor, alpha);
        }
        if (this.options.showVelocities && body.isDynamic()) {
            this.drawVelocity(body);
        }
        if (this.options.showAABBs) {
            this.drawAABB(body);
        }
        if (this.options.showCenterOfMass) {
            this.drawCenterOfMass(body);
        }
    }
    drawShape(shape, transform, color, alpha) {
        this.graphics.stroke({
            width: this.options.lineWidth,
            color: color,
            alpha: alpha
        });
        const shapeType = shape.getType();
        if (shapeType === 'circle') {
            const circle = shape;
            const center = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, circle.getCenter()));
            const radius = circle.getRadius();
            const pixelCenter = this.world.toPixelsPoint(center);
            const pixelRadius = this.world.toPixels(radius);
            this.graphics.circle(pixelCenter.x, pixelCenter.y, pixelRadius);
            this.graphics.stroke();
            const angle = transform.q.getAngle();
            const endX = pixelCenter.x + Math.cos(angle) * pixelRadius;
            const endY = pixelCenter.y + Math.sin(angle) * pixelRadius;
            this.graphics.moveTo(pixelCenter.x, pixelCenter.y);
            this.graphics.lineTo(endX, endY);
            this.graphics.stroke();
        }
        else if (shapeType === 'polygon') {
            const poly = shape;
            const vertices = poly.m_vertices;
            if (vertices && vertices.length > 0) {
                const firstVertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[0]));
                const pixelFirst = this.world.toPixelsPoint(firstVertex);
                this.graphics.moveTo(pixelFirst.x, pixelFirst.y);
                for (let i = 1; i < vertices.length; i++) {
                    const vertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[i]));
                    const pixelVertex = this.world.toPixelsPoint(vertex);
                    this.graphics.lineTo(pixelVertex.x, pixelVertex.y);
                }
                this.graphics.lineTo(pixelFirst.x, pixelFirst.y);
                this.graphics.stroke();
            }
        }
        else if (shapeType === 'edge') {
            const edge = shape;
            const v1 = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, edge.m_vertex1));
            const v2 = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, edge.m_vertex2));
            const p1 = this.world.toPixelsPoint(v1);
            const p2 = this.world.toPixelsPoint(v2);
            this.graphics.moveTo(p1.x, p1.y);
            this.graphics.lineTo(p2.x, p2.y);
            this.graphics.stroke();
        }
        else if (shapeType === 'chain') {
            const chain = shape;
            const vertices = chain.m_vertices;
            if (vertices && vertices.length > 0) {
                const firstVertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[0]));
                const pixelFirst = this.world.toPixelsPoint(firstVertex);
                this.graphics.moveTo(pixelFirst.x, pixelFirst.y);
                for (let i = 1; i < vertices.length; i++) {
                    const vertex = planck.Vec2.add(transform.p, planck.Rot.mulVec2(transform.q, vertices[i]));
                    const pixelVertex = this.world.toPixelsPoint(vertex);
                    this.graphics.lineTo(pixelVertex.x, pixelVertex.y);
                }
                this.graphics.stroke();
            }
        }
    }
    drawVelocity(body) {
        const position = body.getPosition();
        const velocity = body.getLinearVelocity();
        const scale = 0.5;
        const endPoint = planck.Vec2.add(position, planck.Vec2.mul(velocity, scale));
        const pixelStart = this.world.toPixelsPoint(position);
        const pixelEnd = this.world.toPixelsPoint(endPoint);
        this.graphics.stroke({
            width: 2,
            color: 0x00FFFF,
            alpha: 0.8
        });
        this.graphics.moveTo(pixelStart.x, pixelStart.y);
        this.graphics.lineTo(pixelEnd.x, pixelEnd.y);
        this.graphics.stroke();
        const angle = Math.atan2(pixelEnd.y - pixelStart.y, pixelEnd.x - pixelStart.x);
        const arrowSize = 5;
        const angle1 = angle + Math.PI * 0.8;
        const angle2 = angle - Math.PI * 0.8;
        this.graphics.moveTo(pixelEnd.x, pixelEnd.y);
        this.graphics.lineTo(pixelEnd.x + Math.cos(angle1) * arrowSize, pixelEnd.y + Math.sin(angle1) * arrowSize);
        this.graphics.moveTo(pixelEnd.x, pixelEnd.y);
        this.graphics.lineTo(pixelEnd.x + Math.cos(angle2) * arrowSize, pixelEnd.y + Math.sin(angle2) * arrowSize);
        this.graphics.stroke();
    }
    drawAABB(body) {
        for (let fixture = body.getFixtureList(); fixture; fixture = fixture.getNext()) {
            const aabb = fixture.getAABB(0);
            const lowerBound = this.world.toPixelsPoint(aabb.lowerBound);
            const upperBound = this.world.toPixelsPoint(aabb.upperBound);
            this.graphics.stroke({
                width: 1,
                color: 0xFF00FF,
                alpha: 0.3
            });
            this.graphics.rect(lowerBound.x, lowerBound.y, upperBound.x - lowerBound.x, upperBound.y - lowerBound.y);
            this.graphics.stroke();
        }
    }
    drawCenterOfMass(body) {
        const position = body.getWorldCenter();
        const pixelPos = this.world.toPixelsPoint(position);
        this.graphics.stroke({
            width: 1,
            color: 0xFFFFFF,
            alpha: 1
        });
        const size = 5;
        this.graphics.moveTo(pixelPos.x - size, pixelPos.y);
        this.graphics.lineTo(pixelPos.x + size, pixelPos.y);
        this.graphics.moveTo(pixelPos.x, pixelPos.y - size);
        this.graphics.lineTo(pixelPos.x, pixelPos.y + size);
        this.graphics.stroke();
    }
    drawContacts() {
        for (let contact = this.world.world.getContactList(); contact; contact = contact.getNext()) {
            if (!contact.isTouching())
                continue;
            const manifold = contact.getManifold();
            if (!manifold)
                continue;
            const worldManifold = contact.getWorldManifold(null);
            if (!worldManifold)
                continue;
            for (let i = 0; i < manifold.pointCount; i++) {
                const point = worldManifold.points[i];
                if (!point)
                    continue;
                const pixelPoint = this.world.toPixelsPoint(planck.Vec2(point.x, point.y));
                this.graphics.circle(pixelPoint.x, pixelPoint.y, 3);
                this.graphics.fill({ color: 0xFF0000, alpha: 0.8 });
            }
        }
    }
    setVisible(visible) {
        this.isVisible = visible;
        if (!visible) {
            this.graphics.clear();
        }
    }
    toggle() {
        this.setVisible(!this.isVisible);
    }
    getVisible() {
        return this.isVisible;
    }
}
exports.PhysicsDebugRenderer = PhysicsDebugRenderer;


/***/ }),

/***/ "./src/library/physics/physics-graphics-parser.ts":
/*!********************************************************!*\
  !*** ./src/library/physics/physics-graphics-parser.ts ***!
  \********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.setGraphicsPhysicsShape = setGraphicsPhysicsShape;
exports.initGraphicsPhysicsTracking = initGraphicsPhysicsTracking;
exports.parseGraphicsShape = parseGraphicsShape;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const PHYSICS_SHAPE_KEY = '__physicsShape__';
function setGraphicsPhysicsShape(graphics, metadata) {
    graphics[PHYSICS_SHAPE_KEY] = metadata;
}
function initGraphicsPhysicsTracking() {
    const originalRect = PIXI.Graphics.prototype.rect;
    const originalCircle = PIXI.Graphics.prototype.circle;
    const originalPoly = PIXI.Graphics.prototype.poly;
    PIXI.Graphics.prototype.rect = function (x, y, w, h) {
        setGraphicsPhysicsShape(this, {
            type: 'rectangle',
            width: w,
            height: h
        });
        return originalRect.call(this, x, y, w, h);
    };
    PIXI.Graphics.prototype.circle = function (x, y, radius) {
        setGraphicsPhysicsShape(this, {
            type: 'circle',
            radius: radius
        });
        return originalCircle.call(this, x, y, radius);
    };
    PIXI.Graphics.prototype.poly = function (points) {
        const flatPoints = Array.isArray(points[0]) ? points.flat() : points;
        setGraphicsPhysicsShape(this, {
            type: 'polygon',
            vertices: flatPoints
        });
        return originalPoly.call(this, points);
    };
}
function parseGraphicsShape(graphics, world) {
    const metadata = graphics[PHYSICS_SHAPE_KEY];
    if (metadata) {
        switch (metadata.type) {
            case 'circle':
                if (!metadata.radius) {
                    throw new Error('Circle metadata missing radius');
                }
                return {
                    type: 'circle',
                    shape: planck.Circle(world.toPhysics(metadata.radius))
                };
            case 'rectangle':
                if (!metadata.width || !metadata.height) {
                    throw new Error('Rectangle metadata missing width/height');
                }
                return {
                    type: 'rectangle',
                    shape: planck.Box(world.toPhysics(metadata.width / 2), world.toPhysics(metadata.height / 2))
                };
            case 'polygon':
                if (!metadata.vertices || metadata.vertices.length < 6) {
                    throw new Error('Polygon metadata missing vertices (need at least 3 points = 6 values)');
                }
                const vertices = [];
                for (let i = 0; i < metadata.vertices.length; i += 2) {
                    vertices.push(planck.Vec2(world.toPhysics(metadata.vertices[i]), world.toPhysics(metadata.vertices[i + 1])));
                }
                return {
                    type: 'polygon',
                    shape: planck.Polygon(vertices)
                };
        }
    }
    const bounds = graphics.getLocalBounds();
    if (bounds.width === 0 || bounds.height === 0) {
        throw new Error('Graphics has no dimensions. Either draw shapes using rect(), circle(), or poly(), ' +
            'or provide an explicit collisionShape option.');
    }
    return {
        type: 'rectangle',
        shape: planck.Box(world.toPhysics(bounds.width / 2), world.toPhysics(bounds.height / 2))
    };
}


/***/ }),

/***/ "./src/library/physics/physics-materials.ts":
/*!**************************************************!*\
  !*** ./src/library/physics/physics-materials.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsMaterials = void 0;
exports.applyMaterial = applyMaterial;
exports.PhysicsMaterials = {
    bouncy: {
        density: 0.5,
        friction: 0.1,
        restitution: 0.9
    },
    wood: {
        density: 0.7,
        friction: 0.4,
        restitution: 0.2
    },
    metal: {
        density: 1.5,
        friction: 0.3,
        restitution: 0.1
    },
    ice: {
        density: 0.9,
        friction: 0.02,
        restitution: 0.05
    },
    rubber: {
        density: 1.0,
        friction: 0.9,
        restitution: 0.7
    },
    character: {
        density: 1.0,
        friction: 0.5,
        restitution: 0.0,
        fixedRotation: true
    },
    terrain: {
        density: 0,
        friction: 0.6,
        restitution: 0.0
    }
};
function applyMaterial(options, material) {
    return {
        ...options,
        ...exports.PhysicsMaterials[material]
    };
}


/***/ }),

/***/ "./src/library/physics/physics-utils.ts":
/*!**********************************************!*\
  !*** ./src/library/physics/physics-utils.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asPhysicsEntity = asPhysicsEntity;
exports.hasPhysics = hasPhysics;
exports.getPhysicsBody = getPhysicsBody;
exports.createShapeFromSprite = createShapeFromSprite;
const moxi_entity_1 = __webpack_require__(/*! ../../core/moxi-entity */ "./src/core/moxi-entity.ts");
const physics_body_logic_1 = __webpack_require__(/*! ./physics-body-logic */ "./src/library/physics/physics-body-logic.ts");
function asPhysicsEntity(pixiObject, world, options = {}) {
    const entity = (0, moxi_entity_1.asEntity)(pixiObject);
    const physicsLogic = new physics_body_logic_1.PhysicsBodyLogic(world, options);
    entity.moxiEntity.addLogic(physicsLogic);
    return entity;
}
function hasPhysics(entity) {
    if (!entity.moxiEntity)
        return false;
    return entity.moxiEntity.getLogic('PhysicsBodyLogic') !== undefined;
}
function getPhysicsBody(entity) {
    if (!entity.moxiEntity)
        return undefined;
    return entity.moxiEntity.getLogic('PhysicsBodyLogic');
}
function createShapeFromSprite(sprite, type = 'auto') {
    const bounds = sprite.getLocalBounds();
    if (type === 'auto') {
        const ratio = bounds.width / bounds.height;
        type = (ratio > 0.8 && ratio < 1.2) ? 'circle' : 'rectangle';
    }
    if (type === 'circle') {
        return {
            shape: 'circle',
            radius: Math.max(bounds.width, bounds.height) / 2
        };
    }
    else {
        return {
            shape: 'rectangle',
            width: bounds.width,
            height: bounds.height
        };
    }
}


/***/ }),

/***/ "./src/library/physics/physics-world.ts":
/*!**********************************************!*\
  !*** ./src/library/physics/physics-world.ts ***!
  \**********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.PhysicsWorld = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const planck = __importStar(__webpack_require__(/*! planck */ "../../node_modules/planck/dist/planck.js"));
const physics_collision_1 = __webpack_require__(/*! ./physics-collision */ "./src/library/physics/physics-collision.ts");
const physics_debug_renderer_1 = __webpack_require__(/*! ./physics-debug-renderer */ "./src/library/physics/physics-debug-renderer.ts");
const moxi_entity_1 = __webpack_require__(/*! ../../core/moxi-entity */ "./src/core/moxi-entity.ts");
const physics_graphics_parser_1 = __webpack_require__(/*! ./physics-graphics-parser */ "./src/library/physics/physics-graphics-parser.ts");
class PhysicsWorld {
    world;
    pixelsPerMeter = 30;
    timestep = 1 / 60;
    collisionRegistry;
    collisionManager;
    velocityIterations = 8;
    positionIterations = 3;
    accumulator = 0;
    bodies = new Map();
    debugRenderer;
    debugGraphics;
    constructor(options = {}) {
        (0, physics_graphics_parser_1.initGraphicsPhysicsTracking)();
        const { gravity = { x: 0, y: 9.8 }, pixelsPerMeter = 30, velocityIterations = 8, positionIterations = 3, enableSleeping = true, timestep = 1 / 60 } = options;
        this.pixelsPerMeter = pixelsPerMeter;
        this.velocityIterations = velocityIterations;
        this.positionIterations = positionIterations;
        this.timestep = timestep;
        this.world = planck.World({
            gravity: planck.Vec2(gravity.x, gravity.y)
        });
        this.world.setAllowSleeping(enableSleeping);
        this.collisionRegistry = new physics_collision_1.CollisionRegistry();
        this.collisionManager = new physics_collision_1.CollisionManager(this, this.collisionRegistry);
    }
    step(deltaTime) {
        this.accumulator += deltaTime;
        while (this.accumulator >= this.timestep) {
            this.world.step(this.timestep, this.velocityIterations, this.positionIterations);
            this.accumulator -= this.timestep;
        }
    }
    createBody(def) {
        return this.world.createBody(def);
    }
    destroyBody(body) {
        this.bodies.delete(body);
        this.world.destroyBody(body);
    }
    registerBody(body, logic) {
        this.bodies.set(body, logic);
    }
    getBodyLogic(body) {
        return this.bodies.get(body);
    }
    raycast(from, to, callback) {
        const p1 = this.toPhysicsPoint(from);
        const p2 = this.toPhysicsPoint(to);
        this.world.rayCast(p1, p2, (fixture, point, normal, fraction) => {
            const pixelPoint = this.toPixelsPoint(point);
            const pixelNormal = new PIXI.Point(normal.x, normal.y);
            return callback(fixture, pixelPoint, pixelNormal, fraction);
        });
    }
    queryAABB(bounds, callback) {
        const lowerBound = this.toPhysicsPoint(new PIXI.Point(bounds.x, bounds.y));
        const upperBound = this.toPhysicsPoint(new PIXI.Point(bounds.x + bounds.width, bounds.y + bounds.height));
        this.world.queryAABB(planck.AABB(lowerBound, upperBound), (fixture) => {
            return callback(fixture.getBody());
        });
    }
    queryPoint(point, callback) {
        const physicsPoint = this.toPhysicsPoint(point);
        this.world.queryAABB(planck.AABB(planck.Vec2(physicsPoint.x - 0.001, physicsPoint.y - 0.001), planck.Vec2(physicsPoint.x + 0.001, physicsPoint.y + 0.001)), (fixture) => {
            if (fixture.testPoint(physicsPoint)) {
                return callback(fixture);
            }
            return true;
        });
    }
    toPhysics(pixels) {
        return pixels / this.pixelsPerMeter;
    }
    toPixels(meters) {
        return meters * this.pixelsPerMeter;
    }
    toPhysicsPoint(point) {
        return planck.Vec2(this.toPhysics(point.x), this.toPhysics(point.y));
    }
    toPixelsPoint(vec) {
        return new PIXI.Point(this.toPixels(vec.x), this.toPixels(vec.y));
    }
    enableDebugRenderer(scene, options = {}) {
        if (this.debugRenderer) {
            this.disableDebugRenderer();
        }
        this.debugGraphics = new PIXI.Graphics();
        this.debugRenderer = new physics_debug_renderer_1.PhysicsDebugRenderer(this, options);
        const debugEntity = (0, moxi_entity_1.asEntity)(this.debugGraphics);
        debugEntity.moxiEntity.addLogic(this.debugRenderer);
        debugEntity.zIndex = 10000;
        scene.sortableChildren = true;
        scene.addChild(debugEntity);
        console.log('Physics debug renderer enabled. Press "P" to toggle visibility.');
        return this.debugRenderer;
    }
    disableDebugRenderer() {
        if (this.debugRenderer && this.debugGraphics) {
            if (this.debugGraphics.parent) {
                this.debugGraphics.parent.removeChild(this.debugGraphics);
            }
            this.debugGraphics.destroy();
            this.debugGraphics = undefined;
            this.debugRenderer = undefined;
        }
    }
    getDebugRenderer() {
        return this.debugRenderer;
    }
    getBodies() {
        const bodies = [];
        for (let body = this.world.getBodyList(); body; body = body.getNext()) {
            bodies.push(body);
        }
        return bodies;
    }
    destroy() {
        const bodies = this.getBodies();
        bodies.forEach(body => this.world.destroyBody(body));
        this.bodies.clear();
        this.debugRenderer = undefined;
    }
}
exports.PhysicsWorld = PhysicsWorld;


/***/ }),

/***/ "./src/library/resize-handler.ts":
/*!***************************************!*\
  !*** ./src/library/resize-handler.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createResizeHandler = createResizeHandler;
exports.setupResponsiveCanvas = setupResponsiveCanvas;
const DEFAULT_ROOT_STYLES = {
    display: 'flex',
    justifyContent: 'center',
    alignItems: 'center',
    overflow: 'hidden'
};
const PIXEL_ART_CANVAS_STYLES = {
    imageRendering: 'pixelated'
};
function createResizeHandler(options) {
    const { rootElement, width, height, rootStyles = DEFAULT_ROOT_STYLES, canvasStyles = {}, pixelArtMode = false } = options;
    Object.entries(rootStyles).forEach(([key, value]) => {
        rootElement.style.setProperty(key, value);
    });
    const finalCanvasStyles = pixelArtMode
        ? { ...PIXEL_ART_CANVAS_STYLES, ...canvasStyles }
        : canvasStyles;
    return () => {
        const parentWidth = rootElement.clientWidth;
        const parentHeight = rootElement.clientHeight;
        const ratio = Math.min(parentWidth / width, parentHeight / height);
        if (rootElement.firstElementChild instanceof HTMLCanvasElement) {
            const canvas = rootElement.firstElementChild;
            canvas.style.width = `${Math.round(width * ratio)}px`;
            canvas.style.height = `${Math.round(height * ratio)}px`;
            canvas.style.display = 'block';
            Object.entries(finalCanvasStyles).forEach(([key, value]) => {
                canvas.style.setProperty(key, value);
            });
        }
    };
}
function setupResponsiveCanvas(options) {
    const resizeHandler = createResizeHandler(options);
    resizeHandler();
    window.addEventListener('resize', resizeHandler);
    return () => {
        window.removeEventListener('resize', resizeHandler);
    };
}


/***/ }),

/***/ "./src/library/setup.ts":
/*!******************************!*\
  !*** ./src/library/setup.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.defaultRenderOptions = void 0;
exports.setupMoxi = setupMoxi;
const asset_loader_1 = __webpack_require__(/*! ../core/asset-loader */ "./src/core/asset-loader.ts");
const camera_1 = __webpack_require__(/*! ../core/camera */ "./src/core/camera.ts");
const engine_1 = __webpack_require__(/*! ../core/engine */ "./src/core/engine.ts");
const render_manager_1 = __webpack_require__(/*! ../core/render-manager */ "./src/core/render-manager.ts");
const scene_1 = __webpack_require__(/*! ../core/scene */ "./src/core/scene.ts");
const physics_1 = __webpack_require__(/*! ./physics */ "./src/library/physics/index.ts");
const loading_scene_1 = __webpack_require__(/*! ./loading-scene */ "./src/library/loading-scene.ts");
exports.defaultRenderOptions = {
    width: 1280,
    height: 720,
    backgroundColor: 0x1099bb,
    resolution: window.devicePixelRatio || 1,
    autoDensity: true,
    antialias: true
};
async function setupMoxi({ hostElement, renderOptions = exports.defaultRenderOptions, physics, showLoadingScene = false, loadingSceneOptions = {}, pixelPerfect } = {}) {
    let finalRenderOptions = { ...renderOptions };
    let applyImageRendering = false;
    if (pixelPerfect) {
        const ppOptions = typeof pixelPerfect === 'boolean'
            ? { enabled: true, imageRendering: true }
            : pixelPerfect;
        if (ppOptions.enabled !== false) {
            finalRenderOptions = {
                ...finalRenderOptions,
                resolution: 1,
                antialias: false,
                roundPixels: true
            };
        }
        applyImageRendering = ppOptions.imageRendering !== false;
    }
    const { renderer } = await render_manager_1.RenderManager.create(hostElement, finalRenderOptions);
    if (applyImageRendering) {
        const canvas = renderer.canvas;
        canvas.style.imageRendering = 'pixelated';
        canvas.style.imageRendering = '-moz-crisp-edges';
        canvas.style.imageRendering = 'crisp-edges';
    }
    const scene = new scene_1.Scene(renderer);
    const engine = new engine_1.Engine(scene);
    const assetLoader = new asset_loader_1.AssetLoader();
    const { PIXIAssets, loadAssets } = assetLoader;
    const camera = new camera_1.Camera(scene, renderer);
    let physicsWorld;
    if (physics) {
        const physicsOptions = typeof physics === 'boolean'
            ? {}
            : physics;
        physicsWorld = new physics_1.PhysicsWorld(physicsOptions);
        engine.addPhysicsWorld(physicsWorld);
    }
    let loadingScene;
    if (showLoadingScene) {
        loadingScene = new loading_scene_1.LoadingScene(loadingSceneOptions);
        loadingScene.zIndex = 10000;
        loadingScene.init(renderer);
        scene.addChild(loadingScene);
        loadingScene.hide();
        assetLoader.on('loading:start', () => {
            if (loadingScene) {
                loadingScene.show();
            }
        });
        assetLoader.on('loading:end', () => {
            if (loadingScene) {
                loadingScene.hide();
            }
        });
    }
    return {
        scene,
        engine,
        PIXIAssets,
        renderer,
        loadAssets,
        camera,
        physicsWorld,
        loadingScene
    };
}


/***/ }),

/***/ "./src/library/state-logic.ts":
/*!************************************!*\
  !*** ./src/library/state-logic.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.StateLogic = void 0;
const logic_1 = __webpack_require__(/*! ../core/logic */ "./src/core/logic.ts");
class StateLogic extends logic_1.Logic {
    _entity;
    constructor(name) {
        super();
        this.name = name;
    }
    get entity() {
        return this._entity;
    }
    init(entity, renderer) {
        this._entity = entity;
        super.init(entity, renderer);
    }
    onEnter(state) {
    }
    onExit(state) {
    }
    update(entity, deltaTime) {
    }
}
exports.StateLogic = StateLogic;


/***/ }),

/***/ "./src/library/state-machine.ts":
/*!**************************************!*\
  !*** ./src/library/state-machine.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.StateMachine = void 0;
class StateMachine extends EventTarget {
    _states = {};
    _currentState = null;
    _currentStateName = null;
    constructor(states = {}) {
        super();
        this._states = states;
    }
    update(deltaTime) {
        if (this._currentState) {
            this._currentState.update(this._currentState.entity, deltaTime);
        }
    }
    setState(stateName) {
        const nextState = this._states[stateName];
        if (!nextState)
            return;
        const prevStateName = this._currentStateName;
        if (this._currentState) {
            this._currentState.onExit(stateName);
        }
        this._currentState = this._states[stateName];
        this._currentStateName = stateName;
        this._currentState.onEnter(stateName);
        const event = new CustomEvent('stateChange', {
            detail: {
                prevState: prevStateName,
                newState: stateName
            }
        });
        this.dispatchEvent(event);
    }
    addState(state) {
        this._states[state.name] = state;
    }
    get currentState() {
        return this._currentStateName;
    }
}
exports.StateMachine = StateMachine;


/***/ }),

/***/ "./src/library/svg-utils/svg-to-texture.ts":
/*!*************************************************!*\
  !*** ./src/library/svg-utils/svg-to-texture.ts ***!
  \*************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.svgToTexture = svgToTexture;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
async function svgToTexture(options) {
    const { svgString, width, height, color = 0x000000 } = options;
    const colorHex = '#' + color.toString(16).padStart(6, '0');
    const processedSVG = svgString.replace(/currentColor/g, colorHex);
    const blob = new Blob([processedSVG], { type: 'image/svg+xml' });
    const url = URL.createObjectURL(blob);
    const img = new Image();
    img.width = width;
    img.height = height;
    await new Promise((resolve, reject) => {
        img.onload = () => resolve();
        img.onerror = reject;
        img.src = url;
    });
    const canvas = document.createElement('canvas');
    canvas.width = width;
    canvas.height = height;
    const ctx = canvas.getContext('2d');
    if (!ctx) {
        URL.revokeObjectURL(url);
        throw new Error('Failed to get canvas context');
    }
    ctx.drawImage(img, 0, 0, width, height);
    URL.revokeObjectURL(url);
    const texture = PIXI.Texture.from(canvas);
    texture.source.scaleMode = 'linear';
    return texture;
}


/***/ }),

/***/ "./src/library/texture-frame-sequences.ts":
/*!************************************************!*\
  !*** ./src/library/texture-frame-sequences.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.TextureFrameSequences = void 0;
class TextureFrameSequences {
    frames = [];
    sequences = {};
    constructor(frames, sequences = {}) {
        this.frames = frames;
        this.sequences = sequences;
    }
    addSequence(name, frameIndices, animationSpeed = 1) {
        this.sequences[name] = {
            frames: frameIndices,
            animationSpeed
        };
    }
    getSequence(name) {
        return this.sequences[name] || null;
    }
    getFrame(index) {
        return this.frames[index] || null;
    }
    getFrameFromSequence(sequenceName, frameIndex) {
        const sequence = this.getSequence(sequenceName);
        if (!sequence)
            return null;
        const sequenceFrameIndex = sequence.frames[frameIndex % sequence.frames.length];
        return this.frames[sequenceFrameIndex] || null;
    }
    getFrameSequence(name) {
        const sequence = this.getSequence(name);
        if (!sequence)
            return [];
        return sequence.frames.map(index => this.frames[index]).filter(Boolean);
    }
}
exports.TextureFrameSequences = TextureFrameSequences;


/***/ }),

/***/ "./src/library/texture-frames.ts":
/*!***************************************!*\
  !*** ./src/library/texture-frames.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.asTextureFrames = asTextureFrames;
const defaultOptions = {
    frameWidth: 48,
    frameHeight: 48,
    columns: 4,
    rows: 4
};
function asTextureFrames(PIXI, textureSource, options = defaultOptions) {
    const { frameWidth, frameHeight, columns, rows } = options;
    const frames = [];
    if (!textureSource) {
        console.error('Invalid texture source provided to asTextureFrames');
        return frames;
    }
    for (let y = 0; y < rows; y++) {
        for (let x = 0; x < columns; x++) {
            const frame = new PIXI.Rectangle(x * frameWidth, y * frameHeight, frameWidth, frameHeight);
            const frametexture = new PIXI.Texture({
                source: textureSource,
                frame: frame,
            });
            frames.push(frametexture);
        }
    }
    return frames;
}


/***/ }),

/***/ "./src/library/utils.ts":
/*!******************************!*\
  !*** ./src/library/utils.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.deg2rad = exports.rad2deg = exports.fetchXml = exports.lerp = exports.roundTo = exports.getRandomInt = exports.pr = exports.padRight = exports.lc = exports.uc = exports.ONE_POINT = exports.ZERO_POINT = exports.createPoint = void 0;
exports.metersToPixels = metersToPixels;
exports.pixelsToMeters = pixelsToMeters;
const pixi_js_1 = __webpack_require__(/*! pixi.js */ "pixi.js");
const createPoint = (x = 0, y = 0) => new pixi_js_1.Point(x, y);
exports.createPoint = createPoint;
const ZERO_POINT = () => new pixi_js_1.Point(0, 0);
exports.ZERO_POINT = ZERO_POINT;
const ONE_POINT = () => new pixi_js_1.Point(1, 1);
exports.ONE_POINT = ONE_POINT;
const uc = (s = '') => s.toUpperCase();
exports.uc = uc;
const lc = (s = '') => s.toLowerCase();
exports.lc = lc;
const padRight = (val = '', length = 0, padWith = ' ') => {
    let result = val + '';
    while (result.length < length) {
        result += padWith;
    }
    return result;
};
exports.padRight = padRight;
exports.pr = exports.padRight;
const getRandomInt = (min, max) => (Math.floor(Math.random() * (max + 1 - min)) + min);
exports.getRandomInt = getRandomInt;
const roundTo = (places, value) => (Math.round(value * Math.pow(10, places)) / Math.pow(10, places));
exports.roundTo = roundTo;
const lerp = (begin, end, mag) => ((1 - mag) * begin + mag * end);
exports.lerp = lerp;
function metersToPixels(m) { return m * 20; }
function pixelsToMeters(p) { return p * 0.05; }
const fetchXml = async (url) => (await (await fetch(url)).text());
exports.fetchXml = fetchXml;
const rad2deg = (rad) => rad * (180 / Math.PI);
exports.rad2deg = rad2deg;
const deg2rad = (deg) => deg * (Math.PI / 180);
exports.deg2rad = deg2rad;


/***/ }),

/***/ "./src/ui/UILayer.ts":
/*!***************************!*\
  !*** ./src/ui/UILayer.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UILayer = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const UIScaleMode_1 = __webpack_require__(/*! ./UIScaleMode */ "./src/ui/UIScaleMode.ts");
class UILayer extends PIXI.Container {
    scaleMode;
    targetWidth;
    targetHeight;
    initialBoundsRecorded = false;
    constructor(options = {}) {
        super();
        this.scaleMode = options.scaleMode ?? UIScaleMode_1.UIScaleMode.None;
        this.targetWidth = options.targetWidth;
        this.targetHeight = options.targetHeight;
    }
    updateScale(canvasWidth, canvasHeight) {
        if (this.scaleMode === UIScaleMode_1.UIScaleMode.None) {
            this.scale.set(1, 1);
            return;
        }
        if (!this.initialBoundsRecorded && this.children.length > 0) {
            if (!this.targetWidth || !this.targetHeight) {
                const bounds = this.getLocalBounds();
                this.targetWidth = this.targetWidth ?? bounds.width;
                this.targetHeight = this.targetHeight ?? bounds.height;
            }
            this.initialBoundsRecorded = true;
        }
        if (!this.targetWidth || !this.targetHeight) {
            return;
        }
        const scaleX = canvasWidth / this.targetWidth;
        const scaleY = canvasHeight / this.targetHeight;
        switch (this.scaleMode) {
            case UIScaleMode_1.UIScaleMode.ScaleUI:
                this.scale.set(scaleX, scaleY);
                break;
            case UIScaleMode_1.UIScaleMode.LockRatio:
                const scale = Math.min(scaleX, scaleY);
                this.scale.set(scale, scale);
                this.position.set((canvasWidth - this.targetWidth * scale) / 2, (canvasHeight - this.targetHeight * scale) / 2);
                break;
        }
    }
    addChild(...children) {
        const result = super.addChild(...children);
        this.initialBoundsRecorded = false;
        return result;
    }
}
exports.UILayer = UILayer;


/***/ }),

/***/ "./src/ui/UIScaleMode.ts":
/*!*******************************!*\
  !*** ./src/ui/UIScaleMode.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIScaleMode = void 0;
var UIScaleMode;
(function (UIScaleMode) {
    UIScaleMode["None"] = "none";
    UIScaleMode["ScaleUI"] = "scaleUI";
    UIScaleMode["LockRatio"] = "lockRatio";
})(UIScaleMode || (exports.UIScaleMode = UIScaleMode = {}));


/***/ }),

/***/ "./src/ui/components/button-background-strategy.ts":
/*!*********************************************************!*\
  !*** ./src/ui/components/button-background-strategy.ts ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.SpriteBackgroundStrategy = exports.SolidColorBackgroundStrategy = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_button_1 = __webpack_require__(/*! ./ui-button */ "./src/ui/components/ui-button.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
class SolidColorBackgroundStrategy {
    panel;
    normalColor;
    hoverColor;
    pressedColor;
    disabledColor;
    width;
    height;
    borderRadius;
    constructor(backgroundColor, width, height, borderRadius) {
        this.normalColor = backgroundColor;
        this.hoverColor = this.darkenColor(backgroundColor, 0.9);
        this.pressedColor = this.darkenColor(backgroundColor, 0.8);
        this.disabledColor = 0x888888;
        this.width = width;
        this.height = height;
        this.borderRadius = borderRadius;
    }
    create(width, height) {
        this.panel = new ui_panel_1.UIPanel({
            backgroundColor: this.normalColor,
            width,
            height,
            borderRadius: this.borderRadius
        });
        this.panel.layout(width, height);
        return this.panel.container;
    }
    updateState(state) {
        if (!this.panel)
            return;
        let color;
        switch (state) {
            case ui_button_1.ButtonState.Normal:
                color = this.normalColor;
                break;
            case ui_button_1.ButtonState.Hover:
                color = this.hoverColor;
                break;
            case ui_button_1.ButtonState.Pressed:
                color = this.pressedColor;
                break;
            case ui_button_1.ButtonState.Disabled:
                color = this.disabledColor;
                break;
        }
        this.panel.setBackgroundColor(color);
    }
    getActualHeight() {
        return this.height;
    }
    destroy() {
    }
    darkenColor(color, factor) {
        const r = ((color >> 16) & 0xff) * factor;
        const g = ((color >> 8) & 0xff) * factor;
        const b = (color & 0xff) * factor;
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
}
exports.SolidColorBackgroundStrategy = SolidColorBackgroundStrategy;
class SpriteBackgroundStrategy {
    container;
    spriteLeft;
    spriteMid;
    spriteRight;
    nineSliceSprite;
    nineSliceSpritePressed;
    iconSprite;
    config;
    width;
    height;
    constructor(config, width, height) {
        this.config = config;
        this.width = width;
        this.height = height;
    }
    create(width, height) {
        this.container = new pixi_js_1.default.Container();
        const { spritesheet, texturePattern, color, pixelPerfect, useNineSlice, nineSliceBorders, pressedTexturePattern, icon } = this.config;
        if (pixelPerfect && spritesheet.textureSource) {
            spritesheet.textureSource.scaleMode = 'nearest';
        }
        if (useNineSlice && nineSliceBorders) {
            const textureName = texturePattern.includes('{color}')
                ? texturePattern.replace('{color}', color)
                : texturePattern;
            const texture = spritesheet.textures[textureName];
            this.nineSliceSprite = new pixi_js_1.default.NineSliceSprite({
                texture,
                leftWidth: nineSliceBorders.left,
                topHeight: nineSliceBorders.top,
                rightWidth: nineSliceBorders.right,
                bottomHeight: nineSliceBorders.bottom,
                width,
                height
            });
            this.container.addChild(this.nineSliceSprite);
            if (pressedTexturePattern) {
                const pressedTextureName = pressedTexturePattern.includes('{color}')
                    ? pressedTexturePattern.replace('{color}', color)
                    : pressedTexturePattern;
                const pressedTexture = spritesheet.textures[pressedTextureName];
                this.nineSliceSpritePressed = new pixi_js_1.default.NineSliceSprite({
                    texture: pressedTexture,
                    leftWidth: nineSliceBorders.left,
                    topHeight: nineSliceBorders.top,
                    rightWidth: nineSliceBorders.right,
                    bottomHeight: nineSliceBorders.bottom,
                    width,
                    height
                });
                this.nineSliceSpritePressed.y = 4;
                this.nineSliceSpritePressed.visible = false;
                this.container.addChild(this.nineSliceSpritePressed);
            }
        }
        else {
            const leftTextureName = this.getTextureName(texturePattern, color, 'left');
            const midTextureName = this.getTextureName(texturePattern, color, 'mid');
            const rightTextureName = this.getTextureName(texturePattern, color, 'right');
            this.spriteLeft = new pixi_js_1.default.Sprite(spritesheet.textures[leftTextureName]);
            this.spriteMid = new pixi_js_1.default.Sprite(spritesheet.textures[midTextureName]);
            this.spriteRight = new pixi_js_1.default.Sprite(spritesheet.textures[rightTextureName]);
            const scaleY = height / this.spriteLeft.height;
            this.spriteLeft.scale.y = scaleY;
            this.spriteMid.scale.y = scaleY;
            this.spriteRight.scale.y = scaleY;
            this.spriteLeft.x = 0;
            const middleWidth = width - this.spriteLeft.width - this.spriteRight.width;
            this.spriteMid.width = middleWidth;
            this.spriteMid.x = this.spriteLeft.width;
            this.spriteRight.x = this.spriteLeft.width + middleWidth;
            this.container.addChild(this.spriteLeft);
            this.container.addChild(this.spriteMid);
            this.container.addChild(this.spriteRight);
        }
        if (icon) {
            const iconTexture = icon.spritesheet.textures[icon.textureName];
            this.iconSprite = new pixi_js_1.default.Sprite(iconTexture);
            if (icon.pixelPerfect && icon.spritesheet.textureSource) {
                icon.spritesheet.textureSource.scaleMode = 'nearest';
            }
            if (icon.scale) {
                this.iconSprite.scale.set(icon.scale);
            }
            this.iconSprite.anchor.set(0.5);
            this.iconSprite.x = width / 2;
            this.iconSprite.y = height / 2;
            this.container.addChild(this.iconSprite);
        }
        return this.container;
    }
    updateState(state) {
        if (this.nineSliceSprite && this.nineSliceSpritePressed) {
            const isPressed = state === ui_button_1.ButtonState.Pressed;
            this.nineSliceSprite.visible = !isPressed;
            this.nineSliceSpritePressed.visible = isPressed;
            if (this.iconSprite) {
                this.iconSprite.y = (this.height / 2) + (isPressed ? 4 : 0);
            }
        }
        else {
            let tint;
            switch (state) {
                case ui_button_1.ButtonState.Normal:
                    tint = 0xffffff;
                    break;
                case ui_button_1.ButtonState.Hover:
                    tint = 0xcccccc;
                    break;
                case ui_button_1.ButtonState.Pressed:
                    tint = 0x999999;
                    break;
                case ui_button_1.ButtonState.Disabled:
                    tint = 0x888888;
                    break;
            }
            if (this.nineSliceSprite) {
                this.nineSliceSprite.tint = tint;
            }
            else if (this.spriteLeft && this.spriteMid && this.spriteRight) {
                this.spriteLeft.tint = tint;
                this.spriteMid.tint = tint;
                this.spriteRight.tint = tint;
            }
        }
    }
    getActualHeight() {
        if (this.nineSliceSprite) {
            return this.nineSliceSprite.height;
        }
        return this.spriteLeft?.height ?? this.height;
    }
    destroy() {
        this.container?.destroy({ children: true });
    }
    getTextureName(pattern, color, part) {
        let name = pattern.replace('{color}', color);
        name = name.replace(/_(?:left|mid|right)\.png$/, `_${part}.png`);
        return name;
    }
}
exports.SpriteBackgroundStrategy = SpriteBackgroundStrategy;


/***/ }),

/***/ "./src/ui/components/ui-box.ts":
/*!*************************************!*\
  !*** ./src/ui/components/ui-box.ts ***!
  \*************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIBox = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UIBox extends ui_component_1.UIComponent {
    props;
    graphics;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            backgroundColor: 0x000000,
            backgroundAlpha: 1,
            borderWidth: 0,
            borderRadius: 0,
            ...props
        };
        this.graphics = new pixi_js_1.default.Graphics();
        this.container.addChild(this.graphics);
        if (props.width !== undefined) {
            this.boxModel.width = props.width;
        }
        if (props.height !== undefined) {
            this.boxModel.height = props.height;
        }
    }
    measure() {
        const padding = this.boxModel.padding;
        const border = this.boxModel.border;
        let contentWidth = 0;
        let contentHeight = 0;
        if (typeof this.boxModel.width === 'number') {
            contentWidth = this.boxModel.width;
        }
        else if (this.props.width !== undefined) {
            contentWidth = this.props.width;
        }
        if (typeof this.boxModel.height === 'number') {
            contentHeight = this.boxModel.height;
        }
        else if (this.props.height !== undefined) {
            contentHeight = this.props.height;
        }
        const totalWidth = contentWidth + padding.horizontal + (border?.horizontal ?? 0);
        const totalHeight = contentHeight + padding.vertical + (border?.vertical ?? 0);
        return {
            width: Math.max(totalWidth, this.boxModel.minWidth ?? 0),
            height: Math.max(totalHeight, this.boxModel.minHeight ?? 0)
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        const padding = this.boxModel.padding;
        const border = this.boxModel.border ?? { horizontal: 0, vertical: 0, top: 0, right: 0, bottom: 0, left: 0 };
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        if (this.boxModel.maxWidth !== undefined) {
            finalWidth = Math.min(finalWidth, this.boxModel.maxWidth);
        }
        if (this.boxModel.maxHeight !== undefined) {
            finalHeight = Math.min(finalHeight, this.boxModel.maxHeight);
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left + border.left;
        this.computedLayout.contentY = padding.top + border.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal - border.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical - border.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        this.graphics.clear();
        const { width, height } = this.computedLayout;
        const { backgroundColor, backgroundAlpha, borderColor, borderWidth, borderRadius } = this.props;
        if (borderWidth && borderWidth > 0 && borderColor !== undefined) {
            this.graphics.rect(0, 0, width, height);
            this.graphics.stroke({ color: borderColor, width: borderWidth });
        }
        if (backgroundColor !== undefined) {
            if (borderRadius && borderRadius > 0) {
                this.graphics.roundRect(0, 0, width, height, borderRadius);
            }
            else {
                this.graphics.rect(0, 0, width, height);
            }
            this.graphics.fill({ color: backgroundColor, alpha: backgroundAlpha });
        }
    }
    setBackgroundColor(color, alpha = 1) {
        this.props.backgroundColor = color;
        this.props.backgroundAlpha = alpha;
        this.render();
    }
    setBorder(color, width) {
        this.props.borderColor = color;
        this.props.borderWidth = width;
        this.render();
    }
}
exports.UIBox = UIBox;


/***/ }),

/***/ "./src/ui/components/ui-button.ts":
/*!****************************************!*\
  !*** ./src/ui/components/ui-button.ts ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIButton = exports.ButtonState = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
const button_background_strategy_1 = __webpack_require__(/*! ./button-background-strategy */ "./src/ui/components/button-background-strategy.ts");
var ButtonState;
(function (ButtonState) {
    ButtonState["Normal"] = "normal";
    ButtonState["Hover"] = "hover";
    ButtonState["Pressed"] = "pressed";
    ButtonState["Disabled"] = "disabled";
})(ButtonState || (exports.ButtonState = ButtonState = {}));
class UIButton extends ui_component_1.UIComponent {
    props;
    useBitmapText;
    bitmapFontFamily;
    onClick;
    onHover;
    state = ButtonState.Normal;
    backgroundStrategy;
    label;
    bitmapLabel;
    labelCenterX = 0;
    labelCenterY = 0;
    keydownHandler;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            label: props.label ?? '',
            width: props.width ?? 120,
            height: props.height ?? 40,
            backgroundColor: props.backgroundColor ?? 0x4a90e2,
            textColor: props.textColor ?? 0xffffff,
            fontSize: props.fontSize ?? 16,
            borderRadius: props.borderRadius ?? 4,
            padding: props.padding ?? edge_insets_1.EdgeInsets.symmetric(8, 16),
            enabled: props.enabled ?? true
        };
        this.useBitmapText = props.useBitmapText ?? false;
        this.bitmapFontFamily = props.bitmapFontFamily;
        this.onClick = props.onClick;
        this.onHover = props.onHover;
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.tabIndex = 0;
        if (props.spriteBackground) {
            this.backgroundStrategy = new button_background_strategy_1.SpriteBackgroundStrategy(props.spriteBackground, this.props.width, this.props.height);
        }
        else {
            this.backgroundStrategy = new button_background_strategy_1.SolidColorBackgroundStrategy(this.props.backgroundColor, this.props.width, this.props.height, this.props.borderRadius);
        }
        const backgroundContainer = this.backgroundStrategy.create(this.props.width, this.props.height);
        this.container.addChild(backgroundContainer);
        if (this.props.label) {
            if (this.useBitmapText && this.bitmapFontFamily) {
                this.createBitmapLabel();
            }
            else {
                this.label = new ui_label_1.UILabel({
                    text: this.props.label,
                    fontSize: this.props.fontSize,
                    color: this.props.textColor,
                    align: 'center'
                }, {
                    padding: edge_insets_1.EdgeInsets.zero()
                });
                this.container.addChild(this.label.container);
            }
        }
        this.setupInteractivity();
        if (!this.props.enabled) {
            this.setState(ButtonState.Disabled);
        }
    }
    createBitmapLabel() {
        if (!this.bitmapFontFamily)
            return;
        this.bitmapLabel = new pixi_js_1.default.BitmapText({
            text: this.props.label,
            style: {
                fontFamily: this.bitmapFontFamily,
                fontSize: this.props.fontSize,
                fill: this.props.textColor
            }
        });
        this.container.addChild(this.bitmapLabel);
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'pointer';
        this.container.on('pointerover', this.handlePointerOver.bind(this));
        this.container.on('pointerout', this.handlePointerOut.bind(this));
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        this.container.on('pointerup', this.handlePointerUp.bind(this));
        this.container.on('pointerupoutside', this.handlePointerUpOutside.bind(this));
        if (typeof window !== 'undefined') {
            this.keydownHandler = (e) => {
                if (this.isFocused() && this.props.enabled) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.setState(ButtonState.Pressed);
                        this.onClick?.();
                        setTimeout(() => {
                            if (this.props.enabled) {
                                this.setState(ButtonState.Normal);
                            }
                        }, 100);
                    }
                }
            };
            window.addEventListener('keydown', this.keydownHandler);
        }
    }
    handlePointerOver() {
        if (this.props.enabled && this.state === ButtonState.Normal) {
            this.setState(ButtonState.Hover);
            this.onHover?.();
        }
    }
    handlePointerOut() {
        if (this.props.enabled && this.state !== ButtonState.Pressed) {
            this.setState(ButtonState.Normal);
        }
    }
    handlePointerDown() {
        console.log('ðµ Button handlePointerDown called');
        console.log('  - enabled:', this.props.enabled);
        console.log('  - canFocus:', this.canFocus());
        console.log('  - tabIndex:', this.tabIndex);
        if (this.props.enabled) {
            this.setState(ButtonState.Pressed);
            if (this.canFocus()) {
                const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
                console.log('  - focusManager:', focusManager);
                if (focusManager) {
                    console.log('  - Calling requestFocus');
                    focusManager.requestFocus(this);
                }
                else {
                    console.log('  - No focus manager, calling onFocus directly');
                    this.onFocus();
                }
            }
            else {
                console.log('  - canFocus returned false, NOT focusing');
            }
        }
    }
    handlePointerUp() {
        if (this.props.enabled) {
            this.setState(ButtonState.Hover);
            this.onClick?.();
        }
    }
    handlePointerUpOutside() {
        if (this.props.enabled) {
            this.setState(ButtonState.Normal);
        }
    }
    setState(newState) {
        this.state = newState;
        this.updateVisuals();
    }
    updateVisuals() {
        this.backgroundStrategy.updateState(this.state);
        const yOffset = this.state === ButtonState.Pressed ? 2 : 0;
        if (this.state === ButtonState.Disabled) {
            this.container.cursor = 'default';
        }
        else {
            this.container.cursor = 'pointer';
        }
        if (this.label) {
            this.label.setPosition(this.labelCenterX, this.labelCenterY + yOffset);
        }
        else if (this.bitmapLabel) {
            this.bitmapLabel.x = this.labelCenterX;
            this.bitmapLabel.y = this.labelCenterY + yOffset;
        }
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        const actualHeight = this.backgroundStrategy.getActualHeight();
        if (this.label) {
            this.label.layout(measured.width, measured.height);
            const labelLayout = this.label.getLayout();
            this.labelCenterX = (measured.width - labelLayout.width) / 2;
            this.labelCenterY = (actualHeight - labelLayout.height) / 2;
            this.label.setPosition(this.labelCenterX, this.labelCenterY);
        }
        else if (this.bitmapLabel) {
            this.labelCenterX = (measured.width - this.bitmapLabel.width) / 2;
            this.labelCenterY = (actualHeight - this.bitmapLabel.height) / 2;
            this.bitmapLabel.x = this.labelCenterX;
            this.bitmapLabel.y = this.labelCenterY;
        }
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setLabel(text) {
        if (this.label) {
            this.label.setText(text);
            this.markLayoutDirty();
        }
        else if (this.bitmapLabel) {
            this.bitmapLabel.text = text;
            this.markLayoutDirty();
        }
    }
    setEnabled(enabled) {
        this.props.enabled = enabled;
        this.setState(enabled ? ButtonState.Normal : ButtonState.Disabled);
    }
    getState() {
        return this.state;
    }
    destroy() {
        if (typeof window !== 'undefined' && this.keydownHandler) {
            window.removeEventListener('keydown', this.keydownHandler);
        }
        super.destroy();
    }
}
exports.UIButton = UIButton;


/***/ }),

/***/ "./src/ui/components/ui-label.ts":
/*!***************************************!*\
  !*** ./src/ui/components/ui-label.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UILabel = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UILabel extends ui_component_1.UIComponent {
    props;
    textObject;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            text: props.text,
            fontSize: props.fontSize ?? 16,
            fontFamily: props.fontFamily ?? 'Arial',
            color: props.color ?? 0xffffff,
            align: props.align ?? 'left',
            wordWrap: props.wordWrap ?? false,
            wordWrapWidth: props.wordWrapWidth ?? 0,
            fontWeight: props.fontWeight ?? 'normal',
            lineHeight: props.lineHeight ?? 1.2
        };
        this.textObject = new pixi_js_1.default.Text({
            text: this.props.text,
            style: this.getTextStyle(),
            resolution: window.devicePixelRatio || 2
        });
        this.container.addChild(this.textObject);
    }
    getTextStyle() {
        const style = {
            fontFamily: this.props.fontFamily,
            fontSize: this.props.fontSize,
            fill: this.props.color,
            align: this.props.align,
            fontWeight: this.props.fontWeight,
            lineHeight: this.props.fontSize * this.props.lineHeight
        };
        if (this.props.wordWrap) {
            style.wordWrap = true;
            style.wordWrapWidth = this.props.wordWrapWidth;
        }
        return style;
    }
    measure() {
        const padding = this.boxModel.padding;
        const metrics = this.textObject;
        const textWidth = metrics.width;
        const textHeight = metrics.height;
        return {
            width: textWidth + padding.horizontal,
            height: textHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const padding = this.boxModel.padding;
        if (this.props.wordWrap && this.props.wordWrapWidth === 0) {
            const wrapWidth = availableWidth - padding.horizontal;
            this.props.wordWrapWidth = wrapWidth;
            this.textObject.style = this.getTextStyle();
        }
        const measured = this.measure();
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        else if (typeof this.boxModel.width === 'number') {
            finalWidth = this.boxModel.width + padding.horizontal;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        else if (typeof this.boxModel.height === 'number') {
            finalHeight = this.boxModel.height + padding.vertical;
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        const padding = this.boxModel.padding;
        this.textObject.position.set(padding.left, padding.top);
    }
    setText(text) {
        this.props.text = text;
        this.textObject.text = text;
        this.markLayoutDirty();
    }
    setColor(color) {
        this.props.color = color;
        this.textObject.style.fill = color;
    }
    setFontSize(size) {
        this.props.fontSize = size;
        this.textObject.style.fontSize = size;
        this.markLayoutDirty();
    }
    getText() {
        return this.props.text;
    }
}
exports.UILabel = UILabel;


/***/ }),

/***/ "./src/ui/components/ui-panel.ts":
/*!***************************************!*\
  !*** ./src/ui/components/ui-panel.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIPanel = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
class UIPanel extends ui_component_1.UIComponent {
    props;
    background;
    constructor(props = {}, boxModel) {
        super(boxModel);
        this.props = {
            backgroundAlpha: props.backgroundAlpha ?? 1,
            ...props
        };
        if (props.width !== undefined) {
            this.boxModel.width = props.width;
        }
        if (props.height !== undefined) {
            this.boxModel.height = props.height;
        }
        this.createBackground();
    }
    createBackground() {
        if (this.props.texture && this.props.nineSlice) {
            const { leftWidth, topHeight, rightWidth, bottomHeight } = this.props.nineSlice;
            this.background = new pixi_js_1.default.NineSliceSprite({
                texture: this.props.texture,
                leftWidth,
                topHeight,
                rightWidth,
                bottomHeight
            });
            this.background.alpha = this.props.backgroundAlpha ?? 1;
            this.container.addChild(this.background);
        }
        else if (this.props.backgroundColor !== undefined) {
            this.background = new pixi_js_1.default.Graphics();
            this.container.addChild(this.background);
        }
    }
    measure() {
        const padding = this.boxModel.padding;
        let contentWidth = 0;
        let contentHeight = 0;
        if (typeof this.boxModel.width === 'number') {
            contentWidth = this.boxModel.width;
        }
        else if (this.props.width !== undefined) {
            contentWidth = this.props.width;
        }
        if (typeof this.boxModel.height === 'number') {
            contentHeight = this.boxModel.height;
        }
        else if (this.props.height !== undefined) {
            contentHeight = this.props.height;
        }
        return {
            width: contentWidth + padding.horizontal,
            height: contentHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        const padding = this.boxModel.padding;
        let finalWidth = measured.width;
        let finalHeight = measured.height;
        if (this.boxModel.width === 'fill') {
            finalWidth = availableWidth;
        }
        if (this.boxModel.height === 'fill') {
            finalHeight = availableHeight;
        }
        if (this.boxModel.maxWidth !== undefined) {
            finalWidth = Math.min(finalWidth, this.boxModel.maxWidth);
        }
        if (this.boxModel.maxHeight !== undefined) {
            finalHeight = Math.min(finalHeight, this.boxModel.maxHeight);
        }
        this.computedLayout.width = finalWidth;
        this.computedLayout.height = finalHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = finalWidth - padding.horizontal;
        this.computedLayout.contentHeight = finalHeight - padding.vertical;
        this.layoutDirty = false;
        this.render();
    }
    render() {
        if (!this.background)
            return;
        const { width, height } = this.computedLayout;
        if (this.background instanceof pixi_js_1.default.NineSliceSprite) {
            this.background.width = width;
            this.background.height = height;
        }
        else if (this.background instanceof pixi_js_1.default.Graphics) {
            this.background.clear();
            if (this.props.borderRadius && this.props.borderRadius > 0) {
                this.background.roundRect(0, 0, width, height, this.props.borderRadius);
            }
            else {
                this.background.rect(0, 0, width, height);
            }
            if (this.props.backgroundColor !== undefined) {
                this.background.fill({
                    color: this.props.backgroundColor,
                    alpha: this.props.backgroundAlpha
                });
            }
        }
    }
    setBackgroundColor(color, alpha = 1) {
        if (this.background instanceof pixi_js_1.default.Graphics) {
            this.props.backgroundColor = color;
            this.props.backgroundAlpha = alpha;
            this.render();
        }
    }
    setTexture(texture) {
        if (this.background instanceof pixi_js_1.default.NineSliceSprite) {
            this.background.texture = texture;
        }
    }
}
exports.UIPanel = UIPanel;


/***/ }),

/***/ "./src/ui/components/ui-scroll-container.ts":
/*!**************************************************!*\
  !*** ./src/ui/components/ui-scroll-container.ts ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIScrollContainer = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
class UIScrollContainer extends ui_component_1.UIComponent {
    props;
    background;
    contentContainer;
    contentMask;
    scrollbarTrack;
    scrollbarThumb;
    children = [];
    scrollY = 0;
    maxScrollY = 0;
    contentHeight = 0;
    isDragging = false;
    dragStartY = 0;
    dragStartScrollY = 0;
    isHoveringThumb = false;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            width: props.width,
            height: props.height,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            borderRadius: props.borderRadius ?? 0,
            scrollbarWidth: props.scrollbarWidth ?? 12,
            scrollbarTrackColor: props.scrollbarTrackColor ?? 0xe0e0e0,
            scrollbarThumbColor: props.scrollbarThumbColor ?? 0x888888,
            scrollbarThumbHoverColor: props.scrollbarThumbHoverColor ?? 0x555555,
            scrollbarAutoHide: props.scrollbarAutoHide ?? false,
            padding: props.padding ?? edge_insets_1.EdgeInsets.all(0)
        };
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new pixi_js_1.default.Graphics();
        this.updateBackground();
        this.container.addChild(this.background);
        this.contentContainer = new pixi_js_1.default.Container();
        this.contentContainer.x = this.props.padding.left;
        this.contentContainer.y = this.props.padding.top;
        this.container.addChild(this.contentContainer);
        this.contentMask = new pixi_js_1.default.Graphics();
        this.updateMask();
        this.container.addChild(this.contentMask);
        this.contentContainer.mask = this.contentMask;
        this.scrollbarTrack = new pixi_js_1.default.Graphics();
        this.scrollbarTrack.eventMode = 'static';
        this.scrollbarTrack.cursor = 'pointer';
        this.container.addChild(this.scrollbarTrack);
        this.scrollbarThumb = new pixi_js_1.default.Graphics();
        this.scrollbarThumb.eventMode = 'static';
        this.scrollbarThumb.cursor = 'pointer';
        this.container.addChild(this.scrollbarThumb);
        this.setupInteractivity();
        this.updateScrollbar();
    }
    updateBackground() {
        this.background.clear();
        this.background.roundRect(0, 0, this.props.width, this.props.height, this.props.borderRadius);
        this.background.fill({ color: this.props.backgroundColor });
    }
    updateMask() {
        const contentWidth = this.props.width - this.props.padding.left - this.props.padding.right - this.props.scrollbarWidth;
        const contentHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        this.contentMask.clear();
        this.contentMask.rect(this.props.padding.left, this.props.padding.top, contentWidth, contentHeight);
        this.contentMask.fill({ color: 0xffffff });
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.on('wheel', this.handleWheel.bind(this));
        this.scrollbarThumb.on('pointerdown', this.handleThumbPointerDown.bind(this));
        this.scrollbarThumb.on('pointerover', () => {
            this.isHoveringThumb = true;
            this.updateScrollbar();
        });
        this.scrollbarThumb.on('pointerout', () => {
            if (!this.isDragging) {
                this.isHoveringThumb = false;
                this.updateScrollbar();
            }
        });
        this.scrollbarTrack.on('pointerdown', this.handleTrackPointerDown.bind(this));
        if (typeof window !== 'undefined') {
            window.addEventListener('pointermove', this.handleGlobalPointerMove.bind(this));
            window.addEventListener('pointerup', this.handleGlobalPointerUp.bind(this));
        }
    }
    handleWheel(e) {
        e.preventDefault();
        const delta = e.deltaY;
        this.scrollY += delta;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleThumbPointerDown(e) {
        this.isDragging = true;
        this.dragStartY = e.globalY;
        this.dragStartScrollY = this.scrollY;
        e.stopPropagation();
    }
    handleTrackPointerDown(e) {
        const localY = e.globalY - this.container.worldTransform.ty;
        const thumbHeight = this.getThumbHeight();
        const trackTop = 0;
        const trackBottom = this.props.height;
        const clickRatio = (localY - trackTop) / (trackBottom - trackTop);
        this.scrollY = clickRatio * this.maxScrollY;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleGlobalPointerMove(e) {
        if (!this.isDragging)
            return;
        const deltaY = e.clientY - this.dragStartY;
        const trackHeight = this.props.height;
        const thumbHeight = this.getThumbHeight();
        const scrollableTrackHeight = trackHeight - thumbHeight;
        if (scrollableTrackHeight <= 0)
            return;
        const scrollDelta = (deltaY / scrollableTrackHeight) * this.maxScrollY;
        this.scrollY = this.dragStartScrollY + scrollDelta;
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    handleGlobalPointerUp() {
        if (this.isDragging) {
            this.isDragging = false;
            if (!this.isHoveringThumb) {
                this.updateScrollbar();
            }
        }
    }
    updateContentPosition() {
        this.contentContainer.y = this.props.padding.top - this.scrollY;
    }
    getThumbHeight() {
        if (this.contentHeight <= 0)
            return 0;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        const ratio = viewportHeight / this.contentHeight;
        const thumbHeight = Math.max(30, this.props.height * ratio);
        return Math.min(thumbHeight, this.props.height);
    }
    getThumbY() {
        if (this.maxScrollY <= 0)
            return 0;
        const trackHeight = this.props.height;
        const thumbHeight = this.getThumbHeight();
        const scrollableTrackHeight = trackHeight - thumbHeight;
        const scrollRatio = this.scrollY / this.maxScrollY;
        return scrollRatio * scrollableTrackHeight;
    }
    updateScrollbar() {
        const trackX = this.props.width - this.props.scrollbarWidth;
        const trackWidth = this.props.scrollbarWidth;
        const trackHeight = this.props.height;
        this.scrollbarTrack.clear();
        this.scrollbarTrack.rect(trackX, 0, trackWidth, trackHeight);
        this.scrollbarTrack.fill({ color: this.props.scrollbarTrackColor });
        const thumbHeight = this.getThumbHeight();
        const thumbY = this.getThumbY();
        const thumbColor = (this.isHoveringThumb || this.isDragging)
            ? this.props.scrollbarThumbHoverColor
            : this.props.scrollbarThumbColor;
        this.scrollbarThumb.clear();
        if (this.maxScrollY > 0) {
            this.scrollbarThumb.roundRect(trackX + 2, thumbY + 2, trackWidth - 4, thumbHeight - 4, 4);
            this.scrollbarThumb.fill({ color: thumbColor });
            this.scrollbarThumb.visible = true;
        }
        else {
            this.scrollbarThumb.visible = false;
        }
        if (this.props.scrollbarAutoHide && !this.isDragging && !this.isHoveringThumb) {
            this.scrollbarTrack.alpha = 0;
            this.scrollbarThumb.alpha = 0;
        }
        else {
            this.scrollbarTrack.alpha = 1;
            this.scrollbarThumb.alpha = 1;
        }
    }
    updateContentBounds() {
        let maxHeight = 0;
        this.contentContainer.children.forEach((child) => {
            const childBottom = child.y + child.height;
            if (childBottom > maxHeight) {
                maxHeight = childBottom;
            }
        });
        this.contentHeight = maxHeight;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        this.maxScrollY = Math.max(0, this.contentHeight - viewportHeight);
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, this.scrollY));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    addChild(child) {
        child.parent = this;
        this.children.push(child);
        this.contentContainer.addChild(child.container);
        const contentWidth = this.props.width - this.props.padding.left - this.props.padding.right - this.props.scrollbarWidth;
        const contentHeight = 999999;
        child.layout(contentWidth, contentHeight);
        this.updateContentBounds();
    }
    removeChild(child) {
        child.parent = undefined;
        const index = this.children.indexOf(child);
        if (index !== -1) {
            this.children.splice(index, 1);
        }
        this.contentContainer.removeChild(child.container);
        this.updateContentBounds();
    }
    scrollTo(y) {
        this.scrollY = Math.max(0, Math.min(this.maxScrollY, y));
        this.updateContentPosition();
        this.updateScrollbar();
    }
    scrollToTop() {
        this.scrollTo(0);
    }
    scrollToBottom() {
        this.scrollTo(this.maxScrollY);
    }
    getScrollY() {
        return this.scrollY;
    }
    getMaxScrollY() {
        return this.maxScrollY;
    }
    scrollToComponent(component) {
        const componentBounds = component.getGlobalBounds();
        const containerBounds = this.getGlobalBounds();
        const relativeY = componentBounds.y - containerBounds.y - this.props.padding.top + this.scrollY;
        const viewportHeight = this.props.height - this.props.padding.top - this.props.padding.bottom;
        if (relativeY < this.scrollY) {
            this.scrollTo(relativeY);
        }
        else if (relativeY + componentBounds.height > this.scrollY + viewportHeight) {
            const targetScroll = relativeY + componentBounds.height - viewportHeight;
            this.scrollTo(targetScroll);
        }
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.updateContentBounds();
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    destroy() {
        if (typeof window !== 'undefined') {
            window.removeEventListener('pointermove', this.handleGlobalPointerMove.bind(this));
            window.removeEventListener('pointerup', this.handleGlobalPointerUp.bind(this));
        }
        super.destroy();
    }
}
exports.UIScrollContainer = UIScrollContainer;


/***/ }),

/***/ "./src/ui/components/ui-select.ts":
/*!****************************************!*\
  !*** ./src/ui/components/ui-select.ts ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UISelect = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
class UISelect extends ui_component_1.UIComponent {
    props;
    onChange;
    selectedValue;
    background;
    label;
    dropdownContainer;
    dropdownPanel;
    optionLabels = [];
    isOpen = false;
    hoverColor;
    selectedColor;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            options: props.options ?? [],
            placeholder: props.placeholder ?? 'Select...',
            width: props.width ?? 200,
            height: props.height ?? 36,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            borderRadius: props.borderRadius ?? 4
        };
        this.onChange = props.onChange;
        this.selectedValue = props.value ?? props.defaultValue;
        this.hoverColor = this.darkenColor(this.props.backgroundColor, 0.95);
        this.selectedColor = this.darkenColor(this.props.backgroundColor, 0.9);
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        const displayText = this.getDisplayText();
        this.label = new ui_label_1.UILabel({
            text: displayText,
            fontSize: 14,
            color: this.selectedValue ? this.props.textColor : 0x999999,
            align: 'left'
        }, {
            padding: edge_insets_1.EdgeInsets.symmetric(8, 12)
        });
        this.container.addChild(this.label.container);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (!this.selectedValue) {
            return this.props.placeholder;
        }
        const option = this.props.options.find(opt => opt.value === this.selectedValue);
        return option ? option.label : this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'pointer';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
    }
    handlePointerDown() {
        if (this.props.disabled)
            return;
        if (this.isOpen) {
            this.closeDropdown();
        }
        else {
            this.openDropdown();
        }
    }
    openDropdown() {
        this.isOpen = true;
        this.dropdownContainer = new pixi_js_1.default.Container();
        this.dropdownContainer.position.set(0, this.props.height + 4);
        const dropdownHeight = Math.min(this.props.options.length * 32, 200);
        this.dropdownPanel = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: dropdownHeight,
            borderRadius: this.props.borderRadius
        });
        this.dropdownContainer.addChild(this.dropdownPanel.container);
        this.optionLabels = [];
        this.props.options.forEach((option, index) => {
            const optionContainer = new pixi_js_1.default.Container();
            optionContainer.position.set(0, index * 32);
            const optionBg = new pixi_js_1.default.Graphics();
            optionBg.rect(0, 0, this.props.width, 32);
            optionBg.fill({ color: this.props.backgroundColor, alpha: 0 });
            optionContainer.addChild(optionBg);
            const optionLabel = new ui_label_1.UILabel({
                text: option.label,
                fontSize: 14,
                color: option.disabled ? 0x999999 : this.props.textColor,
                align: 'left'
            }, {
                padding: edge_insets_1.EdgeInsets.symmetric(8, 12)
            });
            optionLabel.layout(this.props.width, 32);
            optionContainer.addChild(optionLabel.container);
            if (!option.disabled) {
                optionContainer.eventMode = 'static';
                optionContainer.cursor = 'pointer';
                optionContainer.on('pointerover', () => {
                    optionBg.clear();
                    optionBg.rect(0, 0, this.props.width, 32);
                    optionBg.fill({ color: this.hoverColor });
                });
                optionContainer.on('pointerout', () => {
                    optionBg.clear();
                    optionBg.rect(0, 0, this.props.width, 32);
                    optionBg.fill({ color: this.props.backgroundColor, alpha: 0 });
                });
                optionContainer.on('pointerdown', () => {
                    this.selectOption(option.value);
                });
            }
            this.dropdownContainer.addChild(optionContainer);
            this.optionLabels.push(optionLabel);
        });
        this.container.addChild(this.dropdownContainer);
        this.setupClickOutside();
    }
    closeDropdown() {
        this.isOpen = false;
        if (this.dropdownContainer) {
            this.container.removeChild(this.dropdownContainer);
            this.dropdownContainer = undefined;
            this.dropdownPanel = undefined;
            this.optionLabels = [];
        }
        this.removeClickOutside();
    }
    selectOption(value) {
        this.selectedValue = value;
        this.label.setText(this.getDisplayText());
        this.label.setColor(this.props.textColor);
        this.onChange?.(value);
        this.closeDropdown();
    }
    setupClickOutside() {
        const stage = this.container.parent;
        if (stage) {
            stage.eventMode = 'static';
            stage.once('pointerdown', (e) => {
                const point = e.global;
                const bounds = this.container.getBounds();
                if (point.x < bounds.x || point.x > bounds.x + bounds.width ||
                    point.y < bounds.y || point.y > bounds.y + bounds.height) {
                    this.closeDropdown();
                }
            });
        }
    }
    removeClickOutside() {
    }
    darkenColor(color, factor) {
        const r = ((color >> 16) & 0xff) * factor;
        const g = ((color >> 8) & 0xff) * factor;
        const b = (color & 0xff) * factor;
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.label.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.selectedValue = value;
        this.label.setText(this.getDisplayText());
        this.label.setColor(this.props.textColor);
    }
    getValue() {
        return this.selectedValue;
    }
    setOptions(options) {
        this.props.options = options;
        if (this.isOpen) {
            this.closeDropdown();
        }
    }
}
exports.UISelect = UISelect;


/***/ }),

/***/ "./src/ui/components/ui-tabs.ts":
/*!**************************************!*\
  !*** ./src/ui/components/ui-tabs.ts ***!
  \**************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITabs = void 0;
const PIXI = __importStar(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_label_1 = __webpack_require__(/*! ./ui-label */ "./src/ui/components/ui-label.ts");
class UITabs extends ui_component_1.UIComponent {
    items;
    activeKey;
    onChange;
    type;
    tabPosition;
    width;
    height;
    tabBarBackgroundColor;
    tabBarHeight;
    activeTabColor;
    inactiveTabColor;
    textColor;
    activeTextColor;
    hashPrefix;
    tabBar;
    contentArea;
    tabButtons = new Map();
    activeIndicator;
    hashChangeHandler;
    constructor(props, boxModel) {
        super(boxModel);
        this.items = props.items || [];
        this.onChange = props.onChange;
        this.type = props.type || 'line';
        this.tabPosition = props.tabPosition || 'top';
        this.tabBarBackgroundColor = props.tabBarBackgroundColor ?? 0x2d2d44;
        this.tabBarHeight = props.tabBarHeight ?? 48;
        this.activeTabColor = props.activeTabColor ?? 0x1890ff;
        this.inactiveTabColor = props.inactiveTabColor ?? 0x3d3d54;
        this.textColor = props.textColor ?? 0xaaaaaa;
        this.activeTextColor = props.activeTextColor ?? 0xffffff;
        this.hashPrefix = props.hashPrefix;
        let initialKey = props.activeKey || props.defaultActiveKey || (this.items.length > 0 ? this.items[0].key : '');
        if (this.hashPrefix && !props.activeKey) {
            const hashKey = this.getKeyFromHash();
            if (hashKey && this.items.find(item => item.key === hashKey)) {
                initialKey = hashKey;
            }
        }
        this.activeKey = initialKey;
        this.width = props.width ?? 800;
        this.height = props.height ?? 600;
        this.tabBar = new PIXI.Container();
        this.contentArea = new PIXI.Container();
        this.container.addChild(this.tabBar);
        this.container.addChild(this.contentArea);
        this.buildTabs();
        this.showActiveTab();
        if (this.hashPrefix) {
            this.setupHashListener();
            this.updateHash(this.activeKey);
        }
    }
    getKeyFromHash() {
        if (!this.hashPrefix)
            return null;
        const hash = window.location.hash.slice(1);
        const prefix = `${this.hashPrefix}/`;
        if (hash.startsWith(prefix)) {
            return hash.slice(prefix.length);
        }
        return null;
    }
    updateHash(key) {
        if (!this.hashPrefix)
            return;
        const newHash = `#${this.hashPrefix}/${key}`;
        if (window.location.hash !== newHash) {
            window.location.hash = newHash;
        }
    }
    setupHashListener() {
        this.hashChangeHandler = () => {
            const hashKey = this.getKeyFromHash();
            if (hashKey && hashKey !== this.activeKey) {
                this.setActiveKey(hashKey, false);
            }
        };
        window.addEventListener('hashchange', this.hashChangeHandler);
    }
    destroy() {
        if (this.hashChangeHandler) {
            window.removeEventListener('hashchange', this.hashChangeHandler);
        }
    }
    buildTabs() {
        this.tabBar.removeChildren();
        this.tabButtons.clear();
        const tabBarBg = new PIXI.Graphics();
        tabBarBg.rect(0, 0, this.width, this.tabBarHeight);
        tabBarBg.fill({ color: this.tabBarBackgroundColor });
        this.tabBar.addChild(tabBarBg);
        if (this.type === 'line') {
            const borderLine = new PIXI.Graphics();
            borderLine.rect(0, this.tabBarHeight - 2, this.width, 2);
            borderLine.fill({ color: 0x3d3d54, alpha: 0.5 });
            this.tabBar.addChild(borderLine);
        }
        if (this.tabPosition === 'bottom') {
            this.tabBar.y = this.height - this.tabBarHeight;
            this.contentArea.y = 0;
        }
        else {
            this.tabBar.y = 0;
            this.contentArea.y = this.tabBarHeight;
        }
        let xOffset = 8;
        const tabPadding = 24;
        const tabGap = 8;
        for (const item of this.items) {
            if (item.disabled)
                continue;
            const tabContainer = new PIXI.Container();
            tabContainer.x = xOffset;
            const isActive = this.activeKey === item.key;
            const label = new ui_label_1.UILabel({
                text: item.label,
                fontSize: 15,
                fontWeight: isActive ? 'bold' : 'normal',
                color: isActive ? this.activeTextColor : this.textColor
            });
            label.measure();
            label.layout(this.width, this.tabBarHeight);
            const labelBounds = label.container.getLocalBounds();
            const tabWidth = labelBounds.width + (tabPadding * 2);
            let bg;
            if (this.type === 'card') {
                bg = new PIXI.Graphics();
                bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                bg.fill({ color: isActive ? this.activeTabColor : this.inactiveTabColor });
                bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                bg.stroke({ color: isActive ? this.activeTabColor : 0x4d4d64, width: 2 });
                tabContainer.addChild(bg);
            }
            else {
                bg = new PIXI.Graphics();
                bg.rect(0, 0, tabWidth, this.tabBarHeight);
                bg.fill({ color: 0x000000, alpha: 0 });
                tabContainer.addChild(bg);
            }
            label.container.x = tabPadding;
            label.container.y = (this.tabBarHeight - labelBounds.height) / 2;
            tabContainer.addChild(label.container);
            tabContainer.eventMode = 'static';
            tabContainer.cursor = 'pointer';
            const tabKey = item.key;
            tabContainer.on('pointerdown', () => {
                this.setActiveKey(tabKey);
            });
            tabContainer.on('pointerover', () => {
                if (this.activeKey !== tabKey) {
                    if (this.type === 'card') {
                        bg.clear();
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.fill({ color: this.activeTabColor, alpha: 0.5 });
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.stroke({ color: this.activeTabColor, width: 2 });
                    }
                    else {
                        label.setColor(this.activeTextColor);
                    }
                }
            });
            tabContainer.on('pointerout', () => {
                if (this.activeKey !== tabKey) {
                    if (this.type === 'card') {
                        bg.clear();
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.fill({ color: this.inactiveTabColor });
                        bg.roundRect(0, 0, tabWidth, this.tabBarHeight - 2, 6);
                        bg.stroke({ color: 0x4d4d64, width: 2 });
                    }
                    else {
                        label.setColor(this.textColor);
                    }
                }
            });
            this.tabBar.addChild(tabContainer);
            this.tabButtons.set(item.key, { container: tabContainer, label, bg });
            xOffset += tabWidth + tabGap;
        }
        if (this.type === 'line') {
            this.activeIndicator = new PIXI.Graphics();
            this.tabBar.addChild(this.activeIndicator);
            this.updateActiveIndicator();
        }
    }
    updateActiveIndicator() {
        if (!this.activeIndicator || this.type !== 'line')
            return;
        this.activeIndicator.clear();
        const activeTab = this.tabButtons.get(this.activeKey);
        if (!activeTab)
            return;
        const tabX = activeTab.container.x;
        const tabBounds = activeTab.bg.getLocalBounds();
        const tabWidth = tabBounds.width;
        const indicatorHeight = 3;
        const indicatorY = this.tabBarHeight - indicatorHeight;
        this.activeIndicator.roundRect(tabX + 8, indicatorY, tabWidth - 16, indicatorHeight, 1.5);
        this.activeIndicator.fill({ color: this.activeTabColor });
    }
    showActiveTab() {
        this.contentArea.removeChildren();
        const activeItem = this.items.find(item => item.key === this.activeKey);
        if (!activeItem)
            return;
        const contentHeight = this.height - this.tabBarHeight;
        activeItem.content.layout(this.width, contentHeight);
        this.contentArea.addChild(activeItem.content.container);
        this.tabButtons.forEach((tab, key) => {
            const isActive = key === this.activeKey;
            const tabBounds = tab.bg.getLocalBounds();
            if (this.type === 'card') {
                tab.bg.clear();
                tab.bg.roundRect(0, 0, tabBounds.width, this.tabBarHeight - 2, 6);
                tab.bg.fill({ color: isActive ? this.activeTabColor : this.inactiveTabColor });
                tab.bg.roundRect(0, 0, tabBounds.width, this.tabBarHeight - 2, 6);
                tab.bg.stroke({ color: isActive ? this.activeTabColor : 0x4d4d64, width: 2 });
            }
            else {
                tab.bg.clear();
                tab.bg.rect(0, 0, tabBounds.width, this.tabBarHeight);
                tab.bg.fill({ color: 0x000000, alpha: 0 });
            }
            tab.label.setColor(isActive ? this.activeTextColor : this.textColor);
            tab.label.container.alpha = 1;
        });
        if (this.type === 'line') {
            this.updateActiveIndicator();
        }
    }
    setActiveKey(key, updateHash = true) {
        if (this.activeKey === key)
            return;
        const item = this.items.find(item => item.key === key);
        if (!item || item.disabled)
            return;
        this.activeKey = key;
        this.showActiveTab();
        if (updateHash && this.hashPrefix) {
            this.updateHash(key);
        }
        if (this.onChange) {
            this.onChange(key);
        }
    }
    getActiveKey() {
        return this.activeKey;
    }
    setItems(items) {
        this.items = items;
        if (!this.items.find(item => item.key === this.activeKey)) {
            this.activeKey = this.items.length > 0 ? this.items[0].key : '';
        }
        this.buildTabs();
        this.showActiveTab();
    }
    measure() {
        return {
            width: this.width,
            height: this.height
        };
    }
    layout(width, height) {
        this.width = width;
        this.height = height;
        this.buildTabs();
        this.showActiveTab();
    }
    render() {
    }
}
exports.UITabs = UITabs;


/***/ }),

/***/ "./src/ui/components/ui-text-input.ts":
/*!********************************************!*\
  !*** ./src/ui/components/ui-text-input.ts ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITextInput = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
class UITextInput extends ui_component_1.UIComponent {
    props;
    onChange;
    currentValue;
    background;
    textDisplay;
    cursor;
    cursorPosition = 0;
    cursorBlinkInterval;
    cursorVisible = true;
    constructor(props, boxModel) {
        super(boxModel);
        this.props = {
            placeholder: props.placeholder ?? '',
            maxLength: props.maxLength ?? 100,
            width: props.width ?? 200,
            height: props.height ?? 36,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            placeholderColor: props.placeholderColor ?? 0x999999,
            borderRadius: props.borderRadius ?? 4,
            fontSize: props.fontSize ?? 14,
            type: props.type ?? 'text'
        };
        this.onChange = props.onChange;
        this.currentValue = props.value ?? props.defaultValue ?? '';
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        this.textDisplay = new pixi_js_1.default.Text({
            text: this.getDisplayText(),
            style: {
                fontFamily: 'Arial',
                fontSize: this.props.fontSize,
                fill: this.currentValue ? this.props.textColor : this.props.placeholderColor,
                align: 'left'
            },
            resolution: window.devicePixelRatio || 2
        });
        this.textDisplay.position.set(12, (this.props.height - this.props.fontSize) / 2);
        this.container.addChild(this.textDisplay);
        this.cursor = new pixi_js_1.default.Graphics();
        this.cursor.visible = false;
        this.container.addChild(this.cursor);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (this.currentValue) {
            return this.currentValue;
        }
        return this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'text';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        if (typeof window !== 'undefined') {
            window.addEventListener('keydown', this.handleKeyDown.bind(this));
        }
    }
    handlePointerDown(e) {
        if (this.props.disabled)
            return;
        const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
        if (focusManager) {
            focusManager.requestFocus(this);
        }
        else {
            this.onFocus();
        }
        e.stopPropagation();
    }
    onFocus() {
        if (this.focused)
            return;
        super.onFocus();
        this.cursorPosition = this.currentValue.length;
        this.cursor.visible = true;
        this.updateCursor();
        this.startCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.lightenColor(this.props.backgroundColor, 0.95),
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    onBlur() {
        if (!this.focused)
            return;
        super.onBlur();
        this.cursor.visible = false;
        this.stopCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    handleKeyDown(e) {
        if (!this.focused || this.props.disabled)
            return;
        e.preventDefault();
        e.stopPropagation();
        const key = e.key;
        if (key === 'Enter') {
            this.onBlur();
            return;
        }
        if (key === 'Escape') {
            this.onBlur();
            return;
        }
        if (key === 'Backspace') {
            if (this.cursorPosition > 0) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition - 1) +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition--;
                this.updateText();
            }
            return;
        }
        if (key === 'Delete') {
            if (this.cursorPosition < this.currentValue.length) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        this.currentValue.substring(this.cursorPosition + 1);
                this.updateText();
            }
            return;
        }
        if (key === 'ArrowLeft') {
            if (this.cursorPosition > 0) {
                this.cursorPosition--;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowRight') {
            if (this.cursorPosition < this.currentValue.length) {
                this.cursorPosition++;
                this.updateCursor();
            }
            return;
        }
        if (key === 'Home') {
            this.cursorPosition = 0;
            this.updateCursor();
            return;
        }
        if (key === 'End') {
            this.cursorPosition = this.currentValue.length;
            this.updateCursor();
            return;
        }
        if (key.length === 1 && !e.ctrlKey && !e.metaKey) {
            if (this.props.type === 'number' && !/[0-9.-]/.test(key)) {
                return;
            }
            if (this.currentValue.length >= this.props.maxLength) {
                return;
            }
            this.currentValue =
                this.currentValue.substring(0, this.cursorPosition) +
                    key +
                    this.currentValue.substring(this.cursorPosition);
            this.cursorPosition++;
            this.updateText();
        }
    }
    updateText() {
        this.textDisplay.text = this.getDisplayText();
        this.textDisplay.style.fill = this.currentValue ? this.props.textColor : this.props.placeholderColor;
        this.updateCursor();
        this.onChange?.(this.currentValue);
    }
    updateCursor() {
        const textUpToCursor = this.currentValue.substring(0, this.cursorPosition);
        const tempText = new pixi_js_1.default.Text({
            text: textUpToCursor,
            style: this.textDisplay.style
        });
        const cursorX = 12 + tempText.width;
        const cursorY = (this.props.height - this.props.fontSize) / 2;
        this.cursor.clear();
        this.cursor.rect(cursorX, cursorY, 1, this.props.fontSize);
        this.cursor.fill({ color: this.props.textColor });
        tempText.destroy();
    }
    startCursorBlink() {
        this.stopCursorBlink();
        this.cursorVisible = true;
        this.cursorBlinkInterval = window.setInterval(() => {
            this.cursorVisible = !this.cursorVisible;
            this.cursor.visible = this.cursorVisible;
        }, 530);
    }
    stopCursorBlink() {
        if (this.cursorBlinkInterval) {
            window.clearInterval(this.cursorBlinkInterval);
            this.cursorBlinkInterval = undefined;
        }
    }
    lightenColor(color, factor) {
        const r = Math.min(255, ((color >> 16) & 0xff) / factor);
        const g = Math.min(255, ((color >> 8) & 0xff) / factor);
        const b = Math.min(255, (color & 0xff) / factor);
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.currentValue = value;
        this.cursorPosition = value.length;
        this.updateText();
    }
    getValue() {
        return this.currentValue;
    }
    destroy() {
        this.stopCursorBlink();
        if (typeof window !== 'undefined') {
            window.removeEventListener('keydown', this.handleKeyDown.bind(this));
        }
        super.destroy();
    }
}
exports.UITextInput = UITextInput;


/***/ }),

/***/ "./src/ui/components/ui-textarea.ts":
/*!******************************************!*\
  !*** ./src/ui/components/ui-textarea.ts ***!
  \******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UITextArea = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const ui_panel_1 = __webpack_require__(/*! ./ui-panel */ "./src/ui/components/ui-panel.ts");
const ui_focus_manager_1 = __webpack_require__(/*! ../core/ui-focus-manager */ "./src/ui/core/ui-focus-manager.ts");
class UITextArea extends ui_component_1.UIComponent {
    props;
    onChange;
    currentValue;
    background;
    textDisplay;
    cursor;
    cursorPosition = 0;
    cursorBlinkInterval;
    cursorVisible = true;
    constructor(props, boxModel) {
        super(boxModel);
        const defaultHeight = (props.rows ?? 4) * (props.fontSize ?? 14) * (props.lineHeight ?? 1.5) + 24;
        this.props = {
            placeholder: props.placeholder ?? '',
            maxLength: props.maxLength ?? 1000,
            width: props.width ?? 400,
            height: props.height ?? defaultHeight,
            disabled: props.disabled ?? false,
            backgroundColor: props.backgroundColor ?? 0xffffff,
            textColor: props.textColor ?? 0x000000,
            placeholderColor: props.placeholderColor ?? 0x999999,
            borderRadius: props.borderRadius ?? 4,
            fontSize: props.fontSize ?? 14,
            lineHeight: props.lineHeight ?? 1.5,
            rows: props.rows ?? 4
        };
        this.onChange = props.onChange;
        this.currentValue = props.value ?? props.defaultValue ?? '';
        this.boxModel.width = this.props.width;
        this.boxModel.height = this.props.height;
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
        this.container.addChild(this.background.container);
        this.textDisplay = new pixi_js_1.default.Text({
            text: this.getDisplayText(),
            style: {
                fontFamily: 'Arial',
                fontSize: this.props.fontSize,
                fill: this.currentValue ? this.props.textColor : this.props.placeholderColor,
                align: 'left',
                wordWrap: true,
                wordWrapWidth: this.props.width - 24,
                lineHeight: this.props.fontSize * this.props.lineHeight
            },
            resolution: window.devicePixelRatio || 2
        });
        this.textDisplay.position.set(12, 12);
        this.container.addChild(this.textDisplay);
        this.cursor = new pixi_js_1.default.Graphics();
        this.cursor.visible = false;
        this.container.addChild(this.cursor);
        this.setupInteractivity();
    }
    getDisplayText() {
        if (this.currentValue) {
            return this.currentValue;
        }
        return this.props.placeholder;
    }
    setupInteractivity() {
        this.container.eventMode = 'static';
        this.container.cursor = 'text';
        this.container.on('pointerdown', this.handlePointerDown.bind(this));
        if (typeof window !== 'undefined') {
            window.addEventListener('keydown', this.handleKeyDown.bind(this));
        }
    }
    handlePointerDown(e) {
        if (this.props.disabled)
            return;
        const focusManager = ui_focus_manager_1.UIFocusManager.getInstance();
        if (focusManager) {
            focusManager.requestFocus(this);
        }
        else {
            this.onFocus();
        }
        e.stopPropagation();
    }
    onFocus() {
        if (this.focused)
            return;
        super.onFocus();
        this.cursorPosition = this.currentValue.length;
        this.cursor.visible = true;
        this.updateCursor();
        this.startCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.lightenColor(this.props.backgroundColor, 0.95),
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    onBlur() {
        if (!this.focused)
            return;
        super.onBlur();
        this.cursor.visible = false;
        this.stopCursorBlink();
        this.background = new ui_panel_1.UIPanel({
            backgroundColor: this.props.backgroundColor,
            width: this.props.width,
            height: this.props.height,
            borderRadius: this.props.borderRadius
        });
    }
    handleKeyDown(e) {
        if (!this.focused || this.props.disabled)
            return;
        if (e.key !== 'Tab') {
            e.preventDefault();
            e.stopPropagation();
        }
        const key = e.key;
        if (key === 'Enter') {
            if (this.currentValue.length < this.props.maxLength) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        '\n' +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition++;
                this.updateText();
            }
            return;
        }
        if (key === 'Escape') {
            this.onBlur();
            return;
        }
        if (key === 'Backspace') {
            if (this.cursorPosition > 0) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition - 1) +
                        this.currentValue.substring(this.cursorPosition);
                this.cursorPosition--;
                this.updateText();
            }
            return;
        }
        if (key === 'Delete') {
            if (this.cursorPosition < this.currentValue.length) {
                this.currentValue =
                    this.currentValue.substring(0, this.cursorPosition) +
                        this.currentValue.substring(this.cursorPosition + 1);
                this.updateText();
            }
            return;
        }
        if (key === 'ArrowLeft') {
            if (this.cursorPosition > 0) {
                this.cursorPosition--;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowRight') {
            if (this.cursorPosition < this.currentValue.length) {
                this.cursorPosition++;
                this.updateCursor();
            }
            return;
        }
        if (key === 'ArrowUp') {
            this.moveCursorVertically(-1);
            return;
        }
        if (key === 'ArrowDown') {
            this.moveCursorVertically(1);
            return;
        }
        if (key === 'Home') {
            const lineStart = this.currentValue.lastIndexOf('\n', this.cursorPosition - 1) + 1;
            this.cursorPosition = lineStart;
            this.updateCursor();
            return;
        }
        if (key === 'End') {
            let lineEnd = this.currentValue.indexOf('\n', this.cursorPosition);
            if (lineEnd === -1)
                lineEnd = this.currentValue.length;
            this.cursorPosition = lineEnd;
            this.updateCursor();
            return;
        }
        if (key.length === 1 && !e.ctrlKey && !e.metaKey) {
            if (this.currentValue.length >= this.props.maxLength) {
                return;
            }
            this.currentValue =
                this.currentValue.substring(0, this.cursorPosition) +
                    key +
                    this.currentValue.substring(this.cursorPosition);
            this.cursorPosition++;
            this.updateText();
        }
    }
    moveCursorVertically(direction) {
        const lines = this.currentValue.split('\n');
        let currentLine = 0;
        let positionInLine = 0;
        let charCount = 0;
        for (let i = 0; i < lines.length; i++) {
            if (charCount + lines[i].length >= this.cursorPosition) {
                currentLine = i;
                positionInLine = this.cursorPosition - charCount;
                break;
            }
            charCount += lines[i].length + 1;
        }
        const targetLine = Math.max(0, Math.min(lines.length - 1, currentLine + direction));
        if (targetLine === currentLine)
            return;
        let newPosition = 0;
        for (let i = 0; i < targetLine; i++) {
            newPosition += lines[i].length + 1;
        }
        newPosition += Math.min(positionInLine, lines[targetLine].length);
        this.cursorPosition = newPosition;
        this.updateCursor();
    }
    updateText() {
        this.textDisplay.text = this.getDisplayText();
        this.textDisplay.style.fill = this.currentValue ? this.props.textColor : this.props.placeholderColor;
        this.updateCursor();
        this.onChange?.(this.currentValue);
    }
    updateCursor() {
        const textUpToCursor = this.currentValue.substring(0, this.cursorPosition);
        const tempText = new pixi_js_1.default.Text({
            text: textUpToCursor,
            style: {
                ...this.textDisplay.style,
                wordWrap: true,
                wordWrapWidth: this.props.width - 24
            }
        });
        const metrics = tempText.getLocalBounds();
        const lines = textUpToCursor.split('\n');
        const lastLine = lines[lines.length - 1];
        const lastLineText = new pixi_js_1.default.Text({
            text: lastLine,
            style: this.textDisplay.style
        });
        const cursorX = 12 + lastLineText.width;
        const cursorY = 12 + (lines.length - 1) * (this.props.fontSize * this.props.lineHeight);
        this.cursor.clear();
        this.cursor.rect(cursorX, cursorY, 1, this.props.fontSize);
        this.cursor.fill({ color: this.props.textColor });
        tempText.destroy();
        lastLineText.destroy();
    }
    startCursorBlink() {
        this.stopCursorBlink();
        this.cursorVisible = true;
        this.cursorBlinkInterval = window.setInterval(() => {
            this.cursorVisible = !this.cursorVisible;
            this.cursor.visible = this.cursorVisible;
        }, 530);
    }
    stopCursorBlink() {
        if (this.cursorBlinkInterval) {
            window.clearInterval(this.cursorBlinkInterval);
            this.cursorBlinkInterval = undefined;
        }
    }
    lightenColor(color, factor) {
        const r = Math.min(255, ((color >> 16) & 0xff) / factor);
        const g = Math.min(255, ((color >> 8) & 0xff) / factor);
        const b = Math.min(255, (color & 0xff) / factor);
        return ((r << 16) | (g << 8) | b) >>> 0;
    }
    measure() {
        return {
            width: this.props.width,
            height: this.props.height
        };
    }
    layout(availableWidth, availableHeight) {
        const measured = this.measure();
        this.computedLayout.width = measured.width;
        this.computedLayout.height = measured.height;
        this.background.layout(measured.width, measured.height);
        this.layoutDirty = false;
        this.render();
    }
    render() {
    }
    setValue(value) {
        this.currentValue = value;
        this.cursorPosition = value.length;
        this.updateText();
    }
    getValue() {
        return this.currentValue;
    }
    destroy() {
        this.stopCursorBlink();
        if (typeof window !== 'undefined') {
            window.removeEventListener('keydown', this.handleKeyDown.bind(this));
        }
        super.destroy();
    }
}
exports.UITextArea = UITextArea;


/***/ }),

/***/ "./src/ui/core/box-model.ts":
/*!**********************************!*\
  !*** ./src/ui/core/box-model.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.createDefaultBoxModel = createDefaultBoxModel;
const edge_insets_1 = __webpack_require__(/*! ./edge-insets */ "./src/ui/core/edge-insets.ts");
function createDefaultBoxModel(overrides) {
    return {
        width: 'auto',
        height: 'auto',
        padding: edge_insets_1.EdgeInsets.zero(),
        margin: edge_insets_1.EdgeInsets.zero(),
        ...overrides
    };
}


/***/ }),

/***/ "./src/ui/core/edge-insets.ts":
/*!************************************!*\
  !*** ./src/ui/core/edge-insets.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.EdgeInsets = void 0;
class EdgeInsets {
    top;
    right;
    bottom;
    left;
    constructor(top, right, bottom, left) {
        this.top = top;
        this.right = right;
        this.bottom = bottom;
        this.left = left;
    }
    static all(value) {
        return new EdgeInsets(value, value, value, value);
    }
    static symmetric(vertical, horizontal) {
        return new EdgeInsets(vertical, horizontal, vertical, horizontal);
    }
    static only(edges) {
        return new EdgeInsets(edges.top ?? 0, edges.right ?? 0, edges.bottom ?? 0, edges.left ?? 0);
    }
    static zero() {
        return new EdgeInsets(0, 0, 0, 0);
    }
    get horizontal() {
        return this.left + this.right;
    }
    get vertical() {
        return this.top + this.bottom;
    }
    clone() {
        return new EdgeInsets(this.top, this.right, this.bottom, this.left);
    }
}
exports.EdgeInsets = EdgeInsets;


/***/ }),

/***/ "./src/ui/core/ui-component.ts":
/*!*************************************!*\
  !*** ./src/ui/core/ui-component.ts ***!
  \*************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIComponent = void 0;
const pixi_js_1 = __importDefault(__webpack_require__(/*! pixi.js */ "pixi.js"));
const box_model_1 = __webpack_require__(/*! ./box-model */ "./src/ui/core/box-model.ts");
class UIComponent {
    container;
    boxModel;
    focusRing;
    computedLayout;
    parent;
    visible = true;
    enabled = true;
    layoutDirty = true;
    tabIndex = -1;
    focused = false;
    constructor(boxModel) {
        this.container = new pixi_js_1.default.Container();
        this.boxModel = (0, box_model_1.createDefaultBoxModel)(boxModel);
        this.computedLayout = {
            x: 0,
            y: 0,
            width: 0,
            height: 0,
            contentX: 0,
            contentY: 0,
            contentWidth: 0,
            contentHeight: 0
        };
        this.createFocusRing();
    }
    createFocusRing() {
        this.focusRing = new pixi_js_1.default.Graphics();
        this.focusRing.visible = false;
        this.container.addChildAt(this.focusRing, 0);
    }
    updateFocusRing() {
        if (!this.focusRing)
            return;
        this.focusRing.clear();
        const width = this.computedLayout.width;
        const height = this.computedLayout.height;
        if (width <= 0 || height <= 0)
            return;
        const offset = 4;
        const strokeWidth = 3;
        this.focusRing.roundRect(-offset - 2, -offset - 2, width + (offset + 2) * 2, height + (offset + 2) * 2, 8);
        this.focusRing.stroke({
            color: 0x00d9ff,
            width: strokeWidth + 2,
            alpha: 0.3
        });
        this.focusRing.roundRect(-offset, -offset, width + offset * 2, height + offset * 2, 8);
        this.focusRing.stroke({
            color: 0x00d9ff,
            width: strokeWidth
        });
        this.focusRing.roundRect(-offset + strokeWidth, -offset + strokeWidth, width + (offset - strokeWidth) * 2, height + (offset - strokeWidth) * 2, 6);
        this.focusRing.stroke({
            color: 0xffffff,
            width: 1,
            alpha: 0.6
        });
    }
    markLayoutDirty() {
        this.layoutDirty = true;
        if (this.parent) {
            this.parent.markLayoutDirty();
        }
    }
    getLayout() {
        return this.computedLayout;
    }
    getBoxModel() {
        return this.boxModel;
    }
    getGlobalBounds() {
        const globalPos = this.container.getGlobalPosition();
        return {
            x: globalPos.x,
            y: globalPos.y,
            width: this.computedLayout.width,
            height: this.computedLayout.height
        };
    }
    setPosition(x, y) {
        this.computedLayout.x = x;
        this.computedLayout.y = y;
        this.container.position.set(x, y);
    }
    show() {
        this.visible = true;
        this.container.visible = true;
    }
    hide() {
        this.visible = false;
        this.container.visible = false;
    }
    canFocus() {
        return this.enabled && this.visible && this.tabIndex >= 0;
    }
    isFocused() {
        return this.focused;
    }
    onFocus() {
        this.focused = true;
        this.showFocusRing();
        this.scrollIntoView();
    }
    showFocusRing() {
        if (this.focusRing) {
            this.updateFocusRing();
            this.focusRing.visible = true;
        }
    }
    scrollIntoView() {
        let currentParent = this.parent;
        while (currentParent) {
            if ('scrollToComponent' in currentParent && typeof currentParent.scrollToComponent === 'function') {
                currentParent.scrollToComponent(this);
                break;
            }
            currentParent = currentParent.parent;
        }
    }
    onBlur() {
        this.focused = false;
        this.hideFocusRing();
    }
    hideFocusRing() {
        if (this.focusRing) {
            this.focusRing.visible = false;
        }
    }
    destroy() {
        this.container.destroy({ children: true });
    }
}
exports.UIComponent = UIComponent;


/***/ }),

/***/ "./src/ui/core/ui-focus-manager.ts":
/*!*****************************************!*\
  !*** ./src/ui/core/ui-focus-manager.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.UIFocusManager = void 0;
class UIFocusManager {
    static instance = null;
    focusableComponents = [];
    currentFocusIndex = -1;
    keydownHandler = null;
    constructor() {
        this.setupKeyboardListeners();
        UIFocusManager.instance = this;
    }
    static getInstance() {
        return UIFocusManager.instance;
    }
    setupKeyboardListeners() {
        if (typeof window === 'undefined')
            return;
        this.keydownHandler = (e) => {
            if (e.key === 'Tab') {
                e.preventDefault();
                if (e.shiftKey) {
                    this.focusPrevious();
                }
                else {
                    this.focusNext();
                }
            }
        };
        window.addEventListener('keydown', this.keydownHandler);
    }
    register(component) {
        if (!this.focusableComponents.includes(component)) {
            this.focusableComponents.push(component);
            this.sortByTabIndex();
        }
    }
    registerContainer(container) {
        this.discoverFocusableComponents(container);
        this.sortByTabIndex();
    }
    discoverFocusableComponents(component) {
        console.log('ð Discovering in component:', component.constructor.name, 'tabIndex:', component.tabIndex);
        if (this.isFocusableComponent(component)) {
            console.log('  â Registering focusable:', component.constructor.name);
            this.register(component);
        }
        if ('children' in component && Array.isArray(component.children)) {
            const children = component.children;
            console.log(`  ð¦ Has ${children.length} children`);
            children.forEach(child => this.discoverFocusableComponents(child));
        }
    }
    isFocusableComponent(component) {
        return (typeof component.tabIndex === 'number' &&
            component.tabIndex >= 0 &&
            typeof component.canFocus === 'function' &&
            typeof component.onFocus === 'function' &&
            typeof component.onBlur === 'function' &&
            typeof component.isFocused === 'function');
    }
    unregister(component) {
        const index = this.focusableComponents.indexOf(component);
        if (index !== -1) {
            if (index === this.currentFocusIndex) {
                this.blur();
            }
            this.focusableComponents.splice(index, 1);
            if (this.currentFocusIndex > index) {
                this.currentFocusIndex--;
            }
        }
    }
    sortByTabIndex() {
        this.focusableComponents.sort((a, b) => a.tabIndex - b.tabIndex);
    }
    focus(component) {
        if (!component.canFocus()) {
            console.log('â Component cannot focus');
            return;
        }
        const index = this.focusableComponents.indexOf(component);
        if (index === -1) {
            console.log('â Component not registered in focus manager');
            return;
        }
        console.log(`ð¯ Focusing component at index ${index}, current index: ${this.currentFocusIndex}`);
        if (this.currentFocusIndex !== -1 && this.currentFocusIndex !== index) {
            const current = this.focusableComponents[this.currentFocusIndex];
            if (current) {
                console.log(`  ð Blurring component at index ${this.currentFocusIndex}`);
                current.onBlur();
            }
        }
        this.currentFocusIndex = index;
        console.log(`  â Calling onFocus() on component`);
        component.onFocus();
    }
    requestFocus(component) {
        this.focus(component);
    }
    blur() {
        if (this.currentFocusIndex !== -1) {
            const current = this.focusableComponents[this.currentFocusIndex];
            if (current) {
                current.onBlur();
            }
            this.currentFocusIndex = -1;
        }
    }
    focusNext() {
        if (this.focusableComponents.length === 0)
            return;
        let nextIndex = this.currentFocusIndex + 1;
        let attempts = 0;
        while (attempts < this.focusableComponents.length) {
            if (nextIndex >= this.focusableComponents.length) {
                nextIndex = 0;
            }
            const component = this.focusableComponents[nextIndex];
            if (component && component.canFocus()) {
                this.focus(component);
                return;
            }
            nextIndex++;
            attempts++;
        }
    }
    focusPrevious() {
        if (this.focusableComponents.length === 0)
            return;
        let prevIndex = this.currentFocusIndex - 1;
        let attempts = 0;
        while (attempts < this.focusableComponents.length) {
            if (prevIndex < 0) {
                prevIndex = this.focusableComponents.length - 1;
            }
            const component = this.focusableComponents[prevIndex];
            if (component && component.canFocus()) {
                this.focus(component);
                return;
            }
            prevIndex--;
            attempts++;
        }
    }
    focusFirst() {
        if (this.focusableComponents.length === 0)
            return;
        for (const component of this.focusableComponents) {
            if (component.canFocus()) {
                this.focus(component);
                return;
            }
        }
    }
    focusLast() {
        if (this.focusableComponents.length === 0)
            return;
        for (let i = this.focusableComponents.length - 1; i >= 0; i--) {
            const component = this.focusableComponents[i];
            if (component.canFocus()) {
                this.focus(component);
                return;
            }
        }
    }
    getCurrentFocus() {
        if (this.currentFocusIndex === -1)
            return null;
        return this.focusableComponents[this.currentFocusIndex] || null;
    }
    getFocusableComponents() {
        return [...this.focusableComponents];
    }
    clear() {
        this.blur();
        this.focusableComponents = [];
        this.currentFocusIndex = -1;
    }
    destroy() {
        if (typeof window !== 'undefined' && this.keydownHandler) {
            window.removeEventListener('keydown', this.keydownHandler);
        }
        this.clear();
    }
}
exports.UIFocusManager = UIFocusManager;


/***/ }),

/***/ "./src/ui/layout/flex-container.ts":
/*!*****************************************!*\
  !*** ./src/ui/layout/flex-container.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.FlexContainer = exports.FlexAlign = exports.FlexJustify = exports.FlexDirection = void 0;
const ui_component_1 = __webpack_require__(/*! ../core/ui-component */ "./src/ui/core/ui-component.ts");
const edge_insets_1 = __webpack_require__(/*! ../core/edge-insets */ "./src/ui/core/edge-insets.ts");
var FlexDirection;
(function (FlexDirection) {
    FlexDirection["Row"] = "row";
    FlexDirection["RowReverse"] = "row-reverse";
    FlexDirection["Column"] = "column";
    FlexDirection["ColumnReverse"] = "column-reverse";
})(FlexDirection || (exports.FlexDirection = FlexDirection = {}));
var FlexJustify;
(function (FlexJustify) {
    FlexJustify["Start"] = "start";
    FlexJustify["End"] = "end";
    FlexJustify["Center"] = "center";
    FlexJustify["SpaceBetween"] = "space-between";
    FlexJustify["SpaceAround"] = "space-around";
    FlexJustify["SpaceEvenly"] = "space-evenly";
})(FlexJustify || (exports.FlexJustify = FlexJustify = {}));
var FlexAlign;
(function (FlexAlign) {
    FlexAlign["Start"] = "start";
    FlexAlign["End"] = "end";
    FlexAlign["Center"] = "center";
    FlexAlign["Stretch"] = "stretch";
})(FlexAlign || (exports.FlexAlign = FlexAlign = {}));
class FlexContainer extends ui_component_1.UIComponent {
    props;
    children = [];
    constructor(props = {}) {
        const boxModel = {
            padding: props.padding ?? edge_insets_1.EdgeInsets.zero(),
            width: props.width ?? 'auto',
            height: props.height ?? 'auto'
        };
        super(boxModel);
        this.props = {
            direction: props.direction ?? FlexDirection.Row,
            justify: props.justify ?? FlexJustify.Start,
            align: props.align ?? FlexAlign.Start,
            gap: props.gap ?? 0,
            wrap: props.wrap ?? false
        };
    }
    addChild(child) {
        child.parent = this;
        this.children.push(child);
        this.container.addChild(child.container);
        this.markLayoutDirty();
    }
    removeChild(child) {
        const index = this.children.indexOf(child);
        if (index !== -1) {
            this.children.splice(index, 1);
            this.container.removeChild(child.container);
            child.parent = undefined;
            this.markLayoutDirty();
        }
    }
    measure() {
        if (this.children.length === 0) {
            const padding = this.boxModel.padding;
            return {
                width: padding.horizontal,
                height: padding.vertical
            };
        }
        const childSizes = this.children.map(child => child.measure());
        const { direction, gap } = this.props;
        const padding = this.boxModel.padding;
        const isRow = direction === FlexDirection.Row || direction === FlexDirection.RowReverse;
        const totalGap = gap * (this.children.length - 1);
        let measuredWidth = 0;
        let measuredHeight = 0;
        if (isRow) {
            measuredWidth = childSizes.reduce((sum, size) => sum + size.width, 0) + totalGap;
            measuredHeight = Math.max(...childSizes.map(size => size.height));
        }
        else {
            measuredWidth = Math.max(...childSizes.map(size => size.width));
            measuredHeight = childSizes.reduce((sum, size) => sum + size.height, 0) + totalGap;
        }
        return {
            width: measuredWidth + padding.horizontal,
            height: measuredHeight + padding.vertical
        };
    }
    layout(availableWidth, availableHeight) {
        const padding = this.boxModel.padding;
        const { direction, justify, align, gap } = this.props;
        let containerWidth;
        let containerHeight;
        if (this.boxModel.width === 'fill') {
            containerWidth = availableWidth;
        }
        else if (typeof this.boxModel.width === 'number') {
            containerWidth = this.boxModel.width;
        }
        else {
            const measured = this.measure();
            containerWidth = measured.width;
        }
        if (this.boxModel.height === 'fill') {
            containerHeight = availableHeight;
        }
        else if (typeof this.boxModel.height === 'number') {
            containerHeight = this.boxModel.height;
        }
        else {
            const measured = this.measure();
            containerHeight = measured.height;
        }
        this.computedLayout.width = containerWidth;
        this.computedLayout.height = containerHeight;
        this.computedLayout.contentX = padding.left;
        this.computedLayout.contentY = padding.top;
        this.computedLayout.contentWidth = containerWidth - padding.horizontal;
        this.computedLayout.contentHeight = containerHeight - padding.vertical;
        if (this.children.length > 0) {
            this.layoutChildren();
        }
        this.layoutDirty = false;
        this.render();
    }
    layoutChildren() {
        const { direction, justify, align, gap } = this.props;
        const padding = this.boxModel.padding;
        const contentWidth = this.computedLayout.contentWidth;
        const contentHeight = this.computedLayout.contentHeight;
        const isRow = direction === FlexDirection.Row || direction === FlexDirection.RowReverse;
        const childSizes = this.children.map(child => child.measure());
        const totalGap = gap * (this.children.length - 1);
        const totalChildSize = isRow
            ? childSizes.reduce((sum, size) => sum + size.width, 0)
            : childSizes.reduce((sum, size) => sum + size.height, 0);
        const mainAxisSize = isRow ? contentWidth : contentHeight;
        const crossAxisSize = isRow ? contentHeight : contentWidth;
        const freeSpace = mainAxisSize - totalChildSize - totalGap;
        let mainAxisOffset = 0;
        let spaceBetween = 0;
        switch (justify) {
            case FlexJustify.Start:
                mainAxisOffset = 0;
                break;
            case FlexJustify.End:
                mainAxisOffset = freeSpace;
                break;
            case FlexJustify.Center:
                mainAxisOffset = freeSpace / 2;
                break;
            case FlexJustify.SpaceBetween:
                spaceBetween = this.children.length > 1 ? freeSpace / (this.children.length - 1) : 0;
                break;
            case FlexJustify.SpaceAround:
                spaceBetween = freeSpace / this.children.length;
                mainAxisOffset = spaceBetween / 2;
                break;
            case FlexJustify.SpaceEvenly:
                spaceBetween = freeSpace / (this.children.length + 1);
                mainAxisOffset = spaceBetween;
                break;
        }
        let currentPosition = mainAxisOffset;
        this.children.forEach((child, index) => {
            const childSize = childSizes[index];
            child.layout(childSize.width, childSize.height);
            let crossAxisPosition = 0;
            switch (align) {
                case FlexAlign.Start:
                    crossAxisPosition = 0;
                    break;
                case FlexAlign.End:
                    crossAxisPosition = crossAxisSize - (isRow ? childSize.height : childSize.width);
                    break;
                case FlexAlign.Center:
                    crossAxisPosition = (crossAxisSize - (isRow ? childSize.height : childSize.width)) / 2;
                    break;
                case FlexAlign.Stretch:
                    crossAxisPosition = 0;
                    break;
            }
            if (isRow) {
                child.setPosition(padding.left + currentPosition, padding.top + crossAxisPosition);
                currentPosition += childSize.width + gap + spaceBetween;
            }
            else {
                child.setPosition(padding.left + crossAxisPosition, padding.top + currentPosition);
                currentPosition += childSize.height + gap + spaceBetween;
            }
        });
    }
    render() {
    }
}
exports.FlexContainer = FlexContainer;


/***/ }),

/***/ "./src/ui/pixel-grid.ts":
/*!******************************!*\
  !*** ./src/ui/pixel-grid.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.BORDER = exports.GRID = exports.units = exports.px = exports.DEFAULT_PIXEL_GRID = exports.PixelGrid = void 0;
exports.createBorderConfig = createBorderConfig;
class PixelGrid {
    unit;
    scale;
    border;
    padding;
    gap;
    fontScale;
    constructor(config = {}) {
        this.unit = config.unit ?? 1;
        this.scale = config.scale ?? 4;
        this.border = config.border ?? 1;
        this.padding = config.padding ?? 1;
        this.gap = config.gap ?? 1;
        this.fontScale = config.fontScale ?? 0.25;
    }
    px(units) {
        return units * this.unit * this.scale;
    }
    units(pixels) {
        return Math.round(pixels / (this.unit * this.scale));
    }
}
exports.PixelGrid = PixelGrid;
exports.DEFAULT_PIXEL_GRID = new PixelGrid();
const px = (units) => exports.DEFAULT_PIXEL_GRID.px(units);
exports.px = px;
const units = (pixels) => exports.DEFAULT_PIXEL_GRID.units(pixels);
exports.units = units;
exports.GRID = {
    unit: exports.DEFAULT_PIXEL_GRID.unit,
    scale: exports.DEFAULT_PIXEL_GRID.scale,
    border: exports.DEFAULT_PIXEL_GRID.border,
    padding: exports.DEFAULT_PIXEL_GRID.padding,
    gap: exports.DEFAULT_PIXEL_GRID.gap,
    fontScale: exports.DEFAULT_PIXEL_GRID.fontScale
};
exports.BORDER = {
    outer: 1,
    middle: 1,
    inner: 1,
    total: 3
};
function createBorderConfig(config = {}) {
    const outer = config.outer ?? 1;
    const middle = config.middle ?? 1;
    const inner = config.inner ?? 1;
    const total = outer + middle + inner;
    return {
        outer,
        middle,
        inner,
        total
    };
}


/***/ }),

/***/ "pixi.js":
/*!*******************************************************************************************!*\
  !*** external {"commonjs":"pixi.js","commonjs2":"pixi.js","amd":"pixi.js","root":"PIXI"} ***!
  \*******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_pixi_js__;

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.ts");
/******/ 	
/******/ 	return __webpack_exports__;
/******/ })()
;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixXQUFXO0FBQ3JDO0FBQ0EsZ0NBQWdDLFdBQVc7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsOEJBQThCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixlQUFlO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Ysa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnQkFBZ0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsR0FBRztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsUUFBUTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLEdBQUc7QUFDNUMsMEJBQTBCLG9CQUFvQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxHQUFHO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLDJDQUEyQyxHQUFHO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLEdBQUc7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsR0FBRztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxHQUFHO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLElBQUk7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGVBQWU7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixlQUFlO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLDBEQUEwRDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyx3REFBd0Q7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNkJBQTZCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNkJBQTZCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLElBQUk7QUFDNUM7QUFDQTtBQUNBLDRDQUE0QyxLQUFLO0FBQ2pEO0FBQ0E7QUFDQSx3Q0FBd0MsR0FBRztBQUMzQztBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsTUFBTTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxJQUFJO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxJQUFJO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNEJBQTRCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw0QkFBNEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNEJBQTRCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkJBQTZCO0FBQ3JELDBCQUEwQiwwQkFBMEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw0QkFBNEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkJBQTZCO0FBQ3JEO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBCQUEwQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDBCQUEwQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsSUFBSTtBQUM5QztBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsbUJBQW1CO0FBQzdDO0FBQ0E7QUFDQSxnREFBZ0QsSUFBSTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxJQUFJO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDRCQUE0QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0NBQWdDO0FBQ3hEO0FBQ0EsMEJBQTBCLDRCQUE0QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDRCQUE0QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0NBQWdDO0FBQ3hELDBCQUEwQiw0QkFBNEI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsOEJBQThCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxzREFBc0Q7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsa0VBQWtFO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsa0RBQWtEO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIscUJBQXFCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixxQkFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esb0JBQW9CLDBCQUEwQjtBQUM5QztBQUNBO0FBQ0Esc0JBQXNCLDBCQUEwQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsMEJBQTBCO0FBQzlDO0FBQ0E7QUFDQSxzQkFBc0IsMEJBQTBCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxpQkFBaUI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxnQkFBZ0I7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3Q0FBd0M7QUFDaEU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixnQ0FBZ0M7QUFDMUQ7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDRCQUE0QjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHVCQUF1QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxJQUFJO0FBQzlDO0FBQ0E7QUFDQSwwQ0FBMEMsR0FBRztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxRQUFRO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFFBQVE7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxJQUFJO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsTUFBTTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLElBQUk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsR0FBRztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQixVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsTUFBTTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsSUFBSTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNCQUFzQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBCQUEwQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixxQkFBcUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBLHdCQUF3QiwyQkFBMkI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixRQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsT0FBTztBQUMvQjtBQUNBO0FBQ0Esd0JBQXdCLE9BQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGtCQUFrQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsa0JBQWtCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixXQUFXO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsb0NBQW9DO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLG9DQUFvQztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLGdDQUFnQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msb0JBQW9CO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsWUFBWTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDBCQUEwQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLGdDQUFnQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnQ0FBZ0M7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUNBQXlDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzQkFBc0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHFCQUFxQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IscUJBQXFCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixxQkFBcUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isd0NBQXdDO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlCQUFpQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlCQUF5QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMEJBQTBCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyx3QkFBd0IsaUJBQWlCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRXBELElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDO1lBQ25CLEtBQUssRUFBRSxDQUFDO1lBQ1IsS0FBSyxFQUFFLFFBQVE7WUFDZixLQUFLLEVBQUUsR0FBRztTQUNYLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pELElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdDLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUM7UUFHdkIsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDL0UsTUFBTSxTQUFTLEdBQUcsQ0FBQyxDQUFDO1FBQ3BCLE1BQU0sTUFBTSxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLEdBQUcsQ0FBQztRQUNyQyxNQUFNLE1BQU0sR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUM7UUFFckMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0MsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQ2xCLFFBQVEsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxTQUFTLEVBQ3pDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxTQUFTLENBQzFDLENBQUM7UUFDRixJQUFJLENBQUMsUUFBUSxDQUFD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QztBQUNKLENBQUM7Ozs7Ozs7Ozs7OztBQ2hLRCxxRDs7Ozs7O1VDQUE7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTs7VUFFQTtVQUNBOztVQUVBO1VBQ0E7VUFDQTs7OztVRXRCQTtVQUNBO1VBQ0E7VUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL21veGkvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL21veGkvLi4vLi4vbm9kZV9tb2R1bGVzL2ZvbnRmYWNlb2JzZXJ2ZXIvZm9udGZhY2VvYnNlcnZlci5zdGFuZGFsb25lLmpzIiwid2VicGFjazovL21veGkvLi4vLi4vbm9kZV9tb2R1bGVzL3BsYW5jay9kaXN0L3BsYW5jay5qcyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvYXNzZXQtbG9hZGVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9jYW1lcmEudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9jb3JlL2VuZ2luZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvZXZlbnQtc3lzdGVtLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9sb2dpYy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2NvcmUvbW94aS1lbnRpdHkudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9jb3JlL3JlbmRlci1tYW5hZ2VyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvY29yZS9zY2VuZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9hcy1waXhpLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9jbGllbnQtZXZlbnRzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9mb250LWxvYWRlci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvZ3JpZC1nZW5lcmF0b3IudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L2xvYWRpbmctc2NlbmUudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BhcmFsbGF4LWJhY2tncm91bmQudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BhcmFsbGF4LWxheWVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL2luZGV4LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3MtYm9keS1sb2dpYy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGh5c2ljcy9waHlzaWNzLWNvbGxpc2lvbi50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcGh5c2ljcy9waHlzaWNzLWRlYnVnLXJlbmRlcmVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3MtZ3JhcGhpY3MtcGFyc2VyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3MtbWF0ZXJpYWxzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9waHlzaWNzL3BoeXNpY3MtdXRpbHMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3BoeXNpY3MvcGh5c2ljcy13b3JsZC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvcmVzaXplLWhhbmRsZXIudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3NldHVwLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS9zdGF0ZS1sb2dpYy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvc3RhdGUtbWFjaGluZS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvc3ZnLXV0aWxzL3N2Zy10by10ZXh0dXJlLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvbGlicmFyeS90ZXh0dXJlLWZyYW1lLXNlcXVlbmNlcy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL2xpYnJhcnkvdGV4dHVyZS1mcmFtZXMudHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy9saWJyYXJ5L3V0aWxzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvVUlMYXllci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL1VJU2NhbGVNb2RlLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy9idXR0b24tYmFja2dyb3VuZC1zdHJhdGVneS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktYm94LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS1idXR0b24udHMiLCJ3ZWJwYWNrOi8vbW94aS8uL3NyYy91aS9jb21wb25lbnRzL3VpLWxhYmVsLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS1wYW5lbC50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktc2Nyb2xsLWNvbnRhaW5lci50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvbXBvbmVudHMvdWktc2VsZWN0LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS10YWJzLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS10ZXh0LWlucHV0LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29tcG9uZW50cy91aS10ZXh0YXJlYS50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvcmUvYm94LW1vZGVsLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29yZS9lZGdlLWluc2V0cy50cyIsIndlYnBhY2s6Ly9tb3hpLy4vc3JjL3VpL2NvcmUvdWktY29tcG9uZW50LnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvY29yZS91aS1mb2N1cy1tYW5hZ2VyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvbGF5b3V0L2ZsZXgtY29udGFpbmVyLnRzIiwid2VicGFjazovL21veGkvLi9zcmMvdWkvcGl4ZWwtZ3JpZC50cyIsIndlYnBhY2s6Ly9tb3hpL2V4dGVybmFsIHVtZCB7XCJjb21tb25qc1wiOlwicGl4aS5qc1wiLFwiY29tbW9uanMyXCI6XCJwaXhpLmpzXCIsXCJhbWRcIjpcInBpeGkuanNcIixcInJvb3RcIjpcIlBJWElcIn0iLCJ3ZWJwYWNrOi8vbW94aS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9tb3hpL3dlYnBhY2svYmVmb3JlLXN0YXJ0dXAiLCJ3ZWJwYWNrOi8vbW94aS93ZWJwYWNrL3N0YXJ0dXAiLCJ3ZWJwYWNrOi8vbW94aS93ZWJwYWNrL2FmdGVyLXN0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwicGl4aS5qc1wiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXCJwaXhpLmpzXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcIm1veGlcIl0gPSBmYWN0b3J5KHJlcXVpcmUoXCJwaXhpLmpzXCIpKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJtb3hpXCJdID0gZmFjdG9yeShyb290W1wiUElYSVwiXSk7XG59KShzZWxmLCAoX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9waXhpX2pzX18pID0+IHtcbnJldHVybiAiLCIvKiBGb250IEZhY2UgT2JzZXJ2ZXIgdjIuMy4wIC0gwqkgQnJhbSBTdGVpbi4gTGljZW5zZTogQlNELTMtQ2xhdXNlICovKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcChhLGMpe2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXI/YS5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsYywhMSk6YS5hdHRhY2hFdmVudChcInNjcm9sbFwiLGMpfWZ1bmN0aW9uIHUoYSl7ZG9jdW1lbnQuYm9keT9hKCk6ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcj9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGZ1bmN0aW9uIGIoKXtkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGIpO2EoKX0pOmRvY3VtZW50LmF0dGFjaEV2ZW50KFwib25yZWFkeXN0YXRlY2hhbmdlXCIsZnVuY3Rpb24gZygpe2lmKFwiaW50ZXJhY3RpdmVcIj09ZG9jdW1lbnQucmVhZHlTdGF0ZXx8XCJjb21wbGV0ZVwiPT1kb2N1bWVudC5yZWFkeVN0YXRlKWRvY3VtZW50LmRldGFjaEV2ZW50KFwib25yZWFkeXN0YXRlY2hhbmdlXCIsZyksYSgpfSl9O2Z1bmN0aW9uIHcoYSl7dGhpcy5nPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dGhpcy5nLnNldEF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIsXCJ0cnVlXCIpO3RoaXMuZy5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShhKSk7dGhpcy5oPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO3RoaXMuaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTt0aGlzLm09ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7dGhpcy5qPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO3RoaXMubD0tMTt0aGlzLmguc3R5bGUuY3NzVGV4dD1cIm1heC13aWR0aDpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7b3ZlcmZsb3c6c2Nyb2xsO2ZvbnQtc2l6ZToxNnB4O1wiO3RoaXMuaS5zdHlsZS5jc3NUZXh0PVwibWF4LXdpZHRoOm5vbmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7cG9zaXRpb246YWJzb2x1dGU7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTtvdmVyZmxvdzpzY3JvbGw7Zm9udC1zaXplOjE2cHg7XCI7XG50aGlzLmouc3R5bGUuY3NzVGV4dD1cIm1heC13aWR0aDpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7b3ZlcmZsb3c6c2Nyb2xsO2ZvbnQtc2l6ZToxNnB4O1wiO3RoaXMubS5zdHlsZS5jc3NUZXh0PVwiZGlzcGxheTppbmxpbmUtYmxvY2s7d2lkdGg6MjAwJTtoZWlnaHQ6MjAwJTtmb250LXNpemU6MTZweDttYXgtd2lkdGg6bm9uZTtcIjt0aGlzLmguYXBwZW5kQ2hpbGQodGhpcy5tKTt0aGlzLmkuYXBwZW5kQ2hpbGQodGhpcy5qKTt0aGlzLmcuYXBwZW5kQ2hpbGQodGhpcy5oKTt0aGlzLmcuYXBwZW5kQ2hpbGQodGhpcy5pKX1cbmZ1bmN0aW9uIHgoYSxjKXthLmcuc3R5bGUuY3NzVGV4dD1cIm1heC13aWR0aDpub25lO21pbi13aWR0aDoyMHB4O21pbi1oZWlnaHQ6MjBweDtkaXNwbGF5OmlubGluZS1ibG9jaztvdmVyZmxvdzpoaWRkZW47cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6YXV0bzttYXJnaW46MDtwYWRkaW5nOjA7dG9wOi05OTlweDt3aGl0ZS1zcGFjZTpub3dyYXA7Zm9udC1zeW50aGVzaXM6bm9uZTtmb250OlwiK2MrXCI7XCJ9ZnVuY3Rpb24gQihhKXt2YXIgYz1hLmcub2Zmc2V0V2lkdGgsYj1jKzEwMDthLmouc3R5bGUud2lkdGg9YitcInB4XCI7YS5pLnNjcm9sbExlZnQ9YjthLmguc2Nyb2xsTGVmdD1hLmguc2Nyb2xsV2lkdGgrMTAwO3JldHVybiBhLmwhPT1jPyhhLmw9YywhMCk6ITF9ZnVuY3Rpb24gQyhhLGMpe2Z1bmN0aW9uIGIoKXt2YXIgZT1nO0IoZSkmJm51bGwhPT1lLmcucGFyZW50Tm9kZSYmYyhlLmwpfXZhciBnPWE7cChhLmgsYik7cChhLmksYik7QihhKX07ZnVuY3Rpb24gRChhLGMsYil7Yz1jfHx7fTtiPWJ8fHdpbmRvdzt0aGlzLmZhbWlseT1hO3RoaXMuc3R5bGU9Yy5zdHlsZXx8XCJub3JtYWxcIjt0aGlzLndlaWdodD1jLndlaWdodHx8XCJub3JtYWxcIjt0aGlzLnN0cmV0Y2g9Yy5zdHJldGNofHxcIm5vcm1hbFwiO3RoaXMuY29udGV4dD1ifXZhciBFPW51bGwsRj1udWxsLEc9bnVsbCxIPW51bGw7ZnVuY3Rpb24gSShhKXtudWxsPT09RiYmKE0oYSkmJi9BcHBsZS8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnZlbmRvcik/KGE9L0FwcGxlV2ViS2l0XFwvKFswLTldKykoPzpcXC4oWzAtOV0rKSkoPzpcXC4oWzAtOV0rKSkvLmV4ZWMod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpLEY9ISFhJiY2MDM+cGFyc2VJbnQoYVsxXSwxMCkpOkY9ITEpO3JldHVybiBGfWZ1bmN0aW9uIE0oYSl7bnVsbD09PUgmJihIPSEhYS5kb2N1bWVudC5mb250cyk7cmV0dXJuIEh9XG5mdW5jdGlvbiBOKGEsYyl7dmFyIGI9YS5zdHlsZSxnPWEud2VpZ2h0O2lmKG51bGw9PT1HKXt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RyeXtlLnN0eWxlLmZvbnQ9XCJjb25kZW5zZWQgMTAwcHggc2Fucy1zZXJpZlwifWNhdGNoKHEpe31HPVwiXCIhPT1lLnN0eWxlLmZvbnR9cmV0dXJuW2IsZyxHP2Euc3RyZXRjaDpcIlwiLFwiMTAwcHhcIixjXS5qb2luKFwiIFwiKX1cbkQucHJvdG90eXBlLmxvYWQ9ZnVuY3Rpb24oYSxjKXt2YXIgYj10aGlzLGc9YXx8XCJCRVNic3d5XCIsZT0wLHE9Y3x8M0UzLEo9KG5ldyBEYXRlKS5nZXRUaW1lKCk7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKEssTCl7aWYoTShiLmNvbnRleHQpJiYhSShiLmNvbnRleHQpKXt2YXIgTz1uZXcgUHJvbWlzZShmdW5jdGlvbihyLHQpe2Z1bmN0aW9uIGgoKXsobmV3IERhdGUpLmdldFRpbWUoKS1KPj1xP3QoRXJyb3IoXCJcIitxK1wibXMgdGltZW91dCBleGNlZWRlZFwiKSk6Yi5jb250ZXh0LmRvY3VtZW50LmZvbnRzLmxvYWQoTihiLCdcIicrYi5mYW1pbHkrJ1wiJyksZykudGhlbihmdW5jdGlvbihuKXsxPD1uLmxlbmd0aD9yKCk6c2V0VGltZW91dChoLDI1KX0sdCl9aCgpfSksUD1uZXcgUHJvbWlzZShmdW5jdGlvbihyLHQpe2U9c2V0VGltZW91dChmdW5jdGlvbigpe3QoRXJyb3IoXCJcIitxK1wibXMgdGltZW91dCBleGNlZWRlZFwiKSl9LHEpfSk7UHJvbWlzZS5yYWNlKFtQLE9dKS50aGVuKGZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KGUpO1xuSyhiKX0sTCl9ZWxzZSB1KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcigpe3ZhciBkO2lmKGQ9LTEhPWsmJi0xIT1sfHwtMSE9ayYmLTEhPW18fC0xIT1sJiYtMSE9bSkoZD1rIT1sJiZrIT1tJiZsIT1tKXx8KG51bGw9PT1FJiYoZD0vQXBwbGVXZWJLaXRcXC8oWzAtOV0rKSg/OlxcLihbMC05XSspKS8uZXhlYyh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCksRT0hIWQmJig1MzY+cGFyc2VJbnQoZFsxXSwxMCl8fDUzNj09PXBhcnNlSW50KGRbMV0sMTApJiYxMT49cGFyc2VJbnQoZFsyXSwxMCkpKSxkPUUmJihrPT15JiZsPT15JiZtPT15fHxrPT16JiZsPT16JiZtPT16fHxrPT1BJiZsPT1BJiZtPT1BKSksZD0hZDtkJiYobnVsbCE9PWYucGFyZW50Tm9kZSYmZi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGYpLGNsZWFyVGltZW91dChlKSxLKGIpKX1mdW5jdGlvbiB0KCl7aWYoKG5ldyBEYXRlKS5nZXRUaW1lKCktSj49cSludWxsIT09Zi5wYXJlbnROb2RlJiZmLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZiksXG5MKEVycm9yKFwiXCIrcStcIm1zIHRpbWVvdXQgZXhjZWVkZWRcIikpO2Vsc2V7dmFyIGQ9Yi5jb250ZXh0LmRvY3VtZW50LmhpZGRlbjtpZighMD09PWR8fHZvaWQgMD09PWQpaz1oLmcub2Zmc2V0V2lkdGgsbD1uLmcub2Zmc2V0V2lkdGgsbT12Lmcub2Zmc2V0V2lkdGgscigpO2U9c2V0VGltZW91dCh0LDUwKX19dmFyIGg9bmV3IHcoZyksbj1uZXcgdyhnKSx2PW5ldyB3KGcpLGs9LTEsbD0tMSxtPS0xLHk9LTEsej0tMSxBPS0xLGY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtmLmRpcj1cImx0clwiO3goaCxOKGIsXCJzYW5zLXNlcmlmXCIpKTt4KG4sTihiLFwic2VyaWZcIikpO3godixOKGIsXCJtb25vc3BhY2VcIikpO2YuYXBwZW5kQ2hpbGQoaC5nKTtmLmFwcGVuZENoaWxkKG4uZyk7Zi5hcHBlbmRDaGlsZCh2LmcpO2IuY29udGV4dC5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGYpO3k9aC5nLm9mZnNldFdpZHRoO3o9bi5nLm9mZnNldFdpZHRoO0E9di5nLm9mZnNldFdpZHRoO3QoKTtcbkMoaCxmdW5jdGlvbihkKXtrPWQ7cigpfSk7eChoLE4oYiwnXCInK2IuZmFtaWx5KydcIixzYW5zLXNlcmlmJykpO0MobixmdW5jdGlvbihkKXtsPWQ7cigpfSk7eChuLE4oYiwnXCInK2IuZmFtaWx5KydcIixzZXJpZicpKTtDKHYsZnVuY3Rpb24oZCl7bT1kO3IoKX0pO3godixOKGIsJ1wiJytiLmZhbWlseSsnXCIsbW9ub3NwYWNlJykpfSl9KX07XCJvYmplY3RcIj09PXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9RDood2luZG93LkZvbnRGYWNlT2JzZXJ2ZXI9RCx3aW5kb3cuRm9udEZhY2VPYnNlcnZlci5wcm90b3R5cGUubG9hZD1ELnByb3RvdHlwZS5sb2FkKTt9KCkpO1xuIiwiKGZ1bmN0aW9uKGdsb2JhbCwgZmFjdG9yeSkge1xuICB0eXBlb2YgZXhwb3J0cyA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlICE9PSBcInVuZGVmaW5lZFwiID8gZmFjdG9yeShleHBvcnRzKSA6IHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKFtcImV4cG9ydHNcIl0sIGZhY3RvcnkpIDogKGdsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsVGhpcyA6IGdsb2JhbCB8fCBzZWxmLCBmYWN0b3J5KGdsb2JhbC5wbGFuY2sgPSB7fSkpO1xufSkodGhpcywgZnVuY3Rpb24oZXhwb3J0czIpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7LyoqXG4gKiBQbGFuY2suanMgdjEuNC4yXG4gKiBAbGljZW5zZSBUaGUgTUlUIGxpY2Vuc2VcbiAqIEBjb3B5cmlnaHQgQ29weXJpZ2h0IChjKSAyMDI1IEVyaW4gQ2F0dG8sIEFsaSBTaGFraWJhXG4gKlxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICpcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXG4gKiBTT0ZUV0FSRS5cbiAqL1xuXG4gIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXG4gIFxuICAgICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XG4gICAgICBwdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXG4gIFxuICAgICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxuICAgICAgUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXG4gICAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXG4gICAgICBJTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cbiAgICAgIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXG4gICAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXG4gICAgICBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxuICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cbiAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkMiwgYjIpIHtcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24oZDMsIGIzKSB7XG4gICAgICBkMy5fX3Byb3RvX18gPSBiMztcbiAgICB9IHx8IGZ1bmN0aW9uKGQzLCBiMykge1xuICAgICAgZm9yICh2YXIgcCBpbiBiMykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiMywgcCkpIGQzW3BdID0gYjNbcF07XG4gICAgfTtcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkMiwgYjIpO1xuICB9O1xuICBmdW5jdGlvbiBfX2V4dGVuZHMoZDIsIGIyKSB7XG4gICAgaWYgKHR5cGVvZiBiMiAhPT0gXCJmdW5jdGlvblwiICYmIGIyICE9PSBudWxsKVxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYjIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICBleHRlbmRTdGF0aWNzKGQyLCBiMik7XG4gICAgZnVuY3Rpb24gX18oKSB7XG4gICAgICB0aGlzLmNvbnN0cnVjdG9yID0gZDI7XG4gICAgfVxuICAgIGQyLnByb3RvdHlwZSA9IGIyID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiMikgOiAoX18ucHJvdG90eXBlID0gYjIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gIH1cbiAgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduMih0KSB7XG4gICAgICBmb3IgKHZhciBzMiwgaSA9IDEsIG4yID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG4yOyBpKyspIHtcbiAgICAgICAgczIgPSBhcmd1bWVudHNbaV07XG4gICAgICAgIGZvciAodmFyIHAgaW4gczIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoczIsIHApKSB0W3BdID0gczJbcF07XG4gICAgICB9XG4gICAgICByZXR1cm4gdDtcbiAgICB9O1xuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuICB2YXIgb3B0aW9ucyA9IGZ1bmN0aW9uKGlucHV0MiwgZGVmYXVsdHMpIHtcbiAgICBpZiAoaW5wdXQyID09PSBudWxsIHx8IHR5cGVvZiBpbnB1dDIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGlucHV0MiA9IHt9O1xuICAgIH1cbiAgICB2YXIgb3V0cHV0MiA9IF9fYXNzaWduKHt9LCBpbnB1dDIpO1xuICAgIGZvciAodmFyIGtleSBpbiBkZWZhdWx0cykge1xuICAgICAgaWYgKGRlZmF1bHRzLmhhc093blByb3BlcnR5KGtleSkgJiYgdHlwZW9mIGlucHV0MltrZXldID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIG91dHB1dDJba2V5XSA9IGRlZmF1bHRzW2tleV07XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZGVmYXVsdHMpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzeW1ib2xzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzW2ldO1xuICAgICAgICBpZiAoZGVmYXVsdHMucHJvcGVydHlJc0VudW1lcmFibGUoc3ltYm9sKSAmJiB0eXBlb2YgaW5wdXQyW3N5bWJvbF0gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICBvdXRwdXQyW3N5bWJvbF0gPSBkZWZhdWx0c1tzeW1ib2xdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQyO1xuICB9O1xuICB2YXIgbWF0aF9yYW5kb20gPSBNYXRoLnJhbmRvbTtcbiAgdmFyIEVQU0lMT04gPSAxZS05O1xuICB2YXIgaXNGaW5pdGUgPSBOdW1iZXIuaXNGaW5pdGU7XG4gIGZ1bmN0aW9uIG5leHRQb3dlck9mVHdvKHgyKSB7XG4gICAgeDIgfD0geDIgPj4gMTtcbiAgICB4MiB8PSB4MiA+PiAyO1xuICAgIHgyIHw9IHgyID4+IDQ7XG4gICAgeDIgfD0geDIgPj4gODtcbiAgICB4MiB8PSB4MiA+PiAxNjtcbiAgICByZXR1cm4geDIgKyAxO1xuICB9XG4gIGZ1bmN0aW9uIGlzUG93ZXJPZlR3byh4Mikge1xuICAgIHJldHVybiB4MiA+IDAgJiYgKHgyICYgeDIgLSAxKSA9PT0gMDtcbiAgfVxuICBmdW5jdGlvbiBtb2QobnVtLCBtaW4sIG1heCkge1xuICAgIGlmICh0eXBlb2YgbWluID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBtYXggPSAxO1xuICAgICAgbWluID0gMDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBtYXggPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIG1heCA9IG1pbjtcbiAgICAgIG1pbiA9IDA7XG4gICAgfVxuICAgIGlmIChtYXggPiBtaW4pIHtcbiAgICAgIG51bSA9IChudW0gLSBtaW4pICUgKG1heCAtIG1pbik7XG4gICAgICByZXR1cm4gbnVtICsgKG51bSA8IDAgPyBtYXggOiBtaW4pO1xuICAgIH0gZWxzZSB7XG4gICAgICBudW0gPSAobnVtIC0gbWF4KSAlIChtaW4gLSBtYXgpO1xuICAgICAgcmV0dXJuIG51bSArIChudW0gPD0gMCA/IG1pbiA6IG1heCk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGNsYW1wKG51bSwgbWluLCBtYXgpIHtcbiAgICBpZiAobnVtIDwgbWluKSB7XG4gICAgICByZXR1cm4gbWluO1xuICAgIH0gZWxzZSBpZiAobnVtID4gbWF4KSB7XG4gICAgICByZXR1cm4gbWF4O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbnVtO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiByYW5kb20obWluLCBtYXgpIHtcbiAgICBpZiAodHlwZW9mIG1pbiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgbWF4ID0gMTtcbiAgICAgIG1pbiA9IDA7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbWF4ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBtYXggPSBtaW47XG4gICAgICBtaW4gPSAwO1xuICAgIH1cbiAgICByZXR1cm4gbWluID09PSBtYXggPyBtaW4gOiBtYXRoX3JhbmRvbSgpICogKG1heCAtIG1pbikgKyBtaW47XG4gIH1cbiAgdmFyIG1hdGggPSBPYmplY3QuY3JlYXRlKE1hdGgpO1xuICBtYXRoLkVQU0lMT04gPSBFUFNJTE9OO1xuICBtYXRoLmlzRmluaXRlID0gaXNGaW5pdGU7XG4gIG1hdGgubmV4dFBvd2VyT2ZUd28gPSBuZXh0UG93ZXJPZlR3bztcbiAgbWF0aC5pc1Bvd2VyT2ZUd28gPSBpc1Bvd2VyT2ZUd287XG4gIG1hdGgubW9kID0gbW9kO1xuICBtYXRoLmNsYW1wID0gY2xhbXA7XG4gIG1hdGgucmFuZG9tID0gcmFuZG9tO1xuICB2YXIgbWF0aF9hYnMkOSA9IE1hdGguYWJzO1xuICB2YXIgbWF0aF9zcXJ0JDUgPSBNYXRoLnNxcnQ7XG4gIHZhciBtYXRoX21heCQ4ID0gTWF0aC5tYXg7XG4gIHZhciBtYXRoX21pbiQ4ID0gTWF0aC5taW47XG4gIHZhciBWZWMyID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFZlYzIyKHgyLCB5KSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBWZWMyMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFZlYzIyKHgyLCB5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHgyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgdGhpcy54ID0gMDtcbiAgICAgICAgICB0aGlzLnkgPSAwO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB4MiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMueCA9IHgyLng7XG4gICAgICAgICAgdGhpcy55ID0geDIueTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnggPSB4MjtcbiAgICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBWZWMyMi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHg6IHRoaXMueCxcbiAgICAgICAgICB5OiB0aGlzLnlcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFZlYzIyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai54ID0gZGF0YS54O1xuICAgICAgICBvYmoueSA9IGRhdGEueTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBWZWMyMi56ZXJvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFZlYzIyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai54ID0gMDtcbiAgICAgICAgb2JqLnkgPSAwO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLm5lbyA9IGZ1bmN0aW9uKHgyLCB5KSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFZlYzIyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai54ID0geDI7XG4gICAgICAgIG9iai55ID0geTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBWZWMyMi5jbG9uZSA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8odjMueCwgdjMueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5pc1ZhbGlkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKG9iai54KSAmJiBOdW1iZXIuaXNGaW5pdGUob2JqLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmFzc2VydCA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLmNsb25lKHRoaXMpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zZXRaZXJvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMueCA9IDA7XG4gICAgICAgIHRoaXMueSA9IDA7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih4MiwgeSkge1xuICAgICAgICBpZiAodHlwZW9mIHgyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy54ID0geDIueDtcbiAgICAgICAgICB0aGlzLnkgPSB4Mi55O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMueCA9IHgyO1xuICAgICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnNldE51bSA9IGZ1bmN0aW9uKHgyLCB5KSB7XG4gICAgICAgIHRoaXMueCA9IHgyO1xuICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc2V0VmVjMiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMueCA9IHZhbHVlLng7XG4gICAgICAgIHRoaXMueSA9IHZhbHVlLnk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS53U2V0ID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICBpZiAodHlwZW9mIGIyICE9PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiB3ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2V0Q29tYmluZShhMiwgdjMsIGIyLCB3KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zZXRNdWwoYTIsIHYzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zZXRDb21iaW5lID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICB2YXIgeDIgPSBhMiAqIHYzLnggKyBiMiAqIHcueDtcbiAgICAgICAgdmFyIHkgPSBhMiAqIHYzLnkgKyBiMiAqIHcueTtcbiAgICAgICAgdGhpcy54ID0geDI7XG4gICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zZXRNdWwgPSBmdW5jdGlvbihhMiwgdjMpIHtcbiAgICAgICAgdmFyIHgyID0gYTIgKiB2My54O1xuICAgICAgICB2YXIgeSA9IGEyICogdjMueTtcbiAgICAgICAgdGhpcy54ID0geDI7XG4gICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbih3KSB7XG4gICAgICAgIHRoaXMueCArPSB3Lng7XG4gICAgICAgIHRoaXMueSArPSB3Lnk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS53QWRkID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICBpZiAodHlwZW9mIGIyICE9PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiB3ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuYWRkQ29tYmluZShhMiwgdjMsIGIyLCB3KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5hZGRNdWwoYTIsIHYzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5hZGRDb21iaW5lID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICB2YXIgeDIgPSBhMiAqIHYzLnggKyBiMiAqIHcueDtcbiAgICAgICAgdmFyIHkgPSBhMiAqIHYzLnkgKyBiMiAqIHcueTtcbiAgICAgICAgdGhpcy54ICs9IHgyO1xuICAgICAgICB0aGlzLnkgKz0geTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLmFkZE11bCA9IGZ1bmN0aW9uKGEyLCB2Mykge1xuICAgICAgICB2YXIgeDIgPSBhMiAqIHYzLng7XG4gICAgICAgIHZhciB5ID0gYTIgKiB2My55O1xuICAgICAgICB0aGlzLnggKz0geDI7XG4gICAgICAgIHRoaXMueSArPSB5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUud1N1YiA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiMiAhPT0gXCJ1bmRlZmluZWRcIiB8fCB0eXBlb2YgdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiB0aGlzLnN1YkNvbWJpbmUoYTIsIHYzLCBiMiwgdyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc3ViTXVsKGEyLCB2Myk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUuc3ViQ29tYmluZSA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgdmFyIHgyID0gYTIgKiB2My54ICsgYjIgKiB3Lng7XG4gICAgICAgIHZhciB5ID0gYTIgKiB2My55ICsgYjIgKiB3Lnk7XG4gICAgICAgIHRoaXMueCAtPSB4MjtcbiAgICAgICAgdGhpcy55IC09IHk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5zdWJNdWwgPSBmdW5jdGlvbihhMiwgdjMpIHtcbiAgICAgICAgdmFyIHgyID0gYTIgKiB2My54O1xuICAgICAgICB2YXIgeSA9IGEyICogdjMueTtcbiAgICAgICAgdGhpcy54IC09IHgyO1xuICAgICAgICB0aGlzLnkgLT0geTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLnN1YiA9IGZ1bmN0aW9uKHcpIHtcbiAgICAgICAgdGhpcy54IC09IHcueDtcbiAgICAgICAgdGhpcy55IC09IHcueTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIucHJvdG90eXBlLm11bCA9IGZ1bmN0aW9uKG0pIHtcbiAgICAgICAgdGhpcy54ICo9IG07XG4gICAgICAgIHRoaXMueSAqPSBtO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUubGVuZ3RoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5sZW5ndGhPZih0aGlzKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUubGVuZ3RoU3F1YXJlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVmVjMjIubGVuZ3RoU3F1YXJlZCh0aGlzKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5wcm90b3R5cGUubm9ybWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpO1xuICAgICAgICBpZiAobGVuZ3RoIDwgRVBTSUxPTikge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnZMZW5ndGggPSAxIC8gbGVuZ3RoO1xuICAgICAgICB0aGlzLnggKj0gaW52TGVuZ3RoO1xuICAgICAgICB0aGlzLnkgKj0gaW52TGVuZ3RoO1xuICAgICAgICByZXR1cm4gbGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSBWZWMyMi5sZW5ndGhPZih2Myk7XG4gICAgICAgIGlmIChsZW5ndGggPCBFUFNJTE9OKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLnplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW52TGVuZ3RoID0gMSAvIGxlbmd0aDtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh2My54ICogaW52TGVuZ3RoLCB2My55ICogaW52TGVuZ3RoKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5sZW5ndGhPZiA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBtYXRoX3NxcnQkNSh2My54ICogdjMueCArIHYzLnkgKiB2My55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5sZW5ndGhTcXVhcmVkID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIHYzLnggKiB2My54ICsgdjMueSAqIHYzLnk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuZGlzdGFuY2UgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICB2YXIgZHggPSB2My54IC0gdy54O1xuICAgICAgICB2YXIgZHkgPSB2My55IC0gdy55O1xuICAgICAgICByZXR1cm4gbWF0aF9zcXJ0JDUoZHggKiBkeCArIGR5ICogZHkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmRpc3RhbmNlU3F1YXJlZCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHZhciBkeCA9IHYzLnggLSB3Lng7XG4gICAgICAgIHZhciBkeSA9IHYzLnkgLSB3Lnk7XG4gICAgICAgIHJldHVybiBkeCAqIGR4ICsgZHkgKiBkeTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5hcmVFcXVhbCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiB2MyA9PT0gdyB8fCB0eXBlb2YgdyA9PT0gXCJvYmplY3RcIiAmJiB3ICE9PSBudWxsICYmIHYzLnggPT09IHcueCAmJiB2My55ID09PSB3Lnk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuc2tldyA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8oLXYzLnksIHYzLngpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmRvdCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiB2My54ICogdy54ICsgdjMueSAqIHcueTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5jcm9zcyA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8odyAqIHYzLnksIC13ICogdjMueCk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHYzID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMgKiB3LnksIHYzICogdy54KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdjMueCAqIHcueSAtIHYzLnkgKiB3Lng7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBWZWMyMi5jcm9zc1ZlYzJWZWMyID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIHYzLnggKiB3LnkgLSB2My55ICogdy54O1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmNyb3NzVmVjMk51bSA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8odyAqIHYzLnksIC13ICogdjMueCk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuY3Jvc3NOdW1WZWMyID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMgKiB3LnksIHYzICogdy54KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5hZGRDcm9zcyA9IGZ1bmN0aW9uKGEyLCB2Mywgdykge1xuICAgICAgICBpZiAodHlwZW9mIHcgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gVmVjMjIubmVvKHcgKiB2My55ICsgYTIueCwgLXcgKiB2My54ICsgYTIueSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHYzID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMgKiB3LnkgKyBhMi54LCB2MyAqIHcueCArIGEyLnkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVmVjMjIuYWRkQ3Jvc3NWZWMyTnVtID0gZnVuY3Rpb24oYTIsIHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8odyAqIHYzLnkgKyBhMi54LCAtdyAqIHYzLnggKyBhMi55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5hZGRDcm9zc051bVZlYzIgPSBmdW5jdGlvbihhMiwgdjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMgKiB3LnkgKyBhMi54LCB2MyAqIHcueCArIGEyLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmFkZCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8odjMueCArIHcueCwgdjMueSArIHcueSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIud0FkZCA9IGZ1bmN0aW9uKGEyLCB2MywgYjIsIHcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiMiAhPT0gXCJ1bmRlZmluZWRcIiB8fCB0eXBlb2YgdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5jb21iaW5lKGEyLCB2MywgYjIsIHcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5tdWxOdW1WZWMyKGEyLCB2Myk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBWZWMyMi5jb21iaW5lID0gZnVuY3Rpb24oYTIsIHYzLCBiMiwgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIuemVybygpLnNldENvbWJpbmUoYTIsIHYzLCBiMiwgdyk7XG4gICAgICB9O1xuICAgICAgVmVjMjIuc3ViID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh2My54IC0gdy54LCB2My55IC0gdy55KTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5tdWwgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhMiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8oYTIueCAqIGIyLCBhMi55ICogYjIpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBiMiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8oYTIgKiBiMi54LCBhMiAqIGIyLnkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVmVjMjIubXVsVmVjMk51bSA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKGEyLnggKiBiMiwgYTIueSAqIGIyKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5tdWxOdW1WZWMyID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8oYTIgKiBiMi54LCBhMiAqIGIyLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5uZWcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy54ID0gLXRoaXMueDtcbiAgICAgICAgdGhpcy55ID0gLXRoaXMueTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMjIubmVnID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygtdjMueCwgLXYzLnkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmFicyA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8obWF0aF9hYnMkOSh2My54KSwgbWF0aF9hYnMkOSh2My55KSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIubWlkID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIyLm5lbygodjMueCArIHcueCkgKiAwLjUsICh2My55ICsgdy55KSAqIDAuNSk7XG4gICAgICB9O1xuICAgICAgVmVjMjIudXBwZXIgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gVmVjMjIubmVvKG1hdGhfbWF4JDgodjMueCwgdy54KSwgbWF0aF9tYXgkOCh2My55LCB3LnkpKTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5sb3dlciA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBWZWMyMi5uZW8obWF0aF9taW4kOCh2My54LCB3LngpLCBtYXRoX21pbiQ4KHYzLnksIHcueSkpO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLnByb3RvdHlwZS5jbGFtcCA9IGZ1bmN0aW9uKG1heCkge1xuICAgICAgICB2YXIgbGVuZ3RoU3FyID0gdGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55O1xuICAgICAgICBpZiAobGVuZ3RoU3FyID4gbWF4ICogbWF4KSB7XG4gICAgICAgICAgdmFyIHNjYWxlID0gbWF4IC8gbWF0aF9zcXJ0JDUobGVuZ3RoU3FyKTtcbiAgICAgICAgICB0aGlzLnggKj0gc2NhbGU7XG4gICAgICAgICAgdGhpcy55ICo9IHNjYWxlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzIyLmNsYW1wID0gZnVuY3Rpb24odjMsIG1heCkge1xuICAgICAgICB2YXIgciA9IFZlYzIyLm5lbyh2My54LCB2My55KTtcbiAgICAgICAgci5jbGFtcChtYXgpO1xuICAgICAgICByZXR1cm4gcjtcbiAgICAgIH07XG4gICAgICBWZWMyMi5jbGFtcFZlYzIgPSBmdW5jdGlvbih2MywgbWluLCBtYXgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB4OiBjbGFtcCh2My54LCBtaW4gPT09IG51bGwgfHwgbWluID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtaW4ueCwgbWF4ID09PSBudWxsIHx8IG1heCA9PT0gdm9pZCAwID8gdm9pZCAwIDogbWF4LngpLFxuICAgICAgICAgIHk6IGNsYW1wKHYzLnksIG1pbiA9PT0gbnVsbCB8fCBtaW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG1pbi55LCBtYXggPT09IG51bGwgfHwgbWF4ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtYXgueSlcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBWZWMyMi5zY2FsZUZuID0gZnVuY3Rpb24oeDIsIHkpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIyLm5lbyh2My54ICogeDIsIHYzLnkgKiB5KTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBWZWMyMi50cmFuc2xhdGVGbiA9IGZ1bmN0aW9uKHgyLCB5KSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih2Mykge1xuICAgICAgICAgIHJldHVybiBWZWMyMi5uZW8odjMueCArIHgyLCB2My55ICsgeSk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFZlYzIyO1xuICAgIH0oKVxuICApO1xuICB2YXIgbWF0aF9tYXgkNyA9IE1hdGgubWF4O1xuICB2YXIgbWF0aF9taW4kNyA9IE1hdGgubWluO1xuICB2YXIgQUFCQiA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBBQUJCMihsb3dlciwgdXBwZXIpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEFBQkIyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgQUFCQjIobG93ZXIsIHVwcGVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxvd2VyQm91bmQgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy51cHBlckJvdW5kID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIGlmICh0eXBlb2YgbG93ZXIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLmxvd2VyQm91bmQuc2V0VmVjMihsb3dlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB1cHBlciA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHRoaXMudXBwZXJCb3VuZC5zZXRWZWMyKHVwcGVyKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbG93ZXIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLnVwcGVyQm91bmQuc2V0VmVjMihsb3dlcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIEFBQkIyLnByb3RvdHlwZS5pc1ZhbGlkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBBQUJCMi5pc1ZhbGlkKHRoaXMpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBWZWMyLmlzVmFsaWQob2JqLmxvd2VyQm91bmQpICYmIFZlYzIuaXNWYWxpZChvYmoudXBwZXJCb3VuZCkgJiYgVmVjMi5zdWIob2JqLnVwcGVyQm91bmQsIG9iai5sb3dlckJvdW5kKS5sZW5ndGhTcXVhcmVkKCkgPj0gMDtcbiAgICAgIH07XG4gICAgICBBQUJCMi5hc3NlcnQgPSBmdW5jdGlvbihvKSB7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmdldENlbnRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oKHRoaXMubG93ZXJCb3VuZC54ICsgdGhpcy51cHBlckJvdW5kLngpICogMC41LCAodGhpcy5sb3dlckJvdW5kLnkgKyB0aGlzLnVwcGVyQm91bmQueSkgKiAwLjUpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5nZXRFeHRlbnRzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbygodGhpcy51cHBlckJvdW5kLnggLSB0aGlzLmxvd2VyQm91bmQueCkgKiAwLjUsICh0aGlzLnVwcGVyQm91bmQueSAtIHRoaXMubG93ZXJCb3VuZC55KSAqIDAuNSk7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmdldFBlcmltZXRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gMiAqICh0aGlzLnVwcGVyQm91bmQueCAtIHRoaXMubG93ZXJCb3VuZC54ICsgdGhpcy51cHBlckJvdW5kLnkgLSB0aGlzLmxvd2VyQm91bmQueSk7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmNvbWJpbmUgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgYjIgPSBiMiB8fCB0aGlzO1xuICAgICAgICB2YXIgbG93ZXJBID0gYTIubG93ZXJCb3VuZDtcbiAgICAgICAgdmFyIHVwcGVyQSA9IGEyLnVwcGVyQm91bmQ7XG4gICAgICAgIHZhciBsb3dlckIgPSBiMi5sb3dlckJvdW5kO1xuICAgICAgICB2YXIgdXBwZXJCID0gYjIudXBwZXJCb3VuZDtcbiAgICAgICAgdmFyIGxvd2VyWCA9IG1hdGhfbWluJDcobG93ZXJBLngsIGxvd2VyQi54KTtcbiAgICAgICAgdmFyIGxvd2VyWSA9IG1hdGhfbWluJDcobG93ZXJBLnksIGxvd2VyQi55KTtcbiAgICAgICAgdmFyIHVwcGVyWCA9IG1hdGhfbWF4JDcodXBwZXJCLngsIHVwcGVyQS54KTtcbiAgICAgICAgdmFyIHVwcGVyWSA9IG1hdGhfbWF4JDcodXBwZXJCLnksIHVwcGVyQS55KTtcbiAgICAgICAgdGhpcy5sb3dlckJvdW5kLnNldE51bShsb3dlclgsIGxvd2VyWSk7XG4gICAgICAgIHRoaXMudXBwZXJCb3VuZC5zZXROdW0odXBwZXJYLCB1cHBlclkpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5jb21iaW5lUG9pbnRzID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHRoaXMubG93ZXJCb3VuZC5zZXROdW0obWF0aF9taW4kNyhhMi54LCBiMi54KSwgbWF0aF9taW4kNyhhMi55LCBiMi55KSk7XG4gICAgICAgIHRoaXMudXBwZXJCb3VuZC5zZXROdW0obWF0aF9tYXgkNyhhMi54LCBiMi54KSwgbWF0aF9tYXgkNyhhMi55LCBiMi55KSk7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKGFhYmIpIHtcbiAgICAgICAgdGhpcy5sb3dlckJvdW5kLnNldE51bShhYWJiLmxvd2VyQm91bmQueCwgYWFiYi5sb3dlckJvdW5kLnkpO1xuICAgICAgICB0aGlzLnVwcGVyQm91bmQuc2V0TnVtKGFhYmIudXBwZXJCb3VuZC54LCBhYWJiLnVwcGVyQm91bmQueSk7XG4gICAgICB9O1xuICAgICAgQUFCQjIucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24oYWFiYikge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIHRoaXMubG93ZXJCb3VuZC54IDw9IGFhYmIubG93ZXJCb3VuZC54O1xuICAgICAgICByZXN1bHQgPSByZXN1bHQgJiYgdGhpcy5sb3dlckJvdW5kLnkgPD0gYWFiYi5sb3dlckJvdW5kLnk7XG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiBhYWJiLnVwcGVyQm91bmQueCA8PSB0aGlzLnVwcGVyQm91bmQueDtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIGFhYmIudXBwZXJCb3VuZC55IDw9IHRoaXMudXBwZXJCb3VuZC55O1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcbiAgICAgIEFBQkIyLnByb3RvdHlwZS5leHRlbmQgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBBQUJCMi5leHRlbmQodGhpcywgdmFsdWUpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBBQUJCMi5leHRlbmQgPSBmdW5jdGlvbihvdXQsIHZhbHVlKSB7XG4gICAgICAgIG91dC5sb3dlckJvdW5kLnggLT0gdmFsdWU7XG4gICAgICAgIG91dC5sb3dlckJvdW5kLnkgLT0gdmFsdWU7XG4gICAgICAgIG91dC51cHBlckJvdW5kLnggKz0gdmFsdWU7XG4gICAgICAgIG91dC51cHBlckJvdW5kLnkgKz0gdmFsdWU7XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgICB9O1xuICAgICAgQUFCQjIudGVzdE92ZXJsYXAgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIGQxeCA9IGIyLmxvd2VyQm91bmQueCAtIGEyLnVwcGVyQm91bmQueDtcbiAgICAgICAgdmFyIGQyeCA9IGEyLmxvd2VyQm91bmQueCAtIGIyLnVwcGVyQm91bmQueDtcbiAgICAgICAgdmFyIGQxeSA9IGIyLmxvd2VyQm91bmQueSAtIGEyLnVwcGVyQm91bmQueTtcbiAgICAgICAgdmFyIGQyeSA9IGEyLmxvd2VyQm91bmQueSAtIGIyLnVwcGVyQm91bmQueTtcbiAgICAgICAgaWYgKGQxeCA+IDAgfHwgZDF5ID4gMCB8fCBkMnggPiAwIHx8IGQyeSA+IDApIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgQUFCQjIuYXJlRXF1YWwgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIuYXJlRXF1YWwoYTIubG93ZXJCb3VuZCwgYjIubG93ZXJCb3VuZCkgJiYgVmVjMi5hcmVFcXVhbChhMi51cHBlckJvdW5kLCBiMi51cHBlckJvdW5kKTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5kaWZmID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciB3RCA9IG1hdGhfbWF4JDcoMCwgbWF0aF9taW4kNyhhMi51cHBlckJvdW5kLngsIGIyLnVwcGVyQm91bmQueCkgLSBtYXRoX21heCQ3KGIyLmxvd2VyQm91bmQueCwgYTIubG93ZXJCb3VuZC54KSk7XG4gICAgICAgIHZhciBoRCA9IG1hdGhfbWF4JDcoMCwgbWF0aF9taW4kNyhhMi51cHBlckJvdW5kLnksIGIyLnVwcGVyQm91bmQueSkgLSBtYXRoX21heCQ3KGIyLmxvd2VyQm91bmQueSwgYTIubG93ZXJCb3VuZC55KSk7XG4gICAgICAgIHZhciB3QSA9IGEyLnVwcGVyQm91bmQueCAtIGEyLmxvd2VyQm91bmQueDtcbiAgICAgICAgdmFyIGhBID0gYTIudXBwZXJCb3VuZC55IC0gYTIubG93ZXJCb3VuZC55O1xuICAgICAgICB2YXIgd0IgPSBiMi51cHBlckJvdW5kLnggLSBiMi5sb3dlckJvdW5kLng7XG4gICAgICAgIHZhciBoQiA9IGIyLnVwcGVyQm91bmQueSAtIGIyLmxvd2VyQm91bmQueTtcbiAgICAgICAgcmV0dXJuIHdBICogaEEgKyB3QiAqIGhCIC0gd0QgKiBoRDtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0Mikge1xuICAgICAgICB2YXIgdG1pbiA9IC1JbmZpbml0eTtcbiAgICAgICAgdmFyIHRtYXggPSBJbmZpbml0eTtcbiAgICAgICAgdmFyIHAgPSBpbnB1dDIucDE7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuc3ViKGlucHV0Mi5wMiwgaW5wdXQyLnAxKTtcbiAgICAgICAgdmFyIGFic0QgPSBWZWMyLmFicyhkMik7XG4gICAgICAgIHZhciBub3JtYWwzID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHtcbiAgICAgICAgICBpZiAoYWJzRC54IDwgRVBTSUxPTikge1xuICAgICAgICAgICAgaWYgKHAueCA8IHRoaXMubG93ZXJCb3VuZC54IHx8IHRoaXMudXBwZXJCb3VuZC54IDwgcC54KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGludl9kID0gMSAvIGQyLng7XG4gICAgICAgICAgICB2YXIgdDEgPSAodGhpcy5sb3dlckJvdW5kLnggLSBwLngpICogaW52X2Q7XG4gICAgICAgICAgICB2YXIgdDIgPSAodGhpcy51cHBlckJvdW5kLnggLSBwLngpICogaW52X2Q7XG4gICAgICAgICAgICB2YXIgczIgPSAtMTtcbiAgICAgICAgICAgIGlmICh0MSA+IHQyKSB7XG4gICAgICAgICAgICAgIHZhciB0ZW1wMyA9IHQxO1xuICAgICAgICAgICAgICB0MSA9IHQyO1xuICAgICAgICAgICAgICB0MiA9IHRlbXAzO1xuICAgICAgICAgICAgICBzMiA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodDEgPiB0bWluKSB7XG4gICAgICAgICAgICAgIG5vcm1hbDMuc2V0WmVybygpO1xuICAgICAgICAgICAgICBub3JtYWwzLnggPSBzMjtcbiAgICAgICAgICAgICAgdG1pbiA9IHQxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdG1heCA9IG1hdGhfbWluJDcodG1heCwgdDIpO1xuICAgICAgICAgICAgaWYgKHRtaW4gPiB0bWF4KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIGlmIChhYnNELnkgPCBFUFNJTE9OKSB7XG4gICAgICAgICAgICBpZiAocC55IDwgdGhpcy5sb3dlckJvdW5kLnkgfHwgdGhpcy51cHBlckJvdW5kLnkgPCBwLnkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgaW52X2QgPSAxIC8gZDIueTtcbiAgICAgICAgICAgIHZhciB0MSA9ICh0aGlzLmxvd2VyQm91bmQueSAtIHAueSkgKiBpbnZfZDtcbiAgICAgICAgICAgIHZhciB0MiA9ICh0aGlzLnVwcGVyQm91bmQueSAtIHAueSkgKiBpbnZfZDtcbiAgICAgICAgICAgIHZhciBzMiA9IC0xO1xuICAgICAgICAgICAgaWYgKHQxID4gdDIpIHtcbiAgICAgICAgICAgICAgdmFyIHRlbXAzID0gdDE7XG4gICAgICAgICAgICAgIHQxID0gdDI7XG4gICAgICAgICAgICAgIHQyID0gdGVtcDM7XG4gICAgICAgICAgICAgIHMyID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0MSA+IHRtaW4pIHtcbiAgICAgICAgICAgICAgbm9ybWFsMy5zZXRaZXJvKCk7XG4gICAgICAgICAgICAgIG5vcm1hbDMueSA9IHMyO1xuICAgICAgICAgICAgICB0bWluID0gdDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0bWF4ID0gbWF0aF9taW4kNyh0bWF4LCB0Mik7XG4gICAgICAgICAgICBpZiAodG1pbiA+IHRtYXgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodG1pbiA8IDAgfHwgaW5wdXQyLm1heEZyYWN0aW9uIDwgdG1pbikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXQyLmZyYWN0aW9uID0gdG1pbjtcbiAgICAgICAgb3V0cHV0Mi5ub3JtYWwgPSBub3JtYWwzO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBBQUJCMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMpO1xuICAgICAgfTtcbiAgICAgIEFBQkIyLmNvbWJpbmVQb2ludHMgPSBmdW5jdGlvbihvdXQsIGEyLCBiMikge1xuICAgICAgICBvdXQubG93ZXJCb3VuZC54ID0gbWF0aF9taW4kNyhhMi54LCBiMi54KTtcbiAgICAgICAgb3V0Lmxvd2VyQm91bmQueSA9IG1hdGhfbWluJDcoYTIueSwgYjIueSk7XG4gICAgICAgIG91dC51cHBlckJvdW5kLnggPSBtYXRoX21heCQ3KGEyLngsIGIyLngpO1xuICAgICAgICBvdXQudXBwZXJCb3VuZC55ID0gbWF0aF9tYXgkNyhhMi55LCBiMi55KTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgIH07XG4gICAgICBBQUJCMi5jb21iaW5lZFBlcmltZXRlciA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgbHggPSBtYXRoX21pbiQ3KGEyLmxvd2VyQm91bmQueCwgYjIubG93ZXJCb3VuZC54KTtcbiAgICAgICAgdmFyIGx5ID0gbWF0aF9taW4kNyhhMi5sb3dlckJvdW5kLnksIGIyLmxvd2VyQm91bmQueSk7XG4gICAgICAgIHZhciB1eCA9IG1hdGhfbWF4JDcoYTIudXBwZXJCb3VuZC54LCBiMi51cHBlckJvdW5kLngpO1xuICAgICAgICB2YXIgdXkgPSBtYXRoX21heCQ3KGEyLnVwcGVyQm91bmQueSwgYjIudXBwZXJCb3VuZC55KTtcbiAgICAgICAgcmV0dXJuIDIgKiAodXggLSBseCArIHV5IC0gbHkpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBBQUJCMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfUEkkNiA9IE1hdGguUEk7XG4gIHZhciBTZXR0aW5ncyA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTZXR0aW5nczIoKSB7XG4gICAgICB9XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3MyLCBcInBvbHlnb25SYWRpdXNcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHJhZGl1cyBvZiB0aGUgcG9seWdvbi9lZGdlIHNoYXBlIHNraW4uIFRoaXMgc2hvdWxkIG5vdCBiZSBtb2RpZmllZC5cbiAgICAgICAgICogTWFraW5nIHRoaXMgc21hbGxlciBtZWFucyBwb2x5Z29ucyB3aWxsIGhhdmUgYW4gaW5zdWZmaWNpZW50IGJ1ZmZlciBmb3JcbiAgICAgICAgICogY29udGludW91cyBjb2xsaXNpb24uIE1ha2luZyBpdCBsYXJnZXIgbWF5IGNyZWF0ZSBhcnRpZmFjdHMgZm9yIHZlcnRleFxuICAgICAgICAgKiBjb2xsaXNpb24uXG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiAyICogU2V0dGluZ3MyLmxpbmVhclNsb3A7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgU2V0dGluZ3MyLmxlbmd0aFVuaXRzUGVyTWV0ZXIgPSAxO1xuICAgICAgU2V0dGluZ3MyLm1heE1hbmlmb2xkUG9pbnRzID0gMjtcbiAgICAgIFNldHRpbmdzMi5tYXhQb2x5Z29uVmVydGljZXMgPSAxMjtcbiAgICAgIFNldHRpbmdzMi5hYWJiRXh0ZW5zaW9uID0gMC4xO1xuICAgICAgU2V0dGluZ3MyLmFhYmJNdWx0aXBsaWVyID0gMjtcbiAgICAgIFNldHRpbmdzMi5saW5lYXJTbG9wID0gNWUtMztcbiAgICAgIFNldHRpbmdzMi5hbmd1bGFyU2xvcCA9IDIgLyAxODAgKiBtYXRoX1BJJDY7XG4gICAgICBTZXR0aW5nczIubWF4U3ViU3RlcHMgPSA4O1xuICAgICAgU2V0dGluZ3MyLm1heFRPSUNvbnRhY3RzID0gMzI7XG4gICAgICBTZXR0aW5nczIubWF4VE9JSXRlcmF0aW9ucyA9IDIwO1xuICAgICAgU2V0dGluZ3MyLm1heERpc3RhbmNlSXRlcmF0aW9ucyA9IDIwO1xuICAgICAgU2V0dGluZ3MyLnZlbG9jaXR5VGhyZXNob2xkID0gMTtcbiAgICAgIFNldHRpbmdzMi5tYXhMaW5lYXJDb3JyZWN0aW9uID0gMC4yO1xuICAgICAgU2V0dGluZ3MyLm1heEFuZ3VsYXJDb3JyZWN0aW9uID0gOCAvIDE4MCAqIG1hdGhfUEkkNjtcbiAgICAgIFNldHRpbmdzMi5tYXhUcmFuc2xhdGlvbiA9IDI7XG4gICAgICBTZXR0aW5nczIubWF4Um90YXRpb24gPSAwLjUgKiBtYXRoX1BJJDY7XG4gICAgICBTZXR0aW5nczIuYmF1bWdhcnRlID0gMC4yO1xuICAgICAgU2V0dGluZ3MyLnRvaUJhdWdhcnRlID0gMC43NTtcbiAgICAgIFNldHRpbmdzMi50aW1lVG9TbGVlcCA9IDAuNTtcbiAgICAgIFNldHRpbmdzMi5saW5lYXJTbGVlcFRvbGVyYW5jZSA9IDAuMDE7XG4gICAgICBTZXR0aW5nczIuYW5ndWxhclNsZWVwVG9sZXJhbmNlID0gMiAvIDE4MCAqIG1hdGhfUEkkNjtcbiAgICAgIHJldHVybiBTZXR0aW5nczI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBTZXR0aW5nc0ludGVybmFsID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNldHRpbmdzSW50ZXJuYWwyKCkge1xuICAgICAgfVxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heE1hbmlmb2xkUG9pbnRzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4TWFuaWZvbGRQb2ludHM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcIm1heFBvbHlnb25WZXJ0aWNlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFBvbHlnb25WZXJ0aWNlcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwiYWFiYkV4dGVuc2lvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmFhYmJFeHRlbnNpb24gKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJhYWJiTXVsdGlwbGllclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmFhYmJNdWx0aXBsaWVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJsaW5lYXJTbG9wXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubGluZWFyU2xvcCAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImxpbmVhclNsb3BTcXVhcmVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubGluZWFyU2xvcCAqIFNldHRpbmdzLmxlbmd0aFVuaXRzUGVyTWV0ZXIgKiBTZXR0aW5ncy5saW5lYXJTbG9wICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwiYW5ndWxhclNsb3BcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5hbmd1bGFyU2xvcDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwicG9seWdvblJhZGl1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIDIgKiBTZXR0aW5ncy5saW5lYXJTbG9wO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhTdWJTdGVwc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFN1YlN0ZXBzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhUT0lDb250YWN0c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFRPSUNvbnRhY3RzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhUT0lJdGVyYXRpb25zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4VE9JSXRlcmF0aW9ucztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4RGlzdGFuY2VJdGVyYXRpb25zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4RGlzdGFuY2VJdGVyYXRpb25zO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJ2ZWxvY2l0eVRocmVzaG9sZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLnZlbG9jaXR5VGhyZXNob2xkICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4TGluZWFyQ29ycmVjdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heExpbmVhckNvcnJlY3Rpb24gKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhBbmd1bGFyQ29ycmVjdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heEFuZ3VsYXJDb3JyZWN0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhUcmFuc2xhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFRyYW5zbGF0aW9uICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwibWF4VHJhbnNsYXRpb25TcXVhcmVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubWF4VHJhbnNsYXRpb24gKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyICogU2V0dGluZ3MubWF4VHJhbnNsYXRpb24gKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhSb3RhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLm1heFJvdGF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJtYXhSb3RhdGlvblNxdWFyZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5tYXhSb3RhdGlvbiAqIFNldHRpbmdzLm1heFJvdGF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJiYXVtZ2FydGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5iYXVtZ2FydGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcInRvaUJhdWdhcnRlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MudG9pQmF1Z2FydGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcInRpbWVUb1NsZWVwXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MudGltZVRvU2xlZXA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNldHRpbmdzSW50ZXJuYWwyLCBcImxpbmVhclNsZWVwVG9sZXJhbmNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MubGluZWFyU2xlZXBUb2xlcmFuY2UgKiBTZXR0aW5ncy5sZW5ndGhVbml0c1Blck1ldGVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJsaW5lYXJTbGVlcFRvbGVyYW5jZVNxclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIFNldHRpbmdzLmxpbmVhclNsZWVwVG9sZXJhbmNlICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlciAqIFNldHRpbmdzLmxpbmVhclNsZWVwVG9sZXJhbmNlICogU2V0dGluZ3MubGVuZ3RoVW5pdHNQZXJNZXRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0dGluZ3NJbnRlcm5hbDIsIFwiYW5ndWxhclNsZWVwVG9sZXJhbmNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gU2V0dGluZ3MuYW5ndWxhclNsZWVwVG9sZXJhbmNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXR0aW5nc0ludGVybmFsMiwgXCJhbmd1bGFyU2xlZXBUb2xlcmFuY2VTcXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5hbmd1bGFyU2xlZXBUb2xlcmFuY2UgKiBTZXR0aW5ncy5hbmd1bGFyU2xlZXBUb2xlcmFuY2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIFNldHRpbmdzSW50ZXJuYWwyO1xuICAgIH0oKVxuICApO1xuICB2YXIgUG9vbCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBQb29sMihvcHRzKSB7XG4gICAgICAgIHRoaXMuX2xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5fbWF4ID0gSW5maW5pdHk7XG4gICAgICAgIHRoaXMuX2hhc0NyZWF0ZUZuID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2NyZWF0ZUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5faGFzQWxsb2NhdGVGbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9hbGxvY2F0ZUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5faGFzUmVsZWFzZUZuID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3JlbGVhc2VDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuX2hhc0Rpc3Bvc2VGbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9kaXNwb3NlQ291bnQgPSAwO1xuICAgICAgICB0aGlzLl9saXN0ID0gW107XG4gICAgICAgIHRoaXMuX21heCA9IG9wdHMubWF4IHx8IHRoaXMuX21heDtcbiAgICAgICAgdGhpcy5fY3JlYXRlRm4gPSBvcHRzLmNyZWF0ZTtcbiAgICAgICAgdGhpcy5faGFzQ3JlYXRlRm4gPSB0eXBlb2YgdGhpcy5fY3JlYXRlRm4gPT09IFwiZnVuY3Rpb25cIjtcbiAgICAgICAgdGhpcy5fYWxsb2NhdGVGbiA9IG9wdHMuYWxsb2NhdGU7XG4gICAgICAgIHRoaXMuX2hhc0FsbG9jYXRlRm4gPSB0eXBlb2YgdGhpcy5fYWxsb2NhdGVGbiA9PT0gXCJmdW5jdGlvblwiO1xuICAgICAgICB0aGlzLl9yZWxlYXNlRm4gPSBvcHRzLnJlbGVhc2U7XG4gICAgICAgIHRoaXMuX2hhc1JlbGVhc2VGbiA9IHR5cGVvZiB0aGlzLl9yZWxlYXNlRm4gPT09IFwiZnVuY3Rpb25cIjtcbiAgICAgICAgdGhpcy5fZGlzcG9zZUZuID0gb3B0cy5kaXNwb3NlO1xuICAgICAgICB0aGlzLl9oYXNEaXNwb3NlRm4gPSB0eXBlb2YgdGhpcy5fZGlzcG9zZUZuID09PSBcImZ1bmN0aW9uXCI7XG4gICAgICB9XG4gICAgICBQb29sMi5wcm90b3R5cGUubWF4ID0gZnVuY3Rpb24objIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBuMiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHRoaXMuX21heCA9IG4yO1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9tYXg7XG4gICAgICB9O1xuICAgICAgUG9vbDIucHJvdG90eXBlLnNpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xpc3QubGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIFBvb2wyLnByb3RvdHlwZS5hbGxvY2F0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaXRlbTtcbiAgICAgICAgaWYgKHRoaXMuX2xpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGl0ZW0gPSB0aGlzLl9saXN0LnNoaWZ0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fY3JlYXRlQ291bnQrKztcbiAgICAgICAgICBpZiAodGhpcy5faGFzQ3JlYXRlRm4pIHtcbiAgICAgICAgICAgIGl0ZW0gPSB0aGlzLl9jcmVhdGVGbigpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpdGVtID0ge307XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FsbG9jYXRlQ291bnQrKztcbiAgICAgICAgaWYgKHRoaXMuX2hhc0FsbG9jYXRlRm4pIHtcbiAgICAgICAgICB0aGlzLl9hbGxvY2F0ZUZuKGl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgfTtcbiAgICAgIFBvb2wyLnByb3RvdHlwZS5yZWxlYXNlID0gZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBpZiAodGhpcy5fbGlzdC5sZW5ndGggPCB0aGlzLl9tYXgpIHtcbiAgICAgICAgICB0aGlzLl9yZWxlYXNlQ291bnQrKztcbiAgICAgICAgICBpZiAodGhpcy5faGFzUmVsZWFzZUZuKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWxlYXNlRm4oaXRlbSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX2xpc3QucHVzaChpdGVtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9kaXNwb3NlQ291bnQrKztcbiAgICAgICAgICBpZiAodGhpcy5faGFzRGlzcG9zZUZuKSB7XG4gICAgICAgICAgICBpdGVtID0gdGhpcy5fZGlzcG9zZUZuKGl0ZW0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFBvb2wyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gXCIgK1wiICsgdGhpcy5fY3JlYXRlQ291bnQgKyBcIiA+XCIgKyB0aGlzLl9hbGxvY2F0ZUNvdW50ICsgXCIgPFwiICsgdGhpcy5fcmVsZWFzZUNvdW50ICsgXCIgLVwiICsgdGhpcy5fZGlzcG9zZUNvdW50ICsgXCIgPVwiICsgdGhpcy5fbGlzdC5sZW5ndGggKyBcIi9cIiArIHRoaXMuX21heDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gUG9vbDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX2FicyQ4ID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX21heCQ2ID0gTWF0aC5tYXg7XG4gIHZhciBUcmVlTm9kZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBUcmVlTm9kZTIoaWQpIHtcbiAgICAgICAgdGhpcy5hYWJiID0gbmV3IEFBQkIoKTtcbiAgICAgICAgdGhpcy51c2VyRGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMucGFyZW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5jaGlsZDEgPSBudWxsO1xuICAgICAgICB0aGlzLmNoaWxkMiA9IG51bGw7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gLTE7XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgIH1cbiAgICAgIFRyZWVOb2RlMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaWQgKyBcIjogXCIgKyB0aGlzLnVzZXJEYXRhO1xuICAgICAgfTtcbiAgICAgIFRyZWVOb2RlMi5wcm90b3R5cGUuaXNMZWFmID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkMSA9PSBudWxsO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBUcmVlTm9kZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBwb29sVHJlZU5vZGUgPSBuZXcgUG9vbCh7XG4gICAgY3JlYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBuZXcgVHJlZU5vZGUoKTtcbiAgICB9LFxuICAgIHJlbGVhc2U6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIG5vZGUudXNlckRhdGEgPSBudWxsO1xuICAgICAgbm9kZS5wYXJlbnQgPSBudWxsO1xuICAgICAgbm9kZS5jaGlsZDEgPSBudWxsO1xuICAgICAgbm9kZS5jaGlsZDIgPSBudWxsO1xuICAgICAgbm9kZS5oZWlnaHQgPSAtMTtcbiAgICAgIG5vZGUuaWQgPSB2b2lkIDA7XG4gICAgfVxuICB9KTtcbiAgdmFyIER5bmFtaWNUcmVlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIER5bmFtaWNUcmVlMigpIHtcbiAgICAgICAgdGhpcy5pbnB1dFBvb2wgPSBuZXcgUG9vbCh7XG4gICAgICAgICAgY3JlYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlbGVhc2U6IGZ1bmN0aW9uKHN0YWNrKSB7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdGFja1Bvb2wgPSBuZXcgUG9vbCh7XG4gICAgICAgICAgY3JlYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlbGVhc2U6IGZ1bmN0aW9uKHN0YWNrKSB7XG4gICAgICAgICAgICBzdGFjay5sZW5ndGggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaXRlcmF0b3JQb29sID0gbmV3IFBvb2woe1xuICAgICAgICAgIGNyZWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEl0ZXJhdG9yKCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZWxlYXNlOiBmdW5jdGlvbihpdGVyYXRvcikge1xuICAgICAgICAgICAgaXRlcmF0b3IuY2xvc2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm1fcm9vdCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9ub2RlcyA9IHt9O1xuICAgICAgICB0aGlzLm1fbGFzdFByb3h5SWQgPSAwO1xuICAgICAgfVxuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5nZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5tX25vZGVzW2lkXTtcbiAgICAgICAgcmV0dXJuIG5vZGUudXNlckRhdGE7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5nZXRGYXRBQUJCID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fbm9kZXNbaWRdO1xuICAgICAgICByZXR1cm4gbm9kZS5hYWJiO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuYWxsb2NhdGVOb2RlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBub2RlID0gcG9vbFRyZWVOb2RlLmFsbG9jYXRlKCk7XG4gICAgICAgIG5vZGUuaWQgPSArK3RoaXMubV9sYXN0UHJveHlJZDtcbiAgICAgICAgdGhpcy5tX25vZGVzW25vZGUuaWRdID0gbm9kZTtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5mcmVlTm9kZSA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMubV9ub2Rlc1tub2RlLmlkXTtcbiAgICAgICAgcG9vbFRyZWVOb2RlLnJlbGVhc2Uobm9kZSk7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5jcmVhdGVQcm94eSA9IGZ1bmN0aW9uKGFhYmIsIHVzZXJEYXRhKSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5hbGxvY2F0ZU5vZGUoKTtcbiAgICAgICAgbm9kZS5hYWJiLnNldChhYWJiKTtcbiAgICAgICAgQUFCQi5leHRlbmQobm9kZS5hYWJiLCBTZXR0aW5nc0ludGVybmFsLmFhYmJFeHRlbnNpb24pO1xuICAgICAgICBub2RlLnVzZXJEYXRhID0gdXNlckRhdGE7XG4gICAgICAgIG5vZGUuaGVpZ2h0ID0gMDtcbiAgICAgICAgdGhpcy5pbnNlcnRMZWFmKG5vZGUpO1xuICAgICAgICByZXR1cm4gbm9kZS5pZDtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmRlc3Ryb3lQcm94eSA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5tX25vZGVzW2lkXTtcbiAgICAgICAgdGhpcy5yZW1vdmVMZWFmKG5vZGUpO1xuICAgICAgICB0aGlzLmZyZWVOb2RlKG5vZGUpO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUubW92ZVByb3h5ID0gZnVuY3Rpb24oaWQsIGFhYmIsIGQyKSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5tX25vZGVzW2lkXTtcbiAgICAgICAgaWYgKG5vZGUuYWFiYi5jb250YWlucyhhYWJiKSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbW92ZUxlYWYobm9kZSk7XG4gICAgICAgIG5vZGUuYWFiYi5zZXQoYWFiYik7XG4gICAgICAgIGFhYmIgPSBub2RlLmFhYmI7XG4gICAgICAgIEFBQkIuZXh0ZW5kKGFhYmIsIFNldHRpbmdzSW50ZXJuYWwuYWFiYkV4dGVuc2lvbik7XG4gICAgICAgIGlmIChkMi54IDwgMCkge1xuICAgICAgICAgIGFhYmIubG93ZXJCb3VuZC54ICs9IGQyLnggKiBTZXR0aW5nc0ludGVybmFsLmFhYmJNdWx0aXBsaWVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFhYmIudXBwZXJCb3VuZC54ICs9IGQyLnggKiBTZXR0aW5nc0ludGVybmFsLmFhYmJNdWx0aXBsaWVyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkMi55IDwgMCkge1xuICAgICAgICAgIGFhYmIubG93ZXJCb3VuZC55ICs9IGQyLnkgKiBTZXR0aW5nc0ludGVybmFsLmFhYmJNdWx0aXBsaWVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFhYmIudXBwZXJCb3VuZC55ICs9IGQyLnkgKiBTZXR0aW5nc0ludGVybmFsLmFhYmJNdWx0aXBsaWVyO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5zZXJ0TGVhZihub2RlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5pbnNlcnRMZWFmID0gZnVuY3Rpb24obGVhZikge1xuICAgICAgICBpZiAodGhpcy5tX3Jvb3QgPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMubV9yb290ID0gbGVhZjtcbiAgICAgICAgICB0aGlzLm1fcm9vdC5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGVhZkFBQkIgPSBsZWFmLmFhYmI7XG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMubV9yb290O1xuICAgICAgICB3aGlsZSAoIWluZGV4LmlzTGVhZigpKSB7XG4gICAgICAgICAgdmFyIGNoaWxkMSA9IGluZGV4LmNoaWxkMTtcbiAgICAgICAgICB2YXIgY2hpbGQyID0gaW5kZXguY2hpbGQyO1xuICAgICAgICAgIHZhciBhcmVhID0gaW5kZXguYWFiYi5nZXRQZXJpbWV0ZXIoKTtcbiAgICAgICAgICB2YXIgY29tYmluZWRBcmVhID0gQUFCQi5jb21iaW5lZFBlcmltZXRlcihpbmRleC5hYWJiLCBsZWFmQUFCQik7XG4gICAgICAgICAgdmFyIGNvc3QgPSAyICogY29tYmluZWRBcmVhO1xuICAgICAgICAgIHZhciBpbmhlcml0YW5jZUNvc3QgPSAyICogKGNvbWJpbmVkQXJlYSAtIGFyZWEpO1xuICAgICAgICAgIHZhciBuZXdBcmVhMSA9IEFBQkIuY29tYmluZWRQZXJpbWV0ZXIobGVhZkFBQkIsIGNoaWxkMS5hYWJiKTtcbiAgICAgICAgICB2YXIgY29zdDEgPSBuZXdBcmVhMSArIGluaGVyaXRhbmNlQ29zdDtcbiAgICAgICAgICBpZiAoIWNoaWxkMS5pc0xlYWYoKSkge1xuICAgICAgICAgICAgdmFyIG9sZEFyZWEgPSBjaGlsZDEuYWFiYi5nZXRQZXJpbWV0ZXIoKTtcbiAgICAgICAgICAgIGNvc3QxIC09IG9sZEFyZWE7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBuZXdBcmVhMiA9IEFBQkIuY29tYmluZWRQZXJpbWV0ZXIobGVhZkFBQkIsIGNoaWxkMi5hYWJiKTtcbiAgICAgICAgICB2YXIgY29zdDIgPSBuZXdBcmVhMiArIGluaGVyaXRhbmNlQ29zdDtcbiAgICAgICAgICBpZiAoIWNoaWxkMi5pc0xlYWYoKSkge1xuICAgICAgICAgICAgdmFyIG9sZEFyZWEgPSBjaGlsZDIuYWFiYi5nZXRQZXJpbWV0ZXIoKTtcbiAgICAgICAgICAgIGNvc3QyIC09IG9sZEFyZWE7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjb3N0IDwgY29zdDEgJiYgY29zdCA8IGNvc3QyKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNvc3QxIDwgY29zdDIpIHtcbiAgICAgICAgICAgIGluZGV4ID0gY2hpbGQxO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbmRleCA9IGNoaWxkMjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNpYmxpbmcgPSBpbmRleDtcbiAgICAgICAgdmFyIG9sZFBhcmVudCA9IHNpYmxpbmcucGFyZW50O1xuICAgICAgICB2YXIgbmV3UGFyZW50ID0gdGhpcy5hbGxvY2F0ZU5vZGUoKTtcbiAgICAgICAgbmV3UGFyZW50LnBhcmVudCA9IG9sZFBhcmVudDtcbiAgICAgICAgbmV3UGFyZW50LnVzZXJEYXRhID0gbnVsbDtcbiAgICAgICAgbmV3UGFyZW50LmFhYmIuY29tYmluZShsZWFmQUFCQiwgc2libGluZy5hYWJiKTtcbiAgICAgICAgbmV3UGFyZW50LmhlaWdodCA9IHNpYmxpbmcuaGVpZ2h0ICsgMTtcbiAgICAgICAgaWYgKG9sZFBhcmVudCAhPSBudWxsKSB7XG4gICAgICAgICAgaWYgKG9sZFBhcmVudC5jaGlsZDEgPT09IHNpYmxpbmcpIHtcbiAgICAgICAgICAgIG9sZFBhcmVudC5jaGlsZDEgPSBuZXdQYXJlbnQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG9sZFBhcmVudC5jaGlsZDIgPSBuZXdQYXJlbnQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIG5ld1BhcmVudC5jaGlsZDEgPSBzaWJsaW5nO1xuICAgICAgICAgIG5ld1BhcmVudC5jaGlsZDIgPSBsZWFmO1xuICAgICAgICAgIHNpYmxpbmcucGFyZW50ID0gbmV3UGFyZW50O1xuICAgICAgICAgIGxlYWYucGFyZW50ID0gbmV3UGFyZW50O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld1BhcmVudC5jaGlsZDEgPSBzaWJsaW5nO1xuICAgICAgICAgIG5ld1BhcmVudC5jaGlsZDIgPSBsZWFmO1xuICAgICAgICAgIHNpYmxpbmcucGFyZW50ID0gbmV3UGFyZW50O1xuICAgICAgICAgIGxlYWYucGFyZW50ID0gbmV3UGFyZW50O1xuICAgICAgICAgIHRoaXMubV9yb290ID0gbmV3UGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIGluZGV4ID0gbGVhZi5wYXJlbnQ7XG4gICAgICAgIHdoaWxlIChpbmRleCAhPSBudWxsKSB7XG4gICAgICAgICAgaW5kZXggPSB0aGlzLmJhbGFuY2UoaW5kZXgpO1xuICAgICAgICAgIHZhciBjaGlsZDEgPSBpbmRleC5jaGlsZDE7XG4gICAgICAgICAgdmFyIGNoaWxkMiA9IGluZGV4LmNoaWxkMjtcbiAgICAgICAgICBpbmRleC5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihjaGlsZDEuaGVpZ2h0LCBjaGlsZDIuaGVpZ2h0KTtcbiAgICAgICAgICBpbmRleC5hYWJiLmNvbWJpbmUoY2hpbGQxLmFhYmIsIGNoaWxkMi5hYWJiKTtcbiAgICAgICAgICBpbmRleCA9IGluZGV4LnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUucmVtb3ZlTGVhZiA9IGZ1bmN0aW9uKGxlYWYpIHtcbiAgICAgICAgaWYgKGxlYWYgPT09IHRoaXMubV9yb290KSB7XG4gICAgICAgICAgdGhpcy5tX3Jvb3QgPSBudWxsO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyZW50ID0gbGVhZi5wYXJlbnQ7XG4gICAgICAgIHZhciBncmFuZFBhcmVudCA9IHBhcmVudC5wYXJlbnQ7XG4gICAgICAgIHZhciBzaWJsaW5nO1xuICAgICAgICBpZiAocGFyZW50LmNoaWxkMSA9PT0gbGVhZikge1xuICAgICAgICAgIHNpYmxpbmcgPSBwYXJlbnQuY2hpbGQyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNpYmxpbmcgPSBwYXJlbnQuY2hpbGQxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChncmFuZFBhcmVudCAhPSBudWxsKSB7XG4gICAgICAgICAgaWYgKGdyYW5kUGFyZW50LmNoaWxkMSA9PT0gcGFyZW50KSB7XG4gICAgICAgICAgICBncmFuZFBhcmVudC5jaGlsZDEgPSBzaWJsaW5nO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBncmFuZFBhcmVudC5jaGlsZDIgPSBzaWJsaW5nO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzaWJsaW5nLnBhcmVudCA9IGdyYW5kUGFyZW50O1xuICAgICAgICAgIHRoaXMuZnJlZU5vZGUocGFyZW50KTtcbiAgICAgICAgICB2YXIgaW5kZXggPSBncmFuZFBhcmVudDtcbiAgICAgICAgICB3aGlsZSAoaW5kZXggIT0gbnVsbCkge1xuICAgICAgICAgICAgaW5kZXggPSB0aGlzLmJhbGFuY2UoaW5kZXgpO1xuICAgICAgICAgICAgdmFyIGNoaWxkMSA9IGluZGV4LmNoaWxkMTtcbiAgICAgICAgICAgIHZhciBjaGlsZDIgPSBpbmRleC5jaGlsZDI7XG4gICAgICAgICAgICBpbmRleC5hYWJiLmNvbWJpbmUoY2hpbGQxLmFhYmIsIGNoaWxkMi5hYWJiKTtcbiAgICAgICAgICAgIGluZGV4LmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KGNoaWxkMS5oZWlnaHQsIGNoaWxkMi5oZWlnaHQpO1xuICAgICAgICAgICAgaW5kZXggPSBpbmRleC5wYXJlbnQ7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9yb290ID0gc2libGluZztcbiAgICAgICAgICBzaWJsaW5nLnBhcmVudCA9IG51bGw7XG4gICAgICAgICAgdGhpcy5mcmVlTm9kZShwYXJlbnQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5iYWxhbmNlID0gZnVuY3Rpb24oaUEpIHtcbiAgICAgICAgdmFyIEEgPSBpQTtcbiAgICAgICAgaWYgKEEuaXNMZWFmKCkgfHwgQS5oZWlnaHQgPCAyKSB7XG4gICAgICAgICAgcmV0dXJuIGlBO1xuICAgICAgICB9XG4gICAgICAgIHZhciBCID0gQS5jaGlsZDE7XG4gICAgICAgIHZhciBDID0gQS5jaGlsZDI7XG4gICAgICAgIHZhciBiYWxhbmNlID0gQy5oZWlnaHQgLSBCLmhlaWdodDtcbiAgICAgICAgaWYgKGJhbGFuY2UgPiAxKSB7XG4gICAgICAgICAgdmFyIEYgPSBDLmNoaWxkMTtcbiAgICAgICAgICB2YXIgRyA9IEMuY2hpbGQyO1xuICAgICAgICAgIEMuY2hpbGQxID0gQTtcbiAgICAgICAgICBDLnBhcmVudCA9IEEucGFyZW50O1xuICAgICAgICAgIEEucGFyZW50ID0gQztcbiAgICAgICAgICBpZiAoQy5wYXJlbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKEMucGFyZW50LmNoaWxkMSA9PT0gaUEpIHtcbiAgICAgICAgICAgICAgQy5wYXJlbnQuY2hpbGQxID0gQztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIEMucGFyZW50LmNoaWxkMiA9IEM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV9yb290ID0gQztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKEYuaGVpZ2h0ID4gRy5oZWlnaHQpIHtcbiAgICAgICAgICAgIEMuY2hpbGQyID0gRjtcbiAgICAgICAgICAgIEEuY2hpbGQyID0gRztcbiAgICAgICAgICAgIEcucGFyZW50ID0gQTtcbiAgICAgICAgICAgIEEuYWFiYi5jb21iaW5lKEIuYWFiYiwgRy5hYWJiKTtcbiAgICAgICAgICAgIEMuYWFiYi5jb21iaW5lKEEuYWFiYiwgRi5hYWJiKTtcbiAgICAgICAgICAgIEEuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoQi5oZWlnaHQsIEcuaGVpZ2h0KTtcbiAgICAgICAgICAgIEMuaGVpZ2h0ID0gMSArIG1hdGhfbWF4JDYoQS5oZWlnaHQsIEYuaGVpZ2h0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgQy5jaGlsZDIgPSBHO1xuICAgICAgICAgICAgQS5jaGlsZDIgPSBGO1xuICAgICAgICAgICAgRi5wYXJlbnQgPSBBO1xuICAgICAgICAgICAgQS5hYWJiLmNvbWJpbmUoQi5hYWJiLCBGLmFhYmIpO1xuICAgICAgICAgICAgQy5hYWJiLmNvbWJpbmUoQS5hYWJiLCBHLmFhYmIpO1xuICAgICAgICAgICAgQS5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihCLmhlaWdodCwgRi5oZWlnaHQpO1xuICAgICAgICAgICAgQy5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihBLmhlaWdodCwgRy5oZWlnaHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gQztcbiAgICAgICAgfVxuICAgICAgICBpZiAoYmFsYW5jZSA8IC0xKSB7XG4gICAgICAgICAgdmFyIEQgPSBCLmNoaWxkMTtcbiAgICAgICAgICB2YXIgRSA9IEIuY2hpbGQyO1xuICAgICAgICAgIEIuY2hpbGQxID0gQTtcbiAgICAgICAgICBCLnBhcmVudCA9IEEucGFyZW50O1xuICAgICAgICAgIEEucGFyZW50ID0gQjtcbiAgICAgICAgICBpZiAoQi5wYXJlbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKEIucGFyZW50LmNoaWxkMSA9PT0gQSkge1xuICAgICAgICAgICAgICBCLnBhcmVudC5jaGlsZDEgPSBCO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgQi5wYXJlbnQuY2hpbGQyID0gQjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX3Jvb3QgPSBCO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoRC5oZWlnaHQgPiBFLmhlaWdodCkge1xuICAgICAgICAgICAgQi5jaGlsZDIgPSBEO1xuICAgICAgICAgICAgQS5jaGlsZDEgPSBFO1xuICAgICAgICAgICAgRS5wYXJlbnQgPSBBO1xuICAgICAgICAgICAgQS5hYWJiLmNvbWJpbmUoQy5hYWJiLCBFLmFhYmIpO1xuICAgICAgICAgICAgQi5hYWJiLmNvbWJpbmUoQS5hYWJiLCBELmFhYmIpO1xuICAgICAgICAgICAgQS5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihDLmhlaWdodCwgRS5oZWlnaHQpO1xuICAgICAgICAgICAgQi5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihBLmhlaWdodCwgRC5oZWlnaHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBCLmNoaWxkMiA9IEU7XG4gICAgICAgICAgICBBLmNoaWxkMSA9IEQ7XG4gICAgICAgICAgICBELnBhcmVudCA9IEE7XG4gICAgICAgICAgICBBLmFhYmIuY29tYmluZShDLmFhYmIsIEQuYWFiYik7XG4gICAgICAgICAgICBCLmFhYmIuY29tYmluZShBLmFhYmIsIEUuYWFiYik7XG4gICAgICAgICAgICBBLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KEMuaGVpZ2h0LCBELmhlaWdodCk7XG4gICAgICAgICAgICBCLmhlaWdodCA9IDEgKyBtYXRoX21heCQ2KEEuaGVpZ2h0LCBFLmhlaWdodCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBCO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBBO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm1fcm9vdCA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubV9yb290LmhlaWdodDtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLmdldEFyZWFSYXRpbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5tX3Jvb3QgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciByb290ID0gdGhpcy5tX3Jvb3Q7XG4gICAgICAgIHZhciByb290QXJlYSA9IHJvb3QuYWFiYi5nZXRQZXJpbWV0ZXIoKTtcbiAgICAgICAgdmFyIHRvdGFsQXJlYSA9IDA7XG4gICAgICAgIHZhciBub2RlO1xuICAgICAgICB2YXIgaXQgPSB0aGlzLml0ZXJhdG9yUG9vbC5hbGxvY2F0ZSgpLnByZW9yZGVyKHRoaXMubV9yb290KTtcbiAgICAgICAgd2hpbGUgKG5vZGUgPSBpdC5uZXh0KCkpIHtcbiAgICAgICAgICBpZiAobm9kZS5oZWlnaHQgPCAwKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdG90YWxBcmVhICs9IG5vZGUuYWFiYi5nZXRQZXJpbWV0ZXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLml0ZXJhdG9yUG9vbC5yZWxlYXNlKGl0KTtcbiAgICAgICAgcmV0dXJuIHRvdGFsQXJlYSAvIHJvb3RBcmVhO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuY29tcHV0ZUhlaWdodCA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHZhciBub2RlO1xuICAgICAgICBpZiAodHlwZW9mIGlkICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgbm9kZSA9IHRoaXMubV9ub2Rlc1tpZF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm9kZSA9IHRoaXMubV9yb290O1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlLmlzTGVhZigpKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhlaWdodDEgPSB0aGlzLmNvbXB1dGVIZWlnaHQobm9kZS5jaGlsZDEuaWQpO1xuICAgICAgICB2YXIgaGVpZ2h0MiA9IHRoaXMuY29tcHV0ZUhlaWdodChub2RlLmNoaWxkMi5pZCk7XG4gICAgICAgIHJldHVybiAxICsgbWF0aF9tYXgkNihoZWlnaHQxLCBoZWlnaHQyKTtcbiAgICAgIH07XG4gICAgICBEeW5hbWljVHJlZTIucHJvdG90eXBlLnZhbGlkYXRlU3RydWN0dXJlID0gZnVuY3Rpb24obm9kZSkge1xuICAgICAgICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlID09PSB0aGlzLm1fcm9vdCkgO1xuICAgICAgICB2YXIgY2hpbGQxID0gbm9kZS5jaGlsZDE7XG4gICAgICAgIHZhciBjaGlsZDIgPSBub2RlLmNoaWxkMjtcbiAgICAgICAgaWYgKG5vZGUuaXNMZWFmKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52YWxpZGF0ZVN0cnVjdHVyZShjaGlsZDEpO1xuICAgICAgICB0aGlzLnZhbGlkYXRlU3RydWN0dXJlKGNoaWxkMik7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS52YWxpZGF0ZU1ldHJpY3MgPSBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIGlmIChub2RlID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkMSA9IG5vZGUuY2hpbGQxO1xuICAgICAgICB2YXIgY2hpbGQyID0gbm9kZS5jaGlsZDI7XG4gICAgICAgIGlmIChub2RlLmlzTGVhZigpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFsaWRhdGVNZXRyaWNzKGNoaWxkMSk7XG4gICAgICAgIHRoaXMudmFsaWRhdGVNZXRyaWNzKGNoaWxkMik7XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9O1xuICAgICAgRHluYW1pY1RyZWUyLnByb3RvdHlwZS5nZXRNYXhCYWxhbmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBtYXhCYWxhbmNlID0gMDtcbiAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgIHZhciBpdCA9IHRoaXMuaXRlcmF0b3JQb29sLmFsbG9jYXRlKCkucHJlb3JkZXIodGhpcy5tX3Jvb3QpO1xuICAgICAgICB3aGlsZSAobm9kZSA9IGl0Lm5leHQoKSkge1xuICAgICAgICAgIGlmIChub2RlLmhlaWdodCA8PSAxKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGJhbGFuY2UgPSBtYXRoX2FicyQ4KG5vZGUuY2hpbGQyLmhlaWdodCAtIG5vZGUuY2hpbGQxLmhlaWdodCk7XG4gICAgICAgICAgbWF4QmFsYW5jZSA9IG1hdGhfbWF4JDYobWF4QmFsYW5jZSwgYmFsYW5jZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVyYXRvclBvb2wucmVsZWFzZShpdCk7XG4gICAgICAgIHJldHVybiBtYXhCYWxhbmNlO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUucmVidWlsZEJvdHRvbVVwID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBub2RlcyA9IFtdO1xuICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgdmFyIGl0ID0gdGhpcy5pdGVyYXRvclBvb2wuYWxsb2NhdGUoKS5wcmVvcmRlcih0aGlzLm1fcm9vdCk7XG4gICAgICAgIHdoaWxlIChub2RlID0gaXQubmV4dCgpKSB7XG4gICAgICAgICAgaWYgKG5vZGUuaGVpZ2h0IDwgMCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChub2RlLmlzTGVhZigpKSB7XG4gICAgICAgICAgICBub2RlLnBhcmVudCA9IG51bGw7XG4gICAgICAgICAgICBub2Rlc1tjb3VudF0gPSBub2RlO1xuICAgICAgICAgICAgKytjb3VudDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5mcmVlTm9kZShub2RlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVyYXRvclBvb2wucmVsZWFzZShpdCk7XG4gICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHtcbiAgICAgICAgICB2YXIgbWluQ29zdCA9IEluZmluaXR5O1xuICAgICAgICAgIHZhciBpTWluID0gLTE7XG4gICAgICAgICAgdmFyIGpNaW4gPSAtMTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyArK2kpIHtcbiAgICAgICAgICAgIHZhciBhYWJiaSA9IG5vZGVzW2ldLmFhYmI7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gaSArIDE7IGogPCBjb3VudDsgKytqKSB7XG4gICAgICAgICAgICAgIHZhciBhYWJiaiA9IG5vZGVzW2pdLmFhYmI7XG4gICAgICAgICAgICAgIHZhciBjb3N0ID0gQUFCQi5jb21iaW5lZFBlcmltZXRlcihhYWJiaSwgYWFiYmopO1xuICAgICAgICAgICAgICBpZiAoY29zdCA8IG1pbkNvc3QpIHtcbiAgICAgICAgICAgICAgICBpTWluID0gaTtcbiAgICAgICAgICAgICAgICBqTWluID0gajtcbiAgICAgICAgICAgICAgICBtaW5Db3N0ID0gY29zdDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgY2hpbGQxID0gbm9kZXNbaU1pbl07XG4gICAgICAgICAgdmFyIGNoaWxkMiA9IG5vZGVzW2pNaW5dO1xuICAgICAgICAgIHZhciBwYXJlbnRfMSA9IHRoaXMuYWxsb2NhdGVOb2RlKCk7XG4gICAgICAgICAgcGFyZW50XzEuY2hpbGQxID0gY2hpbGQxO1xuICAgICAgICAgIHBhcmVudF8xLmNoaWxkMiA9IGNoaWxkMjtcbiAgICAgICAgICBwYXJlbnRfMS5oZWlnaHQgPSAxICsgbWF0aF9tYXgkNihjaGlsZDEuaGVpZ2h0LCBjaGlsZDIuaGVpZ2h0KTtcbiAgICAgICAgICBwYXJlbnRfMS5hYWJiLmNvbWJpbmUoY2hpbGQxLmFhYmIsIGNoaWxkMi5hYWJiKTtcbiAgICAgICAgICBwYXJlbnRfMS5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgIGNoaWxkMS5wYXJlbnQgPSBwYXJlbnRfMTtcbiAgICAgICAgICBjaGlsZDIucGFyZW50ID0gcGFyZW50XzE7XG4gICAgICAgICAgbm9kZXNbak1pbl0gPSBub2Rlc1tjb3VudCAtIDFdO1xuICAgICAgICAgIG5vZGVzW2lNaW5dID0gcGFyZW50XzE7XG4gICAgICAgICAgLS1jb3VudDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fcm9vdCA9IG5vZGVzWzBdO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUuc2hpZnRPcmlnaW4gPSBmdW5jdGlvbihuZXdPcmlnaW4pIHtcbiAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgIHZhciBpdCA9IHRoaXMuaXRlcmF0b3JQb29sLmFsbG9jYXRlKCkucHJlb3JkZXIodGhpcy5tX3Jvb3QpO1xuICAgICAgICB3aGlsZSAobm9kZSA9IGl0Lm5leHQoKSkge1xuICAgICAgICAgIHZhciBhYWJiID0gbm9kZS5hYWJiO1xuICAgICAgICAgIGFhYmIubG93ZXJCb3VuZC54IC09IG5ld09yaWdpbi54O1xuICAgICAgICAgIGFhYmIubG93ZXJCb3VuZC55IC09IG5ld09yaWdpbi55O1xuICAgICAgICAgIGFhYmIudXBwZXJCb3VuZC54IC09IG5ld09yaWdpbi54O1xuICAgICAgICAgIGFhYmIudXBwZXJCb3VuZC55IC09IG5ld09yaWdpbi55O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXRlcmF0b3JQb29sLnJlbGVhc2UoaXQpO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUucXVlcnkgPSBmdW5jdGlvbihhYWJiLCBxdWVyeUNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBzdGFjayA9IHRoaXMuc3RhY2tQb29sLmFsbG9jYXRlKCk7XG4gICAgICAgIHN0YWNrLnB1c2godGhpcy5tX3Jvb3QpO1xuICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZhciBub2RlID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChBQUJCLnRlc3RPdmVybGFwKG5vZGUuYWFiYiwgYWFiYikpIHtcbiAgICAgICAgICAgIGlmIChub2RlLmlzTGVhZigpKSB7XG4gICAgICAgICAgICAgIHZhciBwcm9jZWVkID0gcXVlcnlDYWxsYmFjayhub2RlLmlkKTtcbiAgICAgICAgICAgICAgaWYgKHByb2NlZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzdGFjay5wdXNoKG5vZGUuY2hpbGQxKTtcbiAgICAgICAgICAgICAgc3RhY2sucHVzaChub2RlLmNoaWxkMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhY2tQb29sLnJlbGVhc2Uoc3RhY2spO1xuICAgICAgfTtcbiAgICAgIER5bmFtaWNUcmVlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKGlucHV0MiwgcmF5Q2FzdENhbGxiYWNrKSB7XG4gICAgICAgIHZhciBwMSA9IGlucHV0Mi5wMTtcbiAgICAgICAgdmFyIHAyID0gaW5wdXQyLnAyO1xuICAgICAgICB2YXIgciA9IFZlYzIuc3ViKHAyLCBwMSk7XG4gICAgICAgIHIubm9ybWFsaXplKCk7XG4gICAgICAgIHZhciB2MyA9IFZlYzIuY3Jvc3NOdW1WZWMyKDEsIHIpO1xuICAgICAgICB2YXIgYWJzX3YgPSBWZWMyLmFicyh2Myk7XG4gICAgICAgIHZhciBtYXhGcmFjdGlvbiA9IGlucHV0Mi5tYXhGcmFjdGlvbjtcbiAgICAgICAgdmFyIHNlZ21lbnRBQUJCID0gbmV3IEFBQkIoKTtcbiAgICAgICAgdmFyIHQgPSBWZWMyLmNvbWJpbmUoMSAtIG1heEZyYWN0aW9uLCBwMSwgbWF4RnJhY3Rpb24sIHAyKTtcbiAgICAgICAgc2VnbWVudEFBQkIuY29tYmluZVBvaW50cyhwMSwgdCk7XG4gICAgICAgIHZhciBzdGFjayA9IHRoaXMuc3RhY2tQb29sLmFsbG9jYXRlKCk7XG4gICAgICAgIHZhciBzdWJJbnB1dCA9IHRoaXMuaW5wdXRQb29sLmFsbG9jYXRlKCk7XG4gICAgICAgIHN0YWNrLnB1c2godGhpcy5tX3Jvb3QpO1xuICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZhciBub2RlID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChBQUJCLnRlc3RPdmVybGFwKG5vZGUuYWFiYiwgc2VnbWVudEFBQkIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjMiA9IG5vZGUuYWFiYi5nZXRDZW50ZXIoKTtcbiAgICAgICAgICB2YXIgaCA9IG5vZGUuYWFiYi5nZXRFeHRlbnRzKCk7XG4gICAgICAgICAgdmFyIHNlcGFyYXRpb24gPSBtYXRoX2FicyQ4KFZlYzIuZG90KHYzLCBWZWMyLnN1YihwMSwgYzIpKSkgLSBWZWMyLmRvdChhYnNfdiwgaCk7XG4gICAgICAgICAgaWYgKHNlcGFyYXRpb24gPiAwKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG5vZGUuaXNMZWFmKCkpIHtcbiAgICAgICAgICAgIHN1YklucHV0LnAxID0gVmVjMi5jbG9uZShpbnB1dDIucDEpO1xuICAgICAgICAgICAgc3ViSW5wdXQucDIgPSBWZWMyLmNsb25lKGlucHV0Mi5wMik7XG4gICAgICAgICAgICBzdWJJbnB1dC5tYXhGcmFjdGlvbiA9IG1heEZyYWN0aW9uO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gcmF5Q2FzdENhbGxiYWNrKHN1YklucHV0LCBub2RlLmlkKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gMCkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPiAwKSB7XG4gICAgICAgICAgICAgIG1heEZyYWN0aW9uID0gdmFsdWU7XG4gICAgICAgICAgICAgIHQgPSBWZWMyLmNvbWJpbmUoMSAtIG1heEZyYWN0aW9uLCBwMSwgbWF4RnJhY3Rpb24sIHAyKTtcbiAgICAgICAgICAgICAgc2VnbWVudEFBQkIuY29tYmluZVBvaW50cyhwMSwgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0YWNrLnB1c2gobm9kZS5jaGlsZDEpO1xuICAgICAgICAgICAgc3RhY2sucHVzaChub2RlLmNoaWxkMik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhY2tQb29sLnJlbGVhc2Uoc3RhY2spO1xuICAgICAgICB0aGlzLmlucHV0UG9vbC5yZWxlYXNlKHN1YklucHV0KTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gRHluYW1pY1RyZWUyO1xuICAgIH0oKVxuICApO1xuICB2YXIgSXRlcmF0b3IgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gSXRlcmF0b3IyKCkge1xuICAgICAgICB0aGlzLnBhcmVudHMgPSBbXTtcbiAgICAgICAgdGhpcy5zdGF0ZXMgPSBbXTtcbiAgICAgIH1cbiAgICAgIEl0ZXJhdG9yMi5wcm90b3R5cGUucHJlb3JkZXIgPSBmdW5jdGlvbihyb290KSB7XG4gICAgICAgIHRoaXMucGFyZW50cy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLnBhcmVudHMucHVzaChyb290KTtcbiAgICAgICAgdGhpcy5zdGF0ZXMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5zdGF0ZXMucHVzaCgwKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgSXRlcmF0b3IyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHdoaWxlICh0aGlzLnBhcmVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZhciBpID0gdGhpcy5wYXJlbnRzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLnBhcmVudHNbaV07XG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGVzW2ldID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlc1tpXSA9IDE7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGVzW2ldID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlc1tpXSA9IDI7XG4gICAgICAgICAgICBpZiAobm9kZS5jaGlsZDEpIHtcbiAgICAgICAgICAgICAgdGhpcy5wYXJlbnRzLnB1c2gobm9kZS5jaGlsZDEpO1xuICAgICAgICAgICAgICB0aGlzLnN0YXRlcy5wdXNoKDEpO1xuICAgICAgICAgICAgICByZXR1cm4gbm9kZS5jaGlsZDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0aGlzLnN0YXRlc1tpXSA9PT0gMikge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZXNbaV0gPSAzO1xuICAgICAgICAgICAgaWYgKG5vZGUuY2hpbGQyKSB7XG4gICAgICAgICAgICAgIHRoaXMucGFyZW50cy5wdXNoKG5vZGUuY2hpbGQyKTtcbiAgICAgICAgICAgICAgdGhpcy5zdGF0ZXMucHVzaCgxKTtcbiAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuY2hpbGQyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnBhcmVudHMucG9wKCk7XG4gICAgICAgICAgdGhpcy5zdGF0ZXMucG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBJdGVyYXRvcjIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucGFyZW50cy5sZW5ndGggPSAwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBJdGVyYXRvcjI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX21heCQ1ID0gTWF0aC5tYXg7XG4gIHZhciBtYXRoX21pbiQ2ID0gTWF0aC5taW47XG4gIHZhciBCcm9hZFBoYXNlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEJyb2FkUGhhc2UyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLm1fdHJlZSA9IG5ldyBEeW5hbWljVHJlZSgpO1xuICAgICAgICB0aGlzLm1fbW92ZUJ1ZmZlciA9IFtdO1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gZnVuY3Rpb24oYWFiYiwgcXVlcnlDYWxsYmFjaykge1xuICAgICAgICAgIF90aGlzLm1fdHJlZS5xdWVyeShhYWJiLCBxdWVyeUNhbGxiYWNrKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5xdWVyeUNhbGxiYWNrID0gZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICAgIGlmIChwcm94eUlkID09PSBfdGhpcy5tX3F1ZXJ5UHJveHlJZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBwcm94eUlkQSA9IG1hdGhfbWluJDYocHJveHlJZCwgX3RoaXMubV9xdWVyeVByb3h5SWQpO1xuICAgICAgICAgIHZhciBwcm94eUlkQiA9IG1hdGhfbWF4JDUocHJveHlJZCwgX3RoaXMubV9xdWVyeVByb3h5SWQpO1xuICAgICAgICAgIHZhciB1c2VyRGF0YUEgPSBfdGhpcy5tX3RyZWUuZ2V0VXNlckRhdGEocHJveHlJZEEpO1xuICAgICAgICAgIHZhciB1c2VyRGF0YUIgPSBfdGhpcy5tX3RyZWUuZ2V0VXNlckRhdGEocHJveHlJZEIpO1xuICAgICAgICAgIF90aGlzLm1fY2FsbGJhY2sodXNlckRhdGFBLCB1c2VyRGF0YUIpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmdldFVzZXJEYXRhID0gZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RyZWUuZ2V0VXNlckRhdGEocHJveHlJZCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLnRlc3RPdmVybGFwID0gZnVuY3Rpb24ocHJveHlJZEEsIHByb3h5SWRCKSB7XG4gICAgICAgIHZhciBhYWJiQSA9IHRoaXMubV90cmVlLmdldEZhdEFBQkIocHJveHlJZEEpO1xuICAgICAgICB2YXIgYWFiYkIgPSB0aGlzLm1fdHJlZS5nZXRGYXRBQUJCKHByb3h5SWRCKTtcbiAgICAgICAgcmV0dXJuIEFBQkIudGVzdE92ZXJsYXAoYWFiYkEsIGFhYmJCKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuZ2V0RmF0QUFCQiA9IGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90cmVlLmdldEZhdEFBQkIocHJveHlJZCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmdldFByb3h5Q291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aDtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuZ2V0VHJlZUhlaWdodCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RyZWUuZ2V0SGVpZ2h0KCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmdldFRyZWVCYWxhbmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHJlZS5nZXRNYXhCYWxhbmNlKCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLmdldFRyZWVRdWFsaXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHJlZS5nZXRBcmVhUmF0aW8oKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKGlucHV0MiwgcmF5Q2FzdENhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMubV90cmVlLnJheUNhc3QoaW5wdXQyLCByYXlDYXN0Q2FsbGJhY2spO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5zaGlmdE9yaWdpbiA9IGZ1bmN0aW9uKG5ld09yaWdpbikge1xuICAgICAgICB0aGlzLm1fdHJlZS5zaGlmdE9yaWdpbihuZXdPcmlnaW4pO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5jcmVhdGVQcm94eSA9IGZ1bmN0aW9uKGFhYmIsIHVzZXJEYXRhKSB7XG4gICAgICAgIHZhciBwcm94eUlkID0gdGhpcy5tX3RyZWUuY3JlYXRlUHJveHkoYWFiYiwgdXNlckRhdGEpO1xuICAgICAgICB0aGlzLmJ1ZmZlck1vdmUocHJveHlJZCk7XG4gICAgICAgIHJldHVybiBwcm94eUlkO1xuICAgICAgfTtcbiAgICAgIEJyb2FkUGhhc2UyLnByb3RvdHlwZS5kZXN0cm95UHJveHkgPSBmdW5jdGlvbihwcm94eUlkKSB7XG4gICAgICAgIHRoaXMudW5idWZmZXJNb3ZlKHByb3h5SWQpO1xuICAgICAgICB0aGlzLm1fdHJlZS5kZXN0cm95UHJveHkocHJveHlJZCk7XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLm1vdmVQcm94eSA9IGZ1bmN0aW9uKHByb3h5SWQsIGFhYmIsIGRpc3BsYWNlbWVudDIpIHtcbiAgICAgICAgdmFyIGNoYW5nZWQgPSB0aGlzLm1fdHJlZS5tb3ZlUHJveHkocHJveHlJZCwgYWFiYiwgZGlzcGxhY2VtZW50Mik7XG4gICAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgICAgdGhpcy5idWZmZXJNb3ZlKHByb3h5SWQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLnRvdWNoUHJveHkgPSBmdW5jdGlvbihwcm94eUlkKSB7XG4gICAgICAgIHRoaXMuYnVmZmVyTW92ZShwcm94eUlkKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUuYnVmZmVyTW92ZSA9IGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgdGhpcy5tX21vdmVCdWZmZXIucHVzaChwcm94eUlkKTtcbiAgICAgIH07XG4gICAgICBCcm9hZFBoYXNlMi5wcm90b3R5cGUudW5idWZmZXJNb3ZlID0gZnVuY3Rpb24ocHJveHlJZCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgaWYgKHRoaXMubV9tb3ZlQnVmZmVyW2ldID09PSBwcm94eUlkKSB7XG4gICAgICAgICAgICB0aGlzLm1fbW92ZUJ1ZmZlcltpXSA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQnJvYWRQaGFzZTIucHJvdG90eXBlLnVwZGF0ZVBhaXJzID0gZnVuY3Rpb24oYWRkUGFpckNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMubV9jYWxsYmFjayA9IGFkZFBhaXJDYWxsYmFjaztcbiAgICAgICAgd2hpbGUgKHRoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fcXVlcnlQcm94eUlkID0gdGhpcy5tX21vdmVCdWZmZXIucG9wKCk7XG4gICAgICAgICAgaWYgKHRoaXMubV9xdWVyeVByb3h5SWQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgZmF0QUFCQiA9IHRoaXMubV90cmVlLmdldEZhdEFBQkIodGhpcy5tX3F1ZXJ5UHJveHlJZCk7XG4gICAgICAgICAgdGhpcy5tX3RyZWUucXVlcnkoZmF0QUFCQiwgdGhpcy5xdWVyeUNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHJldHVybiBCcm9hZFBoYXNlMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfc2luJDIgPSBNYXRoLnNpbjtcbiAgdmFyIG1hdGhfY29zJDIgPSBNYXRoLmNvcztcbiAgdmFyIG1hdGhfc3FydCQ0ID0gTWF0aC5zcXJ0O1xuICBmdW5jdGlvbiB2ZWMyKHgyLCB5KSB7XG4gICAgcmV0dXJuIHsgeDogeDIsIHkgfTtcbiAgfVxuICBmdW5jdGlvbiByb3RhdGlvbihhbmdsZSkge1xuICAgIHJldHVybiB7IHM6IG1hdGhfc2luJDIoYW5nbGUpLCBjOiBtYXRoX2NvcyQyKGFuZ2xlKSB9O1xuICB9XG4gIGZ1bmN0aW9uIHNldFZlYzIob3V0LCB4MiwgeSkge1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gY29weVZlYzIob3V0LCB3KSB7XG4gICAgb3V0LnggPSB3Lng7XG4gICAgb3V0LnkgPSB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiB6ZXJvVmVjMihvdXQpIHtcbiAgICBvdXQueCA9IDA7XG4gICAgb3V0LnkgPSAwO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gbmVnVmVjMihvdXQpIHtcbiAgICBvdXQueCA9IC1vdXQueDtcbiAgICBvdXQueSA9IC1vdXQueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHBsdXNWZWMyKG91dCwgdykge1xuICAgIG91dC54ICs9IHcueDtcbiAgICBvdXQueSArPSB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBhZGRWZWMyKG91dCwgdjMsIHcpIHtcbiAgICBvdXQueCA9IHYzLnggKyB3Lng7XG4gICAgb3V0LnkgPSB2My54ICsgdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gbWludXNWZWMyKG91dCwgdykge1xuICAgIG91dC54IC09IHcueDtcbiAgICBvdXQueSAtPSB3Lnk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBzdWJWZWMyKG91dCwgdjMsIHcpIHtcbiAgICBvdXQueCA9IHYzLnggLSB3Lng7XG4gICAgb3V0LnkgPSB2My55IC0gdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gbXVsVmVjMihvdXQsIG0pIHtcbiAgICBvdXQueCAqPSBtO1xuICAgIG91dC55ICo9IG07XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBzY2FsZVZlYzIob3V0LCBtLCB3KSB7XG4gICAgb3V0LnggPSBtICogdy54O1xuICAgIG91dC55ID0gbSAqIHcueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHBsdXNTY2FsZVZlYzIob3V0LCBtLCB3KSB7XG4gICAgb3V0LnggKz0gbSAqIHcueDtcbiAgICBvdXQueSArPSBtICogdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gbWludXNTY2FsZVZlYzIob3V0LCBtLCB3KSB7XG4gICAgb3V0LnggLT0gbSAqIHcueDtcbiAgICBvdXQueSAtPSBtICogdy55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gY29tYmluZTJWZWMyKG91dCwgYW0sIGEyLCBibSwgYjIpIHtcbiAgICBvdXQueCA9IGFtICogYTIueCArIGJtICogYjIueDtcbiAgICBvdXQueSA9IGFtICogYTIueSArIGJtICogYjIueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGNvbWJpbmUzVmVjMihvdXQsIGFtLCBhMiwgYm0sIGIyLCBjbSwgYzIpIHtcbiAgICBvdXQueCA9IGFtICogYTIueCArIGJtICogYjIueCArIGNtICogYzIueDtcbiAgICBvdXQueSA9IGFtICogYTIueSArIGJtICogYjIueSArIGNtICogYzIueTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZVZlYzJMZW5ndGgob3V0KSB7XG4gICAgdmFyIGxlbmd0aCA9IG1hdGhfc3FydCQ0KG91dC54ICogb3V0LnggKyBvdXQueSAqIG91dC55KTtcbiAgICBpZiAobGVuZ3RoICE9PSAwKSB7XG4gICAgICB2YXIgaW52TGVuZ3RoID0gMSAvIGxlbmd0aDtcbiAgICAgIG91dC54ICo9IGludkxlbmd0aDtcbiAgICAgIG91dC55ICo9IGludkxlbmd0aDtcbiAgICB9XG4gICAgcmV0dXJuIGxlbmd0aDtcbiAgfVxuICBmdW5jdGlvbiBub3JtYWxpemVWZWMyKG91dCkge1xuICAgIHZhciBsZW5ndGggPSBtYXRoX3NxcnQkNChvdXQueCAqIG91dC54ICsgb3V0LnkgKiBvdXQueSk7XG4gICAgaWYgKGxlbmd0aCA+IDApIHtcbiAgICAgIHZhciBpbnZMZW5ndGggPSAxIC8gbGVuZ3RoO1xuICAgICAgb3V0LnggKj0gaW52TGVuZ3RoO1xuICAgICAgb3V0LnkgKj0gaW52TGVuZ3RoO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGNyb3NzVmVjMk51bShvdXQsIHYzLCB3KSB7XG4gICAgdmFyIHgyID0gdyAqIHYzLnk7XG4gICAgdmFyIHkgPSAtdyAqIHYzLng7XG4gICAgb3V0LnggPSB4MjtcbiAgICBvdXQueSA9IHk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuICBmdW5jdGlvbiBjcm9zc051bVZlYzIob3V0LCB3LCB2Mykge1xuICAgIHZhciB4MiA9IC13ICogdjMueTtcbiAgICB2YXIgeSA9IHcgKiB2My54O1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gY3Jvc3NWZWMyVmVjMihhMiwgYjIpIHtcbiAgICByZXR1cm4gYTIueCAqIGIyLnkgLSBhMi55ICogYjIueDtcbiAgfVxuICBmdW5jdGlvbiBkb3RWZWMyKGEyLCBiMikge1xuICAgIHJldHVybiBhMi54ICogYjIueCArIGEyLnkgKiBiMi55O1xuICB9XG4gIGZ1bmN0aW9uIGxlbmd0aFNxclZlYzIoYTIpIHtcbiAgICByZXR1cm4gYTIueCAqIGEyLnggKyBhMi55ICogYTIueTtcbiAgfVxuICBmdW5jdGlvbiBkaXN0VmVjMihhMiwgYjIpIHtcbiAgICB2YXIgZHggPSBhMi54IC0gYjIueDtcbiAgICB2YXIgZHkgPSBhMi55IC0gYjIueTtcbiAgICByZXR1cm4gbWF0aF9zcXJ0JDQoZHggKiBkeCArIGR5ICogZHkpO1xuICB9XG4gIGZ1bmN0aW9uIGRpc3RTcXJWZWMyKGEyLCBiMikge1xuICAgIHZhciBkeCA9IGEyLnggLSBiMi54O1xuICAgIHZhciBkeSA9IGEyLnkgLSBiMi55O1xuICAgIHJldHVybiBkeCAqIGR4ICsgZHkgKiBkeTtcbiAgfVxuICBmdW5jdGlvbiBzZXRSb3RBbmdsZShvdXQsIGEyKSB7XG4gICAgb3V0LmMgPSBtYXRoX2NvcyQyKGEyKTtcbiAgICBvdXQucyA9IG1hdGhfc2luJDIoYTIpO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gcm90VmVjMihvdXQsIHEsIHYzKSB7XG4gICAgb3V0LnggPSBxLmMgKiB2My54IC0gcS5zICogdjMueTtcbiAgICBvdXQueSA9IHEucyAqIHYzLnggKyBxLmMgKiB2My55O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gZGVyb3RWZWMyKG91dCwgcSwgdjMpIHtcbiAgICB2YXIgeDIgPSBxLmMgKiB2My54ICsgcS5zICogdjMueTtcbiAgICB2YXIgeSA9IC1xLnMgKiB2My54ICsgcS5jICogdjMueTtcbiAgICBvdXQueCA9IHgyO1xuICAgIG91dC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHJlcm90VmVjMihvdXQsIGJlZm9yZSwgYWZ0ZXIsIHYzKSB7XG4gICAgdmFyIHgwID0gYmVmb3JlLmMgKiB2My54ICsgYmVmb3JlLnMgKiB2My55O1xuICAgIHZhciB5MCA9IC1iZWZvcmUucyAqIHYzLnggKyBiZWZvcmUuYyAqIHYzLnk7XG4gICAgdmFyIHgyID0gYWZ0ZXIuYyAqIHgwIC0gYWZ0ZXIucyAqIHkwO1xuICAgIHZhciB5ID0gYWZ0ZXIucyAqIHgwICsgYWZ0ZXIuYyAqIHkwO1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gdHJhbnNmb3JtKHgyLCB5LCBhMikge1xuICAgIHJldHVybiB7IHA6IHZlYzIoeDIsIHkpLCBxOiByb3RhdGlvbihhMikgfTtcbiAgfVxuICBmdW5jdGlvbiBjb3B5VHJhbnNmb3JtKG91dCwgdHJhbnNmb3JtMikge1xuICAgIG91dC5wLnggPSB0cmFuc2Zvcm0yLnAueDtcbiAgICBvdXQucC55ID0gdHJhbnNmb3JtMi5wLnk7XG4gICAgb3V0LnEucyA9IHRyYW5zZm9ybTIucS5zO1xuICAgIG91dC5xLmMgPSB0cmFuc2Zvcm0yLnEuYztcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIHRyYW5zZm9ybVZlYzIob3V0LCB4ZjIsIHYzKSB7XG4gICAgdmFyIHgyID0geGYyLnEuYyAqIHYzLnggLSB4ZjIucS5zICogdjMueSArIHhmMi5wLng7XG4gICAgdmFyIHkgPSB4ZjIucS5zICogdjMueCArIHhmMi5xLmMgKiB2My55ICsgeGYyLnAueTtcbiAgICBvdXQueCA9IHgyO1xuICAgIG91dC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIGZ1bmN0aW9uIGRldHJhbnNmb3JtVmVjMihvdXQsIHhmMiwgdjMpIHtcbiAgICB2YXIgcHggPSB2My54IC0geGYyLnAueDtcbiAgICB2YXIgcHkgPSB2My55IC0geGYyLnAueTtcbiAgICB2YXIgeDIgPSB4ZjIucS5jICogcHggKyB4ZjIucS5zICogcHk7XG4gICAgdmFyIHkgPSAteGYyLnEucyAqIHB4ICsgeGYyLnEuYyAqIHB5O1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gcmV0cmFuc2Zvcm1WZWMyKG91dCwgZnJvbSwgdG8sIHYzKSB7XG4gICAgdmFyIHgwID0gZnJvbS5xLmMgKiB2My54IC0gZnJvbS5xLnMgKiB2My55ICsgZnJvbS5wLng7XG4gICAgdmFyIHkwID0gZnJvbS5xLnMgKiB2My54ICsgZnJvbS5xLmMgKiB2My55ICsgZnJvbS5wLnk7XG4gICAgdmFyIHB4ID0geDAgLSB0by5wLng7XG4gICAgdmFyIHB5ID0geTAgLSB0by5wLnk7XG4gICAgdmFyIHgyID0gdG8ucS5jICogcHggKyB0by5xLnMgKiBweTtcbiAgICB2YXIgeSA9IC10by5xLnMgKiBweCArIHRvLnEuYyAqIHB5O1xuICAgIG91dC54ID0geDI7XG4gICAgb3V0LnkgPSB5O1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgZnVuY3Rpb24gZGV0cmFuc2Zvcm1UcmFuc2Zvcm0ob3V0LCBhMiwgYjIpIHtcbiAgICB2YXIgYzIgPSBhMi5xLmMgKiBiMi5xLmMgKyBhMi5xLnMgKiBiMi5xLnM7XG4gICAgdmFyIHMyID0gYTIucS5jICogYjIucS5zIC0gYTIucS5zICogYjIucS5jO1xuICAgIHZhciB4MiA9IGEyLnEuYyAqIChiMi5wLnggLSBhMi5wLngpICsgYTIucS5zICogKGIyLnAueSAtIGEyLnAueSk7XG4gICAgdmFyIHkgPSAtYTIucS5zICogKGIyLnAueCAtIGEyLnAueCkgKyBhMi5xLmMgKiAoYjIucC55IC0gYTIucC55KTtcbiAgICBvdXQucS5jID0gYzI7XG4gICAgb3V0LnEucyA9IHMyO1xuICAgIG91dC5wLnggPSB4MjtcbiAgICBvdXQucC55ID0geTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG4gIHZhciBtYXRoX3NpbiQxID0gTWF0aC5zaW47XG4gIHZhciBtYXRoX2NvcyQxID0gTWF0aC5jb3M7XG4gIHZhciBtYXRoX2F0YW4yJDEgPSBNYXRoLmF0YW4yO1xuICB2YXIgUm90ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFJvdDIoYW5nbGUpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFJvdDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBSb3QyKGFuZ2xlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGFuZ2xlID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgdGhpcy5zZXRBbmdsZShhbmdsZSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFuZ2xlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy5zZXRSb3QoYW5nbGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2V0SWRlbnRpdHkoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgUm90Mi5uZW8gPSBmdW5jdGlvbihhbmdsZSkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShSb3QyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5zZXRBbmdsZShhbmdsZSk7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgUm90Mi5jbG9uZSA9IGZ1bmN0aW9uKHJvdCkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShSb3QyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5zID0gcm90LnM7XG4gICAgICAgIG9iai5jID0gcm90LmM7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgUm90Mi5pZGVudGl0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShSb3QyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5zID0gMDtcbiAgICAgICAgb2JqLmMgPSAxO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFJvdDIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShvYmoucykgJiYgTnVtYmVyLmlzRmluaXRlKG9iai5jKTtcbiAgICAgIH07XG4gICAgICBSb3QyLmFzc2VydCA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIH07XG4gICAgICBSb3QyLnByb3RvdHlwZS5zZXRJZGVudGl0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnMgPSAwO1xuICAgICAgICB0aGlzLmMgPSAxO1xuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKGFuZ2xlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYW5nbGUgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLnMgPSBhbmdsZS5zO1xuICAgICAgICAgIHRoaXMuYyA9IGFuZ2xlLmM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5zID0gbWF0aF9zaW4kMShhbmdsZSk7XG4gICAgICAgICAgdGhpcy5jID0gbWF0aF9jb3MkMShhbmdsZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSb3QyLnByb3RvdHlwZS5zZXRSb3QgPSBmdW5jdGlvbihhbmdsZSkge1xuICAgICAgICB0aGlzLnMgPSBhbmdsZS5zO1xuICAgICAgICB0aGlzLmMgPSBhbmdsZS5jO1xuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLnNldEFuZ2xlID0gZnVuY3Rpb24oYW5nbGUpIHtcbiAgICAgICAgdGhpcy5zID0gbWF0aF9zaW4kMShhbmdsZSk7XG4gICAgICAgIHRoaXMuYyA9IG1hdGhfY29zJDEoYW5nbGUpO1xuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLmdldEFuZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBtYXRoX2F0YW4yJDEodGhpcy5zLCB0aGlzLmMpO1xuICAgICAgfTtcbiAgICAgIFJvdDIucHJvdG90eXBlLmdldFhBeGlzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh0aGlzLmMsIHRoaXMucyk7XG4gICAgICB9O1xuICAgICAgUm90Mi5wcm90b3R5cGUuZ2V0WUF4aXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKC10aGlzLnMsIHRoaXMuYyk7XG4gICAgICB9O1xuICAgICAgUm90Mi5tdWwgPSBmdW5jdGlvbihyb3QsIG0pIHtcbiAgICAgICAgaWYgKFwiY1wiIGluIG0gJiYgXCJzXCIgaW4gbSkge1xuICAgICAgICAgIHZhciBxciA9IFJvdDIuaWRlbnRpdHkoKTtcbiAgICAgICAgICBxci5zID0gcm90LnMgKiBtLmMgKyByb3QuYyAqIG0ucztcbiAgICAgICAgICBxci5jID0gcm90LmMgKiBtLmMgLSByb3QucyAqIG0ucztcbiAgICAgICAgICByZXR1cm4gcXI7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJ4XCIgaW4gbSAmJiBcInlcIiBpbiBtKSB7XG4gICAgICAgICAgcmV0dXJuIFZlYzIubmVvKHJvdC5jICogbS54IC0gcm90LnMgKiBtLnksIHJvdC5zICogbS54ICsgcm90LmMgKiBtLnkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUm90Mi5tdWxSb3QgPSBmdW5jdGlvbihyb3QsIG0pIHtcbiAgICAgICAgdmFyIHFyID0gUm90Mi5pZGVudGl0eSgpO1xuICAgICAgICBxci5zID0gcm90LnMgKiBtLmMgKyByb3QuYyAqIG0ucztcbiAgICAgICAgcXIuYyA9IHJvdC5jICogbS5jIC0gcm90LnMgKiBtLnM7XG4gICAgICAgIHJldHVybiBxcjtcbiAgICAgIH07XG4gICAgICBSb3QyLm11bFZlYzIgPSBmdW5jdGlvbihyb3QsIG0pIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHJvdC5jICogbS54IC0gcm90LnMgKiBtLnksIHJvdC5zICogbS54ICsgcm90LmMgKiBtLnkpO1xuICAgICAgfTtcbiAgICAgIFJvdDIubXVsU3ViID0gZnVuY3Rpb24ocm90LCB2Mywgdykge1xuICAgICAgICB2YXIgeDIgPSByb3QuYyAqICh2My54IC0gdy54KSAtIHJvdC5zICogKHYzLnkgLSB3LnkpO1xuICAgICAgICB2YXIgeSA9IHJvdC5zICogKHYzLnggLSB3LngpICsgcm90LmMgKiAodjMueSAtIHcueSk7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh4MiwgeSk7XG4gICAgICB9O1xuICAgICAgUm90Mi5tdWxUID0gZnVuY3Rpb24ocm90LCBtKSB7XG4gICAgICAgIGlmIChcImNcIiBpbiBtICYmIFwic1wiIGluIG0pIHtcbiAgICAgICAgICB2YXIgcXIgPSBSb3QyLmlkZW50aXR5KCk7XG4gICAgICAgICAgcXIucyA9IHJvdC5jICogbS5zIC0gcm90LnMgKiBtLmM7XG4gICAgICAgICAgcXIuYyA9IHJvdC5jICogbS5jICsgcm90LnMgKiBtLnM7XG4gICAgICAgICAgcmV0dXJuIHFyO1xuICAgICAgICB9IGVsc2UgaWYgKFwieFwiIGluIG0gJiYgXCJ5XCIgaW4gbSkge1xuICAgICAgICAgIHJldHVybiBWZWMyLm5lbyhyb3QuYyAqIG0ueCArIHJvdC5zICogbS55LCAtcm90LnMgKiBtLnggKyByb3QuYyAqIG0ueSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSb3QyLm11bFRSb3QgPSBmdW5jdGlvbihyb3QsIG0pIHtcbiAgICAgICAgdmFyIHFyID0gUm90Mi5pZGVudGl0eSgpO1xuICAgICAgICBxci5zID0gcm90LmMgKiBtLnMgLSByb3QucyAqIG0uYztcbiAgICAgICAgcXIuYyA9IHJvdC5jICogbS5jICsgcm90LnMgKiBtLnM7XG4gICAgICAgIHJldHVybiBxcjtcbiAgICAgIH07XG4gICAgICBSb3QyLm11bFRWZWMyID0gZnVuY3Rpb24ocm90LCBtKSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyhyb3QuYyAqIG0ueCArIHJvdC5zICogbS55LCAtcm90LnMgKiBtLnggKyByb3QuYyAqIG0ueSk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFJvdDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX2F0YW4yID0gTWF0aC5hdGFuMjtcbiAgdmFyIG1hdGhfUEkkNSA9IE1hdGguUEk7XG4gIHZhciB0ZW1wJDcgPSB2ZWMyKDAsIDApO1xuICB2YXIgU3dlZXAgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU3dlZXAyKCkge1xuICAgICAgICB0aGlzLmxvY2FsQ2VudGVyID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMuYyA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLmEgPSAwO1xuICAgICAgICB0aGlzLmFscGhhMCA9IDA7XG4gICAgICAgIHRoaXMuYzAgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5hMCA9IDA7XG4gICAgICB9XG4gICAgICBTd2VlcDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5sb2NhbENlbnRlcik7XG4gICAgICAgIHplcm9WZWMyKHRoaXMuYyk7XG4gICAgICAgIHRoaXMuYSA9IDA7XG4gICAgICAgIHRoaXMuYWxwaGEwID0gMDtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5jMCk7XG4gICAgICAgIHRoaXMuYTAgPSAwO1xuICAgICAgfTtcbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUuc2V0VHJhbnNmb3JtID0gZnVuY3Rpb24oeGYyKSB7XG4gICAgICAgIHRyYW5zZm9ybVZlYzIodGVtcCQ3LCB4ZjIsIHRoaXMubG9jYWxDZW50ZXIpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmMsIHRlbXAkNyk7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMuYzAsIHRlbXAkNyk7XG4gICAgICAgIHRoaXMuYSA9IHRoaXMuYTAgPSBtYXRoX2F0YW4yKHhmMi5xLnMsIHhmMi5xLmMpO1xuICAgICAgfTtcbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUuc2V0TG9jYWxDZW50ZXIgPSBmdW5jdGlvbihsb2NhbENlbnRlcjIsIHhmMikge1xuICAgICAgICBjb3B5VmVjMih0aGlzLmxvY2FsQ2VudGVyLCBsb2NhbENlbnRlcjIpO1xuICAgICAgICB0cmFuc2Zvcm1WZWMyKHRlbXAkNywgeGYyLCB0aGlzLmxvY2FsQ2VudGVyKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5jLCB0ZW1wJDcpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmMwLCB0ZW1wJDcpO1xuICAgICAgfTtcbiAgICAgIFN3ZWVwMi5wcm90b3R5cGUuZ2V0VHJhbnNmb3JtID0gZnVuY3Rpb24oeGYyLCBiZXRhKSB7XG4gICAgICAgIGlmIChiZXRhID09PSB2b2lkIDApIHtcbiAgICAgICAgICBiZXRhID0gMDtcbiAgICAgICAgfVxuICAgICAgICBzZXRSb3RBbmdsZSh4ZjIucSwgKDEgLSBiZXRhKSAqIHRoaXMuYTAgKyBiZXRhICogdGhpcy5hKTtcbiAgICAgICAgY29tYmluZTJWZWMyKHhmMi5wLCAxIC0gYmV0YSwgdGhpcy5jMCwgYmV0YSwgdGhpcy5jKTtcbiAgICAgICAgbWludXNWZWMyKHhmMi5wLCByb3RWZWMyKHRlbXAkNywgeGYyLnEsIHRoaXMubG9jYWxDZW50ZXIpKTtcbiAgICAgIH07XG4gICAgICBTd2VlcDIucHJvdG90eXBlLmFkdmFuY2UgPSBmdW5jdGlvbihhbHBoYSkge1xuICAgICAgICB2YXIgYmV0YSA9IChhbHBoYSAtIHRoaXMuYWxwaGEwKSAvICgxIC0gdGhpcy5hbHBoYTApO1xuICAgICAgICBjb21iaW5lMlZlYzIodGhpcy5jMCwgYmV0YSwgdGhpcy5jLCAxIC0gYmV0YSwgdGhpcy5jMCk7XG4gICAgICAgIHRoaXMuYTAgPSBiZXRhICogdGhpcy5hICsgKDEgLSBiZXRhKSAqIHRoaXMuYTA7XG4gICAgICAgIHRoaXMuYWxwaGEwID0gYWxwaGE7XG4gICAgICB9O1xuICAgICAgU3dlZXAyLnByb3RvdHlwZS5mb3J3YXJkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYTAgPSB0aGlzLmE7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMuYzAsIHRoaXMuYyk7XG4gICAgICB9O1xuICAgICAgU3dlZXAyLnByb3RvdHlwZS5ub3JtYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGEwID0gbW9kKHRoaXMuYTAsIC1tYXRoX1BJJDUsICttYXRoX1BJJDUpO1xuICAgICAgICB0aGlzLmEgLT0gdGhpcy5hMCAtIGEwO1xuICAgICAgICB0aGlzLmEwID0gYTA7XG4gICAgICB9O1xuICAgICAgU3dlZXAyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih0aGF0KSB7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMubG9jYWxDZW50ZXIsIHRoYXQubG9jYWxDZW50ZXIpO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmMsIHRoYXQuYyk7XG4gICAgICAgIHRoaXMuYSA9IHRoYXQuYTtcbiAgICAgICAgdGhpcy5hbHBoYTAgPSB0aGF0LmFscGhhMDtcbiAgICAgICAgY29weVZlYzIodGhpcy5jMCwgdGhhdC5jMCk7XG4gICAgICAgIHRoaXMuYTAgPSB0aGF0LmEwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTd2VlcDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBUcmFuc2Zvcm0gPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVHJhbnNmb3JtMihwb3NpdGlvbiwgcm90YXRpb24yKSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBUcmFuc2Zvcm0yKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgVHJhbnNmb3JtMihwb3NpdGlvbiwgcm90YXRpb24yKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnAgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5xID0gUm90LmlkZW50aXR5KCk7XG4gICAgICAgIGlmICh0eXBlb2YgcG9zaXRpb24gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0aGlzLnAuc2V0VmVjMihwb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiByb3RhdGlvbjIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0aGlzLnEuc2V0QW5nbGUocm90YXRpb24yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgVHJhbnNmb3JtMi5jbG9uZSA9IGZ1bmN0aW9uKHhmMikge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShUcmFuc2Zvcm0yLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5wID0gVmVjMi5jbG9uZSh4ZjIucCk7XG4gICAgICAgIG9iai5xID0gUm90LmNsb25lKHhmMi5xKTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm5lbyA9IGZ1bmN0aW9uKHBvc2l0aW9uLCByb3RhdGlvbjIpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVHJhbnNmb3JtMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoucCA9IFZlYzIuY2xvbmUocG9zaXRpb24pO1xuICAgICAgICBvYmoucSA9IFJvdC5jbG9uZShyb3RhdGlvbjIpO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIuaWRlbnRpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVHJhbnNmb3JtMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoucCA9IFZlYzIuemVybygpO1xuICAgICAgICBvYmoucSA9IFJvdC5pZGVudGl0eSgpO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIucHJvdG90eXBlLnNldElkZW50aXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucC5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMucS5zZXRJZGVudGl0eSgpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICBpZiAodHlwZW9mIGIyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgdGhpcy5wLnNldChhMi5wKTtcbiAgICAgICAgICB0aGlzLnEuc2V0KGEyLnEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucC5zZXQoYTIpO1xuICAgICAgICAgIHRoaXMucS5zZXQoYjIpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5wcm90b3R5cGUuc2V0TnVtID0gZnVuY3Rpb24ocG9zaXRpb24sIHJvdGF0aW9uMikge1xuICAgICAgICB0aGlzLnAuc2V0VmVjMihwb3NpdGlvbik7XG4gICAgICAgIHRoaXMucS5zZXRBbmdsZShyb3RhdGlvbjIpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIucHJvdG90eXBlLnNldFRyYW5zZm9ybSA9IGZ1bmN0aW9uKHhmMikge1xuICAgICAgICB0aGlzLnAuc2V0VmVjMih4ZjIucCk7XG4gICAgICAgIHRoaXMucS5zZXRSb3QoeGYyLnEpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFZlYzIuaXNWYWxpZChvYmoucCkgJiYgUm90LmlzVmFsaWQob2JqLnEpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIuYXNzZXJ0ID0gZnVuY3Rpb24obykge1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGIyKSkge1xuICAgICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcnJbaV0gPSBUcmFuc2Zvcm0yLm11bChhMiwgYjJbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgICB9IGVsc2UgaWYgKFwieFwiIGluIGIyICYmIFwieVwiIGluIGIyKSB7XG4gICAgICAgICAgcmV0dXJuIFRyYW5zZm9ybTIubXVsVmVjMihhMiwgYjIpO1xuICAgICAgICB9IGVsc2UgaWYgKFwicFwiIGluIGIyICYmIFwicVwiIGluIGIyKSB7XG4gICAgICAgICAgcmV0dXJuIFRyYW5zZm9ybTIubXVsWGYoYTIsIGIyKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsQWxsID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiMi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGFycltpXSA9IFRyYW5zZm9ybTIubXVsKGEyLCBiMltpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm11bEZuID0gZnVuY3Rpb24oYTIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGIyKSB7XG4gICAgICAgICAgcmV0dXJuIFRyYW5zZm9ybTIubXVsKGEyLCBiMik7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5tdWxWZWMyID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciB4MiA9IGEyLnEuYyAqIGIyLnggLSBhMi5xLnMgKiBiMi55ICsgYTIucC54O1xuICAgICAgICB2YXIgeSA9IGEyLnEucyAqIGIyLnggKyBhMi5xLmMgKiBiMi55ICsgYTIucC55O1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsWGYgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIHhmMiA9IFRyYW5zZm9ybTIuaWRlbnRpdHkoKTtcbiAgICAgICAgeGYyLnEgPSBSb3QubXVsUm90KGEyLnEsIGIyLnEpO1xuICAgICAgICB4ZjIucCA9IFZlYzIuYWRkKFJvdC5tdWxWZWMyKGEyLnEsIGIyLnApLCBhMi5wKTtcbiAgICAgICAgcmV0dXJuIHhmMjtcbiAgICAgIH07XG4gICAgICBUcmFuc2Zvcm0yLm11bFQgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgaWYgKFwieFwiIGluIGIyICYmIFwieVwiIGluIGIyKSB7XG4gICAgICAgICAgcmV0dXJuIFRyYW5zZm9ybTIubXVsVFZlYzIoYTIsIGIyKTtcbiAgICAgICAgfSBlbHNlIGlmIChcInBcIiBpbiBiMiAmJiBcInFcIiBpbiBiMikge1xuICAgICAgICAgIHJldHVybiBUcmFuc2Zvcm0yLm11bFRYZihhMiwgYjIpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgVHJhbnNmb3JtMi5tdWxUVmVjMiA9IGZ1bmN0aW9uKGEyLCBiMikge1xuICAgICAgICB2YXIgcHggPSBiMi54IC0gYTIucC54O1xuICAgICAgICB2YXIgcHkgPSBiMi55IC0gYTIucC55O1xuICAgICAgICB2YXIgeDIgPSBhMi5xLmMgKiBweCArIGEyLnEucyAqIHB5O1xuICAgICAgICB2YXIgeSA9IC1hMi5xLnMgKiBweCArIGEyLnEuYyAqIHB5O1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgfTtcbiAgICAgIFRyYW5zZm9ybTIubXVsVFhmID0gZnVuY3Rpb24oYTIsIGIyKSB7XG4gICAgICAgIHZhciB4ZjIgPSBUcmFuc2Zvcm0yLmlkZW50aXR5KCk7XG4gICAgICAgIHhmMi5xLnNldFJvdChSb3QubXVsVFJvdChhMi5xLCBiMi5xKSk7XG4gICAgICAgIHhmMi5wLnNldFZlYzIoUm90Lm11bFRWZWMyKGEyLnEsIFZlYzIuc3ViKGIyLnAsIGEyLnApKSk7XG4gICAgICAgIHJldHVybiB4ZjI7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFRyYW5zZm9ybTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBWZWxvY2l0eSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVmVsb2NpdHkyKCkge1xuICAgICAgICB0aGlzLnYgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy53ID0gMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBWZWxvY2l0eTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX3NpbiA9IE1hdGguc2luO1xuICB2YXIgbWF0aF9jb3MgPSBNYXRoLmNvcztcbiAgdmFyIFBvc2l0aW9uID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFBvc2l0aW9uMigpIHtcbiAgICAgICAgdGhpcy5jID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMuYSA9IDA7XG4gICAgICB9XG4gICAgICBQb3NpdGlvbjIucHJvdG90eXBlLmdldFRyYW5zZm9ybSA9IGZ1bmN0aW9uKHhmMiwgcCkge1xuICAgICAgICB4ZjIucS5jID0gbWF0aF9jb3ModGhpcy5hKTtcbiAgICAgICAgeGYyLnEucyA9IG1hdGhfc2luKHRoaXMuYSk7XG4gICAgICAgIHhmMi5wLnggPSB0aGlzLmMueCAtICh4ZjIucS5jICogcC54IC0geGYyLnEucyAqIHAueSk7XG4gICAgICAgIHhmMi5wLnkgPSB0aGlzLmMueSAtICh4ZjIucS5zICogcC54ICsgeGYyLnEuYyAqIHAueSk7XG4gICAgICAgIHJldHVybiB4ZjI7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFBvc2l0aW9uMjtcbiAgICB9KClcbiAgKTtcbiAgZnVuY3Rpb24gZ2V0VHJhbnNmb3JtKHhmMiwgcCwgYzIsIGEyKSB7XG4gICAgeGYyLnEuYyA9IG1hdGhfY29zKGEyKTtcbiAgICB4ZjIucS5zID0gbWF0aF9zaW4oYTIpO1xuICAgIHhmMi5wLnggPSBjMi54IC0gKHhmMi5xLmMgKiBwLnggLSB4ZjIucS5zICogcC55KTtcbiAgICB4ZjIucC55ID0gYzIueSAtICh4ZjIucS5zICogcC54ICsgeGYyLnEuYyAqIHAueSk7XG4gICAgcmV0dXJuIHhmMjtcbiAgfVxuICB2YXIgU2hhcGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2hhcGUyKCkge1xuICAgICAgICB0aGlzLnN0eWxlID0ge307XG4gICAgICAgIHRoaXMuYXBwRGF0YSA9IHt9O1xuICAgICAgfVxuICAgICAgU2hhcGUyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0eXBlb2Ygb2JqLm1fdHlwZSA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2Ygb2JqLm1fcmFkaXVzID09PSBcIm51bWJlclwiO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTaGFwZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBzeW5jaHJvbml6ZV9hYWJiMSA9IG5ldyBBQUJCKCk7XG4gIHZhciBzeW5jaHJvbml6ZV9hYWJiMiA9IG5ldyBBQUJCKCk7XG4gIHZhciBkaXNwbGFjZW1lbnQgPSB2ZWMyKDAsIDApO1xuICB2YXIgRml4dHVyZURlZkRlZmF1bHQgPSB7XG4gICAgdXNlckRhdGE6IG51bGwsXG4gICAgZnJpY3Rpb246IDAuMixcbiAgICByZXN0aXR1dGlvbjogMCxcbiAgICBkZW5zaXR5OiAwLFxuICAgIGlzU2Vuc29yOiBmYWxzZSxcbiAgICBmaWx0ZXJHcm91cEluZGV4OiAwLFxuICAgIGZpbHRlckNhdGVnb3J5Qml0czogMSxcbiAgICBmaWx0ZXJNYXNrQml0czogNjU1MzVcbiAgfTtcbiAgdmFyIEZpeHR1cmVQcm94eSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRml4dHVyZVByb3h5MihmaXh0dXJlLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7XG4gICAgICAgIHRoaXMuZml4dHVyZSA9IGZpeHR1cmU7XG4gICAgICAgIHRoaXMuY2hpbGRJbmRleCA9IGNoaWxkSW5kZXg7XG4gICAgICB9XG4gICAgICByZXR1cm4gRml4dHVyZVByb3h5MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIEZpeHR1cmUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRml4dHVyZTIoYm9keSwgc2hhcGUsIGRlZikge1xuICAgICAgICB0aGlzLnN0eWxlID0ge307XG4gICAgICAgIHRoaXMuYXBwRGF0YSA9IHt9O1xuICAgICAgICBpZiAoc2hhcGUuc2hhcGUpIHtcbiAgICAgICAgICBkZWYgPSBzaGFwZTtcbiAgICAgICAgICBzaGFwZSA9IHNoYXBlLnNoYXBlO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZWYgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICBkZWYgPSB7IGRlbnNpdHk6IGRlZiB9O1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBGaXh0dXJlRGVmRGVmYXVsdCk7XG4gICAgICAgIHRoaXMubV9ib2R5ID0gYm9keTtcbiAgICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gZGVmLmZyaWN0aW9uO1xuICAgICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSBkZWYucmVzdGl0dXRpb247XG4gICAgICAgIHRoaXMubV9kZW5zaXR5ID0gZGVmLmRlbnNpdHk7XG4gICAgICAgIHRoaXMubV9pc1NlbnNvciA9IGRlZi5pc1NlbnNvcjtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXggPSBkZWYuZmlsdGVyR3JvdXBJbmRleDtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckNhdGVnb3J5Qml0cyA9IGRlZi5maWx0ZXJDYXRlZ29yeUJpdHM7XG4gICAgICAgIHRoaXMubV9maWx0ZXJNYXNrQml0cyA9IGRlZi5maWx0ZXJNYXNrQml0cztcbiAgICAgICAgdGhpcy5tX3NoYXBlID0gc2hhcGU7XG4gICAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3Byb3hpZXMgPSBbXTtcbiAgICAgICAgdGhpcy5tX3Byb3h5Q291bnQgPSAwO1xuICAgICAgICB2YXIgY2hpbGRDb3VudCA9IHRoaXMubV9zaGFwZS5nZXRDaGlsZENvdW50KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRDb3VudDsgKytpKSB7XG4gICAgICAgICAgdGhpcy5tX3Byb3hpZXNbaV0gPSBuZXcgRml4dHVyZVByb3h5KHRoaXMsIGkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRlZi51c2VyRGF0YTtcbiAgICAgICAgaWYgKHR5cGVvZiBkZWYuc3R5bGUgPT09IFwib2JqZWN0XCIgJiYgZGVmLnN0eWxlICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5zdHlsZSA9IGRlZi5zdHlsZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgRml4dHVyZTIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYm9keSA9IHRoaXMuZ2V0Qm9keSgpO1xuICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IGJvZHkubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgIHRoaXMuZGVzdHJveVByb3hpZXMoYnJvYWRQaGFzZSk7XG4gICAgICAgIGlmICh0aGlzLm1fc2hhcGUuX3Jlc2V0KSB7XG4gICAgICAgICAgdGhpcy5tX3NoYXBlLl9yZXNldCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGlsZENvdW50ID0gdGhpcy5tX3NoYXBlLmdldENoaWxkQ291bnQoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZENvdW50OyArK2kpIHtcbiAgICAgICAgICB0aGlzLm1fcHJveGllc1tpXSA9IG5ldyBGaXh0dXJlUHJveHkodGhpcywgaSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jcmVhdGVQcm94aWVzKGJyb2FkUGhhc2UsIGJvZHkubV94Zik7XG4gICAgICAgIGJvZHkucmVzZXRNYXNzRGF0YSgpO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZnJpY3Rpb246IHRoaXMubV9mcmljdGlvbixcbiAgICAgICAgICByZXN0aXR1dGlvbjogdGhpcy5tX3Jlc3RpdHV0aW9uLFxuICAgICAgICAgIGRlbnNpdHk6IHRoaXMubV9kZW5zaXR5LFxuICAgICAgICAgIGlzU2Vuc29yOiB0aGlzLm1faXNTZW5zb3IsXG4gICAgICAgICAgZmlsdGVyR3JvdXBJbmRleDogdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXgsXG4gICAgICAgICAgZmlsdGVyQ2F0ZWdvcnlCaXRzOiB0aGlzLm1fZmlsdGVyQ2F0ZWdvcnlCaXRzLFxuICAgICAgICAgIGZpbHRlck1hc2tCaXRzOiB0aGlzLm1fZmlsdGVyTWFza0JpdHMsXG4gICAgICAgICAgc2hhcGU6IHRoaXMubV9zaGFwZVxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIGJvZHksIHJlc3RvcmUpIHtcbiAgICAgICAgdmFyIHNoYXBlID0gcmVzdG9yZShTaGFwZSwgZGF0YS5zaGFwZSk7XG4gICAgICAgIHZhciBmaXh0dXJlID0gc2hhcGUgJiYgbmV3IEZpeHR1cmUyKGJvZHksIHNoYXBlLCBkYXRhKTtcbiAgICAgICAgcmV0dXJuIGZpeHR1cmU7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9zaGFwZS5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldFNoYXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc2hhcGU7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmlzU2Vuc29yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1faXNTZW5zb3I7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldFNlbnNvciA9IGZ1bmN0aW9uKHNlbnNvcikge1xuICAgICAgICBpZiAoc2Vuc29yICE9IHRoaXMubV9pc1NlbnNvcikge1xuICAgICAgICAgIHRoaXMubV9ib2R5LnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9pc1NlbnNvciA9IHNlbnNvcjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3VzZXJEYXRhO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgdGhpcy5tX3VzZXJEYXRhID0gZGF0YTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0Qm9keSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldE5leHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXREZW5zaXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZGVuc2l0eTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0RGVuc2l0eSA9IGZ1bmN0aW9uKGRlbnNpdHkpIHtcbiAgICAgICAgdGhpcy5tX2RlbnNpdHkgPSBkZW5zaXR5O1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRGcmljdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZyaWN0aW9uO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRGcmljdGlvbiA9IGZ1bmN0aW9uKGZyaWN0aW9uKSB7XG4gICAgICAgIHRoaXMubV9mcmljdGlvbiA9IGZyaWN0aW9uO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3Jlc3RpdHV0aW9uO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5zZXRSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uKHJlc3RpdHV0aW9uKSB7XG4gICAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IHJlc3RpdHV0aW9uO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS50ZXN0UG9pbnQgPSBmdW5jdGlvbihwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc2hhcGUudGVzdFBvaW50KHRoaXMubV9ib2R5LmdldFRyYW5zZm9ybSgpLCBwKTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0MiwgY2hpbGRJbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3NoYXBlLnJheUNhc3Qob3V0cHV0MiwgaW5wdXQyLCB0aGlzLm1fYm9keS5nZXRUcmFuc2Zvcm0oKSwgY2hpbGRJbmRleCk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldE1hc3NEYXRhID0gZnVuY3Rpb24obWFzc0RhdGEpIHtcbiAgICAgICAgdGhpcy5tX3NoYXBlLmNvbXB1dGVNYXNzKG1hc3NEYXRhLCB0aGlzLm1fZGVuc2l0eSk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldEFBQkIgPSBmdW5jdGlvbihjaGlsZEluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcHJveGllc1tjaGlsZEluZGV4XS5hYWJiO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5jcmVhdGVQcm94aWVzID0gZnVuY3Rpb24oYnJvYWRQaGFzZSwgeGYyKSB7XG4gICAgICAgIHRoaXMubV9wcm94eUNvdW50ID0gdGhpcy5tX3NoYXBlLmdldENoaWxkQ291bnQoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fcHJveHlDb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIHByb3h5ID0gdGhpcy5tX3Byb3hpZXNbaV07XG4gICAgICAgICAgdGhpcy5tX3NoYXBlLmNvbXB1dGVBQUJCKHByb3h5LmFhYmIsIHhmMiwgaSk7XG4gICAgICAgICAgcHJveHkucHJveHlJZCA9IGJyb2FkUGhhc2UuY3JlYXRlUHJveHkocHJveHkuYWFiYiwgcHJveHkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmRlc3Ryb3lQcm94aWVzID0gZnVuY3Rpb24oYnJvYWRQaGFzZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9wcm94eUNvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgcHJveHkgPSB0aGlzLm1fcHJveGllc1tpXTtcbiAgICAgICAgICBicm9hZFBoYXNlLmRlc3Ryb3lQcm94eShwcm94eS5wcm94eUlkKTtcbiAgICAgICAgICBwcm94eS5wcm94eUlkID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fcHJveHlDb3VudCA9IDA7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnN5bmNocm9uaXplID0gZnVuY3Rpb24oYnJvYWRQaGFzZSwgeGYxLCB4ZjIpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fcHJveHlDb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIHByb3h5ID0gdGhpcy5tX3Byb3hpZXNbaV07XG4gICAgICAgICAgdGhpcy5tX3NoYXBlLmNvbXB1dGVBQUJCKHN5bmNocm9uaXplX2FhYmIxLCB4ZjEsIHByb3h5LmNoaWxkSW5kZXgpO1xuICAgICAgICAgIHRoaXMubV9zaGFwZS5jb21wdXRlQUFCQihzeW5jaHJvbml6ZV9hYWJiMiwgeGYyLCBwcm94eS5jaGlsZEluZGV4KTtcbiAgICAgICAgICBwcm94eS5hYWJiLmNvbWJpbmUoc3luY2hyb25pemVfYWFiYjEsIHN5bmNocm9uaXplX2FhYmIyKTtcbiAgICAgICAgICBzdWJWZWMyKGRpc3BsYWNlbWVudCwgeGYyLnAsIHhmMS5wKTtcbiAgICAgICAgICBicm9hZFBoYXNlLm1vdmVQcm94eShwcm94eS5wcm94eUlkLCBwcm94eS5hYWJiLCBkaXNwbGFjZW1lbnQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNldEZpbHRlckRhdGEgPSBmdW5jdGlvbihmaWx0ZXIpIHtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXggPSBmaWx0ZXIuZ3JvdXBJbmRleDtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckNhdGVnb3J5Qml0cyA9IGZpbHRlci5jYXRlZ29yeUJpdHM7XG4gICAgICAgIHRoaXMubV9maWx0ZXJNYXNrQml0cyA9IGZpbHRlci5tYXNrQml0cztcbiAgICAgICAgdGhpcy5yZWZpbHRlcigpO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5nZXRGaWx0ZXJHcm91cEluZGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZmlsdGVyR3JvdXBJbmRleDtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0RmlsdGVyR3JvdXBJbmRleCA9IGZ1bmN0aW9uKGdyb3VwSW5kZXgpIHtcbiAgICAgICAgdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXggPSBncm91cEluZGV4O1xuICAgICAgICB0aGlzLnJlZmlsdGVyKCk7XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLmdldEZpbHRlckNhdGVnb3J5Qml0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZpbHRlckNhdGVnb3J5Qml0cztcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0RmlsdGVyQ2F0ZWdvcnlCaXRzID0gZnVuY3Rpb24oY2F0ZWdvcnlCaXRzKSB7XG4gICAgICAgIHRoaXMubV9maWx0ZXJDYXRlZ29yeUJpdHMgPSBjYXRlZ29yeUJpdHM7XG4gICAgICAgIHRoaXMucmVmaWx0ZXIoKTtcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuZ2V0RmlsdGVyTWFza0JpdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9maWx0ZXJNYXNrQml0cztcbiAgICAgIH07XG4gICAgICBGaXh0dXJlMi5wcm90b3R5cGUuc2V0RmlsdGVyTWFza0JpdHMgPSBmdW5jdGlvbihtYXNrQml0cykge1xuICAgICAgICB0aGlzLm1fZmlsdGVyTWFza0JpdHMgPSBtYXNrQml0cztcbiAgICAgICAgdGhpcy5yZWZpbHRlcigpO1xuICAgICAgfTtcbiAgICAgIEZpeHR1cmUyLnByb3RvdHlwZS5yZWZpbHRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5tX2JvZHkgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZWRnZSA9IHRoaXMubV9ib2R5LmdldENvbnRhY3RMaXN0KCk7XG4gICAgICAgIHdoaWxlIChlZGdlKSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSBlZGdlLmNvbnRhY3Q7XG4gICAgICAgICAgdmFyIGZpeHR1cmVBID0gY29udGFjdC5nZXRGaXh0dXJlQSgpO1xuICAgICAgICAgIHZhciBmaXh0dXJlQiA9IGNvbnRhY3QuZ2V0Rml4dHVyZUIoKTtcbiAgICAgICAgICBpZiAoZml4dHVyZUEgPT0gdGhpcyB8fCBmaXh0dXJlQiA9PSB0aGlzKSB7XG4gICAgICAgICAgICBjb250YWN0LmZsYWdGb3JGaWx0ZXJpbmcoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgd29ybGQgPSB0aGlzLm1fYm9keS5nZXRXb3JsZCgpO1xuICAgICAgICBpZiAod29ybGQgPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHdvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fcHJveHlDb3VudDsgKytpKSB7XG4gICAgICAgICAgYnJvYWRQaGFzZS50b3VjaFByb3h5KHRoaXMubV9wcm94aWVzW2ldLnByb3h5SWQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRml4dHVyZTIucHJvdG90eXBlLnNob3VsZENvbGxpZGUgPSBmdW5jdGlvbih0aGF0KSB7XG4gICAgICAgIGlmICh0aGF0Lm1fZmlsdGVyR3JvdXBJbmRleCA9PT0gdGhpcy5tX2ZpbHRlckdyb3VwSW5kZXggJiYgdGhhdC5tX2ZpbHRlckdyb3VwSW5kZXggIT09IDApIHtcbiAgICAgICAgICByZXR1cm4gdGhhdC5tX2ZpbHRlckdyb3VwSW5kZXggPiAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb2xsaWRlQSA9ICh0aGF0Lm1fZmlsdGVyTWFza0JpdHMgJiB0aGlzLm1fZmlsdGVyQ2F0ZWdvcnlCaXRzKSAhPT0gMDtcbiAgICAgICAgdmFyIGNvbGxpZGVCID0gKHRoYXQubV9maWx0ZXJDYXRlZ29yeUJpdHMgJiB0aGlzLm1fZmlsdGVyTWFza0JpdHMpICE9PSAwO1xuICAgICAgICB2YXIgY29sbGlkZSA9IGNvbGxpZGVBICYmIGNvbGxpZGVCO1xuICAgICAgICByZXR1cm4gY29sbGlkZTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gRml4dHVyZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBTVEFUSUMgPSBcInN0YXRpY1wiO1xuICB2YXIgS0lORU1BVElDID0gXCJraW5lbWF0aWNcIjtcbiAgdmFyIERZTkFNSUMgPSBcImR5bmFtaWNcIjtcbiAgdmFyIG9sZENlbnRlciA9IHZlYzIoMCwgMCk7XG4gIHZhciBsb2NhbENlbnRlciA9IHZlYzIoMCwgMCk7XG4gIHZhciBzaGlmdCA9IHZlYzIoMCwgMCk7XG4gIHZhciB0ZW1wJDYgPSB2ZWMyKDAsIDApO1xuICB2YXIgeGYkMiA9IHRyYW5zZm9ybSgwLCAwLCAwKTtcbiAgdmFyIEJvZHlEZWZEZWZhdWx0ID0ge1xuICAgIHR5cGU6IFNUQVRJQyxcbiAgICBwb3NpdGlvbjogVmVjMi56ZXJvKCksXG4gICAgYW5nbGU6IDAsXG4gICAgbGluZWFyVmVsb2NpdHk6IFZlYzIuemVybygpLFxuICAgIGFuZ3VsYXJWZWxvY2l0eTogMCxcbiAgICBsaW5lYXJEYW1waW5nOiAwLFxuICAgIGFuZ3VsYXJEYW1waW5nOiAwLFxuICAgIGZpeGVkUm90YXRpb246IGZhbHNlLFxuICAgIGJ1bGxldDogZmFsc2UsXG4gICAgZ3Jhdml0eVNjYWxlOiAxLFxuICAgIGFsbG93U2xlZXA6IHRydWUsXG4gICAgYXdha2U6IHRydWUsXG4gICAgYWN0aXZlOiB0cnVlLFxuICAgIHVzZXJEYXRhOiBudWxsXG4gIH07XG4gIHZhciBCb2R5ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIEJvZHkyKHdvcmxkLCBkZWYpIHtcbiAgICAgICAgdGhpcy5zdHlsZSA9IHt9O1xuICAgICAgICB0aGlzLmFwcERhdGEgPSB7fTtcbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIEJvZHlEZWZEZWZhdWx0KTtcbiAgICAgICAgdGhpcy5tX3dvcmxkID0gd29ybGQ7XG4gICAgICAgIHRoaXMubV9hd2FrZUZsYWcgPSBkZWYuYXdha2U7XG4gICAgICAgIHRoaXMubV9hdXRvU2xlZXBGbGFnID0gZGVmLmFsbG93U2xlZXA7XG4gICAgICAgIHRoaXMubV9idWxsZXRGbGFnID0gZGVmLmJ1bGxldDtcbiAgICAgICAgdGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnID0gZGVmLmZpeGVkUm90YXRpb247XG4gICAgICAgIHRoaXMubV9hY3RpdmVGbGFnID0gZGVmLmFjdGl2ZTtcbiAgICAgICAgdGhpcy5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX3RvaUZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX3VzZXJEYXRhID0gZGVmLnVzZXJEYXRhO1xuICAgICAgICB0aGlzLm1fdHlwZSA9IGRlZi50eXBlO1xuICAgICAgICBpZiAodGhpcy5tX3R5cGUgPT0gRFlOQU1JQykge1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gMTtcbiAgICAgICAgICB0aGlzLm1faW52TWFzcyA9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSAwO1xuICAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fSSA9IDA7XG4gICAgICAgIHRoaXMubV9pbnZJID0gMDtcbiAgICAgICAgdGhpcy5tX3hmID0gVHJhbnNmb3JtLmlkZW50aXR5KCk7XG4gICAgICAgIHRoaXMubV94Zi5wLnNldFZlYzIoZGVmLnBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5tX3hmLnEuc2V0QW5nbGUoZGVmLmFuZ2xlKTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwID0gbmV3IFN3ZWVwKCk7XG4gICAgICAgIHRoaXMubV9zd2VlcC5zZXRUcmFuc2Zvcm0odGhpcy5tX3hmKTtcbiAgICAgICAgdGhpcy5jX3ZlbG9jaXR5ID0gbmV3IFZlbG9jaXR5KCk7XG4gICAgICAgIHRoaXMuY19wb3NpdGlvbiA9IG5ldyBQb3NpdGlvbigpO1xuICAgICAgICB0aGlzLm1fZm9yY2UgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgdGhpcy5tX3RvcnF1ZSA9IDA7XG4gICAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eSA9IFZlYzIuY2xvbmUoZGVmLmxpbmVhclZlbG9jaXR5KTtcbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IGRlZi5hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgIHRoaXMubV9saW5lYXJEYW1waW5nID0gZGVmLmxpbmVhckRhbXBpbmc7XG4gICAgICAgIHRoaXMubV9hbmd1bGFyRGFtcGluZyA9IGRlZi5hbmd1bGFyRGFtcGluZztcbiAgICAgICAgdGhpcy5tX2dyYXZpdHlTY2FsZSA9IGRlZi5ncmF2aXR5U2NhbGU7XG4gICAgICAgIHRoaXMubV9zbGVlcFRpbWUgPSAwO1xuICAgICAgICB0aGlzLm1fam9pbnRMaXN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2ZpeHR1cmVMaXN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9kZXN0cm95ZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKHR5cGVvZiBkZWYuc3R5bGUgPT09IFwib2JqZWN0XCIgJiYgZGVmLnN0eWxlICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5zdHlsZSA9IGRlZi5zdHlsZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgQm9keTIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVzID0gW107XG4gICAgICAgIGZvciAodmFyIGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgIGZpeHR1cmVzLnB1c2goZik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBidWxsZXQ6IHRoaXMubV9idWxsZXRGbGFnLFxuICAgICAgICAgIHBvc2l0aW9uOiB0aGlzLm1feGYucCxcbiAgICAgICAgICBhbmdsZTogdGhpcy5tX3hmLnEuZ2V0QW5nbGUoKSxcbiAgICAgICAgICBsaW5lYXJWZWxvY2l0eTogdGhpcy5tX2xpbmVhclZlbG9jaXR5LFxuICAgICAgICAgIGFuZ3VsYXJWZWxvY2l0eTogdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSxcbiAgICAgICAgICBmaXh0dXJlc1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIHZhciBib2R5ID0gbmV3IEJvZHkyKHdvcmxkLCBkYXRhKTtcbiAgICAgICAgaWYgKGRhdGEuZml4dHVyZXMpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gZGF0YS5maXh0dXJlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGZpeHR1cmUgPSByZXN0b3JlKEZpeHR1cmUsIGRhdGEuZml4dHVyZXNbaV0sIGJvZHkpO1xuICAgICAgICAgICAgYm9keS5fYWRkRml4dHVyZShmaXh0dXJlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJvZHk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzV29ybGRMb2NrZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV93b3JsZCAmJiB0aGlzLm1fd29ybGQuaXNMb2NrZWQoKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0V29ybGQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV93b3JsZDtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TmV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX25leHQ7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldFVzZXJEYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICB0aGlzLm1fdXNlckRhdGEgPSBkYXRhO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRVc2VyRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3VzZXJEYXRhO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRGaXh0dXJlTGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZpeHR1cmVMaXN0O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRKb2ludExpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9qb2ludExpc3Q7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldENvbnRhY3RMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzU3RhdGljID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZSA9PSBTVEFUSUM7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzRHluYW1pYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGUgPT0gRFlOQU1JQztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNLaW5lbWF0aWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlID09IEtJTkVNQVRJQztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0U3RhdGljID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2V0VHlwZShTVEFUSUMpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0RHluYW1pYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNldFR5cGUoRFlOQU1JQyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRLaW5lbWF0aWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zZXRUeXBlKEtJTkVNQVRJQyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0VHlwZSA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNXb3JsZExvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlID09IHR5cGUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3R5cGUgPSB0eXBlO1xuICAgICAgICB0aGlzLnJlc2V0TWFzc0RhdGEoKTtcbiAgICAgICAgaWYgKHRoaXMubV90eXBlID09IFNUQVRJQykge1xuICAgICAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IDA7XG4gICAgICAgICAgdGhpcy5tX3N3ZWVwLmZvcndhcmQoKTtcbiAgICAgICAgICB0aGlzLnN5bmNocm9uaXplRml4dHVyZXMoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fZm9yY2Uuc2V0WmVybygpO1xuICAgICAgICB0aGlzLm1fdG9ycXVlID0gMDtcbiAgICAgICAgdmFyIGNlID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgICAgICB3aGlsZSAoY2UpIHtcbiAgICAgICAgICB2YXIgY2UwID0gY2U7XG4gICAgICAgICAgY2UgPSBjZS5uZXh0O1xuICAgICAgICAgIHRoaXMubV93b3JsZC5kZXN0cm95Q29udGFjdChjZTAuY29udGFjdCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gbnVsbDtcbiAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICBmb3IgKHZhciBmID0gdGhpcy5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGYubV9wcm94eUNvdW50OyArK2kpIHtcbiAgICAgICAgICAgIGJyb2FkUGhhc2UudG91Y2hQcm94eShmLm1fcHJveGllc1tpXS5wcm94eUlkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNCdWxsZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9idWxsZXRGbGFnO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRCdWxsZXQgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIHRoaXMubV9idWxsZXRGbGFnID0gISFmbGFnO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc1NsZWVwaW5nQWxsb3dlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2F1dG9TbGVlcEZsYWc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldFNsZWVwaW5nQWxsb3dlZCA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX2F1dG9TbGVlcEZsYWcgPSAhIWZsYWc7XG4gICAgICAgIGlmICh0aGlzLm1fYXV0b1NsZWVwRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuaXNBd2FrZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2F3YWtlRmxhZztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0QXdha2UgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnKSB7XG4gICAgICAgICAgdGhpcy5tX2F3YWtlRmxhZyA9IHRydWU7XG4gICAgICAgICAgdGhpcy5tX3NsZWVwVGltZSA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2F3YWtlRmxhZyA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMubV9zbGVlcFRpbWUgPSAwO1xuICAgICAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IDA7XG4gICAgICAgICAgdGhpcy5tX2ZvcmNlLnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fdG9ycXVlID0gMDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5pc0FjdGl2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2FjdGl2ZUZsYWc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEFjdGl2ZSA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcgPT0gdGhpcy5tX2FjdGl2ZUZsYWcpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2FjdGl2ZUZsYWcgPSAhIWZsYWc7XG4gICAgICAgIGlmICh0aGlzLm1fYWN0aXZlRmxhZykge1xuICAgICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgICBmb3IgKHZhciBmID0gdGhpcy5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgICAgIGYuY3JlYXRlUHJveGllcyhicm9hZFBoYXNlLCB0aGlzLm1feGYpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLm1fd29ybGQubV9uZXdGaXh0dXJlID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgICBmLmRlc3Ryb3lQcm94aWVzKGJyb2FkUGhhc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgY2UgPSB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICAgICAgd2hpbGUgKGNlKSB7XG4gICAgICAgICAgICB2YXIgY2UwID0gY2U7XG4gICAgICAgICAgICBjZSA9IGNlLm5leHQ7XG4gICAgICAgICAgICB0aGlzLm1fd29ybGQuZGVzdHJveUNvbnRhY3QoY2UwLmNvbnRhY3QpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmlzRml4ZWRSb3RhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRGaXhlZFJvdGF0aW9uID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAodGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnID09IGZsYWcpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnID0gISFmbGFnO1xuICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gMDtcbiAgICAgICAgdGhpcy5yZXNldE1hc3NEYXRhKCk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldFRyYW5zZm9ybSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3hmO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNXb3JsZExvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBiMiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIHRoaXMubV94Zi5zZXROdW0oYTIsIGIyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1feGYuc2V0VHJhbnNmb3JtKGEyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fc3dlZXAuc2V0VHJhbnNmb3JtKHRoaXMubV94Zik7XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgZi5zeW5jaHJvbml6ZShicm9hZFBoYXNlLCB0aGlzLm1feGYsIHRoaXMubV94Zik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRBd2FrZSh0cnVlKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc3luY2hyb25pemVUcmFuc2Zvcm0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLmdldFRyYW5zZm9ybSh0aGlzLm1feGYsIDEpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zeW5jaHJvbml6ZUZpeHR1cmVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV9zd2VlcC5nZXRUcmFuc2Zvcm0oeGYkMiwgMCk7XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgZi5zeW5jaHJvbml6ZShicm9hZFBoYXNlLCB4ZiQyLCB0aGlzLm1feGYpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmFkdmFuY2UgPSBmdW5jdGlvbihhbHBoYSkge1xuICAgICAgICB0aGlzLm1fc3dlZXAuYWR2YW5jZShhbHBoYSk7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMubV9zd2VlcC5jLCB0aGlzLm1fc3dlZXAuYzApO1xuICAgICAgICB0aGlzLm1fc3dlZXAuYSA9IHRoaXMubV9zd2VlcC5hMDtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLmdldFRyYW5zZm9ybSh0aGlzLm1feGYsIDEpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3hmLnA7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24ocCkge1xuICAgICAgICB0aGlzLnNldFRyYW5zZm9ybShwLCB0aGlzLm1fc3dlZXAuYSk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldEFuZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc3dlZXAuYTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0QW5nbGUgPSBmdW5jdGlvbihhbmdsZSkge1xuICAgICAgICB0aGlzLnNldFRyYW5zZm9ybSh0aGlzLm1feGYucCwgYW5nbGUpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRXb3JsZENlbnRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3N3ZWVwLmM7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExvY2FsQ2VudGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExpbmVhclZlbG9jaXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExpbmVhclZlbG9jaXR5RnJvbVdvcmxkUG9pbnQgPSBmdW5jdGlvbih3b3JsZFBvaW50KSB7XG4gICAgICAgIHZhciBsb2NhbENlbnRlcjIgPSBWZWMyLnN1Yih3b3JsZFBvaW50LCB0aGlzLm1fc3dlZXAuYyk7XG4gICAgICAgIHJldHVybiBWZWMyLmFkZCh0aGlzLm1fbGluZWFyVmVsb2NpdHksIFZlYzIuY3Jvc3NOdW1WZWMyKHRoaXMubV9hbmd1bGFyVmVsb2NpdHksIGxvY2FsQ2VudGVyMikpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRMaW5lYXJWZWxvY2l0eUZyb21Mb2NhbFBvaW50ID0gZnVuY3Rpb24obG9jYWxQb2ludCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRMaW5lYXJWZWxvY2l0eUZyb21Xb3JsZFBvaW50KHRoaXMuZ2V0V29ybGRQb2ludChsb2NhbFBvaW50KSk7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldExpbmVhclZlbG9jaXR5ID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgaWYgKHRoaXMubV90eXBlID09IFNUQVRJQykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVmVjMi5kb3QodjMsIHYzKSA+IDApIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS5zZXRWZWMyKHYzKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0QW5ndWxhclZlbG9jaXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRBbmd1bGFyVmVsb2NpdHkgPSBmdW5jdGlvbih3KSB7XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSBTVEFUSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHcgKiB3ID4gMCkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IHc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldExpbmVhckRhbXBpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9saW5lYXJEYW1waW5nO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5zZXRMaW5lYXJEYW1waW5nID0gZnVuY3Rpb24obGluZWFyRGFtcGluZykge1xuICAgICAgICB0aGlzLm1fbGluZWFyRGFtcGluZyA9IGxpbmVhckRhbXBpbmc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldEFuZ3VsYXJEYW1waW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYW5ndWxhckRhbXBpbmc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldEFuZ3VsYXJEYW1waW5nID0gZnVuY3Rpb24oYW5ndWxhckRhbXBpbmcpIHtcbiAgICAgICAgdGhpcy5tX2FuZ3VsYXJEYW1waW5nID0gYW5ndWxhckRhbXBpbmc7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmdldEdyYXZpdHlTY2FsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2dyYXZpdHlTY2FsZTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2V0R3Jhdml0eVNjYWxlID0gZnVuY3Rpb24oc2NhbGUpIHtcbiAgICAgICAgdGhpcy5tX2dyYXZpdHlTY2FsZSA9IHNjYWxlO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRNYXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWFzcztcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0SW5lcnRpYSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX0kgKyB0aGlzLm1fbWFzcyAqIFZlYzIuZG90KHRoaXMubV9zd2VlcC5sb2NhbENlbnRlciwgdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TWFzc0RhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGRhdGEubWFzcyA9IHRoaXMubV9tYXNzO1xuICAgICAgICBkYXRhLkkgPSB0aGlzLmdldEluZXJ0aWEoKTtcbiAgICAgICAgY29weVZlYzIoZGF0YS5jZW50ZXIsIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcik7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnJlc2V0TWFzc0RhdGEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX21hc3MgPSAwO1xuICAgICAgICB0aGlzLm1faW52TWFzcyA9IDA7XG4gICAgICAgIHRoaXMubV9JID0gMDtcbiAgICAgICAgdGhpcy5tX2ludkkgPSAwO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIpO1xuICAgICAgICBpZiAodGhpcy5pc1N0YXRpYygpIHx8IHRoaXMuaXNLaW5lbWF0aWMoKSkge1xuICAgICAgICAgIGNvcHlWZWMyKHRoaXMubV9zd2VlcC5jMCwgdGhpcy5tX3hmLnApO1xuICAgICAgICAgIGNvcHlWZWMyKHRoaXMubV9zd2VlcC5jLCB0aGlzLm1feGYucCk7XG4gICAgICAgICAgdGhpcy5tX3N3ZWVwLmEwID0gdGhpcy5tX3N3ZWVwLmE7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHplcm9WZWMyKGxvY2FsQ2VudGVyKTtcbiAgICAgICAgZm9yICh2YXIgZiA9IHRoaXMubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgaWYgKGYubV9kZW5zaXR5ID09IDApIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgbWFzc0RhdGEgPSB7XG4gICAgICAgICAgICBtYXNzOiAwLFxuICAgICAgICAgICAgY2VudGVyOiB2ZWMyKDAsIDApLFxuICAgICAgICAgICAgSTogMFxuICAgICAgICAgIH07XG4gICAgICAgICAgZi5nZXRNYXNzRGF0YShtYXNzRGF0YSk7XG4gICAgICAgICAgdGhpcy5tX21hc3MgKz0gbWFzc0RhdGEubWFzcztcbiAgICAgICAgICBwbHVzU2NhbGVWZWMyKGxvY2FsQ2VudGVyLCBtYXNzRGF0YS5tYXNzLCBtYXNzRGF0YS5jZW50ZXIpO1xuICAgICAgICAgIHRoaXMubV9JICs9IG1hc3NEYXRhLkk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9tYXNzID4gMCkge1xuICAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMSAvIHRoaXMubV9tYXNzO1xuICAgICAgICAgIHNjYWxlVmVjMihsb2NhbENlbnRlciwgdGhpcy5tX2ludk1hc3MsIGxvY2FsQ2VudGVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fbWFzcyA9IDE7XG4gICAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fSSA+IDAgJiYgdGhpcy5tX2ZpeGVkUm90YXRpb25GbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5tX0kgLT0gdGhpcy5tX21hc3MgKiBkb3RWZWMyKGxvY2FsQ2VudGVyLCBsb2NhbENlbnRlcik7XG4gICAgICAgICAgdGhpcy5tX2ludkkgPSAxIC8gdGhpcy5tX0k7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX0kgPSAwO1xuICAgICAgICAgIHRoaXMubV9pbnZJID0gMDtcbiAgICAgICAgfVxuICAgICAgICBjb3B5VmVjMihvbGRDZW50ZXIsIHRoaXMubV9zd2VlcC5jKTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwLnNldExvY2FsQ2VudGVyKGxvY2FsQ2VudGVyLCB0aGlzLm1feGYpO1xuICAgICAgICBzdWJWZWMyKHNoaWZ0LCB0aGlzLm1fc3dlZXAuYywgb2xkQ2VudGVyKTtcbiAgICAgICAgY3Jvc3NOdW1WZWMyKHRlbXAkNiwgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSwgc2hpZnQpO1xuICAgICAgICBwbHVzVmVjMih0aGlzLm1fbGluZWFyVmVsb2NpdHksIHRlbXAkNik7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLnNldE1hc3NEYXRhID0gZnVuY3Rpb24obWFzc0RhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNXb3JsZExvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAwO1xuICAgICAgICB0aGlzLm1fSSA9IDA7XG4gICAgICAgIHRoaXMubV9pbnZJID0gMDtcbiAgICAgICAgdGhpcy5tX21hc3MgPSBtYXNzRGF0YS5tYXNzO1xuICAgICAgICBpZiAodGhpcy5tX21hc3MgPD0gMCkge1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1faW52TWFzcyA9IDEgLyB0aGlzLm1fbWFzcztcbiAgICAgICAgaWYgKG1hc3NEYXRhLkkgPiAwICYmIHRoaXMubV9maXhlZFJvdGF0aW9uRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMubV9JID0gbWFzc0RhdGEuSSAtIHRoaXMubV9tYXNzICogZG90VmVjMihtYXNzRGF0YS5jZW50ZXIsIG1hc3NEYXRhLmNlbnRlcik7XG4gICAgICAgICAgdGhpcy5tX2ludkkgPSAxIC8gdGhpcy5tX0k7XG4gICAgICAgIH1cbiAgICAgICAgY29weVZlYzIob2xkQ2VudGVyLCB0aGlzLm1fc3dlZXAuYyk7XG4gICAgICAgIHRoaXMubV9zd2VlcC5zZXRMb2NhbENlbnRlcihtYXNzRGF0YS5jZW50ZXIsIHRoaXMubV94Zik7XG4gICAgICAgIHN1YlZlYzIoc2hpZnQsIHRoaXMubV9zd2VlcC5jLCBvbGRDZW50ZXIpO1xuICAgICAgICBjcm9zc051bVZlYzIodGVtcCQ2LCB0aGlzLm1fYW5ndWxhclZlbG9jaXR5LCBzaGlmdCk7XG4gICAgICAgIHBsdXNWZWMyKHRoaXMubV9saW5lYXJWZWxvY2l0eSwgdGVtcCQ2KTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuYXBwbHlGb3JjZSA9IGZ1bmN0aW9uKGZvcmNlLCBwb2ludDIsIHdha2UpIHtcbiAgICAgICAgaWYgKHdha2UgPT09IHZvaWQgMCkge1xuICAgICAgICAgIHdha2UgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBEWU5BTUlDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3YWtlICYmIHRoaXMubV9hd2FrZUZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYXdha2VGbGFnKSB7XG4gICAgICAgICAgdGhpcy5tX2ZvcmNlLmFkZChmb3JjZSk7XG4gICAgICAgICAgdGhpcy5tX3RvcnF1ZSArPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5zdWIocG9pbnQyLCB0aGlzLm1fc3dlZXAuYyksIGZvcmNlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5hcHBseUZvcmNlVG9DZW50ZXIgPSBmdW5jdGlvbihmb3JjZSwgd2FrZSkge1xuICAgICAgICBpZiAod2FrZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgd2FrZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdha2UgJiYgdGhpcy5tX2F3YWtlRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9hd2FrZUZsYWcpIHtcbiAgICAgICAgICB0aGlzLm1fZm9yY2UuYWRkKGZvcmNlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5hcHBseVRvcnF1ZSA9IGZ1bmN0aW9uKHRvcnF1ZSwgd2FrZSkge1xuICAgICAgICBpZiAod2FrZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgd2FrZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdha2UgJiYgdGhpcy5tX2F3YWtlRmxhZyA9PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9hd2FrZUZsYWcpIHtcbiAgICAgICAgICB0aGlzLm1fdG9ycXVlICs9IHRvcnF1ZTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5hcHBseUxpbmVhckltcHVsc2UgPSBmdW5jdGlvbihpbXB1bHNlLCBwb2ludDIsIHdha2UpIHtcbiAgICAgICAgaWYgKHdha2UgPT09IHZvaWQgMCkge1xuICAgICAgICAgIHdha2UgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBEWU5BTUlDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3YWtlICYmIHRoaXMubV9hd2FrZUZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYXdha2VGbGFnKSB7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LmFkZE11bCh0aGlzLm1faW52TWFzcywgaW1wdWxzZSk7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSArPSB0aGlzLm1faW52SSAqIFZlYzIuY3Jvc3NWZWMyVmVjMihWZWMyLnN1Yihwb2ludDIsIHRoaXMubV9zd2VlcC5jKSwgaW1wdWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuYXBwbHlBbmd1bGFySW1wdWxzZSA9IGZ1bmN0aW9uKGltcHVsc2UsIHdha2UpIHtcbiAgICAgICAgaWYgKHdha2UgPT09IHZvaWQgMCkge1xuICAgICAgICAgIHdha2UgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBEWU5BTUlDKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3YWtlICYmIHRoaXMubV9hd2FrZUZsYWcgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYXdha2VGbGFnKSB7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSArPSB0aGlzLm1faW52SSAqIGltcHVsc2U7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuc2hvdWxkQ29sbGlkZSA9IGZ1bmN0aW9uKHRoYXQpIHtcbiAgICAgICAgaWYgKHRoaXMubV90eXBlICE9IERZTkFNSUMgJiYgdGhhdC5tX3R5cGUgIT0gRFlOQU1JQykge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBqbiA9IHRoaXMubV9qb2ludExpc3Q7IGpuOyBqbiA9IGpuLm5leHQpIHtcbiAgICAgICAgICBpZiAoam4ub3RoZXIgPT0gdGhhdCkge1xuICAgICAgICAgICAgaWYgKGpuLmpvaW50Lm1fY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5fYWRkRml4dHVyZSA9IGZ1bmN0aW9uKGZpeHR1cmUpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNXb3JsZExvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2FjdGl2ZUZsYWcpIHtcbiAgICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2Jyb2FkUGhhc2U7XG4gICAgICAgICAgZml4dHVyZS5jcmVhdGVQcm94aWVzKGJyb2FkUGhhc2UsIHRoaXMubV94Zik7XG4gICAgICAgIH1cbiAgICAgICAgZml4dHVyZS5tX25leHQgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XG4gICAgICAgIHRoaXMubV9maXh0dXJlTGlzdCA9IGZpeHR1cmU7XG4gICAgICAgIGlmIChmaXh0dXJlLm1fZGVuc2l0eSA+IDApIHtcbiAgICAgICAgICB0aGlzLnJlc2V0TWFzc0RhdGEoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fd29ybGQubV9uZXdGaXh0dXJlID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIGZpeHR1cmU7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmNyZWF0ZUZpeHR1cmUgPSBmdW5jdGlvbihzaGFwZSwgZml4ZGVmKSB7XG4gICAgICAgIGlmICh0aGlzLmlzV29ybGRMb2NrZWQoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpeHR1cmUgPSBuZXcgRml4dHVyZSh0aGlzLCBzaGFwZSwgZml4ZGVmKTtcbiAgICAgICAgdGhpcy5fYWRkRml4dHVyZShmaXh0dXJlKTtcbiAgICAgICAgcmV0dXJuIGZpeHR1cmU7XG4gICAgICB9O1xuICAgICAgQm9keTIucHJvdG90eXBlLmRlc3Ryb3lGaXh0dXJlID0gZnVuY3Rpb24oZml4dHVyZSkge1xuICAgICAgICBpZiAodGhpcy5pc1dvcmxkTG9ja2VkKCkgPT0gdHJ1ZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2ZpeHR1cmVMaXN0ID09PSBmaXh0dXJlKSB7XG4gICAgICAgICAgdGhpcy5tX2ZpeHR1cmVMaXN0ID0gZml4dHVyZS5tX25leHQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XG4gICAgICAgICAgd2hpbGUgKG5vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKG5vZGUubV9uZXh0ID09PSBmaXh0dXJlKSB7XG4gICAgICAgICAgICAgIG5vZGUubV9uZXh0ID0gZml4dHVyZS5tX25leHQ7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZSA9IG5vZGUubV9uZXh0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZWRnZSA9IHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgICAgd2hpbGUgKGVkZ2UpIHtcbiAgICAgICAgICB2YXIgYzIgPSBlZGdlLmNvbnRhY3Q7XG4gICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcbiAgICAgICAgICB2YXIgZml4dHVyZUEgPSBjMi5nZXRGaXh0dXJlQSgpO1xuICAgICAgICAgIHZhciBmaXh0dXJlQiA9IGMyLmdldEZpeHR1cmVCKCk7XG4gICAgICAgICAgaWYgKGZpeHR1cmUgPT0gZml4dHVyZUEgfHwgZml4dHVyZSA9PSBmaXh0dXJlQikge1xuICAgICAgICAgICAgdGhpcy5tX3dvcmxkLmRlc3Ryb3lDb250YWN0KGMyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9hY3RpdmVGbGFnKSB7XG4gICAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9icm9hZFBoYXNlO1xuICAgICAgICAgIGZpeHR1cmUuZGVzdHJveVByb3hpZXMoYnJvYWRQaGFzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZml4dHVyZS5tX2JvZHkgPSBudWxsO1xuICAgICAgICBmaXh0dXJlLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV93b3JsZC5wdWJsaXNoKFwicmVtb3ZlLWZpeHR1cmVcIiwgZml4dHVyZSk7XG4gICAgICAgIHRoaXMucmVzZXRNYXNzRGF0YSgpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRXb3JsZFBvaW50ID0gZnVuY3Rpb24obG9jYWxQb2ludCkge1xuICAgICAgICByZXR1cm4gVHJhbnNmb3JtLm11bFZlYzIodGhpcy5tX3hmLCBsb2NhbFBvaW50KTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0V29ybGRWZWN0b3IgPSBmdW5jdGlvbihsb2NhbFZlY3Rvcikge1xuICAgICAgICByZXR1cm4gUm90Lm11bFZlYzIodGhpcy5tX3hmLnEsIGxvY2FsVmVjdG9yKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5wcm90b3R5cGUuZ2V0TG9jYWxQb2ludCA9IGZ1bmN0aW9uKHdvcmxkUG9pbnQpIHtcbiAgICAgICAgcmV0dXJuIFRyYW5zZm9ybS5tdWxUVmVjMih0aGlzLm1feGYsIHdvcmxkUG9pbnQpO1xuICAgICAgfTtcbiAgICAgIEJvZHkyLnByb3RvdHlwZS5nZXRMb2NhbFZlY3RvciA9IGZ1bmN0aW9uKHdvcmxkVmVjdG9yKSB7XG4gICAgICAgIHJldHVybiBSb3QubXVsVFZlYzIodGhpcy5tX3hmLnEsIHdvcmxkVmVjdG9yKTtcbiAgICAgIH07XG4gICAgICBCb2R5Mi5TVEFUSUMgPSBcInN0YXRpY1wiO1xuICAgICAgQm9keTIuS0lORU1BVElDID0gXCJraW5lbWF0aWNcIjtcbiAgICAgIEJvZHkyLkRZTkFNSUMgPSBcImR5bmFtaWNcIjtcbiAgICAgIHJldHVybiBCb2R5MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIEpvaW50RWRnZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gSm9pbnRFZGdlMigpIHtcbiAgICAgICAgdGhpcy5vdGhlciA9IG51bGw7XG4gICAgICAgIHRoaXMuam9pbnQgPSBudWxsO1xuICAgICAgICB0aGlzLnByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm5leHQgPSBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIEpvaW50RWRnZTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBKb2ludDIoZGVmLCBib2R5QSwgYm9keUIpIHtcbiAgICAgICAgdGhpcy5tX3R5cGUgPSBcInVua25vd24tam9pbnRcIjtcbiAgICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV9lZGdlQSA9IG5ldyBKb2ludEVkZ2UoKTtcbiAgICAgICAgdGhpcy5tX2VkZ2VCID0gbmV3IEpvaW50RWRnZSgpO1xuICAgICAgICB0aGlzLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN0eWxlID0ge307XG4gICAgICAgIHRoaXMuYXBwRGF0YSA9IHt9O1xuICAgICAgICBib2R5QSA9IFwiYm9keUFcIiBpbiBkZWYgPyBkZWYuYm9keUEgOiBib2R5QTtcbiAgICAgICAgYm9keUIgPSBcImJvZHlCXCIgaW4gZGVmID8gZGVmLmJvZHlCIDogYm9keUI7XG4gICAgICAgIHRoaXMubV9ib2R5QSA9IGJvZHlBO1xuICAgICAgICB0aGlzLm1fYm9keUIgPSBib2R5QjtcbiAgICAgICAgdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQgPSAhIWRlZi5jb2xsaWRlQ29ubmVjdGVkO1xuICAgICAgICB0aGlzLm1fdXNlckRhdGEgPSBkZWYudXNlckRhdGE7XG4gICAgICAgIGlmICh0eXBlb2YgZGVmLnN0eWxlID09PSBcIm9iamVjdFwiICYmIGRlZi5zdHlsZSAhPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuc3R5bGUgPSBkZWYuc3R5bGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuaXNBY3RpdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5pc0FjdGl2ZSgpICYmIHRoaXMubV9ib2R5Qi5pc0FjdGl2ZSgpO1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5nZXRCb2R5QSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBO1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuZ2V0Qm9keUIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QjtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLmdldE5leHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuZ2V0VXNlckRhdGEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV91c2VyRGF0YTtcbiAgICAgIH07XG4gICAgICBKb2ludDIucHJvdG90eXBlLnNldFVzZXJEYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICB0aGlzLm1fdXNlckRhdGEgPSBkYXRhO1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuZ2V0Q29sbGlkZUNvbm5lY3RlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQ7XG4gICAgICB9O1xuICAgICAgSm9pbnQyLnByb3RvdHlwZS5zaGlmdE9yaWdpbiA9IGZ1bmN0aW9uKG5ld09yaWdpbikge1xuICAgICAgfTtcbiAgICAgIEpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0QW5jaG9ycyA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVzZXQoZGVmKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gSm9pbnQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgc3RhdHMgPSB7XG4gICAgZ2prQ2FsbHM6IDAsXG4gICAgZ2prSXRlcnM6IDAsXG4gICAgZ2prTWF4SXRlcnM6IDAsXG4gICAgdG9pVGltZTogMCxcbiAgICB0b2lNYXhUaW1lOiAwLFxuICAgIHRvaUNhbGxzOiAwLFxuICAgIHRvaUl0ZXJzOiAwLFxuICAgIHRvaU1heEl0ZXJzOiAwLFxuICAgIHRvaVJvb3RJdGVyczogMCxcbiAgICB0b2lNYXhSb290SXRlcnM6IDAsXG4gICAgdG9TdHJpbmc6IGZ1bmN0aW9uKG5ld2xpbmUpIHtcbiAgICAgIG5ld2xpbmUgPSB0eXBlb2YgbmV3bGluZSA9PT0gXCJzdHJpbmdcIiA/IG5ld2xpbmUgOiBcIlxcblwiO1xuICAgICAgdmFyIHN0cmluZyA9IFwiXCI7XG4gICAgICBmb3IgKHZhciBuYW1lXzEgaW4gdGhpcykge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXNbbmFtZV8xXSAhPT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiB0aGlzW25hbWVfMV0gIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICBzdHJpbmcgKz0gbmFtZV8xICsgXCI6IFwiICsgdGhpc1tuYW1lXzFdICsgbmV3bGluZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9XG4gIH07XG4gIHZhciBub3cgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gRGF0ZS5ub3coKTtcbiAgfTtcbiAgdmFyIGRpZmYgPSBmdW5jdGlvbih0aW1lKSB7XG4gICAgcmV0dXJuIERhdGUubm93KCkgLSB0aW1lO1xuICB9O1xuICBjb25zdCBUaW1lciA9IHtcbiAgICBub3csXG4gICAgZGlmZlxuICB9O1xuICB2YXIgbWF0aF9tYXgkNCA9IE1hdGgubWF4O1xuICB2YXIgdGVtcCQ1ID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbCQ0ID0gdmVjMigwLCAwKTtcbiAgdmFyIGUxMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBlMTMgPSB2ZWMyKDAsIDApO1xuICB2YXIgZTIzID0gdmVjMigwLCAwKTtcbiAgdmFyIHRlbXAxID0gdmVjMigwLCAwKTtcbiAgdmFyIHRlbXAyID0gdmVjMigwLCAwKTtcbiAgc3RhdHMuZ2prQ2FsbHMgPSAwO1xuICBzdGF0cy5namtJdGVycyA9IDA7XG4gIHN0YXRzLmdqa01heEl0ZXJzID0gMDtcbiAgdmFyIERpc3RhbmNlSW5wdXQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gRGlzdGFuY2VJbnB1dDIoKSB7XG4gICAgICAgIHRoaXMucHJveHlBID0gbmV3IERpc3RhbmNlUHJveHkoKTtcbiAgICAgICAgdGhpcy5wcm94eUIgPSBuZXcgRGlzdGFuY2VQcm94eSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUEgPSBUcmFuc2Zvcm0uaWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1CID0gVHJhbnNmb3JtLmlkZW50aXR5KCk7XG4gICAgICAgIHRoaXMudXNlUmFkaWkgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIERpc3RhbmNlSW5wdXQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucHJveHlBLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5wcm94eUIucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUEuc2V0SWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1CLnNldElkZW50aXR5KCk7XG4gICAgICAgIHRoaXMudXNlUmFkaWkgPSBmYWxzZTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gRGlzdGFuY2VJbnB1dDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBEaXN0YW5jZU91dHB1dCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBEaXN0YW5jZU91dHB1dDIoKSB7XG4gICAgICAgIHRoaXMucG9pbnRBID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5wb2ludEIgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLmRpc3RhbmNlID0gMDtcbiAgICAgICAgdGhpcy5pdGVyYXRpb25zID0gMDtcbiAgICAgIH1cbiAgICAgIERpc3RhbmNlT3V0cHV0Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBvaW50QSk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMucG9pbnRCKTtcbiAgICAgICAgdGhpcy5kaXN0YW5jZSA9IDA7XG4gICAgICAgIHRoaXMuaXRlcmF0aW9ucyA9IDA7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIERpc3RhbmNlT3V0cHV0MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFNpbXBsZXhDYWNoZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTaW1wbGV4Q2FjaGUyKCkge1xuICAgICAgICB0aGlzLm1ldHJpYyA9IDA7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gW107XG4gICAgICAgIHRoaXMuaW5kZXhCID0gW107XG4gICAgICAgIHRoaXMuY291bnQgPSAwO1xuICAgICAgfVxuICAgICAgU2ltcGxleENhY2hlMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1ldHJpYyA9IDA7XG4gICAgICAgIHRoaXMuaW5kZXhBLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuaW5kZXhCLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuY291bnQgPSAwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTaW1wbGV4Q2FjaGUyO1xuICAgIH0oKVxuICApO1xuICB2YXIgRGlzdGFuY2UgPSBmdW5jdGlvbihvdXRwdXQyLCBjYWNoZTIsIGlucHV0Mikge1xuICAgICsrc3RhdHMuZ2prQ2FsbHM7XG4gICAgdmFyIHByb3h5QSA9IGlucHV0Mi5wcm94eUE7XG4gICAgdmFyIHByb3h5QiA9IGlucHV0Mi5wcm94eUI7XG4gICAgdmFyIHhmQTIgPSBpbnB1dDIudHJhbnNmb3JtQTtcbiAgICB2YXIgeGZCMiA9IGlucHV0Mi50cmFuc2Zvcm1CO1xuICAgIHNpbXBsZXgucmVjeWNsZSgpO1xuICAgIHNpbXBsZXgucmVhZENhY2hlKGNhY2hlMiwgcHJveHlBLCB4ZkEyLCBwcm94eUIsIHhmQjIpO1xuICAgIHZhciB2ZXJ0aWNlcyA9IHNpbXBsZXgubV92O1xuICAgIHZhciBrX21heEl0ZXJzID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhEaXN0YW5jZUl0ZXJhdGlvbnM7XG4gICAgdmFyIHNhdmVBID0gW107XG4gICAgdmFyIHNhdmVCID0gW107XG4gICAgdmFyIHNhdmVDb3VudCA9IDA7XG4gICAgdmFyIGl0ZXIgPSAwO1xuICAgIHdoaWxlIChpdGVyIDwga19tYXhJdGVycykge1xuICAgICAgc2F2ZUNvdW50ID0gc2ltcGxleC5tX2NvdW50O1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzYXZlQ291bnQ7ICsraSkge1xuICAgICAgICBzYXZlQVtpXSA9IHZlcnRpY2VzW2ldLmluZGV4QTtcbiAgICAgICAgc2F2ZUJbaV0gPSB2ZXJ0aWNlc1tpXS5pbmRleEI7XG4gICAgICB9XG4gICAgICBzaW1wbGV4LnNvbHZlKCk7XG4gICAgICBpZiAoc2ltcGxleC5tX2NvdW50ID09PSAzKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgdmFyIGQyID0gc2ltcGxleC5nZXRTZWFyY2hEaXJlY3Rpb24oKTtcbiAgICAgIGlmIChsZW5ndGhTcXJWZWMyKGQyKSA8IEVQU0lMT04gKiBFUFNJTE9OKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgdmFyIHZlcnRleCA9IHZlcnRpY2VzW3NpbXBsZXgubV9jb3VudF07XG4gICAgICB2ZXJ0ZXguaW5kZXhBID0gcHJveHlBLmdldFN1cHBvcnQoZGVyb3RWZWMyKHRlbXAkNSwgeGZBMi5xLCBzY2FsZVZlYzIodGVtcCQ1LCAtMSwgZDIpKSk7XG4gICAgICB0cmFuc2Zvcm1WZWMyKHZlcnRleC53QSwgeGZBMiwgcHJveHlBLmdldFZlcnRleCh2ZXJ0ZXguaW5kZXhBKSk7XG4gICAgICB2ZXJ0ZXguaW5kZXhCID0gcHJveHlCLmdldFN1cHBvcnQoZGVyb3RWZWMyKHRlbXAkNSwgeGZCMi5xLCBkMikpO1xuICAgICAgdHJhbnNmb3JtVmVjMih2ZXJ0ZXgud0IsIHhmQjIsIHByb3h5Qi5nZXRWZXJ0ZXgodmVydGV4LmluZGV4QikpO1xuICAgICAgc3ViVmVjMih2ZXJ0ZXgudywgdmVydGV4LndCLCB2ZXJ0ZXgud0EpO1xuICAgICAgKytpdGVyO1xuICAgICAgKytzdGF0cy5namtJdGVycztcbiAgICAgIHZhciBkdXBsaWNhdGUgPSBmYWxzZTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2F2ZUNvdW50OyArK2kpIHtcbiAgICAgICAgaWYgKHZlcnRleC5pbmRleEEgPT09IHNhdmVBW2ldICYmIHZlcnRleC5pbmRleEIgPT09IHNhdmVCW2ldKSB7XG4gICAgICAgICAgZHVwbGljYXRlID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGR1cGxpY2F0ZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgICsrc2ltcGxleC5tX2NvdW50O1xuICAgIH1cbiAgICBzdGF0cy5namtNYXhJdGVycyA9IG1hdGhfbWF4JDQoc3RhdHMuZ2prTWF4SXRlcnMsIGl0ZXIpO1xuICAgIHNpbXBsZXguZ2V0V2l0bmVzc1BvaW50cyhvdXRwdXQyLnBvaW50QSwgb3V0cHV0Mi5wb2ludEIpO1xuICAgIG91dHB1dDIuZGlzdGFuY2UgPSBkaXN0VmVjMihvdXRwdXQyLnBvaW50QSwgb3V0cHV0Mi5wb2ludEIpO1xuICAgIG91dHB1dDIuaXRlcmF0aW9ucyA9IGl0ZXI7XG4gICAgc2ltcGxleC53cml0ZUNhY2hlKGNhY2hlMik7XG4gICAgaWYgKGlucHV0Mi51c2VSYWRpaSkge1xuICAgICAgdmFyIHJBMiA9IHByb3h5QS5tX3JhZGl1cztcbiAgICAgIHZhciByQjIgPSBwcm94eUIubV9yYWRpdXM7XG4gICAgICBpZiAob3V0cHV0Mi5kaXN0YW5jZSA+IHJBMiArIHJCMiAmJiBvdXRwdXQyLmRpc3RhbmNlID4gRVBTSUxPTikge1xuICAgICAgICBvdXRwdXQyLmRpc3RhbmNlIC09IHJBMiArIHJCMjtcbiAgICAgICAgc3ViVmVjMihub3JtYWwkNCwgb3V0cHV0Mi5wb2ludEIsIG91dHB1dDIucG9pbnRBKTtcbiAgICAgICAgbm9ybWFsaXplVmVjMihub3JtYWwkNCk7XG4gICAgICAgIHBsdXNTY2FsZVZlYzIob3V0cHV0Mi5wb2ludEEsIHJBMiwgbm9ybWFsJDQpO1xuICAgICAgICBtaW51c1NjYWxlVmVjMihvdXRwdXQyLnBvaW50QiwgckIyLCBub3JtYWwkNCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcCA9IHN1YlZlYzIodGVtcCQ1LCBvdXRwdXQyLnBvaW50QSwgb3V0cHV0Mi5wb2ludEIpO1xuICAgICAgICBjb3B5VmVjMihvdXRwdXQyLnBvaW50QSwgcCk7XG4gICAgICAgIGNvcHlWZWMyKG91dHB1dDIucG9pbnRCLCBwKTtcbiAgICAgICAgb3V0cHV0Mi5kaXN0YW5jZSA9IDA7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICB2YXIgRGlzdGFuY2VQcm94eSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBEaXN0YW5jZVByb3h5MigpIHtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIHRoaXMubV9jb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV9yYWRpdXMgPSAwO1xuICAgICAgfVxuICAgICAgRGlzdGFuY2VQcm94eTIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMubV9jb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV9yYWRpdXMgPSAwO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5nZXRWZXJ0ZXhDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvdW50O1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5nZXRWZXJ0ZXggPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzW2luZGV4XTtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZVByb3h5Mi5wcm90b3R5cGUuZ2V0U3VwcG9ydCA9IGZ1bmN0aW9uKGQyKSB7XG4gICAgICAgIHZhciBiZXN0SW5kZXggPSAtMTtcbiAgICAgICAgdmFyIGJlc3RWYWx1ZSA9IC1JbmZpbml0eTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciB2YWx1ZSA9IGRvdFZlYzIodGhpcy5tX3ZlcnRpY2VzW2ldLCBkMik7XG4gICAgICAgICAgaWYgKHZhbHVlID4gYmVzdFZhbHVlKSB7XG4gICAgICAgICAgICBiZXN0SW5kZXggPSBpO1xuICAgICAgICAgICAgYmVzdFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiZXN0SW5kZXg7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VQcm94eTIucHJvdG90eXBlLmdldFN1cHBvcnRWZXJ0ZXggPSBmdW5jdGlvbihkMikge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzW3RoaXMuZ2V0U3VwcG9ydChkMildO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihzaGFwZSwgaW5kZXgpIHtcbiAgICAgICAgc2hhcGUuY29tcHV0ZURpc3RhbmNlUHJveHkodGhpcywgaW5kZXgpO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlUHJveHkyLnByb3RvdHlwZS5zZXRWZXJ0aWNlcyA9IGZ1bmN0aW9uKHZlcnRpY2VzLCBjb3VudCwgcmFkaXVzKSB7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlcyA9IHZlcnRpY2VzO1xuICAgICAgICB0aGlzLm1fY291bnQgPSBjb3VudDtcbiAgICAgICAgdGhpcy5tX3JhZGl1cyA9IHJhZGl1cztcbiAgICAgIH07XG4gICAgICByZXR1cm4gRGlzdGFuY2VQcm94eTI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBTaW1wbGV4VmVydGV4ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNpbXBsZXhWZXJ0ZXgyKCkge1xuICAgICAgICB0aGlzLndBID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAwO1xuICAgICAgICB0aGlzLndCID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSAwO1xuICAgICAgICB0aGlzLncgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLmEgPSAwO1xuICAgICAgfVxuICAgICAgU2ltcGxleFZlcnRleDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAwO1xuICAgICAgICB0aGlzLmluZGV4QiA9IDA7XG4gICAgICAgIHplcm9WZWMyKHRoaXMud0EpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLndCKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy53KTtcbiAgICAgICAgdGhpcy5hID0gMDtcbiAgICAgIH07XG4gICAgICBTaW1wbGV4VmVydGV4Mi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgdGhpcy5pbmRleEEgPSB2My5pbmRleEE7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gdjMuaW5kZXhCO1xuICAgICAgICBjb3B5VmVjMih0aGlzLndBLCB2My53QSk7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMud0IsIHYzLndCKTtcbiAgICAgICAgY29weVZlYzIodGhpcy53LCB2My53KTtcbiAgICAgICAgdGhpcy5hID0gdjMuYTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gU2ltcGxleFZlcnRleDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBzZWFyY2hEaXJlY3Rpb25fcmV1c2UgPSB2ZWMyKDAsIDApO1xuICB2YXIgY2xvc2VzdFBvaW50X3JldXNlID0gdmVjMigwLCAwKTtcbiAgdmFyIFNpbXBsZXggPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2ltcGxleDIoKSB7XG4gICAgICAgIHRoaXMubV92MSA9IG5ldyBTaW1wbGV4VmVydGV4KCk7XG4gICAgICAgIHRoaXMubV92MiA9IG5ldyBTaW1wbGV4VmVydGV4KCk7XG4gICAgICAgIHRoaXMubV92MyA9IG5ldyBTaW1wbGV4VmVydGV4KCk7XG4gICAgICAgIHRoaXMubV92ID0gW3RoaXMubV92MSwgdGhpcy5tX3YyLCB0aGlzLm1fdjNdO1xuICAgICAgfVxuICAgICAgU2ltcGxleDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX3YxLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5tX3YyLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5tX3YzLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gMDtcbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMubV9jb3VudCA9PT0gMykge1xuICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBcIitcIiArIHRoaXMubV9jb3VudCxcbiAgICAgICAgICAgIHRoaXMubV92MS5hLFxuICAgICAgICAgICAgdGhpcy5tX3YxLndBLngsXG4gICAgICAgICAgICB0aGlzLm1fdjEud0EueSxcbiAgICAgICAgICAgIHRoaXMubV92MS53Qi54LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndCLnksXG4gICAgICAgICAgICB0aGlzLm1fdjIuYSxcbiAgICAgICAgICAgIHRoaXMubV92Mi53QS54LFxuICAgICAgICAgICAgdGhpcy5tX3YyLndBLnksXG4gICAgICAgICAgICB0aGlzLm1fdjIud0IueCxcbiAgICAgICAgICAgIHRoaXMubV92Mi53Qi55LFxuICAgICAgICAgICAgdGhpcy5tX3YzLmEsXG4gICAgICAgICAgICB0aGlzLm1fdjMud0EueCxcbiAgICAgICAgICAgIHRoaXMubV92My53QS55LFxuICAgICAgICAgICAgdGhpcy5tX3YzLndCLngsXG4gICAgICAgICAgICB0aGlzLm1fdjMud0IueVxuICAgICAgICAgIF0udG9TdHJpbmcoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fY291bnQgPT09IDIpIHtcbiAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgXCIrXCIgKyB0aGlzLm1fY291bnQsXG4gICAgICAgICAgICB0aGlzLm1fdjEuYSxcbiAgICAgICAgICAgIHRoaXMubV92MS53QS54LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndBLnksXG4gICAgICAgICAgICB0aGlzLm1fdjEud0IueCxcbiAgICAgICAgICAgIHRoaXMubV92MS53Qi55LFxuICAgICAgICAgICAgdGhpcy5tX3YyLmEsXG4gICAgICAgICAgICB0aGlzLm1fdjIud0EueCxcbiAgICAgICAgICAgIHRoaXMubV92Mi53QS55LFxuICAgICAgICAgICAgdGhpcy5tX3YyLndCLngsXG4gICAgICAgICAgICB0aGlzLm1fdjIud0IueVxuICAgICAgICAgIF0udG9TdHJpbmcoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fY291bnQgPT09IDEpIHtcbiAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgXCIrXCIgKyB0aGlzLm1fY291bnQsXG4gICAgICAgICAgICB0aGlzLm1fdjEuYSxcbiAgICAgICAgICAgIHRoaXMubV92MS53QS54LFxuICAgICAgICAgICAgdGhpcy5tX3YxLndBLnksXG4gICAgICAgICAgICB0aGlzLm1fdjEud0IueCxcbiAgICAgICAgICAgIHRoaXMubV92MS53Qi55XG4gICAgICAgICAgXS50b1N0cmluZygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBcIitcIiArIHRoaXMubV9jb3VudDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5yZWFkQ2FjaGUgPSBmdW5jdGlvbihjYWNoZTIsIHByb3h5QSwgdHJhbnNmb3JtQSwgcHJveHlCLCB0cmFuc2Zvcm1CKSB7XG4gICAgICAgIHRoaXMubV9jb3VudCA9IGNhY2hlMi5jb3VudDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciB2MyA9IHRoaXMubV92W2ldO1xuICAgICAgICAgIHYzLmluZGV4QSA9IGNhY2hlMi5pbmRleEFbaV07XG4gICAgICAgICAgdjMuaW5kZXhCID0gY2FjaGUyLmluZGV4QltpXTtcbiAgICAgICAgICB2YXIgd0FMb2NhbCA9IHByb3h5QS5nZXRWZXJ0ZXgodjMuaW5kZXhBKTtcbiAgICAgICAgICB2YXIgd0JMb2NhbCA9IHByb3h5Qi5nZXRWZXJ0ZXgodjMuaW5kZXhCKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHYzLndBLCB0cmFuc2Zvcm1BLCB3QUxvY2FsKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHYzLndCLCB0cmFuc2Zvcm1CLCB3QkxvY2FsKTtcbiAgICAgICAgICBzdWJWZWMyKHYzLncsIHYzLndCLCB2My53QSk7XG4gICAgICAgICAgdjMuYSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9jb3VudCA+IDEpIHtcbiAgICAgICAgICB2YXIgbWV0cmljMSA9IGNhY2hlMi5tZXRyaWM7XG4gICAgICAgICAgdmFyIG1ldHJpYzIgPSB0aGlzLmdldE1ldHJpYygpO1xuICAgICAgICAgIGlmIChtZXRyaWMyIDwgMC41ICogbWV0cmljMSB8fCAyICogbWV0cmljMSA8IG1ldHJpYzIgfHwgbWV0cmljMiA8IEVQU0lMT04pIHtcbiAgICAgICAgICAgIHRoaXMubV9jb3VudCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fY291bnQgPT09IDApIHtcbiAgICAgICAgICB2YXIgdjMgPSB0aGlzLm1fdlswXTtcbiAgICAgICAgICB2My5pbmRleEEgPSAwO1xuICAgICAgICAgIHYzLmluZGV4QiA9IDA7XG4gICAgICAgICAgdmFyIHdBTG9jYWwgPSBwcm94eUEuZ2V0VmVydGV4KDApO1xuICAgICAgICAgIHZhciB3QkxvY2FsID0gcHJveHlCLmdldFZlcnRleCgwKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHYzLndBLCB0cmFuc2Zvcm1BLCB3QUxvY2FsKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHYzLndCLCB0cmFuc2Zvcm1CLCB3QkxvY2FsKTtcbiAgICAgICAgICBzdWJWZWMyKHYzLncsIHYzLndCLCB2My53QSk7XG4gICAgICAgICAgdjMuYSA9IDE7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS53cml0ZUNhY2hlID0gZnVuY3Rpb24oY2FjaGUyKSB7XG4gICAgICAgIGNhY2hlMi5tZXRyaWMgPSB0aGlzLmdldE1ldHJpYygpO1xuICAgICAgICBjYWNoZTIuY291bnQgPSB0aGlzLm1fY291bnQ7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICBjYWNoZTIuaW5kZXhBW2ldID0gdGhpcy5tX3ZbaV0uaW5kZXhBO1xuICAgICAgICAgIGNhY2hlMi5pbmRleEJbaV0gPSB0aGlzLm1fdltpXS5pbmRleEI7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUuZ2V0U2VhcmNoRGlyZWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2MTMgPSB0aGlzLm1fdjE7XG4gICAgICAgIHZhciB2MjIgPSB0aGlzLm1fdjI7XG4gICAgICAgIHN3aXRjaCAodGhpcy5tX2NvdW50KSB7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIHNldFZlYzIoc2VhcmNoRGlyZWN0aW9uX3JldXNlLCAtdjEzLncueCwgLXYxMy53LnkpO1xuICAgICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgICAgc3ViVmVjMihlMTIsIHYyMi53LCB2MTMudyk7XG4gICAgICAgICAgICB2YXIgc2duID0gLWNyb3NzVmVjMlZlYzIoZTEyLCB2MTMudyk7XG4gICAgICAgICAgICBpZiAoc2duID4gMCkge1xuICAgICAgICAgICAgICByZXR1cm4gc2V0VmVjMihzZWFyY2hEaXJlY3Rpb25fcmV1c2UsIC1lMTIueSwgZTEyLngpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHNldFZlYzIoc2VhcmNoRGlyZWN0aW9uX3JldXNlLCBlMTIueSwgLWUxMi54KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB6ZXJvVmVjMihzZWFyY2hEaXJlY3Rpb25fcmV1c2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLmdldENsb3Nlc3RQb2ludCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdjEzID0gdGhpcy5tX3YxO1xuICAgICAgICB2YXIgdjIyID0gdGhpcy5tX3YyO1xuICAgICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHJldHVybiB6ZXJvVmVjMihjbG9zZXN0UG9pbnRfcmV1c2UpO1xuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHJldHVybiBjb3B5VmVjMihjbG9zZXN0UG9pbnRfcmV1c2UsIHYxMy53KTtcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gY29tYmluZTJWZWMyKGNsb3Nlc3RQb2ludF9yZXVzZSwgdjEzLmEsIHYxMy53LCB2MjIuYSwgdjIyLncpO1xuICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiB6ZXJvVmVjMihjbG9zZXN0UG9pbnRfcmV1c2UpO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gemVyb1ZlYzIoY2xvc2VzdFBvaW50X3JldXNlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5nZXRXaXRuZXNzUG9pbnRzID0gZnVuY3Rpb24ocEEyLCBwQjIpIHtcbiAgICAgICAgdmFyIHYxMyA9IHRoaXMubV92MTtcbiAgICAgICAgdmFyIHYyMiA9IHRoaXMubV92MjtcbiAgICAgICAgdmFyIHYzID0gdGhpcy5tX3YzO1xuICAgICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGNvcHlWZWMyKHBBMiwgdjEzLndBKTtcbiAgICAgICAgICAgIGNvcHlWZWMyKHBCMiwgdjEzLndCKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGNvbWJpbmUyVmVjMihwQTIsIHYxMy5hLCB2MTMud0EsIHYyMi5hLCB2MjIud0EpO1xuICAgICAgICAgICAgY29tYmluZTJWZWMyKHBCMiwgdjEzLmEsIHYxMy53QiwgdjIyLmEsIHYyMi53Qik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjb21iaW5lM1ZlYzIocEEyLCB2MTMuYSwgdjEzLndBLCB2MjIuYSwgdjIyLndBLCB2My5hLCB2My53QSk7XG4gICAgICAgICAgICBjb3B5VmVjMihwQjIsIHBBMik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5nZXRNZXRyaWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gZGlzdFZlYzIodGhpcy5tX3YxLncsIHRoaXMubV92Mi53KTtcbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gY3Jvc3NWZWMyVmVjMihzdWJWZWMyKHRlbXAxLCB0aGlzLm1fdjIudywgdGhpcy5tX3YxLncpLCBzdWJWZWMyKHRlbXAyLCB0aGlzLm1fdjMudywgdGhpcy5tX3YxLncpKTtcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTaW1wbGV4Mi5wcm90b3R5cGUuc29sdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICB0aGlzLnNvbHZlMigpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgdGhpcy5zb2x2ZTMoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2ltcGxleDIucHJvdG90eXBlLnNvbHZlMiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdzEgPSB0aGlzLm1fdjEudztcbiAgICAgICAgdmFyIHcyID0gdGhpcy5tX3YyLnc7XG4gICAgICAgIHN1YlZlYzIoZTEyLCB3MiwgdzEpO1xuICAgICAgICB2YXIgZDEyXzIgPSAtZG90VmVjMih3MSwgZTEyKTtcbiAgICAgICAgaWYgKGQxMl8yIDw9IDApIHtcbiAgICAgICAgICB0aGlzLm1fdjEuYSA9IDE7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGQxMl8xID0gZG90VmVjMih3MiwgZTEyKTtcbiAgICAgICAgaWYgKGQxMl8xIDw9IDApIHtcbiAgICAgICAgICB0aGlzLm1fdjIuYSA9IDE7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgICB0aGlzLm1fdjEuc2V0KHRoaXMubV92Mik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnZfZDEyID0gMSAvIChkMTJfMSArIGQxMl8yKTtcbiAgICAgICAgdGhpcy5tX3YxLmEgPSBkMTJfMSAqIGludl9kMTI7XG4gICAgICAgIHRoaXMubV92Mi5hID0gZDEyXzIgKiBpbnZfZDEyO1xuICAgICAgICB0aGlzLm1fY291bnQgPSAyO1xuICAgICAgfTtcbiAgICAgIFNpbXBsZXgyLnByb3RvdHlwZS5zb2x2ZTMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHcxID0gdGhpcy5tX3YxLnc7XG4gICAgICAgIHZhciB3MiA9IHRoaXMubV92Mi53O1xuICAgICAgICB2YXIgdzMgPSB0aGlzLm1fdjMudztcbiAgICAgICAgc3ViVmVjMihlMTIsIHcyLCB3MSk7XG4gICAgICAgIHZhciB3MWUxMiA9IGRvdFZlYzIodzEsIGUxMik7XG4gICAgICAgIHZhciB3MmUxMiA9IGRvdFZlYzIodzIsIGUxMik7XG4gICAgICAgIHZhciBkMTJfMSA9IHcyZTEyO1xuICAgICAgICB2YXIgZDEyXzIgPSAtdzFlMTI7XG4gICAgICAgIHN1YlZlYzIoZTEzLCB3MywgdzEpO1xuICAgICAgICB2YXIgdzFlMTMgPSBkb3RWZWMyKHcxLCBlMTMpO1xuICAgICAgICB2YXIgdzNlMTMgPSBkb3RWZWMyKHczLCBlMTMpO1xuICAgICAgICB2YXIgZDEzXzEgPSB3M2UxMztcbiAgICAgICAgdmFyIGQxM18yID0gLXcxZTEzO1xuICAgICAgICBzdWJWZWMyKGUyMywgdzMsIHcyKTtcbiAgICAgICAgdmFyIHcyZTIzID0gZG90VmVjMih3MiwgZTIzKTtcbiAgICAgICAgdmFyIHczZTIzID0gZG90VmVjMih3MywgZTIzKTtcbiAgICAgICAgdmFyIGQyM18xID0gdzNlMjM7XG4gICAgICAgIHZhciBkMjNfMiA9IC13MmUyMztcbiAgICAgICAgdmFyIG4xMjMgPSBjcm9zc1ZlYzJWZWMyKGUxMiwgZTEzKTtcbiAgICAgICAgdmFyIGQxMjNfMSA9IG4xMjMgKiBjcm9zc1ZlYzJWZWMyKHcyLCB3Myk7XG4gICAgICAgIHZhciBkMTIzXzIgPSBuMTIzICogY3Jvc3NWZWMyVmVjMih3MywgdzEpO1xuICAgICAgICB2YXIgZDEyM18zID0gbjEyMyAqIGNyb3NzVmVjMlZlYzIodzEsIHcyKTtcbiAgICAgICAgaWYgKGQxMl8yIDw9IDAgJiYgZDEzXzIgPD0gMCkge1xuICAgICAgICAgIHRoaXMubV92MS5hID0gMTtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZDEyXzEgPiAwICYmIGQxMl8yID4gMCAmJiBkMTIzXzMgPD0gMCkge1xuICAgICAgICAgIHZhciBpbnZfZDEyID0gMSAvIChkMTJfMSArIGQxMl8yKTtcbiAgICAgICAgICB0aGlzLm1fdjEuYSA9IGQxMl8xICogaW52X2QxMjtcbiAgICAgICAgICB0aGlzLm1fdjIuYSA9IGQxMl8yICogaW52X2QxMjtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAyO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZDEzXzEgPiAwICYmIGQxM18yID4gMCAmJiBkMTIzXzIgPD0gMCkge1xuICAgICAgICAgIHZhciBpbnZfZDEzID0gMSAvIChkMTNfMSArIGQxM18yKTtcbiAgICAgICAgICB0aGlzLm1fdjEuYSA9IGQxM18xICogaW52X2QxMztcbiAgICAgICAgICB0aGlzLm1fdjMuYSA9IGQxM18yICogaW52X2QxMztcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAyO1xuICAgICAgICAgIHRoaXMubV92Mi5zZXQodGhpcy5tX3YzKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQxMl8xIDw9IDAgJiYgZDIzXzIgPD0gMCkge1xuICAgICAgICAgIHRoaXMubV92Mi5hID0gMTtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xuICAgICAgICAgIHRoaXMubV92MS5zZXQodGhpcy5tX3YyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQxM18xIDw9IDAgJiYgZDIzXzEgPD0gMCkge1xuICAgICAgICAgIHRoaXMubV92My5hID0gMTtcbiAgICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xuICAgICAgICAgIHRoaXMubV92MS5zZXQodGhpcy5tX3YzKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGQyM18xID4gMCAmJiBkMjNfMiA+IDAgJiYgZDEyM18xIDw9IDApIHtcbiAgICAgICAgICB2YXIgaW52X2QyMyA9IDEgLyAoZDIzXzEgKyBkMjNfMik7XG4gICAgICAgICAgdGhpcy5tX3YyLmEgPSBkMjNfMSAqIGludl9kMjM7XG4gICAgICAgICAgdGhpcy5tX3YzLmEgPSBkMjNfMiAqIGludl9kMjM7XG4gICAgICAgICAgdGhpcy5tX2NvdW50ID0gMjtcbiAgICAgICAgICB0aGlzLm1fdjEuc2V0KHRoaXMubV92Myk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnZfZDEyMyA9IDEgLyAoZDEyM18xICsgZDEyM18yICsgZDEyM18zKTtcbiAgICAgICAgdGhpcy5tX3YxLmEgPSBkMTIzXzEgKiBpbnZfZDEyMztcbiAgICAgICAgdGhpcy5tX3YyLmEgPSBkMTIzXzIgKiBpbnZfZDEyMztcbiAgICAgICAgdGhpcy5tX3YzLmEgPSBkMTIzXzMgKiBpbnZfZDEyMztcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gMztcbiAgICAgIH07XG4gICAgICByZXR1cm4gU2ltcGxleDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBzaW1wbGV4ID0gbmV3IFNpbXBsZXgoKTtcbiAgdmFyIGlucHV0JDEgPSBuZXcgRGlzdGFuY2VJbnB1dCgpO1xuICB2YXIgY2FjaGUkMSA9IG5ldyBTaW1wbGV4Q2FjaGUoKTtcbiAgdmFyIG91dHB1dCQxID0gbmV3IERpc3RhbmNlT3V0cHV0KCk7XG4gIHZhciB0ZXN0T3ZlcmxhcCA9IGZ1bmN0aW9uKHNoYXBlQSwgaW5kZXhBLCBzaGFwZUIsIGluZGV4QiwgeGZBMiwgeGZCMikge1xuICAgIGlucHV0JDEucmVjeWNsZSgpO1xuICAgIGlucHV0JDEucHJveHlBLnNldChzaGFwZUEsIGluZGV4QSk7XG4gICAgaW5wdXQkMS5wcm94eUIuc2V0KHNoYXBlQiwgaW5kZXhCKTtcbiAgICBjb3B5VHJhbnNmb3JtKGlucHV0JDEudHJhbnNmb3JtQSwgeGZBMik7XG4gICAgY29weVRyYW5zZm9ybShpbnB1dCQxLnRyYW5zZm9ybUIsIHhmQjIpO1xuICAgIGlucHV0JDEudXNlUmFkaWkgPSB0cnVlO1xuICAgIG91dHB1dCQxLnJlY3ljbGUoKTtcbiAgICBjYWNoZSQxLnJlY3ljbGUoKTtcbiAgICBEaXN0YW5jZShvdXRwdXQkMSwgY2FjaGUkMSwgaW5wdXQkMSk7XG4gICAgcmV0dXJuIG91dHB1dCQxLmRpc3RhbmNlIDwgMTAgKiBFUFNJTE9OO1xuICB9O1xuICBEaXN0YW5jZS50ZXN0T3ZlcmxhcCA9IHRlc3RPdmVybGFwO1xuICBEaXN0YW5jZS5JbnB1dCA9IERpc3RhbmNlSW5wdXQ7XG4gIERpc3RhbmNlLk91dHB1dCA9IERpc3RhbmNlT3V0cHV0O1xuICBEaXN0YW5jZS5Qcm94eSA9IERpc3RhbmNlUHJveHk7XG4gIERpc3RhbmNlLkNhY2hlID0gU2ltcGxleENhY2hlO1xuICB2YXIgU2hhcGVDYXN0SW5wdXQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2hhcGVDYXN0SW5wdXQyKCkge1xuICAgICAgICB0aGlzLnByb3h5QSA9IG5ldyBEaXN0YW5jZVByb3h5KCk7XG4gICAgICAgIHRoaXMucHJveHlCID0gbmV3IERpc3RhbmNlUHJveHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1BID0gVHJhbnNmb3JtLmlkZW50aXR5KCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtQiA9IFRyYW5zZm9ybS5pZGVudGl0eSgpO1xuICAgICAgICB0aGlzLnRyYW5zbGF0aW9uQiA9IFZlYzIuemVybygpO1xuICAgICAgfVxuICAgICAgU2hhcGVDYXN0SW5wdXQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucHJveHlBLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5wcm94eUIucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUEuc2V0SWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1CLnNldElkZW50aXR5KCk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMudHJhbnNsYXRpb25CKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gU2hhcGVDYXN0SW5wdXQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgU2hhcGVDYXN0T3V0cHV0ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICAvKiBAX19QVVJFX18gKi8gZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBTaGFwZUNhc3RPdXRwdXQyKCkge1xuICAgICAgICB0aGlzLnBvaW50ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMubm9ybWFsID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMubGFtYmRhID0gMTtcbiAgICAgICAgdGhpcy5pdGVyYXRpb25zID0gMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBTaGFwZUNhc3RPdXRwdXQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgU2hhcGVDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyKSB7XG4gICAgb3V0cHV0Mi5pdGVyYXRpb25zID0gMDtcbiAgICBvdXRwdXQyLmxhbWJkYSA9IDE7XG4gICAgb3V0cHV0Mi5ub3JtYWwuc2V0WmVybygpO1xuICAgIG91dHB1dDIucG9pbnQuc2V0WmVybygpO1xuICAgIHZhciBwcm94eUEgPSBpbnB1dDIucHJveHlBO1xuICAgIHZhciBwcm94eUIgPSBpbnB1dDIucHJveHlCO1xuICAgIHZhciByYWRpdXNBID0gbWF0aF9tYXgkNChwcm94eUEubV9yYWRpdXMsIFNldHRpbmdzSW50ZXJuYWwucG9seWdvblJhZGl1cyk7XG4gICAgdmFyIHJhZGl1c0IgPSBtYXRoX21heCQ0KHByb3h5Qi5tX3JhZGl1cywgU2V0dGluZ3NJbnRlcm5hbC5wb2x5Z29uUmFkaXVzKTtcbiAgICB2YXIgcmFkaXVzID0gcmFkaXVzQSArIHJhZGl1c0I7XG4gICAgdmFyIHhmQTIgPSBpbnB1dDIudHJhbnNmb3JtQTtcbiAgICB2YXIgeGZCMiA9IGlucHV0Mi50cmFuc2Zvcm1CO1xuICAgIHZhciByID0gaW5wdXQyLnRyYW5zbGF0aW9uQjtcbiAgICB2YXIgbjIgPSBWZWMyLnplcm8oKTtcbiAgICB2YXIgbGFtYmRhID0gMDtcbiAgICB2YXIgc2ltcGxleDIgPSBuZXcgU2ltcGxleCgpO1xuICAgIHNpbXBsZXgyLm1fY291bnQgPSAwO1xuICAgIHZhciB2ZXJ0aWNlcyA9IHNpbXBsZXgyLm1fdjtcbiAgICB2YXIgaW5kZXhBID0gcHJveHlBLmdldFN1cHBvcnQoUm90Lm11bFRWZWMyKHhmQTIucSwgVmVjMi5uZWcocikpKTtcbiAgICB2YXIgd0EgPSBUcmFuc2Zvcm0ubXVsVmVjMih4ZkEyLCBwcm94eUEuZ2V0VmVydGV4KGluZGV4QSkpO1xuICAgIHZhciBpbmRleEIgPSBwcm94eUIuZ2V0U3VwcG9ydChSb3QubXVsVFZlYzIoeGZCMi5xLCByKSk7XG4gICAgdmFyIHdCID0gVHJhbnNmb3JtLm11bFZlYzIoeGZCMiwgcHJveHlCLmdldFZlcnRleChpbmRleEIpKTtcbiAgICB2YXIgdjMgPSBWZWMyLnN1Yih3QSwgd0IpO1xuICAgIHZhciBzaWdtYSA9IG1hdGhfbWF4JDQoU2V0dGluZ3NJbnRlcm5hbC5wb2x5Z29uUmFkaXVzLCByYWRpdXMgLSBTZXR0aW5nc0ludGVybmFsLnBvbHlnb25SYWRpdXMpO1xuICAgIHZhciB0b2xlcmFuY2UgPSAwLjUgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgdmFyIGtfbWF4SXRlcnMgPSAyMDtcbiAgICB2YXIgaXRlciA9IDA7XG4gICAgd2hpbGUgKGl0ZXIgPCBrX21heEl0ZXJzICYmIHYzLmxlbmd0aCgpIC0gc2lnbWEgPiB0b2xlcmFuY2UpIHtcbiAgICAgIG91dHB1dDIuaXRlcmF0aW9ucyArPSAxO1xuICAgICAgaW5kZXhBID0gcHJveHlBLmdldFN1cHBvcnQoUm90Lm11bFRWZWMyKHhmQTIucSwgVmVjMi5uZWcodjMpKSk7XG4gICAgICB3QSA9IFRyYW5zZm9ybS5tdWxWZWMyKHhmQTIsIHByb3h5QS5nZXRWZXJ0ZXgoaW5kZXhBKSk7XG4gICAgICBpbmRleEIgPSBwcm94eUIuZ2V0U3VwcG9ydChSb3QubXVsVFZlYzIoeGZCMi5xLCB2MykpO1xuICAgICAgd0IgPSBUcmFuc2Zvcm0ubXVsVmVjMih4ZkIyLCBwcm94eUIuZ2V0VmVydGV4KGluZGV4QikpO1xuICAgICAgdmFyIHAgPSBWZWMyLnN1Yih3QSwgd0IpO1xuICAgICAgdjMubm9ybWFsaXplKCk7XG4gICAgICB2YXIgdnAgPSBWZWMyLmRvdCh2MywgcCk7XG4gICAgICB2YXIgdnIgPSBWZWMyLmRvdCh2Mywgcik7XG4gICAgICBpZiAodnAgLSBzaWdtYSA+IGxhbWJkYSAqIHZyKSB7XG4gICAgICAgIGlmICh2ciA8PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxhbWJkYSA9ICh2cCAtIHNpZ21hKSAvIHZyO1xuICAgICAgICBpZiAobGFtYmRhID4gMSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBuMi5zZXRNdWwoLTEsIHYzKTtcbiAgICAgICAgc2ltcGxleDIubV9jb3VudCA9IDA7XG4gICAgICB9XG4gICAgICB2YXIgdmVydGV4ID0gdmVydGljZXNbc2ltcGxleDIubV9jb3VudF07XG4gICAgICB2ZXJ0ZXguaW5kZXhBID0gaW5kZXhCO1xuICAgICAgdmVydGV4LndBID0gVmVjMi5jb21iaW5lKDEsIHdCLCBsYW1iZGEsIHIpO1xuICAgICAgdmVydGV4LmluZGV4QiA9IGluZGV4QTtcbiAgICAgIHZlcnRleC53QiA9IHdBO1xuICAgICAgdmVydGV4LncgPSBWZWMyLnN1Yih2ZXJ0ZXgud0IsIHZlcnRleC53QSk7XG4gICAgICB2ZXJ0ZXguYSA9IDE7XG4gICAgICBzaW1wbGV4Mi5tX2NvdW50ICs9IDE7XG4gICAgICBzd2l0Y2ggKHNpbXBsZXgyLm1fY291bnQpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgc2ltcGxleDIuc29sdmUyKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBzaW1wbGV4Mi5zb2x2ZTMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmIChzaW1wbGV4Mi5tX2NvdW50ID09IDMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdjMuc2V0VmVjMihzaW1wbGV4Mi5nZXRDbG9zZXN0UG9pbnQoKSk7XG4gICAgICArK2l0ZXI7XG4gICAgfVxuICAgIGlmIChpdGVyID09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIHBvaW50QTIgPSBWZWMyLnplcm8oKTtcbiAgICB2YXIgcG9pbnRCMiA9IFZlYzIuemVybygpO1xuICAgIHNpbXBsZXgyLmdldFdpdG5lc3NQb2ludHMocG9pbnRCMiwgcG9pbnRBMik7XG4gICAgaWYgKHYzLmxlbmd0aFNxdWFyZWQoKSA+IDApIHtcbiAgICAgIG4yLnNldE11bCgtMSwgdjMpO1xuICAgICAgbjIubm9ybWFsaXplKCk7XG4gICAgfVxuICAgIG91dHB1dDIucG9pbnQgPSBWZWMyLmNvbWJpbmUoMSwgcG9pbnRBMiwgcmFkaXVzQSwgbjIpO1xuICAgIG91dHB1dDIubm9ybWFsID0gbjI7XG4gICAgb3V0cHV0Mi5sYW1iZGEgPSBsYW1iZGE7XG4gICAgb3V0cHV0Mi5pdGVyYXRpb25zID0gaXRlcjtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcbiAgdmFyIG1hdGhfYWJzJDcgPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfbWF4JDMgPSBNYXRoLm1heDtcbiAgdmFyIFRPSUlucHV0ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFRPSUlucHV0MigpIHtcbiAgICAgICAgdGhpcy5wcm94eUEgPSBuZXcgRGlzdGFuY2VQcm94eSgpO1xuICAgICAgICB0aGlzLnByb3h5QiA9IG5ldyBEaXN0YW5jZVByb3h5KCk7XG4gICAgICAgIHRoaXMuc3dlZXBBID0gbmV3IFN3ZWVwKCk7XG4gICAgICAgIHRoaXMuc3dlZXBCID0gbmV3IFN3ZWVwKCk7XG4gICAgICB9XG4gICAgICBUT0lJbnB1dDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5wcm94eUEucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnByb3h5Qi5yZWN5Y2xlKCk7XG4gICAgICAgIHRoaXMuc3dlZXBBLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5zd2VlcEIucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnRNYXggPSAtMTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVE9JSW5wdXQyO1xuICAgIH0oKVxuICApO1xuICBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZSA9IHZvaWQgMDtcbiAgKGZ1bmN0aW9uKFRPSU91dHB1dFN0YXRlMikge1xuICAgIFRPSU91dHB1dFN0YXRlMltUT0lPdXRwdXRTdGF0ZTJbXCJlX3Vuc2V0XCJdID0gLTFdID0gXCJlX3Vuc2V0XCI7XG4gICAgVE9JT3V0cHV0U3RhdGUyW1RPSU91dHB1dFN0YXRlMltcImVfdW5rbm93blwiXSA9IDBdID0gXCJlX3Vua25vd25cIjtcbiAgICBUT0lPdXRwdXRTdGF0ZTJbVE9JT3V0cHV0U3RhdGUyW1wiZV9mYWlsZWRcIl0gPSAxXSA9IFwiZV9mYWlsZWRcIjtcbiAgICBUT0lPdXRwdXRTdGF0ZTJbVE9JT3V0cHV0U3RhdGUyW1wiZV9vdmVybGFwcGVkXCJdID0gMl0gPSBcImVfb3ZlcmxhcHBlZFwiO1xuICAgIFRPSU91dHB1dFN0YXRlMltUT0lPdXRwdXRTdGF0ZTJbXCJlX3RvdWNoaW5nXCJdID0gM10gPSBcImVfdG91Y2hpbmdcIjtcbiAgICBUT0lPdXRwdXRTdGF0ZTJbVE9JT3V0cHV0U3RhdGUyW1wiZV9zZXBhcmF0ZWRcIl0gPSA0XSA9IFwiZV9zZXBhcmF0ZWRcIjtcbiAgfSkoZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUgfHwgKGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlID0ge30pKTtcbiAgdmFyIFRPSU91dHB1dCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBUT0lPdXRwdXQyKCkge1xuICAgICAgICB0aGlzLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV91bnNldDtcbiAgICAgICAgdGhpcy50ID0gLTE7XG4gICAgICB9XG4gICAgICBUT0lPdXRwdXQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLnQgPSAtMTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gVE9JT3V0cHV0MjtcbiAgICB9KClcbiAgKTtcbiAgc3RhdHMudG9pVGltZSA9IDA7XG4gIHN0YXRzLnRvaU1heFRpbWUgPSAwO1xuICBzdGF0cy50b2lDYWxscyA9IDA7XG4gIHN0YXRzLnRvaUl0ZXJzID0gMDtcbiAgc3RhdHMudG9pTWF4SXRlcnMgPSAwO1xuICBzdGF0cy50b2lSb290SXRlcnMgPSAwO1xuICBzdGF0cy50b2lNYXhSb290SXRlcnMgPSAwO1xuICB2YXIgZGlzdGFuY2VJbnB1dCA9IG5ldyBEaXN0YW5jZUlucHV0KCk7XG4gIHZhciBkaXN0YW5jZU91dHB1dCA9IG5ldyBEaXN0YW5jZU91dHB1dCgpO1xuICB2YXIgY2FjaGUgPSBuZXcgU2ltcGxleENhY2hlKCk7XG4gIHZhciB4ZkEkMSA9IHRyYW5zZm9ybSgwLCAwLCAwKTtcbiAgdmFyIHhmQiQxID0gdHJhbnNmb3JtKDAsIDAsIDApO1xuICB2YXIgdGVtcCQ0ID0gdmVjMigwLCAwKTtcbiAgdmFyIHBvaW50QSQyID0gdmVjMigwLCAwKTtcbiAgdmFyIHBvaW50QiQyID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbCQzID0gdmVjMigwLCAwKTtcbiAgdmFyIGF4aXNBID0gdmVjMigwLCAwKTtcbiAgdmFyIGF4aXNCID0gdmVjMigwLCAwKTtcbiAgdmFyIGxvY2FsUG9pbnRBID0gdmVjMigwLCAwKTtcbiAgdmFyIGxvY2FsUG9pbnRCID0gdmVjMigwLCAwKTtcbiAgdmFyIFRpbWVPZkltcGFjdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0Mikge1xuICAgIHZhciB0aW1lciA9IFRpbWVyLm5vdygpO1xuICAgICsrc3RhdHMudG9pQ2FsbHM7XG4gICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfdW5rbm93bjtcbiAgICBvdXRwdXQyLnQgPSBpbnB1dDIudE1heDtcbiAgICB2YXIgcHJveHlBID0gaW5wdXQyLnByb3h5QTtcbiAgICB2YXIgcHJveHlCID0gaW5wdXQyLnByb3h5QjtcbiAgICB2YXIgc3dlZXBBID0gaW5wdXQyLnN3ZWVwQTtcbiAgICB2YXIgc3dlZXBCID0gaW5wdXQyLnN3ZWVwQjtcbiAgICBzd2VlcEEubm9ybWFsaXplKCk7XG4gICAgc3dlZXBCLm5vcm1hbGl6ZSgpO1xuICAgIHZhciB0TWF4ID0gaW5wdXQyLnRNYXg7XG4gICAgdmFyIHRvdGFsUmFkaXVzID0gcHJveHlBLm1fcmFkaXVzICsgcHJveHlCLm1fcmFkaXVzO1xuICAgIHZhciB0YXJnZXQgPSBtYXRoX21heCQzKFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCwgdG90YWxSYWRpdXMgLSAzICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKTtcbiAgICB2YXIgdG9sZXJhbmNlID0gMC4yNSAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICB2YXIgdDEgPSAwO1xuICAgIHZhciBrX21heEl0ZXJhdGlvbnMgPSBTZXR0aW5nc0ludGVybmFsLm1heFRPSUl0ZXJhdGlvbnM7XG4gICAgdmFyIGl0ZXIgPSAwO1xuICAgIGNhY2hlLnJlY3ljbGUoKTtcbiAgICBkaXN0YW5jZUlucHV0LnByb3h5QS5zZXRWZXJ0aWNlcyhwcm94eUEubV92ZXJ0aWNlcywgcHJveHlBLm1fY291bnQsIHByb3h5QS5tX3JhZGl1cyk7XG4gICAgZGlzdGFuY2VJbnB1dC5wcm94eUIuc2V0VmVydGljZXMocHJveHlCLm1fdmVydGljZXMsIHByb3h5Qi5tX2NvdW50LCBwcm94eUIubV9yYWRpdXMpO1xuICAgIGRpc3RhbmNlSW5wdXQudXNlUmFkaWkgPSBmYWxzZTtcbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgc3dlZXBBLmdldFRyYW5zZm9ybSh4ZkEkMSwgdDEpO1xuICAgICAgc3dlZXBCLmdldFRyYW5zZm9ybSh4ZkIkMSwgdDEpO1xuICAgICAgY29weVRyYW5zZm9ybShkaXN0YW5jZUlucHV0LnRyYW5zZm9ybUEsIHhmQSQxKTtcbiAgICAgIGNvcHlUcmFuc2Zvcm0oZGlzdGFuY2VJbnB1dC50cmFuc2Zvcm1CLCB4ZkIkMSk7XG4gICAgICBEaXN0YW5jZShkaXN0YW5jZU91dHB1dCwgY2FjaGUsIGRpc3RhbmNlSW5wdXQpO1xuICAgICAgaWYgKGRpc3RhbmNlT3V0cHV0LmRpc3RhbmNlIDw9IDApIHtcbiAgICAgICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfb3ZlcmxhcHBlZDtcbiAgICAgICAgb3V0cHV0Mi50ID0gMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAoZGlzdGFuY2VPdXRwdXQuZGlzdGFuY2UgPCB0YXJnZXQgKyB0b2xlcmFuY2UpIHtcbiAgICAgICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfdG91Y2hpbmc7XG4gICAgICAgIG91dHB1dDIudCA9IHQxO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHNlcGFyYXRpb25GdW5jdGlvbi5pbml0aWFsaXplKGNhY2hlLCBwcm94eUEsIHN3ZWVwQSwgcHJveHlCLCBzd2VlcEIsIHQxKTtcbiAgICAgIHZhciBkb25lID0gZmFsc2U7XG4gICAgICB2YXIgdDIgPSB0TWF4O1xuICAgICAgdmFyIHB1c2hCYWNrSXRlciA9IDA7XG4gICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgczIgPSBzZXBhcmF0aW9uRnVuY3Rpb24uZmluZE1pblNlcGFyYXRpb24odDIpO1xuICAgICAgICBpZiAoczIgPiB0YXJnZXQgKyB0b2xlcmFuY2UpIHtcbiAgICAgICAgICBvdXRwdXQyLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV9zZXBhcmF0ZWQ7XG4gICAgICAgICAgb3V0cHV0Mi50ID0gdE1heDtcbiAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAoczIgPiB0YXJnZXQgLSB0b2xlcmFuY2UpIHtcbiAgICAgICAgICB0MSA9IHQyO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzMSA9IHNlcGFyYXRpb25GdW5jdGlvbi5ldmFsdWF0ZSh0MSk7XG4gICAgICAgIGlmIChzMSA8IHRhcmdldCAtIHRvbGVyYW5jZSkge1xuICAgICAgICAgIG91dHB1dDIuc3RhdGUgPSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX2ZhaWxlZDtcbiAgICAgICAgICBvdXRwdXQyLnQgPSB0MTtcbiAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAoczEgPD0gdGFyZ2V0ICsgdG9sZXJhbmNlKSB7XG4gICAgICAgICAgb3V0cHV0Mi5zdGF0ZSA9IGV4cG9ydHMyLlRPSU91dHB1dFN0YXRlLmVfdG91Y2hpbmc7XG4gICAgICAgICAgb3V0cHV0Mi50ID0gdDE7XG4gICAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvb3RJdGVyQ291bnQgPSAwO1xuICAgICAgICB2YXIgYTEgPSB0MTtcbiAgICAgICAgdmFyIGEyID0gdDI7XG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgdmFyIHQgPSB2b2lkIDA7XG4gICAgICAgICAgaWYgKHJvb3RJdGVyQ291bnQgJiAxKSB7XG4gICAgICAgICAgICB0ID0gYTEgKyAodGFyZ2V0IC0gczEpICogKGEyIC0gYTEpIC8gKHMyIC0gczEpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0ID0gMC41ICogKGExICsgYTIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICArK3Jvb3RJdGVyQ291bnQ7XG4gICAgICAgICAgKytzdGF0cy50b2lSb290SXRlcnM7XG4gICAgICAgICAgdmFyIHMzID0gc2VwYXJhdGlvbkZ1bmN0aW9uLmV2YWx1YXRlKHQpO1xuICAgICAgICAgIGlmIChtYXRoX2FicyQ3KHMzIC0gdGFyZ2V0KSA8IHRvbGVyYW5jZSkge1xuICAgICAgICAgICAgdDIgPSB0O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzMyA+IHRhcmdldCkge1xuICAgICAgICAgICAgYTEgPSB0O1xuICAgICAgICAgICAgczEgPSBzMztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYTIgPSB0O1xuICAgICAgICAgICAgczIgPSBzMztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHJvb3RJdGVyQ291bnQgPT09IDUwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc3RhdHMudG9pTWF4Um9vdEl0ZXJzID0gbWF0aF9tYXgkMyhzdGF0cy50b2lNYXhSb290SXRlcnMsIHJvb3RJdGVyQ291bnQpO1xuICAgICAgICArK3B1c2hCYWNrSXRlcjtcbiAgICAgICAgaWYgKHB1c2hCYWNrSXRlciA9PT0gU2V0dGluZ3NJbnRlcm5hbC5tYXhQb2x5Z29uVmVydGljZXMpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgKytpdGVyO1xuICAgICAgKytzdGF0cy50b2lJdGVycztcbiAgICAgIGlmIChkb25lKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKGl0ZXIgPT09IGtfbWF4SXRlcmF0aW9ucykge1xuICAgICAgICBvdXRwdXQyLnN0YXRlID0gZXhwb3J0czIuVE9JT3V0cHV0U3RhdGUuZV9mYWlsZWQ7XG4gICAgICAgIG91dHB1dDIudCA9IHQxO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgc3RhdHMudG9pTWF4SXRlcnMgPSBtYXRoX21heCQzKHN0YXRzLnRvaU1heEl0ZXJzLCBpdGVyKTtcbiAgICB2YXIgdGltZSA9IFRpbWVyLmRpZmYodGltZXIpO1xuICAgIHN0YXRzLnRvaU1heFRpbWUgPSBtYXRoX21heCQzKHN0YXRzLnRvaU1heFRpbWUsIHRpbWUpO1xuICAgIHN0YXRzLnRvaVRpbWUgKz0gdGltZTtcbiAgICBzZXBhcmF0aW9uRnVuY3Rpb24ucmVjeWNsZSgpO1xuICB9O1xuICB2YXIgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTtcbiAgKGZ1bmN0aW9uKFNlcGFyYXRpb25GdW5jdGlvblR5cGUyKSB7XG4gICAgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbXCJlX3Vuc2V0XCJdID0gLTFdID0gXCJlX3Vuc2V0XCI7XG4gICAgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbXCJlX3BvaW50c1wiXSA9IDFdID0gXCJlX3BvaW50c1wiO1xuICAgIFNlcGFyYXRpb25GdW5jdGlvblR5cGUyW1NlcGFyYXRpb25GdW5jdGlvblR5cGUyW1wiZV9mYWNlQVwiXSA9IDJdID0gXCJlX2ZhY2VBXCI7XG4gICAgU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZTJbXCJlX2ZhY2VCXCJdID0gM10gPSBcImVfZmFjZUJcIjtcbiAgfSkoU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZSB8fCAoU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZSA9IHt9KSk7XG4gIHZhciBTZXBhcmF0aW9uRnVuY3Rpb24gPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gU2VwYXJhdGlvbkZ1bmN0aW9uMigpIHtcbiAgICAgICAgdGhpcy5tX3Byb3h5QSA9IG51bGw7XG4gICAgICAgIHRoaXMubV9wcm94eUIgPSBudWxsO1xuICAgICAgICB0aGlzLm1fc3dlZXBBID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQiA9IG51bGw7XG4gICAgICAgIHRoaXMubV90eXBlID0gU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLm1fbG9jYWxQb2ludCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMubV9heGlzID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAtMTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSAtMTtcbiAgICAgIH1cbiAgICAgIFNlcGFyYXRpb25GdW5jdGlvbjIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tX3Byb3h5QSA9IG51bGw7XG4gICAgICAgIHRoaXMubV9wcm94eUIgPSBudWxsO1xuICAgICAgICB0aGlzLm1fc3dlZXBBID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQiA9IG51bGw7XG4gICAgICAgIHRoaXMubV90eXBlID0gU2VwYXJhdGlvbkZ1bmN0aW9uVHlwZS5lX3Vuc2V0O1xuICAgICAgICB6ZXJvVmVjMih0aGlzLm1fbG9jYWxQb2ludCk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubV9heGlzKTtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAtMTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSAtMTtcbiAgICAgIH07XG4gICAgICBTZXBhcmF0aW9uRnVuY3Rpb24yLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24oY2FjaGUyLCBwcm94eUEsIHN3ZWVwQSwgcHJveHlCLCBzd2VlcEIsIHQxKSB7XG4gICAgICAgIHZhciBjb3VudCA9IGNhY2hlMi5jb3VudDtcbiAgICAgICAgdGhpcy5tX3Byb3h5QSA9IHByb3h5QTtcbiAgICAgICAgdGhpcy5tX3Byb3h5QiA9IHByb3h5QjtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQSA9IHN3ZWVwQTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQiA9IHN3ZWVwQjtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQS5nZXRUcmFuc2Zvcm0oeGZBJDEsIHQxKTtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQi5nZXRUcmFuc2Zvcm0oeGZCJDEsIHQxKTtcbiAgICAgICAgaWYgKGNvdW50ID09PSAxKSB7XG4gICAgICAgICAgdGhpcy5tX3R5cGUgPSBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlLmVfcG9pbnRzO1xuICAgICAgICAgIHZhciBsb2NhbFBvaW50QV8xID0gdGhpcy5tX3Byb3h5QS5nZXRWZXJ0ZXgoY2FjaGUyLmluZGV4QVswXSk7XG4gICAgICAgICAgdmFyIGxvY2FsUG9pbnRCXzEgPSB0aGlzLm1fcHJveHlCLmdldFZlcnRleChjYWNoZTIuaW5kZXhCWzBdKTtcbiAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSQyLCB4ZkEkMSwgbG9jYWxQb2ludEFfMSk7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIGxvY2FsUG9pbnRCXzEpO1xuICAgICAgICAgIHN1YlZlYzIodGhpcy5tX2F4aXMsIHBvaW50QiQyLCBwb2ludEEkMik7XG4gICAgICAgICAgdmFyIHMyID0gbm9ybWFsaXplVmVjMkxlbmd0aCh0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgcmV0dXJuIHMyO1xuICAgICAgICB9IGVsc2UgaWYgKGNhY2hlMi5pbmRleEFbMF0gPT09IGNhY2hlMi5pbmRleEFbMV0pIHtcbiAgICAgICAgICB0aGlzLm1fdHlwZSA9IFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV9mYWNlQjtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEIxID0gcHJveHlCLmdldFZlcnRleChjYWNoZTIuaW5kZXhCWzBdKTtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEIyID0gcHJveHlCLmdldFZlcnRleChjYWNoZTIuaW5kZXhCWzFdKTtcbiAgICAgICAgICBjcm9zc1ZlYzJOdW0odGhpcy5tX2F4aXMsIHN1YlZlYzIodGVtcCQ0LCBsb2NhbFBvaW50QjIsIGxvY2FsUG9pbnRCMSksIDEpO1xuICAgICAgICAgIG5vcm1hbGl6ZVZlYzIodGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHJvdFZlYzIobm9ybWFsJDMsIHhmQiQxLnEsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICBjb21iaW5lMlZlYzIodGhpcy5tX2xvY2FsUG9pbnQsIDAuNSwgbG9jYWxQb2ludEIxLCAwLjUsIGxvY2FsUG9pbnRCMik7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIHRoaXMubV9sb2NhbFBvaW50KTtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEFfMiA9IHByb3h5QS5nZXRWZXJ0ZXgoY2FjaGUyLmluZGV4QVswXSk7XG4gICAgICAgICAgdmFyIHBvaW50QV8xID0gVHJhbnNmb3JtLm11bFZlYzIoeGZBJDEsIGxvY2FsUG9pbnRBXzIpO1xuICAgICAgICAgIHZhciBzMiA9IGRvdFZlYzIocG9pbnRBXzEsIG5vcm1hbCQzKSAtIGRvdFZlYzIocG9pbnRCJDIsIG5vcm1hbCQzKTtcbiAgICAgICAgICBpZiAoczIgPCAwKSB7XG4gICAgICAgICAgICBuZWdWZWMyKHRoaXMubV9heGlzKTtcbiAgICAgICAgICAgIHMyID0gLXMyO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gczI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3R5cGUgPSBTZXBhcmF0aW9uRnVuY3Rpb25UeXBlLmVfZmFjZUE7XG4gICAgICAgICAgdmFyIGxvY2FsUG9pbnRBMSA9IHRoaXMubV9wcm94eUEuZ2V0VmVydGV4KGNhY2hlMi5pbmRleEFbMF0pO1xuICAgICAgICAgIHZhciBsb2NhbFBvaW50QTIgPSB0aGlzLm1fcHJveHlBLmdldFZlcnRleChjYWNoZTIuaW5kZXhBWzFdKTtcbiAgICAgICAgICBjcm9zc1ZlYzJOdW0odGhpcy5tX2F4aXMsIHN1YlZlYzIodGVtcCQ0LCBsb2NhbFBvaW50QTIsIGxvY2FsUG9pbnRBMSksIDEpO1xuICAgICAgICAgIG5vcm1hbGl6ZVZlYzIodGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHJvdFZlYzIobm9ybWFsJDMsIHhmQSQxLnEsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICBjb21iaW5lMlZlYzIodGhpcy5tX2xvY2FsUG9pbnQsIDAuNSwgbG9jYWxQb2ludEExLCAwLjUsIGxvY2FsUG9pbnRBMik7XG4gICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEEkMiwgeGZBJDEsIHRoaXMubV9sb2NhbFBvaW50KTtcbiAgICAgICAgICB2YXIgbG9jYWxQb2ludEJfMiA9IHRoaXMubV9wcm94eUIuZ2V0VmVydGV4KGNhY2hlMi5pbmRleEJbMF0pO1xuICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRCJDIsIHhmQiQxLCBsb2NhbFBvaW50Ql8yKTtcbiAgICAgICAgICB2YXIgczIgPSBkb3RWZWMyKHBvaW50QiQyLCBub3JtYWwkMykgLSBkb3RWZWMyKHBvaW50QSQyLCBub3JtYWwkMyk7XG4gICAgICAgICAgaWYgKHMyIDwgMCkge1xuICAgICAgICAgICAgbmVnVmVjMih0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgICBzMiA9IC1zMjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHMyO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2VwYXJhdGlvbkZ1bmN0aW9uMi5wcm90b3R5cGUuY29tcHV0ZSA9IGZ1bmN0aW9uKGZpbmQsIHQpIHtcbiAgICAgICAgdGhpcy5tX3N3ZWVwQS5nZXRUcmFuc2Zvcm0oeGZBJDEsIHQpO1xuICAgICAgICB0aGlzLm1fc3dlZXBCLmdldFRyYW5zZm9ybSh4ZkIkMSwgdCk7XG4gICAgICAgIHN3aXRjaCAodGhpcy5tX3R5cGUpIHtcbiAgICAgICAgICBjYXNlIFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV9wb2ludHM6IHtcbiAgICAgICAgICAgIGlmIChmaW5kKSB7XG4gICAgICAgICAgICAgIGRlcm90VmVjMihheGlzQSwgeGZBJDEucSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgICAgICBkZXJvdFZlYzIoYXhpc0IsIHhmQiQxLnEsIHNjYWxlVmVjMih0ZW1wJDQsIC0xLCB0aGlzLm1fYXhpcykpO1xuICAgICAgICAgICAgICB0aGlzLmluZGV4QSA9IHRoaXMubV9wcm94eUEuZ2V0U3VwcG9ydChheGlzQSk7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhCID0gdGhpcy5tX3Byb3h5Qi5nZXRTdXBwb3J0KGF4aXNCKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvcHlWZWMyKGxvY2FsUG9pbnRBLCB0aGlzLm1fcHJveHlBLmdldFZlcnRleCh0aGlzLmluZGV4QSkpO1xuICAgICAgICAgICAgY29weVZlYzIobG9jYWxQb2ludEIsIHRoaXMubV9wcm94eUIuZ2V0VmVydGV4KHRoaXMuaW5kZXhCKSk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSQyLCB4ZkEkMSwgbG9jYWxQb2ludEEpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIGxvY2FsUG9pbnRCKTtcbiAgICAgICAgICAgIHZhciBzZXAgPSBkb3RWZWMyKHBvaW50QiQyLCB0aGlzLm1fYXhpcykgLSBkb3RWZWMyKHBvaW50QSQyLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgICByZXR1cm4gc2VwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV9mYWNlQToge1xuICAgICAgICAgICAgcm90VmVjMihub3JtYWwkMywgeGZBJDEucSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEEkMiwgeGZBJDEsIHRoaXMubV9sb2NhbFBvaW50KTtcbiAgICAgICAgICAgIGlmIChmaW5kKSB7XG4gICAgICAgICAgICAgIGRlcm90VmVjMihheGlzQiwgeGZCJDEucSwgc2NhbGVWZWMyKHRlbXAkNCwgLTEsIG5vcm1hbCQzKSk7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhBID0gLTE7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhCID0gdGhpcy5tX3Byb3h5Qi5nZXRTdXBwb3J0KGF4aXNCKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvcHlWZWMyKGxvY2FsUG9pbnRCLCB0aGlzLm1fcHJveHlCLmdldFZlcnRleCh0aGlzLmluZGV4QikpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIGxvY2FsUG9pbnRCKTtcbiAgICAgICAgICAgIHZhciBzZXAgPSBkb3RWZWMyKHBvaW50QiQyLCBub3JtYWwkMykgLSBkb3RWZWMyKHBvaW50QSQyLCBub3JtYWwkMyk7XG4gICAgICAgICAgICByZXR1cm4gc2VwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIFNlcGFyYXRpb25GdW5jdGlvblR5cGUuZV9mYWNlQjoge1xuICAgICAgICAgICAgcm90VmVjMihub3JtYWwkMywgeGZCJDEucSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMiwgeGZCJDEsIHRoaXMubV9sb2NhbFBvaW50KTtcbiAgICAgICAgICAgIGlmIChmaW5kKSB7XG4gICAgICAgICAgICAgIGRlcm90VmVjMihheGlzQSwgeGZBJDEucSwgc2NhbGVWZWMyKHRlbXAkNCwgLTEsIG5vcm1hbCQzKSk7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhCID0gLTE7XG4gICAgICAgICAgICAgIHRoaXMuaW5kZXhBID0gdGhpcy5tX3Byb3h5QS5nZXRTdXBwb3J0KGF4aXNBKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvcHlWZWMyKGxvY2FsUG9pbnRBLCB0aGlzLm1fcHJveHlBLmdldFZlcnRleCh0aGlzLmluZGV4QSkpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEEkMiwgeGZBJDEsIGxvY2FsUG9pbnRBKTtcbiAgICAgICAgICAgIHZhciBzZXAgPSBkb3RWZWMyKHBvaW50QSQyLCBub3JtYWwkMykgLSBkb3RWZWMyKHBvaW50QiQyLCBub3JtYWwkMyk7XG4gICAgICAgICAgICByZXR1cm4gc2VwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgaWYgKGZpbmQpIHtcbiAgICAgICAgICAgICAgdGhpcy5pbmRleEEgPSAtMTtcbiAgICAgICAgICAgICAgdGhpcy5pbmRleEIgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU2VwYXJhdGlvbkZ1bmN0aW9uMi5wcm90b3R5cGUuZmluZE1pblNlcGFyYXRpb24gPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbXB1dGUodHJ1ZSwgdCk7XG4gICAgICB9O1xuICAgICAgU2VwYXJhdGlvbkZ1bmN0aW9uMi5wcm90b3R5cGUuZXZhbHVhdGUgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbXB1dGUoZmFsc2UsIHQpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBTZXBhcmF0aW9uRnVuY3Rpb24yO1xuICAgIH0oKVxuICApO1xuICB2YXIgc2VwYXJhdGlvbkZ1bmN0aW9uID0gbmV3IFNlcGFyYXRpb25GdW5jdGlvbigpO1xuICBUaW1lT2ZJbXBhY3QuSW5wdXQgPSBUT0lJbnB1dDtcbiAgVGltZU9mSW1wYWN0Lk91dHB1dCA9IFRPSU91dHB1dDtcbiAgdmFyIG1hdGhfYWJzJDYgPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfc3FydCQzID0gTWF0aC5zcXJ0O1xuICB2YXIgbWF0aF9taW4kNSA9IE1hdGgubWluO1xuICB2YXIgVGltZVN0ZXAgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVGltZVN0ZXAyKCkge1xuICAgICAgICB0aGlzLmR0ID0gMDtcbiAgICAgICAgdGhpcy5pbnZfZHQgPSAwO1xuICAgICAgICB0aGlzLnZlbG9jaXR5SXRlcmF0aW9ucyA9IDA7XG4gICAgICAgIHRoaXMucG9zaXRpb25JdGVyYXRpb25zID0gMDtcbiAgICAgICAgdGhpcy53YXJtU3RhcnRpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5ibG9ja1NvbHZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5pbnZfZHQwID0gMDtcbiAgICAgICAgdGhpcy5kdFJhdGlvID0gMTtcbiAgICAgIH1cbiAgICAgIFRpbWVTdGVwMi5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbihkdCkge1xuICAgICAgICBpZiAodGhpcy5kdCA+IDApIHtcbiAgICAgICAgICB0aGlzLmludl9kdDAgPSB0aGlzLmludl9kdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmR0ID0gZHQ7XG4gICAgICAgIHRoaXMuaW52X2R0ID0gZHQgPT0gMCA/IDAgOiAxIC8gZHQ7XG4gICAgICAgIHRoaXMuZHRSYXRpbyA9IGR0ICogdGhpcy5pbnZfZHQwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBUaW1lU3RlcDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBzX3N1YlN0ZXAgPSBuZXcgVGltZVN0ZXAoKTtcbiAgdmFyIGMgPSB2ZWMyKDAsIDApO1xuICB2YXIgdiA9IHZlYzIoMCwgMCk7XG4gIHZhciB0cmFuc2xhdGlvbiA9IHZlYzIoMCwgMCk7XG4gIHZhciBpbnB1dCA9IG5ldyBUT0lJbnB1dCgpO1xuICB2YXIgb3V0cHV0ID0gbmV3IFRPSU91dHB1dCgpO1xuICB2YXIgYmFja3VwID0gbmV3IFN3ZWVwKCk7XG4gIHZhciBiYWNrdXAxID0gbmV3IFN3ZWVwKCk7XG4gIHZhciBiYWNrdXAyID0gbmV3IFN3ZWVwKCk7XG4gIHZhciBDb250YWN0SW1wdWxzZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBDb250YWN0SW1wdWxzZTIoY29udGFjdCkge1xuICAgICAgICB0aGlzLmNvbnRhY3QgPSBjb250YWN0O1xuICAgICAgICB0aGlzLm5vcm1hbHMgPSBbXTtcbiAgICAgICAgdGhpcy50YW5nZW50cyA9IFtdO1xuICAgICAgfVxuICAgICAgQ29udGFjdEltcHVsc2UyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubm9ybWFscy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLnRhbmdlbnRzLmxlbmd0aCA9IDA7XG4gICAgICB9O1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnRhY3RJbXB1bHNlMi5wcm90b3R5cGUsIFwibm9ybWFsSW1wdWxzZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5jb250YWN0O1xuICAgICAgICAgIHZhciBub3JtYWxzID0gdGhpcy5ub3JtYWxzO1xuICAgICAgICAgIG5vcm1hbHMubGVuZ3RoID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBwID0gMDsgcCA8IGNvbnRhY3Qudl9wb2ludHMubGVuZ3RoOyArK3ApIHtcbiAgICAgICAgICAgIG5vcm1hbHMucHVzaChjb250YWN0LnZfcG9pbnRzW3BdLm5vcm1hbEltcHVsc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbm9ybWFscztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29udGFjdEltcHVsc2UyLnByb3RvdHlwZSwgXCJ0YW5nZW50SW1wdWxzZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5jb250YWN0O1xuICAgICAgICAgIHZhciB0YW5nZW50cyA9IHRoaXMudGFuZ2VudHM7XG4gICAgICAgICAgdGFuZ2VudHMubGVuZ3RoID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBwID0gMDsgcCA8IGNvbnRhY3Qudl9wb2ludHMubGVuZ3RoOyArK3ApIHtcbiAgICAgICAgICAgIHRhbmdlbnRzLnB1c2goY29udGFjdC52X3BvaW50c1twXS50YW5nZW50SW1wdWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0YW5nZW50cztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gQ29udGFjdEltcHVsc2UyO1xuICAgIH0oKVxuICApO1xuICB2YXIgU29sdmVyID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNvbHZlcjIod29ybGQpIHtcbiAgICAgICAgdGhpcy5tX3dvcmxkID0gd29ybGQ7XG4gICAgICAgIHRoaXMubV9zdGFjayA9IFtdO1xuICAgICAgICB0aGlzLm1fYm9kaWVzID0gW107XG4gICAgICAgIHRoaXMubV9jb250YWN0cyA9IFtdO1xuICAgICAgICB0aGlzLm1fam9pbnRzID0gW107XG4gICAgICB9XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fc3RhY2subGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5tX2JvZGllcy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLm1fY29udGFjdHMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5tX2pvaW50cy5sZW5ndGggPSAwO1xuICAgICAgfTtcbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLmFkZEJvZHkgPSBmdW5jdGlvbihib2R5KSB7XG4gICAgICAgIHRoaXMubV9ib2RpZXMucHVzaChib2R5KTtcbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5hZGRDb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCkge1xuICAgICAgICB0aGlzLm1fY29udGFjdHMucHVzaChjb250YWN0KTtcbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5hZGRKb2ludCA9IGZ1bmN0aW9uKGpvaW50KSB7XG4gICAgICAgIHRoaXMubV9qb2ludHMucHVzaChqb2ludCk7XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUuc29sdmVXb3JsZCA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHdvcmxkID0gdGhpcy5tX3dvcmxkO1xuICAgICAgICBmb3IgKHZhciBiMiA9IHdvcmxkLm1fYm9keUxpc3Q7IGIyOyBiMiA9IGIyLm1fbmV4dCkge1xuICAgICAgICAgIGIyLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGNfMSA9IHdvcmxkLm1fY29udGFjdExpc3Q7IGNfMTsgY18xID0gY18xLm1fbmV4dCkge1xuICAgICAgICAgIGNfMS5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBqID0gd29ybGQubV9qb2ludExpc3Q7IGo7IGogPSBqLm1fbmV4dCkge1xuICAgICAgICAgIGoubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN0YWNrID0gdGhpcy5tX3N0YWNrO1xuICAgICAgICBmb3IgKHZhciBzZWVkID0gd29ybGQubV9ib2R5TGlzdDsgc2VlZDsgc2VlZCA9IHNlZWQubV9uZXh0KSB7XG4gICAgICAgICAgaWYgKHNlZWQubV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHNlZWQuaXNBd2FrZSgpID09IGZhbHNlIHx8IHNlZWQuaXNBY3RpdmUoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzZWVkLmlzU3RhdGljKCkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICAgICAgc3RhY2sucHVzaChzZWVkKTtcbiAgICAgICAgICBzZWVkLm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBiMiA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgdGhpcy5hZGRCb2R5KGIyKTtcbiAgICAgICAgICAgIGIyLm1fYXdha2VGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChiMi5pc1N0YXRpYygpKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgY2UgPSBiMi5tX2NvbnRhY3RMaXN0OyBjZTsgY2UgPSBjZS5uZXh0KSB7XG4gICAgICAgICAgICAgIHZhciBjb250YWN0ID0gY2UuY29udGFjdDtcbiAgICAgICAgICAgICAgaWYgKGNvbnRhY3QubV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKGNvbnRhY3QuaXNFbmFibGVkKCkgPT0gZmFsc2UgfHwgY29udGFjdC5pc1RvdWNoaW5nKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgc2Vuc29yQSA9IGNvbnRhY3QubV9maXh0dXJlQS5tX2lzU2Vuc29yO1xuICAgICAgICAgICAgICB2YXIgc2Vuc29yQiA9IGNvbnRhY3QubV9maXh0dXJlQi5tX2lzU2Vuc29yO1xuICAgICAgICAgICAgICBpZiAoc2Vuc29yQSB8fCBzZW5zb3JCKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdGhpcy5hZGRDb250YWN0KGNvbnRhY3QpO1xuICAgICAgICAgICAgICBjb250YWN0Lm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgIHZhciBvdGhlciA9IGNlLm90aGVyO1xuICAgICAgICAgICAgICBpZiAob3RoZXIubV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc3RhY2sucHVzaChvdGhlcik7XG4gICAgICAgICAgICAgIG90aGVyLm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBqZSA9IGIyLm1fam9pbnRMaXN0OyBqZTsgamUgPSBqZS5uZXh0KSB7XG4gICAgICAgICAgICAgIGlmIChqZS5qb2ludC5tX2lzbGFuZEZsYWcgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhciBvdGhlciA9IGplLm90aGVyO1xuICAgICAgICAgICAgICBpZiAob3RoZXIuaXNBY3RpdmUoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHRoaXMuYWRkSm9pbnQoamUuam9pbnQpO1xuICAgICAgICAgICAgICBqZS5qb2ludC5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICBpZiAob3RoZXIubV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc3RhY2sucHVzaChvdGhlcik7XG4gICAgICAgICAgICAgIG90aGVyLm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuc29sdmVJc2xhbmQoc3RlcCk7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgYjIgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgICAgaWYgKGIyLmlzU3RhdGljKCkpIHtcbiAgICAgICAgICAgICAgYjIubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUuc29sdmVJc2xhbmQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB3b3JsZCA9IHRoaXMubV93b3JsZDtcbiAgICAgICAgdmFyIGdyYXZpdHkgPSB3b3JsZC5tX2dyYXZpdHk7XG4gICAgICAgIHZhciBhbGxvd1NsZWVwID0gd29ybGQubV9hbGxvd1NsZWVwO1xuICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICBjb3B5VmVjMihjLCBib2R5Lm1fc3dlZXAuYyk7XG4gICAgICAgICAgdmFyIGEyID0gYm9keS5tX3N3ZWVwLmE7XG4gICAgICAgICAgY29weVZlYzIodiwgYm9keS5tX2xpbmVhclZlbG9jaXR5KTtcbiAgICAgICAgICB2YXIgdyA9IGJvZHkubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5tX3N3ZWVwLmMwLCBib2R5Lm1fc3dlZXAuYyk7XG4gICAgICAgICAgYm9keS5tX3N3ZWVwLmEwID0gYm9keS5tX3N3ZWVwLmE7XG4gICAgICAgICAgaWYgKGJvZHkuaXNEeW5hbWljKCkpIHtcbiAgICAgICAgICAgIHBsdXNTY2FsZVZlYzIodiwgaCAqIGJvZHkubV9ncmF2aXR5U2NhbGUsIGdyYXZpdHkpO1xuICAgICAgICAgICAgcGx1c1NjYWxlVmVjMih2LCBoICogYm9keS5tX2ludk1hc3MsIGJvZHkubV9mb3JjZSk7XG4gICAgICAgICAgICB3ICs9IGggKiBib2R5Lm1faW52SSAqIGJvZHkubV90b3JxdWU7XG4gICAgICAgICAgICBzY2FsZVZlYzIodiwgMSAvICgxICsgaCAqIGJvZHkubV9saW5lYXJEYW1waW5nKSwgdik7XG4gICAgICAgICAgICB3ICo9IDEgLyAoMSArIGggKiBib2R5Lm1fYW5ndWxhckRhbXBpbmcpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfcG9zaXRpb24uYywgYyk7XG4gICAgICAgICAgYm9keS5jX3Bvc2l0aW9uLmEgPSBhMjtcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfdmVsb2NpdHkudiwgdik7XG4gICAgICAgICAgYm9keS5jX3ZlbG9jaXR5LncgPSB3O1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbaV07XG4gICAgICAgICAgY29udGFjdC5pbml0Q29uc3RyYWludChzdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2ldO1xuICAgICAgICAgIGNvbnRhY3QuaW5pdFZlbG9jaXR5Q29uc3RyYWludChzdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbaV07XG4gICAgICAgICAgICBjb250YWN0Lndhcm1TdGFydENvbnN0cmFpbnQoc3RlcCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2pvaW50cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBqb2ludCA9IHRoaXMubV9qb2ludHNbaV07XG4gICAgICAgICAgam9pbnQuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMoc3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGVwLnZlbG9jaXR5SXRlcmF0aW9uczsgKytpKSB7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLm1fam9pbnRzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICB2YXIgam9pbnQgPSB0aGlzLm1fam9pbnRzW2pdO1xuICAgICAgICAgICAgam9pbnQuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzKHN0ZXApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbal07XG4gICAgICAgICAgICBjb250YWN0LnNvbHZlVmVsb2NpdHlDb25zdHJhaW50KHN0ZXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2ldO1xuICAgICAgICAgIGNvbnRhY3Quc3RvcmVDb25zdHJhaW50SW1wdWxzZXMoc3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgIGNvcHlWZWMyKGMsIGJvZHkuY19wb3NpdGlvbi5jKTtcbiAgICAgICAgICB2YXIgYTIgPSBib2R5LmNfcG9zaXRpb24uYTtcbiAgICAgICAgICBjb3B5VmVjMih2LCBib2R5LmNfdmVsb2NpdHkudik7XG4gICAgICAgICAgdmFyIHcgPSBib2R5LmNfdmVsb2NpdHkudztcbiAgICAgICAgICBzY2FsZVZlYzIodHJhbnNsYXRpb24sIGgsIHYpO1xuICAgICAgICAgIHZhciB0cmFuc2xhdGlvbkxlbmd0aFNxciA9IGxlbmd0aFNxclZlYzIodHJhbnNsYXRpb24pO1xuICAgICAgICAgIGlmICh0cmFuc2xhdGlvbkxlbmd0aFNxciA+IFNldHRpbmdzSW50ZXJuYWwubWF4VHJhbnNsYXRpb25TcXVhcmVkKSB7XG4gICAgICAgICAgICB2YXIgcmF0aW8gPSBTZXR0aW5nc0ludGVybmFsLm1heFRyYW5zbGF0aW9uIC8gbWF0aF9zcXJ0JDModHJhbnNsYXRpb25MZW5ndGhTcXIpO1xuICAgICAgICAgICAgbXVsVmVjMih2LCByYXRpbyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciByb3RhdGlvbjIgPSBoICogdztcbiAgICAgICAgICBpZiAocm90YXRpb24yICogcm90YXRpb24yID4gU2V0dGluZ3NJbnRlcm5hbC5tYXhSb3RhdGlvblNxdWFyZWQpIHtcbiAgICAgICAgICAgIHZhciByYXRpbyA9IFNldHRpbmdzSW50ZXJuYWwubWF4Um90YXRpb24gLyBtYXRoX2FicyQ2KHJvdGF0aW9uMik7XG4gICAgICAgICAgICB3ICo9IHJhdGlvO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwbHVzU2NhbGVWZWMyKGMsIGgsIHYpO1xuICAgICAgICAgIGEyICs9IGggKiB3O1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY19wb3NpdGlvbi5jLCBjKTtcbiAgICAgICAgICBib2R5LmNfcG9zaXRpb24uYSA9IGEyO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY192ZWxvY2l0eS52LCB2KTtcbiAgICAgICAgICBib2R5LmNfdmVsb2NpdHkudyA9IHc7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBvc2l0aW9uU29sdmVkID0gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnM7ICsraSkge1xuICAgICAgICAgIHZhciBtaW5TZXBhcmF0aW9uID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbal07XG4gICAgICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IGNvbnRhY3Quc29sdmVQb3NpdGlvbkNvbnN0cmFpbnQoc3RlcCk7XG4gICAgICAgICAgICBtaW5TZXBhcmF0aW9uID0gbWF0aF9taW4kNShtaW5TZXBhcmF0aW9uLCBzZXBhcmF0aW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGNvbnRhY3RzT2theSA9IG1pblNlcGFyYXRpb24gPj0gLTMgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3A7XG4gICAgICAgICAgdmFyIGpvaW50c09rYXkgPSB0cnVlO1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5tX2pvaW50cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGpvaW50ID0gdGhpcy5tX2pvaW50c1tqXTtcbiAgICAgICAgICAgIHZhciBqb2ludE9rYXkgPSBqb2ludC5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMoc3RlcCk7XG4gICAgICAgICAgICBqb2ludHNPa2F5ID0gam9pbnRzT2theSAmJiBqb2ludE9rYXk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjb250YWN0c09rYXkgJiYgam9pbnRzT2theSkge1xuICAgICAgICAgICAgcG9zaXRpb25Tb2x2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICBjb3B5VmVjMihib2R5Lm1fc3dlZXAuYywgYm9keS5jX3Bvc2l0aW9uLmMpO1xuICAgICAgICAgIGJvZHkubV9zd2VlcC5hID0gYm9keS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgICAgY29weVZlYzIoYm9keS5tX2xpbmVhclZlbG9jaXR5LCBib2R5LmNfdmVsb2NpdHkudik7XG4gICAgICAgICAgYm9keS5tX2FuZ3VsYXJWZWxvY2l0eSA9IGJvZHkuY192ZWxvY2l0eS53O1xuICAgICAgICAgIGJvZHkuc3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBvc3RTb2x2ZUlzbGFuZCgpO1xuICAgICAgICBpZiAoYWxsb3dTbGVlcCkge1xuICAgICAgICAgIHZhciBtaW5TbGVlcFRpbWUgPSBJbmZpbml0eTtcbiAgICAgICAgICB2YXIgbGluVG9sU3FyID0gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbGVlcFRvbGVyYW5jZVNxcjtcbiAgICAgICAgICB2YXIgYW5nVG9sU3FyID0gU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xlZXBUb2xlcmFuY2VTcXI7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgYm9keSA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgICBpZiAoYm9keS5pc1N0YXRpYygpKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGJvZHkubV9hdXRvU2xlZXBGbGFnID09IGZhbHNlIHx8IGJvZHkubV9hbmd1bGFyVmVsb2NpdHkgKiBib2R5Lm1fYW5ndWxhclZlbG9jaXR5ID4gYW5nVG9sU3FyIHx8IGxlbmd0aFNxclZlYzIoYm9keS5tX2xpbmVhclZlbG9jaXR5KSA+IGxpblRvbFNxcikge1xuICAgICAgICAgICAgICBib2R5Lm1fc2xlZXBUaW1lID0gMDtcbiAgICAgICAgICAgICAgbWluU2xlZXBUaW1lID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGJvZHkubV9zbGVlcFRpbWUgKz0gaDtcbiAgICAgICAgICAgICAgbWluU2xlZXBUaW1lID0gbWF0aF9taW4kNShtaW5TbGVlcFRpbWUsIGJvZHkubV9zbGVlcFRpbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobWluU2xlZXBUaW1lID49IFNldHRpbmdzSW50ZXJuYWwudGltZVRvU2xlZXAgJiYgcG9zaXRpb25Tb2x2ZWQpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICB2YXIgYm9keSA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgICAgIGJvZHkuc2V0QXdha2UoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFNvbHZlcjIucHJvdG90eXBlLnNvbHZlV29ybGRUT0kgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB3b3JsZCA9IHRoaXMubV93b3JsZDtcbiAgICAgICAgaWYgKHdvcmxkLm1fc3RlcENvbXBsZXRlKSB7XG4gICAgICAgICAgZm9yICh2YXIgYjIgPSB3b3JsZC5tX2JvZHlMaXN0OyBiMjsgYjIgPSBiMi5tX25leHQpIHtcbiAgICAgICAgICAgIGIyLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgYjIubV9zd2VlcC5hbHBoYTAgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmb3IgKHZhciBjXzIgPSB3b3JsZC5tX2NvbnRhY3RMaXN0OyBjXzI7IGNfMiA9IGNfMi5tX25leHQpIHtcbiAgICAgICAgICAgIGNfMi5tX3RvaUZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIGNfMi5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIGNfMi5tX3RvaUNvdW50ID0gMDtcbiAgICAgICAgICAgIGNfMi5tX3RvaSA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgdmFyIG1pbkNvbnRhY3QgPSBudWxsO1xuICAgICAgICAgIHZhciBtaW5BbHBoYSA9IDE7XG4gICAgICAgICAgZm9yICh2YXIgY18zID0gd29ybGQubV9jb250YWN0TGlzdDsgY18zOyBjXzMgPSBjXzMubV9uZXh0KSB7XG4gICAgICAgICAgICBpZiAoY18zLmlzRW5hYmxlZCgpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNfMy5tX3RvaUNvdW50ID4gU2V0dGluZ3NJbnRlcm5hbC5tYXhTdWJTdGVwcykge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhbHBoYSA9IDE7XG4gICAgICAgICAgICBpZiAoY18zLm1fdG9pRmxhZykge1xuICAgICAgICAgICAgICBhbHBoYSA9IGNfMy5tX3RvaTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciBmQV8xID0gY18zLmdldEZpeHR1cmVBKCk7XG4gICAgICAgICAgICAgIHZhciBmQl8xID0gY18zLmdldEZpeHR1cmVCKCk7XG4gICAgICAgICAgICAgIGlmIChmQV8xLmlzU2Vuc29yKCkgfHwgZkJfMS5pc1NlbnNvcigpKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIGJBXzEgPSBmQV8xLmdldEJvZHkoKTtcbiAgICAgICAgICAgICAgdmFyIGJCXzEgPSBmQl8xLmdldEJvZHkoKTtcbiAgICAgICAgICAgICAgdmFyIGFjdGl2ZUEgPSBiQV8xLmlzQXdha2UoKSAmJiAhYkFfMS5pc1N0YXRpYygpO1xuICAgICAgICAgICAgICB2YXIgYWN0aXZlQiA9IGJCXzEuaXNBd2FrZSgpICYmICFiQl8xLmlzU3RhdGljKCk7XG4gICAgICAgICAgICAgIGlmIChhY3RpdmVBID09IGZhbHNlICYmIGFjdGl2ZUIgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgY29sbGlkZUEgPSBiQV8xLmlzQnVsbGV0KCkgfHwgIWJBXzEuaXNEeW5hbWljKCk7XG4gICAgICAgICAgICAgIHZhciBjb2xsaWRlQiA9IGJCXzEuaXNCdWxsZXQoKSB8fCAhYkJfMS5pc0R5bmFtaWMoKTtcbiAgICAgICAgICAgICAgaWYgKGNvbGxpZGVBID09IGZhbHNlICYmIGNvbGxpZGVCID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIGFscGhhMCA9IGJBXzEubV9zd2VlcC5hbHBoYTA7XG4gICAgICAgICAgICAgIGlmIChiQV8xLm1fc3dlZXAuYWxwaGEwIDwgYkJfMS5tX3N3ZWVwLmFscGhhMCkge1xuICAgICAgICAgICAgICAgIGFscGhhMCA9IGJCXzEubV9zd2VlcC5hbHBoYTA7XG4gICAgICAgICAgICAgICAgYkFfMS5tX3N3ZWVwLmFkdmFuY2UoYWxwaGEwKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChiQl8xLm1fc3dlZXAuYWxwaGEwIDwgYkFfMS5tX3N3ZWVwLmFscGhhMCkge1xuICAgICAgICAgICAgICAgIGFscGhhMCA9IGJBXzEubV9zd2VlcC5hbHBoYTA7XG4gICAgICAgICAgICAgICAgYkJfMS5tX3N3ZWVwLmFkdmFuY2UoYWxwaGEwKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgaW5kZXhBID0gY18zLmdldENoaWxkSW5kZXhBKCk7XG4gICAgICAgICAgICAgIHZhciBpbmRleEIgPSBjXzMuZ2V0Q2hpbGRJbmRleEIoKTtcbiAgICAgICAgICAgICAgaW5wdXQucHJveHlBLnNldChmQV8xLmdldFNoYXBlKCksIGluZGV4QSk7XG4gICAgICAgICAgICAgIGlucHV0LnByb3h5Qi5zZXQoZkJfMS5nZXRTaGFwZSgpLCBpbmRleEIpO1xuICAgICAgICAgICAgICBpbnB1dC5zd2VlcEEuc2V0KGJBXzEubV9zd2VlcCk7XG4gICAgICAgICAgICAgIGlucHV0LnN3ZWVwQi5zZXQoYkJfMS5tX3N3ZWVwKTtcbiAgICAgICAgICAgICAgaW5wdXQudE1heCA9IDE7XG4gICAgICAgICAgICAgIFRpbWVPZkltcGFjdChvdXRwdXQsIGlucHV0KTtcbiAgICAgICAgICAgICAgdmFyIGJldGEgPSBvdXRwdXQudDtcbiAgICAgICAgICAgICAgaWYgKG91dHB1dC5zdGF0ZSA9PSBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZS5lX3RvdWNoaW5nKSB7XG4gICAgICAgICAgICAgICAgYWxwaGEgPSBtYXRoX21pbiQ1KGFscGhhMCArICgxIC0gYWxwaGEwKSAqIGJldGEsIDEpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGFscGhhID0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjXzMubV90b2kgPSBhbHBoYTtcbiAgICAgICAgICAgICAgY18zLm1fdG9pRmxhZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYWxwaGEgPCBtaW5BbHBoYSkge1xuICAgICAgICAgICAgICBtaW5Db250YWN0ID0gY18zO1xuICAgICAgICAgICAgICBtaW5BbHBoYSA9IGFscGhhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobWluQ29udGFjdCA9PSBudWxsIHx8IDEgLSAxMCAqIEVQU0lMT04gPCBtaW5BbHBoYSkge1xuICAgICAgICAgICAgd29ybGQubV9zdGVwQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBmQSA9IG1pbkNvbnRhY3QuZ2V0Rml4dHVyZUEoKTtcbiAgICAgICAgICB2YXIgZkIgPSBtaW5Db250YWN0LmdldEZpeHR1cmVCKCk7XG4gICAgICAgICAgdmFyIGJBID0gZkEuZ2V0Qm9keSgpO1xuICAgICAgICAgIHZhciBiQiA9IGZCLmdldEJvZHkoKTtcbiAgICAgICAgICBiYWNrdXAxLnNldChiQS5tX3N3ZWVwKTtcbiAgICAgICAgICBiYWNrdXAyLnNldChiQi5tX3N3ZWVwKTtcbiAgICAgICAgICBiQS5hZHZhbmNlKG1pbkFscGhhKTtcbiAgICAgICAgICBiQi5hZHZhbmNlKG1pbkFscGhhKTtcbiAgICAgICAgICBtaW5Db250YWN0LnVwZGF0ZSh3b3JsZCk7XG4gICAgICAgICAgbWluQ29udGFjdC5tX3RvaUZsYWcgPSBmYWxzZTtcbiAgICAgICAgICArK21pbkNvbnRhY3QubV90b2lDb3VudDtcbiAgICAgICAgICBpZiAobWluQ29udGFjdC5pc0VuYWJsZWQoKSA9PSBmYWxzZSB8fCBtaW5Db250YWN0LmlzVG91Y2hpbmcoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgbWluQ29udGFjdC5zZXRFbmFibGVkKGZhbHNlKTtcbiAgICAgICAgICAgIGJBLm1fc3dlZXAuc2V0KGJhY2t1cDEpO1xuICAgICAgICAgICAgYkIubV9zd2VlcC5zZXQoYmFja3VwMik7XG4gICAgICAgICAgICBiQS5zeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgYkIuc3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBiQS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICBiQi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICAgICAgdGhpcy5hZGRCb2R5KGJBKTtcbiAgICAgICAgICB0aGlzLmFkZEJvZHkoYkIpO1xuICAgICAgICAgIHRoaXMuYWRkQ29udGFjdChtaW5Db250YWN0KTtcbiAgICAgICAgICBiQS5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgIGJCLm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgbWluQ29udGFjdC5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgIHZhciBib2RpZXMgPSBbYkEsIGJCXTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGJvZHkgPSBib2RpZXNbaV07XG4gICAgICAgICAgICBpZiAoYm9keS5pc0R5bmFtaWMoKSkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBjZSA9IGJvZHkubV9jb250YWN0TGlzdDsgY2U7IGNlID0gY2UubmV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBjb250YWN0ID0gY2UuY29udGFjdDtcbiAgICAgICAgICAgICAgICBpZiAoY29udGFjdC5tX2lzbGFuZEZsYWcpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb3RoZXIgPSBjZS5vdGhlcjtcbiAgICAgICAgICAgICAgICBpZiAob3RoZXIuaXNEeW5hbWljKCkgJiYgIWJvZHkuaXNCdWxsZXQoKSAmJiAhb3RoZXIuaXNCdWxsZXQoKSkge1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzZW5zb3JBID0gY29udGFjdC5tX2ZpeHR1cmVBLm1faXNTZW5zb3I7XG4gICAgICAgICAgICAgICAgdmFyIHNlbnNvckIgPSBjb250YWN0Lm1fZml4dHVyZUIubV9pc1NlbnNvcjtcbiAgICAgICAgICAgICAgICBpZiAoc2Vuc29yQSB8fCBzZW5zb3JCKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYmFja3VwLnNldChvdGhlci5tX3N3ZWVwKTtcbiAgICAgICAgICAgICAgICBpZiAob3RoZXIubV9pc2xhbmRGbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICBvdGhlci5hZHZhbmNlKG1pbkFscGhhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGFjdC51cGRhdGUod29ybGQpO1xuICAgICAgICAgICAgICAgIGlmIChjb250YWN0LmlzRW5hYmxlZCgpID09IGZhbHNlIHx8IGNvbnRhY3QuaXNUb3VjaGluZygpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICBvdGhlci5tX3N3ZWVwLnNldChiYWNrdXApO1xuICAgICAgICAgICAgICAgICAgb3RoZXIuc3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250YWN0Lm1faXNsYW5kRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRDb250YWN0KGNvbnRhY3QpO1xuICAgICAgICAgICAgICAgIGlmIChvdGhlci5tX2lzbGFuZEZsYWcpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvdGhlci5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICghb3RoZXIuaXNTdGF0aWMoKSkge1xuICAgICAgICAgICAgICAgICAgb3RoZXIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuYWRkQm9keShvdGhlcik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgc19zdWJTdGVwLnJlc2V0KCgxIC0gbWluQWxwaGEpICogc3RlcC5kdCk7XG4gICAgICAgICAgc19zdWJTdGVwLmR0UmF0aW8gPSAxO1xuICAgICAgICAgIHNfc3ViU3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnMgPSAyMDtcbiAgICAgICAgICBzX3N1YlN0ZXAudmVsb2NpdHlJdGVyYXRpb25zID0gc3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnM7XG4gICAgICAgICAgc19zdWJTdGVwLndhcm1TdGFydGluZyA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuc29sdmVJc2xhbmRUT0koc19zdWJTdGVwLCBiQSwgYkIpO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgICAgYm9keS5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICghYm9keS5pc0R5bmFtaWMoKSkge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJvZHkuc3luY2hyb25pemVGaXh0dXJlcygpO1xuICAgICAgICAgICAgZm9yICh2YXIgY2UgPSBib2R5Lm1fY29udGFjdExpc3Q7IGNlOyBjZSA9IGNlLm5leHQpIHtcbiAgICAgICAgICAgICAgY2UuY29udGFjdC5tX3RvaUZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgY2UuY29udGFjdC5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgd29ybGQuZmluZE5ld0NvbnRhY3RzKCk7XG4gICAgICAgICAgaWYgKHdvcmxkLm1fc3ViU3RlcHBpbmcpIHtcbiAgICAgICAgICAgIHdvcmxkLm1fc3RlcENvbXBsZXRlID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBTb2x2ZXIyLnByb3RvdHlwZS5zb2x2ZUlzbGFuZFRPSSA9IGZ1bmN0aW9uKHN1YlN0ZXAsIHRvaUEsIHRvaUIpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fYm9kaWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFyIGJvZHkgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkuY19wb3NpdGlvbi5jLCBib2R5Lm1fc3dlZXAuYyk7XG4gICAgICAgICAgYm9keS5jX3Bvc2l0aW9uLmEgPSBib2R5Lm1fc3dlZXAuYTtcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfdmVsb2NpdHkudiwgYm9keS5tX2xpbmVhclZlbG9jaXR5KTtcbiAgICAgICAgICBib2R5LmNfdmVsb2NpdHkudyA9IGJvZHkubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29udGFjdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0c1tpXTtcbiAgICAgICAgICBjb250YWN0LmluaXRDb25zdHJhaW50KHN1YlN0ZXApO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3ViU3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnM7ICsraSkge1xuICAgICAgICAgIHZhciBtaW5TZXBhcmF0aW9uID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbal07XG4gICAgICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IGNvbnRhY3Quc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRUT0koc3ViU3RlcCwgdG9pQSwgdG9pQik7XG4gICAgICAgICAgICBtaW5TZXBhcmF0aW9uID0gbWF0aF9taW4kNShtaW5TZXBhcmF0aW9uLCBzZXBhcmF0aW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGNvbnRhY3RzT2theSA9IG1pblNlcGFyYXRpb24gPj0gLTEuNSAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgICAgICBpZiAoY29udGFjdHNPa2F5KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGNvcHlWZWMyKHRvaUEubV9zd2VlcC5jMCwgdG9pQS5jX3Bvc2l0aW9uLmMpO1xuICAgICAgICB0b2lBLm1fc3dlZXAuYTAgPSB0b2lBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgY29weVZlYzIodG9pQi5tX3N3ZWVwLmMwLCB0b2lCLmNfcG9zaXRpb24uYyk7XG4gICAgICAgIHRvaUIubV9zd2VlcC5hMCA9IHRvaUIuY19wb3NpdGlvbi5hO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBjb250YWN0ID0gdGhpcy5tX2NvbnRhY3RzW2ldO1xuICAgICAgICAgIGNvbnRhY3QuaW5pdFZlbG9jaXR5Q29uc3RyYWludChzdWJTdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1YlN0ZXAudmVsb2NpdHlJdGVyYXRpb25zOyArK2kpIHtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbal07XG4gICAgICAgICAgICBjb250YWN0LnNvbHZlVmVsb2NpdHlDb25zdHJhaW50KHN1YlN0ZXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgaCA9IHN1YlN0ZXAuZHQ7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2JvZGllcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBib2R5ID0gdGhpcy5tX2JvZGllc1tpXTtcbiAgICAgICAgICBjb3B5VmVjMihjLCBib2R5LmNfcG9zaXRpb24uYyk7XG4gICAgICAgICAgdmFyIGEyID0gYm9keS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgICAgY29weVZlYzIodiwgYm9keS5jX3ZlbG9jaXR5LnYpO1xuICAgICAgICAgIHZhciB3ID0gYm9keS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgICAgc2NhbGVWZWMyKHRyYW5zbGF0aW9uLCBoLCB2KTtcbiAgICAgICAgICB2YXIgdHJhbnNsYXRpb25MZW5ndGhTcXIgPSBsZW5ndGhTcXJWZWMyKHRyYW5zbGF0aW9uKTtcbiAgICAgICAgICBpZiAodHJhbnNsYXRpb25MZW5ndGhTcXIgPiBTZXR0aW5nc0ludGVybmFsLm1heFRyYW5zbGF0aW9uU3F1YXJlZCkge1xuICAgICAgICAgICAgdmFyIHJhdGlvID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhUcmFuc2xhdGlvbiAvIG1hdGhfc3FydCQzKHRyYW5zbGF0aW9uTGVuZ3RoU3FyKTtcbiAgICAgICAgICAgIG11bFZlYzIodiwgcmF0aW8pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcm90YXRpb24yID0gaCAqIHc7XG4gICAgICAgICAgaWYgKHJvdGF0aW9uMiAqIHJvdGF0aW9uMiA+IFNldHRpbmdzSW50ZXJuYWwubWF4Um90YXRpb25TcXVhcmVkKSB7XG4gICAgICAgICAgICB2YXIgcmF0aW8gPSBTZXR0aW5nc0ludGVybmFsLm1heFJvdGF0aW9uIC8gbWF0aF9hYnMkNihyb3RhdGlvbjIpO1xuICAgICAgICAgICAgdyAqPSByYXRpbztcbiAgICAgICAgICB9XG4gICAgICAgICAgcGx1c1NjYWxlVmVjMihjLCBoLCB2KTtcbiAgICAgICAgICBhMiArPSBoICogdztcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfcG9zaXRpb24uYywgYyk7XG4gICAgICAgICAgYm9keS5jX3Bvc2l0aW9uLmEgPSBhMjtcbiAgICAgICAgICBjb3B5VmVjMihib2R5LmNfdmVsb2NpdHkudiwgdik7XG4gICAgICAgICAgYm9keS5jX3ZlbG9jaXR5LncgPSB3O1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkubV9zd2VlcC5jLCBjKTtcbiAgICAgICAgICBib2R5Lm1fc3dlZXAuYSA9IGEyO1xuICAgICAgICAgIGNvcHlWZWMyKGJvZHkubV9saW5lYXJWZWxvY2l0eSwgdik7XG4gICAgICAgICAgYm9keS5tX2FuZ3VsYXJWZWxvY2l0eSA9IHc7XG4gICAgICAgICAgYm9keS5zeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucG9zdFNvbHZlSXNsYW5kKCk7XG4gICAgICB9O1xuICAgICAgU29sdmVyMi5wcm90b3R5cGUucG9zdFNvbHZlSXNsYW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZvciAodmFyIGNfNSA9IDA7IGNfNSA8IHRoaXMubV9jb250YWN0cy5sZW5ndGg7ICsrY181KSB7XG4gICAgICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdHNbY181XTtcbiAgICAgICAgICB0aGlzLm1fd29ybGQucG9zdFNvbHZlKGNvbnRhY3QsIGNvbnRhY3QubV9pbXB1bHNlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHJldHVybiBTb2x2ZXIyO1xuICAgIH0oKVxuICApO1xuICBTb2x2ZXIuVGltZVN0ZXAgPSBUaW1lU3RlcDtcbiAgdmFyIE1hdDIyID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIE1hdDIyMihhMiwgYjIsIGMyLCBkMikge1xuICAgICAgICBpZiAodHlwZW9mIGEyID09PSBcIm9iamVjdFwiICYmIGEyICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5leCA9IFZlYzIuY2xvbmUoYTIpO1xuICAgICAgICAgIHRoaXMuZXkgPSBWZWMyLmNsb25lKGIyKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYTIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICB0aGlzLmV4ID0gVmVjMi5uZW8oYTIsIGMyKTtcbiAgICAgICAgICB0aGlzLmV5ID0gVmVjMi5uZW8oYjIsIGQyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmV4ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgdGhpcy5leSA9IFZlYzIuemVybygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBNYXQyMjIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIuaXNWYWxpZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFZlYzIuaXNWYWxpZChvYmouZXgpICYmIFZlYzIuaXNWYWxpZChvYmouZXkpO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5hc3NlcnQgPSBmdW5jdGlvbihvKSB7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihhMiwgYjIsIGMyLCBkMikge1xuICAgICAgICBpZiAodHlwZW9mIGEyID09PSBcIm51bWJlclwiICYmIHR5cGVvZiBiMiA9PT0gXCJudW1iZXJcIiAmJiB0eXBlb2YgYzIgPT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGQyID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgdGhpcy5leC5zZXROdW0oYTIsIGMyKTtcbiAgICAgICAgICB0aGlzLmV5LnNldE51bShiMiwgZDIpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhMiA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgYjIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLmV4LnNldFZlYzIoYTIpO1xuICAgICAgICAgIHRoaXMuZXkuc2V0VmVjMihiMik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGEyID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgdGhpcy5leC5zZXRWZWMyKGEyLmV4KTtcbiAgICAgICAgICB0aGlzLmV5LnNldFZlYzIoYTIuZXkpO1xuICAgICAgICB9IGVsc2UgO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5wcm90b3R5cGUuc2V0SWRlbnRpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5leC54ID0gMTtcbiAgICAgICAgdGhpcy5leS54ID0gMDtcbiAgICAgICAgdGhpcy5leC55ID0gMDtcbiAgICAgICAgdGhpcy5leS55ID0gMTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIucHJvdG90eXBlLnNldFplcm8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5leC54ID0gMDtcbiAgICAgICAgdGhpcy5leS54ID0gMDtcbiAgICAgICAgdGhpcy5leC55ID0gMDtcbiAgICAgICAgdGhpcy5leS55ID0gMDtcbiAgICAgIH07XG4gICAgICBNYXQyMjIucHJvdG90eXBlLmdldEludmVyc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGEyID0gdGhpcy5leC54O1xuICAgICAgICB2YXIgYjIgPSB0aGlzLmV5Lng7XG4gICAgICAgIHZhciBjMiA9IHRoaXMuZXgueTtcbiAgICAgICAgdmFyIGQyID0gdGhpcy5leS55O1xuICAgICAgICB2YXIgZGV0ID0gYTIgKiBkMiAtIGIyICogYzI7XG4gICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICBkZXQgPSAxIC8gZGV0O1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbXggPSBuZXcgTWF0MjIyKCk7XG4gICAgICAgIGlteC5leC54ID0gZGV0ICogZDI7XG4gICAgICAgIGlteC5leS54ID0gLWRldCAqIGIyO1xuICAgICAgICBpbXguZXgueSA9IC1kZXQgKiBjMjtcbiAgICAgICAgaW14LmV5LnkgPSBkZXQgKiBhMjtcbiAgICAgICAgcmV0dXJuIGlteDtcbiAgICAgIH07XG4gICAgICBNYXQyMjIucHJvdG90eXBlLnNvbHZlID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgdmFyIGEyID0gdGhpcy5leC54O1xuICAgICAgICB2YXIgYjIgPSB0aGlzLmV5Lng7XG4gICAgICAgIHZhciBjMiA9IHRoaXMuZXgueTtcbiAgICAgICAgdmFyIGQyID0gdGhpcy5leS55O1xuICAgICAgICB2YXIgZGV0ID0gYTIgKiBkMiAtIGIyICogYzI7XG4gICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICBkZXQgPSAxIC8gZGV0O1xuICAgICAgICB9XG4gICAgICAgIHZhciB3ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHcueCA9IGRldCAqIChkMiAqIHYzLnggLSBiMiAqIHYzLnkpO1xuICAgICAgICB3LnkgPSBkZXQgKiAoYTIgKiB2My55IC0gYzIgKiB2My54KTtcbiAgICAgICAgcmV0dXJuIHc7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLm11bCA9IGZ1bmN0aW9uKG14LCB2Mykge1xuICAgICAgICBpZiAodjMgJiYgXCJ4XCIgaW4gdjMgJiYgXCJ5XCIgaW4gdjMpIHtcbiAgICAgICAgICB2YXIgeDIgPSBteC5leC54ICogdjMueCArIG14LmV5LnggKiB2My55O1xuICAgICAgICAgIHZhciB5ID0gbXguZXgueSAqIHYzLnggKyBteC5leS55ICogdjMueTtcbiAgICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgICB9IGVsc2UgaWYgKHYzICYmIFwiZXhcIiBpbiB2MyAmJiBcImV5XCIgaW4gdjMpIHtcbiAgICAgICAgICB2YXIgYTIgPSBteC5leC54ICogdjMuZXgueCArIG14LmV5LnggKiB2My5leC55O1xuICAgICAgICAgIHZhciBiMiA9IG14LmV4LnggKiB2My5leS54ICsgbXguZXkueCAqIHYzLmV5Lnk7XG4gICAgICAgICAgdmFyIGMyID0gbXguZXgueSAqIHYzLmV4LnggKyBteC5leS55ICogdjMuZXgueTtcbiAgICAgICAgICB2YXIgZDIgPSBteC5leC55ICogdjMuZXkueCArIG14LmV5LnkgKiB2My5leS55O1xuICAgICAgICAgIHJldHVybiBuZXcgTWF0MjIyKGEyLCBiMiwgYzIsIGQyKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1hdDIyMi5tdWxWZWMyID0gZnVuY3Rpb24obXgsIHYzKSB7XG4gICAgICAgIHZhciB4MiA9IG14LmV4LnggKiB2My54ICsgbXguZXkueCAqIHYzLnk7XG4gICAgICAgIHZhciB5ID0gbXguZXgueSAqIHYzLnggKyBteC5leS55ICogdjMueTtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHgyLCB5KTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIubXVsTWF0MjIgPSBmdW5jdGlvbihteCwgdjMpIHtcbiAgICAgICAgdmFyIGEyID0gbXguZXgueCAqIHYzLmV4LnggKyBteC5leS54ICogdjMuZXgueTtcbiAgICAgICAgdmFyIGIyID0gbXguZXgueCAqIHYzLmV5LnggKyBteC5leS54ICogdjMuZXkueTtcbiAgICAgICAgdmFyIGMyID0gbXguZXgueSAqIHYzLmV4LnggKyBteC5leS55ICogdjMuZXgueTtcbiAgICAgICAgdmFyIGQyID0gbXguZXgueSAqIHYzLmV5LnggKyBteC5leS55ICogdjMuZXkueTtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXQyMjIoYTIsIGIyLCBjMiwgZDIpO1xuICAgICAgfTtcbiAgICAgIE1hdDIyMi5tdWxUID0gZnVuY3Rpb24obXgsIHYzKSB7XG4gICAgICAgIGlmICh2MyAmJiBcInhcIiBpbiB2MyAmJiBcInlcIiBpbiB2Mykge1xuICAgICAgICAgIHJldHVybiBWZWMyLm5lbyhWZWMyLmRvdCh2MywgbXguZXgpLCBWZWMyLmRvdCh2MywgbXguZXkpKTtcbiAgICAgICAgfSBlbHNlIGlmICh2MyAmJiBcImV4XCIgaW4gdjMgJiYgXCJleVwiIGluIHYzKSB7XG4gICAgICAgICAgdmFyIGMxID0gVmVjMi5uZW8oVmVjMi5kb3QobXguZXgsIHYzLmV4KSwgVmVjMi5kb3QobXguZXksIHYzLmV4KSk7XG4gICAgICAgICAgdmFyIGMyID0gVmVjMi5uZW8oVmVjMi5kb3QobXguZXgsIHYzLmV5KSwgVmVjMi5kb3QobXguZXksIHYzLmV5KSk7XG4gICAgICAgICAgcmV0dXJuIG5ldyBNYXQyMjIoYzEsIGMyKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1hdDIyMi5tdWxUVmVjMiA9IGZ1bmN0aW9uKG14LCB2Mykge1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oVmVjMi5kb3QodjMsIG14LmV4KSwgVmVjMi5kb3QodjMsIG14LmV5KSk7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLm11bFRNYXQyMiA9IGZ1bmN0aW9uKG14LCB2Mykge1xuICAgICAgICB2YXIgYzEgPSBWZWMyLm5lbyhWZWMyLmRvdChteC5leCwgdjMuZXgpLCBWZWMyLmRvdChteC5leSwgdjMuZXgpKTtcbiAgICAgICAgdmFyIGMyID0gVmVjMi5uZW8oVmVjMi5kb3QobXguZXgsIHYzLmV5KSwgVmVjMi5kb3QobXguZXksIHYzLmV5KSk7XG4gICAgICAgIHJldHVybiBuZXcgTWF0MjIyKGMxLCBjMik7XG4gICAgICB9O1xuICAgICAgTWF0MjIyLmFicyA9IGZ1bmN0aW9uKG14KSB7XG4gICAgICAgIHJldHVybiBuZXcgTWF0MjIyKFZlYzIuYWJzKG14LmV4KSwgVmVjMi5hYnMobXguZXkpKTtcbiAgICAgIH07XG4gICAgICBNYXQyMjIuYWRkID0gZnVuY3Rpb24obXgxLCBteDIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXQyMjIoVmVjMi5hZGQobXgxLmV4LCBteDIuZXgpLCBWZWMyLmFkZChteDEuZXksIG14Mi5leSkpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBNYXQyMjI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBtYXRoX3NxcnQkMiA9IE1hdGguc3FydDtcbiAgdmFyIHBvaW50QSQxID0gdmVjMigwLCAwKTtcbiAgdmFyIHBvaW50QiQxID0gdmVjMigwLCAwKTtcbiAgdmFyIHRlbXAkMyA9IHZlYzIoMCwgMCk7XG4gIHZhciBjQSQxID0gdmVjMigwLCAwKTtcbiAgdmFyIGNCJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgZGlzdCA9IHZlYzIoMCwgMCk7XG4gIHZhciBwbGFuZVBvaW50JDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgY2xpcFBvaW50JDEgPSB2ZWMyKDAsIDApO1xuICBleHBvcnRzMi5NYW5pZm9sZFR5cGUgPSB2b2lkIDA7XG4gIChmdW5jdGlvbihNYW5pZm9sZFR5cGUyKSB7XG4gICAgTWFuaWZvbGRUeXBlMltNYW5pZm9sZFR5cGUyW1wiZV91bnNldFwiXSA9IC0xXSA9IFwiZV91bnNldFwiO1xuICAgIE1hbmlmb2xkVHlwZTJbTWFuaWZvbGRUeXBlMltcImVfY2lyY2xlc1wiXSA9IDBdID0gXCJlX2NpcmNsZXNcIjtcbiAgICBNYW5pZm9sZFR5cGUyW01hbmlmb2xkVHlwZTJbXCJlX2ZhY2VBXCJdID0gMV0gPSBcImVfZmFjZUFcIjtcbiAgICBNYW5pZm9sZFR5cGUyW01hbmlmb2xkVHlwZTJbXCJlX2ZhY2VCXCJdID0gMl0gPSBcImVfZmFjZUJcIjtcbiAgfSkoZXhwb3J0czIuTWFuaWZvbGRUeXBlIHx8IChleHBvcnRzMi5NYW5pZm9sZFR5cGUgPSB7fSkpO1xuICBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUgPSB2b2lkIDA7XG4gIChmdW5jdGlvbihDb250YWN0RmVhdHVyZVR5cGUyKSB7XG4gICAgQ29udGFjdEZlYXR1cmVUeXBlMltDb250YWN0RmVhdHVyZVR5cGUyW1wiZV91bnNldFwiXSA9IC0xXSA9IFwiZV91bnNldFwiO1xuICAgIENvbnRhY3RGZWF0dXJlVHlwZTJbQ29udGFjdEZlYXR1cmVUeXBlMltcImVfdmVydGV4XCJdID0gMF0gPSBcImVfdmVydGV4XCI7XG4gICAgQ29udGFjdEZlYXR1cmVUeXBlMltDb250YWN0RmVhdHVyZVR5cGUyW1wiZV9mYWNlXCJdID0gMV0gPSBcImVfZmFjZVwiO1xuICB9KShleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUgfHwgKGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZSA9IHt9KSk7XG4gIGV4cG9ydHMyLlBvaW50U3RhdGUgPSB2b2lkIDA7XG4gIChmdW5jdGlvbihQb2ludFN0YXRlMikge1xuICAgIFBvaW50U3RhdGUyW1BvaW50U3RhdGUyW1wibnVsbFN0YXRlXCJdID0gMF0gPSBcIm51bGxTdGF0ZVwiO1xuICAgIFBvaW50U3RhdGUyW1BvaW50U3RhdGUyW1wiYWRkU3RhdGVcIl0gPSAxXSA9IFwiYWRkU3RhdGVcIjtcbiAgICBQb2ludFN0YXRlMltQb2ludFN0YXRlMltcInBlcnNpc3RTdGF0ZVwiXSA9IDJdID0gXCJwZXJzaXN0U3RhdGVcIjtcbiAgICBQb2ludFN0YXRlMltQb2ludFN0YXRlMltcInJlbW92ZVN0YXRlXCJdID0gM10gPSBcInJlbW92ZVN0YXRlXCI7XG4gIH0pKGV4cG9ydHMyLlBvaW50U3RhdGUgfHwgKGV4cG9ydHMyLlBvaW50U3RhdGUgPSB7fSkpO1xuICB2YXIgQ2xpcFZlcnRleCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBDbGlwVmVydGV4MigpIHtcbiAgICAgICAgdGhpcy52ID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5pZCA9IG5ldyBDb250YWN0SUQoKTtcbiAgICAgIH1cbiAgICAgIENsaXBWZXJ0ZXgyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihvKSB7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMudiwgby52KTtcbiAgICAgICAgdGhpcy5pZC5zZXQoby5pZCk7XG4gICAgICB9O1xuICAgICAgQ2xpcFZlcnRleDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgemVyb1ZlYzIodGhpcy52KTtcbiAgICAgICAgdGhpcy5pZC5yZWN5Y2xlKCk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIENsaXBWZXJ0ZXgyO1xuICAgIH0oKVxuICApO1xuICB2YXIgTWFuaWZvbGQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gTWFuaWZvbGQyKCkge1xuICAgICAgICB0aGlzLmxvY2FsTm9ybWFsID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5sb2NhbFBvaW50ID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5wb2ludHMgPSBbbmV3IE1hbmlmb2xkUG9pbnQoKSwgbmV3IE1hbmlmb2xkUG9pbnQoKV07XG4gICAgICAgIHRoaXMucG9pbnRDb3VudCA9IDA7XG4gICAgICB9XG4gICAgICBNYW5pZm9sZDIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRoYXQpIHtcbiAgICAgICAgdGhpcy50eXBlID0gdGhhdC50eXBlO1xuICAgICAgICBjb3B5VmVjMih0aGlzLmxvY2FsTm9ybWFsLCB0aGF0LmxvY2FsTm9ybWFsKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5sb2NhbFBvaW50LCB0aGF0LmxvY2FsUG9pbnQpO1xuICAgICAgICB0aGlzLnBvaW50Q291bnQgPSB0aGF0LnBvaW50Q291bnQ7XG4gICAgICAgIHRoaXMucG9pbnRzWzBdLnNldCh0aGF0LnBvaW50c1swXSk7XG4gICAgICAgIHRoaXMucG9pbnRzWzFdLnNldCh0aGF0LnBvaW50c1sxXSk7XG4gICAgICB9O1xuICAgICAgTWFuaWZvbGQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX3Vuc2V0O1xuICAgICAgICB6ZXJvVmVjMih0aGlzLmxvY2FsTm9ybWFsKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5sb2NhbFBvaW50KTtcbiAgICAgICAgdGhpcy5wb2ludENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5wb2ludHNbMF0ucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLnBvaW50c1sxXS5yZWN5Y2xlKCk7XG4gICAgICB9O1xuICAgICAgTWFuaWZvbGQyLnByb3RvdHlwZS5nZXRXb3JsZE1hbmlmb2xkID0gZnVuY3Rpb24od20sIHhmQTIsIHJhZGl1c0EsIHhmQjIsIHJhZGl1c0IpIHtcbiAgICAgICAgaWYgKHRoaXMucG9pbnRDb3VudCA9PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIHdtO1xuICAgICAgICB9XG4gICAgICAgIHdtID0gd20gfHwgbmV3IFdvcmxkTWFuaWZvbGQoKTtcbiAgICAgICAgd20ucG9pbnRDb3VudCA9IHRoaXMucG9pbnRDb3VudDtcbiAgICAgICAgdmFyIG5vcm1hbDMgPSB3bS5ub3JtYWw7XG4gICAgICAgIHZhciBwb2ludHMgPSB3bS5wb2ludHM7XG4gICAgICAgIHZhciBzZXBhcmF0aW9ucyA9IHdtLnNlcGFyYXRpb25zO1xuICAgICAgICBzd2l0Y2ggKHRoaXMudHlwZSkge1xuICAgICAgICAgIGNhc2UgZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfY2lyY2xlczoge1xuICAgICAgICAgICAgc2V0VmVjMihub3JtYWwzLCAxLCAwKTtcbiAgICAgICAgICAgIHZhciBtYW5pZm9sZFBvaW50ID0gdGhpcy5wb2ludHNbMF07XG4gICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSQxLCB4ZkEyLCB0aGlzLmxvY2FsUG9pbnQpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwb2ludEIkMSwgeGZCMiwgbWFuaWZvbGRQb2ludC5sb2NhbFBvaW50KTtcbiAgICAgICAgICAgIHN1YlZlYzIoZGlzdCwgcG9pbnRCJDEsIHBvaW50QSQxKTtcbiAgICAgICAgICAgIHZhciBsZW5ndGhTcXIgPSBsZW5ndGhTcXJWZWMyKGRpc3QpO1xuICAgICAgICAgICAgaWYgKGxlbmd0aFNxciA+IEVQU0lMT04gKiBFUFNJTE9OKSB7XG4gICAgICAgICAgICAgIHZhciBsZW5ndGhfMSA9IG1hdGhfc3FydCQyKGxlbmd0aFNxcik7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwzLCAxIC8gbGVuZ3RoXzEsIGRpc3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29tYmluZTJWZWMyKGNBJDEsIDEsIHBvaW50QSQxLCByYWRpdXNBLCBub3JtYWwzKTtcbiAgICAgICAgICAgIGNvbWJpbmUyVmVjMihjQiQxLCAxLCBwb2ludEIkMSwgLXJhZGl1c0IsIG5vcm1hbDMpO1xuICAgICAgICAgICAgY29tYmluZTJWZWMyKHBvaW50c1swXSwgMC41LCBjQSQxLCAwLjUsIGNCJDEpO1xuICAgICAgICAgICAgc2VwYXJhdGlvbnNbMF0gPSBkb3RWZWMyKHN1YlZlYzIodGVtcCQzLCBjQiQxLCBjQSQxKSwgbm9ybWFsMyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9mYWNlQToge1xuICAgICAgICAgICAgcm90VmVjMihub3JtYWwzLCB4ZkEyLnEsIHRoaXMubG9jYWxOb3JtYWwpO1xuICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihwbGFuZVBvaW50JDIsIHhmQTIsIHRoaXMubG9jYWxQb2ludCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucG9pbnRDb3VudDsgKytpKSB7XG4gICAgICAgICAgICAgIHZhciBtYW5pZm9sZFBvaW50ID0gdGhpcy5wb2ludHNbaV07XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIoY2xpcFBvaW50JDEsIHhmQjIsIG1hbmlmb2xkUG9pbnQubG9jYWxQb2ludCk7XG4gICAgICAgICAgICAgIGNvbWJpbmUyVmVjMihjQSQxLCAxLCBjbGlwUG9pbnQkMSwgcmFkaXVzQSAtIGRvdFZlYzIoc3ViVmVjMih0ZW1wJDMsIGNsaXBQb2ludCQxLCBwbGFuZVBvaW50JDIpLCBub3JtYWwzKSwgbm9ybWFsMyk7XG4gICAgICAgICAgICAgIGNvbWJpbmUyVmVjMihjQiQxLCAxLCBjbGlwUG9pbnQkMSwgLXJhZGl1c0IsIG5vcm1hbDMpO1xuICAgICAgICAgICAgICBjb21iaW5lMlZlYzIocG9pbnRzW2ldLCAwLjUsIGNBJDEsIDAuNSwgY0IkMSk7XG4gICAgICAgICAgICAgIHNlcGFyYXRpb25zW2ldID0gZG90VmVjMihzdWJWZWMyKHRlbXAkMywgY0IkMSwgY0EkMSksIG5vcm1hbDMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhc2UgZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUI6IHtcbiAgICAgICAgICAgIHJvdFZlYzIobm9ybWFsMywgeGZCMi5xLCB0aGlzLmxvY2FsTm9ybWFsKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocGxhbmVQb2ludCQyLCB4ZkIyLCB0aGlzLmxvY2FsUG9pbnQpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBvaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgICB2YXIgbWFuaWZvbGRQb2ludCA9IHRoaXMucG9pbnRzW2ldO1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKGNsaXBQb2ludCQxLCB4ZkEyLCBtYW5pZm9sZFBvaW50LmxvY2FsUG9pbnQpO1xuICAgICAgICAgICAgICBjb21iaW5lMlZlYzIoY0IkMSwgMSwgY2xpcFBvaW50JDEsIHJhZGl1c0IgLSBkb3RWZWMyKHN1YlZlYzIodGVtcCQzLCBjbGlwUG9pbnQkMSwgcGxhbmVQb2ludCQyKSwgbm9ybWFsMyksIG5vcm1hbDMpO1xuICAgICAgICAgICAgICBjb21iaW5lMlZlYzIoY0EkMSwgMSwgY2xpcFBvaW50JDEsIC1yYWRpdXNBLCBub3JtYWwzKTtcbiAgICAgICAgICAgICAgY29tYmluZTJWZWMyKHBvaW50c1tpXSwgMC41LCBjQSQxLCAwLjUsIGNCJDEpO1xuICAgICAgICAgICAgICBzZXBhcmF0aW9uc1tpXSA9IGRvdFZlYzIoc3ViVmVjMih0ZW1wJDMsIGNBJDEsIGNCJDEpLCBub3JtYWwzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5lZ1ZlYzIobm9ybWFsMyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHdtO1xuICAgICAgfTtcbiAgICAgIE1hbmlmb2xkMi5jbGlwU2VnbWVudFRvTGluZSA9IGNsaXBTZWdtZW50VG9MaW5lO1xuICAgICAgTWFuaWZvbGQyLkNsaXBWZXJ0ZXggPSBDbGlwVmVydGV4O1xuICAgICAgTWFuaWZvbGQyLmdldFBvaW50U3RhdGVzID0gZ2V0UG9pbnRTdGF0ZXM7XG4gICAgICBNYW5pZm9sZDIuUG9pbnRTdGF0ZSA9IGV4cG9ydHMyLlBvaW50U3RhdGU7XG4gICAgICByZXR1cm4gTWFuaWZvbGQyO1xuICAgIH0oKVxuICApO1xuICB2YXIgTWFuaWZvbGRQb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBNYW5pZm9sZFBvaW50MigpIHtcbiAgICAgICAgdGhpcy5sb2NhbFBvaW50ID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5ub3JtYWxJbXB1bHNlID0gMDtcbiAgICAgICAgdGhpcy50YW5nZW50SW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMuaWQgPSBuZXcgQ29udGFjdElEKCk7XG4gICAgICB9XG4gICAgICBNYW5pZm9sZFBvaW50Mi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24odGhhdCkge1xuICAgICAgICBjb3B5VmVjMih0aGlzLmxvY2FsUG9pbnQsIHRoYXQubG9jYWxQb2ludCk7XG4gICAgICAgIHRoaXMubm9ybWFsSW1wdWxzZSA9IHRoYXQubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgdGhpcy50YW5nZW50SW1wdWxzZSA9IHRoYXQudGFuZ2VudEltcHVsc2U7XG4gICAgICAgIHRoaXMuaWQuc2V0KHRoYXQuaWQpO1xuICAgICAgfTtcbiAgICAgIE1hbmlmb2xkUG9pbnQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHplcm9WZWMyKHRoaXMubG9jYWxQb2ludCk7XG4gICAgICAgIHRoaXMubm9ybWFsSW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMudGFuZ2VudEltcHVsc2UgPSAwO1xuICAgICAgICB0aGlzLmlkLnJlY3ljbGUoKTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gTWFuaWZvbGRQb2ludDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBDb250YWN0SUQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gQ29udGFjdElEMigpIHtcbiAgICAgICAgdGhpcy5rZXkgPSAtMTtcbiAgICAgICAgdGhpcy5pbmRleEEgPSAtMTtcbiAgICAgICAgdGhpcy5pbmRleEIgPSAtMTtcbiAgICAgICAgdGhpcy50eXBlQSA9IGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLnR5cGVCID0gZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdW5zZXQ7XG4gICAgICB9XG4gICAgICBDb250YWN0SUQyLnByb3RvdHlwZS5zZXRGZWF0dXJlcyA9IGZ1bmN0aW9uKGluZGV4QSwgdHlwZUEsIGluZGV4QiwgdHlwZUIpIHtcbiAgICAgICAgdGhpcy5pbmRleEEgPSBpbmRleEE7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gaW5kZXhCO1xuICAgICAgICB0aGlzLnR5cGVBID0gdHlwZUE7XG4gICAgICAgIHRoaXMudHlwZUIgPSB0eXBlQjtcbiAgICAgICAgdGhpcy5rZXkgPSB0aGlzLmluZGV4QSArIHRoaXMuaW5kZXhCICogNCArIHRoaXMudHlwZUEgKiAxNiArIHRoaXMudHlwZUIgKiA2NDtcbiAgICAgIH07XG4gICAgICBDb250YWN0SUQyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih0aGF0KSB7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gdGhhdC5pbmRleEE7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gdGhhdC5pbmRleEI7XG4gICAgICAgIHRoaXMudHlwZUEgPSB0aGF0LnR5cGVBO1xuICAgICAgICB0aGlzLnR5cGVCID0gdGhhdC50eXBlQjtcbiAgICAgICAgdGhpcy5rZXkgPSB0aGlzLmluZGV4QSArIHRoaXMuaW5kZXhCICogNCArIHRoaXMudHlwZUEgKiAxNiArIHRoaXMudHlwZUIgKiA2NDtcbiAgICAgIH07XG4gICAgICBDb250YWN0SUQyLnByb3RvdHlwZS5zd2FwRmVhdHVyZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGluZGV4QSA9IHRoaXMuaW5kZXhBO1xuICAgICAgICB2YXIgaW5kZXhCID0gdGhpcy5pbmRleEI7XG4gICAgICAgIHZhciB0eXBlQSA9IHRoaXMudHlwZUE7XG4gICAgICAgIHZhciB0eXBlQiA9IHRoaXMudHlwZUI7XG4gICAgICAgIHRoaXMuaW5kZXhBID0gaW5kZXhCO1xuICAgICAgICB0aGlzLmluZGV4QiA9IGluZGV4QTtcbiAgICAgICAgdGhpcy50eXBlQSA9IHR5cGVCO1xuICAgICAgICB0aGlzLnR5cGVCID0gdHlwZUE7XG4gICAgICAgIHRoaXMua2V5ID0gdGhpcy5pbmRleEEgKyB0aGlzLmluZGV4QiAqIDQgKyB0aGlzLnR5cGVBICogMTYgKyB0aGlzLnR5cGVCICogNjQ7XG4gICAgICB9O1xuICAgICAgQ29udGFjdElEMi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmluZGV4QSA9IDA7XG4gICAgICAgIHRoaXMuaW5kZXhCID0gMDtcbiAgICAgICAgdGhpcy50eXBlQSA9IGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3Vuc2V0O1xuICAgICAgICB0aGlzLnR5cGVCID0gZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdW5zZXQ7XG4gICAgICAgIHRoaXMua2V5ID0gLTE7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIENvbnRhY3RJRDI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBXb3JsZE1hbmlmb2xkID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFdvcmxkTWFuaWZvbGQyKCkge1xuICAgICAgICB0aGlzLm5vcm1hbCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMucG9pbnRzID0gW3ZlYzIoMCwgMCksIHZlYzIoMCwgMCldO1xuICAgICAgICB0aGlzLnNlcGFyYXRpb25zID0gWzAsIDBdO1xuICAgICAgICB0aGlzLnBvaW50Q291bnQgPSAwO1xuICAgICAgfVxuICAgICAgV29ybGRNYW5pZm9sZDIucHJvdG90eXBlLnJlY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5ub3JtYWwpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBvaW50c1swXSk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMucG9pbnRzWzFdKTtcbiAgICAgICAgdGhpcy5zZXBhcmF0aW9uc1swXSA9IDA7XG4gICAgICAgIHRoaXMuc2VwYXJhdGlvbnNbMV0gPSAwO1xuICAgICAgICB0aGlzLnBvaW50Q291bnQgPSAwO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBXb3JsZE1hbmlmb2xkMjtcbiAgICB9KClcbiAgKTtcbiAgZnVuY3Rpb24gZ2V0UG9pbnRTdGF0ZXMoc3RhdGUxLCBzdGF0ZTIsIG1hbmlmb2xkMSwgbWFuaWZvbGQyKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYW5pZm9sZDEucG9pbnRDb3VudDsgKytpKSB7XG4gICAgICB2YXIgaWQgPSBtYW5pZm9sZDEucG9pbnRzW2ldLmlkO1xuICAgICAgc3RhdGUxW2ldID0gZXhwb3J0czIuUG9pbnRTdGF0ZS5yZW1vdmVTdGF0ZTtcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbWFuaWZvbGQyLnBvaW50Q291bnQ7ICsraikge1xuICAgICAgICBpZiAobWFuaWZvbGQyLnBvaW50c1tqXS5pZC5rZXkgPT09IGlkLmtleSkge1xuICAgICAgICAgIHN0YXRlMVtpXSA9IGV4cG9ydHMyLlBvaW50U3RhdGUucGVyc2lzdFN0YXRlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFuaWZvbGQyLnBvaW50Q291bnQ7ICsraSkge1xuICAgICAgdmFyIGlkID0gbWFuaWZvbGQyLnBvaW50c1tpXS5pZDtcbiAgICAgIHN0YXRlMltpXSA9IGV4cG9ydHMyLlBvaW50U3RhdGUuYWRkU3RhdGU7XG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1hbmlmb2xkMS5wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgaWYgKG1hbmlmb2xkMS5wb2ludHNbal0uaWQua2V5ID09PSBpZC5rZXkpIHtcbiAgICAgICAgICBzdGF0ZTJbaV0gPSBleHBvcnRzMi5Qb2ludFN0YXRlLnBlcnNpc3RTdGF0ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBjbGlwU2VnbWVudFRvTGluZSh2T3V0LCB2SW4sIG5vcm1hbDMsIG9mZnNldCwgdmVydGV4SW5kZXhBKSB7XG4gICAgdmFyIG51bU91dCA9IDA7XG4gICAgdmFyIGRpc3RhbmNlMCA9IGRvdFZlYzIobm9ybWFsMywgdkluWzBdLnYpIC0gb2Zmc2V0O1xuICAgIHZhciBkaXN0YW5jZTEgPSBkb3RWZWMyKG5vcm1hbDMsIHZJblsxXS52KSAtIG9mZnNldDtcbiAgICBpZiAoZGlzdGFuY2UwIDw9IDApXG4gICAgICB2T3V0W251bU91dCsrXS5zZXQodkluWzBdKTtcbiAgICBpZiAoZGlzdGFuY2UxIDw9IDApXG4gICAgICB2T3V0W251bU91dCsrXS5zZXQodkluWzFdKTtcbiAgICBpZiAoZGlzdGFuY2UwICogZGlzdGFuY2UxIDwgMCkge1xuICAgICAgdmFyIGludGVycCA9IGRpc3RhbmNlMCAvIChkaXN0YW5jZTAgLSBkaXN0YW5jZTEpO1xuICAgICAgY29tYmluZTJWZWMyKHZPdXRbbnVtT3V0XS52LCAxIC0gaW50ZXJwLCB2SW5bMF0udiwgaW50ZXJwLCB2SW5bMV0udik7XG4gICAgICB2T3V0W251bU91dF0uaWQuc2V0RmVhdHVyZXModmVydGV4SW5kZXhBLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIHZJblswXS5pZC5pbmRleEIsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UpO1xuICAgICAgKytudW1PdXQ7XG4gICAgfVxuICAgIHJldHVybiBudW1PdXQ7XG4gIH1cbiAgdmFyIG1hdGhfc3FydCQxID0gTWF0aC5zcXJ0O1xuICB2YXIgbWF0aF9tYXgkMiA9IE1hdGgubWF4O1xuICB2YXIgbWF0aF9taW4kNCA9IE1hdGgubWluO1xuICB2YXIgY29udGFjdFBvb2wgPSBuZXcgUG9vbCh7XG4gICAgY3JlYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBuZXcgQ29udGFjdCgpO1xuICAgIH0sXG4gICAgcmVsZWFzZTogZnVuY3Rpb24oY29udGFjdCkge1xuICAgICAgY29udGFjdC5yZWN5Y2xlKCk7XG4gICAgfVxuICB9KTtcbiAgdmFyIG9sZE1hbmlmb2xkID0gbmV3IE1hbmlmb2xkKCk7XG4gIHZhciB3b3JsZE1hbmlmb2xkID0gbmV3IFdvcmxkTWFuaWZvbGQoKTtcbiAgdmFyIENvbnRhY3RFZGdlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIENvbnRhY3RFZGdlMihjb250YWN0KSB7XG4gICAgICAgIHRoaXMucHJldiA9IG51bGw7XG4gICAgICAgIHRoaXMubmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMub3RoZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmNvbnRhY3QgPSBjb250YWN0O1xuICAgICAgfVxuICAgICAgQ29udGFjdEVkZ2UyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucHJldiA9IG51bGw7XG4gICAgICAgIHRoaXMubmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMub3RoZXIgPSBudWxsO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBDb250YWN0RWRnZTI7XG4gICAgfSgpXG4gICk7XG4gIGZ1bmN0aW9uIG1peEZyaWN0aW9uKGZyaWN0aW9uMSwgZnJpY3Rpb24yKSB7XG4gICAgcmV0dXJuIG1hdGhfc3FydCQxKGZyaWN0aW9uMSAqIGZyaWN0aW9uMik7XG4gIH1cbiAgZnVuY3Rpb24gbWl4UmVzdGl0dXRpb24ocmVzdGl0dXRpb24xLCByZXN0aXR1dGlvbjIpIHtcbiAgICByZXR1cm4gcmVzdGl0dXRpb24xID4gcmVzdGl0dXRpb24yID8gcmVzdGl0dXRpb24xIDogcmVzdGl0dXRpb24yO1xuICB9XG4gIHZhciBzX3JlZ2lzdGVycyA9IFtdO1xuICB2YXIgVmVsb2NpdHlDb25zdHJhaW50UG9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVmVsb2NpdHlDb25zdHJhaW50UG9pbnQyKCkge1xuICAgICAgICB0aGlzLnJBID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5yQiA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMubm9ybWFsSW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMudGFuZ2VudEltcHVsc2UgPSAwO1xuICAgICAgICB0aGlzLm5vcm1hbE1hc3MgPSAwO1xuICAgICAgICB0aGlzLnRhbmdlbnRNYXNzID0gMDtcbiAgICAgICAgdGhpcy52ZWxvY2l0eUJpYXMgPSAwO1xuICAgICAgfVxuICAgICAgVmVsb2NpdHlDb25zdHJhaW50UG9pbnQyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHplcm9WZWMyKHRoaXMuckEpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnJCKTtcbiAgICAgICAgdGhpcy5ub3JtYWxJbXB1bHNlID0gMDtcbiAgICAgICAgdGhpcy50YW5nZW50SW1wdWxzZSA9IDA7XG4gICAgICAgIHRoaXMubm9ybWFsTWFzcyA9IDA7XG4gICAgICAgIHRoaXMudGFuZ2VudE1hc3MgPSAwO1xuICAgICAgICB0aGlzLnZlbG9jaXR5QmlhcyA9IDA7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFZlbG9jaXR5Q29uc3RyYWludFBvaW50MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIGNBID0gdmVjMigwLCAwKTtcbiAgdmFyIHZBID0gdmVjMigwLCAwKTtcbiAgdmFyIGNCID0gdmVjMigwLCAwKTtcbiAgdmFyIHZCID0gdmVjMigwLCAwKTtcbiAgdmFyIHRhbmdlbnQkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciB4ZkEgPSB0cmFuc2Zvcm0oMCwgMCwgMCk7XG4gIHZhciB4ZkIgPSB0cmFuc2Zvcm0oMCwgMCwgMCk7XG4gIHZhciBwb2ludEEgPSB2ZWMyKDAsIDApO1xuICB2YXIgcG9pbnRCID0gdmVjMigwLCAwKTtcbiAgdmFyIGNsaXBQb2ludCA9IHZlYzIoMCwgMCk7XG4gIHZhciBwbGFuZVBvaW50JDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgckEgPSB2ZWMyKDAsIDApO1xuICB2YXIgckIgPSB2ZWMyKDAsIDApO1xuICB2YXIgUCQxID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbCQyID0gdmVjMigwLCAwKTtcbiAgdmFyIHBvaW50ID0gdmVjMigwLCAwKTtcbiAgdmFyIGR2ID0gdmVjMigwLCAwKTtcbiAgdmFyIGR2MSA9IHZlYzIoMCwgMCk7XG4gIHZhciBkdjIgPSB2ZWMyKDAsIDApO1xuICB2YXIgYiA9IHZlYzIoMCwgMCk7XG4gIHZhciBhID0gdmVjMigwLCAwKTtcbiAgdmFyIHggPSB2ZWMyKDAsIDApO1xuICB2YXIgZCA9IHZlYzIoMCwgMCk7XG4gIHZhciBQMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBQMiA9IHZlYzIoMCwgMCk7XG4gIHZhciB0ZW1wJDIgPSB2ZWMyKDAsIDApO1xuICB2YXIgQ29udGFjdCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBDb250YWN0MigpIHtcbiAgICAgICAgdGhpcy5tX25vZGVBID0gbmV3IENvbnRhY3RFZGdlKHRoaXMpO1xuICAgICAgICB0aGlzLm1fbm9kZUIgPSBuZXcgQ29udGFjdEVkZ2UodGhpcyk7XG4gICAgICAgIHRoaXMubV9maXh0dXJlQSA9IG51bGw7XG4gICAgICAgIHRoaXMubV9maXh0dXJlQiA9IG51bGw7XG4gICAgICAgIHRoaXMubV9pbmRleEEgPSAtMTtcbiAgICAgICAgdGhpcy5tX2luZGV4QiA9IC0xO1xuICAgICAgICB0aGlzLm1fZXZhbHVhdGVGY24gPSBudWxsO1xuICAgICAgICB0aGlzLm1fbWFuaWZvbGQgPSBuZXcgTWFuaWZvbGQoKTtcbiAgICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV90b2kgPSAxO1xuICAgICAgICB0aGlzLm1fdG9pQ291bnQgPSAwO1xuICAgICAgICB0aGlzLm1fdG9pRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fZnJpY3Rpb24gPSAwO1xuICAgICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSAwO1xuICAgICAgICB0aGlzLm1fdGFuZ2VudFNwZWVkID0gMDtcbiAgICAgICAgdGhpcy5tX2VuYWJsZWRGbGFnID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX3RvdWNoaW5nRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fZmlsdGVyRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fYnVsbGV0SGl0RmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1faW1wdWxzZSA9IG5ldyBDb250YWN0SW1wdWxzZSh0aGlzKTtcbiAgICAgICAgdGhpcy52X3BvaW50cyA9IFtuZXcgVmVsb2NpdHlDb25zdHJhaW50UG9pbnQoKSwgbmV3IFZlbG9jaXR5Q29uc3RyYWludFBvaW50KCldO1xuICAgICAgICB0aGlzLnZfbm9ybWFsID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy52X25vcm1hbE1hc3MgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgdGhpcy52X0sgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgdGhpcy52X3BvaW50Q291bnQgPSAwO1xuICAgICAgICB0aGlzLnZfdGFuZ2VudFNwZWVkID0gMDtcbiAgICAgICAgdGhpcy52X2ZyaWN0aW9uID0gMDtcbiAgICAgICAgdGhpcy52X3Jlc3RpdHV0aW9uID0gMDtcbiAgICAgICAgdGhpcy52X2ludk1hc3NBID0gMDtcbiAgICAgICAgdGhpcy52X2ludk1hc3NCID0gMDtcbiAgICAgICAgdGhpcy52X2ludklBID0gMDtcbiAgICAgICAgdGhpcy52X2ludklCID0gMDtcbiAgICAgICAgdGhpcy5wX2xvY2FsUG9pbnRzID0gW3ZlYzIoMCwgMCksIHZlYzIoMCwgMCldO1xuICAgICAgICB0aGlzLnBfbG9jYWxOb3JtYWwgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnBfbG9jYWxQb2ludCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMucF9sb2NhbENlbnRlckEgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnBfbG9jYWxDZW50ZXJCID0gdmVjMigwLCAwKTtcbiAgICAgICAgdGhpcy5wX3R5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV91bnNldDtcbiAgICAgICAgdGhpcy5wX3JhZGl1c0EgPSAwO1xuICAgICAgICB0aGlzLnBfcmFkaXVzQiA9IDA7XG4gICAgICAgIHRoaXMucF9wb2ludENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5wX2ludk1hc3NBID0gMDtcbiAgICAgICAgdGhpcy5wX2ludk1hc3NCID0gMDtcbiAgICAgICAgdGhpcy5wX2ludklBID0gMDtcbiAgICAgICAgdGhpcy5wX2ludklCID0gMDtcbiAgICAgIH1cbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24oZkEsIGluZGV4QSwgZkIsIGluZGV4QiwgZXZhbHVhdGVGY24pIHtcbiAgICAgICAgdGhpcy5tX2ZpeHR1cmVBID0gZkE7XG4gICAgICAgIHRoaXMubV9maXh0dXJlQiA9IGZCO1xuICAgICAgICB0aGlzLm1faW5kZXhBID0gaW5kZXhBO1xuICAgICAgICB0aGlzLm1faW5kZXhCID0gaW5kZXhCO1xuICAgICAgICB0aGlzLm1fZXZhbHVhdGVGY24gPSBldmFsdWF0ZUZjbjtcbiAgICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gbWl4RnJpY3Rpb24odGhpcy5tX2ZpeHR1cmVBLm1fZnJpY3Rpb24sIHRoaXMubV9maXh0dXJlQi5tX2ZyaWN0aW9uKTtcbiAgICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gbWl4UmVzdGl0dXRpb24odGhpcy5tX2ZpeHR1cmVBLm1fcmVzdGl0dXRpb24sIHRoaXMubV9maXh0dXJlQi5tX3Jlc3RpdHV0aW9uKTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUucmVjeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1fbm9kZUEucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLm1fbm9kZUIucmVjeWNsZSgpO1xuICAgICAgICB0aGlzLm1fZml4dHVyZUEgPSBudWxsO1xuICAgICAgICB0aGlzLm1fZml4dHVyZUIgPSBudWxsO1xuICAgICAgICB0aGlzLm1faW5kZXhBID0gLTE7XG4gICAgICAgIHRoaXMubV9pbmRleEIgPSAtMTtcbiAgICAgICAgdGhpcy5tX2V2YWx1YXRlRmNuID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX21hbmlmb2xkLnJlY3ljbGUoKTtcbiAgICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xuICAgICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMubV90b2kgPSAxO1xuICAgICAgICB0aGlzLm1fdG9pQ291bnQgPSAwO1xuICAgICAgICB0aGlzLm1fdG9pRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fZnJpY3Rpb24gPSAwO1xuICAgICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSAwO1xuICAgICAgICB0aGlzLm1fdGFuZ2VudFNwZWVkID0gMDtcbiAgICAgICAgdGhpcy5tX2VuYWJsZWRGbGFnID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX3RvdWNoaW5nRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fZmlsdGVyRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fYnVsbGV0SGl0RmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1faW1wdWxzZS5yZWN5Y2xlKCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EyID0gdGhpcy52X3BvaW50czsgX2kgPCBfYTIubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgdmFyIHBvaW50XzEgPSBfYTJbX2ldO1xuICAgICAgICAgIHBvaW50XzEucmVjeWNsZSgpO1xuICAgICAgICB9XG4gICAgICAgIHplcm9WZWMyKHRoaXMudl9ub3JtYWwpO1xuICAgICAgICB0aGlzLnZfbm9ybWFsTWFzcy5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMudl9LLnNldFplcm8oKTtcbiAgICAgICAgdGhpcy52X3BvaW50Q291bnQgPSAwO1xuICAgICAgICB0aGlzLnZfdGFuZ2VudFNwZWVkID0gMDtcbiAgICAgICAgdGhpcy52X2ZyaWN0aW9uID0gMDtcbiAgICAgICAgdGhpcy52X3Jlc3RpdHV0aW9uID0gMDtcbiAgICAgICAgdGhpcy52X2ludk1hc3NBID0gMDtcbiAgICAgICAgdGhpcy52X2ludk1hc3NCID0gMDtcbiAgICAgICAgdGhpcy52X2ludklBID0gMDtcbiAgICAgICAgdGhpcy52X2ludklCID0gMDtcbiAgICAgICAgZm9yICh2YXIgX2IgPSAwLCBfYyA9IHRoaXMucF9sb2NhbFBvaW50czsgX2IgPCBfYy5sZW5ndGg7IF9iKyspIHtcbiAgICAgICAgICB2YXIgcG9pbnRfMiA9IF9jW19iXTtcbiAgICAgICAgICB6ZXJvVmVjMihwb2ludF8yKTtcbiAgICAgICAgfVxuICAgICAgICB6ZXJvVmVjMih0aGlzLnBfbG9jYWxOb3JtYWwpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBfbG9jYWxQb2ludCk7XG4gICAgICAgIHplcm9WZWMyKHRoaXMucF9sb2NhbENlbnRlckEpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnBfbG9jYWxDZW50ZXJCKTtcbiAgICAgICAgdGhpcy5wX3R5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV91bnNldDtcbiAgICAgICAgdGhpcy5wX3JhZGl1c0EgPSAwO1xuICAgICAgICB0aGlzLnBfcmFkaXVzQiA9IDA7XG4gICAgICAgIHRoaXMucF9wb2ludENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5wX2ludk1hc3NBID0gMDtcbiAgICAgICAgdGhpcy5wX2ludk1hc3NCID0gMDtcbiAgICAgICAgdGhpcy5wX2ludklBID0gMDtcbiAgICAgICAgdGhpcy5wX2ludklCID0gMDtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuaW5pdENvbnN0cmFpbnQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgaWYgKGJvZHlBID09PSBudWxsIHx8IGJvZHlCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHNoYXBlQSA9IGZpeHR1cmVBLm1fc2hhcGU7XG4gICAgICAgIHZhciBzaGFwZUIgPSBmaXh0dXJlQi5tX3NoYXBlO1xuICAgICAgICBpZiAoc2hhcGVBID09PSBudWxsIHx8IHNoYXBlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBtYW5pZm9sZCA9IHRoaXMubV9tYW5pZm9sZDtcbiAgICAgICAgdmFyIHBvaW50Q291bnQgPSBtYW5pZm9sZC5wb2ludENvdW50O1xuICAgICAgICB0aGlzLnZfaW52TWFzc0EgPSBib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMudl9pbnZNYXNzQiA9IGJvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy52X2ludklBID0gYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLnZfaW52SUIgPSBib2R5Qi5tX2ludkk7XG4gICAgICAgIHRoaXMudl9mcmljdGlvbiA9IHRoaXMubV9mcmljdGlvbjtcbiAgICAgICAgdGhpcy52X3Jlc3RpdHV0aW9uID0gdGhpcy5tX3Jlc3RpdHV0aW9uO1xuICAgICAgICB0aGlzLnZfdGFuZ2VudFNwZWVkID0gdGhpcy5tX3RhbmdlbnRTcGVlZDtcbiAgICAgICAgdGhpcy52X3BvaW50Q291bnQgPSBwb2ludENvdW50O1xuICAgICAgICB0aGlzLnZfSy5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMudl9ub3JtYWxNYXNzLnNldFplcm8oKTtcbiAgICAgICAgdGhpcy5wX2ludk1hc3NBID0gYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLnBfaW52TWFzc0IgPSBib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMucF9pbnZJQSA9IGJvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5wX2ludklCID0gYm9keUIubV9pbnZJO1xuICAgICAgICBjb3B5VmVjMih0aGlzLnBfbG9jYWxDZW50ZXJBLCBib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5wX2xvY2FsQ2VudGVyQiwgYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcik7XG4gICAgICAgIHRoaXMucF9yYWRpdXNBID0gc2hhcGVBLm1fcmFkaXVzO1xuICAgICAgICB0aGlzLnBfcmFkaXVzQiA9IHNoYXBlQi5tX3JhZGl1cztcbiAgICAgICAgdGhpcy5wX3R5cGUgPSBtYW5pZm9sZC50eXBlO1xuICAgICAgICBjb3B5VmVjMih0aGlzLnBfbG9jYWxOb3JtYWwsIG1hbmlmb2xkLmxvY2FsTm9ybWFsKTtcbiAgICAgICAgY29weVZlYzIodGhpcy5wX2xvY2FsUG9pbnQsIG1hbmlmb2xkLmxvY2FsUG9pbnQpO1xuICAgICAgICB0aGlzLnBfcG9pbnRDb3VudCA9IHBvaW50Q291bnQ7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgU2V0dGluZ3NJbnRlcm5hbC5tYXhNYW5pZm9sZFBvaW50czsgKytqKSB7XG4gICAgICAgICAgdGhpcy52X3BvaW50c1tqXS5yZWN5Y2xlKCk7XG4gICAgICAgICAgemVyb1ZlYzIodGhpcy5wX2xvY2FsUG9pbnRzW2pdKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHBvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgIHZhciBjcCA9IG1hbmlmb2xkLnBvaW50c1tqXTtcbiAgICAgICAgICB2YXIgdmNwID0gdGhpcy52X3BvaW50c1tqXTtcbiAgICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICAgIHZjcC5ub3JtYWxJbXB1bHNlID0gc3RlcC5kdFJhdGlvICogY3Aubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICAgIHZjcC50YW5nZW50SW1wdWxzZSA9IHN0ZXAuZHRSYXRpbyAqIGNwLnRhbmdlbnRJbXB1bHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb3B5VmVjMih0aGlzLnBfbG9jYWxQb2ludHNbal0sIGNwLmxvY2FsUG9pbnQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldE1hbmlmb2xkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWFuaWZvbGQ7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldFdvcmxkTWFuaWZvbGQgPSBmdW5jdGlvbih3b3JsZE1hbmlmb2xkMikge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGlmIChib2R5QSA9PT0gbnVsbCB8fCBib2R5QiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBzaGFwZUEgPSBmaXh0dXJlQS5tX3NoYXBlO1xuICAgICAgICB2YXIgc2hhcGVCID0gZml4dHVyZUIubV9zaGFwZTtcbiAgICAgICAgaWYgKHNoYXBlQSA9PT0gbnVsbCB8fCBzaGFwZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICByZXR1cm4gdGhpcy5tX21hbmlmb2xkLmdldFdvcmxkTWFuaWZvbGQod29ybGRNYW5pZm9sZDIsIGJvZHlBLmdldFRyYW5zZm9ybSgpLCBzaGFwZUEubV9yYWRpdXMsIGJvZHlCLmdldFRyYW5zZm9ybSgpLCBzaGFwZUIubV9yYWRpdXMpO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zZXRFbmFibGVkID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICB0aGlzLm1fZW5hYmxlZEZsYWcgPSAhIWZsYWc7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmlzRW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZWRGbGFnO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5pc1RvdWNoaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdG91Y2hpbmdGbGFnO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5nZXROZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0Rml4dHVyZUEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9maXh0dXJlQTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0Rml4dHVyZUIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9maXh0dXJlQjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0Q2hpbGRJbmRleEEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9pbmRleEE7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldENoaWxkSW5kZXhCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1faW5kZXhCO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5mbGFnRm9yRmlsdGVyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubV9maWx0ZXJGbGFnID0gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc2V0RnJpY3Rpb24gPSBmdW5jdGlvbihmcmljdGlvbikge1xuICAgICAgICB0aGlzLm1fZnJpY3Rpb24gPSBmcmljdGlvbjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZ2V0RnJpY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9mcmljdGlvbjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUucmVzZXRGcmljdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gbWl4RnJpY3Rpb24oZml4dHVyZUEubV9mcmljdGlvbiwgZml4dHVyZUIubV9mcmljdGlvbik7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnNldFJlc3RpdHV0aW9uID0gZnVuY3Rpb24ocmVzdGl0dXRpb24pIHtcbiAgICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gcmVzdGl0dXRpb247XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldFJlc3RpdHV0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmVzdGl0dXRpb247XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLnJlc2V0UmVzdGl0dXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IG1peFJlc3RpdHV0aW9uKGZpeHR1cmVBLm1fcmVzdGl0dXRpb24sIGZpeHR1cmVCLm1fcmVzdGl0dXRpb24pO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zZXRUYW5nZW50U3BlZWQgPSBmdW5jdGlvbihzcGVlZCkge1xuICAgICAgICB0aGlzLm1fdGFuZ2VudFNwZWVkID0gc3BlZWQ7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLmdldFRhbmdlbnRTcGVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3RhbmdlbnRTcGVlZDtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuZXZhbHVhdGUgPSBmdW5jdGlvbihtYW5pZm9sZCwgeGZBMiwgeGZCMikge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2V2YWx1YXRlRmNuKG1hbmlmb2xkLCB4ZkEyLCBmaXh0dXJlQSwgdGhpcy5tX2luZGV4QSwgeGZCMiwgZml4dHVyZUIsIHRoaXMubV9pbmRleEIpO1xuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbihsaXN0ZW5lcikge1xuICAgICAgICB2YXIgZml4dHVyZUEgPSB0aGlzLm1fZml4dHVyZUE7XG4gICAgICAgIHZhciBmaXh0dXJlQiA9IHRoaXMubV9maXh0dXJlQjtcbiAgICAgICAgaWYgKGZpeHR1cmVBID09PSBudWxsIHx8IGZpeHR1cmVCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGlmIChib2R5QSA9PT0gbnVsbCB8fCBib2R5QiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBzaGFwZUEgPSBmaXh0dXJlQS5tX3NoYXBlO1xuICAgICAgICB2YXIgc2hhcGVCID0gZml4dHVyZUIubV9zaGFwZTtcbiAgICAgICAgaWYgKHNoYXBlQSA9PT0gbnVsbCB8fCBzaGFwZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fZW5hYmxlZEZsYWcgPSB0cnVlO1xuICAgICAgICB2YXIgdG91Y2hpbmcgPSBmYWxzZTtcbiAgICAgICAgdmFyIHdhc1RvdWNoaW5nID0gdGhpcy5tX3RvdWNoaW5nRmxhZztcbiAgICAgICAgdmFyIHNlbnNvckEgPSBmaXh0dXJlQS5tX2lzU2Vuc29yO1xuICAgICAgICB2YXIgc2Vuc29yQiA9IGZpeHR1cmVCLm1faXNTZW5zb3I7XG4gICAgICAgIHZhciBzZW5zb3IgPSBzZW5zb3JBIHx8IHNlbnNvckI7XG4gICAgICAgIHZhciB4ZkEyID0gYm9keUEubV94ZjtcbiAgICAgICAgdmFyIHhmQjIgPSBib2R5Qi5tX3hmO1xuICAgICAgICBpZiAoc2Vuc29yKSB7XG4gICAgICAgICAgdG91Y2hpbmcgPSB0ZXN0T3ZlcmxhcChzaGFwZUEsIHRoaXMubV9pbmRleEEsIHNoYXBlQiwgdGhpcy5tX2luZGV4QiwgeGZBMiwgeGZCMik7XG4gICAgICAgICAgdGhpcy5tX21hbmlmb2xkLnBvaW50Q291bnQgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9sZE1hbmlmb2xkLnJlY3ljbGUoKTtcbiAgICAgICAgICBvbGRNYW5pZm9sZC5zZXQodGhpcy5tX21hbmlmb2xkKTtcbiAgICAgICAgICB0aGlzLm1fbWFuaWZvbGQucmVjeWNsZSgpO1xuICAgICAgICAgIHRoaXMuZXZhbHVhdGUodGhpcy5tX21hbmlmb2xkLCB4ZkEyLCB4ZkIyKTtcbiAgICAgICAgICB0b3VjaGluZyA9IHRoaXMubV9tYW5pZm9sZC5wb2ludENvdW50ID4gMDtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9tYW5pZm9sZC5wb2ludENvdW50OyArK2kpIHtcbiAgICAgICAgICAgIHZhciBubXAgPSB0aGlzLm1fbWFuaWZvbGQucG9pbnRzW2ldO1xuICAgICAgICAgICAgbm1wLm5vcm1hbEltcHVsc2UgPSAwO1xuICAgICAgICAgICAgbm1wLnRhbmdlbnRJbXB1bHNlID0gMDtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgb2xkTWFuaWZvbGQucG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgICAgIHZhciBvbXAgPSBvbGRNYW5pZm9sZC5wb2ludHNbal07XG4gICAgICAgICAgICAgIGlmIChvbXAuaWQua2V5ID09PSBubXAuaWQua2V5KSB7XG4gICAgICAgICAgICAgICAgbm1wLm5vcm1hbEltcHVsc2UgPSBvbXAubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICAgICAgICBubXAudGFuZ2VudEltcHVsc2UgPSBvbXAudGFuZ2VudEltcHVsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRvdWNoaW5nICE9PSB3YXNUb3VjaGluZykge1xuICAgICAgICAgICAgYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgICBib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3RvdWNoaW5nRmxhZyA9IHRvdWNoaW5nO1xuICAgICAgICB2YXIgaGFzTGlzdGVuZXIgPSB0eXBlb2YgbGlzdGVuZXIgPT09IFwib2JqZWN0XCIgJiYgbGlzdGVuZXIgIT09IG51bGw7XG4gICAgICAgIGlmICghd2FzVG91Y2hpbmcgJiYgdG91Y2hpbmcgJiYgaGFzTGlzdGVuZXIpIHtcbiAgICAgICAgICBsaXN0ZW5lci5iZWdpbkNvbnRhY3QodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdhc1RvdWNoaW5nICYmICF0b3VjaGluZyAmJiBoYXNMaXN0ZW5lcikge1xuICAgICAgICAgIGxpc3RlbmVyLmVuZENvbnRhY3QodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZW5zb3IgJiYgdG91Y2hpbmcgJiYgaGFzTGlzdGVuZXIgJiYgb2xkTWFuaWZvbGQpIHtcbiAgICAgICAgICBsaXN0ZW5lci5wcmVTb2x2ZSh0aGlzLCBvbGRNYW5pZm9sZCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zb2x2ZVBvc2l0aW9uQ29uc3RyYWludChzdGVwLCBudWxsLCBudWxsKTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRUT0kgPSBmdW5jdGlvbihzdGVwLCB0b2lBLCB0b2lCKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zb2x2ZVBvc2l0aW9uQ29uc3RyYWludChzdGVwLCB0b2lBLCB0b2lCKTtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuX3NvbHZlUG9zaXRpb25Db25zdHJhaW50ID0gZnVuY3Rpb24oc3RlcCwgdG9pQSwgdG9pQikge1xuICAgICAgICB2YXIgdG9pID0gdG9pQSAhPT0gbnVsbCAmJiB0b2lCICE9PSBudWxsID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICB2YXIgbWluU2VwYXJhdGlvbiA9IDA7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuIG1pblNlcGFyYXRpb247XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuIG1pblNlcGFyYXRpb247XG4gICAgICAgIHZhciBwb3NpdGlvbkEgPSBib2R5QS5jX3Bvc2l0aW9uO1xuICAgICAgICB2YXIgcG9zaXRpb25CID0gYm9keUIuY19wb3NpdGlvbjtcbiAgICAgICAgdmFyIGxvY2FsQ2VudGVyQSA9IHRoaXMucF9sb2NhbENlbnRlckE7XG4gICAgICAgIHZhciBsb2NhbENlbnRlckIgPSB0aGlzLnBfbG9jYWxDZW50ZXJCO1xuICAgICAgICB2YXIgbUEgPSAwO1xuICAgICAgICB2YXIgaUEgPSAwO1xuICAgICAgICBpZiAoIXRvaSB8fCBib2R5QSA9PT0gdG9pQSB8fCBib2R5QSA9PT0gdG9pQikge1xuICAgICAgICAgIG1BID0gdGhpcy5wX2ludk1hc3NBO1xuICAgICAgICAgIGlBID0gdGhpcy5wX2ludklBO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtQiA9IDA7XG4gICAgICAgIHZhciBpQiA9IDA7XG4gICAgICAgIGlmICghdG9pIHx8IGJvZHlCID09PSB0b2lBIHx8IGJvZHlCID09PSB0b2lCKSB7XG4gICAgICAgICAgbUIgPSB0aGlzLnBfaW52TWFzc0I7XG4gICAgICAgICAgaUIgPSB0aGlzLnBfaW52SUI7XG4gICAgICAgIH1cbiAgICAgICAgY29weVZlYzIoY0EsIHBvc2l0aW9uQS5jKTtcbiAgICAgICAgdmFyIGFBID0gcG9zaXRpb25BLmE7XG4gICAgICAgIGNvcHlWZWMyKGNCLCBwb3NpdGlvbkIuYyk7XG4gICAgICAgIHZhciBhQiA9IHBvc2l0aW9uQi5hO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMucF9wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICBnZXRUcmFuc2Zvcm0oeGZBLCBsb2NhbENlbnRlckEsIGNBLCBhQSk7XG4gICAgICAgICAgZ2V0VHJhbnNmb3JtKHhmQiwgbG9jYWxDZW50ZXJCLCBjQiwgYUIpO1xuICAgICAgICAgIHZhciBzZXBhcmF0aW9uID0gdm9pZCAwO1xuICAgICAgICAgIHN3aXRjaCAodGhpcy5wX3R5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfY2lyY2xlczoge1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBvaW50QSwgeGZBLCB0aGlzLnBfbG9jYWxQb2ludCk7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocG9pbnRCLCB4ZkIsIHRoaXMucF9sb2NhbFBvaW50c1swXSk7XG4gICAgICAgICAgICAgIHN1YlZlYzIobm9ybWFsJDIsIHBvaW50QiwgcG9pbnRBKTtcbiAgICAgICAgICAgICAgbm9ybWFsaXplVmVjMihub3JtYWwkMik7XG4gICAgICAgICAgICAgIGNvbWJpbmUyVmVjMihwb2ludCwgMC41LCBwb2ludEEsIDAuNSwgcG9pbnRCKTtcbiAgICAgICAgICAgICAgc2VwYXJhdGlvbiA9IGRvdFZlYzIocG9pbnRCLCBub3JtYWwkMikgLSBkb3RWZWMyKHBvaW50QSwgbm9ybWFsJDIpIC0gdGhpcy5wX3JhZGl1c0EgLSB0aGlzLnBfcmFkaXVzQjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBOiB7XG4gICAgICAgICAgICAgIHJvdFZlYzIobm9ybWFsJDIsIHhmQS5xLCB0aGlzLnBfbG9jYWxOb3JtYWwpO1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1WZWMyKHBsYW5lUG9pbnQkMSwgeGZBLCB0aGlzLnBfbG9jYWxQb2ludCk7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIoY2xpcFBvaW50LCB4ZkIsIHRoaXMucF9sb2NhbFBvaW50c1tqXSk7XG4gICAgICAgICAgICAgIHNlcGFyYXRpb24gPSBkb3RWZWMyKGNsaXBQb2ludCwgbm9ybWFsJDIpIC0gZG90VmVjMihwbGFuZVBvaW50JDEsIG5vcm1hbCQyKSAtIHRoaXMucF9yYWRpdXNBIC0gdGhpcy5wX3JhZGl1c0I7XG4gICAgICAgICAgICAgIGNvcHlWZWMyKHBvaW50LCBjbGlwUG9pbnQpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUI6IHtcbiAgICAgICAgICAgICAgcm90VmVjMihub3JtYWwkMiwgeGZCLnEsIHRoaXMucF9sb2NhbE5vcm1hbCk7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybVZlYzIocGxhbmVQb2ludCQxLCB4ZkIsIHRoaXMucF9sb2NhbFBvaW50KTtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtVmVjMihjbGlwUG9pbnQsIHhmQSwgdGhpcy5wX2xvY2FsUG9pbnRzW2pdKTtcbiAgICAgICAgICAgICAgc2VwYXJhdGlvbiA9IGRvdFZlYzIoY2xpcFBvaW50LCBub3JtYWwkMikgLSBkb3RWZWMyKHBsYW5lUG9pbnQkMSwgbm9ybWFsJDIpIC0gdGhpcy5wX3JhZGl1c0EgLSB0aGlzLnBfcmFkaXVzQjtcbiAgICAgICAgICAgICAgY29weVZlYzIocG9pbnQsIGNsaXBQb2ludCk7XG4gICAgICAgICAgICAgIG5lZ1ZlYzIobm9ybWFsJDIpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1pblNlcGFyYXRpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHN1YlZlYzIockEsIHBvaW50LCBjQSk7XG4gICAgICAgICAgc3ViVmVjMihyQiwgcG9pbnQsIGNCKTtcbiAgICAgICAgICBtaW5TZXBhcmF0aW9uID0gbWF0aF9taW4kNChtaW5TZXBhcmF0aW9uLCBzZXBhcmF0aW9uKTtcbiAgICAgICAgICB2YXIgYmF1bWdhcnRlID0gdG9pID8gU2V0dGluZ3NJbnRlcm5hbC50b2lCYXVnYXJ0ZSA6IFNldHRpbmdzSW50ZXJuYWwuYmF1bWdhcnRlO1xuICAgICAgICAgIHZhciBsaW5lYXJTbG9wID0gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgICAgIHZhciBtYXhMaW5lYXJDb3JyZWN0aW9uID0gU2V0dGluZ3NJbnRlcm5hbC5tYXhMaW5lYXJDb3JyZWN0aW9uO1xuICAgICAgICAgIHZhciBDID0gY2xhbXAoYmF1bWdhcnRlICogKHNlcGFyYXRpb24gKyBsaW5lYXJTbG9wKSwgLW1heExpbmVhckNvcnJlY3Rpb24sIDApO1xuICAgICAgICAgIHZhciBybkEgPSBjcm9zc1ZlYzJWZWMyKHJBLCBub3JtYWwkMik7XG4gICAgICAgICAgdmFyIHJuQiA9IGNyb3NzVmVjMlZlYzIockIsIG5vcm1hbCQyKTtcbiAgICAgICAgICB2YXIgSyA9IG1BICsgbUIgKyBpQSAqIHJuQSAqIHJuQSArIGlCICogcm5CICogcm5CO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gSyA+IDAgPyAtQyAvIEsgOiAwO1xuICAgICAgICAgIHNjYWxlVmVjMihQJDEsIGltcHVsc2UsIG5vcm1hbCQyKTtcbiAgICAgICAgICBtaW51c1NjYWxlVmVjMihjQSwgbUEsIFAkMSk7XG4gICAgICAgICAgYUEgLT0gaUEgKiBjcm9zc1ZlYzJWZWMyKHJBLCBQJDEpO1xuICAgICAgICAgIHBsdXNTY2FsZVZlYzIoY0IsIG1CLCBQJDEpO1xuICAgICAgICAgIGFCICs9IGlCICogY3Jvc3NWZWMyVmVjMihyQiwgUCQxKTtcbiAgICAgICAgfVxuICAgICAgICBjb3B5VmVjMihwb3NpdGlvbkEuYywgY0EpO1xuICAgICAgICBwb3NpdGlvbkEuYSA9IGFBO1xuICAgICAgICBjb3B5VmVjMihwb3NpdGlvbkIuYywgY0IpO1xuICAgICAgICBwb3NpdGlvbkIuYSA9IGFCO1xuICAgICAgICByZXR1cm4gbWluU2VwYXJhdGlvbjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludCA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgdmVsb2NpdHlBID0gYm9keUEuY192ZWxvY2l0eTtcbiAgICAgICAgdmFyIHZlbG9jaXR5QiA9IGJvZHlCLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciBwb3NpdGlvbkEgPSBib2R5QS5jX3Bvc2l0aW9uO1xuICAgICAgICB2YXIgcG9zaXRpb25CID0gYm9keUIuY19wb3NpdGlvbjtcbiAgICAgICAgdmFyIHJhZGl1c0EgPSB0aGlzLnBfcmFkaXVzQTtcbiAgICAgICAgdmFyIHJhZGl1c0IgPSB0aGlzLnBfcmFkaXVzQjtcbiAgICAgICAgdmFyIG1hbmlmb2xkID0gdGhpcy5tX21hbmlmb2xkO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLnZfaW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMudl9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy52X2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLnZfaW52SUI7XG4gICAgICAgIHZhciBsb2NhbENlbnRlckEgPSB0aGlzLnBfbG9jYWxDZW50ZXJBO1xuICAgICAgICB2YXIgbG9jYWxDZW50ZXJCID0gdGhpcy5wX2xvY2FsQ2VudGVyQjtcbiAgICAgICAgY29weVZlYzIoY0EsIHBvc2l0aW9uQS5jKTtcbiAgICAgICAgdmFyIGFBID0gcG9zaXRpb25BLmE7XG4gICAgICAgIGNvcHlWZWMyKHZBLCB2ZWxvY2l0eUEudik7XG4gICAgICAgIHZhciB3QSA9IHZlbG9jaXR5QS53O1xuICAgICAgICBjb3B5VmVjMihjQiwgcG9zaXRpb25CLmMpO1xuICAgICAgICB2YXIgYUIgPSBwb3NpdGlvbkIuYTtcbiAgICAgICAgY29weVZlYzIodkIsIHZlbG9jaXR5Qi52KTtcbiAgICAgICAgdmFyIHdCID0gdmVsb2NpdHlCLnc7XG4gICAgICAgIGdldFRyYW5zZm9ybSh4ZkEsIGxvY2FsQ2VudGVyQSwgY0EsIGFBKTtcbiAgICAgICAgZ2V0VHJhbnNmb3JtKHhmQiwgbG9jYWxDZW50ZXJCLCBjQiwgYUIpO1xuICAgICAgICB3b3JsZE1hbmlmb2xkLnJlY3ljbGUoKTtcbiAgICAgICAgbWFuaWZvbGQuZ2V0V29ybGRNYW5pZm9sZCh3b3JsZE1hbmlmb2xkLCB4ZkEsIHJhZGl1c0EsIHhmQiwgcmFkaXVzQik7XG4gICAgICAgIGNvcHlWZWMyKHRoaXMudl9ub3JtYWwsIHdvcmxkTWFuaWZvbGQubm9ybWFsKTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnZfcG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgdmFyIHZjcCA9IHRoaXMudl9wb2ludHNbal07XG4gICAgICAgICAgdmFyIHdtcCA9IHdvcmxkTWFuaWZvbGQucG9pbnRzW2pdO1xuICAgICAgICAgIHN1YlZlYzIodmNwLnJBLCB3bXAsIGNBKTtcbiAgICAgICAgICBzdWJWZWMyKHZjcC5yQiwgd21wLCBjQik7XG4gICAgICAgICAgdmFyIHJuQSA9IGNyb3NzVmVjMlZlYzIodmNwLnJBLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgICB2YXIgcm5CID0gY3Jvc3NWZWMyVmVjMih2Y3AuckIsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICAgIHZhciBrTm9ybWFsID0gbUEgKyBtQiArIGlBICogcm5BICogcm5BICsgaUIgKiBybkIgKiBybkI7XG4gICAgICAgICAgdmNwLm5vcm1hbE1hc3MgPSBrTm9ybWFsID4gMCA/IDEgLyBrTm9ybWFsIDogMDtcbiAgICAgICAgICBjcm9zc1ZlYzJOdW0odGFuZ2VudCQxLCB0aGlzLnZfbm9ybWFsLCAxKTtcbiAgICAgICAgICB2YXIgcnRBID0gY3Jvc3NWZWMyVmVjMih2Y3AuckEsIHRhbmdlbnQkMSk7XG4gICAgICAgICAgdmFyIHJ0QiA9IGNyb3NzVmVjMlZlYzIodmNwLnJCLCB0YW5nZW50JDEpO1xuICAgICAgICAgIHZhciBrVGFuZ2VudCA9IG1BICsgbUIgKyBpQSAqIHJ0QSAqIHJ0QSArIGlCICogcnRCICogcnRCO1xuICAgICAgICAgIHZjcC50YW5nZW50TWFzcyA9IGtUYW5nZW50ID4gMCA/IDEgLyBrVGFuZ2VudCA6IDA7XG4gICAgICAgICAgdmNwLnZlbG9jaXR5QmlhcyA9IDA7XG4gICAgICAgICAgdmFyIHZSZWwgPSAwO1xuICAgICAgICAgIHZSZWwgKz0gZG90VmVjMih0aGlzLnZfbm9ybWFsLCB2Qik7XG4gICAgICAgICAgdlJlbCArPSBkb3RWZWMyKHRoaXMudl9ub3JtYWwsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdCLCB2Y3AuckIpKTtcbiAgICAgICAgICB2UmVsIC09IGRvdFZlYzIodGhpcy52X25vcm1hbCwgdkEpO1xuICAgICAgICAgIHZSZWwgLT0gZG90VmVjMih0aGlzLnZfbm9ybWFsLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QSwgdmNwLnJBKSk7XG4gICAgICAgICAgaWYgKHZSZWwgPCAtU2V0dGluZ3NJbnRlcm5hbC52ZWxvY2l0eVRocmVzaG9sZCkge1xuICAgICAgICAgICAgdmNwLnZlbG9jaXR5QmlhcyA9IC10aGlzLnZfcmVzdGl0dXRpb24gKiB2UmVsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52X3BvaW50Q291bnQgPT0gMiAmJiBzdGVwLmJsb2NrU29sdmUpIHtcbiAgICAgICAgICB2YXIgdmNwMSA9IHRoaXMudl9wb2ludHNbMF07XG4gICAgICAgICAgdmFyIHZjcDIgPSB0aGlzLnZfcG9pbnRzWzFdO1xuICAgICAgICAgIHZhciBybjFBID0gY3Jvc3NWZWMyVmVjMih2Y3AxLnJBLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgICB2YXIgcm4xQiA9IGNyb3NzVmVjMlZlYzIodmNwMS5yQiwgdGhpcy52X25vcm1hbCk7XG4gICAgICAgICAgdmFyIHJuMkEgPSBjcm9zc1ZlYzJWZWMyKHZjcDIuckEsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICAgIHZhciBybjJCID0gY3Jvc3NWZWMyVmVjMih2Y3AyLnJCLCB0aGlzLnZfbm9ybWFsKTtcbiAgICAgICAgICB2YXIgazExID0gbUEgKyBtQiArIGlBICogcm4xQSAqIHJuMUEgKyBpQiAqIHJuMUIgKiBybjFCO1xuICAgICAgICAgIHZhciBrMjIgPSBtQSArIG1CICsgaUEgKiBybjJBICogcm4yQSArIGlCICogcm4yQiAqIHJuMkI7XG4gICAgICAgICAgdmFyIGsxMiA9IG1BICsgbUIgKyBpQSAqIHJuMUEgKiBybjJBICsgaUIgKiBybjFCICogcm4yQjtcbiAgICAgICAgICB2YXIga19tYXhDb25kaXRpb25OdW1iZXIgPSAxZTM7XG4gICAgICAgICAgaWYgKGsxMSAqIGsxMSA8IGtfbWF4Q29uZGl0aW9uTnVtYmVyICogKGsxMSAqIGsyMiAtIGsxMiAqIGsxMikpIHtcbiAgICAgICAgICAgIHRoaXMudl9LLmV4LnNldE51bShrMTEsIGsxMik7XG4gICAgICAgICAgICB0aGlzLnZfSy5leS5zZXROdW0oazEyLCBrMjIpO1xuICAgICAgICAgICAgdmFyIGFfMSA9IHRoaXMudl9LLmV4Lng7XG4gICAgICAgICAgICB2YXIgYl8xID0gdGhpcy52X0suZXkueDtcbiAgICAgICAgICAgIHZhciBjMiA9IHRoaXMudl9LLmV4Lnk7XG4gICAgICAgICAgICB2YXIgZF8xID0gdGhpcy52X0suZXkueTtcbiAgICAgICAgICAgIHZhciBkZXQgPSBhXzEgKiBkXzEgLSBiXzEgKiBjMjtcbiAgICAgICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICAgICAgZGV0ID0gMSAvIGRldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudl9ub3JtYWxNYXNzLmV4LnggPSBkZXQgKiBkXzE7XG4gICAgICAgICAgICB0aGlzLnZfbm9ybWFsTWFzcy5leS54ID0gLWRldCAqIGJfMTtcbiAgICAgICAgICAgIHRoaXMudl9ub3JtYWxNYXNzLmV4LnkgPSAtZGV0ICogYzI7XG4gICAgICAgICAgICB0aGlzLnZfbm9ybWFsTWFzcy5leS55ID0gZGV0ICogYV8xO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnZfcG9pbnRDb3VudCA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvcHlWZWMyKHBvc2l0aW9uQS5jLCBjQSk7XG4gICAgICAgIHBvc2l0aW9uQS5hID0gYUE7XG4gICAgICAgIGNvcHlWZWMyKHZlbG9jaXR5QS52LCB2QSk7XG4gICAgICAgIHZlbG9jaXR5QS53ID0gd0E7XG4gICAgICAgIGNvcHlWZWMyKHBvc2l0aW9uQi5jLCBjQik7XG4gICAgICAgIHBvc2l0aW9uQi5hID0gYUI7XG4gICAgICAgIGNvcHlWZWMyKHZlbG9jaXR5Qi52LCB2Qik7XG4gICAgICAgIHZlbG9jaXR5Qi53ID0gd0I7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIucHJvdG90eXBlLndhcm1TdGFydENvbnN0cmFpbnQgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHRoaXMubV9maXh0dXJlQTtcbiAgICAgICAgdmFyIGZpeHR1cmVCID0gdGhpcy5tX2ZpeHR1cmVCO1xuICAgICAgICBpZiAoZml4dHVyZUEgPT09IG51bGwgfHwgZml4dHVyZUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XG4gICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgaWYgKGJvZHlBID09PSBudWxsIHx8IGJvZHlCID09PSBudWxsKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHZlbG9jaXR5QSA9IGJvZHlBLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciB2ZWxvY2l0eUIgPSBib2R5Qi5jX3ZlbG9jaXR5O1xuICAgICAgICB2YXIgbUEgPSB0aGlzLnZfaW52TWFzc0E7XG4gICAgICAgIHZhciBpQSA9IHRoaXMudl9pbnZJQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy52X2ludk1hc3NCO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLnZfaW52SUI7XG4gICAgICAgIGNvcHlWZWMyKHZBLCB2ZWxvY2l0eUEudik7XG4gICAgICAgIHZhciB3QSA9IHZlbG9jaXR5QS53O1xuICAgICAgICBjb3B5VmVjMih2QiwgdmVsb2NpdHlCLnYpO1xuICAgICAgICB2YXIgd0IgPSB2ZWxvY2l0eUIudztcbiAgICAgICAgY29weVZlYzIobm9ybWFsJDIsIHRoaXMudl9ub3JtYWwpO1xuICAgICAgICBjcm9zc1ZlYzJOdW0odGFuZ2VudCQxLCBub3JtYWwkMiwgMSk7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy52X3BvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgIHZhciB2Y3AgPSB0aGlzLnZfcG9pbnRzW2pdO1xuICAgICAgICAgIGNvbWJpbmUyVmVjMihQJDEsIHZjcC5ub3JtYWxJbXB1bHNlLCBub3JtYWwkMiwgdmNwLnRhbmdlbnRJbXB1bHNlLCB0YW5nZW50JDEpO1xuICAgICAgICAgIHdBIC09IGlBICogY3Jvc3NWZWMyVmVjMih2Y3AuckEsIFAkMSk7XG4gICAgICAgICAgbWludXNTY2FsZVZlYzIodkEsIG1BLCBQJDEpO1xuICAgICAgICAgIHdCICs9IGlCICogY3Jvc3NWZWMyVmVjMih2Y3AuckIsIFAkMSk7XG4gICAgICAgICAgcGx1c1NjYWxlVmVjMih2QiwgbUIsIFAkMSk7XG4gICAgICAgIH1cbiAgICAgICAgY29weVZlYzIodmVsb2NpdHlBLnYsIHZBKTtcbiAgICAgICAgdmVsb2NpdHlBLncgPSB3QTtcbiAgICAgICAgY29weVZlYzIodmVsb2NpdHlCLnYsIHZCKTtcbiAgICAgICAgdmVsb2NpdHlCLncgPSB3QjtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5wcm90b3R5cGUuc3RvcmVDb25zdHJhaW50SW1wdWxzZXMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBtYW5pZm9sZCA9IHRoaXMubV9tYW5pZm9sZDtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnZfcG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgbWFuaWZvbGQucG9pbnRzW2pdLm5vcm1hbEltcHVsc2UgPSB0aGlzLnZfcG9pbnRzW2pdLm5vcm1hbEltcHVsc2U7XG4gICAgICAgICAgbWFuaWZvbGQucG9pbnRzW2pdLnRhbmdlbnRJbXB1bHNlID0gdGhpcy52X3BvaW50c1tqXS50YW5nZW50SW1wdWxzZTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIENvbnRhY3QyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludCA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gdGhpcy5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSB0aGlzLm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgdmVsb2NpdHlBID0gYm9keUEuY192ZWxvY2l0eTtcbiAgICAgICAgdmFyIHZlbG9jaXR5QiA9IGJvZHlCLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMudl9pbnZNYXNzQTtcbiAgICAgICAgdmFyIGlBID0gdGhpcy52X2ludklBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLnZfaW52TWFzc0I7XG4gICAgICAgIHZhciBpQiA9IHRoaXMudl9pbnZJQjtcbiAgICAgICAgY29weVZlYzIodkEsIHZlbG9jaXR5QS52KTtcbiAgICAgICAgdmFyIHdBID0gdmVsb2NpdHlBLnc7XG4gICAgICAgIGNvcHlWZWMyKHZCLCB2ZWxvY2l0eUIudik7XG4gICAgICAgIHZhciB3QiA9IHZlbG9jaXR5Qi53O1xuICAgICAgICBjb3B5VmVjMihub3JtYWwkMiwgdGhpcy52X25vcm1hbCk7XG4gICAgICAgIGNyb3NzVmVjMk51bSh0YW5nZW50JDEsIG5vcm1hbCQyLCAxKTtcbiAgICAgICAgdmFyIGZyaWN0aW9uID0gdGhpcy52X2ZyaWN0aW9uO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMudl9wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICB2YXIgdmNwID0gdGhpcy52X3BvaW50c1tqXTtcbiAgICAgICAgICB6ZXJvVmVjMihkdik7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYsIHZCKTtcbiAgICAgICAgICBwbHVzVmVjMihkdiwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0IsIHZjcC5yQikpO1xuICAgICAgICAgIG1pbnVzVmVjMihkdiwgdkEpO1xuICAgICAgICAgIG1pbnVzVmVjMihkdiwgY3Jvc3NOdW1WZWMyKHRlbXAkMiwgd0EsIHZjcC5yQSkpO1xuICAgICAgICAgIHZhciB2dCA9IGRvdFZlYzIoZHYsIHRhbmdlbnQkMSkgLSB0aGlzLnZfdGFuZ2VudFNwZWVkO1xuICAgICAgICAgIHZhciBsYW1iZGEgPSB2Y3AudGFuZ2VudE1hc3MgKiAtdnQ7XG4gICAgICAgICAgdmFyIG1heEZyaWN0aW9uID0gZnJpY3Rpb24gKiB2Y3Aubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICB2YXIgbmV3SW1wdWxzZSA9IGNsYW1wKHZjcC50YW5nZW50SW1wdWxzZSArIGxhbWJkYSwgLW1heEZyaWN0aW9uLCBtYXhGcmljdGlvbik7XG4gICAgICAgICAgbGFtYmRhID0gbmV3SW1wdWxzZSAtIHZjcC50YW5nZW50SW1wdWxzZTtcbiAgICAgICAgICB2Y3AudGFuZ2VudEltcHVsc2UgPSBuZXdJbXB1bHNlO1xuICAgICAgICAgIHNjYWxlVmVjMihQJDEsIGxhbWJkYSwgdGFuZ2VudCQxKTtcbiAgICAgICAgICBtaW51c1NjYWxlVmVjMih2QSwgbUEsIFAkMSk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBjcm9zc1ZlYzJWZWMyKHZjcC5yQSwgUCQxKTtcbiAgICAgICAgICBwbHVzU2NhbGVWZWMyKHZCLCBtQiwgUCQxKTtcbiAgICAgICAgICB3QiArPSBpQiAqIGNyb3NzVmVjMlZlYzIodmNwLnJCLCBQJDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZfcG9pbnRDb3VudCA9PSAxIHx8IHN0ZXAuYmxvY2tTb2x2ZSA9PSBmYWxzZSkge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy52X3BvaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIHZjcCA9IHRoaXMudl9wb2ludHNbaV07XG4gICAgICAgICAgICB6ZXJvVmVjMihkdik7XG4gICAgICAgICAgICBwbHVzVmVjMihkdiwgdkIpO1xuICAgICAgICAgICAgcGx1c1ZlYzIoZHYsIGNyb3NzTnVtVmVjMih0ZW1wJDIsIHdCLCB2Y3AuckIpKTtcbiAgICAgICAgICAgIG1pbnVzVmVjMihkdiwgdkEpO1xuICAgICAgICAgICAgbWludXNWZWMyKGR2LCBjcm9zc051bVZlYzIodGVtcCQyLCB3QSwgdmNwLnJBKSk7XG4gICAgICAgICAgICB2YXIgdm4gPSBkb3RWZWMyKGR2LCBub3JtYWwkMik7XG4gICAgICAgICAgICB2YXIgbGFtYmRhID0gLXZjcC5ub3JtYWxNYXNzICogKHZuIC0gdmNwLnZlbG9jaXR5Qmlhcyk7XG4gICAgICAgICAgICB2YXIgbmV3SW1wdWxzZSA9IG1hdGhfbWF4JDIodmNwLm5vcm1hbEltcHVsc2UgKyBsYW1iZGEsIDApO1xuICAgICAgICAgICAgbGFtYmRhID0gbmV3SW1wdWxzZSAtIHZjcC5ub3JtYWxJbXB1bHNlO1xuICAgICAgICAgICAgdmNwLm5vcm1hbEltcHVsc2UgPSBuZXdJbXB1bHNlO1xuICAgICAgICAgICAgc2NhbGVWZWMyKFAkMSwgbGFtYmRhLCBub3JtYWwkMik7XG4gICAgICAgICAgICBtaW51c1NjYWxlVmVjMih2QSwgbUEsIFAkMSk7XG4gICAgICAgICAgICB3QSAtPSBpQSAqIGNyb3NzVmVjMlZlYzIodmNwLnJBLCBQJDEpO1xuICAgICAgICAgICAgcGx1c1NjYWxlVmVjMih2QiwgbUIsIFAkMSk7XG4gICAgICAgICAgICB3QiArPSBpQiAqIGNyb3NzVmVjMlZlYzIodmNwLnJCLCBQJDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgdmNwMSA9IHRoaXMudl9wb2ludHNbMF07XG4gICAgICAgICAgdmFyIHZjcDIgPSB0aGlzLnZfcG9pbnRzWzFdO1xuICAgICAgICAgIHNldFZlYzIoYSwgdmNwMS5ub3JtYWxJbXB1bHNlLCB2Y3AyLm5vcm1hbEltcHVsc2UpO1xuICAgICAgICAgIHplcm9WZWMyKGR2MSk7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYxLCB2Qik7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYxLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QiwgdmNwMS5yQikpO1xuICAgICAgICAgIG1pbnVzVmVjMihkdjEsIHZBKTtcbiAgICAgICAgICBtaW51c1ZlYzIoZHYxLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QSwgdmNwMS5yQSkpO1xuICAgICAgICAgIHplcm9WZWMyKGR2Mik7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYyLCB2Qik7XG4gICAgICAgICAgcGx1c1ZlYzIoZHYyLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QiwgdmNwMi5yQikpO1xuICAgICAgICAgIG1pbnVzVmVjMihkdjIsIHZBKTtcbiAgICAgICAgICBtaW51c1ZlYzIoZHYyLCBjcm9zc051bVZlYzIodGVtcCQyLCB3QSwgdmNwMi5yQSkpO1xuICAgICAgICAgIHZhciB2bjEgPSBkb3RWZWMyKGR2MSwgbm9ybWFsJDIpO1xuICAgICAgICAgIHZhciB2bjIgPSBkb3RWZWMyKGR2Miwgbm9ybWFsJDIpO1xuICAgICAgICAgIHNldFZlYzIoYiwgdm4xIC0gdmNwMS52ZWxvY2l0eUJpYXMsIHZuMiAtIHZjcDIudmVsb2NpdHlCaWFzKTtcbiAgICAgICAgICBiLnggLT0gdGhpcy52X0suZXgueCAqIGEueCArIHRoaXMudl9LLmV5LnggKiBhLnk7XG4gICAgICAgICAgYi55IC09IHRoaXMudl9LLmV4LnkgKiBhLnggKyB0aGlzLnZfSy5leS55ICogYS55O1xuICAgICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICB6ZXJvVmVjMih4KTtcbiAgICAgICAgICAgIHgueCA9IC0odGhpcy52X25vcm1hbE1hc3MuZXgueCAqIGIueCArIHRoaXMudl9ub3JtYWxNYXNzLmV5LnggKiBiLnkpO1xuICAgICAgICAgICAgeC55ID0gLSh0aGlzLnZfbm9ybWFsTWFzcy5leC55ICogYi54ICsgdGhpcy52X25vcm1hbE1hc3MuZXkueSAqIGIueSk7XG4gICAgICAgICAgICBpZiAoeC54ID49IDAgJiYgeC55ID49IDApIHtcbiAgICAgICAgICAgICAgc3ViVmVjMihkLCB4LCBhKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKFAxLCBkLngsIG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgc2NhbGVWZWMyKFAyLCBkLnksIG5vcm1hbCQyKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZBLCAtbUEsIFAxLCAtbUEsIFAyLCAxLCB2QSk7XG4gICAgICAgICAgICAgIHdBIC09IGlBICogKGNyb3NzVmVjMlZlYzIodmNwMS5yQSwgUDEpICsgY3Jvc3NWZWMyVmVjMih2Y3AyLnJBLCBQMikpO1xuICAgICAgICAgICAgICBjb21iaW5lM1ZlYzIodkIsIG1CLCBQMSwgbUIsIFAyLCAxLCB2Qik7XG4gICAgICAgICAgICAgIHdCICs9IGlCICogKGNyb3NzVmVjMlZlYzIodmNwMS5yQiwgUDEpICsgY3Jvc3NWZWMyVmVjMih2Y3AyLnJCLCBQMikpO1xuICAgICAgICAgICAgICB2Y3AxLm5vcm1hbEltcHVsc2UgPSB4Lng7XG4gICAgICAgICAgICAgIHZjcDIubm9ybWFsSW1wdWxzZSA9IHgueTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4LnggPSAtdmNwMS5ub3JtYWxNYXNzICogYi54O1xuICAgICAgICAgICAgeC55ID0gMDtcbiAgICAgICAgICAgIHZuMSA9IDA7XG4gICAgICAgICAgICB2bjIgPSB0aGlzLnZfSy5leC55ICogeC54ICsgYi55O1xuICAgICAgICAgICAgaWYgKHgueCA+PSAwICYmIHZuMiA+PSAwKSB7XG4gICAgICAgICAgICAgIHN1YlZlYzIoZCwgeCwgYSk7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMSwgZC54LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMiwgZC55LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QSwgLW1BLCBQMSwgLW1BLCBQMiwgMSwgdkEpO1xuICAgICAgICAgICAgICB3QSAtPSBpQSAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckEsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQSwgUDIpKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZCLCBtQiwgUDEsIG1CLCBQMiwgMSwgdkIpO1xuICAgICAgICAgICAgICB3QiArPSBpQiAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckIsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQiwgUDIpKTtcbiAgICAgICAgICAgICAgdmNwMS5ub3JtYWxJbXB1bHNlID0geC54O1xuICAgICAgICAgICAgICB2Y3AyLm5vcm1hbEltcHVsc2UgPSB4Lnk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeC54ID0gMDtcbiAgICAgICAgICAgIHgueSA9IC12Y3AyLm5vcm1hbE1hc3MgKiBiLnk7XG4gICAgICAgICAgICB2bjEgPSB0aGlzLnZfSy5leS54ICogeC55ICsgYi54O1xuICAgICAgICAgICAgdm4yID0gMDtcbiAgICAgICAgICAgIGlmICh4LnkgPj0gMCAmJiB2bjEgPj0gMCkge1xuICAgICAgICAgICAgICBzdWJWZWMyKGQsIHgsIGEpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIoUDEsIGQueCwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgICBzY2FsZVZlYzIoUDIsIGQueSwgbm9ybWFsJDIpO1xuICAgICAgICAgICAgICBjb21iaW5lM1ZlYzIodkEsIC1tQSwgUDEsIC1tQSwgUDIsIDEsIHZBKTtcbiAgICAgICAgICAgICAgd0EgLT0gaUEgKiAoY3Jvc3NWZWMyVmVjMih2Y3AxLnJBLCBQMSkgKyBjcm9zc1ZlYzJWZWMyKHZjcDIuckEsIFAyKSk7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QiwgbUIsIFAxLCBtQiwgUDIsIDEsIHZCKTtcbiAgICAgICAgICAgICAgd0IgKz0gaUIgKiAoY3Jvc3NWZWMyVmVjMih2Y3AxLnJCLCBQMSkgKyBjcm9zc1ZlYzJWZWMyKHZjcDIuckIsIFAyKSk7XG4gICAgICAgICAgICAgIHZjcDEubm9ybWFsSW1wdWxzZSA9IHgueDtcbiAgICAgICAgICAgICAgdmNwMi5ub3JtYWxJbXB1bHNlID0geC55O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHgueCA9IDA7XG4gICAgICAgICAgICB4LnkgPSAwO1xuICAgICAgICAgICAgdm4xID0gYi54O1xuICAgICAgICAgICAgdm4yID0gYi55O1xuICAgICAgICAgICAgaWYgKHZuMSA+PSAwICYmIHZuMiA+PSAwKSB7XG4gICAgICAgICAgICAgIHN1YlZlYzIoZCwgeCwgYSk7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMSwgZC54LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIHNjYWxlVmVjMihQMiwgZC55LCBub3JtYWwkMik7XG4gICAgICAgICAgICAgIGNvbWJpbmUzVmVjMih2QSwgLW1BLCBQMSwgLW1BLCBQMiwgMSwgdkEpO1xuICAgICAgICAgICAgICB3QSAtPSBpQSAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckEsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQSwgUDIpKTtcbiAgICAgICAgICAgICAgY29tYmluZTNWZWMyKHZCLCBtQiwgUDEsIG1CLCBQMiwgMSwgdkIpO1xuICAgICAgICAgICAgICB3QiArPSBpQiAqIChjcm9zc1ZlYzJWZWMyKHZjcDEuckIsIFAxKSArIGNyb3NzVmVjMlZlYzIodmNwMi5yQiwgUDIpKTtcbiAgICAgICAgICAgICAgdmNwMS5ub3JtYWxJbXB1bHNlID0geC54O1xuICAgICAgICAgICAgICB2Y3AyLm5vcm1hbEltcHVsc2UgPSB4Lnk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvcHlWZWMyKHZlbG9jaXR5QS52LCB2QSk7XG4gICAgICAgIHZlbG9jaXR5QS53ID0gd0E7XG4gICAgICAgIGNvcHlWZWMyKHZlbG9jaXR5Qi52LCB2Qik7XG4gICAgICAgIHZlbG9jaXR5Qi53ID0gd0I7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIuYWRkVHlwZSA9IGZ1bmN0aW9uKHR5cGUxLCB0eXBlMiwgY2FsbGJhY2spIHtcbiAgICAgICAgc19yZWdpc3RlcnNbdHlwZTFdID0gc19yZWdpc3RlcnNbdHlwZTFdIHx8IHt9O1xuICAgICAgICBzX3JlZ2lzdGVyc1t0eXBlMV1bdHlwZTJdID0gY2FsbGJhY2s7XG4gICAgICB9O1xuICAgICAgQ29udGFjdDIuY3JlYXRlID0gZnVuY3Rpb24oZml4dHVyZUEsIGluZGV4QSwgZml4dHVyZUIsIGluZGV4Qikge1xuICAgICAgICB2YXIgdHlwZUEgPSBmaXh0dXJlQS5tX3NoYXBlLm1fdHlwZTtcbiAgICAgICAgdmFyIHR5cGVCID0gZml4dHVyZUIubV9zaGFwZS5tX3R5cGU7XG4gICAgICAgIHZhciBjb250YWN0ID0gY29udGFjdFBvb2wuYWxsb2NhdGUoKTtcbiAgICAgICAgdmFyIGV2YWx1YXRlRmNuO1xuICAgICAgICBpZiAoZXZhbHVhdGVGY24gPSBzX3JlZ2lzdGVyc1t0eXBlQV0gJiYgc19yZWdpc3RlcnNbdHlwZUFdW3R5cGVCXSkge1xuICAgICAgICAgIGNvbnRhY3QuaW5pdGlhbGl6ZShmaXh0dXJlQSwgaW5kZXhBLCBmaXh0dXJlQiwgaW5kZXhCLCBldmFsdWF0ZUZjbik7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZhbHVhdGVGY24gPSBzX3JlZ2lzdGVyc1t0eXBlQl0gJiYgc19yZWdpc3RlcnNbdHlwZUJdW3R5cGVBXSkge1xuICAgICAgICAgIGNvbnRhY3QuaW5pdGlhbGl6ZShmaXh0dXJlQiwgaW5kZXhCLCBmaXh0dXJlQSwgaW5kZXhBLCBldmFsdWF0ZUZjbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZml4dHVyZUEgPSBjb250YWN0Lm1fZml4dHVyZUE7XG4gICAgICAgIGZpeHR1cmVCID0gY29udGFjdC5tX2ZpeHR1cmVCO1xuICAgICAgICBpbmRleEEgPSBjb250YWN0LmdldENoaWxkSW5kZXhBKCk7XG4gICAgICAgIGluZGV4QiA9IGNvbnRhY3QuZ2V0Q2hpbGRJbmRleEIoKTtcbiAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xuICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQS5jb250YWN0ID0gY29udGFjdDtcbiAgICAgICAgY29udGFjdC5tX25vZGVBLm90aGVyID0gYm9keUI7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQS5wcmV2ID0gbnVsbDtcbiAgICAgICAgY29udGFjdC5tX25vZGVBLm5leHQgPSBib2R5QS5tX2NvbnRhY3RMaXN0O1xuICAgICAgICBpZiAoYm9keUEubV9jb250YWN0TGlzdCAhPSBudWxsKSB7XG4gICAgICAgICAgYm9keUEubV9jb250YWN0TGlzdC5wcmV2ID0gY29udGFjdC5tX25vZGVBO1xuICAgICAgICB9XG4gICAgICAgIGJvZHlBLm1fY29udGFjdExpc3QgPSBjb250YWN0Lm1fbm9kZUE7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQi5jb250YWN0ID0gY29udGFjdDtcbiAgICAgICAgY29udGFjdC5tX25vZGVCLm90aGVyID0gYm9keUE7XG4gICAgICAgIGNvbnRhY3QubV9ub2RlQi5wcmV2ID0gbnVsbDtcbiAgICAgICAgY29udGFjdC5tX25vZGVCLm5leHQgPSBib2R5Qi5tX2NvbnRhY3RMaXN0O1xuICAgICAgICBpZiAoYm9keUIubV9jb250YWN0TGlzdCAhPSBudWxsKSB7XG4gICAgICAgICAgYm9keUIubV9jb250YWN0TGlzdC5wcmV2ID0gY29udGFjdC5tX25vZGVCO1xuICAgICAgICB9XG4gICAgICAgIGJvZHlCLm1fY29udGFjdExpc3QgPSBjb250YWN0Lm1fbm9kZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQS5pc1NlbnNvcigpID09IGZhbHNlICYmIGZpeHR1cmVCLmlzU2Vuc29yKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICBib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICBib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGFjdDtcbiAgICAgIH07XG4gICAgICBDb250YWN0Mi5kZXN0cm95ID0gZnVuY3Rpb24oY29udGFjdCwgbGlzdGVuZXIpIHtcbiAgICAgICAgdmFyIGZpeHR1cmVBID0gY29udGFjdC5tX2ZpeHR1cmVBO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSBjb250YWN0Lm1fZml4dHVyZUI7XG4gICAgICAgIGlmIChmaXh0dXJlQSA9PT0gbnVsbCB8fCBmaXh0dXJlQiA9PT0gbnVsbClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgICBpZiAoYm9keUEgPT09IG51bGwgfHwgYm9keUIgPT09IG51bGwpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoY29udGFjdC5pc1RvdWNoaW5nKCkpIHtcbiAgICAgICAgICBsaXN0ZW5lci5lbmRDb250YWN0KGNvbnRhY3QpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbm9kZUEucHJldikge1xuICAgICAgICAgIGNvbnRhY3QubV9ub2RlQS5wcmV2Lm5leHQgPSBjb250YWN0Lm1fbm9kZUEubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdC5tX25vZGVBLm5leHQpIHtcbiAgICAgICAgICBjb250YWN0Lm1fbm9kZUEubmV4dC5wcmV2ID0gY29udGFjdC5tX25vZGVBLnByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9ub2RlQSA9PSBib2R5QS5tX2NvbnRhY3RMaXN0KSB7XG4gICAgICAgICAgYm9keUEubV9jb250YWN0TGlzdCA9IGNvbnRhY3QubV9ub2RlQS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbm9kZUIucHJldikge1xuICAgICAgICAgIGNvbnRhY3QubV9ub2RlQi5wcmV2Lm5leHQgPSBjb250YWN0Lm1fbm9kZUIubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFjdC5tX25vZGVCLm5leHQpIHtcbiAgICAgICAgICBjb250YWN0Lm1fbm9kZUIubmV4dC5wcmV2ID0gY29udGFjdC5tX25vZGVCLnByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9ub2RlQiA9PSBib2R5Qi5tX2NvbnRhY3RMaXN0KSB7XG4gICAgICAgICAgYm9keUIubV9jb250YWN0TGlzdCA9IGNvbnRhY3QubV9ub2RlQi5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWN0Lm1fbWFuaWZvbGQucG9pbnRDb3VudCA+IDAgJiYgIWZpeHR1cmVBLm1faXNTZW5zb3IgJiYgIWZpeHR1cmVCLm1faXNTZW5zb3IpIHtcbiAgICAgICAgICBib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICBib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBjb250YWN0UG9vbC5yZWxlYXNlKGNvbnRhY3QpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBDb250YWN0MjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIERFRkFVTFRTJGIgPSB7XG4gICAgZ3Jhdml0eTogVmVjMi56ZXJvKCksXG4gICAgYWxsb3dTbGVlcDogdHJ1ZSxcbiAgICB3YXJtU3RhcnRpbmc6IHRydWUsXG4gICAgY29udGludW91c1BoeXNpY3M6IHRydWUsXG4gICAgc3ViU3RlcHBpbmc6IGZhbHNlLFxuICAgIGJsb2NrU29sdmU6IHRydWUsXG4gICAgdmVsb2NpdHlJdGVyYXRpb25zOiA4LFxuICAgIHBvc2l0aW9uSXRlcmF0aW9uczogM1xuICB9O1xuICB2YXIgV29ybGQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gV29ybGQyKGRlZikge1xuICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgV29ybGQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgV29ybGQyKGRlZik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zX3N0ZXAgPSBuZXcgVGltZVN0ZXAoKTtcbiAgICAgICAgaWYgKCFkZWYpIHtcbiAgICAgICAgICBkZWYgPSB7fTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmKSkge1xuICAgICAgICAgIGRlZiA9IHsgZ3Jhdml0eTogZGVmIH07XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJGIpO1xuICAgICAgICB0aGlzLm1fc29sdmVyID0gbmV3IFNvbHZlcih0aGlzKTtcbiAgICAgICAgdGhpcy5tX2Jyb2FkUGhhc2UgPSBuZXcgQnJvYWRQaGFzZSgpO1xuICAgICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBudWxsO1xuICAgICAgICB0aGlzLm1fY29udGFjdENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5tX2JvZHlMaXN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX2JvZHlDb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV9qb2ludExpc3QgPSBudWxsO1xuICAgICAgICB0aGlzLm1fam9pbnRDb3VudCA9IDA7XG4gICAgICAgIHRoaXMubV9zdGVwQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICB0aGlzLm1fYWxsb3dTbGVlcCA9IGRlZi5hbGxvd1NsZWVwO1xuICAgICAgICB0aGlzLm1fZ3Jhdml0eSA9IFZlYzIuY2xvbmUoZGVmLmdyYXZpdHkpO1xuICAgICAgICB0aGlzLm1fY2xlYXJGb3JjZXMgPSB0cnVlO1xuICAgICAgICB0aGlzLm1fbmV3Rml4dHVyZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV93YXJtU3RhcnRpbmcgPSBkZWYud2FybVN0YXJ0aW5nO1xuICAgICAgICB0aGlzLm1fY29udGludW91c1BoeXNpY3MgPSBkZWYuY29udGludW91c1BoeXNpY3M7XG4gICAgICAgIHRoaXMubV9zdWJTdGVwcGluZyA9IGRlZi5zdWJTdGVwcGluZztcbiAgICAgICAgdGhpcy5tX2Jsb2NrU29sdmUgPSBkZWYuYmxvY2tTb2x2ZTtcbiAgICAgICAgdGhpcy5tX3ZlbG9jaXR5SXRlcmF0aW9ucyA9IGRlZi52ZWxvY2l0eUl0ZXJhdGlvbnM7XG4gICAgICAgIHRoaXMubV9wb3NpdGlvbkl0ZXJhdGlvbnMgPSBkZWYucG9zaXRpb25JdGVyYXRpb25zO1xuICAgICAgICB0aGlzLm1fdCA9IDA7XG4gICAgICAgIHRoaXMubV9zdGVwX2NhbGxiYWNrID0gW107XG4gICAgICB9XG4gICAgICBXb3JsZDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGJvZGllcyA9IFtdO1xuICAgICAgICB2YXIgam9pbnRzID0gW107XG4gICAgICAgIGZvciAodmFyIGIyID0gdGhpcy5nZXRCb2R5TGlzdCgpOyBiMjsgYjIgPSBiMi5nZXROZXh0KCkpIHtcbiAgICAgICAgICBib2RpZXMucHVzaChiMik7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaiA9IHRoaXMuZ2V0Sm9pbnRMaXN0KCk7IGo7IGogPSBqLmdldE5leHQoKSkge1xuICAgICAgICAgIGlmICh0eXBlb2Ygai5fc2VyaWFsaXplID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGpvaW50cy5wdXNoKGopO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGdyYXZpdHk6IHRoaXMubV9ncmF2aXR5LFxuICAgICAgICAgIGJvZGllcyxcbiAgICAgICAgICBqb2ludHNcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgY29udGV4dCwgcmVzdG9yZSkge1xuICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFdvcmxkMigpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB3b3JsZCA9IG5ldyBXb3JsZDIoZGF0YS5ncmF2aXR5KTtcbiAgICAgICAgaWYgKGRhdGEuYm9kaWVzKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IGRhdGEuYm9kaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaSAtPSAxKSB7XG4gICAgICAgICAgICB3b3JsZC5fYWRkQm9keShyZXN0b3JlKEJvZHksIGRhdGEuYm9kaWVzW2ldLCB3b3JsZCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZGF0YS5qb2ludHMpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gZGF0YS5qb2ludHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHdvcmxkLmNyZWF0ZUpvaW50KHJlc3RvcmUoSm9pbnQsIGRhdGEuam9pbnRzW2ldLCB3b3JsZCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gd29ybGQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRCb2R5TGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlMaXN0O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0Sm9pbnRMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fam9pbnRMaXN0O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0Q29udGFjdExpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldEJvZHlDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlDb3VudDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldEpvaW50Q291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9qb2ludENvdW50O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0Q29udGFjdENvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY29udGFjdENvdW50O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuc2V0R3Jhdml0eSA9IGZ1bmN0aW9uKGdyYXZpdHkpIHtcbiAgICAgICAgdGhpcy5tX2dyYXZpdHkuc2V0KGdyYXZpdHkpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0R3Jhdml0eSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2dyYXZpdHk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5pc0xvY2tlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2tlZDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnNldEFsbG93U2xlZXBpbmcgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnID09IHRoaXMubV9hbGxvd1NsZWVwKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9hbGxvd1NsZWVwID0gZmxhZztcbiAgICAgICAgaWYgKHRoaXMubV9hbGxvd1NsZWVwID09IGZhbHNlKSB7XG4gICAgICAgICAgZm9yICh2YXIgYjIgPSB0aGlzLm1fYm9keUxpc3Q7IGIyOyBiMiA9IGIyLm1fbmV4dCkge1xuICAgICAgICAgICAgYjIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRBbGxvd1NsZWVwaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYWxsb3dTbGVlcDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnNldFdhcm1TdGFydGluZyA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX3dhcm1TdGFydGluZyA9IGZsYWc7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRXYXJtU3RhcnRpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV93YXJtU3RhcnRpbmc7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zZXRDb250aW51b3VzUGh5c2ljcyA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX2NvbnRpbnVvdXNQaHlzaWNzID0gZmxhZztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldENvbnRpbnVvdXNQaHlzaWNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY29udGludW91c1BoeXNpY3M7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zZXRTdWJTdGVwcGluZyA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5tX3N1YlN0ZXBwaW5nID0gZmxhZztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldFN1YlN0ZXBwaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fc3ViU3RlcHBpbmc7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zZXRBdXRvQ2xlYXJGb3JjZXMgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIHRoaXMubV9jbGVhckZvcmNlcyA9IGZsYWc7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5nZXRBdXRvQ2xlYXJGb3JjZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9jbGVhckZvcmNlcztcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmNsZWFyRm9yY2VzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZvciAodmFyIGJvZHkgPSB0aGlzLm1fYm9keUxpc3Q7IGJvZHk7IGJvZHkgPSBib2R5LmdldE5leHQoKSkge1xuICAgICAgICAgIGJvZHkubV9mb3JjZS5zZXRaZXJvKCk7XG4gICAgICAgICAgYm9keS5tX3RvcnF1ZSA9IDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnF1ZXJ5QUFCQiA9IGZ1bmN0aW9uKGFhYmIsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX2Jyb2FkUGhhc2U7XG4gICAgICAgIHRoaXMubV9icm9hZFBoYXNlLnF1ZXJ5KGFhYmIsIGZ1bmN0aW9uKHByb3h5SWQpIHtcbiAgICAgICAgICB2YXIgcHJveHkgPSBicm9hZFBoYXNlLmdldFVzZXJEYXRhKHByb3h5SWQpO1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjayhwcm94eS5maXh0dXJlKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ocG9pbnQxLCBwb2ludDIsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX2Jyb2FkUGhhc2U7XG4gICAgICAgIHRoaXMubV9icm9hZFBoYXNlLnJheUNhc3Qoe1xuICAgICAgICAgIG1heEZyYWN0aW9uOiAxLFxuICAgICAgICAgIHAxOiBwb2ludDEsXG4gICAgICAgICAgcDI6IHBvaW50MlxuICAgICAgICB9LCBmdW5jdGlvbihpbnB1dDIsIHByb3h5SWQpIHtcbiAgICAgICAgICB2YXIgcHJveHkgPSBicm9hZFBoYXNlLmdldFVzZXJEYXRhKHByb3h5SWQpO1xuICAgICAgICAgIHZhciBmaXh0dXJlID0gcHJveHkuZml4dHVyZTtcbiAgICAgICAgICB2YXIgaW5kZXggPSBwcm94eS5jaGlsZEluZGV4O1xuICAgICAgICAgIHZhciBvdXRwdXQyID0ge307XG4gICAgICAgICAgdmFyIGhpdCA9IGZpeHR1cmUucmF5Q2FzdChvdXRwdXQyLCBpbnB1dDIsIGluZGV4KTtcbiAgICAgICAgICBpZiAoaGl0KSB7XG4gICAgICAgICAgICB2YXIgZnJhY3Rpb24gPSBvdXRwdXQyLmZyYWN0aW9uO1xuICAgICAgICAgICAgdmFyIHBvaW50MyA9IFZlYzIuYWRkKFZlYzIubXVsTnVtVmVjMigxIC0gZnJhY3Rpb24sIGlucHV0Mi5wMSksIFZlYzIubXVsTnVtVmVjMihmcmFjdGlvbiwgaW5wdXQyLnAyKSk7XG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZml4dHVyZSwgcG9pbnQzLCBvdXRwdXQyLm5vcm1hbCwgZnJhY3Rpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gaW5wdXQyLm1heEZyYWN0aW9uO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldFByb3h5Q291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9icm9hZFBoYXNlLmdldFByb3h5Q291bnQoKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldFRyZWVIZWlnaHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9icm9hZFBoYXNlLmdldFRyZWVIZWlnaHQoKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmdldFRyZWVCYWxhbmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYnJvYWRQaGFzZS5nZXRUcmVlQmFsYW5jZSgpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZ2V0VHJlZVF1YWxpdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9icm9hZFBoYXNlLmdldFRyZWVRdWFsaXR5KCk7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5zaGlmdE9yaWdpbiA9IGZ1bmN0aW9uKG5ld09yaWdpbikge1xuICAgICAgICBpZiAodGhpcy5pc0xvY2tlZCgpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGIyID0gdGhpcy5tX2JvZHlMaXN0OyBiMjsgYjIgPSBiMi5tX25leHQpIHtcbiAgICAgICAgICBiMi5tX3hmLnAuc3ViKG5ld09yaWdpbik7XG4gICAgICAgICAgYjIubV9zd2VlcC5jMC5zdWIobmV3T3JpZ2luKTtcbiAgICAgICAgICBiMi5tX3N3ZWVwLmMuc3ViKG5ld09yaWdpbik7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaiA9IHRoaXMubV9qb2ludExpc3Q7IGo7IGogPSBqLm1fbmV4dCkge1xuICAgICAgICAgIGouc2hpZnRPcmlnaW4obmV3T3JpZ2luKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYnJvYWRQaGFzZS5zaGlmdE9yaWdpbihuZXdPcmlnaW4pO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuX2FkZEJvZHkgPSBmdW5jdGlvbihib2R5KSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgYm9keS5tX3ByZXYgPSBudWxsO1xuICAgICAgICBib2R5Lm1fbmV4dCA9IHRoaXMubV9ib2R5TGlzdDtcbiAgICAgICAgaWYgKHRoaXMubV9ib2R5TGlzdCkge1xuICAgICAgICAgIHRoaXMubV9ib2R5TGlzdC5tX3ByZXYgPSBib2R5O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5TGlzdCA9IGJvZHk7XG4gICAgICAgICsrdGhpcy5tX2JvZHlDb3VudDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmNyZWF0ZUJvZHkgPSBmdW5jdGlvbihhcmcxLCBhcmcyKSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGVmID0ge307XG4gICAgICAgIGlmICghYXJnMSkgO1xuICAgICAgICBlbHNlIGlmIChWZWMyLmlzVmFsaWQoYXJnMSkpIHtcbiAgICAgICAgICBkZWYgPSB7IHBvc2l0aW9uOiBhcmcxLCBhbmdsZTogYXJnMiB9O1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhcmcxID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgZGVmID0gYXJnMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYm9keSA9IG5ldyBCb2R5KHRoaXMsIGRlZik7XG4gICAgICAgIHRoaXMuX2FkZEJvZHkoYm9keSk7XG4gICAgICAgIHJldHVybiBib2R5O1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuY3JlYXRlRHluYW1pY0JvZHkgPSBmdW5jdGlvbihhcmcxLCBhcmcyKSB7XG4gICAgICAgIHZhciBkZWYgPSB7fTtcbiAgICAgICAgaWYgKCFhcmcxKSA7XG4gICAgICAgIGVsc2UgaWYgKFZlYzIuaXNWYWxpZChhcmcxKSkge1xuICAgICAgICAgIGRlZiA9IHsgcG9zaXRpb246IGFyZzEsIGFuZ2xlOiBhcmcyIH07XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZzEgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICBkZWYgPSBhcmcxO1xuICAgICAgICB9XG4gICAgICAgIGRlZi50eXBlID0gXCJkeW5hbWljXCI7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUJvZHkoZGVmKTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmNyZWF0ZUtpbmVtYXRpY0JvZHkgPSBmdW5jdGlvbihhcmcxLCBhcmcyKSB7XG4gICAgICAgIHZhciBkZWYgPSB7fTtcbiAgICAgICAgaWYgKCFhcmcxKSA7XG4gICAgICAgIGVsc2UgaWYgKFZlYzIuaXNWYWxpZChhcmcxKSkge1xuICAgICAgICAgIGRlZiA9IHsgcG9zaXRpb246IGFyZzEsIGFuZ2xlOiBhcmcyIH07XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZzEgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICBkZWYgPSBhcmcxO1xuICAgICAgICB9XG4gICAgICAgIGRlZi50eXBlID0gXCJraW5lbWF0aWNcIjtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQm9keShkZWYpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuZGVzdHJveUJvZHkgPSBmdW5jdGlvbihiMikge1xuICAgICAgICBpZiAodGhpcy5pc0xvY2tlZCgpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiMi5tX2Rlc3Ryb3llZCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgamUgPSBiMi5tX2pvaW50TGlzdDtcbiAgICAgICAgd2hpbGUgKGplKSB7XG4gICAgICAgICAgdmFyIGplMCA9IGplO1xuICAgICAgICAgIGplID0gamUubmV4dDtcbiAgICAgICAgICB0aGlzLnB1Ymxpc2goXCJyZW1vdmUtam9pbnRcIiwgamUwLmpvaW50KTtcbiAgICAgICAgICB0aGlzLmRlc3Ryb3lKb2ludChqZTAuam9pbnQpO1xuICAgICAgICAgIGIyLm1fam9pbnRMaXN0ID0gamU7XG4gICAgICAgIH1cbiAgICAgICAgYjIubV9qb2ludExpc3QgPSBudWxsO1xuICAgICAgICB2YXIgY2UgPSBiMi5tX2NvbnRhY3RMaXN0O1xuICAgICAgICB3aGlsZSAoY2UpIHtcbiAgICAgICAgICB2YXIgY2UwID0gY2U7XG4gICAgICAgICAgY2UgPSBjZS5uZXh0O1xuICAgICAgICAgIHRoaXMuZGVzdHJveUNvbnRhY3QoY2UwLmNvbnRhY3QpO1xuICAgICAgICAgIGIyLm1fY29udGFjdExpc3QgPSBjZTtcbiAgICAgICAgfVxuICAgICAgICBiMi5tX2NvbnRhY3RMaXN0ID0gbnVsbDtcbiAgICAgICAgdmFyIGYgPSBiMi5tX2ZpeHR1cmVMaXN0O1xuICAgICAgICB3aGlsZSAoZikge1xuICAgICAgICAgIHZhciBmMCA9IGY7XG4gICAgICAgICAgZiA9IGYubV9uZXh0O1xuICAgICAgICAgIHRoaXMucHVibGlzaChcInJlbW92ZS1maXh0dXJlXCIsIGYwKTtcbiAgICAgICAgICBmMC5kZXN0cm95UHJveGllcyh0aGlzLm1fYnJvYWRQaGFzZSk7XG4gICAgICAgICAgYjIubV9maXh0dXJlTGlzdCA9IGY7XG4gICAgICAgIH1cbiAgICAgICAgYjIubV9maXh0dXJlTGlzdCA9IG51bGw7XG4gICAgICAgIGlmIChiMi5tX3ByZXYpIHtcbiAgICAgICAgICBiMi5tX3ByZXYubV9uZXh0ID0gYjIubV9uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChiMi5tX25leHQpIHtcbiAgICAgICAgICBiMi5tX25leHQubV9wcmV2ID0gYjIubV9wcmV2O1xuICAgICAgICB9XG4gICAgICAgIGlmIChiMiA9PSB0aGlzLm1fYm9keUxpc3QpIHtcbiAgICAgICAgICB0aGlzLm1fYm9keUxpc3QgPSBiMi5tX25leHQ7XG4gICAgICAgIH1cbiAgICAgICAgYjIubV9kZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgICAtLXRoaXMubV9ib2R5Q291bnQ7XG4gICAgICAgIHRoaXMucHVibGlzaChcInJlbW92ZS1ib2R5XCIsIGIyKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5jcmVhdGVKb2ludCA9IGZ1bmN0aW9uKGpvaW50KSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBqb2ludC5tX3ByZXYgPSBudWxsO1xuICAgICAgICBqb2ludC5tX25leHQgPSB0aGlzLm1fam9pbnRMaXN0O1xuICAgICAgICBpZiAodGhpcy5tX2pvaW50TGlzdCkge1xuICAgICAgICAgIHRoaXMubV9qb2ludExpc3QubV9wcmV2ID0gam9pbnQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2pvaW50TGlzdCA9IGpvaW50O1xuICAgICAgICArK3RoaXMubV9qb2ludENvdW50O1xuICAgICAgICBqb2ludC5tX2VkZ2VBLmpvaW50ID0gam9pbnQ7XG4gICAgICAgIGpvaW50Lm1fZWRnZUEub3RoZXIgPSBqb2ludC5tX2JvZHlCO1xuICAgICAgICBqb2ludC5tX2VkZ2VBLnByZXYgPSBudWxsO1xuICAgICAgICBqb2ludC5tX2VkZ2VBLm5leHQgPSBqb2ludC5tX2JvZHlBLm1fam9pbnRMaXN0O1xuICAgICAgICBpZiAoam9pbnQubV9ib2R5QS5tX2pvaW50TGlzdClcbiAgICAgICAgICBqb2ludC5tX2JvZHlBLm1fam9pbnRMaXN0LnByZXYgPSBqb2ludC5tX2VkZ2VBO1xuICAgICAgICBqb2ludC5tX2JvZHlBLm1fam9pbnRMaXN0ID0gam9pbnQubV9lZGdlQTtcbiAgICAgICAgam9pbnQubV9lZGdlQi5qb2ludCA9IGpvaW50O1xuICAgICAgICBqb2ludC5tX2VkZ2VCLm90aGVyID0gam9pbnQubV9ib2R5QTtcbiAgICAgICAgam9pbnQubV9lZGdlQi5wcmV2ID0gbnVsbDtcbiAgICAgICAgam9pbnQubV9lZGdlQi5uZXh0ID0gam9pbnQubV9ib2R5Qi5tX2pvaW50TGlzdDtcbiAgICAgICAgaWYgKGpvaW50Lm1fYm9keUIubV9qb2ludExpc3QpXG4gICAgICAgICAgam9pbnQubV9ib2R5Qi5tX2pvaW50TGlzdC5wcmV2ID0gam9pbnQubV9lZGdlQjtcbiAgICAgICAgam9pbnQubV9ib2R5Qi5tX2pvaW50TGlzdCA9IGpvaW50Lm1fZWRnZUI7XG4gICAgICAgIGlmIChqb2ludC5tX2NvbGxpZGVDb25uZWN0ZWQgPT0gZmFsc2UpIHtcbiAgICAgICAgICBmb3IgKHZhciBlZGdlID0gam9pbnQubV9ib2R5Qi5nZXRDb250YWN0TGlzdCgpOyBlZGdlOyBlZGdlID0gZWRnZS5uZXh0KSB7XG4gICAgICAgICAgICBpZiAoZWRnZS5vdGhlciA9PSBqb2ludC5tX2JvZHlBKSB7XG4gICAgICAgICAgICAgIGVkZ2UuY29udGFjdC5mbGFnRm9yRmlsdGVyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmRlc3Ryb3lKb2ludCA9IGZ1bmN0aW9uKGpvaW50KSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50Lm1fcHJldikge1xuICAgICAgICAgIGpvaW50Lm1fcHJldi5tX25leHQgPSBqb2ludC5tX25leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50Lm1fbmV4dCkge1xuICAgICAgICAgIGpvaW50Lm1fbmV4dC5tX3ByZXYgPSBqb2ludC5tX3ByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50ID09IHRoaXMubV9qb2ludExpc3QpIHtcbiAgICAgICAgICB0aGlzLm1fam9pbnRMaXN0ID0gam9pbnQubV9uZXh0O1xuICAgICAgICB9XG4gICAgICAgIHZhciBib2R5QSA9IGpvaW50Lm1fYm9keUE7XG4gICAgICAgIHZhciBib2R5QiA9IGpvaW50Lm1fYm9keUI7XG4gICAgICAgIGJvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICBib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgaWYgKGpvaW50Lm1fZWRnZUEucHJldikge1xuICAgICAgICAgIGpvaW50Lm1fZWRnZUEucHJldi5uZXh0ID0gam9pbnQubV9lZGdlQS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChqb2ludC5tX2VkZ2VBLm5leHQpIHtcbiAgICAgICAgICBqb2ludC5tX2VkZ2VBLm5leHQucHJldiA9IGpvaW50Lm1fZWRnZUEucHJldjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbnQubV9lZGdlQSA9PSBib2R5QS5tX2pvaW50TGlzdCkge1xuICAgICAgICAgIGJvZHlBLm1fam9pbnRMaXN0ID0gam9pbnQubV9lZGdlQS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGpvaW50Lm1fZWRnZUEucHJldiA9IG51bGw7XG4gICAgICAgIGpvaW50Lm1fZWRnZUEubmV4dCA9IG51bGw7XG4gICAgICAgIGlmIChqb2ludC5tX2VkZ2VCLnByZXYpIHtcbiAgICAgICAgICBqb2ludC5tX2VkZ2VCLnByZXYubmV4dCA9IGpvaW50Lm1fZWRnZUIubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbnQubV9lZGdlQi5uZXh0KSB7XG4gICAgICAgICAgam9pbnQubV9lZGdlQi5uZXh0LnByZXYgPSBqb2ludC5tX2VkZ2VCLnByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvaW50Lm1fZWRnZUIgPT0gYm9keUIubV9qb2ludExpc3QpIHtcbiAgICAgICAgICBib2R5Qi5tX2pvaW50TGlzdCA9IGpvaW50Lm1fZWRnZUIubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBqb2ludC5tX2VkZ2VCLnByZXYgPSBudWxsO1xuICAgICAgICBqb2ludC5tX2VkZ2VCLm5leHQgPSBudWxsO1xuICAgICAgICAtLXRoaXMubV9qb2ludENvdW50O1xuICAgICAgICBpZiAoam9pbnQubV9jb2xsaWRlQ29ubmVjdGVkID09IGZhbHNlKSB7XG4gICAgICAgICAgdmFyIGVkZ2UgPSBib2R5Qi5nZXRDb250YWN0TGlzdCgpO1xuICAgICAgICAgIHdoaWxlIChlZGdlKSB7XG4gICAgICAgICAgICBpZiAoZWRnZS5vdGhlciA9PSBib2R5QSkge1xuICAgICAgICAgICAgICBlZGdlLmNvbnRhY3QuZmxhZ0ZvckZpbHRlcmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wdWJsaXNoKFwicmVtb3ZlLWpvaW50XCIsIGpvaW50KTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLnN0ZXAgPSBmdW5jdGlvbih0aW1lU3RlcCwgdmVsb2NpdHlJdGVyYXRpb25zLCBwb3NpdGlvbkl0ZXJhdGlvbnMpIHtcbiAgICAgICAgdGhpcy5wdWJsaXNoKFwicHJlLXN0ZXBcIiwgdGltZVN0ZXApO1xuICAgICAgICBpZiAoKHZlbG9jaXR5SXRlcmF0aW9ucyB8IDApICE9PSB2ZWxvY2l0eUl0ZXJhdGlvbnMpIHtcbiAgICAgICAgICB2ZWxvY2l0eUl0ZXJhdGlvbnMgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHZlbG9jaXR5SXRlcmF0aW9ucyA9IHZlbG9jaXR5SXRlcmF0aW9ucyB8fCB0aGlzLm1fdmVsb2NpdHlJdGVyYXRpb25zO1xuICAgICAgICBwb3NpdGlvbkl0ZXJhdGlvbnMgPSBwb3NpdGlvbkl0ZXJhdGlvbnMgfHwgdGhpcy5tX3Bvc2l0aW9uSXRlcmF0aW9ucztcbiAgICAgICAgaWYgKHRoaXMubV9uZXdGaXh0dXJlKSB7XG4gICAgICAgICAgdGhpcy5maW5kTmV3Q29udGFjdHMoKTtcbiAgICAgICAgICB0aGlzLm1fbmV3Rml4dHVyZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9sb2NrZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnNfc3RlcC5yZXNldCh0aW1lU3RlcCk7XG4gICAgICAgIHRoaXMuc19zdGVwLnZlbG9jaXR5SXRlcmF0aW9ucyA9IHZlbG9jaXR5SXRlcmF0aW9ucztcbiAgICAgICAgdGhpcy5zX3N0ZXAucG9zaXRpb25JdGVyYXRpb25zID0gcG9zaXRpb25JdGVyYXRpb25zO1xuICAgICAgICB0aGlzLnNfc3RlcC53YXJtU3RhcnRpbmcgPSB0aGlzLm1fd2FybVN0YXJ0aW5nO1xuICAgICAgICB0aGlzLnNfc3RlcC5ibG9ja1NvbHZlID0gdGhpcy5tX2Jsb2NrU29sdmU7XG4gICAgICAgIHRoaXMudXBkYXRlQ29udGFjdHMoKTtcbiAgICAgICAgaWYgKHRoaXMubV9zdGVwQ29tcGxldGUgJiYgdGltZVN0ZXAgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX3NvbHZlci5zb2x2ZVdvcmxkKHRoaXMuc19zdGVwKTtcbiAgICAgICAgICBmb3IgKHZhciBiMiA9IHRoaXMubV9ib2R5TGlzdDsgYjI7IGIyID0gYjIuZ2V0TmV4dCgpKSB7XG4gICAgICAgICAgICBpZiAoYjIubV9pc2xhbmRGbGFnID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGIyLmlzU3RhdGljKCkpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBiMi5zeW5jaHJvbml6ZUZpeHR1cmVzKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuZmluZE5ld0NvbnRhY3RzKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9jb250aW51b3VzUGh5c2ljcyAmJiB0aW1lU3RlcCA+IDApIHtcbiAgICAgICAgICB0aGlzLm1fc29sdmVyLnNvbHZlV29ybGRUT0kodGhpcy5zX3N0ZXApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fY2xlYXJGb3JjZXMpIHtcbiAgICAgICAgICB0aGlzLmNsZWFyRm9yY2VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICB2YXIgY2FsbGJhY2s7XG4gICAgICAgIHdoaWxlIChjYWxsYmFjayA9IHRoaXMubV9zdGVwX2NhbGxiYWNrLnNoaWZ0KCkpIHtcbiAgICAgICAgICBjYWxsYmFjayh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnB1Ymxpc2goXCJwb3N0LXN0ZXBcIiwgdGltZVN0ZXApO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUucXVldWVVcGRhdGUgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgICBpZiAoIXRoaXMuaXNMb2NrZWQoKSkge1xuICAgICAgICAgIGNhbGxiYWNrKHRoaXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9zdGVwX2NhbGxiYWNrLnB1c2goY2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5maW5kTmV3Q29udGFjdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5tX2Jyb2FkUGhhc2UudXBkYXRlUGFpcnMoZnVuY3Rpb24ocHJveHlBLCBwcm94eUIpIHtcbiAgICAgICAgICByZXR1cm4gX3RoaXMuY3JlYXRlQ29udGFjdChwcm94eUEsIHByb3h5Qik7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUuY3JlYXRlQ29udGFjdCA9IGZ1bmN0aW9uKHByb3h5QSwgcHJveHlCKSB7XG4gICAgICAgIHZhciBmaXh0dXJlQSA9IHByb3h5QS5maXh0dXJlO1xuICAgICAgICB2YXIgZml4dHVyZUIgPSBwcm94eUIuZml4dHVyZTtcbiAgICAgICAgdmFyIGluZGV4QSA9IHByb3h5QS5jaGlsZEluZGV4O1xuICAgICAgICB2YXIgaW5kZXhCID0gcHJveHlCLmNoaWxkSW5kZXg7XG4gICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLmdldEJvZHkoKTtcbiAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIuZ2V0Qm9keSgpO1xuICAgICAgICBpZiAoYm9keUEgPT0gYm9keUIpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVkZ2UgPSBib2R5Qi5nZXRDb250YWN0TGlzdCgpO1xuICAgICAgICB3aGlsZSAoZWRnZSkge1xuICAgICAgICAgIGlmIChlZGdlLm90aGVyID09IGJvZHlBKSB7XG4gICAgICAgICAgICB2YXIgZkEgPSBlZGdlLmNvbnRhY3QuZ2V0Rml4dHVyZUEoKTtcbiAgICAgICAgICAgIHZhciBmQiA9IGVkZ2UuY29udGFjdC5nZXRGaXh0dXJlQigpO1xuICAgICAgICAgICAgdmFyIGlBID0gZWRnZS5jb250YWN0LmdldENoaWxkSW5kZXhBKCk7XG4gICAgICAgICAgICB2YXIgaUIgPSBlZGdlLmNvbnRhY3QuZ2V0Q2hpbGRJbmRleEIoKTtcbiAgICAgICAgICAgIGlmIChmQSA9PSBmaXh0dXJlQSAmJiBmQiA9PSBmaXh0dXJlQiAmJiBpQSA9PSBpbmRleEEgJiYgaUIgPT0gaW5kZXhCKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmQSA9PSBmaXh0dXJlQiAmJiBmQiA9PSBmaXh0dXJlQSAmJiBpQSA9PSBpbmRleEIgJiYgaUIgPT0gaW5kZXhBKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYm9keUIuc2hvdWxkQ29sbGlkZShib2R5QSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpeHR1cmVCLnNob3VsZENvbGxpZGUoZml4dHVyZUEpID09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb250YWN0ID0gQ29udGFjdC5jcmVhdGUoZml4dHVyZUEsIGluZGV4QSwgZml4dHVyZUIsIGluZGV4Qik7XG4gICAgICAgIGlmIChjb250YWN0ID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29udGFjdC5tX3ByZXYgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5tX2NvbnRhY3RMaXN0ICE9IG51bGwpIHtcbiAgICAgICAgICBjb250YWN0Lm1fbmV4dCA9IHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgICAgICB0aGlzLm1fY29udGFjdExpc3QubV9wcmV2ID0gY29udGFjdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBjb250YWN0O1xuICAgICAgICArK3RoaXMubV9jb250YWN0Q291bnQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS51cGRhdGVDb250YWN0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYzI7XG4gICAgICAgIHZhciBuZXh0X2MgPSB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICAgIHdoaWxlIChjMiA9IG5leHRfYykge1xuICAgICAgICAgIG5leHRfYyA9IGMyLmdldE5leHQoKTtcbiAgICAgICAgICB2YXIgZml4dHVyZUEgPSBjMi5nZXRGaXh0dXJlQSgpO1xuICAgICAgICAgIHZhciBmaXh0dXJlQiA9IGMyLmdldEZpeHR1cmVCKCk7XG4gICAgICAgICAgdmFyIGluZGV4QSA9IGMyLmdldENoaWxkSW5kZXhBKCk7XG4gICAgICAgICAgdmFyIGluZGV4QiA9IGMyLmdldENoaWxkSW5kZXhCKCk7XG4gICAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEuZ2V0Qm9keSgpO1xuICAgICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLmdldEJvZHkoKTtcbiAgICAgICAgICBpZiAoYzIubV9maWx0ZXJGbGFnKSB7XG4gICAgICAgICAgICBpZiAoYm9keUIuc2hvdWxkQ29sbGlkZShib2R5QSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgdGhpcy5kZXN0cm95Q29udGFjdChjMik7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpeHR1cmVCLnNob3VsZENvbGxpZGUoZml4dHVyZUEpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIHRoaXMuZGVzdHJveUNvbnRhY3QoYzIpO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGMyLm1fZmlsdGVyRmxhZyA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgYWN0aXZlQSA9IGJvZHlBLmlzQXdha2UoKSAmJiAhYm9keUEuaXNTdGF0aWMoKTtcbiAgICAgICAgICB2YXIgYWN0aXZlQiA9IGJvZHlCLmlzQXdha2UoKSAmJiAhYm9keUIuaXNTdGF0aWMoKTtcbiAgICAgICAgICBpZiAoYWN0aXZlQSA9PSBmYWxzZSAmJiBhY3RpdmVCID09IGZhbHNlKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHByb3h5SWRBID0gZml4dHVyZUEubV9wcm94aWVzW2luZGV4QV0ucHJveHlJZDtcbiAgICAgICAgICB2YXIgcHJveHlJZEIgPSBmaXh0dXJlQi5tX3Byb3hpZXNbaW5kZXhCXS5wcm94eUlkO1xuICAgICAgICAgIHZhciBvdmVybGFwID0gdGhpcy5tX2Jyb2FkUGhhc2UudGVzdE92ZXJsYXAocHJveHlJZEEsIHByb3h5SWRCKTtcbiAgICAgICAgICBpZiAob3ZlcmxhcCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95Q29udGFjdChjMik7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYzIudXBkYXRlKHRoaXMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5kZXN0cm95Q29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QpIHtcbiAgICAgICAgaWYgKGNvbnRhY3QubV9wcmV2KSB7XG4gICAgICAgICAgY29udGFjdC5tX3ByZXYubV9uZXh0ID0gY29udGFjdC5tX25leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QubV9uZXh0KSB7XG4gICAgICAgICAgY29udGFjdC5tX25leHQubV9wcmV2ID0gY29udGFjdC5tX3ByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRhY3QgPT0gdGhpcy5tX2NvbnRhY3RMaXN0KSB7XG4gICAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gY29udGFjdC5tX25leHQ7XG4gICAgICAgIH1cbiAgICAgICAgQ29udGFjdC5kZXN0cm95KGNvbnRhY3QsIHRoaXMpO1xuICAgICAgICAtLXRoaXMubV9jb250YWN0Q291bnQ7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uKG5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgbGlzdGVuZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5fbGlzdGVuZXJzKSB7XG4gICAgICAgICAgdGhpcy5fbGlzdGVuZXJzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9saXN0ZW5lcnNbbmFtZV0pIHtcbiAgICAgICAgICB0aGlzLl9saXN0ZW5lcnNbbmFtZV0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9saXN0ZW5lcnNbbmFtZV0ucHVzaChsaXN0ZW5lcik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24obmFtZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lICE9PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBsaXN0ZW5lciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVycyAmJiB0aGlzLl9saXN0ZW5lcnNbbmFtZV07XG4gICAgICAgIGlmICghbGlzdGVuZXJzIHx8ICFsaXN0ZW5lcnMubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluZGV4ID0gbGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUucHVibGlzaCA9IGZ1bmN0aW9uKG5hbWUsIGFyZzEsIGFyZzIsIGFyZzMpIHtcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVycyAmJiB0aGlzLl9saXN0ZW5lcnNbbmFtZV07XG4gICAgICAgIGlmICghbGlzdGVuZXJzIHx8ICFsaXN0ZW5lcnMubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgbCA9IDA7IGwgPCBsaXN0ZW5lcnMubGVuZ3RoOyBsKyspIHtcbiAgICAgICAgICBsaXN0ZW5lcnNbbF0uY2FsbCh0aGlzLCBhcmcxLCBhcmcyLCBhcmczKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdGVuZXJzLmxlbmd0aDtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmJlZ2luQ29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QpIHtcbiAgICAgICAgdGhpcy5wdWJsaXNoKFwiYmVnaW4tY29udGFjdFwiLCBjb250YWN0KTtcbiAgICAgIH07XG4gICAgICBXb3JsZDIucHJvdG90eXBlLmVuZENvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0KSB7XG4gICAgICAgIHRoaXMucHVibGlzaChcImVuZC1jb250YWN0XCIsIGNvbnRhY3QpO1xuICAgICAgfTtcbiAgICAgIFdvcmxkMi5wcm90b3R5cGUucHJlU29sdmUgPSBmdW5jdGlvbihjb250YWN0LCBvbGRNYW5pZm9sZDIpIHtcbiAgICAgICAgdGhpcy5wdWJsaXNoKFwicHJlLXNvbHZlXCIsIGNvbnRhY3QsIG9sZE1hbmlmb2xkMik7XG4gICAgICB9O1xuICAgICAgV29ybGQyLnByb3RvdHlwZS5wb3N0U29sdmUgPSBmdW5jdGlvbihjb250YWN0LCBpbXB1bHNlKSB7XG4gICAgICAgIHRoaXMucHVibGlzaChcInBvc3Qtc29sdmVcIiwgY29udGFjdCwgaW1wdWxzZSk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFdvcmxkMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIFZlYzMgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVmVjMzIoeDIsIHksIHopIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFZlYzMyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgVmVjMzIoeDIsIHksIHopO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgeDIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0aGlzLnggPSAwO1xuICAgICAgICAgIHRoaXMueSA9IDA7XG4gICAgICAgICAgdGhpcy56ID0gMDtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgeDIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICB0aGlzLnggPSB4Mi54O1xuICAgICAgICAgIHRoaXMueSA9IHgyLnk7XG4gICAgICAgICAgdGhpcy56ID0geDIuejtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnggPSB4MjtcbiAgICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICAgIHRoaXMueiA9IHo7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFZlYzMyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgeDogdGhpcy54LFxuICAgICAgICAgIHk6IHRoaXMueSxcbiAgICAgICAgICB6OiB0aGlzLnpcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKFZlYzMyLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai54ID0gZGF0YS54O1xuICAgICAgICBvYmoueSA9IGRhdGEueTtcbiAgICAgICAgb2JqLnogPSBkYXRhLno7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVmVjMzIubmVvID0gZnVuY3Rpb24oeDIsIHksIHopIHtcbiAgICAgICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUoVmVjMzIucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnggPSB4MjtcbiAgICAgICAgb2JqLnkgPSB5O1xuICAgICAgICBvYmoueiA9IHo7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgICAgVmVjMzIuemVybyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gT2JqZWN0LmNyZWF0ZShWZWMzMi5wcm90b3R5cGUpO1xuICAgICAgICBvYmoueCA9IDA7XG4gICAgICAgIG9iai55ID0gMDtcbiAgICAgICAgb2JqLnogPSAwO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLmNsb25lID0gZnVuY3Rpb24odjMpIHtcbiAgICAgICAgcmV0dXJuIFZlYzMyLm5lbyh2My54LCB2My55LCB2My56KTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMpO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOdW1iZXIuaXNGaW5pdGUob2JqLngpICYmIE51bWJlci5pc0Zpbml0ZShvYmoueSkgJiYgTnVtYmVyLmlzRmluaXRlKG9iai56KTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5hc3NlcnQgPSBmdW5jdGlvbihvKSB7XG4gICAgICB9O1xuICAgICAgVmVjMzIucHJvdG90eXBlLnNldFplcm8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy54ID0gMDtcbiAgICAgICAgdGhpcy55ID0gMDtcbiAgICAgICAgdGhpcy56ID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgVmVjMzIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHgyLCB5LCB6KSB7XG4gICAgICAgIHRoaXMueCA9IHgyO1xuICAgICAgICB0aGlzLnkgPSB5O1xuICAgICAgICB0aGlzLnogPSB6O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24odykge1xuICAgICAgICB0aGlzLnggKz0gdy54O1xuICAgICAgICB0aGlzLnkgKz0gdy55O1xuICAgICAgICB0aGlzLnogKz0gdy56O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUuc3ViID0gZnVuY3Rpb24odykge1xuICAgICAgICB0aGlzLnggLT0gdy54O1xuICAgICAgICB0aGlzLnkgLT0gdy55O1xuICAgICAgICB0aGlzLnogLT0gdy56O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUubXVsID0gZnVuY3Rpb24obSkge1xuICAgICAgICB0aGlzLnggKj0gbTtcbiAgICAgICAgdGhpcy55ICo9IG07XG4gICAgICAgIHRoaXMueiAqPSBtO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBWZWMzMi5hcmVFcXVhbCA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiB2MyA9PT0gdyB8fCB0eXBlb2YgdjMgPT09IFwib2JqZWN0XCIgJiYgdjMgIT09IG51bGwgJiYgdHlwZW9mIHcgPT09IFwib2JqZWN0XCIgJiYgdyAhPT0gbnVsbCAmJiB2My54ID09PSB3LnggJiYgdjMueSA9PT0gdy55ICYmIHYzLnogPT09IHcuejtcbiAgICAgIH07XG4gICAgICBWZWMzMi5kb3QgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gdjMueCAqIHcueCArIHYzLnkgKiB3LnkgKyB2My56ICogdy56O1xuICAgICAgfTtcbiAgICAgIFZlYzMyLmNyb3NzID0gZnVuY3Rpb24odjMsIHcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzMih2My55ICogdy56IC0gdjMueiAqIHcueSwgdjMueiAqIHcueCAtIHYzLnggKiB3LnosIHYzLnggKiB3LnkgLSB2My55ICogdy54KTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5hZGQgPSBmdW5jdGlvbih2Mywgdykge1xuICAgICAgICByZXR1cm4gbmV3IFZlYzMyKHYzLnggKyB3LngsIHYzLnkgKyB3LnksIHYzLnogKyB3LnopO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLnN1YiA9IGZ1bmN0aW9uKHYzLCB3KSB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjMzIodjMueCAtIHcueCwgdjMueSAtIHcueSwgdjMueiAtIHcueik7XG4gICAgICB9O1xuICAgICAgVmVjMzIubXVsID0gZnVuY3Rpb24odjMsIG0pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMzMihtICogdjMueCwgbSAqIHYzLnksIG0gKiB2My56KTtcbiAgICAgIH07XG4gICAgICBWZWMzMi5wcm90b3R5cGUubmVnID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMueCA9IC10aGlzLng7XG4gICAgICAgIHRoaXMueSA9IC10aGlzLnk7XG4gICAgICAgIHRoaXMueiA9IC10aGlzLno7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIFZlYzMyLm5lZyA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjMzIoLXYzLngsIC12My55LCAtdjMueik7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFZlYzMyO1xuICAgIH0oKVxuICApO1xuICB2YXIgdjEkMiA9IHZlYzIoMCwgMCk7XG4gIHZhciB2MiQxID0gdmVjMigwLCAwKTtcbiAgdmFyIEVkZ2VTaGFwZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoRWRnZVNoYXBlMiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIEVkZ2VTaGFwZTIodjEyMiwgdjIyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgRWRnZVNoYXBlMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEVkZ2VTaGFwZTIodjEyMiwgdjIyKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IEVkZ2VTaGFwZTIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9yYWRpdXMgPSBTZXR0aW5nc0ludGVybmFsLnBvbHlnb25SYWRpdXM7XG4gICAgICAgIF90aGlzLm1fdmVydGV4MSA9IHYxMjIgPyBWZWMyLmNsb25lKHYxMjIpIDogVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fdmVydGV4MiA9IHYyMiA/IFZlYzIuY2xvbmUodjIyKSA6IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX3ZlcnRleDAgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV92ZXJ0ZXgzID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1faGFzVmVydGV4MCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5tX2hhc1ZlcnRleDMgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIHZlcnRleDE6IHRoaXMubV92ZXJ0ZXgxLFxuICAgICAgICAgIHZlcnRleDI6IHRoaXMubV92ZXJ0ZXgyLFxuICAgICAgICAgIHZlcnRleDA6IHRoaXMubV92ZXJ0ZXgwLFxuICAgICAgICAgIHZlcnRleDM6IHRoaXMubV92ZXJ0ZXgzLFxuICAgICAgICAgIGhhc1ZlcnRleDA6IHRoaXMubV9oYXNWZXJ0ZXgwLFxuICAgICAgICAgIGhhc1ZlcnRleDM6IHRoaXMubV9oYXNWZXJ0ZXgzXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHZhciBzaGFwZSA9IG5ldyBFZGdlU2hhcGUyKGRhdGEudmVydGV4MSwgZGF0YS52ZXJ0ZXgyKTtcbiAgICAgICAgaWYgKHNoYXBlLm1faGFzVmVydGV4MCkge1xuICAgICAgICAgIHNoYXBlLnNldFByZXZWZXJ0ZXgoZGF0YS52ZXJ0ZXgwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2hhcGUubV9oYXNWZXJ0ZXgzKSB7XG4gICAgICAgICAgc2hhcGUuc2V0TmV4dFZlcnRleChkYXRhLnZlcnRleDMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaGFwZTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5nZXRSYWRpdXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuc2V0TmV4dCA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldE5leHRWZXJ0ZXgodjMpO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLnNldE5leHRWZXJ0ZXggPSBmdW5jdGlvbih2Mykge1xuICAgICAgICBpZiAodjMpIHtcbiAgICAgICAgICB0aGlzLm1fdmVydGV4My5zZXRWZWMyKHYzKTtcbiAgICAgICAgICB0aGlzLm1faGFzVmVydGV4MyA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3ZlcnRleDMuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9oYXNWZXJ0ZXgzID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuZ2V0TmV4dFZlcnRleCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRleDM7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuc2V0UHJldiA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldFByZXZWZXJ0ZXgodjMpO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLnNldFByZXZWZXJ0ZXggPSBmdW5jdGlvbih2Mykge1xuICAgICAgICBpZiAodjMpIHtcbiAgICAgICAgICB0aGlzLm1fdmVydGV4MC5zZXRWZWMyKHYzKTtcbiAgICAgICAgICB0aGlzLm1faGFzVmVydGV4MCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3ZlcnRleDAuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9oYXNWZXJ0ZXgwID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuZ2V0UHJldlZlcnRleCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRleDA7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuX3NldCA9IGZ1bmN0aW9uKHYxMjIsIHYyMikge1xuICAgICAgICB0aGlzLm1fdmVydGV4MS5zZXRWZWMyKHYxMjIpO1xuICAgICAgICB0aGlzLm1fdmVydGV4Mi5zZXRWZWMyKHYyMik7XG4gICAgICAgIHRoaXMubV9oYXNWZXJ0ZXgwID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9oYXNWZXJ0ZXgzID0gZmFsc2U7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLl9jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgRWRnZVNoYXBlMigpO1xuICAgICAgICBjbG9uZS5tX3R5cGUgPSB0aGlzLm1fdHlwZTtcbiAgICAgICAgY2xvbmUubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgICBjbG9uZS5tX3ZlcnRleDEuc2V0VmVjMih0aGlzLm1fdmVydGV4MSk7XG4gICAgICAgIGNsb25lLm1fdmVydGV4Mi5zZXRWZWMyKHRoaXMubV92ZXJ0ZXgyKTtcbiAgICAgICAgY2xvbmUubV92ZXJ0ZXgwLnNldFZlYzIodGhpcy5tX3ZlcnRleDApO1xuICAgICAgICBjbG9uZS5tX3ZlcnRleDMuc2V0VmVjMih0aGlzLm1fdmVydGV4Myk7XG4gICAgICAgIGNsb25lLm1faGFzVmVydGV4MCA9IHRoaXMubV9oYXNWZXJ0ZXgwO1xuICAgICAgICBjbG9uZS5tX2hhc1ZlcnRleDMgPSB0aGlzLm1faGFzVmVydGV4MztcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmdldENoaWxkQ291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUudGVzdFBvaW50ID0gZnVuY3Rpb24oeGYyLCBwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdmFyIHAxID0gUm90Lm11bFRWZWMyKHhmMi5xLCBWZWMyLnN1YihpbnB1dDIucDEsIHhmMi5wKSk7XG4gICAgICAgIHZhciBwMiA9IFJvdC5tdWxUVmVjMih4ZjIucSwgVmVjMi5zdWIoaW5wdXQyLnAyLCB4ZjIucCkpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihwMiwgcDEpO1xuICAgICAgICB2YXIgdjEyMiA9IHRoaXMubV92ZXJ0ZXgxO1xuICAgICAgICB2YXIgdjIyID0gdGhpcy5tX3ZlcnRleDI7XG4gICAgICAgIHZhciBlMyA9IFZlYzIuc3ViKHYyMiwgdjEyMik7XG4gICAgICAgIHZhciBub3JtYWwzID0gVmVjMi5uZW8oZTMueSwgLWUzLngpO1xuICAgICAgICBub3JtYWwzLm5vcm1hbGl6ZSgpO1xuICAgICAgICB2YXIgbnVtZXJhdG9yID0gVmVjMi5kb3Qobm9ybWFsMywgVmVjMi5zdWIodjEyMiwgcDEpKTtcbiAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gVmVjMi5kb3Qobm9ybWFsMywgZDIpO1xuICAgICAgICBpZiAoZGVub21pbmF0b3IgPT0gMCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdCA9IG51bWVyYXRvciAvIGRlbm9taW5hdG9yO1xuICAgICAgICBpZiAodCA8IDAgfHwgaW5wdXQyLm1heEZyYWN0aW9uIDwgdCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcSA9IFZlYzIuYWRkKHAxLCBWZWMyLm11bE51bVZlYzIodCwgZDIpKTtcbiAgICAgICAgdmFyIHIgPSBWZWMyLnN1Yih2MjIsIHYxMjIpO1xuICAgICAgICB2YXIgcnIgPSBWZWMyLmRvdChyLCByKTtcbiAgICAgICAgaWYgKHJyID09IDApIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHMyID0gVmVjMi5kb3QoVmVjMi5zdWIocSwgdjEyMiksIHIpIC8gcnI7XG4gICAgICAgIGlmIChzMiA8IDAgfHwgMSA8IHMyKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIG91dHB1dDIuZnJhY3Rpb24gPSB0O1xuICAgICAgICBpZiAobnVtZXJhdG9yID4gMCkge1xuICAgICAgICAgIG91dHB1dDIubm9ybWFsID0gUm90Lm11bFZlYzIoeGYyLnEsIG5vcm1hbDMpLm5lZygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG91dHB1dDIubm9ybWFsID0gUm90Lm11bFZlYzIoeGYyLnEsIG5vcm1hbDMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmNvbXB1dGVBQUJCID0gZnVuY3Rpb24oYWFiYiwgeGYyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHRyYW5zZm9ybVZlYzIodjEkMiwgeGYyLCB0aGlzLm1fdmVydGV4MSk7XG4gICAgICAgIHRyYW5zZm9ybVZlYzIodjIkMSwgeGYyLCB0aGlzLm1fdmVydGV4Mik7XG4gICAgICAgIEFBQkIuY29tYmluZVBvaW50cyhhYWJiLCB2MSQyLCB2MiQxKTtcbiAgICAgICAgQUFCQi5leHRlbmQoYWFiYiwgdGhpcy5tX3JhZGl1cyk7XG4gICAgICB9O1xuICAgICAgRWRnZVNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZU1hc3MgPSBmdW5jdGlvbihtYXNzRGF0YSwgZGVuc2l0eSkge1xuICAgICAgICBtYXNzRGF0YS5tYXNzID0gMDtcbiAgICAgICAgY29tYmluZTJWZWMyKG1hc3NEYXRhLmNlbnRlciwgMC41LCB0aGlzLm1fdmVydGV4MSwgMC41LCB0aGlzLm1fdmVydGV4Mik7XG4gICAgICAgIG1hc3NEYXRhLkkgPSAwO1xuICAgICAgfTtcbiAgICAgIEVkZ2VTaGFwZTIucHJvdG90eXBlLmNvbXB1dGVEaXN0YW5jZVByb3h5ID0gZnVuY3Rpb24ocHJveHkpIHtcbiAgICAgICAgcHJveHkubV92ZXJ0aWNlc1swXSA9IHRoaXMubV92ZXJ0ZXgxO1xuICAgICAgICBwcm94eS5tX3ZlcnRpY2VzWzFdID0gdGhpcy5tX3ZlcnRleDI7XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXMubGVuZ3RoID0gMjtcbiAgICAgICAgcHJveHkubV9jb3VudCA9IDI7XG4gICAgICAgIHByb3h5Lm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBFZGdlU2hhcGUyLlRZUEUgPSBcImVkZ2VcIjtcbiAgICAgIHJldHVybiBFZGdlU2hhcGUyO1xuICAgIH0oU2hhcGUpXG4gICk7XG4gIHZhciB2MSQxID0gdmVjMigwLCAwKTtcbiAgdmFyIHYyID0gdmVjMigwLCAwKTtcbiAgdmFyIENoYWluU2hhcGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKENoYWluU2hhcGUyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gQ2hhaW5TaGFwZTIodmVydGljZXMsIGxvb3ApIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBDaGFpblNoYXBlMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IENoYWluU2hhcGUyKHZlcnRpY2VzLCBsb29wKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IENoYWluU2hhcGUyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fcmFkaXVzID0gU2V0dGluZ3NJbnRlcm5hbC5wb2x5Z29uUmFkaXVzO1xuICAgICAgICBfdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIF90aGlzLm1fY291bnQgPSAwO1xuICAgICAgICBfdGhpcy5tX3ByZXZWZXJ0ZXggPSBudWxsO1xuICAgICAgICBfdGhpcy5tX25leHRWZXJ0ZXggPSBudWxsO1xuICAgICAgICBfdGhpcy5tX2hhc1ByZXZWZXJ0ZXggPSBmYWxzZTtcbiAgICAgICAgX3RoaXMubV9oYXNOZXh0VmVydGV4ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLm1faXNMb29wID0gISFsb29wO1xuICAgICAgICBpZiAodmVydGljZXMgJiYgdmVydGljZXMubGVuZ3RoKSB7XG4gICAgICAgICAgaWYgKGxvb3ApIHtcbiAgICAgICAgICAgIF90aGlzLl9jcmVhdGVMb29wKHZlcnRpY2VzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX3RoaXMuX2NyZWF0ZUNoYWluKHZlcnRpY2VzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgdmVydGljZXM6IHRoaXMubV9pc0xvb3AgPyB0aGlzLm1fdmVydGljZXMuc2xpY2UoMCwgdGhpcy5tX3ZlcnRpY2VzLmxlbmd0aCAtIDEpIDogdGhpcy5tX3ZlcnRpY2VzLFxuICAgICAgICAgIGlzTG9vcDogdGhpcy5tX2lzTG9vcCxcbiAgICAgICAgICBoYXNQcmV2VmVydGV4OiB0aGlzLm1faGFzUHJldlZlcnRleCxcbiAgICAgICAgICBoYXNOZXh0VmVydGV4OiB0aGlzLm1faGFzTmV4dFZlcnRleCxcbiAgICAgICAgICBwcmV2VmVydGV4OiBudWxsLFxuICAgICAgICAgIG5leHRWZXJ0ZXg6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMubV9wcmV2VmVydGV4KSB7XG4gICAgICAgICAgZGF0YS5wcmV2VmVydGV4ID0gdGhpcy5tX3ByZXZWZXJ0ZXg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9uZXh0VmVydGV4KSB7XG4gICAgICAgICAgZGF0YS5uZXh0VmVydGV4ID0gdGhpcy5tX25leHRWZXJ0ZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgZml4dHVyZSwgcmVzdG9yZSkge1xuICAgICAgICB2YXIgdmVydGljZXMgPSBbXTtcbiAgICAgICAgaWYgKGRhdGEudmVydGljZXMpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEudmVydGljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZlcnRpY2VzLnB1c2gocmVzdG9yZShWZWMyLCBkYXRhLnZlcnRpY2VzW2ldKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBzaGFwZSA9IG5ldyBDaGFpblNoYXBlMih2ZXJ0aWNlcywgZGF0YS5pc0xvb3ApO1xuICAgICAgICBpZiAoZGF0YS5wcmV2VmVydGV4KSB7XG4gICAgICAgICAgc2hhcGUuc2V0UHJldlZlcnRleChkYXRhLnByZXZWZXJ0ZXgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRhLm5leHRWZXJ0ZXgpIHtcbiAgICAgICAgICBzaGFwZS5zZXROZXh0VmVydGV4KGRhdGEubmV4dFZlcnRleCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNoYXBlO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuZ2V0UmFkaXVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5fY3JlYXRlTG9vcCA9IGZ1bmN0aW9uKHZlcnRpY2VzKSB7XG4gICAgICAgIGlmICh2ZXJ0aWNlcy5sZW5ndGggPCAzKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpO1xuICAgICAgICB0aGlzLm1fdmVydGljZXMgPSBbXTtcbiAgICAgICAgdGhpcy5tX2NvdW50ID0gdmVydGljZXMubGVuZ3RoICsgMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2ZXJ0aWNlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXSA9IFZlYzIuY2xvbmUodmVydGljZXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlc1t2ZXJ0aWNlcy5sZW5ndGhdID0gVmVjMi5jbG9uZSh2ZXJ0aWNlc1swXSk7XG4gICAgICAgIHRoaXMubV9wcmV2VmVydGV4ID0gdGhpcy5tX3ZlcnRpY2VzW3RoaXMubV9jb3VudCAtIDJdO1xuICAgICAgICB0aGlzLm1fbmV4dFZlcnRleCA9IHRoaXMubV92ZXJ0aWNlc1sxXTtcbiAgICAgICAgdGhpcy5tX2hhc1ByZXZWZXJ0ZXggPSB0cnVlO1xuICAgICAgICB0aGlzLm1faGFzTmV4dFZlcnRleCA9IHRydWU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5fY3JlYXRlQ2hhaW4gPSBmdW5jdGlvbih2ZXJ0aWNlcykge1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIHRoaXMubV9jb3VudCA9IHZlcnRpY2VzLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2ZXJ0aWNlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXSA9IFZlYzIuY2xvbmUodmVydGljZXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9wcmV2VmVydGV4ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX25leHRWZXJ0ZXggPSBudWxsO1xuICAgICAgICB0aGlzLm1faGFzUHJldlZlcnRleCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1faGFzTmV4dFZlcnRleCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm1faXNMb29wKSB7XG4gICAgICAgICAgdGhpcy5fY3JlYXRlTG9vcCh0aGlzLm1fdmVydGljZXMuc2xpY2UoMCwgdGhpcy5tX3ZlcnRpY2VzLmxlbmd0aCAtIDEpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9jcmVhdGVDaGFpbih0aGlzLm1fdmVydGljZXMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLnNldFByZXZWZXJ0ZXggPSBmdW5jdGlvbihwcmV2VmVydGV4KSB7XG4gICAgICAgIHRoaXMubV9wcmV2VmVydGV4ID0gcHJldlZlcnRleDtcbiAgICAgICAgdGhpcy5tX2hhc1ByZXZWZXJ0ZXggPSB0cnVlO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRQcmV2VmVydGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcHJldlZlcnRleDtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUuc2V0TmV4dFZlcnRleCA9IGZ1bmN0aW9uKG5leHRWZXJ0ZXgpIHtcbiAgICAgICAgdGhpcy5tX25leHRWZXJ0ZXggPSBuZXh0VmVydGV4O1xuICAgICAgICB0aGlzLm1faGFzTmV4dFZlcnRleCA9IHRydWU7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmdldE5leHRWZXJ0ZXggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9uZXh0VmVydGV4O1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5fY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNsb25lID0gbmV3IENoYWluU2hhcGUyKCk7XG4gICAgICAgIGNsb25lLl9jcmVhdGVDaGFpbih0aGlzLm1fdmVydGljZXMpO1xuICAgICAgICBjbG9uZS5tX3R5cGUgPSB0aGlzLm1fdHlwZTtcbiAgICAgICAgY2xvbmUubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgICBjbG9uZS5tX3ByZXZWZXJ0ZXggPSB0aGlzLm1fcHJldlZlcnRleDtcbiAgICAgICAgY2xvbmUubV9uZXh0VmVydGV4ID0gdGhpcy5tX25leHRWZXJ0ZXg7XG4gICAgICAgIGNsb25lLm1faGFzUHJldlZlcnRleCA9IHRoaXMubV9oYXNQcmV2VmVydGV4O1xuICAgICAgICBjbG9uZS5tX2hhc05leHRWZXJ0ZXggPSB0aGlzLm1faGFzTmV4dFZlcnRleDtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRDaGlsZENvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fY291bnQgLSAxO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRDaGlsZEVkZ2UgPSBmdW5jdGlvbihlZGdlLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIGVkZ2UubV90eXBlID0gRWRnZVNoYXBlLlRZUEU7XG4gICAgICAgIGVkZ2UubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgICBlZGdlLm1fdmVydGV4MSA9IHRoaXMubV92ZXJ0aWNlc1tjaGlsZEluZGV4XTtcbiAgICAgICAgZWRnZS5tX3ZlcnRleDIgPSB0aGlzLm1fdmVydGljZXNbY2hpbGRJbmRleCArIDFdO1xuICAgICAgICBpZiAoY2hpbGRJbmRleCA+IDApIHtcbiAgICAgICAgICBlZGdlLm1fdmVydGV4MCA9IHRoaXMubV92ZXJ0aWNlc1tjaGlsZEluZGV4IC0gMV07XG4gICAgICAgICAgZWRnZS5tX2hhc1ZlcnRleDAgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVkZ2UubV92ZXJ0ZXgwID0gdGhpcy5tX3ByZXZWZXJ0ZXg7XG4gICAgICAgICAgZWRnZS5tX2hhc1ZlcnRleDAgPSB0aGlzLm1faGFzUHJldlZlcnRleDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hpbGRJbmRleCA8IHRoaXMubV9jb3VudCAtIDIpIHtcbiAgICAgICAgICBlZGdlLm1fdmVydGV4MyA9IHRoaXMubV92ZXJ0aWNlc1tjaGlsZEluZGV4ICsgMl07XG4gICAgICAgICAgZWRnZS5tX2hhc1ZlcnRleDMgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVkZ2UubV92ZXJ0ZXgzID0gdGhpcy5tX25leHRWZXJ0ZXg7XG4gICAgICAgICAgZWRnZS5tX2hhc1ZlcnRleDMgPSB0aGlzLm1faGFzTmV4dFZlcnRleDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5nZXRWZXJ0ZXggPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICBpZiAoaW5kZXggPCB0aGlzLm1fY291bnQpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzW2luZGV4XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzWzBdO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmlzTG9vcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2lzTG9vcDtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUudGVzdFBvaW50ID0gZnVuY3Rpb24oeGYyLCBwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5wcm90b3R5cGUucmF5Q2FzdCA9IGZ1bmN0aW9uKG91dHB1dDIsIGlucHV0MiwgeGYyLCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHZhciBlZGdlU2hhcGUgPSBuZXcgRWRnZVNoYXBlKHRoaXMuZ2V0VmVydGV4KGNoaWxkSW5kZXgpLCB0aGlzLmdldFZlcnRleChjaGlsZEluZGV4ICsgMSkpO1xuICAgICAgICByZXR1cm4gZWRnZVNoYXBlLnJheUNhc3Qob3V0cHV0MiwgaW5wdXQyLCB4ZjIsIDApO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlQUFCQiA9IGZ1bmN0aW9uKGFhYmIsIHhmMiwgY2hpbGRJbmRleCkge1xuICAgICAgICB0cmFuc2Zvcm1WZWMyKHYxJDEsIHhmMiwgdGhpcy5nZXRWZXJ0ZXgoY2hpbGRJbmRleCkpO1xuICAgICAgICB0cmFuc2Zvcm1WZWMyKHYyLCB4ZjIsIHRoaXMuZ2V0VmVydGV4KGNoaWxkSW5kZXggKyAxKSk7XG4gICAgICAgIEFBQkIuY29tYmluZVBvaW50cyhhYWJiLCB2MSQxLCB2Mik7XG4gICAgICB9O1xuICAgICAgQ2hhaW5TaGFwZTIucHJvdG90eXBlLmNvbXB1dGVNYXNzID0gZnVuY3Rpb24obWFzc0RhdGEsIGRlbnNpdHkpIHtcbiAgICAgICAgbWFzc0RhdGEubWFzcyA9IDA7XG4gICAgICAgIHplcm9WZWMyKG1hc3NEYXRhLmNlbnRlcik7XG4gICAgICAgIG1hc3NEYXRhLkkgPSAwO1xuICAgICAgfTtcbiAgICAgIENoYWluU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlRGlzdGFuY2VQcm94eSA9IGZ1bmN0aW9uKHByb3h5LCBjaGlsZEluZGV4KSB7XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXNbMF0gPSB0aGlzLmdldFZlcnRleChjaGlsZEluZGV4KTtcbiAgICAgICAgcHJveHkubV92ZXJ0aWNlc1sxXSA9IHRoaXMuZ2V0VmVydGV4KGNoaWxkSW5kZXggKyAxKTtcbiAgICAgICAgcHJveHkubV9jb3VudCA9IDI7XG4gICAgICAgIHByb3h5Lm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBDaGFpblNoYXBlMi5UWVBFID0gXCJjaGFpblwiO1xuICAgICAgcmV0dXJuIENoYWluU2hhcGUyO1xuICAgIH0oU2hhcGUpXG4gICk7XG4gIHZhciBtYXRoX21heCQxID0gTWF0aC5tYXg7XG4gIHZhciBtYXRoX21pbiQzID0gTWF0aC5taW47XG4gIHZhciB0ZW1wJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgZSQxID0gdmVjMigwLCAwKTtcbiAgdmFyIGUxJDEgPSB2ZWMyKDAsIDApO1xuICB2YXIgZTIkMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBjZW50ZXIgPSB2ZWMyKDAsIDApO1xuICB2YXIgcyA9IHZlYzIoMCwgMCk7XG4gIHZhciBQb2x5Z29uU2hhcGUgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFBvbHlnb25TaGFwZTIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBQb2x5Z29uU2hhcGUyKHZlcnRpY2VzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgUG9seWdvblNoYXBlMikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFBvbHlnb25TaGFwZTIodmVydGljZXMpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMubV90eXBlID0gUG9seWdvblNoYXBlMi5UWVBFO1xuICAgICAgICBfdGhpcy5tX3JhZGl1cyA9IFNldHRpbmdzSW50ZXJuYWwucG9seWdvblJhZGl1cztcbiAgICAgICAgX3RoaXMubV9jZW50cm9pZCA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIF90aGlzLm1fbm9ybWFscyA9IFtdO1xuICAgICAgICBfdGhpcy5tX2NvdW50ID0gMDtcbiAgICAgICAgaWYgKHZlcnRpY2VzICYmIHZlcnRpY2VzLmxlbmd0aCkge1xuICAgICAgICAgIF90aGlzLl9zZXQodmVydGljZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICB2ZXJ0aWNlczogdGhpcy5tX3ZlcnRpY2VzXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCBmaXh0dXJlLCByZXN0b3JlKSB7XG4gICAgICAgIHZhciB2ZXJ0aWNlcyA9IFtdO1xuICAgICAgICBpZiAoZGF0YS52ZXJ0aWNlcykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS52ZXJ0aWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmVydGljZXMucHVzaChyZXN0b3JlKFZlYzIsIGRhdGEudmVydGljZXNbaV0pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNoYXBlID0gbmV3IFBvbHlnb25TaGFwZTIodmVydGljZXMpO1xuICAgICAgICByZXR1cm4gc2hhcGU7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuZ2V0UmFkaXVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLl9jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgUG9seWdvblNoYXBlMigpO1xuICAgICAgICBjbG9uZS5tX3R5cGUgPSB0aGlzLm1fdHlwZTtcbiAgICAgICAgY2xvbmUubV9yYWRpdXMgPSB0aGlzLm1fcmFkaXVzO1xuICAgICAgICBjbG9uZS5tX2NvdW50ID0gdGhpcy5tX2NvdW50O1xuICAgICAgICBjbG9uZS5tX2NlbnRyb2lkLnNldFZlYzIodGhpcy5tX2NlbnRyb2lkKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7IGkrKykge1xuICAgICAgICAgIGNsb25lLm1fdmVydGljZXMucHVzaCh0aGlzLm1fdmVydGljZXNbaV0uY2xvbmUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fbm9ybWFscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNsb25lLm1fbm9ybWFscy5wdXNoKHRoaXMubV9ub3JtYWxzW2ldLmNsb25lKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5nZXRDaGlsZENvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9zZXQodGhpcy5tX3ZlcnRpY2VzKTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5fc2V0ID0gZnVuY3Rpb24odmVydGljZXMpIHtcbiAgICAgICAgaWYgKHZlcnRpY2VzLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgICB0aGlzLl9zZXRBc0JveCgxLCAxKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG4yID0gbWF0aF9taW4kMyh2ZXJ0aWNlcy5sZW5ndGgsIFNldHRpbmdzSW50ZXJuYWwubWF4UG9seWdvblZlcnRpY2VzKTtcbiAgICAgICAgdmFyIHBzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjI7ICsraSkge1xuICAgICAgICAgIHZhciB2MyA9IHZlcnRpY2VzW2ldO1xuICAgICAgICAgIHZhciB1bmlxdWUgPSB0cnVlO1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcHMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIGlmIChWZWMyLmRpc3RhbmNlU3F1YXJlZCh2MywgcHNbal0pIDwgMC4yNSAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcFNxdWFyZWQpIHtcbiAgICAgICAgICAgICAgdW5pcXVlID0gZmFsc2U7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodW5pcXVlKSB7XG4gICAgICAgICAgICBwcy5wdXNoKFZlYzIuY2xvbmUodjMpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbjIgPSBwcy5sZW5ndGg7XG4gICAgICAgIGlmIChuMiA8IDMpIHtcbiAgICAgICAgICB0aGlzLl9zZXRBc0JveCgxLCAxKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGkwID0gMDtcbiAgICAgICAgdmFyIHgwID0gcHNbMF0ueDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBuMjsgKytpKSB7XG4gICAgICAgICAgdmFyIHgyID0gcHNbaV0ueDtcbiAgICAgICAgICBpZiAoeDIgPiB4MCB8fCB4MiA9PT0geDAgJiYgcHNbaV0ueSA8IHBzW2kwXS55KSB7XG4gICAgICAgICAgICBpMCA9IGk7XG4gICAgICAgICAgICB4MCA9IHgyO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgaHVsbCA9IFtdO1xuICAgICAgICB2YXIgbSA9IDA7XG4gICAgICAgIHZhciBpaCA9IGkwO1xuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgIGh1bGxbbV0gPSBpaDtcbiAgICAgICAgICB2YXIgaWUyID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IG4yOyArK2opIHtcbiAgICAgICAgICAgIGlmIChpZTIgPT09IGloKSB7XG4gICAgICAgICAgICAgIGllMiA9IGo7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHIgPSBWZWMyLnN1Yihwc1tpZTJdLCBwc1todWxsW21dXSk7XG4gICAgICAgICAgICB2YXIgdjMgPSBWZWMyLnN1Yihwc1tqXSwgcHNbaHVsbFttXV0pO1xuICAgICAgICAgICAgdmFyIGMyID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHIsIHYzKTtcbiAgICAgICAgICAgIGlmIChjMiA8IDApIHtcbiAgICAgICAgICAgICAgaWUyID0gajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjMiA9PT0gMCAmJiB2My5sZW5ndGhTcXVhcmVkKCkgPiByLmxlbmd0aFNxdWFyZWQoKSkge1xuICAgICAgICAgICAgICBpZTIgPSBqO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICArK207XG4gICAgICAgICAgaWggPSBpZTI7XG4gICAgICAgICAgaWYgKGllMiA9PT0gaTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobSA8IDMpIHtcbiAgICAgICAgICB0aGlzLl9zZXRBc0JveCgxLCAxKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2NvdW50ID0gbTtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbTsgKytpKSB7XG4gICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldID0gcHNbaHVsbFtpXV07XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtOyArK2kpIHtcbiAgICAgICAgICB2YXIgaTEgPSBpO1xuICAgICAgICAgIHZhciBpMiA9IGkgKyAxIDwgbSA/IGkgKyAxIDogMDtcbiAgICAgICAgICB2YXIgZWRnZSA9IFZlYzIuc3ViKHRoaXMubV92ZXJ0aWNlc1tpMl0sIHRoaXMubV92ZXJ0aWNlc1tpMV0pO1xuICAgICAgICAgIHRoaXMubV9ub3JtYWxzW2ldID0gVmVjMi5jcm9zc1ZlYzJOdW0oZWRnZSwgMSk7XG4gICAgICAgICAgdGhpcy5tX25vcm1hbHNbaV0ubm9ybWFsaXplKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2NlbnRyb2lkID0gY29tcHV0ZUNlbnRyb2lkKHRoaXMubV92ZXJ0aWNlcywgbSk7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5wcm90b3R5cGUuX3NldEFzQm94ID0gZnVuY3Rpb24oaHgsIGh5LCBjZW50ZXIyLCBhbmdsZSkge1xuICAgICAgICB0aGlzLm1fdmVydGljZXNbMF0gPSBWZWMyLm5lbyhoeCwgLWh5KTtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzWzFdID0gVmVjMi5uZW8oaHgsIGh5KTtcbiAgICAgICAgdGhpcy5tX3ZlcnRpY2VzWzJdID0gVmVjMi5uZW8oLWh4LCBoeSk7XG4gICAgICAgIHRoaXMubV92ZXJ0aWNlc1szXSA9IFZlYzIubmVvKC1oeCwgLWh5KTtcbiAgICAgICAgdGhpcy5tX25vcm1hbHNbMF0gPSBWZWMyLm5lbygxLCAwKTtcbiAgICAgICAgdGhpcy5tX25vcm1hbHNbMV0gPSBWZWMyLm5lbygwLCAxKTtcbiAgICAgICAgdGhpcy5tX25vcm1hbHNbMl0gPSBWZWMyLm5lbygtMSwgMCk7XG4gICAgICAgIHRoaXMubV9ub3JtYWxzWzNdID0gVmVjMi5uZW8oMCwgLTEpO1xuICAgICAgICB0aGlzLm1fY291bnQgPSA0O1xuICAgICAgICBpZiAoY2VudGVyMiAmJiBWZWMyLmlzVmFsaWQoY2VudGVyMikpIHtcbiAgICAgICAgICBhbmdsZSA9IGFuZ2xlIHx8IDA7XG4gICAgICAgICAgY29weVZlYzIodGhpcy5tX2NlbnRyb2lkLCBjZW50ZXIyKTtcbiAgICAgICAgICB2YXIgeGYyID0gVHJhbnNmb3JtLmlkZW50aXR5KCk7XG4gICAgICAgICAgeGYyLnAuc2V0VmVjMihjZW50ZXIyKTtcbiAgICAgICAgICB4ZjIucS5zZXRBbmdsZShhbmdsZSk7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldID0gVHJhbnNmb3JtLm11bFZlYzIoeGYyLCB0aGlzLm1fdmVydGljZXNbaV0pO1xuICAgICAgICAgICAgdGhpcy5tX25vcm1hbHNbaV0gPSBSb3QubXVsVmVjMih4ZjIucSwgdGhpcy5tX25vcm1hbHNbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFBvbHlnb25TaGFwZTIucHJvdG90eXBlLnRlc3RQb2ludCA9IGZ1bmN0aW9uKHhmMiwgcCkge1xuICAgICAgICB2YXIgcExvY2FsID0gZGV0cmFuc2Zvcm1WZWMyKHRlbXAkMSwgeGYyLCBwKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHZhciBkb3QgPSBkb3RWZWMyKHRoaXMubV9ub3JtYWxzW2ldLCBwTG9jYWwpIC0gZG90VmVjMih0aGlzLm1fbm9ybWFsc1tpXSwgdGhpcy5tX3ZlcnRpY2VzW2ldKTtcbiAgICAgICAgICBpZiAoZG90ID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdmFyIHAxID0gUm90Lm11bFRWZWMyKHhmMi5xLCBWZWMyLnN1YihpbnB1dDIucDEsIHhmMi5wKSk7XG4gICAgICAgIHZhciBwMiA9IFJvdC5tdWxUVmVjMih4ZjIucSwgVmVjMi5zdWIoaW5wdXQyLnAyLCB4ZjIucCkpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihwMiwgcDEpO1xuICAgICAgICB2YXIgbG93ZXIgPSAwO1xuICAgICAgICB2YXIgdXBwZXIgPSBpbnB1dDIubWF4RnJhY3Rpb247XG4gICAgICAgIHZhciBpbmRleCA9IC0xO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIG51bWVyYXRvciA9IFZlYzIuZG90KHRoaXMubV9ub3JtYWxzW2ldLCBWZWMyLnN1Yih0aGlzLm1fdmVydGljZXNbaV0sIHAxKSk7XG4gICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gVmVjMi5kb3QodGhpcy5tX25vcm1hbHNbaV0sIGQyKTtcbiAgICAgICAgICBpZiAoZGVub21pbmF0b3IgPT0gMCkge1xuICAgICAgICAgICAgaWYgKG51bWVyYXRvciA8IDApIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoZGVub21pbmF0b3IgPCAwICYmIG51bWVyYXRvciA8IGxvd2VyICogZGVub21pbmF0b3IpIHtcbiAgICAgICAgICAgICAgbG93ZXIgPSBudW1lcmF0b3IgLyBkZW5vbWluYXRvcjtcbiAgICAgICAgICAgICAgaW5kZXggPSBpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkZW5vbWluYXRvciA+IDAgJiYgbnVtZXJhdG9yIDwgdXBwZXIgKiBkZW5vbWluYXRvcikge1xuICAgICAgICAgICAgICB1cHBlciA9IG51bWVyYXRvciAvIGRlbm9taW5hdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodXBwZXIgPCBsb3dlcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgIG91dHB1dDIuZnJhY3Rpb24gPSBsb3dlcjtcbiAgICAgICAgICBvdXRwdXQyLm5vcm1hbCA9IFJvdC5tdWxWZWMyKHhmMi5xLCB0aGlzLm1fbm9ybWFsc1tpbmRleF0pO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlQUFCQiA9IGZ1bmN0aW9uKGFhYmIsIHhmMiwgY2hpbGRJbmRleCkge1xuICAgICAgICB2YXIgbWluWCA9IEluZmluaXR5O1xuICAgICAgICB2YXIgbWluWSA9IEluZmluaXR5O1xuICAgICAgICB2YXIgbWF4WCA9IC1JbmZpbml0eTtcbiAgICAgICAgdmFyIG1heFkgPSAtSW5maW5pdHk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICB2YXIgdjMgPSB0cmFuc2Zvcm1WZWMyKHRlbXAkMSwgeGYyLCB0aGlzLm1fdmVydGljZXNbaV0pO1xuICAgICAgICAgIG1pblggPSBtYXRoX21pbiQzKG1pblgsIHYzLngpO1xuICAgICAgICAgIG1heFggPSBtYXRoX21heCQxKG1heFgsIHYzLngpO1xuICAgICAgICAgIG1pblkgPSBtYXRoX21pbiQzKG1pblksIHYzLnkpO1xuICAgICAgICAgIG1heFkgPSBtYXRoX21heCQxKG1heFksIHYzLnkpO1xuICAgICAgICB9XG4gICAgICAgIHNldFZlYzIoYWFiYi5sb3dlckJvdW5kLCBtaW5YIC0gdGhpcy5tX3JhZGl1cywgbWluWSAtIHRoaXMubV9yYWRpdXMpO1xuICAgICAgICBzZXRWZWMyKGFhYmIudXBwZXJCb3VuZCwgbWF4WCArIHRoaXMubV9yYWRpdXMsIG1heFkgKyB0aGlzLm1fcmFkaXVzKTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlTWFzcyA9IGZ1bmN0aW9uKG1hc3NEYXRhLCBkZW5zaXR5KSB7XG4gICAgICAgIHplcm9WZWMyKGNlbnRlcik7XG4gICAgICAgIHZhciBhcmVhID0gMDtcbiAgICAgICAgdmFyIEkgPSAwO1xuICAgICAgICB6ZXJvVmVjMihzKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgIHBsdXNWZWMyKHMsIHRoaXMubV92ZXJ0aWNlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgc2NhbGVWZWMyKHMsIDEgLyB0aGlzLm1fY291bnQsIHMpO1xuICAgICAgICB2YXIga19pbnYzID0gMSAvIDM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICBzdWJWZWMyKGUxJDEsIHRoaXMubV92ZXJ0aWNlc1tpXSwgcyk7XG4gICAgICAgICAgaWYgKGkgKyAxIDwgdGhpcy5tX2NvdW50KSB7XG4gICAgICAgICAgICBzdWJWZWMyKGUyJDEsIHRoaXMubV92ZXJ0aWNlc1tpICsgMV0sIHMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWJWZWMyKGUyJDEsIHRoaXMubV92ZXJ0aWNlc1swXSwgcyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBEID0gY3Jvc3NWZWMyVmVjMihlMSQxLCBlMiQxKTtcbiAgICAgICAgICB2YXIgdHJpYW5nbGVBcmVhID0gMC41ICogRDtcbiAgICAgICAgICBhcmVhICs9IHRyaWFuZ2xlQXJlYTtcbiAgICAgICAgICBjb21iaW5lMlZlYzIodGVtcCQxLCB0cmlhbmdsZUFyZWEgKiBrX2ludjMsIGUxJDEsIHRyaWFuZ2xlQXJlYSAqIGtfaW52MywgZTIkMSk7XG4gICAgICAgICAgcGx1c1ZlYzIoY2VudGVyLCB0ZW1wJDEpO1xuICAgICAgICAgIHZhciBleDEgPSBlMSQxLng7XG4gICAgICAgICAgdmFyIGV5MSA9IGUxJDEueTtcbiAgICAgICAgICB2YXIgZXgyID0gZTIkMS54O1xuICAgICAgICAgIHZhciBleTIgPSBlMiQxLnk7XG4gICAgICAgICAgdmFyIGludHgyID0gZXgxICogZXgxICsgZXgyICogZXgxICsgZXgyICogZXgyO1xuICAgICAgICAgIHZhciBpbnR5MiA9IGV5MSAqIGV5MSArIGV5MiAqIGV5MSArIGV5MiAqIGV5MjtcbiAgICAgICAgICBJICs9IDAuMjUgKiBrX2ludjMgKiBEICogKGludHgyICsgaW50eTIpO1xuICAgICAgICB9XG4gICAgICAgIG1hc3NEYXRhLm1hc3MgPSBkZW5zaXR5ICogYXJlYTtcbiAgICAgICAgc2NhbGVWZWMyKGNlbnRlciwgMSAvIGFyZWEsIGNlbnRlcik7XG4gICAgICAgIGFkZFZlYzIobWFzc0RhdGEuY2VudGVyLCBjZW50ZXIsIHMpO1xuICAgICAgICBtYXNzRGF0YS5JID0gZGVuc2l0eSAqIEk7XG4gICAgICAgIG1hc3NEYXRhLkkgKz0gbWFzc0RhdGEubWFzcyAqIChkb3RWZWMyKG1hc3NEYXRhLmNlbnRlciwgbWFzc0RhdGEuY2VudGVyKSAtIGRvdFZlYzIoY2VudGVyLCBjZW50ZXIpKTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgKytpKSB7XG4gICAgICAgICAgdmFyIGkxID0gaTtcbiAgICAgICAgICB2YXIgaTIgPSBpIDwgdGhpcy5tX2NvdW50IC0gMSA/IGkxICsgMSA6IDA7XG4gICAgICAgICAgdmFyIHAgPSB0aGlzLm1fdmVydGljZXNbaTFdO1xuICAgICAgICAgIHN1YlZlYzIoZSQxLCB0aGlzLm1fdmVydGljZXNbaTJdLCBwKTtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9jb3VudDsgKytqKSB7XG4gICAgICAgICAgICBpZiAoaiA9PSBpMSB8fCBqID09IGkyKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGMyID0gY3Jvc3NWZWMyVmVjMihlJDEsIHN1YlZlYzIodGVtcCQxLCB0aGlzLm1fdmVydGljZXNbal0sIHApKTtcbiAgICAgICAgICAgIGlmIChjMiA8IDApIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBQb2x5Z29uU2hhcGUyLnByb3RvdHlwZS5jb21wdXRlRGlzdGFuY2VQcm94eSA9IGZ1bmN0aW9uKHByb3h5KSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcbiAgICAgICAgICBwcm94eS5tX3ZlcnRpY2VzW2ldID0gdGhpcy5tX3ZlcnRpY2VzW2ldO1xuICAgICAgICB9XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXMubGVuZ3RoID0gdGhpcy5tX2NvdW50O1xuICAgICAgICBwcm94eS5tX2NvdW50ID0gdGhpcy5tX2NvdW50O1xuICAgICAgICBwcm94eS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgUG9seWdvblNoYXBlMi5UWVBFID0gXCJwb2x5Z29uXCI7XG4gICAgICByZXR1cm4gUG9seWdvblNoYXBlMjtcbiAgICB9KFNoYXBlKVxuICApO1xuICBmdW5jdGlvbiBjb21wdXRlQ2VudHJvaWQodnMsIGNvdW50KSB7XG4gICAgdmFyIGMyID0gVmVjMi56ZXJvKCk7XG4gICAgdmFyIGFyZWEgPSAwO1xuICAgIHZhciBwUmVmID0gVmVjMi56ZXJvKCk7XG4gICAgdmFyIGk7XG4gICAgdmFyIGludjMgPSAxIC8gMztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyArK2kpIHtcbiAgICAgIHZhciBwMSA9IHBSZWY7XG4gICAgICB2YXIgcDIgPSB2c1tpXTtcbiAgICAgIHZhciBwMyA9IGkgKyAxIDwgY291bnQgPyB2c1tpICsgMV0gOiB2c1swXTtcbiAgICAgIHZhciBlMV8xID0gVmVjMi5zdWIocDIsIHAxKTtcbiAgICAgIHZhciBlMl8xID0gVmVjMi5zdWIocDMsIHAxKTtcbiAgICAgIHZhciBEID0gVmVjMi5jcm9zc1ZlYzJWZWMyKGUxXzEsIGUyXzEpO1xuICAgICAgdmFyIHRyaWFuZ2xlQXJlYSA9IDAuNSAqIEQ7XG4gICAgICBhcmVhICs9IHRyaWFuZ2xlQXJlYTtcbiAgICAgIGNvbWJpbmUzVmVjMih0ZW1wJDEsIDEsIHAxLCAxLCBwMiwgMSwgcDMpO1xuICAgICAgcGx1c1NjYWxlVmVjMihjMiwgdHJpYW5nbGVBcmVhICogaW52MywgdGVtcCQxKTtcbiAgICB9XG4gICAgYzIubXVsKDEgLyBhcmVhKTtcbiAgICByZXR1cm4gYzI7XG4gIH1cbiAgdmFyIG1hdGhfc3FydCA9IE1hdGguc3FydDtcbiAgdmFyIG1hdGhfUEkkNCA9IE1hdGguUEk7XG4gIHZhciB0ZW1wID0gdmVjMigwLCAwKTtcbiAgdmFyIENpcmNsZVNoYXBlID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhDaXJjbGVTaGFwZTIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBDaXJjbGVTaGFwZTIoYTIsIGIyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgQ2lyY2xlU2hhcGUyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgQ2lyY2xlU2hhcGUyKGEyLCBiMik7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBDaXJjbGVTaGFwZTIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9wID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fcmFkaXVzID0gMTtcbiAgICAgICAgaWYgKHR5cGVvZiBhMiA9PT0gXCJvYmplY3RcIiAmJiBWZWMyLmlzVmFsaWQoYTIpKSB7XG4gICAgICAgICAgX3RoaXMubV9wLnNldFZlYzIoYTIpO1xuICAgICAgICAgIGlmICh0eXBlb2YgYjIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIF90aGlzLm1fcmFkaXVzID0gYjI7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhMiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIF90aGlzLm1fcmFkaXVzID0gYTI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgcDogdGhpcy5tX3AsXG4gICAgICAgICAgcmFkaXVzOiB0aGlzLm1fcmFkaXVzXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDaXJjbGVTaGFwZTIoZGF0YS5wLCBkYXRhLnJhZGl1cyk7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90eXBlO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuZ2V0UmFkaXVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmFkaXVzO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuZ2V0Q2VudGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcDtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLl9jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgQ2lyY2xlU2hhcGUyKCk7XG4gICAgICAgIGNsb25lLm1fdHlwZSA9IHRoaXMubV90eXBlO1xuICAgICAgICBjbG9uZS5tX3JhZGl1cyA9IHRoaXMubV9yYWRpdXM7XG4gICAgICAgIGNsb25lLm1fcCA9IHRoaXMubV9wLmNsb25lKCk7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLmdldENoaWxkQ291bnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS50ZXN0UG9pbnQgPSBmdW5jdGlvbih4ZjIsIHApIHtcbiAgICAgICAgdmFyIGNlbnRlcjIgPSB0cmFuc2Zvcm1WZWMyKHRlbXAsIHhmMiwgdGhpcy5tX3ApO1xuICAgICAgICByZXR1cm4gZGlzdFNxclZlYzIocCwgY2VudGVyMikgPD0gdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXM7XG4gICAgICB9O1xuICAgICAgQ2lyY2xlU2hhcGUyLnByb3RvdHlwZS5yYXlDYXN0ID0gZnVuY3Rpb24ob3V0cHV0MiwgaW5wdXQyLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdmFyIHBvc2l0aW9uID0gVmVjMi5hZGQoeGYyLnAsIFJvdC5tdWxWZWMyKHhmMi5xLCB0aGlzLm1fcCkpO1xuICAgICAgICB2YXIgczIgPSBWZWMyLnN1YihpbnB1dDIucDEsIHBvc2l0aW9uKTtcbiAgICAgICAgdmFyIGIyID0gVmVjMi5kb3QoczIsIHMyKSAtIHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzO1xuICAgICAgICB2YXIgciA9IFZlYzIuc3ViKGlucHV0Mi5wMiwgaW5wdXQyLnAxKTtcbiAgICAgICAgdmFyIGMyID0gVmVjMi5kb3QoczIsIHIpO1xuICAgICAgICB2YXIgcnIgPSBWZWMyLmRvdChyLCByKTtcbiAgICAgICAgdmFyIHNpZ21hID0gYzIgKiBjMiAtIHJyICogYjI7XG4gICAgICAgIGlmIChzaWdtYSA8IDAgfHwgcnIgPCBFUFNJTE9OKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhMiA9IC0oYzIgKyBtYXRoX3NxcnQoc2lnbWEpKTtcbiAgICAgICAgaWYgKDAgPD0gYTIgJiYgYTIgPD0gaW5wdXQyLm1heEZyYWN0aW9uICogcnIpIHtcbiAgICAgICAgICBhMiAvPSBycjtcbiAgICAgICAgICBvdXRwdXQyLmZyYWN0aW9uID0gYTI7XG4gICAgICAgICAgb3V0cHV0Mi5ub3JtYWwgPSBWZWMyLmFkZChzMiwgVmVjMi5tdWxOdW1WZWMyKGEyLCByKSk7XG4gICAgICAgICAgb3V0cHV0Mi5ub3JtYWwubm9ybWFsaXplKCk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZUFBQkIgPSBmdW5jdGlvbihhYWJiLCB4ZjIsIGNoaWxkSW5kZXgpIHtcbiAgICAgICAgdmFyIHAgPSB0cmFuc2Zvcm1WZWMyKHRlbXAsIHhmMiwgdGhpcy5tX3ApO1xuICAgICAgICBzZXRWZWMyKGFhYmIubG93ZXJCb3VuZCwgcC54IC0gdGhpcy5tX3JhZGl1cywgcC55IC0gdGhpcy5tX3JhZGl1cyk7XG4gICAgICAgIHNldFZlYzIoYWFiYi51cHBlckJvdW5kLCBwLnggKyB0aGlzLm1fcmFkaXVzLCBwLnkgKyB0aGlzLm1fcmFkaXVzKTtcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIucHJvdG90eXBlLmNvbXB1dGVNYXNzID0gZnVuY3Rpb24obWFzc0RhdGEsIGRlbnNpdHkpIHtcbiAgICAgICAgbWFzc0RhdGEubWFzcyA9IGRlbnNpdHkgKiBtYXRoX1BJJDQgKiB0aGlzLm1fcmFkaXVzICogdGhpcy5tX3JhZGl1cztcbiAgICAgICAgY29weVZlYzIobWFzc0RhdGEuY2VudGVyLCB0aGlzLm1fcCk7XG4gICAgICAgIG1hc3NEYXRhLkkgPSBtYXNzRGF0YS5tYXNzICogKDAuNSAqIHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzICsgbGVuZ3RoU3FyVmVjMih0aGlzLm1fcCkpO1xuICAgICAgfTtcbiAgICAgIENpcmNsZVNoYXBlMi5wcm90b3R5cGUuY29tcHV0ZURpc3RhbmNlUHJveHkgPSBmdW5jdGlvbihwcm94eSkge1xuICAgICAgICBwcm94eS5tX3ZlcnRpY2VzWzBdID0gdGhpcy5tX3A7XG4gICAgICAgIHByb3h5Lm1fdmVydGljZXMubGVuZ3RoID0gMTtcbiAgICAgICAgcHJveHkubV9jb3VudCA9IDE7XG4gICAgICAgIHByb3h5Lm1fcmFkaXVzID0gdGhpcy5tX3JhZGl1cztcbiAgICAgIH07XG4gICAgICBDaXJjbGVTaGFwZTIuVFlQRSA9IFwiY2lyY2xlXCI7XG4gICAgICByZXR1cm4gQ2lyY2xlU2hhcGUyO1xuICAgIH0oU2hhcGUpXG4gICk7XG4gIHZhciBtYXRoX2FicyQ1ID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX1BJJDMgPSBNYXRoLlBJO1xuICB2YXIgREVGQVVMVFMkYSA9IHtcbiAgICBmcmVxdWVuY3lIejogMCxcbiAgICBkYW1waW5nUmF0aW86IDBcbiAgfTtcbiAgdmFyIERpc3RhbmNlSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKERpc3RhbmNlSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gRGlzdGFuY2VKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvckEsIGFuY2hvckIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBEaXN0YW5jZUpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IERpc3RhbmNlSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3JBLCBhbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYm9keUIgJiYgYW5jaG9yQSAmJiBcIm1fdHlwZVwiIGluIGFuY2hvckEgJiYgXCJ4XCIgaW4gYm9keUIgJiYgXCJ5XCIgaW4gYm9keUIpIHtcbiAgICAgICAgICB2YXIgdGVtcDMgPSBib2R5QjtcbiAgICAgICAgICBib2R5QiA9IGFuY2hvckE7XG4gICAgICAgICAgYW5jaG9yQSA9IHRlbXAzO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyRhKTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IERpc3RhbmNlSm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShhbmNob3JBID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3JBKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yQiA/IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yQikgOiBkZWYubG9jYWxBbmNob3JCIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9sZW5ndGggPSBOdW1iZXIuaXNGaW5pdGUoZGVmLmxlbmd0aCkgPyBkZWYubGVuZ3RoIDogVmVjMi5kaXN0YW5jZShib2R5QS5nZXRXb3JsZFBvaW50KF90aGlzLm1fbG9jYWxBbmNob3JBKSwgYm9keUIuZ2V0V29ybGRQb2ludChfdGhpcy5tX2xvY2FsQW5jaG9yQikpO1xuICAgICAgICBfdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICBfdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICBfdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBmcmVxdWVuY3lIejogdGhpcy5tX2ZyZXF1ZW5jeUh6LFxuICAgICAgICAgIGRhbXBpbmdSYXRpbzogdGhpcy5tX2RhbXBpbmdSYXRpbyxcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCLFxuICAgICAgICAgIGxlbmd0aDogdGhpcy5tX2xlbmd0aCxcbiAgICAgICAgICBpbXB1bHNlOiB0aGlzLm1faW1wdWxzZSxcbiAgICAgICAgICBnYW1tYTogdGhpcy5tX2dhbW1hLFxuICAgICAgICAgIGJpYXM6IHRoaXMubV9iaWFzXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBEaXN0YW5jZUpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKGRlZi5hbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKHRoaXMubV9ib2R5QS5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JBKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMihkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIodGhpcy5tX2JvZHlCLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckIpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHRoaXMubV9sZW5ndGggPSArZGVmLmxlbmd0aDtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubGVuZ3RoIDwgMCkgO1xuICAgICAgICBlbHNlIGlmIChkZWYuYW5jaG9yQSB8fCBkZWYuYW5jaG9yQSB8fCBkZWYuYW5jaG9yQSB8fCBkZWYuYW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sZW5ndGggPSBWZWMyLmRpc3RhbmNlKHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpLCB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZnJlcXVlbmN5SHopKSB7XG4gICAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmRhbXBpbmdSYXRpbykpIHtcbiAgICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckE7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuc2V0TGVuZ3RoID0gZnVuY3Rpb24obGVuZ3RoKSB7XG4gICAgICAgIHRoaXMubV9sZW5ndGggPSBsZW5ndGg7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldExlbmd0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xlbmd0aDtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuc2V0RnJlcXVlbmN5ID0gZnVuY3Rpb24oaHopIHtcbiAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gaHo7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5zZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbihyYXRpbykge1xuICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gcmF0aW87XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2RhbXBpbmdSYXRpbztcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm11bE51bVZlYzIodGhpcy5tX2ltcHVsc2UsIHRoaXMubV91KS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdGhpcy5tX3UgPSBWZWMyLnN1YihWZWMyLmFkZChjQjIsIHRoaXMubV9yQiksIFZlYzIuYWRkKGNBMiwgdGhpcy5tX3JBKSk7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLm1fdS5sZW5ndGgoKTtcbiAgICAgICAgaWYgKGxlbmd0aCA+IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCkge1xuICAgICAgICAgIHRoaXMubV91Lm11bCgxIC8gbGVuZ3RoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdS5zZXROdW0oMCwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNyQXUgPSBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCB0aGlzLm1fdSk7XG4gICAgICAgIHZhciBjckJ1ID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgdGhpcy5tX3UpO1xuICAgICAgICB2YXIgaW52TWFzcyA9IHRoaXMubV9pbnZNYXNzQSArIHRoaXMubV9pbnZJQSAqIGNyQXUgKiBjckF1ICsgdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklCICogY3JCdSAqIGNyQnU7XG4gICAgICAgIHRoaXMubV9tYXNzID0gaW52TWFzcyAhPSAwID8gMSAvIGludk1hc3MgOiAwO1xuICAgICAgICBpZiAodGhpcy5tX2ZyZXF1ZW5jeUh6ID4gMCkge1xuICAgICAgICAgIHZhciBDID0gbGVuZ3RoIC0gdGhpcy5tX2xlbmd0aDtcbiAgICAgICAgICB2YXIgb21lZ2EgPSAyICogbWF0aF9QSSQzICogdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgICAgIHZhciBkMiA9IDIgKiB0aGlzLm1fbWFzcyAqIHRoaXMubV9kYW1waW5nUmF0aW8gKiBvbWVnYTtcbiAgICAgICAgICB2YXIgayA9IHRoaXMubV9tYXNzICogb21lZ2EgKiBvbWVnYTtcbiAgICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gaCAqIChkMiArIGggKiBrKTtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSB0aGlzLm1fZ2FtbWEgIT0gMCA/IDEgLyB0aGlzLm1fZ2FtbWEgOiAwO1xuICAgICAgICAgIHRoaXMubV9iaWFzID0gQyAqIGggKiBrICogdGhpcy5tX2dhbW1hO1xuICAgICAgICAgIGludk1hc3MgKz0gdGhpcy5tX2dhbW1hO1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gaW52TWFzcyAhPSAwID8gMSAvIGludk1hc3MgOiAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9nYW1tYSA9IDA7XG4gICAgICAgICAgdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIodGhpcy5tX2ltcHVsc2UsIHRoaXMubV91KTtcbiAgICAgICAgICB2QTIuc3ViTXVsKHRoaXMubV9pbnZNYXNzQSwgUDMpO1xuICAgICAgICAgIHdBIC09IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBEaXN0YW5jZUpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2cEEgPSBWZWMyLmFkZCh2QTIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgdmFyIHZwQiA9IFZlYzIuYWRkKHZCMiwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpO1xuICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuZG90KHRoaXMubV91LCB2cEIpIC0gVmVjMi5kb3QodGhpcy5tX3UsIHZwQSk7XG4gICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tYXNzICogKENkb3QgKyB0aGlzLm1fYmlhcyArIHRoaXMubV9nYW1tYSAqIHRoaXMubV9pbXB1bHNlKTtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UgKz0gaW1wdWxzZTtcbiAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIHRoaXMubV91KTtcbiAgICAgICAgdkEyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgd0EgLT0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpO1xuICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMyk7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgRGlzdGFuY2VKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgaWYgKHRoaXMubV9mcmVxdWVuY3lIeiA+IDApIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxTdWIocUEsIHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFN1YihxQiwgdGhpcy5tX2xvY2FsQW5jaG9yQiwgdGhpcy5tX2xvY2FsQ2VudGVyQik7XG4gICAgICAgIHZhciB1ID0gVmVjMi5zdWIoVmVjMi5hZGQoY0IyLCByQjIpLCBWZWMyLmFkZChjQTIsIHJBMikpO1xuICAgICAgICB2YXIgbGVuZ3RoID0gdS5ub3JtYWxpemUoKTtcbiAgICAgICAgdmFyIEMgPSBjbGFtcChsZW5ndGggLSB0aGlzLm1fbGVuZ3RoLCAtU2V0dGluZ3NJbnRlcm5hbC5tYXhMaW5lYXJDb3JyZWN0aW9uLCBTZXR0aW5nc0ludGVybmFsLm1heExpbmVhckNvcnJlY3Rpb24pO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbWFzcyAqIEM7XG4gICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihpbXB1bHNlLCB1KTtcbiAgICAgICAgY0EyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgYUEgLT0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgUDMpO1xuICAgICAgICBjQjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICBhQiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBQMyk7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hID0gYUE7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBtYXRoX2FicyQ1KEMpIDwgU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIERpc3RhbmNlSm9pbnQyLlRZUEUgPSBcImRpc3RhbmNlLWpvaW50XCI7XG4gICAgICByZXR1cm4gRGlzdGFuY2VKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIERFRkFVTFRTJDkgPSB7XG4gICAgbWF4Rm9yY2U6IDAsXG4gICAgbWF4VG9ycXVlOiAwXG4gIH07XG4gIHZhciBGcmljdGlvbkpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhGcmljdGlvbkpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIEZyaWN0aW9uSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBGcmljdGlvbkpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEZyaWN0aW9uSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQ5KTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IEZyaWN0aW9uSm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5QS5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JBIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckIgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xpbmVhckltcHVsc2UgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9hbmd1bGFySW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIF90aGlzLm1fbWF4VG9ycXVlID0gZGVmLm1heFRvcnF1ZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgbWF4Rm9yY2U6IHRoaXMubV9tYXhGb3JjZSxcbiAgICAgICAgICBtYXhUb3JxdWU6IHRoaXMubV9tYXhUb3JxdWUsXG4gICAgICAgICAgbG9jYWxBbmNob3JBOiB0aGlzLm1fbG9jYWxBbmNob3JBLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQlxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgRnJpY3Rpb25Kb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMih0aGlzLm1fYm9keUEuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQSkpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5hbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKHRoaXMubV9ib2R5Qi5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JCKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMihkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhGb3JjZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4VG9ycXVlKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhUb3JxdWUgPSBkZWYubWF4VG9ycXVlO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JCO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhGb3JjZSA9IGZ1bmN0aW9uKGZvcmNlKSB7XG4gICAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGZvcmNlO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhGb3JjZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heEZvcmNlO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhUb3JxdWUgPSBmdW5jdGlvbih0b3JxdWUpIHtcbiAgICAgICAgdGhpcy5tX21heFRvcnF1ZSA9IHRvcnF1ZTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0TWF4VG9ycXVlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4VG9ycXVlO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgRnJpY3Rpb25Kb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubXVsTnVtVmVjMihpbnZfZHQsIHRoaXMubV9saW5lYXJJbXB1bHNlKTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9hbmd1bGFySW1wdWxzZTtcbiAgICAgIH07XG4gICAgICBGcmljdGlvbkpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgSyA9IG5ldyBNYXQyMigpO1xuICAgICAgICBLLmV4LnggPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fckEueSAqIHRoaXMubV9yQS55ICsgaUIgKiB0aGlzLm1fckIueSAqIHRoaXMubV9yQi55O1xuICAgICAgICBLLmV4LnkgPSAtaUEgKiB0aGlzLm1fckEueCAqIHRoaXMubV9yQS55IC0gaUIgKiB0aGlzLm1fckIueCAqIHRoaXMubV9yQi55O1xuICAgICAgICBLLmV5LnggPSBLLmV4Lnk7XG4gICAgICAgIEsuZXkueSA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9yQS54ICogdGhpcy5tX3JBLnggKyBpQiAqIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLng7XG4gICAgICAgIHRoaXMubV9saW5lYXJNYXNzID0gSy5nZXRJbnZlcnNlKCk7XG4gICAgICAgIHRoaXMubV9hbmd1bGFyTWFzcyA9IGlBICsgaUI7XG4gICAgICAgIGlmICh0aGlzLm1fYW5ndWxhck1hc3MgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJNYXNzID0gMSAvIHRoaXMubV9hbmd1bGFyTWFzcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5tdWwoc3RlcC5kdFJhdGlvKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVvKHRoaXMubV9saW5lYXJJbXB1bHNlLngsIHRoaXMubV9saW5lYXJJbXB1bHNlLnkpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMykgKyB0aGlzLm1fYW5ndWxhckltcHVsc2UpO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMykgKyB0aGlzLm1fYW5ndWxhckltcHVsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IHdCIC0gd0E7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX2FuZ3VsYXJNYXNzICogQ2RvdDtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9hbmd1bGFySW1wdWxzZTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IGggKiB0aGlzLm1fbWF4VG9ycXVlO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFySW1wdWxzZSA9IGNsYW1wKHRoaXMubV9hbmd1bGFySW1wdWxzZSArIGltcHVsc2UsIC1tYXhJbXB1bHNlLCBtYXhJbXB1bHNlKTtcbiAgICAgICAgICBpbXB1bHNlID0gdGhpcy5tX2FuZ3VsYXJJbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2U7XG4gICAgICAgICAgd0IgKz0gaUIgKiBpbXB1bHNlO1xuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuc3ViKFZlYzIuYWRkKHZCMiwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpLCBWZWMyLmFkZCh2QTIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKSk7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSBWZWMyLm5lZyhNYXQyMi5tdWxWZWMyKHRoaXMubV9saW5lYXJNYXNzLCBDZG90KSk7XG4gICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fbGluZWFySW1wdWxzZTtcbiAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5hZGQoaW1wdWxzZSk7XG4gICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBoICogdGhpcy5tX21heEZvcmNlO1xuICAgICAgICAgIGlmICh0aGlzLm1fbGluZWFySW1wdWxzZS5sZW5ndGhTcXVhcmVkKCkgPiBtYXhJbXB1bHNlICogbWF4SW1wdWxzZSkge1xuICAgICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2Uubm9ybWFsaXplKCk7XG4gICAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5tdWwobWF4SW1wdWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGltcHVsc2UgPSBWZWMyLnN1Yih0aGlzLm1fbGluZWFySW1wdWxzZSwgb2xkSW1wdWxzZSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgaW1wdWxzZSk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBpbXB1bHNlKTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBpbXB1bHNlKTtcbiAgICAgICAgICB3QiArPSBpQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIGltcHVsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIEZyaWN0aW9uSm9pbnQyLlRZUEUgPSBcImZyaWN0aW9uLWpvaW50XCI7XG4gICAgICByZXR1cm4gRnJpY3Rpb25Kb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIE1hdDMzID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIE1hdDMzMihhMiwgYjIsIGMyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYTIgPT09IFwib2JqZWN0XCIgJiYgYTIgIT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLmV4ID0gVmVjMy5jbG9uZShhMik7XG4gICAgICAgICAgdGhpcy5leSA9IFZlYzMuY2xvbmUoYjIpO1xuICAgICAgICAgIHRoaXMuZXogPSBWZWMzLmNsb25lKGMyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmV4ID0gVmVjMy56ZXJvKCk7XG4gICAgICAgICAgdGhpcy5leSA9IFZlYzMuemVybygpO1xuICAgICAgICAgIHRoaXMuZXogPSBWZWMzLnplcm8oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgTWF0MzMyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyk7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLmlzVmFsaWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBWZWMzLmlzVmFsaWQob2JqLmV4KSAmJiBWZWMzLmlzVmFsaWQob2JqLmV5KSAmJiBWZWMzLmlzVmFsaWQob2JqLmV6KTtcbiAgICAgIH07XG4gICAgICBNYXQzMzIuYXNzZXJ0ID0gZnVuY3Rpb24obykge1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5wcm90b3R5cGUuc2V0WmVybyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmV4LnNldFplcm8oKTtcbiAgICAgICAgdGhpcy5leS5zZXRaZXJvKCk7XG4gICAgICAgIHRoaXMuZXouc2V0WmVybygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBNYXQzMzIucHJvdG90eXBlLnNvbHZlMzMgPSBmdW5jdGlvbih2Mykge1xuICAgICAgICB2YXIgY3Jvc3NfeCA9IHRoaXMuZXkueSAqIHRoaXMuZXoueiAtIHRoaXMuZXkueiAqIHRoaXMuZXoueTtcbiAgICAgICAgdmFyIGNyb3NzX3kgPSB0aGlzLmV5LnogKiB0aGlzLmV6LnggLSB0aGlzLmV5LnggKiB0aGlzLmV6Lno7XG4gICAgICAgIHZhciBjcm9zc196ID0gdGhpcy5leS54ICogdGhpcy5lei55IC0gdGhpcy5leS55ICogdGhpcy5lei54O1xuICAgICAgICB2YXIgZGV0ID0gdGhpcy5leC54ICogY3Jvc3NfeCArIHRoaXMuZXgueSAqIGNyb3NzX3kgKyB0aGlzLmV4LnogKiBjcm9zc196O1xuICAgICAgICBpZiAoZGV0ICE9PSAwKSB7XG4gICAgICAgICAgZGV0ID0gMSAvIGRldDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgciA9IG5ldyBWZWMzKCk7XG4gICAgICAgIGNyb3NzX3ggPSB0aGlzLmV5LnkgKiB0aGlzLmV6LnogLSB0aGlzLmV5LnogKiB0aGlzLmV6Lnk7XG4gICAgICAgIGNyb3NzX3kgPSB0aGlzLmV5LnogKiB0aGlzLmV6LnggLSB0aGlzLmV5LnggKiB0aGlzLmV6Lno7XG4gICAgICAgIGNyb3NzX3ogPSB0aGlzLmV5LnggKiB0aGlzLmV6LnkgLSB0aGlzLmV5LnkgKiB0aGlzLmV6Lng7XG4gICAgICAgIHIueCA9IGRldCAqICh2My54ICogY3Jvc3NfeCArIHYzLnkgKiBjcm9zc195ICsgdjMueiAqIGNyb3NzX3opO1xuICAgICAgICBjcm9zc194ID0gdjMueSAqIHRoaXMuZXoueiAtIHYzLnogKiB0aGlzLmV6Lnk7XG4gICAgICAgIGNyb3NzX3kgPSB2My56ICogdGhpcy5lei54IC0gdjMueCAqIHRoaXMuZXouejtcbiAgICAgICAgY3Jvc3NfeiA9IHYzLnggKiB0aGlzLmV6LnkgLSB2My55ICogdGhpcy5lei54O1xuICAgICAgICByLnkgPSBkZXQgKiAodGhpcy5leC54ICogY3Jvc3NfeCArIHRoaXMuZXgueSAqIGNyb3NzX3kgKyB0aGlzLmV4LnogKiBjcm9zc196KTtcbiAgICAgICAgY3Jvc3NfeCA9IHRoaXMuZXkueSAqIHYzLnogLSB0aGlzLmV5LnogKiB2My55O1xuICAgICAgICBjcm9zc195ID0gdGhpcy5leS56ICogdjMueCAtIHRoaXMuZXkueCAqIHYzLno7XG4gICAgICAgIGNyb3NzX3ogPSB0aGlzLmV5LnggKiB2My55IC0gdGhpcy5leS55ICogdjMueDtcbiAgICAgICAgci56ID0gZGV0ICogKHRoaXMuZXgueCAqIGNyb3NzX3ggKyB0aGlzLmV4LnkgKiBjcm9zc195ICsgdGhpcy5leC56ICogY3Jvc3Nfeik7XG4gICAgICAgIHJldHVybiByO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5wcm90b3R5cGUuc29sdmUyMiA9IGZ1bmN0aW9uKHYzKSB7XG4gICAgICAgIHZhciBhMTEgPSB0aGlzLmV4Lng7XG4gICAgICAgIHZhciBhMTIgPSB0aGlzLmV5Lng7XG4gICAgICAgIHZhciBhMjEgPSB0aGlzLmV4Lnk7XG4gICAgICAgIHZhciBhMjIgPSB0aGlzLmV5Lnk7XG4gICAgICAgIHZhciBkZXQgPSBhMTEgKiBhMjIgLSBhMTIgKiBhMjE7XG4gICAgICAgIGlmIChkZXQgIT09IDApIHtcbiAgICAgICAgICBkZXQgPSAxIC8gZGV0O1xuICAgICAgICB9XG4gICAgICAgIHZhciByID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHIueCA9IGRldCAqIChhMjIgKiB2My54IC0gYTEyICogdjMueSk7XG4gICAgICAgIHIueSA9IGRldCAqIChhMTEgKiB2My55IC0gYTIxICogdjMueCk7XG4gICAgICAgIHJldHVybiByO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5wcm90b3R5cGUuZ2V0SW52ZXJzZTIyID0gZnVuY3Rpb24oTSkge1xuICAgICAgICB2YXIgYTIgPSB0aGlzLmV4Lng7XG4gICAgICAgIHZhciBiMiA9IHRoaXMuZXkueDtcbiAgICAgICAgdmFyIGMyID0gdGhpcy5leC55O1xuICAgICAgICB2YXIgZDIgPSB0aGlzLmV5Lnk7XG4gICAgICAgIHZhciBkZXQgPSBhMiAqIGQyIC0gYjIgKiBjMjtcbiAgICAgICAgaWYgKGRldCAhPT0gMCkge1xuICAgICAgICAgIGRldCA9IDEgLyBkZXQ7XG4gICAgICAgIH1cbiAgICAgICAgTS5leC54ID0gZGV0ICogZDI7XG4gICAgICAgIE0uZXkueCA9IC1kZXQgKiBiMjtcbiAgICAgICAgTS5leC56ID0gMDtcbiAgICAgICAgTS5leC55ID0gLWRldCAqIGMyO1xuICAgICAgICBNLmV5LnkgPSBkZXQgKiBhMjtcbiAgICAgICAgTS5leS56ID0gMDtcbiAgICAgICAgTS5lei54ID0gMDtcbiAgICAgICAgTS5lei55ID0gMDtcbiAgICAgICAgTS5lei56ID0gMDtcbiAgICAgIH07XG4gICAgICBNYXQzMzIucHJvdG90eXBlLmdldFN5bUludmVyc2UzMyA9IGZ1bmN0aW9uKE0pIHtcbiAgICAgICAgdmFyIGRldCA9IFZlYzMuZG90KHRoaXMuZXgsIFZlYzMuY3Jvc3ModGhpcy5leSwgdGhpcy5leikpO1xuICAgICAgICBpZiAoZGV0ICE9PSAwKSB7XG4gICAgICAgICAgZGV0ID0gMSAvIGRldDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYTExID0gdGhpcy5leC54O1xuICAgICAgICB2YXIgYTEyID0gdGhpcy5leS54O1xuICAgICAgICB2YXIgYTEzID0gdGhpcy5lei54O1xuICAgICAgICB2YXIgYTIyID0gdGhpcy5leS55O1xuICAgICAgICB2YXIgYTIzID0gdGhpcy5lei55O1xuICAgICAgICB2YXIgYTMzID0gdGhpcy5lei56O1xuICAgICAgICBNLmV4LnggPSBkZXQgKiAoYTIyICogYTMzIC0gYTIzICogYTIzKTtcbiAgICAgICAgTS5leC55ID0gZGV0ICogKGExMyAqIGEyMyAtIGExMiAqIGEzMyk7XG4gICAgICAgIE0uZXgueiA9IGRldCAqIChhMTIgKiBhMjMgLSBhMTMgKiBhMjIpO1xuICAgICAgICBNLmV5LnggPSBNLmV4Lnk7XG4gICAgICAgIE0uZXkueSA9IGRldCAqIChhMTEgKiBhMzMgLSBhMTMgKiBhMTMpO1xuICAgICAgICBNLmV5LnogPSBkZXQgKiAoYTEzICogYTEyIC0gYTExICogYTIzKTtcbiAgICAgICAgTS5lei54ID0gTS5leC56O1xuICAgICAgICBNLmV6LnkgPSBNLmV5Lno7XG4gICAgICAgIE0uZXoueiA9IGRldCAqIChhMTEgKiBhMjIgLSBhMTIgKiBhMTIpO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5tdWwgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgaWYgKGIyICYmIFwielwiIGluIGIyICYmIFwieVwiIGluIGIyICYmIFwieFwiIGluIGIyKSB7XG4gICAgICAgICAgdmFyIHgyID0gYTIuZXgueCAqIGIyLnggKyBhMi5leS54ICogYjIueSArIGEyLmV6LnggKiBiMi56O1xuICAgICAgICAgIHZhciB5ID0gYTIuZXgueSAqIGIyLnggKyBhMi5leS55ICogYjIueSArIGEyLmV6LnkgKiBiMi56O1xuICAgICAgICAgIHZhciB6ID0gYTIuZXgueiAqIGIyLnggKyBhMi5leS56ICogYjIueSArIGEyLmV6LnogKiBiMi56O1xuICAgICAgICAgIHJldHVybiBuZXcgVmVjMyh4MiwgeSwgeik7XG4gICAgICAgIH0gZWxzZSBpZiAoYjIgJiYgXCJ5XCIgaW4gYjIgJiYgXCJ4XCIgaW4gYjIpIHtcbiAgICAgICAgICB2YXIgeDIgPSBhMi5leC54ICogYjIueCArIGEyLmV5LnggKiBiMi55O1xuICAgICAgICAgIHZhciB5ID0gYTIuZXgueSAqIGIyLnggKyBhMi5leS55ICogYjIueTtcbiAgICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgTWF0MzMyLm11bFZlYzMgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIHgyID0gYTIuZXgueCAqIGIyLnggKyBhMi5leS54ICogYjIueSArIGEyLmV6LnggKiBiMi56O1xuICAgICAgICB2YXIgeSA9IGEyLmV4LnkgKiBiMi54ICsgYTIuZXkueSAqIGIyLnkgKyBhMi5lei55ICogYjIuejtcbiAgICAgICAgdmFyIHogPSBhMi5leC56ICogYjIueCArIGEyLmV5LnogKiBiMi55ICsgYTIuZXoueiAqIGIyLno7XG4gICAgICAgIHJldHVybiBuZXcgVmVjMyh4MiwgeSwgeik7XG4gICAgICB9O1xuICAgICAgTWF0MzMyLm11bFZlYzIgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgdmFyIHgyID0gYTIuZXgueCAqIGIyLnggKyBhMi5leS54ICogYjIueTtcbiAgICAgICAgdmFyIHkgPSBhMi5leC55ICogYjIueCArIGEyLmV5LnkgKiBiMi55O1xuICAgICAgICByZXR1cm4gVmVjMi5uZW8oeDIsIHkpO1xuICAgICAgfTtcbiAgICAgIE1hdDMzMi5hZGQgPSBmdW5jdGlvbihhMiwgYjIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXQzMzIoVmVjMy5hZGQoYTIuZXgsIGIyLmV4KSwgVmVjMy5hZGQoYTIuZXksIGIyLmV5KSwgVmVjMy5hZGQoYTIuZXosIGIyLmV6KSk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIE1hdDMzMjtcbiAgICB9KClcbiAgKTtcbiAgdmFyIG1hdGhfYWJzJDQgPSBNYXRoLmFicztcbiAgdmFyIExpbWl0U3RhdGUkMjtcbiAgKGZ1bmN0aW9uKExpbWl0U3RhdGUyKSB7XG4gICAgTGltaXRTdGF0ZTJbTGltaXRTdGF0ZTJbXCJpbmFjdGl2ZUxpbWl0XCJdID0gMF0gPSBcImluYWN0aXZlTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImF0TG93ZXJMaW1pdFwiXSA9IDFdID0gXCJhdExvd2VyTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImF0VXBwZXJMaW1pdFwiXSA9IDJdID0gXCJhdFVwcGVyTGltaXRcIjtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImVxdWFsTGltaXRzXCJdID0gM10gPSBcImVxdWFsTGltaXRzXCI7XG4gIH0pKExpbWl0U3RhdGUkMiB8fCAoTGltaXRTdGF0ZSQyID0ge30pKTtcbiAgdmFyIERFRkFVTFRTJDggPSB7XG4gICAgbG93ZXJBbmdsZTogMCxcbiAgICB1cHBlckFuZ2xlOiAwLFxuICAgIG1heE1vdG9yVG9ycXVlOiAwLFxuICAgIG1vdG9yU3BlZWQ6IDAsXG4gICAgZW5hYmxlTGltaXQ6IGZhbHNlLFxuICAgIGVuYWJsZU1vdG9yOiBmYWxzZVxuICB9O1xuICB2YXIgUmV2b2x1dGVKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoUmV2b2x1dGVKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBSZXZvbHV0ZUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBfYTIsIF9iLCBfYywgX2QsIF9lLCBfZjtcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBSZXZvbHV0ZUpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFJldm9sdXRlSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IGRlZiAhPT0gbnVsbCAmJiBkZWYgIT09IHZvaWQgMCA/IGRlZiA6IHt9O1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV9tYXNzID0gbmV3IE1hdDMzKCk7XG4gICAgICAgIF90aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMi5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBSZXZvbHV0ZUpvaW50Mi5UWVBFO1xuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGFuY2hvcikpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yKTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmLmxvY2FsQW5jaG9yQSkpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGFuY2hvcikpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IGJvZHlCLmdldExvY2FsUG9pbnQoYW5jaG9yKTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmLmxvY2FsQW5jaG9yQikpIHtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5yZWZlcmVuY2VBbmdsZSkpIHtcbiAgICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlID0gZGVmLnJlZmVyZW5jZUFuZ2xlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBib2R5Qi5nZXRBbmdsZSgpIC0gYm9keUEuZ2V0QW5nbGUoKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSBuZXcgVmVjMygpO1xuICAgICAgICBfdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbG93ZXJBbmdsZSA9IChfYTIgPSBkZWYubG93ZXJBbmdsZSkgIT09IG51bGwgJiYgX2EyICE9PSB2b2lkIDAgPyBfYTIgOiBERUZBVUxUUyQ4Lmxvd2VyQW5nbGU7XG4gICAgICAgIF90aGlzLm1fdXBwZXJBbmdsZSA9IChfYiA9IGRlZi51cHBlckFuZ2xlKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBERUZBVUxUUyQ4LnVwcGVyQW5nbGU7XG4gICAgICAgIF90aGlzLm1fbWF4TW90b3JUb3JxdWUgPSAoX2MgPSBkZWYubWF4TW90b3JUb3JxdWUpICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6IERFRkFVTFRTJDgubWF4TW90b3JUb3JxdWU7XG4gICAgICAgIF90aGlzLm1fbW90b3JTcGVlZCA9IChfZCA9IGRlZi5tb3RvclNwZWVkKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiBERUZBVUxUUyQ4Lm1vdG9yU3BlZWQ7XG4gICAgICAgIF90aGlzLm1fZW5hYmxlTGltaXQgPSAoX2UgPSBkZWYuZW5hYmxlTGltaXQpICE9PSBudWxsICYmIF9lICE9PSB2b2lkIDAgPyBfZSA6IERFRkFVTFRTJDguZW5hYmxlTGltaXQ7XG4gICAgICAgIF90aGlzLm1fZW5hYmxlTW90b3IgPSAoX2YgPSBkZWYuZW5hYmxlTW90b3IpICE9PSBudWxsICYmIF9mICE9PSB2b2lkIDAgPyBfZiA6IERFRkFVTFRTJDguZW5hYmxlTW90b3I7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGxvd2VyQW5nbGU6IHRoaXMubV9sb3dlckFuZ2xlLFxuICAgICAgICAgIHVwcGVyQW5nbGU6IHRoaXMubV91cHBlckFuZ2xlLFxuICAgICAgICAgIG1heE1vdG9yVG9ycXVlOiB0aGlzLm1fbWF4TW90b3JUb3JxdWUsXG4gICAgICAgICAgbW90b3JTcGVlZDogdGhpcy5tX21vdG9yU3BlZWQsXG4gICAgICAgICAgZW5hYmxlTGltaXQ6IHRoaXMubV9lbmFibGVMaW1pdCxcbiAgICAgICAgICBlbmFibGVNb3RvcjogdGhpcy5tX2VuYWJsZU1vdG9yLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckIsXG4gICAgICAgICAgcmVmZXJlbmNlQW5nbGU6IHRoaXMubV9yZWZlcmVuY2VBbmdsZVxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgUmV2b2x1dGVKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMih0aGlzLm1fYm9keUEuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQSkpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5hbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKHRoaXMubV9ib2R5Qi5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JCKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMihkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5yZWZlcmVuY2VBbmdsZSkpIHtcbiAgICAgICAgICB0aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBkZWYucmVmZXJlbmNlQW5nbGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5lbmFibGVMaW1pdCAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gZGVmLmVuYWJsZUxpbWl0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmxvd2VyQW5nbGUpKSB7XG4gICAgICAgICAgdGhpcy5tX2xvd2VyQW5nbGUgPSBkZWYubG93ZXJBbmdsZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi51cHBlckFuZ2xlKSkge1xuICAgICAgICAgIHRoaXMubV91cHBlckFuZ2xlID0gZGVmLnVwcGVyQW5nbGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4TW90b3JUb3JxdWUpKSB7XG4gICAgICAgICAgdGhpcy5tX21heE1vdG9yVG9ycXVlID0gZGVmLm1heE1vdG9yVG9ycXVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1vdG9yU3BlZWQpKSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmVuYWJsZU1vdG9yICE9PSB2b2lkIDApIHtcbiAgICAgICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBkZWYuZW5hYmxlTW90b3I7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldFJlZmVyZW5jZUFuZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldEpvaW50QW5nbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICAgIHJldHVybiBiQi5tX3N3ZWVwLmEgLSBiQS5tX3N3ZWVwLmEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldEpvaW50U3BlZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICAgIHJldHVybiBiQi5tX2FuZ3VsYXJWZWxvY2l0eSAtIGJBLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5pc01vdG9yRW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZU1vdG9yO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5lbmFibGVNb3RvciA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcgPT0gdGhpcy5tX2VuYWJsZU1vdG9yKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGZsYWc7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldE1vdG9yVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5zZXRNb3RvclNwZWVkID0gZnVuY3Rpb24oc3BlZWQpIHtcbiAgICAgICAgaWYgKHNwZWVkID09IHRoaXMubV9tb3RvclNwZWVkKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9tb3RvclNwZWVkID0gc3BlZWQ7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldE1vdG9yU3BlZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tb3RvclNwZWVkO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhNb3RvclRvcnF1ZSA9IGZ1bmN0aW9uKHRvcnF1ZSkge1xuICAgICAgICBpZiAodG9ycXVlID09IHRoaXMubV9tYXhNb3RvclRvcnF1ZSlcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fbWF4TW90b3JUb3JxdWUgPSB0b3JxdWU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldE1heE1vdG9yVG9ycXVlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbWF4TW90b3JUb3JxdWU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmlzTGltaXRFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTGltaXQ7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmVuYWJsZUxpbWl0ID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAoZmxhZyAhPSB0aGlzLm1fZW5hYmxlTGltaXQpIHtcbiAgICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9IGZsYWc7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0TG93ZXJMaW1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvd2VyQW5nbGU7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldFVwcGVyTGltaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV91cHBlckFuZ2xlO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5zZXRMaW1pdHMgPSBmdW5jdGlvbihsb3dlciwgdXBwZXIpIHtcbiAgICAgICAgaWYgKGxvd2VyICE9IHRoaXMubV9sb3dlckFuZ2xlIHx8IHVwcGVyICE9IHRoaXMubV91cHBlckFuZ2xlKSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICB0aGlzLm1fbG93ZXJBbmdsZSA9IGxvd2VyO1xuICAgICAgICAgIHRoaXMubV91cHBlckFuZ2xlID0gdXBwZXI7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm5lbyh0aGlzLm1faW1wdWxzZS54LCB0aGlzLm1faW1wdWxzZS55KS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLno7XG4gICAgICB9O1xuICAgICAgUmV2b2x1dGVKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHRoaXMubV9yQSA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIGZpeGVkUm90YXRpb24gPSBpQSArIGlCID09PSAwO1xuICAgICAgICB0aGlzLm1fbWFzcy5leC54ID0gbUEgKyBtQiArIHRoaXMubV9yQS55ICogdGhpcy5tX3JBLnkgKiBpQSArIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnkgKiBpQjtcbiAgICAgICAgdGhpcy5tX21hc3MuZXkueCA9IC10aGlzLm1fckEueSAqIHRoaXMubV9yQS54ICogaUEgLSB0aGlzLm1fckIueSAqIHRoaXMubV9yQi54ICogaUI7XG4gICAgICAgIHRoaXMubV9tYXNzLmV6LnggPSAtdGhpcy5tX3JBLnkgKiBpQSAtIHRoaXMubV9yQi55ICogaUI7XG4gICAgICAgIHRoaXMubV9tYXNzLmV4LnkgPSB0aGlzLm1fbWFzcy5leS54O1xuICAgICAgICB0aGlzLm1fbWFzcy5leS55ID0gbUEgKyBtQiArIHRoaXMubV9yQS54ICogdGhpcy5tX3JBLnggKiBpQSArIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLnggKiBpQjtcbiAgICAgICAgdGhpcy5tX21hc3MuZXoueSA9IHRoaXMubV9yQS54ICogaUEgKyB0aGlzLm1fckIueCAqIGlCO1xuICAgICAgICB0aGlzLm1fbWFzcy5leC56ID0gdGhpcy5tX21hc3MuZXoueDtcbiAgICAgICAgdGhpcy5tX21hc3MuZXkueiA9IHRoaXMubV9tYXNzLmV6Lnk7XG4gICAgICAgIHRoaXMubV9tYXNzLmV6LnogPSBpQSArIGlCO1xuICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gaUEgKyBpQjtcbiAgICAgICAgaWYgKHRoaXMubV9tb3Rvck1hc3MgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IDEgLyB0aGlzLm1fbW90b3JNYXNzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgPT0gZmFsc2UgfHwgZml4ZWRSb3RhdGlvbikge1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQgJiYgZml4ZWRSb3RhdGlvbiA9PSBmYWxzZSkge1xuICAgICAgICAgIHZhciBqb2ludEFuZ2xlID0gYUIgLSBhQSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICBpZiAobWF0aF9hYnMkNCh0aGlzLm1fdXBwZXJBbmdsZSAtIHRoaXMubV9sb3dlckFuZ2xlKSA8IDIgKiBTZXR0aW5nc0ludGVybmFsLmFuZ3VsYXJTbG9wKSB7XG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMi5lcXVhbExpbWl0cztcbiAgICAgICAgICB9IGVsc2UgaWYgKGpvaW50QW5nbGUgPD0gdGhpcy5tX2xvd2VyQW5nbGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDIuYXRMb3dlckxpbWl0KSB7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDIuYXRMb3dlckxpbWl0O1xuICAgICAgICAgIH0gZWxzZSBpZiAoam9pbnRBbmdsZSA+PSB0aGlzLm1fdXBwZXJBbmdsZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMi5hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMi5hdFVwcGVyTGltaXQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gTGltaXRTdGF0ZSQyLmluYWN0aXZlTGltaXQ7XG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDIuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5tdWwoc3RlcC5kdFJhdGlvKTtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm5lbyh0aGlzLm1faW1wdWxzZS54LCB0aGlzLm1faW1wdWxzZS55KTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpICsgdGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMykgKyB0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2Uuc2V0WmVybygpO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFJldm9sdXRlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgZml4ZWRSb3RhdGlvbiA9IGlBICsgaUIgPT09IDA7XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQyLmVxdWFsTGltaXRzICYmIGZpeGVkUm90YXRpb24gPT0gZmFsc2UpIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IHdCIC0gd0EgLSB0aGlzLm1fbW90b3JTcGVlZDtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbW90b3JNYXNzICogQ2RvdDtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heE1vdG9yVG9ycXVlO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSBjbGFtcCh0aGlzLm1fbW90b3JJbXB1bHNlICsgaW1wdWxzZSwgLW1heEltcHVsc2UsIG1heEltcHVsc2UpO1xuICAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2U7XG4gICAgICAgICAgd0IgKz0gaUIgKiBpbXB1bHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQyLmluYWN0aXZlTGltaXQgJiYgZml4ZWRSb3RhdGlvbiA9PSBmYWxzZSkge1xuICAgICAgICAgIHZhciBDZG90MSA9IFZlYzIuemVybygpO1xuICAgICAgICAgIENkb3QxLmFkZENvbWJpbmUoMSwgdkIyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKSk7XG4gICAgICAgICAgQ2RvdDEuc3ViQ29tYmluZSgxLCB2QTIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgICB2YXIgQ2RvdDIgPSB3QiAtIHdBO1xuICAgICAgICAgIHZhciBDZG90ID0gbmV3IFZlYzMoQ2RvdDEueCwgQ2RvdDEueSwgQ2RvdDIpO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gVmVjMy5uZWcodGhpcy5tX21hc3Muc29sdmUzMyhDZG90KSk7XG4gICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IExpbWl0U3RhdGUkMi5lcXVhbExpbWl0cykge1xuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UuYWRkKGltcHVsc2UpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQyLmF0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgdmFyIG5ld0ltcHVsc2UgPSB0aGlzLm1faW1wdWxzZS56ICsgaW1wdWxzZS56O1xuICAgICAgICAgICAgaWYgKG5ld0ltcHVsc2UgPCAwKSB7XG4gICAgICAgICAgICAgIHZhciByaHMgPSBWZWMyLmNvbWJpbmUoLTEsIENkb3QxLCB0aGlzLm1faW1wdWxzZS56LCBWZWMyLm5lbyh0aGlzLm1fbWFzcy5lei54LCB0aGlzLm1fbWFzcy5lei55KSk7XG4gICAgICAgICAgICAgIHZhciByZWR1Y2VkID0gdGhpcy5tX21hc3Muc29sdmUyMihyaHMpO1xuICAgICAgICAgICAgICBpbXB1bHNlLnggPSByZWR1Y2VkLng7XG4gICAgICAgICAgICAgIGltcHVsc2UueSA9IHJlZHVjZWQueTtcbiAgICAgICAgICAgICAgaW1wdWxzZS56ID0gLXRoaXMubV9pbXB1bHNlLno7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKz0gcmVkdWNlZC54O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ICs9IHJlZHVjZWQueTtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS5hZGQoaW1wdWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBMaW1pdFN0YXRlJDIuYXRVcHBlckxpbWl0KSB7XG4gICAgICAgICAgICB2YXIgbmV3SW1wdWxzZSA9IHRoaXMubV9pbXB1bHNlLnogKyBpbXB1bHNlLno7XG4gICAgICAgICAgICBpZiAobmV3SW1wdWxzZSA+IDApIHtcbiAgICAgICAgICAgICAgdmFyIHJocyA9IFZlYzIuY29tYmluZSgtMSwgQ2RvdDEsIHRoaXMubV9pbXB1bHNlLnosIFZlYzIubmVvKHRoaXMubV9tYXNzLmV6LngsIHRoaXMubV9tYXNzLmV6LnkpKTtcbiAgICAgICAgICAgICAgdmFyIHJlZHVjZWQgPSB0aGlzLm1fbWFzcy5zb2x2ZTIyKHJocyk7XG4gICAgICAgICAgICAgIGltcHVsc2UueCA9IHJlZHVjZWQueDtcbiAgICAgICAgICAgICAgaW1wdWxzZS55ID0gcmVkdWNlZC55O1xuICAgICAgICAgICAgICBpbXB1bHNlLnogPSAtdGhpcy5tX2ltcHVsc2UuejtcbiAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSByZWR1Y2VkLng7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gcmVkdWNlZC55O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLmFkZChpbXB1bHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5uZW8oaW1wdWxzZS54LCBpbXB1bHNlLnkpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMykgKyBpbXB1bHNlLnopO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMykgKyBpbXB1bHNlLnopO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBDZG90ID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQ2RvdC5hZGRDb21iaW5lKDEsIHZCMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpO1xuICAgICAgICAgIENkb3Quc3ViQ29tYmluZSgxLCB2QTIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IHRoaXMubV9tYXNzLnNvbHZlMjIoVmVjMi5uZWcoQ2RvdCkpO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKz0gaW1wdWxzZS54O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gaW1wdWxzZS55O1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIGltcHVsc2UpO1xuICAgICAgICAgIHdBIC09IGlBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgaW1wdWxzZSk7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgaW1wdWxzZSk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBpbXB1bHNlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIGFuZ3VsYXJFcnJvciA9IDA7XG4gICAgICAgIHZhciBwb3NpdGlvbkVycm9yID0gMDtcbiAgICAgICAgdmFyIGZpeGVkUm90YXRpb24gPSB0aGlzLm1faW52SUEgKyB0aGlzLm1faW52SUIgPT0gMDtcbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBMaW1pdFN0YXRlJDIuaW5hY3RpdmVMaW1pdCAmJiBmaXhlZFJvdGF0aW9uID09IGZhbHNlKSB7XG4gICAgICAgICAgdmFyIGFuZ2xlID0gYUIgLSBhQSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICB2YXIgbGltaXRJbXB1bHNlID0gMDtcbiAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQyLmVxdWFsTGltaXRzKSB7XG4gICAgICAgICAgICB2YXIgQyA9IGNsYW1wKGFuZ2xlIC0gdGhpcy5tX2xvd2VyQW5nbGUsIC1TZXR0aW5nc0ludGVybmFsLm1heEFuZ3VsYXJDb3JyZWN0aW9uLCBTZXR0aW5nc0ludGVybmFsLm1heEFuZ3VsYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgICAgIGxpbWl0SW1wdWxzZSA9IC10aGlzLm1fbW90b3JNYXNzICogQztcbiAgICAgICAgICAgIGFuZ3VsYXJFcnJvciA9IG1hdGhfYWJzJDQoQyk7XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBMaW1pdFN0YXRlJDIuYXRMb3dlckxpbWl0KSB7XG4gICAgICAgICAgICB2YXIgQyA9IGFuZ2xlIC0gdGhpcy5tX2xvd2VyQW5nbGU7XG4gICAgICAgICAgICBhbmd1bGFyRXJyb3IgPSAtQztcbiAgICAgICAgICAgIEMgPSBjbGFtcChDICsgU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcCwgLVNldHRpbmdzSW50ZXJuYWwubWF4QW5ndWxhckNvcnJlY3Rpb24sIDApO1xuICAgICAgICAgICAgbGltaXRJbXB1bHNlID0gLXRoaXMubV9tb3Rvck1hc3MgKiBDO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQyLmF0VXBwZXJMaW1pdCkge1xuICAgICAgICAgICAgdmFyIEMgPSBhbmdsZSAtIHRoaXMubV91cHBlckFuZ2xlO1xuICAgICAgICAgICAgYW5ndWxhckVycm9yID0gQztcbiAgICAgICAgICAgIEMgPSBjbGFtcChDIC0gU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcCwgMCwgU2V0dGluZ3NJbnRlcm5hbC5tYXhBbmd1bGFyQ29ycmVjdGlvbik7XG4gICAgICAgICAgICBsaW1pdEltcHVsc2UgPSAtdGhpcy5tX21vdG9yTWFzcyAqIEM7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFBIC09IHRoaXMubV9pbnZJQSAqIGxpbWl0SW1wdWxzZTtcbiAgICAgICAgICBhQiArPSB0aGlzLm1faW52SUIgKiBsaW1pdEltcHVsc2U7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIHFBLnNldEFuZ2xlKGFBKTtcbiAgICAgICAgICBxQi5zZXRBbmdsZShhQik7XG4gICAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgICAgdmFyIEMgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBDLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICAgIEMuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHJBMik7XG4gICAgICAgICAgcG9zaXRpb25FcnJvciA9IEMubGVuZ3RoKCk7XG4gICAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICAgIHZhciBLID0gbmV3IE1hdDIyKCk7XG4gICAgICAgICAgSy5leC54ID0gbUEgKyBtQiArIGlBICogckEyLnkgKiByQTIueSArIGlCICogckIyLnkgKiByQjIueTtcbiAgICAgICAgICBLLmV4LnkgPSAtaUEgKiByQTIueCAqIHJBMi55IC0gaUIgKiByQjIueCAqIHJCMi55O1xuICAgICAgICAgIEsuZXkueCA9IEsuZXgueTtcbiAgICAgICAgICBLLmV5LnkgPSBtQSArIG1CICsgaUEgKiByQTIueCAqIHJBMi54ICsgaUIgKiByQjIueCAqIHJCMi54O1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gVmVjMi5uZWcoSy5zb2x2ZShDKSk7XG4gICAgICAgICAgY0EyLnN1Yk11bChtQSwgaW1wdWxzZSk7XG4gICAgICAgICAgYUEgLT0gaUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCBpbXB1bHNlKTtcbiAgICAgICAgICBjQjIuYWRkTXVsKG1CLCBpbXB1bHNlKTtcbiAgICAgICAgICBhQiArPSBpQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIGltcHVsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hID0gYUE7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjQjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBwb3NpdGlvbkVycm9yIDw9IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCAmJiBhbmd1bGFyRXJyb3IgPD0gU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcDtcbiAgICAgIH07XG4gICAgICBSZXZvbHV0ZUpvaW50Mi5UWVBFID0gXCJyZXZvbHV0ZS1qb2ludFwiO1xuICAgICAgcmV0dXJuIFJldm9sdXRlSm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBtYXRoX2FicyQzID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX21heCA9IE1hdGgubWF4O1xuICB2YXIgbWF0aF9taW4kMiA9IE1hdGgubWluO1xuICB2YXIgTGltaXRTdGF0ZSQxO1xuICAoZnVuY3Rpb24oTGltaXRTdGF0ZTIpIHtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImluYWN0aXZlTGltaXRcIl0gPSAwXSA9IFwiaW5hY3RpdmVMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiYXRMb3dlckxpbWl0XCJdID0gMV0gPSBcImF0TG93ZXJMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiYXRVcHBlckxpbWl0XCJdID0gMl0gPSBcImF0VXBwZXJMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiZXF1YWxMaW1pdHNcIl0gPSAzXSA9IFwiZXF1YWxMaW1pdHNcIjtcbiAgfSkoTGltaXRTdGF0ZSQxIHx8IChMaW1pdFN0YXRlJDEgPSB7fSkpO1xuICB2YXIgREVGQVVMVFMkNyA9IHtcbiAgICBlbmFibGVMaW1pdDogZmFsc2UsXG4gICAgbG93ZXJUcmFuc2xhdGlvbjogMCxcbiAgICB1cHBlclRyYW5zbGF0aW9uOiAwLFxuICAgIGVuYWJsZU1vdG9yOiBmYWxzZSxcbiAgICBtYXhNb3RvckZvcmNlOiAwLFxuICAgIG1vdG9yU3BlZWQ6IDBcbiAgfTtcbiAgdmFyIFByaXNtYXRpY0pvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhQcmlzbWF0aWNKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBQcmlzbWF0aWNKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvciwgYXhpcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIFByaXNtYXRpY0pvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFByaXNtYXRpY0pvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yLCBheGlzKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkNyk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBQcmlzbWF0aWNKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxYQXhpc0EgPSBWZWMyLmNsb25lKGF4aXMgPyBib2R5QS5nZXRMb2NhbFZlY3RvcihheGlzKSA6IGRlZi5sb2NhbEF4aXNBIHx8IFZlYzIubmVvKDEsIDApKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbFhBeGlzQS5ub3JtYWxpemUoKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbFlBeGlzQSA9IFZlYzIuY3Jvc3NOdW1WZWMyKDEsIF90aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlID0gTnVtYmVyLmlzRmluaXRlKGRlZi5yZWZlcmVuY2VBbmdsZSkgPyBkZWYucmVmZXJlbmNlQW5nbGUgOiBib2R5Qi5nZXRBbmdsZSgpIC0gYm9keUEuZ2V0QW5nbGUoKTtcbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gbmV3IFZlYzMoKTtcbiAgICAgICAgX3RoaXMubV9tb3Rvck1hc3MgPSAwO1xuICAgICAgICBfdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGRlZi5sb3dlclRyYW5zbGF0aW9uO1xuICAgICAgICBfdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gPSBkZWYudXBwZXJUcmFuc2xhdGlvbjtcbiAgICAgICAgX3RoaXMubV9tYXhNb3RvckZvcmNlID0gZGVmLm1heE1vdG9yRm9yY2U7XG4gICAgICAgIF90aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xuICAgICAgICBfdGhpcy5tX2VuYWJsZUxpbWl0ID0gZGVmLmVuYWJsZUxpbWl0O1xuICAgICAgICBfdGhpcy5tX2VuYWJsZU1vdG9yID0gZGVmLmVuYWJsZU1vdG9yO1xuICAgICAgICBfdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDEuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgX3RoaXMubV9heGlzID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fcGVycCA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX0sgPSBuZXcgTWF0MzMoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGxvd2VyVHJhbnNsYXRpb246IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uLFxuICAgICAgICAgIHVwcGVyVHJhbnNsYXRpb246IHRoaXMubV91cHBlclRyYW5zbGF0aW9uLFxuICAgICAgICAgIG1heE1vdG9yRm9yY2U6IHRoaXMubV9tYXhNb3RvckZvcmNlLFxuICAgICAgICAgIG1vdG9yU3BlZWQ6IHRoaXMubV9tb3RvclNwZWVkLFxuICAgICAgICAgIGVuYWJsZUxpbWl0OiB0aGlzLm1fZW5hYmxlTGltaXQsXG4gICAgICAgICAgZW5hYmxlTW90b3I6IHRoaXMubV9lbmFibGVNb3RvcixcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCLFxuICAgICAgICAgIGxvY2FsQXhpc0E6IHRoaXMubV9sb2NhbFhBeGlzQSxcbiAgICAgICAgICByZWZlcmVuY2VBbmdsZTogdGhpcy5tX3JlZmVyZW5jZUFuZ2xlXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICBkYXRhLmxvY2FsQXhpc0EgPSBWZWMyLmNsb25lKGRhdGEubG9jYWxBeGlzQSk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBQcmlzbWF0aWNKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoZGVmLmFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIodGhpcy5tX2JvZHlBLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckEpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMih0aGlzLm1fYm9keUIuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQikpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZi5sb2NhbEF4aXNBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsWEF4aXNBLnNldFZlYzIoZGVmLmxvY2FsQXhpc0EpO1xuICAgICAgICAgIHRoaXMubV9sb2NhbFlBeGlzQS5zZXRWZWMyKFZlYzIuY3Jvc3NOdW1WZWMyKDEsIGRlZi5sb2NhbEF4aXNBKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYucmVmZXJlbmNlQW5nbGUpKSB7XG4gICAgICAgICAgdGhpcy5tX3JlZmVyZW5jZUFuZ2xlID0gZGVmLnJlZmVyZW5jZUFuZ2xlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZGVmLmVuYWJsZUxpbWl0ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gISFkZWYuZW5hYmxlTGltaXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubG93ZXJUcmFuc2xhdGlvbikpIHtcbiAgICAgICAgICB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGRlZi5sb3dlclRyYW5zbGF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLnVwcGVyVHJhbnNsYXRpb24pKSB7XG4gICAgICAgICAgdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gPSBkZWYudXBwZXJUcmFuc2xhdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGRlZi5lbmFibGVNb3RvciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9ICEhZGVmLmVuYWJsZU1vdG9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLm1heE1vdG9yRm9yY2UpKSB7XG4gICAgICAgICAgdGhpcy5tX21heE1vdG9yRm9yY2UgPSBkZWYubWF4TW90b3JGb3JjZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tb3RvclNwZWVkKSkge1xuICAgICAgICAgIHRoaXMubV9tb3RvclNwZWVkID0gZGVmLm1vdG9yU3BlZWQ7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldExvY2FsQXhpc0EgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbFhBeGlzQTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldFJlZmVyZW5jZUFuZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludFRyYW5zbGF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwQTIgPSB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgICAgdmFyIHBCMiA9IHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihwQjIsIHBBMik7XG4gICAgICAgIHZhciBheGlzID0gdGhpcy5tX2JvZHlBLmdldFdvcmxkVmVjdG9yKHRoaXMubV9sb2NhbFhBeGlzQSk7XG4gICAgICAgIHZhciB0cmFuc2xhdGlvbjIgPSBWZWMyLmRvdChkMiwgYXhpcyk7XG4gICAgICAgIHJldHVybiB0cmFuc2xhdGlvbjI7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludFNwZWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIoYkEubV94Zi5xLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyKSk7XG4gICAgICAgIHZhciByQjIgPSBSb3QubXVsVmVjMihiQi5tX3hmLnEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIpKTtcbiAgICAgICAgdmFyIHAxID0gVmVjMi5hZGQoYkEubV9zd2VlcC5jLCByQTIpO1xuICAgICAgICB2YXIgcDIgPSBWZWMyLmFkZChiQi5tX3N3ZWVwLmMsIHJCMik7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuc3ViKHAyLCBwMSk7XG4gICAgICAgIHZhciBheGlzID0gUm90Lm11bFZlYzIoYkEubV94Zi5xLCB0aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICB2YXIgdkEyID0gYkEubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgICAgdmFyIHZCMiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICAgIHZhciB3QSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICB2YXIgd0IgPSBiQi5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgdmFyIHNwZWVkID0gVmVjMi5kb3QoZDIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCBheGlzKSkgKyBWZWMyLmRvdChheGlzLCBWZWMyLnN1YihWZWMyLmFkZENyb3NzTnVtVmVjMih2QjIsIHdCLCByQjIpLCBWZWMyLmFkZENyb3NzTnVtVmVjMih2QTIsIHdBLCByQTIpKSk7XG4gICAgICAgIHJldHVybiBzcGVlZDtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmlzTGltaXRFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTGltaXQ7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5lbmFibGVMaW1pdCA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICAgICAgaWYgKGZsYWcgIT0gdGhpcy5tX2VuYWJsZUxpbWl0KSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSBmbGFnO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRMb3dlckxpbWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbjtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldFVwcGVyTGltaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV91cHBlclRyYW5zbGF0aW9uO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuc2V0TGltaXRzID0gZnVuY3Rpb24obG93ZXIsIHVwcGVyKSB7XG4gICAgICAgIGlmIChsb3dlciAhPSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiB8fCB1cHBlciAhPSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gPSBsb3dlcjtcbiAgICAgICAgICB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiA9IHVwcGVyO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5pc01vdG9yRW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZU1vdG9yO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZW5hYmxlTW90b3IgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgICAgIGlmIChmbGFnID09IHRoaXMubV9lbmFibGVNb3RvcilcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBmbGFnO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuc2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uKHNwZWVkKSB7XG4gICAgICAgIGlmIChzcGVlZCA9PSB0aGlzLm1fbW90b3JTcGVlZClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IHNwZWVkO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuc2V0TWF4TW90b3JGb3JjZSA9IGZ1bmN0aW9uKGZvcmNlKSB7XG4gICAgICAgIGlmIChmb3JjZSA9PSB0aGlzLm1fbWF4TW90b3JGb3JjZSlcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fbWF4TW90b3JGb3JjZSA9IGZvcmNlO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0TWF4TW90b3JGb3JjZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heE1vdG9yRm9yY2U7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRNb3RvclNwZWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbW90b3JTcGVlZDtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldE1vdG9yRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5jb21iaW5lKHRoaXMubV9pbXB1bHNlLngsIHRoaXMubV9wZXJwLCB0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueiwgdGhpcy5tX2F4aXMpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLnk7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIGQyLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICBkMi5zdWJDb21iaW5lKDEsIGNBMiwgMSwgckEyKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB7XG4gICAgICAgICAgdGhpcy5tX2F4aXMgPSBSb3QubXVsVmVjMihxQSwgdGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgICB0aGlzLm1fYTEgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIHRoaXMubV9heGlzKTtcbiAgICAgICAgICB0aGlzLm1fYTIgPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IG1BICsgbUIgKyBpQSAqIHRoaXMubV9hMSAqIHRoaXMubV9hMSArIGlCICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xuICAgICAgICAgIGlmICh0aGlzLm1fbW90b3JNYXNzID4gMCkge1xuICAgICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IDEgLyB0aGlzLm1fbW90b3JNYXNzO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgdGhpcy5tX3BlcnAgPSBSb3QubXVsVmVjMihxQSwgdGhpcy5tX2xvY2FsWUF4aXNBKTtcbiAgICAgICAgICB0aGlzLm1fczEgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIHRoaXMubV9wZXJwKTtcbiAgICAgICAgICB0aGlzLm1fczIgPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB0aGlzLm1fcGVycCk7XG4gICAgICAgICAgVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgdGhpcy5tX3BlcnApO1xuICAgICAgICAgIHZhciBrMTEgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fczEgKiB0aGlzLm1fczEgKyBpQiAqIHRoaXMubV9zMiAqIHRoaXMubV9zMjtcbiAgICAgICAgICB2YXIgazEyID0gaUEgKiB0aGlzLm1fczEgKyBpQiAqIHRoaXMubV9zMjtcbiAgICAgICAgICB2YXIgazEzID0gaUEgKiB0aGlzLm1fczEgKiB0aGlzLm1fYTEgKyBpQiAqIHRoaXMubV9zMiAqIHRoaXMubV9hMjtcbiAgICAgICAgICB2YXIgazIyID0gaUEgKyBpQjtcbiAgICAgICAgICBpZiAoazIyID09IDApIHtcbiAgICAgICAgICAgIGsyMiA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBrMjMgPSBpQSAqIHRoaXMubV9hMSArIGlCICogdGhpcy5tX2EyO1xuICAgICAgICAgIHZhciBrMzMgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fYTEgKiB0aGlzLm1fYTEgKyBpQiAqIHRoaXMubV9hMiAqIHRoaXMubV9hMjtcbiAgICAgICAgICB0aGlzLm1fSy5leC5zZXQoazExLCBrMTIsIGsxMyk7XG4gICAgICAgICAgdGhpcy5tX0suZXkuc2V0KGsxMiwgazIyLCBrMjMpO1xuICAgICAgICAgIHRoaXMubV9LLmV6LnNldChrMTMsIGsyMywgazMzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0KSB7XG4gICAgICAgICAgdmFyIGpvaW50VHJhbnNsYXRpb24gPSBWZWMyLmRvdCh0aGlzLm1fYXhpcywgZDIpO1xuICAgICAgICAgIGlmIChtYXRoX2FicyQzKHRoaXMubV91cHBlclRyYW5zbGF0aW9uIC0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24pIDwgMiAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCkge1xuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDEuZXF1YWxMaW1pdHM7XG4gICAgICAgICAgfSBlbHNlIGlmIChqb2ludFRyYW5zbGF0aW9uIDw9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQxLmF0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMS5hdExvd2VyTGltaXQ7XG4gICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoam9pbnRUcmFuc2xhdGlvbiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMS5hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDEuYXRVcHBlckxpbWl0O1xuICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBMaW1pdFN0YXRlJDEuaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IExpbWl0U3RhdGUkMS5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5tdWwoc3RlcC5kdFJhdGlvKTtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLmNvbWJpbmUodGhpcy5tX2ltcHVsc2UueCwgdGhpcy5tX3BlcnAsIHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56LCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgdmFyIExBID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9zMSArIHRoaXMubV9pbXB1bHNlLnkgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopICogdGhpcy5tX2ExO1xuICAgICAgICAgIHZhciBMQiA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fczIgKyB0aGlzLm1faW1wdWxzZS55ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KSAqIHRoaXMubV9hMjtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBMQTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBMQjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBQcmlzbWF0aWNKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gTGltaXRTdGF0ZSQxLmVxdWFsTGltaXRzKSB7XG4gICAgICAgICAgdmFyIENkb3QgPSBWZWMyLmRvdCh0aGlzLm1fYXhpcywgVmVjMi5zdWIodkIyLCB2QTIpKSArIHRoaXMubV9hMiAqIHdCIC0gdGhpcy5tX2ExICogd0E7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSB0aGlzLm1fbW90b3JNYXNzICogKHRoaXMubV9tb3RvclNwZWVkIC0gQ2RvdCk7XG4gICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgICAgIHZhciBtYXhJbXB1bHNlID0gc3RlcC5kdCAqIHRoaXMubV9tYXhNb3RvckZvcmNlO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSBjbGFtcCh0aGlzLm1fbW90b3JJbXB1bHNlICsgaW1wdWxzZSwgLW1heEltcHVsc2UsIG1heEltcHVsc2UpO1xuICAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoaW1wdWxzZSwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgIHZhciBMQSA9IGltcHVsc2UgKiB0aGlzLm1fYTE7XG4gICAgICAgICAgdmFyIExCID0gaW1wdWxzZSAqIHRoaXMubV9hMjtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBMQTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBMQjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgQ2RvdDEgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgQ2RvdDEueCArPSBWZWMyLmRvdCh0aGlzLm1fcGVycCwgdkIyKSArIHRoaXMubV9zMiAqIHdCO1xuICAgICAgICBDZG90MS54IC09IFZlYzIuZG90KHRoaXMubV9wZXJwLCB2QTIpICsgdGhpcy5tX3MxICogd0E7XG4gICAgICAgIENkb3QxLnkgPSB3QiAtIHdBO1xuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0ICYmIHRoaXMubV9saW1pdFN0YXRlICE9IExpbWl0U3RhdGUkMS5pbmFjdGl2ZUxpbWl0KSB7XG4gICAgICAgICAgdmFyIENkb3QyID0gMDtcbiAgICAgICAgICBDZG90MiArPSBWZWMyLmRvdCh0aGlzLm1fYXhpcywgdkIyKSArIHRoaXMubV9hMiAqIHdCO1xuICAgICAgICAgIENkb3QyIC09IFZlYzIuZG90KHRoaXMubV9heGlzLCB2QTIpICsgdGhpcy5tX2ExICogd0E7XG4gICAgICAgICAgdmFyIENkb3QgPSBuZXcgVmVjMyhDZG90MS54LCBDZG90MS55LCBDZG90Mik7XG4gICAgICAgICAgdmFyIGYxID0gVmVjMy5jbG9uZSh0aGlzLm1faW1wdWxzZSk7XG4gICAgICAgICAgdmFyIGRmID0gdGhpcy5tX0suc29sdmUzMyhWZWMzLm5lZyhDZG90KSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UuYWRkKGRmKTtcbiAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQxLmF0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IG1hdGhfbWF4KHRoaXMubV9pbXB1bHNlLnosIDApO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gTGltaXRTdGF0ZSQxLmF0VXBwZXJMaW1pdCkge1xuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IG1hdGhfbWluJDIodGhpcy5tX2ltcHVsc2UueiwgMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBiMiA9IFZlYzIuY29tYmluZSgtMSwgQ2RvdDEsIC0odGhpcy5tX2ltcHVsc2UueiAtIGYxLnopLCBWZWMyLm5lbyh0aGlzLm1fSy5lei54LCB0aGlzLm1fSy5lei55KSk7XG4gICAgICAgICAgdmFyIGYyciA9IFZlYzIuYWRkKHRoaXMubV9LLnNvbHZlMjIoYjIpLCBWZWMyLm5lbyhmMS54LCBmMS55KSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCA9IGYyci54O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSBmMnIueTtcbiAgICAgICAgICBkZiA9IFZlYzMuc3ViKHRoaXMubV9pbXB1bHNlLCBmMSk7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5jb21iaW5lKGRmLngsIHRoaXMubV9wZXJwLCBkZi56LCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgdmFyIExBID0gZGYueCAqIHRoaXMubV9zMSArIGRmLnkgKyBkZi56ICogdGhpcy5tX2ExO1xuICAgICAgICAgIHZhciBMQiA9IGRmLnggKiB0aGlzLm1fczIgKyBkZi55ICsgZGYueiAqIHRoaXMubV9hMjtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBMQTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiBMQjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgZGYgPSB0aGlzLm1fSy5zb2x2ZTIyKFZlYzIubmVnKENkb3QxKSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSBkZi54O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gZGYueTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoZGYueCwgdGhpcy5tX3BlcnApO1xuICAgICAgICAgIHZhciBMQSA9IGRmLnggKiB0aGlzLm1fczEgKyBkZi55O1xuICAgICAgICAgIHZhciBMQiA9IGRmLnggKiB0aGlzLm1fczIgKyBkZi55O1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIExBO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIExCO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFByaXNtYXRpY0pvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBkMiA9IFZlYzIuc3ViKFZlYzIuYWRkKGNCMiwgckIyKSwgVmVjMi5hZGQoY0EyLCByQTIpKTtcbiAgICAgICAgdmFyIGF4aXMgPSBSb3QubXVsVmVjMihxQSwgdGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgdmFyIGExID0gVmVjMi5jcm9zc1ZlYzJWZWMyKFZlYzIuYWRkKGQyLCByQTIpLCBheGlzKTtcbiAgICAgICAgdmFyIGEyID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgYXhpcyk7XG4gICAgICAgIHZhciBwZXJwMiA9IFJvdC5tdWxWZWMyKHFBLCB0aGlzLm1fbG9jYWxZQXhpc0EpO1xuICAgICAgICB2YXIgczEgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIHBlcnAyKTtcbiAgICAgICAgdmFyIHMyID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgcGVycDIpO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IG5ldyBWZWMzKCk7XG4gICAgICAgIHZhciBDMSA9IFZlYzIuemVybygpO1xuICAgICAgICBDMS54ID0gVmVjMi5kb3QocGVycDIsIGQyKTtcbiAgICAgICAgQzEueSA9IGFCIC0gYUEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgIHZhciBsaW5lYXJFcnJvciA9IG1hdGhfYWJzJDMoQzEueCk7XG4gICAgICAgIHZhciBhbmd1bGFyRXJyb3IgPSBtYXRoX2FicyQzKEMxLnkpO1xuICAgICAgICB2YXIgbGluZWFyU2xvcCA9IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgICAgdmFyIG1heExpbmVhckNvcnJlY3Rpb24gPSBTZXR0aW5nc0ludGVybmFsLm1heExpbmVhckNvcnJlY3Rpb247XG4gICAgICAgIHZhciBhY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdmFyIEMyID0gMDtcbiAgICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCkge1xuICAgICAgICAgIHZhciB0cmFuc2xhdGlvbjIgPSBWZWMyLmRvdChheGlzLCBkMik7XG4gICAgICAgICAgaWYgKG1hdGhfYWJzJDModGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikgPCAyICogbGluZWFyU2xvcCkge1xuICAgICAgICAgICAgQzIgPSBjbGFtcCh0cmFuc2xhdGlvbjIsIC1tYXhMaW5lYXJDb3JyZWN0aW9uLCBtYXhMaW5lYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gbWF0aF9tYXgobGluZWFyRXJyb3IsIG1hdGhfYWJzJDModHJhbnNsYXRpb24yKSk7XG4gICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSBpZiAodHJhbnNsYXRpb24yIDw9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICBDMiA9IGNsYW1wKHRyYW5zbGF0aW9uMiAtIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uICsgbGluZWFyU2xvcCwgLW1heExpbmVhckNvcnJlY3Rpb24sIDApO1xuICAgICAgICAgICAgbGluZWFyRXJyb3IgPSBNYXRoLm1heChsaW5lYXJFcnJvciwgdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gLSB0cmFuc2xhdGlvbjIpO1xuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRyYW5zbGF0aW9uMiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgICAgQzIgPSBjbGFtcCh0cmFuc2xhdGlvbjIgLSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiAtIGxpbmVhclNsb3AsIDAsIG1heExpbmVhckNvcnJlY3Rpb24pO1xuICAgICAgICAgICAgbGluZWFyRXJyb3IgPSBNYXRoLm1heChsaW5lYXJFcnJvciwgdHJhbnNsYXRpb24yIC0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24pO1xuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGl2ZSkge1xuICAgICAgICAgIHZhciBrMTEgPSBtQSArIG1CICsgaUEgKiBzMSAqIHMxICsgaUIgKiBzMiAqIHMyO1xuICAgICAgICAgIHZhciBrMTIgPSBpQSAqIHMxICsgaUIgKiBzMjtcbiAgICAgICAgICB2YXIgazEzID0gaUEgKiBzMSAqIGExICsgaUIgKiBzMiAqIGEyO1xuICAgICAgICAgIHZhciBrMjIgPSBpQSArIGlCO1xuICAgICAgICAgIGlmIChrMjIgPT0gMCkge1xuICAgICAgICAgICAgazIyID0gMTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGsyMyA9IGlBICogYTEgKyBpQiAqIGEyO1xuICAgICAgICAgIHZhciBrMzMgPSBtQSArIG1CICsgaUEgKiBhMSAqIGExICsgaUIgKiBhMiAqIGEyO1xuICAgICAgICAgIHZhciBLID0gbmV3IE1hdDMzKCk7XG4gICAgICAgICAgSy5leC5zZXQoazExLCBrMTIsIGsxMyk7XG4gICAgICAgICAgSy5leS5zZXQoazEyLCBrMjIsIGsyMyk7XG4gICAgICAgICAgSy5lei5zZXQoazEzLCBrMjMsIGszMyk7XG4gICAgICAgICAgdmFyIEMgPSBuZXcgVmVjMygpO1xuICAgICAgICAgIEMueCA9IEMxLng7XG4gICAgICAgICAgQy55ID0gQzEueTtcbiAgICAgICAgICBDLnogPSBDMjtcbiAgICAgICAgICBpbXB1bHNlID0gSy5zb2x2ZTMzKFZlYzMubmVnKEMpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgazExID0gbUEgKyBtQiArIGlBICogczEgKiBzMSArIGlCICogczIgKiBzMjtcbiAgICAgICAgICB2YXIgazEyID0gaUEgKiBzMSArIGlCICogczI7XG4gICAgICAgICAgdmFyIGsyMiA9IGlBICsgaUI7XG4gICAgICAgICAgaWYgKGsyMiA9PSAwKSB7XG4gICAgICAgICAgICBrMjIgPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgSyA9IG5ldyBNYXQyMigpO1xuICAgICAgICAgIEsuZXguc2V0TnVtKGsxMSwgazEyKTtcbiAgICAgICAgICBLLmV5LnNldE51bShrMTIsIGsyMik7XG4gICAgICAgICAgdmFyIGltcHVsc2UxID0gSy5zb2x2ZShWZWMyLm5lZyhDMSkpO1xuICAgICAgICAgIGltcHVsc2UueCA9IGltcHVsc2UxLng7XG4gICAgICAgICAgaW1wdWxzZS55ID0gaW1wdWxzZTEueTtcbiAgICAgICAgICBpbXB1bHNlLnogPSAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciBQMyA9IFZlYzIuY29tYmluZShpbXB1bHNlLngsIHBlcnAyLCBpbXB1bHNlLnosIGF4aXMpO1xuICAgICAgICB2YXIgTEEgPSBpbXB1bHNlLnggKiBzMSArIGltcHVsc2UueSArIGltcHVsc2UueiAqIGExO1xuICAgICAgICB2YXIgTEIgPSBpbXB1bHNlLnggKiBzMiArIGltcHVsc2UueSArIGltcHVsc2UueiAqIGEyO1xuICAgICAgICBjQTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgIGFBIC09IGlBICogTEE7XG4gICAgICAgIGNCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgYUIgKz0gaUIgKiBMQjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYyA9IGNBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jID0gY0IyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBsaW5lYXJFcnJvciA8PSBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3AgJiYgYW5ndWxhckVycm9yIDw9IFNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsb3A7XG4gICAgICB9O1xuICAgICAgUHJpc21hdGljSm9pbnQyLlRZUEUgPSBcInByaXNtYXRpYy1qb2ludFwiO1xuICAgICAgcmV0dXJuIFByaXNtYXRpY0pvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgREVGQVVMVFMkNiA9IHtcbiAgICByYXRpbzogMVxuICB9O1xuICB2YXIgR2VhckpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhHZWFySm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gR2VhckpvaW50MihkZWYsIGJvZHlBLCBib2R5Qiwgam9pbnQxLCBqb2ludDIsIHJhdGlvKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgR2VhckpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEdlYXJKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGpvaW50MSwgam9pbnQyLCByYXRpbyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDYpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gR2VhckpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2pvaW50MSA9IGpvaW50MSA/IGpvaW50MSA6IGRlZi5qb2ludDE7XG4gICAgICAgIF90aGlzLm1fam9pbnQyID0gam9pbnQyID8gam9pbnQyIDogZGVmLmpvaW50MjtcbiAgICAgICAgX3RoaXMubV9yYXRpbyA9IE51bWJlci5pc0Zpbml0ZShyYXRpbykgPyByYXRpbyA6IGRlZi5yYXRpbztcbiAgICAgICAgX3RoaXMubV90eXBlMSA9IF90aGlzLm1fam9pbnQxLmdldFR5cGUoKTtcbiAgICAgICAgX3RoaXMubV90eXBlMiA9IF90aGlzLm1fam9pbnQyLmdldFR5cGUoKTtcbiAgICAgICAgdmFyIGNvb3JkaW5hdGVBO1xuICAgICAgICB2YXIgY29vcmRpbmF0ZUI7XG4gICAgICAgIF90aGlzLm1fYm9keUMgPSBfdGhpcy5tX2pvaW50MS5nZXRCb2R5QSgpO1xuICAgICAgICBfdGhpcy5tX2JvZHlBID0gX3RoaXMubV9qb2ludDEuZ2V0Qm9keUIoKTtcbiAgICAgICAgdmFyIHhmQTIgPSBfdGhpcy5tX2JvZHlBLm1feGY7XG4gICAgICAgIHZhciBhQSA9IF90aGlzLm1fYm9keUEubV9zd2VlcC5hO1xuICAgICAgICB2YXIgeGZDID0gX3RoaXMubV9ib2R5Qy5tX3hmO1xuICAgICAgICB2YXIgYUMgPSBfdGhpcy5tX2JvZHlDLm1fc3dlZXAuYTtcbiAgICAgICAgaWYgKF90aGlzLm1fdHlwZTEgPT09IFJldm9sdXRlSm9pbnQuVFlQRSkge1xuICAgICAgICAgIHZhciByZXZvbHV0ZSA9IF90aGlzLm1fam9pbnQxO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JDID0gcmV2b2x1dGUubV9sb2NhbEFuY2hvckE7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSByZXZvbHV0ZS5tX2xvY2FsQW5jaG9yQjtcbiAgICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQSA9IHJldm9sdXRlLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEF4aXNDID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgY29vcmRpbmF0ZUEgPSBhQSAtIGFDIC0gX3RoaXMubV9yZWZlcmVuY2VBbmdsZUE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHByaXNtYXRpYyA9IF90aGlzLm1fam9pbnQxO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JDID0gcHJpc21hdGljLm1fbG9jYWxBbmNob3JBO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gcHJpc21hdGljLm1fbG9jYWxBbmNob3JCO1xuICAgICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGVBID0gcHJpc21hdGljLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbEF4aXNDID0gcHJpc21hdGljLm1fbG9jYWxYQXhpc0E7XG4gICAgICAgICAgdmFyIHBDID0gX3RoaXMubV9sb2NhbEFuY2hvckM7XG4gICAgICAgICAgdmFyIHBBMiA9IFJvdC5tdWxUVmVjMih4ZkMucSwgVmVjMi5hZGQoUm90Lm11bFZlYzIoeGZBMi5xLCBfdGhpcy5tX2xvY2FsQW5jaG9yQSksIFZlYzIuc3ViKHhmQTIucCwgeGZDLnApKSk7XG4gICAgICAgICAgY29vcmRpbmF0ZUEgPSBWZWMyLmRvdChwQTIsIF90aGlzLm1fbG9jYWxBeGlzQykgLSBWZWMyLmRvdChwQywgX3RoaXMubV9sb2NhbEF4aXNDKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5tX2JvZHlEID0gX3RoaXMubV9qb2ludDIuZ2V0Qm9keUEoKTtcbiAgICAgICAgX3RoaXMubV9ib2R5QiA9IF90aGlzLm1fam9pbnQyLmdldEJvZHlCKCk7XG4gICAgICAgIHZhciB4ZkIyID0gX3RoaXMubV9ib2R5Qi5tX3hmO1xuICAgICAgICB2YXIgYUIgPSBfdGhpcy5tX2JvZHlCLm1fc3dlZXAuYTtcbiAgICAgICAgdmFyIHhmRCA9IF90aGlzLm1fYm9keUQubV94ZjtcbiAgICAgICAgdmFyIGFEID0gX3RoaXMubV9ib2R5RC5tX3N3ZWVwLmE7XG4gICAgICAgIGlmIChfdGhpcy5tX3R5cGUyID09PSBSZXZvbHV0ZUpvaW50LlRZUEUpIHtcbiAgICAgICAgICB2YXIgcmV2b2x1dGUgPSBfdGhpcy5tX2pvaW50MjtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yRCA9IHJldm9sdXRlLm1fbG9jYWxBbmNob3JBO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gcmV2b2x1dGUubV9sb2NhbEFuY2hvckI7XG4gICAgICAgICAgX3RoaXMubV9yZWZlcmVuY2VBbmdsZUIgPSByZXZvbHV0ZS5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBeGlzRCA9IFZlYzIuemVybygpO1xuICAgICAgICAgIGNvb3JkaW5hdGVCID0gYUIgLSBhRCAtIF90aGlzLm1fcmVmZXJlbmNlQW5nbGVCO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBwcmlzbWF0aWMgPSBfdGhpcy5tX2pvaW50MjtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yRCA9IHByaXNtYXRpYy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IHByaXNtYXRpYy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgICAgICBfdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQiA9IHByaXNtYXRpYy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxBeGlzRCA9IHByaXNtYXRpYy5tX2xvY2FsWEF4aXNBO1xuICAgICAgICAgIHZhciBwRCA9IF90aGlzLm1fbG9jYWxBbmNob3JEO1xuICAgICAgICAgIHZhciBwQjIgPSBSb3QubXVsVFZlYzIoeGZELnEsIFZlYzIuYWRkKFJvdC5tdWxWZWMyKHhmQjIucSwgX3RoaXMubV9sb2NhbEFuY2hvckIpLCBWZWMyLnN1Yih4ZkIyLnAsIHhmRC5wKSkpO1xuICAgICAgICAgIGNvb3JkaW5hdGVCID0gVmVjMi5kb3QocEIyLCBfdGhpcy5tX2xvY2FsQXhpc0QpIC0gVmVjMi5kb3QocEQsIF90aGlzLm1fbG9jYWxBeGlzRCk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMubV9jb25zdGFudCA9IGNvb3JkaW5hdGVBICsgX3RoaXMubV9yYXRpbyAqIGNvb3JkaW5hdGVCO1xuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGpvaW50MTogdGhpcy5tX2pvaW50MSxcbiAgICAgICAgICBqb2ludDI6IHRoaXMubV9qb2ludDIsXG4gICAgICAgICAgcmF0aW86IHRoaXMubV9yYXRpb1xuICAgICAgICAgIC8vIF9jb25zdGFudDogdGhpcy5tX2NvbnN0YW50LFxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuam9pbnQxID0gcmVzdG9yZShKb2ludCwgZGF0YS5qb2ludDEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5qb2ludDIgPSByZXN0b3JlKEpvaW50LCBkYXRhLmpvaW50Miwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgR2VhckpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5yYXRpbykpIHtcbiAgICAgICAgICB0aGlzLm1fcmF0aW8gPSBkZWYucmF0aW87XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRKb2ludDEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9qb2ludDE7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnQyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fam9pbnQyO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLnNldFJhdGlvID0gZnVuY3Rpb24ocmF0aW8pIHtcbiAgICAgICAgdGhpcy5tX3JhdGlvID0gcmF0aW87XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuZ2V0UmF0aW8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yYXRpbztcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm11bE51bVZlYzIodGhpcy5tX2ltcHVsc2UsIHRoaXMubV9KdkFDKS5tdWwoaW52X2R0KTtcbiAgICAgIH07XG4gICAgICBHZWFySm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICB2YXIgTCA9IHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0p3QTtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIEw7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sY0EgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xjQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbGNDID0gdGhpcy5tX2JvZHlDLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sY0QgPSB0aGlzLm1fYm9keUQubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX21BID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX21CID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX21DID0gdGhpcy5tX2JvZHlDLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX21EID0gdGhpcy5tX2JvZHlELm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2lBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2lCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdGhpcy5tX2lDID0gdGhpcy5tX2JvZHlDLm1faW52STtcbiAgICAgICAgdGhpcy5tX2lEID0gdGhpcy5tX2JvZHlELm1faW52STtcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgYUMgPSB0aGlzLm1fYm9keUMuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkMgPSB0aGlzLm1fYm9keUMuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0MgPSB0aGlzLm1fYm9keUMuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgYUQgPSB0aGlzLm1fYm9keUQuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkQgPSB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0QgPSB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciBxQyA9IFJvdC5uZW8oYUMpO1xuICAgICAgICB2YXIgcUQgPSBSb3QubmVvKGFEKTtcbiAgICAgICAgdGhpcy5tX21hc3MgPSAwO1xuICAgICAgICBpZiAodGhpcy5tX3R5cGUxID09IFJldm9sdXRlSm9pbnQuVFlQRSkge1xuICAgICAgICAgIHRoaXMubV9KdkFDID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX0p3QSA9IDE7XG4gICAgICAgICAgdGhpcy5tX0p3QyA9IDE7XG4gICAgICAgICAgdGhpcy5tX21hc3MgKz0gdGhpcy5tX2lBICsgdGhpcy5tX2lDO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciB1ID0gUm90Lm11bFZlYzIocUMsIHRoaXMubV9sb2NhbEF4aXNDKTtcbiAgICAgICAgICB2YXIgckMgPSBSb3QubXVsU3ViKHFDLCB0aGlzLm1fbG9jYWxBbmNob3JDLCB0aGlzLm1fbGNDKTtcbiAgICAgICAgICB2YXIgckEyID0gUm90Lm11bFN1YihxQSwgdGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xjQSk7XG4gICAgICAgICAgdGhpcy5tX0p2QUMgPSB1O1xuICAgICAgICAgIHRoaXMubV9Kd0MgPSBWZWMyLmNyb3NzVmVjMlZlYzIockMsIHUpO1xuICAgICAgICAgIHRoaXMubV9Kd0EgPSBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCB1KTtcbiAgICAgICAgICB0aGlzLm1fbWFzcyArPSB0aGlzLm1fbUMgKyB0aGlzLm1fbUEgKyB0aGlzLm1faUMgKiB0aGlzLm1fSndDICogdGhpcy5tX0p3QyArIHRoaXMubV9pQSAqIHRoaXMubV9Kd0EgKiB0aGlzLm1fSndBO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fdHlwZTIgPT0gUmV2b2x1dGVKb2ludC5UWVBFKSB7XG4gICAgICAgICAgdGhpcy5tX0p2QkQgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fSndCID0gdGhpcy5tX3JhdGlvO1xuICAgICAgICAgIHRoaXMubV9Kd0QgPSB0aGlzLm1fcmF0aW87XG4gICAgICAgICAgdGhpcy5tX21hc3MgKz0gdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogKHRoaXMubV9pQiArIHRoaXMubV9pRCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHUgPSBSb3QubXVsVmVjMihxRCwgdGhpcy5tX2xvY2FsQXhpc0QpO1xuICAgICAgICAgIHZhciByRCA9IFJvdC5tdWxTdWIocUQsIHRoaXMubV9sb2NhbEFuY2hvckQsIHRoaXMubV9sY0QpO1xuICAgICAgICAgIHZhciByQjIgPSBSb3QubXVsU3ViKHFCLCB0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbGNCKTtcbiAgICAgICAgICB0aGlzLm1fSnZCRCA9IFZlYzIubXVsTnVtVmVjMih0aGlzLm1fcmF0aW8sIHUpO1xuICAgICAgICAgIHRoaXMubV9Kd0QgPSB0aGlzLm1fcmF0aW8gKiBWZWMyLmNyb3NzVmVjMlZlYzIockQsIHUpO1xuICAgICAgICAgIHRoaXMubV9Kd0IgPSB0aGlzLm1fcmF0aW8gKiBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB1KTtcbiAgICAgICAgICB0aGlzLm1fbWFzcyArPSB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiAodGhpcy5tX21EICsgdGhpcy5tX21CKSArIHRoaXMubV9pRCAqIHRoaXMubV9Kd0QgKiB0aGlzLm1fSndEICsgdGhpcy5tX2lCICogdGhpcy5tX0p3QiAqIHRoaXMubV9Kd0I7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX21hc3MgPSB0aGlzLm1fbWFzcyA+IDAgPyAxIC8gdGhpcy5tX21hc3MgOiAwO1xuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB2QTIuYWRkTXVsKHRoaXMubV9tQSAqIHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fSnZBQyk7XG4gICAgICAgICAgd0EgKz0gdGhpcy5tX2lBICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSndBO1xuICAgICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX21CICogdGhpcy5tX2ltcHVsc2UsIHRoaXMubV9KdkJEKTtcbiAgICAgICAgICB3QiArPSB0aGlzLm1faUIgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9Kd0I7XG4gICAgICAgICAgdkMuc3ViTXVsKHRoaXMubV9tQyAqIHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fSnZBQyk7XG4gICAgICAgICAgd0MgLT0gdGhpcy5tX2lDICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSndDO1xuICAgICAgICAgIHZELnN1Yk11bCh0aGlzLm1fbUQgKiB0aGlzLm1faW1wdWxzZSwgdGhpcy5tX0p2QkQpO1xuICAgICAgICAgIHdEIC09IHRoaXMubV9pRCAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0p3RDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZBMik7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZCMik7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgICAgdGhpcy5tX2JvZHlDLmNfdmVsb2NpdHkudi5zZXRWZWMyKHZDKTtcbiAgICAgICAgdGhpcy5tX2JvZHlDLmNfdmVsb2NpdHkudyA9IHdDO1xuICAgICAgICB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS52LnNldFZlYzIodkQpO1xuICAgICAgICB0aGlzLm1fYm9keUQuY192ZWxvY2l0eS53ID0gd0Q7XG4gICAgICB9O1xuICAgICAgR2VhckpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QyA9IHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QyA9IHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2RCA9IHRoaXMubV9ib2R5RC5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3RCA9IHRoaXMubV9ib2R5RC5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBDZG90ID0gVmVjMi5kb3QodGhpcy5tX0p2QUMsIHZBMikgLSBWZWMyLmRvdCh0aGlzLm1fSnZBQywgdkMpICsgVmVjMi5kb3QodGhpcy5tX0p2QkQsIHZCMikgLSBWZWMyLmRvdCh0aGlzLm1fSnZCRCwgdkQpO1xuICAgICAgICBDZG90ICs9IHRoaXMubV9Kd0EgKiB3QSAtIHRoaXMubV9Kd0MgKiB3QyArICh0aGlzLm1fSndCICogd0IgLSB0aGlzLm1fSndEICogd0QpO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IC10aGlzLm1fbWFzcyAqIENkb3Q7XG4gICAgICAgIHRoaXMubV9pbXB1bHNlICs9IGltcHVsc2U7XG4gICAgICAgIHZBMi5hZGRNdWwodGhpcy5tX21BICogaW1wdWxzZSwgdGhpcy5tX0p2QUMpO1xuICAgICAgICB3QSArPSB0aGlzLm1faUEgKiBpbXB1bHNlICogdGhpcy5tX0p3QTtcbiAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1fbUIgKiBpbXB1bHNlLCB0aGlzLm1fSnZCRCk7XG4gICAgICAgIHdCICs9IHRoaXMubV9pQiAqIGltcHVsc2UgKiB0aGlzLm1fSndCO1xuICAgICAgICB2Qy5zdWJNdWwodGhpcy5tX21DICogaW1wdWxzZSwgdGhpcy5tX0p2QUMpO1xuICAgICAgICB3QyAtPSB0aGlzLm1faUMgKiBpbXB1bHNlICogdGhpcy5tX0p3QztcbiAgICAgICAgdkQuc3ViTXVsKHRoaXMubV9tRCAqIGltcHVsc2UsIHRoaXMubV9KdkJEKTtcbiAgICAgICAgd0QgLT0gdGhpcy5tX2lEICogaW1wdWxzZSAqIHRoaXMubV9Kd0Q7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICAgIHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2Qyk7XG4gICAgICAgIHRoaXMubV9ib2R5Qy5jX3ZlbG9jaXR5LncgPSB3QztcbiAgICAgICAgdGhpcy5tX2JvZHlELmNfdmVsb2NpdHkudi5zZXRWZWMyKHZEKTtcbiAgICAgICAgdGhpcy5tX2JvZHlELmNfdmVsb2NpdHkudyA9IHdEO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0MgPSB0aGlzLm1fYm9keUMuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUMgPSB0aGlzLm1fYm9keUMuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgY0QgPSB0aGlzLm1fYm9keUQuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUQgPSB0aGlzLm1fYm9keUQuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciBxQyA9IFJvdC5uZW8oYUMpO1xuICAgICAgICB2YXIgcUQgPSBSb3QubmVvKGFEKTtcbiAgICAgICAgdmFyIGxpbmVhckVycm9yID0gMDtcbiAgICAgICAgdmFyIGNvb3JkaW5hdGVBO1xuICAgICAgICB2YXIgY29vcmRpbmF0ZUI7XG4gICAgICAgIHZhciBKdkFDO1xuICAgICAgICB2YXIgSnZCRDtcbiAgICAgICAgdmFyIEp3QTtcbiAgICAgICAgdmFyIEp3QjtcbiAgICAgICAgdmFyIEp3QztcbiAgICAgICAgdmFyIEp3RDtcbiAgICAgICAgdmFyIG1hc3MgPSAwO1xuICAgICAgICBpZiAodGhpcy5tX3R5cGUxID09IFJldm9sdXRlSm9pbnQuVFlQRSkge1xuICAgICAgICAgIEp2QUMgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBKd0EgPSAxO1xuICAgICAgICAgIEp3QyA9IDE7XG4gICAgICAgICAgbWFzcyArPSB0aGlzLm1faUEgKyB0aGlzLm1faUM7XG4gICAgICAgICAgY29vcmRpbmF0ZUEgPSBhQSAtIGFDIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgdSA9IFJvdC5tdWxWZWMyKHFDLCB0aGlzLm1fbG9jYWxBeGlzQyk7XG4gICAgICAgICAgdmFyIHJDID0gUm90Lm11bFN1YihxQywgdGhpcy5tX2xvY2FsQW5jaG9yQywgdGhpcy5tX2xjQyk7XG4gICAgICAgICAgdmFyIHJBMiA9IFJvdC5tdWxTdWIocUEsIHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sY0EpO1xuICAgICAgICAgIEp2QUMgPSB1O1xuICAgICAgICAgIEp3QyA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQywgdSk7XG4gICAgICAgICAgSndBID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHJBMiwgdSk7XG4gICAgICAgICAgbWFzcyArPSB0aGlzLm1fbUMgKyB0aGlzLm1fbUEgKyB0aGlzLm1faUMgKiBKd0MgKiBKd0MgKyB0aGlzLm1faUEgKiBKd0EgKiBKd0E7XG4gICAgICAgICAgdmFyIHBDID0gVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQywgdGhpcy5tX2xjQyk7XG4gICAgICAgICAgdmFyIHBBMiA9IFJvdC5tdWxUVmVjMihxQywgVmVjMi5hZGQockEyLCBWZWMyLnN1YihjQTIsIGNDKSkpO1xuICAgICAgICAgIGNvb3JkaW5hdGVBID0gVmVjMi5kb3QoVmVjMi5zdWIocEEyLCBwQyksIHRoaXMubV9sb2NhbEF4aXNDKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX3R5cGUyID09IFJldm9sdXRlSm9pbnQuVFlQRSkge1xuICAgICAgICAgIEp2QkQgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgICBKd0IgPSB0aGlzLm1fcmF0aW87XG4gICAgICAgICAgSndEID0gdGhpcy5tX3JhdGlvO1xuICAgICAgICAgIG1hc3MgKz0gdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogKHRoaXMubV9pQiArIHRoaXMubV9pRCk7XG4gICAgICAgICAgY29vcmRpbmF0ZUIgPSBhQiAtIGFEIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlQjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgdSA9IFJvdC5tdWxWZWMyKHFELCB0aGlzLm1fbG9jYWxBeGlzRCk7XG4gICAgICAgICAgdmFyIHJEID0gUm90Lm11bFN1YihxRCwgdGhpcy5tX2xvY2FsQW5jaG9yRCwgdGhpcy5tX2xjRCk7XG4gICAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxTdWIocUIsIHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sY0IpO1xuICAgICAgICAgIEp2QkQgPSBWZWMyLm11bE51bVZlYzIodGhpcy5tX3JhdGlvLCB1KTtcbiAgICAgICAgICBKd0QgPSB0aGlzLm1fcmF0aW8gKiBWZWMyLmNyb3NzVmVjMlZlYzIockQsIHUpO1xuICAgICAgICAgIEp3QiA9IHRoaXMubV9yYXRpbyAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHUpO1xuICAgICAgICAgIG1hc3MgKz0gdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogKHRoaXMubV9tRCArIHRoaXMubV9tQikgKyB0aGlzLm1faUQgKiBKd0QgKiBKd0QgKyB0aGlzLm1faUIgKiBKd0IgKiBKd0I7XG4gICAgICAgICAgdmFyIHBEID0gVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yRCwgdGhpcy5tX2xjRCk7XG4gICAgICAgICAgdmFyIHBCMiA9IFJvdC5tdWxUVmVjMihxRCwgVmVjMi5hZGQockIyLCBWZWMyLnN1YihjQjIsIGNEKSkpO1xuICAgICAgICAgIGNvb3JkaW5hdGVCID0gVmVjMi5kb3QocEIyLCB0aGlzLm1fbG9jYWxBeGlzRCkgLSBWZWMyLmRvdChwRCwgdGhpcy5tX2xvY2FsQXhpc0QpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBDID0gY29vcmRpbmF0ZUEgKyB0aGlzLm1fcmF0aW8gKiBjb29yZGluYXRlQiAtIHRoaXMubV9jb25zdGFudDtcbiAgICAgICAgdmFyIGltcHVsc2UgPSAwO1xuICAgICAgICBpZiAobWFzcyA+IDApIHtcbiAgICAgICAgICBpbXB1bHNlID0gLUMgLyBtYXNzO1xuICAgICAgICB9XG4gICAgICAgIGNBMi5hZGRNdWwodGhpcy5tX21BICogaW1wdWxzZSwgSnZBQyk7XG4gICAgICAgIGFBICs9IHRoaXMubV9pQSAqIGltcHVsc2UgKiBKd0E7XG4gICAgICAgIGNCMi5hZGRNdWwodGhpcy5tX21CICogaW1wdWxzZSwgSnZCRCk7XG4gICAgICAgIGFCICs9IHRoaXMubV9pQiAqIGltcHVsc2UgKiBKd0I7XG4gICAgICAgIGNDLnN1Yk11bCh0aGlzLm1fbUMgKiBpbXB1bHNlLCBKdkFDKTtcbiAgICAgICAgYUMgLT0gdGhpcy5tX2lDICogaW1wdWxzZSAqIEp3QztcbiAgICAgICAgY0Quc3ViTXVsKHRoaXMubV9tRCAqIGltcHVsc2UsIEp2QkQpO1xuICAgICAgICBhRCAtPSB0aGlzLm1faUQgKiBpbXB1bHNlICogSndEO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jLnNldFZlYzIoY0EyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jLnNldFZlYzIoY0IyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICB0aGlzLm1fYm9keUMuY19wb3NpdGlvbi5jLnNldFZlYzIoY0MpO1xuICAgICAgICB0aGlzLm1fYm9keUMuY19wb3NpdGlvbi5hID0gYUM7XG4gICAgICAgIHRoaXMubV9ib2R5RC5jX3Bvc2l0aW9uLmMuc2V0VmVjMihjRCk7XG4gICAgICAgIHRoaXMubV9ib2R5RC5jX3Bvc2l0aW9uLmEgPSBhRDtcbiAgICAgICAgcmV0dXJuIGxpbmVhckVycm9yIDwgU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIEdlYXJKb2ludDIuVFlQRSA9IFwiZ2Vhci1qb2ludFwiO1xuICAgICAgcmV0dXJuIEdlYXJKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIERFRkFVTFRTJDUgPSB7XG4gICAgbWF4Rm9yY2U6IDEsXG4gICAgbWF4VG9ycXVlOiAxLFxuICAgIGNvcnJlY3Rpb25GYWN0b3I6IDAuM1xuICB9O1xuICB2YXIgTW90b3JKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoTW90b3JKb2ludDIsIF9zdXBlcik7XG4gICAgICBmdW5jdGlvbiBNb3RvckpvaW50MihkZWYsIGJvZHlBLCBib2R5Qikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIE1vdG9ySm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgTW90b3JKb2ludDIoZGVmLCBib2R5QSwgYm9keUIpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQ1KTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IE1vdG9ySm9pbnQyLlRZUEU7XG4gICAgICAgIF90aGlzLm1fbGluZWFyT2Zmc2V0ID0gVmVjMi5pc1ZhbGlkKGRlZi5saW5lYXJPZmZzZXQpID8gVmVjMi5jbG9uZShkZWYubGluZWFyT2Zmc2V0KSA6IGJvZHlBLmdldExvY2FsUG9pbnQoYm9keUIuZ2V0UG9zaXRpb24oKSk7XG4gICAgICAgIF90aGlzLm1fYW5ndWxhck9mZnNldCA9IE51bWJlci5pc0Zpbml0ZShkZWYuYW5ndWxhck9mZnNldCkgPyBkZWYuYW5ndWxhck9mZnNldCA6IGJvZHlCLmdldEFuZ2xlKCkgLSBib2R5QS5nZXRBbmdsZSgpO1xuICAgICAgICBfdGhpcy5tX2xpbmVhckltcHVsc2UgPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9hbmd1bGFySW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIF90aGlzLm1fbWF4VG9ycXVlID0gZGVmLm1heFRvcnF1ZTtcbiAgICAgICAgX3RoaXMubV9jb3JyZWN0aW9uRmFjdG9yID0gZGVmLmNvcnJlY3Rpb25GYWN0b3I7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIG1heEZvcmNlOiB0aGlzLm1fbWF4Rm9yY2UsXG4gICAgICAgICAgbWF4VG9ycXVlOiB0aGlzLm1fbWF4VG9ycXVlLFxuICAgICAgICAgIGNvcnJlY3Rpb25GYWN0b3I6IHRoaXMubV9jb3JyZWN0aW9uRmFjdG9yLFxuICAgICAgICAgIGxpbmVhck9mZnNldDogdGhpcy5tX2xpbmVhck9mZnNldCxcbiAgICAgICAgICBhbmd1bGFyT2Zmc2V0OiB0aGlzLm1fYW5ndWxhck9mZnNldFxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgTW90b3JKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24oZGVmKSB7XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmFuZ3VsYXJPZmZzZXQpKSB7XG4gICAgICAgICAgdGhpcy5tX2FuZ3VsYXJPZmZzZXQgPSBkZWYuYW5ndWxhck9mZnNldDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhGb3JjZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4VG9ycXVlKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhUb3JxdWUgPSBkZWYubWF4VG9ycXVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmNvcnJlY3Rpb25GYWN0b3IpKSB7XG4gICAgICAgICAgdGhpcy5tX2NvcnJlY3Rpb25GYWN0b3IgPSBkZWYuY29ycmVjdGlvbkZhY3RvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5saW5lYXJPZmZzZXQpKSB7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhck9mZnNldC5zZXQoZGVmLmxpbmVhck9mZnNldCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuc2V0TWF4Rm9yY2UgPSBmdW5jdGlvbihmb3JjZSkge1xuICAgICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBmb3JjZTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0TWF4Rm9yY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhGb3JjZTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuc2V0TWF4VG9ycXVlID0gZnVuY3Rpb24odG9ycXVlKSB7XG4gICAgICAgIHRoaXMubV9tYXhUb3JxdWUgPSB0b3JxdWU7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldE1heFRvcnF1ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heFRvcnF1ZTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuc2V0Q29ycmVjdGlvbkZhY3RvciA9IGZ1bmN0aW9uKGZhY3Rvcikge1xuICAgICAgICB0aGlzLm1fY29ycmVjdGlvbkZhY3RvciA9IGZhY3RvcjtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0Q29ycmVjdGlvbkZhY3RvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2NvcnJlY3Rpb25GYWN0b3I7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLnNldExpbmVhck9mZnNldCA9IGZ1bmN0aW9uKGxpbmVhck9mZnNldCkge1xuICAgICAgICBpZiAobGluZWFyT2Zmc2V0LnggIT0gdGhpcy5tX2xpbmVhck9mZnNldC54IHx8IGxpbmVhck9mZnNldC55ICE9IHRoaXMubV9saW5lYXJPZmZzZXQueSkge1xuICAgICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhck9mZnNldC5zZXQobGluZWFyT2Zmc2V0KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRMaW5lYXJPZmZzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9saW5lYXJPZmZzZXQ7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLnNldEFuZ3VsYXJPZmZzZXQgPSBmdW5jdGlvbihhbmd1bGFyT2Zmc2V0KSB7XG4gICAgICAgIGlmIChhbmd1bGFyT2Zmc2V0ICE9IHRoaXMubV9hbmd1bGFyT2Zmc2V0KSB7XG4gICAgICAgICAgdGhpcy5tX2JvZHlBLnNldEF3YWtlKHRydWUpO1xuICAgICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhck9mZnNldCA9IGFuZ3VsYXJPZmZzZXQ7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0QW5ndWxhck9mZnNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2FuZ3VsYXJPZmZzZXQ7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRQb3NpdGlvbigpO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0UG9zaXRpb24oKTtcbiAgICAgIH07XG4gICAgICBNb3RvckpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5tdWxOdW1WZWMyKGludl9kdCwgdGhpcy5tX2xpbmVhckltcHVsc2UpO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2FuZ3VsYXJJbXB1bHNlO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IHRoaXMubV9ib2R5QS5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQSA9IHRoaXMubV9ib2R5QS5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZNYXNzQiA9IHRoaXMubV9ib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgIHRoaXMubV9pbnZJQSA9IHRoaXMubV9ib2R5QS5tX2ludkk7XG4gICAgICAgIHRoaXMubV9pbnZJQiA9IHRoaXMubV9ib2R5Qi5tX2ludkk7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHRoaXMubV9yQSA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbGluZWFyT2Zmc2V0LCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLm5lZyh0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIEsgPSBuZXcgTWF0MjIoKTtcbiAgICAgICAgSy5leC54ID0gbUEgKyBtQiArIGlBICogdGhpcy5tX3JBLnkgKiB0aGlzLm1fckEueSArIGlCICogdGhpcy5tX3JCLnkgKiB0aGlzLm1fckIueTtcbiAgICAgICAgSy5leC55ID0gLWlBICogdGhpcy5tX3JBLnggKiB0aGlzLm1fckEueSAtIGlCICogdGhpcy5tX3JCLnggKiB0aGlzLm1fckIueTtcbiAgICAgICAgSy5leS54ID0gSy5leC55O1xuICAgICAgICBLLmV5LnkgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fckEueCAqIHRoaXMubV9yQS54ICsgaUIgKiB0aGlzLm1fckIueCAqIHRoaXMubV9yQi54O1xuICAgICAgICB0aGlzLm1fbGluZWFyTWFzcyA9IEsuZ2V0SW52ZXJzZSgpO1xuICAgICAgICB0aGlzLm1fYW5ndWxhck1hc3MgPSBpQSArIGlCO1xuICAgICAgICBpZiAodGhpcy5tX2FuZ3VsYXJNYXNzID4gMCkge1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFyTWFzcyA9IDEgLyB0aGlzLm1fYW5ndWxhck1hc3M7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2xpbmVhckVycm9yID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIHRoaXMubV9saW5lYXJFcnJvci5hZGRDb21iaW5lKDEsIGNCMiwgMSwgdGhpcy5tX3JCKTtcbiAgICAgICAgdGhpcy5tX2xpbmVhckVycm9yLnN1YkNvbWJpbmUoMSwgY0EyLCAxLCB0aGlzLm1fckEpO1xuICAgICAgICB0aGlzLm1fYW5ndWxhckVycm9yID0gYUIgLSBhQSAtIHRoaXMubV9hbmd1bGFyT2Zmc2V0O1xuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5tdWwoc3RlcC5kdFJhdGlvKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVvKHRoaXMubV9saW5lYXJJbXB1bHNlLngsIHRoaXMubV9saW5lYXJJbXB1bHNlLnkpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMykgKyB0aGlzLm1fYW5ndWxhckltcHVsc2UpO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMykgKyB0aGlzLm1fYW5ndWxhckltcHVsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLnNldFplcm8oKTtcbiAgICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIE1vdG9ySm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgdkIyID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgIHZhciBpbnZfaCA9IHN0ZXAuaW52X2R0O1xuICAgICAgICB7XG4gICAgICAgICAgdmFyIENkb3QgPSB3QiAtIHdBICsgaW52X2ggKiB0aGlzLm1fY29ycmVjdGlvbkZhY3RvciAqIHRoaXMubV9hbmd1bGFyRXJyb3I7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX2FuZ3VsYXJNYXNzICogQ2RvdDtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9hbmd1bGFySW1wdWxzZTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IGggKiB0aGlzLm1fbWF4VG9ycXVlO1xuICAgICAgICAgIHRoaXMubV9hbmd1bGFySW1wdWxzZSA9IGNsYW1wKHRoaXMubV9hbmd1bGFySW1wdWxzZSArIGltcHVsc2UsIC1tYXhJbXB1bHNlLCBtYXhJbXB1bHNlKTtcbiAgICAgICAgICBpbXB1bHNlID0gdGhpcy5tX2FuZ3VsYXJJbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2U7XG4gICAgICAgICAgd0IgKz0gaUIgKiBpbXB1bHNlO1xuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgQ2RvdCA9IFZlYzIuemVybygpO1xuICAgICAgICAgIENkb3QuYWRkQ29tYmluZSgxLCB2QjIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpKTtcbiAgICAgICAgICBDZG90LnN1YkNvbWJpbmUoMSwgdkEyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QSwgdGhpcy5tX3JBKSk7XG4gICAgICAgICAgQ2RvdC5hZGRNdWwoaW52X2ggKiB0aGlzLm1fY29ycmVjdGlvbkZhY3RvciwgdGhpcy5tX2xpbmVhckVycm9yKTtcbiAgICAgICAgICB2YXIgaW1wdWxzZSA9IFZlYzIubmVnKE1hdDIyLm11bFZlYzIodGhpcy5tX2xpbmVhck1hc3MsIENkb3QpKTtcbiAgICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IFZlYzIuY2xvbmUodGhpcy5tX2xpbmVhckltcHVsc2UpO1xuICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLmFkZChpbXB1bHNlKTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IGggKiB0aGlzLm1fbWF4Rm9yY2U7XG4gICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuY2xhbXAobWF4SW1wdWxzZSk7XG4gICAgICAgICAgaW1wdWxzZSA9IFZlYzIuc3ViKHRoaXMubV9saW5lYXJJbXB1bHNlLCBvbGRJbXB1bHNlKTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBpbXB1bHNlKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIGltcHVsc2UpO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIGltcHVsc2UpO1xuICAgICAgICAgIHdCICs9IGlCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgaW1wdWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuICAgICAgTW90b3JKb2ludDIuVFlQRSA9IFwibW90b3Itam9pbnRcIjtcbiAgICAgIHJldHVybiBNb3RvckpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgbWF0aF9QSSQyID0gTWF0aC5QSTtcbiAgdmFyIERFRkFVTFRTJDQgPSB7XG4gICAgbWF4Rm9yY2U6IDAsXG4gICAgZnJlcXVlbmN5SHo6IDUsXG4gICAgZGFtcGluZ1JhdGlvOiAwLjdcbiAgfTtcbiAgdmFyIE1vdXNlSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKE1vdXNlSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gTW91c2VKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIHRhcmdldCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIE1vdXNlSm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgTW91c2VKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDQpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gTW91c2VKb2ludDIuVFlQRTtcbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZCh0YXJnZXQpKSB7XG4gICAgICAgICAgX3RoaXMubV90YXJnZXRBID0gVmVjMi5jbG9uZSh0YXJnZXQpO1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYudGFyZ2V0KSkge1xuICAgICAgICAgIF90aGlzLm1fdGFyZ2V0QSA9IFZlYzIuY2xvbmUoZGVmLnRhcmdldCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMubV90YXJnZXRBID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBUcmFuc2Zvcm0ubXVsVFZlYzIoYm9keUIuZ2V0VHJhbnNmb3JtKCksIF90aGlzLm1fdGFyZ2V0QSk7XG4gICAgICAgIF90aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICBfdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIF90aGlzLm1fYmV0YSA9IDA7XG4gICAgICAgIF90aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICBfdGhpcy5tX3JCID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxDZW50ZXJCID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIF90aGlzLm1faW52TWFzc0IgPSAwO1xuICAgICAgICBfdGhpcy5tX2ludklCID0gMDtcbiAgICAgICAgX3RoaXMubV9tYXNzID0gbmV3IE1hdDIyKCk7XG4gICAgICAgIF90aGlzLm1fQyA9IFZlYzIuemVybygpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICB0YXJnZXQ6IHRoaXMubV90YXJnZXRBLFxuICAgICAgICAgIG1heEZvcmNlOiB0aGlzLm1fbWF4Rm9yY2UsXG4gICAgICAgICAgZnJlcXVlbmN5SHo6IHRoaXMubV9mcmVxdWVuY3lIeixcbiAgICAgICAgICBkYW1waW5nUmF0aW86IHRoaXMubV9kYW1waW5nUmF0aW8sXG4gICAgICAgICAgX2xvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQlxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICBkYXRhLnRhcmdldCA9IFZlYzIuY2xvbmUoZGF0YS50YXJnZXQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgTW91c2VKb2ludDIoZGF0YSk7XG4gICAgICAgIGlmIChkYXRhLl9sb2NhbEFuY2hvckIpIHtcbiAgICAgICAgICBqb2ludC5tX2xvY2FsQW5jaG9yQiA9IGRhdGEuX2xvY2FsQW5jaG9yQjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhGb3JjZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZnJlcXVlbmN5SHopKSB7XG4gICAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmRhbXBpbmdSYXRpbykpIHtcbiAgICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zZXRUYXJnZXQgPSBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgICAgaWYgKFZlYzIuYXJlRXF1YWwodGFyZ2V0LCB0aGlzLm1fdGFyZ2V0QSkpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUIuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV90YXJnZXRBLnNldCh0YXJnZXQpO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXRUYXJnZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV90YXJnZXRBO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhGb3JjZSA9IGZ1bmN0aW9uKGZvcmNlKSB7XG4gICAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGZvcmNlO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhGb3JjZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heEZvcmNlO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zZXRGcmVxdWVuY3kgPSBmdW5jdGlvbihoeikge1xuICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBoejtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0RnJlcXVlbmN5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLnNldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uKHJhdGlvKSB7XG4gICAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSByYXRpbztcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZGFtcGluZ1JhdGlvO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBWZWMyLmNsb25lKHRoaXMubV90YXJnZXRBKTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubXVsTnVtVmVjMihpbnZfZHQsIHRoaXMubV9pbXB1bHNlKTtcbiAgICAgIH07XG4gICAgICBNb3VzZUpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIGludl9kdCAqIDA7XG4gICAgICB9O1xuICAgICAgTW91c2VKb2ludDIucHJvdG90eXBlLnNoaWZ0T3JpZ2luID0gZnVuY3Rpb24obmV3T3JpZ2luKSB7XG4gICAgICAgIHRoaXMubV90YXJnZXRBLnN1YihuZXdPcmlnaW4pO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5pbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgcG9zaXRpb24gPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbjtcbiAgICAgICAgdmFyIHZlbG9jaXR5ID0gdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHk7XG4gICAgICAgIHZhciBjQjIgPSBwb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSBwb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkIyID0gdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdCID0gdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciBtYXNzID0gdGhpcy5tX2JvZHlCLmdldE1hc3MoKTtcbiAgICAgICAgdmFyIG9tZWdhID0gMiAqIG1hdGhfUEkkMiAqIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgICAgdmFyIGQyID0gMiAqIG1hc3MgKiB0aGlzLm1fZGFtcGluZ1JhdGlvICogb21lZ2E7XG4gICAgICAgIHZhciBrID0gbWFzcyAqIChvbWVnYSAqIG9tZWdhKTtcbiAgICAgICAgdmFyIGggPSBzdGVwLmR0O1xuICAgICAgICB0aGlzLm1fZ2FtbWEgPSBoICogKGQyICsgaCAqIGspO1xuICAgICAgICBpZiAodGhpcy5tX2dhbW1hICE9IDApIHtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSAxIC8gdGhpcy5tX2dhbW1hO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9iZXRhID0gaCAqIGsgKiB0aGlzLm1fZ2FtbWE7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBLID0gbmV3IE1hdDIyKCk7XG4gICAgICAgIEsuZXgueCA9IHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQiAqIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnkgKyB0aGlzLm1fZ2FtbWE7XG4gICAgICAgIEsuZXgueSA9IC10aGlzLm1faW52SUIgKiB0aGlzLm1fckIueCAqIHRoaXMubV9yQi55O1xuICAgICAgICBLLmV5LnggPSBLLmV4Lnk7XG4gICAgICAgIEsuZXkueSA9IHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQiAqIHRoaXMubV9yQi54ICogdGhpcy5tX3JCLnggKyB0aGlzLm1fZ2FtbWE7XG4gICAgICAgIHRoaXMubV9tYXNzID0gSy5nZXRJbnZlcnNlKCk7XG4gICAgICAgIHRoaXMubV9DLnNldFZlYzIoY0IyKTtcbiAgICAgICAgdGhpcy5tX0MuYWRkQ29tYmluZSgxLCB0aGlzLm1fckIsIC0xLCB0aGlzLm1fdGFyZ2V0QSk7XG4gICAgICAgIHRoaXMubV9DLm11bCh0aGlzLm1fYmV0YSk7XG4gICAgICAgIHdCICo9IDAuOTg7XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLm11bChzdGVwLmR0UmF0aW8pO1xuICAgICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCB0aGlzLm1faW1wdWxzZSk7XG4gICAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgdGhpcy5tX2ltcHVsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnNldFplcm8oKTtcbiAgICAgICAgfVxuICAgICAgICB2ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciB2ZWxvY2l0eSA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5O1xuICAgICAgICB2YXIgdkIyID0gVmVjMi5jbG9uZSh2ZWxvY2l0eS52KTtcbiAgICAgICAgdmFyIHdCID0gdmVsb2NpdHkudztcbiAgICAgICAgdmFyIENkb3QgPSBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKTtcbiAgICAgICAgQ2RvdC5hZGQodkIyKTtcbiAgICAgICAgQ2RvdC5hZGRDb21iaW5lKDEsIHRoaXMubV9DLCB0aGlzLm1fZ2FtbWEsIHRoaXMubV9pbXB1bHNlKTtcbiAgICAgICAgQ2RvdC5uZWcoKTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSBNYXQyMi5tdWxWZWMyKHRoaXMubV9tYXNzLCBDZG90KTtcbiAgICAgICAgdmFyIG9sZEltcHVsc2UgPSBWZWMyLmNsb25lKHRoaXMubV9pbXB1bHNlKTtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UuYWRkKGltcHVsc2UpO1xuICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4Rm9yY2U7XG4gICAgICAgIHRoaXMubV9pbXB1bHNlLmNsYW1wKG1heEltcHVsc2UpO1xuICAgICAgICBpbXB1bHNlID0gVmVjMi5zdWIodGhpcy5tX2ltcHVsc2UsIG9sZEltcHVsc2UpO1xuICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgaW1wdWxzZSk7XG4gICAgICAgIHdCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIGltcHVsc2UpO1xuICAgICAgICB2ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIE1vdXNlSm9pbnQyLlRZUEUgPSBcIm1vdXNlLWpvaW50XCI7XG4gICAgICByZXR1cm4gTW91c2VKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIG1hdGhfYWJzJDIgPSBNYXRoLmFicztcbiAgdmFyIERFRkFVTFRTJDMgPSB7XG4gICAgY29sbGlkZUNvbm5lY3RlZDogdHJ1ZVxuICB9O1xuICB2YXIgUHVsbGV5Sm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFB1bGxleUpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIFB1bGxleUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgZ3JvdW5kQSwgZ3JvdW5kQiwgYW5jaG9yQSwgYW5jaG9yQiwgcmF0aW8pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBQdWxsZXlKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBQdWxsZXlKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGdyb3VuZEEsIGdyb3VuZEIsIGFuY2hvckEsIGFuY2hvckIsIHJhdGlvKTtcbiAgICAgICAgfVxuICAgICAgICBkZWYgPSBvcHRpb25zKGRlZiwgREVGQVVMVFMkMyk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVmLCBib2R5QSwgYm9keUIpIHx8IHRoaXM7XG4gICAgICAgIGJvZHlBID0gX3RoaXMubV9ib2R5QTtcbiAgICAgICAgYm9keUIgPSBfdGhpcy5tX2JvZHlCO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBQdWxsZXlKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9ncm91bmRBbmNob3JBID0gVmVjMi5jbG9uZShncm91bmRBID8gZ3JvdW5kQSA6IGRlZi5ncm91bmRBbmNob3JBIHx8IFZlYzIubmVvKC0xLCAxKSk7XG4gICAgICAgIF90aGlzLm1fZ3JvdW5kQW5jaG9yQiA9IFZlYzIuY2xvbmUoZ3JvdW5kQiA/IGdyb3VuZEIgOiBkZWYuZ3JvdW5kQW5jaG9yQiB8fCBWZWMyLm5lbygxLCAxKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JBID0gVmVjMi5jbG9uZShhbmNob3JBID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3JBKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi5uZW8oLTEsIDApKTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckIgPSBWZWMyLmNsb25lKGFuY2hvckIgPyBib2R5Qi5nZXRMb2NhbFBvaW50KGFuY2hvckIpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLm5lbygxLCAwKSk7XG4gICAgICAgIF90aGlzLm1fbGVuZ3RoQSA9IE51bWJlci5pc0Zpbml0ZShkZWYubGVuZ3RoQSkgPyBkZWYubGVuZ3RoQSA6IFZlYzIuZGlzdGFuY2UoYW5jaG9yQSwgZ3JvdW5kQSk7XG4gICAgICAgIF90aGlzLm1fbGVuZ3RoQiA9IE51bWJlci5pc0Zpbml0ZShkZWYubGVuZ3RoQikgPyBkZWYubGVuZ3RoQiA6IFZlYzIuZGlzdGFuY2UoYW5jaG9yQiwgZ3JvdW5kQik7XG4gICAgICAgIF90aGlzLm1fcmF0aW8gPSBOdW1iZXIuaXNGaW5pdGUocmF0aW8pID8gcmF0aW8gOiBkZWYucmF0aW87XG4gICAgICAgIF90aGlzLm1fY29uc3RhbnQgPSBfdGhpcy5tX2xlbmd0aEEgKyBfdGhpcy5tX3JhdGlvICogX3RoaXMubV9sZW5ndGhCO1xuICAgICAgICBfdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgZ3JvdW5kQW5jaG9yQTogdGhpcy5tX2dyb3VuZEFuY2hvckEsXG4gICAgICAgICAgZ3JvdW5kQW5jaG9yQjogdGhpcy5tX2dyb3VuZEFuY2hvckIsXG4gICAgICAgICAgbG9jYWxBbmNob3JBOiB0aGlzLm1fbG9jYWxBbmNob3JBLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQjogdGhpcy5tX2xvY2FsQW5jaG9yQixcbiAgICAgICAgICBsZW5ndGhBOiB0aGlzLm1fbGVuZ3RoQSxcbiAgICAgICAgICBsZW5ndGhCOiB0aGlzLm1fbGVuZ3RoQixcbiAgICAgICAgICByYXRpbzogdGhpcy5tX3JhdGlvXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgUHVsbGV5Sm9pbnQyKGRhdGEpO1xuICAgICAgICByZXR1cm4gam9pbnQ7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChkZWYuZ3JvdW5kQW5jaG9yQSkpIHtcbiAgICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yQS5zZXQoZGVmLmdyb3VuZEFuY2hvckEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChWZWMyLmlzVmFsaWQoZGVmLmdyb3VuZEFuY2hvckIpKSB7XG4gICAgICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvckIuc2V0KGRlZi5ncm91bmRBbmNob3JCKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5sb2NhbEFuY2hvckEpKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXQoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICAgIH0gZWxzZSBpZiAoVmVjMi5pc1ZhbGlkKGRlZi5hbmNob3JBKSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0KHRoaXMubV9ib2R5QS5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JBKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChkZWYubG9jYWxBbmNob3JCKSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0KGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYuYW5jaG9yQikpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldCh0aGlzLm1fYm9keUIuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmxlbmd0aEEpKSB7XG4gICAgICAgICAgdGhpcy5tX2xlbmd0aEEgPSBkZWYubGVuZ3RoQTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5sZW5ndGhCKSkge1xuICAgICAgICAgIHRoaXMubV9sZW5ndGhCID0gZGVmLmxlbmd0aEI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYucmF0aW8pKSB7XG4gICAgICAgICAgdGhpcy5tX3JhdGlvID0gZGVmLnJhdGlvO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRHcm91bmRBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZ3JvdW5kQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldEdyb3VuZEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ncm91bmRBbmNob3JCO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0TGVuZ3RoQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xlbmd0aEE7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRMZW5ndGhCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbGVuZ3RoQjtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldFJhdGlvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcmF0aW87XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRDdXJyZW50TGVuZ3RoQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcCA9IHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgICB2YXIgczIgPSB0aGlzLm1fZ3JvdW5kQW5jaG9yQTtcbiAgICAgICAgcmV0dXJuIFZlYzIuZGlzdGFuY2UocCwgczIpO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0Q3VycmVudExlbmd0aEIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHAgPSB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgICAgdmFyIHMyID0gdGhpcy5tX2dyb3VuZEFuY2hvckI7XG4gICAgICAgIHJldHVybiBWZWMyLmRpc3RhbmNlKHAsIHMyKTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLnNoaWZ0T3JpZ2luID0gZnVuY3Rpb24obmV3T3JpZ2luKSB7XG4gICAgICAgIHRoaXMubV9ncm91bmRBbmNob3JBLnN1YihuZXdPcmlnaW4pO1xuICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yQi5zdWIobmV3T3JpZ2luKTtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuZ2V0QW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBWZWMyLm11bE51bVZlYzIodGhpcy5tX2ltcHVsc2UsIHRoaXMubV91QikubXVsKGludl9kdCk7XG4gICAgICB9O1xuICAgICAgUHVsbGV5Sm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdGhpcy5tX3JCID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdGhpcy5tX3VBID0gVmVjMi5zdWIoVmVjMi5hZGQoY0EyLCB0aGlzLm1fckEpLCB0aGlzLm1fZ3JvdW5kQW5jaG9yQSk7XG4gICAgICAgIHRoaXMubV91QiA9IFZlYzIuc3ViKFZlYzIuYWRkKGNCMiwgdGhpcy5tX3JCKSwgdGhpcy5tX2dyb3VuZEFuY2hvckIpO1xuICAgICAgICB2YXIgbGVuZ3RoQSA9IHRoaXMubV91QS5sZW5ndGgoKTtcbiAgICAgICAgdmFyIGxlbmd0aEIgPSB0aGlzLm1fdUIubGVuZ3RoKCk7XG4gICAgICAgIGlmIChsZW5ndGhBID4gMTAgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3ApIHtcbiAgICAgICAgICB0aGlzLm1fdUEubXVsKDEgLyBsZW5ndGhBKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdUEuc2V0WmVybygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsZW5ndGhCID4gMTAgKiBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3ApIHtcbiAgICAgICAgICB0aGlzLm1fdUIubXVsKDEgLyBsZW5ndGhCKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdUIuc2V0WmVybygpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBydUEgPSBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCB0aGlzLm1fdUEpO1xuICAgICAgICB2YXIgcnVCID0gVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgdGhpcy5tX3VCKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBICsgdGhpcy5tX2ludklBICogcnVBICogcnVBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUIgKiBydUIgKiBydUI7XG4gICAgICAgIHRoaXMubV9tYXNzID0gbUEgKyB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiBtQjtcbiAgICAgICAgaWYgKHRoaXMubV9tYXNzID4gMCkge1xuICAgICAgICAgIHRoaXMubV9tYXNzID0gMSAvIHRoaXMubV9tYXNzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB2YXIgUEEgPSBWZWMyLm11bE51bVZlYzIoLXRoaXMubV9pbXB1bHNlLCB0aGlzLm1fdUEpO1xuICAgICAgICAgIHZhciBQQiA9IFZlYzIubXVsTnVtVmVjMigtdGhpcy5tX3JhdGlvICogdGhpcy5tX2ltcHVsc2UsIHRoaXMubV91Qik7XG4gICAgICAgICAgdkEyLmFkZE11bCh0aGlzLm1faW52TWFzc0EsIFBBKTtcbiAgICAgICAgICB3QSArPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQQSk7XG4gICAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFBCKTtcbiAgICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQQik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFB1bGxleUpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2cEEgPSBWZWMyLmFkZCh2QTIsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgdmFyIHZwQiA9IFZlYzIuYWRkKHZCMiwgVmVjMi5jcm9zc051bVZlYzIod0IsIHRoaXMubV9yQikpO1xuICAgICAgICB2YXIgQ2RvdCA9IC1WZWMyLmRvdCh0aGlzLm1fdUEsIHZwQSkgLSB0aGlzLm1fcmF0aW8gKiBWZWMyLmRvdCh0aGlzLm1fdUIsIHZwQik7XG4gICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tYXNzICogQ2RvdDtcbiAgICAgICAgdGhpcy5tX2ltcHVsc2UgKz0gaW1wdWxzZTtcbiAgICAgICAgdmFyIFBBID0gVmVjMi5tdWxOdW1WZWMyKC1pbXB1bHNlLCB0aGlzLm1fdUEpO1xuICAgICAgICB2YXIgUEIgPSBWZWMyLm11bE51bVZlYzIoLXRoaXMubV9yYXRpbyAqIGltcHVsc2UsIHRoaXMubV91Qik7XG4gICAgICAgIHZBMi5hZGRNdWwodGhpcy5tX2ludk1hc3NBLCBQQSk7XG4gICAgICAgIHdBICs9IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFBBKTtcbiAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFBCKTtcbiAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUEIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52ID0gdkEyO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYgPSB2QjI7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LncgPSB3QjtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIHVBID0gVmVjMi5zdWIoVmVjMi5hZGQoY0EyLCB0aGlzLm1fckEpLCB0aGlzLm1fZ3JvdW5kQW5jaG9yQSk7XG4gICAgICAgIHZhciB1QiA9IFZlYzIuc3ViKFZlYzIuYWRkKGNCMiwgdGhpcy5tX3JCKSwgdGhpcy5tX2dyb3VuZEFuY2hvckIpO1xuICAgICAgICB2YXIgbGVuZ3RoQSA9IHVBLmxlbmd0aCgpO1xuICAgICAgICB2YXIgbGVuZ3RoQiA9IHVCLmxlbmd0aCgpO1xuICAgICAgICBpZiAobGVuZ3RoQSA+IDEwICogU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKSB7XG4gICAgICAgICAgdUEubXVsKDEgLyBsZW5ndGhBKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB1QS5zZXRaZXJvKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxlbmd0aEIgPiAxMCAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcCkge1xuICAgICAgICAgIHVCLm11bCgxIC8gbGVuZ3RoQik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdUIuc2V0WmVybygpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBydUEgPSBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCB1QSk7XG4gICAgICAgIHZhciBydUIgPSBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCB1Qik7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQSArIHRoaXMubV9pbnZJQSAqIHJ1QSAqIHJ1QTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklCICogcnVCICogcnVCO1xuICAgICAgICB2YXIgbWFzcyA9IG1BICsgdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogbUI7XG4gICAgICAgIGlmIChtYXNzID4gMCkge1xuICAgICAgICAgIG1hc3MgPSAxIC8gbWFzcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgQyA9IHRoaXMubV9jb25zdGFudCAtIGxlbmd0aEEgLSB0aGlzLm1fcmF0aW8gKiBsZW5ndGhCO1xuICAgICAgICB2YXIgbGluZWFyRXJyb3IgPSBtYXRoX2FicyQyKEMpO1xuICAgICAgICB2YXIgaW1wdWxzZSA9IC1tYXNzICogQztcbiAgICAgICAgdmFyIFBBID0gVmVjMi5tdWxOdW1WZWMyKC1pbXB1bHNlLCB1QSk7XG4gICAgICAgIHZhciBQQiA9IFZlYzIubXVsTnVtVmVjMigtdGhpcy5tX3JhdGlvICogaW1wdWxzZSwgdUIpO1xuICAgICAgICBjQTIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQSwgUEEpO1xuICAgICAgICBhQSArPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIockEyLCBQQSk7XG4gICAgICAgIGNCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQQik7XG4gICAgICAgIGFCICs9IHRoaXMubV9pbnZJQiAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIFBCKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYyA9IGNBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jID0gY0IyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hID0gYUI7XG4gICAgICAgIHJldHVybiBsaW5lYXJFcnJvciA8IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgIH07XG4gICAgICBQdWxsZXlKb2ludDIuVFlQRSA9IFwicHVsbGV5LWpvaW50XCI7XG4gICAgICByZXR1cm4gUHVsbGV5Sm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBtYXRoX21pbiQxID0gTWF0aC5taW47XG4gIHZhciBMaW1pdFN0YXRlO1xuICAoZnVuY3Rpb24oTGltaXRTdGF0ZTIpIHtcbiAgICBMaW1pdFN0YXRlMltMaW1pdFN0YXRlMltcImluYWN0aXZlTGltaXRcIl0gPSAwXSA9IFwiaW5hY3RpdmVMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiYXRMb3dlckxpbWl0XCJdID0gMV0gPSBcImF0TG93ZXJMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiYXRVcHBlckxpbWl0XCJdID0gMl0gPSBcImF0VXBwZXJMaW1pdFwiO1xuICAgIExpbWl0U3RhdGUyW0xpbWl0U3RhdGUyW1wiZXF1YWxMaW1pdHNcIl0gPSAzXSA9IFwiZXF1YWxMaW1pdHNcIjtcbiAgfSkoTGltaXRTdGF0ZSB8fCAoTGltaXRTdGF0ZSA9IHt9KSk7XG4gIHZhciBERUZBVUxUUyQyID0ge1xuICAgIG1heExlbmd0aDogMFxuICB9O1xuICB2YXIgUm9wZUpvaW50ID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbihfc3VwZXIpIHtcbiAgICAgIF9fZXh0ZW5kcyhSb3BlSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gUm9wZUpvaW50MihkZWYsIGJvZHlBLCBib2R5QiwgYW5jaG9yKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKF90aGlzIGluc3RhbmNlb2YgUm9wZUpvaW50MikpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFJvcGVKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvcik7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTJDIpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlZiwgYm9keUEsIGJvZHlCKSB8fCB0aGlzO1xuICAgICAgICBib2R5QSA9IF90aGlzLm1fYm9keUE7XG4gICAgICAgIGJvZHlCID0gX3RoaXMubV9ib2R5QjtcbiAgICAgICAgX3RoaXMubV90eXBlID0gUm9wZUpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQSB8fCBWZWMyLm5lbygtMSwgMCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLm5lbygxLCAwKSk7XG4gICAgICAgIF90aGlzLm1fbWF4TGVuZ3RoID0gZGVmLm1heExlbmd0aDtcbiAgICAgICAgX3RoaXMubV9tYXNzID0gMDtcbiAgICAgICAgX3RoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgX3RoaXMubV9sZW5ndGggPSAwO1xuICAgICAgICBfdGhpcy5tX3N0YXRlID0gTGltaXRTdGF0ZS5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICB9XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5fc2VyaWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogdGhpcy5tX3R5cGUsXG4gICAgICAgICAgYm9keUE6IHRoaXMubV9ib2R5QSxcbiAgICAgICAgICBib2R5QjogdGhpcy5tX2JvZHlCLFxuICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQ6IHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckIsXG4gICAgICAgICAgbWF4TGVuZ3RoOiB0aGlzLm1fbWF4TGVuZ3RoXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5fZGVzZXJpYWxpemUgPSBmdW5jdGlvbihkYXRhLCB3b3JsZCwgcmVzdG9yZSkge1xuICAgICAgICBkYXRhID0gX19hc3NpZ24oe30sIGRhdGEpO1xuICAgICAgICBkYXRhLmJvZHlBID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlBLCB3b3JsZCk7XG4gICAgICAgIGRhdGEuYm9keUIgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUIsIHdvcmxkKTtcbiAgICAgICAgdmFyIGpvaW50ID0gbmV3IFJvcGVKb2ludDIoZGF0YSk7XG4gICAgICAgIHJldHVybiBqb2ludDtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubWF4TGVuZ3RoKSkge1xuICAgICAgICAgIHRoaXMubV9tYXhMZW5ndGggPSBkZWYubWF4TGVuZ3RoO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQjtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5zZXRNYXhMZW5ndGggPSBmdW5jdGlvbihsZW5ndGgpIHtcbiAgICAgICAgdGhpcy5tX21heExlbmd0aCA9IGxlbmd0aDtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhMZW5ndGggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9tYXhMZW5ndGg7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuZ2V0TGltaXRTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX3N0YXRlO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubXVsTnVtVmVjMih0aGlzLm1faW1wdWxzZSwgdGhpcy5tX3UpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QTIgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgY0IyID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFCID0gdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdGhpcy5tX3JBID0gUm90Lm11bFN1YihxQSwgdGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxTdWIocUIsIHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpO1xuICAgICAgICB0aGlzLm1fdSA9IFZlYzIuemVybygpO1xuICAgICAgICB0aGlzLm1fdS5hZGRDb21iaW5lKDEsIGNCMiwgMSwgdGhpcy5tX3JCKTtcbiAgICAgICAgdGhpcy5tX3Uuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHRoaXMubV9yQSk7XG4gICAgICAgIHRoaXMubV9sZW5ndGggPSB0aGlzLm1fdS5sZW5ndGgoKTtcbiAgICAgICAgdmFyIEMgPSB0aGlzLm1fbGVuZ3RoIC0gdGhpcy5tX21heExlbmd0aDtcbiAgICAgICAgaWYgKEMgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tX3N0YXRlID0gTGltaXRTdGF0ZS5hdFVwcGVyTGltaXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX3N0YXRlID0gTGltaXRTdGF0ZS5pbmFjdGl2ZUxpbWl0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fbGVuZ3RoID4gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wKSB7XG4gICAgICAgICAgdGhpcy5tX3UubXVsKDEgLyB0aGlzLm1fbGVuZ3RoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1fdS5zZXRaZXJvKCk7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSAwO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gMDtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNyQSA9IFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIHRoaXMubV91KTtcbiAgICAgICAgdmFyIGNyQiA9IFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIHRoaXMubV91KTtcbiAgICAgICAgdmFyIGludk1hc3MgPSB0aGlzLm1faW52TWFzc0EgKyB0aGlzLm1faW52SUEgKiBjckEgKiBjckEgKyB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUIgKiBjckIgKiBjckI7XG4gICAgICAgIHRoaXMubV9tYXNzID0gaW52TWFzcyAhPSAwID8gMSAvIGludk1hc3MgOiAwO1xuICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fdSk7XG4gICAgICAgICAgdkEyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgICB3QSAtPSB0aGlzLm1faW52SUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMyk7XG4gICAgICAgICAgdkIyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFAzKTtcbiAgICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgUm9wZUpvaW50Mi5wcm90b3R5cGUuc29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIHZCMiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2cEEgPSBWZWMyLmFkZENyb3NzTnVtVmVjMih2QTIsIHdBLCB0aGlzLm1fckEpO1xuICAgICAgICB2YXIgdnBCID0gVmVjMi5hZGRDcm9zc051bVZlYzIodkIyLCB3QiwgdGhpcy5tX3JCKTtcbiAgICAgICAgdmFyIEMgPSB0aGlzLm1fbGVuZ3RoIC0gdGhpcy5tX21heExlbmd0aDtcbiAgICAgICAgdmFyIENkb3QgPSBWZWMyLmRvdCh0aGlzLm1fdSwgVmVjMi5zdWIodnBCLCB2cEEpKTtcbiAgICAgICAgaWYgKEMgPCAwKSB7XG4gICAgICAgICAgQ2RvdCArPSBzdGVwLmludl9kdCAqIEM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21hc3MgKiBDZG90O1xuICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9pbXB1bHNlO1xuICAgICAgICB0aGlzLm1faW1wdWxzZSA9IG1hdGhfbWluJDEoMCwgdGhpcy5tX2ltcHVsc2UgKyBpbXB1bHNlKTtcbiAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9pbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIHRoaXMubV91KTtcbiAgICAgICAgdkEyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgd0EgLT0gdGhpcy5tX2ludklBICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQSwgUDMpO1xuICAgICAgICB2QjIuYWRkTXVsKHRoaXMubV9pbnZNYXNzQiwgUDMpO1xuICAgICAgICB3QiArPSB0aGlzLm1faW52SUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JCLCBQMyk7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFJvcGVKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsU3ViKHFBLCB0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxTdWIocUIsIHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpO1xuICAgICAgICB2YXIgdSA9IFZlYzIuemVybygpO1xuICAgICAgICB1LmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICB1LnN1YkNvbWJpbmUoMSwgY0EyLCAxLCByQTIpO1xuICAgICAgICB2YXIgbGVuZ3RoID0gdS5ub3JtYWxpemUoKTtcbiAgICAgICAgdmFyIEMgPSBsZW5ndGggLSB0aGlzLm1fbWF4TGVuZ3RoO1xuICAgICAgICBDID0gY2xhbXAoQywgMCwgU2V0dGluZ3NJbnRlcm5hbC5tYXhMaW5lYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX21hc3MgKiBDO1xuICAgICAgICB2YXIgUDMgPSBWZWMyLm11bE51bVZlYzIoaW1wdWxzZSwgdSk7XG4gICAgICAgIGNBMi5zdWJNdWwodGhpcy5tX2ludk1hc3NBLCBQMyk7XG4gICAgICAgIGFBIC09IHRoaXMubV9pbnZJQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIFAzKTtcbiAgICAgICAgY0IyLmFkZE11bCh0aGlzLm1faW52TWFzc0IsIFAzKTtcbiAgICAgICAgYUIgKz0gdGhpcy5tX2ludklCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHJCMiwgUDMpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jLnNldFZlYzIoY0EyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jLnNldFZlYzIoY0IyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICByZXR1cm4gbGVuZ3RoIC0gdGhpcy5tX21heExlbmd0aCA8IFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICAgIH07XG4gICAgICBSb3BlSm9pbnQyLlRZUEUgPSBcInJvcGUtam9pbnRcIjtcbiAgICAgIHJldHVybiBSb3BlSm9pbnQyO1xuICAgIH0oSm9pbnQpXG4gICk7XG4gIHZhciBtYXRoX2FicyQxID0gTWF0aC5hYnM7XG4gIHZhciBtYXRoX1BJJDEgPSBNYXRoLlBJO1xuICB2YXIgREVGQVVMVFMkMSA9IHtcbiAgICBmcmVxdWVuY3lIejogMCxcbiAgICBkYW1waW5nUmF0aW86IDBcbiAgfTtcbiAgdmFyIFdlbGRKb2ludCA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoV2VsZEpvaW50MiwgX3N1cGVyKTtcbiAgICAgIGZ1bmN0aW9uIFdlbGRKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIFdlbGRKb2ludDIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBXZWxkSm9pbnQyKGRlZiwgYm9keUEsIGJvZHlCLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgICAgIGRlZiA9IG9wdGlvbnMoZGVmLCBERUZBVUxUUyQxKTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fdHlwZSA9IFdlbGRKb2ludDIuVFlQRTtcbiAgICAgICAgX3RoaXMubV9sb2NhbEFuY2hvckEgPSBWZWMyLmNsb25lKGFuY2hvciA/IGJvZHlBLmdldExvY2FsUG9pbnQoYW5jaG9yKSA6IGRlZi5sb2NhbEFuY2hvckEgfHwgVmVjMi56ZXJvKCkpO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQiA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUIuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQiB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBOdW1iZXIuaXNGaW5pdGUoZGVmLnJlZmVyZW5jZUFuZ2xlKSA/IGRlZi5yZWZlcmVuY2VBbmdsZSA6IGJvZHlCLmdldEFuZ2xlKCkgLSBib2R5QS5nZXRBbmdsZSgpO1xuICAgICAgICBfdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICBfdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IG5ldyBWZWMzKCk7XG4gICAgICAgIF90aGlzLm1fYmlhcyA9IDA7XG4gICAgICAgIF90aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICBfdGhpcy5tX21hc3MgPSBuZXcgTWF0MzMoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuX3NlcmlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IHRoaXMubV90eXBlLFxuICAgICAgICAgIGJvZHlBOiB0aGlzLm1fYm9keUEsXG4gICAgICAgICAgYm9keUI6IHRoaXMubV9ib2R5QixcbiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkOiB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCxcbiAgICAgICAgICBmcmVxdWVuY3lIejogdGhpcy5tX2ZyZXF1ZW5jeUh6LFxuICAgICAgICAgIGRhbXBpbmdSYXRpbzogdGhpcy5tX2RhbXBpbmdSYXRpbyxcbiAgICAgICAgICBsb2NhbEFuY2hvckE6IHRoaXMubV9sb2NhbEFuY2hvckEsXG4gICAgICAgICAgbG9jYWxBbmNob3JCOiB0aGlzLm1fbG9jYWxBbmNob3JCLFxuICAgICAgICAgIHJlZmVyZW5jZUFuZ2xlOiB0aGlzLm1fcmVmZXJlbmNlQW5nbGVcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLl9kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGRhdGEsIHdvcmxkLCByZXN0b3JlKSB7XG4gICAgICAgIGRhdGEgPSBfX2Fzc2lnbih7fSwgZGF0YSk7XG4gICAgICAgIGRhdGEuYm9keUEgPSByZXN0b3JlKEJvZHksIGRhdGEuYm9keUEsIHdvcmxkKTtcbiAgICAgICAgZGF0YS5ib2R5QiA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5Qiwgd29ybGQpO1xuICAgICAgICB2YXIgam9pbnQgPSBuZXcgV2VsZEpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uKGRlZikge1xuICAgICAgICBpZiAoZGVmLmFuY2hvckEpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLnNldFZlYzIodGhpcy5tX2JvZHlBLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckEpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuYW5jaG9yQikge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuc2V0VmVjMih0aGlzLm1fYm9keUIuZ2V0TG9jYWxQb2ludChkZWYuYW5jaG9yQikpO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZi5sb2NhbEFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYuZnJlcXVlbmN5SHopKSB7XG4gICAgICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmRhbXBpbmdSYXRpbykpIHtcbiAgICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldExvY2FsQW5jaG9yQSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX2xvY2FsQW5jaG9yQTtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0UmVmZXJlbmNlQW5nbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5zZXRGcmVxdWVuY3kgPSBmdW5jdGlvbihoeikge1xuICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBoejtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5nZXRGcmVxdWVuY3kgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgIH07XG4gICAgICBXZWxkSm9pbnQyLnByb3RvdHlwZS5zZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbihyYXRpbykge1xuICAgICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gcmF0aW87XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuZ2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZGFtcGluZ1JhdGlvO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbihpbnZfZHQpIHtcbiAgICAgICAgcmV0dXJuIFZlYzIubmVvKHRoaXMubV9pbXB1bHNlLngsIHRoaXMubV9pbXB1bHNlLnkpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24oaW52X2R0KSB7XG4gICAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS56O1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLmluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gdGhpcy5tX2JvZHlBLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2ludk1hc3NBID0gdGhpcy5tX2JvZHlBLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludk1hc3NCID0gdGhpcy5tX2JvZHlCLm1faW52TWFzcztcbiAgICAgICAgdGhpcy5tX2ludklBID0gdGhpcy5tX2JvZHlBLm1faW52STtcbiAgICAgICAgdGhpcy5tX2ludklCID0gdGhpcy5tX2JvZHlCLm1faW52STtcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHRoaXMubV9yQSA9IFJvdC5tdWxWZWMyKHFBLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JBLCB0aGlzLm1fbG9jYWxDZW50ZXJBKSk7XG4gICAgICAgIHRoaXMubV9yQiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIEsgPSBuZXcgTWF0MzMoKTtcbiAgICAgICAgSy5leC54ID0gbUEgKyBtQiArIHRoaXMubV9yQS55ICogdGhpcy5tX3JBLnkgKiBpQSArIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnkgKiBpQjtcbiAgICAgICAgSy5leS54ID0gLXRoaXMubV9yQS55ICogdGhpcy5tX3JBLnggKiBpQSAtIHRoaXMubV9yQi55ICogdGhpcy5tX3JCLnggKiBpQjtcbiAgICAgICAgSy5lei54ID0gLXRoaXMubV9yQS55ICogaUEgLSB0aGlzLm1fckIueSAqIGlCO1xuICAgICAgICBLLmV4LnkgPSBLLmV5Lng7XG4gICAgICAgIEsuZXkueSA9IG1BICsgbUIgKyB0aGlzLm1fckEueCAqIHRoaXMubV9yQS54ICogaUEgKyB0aGlzLm1fckIueCAqIHRoaXMubV9yQi54ICogaUI7XG4gICAgICAgIEsuZXoueSA9IHRoaXMubV9yQS54ICogaUEgKyB0aGlzLm1fckIueCAqIGlCO1xuICAgICAgICBLLmV4LnogPSBLLmV6Lng7XG4gICAgICAgIEsuZXkueiA9IEsuZXoueTtcbiAgICAgICAgSy5lei56ID0gaUEgKyBpQjtcbiAgICAgICAgaWYgKHRoaXMubV9mcmVxdWVuY3lIeiA+IDApIHtcbiAgICAgICAgICBLLmdldEludmVyc2UyMih0aGlzLm1fbWFzcyk7XG4gICAgICAgICAgdmFyIGludk0gPSBpQSArIGlCO1xuICAgICAgICAgIHZhciBtID0gaW52TSA+IDAgPyAxIC8gaW52TSA6IDA7XG4gICAgICAgICAgdmFyIEMgPSBhQiAtIGFBIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xuICAgICAgICAgIHZhciBvbWVnYSA9IDIgKiBtYXRoX1BJJDEgKiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICAgICAgdmFyIGQyID0gMiAqIG0gKiB0aGlzLm1fZGFtcGluZ1JhdGlvICogb21lZ2E7XG4gICAgICAgICAgdmFyIGsgPSBtICogb21lZ2EgKiBvbWVnYTtcbiAgICAgICAgICB2YXIgaCA9IHN0ZXAuZHQ7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gaCAqIChkMiArIGggKiBrKTtcbiAgICAgICAgICB0aGlzLm1fZ2FtbWEgPSB0aGlzLm1fZ2FtbWEgIT0gMCA/IDEgLyB0aGlzLm1fZ2FtbWEgOiAwO1xuICAgICAgICAgIHRoaXMubV9iaWFzID0gQyAqIGggKiBrICogdGhpcy5tX2dhbW1hO1xuICAgICAgICAgIGludk0gKz0gdGhpcy5tX2dhbW1hO1xuICAgICAgICAgIHRoaXMubV9tYXNzLmV6LnogPSBpbnZNICE9IDAgPyAxIC8gaW52TSA6IDA7XG4gICAgICAgIH0gZWxzZSBpZiAoSy5lei56ID09IDApIHtcbiAgICAgICAgICBLLmdldEludmVyc2UyMih0aGlzLm1fbWFzcyk7XG4gICAgICAgICAgdGhpcy5tX2dhbW1hID0gMDtcbiAgICAgICAgICB0aGlzLm1fYmlhcyA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgSy5nZXRTeW1JbnZlcnNlMzModGhpcy5tX21hc3MpO1xuICAgICAgICAgIHRoaXMubV9nYW1tYSA9IDA7XG4gICAgICAgICAgdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLm11bChzdGVwLmR0UmF0aW8pO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVvKHRoaXMubV9pbXB1bHNlLngsIHRoaXMubV9pbXB1bHNlLnkpO1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMykgKyB0aGlzLm1faW1wdWxzZS56KTtcbiAgICAgICAgICB2QjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgd0IgKz0gaUIgKiAoVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpICsgdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2Uuc2V0WmVybygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYgPSB2QTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LncgPSB3QTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudiA9IHZCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFdlbGRKb2ludDIucHJvdG90eXBlLnNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIGlmICh0aGlzLm1fZnJlcXVlbmN5SHogPiAwKSB7XG4gICAgICAgICAgdmFyIENkb3QyID0gd0IgLSB3QTtcbiAgICAgICAgICB2YXIgaW1wdWxzZTIgPSAtdGhpcy5tX21hc3MuZXoueiAqIChDZG90MiArIHRoaXMubV9iaWFzICsgdGhpcy5tX2dhbW1hICogdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiArPSBpbXB1bHNlMjtcbiAgICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2UyO1xuICAgICAgICAgIHdCICs9IGlCICogaW1wdWxzZTI7XG4gICAgICAgICAgdmFyIENkb3QxID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQ2RvdDEuYWRkQ29tYmluZSgxLCB2QjIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdCLCB0aGlzLm1fckIpKTtcbiAgICAgICAgICBDZG90MS5zdWJDb21iaW5lKDEsIHZBMiwgMSwgVmVjMi5jcm9zc051bVZlYzIod0EsIHRoaXMubV9yQSkpO1xuICAgICAgICAgIHZhciBpbXB1bHNlMSA9IFZlYzIubmVnKE1hdDMzLm11bFZlYzIodGhpcy5tX21hc3MsIENkb3QxKSk7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSBpbXB1bHNlMS54O1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gaW1wdWxzZTEueTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLmNsb25lKGltcHVsc2UxKTtcbiAgICAgICAgICB2QTIuc3ViTXVsKG1BLCBQMyk7XG4gICAgICAgICAgd0EgLT0gaUEgKiBWZWMyLmNyb3NzVmVjMlZlYzIodGhpcy5tX3JBLCBQMyk7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogVmVjMi5jcm9zc1ZlYzJWZWMyKHRoaXMubV9yQiwgUDMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBDZG90MSA9IFZlYzIuemVybygpO1xuICAgICAgICAgIENkb3QxLmFkZENvbWJpbmUoMSwgdkIyLCAxLCBWZWMyLmNyb3NzTnVtVmVjMih3QiwgdGhpcy5tX3JCKSk7XG4gICAgICAgICAgQ2RvdDEuc3ViQ29tYmluZSgxLCB2QTIsIDEsIFZlYzIuY3Jvc3NOdW1WZWMyKHdBLCB0aGlzLm1fckEpKTtcbiAgICAgICAgICB2YXIgQ2RvdDIgPSB3QiAtIHdBO1xuICAgICAgICAgIHZhciBDZG90ID0gbmV3IFZlYzMoQ2RvdDEueCwgQ2RvdDEueSwgQ2RvdDIpO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gVmVjMy5uZWcoTWF0MzMubXVsVmVjMyh0aGlzLm1fbWFzcywgQ2RvdCkpO1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlLmFkZChpbXB1bHNlKTtcbiAgICAgICAgICB2YXIgUDMgPSBWZWMyLm5lbyhpbXB1bHNlLngsIGltcHVsc2UueSk7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckEsIFAzKSArIGltcHVsc2Uueik7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogKFZlYzIuY3Jvc3NWZWMyVmVjMih0aGlzLm1fckIsIFAzKSArIGltcHVsc2Uueik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudiA9IHZBMjtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52ID0gdkIyO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5wcm90b3R5cGUuc29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgY0EyID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYztcbiAgICAgICAgdmFyIGFBID0gdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYTtcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBxQSA9IFJvdC5uZW8oYUEpO1xuICAgICAgICB2YXIgcUIgPSBSb3QubmVvKGFCKTtcbiAgICAgICAgdmFyIG1BID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICB2YXIgbUIgPSB0aGlzLm1faW52TWFzc0I7XG4gICAgICAgIHZhciBpQSA9IHRoaXMubV9pbnZJQTtcbiAgICAgICAgdmFyIGlCID0gdGhpcy5tX2ludklCO1xuICAgICAgICB2YXIgckEyID0gUm90Lm11bFZlYzIocUEsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckEsIHRoaXMubV9sb2NhbENlbnRlckEpKTtcbiAgICAgICAgdmFyIHJCMiA9IFJvdC5tdWxWZWMyKHFCLCBWZWMyLnN1Yih0aGlzLm1fbG9jYWxBbmNob3JCLCB0aGlzLm1fbG9jYWxDZW50ZXJCKSk7XG4gICAgICAgIHZhciBwb3NpdGlvbkVycm9yO1xuICAgICAgICB2YXIgYW5ndWxhckVycm9yO1xuICAgICAgICB2YXIgSyA9IG5ldyBNYXQzMygpO1xuICAgICAgICBLLmV4LnggPSBtQSArIG1CICsgckEyLnkgKiByQTIueSAqIGlBICsgckIyLnkgKiByQjIueSAqIGlCO1xuICAgICAgICBLLmV5LnggPSAtckEyLnkgKiByQTIueCAqIGlBIC0gckIyLnkgKiByQjIueCAqIGlCO1xuICAgICAgICBLLmV6LnggPSAtckEyLnkgKiBpQSAtIHJCMi55ICogaUI7XG4gICAgICAgIEsuZXgueSA9IEsuZXkueDtcbiAgICAgICAgSy5leS55ID0gbUEgKyBtQiArIHJBMi54ICogckEyLnggKiBpQSArIHJCMi54ICogckIyLnggKiBpQjtcbiAgICAgICAgSy5lei55ID0gckEyLnggKiBpQSArIHJCMi54ICogaUI7XG4gICAgICAgIEsuZXgueiA9IEsuZXoueDtcbiAgICAgICAgSy5leS56ID0gSy5lei55O1xuICAgICAgICBLLmV6LnogPSBpQSArIGlCO1xuICAgICAgICBpZiAodGhpcy5tX2ZyZXF1ZW5jeUh6ID4gMCkge1xuICAgICAgICAgIHZhciBDMSA9IFZlYzIuemVybygpO1xuICAgICAgICAgIEMxLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICAgIEMxLnN1YkNvbWJpbmUoMSwgY0EyLCAxLCByQTIpO1xuICAgICAgICAgIHBvc2l0aW9uRXJyb3IgPSBDMS5sZW5ndGgoKTtcbiAgICAgICAgICBhbmd1bGFyRXJyb3IgPSAwO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubmVnKEsuc29sdmUyMihDMSkpO1xuICAgICAgICAgIGNBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICBhQSAtPSBpQSAqIFZlYzIuY3Jvc3NWZWMyVmVjMihyQTIsIFAzKTtcbiAgICAgICAgICBjQjIuYWRkTXVsKG1CLCBQMyk7XG4gICAgICAgICAgYUIgKz0gaUIgKiBWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBQMyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIEMxID0gVmVjMi56ZXJvKCk7XG4gICAgICAgICAgQzEuYWRkQ29tYmluZSgxLCBjQjIsIDEsIHJCMik7XG4gICAgICAgICAgQzEuc3ViQ29tYmluZSgxLCBjQTIsIDEsIHJBMik7XG4gICAgICAgICAgdmFyIEMyID0gYUIgLSBhQSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgICBwb3NpdGlvbkVycm9yID0gQzEubGVuZ3RoKCk7XG4gICAgICAgICAgYW5ndWxhckVycm9yID0gbWF0aF9hYnMkMShDMik7XG4gICAgICAgICAgdmFyIEMgPSBuZXcgVmVjMyhDMS54LCBDMS55LCBDMik7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSBuZXcgVmVjMygpO1xuICAgICAgICAgIGlmIChLLmV6LnogPiAwKSB7XG4gICAgICAgICAgICBpbXB1bHNlID0gVmVjMy5uZWcoSy5zb2x2ZTMzKEMpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGltcHVsc2UyID0gVmVjMi5uZWcoSy5zb2x2ZTIyKEMxKSk7XG4gICAgICAgICAgICBpbXB1bHNlLnNldChpbXB1bHNlMi54LCBpbXB1bHNlMi55LCAwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5uZW8oaW1wdWxzZS54LCBpbXB1bHNlLnkpO1xuICAgICAgICAgIGNBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICBhQSAtPSBpQSAqIChWZWMyLmNyb3NzVmVjMlZlYzIockEyLCBQMykgKyBpbXB1bHNlLnopO1xuICAgICAgICAgIGNCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICBhQiArPSBpQiAqIChWZWMyLmNyb3NzVmVjMlZlYzIockIyLCBQMykgKyBpbXB1bHNlLnopO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmMgPSBjQTI7XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmEgPSBhQTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYyA9IGNCMjtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICByZXR1cm4gcG9zaXRpb25FcnJvciA8PSBTZXR0aW5nc0ludGVybmFsLmxpbmVhclNsb3AgJiYgYW5ndWxhckVycm9yIDw9IFNldHRpbmdzSW50ZXJuYWwuYW5ndWxhclNsb3A7XG4gICAgICB9O1xuICAgICAgV2VsZEpvaW50Mi5UWVBFID0gXCJ3ZWxkLWpvaW50XCI7XG4gICAgICByZXR1cm4gV2VsZEpvaW50MjtcbiAgICB9KEpvaW50KVxuICApO1xuICB2YXIgbWF0aF9hYnMgPSBNYXRoLmFicztcbiAgdmFyIG1hdGhfUEkgPSBNYXRoLlBJO1xuICB2YXIgREVGQVVMVFMgPSB7XG4gICAgZW5hYmxlTW90b3I6IGZhbHNlLFxuICAgIG1heE1vdG9yVG9ycXVlOiAwLFxuICAgIG1vdG9yU3BlZWQ6IDAsXG4gICAgZnJlcXVlbmN5SHo6IDIsXG4gICAgZGFtcGluZ1JhdGlvOiAwLjdcbiAgfTtcbiAgdmFyIFdoZWVsSm9pbnQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFdoZWVsSm9pbnQyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gV2hlZWxKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvciwgYXhpcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShfdGhpcyBpbnN0YW5jZW9mIFdoZWVsSm9pbnQyKSkge1xuICAgICAgICAgIHJldHVybiBuZXcgV2hlZWxKb2ludDIoZGVmLCBib2R5QSwgYm9keUIsIGFuY2hvciwgYXhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmID0gb3B0aW9ucyhkZWYsIERFRkFVTFRTKTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZWYsIGJvZHlBLCBib2R5QikgfHwgdGhpcztcbiAgICAgICAgYm9keUEgPSBfdGhpcy5tX2JvZHlBO1xuICAgICAgICBib2R5QiA9IF90aGlzLm1fYm9keUI7XG4gICAgICAgIF90aGlzLm1fYXggPSBWZWMyLnplcm8oKTtcbiAgICAgICAgX3RoaXMubV9heSA9IFZlYzIuemVybygpO1xuICAgICAgICBfdGhpcy5tX3R5cGUgPSBXaGVlbEpvaW50Mi5UWVBFO1xuICAgICAgICBfdGhpcy5tX2xvY2FsQW5jaG9yQSA9IFZlYzIuY2xvbmUoYW5jaG9yID8gYm9keUEuZ2V0TG9jYWxQb2ludChhbmNob3IpIDogZGVmLmxvY2FsQW5jaG9yQSB8fCBWZWMyLnplcm8oKSk7XG4gICAgICAgIF90aGlzLm1fbG9jYWxBbmNob3JCID0gVmVjMi5jbG9uZShhbmNob3IgPyBib2R5Qi5nZXRMb2NhbFBvaW50KGFuY2hvcikgOiBkZWYubG9jYWxBbmNob3JCIHx8IFZlYzIuemVybygpKTtcbiAgICAgICAgaWYgKFZlYzIuaXNWYWxpZChheGlzKSkge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxYQXhpc0EgPSBib2R5QS5nZXRMb2NhbFZlY3RvcihheGlzKTtcbiAgICAgICAgfSBlbHNlIGlmIChWZWMyLmlzVmFsaWQoZGVmLmxvY2FsQXhpc0EpKSB7XG4gICAgICAgICAgX3RoaXMubV9sb2NhbFhBeGlzQSA9IFZlYzIuY2xvbmUoZGVmLmxvY2FsQXhpc0EpO1xuICAgICAgICB9IGVsc2UgaWYgKFZlYzIuaXNWYWxpZChkZWYubG9jYWxBeGlzKSkge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxYQXhpc0EgPSBWZWMyLmNsb25lKGRlZi5sb2NhbEF4aXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF90aGlzLm1fbG9jYWxYQXhpc0EgPSBWZWMyLm5lbygxLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5tX2xvY2FsWUF4aXNBID0gVmVjMi5jcm9zc051bVZlYzIoMSwgX3RoaXMubV9sb2NhbFhBeGlzQSk7XG4gICAgICAgIF90aGlzLm1fbWFzcyA9IDA7XG4gICAgICAgIF90aGlzLm1faW1wdWxzZSA9IDA7XG4gICAgICAgIF90aGlzLm1fbW90b3JNYXNzID0gMDtcbiAgICAgICAgX3RoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX3NwcmluZ01hc3MgPSAwO1xuICAgICAgICBfdGhpcy5tX3NwcmluZ0ltcHVsc2UgPSAwO1xuICAgICAgICBfdGhpcy5tX21heE1vdG9yVG9ycXVlID0gZGVmLm1heE1vdG9yVG9ycXVlO1xuICAgICAgICBfdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcbiAgICAgICAgX3RoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcbiAgICAgICAgX3RoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgICAgX3RoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xuICAgICAgICBfdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICBfdGhpcy5tX2dhbW1hID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgfVxuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLl9zZXJpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiB0aGlzLm1fdHlwZSxcbiAgICAgICAgICBib2R5QTogdGhpcy5tX2JvZHlBLFxuICAgICAgICAgIGJvZHlCOiB0aGlzLm1fYm9keUIsXG4gICAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQsXG4gICAgICAgICAgZW5hYmxlTW90b3I6IHRoaXMubV9lbmFibGVNb3RvcixcbiAgICAgICAgICBtYXhNb3RvclRvcnF1ZTogdGhpcy5tX21heE1vdG9yVG9ycXVlLFxuICAgICAgICAgIG1vdG9yU3BlZWQ6IHRoaXMubV9tb3RvclNwZWVkLFxuICAgICAgICAgIGZyZXF1ZW5jeUh6OiB0aGlzLm1fZnJlcXVlbmN5SHosXG4gICAgICAgICAgZGFtcGluZ1JhdGlvOiB0aGlzLm1fZGFtcGluZ1JhdGlvLFxuICAgICAgICAgIGxvY2FsQW5jaG9yQTogdGhpcy5tX2xvY2FsQW5jaG9yQSxcbiAgICAgICAgICBsb2NhbEFuY2hvckI6IHRoaXMubV9sb2NhbEFuY2hvckIsXG4gICAgICAgICAgbG9jYWxBeGlzQTogdGhpcy5tX2xvY2FsWEF4aXNBXG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIuX2Rlc2VyaWFsaXplID0gZnVuY3Rpb24oZGF0YSwgd29ybGQsIHJlc3RvcmUpIHtcbiAgICAgICAgZGF0YSA9IF9fYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YS5ib2R5QSA9IHJlc3RvcmUoQm9keSwgZGF0YS5ib2R5QSwgd29ybGQpO1xuICAgICAgICBkYXRhLmJvZHlCID0gcmVzdG9yZShCb2R5LCBkYXRhLmJvZHlCLCB3b3JsZCk7XG4gICAgICAgIHZhciBqb2ludCA9IG5ldyBXaGVlbEpvaW50MihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGpvaW50O1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbihkZWYpIHtcbiAgICAgICAgaWYgKGRlZi5hbmNob3JBKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5zZXRWZWMyKHRoaXMubV9ib2R5QS5nZXRMb2NhbFBvaW50KGRlZi5hbmNob3JBKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVmLmxvY2FsQW5jaG9yQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuc2V0VmVjMihkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmLmFuY2hvckIpIHtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLnNldFZlYzIodGhpcy5tX2JvZHlCLmdldExvY2FsUG9pbnQoZGVmLmFuY2hvckIpKTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWYubG9jYWxBbmNob3JCKSB7XG4gICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5zZXRWZWMyKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYubG9jYWxBeGlzQSkge1xuICAgICAgICAgIHRoaXMubV9sb2NhbFhBeGlzQS5zZXRWZWMyKGRlZi5sb2NhbEF4aXNBKTtcbiAgICAgICAgICB0aGlzLm1fbG9jYWxZQXhpc0Euc2V0VmVjMihWZWMyLmNyb3NzTnVtVmVjMigxLCBkZWYubG9jYWxBeGlzQSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYuZW5hYmxlTW90b3IgIT09IHZvaWQgMCkge1xuICAgICAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5tYXhNb3RvclRvcnF1ZSkpIHtcbiAgICAgICAgICB0aGlzLm1fbWF4TW90b3JUb3JxdWUgPSBkZWYubWF4TW90b3JUb3JxdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShkZWYubW90b3JTcGVlZCkpIHtcbiAgICAgICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVmLmZyZXF1ZW5jeUh6KSkge1xuICAgICAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTnVtYmVyLmlzRmluaXRlKGRlZi5kYW1waW5nUmF0aW8pKSB7XG4gICAgICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0TG9jYWxBbmNob3JBID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbG9jYWxBbmNob3JBO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRMb2NhbEFuY2hvckIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbEFuY2hvckI7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldExvY2FsQXhpc0EgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9sb2NhbFhBeGlzQTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnRUcmFuc2xhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgICAgdmFyIHBBMiA9IGJBLmdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICAgICAgIHZhciBwQjIgPSBiQi5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xuICAgICAgICB2YXIgZDIgPSBWZWMyLnN1YihwQjIsIHBBMik7XG4gICAgICAgIHZhciBheGlzID0gYkEuZ2V0V29ybGRWZWN0b3IodGhpcy5tX2xvY2FsWEF4aXNBKTtcbiAgICAgICAgdmFyIHRyYW5zbGF0aW9uMiA9IFZlYzIuZG90KGQyLCBheGlzKTtcbiAgICAgICAgcmV0dXJuIHRyYW5zbGF0aW9uMjtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0Sm9pbnRTcGVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgd0EgPSB0aGlzLm1fYm9keUEubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICAgIHZhciB3QiA9IHRoaXMubV9ib2R5Qi5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgcmV0dXJuIHdCIC0gd0E7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmlzTW90b3JFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTW90b3I7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmVuYWJsZU1vdG9yID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICBpZiAoZmxhZyA9PSB0aGlzLm1fZW5hYmxlTW90b3IpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZmxhZztcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuc2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uKHNwZWVkKSB7XG4gICAgICAgIGlmIChzcGVlZCA9PSB0aGlzLm1fbW90b3JTcGVlZClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubV9ib2R5QS5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLnNldEF3YWtlKHRydWUpO1xuICAgICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IHNwZWVkO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRNb3RvclNwZWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fbW90b3JTcGVlZDtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuc2V0TWF4TW90b3JUb3JxdWUgPSBmdW5jdGlvbih0b3JxdWUpIHtcbiAgICAgICAgaWYgKHRvcnF1ZSA9PSB0aGlzLm1fbWF4TW90b3JUb3JxdWUpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLm1fYm9keUEuc2V0QXdha2UodHJ1ZSk7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5zZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgdGhpcy5tX21heE1vdG9yVG9ycXVlID0gdG9ycXVlO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRNYXhNb3RvclRvcnF1ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tX21heE1vdG9yVG9ycXVlO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRNb3RvclRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuc2V0U3ByaW5nRnJlcXVlbmN5SHogPSBmdW5jdGlvbihoeikge1xuICAgICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBoejtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0U3ByaW5nRnJlcXVlbmN5SHogPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9mcmVxdWVuY3lIejtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuc2V0U3ByaW5nRGFtcGluZ1JhdGlvID0gZnVuY3Rpb24ocmF0aW8pIHtcbiAgICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IHJhdGlvO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRTcHJpbmdEYW1waW5nUmF0aW8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9kYW1waW5nUmF0aW87XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLmdldEFuY2hvckEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5nZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRBbmNob3JCID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuZ2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuZ2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gVmVjMi5jb21iaW5lKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fYXksIHRoaXMubV9zcHJpbmdJbXB1bHNlLCB0aGlzLm1fYXgpLm11bChpbnZfZHQpO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5nZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uKGludl9kdCkge1xuICAgICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgIH07XG4gICAgICBXaGVlbEpvaW50Mi5wcm90b3R5cGUuaW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSB0aGlzLm1fYm9keUEubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQiA9IHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgICB0aGlzLm1faW52TWFzc0EgPSB0aGlzLm1fYm9keUEubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52TWFzc0IgPSB0aGlzLm1fYm9keUIubV9pbnZNYXNzO1xuICAgICAgICB0aGlzLm1faW52SUEgPSB0aGlzLm1fYm9keUEubV9pbnZJO1xuICAgICAgICB0aGlzLm1faW52SUIgPSB0aGlzLm1fYm9keUIubV9pbnZJO1xuICAgICAgICB2YXIgbUEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgIHZhciBtQiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgdmFyIGlBID0gdGhpcy5tX2ludklBO1xuICAgICAgICB2YXIgaUIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgIHZhciBjQTIgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUEgPSB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgdkEyID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudjtcbiAgICAgICAgdmFyIHdBID0gdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudztcbiAgICAgICAgdmFyIGNCMiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQiA9IHRoaXMubV9ib2R5Qi5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIGQyLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICBkMi5zdWJDb21iaW5lKDEsIGNBMiwgMSwgckEyKTtcbiAgICAgICAge1xuICAgICAgICAgIHRoaXMubV9heSA9IFJvdC5tdWxWZWMyKHFBLCB0aGlzLm1fbG9jYWxZQXhpc0EpO1xuICAgICAgICAgIHRoaXMubV9zQXkgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIHRoaXMubV9heSk7XG4gICAgICAgICAgdGhpcy5tX3NCeSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHRoaXMubV9heSk7XG4gICAgICAgICAgdGhpcy5tX21hc3MgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fc0F5ICogdGhpcy5tX3NBeSArIGlCICogdGhpcy5tX3NCeSAqIHRoaXMubV9zQnk7XG4gICAgICAgICAgaWYgKHRoaXMubV9tYXNzID4gMCkge1xuICAgICAgICAgICAgdGhpcy5tX21hc3MgPSAxIC8gdGhpcy5tX21hc3M7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9zcHJpbmdNYXNzID0gMDtcbiAgICAgICAgdGhpcy5tX2JpYXMgPSAwO1xuICAgICAgICB0aGlzLm1fZ2FtbWEgPSAwO1xuICAgICAgICBpZiAodGhpcy5tX2ZyZXF1ZW5jeUh6ID4gMCkge1xuICAgICAgICAgIHRoaXMubV9heCA9IFJvdC5tdWxWZWMyKHFBLCB0aGlzLm1fbG9jYWxYQXhpc0EpO1xuICAgICAgICAgIHRoaXMubV9zQXggPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIHRoaXMubV9heCk7XG4gICAgICAgICAgdGhpcy5tX3NCeCA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIHRoaXMubV9heCk7XG4gICAgICAgICAgdmFyIGludk1hc3MgPSBtQSArIG1CICsgaUEgKiB0aGlzLm1fc0F4ICogdGhpcy5tX3NBeCArIGlCICogdGhpcy5tX3NCeCAqIHRoaXMubV9zQng7XG4gICAgICAgICAgaWYgKGludk1hc3MgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLm1fc3ByaW5nTWFzcyA9IDEgLyBpbnZNYXNzO1xuICAgICAgICAgICAgdmFyIEMgPSBWZWMyLmRvdChkMiwgdGhpcy5tX2F4KTtcbiAgICAgICAgICAgIHZhciBvbWVnYSA9IDIgKiBtYXRoX1BJICogdGhpcy5tX2ZyZXF1ZW5jeUh6O1xuICAgICAgICAgICAgdmFyIGRhbXAgPSAyICogdGhpcy5tX3NwcmluZ01hc3MgKiB0aGlzLm1fZGFtcGluZ1JhdGlvICogb21lZ2E7XG4gICAgICAgICAgICB2YXIgayA9IHRoaXMubV9zcHJpbmdNYXNzICogb21lZ2EgKiBvbWVnYTtcbiAgICAgICAgICAgIHZhciBoID0gc3RlcC5kdDtcbiAgICAgICAgICAgIHRoaXMubV9nYW1tYSA9IGggKiAoZGFtcCArIGggKiBrKTtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fZ2FtbWEgPiAwKSB7XG4gICAgICAgICAgICAgIHRoaXMubV9nYW1tYSA9IDEgLyB0aGlzLm1fZ2FtbWE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1fYmlhcyA9IEMgKiBoICogayAqIHRoaXMubV9nYW1tYTtcbiAgICAgICAgICAgIHRoaXMubV9zcHJpbmdNYXNzID0gaW52TWFzcyArIHRoaXMubV9nYW1tYTtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fc3ByaW5nTWFzcyA+IDApIHtcbiAgICAgICAgICAgICAgdGhpcy5tX3NwcmluZ01hc3MgPSAxIC8gdGhpcy5tX3NwcmluZ01hc3M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9zcHJpbmdJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yKSB7XG4gICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IGlBICsgaUI7XG4gICAgICAgICAgaWYgKHRoaXMubV9tb3Rvck1hc3MgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gMSAvIHRoaXMubV9tb3Rvck1hc3M7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSAwO1xuICAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgIHRoaXMubV9pbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICB0aGlzLm1fc3ByaW5nSW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5jb21iaW5lKHRoaXMubV9pbXB1bHNlLCB0aGlzLm1fYXksIHRoaXMubV9zcHJpbmdJbXB1bHNlLCB0aGlzLm1fYXgpO1xuICAgICAgICAgIHZhciBMQSA9IHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3NBeSArIHRoaXMubV9zcHJpbmdJbXB1bHNlICogdGhpcy5tX3NBeCArIHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICAgICAgdmFyIExCID0gdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fc0J5ICsgdGhpcy5tX3NwcmluZ0ltcHVsc2UgKiB0aGlzLm1fc0J4ICsgdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgICAgICB2QTIuc3ViTXVsKHRoaXMubV9pbnZNYXNzQSwgUDMpO1xuICAgICAgICAgIHdBIC09IHRoaXMubV9pbnZJQSAqIExBO1xuICAgICAgICAgIHZCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQMyk7XG4gICAgICAgICAgd0IgKz0gdGhpcy5tX2ludklCICogTEI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwO1xuICAgICAgICAgIHRoaXMubV9zcHJpbmdJbXB1bHNlID0gMDtcbiAgICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS52LnNldFZlYzIodkEyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfdmVsb2NpdHkudyA9IHdBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52LnNldFZlYzIodkIyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfdmVsb2NpdHkudyA9IHdCO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLnByb3RvdHlwZS5zb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBtQSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgdmFyIG1CID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICB2YXIgaUEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgIHZhciBpQiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgdmFyIHZBMiA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnY7XG4gICAgICAgIHZhciB3QSA9IHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5Lnc7XG4gICAgICAgIHZhciB2QjIgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS52O1xuICAgICAgICB2YXIgd0IgPSB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53O1xuICAgICAgICB7XG4gICAgICAgICAgdmFyIENkb3QgPSBWZWMyLmRvdCh0aGlzLm1fYXgsIHZCMikgLSBWZWMyLmRvdCh0aGlzLm1fYXgsIHZBMikgKyB0aGlzLm1fc0J4ICogd0IgLSB0aGlzLm1fc0F4ICogd0E7XG4gICAgICAgICAgdmFyIGltcHVsc2UgPSAtdGhpcy5tX3NwcmluZ01hc3MgKiAoQ2RvdCArIHRoaXMubV9iaWFzICsgdGhpcy5tX2dhbW1hICogdGhpcy5tX3NwcmluZ0ltcHVsc2UpO1xuICAgICAgICAgIHRoaXMubV9zcHJpbmdJbXB1bHNlICs9IGltcHVsc2U7XG4gICAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIHRoaXMubV9heCk7XG4gICAgICAgICAgdmFyIExBID0gaW1wdWxzZSAqIHRoaXMubV9zQXg7XG4gICAgICAgICAgdmFyIExCID0gaW1wdWxzZSAqIHRoaXMubV9zQng7XG4gICAgICAgICAgdkEyLnN1Yk11bChtQSwgUDMpO1xuICAgICAgICAgIHdBIC09IGlBICogTEE7XG4gICAgICAgICAgdkIyLmFkZE11bChtQiwgUDMpO1xuICAgICAgICAgIHdCICs9IGlCICogTEI7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIHZhciBDZG90ID0gd0IgLSB3QSAtIHRoaXMubV9tb3RvclNwZWVkO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tb3Rvck1hc3MgKiBDZG90O1xuICAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4TW90b3JUb3JxdWU7XG4gICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IGNsYW1wKHRoaXMubV9tb3RvckltcHVsc2UgKyBpbXB1bHNlLCAtbWF4SW1wdWxzZSwgbWF4SW1wdWxzZSk7XG4gICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2UgLSBvbGRJbXB1bHNlO1xuICAgICAgICAgIHdBIC09IGlBICogaW1wdWxzZTtcbiAgICAgICAgICB3QiArPSBpQiAqIGltcHVsc2U7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgIHZhciBDZG90ID0gVmVjMi5kb3QodGhpcy5tX2F5LCB2QjIpIC0gVmVjMi5kb3QodGhpcy5tX2F5LCB2QTIpICsgdGhpcy5tX3NCeSAqIHdCIC0gdGhpcy5tX3NBeSAqIHdBO1xuICAgICAgICAgIHZhciBpbXB1bHNlID0gLXRoaXMubV9tYXNzICogQ2RvdDtcbiAgICAgICAgICB0aGlzLm1faW1wdWxzZSArPSBpbXB1bHNlO1xuICAgICAgICAgIHZhciBQMyA9IFZlYzIubXVsTnVtVmVjMihpbXB1bHNlLCB0aGlzLm1fYXkpO1xuICAgICAgICAgIHZhciBMQSA9IGltcHVsc2UgKiB0aGlzLm1fc0F5O1xuICAgICAgICAgIHZhciBMQiA9IGltcHVsc2UgKiB0aGlzLm1fc0J5O1xuICAgICAgICAgIHZBMi5zdWJNdWwobUEsIFAzKTtcbiAgICAgICAgICB3QSAtPSBpQSAqIExBO1xuICAgICAgICAgIHZCMi5hZGRNdWwobUIsIFAzKTtcbiAgICAgICAgICB3QiArPSBpQiAqIExCO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubV9ib2R5QS5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QTIpO1xuICAgICAgICB0aGlzLm1fYm9keUEuY192ZWxvY2l0eS53ID0gd0E7XG4gICAgICAgIHRoaXMubV9ib2R5Qi5jX3ZlbG9jaXR5LnYuc2V0VmVjMih2QjIpO1xuICAgICAgICB0aGlzLm1fYm9keUIuY192ZWxvY2l0eS53ID0gd0I7XG4gICAgICB9O1xuICAgICAgV2hlZWxKb2ludDIucHJvdG90eXBlLnNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIGNBMiA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmM7XG4gICAgICAgIHZhciBhQSA9IHRoaXMubV9ib2R5QS5jX3Bvc2l0aW9uLmE7XG4gICAgICAgIHZhciBjQjIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jO1xuICAgICAgICB2YXIgYUIgPSB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5hO1xuICAgICAgICB2YXIgcUEgPSBSb3QubmVvKGFBKTtcbiAgICAgICAgdmFyIHFCID0gUm90Lm5lbyhhQik7XG4gICAgICAgIHZhciByQTIgPSBSb3QubXVsVmVjMihxQSwgVmVjMi5zdWIodGhpcy5tX2xvY2FsQW5jaG9yQSwgdGhpcy5tX2xvY2FsQ2VudGVyQSkpO1xuICAgICAgICB2YXIgckIyID0gUm90Lm11bFZlYzIocUIsIFZlYzIuc3ViKHRoaXMubV9sb2NhbEFuY2hvckIsIHRoaXMubV9sb2NhbENlbnRlckIpKTtcbiAgICAgICAgdmFyIGQyID0gVmVjMi56ZXJvKCk7XG4gICAgICAgIGQyLmFkZENvbWJpbmUoMSwgY0IyLCAxLCByQjIpO1xuICAgICAgICBkMi5zdWJDb21iaW5lKDEsIGNBMiwgMSwgckEyKTtcbiAgICAgICAgdmFyIGF5ID0gUm90Lm11bFZlYzIocUEsIHRoaXMubV9sb2NhbFlBeGlzQSk7XG4gICAgICAgIHZhciBzQXkgPSBWZWMyLmNyb3NzVmVjMlZlYzIoVmVjMi5hZGQoZDIsIHJBMiksIGF5KTtcbiAgICAgICAgdmFyIHNCeSA9IFZlYzIuY3Jvc3NWZWMyVmVjMihyQjIsIGF5KTtcbiAgICAgICAgdmFyIEMgPSBWZWMyLmRvdChkMiwgYXkpO1xuICAgICAgICB2YXIgayA9IHRoaXMubV9pbnZNYXNzQSArIHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQSAqIHRoaXMubV9zQXkgKiB0aGlzLm1fc0F5ICsgdGhpcy5tX2ludklCICogdGhpcy5tX3NCeSAqIHRoaXMubV9zQnk7XG4gICAgICAgIHZhciBpbXB1bHNlID0gayAhPSAwID8gLUMgLyBrIDogMDtcbiAgICAgICAgdmFyIFAzID0gVmVjMi5tdWxOdW1WZWMyKGltcHVsc2UsIGF5KTtcbiAgICAgICAgdmFyIExBID0gaW1wdWxzZSAqIHNBeTtcbiAgICAgICAgdmFyIExCID0gaW1wdWxzZSAqIHNCeTtcbiAgICAgICAgY0EyLnN1Yk11bCh0aGlzLm1faW52TWFzc0EsIFAzKTtcbiAgICAgICAgYUEgLT0gdGhpcy5tX2ludklBICogTEE7XG4gICAgICAgIGNCMi5hZGRNdWwodGhpcy5tX2ludk1hc3NCLCBQMyk7XG4gICAgICAgIGFCICs9IHRoaXMubV9pbnZJQiAqIExCO1xuICAgICAgICB0aGlzLm1fYm9keUEuY19wb3NpdGlvbi5jLnNldFZlYzIoY0EyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlBLmNfcG9zaXRpb24uYSA9IGFBO1xuICAgICAgICB0aGlzLm1fYm9keUIuY19wb3NpdGlvbi5jLnNldFZlYzIoY0IyKTtcbiAgICAgICAgdGhpcy5tX2JvZHlCLmNfcG9zaXRpb24uYSA9IGFCO1xuICAgICAgICByZXR1cm4gbWF0aF9hYnMoQykgPD0gU2V0dGluZ3NJbnRlcm5hbC5saW5lYXJTbG9wO1xuICAgICAgfTtcbiAgICAgIFdoZWVsSm9pbnQyLlRZUEUgPSBcIndoZWVsLWpvaW50XCI7XG4gICAgICByZXR1cm4gV2hlZWxKb2ludDI7XG4gICAgfShKb2ludClcbiAgKTtcbiAgdmFyIF9hO1xuICB2YXIgU0lEID0gMDtcbiAgdmFyIFNFUklBTElaRV9SRUZfVFlQRVMgPSB7XG4gICAgXCJXb3JsZFwiOiBXb3JsZCxcbiAgICBcIkJvZHlcIjogQm9keSxcbiAgICBcIkpvaW50XCI6IEpvaW50LFxuICAgIFwiRml4dHVyZVwiOiBGaXh0dXJlLFxuICAgIFwiU2hhcGVcIjogU2hhcGVcbiAgfTtcbiAgdmFyIERFU0VSSUFMSVpFX0JZX1JFRl9UWVBFID0ge1xuICAgIFwiVmVjMlwiOiBWZWMyLFxuICAgIFwiVmVjM1wiOiBWZWMzLFxuICAgIFwiV29ybGRcIjogV29ybGQsXG4gICAgXCJCb2R5XCI6IEJvZHksXG4gICAgXCJKb2ludFwiOiBKb2ludCxcbiAgICBcIkZpeHR1cmVcIjogRml4dHVyZSxcbiAgICBcIlNoYXBlXCI6IFNoYXBlXG4gIH07XG4gIHZhciBERVNFUklBTElaRV9CWV9UWVBFX0ZJRUxEID0gKF9hID0ge30sIF9hW0JvZHkuU1RBVElDXSA9IEJvZHksIF9hW0JvZHkuRFlOQU1JQ10gPSBCb2R5LCBfYVtCb2R5LktJTkVNQVRJQ10gPSBCb2R5LCBfYVtDaGFpblNoYXBlLlRZUEVdID0gQ2hhaW5TaGFwZSwgLy8gW0JveFNoYXBlLlRZUEVdOiBCb3hTaGFwZSxcbiAgX2FbUG9seWdvblNoYXBlLlRZUEVdID0gUG9seWdvblNoYXBlLCBfYVtFZGdlU2hhcGUuVFlQRV0gPSBFZGdlU2hhcGUsIF9hW0NpcmNsZVNoYXBlLlRZUEVdID0gQ2lyY2xlU2hhcGUsIF9hW0Rpc3RhbmNlSm9pbnQuVFlQRV0gPSBEaXN0YW5jZUpvaW50LCBfYVtGcmljdGlvbkpvaW50LlRZUEVdID0gRnJpY3Rpb25Kb2ludCwgX2FbR2VhckpvaW50LlRZUEVdID0gR2VhckpvaW50LCBfYVtNb3RvckpvaW50LlRZUEVdID0gTW90b3JKb2ludCwgX2FbTW91c2VKb2ludC5UWVBFXSA9IE1vdXNlSm9pbnQsIF9hW1ByaXNtYXRpY0pvaW50LlRZUEVdID0gUHJpc21hdGljSm9pbnQsIF9hW1B1bGxleUpvaW50LlRZUEVdID0gUHVsbGV5Sm9pbnQsIF9hW1Jldm9sdXRlSm9pbnQuVFlQRV0gPSBSZXZvbHV0ZUpvaW50LCBfYVtSb3BlSm9pbnQuVFlQRV0gPSBSb3BlSm9pbnQsIF9hW1dlbGRKb2ludC5UWVBFXSA9IFdlbGRKb2ludCwgX2FbV2hlZWxKb2ludC5UWVBFXSA9IFdoZWVsSm9pbnQsIF9hKTtcbiAgdmFyIERFRkFVTFRfT1BUSU9OUyA9IHtcbiAgICByb290Q2xhc3M6IFdvcmxkLFxuICAgIHByZVNlcmlhbGl6ZTogZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqO1xuICAgIH0sXG4gICAgcG9zdFNlcmlhbGl6ZTogZnVuY3Rpb24oZGF0YSwgb2JqKSB7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9LFxuICAgIHByZURlc2VyaWFsaXplOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9LFxuICAgIHBvc3REZXNlcmlhbGl6ZTogZnVuY3Rpb24ob2JqLCBkYXRhKSB7XG4gICAgICByZXR1cm4gb2JqO1xuICAgIH1cbiAgfTtcbiAgdmFyIFNlcmlhbGl6ZXIgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIC8qIEBfX1BVUkVfXyAqLyBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIFNlcmlhbGl6ZXIyKG9wdGlvbnMyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMudG9Kc29uID0gZnVuY3Rpb24ocm9vdCkge1xuICAgICAgICAgIHZhciBwcmVTZXJpYWxpemUgPSBfdGhpcy5vcHRpb25zLnByZVNlcmlhbGl6ZTtcbiAgICAgICAgICB2YXIgcG9zdFNlcmlhbGl6ZSA9IF90aGlzLm9wdGlvbnMucG9zdFNlcmlhbGl6ZTtcbiAgICAgICAgICB2YXIganNvbiA9IFtdO1xuICAgICAgICAgIHZhciByZWZRdWV1ZSA9IFtyb290XTtcbiAgICAgICAgICB2YXIgcmVmTWVtb0J5SWQgPSB7fTtcbiAgICAgICAgICBmdW5jdGlvbiBhZGRUb1JlZlF1ZXVlKHZhbHVlLCB0eXBlTmFtZSkge1xuICAgICAgICAgICAgdmFsdWUuX19zaWQgPSB2YWx1ZS5fX3NpZCB8fCArK1NJRDtcbiAgICAgICAgICAgIGlmICghcmVmTWVtb0J5SWRbdmFsdWUuX19zaWRdKSB7XG4gICAgICAgICAgICAgIHJlZlF1ZXVlLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgICB2YXIgaW5kZXggPSBqc29uLmxlbmd0aCArIHJlZlF1ZXVlLmxlbmd0aDtcbiAgICAgICAgICAgICAgdmFyIHJlZiA9IHtcbiAgICAgICAgICAgICAgICByZWZJbmRleDogaW5kZXgsXG4gICAgICAgICAgICAgICAgcmVmVHlwZTogdHlwZU5hbWVcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgcmVmTWVtb0J5SWRbdmFsdWUuX19zaWRdID0gcmVmO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlZk1lbW9CeUlkW3ZhbHVlLl9fc2lkXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZnVuY3Rpb24gc2VyaWFsaXplV2l0aEhvb2tzKG9iajIpIHtcbiAgICAgICAgICAgIG9iajIgPSBwcmVTZXJpYWxpemUob2JqMik7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG9iajIuX3NlcmlhbGl6ZSgpO1xuICAgICAgICAgICAgZGF0YSA9IHBvc3RTZXJpYWxpemUoZGF0YSwgb2JqMik7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZnVuY3Rpb24gdHJhdmVyc2UodmFsdWUsIG5vUmVmVHlwZSkge1xuICAgICAgICAgICAgaWYgKG5vUmVmVHlwZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgIG5vUmVmVHlwZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIiB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlLl9zZXJpYWxpemUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICBpZiAoIW5vUmVmVHlwZSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHR5cGVOYW1lIGluIFNFUklBTElaRV9SRUZfVFlQRVMpIHtcbiAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFNFUklBTElaRV9SRUZfVFlQRVNbdHlwZU5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhZGRUb1JlZlF1ZXVlKHZhbHVlLCB0eXBlTmFtZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhbHVlID0gc2VyaWFsaXplV2l0aEhvb2tzKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSBbXTtcbiAgICAgICAgICAgICAgZm9yICh2YXIga2V5ID0gMDsga2V5IDwgdmFsdWUubGVuZ3RoOyBrZXkrKykge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlW2tleV0gPSB0cmF2ZXJzZSh2YWx1ZVtrZXldKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0ge307XG4gICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICBuZXdWYWx1ZVtrZXldID0gdHJhdmVyc2UodmFsdWVba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHdoaWxlIChyZWZRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBvYmogPSByZWZRdWV1ZS5zaGlmdCgpO1xuICAgICAgICAgICAgdmFyIHN0ciA9IHRyYXZlcnNlKG9iaiwgdHJ1ZSk7XG4gICAgICAgICAgICBqc29uLnB1c2goc3RyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGpzb247XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZnJvbUpzb24gPSBmdW5jdGlvbihqc29uKSB7XG4gICAgICAgICAgdmFyIHByZURlc2VyaWFsaXplID0gX3RoaXMub3B0aW9ucy5wcmVEZXNlcmlhbGl6ZTtcbiAgICAgICAgICB2YXIgcG9zdERlc2VyaWFsaXplID0gX3RoaXMub3B0aW9ucy5wb3N0RGVzZXJpYWxpemU7XG4gICAgICAgICAgdmFyIHJvb3RDbGFzcyA9IF90aGlzLm9wdGlvbnMucm9vdENsYXNzO1xuICAgICAgICAgIHZhciBkZXNlcmlhbGl6ZWRSZWZNZW1vQnlJbmRleCA9IHt9O1xuICAgICAgICAgIGZ1bmN0aW9uIGRlc2VyaWFsaXplV2l0aEhvb2tzKGNsYXNzSGludCwgZGF0YSwgY29udGV4dCkge1xuICAgICAgICAgICAgaWYgKCFjbGFzc0hpbnQgfHwgIWNsYXNzSGludC5fZGVzZXJpYWxpemUpIHtcbiAgICAgICAgICAgICAgY2xhc3NIaW50ID0gREVTRVJJQUxJWkVfQllfVFlQRV9GSUVMRFtkYXRhLnR5cGVdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlc2VyaWFsaXplciA9IGNsYXNzSGludCAmJiBjbGFzc0hpbnQuX2Rlc2VyaWFsaXplO1xuICAgICAgICAgICAgaWYgKCFkZXNlcmlhbGl6ZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YSA9IHByZURlc2VyaWFsaXplKGRhdGEpO1xuICAgICAgICAgICAgdmFyIGNsYXNzRGVzZXJpYWxpemVGbiA9IGNsYXNzSGludC5fZGVzZXJpYWxpemU7XG4gICAgICAgICAgICB2YXIgb2JqID0gY2xhc3NEZXNlcmlhbGl6ZUZuKGRhdGEsIGNvbnRleHQsIGRlc2VyaWFsaXplQ2hpbGQpO1xuICAgICAgICAgICAgb2JqID0gcG9zdERlc2VyaWFsaXplKG9iaiwgZGF0YSk7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUNoaWxkKGNsYXNzSGludCwgZGF0YU9yUmVmLCBjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgaXNSZWZPYmplY3QgPSBkYXRhT3JSZWYucmVmSW5kZXggJiYgZGF0YU9yUmVmLnJlZlR5cGU7XG4gICAgICAgICAgICBpZiAoIWlzUmVmT2JqZWN0KSB7XG4gICAgICAgICAgICAgIHJldHVybiBkZXNlcmlhbGl6ZVdpdGhIb29rcyhjbGFzc0hpbnQsIGRhdGFPclJlZiwgY29udGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVmID0gZGF0YU9yUmVmO1xuICAgICAgICAgICAgaWYgKERFU0VSSUFMSVpFX0JZX1JFRl9UWVBFW3JlZi5yZWZUeXBlXSkge1xuICAgICAgICAgICAgICBjbGFzc0hpbnQgPSBERVNFUklBTElaRV9CWV9SRUZfVFlQRVtyZWYucmVmVHlwZV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVmSW5kZXggPSByZWYucmVmSW5kZXg7XG4gICAgICAgICAgICBpZiAoIWRlc2VyaWFsaXplZFJlZk1lbW9CeUluZGV4W3JlZkluZGV4XSkge1xuICAgICAgICAgICAgICB2YXIgZGF0YSA9IGpzb25bcmVmSW5kZXhdO1xuICAgICAgICAgICAgICB2YXIgb2JqID0gZGVzZXJpYWxpemVXaXRoSG9va3MoY2xhc3NIaW50LCBkYXRhLCBjb250ZXh0KTtcbiAgICAgICAgICAgICAgZGVzZXJpYWxpemVkUmVmTWVtb0J5SW5kZXhbcmVmSW5kZXhdID0gb2JqO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGRlc2VyaWFsaXplZFJlZk1lbW9CeUluZGV4W3JlZkluZGV4XTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHJvb3QgPSBkZXNlcmlhbGl6ZVdpdGhIb29rcyhyb290Q2xhc3MsIGpzb25bMF0sIG51bGwpO1xuICAgICAgICAgIHJldHVybiByb290O1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgREVGQVVMVF9PUFRJT05TKSwgb3B0aW9uczIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFNlcmlhbGl6ZXIyO1xuICAgIH0oKVxuICApO1xuICB2YXIgd29ybGRTZXJpYWxpemVyID0gbmV3IFNlcmlhbGl6ZXIoe1xuICAgIHJvb3RDbGFzczogV29ybGRcbiAgfSk7XG4gIFNlcmlhbGl6ZXIuZnJvbUpzb24gPSB3b3JsZFNlcmlhbGl6ZXIuZnJvbUpzb247XG4gIFNlcmlhbGl6ZXIudG9Kc29uID0gd29ybGRTZXJpYWxpemVyLnRvSnNvbjtcbiAgdmFyIFRlc3RiZWQgPSAoXG4gICAgLyoqIEBjbGFzcyAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVGVzdGJlZDIoKSB7XG4gICAgICB9XG4gICAgICBUZXN0YmVkMi5tb3VudCA9IGZ1bmN0aW9uKG9wdGlvbnMyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRlZFwiKTtcbiAgICAgIH07XG4gICAgICBUZXN0YmVkMi5zdGFydCA9IGZ1bmN0aW9uKHdvcmxkKSB7XG4gICAgICAgIHZhciB0ZXN0YmVkMiA9IFRlc3RiZWQyLm1vdW50KCk7XG4gICAgICAgIHRlc3RiZWQyLnN0YXJ0KHdvcmxkKTtcbiAgICAgICAgcmV0dXJuIHRlc3RiZWQyO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBUZXN0YmVkMjtcbiAgICB9KClcbiAgKTtcbiAgZnVuY3Rpb24gdGVzdGJlZChhMiwgYjIpIHtcbiAgICB2YXIgY2FsbGJhY2s7XG4gICAgdmFyIG9wdGlvbnMyO1xuICAgIGlmICh0eXBlb2YgYTIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY2FsbGJhY2sgPSBhMjtcbiAgICAgIG9wdGlvbnMyID0gYjI7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYjIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY2FsbGJhY2sgPSBiMjtcbiAgICAgIG9wdGlvbnMyID0gYTI7XG4gICAgfSBlbHNlIHtcbiAgICAgIG9wdGlvbnMyID0gYTIgIT09IG51bGwgJiYgYTIgIT09IHZvaWQgMCA/IGEyIDogYjI7XG4gICAgfVxuICAgIHZhciB0ZXN0YmVkMiA9IFRlc3RiZWQubW91bnQob3B0aW9uczIpO1xuICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgdmFyIHdvcmxkID0gY2FsbGJhY2sodGVzdGJlZDIpIHx8IHRlc3RiZWQyLndvcmxkO1xuICAgICAgdGVzdGJlZDIuc3RhcnQod29ybGQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGVzdGJlZDI7XG4gICAgfVxuICB9XG4gIHZhciBCb3hTaGFwZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoQm94U2hhcGUyLCBfc3VwZXIpO1xuICAgICAgZnVuY3Rpb24gQm94U2hhcGUyKGhhbGZXaWR0aCwgaGFsZkhlaWdodCwgY2VudGVyMiwgYW5nbGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEoX3RoaXMgaW5zdGFuY2VvZiBCb3hTaGFwZTIpKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBCb3hTaGFwZTIoaGFsZldpZHRoLCBoYWxmSGVpZ2h0LCBjZW50ZXIyLCBhbmdsZSk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fc2V0QXNCb3goaGFsZldpZHRoLCBoYWxmSGVpZ2h0LCBjZW50ZXIyLCBhbmdsZSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgIH1cbiAgICAgIEJveFNoYXBlMi5UWVBFID0gXCJwb2x5Z29uXCI7XG4gICAgICByZXR1cm4gQm94U2hhcGUyO1xuICAgIH0oUG9seWdvblNoYXBlKVxuICApO1xuICBDb250YWN0LmFkZFR5cGUoQ2lyY2xlU2hhcGUuVFlQRSwgQ2lyY2xlU2hhcGUuVFlQRSwgQ2lyY2xlQ2lyY2xlQ29udGFjdCk7XG4gIGZ1bmN0aW9uIENpcmNsZUNpcmNsZUNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZpeHR1cmVBLCBpbmRleEEsIHhmQjIsIGZpeHR1cmVCLCBpbmRleEIpIHtcbiAgICBDb2xsaWRlQ2lyY2xlcyhtYW5pZm9sZCwgZml4dHVyZUEuZ2V0U2hhcGUoKSwgeGZBMiwgZml4dHVyZUIuZ2V0U2hhcGUoKSwgeGZCMik7XG4gIH1cbiAgdmFyIHBBID0gdmVjMigwLCAwKTtcbiAgdmFyIHBCID0gdmVjMigwLCAwKTtcbiAgdmFyIENvbGxpZGVDaXJjbGVzID0gZnVuY3Rpb24obWFuaWZvbGQsIGNpcmNsZUEsIHhmQTIsIGNpcmNsZUIsIHhmQjIpIHtcbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMDtcbiAgICB0cmFuc2Zvcm1WZWMyKHBBLCB4ZkEyLCBjaXJjbGVBLm1fcCk7XG4gICAgdHJhbnNmb3JtVmVjMihwQiwgeGZCMiwgY2lyY2xlQi5tX3ApO1xuICAgIHZhciBkaXN0U3FyID0gZGlzdFNxclZlYzIocEIsIHBBKTtcbiAgICB2YXIgckEyID0gY2lyY2xlQS5tX3JhZGl1cztcbiAgICB2YXIgckIyID0gY2lyY2xlQi5tX3JhZGl1cztcbiAgICB2YXIgcmFkaXVzID0gckEyICsgckIyO1xuICAgIGlmIChkaXN0U3FyID4gcmFkaXVzICogcmFkaXVzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9jaXJjbGVzO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIGNpcmNsZUEubV9wKTtcbiAgICB6ZXJvVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCk7XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDE7XG4gICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICBtYW5pZm9sZC5wb2ludHNbMF0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCAwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICB9O1xuICBDb250YWN0LmFkZFR5cGUoRWRnZVNoYXBlLlRZUEUsIENpcmNsZVNoYXBlLlRZUEUsIEVkZ2VDaXJjbGVDb250YWN0KTtcbiAgQ29udGFjdC5hZGRUeXBlKENoYWluU2hhcGUuVFlQRSwgQ2lyY2xlU2hhcGUuVFlQRSwgQ2hhaW5DaXJjbGVDb250YWN0KTtcbiAgZnVuY3Rpb24gRWRnZUNpcmNsZUNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZpeHR1cmVBLCBpbmRleEEsIHhmQjIsIGZpeHR1cmVCLCBpbmRleEIpIHtcbiAgICB2YXIgc2hhcGVBID0gZml4dHVyZUEuZ2V0U2hhcGUoKTtcbiAgICB2YXIgc2hhcGVCID0gZml4dHVyZUIuZ2V0U2hhcGUoKTtcbiAgICBDb2xsaWRlRWRnZUNpcmNsZShtYW5pZm9sZCwgc2hhcGVBLCB4ZkEyLCBzaGFwZUIsIHhmQjIpO1xuICB9XG4gIGZ1bmN0aW9uIENoYWluQ2lyY2xlQ29udGFjdChtYW5pZm9sZCwgeGZBMiwgZml4dHVyZUEsIGluZGV4QSwgeGZCMiwgZml4dHVyZUIsIGluZGV4Qikge1xuICAgIHZhciBjaGFpbiA9IGZpeHR1cmVBLmdldFNoYXBlKCk7XG4gICAgdmFyIGVkZ2UgPSBuZXcgRWRnZVNoYXBlKCk7XG4gICAgY2hhaW4uZ2V0Q2hpbGRFZGdlKGVkZ2UsIGluZGV4QSk7XG4gICAgdmFyIHNoYXBlQSA9IGVkZ2U7XG4gICAgdmFyIHNoYXBlQiA9IGZpeHR1cmVCLmdldFNoYXBlKCk7XG4gICAgQ29sbGlkZUVkZ2VDaXJjbGUobWFuaWZvbGQsIHNoYXBlQSwgeGZBMiwgc2hhcGVCLCB4ZkIyKTtcbiAgfVxuICB2YXIgZSA9IHZlYzIoMCwgMCk7XG4gIHZhciBlMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBlMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBRID0gdmVjMigwLCAwKTtcbiAgdmFyIFAgPSB2ZWMyKDAsIDApO1xuICB2YXIgbiQyID0gdmVjMigwLCAwKTtcbiAgdmFyIENvbGxpZGVFZGdlQ2lyY2xlID0gZnVuY3Rpb24obWFuaWZvbGQsIGVkZ2VBLCB4ZkEyLCBjaXJjbGVCLCB4ZkIyKSB7XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDA7XG4gICAgcmV0cmFuc2Zvcm1WZWMyKFEsIHhmQjIsIHhmQTIsIGNpcmNsZUIubV9wKTtcbiAgICB2YXIgQSA9IGVkZ2VBLm1fdmVydGV4MTtcbiAgICB2YXIgQiA9IGVkZ2VBLm1fdmVydGV4MjtcbiAgICBzdWJWZWMyKGUsIEIsIEEpO1xuICAgIHZhciB1ID0gZG90VmVjMihlLCBCKSAtIGRvdFZlYzIoZSwgUSk7XG4gICAgdmFyIHYzID0gZG90VmVjMihlLCBRKSAtIGRvdFZlYzIoZSwgQSk7XG4gICAgdmFyIHJhZGl1cyA9IGVkZ2VBLm1fcmFkaXVzICsgY2lyY2xlQi5tX3JhZGl1cztcbiAgICBpZiAodjMgPD0gMCkge1xuICAgICAgY29weVZlYzIoUCwgQSk7XG4gICAgICB2YXIgZGRfMSA9IGRpc3RTcXJWZWMyKFEsIEEpO1xuICAgICAgaWYgKGRkXzEgPiByYWRpdXMgKiByYWRpdXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGVkZ2VBLm1faGFzVmVydGV4MCkge1xuICAgICAgICB2YXIgQTEgPSBlZGdlQS5tX3ZlcnRleDA7XG4gICAgICAgIHZhciBCMSA9IEE7XG4gICAgICAgIHN1YlZlYzIoZTEsIEIxLCBBMSk7XG4gICAgICAgIHZhciB1MSA9IGRvdFZlYzIoZTEsIEIxKSAtIGRvdFZlYzIoZTEsIFEpO1xuICAgICAgICBpZiAodTEgPiAwKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfY2lyY2xlcztcbiAgICAgIHplcm9WZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIFApO1xuICAgICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDE7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5wb2ludHNbMF0ubG9jYWxQb2ludCwgY2lyY2xlQi5tX3ApO1xuICAgICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHUgPD0gMCkge1xuICAgICAgY29weVZlYzIoUCwgQik7XG4gICAgICB2YXIgZGRfMiA9IGRpc3RTcXJWZWMyKFEsIFApO1xuICAgICAgaWYgKGRkXzIgPiByYWRpdXMgKiByYWRpdXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGVkZ2VBLm1faGFzVmVydGV4Mykge1xuICAgICAgICB2YXIgQjIgPSBlZGdlQS5tX3ZlcnRleDM7XG4gICAgICAgIHZhciBBMiA9IEI7XG4gICAgICAgIHN1YlZlYzIoZTIsIEIyLCBBMik7XG4gICAgICAgIHZhciB2MjIgPSBkb3RWZWMyKGUyLCBRKSAtIGRvdFZlYzIoZTIsIEEyKTtcbiAgICAgICAgaWYgKHYyMiA+IDApIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIG1hbmlmb2xkLnR5cGUgPSBleHBvcnRzMi5NYW5pZm9sZFR5cGUuZV9jaXJjbGVzO1xuICAgICAgemVyb1ZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgUCk7XG4gICAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLnBvaW50c1swXS5sb2NhbFBvaW50LCBjaXJjbGVCLm1fcCk7XG4gICAgICBtYW5pZm9sZC5wb2ludHNbMF0uaWQuc2V0RmVhdHVyZXMoMSwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4LCAwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgZGVuID0gbGVuZ3RoU3FyVmVjMihlKTtcbiAgICBjb21iaW5lMlZlYzIoUCwgdSAvIGRlbiwgQSwgdjMgLyBkZW4sIEIpO1xuICAgIHZhciBkZCA9IGRpc3RTcXJWZWMyKFEsIFApO1xuICAgIGlmIChkZCA+IHJhZGl1cyAqIHJhZGl1cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjcm9zc051bVZlYzIobiQyLCAxLCBlKTtcbiAgICBpZiAoZG90VmVjMihuJDIsIFEpIC0gZG90VmVjMihuJDIsIEEpIDwgMCkge1xuICAgICAgbmVnVmVjMihuJDIpO1xuICAgIH1cbiAgICBub3JtYWxpemVWZWMyKG4kMik7XG4gICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsTm9ybWFsLCBuJDIpO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIEEpO1xuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLnBvaW50c1swXS5sb2NhbFBvaW50LCBjaXJjbGVCLm1fcCk7XG4gICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gIH07XG4gIHZhciBpbmNpZGVudEVkZ2UgPSBbbmV3IENsaXBWZXJ0ZXgoKSwgbmV3IENsaXBWZXJ0ZXgoKV07XG4gIHZhciBjbGlwUG9pbnRzMSQxID0gW25ldyBDbGlwVmVydGV4KCksIG5ldyBDbGlwVmVydGV4KCldO1xuICB2YXIgY2xpcFBvaW50czIkMSA9IFtuZXcgQ2xpcFZlcnRleCgpLCBuZXcgQ2xpcFZlcnRleCgpXTtcbiAgdmFyIGNsaXBTZWdtZW50VG9MaW5lTm9ybWFsID0gdmVjMigwLCAwKTtcbiAgdmFyIHYxID0gdmVjMigwLCAwKTtcbiAgdmFyIG4kMSA9IHZlYzIoMCwgMCk7XG4gIHZhciB4ZiQxID0gdHJhbnNmb3JtKDAsIDAsIDApO1xuICB2YXIgdjExID0gdmVjMigwLCAwKTtcbiAgdmFyIHYxMiA9IHZlYzIoMCwgMCk7XG4gIHZhciBsb2NhbFRhbmdlbnQgPSB2ZWMyKDAsIDApO1xuICB2YXIgbG9jYWxOb3JtYWwgPSB2ZWMyKDAsIDApO1xuICB2YXIgcGxhbmVQb2ludCA9IHZlYzIoMCwgMCk7XG4gIHZhciB0YW5nZW50ID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbCQxID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbDEkMSA9IHZlYzIoMCwgMCk7XG4gIENvbnRhY3QuYWRkVHlwZShQb2x5Z29uU2hhcGUuVFlQRSwgUG9seWdvblNoYXBlLlRZUEUsIFBvbHlnb25Db250YWN0KTtcbiAgZnVuY3Rpb24gUG9seWdvbkNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZpeHR1cmVBLCBpbmRleEEsIHhmQjIsIGZpeHR1cmVCLCBpbmRleEIpIHtcbiAgICBDb2xsaWRlUG9seWdvbnMobWFuaWZvbGQsIGZpeHR1cmVBLmdldFNoYXBlKCksIHhmQTIsIGZpeHR1cmVCLmdldFNoYXBlKCksIHhmQjIpO1xuICB9XG4gIGZ1bmN0aW9uIGZpbmRNYXhTZXBhcmF0aW9uKHBvbHkxLCB4ZjEsIHBvbHkyLCB4ZjIsIG91dHB1dDIpIHtcbiAgICB2YXIgY291bnQxID0gcG9seTEubV9jb3VudDtcbiAgICB2YXIgY291bnQyID0gcG9seTIubV9jb3VudDtcbiAgICB2YXIgbjFzID0gcG9seTEubV9ub3JtYWxzO1xuICAgIHZhciB2MXMgPSBwb2x5MS5tX3ZlcnRpY2VzO1xuICAgIHZhciB2MnMgPSBwb2x5Mi5tX3ZlcnRpY2VzO1xuICAgIGRldHJhbnNmb3JtVHJhbnNmb3JtKHhmJDEsIHhmMiwgeGYxKTtcbiAgICB2YXIgYmVzdEluZGV4ID0gMDtcbiAgICB2YXIgbWF4U2VwYXJhdGlvbjIgPSAtSW5maW5pdHk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDE7ICsraSkge1xuICAgICAgcm90VmVjMihuJDEsIHhmJDEucSwgbjFzW2ldKTtcbiAgICAgIHRyYW5zZm9ybVZlYzIodjEsIHhmJDEsIHYxc1tpXSk7XG4gICAgICB2YXIgc2kgPSBJbmZpbml0eTtcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY291bnQyOyArK2opIHtcbiAgICAgICAgdmFyIHNpaiA9IGRvdFZlYzIobiQxLCB2MnNbal0pIC0gZG90VmVjMihuJDEsIHYxKTtcbiAgICAgICAgaWYgKHNpaiA8IHNpKSB7XG4gICAgICAgICAgc2kgPSBzaWo7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChzaSA+IG1heFNlcGFyYXRpb24yKSB7XG4gICAgICAgIG1heFNlcGFyYXRpb24yID0gc2k7XG4gICAgICAgIGJlc3RJbmRleCA9IGk7XG4gICAgICB9XG4gICAgfVxuICAgIG91dHB1dDIubWF4U2VwYXJhdGlvbiA9IG1heFNlcGFyYXRpb24yO1xuICAgIG91dHB1dDIuYmVzdEluZGV4ID0gYmVzdEluZGV4O1xuICB9XG4gIGZ1bmN0aW9uIGZpbmRJbmNpZGVudEVkZ2UoY2xpcFZlcnRleCwgcG9seTEsIHhmMSwgZWRnZTEyLCBwb2x5MiwgeGYyKSB7XG4gICAgdmFyIG5vcm1hbHMxID0gcG9seTEubV9ub3JtYWxzO1xuICAgIHZhciBjb3VudDIgPSBwb2x5Mi5tX2NvdW50O1xuICAgIHZhciB2ZXJ0aWNlczIgPSBwb2x5Mi5tX3ZlcnRpY2VzO1xuICAgIHZhciBub3JtYWxzMiA9IHBvbHkyLm1fbm9ybWFscztcbiAgICByZXJvdFZlYzIobm9ybWFsMSQxLCB4ZjIucSwgeGYxLnEsIG5vcm1hbHMxW2VkZ2UxMl0pO1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgdmFyIG1pbkRvdCA9IEluZmluaXR5O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQyOyArK2kpIHtcbiAgICAgIHZhciBkb3QgPSBkb3RWZWMyKG5vcm1hbDEkMSwgbm9ybWFsczJbaV0pO1xuICAgICAgaWYgKGRvdCA8IG1pbkRvdCkge1xuICAgICAgICBtaW5Eb3QgPSBkb3Q7XG4gICAgICAgIGluZGV4ID0gaTtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIGkxID0gaW5kZXg7XG4gICAgdmFyIGkyID0gaTEgKyAxIDwgY291bnQyID8gaTEgKyAxIDogMDtcbiAgICB0cmFuc2Zvcm1WZWMyKGNsaXBWZXJ0ZXhbMF0udiwgeGYyLCB2ZXJ0aWNlczJbaTFdKTtcbiAgICBjbGlwVmVydGV4WzBdLmlkLnNldEZlYXR1cmVzKGVkZ2UxMiwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfZmFjZSwgaTEsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgdHJhbnNmb3JtVmVjMihjbGlwVmVydGV4WzFdLnYsIHhmMiwgdmVydGljZXMyW2kyXSk7XG4gICAgY2xpcFZlcnRleFsxXS5pZC5zZXRGZWF0dXJlcyhlZGdlMTIsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UsIGkyLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgpO1xuICB9XG4gIHZhciBtYXhTZXBhcmF0aW9uID0ge1xuICAgIG1heFNlcGFyYXRpb246IDAsXG4gICAgYmVzdEluZGV4OiAwXG4gIH07XG4gIHZhciBDb2xsaWRlUG9seWdvbnMgPSBmdW5jdGlvbihtYW5pZm9sZCwgcG9seUEsIHhmQTIsIHBvbHlCLCB4ZkIyKSB7XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IDA7XG4gICAgdmFyIHRvdGFsUmFkaXVzID0gcG9seUEubV9yYWRpdXMgKyBwb2x5Qi5tX3JhZGl1cztcbiAgICBmaW5kTWF4U2VwYXJhdGlvbihwb2x5QSwgeGZBMiwgcG9seUIsIHhmQjIsIG1heFNlcGFyYXRpb24pO1xuICAgIHZhciBlZGdlQSA9IG1heFNlcGFyYXRpb24uYmVzdEluZGV4O1xuICAgIHZhciBzZXBhcmF0aW9uQSA9IG1heFNlcGFyYXRpb24ubWF4U2VwYXJhdGlvbjtcbiAgICBpZiAoc2VwYXJhdGlvbkEgPiB0b3RhbFJhZGl1cylcbiAgICAgIHJldHVybjtcbiAgICBmaW5kTWF4U2VwYXJhdGlvbihwb2x5QiwgeGZCMiwgcG9seUEsIHhmQTIsIG1heFNlcGFyYXRpb24pO1xuICAgIHZhciBlZGdlQiA9IG1heFNlcGFyYXRpb24uYmVzdEluZGV4O1xuICAgIHZhciBzZXBhcmF0aW9uQiA9IG1heFNlcGFyYXRpb24ubWF4U2VwYXJhdGlvbjtcbiAgICBpZiAoc2VwYXJhdGlvbkIgPiB0b3RhbFJhZGl1cylcbiAgICAgIHJldHVybjtcbiAgICB2YXIgcG9seTE7XG4gICAgdmFyIHBvbHkyO1xuICAgIHZhciB4ZjE7XG4gICAgdmFyIHhmMjtcbiAgICB2YXIgZWRnZTEyO1xuICAgIHZhciBmbGlwO1xuICAgIHZhciBrX3RvbCA9IDAuMSAqIFNldHRpbmdzSW50ZXJuYWwubGluZWFyU2xvcDtcbiAgICBpZiAoc2VwYXJhdGlvbkIgPiBzZXBhcmF0aW9uQSArIGtfdG9sKSB7XG4gICAgICBwb2x5MSA9IHBvbHlCO1xuICAgICAgcG9seTIgPSBwb2x5QTtcbiAgICAgIHhmMSA9IHhmQjI7XG4gICAgICB4ZjIgPSB4ZkEyO1xuICAgICAgZWRnZTEyID0gZWRnZUI7XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUI7XG4gICAgICBmbGlwID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcG9seTEgPSBwb2x5QTtcbiAgICAgIHBvbHkyID0gcG9seUI7XG4gICAgICB4ZjEgPSB4ZkEyO1xuICAgICAgeGYyID0geGZCMjtcbiAgICAgIGVkZ2UxMiA9IGVkZ2VBO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgZmxpcCA9IGZhbHNlO1xuICAgIH1cbiAgICBpbmNpZGVudEVkZ2VbMF0ucmVjeWNsZSgpO1xuICAgIGluY2lkZW50RWRnZVsxXS5yZWN5Y2xlKCk7XG4gICAgZmluZEluY2lkZW50RWRnZShpbmNpZGVudEVkZ2UsIHBvbHkxLCB4ZjEsIGVkZ2UxMiwgcG9seTIsIHhmMik7XG4gICAgdmFyIGNvdW50MSA9IHBvbHkxLm1fY291bnQ7XG4gICAgdmFyIHZlcnRpY2VzMSA9IHBvbHkxLm1fdmVydGljZXM7XG4gICAgdmFyIGl2MSA9IGVkZ2UxMjtcbiAgICB2YXIgaXYyID0gZWRnZTEyICsgMSA8IGNvdW50MSA/IGVkZ2UxMiArIDEgOiAwO1xuICAgIGNvcHlWZWMyKHYxMSwgdmVydGljZXMxW2l2MV0pO1xuICAgIGNvcHlWZWMyKHYxMiwgdmVydGljZXMxW2l2Ml0pO1xuICAgIHN1YlZlYzIobG9jYWxUYW5nZW50LCB2MTIsIHYxMSk7XG4gICAgbm9ybWFsaXplVmVjMihsb2NhbFRhbmdlbnQpO1xuICAgIGNyb3NzVmVjMk51bShsb2NhbE5vcm1hbCwgbG9jYWxUYW5nZW50LCAxKTtcbiAgICBjb21iaW5lMlZlYzIocGxhbmVQb2ludCwgMC41LCB2MTEsIDAuNSwgdjEyKTtcbiAgICByb3RWZWMyKHRhbmdlbnQsIHhmMS5xLCBsb2NhbFRhbmdlbnQpO1xuICAgIGNyb3NzVmVjMk51bShub3JtYWwkMSwgdGFuZ2VudCwgMSk7XG4gICAgdHJhbnNmb3JtVmVjMih2MTEsIHhmMSwgdjExKTtcbiAgICB0cmFuc2Zvcm1WZWMyKHYxMiwgeGYxLCB2MTIpO1xuICAgIHZhciBmcm9udE9mZnNldCA9IGRvdFZlYzIobm9ybWFsJDEsIHYxMSk7XG4gICAgdmFyIHNpZGVPZmZzZXQxID0gLWRvdFZlYzIodGFuZ2VudCwgdjExKSArIHRvdGFsUmFkaXVzO1xuICAgIHZhciBzaWRlT2Zmc2V0MiA9IGRvdFZlYzIodGFuZ2VudCwgdjEyKSArIHRvdGFsUmFkaXVzO1xuICAgIGNsaXBQb2ludHMxJDFbMF0ucmVjeWNsZSgpO1xuICAgIGNsaXBQb2ludHMxJDFbMV0ucmVjeWNsZSgpO1xuICAgIGNsaXBQb2ludHMyJDFbMF0ucmVjeWNsZSgpO1xuICAgIGNsaXBQb2ludHMyJDFbMV0ucmVjeWNsZSgpO1xuICAgIHNldFZlYzIoY2xpcFNlZ21lbnRUb0xpbmVOb3JtYWwsIC10YW5nZW50LngsIC10YW5nZW50LnkpO1xuICAgIHZhciBucDEgPSBjbGlwU2VnbWVudFRvTGluZShjbGlwUG9pbnRzMSQxLCBpbmNpZGVudEVkZ2UsIGNsaXBTZWdtZW50VG9MaW5lTm9ybWFsLCBzaWRlT2Zmc2V0MSwgaXYxKTtcbiAgICBpZiAobnAxIDwgMikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzZXRWZWMyKGNsaXBTZWdtZW50VG9MaW5lTm9ybWFsLCB0YW5nZW50LngsIHRhbmdlbnQueSk7XG4gICAgdmFyIG5wMiA9IGNsaXBTZWdtZW50VG9MaW5lKGNsaXBQb2ludHMyJDEsIGNsaXBQb2ludHMxJDEsIGNsaXBTZWdtZW50VG9MaW5lTm9ybWFsLCBzaWRlT2Zmc2V0MiwgaXYyKTtcbiAgICBpZiAobnAyIDwgMikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgbG9jYWxOb3JtYWwpO1xuICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIHBsYW5lUG9pbnQpO1xuICAgIHZhciBwb2ludENvdW50ID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNsaXBQb2ludHMyJDEubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciBzZXBhcmF0aW9uID0gZG90VmVjMihub3JtYWwkMSwgY2xpcFBvaW50czIkMVtpXS52KSAtIGZyb250T2Zmc2V0O1xuICAgICAgaWYgKHNlcGFyYXRpb24gPD0gdG90YWxSYWRpdXMpIHtcbiAgICAgICAgdmFyIGNwID0gbWFuaWZvbGQucG9pbnRzW3BvaW50Q291bnRdO1xuICAgICAgICBkZXRyYW5zZm9ybVZlYzIoY3AubG9jYWxQb2ludCwgeGYyLCBjbGlwUG9pbnRzMiQxW2ldLnYpO1xuICAgICAgICBjcC5pZC5zZXQoY2xpcFBvaW50czIkMVtpXS5pZCk7XG4gICAgICAgIGlmIChmbGlwKSB7XG4gICAgICAgICAgY3AuaWQuc3dhcEZlYXR1cmVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgKytwb2ludENvdW50O1xuICAgICAgfVxuICAgIH1cbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gcG9pbnRDb3VudDtcbiAgfTtcbiAgQ29udGFjdC5hZGRUeXBlKFBvbHlnb25TaGFwZS5UWVBFLCBDaXJjbGVTaGFwZS5UWVBFLCBQb2x5Z29uQ2lyY2xlQ29udGFjdCk7XG4gIGZ1bmN0aW9uIFBvbHlnb25DaXJjbGVDb250YWN0KG1hbmlmb2xkLCB4ZkEyLCBmaXh0dXJlQSwgaW5kZXhBLCB4ZkIyLCBmaXh0dXJlQiwgaW5kZXhCKSB7XG4gICAgQ29sbGlkZVBvbHlnb25DaXJjbGUobWFuaWZvbGQsIGZpeHR1cmVBLmdldFNoYXBlKCksIHhmQTIsIGZpeHR1cmVCLmdldFNoYXBlKCksIHhmQjIpO1xuICB9XG4gIHZhciBjTG9jYWwgPSB2ZWMyKDAsIDApO1xuICB2YXIgZmFjZUNlbnRlciA9IHZlYzIoMCwgMCk7XG4gIHZhciBDb2xsaWRlUG9seWdvbkNpcmNsZSA9IGZ1bmN0aW9uKG1hbmlmb2xkLCBwb2x5Z29uQSwgeGZBMiwgY2lyY2xlQiwgeGZCMikge1xuICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAwO1xuICAgIHJldHJhbnNmb3JtVmVjMihjTG9jYWwsIHhmQjIsIHhmQTIsIGNpcmNsZUIubV9wKTtcbiAgICB2YXIgbm9ybWFsSW5kZXggPSAwO1xuICAgIHZhciBzZXBhcmF0aW9uID0gLUluZmluaXR5O1xuICAgIHZhciByYWRpdXMgPSBwb2x5Z29uQS5tX3JhZGl1cyArIGNpcmNsZUIubV9yYWRpdXM7XG4gICAgdmFyIHZlcnRleENvdW50ID0gcG9seWdvbkEubV9jb3VudDtcbiAgICB2YXIgdmVydGljZXMgPSBwb2x5Z29uQS5tX3ZlcnRpY2VzO1xuICAgIHZhciBub3JtYWxzID0gcG9seWdvbkEubV9ub3JtYWxzO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGV4Q291bnQ7ICsraSkge1xuICAgICAgdmFyIHMyID0gZG90VmVjMihub3JtYWxzW2ldLCBjTG9jYWwpIC0gZG90VmVjMihub3JtYWxzW2ldLCB2ZXJ0aWNlc1tpXSk7XG4gICAgICBpZiAoczIgPiByYWRpdXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHMyID4gc2VwYXJhdGlvbikge1xuICAgICAgICBzZXBhcmF0aW9uID0gczI7XG4gICAgICAgIG5vcm1hbEluZGV4ID0gaTtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIHZlcnRJbmRleDEgPSBub3JtYWxJbmRleDtcbiAgICB2YXIgdmVydEluZGV4MiA9IHZlcnRJbmRleDEgKyAxIDwgdmVydGV4Q291bnQgPyB2ZXJ0SW5kZXgxICsgMSA6IDA7XG4gICAgdmFyIHYxMyA9IHZlcnRpY2VzW3ZlcnRJbmRleDFdO1xuICAgIHZhciB2MjIgPSB2ZXJ0aWNlc1t2ZXJ0SW5kZXgyXTtcbiAgICBpZiAoc2VwYXJhdGlvbiA8IEVQU0lMT04pIHtcbiAgICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIG5vcm1hbHNbbm9ybWFsSW5kZXhdKTtcbiAgICAgIGNvbWJpbmUyVmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCAwLjUsIHYxMywgMC41LCB2MjIpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB1MSA9IGRvdFZlYzIoY0xvY2FsLCB2MjIpIC0gZG90VmVjMihjTG9jYWwsIHYxMykgLSBkb3RWZWMyKHYxMywgdjIyKSArIGRvdFZlYzIodjEzLCB2MTMpO1xuICAgIHZhciB1MiA9IGRvdFZlYzIoY0xvY2FsLCB2MTMpIC0gZG90VmVjMihjTG9jYWwsIHYyMikgLSBkb3RWZWMyKHYyMiwgdjEzKSArIGRvdFZlYzIodjIyLCB2MjIpO1xuICAgIGlmICh1MSA8PSAwKSB7XG4gICAgICBpZiAoZGlzdFNxclZlYzIoY0xvY2FsLCB2MTMpID4gcmFkaXVzICogcmFkaXVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgc3ViVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgY0xvY2FsLCB2MTMpO1xuICAgICAgbm9ybWFsaXplVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCk7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCB2MTMpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgfSBlbHNlIGlmICh1MiA8PSAwKSB7XG4gICAgICBpZiAoZGlzdFNxclZlYzIoY0xvY2FsLCB2MjIpID4gcmFkaXVzICogcmFkaXVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgc3ViVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgY0xvY2FsLCB2MjIpO1xuICAgICAgbm9ybWFsaXplVmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCk7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbFBvaW50LCB2MjIpO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQucG9pbnRzWzBdLmxvY2FsUG9pbnQsIGNpcmNsZUIubV9wKTtcbiAgICAgIG1hbmlmb2xkLnBvaW50c1swXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV92ZXJ0ZXgsIDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbWJpbmUyVmVjMihmYWNlQ2VudGVyLCAwLjUsIHYxMywgMC41LCB2MjIpO1xuICAgICAgdmFyIHNlcGFyYXRpb25fMSA9IGRvdFZlYzIoY0xvY2FsLCBub3JtYWxzW3ZlcnRJbmRleDFdKSAtIGRvdFZlYzIoZmFjZUNlbnRlciwgbm9ybWFsc1t2ZXJ0SW5kZXgxXSk7XG4gICAgICBpZiAoc2VwYXJhdGlvbl8xID4gcmFkaXVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIG1hbmlmb2xkLnBvaW50Q291bnQgPSAxO1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VBO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIG5vcm1hbHNbdmVydEluZGV4MV0pO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgZmFjZUNlbnRlcik7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5wb2ludHNbMF0ubG9jYWxQb2ludCwgY2lyY2xlQi5tX3ApO1xuICAgICAgbWFuaWZvbGQucG9pbnRzWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICB9XG4gIH07XG4gIHZhciBtYXRoX21pbiA9IE1hdGgubWluO1xuICBDb250YWN0LmFkZFR5cGUoRWRnZVNoYXBlLlRZUEUsIFBvbHlnb25TaGFwZS5UWVBFLCBFZGdlUG9seWdvbkNvbnRhY3QpO1xuICBDb250YWN0LmFkZFR5cGUoQ2hhaW5TaGFwZS5UWVBFLCBQb2x5Z29uU2hhcGUuVFlQRSwgQ2hhaW5Qb2x5Z29uQ29udGFjdCk7XG4gIGZ1bmN0aW9uIEVkZ2VQb2x5Z29uQ29udGFjdChtYW5pZm9sZCwgeGZBMiwgZkEsIGluZGV4QSwgeGZCMiwgZkIsIGluZGV4Qikge1xuICAgIENvbGxpZGVFZGdlUG9seWdvbihtYW5pZm9sZCwgZkEuZ2V0U2hhcGUoKSwgeGZBMiwgZkIuZ2V0U2hhcGUoKSwgeGZCMik7XG4gIH1cbiAgdmFyIGVkZ2VfcmV1c2UgPSBuZXcgRWRnZVNoYXBlKCk7XG4gIGZ1bmN0aW9uIENoYWluUG9seWdvbkNvbnRhY3QobWFuaWZvbGQsIHhmQTIsIGZBLCBpbmRleEEsIHhmQjIsIGZCLCBpbmRleEIpIHtcbiAgICB2YXIgY2hhaW4gPSBmQS5nZXRTaGFwZSgpO1xuICAgIGNoYWluLmdldENoaWxkRWRnZShlZGdlX3JldXNlLCBpbmRleEEpO1xuICAgIENvbGxpZGVFZGdlUG9seWdvbihtYW5pZm9sZCwgZWRnZV9yZXVzZSwgeGZBMiwgZkIuZ2V0U2hhcGUoKSwgeGZCMik7XG4gIH1cbiAgdmFyIEVQQXhpc1R5cGU7XG4gIChmdW5jdGlvbihFUEF4aXNUeXBlMikge1xuICAgIEVQQXhpc1R5cGUyW0VQQXhpc1R5cGUyW1wiZV91bmtub3duXCJdID0gLTFdID0gXCJlX3Vua25vd25cIjtcbiAgICBFUEF4aXNUeXBlMltFUEF4aXNUeXBlMltcImVfZWRnZUFcIl0gPSAxXSA9IFwiZV9lZGdlQVwiO1xuICAgIEVQQXhpc1R5cGUyW0VQQXhpc1R5cGUyW1wiZV9lZGdlQlwiXSA9IDJdID0gXCJlX2VkZ2VCXCI7XG4gIH0pKEVQQXhpc1R5cGUgfHwgKEVQQXhpc1R5cGUgPSB7fSkpO1xuICB2YXIgVmVydGV4VHlwZTtcbiAgKGZ1bmN0aW9uKFZlcnRleFR5cGUyKSB7XG4gICAgVmVydGV4VHlwZTJbVmVydGV4VHlwZTJbXCJlX2lzb2xhdGVkXCJdID0gMF0gPSBcImVfaXNvbGF0ZWRcIjtcbiAgICBWZXJ0ZXhUeXBlMltWZXJ0ZXhUeXBlMltcImVfY29uY2F2ZVwiXSA9IDFdID0gXCJlX2NvbmNhdmVcIjtcbiAgICBWZXJ0ZXhUeXBlMltWZXJ0ZXhUeXBlMltcImVfY29udmV4XCJdID0gMl0gPSBcImVfY29udmV4XCI7XG4gIH0pKFZlcnRleFR5cGUgfHwgKFZlcnRleFR5cGUgPSB7fSkpO1xuICB2YXIgRVBBeGlzID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICAvKiBAX19QVVJFX18gKi8gZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBFUEF4aXMyKCkge1xuICAgICAgfVxuICAgICAgcmV0dXJuIEVQQXhpczI7XG4gICAgfSgpXG4gICk7XG4gIHZhciBUZW1wUG9seWdvbiA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgLyogQF9fUFVSRV9fICovIGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gVGVtcFBvbHlnb24yKCkge1xuICAgICAgICB0aGlzLnZlcnRpY2VzID0gW107XG4gICAgICAgIHRoaXMubm9ybWFscyA9IFtdO1xuICAgICAgICB0aGlzLmNvdW50ID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBTZXR0aW5nc0ludGVybmFsLm1heFBvbHlnb25WZXJ0aWNlczsgaSsrKSB7XG4gICAgICAgICAgdGhpcy52ZXJ0aWNlcy5wdXNoKHZlYzIoMCwgMCkpO1xuICAgICAgICAgIHRoaXMubm9ybWFscy5wdXNoKHZlYzIoMCwgMCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gVGVtcFBvbHlnb24yO1xuICAgIH0oKVxuICApO1xuICB2YXIgUmVmZXJlbmNlRmFjZSA9IChcbiAgICAvKiogQGNsYXNzICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBSZWZlcmVuY2VGYWNlMigpIHtcbiAgICAgICAgdGhpcy52MSA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMudjIgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLm5vcm1hbCA9IHZlYzIoMCwgMCk7XG4gICAgICAgIHRoaXMuc2lkZU5vcm1hbDEgPSB2ZWMyKDAsIDApO1xuICAgICAgICB0aGlzLnNpZGVOb3JtYWwyID0gdmVjMigwLCAwKTtcbiAgICAgIH1cbiAgICAgIFJlZmVyZW5jZUZhY2UyLnByb3RvdHlwZS5yZWN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHplcm9WZWMyKHRoaXMudjEpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnYyKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5ub3JtYWwpO1xuICAgICAgICB6ZXJvVmVjMih0aGlzLnNpZGVOb3JtYWwxKTtcbiAgICAgICAgemVyb1ZlYzIodGhpcy5zaWRlTm9ybWFsMik7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIFJlZmVyZW5jZUZhY2UyO1xuICAgIH0oKVxuICApO1xuICB2YXIgY2xpcFBvaW50czEgPSBbbmV3IENsaXBWZXJ0ZXgoKSwgbmV3IENsaXBWZXJ0ZXgoKV07XG4gIHZhciBjbGlwUG9pbnRzMiA9IFtuZXcgQ2xpcFZlcnRleCgpLCBuZXcgQ2xpcFZlcnRleCgpXTtcbiAgdmFyIGllID0gW25ldyBDbGlwVmVydGV4KCksIG5ldyBDbGlwVmVydGV4KCldO1xuICB2YXIgZWRnZUF4aXMgPSBuZXcgRVBBeGlzKCk7XG4gIHZhciBwb2x5Z29uQXhpcyA9IG5ldyBFUEF4aXMoKTtcbiAgdmFyIHBvbHlnb25CQSA9IG5ldyBUZW1wUG9seWdvbigpO1xuICB2YXIgcmYgPSBuZXcgUmVmZXJlbmNlRmFjZSgpO1xuICB2YXIgY2VudHJvaWRCID0gdmVjMigwLCAwKTtcbiAgdmFyIGVkZ2UwID0gdmVjMigwLCAwKTtcbiAgdmFyIGVkZ2UxID0gdmVjMigwLCAwKTtcbiAgdmFyIGVkZ2UyID0gdmVjMigwLCAwKTtcbiAgdmFyIHhmID0gdHJhbnNmb3JtKDAsIDAsIDApO1xuICB2YXIgbm9ybWFsID0gdmVjMigwLCAwKTtcbiAgdmFyIG5vcm1hbDAgPSB2ZWMyKDAsIDApO1xuICB2YXIgbm9ybWFsMSA9IHZlYzIoMCwgMCk7XG4gIHZhciBub3JtYWwyID0gdmVjMigwLCAwKTtcbiAgdmFyIGxvd2VyTGltaXQgPSB2ZWMyKDAsIDApO1xuICB2YXIgdXBwZXJMaW1pdCA9IHZlYzIoMCwgMCk7XG4gIHZhciBwZXJwID0gdmVjMigwLCAwKTtcbiAgdmFyIG4gPSB2ZWMyKDAsIDApO1xuICB2YXIgQ29sbGlkZUVkZ2VQb2x5Z29uID0gZnVuY3Rpb24obWFuaWZvbGQsIGVkZ2VBLCB4ZkEyLCBwb2x5Z29uQiwgeGZCMikge1xuICAgIGRldHJhbnNmb3JtVHJhbnNmb3JtKHhmLCB4ZkEyLCB4ZkIyKTtcbiAgICB0cmFuc2Zvcm1WZWMyKGNlbnRyb2lkQiwgeGYsIHBvbHlnb25CLm1fY2VudHJvaWQpO1xuICAgIHZhciB2MCA9IGVkZ2VBLm1fdmVydGV4MDtcbiAgICB2YXIgdjEzID0gZWRnZUEubV92ZXJ0ZXgxO1xuICAgIHZhciB2MjIgPSBlZGdlQS5tX3ZlcnRleDI7XG4gICAgdmFyIHYzID0gZWRnZUEubV92ZXJ0ZXgzO1xuICAgIHZhciBoYXNWZXJ0ZXgwID0gZWRnZUEubV9oYXNWZXJ0ZXgwO1xuICAgIHZhciBoYXNWZXJ0ZXgzID0gZWRnZUEubV9oYXNWZXJ0ZXgzO1xuICAgIHN1YlZlYzIoZWRnZTEsIHYyMiwgdjEzKTtcbiAgICBub3JtYWxpemVWZWMyKGVkZ2UxKTtcbiAgICBzZXRWZWMyKG5vcm1hbDEsIGVkZ2UxLnksIC1lZGdlMS54KTtcbiAgICB2YXIgb2Zmc2V0MSA9IGRvdFZlYzIobm9ybWFsMSwgY2VudHJvaWRCKSAtIGRvdFZlYzIobm9ybWFsMSwgdjEzKTtcbiAgICB2YXIgb2Zmc2V0MCA9IDA7XG4gICAgdmFyIG9mZnNldDIgPSAwO1xuICAgIHZhciBjb252ZXgxID0gZmFsc2U7XG4gICAgdmFyIGNvbnZleDIgPSBmYWxzZTtcbiAgICB6ZXJvVmVjMihub3JtYWwwKTtcbiAgICB6ZXJvVmVjMihub3JtYWwyKTtcbiAgICBpZiAoaGFzVmVydGV4MCkge1xuICAgICAgc3ViVmVjMihlZGdlMCwgdjEzLCB2MCk7XG4gICAgICBub3JtYWxpemVWZWMyKGVkZ2UwKTtcbiAgICAgIHNldFZlYzIobm9ybWFsMCwgZWRnZTAueSwgLWVkZ2UwLngpO1xuICAgICAgY29udmV4MSA9IGNyb3NzVmVjMlZlYzIoZWRnZTAsIGVkZ2UxKSA+PSAwO1xuICAgICAgb2Zmc2V0MCA9IFZlYzIuZG90KG5vcm1hbDAsIGNlbnRyb2lkQikgLSBWZWMyLmRvdChub3JtYWwwLCB2MCk7XG4gICAgfVxuICAgIGlmIChoYXNWZXJ0ZXgzKSB7XG4gICAgICBzdWJWZWMyKGVkZ2UyLCB2MywgdjIyKTtcbiAgICAgIG5vcm1hbGl6ZVZlYzIoZWRnZTIpO1xuICAgICAgc2V0VmVjMihub3JtYWwyLCBlZGdlMi55LCAtZWRnZTIueCk7XG4gICAgICBjb252ZXgyID0gVmVjMi5jcm9zc1ZlYzJWZWMyKGVkZ2UxLCBlZGdlMikgPiAwO1xuICAgICAgb2Zmc2V0MiA9IFZlYzIuZG90KG5vcm1hbDIsIGNlbnRyb2lkQikgLSBWZWMyLmRvdChub3JtYWwyLCB2MjIpO1xuICAgIH1cbiAgICB2YXIgZnJvbnQ7XG4gICAgemVyb1ZlYzIobm9ybWFsKTtcbiAgICB6ZXJvVmVjMihsb3dlckxpbWl0KTtcbiAgICB6ZXJvVmVjMih1cHBlckxpbWl0KTtcbiAgICBpZiAoaGFzVmVydGV4MCAmJiBoYXNWZXJ0ZXgzKSB7XG4gICAgICBpZiAoY29udmV4MSAmJiBjb252ZXgyKSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MCA+PSAwIHx8IG9mZnNldDEgPj0gMCB8fCBvZmZzZXQyID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMCk7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjb252ZXgxKSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MCA+PSAwIHx8IG9mZnNldDEgPj0gMCAmJiBvZmZzZXQyID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMCk7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMik7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjb252ZXgyKSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MiA+PSAwIHx8IG9mZnNldDAgPj0gMCAmJiBvZmZzZXQxID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMihsb3dlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwwKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnJvbnQgPSBvZmZzZXQwID49IDAgJiYgb2Zmc2V0MSA+PSAwICYmIG9mZnNldDIgPj0gMDtcbiAgICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwyKTtcbiAgICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChoYXNWZXJ0ZXgwKSB7XG4gICAgICBpZiAoY29udmV4MSkge1xuICAgICAgICBmcm9udCA9IG9mZnNldDAgPj0gMCB8fCBvZmZzZXQxID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMCk7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgY29weVZlYzIobG93ZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKHVwcGVyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnJvbnQgPSBvZmZzZXQwID49IDAgJiYgb2Zmc2V0MSA+PSAwO1xuICAgICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKGxvd2VyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICAgIHNjYWxlVmVjMih1cHBlckxpbWl0LCAtMSwgbm9ybWFsMCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGhhc1ZlcnRleDMpIHtcbiAgICAgIGlmIChjb252ZXgyKSB7XG4gICAgICAgIGZyb250ID0gb2Zmc2V0MSA+PSAwIHx8IG9mZnNldDIgPj0gMDtcbiAgICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgICAgY29weVZlYzIobm9ybWFsLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjYWxlVmVjMihub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICAgIGNvcHlWZWMyKHVwcGVyTGltaXQsIG5vcm1hbDEpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmcm9udCA9IG9mZnNldDEgPj0gMCAmJiBvZmZzZXQyID49IDA7XG4gICAgICAgIGlmIChmcm9udCkge1xuICAgICAgICAgIGNvcHlWZWMyKG5vcm1hbCwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwxKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVZlYzIobm9ybWFsLCAtMSwgbm9ybWFsMSk7XG4gICAgICAgICAgc2NhbGVWZWMyKGxvd2VyTGltaXQsIC0xLCBub3JtYWwyKTtcbiAgICAgICAgICBjb3B5VmVjMih1cHBlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBmcm9udCA9IG9mZnNldDEgPj0gMDtcbiAgICAgIGlmIChmcm9udCkge1xuICAgICAgICBjb3B5VmVjMihub3JtYWwsIG5vcm1hbDEpO1xuICAgICAgICBzY2FsZVZlYzIobG93ZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICBzY2FsZVZlYzIodXBwZXJMaW1pdCwgLTEsIG5vcm1hbDEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2NhbGVWZWMyKG5vcm1hbCwgLTEsIG5vcm1hbDEpO1xuICAgICAgICBjb3B5VmVjMihsb3dlckxpbWl0LCBub3JtYWwxKTtcbiAgICAgICAgY29weVZlYzIodXBwZXJMaW1pdCwgbm9ybWFsMSk7XG4gICAgICB9XG4gICAgfVxuICAgIHBvbHlnb25CQS5jb3VudCA9IHBvbHlnb25CLm1fY291bnQ7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2x5Z29uQi5tX2NvdW50OyArK2kpIHtcbiAgICAgIHRyYW5zZm9ybVZlYzIocG9seWdvbkJBLnZlcnRpY2VzW2ldLCB4ZiwgcG9seWdvbkIubV92ZXJ0aWNlc1tpXSk7XG4gICAgICByb3RWZWMyKHBvbHlnb25CQS5ub3JtYWxzW2ldLCB4Zi5xLCBwb2x5Z29uQi5tX25vcm1hbHNbaV0pO1xuICAgIH1cbiAgICB2YXIgcmFkaXVzID0gcG9seWdvbkIubV9yYWRpdXMgKyBlZGdlQS5tX3JhZGl1cztcbiAgICBtYW5pZm9sZC5wb2ludENvdW50ID0gMDtcbiAgICB7XG4gICAgICBlZGdlQXhpcy50eXBlID0gRVBBeGlzVHlwZS5lX2VkZ2VBO1xuICAgICAgZWRnZUF4aXMuaW5kZXggPSBmcm9udCA/IDAgOiAxO1xuICAgICAgZWRnZUF4aXMuc2VwYXJhdGlvbiA9IEluZmluaXR5O1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2x5Z29uQkEuY291bnQ7ICsraSkge1xuICAgICAgICB2YXIgdjQgPSBwb2x5Z29uQkEudmVydGljZXNbaV07XG4gICAgICAgIHZhciBzMiA9IGRvdFZlYzIobm9ybWFsLCB2NCkgLSBkb3RWZWMyKG5vcm1hbCwgdjEzKTtcbiAgICAgICAgaWYgKHMyIDwgZWRnZUF4aXMuc2VwYXJhdGlvbikge1xuICAgICAgICAgIGVkZ2VBeGlzLnNlcGFyYXRpb24gPSBzMjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZWRnZUF4aXMudHlwZSA9PSBFUEF4aXNUeXBlLmVfdW5rbm93bikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZWRnZUF4aXMuc2VwYXJhdGlvbiA+IHJhZGl1cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB7XG4gICAgICBwb2x5Z29uQXhpcy50eXBlID0gRVBBeGlzVHlwZS5lX3Vua25vd247XG4gICAgICBwb2x5Z29uQXhpcy5pbmRleCA9IC0xO1xuICAgICAgcG9seWdvbkF4aXMuc2VwYXJhdGlvbiA9IC1JbmZpbml0eTtcbiAgICAgIHNldFZlYzIocGVycCwgLW5vcm1hbC55LCBub3JtYWwueCk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvbHlnb25CQS5jb3VudDsgKytpKSB7XG4gICAgICAgIHNjYWxlVmVjMihuLCAtMSwgcG9seWdvbkJBLm5vcm1hbHNbaV0pO1xuICAgICAgICB2YXIgczEgPSBkb3RWZWMyKG4sIHBvbHlnb25CQS52ZXJ0aWNlc1tpXSkgLSBkb3RWZWMyKG4sIHYxMyk7XG4gICAgICAgIHZhciBzMjIgPSBkb3RWZWMyKG4sIHBvbHlnb25CQS52ZXJ0aWNlc1tpXSkgLSBkb3RWZWMyKG4sIHYyMik7XG4gICAgICAgIHZhciBzMiA9IG1hdGhfbWluKHMxLCBzMjIpO1xuICAgICAgICBpZiAoczIgPiByYWRpdXMpIHtcbiAgICAgICAgICBwb2x5Z29uQXhpcy50eXBlID0gRVBBeGlzVHlwZS5lX2VkZ2VCO1xuICAgICAgICAgIHBvbHlnb25BeGlzLmluZGV4ID0gaTtcbiAgICAgICAgICBwb2x5Z29uQXhpcy5zZXBhcmF0aW9uID0gczI7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRvdFZlYzIobiwgcGVycCkgPj0gMCkge1xuICAgICAgICAgIGlmIChkb3RWZWMyKG4sIG5vcm1hbCkgLSBkb3RWZWMyKHVwcGVyTGltaXQsIG5vcm1hbCkgPCAtU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChkb3RWZWMyKG4sIG5vcm1hbCkgLSBkb3RWZWMyKGxvd2VyTGltaXQsIG5vcm1hbCkgPCAtU2V0dGluZ3NJbnRlcm5hbC5hbmd1bGFyU2xvcCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzMiA+IHBvbHlnb25BeGlzLnNlcGFyYXRpb24pIHtcbiAgICAgICAgICBwb2x5Z29uQXhpcy50eXBlID0gRVBBeGlzVHlwZS5lX2VkZ2VCO1xuICAgICAgICAgIHBvbHlnb25BeGlzLmluZGV4ID0gaTtcbiAgICAgICAgICBwb2x5Z29uQXhpcy5zZXBhcmF0aW9uID0gczI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHBvbHlnb25BeGlzLnR5cGUgIT0gRVBBeGlzVHlwZS5lX3Vua25vd24gJiYgcG9seWdvbkF4aXMuc2VwYXJhdGlvbiA+IHJhZGl1cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIga19yZWxhdGl2ZVRvbCA9IDAuOTg7XG4gICAgdmFyIGtfYWJzb2x1dGVUb2wgPSAxZS0zO1xuICAgIHZhciBwcmltYXJ5QXhpcztcbiAgICBpZiAocG9seWdvbkF4aXMudHlwZSA9PSBFUEF4aXNUeXBlLmVfdW5rbm93bikge1xuICAgICAgcHJpbWFyeUF4aXMgPSBlZGdlQXhpcztcbiAgICB9IGVsc2UgaWYgKHBvbHlnb25BeGlzLnNlcGFyYXRpb24gPiBrX3JlbGF0aXZlVG9sICogZWRnZUF4aXMuc2VwYXJhdGlvbiArIGtfYWJzb2x1dGVUb2wpIHtcbiAgICAgIHByaW1hcnlBeGlzID0gcG9seWdvbkF4aXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByaW1hcnlBeGlzID0gZWRnZUF4aXM7XG4gICAgfVxuICAgIGllWzBdLnJlY3ljbGUoKTtcbiAgICBpZVsxXS5yZWN5Y2xlKCk7XG4gICAgaWYgKHByaW1hcnlBeGlzLnR5cGUgPT0gRVBBeGlzVHlwZS5lX2VkZ2VBKSB7XG4gICAgICBtYW5pZm9sZC50eXBlID0gZXhwb3J0czIuTWFuaWZvbGRUeXBlLmVfZmFjZUE7XG4gICAgICB2YXIgYmVzdEluZGV4ID0gMDtcbiAgICAgIHZhciBiZXN0VmFsdWUgPSBkb3RWZWMyKG5vcm1hbCwgcG9seWdvbkJBLm5vcm1hbHNbMF0pO1xuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwb2x5Z29uQkEuY291bnQ7ICsraSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBkb3RWZWMyKG5vcm1hbCwgcG9seWdvbkJBLm5vcm1hbHNbaV0pO1xuICAgICAgICBpZiAodmFsdWUgPCBiZXN0VmFsdWUpIHtcbiAgICAgICAgICBiZXN0VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICBiZXN0SW5kZXggPSBpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgaTEgPSBiZXN0SW5kZXg7XG4gICAgICB2YXIgaTIgPSBpMSArIDEgPCBwb2x5Z29uQkEuY291bnQgPyBpMSArIDEgOiAwO1xuICAgICAgY29weVZlYzIoaWVbMF0udiwgcG9seWdvbkJBLnZlcnRpY2VzW2kxXSk7XG4gICAgICBpZVswXS5pZC5zZXRGZWF0dXJlcygwLCBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGUuZV9mYWNlLCBpMSwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfdmVydGV4KTtcbiAgICAgIGNvcHlWZWMyKGllWzFdLnYsIHBvbHlnb25CQS52ZXJ0aWNlc1tpMl0pO1xuICAgICAgaWVbMV0uaWQuc2V0RmVhdHVyZXMoMCwgZXhwb3J0czIuQ29udGFjdEZlYXR1cmVUeXBlLmVfZmFjZSwgaTIsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCk7XG4gICAgICBpZiAoZnJvbnQpIHtcbiAgICAgICAgcmYuaTEgPSAwO1xuICAgICAgICByZi5pMiA9IDE7XG4gICAgICAgIGNvcHlWZWMyKHJmLnYxLCB2MTMpO1xuICAgICAgICBjb3B5VmVjMihyZi52MiwgdjIyKTtcbiAgICAgICAgY29weVZlYzIocmYubm9ybWFsLCBub3JtYWwxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJmLmkxID0gMTtcbiAgICAgICAgcmYuaTIgPSAwO1xuICAgICAgICBjb3B5VmVjMihyZi52MSwgdjIyKTtcbiAgICAgICAgY29weVZlYzIocmYudjIsIHYxMyk7XG4gICAgICAgIHNjYWxlVmVjMihyZi5ub3JtYWwsIC0xLCBub3JtYWwxKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbWFuaWZvbGQudHlwZSA9IGV4cG9ydHMyLk1hbmlmb2xkVHlwZS5lX2ZhY2VCO1xuICAgICAgY29weVZlYzIoaWVbMF0udiwgdjEzKTtcbiAgICAgIGllWzBdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgcHJpbWFyeUF4aXMuaW5kZXgsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UpO1xuICAgICAgY29weVZlYzIoaWVbMV0udiwgdjIyKTtcbiAgICAgIGllWzFdLmlkLnNldEZlYXR1cmVzKDAsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX3ZlcnRleCwgcHJpbWFyeUF4aXMuaW5kZXgsIGV4cG9ydHMyLkNvbnRhY3RGZWF0dXJlVHlwZS5lX2ZhY2UpO1xuICAgICAgcmYuaTEgPSBwcmltYXJ5QXhpcy5pbmRleDtcbiAgICAgIHJmLmkyID0gcmYuaTEgKyAxIDwgcG9seWdvbkJBLmNvdW50ID8gcmYuaTEgKyAxIDogMDtcbiAgICAgIGNvcHlWZWMyKHJmLnYxLCBwb2x5Z29uQkEudmVydGljZXNbcmYuaTFdKTtcbiAgICAgIGNvcHlWZWMyKHJmLnYyLCBwb2x5Z29uQkEudmVydGljZXNbcmYuaTJdKTtcbiAgICAgIGNvcHlWZWMyKHJmLm5vcm1hbCwgcG9seWdvbkJBLm5vcm1hbHNbcmYuaTFdKTtcbiAgICB9XG4gICAgc2V0VmVjMihyZi5zaWRlTm9ybWFsMSwgcmYubm9ybWFsLnksIC1yZi5ub3JtYWwueCk7XG4gICAgc2V0VmVjMihyZi5zaWRlTm9ybWFsMiwgLXJmLnNpZGVOb3JtYWwxLngsIC1yZi5zaWRlTm9ybWFsMS55KTtcbiAgICByZi5zaWRlT2Zmc2V0MSA9IGRvdFZlYzIocmYuc2lkZU5vcm1hbDEsIHJmLnYxKTtcbiAgICByZi5zaWRlT2Zmc2V0MiA9IGRvdFZlYzIocmYuc2lkZU5vcm1hbDIsIHJmLnYyKTtcbiAgICBjbGlwUG9pbnRzMVswXS5yZWN5Y2xlKCk7XG4gICAgY2xpcFBvaW50czFbMV0ucmVjeWNsZSgpO1xuICAgIGNsaXBQb2ludHMyWzBdLnJlY3ljbGUoKTtcbiAgICBjbGlwUG9pbnRzMlsxXS5yZWN5Y2xlKCk7XG4gICAgdmFyIG5wMSA9IGNsaXBTZWdtZW50VG9MaW5lKGNsaXBQb2ludHMxLCBpZSwgcmYuc2lkZU5vcm1hbDEsIHJmLnNpZGVPZmZzZXQxLCByZi5pMSk7XG4gICAgaWYgKG5wMSA8IFNldHRpbmdzSW50ZXJuYWwubWF4TWFuaWZvbGRQb2ludHMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG5wMiA9IGNsaXBTZWdtZW50VG9MaW5lKGNsaXBQb2ludHMyLCBjbGlwUG9pbnRzMSwgcmYuc2lkZU5vcm1hbDIsIHJmLnNpZGVPZmZzZXQyLCByZi5pMik7XG4gICAgaWYgKG5wMiA8IFNldHRpbmdzSW50ZXJuYWwubWF4TWFuaWZvbGRQb2ludHMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHByaW1hcnlBeGlzLnR5cGUgPT0gRVBBeGlzVHlwZS5lX2VkZ2VBKSB7XG4gICAgICBjb3B5VmVjMihtYW5pZm9sZC5sb2NhbE5vcm1hbCwgcmYubm9ybWFsKTtcbiAgICAgIGNvcHlWZWMyKG1hbmlmb2xkLmxvY2FsUG9pbnQsIHJmLnYxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxOb3JtYWwsIHBvbHlnb25CLm1fbm9ybWFsc1tyZi5pMV0pO1xuICAgICAgY29weVZlYzIobWFuaWZvbGQubG9jYWxQb2ludCwgcG9seWdvbkIubV92ZXJ0aWNlc1tyZi5pMV0pO1xuICAgIH1cbiAgICB2YXIgcG9pbnRDb3VudCA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBTZXR0aW5nc0ludGVybmFsLm1heE1hbmlmb2xkUG9pbnRzOyArK2kpIHtcbiAgICAgIHZhciBzZXBhcmF0aW9uID0gZG90VmVjMihyZi5ub3JtYWwsIGNsaXBQb2ludHMyW2ldLnYpIC0gZG90VmVjMihyZi5ub3JtYWwsIHJmLnYxKTtcbiAgICAgIGlmIChzZXBhcmF0aW9uIDw9IHJhZGl1cykge1xuICAgICAgICB2YXIgY3AgPSBtYW5pZm9sZC5wb2ludHNbcG9pbnRDb3VudF07XG4gICAgICAgIGlmIChwcmltYXJ5QXhpcy50eXBlID09IEVQQXhpc1R5cGUuZV9lZGdlQSkge1xuICAgICAgICAgIGRldHJhbnNmb3JtVmVjMihjcC5sb2NhbFBvaW50LCB4ZiwgY2xpcFBvaW50czJbaV0udik7XG4gICAgICAgICAgY3AuaWQuc2V0KGNsaXBQb2ludHMyW2ldLmlkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb3B5VmVjMihjcC5sb2NhbFBvaW50LCBjbGlwUG9pbnRzMltpXS52KTtcbiAgICAgICAgICBjcC5pZC5zZXQoY2xpcFBvaW50czJbaV0uaWQpO1xuICAgICAgICAgIGNwLmlkLnN3YXBGZWF0dXJlcygpO1xuICAgICAgICB9XG4gICAgICAgICsrcG9pbnRDb3VudDtcbiAgICAgIH1cbiAgICB9XG4gICAgbWFuaWZvbGQucG9pbnRDb3VudCA9IHBvaW50Q291bnQ7XG4gIH07XG4gIHZhciBpbnRlcm5hbCA9IHtcbiAgICBDb2xsaWRlUG9seWdvbnMsXG4gICAgU2V0dGluZ3MsXG4gICAgU3dlZXAsXG4gICAgTWFuaWZvbGQsXG4gICAgRGlzdGFuY2UsXG4gICAgVGltZU9mSW1wYWN0LFxuICAgIER5bmFtaWNUcmVlLFxuICAgIHN0YXRzXG4gIH07XG4gIHZhciBEYXRhRHJpdmVyID0gKFxuICAgIC8qKiBAY2xhc3MgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIERhdGFEcml2ZXIyKGtleSwgbGlzdGVuZXIpIHtcbiAgICAgICAgdGhpcy5fcmVmTWFwID0ge307XG4gICAgICAgIHRoaXMuX21hcCA9IHt9O1xuICAgICAgICB0aGlzLl94bWFwID0ge307XG4gICAgICAgIHRoaXMuX2RhdGEgPSBbXTtcbiAgICAgICAgdGhpcy5fZW50ZXJlZCA9IFtdO1xuICAgICAgICB0aGlzLl9leGl0ZWQgPSBbXTtcbiAgICAgICAgdGhpcy5fa2V5ID0ga2V5O1xuICAgICAgICB0aGlzLl9saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgICAgfVxuICAgICAgRGF0YURyaXZlcjIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGRhdGEpKVxuICAgICAgICAgIHRocm93IFwiSW52YWxpZCBkYXRhOiBcIiArIGRhdGE7XG4gICAgICAgIHRoaXMuX2VudGVyZWQubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5fZXhpdGVkLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuX2RhdGEubGVuZ3RoID0gZGF0YS5sZW5ndGg7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmICh0eXBlb2YgZGF0YVtpXSAhPT0gXCJvYmplY3RcIiB8fCBkYXRhW2ldID09PSBudWxsKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgdmFyIGQyID0gZGF0YVtpXTtcbiAgICAgICAgICB2YXIgaWQgPSB0aGlzLl9rZXkoZDIpO1xuICAgICAgICAgIGlmICghdGhpcy5fbWFwW2lkXSkge1xuICAgICAgICAgICAgdGhpcy5fZW50ZXJlZC5wdXNoKGQyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX21hcFtpZF07XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX2RhdGFbaV0gPSBkMjtcbiAgICAgICAgICB0aGlzLl94bWFwW2lkXSA9IGQyO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGlkIGluIHRoaXMuX21hcCkge1xuICAgICAgICAgIHRoaXMuX2V4aXRlZC5wdXNoKHRoaXMuX21hcFtpZF0pO1xuICAgICAgICAgIGRlbGV0ZSB0aGlzLl9tYXBbaWRdO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0ZW1wMyA9IHRoaXMuX21hcDtcbiAgICAgICAgdGhpcy5fbWFwID0gdGhpcy5feG1hcDtcbiAgICAgICAgdGhpcy5feG1hcCA9IHRlbXAzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2V4aXRlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBkMiA9IHRoaXMuX2V4aXRlZFtpXTtcbiAgICAgICAgICB2YXIga2V5ID0gdGhpcy5fa2V5KGQyKTtcbiAgICAgICAgICB2YXIgcmVmID0gdGhpcy5fcmVmTWFwW2tleV07XG4gICAgICAgICAgdGhpcy5fbGlzdGVuZXIuZXhpdChkMiwgcmVmKTtcbiAgICAgICAgICBkZWxldGUgdGhpcy5fcmVmTWFwW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9lbnRlcmVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdmFyIGQyID0gdGhpcy5fZW50ZXJlZFtpXTtcbiAgICAgICAgICB2YXIga2V5ID0gdGhpcy5fa2V5KGQyKTtcbiAgICAgICAgICB2YXIgcmVmID0gdGhpcy5fbGlzdGVuZXIuZW50ZXIoZDIpO1xuICAgICAgICAgIGlmIChyZWYpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlZk1hcFtrZXldID0gcmVmO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2RhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGRhdGFbaV0gIT09IFwib2JqZWN0XCIgfHwgZGF0YVtpXSA9PT0gbnVsbClcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIHZhciBkMiA9IHRoaXMuX2RhdGFbaV07XG4gICAgICAgICAgdmFyIGtleSA9IHRoaXMuX2tleShkMik7XG4gICAgICAgICAgdmFyIHJlZiA9IHRoaXMuX3JlZk1hcFtrZXldO1xuICAgICAgICAgIHRoaXMuX2xpc3RlbmVyLnVwZGF0ZShkMiwgcmVmKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9lbnRlcmVkLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuX2V4aXRlZC5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLl9kYXRhLmxlbmd0aCA9IDA7XG4gICAgICB9O1xuICAgICAgRGF0YURyaXZlcjIucHJvdG90eXBlLnJlZiA9IGZ1bmN0aW9uKGQyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZWZNYXBbdGhpcy5fa2V5KGQyKV07XG4gICAgICB9O1xuICAgICAgcmV0dXJuIERhdGFEcml2ZXIyO1xuICAgIH0oKVxuICApO1xuICBjb25zdCBwbGFuY2sgPSAvKiBAX19QVVJFX18gKi8gT2JqZWN0LmZyZWV6ZSgvKiBAX19QVVJFX18gKi8gT2JqZWN0LmRlZmluZVByb3BlcnR5KHtcbiAgICBfX3Byb3RvX186IG51bGwsXG4gICAgQUFCQixcbiAgICBCb2R5LFxuICAgIEJveDogQm94U2hhcGUsXG4gICAgQm94U2hhcGUsXG4gICAgQnJvYWRQaGFzZSxcbiAgICBDaGFpbjogQ2hhaW5TaGFwZSxcbiAgICBDaGFpblNoYXBlLFxuICAgIENpcmNsZTogQ2lyY2xlU2hhcGUsXG4gICAgQ2lyY2xlU2hhcGUsXG4gICAgQ2xpcFZlcnRleCxcbiAgICBDb2xsaWRlQ2lyY2xlcyxcbiAgICBDb2xsaWRlRWRnZUNpcmNsZSxcbiAgICBDb2xsaWRlRWRnZVBvbHlnb24sXG4gICAgQ29sbGlkZVBvbHlnb25DaXJjbGUsXG4gICAgQ29sbGlkZVBvbHlnb25zLFxuICAgIENvbnRhY3QsXG4gICAgQ29udGFjdEVkZ2UsXG4gICAgZ2V0IENvbnRhY3RGZWF0dXJlVHlwZSgpIHtcbiAgICAgIHJldHVybiBleHBvcnRzMi5Db250YWN0RmVhdHVyZVR5cGU7XG4gICAgfSxcbiAgICBDb250YWN0SUQsXG4gICAgQ29udGFjdEltcHVsc2UsXG4gICAgRGF0YURyaXZlcixcbiAgICBEaXN0YW5jZSxcbiAgICBEaXN0YW5jZUlucHV0LFxuICAgIERpc3RhbmNlSm9pbnQsXG4gICAgRGlzdGFuY2VPdXRwdXQsXG4gICAgRGlzdGFuY2VQcm94eSxcbiAgICBEeW5hbWljVHJlZSxcbiAgICBFZGdlOiBFZGdlU2hhcGUsXG4gICAgRWRnZVNoYXBlLFxuICAgIEZpeHR1cmUsXG4gICAgRml4dHVyZVByb3h5LFxuICAgIEZyaWN0aW9uSm9pbnQsXG4gICAgR2VhckpvaW50LFxuICAgIEpvaW50LFxuICAgIEpvaW50RWRnZSxcbiAgICBNYW5pZm9sZCxcbiAgICBNYW5pZm9sZFBvaW50LFxuICAgIGdldCBNYW5pZm9sZFR5cGUoKSB7XG4gICAgICByZXR1cm4gZXhwb3J0czIuTWFuaWZvbGRUeXBlO1xuICAgIH0sXG4gICAgTWF0MjIsXG4gICAgTWF0MzMsXG4gICAgTWF0aDogbWF0aCxcbiAgICBNb3RvckpvaW50LFxuICAgIE1vdXNlSm9pbnQsXG4gICAgZ2V0IFBvaW50U3RhdGUoKSB7XG4gICAgICByZXR1cm4gZXhwb3J0czIuUG9pbnRTdGF0ZTtcbiAgICB9LFxuICAgIFBvbHlnb246IFBvbHlnb25TaGFwZSxcbiAgICBQb2x5Z29uU2hhcGUsXG4gICAgUHJpc21hdGljSm9pbnQsXG4gICAgUHVsbGV5Sm9pbnQsXG4gICAgUmV2b2x1dGVKb2ludCxcbiAgICBSb3BlSm9pbnQsXG4gICAgUm90LFxuICAgIFNlcmlhbGl6ZXIsXG4gICAgU2V0dGluZ3MsXG4gICAgU2V0dGluZ3NJbnRlcm5hbCxcbiAgICBTaGFwZSxcbiAgICBTaGFwZUNhc3QsXG4gICAgU2hhcGVDYXN0SW5wdXQsXG4gICAgU2hhcGVDYXN0T3V0cHV0LFxuICAgIFNpbXBsZXhDYWNoZSxcbiAgICBTb2x2ZXIsXG4gICAgU3dlZXAsXG4gICAgVE9JSW5wdXQsXG4gICAgVE9JT3V0cHV0LFxuICAgIGdldCBUT0lPdXRwdXRTdGF0ZSgpIHtcbiAgICAgIHJldHVybiBleHBvcnRzMi5UT0lPdXRwdXRTdGF0ZTtcbiAgICB9LFxuICAgIFRlc3RiZWQsXG4gICAgVGltZU9mSW1wYWN0LFxuICAgIFRpbWVTdGVwLFxuICAgIFRyYW5zZm9ybSxcbiAgICBUcmVlTm9kZSxcbiAgICBWZWMyLFxuICAgIFZlYzMsXG4gICAgVmVsb2NpdHlDb25zdHJhaW50UG9pbnQsXG4gICAgV2VsZEpvaW50LFxuICAgIFdoZWVsSm9pbnQsXG4gICAgV29ybGQsXG4gICAgV29ybGRNYW5pZm9sZCxcbiAgICBjbGlwU2VnbWVudFRvTGluZSxcbiAgICBnZXRQb2ludFN0YXRlcyxcbiAgICBpbnRlcm5hbCxcbiAgICBtaXhGcmljdGlvbixcbiAgICBtaXhSZXN0aXR1dGlvbixcbiAgICBzdGF0cyxcbiAgICB0ZXN0T3ZlcmxhcCxcbiAgICB0ZXN0YmVkXG4gIH0sIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogXCJNb2R1bGVcIiB9KSk7XG4gIGV4cG9ydHMyLkFBQkIgPSBBQUJCO1xuICBleHBvcnRzMi5Cb2R5ID0gQm9keTtcbiAgZXhwb3J0czIuQm94ID0gQm94U2hhcGU7XG4gIGV4cG9ydHMyLkJveFNoYXBlID0gQm94U2hhcGU7XG4gIGV4cG9ydHMyLkJyb2FkUGhhc2UgPSBCcm9hZFBoYXNlO1xuICBleHBvcnRzMi5DaGFpbiA9IENoYWluU2hhcGU7XG4gIGV4cG9ydHMyLkNoYWluU2hhcGUgPSBDaGFpblNoYXBlO1xuICBleHBvcnRzMi5DaXJjbGUgPSBDaXJjbGVTaGFwZTtcbiAgZXhwb3J0czIuQ2lyY2xlU2hhcGUgPSBDaXJjbGVTaGFwZTtcbiAgZXhwb3J0czIuQ2xpcFZlcnRleCA9IENsaXBWZXJ0ZXg7XG4gIGV4cG9ydHMyLkNvbGxpZGVDaXJjbGVzID0gQ29sbGlkZUNpcmNsZXM7XG4gIGV4cG9ydHMyLkNvbGxpZGVFZGdlQ2lyY2xlID0gQ29sbGlkZUVkZ2VDaXJjbGU7XG4gIGV4cG9ydHMyLkNvbGxpZGVFZGdlUG9seWdvbiA9IENvbGxpZGVFZGdlUG9seWdvbjtcbiAgZXhwb3J0czIuQ29sbGlkZVBvbHlnb25DaXJjbGUgPSBDb2xsaWRlUG9seWdvbkNpcmNsZTtcbiAgZXhwb3J0czIuQ29sbGlkZVBvbHlnb25zID0gQ29sbGlkZVBvbHlnb25zO1xuICBleHBvcnRzMi5Db250YWN0ID0gQ29udGFjdDtcbiAgZXhwb3J0czIuQ29udGFjdEVkZ2UgPSBDb250YWN0RWRnZTtcbiAgZXhwb3J0czIuQ29udGFjdElEID0gQ29udGFjdElEO1xuICBleHBvcnRzMi5Db250YWN0SW1wdWxzZSA9IENvbnRhY3RJbXB1bHNlO1xuICBleHBvcnRzMi5EYXRhRHJpdmVyID0gRGF0YURyaXZlcjtcbiAgZXhwb3J0czIuRGlzdGFuY2UgPSBEaXN0YW5jZTtcbiAgZXhwb3J0czIuRGlzdGFuY2VJbnB1dCA9IERpc3RhbmNlSW5wdXQ7XG4gIGV4cG9ydHMyLkRpc3RhbmNlSm9pbnQgPSBEaXN0YW5jZUpvaW50O1xuICBleHBvcnRzMi5EaXN0YW5jZU91dHB1dCA9IERpc3RhbmNlT3V0cHV0O1xuICBleHBvcnRzMi5EaXN0YW5jZVByb3h5ID0gRGlzdGFuY2VQcm94eTtcbiAgZXhwb3J0czIuRHluYW1pY1RyZWUgPSBEeW5hbWljVHJlZTtcbiAgZXhwb3J0czIuRWRnZSA9IEVkZ2VTaGFwZTtcbiAgZXhwb3J0czIuRWRnZVNoYXBlID0gRWRnZVNoYXBlO1xuICBleHBvcnRzMi5GaXh0dXJlID0gRml4dHVyZTtcbiAgZXhwb3J0czIuRml4dHVyZVByb3h5ID0gRml4dHVyZVByb3h5O1xuICBleHBvcnRzMi5GcmljdGlvbkpvaW50ID0gRnJpY3Rpb25Kb2ludDtcbiAgZXhwb3J0czIuR2VhckpvaW50ID0gR2VhckpvaW50O1xuICBleHBvcnRzMi5Kb2ludCA9IEpvaW50O1xuICBleHBvcnRzMi5Kb2ludEVkZ2UgPSBKb2ludEVkZ2U7XG4gIGV4cG9ydHMyLk1hbmlmb2xkID0gTWFuaWZvbGQ7XG4gIGV4cG9ydHMyLk1hbmlmb2xkUG9pbnQgPSBNYW5pZm9sZFBvaW50O1xuICBleHBvcnRzMi5NYXQyMiA9IE1hdDIyO1xuICBleHBvcnRzMi5NYXQzMyA9IE1hdDMzO1xuICBleHBvcnRzMi5NYXRoID0gbWF0aDtcbiAgZXhwb3J0czIuTW90b3JKb2ludCA9IE1vdG9ySm9pbnQ7XG4gIGV4cG9ydHMyLk1vdXNlSm9pbnQgPSBNb3VzZUpvaW50O1xuICBleHBvcnRzMi5Qb2x5Z29uID0gUG9seWdvblNoYXBlO1xuICBleHBvcnRzMi5Qb2x5Z29uU2hhcGUgPSBQb2x5Z29uU2hhcGU7XG4gIGV4cG9ydHMyLlByaXNtYXRpY0pvaW50ID0gUHJpc21hdGljSm9pbnQ7XG4gIGV4cG9ydHMyLlB1bGxleUpvaW50ID0gUHVsbGV5Sm9pbnQ7XG4gIGV4cG9ydHMyLlJldm9sdXRlSm9pbnQgPSBSZXZvbHV0ZUpvaW50O1xuICBleHBvcnRzMi5Sb3BlSm9pbnQgPSBSb3BlSm9pbnQ7XG4gIGV4cG9ydHMyLlJvdCA9IFJvdDtcbiAgZXhwb3J0czIuU2VyaWFsaXplciA9IFNlcmlhbGl6ZXI7XG4gIGV4cG9ydHMyLlNldHRpbmdzID0gU2V0dGluZ3M7XG4gIGV4cG9ydHMyLlNldHRpbmdzSW50ZXJuYWwgPSBTZXR0aW5nc0ludGVybmFsO1xuICBleHBvcnRzMi5TaGFwZSA9IFNoYXBlO1xuICBleHBvcnRzMi5TaGFwZUNhc3QgPSBTaGFwZUNhc3Q7XG4gIGV4cG9ydHMyLlNoYXBlQ2FzdElucHV0ID0gU2hhcGVDYXN0SW5wdXQ7XG4gIGV4cG9ydHMyLlNoYXBlQ2FzdE91dHB1dCA9IFNoYXBlQ2FzdE91dHB1dDtcbiAgZXhwb3J0czIuU2ltcGxleENhY2hlID0gU2ltcGxleENhY2hlO1xuICBleHBvcnRzMi5Tb2x2ZXIgPSBTb2x2ZXI7XG4gIGV4cG9ydHMyLlN3ZWVwID0gU3dlZXA7XG4gIGV4cG9ydHMyLlRPSUlucHV0ID0gVE9JSW5wdXQ7XG4gIGV4cG9ydHMyLlRPSU91dHB1dCA9IFRPSU91dHB1dDtcbiAgZXhwb3J0czIuVGVzdGJlZCA9IFRlc3RiZWQ7XG4gIGV4cG9ydHMyLlRpbWVPZkltcGFjdCA9IFRpbWVPZkltcGFjdDtcbiAgZXhwb3J0czIuVGltZVN0ZXAgPSBUaW1lU3RlcDtcbiAgZXhwb3J0czIuVHJhbnNmb3JtID0gVHJhbnNmb3JtO1xuICBleHBvcnRzMi5UcmVlTm9kZSA9IFRyZWVOb2RlO1xuICBleHBvcnRzMi5WZWMyID0gVmVjMjtcbiAgZXhwb3J0czIuVmVjMyA9IFZlYzM7XG4gIGV4cG9ydHMyLlZlbG9jaXR5Q29uc3RyYWludFBvaW50ID0gVmVsb2NpdHlDb25zdHJhaW50UG9pbnQ7XG4gIGV4cG9ydHMyLldlbGRKb2ludCA9IFdlbGRKb2ludDtcbiAgZXhwb3J0czIuV2hlZWxKb2ludCA9IFdoZWVsSm9pbnQ7XG4gIGV4cG9ydHMyLldvcmxkID0gV29ybGQ7XG4gIGV4cG9ydHMyLldvcmxkTWFuaWZvbGQgPSBXb3JsZE1hbmlmb2xkO1xuICBleHBvcnRzMi5jbGlwU2VnbWVudFRvTGluZSA9IGNsaXBTZWdtZW50VG9MaW5lO1xuICBleHBvcnRzMi5kZWZhdWx0ID0gcGxhbmNrO1xuICBleHBvcnRzMi5nZXRQb2ludFN0YXRlcyA9IGdldFBvaW50U3RhdGVzO1xuICBleHBvcnRzMi5pbnRlcm5hbCA9IGludGVybmFsO1xuICBleHBvcnRzMi5taXhGcmljdGlvbiA9IG1peEZyaWN0aW9uO1xuICBleHBvcnRzMi5taXhSZXN0aXR1dGlvbiA9IG1peFJlc3RpdHV0aW9uO1xuICBleHBvcnRzMi5zdGF0cyA9IHN0YXRzO1xuICBleHBvcnRzMi50ZXN0T3ZlcmxhcCA9IHRlc3RPdmVybGFwO1xuICBleHBvcnRzMi50ZXN0YmVkID0gdGVzdGJlZDtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0czIsIHsgX19lc01vZHVsZTogeyB2YWx1ZTogdHJ1ZSB9LCBbU3ltYm9sLnRvU3RyaW5nVGFnXTogeyB2YWx1ZTogXCJNb2R1bGVcIiB9IH0pO1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wbGFuY2suanMubWFwXG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IEFzc2V0IH0gZnJvbSAnLi4nO1xuaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnLi9ldmVudC1zeXN0ZW0nO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFzc2V0TG9hZGVyRXZlbnRzIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkPiB7XG4gICdsb2FkaW5nOnN0YXJ0JzogKCkgPT4gdm9pZDtcbiAgJ2xvYWRpbmc6ZW5kJzogKCkgPT4gdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIEFzc2V0TG9hZGVyIHtcbiAgUElYSUFzc2V0czogUElYSS5Bc3NldHNDbGFzcyA9IFBJWEkuQXNzZXRzO1xuICB0ZXh0dXJlczogUElYSS5UZXh0dXJlW10gPSBbXTtcbiAgaXNMb2FkaW5nOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgZXZlbnRzOiBFdmVudEVtaXR0ZXI8QXNzZXRMb2FkZXJFdmVudHM+ID0gbmV3IEV2ZW50RW1pdHRlcjxBc3NldExvYWRlckV2ZW50cz4oKTtcblxuICAvKipcbiAgICogU3Vic2NyaWJlIHRvIGxvYWRpbmcgZXZlbnRzXG4gICAqL1xuICBvbjxLIGV4dGVuZHMga2V5b2YgQXNzZXRMb2FkZXJFdmVudHM+KGV2ZW50OiBLLCBsaXN0ZW5lcjogQXNzZXRMb2FkZXJFdmVudHNbS10pOiB2b2lkIHtcbiAgICB0aGlzLmV2ZW50cy5vbihldmVudCwgbGlzdGVuZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVuc3Vic2NyaWJlIGZyb20gbG9hZGluZyBldmVudHNcbiAgICovXG4gIG9mZjxLIGV4dGVuZHMga2V5b2YgQXNzZXRMb2FkZXJFdmVudHM+KGV2ZW50OiBLLCBsaXN0ZW5lcjogQXNzZXRMb2FkZXJFdmVudHNbS10pOiB2b2lkIHtcbiAgICB0aGlzLmV2ZW50cy5vZmYoZXZlbnQsIGxpc3RlbmVyKTtcbiAgfVxuXG4gIGxvYWRBc3NldHMgPSBhc3luYyAoYXNzZXRzOiBBc3NldFtdKSA9PiB7XG4gICAgY29uc3QgeyBQSVhJQXNzZXRzIH0gPSB0aGlzO1xuXG4gICAgLy8gRW1pdCBsb2FkaW5nIHN0YXJ0IGV2ZW50XG4gICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuICAgIHRoaXMuZXZlbnRzLmVtaXQoJ2xvYWRpbmc6c3RhcnQnKTtcblxuICAgIHRyeSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFzc2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCB7IHNyYywgYWxpYXMgfSA9IGFzc2V0c1tpXTtcbiAgICAgICAgXG4gICAgICAgIGlmIChhbGlhcykge1xuICAgICAgICAgIGlmICghUElYSUFzc2V0cy5jYWNoZS5oYXMoYWxpYXMpKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0dXJlID0gYXdhaXQgUElYSUFzc2V0cy5sb2FkKHsgYWxpYXMsIHNyYyB9KTtcbiAgICAgICAgICAgIHRoaXMudGV4dHVyZXMucHVzaCh0ZXh0dXJlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgY29uc3QgdGV4dHVyZSA9IGF3YWl0IFBJWElBc3NldHMubG9hZChzcmMpO1xuICAgICAgICAgIHRoaXMudGV4dHVyZXMucHVzaCh0ZXh0dXJlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIC8vIEVtaXQgbG9hZGluZyBlbmQgZXZlbnRcbiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICB0aGlzLmV2ZW50cy5lbWl0KCdsb2FkaW5nOmVuZCcpO1xuICAgIH1cbiAgfTtcbn0iLCJpbXBvcnQgUElYSSwgeyBQb2ludCB9IGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgTG9naWMgfSBmcm9tICcuL2xvZ2ljJztcbmltcG9ydCB7IFNjZW5lIH0gZnJvbSAnLi9zY2VuZSc7XG5pbXBvcnQgeyBBc0VudGl0eSwgTW94aUxvZ2ljLCBNb3hpRW50aXR5IH0gZnJvbSAnLi9tb3hpLWVudGl0eSc7XG5pbXBvcnQgeyBsZXJwIH0gZnJvbSAnLi4vbGlicmFyeS91dGlscyc7XG5cbi8qKlxuICogTG9naWMgdGhhdCBoYW5kbGVzIGNhbWVyYSBtb3ZlbWVudCwgZm9sbG93aW5nIHRhcmdldHMsIGFuZCBzbW9vdGggdHJhbnNpdGlvbnMuXG4gKiBcbiAqIEBjYXRlZ29yeSBMb2dpY1xuICogQGltcGxlbWVudHMge0xvZ2ljPFBJWEkuQ29udGFpbmVyPn1cbiAqL1xuZXhwb3J0IGNsYXNzIENhbWVyYUxvZ2ljIGV4dGVuZHMgTG9naWM8UElYSS5Db250YWluZXI+IHtcbiAgLyoqXG4gICAqIEV4cGxpY2l0IG5hbWUgZm9yIHRoZSBsb2dpYyBjb21wb25lbnQgKHN1cnZpdmVzIG1pbmlmaWNhdGlvbilcbiAgICovXG4gIG5hbWUgPSAnQ2FtZXJhTG9naWMnO1xuICBcbiAgLyoqXG4gICAqIFNwZWVkIGF0IHdoaWNoIHRoZSBjYW1lcmEgdHJhbnNpdGlvbnMgdG8gaXRzIHRhcmdldCBwb3NpdGlvbiBhbmQgc2NhbGVcbiAgICogQGRlZmF1bHQgMC4xXG4gICAqL1xuICBwdWJsaWMgc3BlZWQ6IG51bWJlciA9IDAuMTtcbiAgXG4gIC8qKlxuICAgKiBUaGUgZW50aXR5IHRoYXQgdGhlIGNhbWVyYSB3aWxsIGZvbGxvd1xuICAgKiBAZGVmYXVsdCBudWxsXG4gICAqL1xuICBwdWJsaWMgdGFyZ2V0OiBQSVhJLkNvbnRhaW5lciA9IG51bGw7XG4gIFxuICAvKipcbiAgICogVGhlIGVudGl0eSB0aGlzIGxvZ2ljIGlzIGF0dGFjaGVkIHRvXG4gICAqL1xuICBlbnRpdHk6IFBJWEkuQ29udGFpbmVyPFBJWEkuQ29udGFpbmVyQ2hpbGQ+O1xuICBcbiAgLyoqXG4gICAqIFJlZmVyZW5jZSB0byB0aGUgcmVuZGVyZXIgZm9yIHZpZXdwb3J0IGNhbGN1bGF0aW9uc1xuICAgKi9cbiAgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI8SFRNTENhbnZhc0VsZW1lbnQ+O1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHRoZSBjYW1lcmEgbG9naWNcbiAgICogQHBhcmFtIGVudGl0eSAtIFRoZSBjb250YWluZXIgKGNhbWVyYSkgdGhpcyBsb2dpYyBpcyBhdHRhY2hlZCB0b1xuICAgKiBAcGFyYW0gcmVuZGVyZXIgLSBUaGUgUElYSSByZW5kZXJlciBpbnN0YW5jZVxuICAgKi9cbiAgaW5pdChlbnRpdHk6IFBJWEkuQ29udGFpbmVyLCByZW5kZXJlcjogUElYSS5SZW5kZXJlcikge1xuICAgIHRoaXMuZW50aXR5ID0gZW50aXR5O1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBjYW1lcmEgcG9zaXRpb24gYW5kIHNjYWxlIGJhc2VkIG9uIHRhcmdldHMgYW5kIGRlc2lyZWQgdmFsdWVzXG4gICAqIEBwYXJhbSBlbnRpdHkgLSBUaGUgQ2FtZXJhIGVudGl0eVxuICAgKiBAcGFyYW0gZGVsdGFUaW1lIC0gVGltZSBlbGFwc2VkIHNpbmNlIGxhc3QgdXBkYXRlIGluIHNlY29uZHNcbiAgICovXG4gIHVwZGF0ZShlbnRpdHk6IENhbWVyYSwgZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgICBjb25zdCB7IHNwZWVkIH0gPSB0aGlzO1xuICAgIGNvbnN0IGRlbHRhU3BlZWQgPSBNYXRoLm1pbihkZWx0YVRpbWUgKiBzcGVlZCwgMSk7XG5cbiAgICAvLyBUcmFjayBpZiBzY2FsZSBpcyBhY3RpdmVseSBjaGFuZ2luZyAoem9vbWluZylcbiAgICBjb25zdCBpc1pvb21pbmcgPSBNYXRoLmFicyhlbnRpdHkuc2NhbGUueCAtIGVudGl0eS5kZXNpcmVkU2NhbGUueCkgPiAwLjAxIHx8XG4gICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZW50aXR5LnNjYWxlLnkgLSBlbnRpdHkuZGVzaXJlZFNjYWxlLnkpID4gMC4wMTtcblxuICAgIC8vIEludGVycG9sYXRlIHNjYWxlIHZhbHVlcyBmaXJzdFxuICAgIGlmIChlbnRpdHkuZGVzaXJlZFNjYWxlICE9PSBlbnRpdHkuc2NhbGUpIHtcbiAgICAgIGVudGl0eS5zY2FsZS54ID0gbGVycChlbnRpdHkuc2NhbGUueCwgZW50aXR5LmRlc2lyZWRTY2FsZS54LCBkZWx0YVNwZWVkKTtcbiAgICAgIGVudGl0eS5zY2FsZS55ID0gbGVycChlbnRpdHkuc2NhbGUueSwgZW50aXR5LmRlc2lyZWRTY2FsZS55LCBkZWx0YVNwZWVkKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgZGVzaXJlZCBwb3NpdGlvbiBpZiBjYW1lcmEgaGFzIGEgdGFyZ2V0XG4gICAgaWYgKHRoaXMudGFyZ2V0KSB7XG4gICAgICAvLyBJbiBhIFBJWEkuanMgY2FtZXJhIHN5c3RlbSwgd2UgbmVlZCB0byBwb3NpdGlvbiB0aGUgY2FtZXJhIChzY2VuZSlcbiAgICAgIC8vIHNvIHRoYXQgdGhlIHRhcmdldCBhcHBlYXJzIGNlbnRlcmVkIGluIHRoZSB2aWV3cG9ydFxuXG4gICAgICAvLyBHZXQgdGhlIGNlbnRlciBvZiB0aGUgdmlld3BvcnQgaW4gc2NyZWVuIGNvb3JkaW5hdGVzXG4gICAgICBjb25zdCBzY3JlZW5DZW50ZXJYID0gdGhpcy5yZW5kZXJlci53aWR0aCAvIDI7XG4gICAgICBjb25zdCBzY3JlZW5DZW50ZXJZID0gdGhpcy5yZW5kZXJlci5oZWlnaHQgLyAyO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgd2hlcmUgdGhlIHNjZW5lIHNob3VsZCBiZSBwb3NpdGlvbmVkXG4gICAgICAvLyBUaGUgZm9ybXVsYSBpczogLSh0YXJnZXRQb3NpdGlvbiAqIHNjYWxlKSArIHNjcmVlbkNlbnRlclxuICAgICAgLy8gVGhpcyBlbnN1cmVzIHRoZSB0YXJnZXQgaXMgYXQgdGhlIGNlbnRlciBvZiB0aGUgc2NyZWVuXG4gICAgICBjb25zdCBkZXNpcmVkWCA9IC0odGhpcy50YXJnZXQucG9zaXRpb24ueCAqIGVudGl0eS5zY2FsZS54KSArIHNjcmVlbkNlbnRlclg7XG4gICAgICBjb25zdCBkZXNpcmVkWSA9IC0odGhpcy50YXJnZXQucG9zaXRpb24ueSAqIGVudGl0eS5zY2FsZS55KSArIHNjcmVlbkNlbnRlclk7XG5cbiAgICAgIC8vIFNldCBkZXNpcmVkIHBvc2l0aW9uIGZvciB0aGUgc2NlbmUgKHVzaW5nIG5lZ2F0aXZlIHZhbHVlcyBmb3IgY2FtZXJhIGNvb3JkaW5hdGVzKVxuICAgICAgZW50aXR5LmRlc2lyZWRQb3NpdGlvbi5zZXQoLWRlc2lyZWRYLCAtZGVzaXJlZFkpO1xuICAgIH1cblxuICAgIC8vIEludGVycG9sYXRlIHBvc2l0aW9uIHZhbHVlc1xuICAgIC8vIFdoZW4gYWN0aXZlbHkgem9vbWluZywgdXBkYXRlIHBvc2l0aW9uIGluc3RhbnRseSB0byBrZWVwIHRhcmdldCBjZW50ZXJlZFxuICAgIC8vIE90aGVyd2lzZSwgaW50ZXJwb2xhdGUgc21vb3RobHkgZm9yIGNhbWVyYSBmb2xsb3dpbmdcbiAgICBpZiAoZW50aXR5LmRlc2lyZWRQb3NpdGlvbiAhPT0gZW50aXR5LnBvc2l0aW9uKSB7XG4gICAgICBpZiAoaXNab29taW5nKSB7XG4gICAgICAgIC8vIEluc3RhbnQgcG9zaXRpb24gdXBkYXRlIGR1cmluZyB6b29tIHRvIHByZXZlbnQgdGFyZ2V0IGRyaWZ0XG4gICAgICAgIGVudGl0eS5wb3NpdGlvbi5jb3B5RnJvbShlbnRpdHkuZGVzaXJlZFBvc2l0aW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFNtb290aCBpbnRlcnBvbGF0aW9uIGZvciBub3JtYWwgY2FtZXJhIGZvbGxvd2luZ1xuICAgICAgICBlbnRpdHkucG9zaXRpb24ueCA9IGxlcnAoZW50aXR5LnBvc2l0aW9uLngsIGVudGl0eS5kZXNpcmVkUG9zaXRpb24ueCwgZGVsdGFTcGVlZCk7XG4gICAgICAgIGVudGl0eS5wb3NpdGlvbi55ID0gbGVycChlbnRpdHkucG9zaXRpb24ueSwgZW50aXR5LmRlc2lyZWRQb3NpdGlvbi55LCBkZWx0YVNwZWVkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gQXBwbHkgY2FtZXJhIHRyYW5zZm9ybWF0aW9ucyB0byB0aGUgc2NlbmVcbiAgICAvLyBJbiBQSVhJLCB0aGUgXCJjYW1lcmFcIiBlZmZlY3QgaXMgY3JlYXRlZCBieSB0cmFuc2Zvcm1pbmcgdGhlIHNjZW5lIGluIHRoZSBvcHBvc2l0ZSBkaXJlY3Rpb25cbiAgICBlbnRpdHkuc2NlbmUuc2NhbGUuc2V0KGVudGl0eS5zY2FsZS54LCBlbnRpdHkuc2NhbGUueSk7XG5cbiAgICAvLyBQb3NpdGlvbiB0aGUgc2NlbmUgYXQgdGhlIG5lZ2F0aXZlIG9mIHRoZSBjYW1lcmEgcG9zaXRpb24gdG8gY3JlYXRlIGNhbWVyYSBtb3ZlbWVudCBlZmZlY3RcbiAgICBlbnRpdHkuc2NlbmUucG9zaXRpb24uc2V0KC1lbnRpdHkucG9zaXRpb24ueCwgLWVudGl0eS5wb3NpdGlvbi55KTtcbiAgfVxufVxuXG4vKipcbiAqIENhbWVyYSBlbnRpdHkgZm9yIGNvbnRyb2xsaW5nIHRoZSB2aWV3cG9ydCBhbmQgZm9sbG93aW5nIGdhbWUgb2JqZWN0cy5cbiAqIFRoZSBDYW1lcmEgYXBwbGllcyB0cmFuc2Zvcm1hdGlvbnMgdG8gdGhlIHNjZW5lIHRvIHNpbXVsYXRlIGNhbWVyYSBtb3ZlbWVudC5cbiAqIFxuICogQGNhdGVnb3J5IENvcmVcbiAqIEBpbXBsZW1lbnRzIHtBc0VudGl0eTxQSVhJLkNvbnRhaW5lcj59XG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiAvLyBNYWtlIHRoZSBjYW1lcmEgZm9sbG93IGEgcGxheWVyIGVudGl0eVxuICogY2FtZXJhLm1veGlFbnRpdHkuZ2V0TG9naWM8Q2FtZXJhTG9naWM+KCdDYW1lcmFMb2dpYycpLnRhcmdldCA9IHBsYXllcjtcbiAqIFxuICogLy8gU2V0IHRoZSBjYW1lcmEgem9vbSBsZXZlbFxuICogY2FtZXJhLmRlc2lyZWRTY2FsZS5zZXQoMiwgMik7IC8vIDJ4IHpvb21cbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgQ2FtZXJhIGV4dGVuZHMgUElYSS5Db250YWluZXIgaW1wbGVtZW50cyBBc0VudGl0eTxQSVhJLkNvbnRhaW5lcj4ge1xuICAvKipcbiAgICogUmVmZXJlbmNlIHRvIHRoZSBzY2VuZSBiZWluZyB2aWV3ZWQgYnkgdGhpcyBjYW1lcmFcbiAgICovXG4gIHB1YmxpYyBzY2VuZTogU2NlbmU7XG4gIFxuICAvKipcbiAgICogUmVmZXJlbmNlIHRvIHRoZSByZW5kZXJlclxuICAgKi9cbiAgcHVibGljIHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyO1xuICBcbiAgLyoqXG4gICAqIFNwZWVkIGF0IHdoaWNoIHRoZSBjYW1lcmEgdHJhbnNpdGlvbnNcbiAgICogQGRlZmF1bHQgMC4xXG4gICAqL1xuICBwdWJsaWMgc3BlZWQ6IG51bWJlciA9IDAuMTtcbiAgXG4gIC8qKlxuICAgKiBNb3hpRW50aXR5IHJlZmVyZW5jZSBhcyByZXF1aXJlZCBieSB0aGUgQXNFbnRpdHkgaW50ZXJmYWNlXG4gICAqL1xuICBwdWJsaWMgbW94aUVudGl0eTogTW94aUVudGl0eTxQSVhJLkNvbnRhaW5lcj47XG4gIFxuICAvKipcbiAgICogVGhlIHRhcmdldCBzY2FsZSAoem9vbSkgZm9yIHRoZSBjYW1lcmFcbiAgICogQGRlZmF1bHQgbmV3IFBvaW50KDEsIDEpXG4gICAqL1xuICBwdWJsaWMgZGVzaXJlZFNjYWxlOiBQb2ludCA9IG5ldyBQb2ludCgxLCAxKTtcbiAgXG4gIC8qKlxuICAgKiBUaGUgdGFyZ2V0IHBvc2l0aW9uIGZvciB0aGUgY2FtZXJhXG4gICAqIEBkZWZhdWx0IG5ldyBQb2ludCgwLCAwKVxuICAgKi9cbiAgcHVibGljIGRlc2lyZWRQb3NpdGlvbjogUG9pbnQgPSBuZXcgUG9pbnQoMCwgMCk7IFxuICBcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgQ2FtZXJhIGluc3RhbmNlXG4gICAqIEBwYXJhbSBzY2VuZSAtIFRoZSBzY2VuZSBiZWluZyB2aWV3ZWQgYnkgdGhpcyBjYW1lcmFcbiAgICogQHBhcmFtIHJlbmRlcmVyIC0gVGhlIFBJWEkgcmVuZGVyZXJcbiAgICogQHBhcmFtIGxvZ2ljIC0gQWRkaXRpb25hbCBsb2dpYyB0byBhdHRhY2ggdG8gdGhpcyBjYW1lcmFcbiAgICovXG4gIGNvbnN0cnVjdG9yKHNjZW5lOiBTY2VuZSwgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXIsIGxvZ2ljOiBNb3hpTG9naWM8UElYSS5Db250YWluZXI+ID0ge30pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuc2NlbmUgPSBzY2VuZTtcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG5cbiAgICAvLyBJbml0aWFsaXplIGFuZCBhdHRhY2ggdGhlIGNhbWVyYSBsb2dpY1xuICAgIGNvbnN0IGNhbWVyYUxvZ2ljID0gbmV3IENhbWVyYUxvZ2ljKCk7XG4gICAgY2FtZXJhTG9naWMuaW5pdCh0aGlzLCByZW5kZXJlcik7XG4gICAgdGhpcy5tb3hpRW50aXR5ID0gbmV3IE1veGlFbnRpdHk8UElYSS5Db250YWluZXI+KHRoaXMsIGxvZ2ljKTtcbiAgICB0aGlzLm1veGlFbnRpdHkuYWRkTG9naWMoY2FtZXJhTG9naWMpO1xuICAgIHRoaXMuc2NlbmUuYWRkQ2hpbGQodGhpcyk7XG4gIH1cbn0gIFxuXG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFNjZW5lIH0gZnJvbSAnLi9zY2VuZSc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NXb3JsZCB9IGZyb20gJy4uL2xpYnJhcnkvcGh5c2ljcyc7XG5cbi8qKlxuICogVGhlIGNvcmUgZ2FtZSBlbmdpbmUgY2xhc3MgdGhhdCBtYW5hZ2VzIHRoZSBnYW1lIGxvb3AsIHNjZW5lIHJlbmRlcmluZyxcbiAqIGFuZCB1cGRhdGUgY3ljbGVzLiBDb29yZGluYXRlcyB3aXRoIHRoZSBQSVhJLlRpY2tlciB0byBkcml2ZSB0aGUgYW5pbWF0aW9uLlxuICpcbiAqIEBjYXRlZ29yeSBDb3JlXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogLy8gQ3JlYXRlIGEgbmV3IGVuZ2luZSB3aXRoIGEgc2NlbmVcbiAqIGNvbnN0IGVuZ2luZSA9IG5ldyBFbmdpbmUoc2NlbmUpO1xuICpcbiAqIC8vIFN0YXJ0IHRoZSBnYW1lIGxvb3BcbiAqIGVuZ2luZS5zdGFydCgpO1xuICpcbiAqIC8vIFN0b3AgdGhlIGdhbWUgbG9vcCB3aGVuIG5lZWRlZFxuICogZW5naW5lLnN0b3AoKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgRW5naW5lIHtcbiAgLyoqXG4gICAqIFRoZSBQSVhJIFRpY2tlciBpbnN0YW5jZSB0aGF0IGRyaXZlcyB0aGUgZ2FtZSBsb29wXG4gICAqL1xuICB0aWNrZXI6IFBJWEkuVGlja2VyO1xuXG4gIC8qKlxuICAgKiBUaGUgY3VycmVudCBhY3RpdmUgc2NlbmUvc3RhZ2VcbiAgICovXG4gIHJvb3Q6IFNjZW5lO1xuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBwaHlzaWNzIHdvcmxkIGluc3RhbmNlXG4gICAqL1xuICBwaHlzaWNzV29ybGQ/OiBQaHlzaWNzV29ybGQ7XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsIGxvZ2dpbmcgZnVuY3Rpb24gZm9yIGRlYnVnZ2luZ1xuICAgKi9cbiAgbG9nZ2VyOiAobXNnOiBzdHJpbmcpID0+IHZvaWQ7XG5cbiAgLyoqXG4gICAqIEhvdyBvZnRlbiB0byBsb2cgbWVzc2FnZXMgKGluIG1pbGxpc2Vjb25kcylcbiAgICovXG4gIGxvZ2dlckZyZXF1ZW5jeU1zOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRpbWVzdGFtcCBmb3IgdGhlIG5leHQgbG9nIG1lc3NhZ2VcbiAgICogQGludGVybmFsXG4gICAqL1xuICBuZXh0TG9nVGltZTogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IEVuZ2luZSBpbnN0YW5jZVxuICAgKiBcbiAgICogQHBhcmFtIHN0YWdlIC0gVGhlIGluaXRpYWwgc2NlbmUgdG8gdXNlLCBpZiBhbnlcbiAgICovXG4gIGNvbnN0cnVjdG9yKHN0YWdlOiBTY2VuZSA9IG51bGwpIHtcbiAgICB0aGlzLnJvb3QgPSBzdGFnZTtcblxuICAgIGNvbnN0IHRpY2tlciA9IFBJWEkuVGlja2VyLnNoYXJlZDtcbiAgICB0aWNrZXIuYXV0b1N0YXJ0ID0gZmFsc2U7XG4gICAgdGlja2VyLmFkZCh0aGlzLmdhbWVMb29wKTtcbiAgICB0aGlzLnRpY2tlciA9IHRpY2tlcjtcblxuICAgIHRoaXMubG9nZ2VyRnJlcXVlbmN5TXMgPSA1MDA7XG4gICAgdGhpcy5uZXh0TG9nVGltZSA9IDA7XG4gICAgdGhpcy5sb2dnZXIgPSAobXNnKSA9PiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0cyB0aGUgZ2FtZSBsb29wXG4gICAqIFxuICAgKiBAcmV0dXJucyBUaGUgRW5naW5lIGluc3RhbmNlIGZvciBjaGFpbmluZ1xuICAgKi9cbiAgc3RhcnQoKSB7XG4gICAgdGhpcy50aWNrZXIuc3RhcnQoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wcyB0aGUgZ2FtZSBsb29wXG4gICAqIFxuICAgKiBAcmV0dXJucyBUaGUgRW5naW5lIGluc3RhbmNlIGZvciBjaGFpbmluZ1xuICAgKi9cbiAgc3RvcCgpIHtcbiAgICB0aGlzLnRpY2tlci5zdG9wKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQWRkIHBoeXNpY3Mgd29ybGQgdG8gZW5naW5lXG4gICAqXG4gICAqIEBwYXJhbSBwaHlzaWNzV29ybGQgLSBUaGUgcGh5c2ljcyB3b3JsZCBpbnN0YW5jZVxuICAgKiBAcmV0dXJucyBUaGUgRW5naW5lIGluc3RhbmNlIGZvciBjaGFpbmluZ1xuICAgKi9cbiAgYWRkUGh5c2ljc1dvcmxkKHBoeXNpY3NXb3JsZDogUGh5c2ljc1dvcmxkKSB7XG4gICAgdGhpcy5waHlzaWNzV29ybGQgPSBwaHlzaWNzV29ybGQ7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogVGhlIG1haW4gZ2FtZSBsb29wIGZ1bmN0aW9uIGNhbGxlZCBieSB0aGUgdGlja2VyIG9uIGVhY2ggZnJhbWVcbiAgICogVXBkYXRlcyBhbmQgcmVuZGVycyB0aGUgYWN0aXZlIHNjZW5lXG4gICAqXG4gICAqIEBwYXJhbSB0aWtlclRpbWUgLSBUaWNrZXIgaW5mb3JtYXRpb24gaW5jbHVkaW5nIGRlbHRhIHRpbWVcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdhbWVMb29wID0gKHRpa2VyVGltZTogUElYSS5UaWNrZXIpID0+IHtcbiAgICBpZiAodGhpcy5yb290KSB7XG4gICAgICBjb25zdCB7IGRlbHRhVGltZSwgZGVsdGFNUyB9ID0gdGlrZXJUaW1lO1xuXG4gICAgICAvLyAxLiBVcGRhdGUgcGh5c2ljcyBzaW11bGF0aW9uIEZJUlNUIChuZWVkcyBkZWx0YVRpbWUgaW4gc2Vjb25kcylcbiAgICAgIGlmICh0aGlzLnBoeXNpY3NXb3JsZCkge1xuICAgICAgICBjb25zdCBkZWx0YVNlY29uZHMgPSBkZWx0YU1TIC8gMTAwMDtcbiAgICAgICAgdGhpcy5waHlzaWNzV29ybGQuc3RlcChkZWx0YVNlY29uZHMpO1xuICAgICAgfVxuXG4gICAgICAvLyAyLiBUaGVuIHVwZGF0ZSBhbGwgbG9naWMgY29tcG9uZW50cyAodGhleSB1c2UgZnJhbWUtYmFzZWQgZGVsdGFUaW1lKVxuICAgICAgdGhpcy5yb290LnVwZGF0ZShkZWx0YVRpbWUpO1xuICAgICAgdGhpcy5yb290LmRyYXcoZGVsdGFUaW1lKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldHMgYSBuZXcgYWN0aXZlIHNjZW5lXG4gICAqIFxuICAgKiBAcGFyYW0gc3RhZ2UgLSBUaGUgbmV3IHNjZW5lIHRvIHVzZVxuICAgKiBAcmV0dXJucyBUaGUgRW5naW5lIGluc3RhbmNlIGZvciBjaGFpbmluZ1xuICAgKi9cbiAgbG9hZFN0YWdlKHN0YWdlOiBTY2VuZSkge1xuICAgIHRoaXMucm9vdCA9IHN0YWdlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG4iLCJ0eXBlIE1veGlFdmVudHM8VCBleHRlbmRzIHN0cmluZyB8IHN5bWJvbCA9IHN0cmluZywgQSA9IGFueT4gPSB7XG4gIFtldmVudCBpbiBUXTogKC4uLmFyZ3M6IEEgZXh0ZW5kcyBhbnlbXSA/IEEgOiBbQV0pID0+IHZvaWQ7XG59O1xuXG5leHBvcnQgY2xhc3MgRXZlbnRFbWl0dGVyPFQgZXh0ZW5kcyBNb3hpRXZlbnRzID0gTW94aUV2ZW50cz4ge1xuICBwcml2YXRlIGxpc3RlbmVyczogeyBbSyBpbiBrZXlvZiBUXT86IFRbS11bXSB9ID0ge307XG4gIFxuICAvKipcbiAgICogU2luZ2xldG9uIGluc3RhbmNlIG9mIEV2ZW50RW1pdHRlclxuICAgKiBAc3RhdGljXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGluc3RhbmNlOiBFdmVudEVtaXR0ZXI8TW94aUV2ZW50cz4gPSBuZXcgRXZlbnRFbWl0dGVyPE1veGlFdmVudHM+KCk7XG5cbiAgb248SyBleHRlbmRzIGtleW9mIFQ+KGV2ZW50OiBLLCBsaXN0ZW5lcjogVFtLXSk6IHZvaWQge1xuICAgICh0aGlzLmxpc3RlbmVyc1tldmVudF0gfHwgKHRoaXMubGlzdGVuZXJzW2V2ZW50XSA9IFtdKSkucHVzaChsaXN0ZW5lcik7XG4gIH1cblxuICBvZmY8SyBleHRlbmRzIGtleW9mIFQ+KGV2ZW50OiBLLCBsaXN0ZW5lcjogVFtLXSk6IHZvaWQge1xuICAgIGNvbnN0IGV2ZW50TGlzdGVuZXJzID0gdGhpcy5saXN0ZW5lcnNbZXZlbnRdO1xuICAgIGlmIChldmVudExpc3RlbmVycykge1xuICAgICAgdGhpcy5saXN0ZW5lcnNbZXZlbnRdID0gZXZlbnRMaXN0ZW5lcnMuZmlsdGVyKGwgPT4gbCAhPT0gbGlzdGVuZXIpO1xuICAgIH1cbiAgfVxuXG4gIGVtaXQ8SyBleHRlbmRzIGtleW9mIFQ+KGV2ZW50OiBLLCAuLi5hcmdzOiBQYXJhbWV0ZXJzPFRbS10+KTogdm9pZCB7XG4gICAgKHRoaXMubGlzdGVuZXJzW2V2ZW50XSB8fCBbXSkuZm9yRWFjaChsaXN0ZW5lciA9PiBsaXN0ZW5lciguLi5hcmdzKSk7XG4gIH1cblxuICBvbmNlPEsgZXh0ZW5kcyBrZXlvZiBUPihldmVudDogSywgbGlzdGVuZXI6IFRbS10pOiB2b2lkIHtcbiAgICBjb25zdCBvbmNlTGlzdGVuZXIgPSAoLi4uYXJnczogUGFyYW1ldGVyczxUW0tdPikgPT4ge1xuICAgICAgbGlzdGVuZXIoLi4uYXJncyk7XG4gICAgICB0aGlzLm9mZihldmVudCwgbGlzdGVuZXIpO1xuICAgIH07XG4gICAgdGhpcy5vbihldmVudCwgb25jZUxpc3RlbmVyIGFzIFRbS10pO1xuICB9XG4gIFxuICAvKipcbiAgICogR2V0IHRoZSBzaW5nbGV0b24gaW5zdGFuY2Ugb2YgRXZlbnRFbWl0dGVyXG4gICAqIEBzdGF0aWNcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2U8VCBleHRlbmRzIE1veGlFdmVudHMgPSBNb3hpRXZlbnRzPigpOiBFdmVudEVtaXR0ZXI8VD4ge1xuICAgIGlmICghRXZlbnRFbWl0dGVyLmluc3RhbmNlKSB7XG4gICAgICBFdmVudEVtaXR0ZXIuaW5zdGFuY2UgPSBuZXcgRXZlbnRFbWl0dGVyPFQ+KCk7XG4gICAgfVxuICAgIHJldHVybiBFdmVudEVtaXR0ZXIuaW5zdGFuY2UgYXMgRXZlbnRFbWl0dGVyPFQ+O1xuICB9XG59XG5cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuXG4vKipcbiAqIEJhc2UgYWJzdHJhY3QgY2xhc3MgZm9yIGFsbCBsb2dpYyBpbiB0aGUgTW94aSBlbmdpbmUuXG4gKiBMb2dpYyBjb21wb25lbnRzIGNhbiBiZSBhdHRhY2hlZCB0byBlbnRpdGllcyB0byBhZGQgZnVuY3Rpb25hbGl0eS5cbiAqIFxuICogQGNhdGVnb3J5IExvZ2ljXG4gKiBAdGVtcGxhdGUgVCAtIFRoZSB0eXBlIG9mIGVudGl0eSB0aGlzIGxvZ2ljIGNhbiBiZSBhdHRhY2hlZCB0b1xuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY2xhc3MgTXlMb2dpYyBleHRlbmRzIExvZ2ljPFNwcml0ZT4ge1xuICogICB1cGRhdGUoZW50aXR5OiBTcHJpdGUsIGRlbHRhVGltZTogbnVtYmVyKSB7XG4gKiAgICAgZW50aXR5LnJvdGF0aW9uICs9IGRlbHRhVGltZTtcbiAqICAgfVxuICogfVxuICogYGBgXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBMb2dpYzxUPiB7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGlzIGxvZ2ljIGNvbXBvbmVudFxuICAgKiBVc2VkIHRvIGlkZW50aWZ5IGFuZCByZXRyaWV2ZSBsb2dpYyBjb21wb25lbnRzXG4gICAqIERlZmF1bHRzIHRvIGNvbnN0cnVjdG9yIG5hbWUgYnV0IHNob3VsZCBiZSBzZXQgZXhwbGljaXRseSBmb3IgcHJvZHVjdGlvbiBidWlsZHNcbiAgICovXG4gIG5hbWU/OiBzdHJpbmc7XG4gIFxuICAvKipcbiAgICogV2hldGhlciB0aGlzIGxvZ2ljIGlzIGN1cnJlbnRseSBhY3RpdmUgYW5kIHNob3VsZCBiZSB1cGRhdGVkXG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIGFjdGl2ZTogYm9vbGVhbiA9IHRydWU7XG4gIFxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgdGhlIGxvZ2ljIHdpdGggdGhlIGVudGl0eSBpdCdzIGF0dGFjaGVkIHRvXG4gICAqIEBwYXJhbSBlbnRpdHkgLSBUaGUgZW50aXR5IHRoaXMgbG9naWMgaXMgYXR0YWNoZWQgdG9cbiAgICogQHBhcmFtIHJlbmRlcmVyIC0gVGhlIFBJWEkgcmVuZGVyZXIgaW5zdGFuY2VcbiAgICogQHBhcmFtIGFyZ3MgLSBBZGRpdGlvbmFsIGluaXRpYWxpemF0aW9uIGFyZ3VtZW50c1xuICAgKi9cbiAgaW5pdChlbnRpdHk/OiBULCByZW5kZXJlcj86IFBJWEkuUmVuZGVyZXI8SFRNTENhbnZhc0VsZW1lbnQ+LCAuLi5hcmdzOiBhbnlbXSkge1xuICAgIC8vIEltcGxlbWVudCBpbiBzdWJjbGFzc1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGxvZ2ljJ3Mgc3RhdGVcbiAgICogQHBhcmFtIGVudGl0eSAtIFRoZSBlbnRpdHkgdGhpcyBsb2dpYyBpcyBhdHRhY2hlZCB0b1xuICAgKiBAcGFyYW0gZGVsdGFUaW1lIC0gVGltZSBlbGFwc2VkIHNpbmNlIGxhc3QgdXBkYXRlIGluIHNlY29uZHNcbiAgICovXG4gIHVwZGF0ZShlbnRpdHk/OiBULCBkZWx0YVRpbWU/OiBudW1iZXIpIHtcbiAgICAvLyBJbXBsZW1lbnQgaW4gc3ViY2xhc3NcbiAgfVxufVxuXG4vKipcbiAqIExvZ2ljIHRoYXQgY2FuIGJlIGluc3RhbnRpYXRlZCBtdWx0aXBsZSB0aW1lcyB3aXRoIGRpZmZlcmVudCBjb25maWd1cmF0aW9uc1xuICogXG4gKiBAY2F0ZWdvcnkgTG9naWNcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgZW50aXR5IHRoaXMgbG9naWMgY2FuIGJlIGF0dGFjaGVkIHRvXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjbGFzcyBNeUluc3RhbmNlZExvZ2ljIGV4dGVuZHMgSW5zdGFuY2VkTG9naWM8U3ByaXRlPiB7XG4gKiAgIGNvbnN0cnVjdG9yKHB1YmxpYyBzcGVlZDogbnVtYmVyKSB7XG4gKiAgICAgc3VwZXIoKTtcbiAqICAgfVxuICogICBcbiAqICAgdXBkYXRlKGVudGl0eTogU3ByaXRlLCBkZWx0YVRpbWU6IG51bWJlcikge1xuICogICAgIGVudGl0eS5yb3RhdGlvbiArPSB0aGlzLnNwZWVkICogZGVsdGFUaW1lO1xuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIEluc3RhbmNlZExvZ2ljPFQ+IGV4dGVuZHMgTG9naWM8VD4ge31cblxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4vbG9naWMnO1xuXG4vKipcbiAqIEludGVyZmFjZSBkZWZpbmluZyB0aGUgY29udHJhY3QgZm9yIHRoZSBNb3hpRW50aXR5IGNsYXNzLlxuICogU3BlY2lmaWVzIHJlcXVpcmVkIG1ldGhvZHMgYW5kIHByb3BlcnRpZXMgZm9yIGVudGl0eSBtYW5hZ2VtZW50LlxuICogXG4gKiBAaW50ZXJuYWxcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgZW50aXR5IGJlaW5nIG1hbmFnZWRcbiAqL1xuaW50ZXJmYWNlIE1veGlFbnRpdHlDbGFzczxUPiB7XG4gIGxvZ2ljOiBNb3hpTG9naWM8VD47XG4gIHVwZGF0ZTogKGRlbHRhOiBudW1iZXIsIGVudGl0eTogVCkgPT4gdm9pZDtcbiAgaW5pdDogKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkO1xuICBhZGRMb2dpYzogKGxvZ2ljOiBMb2dpYzxUPikgPT4gdm9pZDtcbiAgZ2V0TG9naWM6IChuYW1lOiBzdHJpbmcpID0+IExvZ2ljPFQ+IHwgdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIFR5cGUgZGVmaW5pdGlvbiBmb3Igb2JqZWN0cyB0aGF0IGhhdmUgYmVlbiBlbmhhbmNlZCB3aXRoIE1veGlFbnRpdHkgY2FwYWJpbGl0aWVzLlxuICogVGhpcyBpcyB0aGUgcHJpbWFyeSBpbnRlcmZhY2UgZGV2ZWxvcGVycyB3aWxsIGludGVyYWN0IHdpdGggd2hlbiB1c2luZyB0aGUgZW50aXR5IHN5c3RlbS5cbiAqIFxuICogQGNhdGVnb3J5IEVudGl0aWVzXG4gKiBAdGVtcGxhdGUgVCAtIFRoZSB0eXBlIG9mIGVudGl0eSBiZWluZyBtYW5hZ2VkICh0eXBpY2FsbHkgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lcilcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIC8vIENyZWF0ZSBhIHNwcml0ZSBhbmQgY29udmVydCBpdCB0byBhbiBBc0VudGl0eVxuICogY29uc3Qgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xuICogY29uc3QgZW50aXR5U3ByaXRlID0gYXNFbnRpdHkoc3ByaXRlKTtcbiAqIFxuICogLy8gTm93IGl0IGhhcyBhIG1veGlFbnRpdHkgcHJvcGVydHlcbiAqIGVudGl0eVNwcml0ZS5tb3hpRW50aXR5LmFkZExvZ2ljKG5ldyBNb3ZlbWVudExvZ2ljKCkpO1xuICogYGBgXG4gKi9cbmV4cG9ydCB0eXBlIEFzRW50aXR5PFQ+ID0gUElYSS5Db250YWluZXIgJiB7XG4gIG1veGlFbnRpdHk6IE1veGlFbnRpdHk8VD47XG59O1xuXG4vKipcbiAqIFR5cGUgZGVmaW5pdGlvbiBmb3IgYSBjb2xsZWN0aW9uIG9mIGxvZ2ljIGNvbXBvbmVudHMgbWFwcGVkIGJ5IG5hbWUuXG4gKiBVc2VkIHRvIHN0b3JlIGFuZCByZXRyaWV2ZSBsb2dpYyBhdHRhY2hlZCB0byBlbnRpdGllcy5cbiAqIFxuICogQGNhdGVnb3J5IEVudGl0aWVzXG4gKiBAdGVtcGxhdGUgVCAtIFRoZSB0eXBlIG9mIGVudGl0eSB0aGVzZSBsb2dpYyBjb21wb25lbnRzIGNhbiBiZSBhcHBsaWVkIHRvXG4gKi9cbmV4cG9ydCB0eXBlIE1veGlMb2dpYzxUPiA9IFJlY29yZDxzdHJpbmcsIExvZ2ljPFQ+PjtcblxuLyoqXG4gKiBUaGUgY29yZSBlbnRpdHkgbWFuYWdlbWVudCBjbGFzcyB0aGF0IGhhbmRsZXMgY29tcG9uZW50LWJhc2VkIGxvZ2ljLlxuICogTW94aUVudGl0eSBjb25uZWN0cyBlbnRpdGllcyB3aXRoIHRoZWlyIGxvZ2ljIGNvbXBvbmVudHMgYW5kIG1hbmFnZXMgdGhlIGxvZ2ljIGxpZmVjeWNsZS5cbiAqIFxuICogVGhpcyBjbGFzcyBpbXBsZW1lbnRzIHRoZSBFbnRpdHktQ29tcG9uZW50LVN5c3RlbSBwYXR0ZXJuLCB3aGVyZTpcbiAqIC0gVGhlIGVudGl0eSBpcyB0aGUgb2JqZWN0IGJlaW5nIGNvbnRyb2xsZWQgKGxpa2UgYSBQSVhJLlNwcml0ZSlcbiAqIC0gTG9naWMgY29tcG9uZW50cyBhZGQgZnVuY3Rpb25hbGl0eVxuICogLSBUaGlzIGNsYXNzIHByb3ZpZGVzIHRoZSBzeXN0ZW0gdG8gbWFuYWdlIHRob3NlIGNvbXBvbmVudHNcbiAqIFxuICogQGNhdGVnb3J5IEVudGl0aWVzXG4gKiBAdGVtcGxhdGUgVCAtIFRoZSB0eXBlIG9mIGVudGl0eSBiZWluZyBtYW5hZ2VkXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiAvLyBDcmVhdGUgYSBzcHJpdGUgYW5kIGVudGl0eVxuICogY29uc3Qgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xuICogY29uc3QgZW50aXR5ID0gbmV3IE1veGlFbnRpdHkoc3ByaXRlKTtcbiAqIFxuICogLy8gQWRkIGxvZ2ljXG4gKiBlbnRpdHkuYWRkTG9naWMobmV3IE1vdmVtZW50TG9naWMoKSk7XG4gKiBlbnRpdHkuYWRkTG9naWMobmV3IEFuaW1hdGlvbkxvZ2ljKCkpO1xuICogXG4gKiAvLyBJbml0aWFsaXplIGFsbCBsb2dpY1xuICogZW50aXR5LmluaXQocmVuZGVyZXIpO1xuICogXG4gKiAvLyBVcGRhdGUgYWxsIGxvZ2ljICh1c3VhbGx5IGNhbGxlZCB3aXRoaW4gdGhlIGdhbWUgbG9vcClcbiAqIGVudGl0eS51cGRhdGUoZGVsdGFUaW1lKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgTW94aUVudGl0eTxUPiBpbXBsZW1lbnRzIE1veGlFbnRpdHlDbGFzczxUPiB7XG4gIC8qKlxuICAgKiBDb2xsZWN0aW9uIG9mIGxvZ2ljIGNvbXBvbmVudHMgYXR0YWNoZWQgdG8gdGhpcyBlbnRpdHlcbiAgICovXG4gIGxvZ2ljOiBNb3hpTG9naWM8VD4gPSB7fTtcbiAgXG4gIC8qKlxuICAgKiBSZWZlcmVuY2UgdG8gdGhlIGFjdHVhbCBlbnRpdHkgYmVpbmcgbWFuYWdlZFxuICAgKi9cbiAgZW50aXR5OiBUO1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IE1veGlFbnRpdHlcbiAgICogXG4gICAqIEBwYXJhbSBlbnRpdHkgLSBUaGUgZW50aXR5IHRvIG1hbmFnZVxuICAgKiBAcGFyYW0gbG9naWMgLSBPcHRpb25hbCBtYXAgb2YgaW5pdGlhbCBsb2dpYyB0byBhdHRhY2hcbiAgICovXG4gIGNvbnN0cnVjdG9yKGVudGl0eTogVCwgbG9naWM6IE1veGlMb2dpYzxUPiA9IHt9KSB7XG4gICAgdGhpcy5sb2dpYyA9IGxvZ2ljO1xuICAgIHRoaXMuZW50aXR5ID0gZW50aXR5O1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgYWxsIGFjdGl2ZSBsb2dpYyBjb21wb25lbnRzIGF0dGFjaGVkIHRvIHRoaXMgZW50aXR5XG4gICAqIFR5cGljYWxseSBjYWxsZWQgZWFjaCBmcmFtZSBkdXJpbmcgdGhlIGdhbWUgbG9vcFxuICAgKiBcbiAgICogQHBhcmFtIGRlbHRhVGltZSAtIFRpbWUgaW4gc2Vjb25kcyBzaW5jZSB0aGUgbGFzdCB1cGRhdGVcbiAgICogXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogLy8gSW4gZ2FtZSBsb29wXG4gICAqIGZ1bmN0aW9uIGdhbWVMb29wKGRlbHRhVGltZSkge1xuICAgKiAgIHBsYXllckVudGl0eS5tb3hpRW50aXR5LnVwZGF0ZShkZWx0YVRpbWUpO1xuICAgKiB9XG4gICAqIGBgYFxuICAgKi9cbiAgdXBkYXRlKGRlbHRhVGltZTogbnVtYmVyKSB7IFxuICAgIGZvciAoY29uc3QgY2xhc3NOYW1lIGluIHRoaXMubG9naWMpIHtcbiAgICAgIGNvbnN0IGxvZ2ljQ29tcG9uZW50ID0gdGhpcy5sb2dpY1tjbGFzc05hbWVdO1xuICAgICAgaWYobG9naWNDb21wb25lbnQudXBkYXRlICYmIHRoaXMuZW50aXR5ICYmIGxvZ2ljQ29tcG9uZW50LmFjdGl2ZSl7XG4gICAgICAgIGxvZ2ljQ29tcG9uZW50LnVwZGF0ZSh0aGlzLmVudGl0eSwgZGVsdGFUaW1lKTsgXG4gICAgICB9XG4gICAgfVxuICAgIC8vIFRPRE86IHVwZGF0ZSBjaGlsZHJlbj9cbiAgfVxuICBcbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIGFsbCBsb2dpYyBjb21wb25lbnRzIGF0dGFjaGVkIHRvIHRoaXMgZW50aXR5XG4gICAqIFR5cGljYWxseSBjYWxsZWQgb25jZSB3aGVuIHRoZSBlbnRpdHkgaXMgZmlyc3QgY3JlYXRlZCBvciBhZGRlZCB0byB0aGUgc2NlbmVcbiAgICogXG4gICAqIEBwYXJhbSByZW5kZXJlciAtIFRoZSBQSVhJIHJlbmRlcmVyIGluc3RhbmNlXG4gICAqIEBwYXJhbSBhcmdzIC0gQWRkaXRpb25hbCBhcmd1bWVudHMgdG8gcGFzcyB0byBlYWNoIGxvZ2ljIGNvbXBvbmVudCdzIGluaXQgbWV0aG9kXG4gICAqIFxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIC8vIFdoZW4gYWRkaW5nIGFuIGVudGl0eSB0byB0aGUgc2NlbmVcbiAgICogc2NlbmUuYWRkQ2hpbGQoZW50aXR5U3ByaXRlKTtcbiAgICogZW50aXR5U3ByaXRlLm1veGlFbnRpdHkuaW5pdChyZW5kZXJlcik7XG4gICAqIGBgYFxuICAgKi9cbiAgaW5pdChyZW5kZXJlcjogUElYSS5SZW5kZXJlcjxIVE1MQ2FudmFzRWxlbWVudD4sIC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgZm9yIChjb25zdCBjbGFzc05hbWUgaW4gdGhpcy5sb2dpYykge1xuICAgICAgY29uc3QgbG9naWNDb21wb25lbnQgPSB0aGlzLmxvZ2ljW2NsYXNzTmFtZV07XG4gICAgICBpZihsb2dpY0NvbXBvbmVudC5pbml0ICYmIHRoaXMuZW50aXR5KXtcbiAgICAgICAgbG9naWNDb21wb25lbnQuaW5pdCh0aGlzLmVudGl0eSwgcmVuZGVyZXIsIC4uLmFyZ3MpO1xuICAgICAgfVxuICAgIH1cbiAgfSBcblxuICAvKipcbiAgICogQWRkcyBhIGxvZ2ljIGNvbXBvbmVudCB0byB0aGlzIGVudGl0eVxuICAgKiBcbiAgICogQHBhcmFtIGxvZ2ljIC0gVGhlIGxvZ2ljIGNvbXBvbmVudCB0byBhZGRcbiAgICogXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogLy8gQ3JlYXRlIGFuZCBhZGQgbG9naWNcbiAgICogY29uc3QgbW92ZW1lbnRMb2dpYyA9IG5ldyBNb3ZlbWVudExvZ2ljKCk7XG4gICAqIG1vdmVtZW50TG9naWMuc3BlZWQgPSA1O1xuICAgKiBlbnRpdHlTcHJpdGUubW94aUVudGl0eS5hZGRMb2dpYyhtb3ZlbWVudExvZ2ljKTtcbiAgICogYGBgXG4gICAqL1xuICBhZGRMb2dpYyhsb2dpYzogTG9naWM8VD4pIHtcbiAgICAvLyBVc2UgZXhwbGljaXQgbmFtZSBpZiBzZXQsIG90aGVyd2lzZSBmYWxsIGJhY2sgdG8gY29uc3RydWN0b3IgbmFtZVxuICAgIGNvbnN0IGxvZ2ljTmFtZSA9IGxvZ2ljLm5hbWUgfHwgbG9naWMuY29uc3RydWN0b3IubmFtZTtcbiAgICB0aGlzLmxvZ2ljW2xvZ2ljTmFtZV0gPSBsb2dpYztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgYSBsb2dpYyBjb21wb25lbnQgYnkgbmFtZVxuICAgKiBVc2VmdWwgZm9yIGFjY2Vzc2luZyBhbmQgY29uZmlndXJpbmcgc3BlY2lmaWMgbG9naWMgY29tcG9uZW50c1xuICAgKiBcbiAgICogQHRlbXBsYXRlIEwgLSBUaGUgdHlwZSBvZiBsb2dpYyB0byByZXR1cm5cbiAgICogQHBhcmFtIG5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgbG9naWMgdG8gcmV0cmlldmUgKHVzdWFsbHkgdGhlIGNsYXNzIG5hbWUpXG4gICAqIEByZXR1cm5zIFRoZSBsb2dpYyBpbnN0YW5jZSwgb3IgdW5kZWZpbmVkIGlmIG5vdCBmb3VuZFxuICAgKiBcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiAvLyBHZXQgYW5kIGNvbmZpZ3VyZSBsb2dpY1xuICAgKiBjb25zdCBtb3ZlbWVudCA9IGVudGl0eVNwcml0ZS5tb3hpRW50aXR5LmdldExvZ2ljPE1vdmVtZW50TG9naWM+KCdNb3ZlbWVudExvZ2ljJyk7XG4gICAqIGlmIChtb3ZlbWVudCkge1xuICAgKiAgIG1vdmVtZW50LnNwZWVkID0gMTA7XG4gICAqICAgbW92ZW1lbnQuZGlyZWN0aW9uID0gJ3JpZ2h0JztcbiAgICogfVxuICAgKiBgYGBcbiAgICovXG4gIGdldExvZ2ljPEwgZXh0ZW5kcyBMb2dpYzxUPj4obmFtZTogc3RyaW5nKTogTCB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMubG9naWNbbmFtZV0gYXMgTCB8IHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBjb252ZXJ0IGEgUElYSSBDb250YWluZXIgaW50byBhbiBBc0VudGl0eVxuICogVGhpcyBpcyB0aGUgcHJpbWFyeSB3YXkgdG8gY3JlYXRlIGVudGl0aWVzIGluIE1veGlcbiAqIFxuICogQGNhdGVnb3J5IEVudGl0aWVzXG4gKiBAdGVtcGxhdGUgVCAtIFRoZSB0eXBlIG9mIGNvbnRhaW5lciBiZWluZyBjb252ZXJ0ZWRcbiAqIEBwYXJhbSBlbnRpdHkgLSBUaGUgUElYSSBDb250YWluZXIgdG8gY29udmVydFxuICogQHBhcmFtIGxvZ2ljIC0gT3B0aW9uYWwgaW5pdGlhbCBsb2dpYyB0byBhdHRhY2hcbiAqIEByZXR1cm5zIFRoZSBlbmhhbmNlZCBjb250YWluZXIgYXMgYW4gQXNFbnRpdHlcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIC8vIEJhc2ljIHVzYWdlXG4gKiBjb25zdCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gKiBjb25zdCBlbnRpdHlTcHJpdGUgPSBhc0VudGl0eShzcHJpdGUpO1xuICogc2NlbmUuYWRkQ2hpbGQoZW50aXR5U3ByaXRlKTtcbiAqIFxuICogLy8gV2l0aCBpbml0aWFsIGxvZ2ljXG4gKiBjb25zdCBwbGF5ZXIgPSBhc0VudGl0eShcbiAqICAgbmV3IFBJWEkuU3ByaXRlKHBsYXllclRleHR1cmUpLFxuICogICB7XG4gKiAgICAgJ1BsYXllck1vdmVtZW50JzogbmV3IFBsYXllck1vdmVtZW50TG9naWMoKSxcbiAqICAgICAnSGVhbHRoJzogbmV3IEhlYWx0aExvZ2ljKDEwMClcbiAqICAgfVxuICogKTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNFbnRpdHk8VCBleHRlbmRzIFBJWEkuQ29udGFpbmVyPihlbnRpdHk6IFQsIGxvZ2ljOiBNb3hpTG9naWM8VD4gPSB7fSk6IEFzRW50aXR5PFQ+IHtcbiAgY29uc3QgdGFyZ2V0ID0gZW50aXR5O1xuICBcbiAgLy8gcGl4aSBwYXRjaDogaXQncyB0aHJvd2luZyBhbiBlcnJvciBvbiBpbnRlcmFjdGl2ZSBldmVudHMgaWYgaXNJbnRlcmFjdGl2ZSgpIGRvZXNuJ3QgZXhpc3QuXG4gIHRhcmdldC5pc0ludGVyYWN0aXZlID0gKCkgPT4gZmFsc2U7IFxuXG4gICh0YXJnZXQgYXMgdW5rbm93biBhcyBBc0VudGl0eTxUPikubW94aUVudGl0eSA9IG5ldyBNb3hpRW50aXR5PFQ+KHRhcmdldCwgbG9naWMpO1xuICByZXR1cm4gZW50aXR5IGFzIHVua25vd24gYXMgQXNFbnRpdHk8VD47XG59XG5cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuXG5leHBvcnQgY2xhc3MgUmVuZGVyTWFuYWdlciB7XG4gIHN0YXRpYyBnZXRSZW5kZXJlcjogKFxuICAgIG9wdGlvbnM6IFBhcnRpYWw8UElYSS5BdXRvRGV0ZWN0T3B0aW9ucz5cbiAgKSA9PiBQcm9taXNlPFBJWEkuUmVuZGVyZXI+O1xuXG4gIHN0YXRpYyBjcmVhdGU6IChcbiAgICAgIGh0bWxSb290OiBIVE1MRWxlbWVudCwgXG4gICAgICBvcHRpb25zOiBQYXJ0aWFsPFBJWEkuQXV0b0RldGVjdE9wdGlvbnM+KSA9PiBQcm9taXNlPFJlbmRlck1hbmFnZXI+O1xuXG4gIGh0bWxSb290OiBIVE1MRWxlbWVudDtcbiAgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI7XG4gIGZpdFRvV2luZG93ID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoaHRtbFJvb3Q6IEhUTUxFbGVtZW50LCByZW5kZXJlcjogUElYSS5SZW5kZXJlcikge1xuICAgIHRoaXMuaHRtbFJvb3QgPSBodG1sUm9vdDtcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG5cbiAgICBodG1sUm9vdC5hcHBlbmRDaGlsZCh0aGlzLnJlbmRlcmVyLmNhbnZhcyk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHRoaXMub25SZXNpemUoKSk7XG4gICAgdGhpcy5vblJlc2l6ZSgpO1xuICB9XG5cbiAgcmVuZGVyKHN0YWdlOiBQSVhJLkNvbnRhaW5lcikge1xuICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHN0YWdlKTtcbiAgfVxuXG4gIG9uUmVzaXplID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVuZGVyZXIsIGh0bWxSb290OiByb290IH0gPSB0aGlzO1xuICAgIGNvbnN0IGNhbnZhcyA9IHJlbmRlcmVyLmNhbnZhcztcbiAgICBcbiAgICAvLyBHZXQgdGhlIHBhcmVudCBkaW1lbnNpb25zXG4gICAgY29uc3QgcGFyZW50V2lkdGggPSByb290LmNsaWVudFdpZHRoO1xuICAgIGNvbnN0IHBhcmVudEhlaWdodCA9IHJvb3QuY2xpZW50SGVpZ2h0O1xuICAgIFxuICAgIC8vIEdldCB0aGUgY2FudmFzJ3MgaW50ZW5kZWQgZGltZW5zaW9uc1xuICAgIGNvbnN0IGNhbnZhc1dpZHRoID0gcmVuZGVyZXIud2lkdGg7XG4gICAgY29uc3QgY2FudmFzSGVpZ2h0ID0gcmVuZGVyZXIuaGVpZ2h0O1xuICAgIFxuICAgIC8vIENhbGN1bGF0ZSB0aGUgc2NhbGUgdG8gZml0IHdoaWxlIG1haW50YWluaW5nIGFzcGVjdCByYXRpb1xuICAgIGNvbnN0IHNjYWxlID0gTWF0aC5taW4oXG4gICAgICBwYXJlbnRXaWR0aCAvIGNhbnZhc1dpZHRoLFxuICAgICAgcGFyZW50SGVpZ2h0IC8gY2FudmFzSGVpZ2h0XG4gICAgKTtcbiAgICBcbiAgICAvLyBTZXQgQ1NTIGRpbWVuc2lvbnMgdG8gc2NhbGUgdGhlIGNhbnZhc1xuICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9IGAke01hdGguZmxvb3IoY2FudmFzV2lkdGggKiBzY2FsZSl9cHhgO1xuICAgIGNhbnZhcy5zdHlsZS5oZWlnaHQgPSBgJHtNYXRoLmZsb29yKGNhbnZhc0hlaWdodCAqIHNjYWxlKX1weGA7XG4gIH07XG59XG5cblJlbmRlck1hbmFnZXIuZ2V0UmVuZGVyZXIgPSBhc3luYyAob3B0aW9uczogUGFydGlhbDxQSVhJLkF1dG9EZXRlY3RPcHRpb25zPikgPT4gKFxuICBhd2FpdCBQSVhJLmF1dG9EZXRlY3RSZW5kZXJlcihvcHRpb25zKVxuKTtcblxuUmVuZGVyTWFuYWdlci5jcmVhdGUgPSBhc3luYyAoaHRtbFJvb3Q6IEhUTUxFbGVtZW50LCBvcHRpb25zOiBQYXJ0aWFsPFBJWEkuQXV0b0RldGVjdE9wdGlvbnM+KSA9PiAoXG4gIG5ldyBSZW5kZXJNYW5hZ2VyKGh0bWxSb290LCBhd2FpdCBSZW5kZXJNYW5hZ2VyLmdldFJlbmRlcmVyKG9wdGlvbnMpKVxuKTtcbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgQXNFbnRpdHkgfSBmcm9tICcuL21veGktZW50aXR5JztcblxuZnVuY3Rpb24gaXNNb3hpRW50aXR5PFQgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lcj4oZW50aXR5OiB1bmtub3duKTogZW50aXR5IGlzIEFzRW50aXR5PFQ+IHtcbiAgcmV0dXJuIGVudGl0eSAhPSBudWxsICYmIHR5cGVvZiBlbnRpdHkgPT09ICdvYmplY3QnICYmICdtb3hpRW50aXR5JyBpbiBlbnRpdHk7XG59XG5cbmV4cG9ydCBjbGFzcyBTY2VuZSBleHRlbmRzIFBJWEkuQ29udGFpbmVyIHtcbiAgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXI8SFRNTENhbnZhc0VsZW1lbnQ+O1xuXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBQSVhJLlJlbmRlcmVyPEhUTUxDYW52YXNFbGVtZW50Pikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICB9XG5cbiAgaW5pdCgpIHtcbiAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XG4gICAgICBpZiAoaXNNb3hpRW50aXR5KGNoaWxkKSkge1xuICAgICAgICBjaGlsZC5tb3hpRW50aXR5LmluaXQodGhpcy5yZW5kZXJlcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuXG4gIHVwZGF0ZShkZWx0YVRpbWU6IG51bWJlcikge1xuICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgIGlmIChpc01veGlFbnRpdHkoY2hpbGQpKSB7XG4gICAgICAgIGNoaWxkLm1veGlFbnRpdHkudXBkYXRlKGRlbHRhVGltZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBkcmF3KGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgdGhpcy5yZW5kZXJlci5yZW5kZXIodGhpcyk7XG4gIH1cbn0iLCJpbXBvcnQgKiBhcyB1dGlscyBmcm9tICcuL2xpYnJhcnkvdXRpbHMnO1xuaW1wb3J0IHsgUmVuZGVyTWFuYWdlciB9IGZyb20gJy4vY29yZS9yZW5kZXItbWFuYWdlcic7XG5pbXBvcnQgeyBTY2VuZSB9IGZyb20gJy4vY29yZS9zY2VuZSc7XG5pbXBvcnQgeyBFbmdpbmUgfSBmcm9tICcuL2NvcmUvZW5naW5lJztcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJy4vY29yZS9ldmVudC1zeXN0ZW0nO1xuaW1wb3J0IHsgQ2xpZW50RXZlbnRzIH0gZnJvbSAnLi9saWJyYXJ5L2NsaWVudC1ldmVudHMnO1xuaW1wb3J0IHsgQXNzZXRMb2FkZXIgfSBmcm9tICcuL2NvcmUvYXNzZXQtbG9hZGVyJztcbmltcG9ydCB7IFBvaW50IH0gZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4vY29yZS9sb2dpYyc7XG5pbXBvcnQgeyBkZWZhdWx0UmVuZGVyT3B0aW9ucywgc2V0dXBNb3hpIH0gZnJvbSAnLi9saWJyYXJ5L3NldHVwJztcbmltcG9ydCB7IGxvYWRGb250cyB9IGZyb20gJy4vbGlicmFyeS9mb250LWxvYWRlcic7XG5pbXBvcnQgeyBhc0VudGl0eSwgTW94aUVudGl0eSB9IGZyb20gJy4vY29yZS9tb3hpLWVudGl0eSc7XG5pbXBvcnQgeyBDYW1lcmEsIENhbWVyYUxvZ2ljIH0gZnJvbSAnLi9jb3JlL2NhbWVyYSc7XG5pbXBvcnQgeyBhc1RleHR1cmVGcmFtZXMgfSBmcm9tICcuL2xpYnJhcnkvdGV4dHVyZS1mcmFtZXMnO1xuaW1wb3J0IHsgYXNCaXRtYXBUZXh0LCBhc1Nwcml0ZSwgYXNUZXh0LCBhc0dyYXBoaWNzLCBhc0NvbnRhaW5lciwgUGl4aVByb3BzIH0gZnJvbSAnLi9saWJyYXJ5L2FzLXBpeGknO1xuaW1wb3J0IHsgVGV4dHVyZUZyYW1lU2VxdWVuY2VzLCBTZXF1ZW5jZUluZm8gfSBmcm9tICcuL2xpYnJhcnkvdGV4dHVyZS1mcmFtZS1zZXF1ZW5jZXMnO1xuaW1wb3J0IHsgY3JlYXRlUmVzaXplSGFuZGxlciwgc2V0dXBSZXNwb25zaXZlQ2FudmFzLCBSZXNpemVIYW5kbGVyT3B0aW9ucyB9IGZyb20gJy4vbGlicmFyeS9yZXNpemUtaGFuZGxlcic7XG5pbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi91aS9jb3JlL2VkZ2UtaW5zZXRzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi91aS9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBVSUZvY3VzTWFuYWdlciB9IGZyb20gJy4vdWkvY29yZS91aS1mb2N1cy1tYW5hZ2VyJztcbmltcG9ydCB7IEZsZXhDb250YWluZXIsIEZsZXhEaXJlY3Rpb24sIEZsZXhKdXN0aWZ5LCBGbGV4QWxpZ24gfSBmcm9tICcuL3VpL2xheW91dC9mbGV4LWNvbnRhaW5lcic7XG5pbXBvcnQgeyBVSUJveCB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1ib3gnO1xuaW1wb3J0IHsgVUlMYWJlbCB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1sYWJlbCc7XG5pbXBvcnQgeyBVSVBhbmVsIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXBhbmVsJztcbmltcG9ydCB7IFVJQnV0dG9uLCBCdXR0b25TdGF0ZSB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1idXR0b24nO1xuaW1wb3J0IHsgVUlTZWxlY3QsIFNlbGVjdE9wdGlvbiB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1zZWxlY3QnO1xuaW1wb3J0IHsgVUlUZXh0SW5wdXQgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktdGV4dC1pbnB1dCc7XG5pbXBvcnQgeyBVSVRleHRBcmVhIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXRleHRhcmVhJztcbmltcG9ydCB7IFVJU2Nyb2xsQ29udGFpbmVyIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXNjcm9sbC1jb250YWluZXInO1xuaW1wb3J0IHsgVUlUYWJzLCBUYWJJdGVtIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXRhYnMnO1xuaW1wb3J0IHsgVUlMYXllciB9IGZyb20gJy4vdWkvVUlMYXllcic7XG5pbXBvcnQgeyBVSVNjYWxlTW9kZSB9IGZyb20gJy4vdWkvVUlTY2FsZU1vZGUnO1xuaW1wb3J0IHsgU3RhdGVNYWNoaW5lIH0gZnJvbSAnLi9saWJyYXJ5L3N0YXRlLW1hY2hpbmUnO1xuaW1wb3J0IHsgU3RhdGVMb2dpYyB9IGZyb20gJy4vbGlicmFyeS9zdGF0ZS1sb2dpYyc7XG5pbXBvcnQgeyBjcmVhdGVUaWxlR3JpZCwgZ2V0VGV4dHVyZVJhbmdlIH0gZnJvbSAnLi9saWJyYXJ5L2dyaWQtZ2VuZXJhdG9yJztcbmltcG9ydCB7IHN2Z1RvVGV4dHVyZSB9IGZyb20gJy4vbGlicmFyeS9zdmctdXRpbHMvc3ZnLXRvLXRleHR1cmUnO1xuaW1wb3J0IHsgUGl4ZWxHcmlkLCBweCwgdW5pdHMsIEdSSUQsIEJPUkRFUiwgY3JlYXRlQm9yZGVyQ29uZmlnIH0gZnJvbSAnLi91aS9waXhlbC1ncmlkJztcbmltcG9ydCB7IFBhcmFsbGF4QmFja2dyb3VuZCwgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMgfSBmcm9tICcuL2xpYnJhcnkvcGFyYWxsYXgtYmFja2dyb3VuZCc7XG5pbXBvcnQgeyBQYXJhbGxheExheWVyLCBUaWxpbmdQYXJhbGxheExheWVyIH0gZnJvbSAnLi9saWJyYXJ5L3BhcmFsbGF4LWxheWVyJztcbmltcG9ydCB7IExvYWRpbmdTY2VuZSB9IGZyb20gJy4vbGlicmFyeS9sb2FkaW5nLXNjZW5lJztcbmltcG9ydCB7XG4gIFBoeXNpY3NXb3JsZCxcbiAgUGh5c2ljc0JvZHlMb2dpYyxcbiAgUGh5c2ljc0RlYnVnUmVuZGVyZXIsXG4gIENvbGxpc2lvblJlZ2lzdHJ5LFxuICBDb2xsaXNpb25NYW5hZ2VyLFxuICBhc1BoeXNpY3NFbnRpdHksXG4gIGhhc1BoeXNpY3MsXG4gIGdldFBoeXNpY3NCb2R5LFxuICBjcmVhdGVTaGFwZUZyb21TcHJpdGUsXG4gIFBoeXNpY3NNYXRlcmlhbHMsXG4gIGFwcGx5TWF0ZXJpYWxcbn0gZnJvbSAnLi9saWJyYXJ5L3BoeXNpY3MnO1xuXG5leHBvcnQgdHlwZSB7IFN0YXRlQ2hhbmdlRXZlbnQgfSBmcm9tICcuL2xpYnJhcnkvc3RhdGUtbWFjaGluZSc7XG5leHBvcnQgdHlwZSB7IEFzRW50aXR5LCBNb3hpTG9naWMgfSBmcm9tICcuL2NvcmUvbW94aS1lbnRpdHknO1xuZXhwb3J0IHR5cGUgeyBBc1RleHR1cmVGcmFtZXNPcHRpb25zIH0gZnJvbSAnLi9saWJyYXJ5L3RleHR1cmUtZnJhbWVzJztcbmV4cG9ydCB0eXBlIHsgR3JpZE9wdGlvbnMsIENlbGxQb3NpdGlvbiB9IGZyb20gJy4vbGlicmFyeS9ncmlkLWdlbmVyYXRvcic7XG5leHBvcnQgdHlwZSB7IFBhcmFsbGF4QmFja2dyb3VuZE9wdGlvbnMgfSBmcm9tICcuL2xpYnJhcnkvcGFyYWxsYXgtYmFja2dyb3VuZCc7XG5leHBvcnQgdHlwZSB7IFBhcmFsbGF4TGF5ZXJPcHRpb25zLCBUaWxpbmdQYXJhbGxheExheWVyT3B0aW9ucyB9IGZyb20gJy4vbGlicmFyeS9wYXJhbGxheC1sYXllcic7XG5leHBvcnQgdHlwZSB7IExvYWRpbmdTY2VuZU9wdGlvbnMgfSBmcm9tICcuL2xpYnJhcnkvbG9hZGluZy1zY2VuZSc7XG5leHBvcnQgdHlwZSB7XG4gIEJvZHlUeXBlLFxuICBTeW5jTW9kZSxcbiAgU2hhcGVUeXBlLFxuICBDb2xsaXNpb25UYWcsXG4gIFNoYXBlQ29uZmlnLFxuICBQaHlzaWNzV29ybGRPcHRpb25zLFxuICBQaHlzaWNzQm9keU9wdGlvbnMsXG4gIFBoeXNpY3NEZWJ1Z09wdGlvbnMsXG4gIENvbGxpc2lvbkV2ZW50LFxuICBSYXljYXN0Q2FsbGJhY2tcbn0gZnJvbSAnLi9saWJyYXJ5L3BoeXNpY3MnO1xuZXhwb3J0IHR5cGUgeyBCb3hNb2RlbCwgQ29tcHV0ZWRMYXlvdXQsIE1lYXN1cmVkU2l6ZSwgU2l6ZUNvbnN0cmFpbnQgfSBmcm9tICcuL3VpL2NvcmUvYm94LW1vZGVsJztcbmV4cG9ydCB0eXBlIHsgRmxleENvbnRhaW5lclByb3BzIH0gZnJvbSAnLi91aS9sYXlvdXQvZmxleC1jb250YWluZXInO1xuZXhwb3J0IHR5cGUgeyBVSUJveFByb3BzIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWJveCc7XG5leHBvcnQgdHlwZSB7IFVJTGFiZWxQcm9wcywgVGV4dEFsaWduIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWxhYmVsJztcbmV4cG9ydCB0eXBlIHsgVUlQYW5lbFByb3BzLCBOaW5lU2xpY2VDb25maWcgfSBmcm9tICcuL3VpL2NvbXBvbmVudHMvdWktcGFuZWwnO1xuZXhwb3J0IHR5cGUgeyBVSUJ1dHRvblByb3BzLCBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLWJ1dHRvbic7XG5leHBvcnQgdHlwZSB7IFVJU2VsZWN0UHJvcHMsIFNlbGVjdE9wdGlvbiB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS1zZWxlY3QnO1xuZXhwb3J0IHR5cGUgeyBVSVRleHRJbnB1dFByb3BzIH0gZnJvbSAnLi91aS9jb21wb25lbnRzL3VpLXRleHQtaW5wdXQnO1xuZXhwb3J0IHR5cGUgeyBVSVRhYnNQcm9wcywgVGFiSXRlbSB9IGZyb20gJy4vdWkvY29tcG9uZW50cy91aS10YWJzJztcbmV4cG9ydCB0eXBlIHsgVUlMYXllck9wdGlvbnMgfSBmcm9tICcuL3VpL1VJTGF5ZXInO1xuZXhwb3J0IHR5cGUgeyBQaXhlbEdyaWRDb25maWcsIEJvcmRlckNvbmZpZyB9IGZyb20gJy4vdWkvcGl4ZWwtZ3JpZCc7XG5leHBvcnQgdHlwZSB7IFNWR1RvVGV4dHVyZU9wdGlvbnMgfSBmcm9tICcuL2xpYnJhcnkvc3ZnLXV0aWxzL3N2Zy10by10ZXh0dXJlJztcblxuZXhwb3J0IHR5cGUgQXNzZXQgPSB7IHNyYzogc3RyaW5nLCBhbGlhcz86IHN0cmluZyB9O1xuXG5leHBvcnQgaW50ZXJmYWNlIE9uRXZlbnQge1xuICBldmVudDogRXZlbnQ7XG4gIGV2ZW50VHlwZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENsaWVudEV2ZW50c0FyZ3Mge1xuICBpbml0V2hlZWxPZmZzZXQ/OiBQb2ludDtcbiAgb25BbnlFdmVudD86IChldjogT25FdmVudCkgPT4gdm9pZDtcbn1cblxuZXhwb3J0IHR5cGUgQ2xpZW50RXZlbnRzVHlwZSA9IHtcbiAga2V5RG93bkV2ZW50PzogS2V5Ym9hcmRFdmVudDtcbiAga2V5VXBFdmVudD86IEtleWJvYXJkRXZlbnQ7XG4gIGtleWRvd24/OiBSZWNvcmQ8c3RyaW5nLCBLZXlib2FyZEV2ZW50PjtcbiAgbW91c2VEb3duRXZlbnQ/OiBNb3VzZUV2ZW50O1xuICBtb3VzZVVwRXZlbnQ/OiBNb3VzZUV2ZW50O1xuICBsYXN0TW91c2VEb3duPzogTW91c2VFdmVudDtcbiAgbGFzdE1vdXNlVXA/OiBNb3VzZUV2ZW50O1xuICB3aGVlbEV2ZW50PzogV2hlZWxFdmVudDtcbiAgd2hlZWxEZWx0YT86IHsgeVZhbHVlOiAwIHwgbnVtYmVyLCB4VmFsdWU6IDAgfCBudW1iZXIsIHhMYXN0OiBudW1iZXIsIHlMYXN0OiBudW1iZXIgfVxufVxuXG4vLyBSZS1leHBvcnQgdHlwZXNcbmV4cG9ydCB7IFxuICBTZXF1ZW5jZUluZm8sIFxuICBSZXNpemVIYW5kbGVyT3B0aW9uc1xufTtcblxuY29uc3QgZXhwb3J0ZWRPYmplY3RzID0ge1xuICBBc3NldExvYWRlcixcbiAgYXNFbnRpdHksXG4gIGFzVGV4dHVyZUZyYW1lcyxcbiAgYXNCaXRtYXBUZXh0LFxuICBhc1Nwcml0ZSxcbiAgYXNUZXh0LFxuICBhc0dyYXBoaWNzLFxuICBhc0NvbnRhaW5lcixcbiAgTG9naWMsXG4gIENhbWVyYSxcbiAgQ2FtZXJhTG9naWMsXG4gIENsaWVudEV2ZW50cyxcbiAgY3JlYXRlUmVzaXplSGFuZGxlcixcbiAgY3JlYXRlVGlsZUdyaWQsXG4gIGRlZmF1bHRSZW5kZXJPcHRpb25zLFxuICBFbmdpbmUsXG4gIEV2ZW50RW1pdHRlcixcbiAgZ2V0VGV4dHVyZVJhbmdlLFxuICBsb2FkRm9udHMsXG4gIE1veGlFbnRpdHksXG4gIFBhcmFsbGF4QmFja2dyb3VuZCxcbiAgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMsXG4gIFBhcmFsbGF4TGF5ZXIsXG4gIExvYWRpbmdTY2VuZSxcbiAgc2V0dXBNb3hpLFxuICBSZW5kZXJNYW5hZ2VyLFxuICBTY2VuZSxcbiAgc2V0dXBSZXNwb25zaXZlQ2FudmFzLFxuICBUZXh0dXJlRnJhbWVTZXF1ZW5jZXMsXG4gIFRpbGluZ1BhcmFsbGF4TGF5ZXIsXG4gIHV0aWxzLFxuICBTdGF0ZU1hY2hpbmUsXG4gIFN0YXRlTG9naWMsXG4gIFBoeXNpY3NXb3JsZCxcbiAgUGh5c2ljc0JvZHlMb2dpYyxcbiAgUGh5c2ljc0RlYnVnUmVuZGVyZXIsXG4gIENvbGxpc2lvblJlZ2lzdHJ5LFxuICBDb2xsaXNpb25NYW5hZ2VyLFxuICBhc1BoeXNpY3NFbnRpdHksXG4gIGhhc1BoeXNpY3MsXG4gIGdldFBoeXNpY3NCb2R5LFxuICBjcmVhdGVTaGFwZUZyb21TcHJpdGUsXG4gIFBoeXNpY3NNYXRlcmlhbHMsXG4gIGFwcGx5TWF0ZXJpYWwsXG4gIEVkZ2VJbnNldHMsXG4gIFVJQ29tcG9uZW50LFxuICBVSUZvY3VzTWFuYWdlcixcbiAgRmxleENvbnRhaW5lcixcbiAgRmxleERpcmVjdGlvbixcbiAgRmxleEp1c3RpZnksXG4gIEZsZXhBbGlnbixcbiAgVUlCb3gsXG4gIFVJTGFiZWwsXG4gIFVJUGFuZWwsXG4gIFVJQnV0dG9uLFxuICBCdXR0b25TdGF0ZSxcbiAgVUlTZWxlY3QsXG4gIFVJVGV4dElucHV0LFxuICBVSVRleHRBcmVhLFxuICBVSVNjcm9sbENvbnRhaW5lcixcbiAgVUlUYWJzLFxuICBVSUxheWVyLFxuICBVSVNjYWxlTW9kZSxcbiAgc3ZnVG9UZXh0dXJlLFxuICBQaXhlbEdyaWQsXG4gIHB4LFxuICB1bml0cyxcbiAgR1JJRCxcbiAgQk9SREVSLFxuICBjcmVhdGVCb3JkZXJDb25maWdcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGV4cG9ydGVkT2JqZWN0cztcblxuZXhwb3J0IHtcbiAgQXNzZXRMb2FkZXIsXG4gIGFzRW50aXR5LFxuICBhc1RleHR1cmVGcmFtZXMsXG4gIGFzQml0bWFwVGV4dCxcbiAgYXNTcHJpdGUsXG4gIGFzVGV4dCxcbiAgYXNHcmFwaGljcyxcbiAgYXNDb250YWluZXIsXG4gIFBpeGlQcm9wcyxcbiAgTG9naWMsXG4gIENhbWVyYSxcbiAgQ2FtZXJhTG9naWMsXG4gIENsaWVudEV2ZW50cyxcbiAgY3JlYXRlUmVzaXplSGFuZGxlcixcbiAgY3JlYXRlVGlsZUdyaWQsXG4gIGRlZmF1bHRSZW5kZXJPcHRpb25zLFxuICBFbmdpbmUsXG4gIEV2ZW50RW1pdHRlcixcbiAgZ2V0VGV4dHVyZVJhbmdlLFxuICBsb2FkRm9udHMsXG4gIE1veGlFbnRpdHksXG4gIFBhcmFsbGF4QmFja2dyb3VuZCxcbiAgUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMsXG4gIFBhcmFsbGF4TGF5ZXIsXG4gIExvYWRpbmdTY2VuZSxcbiAgc2V0dXBNb3hpLFxuICBSZW5kZXJNYW5hZ2VyLFxuICBTY2VuZSxcbiAgc2V0dXBSZXNwb25zaXZlQ2FudmFzLFxuICBUZXh0dXJlRnJhbWVTZXF1ZW5jZXMsXG4gIFRpbGluZ1BhcmFsbGF4TGF5ZXIsXG4gIHV0aWxzLFxuICBTdGF0ZU1hY2hpbmUsXG4gIFN0YXRlTG9naWMsXG4gIFBoeXNpY3NXb3JsZCxcbiAgUGh5c2ljc0JvZHlMb2dpYyxcbiAgUGh5c2ljc0RlYnVnUmVuZGVyZXIsXG4gIENvbGxpc2lvblJlZ2lzdHJ5LFxuICBDb2xsaXNpb25NYW5hZ2VyLFxuICBhc1BoeXNpY3NFbnRpdHksXG4gIGhhc1BoeXNpY3MsXG4gIGdldFBoeXNpY3NCb2R5LFxuICBjcmVhdGVTaGFwZUZyb21TcHJpdGUsXG4gIFBoeXNpY3NNYXRlcmlhbHMsXG4gIGFwcGx5TWF0ZXJpYWwsXG4gIEVkZ2VJbnNldHMsXG4gIFVJQ29tcG9uZW50LFxuICBVSUZvY3VzTWFuYWdlcixcbiAgRmxleENvbnRhaW5lcixcbiAgRmxleERpcmVjdGlvbixcbiAgRmxleEp1c3RpZnksXG4gIEZsZXhBbGlnbixcbiAgVUlCb3gsXG4gIFVJTGFiZWwsXG4gIFVJUGFuZWwsXG4gIFVJQnV0dG9uLFxuICBCdXR0b25TdGF0ZSxcbiAgVUlTZWxlY3QsXG4gIFVJVGV4dElucHV0LFxuICBVSVRleHRBcmVhLFxuICBVSVNjcm9sbENvbnRhaW5lcixcbiAgVUlUYWJzLFxuICBVSUxheWVyLFxuICBVSVNjYWxlTW9kZSxcbiAgc3ZnVG9UZXh0dXJlLFxuICBQaXhlbEdyaWQsXG4gIHB4LFxuICB1bml0cyxcbiAgR1JJRCxcbiAgQk9SREVSLFxuICBjcmVhdGVCb3JkZXJDb25maWdcbn07XG5cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGNyZWF0aW5nIGEgQml0bWFwVGV4dCBpbnN0YW5jZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIEJpdG1hcFRleHRPcHRpb25zIHtcbiAgdGV4dD86IHN0cmluZyB8IG51bWJlciB8IHsgdG9TdHJpbmc6ICgpID0+IHN0cmluZyB9O1xuICBzdHlsZT86IHtcbiAgICBmb250RmFtaWx5Pzogc3RyaW5nO1xuICAgIGZvbnRTaXplPzogbnVtYmVyO1xuICAgIGZvbnRTdHlsZT86IHN0cmluZztcbiAgICBmaWxsPzogbnVtYmVyIHwgc3RyaW5nO1xuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbiAgfTtcbiAgcGl4ZWxQZXJmZWN0PzogYm9vbGVhbjsgLy8gRW5hYmxlIHBpeGVsLXBlcmZlY3QgcmVuZGVyaW5nIChyb3VuZFBpeGVscylcbiAgW2tleTogc3RyaW5nXTogYW55O1xufVxuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGNyZWF0aW5nIGEgU3ByaXRlIGluc3RhbmNlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3ByaXRlT3B0aW9ucyB7XG4gIHRleHR1cmU/OiBQSVhJLlRleHR1cmUgfCBQSVhJLlRleHR1cmVTb3VyY2U7XG4gIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuLyoqXG4gKiBPcHRpb25zIGZvciBjcmVhdGluZyBhIFRleHQgaW5zdGFuY2VcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBUZXh0T3B0aW9ucyB7XG4gIHRleHQ/OiBzdHJpbmcgfCBudW1iZXIgfCB7IHRvU3RyaW5nOiAoKSA9PiBzdHJpbmcgfTtcbiAgc3R5bGU/OiB7XG4gICAgZm9udEZhbWlseT86IHN0cmluZztcbiAgICBmb250U2l6ZT86IG51bWJlcjtcbiAgICBmb250U3R5bGU/OiBzdHJpbmc7XG4gICAgZmlsbD86IG51bWJlciB8IHN0cmluZztcbiAgICBba2V5OiBzdHJpbmddOiBhbnk7XG4gIH07XG4gIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuLyoqXG4gKiBDb21tb24gcHJvcGVydGllcyB0aGF0IGNhbiBiZSBhcHBsaWVkIHRvIFBJWEkgZGlzcGxheSBvYmplY3RzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUGl4aVByb3BzIHtcbiAgeD86IG51bWJlcjtcbiAgeT86IG51bWJlcjtcbiAgYW5jaG9yPzogeyB4PzogbnVtYmVyOyB5PzogbnVtYmVyIH0gfCBudW1iZXI7XG4gIHNjYWxlPzogeyB4PzogbnVtYmVyOyB5PzogbnVtYmVyIH0gfCBudW1iZXI7XG4gIHJvdGF0aW9uPzogbnVtYmVyO1xuICB0aW50PzogbnVtYmVyO1xuICBhbHBoYT86IG51bWJlcjtcbiAgdmlzaWJsZT86IGJvb2xlYW47XG4gIGV2ZW50TW9kZT86ICdub25lJyB8ICdwYXNzaXZlJyB8ICdhdXRvJyB8ICdzdGF0aWMnIHwgJ2R5bmFtaWMnO1xuICBwaXZvdD86IHsgeD86IG51bWJlcjsgeT86IG51bWJlciB9IHwgbnVtYmVyO1xufVxuXG4vKipcbiAqIEFwcGxpZXMgY29tbW9uIHByb3BlcnRpZXMgdG8gYSBQSVhJIGRpc3BsYXkgb2JqZWN0XG4gKi9cbmZ1bmN0aW9uIGFwcGx5UHJvcHM8VCBleHRlbmRzIFBJWEkuQ29udGFpbmVyPihvYmo6IFQsIHByb3BzPzogUGl4aVByb3BzKTogVCB7XG4gIGlmICghcHJvcHMpIHJldHVybiBvYmo7XG5cbiAgaWYgKHByb3BzLnggIT09IHVuZGVmaW5lZCkgb2JqLnggPSBwcm9wcy54O1xuICBpZiAocHJvcHMueSAhPT0gdW5kZWZpbmVkKSBvYmoueSA9IHByb3BzLnk7XG4gIFxuICBpZiAocHJvcHMuYW5jaG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICBpZiAodHlwZW9mIHByb3BzLmFuY2hvciA9PT0gJ251bWJlcicpIHtcbiAgICAgIGlmICgnYW5jaG9yJyBpbiBvYmogJiYgdHlwZW9mIG9iai5hbmNob3IgPT09ICdvYmplY3QnICYmIG9iai5hbmNob3IgIT09IG51bGwpIHtcbiAgICAgICAgKG9iai5hbmNob3IgYXMgUElYSS5PYnNlcnZhYmxlUG9pbnQpLnNldChwcm9wcy5hbmNob3IpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoJ2FuY2hvcicgaW4gb2JqICYmIHR5cGVvZiBvYmouYW5jaG9yID09PSAnb2JqZWN0JyAmJiBvYmouYW5jaG9yICE9PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGFuY2hvciA9IG9iai5hbmNob3IgYXMgUElYSS5PYnNlcnZhYmxlUG9pbnQ7XG4gICAgICAgIGlmIChwcm9wcy5hbmNob3IueCAhPT0gdW5kZWZpbmVkKSBhbmNob3IueCA9IHByb3BzLmFuY2hvci54O1xuICAgICAgICBpZiAocHJvcHMuYW5jaG9yLnkgIT09IHVuZGVmaW5lZCkgYW5jaG9yLnkgPSBwcm9wcy5hbmNob3IueTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAocHJvcHMuc2NhbGUgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmICh0eXBlb2YgcHJvcHMuc2NhbGUgPT09ICdudW1iZXInKSB7XG4gICAgICBpZiAoJ3NjYWxlJyBpbiBvYmogJiYgdHlwZW9mIG9iai5zY2FsZSA9PT0gJ29iamVjdCcgJiYgb2JqLnNjYWxlICE9PSBudWxsKSB7XG4gICAgICAgIChvYmouc2NhbGUgYXMgUElYSS5PYnNlcnZhYmxlUG9pbnQpLnNldChwcm9wcy5zY2FsZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICgnc2NhbGUnIGluIG9iaiAmJiB0eXBlb2Ygb2JqLnNjYWxlID09PSAnb2JqZWN0JyAmJiBvYmouc2NhbGUgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3Qgc2NhbGUgPSBvYmouc2NhbGUgYXMgUElYSS5PYnNlcnZhYmxlUG9pbnQ7XG4gICAgICAgIGlmIChwcm9wcy5zY2FsZS54ICE9PSB1bmRlZmluZWQpIHNjYWxlLnggPSBwcm9wcy5zY2FsZS54O1xuICAgICAgICBpZiAocHJvcHMuc2NhbGUueSAhPT0gdW5kZWZpbmVkKSBzY2FsZS55ID0gcHJvcHMuc2NhbGUueTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAocHJvcHMucm90YXRpb24gIT09IHVuZGVmaW5lZCkgb2JqLnJvdGF0aW9uID0gcHJvcHMucm90YXRpb247XG4gIGlmIChwcm9wcy50aW50ICE9PSB1bmRlZmluZWQgJiYgJ3RpbnQnIGluIG9iaikgKG9iaiBhcyBhbnkpLnRpbnQgPSBwcm9wcy50aW50O1xuICBpZiAocHJvcHMuYWxwaGEgIT09IHVuZGVmaW5lZCkgb2JqLmFscGhhID0gcHJvcHMuYWxwaGE7XG4gIGlmIChwcm9wcy52aXNpYmxlICE9PSB1bmRlZmluZWQpIG9iai52aXNpYmxlID0gcHJvcHMudmlzaWJsZTtcbiAgaWYgKHByb3BzLmV2ZW50TW9kZSAhPT0gdW5kZWZpbmVkICYmICdldmVudE1vZGUnIGluIG9iaikgb2JqLmV2ZW50TW9kZSA9IHByb3BzLmV2ZW50TW9kZTtcblxuICBpZiAocHJvcHMucGl2b3QgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmICh0eXBlb2YgcHJvcHMucGl2b3QgPT09ICdudW1iZXInKSB7XG4gICAgICBpZiAoJ3Bpdm90JyBpbiBvYmogJiYgdHlwZW9mIG9iai5waXZvdCA9PT0gJ29iamVjdCcgJiYgb2JqLnBpdm90ICE9PSBudWxsKSB7XG4gICAgICAgIChvYmoucGl2b3QgYXMgUElYSS5PYnNlcnZhYmxlUG9pbnQpLnNldChwcm9wcy5waXZvdCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICgncGl2b3QnIGluIG9iaiAmJiB0eXBlb2Ygb2JqLnBpdm90ID09PSAnb2JqZWN0JyAmJiBvYmoucGl2b3QgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgcGl2b3QgPSBvYmoucGl2b3QgYXMgUElYSS5PYnNlcnZhYmxlUG9pbnQ7XG4gICAgICAgIGlmIChwcm9wcy5waXZvdC54ICE9PSB1bmRlZmluZWQpIHBpdm90LnggPSBwcm9wcy5waXZvdC54O1xuICAgICAgICBpZiAocHJvcHMucGl2b3QueSAhPT0gdW5kZWZpbmVkKSBwaXZvdC55ID0gcHJvcHMucGl2b3QueTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gb2JqO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBCaXRtYXBUZXh0IGluc3RhbmNlIHdpdGggY29uc3RydWN0b3IgYXJncyBhbmQgb3B0aW9uYWwgcHJvcGVydGllc1xuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBsYWJlbCA9IGFzQml0bWFwVGV4dChcbiAqICAgeyB0ZXh0OiAnSGVsbG8nLCBzdHlsZTogeyBmb250RmFtaWx5OiAnQXJpYWwnLCBmb250U2l6ZTogMjQgfSwgcGl4ZWxQZXJmZWN0OiB0cnVlIH0sXG4gKiAgIHsgeDogMTAwLCB5OiA1MCwgYW5jaG9yOiAwLjUgfVxuICogKTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNCaXRtYXBUZXh0KFxuICBjb25zdHJ1Y3RvckFyZ3M6IEJpdG1hcFRleHRPcHRpb25zLFxuICBwcm9wcz86IFBpeGlQcm9wc1xuKTogUElYSS5CaXRtYXBUZXh0IHtcbiAgY29uc3QgeyBwaXhlbFBlcmZlY3QsIC4uLnRleHRBcmdzIH0gPSBjb25zdHJ1Y3RvckFyZ3M7XG4gIGNvbnN0IHRleHQgPSBuZXcgUElYSS5CaXRtYXBUZXh0KHRleHRBcmdzIGFzIGFueSk7XG5cbiAgLy8gQXBwbHkgcGl4ZWwtcGVyZmVjdCByZW5kZXJpbmcgaWYgcmVxdWVzdGVkXG4gIGlmIChwaXhlbFBlcmZlY3QpIHtcbiAgICB0ZXh0LnJvdW5kUGl4ZWxzID0gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiBhcHBseVByb3BzKHRleHQsIHByb3BzKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgU3ByaXRlIGluc3RhbmNlIHdpdGggY29uc3RydWN0b3IgYXJncyBhbmQgb3B0aW9uYWwgcHJvcGVydGllc1xuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3Qgc3ByaXRlID0gYXNTcHJpdGUoXG4gKiAgIHsgdGV4dHVyZSB9LFxuICogICB7IHg6IDEwMCwgeTogMTAwLCBhbmNob3I6IDAuNSB9XG4gKiApO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc1Nwcml0ZShcbiAgY29uc3RydWN0b3JBcmdzOiBTcHJpdGVPcHRpb25zLFxuICBwcm9wcz86IFBpeGlQcm9wc1xuKTogUElYSS5TcHJpdGUge1xuICBjb25zdCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoY29uc3RydWN0b3JBcmdzIGFzIGFueSk7XG4gIHJldHVybiBhcHBseVByb3BzKHNwcml0ZSwgcHJvcHMpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBUZXh0IGluc3RhbmNlIHdpdGggY29uc3RydWN0b3IgYXJncyBhbmQgb3B0aW9uYWwgcHJvcGVydGllc1xuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgdGV4dCA9IGFzVGV4dChcbiAqICAgeyB0ZXh0OiAnSGVsbG8nLCBzdHlsZTogeyBmb250RmFtaWx5OiAnQXJpYWwnLCBmb250U2l6ZTogMjQgfSB9LFxuICogICB7IHg6IDEwMCwgeTogNTAgfVxuICogKTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNUZXh0KFxuICBjb25zdHJ1Y3RvckFyZ3M6IFRleHRPcHRpb25zLFxuICBwcm9wcz86IFBpeGlQcm9wc1xuKTogUElYSS5UZXh0IHtcbiAgY29uc3QgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29uc3RydWN0b3JBcmdzIGFzIGFueSk7XG4gIHJldHVybiBhcHBseVByb3BzKHRleHQsIHByb3BzKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgR3JhcGhpY3MgaW5zdGFuY2Ugd2l0aCBvcHRpb25hbCBwcm9wZXJ0aWVzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBncmFwaGljcyA9IGFzR3JhcGhpY3MoeyB4OiAxMDAsIHk6IDEwMCB9KTtcbiAqIGdyYXBoaWNzLnJlY3QoMCwgMCwgNTAsIDUwKS5maWxsKDB4ZmYwMDAwKTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNHcmFwaGljcyhwcm9wcz86IFBpeGlQcm9wcyk6IFBJWEkuR3JhcGhpY3Mge1xuICBjb25zdCBncmFwaGljcyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gIHJldHVybiBhcHBseVByb3BzKGdyYXBoaWNzLCBwcm9wcyk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIENvbnRhaW5lciBpbnN0YW5jZSB3aXRoIG9wdGlvbmFsIHByb3BlcnRpZXNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGNvbnRhaW5lciA9IGFzQ29udGFpbmVyKHsgeDogMTAwLCB5OiAxMDAgfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzQ29udGFpbmVyKHByb3BzPzogUGl4aVByb3BzKTogUElYSS5Db250YWluZXIge1xuICBjb25zdCBjb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgcmV0dXJuIGFwcGx5UHJvcHMoY29udGFpbmVyLCBwcm9wcyk7XG59XG5cbiIsImltcG9ydCB7IFBvaW50IH0gZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBPbkV2ZW50LCBDbGllbnRFdmVudHNBcmdzIH0gZnJvbSAnLi4nO1xuXG4vKipcbiAqIE1hbmFnZXMgaW5wdXQgZXZlbnRzIGZyb20gdGhlIGNsaWVudCAoa2V5Ym9hcmQsIG1vdXNlLCBldGMuKSBhbmQgcHJvdmlkZXMgYW4gaW50ZXJmYWNlXG4gKiBmb3IgcXVlcnlpbmcgdGhlIGN1cnJlbnQgaW5wdXQgc3RhdGUuXG4gKiBcbiAqIEltcGxlbWVudHMgdGhlIFNpbmdsZXRvbiBwYXR0ZXJuIHRvIGVuc3VyZSBvbmx5IG9uZSBpbnN0YW5jZSBvZiBldmVudCBoYW5kbGVycyBleGlzdHMuXG4gKiBcbiAqIEBjYXRlZ29yeSBDb3JlXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogLy8gQ3JlYXRlL2dldCB0aGUgQ2xpZW50RXZlbnRzIGluc3RhbmNlXG4gKiBjb25zdCBldmVudHMgPSBuZXcgQ2xpZW50RXZlbnRzKCk7XG4gKiBcbiAqIC8vIENoZWNrIGlmIGEga2V5IGlzIGN1cnJlbnRseSBwcmVzc2VkXG4gKiBpZiAoZXZlbnRzLmlzS2V5RG93bignQXJyb3dSaWdodCcpKSB7XG4gKiAgIHBsYXllci5tb3ZlUmlnaHQoKTtcbiAqIH1cbiAqIFxuICogLy8gQWNjZXNzIG1vdXNlIHBvc2l0aW9uXG4gKiBjb25zdCBtb3VzZVBvcyA9IGV2ZW50cy5tb3ZlUG9zaXRpb247XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIENsaWVudEV2ZW50cyB7XG4gIC8qKlxuICAgKiBDdXJyZW50IHdoZWVsIHNjcm9sbCBkZWx0YSB2YWx1ZXNcbiAgICovXG4gIHdoZWVsRGVsdGE6IHsgeVZhbHVlOiBudW1iZXI7IHhWYWx1ZTogbnVtYmVyOyB9O1xuICBcbiAgLyoqXG4gICAqIFRoZSBtb3N0IHJlY2VudCBtb3VzZSB1cCBldmVudFxuICAgKi9cbiAgbW91c2VVcEV2ZW50OiBNb3VzZUV2ZW50O1xuICBcbiAgLyoqXG4gICAqIFRoZSBtb3N0IHJlY2VudCBtb3VzZSBkb3duIGV2ZW50XG4gICAqL1xuICBtb3VzZURvd25FdmVudDogTW91c2VFdmVudDtcbiAgXG4gIC8qKlxuICAgKiBUaGUgbGFzdCBtb3VzZSBkb3duIGV2ZW50IHRoYXQgb2NjdXJyZWRcbiAgICovXG4gIGxhc3RNb3VzZURvd246IE1vdXNlRXZlbnQ7XG4gIFxuICAvKipcbiAgICogVGhlIGxhc3QgbW91c2UgdXAgZXZlbnQgdGhhdCBvY2N1cnJlZFxuICAgKi9cbiAgbGFzdE1vdXNlVXA6IE1vdXNlRXZlbnQ7XG4gIFxuICAvKipcbiAgICogVGhlIG1vc3QgcmVjZW50IGtleSBkb3duIGV2ZW50XG4gICAqL1xuICBrZXlEb3duRXZlbnQ6IEtleWJvYXJkRXZlbnQ7XG4gIFxuICAvKipcbiAgICogVGhlIG1vc3QgcmVjZW50IGtleSB1cCBldmVudFxuICAgKi9cbiAga2V5VXBFdmVudDogS2V5Ym9hcmRFdmVudDtcbiAgXG4gIC8qKlxuICAgKiBNYXAgb2YgY3VycmVudGx5IHByZXNzZWQga2V5c1xuICAgKiBAaW50ZXJuYWxcbiAgICovXG4gIGtleWRvd246IFJlY29yZDxzdHJpbmcsIEtleWJvYXJkRXZlbnQ+O1xuICBcbiAgLyoqXG4gICAqIEFjY3VtdWxhdGVkIHdoZWVsIG9mZnNldCB2YWx1ZXNcbiAgICovXG4gIHdoZWVsT2Zmc2V0czogUG9pbnQ7XG4gIFxuICAvKipcbiAgICogQ3VycmVudCBtb3VzZSBwb3NpdGlvblxuICAgKi9cbiAgbW92ZVBvc2l0aW9uOiBQb2ludDtcbiAgXG4gIC8qKlxuICAgKiBQcmV2aW91cyBtb3VzZSBwb3NpdGlvblxuICAgKi9cbiAgbGFzdE1vdmVQb3NpdGlvbjogUG9pbnQ7XG4gIFxuICAvKipcbiAgICogQ2hhbmdlIGluIG1vdXNlIHBvc2l0aW9uIHNpbmNlIGxhc3QgdXBkYXRlXG4gICAqL1xuICBtb3ZlRGVsdGE6IFBvaW50O1xuXG4gIC8qKlxuICAgKiBTaW5nbGV0b24gaW5zdGFuY2Ugb2YgQ2xpZW50RXZlbnRzXG4gICAqIEBzdGF0aWNcbiAgICovXG4gIHN0YXRpYyBpbnN0YW5jZTogQ2xpZW50RXZlbnRzID0gbnVsbDtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBDbGllbnRFdmVudHMgaW5zdGFuY2Ugb3IgcmV0dXJucyB0aGUgZXhpc3Rpbmcgc2luZ2xldG9uIGluc3RhbmNlXG4gICAqIFxuICAgKiBAcGFyYW0gb3B0aW9ucyAtIENvbmZpZ3VyYXRpb24gb3B0aW9uc1xuICAgKiBAcGFyYW0gb3B0aW9ucy5pbml0V2hlZWxPZmZzZXQgLSBJbml0aWFsIHdoZWVsIG9mZnNldCB2YWx1ZVxuICAgKiBAcGFyYW0gb3B0aW9ucy5vbkFueUV2ZW50IC0gQ2FsbGJhY2sgdGhhdCBmaXJlcyBvbiBhbnkgaW5wdXQgZXZlbnRcbiAgICovXG4gIGNvbnN0cnVjdG9yKHsgaW5pdFdoZWVsT2Zmc2V0ID0gbmV3IFBvaW50KCksIG9uQW55RXZlbnQgPSAoZXY6IE9uRXZlbnQpID0+IHt9IH06IENsaWVudEV2ZW50c0FyZ3MgPSB7fSkge1xuICAgIC8vIHNpbmNlIHdlIGFyZSBob29raW5nIGV2ZW50cyBpbnRvIHRoZSBkb2N1bWVudCwgd2Ugb25seSB3YW50IG9uZSBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzXG4gICAgaWYgKENsaWVudEV2ZW50cy5pbnN0YW5jZSkge1xuICAgICAgcmV0dXJuIENsaWVudEV2ZW50cy5pbnN0YW5jZTtcbiAgICB9XG4gICAgdGhpcy53aGVlbE9mZnNldHMgPSBpbml0V2hlZWxPZmZzZXQ7XG4gICAgdGhpcy5rZXlkb3duID0ge30gYXMgUmVjb3JkPHN0cmluZywgS2V5Ym9hcmRFdmVudD47XG4gICAgdGhpcy5tb3ZlUG9zaXRpb24gPSBuZXcgUG9pbnQoKTtcblxuICAgIGNvbnN0IGFueUV2ZW50ID0gKGV2OiBPbkV2ZW50KSA9PiB7XG4gICAgICBvbkFueUV2ZW50KGV2KTtcbiAgICB9O1xuXG4gICAgLy8gUmVnaXN0ZXIgd2hlZWwgZXZlbnQgbGlzdGVuZXJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIChldmVudCkgPT4ge1xuICAgICAgY29uc3Qgd2hlZWxEZWx0YSA9IHRoaXMud2hlZWxPZmZzZXRzIHx8IG5ldyBQb2ludCgpO1xuICAgICAgY29uc3QgeFZhbHVlID0gd2hlZWxEZWx0YS54ICsgZXZlbnQuZGVsdGFYO1xuICAgICAgY29uc3QgeVZhbHVlID0gd2hlZWxEZWx0YS55ICsgZXZlbnQuZGVsdGFZO1xuICAgICAgdGhpcy53aGVlbE9mZnNldHMgPSBuZXcgUG9pbnQoeFZhbHVlLCB5VmFsdWUpO1xuICAgICAgYW55RXZlbnQoeyBldmVudFR5cGU6ICd3aGVlbCcsIGV2ZW50IH0pO1xuICAgIH0pO1xuXG4gICAgLy8gUmVnaXN0ZXIgbW91c2UgbW92ZSBldmVudCBsaXN0ZW5lclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5sYXN0TW92ZVBvc2l0aW9uID0gdGhpcy5tb3ZlUG9zaXRpb247XG4gICAgICB0aGlzLm1vdmVQb3NpdGlvbiA9IG5ldyBQb2ludChldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZKTtcbiAgICAgIHRoaXMubW92ZURlbHRhID0gbmV3IFBvaW50KFxuICAgICAgICB0aGlzLm1vdmVQb3NpdGlvbi54IC0gdGhpcy5sYXN0TW92ZVBvc2l0aW9uLngsXG4gICAgICAgIHRoaXMubW92ZVBvc2l0aW9uLnkgLSB0aGlzLmxhc3RNb3ZlUG9zaXRpb24ueVxuICAgICAgKTtcbiAgICAgIGFueUV2ZW50KHsgZXZlbnRUeXBlOiAnbW91c2Vtb3ZlJywgZXZlbnQgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZWdpc3RlciBtb3VzZSBkb3duIGV2ZW50IGxpc3RlbmVyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLm1vdXNlRG93bkV2ZW50ID0gZXZlbnQ7XG4gICAgICB0aGlzLmxhc3RNb3VzZURvd24gPSBldmVudDtcbiAgICAgIHRoaXMubW91c2VVcEV2ZW50ID0gbnVsbDtcbiAgICAgIGFueUV2ZW50KHsgZXZlbnRUeXBlOiAnbW91c2Vkb3duJywgZXZlbnQgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZWdpc3RlciBtb3VzZSB1cCBldmVudCBsaXN0ZW5lclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMubW91c2VVcEV2ZW50ID0gZXZlbnQ7XG4gICAgICB0aGlzLmxhc3RNb3VzZVVwID0gZXZlbnQ7XG4gICAgICB0aGlzLm1vdXNlRG93bkV2ZW50ID0gbnVsbDtcbiAgICAgIGFueUV2ZW50KHsgZXZlbnRUeXBlOiAnbW91c2V1cCcsIGV2ZW50IH0pO1xuICAgIH0pO1xuXG4gICAgLy8gUmVnaXN0ZXIga2V5IGRvd24gZXZlbnQgbGlzdGVuZXJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB7IGtleSB9ID0gZXZlbnQ7XG4gICAgICB0aGlzLmtleURvd25FdmVudCA9IGV2ZW50O1xuICAgICAgdGhpcy5rZXlVcEV2ZW50ID0gbnVsbDtcbiAgICAgIHRoaXMua2V5ZG93bltrZXldID0gZXZlbnQ7XG4gICAgICBhbnlFdmVudCh7IGV2ZW50VHlwZTogJ2tleWRvd24nLCBldmVudCB9KTtcbiAgICB9KTtcblxuICAgIC8vIFJlZ2lzdGVyIGtleSB1cCBldmVudCBsaXN0ZW5lclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB7IGtleSB9ID0gZXZlbnQ7XG4gICAgICB0aGlzLmtleVVwRXZlbnQgPSBldmVudDtcbiAgICAgIHRoaXMua2V5RG93bkV2ZW50ID0gbnVsbDtcbiAgICAgIGRlbGV0ZSB0aGlzLmtleWRvd25ba2V5XTtcbiAgICAgIGFueUV2ZW50KHsgZXZlbnRUeXBlOiAna2V5dXAnLCBldmVudCB9KTtcbiAgICB9KTtcblxuICAgIENsaWVudEV2ZW50cy5pbnN0YW5jZSA9IHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGEgc3BlY2lmaWMga2V5IGlzIGN1cnJlbnRseSBwcmVzc2VkIGRvd25cbiAgICogXG4gICAqIEBwYXJhbSBrZXkgLSBUaGUga2V5IHRvIGNoZWNrLCBlLmcuLCAnYScsICdBcnJvd1VwJywgJ1NwYWNlJ1xuICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBrZXkgaXMgY3VycmVudGx5IHByZXNzZWQsIGZhbHNlIG90aGVyd2lzZVxuICAgKiBcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBpZiAoZXZlbnRzLmlzS2V5RG93bignU3BhY2UnKSkge1xuICAgKiAgIHBsYXllci5qdW1wKCk7XG4gICAqIH1cbiAgICogYGBgXG4gICAqL1xuICBpc0tleURvd24oa2V5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gQm9vbGVhbih0aGlzLmtleWRvd25ba2V5XSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGEgc3BlY2lmaWMga2V5IGlzIGN1cnJlbnRseSBub3QgcHJlc3NlZFxuICAgKiBcbiAgICogQHBhcmFtIGtleSAtIFRoZSBrZXkgdG8gY2hlY2ssIGUuZy4sICdhJywgJ0Fycm93VXAnLCAnU3BhY2UnXG4gICAqIEByZXR1cm5zIFRydWUgaWYgdGhlIGtleSBpcyBjdXJyZW50bHkgbm90IHByZXNzZWQsIGZhbHNlIGlmIGl0IGlzIHByZXNzZWRcbiAgICovXG4gIGlzS2V5VXAoa2V5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIXRoaXMua2V5ZG93bltrZXldO1xuICB9XG59XG5cblxuXG4iLCJpbXBvcnQgRm9udEZhY2VPYnNlcnZlciBmcm9tICdmb250ZmFjZW9ic2VydmVyJztcbmltcG9ydCB7IEJpdG1hcEZvbnQgfSBmcm9tICdwaXhpLmpzJztcblxuZXhwb3J0IGNvbnN0IGxvYWRGb250cyA9IGFzeW5jICgpID0+IHtcbiAgLy8gbm90ZSB0aGF0IHRoaXMgcmVmZXJlbmNlcyB0aGUgZm9udC1mYWNlIHNwZWNpZmllZCBpbiB0aGUgSFRNTCBzdHlsZSBzZWN0aW9uXG4gIC8vIDxzdHlsZT5cbiAgLy8gQGZvbnQtZmFjZSB7XG4gIC8vICAgZm9udC1mYW1pbHk6ICdrZW5mdXR1cmUtdGhpbic7XG4gIC8vICAgc3JjOiB1cmwoJy4vYXNzZXRzL2ZvbnRzL2tlbnZlY3Rvcl9mdXR1cmVfdGhpbi50dGYnKTtcbiAgLy8gfVxuICAvLyA8L3N0eWxlPlxuXG4gIC8vIHVzaW5nIGZvbnRmYWNlb2JzZXJ2ZXIgYWxsb3dzIHVzIGVuc3VyZSB0aGUgZm9udCBpcyBsb2FkZWQgYmVmb3JlIHVzaW5nIGNvbmZpZ3VyYXRpb24gZm9yIGJpdG1hcCBmb250cy5cbiAgY29uc3QgZm9udEtlbmZ1dHVyZVRoaW4gPSBuZXcgRm9udEZhY2VPYnNlcnZlcigna2VuZnV0dXJlLXRoaW4nKTtcblxuICAvLyBQSVhJLkJpdG1hcEZvbnQuaW5zdGFsbCB3aWxsIGNyZWF0ZSBhIGJpdG1hcCBmb250IGZyb20gYSBmb250LWZhY2UgYW5kIFRleHRTdHlsZSBjb25maWd1cmF0aW9uXG4gIC8vIFVzaW5nIGEgQml0bWFwZm9udCBhbGxvd3MgZm9yIGJldHRlciBwZXJmb3JtYW5jZSB3aGVuIHJhcGlkbHkgY2hhbmdpbmcgcmVuZGVyZWQgdGV4dC5cbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgZm9udEtlbmZ1dHVyZVRoaW4ubG9hZCgpLnRoZW4oKCkgPT4ge1xuICAgICAgQml0bWFwRm9udC5pbnN0YWxsKHtcbiAgICAgICAgbmFtZTogJ2tlbmZ1dHVyZS10aGluJyxcbiAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICBmb250RmFtaWx5OiAna2VuZnV0dXJlLXRoaW4nXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmVzb2x2ZSh7IGZvbnRLZW5mdXR1cmVUaGluIH0pO1xuICAgIH0pO1xuICB9KTtcbn07IiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciBncmlkIGdlbmVyYXRpb25cbiAqIEBjYXRlZ29yeSBMaWJyYXJ5XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgR3JpZE9wdGlvbnMge1xuICB3aWR0aDogbnVtYmVyO1xuICBoZWlnaHQ6IG51bWJlcjtcbiAgY2VsbFdpZHRoOiBudW1iZXI7XG4gIGNlbGxIZWlnaHQ6IG51bWJlcjtcbiAgY2VudGVyZWQ/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIENlbGwgcG9zaXRpb24gaW5mb3JtYXRpb24gcGFzc2VkIHRvIGNhbGxiYWNrIGZ1bmN0aW9uc1xuICogQGNhdGVnb3J5IExpYnJhcnlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDZWxsUG9zaXRpb24ge1xuICB4OiBudW1iZXI7XG4gIHk6IG51bWJlcjtcbiAgcGl4ZWxYOiBudW1iZXI7XG4gIHBpeGVsWTogbnVtYmVyO1xuICBpbmRleDogbnVtYmVyO1xuICB0b3RhbDogbnVtYmVyO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBncmlkIG9mIHRpbGVzIHVzaW5nIGEgc2V0IG9mIHRleHR1cmVzXG4gKiBcbiAqIEBjYXRlZ29yeSBMaWJyYXJ5XG4gKiBAcGFyYW0gb3B0aW9ucyAtIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIGdyaWRcbiAqIEBwYXJhbSB0ZXh0dXJlcyAtIEFycmF5IG9mIHRleHR1cmVzIHRvIHVzZSBmb3IgdGhlIHRpbGVzXG4gKiBAcGFyYW0gc2VsZWN0b3IgLSBPcHRpb25hbCBmdW5jdGlvbiB0byBzZWxlY3Qgd2hpY2ggdGV4dHVyZSB0byB1c2UgZm9yIGVhY2ggY2VsbFxuICogQHJldHVybnMgQSBQSVhJIENvbnRhaW5lciB3aXRoIHRoZSBnZW5lcmF0ZWQgdGlsZSBncmlkXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiAvLyBDcmVhdGUgYSByYW5kb20gZ3Jhc3MgZmllbGRcbiAqIGNvbnN0IGdyYXNzRmllbGQgPSBjcmVhdGVUaWxlR3JpZCh7XG4gKiAgIHdpZHRoOiA2NCxcbiAqICAgaGVpZ2h0OiA2NCxcbiAqICAgY2VsbFdpZHRoOiAxNixcbiAqICAgY2VsbEhlaWdodDogMTYsXG4gKiAgIGNlbnRlcmVkOiB0cnVlXG4gKiB9LCBncmFzc1RleHR1cmVzKTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVGlsZUdyaWQoXG4gIG9wdGlvbnM6IEdyaWRPcHRpb25zLFxuICB0ZXh0dXJlczogUElYSS5UZXh0dXJlW10sXG4gIHNlbGVjdG9yPzogKHBvc2l0aW9uOiBDZWxsUG9zaXRpb24pID0+IG51bWJlclxuKTogUElYSS5Db250YWluZXIge1xuICBjb25zdCB7IHdpZHRoLCBoZWlnaHQsIGNlbGxXaWR0aCwgY2VsbEhlaWdodCwgY2VudGVyZWQgPSBmYWxzZSB9ID0gb3B0aW9ucztcbiAgXG4gIC8vIERlZmF1bHQgc2VsZWN0b3IgcmFuZG9tbHkgY2hvb3NlcyB0ZXh0dXJlc1xuICBjb25zdCBkZWZhdWx0U2VsZWN0b3IgPSAoKSA9PiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0ZXh0dXJlcy5sZW5ndGgpO1xuICBjb25zdCBnZXRUZXh0dXJlSW5kZXggPSBzZWxlY3RvciB8fCBkZWZhdWx0U2VsZWN0b3I7XG4gIFxuICAvLyBDcmVhdGUgY29udGFpbmVyIGZvciB0aGUgZ3JpZFxuICBjb25zdCBjb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgXG4gIC8vIENhbGN1bGF0ZSB0b3RhbCBudW1iZXIgb2YgY2VsbHNcbiAgY29uc3QgdG90YWxDZWxscyA9IHdpZHRoICogaGVpZ2h0O1xuICBcbiAgLy8gR2VuZXJhdGUgZWFjaCBjZWxsIGluIHRoZSBncmlkXG4gIGZvciAobGV0IHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHtcbiAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHtcbiAgICAgIC8vIENhbGN1bGF0ZSBwaXhlbCBjb29yZGluYXRlc1xuICAgICAgY29uc3QgcGl4ZWxYID0geCAqIGNlbGxXaWR0aDtcbiAgICAgIGNvbnN0IHBpeGVsWSA9IHkgKiBjZWxsSGVpZ2h0O1xuICAgICAgXG4gICAgICAvLyBDYWxjdWxhdGUgaW5kZXhcbiAgICAgIGNvbnN0IGluZGV4ID0geSAqIHdpZHRoICsgeDtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIGNlbGwgcG9zaXRpb24gaW5mb1xuICAgICAgY29uc3QgcG9zaXRpb246IENlbGxQb3NpdGlvbiA9IHtcbiAgICAgICAgeCwgeSwgcGl4ZWxYLCBwaXhlbFksIGluZGV4LCB0b3RhbDogdG90YWxDZWxsc1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gR2V0IHRleHR1cmUgaW5kZXggZm9yIHRoaXMgcG9zaXRpb25cbiAgICAgIGNvbnN0IHRleHR1cmVJbmRleCA9IGdldFRleHR1cmVJbmRleChwb3NpdGlvbik7XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSBzcHJpdGUgd2l0aCB0aGUgc2VsZWN0ZWQgdGV4dHVyZVxuICAgICAgY29uc3QgY2VsbCA9IG5ldyBQSVhJLlNwcml0ZSh0ZXh0dXJlc1t0ZXh0dXJlSW5kZXhdKTtcbiAgICAgIGNlbGwucG9zaXRpb24uc2V0KHBpeGVsWCwgcGl4ZWxZKTtcbiAgICAgIFxuICAgICAgLy8gQWRkIHRvIGNvbnRhaW5lclxuICAgICAgY29udGFpbmVyLmFkZENoaWxkKGNlbGwpO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gQ2VudGVyIHRoZSBncmlkIGlmIHJlcXVlc3RlZFxuICBpZiAoY2VudGVyZWQpIHtcbiAgICBjb25zdCBncmlkV2lkdGggPSB3aWR0aCAqIGNlbGxXaWR0aDtcbiAgICBjb25zdCBncmlkSGVpZ2h0ID0gaGVpZ2h0ICogY2VsbEhlaWdodDtcbiAgICBjb250YWluZXIucG9zaXRpb24uc2V0KC1ncmlkV2lkdGggLyAyLCAtZ3JpZEhlaWdodCAvIDIpO1xuICB9XG4gIFxuICByZXR1cm4gY29udGFpbmVyO1xufVxuXG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgYSByYW5nZSBvZiB0ZXh0dXJlc1xuICogXG4gKiBAY2F0ZWdvcnkgTGlicmFyeVxuICogQHBhcmFtIHRleHR1cmVzIC0gRnVsbCBhcnJheSBvZiB0ZXh0dXJlc1xuICogQHBhcmFtIHN0YXJ0SW5kZXggLSBTdGFydGluZyBpbmRleCAoZnJvbSAwKVxuICogQHBhcmFtIGNvdW50IC0gTnVtYmVyIG9mIHRleHR1cmVzIHRvIGluY2x1ZGVcbiAqIEByZXR1cm5zIFN1YnNldCBvZiB0ZXh0dXJlc1xuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogLy8gR2V0IHRoZSBsYXN0IDEyIGZyYW1lcyBmcm9tIGEgc3ByaXRlc2hlZXRcbiAqIGNvbnN0IHRpbGVWYXJpYXRpb25zID0gZ2V0VGV4dHVyZVJhbmdlKGdyYXNzRnJhbWVzLCBncmFzc0ZyYW1lcy5sZW5ndGggLSAxMiwgMTIpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUZXh0dXJlUmFuZ2UoXG4gIHRleHR1cmVzOiBQSVhJLlRleHR1cmVbXSxcbiAgc3RhcnRJbmRleDogbnVtYmVyLFxuICBjb3VudDogbnVtYmVyXG4pOiBQSVhJLlRleHR1cmVbXSB7XG4gIHJldHVybiB0ZXh0dXJlcy5zbGljZShzdGFydEluZGV4LCBzdGFydEluZGV4ICsgY291bnQpO1xufVxuXG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IENvbnRhaW5lciwgR3JhcGhpY3MsIFRleHQgfSBmcm9tICdwaXhpLmpzJztcblxuZXhwb3J0IGludGVyZmFjZSBMb2FkaW5nU2NlbmVPcHRpb25zIHtcbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICBzcXVhcmVTaXplPzogbnVtYmVyO1xuICBudW1TcXVhcmVzPzogbnVtYmVyO1xuICB0ZXh0Pzogc3RyaW5nO1xuICB0ZXh0U3R5bGU/OiBQYXJ0aWFsPFBJWEkuVGV4dFN0eWxlPjtcbn1cblxuY29uc3QgUEFMRVRURSA9IFsweGYwZGFiMSwgMHhlMzlhYWMsIDB4YzQ1ZDlmLCAweDYzNGI3ZCwgMHg2NDYxYzIsIDB4MmJhOWI0LCAweDkzZDRiNSwgMHhmMGY2ZThdO1xuXG5pbnRlcmZhY2UgUGFydGljbGUge1xuICBzcHJpdGU6IEdyYXBoaWNzO1xuICBzcGF3blRpbWU6IG51bWJlcjtcbiAgZHVyYXRpb246IG51bWJlcjtcbiAgc3BpblJhdGU6IG51bWJlcjtcbiAgc3RhcnRYOiBudW1iZXI7XG4gIHN0YXJ0WTogbnVtYmVyO1xuICBlbmRZOiBudW1iZXI7XG59XG5cbi8qKlxuICogRGVmYXVsdCBsb2FkaW5nIHNjZW5lIGNvbXBvbmVudCBmb3IgTW94aVxuICogRGlzcGxheXMgYW5pbWF0ZWQgcGl4ZWwgc3F1YXJlcyBmYWxsaW5nIGFib3ZlIGxvYWRpbmcgdGV4dFxuICogXG4gKiBAY2F0ZWdvcnkgTGlicmFyeVxuICovXG5leHBvcnQgY2xhc3MgTG9hZGluZ1NjZW5lIGV4dGVuZHMgQ29udGFpbmVyIHtcbiAgcHJpdmF0ZSBwYXJ0aWNsZXM6IFBhcnRpY2xlW10gPSBbXTtcbiAgcHJpdmF0ZSB0ZXh0OiBUZXh0O1xuICBwcml2YXRlIGJhY2tncm91bmQ6IEdyYXBoaWNzO1xuICBwcml2YXRlIHRpY2tlcjogUElYSS5UaWNrZXI7XG4gIHByaXZhdGUgcmVuZGVyZXI6IFBJWEkuUmVuZGVyZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSB0aW1lOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIG5leHRTcGF3bjogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBtYXhQYXJ0aWNsZXM6IG51bWJlcjtcbiAgcHJpdmF0ZSBiYXNlU2l6ZTogbnVtYmVyO1xuICBwcml2YXRlIGJhY2tncm91bmRDb2xvcjogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IExvYWRpbmdTY2VuZU9wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG5cbiAgICBjb25zdCB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3IgPSAweDFhMWExYSxcbiAgICAgIHNxdWFyZVNpemUgPSAyMCxcbiAgICAgIG51bVNxdWFyZXMgPSAzMCxcbiAgICAgIHRleHQgPSAnTE9BRElORy4uLicsXG4gICAgICB0ZXh0U3R5bGUgPSB7fVxuICAgIH0gPSBvcHRpb25zO1xuXG4gICAgdGhpcy5tYXhQYXJ0aWNsZXMgPSBudW1TcXVhcmVzO1xuICAgIHRoaXMuYmFzZVNpemUgPSBzcXVhcmVTaXplO1xuICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gYmFja2dyb3VuZENvbG9yO1xuXG4gICAgLy8gQmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBHcmFwaGljcygpO1xuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kKTtcblxuICAgIC8vIFRleHRcbiAgICB0aGlzLnRleHQgPSBuZXcgVGV4dCh7XG4gICAgICB0ZXh0LFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgZm9udEZhbWlseTogJ0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnLFxuICAgICAgICBmb250U2l6ZTogMTYsXG4gICAgICAgIGZpbGw6IDB4ZmZmZmZmLFxuICAgICAgICBmb250V2VpZ2h0OiAnYm9sZCcsXG4gICAgICAgIC4uLnRleHRTdHlsZVxuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMudGV4dC5hbmNob3Iuc2V0KDAuNSk7XG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLnRleHQpO1xuXG4gICAgLy8gVGlja2VyXG4gICAgdGhpcy50aWNrZXIgPSBuZXcgUElYSS5UaWNrZXIoKTtcbiAgICB0aGlzLnRpY2tlci5hdXRvU3RhcnQgPSBmYWxzZTtcbiAgICB0aGlzLnRpY2tlci5hZGQoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMudmlzaWJsZSAmJiB0aGlzLnJlbmRlcmVyKSB7XG4gICAgICAgIHRoaXMudGltZSArPSB0aGlzLnRpY2tlci5kZWx0YVRpbWUgLyA2MDtcbiAgICAgICAgdGhpcy51cGRhdGUodGhpcy5yZW5kZXJlci53aWR0aCwgdGhpcy5yZW5kZXJlci5oZWlnaHQpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcih0aGlzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgc3Bhd25QYXJ0aWNsZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGlmICh0aGlzLnBhcnRpY2xlcy5sZW5ndGggPj0gdGhpcy5tYXhQYXJ0aWNsZXMgfHwgdGhpcy50aW1lIDwgdGhpcy5uZXh0U3Bhd24pIHJldHVybjtcblxuICAgIGNvbnN0IHNpemUgPSB0aGlzLmJhc2VTaXplICogKDAuNyArIE1hdGgucmFuZG9tKCkgKiAwLjYpO1xuICAgIGNvbnN0IHNwcml0ZSA9IG5ldyBHcmFwaGljcygpO1xuICAgIHNwcml0ZS5yZWN0KDAsIDAsIHNpemUsIHNpemUpO1xuICAgIHNwcml0ZS5maWxsKHsgY29sb3I6IFBBTEVUVEVbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogUEFMRVRURS5sZW5ndGgpXSB9KTtcbiAgICBzcHJpdGUucGl2b3Quc2V0KHNpemUgLyAyLCBzaXplIC8gMik7XG4gICAgdGhpcy5hZGRDaGlsZChzcHJpdGUpO1xuXG4gICAgY29uc3QgdGV4dFkgPSBoZWlnaHQgLyAyICsgNjA7XG4gICAgY29uc3QgdGV4dFdpZHRoID0gdGhpcy50ZXh0LndpZHRoIHx8IDIwMDtcbiAgICBjb25zdCB0ZXh0Q2VudGVyWCA9IHdpZHRoIC8gMjtcblxuICAgIHRoaXMucGFydGljbGVzLnB1c2goe1xuICAgICAgc3ByaXRlLFxuICAgICAgc3Bhd25UaW1lOiB0aGlzLnRpbWUsXG4gICAgICBkdXJhdGlvbjogMSArIE1hdGgucmFuZG9tKCkgKiAyLjUsXG4gICAgICBzcGluUmF0ZTogKDAuMDUgKyBNYXRoLnJhbmRvbSgpICogMS4wNzUpICogKE1hdGgucmFuZG9tKCkgPCAwLjUgPyAxIDogLTEpLFxuICAgICAgc3RhcnRYOiB0ZXh0Q2VudGVyWCAtIHRleHRXaWR0aCAvIDIgKyBNYXRoLnJhbmRvbSgpICogdGV4dFdpZHRoIC0gNCxcbiAgICAgIHN0YXJ0WTogdGV4dFkgLSAxMDAsXG4gICAgICBlbmRZOiB0ZXh0WSAtIDQwLFxuICAgIH0pO1xuXG4gICAgdGhpcy5uZXh0U3Bhd24gPSB0aGlzLnRpbWUgKyBNYXRoLnJhbmRvbSgpICogMC41O1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICAvLyBCYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kLmNsZWFyKCk7XG4gICAgdGhpcy5iYWNrZ3JvdW5kLnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgdGhpcy5iYWNrZ3JvdW5kLmZpbGwoeyBjb2xvcjogdGhpcy5iYWNrZ3JvdW5kQ29sb3IgfSk7XG5cbiAgICAvLyBUZXh0IHBvc2l0aW9uXG4gICAgdGhpcy50ZXh0LnggPSB3aWR0aCAvIDIgLSA0O1xuICAgIHRoaXMudGV4dC55ID0gaGVpZ2h0IC8gMiArIDYwO1xuXG4gICAgLy8gU3Bhd24gcGFydGljbGVzXG4gICAgdGhpcy5zcGF3blBhcnRpY2xlKHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgLy8gVXBkYXRlIHBhcnRpY2xlc1xuICAgIHRoaXMucGFydGljbGVzID0gdGhpcy5wYXJ0aWNsZXMuZmlsdGVyKHAgPT4ge1xuICAgICAgY29uc3QgZWxhcHNlZCA9IHRoaXMudGltZSAtIHAuc3Bhd25UaW1lO1xuICAgICAgY29uc3QgcHJvZ3Jlc3MgPSBlbGFwc2VkIC8gcC5kdXJhdGlvbjtcblxuICAgICAgaWYgKHByb2dyZXNzIDwgMCB8fCBwcm9ncmVzcyA+IDEpIHtcbiAgICAgICAgcC5zcHJpdGUuZGVzdHJveSgpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIHAuc3ByaXRlLnggPSBwLnN0YXJ0WDtcbiAgICAgIHAuc3ByaXRlLnkgPSBwLnN0YXJ0WSArIChwLmVuZFkgLSBwLnN0YXJ0WSkgKiBwcm9ncmVzcztcbiAgICAgIHAuc3ByaXRlLnJvdGF0aW9uID0gdGhpcy50aW1lICogcC5zcGluUmF0ZSAqIE1hdGguUEkgKiAyO1xuICAgICAgcC5zcHJpdGUuYWxwaGEgPSBwcm9ncmVzcyA8IDAuMSA/IHByb2dyZXNzIC8gMC4xIDogcHJvZ3Jlc3MgPiAwLjg1ID8gKDEgLSBwcm9ncmVzcykgLyAwLjE1IDogMTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuICB9XG5cbiAgaW5pdChyZW5kZXJlcjogUElYSS5SZW5kZXJlcik6IHZvaWQge1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgfVxuXG4gIHNob3coKTogdm9pZCB7XG4gICAgdGhpcy52aXNpYmxlID0gdHJ1ZTtcbiAgICB0aGlzLnRpbWUgPSAwO1xuICAgIHRoaXMubmV4dFNwYXduID0gMDtcbiAgICB0aGlzLnBhcnRpY2xlcy5mb3JFYWNoKHAgPT4gcC5zcHJpdGUuZGVzdHJveSgpKTtcbiAgICB0aGlzLnBhcnRpY2xlcyA9IFtdO1xuICAgIGlmICghdGhpcy50aWNrZXIuc3RhcnRlZCkge1xuICAgICAgdGhpcy50aWNrZXIuc3RhcnQoKTtcbiAgICB9XG4gIH1cblxuICBoaWRlKCk6IHZvaWQge1xuICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnRpY2tlci5zdGFydGVkKSB7XG4gICAgICB0aGlzLnRpY2tlci5zdG9wKCk7XG4gICAgfVxuICB9XG5cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aWNrZXIuc3RhcnRlZCkge1xuICAgICAgdGhpcy50aWNrZXIuc3RvcCgpO1xuICAgIH1cbiAgICB0aGlzLnRpY2tlci5kZXN0cm95KCk7XG4gICAgdGhpcy5wYXJ0aWNsZXMuZm9yRWFjaChwID0+IHAuc3ByaXRlLmRlc3Ryb3koKSk7XG4gICAgc3VwZXIuZGVzdHJveSgpO1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgTW94aUVudGl0eSwgQXNFbnRpdHksIGFzRW50aXR5IH0gZnJvbSAnLi4vY29yZS9tb3hpLWVudGl0eSc7XG5pbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4uL2NvcmUvbG9naWMnO1xuaW1wb3J0IHsgQ2FtZXJhIH0gZnJvbSAnLi4vY29yZS9jYW1lcmEnO1xuaW1wb3J0IHsgUGFyYWxsYXhMYXllciB9IGZyb20gJy4vcGFyYWxsYXgtbGF5ZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIFBhcmFsbGF4QmFja2dyb3VuZE9wdGlvbnMge1xuICBjYW1lcmE/OiBDYW1lcmE7ICAgICAgICAgICAgICAgICAgICAvLyBSZWZlcmVuY2UgdG8gY2FtZXJhIChhdXRvLWRldGVjdGVkIGlmIG5vdCBwcm92aWRlZClcbiAgc2Nyb2xsT2Zmc2V0PzogUElYSS5Qb2ludDsgICAgICAgICAgLy8gQmFzZSBzY3JvbGwgb2Zmc2V0XG4gIHNjcm9sbEJhc2VTY2FsZT86IFBJWEkuUG9pbnQ7ICAgICAgIC8vIEJhc2Ugc2NhbGUgbXVsdGlwbGllclxuICBzY3JvbGxJZ25vcmVDYW1lcmFab29tPzogYm9vbGVhbjsgICAvLyBEaXNhYmxlIHpvb20gYWZmZWN0aW5nIHBhcmFsbGF4XG4gIGF1dG9zY3JvbGw/OiBQSVhJLlBvaW50OyAgICAgICAgICAgIC8vIEF1dG9tYXRpYyBzY3JvbGxpbmcgaW5kZXBlbmRlbnQgb2YgY2FtZXJhXG59XG5cbi8qKlxuICogQ29udGFpbmVyIGZvciBhbGwgcGFyYWxsYXggbGF5ZXJzIHRoYXQgbWFuYWdlcyBnbG9iYWwgcGFyYWxsYXggYmVoYXZpb3JcbiAqIGFuZCBjb29yZGluYXRlcyB3aXRoIHRoZSBDYW1lcmEgc3lzdGVtLlxuICpcbiAqIEluc3BpcmVkIGJ5IEdvZG90J3MgUGFyYWxsYXhCYWNrZ3JvdW5kIG5vZGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHBhcmFsbGF4ID0gbmV3IFBhcmFsbGF4QmFja2dyb3VuZCgpO1xuICogY29uc3Qgc2t5TGF5ZXIgPSBuZXcgVGlsaW5nUGFyYWxsYXhMYXllcih7XG4gKiAgIHRleHR1cmU6IHNreVRleHR1cmUsXG4gKiAgIHNjcm9sbFNjYWxlOiBuZXcgUElYSS5Qb2ludCgwLjIsIDAuMilcbiAqIH0pO1xuICogcGFyYWxsYXguYWRkTGF5ZXIoc2t5TGF5ZXIpO1xuICogc2NlbmUuYWRkQ2hpbGQocGFyYWxsYXgpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBQYXJhbGxheEJhY2tncm91bmQgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lciBpbXBsZW1lbnRzIEFzRW50aXR5PFBJWEkuQ29udGFpbmVyPiB7XG4gIHB1YmxpYyBtb3hpRW50aXR5OiBNb3hpRW50aXR5PFBJWEkuQ29udGFpbmVyPjtcbiAgcHVibGljIGNhbWVyYTogQ2FtZXJhIHwgbnVsbCA9IG51bGw7XG4gIHB1YmxpYyBzY3JvbGxPZmZzZXQ6IFBJWEkuUG9pbnQgPSBuZXcgUElYSS5Qb2ludCgwLCAwKTtcbiAgcHVibGljIHNjcm9sbEJhc2VTY2FsZTogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDEsIDEpO1xuICBwdWJsaWMgc2Nyb2xsSWdub3JlQ2FtZXJhWm9vbTogYm9vbGVhbiA9IGZhbHNlO1xuICBwdWJsaWMgYXV0b3Njcm9sbDogUElYSS5Qb2ludCA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IFBhcmFsbGF4QmFja2dyb3VuZE9wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG5cbiAgICAvLyBBcHBseSBvcHRpb25zXG4gICAgdGhpcy5jYW1lcmEgPSBvcHRpb25zLmNhbWVyYSA/PyBudWxsO1xuICAgIHRoaXMuc2Nyb2xsT2Zmc2V0ID0gb3B0aW9ucy5zY3JvbGxPZmZzZXQgPz8gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG4gICAgdGhpcy5zY3JvbGxCYXNlU2NhbGUgPSBvcHRpb25zLnNjcm9sbEJhc2VTY2FsZSA/PyBuZXcgUElYSS5Qb2ludCgxLCAxKTtcbiAgICB0aGlzLnNjcm9sbElnbm9yZUNhbWVyYVpvb20gPSBvcHRpb25zLnNjcm9sbElnbm9yZUNhbWVyYVpvb20gPz8gZmFsc2U7XG4gICAgdGhpcy5hdXRvc2Nyb2xsID0gb3B0aW9ucy5hdXRvc2Nyb2xsID8/IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuXG4gICAgLy8gQ29udmVydCB0byBNb3hpIGVudGl0eSB3aXRoIFBhcmFsbGF4QmFja2dyb3VuZExvZ2ljXG4gICAgY29uc3QgZW50aXR5ID0gYXNFbnRpdHkodGhpcyk7XG4gICAgZW50aXR5Lm1veGlFbnRpdHkuYWRkTG9naWMobmV3IFBhcmFsbGF4QmFja2dyb3VuZExvZ2ljKCkpO1xuICAgIHRoaXMubW94aUVudGl0eSA9IGVudGl0eS5tb3hpRW50aXR5O1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBQYXJhbGxheExheWVyIHRvIHRoZSBiYWNrZ3JvdW5kXG4gICAqL1xuICBhZGRMYXllcihsYXllcjogUGFyYWxsYXhMYXllcik6IHZvaWQge1xuICAgIHRoaXMuYWRkQ2hpbGQobGF5ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIEF1dG8tZGV0ZWN0IGNhbWVyYSBmcm9tIHNjZW5lIGhpZXJhcmNoeVxuICAgKi9cbiAgcHJpdmF0ZSBkZXRlY3RDYW1lcmEoKTogQ2FtZXJhIHwgbnVsbCB7XG4gICAgbGV0IGN1cnJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICB3aGlsZSAoY3VycmVudCkge1xuICAgICAgaWYgKGN1cnJlbnQgaW5zdGFuY2VvZiBDYW1lcmEpIHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnQ7XG4gICAgICB9XG4gICAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnQ7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgZWZmZWN0aXZlIGNhbWVyYSBwb3NpdGlvbiBmb3IgcGFyYWxsYXggY2FsY3VsYXRpb25cbiAgICovXG4gIGdldENhbWVyYVBvc2l0aW9uKCk6IFBJWEkuUG9pbnQge1xuICAgIGNvbnN0IGNhbWVyYSA9IHRoaXMuY2FtZXJhID8/IHRoaXMuZGV0ZWN0Q2FtZXJhKCk7XG4gICAgaWYgKCFjYW1lcmEpIHtcbiAgICAgIHJldHVybiBuZXcgUElYSS5Qb2ludCgwLCAwKTtcbiAgICB9XG5cbiAgICAvLyBJbiBNT1hJJ3MgY2FtZXJhIHN5c3RlbSwgY2FtZXJhLnBvc2l0aW9uIHJlcHJlc2VudHMgd2hlcmUgdGhlIGNhbWVyYSBpcyBsb29raW5nXG4gICAgLy8gVGhlIHNjZW5lIGlzIHBvc2l0aW9uZWQgYXQgLWNhbWVyYS5wb3NpdGlvbiB0byBjcmVhdGUgdGhlIGNhbWVyYSBlZmZlY3RcbiAgICByZXR1cm4gbmV3IFBJWEkuUG9pbnQoXG4gICAgICBjYW1lcmEucG9zaXRpb24ueCxcbiAgICAgIGNhbWVyYS5wb3NpdGlvbi55XG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGVmZmVjdGl2ZSBjYW1lcmEgc2NhbGUvem9vbSBmb3IgcGFyYWxsYXggY2FsY3VsYXRpb25cbiAgICovXG4gIGdldENhbWVyYVNjYWxlKCk6IFBJWEkuUG9pbnQge1xuICAgIGlmICh0aGlzLnNjcm9sbElnbm9yZUNhbWVyYVpvb20pIHtcbiAgICAgIHJldHVybiBuZXcgUElYSS5Qb2ludCgxLCAxKTtcbiAgICB9XG5cbiAgICBjb25zdCBjYW1lcmEgPSB0aGlzLmNhbWVyYSA/PyB0aGlzLmRldGVjdENhbWVyYSgpO1xuICAgIGlmICghY2FtZXJhKSB7XG4gICAgICByZXR1cm4gbmV3IFBJWEkuUG9pbnQoMSwgMSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBQSVhJLlBvaW50KGNhbWVyYS5zY2FsZS54LCBjYW1lcmEuc2NhbGUueSk7XG4gIH1cbn1cblxuLyoqXG4gKiBMb2dpYyBjb21wb25lbnQgdGhhdCB1cGRhdGVzIHRoZSBwYXJhbGxheCBiYWNrZ3JvdW5kIGJhc2VkIG9uIGNhbWVyYSBtb3ZlbWVudCBhbmQgYXV0b3Njcm9sbC5cbiAqL1xuZXhwb3J0IGNsYXNzIFBhcmFsbGF4QmFja2dyb3VuZExvZ2ljIGV4dGVuZHMgTG9naWM8UGFyYWxsYXhCYWNrZ3JvdW5kPiB7XG4gIG5hbWUgPSAnUGFyYWxsYXhCYWNrZ3JvdW5kTG9naWMnO1xuXG4gIHVwZGF0ZShlbnRpdHk6IFBhcmFsbGF4QmFja2dyb3VuZCwgZGVsdGFUaW1lOiBudW1iZXIpIHtcbiAgICAvLyBBcHBseSBhdXRvc2Nyb2xsXG4gICAgaWYgKGVudGl0eS5hdXRvc2Nyb2xsLnggIT09IDAgfHwgZW50aXR5LmF1dG9zY3JvbGwueSAhPT0gMCkge1xuICAgICAgZW50aXR5LnNjcm9sbE9mZnNldC54ICs9IGVudGl0eS5hdXRvc2Nyb2xsLnggKiBkZWx0YVRpbWU7XG4gICAgICBlbnRpdHkuc2Nyb2xsT2Zmc2V0LnkgKz0gZW50aXR5LmF1dG9zY3JvbGwueSAqIGRlbHRhVGltZTtcbiAgICB9XG5cbiAgICAvLyBHZXQgY2FtZXJhIHBvc2l0aW9uIGZvciBjaGlsZCBsYXllcnMgdG8gcmVmZXJlbmNlXG4gICAgY29uc3QgY2FtZXJhUG9zID0gZW50aXR5LmdldENhbWVyYVBvc2l0aW9uKCk7XG4gICAgY29uc3QgY2FtZXJhU2NhbGUgPSBlbnRpdHkuZ2V0Q2FtZXJhU2NhbGUoKTtcblxuICAgIC8vIFBvc2l0aW9uIHRoZSBQYXJhbGxheEJhY2tncm91bmQgdG8gc3RheSBzY3JlZW4tYWxpZ25lZFxuICAgIC8vIFNpbmNlIFBhcmFsbGF4QmFja2dyb3VuZCBpcyBhIGNoaWxkIG9mIHNjZW5lIHdpdGggcGl2b3QgYXQgdmlld3BvcnQgY2VudGVyLFxuICAgIC8vIHdlIG5lZWQgdG8gY291bnRlci1zY2FsZSB0byBrZWVwIGxheWVycyBhdCAxOjEgc2NyZWVuIHNjYWxlXG4gICAgY29uc3Qgc2NlbmUgPSBlbnRpdHkucGFyZW50O1xuICAgIGlmIChzY2VuZSkge1xuICAgICAgLy8gUG9zaXRpb24gdG8gc3RheSBjZW50ZXJlZCBvbiB2aWV3cG9ydCBkZXNwaXRlIGNhbWVyYSBtb3ZlbWVudFxuICAgICAgLy8gQWNjb3VudCBmb3Igc2NlbmUgc2NhbGUgc2luY2Ugc2NlbmUucG9zaXRpb24gaXMgc2NhbGVkXG4gICAgICBlbnRpdHkucG9zaXRpb24ueCA9IGNhbWVyYVBvcy54IC8gc2NlbmUuc2NhbGUueDtcbiAgICAgIGVudGl0eS5wb3NpdGlvbi55ID0gY2FtZXJhUG9zLnkgLyBzY2VuZS5zY2FsZS55O1xuXG4gICAgICAvLyBDb3VudGVyLXNjYWxlIHRvIGNhbmNlbCBpbmhlcml0ZWQgc2NlbmUgc2NhbGVcbiAgICAgIC8vIFRoaXMga2VlcHMgVGlsaW5nU3ByaXRlIHNpemluZyBpbiBzY3JlZW4tc3BhY2UgY29vcmRpbmF0ZXNcbiAgICAgIGVudGl0eS5zY2FsZS54ID0gMSAvIHNjZW5lLnNjYWxlLng7XG4gICAgICBlbnRpdHkuc2NhbGUueSA9IDEgLyBzY2VuZS5zY2FsZS55O1xuICAgIH0gZWxzZSB7XG4gICAgICBlbnRpdHkucG9zaXRpb24ueCA9IGNhbWVyYVBvcy54O1xuICAgICAgZW50aXR5LnBvc2l0aW9uLnkgPSBjYW1lcmFQb3MueTtcbiAgICAgIGVudGl0eS5zY2FsZS5zZXQoMSwgMSk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGFsbCBjaGlsZCBQYXJhbGxheExheWVyc1xuICAgIGVudGl0eS5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZDogYW55KSA9PiB7XG4gICAgICBpZiAoY2hpbGQgaW5zdGFuY2VvZiBQYXJhbGxheExheWVyKSB7XG4gICAgICAgIGNoaWxkLnVwZGF0ZVBhcmFsbGF4KGNhbWVyYVBvcywgY2FtZXJhU2NhbGUsIGVudGl0eS5zY3JvbGxPZmZzZXQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgTW94aUVudGl0eSwgQXNFbnRpdHksIGFzRW50aXR5IH0gZnJvbSAnLi4vY29yZS9tb3hpLWVudGl0eSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFyYWxsYXhMYXllck9wdGlvbnMge1xuICBzY3JvbGxTY2FsZT86IFBJWEkuUG9pbnQ7ICAgICAgLy8gTW90aW9uIG11bHRpcGxpZXIgKDAuNSA9IGhhbGYgc3BlZWQsIGxpa2UgR29kb3QncyBtb3Rpb25fc2NhbGUpXG4gIHNjcm9sbE9mZnNldD86IFBJWEkuUG9pbnQ7ICAgICAvLyBMYXllciBvZmZzZXQgZm9yIHBvc2l0aW9uaW5nIChsaWtlIEdvZG90J3MgbW90aW9uX29mZnNldClcbiAgcmVwZWF0U2l6ZT86IFBJWEkuUG9pbnQ7ICAgICAgIC8vIE1pcnJvcmluZy9yZXBlYXQgaW50ZXJ2YWwgKDAgPSBubyByZXBlYXQsIGxpa2UgR29kb3QncyBtb3Rpb25fbWlycm9yaW5nKVxuICBtaXJyb3Jpbmc/OiBib29sZWFuOyAgICAgICAgICAgLy8gRW5hYmxlIGF1dG9tYXRpYyBtaXJyb3JpbmcgKHJlcXVpcmVzIHJlcGVhdFNpemUpXG59XG5cbi8qKlxuICogSW5kaXZpZHVhbCBwYXJhbGxheCBsYXllciB0aGF0IHNjcm9sbHMgYXQgYSBkaWZmZXJlbnQgc3BlZWQgYmFzZWQgb24gc2Nyb2xsU2NhbGUuXG4gKlxuICogSW5zcGlyZWQgYnkgR29kb3QncyBQYXJhbGxheExheWVyIG5vZGUuXG4gKlxuICogVGhlIHNjcm9sbFNjYWxlIHByb3BlcnR5IGNvbnRyb2xzIGhvdyBmYXN0IHRoZSBsYXllciBtb3ZlcyByZWxhdGl2ZSB0byB0aGUgY2FtZXJhOlxuICogLSAwLjAgPSBTdGF0aWMgKGRvZXNuJ3QgbW92ZSB3aXRoIGNhbWVyYSwgZ29vZCBmb3IgVUkvSFVEKVxuICogLSAwLjIgPSBTbG93IChhcHBlYXJzIGZhciBhd2F5LCBsaWtlIHNreSlcbiAqIC0gMC41ID0gTWVkaXVtIChtaWQtZ3JvdW5kIGVsZW1lbnRzKVxuICogLSAwLjkgPSBGYXN0IChmb3JlZ3JvdW5kIGVsZW1lbnRzKVxuICogLSAxLjAgPSBNb3ZlcyB3aXRoIGNhbWVyYSAoZ2FtZSBlbnRpdGllcylcbiAqIC0gPjEuMCA9IEZhc3RlciB0aGFuIGNhbWVyYSAocmV2ZXJzZSBwYXJhbGxheCBlZmZlY3QpXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGxheWVyID0gbmV3IFBhcmFsbGF4TGF5ZXIoe1xuICogICBzY3JvbGxTY2FsZTogbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpLCAvLyBIYWxmIGNhbWVyYSBzcGVlZFxuICogICBzY3JvbGxPZmZzZXQ6IG5ldyBQSVhJLlBvaW50KDAsIDApXG4gKiB9KTtcbiAqXG4gKiAvLyBBZGQgc3ByaXRlcyB0byB0aGUgbGF5ZXJcbiAqIGNvbnN0IHNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZSh0ZXh0dXJlKTtcbiAqIGxheWVyLmFkZENoaWxkKHNwcml0ZSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFBhcmFsbGF4TGF5ZXIgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lciBpbXBsZW1lbnRzIEFzRW50aXR5PFBJWEkuQ29udGFpbmVyPiB7XG4gIHB1YmxpYyBtb3hpRW50aXR5OiBNb3hpRW50aXR5PFBJWEkuQ29udGFpbmVyPjtcbiAgcHVibGljIHNjcm9sbFNjYWxlOiBQSVhJLlBvaW50ID0gbmV3IFBJWEkuUG9pbnQoMSwgMSk7XG4gIHB1YmxpYyBzY3JvbGxPZmZzZXQ6IFBJWEkuUG9pbnQgPSBuZXcgUElYSS5Qb2ludCgwLCAwKTtcbiAgcHVibGljIHJlcGVhdFNpemU6IFBJWEkuUG9pbnQgPSBuZXcgUElYSS5Qb2ludCgwLCAwKTtcbiAgcHVibGljIG1pcnJvcmluZzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIC8vIEludGVybmFsIHN0YXRlXG4gIHByaXZhdGUgX2xhc3RDYW1lcmFQb3M6IFBJWEkuUG9pbnQgPSBuZXcgUElYSS5Qb2ludCgwLCAwKTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBQYXJhbGxheExheWVyT3B0aW9ucyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMuc2Nyb2xsU2NhbGUgPSBvcHRpb25zLnNjcm9sbFNjYWxlID8/IG5ldyBQSVhJLlBvaW50KDEsIDEpO1xuICAgIHRoaXMuc2Nyb2xsT2Zmc2V0ID0gb3B0aW9ucy5zY3JvbGxPZmZzZXQgPz8gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG4gICAgdGhpcy5yZXBlYXRTaXplID0gb3B0aW9ucy5yZXBlYXRTaXplID8/IG5ldyBQSVhJLlBvaW50KDAsIDApO1xuICAgIHRoaXMubWlycm9yaW5nID0gb3B0aW9ucy5taXJyb3JpbmcgPz8gZmFsc2U7XG5cbiAgICAvLyBDb252ZXJ0IHRvIE1veGkgZW50aXR5XG4gICAgY29uc3QgZW50aXR5ID0gYXNFbnRpdHkodGhpcyk7XG4gICAgdGhpcy5tb3hpRW50aXR5ID0gZW50aXR5Lm1veGlFbnRpdHk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGxheWVyIHBvc2l0aW9uIGJhc2VkIG9uIGNhbWVyYSBtb3ZlbWVudC5cbiAgICogQ2FsbGVkIGJ5IFBhcmFsbGF4QmFja2dyb3VuZExvZ2ljIGVhY2ggZnJhbWUuXG4gICAqXG4gICAqIEBwYXJhbSBjYW1lcmFQb3MgLSBDdXJyZW50IGNhbWVyYSBwb3NpdGlvbiBpbiB3b3JsZCBzcGFjZVxuICAgKiBAcGFyYW0gY2FtZXJhU2NhbGUgLSBDdXJyZW50IGNhbWVyYSBzY2FsZS96b29tXG4gICAqIEBwYXJhbSBiYWNrZ3JvdW5kT2Zmc2V0IC0gR2xvYmFsIGJhY2tncm91bmQgc2Nyb2xsIG9mZnNldFxuICAgKi9cbiAgdXBkYXRlUGFyYWxsYXgoXG4gICAgY2FtZXJhUG9zOiBQSVhJLlBvaW50LFxuICAgIGNhbWVyYVNjYWxlOiBQSVhJLlBvaW50LFxuICAgIGJhY2tncm91bmRPZmZzZXQ6IFBJWEkuUG9pbnRcbiAgKTogdm9pZCB7XG4gICAgLy8gQ2FsY3VsYXRlIGVmZmVjdGl2ZSBzY3JvbGwgb2Zmc2V0XG4gICAgY29uc3Qgc2Nyb2xsWCA9IChjYW1lcmFQb3MueCArIGJhY2tncm91bmRPZmZzZXQueCkgKiB0aGlzLnNjcm9sbFNjYWxlLng7XG4gICAgY29uc3Qgc2Nyb2xsWSA9IChjYW1lcmFQb3MueSArIGJhY2tncm91bmRPZmZzZXQueSkgKiB0aGlzLnNjcm9sbFNjYWxlLnk7XG5cbiAgICAvLyBBcHBseSB0byBsYXllciBwb3NpdGlvblxuICAgIHRoaXMucG9zaXRpb24ueCA9IC1zY3JvbGxYICsgdGhpcy5zY3JvbGxPZmZzZXQueDtcbiAgICB0aGlzLnBvc2l0aW9uLnkgPSAtc2Nyb2xsWSArIHRoaXMuc2Nyb2xsT2Zmc2V0Lnk7XG5cbiAgICAvLyBIYW5kbGUgbWlycm9yaW5nL3dyYXBwaW5nIGlmIGVuYWJsZWRcbiAgICBpZiAodGhpcy5taXJyb3JpbmcpIHtcbiAgICAgIGlmICh0aGlzLnJlcGVhdFNpemUueCA+IDApIHtcbiAgICAgICAgdGhpcy5wb3NpdGlvbi54ID0gdGhpcy5wb3NpdGlvbi54ICUgdGhpcy5yZXBlYXRTaXplLng7XG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnggPiAwKSB0aGlzLnBvc2l0aW9uLnggLT0gdGhpcy5yZXBlYXRTaXplLng7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5yZXBlYXRTaXplLnkgPiAwKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb24ueSA9IHRoaXMucG9zaXRpb24ueSAlIHRoaXMucmVwZWF0U2l6ZS55O1xuICAgICAgICBpZiAodGhpcy5wb3NpdGlvbi55ID4gMCkgdGhpcy5wb3NpdGlvbi55IC09IHRoaXMucmVwZWF0U2l6ZS55O1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuX2xhc3RDYW1lcmFQb3MuY29weUZyb20oY2FtZXJhUG9zKTtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRpbGluZ1BhcmFsbGF4TGF5ZXJPcHRpb25zIGV4dGVuZHMgUGFyYWxsYXhMYXllck9wdGlvbnMge1xuICB0ZXh0dXJlOiBQSVhJLlRleHR1cmU7XG4gIHdpZHRoPzogbnVtYmVyO1xuICBoZWlnaHQ/OiBudW1iZXI7XG59XG5cbi8qKlxuICogU3BlY2lhbGl6ZWQgcGFyYWxsYXggbGF5ZXIgdXNpbmcgUElYSS5UaWxpbmdTcHJpdGUgZm9yIGVmZmljaWVudCBpbmZpbml0ZSBzY3JvbGxpbmcuXG4gKlxuICogVGhpcyBpcyB0aGUgcmVjb21tZW5kZWQgYXBwcm9hY2ggZm9yIGxhcmdlLCByZXBlYXRpbmcgYmFja2dyb3VuZHMgbGlrZSBza3ksIGNsb3VkcyxcbiAqIG9yIGdyb3VuZCB0ZXh0dXJlcy4gVGlsaW5nU3ByaXRlIGlzIG9wdGltaXplZCBmb3IgcmVwZWF0aW5nIHBhdHRlcm5zIGFuZCB1c2VzXG4gKiB0aWxlUG9zaXRpb24gZm9yIHNlYW1sZXNzIHNjcm9sbGluZyB3aXRob3V0IHJlcG9zaXRpb25pbmcgdGhlIGNvbnRhaW5lci5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3Qgc2t5TGF5ZXIgPSBuZXcgVGlsaW5nUGFyYWxsYXhMYXllcih7XG4gKiAgIHRleHR1cmU6IHNreVRleHR1cmUsXG4gKiAgIHNjcm9sbFNjYWxlOiBuZXcgUElYSS5Qb2ludCgwLjIsIDAuMilcbiAqICAgLy8gd2lkdGgvaGVpZ2h0IGF1dG8tZGV0ZWN0ZWQgZnJvbSByZW5kZXJlclxuICogfSk7XG4gKiBwYXJhbGxheEJhY2tncm91bmQuYWRkTGF5ZXIoc2t5TGF5ZXIpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBUaWxpbmdQYXJhbGxheExheWVyIGV4dGVuZHMgUGFyYWxsYXhMYXllciB7XG4gIHB1YmxpYyB0aWxpbmdTcHJpdGU6IFBJWEkuVGlsaW5nU3ByaXRlO1xuICBwcml2YXRlIF9hdXRvU2l6ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBUaWxpbmdQYXJhbGxheExheWVyT3B0aW9ucykge1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuXG4gICAgLy8gRW5zdXJlIHRleHR1cmUgd3JhcHMgZm9yIHNlYW1sZXNzIHRpbGluZ1xuICAgIG9wdGlvbnMudGV4dHVyZS5zb3VyY2Uuc3R5bGUuYWRkcmVzc01vZGUgPSAncmVwZWF0JztcblxuICAgIC8vIElmIGRpbWVuc2lvbnMgbm90IHByb3ZpZGVkLCB1c2UgdGVtcG9yYXJ5IHZhbHVlcyBhbmQgYXV0by1kZXRlY3Qgb24gZmlyc3QgdXBkYXRlXG4gICAgY29uc3Qgd2lkdGggPSBvcHRpb25zLndpZHRoID8/IDE7XG4gICAgY29uc3QgaGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQgPz8gMTtcblxuICAgIC8vIENyZWF0ZSBUaWxpbmdTcHJpdGUgYXMgY2hpbGRcbiAgICB0aGlzLnRpbGluZ1Nwcml0ZSA9IG5ldyBQSVhJLlRpbGluZ1Nwcml0ZSh7XG4gICAgICB0ZXh0dXJlOiBvcHRpb25zLnRleHR1cmUsXG4gICAgICB3aWR0aDogd2lkdGgsXG4gICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB9KTtcblxuICAgIC8vIFBvc2l0aW9uIFRpbGluZ1Nwcml0ZSB0byBzdGFydCBmcm9tIG9yaWdpbiAoMCwgMCkgdG8gY292ZXIgdGhlIHZpZXdwb3J0XG4gICAgdGhpcy50aWxpbmdTcHJpdGUucG9zaXRpb24uc2V0KDAsIDApO1xuXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLnRpbGluZ1Nwcml0ZSk7XG5cbiAgICAvLyBNYXJrIGlmIHdlIG5lZWQgdG8gYXV0by1kZXRlY3QgZGltZW5zaW9uc1xuICAgIHRoaXMuX2F1dG9TaXplZCA9ICFvcHRpb25zLndpZHRoICYmICFvcHRpb25zLmhlaWdodDtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdXRvLWRldGVjdCByZW5kZXJlciBkaW1lbnNpb25zIGZyb20gdGhlIHNjZW5lIGhpZXJhcmNoeVxuICAgKi9cbiAgcHJpdmF0ZSBhdXRvRGV0ZWN0RGltZW5zaW9ucygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuX2F1dG9TaXplZCkgcmV0dXJuO1xuXG4gICAgLy8gV2FsayB1cCBwYXJlbnQgY2hhaW4gdG8gZmluZCBhIG5vZGUgd2l0aCBhIHJlbmRlcmVyXG4gICAgbGV0IGN1cnJlbnQ6IGFueSA9IHRoaXMucGFyZW50O1xuICAgIHdoaWxlIChjdXJyZW50KSB7XG4gICAgICBpZiAoY3VycmVudC5yZW5kZXJlcikge1xuICAgICAgICAvLyBGb3VuZCBhIHJlbmRlcmVyICh1c3VhbGx5IG9uIFNjZW5lKVxuICAgICAgICB0aGlzLnJlc2l6ZShjdXJyZW50LnJlbmRlcmVyLndpZHRoLCBjdXJyZW50LnJlbmRlcmVyLmhlaWdodCk7XG4gICAgICAgIHRoaXMuX2F1dG9TaXplZCA9IGZhbHNlOyAvLyBPbmx5IG5lZWQgdG8gZG8gdGhpcyBvbmNlXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGN1cnJlbnQgPSBjdXJyZW50LnBhcmVudDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogT3ZlcnJpZGUgdXBkYXRlUGFyYWxsYXggdG8gdXNlIHRpbGVQb3NpdGlvbiBpbnN0ZWFkIG9mIGNvbnRhaW5lciBwb3NpdGlvbi5cbiAgICogVGhpcyBwcm92aWRlcyBzZWFtbGVzcyBpbmZpbml0ZSBzY3JvbGxpbmcgd2l0aG91dCB2aXNpYmxlIHNlYW1zLlxuICAgKlxuICAgKiBTaW5jZSB0aGUgUGFyYWxsYXhCYWNrZ3JvdW5kIGNvbnRhaW5lciBub3cgZm9sbG93cyB0aGUgY2FtZXJhLCBsYXllcnMgaW5zaWRlXG4gICAqIHN0YXkgYXQgKDAsMCkgYW5kIG9ubHkgdXNlIHRpbGVQb3NpdGlvbiBmb3IgdGhlIHBhcmFsbGF4IHNjcm9sbGluZyBlZmZlY3QuXG4gICAqXG4gICAqIENhbWVyYSBzY2FsZSBpcyB1c2VkIHRvIHJlc2l6ZSB0aGUgVGlsaW5nU3ByaXRlIHRvIGNvdmVyIHRoZSB2aWV3cG9ydCBhdCBkaWZmZXJlbnQgem9vbSBsZXZlbHMuXG4gICAqL1xuICB1cGRhdGVQYXJhbGxheChcbiAgICBjYW1lcmFQb3M6IFBJWEkuUG9pbnQsXG4gICAgY2FtZXJhU2NhbGU6IFBJWEkuUG9pbnQsXG4gICAgYmFja2dyb3VuZE9mZnNldDogUElYSS5Qb2ludFxuICApOiB2b2lkIHtcbiAgICAvLyBBdXRvLWRldGVjdCBkaW1lbnNpb25zIG9uIGZpcnN0IHVwZGF0ZSBpZiBub3QgbWFudWFsbHkgc3BlY2lmaWVkXG4gICAgdGhpcy5hdXRvRGV0ZWN0RGltZW5zaW9ucygpO1xuICAgIC8vIGNvbnNvbGUubG9nKCd1cGRhdGVQYXJhbGxheCcsIGNhbWVyYVNjYWxlKTtcblxuICAgIC8vIEdldCByZW5kZXJlciBkaW1lbnNpb25zIHRvIHVzZSBhcyBiYXNlIHNpemVcbiAgICBjb25zdCByZW5kZXJlciA9IHRoaXMucGFyZW50Py5wYXJlbnQgYXMgYW55OyAvLyBHZXQgcmVuZGVyZXIgZnJvbSBzY2VuZVxuICAgIGlmIChyZW5kZXJlcj8ucmVuZGVyZXIpIHtcbiAgICAgIGNvbnN0IGJhc2VXaWR0aCA9IHJlbmRlcmVyLnJlbmRlcmVyLndpZHRoO1xuICAgICAgY29uc3QgYmFzZUhlaWdodCA9IHJlbmRlcmVyLnJlbmRlcmVyLmhlaWdodDtcblxuICAgICAgLy8gUGFyYWxsYXhCYWNrZ3JvdW5kIGNvdW50ZXItc2NhbGVzLCBzbyB3ZSdyZSBpbiBzY3JlZW4tc3BhY2VcbiAgICAgIC8vIEp1c3Qgc2V0IHRvIHJlbmRlcmVyIHNpemUgLSBubyB6b29tIGFkanVzdG1lbnQgbmVlZGVkXG4gICAgICB0aGlzLnRpbGluZ1Nwcml0ZS53aWR0aCA9IGJhc2VXaWR0aDtcbiAgICAgIHRoaXMudGlsaW5nU3ByaXRlLmhlaWdodCA9IGJhc2VIZWlnaHQ7XG5cbiAgICAgIC8vIEtlZXAgc3ByaXRlIGF0IG9yaWdpblxuICAgICAgdGhpcy50aWxpbmdTcHJpdGUucGl2b3Quc2V0KDAsIDApO1xuICAgICAgdGhpcy50aWxpbmdTcHJpdGUucG9zaXRpb24uc2V0KDAsIDApO1xuICAgIH1cblxuICAgIC8vIENhbGN1bGF0ZSBlZmZlY3RpdmUgc2Nyb2xsIG9mZnNldCBmb3IgdGlsZVBvc2l0aW9uXG4gICAgY29uc3Qgc2Nyb2xsWCA9IChjYW1lcmFQb3MueCArIGJhY2tncm91bmRPZmZzZXQueCkgKiB0aGlzLnNjcm9sbFNjYWxlLng7XG4gICAgY29uc3Qgc2Nyb2xsWSA9IChjYW1lcmFQb3MueSArIGJhY2tncm91bmRPZmZzZXQueSkgKiB0aGlzLnNjcm9sbFNjYWxlLnk7XG5cbiAgICAvLyBBcHBseSB0byB0aWxlUG9zaXRpb24gKHdpdGggbGF5ZXIncyBvd24gc2Nyb2xsT2Zmc2V0IGZvciBwb3NpdGlvbmluZylcbiAgICB0aGlzLnRpbGluZ1Nwcml0ZS50aWxlUG9zaXRpb24ueCA9IC1zY3JvbGxYICsgdGhpcy5zY3JvbGxPZmZzZXQueDtcbiAgICB0aGlzLnRpbGluZ1Nwcml0ZS50aWxlUG9zaXRpb24ueSA9IC1zY3JvbGxZICsgdGhpcy5zY3JvbGxPZmZzZXQueTtcblxuICAgIC8vIExheWVyIGNvbnRhaW5lciBzdGF5cyBhdCBvcmlnaW4gLSBzY2VuZSBwaXZvdCBoYW5kbGVzIHpvb20gYW5jaG9yaW5nXG4gICAgdGhpcy5wb3NpdGlvbi5zZXQoMCwgMCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIFRpbGluZ1Nwcml0ZSBkaW1lbnNpb25zIChlLmcuLCBvbiB3aW5kb3cgcmVzaXplKVxuICAgKi9cbiAgcmVzaXplKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy50aWxpbmdTcHJpdGUud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLnRpbGluZ1Nwcml0ZS5oZWlnaHQgPSBoZWlnaHQ7XG4gIH1cbn1cbiIsIi8qKlxuICogUGh5c2ljcyBtb2R1bGUgLSBQbGFuY2suanMgaW50ZWdyYXRpb24gZm9yIE1PWElcbiAqXG4gKiBAcGFja2FnZURvY3VtZW50YXRpb25cbiAqL1xuXG4vLyBDb3JlIGNsYXNzZXNcbmV4cG9ydCB7IFBoeXNpY3NXb3JsZCB9IGZyb20gJy4vcGh5c2ljcy13b3JsZCc7XG5leHBvcnQgeyBQaHlzaWNzQm9keUxvZ2ljIH0gZnJvbSAnLi9waHlzaWNzLWJvZHktbG9naWMnO1xuZXhwb3J0IHsgQ29sbGlzaW9uUmVnaXN0cnksIENvbGxpc2lvbk1hbmFnZXIgfSBmcm9tICcuL3BoeXNpY3MtY29sbGlzaW9uJztcbmV4cG9ydCB7IFBoeXNpY3NEZWJ1Z1JlbmRlcmVyIH0gZnJvbSAnLi9waHlzaWNzLWRlYnVnLXJlbmRlcmVyJztcblxuLy8gVXRpbGl0aWVzXG5leHBvcnQge1xuICBhc1BoeXNpY3NFbnRpdHksXG4gIGhhc1BoeXNpY3MsXG4gIGdldFBoeXNpY3NCb2R5LFxuICBjcmVhdGVTaGFwZUZyb21TcHJpdGVcbn0gZnJvbSAnLi9waHlzaWNzLXV0aWxzJztcblxuLy8gTWF0ZXJpYWxzXG5leHBvcnQgeyBQaHlzaWNzTWF0ZXJpYWxzLCBhcHBseU1hdGVyaWFsIH0gZnJvbSAnLi9waHlzaWNzLW1hdGVyaWFscyc7XG5cbi8vIFR5cGVzXG5leHBvcnQgdHlwZSB7XG4gIEJvZHlUeXBlLFxuICBTeW5jTW9kZSxcbiAgU2hhcGVUeXBlLFxuICBDb2xsaXNpb25UYWcsXG4gIFNoYXBlQ29uZmlnLFxuICBQaHlzaWNzV29ybGRPcHRpb25zLFxuICBQaHlzaWNzQm9keU9wdGlvbnMsXG4gIFBoeXNpY3NEZWJ1Z09wdGlvbnMsXG4gIENvbGxpc2lvbkV2ZW50LFxuICBSYXljYXN0Q2FsbGJhY2tcbn0gZnJvbSAnLi9waHlzaWNzLXR5cGVzJztcbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgKiBhcyBwbGFuY2sgZnJvbSAncGxhbmNrJztcbmltcG9ydCB7IExvZ2ljIH0gZnJvbSAnLi4vLi4vY29yZS9sb2dpYyc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NXb3JsZCB9IGZyb20gJy4vcGh5c2ljcy13b3JsZCc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NCb2R5T3B0aW9ucywgQm9keVR5cGUsIFNoYXBlVHlwZSB9IGZyb20gJy4vcGh5c2ljcy10eXBlcyc7XG5pbXBvcnQgeyBwYXJzZUdyYXBoaWNzU2hhcGUgfSBmcm9tICcuL3BoeXNpY3MtZ3JhcGhpY3MtcGFyc2VyJztcblxuLyoqXG4gKiBQaHlzaWNzQm9keUxvZ2ljIC0gTG9naWMgY29tcG9uZW50IHRoYXQgc3luY2hyb25pemVzIGEgUElYSSBlbnRpdHkgd2l0aCBhIFBsYW5jay5qcyBwaHlzaWNzIGJvZHlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3Qgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xuICogY29uc3QgZW50aXR5ID0gYXNFbnRpdHkoc3ByaXRlKTtcbiAqXG4gKiBjb25zdCBwaHlzaWNzQm9keSA9IG5ldyBQaHlzaWNzQm9keUxvZ2ljKHBoeXNpY3NXb3JsZCwge1xuICogICB0eXBlOiAnZHluYW1pYycsXG4gKiAgIHNoYXBlOiAnY2lyY2xlJyxcbiAqICAgcmFkaXVzOiAyNSxcbiAqICAgZGVuc2l0eTogMS4wXG4gKiB9KTtcbiAqXG4gKiBlbnRpdHkubW94aUVudGl0eS5hZGRMb2dpYyhwaHlzaWNzQm9keSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFBoeXNpY3NCb2R5TG9naWMgZXh0ZW5kcyBMb2dpYzxQSVhJLkNvbnRhaW5lcj4ge1xuICBuYW1lID0gJ1BoeXNpY3NCb2R5TG9naWMnO1xuXG4gIC8qKiBUaGUgUGxhbmNrLmpzIHBoeXNpY3MgYm9keSAqL1xuICBwdWJsaWMgYm9keSE6IHBsYW5jay5Cb2R5O1xuXG4gIC8qKiBSZWZlcmVuY2UgdG8gdGhlIHBoeXNpY3Mgd29ybGQgKi9cbiAgcHVibGljIHdvcmxkOiBQaHlzaWNzV29ybGQ7XG5cbiAgLyoqIFBoeXNpY3MgYm9keSBvcHRpb25zICovXG4gIHB1YmxpYyBvcHRpb25zOiBQaHlzaWNzQm9keU9wdGlvbnM7XG5cbiAgLyoqIENvbGxpc2lvbiBiZWdpbiBjYWxsYmFjayAqL1xuICBwdWJsaWMgb25Db2xsaXNpb25CZWdpbj86IChvdGhlcjogUGh5c2ljc0JvZHlMb2dpYywgY29udGFjdDogcGxhbmNrLkNvbnRhY3QpID0+IHZvaWQ7XG5cbiAgLyoqIENvbGxpc2lvbiBlbmQgY2FsbGJhY2sgKi9cbiAgcHVibGljIG9uQ29sbGlzaW9uRW5kPzogKG90aGVyOiBQaHlzaWNzQm9keUxvZ2ljLCBjb250YWN0OiBwbGFuY2suQ29udGFjdCkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3Rvcih3b3JsZDogUGh5c2ljc1dvcmxkLCBvcHRpb25zOiBQaHlzaWNzQm9keU9wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy53b3JsZCA9IHdvcmxkO1xuICAgIHRoaXMub3B0aW9ucyA9IHtcbiAgICAgIHR5cGU6ICdkeW5hbWljJyxcbiAgICAgIHN5bmNNb2RlOiAncGh5c2ljcy1kcml2ZW4nLFxuICAgICAgc3luY1Bvc2l0aW9uOiB0cnVlLFxuICAgICAgc3luY1JvdGF0aW9uOiB0cnVlLFxuICAgICAgZGVuc2l0eTogMS4wLFxuICAgICAgZnJpY3Rpb246IDAuMyxcbiAgICAgIHJlc3RpdHV0aW9uOiAwLjAsXG4gICAgICBmaXhlZFJvdGF0aW9uOiBmYWxzZSxcbiAgICAgIGlzU2Vuc29yOiBmYWxzZSxcbiAgICAgIGJ1bGxldDogZmFsc2UsXG4gICAgICAuLi5vcHRpb25zXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHRoZSBwaHlzaWNzIGJvZHlcbiAgICovXG4gIGluaXQoZW50aXR5OiBQSVhJLkNvbnRhaW5lciwgcmVuZGVyZXI/OiBQSVhJLlJlbmRlcmVyKTogdm9pZCB7XG4gICAgLy8gQ3JlYXRlIHRoZSBwaHlzaWNzIGJvZHlcbiAgICB0aGlzLmNyZWF0ZVBoeXNpY3NCb2R5KGVudGl0eSk7XG5cbiAgICAvLyBTZXQgdXNlciBkYXRhIHRvIHJlZmVyZW5jZSB0aGlzIGxvZ2ljIGNvbXBvbmVudFxuICAgIHRoaXMuYm9keS5zZXRVc2VyRGF0YSh0aGlzKTtcblxuICAgIC8vIFJlZ2lzdGVyIHdpdGggcGh5c2ljcyB3b3JsZFxuICAgIHRoaXMud29ybGQucmVnaXN0ZXJCb2R5KHRoaXMuYm9keSwgdGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHN5bmNocm9uaXphdGlvbiBiZXR3ZWVuIHBoeXNpY3MgYW5kIHNwcml0ZVxuICAgKi9cbiAgdXBkYXRlKGVudGl0eTogUElYSS5Db250YWluZXIsIGRlbHRhVGltZT86IG51bWJlcik6IHZvaWQge1xuICAgIGlmICghdGhpcy5ib2R5KSByZXR1cm47XG5cbiAgICAvLyBTeW5jIGJhc2VkIG9uIG1vZGVcbiAgICBzd2l0Y2ggKHRoaXMub3B0aW9ucy5zeW5jTW9kZSkge1xuICAgICAgY2FzZSAncGh5c2ljcy1kcml2ZW4nOlxuICAgICAgICB0aGlzLnN5bmNGcm9tUGh5c2ljcyhlbnRpdHkpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3Nwcml0ZS1kcml2ZW4nOlxuICAgICAgICB0aGlzLnN5bmNUb1BoeXNpY3MoZW50aXR5KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdtYW51YWwnOlxuICAgICAgICAvLyBVc2VyIGhhbmRsZXMgc3luYyBtYW51YWxseVxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW4gdXAgcGh5c2ljcyBib2R5XG4gICAqL1xuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmJvZHkpIHtcbiAgICAgIHRoaXMud29ybGQuZGVzdHJveUJvZHkodGhpcy5ib2R5KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3luYyBzcHJpdGUgZnJvbSBwaHlzaWNzIGJvZHlcbiAgICovXG4gIHByaXZhdGUgc3luY0Zyb21QaHlzaWNzKGVudGl0eTogUElYSS5Db250YWluZXIpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYm9keSkgcmV0dXJuO1xuXG4gICAgY29uc3QgcG9zID0gdGhpcy5ib2R5LmdldFBvc2l0aW9uKCk7XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnN5bmNQb3NpdGlvbikge1xuICAgICAgZW50aXR5LnggPSB0aGlzLndvcmxkLnRvUGl4ZWxzKHBvcy54KTtcbiAgICAgIGVudGl0eS55ID0gdGhpcy53b3JsZC50b1BpeGVscyhwb3MueSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zeW5jUm90YXRpb24pIHtcbiAgICAgIGVudGl0eS5yb3RhdGlvbiA9IHRoaXMuYm9keS5nZXRBbmdsZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTeW5jIHBoeXNpY3MgYm9keSBmcm9tIHNwcml0ZVxuICAgKi9cbiAgc3luY1RvUGh5c2ljcyhlbnRpdHk6IFBJWEkuQ29udGFpbmVyKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmJvZHkpIHJldHVybjtcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuc3luY1Bvc2l0aW9uKSB7XG4gICAgICBjb25zdCB4ID0gdGhpcy53b3JsZC50b1BoeXNpY3MoZW50aXR5LngpO1xuICAgICAgY29uc3QgeSA9IHRoaXMud29ybGQudG9QaHlzaWNzKGVudGl0eS55KTtcbiAgICAgIHRoaXMuYm9keS5zZXRQb3NpdGlvbihwbGFuY2suVmVjMih4LCB5KSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zeW5jUm90YXRpb24pIHtcbiAgICAgIHRoaXMuYm9keS5zZXRBbmdsZShlbnRpdHkucm90YXRpb24pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgdGhlIFBsYW5jay5qcyBwaHlzaWNzIGJvZHlcbiAgICovXG4gIHByaXZhdGUgY3JlYXRlUGh5c2ljc0JvZHkoZW50aXR5OiBQSVhJLkNvbnRhaW5lcik6IHZvaWQge1xuICAgIC8vIERldGVybWluZSBib2R5IHR5cGVcbiAgICBsZXQgYm9keVR5cGU6IHBsYW5jay5Cb2R5VHlwZTtcbiAgICBzd2l0Y2ggKHRoaXMub3B0aW9ucy50eXBlKSB7XG4gICAgICBjYXNlICdzdGF0aWMnOlxuICAgICAgICBib2R5VHlwZSA9ICdzdGF0aWMnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2tpbmVtYXRpYyc6XG4gICAgICAgIGJvZHlUeXBlID0gJ2tpbmVtYXRpYyc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZHluYW1pYyc6XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBib2R5VHlwZSA9ICdkeW5hbWljJztcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGJvZHkgZGVmaW5pdGlvblxuICAgIGNvbnN0IGJvZHlEZWY6IHBsYW5jay5Cb2R5RGVmID0ge1xuICAgICAgdHlwZTogYm9keVR5cGUsXG4gICAgICBwb3NpdGlvbjogdGhpcy5vcHRpb25zLnBvc2l0aW9uXG4gICAgICAgID8gdGhpcy53b3JsZC50b1BoeXNpY3NQb2ludCh0aGlzLm9wdGlvbnMucG9zaXRpb24pXG4gICAgICAgIDogcGxhbmNrLlZlYzIodGhpcy53b3JsZC50b1BoeXNpY3MoZW50aXR5LngpLCB0aGlzLndvcmxkLnRvUGh5c2ljcyhlbnRpdHkueSkpLFxuICAgICAgYW5nbGU6IHRoaXMub3B0aW9ucy5yb3RhdGlvbiA/PyBlbnRpdHkucm90YXRpb24sXG4gICAgICBsaW5lYXJWZWxvY2l0eTogdGhpcy5vcHRpb25zLmxpbmVhclZlbG9jaXR5XG4gICAgICAgID8gdGhpcy53b3JsZC50b1BoeXNpY3NQb2ludCh0aGlzLm9wdGlvbnMubGluZWFyVmVsb2NpdHkpXG4gICAgICAgIDogcGxhbmNrLlZlYzIoMCwgMCksXG4gICAgICBhbmd1bGFyVmVsb2NpdHk6IHRoaXMub3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkgPz8gMCxcbiAgICAgIGZpeGVkUm90YXRpb246IHRoaXMub3B0aW9ucy5maXhlZFJvdGF0aW9uID8/IGZhbHNlLFxuICAgICAgYnVsbGV0OiB0aGlzLm9wdGlvbnMuYnVsbGV0ID8/IGZhbHNlXG4gICAgfTtcblxuICAgIC8vIENyZWF0ZSB0aGUgYm9keVxuICAgIHRoaXMuYm9keSA9IHRoaXMud29ybGQuY3JlYXRlQm9keShib2R5RGVmKTtcblxuICAgIC8vIENyZWF0ZSB0aGUgc2hhcGUgYW5kIGZpeHR1cmVcbiAgICB0aGlzLmNyZWF0ZUZpeHR1cmUoZW50aXR5KTtcblxuICAgIC8vIFNldCBpbml0aWFsIHZlbG9jaXRpZXMgaWYgcHJvdmlkZWRcbiAgICBpZiAodGhpcy5vcHRpb25zLmxpbmVhclZlbG9jaXR5KSB7XG4gICAgICB0aGlzLnNldFZlbG9jaXR5KHRoaXMub3B0aW9ucy5saW5lYXJWZWxvY2l0eSk7XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdGlvbnMuYW5ndWxhclZlbG9jaXR5KSB7XG4gICAgICB0aGlzLnNldEFuZ3VsYXJWZWxvY2l0eSh0aGlzLm9wdGlvbnMuYW5ndWxhclZlbG9jaXR5KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGZpeHR1cmUgd2l0aCBzaGFwZVxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVGaXh0dXJlKGVudGl0eTogUElYSS5Db250YWluZXIpOiB2b2lkIHtcbiAgICBjb25zdCBzaGFwZSA9IHRoaXMuY3JlYXRlU2hhcGUoZW50aXR5KTtcblxuICAgIC8vIFNldHVwIGNvbGxpc2lvbiBmaWx0ZXJpbmdcbiAgICBjb25zdCBjYXRlZ29yeUJpdHMgPSB0aGlzLm9wdGlvbnMuY29sbGlzaW9uVGFnc1xuICAgICAgPyB0aGlzLndvcmxkLmNvbGxpc2lvblJlZ2lzdHJ5LnRhZ3NUb0JpdHModGhpcy5vcHRpb25zLmNvbGxpc2lvblRhZ3MpXG4gICAgICA6IHRoaXMud29ybGQuY29sbGlzaW9uUmVnaXN0cnkuZ2V0Qml0KCdkZWZhdWx0Jyk7XG5cbiAgICBjb25zdCBtYXNrQml0cyA9IHRoaXMub3B0aW9ucy5jb2xsaWRlc1dpdGhcbiAgICAgID8gdGhpcy53b3JsZC5jb2xsaXNpb25SZWdpc3RyeS50YWdzVG9CaXRzKHRoaXMub3B0aW9ucy5jb2xsaWRlc1dpdGgpXG4gICAgICA6IDB4RkZGRjsgLy8gQ29sbGlkZSB3aXRoIGV2ZXJ5dGhpbmcgYnkgZGVmYXVsdFxuXG4gICAgY29uc3QgZ3JvdXBJbmRleCA9IHRoaXMub3B0aW9ucy5jb2xsaXNpb25Hcm91cCA/PyAwO1xuXG4gICAgLy8gQ3JlYXRlIGZpeHR1cmVcbiAgICB0aGlzLmJvZHkuY3JlYXRlRml4dHVyZSh7XG4gICAgICBzaGFwZTogc2hhcGUsXG4gICAgICBkZW5zaXR5OiB0aGlzLm9wdGlvbnMuZGVuc2l0eSA/PyAxLjAsXG4gICAgICBmcmljdGlvbjogdGhpcy5vcHRpb25zLmZyaWN0aW9uID8/IDAuMyxcbiAgICAgIHJlc3RpdHV0aW9uOiB0aGlzLm9wdGlvbnMucmVzdGl0dXRpb24gPz8gMC4wLFxuICAgICAgaXNTZW5zb3I6IHRoaXMub3B0aW9ucy5pc1NlbnNvciA/PyBmYWxzZSxcbiAgICAgIGZpbHRlckNhdGVnb3J5Qml0czogY2F0ZWdvcnlCaXRzLFxuICAgICAgZmlsdGVyTWFza0JpdHM6IG1hc2tCaXRzLFxuICAgICAgZmlsdGVyR3JvdXBJbmRleDogZ3JvdXBJbmRleFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBQbGFuY2sgc2hhcGUgZnJvbSBHcmFwaGljcyBnZW9tZXRyeSBvciBsZWdhY3kgb3B0aW9uc1xuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVTaGFwZShlbnRpdHk6IFBJWEkuQ29udGFpbmVyKTogcGxhbmNrLlNoYXBlIHtcbiAgICAvLyBQcmlvcml0eSAxOiBFeHBsaWNpdCBjb2xsaXNpb24gc2hhcGUgcHJvdmlkZWRcbiAgICBpZiAodGhpcy5vcHRpb25zLmNvbGxpc2lvblNoYXBlKSB7XG4gICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZUdyYXBoaWNzU2hhcGUodGhpcy5vcHRpb25zLmNvbGxpc2lvblNoYXBlLCB0aGlzLndvcmxkKTtcbiAgICAgIHJldHVybiBwYXJzZWQuc2hhcGU7XG4gICAgfVxuXG4gICAgLy8gUHJpb3JpdHkgMjogRW50aXR5IGl0c2VsZiBpcyBHcmFwaGljcyDihpIgZXh0cmFjdCBmcm9tIGl0XG4gICAgaWYgKGVudGl0eSBpbnN0YW5jZW9mIFBJWEkuR3JhcGhpY3MpIHtcbiAgICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlR3JhcGhpY3NTaGFwZShlbnRpdHksIHRoaXMud29ybGQpO1xuICAgICAgcmV0dXJuIHBhcnNlZC5zaGFwZTtcbiAgICB9XG5cbiAgICAvLyBQcmlvcml0eSAzOiBMZWdhY3kgc2hhcGUgcHJvcGVydGllcyAoYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcbiAgICBpZiAodGhpcy5vcHRpb25zLnNoYXBlKSB7XG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVTaGFwZUZyb21UeXBlKHRoaXMub3B0aW9ucy5zaGFwZSk7XG4gICAgfVxuXG4gICAgLy8gTm8gY29sbGlzaW9uIHNoYXBlIGRlZmluZWQgLSBlcnJvciBmb3Igbm9uLUdyYXBoaWNzIGVudGl0aWVzXG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ0NvbGxpc2lvbiBzaGFwZSByZXF1aXJlZCBmb3Igbm9uLUdyYXBoaWNzIGVudGl0aWVzLiAnICtcbiAgICAgICdFaXRoZXIgcHJvdmlkZSBhIEdyYXBoaWNzIGVudGl0eSwgb3Igc3BlY2lmeSBvcHRpb25zLmNvbGxpc2lvblNoYXBlLCAnICtcbiAgICAgICdvciB1c2UgbGVnYWN5IG9wdGlvbnMuc2hhcGUgd2l0aCBkaW1lbnNpb25zLidcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBzaGFwZSBmcm9tIGV4cGxpY2l0IHR5cGVcbiAgICovXG4gIHByaXZhdGUgY3JlYXRlU2hhcGVGcm9tVHlwZShzaGFwZVR5cGU6IFNoYXBlVHlwZSk6IHBsYW5jay5TaGFwZSB7XG4gICAgc3dpdGNoIChzaGFwZVR5cGUpIHtcbiAgICAgIGNhc2UgJ2NpcmNsZSc6XG4gICAgICAgIGNvbnN0IHJhZGl1cyA9IHRoaXMub3B0aW9ucy5yYWRpdXMgPz8gMjU7XG4gICAgICAgIHJldHVybiBwbGFuY2suQ2lyY2xlKHRoaXMud29ybGQudG9QaHlzaWNzKHJhZGl1cykpO1xuXG4gICAgICBjYXNlICdyZWN0YW5nbGUnOlxuICAgICAgICBjb25zdCB3aWR0aCA9IHRoaXMub3B0aW9ucy53aWR0aCA/PyA1MDtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5vcHRpb25zLmhlaWdodCA/PyA1MDtcbiAgICAgICAgcmV0dXJuIHBsYW5jay5Cb3goXG4gICAgICAgICAgdGhpcy53b3JsZC50b1BoeXNpY3Mod2lkdGggLyAyKSxcbiAgICAgICAgICB0aGlzLndvcmxkLnRvUGh5c2ljcyhoZWlnaHQgLyAyKVxuICAgICAgICApO1xuXG4gICAgICBjYXNlICdwb2x5Z29uJzpcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMudmVydGljZXMgfHwgdGhpcy5vcHRpb25zLnZlcnRpY2VzLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BvbHlnb24gc2hhcGUgcmVxdWlyZXMgYXQgbGVhc3QgMyB2ZXJ0aWNlcycpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZlcnRpY2VzID0gdGhpcy5vcHRpb25zLnZlcnRpY2VzLm1hcCh2ID0+XG4gICAgICAgICAgcGxhbmNrLlZlYzIodGhpcy53b3JsZC50b1BoeXNpY3Modi54KSwgdGhpcy53b3JsZC50b1BoeXNpY3Modi55KSlcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHBsYW5jay5Qb2x5Z29uKHZlcnRpY2VzKTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHNoYXBlIHR5cGU6ICR7c2hhcGVUeXBlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBdXRvLWRldGVjdCBzaGFwZSBmcm9tIHNwcml0ZSBib3VuZHNcbiAgICovXG4gIHByaXZhdGUgYXV0b0RldGVjdFNoYXBlKGVudGl0eTogUElYSS5Db250YWluZXIpOiBwbGFuY2suU2hhcGUge1xuICAgIC8vIEZvciBzcHJpdGVzLCB1c2UgdGV4dHVyZSBib3VuZHNcbiAgICBjb25zdCBib3VuZHMgPSBlbnRpdHkuZ2V0TG9jYWxCb3VuZHMoKTtcblxuICAgIC8vIERlZmF1bHQgdG8gcmVjdGFuZ2xlXG4gICAgcmV0dXJuIHBsYW5jay5Cb3goXG4gICAgICB0aGlzLndvcmxkLnRvUGh5c2ljcyhib3VuZHMud2lkdGggLyAyKSxcbiAgICAgIHRoaXMud29ybGQudG9QaHlzaWNzKGJvdW5kcy5oZWlnaHQgLyAyKVxuICAgICk7XG4gIH1cblxuICAvLyBQaHlzaWNzIGJvZHkgbWFuaXB1bGF0aW9uIG1ldGhvZHNcblxuICAvKipcbiAgICogQXBwbHkgZm9yY2UgYXQgYSBwb2ludFxuICAgKi9cbiAgYXBwbHlGb3JjZShmb3JjZTogUElYSS5Qb2ludCwgcG9pbnQ/OiBQSVhJLlBvaW50KTogdm9pZCB7XG4gICAgY29uc3QgZm9yY2VWZWMgPSB0aGlzLndvcmxkLnRvUGh5c2ljc1BvaW50KGZvcmNlKTtcbiAgICBjb25zdCBwb2ludFZlYyA9IHBvaW50XG4gICAgICA/IHRoaXMud29ybGQudG9QaHlzaWNzUG9pbnQocG9pbnQpXG4gICAgICA6IHRoaXMuYm9keS5nZXRXb3JsZENlbnRlcigpO1xuICAgIHRoaXMuYm9keS5hcHBseUZvcmNlKGZvcmNlVmVjLCBwb2ludFZlYyk7XG4gIH1cblxuICAvKipcbiAgICogQXBwbHkgaW1wdWxzZSBhdCBhIHBvaW50XG4gICAqL1xuICBhcHBseUltcHVsc2UoaW1wdWxzZTogUElYSS5Qb2ludCwgcG9pbnQ/OiBQSVhJLlBvaW50KTogdm9pZCB7XG4gICAgY29uc3QgaW1wdWxzZVZlYyA9IHRoaXMud29ybGQudG9QaHlzaWNzUG9pbnQoaW1wdWxzZSk7XG4gICAgY29uc3QgcG9pbnRWZWMgPSBwb2ludFxuICAgICAgPyB0aGlzLndvcmxkLnRvUGh5c2ljc1BvaW50KHBvaW50KVxuICAgICAgOiB0aGlzLmJvZHkuZ2V0V29ybGRDZW50ZXIoKTtcbiAgICB0aGlzLmJvZHkuYXBwbHlMaW5lYXJJbXB1bHNlKGltcHVsc2VWZWMsIHBvaW50VmVjKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcHBseSB0b3JxdWVcbiAgICovXG4gIGFwcGx5VG9ycXVlKHRvcnF1ZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5ib2R5LmFwcGx5VG9ycXVlKHRvcnF1ZSk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IGxpbmVhciB2ZWxvY2l0eVxuICAgKi9cbiAgc2V0VmVsb2NpdHkodmVsb2NpdHk6IFBJWEkuUG9pbnQpOiB2b2lkIHtcbiAgICBjb25zdCB2ZWxvY2l0eVZlYyA9IHRoaXMud29ybGQudG9QaHlzaWNzUG9pbnQodmVsb2NpdHkpO1xuICAgIHRoaXMuYm9keS5zZXRMaW5lYXJWZWxvY2l0eSh2ZWxvY2l0eVZlYyk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IGFuZ3VsYXIgdmVsb2NpdHlcbiAgICovXG4gIHNldEFuZ3VsYXJWZWxvY2l0eShvbWVnYTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5ib2R5LnNldEFuZ3VsYXJWZWxvY2l0eShvbWVnYSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGxpbmVhciB2ZWxvY2l0eVxuICAgKi9cbiAgZ2V0VmVsb2NpdHkoKTogUElYSS5Qb2ludCB7XG4gICAgY29uc3QgdmVsID0gdGhpcy5ib2R5LmdldExpbmVhclZlbG9jaXR5KCk7XG4gICAgcmV0dXJuIHRoaXMud29ybGQudG9QaXhlbHNQb2ludCh2ZWwpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbmd1bGFyIHZlbG9jaXR5XG4gICAqL1xuICBnZXRBbmd1bGFyVmVsb2NpdHkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5ib2R5LmdldEFuZ3VsYXJWZWxvY2l0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBtYXNzXG4gICAqL1xuICBnZXRNYXNzKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuYm9keS5nZXRNYXNzKCk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgYm9keSBpcyBhd2FrZVxuICAgKi9cbiAgaXNBd2FrZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5ib2R5LmlzQXdha2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBib2R5IGlzIHNsZWVwaW5nXG4gICAqL1xuICBpc1NsZWVwaW5nKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhdGhpcy5ib2R5LmlzQXdha2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgYXdha2Ugc3RhdGVcbiAgICovXG4gIHNldEF3YWtlKGF3YWtlOiBib29sZWFuKTogdm9pZCB7XG4gICAgdGhpcy5ib2R5LnNldEF3YWtlKGF3YWtlKTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCAqIGFzIHBsYW5jayBmcm9tICdwbGFuY2snO1xuaW1wb3J0IHR5cGUgeyBDb2xsaXNpb25UYWcsIENvbGxpc2lvbkV2ZW50IH0gZnJvbSAnLi9waHlzaWNzLXR5cGVzJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi9waHlzaWNzLXdvcmxkJztcblxuLyoqXG4gKiBDb2xsaXNpb24gY2F0ZWdvcnkgcmVnaXN0cnkgLSBjb252ZXJ0cyB0YWdzIHRvIGJpdCBtYXNrc1xuICogQXV0by1yZWdpc3RlcnMgdGFncyBhcyB0aGV5J3JlIHVzZWQgKG5vIGNvbmZpZ3VyYXRpb24gbmVlZGVkKVxuICpcbiAqIE1vZGVybiB0YWctYmFzZWQgY29sbGlzaW9uIHN5c3RlbSAoY29udmVydGVkIHRvIGJpdCBtYXNrcyBpbnRlcm5hbGx5IGZvciBQbGFuY2suanMpXG4gKlxuICogSW5zdGVhZCBvZiBvbGQtc2Nob29sIGJpdCBtYXNrcywgd2UgdXNlIHN0cmluZ3MgZm9yIGJldHRlciBEWDpcbiAqIC0gY29sbGlzaW9uVGFnczogWydwbGF5ZXInXSBpbnN0ZWFkIG9mIGJpdG1hc2sgMHgwMDAyXG4gKiAtIGNvbGxpZGVzV2l0aDogWyd0ZXJyYWluJywgJ2VuZW15J10gaW5zdGVhZCBvZiBtYXNrIG9wZXJhdGlvbnNcbiAqXG4gKiBUaGlzIGlzIGNvbnZlcnRlZCB0byBiaXQgbWFza3MgdW5kZXIgdGhlIGhvb2QgZm9yIFBsYW5jay5qcyBlZmZpY2llbmN5LlxuICovXG5leHBvcnQgY2xhc3MgQ29sbGlzaW9uUmVnaXN0cnkge1xuICBwcml2YXRlIHRhZ1RvQml0OiBNYXA8Q29sbGlzaW9uVGFnLCBudW1iZXI+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIGJpdFRvVGFnOiBNYXA8bnVtYmVyLCBDb2xsaXNpb25UYWc+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIG5leHRCaXQ6IG51bWJlciA9IDE7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8gUHJlLXJlZ2lzdGVyICdkZWZhdWx0JyB0YWdcbiAgICB0aGlzLnJlZ2lzdGVyKCdkZWZhdWx0Jyk7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgYSBjb2xsaXNpb24gdGFnIChjYWxsZWQgYXV0b21hdGljYWxseSB3aGVuIG5lZWRlZClcbiAgICovXG4gIHJlZ2lzdGVyKHRhZzogQ29sbGlzaW9uVGFnKTogdm9pZCB7XG4gICAgaWYgKHRoaXMudGFnVG9CaXQuaGFzKHRhZykpIHJldHVybjtcblxuICAgIGlmICh0aGlzLm5leHRCaXQgPiAweDgwMDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWF4aW11bSBjb2xsaXNpb24gdGFncyByZWFjaGVkICgxNiB0YWdzKScpO1xuICAgIH1cblxuICAgIHRoaXMudGFnVG9CaXQuc2V0KHRhZywgdGhpcy5uZXh0Qml0KTtcbiAgICB0aGlzLmJpdFRvVGFnLnNldCh0aGlzLm5leHRCaXQsIHRhZyk7XG4gICAgdGhpcy5uZXh0Qml0IDw8PSAxO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBiaXQgdmFsdWUgZm9yIGEgdGFnIChhdXRvLXJlZ2lzdGVycyBpZiBuZXcpXG4gICAqL1xuICBnZXRCaXQodGFnOiBDb2xsaXNpb25UYWcpOiBudW1iZXIge1xuICAgIGlmICghdGhpcy50YWdUb0JpdC5oYXModGFnKSkge1xuICAgICAgdGhpcy5yZWdpc3Rlcih0YWcpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy50YWdUb0JpdC5nZXQodGFnKSE7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRhZyBmcm9tIGJpdCB2YWx1ZVxuICAgKi9cbiAgZ2V0VGFnKGJpdDogbnVtYmVyKTogQ29sbGlzaW9uVGFnIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5iaXRUb1RhZy5nZXQoYml0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IGFycmF5IG9mIHRhZ3MgdG8gYml0IG1hc2tcbiAgICovXG4gIHRhZ3NUb0JpdHModGFnczogQ29sbGlzaW9uVGFnW10pOiBudW1iZXIge1xuICAgIGlmICghdGFncyB8fCB0YWdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0Qml0KCdkZWZhdWx0Jyk7XG4gICAgfVxuICAgIHJldHVybiB0YWdzLnJlZHVjZSgoYml0cywgdGFnKSA9PiBiaXRzIHwgdGhpcy5nZXRCaXQodGFnKSwgMCk7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBiaXQgbWFzayB0byBhcnJheSBvZiB0YWdzXG4gICAqL1xuICBiaXRzVG9UYWdzKGJpdHM6IG51bWJlcik6IENvbGxpc2lvblRhZ1tdIHtcbiAgICBjb25zdCB0YWdzOiBDb2xsaXNpb25UYWdbXSA9IFtdO1xuICAgIGZvciAoY29uc3QgW2JpdCwgdGFnXSBvZiB0aGlzLmJpdFRvVGFnKSB7XG4gICAgICBpZiAoYml0cyAmIGJpdCkge1xuICAgICAgICB0YWdzLnB1c2godGFnKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhZ3M7XG4gIH1cbn1cblxuLyoqXG4gKiBDb2xsaXNpb24gbWFuYWdlciAtIGhhbmRsZXMgY2FsbGJhY2tzXG4gKi9cbmV4cG9ydCBjbGFzcyBDb2xsaXNpb25NYW5hZ2VyIHtcbiAgcHJpdmF0ZSB3b3JsZDogUGh5c2ljc1dvcmxkO1xuICBwcml2YXRlIHJlZ2lzdHJ5OiBDb2xsaXNpb25SZWdpc3RyeTtcbiAgcHJpdmF0ZSBjYWxsYmFja3M6IE1hcDxzdHJpbmcsIFNldDwoZXZlbnQ6IENvbGxpc2lvbkV2ZW50KSA9PiB2b2lkPj4gPSBuZXcgTWFwKCk7XG5cbiAgY29uc3RydWN0b3Iod29ybGQ6IFBoeXNpY3NXb3JsZCwgcmVnaXN0cnk6IENvbGxpc2lvblJlZ2lzdHJ5KSB7XG4gICAgdGhpcy53b3JsZCA9IHdvcmxkO1xuICAgIHRoaXMucmVnaXN0cnkgPSByZWdpc3RyeTtcbiAgICB0aGlzLnNldHVwTGlzdGVuZXJzKCk7XG4gIH1cblxuICBwcml2YXRlIHNldHVwTGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIHRoaXMud29ybGQud29ybGQub24oJ2JlZ2luLWNvbnRhY3QnLCAoY29udGFjdDogcGxhbmNrLkNvbnRhY3QpID0+IHtcbiAgICAgIHRoaXMuaGFuZGxlQmVnaW5Db250YWN0KGNvbnRhY3QpO1xuICAgIH0pO1xuXG4gICAgdGhpcy53b3JsZC53b3JsZC5vbignZW5kLWNvbnRhY3QnLCAoY29udGFjdDogcGxhbmNrLkNvbnRhY3QpID0+IHtcbiAgICAgIHRoaXMuaGFuZGxlRW5kQ29udGFjdChjb250YWN0KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBjb2xsaXNpb24gY2FsbGJhY2sgYmV0d2VlbiB0d28gdGFnIGNhdGVnb3JpZXNcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogY29sbGlzaW9uTWFuYWdlci5vbkNvbGxpc2lvbigncGxheWVyJywgJ2VuZW15JywgKGV2ZW50KSA9PiB7XG4gICAqICAgY29uc29sZS5sb2coJ1BsYXllciBoaXQgZW5lbXkhJyk7XG4gICAqIH0pO1xuICAgKi9cbiAgb25Db2xsaXNpb24oXG4gICAgdGFnQTogQ29sbGlzaW9uVGFnLFxuICAgIHRhZ0I6IENvbGxpc2lvblRhZyxcbiAgICBjYWxsYmFjazogKGV2ZW50OiBDb2xsaXNpb25FdmVudCkgPT4gdm9pZFxuICApOiB2b2lkIHtcbiAgICBjb25zdCBrZXkgPSB0aGlzLm1ha2VLZXkodGFnQSwgdGFnQik7XG4gICAgaWYgKCF0aGlzLmNhbGxiYWNrcy5oYXMoa2V5KSkge1xuICAgICAgdGhpcy5jYWxsYmFja3Muc2V0KGtleSwgbmV3IFNldCgpKTtcbiAgICB9XG4gICAgdGhpcy5jYWxsYmFja3MuZ2V0KGtleSkhLmFkZChjYWxsYmFjayk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGNvbGxpc2lvbiBjYWxsYmFja1xuICAgKi9cbiAgb2ZmQ29sbGlzaW9uKFxuICAgIHRhZ0E6IENvbGxpc2lvblRhZyxcbiAgICB0YWdCOiBDb2xsaXNpb25UYWcsXG4gICAgY2FsbGJhY2s6IChldmVudDogQ29sbGlzaW9uRXZlbnQpID0+IHZvaWRcbiAgKTogdm9pZCB7XG4gICAgY29uc3Qga2V5ID0gdGhpcy5tYWtlS2V5KHRhZ0EsIHRhZ0IpO1xuICAgIHRoaXMuY2FsbGJhY2tzLmdldChrZXkpPy5kZWxldGUoY2FsbGJhY2spO1xuICB9XG5cbiAgcHJpdmF0ZSBtYWtlS2V5KHRhZ0E6IENvbGxpc2lvblRhZywgdGFnQjogQ29sbGlzaW9uVGFnKTogc3RyaW5nIHtcbiAgICAvLyBTb3J0IHRhZ3MgdG8gZW5zdXJlIGNvbnNpc3RlbnQga2V5IHJlZ2FyZGxlc3Mgb2Ygb3JkZXJcbiAgICByZXR1cm4gdGFnQSA8IHRhZ0IgPyBgJHt0YWdBfToke3RhZ0J9YCA6IGAke3RhZ0J9OiR7dGFnQX1gO1xuICB9XG5cbiAgLy8gVHJpZ2dlciBjYWxsYmFja3NcbiAgcHJpdmF0ZSBoYW5kbGVCZWdpbkNvbnRhY3QoY29udGFjdDogcGxhbmNrLkNvbnRhY3QpOiB2b2lkIHtcbiAgICBjb25zdCBib2R5QSA9IGNvbnRhY3QuZ2V0Rml4dHVyZUEoKS5nZXRCb2R5KCkuZ2V0VXNlckRhdGEoKSBhcyBhbnk7XG4gICAgY29uc3QgYm9keUIgPSBjb250YWN0LmdldEZpeHR1cmVCKCkuZ2V0Qm9keSgpLmdldFVzZXJEYXRhKCkgYXMgYW55O1xuXG4gICAgaWYgKCFib2R5QSB8fCAhYm9keUIpIHJldHVybjtcblxuICAgIC8vIENhbGwgZW50aXR5LWxldmVsIGNhbGxiYWNrc1xuICAgIGJvZHlBLm9uQ29sbGlzaW9uQmVnaW4/Lihib2R5QiwgY29udGFjdCk7XG4gICAgYm9keUIub25Db2xsaXNpb25CZWdpbj8uKGJvZHlBLCBjb250YWN0KTtcblxuICAgIC8vIENhbGwgZ2xvYmFsIHRhZy1iYXNlZCBjYWxsYmFja3NcbiAgICB0aGlzLnRyaWdnZXJUYWdDYWxsYmFja3MoYm9keUEsIGJvZHlCLCBjb250YWN0KTtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlRW5kQ29udGFjdChjb250YWN0OiBwbGFuY2suQ29udGFjdCk6IHZvaWQge1xuICAgIGNvbnN0IGJvZHlBID0gY29udGFjdC5nZXRGaXh0dXJlQSgpLmdldEJvZHkoKS5nZXRVc2VyRGF0YSgpIGFzIGFueTtcbiAgICBjb25zdCBib2R5QiA9IGNvbnRhY3QuZ2V0Rml4dHVyZUIoKS5nZXRCb2R5KCkuZ2V0VXNlckRhdGEoKSBhcyBhbnk7XG5cbiAgICBpZiAoIWJvZHlBIHx8ICFib2R5QikgcmV0dXJuO1xuXG4gICAgYm9keUEub25Db2xsaXNpb25FbmQ/Lihib2R5QiwgY29udGFjdCk7XG4gICAgYm9keUIub25Db2xsaXNpb25FbmQ/Lihib2R5QSwgY29udGFjdCk7XG4gIH1cblxuICBwcml2YXRlIHRyaWdnZXJUYWdDYWxsYmFja3MoXG4gICAgYm9keUE6IGFueSxcbiAgICBib2R5QjogYW55LFxuICAgIGNvbnRhY3Q6IHBsYW5jay5Db250YWN0XG4gICk6IHZvaWQge1xuICAgIC8vIEdldCB0YWdzIGZyb20gYm90aCBib2RpZXNcbiAgICBjb25zdCB0YWdzQSA9IGJvZHlBLm9wdGlvbnMuY29sbGlzaW9uVGFncyB8fCBbXTtcbiAgICBjb25zdCB0YWdzQiA9IGJvZHlCLm9wdGlvbnMuY29sbGlzaW9uVGFncyB8fCBbXTtcblxuICAgIC8vIENoZWNrIGFsbCB0YWcgY29tYmluYXRpb25zXG4gICAgZm9yIChjb25zdCB0YWdBIG9mIHRhZ3NBKSB7XG4gICAgICBmb3IgKGNvbnN0IHRhZ0Igb2YgdGFnc0IpIHtcbiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5tYWtlS2V5KHRhZ0EsIHRhZ0IpO1xuICAgICAgICBjb25zdCBjYWxsYmFja3MgPSB0aGlzLmNhbGxiYWNrcy5nZXQoa2V5KTtcblxuICAgICAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgICAgY29uc3QgZXZlbnQ6IENvbGxpc2lvbkV2ZW50ID0ge1xuICAgICAgICAgICAgYm9keUEsXG4gICAgICAgICAgICBib2R5QixcbiAgICAgICAgICAgIGNvbnRhY3QsXG4gICAgICAgICAgICBub3JtYWw6IG5ldyBQSVhJLlBvaW50KDAsIDApLCAvLyBUT0RPOiBFeHRyYWN0IGZyb20gY29udGFjdFxuICAgICAgICAgICAgaW1wdWxzZTogMCAvLyBUT0RPOiBFeHRyYWN0IGZyb20gY29udGFjdFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBjYWxsYmFja3MuZm9yRWFjaChjYiA9PiBjYihldmVudCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0ICogYXMgcGxhbmNrIGZyb20gJ3BsYW5jayc7XG5pbXBvcnQgeyBMb2dpYyB9IGZyb20gJy4uLy4uL2NvcmUvbG9naWMnO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzV29ybGQgfSBmcm9tICcuL3BoeXNpY3Mtd29ybGQnO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzRGVidWdPcHRpb25zIH0gZnJvbSAnLi9waHlzaWNzLXR5cGVzJztcblxuLyoqXG4gKiBQaHlzaWNzRGVidWdSZW5kZXJlciAtIFZpc3VhbGl6ZXMgY29sbGlzaW9uIHNoYXBlcywgdmVsb2NpdHkgdmVjdG9ycywgYW5kIHBoeXNpY3Mgc3RhdGVcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgZGVidWdSZW5kZXJlciA9IHBoeXNpY3NXb3JsZC5lbmFibGVEZWJ1Z1JlbmRlcmVyKHNjZW5lKTtcbiAqXG4gKiAvLyBUb2dnbGUgd2l0aCBrZXlib2FyZFxuICogZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG4gKiAgIGlmIChlLmtleSA9PT0gJ3AnKSBkZWJ1Z1JlbmRlcmVyLnRvZ2dsZSgpO1xuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFBoeXNpY3NEZWJ1Z1JlbmRlcmVyIGV4dGVuZHMgTG9naWM8UElYSS5HcmFwaGljcz4ge1xuICBuYW1lID0gJ1BoeXNpY3NEZWJ1Z1JlbmRlcmVyJztcblxuICBwcml2YXRlIHdvcmxkOiBQaHlzaWNzV29ybGQ7XG4gIHByaXZhdGUgZ3JhcGhpY3MhOiBQSVhJLkdyYXBoaWNzO1xuICBwcml2YXRlIG9wdGlvbnM6IFJlcXVpcmVkPFBoeXNpY3NEZWJ1Z09wdGlvbnM+O1xuICBwcml2YXRlIGlzVmlzaWJsZTogYm9vbGVhbiA9IHRydWU7XG5cbiAgY29uc3RydWN0b3Iod29ybGQ6IFBoeXNpY3NXb3JsZCwgb3B0aW9uczogUGh5c2ljc0RlYnVnT3B0aW9ucyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLndvcmxkID0gd29ybGQ7XG4gICAgdGhpcy5vcHRpb25zID0ge1xuICAgICAgc2hvd1NoYXBlczogb3B0aW9ucy5zaG93U2hhcGVzID8/IHRydWUsXG4gICAgICBzaG93VmVsb2NpdGllczogb3B0aW9ucy5zaG93VmVsb2NpdGllcyA/PyBmYWxzZSxcbiAgICAgIHNob3dBQUJCczogb3B0aW9ucy5zaG93QUFCQnMgPz8gZmFsc2UsXG4gICAgICBzaG93Q2VudGVyT2ZNYXNzOiBvcHRpb25zLnNob3dDZW50ZXJPZk1hc3MgPz8gZmFsc2UsXG4gICAgICBzaG93Q29udGFjdFBvaW50czogb3B0aW9ucy5zaG93Q29udGFjdFBvaW50cyA/PyBmYWxzZSxcbiAgICAgIHNob3dKb2ludHM6IG9wdGlvbnMuc2hvd0pvaW50cyA/PyBmYWxzZSxcbiAgICAgIGNvbG9yU3RhdGljOiBvcHRpb25zLmNvbG9yU3RhdGljID8/IDB4MDBGRjAwLFxuICAgICAgY29sb3JEeW5hbWljOiBvcHRpb25zLmNvbG9yRHluYW1pYyA/PyAweEZGMDAwMCxcbiAgICAgIGNvbG9yS2luZW1hdGljOiBvcHRpb25zLmNvbG9yS2luZW1hdGljID8/IDB4MDAwMEZGLFxuICAgICAgY29sb3JTbGVlcGluZzogb3B0aW9ucy5jb2xvclNsZWVwaW5nID8/IDB4QUFBQUFBLFxuICAgICAgY29sb3JTZW5zb3I6IG9wdGlvbnMuY29sb3JTZW5zb3IgPz8gMHhGRkZGMDAsXG4gICAgICBhbHBoYTogb3B0aW9ucy5hbHBoYSA/PyAwLjUsXG4gICAgICBsaW5lV2lkdGg6IG9wdGlvbnMubGluZVdpZHRoID8/IDJcbiAgICB9O1xuICB9XG5cbiAgaW5pdChlbnRpdHk6IFBJWEkuR3JhcGhpY3MsIHJlbmRlcmVyPzogUElYSS5SZW5kZXJlcik6IHZvaWQge1xuICAgIHRoaXMuZ3JhcGhpY3MgPSBlbnRpdHk7XG4gIH1cblxuICB1cGRhdGUoZW50aXR5OiBQSVhJLkdyYXBoaWNzLCBkZWx0YVRpbWU/OiBudW1iZXIpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuaXNWaXNpYmxlKSB7XG4gICAgICB0aGlzLmdyYXBoaWNzLmNsZWFyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5ncmFwaGljcy5jbGVhcigpO1xuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zaG93U2hhcGVzKSB7XG4gICAgICAvLyBJdGVyYXRlIGFsbCBib2RpZXMgaW4gcGh5c2ljcyB3b3JsZFxuICAgICAgZm9yIChsZXQgYm9keSA9IHRoaXMud29ybGQud29ybGQuZ2V0Qm9keUxpc3QoKTsgYm9keTsgYm9keSA9IGJvZHkuZ2V0TmV4dCgpKSB7XG4gICAgICAgIHRoaXMuZHJhd0JvZHkoYm9keSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zaG93Q29udGFjdFBvaW50cykge1xuICAgICAgdGhpcy5kcmF3Q29udGFjdHMoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRyYXdCb2R5KGJvZHk6IHBsYW5jay5Cb2R5KTogdm9pZCB7XG4gICAgY29uc3QgdHJhbnNmb3JtID0gYm9keS5nZXRUcmFuc2Zvcm0oKTtcblxuICAgIC8vIERldGVybWluZSBjb2xvciBiYXNlZCBvbiBib2R5IHR5cGUgYW5kIHN0YXRlXG4gICAgbGV0IGNvbG9yOiBudW1iZXI7XG5cbiAgICBpZiAoIWJvZHkuaXNBd2FrZSgpICYmIGJvZHkuaXNEeW5hbWljKCkpIHtcbiAgICAgIGNvbG9yID0gdGhpcy5vcHRpb25zLmNvbG9yU2xlZXBpbmc7XG4gICAgfSBlbHNlIGlmIChib2R5LmlzU3RhdGljKCkpIHtcbiAgICAgIGNvbG9yID0gdGhpcy5vcHRpb25zLmNvbG9yU3RhdGljO1xuICAgIH0gZWxzZSBpZiAoYm9keS5pc0tpbmVtYXRpYygpKSB7XG4gICAgICBjb2xvciA9IHRoaXMub3B0aW9ucy5jb2xvcktpbmVtYXRpYztcbiAgICB9IGVsc2Uge1xuICAgICAgY29sb3IgPSB0aGlzLm9wdGlvbnMuY29sb3JEeW5hbWljO1xuICAgIH1cblxuICAgIC8vIERyYXcgZWFjaCBmaXh0dXJlXG4gICAgZm9yIChsZXQgZml4dHVyZSA9IGJvZHkuZ2V0Rml4dHVyZUxpc3QoKTsgZml4dHVyZTsgZml4dHVyZSA9IGZpeHR1cmUuZ2V0TmV4dCgpKSB7XG4gICAgICBjb25zdCBzaGFwZSA9IGZpeHR1cmUuZ2V0U2hhcGUoKTtcblxuICAgICAgLy8gVXNlIHllbGxvdyBzZW1pLXRyYW5zcGFyZW50IGZvciBzZW5zb3JzXG4gICAgICBjb25zdCBmaXh0dXJlQ29sb3IgPSBmaXh0dXJlLmlzU2Vuc29yKCkgPyB0aGlzLm9wdGlvbnMuY29sb3JTZW5zb3IgOiBjb2xvcjtcbiAgICAgIGNvbnN0IGFscGhhID0gZml4dHVyZS5pc1NlbnNvcigpID8gdGhpcy5vcHRpb25zLmFscGhhICogMC41IDogdGhpcy5vcHRpb25zLmFscGhhO1xuXG4gICAgICB0aGlzLmRyYXdTaGFwZShzaGFwZSwgdHJhbnNmb3JtLCBmaXh0dXJlQ29sb3IsIGFscGhhKTtcbiAgICB9XG5cbiAgICAvLyBEcmF3IHZlbG9jaXR5IHZlY3RvciBpZiBlbmFibGVkXG4gICAgaWYgKHRoaXMub3B0aW9ucy5zaG93VmVsb2NpdGllcyAmJiBib2R5LmlzRHluYW1pYygpKSB7XG4gICAgICB0aGlzLmRyYXdWZWxvY2l0eShib2R5KTtcbiAgICB9XG5cbiAgICAvLyBEcmF3IEFBQkIgaWYgZW5hYmxlZFxuICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd0FBQkJzKSB7XG4gICAgICB0aGlzLmRyYXdBQUJCKGJvZHkpO1xuICAgIH1cblxuICAgIC8vIERyYXcgY2VudGVyIG9mIG1hc3MgaWYgZW5hYmxlZFxuICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd0NlbnRlck9mTWFzcykge1xuICAgICAgdGhpcy5kcmF3Q2VudGVyT2ZNYXNzKGJvZHkpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZHJhd1NoYXBlKHNoYXBlOiBwbGFuY2suU2hhcGUsIHRyYW5zZm9ybTogcGxhbmNrLlRyYW5zZm9ybSwgY29sb3I6IG51bWJlciwgYWxwaGE6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKHtcbiAgICAgIHdpZHRoOiB0aGlzLm9wdGlvbnMubGluZVdpZHRoLFxuICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgYWxwaGE6IGFscGhhXG4gICAgfSk7XG5cbiAgICBjb25zdCBzaGFwZVR5cGUgPSBzaGFwZS5nZXRUeXBlKCk7XG5cbiAgICBpZiAoc2hhcGVUeXBlID09PSAnY2lyY2xlJykge1xuICAgICAgY29uc3QgY2lyY2xlID0gc2hhcGUgYXMgcGxhbmNrLkNpcmNsZVNoYXBlO1xuICAgICAgY29uc3QgY2VudGVyID0gcGxhbmNrLlZlYzIuYWRkKHRyYW5zZm9ybS5wLCBwbGFuY2suUm90Lm11bFZlYzIodHJhbnNmb3JtLnEsIGNpcmNsZS5nZXRDZW50ZXIoKSkpO1xuICAgICAgY29uc3QgcmFkaXVzID0gY2lyY2xlLmdldFJhZGl1cygpO1xuXG4gICAgICBjb25zdCBwaXhlbENlbnRlciA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChjZW50ZXIpO1xuICAgICAgY29uc3QgcGl4ZWxSYWRpdXMgPSB0aGlzLndvcmxkLnRvUGl4ZWxzKHJhZGl1cyk7XG5cbiAgICAgIHRoaXMuZ3JhcGhpY3MuY2lyY2xlKHBpeGVsQ2VudGVyLngsIHBpeGVsQ2VudGVyLnksIHBpeGVsUmFkaXVzKTtcbiAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG5cbiAgICAgIC8vIERyYXcgcmFkaXVzIGxpbmUgdG8gc2hvdyByb3RhdGlvblxuICAgICAgY29uc3QgYW5nbGUgPSB0cmFuc2Zvcm0ucS5nZXRBbmdsZSgpO1xuICAgICAgY29uc3QgZW5kWCA9IHBpeGVsQ2VudGVyLnggKyBNYXRoLmNvcyhhbmdsZSkgKiBwaXhlbFJhZGl1cztcbiAgICAgIGNvbnN0IGVuZFkgPSBwaXhlbENlbnRlci55ICsgTWF0aC5zaW4oYW5nbGUpICogcGl4ZWxSYWRpdXM7XG4gICAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwaXhlbENlbnRlci54LCBwaXhlbENlbnRlci55KTtcbiAgICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKGVuZFgsIGVuZFkpO1xuICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2UoKTtcbiAgICB9IGVsc2UgaWYgKHNoYXBlVHlwZSA9PT0gJ3BvbHlnb24nKSB7XG4gICAgICBjb25zdCBwb2x5ID0gc2hhcGUgYXMgcGxhbmNrLlBvbHlnb25TaGFwZTtcbiAgICAgIGNvbnN0IHZlcnRpY2VzID0gcG9seS5tX3ZlcnRpY2VzO1xuXG4gICAgICBpZiAodmVydGljZXMgJiYgdmVydGljZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBUcmFuc2Zvcm0gZmlyc3QgdmVydGV4XG4gICAgICAgIGNvbnN0IGZpcnN0VmVydGV4ID0gcGxhbmNrLlZlYzIuYWRkKHRyYW5zZm9ybS5wLCBwbGFuY2suUm90Lm11bFZlYzIodHJhbnNmb3JtLnEsIHZlcnRpY2VzWzBdKSk7XG4gICAgICAgIGNvbnN0IHBpeGVsRmlyc3QgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQoZmlyc3RWZXJ0ZXgpO1xuXG4gICAgICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsRmlyc3QueCwgcGl4ZWxGaXJzdC55KTtcblxuICAgICAgICAvLyBUcmFuc2Zvcm0gYW5kIGRyYXcgcmVtYWluaW5nIHZlcnRpY2VzXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdmVydGljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCB2ZXJ0ZXggPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgdmVydGljZXNbaV0pKTtcbiAgICAgICAgICBjb25zdCBwaXhlbFZlcnRleCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludCh2ZXJ0ZXgpO1xuICAgICAgICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKHBpeGVsVmVydGV4LngsIHBpeGVsVmVydGV4LnkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2xvc2UgdGhlIHBvbHlnb25cbiAgICAgICAgdGhpcy5ncmFwaGljcy5saW5lVG8ocGl4ZWxGaXJzdC54LCBwaXhlbEZpcnN0LnkpO1xuICAgICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoc2hhcGVUeXBlID09PSAnZWRnZScpIHtcbiAgICAgIGNvbnN0IGVkZ2UgPSBzaGFwZSBhcyBwbGFuY2suRWRnZVNoYXBlO1xuICAgICAgY29uc3QgdjEgPSBwbGFuY2suVmVjMi5hZGQodHJhbnNmb3JtLnAsIHBsYW5jay5Sb3QubXVsVmVjMih0cmFuc2Zvcm0ucSwgZWRnZS5tX3ZlcnRleDEpKTtcbiAgICAgIGNvbnN0IHYyID0gcGxhbmNrLlZlYzIuYWRkKHRyYW5zZm9ybS5wLCBwbGFuY2suUm90Lm11bFZlYzIodHJhbnNmb3JtLnEsIGVkZ2UubV92ZXJ0ZXgyKSk7XG5cbiAgICAgIGNvbnN0IHAxID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHYxKTtcbiAgICAgIGNvbnN0IHAyID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHYyKTtcblxuICAgICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocDEueCwgcDEueSk7XG4gICAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhwMi54LCBwMi55KTtcbiAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG4gICAgfSBlbHNlIGlmIChzaGFwZVR5cGUgPT09ICdjaGFpbicpIHtcbiAgICAgIGNvbnN0IGNoYWluID0gc2hhcGUgYXMgcGxhbmNrLkNoYWluU2hhcGU7XG4gICAgICBjb25zdCB2ZXJ0aWNlcyA9IGNoYWluLm1fdmVydGljZXM7XG5cbiAgICAgIGlmICh2ZXJ0aWNlcyAmJiB2ZXJ0aWNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IGZpcnN0VmVydGV4ID0gcGxhbmNrLlZlYzIuYWRkKHRyYW5zZm9ybS5wLCBwbGFuY2suUm90Lm11bFZlYzIodHJhbnNmb3JtLnEsIHZlcnRpY2VzWzBdKSk7XG4gICAgICAgIGNvbnN0IHBpeGVsRmlyc3QgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQoZmlyc3RWZXJ0ZXgpO1xuICAgICAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwaXhlbEZpcnN0LngsIHBpeGVsRmlyc3QueSk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB2ZXJ0aWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IHZlcnRleCA9IHBsYW5jay5WZWMyLmFkZCh0cmFuc2Zvcm0ucCwgcGxhbmNrLlJvdC5tdWxWZWMyKHRyYW5zZm9ybS5xLCB2ZXJ0aWNlc1tpXSkpO1xuICAgICAgICAgIGNvbnN0IHBpeGVsVmVydGV4ID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHZlcnRleCk7XG4gICAgICAgICAgdGhpcy5ncmFwaGljcy5saW5lVG8ocGl4ZWxWZXJ0ZXgueCwgcGl4ZWxWZXJ0ZXgueSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZHJhd1ZlbG9jaXR5KGJvZHk6IHBsYW5jay5Cb2R5KTogdm9pZCB7XG4gICAgY29uc3QgcG9zaXRpb24gPSBib2R5LmdldFBvc2l0aW9uKCk7XG4gICAgY29uc3QgdmVsb2NpdHkgPSBib2R5LmdldExpbmVhclZlbG9jaXR5KCk7XG5cbiAgICAvLyBTY2FsZSB2ZWxvY2l0eSBmb3IgdmlzaWJpbGl0eVxuICAgIGNvbnN0IHNjYWxlID0gMC41O1xuICAgIGNvbnN0IGVuZFBvaW50ID0gcGxhbmNrLlZlYzIuYWRkKHBvc2l0aW9uLCBwbGFuY2suVmVjMi5tdWwodmVsb2NpdHksIHNjYWxlKSk7XG5cbiAgICBjb25zdCBwaXhlbFN0YXJ0ID0gdGhpcy53b3JsZC50b1BpeGVsc1BvaW50KHBvc2l0aW9uKTtcbiAgICBjb25zdCBwaXhlbEVuZCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChlbmRQb2ludCk7XG5cbiAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSh7XG4gICAgICB3aWR0aDogMixcbiAgICAgIGNvbG9yOiAweDAwRkZGRixcbiAgICAgIGFscGhhOiAwLjhcbiAgICB9KTtcblxuICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsU3RhcnQueCwgcGl4ZWxTdGFydC55KTtcbiAgICB0aGlzLmdyYXBoaWNzLmxpbmVUbyhwaXhlbEVuZC54LCBwaXhlbEVuZC55KTtcbiAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xuXG4gICAgLy8gRHJhdyBhcnJvdyBoZWFkXG4gICAgY29uc3QgYW5nbGUgPSBNYXRoLmF0YW4yKHBpeGVsRW5kLnkgLSBwaXhlbFN0YXJ0LnksIHBpeGVsRW5kLnggLSBwaXhlbFN0YXJ0LngpO1xuICAgIGNvbnN0IGFycm93U2l6ZSA9IDU7XG4gICAgY29uc3QgYW5nbGUxID0gYW5nbGUgKyBNYXRoLlBJICogMC44O1xuICAgIGNvbnN0IGFuZ2xlMiA9IGFuZ2xlIC0gTWF0aC5QSSAqIDAuODtcblxuICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBpeGVsRW5kLngsIHBpeGVsRW5kLnkpO1xuICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKFxuICAgICAgcGl4ZWxFbmQueCArIE1hdGguY29zKGFuZ2xlMSkgKiBhcnJvd1NpemUsXG4gICAgICBwaXhlbEVuZC55ICsgTWF0aC5zaW4oYW5nbGUxKSAqIGFycm93U2l6ZVxuICAgICk7XG4gICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxFbmQueCwgcGl4ZWxFbmQueSk7XG4gICAgdGhpcy5ncmFwaGljcy5saW5lVG8oXG4gICAgICBwaXhlbEVuZC54ICsgTWF0aC5jb3MoYW5nbGUyKSAqIGFycm93U2l6ZSxcbiAgICAgIHBpeGVsRW5kLnkgKyBNYXRoLnNpbihhbmdsZTIpICogYXJyb3dTaXplXG4gICAgKTtcbiAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBkcmF3QUFCQihib2R5OiBwbGFuY2suQm9keSk6IHZvaWQge1xuICAgIGZvciAobGV0IGZpeHR1cmUgPSBib2R5LmdldEZpeHR1cmVMaXN0KCk7IGZpeHR1cmU7IGZpeHR1cmUgPSBmaXh0dXJlLmdldE5leHQoKSkge1xuICAgICAgY29uc3QgYWFiYiA9IGZpeHR1cmUuZ2V0QUFCQigwKTtcblxuICAgICAgY29uc3QgbG93ZXJCb3VuZCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChhYWJiLmxvd2VyQm91bmQpO1xuICAgICAgY29uc3QgdXBwZXJCb3VuZCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChhYWJiLnVwcGVyQm91bmQpO1xuXG4gICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSh7XG4gICAgICAgIHdpZHRoOiAxLFxuICAgICAgICBjb2xvcjogMHhGRjAwRkYsXG4gICAgICAgIGFscGhhOiAwLjNcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmdyYXBoaWNzLnJlY3QoXG4gICAgICAgIGxvd2VyQm91bmQueCxcbiAgICAgICAgbG93ZXJCb3VuZC55LFxuICAgICAgICB1cHBlckJvdW5kLnggLSBsb3dlckJvdW5kLngsXG4gICAgICAgIHVwcGVyQm91bmQueSAtIGxvd2VyQm91bmQueVxuICAgICAgKTtcbiAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBkcmF3Q2VudGVyT2ZNYXNzKGJvZHk6IHBsYW5jay5Cb2R5KTogdm9pZCB7XG4gICAgY29uc3QgcG9zaXRpb24gPSBib2R5LmdldFdvcmxkQ2VudGVyKCk7XG4gICAgY29uc3QgcGl4ZWxQb3MgPSB0aGlzLndvcmxkLnRvUGl4ZWxzUG9pbnQocG9zaXRpb24pO1xuXG4gICAgdGhpcy5ncmFwaGljcy5zdHJva2Uoe1xuICAgICAgd2lkdGg6IDEsXG4gICAgICBjb2xvcjogMHhGRkZGRkYsXG4gICAgICBhbHBoYTogMVxuICAgIH0pO1xuXG4gICAgY29uc3Qgc2l6ZSA9IDU7XG4gICAgdGhpcy5ncmFwaGljcy5tb3ZlVG8ocGl4ZWxQb3MueCAtIHNpemUsIHBpeGVsUG9zLnkpO1xuICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKHBpeGVsUG9zLnggKyBzaXplLCBwaXhlbFBvcy55KTtcbiAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwaXhlbFBvcy54LCBwaXhlbFBvcy55IC0gc2l6ZSk7XG4gICAgdGhpcy5ncmFwaGljcy5saW5lVG8ocGl4ZWxQb3MueCwgcGl4ZWxQb3MueSArIHNpemUpO1xuICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XG4gIH1cblxuICBwcml2YXRlIGRyYXdDb250YWN0cygpOiB2b2lkIHtcbiAgICAvLyBJdGVyYXRlIHRocm91Z2ggYWxsIGNvbnRhY3RzIGluIHRoZSB3b3JsZFxuICAgIGZvciAobGV0IGNvbnRhY3QgPSB0aGlzLndvcmxkLndvcmxkLmdldENvbnRhY3RMaXN0KCk7IGNvbnRhY3Q7IGNvbnRhY3QgPSBjb250YWN0LmdldE5leHQoKSkge1xuICAgICAgaWYgKCFjb250YWN0LmlzVG91Y2hpbmcoKSkgY29udGludWU7XG5cbiAgICAgIGNvbnN0IG1hbmlmb2xkID0gY29udGFjdC5nZXRNYW5pZm9sZCgpO1xuICAgICAgaWYgKCFtYW5pZm9sZCkgY29udGludWU7XG5cbiAgICAgIGNvbnN0IHdvcmxkTWFuaWZvbGQgPSBjb250YWN0LmdldFdvcmxkTWFuaWZvbGQobnVsbCk7XG4gICAgICBpZiAoIXdvcmxkTWFuaWZvbGQpIGNvbnRpbnVlO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1hbmlmb2xkLnBvaW50Q291bnQ7IGkrKykge1xuICAgICAgICBjb25zdCBwb2ludCA9IHdvcmxkTWFuaWZvbGQucG9pbnRzW2ldO1xuICAgICAgICBpZiAoIXBvaW50KSBjb250aW51ZTtcbiAgICAgICAgY29uc3QgcGl4ZWxQb2ludCA9IHRoaXMud29ybGQudG9QaXhlbHNQb2ludChwbGFuY2suVmVjMihwb2ludC54LCBwb2ludC55KSk7XG5cbiAgICAgICAgdGhpcy5ncmFwaGljcy5jaXJjbGUocGl4ZWxQb2ludC54LCBwaXhlbFBvaW50LnksIDMpO1xuICAgICAgICB0aGlzLmdyYXBoaWNzLmZpbGwoeyBjb2xvcjogMHhGRjAwMDAsIGFscGhhOiAwLjggfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNldCB2aXNpYmlsaXR5IG9mIGRlYnVnIHJlbmRlcmVyXG4gICAqL1xuICBzZXRWaXNpYmxlKHZpc2libGU6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0aGlzLmlzVmlzaWJsZSA9IHZpc2libGU7XG4gICAgaWYgKCF2aXNpYmxlKSB7XG4gICAgICB0aGlzLmdyYXBoaWNzLmNsZWFyKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRvZ2dsZSBkZWJ1ZyByZW5kZXJlciB2aXNpYmlsaXR5XG4gICAqL1xuICB0b2dnbGUoKTogdm9pZCB7XG4gICAgdGhpcy5zZXRWaXNpYmxlKCF0aGlzLmlzVmlzaWJsZSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgZGVidWcgcmVuZGVyZXIgaXMgdmlzaWJsZVxuICAgKi9cbiAgZ2V0VmlzaWJsZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5pc1Zpc2libGU7XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgKiBhcyBwbGFuY2sgZnJvbSAncGxhbmNrJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc1dvcmxkIH0gZnJvbSAnLi9waHlzaWNzLXdvcmxkJztcblxuZXhwb3J0IGludGVyZmFjZSBQYXJzZWRTaGFwZSB7XG4gIHR5cGU6ICdjaXJjbGUnIHwgJ3JlY3RhbmdsZScgfCAncG9seWdvbic7XG4gIHNoYXBlOiBwbGFuY2suU2hhcGU7XG59XG5cbi8qKlxuICogU2hhcGUgbWV0YWRhdGEgc3RvcmVkIG9uIEdyYXBoaWNzIGZvciBwaHlzaWNzIHBhcnNpbmdcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQaHlzaWNzU2hhcGVNZXRhZGF0YSB7XG4gIHR5cGU6ICdjaXJjbGUnIHwgJ3JlY3RhbmdsZScgfCAncG9seWdvbic7XG4gIHJhZGl1cz86IG51bWJlcjtcbiAgd2lkdGg/OiBudW1iZXI7XG4gIGhlaWdodD86IG51bWJlcjtcbiAgdmVydGljZXM/OiBudW1iZXJbXTtcbn1cblxuY29uc3QgUEhZU0lDU19TSEFQRV9LRVkgPSAnX19waHlzaWNzU2hhcGVfXyc7XG5cbi8qKlxuICogU3RvcmUgc2hhcGUgbWV0YWRhdGEgb24gR3JhcGhpY3Mgb2JqZWN0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRHcmFwaGljc1BoeXNpY3NTaGFwZShncmFwaGljczogUElYSS5HcmFwaGljcywgbWV0YWRhdGE6IFBoeXNpY3NTaGFwZU1ldGFkYXRhKTogdm9pZCB7XG4gIChncmFwaGljcyBhcyBhbnkpW1BIWVNJQ1NfU0hBUEVfS0VZXSA9IG1ldGFkYXRhO1xufVxuXG4vKipcbiAqIEV4dGVuZCBQSVhJIEdyYXBoaWNzIHRvIGF1dG9tYXRpY2FsbHkgdHJhY2sgc2hhcGUgZGF0YSBmb3IgcGh5c2ljc1xuICogVGhpcyBwYXRjaGVzIEdyYXBoaWNzIG1ldGhvZHMgdG8gc3RvcmUgbWV0YWRhdGEgZm9yIHBoeXNpY3MgY29sbGlzaW9uIHNoYXBlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdEdyYXBoaWNzUGh5c2ljc1RyYWNraW5nKCk6IHZvaWQge1xuICAvLyBTYXZlIG9yaWdpbmFsIG1ldGhvZHNcbiAgY29uc3Qgb3JpZ2luYWxSZWN0ID0gUElYSS5HcmFwaGljcy5wcm90b3R5cGUucmVjdDtcbiAgY29uc3Qgb3JpZ2luYWxDaXJjbGUgPSBQSVhJLkdyYXBoaWNzLnByb3RvdHlwZS5jaXJjbGU7XG4gIGNvbnN0IG9yaWdpbmFsUG9seSA9IFBJWEkuR3JhcGhpY3MucHJvdG90eXBlLnBvbHk7XG5cbiAgLy8gUGF0Y2ggcmVjdCgpIHRvIHN0b3JlIG1ldGFkYXRhXG4gIFBJWEkuR3JhcGhpY3MucHJvdG90eXBlLnJlY3QgPSBmdW5jdGlvbiAoeDogbnVtYmVyLCB5OiBudW1iZXIsIHc6IG51bWJlciwgaDogbnVtYmVyKSB7XG4gICAgc2V0R3JhcGhpY3NQaHlzaWNzU2hhcGUodGhpcywge1xuICAgICAgdHlwZTogJ3JlY3RhbmdsZScsXG4gICAgICB3aWR0aDogdyxcbiAgICAgIGhlaWdodDogaFxuICAgIH0pO1xuICAgIHJldHVybiBvcmlnaW5hbFJlY3QuY2FsbCh0aGlzLCB4LCB5LCB3LCBoKTtcbiAgfTtcblxuICAvLyBQYXRjaCBjaXJjbGUoKSB0byBzdG9yZSBtZXRhZGF0YVxuICBQSVhJLkdyYXBoaWNzLnByb3RvdHlwZS5jaXJjbGUgPSBmdW5jdGlvbiAoeDogbnVtYmVyLCB5OiBudW1iZXIsIHJhZGl1czogbnVtYmVyKSB7XG4gICAgc2V0R3JhcGhpY3NQaHlzaWNzU2hhcGUodGhpcywge1xuICAgICAgdHlwZTogJ2NpcmNsZScsXG4gICAgICByYWRpdXM6IHJhZGl1c1xuICAgIH0pO1xuICAgIHJldHVybiBvcmlnaW5hbENpcmNsZS5jYWxsKHRoaXMsIHgsIHksIHJhZGl1cyk7XG4gIH07XG5cbiAgLy8gUGF0Y2ggcG9seSgpIHRvIHN0b3JlIG1ldGFkYXRhXG4gIFBJWEkuR3JhcGhpY3MucHJvdG90eXBlLnBvbHkgPSBmdW5jdGlvbiAocG9pbnRzOiBQSVhJLlBvaW50RGF0YVtdIHwgbnVtYmVyW10pIHtcbiAgICBjb25zdCBmbGF0UG9pbnRzID0gQXJyYXkuaXNBcnJheShwb2ludHNbMF0pID8gcG9pbnRzLmZsYXQoKSA6IHBvaW50cztcbiAgICBzZXRHcmFwaGljc1BoeXNpY3NTaGFwZSh0aGlzLCB7XG4gICAgICB0eXBlOiAncG9seWdvbicsXG4gICAgICB2ZXJ0aWNlczogZmxhdFBvaW50cyBhcyBudW1iZXJbXVxuICAgIH0pO1xuICAgIHJldHVybiBvcmlnaW5hbFBvbHkuY2FsbCh0aGlzLCBwb2ludHMgYXMgYW55KTtcbiAgfTtcbn1cblxuLyoqXG4gKiBQYXJzZSBQSVhJIEdyYXBoaWNzIGdlb21ldHJ5IHRvIGV4dHJhY3QgY29sbGlzaW9uIHNoYXBlIGZvciBwaHlzaWNzXG4gKlxuICogVXNlcyBtZXRhZGF0YSBzdG9yZWQgYnkgaGVscGVyIGZ1bmN0aW9ucyBvciBmYWxscyBiYWNrIHRvIGJvdW5kcy1iYXNlZCByZWN0YW5nbGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlR3JhcGhpY3NTaGFwZShncmFwaGljczogUElYSS5HcmFwaGljcywgd29ybGQ6IFBoeXNpY3NXb3JsZCk6IFBhcnNlZFNoYXBlIHtcbiAgLy8gQ2hlY2sgaWYgc2hhcGUgbWV0YWRhdGEgd2FzIHN0b3JlZFxuICBjb25zdCBtZXRhZGF0YSA9IChncmFwaGljcyBhcyBhbnkpW1BIWVNJQ1NfU0hBUEVfS0VZXSBhcyBQaHlzaWNzU2hhcGVNZXRhZGF0YSB8IHVuZGVmaW5lZDtcblxuICBpZiAobWV0YWRhdGEpIHtcbiAgICAvLyBVc2Ugc3RvcmVkIG1ldGFkYXRhXG4gICAgc3dpdGNoIChtZXRhZGF0YS50eXBlKSB7XG4gICAgICBjYXNlICdjaXJjbGUnOlxuICAgICAgICBpZiAoIW1ldGFkYXRhLnJhZGl1cykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2lyY2xlIG1ldGFkYXRhIG1pc3NpbmcgcmFkaXVzJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiAnY2lyY2xlJyxcbiAgICAgICAgICBzaGFwZTogcGxhbmNrLkNpcmNsZSh3b3JsZC50b1BoeXNpY3MobWV0YWRhdGEucmFkaXVzKSlcbiAgICAgICAgfTtcblxuICAgICAgY2FzZSAncmVjdGFuZ2xlJzpcbiAgICAgICAgaWYgKCFtZXRhZGF0YS53aWR0aCB8fCAhbWV0YWRhdGEuaGVpZ2h0KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWN0YW5nbGUgbWV0YWRhdGEgbWlzc2luZyB3aWR0aC9oZWlnaHQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6ICdyZWN0YW5nbGUnLFxuICAgICAgICAgIHNoYXBlOiBwbGFuY2suQm94KFxuICAgICAgICAgICAgd29ybGQudG9QaHlzaWNzKG1ldGFkYXRhLndpZHRoIC8gMiksXG4gICAgICAgICAgICB3b3JsZC50b1BoeXNpY3MobWV0YWRhdGEuaGVpZ2h0IC8gMilcbiAgICAgICAgICApXG4gICAgICAgIH07XG5cbiAgICAgIGNhc2UgJ3BvbHlnb24nOlxuICAgICAgICBpZiAoIW1ldGFkYXRhLnZlcnRpY2VzIHx8IG1ldGFkYXRhLnZlcnRpY2VzLmxlbmd0aCA8IDYpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BvbHlnb24gbWV0YWRhdGEgbWlzc2luZyB2ZXJ0aWNlcyAobmVlZCBhdCBsZWFzdCAzIHBvaW50cyA9IDYgdmFsdWVzKScpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZlcnRpY2VzOiBwbGFuY2suVmVjMltdID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWV0YWRhdGEudmVydGljZXMubGVuZ3RoOyBpICs9IDIpIHtcbiAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKFxuICAgICAgICAgICAgcGxhbmNrLlZlYzIoXG4gICAgICAgICAgICAgIHdvcmxkLnRvUGh5c2ljcyhtZXRhZGF0YS52ZXJ0aWNlc1tpXSksXG4gICAgICAgICAgICAgIHdvcmxkLnRvUGh5c2ljcyhtZXRhZGF0YS52ZXJ0aWNlc1tpICsgMV0pXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6ICdwb2x5Z29uJyxcbiAgICAgICAgICBzaGFwZTogcGxhbmNrLlBvbHlnb24odmVydGljZXMpXG4gICAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLy8gRmFsbGJhY2s6IFVzZSBib3VuZGluZyBib3ggYXMgcmVjdGFuZ2xlXG4gIGNvbnN0IGJvdW5kcyA9IGdyYXBoaWNzLmdldExvY2FsQm91bmRzKCk7XG5cbiAgaWYgKGJvdW5kcy53aWR0aCA9PT0gMCB8fCBib3VuZHMuaGVpZ2h0ID09PSAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ0dyYXBoaWNzIGhhcyBubyBkaW1lbnNpb25zLiBFaXRoZXIgZHJhdyBzaGFwZXMgdXNpbmcgcmVjdCgpLCBjaXJjbGUoKSwgb3IgcG9seSgpLCAnICtcbiAgICAgICdvciBwcm92aWRlIGFuIGV4cGxpY2l0IGNvbGxpc2lvblNoYXBlIG9wdGlvbi4nXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ3JlY3RhbmdsZScsXG4gICAgc2hhcGU6IHBsYW5jay5Cb3goXG4gICAgICB3b3JsZC50b1BoeXNpY3MoYm91bmRzLndpZHRoIC8gMiksXG4gICAgICB3b3JsZC50b1BoeXNpY3MoYm91bmRzLmhlaWdodCAvIDIpXG4gICAgKVxuICB9O1xufVxuIiwiaW1wb3J0IHR5cGUgeyBQaHlzaWNzQm9keU9wdGlvbnMgfSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuXG4vKipcbiAqIFByZWRlZmluZWQgbWF0ZXJpYWwgcHJlc2V0cyBmb3IgY29tbW9uIHBoeXNpY3MgYmVoYXZpb3JzXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGJhbGwgPSBhc1BoeXNpY3NFbnRpdHkoc3ByaXRlLCB3b3JsZCwge1xuICogICB0eXBlOiAnZHluYW1pYycsXG4gKiAgIC4uLlBoeXNpY3NNYXRlcmlhbHMuYm91bmN5XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY29uc3QgUGh5c2ljc01hdGVyaWFscyA9IHtcbiAgLyoqXG4gICAqIEJvdW5jeSBiYWxsIC0gaGlnaCByZXN0aXR1dGlvbiwgbG93IGZyaWN0aW9uXG4gICAqL1xuICBib3VuY3k6IHtcbiAgICBkZW5zaXR5OiAwLjUsXG4gICAgZnJpY3Rpb246IDAuMSxcbiAgICByZXN0aXR1dGlvbjogMC45XG4gIH0sXG5cbiAgLyoqXG4gICAqIFdvb2RlbiBib3ggLSBtZWRpdW0gZGVuc2l0eSwgbWVkaXVtIGZyaWN0aW9uXG4gICAqL1xuICB3b29kOiB7XG4gICAgZGVuc2l0eTogMC43LFxuICAgIGZyaWN0aW9uOiAwLjQsXG4gICAgcmVzdGl0dXRpb246IDAuMlxuICB9LFxuXG4gIC8qKlxuICAgKiBNZXRhbCBvYmplY3QgLSBoaWdoIGRlbnNpdHksIGxvdyByZXN0aXR1dGlvblxuICAgKi9cbiAgbWV0YWw6IHtcbiAgICBkZW5zaXR5OiAxLjUsXG4gICAgZnJpY3Rpb246IDAuMyxcbiAgICByZXN0aXR1dGlvbjogMC4xXG4gIH0sXG5cbiAgLyoqXG4gICAqIEljZSAtIHZlcnkgbG93IGZyaWN0aW9uLCBsb3cgcmVzdGl0dXRpb25cbiAgICovXG4gIGljZToge1xuICAgIGRlbnNpdHk6IDAuOSxcbiAgICBmcmljdGlvbjogMC4wMixcbiAgICByZXN0aXR1dGlvbjogMC4wNVxuICB9LFxuXG4gIC8qKlxuICAgKiBSdWJiZXIgLSBoaWdoIGZyaWN0aW9uLCBoaWdoIHJlc3RpdHV0aW9uXG4gICAqL1xuICBydWJiZXI6IHtcbiAgICBkZW5zaXR5OiAxLjAsXG4gICAgZnJpY3Rpb246IDAuOSxcbiAgICByZXN0aXR1dGlvbjogMC43XG4gIH0sXG5cbiAgLyoqXG4gICAqIENoYXJhY3RlciAtIG5vIHJvdGF0aW9uLCBtZWRpdW0gZnJpY3Rpb25cbiAgICovXG4gIGNoYXJhY3Rlcjoge1xuICAgIGRlbnNpdHk6IDEuMCxcbiAgICBmcmljdGlvbjogMC41LFxuICAgIHJlc3RpdHV0aW9uOiAwLjAsXG4gICAgZml4ZWRSb3RhdGlvbjogdHJ1ZVxuICB9LFxuXG4gIC8qKlxuICAgKiBTdGF0aWMgdGVycmFpbiAtIG5vIGRlbnNpdHkgKGltbW92YWJsZSksIGhpZ2ggZnJpY3Rpb25cbiAgICovXG4gIHRlcnJhaW46IHtcbiAgICBkZW5zaXR5OiAwLFxuICAgIGZyaWN0aW9uOiAwLjYsXG4gICAgcmVzdGl0dXRpb246IDAuMFxuICB9XG59IGFzIGNvbnN0O1xuXG4vKipcbiAqIEFwcGx5IG1hdGVyaWFsIHByZXNldCB0byBvcHRpb25zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcHBseU1hdGVyaWFsKFxuICBvcHRpb25zOiBQaHlzaWNzQm9keU9wdGlvbnMsXG4gIG1hdGVyaWFsOiBrZXlvZiB0eXBlb2YgUGh5c2ljc01hdGVyaWFsc1xuKTogUGh5c2ljc0JvZHlPcHRpb25zIHtcbiAgcmV0dXJuIHtcbiAgICAuLi5vcHRpb25zLFxuICAgIC4uLlBoeXNpY3NNYXRlcmlhbHNbbWF0ZXJpYWxdXG4gIH07XG59XG4iLCJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgYXNFbnRpdHksIEFzRW50aXR5IH0gZnJvbSAnLi4vLi4vY29yZS9tb3hpLWVudGl0eSc7XG5pbXBvcnQgdHlwZSB7IFBoeXNpY3NXb3JsZCB9IGZyb20gJy4vcGh5c2ljcy13b3JsZCc7XG5pbXBvcnQgeyBQaHlzaWNzQm9keUxvZ2ljIH0gZnJvbSAnLi9waHlzaWNzLWJvZHktbG9naWMnO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzQm9keU9wdGlvbnMsIFNoYXBlQ29uZmlnIH0gZnJvbSAnLi9waHlzaWNzLXR5cGVzJztcblxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIGEgcGh5c2ljcy1lbmFibGVkIGVudGl0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gKiBjb25zdCBwaHlzaWNzRW50aXR5ID0gYXNQaHlzaWNzRW50aXR5KHNwcml0ZSwgcGh5c2ljc1dvcmxkLCB7XG4gKiAgIHR5cGU6ICdkeW5hbWljJyxcbiAqICAgc2hhcGU6ICdjaXJjbGUnLFxuICogICByYWRpdXM6IDI1XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNQaHlzaWNzRW50aXR5PFQgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lcj4oXG4gIHBpeGlPYmplY3Q6IFQsXG4gIHdvcmxkOiBQaHlzaWNzV29ybGQsXG4gIG9wdGlvbnM6IFBoeXNpY3NCb2R5T3B0aW9ucyA9IHt9XG4pOiBBc0VudGl0eTxUPiB7XG4gIGNvbnN0IGVudGl0eSA9IGFzRW50aXR5KHBpeGlPYmplY3QpO1xuICBjb25zdCBwaHlzaWNzTG9naWMgPSBuZXcgUGh5c2ljc0JvZHlMb2dpYyh3b3JsZCwgb3B0aW9ucyk7XG4gIGVudGl0eS5tb3hpRW50aXR5LmFkZExvZ2ljKHBoeXNpY3NMb2dpYyk7XG4gIHJldHVybiBlbnRpdHkgYXMgQXNFbnRpdHk8VD47XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgZW50aXR5IGhhcyBwaHlzaWNzIGJvZHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc1BoeXNpY3MoZW50aXR5OiBhbnkpOiBib29sZWFuIHtcbiAgaWYgKCFlbnRpdHkubW94aUVudGl0eSkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gZW50aXR5Lm1veGlFbnRpdHkuZ2V0TG9naWMoJ1BoeXNpY3NCb2R5TG9naWMnKSAhPT0gdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIEdldCBwaHlzaWNzIGJvZHkgbG9naWMgZnJvbSBlbnRpdHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBoeXNpY3NCb2R5KGVudGl0eTogYW55KTogUGh5c2ljc0JvZHlMb2dpYyB8IHVuZGVmaW5lZCB7XG4gIGlmICghZW50aXR5Lm1veGlFbnRpdHkpIHJldHVybiB1bmRlZmluZWQ7XG4gIHJldHVybiBlbnRpdHkubW94aUVudGl0eS5nZXRMb2dpYygnUGh5c2ljc0JvZHlMb2dpYycpIGFzIFBoeXNpY3NCb2R5TG9naWMgfCB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogU2hhcGUgY3JlYXRpb24gZnJvbSBzcHJpdGUgYm91bmRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTaGFwZUZyb21TcHJpdGUoXG4gIHNwcml0ZTogUElYSS5TcHJpdGUsXG4gIHR5cGU6ICdyZWN0YW5nbGUnIHwgJ2NpcmNsZScgfCAnYXV0bycgPSAnYXV0bydcbik6IFNoYXBlQ29uZmlnIHtcbiAgY29uc3QgYm91bmRzID0gc3ByaXRlLmdldExvY2FsQm91bmRzKCk7XG5cbiAgaWYgKHR5cGUgPT09ICdhdXRvJykge1xuICAgIC8vIENoZWNrIGlmIHJvdWdobHkgc3F1YXJlIC0+IGNpcmNsZSwgZWxzZSByZWN0YW5nbGVcbiAgICBjb25zdCByYXRpbyA9IGJvdW5kcy53aWR0aCAvIGJvdW5kcy5oZWlnaHQ7XG4gICAgdHlwZSA9IChyYXRpbyA+IDAuOCAmJiByYXRpbyA8IDEuMikgPyAnY2lyY2xlJyA6ICdyZWN0YW5nbGUnO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09ICdjaXJjbGUnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNoYXBlOiAnY2lyY2xlJyxcbiAgICAgIHJhZGl1czogTWF0aC5tYXgoYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0KSAvIDJcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB7XG4gICAgICBzaGFwZTogJ3JlY3RhbmdsZScsXG4gICAgICB3aWR0aDogYm91bmRzLndpZHRoLFxuICAgICAgaGVpZ2h0OiBib3VuZHMuaGVpZ2h0XG4gICAgfTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCAqIGFzIHBsYW5jayBmcm9tICdwbGFuY2snO1xuaW1wb3J0IHR5cGUgeyBQaHlzaWNzV29ybGRPcHRpb25zLCBSYXljYXN0Q2FsbGJhY2ssIFBoeXNpY3NEZWJ1Z09wdGlvbnMgfSBmcm9tICcuL3BoeXNpY3MtdHlwZXMnO1xuaW1wb3J0IHsgQ29sbGlzaW9uUmVnaXN0cnksIENvbGxpc2lvbk1hbmFnZXIgfSBmcm9tICcuL3BoeXNpY3MtY29sbGlzaW9uJztcbmltcG9ydCB0eXBlIHsgUGh5c2ljc0JvZHlMb2dpYyB9IGZyb20gJy4vcGh5c2ljcy1ib2R5LWxvZ2ljJztcbmltcG9ydCB7IFBoeXNpY3NEZWJ1Z1JlbmRlcmVyIH0gZnJvbSAnLi9waHlzaWNzLWRlYnVnLXJlbmRlcmVyJztcbmltcG9ydCB7IGFzRW50aXR5IH0gZnJvbSAnLi4vLi4vY29yZS9tb3hpLWVudGl0eSc7XG5pbXBvcnQgeyBpbml0R3JhcGhpY3NQaHlzaWNzVHJhY2tpbmcgfSBmcm9tICcuL3BoeXNpY3MtZ3JhcGhpY3MtcGFyc2VyJztcblxuLyoqXG4gKiBQaHlzaWNzV29ybGQgbWFuYWdlcyB0aGUgUGxhbmNrLmpzIHBoeXNpY3Mgc2ltdWxhdGlvbiBhbmQgcHJvdmlkZXNcbiAqIGludGVncmF0aW9uIHdpdGggTU9YSSdzIFNjZW5lL0VuZ2luZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgcGh5c2ljc1dvcmxkID0gbmV3IFBoeXNpY3NXb3JsZCh7XG4gKiAgIGdyYXZpdHk6IHsgeDogMCwgeTogOS44IH0sXG4gKiAgIHBpeGVsc1Blck1ldGVyOiAzMFxuICogfSk7XG4gKlxuICogLy8gSW50ZWdyYXRlIHdpdGggZW5naW5lXG4gKiBlbmdpbmUuYWRkUGh5c2ljc1dvcmxkKHBoeXNpY3NXb3JsZCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFBoeXNpY3NXb3JsZCB7XG4gIC8qKiBUaGUgUGxhbmNrLmpzIHdvcmxkIGluc3RhbmNlICovXG4gIHB1YmxpYyB3b3JsZDogcGxhbmNrLldvcmxkO1xuXG4gIC8qKiBQaXhlbHMgcGVyIG1ldGVyIGNvbnZlcnNpb24gZmFjdG9yICovXG4gIHB1YmxpYyBwaXhlbHNQZXJNZXRlcjogbnVtYmVyID0gMzA7XG5cbiAgLyoqIEZpeGVkIHRpbWVzdGVwIGluIHNlY29uZHMgKi9cbiAgcHVibGljIHRpbWVzdGVwOiBudW1iZXIgPSAxLzYwO1xuXG4gIC8qKiBDb2xsaXNpb24gdGFnIHJlZ2lzdHJ5ICovXG4gIHB1YmxpYyBjb2xsaXNpb25SZWdpc3RyeTogQ29sbGlzaW9uUmVnaXN0cnk7XG5cbiAgLyoqIENvbGxpc2lvbiBldmVudCBtYW5hZ2VyICovXG4gIHB1YmxpYyBjb2xsaXNpb25NYW5hZ2VyOiBDb2xsaXNpb25NYW5hZ2VyO1xuXG4gIC8qKiBWZWxvY2l0eSBpdGVyYXRpb25zIGZvciBzb2x2ZXIgKi9cbiAgcHJpdmF0ZSB2ZWxvY2l0eUl0ZXJhdGlvbnM6IG51bWJlciA9IDg7XG5cbiAgLyoqIFBvc2l0aW9uIGl0ZXJhdGlvbnMgZm9yIHNvbHZlciAqL1xuICBwcml2YXRlIHBvc2l0aW9uSXRlcmF0aW9uczogbnVtYmVyID0gMztcblxuICAvKiogVGltZSBhY2N1bXVsYXRvciBmb3IgZml4ZWQgdGltZXN0ZXAgKi9cbiAgcHJpdmF0ZSBhY2N1bXVsYXRvcjogbnVtYmVyID0gMDtcblxuICAvKiogUmVnaXN0cnkgb2YgcGh5c2ljcyBib2RpZXMgKi9cbiAgcHJpdmF0ZSBib2RpZXM6IE1hcDxwbGFuY2suQm9keSwgUGh5c2ljc0JvZHlMb2dpYz4gPSBuZXcgTWFwKCk7XG5cbiAgLyoqIERlYnVnIHJlbmRlcmVyIHJlZmVyZW5jZSAqL1xuICBwcml2YXRlIGRlYnVnUmVuZGVyZXI/OiBQaHlzaWNzRGVidWdSZW5kZXJlcjtcblxuICAvKiogRGVidWcgZ3JhcGhpY3MgY29udGFpbmVyICovXG4gIHByaXZhdGUgZGVidWdHcmFwaGljcz86IFBJWEkuR3JhcGhpY3M7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogUGh5c2ljc1dvcmxkT3B0aW9ucyA9IHt9KSB7XG4gICAgLy8gSW5pdGlhbGl6ZSBHcmFwaGljcyBwaHlzaWNzIHRyYWNraW5nIChwYXRjaGVzIFBJWEkuR3JhcGhpY3MgbWV0aG9kcylcbiAgICBpbml0R3JhcGhpY3NQaHlzaWNzVHJhY2tpbmcoKTtcblxuICAgIGNvbnN0IHtcbiAgICAgIGdyYXZpdHkgPSB7IHg6IDAsIHk6IDkuOCB9LFxuICAgICAgcGl4ZWxzUGVyTWV0ZXIgPSAzMCxcbiAgICAgIHZlbG9jaXR5SXRlcmF0aW9ucyA9IDgsXG4gICAgICBwb3NpdGlvbkl0ZXJhdGlvbnMgPSAzLFxuICAgICAgZW5hYmxlU2xlZXBpbmcgPSB0cnVlLFxuICAgICAgdGltZXN0ZXAgPSAxLzYwXG4gICAgfSA9IG9wdGlvbnM7XG5cbiAgICB0aGlzLnBpeGVsc1Blck1ldGVyID0gcGl4ZWxzUGVyTWV0ZXI7XG4gICAgdGhpcy52ZWxvY2l0eUl0ZXJhdGlvbnMgPSB2ZWxvY2l0eUl0ZXJhdGlvbnM7XG4gICAgdGhpcy5wb3NpdGlvbkl0ZXJhdGlvbnMgPSBwb3NpdGlvbkl0ZXJhdGlvbnM7XG4gICAgdGhpcy50aW1lc3RlcCA9IHRpbWVzdGVwO1xuXG4gICAgLy8gQ3JlYXRlIFBsYW5jayB3b3JsZFxuICAgIHRoaXMud29ybGQgPSBwbGFuY2suV29ybGQoe1xuICAgICAgZ3Jhdml0eTogcGxhbmNrLlZlYzIoZ3Jhdml0eS54LCBncmF2aXR5LnkpXG4gICAgfSk7XG5cbiAgICAvLyBDb25maWd1cmUgc2xlZXBpbmdcbiAgICB0aGlzLndvcmxkLnNldEFsbG93U2xlZXBpbmcoZW5hYmxlU2xlZXBpbmcpO1xuXG4gICAgLy8gSW5pdGlhbGl6ZSBjb2xsaXNpb24gc3lzdGVtXG4gICAgdGhpcy5jb2xsaXNpb25SZWdpc3RyeSA9IG5ldyBDb2xsaXNpb25SZWdpc3RyeSgpO1xuICAgIHRoaXMuY29sbGlzaW9uTWFuYWdlciA9IG5ldyBDb2xsaXNpb25NYW5hZ2VyKHRoaXMsIHRoaXMuY29sbGlzaW9uUmVnaXN0cnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0ZXAgdGhlIHBoeXNpY3Mgc2ltdWxhdGlvbiAoY2FsbGVkIGJ5IEVuZ2luZSB1cGRhdGUgbG9vcClcbiAgICogVXNlcyBmaXhlZCB0aW1lc3RlcCBmb3IgZGV0ZXJtaW5pc3RpYyBwaHlzaWNzXG4gICAqL1xuICBzdGVwKGRlbHRhVGltZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5hY2N1bXVsYXRvciArPSBkZWx0YVRpbWU7XG5cbiAgICAvLyBGaXhlZCB0aW1lc3RlcCB1cGRhdGVzXG4gICAgd2hpbGUgKHRoaXMuYWNjdW11bGF0b3IgPj0gdGhpcy50aW1lc3RlcCkge1xuICAgICAgdGhpcy53b3JsZC5zdGVwKHRoaXMudGltZXN0ZXAsIHRoaXMudmVsb2NpdHlJdGVyYXRpb25zLCB0aGlzLnBvc2l0aW9uSXRlcmF0aW9ucyk7XG4gICAgICB0aGlzLmFjY3VtdWxhdG9yIC09IHRoaXMudGltZXN0ZXA7XG4gICAgfVxuXG4gICAgLy8gTm90ZTogSW50ZXJwb2xhdGlvbiBmb3IgcmVuZGVyaW5nIHNtb290aG5lc3MgY291bGQgYmUgYWRkZWQgaGVyZVxuICAgIC8vIGNvbnN0IGFscGhhID0gdGhpcy5hY2N1bXVsYXRvciAvIHRoaXMudGltZXN0ZXA7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGEgcGh5c2ljcyBib2R5XG4gICAqL1xuICBjcmVhdGVCb2R5KGRlZjogcGxhbmNrLkJvZHlEZWYpOiBwbGFuY2suQm9keSB7XG4gICAgcmV0dXJuIHRoaXMud29ybGQuY3JlYXRlQm9keShkZWYpO1xuICB9XG5cbiAgLyoqXG4gICAqIERlc3Ryb3kgYSBwaHlzaWNzIGJvZHlcbiAgICovXG4gIGRlc3Ryb3lCb2R5KGJvZHk6IHBsYW5jay5Cb2R5KTogdm9pZCB7XG4gICAgdGhpcy5ib2RpZXMuZGVsZXRlKGJvZHkpO1xuICAgIHRoaXMud29ybGQuZGVzdHJveUJvZHkoYm9keSk7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgYSBwaHlzaWNzIGJvZHkgbG9naWMgY29tcG9uZW50XG4gICAqL1xuICByZWdpc3RlckJvZHkoYm9keTogcGxhbmNrLkJvZHksIGxvZ2ljOiBQaHlzaWNzQm9keUxvZ2ljKTogdm9pZCB7XG4gICAgdGhpcy5ib2RpZXMuc2V0KGJvZHksIGxvZ2ljKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcGh5c2ljcyBib2R5IGxvZ2ljIGZyb20gUGxhbmNrIGJvZHlcbiAgICovXG4gIGdldEJvZHlMb2dpYyhib2R5OiBwbGFuY2suQm9keSk6IFBoeXNpY3NCb2R5TG9naWMgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmJvZGllcy5nZXQoYm9keSk7XG4gIH1cblxuICAvKipcbiAgICogUmF5Y2FzdCBmcm9tIG9uZSBwb2ludCB0byBhbm90aGVyXG4gICAqL1xuICByYXljYXN0KGZyb206IFBJWEkuUG9pbnQsIHRvOiBQSVhJLlBvaW50LCBjYWxsYmFjazogUmF5Y2FzdENhbGxiYWNrKTogdm9pZCB7XG4gICAgY29uc3QgcDEgPSB0aGlzLnRvUGh5c2ljc1BvaW50KGZyb20pO1xuICAgIGNvbnN0IHAyID0gdGhpcy50b1BoeXNpY3NQb2ludCh0byk7XG5cbiAgICB0aGlzLndvcmxkLnJheUNhc3QocDEsIHAyLCAoZml4dHVyZSwgcG9pbnQsIG5vcm1hbCwgZnJhY3Rpb24pID0+IHtcbiAgICAgIGNvbnN0IHBpeGVsUG9pbnQgPSB0aGlzLnRvUGl4ZWxzUG9pbnQocG9pbnQpO1xuICAgICAgY29uc3QgcGl4ZWxOb3JtYWwgPSBuZXcgUElYSS5Qb2ludChub3JtYWwueCwgbm9ybWFsLnkpO1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKGZpeHR1cmUsIHBpeGVsUG9pbnQsIHBpeGVsTm9ybWFsLCBmcmFjdGlvbik7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUXVlcnkgQUFCQiAoYXhpcy1hbGlnbmVkIGJvdW5kaW5nIGJveClcbiAgICovXG4gIHF1ZXJ5QUFCQihib3VuZHM6IFBJWEkuUmVjdGFuZ2xlLCBjYWxsYmFjazogKGJvZHk6IHBsYW5jay5Cb2R5KSA9PiBib29sZWFuKTogdm9pZCB7XG4gICAgY29uc3QgbG93ZXJCb3VuZCA9IHRoaXMudG9QaHlzaWNzUG9pbnQobmV3IFBJWEkuUG9pbnQoYm91bmRzLngsIGJvdW5kcy55KSk7XG4gICAgY29uc3QgdXBwZXJCb3VuZCA9IHRoaXMudG9QaHlzaWNzUG9pbnQobmV3IFBJWEkuUG9pbnQoYm91bmRzLnggKyBib3VuZHMud2lkdGgsIGJvdW5kcy55ICsgYm91bmRzLmhlaWdodCkpO1xuXG4gICAgdGhpcy53b3JsZC5xdWVyeUFBQkIocGxhbmNrLkFBQkIobG93ZXJCb3VuZCwgdXBwZXJCb3VuZCksIChmaXh0dXJlKSA9PiB7XG4gICAgICByZXR1cm4gY2FsbGJhY2soZml4dHVyZS5nZXRCb2R5KCkpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFF1ZXJ5IHBvaW50XG4gICAqL1xuICBxdWVyeVBvaW50KHBvaW50OiBQSVhJLlBvaW50LCBjYWxsYmFjazogKGZpeHR1cmU6IHBsYW5jay5GaXh0dXJlKSA9PiBib29sZWFuKTogdm9pZCB7XG4gICAgY29uc3QgcGh5c2ljc1BvaW50ID0gdGhpcy50b1BoeXNpY3NQb2ludChwb2ludCk7XG5cbiAgICB0aGlzLndvcmxkLnF1ZXJ5QUFCQihcbiAgICAgIHBsYW5jay5BQUJCKFxuICAgICAgICBwbGFuY2suVmVjMihwaHlzaWNzUG9pbnQueCAtIDAuMDAxLCBwaHlzaWNzUG9pbnQueSAtIDAuMDAxKSxcbiAgICAgICAgcGxhbmNrLlZlYzIocGh5c2ljc1BvaW50LnggKyAwLjAwMSwgcGh5c2ljc1BvaW50LnkgKyAwLjAwMSlcbiAgICAgICksXG4gICAgICAoZml4dHVyZSkgPT4ge1xuICAgICAgICBpZiAoZml4dHVyZS50ZXN0UG9pbnQocGh5c2ljc1BvaW50KSkge1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjayhmaXh0dXJlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgcGl4ZWxzIHRvIG1ldGVyc1xuICAgKi9cbiAgdG9QaHlzaWNzKHBpeGVsczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gcGl4ZWxzIC8gdGhpcy5waXhlbHNQZXJNZXRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IG1ldGVycyB0byBwaXhlbHNcbiAgICovXG4gIHRvUGl4ZWxzKG1ldGVyczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gbWV0ZXJzICogdGhpcy5waXhlbHNQZXJNZXRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IFBJWEkgUG9pbnQgKHBpeGVscykgdG8gUGxhbmNrIFZlYzIgKG1ldGVycylcbiAgICovXG4gIHRvUGh5c2ljc1BvaW50KHBvaW50OiBQSVhJLlBvaW50KTogcGxhbmNrLlZlYzIge1xuICAgIHJldHVybiBwbGFuY2suVmVjMih0aGlzLnRvUGh5c2ljcyhwb2ludC54KSwgdGhpcy50b1BoeXNpY3MocG9pbnQueSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgUGxhbmNrIFZlYzIgKG1ldGVycykgdG8gUElYSSBQb2ludCAocGl4ZWxzKVxuICAgKi9cbiAgdG9QaXhlbHNQb2ludCh2ZWM6IHBsYW5jay5WZWMyKTogUElYSS5Qb2ludCB7XG4gICAgcmV0dXJuIG5ldyBQSVhJLlBvaW50KHRoaXMudG9QaXhlbHModmVjLngpLCB0aGlzLnRvUGl4ZWxzKHZlYy55KSk7XG4gIH1cblxuICAvKipcbiAgICogRW5hYmxlIGRlYnVnIHJlbmRlcmVyXG4gICAqL1xuICBlbmFibGVEZWJ1Z1JlbmRlcmVyKHNjZW5lOiBQSVhJLkNvbnRhaW5lciwgb3B0aW9uczogUGh5c2ljc0RlYnVnT3B0aW9ucyA9IHt9KTogUGh5c2ljc0RlYnVnUmVuZGVyZXIge1xuICAgIC8vIENsZWFuIHVwIGV4aXN0aW5nIGRlYnVnIHJlbmRlcmVyIGlmIGFueVxuICAgIGlmICh0aGlzLmRlYnVnUmVuZGVyZXIpIHtcbiAgICAgIHRoaXMuZGlzYWJsZURlYnVnUmVuZGVyZXIoKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgZGVidWcgZ3JhcGhpY3NcbiAgICB0aGlzLmRlYnVnR3JhcGhpY3MgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuXG4gICAgLy8gQ3JlYXRlIGRlYnVnIHJlbmRlcmVyIGxvZ2ljXG4gICAgdGhpcy5kZWJ1Z1JlbmRlcmVyID0gbmV3IFBoeXNpY3NEZWJ1Z1JlbmRlcmVyKHRoaXMsIG9wdGlvbnMpO1xuXG4gICAgLy8gTWFrZSBpdCBhbiBlbnRpdHkgYW5kIGFkZCB0byBzY2VuZVxuICAgIGNvbnN0IGRlYnVnRW50aXR5ID0gYXNFbnRpdHkodGhpcy5kZWJ1Z0dyYXBoaWNzKTtcbiAgICBkZWJ1Z0VudGl0eS5tb3hpRW50aXR5LmFkZExvZ2ljKHRoaXMuZGVidWdSZW5kZXJlcik7XG5cbiAgICAvLyBTZXQgaGlnaGVzdCB6LWluZGV4IHNvIGl0IHJlbmRlcnMgb24gdG9wIG9mIGV2ZXJ5dGhpbmdcbiAgICBkZWJ1Z0VudGl0eS56SW5kZXggPSAxMDAwMDtcblxuICAgIC8vIEVuYWJsZSBzb3J0YWJsZSBjaGlsZHJlbiBvbiBzY2VuZSBzbyB6SW5kZXggd29ya3NcbiAgICBzY2VuZS5zb3J0YWJsZUNoaWxkcmVuID0gdHJ1ZTtcblxuICAgIC8vIEFkZCB0byBzY2VuZSBhdCBoaWdoZXN0IHotaW5kZXggc28gaXQgcmVuZGVycyBvbiB0b3BcbiAgICBzY2VuZS5hZGRDaGlsZChkZWJ1Z0VudGl0eSk7XG5cbiAgICBjb25zb2xlLmxvZygnUGh5c2ljcyBkZWJ1ZyByZW5kZXJlciBlbmFibGVkLiBQcmVzcyBcIlBcIiB0byB0b2dnbGUgdmlzaWJpbGl0eS4nKTtcblxuICAgIHJldHVybiB0aGlzLmRlYnVnUmVuZGVyZXI7XG4gIH1cblxuICAvKipcbiAgICogRGlzYWJsZSBkZWJ1ZyByZW5kZXJlclxuICAgKi9cbiAgZGlzYWJsZURlYnVnUmVuZGVyZXIoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZGVidWdSZW5kZXJlciAmJiB0aGlzLmRlYnVnR3JhcGhpY3MpIHtcbiAgICAgIC8vIFJlbW92ZSBmcm9tIHNjZW5lXG4gICAgICBpZiAodGhpcy5kZWJ1Z0dyYXBoaWNzLnBhcmVudCkge1xuICAgICAgICB0aGlzLmRlYnVnR3JhcGhpY3MucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMuZGVidWdHcmFwaGljcyk7XG4gICAgICB9XG5cbiAgICAgIC8vIENsZWFuIHVwXG4gICAgICB0aGlzLmRlYnVnR3JhcGhpY3MuZGVzdHJveSgpO1xuICAgICAgdGhpcy5kZWJ1Z0dyYXBoaWNzID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5kZWJ1Z1JlbmRlcmVyID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZGVidWcgcmVuZGVyZXIgaWYgZW5hYmxlZFxuICAgKi9cbiAgZ2V0RGVidWdSZW5kZXJlcigpOiBQaHlzaWNzRGVidWdSZW5kZXJlciB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuZGVidWdSZW5kZXJlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIGJvZGllcyBpbiB0aGUgd29ybGRcbiAgICovXG4gIGdldEJvZGllcygpOiBwbGFuY2suQm9keVtdIHtcbiAgICBjb25zdCBib2RpZXM6IHBsYW5jay5Cb2R5W10gPSBbXTtcbiAgICBmb3IgKGxldCBib2R5ID0gdGhpcy53b3JsZC5nZXRCb2R5TGlzdCgpOyBib2R5OyBib2R5ID0gYm9keS5nZXROZXh0KCkpIHtcbiAgICAgIGJvZGllcy5wdXNoKGJvZHkpO1xuICAgIH1cbiAgICByZXR1cm4gYm9kaWVzO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFuIHVwIGFuZCBkZXN0cm95IHRoZSBwaHlzaWNzIHdvcmxkXG4gICAqL1xuICBkZXN0cm95KCk6IHZvaWQge1xuICAgIC8vIERlc3Ryb3kgYWxsIGJvZGllc1xuICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuZ2V0Qm9kaWVzKCk7XG4gICAgYm9kaWVzLmZvckVhY2goYm9keSA9PiB0aGlzLndvcmxkLmRlc3Ryb3lCb2R5KGJvZHkpKTtcblxuICAgIHRoaXMuYm9kaWVzLmNsZWFyKCk7XG4gICAgdGhpcy5kZWJ1Z1JlbmRlcmVyID0gdW5kZWZpbmVkO1xuICB9XG59XG4iLCIvKipcbiAqIE9wdGlvbnMgZm9yIGNvbmZpZ3VyaW5nIHRoZSByZXNpemUgaGFuZGxlclxuICovXG5leHBvcnQgaW50ZXJmYWNlIFJlc2l6ZUhhbmRsZXJPcHRpb25zIHtcbiAgLyoqIFJvb3QgZWxlbWVudCBjb250YWluaW5nIHRoZSBjYW52YXMgKi9cbiAgcm9vdEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuICAvKiogVGhlIGRlc2lyZWQgd2lkdGggb2YgdGhlIGdhbWUgdmlld3BvcnQgKi9cbiAgd2lkdGg6IG51bWJlcjtcbiAgLyoqIFRoZSBkZXNpcmVkIGhlaWdodCBvZiB0aGUgZ2FtZSB2aWV3cG9ydCAqL1xuICBoZWlnaHQ6IG51bWJlcjtcbiAgLyoqIE9wdGlvbmFsIENTUyBwcm9wZXJ0aWVzIHRvIGFwcGx5IHRvIHRoZSByb290IGVsZW1lbnQgKi9cbiAgcm9vdFN0eWxlcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gIC8qKiBPcHRpb25hbCBDU1MgcHJvcGVydGllcyB0byBhcHBseSB0byB0aGUgY2FudmFzIGVsZW1lbnQgKi9cbiAgY2FudmFzU3R5bGVzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgLyoqIFdoZXRoZXIgdG8gdXNlIHBpeGVsIGFydCBvcHRpbWl6ZWQgcmVuZGVyaW5nICovXG4gIHBpeGVsQXJ0TW9kZT86IGJvb2xlYW47XG59XG5cbi8qKlxuICogRGVmYXVsdCBzdHlsZXMgYXBwbGllZCB0byB0aGUgcm9vdCBlbGVtZW50XG4gKi9cbmNvbnN0IERFRkFVTFRfUk9PVF9TVFlMRVM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gIGRpc3BsYXk6ICdmbGV4JyxcbiAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLFxuICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgb3ZlcmZsb3c6ICdoaWRkZW4nXG59O1xuXG4vKipcbiAqIERlZmF1bHQgc3R5bGVzIGFwcGxpZWQgdG8gdGhlIGNhbnZhcyBlbGVtZW50IGluIHBpeGVsIGFydCBtb2RlXG4gKi9cbmNvbnN0IFBJWEVMX0FSVF9DQU5WQVNfU1RZTEVTOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICBpbWFnZVJlbmRlcmluZzogJ3BpeGVsYXRlZCdcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIHJlc2l6ZSBoYW5kbGVyIGZ1bmN0aW9uIHRoYXQgbWFpbnRhaW5zIHRoZSBhc3BlY3QgcmF0aW8gb2YgYSBjYW52YXNcbiAqIGFuZCBjZW50ZXJzIGl0IHdpdGhpbiBpdHMgcGFyZW50IGVsZW1lbnQuXG4gKiBcbiAqIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgcmVzaXplIGhhbmRsZXJcbiAqIEByZXR1cm5zIEEgZnVuY3Rpb24gdGhhdCBjYW4gYmUgY2FsbGVkIHRvIGhhbmRsZSByZXNpemUgZXZlbnRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZXNpemVIYW5kbGVyKG9wdGlvbnM6IFJlc2l6ZUhhbmRsZXJPcHRpb25zKTogKCkgPT4gdm9pZCB7XG4gIGNvbnN0IHtcbiAgICByb290RWxlbWVudCxcbiAgICB3aWR0aCxcbiAgICBoZWlnaHQsXG4gICAgcm9vdFN0eWxlcyA9IERFRkFVTFRfUk9PVF9TVFlMRVMsXG4gICAgY2FudmFzU3R5bGVzID0ge30sXG4gICAgcGl4ZWxBcnRNb2RlID0gZmFsc2VcbiAgfSA9IG9wdGlvbnM7XG5cbiAgLy8gQXBwbHkgcm9vdCBlbGVtZW50IHN0eWxlc1xuICBPYmplY3QuZW50cmllcyhyb290U3R5bGVzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICByb290RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbHVlKTtcbiAgfSk7XG5cbiAgLy8gQ29tYmluZSBkZWZhdWx0IGNhbnZhcyBzdHlsZXMgd2l0aCB1c2VyLXByb3ZpZGVkIG9uZXNcbiAgY29uc3QgZmluYWxDYW52YXNTdHlsZXMgPSBwaXhlbEFydE1vZGVcbiAgICA/IHsgLi4uUElYRUxfQVJUX0NBTlZBU19TVFlMRVMsIC4uLmNhbnZhc1N0eWxlcyB9XG4gICAgOiBjYW52YXNTdHlsZXM7XG5cbiAgcmV0dXJuICgpID0+IHtcbiAgICAvLyBHZXQgdGhlIHBhcmVudCBkaW1lbnNpb25zXG4gICAgY29uc3QgcGFyZW50V2lkdGggPSByb290RWxlbWVudC5jbGllbnRXaWR0aDtcbiAgICBjb25zdCBwYXJlbnRIZWlnaHQgPSByb290RWxlbWVudC5jbGllbnRIZWlnaHQ7XG5cbiAgICAvLyBNYWludGFpbiBhc3BlY3QgcmF0aW9cbiAgICBjb25zdCByYXRpbyA9IE1hdGgubWluKFxuICAgICAgcGFyZW50V2lkdGggLyB3aWR0aCxcbiAgICAgIHBhcmVudEhlaWdodCAvIGhlaWdodFxuICAgICk7XG5cbiAgICAvLyBVcGRhdGUgdGhlIGNhbnZhcyBlbGVtZW50IGlmIGl0IGV4aXN0c1xuICAgIGlmIChyb290RWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50KSB7XG4gICAgICBjb25zdCBjYW52YXMgPSByb290RWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICAgIFxuICAgICAgLy8gU2V0IGRpbWVuc2lvbnMgd2hpbGUgbWFpbnRhaW5pbmcgYXNwZWN0IHJhdGlvXG4gICAgICBjYW52YXMuc3R5bGUud2lkdGggPSBgJHtNYXRoLnJvdW5kKHdpZHRoICogcmF0aW8pfXB4YDtcbiAgICAgIGNhbnZhcy5zdHlsZS5oZWlnaHQgPSBgJHtNYXRoLnJvdW5kKGhlaWdodCAqIHJhdGlvKX1weGA7XG4gICAgICBjYW52YXMuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICBcbiAgICAgIC8vIEFwcGx5IGN1c3RvbSBjYW52YXMgc3R5bGVzXG4gICAgICBPYmplY3QuZW50cmllcyhmaW5hbENhbnZhc1N0eWxlcykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIGNhbnZhcy5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cblxuLyoqXG4gKiBTZXRzIHVwIHJlc3BvbnNpdmUgcmVzaXppbmcgZm9yIGEgUElYSSBjYW52YXMgYXBwbGljYXRpb25cbiAqIFxuICogQHBhcmFtIG9wdGlvbnMgLSBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSByZXNpemUgaGFuZGxlclxuICogQHJldHVybnMgQSBjbGVhbnVwIGZ1bmN0aW9uIHRvIHJlbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldHVwUmVzcG9uc2l2ZUNhbnZhcyhvcHRpb25zOiBSZXNpemVIYW5kbGVyT3B0aW9ucyk6ICgpID0+IHZvaWQge1xuICBjb25zdCByZXNpemVIYW5kbGVyID0gY3JlYXRlUmVzaXplSGFuZGxlcihvcHRpb25zKTtcbiAgXG4gIC8vIEluaXRpYWwgcmVzaXplXG4gIHJlc2l6ZUhhbmRsZXIoKTtcbiAgXG4gIC8vIEFkZCBldmVudCBsaXN0ZW5lclxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcmVzaXplSGFuZGxlcik7XG4gIFxuICAvLyBSZXR1cm4gY2xlYW51cCBmdW5jdGlvblxuICByZXR1cm4gKCkgPT4ge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVIYW5kbGVyKTtcbiAgfTtcbn0gIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBBc3NldExvYWRlciB9IGZyb20gJy4uL2NvcmUvYXNzZXQtbG9hZGVyJztcbmltcG9ydCB7IENhbWVyYSB9IGZyb20gJy4uL2NvcmUvY2FtZXJhJztcbmltcG9ydCB7IEVuZ2luZSB9IGZyb20gJy4uL2NvcmUvZW5naW5lJztcbmltcG9ydCB7IFJlbmRlck1hbmFnZXIgfSBmcm9tICcuLi9jb3JlL3JlbmRlci1tYW5hZ2VyJztcbmltcG9ydCB7IFNjZW5lIH0gZnJvbSAnLi4vY29yZS9zY2VuZSc7XG5pbXBvcnQgeyBQaHlzaWNzV29ybGQsIHR5cGUgUGh5c2ljc1dvcmxkT3B0aW9ucyB9IGZyb20gJy4vcGh5c2ljcyc7XG5pbXBvcnQgeyBMb2FkaW5nU2NlbmUsIHR5cGUgTG9hZGluZ1NjZW5lT3B0aW9ucyB9IGZyb20gJy4vbG9hZGluZy1zY2VuZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGl4ZWxQZXJmZWN0T3B0aW9ucyB7XG4gIC8qKiBFbmFibGUgYWxsIHBpeGVsLXBlcmZlY3Qgc2V0dGluZ3MgKHJlc29sdXRpb246IDEsIGFudGlhbGlhczogZmFsc2UsIHJvdW5kUGl4ZWxzOiB0cnVlLCBjYW52YXMgaW1hZ2VSZW5kZXJpbmcpICovXG4gIGVuYWJsZWQ/OiBib29sZWFuO1xuICAvKiogQXBwbHkgY2FudmFzIENTUyBpbWFnZVJlbmRlcmluZyBmb3IgbmVhcmVzdC1uZWlnaGJvciBzY2FsaW5nICovXG4gIGltYWdlUmVuZGVyaW5nPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXR1cE1veGlBcmdzIHtcbiAgaG9zdEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuICByZW5kZXJPcHRpb25zPzogUGFydGlhbDxQSVhJLkF1dG9EZXRlY3RPcHRpb25zPjtcbiAgcGh5c2ljcz86IFBoeXNpY3NXb3JsZE9wdGlvbnMgfCBib29sZWFuO1xuICBzaG93TG9hZGluZ1NjZW5lPzogYm9vbGVhbjtcbiAgbG9hZGluZ1NjZW5lT3B0aW9ucz86IExvYWRpbmdTY2VuZU9wdGlvbnM7XG4gIC8qKiBQaXhlbC1wZXJmZWN0IHJlbmRlcmluZyBvcHRpb25zLiBDYW4gYmUgdHJ1ZSBmb3IgYWxsIGRlZmF1bHRzLCBvciBhbiBvYmplY3QgZm9yIGZpbmUgY29udHJvbCAqL1xuICBwaXhlbFBlcmZlY3Q/OiBib29sZWFuIHwgUGl4ZWxQZXJmZWN0T3B0aW9ucztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXR1cE1veGlSZXN1bHQge1xuICBzY2VuZTogU2NlbmU7XG4gIGVuZ2luZTogRW5naW5lO1xuICBQSVhJQXNzZXRzOiBBc3NldExvYWRlclsnUElYSUFzc2V0cyddO1xuICByZW5kZXJlcjogUElYSS5SZW5kZXJlcjtcbiAgbG9hZEFzc2V0czogQXNzZXRMb2FkZXJbJ2xvYWRBc3NldHMnXTtcbiAgY2FtZXJhOiBDYW1lcmE7XG4gIHBoeXNpY3NXb3JsZD86IFBoeXNpY3NXb3JsZDtcbiAgbG9hZGluZ1NjZW5lPzogTG9hZGluZ1NjZW5lO1xufVxuXG5leHBvcnQgY29uc3QgZGVmYXVsdFJlbmRlck9wdGlvbnMgPSB7XG4gIHdpZHRoOiAxMjgwLFxuICBoZWlnaHQ6IDcyMCxcbiAgYmFja2dyb3VuZENvbG9yOiAweDEwOTliYixcbiAgcmVzb2x1dGlvbjogd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMSxcbiAgYXV0b0RlbnNpdHk6IHRydWUsXG4gIGFudGlhbGlhczogdHJ1ZVxufSBhcyBQYXJ0aWFsPFBJWEkuQXV0b0RldGVjdE9wdGlvbnM+O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0dXBNb3hpKHtcbiAgaG9zdEVsZW1lbnQsXG4gIHJlbmRlck9wdGlvbnMgPSBkZWZhdWx0UmVuZGVyT3B0aW9ucyxcbiAgcGh5c2ljcyxcbiAgc2hvd0xvYWRpbmdTY2VuZSA9IGZhbHNlLFxuICBsb2FkaW5nU2NlbmVPcHRpb25zID0ge30sXG4gIHBpeGVsUGVyZmVjdFxufSA9IHt9IGFzIFNldHVwTW94aUFyZ3MpIHtcbiAgLy8gUHJvY2VzcyBwaXhlbC1wZXJmZWN0IG9wdGlvbnNcbiAgbGV0IGZpbmFsUmVuZGVyT3B0aW9ucyA9IHsgLi4ucmVuZGVyT3B0aW9ucyB9O1xuICBsZXQgYXBwbHlJbWFnZVJlbmRlcmluZyA9IGZhbHNlO1xuXG4gIGlmIChwaXhlbFBlcmZlY3QpIHtcbiAgICBjb25zdCBwcE9wdGlvbnMgPSB0eXBlb2YgcGl4ZWxQZXJmZWN0ID09PSAnYm9vbGVhbidcbiAgICAgID8geyBlbmFibGVkOiB0cnVlLCBpbWFnZVJlbmRlcmluZzogdHJ1ZSB9XG4gICAgICA6IHBpeGVsUGVyZmVjdDtcblxuICAgIGlmIChwcE9wdGlvbnMuZW5hYmxlZCAhPT0gZmFsc2UpIHtcbiAgICAgIC8vIEFwcGx5IHBpeGVsLXBlcmZlY3QgcmVuZGVyIHNldHRpbmdzXG4gICAgICBmaW5hbFJlbmRlck9wdGlvbnMgPSB7XG4gICAgICAgIC4uLmZpbmFsUmVuZGVyT3B0aW9ucyxcbiAgICAgICAgcmVzb2x1dGlvbjogMSxcbiAgICAgICAgYW50aWFsaWFzOiBmYWxzZSxcbiAgICAgICAgcm91bmRQaXhlbHM6IHRydWVcbiAgICAgIH07XG4gICAgfVxuXG4gICAgYXBwbHlJbWFnZVJlbmRlcmluZyA9IHBwT3B0aW9ucy5pbWFnZVJlbmRlcmluZyAhPT0gZmFsc2U7XG4gIH1cblxuICBjb25zdCB7IHJlbmRlcmVyIH0gPSBhd2FpdCBSZW5kZXJNYW5hZ2VyLmNyZWF0ZShob3N0RWxlbWVudCwgZmluYWxSZW5kZXJPcHRpb25zKTtcblxuICAvLyBBcHBseSBjYW52YXMgQ1NTIGZvciBwaXhlbC1wZXJmZWN0IHNjYWxpbmcgaWYgcmVxdWVzdGVkXG4gIGlmIChhcHBseUltYWdlUmVuZGVyaW5nKSB7XG4gICAgY29uc3QgY2FudmFzID0gcmVuZGVyZXIuY2FudmFzIGFzIEhUTUxDYW52YXNFbGVtZW50O1xuICAgIGNhbnZhcy5zdHlsZS5pbWFnZVJlbmRlcmluZyA9ICdwaXhlbGF0ZWQnO1xuICAgIGNhbnZhcy5zdHlsZS5pbWFnZVJlbmRlcmluZyA9ICctbW96LWNyaXNwLWVkZ2VzJztcbiAgICBjYW52YXMuc3R5bGUuaW1hZ2VSZW5kZXJpbmcgPSAnY3Jpc3AtZWRnZXMnO1xuICB9XG5cbiAgY29uc3Qgc2NlbmUgPSBuZXcgU2NlbmUocmVuZGVyZXIpO1xuICBjb25zdCBlbmdpbmUgPSBuZXcgRW5naW5lKHNjZW5lKTtcblxuICAvLyBHZXQgdGhlIEFzc2V0TG9hZGVyIGluc3RhbmNlXG4gIGNvbnN0IGFzc2V0TG9hZGVyID0gbmV3IEFzc2V0TG9hZGVyKCk7XG4gIGNvbnN0IHsgUElYSUFzc2V0cywgbG9hZEFzc2V0cyB9ID0gYXNzZXRMb2FkZXI7XG5cbiAgY29uc3QgY2FtZXJhID0gbmV3IENhbWVyYShzY2VuZSwgcmVuZGVyZXIpO1xuXG4gIC8vIFNldHVwIHBoeXNpY3MgaWYgcmVxdWVzdGVkXG4gIGxldCBwaHlzaWNzV29ybGQ6IFBoeXNpY3NXb3JsZCB8IHVuZGVmaW5lZDtcblxuICBpZiAocGh5c2ljcykge1xuICAgIGNvbnN0IHBoeXNpY3NPcHRpb25zID0gdHlwZW9mIHBoeXNpY3MgPT09ICdib29sZWFuJ1xuICAgICAgPyB7fVxuICAgICAgOiBwaHlzaWNzO1xuXG4gICAgcGh5c2ljc1dvcmxkID0gbmV3IFBoeXNpY3NXb3JsZChwaHlzaWNzT3B0aW9ucyk7XG4gICAgZW5naW5lLmFkZFBoeXNpY3NXb3JsZChwaHlzaWNzV29ybGQpO1xuICB9XG5cbiAgLy8gU2V0dXAgbG9hZGluZyBzY2VuZSBpZiByZXF1ZXN0ZWRcbiAgbGV0IGxvYWRpbmdTY2VuZTogTG9hZGluZ1NjZW5lIHwgdW5kZWZpbmVkO1xuICBpZiAoc2hvd0xvYWRpbmdTY2VuZSkge1xuICAgIGxvYWRpbmdTY2VuZSA9IG5ldyBMb2FkaW5nU2NlbmUobG9hZGluZ1NjZW5lT3B0aW9ucyk7XG4gICAgbG9hZGluZ1NjZW5lLnpJbmRleCA9IDEwMDAwOyAvLyBFbnN1cmUgaXQncyBvbiB0b3BcbiAgICBsb2FkaW5nU2NlbmUuaW5pdChyZW5kZXJlcik7XG4gICAgc2NlbmUuYWRkQ2hpbGQobG9hZGluZ1NjZW5lKTtcbiAgICBsb2FkaW5nU2NlbmUuaGlkZSgpO1xuXG4gICAgLy8gSG9vayBpbnRvIGFzc2V0IGxvYWRpbmcgZXZlbnRzXG4gICAgYXNzZXRMb2FkZXIub24oJ2xvYWRpbmc6c3RhcnQnLCAoKSA9PiB7XG4gICAgICBpZiAobG9hZGluZ1NjZW5lKSB7XG4gICAgICAgIGxvYWRpbmdTY2VuZS5zaG93KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBhc3NldExvYWRlci5vbignbG9hZGluZzplbmQnLCAoKSA9PiB7XG4gICAgICBpZiAobG9hZGluZ1NjZW5lKSB7XG4gICAgICAgIGxvYWRpbmdTY2VuZS5oaWRlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHNjZW5lLFxuICAgIGVuZ2luZSxcbiAgICBQSVhJQXNzZXRzLFxuICAgIHJlbmRlcmVyLFxuICAgIGxvYWRBc3NldHMsXG4gICAgY2FtZXJhLFxuICAgIHBoeXNpY3NXb3JsZCxcbiAgICBsb2FkaW5nU2NlbmVcbiAgfTtcbn1cblxuIiwiaW1wb3J0IHsgTG9naWMgfSBmcm9tICcuLi9jb3JlL2xvZ2ljJztcbmltcG9ydCB7IENvbnRhaW5lciwgUmVuZGVyZXIgfSBmcm9tICdwaXhpLmpzJztcblxuZXhwb3J0IGNsYXNzIFN0YXRlTG9naWMgZXh0ZW5kcyBMb2dpYzxDb250YWluZXI+IHtcbiAgcHJpdmF0ZSBfZW50aXR5OiBDb250YWluZXI7XG5cbiAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICB9XG5cbiAgZ2V0IGVudGl0eSgpIHtcbiAgICByZXR1cm4gdGhpcy5fZW50aXR5O1xuICB9XG5cbiAgaW5pdChlbnRpdHk6IENvbnRhaW5lciwgcmVuZGVyZXI6IFJlbmRlcmVyKSB7XG4gICAgdGhpcy5fZW50aXR5ID0gZW50aXR5O1xuICAgIHN1cGVyLmluaXQoZW50aXR5LCByZW5kZXJlcik7XG4gIH1cblxuICBvbkVudGVyKHN0YXRlOiBzdHJpbmcpIHtcbiAgfVxuXG4gIG9uRXhpdChzdGF0ZTogc3RyaW5nKSB7XG4gIH1cblxuICB1cGRhdGUoZW50aXR5OiBDb250YWluZXIsIGRlbHRhVGltZTogbnVtYmVyKSB7XG4gIH1cbiAgXG59XG5cbiIsImltcG9ydCB7IFN0YXRlTG9naWMgfSBmcm9tICcuL3N0YXRlLWxvZ2ljJztcblxuLy8gRGVmaW5lIHRoZSBjdXN0b20gZXZlbnQgdHlwZSBmb3Igc3RhdGUgY2hhbmdlc1xuZXhwb3J0IHR5cGUgU3RhdGVDaGFuZ2VFdmVudCA9IHtcbiAgcHJldlN0YXRlOiBzdHJpbmcgfCBudWxsO1xuICBuZXdTdGF0ZTogc3RyaW5nO1xufTtcblxudHlwZSBTdGF0ZUNoYW5nZUV2ZW50TGlzdGVuZXIgPSAoZXZlbnQ6IFN0YXRlQ2hhbmdlRXZlbnQpID0+IHZvaWQ7XG50eXBlIFN0YXRlTG9naWNSZWNvcmRzID0gUmVjb3JkPHN0cmluZywgU3RhdGVMb2dpYz47XG5cbmV4cG9ydCBjbGFzcyBTdGF0ZU1hY2hpbmUgZXh0ZW5kcyBFdmVudFRhcmdldCB7XG4gIHByaXZhdGUgX3N0YXRlczogU3RhdGVMb2dpY1JlY29yZHMgPSB7fTtcbiAgcHJpdmF0ZSBfY3VycmVudFN0YXRlOiBTdGF0ZUxvZ2ljIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgX2N1cnJlbnRTdGF0ZU5hbWU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKHN0YXRlczogU3RhdGVMb2dpY1JlY29yZHMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fc3RhdGVzID0gc3RhdGVzO1xuICB9XG5cbiAgdXBkYXRlKGRlbHRhVGltZTogbnVtYmVyKSB7XG4gICAgaWYgKHRoaXMuX2N1cnJlbnRTdGF0ZSkge1xuICAgICAgdGhpcy5fY3VycmVudFN0YXRlLnVwZGF0ZSh0aGlzLl9jdXJyZW50U3RhdGUuZW50aXR5LCBkZWx0YVRpbWUpO1xuICAgIH1cbiAgfVxuICBcbiAgc2V0U3RhdGUoc3RhdGVOYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBuZXh0U3RhdGUgPSB0aGlzLl9zdGF0ZXNbc3RhdGVOYW1lXTtcbiAgICBpZighbmV4dFN0YXRlKSByZXR1cm47XG5cbiAgICBjb25zdCBwcmV2U3RhdGVOYW1lID0gdGhpcy5fY3VycmVudFN0YXRlTmFtZTtcbiAgICBcbiAgICBpZiAodGhpcy5fY3VycmVudFN0YXRlKSB7XG4gICAgICB0aGlzLl9jdXJyZW50U3RhdGUub25FeGl0KHN0YXRlTmFtZSk7XG4gICAgfVxuXG4gICAgdGhpcy5fY3VycmVudFN0YXRlID0gdGhpcy5fc3RhdGVzW3N0YXRlTmFtZV07XG4gICAgdGhpcy5fY3VycmVudFN0YXRlTmFtZSA9IHN0YXRlTmFtZTtcbiAgICB0aGlzLl9jdXJyZW50U3RhdGUub25FbnRlcihzdGF0ZU5hbWUpO1xuICAgIFxuICAgIC8vIERpc3BhdGNoIHRoZSBzdGF0ZSBjaGFuZ2UgZXZlbnRcbiAgICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudDxTdGF0ZUNoYW5nZUV2ZW50Pignc3RhdGVDaGFuZ2UnLCB7XG4gICAgICBkZXRhaWw6IHtcbiAgICAgICAgcHJldlN0YXRlOiBwcmV2U3RhdGVOYW1lLFxuICAgICAgICBuZXdTdGF0ZTogc3RhdGVOYW1lXG4gICAgICB9XG4gICAgfSk7XG4gICAgXG4gICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgfVxuXG4gIGFkZFN0YXRlKHN0YXRlOiBTdGF0ZUxvZ2ljKSB7XG4gICAgdGhpcy5fc3RhdGVzW3N0YXRlLm5hbWVdID0gc3RhdGU7XG4gIH1cbiAgXG4gIGdldCBjdXJyZW50U3RhdGUoKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRTdGF0ZU5hbWU7XG4gIH1cbn1cblxuIiwiLyoqXG4gKiBVdGlsaXR5IHRvIGNvbnZlcnQgU1ZHIHRvIFBJWEkgdGV4dHVyZVxuICovXG5pbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNWR1RvVGV4dHVyZU9wdGlvbnMge1xuICBzdmdTdHJpbmc6IHN0cmluZztcbiAgd2lkdGg6IG51bWJlcjsgIC8vIERlc2lyZWQgd2lkdGggaW4gYWN0dWFsIHBpeGVsc1xuICBoZWlnaHQ6IG51bWJlcjsgLy8gRGVzaXJlZCBoZWlnaHQgaW4gYWN0dWFsIHBpeGVsc1xuICBjb2xvcj86IG51bWJlcjsgLy8gQ29sb3IgdG8gcmVwbGFjZSBcImN1cnJlbnRDb2xvclwiIHdpdGhcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhbiBTVkcgc3RyaW5nIHRvIGEgUElYSSB0ZXh0dXJlXG4gKiBBY2NvdW50cyBmb3IgcHJvcGVyIHNjYWxpbmcgYW5kIHJlbmRlcnMgYXQgdGhlIGV4YWN0IHBpeGVsIGRpbWVuc2lvbnMgbmVlZGVkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdmdUb1RleHR1cmUob3B0aW9uczogU1ZHVG9UZXh0dXJlT3B0aW9ucyk6IFByb21pc2U8UElYSS5UZXh0dXJlPiB7XG4gIGNvbnN0IHsgc3ZnU3RyaW5nLCB3aWR0aCwgaGVpZ2h0LCBjb2xvciA9IDB4MDAwMDAwIH0gPSBvcHRpb25zO1xuXG4gIC8vIFJlcGxhY2UgY3VycmVudENvbG9yIHdpdGggYWN0dWFsIGNvbG9yXG4gIGNvbnN0IGNvbG9ySGV4ID0gJyMnICsgY29sb3IudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDYsICcwJyk7XG4gIGNvbnN0IHByb2Nlc3NlZFNWRyA9IHN2Z1N0cmluZy5yZXBsYWNlKC9jdXJyZW50Q29sb3IvZywgY29sb3JIZXgpO1xuXG4gIC8vIENyZWF0ZSBhIGJsb2IgZnJvbSB0aGUgU1ZHIHN0cmluZ1xuICBjb25zdCBibG9iID0gbmV3IEJsb2IoW3Byb2Nlc3NlZFNWR10sIHsgdHlwZTogJ2ltYWdlL3N2Zyt4bWwnIH0pO1xuICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuXG4gIC8vIExvYWQgYXMgaW1hZ2VcbiAgY29uc3QgaW1nID0gbmV3IEltYWdlKCk7XG4gIGltZy53aWR0aCA9IHdpZHRoO1xuICBpbWcuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpbWcub25sb2FkID0gKCkgPT4gcmVzb2x2ZSgpO1xuICAgIGltZy5vbmVycm9yID0gcmVqZWN0O1xuICAgIGltZy5zcmMgPSB1cmw7XG4gIH0pO1xuXG4gIC8vIENyZWF0ZSBjYW52YXMgYW5kIGRyYXcgdGhlIGltYWdlIGF0IHRoZSBleGFjdCBzaXplXG4gIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICBjYW52YXMud2lkdGggPSB3aWR0aDtcbiAgY2FudmFzLmhlaWdodCA9IGhlaWdodDtcbiAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgaWYgKCFjdHgpIHtcbiAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IGNhbnZhcyBjb250ZXh0Jyk7XG4gIH1cblxuICAvLyBEcmF3IHRoZSBpbWFnZVxuICBjdHguZHJhd0ltYWdlKGltZywgMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgLy8gQ2xlYW4gdXBcbiAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xuXG4gIC8vIENyZWF0ZSB0ZXh0dXJlIGZyb20gY2FudmFzXG4gIGNvbnN0IHRleHR1cmUgPSBQSVhJLlRleHR1cmUuZnJvbShjYW52YXMpO1xuICB0ZXh0dXJlLnNvdXJjZS5zY2FsZU1vZGUgPSAnbGluZWFyJzsgLy8gU21vb3RoIHNjYWxpbmcgZm9yIFNWR1xuXG4gIHJldHVybiB0ZXh0dXJlO1xufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbi8qKlxuICogU2VxdWVuY2UgaW5mb3JtYXRpb24gZm9yIGFuIGFuaW1hdGlvblxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNlcXVlbmNlSW5mbyB7XG4gIC8qKiBBcnJheSBvZiBmcmFtZSBpbmRpY2VzIGZyb20gdGhlIHRleHR1cmUgYXRsYXMgKi9cbiAgZnJhbWVzOiBudW1iZXJbXTtcbiAgLyoqIFNwZWVkIG9mIGFuaW1hdGlvbiAoZnJhbWVzIHBlciBtcykgKi9cbiAgYW5pbWF0aW9uU3BlZWQ6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBNYW5hZ2VzIGZyYW1lIHNlcXVlbmNlcyBmb3IgYW5pbWF0ZWQgc3ByaXRlc1xuICogUHJvdmlkZXMgdXRpbGl0eSBmdW5jdGlvbnMgZm9yIHdvcmtpbmcgd2l0aCBzcHJpdGUgc2hlZXQgYW5pbWF0aW9uc1xuICovXG5leHBvcnQgY2xhc3MgVGV4dHVyZUZyYW1lU2VxdWVuY2VzIHtcbiAgcHJpdmF0ZSBmcmFtZXM6IFBJWEkuVGV4dHVyZVtdID0gW107XG4gIHByaXZhdGUgc2VxdWVuY2VzOiBSZWNvcmQ8c3RyaW5nLCBTZXF1ZW5jZUluZm8+ID0ge307XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIG5ldyBUZXh0dXJlRnJhbWVTZXF1ZW5jZXNcbiAgICogQHBhcmFtIGZyYW1lcyAtIEFycmF5IG9mIHRleHR1cmVzIGZyb20gYSBzcHJpdGVzaGVldFxuICAgKiBAcGFyYW0gc2VxdWVuY2VzIC0gTmFtZWQgc2VxdWVuY2VzIHdpdGggZnJhbWUgaW5kaWNlcyBhbmQgYW5pbWF0aW9uIHNwZWVkXG4gICAqL1xuICBjb25zdHJ1Y3RvcihmcmFtZXM6IFBJWEkuVGV4dHVyZVtdLCBzZXF1ZW5jZXM6IFJlY29yZDxzdHJpbmcsIFNlcXVlbmNlSW5mbz4gPSB7fSkge1xuICAgIHRoaXMuZnJhbWVzID0gZnJhbWVzO1xuICAgIHRoaXMuc2VxdWVuY2VzID0gc2VxdWVuY2VzO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhIG5ldyBhbmltYXRpb24gc2VxdWVuY2VcbiAgICogQHBhcmFtIG5hbWUgLSBVbmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHNlcXVlbmNlXG4gICAqIEBwYXJhbSBmcmFtZUluZGljZXMgLSBBcnJheSBvZiBmcmFtZSBpbmRpY2VzIGZyb20gdGhlIHRleHR1cmUgYXRsYXNcbiAgICogQHBhcmFtIGFuaW1hdGlvblNwZWVkIC0gU3BlZWQgb2YgYW5pbWF0aW9uIChmcmFtZXMgcGVyIG1zKVxuICAgKi9cbiAgYWRkU2VxdWVuY2UobmFtZTogc3RyaW5nLCBmcmFtZUluZGljZXM6IG51bWJlcltdLCBhbmltYXRpb25TcGVlZDogbnVtYmVyID0gMSkge1xuICAgIHRoaXMuc2VxdWVuY2VzW25hbWVdID0ge1xuICAgICAgZnJhbWVzOiBmcmFtZUluZGljZXMsXG4gICAgICBhbmltYXRpb25TcGVlZFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgc2VxdWVuY2UgYnkgbmFtZVxuICAgKi9cbiAgZ2V0U2VxdWVuY2UobmFtZTogc3RyaW5nKTogU2VxdWVuY2VJbmZvIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuc2VxdWVuY2VzW25hbWVdIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgc3BlY2lmaWMgZnJhbWUgYnkgaW5kZXhcbiAgICovXG4gIGdldEZyYW1lKGluZGV4OiBudW1iZXIpOiBQSVhJLlRleHR1cmUgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5mcmFtZXNbaW5kZXhdIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgc3BlY2lmaWMgZnJhbWUgZnJvbSBhIHNlcXVlbmNlIGJ5IGluZGV4XG4gICAqL1xuICBnZXRGcmFtZUZyb21TZXF1ZW5jZShzZXF1ZW5jZU5hbWU6IHN0cmluZywgZnJhbWVJbmRleDogbnVtYmVyKTogUElYSS5UZXh0dXJlIHwgbnVsbCB7XG4gICAgY29uc3Qgc2VxdWVuY2UgPSB0aGlzLmdldFNlcXVlbmNlKHNlcXVlbmNlTmFtZSk7XG4gICAgaWYgKCFzZXF1ZW5jZSkgcmV0dXJuIG51bGw7XG4gICAgXG4gICAgLy8gR2V0IHRoZSBhcHByb3ByaWF0ZSBmcmFtZSBpbmRleCBmcm9tIHRoZSBzZXF1ZW5jZVxuICAgIGNvbnN0IHNlcXVlbmNlRnJhbWVJbmRleCA9IHNlcXVlbmNlLmZyYW1lc1tmcmFtZUluZGV4ICUgc2VxdWVuY2UuZnJhbWVzLmxlbmd0aF07XG4gICAgXG4gICAgLy8gUmV0dXJuIHRoZSB0ZXh0dXJlXG4gICAgcmV0dXJuIHRoaXMuZnJhbWVzW3NlcXVlbmNlRnJhbWVJbmRleF0gfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIGZyYW1lcyBmb3IgYSBzZXF1ZW5jZVxuICAgKi9cbiAgZ2V0RnJhbWVTZXF1ZW5jZShuYW1lOiBzdHJpbmcpOiBQSVhJLlRleHR1cmVbXSB7XG4gICAgY29uc3Qgc2VxdWVuY2UgPSB0aGlzLmdldFNlcXVlbmNlKG5hbWUpO1xuICAgIGlmICghc2VxdWVuY2UpIHJldHVybiBbXTtcbiAgICBcbiAgICByZXR1cm4gc2VxdWVuY2UuZnJhbWVzLm1hcChpbmRleCA9PiB0aGlzLmZyYW1lc1tpbmRleF0pLmZpbHRlcihCb29sZWFuKTtcbiAgfVxufSAiLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcblxuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGNyZWF0aW5nIHRleHR1cmUgZnJhbWVzIGZyb20gYSBzcHJpdGVzaGVldFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEFzVGV4dHVyZUZyYW1lc09wdGlvbnMge1xuICAvKipcbiAgICogV2lkdGggb2YgZWFjaCBmcmFtZSBpbiBwaXhlbHNcbiAgICovXG4gIGZyYW1lV2lkdGg6IG51bWJlcjtcbiAgXG4gIC8qKlxuICAgKiBIZWlnaHQgb2YgZWFjaCBmcmFtZSBpbiBwaXhlbHNcbiAgICovXG4gIGZyYW1lSGVpZ2h0OiBudW1iZXI7XG4gIFxuICAvKipcbiAgICogTnVtYmVyIG9mIGNvbHVtbnMgaW4gdGhlIHNwcml0ZXNoZWV0XG4gICAqL1xuICBjb2x1bW5zOiBudW1iZXI7XG4gIFxuICAvKipcbiAgICogTnVtYmVyIG9mIHJvd3MgaW4gdGhlIHNwcml0ZXNoZWV0XG4gICAqL1xuICByb3dzOiBudW1iZXI7XG59XG5cbi8qKlxuICogRGVmYXVsdCB0ZXh0dXJlIGZyYW1lIG9wdGlvbnNcbiAqL1xuY29uc3QgZGVmYXVsdE9wdGlvbnM6IEFzVGV4dHVyZUZyYW1lc09wdGlvbnMgPSB7IFxuICBmcmFtZVdpZHRoOiA0OCwgXG4gIGZyYW1lSGVpZ2h0OiA0OCwgXG4gIGNvbHVtbnM6IDQsIFxuICByb3dzOiA0IFxufTtcblxuLyoqXG4gKiBTcGxpdHMgYSB0ZXh0dXJlIHNvdXJjZSBpbnRvIGluZGl2aWR1YWwgdGV4dHVyZSBmcmFtZXMgYmFzZWQgb24gYSBncmlkIGxheW91dFxuICogXG4gKiBAcGFyYW0gdGV4dHVyZVNvdXJjZSAtIFRoZSBzb3VyY2UgdGV4dHVyZSB0byBzcGxpdCBpbnRvIGZyYW1lc1xuICogQHBhcmFtIG9wdGlvbnMgLSBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIGZyYW1lIGV4dHJhY3Rpb25cbiAqIEByZXR1cm5zIEFycmF5IG9mIGluZGl2aWR1YWwgdGV4dHVyZSBmcmFtZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzVGV4dHVyZUZyYW1lcyhcbiAgUElYSSxcbiAgdGV4dHVyZVNvdXJjZTogUElYSS5UZXh0dXJlU291cmNlLCBcbiAgb3B0aW9uczogQXNUZXh0dXJlRnJhbWVzT3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zLFxuKTogUElYSS5UZXh0dXJlPFBJWEkuVGV4dHVyZVNvdXJjZTxhbnk+PltdIHtcbiAgY29uc3QgeyBmcmFtZVdpZHRoLCBmcmFtZUhlaWdodCwgY29sdW1ucywgcm93cyB9ID0gb3B0aW9ucztcbiAgY29uc3QgZnJhbWVzOiBQSVhJLlRleHR1cmU8UElYSS5UZXh0dXJlU291cmNlPGFueT4+W10gPSBbXTtcblxuICAvLyBFbnN1cmUgd2UncmUgd29ya2luZyB3aXRoIGEgdmFsaWRhdGVkIHRleHR1cmUgc291cmNlXG4gIGlmICghdGV4dHVyZVNvdXJjZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgdGV4dHVyZSBzb3VyY2UgcHJvdmlkZWQgdG8gYXNUZXh0dXJlRnJhbWVzJyk7XG4gICAgcmV0dXJuIGZyYW1lcztcbiAgfVxuXG4gIC8vIENyZWF0ZSB0ZXh0dXJlcyBmcm9tIHRoZSB0ZXh0dXJlIHNvdXJjZSAtIGtlZXBpbmcgaW1wbGVtZW50YXRpb24gaWRlbnRpY2FsIHRvIHdvcmtpbmcgdmVyc2lvblxuICBmb3IgKGxldCB5ID0gMDsgeSA8IHJvd3M7IHkrKykge1xuICAgIGZvciAobGV0IHggPSAwOyB4IDwgY29sdW1uczsgeCsrKSB7XG4gICAgICBjb25zdCBmcmFtZSA9IG5ldyBQSVhJLlJlY3RhbmdsZSh4ICogZnJhbWVXaWR0aCwgeSAqIGZyYW1lSGVpZ2h0LCBmcmFtZVdpZHRoLCBmcmFtZUhlaWdodCk7XG4gICAgICBcbiAgICAgIC8vIEtlZXAgdGhlIGV4YWN0IHNhbWUgaW1wbGVtZW50YXRpb24gYXMgdGhlIHdvcmtpbmcgZXhhbXBsZVxuICAgICAgY29uc3QgZnJhbWV0ZXh0dXJlID0gbmV3IFBJWEkuVGV4dHVyZSh7XG4gICAgICAgIHNvdXJjZTogdGV4dHVyZVNvdXJjZSxcbiAgICAgICAgZnJhbWU6IGZyYW1lLFxuICAgICAgfSkgYXMgUElYSS5UZXh0dXJlPFBJWEkuVGV4dHVyZVNvdXJjZTxhbnk+PjtcbiAgICAgIFxuICAgICAgZnJhbWVzLnB1c2goZnJhbWV0ZXh0dXJlKTtcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiBmcmFtZXMgYXMgUElYSS5UZXh0dXJlPFBJWEkuVGV4dHVyZVNvdXJjZTxhbnk+PltdO1xufVxuIiwiaW1wb3J0IHsgUG9pbnQgfSBmcm9tICdwaXhpLmpzJztcblxuLyoqXG4gKiBDb21tb25seSB1c2VkIFBvaW50IGZhY3RvcnkgZnVuY3Rpb25zXG4gKiBUaGVzZSByZWR1Y2Ugb2JqZWN0IGFsbG9jYXRpb25zIGFuZCBjbGFyaWZ5IGludGVudFxuICovXG5leHBvcnQgY29uc3QgY3JlYXRlUG9pbnQgPSAoeCA9IDAsIHkgPSAwKTogUG9pbnQgPT4gbmV3IFBvaW50KHgsIHkpO1xuZXhwb3J0IGNvbnN0IFpFUk9fUE9JTlQgPSAoKTogUG9pbnQgPT4gbmV3IFBvaW50KDAsIDApO1xuZXhwb3J0IGNvbnN0IE9ORV9QT0lOVCA9ICgpOiBQb2ludCA9PiBuZXcgUG9pbnQoMSwgMSk7XG5cbmV4cG9ydCBjb25zdCB1YyA9IChzID0gJycpID0+IHMudG9VcHBlckNhc2UoKTtcbmV4cG9ydCBjb25zdCBsYyA9IChzID0gJycpID0+IHMudG9Mb3dlckNhc2UoKTtcblxuZXhwb3J0IGNvbnN0IHBhZFJpZ2h0ID0gKHZhbCA9ICcnLCBsZW5ndGggPSAwLCBwYWRXaXRoID0gJyAnKSA9PiB7XG4gIGxldCByZXN1bHQgPSB2YWwrJyc7XG4gIHdoaWxlKHJlc3VsdC5sZW5ndGggPCBsZW5ndGgpe1xuICAgIHJlc3VsdCArPSBwYWRXaXRoO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5leHBvcnQgY29uc3QgcHIgPSBwYWRSaWdodDtcblxuLyoqXG4gKiBHZW5lcmF0ZSByYW5kb20gaW50ZWdlciBiZXR3ZWVuIG1pbiBhbmQgbWF4IChpbmNsdXNpdmUpXG4gKiBAcGFyYW0gbWluIC0gTWluaW11bSB2YWx1ZSAoaW5jbHVzaXZlKVxuICogQHBhcmFtIG1heCAtIE1heGltdW0gdmFsdWUgKGluY2x1c2l2ZSlcbiAqIEByZXR1cm5zIFJhbmRvbSBpbnRlZ2VyIGluIHJhbmdlIFttaW4sIG1heF1cbiAqL1xuZXhwb3J0IGNvbnN0IGdldFJhbmRvbUludCA9IChtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIgPT4gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggKyAxIC0gbWluKSkgKyBtaW4pO1xuXG5leHBvcnQgY29uc3Qgcm91bmRUbyA9IChwbGFjZXMsIHZhbHVlKSA9PiAoTWF0aC5yb3VuZCh2YWx1ZSAqIE1hdGgucG93KDEwLCBwbGFjZXMpKSAvIE1hdGgucG93KDEwLCBwbGFjZXMpKTtcblxuZXhwb3J0IGNvbnN0IGxlcnAgPSAoYmVnaW4sIGVuZCwgbWFnKSA9PiAoKDEgLSBtYWcpICogYmVnaW4gKyBtYWcgKiBlbmQpO1xuXG5leHBvcnQgZnVuY3Rpb24gbWV0ZXJzVG9QaXhlbHMobTogbnVtYmVyKTogbnVtYmVyIHsgcmV0dXJuIG0gKiAyMDsgfVxuXG5leHBvcnQgZnVuY3Rpb24gcGl4ZWxzVG9NZXRlcnMocDogbnVtYmVyKTogbnVtYmVyIHsgcmV0dXJuIHAgKiAwLjA1OyB9XG5cbmV4cG9ydCBjb25zdCBmZXRjaFhtbCA9IGFzeW5jICh1cmw6IHN0cmluZykgPT4gKGF3YWl0IChhd2FpdCBmZXRjaCh1cmwpKS50ZXh0KCkpO1xuXG5leHBvcnQgY29uc3QgcmFkMmRlZyA9IChyYWQ6IG51bWJlcikgPT4gcmFkICogKDE4MCAvIE1hdGguUEkpO1xuZXhwb3J0IGNvbnN0IGRlZzJyYWQgPSAoZGVnOiBudW1iZXIpID0+IGRlZyAqIChNYXRoLlBJIC8gMTgwKTtcbiAgIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJU2NhbGVNb2RlIH0gZnJvbSAnLi9VSVNjYWxlTW9kZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVUlMYXllck9wdGlvbnMge1xuICAvKipcbiAgICogU2NhbGluZyBtb2RlIGZvciB0aGlzIFVJIGxheWVyXG4gICAqIEBkZWZhdWx0IFVJU2NhbGVNb2RlLk5vbmVcbiAgICovXG4gIHNjYWxlTW9kZT86IFVJU2NhbGVNb2RlO1xuXG4gIC8qKlxuICAgKiBUYXJnZXQgd2lkdGggZm9yIHRoZSBVSSBsYXllciAodXNlZCBhcyByZWZlcmVuY2UgZm9yIHNjYWxpbmcpXG4gICAqIElmIG5vdCBwcm92aWRlZCwgdXNlcyB0aGUgZmlyc3QgY2hpbGQncyB3aWR0aFxuICAgKi9cbiAgdGFyZ2V0V2lkdGg/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRhcmdldCBoZWlnaHQgZm9yIHRoZSBVSSBsYXllciAodXNlZCBhcyByZWZlcmVuY2UgZm9yIHNjYWxpbmcpXG4gICAqIElmIG5vdCBwcm92aWRlZCwgdXNlcyB0aGUgZmlyc3QgY2hpbGQncyBoZWlnaHRcbiAgICovXG4gIHRhcmdldEhlaWdodD86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBVSUxheWVyIGlzIGEgY29udGFpbmVyIHRoYXQgbWFuYWdlcyBzY2FsaW5nIGJlaGF2aW9yIGZvciBhbGwgaXRzIGNoaWxkcmVuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGh1ZExheWVyID0gbmV3IFVJTGF5ZXIoeyBzY2FsZU1vZGU6IFVJU2NhbGVNb2RlLlNjYWxlVUkgfSk7XG4gKiBzY2VuZS5hZGRDaGlsZChodWRMYXllcik7XG4gKiBodWRMYXllci5hZGRDaGlsZCh0YWJzLmNvbnRhaW5lcik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJTGF5ZXIgZXh0ZW5kcyBQSVhJLkNvbnRhaW5lciB7XG4gIHByaXZhdGUgc2NhbGVNb2RlOiBVSVNjYWxlTW9kZTtcbiAgcHJpdmF0ZSB0YXJnZXRXaWR0aD86IG51bWJlcjtcbiAgcHJpdmF0ZSB0YXJnZXRIZWlnaHQ/OiBudW1iZXI7XG4gIHByaXZhdGUgaW5pdGlhbEJvdW5kc1JlY29yZGVkID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogVUlMYXllck9wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5zY2FsZU1vZGUgPSBvcHRpb25zLnNjYWxlTW9kZSA/PyBVSVNjYWxlTW9kZS5Ob25lO1xuICAgIHRoaXMudGFyZ2V0V2lkdGggPSBvcHRpb25zLnRhcmdldFdpZHRoO1xuICAgIHRoaXMudGFyZ2V0SGVpZ2h0ID0gb3B0aW9ucy50YXJnZXRIZWlnaHQ7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBsYXllcidzIHNjYWxlIGJhc2VkIG9uIHRoZSBjdXJyZW50IGNhbnZhcyBzaXplXG4gICAqL1xuICB1cGRhdGVTY2FsZShjYW52YXNXaWR0aDogbnVtYmVyLCBjYW52YXNIZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGlmICh0aGlzLnNjYWxlTW9kZSA9PT0gVUlTY2FsZU1vZGUuTm9uZSkge1xuICAgICAgdGhpcy5zY2FsZS5zZXQoMSwgMSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gUmVjb3JkIGluaXRpYWwgYm91bmRzIGZyb20gZmlyc3QgY2hpbGQgaWYgbm90IGV4cGxpY2l0bHkgc2V0XG4gICAgaWYgKCF0aGlzLmluaXRpYWxCb3VuZHNSZWNvcmRlZCAmJiB0aGlzLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgIGlmICghdGhpcy50YXJnZXRXaWR0aCB8fCAhdGhpcy50YXJnZXRIZWlnaHQpIHtcbiAgICAgICAgY29uc3QgYm91bmRzID0gdGhpcy5nZXRMb2NhbEJvdW5kcygpO1xuICAgICAgICB0aGlzLnRhcmdldFdpZHRoID0gdGhpcy50YXJnZXRXaWR0aCA/PyBib3VuZHMud2lkdGg7XG4gICAgICAgIHRoaXMudGFyZ2V0SGVpZ2h0ID0gdGhpcy50YXJnZXRIZWlnaHQgPz8gYm91bmRzLmhlaWdodDtcbiAgICAgIH1cbiAgICAgIHRoaXMuaW5pdGlhbEJvdW5kc1JlY29yZGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMudGFyZ2V0V2lkdGggfHwgIXRoaXMudGFyZ2V0SGVpZ2h0KSB7XG4gICAgICAvLyBObyBkaW1lbnNpb25zIHRvIHNjYWxlIGZyb20geWV0XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgc2NhbGVYID0gY2FudmFzV2lkdGggLyB0aGlzLnRhcmdldFdpZHRoO1xuICAgIGNvbnN0IHNjYWxlWSA9IGNhbnZhc0hlaWdodCAvIHRoaXMudGFyZ2V0SGVpZ2h0O1xuXG4gICAgc3dpdGNoICh0aGlzLnNjYWxlTW9kZSkge1xuICAgICAgY2FzZSBVSVNjYWxlTW9kZS5TY2FsZVVJOlxuICAgICAgICAvLyBTY2FsZSB0byBmaWxsLCBzdHJldGNoaW5nIGlmIG5lY2Vzc2FyeVxuICAgICAgICB0aGlzLnNjYWxlLnNldChzY2FsZVgsIHNjYWxlWSk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFVJU2NhbGVNb2RlLkxvY2tSYXRpbzpcbiAgICAgICAgLy8gU2NhbGUgbWFpbnRhaW5pbmcgYXNwZWN0IHJhdGlvXG4gICAgICAgIGNvbnN0IHNjYWxlID0gTWF0aC5taW4oc2NhbGVYLCBzY2FsZVkpO1xuICAgICAgICB0aGlzLnNjYWxlLnNldChzY2FsZSwgc2NhbGUpO1xuICAgICAgICAvLyBDZW50ZXIgdGhlIGNvbnRlbnRcbiAgICAgICAgdGhpcy5wb3NpdGlvbi5zZXQoXG4gICAgICAgICAgKGNhbnZhc1dpZHRoIC0gdGhpcy50YXJnZXRXaWR0aCAqIHNjYWxlKSAvIDIsXG4gICAgICAgICAgKGNhbnZhc0hlaWdodCAtIHRoaXMudGFyZ2V0SGVpZ2h0ICogc2NhbGUpIC8gMlxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgY2hpbGQgYW5kIHRyaWdnZXIgc2NhbGUgdXBkYXRlIGlmIG5lZWRlZFxuICAgKi9cbiAgb3ZlcnJpZGUgYWRkQ2hpbGQ8VCBleHRlbmRzIFBJWEkuQ29udGFpbmVyW10+KC4uLmNoaWxkcmVuOiBUKTogVFswXSB7XG4gICAgY29uc3QgcmVzdWx0ID0gc3VwZXIuYWRkQ2hpbGQoLi4uY2hpbGRyZW4pO1xuICAgIHRoaXMuaW5pdGlhbEJvdW5kc1JlY29yZGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxufVxuIiwiLyoqXG4gKiBVSSBTY2FsaW5nIG1vZGVzIGZvciBVSUxheWVyXG4gKi9cbmV4cG9ydCBlbnVtIFVJU2NhbGVNb2RlIHtcbiAgLyoqXG4gICAqIE5vIHNjYWxpbmcgLSAxOjEgcGl4ZWwgbWFwcGluZywgbm8gb2Zmc2V0IGNhbGN1bGF0aW9uc1xuICAgKi9cbiAgTm9uZSA9ICdub25lJyxcblxuICAvKipcbiAgICogU2NhbGUgVUkgcHJvcG9ydGlvbmFsbHkgdG8gZmlsbCB0aGUgYXZhaWxhYmxlIHNwYWNlXG4gICAqL1xuICBTY2FsZVVJID0gJ3NjYWxlVUknLFxuXG4gIC8qKlxuICAgKiBTY2FsZSB3aGlsZSBtYWludGFpbmluZyBhc3BlY3QgcmF0aW8gKG1heSBsZXR0ZXJib3gvcGlsbGFyYm94KVxuICAgKi9cbiAgTG9ja1JhdGlvID0gJ2xvY2tSYXRpbydcbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgQnV0dG9uU3RhdGUgfSBmcm9tICcuL3VpLWJ1dHRvbic7XG5pbXBvcnQgeyBVSVBhbmVsIH0gZnJvbSAnLi91aS1wYW5lbCc7XG5cbi8qKlxuICogU3RyYXRlZ3kgaW50ZXJmYWNlIGZvciBidXR0b24gYmFja2dyb3VuZCByZW5kZXJpbmdcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBCdXR0b25CYWNrZ3JvdW5kU3RyYXRlZ3kge1xuICAvKipcbiAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyB0aGUgYmFja2dyb3VuZCBjb250YWluZXJcbiAgICovXG4gIGNyZWF0ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IFBJWEkuQ29udGFpbmVyO1xuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSB2aXN1YWwgc3RhdGUgb2YgdGhlIGJhY2tncm91bmRcbiAgICovXG4gIHVwZGF0ZVN0YXRlKHN0YXRlOiBCdXR0b25TdGF0ZSk6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGFjdHVhbCByZW5kZXJlZCBoZWlnaHQgb2YgdGhlIGJhY2tncm91bmRcbiAgICovXG4gIGdldEFjdHVhbEhlaWdodCgpOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIENsZWFucyB1cCByZXNvdXJjZXNcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZDtcbn1cblxuLyoqXG4gKiBTb2xpZCBjb2xvciBiYWNrZ3JvdW5kIHN0cmF0ZWd5IHVzaW5nIFVJUGFuZWxcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGNsYXNzIFNvbGlkQ29sb3JCYWNrZ3JvdW5kU3RyYXRlZ3kgaW1wbGVtZW50cyBCdXR0b25CYWNrZ3JvdW5kU3RyYXRlZ3kge1xuICBwcml2YXRlIHBhbmVsPzogVUlQYW5lbDtcbiAgcHJpdmF0ZSBub3JtYWxDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIGhvdmVyQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBwcmVzc2VkQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBkaXNhYmxlZENvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgd2lkdGg6IG51bWJlcjtcbiAgcHJpdmF0ZSBoZWlnaHQ6IG51bWJlcjtcbiAgcHJpdmF0ZSBib3JkZXJSYWRpdXM6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IG51bWJlcixcbiAgICB3aWR0aDogbnVtYmVyLFxuICAgIGhlaWdodDogbnVtYmVyLFxuICAgIGJvcmRlclJhZGl1czogbnVtYmVyXG4gICkge1xuICAgIHRoaXMubm9ybWFsQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3I7XG4gICAgdGhpcy5ob3ZlckNvbG9yID0gdGhpcy5kYXJrZW5Db2xvcihiYWNrZ3JvdW5kQ29sb3IsIDAuOSk7XG4gICAgdGhpcy5wcmVzc2VkQ29sb3IgPSB0aGlzLmRhcmtlbkNvbG9yKGJhY2tncm91bmRDb2xvciwgMC44KTtcbiAgICB0aGlzLmRpc2FibGVkQ29sb3IgPSAweDg4ODg4ODtcbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgdGhpcy5ib3JkZXJSYWRpdXMgPSBib3JkZXJSYWRpdXM7XG4gIH1cblxuICBjcmVhdGUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiBQSVhJLkNvbnRhaW5lciB7XG4gICAgdGhpcy5wYW5lbCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5ub3JtYWxDb2xvcixcbiAgICAgIHdpZHRoLFxuICAgICAgaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuXG4gICAgdGhpcy5wYW5lbC5sYXlvdXQod2lkdGgsIGhlaWdodCk7XG4gICAgcmV0dXJuIHRoaXMucGFuZWwuY29udGFpbmVyO1xuICB9XG5cbiAgdXBkYXRlU3RhdGUoc3RhdGU6IEJ1dHRvblN0YXRlKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLnBhbmVsKSByZXR1cm47XG5cbiAgICBsZXQgY29sb3I6IG51bWJlcjtcbiAgICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgICBjYXNlIEJ1dHRvblN0YXRlLk5vcm1hbDpcbiAgICAgICAgY29sb3IgPSB0aGlzLm5vcm1hbENvbG9yO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgQnV0dG9uU3RhdGUuSG92ZXI6XG4gICAgICAgIGNvbG9yID0gdGhpcy5ob3ZlckNvbG9yO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgQnV0dG9uU3RhdGUuUHJlc3NlZDpcbiAgICAgICAgY29sb3IgPSB0aGlzLnByZXNzZWRDb2xvcjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEJ1dHRvblN0YXRlLkRpc2FibGVkOlxuICAgICAgICBjb2xvciA9IHRoaXMuZGlzYWJsZWRDb2xvcjtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgdGhpcy5wYW5lbC5zZXRCYWNrZ3JvdW5kQ29sb3IoY29sb3IpO1xuICB9XG5cbiAgZ2V0QWN0dWFsSGVpZ2h0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuaGVpZ2h0O1xuICB9XG5cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAvLyBVSVBhbmVsIGNsZWFudXAgaGFuZGxlZCBieSBjb250YWluZXJcbiAgfVxuXG4gIHByaXZhdGUgZGFya2VuQ29sb3IoY29sb3I6IG51bWJlciwgZmFjdG9yOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IHIgPSAoKGNvbG9yID4+IDE2KSAmIDB4ZmYpICogZmFjdG9yO1xuICAgIGNvbnN0IGcgPSAoKGNvbG9yID4+IDgpICYgMHhmZikgKiBmYWN0b3I7XG4gICAgY29uc3QgYiA9IChjb2xvciAmIDB4ZmYpICogZmFjdG9yO1xuICAgIHJldHVybiAoKHIgPDwgMTYpIHwgKGcgPDwgOCkgfCBiKSA+Pj4gMDtcbiAgfVxufVxuXG4vKipcbiAqIENvbmZpZ3VyYXRpb24gZm9yIGljb24gb3ZlcmxheXNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJY29uQ29uZmlnIHtcbiAgLyoqIFNwcml0ZXNoZWV0IGNvbnRhaW5pbmcgdGhlIGljb24gdGV4dHVyZSAqL1xuICBzcHJpdGVzaGVldDogUElYSS5TcHJpdGVzaGVldDtcbiAgLyoqIFRleHR1cmUgbmFtZSBpbiB0aGUgc3ByaXRlc2hlZXQgKi9cbiAgdGV4dHVyZU5hbWU6IHN0cmluZztcbiAgLyoqIEljb24gc2NhbGUgKGRlZmF1bHQ6IDEuMCkgKi9cbiAgc2NhbGU/OiBudW1iZXI7XG4gIC8qKiBVc2UgcGl4ZWwtcGVyZmVjdCByZW5kZXJpbmcgKi9cbiAgcGl4ZWxQZXJmZWN0PzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIGZvciBzcHJpdGUtYmFzZWQgYmFja2dyb3VuZHNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnIHtcbiAgLyoqIFNwcml0ZXNoZWV0IGNvbnRhaW5pbmcgdGhlIGJ1dHRvbiB0ZXh0dXJlcyAqL1xuICBzcHJpdGVzaGVldDogUElYSS5TcHJpdGVzaGVldDtcbiAgLyoqIFRleHR1cmUgbmFtZSBwYXR0ZXJuIC0gdXNlIHtjb2xvcn0gcGxhY2Vob2xkZXIuIEV4YW1wbGU6IFwiYmFySG9yaXpvbnRhbF97Y29sb3J9X2xlZnQucG5nXCIgKi9cbiAgdGV4dHVyZVBhdHRlcm46IHN0cmluZztcbiAgLyoqIENvbG9yIHZhcmlhbnQgdG8gdXNlIChlLmcuLCAnYmx1ZScsICdncmVlbicsICdyZWQnKSAqL1xuICBjb2xvcjogc3RyaW5nO1xuICAvKiogVXNlIHBpeGVsLXBlcmZlY3QgcmVuZGVyaW5nIChuZWFyZXN0IG5laWdoYm9yKSAqL1xuICBwaXhlbFBlcmZlY3Q/OiBib29sZWFuO1xuICAvKiogVXNlIDktc2xpY2UgcmVuZGVyaW5nIGluc3RlYWQgb2YgdGhyZWUtcGllY2UgaG9yaXpvbnRhbCAqL1xuICB1c2VOaW5lU2xpY2U/OiBib29sZWFuO1xuICAvKiogOS1zbGljZSBib3JkZXIgd2lkdGhzIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIC0gcmVxdWlyZWQgaWYgdXNlTmluZVNsaWNlIGlzIHRydWUgKi9cbiAgbmluZVNsaWNlQm9yZGVycz86IHsgbGVmdDogbnVtYmVyOyB0b3A6IG51bWJlcjsgcmlnaHQ6IG51bWJlcjsgYm90dG9tOiBudW1iZXIgfTtcbiAgLyoqIFRleHR1cmUgbmFtZSBmb3IgcHJlc3NlZC9kb3duIHN0YXRlIC0gdXNlIHtjb2xvcn0gcGxhY2Vob2xkZXIgaWYgbmVlZGVkICovXG4gIHByZXNzZWRUZXh0dXJlUGF0dGVybj86IHN0cmluZztcbiAgLyoqIEljb24gY29uZmlndXJhdGlvbiBmb3Igb3ZlcmxheSAqL1xuICBpY29uPzogSWNvbkNvbmZpZztcbn1cblxuLyoqXG4gKiBTcHJpdGUtYmFzZWQgYmFja2dyb3VuZCBzdHJhdGVneSB1c2luZyB0aHJlZS1waWVjZSBob3Jpem9udGFsIHRleHR1cmVzIG9yIDktc2xpY2VcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGNsYXNzIFNwcml0ZUJhY2tncm91bmRTdHJhdGVneSBpbXBsZW1lbnRzIEJ1dHRvbkJhY2tncm91bmRTdHJhdGVneSB7XG4gIHByaXZhdGUgY29udGFpbmVyPzogUElYSS5Db250YWluZXI7XG4gIHByaXZhdGUgc3ByaXRlTGVmdD86IFBJWEkuU3ByaXRlO1xuICBwcml2YXRlIHNwcml0ZU1pZD86IFBJWEkuU3ByaXRlO1xuICBwcml2YXRlIHNwcml0ZVJpZ2h0PzogUElYSS5TcHJpdGU7XG4gIHByaXZhdGUgbmluZVNsaWNlU3ByaXRlPzogUElYSS5OaW5lU2xpY2VTcHJpdGU7XG4gIHByaXZhdGUgbmluZVNsaWNlU3ByaXRlUHJlc3NlZD86IFBJWEkuTmluZVNsaWNlU3ByaXRlO1xuICBwcml2YXRlIGljb25TcHJpdGU/OiBQSVhJLlNwcml0ZTtcbiAgcHJpdmF0ZSBjb25maWc6IFNwcml0ZUJhY2tncm91bmRDb25maWc7XG4gIHByaXZhdGUgd2lkdGg6IG51bWJlcjtcbiAgcHJpdmF0ZSBoZWlnaHQ6IG51bWJlcjtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IFNwcml0ZUJhY2tncm91bmRDb25maWcsIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICB9XG5cbiAgY3JlYXRlKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogUElYSS5Db250YWluZXIge1xuICAgIHRoaXMuY29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgY29uc3QgeyBzcHJpdGVzaGVldCwgdGV4dHVyZVBhdHRlcm4sIGNvbG9yLCBwaXhlbFBlcmZlY3QsIHVzZU5pbmVTbGljZSwgbmluZVNsaWNlQm9yZGVycywgcHJlc3NlZFRleHR1cmVQYXR0ZXJuLCBpY29uIH0gPSB0aGlzLmNvbmZpZztcblxuICAgIC8vIFNldCBwaXhlbC1wZXJmZWN0IHJlbmRlcmluZyBpZiByZXF1ZXN0ZWRcbiAgICBpZiAocGl4ZWxQZXJmZWN0ICYmIHNwcml0ZXNoZWV0LnRleHR1cmVTb3VyY2UpIHtcbiAgICAgIHNwcml0ZXNoZWV0LnRleHR1cmVTb3VyY2Uuc2NhbGVNb2RlID0gJ25lYXJlc3QnO1xuICAgIH1cblxuICAgIGlmICh1c2VOaW5lU2xpY2UgJiYgbmluZVNsaWNlQm9yZGVycykge1xuICAgICAgLy8gVXNlIDktc2xpY2Ugc3ByaXRlXG4gICAgICBjb25zdCB0ZXh0dXJlTmFtZSA9IHRleHR1cmVQYXR0ZXJuLmluY2x1ZGVzKCd7Y29sb3J9JylcbiAgICAgICAgPyB0ZXh0dXJlUGF0dGVybi5yZXBsYWNlKCd7Y29sb3J9JywgY29sb3IpXG4gICAgICAgIDogdGV4dHVyZVBhdHRlcm47XG4gICAgICBjb25zdCB0ZXh0dXJlID0gc3ByaXRlc2hlZXQudGV4dHVyZXNbdGV4dHVyZU5hbWVdO1xuXG4gICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZSA9IG5ldyBQSVhJLk5pbmVTbGljZVNwcml0ZSh7XG4gICAgICAgIHRleHR1cmUsXG4gICAgICAgIGxlZnRXaWR0aDogbmluZVNsaWNlQm9yZGVycy5sZWZ0LFxuICAgICAgICB0b3BIZWlnaHQ6IG5pbmVTbGljZUJvcmRlcnMudG9wLFxuICAgICAgICByaWdodFdpZHRoOiBuaW5lU2xpY2VCb3JkZXJzLnJpZ2h0LFxuICAgICAgICBib3R0b21IZWlnaHQ6IG5pbmVTbGljZUJvcmRlcnMuYm90dG9tLFxuICAgICAgICB3aWR0aCxcbiAgICAgICAgaGVpZ2h0XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5uaW5lU2xpY2VTcHJpdGUpO1xuXG4gICAgICAvLyBDcmVhdGUgcHJlc3NlZCBzdGF0ZSBzcHJpdGUgaWYgcHJvdmlkZWRcbiAgICAgIGlmIChwcmVzc2VkVGV4dHVyZVBhdHRlcm4pIHtcbiAgICAgICAgY29uc3QgcHJlc3NlZFRleHR1cmVOYW1lID0gcHJlc3NlZFRleHR1cmVQYXR0ZXJuLmluY2x1ZGVzKCd7Y29sb3J9JylcbiAgICAgICAgICA/IHByZXNzZWRUZXh0dXJlUGF0dGVybi5yZXBsYWNlKCd7Y29sb3J9JywgY29sb3IpXG4gICAgICAgICAgOiBwcmVzc2VkVGV4dHVyZVBhdHRlcm47XG4gICAgICAgIGNvbnN0IHByZXNzZWRUZXh0dXJlID0gc3ByaXRlc2hlZXQudGV4dHVyZXNbcHJlc3NlZFRleHR1cmVOYW1lXTtcblxuICAgICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZVByZXNzZWQgPSBuZXcgUElYSS5OaW5lU2xpY2VTcHJpdGUoe1xuICAgICAgICAgIHRleHR1cmU6IHByZXNzZWRUZXh0dXJlLFxuICAgICAgICAgIGxlZnRXaWR0aDogbmluZVNsaWNlQm9yZGVycy5sZWZ0LFxuICAgICAgICAgIHRvcEhlaWdodDogbmluZVNsaWNlQm9yZGVycy50b3AsXG4gICAgICAgICAgcmlnaHRXaWR0aDogbmluZVNsaWNlQm9yZGVycy5yaWdodCxcbiAgICAgICAgICBib3R0b21IZWlnaHQ6IG5pbmVTbGljZUJvcmRlcnMuYm90dG9tLFxuICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgIGhlaWdodFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBPZmZzZXQgcHJlc3NlZCBzdGF0ZSBkb3duIGJ5IDQgcGl4ZWxzIHRvIG1hdGNoIHRoZSBiZXZlbCBoZWlnaHRcbiAgICAgICAgdGhpcy5uaW5lU2xpY2VTcHJpdGVQcmVzc2VkLnkgPSA0O1xuICAgICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZVByZXNzZWQudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLm5pbmVTbGljZVNwcml0ZVByZXNzZWQpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBVc2UgdGhyZWUtcGllY2UgaG9yaXpvbnRhbCBzcHJpdGVzXG4gICAgICBjb25zdCBsZWZ0VGV4dHVyZU5hbWUgPSB0aGlzLmdldFRleHR1cmVOYW1lKHRleHR1cmVQYXR0ZXJuLCBjb2xvciwgJ2xlZnQnKTtcbiAgICAgIGNvbnN0IG1pZFRleHR1cmVOYW1lID0gdGhpcy5nZXRUZXh0dXJlTmFtZSh0ZXh0dXJlUGF0dGVybiwgY29sb3IsICdtaWQnKTtcbiAgICAgIGNvbnN0IHJpZ2h0VGV4dHVyZU5hbWUgPSB0aGlzLmdldFRleHR1cmVOYW1lKHRleHR1cmVQYXR0ZXJuLCBjb2xvciwgJ3JpZ2h0Jyk7XG5cbiAgICAgIHRoaXMuc3ByaXRlTGVmdCA9IG5ldyBQSVhJLlNwcml0ZShzcHJpdGVzaGVldC50ZXh0dXJlc1tsZWZ0VGV4dHVyZU5hbWVdKTtcbiAgICAgIHRoaXMuc3ByaXRlTWlkID0gbmV3IFBJWEkuU3ByaXRlKHNwcml0ZXNoZWV0LnRleHR1cmVzW21pZFRleHR1cmVOYW1lXSk7XG4gICAgICB0aGlzLnNwcml0ZVJpZ2h0ID0gbmV3IFBJWEkuU3ByaXRlKHNwcml0ZXNoZWV0LnRleHR1cmVzW3JpZ2h0VGV4dHVyZU5hbWVdKTtcblxuICAgICAgLy8gU2NhbGUgdG8gbWF0Y2ggYnV0dG9uIGhlaWdodFxuICAgICAgY29uc3Qgc2NhbGVZID0gaGVpZ2h0IC8gdGhpcy5zcHJpdGVMZWZ0LmhlaWdodDtcbiAgICAgIHRoaXMuc3ByaXRlTGVmdC5zY2FsZS55ID0gc2NhbGVZO1xuICAgICAgdGhpcy5zcHJpdGVNaWQuc2NhbGUueSA9IHNjYWxlWTtcbiAgICAgIHRoaXMuc3ByaXRlUmlnaHQuc2NhbGUueSA9IHNjYWxlWTtcblxuICAgICAgLy8gUG9zaXRpb24gc3ByaXRlcyBob3Jpem9udGFsbHlcbiAgICAgIHRoaXMuc3ByaXRlTGVmdC54ID0gMDtcblxuICAgICAgY29uc3QgbWlkZGxlV2lkdGggPSB3aWR0aCAtIHRoaXMuc3ByaXRlTGVmdC53aWR0aCAtIHRoaXMuc3ByaXRlUmlnaHQud2lkdGg7XG4gICAgICB0aGlzLnNwcml0ZU1pZC53aWR0aCA9IG1pZGRsZVdpZHRoO1xuICAgICAgdGhpcy5zcHJpdGVNaWQueCA9IHRoaXMuc3ByaXRlTGVmdC53aWR0aDtcblxuICAgICAgdGhpcy5zcHJpdGVSaWdodC54ID0gdGhpcy5zcHJpdGVMZWZ0LndpZHRoICsgbWlkZGxlV2lkdGg7XG5cbiAgICAgIC8vIEFkZCB0byBjb250YWluZXJcbiAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuc3ByaXRlTGVmdCk7XG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnNwcml0ZU1pZCk7XG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnNwcml0ZVJpZ2h0KTtcbiAgICB9XG5cbiAgICAvLyBBZGQgaWNvbiBpZiBwcm92aWRlZFxuICAgIGlmIChpY29uKSB7XG4gICAgICBjb25zdCBpY29uVGV4dHVyZSA9IGljb24uc3ByaXRlc2hlZXQudGV4dHVyZXNbaWNvbi50ZXh0dXJlTmFtZV07XG4gICAgICB0aGlzLmljb25TcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoaWNvblRleHR1cmUpO1xuXG4gICAgICBpZiAoaWNvbi5waXhlbFBlcmZlY3QgJiYgaWNvbi5zcHJpdGVzaGVldC50ZXh0dXJlU291cmNlKSB7XG4gICAgICAgIGljb24uc3ByaXRlc2hlZXQudGV4dHVyZVNvdXJjZS5zY2FsZU1vZGUgPSAnbmVhcmVzdCc7XG4gICAgICB9XG5cbiAgICAgIGlmIChpY29uLnNjYWxlKSB7XG4gICAgICAgIHRoaXMuaWNvblNwcml0ZS5zY2FsZS5zZXQoaWNvbi5zY2FsZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENlbnRlciB0aGUgaWNvblxuICAgICAgdGhpcy5pY29uU3ByaXRlLmFuY2hvci5zZXQoMC41KTtcbiAgICAgIHRoaXMuaWNvblNwcml0ZS54ID0gd2lkdGggLyAyO1xuICAgICAgdGhpcy5pY29uU3ByaXRlLnkgPSBoZWlnaHQgLyAyO1xuXG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmljb25TcHJpdGUpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmNvbnRhaW5lcjtcbiAgfVxuXG4gIHVwZGF0ZVN0YXRlKHN0YXRlOiBCdXR0b25TdGF0ZSk6IHZvaWQge1xuICAgIC8vIEhhbmRsZSB1cC9kb3duIHN0YXRlIHN3aXRjaGluZyBmb3IgOS1zbGljZSBzcHJpdGVzXG4gICAgaWYgKHRoaXMubmluZVNsaWNlU3ByaXRlICYmIHRoaXMubmluZVNsaWNlU3ByaXRlUHJlc3NlZCkge1xuICAgICAgY29uc3QgaXNQcmVzc2VkID0gc3RhdGUgPT09IEJ1dHRvblN0YXRlLlByZXNzZWQ7XG4gICAgICB0aGlzLm5pbmVTbGljZVNwcml0ZS52aXNpYmxlID0gIWlzUHJlc3NlZDtcbiAgICAgIHRoaXMubmluZVNsaWNlU3ByaXRlUHJlc3NlZC52aXNpYmxlID0gaXNQcmVzc2VkO1xuXG4gICAgICAvLyBPZmZzZXQgaWNvbiB3aGVuIHByZXNzZWRcbiAgICAgIGlmICh0aGlzLmljb25TcHJpdGUpIHtcbiAgICAgICAgdGhpcy5pY29uU3ByaXRlLnkgPSAodGhpcy5oZWlnaHQgLyAyKSArIChpc1ByZXNzZWQgPyA0IDogMCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFVzZSB0aW50aW5nIGZvciBzdGF0ZXMgd2hlbiBubyBwcmVzc2VkIHRleHR1cmUgaXMgYXZhaWxhYmxlXG4gICAgICBsZXQgdGludDogbnVtYmVyO1xuICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICBjYXNlIEJ1dHRvblN0YXRlLk5vcm1hbDpcbiAgICAgICAgICB0aW50ID0gMHhmZmZmZmY7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQnV0dG9uU3RhdGUuSG92ZXI6XG4gICAgICAgICAgdGludCA9IDB4Y2NjY2NjO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEJ1dHRvblN0YXRlLlByZXNzZWQ6XG4gICAgICAgICAgdGludCA9IDB4OTk5OTk5O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEJ1dHRvblN0YXRlLkRpc2FibGVkOlxuICAgICAgICAgIHRpbnQgPSAweDg4ODg4ODtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMubmluZVNsaWNlU3ByaXRlKSB7XG4gICAgICAgIHRoaXMubmluZVNsaWNlU3ByaXRlLnRpbnQgPSB0aW50O1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnNwcml0ZUxlZnQgJiYgdGhpcy5zcHJpdGVNaWQgJiYgdGhpcy5zcHJpdGVSaWdodCkge1xuICAgICAgICB0aGlzLnNwcml0ZUxlZnQudGludCA9IHRpbnQ7XG4gICAgICAgIHRoaXMuc3ByaXRlTWlkLnRpbnQgPSB0aW50O1xuICAgICAgICB0aGlzLnNwcml0ZVJpZ2h0LnRpbnQgPSB0aW50O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldEFjdHVhbEhlaWdodCgpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLm5pbmVTbGljZVNwcml0ZSkge1xuICAgICAgcmV0dXJuIHRoaXMubmluZVNsaWNlU3ByaXRlLmhlaWdodDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuc3ByaXRlTGVmdD8uaGVpZ2h0ID8/IHRoaXMuaGVpZ2h0O1xuICB9XG5cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lcj8uZGVzdHJveSh7IGNoaWxkcmVuOiB0cnVlIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRUZXh0dXJlTmFtZShwYXR0ZXJuOiBzdHJpbmcsIGNvbG9yOiBzdHJpbmcsIHBhcnQ6ICdsZWZ0JyB8ICdtaWQnIHwgJ3JpZ2h0Jyk6IHN0cmluZyB7XG4gICAgLy8gUmVwbGFjZSB7Y29sb3J9IHBsYWNlaG9sZGVyIGFuZCBlbnN1cmUgY29ycmVjdCBwYXJ0XG4gICAgbGV0IG5hbWUgPSBwYXR0ZXJuLnJlcGxhY2UoJ3tjb2xvcn0nLCBjb2xvcik7XG5cbiAgICAvLyBSZXBsYWNlIGFueSBleGlzdGluZyBwYXJ0IHN1ZmZpeCB3aXRoIHRoZSBkZXNpcmVkIG9uZVxuICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoL18oPzpsZWZ0fG1pZHxyaWdodClcXC5wbmckLywgYF8ke3BhcnR9LnBuZ2ApO1xuXG4gICAgcmV0dXJuIG5hbWU7XG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJQm94XG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlCb3hQcm9wcyB7XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yIChoZXggbnVtYmVyLCBlLmcuLCAweGZmMDAwMCBmb3IgcmVkKSAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBCYWNrZ3JvdW5kIGFscGhhL29wYWNpdHkgKDAtMSkgKi9cbiAgYmFja2dyb3VuZEFscGhhPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIGNvbG9yICovXG4gIGJvcmRlckNvbG9yPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHdpZHRoIGluIHBpeGVscyAqL1xuICBib3JkZXJXaWR0aD86IG51bWJlcjtcbiAgLyoqIEJvcmRlciByYWRpdXMgZm9yIHJvdW5kZWQgY29ybmVycyAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG4gIC8qKiBGaXhlZCB3aWR0aCAqL1xuICB3aWR0aD86IG51bWJlcjtcbiAgLyoqIEZpeGVkIGhlaWdodCAqL1xuICBoZWlnaHQ/OiBudW1iZXI7XG59XG5cbi8qKlxuICogQSBzaW1wbGUgcmVjdGFuZ3VsYXIgYm94IGNvbXBvbmVudCB3aXRoIG9wdGlvbmFsIGJhY2tncm91bmQgYW5kIGJvcmRlclxuICogRm91bmRhdGlvbiBmb3IgcGFuZWxzLCBidXR0b25zLCBhbmQgb3RoZXIgdmlzdWFsIFVJIGVsZW1lbnRzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGJveCA9IG5ldyBVSUJveCh7XG4gKiAgIGJhY2tncm91bmRDb2xvcjogMHg0YTkwZTIsXG4gKiAgIHdpZHRoOiAyMDAsXG4gKiAgIGhlaWdodDogMTAwLFxuICogICBib3JkZXJSYWRpdXM6IDhcbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSUJveCBleHRlbmRzIFVJQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBwcm9wczogVUlCb3hQcm9wcztcbiAgcHJpdmF0ZSBncmFwaGljczogUElYSS5HcmFwaGljcztcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVUlCb3hQcm9wcyA9IHt9LCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IDB4MDAwMDAwLFxuICAgICAgYmFja2dyb3VuZEFscGhhOiAxLFxuICAgICAgYm9yZGVyV2lkdGg6IDAsXG4gICAgICBib3JkZXJSYWRpdXM6IDAsXG4gICAgICAuLi5wcm9wc1xuICAgIH07XG5cbiAgICAvLyBDcmVhdGUgZ3JhcGhpY3Mgb2JqZWN0IGZvciByZW5kZXJpbmdcbiAgICB0aGlzLmdyYXBoaWNzID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmdyYXBoaWNzKTtcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9ucyBpZiBwcm92aWRlZFxuICAgIGlmIChwcm9wcy53aWR0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmJveE1vZGVsLndpZHRoID0gcHJvcHMud2lkdGg7XG4gICAgfVxuICAgIGlmIChwcm9wcy5oZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPSBwcm9wcy5oZWlnaHQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmVzIHRoZSBzaXplIG5lZWRlZCBmb3IgdGhpcyBib3hcbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuICAgIGNvbnN0IGJvcmRlciA9IHRoaXMuYm94TW9kZWwuYm9yZGVyO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGNvbnRlbnQgc2l6ZVxuICAgIGxldCBjb250ZW50V2lkdGggPSAwO1xuICAgIGxldCBjb250ZW50SGVpZ2h0ID0gMDtcblxuICAgIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnRlbnRXaWR0aCA9IHRoaXMuYm94TW9kZWwud2lkdGg7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLndpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnRlbnRXaWR0aCA9IHRoaXMucHJvcHMud2lkdGg7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnRlbnRIZWlnaHQgPSB0aGlzLmJveE1vZGVsLmhlaWdodDtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuaGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnRlbnRIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcbiAgICB9XG5cbiAgICAvLyBBZGQgcGFkZGluZyBhbmQgYm9yZGVyXG4gICAgY29uc3QgdG90YWxXaWR0aCA9IGNvbnRlbnRXaWR0aCArIHBhZGRpbmcuaG9yaXpvbnRhbCArIChib3JkZXI/Lmhvcml6b250YWwgPz8gMCk7XG4gICAgY29uc3QgdG90YWxIZWlnaHQgPSBjb250ZW50SGVpZ2h0ICsgcGFkZGluZy52ZXJ0aWNhbCArIChib3JkZXI/LnZlcnRpY2FsID8/IDApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiBNYXRoLm1heCh0b3RhbFdpZHRoLCB0aGlzLmJveE1vZGVsLm1pbldpZHRoID8/IDApLFxuICAgICAgaGVpZ2h0OiBNYXRoLm1heCh0b3RhbEhlaWdodCwgdGhpcy5ib3hNb2RlbC5taW5IZWlnaHQgPz8gMClcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGxheW91dCBmb3IgdGhpcyBib3hcbiAgICovXG4gIGxheW91dChhdmFpbGFibGVXaWR0aDogbnVtYmVyLCBhdmFpbGFibGVIZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICBjb25zdCBib3JkZXIgPSB0aGlzLmJveE1vZGVsLmJvcmRlciA/PyB7IGhvcml6b250YWw6IDAsIHZlcnRpY2FsOiAwLCB0b3A6IDAsIHJpZ2h0OiAwLCBib3R0b206IDAsIGxlZnQ6IDAgfTtcblxuICAgIC8vIENhbGN1bGF0ZSBmaW5hbCBkaW1lbnNpb25zXG4gICAgbGV0IGZpbmFsV2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICBsZXQgZmluYWxIZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG5cbiAgICAvLyBIYW5kbGUgJ2ZpbGwnIGNvbnN0cmFpbnRcbiAgICBpZiAodGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ2ZpbGwnKSB7XG4gICAgICBmaW5hbFdpZHRoID0gYXZhaWxhYmxlV2lkdGg7XG4gICAgfVxuICAgIGlmICh0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ2ZpbGwnKSB7XG4gICAgICBmaW5hbEhlaWdodCA9IGF2YWlsYWJsZUhlaWdodDtcbiAgICB9XG5cbiAgICAvLyBBcHBseSBtYXggY29uc3RyYWludHNcbiAgICBpZiAodGhpcy5ib3hNb2RlbC5tYXhXaWR0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBmaW5hbFdpZHRoID0gTWF0aC5taW4oZmluYWxXaWR0aCwgdGhpcy5ib3hNb2RlbC5tYXhXaWR0aCk7XG4gICAgfVxuICAgIGlmICh0aGlzLmJveE1vZGVsLm1heEhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBmaW5hbEhlaWdodCA9IE1hdGgubWluKGZpbmFsSGVpZ2h0LCB0aGlzLmJveE1vZGVsLm1heEhlaWdodCk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGNvbXB1dGVkIGxheW91dFxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBmaW5hbFdpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gZmluYWxIZWlnaHQ7XG5cbiAgICAvLyBDb250ZW50IGFyZWEgKGluc2lkZSBwYWRkaW5nIGFuZCBib3JkZXIpXG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50WCA9IHBhZGRpbmcubGVmdCArIGJvcmRlci5sZWZ0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFkgPSBwYWRkaW5nLnRvcCArIGJvcmRlci50b3A7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50V2lkdGggPSBmaW5hbFdpZHRoIC0gcGFkZGluZy5ob3Jpem9udGFsIC0gYm9yZGVyLmhvcml6b250YWw7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50SGVpZ2h0ID0gZmluYWxIZWlnaHQgLSBwYWRkaW5nLnZlcnRpY2FsIC0gYm9yZGVyLnZlcnRpY2FsO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgYm94IHZpc3VhbHNcbiAgICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgdGhpcy5ncmFwaGljcy5jbGVhcigpO1xuXG4gICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSB0aGlzLmNvbXB1dGVkTGF5b3V0O1xuICAgIGNvbnN0IHsgYmFja2dyb3VuZENvbG9yLCBiYWNrZ3JvdW5kQWxwaGEsIGJvcmRlckNvbG9yLCBib3JkZXJXaWR0aCwgYm9yZGVyUmFkaXVzIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgLy8gRHJhdyBib3JkZXIgaWYgc3BlY2lmaWVkXG4gICAgaWYgKGJvcmRlcldpZHRoICYmIGJvcmRlcldpZHRoID4gMCAmJiBib3JkZXJDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmdyYXBoaWNzLnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSh7IGNvbG9yOiBib3JkZXJDb2xvciwgd2lkdGg6IGJvcmRlcldpZHRoIH0pO1xuICAgIH1cblxuICAgIC8vIERyYXcgYmFja2dyb3VuZFxuICAgIGlmIChiYWNrZ3JvdW5kQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKGJvcmRlclJhZGl1cyAmJiBib3JkZXJSYWRpdXMgPiAwKSB7XG4gICAgICAgIHRoaXMuZ3JhcGhpY3Mucm91bmRSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQsIGJvcmRlclJhZGl1cyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmdyYXBoaWNzLnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICB9XG4gICAgICB0aGlzLmdyYXBoaWNzLmZpbGwoeyBjb2xvcjogYmFja2dyb3VuZENvbG9yLCBhbHBoYTogYmFja2dyb3VuZEFscGhhIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBiYWNrZ3JvdW5kIGNvbG9yXG4gICAqL1xuICBzZXRCYWNrZ3JvdW5kQ29sb3IoY29sb3I6IG51bWJlciwgYWxwaGE6IG51bWJlciA9IDEpOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xuICAgIHRoaXMucHJvcHMuYmFja2dyb3VuZEFscGhhID0gYWxwaGE7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBib3JkZXJcbiAgICovXG4gIHNldEJvcmRlcihjb2xvcjogbnVtYmVyLCB3aWR0aDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy5ib3JkZXJDb2xvciA9IGNvbG9yO1xuICAgIHRoaXMucHJvcHMuYm9yZGVyV2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcbmltcG9ydCB7IFVJTGFiZWwgfSBmcm9tICcuL3VpLWxhYmVsJztcbmltcG9ydCB7IEVkZ2VJbnNldHMgfSBmcm9tICcuLi9jb3JlL2VkZ2UtaW5zZXRzJztcbmltcG9ydCB7IFVJRm9jdXNNYW5hZ2VyIH0gZnJvbSAnLi4vY29yZS91aS1mb2N1cy1tYW5hZ2VyJztcbmltcG9ydCB7XG4gIEJ1dHRvbkJhY2tncm91bmRTdHJhdGVneSxcbiAgU29saWRDb2xvckJhY2tncm91bmRTdHJhdGVneSxcbiAgU3ByaXRlQmFja2dyb3VuZFN0cmF0ZWd5LFxuICBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnXG59IGZyb20gJy4vYnV0dG9uLWJhY2tncm91bmQtc3RyYXRlZ3knO1xuXG4vKipcbiAqIEJ1dHRvbiB2aXN1YWwgc3RhdGVzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBlbnVtIEJ1dHRvblN0YXRlIHtcbiAgTm9ybWFsID0gJ25vcm1hbCcsXG4gIEhvdmVyID0gJ2hvdmVyJyxcbiAgUHJlc3NlZCA9ICdwcmVzc2VkJyxcbiAgRGlzYWJsZWQgPSAnZGlzYWJsZWQnXG59XG5cbi8vIFJlLWV4cG9ydCBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnIGZvciBjb252ZW5pZW5jZVxuZXhwb3J0IHR5cGUgeyBTcHJpdGVCYWNrZ3JvdW5kQ29uZmlnIH0gZnJvbSAnLi9idXR0b24tYmFja2dyb3VuZC1zdHJhdGVneSc7XG5cbi8qKlxuICogUHJvcHMgZm9yIGNvbmZpZ3VyaW5nIGEgVUlCdXR0b25cbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSUJ1dHRvblByb3BzIHtcbiAgLyoqIEJ1dHRvbiBsYWJlbCB0ZXh0ICovXG4gIGxhYmVsPzogc3RyaW5nO1xuICAvKiogQnV0dG9uIHdpZHRoICovXG4gIHdpZHRoPzogbnVtYmVyO1xuICAvKiogQnV0dG9uIGhlaWdodCAqL1xuICBoZWlnaHQ/OiBudW1iZXI7XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yIChvbmx5IHVzZWQgaWYgc3ByaXRlQmFja2dyb3VuZCBpcyBub3QgcHJvdmlkZWQpICovXG4gIGJhY2tncm91bmRDb2xvcj86IG51bWJlcjtcbiAgLyoqIFNwcml0ZS1iYXNlZCBiYWNrZ3JvdW5kIGNvbmZpZ3VyYXRpb24gKi9cbiAgc3ByaXRlQmFja2dyb3VuZD86IFNwcml0ZUJhY2tncm91bmRDb25maWc7XG4gIC8qKiBUZXh0IGNvbG9yICovXG4gIHRleHRDb2xvcj86IG51bWJlcjtcbiAgLyoqIEZvbnQgc2l6ZSAqL1xuICBmb250U2l6ZT86IG51bWJlcjtcbiAgLyoqIEJvcmRlciByYWRpdXMgKG9ubHkgdXNlZCB3aXRoIGJhY2tncm91bmRDb2xvcikgKi9cbiAgYm9yZGVyUmFkaXVzPzogbnVtYmVyO1xuICAvKiogUGFkZGluZyBpbnNpZGUgYnV0dG9uICovXG4gIHBhZGRpbmc/OiBFZGdlSW5zZXRzO1xuICAvKiogVXNlIEJpdG1hcFRleHQgaW5zdGVhZCBvZiByZWd1bGFyIHRleHQgKi9cbiAgdXNlQml0bWFwVGV4dD86IGJvb2xlYW47XG4gIC8qKiBCaXRtYXBUZXh0IGZvbnQgZmFtaWx5IChyZXF1aXJlZCBpZiB1c2VCaXRtYXBUZXh0IGlzIHRydWUpICovXG4gIGJpdG1hcEZvbnRGYW1pbHk/OiBzdHJpbmc7XG4gIC8qKiBDbGljayBjYWxsYmFjayAqL1xuICBvbkNsaWNrPzogKCkgPT4gdm9pZDtcbiAgLyoqIEhvdmVyIGNhbGxiYWNrICovXG4gIG9uSG92ZXI/OiAoKSA9PiB2b2lkO1xuICAvKiogRW5hYmxlZCBzdGF0ZSAqL1xuICBlbmFibGVkPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBBbiBpbnRlcmFjdGl2ZSBidXR0b24gY29tcG9uZW50XG4gKiBTdXBwb3J0cyBob3ZlciwgcHJlc3MsIGFuZCBkaXNhYmxlZCBzdGF0ZXNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgYnV0dG9uID0gbmV3IFVJQnV0dG9uKHtcbiAqICAgbGFiZWw6ICdDbGljayBNZScsXG4gKiAgIHdpZHRoOiAxNTAsXG4gKiAgIGhlaWdodDogNDAsXG4gKiAgIGJhY2tncm91bmRDb2xvcjogMHg0YTkwZTIsXG4gKiAgIHRleHRDb2xvcjogMHhmZmZmZmYsXG4gKiAgIG9uQ2xpY2s6ICgpID0+IGNvbnNvbGUubG9nKCdCdXR0b24gY2xpY2tlZCEnKVxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJQnV0dG9uIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxPbWl0PFVJQnV0dG9uUHJvcHMsICdvbkNsaWNrJyB8ICdvbkhvdmVyJyB8ICdzcHJpdGVCYWNrZ3JvdW5kJyB8ICd1c2VCaXRtYXBUZXh0JyB8ICdiaXRtYXBGb250RmFtaWx5Jz4+O1xuICBwcml2YXRlIHVzZUJpdG1hcFRleHQ6IGJvb2xlYW47XG4gIHByaXZhdGUgYml0bWFwRm9udEZhbWlseT86IHN0cmluZztcbiAgcHJpdmF0ZSBvbkNsaWNrPzogKCkgPT4gdm9pZDtcbiAgcHJpdmF0ZSBvbkhvdmVyPzogKCkgPT4gdm9pZDtcblxuICBwcml2YXRlIHN0YXRlOiBCdXR0b25TdGF0ZSA9IEJ1dHRvblN0YXRlLk5vcm1hbDtcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kU3RyYXRlZ3k6IEJ1dHRvbkJhY2tncm91bmRTdHJhdGVneTtcbiAgcHJpdmF0ZSBsYWJlbD86IFVJTGFiZWw7XG4gIHByaXZhdGUgYml0bWFwTGFiZWw/OiBQSVhJLkJpdG1hcFRleHQ7XG5cbiAgLy8gQ2FjaGVkIGxhYmVsIGNlbnRlciBwb3NpdGlvblxuICBwcml2YXRlIGxhYmVsQ2VudGVyWDogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBsYWJlbENlbnRlclk6IG51bWJlciA9IDA7XG5cbiAgLy8gS2V5Ym9hcmQgaGFuZGxlciBmb3IgY2xlYW51cFxuICBwcml2YXRlIGtleWRvd25IYW5kbGVyPzogKGU6IEtleWJvYXJkRXZlbnQpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJQnV0dG9uUHJvcHMgPSB7fSwgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBsYWJlbDogcHJvcHMubGFiZWwgPz8gJycsXG4gICAgICB3aWR0aDogcHJvcHMud2lkdGggPz8gMTIwLFxuICAgICAgaGVpZ2h0OiBwcm9wcy5oZWlnaHQgPz8gNDAsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHByb3BzLmJhY2tncm91bmRDb2xvciA/PyAweDRhOTBlMixcbiAgICAgIHRleHRDb2xvcjogcHJvcHMudGV4dENvbG9yID8/IDB4ZmZmZmZmLFxuICAgICAgZm9udFNpemU6IHByb3BzLmZvbnRTaXplID8/IDE2LFxuICAgICAgYm9yZGVyUmFkaXVzOiBwcm9wcy5ib3JkZXJSYWRpdXMgPz8gNCxcbiAgICAgIHBhZGRpbmc6IHByb3BzLnBhZGRpbmcgPz8gRWRnZUluc2V0cy5zeW1tZXRyaWMoOCwgMTYpLFxuICAgICAgZW5hYmxlZDogcHJvcHMuZW5hYmxlZCA/PyB0cnVlXG4gICAgfTtcblxuICAgIHRoaXMudXNlQml0bWFwVGV4dCA9IHByb3BzLnVzZUJpdG1hcFRleHQgPz8gZmFsc2U7XG4gICAgdGhpcy5iaXRtYXBGb250RmFtaWx5ID0gcHJvcHMuYml0bWFwRm9udEZhbWlseTtcbiAgICB0aGlzLm9uQ2xpY2sgPSBwcm9wcy5vbkNsaWNrO1xuICAgIHRoaXMub25Ib3ZlciA9IHByb3BzLm9uSG92ZXI7XG5cbiAgICAvLyBTZXQgYm94IG1vZGVsIGRpbWVuc2lvbnNcbiAgICB0aGlzLmJveE1vZGVsLndpZHRoID0gdGhpcy5wcm9wcy53aWR0aDtcbiAgICB0aGlzLmJveE1vZGVsLmhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuXG4gICAgLy8gTWFrZSBidXR0b25zIGZvY3VzYWJsZSBieSBkZWZhdWx0XG4gICAgdGhpcy50YWJJbmRleCA9IDA7XG5cbiAgICAvLyBDcmVhdGUgYmFja2dyb3VuZCBzdHJhdGVneSBiYXNlZCBvbiBjb25maWd1cmF0aW9uXG4gICAgaWYgKHByb3BzLnNwcml0ZUJhY2tncm91bmQpIHtcbiAgICAgIHRoaXMuYmFja2dyb3VuZFN0cmF0ZWd5ID0gbmV3IFNwcml0ZUJhY2tncm91bmRTdHJhdGVneShcbiAgICAgICAgcHJvcHMuc3ByaXRlQmFja2dyb3VuZCxcbiAgICAgICAgdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgICAgdGhpcy5wcm9wcy5oZWlnaHRcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYmFja2dyb3VuZFN0cmF0ZWd5ID0gbmV3IFNvbGlkQ29sb3JCYWNrZ3JvdW5kU3RyYXRlZ3koXG4gICAgICAgIHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgICB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgICB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgICAgdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGFuZCBhZGQgYmFja2dyb3VuZFxuICAgIGNvbnN0IGJhY2tncm91bmRDb250YWluZXIgPSB0aGlzLmJhY2tncm91bmRTdHJhdGVneS5jcmVhdGUodGhpcy5wcm9wcy53aWR0aCwgdGhpcy5wcm9wcy5oZWlnaHQpO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKGJhY2tncm91bmRDb250YWluZXIpO1xuXG4gICAgLy8gQ3JlYXRlIGxhYmVsIGlmIHRleHQgcHJvdmlkZWRcbiAgICBpZiAodGhpcy5wcm9wcy5sYWJlbCkge1xuICAgICAgaWYgKHRoaXMudXNlQml0bWFwVGV4dCAmJiB0aGlzLmJpdG1hcEZvbnRGYW1pbHkpIHtcbiAgICAgICAgdGhpcy5jcmVhdGVCaXRtYXBMYWJlbCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5sYWJlbCA9IG5ldyBVSUxhYmVsKHtcbiAgICAgICAgICB0ZXh0OiB0aGlzLnByb3BzLmxhYmVsLFxuICAgICAgICAgIGZvbnRTaXplOiB0aGlzLnByb3BzLmZvbnRTaXplLFxuICAgICAgICAgIGNvbG9yOiB0aGlzLnByb3BzLnRleHRDb2xvcixcbiAgICAgICAgICBhbGlnbjogJ2NlbnRlcidcbiAgICAgICAgfSwge1xuICAgICAgICAgIHBhZGRpbmc6IEVkZ2VJbnNldHMuemVybygpXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmxhYmVsLmNvbnRhaW5lcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2V0dXAgaW50ZXJhY3Rpdml0eVxuICAgIHRoaXMuc2V0dXBJbnRlcmFjdGl2aXR5KCk7XG5cbiAgICAvLyBJbml0aWFsIHN0YXRlXG4gICAgaWYgKCF0aGlzLnByb3BzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuRGlzYWJsZWQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgQml0bWFwVGV4dCBsYWJlbFxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVCaXRtYXBMYWJlbCgpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYml0bWFwRm9udEZhbWlseSkgcmV0dXJuO1xuXG4gICAgdGhpcy5iaXRtYXBMYWJlbCA9IG5ldyBQSVhJLkJpdG1hcFRleHQoe1xuICAgICAgdGV4dDogdGhpcy5wcm9wcy5sYWJlbCxcbiAgICAgIHN0eWxlOiB7XG4gICAgICAgIGZvbnRGYW1pbHk6IHRoaXMuYml0bWFwRm9udEZhbWlseSxcbiAgICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMuZm9udFNpemUsXG4gICAgICAgIGZpbGw6IHRoaXMucHJvcHMudGV4dENvbG9yXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmJpdG1hcExhYmVsKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHVwIG1vdXNlL3RvdWNoIGV2ZW50IGhhbmRsZXJzXG4gICAqL1xuICBwcml2YXRlIHNldHVwSW50ZXJhY3Rpdml0eSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICB0aGlzLmNvbnRhaW5lci5jdXJzb3IgPSAncG9pbnRlcic7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5vbigncG9pbnRlcm92ZXInLCB0aGlzLmhhbmRsZVBvaW50ZXJPdmVyLmJpbmQodGhpcykpO1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVyb3V0JywgdGhpcy5oYW5kbGVQb2ludGVyT3V0LmJpbmQodGhpcykpO1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVyZG93bicsIHRoaXMuaGFuZGxlUG9pbnRlckRvd24uYmluZCh0aGlzKSk7XG4gICAgdGhpcy5jb250YWluZXIub24oJ3BvaW50ZXJ1cCcsIHRoaXMuaGFuZGxlUG9pbnRlclVwLmJpbmQodGhpcykpO1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVydXBvdXRzaWRlJywgdGhpcy5oYW5kbGVQb2ludGVyVXBPdXRzaWRlLmJpbmQodGhpcykpO1xuXG4gICAgLy8gSGFuZGxlIGtleWJvYXJkIGludGVyYWN0aW9uIHdoZW4gZm9jdXNlZFxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5rZXlkb3duSGFuZGxlciA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmlzRm9jdXNlZCgpICYmIHRoaXMucHJvcHMuZW5hYmxlZCkge1xuICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyB8fCBlLmtleSA9PT0gJyAnKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIC8vIFNob3cgcHJlc3NlZCBzdGF0ZVxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShCdXR0b25TdGF0ZS5QcmVzc2VkKTtcblxuICAgICAgICAgICAgLy8gVHJpZ2dlciBjbGlja1xuICAgICAgICAgICAgdGhpcy5vbkNsaWNrPy4oKTtcblxuICAgICAgICAgICAgLy8gUmV0dXJuIHRvIGhvdmVyIHN0YXRlIGFmdGVyIGEgc2hvcnQgZGVsYXkgKHNpbXVsYXRpbmcgYnV0dG9uIHJlbGVhc2UpXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuZW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuTm9ybWFsKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5ZG93bkhhbmRsZXIpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUG9pbnRlck92ZXIoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZW5hYmxlZCAmJiB0aGlzLnN0YXRlID09PSBCdXR0b25TdGF0ZS5Ob3JtYWwpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuSG92ZXIpO1xuICAgICAgdGhpcy5vbkhvdmVyPy4oKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJPdXQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZW5hYmxlZCAmJiB0aGlzLnN0YXRlICE9PSBCdXR0b25TdGF0ZS5QcmVzc2VkKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKEJ1dHRvblN0YXRlLk5vcm1hbCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyRG93bigpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygn8J+UtSBCdXR0b24gaGFuZGxlUG9pbnRlckRvd24gY2FsbGVkJyk7XG4gICAgY29uc29sZS5sb2coJyAgLSBlbmFibGVkOicsIHRoaXMucHJvcHMuZW5hYmxlZCk7XG4gICAgY29uc29sZS5sb2coJyAgLSBjYW5Gb2N1czonLCB0aGlzLmNhbkZvY3VzKCkpO1xuICAgIGNvbnNvbGUubG9nKCcgIC0gdGFiSW5kZXg6JywgdGhpcy50YWJJbmRleCk7XG5cbiAgICBpZiAodGhpcy5wcm9wcy5lbmFibGVkKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKEJ1dHRvblN0YXRlLlByZXNzZWQpO1xuXG4gICAgICAvLyBSZXF1ZXN0IGZvY3VzIHRocm91Z2ggdGhlIGZvY3VzIG1hbmFnZXJcbiAgICAgIGlmICh0aGlzLmNhbkZvY3VzKCkpIHtcbiAgICAgICAgY29uc3QgZm9jdXNNYW5hZ2VyID0gVUlGb2N1c01hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICAgICAgY29uc29sZS5sb2coJyAgLSBmb2N1c01hbmFnZXI6JywgZm9jdXNNYW5hZ2VyKTtcbiAgICAgICAgaWYgKGZvY3VzTWFuYWdlcikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCcgIC0gQ2FsbGluZyByZXF1ZXN0Rm9jdXMnKTtcbiAgICAgICAgICBmb2N1c01hbmFnZXIucmVxdWVzdEZvY3VzKHRoaXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCcgIC0gTm8gZm9jdXMgbWFuYWdlciwgY2FsbGluZyBvbkZvY3VzIGRpcmVjdGx5Jyk7XG4gICAgICAgICAgLy8gRmFsbGJhY2sgaWYgbm8gZm9jdXMgbWFuYWdlclxuICAgICAgICAgIHRoaXMub25Gb2N1cygpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygnICAtIGNhbkZvY3VzIHJldHVybmVkIGZhbHNlLCBOT1QgZm9jdXNpbmcnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJVcCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wcm9wcy5lbmFibGVkKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKEJ1dHRvblN0YXRlLkhvdmVyKTtcbiAgICAgIHRoaXMub25DbGljaz8uKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyVXBPdXRzaWRlKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoQnV0dG9uU3RhdGUuTm9ybWFsKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgYnV0dG9uJ3MgdmlzdWFsIHN0YXRlXG4gICAqL1xuICBwcml2YXRlIHNldFN0YXRlKG5ld1N0YXRlOiBCdXR0b25TdGF0ZSk6IHZvaWQge1xuICAgIHRoaXMuc3RhdGUgPSBuZXdTdGF0ZTtcbiAgICB0aGlzLnVwZGF0ZVZpc3VhbHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHZpc3VhbHMgYmFzZWQgb24gY3VycmVudCBzdGF0ZVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVWaXN1YWxzKCk6IHZvaWQge1xuICAgIC8vIFVwZGF0ZSBiYWNrZ3JvdW5kIHVzaW5nIHN0cmF0ZWd5XG4gICAgdGhpcy5iYWNrZ3JvdW5kU3RyYXRlZ3kudXBkYXRlU3RhdGUodGhpcy5zdGF0ZSk7XG5cbiAgICAvLyBDYWxjdWxhdGUgZGVwdGggb2Zmc2V0IGZvciBwcmVzc2VkIHN0YXRlXG4gICAgY29uc3QgeU9mZnNldCA9IHRoaXMuc3RhdGUgPT09IEJ1dHRvblN0YXRlLlByZXNzZWQgPyAyIDogMDtcblxuICAgIC8vIFVwZGF0ZSBjdXJzb3IgZm9yIGRpc2FibGVkIHN0YXRlXG4gICAgaWYgKHRoaXMuc3RhdGUgPT09IEJ1dHRvblN0YXRlLkRpc2FibGVkKSB7XG4gICAgICB0aGlzLmNvbnRhaW5lci5jdXJzb3IgPSAnZGVmYXVsdCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29udGFpbmVyLmN1cnNvciA9ICdwb2ludGVyJztcbiAgICB9XG5cbiAgICAvLyBBcHBseSBkZXB0aCBvZmZzZXQgdG8gbGFiZWxcbiAgICBpZiAodGhpcy5sYWJlbCkge1xuICAgICAgdGhpcy5sYWJlbC5zZXRQb3NpdGlvbih0aGlzLmxhYmVsQ2VudGVyWCwgdGhpcy5sYWJlbENlbnRlclkgKyB5T2Zmc2V0KTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuYml0bWFwTGFiZWwpIHtcbiAgICAgIHRoaXMuYml0bWFwTGFiZWwueCA9IHRoaXMubGFiZWxDZW50ZXJYO1xuICAgICAgdGhpcy5iaXRtYXBMYWJlbC55ID0gdGhpcy5sYWJlbENlbnRlclkgKyB5T2Zmc2V0O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgYnV0dG9uXG4gICAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIGJ1dHRvblxuICAgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcblxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcblxuICAgIC8vIEdldCBhY3R1YWwgYmFja2dyb3VuZCBoZWlnaHQgZnJvbSBzdHJhdGVneVxuICAgIGNvbnN0IGFjdHVhbEhlaWdodCA9IHRoaXMuYmFja2dyb3VuZFN0cmF0ZWd5LmdldEFjdHVhbEhlaWdodCgpO1xuXG4gICAgLy8gTGF5b3V0IGFuZCBjZW50ZXIgbGFiZWxcbiAgICBpZiAodGhpcy5sYWJlbCkge1xuICAgICAgdGhpcy5sYWJlbC5sYXlvdXQobWVhc3VyZWQud2lkdGgsIG1lYXN1cmVkLmhlaWdodCk7XG5cbiAgICAgIC8vIENlbnRlciB0aGUgbGFiZWwgYW5kIGNhY2hlIHRoZSBwb3NpdGlvblxuICAgICAgY29uc3QgbGFiZWxMYXlvdXQgPSB0aGlzLmxhYmVsLmdldExheW91dCgpO1xuICAgICAgdGhpcy5sYWJlbENlbnRlclggPSAobWVhc3VyZWQud2lkdGggLSBsYWJlbExheW91dC53aWR0aCkgLyAyO1xuICAgICAgdGhpcy5sYWJlbENlbnRlclkgPSAoYWN0dWFsSGVpZ2h0IC0gbGFiZWxMYXlvdXQuaGVpZ2h0KSAvIDI7XG4gICAgICB0aGlzLmxhYmVsLnNldFBvc2l0aW9uKHRoaXMubGFiZWxDZW50ZXJYLCB0aGlzLmxhYmVsQ2VudGVyWSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmJpdG1hcExhYmVsKSB7XG4gICAgICAvLyBDZW50ZXIgdGhlIGJpdG1hcCB0ZXh0IHVzaW5nIGFjdHVhbCBiYWNrZ3JvdW5kIGhlaWdodFxuICAgICAgdGhpcy5sYWJlbENlbnRlclggPSAobWVhc3VyZWQud2lkdGggLSB0aGlzLmJpdG1hcExhYmVsLndpZHRoKSAvIDI7XG4gICAgICB0aGlzLmxhYmVsQ2VudGVyWSA9IChhY3R1YWxIZWlnaHQgLSB0aGlzLmJpdG1hcExhYmVsLmhlaWdodCkgLyAyO1xuICAgICAgdGhpcy5iaXRtYXBMYWJlbC54ID0gdGhpcy5sYWJlbENlbnRlclg7XG4gICAgICB0aGlzLmJpdG1hcExhYmVsLnkgPSB0aGlzLmxhYmVsQ2VudGVyWTtcbiAgICB9XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSBidXR0b24gKGNhbGxlZCBhZnRlciBsYXlvdXQpXG4gICAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIC8vIFJlbmRlcmluZyBpcyBoYW5kbGVkIGJ5IGJhY2tncm91bmQgYW5kIGxhYmVsXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgYnV0dG9uIGxhYmVsXG4gICAqL1xuICBzZXRMYWJlbCh0ZXh0OiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5sYWJlbCkge1xuICAgICAgdGhpcy5sYWJlbC5zZXRUZXh0KHRleHQpO1xuICAgICAgdGhpcy5tYXJrTGF5b3V0RGlydHkoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuYml0bWFwTGFiZWwpIHtcbiAgICAgIHRoaXMuYml0bWFwTGFiZWwudGV4dCA9IHRleHQ7XG4gICAgICB0aGlzLm1hcmtMYXlvdXREaXJ0eSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBlbmFibGVkIHN0YXRlXG4gICAqL1xuICBzZXRFbmFibGVkKGVuYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLmVuYWJsZWQgPSBlbmFibGVkO1xuICAgIHRoaXMuc2V0U3RhdGUoZW5hYmxlZCA/IEJ1dHRvblN0YXRlLk5vcm1hbCA6IEJ1dHRvblN0YXRlLkRpc2FibGVkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IHN0YXRlXG4gICAqL1xuICBnZXRTdGF0ZSgpOiBCdXR0b25TdGF0ZSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGU7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCB3aGVuIGRlc3Ryb3lpbmcgdGhlIGJ1dHRvblxuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdGhpcy5rZXlkb3duSGFuZGxlcikge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmtleWRvd25IYW5kbGVyKTtcbiAgICB9XG4gICAgc3VwZXIuZGVzdHJveSgpO1xuICB9XG5cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuXG4vKipcbiAqIFRleHQgYWxpZ25tZW50IG9wdGlvbnNcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IHR5cGUgVGV4dEFsaWduID0gJ2xlZnQnIHwgJ2NlbnRlcicgfCAncmlnaHQnO1xuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJTGFiZWxcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSUxhYmVsUHJvcHMge1xuICAvKiogVGhlIHRleHQgdG8gZGlzcGxheSAqL1xuICB0ZXh0OiBzdHJpbmc7XG4gIC8qKiBGb250IHNpemUgaW4gcGl4ZWxzICovXG4gIGZvbnRTaXplPzogbnVtYmVyO1xuICAvKiogRm9udCBmYW1pbHkgbmFtZSAqL1xuICBmb250RmFtaWx5Pzogc3RyaW5nO1xuICAvKiogVGV4dCBjb2xvciAoaGV4IG51bWJlcikgKi9cbiAgY29sb3I/OiBudW1iZXI7XG4gIC8qKiBUZXh0IGFsaWdubWVudCAqL1xuICBhbGlnbj86IFRleHRBbGlnbjtcbiAgLyoqIEVuYWJsZSB3b3JkIHdyYXBwaW5nICovXG4gIHdvcmRXcmFwPzogYm9vbGVhbjtcbiAgLyoqIFdvcmQgd3JhcCB3aWR0aCAocmVxdWlyZWQgaWYgd29yZFdyYXAgaXMgdHJ1ZSkgKi9cbiAgd29yZFdyYXBXaWR0aD86IG51bWJlcjtcbiAgLyoqIEZvbnQgd2VpZ2h0ICovXG4gIGZvbnRXZWlnaHQ/OiBzdHJpbmc7XG4gIC8qKiBMaW5lIGhlaWdodCBtdWx0aXBsaWVyICovXG4gIGxpbmVIZWlnaHQ/OiBudW1iZXI7XG59XG5cbi8qKlxuICogQSB0ZXh0IGxhYmVsIGNvbXBvbmVudFxuICogV3JhcHMgUElYSS5UZXh0IHdpdGggbGF5b3V0IGludGVncmF0aW9uXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGxhYmVsID0gbmV3IFVJTGFiZWwoe1xuICogICB0ZXh0OiAnSGVsbG8gV29ybGQnLFxuICogICBmb250U2l6ZTogMjQsXG4gKiAgIGNvbG9yOiAweGZmZmZmZixcbiAqICAgYWxpZ246ICdjZW50ZXInXG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlMYWJlbCBleHRlbmRzIFVJQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBwcm9wczogUmVxdWlyZWQ8VUlMYWJlbFByb3BzPjtcbiAgcHJpdmF0ZSB0ZXh0T2JqZWN0OiBQSVhJLlRleHQ7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJTGFiZWxQcm9wcywgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICB0ZXh0OiBwcm9wcy50ZXh0LFxuICAgICAgZm9udFNpemU6IHByb3BzLmZvbnRTaXplID8/IDE2LFxuICAgICAgZm9udEZhbWlseTogcHJvcHMuZm9udEZhbWlseSA/PyAnQXJpYWwnLFxuICAgICAgY29sb3I6IHByb3BzLmNvbG9yID8/IDB4ZmZmZmZmLFxuICAgICAgYWxpZ246IHByb3BzLmFsaWduID8/ICdsZWZ0JyxcbiAgICAgIHdvcmRXcmFwOiBwcm9wcy53b3JkV3JhcCA/PyBmYWxzZSxcbiAgICAgIHdvcmRXcmFwV2lkdGg6IHByb3BzLndvcmRXcmFwV2lkdGggPz8gMCxcbiAgICAgIGZvbnRXZWlnaHQ6IHByb3BzLmZvbnRXZWlnaHQgPz8gJ25vcm1hbCcsXG4gICAgICBsaW5lSGVpZ2h0OiBwcm9wcy5saW5lSGVpZ2h0ID8/IDEuMlxuICAgIH07XG5cbiAgICAvLyBDcmVhdGUgUElYSS5UZXh0IHdpdGggaW5pdGlhbCBzdHlsZVxuICAgIHRoaXMudGV4dE9iamVjdCA9IG5ldyBQSVhJLlRleHQoe1xuICAgICAgdGV4dDogdGhpcy5wcm9wcy50ZXh0LFxuICAgICAgc3R5bGU6IHRoaXMuZ2V0VGV4dFN0eWxlKCksXG4gICAgICByZXNvbHV0aW9uOiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAyIC8vIE1hdGNoIGRldmljZSByZXNvbHV0aW9uIGZvciBjcmlzcCB0ZXh0XG4gICAgfSk7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnRleHRPYmplY3QpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIFBJWEkgdGV4dCBzdHlsZSBiYXNlZCBvbiBjdXJyZW50IHByb3BzXG4gICAqL1xuICBwcml2YXRlIGdldFRleHRTdHlsZSgpOiBQSVhJLlRleHRTdHlsZSB7XG4gICAgY29uc3Qgc3R5bGU6IGFueSA9IHtcbiAgICAgIGZvbnRGYW1pbHk6IHRoaXMucHJvcHMuZm9udEZhbWlseSxcbiAgICAgIGZvbnRTaXplOiB0aGlzLnByb3BzLmZvbnRTaXplLFxuICAgICAgZmlsbDogdGhpcy5wcm9wcy5jb2xvcixcbiAgICAgIGFsaWduOiB0aGlzLnByb3BzLmFsaWduLFxuICAgICAgZm9udFdlaWdodDogdGhpcy5wcm9wcy5mb250V2VpZ2h0LFxuICAgICAgbGluZUhlaWdodDogdGhpcy5wcm9wcy5mb250U2l6ZSAqIHRoaXMucHJvcHMubGluZUhlaWdodFxuICAgIH07XG5cbiAgICBpZiAodGhpcy5wcm9wcy53b3JkV3JhcCkge1xuICAgICAgc3R5bGUud29yZFdyYXAgPSB0cnVlO1xuICAgICAgc3R5bGUud29yZFdyYXBXaWR0aCA9IHRoaXMucHJvcHMud29yZFdyYXBXaWR0aDtcbiAgICB9XG5cbiAgICByZXR1cm4gc3R5bGU7XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgdGhlIHNpemUgbmVlZGVkIGZvciB0aGlzIGxhYmVsXG4gICAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICBjb25zdCBtZXRyaWNzID0gdGhpcy50ZXh0T2JqZWN0O1xuXG4gICAgLy8gR2V0IHRleHQgYm91bmRzXG4gICAgY29uc3QgdGV4dFdpZHRoID0gbWV0cmljcy53aWR0aDtcbiAgICBjb25zdCB0ZXh0SGVpZ2h0ID0gbWV0cmljcy5oZWlnaHQ7XG5cbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRleHRXaWR0aCArIHBhZGRpbmcuaG9yaXpvbnRhbCxcbiAgICAgIGhlaWdodDogdGV4dEhlaWdodCArIHBhZGRpbmcudmVydGljYWxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGxheW91dCBmb3IgdGhpcyBsYWJlbFxuICAgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcblxuICAgIC8vIFVwZGF0ZSB3b3JkIHdyYXAgd2lkdGggaWYgbmVlZGVkXG4gICAgaWYgKHRoaXMucHJvcHMud29yZFdyYXAgJiYgdGhpcy5wcm9wcy53b3JkV3JhcFdpZHRoID09PSAwKSB7XG4gICAgICAvLyBVc2UgYXZhaWxhYmxlIHdpZHRoIG1pbnVzIHBhZGRpbmdcbiAgICAgIGNvbnN0IHdyYXBXaWR0aCA9IGF2YWlsYWJsZVdpZHRoIC0gcGFkZGluZy5ob3Jpem9udGFsO1xuICAgICAgdGhpcy5wcm9wcy53b3JkV3JhcFdpZHRoID0gd3JhcFdpZHRoO1xuICAgICAgdGhpcy50ZXh0T2JqZWN0LnN0eWxlID0gdGhpcy5nZXRUZXh0U3R5bGUoKTtcbiAgICB9XG5cbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuXG4gICAgLy8gSGFuZGxlICdmaWxsJyBjb25zdHJhaW50c1xuICAgIGxldCBmaW5hbFdpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgbGV0IGZpbmFsSGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgaWYgKHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdmaWxsJykge1xuICAgICAgZmluYWxXaWR0aCA9IGF2YWlsYWJsZVdpZHRoO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdudW1iZXInKSB7XG4gICAgICBmaW5hbFdpZHRoID0gdGhpcy5ib3hNb2RlbC53aWR0aCArIHBhZGRpbmcuaG9yaXpvbnRhbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdmaWxsJykge1xuICAgICAgZmluYWxIZWlnaHQgPSBhdmFpbGFibGVIZWlnaHQ7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdudW1iZXInKSB7XG4gICAgICBmaW5hbEhlaWdodCA9IHRoaXMuYm94TW9kZWwuaGVpZ2h0ICsgcGFkZGluZy52ZXJ0aWNhbDtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgY29tcHV0ZWQgbGF5b3V0XG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IGZpbmFsV2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBmaW5hbEhlaWdodDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRYID0gcGFkZGluZy5sZWZ0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFkgPSBwYWRkaW5nLnRvcDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRXaWR0aCA9IGZpbmFsV2lkdGggLSBwYWRkaW5nLmhvcml6b250YWw7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50SGVpZ2h0ID0gZmluYWxIZWlnaHQgLSBwYWRkaW5nLnZlcnRpY2FsO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgbGFiZWwgKHBvc2l0aW9ucyB0aGUgdGV4dCBvYmplY3QpXG4gICAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG4gICAgdGhpcy50ZXh0T2JqZWN0LnBvc2l0aW9uLnNldChwYWRkaW5nLmxlZnQsIHBhZGRpbmcudG9wKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSB0ZXh0IGNvbnRlbnRcbiAgICovXG4gIHNldFRleHQodGV4dDogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy50ZXh0ID0gdGV4dDtcbiAgICB0aGlzLnRleHRPYmplY3QudGV4dCA9IHRleHQ7XG4gICAgdGhpcy5tYXJrTGF5b3V0RGlydHkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSB0ZXh0IGNvbG9yXG4gICAqL1xuICBzZXRDb2xvcihjb2xvcjogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy5jb2xvciA9IGNvbG9yO1xuICAgIHRoaXMudGV4dE9iamVjdC5zdHlsZS5maWxsID0gY29sb3I7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgZm9udCBzaXplXG4gICAqL1xuICBzZXRGb250U2l6ZShzaXplOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnByb3BzLmZvbnRTaXplID0gc2l6ZTtcbiAgICB0aGlzLnRleHRPYmplY3Quc3R5bGUuZm9udFNpemUgPSBzaXplO1xuICAgIHRoaXMubWFya0xheW91dERpcnR5KCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCB0ZXh0XG4gICAqL1xuICBnZXRUZXh0KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMudGV4dDtcbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5cbi8qKlxuICogOS1zbGljZSBjb25maWd1cmF0aW9uIGZvciBzY2FsYWJsZSBzcHJpdGVzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTmluZVNsaWNlQ29uZmlnIHtcbiAgLyoqIFdpZHRoIG9mIGxlZnQgZWRnZSB0aGF0IGRvZXNuJ3Qgc2NhbGUgKi9cbiAgbGVmdFdpZHRoOiBudW1iZXI7XG4gIC8qKiBIZWlnaHQgb2YgdG9wIGVkZ2UgdGhhdCBkb2Vzbid0IHNjYWxlICovXG4gIHRvcEhlaWdodDogbnVtYmVyO1xuICAvKiogV2lkdGggb2YgcmlnaHQgZWRnZSB0aGF0IGRvZXNuJ3Qgc2NhbGUgKi9cbiAgcmlnaHRXaWR0aDogbnVtYmVyO1xuICAvKiogSGVpZ2h0IG9mIGJvdHRvbSBlZGdlIHRoYXQgZG9lc24ndCBzY2FsZSAqL1xuICBib3R0b21IZWlnaHQ6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBQcm9wcyBmb3IgY29uZmlndXJpbmcgYSBVSVBhbmVsXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlQYW5lbFByb3BzIHtcbiAgLyoqIEJhY2tncm91bmQgdGV4dHVyZSAqL1xuICB0ZXh0dXJlPzogUElYSS5UZXh0dXJlO1xuICAvKiogQmFja2dyb3VuZCBjb2xvciAoaWYgbm8gdGV4dHVyZSkgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogQmFja2dyb3VuZCBhbHBoYSAqL1xuICBiYWNrZ3JvdW5kQWxwaGE/OiBudW1iZXI7XG4gIC8qKiA5LXNsaWNlIGNvbmZpZ3VyYXRpb24gKGlmIHVzaW5nIHRleHR1cmUpICovXG4gIG5pbmVTbGljZT86IE5pbmVTbGljZUNvbmZpZztcbiAgLyoqIEZpeGVkIHdpZHRoICovXG4gIHdpZHRoPzogbnVtYmVyO1xuICAvKiogRml4ZWQgaGVpZ2h0ICovXG4gIGhlaWdodD86IG51bWJlcjtcbiAgLyoqIEJvcmRlciByYWRpdXMgKGlmIHVzaW5nIHNvbGlkIGNvbG9yKSAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG59XG5cbi8qKlxuICogQSBwYW5lbCBjb21wb25lbnQgd2l0aCBvcHRpb25hbCA5LXNsaWNlIGJhY2tncm91bmRcbiAqIENhbiB1c2UgZWl0aGVyIGEgdGV4dHVyZSBvciBzb2xpZCBjb2xvciBiYWNrZ3JvdW5kXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIC8vIFdpdGggdGV4dHVyZSBhbmQgOS1zbGljZVxuICogY29uc3QgcGFuZWwgPSBuZXcgVUlQYW5lbCh7XG4gKiAgIHRleHR1cmU6IHBhbmVsVGV4dHVyZSxcbiAqICAgbmluZVNsaWNlOiB7IGxlZnRXaWR0aDogMTYsIHRvcEhlaWdodDogMTYsIHJpZ2h0V2lkdGg6IDE2LCBib3R0b21IZWlnaHQ6IDE2IH0sXG4gKiAgIHdpZHRoOiAzMDAsXG4gKiAgIGhlaWdodDogMjAwXG4gKiB9KTtcbiAqXG4gKiAvLyBXaXRoIHNvbGlkIGNvbG9yXG4gKiBjb25zdCBwYW5lbCA9IG5ldyBVSVBhbmVsKHtcbiAqICAgYmFja2dyb3VuZENvbG9yOiAweDJjM2U1MCxcbiAqICAgd2lkdGg6IDMwMCxcbiAqICAgaGVpZ2h0OiAyMDAsXG4gKiAgIGJvcmRlclJhZGl1czogOFxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJUGFuZWwgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFVJUGFuZWxQcm9wcztcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kPzogUElYSS5OaW5lU2xpY2VTcHJpdGUgfCBQSVhJLkdyYXBoaWNzO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSVBhbmVsUHJvcHMgPSB7fSwgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIHRoaXMucHJvcHMgPSB7XG4gICAgICBiYWNrZ3JvdW5kQWxwaGE6IHByb3BzLmJhY2tncm91bmRBbHBoYSA/PyAxLFxuICAgICAgLi4ucHJvcHNcbiAgICB9O1xuXG4gICAgLy8gU2V0IGJveCBtb2RlbCBkaW1lbnNpb25zIGlmIHByb3ZpZGVkXG4gICAgaWYgKHByb3BzLndpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSBwcm9wcy53aWR0aDtcbiAgICB9XG4gICAgaWYgKHByb3BzLmhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmJveE1vZGVsLmhlaWdodCA9IHByb3BzLmhlaWdodDtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYmFja2dyb3VuZFxuICAgIHRoaXMuY3JlYXRlQmFja2dyb3VuZCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgdGhlIGJhY2tncm91bmQgKGVpdGhlciA5LXNsaWNlIHNwcml0ZSBvciBncmFwaGljcylcbiAgICovXG4gIHByaXZhdGUgY3JlYXRlQmFja2dyb3VuZCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wcm9wcy50ZXh0dXJlICYmIHRoaXMucHJvcHMubmluZVNsaWNlKSB7XG4gICAgICAvLyBVc2UgOS1zbGljZSBzcHJpdGVcbiAgICAgIGNvbnN0IHsgbGVmdFdpZHRoLCB0b3BIZWlnaHQsIHJpZ2h0V2lkdGgsIGJvdHRvbUhlaWdodCB9ID0gdGhpcy5wcm9wcy5uaW5lU2xpY2U7XG4gICAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgUElYSS5OaW5lU2xpY2VTcHJpdGUoe1xuICAgICAgICB0ZXh0dXJlOiB0aGlzLnByb3BzLnRleHR1cmUsXG4gICAgICAgIGxlZnRXaWR0aCxcbiAgICAgICAgdG9wSGVpZ2h0LFxuICAgICAgICByaWdodFdpZHRoLFxuICAgICAgICBib3R0b21IZWlnaHRcbiAgICAgIH0pO1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kLmFscGhhID0gdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQWxwaGEgPz8gMTtcbiAgICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuYmFja2dyb3VuZCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyBVc2UgZ3JhcGhpY3MgZm9yIHNvbGlkIGNvbG9yXG4gICAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgdGhlIHNpemUgbmVlZGVkIGZvciB0aGlzIHBhbmVsXG4gICAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcblxuICAgIGxldCBjb250ZW50V2lkdGggPSAwO1xuICAgIGxldCBjb250ZW50SGVpZ2h0ID0gMDtcblxuICAgIGlmICh0eXBlb2YgdGhpcy5ib3hNb2RlbC53aWR0aCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnRlbnRXaWR0aCA9IHRoaXMuYm94TW9kZWwud2lkdGg7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLndpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnRlbnRXaWR0aCA9IHRoaXMucHJvcHMud2lkdGg7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLmhlaWdodCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnRlbnRIZWlnaHQgPSB0aGlzLmJveE1vZGVsLmhlaWdodDtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuaGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnRlbnRIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IGNvbnRlbnRXaWR0aCArIHBhZGRpbmcuaG9yaXpvbnRhbCxcbiAgICAgIGhlaWdodDogY29udGVudEhlaWdodCArIHBhZGRpbmcudmVydGljYWxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGxheW91dCBmb3IgdGhpcyBwYW5lbFxuICAgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGZpbmFsIGRpbWVuc2lvbnNcbiAgICBsZXQgZmluYWxXaWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIGxldCBmaW5hbEhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcblxuICAgIGlmICh0aGlzLmJveE1vZGVsLndpZHRoID09PSAnZmlsbCcpIHtcbiAgICAgIGZpbmFsV2lkdGggPSBhdmFpbGFibGVXaWR0aDtcbiAgICB9XG4gICAgaWYgKHRoaXMuYm94TW9kZWwuaGVpZ2h0ID09PSAnZmlsbCcpIHtcbiAgICAgIGZpbmFsSGVpZ2h0ID0gYXZhaWxhYmxlSGVpZ2h0O1xuICAgIH1cblxuICAgIC8vIEFwcGx5IG1heCBjb25zdHJhaW50c1xuICAgIGlmICh0aGlzLmJveE1vZGVsLm1heFdpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZpbmFsV2lkdGggPSBNYXRoLm1pbihmaW5hbFdpZHRoLCB0aGlzLmJveE1vZGVsLm1heFdpZHRoKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuYm94TW9kZWwubWF4SGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZpbmFsSGVpZ2h0ID0gTWF0aC5taW4oZmluYWxIZWlnaHQsIHRoaXMuYm94TW9kZWwubWF4SGVpZ2h0KTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgY29tcHV0ZWQgbGF5b3V0XG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IGZpbmFsV2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBmaW5hbEhlaWdodDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRYID0gcGFkZGluZy5sZWZ0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFkgPSBwYWRkaW5nLnRvcDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRXaWR0aCA9IGZpbmFsV2lkdGggLSBwYWRkaW5nLmhvcml6b250YWw7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50SGVpZ2h0ID0gZmluYWxIZWlnaHQgLSBwYWRkaW5nLnZlcnRpY2FsO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgcGFuZWwgYmFja2dyb3VuZFxuICAgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYmFja2dyb3VuZCkgcmV0dXJuO1xuXG4gICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSB0aGlzLmNvbXB1dGVkTGF5b3V0O1xuXG4gICAgaWYgKHRoaXMuYmFja2dyb3VuZCBpbnN0YW5jZW9mIFBJWEkuTmluZVNsaWNlU3ByaXRlKSB7XG4gICAgICAvLyBVcGRhdGUgOS1zbGljZSBzcHJpdGUgc2l6ZVxuICAgICAgdGhpcy5iYWNrZ3JvdW5kLndpZHRoID0gd2lkdGg7XG4gICAgICB0aGlzLmJhY2tncm91bmQuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIH0gZWxzZSBpZiAodGhpcy5iYWNrZ3JvdW5kIGluc3RhbmNlb2YgUElYSS5HcmFwaGljcykge1xuICAgICAgLy8gUmVkcmF3IGdyYXBoaWNzXG4gICAgICB0aGlzLmJhY2tncm91bmQuY2xlYXIoKTtcblxuICAgICAgaWYgKHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzICYmIHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzID4gMCkge1xuICAgICAgICB0aGlzLmJhY2tncm91bmQucm91bmRSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQsIHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYmFja2dyb3VuZC5yZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmJhY2tncm91bmQuZmlsbCh7XG4gICAgICAgICAgY29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgICAgIGFscGhhOiB0aGlzLnByb3BzLmJhY2tncm91bmRBbHBoYVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgYmFja2dyb3VuZCBjb2xvciAob25seSB3b3JrcyBmb3Igc29saWQgY29sb3IgcGFuZWxzKVxuICAgKi9cbiAgc2V0QmFja2dyb3VuZENvbG9yKGNvbG9yOiBudW1iZXIsIGFscGhhOiBudW1iZXIgPSAxKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuYmFja2dyb3VuZCBpbnN0YW5jZW9mIFBJWEkuR3JhcGhpY3MpIHtcbiAgICAgIHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XG4gICAgICB0aGlzLnByb3BzLmJhY2tncm91bmRBbHBoYSA9IGFscGhhO1xuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgdGV4dHVyZSAob25seSB3b3JrcyBmb3IgdGV4dHVyZS1iYXNlZCBwYW5lbHMpXG4gICAqL1xuICBzZXRUZXh0dXJlKHRleHR1cmU6IFBJWEkuVGV4dHVyZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLmJhY2tncm91bmQgaW5zdGFuY2VvZiBQSVhJLk5pbmVTbGljZVNwcml0ZSkge1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kLnRleHR1cmUgPSB0ZXh0dXJlO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5pbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi4vY29yZS9lZGdlLWluc2V0cyc7XG5cbi8qKlxuICogUHJvcHMgZm9yIGNvbmZpZ3VyaW5nIGEgVUlTY3JvbGxDb250YWluZXJcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSVNjcm9sbENvbnRhaW5lclByb3BzIHtcbiAgLyoqIFdpZHRoIG9mIHRoZSBzY3JvbGwgY29udGFpbmVyICovXG4gIHdpZHRoOiBudW1iZXI7XG4gIC8qKiBIZWlnaHQgb2YgdGhlIHNjcm9sbCBjb250YWluZXIgKHZpZXdwb3J0IGhlaWdodCkgKi9cbiAgaGVpZ2h0OiBudW1iZXI7XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yIG9mIHRoZSBjb250YWluZXIgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG4gIC8qKiBTY3JvbGxiYXIgd2lkdGggKi9cbiAgc2Nyb2xsYmFyV2lkdGg/OiBudW1iZXI7XG4gIC8qKiBTY3JvbGxiYXIgdHJhY2sgY29sb3IgKi9cbiAgc2Nyb2xsYmFyVHJhY2tDb2xvcj86IG51bWJlcjtcbiAgLyoqIFNjcm9sbGJhciB0aHVtYiBjb2xvciAqL1xuICBzY3JvbGxiYXJUaHVtYkNvbG9yPzogbnVtYmVyO1xuICAvKiogU2Nyb2xsYmFyIHRodW1iIGhvdmVyIGNvbG9yICovXG4gIHNjcm9sbGJhclRodW1iSG92ZXJDb2xvcj86IG51bWJlcjtcbiAgLyoqIFdoZXRoZXIgdG8gc2hvdyBzY3JvbGxiYXIgb25seSBvbiBob3ZlciAqL1xuICBzY3JvbGxiYXJBdXRvSGlkZT86IGJvb2xlYW47XG4gIC8qKiBQYWRkaW5nIGluc2lkZSB0aGUgc2Nyb2xsIGNvbnRhaW5lciAqL1xuICBwYWRkaW5nPzogRWRnZUluc2V0cztcbn1cblxuLyoqXG4gKiBBIHNjcm9sbGFibGUgY29udGFpbmVyIHdpdGggYSB2aXN1YWwgc2Nyb2xsYmFyXG4gKiBTdXBwb3J0cyBtb3VzZSB3aGVlbCBzY3JvbGxpbmcgYW5kIGRyYWdnYWJsZSBzY3JvbGxiYXIgdGh1bWJcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3Qgc2Nyb2xsQ29udGFpbmVyID0gbmV3IFVJU2Nyb2xsQ29udGFpbmVyKHtcbiAqICAgd2lkdGg6IDQwMCxcbiAqICAgaGVpZ2h0OiAzMDAsXG4gKiAgIGJhY2tncm91bmRDb2xvcjogMHhmZmZmZmZcbiAqIH0pO1xuICpcbiAqIC8vIEFkZCBjaGlsZHJlbiB0aGF0IGV4Y2VlZCB0aGUgdmlld3BvcnQgaGVpZ2h0XG4gKiBzY3JvbGxDb250YWluZXIuYWRkQ2hpbGQoc29tZVVJQ29tcG9uZW50KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlTY3JvbGxDb250YWluZXIgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFJlcXVpcmVkPFVJU2Nyb2xsQ29udGFpbmVyUHJvcHM+O1xuICBwcml2YXRlIGJhY2tncm91bmQ6IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgY29udGVudENvbnRhaW5lcjogUElYSS5Db250YWluZXI7XG4gIHByaXZhdGUgY29udGVudE1hc2s6IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgc2Nyb2xsYmFyVHJhY2s6IFBJWEkuR3JhcGhpY3M7XG4gIHByaXZhdGUgc2Nyb2xsYmFyVGh1bWI6IFBJWEkuR3JhcGhpY3M7XG5cbiAgLy8gUHVibGljIGNoaWxkcmVuIGFycmF5IGZvciBmb2N1cyBtYW5hZ2VyIGRpc2NvdmVyeVxuICBwdWJsaWMgY2hpbGRyZW46IFVJQ29tcG9uZW50W10gPSBbXTtcblxuICBwcml2YXRlIHNjcm9sbFk6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgbWF4U2Nyb2xsWTogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBjb250ZW50SGVpZ2h0OiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGlzRHJhZ2dpbmc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBkcmFnU3RhcnRZOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGRyYWdTdGFydFNjcm9sbFk6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgaXNIb3ZlcmluZ1RodW1iOiBib29sZWFuID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJU2Nyb2xsQ29udGFpbmVyUHJvcHMsIGJveE1vZGVsPzogUGFydGlhbDxCb3hNb2RlbD4pIHtcbiAgICBzdXBlcihib3hNb2RlbCk7XG5cbiAgICB0aGlzLnByb3BzID0ge1xuICAgICAgd2lkdGg6IHByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiBwcm9wcy5oZWlnaHQsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHByb3BzLmJhY2tncm91bmRDb2xvciA/PyAweGZmZmZmZixcbiAgICAgIGJvcmRlclJhZGl1czogcHJvcHMuYm9yZGVyUmFkaXVzID8/IDAsXG4gICAgICBzY3JvbGxiYXJXaWR0aDogcHJvcHMuc2Nyb2xsYmFyV2lkdGggPz8gMTIsXG4gICAgICBzY3JvbGxiYXJUcmFja0NvbG9yOiBwcm9wcy5zY3JvbGxiYXJUcmFja0NvbG9yID8/IDB4ZTBlMGUwLFxuICAgICAgc2Nyb2xsYmFyVGh1bWJDb2xvcjogcHJvcHMuc2Nyb2xsYmFyVGh1bWJDb2xvciA/PyAweDg4ODg4OCxcbiAgICAgIHNjcm9sbGJhclRodW1iSG92ZXJDb2xvcjogcHJvcHMuc2Nyb2xsYmFyVGh1bWJIb3ZlckNvbG9yID8/IDB4NTU1NTU1LFxuICAgICAgc2Nyb2xsYmFyQXV0b0hpZGU6IHByb3BzLnNjcm9sbGJhckF1dG9IaWRlID8/IGZhbHNlLFxuICAgICAgcGFkZGluZzogcHJvcHMucGFkZGluZyA/PyBFZGdlSW5zZXRzLmFsbCgwKVxuICAgIH07XG5cbiAgICAvLyBTZXQgYm94IG1vZGVsIGRpbWVuc2lvbnNcbiAgICB0aGlzLmJveE1vZGVsLndpZHRoID0gdGhpcy5wcm9wcy53aWR0aDtcbiAgICB0aGlzLmJveE1vZGVsLmhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuXG4gICAgLy8gQ3JlYXRlIGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMudXBkYXRlQmFja2dyb3VuZCgpO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuYmFja2dyb3VuZCk7XG5cbiAgICAvLyBDcmVhdGUgY29udGVudCBjb250YWluZXJcbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIueCA9IHRoaXMucHJvcHMucGFkZGluZy5sZWZ0O1xuICAgIHRoaXMuY29udGVudENvbnRhaW5lci55ID0gdGhpcy5wcm9wcy5wYWRkaW5nLnRvcDtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmNvbnRlbnRDb250YWluZXIpO1xuXG4gICAgLy8gQ3JlYXRlIG1hc2sgZm9yIGNvbnRlbnRcbiAgICB0aGlzLmNvbnRlbnRNYXNrID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0aGlzLnVwZGF0ZU1hc2soKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmNvbnRlbnRNYXNrKTtcbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIubWFzayA9IHRoaXMuY29udGVudE1hc2s7XG5cbiAgICAvLyBDcmVhdGUgc2Nyb2xsYmFyIHRyYWNrXG4gICAgdGhpcy5zY3JvbGxiYXJUcmFjayA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy5zY3JvbGxiYXJUcmFjay5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrLmN1cnNvciA9ICdwb2ludGVyJztcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnNjcm9sbGJhclRyYWNrKTtcblxuICAgIC8vIENyZWF0ZSBzY3JvbGxiYXIgdGh1bWJcbiAgICB0aGlzLnNjcm9sbGJhclRodW1iID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICB0aGlzLnNjcm9sbGJhclRodW1iLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIuY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuc2Nyb2xsYmFyVGh1bWIpO1xuXG4gICAgLy8gU2V0dXAgaW50ZXJhY3Rpdml0eVxuICAgIHRoaXMuc2V0dXBJbnRlcmFjdGl2aXR5KCk7XG5cbiAgICAvLyBJbml0aWFsIHNjcm9sbGJhciB1cGRhdGVcbiAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGJhY2tncm91bmQgZ3JhcGhpY3NcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlQmFja2dyb3VuZCgpOiB2b2lkIHtcbiAgICB0aGlzLmJhY2tncm91bmQuY2xlYXIoKTtcbiAgICB0aGlzLmJhY2tncm91bmQucm91bmRSZWN0KFxuICAgICAgMCxcbiAgICAgIDAsXG4gICAgICB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgdGhpcy5wcm9wcy5oZWlnaHQsXG4gICAgICB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgICk7XG4gICAgdGhpcy5iYWNrZ3JvdW5kLmZpbGwoeyBjb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IgfSk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgY29udGVudCBtYXNrXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZU1hc2soKTogdm9pZCB7XG4gICAgY29uc3QgY29udGVudFdpZHRoID0gdGhpcy5wcm9wcy53aWR0aCAtIHRoaXMucHJvcHMucGFkZGluZy5sZWZ0IC0gdGhpcy5wcm9wcy5wYWRkaW5nLnJpZ2h0IC0gdGhpcy5wcm9wcy5zY3JvbGxiYXJXaWR0aDtcbiAgICBjb25zdCBjb250ZW50SGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQgLSB0aGlzLnByb3BzLnBhZGRpbmcudG9wIC0gdGhpcy5wcm9wcy5wYWRkaW5nLmJvdHRvbTtcblxuICAgIHRoaXMuY29udGVudE1hc2suY2xlYXIoKTtcbiAgICB0aGlzLmNvbnRlbnRNYXNrLnJlY3QoXG4gICAgICB0aGlzLnByb3BzLnBhZGRpbmcubGVmdCxcbiAgICAgIHRoaXMucHJvcHMucGFkZGluZy50b3AsXG4gICAgICBjb250ZW50V2lkdGgsXG4gICAgICBjb250ZW50SGVpZ2h0XG4gICAgKTtcbiAgICB0aGlzLmNvbnRlbnRNYXNrLmZpbGwoeyBjb2xvcjogMHhmZmZmZmYgfSk7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB1cCBtb3VzZS93aGVlbCBldmVudCBoYW5kbGVyc1xuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cEludGVyYWN0aXZpdHkoKTogdm9pZCB7XG4gICAgLy8gTW91c2Ugd2hlZWwgc2Nyb2xsaW5nXG4gICAgdGhpcy5jb250YWluZXIuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgdGhpcy5jb250YWluZXIub24oJ3doZWVsJywgdGhpcy5oYW5kbGVXaGVlbC5iaW5kKHRoaXMpKTtcblxuICAgIC8vIFNjcm9sbGJhciB0aHVtYiBkcmFnZ2luZ1xuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIub24oJ3BvaW50ZXJkb3duJywgdGhpcy5oYW5kbGVUaHVtYlBvaW50ZXJEb3duLmJpbmQodGhpcykpO1xuICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIub24oJ3BvaW50ZXJvdmVyJywgKCkgPT4ge1xuICAgICAgdGhpcy5pc0hvdmVyaW5nVGh1bWIgPSB0cnVlO1xuICAgICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgICB9KTtcbiAgICB0aGlzLnNjcm9sbGJhclRodW1iLm9uKCdwb2ludGVyb3V0JywgKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmlzRHJhZ2dpbmcpIHtcbiAgICAgICAgdGhpcy5pc0hvdmVyaW5nVGh1bWIgPSBmYWxzZTtcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFRyYWNrIGNsaWNrIGZvciBqdW1waW5nXG4gICAgdGhpcy5zY3JvbGxiYXJUcmFjay5vbigncG9pbnRlcmRvd24nLCB0aGlzLmhhbmRsZVRyYWNrUG9pbnRlckRvd24uYmluZCh0aGlzKSk7XG5cbiAgICAvLyBHbG9iYWwgcG9pbnRlciBldmVudHMgZm9yIGRyYWdnaW5nXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCB0aGlzLmhhbmRsZUdsb2JhbFBvaW50ZXJNb3ZlLmJpbmQodGhpcykpO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJ1cCcsIHRoaXMuaGFuZGxlR2xvYmFsUG9pbnRlclVwLmJpbmQodGhpcykpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIG1vdXNlIHdoZWVsIGV2ZW50c1xuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVXaGVlbChlOiBQSVhJLkZlZGVyYXRlZFdoZWVsRXZlbnQpOiB2b2lkIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCBkZWx0YSA9IGUuZGVsdGFZO1xuICAgIHRoaXMuc2Nyb2xsWSArPSBkZWx0YTtcbiAgICB0aGlzLnNjcm9sbFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbih0aGlzLm1heFNjcm9sbFksIHRoaXMuc2Nyb2xsWSkpO1xuXG4gICAgdGhpcy51cGRhdGVDb250ZW50UG9zaXRpb24oKTtcbiAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgcG9pbnRlciBkb3duIG9uIHNjcm9sbGJhciB0aHVtYlxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVUaHVtYlBvaW50ZXJEb3duKGU6IFBJWEkuRmVkZXJhdGVkUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTtcbiAgICB0aGlzLmRyYWdTdGFydFkgPSBlLmdsb2JhbFk7XG4gICAgdGhpcy5kcmFnU3RhcnRTY3JvbGxZID0gdGhpcy5zY3JvbGxZO1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBwb2ludGVyIGRvd24gb24gc2Nyb2xsYmFyIHRyYWNrXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVRyYWNrUG9pbnRlckRvd24oZTogUElYSS5GZWRlcmF0ZWRQb2ludGVyRXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBsb2NhbFkgPSBlLmdsb2JhbFkgLSB0aGlzLmNvbnRhaW5lci53b3JsZFRyYW5zZm9ybS50eTtcbiAgICBjb25zdCB0aHVtYkhlaWdodCA9IHRoaXMuZ2V0VGh1bWJIZWlnaHQoKTtcbiAgICBjb25zdCB0cmFja1RvcCA9IDA7XG4gICAgY29uc3QgdHJhY2tCb3R0b20gPSB0aGlzLnByb3BzLmhlaWdodDtcblxuICAgIC8vIENhbGN1bGF0ZSB0YXJnZXQgc2Nyb2xsIHBvc2l0aW9uXG4gICAgY29uc3QgY2xpY2tSYXRpbyA9IChsb2NhbFkgLSB0cmFja1RvcCkgLyAodHJhY2tCb3R0b20gLSB0cmFja1RvcCk7XG4gICAgdGhpcy5zY3JvbGxZID0gY2xpY2tSYXRpbyAqIHRoaXMubWF4U2Nyb2xsWTtcbiAgICB0aGlzLnNjcm9sbFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbih0aGlzLm1heFNjcm9sbFksIHRoaXMuc2Nyb2xsWSkpO1xuXG4gICAgdGhpcy51cGRhdGVDb250ZW50UG9zaXRpb24oKTtcbiAgICB0aGlzLnVwZGF0ZVNjcm9sbGJhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgZ2xvYmFsIHBvaW50ZXIgbW92ZSBmb3IgdGh1bWIgZHJhZ2dpbmdcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlR2xvYmFsUG9pbnRlck1vdmUoZTogUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmlzRHJhZ2dpbmcpIHJldHVybjtcblxuICAgIGNvbnN0IGRlbHRhWSA9IGUuY2xpZW50WSAtIHRoaXMuZHJhZ1N0YXJ0WTtcbiAgICBjb25zdCB0cmFja0hlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuICAgIGNvbnN0IHRodW1iSGVpZ2h0ID0gdGhpcy5nZXRUaHVtYkhlaWdodCgpO1xuICAgIGNvbnN0IHNjcm9sbGFibGVUcmFja0hlaWdodCA9IHRyYWNrSGVpZ2h0IC0gdGh1bWJIZWlnaHQ7XG5cbiAgICBpZiAoc2Nyb2xsYWJsZVRyYWNrSGVpZ2h0IDw9IDApIHJldHVybjtcblxuICAgIGNvbnN0IHNjcm9sbERlbHRhID0gKGRlbHRhWSAvIHNjcm9sbGFibGVUcmFja0hlaWdodCkgKiB0aGlzLm1heFNjcm9sbFk7XG4gICAgdGhpcy5zY3JvbGxZID0gdGhpcy5kcmFnU3RhcnRTY3JvbGxZICsgc2Nyb2xsRGVsdGE7XG4gICAgdGhpcy5zY3JvbGxZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4odGhpcy5tYXhTY3JvbGxZLCB0aGlzLnNjcm9sbFkpKTtcblxuICAgIHRoaXMudXBkYXRlQ29udGVudFBvc2l0aW9uKCk7XG4gICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGdsb2JhbCBwb2ludGVyIHVwIHRvIGVuZCBkcmFnZ2luZ1xuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVHbG9iYWxQb2ludGVyVXAoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNEcmFnZ2luZykge1xuICAgICAgdGhpcy5pc0RyYWdnaW5nID0gZmFsc2U7XG4gICAgICBpZiAoIXRoaXMuaXNIb3ZlcmluZ1RodW1iKSB7XG4gICAgICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGNvbnRlbnQgcG9zaXRpb24gYmFzZWQgb24gc2Nyb2xsXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZUNvbnRlbnRQb3NpdGlvbigpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIueSA9IHRoaXMucHJvcHMucGFkZGluZy50b3AgLSB0aGlzLnNjcm9sbFk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlcyB0aGUgdGh1bWIgaGVpZ2h0IGJhc2VkIG9uIGNvbnRlbnQgcmF0aW9cbiAgICovXG4gIHByaXZhdGUgZ2V0VGh1bWJIZWlnaHQoKTogbnVtYmVyIHtcbiAgICBpZiAodGhpcy5jb250ZW50SGVpZ2h0IDw9IDApIHJldHVybiAwO1xuXG4gICAgY29uc3Qgdmlld3BvcnRIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodCAtIHRoaXMucHJvcHMucGFkZGluZy50b3AgLSB0aGlzLnByb3BzLnBhZGRpbmcuYm90dG9tO1xuICAgIGNvbnN0IHJhdGlvID0gdmlld3BvcnRIZWlnaHQgLyB0aGlzLmNvbnRlbnRIZWlnaHQ7XG4gICAgY29uc3QgdGh1bWJIZWlnaHQgPSBNYXRoLm1heCgzMCwgdGhpcy5wcm9wcy5oZWlnaHQgKiByYXRpbyk7XG5cbiAgICByZXR1cm4gTWF0aC5taW4odGh1bWJIZWlnaHQsIHRoaXMucHJvcHMuaGVpZ2h0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSB0aHVtYiBZIHBvc2l0aW9uXG4gICAqL1xuICBwcml2YXRlIGdldFRodW1iWSgpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLm1heFNjcm9sbFkgPD0gMCkgcmV0dXJuIDA7XG5cbiAgICBjb25zdCB0cmFja0hlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuICAgIGNvbnN0IHRodW1iSGVpZ2h0ID0gdGhpcy5nZXRUaHVtYkhlaWdodCgpO1xuICAgIGNvbnN0IHNjcm9sbGFibGVUcmFja0hlaWdodCA9IHRyYWNrSGVpZ2h0IC0gdGh1bWJIZWlnaHQ7XG5cbiAgICBjb25zdCBzY3JvbGxSYXRpbyA9IHRoaXMuc2Nyb2xsWSAvIHRoaXMubWF4U2Nyb2xsWTtcbiAgICByZXR1cm4gc2Nyb2xsUmF0aW8gKiBzY3JvbGxhYmxlVHJhY2tIZWlnaHQ7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgc2Nyb2xsYmFyIGFwcGVhcmFuY2VcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlU2Nyb2xsYmFyKCk6IHZvaWQge1xuICAgIGNvbnN0IHRyYWNrWCA9IHRoaXMucHJvcHMud2lkdGggLSB0aGlzLnByb3BzLnNjcm9sbGJhcldpZHRoO1xuICAgIGNvbnN0IHRyYWNrV2lkdGggPSB0aGlzLnByb3BzLnNjcm9sbGJhcldpZHRoO1xuICAgIGNvbnN0IHRyYWNrSGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG5cbiAgICAvLyBVcGRhdGUgdHJhY2tcbiAgICB0aGlzLnNjcm9sbGJhclRyYWNrLmNsZWFyKCk7XG4gICAgdGhpcy5zY3JvbGxiYXJUcmFjay5yZWN0KHRyYWNrWCwgMCwgdHJhY2tXaWR0aCwgdHJhY2tIZWlnaHQpO1xuICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2suZmlsbCh7IGNvbG9yOiB0aGlzLnByb3BzLnNjcm9sbGJhclRyYWNrQ29sb3IgfSk7XG5cbiAgICAvLyBVcGRhdGUgdGh1bWJcbiAgICBjb25zdCB0aHVtYkhlaWdodCA9IHRoaXMuZ2V0VGh1bWJIZWlnaHQoKTtcbiAgICBjb25zdCB0aHVtYlkgPSB0aGlzLmdldFRodW1iWSgpO1xuICAgIGNvbnN0IHRodW1iQ29sb3IgPSAodGhpcy5pc0hvdmVyaW5nVGh1bWIgfHwgdGhpcy5pc0RyYWdnaW5nKVxuICAgICAgPyB0aGlzLnByb3BzLnNjcm9sbGJhclRodW1iSG92ZXJDb2xvclxuICAgICAgOiB0aGlzLnByb3BzLnNjcm9sbGJhclRodW1iQ29sb3I7XG5cbiAgICB0aGlzLnNjcm9sbGJhclRodW1iLmNsZWFyKCk7XG5cbiAgICAvLyBPbmx5IHNob3cgdGh1bWIgaWYgY29udGVudCBpcyBzY3JvbGxhYmxlXG4gICAgaWYgKHRoaXMubWF4U2Nyb2xsWSA+IDApIHtcbiAgICAgIHRoaXMuc2Nyb2xsYmFyVGh1bWIucm91bmRSZWN0KFxuICAgICAgICB0cmFja1ggKyAyLFxuICAgICAgICB0aHVtYlkgKyAyLFxuICAgICAgICB0cmFja1dpZHRoIC0gNCxcbiAgICAgICAgdGh1bWJIZWlnaHQgLSA0LFxuICAgICAgICA0XG4gICAgICApO1xuICAgICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5maWxsKHsgY29sb3I6IHRodW1iQ29sb3IgfSk7XG4gICAgICB0aGlzLnNjcm9sbGJhclRodW1iLnZpc2libGUgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNjcm9sbGJhclRodW1iLnZpc2libGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgYXV0by1oaWRlXG4gICAgaWYgKHRoaXMucHJvcHMuc2Nyb2xsYmFyQXV0b0hpZGUgJiYgIXRoaXMuaXNEcmFnZ2luZyAmJiAhdGhpcy5pc0hvdmVyaW5nVGh1bWIpIHtcbiAgICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2suYWxwaGEgPSAwO1xuICAgICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5hbHBoYSA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2Nyb2xsYmFyVHJhY2suYWxwaGEgPSAxO1xuICAgICAgdGhpcy5zY3JvbGxiYXJUaHVtYi5hbHBoYSA9IDE7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlY2FsY3VsYXRlcyBjb250ZW50IGhlaWdodCBhbmQgbWF4IHNjcm9sbFxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVDb250ZW50Qm91bmRzKCk6IHZvaWQge1xuICAgIC8vIENhbGN1bGF0ZSBjb250ZW50IGhlaWdodCBmcm9tIGNoaWxkcmVuJ3MgY29tcHV0ZWQgbGF5b3V0c1xuICAgIGxldCBtYXhIZWlnaHQgPSAwO1xuXG4gICAgdGhpcy5jb250ZW50Q29udGFpbmVyLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkOiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IGNoaWxkQm90dG9tID0gY2hpbGQueSArIGNoaWxkLmhlaWdodDtcbiAgICAgIGlmIChjaGlsZEJvdHRvbSA+IG1heEhlaWdodCkge1xuICAgICAgICBtYXhIZWlnaHQgPSBjaGlsZEJvdHRvbTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuY29udGVudEhlaWdodCA9IG1heEhlaWdodDtcblxuICAgIGNvbnN0IHZpZXdwb3J0SGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQgLSB0aGlzLnByb3BzLnBhZGRpbmcudG9wIC0gdGhpcy5wcm9wcy5wYWRkaW5nLmJvdHRvbTtcbiAgICB0aGlzLm1heFNjcm9sbFkgPSBNYXRoLm1heCgwLCB0aGlzLmNvbnRlbnRIZWlnaHQgLSB2aWV3cG9ydEhlaWdodCk7XG5cbiAgICAvLyBDbGFtcCBjdXJyZW50IHNjcm9sbCBwb3NpdGlvblxuICAgIHRoaXMuc2Nyb2xsWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMubWF4U2Nyb2xsWSwgdGhpcy5zY3JvbGxZKSk7XG5cbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRQb3NpdGlvbigpO1xuICAgIHRoaXMudXBkYXRlU2Nyb2xsYmFyKCk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIGNoaWxkIHRvIHRoZSBzY3JvbGxhYmxlIGNvbnRlbnRcbiAgICovXG4gIGFkZENoaWxkKGNoaWxkOiBVSUNvbXBvbmVudCk6IHZvaWQge1xuICAgIC8vIFNldCBwYXJlbnQgcmVmZXJlbmNlIGZvciBzY3JvbGwtaW50by12aWV3IHN1cHBvcnRcbiAgICBjaGlsZC5wYXJlbnQgPSB0aGlzIGFzIGFueTtcblxuICAgIC8vIFRyYWNrIGNoaWxkIGZvciBmb2N1cyBtYW5hZ2VyIGRpc2NvdmVyeVxuICAgIHRoaXMuY2hpbGRyZW4ucHVzaChjaGlsZCk7XG5cbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIuYWRkQ2hpbGQoY2hpbGQuY29udGFpbmVyKTtcblxuICAgIC8vIExheW91dCB0aGUgY2hpbGQgd2l0aCBhdmFpbGFibGUgY29udGVudCB3aWR0aFxuICAgIGNvbnN0IGNvbnRlbnRXaWR0aCA9IHRoaXMucHJvcHMud2lkdGggLSB0aGlzLnByb3BzLnBhZGRpbmcubGVmdCAtIHRoaXMucHJvcHMucGFkZGluZy5yaWdodCAtIHRoaXMucHJvcHMuc2Nyb2xsYmFyV2lkdGg7XG4gICAgY29uc3QgY29udGVudEhlaWdodCA9IDk5OTk5OTsgLy8gQWxsb3cgdW5saW1pdGVkIGhlaWdodCBmb3Igc2Nyb2xsaW5nXG4gICAgY2hpbGQubGF5b3V0KGNvbnRlbnRXaWR0aCwgY29udGVudEhlaWdodCk7XG5cbiAgICB0aGlzLnVwZGF0ZUNvbnRlbnRCb3VuZHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGEgY2hpbGQgZnJvbSB0aGUgc2Nyb2xsYWJsZSBjb250ZW50XG4gICAqL1xuICByZW1vdmVDaGlsZChjaGlsZDogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICBjaGlsZC5wYXJlbnQgPSB1bmRlZmluZWQ7XG5cbiAgICAvLyBSZW1vdmUgZnJvbSBjaGlsZHJlbiB0cmFja2luZ1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jaGlsZHJlbi5pbmRleE9mKGNoaWxkKTtcbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuXG4gICAgdGhpcy5jb250ZW50Q29udGFpbmVyLnJlbW92ZUNoaWxkKGNoaWxkLmNvbnRhaW5lcik7XG4gICAgdGhpcy51cGRhdGVDb250ZW50Qm91bmRzKCk7XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xscyB0byBhIHNwZWNpZmljIFkgcG9zaXRpb25cbiAgICovXG4gIHNjcm9sbFRvKHk6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuc2Nyb2xsWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMubWF4U2Nyb2xsWSwgeSkpO1xuICAgIHRoaXMudXBkYXRlQ29udGVudFBvc2l0aW9uKCk7XG4gICAgdGhpcy51cGRhdGVTY3JvbGxiYXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRvIHRoZSB0b3BcbiAgICovXG4gIHNjcm9sbFRvVG9wKCk6IHZvaWQge1xuICAgIHRoaXMuc2Nyb2xsVG8oMCk7XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xscyB0byB0aGUgYm90dG9tXG4gICAqL1xuICBzY3JvbGxUb0JvdHRvbSgpOiB2b2lkIHtcbiAgICB0aGlzLnNjcm9sbFRvKHRoaXMubWF4U2Nyb2xsWSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCBzY3JvbGwgcG9zaXRpb25cbiAgICovXG4gIGdldFNjcm9sbFkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5zY3JvbGxZO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIG1heGltdW0gc2Nyb2xsIHBvc2l0aW9uXG4gICAqL1xuICBnZXRNYXhTY3JvbGxZKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMubWF4U2Nyb2xsWTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRvIG1ha2UgYSBjaGlsZCBjb21wb25lbnQgdmlzaWJsZVxuICAgKi9cbiAgc2Nyb2xsVG9Db21wb25lbnQoY29tcG9uZW50OiBVSUNvbXBvbmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGNvbXBvbmVudEJvdW5kcyA9IGNvbXBvbmVudC5nZXRHbG9iYWxCb3VuZHMoKTtcbiAgICBjb25zdCBjb250YWluZXJCb3VuZHMgPSB0aGlzLmdldEdsb2JhbEJvdW5kcygpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGNvbXBvbmVudCBwb3NpdGlvbiByZWxhdGl2ZSB0byBzY3JvbGwgY29udGFpbmVyJ3MgY29udGVudCBhcmVhXG4gICAgY29uc3QgcmVsYXRpdmVZID0gY29tcG9uZW50Qm91bmRzLnkgLSBjb250YWluZXJCb3VuZHMueSAtIHRoaXMucHJvcHMucGFkZGluZy50b3AgKyB0aGlzLnNjcm9sbFk7XG4gICAgY29uc3Qgdmlld3BvcnRIZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodCAtIHRoaXMucHJvcHMucGFkZGluZy50b3AgLSB0aGlzLnByb3BzLnBhZGRpbmcuYm90dG9tO1xuXG4gICAgLy8gQ2hlY2sgaWYgY29tcG9uZW50IGlzIGFib3ZlIHZpZXdwb3J0XG4gICAgaWYgKHJlbGF0aXZlWSA8IHRoaXMuc2Nyb2xsWSkge1xuICAgICAgLy8gU2Nyb2xsIHVwIHRvIHNob3cgY29tcG9uZW50IGF0IHRvcFxuICAgICAgdGhpcy5zY3JvbGxUbyhyZWxhdGl2ZVkpO1xuICAgIH1cbiAgICAvLyBDaGVjayBpZiBjb21wb25lbnQgaXMgYmVsb3cgdmlld3BvcnRcbiAgICBlbHNlIGlmIChyZWxhdGl2ZVkgKyBjb21wb25lbnRCb3VuZHMuaGVpZ2h0ID4gdGhpcy5zY3JvbGxZICsgdmlld3BvcnRIZWlnaHQpIHtcbiAgICAgIC8vIFNjcm9sbCBkb3duIHRvIHNob3cgY29tcG9uZW50IGF0IGJvdHRvbVxuICAgICAgY29uc3QgdGFyZ2V0U2Nyb2xsID0gcmVsYXRpdmVZICsgY29tcG9uZW50Qm91bmRzLmhlaWdodCAtIHZpZXdwb3J0SGVpZ2h0O1xuICAgICAgdGhpcy5zY3JvbGxUbyh0YXJnZXRTY3JvbGwpO1xuICAgIH1cbiAgICAvLyBDb21wb25lbnQgaXMgYWxyZWFkeSB2aXNpYmxlLCBubyBuZWVkIHRvIHNjcm9sbFxuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmVzIHRoZSBzaXplIG5lZWRlZCBmb3IgdGhpcyBjb250YWluZXJcbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBsYXlvdXQgZm9yIHRoaXMgY29udGFpbmVyXG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuXG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgdGhpcy51cGRhdGVDb250ZW50Qm91bmRzKCk7XG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgY29udGFpbmVyXG4gICAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIC8vIFJlbmRlcmluZyBoYW5kbGVkIGJ5IGJhY2tncm91bmQsIGNvbnRlbnQsIG1hc2ssIGFuZCBzY3JvbGxiYXJcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIHdoZW4gZGVzdHJveWluZ1xuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIHRoaXMuaGFuZGxlR2xvYmFsUG9pbnRlck1vdmUuYmluZCh0aGlzKSk7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgdGhpcy5oYW5kbGVHbG9iYWxQb2ludGVyVXAuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIHN1cGVyLmRlc3Ryb3koKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5pbXBvcnQgeyBVSVBhbmVsIH0gZnJvbSAnLi91aS1wYW5lbCc7XG5pbXBvcnQgeyBVSUxhYmVsIH0gZnJvbSAnLi91aS1sYWJlbCc7XG5pbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi4vY29yZS9lZGdlLWluc2V0cyc7XG5cbi8qKlxuICogT3B0aW9uIHN0cnVjdHVyZSBmb3IgU2VsZWN0IGNvbXBvbmVudFxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdE9wdGlvbiB7XG4gIC8qKiBEaXNwbGF5IHRleHQgZm9yIHRoZSBvcHRpb24gKi9cbiAgbGFiZWw6IHN0cmluZztcbiAgLyoqIFRoZSBhY3R1YWwgdmFsdWUgKi9cbiAgdmFsdWU6IGFueTtcbiAgLyoqIFdoZXRoZXIgdGhpcyBvcHRpb24gaXMgZGlzYWJsZWQgKi9cbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJU2VsZWN0XG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlTZWxlY3RQcm9wcyB7XG4gIC8qKiBBcnJheSBvZiBvcHRpb25zICovXG4gIG9wdGlvbnM6IFNlbGVjdE9wdGlvbltdO1xuICAvKiogQ3VycmVudCBzZWxlY3RlZCB2YWx1ZSAoY29udHJvbGxlZCkgKi9cbiAgdmFsdWU/OiBhbnk7XG4gIC8qKiBEZWZhdWx0IHNlbGVjdGVkIHZhbHVlICh1bmNvbnRyb2xsZWQpICovXG4gIGRlZmF1bHRWYWx1ZT86IGFueTtcbiAgLyoqIENoYW5nZSBjYWxsYmFjayAqL1xuICBvbkNoYW5nZT86ICh2YWx1ZTogYW55KSA9PiB2b2lkO1xuICAvKiogV2lkdGggb2YgdGhlIHNlbGVjdCAqL1xuICB3aWR0aD86IG51bWJlcjtcbiAgLyoqIEhlaWdodCBvZiB0aGUgc2VsZWN0ICovXG4gIGhlaWdodD86IG51bWJlcjtcbiAgLyoqIFBsYWNlaG9sZGVyIHRleHQgd2hlbiBub3RoaW5nIHNlbGVjdGVkICovXG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xuICAvKiogV2hldGhlciB0aGUgc2VsZWN0IGlzIGRpc2FibGVkICovXG4gIGRpc2FibGVkPzogYm9vbGVhbjtcbiAgLyoqIEJhY2tncm91bmQgY29sb3IgKi9cbiAgYmFja2dyb3VuZENvbG9yPzogbnVtYmVyO1xuICAvKiogVGV4dCBjb2xvciAqL1xuICB0ZXh0Q29sb3I/OiBudW1iZXI7XG4gIC8qKiBCb3JkZXIgcmFkaXVzICovXG4gIGJvcmRlclJhZGl1cz86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBIHNlbGVjdC9kcm9wZG93biBjb21wb25lbnQgd2l0aCBvcHRpb25zXG4gKiBGb2xsb3dzIEFudCBEZXNpZ24ncyBkYXRhLWRyaXZlbiBwYXR0ZXJuXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHNlbGVjdCA9IG5ldyBVSVNlbGVjdCh7XG4gKiAgIG9wdGlvbnM6IFtcbiAqICAgICB7IGxhYmVsOiAnT3B0aW9uIDEnLCB2YWx1ZTogMSB9LFxuICogICAgIHsgbGFiZWw6ICdPcHRpb24gMicsIHZhbHVlOiAyIH0sXG4gKiAgICAgeyBsYWJlbDogJ09wdGlvbiAzJywgdmFsdWU6IDMgfVxuICogICBdLFxuICogICBwbGFjZWhvbGRlcjogJ0Nob29zZSBhbiBvcHRpb24nLFxuICogICBvbkNoYW5nZTogKHZhbHVlKSA9PiBjb25zb2xlLmxvZygnU2VsZWN0ZWQ6JywgdmFsdWUpXG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlTZWxlY3QgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgcHJvcHM6IFJlcXVpcmVkPE9taXQ8VUlTZWxlY3RQcm9wcywgJ29uQ2hhbmdlJyB8ICd2YWx1ZScgfCAnZGVmYXVsdFZhbHVlJz4+O1xuICBwcml2YXRlIG9uQ2hhbmdlPzogKHZhbHVlOiBhbnkpID0+IHZvaWQ7XG5cbiAgcHJpdmF0ZSBzZWxlY3RlZFZhbHVlOiBhbnk7XG4gIHByaXZhdGUgYmFja2dyb3VuZDogVUlQYW5lbDtcbiAgcHJpdmF0ZSBsYWJlbDogVUlMYWJlbDtcbiAgcHJpdmF0ZSBkcm9wZG93bkNvbnRhaW5lcj86IFBJWEkuQ29udGFpbmVyO1xuICBwcml2YXRlIGRyb3Bkb3duUGFuZWw/OiBVSVBhbmVsO1xuICBwcml2YXRlIG9wdGlvbkxhYmVsczogVUlMYWJlbFtdID0gW107XG4gIHByaXZhdGUgaXNPcGVuOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBob3ZlckNvbG9yOiBudW1iZXI7XG4gIHByaXZhdGUgc2VsZWN0ZWRDb2xvcjogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSVNlbGVjdFByb3BzLCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIG9wdGlvbnM6IHByb3BzLm9wdGlvbnMgPz8gW10sXG4gICAgICBwbGFjZWhvbGRlcjogcHJvcHMucGxhY2Vob2xkZXIgPz8gJ1NlbGVjdC4uLicsXG4gICAgICB3aWR0aDogcHJvcHMud2lkdGggPz8gMjAwLFxuICAgICAgaGVpZ2h0OiBwcm9wcy5oZWlnaHQgPz8gMzYsXG4gICAgICBkaXNhYmxlZDogcHJvcHMuZGlzYWJsZWQgPz8gZmFsc2UsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHByb3BzLmJhY2tncm91bmRDb2xvciA/PyAweGZmZmZmZixcbiAgICAgIHRleHRDb2xvcjogcHJvcHMudGV4dENvbG9yID8/IDB4MDAwMDAwLFxuICAgICAgYm9yZGVyUmFkaXVzOiBwcm9wcy5ib3JkZXJSYWRpdXMgPz8gNFxuICAgIH07XG5cbiAgICB0aGlzLm9uQ2hhbmdlID0gcHJvcHMub25DaGFuZ2U7XG4gICAgdGhpcy5zZWxlY3RlZFZhbHVlID0gcHJvcHMudmFsdWUgPz8gcHJvcHMuZGVmYXVsdFZhbHVlO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGNvbG9yc1xuICAgIHRoaXMuaG92ZXJDb2xvciA9IHRoaXMuZGFya2VuQ29sb3IodGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsIDAuOTUpO1xuICAgIHRoaXMuc2VsZWN0ZWRDb2xvciA9IHRoaXMuZGFya2VuQ29sb3IodGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsIDAuOSk7XG5cbiAgICAvLyBTZXQgYm94IG1vZGVsIGRpbWVuc2lvbnNcbiAgICB0aGlzLmJveE1vZGVsLndpZHRoID0gdGhpcy5wcm9wcy53aWR0aDtcbiAgICB0aGlzLmJveE1vZGVsLmhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuXG4gICAgLy8gQ3JlYXRlIGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuYmFja2dyb3VuZC5jb250YWluZXIpO1xuXG4gICAgLy8gQ3JlYXRlIGxhYmVsIGZvciBzZWxlY3RlZCB2YWx1ZVxuICAgIGNvbnN0IGRpc3BsYXlUZXh0ID0gdGhpcy5nZXREaXNwbGF5VGV4dCgpO1xuICAgIHRoaXMubGFiZWwgPSBuZXcgVUlMYWJlbCh7XG4gICAgICB0ZXh0OiBkaXNwbGF5VGV4dCxcbiAgICAgIGZvbnRTaXplOiAxNCxcbiAgICAgIGNvbG9yOiB0aGlzLnNlbGVjdGVkVmFsdWUgPyB0aGlzLnByb3BzLnRleHRDb2xvciA6IDB4OTk5OTk5LFxuICAgICAgYWxpZ246ICdsZWZ0J1xuICAgIH0sIHtcbiAgICAgIHBhZGRpbmc6IEVkZ2VJbnNldHMuc3ltbWV0cmljKDgsIDEyKVxuICAgIH0pO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMubGFiZWwuY29udGFpbmVyKTtcblxuICAgIC8vIFNldHVwIGludGVyYWN0aXZpdHlcbiAgICB0aGlzLnNldHVwSW50ZXJhY3Rpdml0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGRpc3BsYXkgdGV4dCBiYXNlZCBvbiBzZWxlY3RlZCB2YWx1ZVxuICAgKi9cbiAgcHJpdmF0ZSBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xuICAgIGlmICghdGhpcy5zZWxlY3RlZFZhbHVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5wcm9wcy5wbGFjZWhvbGRlcjtcbiAgICB9XG5cbiAgICBjb25zdCBvcHRpb24gPSB0aGlzLnByb3BzLm9wdGlvbnMuZmluZChvcHQgPT4gb3B0LnZhbHVlID09PSB0aGlzLnNlbGVjdGVkVmFsdWUpO1xuICAgIHJldHVybiBvcHRpb24gPyBvcHRpb24ubGFiZWwgOiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgbW91c2UvdG91Y2ggZXZlbnQgaGFuZGxlcnNcbiAgICovXG4gIHByaXZhdGUgc2V0dXBJbnRlcmFjdGl2aXR5KCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgIHRoaXMuY29udGFpbmVyLmN1cnNvciA9ICdwb2ludGVyJztcblxuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVyZG93bicsIHRoaXMuaGFuZGxlUG9pbnRlckRvd24uYmluZCh0aGlzKSk7XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJEb3duKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLmRpc2FibGVkKSByZXR1cm47XG5cbiAgICBpZiAodGhpcy5pc09wZW4pIHtcbiAgICAgIHRoaXMuY2xvc2VEcm9wZG93bigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9wZW5Ecm9wZG93bigpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBPcGVucyB0aGUgZHJvcGRvd24gbWVudVxuICAgKi9cbiAgcHJpdmF0ZSBvcGVuRHJvcGRvd24oKTogdm9pZCB7XG4gICAgdGhpcy5pc09wZW4gPSB0cnVlO1xuXG4gICAgLy8gQ3JlYXRlIGRyb3Bkb3duIGNvbnRhaW5lclxuICAgIHRoaXMuZHJvcGRvd25Db250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICB0aGlzLmRyb3Bkb3duQ29udGFpbmVyLnBvc2l0aW9uLnNldCgwLCB0aGlzLnByb3BzLmhlaWdodCArIDQpO1xuXG4gICAgLy8gQ3JlYXRlIGRyb3Bkb3duIHBhbmVsXG4gICAgY29uc3QgZHJvcGRvd25IZWlnaHQgPSBNYXRoLm1pbih0aGlzLnByb3BzLm9wdGlvbnMubGVuZ3RoICogMzIsIDIwMCk7XG4gICAgdGhpcy5kcm9wZG93blBhbmVsID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiBkcm9wZG93bkhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgICB0aGlzLmRyb3Bkb3duQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuZHJvcGRvd25QYW5lbC5jb250YWluZXIpO1xuXG4gICAgLy8gQ3JlYXRlIG9wdGlvbiBsYWJlbHNcbiAgICB0aGlzLm9wdGlvbkxhYmVscyA9IFtdO1xuICAgIHRoaXMucHJvcHMub3B0aW9ucy5mb3JFYWNoKChvcHRpb24sIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBvcHRpb25Db250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICAgIG9wdGlvbkNvbnRhaW5lci5wb3NpdGlvbi5zZXQoMCwgaW5kZXggKiAzMik7XG5cbiAgICAgIC8vIE9wdGlvbiBiYWNrZ3JvdW5kXG4gICAgICBjb25zdCBvcHRpb25CZyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgICBvcHRpb25CZy5yZWN0KDAsIDAsIHRoaXMucHJvcHMud2lkdGgsIDMyKTtcbiAgICAgIG9wdGlvbkJnLmZpbGwoeyBjb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsIGFscGhhOiAwIH0pO1xuICAgICAgb3B0aW9uQ29udGFpbmVyLmFkZENoaWxkKG9wdGlvbkJnKTtcblxuICAgICAgLy8gT3B0aW9uIGxhYmVsXG4gICAgICBjb25zdCBvcHRpb25MYWJlbCA9IG5ldyBVSUxhYmVsKHtcbiAgICAgICAgdGV4dDogb3B0aW9uLmxhYmVsLFxuICAgICAgICBmb250U2l6ZTogMTQsXG4gICAgICAgIGNvbG9yOiBvcHRpb24uZGlzYWJsZWQgPyAweDk5OTk5OSA6IHRoaXMucHJvcHMudGV4dENvbG9yLFxuICAgICAgICBhbGlnbjogJ2xlZnQnXG4gICAgICB9LCB7XG4gICAgICAgIHBhZGRpbmc6IEVkZ2VJbnNldHMuc3ltbWV0cmljKDgsIDEyKVxuICAgICAgfSk7XG4gICAgICBvcHRpb25MYWJlbC5sYXlvdXQodGhpcy5wcm9wcy53aWR0aCwgMzIpO1xuICAgICAgb3B0aW9uQ29udGFpbmVyLmFkZENoaWxkKG9wdGlvbkxhYmVsLmNvbnRhaW5lcik7XG5cbiAgICAgIGlmICghb3B0aW9uLmRpc2FibGVkKSB7XG4gICAgICAgIG9wdGlvbkNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICAgICAgb3B0aW9uQ29udGFpbmVyLmN1cnNvciA9ICdwb2ludGVyJztcblxuICAgICAgICAvLyBIb3ZlciBlZmZlY3RcbiAgICAgICAgb3B0aW9uQ29udGFpbmVyLm9uKCdwb2ludGVyb3ZlcicsICgpID0+IHtcbiAgICAgICAgICBvcHRpb25CZy5jbGVhcigpO1xuICAgICAgICAgIG9wdGlvbkJnLnJlY3QoMCwgMCwgdGhpcy5wcm9wcy53aWR0aCwgMzIpO1xuICAgICAgICAgIG9wdGlvbkJnLmZpbGwoeyBjb2xvcjogdGhpcy5ob3ZlckNvbG9yIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBvcHRpb25Db250YWluZXIub24oJ3BvaW50ZXJvdXQnLCAoKSA9PiB7XG4gICAgICAgICAgb3B0aW9uQmcuY2xlYXIoKTtcbiAgICAgICAgICBvcHRpb25CZy5yZWN0KDAsIDAsIHRoaXMucHJvcHMud2lkdGgsIDMyKTtcbiAgICAgICAgICBvcHRpb25CZy5maWxsKHsgY29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLCBhbHBoYTogMCB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2xpY2sgaGFuZGxlclxuICAgICAgICBvcHRpb25Db250YWluZXIub24oJ3BvaW50ZXJkb3duJywgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuc2VsZWN0T3B0aW9uKG9wdGlvbi52YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmRyb3Bkb3duQ29udGFpbmVyIS5hZGRDaGlsZChvcHRpb25Db250YWluZXIpO1xuICAgICAgdGhpcy5vcHRpb25MYWJlbHMucHVzaChvcHRpb25MYWJlbCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmRyb3Bkb3duQ29udGFpbmVyKTtcblxuICAgIC8vIEFkZCBjbGljayBvdXRzaWRlIGxpc3RlbmVyXG4gICAgdGhpcy5zZXR1cENsaWNrT3V0c2lkZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIENsb3NlcyB0aGUgZHJvcGRvd24gbWVudVxuICAgKi9cbiAgcHJpdmF0ZSBjbG9zZURyb3Bkb3duKCk6IHZvaWQge1xuICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7XG5cbiAgICBpZiAodGhpcy5kcm9wZG93bkNvbnRhaW5lcikge1xuICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5kcm9wZG93bkNvbnRhaW5lcik7XG4gICAgICB0aGlzLmRyb3Bkb3duQ29udGFpbmVyID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5kcm9wZG93blBhbmVsID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5vcHRpb25MYWJlbHMgPSBbXTtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgY2xpY2sgb3V0c2lkZSBsaXN0ZW5lclxuICAgIHRoaXMucmVtb3ZlQ2xpY2tPdXRzaWRlKCk7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0cyBhbiBvcHRpb25cbiAgICovXG4gIHByaXZhdGUgc2VsZWN0T3B0aW9uKHZhbHVlOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLnNlbGVjdGVkVmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLmxhYmVsLnNldFRleHQodGhpcy5nZXREaXNwbGF5VGV4dCgpKTtcbiAgICB0aGlzLmxhYmVsLnNldENvbG9yKHRoaXMucHJvcHMudGV4dENvbG9yKTtcblxuICAgIHRoaXMub25DaGFuZ2U/Lih2YWx1ZSk7XG4gICAgdGhpcy5jbG9zZURyb3Bkb3duKCk7XG4gIH1cblxuICAvKipcbiAgICogU2V0dXAgY2xpY2sgb3V0c2lkZSBkZXRlY3Rpb25cbiAgICovXG4gIHByaXZhdGUgc2V0dXBDbGlja091dHNpZGUoKTogdm9pZCB7XG4gICAgLy8gU2ltcGxlIGFwcHJvYWNoOiBjbG9zZSBvbiBhbnkgb3V0c2lkZSBjbGlja1xuICAgIGNvbnN0IHN0YWdlID0gdGhpcy5jb250YWluZXIucGFyZW50O1xuICAgIGlmIChzdGFnZSkge1xuICAgICAgc3RhZ2UuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgICBzdGFnZS5vbmNlKCdwb2ludGVyZG93bicsIChlKSA9PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIGNsaWNrIGlzIG91dHNpZGVcbiAgICAgICAgY29uc3QgcG9pbnQgPSBlLmdsb2JhbDtcbiAgICAgICAgY29uc3QgYm91bmRzID0gdGhpcy5jb250YWluZXIuZ2V0Qm91bmRzKCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgcG9pbnQgaXMgd2l0aGluIGJvdW5kcyBtYW51YWxseVxuICAgICAgICBpZiAocG9pbnQueCA8IGJvdW5kcy54IHx8IHBvaW50LnggPiBib3VuZHMueCArIGJvdW5kcy53aWR0aCB8fFxuICAgICAgICAgICAgcG9pbnQueSA8IGJvdW5kcy55IHx8IHBvaW50LnkgPiBib3VuZHMueSArIGJvdW5kcy5oZWlnaHQpIHtcbiAgICAgICAgICB0aGlzLmNsb3NlRHJvcGRvd24oKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBjbGljayBvdXRzaWRlIGRldGVjdGlvblxuICAgKi9cbiAgcHJpdmF0ZSByZW1vdmVDbGlja091dHNpZGUoKTogdm9pZCB7XG4gICAgLy8gSGFuZGxlZCBieSAnb25jZScgaW4gc2V0dXBDbGlja091dHNpZGVcbiAgfVxuXG4gIC8qKlxuICAgKiBEYXJrZW5zIGEgY29sb3IgYnkgYSBmYWN0b3JcbiAgICovXG4gIHByaXZhdGUgZGFya2VuQ29sb3IoY29sb3I6IG51bWJlciwgZmFjdG9yOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IHIgPSAoKGNvbG9yID4+IDE2KSAmIDB4ZmYpICogZmFjdG9yO1xuICAgIGNvbnN0IGcgPSAoKGNvbG9yID4+IDgpICYgMHhmZikgKiBmYWN0b3I7XG4gICAgY29uc3QgYiA9IChjb2xvciAmIDB4ZmYpICogZmFjdG9yO1xuICAgIHJldHVybiAoKHIgPDwgMTYpIHwgKGcgPDwgOCkgfCBiKSA+Pj4gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgc2VsZWN0XG4gICAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIHNlbGVjdFxuICAgKi9cbiAgbGF5b3V0KGF2YWlsYWJsZVdpZHRoOiBudW1iZXIsIGF2YWlsYWJsZUhlaWdodDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgbWVhc3VyZWQgPSB0aGlzLm1lYXN1cmUoKTtcblxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IG1lYXN1cmVkLmhlaWdodDtcblxuICAgIC8vIExheW91dCBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kLmxheW91dChtZWFzdXJlZC53aWR0aCwgbWVhc3VyZWQuaGVpZ2h0KTtcblxuICAgIC8vIExheW91dCBsYWJlbFxuICAgIHRoaXMubGFiZWwubGF5b3V0KG1lYXN1cmVkLndpZHRoLCBtZWFzdXJlZC5oZWlnaHQpO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgc2VsZWN0XG4gICAqL1xuICBwcm90ZWN0ZWQgcmVuZGVyKCk6IHZvaWQge1xuICAgIC8vIFJlbmRlcmluZyBoYW5kbGVkIGJ5IGJhY2tncm91bmQgYW5kIGxhYmVsXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgc2VsZWN0ZWQgdmFsdWUgcHJvZ3JhbW1hdGljYWxseVxuICAgKi9cbiAgc2V0VmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xuICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMubGFiZWwuc2V0VGV4dCh0aGlzLmdldERpc3BsYXlUZXh0KCkpO1xuICAgIHRoaXMubGFiZWwuc2V0Q29sb3IodGhpcy5wcm9wcy50ZXh0Q29sb3IpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgc2VsZWN0ZWQgdmFsdWVcbiAgICovXG4gIGdldFZhbHVlKCk6IGFueSB7XG4gICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRWYWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBvcHRpb25zXG4gICAqL1xuICBzZXRPcHRpb25zKG9wdGlvbnM6IFNlbGVjdE9wdGlvbltdKTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICBpZiAodGhpcy5pc09wZW4pIHtcbiAgICAgIHRoaXMuY2xvc2VEcm9wZG93bigpO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSAnLi4vY29yZS91aS1jb21wb25lbnQnO1xuaW1wb3J0IHsgQm94TW9kZWwsIE1lYXN1cmVkU2l6ZSB9IGZyb20gJy4uL2NvcmUvYm94LW1vZGVsJztcbmltcG9ydCB7IFVJTGFiZWwgfSBmcm9tICcuL3VpLWxhYmVsJztcbmltcG9ydCB7IFVJUGFuZWwgfSBmcm9tICcuL3VpLXBhbmVsJztcblxuZXhwb3J0IGludGVyZmFjZSBUYWJJdGVtIHtcbiAga2V5OiBzdHJpbmc7XG4gIGxhYmVsOiBzdHJpbmc7XG4gIGNvbnRlbnQ6IFVJQ29tcG9uZW50O1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVUlUYWJzUHJvcHMge1xuICBpdGVtczogVGFiSXRlbVtdO1xuICBhY3RpdmVLZXk/OiBzdHJpbmc7XG4gIGRlZmF1bHRBY3RpdmVLZXk/OiBzdHJpbmc7XG4gIG9uQ2hhbmdlPzogKGFjdGl2ZUtleTogc3RyaW5nKSA9PiB2b2lkO1xuICB0eXBlPzogJ2xpbmUnIHwgJ2NhcmQnO1xuICB0YWJQb3NpdGlvbj86ICd0b3AnIHwgJ2JvdHRvbSc7XG4gIHdpZHRoPzogbnVtYmVyO1xuICBoZWlnaHQ/OiBudW1iZXI7XG4gIHRhYkJhckJhY2tncm91bmRDb2xvcj86IG51bWJlcjtcbiAgdGFiQmFySGVpZ2h0PzogbnVtYmVyO1xuICBhY3RpdmVUYWJDb2xvcj86IG51bWJlcjtcbiAgaW5hY3RpdmVUYWJDb2xvcj86IG51bWJlcjtcbiAgdGV4dENvbG9yPzogbnVtYmVyO1xuICBhY3RpdmVUZXh0Q29sb3I/OiBudW1iZXI7XG4gIGhhc2hQcmVmaXg/OiBzdHJpbmc7IC8vIGUuZy4sIFwidWktc2hvd2Nhc2VcIiBjcmVhdGVzIFVSTHMgbGlrZSAjdWktc2hvd2Nhc2UvYmFzaWNzXG59XG5cbmV4cG9ydCBjbGFzcyBVSVRhYnMgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG4gIHByaXZhdGUgaXRlbXM6IFRhYkl0ZW1bXTtcbiAgcHJpdmF0ZSBhY3RpdmVLZXk6IHN0cmluZztcbiAgcHJpdmF0ZSBvbkNoYW5nZT86IChhY3RpdmVLZXk6IHN0cmluZykgPT4gdm9pZDtcbiAgcHJpdmF0ZSB0eXBlOiAnbGluZScgfCAnY2FyZCc7XG4gIHByaXZhdGUgdGFiUG9zaXRpb246ICd0b3AnIHwgJ2JvdHRvbSc7XG4gIHByaXZhdGUgd2lkdGg6IG51bWJlcjtcbiAgcHJpdmF0ZSBoZWlnaHQ6IG51bWJlcjtcbiAgcHJpdmF0ZSB0YWJCYXJCYWNrZ3JvdW5kQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSB0YWJCYXJIZWlnaHQ6IG51bWJlcjtcbiAgcHJpdmF0ZSBhY3RpdmVUYWJDb2xvcjogbnVtYmVyO1xuICBwcml2YXRlIGluYWN0aXZlVGFiQ29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSB0ZXh0Q29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBhY3RpdmVUZXh0Q29sb3I6IG51bWJlcjtcbiAgcHJpdmF0ZSBoYXNoUHJlZml4Pzogc3RyaW5nO1xuXG4gIHByaXZhdGUgdGFiQmFyOiBQSVhJLkNvbnRhaW5lcjtcbiAgcHJpdmF0ZSBjb250ZW50QXJlYTogUElYSS5Db250YWluZXI7XG4gIHByaXZhdGUgdGFiQnV0dG9uczogTWFwPHN0cmluZywgeyBjb250YWluZXI6IFBJWEkuQ29udGFpbmVyOyBsYWJlbDogVUlMYWJlbDsgYmc6IFBJWEkuR3JhcGhpY3MgfT4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgYWN0aXZlSW5kaWNhdG9yPzogUElYSS5HcmFwaGljcztcbiAgcHJpdmF0ZSBoYXNoQ2hhbmdlSGFuZGxlcj86ICgpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJVGFic1Byb3BzLCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5pdGVtcyA9IHByb3BzLml0ZW1zIHx8IFtdO1xuICAgIHRoaXMub25DaGFuZ2UgPSBwcm9wcy5vbkNoYW5nZTtcbiAgICB0aGlzLnR5cGUgPSBwcm9wcy50eXBlIHx8ICdsaW5lJztcbiAgICB0aGlzLnRhYlBvc2l0aW9uID0gcHJvcHMudGFiUG9zaXRpb24gfHwgJ3RvcCc7XG4gICAgdGhpcy50YWJCYXJCYWNrZ3JvdW5kQ29sb3IgPSBwcm9wcy50YWJCYXJCYWNrZ3JvdW5kQ29sb3IgPz8gMHgyZDJkNDQ7XG4gICAgdGhpcy50YWJCYXJIZWlnaHQgPSBwcm9wcy50YWJCYXJIZWlnaHQgPz8gNDg7XG4gICAgdGhpcy5hY3RpdmVUYWJDb2xvciA9IHByb3BzLmFjdGl2ZVRhYkNvbG9yID8/IDB4MTg5MGZmO1xuICAgIHRoaXMuaW5hY3RpdmVUYWJDb2xvciA9IHByb3BzLmluYWN0aXZlVGFiQ29sb3IgPz8gMHgzZDNkNTQ7XG4gICAgdGhpcy50ZXh0Q29sb3IgPSBwcm9wcy50ZXh0Q29sb3IgPz8gMHhhYWFhYWE7XG4gICAgdGhpcy5hY3RpdmVUZXh0Q29sb3IgPSBwcm9wcy5hY3RpdmVUZXh0Q29sb3IgPz8gMHhmZmZmZmY7XG4gICAgdGhpcy5oYXNoUHJlZml4ID0gcHJvcHMuaGFzaFByZWZpeDtcblxuICAgIC8vIERldGVybWluZSBhY3RpdmUga2V5IC0gY2hlY2sgVVJMIGhhc2ggZmlyc3QgaWYgaGFzaFByZWZpeCBpcyBwcm92aWRlZFxuICAgIGxldCBpbml0aWFsS2V5ID0gcHJvcHMuYWN0aXZlS2V5IHx8IHByb3BzLmRlZmF1bHRBY3RpdmVLZXkgfHwgKHRoaXMuaXRlbXMubGVuZ3RoID4gMCA/IHRoaXMuaXRlbXNbMF0ua2V5IDogJycpO1xuICAgIGlmICh0aGlzLmhhc2hQcmVmaXggJiYgIXByb3BzLmFjdGl2ZUtleSkge1xuICAgICAgY29uc3QgaGFzaEtleSA9IHRoaXMuZ2V0S2V5RnJvbUhhc2goKTtcbiAgICAgIGlmIChoYXNoS2V5ICYmIHRoaXMuaXRlbXMuZmluZChpdGVtID0+IGl0ZW0ua2V5ID09PSBoYXNoS2V5KSkge1xuICAgICAgICBpbml0aWFsS2V5ID0gaGFzaEtleTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5hY3RpdmVLZXkgPSBpbml0aWFsS2V5O1xuXG4gICAgdGhpcy53aWR0aCA9IHByb3BzLndpZHRoID8/IDgwMDtcbiAgICB0aGlzLmhlaWdodCA9IHByb3BzLmhlaWdodCA/PyA2MDA7XG5cbiAgICB0aGlzLnRhYkJhciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgIHRoaXMuY29udGVudEFyZWEgPSBuZXcgUElYSS5Db250YWluZXIoKTtcblxuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMudGFiQmFyKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmNvbnRlbnRBcmVhKTtcblxuICAgIHRoaXMuYnVpbGRUYWJzKCk7XG4gICAgdGhpcy5zaG93QWN0aXZlVGFiKCk7XG5cbiAgICAvLyBTZXQgdXAgaGFzaCBjaGFuZ2UgbGlzdGVuZXIgaWYgaGFzaFByZWZpeCBpcyBwcm92aWRlZFxuICAgIGlmICh0aGlzLmhhc2hQcmVmaXgpIHtcbiAgICAgIHRoaXMuc2V0dXBIYXNoTGlzdGVuZXIoKTtcbiAgICAgIC8vIFVwZGF0ZSBoYXNoIHRvIG1hdGNoIGluaXRpYWwgYWN0aXZlIGtleVxuICAgICAgdGhpcy51cGRhdGVIYXNoKHRoaXMuYWN0aXZlS2V5KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEtleUZyb21IYXNoKCk6IHN0cmluZyB8IG51bGwge1xuICAgIGlmICghdGhpcy5oYXNoUHJlZml4KSByZXR1cm4gbnVsbDtcbiAgICBjb25zdCBoYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2guc2xpY2UoMSk7IC8vIFJlbW92ZSAjXG4gICAgY29uc3QgcHJlZml4ID0gYCR7dGhpcy5oYXNoUHJlZml4fS9gO1xuICAgIGlmIChoYXNoLnN0YXJ0c1dpdGgocHJlZml4KSkge1xuICAgICAgcmV0dXJuIGhhc2guc2xpY2UocHJlZml4Lmxlbmd0aCk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVIYXNoKGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmhhc2hQcmVmaXgpIHJldHVybjtcbiAgICBjb25zdCBuZXdIYXNoID0gYCMke3RoaXMuaGFzaFByZWZpeH0vJHtrZXl9YDtcbiAgICBpZiAod2luZG93LmxvY2F0aW9uLmhhc2ggIT09IG5ld0hhc2gpIHtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gbmV3SGFzaDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNldHVwSGFzaExpc3RlbmVyKCk6IHZvaWQge1xuICAgIHRoaXMuaGFzaENoYW5nZUhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICBjb25zdCBoYXNoS2V5ID0gdGhpcy5nZXRLZXlGcm9tSGFzaCgpO1xuICAgICAgaWYgKGhhc2hLZXkgJiYgaGFzaEtleSAhPT0gdGhpcy5hY3RpdmVLZXkpIHtcbiAgICAgICAgdGhpcy5zZXRBY3RpdmVLZXkoaGFzaEtleSwgZmFsc2UpOyAvLyBmYWxzZSA9IGRvbid0IHVwZGF0ZSBoYXNoIChhbHJlYWR5IGNoYW5nZWQpXG4gICAgICB9XG4gICAgfTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIHRoaXMuaGFzaENoYW5nZUhhbmRsZXIpO1xuICB9XG5cbiAgcHVibGljIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaGFzaENoYW5nZUhhbmRsZXIpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgdGhpcy5oYXNoQ2hhbmdlSGFuZGxlcik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBidWlsZFRhYnMoKTogdm9pZCB7XG4gICAgLy8gQ2xlYXIgZXhpc3RpbmcgdGFic1xuICAgIHRoaXMudGFiQmFyLnJlbW92ZUNoaWxkcmVuKCk7XG4gICAgdGhpcy50YWJCdXR0b25zLmNsZWFyKCk7XG5cbiAgICAvLyBDcmVhdGUgdGFiIGJhciBiYWNrZ3JvdW5kXG4gICAgY29uc3QgdGFiQmFyQmcgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRhYkJhckJnLnJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy50YWJCYXJIZWlnaHQpO1xuICAgIHRhYkJhckJnLmZpbGwoeyBjb2xvcjogdGhpcy50YWJCYXJCYWNrZ3JvdW5kQ29sb3IgfSk7XG4gICAgdGhpcy50YWJCYXIuYWRkQ2hpbGQodGFiQmFyQmcpO1xuXG4gICAgLy8gQWRkIGJvdHRvbSBib3JkZXIgbGluZSBmb3IgbGluZSB0eXBlXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ2xpbmUnKSB7XG4gICAgICBjb25zdCBib3JkZXJMaW5lID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICAgIGJvcmRlckxpbmUucmVjdCgwLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIHRoaXMud2lkdGgsIDIpO1xuICAgICAgYm9yZGVyTGluZS5maWxsKHsgY29sb3I6IDB4M2QzZDU0LCBhbHBoYTogMC41IH0pO1xuICAgICAgdGhpcy50YWJCYXIuYWRkQ2hpbGQoYm9yZGVyTGluZSk7XG4gICAgfVxuXG4gICAgLy8gUG9zaXRpb24gdGFiIGJhclxuICAgIGlmICh0aGlzLnRhYlBvc2l0aW9uID09PSAnYm90dG9tJykge1xuICAgICAgdGhpcy50YWJCYXIueSA9IHRoaXMuaGVpZ2h0IC0gdGhpcy50YWJCYXJIZWlnaHQ7XG4gICAgICB0aGlzLmNvbnRlbnRBcmVhLnkgPSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRhYkJhci55ID0gMDtcbiAgICAgIHRoaXMuY29udGVudEFyZWEueSA9IHRoaXMudGFiQmFySGVpZ2h0O1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSB0YWJzXG4gICAgbGV0IHhPZmZzZXQgPSA4OyAvLyBTdGFydCB3aXRoIHNvbWUgbGVmdCBwYWRkaW5nXG4gICAgY29uc3QgdGFiUGFkZGluZyA9IDI0O1xuICAgIGNvbnN0IHRhYkdhcCA9IDg7XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5pdGVtcykge1xuICAgICAgaWYgKGl0ZW0uZGlzYWJsZWQpIGNvbnRpbnVlO1xuXG4gICAgICBjb25zdCB0YWJDb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICAgIHRhYkNvbnRhaW5lci54ID0geE9mZnNldDtcblxuICAgICAgLy8gVGFiIGxhYmVsXG4gICAgICBjb25zdCBpc0FjdGl2ZSA9IHRoaXMuYWN0aXZlS2V5ID09PSBpdGVtLmtleTtcbiAgICAgIGNvbnN0IGxhYmVsID0gbmV3IFVJTGFiZWwoe1xuICAgICAgICB0ZXh0OiBpdGVtLmxhYmVsLFxuICAgICAgICBmb250U2l6ZTogMTUsXG4gICAgICAgIGZvbnRXZWlnaHQ6IGlzQWN0aXZlID8gJ2JvbGQnIDogJ25vcm1hbCcsXG4gICAgICAgIGNvbG9yOiBpc0FjdGl2ZSA/IHRoaXMuYWN0aXZlVGV4dENvbG9yIDogdGhpcy50ZXh0Q29sb3JcbiAgICAgIH0pO1xuXG4gICAgICAvLyBNZWFzdXJlIGxhYmVsIHRvIGRldGVybWluZSB0YWIgd2lkdGhcbiAgICAgIGxhYmVsLm1lYXN1cmUoKTtcbiAgICAgIGxhYmVsLmxheW91dCh0aGlzLndpZHRoLCB0aGlzLnRhYkJhckhlaWdodCk7XG4gICAgICBjb25zdCBsYWJlbEJvdW5kcyA9IGxhYmVsLmNvbnRhaW5lci5nZXRMb2NhbEJvdW5kcygpO1xuICAgICAgY29uc3QgdGFiV2lkdGggPSBsYWJlbEJvdW5kcy53aWR0aCArICh0YWJQYWRkaW5nICogMik7XG5cbiAgICAgIC8vIFRhYiBiYWNrZ3JvdW5kXG4gICAgICBsZXQgYmc6IFBJWEkuR3JhcGhpY3M7XG4gICAgICBpZiAodGhpcy50eXBlID09PSAnY2FyZCcpIHtcbiAgICAgICAgYmcgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgICAgICBiZy5yb3VuZFJlY3QoMCwgMCwgdGFiV2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgNik7XG4gICAgICAgIGJnLmZpbGwoeyBjb2xvcjogaXNBY3RpdmUgPyB0aGlzLmFjdGl2ZVRhYkNvbG9yIDogdGhpcy5pbmFjdGl2ZVRhYkNvbG9yIH0pO1xuICAgICAgICAvLyBBZGQgYm9yZGVyIGZvciBjYXJkIHR5cGVcbiAgICAgICAgYmcucm91bmRSZWN0KDAsIDAsIHRhYldpZHRoLCB0aGlzLnRhYkJhckhlaWdodCAtIDIsIDYpO1xuICAgICAgICBiZy5zdHJva2UoeyBjb2xvcjogaXNBY3RpdmUgPyB0aGlzLmFjdGl2ZVRhYkNvbG9yIDogMHg0ZDRkNjQsIHdpZHRoOiAyIH0pO1xuICAgICAgICB0YWJDb250YWluZXIuYWRkQ2hpbGQoYmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRm9yIGxpbmUgdHlwZSwgTk8gYmFja2dyb3VuZCBvciBib3JkZXIgLSBqdXN0IHRyYW5zcGFyZW50IGhpdCBhcmVhXG4gICAgICAgIGJnID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICAgICAgYmcucmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQpO1xuICAgICAgICBiZy5maWxsKHsgY29sb3I6IDB4MDAwMDAwLCBhbHBoYTogMCB9KTtcbiAgICAgICAgdGFiQ29udGFpbmVyLmFkZENoaWxkKGJnKTtcbiAgICAgIH1cblxuICAgICAgLy8gUG9zaXRpb24gbGFiZWwgY2VudGVyZWQgaW4gdGFiXG4gICAgICBsYWJlbC5jb250YWluZXIueCA9IHRhYlBhZGRpbmc7XG4gICAgICBsYWJlbC5jb250YWluZXIueSA9ICh0aGlzLnRhYkJhckhlaWdodCAtIGxhYmVsQm91bmRzLmhlaWdodCkgLyAyO1xuICAgICAgdGFiQ29udGFpbmVyLmFkZENoaWxkKGxhYmVsLmNvbnRhaW5lcik7XG5cbiAgICAgIC8vIE1ha2UgdGFiIGludGVyYWN0aXZlXG4gICAgICB0YWJDb250YWluZXIuZXZlbnRNb2RlID0gJ3N0YXRpYyc7XG4gICAgICB0YWJDb250YWluZXIuY3Vyc29yID0gJ3BvaW50ZXInO1xuXG4gICAgICBjb25zdCB0YWJLZXkgPSBpdGVtLmtleTtcbiAgICAgIHRhYkNvbnRhaW5lci5vbigncG9pbnRlcmRvd24nLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0QWN0aXZlS2V5KHRhYktleSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gSG92ZXIgZWZmZWN0XG4gICAgICB0YWJDb250YWluZXIub24oJ3BvaW50ZXJvdmVyJywgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5hY3RpdmVLZXkgIT09IHRhYktleSkge1xuICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdjYXJkJykge1xuICAgICAgICAgICAgYmcuY2xlYXIoKTtcbiAgICAgICAgICAgIGJnLnJvdW5kUmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgICAgIGJnLmZpbGwoeyBjb2xvcjogdGhpcy5hY3RpdmVUYWJDb2xvciwgYWxwaGE6IDAuNSB9KTtcbiAgICAgICAgICAgIGJnLnJvdW5kUmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgICAgIGJnLnN0cm9rZSh7IGNvbG9yOiB0aGlzLmFjdGl2ZVRhYkNvbG9yLCB3aWR0aDogMiB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRm9yIGxpbmUgdHlwZSwganVzdCBjaGFuZ2UgdGV4dCBjb2xvciBvbiBob3ZlclxuICAgICAgICAgICAgbGFiZWwuc2V0Q29sb3IodGhpcy5hY3RpdmVUZXh0Q29sb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHRhYkNvbnRhaW5lci5vbigncG9pbnRlcm91dCcsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlS2V5ICE9PSB0YWJLZXkpIHtcbiAgICAgICAgICBpZiAodGhpcy50eXBlID09PSAnY2FyZCcpIHtcbiAgICAgICAgICAgIGJnLmNsZWFyKCk7XG4gICAgICAgICAgICBiZy5yb3VuZFJlY3QoMCwgMCwgdGFiV2lkdGgsIHRoaXMudGFiQmFySGVpZ2h0IC0gMiwgNik7XG4gICAgICAgICAgICBiZy5maWxsKHsgY29sb3I6IHRoaXMuaW5hY3RpdmVUYWJDb2xvciB9KTtcbiAgICAgICAgICAgIGJnLnJvdW5kUmVjdCgwLCAwLCB0YWJXaWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgICAgIGJnLnN0cm9rZSh7IGNvbG9yOiAweDRkNGQ2NCwgd2lkdGg6IDIgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFJlc3RvcmUgbXV0ZWQgdGV4dCBjb2xvclxuICAgICAgICAgICAgbGFiZWwuc2V0Q29sb3IodGhpcy50ZXh0Q29sb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMudGFiQmFyLmFkZENoaWxkKHRhYkNvbnRhaW5lcik7XG4gICAgICB0aGlzLnRhYkJ1dHRvbnMuc2V0KGl0ZW0ua2V5LCB7IGNvbnRhaW5lcjogdGFiQ29udGFpbmVyLCBsYWJlbCwgYmcgfSk7XG5cbiAgICAgIHhPZmZzZXQgKz0gdGFiV2lkdGggKyB0YWJHYXA7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGFjdGl2ZSBpbmRpY2F0b3IgZm9yIGxpbmUgdHlwZVxuICAgIGlmICh0aGlzLnR5cGUgPT09ICdsaW5lJykge1xuICAgICAgdGhpcy5hY3RpdmVJbmRpY2F0b3IgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgICAgdGhpcy50YWJCYXIuYWRkQ2hpbGQodGhpcy5hY3RpdmVJbmRpY2F0b3IpO1xuICAgICAgdGhpcy51cGRhdGVBY3RpdmVJbmRpY2F0b3IoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUFjdGl2ZUluZGljYXRvcigpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYWN0aXZlSW5kaWNhdG9yIHx8IHRoaXMudHlwZSAhPT0gJ2xpbmUnKSByZXR1cm47XG5cbiAgICB0aGlzLmFjdGl2ZUluZGljYXRvci5jbGVhcigpO1xuXG4gICAgY29uc3QgYWN0aXZlVGFiID0gdGhpcy50YWJCdXR0b25zLmdldCh0aGlzLmFjdGl2ZUtleSk7XG4gICAgaWYgKCFhY3RpdmVUYWIpIHJldHVybjtcblxuICAgIGNvbnN0IHRhYlggPSBhY3RpdmVUYWIuY29udGFpbmVyLng7XG4gICAgY29uc3QgdGFiQm91bmRzID0gYWN0aXZlVGFiLmJnLmdldExvY2FsQm91bmRzKCk7XG4gICAgY29uc3QgdGFiV2lkdGggPSB0YWJCb3VuZHMud2lkdGg7XG4gICAgY29uc3QgaW5kaWNhdG9ySGVpZ2h0ID0gMztcbiAgICBjb25zdCBpbmRpY2F0b3JZID0gdGhpcy50YWJCYXJIZWlnaHQgLSBpbmRpY2F0b3JIZWlnaHQ7XG5cbiAgICAvLyBEcmF3IGluZGljYXRvciBhdCB0aGUgdmVyeSBib3R0b20sIHNwYW5uaW5nIG1vc3Qgb2YgdGhlIHRhYiB3aWR0aFxuICAgIHRoaXMuYWN0aXZlSW5kaWNhdG9yLnJvdW5kUmVjdCh0YWJYICsgOCwgaW5kaWNhdG9yWSwgdGFiV2lkdGggLSAxNiwgaW5kaWNhdG9ySGVpZ2h0LCAxLjUpO1xuICAgIHRoaXMuYWN0aXZlSW5kaWNhdG9yLmZpbGwoeyBjb2xvcjogdGhpcy5hY3RpdmVUYWJDb2xvciB9KTtcbiAgfVxuXG4gIHByaXZhdGUgc2hvd0FjdGl2ZVRhYigpOiB2b2lkIHtcbiAgICAvLyBDbGVhciBjb250ZW50IGFyZWFcbiAgICB0aGlzLmNvbnRlbnRBcmVhLnJlbW92ZUNoaWxkcmVuKCk7XG5cbiAgICAvLyBGaW5kIGFjdGl2ZSBpdGVtXG4gICAgY29uc3QgYWN0aXZlSXRlbSA9IHRoaXMuaXRlbXMuZmluZChpdGVtID0+IGl0ZW0ua2V5ID09PSB0aGlzLmFjdGl2ZUtleSk7XG4gICAgaWYgKCFhY3RpdmVJdGVtKSByZXR1cm47XG5cbiAgICAvLyBBZGQgY29udGVudFxuICAgIGNvbnN0IGNvbnRlbnRIZWlnaHQgPSB0aGlzLmhlaWdodCAtIHRoaXMudGFiQmFySGVpZ2h0O1xuICAgIGFjdGl2ZUl0ZW0uY29udGVudC5sYXlvdXQodGhpcy53aWR0aCwgY29udGVudEhlaWdodCk7XG4gICAgdGhpcy5jb250ZW50QXJlYS5hZGRDaGlsZChhY3RpdmVJdGVtLmNvbnRlbnQuY29udGFpbmVyKTtcblxuICAgIC8vIFVwZGF0ZSB0YWIgc3R5bGVzXG4gICAgdGhpcy50YWJCdXR0b25zLmZvckVhY2goKHRhYiwga2V5KSA9PiB7XG4gICAgICBjb25zdCBpc0FjdGl2ZSA9IGtleSA9PT0gdGhpcy5hY3RpdmVLZXk7XG4gICAgICBjb25zdCB0YWJCb3VuZHMgPSB0YWIuYmcuZ2V0TG9jYWxCb3VuZHMoKTtcblxuICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2NhcmQnKSB7XG4gICAgICAgIHRhYi5iZy5jbGVhcigpO1xuICAgICAgICB0YWIuYmcucm91bmRSZWN0KDAsIDAsIHRhYkJvdW5kcy53aWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgdGFiLmJnLmZpbGwoeyBjb2xvcjogaXNBY3RpdmUgPyB0aGlzLmFjdGl2ZVRhYkNvbG9yIDogdGhpcy5pbmFjdGl2ZVRhYkNvbG9yIH0pO1xuICAgICAgICB0YWIuYmcucm91bmRSZWN0KDAsIDAsIHRhYkJvdW5kcy53aWR0aCwgdGhpcy50YWJCYXJIZWlnaHQgLSAyLCA2KTtcbiAgICAgICAgdGFiLmJnLnN0cm9rZSh7IGNvbG9yOiBpc0FjdGl2ZSA/IHRoaXMuYWN0aXZlVGFiQ29sb3IgOiAweDRkNGQ2NCwgd2lkdGg6IDIgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGb3IgbGluZSB0eXBlLCBrZWVwIHRyYW5zcGFyZW50IGJhY2tncm91bmRcbiAgICAgICAgdGFiLmJnLmNsZWFyKCk7XG4gICAgICAgIHRhYi5iZy5yZWN0KDAsIDAsIHRhYkJvdW5kcy53aWR0aCwgdGhpcy50YWJCYXJIZWlnaHQpO1xuICAgICAgICB0YWIuYmcuZmlsbCh7IGNvbG9yOiAweDAwMDAwMCwgYWxwaGE6IDAgfSk7XG4gICAgICB9XG5cbiAgICAgIHRhYi5sYWJlbC5zZXRDb2xvcihpc0FjdGl2ZSA/IHRoaXMuYWN0aXZlVGV4dENvbG9yIDogdGhpcy50ZXh0Q29sb3IpO1xuICAgICAgdGFiLmxhYmVsLmNvbnRhaW5lci5hbHBoYSA9IDE7XG4gICAgfSk7XG5cbiAgICAvLyBVcGRhdGUgYWN0aXZlIGluZGljYXRvclxuICAgIGlmICh0aGlzLnR5cGUgPT09ICdsaW5lJykge1xuICAgICAgdGhpcy51cGRhdGVBY3RpdmVJbmRpY2F0b3IoKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgc2V0QWN0aXZlS2V5KGtleTogc3RyaW5nLCB1cGRhdGVIYXNoOiBib29sZWFuID0gdHJ1ZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLmFjdGl2ZUtleSA9PT0ga2V5KSByZXR1cm47XG5cbiAgICBjb25zdCBpdGVtID0gdGhpcy5pdGVtcy5maW5kKGl0ZW0gPT4gaXRlbS5rZXkgPT09IGtleSk7XG4gICAgaWYgKCFpdGVtIHx8IGl0ZW0uZGlzYWJsZWQpIHJldHVybjtcblxuICAgIHRoaXMuYWN0aXZlS2V5ID0ga2V5O1xuICAgIHRoaXMuc2hvd0FjdGl2ZVRhYigpO1xuXG4gICAgLy8gVXBkYXRlIFVSTCBoYXNoIGlmIGVuYWJsZWRcbiAgICBpZiAodXBkYXRlSGFzaCAmJiB0aGlzLmhhc2hQcmVmaXgpIHtcbiAgICAgIHRoaXMudXBkYXRlSGFzaChrZXkpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm9uQ2hhbmdlKSB7XG4gICAgICB0aGlzLm9uQ2hhbmdlKGtleSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGdldEFjdGl2ZUtleSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmFjdGl2ZUtleTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRJdGVtcyhpdGVtczogVGFiSXRlbVtdKTogdm9pZCB7XG4gICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xuXG4gICAgLy8gSWYgYWN0aXZlIGtleSBubyBsb25nZXIgZXhpc3RzLCBzd2l0Y2ggdG8gZmlyc3QgdGFiXG4gICAgaWYgKCF0aGlzLml0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLmtleSA9PT0gdGhpcy5hY3RpdmVLZXkpKSB7XG4gICAgICB0aGlzLmFjdGl2ZUtleSA9IHRoaXMuaXRlbXMubGVuZ3RoID4gMCA/IHRoaXMuaXRlbXNbMF0ua2V5IDogJyc7XG4gICAgfVxuXG4gICAgdGhpcy5idWlsZFRhYnMoKTtcbiAgICB0aGlzLnNob3dBY3RpdmVUYWIoKTtcbiAgfVxuXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIGxheW91dCh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcblxuICAgIC8vIFJlYnVpbGQgdGFicyB3aXRoIG5ldyBkaW1lbnNpb25zXG4gICAgdGhpcy5idWlsZFRhYnMoKTtcbiAgICB0aGlzLnNob3dBY3RpdmVUYWIoKTtcbiAgfVxuXG4gIHJlbmRlcigpOiB2b2lkIHtcbiAgICAvLyBSZW5kZXJpbmcgaXMgaGFuZGxlZCBieSBjaGlsZCBjb21wb25lbnRzXG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuaW1wb3J0IHsgVUlQYW5lbCB9IGZyb20gJy4vdWktcGFuZWwnO1xuaW1wb3J0IHsgRWRnZUluc2V0cyB9IGZyb20gJy4uL2NvcmUvZWRnZS1pbnNldHMnO1xuaW1wb3J0IHsgVUlGb2N1c01hbmFnZXIgfSBmcm9tICcuLi9jb3JlL3VpLWZvY3VzLW1hbmFnZXInO1xuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJVGV4dElucHV0XG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVUlUZXh0SW5wdXRQcm9wcyB7XG4gIC8qKiBDdXJyZW50IHZhbHVlIChjb250cm9sbGVkKSAqL1xuICB2YWx1ZT86IHN0cmluZztcbiAgLyoqIERlZmF1bHQgdmFsdWUgKHVuY29udHJvbGxlZCkgKi9cbiAgZGVmYXVsdFZhbHVlPzogc3RyaW5nO1xuICAvKiogQ2hhbmdlIGNhbGxiYWNrICovXG4gIG9uQ2hhbmdlPzogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG4gIC8qKiBQbGFjZWhvbGRlciB0ZXh0IHdoZW4gZW1wdHkgKi9cbiAgcGxhY2Vob2xkZXI/OiBzdHJpbmc7XG4gIC8qKiBNYXhpbXVtIGNoYXJhY3RlciBsZW5ndGggKi9cbiAgbWF4TGVuZ3RoPzogbnVtYmVyO1xuICAvKiogV2lkdGggb2YgdGhlIGlucHV0ICovXG4gIHdpZHRoPzogbnVtYmVyO1xuICAvKiogSGVpZ2h0IG9mIHRoZSBpbnB1dCAqL1xuICBoZWlnaHQ/OiBudW1iZXI7XG4gIC8qKiBXaGV0aGVyIHRoZSBpbnB1dCBpcyBkaXNhYmxlZCAqL1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG4gIC8qKiBCYWNrZ3JvdW5kIGNvbG9yICovXG4gIGJhY2tncm91bmRDb2xvcj86IG51bWJlcjtcbiAgLyoqIFRleHQgY29sb3IgKi9cbiAgdGV4dENvbG9yPzogbnVtYmVyO1xuICAvKiogUGxhY2Vob2xkZXIgdGV4dCBjb2xvciAqL1xuICBwbGFjZWhvbGRlckNvbG9yPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHJhZGl1cyAqL1xuICBib3JkZXJSYWRpdXM/OiBudW1iZXI7XG4gIC8qKiBGb250IHNpemUgKi9cbiAgZm9udFNpemU/OiBudW1iZXI7XG4gIC8qKiBJbnB1dCB0eXBlIGZvciB2YWxpZGF0aW9uICovXG4gIHR5cGU/OiAndGV4dCcgfCAnbnVtYmVyJztcbn1cblxuLyoqXG4gKiBBIHRleHQgaW5wdXQgY29tcG9uZW50IGZvbGxvd2luZyBBbnQgRGVzaWduIHBhdHRlcm5zXG4gKiBTdXBwb3J0cyBib3RoIGNvbnRyb2xsZWQgYW5kIHVuY29udHJvbGxlZCBtb2Rlc1xuICpcbiAqIEBjYXRlZ29yeSBVSVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBpbnB1dCA9IG5ldyBVSVRleHRJbnB1dCh7XG4gKiAgIHBsYWNlaG9sZGVyOiAnRW50ZXIgeW91ciBuYW1lLi4uJyxcbiAqICAgb25DaGFuZ2U6ICh2YWx1ZSkgPT4gY29uc29sZS5sb2coJ0lucHV0OicsIHZhbHVlKSxcbiAqICAgbWF4TGVuZ3RoOiA1MFxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFVJVGV4dElucHV0IGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxPbWl0PFVJVGV4dElucHV0UHJvcHMsICdvbkNoYW5nZScgfCAndmFsdWUnIHwgJ2RlZmF1bHRWYWx1ZSc+PjtcbiAgcHJpdmF0ZSBvbkNoYW5nZT86ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xuXG4gIHByaXZhdGUgY3VycmVudFZhbHVlOiBzdHJpbmc7XG4gIHByaXZhdGUgYmFja2dyb3VuZDogVUlQYW5lbDtcbiAgcHJpdmF0ZSB0ZXh0RGlzcGxheTogUElYSS5UZXh0O1xuICBwcml2YXRlIGN1cnNvcjogUElYSS5HcmFwaGljcztcbiAgcHJpdmF0ZSBjdXJzb3JQb3NpdGlvbjogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBjdXJzb3JCbGlua0ludGVydmFsPzogbnVtYmVyO1xuICBwcml2YXRlIGN1cnNvclZpc2libGU6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBVSVRleHRJbnB1dFByb3BzLCBib3hNb2RlbD86IFBhcnRpYWw8Qm94TW9kZWw+KSB7XG4gICAgc3VwZXIoYm94TW9kZWwpO1xuXG4gICAgdGhpcy5wcm9wcyA9IHtcbiAgICAgIHBsYWNlaG9sZGVyOiBwcm9wcy5wbGFjZWhvbGRlciA/PyAnJyxcbiAgICAgIG1heExlbmd0aDogcHJvcHMubWF4TGVuZ3RoID8/IDEwMCxcbiAgICAgIHdpZHRoOiBwcm9wcy53aWR0aCA/PyAyMDAsXG4gICAgICBoZWlnaHQ6IHByb3BzLmhlaWdodCA/PyAzNixcbiAgICAgIGRpc2FibGVkOiBwcm9wcy5kaXNhYmxlZCA/PyBmYWxzZSxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogcHJvcHMuYmFja2dyb3VuZENvbG9yID8/IDB4ZmZmZmZmLFxuICAgICAgdGV4dENvbG9yOiBwcm9wcy50ZXh0Q29sb3IgPz8gMHgwMDAwMDAsXG4gICAgICBwbGFjZWhvbGRlckNvbG9yOiBwcm9wcy5wbGFjZWhvbGRlckNvbG9yID8/IDB4OTk5OTk5LFxuICAgICAgYm9yZGVyUmFkaXVzOiBwcm9wcy5ib3JkZXJSYWRpdXMgPz8gNCxcbiAgICAgIGZvbnRTaXplOiBwcm9wcy5mb250U2l6ZSA/PyAxNCxcbiAgICAgIHR5cGU6IHByb3BzLnR5cGUgPz8gJ3RleHQnXG4gICAgfTtcblxuICAgIHRoaXMub25DaGFuZ2UgPSBwcm9wcy5vbkNoYW5nZTtcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHByb3BzLnZhbHVlID8/IHByb3BzLmRlZmF1bHRWYWx1ZSA/PyAnJztcblxuICAgIC8vIFNldCBib3ggbW9kZWwgZGltZW5zaW9uc1xuICAgIHRoaXMuYm94TW9kZWwud2lkdGggPSB0aGlzLnByb3BzLndpZHRoO1xuICAgIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID0gdGhpcy5wcm9wcy5oZWlnaHQ7XG5cbiAgICAvLyBDcmVhdGUgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZCA9IG5ldyBVSVBhbmVsKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy5iYWNrZ3JvdW5kLmNvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgdGV4dCBkaXNwbGF5XG4gICAgdGhpcy50ZXh0RGlzcGxheSA9IG5ldyBQSVhJLlRleHQoe1xuICAgICAgdGV4dDogdGhpcy5nZXREaXNwbGF5VGV4dCgpLFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgZm9udEZhbWlseTogJ0FyaWFsJyxcbiAgICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMuZm9udFNpemUsXG4gICAgICAgIGZpbGw6IHRoaXMuY3VycmVudFZhbHVlID8gdGhpcy5wcm9wcy50ZXh0Q29sb3IgOiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyQ29sb3IsXG4gICAgICAgIGFsaWduOiAnbGVmdCdcbiAgICAgIH0sXG4gICAgICByZXNvbHV0aW9uOiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAyXG4gICAgfSk7XG4gICAgdGhpcy50ZXh0RGlzcGxheS5wb3NpdGlvbi5zZXQoMTIsICh0aGlzLnByb3BzLmhlaWdodCAtIHRoaXMucHJvcHMuZm9udFNpemUpIC8gMik7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQodGhpcy50ZXh0RGlzcGxheSk7XG5cbiAgICAvLyBDcmVhdGUgY3Vyc29yXG4gICAgdGhpcy5jdXJzb3IgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRoaXMuY3Vyc29yLnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmN1cnNvcik7XG5cbiAgICAvLyBTZXR1cCBpbnRlcmFjdGl2aXR5XG4gICAgdGhpcy5zZXR1cEludGVyYWN0aXZpdHkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBkaXNwbGF5IHRleHQgKHZhbHVlIG9yIHBsYWNlaG9sZGVyKVxuICAgKi9cbiAgcHJpdmF0ZSBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLmN1cnJlbnRWYWx1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5wcm9wcy5wbGFjZWhvbGRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHVwIG1vdXNlL2tleWJvYXJkIGV2ZW50IGhhbmRsZXJzXG4gICAqL1xuICBwcml2YXRlIHNldHVwSW50ZXJhY3Rpdml0eSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5ldmVudE1vZGUgPSAnc3RhdGljJztcbiAgICB0aGlzLmNvbnRhaW5lci5jdXJzb3IgPSAndGV4dCc7XG5cbiAgICAvLyBDbGljayB0byBmb2N1c1xuICAgIHRoaXMuY29udGFpbmVyLm9uKCdwb2ludGVyZG93bicsIHRoaXMuaGFuZGxlUG9pbnRlckRvd24uYmluZCh0aGlzKSk7XG5cbiAgICAvLyBMaXN0ZW4gZm9yIGdsb2JhbCBjbGljayB0byBibHVyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVBvaW50ZXJEb3duKGU6IFBJWEkuRmVkZXJhdGVkUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgaWYgKHRoaXMucHJvcHMuZGlzYWJsZWQpIHJldHVybjtcblxuICAgIC8vIFJlcXVlc3QgZm9jdXMgdGhyb3VnaCB0aGUgZm9jdXMgbWFuYWdlclxuICAgIGNvbnN0IGZvY3VzTWFuYWdlciA9IFVJRm9jdXNNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gICAgaWYgKGZvY3VzTWFuYWdlcikge1xuICAgICAgZm9jdXNNYW5hZ2VyLnJlcXVlc3RGb2N1cyh0aGlzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRmFsbGJhY2sgaWYgbm8gZm9jdXMgbWFuYWdlclxuICAgICAgdGhpcy5vbkZvY3VzKCk7XG4gICAgfVxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gaW5wdXQgcmVjZWl2ZXMgZm9jdXMgKG92ZXJyaWRlIGZyb20gYmFzZSBjbGFzcylcbiAgICovXG4gIG92ZXJyaWRlIG9uRm9jdXMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNlZCkgcmV0dXJuO1xuXG4gICAgc3VwZXIub25Gb2N1cygpO1xuICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGg7XG4gICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IHRydWU7XG4gICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICB0aGlzLnN0YXJ0Q3Vyc29yQmxpbmsoKTtcblxuICAgIC8vIFVwZGF0ZSBiYWNrZ3JvdW5kIHRvIHNob3cgZm9jdXMgc3RhdGVcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMubGlnaHRlbkNvbG9yKHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLCAwLjk1KSxcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBpbnB1dCBsb3NlcyBmb2N1cyAob3ZlcnJpZGUgZnJvbSBiYXNlIGNsYXNzKVxuICAgKi9cbiAgb3ZlcnJpZGUgb25CbHVyKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5mb2N1c2VkKSByZXR1cm47XG5cbiAgICBzdXBlci5vbkJsdXIoKTtcbiAgICB0aGlzLmN1cnNvci52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5zdG9wQ3Vyc29yQmxpbmsoKTtcblxuICAgIC8vIFJlc3RvcmUgbm9ybWFsIGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQgPSBuZXcgVUlQYW5lbCh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMucHJvcHMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0LFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGlzLnByb3BzLmJvcmRlclJhZGl1c1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVLZXlEb3duKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZm9jdXNlZCB8fCB0aGlzLnByb3BzLmRpc2FibGVkKSByZXR1cm47XG5cbiAgICAvLyBTdG9wIGV2ZW50IGZyb20gcHJvcGFnYXRpbmdcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgIGNvbnN0IGtleSA9IGUua2V5O1xuXG4gICAgaWYgKGtleSA9PT0gJ0VudGVyJykge1xuICAgICAgdGhpcy5vbkJsdXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5vbkJsdXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQmFja3NwYWNlJykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPiAwKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlID1cbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbiAtIDEpICtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcodGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24tLTtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0RlbGV0ZScpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uIDwgdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlID1cbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbikgK1xuICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZyh0aGlzLmN1cnNvclBvc2l0aW9uICsgMSk7XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdBcnJvd0xlZnQnKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3JQb3NpdGlvbiA+IDApIHtcbiAgICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbi0tO1xuICAgICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdBcnJvd1JpZ2h0Jykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPCB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbisrO1xuICAgICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdIb21lJykge1xuICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IDA7XG4gICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdFbmQnKSB7XG4gICAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoO1xuICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgY2hhcmFjdGVyIGlucHV0XG4gICAgaWYgKGtleS5sZW5ndGggPT09IDEgJiYgIWUuY3RybEtleSAmJiAhZS5tZXRhS2V5KSB7XG4gICAgICAvLyBUeXBlIHZhbGlkYXRpb25cbiAgICAgIGlmICh0aGlzLnByb3BzLnR5cGUgPT09ICdudW1iZXInICYmICEvWzAtOS4tXS8udGVzdChrZXkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgbWF4IGxlbmd0aFxuICAgICAgaWYgKHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCA+PSB0aGlzLnByb3BzLm1heExlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIEluc2VydCBjaGFyYWN0ZXIgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uKSArXG4gICAgICAgIGtleSArXG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZyh0aGlzLmN1cnNvclBvc2l0aW9uKTtcbiAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24rKztcbiAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSB0ZXh0IGRpc3BsYXkgYW5kIHRyaWdnZXJzIG9uQ2hhbmdlXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZVRleHQoKTogdm9pZCB7XG4gICAgdGhpcy50ZXh0RGlzcGxheS50ZXh0ID0gdGhpcy5nZXREaXNwbGF5VGV4dCgpO1xuICAgIHRoaXMudGV4dERpc3BsYXkuc3R5bGUuZmlsbCA9IHRoaXMuY3VycmVudFZhbHVlID8gdGhpcy5wcm9wcy50ZXh0Q29sb3IgOiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyQ29sb3I7XG4gICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICB0aGlzLm9uQ2hhbmdlPy4odGhpcy5jdXJyZW50VmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgY3Vyc29yIHBvc2l0aW9uIHZpc3VhbGx5XG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZUN1cnNvcigpOiB2b2lkIHtcbiAgICAvLyBNZWFzdXJlIHRleHQgdXAgdG8gY3Vyc29yIHBvc2l0aW9uIGJ5IGNyZWF0aW5nIGEgdGVtcG9yYXJ5IHRleHQgb2JqZWN0XG4gICAgY29uc3QgdGV4dFVwVG9DdXJzb3IgPSB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgY29uc3QgdGVtcFRleHQgPSBuZXcgUElYSS5UZXh0KHtcbiAgICAgIHRleHQ6IHRleHRVcFRvQ3Vyc29yLFxuICAgICAgc3R5bGU6IHRoaXMudGV4dERpc3BsYXkuc3R5bGVcbiAgICB9KTtcblxuICAgIGNvbnN0IGN1cnNvclggPSAxMiArIHRlbXBUZXh0LndpZHRoO1xuICAgIGNvbnN0IGN1cnNvclkgPSAodGhpcy5wcm9wcy5oZWlnaHQgLSB0aGlzLnByb3BzLmZvbnRTaXplKSAvIDI7XG5cbiAgICB0aGlzLmN1cnNvci5jbGVhcigpO1xuICAgIHRoaXMuY3Vyc29yLnJlY3QoY3Vyc29yWCwgY3Vyc29yWSwgMSwgdGhpcy5wcm9wcy5mb250U2l6ZSk7XG4gICAgdGhpcy5jdXJzb3IuZmlsbCh7IGNvbG9yOiB0aGlzLnByb3BzLnRleHRDb2xvciB9KTtcblxuICAgIC8vIENsZWFuIHVwIHRlbXAgdGV4dFxuICAgIHRlbXBUZXh0LmRlc3Ryb3koKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydHMgY3Vyc29yIGJsaW5raW5nIGFuaW1hdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBzdGFydEN1cnNvckJsaW5rKCk6IHZvaWQge1xuICAgIHRoaXMuc3RvcEN1cnNvckJsaW5rKCk7XG4gICAgdGhpcy5jdXJzb3JWaXNpYmxlID0gdHJ1ZTtcblxuICAgIHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLmN1cnNvclZpc2libGUgPSAhdGhpcy5jdXJzb3JWaXNpYmxlO1xuICAgICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IHRoaXMuY3Vyc29yVmlzaWJsZTtcbiAgICB9LCA1MzApO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3BzIGN1cnNvciBibGlua2luZyBhbmltYXRpb25cbiAgICovXG4gIHByaXZhdGUgc3RvcEN1cnNvckJsaW5rKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmN1cnNvckJsaW5rSW50ZXJ2YWwpIHtcbiAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCk7XG4gICAgICB0aGlzLmN1cnNvckJsaW5rSW50ZXJ2YWwgPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIExpZ2h0ZW5zIGEgY29sb3IgYnkgYSBmYWN0b3JcbiAgICovXG4gIHByaXZhdGUgbGlnaHRlbkNvbG9yKGNvbG9yOiBudW1iZXIsIGZhY3RvcjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBjb25zdCByID0gTWF0aC5taW4oMjU1LCAoKGNvbG9yID4+IDE2KSAmIDB4ZmYpIC8gZmFjdG9yKTtcbiAgICBjb25zdCBnID0gTWF0aC5taW4oMjU1LCAoKGNvbG9yID4+IDgpICYgMHhmZikgLyBmYWN0b3IpO1xuICAgIGNvbnN0IGIgPSBNYXRoLm1pbigyNTUsIChjb2xvciAmIDB4ZmYpIC8gZmFjdG9yKTtcbiAgICByZXR1cm4gKChyIDw8IDE2KSB8IChnIDw8IDgpIHwgYikgPj4+IDA7XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgdGhlIHNpemUgbmVlZGVkIGZvciB0aGlzIGlucHV0XG4gICAqL1xuICBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIGlucHV0XG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuXG4gICAgdGhpcy5jb21wdXRlZExheW91dC53aWR0aCA9IG1lYXN1cmVkLndpZHRoO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuaGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuXG4gICAgLy8gTGF5b3V0IGJhY2tncm91bmRcbiAgICB0aGlzLmJhY2tncm91bmQubGF5b3V0KG1lYXN1cmVkLndpZHRoLCBtZWFzdXJlZC5oZWlnaHQpO1xuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgaW5wdXRcbiAgICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgLy8gUmVuZGVyaW5nIGhhbmRsZWQgYnkgYmFja2dyb3VuZCwgdGV4dCwgYW5kIGN1cnNvclxuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHZhbHVlIHByb2dyYW1tYXRpY2FsbHlcbiAgICovXG4gIHNldFZhbHVlKHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSB2YWx1ZS5sZW5ndGg7XG4gICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCB2YWx1ZVxuICAgKi9cbiAgZ2V0VmFsdWUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCB3aGVuIGRlc3Ryb3lpbmdcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5zdG9wQ3Vyc29yQmxpbmsoKTtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlEb3duLmJpbmQodGhpcykpO1xuICAgIH1cbiAgICBzdXBlci5kZXN0cm95KCk7XG4gIH1cbn1cbiIsImltcG9ydCBQSVhJIGZyb20gJ3BpeGkuanMnO1xuaW1wb3J0IHsgVUlDb21wb25lbnQgfSBmcm9tICcuLi9jb3JlL3VpLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBCb3hNb2RlbCwgTWVhc3VyZWRTaXplIH0gZnJvbSAnLi4vY29yZS9ib3gtbW9kZWwnO1xuaW1wb3J0IHsgVUlQYW5lbCB9IGZyb20gJy4vdWktcGFuZWwnO1xuaW1wb3J0IHsgVUlGb2N1c01hbmFnZXIgfSBmcm9tICcuLi9jb3JlL3VpLWZvY3VzLW1hbmFnZXInO1xuXG4vKipcbiAqIFByb3BzIGZvciBjb25maWd1cmluZyBhIFVJVGV4dEFyZWFcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSVRleHRBcmVhUHJvcHMge1xuICAvKiogQ3VycmVudCB2YWx1ZSAoY29udHJvbGxlZCkgKi9cbiAgdmFsdWU/OiBzdHJpbmc7XG4gIC8qKiBEZWZhdWx0IHZhbHVlICh1bmNvbnRyb2xsZWQpICovXG4gIGRlZmF1bHRWYWx1ZT86IHN0cmluZztcbiAgLyoqIENoYW5nZSBjYWxsYmFjayAqL1xuICBvbkNoYW5nZT86ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xuICAvKiogUGxhY2Vob2xkZXIgdGV4dCB3aGVuIGVtcHR5ICovXG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xuICAvKiogTWF4aW11bSBjaGFyYWN0ZXIgbGVuZ3RoICovXG4gIG1heExlbmd0aD86IG51bWJlcjtcbiAgLyoqIFdpZHRoIG9mIHRoZSB0ZXh0YXJlYSAqL1xuICB3aWR0aD86IG51bWJlcjtcbiAgLyoqIEhlaWdodCBvZiB0aGUgdGV4dGFyZWEgKi9cbiAgaGVpZ2h0PzogbnVtYmVyO1xuICAvKiogV2hldGhlciB0aGUgdGV4dGFyZWEgaXMgZGlzYWJsZWQgKi9cbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICAvKiogQmFja2dyb3VuZCBjb2xvciAqL1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gIC8qKiBUZXh0IGNvbG9yICovXG4gIHRleHRDb2xvcj86IG51bWJlcjtcbiAgLyoqIFBsYWNlaG9sZGVyIHRleHQgY29sb3IgKi9cbiAgcGxhY2Vob2xkZXJDb2xvcj86IG51bWJlcjtcbiAgLyoqIEJvcmRlciByYWRpdXMgKi9cbiAgYm9yZGVyUmFkaXVzPzogbnVtYmVyO1xuICAvKiogRm9udCBzaXplICovXG4gIGZvbnRTaXplPzogbnVtYmVyO1xuICAvKiogTGluZSBoZWlnaHQgbXVsdGlwbGllciAoZS5nLiwgMS41IG1lYW5zIDEuNXggdGhlIGZvbnQgc2l6ZSkgKi9cbiAgbGluZUhlaWdodD86IG51bWJlcjtcbiAgLyoqIE51bWJlciBvZiB2aXNpYmxlIHJvd3MgKi9cbiAgcm93cz86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBIG11bHRpLWxpbmUgdGV4dCBhcmVhIGNvbXBvbmVudFxuICogU3VwcG9ydHMgd29yZCB3cmFwcGluZyBhbmQgc2Nyb2xsaW5nXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHRleHRhcmVhID0gbmV3IFVJVGV4dEFyZWEoe1xuICogICBwbGFjZWhvbGRlcjogJ0VudGVyIHlvdXIgbWVzc2FnZS4uLicsXG4gKiAgIG9uQ2hhbmdlOiAodmFsdWUpID0+IGNvbnNvbGUubG9nKCdNZXNzYWdlOicsIHZhbHVlKSxcbiAqICAgd2lkdGg6IDQwMCxcbiAqICAgaGVpZ2h0OiAxMjAsXG4gKiAgIHJvd3M6IDRcbiAqIH0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBVSVRleHRBcmVhIGV4dGVuZHMgVUlDb21wb25lbnQge1xuICBwcml2YXRlIHByb3BzOiBSZXF1aXJlZDxPbWl0PFVJVGV4dEFyZWFQcm9wcywgJ29uQ2hhbmdlJyB8ICd2YWx1ZScgfCAnZGVmYXVsdFZhbHVlJz4+O1xuICBwcml2YXRlIG9uQ2hhbmdlPzogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG5cbiAgcHJpdmF0ZSBjdXJyZW50VmFsdWU6IHN0cmluZztcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kOiBVSVBhbmVsO1xuICBwcml2YXRlIHRleHREaXNwbGF5OiBQSVhJLlRleHQ7XG4gIHByaXZhdGUgY3Vyc29yOiBQSVhJLkdyYXBoaWNzO1xuICBwcml2YXRlIGN1cnNvclBvc2l0aW9uOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGN1cnNvckJsaW5rSW50ZXJ2YWw/OiBudW1iZXI7XG4gIHByaXZhdGUgY3Vyc29yVmlzaWJsZTogYm9vbGVhbiA9IHRydWU7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFVJVGV4dEFyZWFQcm9wcywgYm94TW9kZWw/OiBQYXJ0aWFsPEJveE1vZGVsPikge1xuICAgIHN1cGVyKGJveE1vZGVsKTtcblxuICAgIGNvbnN0IGRlZmF1bHRIZWlnaHQgPSAocHJvcHMucm93cyA/PyA0KSAqIChwcm9wcy5mb250U2l6ZSA/PyAxNCkgKiAocHJvcHMubGluZUhlaWdodCA/PyAxLjUpICsgMjQ7XG5cbiAgICB0aGlzLnByb3BzID0ge1xuICAgICAgcGxhY2Vob2xkZXI6IHByb3BzLnBsYWNlaG9sZGVyID8/ICcnLFxuICAgICAgbWF4TGVuZ3RoOiBwcm9wcy5tYXhMZW5ndGggPz8gMTAwMCxcbiAgICAgIHdpZHRoOiBwcm9wcy53aWR0aCA/PyA0MDAsXG4gICAgICBoZWlnaHQ6IHByb3BzLmhlaWdodCA/PyBkZWZhdWx0SGVpZ2h0LFxuICAgICAgZGlzYWJsZWQ6IHByb3BzLmRpc2FibGVkID8/IGZhbHNlLFxuICAgICAgYmFja2dyb3VuZENvbG9yOiBwcm9wcy5iYWNrZ3JvdW5kQ29sb3IgPz8gMHhmZmZmZmYsXG4gICAgICB0ZXh0Q29sb3I6IHByb3BzLnRleHRDb2xvciA/PyAweDAwMDAwMCxcbiAgICAgIHBsYWNlaG9sZGVyQ29sb3I6IHByb3BzLnBsYWNlaG9sZGVyQ29sb3IgPz8gMHg5OTk5OTksXG4gICAgICBib3JkZXJSYWRpdXM6IHByb3BzLmJvcmRlclJhZGl1cyA/PyA0LFxuICAgICAgZm9udFNpemU6IHByb3BzLmZvbnRTaXplID8/IDE0LFxuICAgICAgbGluZUhlaWdodDogcHJvcHMubGluZUhlaWdodCA/PyAxLjUsXG4gICAgICByb3dzOiBwcm9wcy5yb3dzID8/IDRcbiAgICB9O1xuXG4gICAgdGhpcy5vbkNoYW5nZSA9IHByb3BzLm9uQ2hhbmdlO1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gcHJvcHMudmFsdWUgPz8gcHJvcHMuZGVmYXVsdFZhbHVlID8/ICcnO1xuXG4gICAgLy8gU2V0IGJveCBtb2RlbCBkaW1lbnNpb25zXG4gICAgdGhpcy5ib3hNb2RlbC53aWR0aCA9IHRoaXMucHJvcHMud2lkdGg7XG4gICAgdGhpcy5ib3hNb2RlbC5oZWlnaHQgPSB0aGlzLnByb3BzLmhlaWdodDtcblxuICAgIC8vIENyZWF0ZSBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQuY29udGFpbmVyKTtcblxuICAgIC8vIENyZWF0ZSB0ZXh0IGRpc3BsYXkgd2l0aCB3b3JkIHdyYXBwaW5nXG4gICAgdGhpcy50ZXh0RGlzcGxheSA9IG5ldyBQSVhJLlRleHQoe1xuICAgICAgdGV4dDogdGhpcy5nZXREaXNwbGF5VGV4dCgpLFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgZm9udEZhbWlseTogJ0FyaWFsJyxcbiAgICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMuZm9udFNpemUsXG4gICAgICAgIGZpbGw6IHRoaXMuY3VycmVudFZhbHVlID8gdGhpcy5wcm9wcy50ZXh0Q29sb3IgOiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyQ29sb3IsXG4gICAgICAgIGFsaWduOiAnbGVmdCcsXG4gICAgICAgIHdvcmRXcmFwOiB0cnVlLFxuICAgICAgICB3b3JkV3JhcFdpZHRoOiB0aGlzLnByb3BzLndpZHRoIC0gMjQsXG4gICAgICAgIGxpbmVIZWlnaHQ6IHRoaXMucHJvcHMuZm9udFNpemUgKiB0aGlzLnByb3BzLmxpbmVIZWlnaHRcbiAgICAgIH0sXG4gICAgICByZXNvbHV0aW9uOiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAyXG4gICAgfSk7XG4gICAgdGhpcy50ZXh0RGlzcGxheS5wb3NpdGlvbi5zZXQoMTIsIDEyKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLnRleHREaXNwbGF5KTtcblxuICAgIC8vIENyZWF0ZSBjdXJzb3JcbiAgICB0aGlzLmN1cnNvciA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IGZhbHNlO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHRoaXMuY3Vyc29yKTtcblxuICAgIC8vIFNldHVwIGludGVyYWN0aXZpdHlcbiAgICB0aGlzLnNldHVwSW50ZXJhY3Rpdml0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGRpc3BsYXkgdGV4dCAodmFsdWUgb3IgcGxhY2Vob2xkZXIpXG4gICAqL1xuICBwcml2YXRlIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuY3VycmVudFZhbHVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFsdWU7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnByb3BzLnBsYWNlaG9sZGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgbW91c2Uva2V5Ym9hcmQgZXZlbnQgaGFuZGxlcnNcbiAgICovXG4gIHByaXZhdGUgc2V0dXBJbnRlcmFjdGl2aXR5KCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmV2ZW50TW9kZSA9ICdzdGF0aWMnO1xuICAgIHRoaXMuY29udGFpbmVyLmN1cnNvciA9ICd0ZXh0JztcblxuICAgIC8vIENsaWNrIHRvIGZvY3VzXG4gICAgdGhpcy5jb250YWluZXIub24oJ3BvaW50ZXJkb3duJywgdGhpcy5oYW5kbGVQb2ludGVyRG93bi5iaW5kKHRoaXMpKTtcblxuICAgIC8vIExpc3RlbiBmb3IgZ2xvYmFsIGtleWJvYXJkIGV2ZW50c1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleURvd24uYmluZCh0aGlzKSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVQb2ludGVyRG93bihlOiBQSVhJLkZlZGVyYXRlZFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb3BzLmRpc2FibGVkKSByZXR1cm47XG5cbiAgICAvLyBSZXF1ZXN0IGZvY3VzIHRocm91Z2ggdGhlIGZvY3VzIG1hbmFnZXJcbiAgICBjb25zdCBmb2N1c01hbmFnZXIgPSBVSUZvY3VzTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuICAgIGlmIChmb2N1c01hbmFnZXIpIHtcbiAgICAgIGZvY3VzTWFuYWdlci5yZXF1ZXN0Rm9jdXModGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZhbGxiYWNrIGlmIG5vIGZvY3VzIG1hbmFnZXJcbiAgICAgIHRoaXMub25Gb2N1cygpO1xuICAgIH1cbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHRleHRhcmVhIHJlY2VpdmVzIGZvY3VzIChvdmVycmlkZSBmcm9tIGJhc2UgY2xhc3MpXG4gICAqL1xuICBvdmVycmlkZSBvbkZvY3VzKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzZWQpIHJldHVybjtcblxuICAgIHN1cGVyLm9uRm9jdXMoKTtcbiAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoO1xuICAgIHRoaXMuY3Vyc29yLnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgdGhpcy5zdGFydEN1cnNvckJsaW5rKCk7XG5cbiAgICAvLyBVcGRhdGUgYmFja2dyb3VuZCB0byBzaG93IGZvY3VzIHN0YXRlXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLmxpZ2h0ZW5Db2xvcih0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvciwgMC45NSksXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoaXMucHJvcHMuYm9yZGVyUmFkaXVzXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gdGV4dGFyZWEgbG9zZXMgZm9jdXMgKG92ZXJyaWRlIGZyb20gYmFzZSBjbGFzcylcbiAgICovXG4gIG92ZXJyaWRlIG9uQmx1cigpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZm9jdXNlZCkgcmV0dXJuO1xuXG4gICAgc3VwZXIub25CbHVyKCk7XG4gICAgdGhpcy5jdXJzb3IudmlzaWJsZSA9IGZhbHNlO1xuICAgIHRoaXMuc3RvcEN1cnNvckJsaW5rKCk7XG5cbiAgICAvLyBSZXN0b3JlIG5vcm1hbCBiYWNrZ3JvdW5kXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gbmV3IFVJUGFuZWwoe1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLmJhY2tncm91bmRDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLnByb3BzLndpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnByb3BzLmhlaWdodCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhpcy5wcm9wcy5ib3JkZXJSYWRpdXNcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlS2V5RG93bihlOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmZvY3VzZWQgfHwgdGhpcy5wcm9wcy5kaXNhYmxlZCkgcmV0dXJuO1xuXG4gICAgLy8gRG9uJ3QgcHJldmVudCBkZWZhdWx0IGZvciBUYWIgKGFsbG93IHRhYiBuYXZpZ2F0aW9uKVxuICAgIGlmIChlLmtleSAhPT0gJ1RhYicpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgfVxuXG4gICAgY29uc3Qga2V5ID0gZS5rZXk7XG5cbiAgICAvLyBFbnRlciBhZGRzIG5ldyBsaW5lIGluIHRleHRhcmVhXG4gICAgaWYgKGtleSA9PT0gJ0VudGVyJykge1xuICAgICAgaWYgKHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCA8IHRoaXMucHJvcHMubWF4TGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlID1cbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcoMCwgdGhpcy5jdXJzb3JQb3NpdGlvbikgK1xuICAgICAgICAgICdcXG4nICtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcodGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24rKztcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHRoaXMub25CbHVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJ0JhY2tzcGFjZScpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uID4gMCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24gLSAxKSArXG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKHRoaXMuY3Vyc29yUG9zaXRpb24pO1xuICAgICAgICB0aGlzLmN1cnNvclBvc2l0aW9uLS07XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdEZWxldGUnKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3JQb3NpdGlvbiA8IHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUuc3Vic3RyaW5nKDAsIHRoaXMuY3Vyc29yUG9zaXRpb24pICtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZS5zdWJzdHJpbmcodGhpcy5jdXJzb3JQb3NpdGlvbiArIDEpO1xuICAgICAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQXJyb3dMZWZ0Jykge1xuICAgICAgaWYgKHRoaXMuY3Vyc29yUG9zaXRpb24gPiAwKSB7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24tLTtcbiAgICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQXJyb3dSaWdodCcpIHtcbiAgICAgIGlmICh0aGlzLmN1cnNvclBvc2l0aW9uIDwgdGhpcy5jdXJyZW50VmFsdWUubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24rKztcbiAgICAgICAgdGhpcy51cGRhdGVDdXJzb3IoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQXJyb3dVcCcpIHtcbiAgICAgIC8vIE1vdmUgY3Vyc29yIHVwIG9uZSBsaW5lXG4gICAgICB0aGlzLm1vdmVDdXJzb3JWZXJ0aWNhbGx5KC0xKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnQXJyb3dEb3duJykge1xuICAgICAgLy8gTW92ZSBjdXJzb3IgZG93biBvbmUgbGluZVxuICAgICAgdGhpcy5tb3ZlQ3Vyc29yVmVydGljYWxseSgxKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSAnSG9tZScpIHtcbiAgICAgIC8vIE1vdmUgdG8gc3RhcnQgb2YgY3VycmVudCBsaW5lXG4gICAgICBjb25zdCBsaW5lU3RhcnQgPSB0aGlzLmN1cnJlbnRWYWx1ZS5sYXN0SW5kZXhPZignXFxuJywgdGhpcy5jdXJzb3JQb3NpdGlvbiAtIDEpICsgMTtcbiAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24gPSBsaW5lU3RhcnQ7XG4gICAgICB0aGlzLnVwZGF0ZUN1cnNvcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICdFbmQnKSB7XG4gICAgICAvLyBNb3ZlIHRvIGVuZCBvZiBjdXJyZW50IGxpbmVcbiAgICAgIGxldCBsaW5lRW5kID0gdGhpcy5jdXJyZW50VmFsdWUuaW5kZXhPZignXFxuJywgdGhpcy5jdXJzb3JQb3NpdGlvbik7XG4gICAgICBpZiAobGluZUVuZCA9PT0gLTEpIGxpbmVFbmQgPSB0aGlzLmN1cnJlbnRWYWx1ZS5sZW5ndGg7XG4gICAgICB0aGlzLmN1cnNvclBvc2l0aW9uID0gbGluZUVuZDtcbiAgICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIGNoYXJhY3RlciBpbnB1dFxuICAgIGlmIChrZXkubGVuZ3RoID09PSAxICYmICFlLmN0cmxLZXkgJiYgIWUubWV0YUtleSkge1xuICAgICAgLy8gQ2hlY2sgbWF4IGxlbmd0aFxuICAgICAgaWYgKHRoaXMuY3VycmVudFZhbHVlLmxlbmd0aCA+PSB0aGlzLnByb3BzLm1heExlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIEluc2VydCBjaGFyYWN0ZXIgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9XG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uKSArXG4gICAgICAgIGtleSArXG4gICAgICAgIHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZyh0aGlzLmN1cnNvclBvc2l0aW9uKTtcbiAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb24rKztcbiAgICAgIHRoaXMudXBkYXRlVGV4dCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNb3ZlcyBjdXJzb3IgdmVydGljYWxseSBieSB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiBsaW5lc1xuICAgKi9cbiAgcHJpdmF0ZSBtb3ZlQ3Vyc29yVmVydGljYWxseShkaXJlY3Rpb246IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IGxpbmVzID0gdGhpcy5jdXJyZW50VmFsdWUuc3BsaXQoJ1xcbicpO1xuICAgIGxldCBjdXJyZW50TGluZSA9IDA7XG4gICAgbGV0IHBvc2l0aW9uSW5MaW5lID0gMDtcbiAgICBsZXQgY2hhckNvdW50ID0gMDtcblxuICAgIC8vIEZpbmQgY3VycmVudCBsaW5lIGFuZCBwb3NpdGlvblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChjaGFyQ291bnQgKyBsaW5lc1tpXS5sZW5ndGggPj0gdGhpcy5jdXJzb3JQb3NpdGlvbikge1xuICAgICAgICBjdXJyZW50TGluZSA9IGk7XG4gICAgICAgIHBvc2l0aW9uSW5MaW5lID0gdGhpcy5jdXJzb3JQb3NpdGlvbiAtIGNoYXJDb3VudDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjaGFyQ291bnQgKz0gbGluZXNbaV0ubGVuZ3RoICsgMTsgLy8gKzEgZm9yIG5ld2xpbmVcbiAgICB9XG5cbiAgICAvLyBNb3ZlIHRvIHRhcmdldCBsaW5lXG4gICAgY29uc3QgdGFyZ2V0TGluZSA9IE1hdGgubWF4KDAsIE1hdGgubWluKGxpbmVzLmxlbmd0aCAtIDEsIGN1cnJlbnRMaW5lICsgZGlyZWN0aW9uKSk7XG4gICAgaWYgKHRhcmdldExpbmUgPT09IGN1cnJlbnRMaW5lKSByZXR1cm47XG5cbiAgICAvLyBDYWxjdWxhdGUgbmV3IGN1cnNvciBwb3NpdGlvblxuICAgIGxldCBuZXdQb3NpdGlvbiA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRMaW5lOyBpKyspIHtcbiAgICAgIG5ld1Bvc2l0aW9uICs9IGxpbmVzW2ldLmxlbmd0aCArIDE7XG4gICAgfVxuICAgIG5ld1Bvc2l0aW9uICs9IE1hdGgubWluKHBvc2l0aW9uSW5MaW5lLCBsaW5lc1t0YXJnZXRMaW5lXS5sZW5ndGgpO1xuXG4gICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IG5ld1Bvc2l0aW9uO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgdGV4dCBkaXNwbGF5IGFuZCB0cmlnZ2VycyBvbkNoYW5nZVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVUZXh0KCk6IHZvaWQge1xuICAgIHRoaXMudGV4dERpc3BsYXkudGV4dCA9IHRoaXMuZ2V0RGlzcGxheVRleHQoKTtcbiAgICB0aGlzLnRleHREaXNwbGF5LnN0eWxlLmZpbGwgPSB0aGlzLmN1cnJlbnRWYWx1ZSA/IHRoaXMucHJvcHMudGV4dENvbG9yIDogdGhpcy5wcm9wcy5wbGFjZWhvbGRlckNvbG9yO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yKCk7XG4gICAgdGhpcy5vbkNoYW5nZT8uKHRoaXMuY3VycmVudFZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIGN1cnNvciBwb3NpdGlvbiB2aXN1YWxseVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVDdXJzb3IoKTogdm9pZCB7XG4gICAgLy8gR2V0IHRleHQgbWV0cmljcyB1cCB0byBjdXJzb3IgcG9zaXRpb25cbiAgICBjb25zdCB0ZXh0VXBUb0N1cnNvciA9IHRoaXMuY3VycmVudFZhbHVlLnN1YnN0cmluZygwLCB0aGlzLmN1cnNvclBvc2l0aW9uKTtcblxuICAgIC8vIENyZWF0ZSB0ZW1wb3JhcnkgdGV4dCB0byBtZWFzdXJlXG4gICAgY29uc3QgdGVtcFRleHQgPSBuZXcgUElYSS5UZXh0KHtcbiAgICAgIHRleHQ6IHRleHRVcFRvQ3Vyc29yLFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgLi4udGhpcy50ZXh0RGlzcGxheS5zdHlsZSxcbiAgICAgICAgd29yZFdyYXA6IHRydWUsXG4gICAgICAgIHdvcmRXcmFwV2lkdGg6IHRoaXMucHJvcHMud2lkdGggLSAyNFxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gR2V0IHRoZSBib3VuZHMgdG8gZmluZCBjdXJzb3IgcG9zaXRpb25cbiAgICBjb25zdCBtZXRyaWNzID0gdGVtcFRleHQuZ2V0TG9jYWxCb3VuZHMoKTtcblxuICAgIC8vIEZvciBtdWx0aS1saW5lLCB3ZSBuZWVkIHRvIGZpbmQgdGhlIGxhc3QgbGluZSBwb3NpdGlvblxuICAgIGNvbnN0IGxpbmVzID0gdGV4dFVwVG9DdXJzb3Iuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGxhc3RMaW5lID0gbGluZXNbbGluZXMubGVuZ3RoIC0gMV07XG5cbiAgICBjb25zdCBsYXN0TGluZVRleHQgPSBuZXcgUElYSS5UZXh0KHtcbiAgICAgIHRleHQ6IGxhc3RMaW5lLFxuICAgICAgc3R5bGU6IHRoaXMudGV4dERpc3BsYXkuc3R5bGVcbiAgICB9KTtcblxuICAgIGNvbnN0IGN1cnNvclggPSAxMiArIGxhc3RMaW5lVGV4dC53aWR0aDtcbiAgICBjb25zdCBjdXJzb3JZID0gMTIgKyAobGluZXMubGVuZ3RoIC0gMSkgKiAodGhpcy5wcm9wcy5mb250U2l6ZSAqIHRoaXMucHJvcHMubGluZUhlaWdodCk7XG5cbiAgICB0aGlzLmN1cnNvci5jbGVhcigpO1xuICAgIHRoaXMuY3Vyc29yLnJlY3QoY3Vyc29yWCwgY3Vyc29yWSwgMSwgdGhpcy5wcm9wcy5mb250U2l6ZSk7XG4gICAgdGhpcy5jdXJzb3IuZmlsbCh7IGNvbG9yOiB0aGlzLnByb3BzLnRleHRDb2xvciB9KTtcblxuICAgIC8vIENsZWFuIHVwIHRlbXAgb2JqZWN0c1xuICAgIHRlbXBUZXh0LmRlc3Ryb3koKTtcbiAgICBsYXN0TGluZVRleHQuZGVzdHJveSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0cyBjdXJzb3IgYmxpbmtpbmcgYW5pbWF0aW9uXG4gICAqL1xuICBwcml2YXRlIHN0YXJ0Q3Vyc29yQmxpbmsoKTogdm9pZCB7XG4gICAgdGhpcy5zdG9wQ3Vyc29yQmxpbmsoKTtcbiAgICB0aGlzLmN1cnNvclZpc2libGUgPSB0cnVlO1xuXG4gICAgdGhpcy5jdXJzb3JCbGlua0ludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHRoaXMuY3Vyc29yVmlzaWJsZSA9ICF0aGlzLmN1cnNvclZpc2libGU7XG4gICAgICB0aGlzLmN1cnNvci52aXNpYmxlID0gdGhpcy5jdXJzb3JWaXNpYmxlO1xuICAgIH0sIDUzMCk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcHMgY3Vyc29yIGJsaW5raW5nIGFuaW1hdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBzdG9wQ3Vyc29yQmxpbmsoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCkge1xuICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5jdXJzb3JCbGlua0ludGVydmFsKTtcbiAgICAgIHRoaXMuY3Vyc29yQmxpbmtJbnRlcnZhbCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTGlnaHRlbnMgYSBjb2xvciBieSBhIGZhY3RvclxuICAgKi9cbiAgcHJpdmF0ZSBsaWdodGVuQ29sb3IoY29sb3I6IG51bWJlciwgZmFjdG9yOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IHIgPSBNYXRoLm1pbigyNTUsICgoY29sb3IgPj4gMTYpICYgMHhmZikgLyBmYWN0b3IpO1xuICAgIGNvbnN0IGcgPSBNYXRoLm1pbigyNTUsICgoY29sb3IgPj4gOCkgJiAweGZmKSAvIGZhY3Rvcik7XG4gICAgY29uc3QgYiA9IE1hdGgubWluKDI1NSwgKGNvbG9yICYgMHhmZikgLyBmYWN0b3IpO1xuICAgIHJldHVybiAoKHIgPDwgMTYpIHwgKGcgPDwgOCkgfCBiKSA+Pj4gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgdGV4dGFyZWFcbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMucHJvcHMud2lkdGgsXG4gICAgICBoZWlnaHQ6IHRoaXMucHJvcHMuaGVpZ2h0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBsYXlvdXQgZm9yIHRoaXMgdGV4dGFyZWFcbiAgICovXG4gIGxheW91dChhdmFpbGFibGVXaWR0aDogbnVtYmVyLCBhdmFpbGFibGVIZWlnaHQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG5cbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LndpZHRoID0gbWVhc3VyZWQud2lkdGg7XG4gICAgdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG5cbiAgICAvLyBMYXlvdXQgYmFja2dyb3VuZFxuICAgIHRoaXMuYmFja2dyb3VuZC5sYXlvdXQobWVhc3VyZWQud2lkdGgsIG1lYXN1cmVkLmhlaWdodCk7XG5cbiAgICB0aGlzLmxheW91dERpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIHRoZSB0ZXh0YXJlYVxuICAgKi9cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiB2b2lkIHtcbiAgICAvLyBSZW5kZXJpbmcgaGFuZGxlZCBieSBiYWNrZ3JvdW5kLCB0ZXh0LCBhbmQgY3Vyc29yXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgdmFsdWUgcHJvZ3JhbW1hdGljYWxseVxuICAgKi9cbiAgc2V0VmFsdWUodmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gdmFsdWU7XG4gICAgdGhpcy5jdXJzb3JQb3NpdGlvbiA9IHZhbHVlLmxlbmd0aDtcbiAgICB0aGlzLnVwZGF0ZVRleHQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IHZhbHVlXG4gICAqL1xuICBnZXRWYWx1ZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIHdoZW4gZGVzdHJveWluZ1xuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLnN0b3BDdXJzb3JCbGluaygpO1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleURvd24uYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIHN1cGVyLmRlc3Ryb3koKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgRWRnZUluc2V0cyB9IGZyb20gJy4vZWRnZS1pbnNldHMnO1xuXG4vKipcbiAqIFNpemUgY29uc3RyYWludCB2YWx1ZXMgZm9yIFVJIGNvbXBvbmVudHNcbiAqIENhbiBiZSBhIGZpeGVkIG51bWJlciwgJ2F1dG8nIHRvIGZpdCBjb250ZW50LCBvciAnZmlsbCcgdG8gZXhwYW5kXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCB0eXBlIFNpemVDb25zdHJhaW50ID0gbnVtYmVyIHwgJ2F1dG8nIHwgJ2ZpbGwnO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIGJveCBtb2RlbCBmb3IgYSBVSSBjb21wb25lbnRcbiAqIFNpbWlsYXIgdG8gQ1NTIGJveCBtb2RlbCB3aXRoIHdpZHRoLCBoZWlnaHQsIHBhZGRpbmcsIG1hcmdpbiwgYW5kIGJvcmRlclxuICpcbiAqIEBjYXRlZ29yeSBVSVxuICovXG5leHBvcnQgaW50ZXJmYWNlIEJveE1vZGVsIHtcbiAgLy8gQ29udGVudCBhcmVhIGRpbWVuc2lvbnNcbiAgd2lkdGg6IFNpemVDb25zdHJhaW50O1xuICBoZWlnaHQ6IFNpemVDb25zdHJhaW50O1xuXG4gIC8vIFNpemUgY29uc3RyYWludHNcbiAgbWluV2lkdGg/OiBudW1iZXI7XG4gIG1pbkhlaWdodD86IG51bWJlcjtcbiAgbWF4V2lkdGg/OiBudW1iZXI7XG4gIG1heEhlaWdodD86IG51bWJlcjtcblxuICAvLyBTcGFjaW5nXG4gIHBhZGRpbmc6IEVkZ2VJbnNldHM7XG4gIG1hcmdpbjogRWRnZUluc2V0cztcblxuICAvLyBCb3JkZXIgKHZpc3VhbCBib3JkZXIgd2lsbCBiZSBpbXBsZW1lbnRlZCBsYXRlcilcbiAgYm9yZGVyPzogRWRnZUluc2V0cztcbn1cblxuLyoqXG4gKiBUaGUgY29tcHV0ZWQvYWN0dWFsIGxheW91dCBvZiBhIGNvbXBvbmVudCBhZnRlciBtZWFzdXJlbWVudFxuICogQWxsIHZhbHVlcyBhcmUgY29uY3JldGUgcGl4ZWwgdmFsdWVzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcHV0ZWRMYXlvdXQge1xuICAvLyBQb3NpdGlvbiByZWxhdGl2ZSB0byBwYXJlbnRcbiAgeDogbnVtYmVyO1xuICB5OiBudW1iZXI7XG5cbiAgLy8gRmluYWwgZGltZW5zaW9uc1xuICB3aWR0aDogbnVtYmVyO1xuICBoZWlnaHQ6IG51bWJlcjtcblxuICAvLyBDb250ZW50IGFyZWEgKGluc2lkZSBwYWRkaW5nKVxuICBjb250ZW50WDogbnVtYmVyO1xuICBjb250ZW50WTogbnVtYmVyO1xuICBjb250ZW50V2lkdGg6IG51bWJlcjtcbiAgY29udGVudEhlaWdodDogbnVtYmVyO1xufVxuXG4vKipcbiAqIFJlc3VsdCBvZiBtZWFzdXJpbmcgYSBjb21wb25lbnQncyBzaXplXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTWVhc3VyZWRTaXplIHtcbiAgd2lkdGg6IG51bWJlcjtcbiAgaGVpZ2h0OiBudW1iZXI7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGNyZWF0ZSBhIGRlZmF1bHQgQm94TW9kZWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURlZmF1bHRCb3hNb2RlbChvdmVycmlkZXM/OiBQYXJ0aWFsPEJveE1vZGVsPik6IEJveE1vZGVsIHtcbiAgcmV0dXJuIHtcbiAgICB3aWR0aDogJ2F1dG8nLFxuICAgIGhlaWdodDogJ2F1dG8nLFxuICAgIHBhZGRpbmc6IEVkZ2VJbnNldHMuemVybygpLFxuICAgIG1hcmdpbjogRWRnZUluc2V0cy56ZXJvKCksXG4gICAgLi4ub3ZlcnJpZGVzXG4gIH07XG59XG4iLCIvKipcbiAqIFJlcHJlc2VudHMgc3BhY2luZyB2YWx1ZXMgZm9yIHRoZSBlZGdlcyBvZiBhIGJveCAodG9wLCByaWdodCwgYm90dG9tLCBsZWZ0KS5cbiAqIFNpbWlsYXIgdG8gQ1NTIHBhZGRpbmcvbWFyZ2luIHN5bnRheC5cbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGNsYXNzIEVkZ2VJbnNldHMge1xuICAvKipcbiAgICogQ3JlYXRlcyBhbiBFZGdlSW5zZXRzIHdpdGggc3BlY2lmaWMgdmFsdWVzIGZvciBlYWNoIGVkZ2VcbiAgICpcbiAgICogQHBhcmFtIHRvcCAtIFRvcCBlZGdlIHNwYWNpbmdcbiAgICogQHBhcmFtIHJpZ2h0IC0gUmlnaHQgZWRnZSBzcGFjaW5nXG4gICAqIEBwYXJhbSBib3R0b20gLSBCb3R0b20gZWRnZSBzcGFjaW5nXG4gICAqIEBwYXJhbSBsZWZ0IC0gTGVmdCBlZGdlIHNwYWNpbmdcbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyB0b3A6IG51bWJlcixcbiAgICBwdWJsaWMgcmlnaHQ6IG51bWJlcixcbiAgICBwdWJsaWMgYm90dG9tOiBudW1iZXIsXG4gICAgcHVibGljIGxlZnQ6IG51bWJlclxuICApIHt9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgRWRnZUluc2V0cyB3aXRoIHRoZSBzYW1lIHZhbHVlIGZvciBhbGwgZWRnZXNcbiAgICogU2ltaWxhciB0byBDU1M6IHBhZGRpbmc6IDEwcHhcbiAgICpcbiAgICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIHRvIGFwcGx5IHRvIGFsbCBlZGdlc1xuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IHBhZGRpbmcgPSBFZGdlSW5zZXRzLmFsbCgyMCk7IC8vIDIwcHggb24gYWxsIHNpZGVzXG4gICAqIGBgYFxuICAgKi9cbiAgc3RhdGljIGFsbCh2YWx1ZTogbnVtYmVyKTogRWRnZUluc2V0cyB7XG4gICAgcmV0dXJuIG5ldyBFZGdlSW5zZXRzKHZhbHVlLCB2YWx1ZSwgdmFsdWUsIHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIEVkZ2VJbnNldHMgd2l0aCBzeW1tZXRyaWMgdmVydGljYWwgYW5kIGhvcml6b250YWwgdmFsdWVzXG4gICAqIFNpbWlsYXIgdG8gQ1NTOiBwYWRkaW5nOiAxMHB4IDIwcHhcbiAgICpcbiAgICogQHBhcmFtIHZlcnRpY2FsIC0gVmFsdWUgZm9yIHRvcCBhbmQgYm90dG9tIGVkZ2VzXG4gICAqIEBwYXJhbSBob3Jpem9udGFsIC0gVmFsdWUgZm9yIGxlZnQgYW5kIHJpZ2h0IGVkZ2VzXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogY29uc3QgcGFkZGluZyA9IEVkZ2VJbnNldHMuc3ltbWV0cmljKDEwLCAyMCk7IC8vIDEwcHggdG9wL2JvdHRvbSwgMjBweCBsZWZ0L3JpZ2h0XG4gICAqIGBgYFxuICAgKi9cbiAgc3RhdGljIHN5bW1ldHJpYyh2ZXJ0aWNhbDogbnVtYmVyLCBob3Jpem9udGFsOiBudW1iZXIpOiBFZGdlSW5zZXRzIHtcbiAgICByZXR1cm4gbmV3IEVkZ2VJbnNldHModmVydGljYWwsIGhvcml6b250YWwsIHZlcnRpY2FsLCBob3Jpem9udGFsKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIEVkZ2VJbnNldHMgd2l0aCBzcGVjaWZpYyB2YWx1ZXMgZm9yIGluZGl2aWR1YWwgZWRnZXNcbiAgICogU2ltaWxhciB0byBDU1M6IHBhZGRpbmctdG9wLCBwYWRkaW5nLXJpZ2h0LCBldGMuXG4gICAqXG4gICAqIEBwYXJhbSBlZGdlcyAtIE9iamVjdCB3aXRoIG9wdGlvbmFsIHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdCB2YWx1ZXMgKGRlZmF1bHRzIHRvIDApXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogY29uc3QgcGFkZGluZyA9IEVkZ2VJbnNldHMub25seSh7IHRvcDogMTAsIGxlZnQ6IDIwIH0pOyAvLyAxMHB4IHRvcCwgMjBweCBsZWZ0LCAwcHggcmlnaHQvYm90dG9tXG4gICAqIGBgYFxuICAgKi9cbiAgc3RhdGljIG9ubHkoZWRnZXM6IHsgdG9wPzogbnVtYmVyOyByaWdodD86IG51bWJlcjsgYm90dG9tPzogbnVtYmVyOyBsZWZ0PzogbnVtYmVyIH0pOiBFZGdlSW5zZXRzIHtcbiAgICByZXR1cm4gbmV3IEVkZ2VJbnNldHMoXG4gICAgICBlZGdlcy50b3AgPz8gMCxcbiAgICAgIGVkZ2VzLnJpZ2h0ID8/IDAsXG4gICAgICBlZGdlcy5ib3R0b20gPz8gMCxcbiAgICAgIGVkZ2VzLmxlZnQgPz8gMFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBFZGdlSW5zZXRzIHdpdGggemVybyBzcGFjaW5nIG9uIGFsbCBlZGdlc1xuICAgKiBTaW1pbGFyIHRvIENTUzogcGFkZGluZzogMFxuICAgKi9cbiAgc3RhdGljIHplcm8oKTogRWRnZUluc2V0cyB7XG4gICAgcmV0dXJuIG5ldyBFZGdlSW5zZXRzKDAsIDAsIDAsIDApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHRvdGFsIGhvcml6b250YWwgc3BhY2luZyAobGVmdCArIHJpZ2h0KVxuICAgKi9cbiAgZ2V0IGhvcml6b250YWwoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5sZWZ0ICsgdGhpcy5yaWdodDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSB0b3RhbCB2ZXJ0aWNhbCBzcGFjaW5nICh0b3AgKyBib3R0b20pXG4gICAqL1xuICBnZXQgdmVydGljYWwoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy50b3AgKyB0aGlzLmJvdHRvbTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgY29weSBvZiB0aGVzZSBFZGdlSW5zZXRzXG4gICAqL1xuICBjbG9uZSgpOiBFZGdlSW5zZXRzIHtcbiAgICByZXR1cm4gbmV3IEVkZ2VJbnNldHModGhpcy50b3AsIHRoaXMucmlnaHQsIHRoaXMuYm90dG9tLCB0aGlzLmxlZnQpO1xuICB9XG59XG4iLCJpbXBvcnQgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IEJveE1vZGVsLCBDb21wdXRlZExheW91dCwgTWVhc3VyZWRTaXplLCBjcmVhdGVEZWZhdWx0Qm94TW9kZWwgfSBmcm9tICcuL2JveC1tb2RlbCc7XG5cbi8qKlxuICogQmFzZSBhYnN0cmFjdCBjbGFzcyBmb3IgYWxsIFVJIGNvbXBvbmVudHNcbiAqIFByb3ZpZGVzIGJveCBtb2RlbCwgbGF5b3V0LCBhbmQgcmVuZGVyaW5nIGZ1bmN0aW9uYWxpdHlcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFVJQ29tcG9uZW50IHtcbiAgLyoqXG4gICAqIFRoZSBQSVhJIGNvbnRhaW5lciB0aGF0IGhvbGRzIHRoaXMgY29tcG9uZW50J3MgdmlzdWFsIHJlcHJlc2VudGF0aW9uXG4gICAqL1xuICBwdWJsaWMgY29udGFpbmVyOiBQSVhJLkNvbnRhaW5lcjtcblxuICAvKipcbiAgICogVGhlIGJveCBtb2RlbCBkZWZpbmluZyB0aGlzIGNvbXBvbmVudCdzIHNpemluZyBhbmQgc3BhY2luZ1xuICAgKi9cbiAgcHJvdGVjdGVkIGJveE1vZGVsOiBCb3hNb2RlbDtcblxuICAvKipcbiAgICogRm9jdXMgcmluZyBmb3IgdmlzdWFsIGZvY3VzIGluZGljYXRpb25cbiAgICovXG4gIHByb3RlY3RlZCBmb2N1c1Jpbmc/OiBQSVhJLkdyYXBoaWNzO1xuXG4gIC8qKlxuICAgKiBUaGUgY29tcHV0ZWQgbGF5b3V0IGFmdGVyIG1lYXN1cmVtZW50IGFuZCBwb3NpdGlvbmluZ1xuICAgKi9cbiAgcHJvdGVjdGVkIGNvbXB1dGVkTGF5b3V0OiBDb21wdXRlZExheW91dDtcblxuICAvKipcbiAgICogUmVmZXJlbmNlIHRvIHBhcmVudCBjb21wb25lbnQgKGlmIGFueSlcbiAgICovXG4gIHB1YmxpYyBwYXJlbnQ/OiBVSUNvbXBvbmVudDtcblxuICAvKipcbiAgICogV2hldGhlciB0aGlzIGNvbXBvbmVudCBpcyBjdXJyZW50bHkgdmlzaWJsZVxuICAgKi9cbiAgcHVibGljIHZpc2libGU6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoaXMgY29tcG9uZW50IGlzIGVuYWJsZWQgZm9yIGludGVyYWN0aW9uXG4gICAqL1xuICBwdWJsaWMgZW5hYmxlZDogYm9vbGVhbiA9IHRydWU7XG5cbiAgLyoqXG4gICAqIEZsYWcgaW5kaWNhdGluZyBpZiBsYXlvdXQgbmVlZHMgdG8gYmUgcmVjYWxjdWxhdGVkXG4gICAqL1xuICBwcm90ZWN0ZWQgbGF5b3V0RGlydHk6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIC8qKlxuICAgKiBUYWIgaW5kZXggZm9yIGZvY3VzIG9yZGVyICgtMSBtZWFucyBub3QgZm9jdXNhYmxlIGJ5IHRhYilcbiAgICovXG4gIHB1YmxpYyB0YWJJbmRleDogbnVtYmVyID0gLTE7XG5cbiAgLyoqXG4gICAqIEludGVybmFsIGZvY3VzIHN0YXRlXG4gICAqL1xuICBwcm90ZWN0ZWQgZm9jdXNlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKGJveE1vZGVsPzogUGFydGlhbDxCb3hNb2RlbD4pIHtcbiAgICB0aGlzLmNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgIHRoaXMuYm94TW9kZWwgPSBjcmVhdGVEZWZhdWx0Qm94TW9kZWwoYm94TW9kZWwpO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQgPSB7XG4gICAgICB4OiAwLFxuICAgICAgeTogMCxcbiAgICAgIHdpZHRoOiAwLFxuICAgICAgaGVpZ2h0OiAwLFxuICAgICAgY29udGVudFg6IDAsXG4gICAgICBjb250ZW50WTogMCxcbiAgICAgIGNvbnRlbnRXaWR0aDogMCxcbiAgICAgIGNvbnRlbnRIZWlnaHQ6IDBcbiAgICB9O1xuXG4gICAgLy8gQ3JlYXRlIGZvY3VzIHJpbmcgKGluaXRpYWxseSBoaWRkZW4pXG4gICAgdGhpcy5jcmVhdGVGb2N1c1JpbmcoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIHRoZSBmb2N1cyByaW5nIGdyYXBoaWNzXG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZUZvY3VzUmluZygpOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzUmluZyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgdGhpcy5mb2N1c1JpbmcudmlzaWJsZSA9IGZhbHNlO1xuICAgIC8vIEFkZCBhcyBmaXJzdCBjaGlsZCBzbyBpdCByZW5kZXJzIGJlaGluZCBjb250ZW50XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGRBdCh0aGlzLmZvY3VzUmluZywgMCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgZm9jdXMgcmluZyBhcHBlYXJhbmNlIGJhc2VkIG9uIGNvbXBvbmVudCBzaXplXG4gICAqL1xuICBwcm90ZWN0ZWQgdXBkYXRlRm9jdXNSaW5nKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5mb2N1c1JpbmcpIHJldHVybjtcblxuICAgIHRoaXMuZm9jdXNSaW5nLmNsZWFyKCk7XG5cbiAgICBjb25zdCB3aWR0aCA9IHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGg7XG4gICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHQ7XG5cbiAgICBpZiAod2lkdGggPD0gMCB8fCBoZWlnaHQgPD0gMCkgcmV0dXJuO1xuXG4gICAgLy8gQW5pbWF0ZWQgcHVsc2luZyBlZmZlY3Qgd2l0aCBkYXNoZWQgb3V0bGluZVxuICAgIGNvbnN0IG9mZnNldCA9IDQ7XG4gICAgY29uc3Qgc3Ryb2tlV2lkdGggPSAzO1xuXG4gICAgLy8gRHJhdyBvdXRlciBnbG93XG4gICAgdGhpcy5mb2N1c1Jpbmcucm91bmRSZWN0KFxuICAgICAgLW9mZnNldCAtIDIsXG4gICAgICAtb2Zmc2V0IC0gMixcbiAgICAgIHdpZHRoICsgKG9mZnNldCArIDIpICogMixcbiAgICAgIGhlaWdodCArIChvZmZzZXQgKyAyKSAqIDIsXG4gICAgICA4XG4gICAgKTtcbiAgICB0aGlzLmZvY3VzUmluZy5zdHJva2Uoe1xuICAgICAgY29sb3I6IDB4MDBkOWZmLFxuICAgICAgd2lkdGg6IHN0cm9rZVdpZHRoICsgMixcbiAgICAgIGFscGhhOiAwLjNcbiAgICB9KTtcblxuICAgIC8vIERyYXcgbWFpbiBmb2N1cyByaW5nXG4gICAgdGhpcy5mb2N1c1Jpbmcucm91bmRSZWN0KFxuICAgICAgLW9mZnNldCxcbiAgICAgIC1vZmZzZXQsXG4gICAgICB3aWR0aCArIG9mZnNldCAqIDIsXG4gICAgICBoZWlnaHQgKyBvZmZzZXQgKiAyLFxuICAgICAgOFxuICAgICk7XG4gICAgdGhpcy5mb2N1c1Jpbmcuc3Ryb2tlKHtcbiAgICAgIGNvbG9yOiAweDAwZDlmZixcbiAgICAgIHdpZHRoOiBzdHJva2VXaWR0aFxuICAgIH0pO1xuXG4gICAgLy8gRHJhdyBpbm5lciBoaWdobGlnaHRcbiAgICB0aGlzLmZvY3VzUmluZy5yb3VuZFJlY3QoXG4gICAgICAtb2Zmc2V0ICsgc3Ryb2tlV2lkdGgsXG4gICAgICAtb2Zmc2V0ICsgc3Ryb2tlV2lkdGgsXG4gICAgICB3aWR0aCArIChvZmZzZXQgLSBzdHJva2VXaWR0aCkgKiAyLFxuICAgICAgaGVpZ2h0ICsgKG9mZnNldCAtIHN0cm9rZVdpZHRoKSAqIDIsXG4gICAgICA2XG4gICAgKTtcbiAgICB0aGlzLmZvY3VzUmluZy5zdHJva2Uoe1xuICAgICAgY29sb3I6IDB4ZmZmZmZmLFxuICAgICAgd2lkdGg6IDEsXG4gICAgICBhbHBoYTogMC42XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZXMgdGhlIHNpemUgdGhpcyBjb21wb25lbnQgbmVlZHNcbiAgICogTXVzdCBiZSBpbXBsZW1lbnRlZCBieSBzdWJjbGFzc2VzXG4gICAqXG4gICAqIEByZXR1cm5zIFRoZSBtZWFzdXJlZCB3aWR0aCBhbmQgaGVpZ2h0XG4gICAqL1xuICBhYnN0cmFjdCBtZWFzdXJlKCk6IE1lYXN1cmVkU2l6ZTtcblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIGNvbXBvbmVudCB3aXRoaW4gdGhlIGdpdmVuIGF2YWlsYWJsZSBzcGFjZVxuICAgKiBNdXN0IGJlIGltcGxlbWVudGVkIGJ5IHN1YmNsYXNzZXNcbiAgICpcbiAgICogQHBhcmFtIGF2YWlsYWJsZVdpZHRoIC0gQXZhaWxhYmxlIHdpZHRoIGluIHBpeGVsc1xuICAgKiBAcGFyYW0gYXZhaWxhYmxlSGVpZ2h0IC0gQXZhaWxhYmxlIGhlaWdodCBpbiBwaXhlbHNcbiAgICovXG4gIGFic3RyYWN0IGxheW91dChhdmFpbGFibGVXaWR0aDogbnVtYmVyLCBhdmFpbGFibGVIZWlnaHQ6IG51bWJlcik6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIGNvbXBvbmVudCdzIHZpc3VhbHNcbiAgICogQ2FsbGVkIGFmdGVyIGxheW91dCBpcyBjb21wbGV0ZVxuICAgKi9cbiAgcHJvdGVjdGVkIGFic3RyYWN0IHJlbmRlcigpOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBNYXJrcyB0aGlzIGNvbXBvbmVudCdzIGxheW91dCBhcyBkaXJ0eSwgcmVxdWlyaW5nIHJlY2FsY3VsYXRpb25cbiAgICovXG4gIHB1YmxpYyBtYXJrTGF5b3V0RGlydHkoKTogdm9pZCB7XG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IHRydWU7XG4gICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICB0aGlzLnBhcmVudC5tYXJrTGF5b3V0RGlydHkoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY29tcHV0ZWQgbGF5b3V0IG9mIHRoaXMgY29tcG9uZW50XG4gICAqL1xuICBwdWJsaWMgZ2V0TGF5b3V0KCk6IENvbXB1dGVkTGF5b3V0IHtcbiAgICByZXR1cm4gdGhpcy5jb21wdXRlZExheW91dDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBib3ggbW9kZWwgb2YgdGhpcyBjb21wb25lbnRcbiAgICovXG4gIHB1YmxpYyBnZXRCb3hNb2RlbCgpOiBCb3hNb2RlbCB7XG4gICAgcmV0dXJuIHRoaXMuYm94TW9kZWw7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgZ2xvYmFsIGJvdW5kcyBvZiB0aGlzIGNvbXBvbmVudCAocG9zaXRpb24gcmVsYXRpdmUgdG8gc3RhZ2UpXG4gICAqL1xuICBwdWJsaWMgZ2V0R2xvYmFsQm91bmRzKCk6IHsgeDogbnVtYmVyOyB5OiBudW1iZXI7IHdpZHRoOiBudW1iZXI7IGhlaWdodDogbnVtYmVyIH0ge1xuICAgIGNvbnN0IGdsb2JhbFBvcyA9IHRoaXMuY29udGFpbmVyLmdldEdsb2JhbFBvc2l0aW9uKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHg6IGdsb2JhbFBvcy54LFxuICAgICAgeTogZ2xvYmFsUG9zLnksXG4gICAgICB3aWR0aDogdGhpcy5jb21wdXRlZExheW91dC53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5jb21wdXRlZExheW91dC5oZWlnaHRcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHBvc2l0aW9uIG9mIHRoaXMgY29tcG9uZW50XG4gICAqL1xuICBwdWJsaWMgc2V0UG9zaXRpb24oeDogbnVtYmVyLCB5OiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LnggPSB4O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQueSA9IHk7XG4gICAgdGhpcy5jb250YWluZXIucG9zaXRpb24uc2V0KHgsIHkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNob3dzIHRoaXMgY29tcG9uZW50XG4gICAqL1xuICBwdWJsaWMgc2hvdygpOiB2b2lkIHtcbiAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMuY29udGFpbmVyLnZpc2libGUgPSB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEhpZGVzIHRoaXMgY29tcG9uZW50XG4gICAqL1xuICBwdWJsaWMgaGlkZSgpOiB2b2lkIHtcbiAgICB0aGlzLnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmNvbnRhaW5lci52aXNpYmxlID0gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0aGlzIGNvbXBvbmVudCBjYW4gcmVjZWl2ZSBmb2N1c1xuICAgKi9cbiAgcHVibGljIGNhbkZvY3VzKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmVuYWJsZWQgJiYgdGhpcy52aXNpYmxlICYmIHRoaXMudGFiSW5kZXggPj0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoaXMgY29tcG9uZW50IGlzIGN1cnJlbnRseSBmb2N1c2VkXG4gICAqL1xuICBwdWJsaWMgaXNGb2N1c2VkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmZvY3VzZWQ7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gY29tcG9uZW50IHJlY2VpdmVzIGZvY3VzXG4gICAqIE92ZXJyaWRlIGluIHN1YmNsYXNzZXMgdG8gY3VzdG9taXplIGZvY3VzIGJlaGF2aW9yXG4gICAqL1xuICBwdWJsaWMgb25Gb2N1cygpOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzZWQgPSB0cnVlO1xuICAgIHRoaXMuc2hvd0ZvY3VzUmluZygpO1xuICAgIHRoaXMuc2Nyb2xsSW50b1ZpZXcoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTaG93cyB0aGUgZm9jdXMgcmluZ1xuICAgKi9cbiAgcHJvdGVjdGVkIHNob3dGb2N1c1JpbmcoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9jdXNSaW5nKSB7XG4gICAgICB0aGlzLnVwZGF0ZUZvY3VzUmluZygpO1xuICAgICAgdGhpcy5mb2N1c1JpbmcudmlzaWJsZSA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNjcm9sbHMgdGhpcyBjb21wb25lbnQgaW50byB2aWV3IGlmIGl0J3MgaW5zaWRlIGEgc2Nyb2xsIGNvbnRhaW5lclxuICAgKi9cbiAgcHJpdmF0ZSBzY3JvbGxJbnRvVmlldygpOiB2b2lkIHtcbiAgICAvLyBXYWxrIHVwIHRoZSBwYXJlbnQgY2hhaW4gdG8gZmluZCBhIHNjcm9sbCBjb250YWluZXJcbiAgICBsZXQgY3VycmVudFBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgIHdoaWxlIChjdXJyZW50UGFyZW50KSB7XG4gICAgICAvLyBDaGVjayBpZiBwYXJlbnQgaGFzIHNjcm9sbFRvQ29tcG9uZW50IG1ldGhvZCAoZHVjayB0eXBpbmcgZm9yIFVJU2Nyb2xsQ29udGFpbmVyKVxuICAgICAgaWYgKCdzY3JvbGxUb0NvbXBvbmVudCcgaW4gY3VycmVudFBhcmVudCAmJiB0eXBlb2YgKGN1cnJlbnRQYXJlbnQgYXMgYW55KS5zY3JvbGxUb0NvbXBvbmVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAoY3VycmVudFBhcmVudCBhcyBhbnkpLnNjcm9sbFRvQ29tcG9uZW50KHRoaXMpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGN1cnJlbnRQYXJlbnQgPSBjdXJyZW50UGFyZW50LnBhcmVudDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gY29tcG9uZW50IGxvc2VzIGZvY3VzXG4gICAqIE92ZXJyaWRlIGluIHN1YmNsYXNzZXMgdG8gY3VzdG9taXplIGJsdXIgYmVoYXZpb3JcbiAgICovXG4gIHB1YmxpYyBvbkJsdXIoKTogdm9pZCB7XG4gICAgdGhpcy5mb2N1c2VkID0gZmFsc2U7XG4gICAgdGhpcy5oaWRlRm9jdXNSaW5nKCk7XG4gIH1cblxuICAvKipcbiAgICogSGlkZXMgdGhlIGZvY3VzIHJpbmdcbiAgICovXG4gIHByb3RlY3RlZCBoaWRlRm9jdXNSaW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzUmluZykge1xuICAgICAgdGhpcy5mb2N1c1JpbmcudmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZXN0cm95cyB0aGlzIGNvbXBvbmVudCBhbmQgY2xlYW5zIHVwIHJlc291cmNlc1xuICAgKi9cbiAgcHVibGljIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZGVzdHJveSh7IGNoaWxkcmVuOiB0cnVlIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4vdWktY29tcG9uZW50JztcblxuLyoqXG4gKiBJbnRlcmZhY2UgZm9yIGZvY3VzYWJsZSBVSSBjb21wb25lbnRzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRm9jdXNhYmxlIHtcbiAgLyoqIFdoZXRoZXIgdGhpcyBjb21wb25lbnQgY2FuIHJlY2VpdmUgZm9jdXMgKi9cbiAgY2FuRm9jdXMoKTogYm9vbGVhbjtcbiAgLyoqIENhbGxlZCB3aGVuIGNvbXBvbmVudCByZWNlaXZlcyBmb2N1cyAqL1xuICBvbkZvY3VzKCk6IHZvaWQ7XG4gIC8qKiBDYWxsZWQgd2hlbiBjb21wb25lbnQgbG9zZXMgZm9jdXMgKi9cbiAgb25CbHVyKCk6IHZvaWQ7XG4gIC8qKiBUaGUgdGFiIGluZGV4IGZvciBmb2N1cyBvcmRlciAobG93ZXIgdmFsdWVzIGZvY3VzZWQgZmlyc3QpICovXG4gIHRhYkluZGV4OiBudW1iZXI7XG4gIC8qKiBXaGV0aGVyIHRoaXMgY29tcG9uZW50IGlzIGN1cnJlbnRseSBmb2N1c2VkICovXG4gIGlzRm9jdXNlZCgpOiBib29sZWFuO1xufVxuXG4vKipcbiAqIE1hbmFnZXMga2V5Ym9hcmQgZm9jdXMgYW5kIHRhYiBuYXZpZ2F0aW9uIGZvciBVSSBjb21wb25lbnRzXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGZvY3VzTWFuYWdlciA9IG5ldyBVSUZvY3VzTWFuYWdlcigpO1xuICogZm9jdXNNYW5hZ2VyLnJlZ2lzdGVyKGJ1dHRvbjEpO1xuICogZm9jdXNNYW5hZ2VyLnJlZ2lzdGVyKHRleHRJbnB1dDEpO1xuICogZm9jdXNNYW5hZ2VyLnJlZ2lzdGVyKGJ1dHRvbjIpO1xuICpcbiAqIC8vIEZvY3VzIGZpcnN0IGNvbXBvbmVudFxuICogZm9jdXNNYW5hZ2VyLmZvY3VzRmlyc3QoKTtcbiAqXG4gKiAvLyBPciBmb2N1cyBzcGVjaWZpYyBjb21wb25lbnRcbiAqIGZvY3VzTWFuYWdlci5mb2N1cyh0ZXh0SW5wdXQxKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVUlGb2N1c01hbmFnZXIge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogVUlGb2N1c01hbmFnZXIgfCBudWxsID0gbnVsbDtcblxuICBwcml2YXRlIGZvY3VzYWJsZUNvbXBvbmVudHM6IChVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSlbXSA9IFtdO1xuICBwcml2YXRlIGN1cnJlbnRGb2N1c0luZGV4OiBudW1iZXIgPSAtMTtcbiAgcHJpdmF0ZSBrZXlkb3duSGFuZGxlcjogKChlOiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc2V0dXBLZXlib2FyZExpc3RlbmVycygpO1xuICAgIC8vIFNldCBhcyBzaW5nbGV0b24gaW5zdGFuY2VcbiAgICBVSUZvY3VzTWFuYWdlci5pbnN0YW5jZSA9IHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCBnbG9iYWwgZm9jdXMgbWFuYWdlciBpbnN0YW5jZVxuICAgKi9cbiAgc3RhdGljIGdldEluc3RhbmNlKCk6IFVJRm9jdXNNYW5hZ2VyIHwgbnVsbCB7XG4gICAgcmV0dXJuIFVJRm9jdXNNYW5hZ2VyLmluc3RhbmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgZ2xvYmFsIGtleWJvYXJkIGxpc3RlbmVycyBmb3IgdGFiIG5hdmlnYXRpb25cbiAgICovXG4gIHByaXZhdGUgc2V0dXBLZXlib2FyZExpc3RlbmVycygpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybjtcblxuICAgIHRoaXMua2V5ZG93bkhhbmRsZXIgPSAoZTogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgaWYgKGUua2V5ID09PSAnVGFiJykge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgaWYgKGUuc2hpZnRLZXkpIHtcbiAgICAgICAgICB0aGlzLmZvY3VzUHJldmlvdXMoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmZvY3VzTmV4dCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlkb3duSGFuZGxlcik7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXJzIGEgZm9jdXNhYmxlIGNvbXBvbmVudFxuICAgKi9cbiAgcmVnaXN0ZXIoY29tcG9uZW50OiBVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSk6IHZvaWQge1xuICAgIGlmICghdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmluY2x1ZGVzKGNvbXBvbmVudCkpIHtcbiAgICAgIHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgICB0aGlzLnNvcnRCeVRhYkluZGV4KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEF1dG9tYXRpY2FsbHkgZGlzY292ZXJzIGFuZCByZWdpc3RlcnMgYWxsIGZvY3VzYWJsZSBjb21wb25lbnRzIGluIGEgY29udGFpbmVyXG4gICAqIFdhbGtzIHRoZSBjb21wb25lbnQgdHJlZSBhbmQgZmluZHMgYWxsIGNvbXBvbmVudHMgd2l0aCB0YWJJbmRleCA+PSAwXG4gICAqL1xuICByZWdpc3RlckNvbnRhaW5lcihjb250YWluZXI6IFVJQ29tcG9uZW50KTogdm9pZCB7XG4gICAgdGhpcy5kaXNjb3ZlckZvY3VzYWJsZUNvbXBvbmVudHMoY29udGFpbmVyKTtcbiAgICB0aGlzLnNvcnRCeVRhYkluZGV4KCk7XG4gIH1cblxuICAvKipcbiAgICogUmVjdXJzaXZlbHkgZGlzY292ZXJzIGZvY3VzYWJsZSBjb21wb25lbnRzIGluIHRoZSB0cmVlXG4gICAqL1xuICBwcml2YXRlIGRpc2NvdmVyRm9jdXNhYmxlQ29tcG9uZW50cyhjb21wb25lbnQ6IFVJQ29tcG9uZW50KTogdm9pZCB7XG4gICAgY29uc29sZS5sb2coJ/CflI4gRGlzY292ZXJpbmcgaW4gY29tcG9uZW50OicsIGNvbXBvbmVudC5jb25zdHJ1Y3Rvci5uYW1lLCAndGFiSW5kZXg6JywgY29tcG9uZW50LnRhYkluZGV4KTtcblxuICAgIC8vIENoZWNrIGlmIHRoaXMgY29tcG9uZW50IGlzIGZvY3VzYWJsZVxuICAgIGlmICh0aGlzLmlzRm9jdXNhYmxlQ29tcG9uZW50KGNvbXBvbmVudCkpIHtcbiAgICAgIGNvbnNvbGUubG9nKCcgIOKchSBSZWdpc3RlcmluZyBmb2N1c2FibGU6JywgY29tcG9uZW50LmNvbnN0cnVjdG9yLm5hbWUpO1xuICAgICAgdGhpcy5yZWdpc3Rlcihjb21wb25lbnQgYXMgVUlDb21wb25lbnQgJiBGb2N1c2FibGUpO1xuICAgIH1cblxuICAgIC8vIFJlY3Vyc2l2ZWx5IGNoZWNrIGNoaWxkcmVuIChpZiBpdCdzIGEgY29udGFpbmVyIHR5cGUpXG4gICAgaWYgKCdjaGlsZHJlbicgaW4gY29tcG9uZW50ICYmIEFycmF5LmlzQXJyYXkoKGNvbXBvbmVudCBhcyBhbnkpLmNoaWxkcmVuKSkge1xuICAgICAgY29uc3QgY2hpbGRyZW4gPSAoY29tcG9uZW50IGFzIGFueSkuY2hpbGRyZW4gYXMgVUlDb21wb25lbnRbXTtcbiAgICAgIGNvbnNvbGUubG9nKGAgIPCfk6YgSGFzICR7Y2hpbGRyZW4ubGVuZ3RofSBjaGlsZHJlbmApO1xuICAgICAgY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB0aGlzLmRpc2NvdmVyRm9jdXNhYmxlQ29tcG9uZW50cyhjaGlsZCkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgYSBjb21wb25lbnQgaW1wbGVtZW50cyB0aGUgRm9jdXNhYmxlIGludGVyZmFjZVxuICAgKi9cbiAgcHJpdmF0ZSBpc0ZvY3VzYWJsZUNvbXBvbmVudChjb21wb25lbnQ6IFVJQ29tcG9uZW50KTogY29tcG9uZW50IGlzIFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlIHtcbiAgICByZXR1cm4gKFxuICAgICAgdHlwZW9mIGNvbXBvbmVudC50YWJJbmRleCA9PT0gJ251bWJlcicgJiZcbiAgICAgIGNvbXBvbmVudC50YWJJbmRleCA+PSAwICYmXG4gICAgICB0eXBlb2YgY29tcG9uZW50LmNhbkZvY3VzID09PSAnZnVuY3Rpb24nICYmXG4gICAgICB0eXBlb2YgY29tcG9uZW50Lm9uRm9jdXMgPT09ICdmdW5jdGlvbicgJiZcbiAgICAgIHR5cGVvZiBjb21wb25lbnQub25CbHVyID09PSAnZnVuY3Rpb24nICYmXG4gICAgICB0eXBlb2YgY29tcG9uZW50LmlzRm9jdXNlZCA9PT0gJ2Z1bmN0aW9uJ1xuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogVW5yZWdpc3RlcnMgYSBmb2N1c2FibGUgY29tcG9uZW50XG4gICAqL1xuICB1bnJlZ2lzdGVyKGNvbXBvbmVudDogVUlDb21wb25lbnQgJiBGb2N1c2FibGUpOiB2b2lkIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5pbmRleE9mKGNvbXBvbmVudCk7XG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgaWYgKGluZGV4ID09PSB0aGlzLmN1cnJlbnRGb2N1c0luZGV4KSB7XG4gICAgICAgIHRoaXMuYmx1cigpO1xuICAgICAgfVxuICAgICAgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICBpZiAodGhpcy5jdXJyZW50Rm9jdXNJbmRleCA+IGluZGV4KSB7XG4gICAgICAgIHRoaXMuY3VycmVudEZvY3VzSW5kZXgtLTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU29ydHMgY29tcG9uZW50cyBieSB0YWIgaW5kZXhcbiAgICovXG4gIHByaXZhdGUgc29ydEJ5VGFiSW5kZXgoKTogdm9pZCB7XG4gICAgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLnNvcnQoKGEsIGIpID0+IGEudGFiSW5kZXggLSBiLnRhYkluZGV4KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb2N1c2VzIGEgc3BlY2lmaWMgY29tcG9uZW50XG4gICAqL1xuICBmb2N1cyhjb21wb25lbnQ6IFVJQ29tcG9uZW50ICYgRm9jdXNhYmxlKTogdm9pZCB7XG4gICAgaWYgKCFjb21wb25lbnQuY2FuRm9jdXMoKSkge1xuICAgICAgY29uc29sZS5sb2coJ+KdjCBDb21wb25lbnQgY2Fubm90IGZvY3VzJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMuaW5kZXhPZihjb21wb25lbnQpO1xuICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfinYwgQ29tcG9uZW50IG5vdCByZWdpc3RlcmVkIGluIGZvY3VzIG1hbmFnZXInKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhg8J+OryBGb2N1c2luZyBjb21wb25lbnQgYXQgaW5kZXggJHtpbmRleH0sIGN1cnJlbnQgaW5kZXg6ICR7dGhpcy5jdXJyZW50Rm9jdXNJbmRleH1gKTtcblxuICAgIC8vIEJsdXIgY3VycmVudCBmb2N1c1xuICAgIGlmICh0aGlzLmN1cnJlbnRGb2N1c0luZGV4ICE9PSAtMSAmJiB0aGlzLmN1cnJlbnRGb2N1c0luZGV4ICE9PSBpbmRleCkge1xuICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1t0aGlzLmN1cnJlbnRGb2N1c0luZGV4XTtcbiAgICAgIGlmIChjdXJyZW50KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgIPCfkYsgQmx1cnJpbmcgY29tcG9uZW50IGF0IGluZGV4ICR7dGhpcy5jdXJyZW50Rm9jdXNJbmRleH1gKTtcbiAgICAgICAgY3VycmVudC5vbkJsdXIoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGb2N1cyBuZXcgY29tcG9uZW50XG4gICAgdGhpcy5jdXJyZW50Rm9jdXNJbmRleCA9IGluZGV4O1xuICAgIGNvbnNvbGUubG9nKGAgIOKchSBDYWxsaW5nIG9uRm9jdXMoKSBvbiBjb21wb25lbnRgKTtcbiAgICBjb21wb25lbnQub25Gb2N1cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlcXVlc3QgZm9jdXMgZm9yIGEgY29tcG9uZW50IChjYWxsZWQgYnkgY29tcG9uZW50cyB3aGVuIGNsaWNrZWQpXG4gICAqIFRoaXMgaXMgYSBoZWxwZXIgdGhhdCBmaW5kcyB0aGUgY29tcG9uZW50IGFuZCBjYWxscyBmb2N1cygpXG4gICAqL1xuICByZXF1ZXN0Rm9jdXMoY29tcG9uZW50OiBVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSk6IHZvaWQge1xuICAgIHRoaXMuZm9jdXMoY29tcG9uZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCbHVycyB0aGUgY3VycmVudGx5IGZvY3VzZWQgY29tcG9uZW50XG4gICAqL1xuICBibHVyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmN1cnJlbnRGb2N1c0luZGV4ICE9PSAtMSkge1xuICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1t0aGlzLmN1cnJlbnRGb2N1c0luZGV4XTtcbiAgICAgIGlmIChjdXJyZW50KSB7XG4gICAgICAgIGN1cnJlbnQub25CbHVyKCk7XG4gICAgICB9XG4gICAgICB0aGlzLmN1cnJlbnRGb2N1c0luZGV4ID0gLTE7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZvY3VzZXMgdGhlIG5leHQgY29tcG9uZW50IGluIHRhYiBvcmRlclxuICAgKi9cbiAgZm9jdXNOZXh0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBsZXQgbmV4dEluZGV4ID0gdGhpcy5jdXJyZW50Rm9jdXNJbmRleCArIDE7XG4gICAgbGV0IGF0dGVtcHRzID0gMDtcblxuICAgIC8vIEZpbmQgbmV4dCBmb2N1c2FibGUgY29tcG9uZW50XG4gICAgd2hpbGUgKGF0dGVtcHRzIDwgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmxlbmd0aCkge1xuICAgICAgaWYgKG5leHRJbmRleCA+PSB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoKSB7XG4gICAgICAgIG5leHRJbmRleCA9IDA7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50c1tuZXh0SW5kZXhdO1xuICAgICAgaWYgKGNvbXBvbmVudCAmJiBjb21wb25lbnQuY2FuRm9jdXMoKSkge1xuICAgICAgICB0aGlzLmZvY3VzKGNvbXBvbmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbmV4dEluZGV4Kys7XG4gICAgICBhdHRlbXB0cysrO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGb2N1c2VzIHRoZSBwcmV2aW91cyBjb21wb25lbnQgaW4gdGFiIG9yZGVyXG4gICAqL1xuICBmb2N1c1ByZXZpb3VzKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBsZXQgcHJldkluZGV4ID0gdGhpcy5jdXJyZW50Rm9jdXNJbmRleCAtIDE7XG4gICAgbGV0IGF0dGVtcHRzID0gMDtcblxuICAgIC8vIEZpbmQgcHJldmlvdXMgZm9jdXNhYmxlIGNvbXBvbmVudFxuICAgIHdoaWxlIChhdHRlbXB0cyA8IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGgpIHtcbiAgICAgIGlmIChwcmV2SW5kZXggPCAwKSB7XG4gICAgICAgIHByZXZJbmRleCA9IHRoaXMuZm9jdXNhYmxlQ29tcG9uZW50cy5sZW5ndGggLSAxO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjb21wb25lbnQgPSB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHNbcHJldkluZGV4XTtcbiAgICAgIGlmIChjb21wb25lbnQgJiYgY29tcG9uZW50LmNhbkZvY3VzKCkpIHtcbiAgICAgICAgdGhpcy5mb2N1cyhjb21wb25lbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHByZXZJbmRleC0tO1xuICAgICAgYXR0ZW1wdHMrKztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRm9jdXNlcyB0aGUgZmlyc3QgZm9jdXNhYmxlIGNvbXBvbmVudFxuICAgKi9cbiAgZm9jdXNGaXJzdCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgZm9yIChjb25zdCBjb21wb25lbnQgb2YgdGhpcy5mb2N1c2FibGVDb21wb25lbnRzKSB7XG4gICAgICBpZiAoY29tcG9uZW50LmNhbkZvY3VzKCkpIHtcbiAgICAgICAgdGhpcy5mb2N1cyhjb21wb25lbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZvY3VzZXMgdGhlIGxhc3QgZm9jdXNhYmxlIGNvbXBvbmVudFxuICAgKi9cbiAgZm9jdXNMYXN0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBmb3IgKGxldCBpID0gdGhpcy5mb2N1c2FibGVDb21wb25lbnRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBjb25zdCBjb21wb25lbnQgPSB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHNbaV07XG4gICAgICBpZiAoY29tcG9uZW50LmNhbkZvY3VzKCkpIHtcbiAgICAgICAgdGhpcy5mb2N1cyhjb21wb25lbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnRseSBmb2N1c2VkIGNvbXBvbmVudFxuICAgKi9cbiAgZ2V0Q3VycmVudEZvY3VzKCk6IChVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSkgfCBudWxsIHtcbiAgICBpZiAodGhpcy5jdXJyZW50Rm9jdXNJbmRleCA9PT0gLTEpIHJldHVybiBudWxsO1xuICAgIHJldHVybiB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHNbdGhpcy5jdXJyZW50Rm9jdXNJbmRleF0gfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGFsbCByZWdpc3RlcmVkIGZvY3VzYWJsZSBjb21wb25lbnRzXG4gICAqL1xuICBnZXRGb2N1c2FibGVDb21wb25lbnRzKCk6IChVSUNvbXBvbmVudCAmIEZvY3VzYWJsZSlbXSB7XG4gICAgcmV0dXJuIFsuLi50aGlzLmZvY3VzYWJsZUNvbXBvbmVudHNdO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFycyBhbGwgcmVnaXN0ZXJlZCBjb21wb25lbnRzXG4gICAqL1xuICBjbGVhcigpOiB2b2lkIHtcbiAgICB0aGlzLmJsdXIoKTtcbiAgICB0aGlzLmZvY3VzYWJsZUNvbXBvbmVudHMgPSBbXTtcbiAgICB0aGlzLmN1cnJlbnRGb2N1c0luZGV4ID0gLTE7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCB3aGVuIGRlc3Ryb3lpbmcgdGhlIGZvY3VzIG1hbmFnZXJcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHRoaXMua2V5ZG93bkhhbmRsZXIpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlkb3duSGFuZGxlcik7XG4gICAgfVxuICAgIHRoaXMuY2xlYXIoKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4uL2NvcmUvdWktY29tcG9uZW50JztcbmltcG9ydCB7IEJveE1vZGVsLCBNZWFzdXJlZFNpemUgfSBmcm9tICcuLi9jb3JlL2JveC1tb2RlbCc7XG5pbXBvcnQgeyBFZGdlSW5zZXRzIH0gZnJvbSAnLi4vY29yZS9lZGdlLWluc2V0cyc7XG5cbi8qKlxuICogRmxleGJveCBkaXJlY3Rpb24gKGhvdyBjaGlsZHJlbiBhcmUgYXJyYW5nZWQpXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBlbnVtIEZsZXhEaXJlY3Rpb24ge1xuICBSb3cgPSAncm93JywgICAgICAgICAgICAgIC8vIEhvcml6b250YWwsIGxlZnQgdG8gcmlnaHRcbiAgUm93UmV2ZXJzZSA9ICdyb3ctcmV2ZXJzZScsXG4gIENvbHVtbiA9ICdjb2x1bW4nLCAgICAgICAgLy8gVmVydGljYWwsIHRvcCB0byBib3R0b21cbiAgQ29sdW1uUmV2ZXJzZSA9ICdjb2x1bW4tcmV2ZXJzZSdcbn1cblxuLyoqXG4gKiBGbGV4Ym94IGp1c3RpZnkgY29udGVudCAobWFpbiBheGlzIGFsaWdubWVudClcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGVudW0gRmxleEp1c3RpZnkge1xuICBTdGFydCA9ICdzdGFydCcsICAgICAgICAgIC8vIFBhY2sgaXRlbXMgdG8gc3RhcnRcbiAgRW5kID0gJ2VuZCcsICAgICAgICAgICAgICAvLyBQYWNrIGl0ZW1zIHRvIGVuZFxuICBDZW50ZXIgPSAnY2VudGVyJywgICAgICAgIC8vIENlbnRlciBpdGVtc1xuICBTcGFjZUJldHdlZW4gPSAnc3BhY2UtYmV0d2VlbicsICAvLyBTcGFjZSBiZXR3ZWVuIGl0ZW1zXG4gIFNwYWNlQXJvdW5kID0gJ3NwYWNlLWFyb3VuZCcsICAgIC8vIFNwYWNlIGFyb3VuZCBpdGVtc1xuICBTcGFjZUV2ZW5seSA9ICdzcGFjZS1ldmVubHknICAgICAvLyBFdmVuIHNwYWNlIGJldHdlZW4gaXRlbXNcbn1cblxuLyoqXG4gKiBGbGV4Ym94IGFsaWduIGl0ZW1zIChjcm9zcyBheGlzIGFsaWdubWVudClcbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqL1xuZXhwb3J0IGVudW0gRmxleEFsaWduIHtcbiAgU3RhcnQgPSAnc3RhcnQnLFxuICBFbmQgPSAnZW5kJyxcbiAgQ2VudGVyID0gJ2NlbnRlcicsXG4gIFN0cmV0Y2ggPSAnc3RyZXRjaCcgICAgICAgLy8gU3RyZXRjaCB0byBmaWxsIGNyb3NzIGF4aXNcbn1cblxuLyoqXG4gKiBQcm9wcyBmb3IgY29uZmlndXJpbmcgYSBGbGV4Q29udGFpbmVyXG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRmxleENvbnRhaW5lclByb3BzIHtcbiAgZGlyZWN0aW9uPzogRmxleERpcmVjdGlvbjtcbiAganVzdGlmeT86IEZsZXhKdXN0aWZ5O1xuICBhbGlnbj86IEZsZXhBbGlnbjtcbiAgZ2FwPzogbnVtYmVyOyAgICAgICAgICAgICAgLy8gU3BhY2UgYmV0d2VlbiBjaGlsZHJlblxuICB3cmFwPzogYm9vbGVhbjsgICAgICAgICAgICAvLyBBbGxvdyB3cmFwcGluZyAoUGhhc2UgMilcbiAgcGFkZGluZz86IEVkZ2VJbnNldHM7XG4gIHdpZHRoPzogbnVtYmVyIHwgJ2ZpbGwnO1xuICBoZWlnaHQ/OiBudW1iZXIgfCAnZmlsbCc7XG59XG5cbi8qKlxuICogQSBmbGV4Ym94LXN0eWxlIGxheW91dCBjb250YWluZXJcbiAqIEFycmFuZ2VzIGNoaWxkcmVuIGluIHJvd3Mgb3IgY29sdW1ucyB3aXRoIGZsZXhpYmxlIHNpemluZyBhbmQgYWxpZ25tZW50XG4gKlxuICogQGNhdGVnb3J5IFVJXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGNvbnRhaW5lciA9IG5ldyBGbGV4Q29udGFpbmVyKHtcbiAqICAgZGlyZWN0aW9uOiBGbGV4RGlyZWN0aW9uLlJvdyxcbiAqICAganVzdGlmeTogRmxleEp1c3RpZnkuQ2VudGVyLFxuICogICBnYXA6IDEwLFxuICogICBwYWRkaW5nOiBFZGdlSW5zZXRzLmFsbCgyMClcbiAqIH0pO1xuICpcbiAqIGNvbnRhaW5lci5hZGRDaGlsZChib3gxKTtcbiAqIGNvbnRhaW5lci5hZGRDaGlsZChib3gyKTtcbiAqIGNvbnRhaW5lci5hZGRDaGlsZChib3gzKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgRmxleENvbnRhaW5lciBleHRlbmRzIFVJQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBwcm9wczogUmVxdWlyZWQ8T21pdDxGbGV4Q29udGFpbmVyUHJvcHMsICdwYWRkaW5nJyB8ICd3aWR0aCcgfCAnaGVpZ2h0Jz4+O1xuICBwdWJsaWMgY2hpbGRyZW46IFVJQ29tcG9uZW50W10gPSBbXTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogRmxleENvbnRhaW5lclByb3BzID0ge30pIHtcbiAgICBjb25zdCBib3hNb2RlbDogUGFydGlhbDxCb3hNb2RlbD4gPSB7XG4gICAgICBwYWRkaW5nOiBwcm9wcy5wYWRkaW5nID8/IEVkZ2VJbnNldHMuemVybygpLFxuICAgICAgd2lkdGg6IHByb3BzLndpZHRoID8/ICdhdXRvJyxcbiAgICAgIGhlaWdodDogcHJvcHMuaGVpZ2h0ID8/ICdhdXRvJ1xuICAgIH07XG5cbiAgICBzdXBlcihib3hNb2RlbCk7XG5cbiAgICB0aGlzLnByb3BzID0ge1xuICAgICAgZGlyZWN0aW9uOiBwcm9wcy5kaXJlY3Rpb24gPz8gRmxleERpcmVjdGlvbi5Sb3csXG4gICAgICBqdXN0aWZ5OiBwcm9wcy5qdXN0aWZ5ID8/IEZsZXhKdXN0aWZ5LlN0YXJ0LFxuICAgICAgYWxpZ246IHByb3BzLmFsaWduID8/IEZsZXhBbGlnbi5TdGFydCxcbiAgICAgIGdhcDogcHJvcHMuZ2FwID8/IDAsXG4gICAgICB3cmFwOiBwcm9wcy53cmFwID8/IGZhbHNlXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgY2hpbGQgY29tcG9uZW50IHRvIHRoaXMgY29udGFpbmVyXG4gICAqL1xuICBhZGRDaGlsZChjaGlsZDogVUlDb21wb25lbnQpOiB2b2lkIHtcbiAgICBjaGlsZC5wYXJlbnQgPSB0aGlzO1xuICAgIHRoaXMuY2hpbGRyZW4ucHVzaChjaGlsZCk7XG4gICAgdGhpcy5jb250YWluZXIuYWRkQ2hpbGQoY2hpbGQuY29udGFpbmVyKTtcbiAgICB0aGlzLm1hcmtMYXlvdXREaXJ0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgYSBjaGlsZCBjb21wb25lbnQgZnJvbSB0aGlzIGNvbnRhaW5lclxuICAgKi9cbiAgcmVtb3ZlQ2hpbGQoY2hpbGQ6IFVJQ29tcG9uZW50KTogdm9pZCB7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmNoaWxkcmVuLmluZGV4T2YoY2hpbGQpO1xuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIHRoaXMuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIHRoaXMuY29udGFpbmVyLnJlbW92ZUNoaWxkKGNoaWxkLmNvbnRhaW5lcik7XG4gICAgICBjaGlsZC5wYXJlbnQgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLm1hcmtMYXlvdXREaXJ0eSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNZWFzdXJlcyB0aGUgc2l6ZSBuZWVkZWQgZm9yIHRoaXMgY29udGFpbmVyIGFuZCBpdHMgY2hpbGRyZW5cbiAgICovXG4gIG1lYXN1cmUoKTogTWVhc3VyZWRTaXplIHtcbiAgICBpZiAodGhpcy5jaGlsZHJlbi5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogcGFkZGluZy5ob3Jpem9udGFsLFxuICAgICAgICBoZWlnaHQ6IHBhZGRpbmcudmVydGljYWxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gTWVhc3VyZSBhbGwgY2hpbGRyZW5cbiAgICBjb25zdCBjaGlsZFNpemVzID0gdGhpcy5jaGlsZHJlbi5tYXAoY2hpbGQgPT4gY2hpbGQubWVhc3VyZSgpKTtcbiAgICBjb25zdCB7IGRpcmVjdGlvbiwgZ2FwIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmJveE1vZGVsLnBhZGRpbmc7XG5cbiAgICBjb25zdCBpc1JvdyA9IGRpcmVjdGlvbiA9PT0gRmxleERpcmVjdGlvbi5Sb3cgfHwgZGlyZWN0aW9uID09PSBGbGV4RGlyZWN0aW9uLlJvd1JldmVyc2U7XG4gICAgY29uc3QgdG90YWxHYXAgPSBnYXAgKiAodGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxKTtcblxuICAgIGxldCBtZWFzdXJlZFdpZHRoID0gMDtcbiAgICBsZXQgbWVhc3VyZWRIZWlnaHQgPSAwO1xuXG4gICAgaWYgKGlzUm93KSB7XG4gICAgICAvLyBSb3c6IHN1bSB3aWR0aHMsIG1heCBoZWlnaHRcbiAgICAgIG1lYXN1cmVkV2lkdGggPSBjaGlsZFNpemVzLnJlZHVjZSgoc3VtLCBzaXplKSA9PiBzdW0gKyBzaXplLndpZHRoLCAwKSArIHRvdGFsR2FwO1xuICAgICAgbWVhc3VyZWRIZWlnaHQgPSBNYXRoLm1heCguLi5jaGlsZFNpemVzLm1hcChzaXplID0+IHNpemUuaGVpZ2h0KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIENvbHVtbjogbWF4IHdpZHRoLCBzdW0gaGVpZ2h0c1xuICAgICAgbWVhc3VyZWRXaWR0aCA9IE1hdGgubWF4KC4uLmNoaWxkU2l6ZXMubWFwKHNpemUgPT4gc2l6ZS53aWR0aCkpO1xuICAgICAgbWVhc3VyZWRIZWlnaHQgPSBjaGlsZFNpemVzLnJlZHVjZSgoc3VtLCBzaXplKSA9PiBzdW0gKyBzaXplLmhlaWdodCwgMCkgKyB0b3RhbEdhcDtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IG1lYXN1cmVkV2lkdGggKyBwYWRkaW5nLmhvcml6b250YWwsXG4gICAgICBoZWlnaHQ6IG1lYXN1cmVkSGVpZ2h0ICsgcGFkZGluZy52ZXJ0aWNhbFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgbGF5b3V0IGZvciB0aGlzIGNvbnRhaW5lciBhbmQgcG9zaXRpb25zIGNoaWxkcmVuXG4gICAqL1xuICBsYXlvdXQoYXZhaWxhYmxlV2lkdGg6IG51bWJlciwgYXZhaWxhYmxlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBwYWRkaW5nID0gdGhpcy5ib3hNb2RlbC5wYWRkaW5nO1xuICAgIGNvbnN0IHsgZGlyZWN0aW9uLCBqdXN0aWZ5LCBhbGlnbiwgZ2FwIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgLy8gRGV0ZXJtaW5lIGNvbnRhaW5lciBzaXplXG4gICAgbGV0IGNvbnRhaW5lcldpZHRoOiBudW1iZXI7XG4gICAgbGV0IGNvbnRhaW5lckhlaWdodDogbnVtYmVyO1xuXG4gICAgaWYgKHRoaXMuYm94TW9kZWwud2lkdGggPT09ICdmaWxsJykge1xuICAgICAgY29udGFpbmVyV2lkdGggPSBhdmFpbGFibGVXaWR0aDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aGlzLmJveE1vZGVsLndpZHRoID09PSAnbnVtYmVyJykge1xuICAgICAgY29udGFpbmVyV2lkdGggPSB0aGlzLmJveE1vZGVsLndpZHRoO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBtZWFzdXJlZCA9IHRoaXMubWVhc3VyZSgpO1xuICAgICAgY29udGFpbmVyV2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5ib3hNb2RlbC5oZWlnaHQgPT09ICdmaWxsJykge1xuICAgICAgY29udGFpbmVySGVpZ2h0ID0gYXZhaWxhYmxlSGVpZ2h0O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMuYm94TW9kZWwuaGVpZ2h0ID09PSAnbnVtYmVyJykge1xuICAgICAgY29udGFpbmVySGVpZ2h0ID0gdGhpcy5ib3hNb2RlbC5oZWlnaHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IG1lYXN1cmVkID0gdGhpcy5tZWFzdXJlKCk7XG4gICAgICBjb250YWluZXJIZWlnaHQgPSBtZWFzdXJlZC5oZWlnaHQ7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGNvbXB1dGVkIGxheW91dFxuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQud2lkdGggPSBjb250YWluZXJXaWR0aDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmhlaWdodCA9IGNvbnRhaW5lckhlaWdodDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRYID0gcGFkZGluZy5sZWZ0O1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudFkgPSBwYWRkaW5nLnRvcDtcbiAgICB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRXaWR0aCA9IGNvbnRhaW5lcldpZHRoIC0gcGFkZGluZy5ob3Jpem9udGFsO1xuICAgIHRoaXMuY29tcHV0ZWRMYXlvdXQuY29udGVudEhlaWdodCA9IGNvbnRhaW5lckhlaWdodCAtIHBhZGRpbmcudmVydGljYWw7XG5cbiAgICAvLyBMYXlvdXQgY2hpbGRyZW5cbiAgICBpZiAodGhpcy5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmxheW91dENoaWxkcmVuKCk7XG4gICAgfVxuXG4gICAgdGhpcy5sYXlvdXREaXJ0eSA9IGZhbHNlO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogTGF5b3V0cyBhbmQgcG9zaXRpb25zIGNoaWxkIGNvbXBvbmVudHNcbiAgICovXG4gIHByaXZhdGUgbGF5b3V0Q2hpbGRyZW4oKTogdm9pZCB7XG4gICAgY29uc3QgeyBkaXJlY3Rpb24sIGp1c3RpZnksIGFsaWduLCBnYXAgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuYm94TW9kZWwucGFkZGluZztcbiAgICBjb25zdCBjb250ZW50V2lkdGggPSB0aGlzLmNvbXB1dGVkTGF5b3V0LmNvbnRlbnRXaWR0aDtcbiAgICBjb25zdCBjb250ZW50SGVpZ2h0ID0gdGhpcy5jb21wdXRlZExheW91dC5jb250ZW50SGVpZ2h0O1xuXG4gICAgY29uc3QgaXNSb3cgPSBkaXJlY3Rpb24gPT09IEZsZXhEaXJlY3Rpb24uUm93IHx8IGRpcmVjdGlvbiA9PT0gRmxleERpcmVjdGlvbi5Sb3dSZXZlcnNlO1xuXG4gICAgLy8gTWVhc3VyZSBjaGlsZHJlblxuICAgIGNvbnN0IGNoaWxkU2l6ZXMgPSB0aGlzLmNoaWxkcmVuLm1hcChjaGlsZCA9PiBjaGlsZC5tZWFzdXJlKCkpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIHRvdGFsIG1haW4gYXhpcyBzaXplXG4gICAgY29uc3QgdG90YWxHYXAgPSBnYXAgKiAodGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxKTtcbiAgICBjb25zdCB0b3RhbENoaWxkU2l6ZSA9IGlzUm93XG4gICAgICA/IGNoaWxkU2l6ZXMucmVkdWNlKChzdW0sIHNpemUpID0+IHN1bSArIHNpemUud2lkdGgsIDApXG4gICAgICA6IGNoaWxkU2l6ZXMucmVkdWNlKChzdW0sIHNpemUpID0+IHN1bSArIHNpemUuaGVpZ2h0LCAwKTtcblxuICAgIGNvbnN0IG1haW5BeGlzU2l6ZSA9IGlzUm93ID8gY29udGVudFdpZHRoIDogY29udGVudEhlaWdodDtcbiAgICBjb25zdCBjcm9zc0F4aXNTaXplID0gaXNSb3cgPyBjb250ZW50SGVpZ2h0IDogY29udGVudFdpZHRoO1xuICAgIGNvbnN0IGZyZWVTcGFjZSA9IG1haW5BeGlzU2l6ZSAtIHRvdGFsQ2hpbGRTaXplIC0gdG90YWxHYXA7XG5cbiAgICAvLyBDYWxjdWxhdGUgc3RhcnRpbmcgcG9zaXRpb24gYmFzZWQgb24ganVzdGlmeVxuICAgIGxldCBtYWluQXhpc09mZnNldCA9IDA7XG4gICAgbGV0IHNwYWNlQmV0d2VlbiA9IDA7XG5cbiAgICBzd2l0Y2ggKGp1c3RpZnkpIHtcbiAgICAgIGNhc2UgRmxleEp1c3RpZnkuU3RhcnQ6XG4gICAgICAgIG1haW5BeGlzT2Zmc2V0ID0gMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEZsZXhKdXN0aWZ5LkVuZDpcbiAgICAgICAgbWFpbkF4aXNPZmZzZXQgPSBmcmVlU3BhY2U7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBGbGV4SnVzdGlmeS5DZW50ZXI6XG4gICAgICAgIG1haW5BeGlzT2Zmc2V0ID0gZnJlZVNwYWNlIC8gMjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEZsZXhKdXN0aWZ5LlNwYWNlQmV0d2VlbjpcbiAgICAgICAgc3BhY2VCZXR3ZWVuID0gdGhpcy5jaGlsZHJlbi5sZW5ndGggPiAxID8gZnJlZVNwYWNlIC8gKHRoaXMuY2hpbGRyZW4ubGVuZ3RoIC0gMSkgOiAwO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgRmxleEp1c3RpZnkuU3BhY2VBcm91bmQ6XG4gICAgICAgIHNwYWNlQmV0d2VlbiA9IGZyZWVTcGFjZSAvIHRoaXMuY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICBtYWluQXhpc09mZnNldCA9IHNwYWNlQmV0d2VlbiAvIDI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBGbGV4SnVzdGlmeS5TcGFjZUV2ZW5seTpcbiAgICAgICAgc3BhY2VCZXR3ZWVuID0gZnJlZVNwYWNlIC8gKHRoaXMuY2hpbGRyZW4ubGVuZ3RoICsgMSk7XG4gICAgICAgIG1haW5BeGlzT2Zmc2V0ID0gc3BhY2VCZXR3ZWVuO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICAvLyBQb3NpdGlvbiBjaGlsZHJlblxuICAgIGxldCBjdXJyZW50UG9zaXRpb24gPSBtYWluQXhpc09mZnNldDtcblxuICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBjaGlsZFNpemUgPSBjaGlsZFNpemVzW2luZGV4XTtcblxuICAgICAgLy8gTGF5b3V0IGNoaWxkXG4gICAgICBjaGlsZC5sYXlvdXQoY2hpbGRTaXplLndpZHRoLCBjaGlsZFNpemUuaGVpZ2h0KTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIGNyb3NzIGF4aXMgcG9zaXRpb24gYmFzZWQgb24gYWxpZ25cbiAgICAgIGxldCBjcm9zc0F4aXNQb3NpdGlvbiA9IDA7XG5cbiAgICAgIHN3aXRjaCAoYWxpZ24pIHtcbiAgICAgICAgY2FzZSBGbGV4QWxpZ24uU3RhcnQ6XG4gICAgICAgICAgY3Jvc3NBeGlzUG9zaXRpb24gPSAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEZsZXhBbGlnbi5FbmQ6XG4gICAgICAgICAgY3Jvc3NBeGlzUG9zaXRpb24gPSBjcm9zc0F4aXNTaXplIC0gKGlzUm93ID8gY2hpbGRTaXplLmhlaWdodCA6IGNoaWxkU2l6ZS53aWR0aCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgRmxleEFsaWduLkNlbnRlcjpcbiAgICAgICAgICBjcm9zc0F4aXNQb3NpdGlvbiA9IChjcm9zc0F4aXNTaXplIC0gKGlzUm93ID8gY2hpbGRTaXplLmhlaWdodCA6IGNoaWxkU2l6ZS53aWR0aCkpIC8gMjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGbGV4QWxpZ24uU3RyZXRjaDpcbiAgICAgICAgICAvLyBTdHJldGNoIGNoaWxkIHRvIGZpbGwgY3Jvc3MgYXhpcyAoaW1wbGVtZW50IGxhdGVyKVxuICAgICAgICAgIGNyb3NzQXhpc1Bvc2l0aW9uID0gMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgLy8gU2V0IGNoaWxkIHBvc2l0aW9uXG4gICAgICBpZiAoaXNSb3cpIHtcbiAgICAgICAgY2hpbGQuc2V0UG9zaXRpb24oXG4gICAgICAgICAgcGFkZGluZy5sZWZ0ICsgY3VycmVudFBvc2l0aW9uLFxuICAgICAgICAgIHBhZGRpbmcudG9wICsgY3Jvc3NBeGlzUG9zaXRpb25cbiAgICAgICAgKTtcbiAgICAgICAgY3VycmVudFBvc2l0aW9uICs9IGNoaWxkU2l6ZS53aWR0aCArIGdhcCArIHNwYWNlQmV0d2VlbjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoaWxkLnNldFBvc2l0aW9uKFxuICAgICAgICAgIHBhZGRpbmcubGVmdCArIGNyb3NzQXhpc1Bvc2l0aW9uLFxuICAgICAgICAgIHBhZGRpbmcudG9wICsgY3VycmVudFBvc2l0aW9uXG4gICAgICAgICk7XG4gICAgICAgIGN1cnJlbnRQb3NpdGlvbiArPSBjaGlsZFNpemUuaGVpZ2h0ICsgZ2FwICsgc3BhY2VCZXR3ZWVuO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIGNvbnRhaW5lciAoY3VycmVudGx5IG5vIHZpc3VhbCByZXByZXNlbnRhdGlvbilcbiAgICovXG4gIHByb3RlY3RlZCByZW5kZXIoKTogdm9pZCB7XG4gICAgLy8gRmxleENvbnRhaW5lciBpdHNlbGYgaGFzIG5vIHZpc3VhbCByZXByZXNlbnRhdGlvblxuICAgIC8vIENvdWxkIGFkZCBkZWJ1ZyBib3JkZXJzIGhlcmUgaWYgbmVlZGVkXG4gIH1cbn1cbiIsIi8qKlxuICogUGl4ZWwtUGVyZmVjdCBHcmlkIFN5c3RlbVxuICpcbiAqIFByb3ZpZGVzIGEgY29uc2lzdGVudCBncmlkLWJhc2VkIGxheW91dCBzeXN0ZW0gZm9yIHBpeGVsLXBlcmZlY3QgVUlzLFxuICogY29tbW9ubHkgdXNlZCBpbiByZXRyby1zdHlsZSBnYW1lcyBhbmQgcGl4ZWwgYXJ0IGFwcGxpY2F0aW9ucy5cbiAqXG4gKiBAY2F0ZWdvcnkgVUlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogLy8gVXNlIHRoZSBkZWZhdWx0IGdyaWRcbiAqIGNvbnN0IHdpZHRoID0gcHgoMTApOyAvLyAxMCBncmlkIHVuaXRzID0gNDAgcGl4ZWxzIGF0IDR4IHNjYWxlXG4gKlxuICogLy8gQ3JlYXRlIGEgY3VzdG9tIGdyaWRcbiAqIGNvbnN0IGN1c3RvbUdyaWQgPSBuZXcgUGl4ZWxHcmlkKHtcbiAqICAgdW5pdDogMSxcbiAqICAgc2NhbGU6IDIsICAvLyAyeCBzY2FsZSBpbnN0ZWFkIG9mIDR4XG4gKiAgIGJvcmRlcjogMSxcbiAqICAgcGFkZGluZzogMixcbiAqICAgZ2FwOiAxXG4gKiB9KTtcbiAqIGNvbnN0IHdpZHRoID0gY3VzdG9tR3JpZC5weCgxMCk7IC8vIDIwIHBpeGVscyBhdCAyeCBzY2FsZVxuICogYGBgXG4gKi9cblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIGZvciBhIHBpeGVsIGdyaWQgc3lzdGVtXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUGl4ZWxHcmlkQ29uZmlnIHtcbiAgLyoqIEJhc2UgcGl4ZWwgdW5pdCBhdCAxeCBzY2FsZSAoZGVmYXVsdDogMSkgKi9cbiAgdW5pdD86IG51bWJlcjtcbiAgLyoqIFNjYWxlIG11bHRpcGxpZXIgZm9yIGFsbCBtZWFzdXJlbWVudHMgKGRlZmF1bHQ6IDQpICovXG4gIHNjYWxlPzogbnVtYmVyO1xuICAvKiogQm9yZGVyIHdpZHRoIGluIGdyaWQgdW5pdHMgKGRlZmF1bHQ6IDEpICovXG4gIGJvcmRlcj86IG51bWJlcjtcbiAgLyoqIFN0YW5kYXJkIHBhZGRpbmcgaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogMSkgKi9cbiAgcGFkZGluZz86IG51bWJlcjtcbiAgLyoqIEdhcCBiZXR3ZWVuIGVsZW1lbnRzIGluIGdyaWQgdW5pdHMgKGRlZmF1bHQ6IDEpICovXG4gIGdhcD86IG51bWJlcjtcbiAgLyoqIEZvbnQgc2NhbGUgbXVsdGlwbGllciAoZGVmYXVsdDogMC4yNSwgZS5nLiwgNjRweCAqIDAuMjUgPSAxNnB4KSAqL1xuICBmb250U2NhbGU/OiBudW1iZXI7XG59XG5cbi8qKlxuICogQm9yZGVyIGNvbmZpZ3VyYXRpb24gZm9yIG11bHRpLWxheWVyIGJvcmRlcnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBCb3JkZXJDb25maWcge1xuICAvKiogT3V0ZXIgYm9yZGVyIHdpZHRoIGluIGdyaWQgdW5pdHMgKGRlZmF1bHQ6IDEpICovXG4gIG91dGVyPzogbnVtYmVyO1xuICAvKiogTWlkZGxlIGJvcmRlciB3aWR0aCBpbiBncmlkIHVuaXRzIChkZWZhdWx0OiAxKSAqL1xuICBtaWRkbGU/OiBudW1iZXI7XG4gIC8qKiBJbm5lciBib3JkZXIgd2lkdGggaW4gZ3JpZCB1bml0cyAoZGVmYXVsdDogMSkgKi9cbiAgaW5uZXI/OiBudW1iZXI7XG4gIC8qKiBUb3RhbCBib3JkZXIgd2lkdGggKGNhbGN1bGF0ZWQgYXV0b21hdGljYWxseSkgKi9cbiAgdG90YWw/OiBudW1iZXI7XG59XG5cbi8qKlxuICogQSBwaXhlbC1wZXJmZWN0IGdyaWQgc3lzdGVtIGZvciBjb25zaXN0ZW50IFVJIG1lYXN1cmVtZW50c1xuICpcbiAqIEFsbCBtZWFzdXJlbWVudHMgYXJlIGluIGdyaWQgdW5pdHMgdGhhdCBnZXQgc2NhbGVkIHRvIGFjdHVhbCBwaXhlbHMuXG4gKiBUaGlzIGVuc3VyZXMgcGl4ZWwtcGVyZmVjdCBhbGlnbm1lbnQgYXQgYW55IHNjYWxlIGZhY3Rvci5cbiAqL1xuZXhwb3J0IGNsYXNzIFBpeGVsR3JpZCB7XG4gIHB1YmxpYyByZWFkb25seSB1bml0OiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSBzY2FsZTogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgYm9yZGVyOiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSBwYWRkaW5nOiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSBnYXA6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IGZvbnRTY2FsZTogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogUGl4ZWxHcmlkQ29uZmlnID0ge30pIHtcbiAgICB0aGlzLnVuaXQgPSBjb25maWcudW5pdCA/PyAxO1xuICAgIHRoaXMuc2NhbGUgPSBjb25maWcuc2NhbGUgPz8gNDtcbiAgICB0aGlzLmJvcmRlciA9IGNvbmZpZy5ib3JkZXIgPz8gMTtcbiAgICB0aGlzLnBhZGRpbmcgPSBjb25maWcucGFkZGluZyA/PyAxO1xuICAgIHRoaXMuZ2FwID0gY29uZmlnLmdhcCA/PyAxO1xuICAgIHRoaXMuZm9udFNjYWxlID0gY29uZmlnLmZvbnRTY2FsZSA/PyAwLjI1O1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgZ3JpZCB1bml0cyB0byBhY3R1YWwgcGl4ZWxzXG4gICAqIEBwYXJhbSB1bml0cyAtIE51bWJlciBvZiBncmlkIHVuaXRzXG4gICAqIEByZXR1cm5zIEFjdHVhbCBwaXhlbCB2YWx1ZVxuICAgKi9cbiAgcHgodW5pdHM6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHVuaXRzICogdGhpcy51bml0ICogdGhpcy5zY2FsZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IHBpeGVscyB0byBncmlkIHVuaXRzXG4gICAqIEBwYXJhbSBwaXhlbHMgLSBOdW1iZXIgb2YgcGl4ZWxzXG4gICAqIEByZXR1cm5zIEdyaWQgdW5pdHMgKHJvdW5kZWQpXG4gICAqL1xuICB1bml0cyhwaXhlbHM6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGgucm91bmQocGl4ZWxzIC8gKHRoaXMudW5pdCAqIHRoaXMuc2NhbGUpKTtcbiAgfVxufVxuXG4vKipcbiAqIERlZmF1bHQgcGl4ZWwgZ3JpZCBpbnN0YW5jZVxuICogLSAxcHggYmFzZSB1bml0XG4gKiAtIDR4IHNjYWxlIChjb21tb24gZm9yIHJldHJvL3BpeGVsIGdhbWVzKVxuICogLSAxIHVuaXQgYm9yZGVycywgcGFkZGluZywgYW5kIGdhcHNcbiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfUElYRUxfR1JJRCA9IG5ldyBQaXhlbEdyaWQoKTtcblxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gY29udmVydCBncmlkIHVuaXRzIHRvIHBpeGVscyB1c2luZyB0aGUgZGVmYXVsdCBncmlkXG4gKiBAcGFyYW0gdW5pdHMgLSBOdW1iZXIgb2YgZ3JpZCB1bml0c1xuICogQHJldHVybnMgQWN0dWFsIHBpeGVsIHZhbHVlXG4gKi9cbmV4cG9ydCBjb25zdCBweCA9ICh1bml0czogbnVtYmVyKTogbnVtYmVyID0+IERFRkFVTFRfUElYRUxfR1JJRC5weCh1bml0cyk7XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgcGl4ZWxzIHRvIGdyaWQgdW5pdHMgdXNpbmcgdGhlIGRlZmF1bHQgZ3JpZFxuICogQHBhcmFtIHBpeGVscyAtIE51bWJlciBvZiBwaXhlbHNcbiAqIEByZXR1cm5zIEdyaWQgdW5pdHMgKHJvdW5kZWQpXG4gKi9cbmV4cG9ydCBjb25zdCB1bml0cyA9IChwaXhlbHM6IG51bWJlcik6IG51bWJlciA9PiBERUZBVUxUX1BJWEVMX0dSSUQudW5pdHMocGl4ZWxzKTtcblxuLyoqXG4gKiBEZWZhdWx0IGdyaWQgY29uc3RhbnRzIGZvciBlYXN5IGFjY2Vzc1xuICovXG5leHBvcnQgY29uc3QgR1JJRCA9IHtcbiAgdW5pdDogREVGQVVMVF9QSVhFTF9HUklELnVuaXQsXG4gIHNjYWxlOiBERUZBVUxUX1BJWEVMX0dSSUQuc2NhbGUsXG4gIGJvcmRlcjogREVGQVVMVF9QSVhFTF9HUklELmJvcmRlcixcbiAgcGFkZGluZzogREVGQVVMVF9QSVhFTF9HUklELnBhZGRpbmcsXG4gIGdhcDogREVGQVVMVF9QSVhFTF9HUklELmdhcCxcbiAgZm9udFNjYWxlOiBERUZBVUxUX1BJWEVMX0dSSUQuZm9udFNjYWxlXG59IGFzIGNvbnN0O1xuXG4vKipcbiAqIERlZmF1bHQgYm9yZGVyIGNvbmZpZ3VyYXRpb24gKHRyaXBsZSBib3JkZXI6IG91dGVyL21pZGRsZS9pbm5lcilcbiAqL1xuZXhwb3J0IGNvbnN0IEJPUkRFUiA9IHtcbiAgb3V0ZXI6IDEsICAgLy8gT3V0ZXIgYm9yZGVyICgxIGdyaWQgdW5pdClcbiAgbWlkZGxlOiAxLCAgLy8gTWlkZGxlIGJvcmRlciAoMSBncmlkIHVuaXQpXG4gIGlubmVyOiAxLCAgIC8vIElubmVyIGJvcmRlciAoMSBncmlkIHVuaXQpXG4gIHRvdGFsOiAzICAgIC8vIFRvdGFsIGJvcmRlciB3aWR0aCAoMyBncmlkIHVuaXRzKVxufSBhcyBjb25zdDtcblxuLyoqXG4gKiBDcmVhdGUgYSBjdXN0b20gYm9yZGVyIGNvbmZpZ3VyYXRpb25cbiAqIEBwYXJhbSBjb25maWcgLSBCb3JkZXIgY29uZmlndXJhdGlvblxuICogQHJldHVybnMgQm9yZGVyIGNvbmZpZ3VyYXRpb24gd2l0aCBjYWxjdWxhdGVkIHRvdGFsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVCb3JkZXJDb25maWcoY29uZmlnOiBCb3JkZXJDb25maWcgPSB7fSk6IFJlcXVpcmVkPEJvcmRlckNvbmZpZz4ge1xuICBjb25zdCBvdXRlciA9IGNvbmZpZy5vdXRlciA/PyAxO1xuICBjb25zdCBtaWRkbGUgPSBjb25maWcubWlkZGxlID8/IDE7XG4gIGNvbnN0IGlubmVyID0gY29uZmlnLmlubmVyID8/IDE7XG4gIGNvbnN0IHRvdGFsID0gb3V0ZXIgKyBtaWRkbGUgKyBpbm5lcjtcblxuICByZXR1cm4ge1xuICAgIG91dGVyLFxuICAgIG1pZGRsZSxcbiAgICBpbm5lcixcbiAgICB0b3RhbFxuICB9O1xufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX3BpeGlfanNfXzsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFwiLi9zcmMvaW5kZXgudHNcIik7XG4iLCIiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=