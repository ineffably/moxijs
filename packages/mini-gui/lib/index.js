!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("pixi.js"),require("@moxijs/core")):"function"==typeof define&&define.amd?define(["pixi.js","@moxijs/core"],e):"object"==typeof exports?exports.miniGui=e(require("pixi.js"),require("@moxijs/core")):t.miniGui=e(t.PIXI,t.moxi)}(self,((t,e)=>(()=>{"use strict";var i={5:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StringControl=void 0;const n=i(47),s=i(281),o=i(173),r=i(369);class h extends o.Control{_inputBg;_valueLabel;_htmlInput;_editing=!1;constructor(t,e,i,o={}){super(t,e,i,o),this._inputBg=new n.Graphics,this._widget.addChild(this._inputBg),this._valueLabel=new s.UILabel({text:this.getValue(),fontSize:(0,r.px)(6),fontFamily:this.config.fontFamily,color:r.GUI_COLORS.text}),this._widget.addChild(this._valueLabel.container),this._setupInteractions(),this.layout(),this.updateDisplay()}updateDisplay(){return this._valueLabel.setText(this.getValue()),this._renderWidget(),this}_setupInteractions(){this._widget.eventMode="static",this._widget.cursor="text",this._widget.on("pointertap",(()=>{this._disabled||this._editing||this._startEditing()}))}_startEditing(){this._editing=!0,this._htmlInput=document.createElement("input"),this._htmlInput.type="text",this._htmlInput.value=this.getValue(),this._htmlInput.style.position="fixed",this._htmlInput.style.left="-9999px",this._htmlInput.style.top="-9999px",document.body.appendChild(this._htmlInput),this._htmlInput.focus(),this._htmlInput.select(),this._htmlInput.addEventListener("input",(()=>{this._htmlInput&&this.setValue(this._htmlInput.value)})),this._htmlInput.addEventListener("blur",(()=>{this._stopEditing()})),this._htmlInput.addEventListener("keydown",(t=>{"Enter"!==t.key&&"Escape"!==t.key||this._stopEditing()})),this._renderWidget()}_stopEditing(){this._editing&&(this._editing=!1,this._htmlInput&&(this._htmlInput.remove(),this._htmlInput=void 0),this._callOnFinishChange(),this._renderWidget())}_renderWidget(){const t=(0,r.px)(8),e=this._textY+(0,r.px)(3),i=Math.round(e-t/2);this._inputBg.clear(),this._inputBg.roundRect(0,i,this._widgetWidth,t,(0,r.px)(1)),this._inputBg.fill(this._editing?r.GUI_COLORS.accent:r.GUI_COLORS.input),this._inputBg.stroke({color:this._editing?r.GUI_COLORS.accent:r.GUI_COLORS.inputBorder,width:(0,r.px)(.5)}),this._valueLabel.container.x=(0,r.px)(1.5),this._valueLabel.container.y=this._textY}layout(t,e){super.layout(t,e),this._renderWidget()}destroy(){this._stopEditing(),super.destroy()}}e.StringControl=h,e.default=h},6:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionControl=e.StringControl=e.BooleanControl=e.NumberControl=e.Control=void 0;var n=i(173);Object.defineProperty(e,"Control",{enumerable:!0,get:function(){return n.Control}});var s=i(525);Object.defineProperty(e,"NumberControl",{enumerable:!0,get:function(){return s.NumberControl}});var o=i(542);Object.defineProperty(e,"BooleanControl",{enumerable:!0,get:function(){return o.BooleanControl}});var r=i(5);Object.defineProperty(e,"StringControl",{enumerable:!0,get:function(){return r.StringControl}});var h=i(465);Object.defineProperty(e,"OptionControl",{enumerable:!0,get:function(){return h.OptionControl}})},47:e=>{e.exports=t},173:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Control=void 0;const n=i(240),s=i(369);class o extends n.ControlRow{_panel;_object;_property;_initialValue;_name;_disabled=!1;_hidden=!1;_onChange;_onFinishChange;_changed=!1;_listening=!1;_listenFrameId;_listenPrevValue;constructor(t,e,i,n={}){const o=t?.config??s.GUI_CONST,r=n.name??i;super({label:r,config:o}),this._panel=t,this._object=e,this._property=i,this._initialValue=this.getValue(),this._name=r}getValue(){return this._object[this._property]}setValue(t){return this._object[this._property]===t||(this._object[this._property]=t,this._callOnChange(),this.updateDisplay()),this}name(t){return this._name=t,this.setLabel(t),this}onChange(t){return this._onChange=t,this}onFinishChange(t){return this._onFinishChange=t,this}reset(){return this.setValue(this._initialValue),this._callOnFinishChange(),this}enable(t=!0){return this.disable(!t)}disable(t=!0){return this._disabled===t||(this._disabled=t,this.container.alpha=t?.5:1,this.container.eventMode=t?"none":"static"),this}show(t=!0){return this._hidden=!t,this.container.visible=t,this}hide(){return this.show(!1)}listen(t=!0){return this._listening=t,void 0!==this._listenFrameId&&(cancelAnimationFrame(this._listenFrameId),this._listenFrameId=void 0),t&&this._listenCallback(),this}save(){return this.getValue()}load(t){return this.setValue(t),this._callOnFinishChange(),this}destroy(){this.listen(!1),this._panel&&this._panel._removeControl(this),this.container.destroy({children:!0})}_callOnChange(){this._panel&&this._panel._callOnChange(this),this._onChange&&this._onChange(this.getValue()),this._changed=!0}_callOnFinishChange(){this._changed&&(this._panel&&this._panel._callOnFinishChange(this),this._onFinishChange&&this._onFinishChange(this.getValue()),this._changed=!1)}_listenCallback=()=>{this._listenFrameId=requestAnimationFrame(this._listenCallback);const t=this.getValue();t!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=t}}e.Control=o,e.default=o},240:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GUIHeader=e.GUIBody=e.ControlRow=void 0;var n=i(856);Object.defineProperty(e,"ControlRow",{enumerable:!0,get:function(){return n.ControlRow}});var s=i(304);Object.defineProperty(e,"GUIBody",{enumerable:!0,get:function(){return s.GUIBody}});var o=i(357);Object.defineProperty(e,"GUIHeader",{enumerable:!0,get:function(){return o.GUIHeader}})},281:t=>{t.exports=e},304:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GUIBody=void 0;const n=i(47),s=i(281),o=i(369);class r extends s.UIComponent{_collapsed;_content;_mask;_targetHeight=0;_currentHeight=0;_contentHeight=0;_animationSpeed;_animating=!1;_config;_onOpenClose;constructor(t={}){super(),this._config=t.config??o.GUI_CONST,this._collapsed=t.collapsed??!1,this._animationSpeed=t.animationSpeed??8,this._content=new n.Container,this.container.addChild(this._content),this._mask=new n.Graphics,this.container.addChild(this._mask),this._content.mask=this._mask,n.Ticker.shared.add(this._onTick,this)}get content(){return this._content}get collapsed(){return this._collapsed}setContentHeight(t){this._contentHeight=t,this._animating?this._targetHeight=this._collapsed?0:t:(this._collapsed?(this._currentHeight=0,this._targetHeight=0):(this._currentHeight=t,this._targetHeight=t),this._updateMask())}collapse(t=!0){this._collapsed||(this._collapsed=!0,this._targetHeight=0,t&&this._animationSpeed>0?this._animating=!0:(this._currentHeight=0,this._animating=!1,this._updateMask(),this._onOpenClose?.()))}expand(t=!0){this._collapsed&&(this._collapsed=!1,this._targetHeight=this._contentHeight,t&&this._animationSpeed>0?this._animating=!0:(this._currentHeight=this._contentHeight,this._animating=!1,this._updateMask(),this._onOpenClose?.()))}toggle(t=!0){this._collapsed?this.expand(t):this.collapse(t)}onOpenClose(t){return this._onOpenClose=t,this}getVisibleHeight(){return this._currentHeight}_onTick=()=>{if(!this._animating)return;const t=this._targetHeight-this._currentHeight;if(Math.abs(t)<1)return this._currentHeight=this._targetHeight,this._animating=!1,this._updateMask(),void this._onOpenClose?.();const e=this._animationSpeed;this._currentHeight=t>0?Math.min(this._currentHeight+e,this._targetHeight):Math.max(this._currentHeight-e,this._targetHeight),this._updateMask()};_updateMask(){const t=(0,o.px)(this._config.width);this._mask.clear(),this._currentHeight>0&&(this._mask.rect(0,0,t,this._currentHeight),this._mask.fill(16777215))}measure(){return{width:(0,o.px)(this._config.width),height:this._currentHeight}}destroy(){n.Ticker.shared.remove(this._onTick,this),super.destroy()}layout(t,e){this._updateMask()}render(){this._updateMask()}}e.GUIBody=r,e.default=r},308:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GUI=void 0;const n=i(47),s=i(281),o=i(369),r=i(6),h=i(240);class a extends s.UIComponent{_title;_width;config;_closed;_draggable;_closeFolders;_parent;_root;_controls=[];_folders=[];_children=[];_background;_header;_guiBody;_onChange;_onFinishChange;_onOpenClose;constructor(t={}){super(),this._title=t.title??"Controls",this._width=t.width??o.GUI_CONST.width,this._closed=t.closed??!1,this._draggable=t.draggable??!0,this._closeFolders=t.closeFolders??!1,this._parent=t.parent,this._root=this._parent?this._parent._root:this;const e=this._parent?.config;this.config={width:t.width??e?.width??o.GUI_CONST.width,rowHeight:t.rowHeight??e?.rowHeight??o.GUI_CONST.rowHeight,labelRatio:t.labelRatio??e?.labelRatio??o.GUI_CONST.labelRatio,padding:t.padding??e?.padding??o.GUI_CONST.padding,headerHeight:o.GUI_CONST.headerHeight,gap:o.GUI_CONST.gap,border:o.GUI_CONST.border,fontFamily:o.GUI_CONST.fontFamily,fontSize:o.GUI_CONST.fontSize},this._width=this.config.width,this._parent&&(this._parent._children.push(this),this._parent._folders.push(this)),this._background=new n.Graphics,this.container.addChild(this._background),this._header=new h.GUIHeader({title:this._title,config:this.config,draggable:this._draggable&&!this._parent,collapsed:this._closed,isFolder:!!this._parent}),this._header.onToggle((()=>this.toggle())),this._header.onDrag(((t,e)=>{this.container.x+=t,this.container.y+=e})),this.container.addChild(this._header.container),this._guiBody=new h.GUIBody({config:this.config,collapsed:this._closed}),this._guiBody.container.y=(0,o.px)(this.config.headerHeight),this._guiBody.onOpenClose((()=>{this._render(),this._parent&&this._parent._layoutChildren()})),this.container.addChild(this._guiBody.container),void 0!==t.x&&(this.container.x=t.x),void 0!==t.y&&(this.container.y=t.y),this._render()}title(t){return this._title=t,this._header.setTitle(t),this}add(t,e,i,n,s){const o=t[e];let h;if(Array.isArray(i)||"object"==typeof i&&null!==i&&"number"!=typeof i)h=new r.OptionControl(this,t,e,i);else if("boolean"==typeof o)h=new r.BooleanControl(this,t,e);else if("number"==typeof o)h=new r.NumberControl(this,t,e,i,n,s);else{if("string"!=typeof o)throw new Error(`Cannot create control for property "${String(e)}" with value type "${typeof o}"`);h=new r.StringControl(this,t,e)}return this._controls.push(h),this._children.push(h),this._guiBody.content.addChild(h.container),this._layoutChildren(),h}addColor(t,e,i=1){throw new Error("ColorControl not yet implemented. Coming in Phase 3.")}addFolder(t){const e=new a({parent:this,title:t,width:this._width,draggable:!1,closed:this._root._closeFolders});return this._guiBody.content.addChild(e.container),this._layoutChildren(),e}open(t=!0){return this._closed===!t||(this._closed=!t,this._header.setCollapsed(this._closed),this._closed?this._guiBody.collapse():this._guiBody.expand(),this._onOpenClose&&this._onOpenClose(this),this._parent&&this._parent._callOnOpenClose(this),this._render()),this}close(){return this.open(!1)}toggle(){return this.open(this._closed)}onChange(t){return this._onChange=t,this}onFinishChange(t){return this._onFinishChange=t,this}onOpenClose(t){return this._onOpenClose=t,this}reset(t=!0){return(t?this.controllersRecursive():this._controls).forEach((t=>t.reset())),this}save(t=!0){const e={controllers:{},folders:{}};return this._controls.forEach((t=>{e.controllers[t._name]=t.save()})),t&&this._folders.forEach((t=>{e.folders[t._title]=t.save()})),e}load(t,e=!0){const i=t.controllers,n=t.folders;return i&&this._controls.forEach((t=>{const e=t._name;e in i&&t.load(i[e])})),e&&n&&this._folders.forEach((t=>{t._title in n&&t.load(n[t._title])})),this}controllersRecursive(){let t=[...this._controls];for(const e of this._folders)t=t.concat(e.controllersRecursive());return t}foldersRecursive(){let t=[];for(const e of this._folders)t.push(e),t=t.concat(e.foldersRecursive());return t}destroy(){if(this._parent){const t=this._parent._children.indexOf(this);-1!==t&&this._parent._children.splice(t,1);const e=this._parent._folders.indexOf(this);-1!==e&&this._parent._folders.splice(e,1)}this._children.forEach((t=>t.destroy())),this.container.destroy({children:!0})}_callOnChange(t){this._parent&&this._parent._callOnChange(t),this._onChange&&this._onChange({object:t._object,property:t._property,value:t.getValue(),control:t})}_callOnFinishChange(t){this._parent&&this._parent._callOnFinishChange(t),this._onFinishChange&&this._onFinishChange({object:t._object,property:t._property,value:t.getValue(),control:t})}_callOnOpenClose(t){this._parent&&this._parent._callOnOpenClose(t),this._onOpenClose&&this._onOpenClose(t)}_removeControl(t){const e=this._children.indexOf(t);-1!==e&&this._children.splice(e,1);const i=this._controls.indexOf(t);-1!==i&&this._controls.splice(i,1),this._guiBody.content.removeChild(t.container),this._layoutChildren()}_layoutChildren(){let t=0;for(const e of this._children)e.container.y=t,t+=e.measure().height+(0,o.px)(this.config.gap);const e=t+(0,o.px)(this.config.padding);this._guiBody.setContentHeight(e),this._render(),this._parent&&this._parent._layoutChildren()}measure(){return{width:(0,o.px)(this._width),height:(0,o.px)(this.config.headerHeight)+this._guiBody.getVisibleHeight()}}_render(){const{width:t,height:e}=this.measure();this._background.clear(),this._background.roundRect(0,0,t,e,(0,o.px)(1)),this._background.fill(o.GUI_COLORS.background),this._background.stroke({color:o.GUI_COLORS.border,width:(0,o.px)(this.config.border)})}layout(t,e){this._layoutChildren()}render(){this._render()}}e.GUI=a,e.default=a},357:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GUIHeader=void 0;const n=i(47),s=i(281),o=i(369);class r extends s.UIComponent{_title;_config;_draggable;_collapsed;_isFolder;_background;_collapseIndicator;_titleLabel;_dragOffset={x:0,y:0};_isDragging=!1;_onToggle;_onDrag;constructor(t){super(),this._title=t.title,this._config=t.config??o.GUI_CONST,this._draggable=t.draggable??!0,this._collapsed=t.collapsed??!1,this._isFolder=t.isFolder??!1,this._background=new n.Graphics,this.container.addChild(this._background),this._collapseIndicator=new s.UILabel({text:this._collapsed?"▶":"▼",fontSize:(0,o.px)(5),fontFamily:this._config.fontFamily,color:o.GUI_COLORS.textMuted}),this._collapseIndicator.container.x=(0,o.px)(this._config.padding),this.container.addChild(this._collapseIndicator.container),this._titleLabel=new s.UILabel({text:this._title,fontSize:(0,o.px)(6),fontFamily:this._config.fontFamily,color:o.GUI_COLORS.text}),this._titleLabel.container.x=(0,o.px)(this._config.padding+6),this.container.addChild(this._titleLabel.container),this._setupEvents(),this._render()}setTitle(t){this._title=t,this._titleLabel.setText(t)}setCollapsed(t){this._collapsed=t,this._collapseIndicator.setText(t?"▶":"▼")}onToggle(t){return this._onToggle=t,this}onDrag(t){return this._onDrag=t,this}_setupEvents(){this.container.eventMode="static",this.container.cursor=this._draggable?"grab":"pointer",this.container.on("pointertap",(()=>{this._isDragging||this._onToggle?.()})),this._draggable&&this.container.on("pointerdown",(t=>{this._isDragging=!1,this._dragOffset.x=t.global.x,this._dragOffset.y=t.global.y,this.container.cursor="grabbing",this._onDrag;const e=t=>{this._isDragging=!0;const e=t.global.x-this._dragOffset.x,i=t.global.y-this._dragOffset.y;this._onDrag?.(e,i),this._dragOffset.x=t.global.x,this._dragOffset.y=t.global.y},i=()=>{this.container.cursor="grab",this.container.off("globalpointermove",e),this.container.off("pointerup",i),this.container.off("pointerupoutside",i),setTimeout((()=>{this._isDragging=!1}),0)};this.container.on("globalpointermove",e),this.container.on("pointerup",i),this.container.on("pointerupoutside",i)}))}_render(){const t=(0,o.px)(this._config.width),e=(0,o.px)(this._config.headerHeight);this._background.clear(),this._background.rect(0,0,t,e),this._background.fill(this._isFolder?o.GUI_COLORS.folder:o.GUI_COLORS.header),this._collapseIndicator.container.y=(e-this._collapseIndicator.container.height)/2,this._titleLabel.container.y=(e-this._titleLabel.container.height)/2}measure(){return{width:(0,o.px)(this._config.width),height:(0,o.px)(this._config.headerHeight)}}layout(t,e){this._render()}render(){this._render()}}e.GUIHeader=r,e.default=r},369:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GUI_COLORS=e.GUI_CONST=e.units=e.px=e.GUI_GRID=void 0;const n=i(281);e.GUI_GRID=new n.PixelGrid({scale:2}),e.px=t=>e.GUI_GRID.px(t),e.units=t=>e.GUI_GRID.units(t),e.GUI_CONST={width:100,rowHeight:12,padding:3,border:1,headerHeight:12,gap:1,labelRatio:.4,fontFamily:"PixelOperator8, ui-monospace",fontSize:8},e.GUI_COLORS={background:1710638,header:1450302,border:996448,text:16777215,textMuted:8947848,accent:54527,sliderTrack:996448,sliderFill:54527,input:2434341,inputBorder:3815994,hover:2763342,folder:1184302}},465:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionControl=void 0;const n=i(47),s=i(281),o=i(173),r=i(369);class h extends o.Control{_options=[];_selectedIndex=0;_selectBg;_valueLabel;_arrow;constructor(t,e,i,o,h={}){super(t,e,i,h),this._normalizeOptions(o),this._selectedIndex=this._findSelectedIndex(),this._selectBg=new n.Graphics,this._widget.addChild(this._selectBg),this._valueLabel=new s.UILabel({text:this._getSelectedLabel(),fontSize:(0,r.px)(6),fontFamily:this.config.fontFamily,color:r.GUI_COLORS.text}),this._widget.addChild(this._valueLabel.container),this._arrow=new s.UILabel({text:"▼",fontSize:(0,r.px)(4),fontFamily:this.config.fontFamily,color:r.GUI_COLORS.textMuted}),this._widget.addChild(this._arrow.container),this._setupInteractions(),this.layout(),this.updateDisplay()}options(t){return this._normalizeOptions(t),this._selectedIndex=this._findSelectedIndex(),this.updateDisplay(),this}updateDisplay(){return this._selectedIndex=this._findSelectedIndex(),this._valueLabel.setText(this._getSelectedLabel()),this._renderWidget(),this}_normalizeOptions(t){if(this._options=[],Array.isArray(t))for(const e of t)this._options.push([String(e),e]);else for(const[e,i]of Object.entries(t))this._options.push([e,i])}_findSelectedIndex(){const t=this.getValue();for(let e=0;e<this._options.length;e++)if(this._options[e][1]===t)return e;return 0}_getSelectedLabel(){return 0===this._options.length?"":this._options[this._selectedIndex]?.[0]??""}_setupInteractions(){this._widget.eventMode="static",this._widget.cursor="pointer",this._widget.on("pointertap",(t=>{if(this._disabled)return;const e=2===t.button||t.shiftKey;this._selectedIndex=e?(this._selectedIndex-1+this._options.length)%this._options.length:(this._selectedIndex+1)%this._options.length;const[,i]=this._options[this._selectedIndex];this.setValue(i),this._callOnFinishChange()})),this._widget.on("rightclick",(t=>{t.preventDefault?.()}))}_renderWidget(){const t=(0,r.px)(8),e=this._textY+(0,r.px)(3),i=Math.round(e-t/2);this._selectBg.clear(),this._selectBg.roundRect(0,i,this._widgetWidth,t,(0,r.px)(1)),this._selectBg.fill(r.GUI_COLORS.input),this._selectBg.stroke({color:r.GUI_COLORS.inputBorder,width:(0,r.px)(.5)}),this._valueLabel.container.x=(0,r.px)(1.5),this._valueLabel.container.y=this._textY,this._arrow.container.x=this._widgetWidth-this._arrow.container.width-(0,r.px)(1.5),this._arrow.container.y=this._textY}layout(t,e){super.layout(t,e),this._renderWidget()}}e.OptionControl=h,e.default=h},525:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NumberControl=void 0;const n=i(47),s=i(281),o=i(173),r=i(369);class h extends o.Control{_min;_max;_step;_hasSlider;_track;_fill;_valueLabel;_dragging=!1;_dragStartX=0;_dragStartValue=0;constructor(t,e,i,o,h,a,l={}){super(t,e,i,l),this._min=o??l.min,this._max=h??l.max,this._step=a??l.step??this._computeStep(),this._hasSlider=void 0!==this._min&&void 0!==this._max,this._track=new n.Graphics,this._widget.addChild(this._track),this._fill=new n.Graphics,this._widget.addChild(this._fill),this._valueLabel=new s.UILabel({text:this._formatValue(this.getValue()),fontSize:(0,r.px)(6),fontFamily:this.config.fontFamily,color:r.GUI_COLORS.text}),this._widget.addChild(this._valueLabel.container),this._setupInteractions(),this.layout(),this.updateDisplay()}min(t){return this._min=t,this._hasSlider=void 0!==this._min&&void 0!==this._max,this.updateDisplay(),this}max(t){return this._max=t,this._hasSlider=void 0!==this._min&&void 0!==this._max,this.updateDisplay(),this}step(t){return this._step=t,this}updateDisplay(){const t=this.getValue();return this._valueLabel.setText(this._formatValue(t)),this._renderWidget(),this}_computeStep(){const t=Math.abs(this.getValue());return 0===t?.1:t<1?.01:t<10?.1:t<100?1:10}_formatValue(t){const e=this._step.toString(),i=e.indexOf("."),n=-1===i?0:e.length-i-1;return t.toFixed(Math.min(n,4))}_clampValue(t){return this._step>0&&(t=Math.round(t/this._step)*this._step),void 0!==this._min&&(t=Math.max(this._min,t)),void 0!==this._max&&(t=Math.min(this._max,t)),t}_getNormalized(){if(void 0===this._min||void 0===this._max)return 0;const t=this._max-this._min;return 0===t?0:(this.getValue()-this._min)/t}_setFromNormalized(t){if(void 0===this._min||void 0===this._max)return;const e=this._max-this._min,i=this._min+t*e;this.setValue(this._clampValue(i))}_getSliderWidth(){return this._widgetWidth-(0,r.px)(20)}_setupInteractions(){this._widget.eventMode="static",this._widget.cursor="ew-resize",this._widget.on("pointerdown",(t=>{if(this._disabled)return;if(this._dragging=!0,this._dragStartX=t.global.x,this._dragStartValue=this.getValue(),this._hasSlider){const e=this._widget.toLocal(t.global),i=this._getSliderWidth(),n=Math.max(0,Math.min(1,e.x/i));this._setFromNormalized(n)}const e=t=>{if(this._dragging)if(this._hasSlider){const e=this._widget.toLocal(t.global),i=this._getSliderWidth(),n=Math.max(0,Math.min(1,e.x/i));this._setFromNormalized(n)}else{const e=t.global.x-this._dragStartX,i=.5*this._step,n=this._dragStartValue+e*i;this.setValue(this._clampValue(n))}},i=()=>{this._dragging=!1,this._callOnFinishChange(),this._widget.off("globalpointermove",e),this._widget.off("pointerup",i),this._widget.off("pointerupoutside",i)};this._widget.on("globalpointermove",e),this._widget.on("pointerup",i),this._widget.on("pointerupoutside",i)}))}_renderWidget(){const t=this._getSliderWidth(),e=(0,r.px)(2),i=this._textY+(0,r.px)(3),n=Math.round(i-e/2);if(this._track.clear(),this._fill.clear(),this._hasSlider){this._track.roundRect(0,n,t,e,(0,r.px)(1)),this._track.fill(r.GUI_COLORS.sliderTrack);const i=t*this._getNormalized();i>0&&(this._fill.roundRect(0,n,i,e,(0,r.px)(1)),this._fill.fill(r.GUI_COLORS.sliderFill))}this._valueLabel.container.x=t+(0,r.px)(2),this._valueLabel.container.y=this._textY}layout(t,e){super.layout(t,e),this._renderWidget()}}e.NumberControl=h,e.default=h},542:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanControl=void 0;const n=i(47),s=i(173),o=i(369);class r extends s.Control{_box;_check;constructor(t,e,i,s={}){super(t,e,i,s),this._box=new n.Graphics,this._widget.addChild(this._box),this._check=new n.Graphics,this._widget.addChild(this._check),this._setupInteractions(),this.layout(),this.updateDisplay()}updateDisplay(){return this._renderWidget(),this}_setupInteractions(){this._widget.eventMode="static",this._widget.cursor="pointer",this._widget.on("pointertap",(()=>{this._disabled||(this.setValue(!this.getValue()),this._callOnFinishChange())}))}_renderWidget(){const t=(0,o.px)(6),e=(0,o.px)(this.config.rowHeight),i=Math.round((e-t)/2),n=this.getValue(),s=this._widgetWidth-t;if(this._box.clear(),this._box.roundRect(s,i,t,t,(0,o.px)(1)),this._box.fill(n?o.GUI_COLORS.accent:o.GUI_COLORS.input),this._box.stroke({color:n?o.GUI_COLORS.accent:o.GUI_COLORS.inputBorder,width:(0,o.px)(.5)}),this._check.clear(),n){const e=(0,o.px)(1.5),n=s+e,r=i+t/2,h=s+t/2-(0,o.px)(.5),a=i+t-e,l=s+t-e,_=i+e;this._check.moveTo(n,r),this._check.lineTo(h,a),this._check.lineTo(l,_),this._check.stroke({color:o.GUI_COLORS.background,width:(0,o.px)(1)})}}layout(t,e){super.layout(t,e),this._renderWidget()}}e.BooleanControl=r,e.default=r},856:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ControlRow=void 0;const n=i(47),s=i(281),o=i(369);class r extends s.UIComponent{_rowLabel;_labelMask;_widget;_rowBackground;_rowConfig;_labelText;_textY=0;_widgetWidth=0;constructor(t){super(),this._labelText=t.label,this._rowConfig=t.config??o.GUI_CONST,this._rowBackground=new n.Graphics,this.container.addChild(this._rowBackground),this._rowLabel=new s.UILabel({text:this._labelText,fontSize:(0,o.px)(6),fontFamily:this._rowConfig.fontFamily,color:o.GUI_COLORS.textMuted}),this.container.addChild(this._rowLabel.container),this._labelMask=new n.Graphics,this.container.addChild(this._labelMask),this._rowLabel.container.mask=this._labelMask,this._widget=new n.Container,this.container.addChild(this._widget),this.container.eventMode="static",this.container.on("pointerenter",(()=>this._drawRowBackground(!0))),this.container.on("pointerleave",(()=>this._drawRowBackground(!1)))}get config(){return this._rowConfig}get widget(){return this._widget}get textY(){return this._textY}get widgetWidth(){return this._widgetWidth}setLabel(t){this._labelText=t,this._rowLabel.setText(t)}measure(){const t=this._rowConfig;return{width:(0,o.px)(t.width-2*t.padding),height:(0,o.px)(t.rowHeight)}}layout(t,e){const i=this._rowConfig,n=(0,o.px)(i.width-2*i.padding),s=(0,o.px)(i.rowHeight),r=(0,o.px)(i.padding),h=n*i.labelRatio;this._widgetWidth=n-h,this._textY=Math.round((s-this._rowLabel.container.height)/2),this._rowLabel.container.x=r,this._rowLabel.container.y=this._textY,this._labelMask.clear(),this._labelMask.rect(0,0,h+r,s),this._labelMask.fill(16777215),this._widget.x=h,this._widget.y=0,this._drawRowBackground(!1)}_drawRowBackground(t=!1){const e=this._rowConfig,i=(0,o.px)(e.width-2*e.padding),n=(0,o.px)(e.rowHeight);this._rowBackground.clear(),t&&(this._rowBackground.rect(0,0,i,n),this._rowBackground.fill({color:o.GUI_COLORS.hover,alpha:.5}))}render(){}}e.ControlRow=r,e.default=r}},n={};function s(t){var e=n[t];if(void 0!==e)return e.exports;var o=n[t]={exports:{}};return i[t](o,o.exports,s),o.exports}var o={};return(()=>{var t=o;Object.defineProperty(t,"__esModule",{value:!0}),t.GUI_GRID=t.GUI_COLORS=t.GUI_CONST=t.units=t.px=t.OptionControl=t.StringControl=t.BooleanControl=t.NumberControl=t.Control=t.GUI=void 0;var e=s(308);Object.defineProperty(t,"GUI",{enumerable:!0,get:function(){return e.GUI}});var i=s(6);Object.defineProperty(t,"Control",{enumerable:!0,get:function(){return i.Control}}),Object.defineProperty(t,"NumberControl",{enumerable:!0,get:function(){return i.NumberControl}}),Object.defineProperty(t,"BooleanControl",{enumerable:!0,get:function(){return i.BooleanControl}}),Object.defineProperty(t,"StringControl",{enumerable:!0,get:function(){return i.StringControl}}),Object.defineProperty(t,"OptionControl",{enumerable:!0,get:function(){return i.OptionControl}});var n=s(369);Object.defineProperty(t,"px",{enumerable:!0,get:function(){return n.px}}),Object.defineProperty(t,"units",{enumerable:!0,get:function(){return n.units}}),Object.defineProperty(t,"GUI_CONST",{enumerable:!0,get:function(){return n.GUI_CONST}}),Object.defineProperty(t,"GUI_COLORS",{enumerable:!0,get:function(){return n.GUI_COLORS}}),Object.defineProperty(t,"GUI_GRID",{enumerable:!0,get:function(){return n.GUI_GRID}})})(),o})()));